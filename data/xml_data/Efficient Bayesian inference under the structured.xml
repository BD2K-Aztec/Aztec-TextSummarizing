
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:45+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Efficient Bayesian inference under the structured coalescent</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Timothy</forename>
								<forename type="middle">G</forename>
								<surname>Vaughan</surname>
							</persName>
							<email>tgvaughan@gmail.com</email>
						</author>
						<author>
							<persName>
								<forename type="first">Denise</forename>
								<surname>Kü Hnert</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Institute of Integrative Biology</orgName>
								<orgName type="department" key="dep2">Swiss Federal Institute of Technology (ETH)</orgName>
								<address>
									<postCode>8092</postCode>
									<settlement>Zurich</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Auckland</orgName>
								<address>
									<postCode>1142</postCode>
									<settlement>Auckland</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alex</forename>
								<surname>Popinga</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Auckland</orgName>
								<address>
									<postCode>1142</postCode>
									<settlement>Auckland</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">David</forename>
								<surname>Welch</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Auckland</orgName>
								<address>
									<postCode>1142</postCode>
									<settlement>Auckland</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alexei</forename>
								<forename type="middle">J</forename>
								<surname>Drummond</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Auckland</orgName>
								<address>
									<postCode>1142</postCode>
									<settlement>Auckland</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Allan Wilson Centre for Molecular Ecology and Evolution</orgName>
								<orgName type="institution">Massey University</orgName>
								<address>
									<addrLine>Palmerston North 4442</addrLine>
									<settlement>New Zealand</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Efficient Bayesian inference under the structured coalescent</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">16</biblScope>
							<biblScope unit="page" from="2272" to="2279"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu201</idno>
					<note type="submission">Phylogenetics Advance Access publication April 20, 2014 Received on October 2, 2013; revised on April 8, 2014; accepted on April 11, 2014</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: David Posada Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Population structure significantly affects evolutionary dynamics. Such structure may be due to spatial segregation, but may also reflect any other gene-flow-limiting aspect of a model. In combination with the structured coalescent, this fact can be used to inform phylogenetic tree reconstruction, as well as to infer parameters such as migration rates and subpopulation sizes from annotated sequence data. However, conducting Bayesian inference under the structured coalescent is impeded by the difficulty of constructing Markov Chain Monte Carlo (MCMC) sampling algorithms (samplers) capable of efficiently exploring the state space. Results: In this article, we present a new MCMC sampler capable of sampling from posterior distributions over structured trees: timed phylogenetic trees in which lineages are associated with the distinct subpopulation in which they lie. The sampler includes a set of MCMC proposal functions that offer significant mixing improvements over a previously published method. Furthermore, its implementation as a BEAST 2 package ensures maximum flexibility with respect to model and prior specification. We demonstrate the usefulness of this new sampler by using it to infer migration rates and effective population sizes of H3N2 influenza between New Zealand, New York and Hong Kong from publicly available hemagglutinin (HA) gene sequences under the structured coalescent. Availability and implementation: The sampler has been implemented as a publicly available BEAST 2 package that is distributed under version 3 of the GNU General Public License at http://compevol. github.io/MultiTypeTree. Contact:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Model-based phylogenetic inference has become one of the principal methods of using genetic sequence data to test scientific hypotheses pertaining to evolving populations. Its wide-spread adoption has been driven not only by improvements in computational and sequencing hardware but also by advances in methods of statistical inference. An important initial step in this development was the derivation of the n-coalescent process (<ref type="bibr" target="#b21">Kingman, 1982</ref>), which probabilistically ties the shape of a rooted phylogenetic tree of n randomly chosen individuals to the parameters of an underlying Wright–Fisher population genetics model. In conjunction with Felsenstein's 'pruning algorithm' (<ref type="bibr" target="#b12">Felsenstein, 1981</ref>), this allowed for the computational inference of the sample genealogy itself alongside population genetic parameters, such as the effective population size. Since these beginnings, an array of sophisticated models and inference methods has been developed, allowing molecular mutation rates, population size histories and other population genetic parameters of interest to be inferred alongside increasingly sophisticated phylogenetic tree reconstructions, which, for example, do away with the assumption of a strict molecular clock (<ref type="bibr" target="#b7">Drummond et al., 2006;</ref><ref type="bibr" target="#b30">Sanderson, 2002;</ref><ref type="bibr" target="#b32">Thorne et al., 1998</ref>). Rapidly evolving populations such as viruses and bacteria are of particular interest, as such populations may undergo significant demographic variation over timescales comparable with the age of the genealogy of sampled data. Such data form the basis of the emerging field of phylodynamics (<ref type="bibr" target="#b17">Grenfell et al., 2004;</ref><ref type="bibr" target="#b22">Ku¨hnertKu¨hnert et al., 2011;</ref><ref type="bibr" target="#b23">Lemey et al., 2009;</ref><ref type="bibr" target="#b35">Volz et al., 2013</ref>), which exploits these overlapping timescales by using the genetic data to select and infer parameters of sophisticated epidemiological models. Many of the models that are of interest to population geneticists and epidemiologists are structured in some way. This structure may represent the spatial subdivision of a population into several distinct 'demes', or it may represent some other logical categorization of individuals such as the temporal subdivision used in compartmental epidemiological models. Such structure can strongly affect the shape of inferred genealogies (<ref type="bibr" target="#b26">Pannell, 2003</ref>), and can provide a source of statistical bias when ignored. A time-tested means of including this structure in phylogenetic analyses is through the use of the structured coalescent (<ref type="bibr" target="#b20">Hudson, 1990;</ref><ref type="bibr" target="#b25">Notohara, 1990</ref>), an extension of Kingman's coalescent in which the unstructured Wright–Fisher model is replaced by a structured equivalent encompassing a number of discrete subpopulations. Phylogenetic analyses based on this model are capable of both (i) reducing model misspecification bias in the inference of the genealogy and (ii) estimating parameters specific to structured models such as migration rates and effective subpopulation sizes. While similar, this model is distinct from the character-based treatment of lineage locations used by<ref type="bibr" target="#b23">Lemey et al. (2009)</ref>, in that the structured coalescent allows *To whom correspondence should be addressed.schemes for conducting inference under the structured coalescent exist in the literature. Both of these schemes use an MCMC algorithm to explicitly sample both the demographic and evolutionary model parameters and the structured genealogy: a phylogenetic tree annotated with individual migration events. The first of these schemes is the method of Beerli and Felsenstein (<ref type="bibr" target="#b2">Beerli, 2006;</ref><ref type="bibr" target="#b2">Beerli and</ref><ref type="bibr">Felsenstein, 1999, 2001</ref>), which is implemented in the software package Migrate-n. At its core, this method involves a single proposal function, which updates the structured tree by 'dissolving' a randomly selected edge and drawing a new edge by simulating from the structured coalescent conditional on the remaining edges. The other scheme is the work of<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>, who have published a set of simple and fast proposal functions that act solely on the migration events on the structured genealogy. In combination with those for traversing the space of unstructured trees (<ref type="bibr" target="#b8">Drummond et al., 2002</ref>), Ewing et al. showed that an MCMC algorithm based on these moves is capable not only of jointly inferring the structured tree and migration model parameters, but also of exploiting the additional information contained in serially sampled data to infer absolute migration rates. While certainly functional and useful, this scheme suffers from performance issues, which arise in the form of slow 'mixing', meaning that MCMC calculations must be run for a long time to obtain useful information about the posterior probability distribution. An additional issue is that no implementation of the sampler has been made widely available. In this article, we introduce a new set of MCMC proposal functions (or 'operators') that provide an efficient means of using serially sampled sequence data to infer the full structured tree and related model parameters (including mutation rates) under the structured coalescent. These operators, together with the data structure representing the structured tree itself and the probability density calculation algorithm for the structured coalescent, are implemented and distributed as a package extension to BEAST 2 (<ref type="bibr" target="#b5">Bouckaert et al., 2014</ref>; http://www.beast2.org). When applied to equivalent data, and assuming equivalent evolutionary models and parameter priors, this new package yields posterior distributions, which are exactly equivalent to those obtained using Migrate-n. However, the use of the BEAST 2 platform for our implementation gives our sampler access to a large array of molecular evolution models and parameter priors not yet available in Migrate-n. Additionally, we have implemented the operators described by Ewing et al., allowing direct comparison between the two sampling methods. This comparison shows that the new operators achieve significantly faster mixing when applied to simulated data, with an order of magnitude improvement in some cases. We go on to demonstrate the practicality of the new sampler by using it to infer mutation rates, effective population sizes and the structured tree from geographically annotated HA gene sequences derived from the Influenza A subtype H3N2 strain. We interpret these results in light of recent work by<ref type="bibr" target="#b1">Bedford et al. (2010</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ß</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">MATHEMATICAL BACKGROUND</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Structured tree definition</head><p>Before discussing the inference procedure, we need to define precisely what we mean by a 'structured tree'. In this article, we define a structured tree T of n leaves as a fully resolved, rooted and timed phylogenetic tree in which every internal node represents a coalescent event and where every point on each edge of the tree is associated with exactly one type d drawn from a fixed set D of such types. Mathematically, we write T ¼ ðV; E; t; MÞ. The first three elements are the usual phylogenetic tree components: a set V of 2n À 1 nodes, a set E containing directed edges of the form hi; ji between nodes i; j 2 V and a set of node ages t ¼ ft i ji 2 Vg where t i is the age of node i. The direction of each edge hi; ji is such that t i 5t j. The set of nodes is partitioned into two smaller sets Y and I, representing the n À 1 internal and n external nodes, respectively. The final element in T is the one that is unique to structured trees and is defined by M ¼ f' hi;ji jhi; ji 2 Eg, where each function ' hi;ji : ½t i ; t j !D is piecewise constant and defined such that ' hi;ji ðtÞ is the type associated with the time t on edge hi; ji 2 E. Such a tree is illustrated in<ref type="figure" target="#fig_0">Figure 1</ref>. We caution that the term 'structured tree' is not a standard name. For instance, elsewhere these objects are referred to as 'migration-coalescent trees' (<ref type="bibr" target="#b10">Ewing et al., 2004</ref>) or simply as 'genealogies' (<ref type="bibr" target="#b3">Beerli and Felsenstein, 1999;</ref><ref type="bibr" target="#b20">Hudson, 1990</ref>). Our choice is based on the desire to at once distinguish these trees from regular phylogenetic trees and to extend their applicability beyond the special case of spatial structuring.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Bayesian inference framework</head><p>The goal of the inference scheme discussed here is to characterize the joint posterior probability density PðE; t Y ; M; m; m; yjS; t I ; LÞ, where t Y ¼ ft i ji 2 Yg and t I ¼ ft i ji 2 Ig are the times of the internal and external nodes, m represents the set of substitution model parameters, m and y are the immigration rate matrix and population size vectors defined later and S ¼ fs i ji 2 Ig and L ¼ fl i ji 2 Ig are the sequences and types associated with each of the leaf nodes. The values of S; t I and L represent the data.The first term P F ðSjE; t; mÞ is the probability of the sequence alignment and can be efficiently evaluated using Felsenstein's pruning algorithm (<ref type="bibr" target="#b12">Felsenstein, 1981</ref>). The second term captures the joint probability of the genealogy and the type mapping, conditional on the number of samples, their types and the times at which they were recorded, and the demographic model parameters. This is given by the structured coalescent, as discussed below. The final term is the joint prior for all model parameters and can be factorized into PðmÞPðmÞPðyÞ. Our goal here is to use MCMC to draw samples from Equation (1), thus allowing us to uncover what the data have to say about the structured tree and the demographic and evolutionary model parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">The structured coalescent probability density</head><p>The structured coalescent, allowing for serially sampled sequences as detailed by<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>, assumes the following demographic model. A discrete set of connected subpopulations D with sizes N d for d 2 D are evolving under a Wright–Fisher model in which each generation of length g is divided into two stages. In the first stage, each haploid individual in the model migrates from its current location/type d to a new location d 0 with probability q dd 0 g, or remains in the same subpopulation with probability 1 À P d 0 2Dnd q dd 0 g. In the second stage, N d individuals are sampled with replacement from the occupants of each subpopulation following stage 1, with the sampled individuals forming the next generation. To express the probability density of a structured tree under this model, we require the following additional definitions. First, we divide the period spanned by the tree into B adjacent intervals of lengths t 1 ; t 2 ;. . .; t B such that P B a¼1 t a ¼ t r where t r is the age of the root. Each interval is bracketed by a pair of consecutive 'events', each of which may be a 'coalescent', 'migration' or 'sampling' event. Coalescent events correspond to internal nodes i 2 Y, migrations correspond to discontinuities in the type functions ' hi;ji ðtÞ and sampling events correspond to leaf nodes x 2 I. The total number of migration events from the d 0 type to the d type in M is given by n m dd 0 , while the total number of coalescent events (i.e. internal tree nodes) occurring in type d is n c d. Finally, the number of tree edges hi; ji for which ' hi;ji ðtÞ ¼ d for t in interval a is given by k a;d. All of this information is readily available from T as defined previously. The probability density of the components of the structured tree before conditioning on the sequence data is then given by</p><formula>PðE; t Y ; Mjt I ; L; m; yÞ ¼ exp À X B a¼1 t a X d2D k a;d 2 0 @ 1 A 1 y d þ k a;d X d 0 2Dnd m dd 0 0 @ 1 A 2 4 3 5 Â ðm dd 0 Þ n m dd 0</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">MCMC SAMPLING ALGORITHM</head><p>As outlined above, our goal here is to use MCMC to efficiently draw samples from the joint posterior Equation (1) over the state space spanned by x ¼ ðE; t Y ; M; m; m; yÞ. To perform efficiently, MCMC sampling algorithms need to be able to (i) rapidly calculate the value of a target distribution for a particular state x and (ii) propose new states x 0 that are far enough from the current state for state space to be explored relatively quickly but not so far that the proposal acceptance rate becomes low. Much of this problem is solved by existing methods. For reversible substitution processes, the probability of the sequence alignment given the tree can be efficiently evaluated using the pruning algorithm (<ref type="bibr" target="#b12">Felsenstein, 1981</ref>). For inference under the structured coalescent, the density of the structured genealogy can be evaluated very simply by directly applying Equation (2), which scales according to the number of 'events' (coalescent, migration and sampling) making up the tree. The prior densities for the parameters (m,m,y) are usually chosen to be standard functions for which numerical evaluation is straightforward. In terms of state proposal, standard proposal distributions for sampling distributions over real numbers can be used to propose new parameter combinations. The remaining component is a set of proposal operators that allow exploration of those regions of T space that have finite support under the structured coalescent. As noted above, this has been addressed in two distinct ways by Beerli and Felsenstein (1999) and<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>. Here we introduce a novel set of operators that directly builds on an existing set of unstructured phylogenetic tree operators (<ref type="bibr" target="#b8">Drummond et al., 2002</ref>) that form the basis for the phylogenetics package BEAST (<ref type="bibr" target="#b5">Bouckaert et al., 2014;</ref><ref type="bibr" target="#b6">Drummond and Rambaut, 2007;</ref><ref type="bibr" target="#b9">Drummond et al., 2012</ref>) and as such have been shown capable of efficiently traversing the space of ðE; t Y Þ.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Structured tree operator design strategy</head><p>Our general operator construction strategy involves the following:(2) the application of an edge type function proposal, which produces type functions ' hi;ji 2 M 0 for a subset of the edges hi; ji 2 E 0 to ensure Equation (3) is satisfied at all nodes. New type functions are proposed by using a backward-in-time continuous-time Markov chain (CTMC) to describe the typechange process along an edge, with the type transition rate matrix fixed to the jointly estimated structured coalescent immigration rate matrix m. We define the CTMC in terms of the probability of the edge taking a particular type given the type at the most recent node, pðd; tÞ Pð' hi;ji ðtÞ ¼ dj' hi;ji ðt i Þ ¼ d i Þ, by way of the following master equation:</p><formula>d dt pðd; tÞ ¼ X d 0 2D m dd 0 pðd 0 ; tÞ ð 4Þ</formula><p>where we define m dd ¼ À P d 0 2Dnd m dd 0. Drawing type-space paths from Equation (4) is straightforward (<ref type="bibr" target="#b14">Gillespie, 1976</ref><ref type="bibr" target="#b15">Gillespie, , 1977</ref>). However, to ensure Equation (3) is satisfied, we need to be able to draw paths from the CTMC conditioned on the type d i and d j at 'both' ends of an edge hi; ji. To do this, we use the uniformization-based scheme of Fearnhead and Sherlock (2006). (A useful summary is provided by<ref type="bibr" target="#b28">Rodrigue et al. (2008).)</ref>This method involves defining a 'uniformized' version of the process that has a uniform intensity ¼ max d ½Àm dd  over the length of an edge. This is accomplished by allowing for 'do nothing' transitions that are not associated with a type change. This means that the number of transition events and the time at which the events occur do not depend on exactly which transitions occur. We can therefore sample these aspects of the type function first. The number of 'virtual' events n v , which includes the 'do nothing' transitions, is distributed according towhere " ¼ t j À t i ; Pðn v Þ is a Poissonian with rate parameter "; R is the stochastic matrix m= þ I and e m" is a matrix exponential. We sample from this distribution using the technique described in Section 2 of the Supplementary Material, then sample the event times by uniformly selecting n v times from the interval [t i ,t j ] and sorting the result. The remaining problem of sampling the transition types themselves is equivalent to sampling paths of a discrete time Markov chain conditional on the end states, and is addressed using the standard forward–backward algorithm (<ref type="bibr" target="#b0">Baum et al., 1970</ref>). One difficulty with this approach is its reliance on the matrix exponential e m". Identifying general numerical approaches to matrix exponentiation is known to be problematic (<ref type="bibr" target="#b24">Moler and Van Loan, 2003</ref>). We use the scaled Padeápproximation method as implemented in the Java library jblas (http://mikiobraun. github.io/jblas), which generally performs well. However, in our experience it can become unreliable when very large and very small (yet non-zero) migration rates exist in the same matrix. For some data and prior combinations, it may therefore be necessary to temporarily switch to an alternative proposal mechanism when the MCMC chain strays into problematic regions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Proposal acceptance probabilities</head><p>Non-unitary proposal acceptance probabilities are integral to the Metropolis–Hastings MCMC algorithm. For a given proposal operator op, a proposed state x 0 is accepted with the probability a op ðx 0 ; xÞ ¼ min 1; fðx 0 Þ fðxÞ op ðx 0 jxÞ ð6Þ where f(x) is the target density and op ðx 0 jxÞ is what we refer to as the Hastings–Green factor (HGF)—a generalization of the usual Hastings ratio to reversible jump MCMC operators (<ref type="bibr" target="#b16">Green, 1995</ref>). To calculate the HGF for each of our new operators, we need to be able to determine the probability density with which a particular type-change path is proposed. This density is given by Pð' hi;ji jd i ; d j Þ ¼ Pð' hi;ji jd i Þ Pðd j jd i Þ ð7Þ</p><p>Here Pð' hi;ji jd i Þ is the probability of the CTMC path conditional only on the most recent type, which can be derived directly from Equation (4) and is a simple product of exponential waiting time factors and transition rates. The denominator Pðd j jd i Þ is the total transition probability over the length of the edge and may be computed using the same matrix exponential e m" used in the previous section.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Structured tree operators</head><p>As described above, the tree-specific operators present in our sampler are straightforward extensions of the unstructured tree operators described by<ref type="bibr" target="#b8">Drummond et al. (2002)</ref>. They include the following:</p><p>The 'Wilson–Balding' move (<ref type="bibr" target="#b36">Wilson and Balding, 1998</ref>), which disconnects a subtree and reattaches it at a randomly chosen location on the rest of the tree. Our extension requires generating a type function for the new connecting edge.</p><p>The 'subtree exchange' move, which chooses two subtrees and switches the points at which they connect to the rest of tree. Again, our extension requires generating a type function for each of the two new edges. A 'node height shifting' move, which repositions a randomly selected internal node by drawing from a uniform distribution between its oldest child and its parent. Our implementation randomly selects a new type for the selected node and then generates three new type functions—one for each of the connecting edges. A 'tree height scaling' move, which does not alter the topology but instead scales the age of each node by a randomly chosen factor. Our extension does not generate new type functions but merely scales the times of the type changes in the same way. This move is also used by Ewing et al.</p><formula>(2004).</formula><p>In addition, we include a 'node retype' operator, which selects a new type for an internal node and generates new type functions</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">IMPLEMENTATION</head><p>We have implemented the structured tree data structure, the structured coalescent tree density and the structured tree proposal operators as a BEAST 2 package. In this section we test the correctness and efficiency of the algorithm and its implementation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Validation</head><p>In principle, a correctly implemented MCMC algorithm is capable of drawing samples from any target density or distribution defined over the state space traversed by its proposal operators. Thus, a good way to test correctness of an operator implementation is to use the implementation to produce a large number of samples from a target distribution that is either known exactly or can be sampled in some other independent way. Any disagreement between the MCMC-generated samples and the true distribution, or the externally generated samples from that distribution, is then indicative of an implementation error. In our case, the structured coalescent density itself<ref type="bibr">[Equation (2)</ref>] provides a sensible reference distribution, as its backwards-in-time Markovian structure allows structured trees to be easily sampled via stochastic simulation (<ref type="bibr" target="#b14">Gillespie, 1976</ref>). The mean and variance of the root height are also known exactly for two taxon trees (see, for example,<ref type="bibr" target="#b19">Hein et al., 2005</ref>), allowing additional testing. Finally, this choice allows us to test the implementation of the structured coalescent density. Comparisons between the tree height and migration event counts obtained using our sampler (2 Â 10 7 steps minus 2 Â 10 6 burn-in) and those obtained through 10 5 direct simulations generated using MASTER (<ref type="bibr" target="#b33">Vaughan and Drummond, 2013</ref>) for trees with five leaves having times 0, 5, 10, 15, 20 and locations 0, 1, 2, 3, 0 in a 4 deme model with y d ¼ 7 and m dd 0 ¼ 0.05 for all d,d 0 are shown in<ref type="figure" target="#fig_4">Figure 3</ref>. Additional comparisons for smaller sets of operators and against analytical results for the tree height expectations and variances are presented in Section 4 of the Supplementary Material. Together, these results are convincing evidence that the operators and structured coalescent density evaluation have been implemented correctly. Note that using this package to perform inference from genetic data exploits additional machinery already present in the core BEAST 2 platform. In particular, modules for calculating the likelihood of a tree conditional on available sequence data are used. These modules have been implemented independently and have undergone their own extensive testing, so we do not explicitly test them here. (Indeed, this is one of the benefits of implementing a method using an existing inference platform.) However, many of those components are implicitly tested in the Migrate-n comparison reported below.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Inference from simulated data</head><p>We have applied the implemented sampler to the inference of evolutionary and demographic parameters from simulated sampling data to ensure that the inference scheme is capable of recovering the truth in situations where this is known a priori. The data simulation procedure involved the following steps. (The relevant BEAST 2 XML files are provided as Supplementary Material.)</p><p>(1) A structured coalescent model was chosen with a particular set of types, D, immigration rate matrix m and population size vector y.</p><p>(2) A 128 taxon structured coalescent tree was simulated under this model using MASTER, with times of the leaf nodes spread evenly among t ¼ 0, 1, 2, 3 and the types of each set of 32 contemporaneous leaves chosen as evenly as possible from D.</p><p>(3) A randomly selected 2 kb nucelotide sequence was evolved down this tree according to the HKY model (<ref type="bibr" target="#b18">Hasegawa et al., 1985</ref>) with transition/transversion rate ratio of 3 and base substitution rate m 0 ¼ 0.005 subst./site/unit time using(4) The MCMC procedure outlined in the previous section was used to infer the parameters , m 0 , m and y, with log-normal prior distributions ln N ð0; 4Þ on each element of these parameters. A total of 10 8 MCMC steps were generated, with the first 10% being discarded to account for burn-in, resulting in an average effective sample size (ESS) of 1164 (5 and 95% sample quantiles 277 and 2425) for the slowest mixing parameter. The diagrams in the first column of<ref type="figure" target="#tab_1">Table 1</ref>illustrate three different structured coalescent models, with the nodes representing types D, the numeric labels on the nodes representing values of y, the edges representing allowed transitions between these types and the numeric labels on the edges representing the values of m. The simulation and inference procedure was carried out 100 times for each of these models. The four right-most columns of the table present the fractions of inference runs that included the truth of the parameter at the head of the column within the 95% highest posterior density (HPD). In the case of y and m, the average over each of the elements is displayed. Note that in the 4 deme mode, only the non-zero elements of m were used to calculate the coverage fraction although all elements were independently estimated. Section 5 of the Supplementary Material describes these results in more detail. An important message to convey here is that increasing the number of demes without increasing the available data can have strong negative effects on the amount of signal that can be recovered. For this reason, while the sampler itself is capable of sampling from structured tree distributions with higher numbers of demes (as shown in Section 5.2 of the Supplementary Material), doing so requires additional constraints on the model. In our experience, 3–4 demes seems to be an upper limit for inference from a 128 taxon dataset if all migration rates are to be reliably estimated (given non-informative priors).</p><formula>(a) ( b) (c) ( d)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Comparison with Ewing et al., 2004</head><p>To compare the new structured tree operators with those of<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>, we have implemented the operators described in that paper in our BEAST 2 package and used them to analyse the same simulated data sets described above. As each set of operators is capable of traversing the structured tree state space, there should be no difference in the inference results obtained by each set given sufficient MCMC steps. However, as discussed in Section 3, the specific proposal distributions used can have a significant impact on the rate at which the Markov chain produces effectively independent samples from the target distribution. This rate can be quantified using the inverse of the integrated auto-correlation time (IACT): the number of effectively independent samples (i.e. the ESS) generated per iteration of the MCMC algorithm. While IACT is usually expressed in terms of MCMC iterations, we use the total computation times used by each inference run to express it in terms of real time. This 'effective sample rate' (ESR) allows us to directly compare the computational efficiency of our proposal operators with those of<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>, despite the fact that their operators are individually less computationally demanding. Such rates will depend on the specific hardware used to perform the computations, of course, but useful comparisons can still be made provided the same hardware is used across all analyses.<ref type="figure" target="#fig_5">Figure 4</ref>shows how the ESRs for demographic (y and m), evolutionary (m 0 ) and genealogy-related (time of most recent common ancestor, t r ) parameters depend on the number of types, jDj, and the operator set used. Two features are immediately obvious. Firstly, there is a clear decline in ESR as the number of types increases, which is to be expected due to the corresponding increase in the size of the state space. Secondly, the ESR estimates obtained from the new proposal operators are greater than those obtained using our implementation of the operators proposed by<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>. This improvementEfficient Bayesian inference under the structured coalescent is particularly striking in the case of the t r parameter, for which our method produced at least an order of magnitude as many effective samples per unit time as our implementation of the previously published method. We therefore find that the new operators presented here generally outperform our implementation of the<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>operators, in spite of the additional computational complexity of our proposals.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Comparison with Migrate-n</head><p>Migrate-n (<ref type="bibr" target="#b2">Beerli and</ref><ref type="bibr">Felsenstein, 1999, 2001;</ref><ref type="bibr" target="#b2">Beerli, 2006</ref>) has long been a popular tool for performing both Bayesian and maximum-likelihood analysis under the structured coalescent. There are numerous differences between the MCMC sampler presented here and Migrate-n: we focus on providing the capability to perform joint estimation of heterochronous structured trees, demographic model parameters and substitution model parameters, while Migrate-n excels at demographic model parameter inference for trees with fixed clock rates or times expressed relative to an unknown substitution rate. Despite this, it is possible to analyse some datasets under exactly equivalent assumptions in both packages. In Section 6 of the Supplementary Material, we directly compare sampled posteriors obtained for model parameters from heterochronous sequence datasets simulated under 2 and 3 deme models, assuming a known clock rate m 0 , and find perfect agreement. Given the complete independence of these implementations, this is extremely strong evidence that both samplers are implemented correctly.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5">Application to global influenza epidemics</head><p>To assess the usefulness of our sampling strategy and its implementation in the context of real genetic data, we address the problem of inferring global dynamics of influenza epidemics from genetic data. To do this, we assembled 980 H3N2 1.6kb HA sequences from NCBI GenBank, which were isolated from humans in Hong Kong (n ¼ 220), New York (n ¼ 320) and New Zealand (n ¼ 440) between the years 2000 and 2006. (Accession numbers, sampling times and locations are tabulated in the Supplementary Material.) These locations were chosen to be representative of northern, southern and equatorial regions having human population sizes of comparable order of magnitude, while the sampling time boundaries were chosen to ensure a roughly even temporal and spatial distribution of samples. Additionally, these locations and times allow comparison with the study of global H3N2 dynamics conducted by<ref type="bibr">Bedford</ref><ref type="figure">Figure 5</ref>summarizes some of the results of this analysis, including the maximum sampled posterior tree, and posterior distributions for the root location, the subpopulation sizes y and the molecular clock rate m 0. Assuming a constant generation time, the differences between elements of y reflect differences in effective population sizes of the virus populations. It is therefore interesting that the order of these sizes corresponds to the ordering of the human population sizes: New Zealand (smallest), Hong Kong, New York (largest). Furthermore, the estimated base mutation rate m 0 ' 5 Â 10 À3 substitutions/site/year [95% HPD interval ð4:5 Â 10 À3 ; 5:5 Â 10 À3 Þ] is in line with previous estimates for the HA gene (<ref type="bibr" target="#b27">Rambaut et al., 2008</ref>). The placement of the root of the maximum sampled posterior tree in New York is in agreement with the posterior probability distribution of the root location (<ref type="figure">Fig. 5b</ref>). This may seem contrary to conventional wisdom that Asia provides the source for seasonal influenza epidemics (<ref type="bibr" target="#b29">Russell et al., 2008</ref>). However, the location of the root is very much a function of the particular dataset used. Furthermore, our result is in line with the results of<ref type="bibr" target="#b1">Bedford et al. (2010)</ref>who applied a hierarchical approach to a much larger dataset and found that the 'trunk' location of their sampled H3N2 transmission tree was likely also within the USA at the time of the root of our tree (mid 1998).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">DISCUSSION</head><p>Taken together, the results above are strong evidence that our new algorithm and its implementation are correct, computationally efficient and capable of analysing large datasets. However, the algorithm presented here does not address problems that are fundamental to the structured coalescent. As discussed in detail by<ref type="bibr" target="#b10">Ewing et al. (2004)</ref>, the structured coalescent tree density<ref type="figure">Fig. 5</ref>. Summary of results from spatial H3N2 influenza analysis, including (a) the 980 taxon maximum sampled posterior structured tree, the sampled posterior probability distributions for (b) the root location, (c) the subpopulation sizes and (d) the base substitution rate (substitutions/site/year). The grey lines in (c) and (d) show the visible portions of the log N ð0; 4Þ prior used for all of these parameters, scaled vertically for clarity T.G.Vaughan et al.</p><formula>(a) (b) (c) ( d)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>[Equation</head><p>(2)] can yield improper posterior densities for elements of the migration rate and population size parameters when uninformative priors are used. In our experience, this can still lead to slow mixing with proper but broad priors. In such cases, we suggest following the advice of Ewing et al. (2004) by imposing sensible upper and lower bounds on the demographic parameters whenever known. There are many possible extensions to this work. Firstly, as we discuss in Section 1 of the Supplementary Material, other models involving structured trees exist beyond the structured coalescent. Some of these are likely to be particularly important in the field of viral phylodynamics, where the overlapping epidemiological and evolutionary time scales mean that birth–death sampling models (<ref type="bibr" target="#b31">Stadler, 2008</ref>) or generalized coalescent processes (<ref type="bibr" target="#b34">Volz, 2012</ref>) are needed to explain the sequence data. Developing, implementing and testing the performance of our proposal operators on spatial extensions to these models will therefore be an important area of future research. Secondly, the problem of summarizing large numbers of structured trees sampled from posterior distributions requires special attention. While existing techniques for summarizing phylogenetic tree distributions [Felsenstein (2003) provides a good review] allow for the un-typed component of the trees in the sampled set to be summarized, this discards useful information. In our influenza analysis we chose to use the sampled structured tree with the HPD. While retaining type information, this approach is also suboptimal because it gives no indication of the uncertainty associated with the type-change paths depicted. The BEAST 2 package implementing the algorithms discussed in this article and used in the analyses may be found at http:// compevol.github.io/MultiTypeTree, together with an example analysis and a tutorial. The software source code is available under the GNU General Public License and is highly extensible, making third-party implementation of further structured tree models practical.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. A structured tree T ¼ ðV; E; t; MÞ with V ¼ I [ Y where I ¼ fx; y; zg; Y ¼ fi; jg, E ¼ fhx; ii; hy; ii; hi; ji; hz; jig and the coalescence times t and type mappings M are as shown. Here we have selected the type set D ¼ fblue; red; green; orangeg, although this can be composed of the values of any discrete trait</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>2275Efficient</head><figDesc>Bayesian inference under the structured coalescent for the connecting edges. (This is a special case of the node height shift move.) The actions of these operators are illustrated in Figure 2. For complete operator descriptions including HGFs, refer to Section 3 of the Supplementary Material.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.2.</head><figDesc>Fig. 2. Schematics illustrating actions of the tree-specific operators used in our structured tree MCMC algorithm, including structured tree implementations of the (a) Wilson–Balding, (b) subtree exchange, (c) node height shift and (d) tree scaling operators. The solid edge shadings represent the deme to which each lineage belongs at each time. Double white lines represent edges for which new type functions will be proposed as part of the move, crosses represent edges to be removed and dashes represent edges that may continue beyond the schematic boundary</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.3.</head><figDesc>Fig. 3. Agreement of (a) tree height and (b) migration count distributions sampled from the structured coalescent distribution using our implementation of the described MCMC algorithm (black lines) with those generated via direct simulation (grey lines). See text for more detail</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.4.</head><figDesc>Fig. 4. ESRs per hour of MCMC calculation recorded from the simulated data analyses using both the new proposal operators and our implementation of those developed by Ewing et al. (2004) (ENR), where y is the vector of population sizes, m is the immigration rate matrix, m 0 is the clock rate and t r is the age of the root. Values for the vector/matrix parameters y and m were averaged across all elements</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>et al. (2010). The data were analysed under a 3 deme structured coalescent model with a GTRþÀ nucleotide substitution model and a strict molecular clock. As for the simulated data, the heterochronous sampling times and rapid evolution of influenza allowed for joint estimation of the clock rate, m 0. Broad log-normal priors log N ð0; 4Þ were used for all population size and rate parameters. Due to the large size of the data set, the MCMC algorithm was run for 3.7 Â 10 8 iterations to ensure adequate mixing, giving a 'minimum' ESS across the sampled parameters of $150. Two additional chains of 3.3 Â 10 8 iterations each were run to assess convergence. (See Section 7 of the Supplementary Material for details, the full set of results and ESS estimates.)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. location to explicitly affect coalescent rate. (This is discussed in Section 1 of the Supplementary Material.) At least two distinct Markov Chain Monte Carlo (MCMC)</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 1. 95% HPD coverage fractions for demographic (population sizes y, immigration rates m) and evolutionary parameters (clock rate m 0 , transition/transversion ratio ) inferred from simulated sequence data under structured population models with different numbers jDj of subpopulations</figDesc><table>Model 
jDj y coverage 
(%) 

m coverage 
(%) 

m 0 coverage 
(%) 

coverage 
(%) 

2 
95.5 
96 
97 
98 

3 
92.3 
93.7 
92 
97 

4 
93.5 
86 
96 
96 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="1"> y d n c d ð2Þ where y d ¼ N d g are population sizes scaled by the generation length and m dd 0 ðy d =y d 0 Þq d 0 d are the immigration rates into d from d 0 (per individual in d 0 ). (This is essentially Equation (3) from Beerli and Felsenstein (2001) but allowing for heterochronous leaves.) The structured coalescent, as well as other models including the reversible Markov model used by Lemey et al. (2009), imposes the following additional constraint on the structured tree beyond those laid out in section 2.1: that the type functions for all edges meeting at node i possess the same value at t i. Formally, &apos; hi;ipi ðt i Þ ¼ &apos; hicl;ii ðt i Þ ¼ &apos; hicr;ii ðt i Þ ð 3Þ where i p ; i cl and i cr are the parent, left child and right child of i, respectively.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors also wish to acknowledge the contribution of the NeSI high-performance computing facilities and the staff at the Centre for eResearch at the University of Auckland. The authors thank Peter Beerli for helpful comments and suggestions.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">E</forename>
				<surname>Baum</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Math. Stat</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page">164</biblScope>
			<date type="published" when="1970" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Global migration dynamics underlie evolution and persistence of human influenza A (H3N2)</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Bedford</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Pathog</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Comparison of Bayesian and maximum-likelihood inference of population genetic parameters</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Beerli</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="341" to="345" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Maximum-likelihood estimation of migration rates and effective population numbers in two populations using a coalescent approach</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Beerli</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">152</biblScope>
			<biblScope unit="page" from="763" to="773" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Maximum likelihood estimation of a migration matrix and effective population sizes in n subpopulations by using a coalescent approach</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Beerli</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA, 98</title>
		<meeting>. Natl Acad. Sci. USA, 98</meeting>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="4563" to="4568" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">BEAST 2: a software platform for Bayesian evolutionary analysis</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Bouckaert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comp. Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">1003537</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">BEAST: Bayesian evolutionary analysis by sampling trees</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Rambaut</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Evol. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">214</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Relaxed phylogenetics and dating with confidence</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Biol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page">88</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="page" from="161" to="1307" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Bayesian phylogenetics with BEAUti and the BEAST 1.7</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1969" to="1973" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Using temporally spaced sequences to simultaneously estimate migration rates, mutation rate and population sizes in measurably evolving populations</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">168</biblScope>
			<biblScope unit="page" from="2407" to="2420" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">An exact Gibbs sampler for the Markovmodulated Poisson process</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Fearnhead</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Sherlock</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. R. Stat. Soc. Ser. B</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="page">767</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Evolutionary trees from DNA sequences: a maximum likelihood approach</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Evol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="368" to="376" />
			<date type="published" when="1981" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<monogr>
		<title level="m" type="main">Inferring Phylogenies</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
			<pubPlace>Sinauer Associates, Massachusetts</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">T</forename>
				<surname>Gillespie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comp. Phys</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page">403</biblScope>
			<date type="published" when="1976" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Stochastic simulation of coupled chemical reactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">T</forename>
				<surname>Gillespie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Phys. Chem</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page">2340</biblScope>
			<date type="published" when="1977" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Green</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="page" from="711" to="732" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Unifying the epidemiological and evolutionary dynamics of pathogens</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">T</forename>
				<surname>Grenfell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">303</biblScope>
			<biblScope unit="page" from="327" to="332" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Dating of the human-ape splitting by a molecular clock of mitochondrial DNA</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Hasegawa</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Evol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="160" to="174" />
			<date type="published" when="1985" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<monogr>
		<title level="m" type="main">Gene Genealogies, Variation and Evolution: a Primer in Coalescent Theory</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Hein</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
			<publisher>Oxford University Press</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Gene genealogies and the coalescent process</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Oxf. Surv. Evol. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">1</biblScope>
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">On the genealogy of large populations</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">F C</forename>
				<surname>Kingman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Appl. Probab</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page">27</biblScope>
			<date type="published" when="1982" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Phylogenetic and epidemic modeling of rapidly evolving infectious diseases</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Ku¨hnertku¨hnert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Infect. Genet. Evol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="1825" to="1841" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Bayesian phylogeography finds its roots</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Lemey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">1000520</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Nineteen dubious ways to compute the exponential of a matrix, twenty-five years later</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Moler</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Van Loan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Rev</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="3" to="49" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">The coalescent and the genealogical process in geographically structured population</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Notohara</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Math. Biol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="59" to="75" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Coalescence in a metapopulation with recurrent local extinction and recolonization</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">R</forename>
				<surname>Pannell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="949" to="961" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">The genomic and epidemiological dynamics of human influenza A virus</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Rambaut</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">453</biblScope>
			<biblScope unit="page" from="615" to="619" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Uniformization for sampling realizations of Markov processes: applications to Bayesian implementations of codon substitution models</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Rodrigue</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="56" to="62" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b29">
	<analytic>
		<title level="a" type="main">The global circulation of seasonal influenza a (H3N2) viruses</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">A</forename>
				<surname>Russell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">320</biblScope>
			<biblScope unit="page" from="340" to="346" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b30">
	<analytic>
		<title level="a" type="main">Estimating absolute rates of molecular evolution and divergence times: a penalized likelihood approach</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Sanderson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="101" to="109" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b31">
	<analytic>
		<title level="a" type="main">Lineages-through-time plots of neutral models for speciation</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Stadler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Biosci</title>
		<imprint>
			<biblScope unit="volume">216</biblScope>
			<biblScope unit="page" from="163" to="171" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b32">
	<analytic>
		<title level="a" type="main">Estimating the rate of evolution of the rate of molecular evolution</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">L</forename>
				<surname>Thorne</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="1647" to="1657" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b33">
	<analytic>
		<title level="a" type="main">A stochastic simulator of birth-death master equations with application to phylodynamics</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">G</forename>
				<surname>Vaughan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="1480" to="1493" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b34">
	<analytic>
		<title level="a" type="main">Complex population dynamics and the coalescent under neutrality</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">M</forename>
				<surname>Volz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">190</biblScope>
			<biblScope unit="page" from="187" to="201" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b35">
	<analytic>
		<title level="a" type="main">Viral phylodynamics</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">M</forename>
				<surname>Volz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">1002947</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b36">
	<analytic>
		<title level="a" type="main">Genealogical inference from microsatellite data</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<forename type="middle">J</forename>
				<surname>Wilson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">J</forename>
				<surname>Balding</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">150</biblScope>
			<biblScope unit="page" from="499" to="510" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b37">
	<monogr>
		<title level="m" type="main">Efficient Bayesian inference under the structured coalescent</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>