
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:57+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">fqtools: an efficient software suite for modern FASTQ file manipulation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Alastair</forename>
								<forename type="middle">P</forename>
								<surname>Droop</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">MRC Medical Bioinformatics Centre</orgName>
								<orgName type="institution">University of Leeds</orgName>
								<address>
									<addrLine>Clarendon Way</addrLine>
									<postCode>LS2 9NL</postCode>
									<settlement>Leeds</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">fqtools: an efficient software suite for modern FASTQ file manipulation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw088</idno>
					<note type="submission">Received on September 23, 2015; revised on January 15, 2016; accepted on February 11, 2016</note>
					<note>Sequence analysis Associate Editor: Inanc Birol *To whom correspondence should be addressed. Supplementary information: Supplementary data are available at Bioinformatics online. Contact: a.p.droop@leeds.ac.uk</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Many Next Generation Sequencing analyses involve the basic manipulation of input sequence data before downstream processing (e.g. searching for specific sequences, format conversion or basic file statistics). The rapidly increasing data volumes involved in NGS make any dataset manipulation a time-consuming and error-prone process. I have developed fqtools; a fast and reliable FASTQ file manipulation suite that can process the full set of valid FASTQ files, including those with multi-line sequences, whilst identifying invalid files. Fqtools is faster than similar tools, and is designed for use in automatic processing pipelines. Availability and implementation: fqtools is open source and is available at: https://github.com/alas tair-droop/fqtools.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The FASTQ format has become the de facto standard for storage of next-generation sequencing read data (<ref type="bibr" target="#b0">Cock et al., 2010</ref>). Based originally upon the FASTA sequence format (<ref type="bibr" target="#b4">Pearson and Lipman, 1988</ref>), FASTQ stores nucleotide sequences and associated base qualities (<ref type="bibr" target="#b1">Ewing and Green, 1998</ref>) for multiple named reads in a fourfield human-readable ASCII format. Although there is no defined standard for FASTQ files,<ref type="bibr" target="#b0">Cock et al. (2010)</ref>provide a good overview of the format, and provide as close to a 'standard' as is available. Many analysis pipelines involve initial data manipulation (e.g. reformatting, viewing or overview statistics) before downstream processing (e.g. quality control, adapter removal and alignment). Seemingly simple tasks like viewing the first few reads in a file or checking the distribution of read lengths often require scripting or loading the data in tools that are quite slow for large datasets. These file manipulations are much more frequent when data are being reused in novel analyses. Frequently, individual researchers will write scripts (e.g. in Python, Perl or AWK) to perform these tasks. Many tools are available for FASTQ processing such as the fastx-toolkit, bio-awk, fastq-tools, fast, seqmagick and seq-tk (see the Supplementary Materials for the URLs of these tools). None of these provide a comprehensive set of common manipulations that would be required for most analyses. Most FASTQ processing tools fail to process reads with sequence data split across multiple lines. As read lengths from modern sequencing technologies are constantly increasing (<ref type="bibr" target="#b5">Schneider and Dekker, 2012</ref>), this is likely to become problematic as human readability is vastly reduced by extremely long lines. Detecting invalid input is extremely important, as bioinformatics pipelines are often automated; thus significant computation and analysis time can be wasted if input errors are not detected early. For this reason, a trustworthy FASTQ manipulation tool should report invalid files. Similarly, tools should be able to correctly process the full range of valid inputs. The fqtools suite was written to address this need for efficient and reliable viewing, manipulation and summarization of FASTQ data before it is pre-processed (with e.g. FastQC [http://www.bio informatics.babraham.ac.uk/projects/fastqc/) or cutadapt (<ref type="bibr" target="#b3">Martin, 2011)]</ref>. Both compressed and plain FASTQ can be processed, as can SAM and BAM-formatted data. Paired-end sequence data is handled either as file pairs or in interleaved format (<ref type="figure" target="#tab_1">Table 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Implementation</head><p>I have developed a fast and memory-efficient state machine for parsing FASTQ files. The use of a state machine (as opposed to a linebased approach) obviates the difficulties with line breaks in sequence and quality data. As read order must be identical for both paired-end files, manipulations that re-order reads process both pairs simultaneously. The fqtools suite has been written to allow input and output from either files or standard streams. Both files and streams can contain either plain or gzip-compressed data. By using streams, the fqtools suite can be easily incorporated into computational pipelines. The commands contained in the fqtools suite are listed in<ref type="figure">Table 2</ref>, along with a brief description of their purpose.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Performance</head><p>I tested several common sequence manipulation tools against four criteria: i. The ability to process the full range of valid FASTQ files; ii. The ability to detect the full range of FASTQ errors; iii. The ability to read and write compressed data; and iv. The processing speed. To evaluate the ability of the fqtools suite to correctly process valid files and to reject invalid ones, I used the test set provided by<ref type="bibr" target="#b0">Cock et al. (2010)</ref>. The performance of the fqtools suite was tested against several similar tools using a sample file containing 100 000 reads generated using ART (<ref type="bibr" target="#b2">Huang et al., 2012</ref>).<ref type="figure">Table 2</ref>shows these results. For all tools, the closest option to parsing the file without further processing was used. The lowest time score over 50 repeats was taken. Speed results for printing the files on the bash terminal are supplied for a 'maximum speed' reference, although these commands make no attempt to parse the FASTQ data within the file. Full data are available in the supplementary information. Of the tools tested, only three (fqtools, fast and seqmagick) correctly processed the full test set. Of these three, fqtools is by far the fastest when processing both uncompressed and compressed files. Although several of these tools are designed to be extendable, data processing speed for basic FASTQ manipulation is becoming increasingly important. For these tasks, the flexibility of interpreted tools (such as seqmagick and fast) is unnecessary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Summary</head><p>Here, I describe fastqc, a suite of FASTQ manipulations tools that efficiently handles the full range of valid FASTQ, whilst detecting invalid files. The suite can process both compressed and uncompressed files. fqtools is freely available on Github at https://github.com/alas tair-droop/fqtools.Benchmark data for various FASTQ processing tools. All tools were installed locally, and run against the complete test set (<ref type="bibr" target="#b0">Cock et al., 2010</ref>). Valid shows if all the valid test set were processed correctly. Invalid shows if the tool identified all the invalid files. Process .gz shows if the tool can natively read (R) and write (W) gzip-compressed files. The speed columns show the speed in reads per second.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Commands present in the fqtools suite</figDesc><table>Description 

view 
View FASTQ files 
head 
View the first reads in FASTQ files 
count 
Count FASTQ file reads 
header 
View FASTQ file header data 
sequence 
View FASTQ file sequence data 
quality 
View FASTQ file quality data 
header2 
View FASTQ file secondary header data 
fasta 
Convert FASTQ files to FASTA format 
basetab 
Tabulate FASTQ base frequencies 
qualtab 
Tabulate FASTQ quality character frequencies 
lengthtab 
Tabulate FASTQ read lengths 
type 
Attempt to guess the FASTQ quality encoding type 
validate 
Validate FASTQ files 
find 
Find FASTQ reads containing specific sequences 
trim 
Trim reads in a FASTQ file 
qualmap 
Translate quality values using a mapping file 

Commands present in the fqtools suite. The supplementary information 
contains a full description of each command. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 2. FASTQ processing tools overview</figDesc><table>Valid 
Invalid 
Process 
.gz 

Plain 
(reads/s) 

Compressed 
(reads/) 

fqtools 
Y 
Y 
RþW 
701 375 
444 648 
bash 
— 
— 
RþW 
2 605 421 
934 331 
bioawk 
Y 
N 
R 
434 632 
312 708 
seqtk 
Y 
N 
R 
1 122 355 
545 865 
fast 
Y 
Y 
— 
2984 
— 
fastx-toolkit 
N 
N 
— 
69 762 
— 
seqmagick 
Y 
Y 
RþW 
25 325 
4000 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">A.P.Droop at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">J A</forename>
				<surname>Cock</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="1767" to="1771" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Base-calling of automated sequencer traces using phred. II. Error probabilities</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Green</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="186" to="194" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">ART: a next-generation sequencing read simulator</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Huang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="593" to="594" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Cutadapt removes adapter sequences from high-throughput sequencing reads</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Martin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">EMBnet.J</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="10" to="12" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Improved tools for biological sequence comparison</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">R</forename>
				<surname>Pearson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">J</forename>
				<surname>Lipman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="1988" />
			<biblScope unit="page" from="2444" to="2448" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">DNA sequencing with nanopores</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">F</forename>
				<surname>Schneider</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Dekker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="326" to="328" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>