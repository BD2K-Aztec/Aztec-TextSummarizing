
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:50+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">WALT: fast and accurate read mapping for bisulfite sequencing</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Haifeng</forename>
								<surname>Chen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Molecular and Computational Biology</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Andrew</forename>
								<forename type="middle">D</forename>
								<surname>Smith</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Molecular and Computational Biology</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ting</forename>
								<surname>Chen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Molecular and Computational Biology</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">WALT: fast and accurate read mapping for bisulfite sequencing</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw490</idno>
					<note type="submission">Received on April 18, 2016; revised on June 17, 2016; accepted on July 16, 2016</note>
					<note>Sequence analysis *To whom correspondence should be addressed. Associate Editor: Inanc Birol Availability and implementation: WALT is available under the GPL v3 license, and downloadable from https://github.com/smithlabcode/walt. Contact: andrewds@usc.edu or tingchen@usc.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Whole-genome bisulfite sequencing (WGBS) has emerged as the gold-standard technique in genome-scale studies of DNA methylation. Mapping reads from WGBS requires unique considerations that make the process more time-consuming than in other sequencing applications. Typical WGBS data sets contain several hundred million reads, adding to this analysis challenge. We present the WALT tool for mapping WGBS reads. WALT uses a strategy of hashing periodic spaced seeds, which leads to significant speedup compared with the most efficient methods currently available. Although many existing WGBS mappers slow down with read length, WALT improves in speed. Importantly, these speed gains do not sacrifice accuracy.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>DNA methylation is essential for many biological processes and is found altered in a variety of human diseases (<ref type="bibr" target="#b0">Bock, 2012</ref>). Technological advances over the past decade have enabled wholegenome bisulfite sequencing (WGBS), which has become the goldstandard approach for studying cytosine (C) methylation due to its ability to quantify methylation levels unambiguously for nearly all Cs in mammalian genomes. Treatment with sodium bisulfite converts each unmethylated C into uracil, which is reported as thymine (T) in sequenced reads. The most computationally intensive step analysis of WGBS data is to map reads to the reference genome. The bisulfite conversion makes mapping more complicated, and each data set typically includes hundreds of millions of reads. In recent years, several mappers have been developed specifically for reads from bisulfite sequencing, which we refer to here as 'bisulfite reads'. These mappers use a variety of strategies. For example, Bismark (<ref type="bibr" target="#b4">Krueger and Andrews, 2011</ref>) converts every C in the reads and the reference genome to T, then applies Bowtie (<ref type="bibr" target="#b5">Langmead et al., 2009</ref>) to map the converted reads to the converted reference genome. BSMAP (<ref type="bibr" target="#b6">Xi and Li, 2009</ref>) builds a pre-compiled hash table to minimize the cache-miss latency when searching possible genome positions for k-mers. BSMAP also applies a bitwise masking method to efficiently count the number of mismatches for asymmetric conversion of C!T. Existing tools are not fast enough to map a large WGBS data set in a day using a single processing core. The challenge in mapping bisulfite reads is derived from two related sources: accommodating the asymmetric conversion of C!T, and the reduced entropy of the alphabet (i.e. nearly 50% T). Here we present WALT, a new mapper for bisulfite reads. WALT is faster than existing methods, and has advantages in accuracy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>WALT employs periodic spaced seeds, originally described by<ref type="bibr" target="#b1">Chen et al. (2009)</ref>, to filter candidate mapping positions for each read. Three spaced seeds (010) *, 0(010) * and 00(010) * are used to guarantee full sensitivity for two mismatches (Supplementary<ref type="figure" target="#tab_1">Table S1</ref>). The ones ('1') in the spaced seeds indicate positions that must match, while the zeros ('0') indicate positions that are not required to match. The star ('*') indicates repeating of the 010 pattern until V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com the spaced seed reaches the desired weight. Three seeds are generated for a given read, and each seed is obtained by concatenating all positions in the read corresponding to a '1' in the spaced seed. WALT converts all Cs in both the reads and the reference genome to Ts for mapping. When processing paired-end reads, or in the case of post-bisulfite adaptor ligation, some reads will be complementary to the original converted strand. For those A-rich reads, guanines (G) are converted to adenines (A). WALT builds four hash tables for converted reference genomes: C!T forward and reverse, G!A forward and reverse. For one hash table, the 3 k possible kmers over {A, G, T} or {A, C, T} are used as hash keys. Each hash bucket contains genome positions where the corresponding spaced seed can be found. The genome positions in each bucket are sorted by their spaced seed subsequences (Supplementary<ref type="figure">Fig. S2</ref>). When mapping a read, the first k nucleotides of each seed are used to locate hash buckets and binary search is applied for nucleotides after the first k. WALT validates each candidate position by aligning the whole read against the genome sequence to count the number of mismatches. For a given read, exact matching genomic positions are identified using the first seed, positions with one mismatch are covered by first two seeds, and using all three seeds guarantees full sensitivity for two mismatches (Supplementary<ref type="figure" target="#fig_1">Fig. S1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>We assessed the performance of WALT in comparison with Bismark, BSMAP and other tools shown in Supplementary Material. All tests were run using identical Intel Xeon processors using a single core (details in Supplementary Material). We used three datasets: (1) SRR1532534, (2) SRR948855 (<ref type="bibr" target="#b2">Fortin et al., 2014</ref>) and (3) SRR2296821 (<ref type="bibr" target="#b7">Yong-Villalobos et al., 2015</ref>) for this comparison, evaluating both speed and accuracy. All of them are paired-end data by Illumina HiSeq 2000. The read length, reference genome and number of reads in each dataset are shown in<ref type="figure" target="#tab_1">Table 1</ref>. For the two human datasets,<ref type="figure" target="#tab_2">Table 2</ref>shows a comparison of runtimes for WALT, Bismark and BSMAP. WALT is about 36Â faster than Bismark and 7Â faster than BSMAP in single-end mapping. For paired-end mapping, WALT is approximately 15Â faster than Bismark and 7Â faster than BSMAP. WALT does a look-up for three seeds when reads have more than one mismatch, but only one seed for exact matches, and two for one or two mismatches. Since In our experiments, on the average 61.8% and 11.1% of reads are matched with 0 and 1 mismatch, respectively, the average number of lookups per read is only 1.49 (Supplementary<ref type="figure" target="#tab_1">Table S13</ref>). The Arabidopsis thaliana genome is relatively small, leading to fewer candidates in each hash bucket. Even with this small genome, WALT nearly matches the speed of BSMAP and is still approximately 25Â faster than Bismark.<ref type="figure" target="#fig_1">Figure 1</ref>shows the runtime on reads with different lengths generated from SRR948855 (Supplementary<ref type="figure" target="#tab_1">Table S12</ref>). WALT runs faster on longer reads, while Bismark and BSMAP slow down significantly. WALT and BSMAP both are based on hash table method. The time required to validate each candidate mapping location is proportional to the read length. However, WALT uses heavier seeds for longer reads and gets less false positive candidates, while BSMAP uses fixed seed length. Bismark uses Bowtie to map the reads, which essentially conducts an inexact search in a compressed suffix array, which is also more costly for longer reads. Mapping accuracy is essential in WGBS as incorrect mapping may lead to bias in estimates of methylation levels and other epigenomic features in downstream analyses. Ambiguously mapping reads—those for which the best matching genome position is not unique—are excluded from most analyses as their interpretation requires project-specific considerations. We used the program mrsFAST (<ref type="bibr" target="#b3">Hach et al., 2010</ref>), with C!T converted reads and reference genome, to obtain all possible mapping positions for all reads; mrsFAST is designed to produce all mappings. This provided a ground truth in measuring mapping accuracy. For a uniquely mappable read (as determined by mrsFAST), if the bisulfite mapper reports it as uniquely mapping, then it counts as true positive (TP),</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Runtime as a function of read length</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Information about data sets used</figDesc><table>Data set 
Read length 
Genome 
No. of reads 

(1) SRR1532534 
90 
Human (hg19) 
50,000,000 
(2) SRR948855 
100 
Human (hg19) 
50,000,000 
(3) SRR2296821 
90 
Arabidopsis (TAIR10) 21,543,659 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 2.</figDesc><table>Runtime of WALT, Bismark and BSMAP (hours) 

Single-end 
Paired-end 

WALT 
Bismark 
BSMAP 
WALT 
Bismark 
BSMAP 

(1) 
0.71 
26.85 
4.14 
2.43 
38.72 
12.32 
(2) 
0.85 
29.13 
6.09 
2.61 
37.10 
21.55 
(3) 
0.09 
3.11 
0.09 
0.32 
7.46 
0.22 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 3.</figDesc><table>Recall (R) and precision (P) of WALT, Bismark and BSMAP 

Single-end 
Paired-end 

WALT 
Bismark 
BSMAP 
WALT 
Bismark 
BSMAP 

(1) R 
0.982 
0.973 
0.994 
0.965 
0.968 
0.991 
P 
0.991 
0.976 
0.988 
0.984 
0.943 
0.967 
(2) R 
0.984 
0.974 
0.995 
0.971 
0.972 
0.993 
P 
0.993 
0.969 
0.991 
0.989 
0.935 
0.973 
(3) R 
0.987 
0.974 
0.995 
0.986 
0.959 
0.994 
P 
0.995 
0.978 
0.993 
0.996 
0.960 
0.967 </table></figure>

			<note place="foot" n="1"> Bioinformatics, 2016, 1–3 doi: 10.1093/bioinformatics/btw490 Advance Access Publication Date: 27 July 2016 Applications Note Bioinformatics Advance Access published August 14, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from otherwise false negative (FN). For a read found to be ambiguously mapped or unmapped, if the bisulfite mapper reports it as such it counts as TN, otherwise FP. We then compute precision and recall for each mapper: Recall ¼ TP=ðTP þ FNÞ and Precision ¼ TP=ðTP þ FPÞ: WALT had the best precision while BSMAP had the best recall on all datasets (Table 3). Bismark had the lowest recall and precision. BSMAP reported 27 and 293% more incorrect uniquely mapped reads than WALT in single-and paired-end mapping, respectively.</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>We thank Benjamin Decato and Meng Zhou for valuable comments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was partially supported by National Institutes of Health grant HG006015 (ADS)</p><p>Conflict of Interest: none declared.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Analysing and interpreting DNA methylation data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Bock</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Gen</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="705" to="719" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">PerM: efficient mapping of short sequencing reads with periodic full sensitive spaced seeds</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2514" to="2521" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Functional normalization of 450k methylation array data improves replication in large cancer studies</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">P</forename>
				<surname>Fortin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">503</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">mrsFAST: a cache-oblivious algorithm for short-read mapping</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Hach</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="576" to="577" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Bismark: a flexible aligner and methylation caller for bisulfite-seq applications</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Krueger</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Andrews</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1571" to="1572" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">BSMAP: whole genome bisulfite sequence MAPping program</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Xi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">232</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Methylome analysis reveals an important role for epigenetic changes in the regulation of the Arabidopsis response to phosphate starvation</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Yong-Villalobos</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="page" from="7293" to="7302" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>