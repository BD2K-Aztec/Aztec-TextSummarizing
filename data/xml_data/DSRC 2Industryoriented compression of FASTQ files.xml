
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:57+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis DSRC 2—Industry-oriented compression of FASTQ files</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Lukasz</forename>
								<surname>Roguski</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Polish-Japanese Institute of Information Technology</orgName>
								<address>
									<postCode>02-008</postCode>
									<settlement>Warszawa</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sebastian</forename>
								<surname>Deorowicz</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Institute of Informatics</orgName>
								<orgName type="institution">Silesian University of Technology</orgName>
								<address>
									<postCode>44-100</postCode>
									<settlement>Gliwice</settlement>
									<country key="PL">Poland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis DSRC 2—Industry-oriented compression of FASTQ files</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">15</biblScope>
							<biblScope unit="page" from="2213" to="2215"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu208</idno>
					<note type="submission">Received on December 3, 2013; revised on April 1, 2014; accepted on April 16, 2014</note>
					<note>Associate Editor: Michael Brudno Contact: sebastian.deorowicz@polsl.pl Supplementary information: Supplementary data are available at Bioinformatics online</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Modern sequencing platforms produce huge amounts of data. Archiving them raises major problems but is crucial for reprodu-cibility of results, one of the most fundamental principles of science. The widely used gzip compressor, used for reduction of storage and transfer costs, is not a perfect solution, so a few specialized FASTQ compressors were proposed recently. Unfortunately, they are often impractical because of slow processing, lack of support for some variants of FASTQ files or instability. We propose DSRC 2 that offers compression ratios comparable with the best existing solutions, while being a few times faster and more flexible. Availability and Implementation: DSRC 2 is freely available at http:// sun.aei.polsl.pl/dsrc. The package contains command-line compres-sor, C and Python libraries for easy integration with existing software and technical documentation with examples of usage.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Genome sequencing has growing impact on medicine. There are emerging projects like the Personal Genome Project (<ref type="bibr" target="#b0">Ball et al., 2012</ref>) or the Million Veteran Program (<ref type="bibr" target="#b6">Roberts, 2013</ref>), in which hundreds of thousands of human genomes are to be sequenced. Illumina Company offers whole genome sequencing for clinical purposes for a few thousand US dollars. The companies like Ion Torrent promise the whole human genome sequencing in hours for51000 dollars to be available soon. It seems that personalized medicine for the masses will be available in the near future. The low cost of pure sequencing is not, however, everything, as the data must be stored and transferred. The IT costs were not treated seriously in the past, when the sequencing was expensive and slow. Nowadays, the costs of storage and transfers counted in hundreds of dollars for a single genome per year are no longer negligible. Moreover, the improvements in this field are far behind what is present in the sequencing (<ref type="bibr" target="#b3">Deorowicz and Grabowski, 2013</ref>). An obvious solution to the data deluge is data compression and many specialized compressors appeared in the recent years (see the survey,<ref type="bibr" target="#b3">Deorowicz and Grabowski, 2013</ref>). These tools are, however, rather 'experimental' and tend to suffer from one or more of the following drawbacks: (i) they focus mainly on the compression ratio, and as a consequence (de)compression is slow (sometimes even comparable with the speed of sequencing), (ii) they are available as external tools, so the compressed formats cannot be directly used by other software, (iii) they have no support for some types of FASTQ files, e.g. in color space or variable-length reads and (iv) they are unstable and crash frequently. The focus on the compression ratio can sometimes be justified, especially, when the goal is just storage for archival purposes. In many situations the data are, however, stored locally and decompressed many times (for various analyses), so the decompression speed could be a significant factor of the processing speed of a whole pipeline. Thus, in practice the well-known but rather inefficient gzip program is still in wide use. We think that it is time for industry-oriented solutions. Thus, we introduce DSRC 2, supporting any variant of FASTQ files. Its compression ratios are much better than gzip/bzip2 and only moderately worse than the best existing programs, but the speed of (de)compression is high. DSRC 2 also supports Illumina's plan of quality resolution reduction (http://res.illumina.com/ documents/products/whitepapers/whitepaper_datacompression. pdf, 2012) and can read/write to pipes, for easy integration with pipelines. with context being the position in the read, or the order-1 Huffman coder of the run-length-encoded quality stream. In the second method, the quality values are compressed arithmetically with context lengths up to 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>To evaluate the proposed compressor, we collected datasets for three different technologies: Illumina (fixed-length reads, base space), ABI SOLiD (fixed-length reads, color space), LS454/ IonTorrent (variable-length reads, base space). Majority of experiments were performed on a four 8-core AMD Opteron TM 6136 2.4 GHz CPUs server with RAID-5 disk matrix containing 6 HDDs. In one test, we also used the PC machine containing 4-core (with hyperthreading) i7 4770 3.4 GHz CPU and SSD disk. For the comparison, we used two popular universal tools, pigz (parallel gzip) and p-bzip2 (parallel bzip2), and the best existing FASTQ compressors, Quip (<ref type="bibr" target="#b5">Jones et al., 2012</ref>), FQZcomp (<ref type="bibr" target="#b1">Bonfield and Mahoney, 2013</ref>), SeqDB (<ref type="bibr" target="#b4">Howison, 2013</ref>) and DSRC 1 (<ref type="bibr" target="#b2">Deorowicz and Grabowski, 2011</ref>). The compressors were run in two modes: the best ratio and fast compression, not necessarily the fastest possible, but with a 'reasonable' ratio (<ref type="figure">Table 1</ref>). DSRC 2 consumes 5400 MB of main memory in the fast mode and 56.5 GB in best mode. These values are much higher than of gzip (510 MB in parallel variant), but we think they are still acceptable. In the lossless mode, the best ratios were obtained by FQZcomp, but its low speed makes it rather impractical. The compression ratio of DSRC 2 is 10–15% smaller, but its speed is an order of magnitude (or more) higher. In the fast mode, the speed of DSRC 2 is sometimes I/O-limited, while the compression ratio is still much better than of the de facto standards gzip/ bzip2. What is important is that DSRC 2 is similarly fast in both compression and decompression. This allows the application in storage of the intermediary results in the processing pipelines, potentially with total improvement of the complete processing speed because of I/O transfer reduction. The relative results for the Illumina's quality-reduced data are presented in<ref type="figure">Table 1</ref>of the Supplementary File S1.<ref type="figure" target="#fig_0">Figure 1</ref>shows how DSRC 2 speed scales up for growing number of threads.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Scalability of DSRC 2 for SRR065390_1 file in the lossless mode</figDesc></figure>

			<note place="foot" n="2"> METHODS AND IMPLEMENTATION DSRC 2 is a multithreaded tool written in C using Boost libraries. In the compression mode, a single thread reads the input FASTQ file in blocks (typically of tens of MBs size) and puts them into an input queue. Several threads perform the compression of the blocks, storing the results in an output queue. Finally, a single thread writes the compressed blocks in a single file. The decompression is organized in the same fashion. At the high level, the processing of a single block is similar to those of the existing compressors. The reads are split into three streams: IDs, sequences in base space (color space data are converted to base space) and quality values. The non-ACGT symbols from the sequence stream are transferred to the quality stream, just as in DSRC 1 (Deorowicz and Grabowski, 2011). The processing of IDs was slightly improved compared with DSRC 1. Additionally, some parts of IDs can be optionally removed, which could be helpful, as often most of the IDs data are irrelevant for further analysis. DNA symbols can be encoded in three ways. In the first one, each base is stored in 2 bits (just as in DSRC 1). In the second one, the Huffman coder on these symbols is used. The last method uses arithmetic coder (Salomon and Motta, 2010), with contextual probability estimation of orders up to 9. Quality values can be stored in two ways. In the first one (similar as in DSRC 1), the compressor uses one of the following modes (after estimation of which one should give better ratio): the order-1 Huffman coder *To whom correspondence should be addressed. ß The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="4"> CONCLUSION We propose a specialized FASTQ compressor, DSRC 2, for industry-oriented and research purposes. Its compression ratios are much better than that of the widely used gzip program and only moderately worse than the best existing (in terms of ratio) FASTQ compressors. DSRC 2 is, however, usually a few times faster than all the competitors. We believe our software, containing command-line (de)compressor and libraries for popular programming languages, could replace gzip in real pipelines and repositories.</note>

			<note place="foot">H.Roguski and S.Deorowicz at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENT</head><p>The authors thank Szymon Grabowski for his helpful comments after reading the preliminary versions of the article.Note: Ratio is expressed as the original file size divided by the compressed file size. Columns 'c-sp' and'd-sp' denote compression and decompression speeds (in MB/s), respectively. The programs were run for the maximal number of threads they allow, but not 48. Empty cells mean lack of support such type of files. The best results are in bold. comp. denotes compression.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A public resource facilitating clinical use of genomes</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">P</forename>
				<surname>Ball</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="11920" to="11927" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Compression of FASTQ and SAM format sequencing data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Bonfield</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Mahoney</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS One</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">59190</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Compression of DNA sequence reads in FASTQ format</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Deorowicz</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Grabowski</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="860" to="862" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Data compression for sequencing data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Deorowicz</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Grabowski</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithms Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">High-throughput compression of FASTQ data with SeqDB</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Howison</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE/ACM Trans. Comput. Biol. Bioinform</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="213" to="218" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Compression of next-generation sequencing reads aided by highly efficient de novo assembly</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">C</forename>
				<surname>Jones</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">171</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Million veterans sequenced</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Roberts</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="page" from="31" to="470" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title level="m" type="main">Handbook of Data Compression</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Salomon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Motta</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
			<publisher>Springer</publisher>
			<pubPlace>London</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>