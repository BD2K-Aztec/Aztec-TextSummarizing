
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:42+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Roary: rapid large-scale prokaryote pan genome analysis</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Andrew</forename>
								<forename type="middle">J</forename>
								<surname>Page</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Carla</forename>
								<forename type="middle">A</forename>
								<surname>Cummins</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Martin</forename>
								<surname>Hunt</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Vanessa</forename>
								<forename type="middle">K</forename>
								<surname>Wong</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Medicine</orgName>
								<orgName type="institution">University of Cambridge</orgName>
								<address>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sandra</forename>
								<surname>Reuter</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Medicine</orgName>
								<orgName type="institution">University of Cambridge</orgName>
								<address>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Matthew</forename>
								<forename type="middle">T G</forename>
								<surname>Holden</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">School of Medicine</orgName>
								<orgName type="institution" key="instit1">University of St. Andrews</orgName>
								<orgName type="institution" key="instit2">North Haugh</orgName>
								<address>
									<settlement>St Andrews</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Maria</forename>
								<surname>Fookes</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Daniel</forename>
								<surname>Falush</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">College of Medicine</orgName>
								<orgName type="institution">Swansea University</orgName>
								<address>
									<settlement>Swansea</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jacqueline</forename>
								<forename type="middle">A</forename>
								<surname>Keane</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Julian</forename>
								<surname>Parkhill</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Pathogen Genomics</orgName>
								<orgName type="institution" key="instit1">The Wellcome Trust Sanger Institute</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<settlement>Hinxton, Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Roary: rapid large-scale prokaryote pan genome analysis</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv421</idno>
					<note type="submission">Received on May 14, 2015; revised on June 26, 2015; accepted on July 14, 2015</note>
					<note>Sequence analysis *To whom correspondence should be addressed. Associate Editor: John Hancock Contact: roary@sanger.ac.uk Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>A typical prokaryote population sequencing study can now consist of hundreds or thousands of isolates. Interrogating these datasets can provide detailed insights into the genetic structure of prokaryotic genomes. We introduce Roary, a tool that rapidly builds large-scale pan genomes, identifying the core and accessory genes. Roary makes construction of the pan genome of thousands of prokaryote samples possible on a standard desktop without compromising on the accuracy of results. Using a single CPU Roary can produce a pan genome consisting of 1000 isolates in 4.5 hours using 13 GB of RAM, with further speedups possible using multiple processors. Availability and implementation: Roary is implemented in Perl and is freely available under an open source GPLv3 license from http://sanger-pathogens.github.io/Roary</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The term microbial pan genome was first used in 2005 (<ref type="bibr" target="#b3">Medini et al., 2005</ref>) to describe the union of genes shared by genomes of interest (<ref type="bibr" target="#b9">Vernikos et al., 2014</ref>). Since then, availability of microbial sequencing data has grown exponentially. Aligning wholegenome-sequenced isolates to a single reference genome can fail to incorporate non-reference sequences. By using de novo assemblies, non-reference sequences can also be analyzed. Microbial organisms can rapidly acquire genes from other organisms that can increase virulence or promote antimicrobial drug resistance (<ref type="bibr" target="#b3">Medini et al., 2005</ref>). Gaining a better picture of the conserved genes of an organism, and the accessory genome, can lead to a better understanding of key processes such as selection and evolution. The construction of a pan genome is NP-hard (<ref type="bibr" target="#b4">Nguyen et al., 2014</ref>) with additional difficulties from real data due to contamination, fragmented assemblies and poor annotation. Therefore, any approach must employ heuristics to produce a pan genome (reviewed in<ref type="bibr" target="#b9">Vernikos et al. 2014</ref>). The most complete standalone pan genome tools are PanOCT (<ref type="bibr" target="#b1">Fouts et al., 2012</ref>), which uses a conserved gene neighborhood in addition to homology to accurately place proteins into orthologous clusters; LS-BSR (<ref type="bibr" target="#b5">Sahl et al., 2014</ref>) which uses a preclustering step before running BLAST to rapidly assign genes to families and PGAP which takes annotated assemblies, performs an all-against-all BLAST, clusters the results and produces a pan genome (<ref type="bibr" target="#b10">Zhao et al., 2012</ref>). PanOCT and PGAP require an all-against-all comparison using BLAST, with the running time growing approximately quadratically with the size of input data and are computationally infeasible with large datasets. They also have quadratic memory requirements, quickly exceeding the RAM available in high performance servers for large datasets. LS-BSR introduces a pre-clustering step that makes it an order of magnitude faster than PGAP; however, it is less sensitive (<ref type="bibr" target="#b5">Sahl et al., 2014</ref>). We have developed a method to generate the pan genome of a set of related prokaryotic isolates. It works V C The Author 2015. Published by Oxford University Press.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>3691</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.with thousands of isolates in a computationally feasible time, beginning with annotated fragmented de novo assemblies. We address the computational issues by performing a rapid clustering of highly similar sequences, which can reduce the running time of BLAST substantially, and carefully manage RAM usage so that it increases linearly, both of which make it possible to analyze datasets with thousands of samples using commonly available computing hardware.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Description</head><p>The input to Roary is one annotated assembly per sample in GFF3 format (<ref type="bibr" target="#b7">Stein, 2013</ref>), such as that produced by Prokka (<ref type="bibr" target="#b6">Seemann, 2014</ref>), where all samples are from the same species. Coding regions are extracted from the input and converted to protein sequences, filtered to remove partial sequences and iteratively pre-clustered with CD-HIT (<ref type="bibr" target="#b2">Fu et al., 2012</ref>). This results in a substantially reduced set of protein sequences. An allagainst-all comparison is performed with BLASTP on the reduced sequences with a user defined percentage sequence identity (default 95%). Sequences are then clustered with MCL (<ref type="bibr" target="#b0">Enright et al., 2002</ref>), and finally, the pre-clustering results from CD-HIT are merged together with the results of MCL. Using conserved gene neighborhood information, homologous groups containing paralogs are split into groups of true orthologs. A graph is constructed of the relationships of the clusters based on the order of occurrence in the input sequences, allowing for the clusters to be ordered and thus providing context for each gene. Isolates are clustered based on gene presence in the accessory genome, with the contribution of isolates to the graph weighted by cluster size. A suite of command line tools is provided to interrogate the dataset providing union, intersection and complement. Full details of the method and outputs are provided in the Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>We evaluated the accuracy, running time and memory usage of Roary against three similar standalone pan genome applications. In each case, we performed the analysis using a single processor (AMD Opteron 6272) and provided 60 GB of RAM. We constructed a simulated dataset based on Salmonella enterica serovar Typhi (S.typhi) CT18 (acc. no. AL513382), allowing us to accurately assess the quality of the clustering. We created 12 genomes with 994 identical core genes and 23 accessory genes in varying combinations. All the applications created clusters that are within 1% of the expected results, with Roary correctly building all genes as shown in<ref type="figure" target="#tab_1">Table 1</ref>. The overlap of the clusters is virtually identical in all applications except LS-BSR, which over clusters in 2% of cases. In addition, a set of 1000 real annotated assemblies of S.typhi genomes was used. Subsets of the data were provided to each application, and the running time and memory usage were noted. The running time of PGAP and PanOCT increases substantially, making only small datasets computationally feasible (<ref type="figure" target="#fig_1">Fig. 1</ref>and Supplementary Figs S1–S8). Roary scales consistently as more samples are added (Supplementary Figs S1–S8) and has been shown to work on a dataset of 1000 isolates as shown in<ref type="figure">Table 2</ref>. The memory usage of PGAP and PanOCT also increases rapidly as more samples are added, quickly exceeding 60 GB for even small datasets. The memory usage of Roary scales consistently as more samples are added, making it feasible to process large datasets on a standard desktop computer within a few hours. We conducted similar experiments with more diverse datasets including Streptococcus pneumonia, Staphylococcus aureus and Yersinia enterocolitica and the results exhibit similar speed-ups as shown in Supplementary Figures S7 and S8. The performance in a multi-processor environment isCore is defined as a gene being in at least 99% of samples, which allows for some assembly errors in very large datasets. Where there are no results, the applications failed to complete within 5 days or used more than 60 GB of RAM. The first column is the number of unique S.typhi genomes in the input set with a mean of 54 contigs over all 1000 assemblies.</p><p>shown in Supplementary Figs S11 and S12, with Roary achieving a speedup of 3.7X using 8 CPUs and GNU Parallel (<ref type="bibr" target="#b8">Tang, 2011</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Discussion</head><p>We have shown that Roary can construct the pan genomes of large collections of bacterial genomes using a desktop computer, where it was not previously computationally possible with other methods. Further speedups in running time are possible by providing more processors to Roary. On simulated data, Roary is the only application to correctly identify all clusters. This increased accuracy comes from using the context provided by conserved gene neighborhood information. Roary scales well on large real datasets, identifying large numbers of core genes, even in the presence of a varied open pan genome.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Bioinformatics, 31(22), 2015, 3691–3693doi:10.</head><figDesc>1093/bioinformatics/btv421 Advance Access Publication Date: 20 July 2015 Applications Note</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Effect of dataset size on the wall time of multiple applications. Only analysis that completed within 2 days and 60 GB of RAM is shown</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Accuracy of each pan genome application on a dataset of simulated data Core genes Total genes Incorrect split Incorrect merge</figDesc><table>Expected 
994 
1017 
0 
0 
PGAP 
991 
1012 
0 
4 
PanOCT 
993 
1015 
1 
1 
LS-BSR 
974 
994 
0 
23 
Roary 
994 
1017 
0 
0 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 2.</figDesc><table>Comparison of pan genome applications using real 
S.typhi data (ERP001718) 

Samples 
Software 
Core a 
Total 
RAM (mb) 
Wall time (s) 

8 
PGAP 
4545 
4929 
569 
41 397 
PanOCT 
4544 
4936 
663 
1457 
LS-BSR 
4476 
4816 
270 
2585 
Roary 
4459 
4871 
156 
44 
24 
PGAP 
— 
— 
— 
— 
PanOCT 
4522 
4991 
5313 
96 093 
LS-BSR 
4451 
4843 
554 
7807 
Roary 
4436 
4941 
444 
382 
1000 
PGAP 
— 
— 
— 
— 
PanOCT 
— 
— 
— 
— 
LS-BSR 
4272 
7265 
17 413 
345 019 
Roary 
4016 
9201 
13 752 
15 465 

a 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">A.J.Page et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>The authors thank Torsten Seemann, Geoff Winsor and Marco Galardini for their helpful advice and contributions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was supported by the Wellcome Trust (grant WT 098051).</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">An efficient algorithm for large-scale detection of protein families</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Enright</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="1575" to="1584" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">PanOCT: automated clustering of orthologs using conserved gene neighborhood for pan-genomic analysis of bacterial strains and closely related species</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">E</forename>
				<surname>Fouts</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">172</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">CD-HIT: accelerated for clustering the next-generation sequencing data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Fu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="3150" to="3152" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">The microbial pan-genome</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Medini</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Opin. Genet. Dev</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="589" to="594" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Building a pangenome reference for a population</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Nguyen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Research in Computational Molecular Biology</title>
		<editor>Sharan,R.</editor>
		<imprint>
			<publisher>Springer International Publishing</publisher>
			<date type="published" when="2014" />
			<biblScope unit="page" from="207" to="221" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The large-scale blast score ratio (LS-BSR) pipeline: a method to rapidly compare genetic content between bacterial genomes</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Sahl</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PeerJ</title>
		<imprint>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">332</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Prokka: rapid prokaryotic genome annotation</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Seemann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="2068" to="2069" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Generic feature format version 3 (GFF3)</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Stein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Seq. Ontol. Proj</title>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">GNU parallel—the command-line power tool.;login: The USENIX Magazine</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Tang</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="42" to="47" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Ten years of pan-genome analyses</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Vernikos</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Opin. Microbiol</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="148" to="154" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">PGAP: pan-genomes analysis pipeline</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Zhao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="416" to="418" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Roary</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>