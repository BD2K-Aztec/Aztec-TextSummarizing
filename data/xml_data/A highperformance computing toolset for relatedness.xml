
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis A high-performance computing toolset for relatedness and principal component analysis of SNP data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">. 24 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Xiuwen</forename>
								<surname>Zheng</surname>
							</persName>
							<email>zhengx@u.washington.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">David</forename>
								<surname>Levine</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jess</forename>
								<surname>Shen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Stephanie</forename>
								<forename type="middle">M</forename>
								<surname>Gogarten</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Cathy</forename>
								<surname>Laurie</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Bruce</forename>
								<forename type="middle">S</forename>
								<surname>Weir</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<surname>Barrett</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195-7232</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis A high-performance computing toolset for relatedness and principal component analysis of SNP data</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="3326" to="3328"/>
							<date type="published" when="2012">. 24 2012</date>
						</imprint>
					</monogr>
					<note type="submission">Received on May 21, 2012; revised on October 3, 2012; accepted on October 6, 2012</note>
					<note>BIOINFORMATICS APPLICATIONS NOTE Associate Editor:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Genome-wide association studies are widely used to investigate the genetic basis of diseases and traits, but they pose many computational challenges. We developed gdsfmt and SNPRelate (R packages for multi-core symmetric multiprocessing computer architectures) to accelerate two key computations on SNP data: principal component analysis (PCA) and relatedness analysis using identity by descent measures. The kernels of our algorithms are written in C/Cþþ and highly optimized. Benchmarks show the uniprocessor implementations of PCA and identity-by-descent are 8–50 times faster than the implementations provided in the popular EIGENSTRAT (v3.0) and PLINK (v1.07) programs, respectively, and can be sped up to 30–300-fold by using eight cores. SNPRelate can analyse tens of thousands of samples with millions of SNPs. For example, our package was used to perform PCA on 55 324 subjects from the &apos;Gene-Environment Association Studies&apos; consortium studies. Availability and implementation: gdsfmt and SNPRelate are available from R CRAN (http://cran.r-project.org), including a vignette. A tutorial can be found at https://www.genevastudy.org/Accomplish ments/software. Contact:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Genome-wide association studies (GWAS) are widely used to investigate the genetic basis of many complex diseases and traits, but the large volumes of data generated in chip-and sequencing-based GWAS from thousands of study samples and millions of SNPs pose significant analytical and computational challenges. One important challenge is the inflated false-positive associations that arise in GWAS results when population structure and cryptic relatedness exist (<ref type="bibr" target="#b1">Cardon and Palmer, 2003;</ref><ref type="bibr" target="#b2">Choi et al., 2009</ref>). These challenges can be addressed by using principal component analysis (PCA) to detect and correct for population structure (<ref type="bibr" target="#b8">Price et al., 2006</ref>) and identity-by-descent (IBD) methods to identify the degree of relatedness between each pair of study samples. For both methods, it is suggested to use a pruned set of SNPs, which are in approximate linkage equilibrium with each other to avoid the strong influence of SNP clusters (<ref type="bibr" target="#b6">Laurie et al., 2010</ref>). However, the computational burden associated with these methods is especially evident with large sample and SNP sizes and requires efficient numerical implementation and memory management, especially as chip arrays increase in size and sequencing data is used to call variants. For example, the 1000 Genomes Project identified 15 million SNP loci from whole-genome sequencing technologies recently (1000 Genomes Project Consortium, 2010). R is one of the most popular statistical programming environment, but it is not typically optimized for high performance or parallel computing, which would ease the burden of large-scale SNP-based GWAS calculations. To overcome these limitations, we have initiated a project named CoreArray (http://corearray. sourceforge.net/) that includes two R packages: gdsfmt to provide efficient, platform-independent memory and file management for genome-wide numerical data, and SNPRelate to solve large-scale, numerically intensive GWAS calculations (i.e. PCA and IBD) on multi-core symmetric multiprocessing computer architectures.</p><p>The SNP eigenvectors can be used to calculate the sample eigenvectors of a new set of samples, which is useful in studies with substantial relatedness (<ref type="bibr" target="#b11">Zhu et al., 2008</ref>). For relatedness analysis, IBD estimation in SNPRelate can be done by either the method of moments (MoM) (<ref type="bibr" target="#b10">Purcell et al., 2007</ref>) or maximum likelihood estimation (MLE) (<ref type="bibr" target="#b2">Choi et al., 2009;</ref><ref type="bibr" target="#b7">Milligan, 2003</ref>) through identity by state. Our experience shows that MLE is significantly more computationally intensive than MoM for large-scale data analysis, although MLE estimates are usually more reliable than MoM. Additionally, the functions for linkage disequilibrium pruning generate a pruned subset of SNPs that are in approximate linkage equilibrium with each other, to avoid the strong influence of SNP clusters in PCA and IBD analysis. An actual kinship matrix of individuals can be estimated by either method, which could be used in downstream association analyses (<ref type="bibr" target="#b9">Price et al., 2010</ref>). Both R packages are written in C/Cþþ, use the POSIX threads library for shared memory parallel computing on Unix-like systems and have an R interface in which the kernel has been highly optimized by blocking the computations to exploit the high-speed cache memory. The algorithms are optimized to load genotypes block by block, with no limit to the number of SNPs. The algorithms are limited only by the size of the main memory, which is accessed by the parallel threads, and holds either the genetic covariance matrix or IBD coefficient matrix. GDS is also used by an R/Bioconductor package GWASTools as one of its data storage formats (<ref type="bibr" target="#b5">Gogarten et al., 2012</ref>). GWASTools provides many functions for quality control and analysis of GWAS, including statistics by SNP or scan, batch quality, chromosome anomalies, association tests, etc.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">PERFORMANCE</head><p>We illustrate the performance of SNPRelate using small, medium and large test datasets. The small and medium sets were constructed from simulated data and contain 500 and 5000 samples with 100 K SNP markers, respectively. The large set consists of 55 324 subjects selected from 16 projects of the 'Gene-Environment Association Studies' (GENEVA) consortium (<ref type="bibr" target="#b3">Cornelis et al., 2010</ref>). We compared the run times of SNPRelate with EIGENSTRAT (v3.0) and PLINK (v1.07) for PCA and IBD estimation, respectively. The implementations were benchmarked on a system with two quad-core Intel processors running at 2.27 GHz and 32 GB RAM and running Linux Fedora 10. As shown in<ref type="figure">Table 1</ref>, the uniprocessor implementations of PCA and IBD in SNPRelate are 8–50 times faster than the implementations provided in EIGENSTRAT and PLINK, respectively. When the SNPRelate algorithms were run using eight cores, the performance improvement ranged from 30 to 300. The SNPRelate PCA was conducted on the large dataset (n ¼ 55 324 subjects with 310 K selected SNP markers). It took 64 h to compute the genetic covariance matrix (55 K-by-55 K) when eight cores were used, and 9 days to calculate eigenvalues and eigenvectors using the uniprocessor version of LAPACK in R. The analyses on the small-and medium-size datasets required 51 GB of memory, and PCA on 55 K subjects required 32 GB, as the genetic covariance matrix is stored in the main memory shared by threads. An improvement on running time for PCA is to use a multi-threaded version of BLAS to perform the calculation of eigenvalues and eigenvectors instead of the default uniprocessor one. Although SNPRelate is much faster than EIGENSTRAT for PCA or PLINK for IBD estimation using MoM, the results are numerically the same (i.e. identical accuracy).Calls the uniprocessor version of LAPACK in R to compute the eigenvalues and eigenvectors, taking 1 s and 12 m for the small and medium set, respectively. c</p><p>Includes the computation time of calculating the eigenvalues and eigenvectors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Fig. 1. Flowchart of parallel computing for PCA and IBD analysis</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Comparison of run-times (seconds and minutes) for SNPRelate, EIGENSTRAT and PLINK on a Linux system with two quad-core Intel processors (2.27 GHz) and 32 GB RAM</figDesc><table>Number of cores 
Small set a 
Medium set a 

Method 
1 
4 
8 
1 
4 
8 

PCA 
SNPRelate 
11 sþ 
5 sþ 
3 sþ 
20 mþ 
8 mþ 
5 mþ 
1 s b 
1 s b 
1 s b 
12 m b 
12 m b 
12 m b 
EIGENSTRAT 
90 s c 
— 
— 
71 0m c 
— 
— 

MoM for IBD analysis 
SNPRelate 
19 s 
6 s 
4 s 
30 m 
8 m 
5 m 
PLINK 
980 s 
— 
— 
1630 m 
— 
— 

a 

Simulated 500 (small set) and 5000 (medium set) samples with 100 K SNPs. 

b 

</table></figure>

			<note place="foot" n="2"> FEATURES To support efficient memory management for genome-wide numerical data, gdsfmt provides the genomic data structure (GDS) file format for array-oriented data. In this format, each byte encodes up to four SNP genotypes, thereby reducing file size and access time. During the process of scanning SNP profiles, operations on four genotypes may be performed simultaneously. The GDS format supports data blocking so that only the subset of data that is being processed needs to reside in memory, and it is also designed for efficient random access to large datasets. Although SNPRelate functions operate only on GDS-format data files, functions to reformat data from PLINK, sequencing Variant Call Format, NetCDF and other data files, are provided by our packages (Danecek et al., 2011; Laurie et al., 2010; Purcell et al., 2007). SNPRelate provides computationally efficient functions for PCA and IBD relatedness analysis on GDS genotype files. The calculations of the genetic covariance matrix and pairwise IBD coefficients are split into non-overlapping parts and assigned to multiple cores for performance acceleration, as shown in Figure 1. The functions in SNPRelate for PCA include the basic calculations of sample and SNP eigenvectors, as well as useful accessory functions. The correlation between sample eigenvectors and observed allelic dosage can be used to evaluate the genome-wide distribution of SNP effects on each eigenvector. *To whom correspondence should be addressed.</note>

			<note place="foot">ß The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">SNPRelate for analysis of SNP data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">X.Zheng et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors thank members of the GENEVA consortium (http://www.genevastudy.org) for access to the data used for testing the gdsfmt and SNPRelate packages.</p></div>
			</div>

			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A map of human genome variation from population-scale sequencing</title>
	</analytic>
	<monogr>
		<title level="j">Genomes Project Consortium. Nature</title>
		<imprint>
			<biblScope unit="volume">467</biblScope>
			<biblScope unit="page" from="1061" to="1073" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Population stratification and spurious allelic association</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Cardon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">J</forename>
				<surname>Palmer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lancet</title>
		<imprint>
			<biblScope unit="volume">361</biblScope>
			<biblScope unit="page" from="598" to="604" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Case-control association testing in the presence of unknown relationships</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Choi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genet Epidemiol</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="668" to="678" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">The gene, environment association studies consortium (GENEVA): maximizing the knowledge obtained from gwas by collaboration across studies of multiple conditions</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">C</forename>
				<surname>Cornelis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genet Epidemiol</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="364" to="372" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The variant call format and vcftools</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Danecek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2156" to="2158" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">M</forename>
				<surname>Gogarten</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics [Epub ahead of print</title>
		<imprint>
			<date type="published" when="2012-10-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Quality control and quality assurance in genotypic data for genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">C</forename>
				<surname>Laurie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genet Epidemiol</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="591" to="602" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Maximum-likelihood estimation of relatedness</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">G</forename>
				<surname>Milligan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">163</biblScope>
			<biblScope unit="page" from="1153" to="1167" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Principal components analysis corrects for stratification in genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">L</forename>
				<surname>Price</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="904" to="909" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">New approaches to population stratification in genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">L</forename>
				<surname>Price</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="459" to="463" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Plink: a tool set for whole-genome association and population-based linkage analyses</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Purcell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="559" to="575" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">A unified association analysis approach for family and unrelated samples correcting for stratification</title>
		<author>
			<persName>
				<forename type="first">X</forename>
				<surname>Zhu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="page" from="352" to="365" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>