
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:33+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Efficient spatial segmentation of large imaging mass spectrometry datasets with spatially aware clustering</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Theodore</forename>
								<surname>Alexandrov</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Industrial Mathematics</orgName>
								<orgName type="institution">University of Bremen</orgName>
								<address>
									<postCode>28359</postCode>
									<settlement>Bremen</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Steinbeis Innovation Center for Scientific Computing in Life Sciences</orgName>
								<address>
									<postCode>28211</postCode>
									<settlement>Bremen</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jan</forename>
								<forename type="middle">Hendrik</forename>
								<surname>Kobarg</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Industrial Mathematics</orgName>
								<orgName type="institution">University of Bremen</orgName>
								<address>
									<postCode>28359</postCode>
									<settlement>Bremen</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Efficient spatial segmentation of large imaging mass spectrometry datasets with spatially aware clustering</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="page" from="230" to="238"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr246</idno>
					<note>[20:07 6/6/2011 Bioinformatics-btr246.tex] Page: i230 i230–i238 BIOINFORMATICS</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Imaging mass spectrometry (IMS) is one of the few measurement technology s of biochemistry which, given a thin sample, is able to reveal its spatial chemical composition in the full molecular range. IMS produces a hyperspectral image, where for each pixel a high-dimensional mass spectrum is measured. Currently, the technology is mature enough and one of the major problems preventing its spreading is the under-development of computational methods for mining huge IMS datasets. This article proposes a novel approach for spatial segmentation of an IMS dataset, which is constructed considering the important issue of pixel-to-pixel variability. Methods: We segment pixels by clustering their mass spectra. Importantly, we incorporate spatial relations between pixels into clustering, so that pixels are clustered together with their neighbors. We propose two methods. One is non-adaptive, where pixel neighborhoods are selected in the same manner for all pixels. The second one respects the structure observable in the data. For a pixel, its neighborhood is defined taking into account similarity of its spectrum to the spectra of adjacent pixels. Both methods have the linear complexity and require linear memory space (in the number of spectra). Results: The proposed segmentation methods are evaluated on two IMS datasets: a rat brain section and a section of a neuroendocrine tumor. They discover anatomical structure, discriminate the tumor region and highlight functionally similar regions. Moreover, our methods provide segmentation maps of similar or better quality if compared to the other state-of-the-art methods, but outperform them in runtime and/or required memory. Contact: theodore@math.uni-bremen.de</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Given a thin sample (usually a tissue slice), imaging mass spectrometry (IMS) measures high-dimensional mass spectra at its spatial points, providing a hyperspectral image with a mass spectrum measured at each pixel (<ref type="figure">Fig. 1</ref>). Each mass spectrum dimension represents the abundance of molecules with this molecular mass. Currently, IMS is one of the few biochemical technologies able to establish the spatial biochemical composition of the sample in the full molecular range (small and large molecules, e.g. metabolites, lipids and proteins). Since 1970s, secondary ion mass spectrometry was the main IMS technique for surface analysis (<ref type="bibr" target="#b4">Benninghoven and Loebach, 1971</ref>), although being unable to measure large molecules (e.g. peptides and proteins). With the * To whom correspondence should be addressed. advent of Matrix-assisted laser desorption ionization (MALDI) imaging mass spectrometry (<ref type="bibr" target="#b22">Stoeckli et al., 2001</ref>), the measurement of peptides and proteins became possible what opened IMS a door to the variety of biological and biomedical problems. Currently, IMS is one of the most promising innovative measurement techniques in biochemistry. IMS has proven its potential in discovery of new drugs (<ref type="bibr" target="#b21">Solon et al., 2010;</ref><ref type="bibr" target="#b27">Yang et al., 2009</ref>) and cancer biomarkers (<ref type="bibr" target="#b7">Cazares et al., 2009;</ref><ref type="bibr" target="#b19">Rauser et al., 2010</ref>) just to mention a few important applications. IMS was used in numerous studies leading to understanding chemical composition and biological processes, see recent reviews on this topic (Amstalden van<ref type="bibr" target="#b3">Hove et al., 2010;</ref><ref type="bibr" target="#b26">Watrous et al., 2011</ref>). As for many modern biochemical techniques, in particular in proteomics (<ref type="bibr" target="#b17">Patterson, 2003</ref>), the development of computational methods for IMS is lagging behind the technological progress. Two unsupervised problems are currently considered in IMS data processing: (i) data representation using principal component analysis (PCA) and its variants (<ref type="bibr" target="#b14">Klerk et al., 2007</ref>), the technique standardly used for processing SIMS data, and (ii) spatial segmentation of an IMS dataset by means of spectra (or pixels) clustering (<ref type="bibr" target="#b2">Alexandrov et al., 2010;</ref><ref type="bibr" target="#b9">Deininger et al., 2008;</ref><ref type="bibr" target="#b16">McCombie et al., 2005</ref>). Concerning the second problem, the spatial segmentation of an IMS dataset, several approaches have been proposed. First, straightforward clustering of mass spectra, e.g. k-means (<ref type="bibr" target="#b16">McCombie et al., 2005</ref>). Second, feature extraction with PCA and then hierarchical clustering of features (<ref type="bibr" target="#b9">Deininger et al., 2008</ref>). Hierarchical clustering has an advantage of interactive analysis of the clustering dendrogram but needs to keep in memory the full distance matrix; several work-arounds have been proposed (<ref type="bibr" target="#b28">Zhang et al., 1996</ref>) but none is accepted as a standard. The main drawback of using straightforward clustering of mass spectra is that it is negatively affected by the pixel-to-pixel variability issue (<ref type="bibr" target="#b2">Alexandrov et al., 2010;</ref><ref type="bibr" target="#b26">Watrous et al., 2011</ref>), which is especially serious in the most popular IMS techniques, SIMS and MALDIIMS. Underestimation of this issue leads to strong noise in the resulted segmentation maps (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>). As we show later, the method combining PCA with hierarchical clustering is also prone to this problem. We have recently proposed a spatial segmentation method solving this important issue, where edge-preserving spatiallyadaptive denoising (<ref type="bibr" target="#b12">Grasmair, 2009</ref>) is applied to gray-scale images of selected masses prior to clustering (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>). The produced segmentation maps are significantly better than those produced without using denoising, in terms of lack of noise, discrimination of anatomical and histological details, and the number of visible regions. However, these improvements are achieved in full at a cost of using a computationally intensive<ref type="bibr">[20:07 6/6/2011 Bioinformatics-btr246.tex]</ref>Page: i231 i230–i238</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Efficient spatial segmentation of IMS data</head><p>A B C D<ref type="figure">Fig. 1</ref>. An IMS dataset is a data cube. Spectra (A) are measured at spatial points of a sample (B) with spatial coordinates (x,y). Given a mass, one obtains an intensity image; examples for 4966 Da and 6717 Da are shown in (C–D). edge-preserving spatially adaptive denoising method and slow high dimensional discriminant clustering. Use of a simpler methods improves the segmentation maps but not significantly due to strong and multiplicative noise in data. In this article, we propose another original approach for spatial segmentation of IMS data with strong pixel-to-pixel variability. In general, this approach can be applied to any hyperspectral data, not necessarily IMS, but we consider segmentation of only IMS data. In (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>), the motivation for using the prior-toclustering denoising was that neighbor pixels should have similar intensity at a peak mass (a mass, where not just noise is represented). Results shown by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>confirm that a procedure taking into account spatial relations between pixels delivers a better quality than a straightforward pixels clustering. In this article, our approach is to take into account the spatial relations between pixels by incorporating this information directly into a clustering method. We propose two new approaches to pixels clustering, when each pixel is considered together with its neighbors. One is nonadaptive, where each pixel is clustered together with pixels from its neighborhood; neighborhoods are selected in the same manner for all pixels. The second structure-adaptive way respects the structure observable in data and, for a pixel, its neighborhood is defined taking into account similarities of spectra measured at pixels around it. In order to build efficient clustering methods based on these two ideas (non-adaptive and structure-adaptive), we use the FastMap method (<ref type="bibr" target="#b11">Faloutsos and Lin, 1995</ref>), applying it for an efficient dimensionality reduction and, given a distance matrix, for finding points in euclidean space with similar inter-distances. Importantly, we do not keep the full distance matrix in memory using a special FastMap trick explained later in the paper. We evaluate the proposed methods on two MALDI-IMS datasets, a rat brain coronal section without pathology (20 185 spectra) where of our interest is to recover the anatomical structure of the brain, and a section of a neuroendocrine tumor (NET) invading the small intestine (27 360 spectra) with the aim to discriminate the functionally similar regions, and, to highlight the tumor area.</p><p>Both datasets have been introduced, segmented with prior-toclustering advanced denoising, and discussed by<ref type="bibr" target="#b2">Alexandrov et al. (2010</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Data measurement and preprocessing</head><p>Samples preparation and IMS measurements of both the rat brain and NET datasets are described in detail in<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>. Shortly, the cryosections of 10 µm thickness were cut on a cryostat, transferred to a conductive indium-tin-oxide-coated glass slide (Bruker Daltonik GmbH, Bremen, Germany) and measured using a MALDI-TOF instrument (Autoflex III; Bruker Daltonik GmbH) using flexControl 3.0 and flexImaging 2.1 software (Bruker Daltonik GmbH). The lateral resolution was set to 80 µm. For the NET data, the Haematoxylin and Eosin (H&amp;E) stained sections, coregistered with the MALDI-imaging results, were evaluated histologically by an experienced pathologist using a virtual slide scanner (MIRAX desk, Carl Zeiss MicroImaging GmbH, Munich, Germany). The pre-processing was done in the ClinProTools 2.2 software (Bruker Daltonik). The spectra were baseline-corrected with the TopHat algorithm (minimal baseline width set to 10%, the default value in ClinProTools). No normalization or binning was done. Then spectra were saved into ASCII files and loaded in Matlab R2010b (The Mathworks Inc., Natick, MA, USA), where the processing was performed using our original implementation of all methods, including FastMap. The rat brain dataset comprises 20 185 spectra acquired within the slice area (120×201 pixels), each of 3045 data points covering the mass range 2.5–10 kDa; the NET dataset comprises 27 360 spectra (171×239 pixels) each of 5027 data points covering 3.2–18 kDa. For examples of intensity images for masses 4966 Da and 6717 Da for the rat brain dataset, see<ref type="figure">Figure 1</ref>; more examples are in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Peak picking</head><p>Selection of dataset frequent peaks: for the peak picking, we improved the approach proposed by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>. First, as by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>, for each 10th spectrum we picked its peaks with orthogonal matching pursuit (OMP) algorithm (<ref type="bibr" target="#b10">Denis et al., 2009</ref>). This greedy algorithm searches for the specified number p p of peaks which simultaneously are (i) high and (ii) fit at best the given peak shape (the Gaussian shape is used). OMP is not just selection of the p p peaks most correlated with the Gaussian function. In comparison with this naive greedy approach, OMP has better theoretical properties of reconstruction peaks hidden in the noise; for more details, see (<ref type="bibr" target="#b10">Denis et al., 2009</ref>). The peak picking for each 10th spectrum assigns to each mz-value a number of spectra in which this mz-value was selected as a peak. Finally, we take the most frequent peaks which were selected in more than τ p % of considered spectra. The parameters of this peak picking i231Page: i232 i230–i238</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>T.Alexandrov and J.H.Kobarg</head><p>approach are: (i) σ p , the standard deviation of the Gaussian shape of a peak, (ii) n p , the number of peaks selected per spectrum, and (iii) τ p , the percentage of spectra a peak should be found in.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Alignment of masses corresponding to a peak</head><p>: however, we realized, that because the Gaussian shape is just an approximation of a real peak shape and probably because of small mass shifts (the mass recalibration for each spectrum is not standardly performed in IMS), often several mz-values close to the center of a peak are selected. This redundancy in some not fully understood manner reduces the frequency of each mz-value. Thus, some, in fact frequent, peaks can be omitted as its mz-value has low frequency. Moreover, for a peak, this approach selects several masses with similar spatial intensity distribution what can influence the subsequent clustering. This effect seems to be stronger for large peaks, what leads to their increased impact on the clustering. In order to prevent this redundant selection of several masses per peak, we grouped mz-values located close to each other (closer than σ p , one fourth of the given peak shape) and, after calculating their mean value, move it uphill the dataset mean spectrum so that it gets in the local maximum of the mean spectrum. This simple improvement allows us to select peaks which, from an expert opinion, should be selected but were omitted before, thus increasing the sensitivity of the peak picking without drop of specificity. This topic, however, goes beyond the scope of this article which presents methods of segmentation applied to a reduced dataset after a peak picking. After peak picking, the images corresponding to picked masses are scaled so that their maximal value is one.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">FastMap: distance-preserving projection</head><p>The FastMap algorithm (<ref type="bibr" target="#b11">Faloutsos and Lin, 1995</ref>), given a distance matrix of size n×n and a euclidean space of dimension q, finds n points in this space with inter-distances close to those given in the matrix. It resembles multidimensional scaling (<ref type="bibr" target="#b13">Hastie et al., 2009</ref>) but is more efficient having the linear in n complexity of O(nq). Moreover, although it is not well-known, for finding projections of n points, FastMap needs to calculate only n(2q+1) pairwise distances. Computing them on-the-fly, one significantly reduces the required memory. This trick is not described in the original paper (<ref type="bibr" target="#b11">Faloutsos and Lin, 1995</ref>) but implemented by Faloutsos and Lin in their C package. We also use the FastMap algorithm as an efficient dimensionality reduction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Spatially aware clustering</head><p>Probably, the most apparent way to embed the spatial relations between pixels into a clustering algorithm is to use a distance-based clustering where the distance d(s 1 ,s 2 ) between two spectra s 1 and s 2 measured at pixels with coordinates (x 1 ,y 1 ) and (x 2 ,y 2 ) depends on pixels from the neighborhoods of (x 1 ,</p><formula>y 1 ) and (x 2 ,y 2 ), for example, d r,{α ij } (s 1 ,s 2 ) 2 = −r≤i,j≤r α ij s x 1 +i,y 1 +j −s x 2 +i,y 2 +j 2 2 ,</formula><formula>(1)</formula><p>where r defines the radius of the pixel neighborhood and {α ij } are weights of spectra corresponding to pixels from the neighborhoods. It is natural to choose the weights {α ij } which decrease with increasing i 2 +j 2 (small weights for pixels distant from the neighborhood center). For a neighborhood of radius r, we define the Gaussian weights as follows</p><formula>α ij = exp (−i 2 −j 2 )/(2σ 2 )</formula><p>where σ is selected according to the two-sigma rule (<ref type="figure" target="#fig_3">Fig. 3A</ref>). Unfortunately, this approach is memory-consuming, since it requires calculating and keeping in memory a distance matrix of size (n 2 −n)/2. For the NET dataset (n = 27 360) this needs 1.4 GB of memory, for n = 50 000 (authors processed such a dataset) 4.7 GB, for n = 10 5 (there are no restrictions to measure such a dataset with existing instruments) 18 GB. The key idea of our spatially aware clustering is inspired by the kernel methods framework. We propose to map our spectra (of length p) into a euclideanfeature space F using a mapping , where the standard euclidean distance is</p><formula>(s 1 )−(s 2 ) 2 = d r,{α ij } (s 1 ,s 2 ).</formula><formula>(3)</formula><p>For a spectrum s ∈ R p , this is achieved with using</p><formula>(s) = (s(x,y)) = √ α −r,−r s T (x −r,y−r),..., √ α 0,0 s T (x,y),..., √ α r,r s T (x +r,y+r) T ,</formula><formula>(4)</formula><p>which describes the concatenation of spectra of pixels neighbor to the pixel of s, each multiplied with a square root of the corresponding weight. Naturally, the feature space F is R p(2r+1) 2 for such ; see<ref type="figure" target="#fig_1">Figure 2</ref>for an illustration. If, as usual in IMS, n p (number of pixels is much more than the number of selected peaks), and r is small, then storing the mapped data of size n×p(2r +1) 2 is significantly cheaper than n(n−1)/2 pairwise distances. As a last step, supposing redundancy in the mapped data, we apply the FastMap algorithm for dimensionality reduction, projecting the mapped spectra into a euclidean space of lower dimension q. Finally, clustering with an efficient vectorial clustering algorithm is performed. We propose using the k-means clustering algorithm.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm 1 Spatially-aware clustering (SA)</head><p>Parameters: pixel neighborhood radius r, FastMap desired dimension q, number of clusters k 1. Given r, create weights {α ij } as in<ref type="bibr">Equation (2)</ref>2. For each spectrum s, m ← (s) using weights {α ij } {map a spectrum into the feature space using Equation</p><formula>(4)} 3. Given q, project mapped spectra {m } n =1 into R q using FastMap obtaining {f } n =1</formula><p>{reduce the dimensionality up to q} 4. Cluster the projected mapped spectra {f } n =1 into k groups using k-means</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Spatially aware structure-adaptive clustering</head><p>Applying the spatially-aware clustering proposed in the previous section to IMS data, we realized that it improves the segmentation maps as compared to the straightforward clustering. However, it can smooth the edges between the anatomical or histological regions or eliminates small details; more on this in Section 3. Use of a smaller pixel neighborhood radius r solves this problem only partially, since for a smaller r the noise in the resulted segmentation map is stronger. So, we propose another method, where for a pixel, the weights of pixels in its neighborhood are not simply Gaussian but calculated adaptively, taking into account similarities of the pixels. The key idea is as follows. For each pixel in the neighborhood, we consider the distance between its spectrum and the spectrum in the center of the neighborhood. The larger is the distance (the less similar the spectra are), the smaller is the weight. This idea is adapted from the bilateral filtering (<ref type="bibr" target="#b25">Tomasi and Manduchi, 1998</ref>), an edge-preserving i232Page: i233 i230–i238</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Efficient spatial segmentation of IMS data</head><p>color image denoising method, where the adaptively calculated weights are used afterwards for averaging. First, for a pixel with coordinates (x,y), we introduce</p><formula>β ij (x,y) = exp −δ ij (x,y) 2 2λ 2 , −r ≤ i,j ≤ r,</formula><formula>(5)</formula><p>in line with Tomasi and Manduchi (1998), where λ is a parameter and δ ij (x,y) ==s(x +i,y+j)−s(x,y) 2. Then the distance between two spectra at coordinates (x 1 ,y 1 ) and (x 2 ,y 2 ) is as follows</p><formula>d r,{˜α{˜α ij },λ (s 1 ,s 2 ) 2 = −r≤i,j≤r˜α j≤r˜ j≤r˜α ij (x,y)s x 1 +i,y 1 +j −s x 2 +i,y 2 +j 2 2 , (6) ˜ α ij (x,y) = α ij β ij (x 1 ,y 2 )β ij (x 2 ,y 2 ).</formula><formula>(7)</formula><p>which differs from</p><p>(1) by using the adaptive weights˜αweights˜ weights˜α ij (x,y) instead of the Gaussian weights α ij. Note that˜αthat˜ that˜α ij (x,y) ≤ α ij , where˜αwhere˜ where˜α ij (x,y) are reduced by multiplying with β ij (x,y) ∈ (0,1]. The more similar is the spectrum s(x + i,y+j) to the spectrum s(x,y) from the neighborhood center, the larger is β ij (x,y).<ref type="figure" target="#fig_3">Figure 3B</ref>shows an example of the adaptive weights˜αweights˜ weights˜α ij (x,y) for a neighborhood containing spectra from two different histological regions; spectra in these regions differ significantly. In order to eliminate the parameter λ in Equation (5) which adjusts the adaptivity of˜αof˜ of˜α ij (x,y) to the spectra in the neighborhood of the pixel (x,y), we propose the following approach. The value of λ(x,y) is selected for each neighborhood separately, in such a way that the largest β ij (x,y) in this neighborhood is 1 and the smallest is exp(−2) ≈ 0.15, what leads toSince the weights˜αweights˜ weights˜α ij (x,y) in the distance Equation (6) are determined for each pixel separately, we cannot use the concatenation like in Equation (4) to derive the transformation (s(x,y)) so that</p><formula>λ(x,y) = 1 2 max −r≤i,j≤rˆδ j≤rˆ j≤rˆδ ij (x,y) (8) wherê δ ij (x,y) = δ ij (x,y)−min −r≤i,j≤r {δ ij (x,y)}.</formula><formula>d r,{˜α{˜α ij },λ (s 1 ,s 2 ) ==(s 1 )−(s 2</formula><p>) 2. Thus, we propose to use FastMap to find projections of spectra into R q for a given q so that the pairwise distances are similar to those calculated using Equation (6). Note that we do not calculate all (n 2 −n)/2 pairwise distances but only n(2q+1) thanks to the FastMap trick. Finally, the points found by FastMap are clustered with k-means.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm 2 Spatially-aware structure-adaptive clustering (SASA)</head><p>Parameters: pixel neighborhood radius r, FastMap desired dimension q, number of clusters k 1. Given r, create weights {α ij } as in Equation (2) 2. Given the distance function (6), project the spectra into R q using FastMap, where, when necessary, calculate the distance between spectra on-the-fly {account for neighbor pixels, adapt to structure, reduce the dimensionality up to q} 3. Cluster the projected spectra into k groups using k-means<ref type="figure" target="#fig_4">Figure 4</ref>summarizes and illustrates the proposed segmentation methods, SA and SASA. Note that each of them has only three parameters, the pixel neighborhood radius r, the dimension q of the space where FastMap projects the mapped data to, and the number of clusters k. Later on, we will show that q is important, thus each method has only two easily interpretable parameters: r adjusts the smoothness of the segmentation map and k is simply the number of colors of the map. Both methods together with FastMap were implemented in Matlab 2010b.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>In this section, we analyze in detail the results for the rat brain dataset. Then, we show segmentation maps for the neuroendocrine tumor dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Rat brain dataset</head><p>A rat brain section is a standard example tissue in IMS. According to<ref type="bibr" target="#b26">Watrous et al. (2011)</ref>, 43% of publications on IMS of tissues consider a brain tissue. This is due to the well-known anatomical structure and clear and well-separated anatomical regions. In this section, we compare the segmentation maps produced for the rat brain slice with a schematic of the rat brain corresponding to the coronal section ∼4.16 mm from Bregma drawn based on the rat brain atlas (<ref type="bibr" target="#b18">Paxinos and Watson, 2007</ref>). The peak picking procedure with alignment of masses to peaks finds p = 71 peaks.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">Overview</head><p>Each of our proposed segmentation methods, SA (spatially adaptive, with Gaussian weights used) and SASA (spatially adaptive, with structure-adaptive weights), has only three parameters: the pixel neighborhood radius r, the dimension q of the space where FastMap projects the mapped data into, and the number of clusters k. We consider segmentation maps produced for r = 2, 3, 4. The FastMap dimension is q = 20. The number of clusters (i.e. map colors) is k = 10, what by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>was found to be representative for this dataset.<ref type="figure" target="#fig_5">Figure 5</ref>shows an optical image (A), the schematic of the anatomical structure (B), a segmentation map produced with straightforward clustering of spectra when no spatial relations between spectra are taken into account (C), and maps for SA (D–F) and SASA methods (G–I). First, one can see that for the segmentation maps produced with both SA and SASA methods reflect the anatomical structure. Some anatomical regions (cortex, hippocampus, corpus callossum and internal capsule, amygdala) are very well represented. Note that the hippocampus has different parts (one in the middle and another close to amygdala) which still have the same color in the map (mid blue). Some regions are not well represented, e.g. a thin part of thalamus which goes around hypothalamus is not visible. However, as discussed by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>, this might be not a computational problem but an underrepresentation of these regions in the processed IMS dataset. Second, our methods significantly outperform the straightforward clustering (<ref type="figure" target="#fig_5">Fig. 5C</ref>) where strong noise hides details and the whole anatomical regions. For example, in<ref type="figure" target="#fig_5">Figure 5C</ref>amygdala are not separated from hippocampus; hippocampus from the inner part of cortex and from paraventrical nuclei. Importantly, the noise in the segmentation map is a technological and computational artifact but not a property of the brain tissue; for more details on noise in MALDI-imaging, see (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>). Thus, we conclude that the overall quality of the produced segmentation maps for the rat brain dataset is good. Note the blue small region interrupting the left part of cortex (<ref type="figure" target="#fig_7">Fig. 6</ref>, region A). This represents a tissue slice preparation defect (visible in the optical image as well) when the thin 10 µm tissue slice was folded during transferring it onto a glass slide.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Efficiency</head><p>The efficiency of the segmentation method was the ultimate goal for us because existing advanced segmentation methods run several tens of minutes for a dataset. Tens of minutes seems acceptable because it is still less than the dataset acquisition time (several hours). However, this does not allow one to use segmentation interactively, what is of very importance in imaging applications. Moreover, at the present moment datasets with higher lateral resolution of 20 µm are becoming to be measured (<ref type="bibr" target="#b15">Lagarrigue et al., 2010</ref>). If the rat brain slice would be measured with 20 µm resolution (instead of 80 µm used in this article), this would result i234Page: i235 i230–i238<ref type="figure" target="#tab_1">Table 1</ref>shows the runtimes for producing a segmentation map for the considered datasets not including the data loading, preprocessing and peak picking.<ref type="figure" target="#tab_2">Table 2</ref>shows the detailed runtimes for the proposed methods. Incredibly, our methods are almost as efficient as straightforward clustering. The reasons for such efficiency are as follows:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Efficient spatial segmentation of IMS data</head><p>(i) the proposed approaches for incorporating spatial relations between spectra are computationally simple, (ii) the FastMap algorithm has linear complexity O(nq) in the number of spectra and requires just n(2q+1) distances calculated on-thefly. The latter is especially important if such memory inefficient programming languages as Matlab are used for implementation. As for the memory space, the methods are very memoryoptimized. Both methods need only n(2r +1) 2 memory elements for the neighbor indices, 3n distance elements in each FastMap iteration and nq memory elements for storing the FastMap projections. The SASA method stores additionally n(2r +1) 2 adaptive weights.<ref type="figure" target="#fig_5">Figure 5D</ref>–I 3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.3">The role of the pixel neighborhood radius r</head><p>shows that for both SA and SASA methods, the increase of the neighborhood radius r makes the maps smoother. This is natural, because for a pixel, more pixels around it are taken into account when calculating</p><formula>; r = 3, q = 20, k = 10.</formula><p>Equations (2) or (5) what helps to reduce the pixel-to-pixel variability. On the other side, small details can be smoothed out, especially by using SA method with non-adaptive weights. For example, the central part of hippocampus in the right half loses its details visible in<ref type="figure" target="#fig_5">Figure 5D</ref>–E but not in<ref type="figure" target="#fig_5">Figure 5F</ref>, as well as the red dot in central part of the cortex (data not attributed).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.4">SA method versus SASA method Recall</head><p>that the SASA method was constructed so that in a pixel neighborhood, the weights assigned to the pixels are adaptive; the more different is a spectrum from the spectrum of the central pixel, the less is the weight (<ref type="figure" target="#fig_3">Fig. 3</ref>). Thus, the 'averaging' in Equation (5) is done mostly among pixels similar to the central one. Comparing the maps for the SA and SASA method in<ref type="figure" target="#fig_5">Figure 5</ref>, one can see that making weights structureadaptive prevents smoothing out the details and deteriorating of edges between different spatial regions. On the other hand, the SASA maps look noisier.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.5">SA-artifacts Comparison</head><p>of the SA-and SASAsegmentation maps reveals an artifact produced by the SA method. It is a layer of chartreuse yellow pixels along hippocampus which are not visible in the SASA maps and cannot be attributed to any anatomical region.<ref type="figure" target="#fig_7">Figure 6</ref>, regions B and C, highlights the areas of the artifact. We hypothesize that this is an 'averaging' artifact due to weights α ij in Equation (2) are not adaptive to the data. This is confirmed by the absence of this layer in the SA map with the smallest pixel neighborhood radius r = 2 and in the SASA maps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.6">The role of the FastMap dimension q</head><p>The parameter q, the dimension of the space FastMap projects the spectra into, is the most tricky among three parameters of the SA and SASA methods. Naturally, increase of q makes the problem high-dimensional and, thus, prone to the curse of dimensionality issue. On the other hand, for any distance-preserving algorithm the quality of projection reduces with decrease of the dimension q. We propose to select q not greater than p as FastMap would project from R p into R q. For the SA method, this is motivated by the assumption that the mapping (4) into p(2r +1) 2-dimensional space introduces much redundancy.<ref type="figure" target="#fig_9">Figure 7</ref>shows the segmentation maps for the SASA method with r = 3 and k = 10, for different values of the FastMap dimension q = 10, 20, 50. The values of q were selected to be smaller than p = 71. One can see that the maps for q = 20 and 50 are very similar. The map for q = 10 looks noisier with a possibly artifact region (chartreuse yellow) around the corpus callosum. Possibly, i235Page: i236 i230–i238the dimension q = 10 is not enough to achieve sufficient quality of the projection in contrast to q = 20.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>T.Alexandrov and J.H.Kobarg</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A B C</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.7">Comparison with other methods PCA with hierarchical clustering</head><p>We have already shown that our segmentation maps excel the maps produced with straightforward clustering of spectra (<ref type="figure" target="#fig_5">Fig. 5C</ref>), mostly due to reduction of the pixel-to-pixel variability. Let us consider the method proposed by<ref type="bibr" target="#b9">Deininger et al. (2008)</ref>, where hierarchical clustering was applied to low-dimensional features extracted with PCA of spectra.<ref type="figure" target="#fig_10">Figure 8A</ref>shows the segmentation map produced with this method. As recommended in (<ref type="bibr" target="#b9">Deininger et al., 2008</ref>), seven PCA components explaining 70% variance and the euclidean distance between extracted features were used. For the Ward linkage need much memory (for this dataset 8 GB was not enough), the complete linkage was exploited. One can see that the segmentation map is very noisy, possibly because the pixelto-pixel variation in spectra. We have tried the average linkage as well; it produces a similarly noisy map.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.8">Segmentation with prior-to-clustering edge-preserving denoising</head><p>Next, we compare our methods with advanced segmentation proposed in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>), where prior-toclustering edge-preserving denoising of mass images was used to reduce the pixel-to-pixel variability. The edge-preserving denoising due to (<ref type="bibr" target="#b12">Grasmair, 2009</ref>) requires about 2 min for 71 images of the rat brain dataset. The segmentation map from (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>) for k = 10 is shown in<ref type="figure" target="#fig_10">Figure 8</ref>. For clustering, High Dimensional Discriminant Clustering (HDDC) was used, the clustering method designed specially for high-dimensional data. However, its main disadvantage is the long runtimes due to using the expectation-maximization algorithm. Moreover, during an M-step it can be unstable when a cluster has a few elements or no elements, what requires starting it several times with random initializations. Although a new version of HDDC fixing these issues is planned to be included soon in the MIXMOD software (<ref type="bibr" target="#b5">Biernacki et al., 2006</ref>), at the present time HDDC is slow. For the rat brain, one iteration takes about 50 s For k = 10, at least 20 iterations are necessary because of the mentioned instability, which sums up to approximately 15 min. For this reason, we replaced HDDC with k-means in the method proposed in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>). The resulted segmentation map is shown in<ref type="figure" target="#fig_10">Figure 8</ref>. One can see that the map produced with HDDC is comparable to the maps presented in<ref type="figure" target="#fig_5">Figure 5</ref>. Moreover, as also discussed in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>), k-means seems to be worse than HDDC (artifacts, less regions, detailness). The SAand SASA-maps look better than those after k-means with prior-toclustering denoising. The runtimes for methods considered in this section are given in<ref type="figure" target="#tab_1">Table 1</ref>, which are much longer than those for the SA and SASA methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">The neuroendocrine tumor dataset</head><p>In this section, we briefly consider the segmentation maps for the second dataset, the neuroendocrine tumor invading the small intestine (ileum). This dataset differs from the rat brain dataset in the following respects: (i) it represents pathology (tumor), (ii) the tissue is more complicated, the difference between anatomical regions is not that clear, (iii) the tumor area is a heterogeneous composition of tumor cells, tumor stroma, and connective tissue. All this poses a complex challenge for a segmentation algorithm.<ref type="figure" target="#fig_11">Figure 9</ref>shows the optical image after H&amp;E-staining together with 3D structure of the tissue and optical image with main functional structures as well as the segmentation maps. First, the tumor region is separated from the rest and is represented in three colors: blue, red and chartreuse yellow. This corresponds to results shown in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>), although there the blue and red regions have not been separated. Moreover, the anatomical structure is represented, although the tissue flattened when put onthe slide. Note the layer of brown pixels which is visible in the map after straightforward clustering (in light blue), which was not found in (<ref type="bibr" target="#b2">Alexandrov et al., 2010</ref>). Thus, we conclude that the segmentation maps for this complex and heterogeneous tissue discriminate the tumor area, highlight the anatomical structure even after the transformation of the tissue, and excel the maps produced with the advanced prior-to-clustering denoising method by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>Clustering algorithm: k-means was selected as a clustering algorithm after the FastMap projection because it is a fast and reliable algorithm. Moreover, k-means optimizes the euclidean distances between the points, see e.g. Chapter 14.3.6 of (<ref type="bibr" target="#b13">Hastie et al., 2009</ref>) (publicly available online). Thus, performing k-means in the space after FastMap projection (for both SA and SASA) is equivalent to minimize the within-point scatter between spectra where the distance between two spectra is calculated using Equations (1) or (6). No mass-wise processing: in<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>, denoising of each gray-scale image corresponding to a mass (channel) selected after peak picking is performed. Naturally, a channel-wise processing may be criticized as being prone to lose information presented in a combination of channels. In our methods SA and SASA, we never do channel-wise processing but consider the full spectra.</p><p>FastMap dimension q: as discussed in Section 3.1.6, the FastMap dimension q is the most tricky parameter. We have done a computational study investigating the properties of the FastMap projection and observed that increase of q changes the distances between projections, but only until some value. After this value, the distances between projections stay almost unchanged. Investigating this question can lead to a way of choosing q, and, more generally, to the way of finding the intrinsic dimension of a set of points. Evaluation: the evaluation of produced results is an important problem, especially in an unsupervised framework, where no simple criterion (like total recognition rate) can be computed. We have tested the silhouette criterion (<ref type="bibr" target="#b20">Rousseeuw, 1987</ref>) of separation between found clusters but have not found correspondence between the value of criterion and the visual quality of the maps. Probably, this might be explained by no clear separation between clusters. In general, the evaluation of a spatial segmentation remains an important and unsolved problem in imaging mass spectrometry data processing, where no reference or simulated data are provided yet. Other publications on IMS segmentation, e.g. (<ref type="bibr" target="#b2">Alexandrov et al., 2010;</ref><ref type="bibr" target="#b9">Deininger et al., 2008</ref>), do not consider this question and present their methods as a data mining tool with extensive support from histologists or biologists estimating the quality of the produced segmentation maps. This is explained by the novelty of this problem and the lack of existing problems and research groups solving this problem. Certainly, in the nearest future the formal evaluation will be necessary, in particular for comparing results of different segmentation. However, any formal evaluation is a complicated task since it requires the ground truth maps for a complex enough dataset. We are working in this direction and hope to present some results soon. In this article, which is based mostly on work by<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>, our aim was to construct an efficient algorithm delivering segmentation maps of at least comparable quality for the datasets from<ref type="bibr" target="#b2">Alexandrov et al. (2010)</ref>where comparison is done visually i237</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>T.Alexandrov and J.H.Kobarg</head><p>taking into account the anatomical or histological structure of the tissue sample. Application to other hyper-spectral or multi-channel data: the proposed methods can be applied to other IMS modalities, especially those with with strong pixel-to-pixel variability (e.g. MALDI ion source, SIMS). Moreover, the SASA method can be of use for processing MALDI-IMS data obtained with the recent FT-ICR mass analyzer (<ref type="bibr" target="#b8">Cornett et al., 2008</ref>) which produces spectra much longer than MALDI-TOF-IMS (considered in this article), of order 10 5. Recall that the memory space and computational complexity of the SASA method does not depend on the dimensionality p of spectra but only on number of spectra n and the FastMap dimension q. Our spatial segmentation methods can be applied for segmenting other hyper-spectral or multi-channel data, for example for terahertz imaging (<ref type="bibr" target="#b6">Brun et al., 2010</ref>), or hyper-spectral imaging (<ref type="bibr" target="#b24">Tarabalka et al., 2010</ref>) like that one used in German Hyperspectral Satellite Mission (<ref type="bibr" target="#b23">Stuffler et al., 2007</ref>). The SASA method is recommended, since for this type of data usually no peak picking is performed and the dimensionality p of data is high. Moreover, in the SASA method, more appropriate distance between spectra can be selected instead of the euclidean distance in Equation (6). 3D imaging mass spectrometry: our methods can be used in spatially 3D IMS, where a spectrum is measured for a voxel with spatial coordinates (x,y,z). In this case, the number of spectra increases another order of magnitude reaching n = 10 6. For such n, pure distance-based methods which need to keep the full distance matrix in memory become inappropriate in contrast to our methods which are linear in n in memory space.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[20:07 6/6/2011 Bioinformatics-btr246.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Transformation of spectra s 1 and s 2 into feature space by taking neighborhoods around (x 1 ,y 1 ) and (x 2 ,y 2 ) into account; the mapped positions (x 1 ,y 1 ) and (x 2 ,y 2 ) are clustered in feature space.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>[20:07 6/6/2011 Bioinformatics-btr246.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. Left panel: Gaussian weights α ij for a pixel neighborhood of radius r = 3. Right panel: structure-adaptive weights˜αweights˜ weights˜α ij (x,y) taking into account the similarity of its spectrum to the spectra of adjacent pixels—the weights drop down when facing an intensity edge.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. Summary of the proposed spatial segmentation methods with comments.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.5.</head><figDesc>Fig. 5. Rat brain dataset. (A) Optical image. (B) Schematic representation based on the rat brain atlas, reproduced from (Alexandrov et al., 2010) with permission from the American Chemical Society. (C–I) Segmentation maps, q = 20, k = 10. C. Straightforward k-means clustering of spectra. (D–F) SA method. (G–I) SASA method.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>[20:07 6/6/2011 Bioinformatics-btr246.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig.6.</head><figDesc>Fig. 6. Segmentation map (SA method) for the rat brain dataset, r = 3, q = 20, k = 10. Region A shows a tissue slice preparation defect (see in text, Section 3.1.1). Regions B and C highlight an SA-specific artifact, a layer of chartreuse yellow pixels along hippocampus (see in text, Section 3.1.4).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><figDesc>[20:07 6/6/2011 Bioinformatics-btr246.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.7.</head><figDesc>Fig. 7. Impact of the FastMap dimension q on the segmentation map; SASA method, r = 3, k = 10. (A) q = 10. (B) q20. (C) q = 50.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig.8.</head><figDesc>Fig. 8. Segmentation maps of other methods. (A) Hierarchical clustering (euclidean distance, complete linkage) after PCA-reduction of spectra to 70% explained variance. (B–C) With prior-to-clustering edge-preserving image denoising; k = 10, moderate denoising. (B) High-dimensional discriminant clustering, reproduced from (Alexandrov et al., 2010) with permission from the American Chemical Society. (C) k-means.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig.9.</head><figDesc>Fig. 9. Neuroendocrine tumor dataset. (A) Optical image after H&amp;E staining, the tumor region is selected. (B) 3D structure of the tissue and optical image with main functional structures, reproduced from (Alexandrov et al., 2010) with permission from the American Chemical Society). (C–I) Segmentation maps, k = 10. (C) Straightforward clustering of spectra. (D–E) SA method. (G–I) SASA method.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Runtimes for producing a segmentation map Dataset (n×p) Method Neighborhood radius r = 2 r = 3 r = 4</figDesc><table>Rat brain (20185×71) SA 
17 s 35 s 
49 s 

SASA 
19 s 32 s 
49 s 
k-means  *  
10 s 
Denoising+HDDC  *  
17 min 
Denoising+kmeans  *  
2 min 
PCA+hierarchical  *  
25 s 

Tumor 
(27 960×62) SA 
23 s 41 s 
62 s 
SASA 
25 s 39 s 
62 s 

Runtimes on ThinkPad laptop with Intel i5 Core 2.4 GHz; data pre-processing and peak 
picking are not included; q = 20, k = 10. 
 *  No neighborhood is exploited. 

into 320 000 spectra. Naturally, such a dataset would demand 
efficient algorithms. 
</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 2. Detailed runtimes for SA and SASA methods</figDesc><table>Substep 
Rat brain (s) 
Tumor (s) 

SA 
SASA 
SA 
SASA 

Scaling 
0.01 
0.01 
0.01 
0.01 
Weights 
4 
4 
6 
6 
Fastmap 
25 
25 
32 
31 
k-means 
5 
2 
3 
3 

ThinkPad laptop with Intel i5 Core 2.4 GHz; one iteration of k-means is used</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">, with σ = (2r +1)/4, (2)</note>

			<note place="foot">i238 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We gratefully thank Prof. Herbert Thiele (Bruker Daltonik) for providing the rat brain dataset, Prof. Ferdinand von Eggeling (University Hospital Jena, Germany) for the tumor dataset, Michael Becker and Sören Deininger (both Bruker Daltonik) for doing IMS measurements and additionally Michael for drawing the schematic of the rat brain. We also thank Chen Sagiv (SagivTech Ltd., Israel) for introducing the bilateral filtering, and Oliver Keszöcze (University of Bremen) for prototyping the spatially aware clustering software. Funding: UNLocX (EC, FP7 GA255931 to J.H.K.).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflict of Interest: none declared.</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">206</biblScope>
			<biblScope unit="issue">6</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>btr246. .tex]</note>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName>
				<surname>Page</surname>
			</persName>
		</author>
		<imprint>
			<biblScope unit="page" from="238" to="230" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Spatial segmentation of imaging mass spectrometry data with edge-preserving image denoising and clustering</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Alexandrov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="6535" to="6546" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">A concise review of mass spectrometry imaging</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">R</forename>
				<surname>Amstalden Van Hove</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chromatogr. A</title>
		<imprint>
			<biblScope unit="page" from="1217" to="3946" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Tandem mass spectrometer for secondary ion studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Benninghoven</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Loebach</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Rev. Sci. Instr</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page" from="49" to="52" />
			<date type="published" when="1971" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Model-based cluster and discriminant analysis with the MIXMOD software</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Biernacki</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computat. Stat. Data Anal</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="page" from="587" to="600" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Terahertz imaging applied to cancer diagnosis</title>
		<author>
			<persName>
				<forename type="first">M.-A</forename>
				<surname>Brun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Med. Biol</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="page">4615</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Imaging mass spectrometry of a specific fragment of mitogen-activated protein kinase/extracellular signal-regulated kinase kinase kinase 2 discriminates cancer from uninvolved prostate tissue</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">H</forename>
				<surname>Cazares</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clin. Cancer Res</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="5541" to="5551" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">MALDI-FTICR imaging mass spectrometry of drugs and metabolites in tissue</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">S</forename>
				<surname>Cornett</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page" from="5648" to="5653" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">MALDI imaging combined with hierarchical clustering as a new tool for the interpretation of complex human cancers</title>
		<author>
			<persName>
				<forename type="first">S.-O</forename>
				<surname>Deininger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="5230" to="5236" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Greedy solution of ill-posed problems: error bounds and exact inversion</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Denis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Inverse Problems</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page">115017</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Fastmap: a fast algorithm for indexing, data-mining and visualization of traditional and multimedia datasets</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Faloutsos</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K.-I</forename>
				<surname>Lin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 1995 ACM SIGMOD international conference on Management of data</title>
		<meeting>the 1995 ACM SIGMOD international conference on Management of data<address><addrLine>San Jose, California</addrLine></address></meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="1995" />
			<biblScope unit="page" from="163" to="174" />
		</imprint>
	</monogr>
	<note>United. States</note>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Locally adaptive total variation regularization</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Grasmair</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Scale Space and Variational Methods in Computer Vision</title>
		<editor>Tai,X.-C. et al.</editor>
		<meeting><address><addrLine>Berlin/Heidelberg</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2009" />
			<biblScope unit="page" from="331" to="342" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<monogr>
		<title level="m" type="main">The Elements of Statistical Learning: Data Mining, Inference, and Prediction</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Hastie</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
			<publisher>Springer Series in Statistics Springer</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Extended data analysis strategies for high resolution imaging MS: new methods to deal with extremely large image hyperspectral datasets</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">A</forename>
				<surname>Klerk</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Mass Spectr</title>
		<imprint>
			<biblScope unit="volume">260</biblScope>
			<biblScope unit="page" from="222" to="236" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Revisiting rat spermatogenesis with MALDI imaging at 20 µm resolution</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Lagarrigue</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Cell. Proteomics</title>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>page. Epub ahead of print</note>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Spatial and spectral correlations in MALDI mass spectrometry images by clustering and multivariate analysis</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Mccombie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">77</biblScope>
			<biblScope unit="page" from="6118" to="6124" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Data analysis—the Achilles heel of proteomics</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">D</forename>
				<surname>Patterson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotech</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="221" to="222" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<monogr>
		<title level="m" type="main">The Rat Brain in Stereotaxic Coordinates</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Paxinos</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Watson</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2007" />
			<publisher>Academic Press</publisher>
			<pubPlace>Amsterdam</pubPlace>
		</imprint>
	</monogr>
	<note>6th. edn</note>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Classification of HER2 receptor status in breast cancer tissues by MALDI imaging mass spectrometry</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Rauser</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="1854" to="1863" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Rousseeuw</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Appl. Math</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="53" to="65" />
			<date type="published" when="1987" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Autoradiography, MALDI-MS, and SIMS-MS imaging in pharmaceutical discovery and development. Am</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">G</forename>
				<surname>Solon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Assoc. Pharm. Sci. J</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="11" to="26" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Imaging mass spectrometry: a new technology for the analysis of protein expression in mammalian tissues</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Stoeckli</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Med</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="493" to="496" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">The EnMAP hyperspectral imager—an advanced optical payload for future applications in earth observation programmes</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Stuffler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Acta Astronaut</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="page" from="115" to="120" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">SVM-and MRF-based method for accurate classification of hyperspectral images</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Tarabalka</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Geosci. Remote Sens. Lett</title>
		<imprint>
			<publisher>IEEE</publisher>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="736" to="740" />
			<date type="published" when="2010" />
			<publisher>IEEE</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Bilateral filtering for gray and color images</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Tomasi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Manduchi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">ICCV &apos;98: Proceedings of the Sixth International Conference on Computer Vision</title>
		<meeting><address><addrLine>Bombay, India</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1998" />
			<biblScope unit="page" from="839" to="846" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">The evolving field of imaging mass spectrometry and its impact on future biological research</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">D</forename>
				<surname>Watrous</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mass Spectr</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="209" to="222" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Translating metabolic exchange with imaging mass spectrometry</title>
		<author>
			<persName>
				<forename type="first">Y.-L</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Chem. Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="885" to="887" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">BIRCH: an efficient data clustering method for very large databases</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIGMOD Rec</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="103" to="114" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>