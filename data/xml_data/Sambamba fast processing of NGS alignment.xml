
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:41+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sambamba: fast processing of NGS alignment formats</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Artem</forename>
								<surname>Tarasov</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Statistical Simulation</orgName>
								<orgName type="institution">St. Petersburg State University</orgName>
								<address>
									<settlement>St. Petersburg, Russia</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Albert</forename>
								<forename type="middle">J</forename>
								<surname>Vilella</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="institution">Illumina Cambridge</orgName>
								<address>
									<settlement>Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Edwin</forename>
								<surname>Cuppen</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Royal Netherlands Academy of Arts and Sciences</orgName>
								<orgName type="institution">Hubrecht Institute</orgName>
								<address>
									<settlement>Utrecht</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Department of Medical Genetics</orgName>
								<orgName type="department" key="dep2">Institute for Molecular Medicine</orgName>
								<orgName type="institution">University Medical Centre Utrecht</orgName>
								<address>
									<settlement>Utrecht</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Isaac</forename>
								<forename type="middle">J</forename>
								<surname>Nijman</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Department of Medical Genetics</orgName>
								<orgName type="department" key="dep2">Institute for Molecular Medicine</orgName>
								<orgName type="institution">University Medical Centre Utrecht</orgName>
								<address>
									<settlement>Utrecht</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Pjotr</forename>
								<surname>Prins</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Department of Medical Genetics</orgName>
								<orgName type="department" key="dep2">Institute for Molecular Medicine</orgName>
								<orgName type="institution">University Medical Centre Utrecht</orgName>
								<address>
									<settlement>Utrecht</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Department of Nematology</orgName>
								<orgName type="institution">Wageningen University</orgName>
								<address>
									<settlement>Wageningen</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sambamba: fast processing of NGS alignment formats</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<note type="submission">Received on December 13, 2014; revised on February 2, 2015; accepted on February 10, 2015</note>
					<note>Genome analysis *To whom correspondence should be addressed. Associate Editor: Inanc Birol Contact: j.c.p.prins@umcutrecht.nl</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Sambamba is a high-performance robust tool and library for working with SAM, BAM and CRAM sequence alignment files; the most common file formats for aligned next generation sequencing data. Sambamba is a faster alternative to samtools that exploits multi-core processing and dramatically reduces processing time. Sambamba is being adopted at sequencing centers, not only because of its speed, but also because of additional functionality, including coverage analysis and powerful filtering capability. Availability and implementation: Sambamba is free and open source software, available under a GPLv2 license. Sambamba can be downloaded and installed from http://www.open-bio.org/wiki/ Sambamba. Sambamba v0.5.0 was released with</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Processing speed matters, not only for diagnostics, but also for analysis and sharing of computational resources. Next-generation sequencing (NGS) is increasingly used as a genetic screening tool in diagnostics (<ref type="bibr" target="#b4">Gullapalli et al., 2012</ref>) and reducing time from sample intake to test result/diagnosis potentially saves lives. Introducing multi-core processing can accelerate steps in a pipeline when the CPU is the bottleneck (<ref type="bibr" target="#b10">Trelles et al., 2011</ref>). Since its introduction by the 1000 Genomes Project (<ref type="bibr" target="#b8">Siva, 2008</ref>), the sequence alignment/map format (SAM) and its compressed binary counterpart (BAM) have become the de facto file formats used for storing and distributing NGS data. Samtools is the original tool for SAM/BAM files processing, including data extraction and filtering (<ref type="bibr" target="#b5">Li et al., 2009</ref>). Recently, samtools added the CRAM format as a compressed alternative to SAM/BAM (<ref type="bibr" target="#b2">Cochrane et al., 2013</ref>). While samtools exploits the speed of the low-level C programming language and uses streamed data for efficiency, it has limited support for parallel processing (<ref type="figure">Fig. 1</ref>). Samtools has inspired a number of other BAM processors, notably Picard (<ref type="bibr" target="#b6">Picard, 2009</ref>), samblaster (<ref type="bibr" target="#b3">Faust and Hall, 2014</ref>), biobambam (<ref type="bibr" target="#b9">Tischler and Leonard, 2014</ref>) and Scramble (<ref type="bibr" target="#b1">Bonfield, 2014</ref>), each of which is either slower than samtools, or offers a subset of its functionality. To accelerate analysis pipelines we created Sambamba, a new incarnation of samtools that fully utilizes parallel processing. Sambamba (which means 'parallel' in Swahili) is written in the D programming language, a modern programming language with runtime performance similar to that of C (<ref type="bibr" target="#b0">Alexandrescu, 2010</ref>). D has powerful abstractions for parallel computing which make it possible to scale computations with the number of cores (<ref type="figure">Fig. 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>2032</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Bioinformatics</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Features</head><p>Sambamba introduces full parallelized data processing of SAM, BAM and CRAM files. Sambamba primarily uses D's parallel processing capabilities. For CRAM support the htslib C-library was linked against (<ref type="bibr" target="#b1">Bonfield, 2014</ref>). And for mpileup support the original samtools program is called in map-reduce fashion. This resulted in improved processing speed on multi-core computers (<ref type="figure" target="#tab_1">Table 1</ref>). Sambamba is most effective on machines where CPU utilization is the constraining factor (<ref type="figure">Fig. 1</ref>). The gain may therefore be limited on cluster setups where shared storage is a bottleneck (e.g.<ref type="bibr" target="#b10">Trelles et al., 2011</ref>). Compatibility: Sambamba is a robust replacement for the commonly used samtools commands: INDEX, SORT, VIEW, MPILEUP, MARKDUP, MERGE and FLAGSTAT. The output of sambamba compares to that of samtools, except for markdup, where the Picard 'sum of base qualities' method was chosen. Sambamba's RAM utilization compares to that of samtools; only with SORT sambamba uses significantly less RAM. New functionality: Sambamba adds new functionality compared with existing tools. To be able to calculate coverage statistics, read DEPTH analysis was added. To speed up splitting BAM files, SLICE was added which copies large regions without decompression. And when a BED file is supplied to VIEW, the index is used to decompress only those regions that are actually visited. To further shorten processing time, index files are created on the fly by SORT, view, markdup and MERGE. And to combine multiple steps into one, powerful filtering with logic operators and regular expressions was added. For example, to filter on mapping quality and CIGAR mapping_quality &gt;¼ 30 and cigar ¼~/ ^ \dþM1I\dþM$/ Finally, to make it easier to process results, sambamba VIEW can generate output in the standard JSON format. Source code: Sambamba abides by the rules of the 'Small tools MANIFESTO for Bioinformatics' (<ref type="bibr" target="#b7">Prins et al., 2014</ref>). The sambamba source code is extensible and maintainable. For SAM parsing we opted for Ragel, a finite-state machine compiler, which generates a fast look-ahead parser with input validation, making the code base even more compact (<ref type="bibr">Thurston, 2006</ref>). Sambamba uses a unit testing framework with continuous integration testing, so that existing functionality is validated every time the code base is changed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Conclusion</head><p>Sambamba is a software engineering example that shows how to make effective use of the D programming language and multi-core computers to reduce the time needed to get from sample to result. Whole genome sequencing and growing sample numbers make such performance improvements increasingly relevant.<ref type="figure">Fig. 1</ref>. Processing speed comparison of samtools and sambamba. Wall-clock time (s) versus number of threads to convert an 11-GB CRAM (1000 genomes HG00110) to 108-GB SAM. With Samtools, VIEW is bound to a single thread at CPU 90%. With Sambamba, IO gets saturated at approximately CPU 250%. When using a faster RAM-disk, IO gets saturated at approximately CPU 350%. For samtools a RAM-disk makes no difference. When adding more threads, performance reproducibly degrades because of CPU cache contention. All timings were performed on a server-class machine with 512 GB of RAM and 48 CPU cores (4 Â 12-core AMD Opteron(tm) Processor 6174 @2.2 Ghz with</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>When running a Human cancer exome SNV calling pipeline on the results of a single Illumina HiSeq 2500 flowcell in fast mode (2000 genes, 300 V C The Author 2015. Published by Oxford University Press.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>, 31(12), 2015, 2032–2034 doi: 10.1093/bioinformatics/btv098</figDesc><table>Advance Access Publication Date: 19 February 2015 
Applications Note million reads, 100 bp read length and average read depth of 100 for 
six samples) following standard best practice guidelines, the bioinfor-
matics processing time was reduced from 2 h to 30 min by replacing 
Picard MARKDUP and samtools INDEX, FLAGSTAT, MERGE and VIEW. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 1. Examples of processing of 31-GB BAM and matching</figDesc><table></table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="6"> Mb L2 cache) Samtools version v1.0-15 using htslib v1.0-1 and sambamba v0.5.0 compiled with the LLVM D-compiler v0.14.0.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank James Bonfield for his CRAM implementation and for constructive comments. We thank the Google Summer of Code and the Open Bioinformatics Foundation for supporting the original work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was partially funded by the Google Summer of Code program (AT).</p></div>
			</div>

			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<monogr>
		<title level="m" type="main">The D Programming Language</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Alexandrescu</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
			<publisher>Addison-Wesley</publisher>
			<pubPlace>Upper Saddle River, NJ</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">The Scramble conversion tool</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">K</forename>
				<surname>Bonfield</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="2818" to="2819" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Facing growth in the European Nucleotide Archive</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Cochrane</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Database issue)</title>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="page" from="30" to="35" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">SAMBLASTER: fast duplicate marking and structural variant read extraction</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">G</forename>
				<surname>Faust</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">I</forename>
				<forename type="middle">M</forename>
				<surname>Hall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="2503" to="2505" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Next generation sequencing in clinical medicine: challenges and lessons for pathology and biomedical informatics</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Gullapalli</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Pathol. Inf</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">40</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The sequence alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<monogr>
		<title/>
		<author>
			<persName>
				<surname>Picard</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
	<note>Picard</note>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title/>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Prins</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
	<note>Small. tools MANIFESTO for bioinformatics. 10.5281/ zenodo.11321</note>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">1000 Genomes project Parsing computer languages with an automaton compiled from a single regular expression</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Siva</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">CIAA. Lecture Notes in Computer Science</title>
		<editor>256. Thurston,A.D. Ibarra,O.H. and Yen,H.-C.</editor>
		<meeting><address><addrLine>New York</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2006" />
			<biblScope unit="page" from="285" to="286" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">biobambam: tools for read pair collation based algorithms on BAM files</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Tischler</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Leonard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Source Code Biol. Med</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">13</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Big data, but are we ready?</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Trelles</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">224</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>