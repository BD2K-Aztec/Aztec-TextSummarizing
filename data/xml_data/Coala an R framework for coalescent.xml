
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:40+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis Coala: an R framework for coalescent simulation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Paul</forename>
								<forename type="middle">R</forename>
								<surname>Staab</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">Ludwig-Maximilians-Universit€ at M€ unchen</orgName>
								<address>
									<addrLine>Planegg-Martinsried 82152</addrLine>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Dirk</forename>
								<surname>Metzler</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">Ludwig-Maximilians-Universit€ at M€ unchen</orgName>
								<address>
									<addrLine>Planegg-Martinsried 82152</addrLine>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Oliver</forename>
								<surname>Stegle</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Introduction</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis Coala: an R framework for coalescent simulation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw098</idno>
					<note type="submission">Received on November 16, 2015; revised on February 6, 2016; accepted on February 14, 2016</note>
					<note>*To whom correspondence should be addressed. Associate Editor: Contact: metzler@bio.lmu.de</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Simulation programs based on the coalescent efficiently generate genetic data according to a given model of evolution. We present coala, an R package for calling coalescent simulators with a unified syntax. It can execute simulations with several programs, calculate additional summary statistics and combine multiple simulations to create biologically more realistic data. Availability and implementation: The package is publicly available on CRAN and on https://github. com/statgenlmu/coala under the conditions of the MIT license.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Coalescent simulators rapidly simulate the evolution of genetic sequences. They are routinely used in population genetics to approximate analytically intractable quantities, to verify theoretical predictions and to validate the performance of data analysis methods (<ref type="bibr" target="#b7">Hoban et al., 2012</ref>). The underlying idea to trace the ancestry of the sequences backwards in time was first implemented in the program ms (<ref type="bibr" target="#b8">Hudson, 2002</ref>). Since then the size and complexity of data sets has increased, and many extensions and modifications of the original algorithm were proposed to cope with the new challenges. For example, the program msHOT (<ref type="bibr" target="#b6">Hellenthal and Stephens, 2007</ref>) supports recombination hotspots, MaCS (<ref type="bibr" target="#b2">Chen et al., 2009</ref>), fastsimcoal (<ref type="bibr" target="#b4">Excoffier and Foll, 2011</ref>) and scrm (<ref type="bibr" target="#b18">Staab et al., 2015</ref>) focus on the efficient simulation of long sequences, and msms (<ref type="bibr" target="#b3">Ewing and Hermisson, 2010</ref>) and cosi2 (<ref type="bibr" target="#b17">Shlyakhter et al., 2014</ref>) account for selection. The total number of published simulators is more extensive, and<ref type="bibr" target="#b12">Peng et al. (2013)</ref>created an online database to help researchers select an appropriate program. Currently, these simulators lack standardized in-and output formats and usually only support the calculation of a small number of summary statistics. To calculate additional statistics, researchers usually have to convert the simulated data into different formats. This process is error-prone and even small mistakes can lead to wrong conclusions or irreproducible results. To simplify this process we present coala, an R package for calling coalescent simulators from within R. It provides a unified interface for specifying coalescent models in R (R Core<ref type="bibr" target="#b14">Team, 2015</ref>), automatically selects a suitable simulator, transparently conducts the simulations, parses the results and calculates additional statistics from the output.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Implementation</head><p>The primary design goal of coala is extensibility. It uses a modular system based on R6 classes (https://cran.r-project.org/web/packages/ R6) to integrate different simulators and summary statistics. Documentation for writing extensions is provided within the R package. To set up a simulation study, the user creates a coala object called 'coalescent model' containing the demographic model and parameters to be used in the simulations as well as the specification which summary statistics shall be calculated from the simulated sequences. Parameters are variable values for quantities like times, rates or population sizes. Their values are either set when simulating the model later or are randomly sampled from a prior distribution. Optionally, parameters can be transformed using arbitrary R expressions including exponential and logarithmic functions. This design simplifies the execution of simulation-based analysis techniques such as ABC (<ref type="bibr" target="#b1">Beaumont et al., 2002</ref>) or Jaatha (<ref type="bibr" target="#b10">Mathew et al., 2013;</ref><ref type="bibr" target="#b10">Naduvilezhath et al., 2011</ref>). An example ABC analysis using the abc package (<ref type="bibr">Csill ery et al., 2012</ref>) is included in the package's documentation. Coala aims to work in a fully reproducible and transparent fashion. It displays the simulation commands that will be executed for a given model to allow the user to verify them. Additionally, it records all executed commands and ensures that all components respect R's, the package is optimized for computational efficiency by using a buffering system combined with meta programming techniques for generating the simulation commands. The number of calls to the coalescent simulators is automatically minimized and computationally expensive parts are implemented in C þþ (<ref type="bibr" target="#b19">Stroustrup, 1995</ref>). Independent simulations can be distributed on multiple CPU cores.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Features</head><p>Although coala relies on existing programs for conducting the coalescent simulations, it can combine multiple programs to provide features not present in any of the applications. The current version of coala supports to call ms for standard neutral models, msms for models that contain selection and scrm for simulating long sequences. All three programs can be combined with seq-gen (<ref type="bibr" target="#b13">Rambaut and Grassly, 1997</ref>) to simulate finite sites mutation models. Furthermore, coala automatically splits complex models into smaller parts that are supported by one of the coalescent simulators. It simulates the parts separately and combines the results. This can be used to simulate models that consist of genetic regions of different length or that have variable parameters between the regions. Finally, it can simulate unphased data by randomly mixing the phased haplotypes returned by the coalescent simulators and transcriptomic data by removing introns from the sequences. Coala has support for calculating classical population genetic summary statistics like the nucleotide diversity p (<ref type="bibr" target="#b11">Nei and Li, 1979</ref>), TajimaIN D (<ref type="bibr" target="#b20">Tajima, 1989</ref>) and various kinds of frequency spectra. Additionally, the current version focuses on summary statistics that were developed for detecting selective sweeps. For instance, it utilizes the rehh package (<ref type="bibr" target="#b5">Gautier and Vitalis, 2012</ref>) to calculate the EHH (<ref type="bibr" target="#b15">Sabeti et al., 2002</ref>), IES and iHS (<ref type="bibr" target="#b16">Sabeti et al., 2007</ref>) statistics and the program OmegaPlus (<ref type="bibr" target="#b0">Alachiotis et al., 2012</ref>) for the x statistic (<ref type="bibr" target="#b9">Kim and Nielsen, 2004</ref>). It can also return a basic SNP matrix, the ancestral trees in Newick format and the unmodified output of the simulators.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>We have created an R package that simplifies the simulation of data according to evolutionary models. It allows researchers to conduct and process coalescent simulations in an easy, reliable and reproducible way. Different simulators can be called using a unified R syntax and a variety of summary statistics can be calculated from the results. We hope that coala will facilitate the use of more realistic models by allowing for variable mutation and recombination rates and finite sites mutation models. Although might not always be necessary to use sophisticated simulation models, the easy availability of these features facilitates testing whether they are important for a particular application.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com Bioinformatics, 32(12), 2016, 1903–1904 doi: 10.1093/bioinformatics/btw098 Advance Access Publication Date: 18 February 2016 Applications Note seeding system. An extensive suite of unit tests covers all aspects of the program. Finally</figDesc><table></table></figure>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">P.R.Staab and D.Metzler at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Ann Kathrin Huylmans for suggesting the name 'coala', and Soumya Ranganathan and the anonymous reviewers for helpful comments on the package's documentation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">OmegaPlus: a scalable tool for rapid detection of selective sweeps in whole-genome datasets</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Alachiotis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="2274" to="2275" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Approximate Bayesian computation in population genetics</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Beaumont</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">162</biblScope>
			<biblScope unit="page">2025</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Fast and Flexible Simulation of DNA Sequence Data abc: an R package for approximate Bayesian computation (ABC)</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Csill</title>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="page" from="136" to="142" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">MSMS: a coalescent simulation program including recombination, demographic structure and selection at a single locus</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Hermisson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2064" to="2065" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Fastsimcoal: a continuous-time coalescent simulator of genomic diversity under arbitrarily complex evolutionary scenarios</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Excoffier</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Foll</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1332" to="1334" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">rehh: an R package to detect footprints of selection in genome-wide SNP data from haplotype structure</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gautier</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Vitalis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="1176" to="1177" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">msHOT: modifying Hudsonudsoncbi.nlm.nihto incorporate crossover and gene conversion hotspots</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Hellenthal</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Stephens</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="520" to="521" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Computer simulations: tools for population and evolutionary genetics</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Hoban</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="110" to="122" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Generating samples under a Wright-Fisher neutral model of genetic variation</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="337" to="338" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Linkage disequilibrium as a signature of selective sweeps</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Kim</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Nielsen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">167</biblScope>
			<biblScope unit="page" from="1513" to="1524" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Why to account for finite sites in population genetic studies and how to do this with Jaatha 2.0 Jaatha: a fast composite likelihood approach to estimate demographic parameters</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">A</forename>
				<surname>Mathew</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ecol. Evol. Mol. Ecol</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="2709" to="2723" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Mathematical model for studying genetic variation in terms of restriction endonucleases</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Nei</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci U S A</title>
		<imprint>
			<biblScope unit="volume">76</biblScope>
			<biblScope unit="page" from="5269" to="5273" />
			<date type="published" when="1979" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Genetic Simulation Resources: a website for the registration and discovery of genetic data simulators</title>
		<author>
			<persName>
				<surname>Peng</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1101" to="1102" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Seq-Gen: An Application for the Monte Carlo Simulation of DNA Sequence Evolution Along Phylogenetic Trees</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Rambaut</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">C</forename>
				<surname>Grassly</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Appl. Biosci</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="235" to="238" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Core Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2015" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Detecting recent positive selection in the human genome from haplotype structure</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">C</forename>
				<surname>Sabeti</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">419</biblScope>
			<biblScope unit="page" from="832" to="837" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Genome-wide detection and characterization of positive selection in human populations</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">C</forename>
				<surname>Sabeti</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">449</biblScope>
			<biblScope unit="page" from="913" to="918" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Cosi2: an efficient simulator of exact and approximate coalescent with selection</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Shlyakhter</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="3427" to="3429" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">scrm: efficiently simulating long sequences using the approximated coalescent with recombination</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">R</forename>
				<surname>Staab</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="31" to="1680" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<monogr>
		<title level="m" type="main">The Cþþ Programming Language</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Stroustrup</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1995" />
		</imprint>
	</monogr>
	<note>3rd. edn. Pearson Education India</note>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Tajima</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">123</biblScope>
			<biblScope unit="page" from="585" to="595" />
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>