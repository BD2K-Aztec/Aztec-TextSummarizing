
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:53+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression Diffusion maps for high-dimensional single-cell analysis of differentiation data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Laleh</forename>
								<surname>Haghverdi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computational Biology</orgName>
								<address>
									<addrLine>Helmholtz Zentrum Mü nchen</addrLine>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Technische Universität Mü nchen</orgName>
								<address>
									<postCode>85748</postCode>
									<settlement>Garching</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Florian</forename>
								<surname>Buettner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computational Biology</orgName>
								<address>
									<addrLine>Helmholtz Zentrum Mü nchen</addrLine>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Fabian</forename>
								<forename type="middle">J</forename>
								<surname>Theis</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computational Biology</orgName>
								<address>
									<addrLine>Helmholtz Zentrum Mü nchen</addrLine>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Technische Universität Mü nchen</orgName>
								<address>
									<postCode>85748</postCode>
									<settlement>Garching</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression Diffusion maps for high-dimensional single-cell analysis of differentiation data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv325</idno>
					<note type="submission">Received on July 31, 2014; revised on March 25, 2015; accepted on May 18, 2015</note>
					<note>*To whom correspondence should be addressed. † Present address: European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Trust Genome Campus, Cambridge CB10 1SD, UK Associate Editor: Ziv Bar-Joseph Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Single-cell technologies have recently gained popularity in cellular differentiation studies regarding their ability to resolve potential heterogeneities in cell populations. Analyzing such high-dimensional single-cell data has its own statistical and computational challenges. Popular multi-variate approaches are based on data normalization, followed by dimension reduction and clustering to identify subgroups. However, in the case of cellular differentiation, we would not expect clear clusters to be present but instead expect the cells to follow continuous branching lineages. Results: Here, we propose the use of diffusion maps to deal with the problem of defining differentiation trajectories. We adapt this method to single-cell data by adequate choice of kernel width and inclusion of uncertainties or missing measurement values, which enables the establishment of a pseudotemporal ordering of single cells in a high-dimensional gene expression space. We expect this output to reflect cell differentiation trajectories, where the data originates from intrinsic diffusion-like dynamics. Starting from a pluripotent stage, cells move smoothly within the tran-scriptional landscape towards more differentiated states with some stochasticity along their path. We demonstrate the robustness of our method with respect to extrinsic noise (e.g. measurement noise) and sampling density heterogeneities on simulated toy data as well as two single-cell quantitative polymerase chain reaction datasets (i.e. mouse haematopoietic stem cells and mouse embryonic stem cells) and an RNA-Seq data of human pre-implantation embryos. We show that diffusion maps perform considerably better than Principal Component Analysis and are advantageous over other techniques for non-linear dimension reduction such as t-distributed Stochastic Neighbour Embedding for preserving the global structures and pseudotemporal ordering of cells. Availability and implementation: The Matlab implementation of diffusion maps for single-cell data is available at https://www.helmholtz-muenchen.de/</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The advantages of single-cell measurements to various biological research fields have become obvious in recent years. One example is the stem cell studies for which population measurements fail to reveal the properties of the heterogeneous population of cells at various stages of development. Purifying for a certain cell type or synchronizing cells is experimentally challenging. Moreover, stem cell populations that have been functionally characterized often showheterogeneity in their cellular and molecular properties (<ref type="bibr" target="#b11">Dykstra et al., 2007;</ref><ref type="bibr" target="#b14">Huang, 2009;</ref><ref type="bibr" target="#b26">Stingl et al., 2006</ref>). To overcome these barriers, on the one hand researchers conduct continuous single-cell observation using time-lapse microscopy (<ref type="bibr" target="#b20">Park et al., 2014;</ref><ref type="bibr" target="#b22">Rieger et al., 2009;</ref><ref type="bibr" target="#b24">Schroeder, 2011</ref>), accompanied by single-cell tracking and analysis tools. However, this approach is still limited as the expression of very few genes (typically one to three) could be observed. On the other hand, with the advent of new technologies, such as single-cell qPCR (<ref type="bibr" target="#b32">Wilhelm and Pingoud, 2003</ref>) or RNA-Seq (<ref type="bibr" target="#b8">Chu and Corey, 2012</ref>) and flow or mass cytometry (<ref type="bibr" target="#b2">Bandura et al., 2009;</ref><ref type="bibr" target="#b7">Chattopadhyay et al., 2006</ref>), it is now possible to measure hundreds to thousands of genes from thousands of single cells at different specific experimental time points (time-course experiments). However, several single cells measured at the same experimental time point may be at different developmental stages. Therefore, there is a need for computational methods which resolve the hidden temporal order that reflects the ordering of developmental stages of differentiating cells. While differentiation has to be regarded as a non-linear continuous process (<ref type="bibr" target="#b3">Bendall et al., 2014;</ref><ref type="bibr" target="#b4">Buettner and Theis, 2012</ref>), standard methods used for the analysis of high-dimensional gene expression data are either based on linear methods such as principal component analysis (PCA) and independent components analysis (ICA) [e.g. used as part of the monocle algorithm (<ref type="bibr" target="#b30">Trapnell et al., 2014)]</ref>or they use clustering techniques that groups cells according to specific properties. Hierarchical clustering methods as used in SPADE (<ref type="bibr" target="#b21">Qiu et al., 2011</ref>) and t-SNE (Van der<ref type="bibr" target="#b31">Maaten and Hinton, 2008</ref>) as used in viSNE (<ref type="bibr" target="#b0">Amir et al., 2013</ref>) are examples of clustering methods. However, as these methods are designed to detect discrete subpopulations, they usually do not preserve the continuous trajectories of differentiation data. A more recently proposed algorithm Wanderlust (<ref type="bibr" target="#b3">Bendall et al., 2014</ref>) incorporates the nonlinearity and continuity concepts but provides a pseudotemporal ordering of cells only if the data comprise a single branch. Furthermore, in gene expression measurement techniques, there is usually a detection limit at which lower expression levels and nonexpressed genes are all reported at the same value.<ref type="bibr" target="#b5">Buettner et al. (2014)</ref>suggested the use of a censoring noise model for PCA, whereas for the other methods it is unclear how these uncertain or missing values are to be treated. A variety of other manifold learning methods including (Hessian) locally linear embedding (HLLE) (<ref type="bibr" target="#b10">Donoho and Grimes, 2003</ref>) and Isomap (<ref type="bibr" target="#b29">Tenenbaum et al., 2000</ref>) exist in the machine-learning community and are discussed in detail in the discussion and conclusion section. Here, we propose diffusion maps (<ref type="bibr" target="#b9">Coifman et al., 2005</ref>) as a tool for analyzing single-cell differentiation data. Diffusion maps use a distance metric (usually referred to as diffusion distance) conceptually relevant to how differentiation data is generated biologically, as cells follow noisy diffusion-like dynamics in the course of taking several differentiation lineage paths. Diffusion maps preserve the nonlinear structure of data as a continuum and are robust to noise. Furthermore, with density normalization, diffusion maps are resistant to sampling density heterogeneities and can capture rare as well as abundant populations. As a non-linear dimension-reduction tool, diffusion maps can be applied on single-cell omics data to perform dimension-reduction and ordering of cells along the differentiation path in a single step, thus providing insight to the dynamics of differentiation (or any other concept with continuous dynamics). In this article, we @BULLET propose an adaptation of diffusion maps for the analysis of single-cell data which is less affected by sampling density heterogeneities and addresses the issues relating to missing values and uncertainties of measurement, @BULLET propose a criterion for selecting the scale parameter in a diffusion map, @BULLET evaluate the performance of the diffusion map and its robustness to noise and density heterogeneities using a toy model that mimics the dynamics of differentiation, @BULLET apply the adapted diffusion map algorithm to two typical qPCR and one RNA-Seq datasets and show that it captures the differentiation dynamics more accurately than other algorithms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Diffusion maps</head><p>Let n be the number of cells and let G be the number of genes measured for each cell. Denote the set of all measured cells by X. We allow each cell x to diffuse around its measured position x 2 R G through an isotropic Gaussian wave function,</p><formula>Y x ðx 0 Þ ¼ 2 pr 2 1=4 exp À jjx 0 À xjj 2 r 2 ! (1)</formula><p>The normalization of Y x ðx 0 Þ is such that Ð 1 À1 Y 2 x ðx 0 Þdx 0 ¼ 1. The Gaussian width r 2 determines the length scale over which each cell can randomly diffuse. The transition probability from cell x to cell y is then defined by the interference of the two wave functions Y x and Y y. One can easily show that this interference product is another Gaussian (all prefactors cancel out):</p><formula>ð 1 À1 Y x ðx 0 ÞY y ðx 0 Þdx 0 ¼ exp À jjx À yjj 2 2r 2 ! (2)</formula><p>Hence, we can construct the n Â n Markovian transition probability matrix P for all pairs of cells in X as follows:</p><formula>P xy ¼ 1 ZðxÞ exp À jjx À yjj 2 2r 2 ! (3)</formula><formula>ZðxÞ ¼ X y2X exp À jjx À yjj 2 2r 2 ! (4)</formula><p>At the position of each cell, ZðxÞ is the partition function which provides an estimate of the number of neighbours of x in a certain volume defined by r. Hence, it can be interpreted as the density of cells at that proximity. Consequently, we redefine the density normalized transition probability matrix ~ P as:</p><formula>~ P xy ¼ 1 ~ ZðxÞ exp À jjxÀyjj 2 2r 2 ZðxÞZðyÞ ; ~ P xx ¼ 0 (5) ~ ZðxÞ ¼ X y2X=x exp À jjxÀyjj 2 2r 2 ZðxÞZðyÞ (6)</formula><p>Because we are only interested in the transition probabilities between cells and not the on-cell potentials imposed by local densities, we set the diagonal of ~ P to zero and exclude y ¼ x from the sum in the partition function ~ Z. For a large enough r, the matrix ~ P defines an ergodic Markovian diffusion process on the data and has n ordered eigenvalues k 0 ¼ 1 &gt; k 1 !:::!k nÀ1 with corresponding right eigenvectors w 0 :::w nÀ1. The t-th power of ~ P will present the transition probabilities between cells in a diffusion (random walk) process of length t. Noting that ~ P t has the same eigenvectors as ~ P, one can show that this transition probability can be represented as follows:</p><formula>~ P t xy ¼ X nÀ1 i¼0 k t i w i ðxÞw i ðyÞ ~ ZðyÞ (7)</formula><p>Each row of ~ P t can be viewed as a vector, which we represent as p t ðx; ÁÞ and consider as the feature representation (Shawe<ref type="bibr" target="#b25">Taylor and Cristianini, 2004</ref>) for each cell x. By computing the weighted L 2 distance in the feature space, the diffusion distance D 2 t between two cells x and y is defined as follows:</p><formula>D 2</formula><formula>Z ¼ X z ð ~ P t xz À ~ P t yz Þ 2 ~ ZðzÞ (8)</formula><p>This diffusion distance can be expressed in terms of the eigenvectors of ~ P such that:</p><formula>D 2 t ðx; yÞ ¼ X nÀ1 i¼1 k 2t i ðw i ðxÞ À w i ðyÞÞ 2 (9)</formula><p>The corresponding eigenvector to the largest eigenvalue k 0 is a constant vector w 0 ¼ 1. Therefore, it only contributes a zero term to D 2 t and is excluded from the spectral decomposition of D 2 t in Equation (9). That means the Euclidean distance of the cells in the firstleigenvector space represents an approximation of their diffusion distance D 2 t. Moreover, the eigenvalues of ~ P determine the diffusion coefficients in the direction of the corresponding eigenvector. As real data usually lie on a lower dimensional manifold than the entire dimensions of space G, these diffusion coefficients drop to a noise level other than a few first (l) prominent directions. Therefore, if there is a significant gap between the l-th and ðl þ 1Þ-th eigenvalue, the sum up to the l-th term usually determines a good approximation for diffusion distances. Thus, for data visualization we select these eigenvectors and instead of the mathematical notation w, we call them diffusion components (DCs).<ref type="figure" target="#fig_0">Figure 1</ref>presents a summary of diffusion map embedding. Each cell is represented by a Gaussian wave function in the Gdimensional gene space. On an adequate Gaussian width, the wave functions of neighbouring cells interfere with each other and form the diffusion paths along the (non-linear) data manifold in the highdimensional space. Hence, we construct the Markovian transition probability matrix, the elements of which are the transition probabilities between all pairs of cells. The eigenfunctions of the Markovian transition probability matrix (DC1 and DC2) are then used for low-dimensional representation and visualization of data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Accounting for missing and uncertain values</head><p>The data generated from qPCR, RNA-Seq or cytometry experiments are very often prone to imperfections such as missing values or detection limit thresholds. It is important to properly treat such uncertainties of data (<ref type="bibr" target="#b5">Buettner et al., 2014;</ref><ref type="bibr" target="#b16">McDavid et al., 2013</ref>). Our probabilistic interpretation of diffusion maps allows a straightforward mechanism of handling missing and uncertain data measurements. First, we have to decompose the kernel into G components. Then, instead of a Gaussian, we can use any other wave function that best represents our prior knowledge on the probability distribution of the missing or uncertain values, which then should be square-normalized to ensure equal contribution of the G components. For example, for missing values and non-detects (measurements below the limit of detection), one might choose a uniform distribution over the whole range of possible values. In the following, we describe how to account for the uncertainty of non-detect measurements in qPCR data. The statistical subtleties of non-detect values in qPCR experiments have been systematically studied by<ref type="bibr" target="#b16">McDavid et al. (2013)</ref>for univariate models. In addition, for a multivariate PCA analysis,<ref type="bibr" target="#b5">Buettner et al. (2014)</ref>proposed that different kernels be allowed in each dimension. For the diffusion map implementation, we assume any value between the detection limit (M 0 ) and a completely non-expressed (off) state of genes valued as M 1 , is equally possible for the non-detect measurements. Considering the kernel width formulated in the diffusion map wave functions, we assume an indicator wave function between M 0 À r and M 1 þ r normalized by ðM 1 À M 0 þ 2rÞ À1=2. Thus, we have to calculate three different kinds of interference of wave functions: The interference of two cells with definite measured values for gene g is the standard Gaussian kernel (see Section 2.1):</p><formula>ð 1 À1 Y x ðx 0 g ÞY y ðx 0 g Þdx 0 g ¼ exp À ðx g À y g Þ 2 2r 2 ! ;</formula><p>the interference of two cells both with non-detect values for gene g is 1 (due to the square-normalization constraint):) which correspond to the largest diffusion coefficients of the data manifold. The embedding shows the continuous flow of cells across four cell types; however, it does not suggest the putative time direction the interference of a missing (non-detect) value to a definite measured value x g is:</p><formula>ð 1 À1 Y x ðx 0 g ÞY y ðx 0 g Þdx 0 g ¼ 1;</formula><formula>ð 1 À1 Y x ðx 0 g ÞY y ðx 0 g Þdx 0 g ¼ ð M1þr M0Àr 1 ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi M 1 À M 0 þ 2r p ð 2 pr 2 Þ 1=4 exp À ðx0 g À x g Þ 2 r 2 ! dx 0 g ¼ 1 ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi M 1 À M 0 þ 2r p pr 2 8 1=4 Á erfc M 0 À r À x g r À erfc M 1 þ r À x g r :</formula><p>For data with missing or uncertain values, we need to check the pairwise interference of the wave functions for each gene. The computation time is thus proportional to the number of genes G for a fixed number of cells n. Therefore, it might be preferable (especially in the case of large G) to choose the wave function of the missing (or uncertain) value also in the form of a Gaussian such that the multiplication of the G components of interference can be expressed as the sum of the exponents and the exponentiation step can be performed only once at the end of the algorithm for computation of the transition matrix. An implementation of this fast version of the censoring algorithm is also provided in the codes package. Supplementary<ref type="figure" target="#fig_0">Figure S1</ref>provides an illustration of our approach for accounting for missing and uncertain values.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Determination of Gaussian kernel width</head><p>The parameter r in Equation (1) determines the scale at which we visualize the data. If r is extremely small, most elements of the transition probability matrix ~ P will tend to be zero and we do not get an overall view of a connected graph structure. In fact, when r is too small, the number of degenerate eigenvectors with eigenvalue equal to one, indicates the number of disconnected segments that ~ P defines on the data. For too large r however, the transition probability sensitivity on the distance between the cells blurs. There is a certain range of r variations for which ~ P defines an ergodic diffusion process on the data as a connected graph and still the diffusion distances between the cells are informative. The un-normalized density at each cell (ZðxÞ in<ref type="bibr">Equation (3)</ref>) is proportional to the number of cells in a fixed volume in its neighbourhood and depends on r. At scales of r close to zero, cells do not have any neighbours and their average density is 1 (because of the 1s on the diagonal of P). By increasing r, the average density gradually increases as more cells find other cells in their neighbourhood. There is a density saturation point where r reaches the system size and all cells form part of one neighbourhood. At this point, for every cell x 2 X, the density ZðxÞ will be equal to the entire system size n. Assuming that the density gradient is not extremely sharp along the data manifold, the number of neighbours of cell x in the neighbourhood r will be proportional to the volume of a hypersphere of radius r, hence: ZðxÞ / r dðx;rÞ</p><formula>(10)</formula><p>where dðx; rÞ is the dimensionality of data manifold at the position of cell x and at the scale r. By differentiating both sides with respect to log ðrÞ, we find that the average dimensionality of the manifold can be estimated by the slope of the log–log plot of the number of neighbours versus the length scale:</p><formula>hdðrÞi x ¼ @hlog ðZðxÞÞi x @log ðrÞ (11)</formula><p>where we compute the average of log ðZðxÞÞ with consideration of density heterogeneities such that:</p><formula>hlog ðZðxÞÞi x ¼ X x ðlog ðZðxÞÞ Á ð1=ZðxÞÞÞ X x ð1=ZðxÞÞ (12)</formula><p>It is worth noting that this average density underestimates the real dimensionality of the structure due to the contribution of the cells lying on the surface of the manifold. However, this does not affect our heuristic since the variation of hdi is our main interest rather than hdi itself. Each time hdi reaches its maximum and starts to decrease, one can deduce that an intrinsically lower dimensional structure is emerging from the noise-enriched distributed cells in the original high-dimensional space. Therefore several characteristic length scales of the data manifold (i.e. width of its linear parts, radius of its curves, etc.) give rise to several local maxima in hdi. Such characteristic scales indeed make our choice for the Gaussian width r since they indicate the scale at which the Euclidean distances used in the Gaussian kernel are sensible in an assumed Euclidean tangent space to the manifold. Although Euclidean distances are also valid for smaller rs than the characteristic length scale, they are not recommended because smaller kernel width would mean less connectivity in the cells graph which in turn results in an increased sensitivity to noise. Supplementary Figures S2 and S3 illustrate the resulting diffusion map on optimal kernel width and several other kernel widths values for a U-shaped toy data. Also the performance of diffusion map at the optimal kernel width when there is no distinguishable pattern in the data (e.g. normally distributed data in all dimensions or sparse data) is illustrated in the Supplementary<ref type="figure" target="#fig_2">Figure S4</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Toy model for differentiation</head><p>As toggle switches are known to play a role in differentiation branching processes (<ref type="bibr" target="#b19">Orkin and Zon, 2008</ref>), we designed a regulatory network of three pairs of toggle genes to evaluate the performance of our method on a toy dataset that mimics a differentiation tree (<ref type="bibr" target="#b15">Krumsiek et al., 2011</ref>). Assuming a genetic regulatory module as presented in<ref type="figure">Figure 2A</ref>, we simulated the stochastic differentiation process by the Gillespie algorithm (<ref type="bibr" target="#b12">Gillespie, 1977</ref>) with the reactions as shown in<ref type="figure">Figure 2B</ref>and C (<ref type="bibr" target="#b27">Strasser et al., 2012</ref>). More details about the chemical reactions and the reaction rates used in the Gillespie algorithm model can be found in the supplement (Supplementary Figs S5A and B). Genes G 1 and G 2 are antagonistic to each other through an inhibiting Hill function. Therefore, starting from an initial undifferentiated state where G 1 and G 2 are both in a very low expression level, single samples may end up in either of the states where G 1 or G 2 is exclusively expressed. At this stage, the next pair of toggle genes in the differentiation hierarchy is activated (through an activating binding Hill function), which are again antagonistic to each other. This model generates four different types of fully differentiated cells in the six-dimensional space of genes. To establish a steady state in the cell population, once a cell hits the end of each branch, we remove it from the population and initiate a new cell at the original undifferentiated state. This approach maintains the population size of cells. After an extended simulation run, the steady state of the population is established and resembles the haemostatic state of (e.g. hematopoietic) stem cells in natural organisms. We sampled cells from this toy model in two different sets, a balanced toy dataset, wherein 600 samples serve as a snapshot of the steady state of the system with no additional extrinsic noise, and an imbalanced toy dataset, wherein 1800 sample are derived from a non-steady-state density distribution with heavier sampling density on the G þ 1 G þ 3 branch. We also added an extrinsic Gaussian noise with a variance of 25% maximum expression to each gene. The gene expression plot for a simulated single cell as it proceeds from the initial pluripotent state to a fully differentiated state is presented in the supplement (Supplementary Figs S5C and D).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Experimental data</head><p>2.5.1 qPCR data of mouse haematopoietic stem cells. We calculated a diffusion map embedding for the haematopoietic and progenitor stem cells dataset from<ref type="bibr" target="#b18">Moignard et al. (2013)</ref>. In this experiment, 597 cells from five different haematopoietic cell types, namely, haematopoietic stem cell (HSC), lymphoid-primed multipotent progenitor (LMPP), megakaryocyte-erythroid progenitor (PreMegE), common lymphoid progenitor (CLP) and granulocyte– monocyte progenitor (GMP) were gated by Fluorescence-activated cell sorting (FACS) sorting. Single-cell qPCR expression level measurement was then performed for 24 genes. Housekeeping genes were only used for cell-cycle normalization, where for each cell, all expression values were divided by the average expression of its housekeeping genes. Furthermore we excluded the five housekeeping genes, as well as c-Kit, which is a stem-cell receptor factor expressed on the surface of all analyzed cells, from the diffusion map analysis. 2.5.2 qPCR data of mouse stem cells from zygote to blastocyst To understand the earliest cell fate decision in a developing mouse embryo,<ref type="bibr" target="#b13">Guo et al. (2010)</ref>conducted a qPCR experiment for 48 genes in seven different developmental time points. The gene expression levels were normalized to the endogenous controls Actb and Gapdh. The authors also identified four cell types, namely, inner cell mass (ICM), trophectoderm (TE), primitive endoderm (PE) and epiblast (EPI) using characteristic markers. The total number of single cells used in the diffusion map analysis was 429.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5.3">RNA-Seq of human preimplantation embryos</head><p>For the dataset published by<ref type="bibr" target="#b33">Yan et al. (2013)</ref>, RNA-Seq analysis was performed on 90 individual cells from 20 oocytes and embryos. The sequenced embryos were picked at seven crucial stages of preimplantation: metaphase II oocyte, zygote, 2-cell, 4-cell, 8-cell, morula and late blastocyst at the hatching stage.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>In this section, we evaluate the performance of the diffusion map on each of the datasets described in the Methods section and compare it to the performance of two other dimension-reduction methods PCA and t-SNE. Data embeddings with several other methods including ICA, SPADE, kernel-PCA (<ref type="bibr" target="#b23">Schö lkopf et al., 1998</ref>), isomap and Hessian Locally linear embedding (HLLE) are provided in the Supplementary Figures S16–S20.<ref type="figure" target="#fig_3">Figure 3</ref>shows the average dimensionality hdi for balanced toy data (red) and imbalanced toy data (black) as a function of log ðrÞ. The balanced set exhibits two maxima. The first one arises at the length scale of the thickness of the differentiation branches which include only a few cells. At this r several subpopulations form at the more densely populated stages of the steady state. The second maximum appears at a larger length scale when several subpopulations become visible to each other and the continuous branches form. We picked the r at the second maximum for visualization (data visualization at the first maximum is provided in the Supplementary<ref type="figure">Fig. S6</ref>). For the imbalanced set, however, due to the high noise level, the first maximum vanished and we only detected one maximum which we then used for the visualization.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Diffusion</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Performance</head><p>of the diffusion map on the toy data as compared to the other methods Definition of diffusion distance (<ref type="bibr">Equation (8)</ref>) based on probability of transition between cells through several paths renders diffusion maps very robust to noise.<ref type="figure" target="#fig_2">Figure 4</ref>presents a comparison between the performance of the diffusion map and the other two methods PCA and t-SNE on the balanced toy dataset. The eigenvalues of the diffusion map (<ref type="figure" target="#fig_2">Fig. 4D</ref>) suggest that there are four leading dimensions that explain the data structure and the higher dimensions present noise rather than the intrinsic structure of the data manifold. The complete set of two-by-two projections up to the fourth eigenvector can be found in the supplementary<ref type="figure" target="#fig_4">Figure S7</ref>. PCA of this dataset generated results that were similar to the diffusion map, where all four branches of the data could be distinguished. However, standard t-SNE did not preserve the data structure continuity. Visualization using t-SNE with non-standard perplexity values are also provided in the Supplementary<ref type="figure" target="#fig_5">Figure S8</ref>. To determine how additional extrinsic noise and density heterogeneities affect each method, we also applied the three methods on imbalanced toy<ref type="figure">Fig. 2.</ref>(A) Toy model of a differentiation regulatory network consisting of three pairs of antagonistic genes simulated by the Gillespie algorithm. The arrows show activation or inhibition interactions between genes. The toy model employs two classes of gene regulation: (B) G i is connected to an inhibitor, its production rate a i is proportional to a Hill function of the concentration of the inhibitor Protein i 0 (C) G i is connected to an inhibitor G i 0 and an activator G i 00 , its production rate a i is proportional to product of an inhibiting and an activating Hill function. The degradation rate c is constant for all proteins</p><p>Diffusion maps for high-dimensional single-cell analysisdata (<ref type="figure">Fig. 5</ref>). The eigenvalues plot of the diffusion map in this figure suggests the same order of significance for the third and fourth eigenvectors as k 4 almost equals k 3 and that the higher order eigenfunctions mostly present noise. We chose two projections (DC, DC2, and DC3) and (DC1, DC2, and DC4) for illustration in<ref type="figure">Figure 5</ref>. The complete set of two-by-two projection can be found in the Supplementary<ref type="figure">Figure S9</ref>. From<ref type="figure">Figure 5A</ref>, one can infer the same size for all four branches of differentiation despite different sampling densities. This figure also suggests that the diffusion map clearly shows four branches of the imbalanced toy data, whereas PCA and t-SNE produce noisier visualization and represent the two rarer branches as smaller. For additional t-SNE visualizations with non-standard perplexity values for the imbalanced toy data see Supplementary<ref type="figure" target="#fig_0">Figure S10</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.3">Refinement of the transition matrix by density normalization, zero diagonal and accounting for missing values</head><p>In order to adapt the standard diffusion map algorithm to the properties of single-cell gene expression parameters, we refined the transition matrix in different ways. First, we set the diagonal of the transition matrix to zero (<ref type="bibr">Equation (5)</ref>) since the (non-zero version) diagonal carries information about local sampling densities. Unlike many other applications where the information about local densities has some value, the sampling density in the context of single-cell data is somewhat arbitrary (e.g. only specific cell types are monitored, different proliferation rates in several stages of differentiation alters the sampling density, outlier cells show lower density, etc.). For a demonstration of how zero diagonal improves the quality of the diffusion map see Supplementary<ref type="figure" target="#fig_0">Figure S11</ref>. Second, we refined the Markovian transition matrix by density normalization (<ref type="bibr">Equation (5)</ref>) since the number of diffusion paths between two cells depends on the density of cells connecting them and more densely sampled regions of the data would seem to have smaller diffusion distance to each other on a diffusion map without density normalization. Supplementary<ref type="figure" target="#fig_0">Figure S12</ref>demonstrates how density normalization improves the quality of the diffusion map. The third refinement that we used in our implementation of diffusion maps is accounting for missing and non-detect values (Section 2.2). Generally speaking as the proportion of missing and non-detect values increases, there is a decrease in the quality of the diffusion map. However the magnitude of this effect depends highly on the architecture of the gene regulatory network and the role of the corresponding gene in the network. For example, for a toggle switch, low expression of a gene would always imply high expression of the other gene. Therefore, increasing the detection threshold (i.e. increasing number of non-detects) does not have a major influence on the analysis, as the information is still present in the other gene with high expression. We evaluate the performance of diffusion map in several proportions of missing values for the balanced toy data in Supplementary<ref type="figure" target="#fig_0">Figure S13</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Diffusion map allows identification of differentiation trajectories on experimental data</head><p>3.2.1 Performance on haematopoietic stem cells qPCR data as compared to the other methods The diffusion map embedding for the haematopoietic stem cells (<ref type="figure">Fig. 6A</ref>) indicates a major branching of HSCs to PreMegE and LMPP cell types and a further branching of LMPPs to CLP and GMP cells. The branching structures are less clear in the PCA plot (<ref type="figure">Fig. 6B</ref>). Moreover, PCA produces artificial planes of data in the embedding because of the non-detect measurements in the qPCR data. The t-SNE plot (<ref type="figure">Fig. 6C</ref>) almost separated the cell types (except for LMPPs) into different clusters. However, the notion of temporal progress is less clear compared to the diffusion map embedding. In addition, since uncertainties in the values of non-detects were not considered, a widening within the clusters is observed. Detailed visualization using the three methods and the Gaussian width determination for diffusion map embedding are provided in the Supplementary<ref type="figure" target="#fig_0">Figure S14</ref>. The ordered eigenvalues plot for the diffusion map and PCA are shown in Figures 6D and E. The ordered eigenvalues plot of the diffusion map suggests that there is no clear separation between the eigenvectors of the diffusion map that captures the intrinsic low-dimensional data manifold and those characterizing noise for this dataset. However, what makes the diffusion map embedding of this dataset more plausible is the concordance between the branching structure as suggested by the diffusion map and the recently established hierarchy of haematopoietic cell types (<ref type="bibr" target="#b1">Arinobu et al., 2007;</ref><ref type="bibr" target="#b18">Moignard et al., 2013</ref>) illustrated in<ref type="figure">Figure 6F.</ref>3.2.2 Performance of the diffusion map on mouse embryonic stem cells qPCR data as compared to the other methods For the mouse embryonic stem cells, diffusion map visualization using the first three eigenvectors indicated a branching at the early16-cell stage to the ICM and TE cell types, and further branching of the ICM at the late 32-cell stage into the EPI and PE (<ref type="figure" target="#fig_4">Fig. 7A</ref>). The branching structure is unclear in the PCA and t-SNE plots (Figs 7B and C). The ordered eigenvalues plot for the diffusion map and PCA are shown in Figures 7D and 7E. The branching structure indicated by the diffusion map is in agreement with the results of previous studies on this dataset (<ref type="bibr" target="#b4">Buettner and Theis, 2012;</ref><ref type="bibr" target="#b13">Guo et al., 2010</ref>), which suggests a branching into the two cell types, ICM and TE, after the 8-cell stage and further branching of the ICM into EPI and PE cells (<ref type="figure" target="#fig_4">Fig. 7F</ref>). More information on Gaussian width determination and two-dimensional projections of data on each pair of the first to fourth eigenvectors of the diffusion map are provided in the Supplementary<ref type="figure" target="#fig_0">Figure S15</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.3">Performance on</head><p>human pre-implantation embryos RNA-Seq data compared with other methods The performance of the diffusion map on this RNA-Seq dataset is comparable (although slightly sharper with respect to pseudotime ordering) to the other two methods, PCA and t-SNE (<ref type="figure" target="#fig_5">Fig. 8</ref>). The number of single cells measured in RNA-Seq is currently limited due to high sequencing costs. A low number of sampled cells could not meaningfully indicate a complex structure. Hence, PCA and t-SNE performance is almost as good as that of the diffusion map. However, with the expected development of new and cheaper RNA sequencing technologies, we propose a diffusion map that could be used as a powerful dimension-reduction tool the computation time of which is only linear with respect to the number of genes.</p><p>Among these methods, isomap and (H)LLE have not been applied for the analysis of single-cell differentiation data and pseudotime ordering so far, mainly because they do not meet the specific requirements for the analysis of such data including capability to handle high levels of technical noise, sampling density heterogeneities, detection limits and missing values. Supplementary Figures S19 and S20 in the supplement demonstrate the poor performance of these methods for finding the differentiation manifold in presence of noise and density heterogeneity for our toy dataset as well as the three experimental single-cell datasets. For any dataset, it is important to consider the advantages and disadvantages of each method with respect to the data properties and the purpose of the analysis, in order to make a suitable choice for applying to that dataset. In our diffusion maps implementation, by performing density normalization and setting the diagonal of the transition probability matrix to zero, we propose a mapping technique wherein the closeness of cells in the diffusion metric is unaffected by density heterogeneities in data sampling (see Supplementary Figs S9 and S10). This feature can be crucial for the detection of rare populations, which is one of the main challenges in the analysis of differentiation data. By breaking the diffusion kernel (<ref type="bibr" target="#b17">Mohri et al., 2012</ref>) to its multiplicand wave functions, we also propose a method in accommodating the uncertainties of measurement and missing values into the wave function. Consequently, we have successfully addressed uncertainties in the value of non-detects in qPCR data. Tuning the scale parameter r is also important for generating insights into the structure of the data, for which we proposed a criterion on the basis of the characteristic length scales of the data manifold. Because of computational limitations, for our criterion we compute the average intrinsic dimensionality and hence the average characteristic length scale. However, when density heterogeneities are extremely large, or the data manifold has many sharp changes and several scales, a single r may not provide a globally optimal scale for data embedding. Therefore, implementation of an efficient and cost-effective method for several locally valid rs determinations, instead of a single global value is of interest. It is worth noting that the mathematical ergodicity in diffusion maps reached by adequate kernel width selection does not necessarily imply biological ergodicity. If there appears a trace of transitory cells between two clusters, we conclude the two clusters are also biologically connected to each other in an ergodic sense. However this trace might be not present if the transition is too fast or switch-like abrupt, so that no transitory cells have been caught in the finite set of sampled cells of snapshot data. Thus it has to be proven with dedicated biological experiments (e.g. as used by<ref type="bibr" target="#b6">Buganim et al. (2012)</ref>and<ref type="bibr" target="#b28">Takahashi and Yamanaka (2006)</ref>) whether the data is biologically ergodic or not. A possible strategy for enhancing the capacity of capturing details of the structure of rare populations using diffusion maps is to limit the transition possibility of each cell only to its closest neighbours. In this scenario, we could render the diffusion map more local by building the transition matrix ~ P in Equation (6) for k nearest neighbours only. This method, however, might end up with several disconnected sub-graphs of cells when the sampling density along the intrinsic data manifold is extremely heterogeneous. Furthermore, ~ P (without the row normalization) will not be symmetric any more and we cannot ensure real eigenvalues for the transition probability matrix. However, as long as the graph is(weak) global</p><formula>À/þ 2D À À þ /þ</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Diffusion maps for high-dimensional single-cell analysis</head><p>connected and eigenvalues are real, we can benefit from a more locally detailed map. One caveat in the current version of diffusion map is the n 2 Â G computation time which can be prohibitive for large cell numbers (&gt; 10 4 ) as generated from cytometry experiments. Choosing the k nearest neighbours version of diffusion map can therefore be a solution to this problem. Diffusion distances are based on a robust connectivity measure between cells which is calculated over all possible paths of a certain length between the cells. Thus, a diffusion mapping obtained by accounting for a smaller fraction of all possible paths (namely those going through each cells' nearest neighbours) can still provide a good approximation of the diffusion distance between the cells and yet avoid computing all n 2 elements of the transition probability matrix. With such modifications, diffusion maps prevail as a promising method for the analysis of large cell numbers omics data. Another issue is the number of embedding dimensions. The number of significant dimensions of the diffusion map is determined where a remarkable gap occurs in its sorted eigenvalues plot. This is not intrinsically bound to the conventional visualizable dimensions two or three. In contrast, for some other methods such as t-SNE, one can pre-determine the number of visualization dimensions for the embedding optimization to two or three dimensions. We conclude that diffusion maps are appropriate and powerful for the dimension-reduction of single-cell qPCR and RNA-Seq cell differentiation data as they are able to handle high noise levels, sampling density heterogeneities, and missing and uncertain values. As a result diffusion maps can organize single cells along the non-linear and complex branches of differentiation, maintain the global structure of the differentiation dynamics and detect rare populations as well.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Schematic overview of diffusion maps embedding. (A) The n Â G matrix representation of single-cell data consisting of four different cell types. The last column on the right side of the matrix (colour band) indicates the cell type for each cell. (B) Representation of each cell by a Gaussian in the G-dimensional gene space. Diffusion paths (continuous paths with relatively high-probability density) form on the data manifold as a result of interference of the Gaussians. The Probability density function is shown in the heat map. (C) The n Â n Markovian transition probability matrix. (D) Data embedding on the first two eigenvectors of the Markovian transition matrix (DC1 and DC2) which correspond to the largest diffusion coefficients of the data manifold. The embedding shows the continuous flow of cells across four cell types; however, it does not suggest the putative time direction</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>maps cope with high noise level and sampling density heterogeneity for toy data 3.1.1 Gaussian width determination of the toy data We demonstrate the heuristic determination of r on balanced and imbalanced toy datasets. The average dimensionality of the structure of some chosen characteristic length scale can be estimated by Equation (11).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.4.</head><figDesc>Fig. 4. Visualization of the balanced toy data on (A) the first three eigenvectors of the diffusion map, (B) PCA and (C) t-SNE. The colours (heat map of blue to red) indicate the maximum expression among all genes. Eigenvalues sorted in decreasing order for (D) diffusion map and (E) PCA</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. The average dimensionality of the data hdi as a function of log 10 ðrÞ for the balanced and imbalanced toy datasets</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.7</head><figDesc>Fig. 7 Visualization of mouse embryonic stem cells on (A) the first three eigenvectors of diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in a decreasing order for (D) diffusion map and (E) PCA. (F) The hierarchy of cells for mouse embryonic stem cells</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.8.</head><figDesc>Fig. 8. Visualization of human preimplantation embryos data on (A) the first three eigenvectors of the diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in a decreasing order for (D) the diffusion map and (E) PCA</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2989 Bioinformatics, 31(18), 2015, 2989–2998 doi: 10.1093/bioinformatics/btv325 Advance Access Publication Date: 21 May 2015 Original Paper</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 1. Comparison of several dimension-reduction algorithms in the view of single-cell omics data application</figDesc><table>Reference 

Methodology 

Linear/ 
non-linear 

Structure 
faithfulness 

Robustness 

to noise/density 
heterogeneities 
No. of dims 
needed for 
embedding 
Handles missing/un-
certain values? 

Keeps 
single-cell 
resolution? 

Clustering/ 
keeping 
continuity 

Tuning 
parameters 
Best performance 

PCA 
Hotteling (1993) 

Orthogonal 
transformation 

Linear 

Global 

þ/À 

Depends on 
eigenvalues 
þ (Buettner et al., 

2014) 

þ 

À /þ 

None 

Linear data 
subspace 

ICA 

Stone (2004) 

Orthogonal 
transformation 

Linear 

Global 

þ/À 

Arbitrary 

À 

þ 

À /þ 

None 

Linear data sub-
space, known 
no. of sources 

SPADE 
Qui et al. (2011) 

Agglomerative/k 

means clustering, 
minimum span-

ning trees 

Non-linear Local and 

</table></figure>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="4"> Discussion and conclusion In this manuscript, we have demonstrated the capabilities of diffusion maps for the analysis of continuous dynamic processes, in particular, differentiation data in a toy dataset and a few experimental datasets. Using a biologically relevant distance metric (i.e. diffusion distance), the adapted diffusion map method outperforms other dimension-reduction methods in pseudotemporal ordering of cells along the differentiation paths and could capture the expected differentiation structure in all cases. Table 1 provides a general comparison of several dimension-reduction methods, detailing capabilities and limitations in application to single-cell omics data. Fig. 5. Visualization of the imbalanced toy data on (A) the first three eigenvectors of the diffusion map, (B) the first, second and fourth eigenvectors of the diffusion map, (C) the first three components of the PCA (D) the first, second and fourth components of PCA and (E) t-SNE. The colours (heat map of blue to red) indicate the maximum expression among all genes. Eigenvalues sorted in a decreasing order for (F) diffusion map and (G) PCA Fig. 6. Visualization of haematopoietic stem cells data on the first three eigenvectors of (A) diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in a decreasing order for (D) diffusion map and (E) PCA. (F) The hierarchy of haematopoietic cell types</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Michael Strasser (Institute for Computational Biology, Helmholtz Centre Munich), Victoria Moignard (Cambridge Institute of Medical Research), Berthold Goettgens (Cambridge Institute of Medical Research) and Mauro Maggioni (Department of Mathematics, Duke University) for helpful advice and discussions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This study has been funded by The Bavarian Research Network for Molecular Biosystems (BioSysNet) and the European Research Council (ERC starting grant LatentCauses). Conflict of Interest: none declared.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">D</forename>
				<surname>Amir</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="545" to="552" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Reciprocal activation of GATA-1 and PU. 1 marks initial specification of hematopoietic stem cells into myeloerythroid and myelolymphoid lineages</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Arinobu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell Stem Cell</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="416" to="427" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Mass cytometry: technique for real time single cell multitarget immunoassay based on inductively coupled plasma time-offlight mass spectrometry</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">R</forename>
				<surname>Bandura</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="6813" to="6822" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">C</forename>
				<surname>Bendall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">157</biblScope>
			<biblScope unit="page" from="714" to="725" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">A novel approach for resolving differences in single-cell gene expression patterns from zygote to blastocyst</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Buettner</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">J</forename>
				<surname>Theis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="626" to="632" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Probabilistic PCA of censored data: accounting for uncertainties in the visualisation of high-throughput single-cell qPCR data</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Buettner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Single-cell expression analyses during cellular reprogramming reveal an early stochastic and a late hierarchic phase</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Buganim</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">150</biblScope>
			<biblScope unit="page" from="1209" to="1222" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Quantum dot semiconductor nanocrystals for immunophenotyping by polychromatic flow cytometry</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">K</forename>
				<surname>Chattopadhyay</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Med</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="972" to="977" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">RNA sequencing: platform selection, experimental design, and data interpretation</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Chu</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">R</forename>
				<surname>Corey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acid Therapeutics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="271" to="274" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Coifman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="7426" to="7431" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Hessian eigenmaps: Locally linear embedding techniques for high-dimensional data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">L</forename>
				<surname>Donoho</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Grimes</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="page" from="5591" to="5596" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Long-term propagation of distinct hematopoietic differentiation programs in vivo</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Dykstra</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell Stem Cell</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="218" to="229" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Exact stochastic simulation of coupled chemical reactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">T</forename>
				<surname>Gillespie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Phys. Chem</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="2340" to="2361" />
			<date type="published" when="1977" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Guo</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Dev. Cell</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="675" to="685" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Non-genetic heterogeneity of cells in development: more than just noise</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Huang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Development</title>
		<imprint>
			<biblScope unit="volume">136</biblScope>
			<biblScope unit="page" from="3853" to="3862" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Hierarchical differentiation of myeloid progenitors is encoded in the transcription factor network</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Krumsiek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PloS One</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">22649</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Data exploration, quality control and testing in singlecell qPCR-based gene expression experiments</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Mcdavid</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="461" to="467" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<monogr>
		<title level="m" type="main">Foundations of Machine Learning</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Mohri</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
			<publisher>MIT Press</publisher>
			<pubPlace>Cambridge, MA, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Characterization of transcriptional networks in blood stem and progenitor cells using high-throughput single-cell gene expression analysis</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Moignard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Cell Biol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="363" to="372" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Hematopoiesis: an evolving paradigm for stem cell biology</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">H</forename>
				<surname>Orkin</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">I</forename>
				<surname>Zon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">132</biblScope>
			<biblScope unit="page" from="631" to="644" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Visualization of dynamics of single endogenous mrna labeled in live mouse</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">Y</forename>
				<surname>Park</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">343</biblScope>
			<biblScope unit="page" from="422" to="424" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Qiu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="886" to="891" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Hematopoietic cytokines can instruct lineage choice</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">A</forename>
				<surname>Rieger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">325</biblScope>
			<biblScope unit="page" from="217" to="218" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Nonlinear component analysis as a kernel eigenvalue problem</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Schö Lkopf</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural Comput</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="1299" to="1319" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Long-term single-cell imaging of mammalian stem cells</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Schroeder</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="30" to="35" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<monogr>
		<title level="m" type="main">Kernel Methods for Pattern Analysis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Shawe-Taylor</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Cristianini</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
			<publisher>Cambridge University Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Purification and unique properties of mammary epithelial stem cells</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Stingl</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">439</biblScope>
			<biblScope unit="page" from="993" to="997" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Stability and multiattractor dynamics of a toggle switch based on a two-stage model of stochastic gene expression</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Strasser</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biophys. J</title>
		<imprint>
			<biblScope unit="volume">102</biblScope>
			<biblScope unit="page" from="19" to="29" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Induction of pluripotent stem cells from mouse embryonic and adult fibroblast cultures by defined factors</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Takahashi</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Yamanaka</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">126</biblScope>
			<biblScope unit="page" from="663" to="676" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b29">
	<analytic>
		<title level="a" type="main">A global geometric framework for nonlinear dimensionality reduction</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">B</forename>
				<surname>Tenenbaum</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">290</biblScope>
			<biblScope unit="page" from="2319" to="2323" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b30">
	<analytic>
		<title level="a" type="main">The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Biotechnol</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="381" to="386" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b31">
	<analytic>
		<title level="a" type="main">Visualizing data using t-SNE</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Van Der Maaten</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Hinton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mach. Learn. Res</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="2579" to="2605" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b32">
	<analytic>
		<title level="a" type="main">Real-time polymerase chain reaction</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Wilhelm</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Pingoud</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Chembiochem</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="1120" to="1128" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b33">
	<analytic>
		<title level="a" type="main">Single-cell RNA-Seq profiling of human preimplantation embryos and embryonic stem cells</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Yan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Struct. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="1131" to="1139" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>