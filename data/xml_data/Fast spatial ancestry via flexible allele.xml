
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:43+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis Fast spatial ancestry via flexible allele frequency surfaces</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">20 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">John</forename>
								<surname>Michael</surname>
							</persName>
						</author>
						<author role="corresp">
							<persName>
								<forename type="first">Ra</forename>
								<forename type="middle">~</forename>
								<surname>Nola</surname>
							</persName>
							<email>ranolaj@uw.edu or klange@ucla.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Statistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">John</forename>
								<surname>Novembre</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Human Genetics</orgName>
								<orgName type="institution">University of Chicago</orgName>
								<address>
									<postCode>60637</postCode>
									<settlement>Chicago</settlement>
									<region>IL</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kenneth</forename>
								<surname>Lange</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Department of Biomathematics</orgName>
								<orgName type="department" key="dep2">Human Genetics, and Statistics</orgName>
								<orgName type="institution">University of California Los Angeles</orgName>
								<address>
									<postCode>90095</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<surname>Barrett</surname>
							</persName>
						</author>
						<title level="a" type="main">Genetics and population analysis Fast spatial ancestry via flexible allele frequency surfaces</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="page" from="2915" to="2922"/>
							<date type="published" when="2014">20 2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu418</idno>
					<note type="submission">Advance Access publication July 9, 2014 Received on January 23, 2014; revised on June 13, 2014; accepted on June 24, 2014</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Availability and implementation: Software will be freely available as the OriGen package in R. Contact: Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Unique modeling and computational challenges arise in locating the geographic origin of individuals based on their genetic backgrounds. Single-nucleotide polymorphisms (SNPs) vary widely in informativeness, allele frequencies change non-linearly with geography and reliable localization requires evidence to be integrated across a multitude of SNPs. These problems become even more acute for individuals of mixed ancestry. It is hardly surprising that matching genetic models to computational constraints has limited the development of methods for estimating geographic origins. We attack these related problems by borrowing ideas from image processing and optimization theory. Our proposed model divides the region of interest into pixels and operates SNP by SNP. We estimate allele frequencies across the landscape by maximizing a product of binomial likelihoods penalized by nearest neighbor interactions. Penalization smooths allele frequency estimates and promotes estimation at pixels with no data. Maximization is accomplished by a minorize–maximize (MM) algorithm. Once allele frequency surfaces are available, one can apply Bayes&apos; rule to compute the posterior probability that each pixel is the pixel of origin of a given person. Placement of admixed individuals on the landscape is more complicated and requires estimation of the fractional contribution of each pixel to a person&apos;s genome. This estimation problem also succumbs to a penalized MM algorithm. Results: We applied the model to the Population Reference Sample (POPRES) data. The model gives better localization for both unmixed and admixed individuals than existing methods despite using just a small fraction of the available SNPs. Computing times are comparable with the best competing software.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The pertinence of the first law of geography—'Everything is related to everything else, but near things are more related than distant things' (<ref type="bibr" target="#b18">Tobler, 1970</ref>)—has long been obvious to population geneticists. For example, in the 1930s,<ref type="bibr" target="#b4">Fisher (Fisher, 1937</ref>) and Kolmogorov (<ref type="bibr" target="#b9">Kolmogorov et al., 1937</ref>) derived and solved a partial differential equation describing the spatial spread of an advantageous allele. Subsequent generations of ecologists and evolutionary biologists have studied the correlations between geography and population structure from many different perspectives (<ref type="bibr" target="#b6">Guillot et al., 2009;</ref><ref type="bibr" target="#b8">Kimura and Weiss, 1964;</ref><ref type="bibr" target="#b17">Sokal and Oden, 1978;</ref><ref type="bibr" target="#b20">Wilkins and Wakeley, 2002</ref>). During the past decade in particular, geneticists have discovered how to localize the origin of individuals, human and otherwise, based on their genetic backgrounds (<ref type="bibr" target="#b13">Lao et al., 2008;</ref><ref type="bibr" target="#b15">Novembre et al., 2008;</ref><ref type="bibr" target="#b19">Wasser et al., 2004;</ref><ref type="bibr" target="#b21">Yang et al., 2012</ref>). Such localization is called spatial assignment. In an application of principal component analysis (PCA),<ref type="bibr" target="#b15">Novembre et al. (2008)</ref>were able to match the first two principal components of the genotype matrix of the Population Reference Sample (POPRES) dataset (<ref type="bibr" target="#b14">Nelson et al., 2008</ref>) to the map of Europe. PCA-based estimation of geographic origins was accurate to within a few hundred kilometers. Though this level of resolution is impressive, it is natural to wonder if a modelbased method for spatial assignment could perform better and whether inferences could be reliably made for admixed individuals. This prompted<ref type="bibr" target="#b21">Yang et al. (2012)</ref>to introduce spatial structure analysis (SPA), which, in fact, produces more accurate spatial assignments than PCA. In estimating allelic frequency surfaces for each surveyed single-nucleotide polymorphism (SNP), SPA depends on a simple gradient function describing how allele frequencies vary with location. In practice, allele frequency surfaces can be bumpy without a dominant cline. The current article relaxes this restriction and gives more accurate reconstructions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">APPROACH</head><p>Our software, OriGen, adapts techniques from image reconstruction that encourages smoothness without requiring rigidly parameterized allele frequency surfaces (<ref type="bibr" target="#b3">Chan and Shen, 2005;</ref><ref type="bibr" target="#b10">Lange, 1990</ref>). OriGen is model based and fast. It can infer the geographic origin of Europeans in the POPRES dataset to much less than 100 km. Its impressive speed is achieved by focusing on the most informative markers, sometimes as few as 1% of all markers, and relying on new minorization–maximization (MM) algorithms for parameter estimation. In choosing ancestry informative markers, we replace the information criterion of<ref type="bibr" target="#b16">Rosenberg et al. (2003)</ref>by a homogeneity likelihood ratio test (LRT) that accommodates substantial differences in sample sizes. *To whom correspondence should be addressed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">MATERIALS AND METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">A LRT criterion for SNP selection</head><p>The majority of SNPs are uninformative for ancestry and geographic localization. This fact and considerations of computational speed suggest choosing the most informative SNPs and ignoring the rest. The standard ancestry informativeness criterion of<ref type="bibr" target="#b16">Rosenberg et al. (2003)</ref>makes the implicit assumption of equal sample sizes. The failure of this assumption in the POPRES data prompted us to turn to a homogeneity LRT. The null model of the test for a given SNP postulates that all individuals come from a single population with a unique allele frequency for the reference allele; the alternative model postulates different reference allele frequencies at the different sampling sites. Binomial sampling is in force. Suppose there are s sites with k i sampled reference alleles and n i sampled genes (reference alleles plus alternative alleles) at site i. If k=</p><formula>X s i=1 k i and n= X s i n i ,</formula><p>then the LRT statistic reduces to</p><formula>LRT=2 ln max p Y s i=1 n i k i 0 @ 1 A p ki i ð1 À p i Þ niÀki Y s i=1 n i k i 0 @ 1 A max q q k ð1 À qÞ nÀk =2 ln Y s i=1 ^ p ki i ð1 À ^ p i Þ niÀki ^ q k ð1 À ^ qÞ nÀk</formula><p>where ^ q=k=n and ^ p i =k i =n i are the maximum likelihood estimates of the reference allele frequencies under the null and alternative models, respectively. Although small sample sizes at many sites invalidate the chi-square distribution of the LRT statistic, nothing prevents the statistic from being used as an index to rank the various SNPs. In our experience, the highest ranking SNPs are indeed the most informative.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Allele frequency surface estimation</head><p>To estimate the allele frequency surface for a given SNP, we divide the region of interest, say Europe, into pixels and assign a reference allele frequency p i to each pixel i. Extending our previous notation, k i now represents the number of sampled reference alleles and n i the number of sampled genes from pixel i. For most pixels, k i =n i =0. Maximizing the binomial loglikelihood</p><formula>LðpÞ= X i ln n i k i ! +k i ln p i +ðn i À k i Þ ln ð1 À p i Þ " #</formula><p>would allow estimation of the reference allele frequencies if all pixels actually contained sampled people. Because this is not the case and because we desire smooth estimates across the landscape, we subtract squared difference penalties from the loglikelihood and maximize the penalized loglikelihood</p><formula>fðpÞ=LðpÞ À X fi;jg w ij ðp i À p j Þ 2 = X i ln n i k i 0 @ 1 A +k i ln p i +ðn i À k i Þ ln ð1 À p i Þ 2 4 3 5 À X fi;jg w ij ðp 2 i À 2p i p j +p 2 j Þ ð1Þ</formula><p>Here the tuning constant determines the extent of smoothing. The nonnegative weights w ij incorporate nearest neighbor interactions and scale the distance between pixel centers. For square pixels we accordingly set w ij = 1 for pixels sharing a side, w ij =1= ffiffi ffi 2 p for pixels sharing a corner and w ij = 0 for all other pixel pairs. Limiting interactions to the eight pixels surrounding a pixel obviously reduces computational complexity. Maximizing the criterion (1) is a formidable optimization problem because the penalty terms couple the parameters in an awkward fashion and make it impossible to find an exact solution. However, we can invoke the MM principle (<ref type="bibr" target="#b7">Hunter and Lange, 2004;</ref><ref type="bibr" target="#b11">Lange, 2012;</ref><ref type="bibr" target="#b12">Lange et al., 2000</ref>) and construct a surrogate function that separates the parameters. A surrogate function gðp j p n Þ for the objective function fðpÞ must be tangent to fðpÞ at the current iterate p n and dominated by it throughout the common domain of both functions. Formally, these conditions can be restated as the equality gðp n j p n Þ=fðp n Þ and the inequality gðp j p n Þ fðpÞ for all feasible p. In the maximization step of the MM algorithm, the next iterate p n+1 is chosen to maximize p ° gðp j p n Þ. These definitions imply the ascent condition fðp n+1 Þ ! gðp n+1 j p n Þ ! gðp n j p n Þ=fðp n Þ; which is the secret of the MM principle's success. The derivation of our surrogate function depends on the minorization xy ! x m y m 1+ln x x m +ln y y m ! ð2Þ for positive numbers. This minorization reduces to the supporting line inequality Àln z ! 1 À z if we substitute z=xy=ðx n y n Þ. Application of the minorization (2) leads to the overall minorization</p><formula>gðp j p n Þ = LðpÞ À X fi;jg w ij p 2 i +p 2 j À 2p ni p nj ðln p i +ln p j Þ</formula><p>h i of fðpÞ up to an irrelevant constant. With parameters separated, we can now solve the stationarity equationw ij p nj. This cubic is positive when p i = 0 and non-positive when p i = 1. The cubic also tends to AE1 when p i tends to AE1. Hence, there exists a single root on the interval ð0; 1. One can extract this root by one of the standard formulas for solving a cubic equation. In practice, we add a small increment , say 0.1, to each sampled k i and 2 to each sampled n i. These pseudocounts, which are similar to Laplace estimators, stabilize estimation and prevent allele frequencies from converging to 0. For plotting on a log-scale, pseudocounts are mandatory. One can view pseudocounts as imposing a weak beta prior.</p><formula>0= k i p i À n i À k i 1 À p i À 2 X j6 ¼i w ij p i À p ni p nj 1 p i !</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Localization of unknowns</head><p>Once the allele frequency surfaces for the informative SNPs are estimated by the MM algorithm, one can localize individuals of unknown origin. For person j with genotype vector x j , Bayes' rule gives the posterior probability Prð j from pixel i j x j Þ= Pr ðx j j j from pixel iÞ Pr ðj from pixel iÞ Pr ðx j Þ that j originates from pixel i. Application of this rule depends on fixing a prior. Two possibilities are convenient. The simpler one is the uniform prior. A more accurate but less convenient choice is to scale the prior of a pixel by its population size. For sufficiently informative genetic data, the evidence dominates the prior, and the uniform prior is probably adequate. The likelihood term Pr ðx j j j from pixel iÞ= Y k</p><p>Pr ðx jk j j from pixel iÞ factors into a product of likelihoods at the canvassed SNPs under the assumption of linkage and Hardy–Weinberg equilibrium. The likelihood Pr ðx jk j j from pixel iÞ at SNP k equals one of the three genotype probabilities p 2 ik ; 2p ik ð1 À p ik Þ or ð1 À p ik Þ 2 depending on j's genotype at SNP k. In practice, it is advisable to work with the logarithms of these quantities to avoid computer underflows. Although the pixel with the highest posterior probability provides the most likely localization, it is a good idea in practice to assign an average latitude and longitude and highlight the set of pixels that contribute substantially to the posterior distribution. For large numbers of SNPs, the two methods of localization appear equivalent.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Admixed individuals</head><p>For an ethnically admixed individual, we suggest estimating the fractional contribution f i of each pixel i to his/her genome. If we let x k denote the observed number of reference alleles at SNP k, then the loglikelihood of the person's observed genotypes amounts to</p><formula>LðfÞ= X k &amp; x k ln X i f i p ik +ð2 À x k Þ ln X i f i ð1 À p ik Þ !' subject to the constraints X i f i =1</formula><p>and f i ! 0 for all i. This formulation of the problem is reminiscent of the ethnic admixture problem if we identify pixels with ethnic groups and fix allele frequencies rather than estimate them (<ref type="bibr" target="#b0">Alexander and Lange, 2011;</ref><ref type="bibr" target="#b1">Alexander et al., 2009</ref>). Maximization of LðfÞ is a typical MM exercise. The key step is to separate parameters via the minorizations</p><formula>ln X i f i p ik ! ! X i f ni p ik X j f nj p jk ln X j f nj p jk f ni p ik f i p ik 0 B B @ 1 C C A ln X i f i 1 À p ik ð Þ " # ! X i f ni 1 À p ik ð Þ X j f nj 1 À p jk À ÁÂ ln X j f nj 1 À p jk À Á f ni 1 À p ik ð Þ f i 1 À p ik ð Þ 2 6 6 4 3 7 7 5</formula><p>based on Jensen's inequality applied to the concave function ln x. Equality holds when f=f n. If we define the constants</p><formula>c nik =x k f ni p ik X j f nj p jk +ð2 À x k Þ f ni ð1 À p ik Þ X j f nj ð1 À p jk Þ</formula><p>then standard arguments invoked in maximizing a multinomial likelihood yield the updates</p><formula>f n+1;i = X k c nik X k X j c njk</formula><p>One can accelerate convergence in estimating f and improve inference by imposing a penalty that drives to 0 those components f i with low explanatory power. As a lasso penalty Xand penalty to estimate haplotype frequencies. Rather than repeat the mathematical derivation of the same penalized MM algorithm here, we refer the reader to the reference (<ref type="bibr" target="#b2">Ayers and Lange, 2008</ref>) for details. Suffice it to say that with parameters separated, the MM updates require solving a simple quadratic equation for each component f i. Generic extrapolation techniques for MM and similar algorithms permit convergence acceleration beyond that afforded by our specific penalization (<ref type="bibr" target="#b22">Zhou et al., 2011</ref>). Because highly admixed individuals are nearly impossible to characterize fully, we choose = 1 16. Beyond this value no further penalty is exerted to eliminate pixels with little evidence of admixture. The total strength of the penalty is chosen to minimize the expected geodesic distance</p><formula>eðfÞ= X i X j f i ^ f j d ij</formula><p>between the true and estimated centers of a person's admixture distribution over many simulated admixed people. Here, d ij is the geodesic distance between the centers of pixels i and j. Although somewhat ad hoc, these choices of and perform well in practice.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">A LRT criterion for SNP selection</head><p>The utility of SNPs in identifying ancestral origins varies widely. The<ref type="bibr" target="#b16">Rosenberg et al. (2003)</ref>criterion for ranking SNPs implicitly assumes equal sample sizes at the different sampling sites. In practice this assumption is usually violated. As an alternative, we turned to a LRT statistic for testing homogeneity of allele frequencies across sites. The LRT statistic compares the best loglikelihood of the data under the null hypothesis of homogeneity to the best loglikelihood of the data under the alternative hypothesis of complete heterogeneity.<ref type="figure" target="#fig_5">Figure 1</ref>allows us to compare the value of the two different methods of ranking SNPs. The vertical axis of the figure represents the average distance under cross-validation between the true location of the POPRES individuals and their estimated locations under OriGen. The horizontal axis represents the number of SNPs used, with SNPs taken in their order of informativeness. Although the three curves document the value of ancestry informative SNPs in geographical projection, it is obvious that the LRT criterion performs better than the information criterion.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Allele frequency surfaces</head><p>Accurate allele frequency surfaces are the primary reason for OriGen's superior performance. OriGen surfaces are more adaptable and less rigidly parameterized.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Ancestral origin inference</head><p>Spatial assignment is the main application of OriGen. To showcase OriGen's accuracy, we computed average localization error by leave-one-out cross-validation.<ref type="figure">Figure 3</ref>displays the results for OriGen versus SPA. The lower curve for SPA emphasizes the benefits of exploiting LRT ordered SNPs. Examination of the figure shows that OriGen using 1% of the SNPs achieves better accuracy than SPA using all of the SNPs. Using 5% of the SNPs, OriGen is nearly perfect at the pixel level in its localizations. The same point can be made by comparing OriGen's results to the results in<ref type="figure" target="#tab_1">Table 1</ref>of the SPA paper (<ref type="bibr" target="#b21">Yang et al., 2012</ref>). Given the nature of the table, a fair comparison requires using OriGen to estimate the optimal ancestral origin of each person and then assigning the person to the closest sampling site as measured by geodesic distance. Overall, OriGen was more than twice as accurate as PCA and SPA based on just 1% of the data. With 5% of the data, OriGen maps individuals to sampled pixels with 99% accuracy. In<ref type="figure" target="#fig_8">Figure 4</ref>, we show the localization results of OriGen obtained from cross-validation using only 2% of the SNPs. With this small amount of data, it can already be seen that OriGen does well in placing individuals at their true origin. We also performed some small-scale comparisons with SCAT (<ref type="bibr" target="#b19">Wasser et al., 2004</ref>). SCAT is computationally demanding and so more ambitious comparisons were impossible to implement.</p><formula>● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ●</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Estimating proportions of admixed origins</head><p>Many individuals have mixed ancestry. PCA tends to localize individuals with parents of different ethnicities in between their parents' regions of origin. SPA has the capacity to localize each parent separately, but the user must inform the program beforehand how many different ancestries contribute to a given individual. Because this information is often unavailable, it would be preferable for admixture detection and origin selection to be more agnostic. OriGen can estimate admixture fractions on a pixel-by-pixel basis. For example, when applied to a person with a German parent and an Italian parent, ideally OriGen should deliver 50% German ancestry, 50% Italian ancestry and 0% other ancestry. This would make OriGen comparable with the program ADMIXTURE (<ref type="bibr" target="#b1">Alexander et al., 2009</ref>), with the benefit of using more accurate allele frequencies and covering small countries with no sampled people at all. In admixture mode, OriGen exploits the same allele frequency surfaces that it does in normal mode. However, instead of applying Bayes' rule to find the posterior probability of origin of each pixel, it estimates an admixture fraction for each pixel by penalized maximum likelihood estimation. OriGen is not only able to select the two contributing populations, it is also able to estimate their proportions well. As<ref type="figure">Figure 5</ref>illustrates, OriGen takes admixture estimation a step further by estimating the fractions at each pixel instead of each population. OriGen allows one to place individuals at locations with no sampled data. In the figure, the true locations of the individual's grandparents are highlighted, while OriGen's results are written as text atNote: Population of origin was predicted for each individual using leave-one-out cross-validation. Accuracy AE SD is the proportion of individuals from each population correctly assigned to their true population. The values listed for OriGen represent either 1% of the data (2 K SNPs) or 5% of the data (10 K SNPs). To make the values from OriGen comparable with PCA and SPA, the most likely location of each individual was estimated, and the population closest in distance to that point was chosen as the population of origin. The results for PCA and SPA are taken from<ref type="figure" target="#tab_1">Table 1</ref>of the paper (<ref type="bibr" target="#b21">Yang et al., 2012</ref>).OriGen vs. SPA<ref type="figure">Fig. 3</ref>. Average localization error for individuals based on leave-one-out cross-validation using OriGen (=0:1), SPA without SNP selection and SPA with SNP selection based on the LRT. For the unordered results, the default ordering based on chromosomal position is shown. Different subsets were tried with similar results their respective locations. The results presented in<ref type="figure">Figure 5</ref>for admixed individuals are typical of many reconstructions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">DISCUSSION</head><p>Motivated by advances in image reconstruction, we have presented a probability model for the estimation of complex allele frequency surfaces. Our model captures not only linear clines, but also multiple local peaks on a landscape. Allele frequency estimates represent a compromise between locally sampled genotypes and smoothness. The degree of smoothness is determined empirically by cross validation. Spatial assignment exploits the allele frequency surfaces of the most informative SNPs. To no one's surprise, the ancestry informative SNPs drive projection. In ranking SNPs our homogeneity LRT statistic outperforms the information criterion of<ref type="bibr" target="#b16">Rosenberg et al. (2003)</ref>, which assumes equal sample sizes at the sampled sites. In practice, the combination of a good model with just 1% of the available SNPs give better geographic localization on the POPRES data than competing models (PCA, SCAT and SPA) with all of the SNPs. Our computing times are vastly superior to SCAT and competitive with PCA and SPA. We have also proposed a model for spatial assignment of admixed individuals. Our model assigns an admixture coefficient to each pixel. To avoid over-parameterization, we impose a penalty that enforces parsimony and focuses attention on those pixels with the greatest explanatory power. Estimation of both allele frequency surfaces and admixture coefficients benefits from the MM principle. The MM algorithms generated are simple to code and automatically enjoy the ascent property. Convergence can be slow, but standard extrapolation techniques accelerate convergence dramatically. On the negative side of the balance sheet, our software OriGen requires more storage per SNP than SPA, which characterizes an allele frequency surface by just three parameters. The accuracy of OriGen is also limited by the number of pixels. For the POPRES dataset, we enclosed Europe in a square with 70 pixels on a side. Smaller pixels make little discernible difference in resolution at the expense of considerably more computation. The heatmaps of posterior probabilities and admixture coefficients afforded by the pixels are a decided plus. The ability to exclude infeasible pixels over oceans is another advantage.Note: SPA's localizations can fall outside the mapped region. The localization of OriGen and SCAT must fall within the mapped region. be taken as geographically localized. Finally, our SNP selection criterion is probably better suited to identifying ancestry informative SNPs than abstract information criterion. Readers will doubtless think of many other ways of improving the current model. For example, a reviewer suggested that it might be useful to incorporate standard errors of allele frequency estimates into localization heatmaps. Our preliminary testing of this plausible idea finds no improvement, probably because localization averages across so many SNPs. Science, like product design, is usually an iterative process of successive refinement.Admixed Surfaces Longitude Latitude<ref type="figure">Fig. 5</ref>. Admixture coefficients for four simulated Europeans with grandparents from locations highlighted in lighter colors. The numbers listed are the estimated admixture coefficients at their respective pixels based on 40 K SNPs; values51% are omitted. In the top left is a simulated individual with four grandparents coming from the UK. On his right is an individual with two grandparents from Germany and two from Poland. On the bottom left is an admixed individual with two grandparents from Portugal and one each from France and Poland. Finally, on the bottom right is an individual whose four grandparents come from Spain, France, UK and Poland</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>a positive threshold beyond which no further penalty is imposed. Because q(f) is non-differentiable, we minorize it by the linear function f on the domain ½0; Þ and by the constant on the domain ½; 1Þ. We previously used a variant of the current admixture model</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure2depicts</head><figDesc>the estimated allele frequency surfaces of the six most informative SNPs of the POPRES data. The figure also plots the maximum likelihood estimates for each sampled site as a filled-in circle at the appropriate location. For comparison, a figure in the Supplementary Material depicts the surfaces for the same SNPs generated by SPA. The figures demonstrate that OriGen surfaces match the sampled allele frequencies (represented by the shading of the circles at each sample location) better than the SPA surfaces. SPA appears to be too heavily influenced by outlier sites and less adaptable overall.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.2.Information</head><figDesc>Fig. 2. Allele frequency surfaces generated by OriGen with tuning parameter =0:1 for the six most informative SNPs. These surfaces are overlaid with filled-in circles to convey the MLE estimates for each sampled site. For the sake of comparison, the same SNP surfaces are depicted in the Supplementary Material for SPA</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.1.</head><figDesc>Fig. 1. Average distance between the geographic origin of the POPRES individuals and their OriGen estimated origins as a function of the number of SNPs used. The figure reflects leave-one-out cross-validation. The solid curve relies on the Rosenberg et al. (2003) information content, the dashed curve relies on no ordering and the dotted curve relies on the LRT criterion</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><figDesc>Modeling is an art. The best models combine realism with computational efficiency. The injection of ideas and techniques from image reconstruction is a major contribution of OriGen. Dividing regions into pixels and nearest neighbor interactions offer a logical framework for estimation. MM algorithms are also ubiquitous in imaging. Our admixture model is directly motivated by genetic considerations. It cleanly circumvents the need for specifying which ancestors of an admixed person should</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.4.</head><figDesc>Fig. 4. Localization results for individuals when leaving one individual out at a time. Individuals are labeled with a two-or three-letter abbreviation of their true population</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><figDesc>Funding: NIH grants from the National Human Genome Research Institute (HG006139. HG007089, T32 HG00035) and the National Institute of General Medical Sciences (GM053275). Conflict of interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>Table 2 records</figDesc><table>the average distance to the true origin and the 
run times for the 100 most informative SNPs. OriGen and SCAT 
place individuals almost 2000 km closer to their true origin than 
SPA. SPA is the fastest (1 min) of the three programs, followed 

closely by OriGen (2 min) and distantly by SCAT (362 minutes). 
Thus, the current version of OriGen delivers good placement 
with competitive execution times. The current formulation of 
SCAT is unable to handle large numbers of SNPs. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Comparison of localization by population</figDesc><table>Geographic origin 
Number of individuals 

Accuracy 

PCA 
SPA 

OriGen 

1% of data 
5% of data 

Italy 
219 
0.70 AE 0.03 
0.74 AE 0.03 
0.99 AE 0.01 
0.99 AE 0.01 
UK 
200 
0.44 AE 0.04 
0.53 AE 0.04 
1.00 AE 0.00 
1.00 AE 0.00 
Spain 
136 
0.71 AE 0.04 
0.69 AE 0.04 
0.98 AE 0.01 
0.99 AE 0.01 
Portugal 
128 
0.20 AE 0.04 
0.38 AE 0.04 
0.98 AE 0.01 
1.00 AE 0.00 
Switzerland-French 
125 
0.26 AE 0.04 
0.33 AE 0.04 
0.95 AE 0.02 
0.97 AE 0.02 
France 
89 
0.70 AE 0.05 
0.66 AE 0.05 
0.95 AE 0.02 
0.97 AE 0.02 
Switzerland-German 
84 
0.23 AE 0.05 
0.27 AE 0.05 
1.00 AE 0.00 
0.99 AE 0.01 
Germany 
71 
0.25 AE 0.05 
0.28 AE 0.05 
1.00 AE 0.00 
1.00 AE 0.00 
Ireland 
61 
0.28 AE 0.06 
0.28 AE 0.06 
0.92 AE 0.03 
1.00 AE 0.00 
Yugoslavia 
44 
0.25 AE 0.07 
0.30 AE 0.07 
1.00 AE 0.00 
1.00 AE 0.00 
Mean 
115.7 
0.40 AE 0.05 
0.45 AE 0.05 
0.98 AE 0.01 
0.99 AE 0.01 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 2.</figDesc><table>Accuracy of origin localization and run times for OriGen, 
SCAT and SPA for 100 SNPs 

Method 
Placement (km) 
Time (min) 

OriGen 
981 
2 
SCAT 
1074 
362 
SPA 
2920 
1 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">J.M.Ra ~ nola et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Fast spatial ancestry at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Enhancements to the admixture algorithm for individual ancestry estimation</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">H</forename>
				<surname>Alexander</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">246</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Fast model-based estimation of ancestry in unrelated individuals</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">H</forename>
				<surname>Alexander</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1655" to="1664" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Penalized estimation of haplotype frequencies</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">L</forename>
				<surname>Ayers</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="1596" to="1602" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Image Processing and Analysis: Variational, PDE, Wavelet, and Stochastic Methods</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Chan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Shen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Society for Industrial and Applied Mathematics</title>
		<imprint>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The wave of advance of advantageous genes</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Fisher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Eugen</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="353" to="369" />
			<date type="published" when="1937" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">The Genetical Theory of Natural Selection</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Fisher</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<publisher>Oxford University Press</publisher>
			<pubPlace>Oxford</pubPlace>
		</imprint>
	</monogr>
	<note>1st. edn</note>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Statistical methods in spatial genetics</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Guillot</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Ecol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="4734" to="4756" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">A tutorial on mm algorithms</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">R</forename>
				<surname>Hunter</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. Stat</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="30" to="37" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">The stepping stone model of population structure and the decrease of genetic correlation with distance</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Kimura</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Weiss</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="561" to="577" />
			<date type="published" when="1964" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">A study of the equation of diffusion with increase in the quantity of matter, and its application to a biological problem</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Kolmogorov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Byul. Moskovskogo Gos. Univ</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="1" to="25" />
			<date type="published" when="1937" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Convergence of EM image reconstruction algorithms with Gibbs smoothing</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Med. Imaging</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="439" to="446" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Numerical Analysis for Statisticians</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics and Computing</title>
		<imprint>
			<publisher>Springer Limited</publisher>
			<date type="published" when="2012" />
			<publisher>Springer Limited</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Optimization transfer using surrogate objective functions</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lange</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Graph. Stat</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="1" to="20" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Correlation between genetic and geographic structure in Europe</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Lao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cur. Biol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1241" to="1248" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">The Population Reference Sample, POPRES: a resource for population, disease, and pharmacological genetics research</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">R</forename>
				<surname>Nelson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="page" from="347" to="358" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Genes mirror geography within Europe</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Novembre</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">456</biblScope>
			<biblScope unit="page" from="98" to="101" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Informativeness of genetic markers for inference of ancestry</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">A</forename>
				<surname>Rosenberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">73</biblScope>
			<biblScope unit="page" from="1402" to="1422" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Spatial autocorrelation in biology: 2. Some biological implications and 4 applications of evolutionary and ecological interest</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Sokal</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Oden</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biol. J. Linn. Soc</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="229" to="249" />
			<date type="published" when="1978" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">A computer movie simulating urban growth in the Detroit region</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">R</forename>
				<surname>Tobler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econ. Geogr</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="234" to="240" />
			<date type="published" when="1970" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Assigning African elephant DNA to geographic region of origin: applications to the ivory trade</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Wasser</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="page" from="14847" to="14852" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">The coalescent in a continuous, finite, linear population</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">F</forename>
				<surname>Wilkins</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Wakeley</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">161</biblScope>
			<biblScope unit="page" from="873" to="888" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">A model-based approach for analysis of spatial structure in genetic data</title>
		<author>
			<persName>
				<forename type="first">W.-Y</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="725" to="731" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">A quasi-Newton acceleration for high-dimensional optimization algorithms</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Zhou</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Comput</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="261" to="273" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>