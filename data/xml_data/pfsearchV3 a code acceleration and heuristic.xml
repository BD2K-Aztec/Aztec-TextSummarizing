
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:43+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis pfsearchV3: a code acceleration and heuristic to search PROSITE profiles</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Thierry</forename>
								<surname>Schuepbach</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Vital-IT Group</orgName>
								<orgName type="institution">SIB Swiss Institute of Bioinformatics</orgName>
								<address>
									<settlement>Genopode</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">UNIL-Sorge</orgName>
								<address>
									<postCode>1015</postCode>
									<settlement>Lausanne</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Marco</forename>
								<surname>Pagni</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Vital-IT Group</orgName>
								<orgName type="institution">SIB Swiss Institute of Bioinformatics</orgName>
								<address>
									<settlement>Genopode</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">UNIL-Sorge</orgName>
								<address>
									<postCode>1015</postCode>
									<settlement>Lausanne</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alan</forename>
								<surname>Bridge</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Swiss-Prot Group</orgName>
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">CMU</orgName>
								<address>
									<addrLine>1 rue Michel-Servet</addrLine>
									<postCode>CH-1211</postCode>
									<settlement>Geneva 4</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Lydie</forename>
								<surname>Bougueleret</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Swiss-Prot Group</orgName>
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">CMU</orgName>
								<address>
									<addrLine>1 rue Michel-Servet</addrLine>
									<postCode>CH-1211</postCode>
									<settlement>Geneva 4</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ioannis</forename>
								<surname>Xenarios</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Vital-IT Group</orgName>
								<orgName type="institution">SIB Swiss Institute of Bioinformatics</orgName>
								<address>
									<settlement>Genopode</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">UNIL-Sorge</orgName>
								<address>
									<postCode>1015</postCode>
									<settlement>Lausanne</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Swiss-Prot Group</orgName>
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">CMU</orgName>
								<address>
									<addrLine>1 rue Michel-Servet</addrLine>
									<postCode>CH-1211</postCode>
									<settlement>Geneva 4</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Lorenzo</forename>
								<surname>Cerutti</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Swiss-Prot Group</orgName>
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">CMU</orgName>
								<address>
									<addrLine>1 rue Michel-Servet</addrLine>
									<postCode>CH-1211</postCode>
									<settlement>Geneva 4</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alfonso</forename>
								<surname>Valencia</surname>
							</persName>
						</author>
						<title level="a" type="main">Sequence analysis pfsearchV3: a code acceleration and heuristic to search PROSITE profiles</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="issue">9</biblScope>
							<biblScope unit="page" from="1215" to="1217"/>
							<date type="published" when="2013">2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt129</idno>
					<note type="submission">Received on January 14, 2013; revised on February 21, 2013; accepted on March 1, 2013</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>Contact: pftools@isb-sibch</keywords>
			</textClass>
			<abstract>
				<p>The PROSITE resource provides a rich and well annotated source of signatures in the form of generalized profiles that allow protein domain detection and functional annotation. One of the major limiting factors in the application of PROSITE in genome and meta-genome annotation pipelines is the time required to search protein sequence databases for putative matches. We describe an improved and optimized implementation of the PROSITE search tool pfsearch that, combined with a newly developed heuristic, addresses this limitation. On a modern x86_64 hyper-threaded quad-core desktop computer , the new pfsearchV3 is two orders of magnitude faster than the original algorithm. Availability and implementation: Source code and binaries of pfsearchV3 are freely available for download at http://web.expasy. org/pftools/#pfsearchV3, implemented in C and supported on Linux. PROSITE generalized profiles including the heuristic cutoff scores are available at the same address.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Falling costs and continuing technological developments have led to a dramatic increase in the rate of sequencing of individual species genomes (<ref type="bibr" target="#b2">Lindblad-Toh et al., 2011</ref>) and the diversity of the ecological niches sampled by metagenomic sequencing (<ref type="bibr" target="#b7">Teeling and Glo¨cknerGlo¨ckner, 2012</ref>). The identification, classification and functional annotation of the putative protein sequences encoded by these samples is essential to understand the diversity of the underlying biological systems, and will ultimately allow the construction of biological models that simulate and make testable predictions about their behaviour (<ref type="bibr" target="#b1">Faust and Raes, 2012</ref>). Most functional annotation is predicted using sequence homology-based methods that infer the function of uncharacterized protein sequences based on their similarity to characterized templates. These methods include generalized profiles and Hidden Markov Models (HMMs), which can detect more subtle homologies than pairwise sequence alignments (<ref type="bibr" target="#b3">Park et al., 1998</ref>). The application of these computationally expensive methods on large datasets has been made feasible by the development of heuristics for sequence database search and faster more efficient code (e.g.<ref type="bibr" target="#b0">Eddy, 2011</ref>). Our PROSITE method combines manually constructed generalized profiles for efficient domain detection with rules for precise functional annotation (<ref type="bibr" target="#b6">Sigrist et al., 2013</ref>). Here, we describe a new heuristic method and code optimization and parallelization for the PROSITE profile-sequence database search tool pfsearch. These developments increase the speed of pfsearch by two orders of magnitude using a modern x86_64 hyperthreaded quad-core computer (see<ref type="figure" target="#tab_1">Table 1</ref>legend for specifications of the computer used in our tests), making the annotation of large sequence datasets using PROSITE feasible.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RESULTS AND DISCUSSION</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Heuristics for generalized profiles</head><p>A major reduction in the execution time of sequence database searches can be achieved by an heuristic filter that selects sequences for the next CPU-expensive alignment step of the core algorithm. One such heuristic is the MSV algorithm of HMMER3, which computes the sum of multiple optimal ungapped local alignment segments (<ref type="bibr" target="#b0">Eddy, 2011</ref>). Although extremely fast and convenient, the MSV heuristic filter cannot be directly transposed to generalized profiles that have a different model topology and are not bound to the probabilistic model restrictions of HMMs. We therefore developed a variant that is directly applicable to generalized profiles. Our pfsearch heuristic, named prfh, sums the maximal matching diagonals between the profile and the sequence, ignoring both gaps and the order of the matching diagonals. First, for each position i of the profile and j of the sequence, we define a score Sði, jÞ:</p><p>Sði, jÞ ¼ max Sði À 1, j À 1Þ þ Mði, a j Þ 0 ð1Þ where Mði, a j Þ is the match score read at position i of the profile matrix table for residue a j observed at position j of the sequence. Boundary scores Sði, 0Þ and Sð0, jÞ are set to 0. Second, only the maximal scoring diagonal Sði, jÞ is kept for every position j of the sequence [the maximization part of<ref type="bibr">Equation (2)]</ref>. All maxima are then summed to form the final heuristic score (H score ).The H score distribution measured using PROSITE profiles on UniProtKB linearly correlates with the raw score distribution obtained using the standard pfsearch (R 2 % 0:9 on average). To determine the appropriate H score cut-offs with respect to the normalized score cut-offs of each calibrated profile (<ref type="bibr" target="#b5">Sigrist et al., 2002</ref>), we apply the following procedure. We randomly sample 200 sequences belonging to the original seed alignment for each profile (re-sampling if their number is 5200), and generate a set of artificially mutated sequences from these, including indels, at various PAM distances. These artificial sequences (sharing from 40–85% sequence identity with their source) are then scored with both the standard profile scoring method and the heuristic (<ref type="figure" target="#fig_1">Fig. 1</ref>). We calculate the regression line on the lower 5% quantile of the heuristic score distribution using the quanteg R package (http://cran.r-project.org/web/packages/ quantreg/), and use it to obtain the heuristic cut-offs corresponding to the standard profile cut-offs (<ref type="figure" target="#fig_1">Fig. 1</ref>). The regression on a low quantile ensures a minimal loss of true-positive sequences. This method to fix the H score cut-offs was automatically applied on the PROSITE profiles. Manual inspection showed that this method was appropriate for the majority of the profiles, although in some cases, the H score cut-off could be manually increased to further accelerate the search. A minority of very short or 'exotic' profiles cannot be used with the heuristic. For these, no H score cut-off is defined in the profile, and the pfsearch software skips the heuristic search step. The heuristic reduces the mean search database size by 96.7% (median 99.1%). The recovery of true positives is !98% for 499% of the PROSITE profiles with an associated H score cut-off (the lowest measured recovery is 92.6%). The majority of the missing true positives correspond to fragmentary sequences in UniProtKB.</p><formula>H score ¼ X j ðmax i</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Software optimization and performance of the new pfsearch</head><p>Pfsearch has been rewritten and optimized in C from the original Fortran. The code will run on any x86_64 POSIX compliant architecture and benefits from the SSE 4.1 instruction set when available. However with the current source code, only Linux operating systems may benefit from CPU core affinity and file to memory mapping optimization, detected at compile time. The optimization process entirely reformatted the memory structure to allow vectorization. High level assembly code (intrinsic functions) was used to enforce the SSE2 and SSE4.1 instruction sets, leading to a 2-fold acceleration of the original Fortran (<ref type="figure" target="#tab_1">Table 1</ref>). SSE4.1 is particularly effective in reducing the execution time of the core pfsearch algorithm, while both SSE4.1 and SSE2 show similar performance on the heuristic filter (<ref type="figure" target="#tab_1">Table 1</ref>). This acceleration scales up with multithreading: on a dual hyper-threaded quad-core machine, we measured an average 10-fold improvement. The scaling is clearly related to the number of physical cores, with hyper-threading having only a minimal effect on performance (<ref type="figure" target="#tab_1">Table 1</ref>).) simulated sequences derived from the seed alignment mutated at various PAM distances (see text for explanatory notes). The heuristic search scores and profile search scores of the simulated sequences (open circle) exhibit a strong positive correlation (R 2 ¼ 0.9). These scores are used to estimate the linear regression for the lower 5% quantile (black line) used to map the profile search scores to heuristic search scores. The standard linear regression is also plotted (dashed line)The pfsearch and pfsearchV3 programs have been compiled on a Gentoo Linux (-mtune ¼ corei7-march ¼ corei7-fomit-frame-pointer-O2) with gcc (4.6.3) and glibc (2.15) using the following compilation options:-O3 –enable-mmap –enablethread-affinity, CFLAGS ¼ '-mtune ¼ corei7-march ¼ corei7-ffast-math-mfpmath ¼ sse', FFLAGS ¼ '-mtune ¼ corei7-march ¼ corei7-ffast-math-mfpmath ¼ sse'. The static executable is available at the provided WEB address. All run times have been measured on a quad-core Intel Õ Core TM i7-3770 CPU @ 3.40 GHz with 8 Gb RAM running on Linux 3.2.0-4-amd64. The number of cores, the selection of the SSE and the selection or otherwise of the heuristic where specified at runtime with options-t,-s and-C, respectively, of pfsearchV3. Both pfsearch and pfsearchV3 have been run to produce the same output alignment, options-fxzl and Ào 2 respectively. (*) physical cores obtained with option-k and-t of pfsearchV3. (þ) the default mode of pfsearchV3, which uses all available cores with hyper-threading for a total of eight cores in our testing machine (no options-t and-k are used). NB: pfsearchV3 was run using an indexed sequence database (option-i); selecting this option reduces the execution time by 7 s in all experiments using the specified set of protein sequences. Multithreading implementation is straightforward because profile alignment versus a database is in itself an embarrassingly parallel task. For pfsearchV3, we implemented a master–slave mechanism to analyse and adapt the load before each phase of the algorithm (heuristic, filter, alignment), thus providing more equitable shares between threads. This has some constraints: sequences are read several times, but above all, they are no longer accessed sequentially, so an index of the sequences has to be either computed or loaded at start. By combining the heuristic with our code optimization, we achieved a 100Â increase in the speed of pfsearch on average. To search 16 544 936 UniProtKB sequences (5 358 014 649 residues) required a mean of 98 s/profile (median of 73 s/profile). A typical example of the runtime acceleration achieved is shown in<ref type="figure" target="#tab_1">Table 1</ref>. The heuristic version of pfsearch can be used to annotate large sets of complete sequences in a reasonable amount of time on a modern workstation. For example, the human proteome can be searched with the totality of the PROSITE profile models in 54 hours, and this time can be drastically reduced on machines with a large number of CPU cores and/or computer clusters. For fragmented sequences, users may inactivate the heuristic to minimize loss of true-positive matches, in which case the speed of execution will be determined by the number of available CPU cores. We also plan to implement our heuristic search method in the HAMAP pipeline that provides high quality functional annotation for protein families (<ref type="bibr" target="#b4">Pedruzzi et al., 2013</ref>).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Estimation of the heuristic score cut-off for the PROSITE profile PS50255 (CYTOCHROME_B5_2). The profile scores and heuristic scores are plotted for the matched sequence: (closed circle) sequences from the seed alignment; (multi symbol) shuffled UniProtKB/SwissProt sequences; (open circle) simulated sequences derived from the seed alignment mutated at various PAM distances (see text for explanatory notes). The heuristic search scores and profile search scores of the simulated sequences (open circle) exhibit a strong positive correlation (R 2 ¼ 0.9). These scores are used to estimate the linear regression for the lower 5% quantile (black line) used to map the profile search scores to heuristic search scores. The standard linear regression is also plotted (dashed line)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 1.</figDesc><table>Execution times to search the PROSITE profile PS50255 
(CYTOCHROME_B5_2) against 16 544 936 UniProtKB sequences 
(5 358 014 649 residues) 

Àheuristic 
þheuristic 

SSE2 
SSE4.1 
SSE2 
SSE4.1 

pfsearch (v2.4) 
51m32s 
n.a. 
n.a. 
n.a. 
pfsearchV3 (1 core*) 
33m02s 
20m17s 
1m55s 
1m44s 
pfsearchV3 (2 cores*) 
16m54s 
10m23s 
0m58s 
0m53s 
pfsearchV3 (4 cores*) 
9m14s 
5m40s 
0m31s 
0m28s 
pfsearchV3 (8 cores þ ) 
9m04s 
5m28s 
0m28s 
0m27s 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">T.Schuepbach et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Accelerated profile HMM searches</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Eddy</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">1002195</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Microbial interactions: from networks to models</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Faust</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Raes</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Microbiol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="538" to="550" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">A high-resolution map of human evolutionary constraint using 29 mammals</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lindblad-Toh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">478</biblScope>
			<biblScope unit="page" from="476" to="482" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Sequence comparisons using multiple sequences detect three times as many remote homologues as pairwise methods</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Park</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">284</biblScope>
			<biblScope unit="page" from="1201" to="1210" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">HAMAP in 2013, new developments in the protein family classification and annotation system</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Pedruzzi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="584" to="589" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">PROSITE: a documented database using patterns and profiles as motif descriptors</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">J</forename>
				<surname>Sigrist</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brief Bioinform</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="265" to="274" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">New and continuing developments at PROSITE</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">J</forename>
				<surname>Sigrist</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="344" to="347" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Current opportunities and challenges in microbial metagenome analysis–a bioinformatic perspective</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Teeling</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">O</forename>
				<surname>Glo¨cknerglo¨ckner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brief Bioinform</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="728" to="742" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">pfsearch next generation</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>