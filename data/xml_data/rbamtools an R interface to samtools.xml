
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis rbamtools: an R interface to samtools enabling fast accumulative tabulation of splicing events over multiple RNA-seq samples</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Wolfgang</forename>
								<surname>Kaisers</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Bioinformatics and Biostatistics</orgName>
								<orgName type="institution" key="instit1">BMFZ</orgName>
								<orgName type="institution" key="instit2">Heinrich Heine University Dü sseldorf</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Heiner</forename>
								<surname>Schaal</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Bioinformatics and Biostatistics</orgName>
								<orgName type="institution" key="instit1">BMFZ</orgName>
								<orgName type="institution" key="instit2">Heinrich Heine University Dü sseldorf</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institut fü r Virologie</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Holger</forename>
								<surname>Schwender</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Bioinformatics and Biostatistics</orgName>
								<orgName type="institution" key="instit1">BMFZ</orgName>
								<orgName type="institution" key="instit2">Heinrich Heine University Dü sseldorf</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Mathematical Institute</orgName>
								<orgName type="institution">Heinrich Heine University Dü sseldorf</orgName>
								<address>
									<addrLine>40225 Dü sseldorf</addrLine>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis rbamtools: an R interface to samtools enabling fast accumulative tabulation of splicing events over multiple RNA-seq samples</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu846</idno>
					<note type="submission">Received on July 31, 2014; revised on December 18, 2014; accepted on December 19, 2014</note>
					<note>*To whom correspondence should be addressed. † The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. Associate Editor: John Hancock Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>The open source environment R isf the most widely used software to statistically explore biological data sets including sequence alignments. BAM is the de facto standard file format for sequence alignment. With rbamtools, we provide now a full spectrum of accessibility to BAM for R users such as reading, writing, extraction of subsets and plotting of alignment depth where the script syntax closely follows the SAM/BAM format. Additionally, rbamtools enables fast accumulative tabulation of splicing events over multiple BAM files. Availability and implementation: rbamtools is available on CRAN and on R-Forge.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The samtools format specifies various data slots for sequence alignments many of which are difficult to understand when sequencing experiments are to be analyzed. For analysis of sequencing data, detailed access to contents of BAM files is needed, especially when technical problems arise. rbamtools allows R users to investigate alignment results by reading the header section or retrieve and view alignments from regions of interest using basic R structures. rbamtools provides functions for creation and modification of BAM file header or alignment section contents. rbamtools also facilitates writing of BAM files which is not possible in Bioconductor (<ref type="bibr" target="#b1">Gentleman et al., 2004;</ref><ref type="bibr" target="#b4">Morgan et al., 2010</ref>). Additionally rbamtools contains a framework for sequential and fast extraction of alignment gap positions (see<ref type="figure" target="#tab_1">Table 1</ref>) on RNA-seq data which are candidate sites for true splicing events. rbamtools is part of an analysis pipeline for analysis of splicing events in RNAseq data which consists of three R packages: rbamtools and refGenome (<ref type="bibr" target="#b2">Kaisers, 2013a</ref>) and spliceSites (Kaisers, 2013b). The identification of splicing inaccuracies is a non trivial task on BAM files, since the positions of alignment gaps must be accounted on billions of reads. With rbamtools, processing data from, e.g. 60 RNA-seq samples (containing 8:37 Â 10 9 alignments) can be done in 1.75 h on a standard workstation with minimal working memory demand. Current versions of the samtools C library contain misalignment (bus) errors (http://en.wikipedia.org/wiki/Bus_error), which may cause program crashes on some architectures (e.g. SPARC). In rbamtools, these misalignment errors are corrected (see Supplementary Material).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Approach</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Implementation</head><p>The package consists of three layers: the samtools C library, C based containers for alignments and alignment gaps as well as an S4 class library in R providing the user interface. The samtools C library is a static copy of samtools (v1.4-r985). In order to meet CRAN policies, numerous changes had to be introduced into the source code (B.Ripley and K.Hornik, personal communication).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">User interface</head><p>The S4 class library closely reflects the internal structures of BAM files. In order to provide detailed access to BAM file content, the API provides 14 classes and numerous functions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Basic accessors</head><p>Basic accessors provide access to all parts of raw file content, header section and alignments for reading and writing. The following example opens the BAM file bam and copies alignments on chromosome 1 into a second BAM file. rd &lt;-bamReader(bam, idx ¼ TRUE) rg &lt;-bamRange(rd, getRefCoords(rd, " chr1 " )) wr &lt;-bamWriter(getHeader(rd, " chr1.bam " ) bamSave(wr, rg, refid ¼ 0)</p><p>Inspecting ranges can be useful when downstream analysis indicates regions without any alignments or other technical flaws.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Specialized analysis routines</head><p>Specialized analysis routines for visualization of phred score distribution as well as for tabulation of nucleotide content and calculation of GC content and AT/GC ratio are provided.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Alignment depth</head><p>This information can be retrieved from a bamRange object.<ref type="figure" target="#fig_1">Figure 1</ref>shows an example where alignment depth is plotted for Gene CHMP2A (ENSG00000130724).</p><formula>ad &lt;-alignDepth(range) plotAlignDepth(ad)</formula><p>Gap sites Gap sites are kept in containers of class bamGapSite. The data is gathered from BAM files using the bamGapList function which directly operates on bamReader objects as shown below. bgl1 &lt;-bamGapList(bamReader(bam1, idx ¼ TRUE) bgl2 &lt;-bamGapList(bamReader(bam2, idx ¼ TRUE) bgl &lt;-merge(bgl1, bgl2)</p><p>Gap site positions and numbers of crossing read alignments can be obtained from multiple BAM files as data.frame by executing:</p><formula>gap &lt;-readPooledBamGapDf(fileNames)</formula><p>The algorithm processes 1 196 1496 536 alignments per second or 4.3 billion alignments per hour. The data inside bamGapSites objects can directly extracted into a data.frame. For each gap site, alignment (read) counts are provided which can be used for differential expression analysis and for differential splicing analysis. Gene annotation can be added by using a specialized annotation procedure for gap sites provided by the CRAN refGenome package. Further information on gap sites for example identification of non canonical splice sites, MaxEnt (<ref type="bibr" target="#b6">Yeo and Burge, 2004</ref>) and HBond (<ref type="bibr" target="#b0">Freund et al., 2003</ref>) scores as well as information on alternative splicing events can be obtained using the Bioconductor spliceSites package. Application of these rbamtools functions to data from an RNAseq experiment on 60 human fibroblast samples resulted in 115 968 gap sites which are present in all samples. Thereof, 98.1 % exactly lie on annotated (Ensembl Release 74) splice sites while 1.98 % (2210 gap sites) are located on not yet annotated positions.A gap site defined by three alignments which share the same alignment gap site. The position values are 0-based (as described in the SAM file format a ). The last row represents the (chromosomal) reference sequence.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Alignment</head><figDesc>depth for gene CHMP2A Refname: 19 Alignment depth 59062000 59063000 59064000 59065000 59066000 59067000 Position Chromosome 19 Gene ENSG00000130724 Transcript ENST00000601220</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Number of alignments per genomic position for gene CHMP2A</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1663 Bioinformatics, 31(10), 2015, 1663–1664 doi: 10.1093/bioinformatics/btu846 Advance Access Publication Date: 5 January 2015 Applications Note</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Example for a gap site</figDesc><table>Exon 
Intron 
Exon 
Position 
CIGAR 

AG 
CCTTGATG 
3 
2M6N8M 
CAG 
CCTTGAT 
2 
3M6N7M 
CCAG 
CCT 
1 
4M6N3M 
CCCAG GTCCAG CCTTGATGTCC 
(reference) 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">W.Kaisers et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank the R Core Team (R Core<ref type="bibr" target="#b5">Team, 2014</ref>), and in particular Profs. Brian Ripley and Kurt Hornik, very much for their fruitful comments and for their valuable help in improving rbamtools.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>RNA-seq datasets were obtained from RNA deep sequencing projects which were partly funded by the German Ministry of Research and Education (Network Gerontosys), DFG<ref type="bibr">[SCHA 909/3-1]</ref>, the Heinz Ansmann Foundation for AIDS Research, Dü sseldorf, Germany (He.S), and the Jü rgen Manchot Stiftung (H.S.). The financial support of the Deutsche Forschungsgemeinschaft<ref type="bibr">[</ref></p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A novel approach to describe a u1 snrna binding site</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Freund</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="6963" to="6975" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Bioconductor: Open software development for computational biology and bioinformatics</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">C</forename>
				<surname>Gentleman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">80</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<monogr>
		<title level="m" type="main">refGenome: Gene and Splice Site Annotation Using Annotation Data From Ensembl and UCSC Genome Browsers</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Kaisers</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">spliceSites: A Bioconductor Package for Exploration of Alignment Gap Positions from RNA-Seq Data</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Kaisers</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>Bioconductor. R package version 1.3.3</note>
</biblStruct>

<biblStruct   xml:id="b4">
	<monogr>
		<title level="m" type="main">Rsamtools: Binary alignment (BAM), variant call (BCF), or tabix file import</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Morgan</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>R. package version 1.16.1</note>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R Core</forename>
				<surname>Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Maximum entropy modeling of short sequence motifs with applications to rna splicing signals</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Yeo</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Burge</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="377" to="394" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>