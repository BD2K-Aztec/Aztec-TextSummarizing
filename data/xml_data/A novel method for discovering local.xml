
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:47+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A novel method for discovering local spatial clusters of genomic regions with functional relationships from DNA contact maps</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Xihao</forename>
								<surname>Hu</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Institute of Biophysics</orgName>
								<orgName type="laboratory">Present address: Key Laboratory of RNA Biology</orgName>
								<orgName type="institution">Chinese Academy of Sciences</orgName>
								<address>
									<postCode>100101</postCode>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Christina</forename>
								<forename type="middle">Huan</forename>
								<surname>Shi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kevin</forename>
								<forename type="middle">Y</forename>
								<surname>Yip</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Hong Kong Bioinformatics Centre</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution">CUHK-BGI Innovation Institute of Trans-omics</orgName>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution" key="instit1">Hong Kong Institute of Diabetes and Obesity</orgName>
								<orgName type="institution" key="instit2">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Shatin, New Territories, Hong Kong</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A novel method for discovering local spatial clusters of genomic regions with functional relationships from DNA contact maps</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw256</idno>
					<note>*To whom correspondence should be addressed. Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: The three-dimensional structure of genomes makes it possible for genomic regions not adjacent in the primary sequence to be spatially proximal. These DNA contacts have been found to be related to various molecular activities. Previous methods for analyzing DNA contact maps obtained from Hi-C experiments have largely focused on studying individual interactions, forming spatial clusters composed of contiguous blocks of genomic locations, or classifying these clusters into general categories based on some global properties of the contact maps. Results: Here, we describe a novel computational method that can flexibly identify small clusters of spatially proximal genomic regions based on their local contact patterns. Using simulated data that highly resemble Hi-C data obtained from real genome structures, we demonstrate that our method identifies spatial clusters that are more compact than methods previously used for clustering genomic regions based on DNA contact maps. The clusters identified by our method enable us to confirm functionally related genomic regions previously reported to be spatially proximal in different species. We further show that each genomic region can be assigned a numeric affinity value that indicates its degree of participation in each local cluster, and these affinity values correlate quantitatively with DNase I hypersensitivity, gene expression, super enhancer activities and repli-cation timing in a cell type specific manner. We also show that these cluster affinity values can precisely define boundaries of reported topologically associating domains, and further define local sub-domains within each domain. Availability and implementation: The source code of BNMF and tutorials on how to use the software to extract local clusters from contact maps are available at http://yiplab.cse.cuhk.edu.hk/bnmf/.Contact:
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Although genomes are commonly depicted as a linear sequence of base pairs, they actually contain complex three-dimensional (3D) structures. There has long been an interest in identifying biologically meaningful territories from these structures (<ref type="bibr" target="#b5">Cremer and Cremer, 2010</ref>). Fluorescence in situ hybridization (FISH) has provided insights into genome organization by visualizing individual pairs of spatially interacting genomic regions (<ref type="bibr" target="#b4">Cremer and Cremer, 2001</ref>), but it has limited resolution and cannot be scaled up to study a large number of interacting regions at the same time. These limitations have been overcome by high-throughput experimental methods that can probe interacting regions genome-wide by means of crosslinking and deep sequencing, such as ChIA-PET, Hi-C and TCC (<ref type="bibr" target="#b10">Fullwood et al., 2009;</ref><ref type="bibr" target="#b16">Kalhor et al., 2012;</ref><ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>). Each sequencing read produced provides information about two interacting regions. The whole set of reads is summarized by a contact map in the form of a square matrix, where the whole genome is binned into contiguous genomic locations with each bin V C The Author 2016. Published by Oxford University Press.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i111</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com<ref type="bibr">Bioinformatics, 32, 2016</ref>, i111â€“i120 doi: 10.1093/bioinformatics/btw256 ISMB 2016 corresponding to a row and a column of the matrix, and each matrix element represents the number of supporting reads linking up regions from the two respective bins, which we refer to as the 'contact counts' (Supplementary<ref type="figure" target="#fig_2">Fig. S1</ref>). Two bins that are closer to each other in the 3D genome structures in a cell population receive a larger contact count in general, subject to various types of bias to be discussed below. The appropriate size of each bin depends on the amount of data produced. If a small bin size is used but there are not enough sequencing reads, many values in the matrix would be small or even zero, and would thus be heavily affected by background noise and random sampling effects. Therefore, in order to produce contact maps at high resolution, the amount of data produced in each experiment has been increasing rapidly (<ref type="bibr" target="#b0">Ay et al., 2014;</ref><ref type="bibr" target="#b8">Dixon et al., 2012;</ref><ref type="bibr" target="#b15">Jin et al., 2013;</ref><ref type="bibr" target="#b16">Kalhor et al., 2012;</ref><ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>). A recent in situ Hi-C dataset contains billions of pairwise interactions obtained from a human cell line, which allows for a high resolution of 1 kb bin size while the average contact count is still sufficiently large for proper analyses (<ref type="bibr" target="#b26">Rao et al., 2014</ref>). These massive datasets have created computational challenges in extracting useful information about the underlying 3D genome structures. Various methods have been applied to analyze DNA contact maps with different goals. Statistical methods have been used to test whether a set of genomic locations of interest are co-localized in the 3D genome structure (<ref type="bibr" target="#b9">Duan et al., 2010</ref>). Their reliability depend on the normalization procedure (<ref type="bibr" target="#b3">Cournac et al., 2012</ref>) and the suitability of the null model (<ref type="bibr" target="#b25">Paulsen et al., 2013</ref>). Conversely, methods have been proposed for discovering groups of interacting genomic regions without a predefined set of candidates. One way is to create a global model for the whole 3D genome structure using the contact map to define model constraints. Existing methods differ from each other by their assumptions about global genome structures, their optimization procedures, and whether a single structure or a population of structures is used to explain the observed contact map (<ref type="bibr" target="#b9">Duan et al., 2010;</ref><ref type="bibr" target="#b16">Kalhor et al., 2012;</ref><ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009;</ref><ref type="bibr" target="#b23">Nagano et al., 2013;</ref><ref type="bibr" target="#b28">Sexton et al., 2012</ref>). Another way to identify groups of interacting regions is to cluster genomic regions according to their contact counts with other regions. One previous study used principle component analysis (PCA) to identify a low-dimensional representation of the contact map based on which genomic regions were clustered. The clustering results revealed general open and close compartments of the genome at 1 Mb resolution (<ref type="bibr">LiebermanAiden et al., 2009</ref>). More refined topologically associating domains (TADs) (<ref type="bibr" target="#b8">Dixon et al., 2012;</ref><ref type="bibr" target="#b24">Nora et al., 2012</ref>) at 100 kb resolution were later identified by using hidden Markov models. Recently, chromatin loops at even higher resolutions were identified using dynamic programming. Clustering of the inter-chromosomal interactions revealed six general groups using a Gaussian hidden Markov model clustering algorithm (<ref type="bibr" target="#b26">Rao et al., 2014</ref>). In general, the accuracy of these methods depends on how the contact map is processed to remove biases. Some genomic regions tend to have more contact counts than others, caused by factors such as GC content and uniqueness of sequence (<ref type="bibr" target="#b32">Yaffe and Tanay, 2011</ref>). These factors lead to a non-uniform distribution of contact read counts, which could confuse the analysis and should be properly corrected. In an early correction method, the observed contact counts are normalized by the expected counts based on a background model (<ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>). An iterative correction approach was later proposed to enforce equal sums for all rows in the contact map after normalization, assuming that after removing the biases, every bin should have approximately the same number of interactions with other bins. This normalization method was proved to be more effective and have a better convergence property (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>). Using the same framework, another effective normalization method adopts a new updating rule by dividing row sums with their Euclidean norms (<ref type="bibr" target="#b3">Cournac et al., 2012</ref>). Yaffe and Tanay's work followed a different direction by explicitly modeling three types of biases observed in Hi-C data (<ref type="bibr" target="#b32">Yaffe and Tanay, 2011</ref>). This method was further sped up by relaxing the objective function (<ref type="bibr" target="#b13">Hu et al., 2012</ref>). In the recent high resolution study, a faster iterative approach based on matrix balancing was used to achieve the assumption of equal row sums (<ref type="bibr" target="#b18">Knight and Ruiz, 2013;</ref><ref type="bibr" target="#b26">Rao et al., 2014</ref>). Together, these data correction and analysis methods have led to many interesting findings about genome structures. On the other hand, so far most analyses have focused on either individual interactions, domains composed of a contiguous segment on the primary sequence, or grouping of these domains into general domain categories based on some global properties of the contact map. Given the complexity of genome structures, it would be useful to have a way to flexibly identify local clusters of genomic regions that are spatially close in the 3D structure but not necessarily adjacent in the primary sequence, such as multiple non-adjacent TADs that form a higher-level spatial cluster. As to be shown in the Results section, many of these local clusters are related to particular molecular activities such as transcription and DNA replication. Compared to the domains identified in previous studies, these local clusters could provide information about local organizations of the genome structure involving small subsets of genomic regions that are particularly related to each other within larger domains, thereby supplementing the previous methods. In this study, our main goal is to identify these local clusters from contact maps obtained from Hi-C experiments using matrix factorization. In general, matrix factorization aims at decomposing a matrix into two or more matrices with a certain objective. One of the most well-known methods is eigenvalue decomposition, which decomposes a diagonalizable square matrix X into QKQ Ã€1 , where Q contains the orthogonal eigenvectors and K is a diagonal matrix containing the eigenvalues. A popular application of it is principal component analysis, which uses eigenvalue decomposition to factorize the covariance matrix of a dataset. Each eigenvector (i.e. a principal component, PC) represents the direction with the largest data variance after subtracting out the projections on the previous PCs with larger eigenvalues. PCA has been used to identify key contributing factors of Hi-C contact maps (<ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>). Since each bin could have a negative coordinate along a PC, the biological meanings of the PCs are sometimes difficult to interpret. In one of the studies, permutation tests have also indicated that only the first few PCs were statistically significant (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>). Conceptually, a perfect DNA contact map can be considered as the superposition of contact counts from different local clusters and a small number of counts linking different clusters. For example, the contact map submatrix shown in Supplementary<ref type="figure" target="#fig_2">Figure S1</ref>can be well approximated by read counts within the first local cluster (consisting of bins a, b and c) and read counts within the second local cluster (consisting of bins d and e). Each bin can have an affinity value indicating its participation in each local cluster, and bins at the interface of multiple clusters (bins c and d) can have partial affinities to these clusters. When only the contact counts between different bins are available but not the 3D coordinates of each bin in the genome structure, these local clusters can be identified by nonnegative matrix factorization (NMF), which decomposes the data matrix into matrices containing only non-negative values (<ref type="bibr" target="#b6">Devarajan, 2008</ref>). For a DNA contact map, after considering some i112 X.Hu et al. global effects due to general open and close domains or chromosome structures, the remaining factors could correspond well to the local clusters. Comparing with analyzing DNA contact maps with PCA, NMF enjoys the advantages of (i) having clear biological interpretations for many factors, (ii) allowing only positive coefficients (i.e. the affinity values) and (iii) focusing more on local sub-structures. In fact, NMF was popularized by Lee and Seung's work on image processing (<ref type="bibr" target="#b19">Lee and Seung, 1999</ref>), which clearly demonstrated that each image of human face can be automatically factorized by NMF into distinct facial features, such as the nose, the mouth and so on. NMF has also been shown effective in many biological applications such as analyzing protein-protein interactions (<ref type="bibr" target="#b11">Greene et al., 2008</ref>). As discussed, DNA contact maps contain various types of bias that should be properly corrected before applying NMF. Here, we propose a novel method called balanced non-negative matrix factorization (BNMF), which was specially designed for DNA contact maps to handle data biases and relationships between data bins in the primary sequence when performing NMF. We show that BNMF can identify compact spatial clusters of genomic regions according to simulated data that highly resemble real Hi-C data. The clusters were identified without making any assumptions about the whole genome structure. They are found to contain genomic regions closer to each other than those identified by some other clustering methods previously used to analyze Hi-C data. We further describe how statistical tests can be performed to check whether a group of genomic regions of interest are spatially close to each other in the 3D genome structure based on the clusters identified by BNMF. We use this testing procedure to confirm that various functionally related groups of genomic regions are spatially close to each other. We then show that the BNMF clusters are not only good indicators of particular groups of functionally related genomic regions, but their affinity values are actually quantitatively correlated with various molecular activities. Finally, we show that BNMF cluster affinities can precisely define boundaries of TAD, and provide more fine-grained information about sub-domains within these large domains.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">BNMF identifies local spatial clusters from DNA contact maps</head><p>BNMF takes a contact map X as input, and finds an approximation Y of it that can be decomposed into the product of several matrices:</p><formula>X % Y Â¼ BHSH T B;</formula><p>where B is a diagonal matrix that captures the position-specific contact count biases, S is a diagonal matrix that defines the clusters, and H contains the cluster membership values (<ref type="figure" target="#fig_2">Fig. 1</ref>). B, S and H all contain only non-negative values. To understand this formula, first we define a new matrix R as follow:</p><p>R :Â¼ B Ã€1 YB Ã€1 Â¼ HSH T R is a balanced contact map required to have equal sums for all rows and equal sums for all columns except for those bins with no contact counts in the original contact map X. BNMF then looks for non-negative matrices H and S such that R Â¼ HSH T. This decomposition does not have a unique solution. For instance, if every element in H is multiplied by a positive value and each element in S is divided by the square of that value, HSH T would stay unchanged. To make the decomposition result easy to interpret, we require each column of H to sum to a given constant, and correspondingly each column of W Â¼ SH T to sum to another constant (<ref type="figure" target="#fig_2">Fig. 1</ref>). With this constraint, each column of H contains the memberships of different bins to a cluster when each cluster has a fixed membership quota for all the bins, and each column of W contains the affinity of a bin to join the different clusters when each bin has a fixed affinity budget for all the clusters. To illustrate the decomposition procedure, consider the following raw contact map:In this idealized example, we can find Y that is identical to X.! From matrix S, the two diagonal entries state that there are two clusters, with two members belonging to the first and one member to the second. From matrix H, the first cluster assigns 0.5 membership to bin 1 and 0.5 membership to bin 2, and the second cluster assigns 1 membership to bin 3. From matrix W, bins 1 and 2 both have full affinity to cluster 1 and bin 3 has full affinity to cluster 2. We developed an algorithm that searches for B, S and H at the same time given an input contact map X. This algorithm also uses the location of the bins in the primary sequence to define a manifold component in the objective function, such that the resulting affinity values are smooth (Section 4, Supplementary<ref type="figure">Fig. S2</ref>). When applying BNMF to a published yeast Hi-C contact map (<ref type="bibr" target="#b9">Duan et al., 2010</ref>), the identified clusters contain adjacent bins in the primary sequence, as evidenced by blocks of large values in each row of W (<ref type="figure" target="#fig_2">Fig. 1</ref>); On the other hand, there are also clusters with member bins not adjacent in the primary sequence but have high contact counts between them, seen as off-diagonal blocks. Overall, when all clusters are considered, the approximated contact map Y is highly similar to the raw contact map X. An important parameter of BNMF is the number of clusters to form, which is equal to the number of rows in matrix S. We have developed an automatic procedure to search for an appropriate number of clusters such that each cluster is sufficiently homogeneous but not too fragmented (Section 4).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discovering 3D spatial clusters in genome i113</head><p>2.2 BNMF produces spatial clusters more compact than other clustering methods</p><p>We used two methods to test whether BNMF produces clusters that contain spatially proximal genomic regions. In the first method, we used a space-filling Hilbert curve to draw an artificial 2D chromosome in a 16 Ã‚ 16 area. Each of the 256 points mimics a bin of consecutive genomic locations. We then generated an idealized synthetic contact map by assigning dmax Ã°1Ã¾dÃž 2 contact counts between any two points at a Euclidean distance of d in the 2D structure not necessarily adjacent in the 1D sequence, where d max is the maximum Euclidean distance between any two points on the curve. The reason for having contact counts inversely proportional to d 2 in this 2D chromosome is based on previous work of the 3D case in which contact counts are inversely proportional to d 3 due to the volume in 3D space (<ref type="bibr" target="#b31">Varoquaux et al., 2014</ref>). We next decomposed the matrix using eigenvalue decomposition (EIG) and BNMF, respectively. For EIG, we formed four clusters of points that have coefficients larger than the corresponding means along the first four eigenvectors. For BNMF, we formed four clusters comprising points with an affinity value larger than the mean.<ref type="figure">Figure 2</ref>shows the resulting clusters produced by the two methods. For EIG, the first cluster separates the interior and exterior of the structure. The second and third clusters separate points at different sides of the whole area. In order to be orthogonal to the firstThe goal of BNMF is to find a matrix Y that can be decomposed into the product of several matrices and is close to X. Y contains similar position-specific biases as X, as shown by the column sums below the heat maps. These biases can be captured by a bias matrix B. When these biases are removed from Y, we get a balanced contact map R. R is in turn decomposed into HSH T , where S defines the local spatial clusters and H contains the membership values that associate the bins to the clusters i114 X.<ref type="bibr">Hu et al.</ref>three eigenvectors, the fourth eigenvector results in a cluster that involves two isolated parts of the structure. The four clusters overlap each other substantially and are all based on some global data properties. In contrast, the clusters formed by BNMF clearly correspond to spatial clusters at the four corners. These clusters include points that are spatially close in the structure but not adjacent in the primary sequence. For example, points 22 and 235 are far away in the primary sequence, but due to their spatial locality, they have a high contact count, and are grouped into the same cluster. Similar results could also be obtained from a 3D Hilbert curve. While BNMF is not intended for identifying global compartments as was done in some previous studies (<ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>), this example clearly illustrates how BNMF identifies spatial clusters. In the second method, we generated a noisy synthetic yeast Hi-C contact map with position-specific biases, and used it to compare different clustering methods (Section 4). A volume exclusion model was previously proposed for generating a population of simulated 3D structures of the yeast genome, which was shown to produce a contact map similar to one obtained from real data (<ref type="bibr" target="#b30">Tjong et al., 2012</ref>). We used this model to generate 3000 simulated yeast genome structures at 3.2 kb resolution. The resulting contact map has data patterns highly similar to a real contact map at 32 kb resolution (Supplementary<ref type="figure" target="#fig_4">Fig. S3a</ref>,b). The average Pearson correlation between the rows in the two matrices is larger than 0.9 (Supplementary<ref type="figure" target="#fig_4">Fig. S3e</ref>). When we decomposed these two matrices using BNMF, the cluster affinity values were highly similar (Supplementary<ref type="figure" target="#fig_4">Fig. S3c</ref>,d), with clear correspondence between most clusters obtained from the two maps (Supplementary<ref type="figure" target="#fig_4">Fig. S3f</ref>). Having this highly realistic synthetic contact map, we used it to check whether the bins grouped into the same cluster by BNMF are spatially close, based on the known average distance between any two bins in the 3000 simulated structures. In addition to BNMF, we also applied four other methods to produce clusters from the noisy synthetic contact map. The first method is PCA with a normalization step for removing position biases (<ref type="bibr" target="#b20">Lieberman-Aiden et al., 2009</ref>), in which case each PC was used to define a cluster (see below). The second method is Iterative Correction and Eigenvalue Decomposition (ICE) (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>), which uses an iterative procedure to remove biases in the contact map before applying eigenvalue decomposition. The third method is the standard k-means clustering method (<ref type="bibr" target="#b22">MacQueen, 1967</ref>), in which case each row vector was used as the features of the corresponding bin. The fourth method is standard NMF without correcting for the biases. We required all methods to produce the same number of clusters, with each bin assigned to exactly one cluster.<ref type="figure" target="#fig_4">Figure 3a</ref>shows the synthetic contact map and<ref type="figure" target="#fig_4">Figure 3b</ref>shows the corresponding pairwise Euclidean distances between the bins based on the actual synthetic structures. The centromeres of the different chromosomes are in general close to each other as previously reported in whole-genome models (<ref type="bibr" target="#b9">Duan et al., 2010</ref>). For each cluster, we computed the average distance between the member bins (<ref type="figure" target="#fig_4">Fig. 3c</ref>). For most cluster numbers, the clusters identified by BNMF were the tightest. We found that some methods tended to put only bins from the same chromosome in the same cluster. If we focused on only bin pairs from the same chromosome, the average distances were again smallest for BNMF (<ref type="figure" target="#fig_4">Fig. 3d</ref>). Since BNMF uses an iterative optimization procedure, we checked how the objective score and the average Euclidean distance between bins assigned to the same cluster change across the iterations. Supplementary<ref type="figure" target="#fig_5">Figure S4</ref>shows that the objective score decreased progressively across iterations as expected. Correspondingly, the average distance between the bins in the same cluster also decreased, and it had a good correlation with the objective score, suggesting that the objective function is a good indicator of intra-cluster bin distances in DNA contact maps. Taking the results of both analyses together, the clusters identified by BNMF are shown to represent compact groups of genomic bins coming from spatially proximal regions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">BNMF confirms spatial locality of functionally related genomic regions</head><p>As an application of BNMF, we developed statistical tests for checking whether a given set of genomic regions are spatially proximal using the clusters identified by BNMF (Section 4). The basic idea is that if a set of genomic regions are spatially close, they would have large affinity values to a cluster simultaneously. The affinity values to this cluster can thus well separate bins belonging to this group ofThe average distance between bins in the same cluster, considering only bin pairs from the same chromosome<ref type="figure">Fig. 2</ref>. Comparison between eigenvalue decomposition and BNMF based on a space-filling curve. A Hilbert curve is used to generate an artificial 2D chromosome and a corresponding synthetic contact map. The contact map is decomposed by eigenvalue decomposition (EIG) and BNMF. In both cases, four clusters are obtained by grouping the points with the highest coefficients along the eigenvectors or affinity values to the clusters. A region with longrange contacts, including points 22 and 235, is highlighted in the Hilbert curve, the heat map and cluster 4 produced by BNMF</p><p>Discovering 3D spatial clusters in genome i115 genomic regions from other bins. Our testing procedure performs this analysis for every cluster, and reports a P-value corrected for multiple hypothesis testing. One major difference between our testing procedure and the ones used in previous studies is that we use cluster affinity values to check the spatial locality of the bins of interest while most previous methods use contact counts directly. If a set of genomic regions of interest simultaneously have a high affinity to a cluster, other genomic regions with a high affinity to this cluster are also spatially co-localized with the regions of interest, thus providing a simple way to discover new spatial relationships. To check the effectiveness of our testing procedure, we applied it to check the co-localization of previously reported groups of genomic regions, including early replication sites in yeast (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>), VRSM genes in the parasite Plasmodium falciparum (<ref type="bibr" target="#b0">Ay et al., 2014</ref>) and tRNA genes in human, mouse and yeast (<ref type="bibr" target="#b9">Duan et al., 2010</ref>).<ref type="figure" target="#tab_1">Table 1</ref>shows the resulting P-values. All these three previously reported functional groups were found to contain bins that could be well distinguished from other bins based on the cluster affinity values of BNMF. As a control, we also applied the testing procedure on late replication sites, which are not expected to be colocalized. Indeed, the resulting P-value was not significant. These results demonstrate BNMF's ability to test the spatial locality of functionally related genomic regions, and its general applicability to data from different species.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">BNMF cluster affinities quantitatively correlate with genomic features in a cell type specific manner</head><p>For functionally related regions, if their activities differ in different cell types, their spatial locality may also change accordingly. To test if such cell type specific structural information is captured by the BNMF clusters, we collected Hi-C data from four human cell lines and used BNMF to identify local spatial clusters from them. We also collected cell type specific experimental data that indicate various molecular activities, including genes with cell type specific expression, locations of super enhancers, DNase I hypersensitivity values and replication time (Section 4). The first two types of data identify genomic regions belonging to these categories, and we used the same statistical procedure described in the last section to test the spatial locality of these bins. The last two types of data provide numeric values for each bin across the whole genome. We used a modified testing procedure to check if these values were quantitatively correlated with cluster affinity values.<ref type="figure" target="#tab_2">Table 2</ref>shows the analysis results. In 61 of these 64 cases, the correlation between the cluster affinity values and the genomic features is statistically significant, except for the three cases involving highly expressed genes in K562 and local clusters from other cell lines, indicating that genomic regions defined by these features are in general close to each other regardless of their activities. On the other hand, in many cases the highest correlations (in terms of AUC or SPC, defined in Section 4) are observed when both the DNA contact map and the genomic feature were obtained from the same cell type. For example, the genes specifically expressed in a cell type appear to be most structurally proximal in the same cell type. The results for DNase I hypersensitivity and replication time further show that the BNMF cluster affinity values not only can help identify the local clusters related to particular genomic features, but also quantitatively reflect the activity level of some features. These results indicate that cell type specific structural changes related to differential molecular activities are captured by the BNMF clusters.The four sub-tables show the correlations between BNMF cluster affinities and four types of genomic features. For the first two features (genes highly expressed in specific cell lines and super enhancers), the correlations are quantified by the area under the receiver operator characteristics curve (AUC). For the last two features (DNase I hypersensitivity and replication time), the correlations are quantified by the Spearman rank correlation (SPC). In each sub-table, the rows correspond to the cell types from which the Hi-C data were obtained, and the columns correspond to the cell types from which the genomic features were obtained. The highest value in each row is highlighted in bold face. Corrected P-values, *P &lt; 0.05, **P &lt; 1E-5.Several groups of functionally related genomic regions previously reported to be spatially proximal were re-tested for their spatial co-localization using BNMF cluster affinity values based on the CCD method. Late replication sites, which are not expected to be co-localized in the 3D genome structure, were used as a control. i116 X.Hu et al.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Local clusters identified by BNMF are consistent with and supplement topologically associating domains</head><p>Previous work has identified topologically associating domains (TADs), consecutive blocks of DNA locations that define structural domains (<ref type="bibr" target="#b8">Dixon et al., 2012;</ref><ref type="bibr" target="#b24">Nora et al., 2012</ref>). We investigated how the clusters identified by BNMF are related to TADs. We first reasoned that if TADs mark structural domains, the boundaries of some TADs should also be boundaries of BNMF clusters. We identified BNMF cluster boundaries by checking the affinity values of the bins. Bins at cluster boundaries have affinities to multiple clusters, and thus their vectors of cluster affinities have a higher Gini impurity index (Section 4). When plotting all these Gini impurity values from a contact map from the human IMR90 cell line, a clear enrichment is seen around TAD boundaries (<ref type="figure" target="#fig_5">Fig. 4a</ref>). In general, there is substantial overlap between TAD and BNMF cluster boundaries (Supplementary<ref type="figure">Fig. S5a</ref>). By inspecting individual TADs, we found that in some simple cases each TAD corresponds to exactly one BNMF cluster (<ref type="figure" target="#fig_5">Fig. 4b</ref>). In some more complex cases, one TAD contains multiple BNMF clusters, and long-range contacts across TADs are captured by the BNMF affinity values and appear as small distal peaks (<ref type="figure" target="#fig_5">Fig. 4c</ref>, Arrows 1 and 2, Supplementary<ref type="figure">Fig. S5b</ref>). Alternatively, some BNMF clusters span multiple TADs, suggesting the spatial proximity between them as indicated by the contact map (<ref type="figure" target="#fig_5">Fig. 4c</ref>, green cluster, Supplementary<ref type="figure">Fig. S5c</ref>). One feature of BNMF is that it can identify clusters at different resolution by decomposing contact maps at different bin sizes and/ or setting different number of clusters. We demonstrate this feature by extracting the balanced contact map of a segment (from 53 to 56 Mb) of chromosome 12 from the human K562 cell line at 5 kb resolution (<ref type="bibr" target="#b26">Rao et al., 2014</ref>), and using BNMF to produce local spatial clusters. There was a recent study using a novel DNase Hi-C method to study the 3D genome structures around long intergenic noncoding RNAs of human cell lines (<ref type="bibr" target="#b21">Ma et al., 2015</ref>). Two distal regions were clearly observed to have interactions with the promoter of the HOTAIR gene, one of which is also supported by ChIA-PET (<ref type="figure" target="#fig_5">Fig.   4d</ref>). We checked the BNMF clusters around this genomic locus, and found a cluster with almost identical boundaries with a surrounding TAD. The two distal interacting regions have strong enrichment in the affinity values of this cluster as compared to other regions within the TAD, showing that BNMF identified these two distal regions and the HOTAIR gene to be particularly close among all the bins in this TAD. These results suggest that the BNMF clusters are consistent with TADs, but also provide additional information about more detailed interactions within a single TAD and across multiple TADs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Discussion and conclusion</head><p>In this paper, we have described the BNMF method for decomposing a contact map and identifying local spatial clusters from it. We have used synthetic contact maps based on both an artificial spacefilling chromosome and simulated yeast genome structures that resemble real yeast genome structures to show that the clusters identified by BNMF correspond to compact clusters of genomic regions proximal in the 3D genome structure. Genomic regions in the same spatial clusters are usually, but not necessarily, close to each other in the primary sequence. Comparisons with other clustering methods showed that the clusters produced by BNMF are more compact. This is partially attributed to the non-negative requirements for the decomposing matrices, which naturally attempts to explain the overall contact map by the summation of contact counts from different local clusters. In contrast, if the decomposing matrices allow negative values, as in eigenvalue decomposition, the resulting clusters may not correspond to local spatial clusters and their meanings could be difficult to interpret. Since BNMF does not require any prior knowledge about the overall genome structure and does not make any assumptions about it, the identified clusters are based purely on the contact map data and could contain novel groups of genomic regions. We have shown that BNMF can be applied to data obtained from a variety of species. One could also apply BNMF to the same contact map at different bin sizes, to identify spatial clusters at different resolution. Currently one limitation of BNMF is that when the input contact map is too large, the computation involved in the decomposition could be prohibitive due to expensive matrix multiplications. One way to deal with this problem is to extract a subset of the contact map of interest, such as one chromosome, and apply BNMF on this subset only. When we used this strategy to study the sub-contact map around the HOTAIR gene at 5 kb resolution, we were able to identify the enhancer-promoter interactions around the HOTAIR gene within a larger TAD. Some other technical methods for speeding up the calculations are discussed in the Supplementary Materials.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Materials and Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Formulation of balanced non-negative matrix factorization, BNMF</head><p>Given a DNA contact map X, the BNMF method looks for positive matrix B and non-negative matrices H and S such that X % BHSH T B. This searching process requires an objective function to evaluate how similar the reconstructed matrix BHSH T B and the input matrix X are, and an algorithm for finding matrices B, H and S that result in a good objective score. Here, we provide the details of these two components of BNMF.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.1">Defining the basic objective function</head><p>We begin with the simplified problem of decomposing X into HSH T , assuming X is bias free. Later we will explain how the bias matrix B can be identified to remove position-specific biases in X. Let W :Â¼ SH T be a non-negative matrix. In order to approximate X by HW, we assume that X is produced by adding Poisson noise to HW. Maximizing the data likelihood is related to minimizing the Kullbackâ€“Leibler (KL) divergence between X and HW (<ref type="bibr" target="#b19">Lee and Seung, 1999</ref>) defined as follows:</p><formula>dÃ°XjjHWÃž Â¼ X i;j X ij ln X ij Ã°HWÃž ij Ã€ X ij Ã¾ Ã°HWÃž ij ! Â¼ X i;j Ã°HWÃž ij Ã€ X ij lnÃ°HWÃž ij h i Ã¾ X i;j X ij lnX ij Ã€ X ij Ã‚ Ãƒ</formula><p>Since only the first term varies with HW, minimizing the KL divergence is equivalent to minimizing the following objective function:</p><formula>J Poi Â¼ X i;j Ã°HWÃž ij Ã€ X ij lnÃ°HWÃž ij h i</formula><p>We also add to the objective function a manifold component, such that bins adjacent to each other in the primary sequence are more likely to have similar cluster membership values. The details are given in Section S1.1.1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.2">Algorithm for solving X 5 HW</head><p>For the optimization problem based on the basic objective function J Poi with non-negative constraints on H and W, locally optimal solutions can be found by the Multiplicative Update Rules (MUR) (<ref type="bibr" target="#b19">Lee and Seung, 1999</ref>). These rules are obtained by gradient descent. The partial derivative of the objective function J Poi with respect to any element H ab in H is</p><formula>@J Poi @H ab Â¼ X ij @Ã°HWÃž ij @H ab Ã€ X ij X ij Ã°HWÃž ij @Ã°HWÃž ij @H ab Â¼ X j W bj 1 Ã€ X aj Ã°HWÃž aj ! Â¼ X j 1 Ã€ X HW aj W bj Â¼ 1 Ã€ X HW W T ab ;</formula><p>where the divisions between two matrices are calculated element-wise, and 1 is a matrix of all ones with the same size of X. Similarly, the partial derivative of J Poi with respect to any element W ab in W is</p><formula>@J Poi @W ab Â¼ H T 1 Ã€ X HW ab</formula><p>Therefore, the gradients of J Poi are</p><formula>r H J Poi Â¼ 1 Ã€ X HW W T r W J Poi Â¼ H T 1 Ã€ X HW</formula><p>By setting the step sizes in the gradient decent method to be</p><formula>g H Â¼ H 1W T g W Â¼ W H T 1 ;</formula><p>we obtain the MUR update rules:</p><formula>H ab H ab X HW W T ab Ã°1W T Ãž ab W ab W ab H T X HW ab Ã°H T 1Ãž ab</formula><p>The update rules for the extended objective function with manifold information, the way to decompose contact map matrix X into HSH T and the way to handle sparse contact maps are discussed in the Sections S1.1.2, S1.1.3 and S1.1.4, respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.3">Removing biases in contact maps</head><p>When studying Hi-C contact maps, it is desirable to correct the data matrix such that signals coming from different genomic locations are equally visible (<ref type="bibr" target="#b14">Imakaev et al., 2012;</ref><ref type="bibr" target="#b26">Rao et al., 2014</ref>). Suppose R is a matrix derived from X with all position-specific biases removed, we require each row and each column of R to sum to the same constant. We relate R and X by X Â¼ BRB, where B is a diagonal matrix with its diagonal elements indicating the biases at each bin. BNMF applies non-negative factorization on matrix R, and thus X Â¼ BHSH T B Â¼ Ã°BHÃžSÃ°BHÃž T. To determine B and R from X, we first initialize B to be the identity matrix and iteratively normalize W Â¼ SH T and H:</p><formula>b Diag n X r iÂ¼1 Ã°SH T BÃž i X r iÂ¼1 X n jÂ¼1 Ã°SH T BÃž ij 0 B B B B @ 1 C C C C A H b Ã€1 BH B b h Diag 1 n X n iÂ¼1 H i ! H Hh Ã€1 S hSh;</formula><p>where Diag(v) is the diagonal matrix with the diagonal entries taken from vector v. This process will produce suitable B and S that make each column of SH T to sum to a constant and each column of H to have an average of one, leading to HSH T having equal column sums and equal row sums. Supplementary<ref type="figure">Figure S6a</ref>shows that our method produces bias vectors highly similar to the ones produced by the ICE method (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>) based on a Hi-C contact map obtained from the human GM06990 cell line (SRR027956). The main difference between the two methods is that our method optimizes a function for X % BHSH T B while the ICE method optimizes X % BTB, which has much more free parameters. Supplementary<ref type="figure">Figure S6b</ref>shows that after bias removal, the correlation between contact maps obtained from the same cell line increased more than the correlation between contact maps from different cell lines.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.4">The final BNMF algorithm</head><p>Our BNMF algorithm combines the techniques discussed in the previous sections. For a non-negative symmetric matrix X 2 R nÃ‚n and a given number of clusters r, our algorithm finds diagonal matrixB 2 R nÃ‚n , cluster membership matrix H 2 R nÃ‚r and cluster size matrix S 2 R rÃ‚r to approximate X by BHSH T B by solving the following optimization problem:where k is a parameter, and L Â¼ D Ã€ E is a user-defined nearestneighbor matrix with a default to take value 1 for entries corresponding to bins adjacent in the primary sequence and 0 for all other entries. Note that since</p><formula>Minimize X n iÂ¼1 X n jÂ¼1</formula><formula>X n iÂ¼1 Ã°HSH T Ãž ij Â¼ X n iÂ¼1 X r kÂ¼1 H ik Ã°SH T Ãž kj Â¼ X n iÂ¼1 H ik X r kÂ¼1 Ã°SH T Ãž kj Â¼ c 1 c 2</formula><p>for all j, the balanced contact map R Â¼ HSH T should have constant column sums. Our algorithm initializes the matrices by the Non-negative Double Singular Value Decomposition (NNDSVD) method (<ref type="bibr" target="#b1">Boutsidis and Gallopoulos, 2008</ref>). It then iteratively updates B, H and S using the following rules:</p><formula>G BH G G I X GSG T Ã¾ GS Ã¾ 2kEH IGS Ã¾ 2kDH Ã¾ B Diag n X r iÂ¼1 Ã°SG T Ãž i X r iÂ¼1 X n jÂ¼1 Ã°SG T Ãž ij 0 B B B B @ 1 C C C C A H B Ã€1 G h DiagÃ° 1 n X n iÂ¼1 H i Ãž H Hh Ã€1 S hSh S S BH T Ã°I X BHSH T B Ã¾ ÃžHB BH T IHB Ã¾ ;</formula><p>where represents element-wise multiplication and a small constant Â¼ 1 Ã‚ 10 Ã€30 is added to avoid division-by-zero errors. The parameter k was always set to 1 in the current study. The algorithm terminates when the decrease of objective score is less than 1 Ã‚ 10 Ã€6 of the score in the previous iteration, or a maximum number of iterations is reached. In our analyses of the human and yeast datasets, we observed that the objective score usually became stable after 1500 iterations. We therefore set the maximum number of iterations to 3000, which guaranteed the convergence of the algorithm in most cases. BNMF contains a procedure for automatically determining the number of clusters. The details are given in Section 9.1.5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Statistical testing of co-localization</head><p>Using the BNMF clusters, we tested whether some genomic features define bins that are co-localized. We considered two scenarios. In the first, 'binary' scenario, genomic bins containing the feature or have an average feature value exceeding a certain threshold will be given a label of 1 (the positive bins), and all other regions will be given a label of 0 (the negative bins). In other words, the feature provides a binary classification of the genomic bins. We used this setting to test the co-localization of early replication sites, tRNA genes, VRSM genes, genes highly expressed in specific cell lines, and super enhancers (the data sources will be discussed in Section 4.3). In the second, 'continuous' scenario, each bin is labeled by the average feature value across all genomic locations in the bin. We applied this setting to the correlation between cluster affinity and either DNase I hypersensitivity or replication time. For each scenario, we considered two different ways to perform the statistical tests. For the binary scenario, we checked whether the positive bins were spatially co-localized by using the cluster affinity values. The first testing method was based on the area under the receiver operator characteristics (ROC), which was also used previously (<ref type="bibr" target="#b3">Cournac et al., 2012;</ref><ref type="bibr" target="#b9">Duan et al., 2010</ref>). Specifically, for each cluster, we sorted all bins in descending order of their cluster affinity values. We then used this order to make an ROC curve according to the bin labels assigned by the feature. The statistical significance of the AUC was evaluated by the Mann-Whitney U test. The resulting P-values from all the clusters were then collected and the most significant one was reported after Bonferroni correction for multiple hypothesis testing. The second method was inspired by the conserved consecutive distances (CCD) method (<ref type="bibr" target="#b25">Paulsen et al., 2013</ref>). The basic idea is to compare a test statistic of the positive bins with a background distribution of the test statistic. In our case, we used the average affinity value to a cluster as the test statistic. The CCD method draws a large number of random bins and computes the average affinity to the cluster to form a corresponding background distribution of average affinity values. In each sample, the bins are required to preserve the same distance distribution between the positive bins in the primary sequence. By having this requirement, the positive bins are considered significantly co-localized at a cluster only if their colocalization is not simply due to their proximity in the primary sequence. The fraction of background bin samples with an average affinity higher than that of the positive bins is defined as the P-value. Again, the most significant P-value after Bonferroni correction from the different clusters was reported. For the continuous scenario, we checked whether the cluster affinity values were quantitatively correlated with the feature values of the bins. In the first testing method, we used Pearson correlation coefficient (PCC), and in the second method, we used the Spearman rank correlation coefficient (SPC). In either case, we used the 'Numpy' package in Python to calculate the P-values, and then applied Bonferroni correction. The key difference between our statistical tests and the ones previously used for analyzing DNA contact maps is that our tests involve cluster affinity values instead of contact counts, which enables us to test the relationship between a genomic feature and a specific local cluster. As a basic check of our statistical testing procedures, we examined the P-values computed from 100 randomly shuffled contact maps. We used the yeast Hi-C contact map as a template and shuffled each row and each column simultaneously to produce random contact maps. In each random map, the bin labels were carried over from the real case, but the contact counts were changed by the shuffling. Supplementary<ref type="figure">Figure S8</ref>shows that all four tests gave a uniform distribution of the P-value as expected.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discovering 3D spatial clusters in genome i119</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Data collection and pre-processing</head><p>Hi-C and TCC data were collected from multiple sources (Supplementary<ref type="figure" target="#tab_1">Table S1</ref>). Human Hi-C data were mapped to the hg19 reference and pre-processed by the hiclib pipeline (<ref type="bibr" target="#b14">Imakaev et al., 2012</ref>). For the other Hi-C datasets, we downloaded the processed data provided by the authors from public databases. The synthetic yeast contact map was generated by using the volume exclusion model to produce 3000 simulated genomes and the corresponding combined contact map, using the source codes provided by the author of a published study (<ref type="bibr" target="#b30">Tjong et al., 2012</ref>). We then added random position-specific biases to it to produce a noisy contact map. DNase I hypersensitive sites (DHS) and gene expression levels based on RNA-seq in the four human cell lines GM12878, H1hESC, IMR90 and K562 were produced by the ENCODE consortium (The Encode Project Consortium, 2012) and downloaded from the UCSC Genome Browser (<ref type="bibr" target="#b17">Kent et al., 2002</ref>). Cell-type specific highly expressed genes in the four cell lines were defined as the genes having an expression level of RPKM &gt; 4 in a cell line but RPKM &lt; 1 in the other three cell lines. Replication time of different regions in the human genome was defined in a previous study (<ref type="bibr" target="#b27">Ryba et al., 2010</ref>) and we downloaded the data from http://www.replicationdo main.org. Early replication sites in yeast were defined in a previous work (<ref type="bibr" target="#b9">Duan et al., 2010</ref>). The lists of super enhancers in the four human cell lines were defined in a published study (<ref type="bibr" target="#b12">Hnisz et al., 2013</ref>).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>The position-specific biases can be removed by the bias matrix B:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.1.</head><figDesc>Fig. 1. Summary of the BNMF method. The Hi-C contact map based on HindIII interactions at 1% FDR from Duan et al. (2010) is used as the input contact map X. The goal of BNMF is to find a matrix Y that can be decomposed into the product of several matrices and is close to X. Y contains similar position-specific biases as X, as shown by the column sums below the heat maps. These biases can be captured by a bias matrix B. When these biases are removed from Y, we get a balanced contact map R. R is in turn decomposed into HSH T , where S defines the local spatial clusters and H contains the membership values that associate the bins to the clusters</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.3.</head><figDesc>Fig. 3. Comparison between five different clustering methods based on the noisy synthetic yeast Hi-C contact map. (a) The contact map obtained from 3000 simulated yeast genome structures with random biases added to each bin. (b) The corresponding average Euclidean distances between different bins in the 3000 structures. (c) The average distance between bins in the same cluster. (d) The average distance between bins in the same cluster, considering only bin pairs from the same chromosome</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.4.</head><figDesc>Fig. 4. Relationships between BNMF clusters and TADs. (a) Bins around TAD boundaries have increased Gini impurity scores, indicating that they are also at the boundaries of BNMF clusters. (b) An example showing a simple case in which each TAD corresponds to exactly one BNMF cluster. In the cluster affinity panel, each color represents a different cluster. (c) A more complex example showing that some TADs contain multiple clusters, and some longrange DNA contacts across multiple TADs (circles 1 and 2) appear as small peaks of cluster affinity values (marked by arrows 1 and 2). (c) An example showing a BNMF cluster with almost the same boundaries with a TAD, but the affinity values further show the long-range contacts between the HOTAIR gene and two distal regions that have been independently shown by ChIAPET or DNase I Hi-C</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>i118X.</head><figDesc>Hu et al.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 2. Correlation between genomic features and BNMF cluster affinities in human cell lines</figDesc><table>Highly expressed genes (AUC) 
Super enhancers (AUC) 

Hi-C 
GM12878 
h1-hESC 
IMR90 
K562 
GM12878 
H1-hESC 
IMR90 
K562 

GM12878 
0.79** 
0.76** 
0.68** 
0.68 
0.82** 
0.64** 
0.76** 
0.82** 
H1-hESC 
0.75** 
0.80** 
0.67** 
0.71* 
0.72** 
0.67** 
0.73** 
0.79** 
IMR90 
0.71** 
0.73** 
0.75** 
0.70* 
0.73** 
0.63** 
0.80** 
0.76** 
K562 
0.73** 
0.77** 
0.64** 
0.81** 
0.73** 
0.63** 
0.71** 
0.79** 

DNase I hypersensitivity (SPC) 
Replicating time (SPC) 

Hi-C 
GM12878 
h1-hESC 
IMR90 
K562 
GM12878 
H1-hESC 
IMR90 
K562 

GM12878 
0.91** 
0.82** 
0.84** 
0.84** 
0.82** 
0.67** 
0.66** 
0.75** 
H1-hESC 
0.79** 
0.83** 
0.82** 
0.78** 
0.64** 
0.65** 
0.55** 
0.68** 
IMR90 
0.69** 
0.65** 
0.72** 
0.65** 
0.58** 
0.53** 
0.74** 
0.57** 
K562 
0.75** 
0.73** 
0.75** 
0.77** 
0.63** 
0.58** 
0.56** 
0.70** 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Spatial locality of various functional groups of genomic regions</figDesc><table>Genomic regions 
Species 
Corrected P-value 

Early replication sites 
Yeast 
&lt;0.001 
Late replication sites (control) 
Yeast 
0.3 
VRSM genes 
P. falciparum 
&lt;0.001 
tRNA genes 
Human 
&lt;0.001 
tRNA genes 
Mouse 
&lt;0.001 
tRNA genes 
Yeast 
0.03 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>I ij Ã°Ã°BHSH T BÃž ij Ã€ X ij lnÃ°BHSH T BÃž ij Ãž Ã¾ k X r kÂ¼1 Ã°H T LHÃž kk</figDesc><table>subject to 

B ij ! 0; H ij ! 0; S ij ! 0 8i; j; 
X n 

iÂ¼1 

H ij Â¼ c 1 8j; 
X r 

iÂ¼1 

Ã°SH T Ãž ij Â¼ c 2 8j; 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">X.Hu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgment</head><p>We would like to thank Harianto Tjong for providing the source code for generating synthetic yeast genome structures.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>KYY is partially supported by the Hong Kong Research Grants Council General Research Fund CUHK418511. XH is partially supported by the National Natural Science Foundation of China (NSFC: 61402423). Conflict of Interest: none declared.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Three-dimensional modeling of the p. falciparum genome during the erythrocytic cycle reveals a strong connection between genome architecture and gene expression</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Ay</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="974" to="988" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Svd based initialization: a head start for nonnegative matrix factorization</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Boutsidis</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Gallopoulos</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recogn</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="1350" to="1362" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Non-negative matrix factorization on manifold</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Cai</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Eighth IEEE International Conference on Data Mining</title>
		<imprint>
			<date type="published" when="2008" />
			<biblScope unit="page" from="63" to="72" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Normalization of a chromosomal contact map</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Cournac</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">436</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Chromosome territories, nuclear architecture and gene regulation in mammalian cells</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Cremer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Cremer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="292" to="301" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Chromosome territories</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Cremer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Cremer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cold Spring Harb. Perspect. Biol</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page">3889</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Nonnegative matrix factorization: an analytical and interpretive tool in computational biology</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Devarajan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">On the equivalence of nonnegative matrix factorization and spectral clustering</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Ding</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SIAM Data Mining Conf</title>
		<meeting>. SIAM Data Mining Conf</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="606" to="610" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Topological domains in mammalian genomes identified by analysis of chromatin interactions</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">R</forename>
				<surname>Dixon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">485</biblScope>
			<biblScope unit="page" from="376" to="380" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">A three-dimensional model of the yeast genome</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Duan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">465</biblScope>
			<biblScope unit="page" from="363" to="367" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">An oestrogen-receptor-alpha-bound human chromatin interactome</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Fullwood</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">462</biblScope>
			<biblScope unit="page" from="58" to="64" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Ensemble non-negative matrix factorization methods for clustering protein-protein interactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Greene</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="1722" to="1728" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Super-enhancers in the control of cell identity and disease</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Hnisz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">155</biblScope>
			<biblScope unit="page" from="934" to="947" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Hicnorm: removing biases in hi-c data via poisson regression</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Hu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="3131" to="3133" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Iterative correction of hi-c data reveals hallmarks of chromosome organization</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Imakaev</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="999" to="1003" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">A high-resolution map of the three-dimensional chromatin interactome in human cells</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Jin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">503</biblScope>
			<biblScope unit="page" from="290" to="294" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Genome architectures revealed by tethered chromosome conformation capture and population-based modeling</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Kalhor</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="90" to="98" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">The human genome browser at ucsc</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="996" to="1006" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">A fast algorithm for matrix balancing</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Knight</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Ruiz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IMA J. Numer. Anal</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="1029" to="1047" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Learning the parts of objects by non-negative matrix factorization</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">D</forename>
				<surname>Lee</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">S</forename>
				<surname>Seung</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">401</biblScope>
			<biblScope unit="page" from="788" to="791" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Comprehensive mapping of long-range interactions reveals folding principles of the human genome</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Lieberman-Aiden</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">326</biblScope>
			<biblScope unit="page" from="289" to="293" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Fine-scale chromatin interaction maps reveal the cisregulatory landscape of human lincRNA genes</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Ma</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="71" to="78" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Some methods for classification and analysis of multivariate observations</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">B</forename>
				<surname>Macqueen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of 5th Berkeley Symposium on Mathematical Statistics and Probability</title>
		<meeting>5th Berkeley Symposium on Mathematical Statistics and Probability</meeting>
		<imprint>
			<date type="published" when="1967" />
			<biblScope unit="page" from="281" to="297" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Single-cell hi-c reveals cell-to-cell variability in chromosome structure</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Nagano</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">502</biblScope>
			<biblScope unit="page" from="59" to="64" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Spatial partitioning of the regulatory landscape of the X-inactivation centre</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">P</forename>
				<surname>Nora</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">485</biblScope>
			<biblScope unit="page" from="381" to="385" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Handling realistic assumptions in hypothesis testing of 3d co-localization of genomic elements</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Paulsen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="5164" to="5174" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">A 3d map of the human genome at kilobase resolution reveals principles of chromatin looping</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">S P</forename>
				<surname>Rao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">159</biblScope>
			<biblScope unit="page" from="1665" to="1680" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Evolutionarily conserved replication timing profiles predict long-range chromatin interactions and distinguish closely related cell types</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Ryba</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="761" to="770" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Three-dimensional folding and functional organization principles of the drosophila genome</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Sexton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">148</biblScope>
			<biblScope unit="page" from="458" to="472" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b29">
	<analytic>
		<title level="a" type="main">The Encode Project Consortium. (2012) An integrated encyclopedia of DNA elements in the human genome</title>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">489</biblScope>
			<biblScope unit="page" from="57" to="74" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b30">
	<analytic>
		<title level="a" type="main">Physical tethering and volume exclusion determine higher-order genome organization in budding yeast</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Tjong</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="1295" to="1305" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b31">
	<analytic>
		<title level="a" type="main">A statistical approach for inferring the 3d structure of the genome</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Varoquaux</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="26" to="33" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b32">
	<analytic>
		<title level="a" type="main">Probabilistic modeling of hi-c contact maps eliminates systematic biases to characterize global chromosomal architecture</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Yaffe</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Tanay</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="page" from="1059" to="1065" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b33">
	<analytic>
		<title level="a" type="main">Spatial organization of the mouse genome and its role in recurrent chromosomal translocations</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">148</biblScope>
			<biblScope unit="page" from="908" to="921" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>