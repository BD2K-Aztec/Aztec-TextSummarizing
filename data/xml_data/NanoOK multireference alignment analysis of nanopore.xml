
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:46+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">NanoOK: multi-reference alignment analysis of nanopore sequencing data, quality and error profiles</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Richard</forename>
								<forename type="middle">M</forename>
								<surname>Leggett</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Genome Analysis Centre (TGAC)</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Darren</forename>
								<surname>Heavens</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Genome Analysis Centre (TGAC)</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Mario</forename>
								<surname>Caccamo</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Genome Analysis Centre (TGAC)</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Matthew</forename>
								<forename type="middle">D</forename>
								<surname>Clark</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Genome Analysis Centre (TGAC)</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Robert</forename>
								<forename type="middle">P</forename>
								<surname>Davey</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Genome Analysis Centre (TGAC)</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">NanoOK: multi-reference alignment analysis of nanopore sequencing data, quality and error profiles</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv540</idno>
					<note type="submission">Received on July 7, 2015; revised on August 17, 2015; accepted on September 7, 2015</note>
					<note>Sequence analysis *To whom correspondence should be addressed. Associate Editor: Alfonso Valencia Contact: richard.leggett@tgac.ac.uk Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: The Oxford Nanopore MinION sequencer, currently in pre-release testing through the MinION Access Programme (MAP), promises long reads in real-time from an inexpensive, compact , USB device. Tools have been released to extract FASTA/Q from the MinION base calling output and to provide basic yield statistics. However, no single tool yet exists to provide comprehensive alignment-based quality control and error profile analysis—something that is extremely important given the speed with which the platform is evolving. Results: NanoOK generates detailed tabular and graphical output plus an in-depth multi-page PDF report including error profile, quality and yield data. NanoOK is multi-reference, enabling detailed analysis of metagenomic or multiplexed samples. Four popular Nanopore aligners are supported and it is easily extensible to include others. Availability and implementation: NanoOK is an open-source software, implemented in Java with supporting R scripts. It has been tested on Linux and Mac OS X and can be downloaded from https://github.com/TGAC/NanoOK. A VirtualBox VM containing all dependencies and the DH10B read set used in this article is available from http://opendata.tgac.ac.uk/nanook/. A Docker image is also available from Docker Hub—see program documentation https://documentation.tgac.ac.uk/ display/NANOOK.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The Oxford Nanopore Technologies (ONT) MinION is one of the latest of a new generation of single molecule sequencing technologies. Originally revealed at the 2012 Advances in Genome Biology and Technology conference, it arrived in the labs of MinION Access Programme (MAP) members in May 2014. Offering multi-kilobase reads, the MinION attracted interest due to its compact size, USB connection, relatively inexpensive expected purchase price and a streamed mode of operation that enables analysis of data as it generated. Though not out of pre-release testing, the device is in the hands of research groups around the world who are evaluating the performance and suitability of the platform for a wide range of applications including medical diagnostics, environmental surveillance and de novo sequencing. ONT's technology involves the detection of current changes across biological nanopores through which DNA molecules move. The degree of current change depends on the bases (5-mer) present in the pore at any given time and multiple measurements are made as the molecule advances, resulting in a characteristic 'squiggle' plot which ONT's basecalling software (Metrichor) processes to a nucleotide sequence. The MinION will read both strands of DNA (<ref type="bibr">Template and</ref></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>142</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.(one per file) are output in FAST5 format, an implementation of the HDF5 standard. Two tools—poretools (<ref type="bibr" target="#b4">Loman and Quinlan, 2014</ref>) and poRe (<ref type="bibr" target="#b5">Watson et al., 2014</ref>)—have already been published to extract reads to FASTA or FASTQ format and to plot graphs of yield, read size and pore occupancy. Within the MAP community, the most popular aligners have emerged as LAST (<ref type="bibr" target="#b2">Kielbasa et al., 2011</ref>), BLASR (<ref type="bibr" target="#b0">Chaisson and Tesler, 2012</ref>) and BWA-MEM (<ref type="bibr" target="#b3">Li, 2013</ref>), which introduced an 'ont2d' option with version 0.7.11. A Nanopore-specific aligner, marginAlign (<ref type="bibr" target="#b1">Jain et al., 2015</ref>), has also been developed which begins with guide alignments produced by BLASR, BWA-MEM, LAST or LASTZ and produces a trained realignment based on a model of Nanopore error profiles. After alignment, individual labs tend to use their own ad hoc approaches for analysing data, with no published tools available to provide detailed post-alignment analysis. A web-based application for monitoring MinION runs, minoTour (http://minotour.nottingham.ac.uk), has been developed which provides a wide range of very useful QC metrics in real-time. As reads emerge, minoTour will align them against a reference but this analysis is currently limited to coverage assessment and variant calling. Without a comprehensive post-alignment tool, analysis can be unnecessarily time consuming and can require specialized programming skills. NanoOK is designed to address this need, providing quick and intuitive alignment-based analysis and quality control of Nanopore runs, facilitating comparison across chemistry, flow cell, base calling changes and alignment tools. NanoOK itself extracts FASTA files, but users can also use third party tools. NanoOK carries out alignments via a number of supported alignment tools and will produce tabular output files from which it also generates graphs and a multi-page PDF report.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Bioinformatics</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>NanoOK expects runs to be organized in sample directories—initially these contain the reads output by theNanoOK currently supports four alignment tools—LAST (the default), BWA-MEM, BLASR and marginAlign. However, NanoOK facilitates the addition of new parsers by implementing Java classes supporting an AlignmentFileParser interface. The basis for NanoOK's analysis of sequencing errors (substitutions, insertions, deletions, perfect sequence, error motifs) is base-by-base parsing of the alignment strings found in the MAF format files used by LAST. BWA, BLASR and marginAlign output SAM format files, so NanoOK uses a CIGARString class to convert the CIGAR-format alignment strings in SAM files into MAF style strings. An individual read may produce multiple alignments to one or more references. In this instance, NanoOK takes the highest scoring alignment and merges this with any alignments for the same reference that map close to the initial alignment. Merging is performed by expanding the co-ordinates of the original alignment to include the nearby alignment; analysis of matches, mismatches and indels is then performed on the combined alignment. In the interests of execution speed, NanoOK supports multithreading at all stages. Users can specify threads using a –t parameter.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>The Supplementary material contains an example NanoOK report for a run of Escherichia coli K12 substr. DH10B produced using an R7.3 flow cell. The report contains data on the whole run, as well as separate sections for each reference (in this case, control sequence and E. coli). At the run level, data include: @BULLET Pre-alignment summary—including pass/fail counts and read length distributions for Template, Complement and 2D reads. @BULLET Alignment summary—including counts of reads aligning to each reference, mean length, aligned bases, coverage. @BULLET Substitution analysis—like<ref type="bibr" target="#b1">Jain et al. (2015)</ref>, we observe smaller percentage of A to T and T to A substitutions. @BULLET Error kmers—3/4/5-mers occuring before substitutions, insertions and deletions, along with error motif images. Here, we find a high abundance of low complexity kmers, indicative of homopolymer problems, as observed in</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Summary</head><p>NanoOK provides comprehensive alignment-based analysis of Nanopore reads through a simple, easy to use interface. During our progress through the MAP, we have found it to be an invaluable tool for understanding the data emerging from the sequencer as the platform evolves and we believe it will have wide applicability to other groups working with ONT's technology. The speed of change within the MAP is rapid and requires a tool such as NanoOK to evaluate changes: at the time of writing there have been four flowcell versions, five genomic sequencing kits, multiple versions of NanoOK: multi-reference alignment analysissequencer operating software and base caller, and at the recent London Calling meeting ONT announced forthcoming new MinIONs (MK1), flowcell chemistries (R8.0) and a new fast run mode.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>Complement) and the software will attempt to call a consensus 2D (2-directional) read. Individual reads V C The Author 2015. Published by Oxford University Press.</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>, 32(1), 2016, 142–144 doi: 10.1093/bioinformatics/btv540 Advance Access Publication Date: 17 September 2015 Applications Note</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>NanoOK will create further subdirectories for FASTA or FASTQ files, alignments, analysis files, logs and LaTeX files as it runs. When executing the analysis phase, NanoOK performs the following sequence of actions: 1. Read reference FASTA file and store IDs and lengths. 2. For each set of reads (Template, Complement and 2D) within pass and fail directories, store length of each read. 3. For each set of reads (Template, Complement and 2D) within the pass and fail directories, parse the alignment and store details of errors, quality and accuracy. 4. Write a set of analysis files—tabbed plain text files suitable for machine reading or graph plotting. 5. Initiate graph plotting through the R environment. 6. Build a LaTeX report file and then PDF with pdflatex.</figDesc><table>Metrichor software, but 
NanoOK will add further subdirectories containing analysis and 
output. There are three simple steps involved in running NanoOK. 
Firstly, FASTA or FASTQ reads are extracted: 

nanook extract -s MyNanoporeRun -a 

Alignments are initiated with: 

nanook align -s MyNanoporeRun -r refname.fa 

Finally, alignments are analysed and plain text machine readable 
analysis files, graphs and PDF report are generated with: 

nanook analyse -s MyNanoporeRun -r refname.fa 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">R.M.Leggett et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>The authors thank ONT and the members of the MAP community for constructive feedback on the tool during its development. We also thank Kirsten McLay and members of the TGAC Platforms and Pipelines team who have assisted with this work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Chaisson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Tesler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="238" to="254" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Improved data analysis for the MinION nanopore sequencer</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Jain</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="351" to="356" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Adaptive seeds tame genomic sequence comparison</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">M</forename>
				<surname>Kielbasa</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="487" to="493" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Poretools: a toolkit for analyzing nanopore sequence data</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">J</forename>
				<surname>Loman</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">R</forename>
				<surname>Quinlan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="3399" to="3401" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">poRe: an R package for the visualization and analysis of nanopore sequencing data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Watson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="31" to="114" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>