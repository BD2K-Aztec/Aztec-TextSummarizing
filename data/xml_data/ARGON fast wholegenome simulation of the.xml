
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:48+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis ARGON: fast, whole-genome simulation of the discrete time Wright-fisher process</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Pier</forename>
								<forename type="middle">Francesco</forename>
								<surname>Palamara</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Epidemiology</orgName>
								<orgName type="institution" key="instit1">Harvard T. H</orgName>
								<orgName type="institution" key="instit2">Chan School of Public Health</orgName>
								<address>
									<postCode>02115</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Oliver</forename>
								<surname>Stegle</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Program in Medical and Population Genetics</orgName>
								<orgName type="institution">Broad Institute of Harvard and MIT</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis ARGON: fast, whole-genome simulation of the discrete time Wright-fisher process</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw355</idno>
					<note type="submission">Received on January 15, 2016; revised on May 6, 2016; accepted on May 31, 2016</note>
					<note>*To whom correspondence should be addressed. Associate Editor: Availability: ARGON (version 0.1) is written in Java, open source, and freely available at https:// github.com/pierpal/ARGON. Contact: ppalama@hsph.harvard.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Simulation under the coalescent model is ubiquitous in the analysis of genetic data. The rapid growth of real data sets from multiple human populations led to increasing interest in simulating very large sample sizes at whole-chromosome scales. When the sample size is large, the coales-cent model becomes an increasingly inaccurate approximation of the discrete time Wright-Fisher model (DTWF). Analytical and computational treatment of the DTWF, however, is generally harder. Results: We present a simulator (ARGON) for the DTWF process that scales up to hundreds of thousands of samples and whole-chromosome lengths, with a time/memory performance comparable or superior to currently available methods for coalescent simulation. The simulator supports arbitrary demographic history, migration, Newick tree output, variable mutation/recombination rates and gene conversion, and efficiently outputs pairwise identical-by-descent sharing data.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The coalescent (<ref type="bibr" target="#b4">Kingman, 1982</ref>) can be constructed as an approximation of the discrete time Wright-Fisher process (DTWF,<ref type="bibr" target="#b1">Fisher et al., 1922;</ref><ref type="bibr" target="#b12">Wright, 1931</ref>), and leads to simplified analytical and computational treatment. Simulators based on the coalescent process (e.g.<ref type="bibr" target="#b2">Hudson, 2002</ref>) have been extensively adopted in computational methods. The coalescent approximation, however, relies on the assumption that the sample size is small compared with the effective population size, and violations of this assumption may result in substantial distortions of key genealogical properties (<ref type="bibr" target="#b0">Bhaskar et al., 2014;</ref><ref type="bibr" target="#b10">Wakeley and Takahashi, 2003</ref>). Until very recently, coalescent simulators did not scale up to long chromosomes and the very large sample sizes of modern day data sets, which now comprise hundreds of thousands of individuals. The recently developed simulators COSI2 (<ref type="bibr" target="#b8">Shlyakhter et al., 2014</ref>) and SCRM (<ref type="bibr" target="#b9">Staab et al., 2015</ref>) enable fast simulation under approximate coalescent models. The COSI algorithm uses a standard backwards-in-time approach, while SCRM adopts a 'sequential' approach (<ref type="bibr" target="#b6">McVean and Cardin, 2005;</ref><ref type="bibr" target="#b11">Wiuf and Hein, 2000</ref>). Both can be also used to simulate large sample sizes and chromosomelong regions under the 'exact' coalescent process with reasonable time and memory requirements. Here, we present ARGON, an efficient simulator of the DTWF process that scales up to very large chromosomes, and hundreds of thoudsands of samples. The simulator offers substantially improved performance compared with recent DTWF simulators, e.g. GENOME (<ref type="bibr" target="#b5">Liang et al., 2007</ref>), and is comparable or superior to current coalescent simulators in terms of speed and memory usage. population structure and migration. Each individual is represented as a list of regions for which not all samples have found a common ancestor. Crossover and non-crossover recombination events are sampled in genetic space and rounded to the closest physiscal base pair position based on the desired uniform or variable recombination rate. Whenever a coalescence occurs, regions within individuals are annotated with links to descendant nodes in the ancestral recombination graph (ARG). When compared with other DTWF implementations (e.g. GENOME), ARGON offers substantially improved speed and memory usage (see Supplementary Materials). In ARGON, large regions are represented as intervals with arbitrary boundary values, and hash map data structures are extensively used to take advantage of sparsity, avoiding explicit representation of all individuals. ARGON can run in approximate mode, so that recombinations breakpoints are rounded to blocks of a user-specified genetic length, as implemented in the GENOME simulator. This reduces the granularity of the recombination process, improving speed and memory usage, at the cost of slightly inflated correlation of nearby markers. ARGON can efficiently output a list of identical-by-descent (IBD) segments, which are delimited by the occurrence of recombination events that change the most recent common ancestor for pairs of samples. In ARGON, these events are detected by visiting internal ARG nodes, while previous approaches to output simulated IBD sharing data (e.g.<ref type="bibr" target="#b7">Palamara et al., 2012</ref>) required comparing recent ancestry for all pairs of individual at each marginal tree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Accuracy for small sample sizes</head><p>When n ( N e , the coalescent is a good approximation of the DTWF. We performed extensive testing for several scenarios including population size variation, migration across multiple demes, and gene conversion. We report detailed results in the Supplementary Materials. We find good agreement between ARGON and MS. We also tested the accuracy of COSI version 2.0, SCRM version 1.6.1, and MSprime version 0.1.6 (<ref type="bibr" target="#b3">Kelleher et al., 2015</ref>), a new efficient simulator for which a preliminary version was released at the time of writing. All simulators were found to be well calibrated against MS.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Deviation of the coalescent from the DTWF</head><p>The coalescent becomes a poor approximation of the DTWF process when the sample size is not substantially smaller than the effective population size (<ref type="bibr" target="#b0">Bhaskar et al., 2014;</ref><ref type="bibr" target="#b10">Wakeley and Takahashi, 2003</ref>). We verified that ARGON matches the theoretical prediction for the number of singletons and doubletons described in<ref type="bibr" target="#b0">Bhaskar et al. (2014)</ref>for the DTWF (see<ref type="figure" target="#tab_1">Table 1</ref>). We simulated populations of effective size N e ¼ 1000 and N e ¼ 20 000 haploid individuals, and sampled all present-day individuals. While ARGON matches the prediction of<ref type="bibr" target="#b0">Bhaskar et al. (2014)</ref>in both exact and approximate mode, coalescent simulations substantially deviate from the DTWF model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Scalability to large sample size and wholechromosome length</head><p>We tested the run time and memory usage of ARGON and two recently developed programs that enable simulating very large sample sizes and long chromosomes: COSI2 and SCRM (see<ref type="figure">Table 2</ref>). We find that for large parameter values SCRM generally performs worse than ARGON. COSI2 is generally faster, but scales poorly for memory usage as the size of the region and the sample size grows. Additional tests, including a pre-release version of MSprime, are detailed in the Supplementary Materials. We further tested the performance of approximate algorithms for the same set of simulation parameters (see<ref type="figure">Table 2</ref>). We compared ARGON with a minimum recombination block size of 10 lm (AR 10 ), SCRM with the 'Àl' flag set to 0 (SC 0 ), and COSI2 with the 'Àu' flag<ref type="figure">Table 2</ref>. Comparison of simulation algorithms with respect to chromosome length (Mb), exponential expansion rate (q), sample size (n), and ancestral population size (A)Simulation parameters and setup are detailed in the Supplementary Materials. DTWF and coalescent algorithms: AR, ARGON; SC, SCRM; CS, COSI2; approximate algorithms: AR 10 , ARGON with minimum recombination block of size 10 lM; SC 0 , SCRM with; 'Àl' set to 0; CS 0 , COSI2 with 'Àu' set to 0; † represents runs terminated due to insufficient memory (&gt;60Gb) or a memory error; * indicates that the program took longer than 100 h to complete.Errors are obtained as 100 Â ðh s À h t Þ=h s , where h s is the average simulation result and h t is the theoretical expectation. The 6 sign introduces a SE. set to 0 (CS 0 ). We find that ARGON's speed and memory usage is substantially improved, at the cost of slightly inflated correlation for neighboring markers (see Supplementary Materials). For a constant population of size N e ¼ 20 000, for instance, squared correlation (r 2 ) of markers 0 to 50 Kb apart (using 1 cM/Mb) was increased by $27% for AR 10 , but remained unchanged for markers at a larger distance. For CS 0 and SC 0 , r 2 was decreased by $5% for markers at a larger distance. AR 10 is faster than SC 0 , and approximately as fast as CS 0 , and uses less memory than both simulators for the large values of the test parameters. Comparison to other simulators and additional tests are detailed in the Supplementary Materials.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Number of singleton and doubleton alleles when n ¼ N e. We simulated a region of 1 Mb, l ¼ 2 Â 10 À8 and 1 cM/Mb, where h s is the average simulation result and h t is the theoretical expectation. The 6 sign introduces a standard error</figDesc><table>n ¼ N e 
singletons % 
doubletons % 

MS 
20 000 
À10:8160:01 
þ4:8760:02 
ARGON 
20 000 
þ0:0160:01 
À0:0260:02 
ARGON 10 
20 000 
þ0:0060:01 
À0:0260:02 
MS 
1000 
À10:8060:05 
þ4:8060:09 
ARGON 
1000 
þ0:0360:05 
À0:1160:09 
ARGON 10 
1000 
þ0:0260:05 
þ0:1760:09 

</table></figure>

			<note place="foot" n="2"> Approach ARGON proceeds backwards in time one generation at a time, occasionally sampling coalescent and recombination events subject to V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 1–3 doi: 10.1093/bioinformatics/btw355 Advance Access Publication Date: 16 June 2016 Applications Note Bioinformatics Advance Access published July 19, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">P.F.Palamara at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Alkes L. Price and John Wakeley for useful discussions and comments on an early draft.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was supported by the National Institutes of Health (NIH) grant (R01 MH101244).</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Distortion of genealogical properties when the sample is very large</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bhaskar</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="page" from="2385" to="2390" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">On the dominance ratio</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Fisher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Royal Soc. Edinburgh</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page" from="321" to="341" />
			<date type="published" when="1922" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Generating samples under a Wright–Fisher neutral model of genetic variation</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="337" to="338" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">Efficient coalescent simulation and genealogical analysis for large sample sizes</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Kelleher</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="page">33118</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The coalescent. Stochastic Process</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">F C</forename>
				<surname>Kingman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Appl</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="235" to="248" />
			<date type="published" when="1982" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">GENOME: a rapid coalescent-based whole genome simulator</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Liang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1565" to="1567" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Approximating the coalescent with recombination</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">A T</forename>
				<surname>Mcvean</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">J</forename>
				<surname>Cardin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Philos. Trans. Royal Soc B Biol. Sci</title>
		<imprint>
			<biblScope unit="volume">360</biblScope>
			<biblScope unit="page" from="1387" to="1393" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Length distributions of identity by descent reveal fine-scale demographic history</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">F</forename>
				<surname>Palamara</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">91</biblScope>
			<biblScope unit="page" from="809" to="822" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Cosi2: An efficient simulator of exact and approximate coalescent with selection</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Shlyakhter</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="3427" to="3429" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">scrm: efficiently simulating long sequences using the approximated coalescent with recombination</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">R</forename>
				<surname>Staab</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="31" to="1680" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Gene genealogies when the sample size exceeds the effective size of the population</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Wakeley</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Takahashi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="208" to="213" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">The coalescent with gene conversion</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Wiuf</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Hein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">155</biblScope>
			<biblScope unit="page" from="451" to="462" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Evolution in Mendelian populations</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Wright</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page">97</biblScope>
			<date type="published" when="1931" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<monogr>
		<title level="m" type="main">whole-genome simulation of the discrete time Wright-fisher process</title>
		<author>
			<persName>
				<surname>Fast</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>