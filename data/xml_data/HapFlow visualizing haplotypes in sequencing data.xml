
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">HapFlow: visualizing haplotypes in sequencing data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Mitchell</forename>
								<forename type="middle">J</forename>
								<surname>Sullivan</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Faculty of Science</orgName>
								<orgName type="department" key="dep2">Health, Education and Engineering</orgName>
								<orgName type="institution">University of the Sunshine Coast</orgName>
								<address>
									<settlement>Sippy Downs</settlement>
									<country key="AU">Australia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nathan</forename>
								<forename type="middle">L</forename>
								<surname>Bachmann</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Faculty of Science</orgName>
								<orgName type="department" key="dep2">Health, Education and Engineering</orgName>
								<orgName type="institution">University of the Sunshine Coast</orgName>
								<address>
									<settlement>Sippy Downs</settlement>
									<country key="AU">Australia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Peter</forename>
								<surname>Timms</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Faculty of Science</orgName>
								<orgName type="department" key="dep2">Health, Education and Engineering</orgName>
								<orgName type="institution">University of the Sunshine Coast</orgName>
								<address>
									<settlement>Sippy Downs</settlement>
									<country key="AU">Australia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Adam</forename>
								<surname>Polkinghorne</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Faculty of Science</orgName>
								<orgName type="department" key="dep2">Health, Education and Engineering</orgName>
								<orgName type="institution">University of the Sunshine Coast</orgName>
								<address>
									<settlement>Sippy Downs</settlement>
									<country key="AU">Australia</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">HapFlow: visualizing haplotypes in sequencing data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv551</idno>
					<note type="submission">Received on May 31, 2015; revised on August 15, 2015; accepted on September 16, 2015</note>
					<note>Genome analysis *To whom correspondence should be addressed. Associate Editor: John Hancock Contact: apolking@usc.edu.au</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>HapFlow is a python application for visualizing haplotypes present in sequencing data. It identifies variant profiles present and reads and creates an abstract visual representation of these profiles to make haplotypes easier to identify. Availability and implementation: HapFlow is freely available (under a GPL license) for download (for Mac OS X, Unix and Microsoft Windows) from github</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The emergence of high-throughput sequencing has enabled new experimental approaches such as the sequencing of populations of bacteria. Infections frequently contain multiple strains of the same species (<ref type="bibr" target="#b3">Darch et al., 2015;</ref><ref type="bibr" target="#b11">Taylor et al., 1995</ref>). This has important implications for detecting transmission events (<ref type="bibr" target="#b0">Bachmann et al., 2015</ref>) and determining treatment outcomes (<ref type="bibr" target="#b1">Cohen et al., 2012</ref>). Several methods have been developed to analyze mixed-strain populations. ShoRAH (<ref type="bibr" target="#b12">Zagordi et al., 2011</ref>) reconstructs a minimal set of global haplotypes and estimates the frequency of inferred haplotypes. It requires variants be dense enough to be linked by overlapping reads. A two-step maximum likelihood approach has also been described to identify the portion of infection rising from dominant and minor strains (<ref type="bibr" target="#b4">Eyre et al., 2013</ref>). This approach does not rely on variant density but is unable to infer local or global haplotypes. A tool that visualizes haplotypes in sequencing data is needed to identify the best strategy for genomic analysis of multiple strains of the same bacteria within a sample. Many excellent read alignment visualization tools exist including Savant (<ref type="bibr" target="#b5">Fiume et al., 2010</ref>), Tablet (<ref type="bibr" target="#b10">Milne et al., 2010</ref>) and Consed (<ref type="bibr" target="#b7">Gordon and Green, 2013</ref>). These tools arrange reads in a linear fashion with each read represented as a line, or row of bases. This layout is satisfactory for identifying variants or misaligned reads, however, is not ideal for identifying haplotypes present in reads. Reads are packed tightly together making it difficult to determine whether distant variants are located on the same read pair. Additionally, reads are not grouped by haplotype making it difficult to identify how frequently a haplotype is represented in the sequencing data. HapFlow addresses these problem by abstracting read alignment data to make the haplotypes present easier to identify. HapFlow can be used to help identify sequencing artifacts, identify the minimum number of strains present in a sample and determine whether defining local or global haplotypes is possible using sequence data alone. file, where each 'flow' is a unique allele profile and a count of the reads with that profile. Flows are then assigned to groups. If all overlapping alleles of a flow are in consensus with a previously defined group, it is assigned to that group. Otherwise, it is assigned a new group number. These groups are used to colour flows when visualized. When multiple chromosomes are present in a BAM file, the user is prompted to select which chromosome to create a flow file for. A complete description of the flow file is included in the manual. HapFlow-viewer displays the created flow file on the canvas of the GUI. A blue bar at the top of the screen represents the genome, an orange rectangle within the blue bar represents the portion of the genome currently being displayed. Underneath, an orange bar with vertical lines represents where the variants are located within the displayed section of the genome. These lines are extended below and spaced an equal distance apart in the area where the flows are viewed. At each variant, each flow covering the given variant is represented by an arrow, with the width of the arrow representing the number of reads the flow contains. The arrows representing each flow at adjacent variants are joined by lines, with solid lines representing variants covered by the same read of the flow and dashed lines representing variants covered by different reads in the pair. Arrows grouped at the top of the canvas represent the most frequently observed allele, the second group of flows represents the second most common allele and so on. The last group represents alleles not identified in the VCF file. This can be caused by potential sequencing, alignment or variant calling errors. All flows in a group are coloured using the same hue; saturation and lightness are randomly assigned. Information about the sequence of each variant is represented underneath the flows. The canvas is scrollable and zoomable allowing the user to easily navigate through whole genomes. Reads can then be separated into individual BAM files by selecting individual flows or group of flows, or by selecting all reads that conform to a user defined haplotype profile.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Case study</head><p>To demonstrate the application of HapFlow, reads from the recent sequencing of a Chlamydia pecorum PCR-positive swab sample collected from the urogenital tract of a koala with mixed C. pecorum infections were analyzed. C. pecorum DNA was extracted directly from the host cell contaminants using Sure-Select RNA probes and sequenced using an Illumina Hi-Seq to produce 101 bp paired-end reads, as previously described (<ref type="bibr" target="#b0">Bachmann et al., 2015</ref>). These reads were then mapped back to a publicly available C. pecorum reference (E58) strain's genome using Bowtie 2 (<ref type="bibr" target="#b9">Langmead and Salzberg, 2012</ref>). Variant calling was performed using FreeBayes (<ref type="bibr" target="#b6">Garrison and Marth, 2012</ref>) and the resulting data was visualized using HapFlow. Two distinct strains were immediately identifiable in the HapFlow diagram. Variants are also close enough that local haplotypes can be inferred from read data. Importantly, several regions where read coverage in the dominant strain dropped below that of the minor strain were identified (<ref type="figure">Fig. 1</ref>). This was not unexpected as sequence capture is less efficient at cazpturing DNA in areas where the sequence of the strain varies significantly from the probe. This meant that any method of consensus calling that uses a majority call would result in a chimeric genome not representative of either strain. These insights can help with the design of an automated approach for assigning reads to strains. Alternatively, reads can be manually separated using HapFlow.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was financially supported by an Australian Research Council Discovery Grant (DP130102066) and a Queensland Department of Environment and Heritage Protection Koala Research Grant (KRG18) awarded to AP and PT. Conflict of Interest: none declared.<ref type="figure">Fig. 1</ref>. HapFlow diagram of sequencing data from a urogenital tract infection in a Koala mapped to C. pecorum. Flows containing only the dominant variant group at the top, flows containing only the minor variant group at the in the second row, mixed flows switch between top and middle. The bottom row indicates flows containing an alignment or sequencing error. All reads with the most common variant at base 363,598 have the least common variant at base 363,732, similarly all reads with the least common variant at site base 363,598 have the most common variant at base 363,732. This pattern is repeated at sites C and D</p></div>
			<note place="foot" n="2"> Implementation HapFlow is a Python tool that uses the Tkinter windows system (https://wiki.python.org/moin/TkInter). It has been designed for bacterial sequencing datasets of all sizes that use short, paired-end or single-end reads. HapFlow is available as both a Python script and as a binary for Linux, OSX and Windows. It contains two parts: HapFlow-generator, a process for creating a flow file which contains the count of reads with each haplotype profile and HapFlow-viewer, a tool for visualizing the flow file. HapFlow-generator can be executed from the GUI or the command-line. It takes a VCF file (Danecek et al., 2011) of called variants and an indexed BAM file (Li et al., 2009) of aligned reads as input. Pysam (github.com/pysam-developers/pysam) is used to create a profile of alleles present in each read of the alignment. This profile consists of which allele is present at each variant the read aligns to, on which pair each allele is present and the direction of the read. A list of &apos;flows&apos; is then written to the flow V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 441 Bioinformatics, 32(3), 2016, 441–443 doi: 10.1093/bioinformatics/btv551 Advance Access Publication Date: 7 October 2015 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">M.J.Sullivan et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Culture-independent genome sequencing of clinical samples reveals an unexpected heterogeneity of infections by Chlamydia pecorum</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">L</forename>
				<surname>Bachmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Clin. Microbiol</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="1573" to="1581" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Mixed-strain mycobacterium tuberculosis infections and the implications for tuberculosis treatment and control</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Cohen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clin. Microb. Rev</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="708" to="719" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">The variant call format and VCFtools</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Danecek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2156" to="2158" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Recombination is a key driver of genomic and phenotypic diversity in a Pseudomonas aeruginosa population during cystic fibrosis infection</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">E</forename>
				<surname>Darch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Rep</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">7549</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Detection of mixed infection from bacterial whole genome sequence data allows assessment of its role in Clostridium difficile transmission</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">W</forename>
				<surname>Eyre</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">1003059</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Savant: genome browser for high-throughput sequencing data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Fiume</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="1938" to="1944" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<monogr>
		<title level="m" type="main">Haplotype-based variant detection from short read sequencing. arXiv preprint</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Garrison</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Marth</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Consed: a graphical editor for nextgeneration sequencing</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Gordon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Green</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2936" to="2937" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Fast gapped-read alignment with Bowtie 2</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">L</forename>
				<surname>Salzberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="357" to="359" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Tablet—next generation sequence assembly visualization</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Milne</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="401" to="402" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Long-term colonization with single and multiple strains of Helicobacter pylori assessed by DNA fingerprinting</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">S</forename>
				<surname>Taylor</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Clin. Microbiol</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="918" to="923" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Zagordi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">119</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">HapFlow</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>