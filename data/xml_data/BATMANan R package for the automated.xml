
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:51+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Systems biology BATMAN—an R package for the automated quantification of metabolites from nuclear magnetic resonance spectra using a Bayesian model</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">. 15 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jie</forename>
								<surname>Hao</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Section of Biomolecular Medicine</orgName>
								<orgName type="department" key="dep2">Department of Surgery and Cancer</orgName>
								<orgName type="department" key="dep3">Faculty of Medicine</orgName>
								<orgName type="institution">Imperial College London</orgName>
								<address>
									<addrLine>Sir Alexander Fleming Building</addrLine>
									<postCode>SW7 2AZ</postCode>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">William</forename>
								<surname>Astle</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Epidemiology, Biostatistics and Occupational Health</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<addrLine>Purvis Hall, 1020 Ave. des Pins Ouest</addrLine>
									<postCode>H3A 1A2</postCode>
									<settlement>Montréal</settlement>
									<region>Québec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Maria</forename>
								<surname>De Iorio</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Statistical Science</orgName>
								<orgName type="institution">University College</orgName>
								<address>
									<addrLine>Gower Street</addrLine>
									<postCode>WC1E 6BT</postCode>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Timothy</forename>
								<forename type="middle">M D</forename>
								<surname>Ebbels</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Section of Biomolecular Medicine</orgName>
								<orgName type="department" key="dep2">Department of Surgery and Cancer</orgName>
								<orgName type="department" key="dep3">Faculty of Medicine</orgName>
								<orgName type="institution">Imperial College London</orgName>
								<address>
									<addrLine>Sir Alexander Fleming Building</addrLine>
									<postCode>SW7 2AZ</postCode>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Systems biology BATMAN—an R package for the automated quantification of metabolites from nuclear magnetic resonance spectra using a Bayesian model</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="2088" to="2090"/>
							<date type="published" when="2012">. 15 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts308</idno>
					<note type="submission">Received on January 24, 2012; revised on May 15, 2012; accepted on May 18, 2012</note>
					<note>Copyedited by: SK MANUSCRIPT CATEGORY: APPLICATIONS NOTE [14:59 18/3/2013 Bioinformatics-bts308.tex] Page: 2088 2088–2090 Associate Editor: Olga Troyanskaya</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Nuclear Magnetic Resonance (NMR) spectra are widely used in metabolomics to obtain metabolite profiles in complex biological mixtures. Common methods used to assign and estimate concentrations of metabolites involve either an expert manual peak fitting or extra pre-processing steps, such as peak alignment and binning. Peak fitting is very time consuming and is subject to human error. Conversely, alignment and binning can introduce artefacts and limit immediate biological interpretation of models. Results: We present the Bayesian automated metabolite analyser for NMR spectra (BATMAN), an R package that deconvolutes peaks from one-dimensional NMR spectra, automatically assigns them to specific metabolites from a target list and obtains concentration estimates. The Bayesian model incorporates information on characteristic peak patterns of metabolites and is able to account for shifts in the position of peaks commonly seen in NMR spectra of biological samples. It applies a Markov chain Monte Carlo algorithm to sample from a joint posterior distribution of the model parameters and obtains concentration estimates with reduced error compared with conventional numerical integration and comparable to manual deconvolution by experienced spectroscopists. Availability and implementation</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ABSTRACT</head><p>Motivation: Nuclear Magnetic Resonance (NMR) spectra are widely used in metabolomics to obtain metabolite profiles in complex biological mixtures. Common methods used to assign and estimate concentrations of metabolites involve either an expert manual peak fitting or extra pre-processing steps, such as peak alignment and binning. Peak fitting is very time consuming and is subject to human error. Conversely, alignment and binning can introduce artefacts and limit immediate biological interpretation of models. Results: We present the Bayesian automated metabolite analyser for NMR spectra (BATMAN), an R package that deconvolutes peaks from one-dimensional NMR spectra, automatically assigns them to specific metabolites from a target list and obtains concentration estimates. The Bayesian model incorporates information on characteristic peak patterns of metabolites and is able to account for shifts in the position of peaks commonly seen in NMR spectra of biological samples. It applies a Markov chain Monte Carlo algorithm to sample from a joint posterior distribution of the model parameters and obtains concentration estimates with reduced error compared with conventional numerical integration and comparable to manual deconvolution by experienced spectroscopists.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Nuclear Magnetic Resonance (NMR) spectroscopy is widely used in metabolomics to provide information on metabolite profiles of complex biological mixtures, such as biofluids or tissue samples. These spectra commonly contain around a thousand peaks from possibly hundreds of metabolites. The concentrations of metabolites are useful in biomarker discovery, investigating the aetiology of disease and in understanding fundamental biological processes. Quantitative measurement of metabolite abundances from NMR spectra is complicated due to shifting peak positions, peak overlap, noise and effects of the biological matrix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>An NMR spectrum, y, can be considered as a linear combination of metabolite peaks plus noise. Metabolite peaks can be labelled catalogued or uncatalogued, according to whether their characteristic peak patterns are known to the user. We propose a two-component joint model for the catalogued y c and uncatalogued y u metabolites as follows:</p><formula>y = y c +y u +ε, ε ∼ N(0,I/λ),</formula><formula>(1)</formula><p>where I is the identity matrix and λ is a scalar precision parameter. The signal from the catalogued metabolites, y c , can be modelled as a weighted summation of M metabolite templates</p><formula>y c = M m=1 u t mu (σ mu )β m , (2)</formula><p>where vector t mu is a template spectrum of the uth multiplet belonging to the mth metabolite, σ mu is the chemical shift parameter for the corresponding multiplet and β m is proportional to the concentration of the mth metabolite. The priors for σ mu and β m are truncated normal distributions. The template spectrum, t mu , in turn is generated as a weighted summation of Lorentzian peaks. By default, BATMAN obtains this prior information on the peak pattern from the Human Metabolome Database (<ref type="bibr">Wishart et al., 2009</ref>). We model the Lorentzian peak width</p><formula>γ m as ln(γ m ) = μ+ν m ,</formula><formula>(3)</formula><p>Copyedited by: SKwhere μ represents the spectrum wide average and ν m is a random effect, representing metabolite specific deviations from μ. Our priors for μ and ν m are both Gaussian. Signal generated by uncatalogued metabolites, y u , is modelled as a linear combination of wavelet basis functions (W). This alleviates difficulties associated with the incompleteness of the spectral library that can influence other methods (<ref type="bibr">Mercier et al., 2011</ref>). A probability density model is specified in the wavelet domain of the data, i.e. θ ≡W y u. We use symlet-6 wavelet basis functions as they are well suited to modelling Lorentzian peaks (<ref type="bibr" target="#b0">Astle et al., 2012</ref>). The distribution of θ is modelled by a truncated Gaussian, whose parameters are specified by the parameters λ, ψ and τ. The hyperparameter vector ψ ∼ Gamma(c,d/2) allows the prior precision associated with each wavelet deviate from the global precision λ ∼ Gamma(a,b/2). τ is a truncation limit vector where each τ i has a Gaussian distribution left truncated at a small negative value h.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Automated quantification of metabolites</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">IMPLEMENTATION</head><p>A Markov Chain Monte Carlo (MCMC) algorithm is proposed to sample from the joint posterior distribution of the model parameters. We temper the likelihood and penalize the wavelet component of the model stringently to move the chain into a region of good posterior support in the burn in stage of the MCMC. We introduce block updates for β jointly with θ, and for σ mu jointly with θ to allow the chain to make global moves. The details are described in<ref type="bibr" target="#b0">Astle et al. (2012)</ref>. Adaptation techniques are used to update the peak shift σ mu and width parameters γ m. The core algorithm is implemented in C++ language with support for parallel processing between spectra to improve the processing speed. R version 2.12.1 (or higher), together with the R packages described in the documentation, is required. BATMAN runs on Windows, Mac OS X and Linux/Unix operating systems and supports text file, R data format and 1D</p><p>Bruker spectral data files as input. Processing 8 spectra on an Intel 3.0GHz Quad-Core 2 processor machine with 11 catalogued metabolites region from 2.3 to 4.1 ppm took approximately 22 min. The MCMC procedure ran for 2000 iterations following a 4000 iteration burn in. The time required scales linearly with the number both of metabolites and spectra (on a multicore machine, multiple spectra can be analysed in parallel with the same run time as a single spectrum analysis).<ref type="figure" target="#fig_1">Figure 1</ref>shows an example result of a BATMAN fit of a 1 H NMR spectrum of normal rat urine. The catalogued metabolite peaks are correctly fit by the algorithm, with uncatalogued peaks absorbed by the wavelet component. The unimodality of peak position and concentration distributions indicate no ambiguity in the assignments. The BATMAN deconvolution has been shown to have reduced mean estimation error compared with conventional numerical integration methods and its results on an example dataset fitting 26 metabolites are comparable with the manual deconvolution by five experienced NMR spectroscopists as described by<ref type="bibr" target="#b0">Astle et al. (2012)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>Availability and implementation: http://www1.imperial.ac.uk/ medicine/people/t.ebbels/ Contact: t.ebbels@imperial.ac.uk Received on January 24, 2012; revised on May 15, 2012; accepted on May 18, 2012</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Typical BATMAN result on a 1 H NMR spectrum of rat urine. (a) Mean posterior fit (inset: zoom for 3.25–3.29 ppm). (b) Posterior distribution of chemical shift difference from catalogued position for multiplets of hippuric acid and dimethylamine. (c) Posterior distribution of relative concentration for the two metabolites</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>Funding: This work was funded by grant BB/E020372/1 from the UK Biotechnology and Biological Sciences Research Council (BBSRC). Conflict of Interest: none declared.</figDesc></figure>

			<note place="foot">* To whom correspondence should be addressed. Excellent solutions to manual peak fitting exist (Weljie et al., 2006); however, this option is time consuming and is subject to human error and bias (Tredwell et al., 2011). The R package BQuant (Zheng et al., 2011) attempts to quantify metabolites from NMR spectra using Bayesian model selection. However, it is a two-step procedure that requires spectra to be pre-aligned and partitioned into bins. Consequently, it is awkward to apply as it is not fully automated. Peak shifts are not incorporated into the statistical model, which may lead to suboptimal estimates of metabolite concentrations, especially in crowded regions. Herein, we present the R package Bayesian automated metabolite analyser for NMR spectra (BATMAN) that implements a Bayesian model for 1 H NMR spectra (Astle et al., 2012) and a Markov chain Monte Carlo (MCMC) algorithm to automate metabolite quantification from NMR spectral data. BATMAN is able to automatically assign peaks to metabolites given a target metabolite list and chemical shift region(s) specified by the user.</note>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A Bayesian model of NMR spectra for the deconvolution and quantification of metabolites in complex biological mixtures, in press. The accepted version can be found at http://arxiv</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Astle</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Stat. Assoc</title>
		<imprint>
			<biblScope unit="page">2204</biblScope>
			<date type="published" when="1105" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>