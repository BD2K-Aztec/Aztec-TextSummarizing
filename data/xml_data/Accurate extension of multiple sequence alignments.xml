
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:49+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">. 13 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Ari</forename>
								<surname>Löytynoja</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">EMBL-European Bioinformatics Institute</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institute of Biotechnology</orgName>
								<address>
									<postCode>00014</postCode>
									<country key="FI">Finland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Albert</forename>
								<forename type="middle">J</forename>
								<surname>Vilella</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">EMBL-European Bioinformatics Institute</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nick</forename>
								<surname>Goldman</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">EMBL-European Bioinformatics Institute</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="1684" to="1691"/>
							<date type="published" when="2012">. 13 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts198</idno>
					<note type="submission">Sequence analysis Advance Access publication April 23, 2012 Received on January 5, 2012; revised on April 13, 2012; accepted on April 16, 2012</note>
					<note>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [16:07 19/6/2012 Bioinformatics-bts198.tex] Page: 1684 1684–1691 Associate Editor: David Posada/p/pagan-msa. Contact: ari.loytynoja@helsinki.fi Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Accurate alignment of large numbers of sequences is demanding and the computational burden is further increased by downstream analyses depending on these alignments. With the abundance of sequence data, an integrative approach of adding new sequences to existing alignments without their full re-computation and maintaining the relative matching of existing sequences is an attractive option. Another current challenge is the extension of reference alignments with fragmented sequences, as those coming from next-generation metagenomics, that contain relatively little information. Widely used methods for alignment extension are based on profile representation of reference sequences. These do not incorporate and use phylogenetic information and are affected by the composition of the reference alignment and the phylogenetic positions of query sequences. Results: We have developed a method for phylogeny-aware alignment of partial-order sequence graphs and apply it here to the extension of alignments with new data. Our new method, called PAGAN, infers ancestral sequences for the reference alignment and adds new sequences in their phylogenetic context, either to predefined positions or by finding the best placement for sequences of unknown origin. Unlike profile-based alternatives, PAGAN considers the phylogenetic relatedness of the sequences and is not affected by inclusion of more diverged sequences in the reference set. Our analyses show that PAGAN outperforms alternative methods for alignment extension and provides superior accuracy for both DNA and protein data, the improvement being especially large for fragmented sequences. Moreover, PAGAN-generated alignments of noisy next-generation sequencing (NGS) sequences are accurate enough for the use of RNA-seq data in evolutionary analyses. Availability: PAGAN is written in C++, licensed under the GPL and its source code is available at http://cran.r-project.org/web/packages/GMD/
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Sequence alignment has numerous applications but its role is especially central in evolutionary analyses of molecular sequences. * To whom correspondence should be addressed.</p><p>These inferences are based on the identities and differences detected between homologous characters and errors in these homology statements, that is errors in the alignment of the sequences, are likely to lead to errors in any downstream analyses. The generation of high-quality alignments can be computationally laborious and the solutions often require manual assessment or editing. When such alignments need to be extended, e.g. after new sequences become available, it may be preferable to keep the relative alignment of existing sequences intact and have the new sequences aligned to this reference alignment. Such addition of sequences should take into account the evolutionary relationships of all the sequences and be performed in the correct phylogenetic context. Alignment extension has interesting applications in the analyses of next-generation sequencing (NGS) data. Fast profile-based methods have been used for the alignment of metagenomic sequence reads of unknown origin against a set of reference sequences in phylogenetic placement studies (<ref type="bibr" target="#b18">Matsen et al., 2010;</ref><ref type="bibr" target="#b25">Stark et al., 2010</ref>). These do not use all information available in the data, however, and flatten the reference alignment into a consensus profile that only models conserved regions shared by most sequences. On the other hand, existing read placement methods based on phylogenyaware alignment (<ref type="bibr" target="#b0">Berger et al., 2011</ref>) handle the query sequences separately and delete sites inferred as insertions, limiting their use to phylogenetic placement only. Accurate alignment of complete NGS reads is of interest e.g. in analyses of RNA-seq data that come nearly exclusively from the gene regions of the genomes. With appropriate handling of short and noisy reads, RNA-seq data allow for inexpensive large-scale comparative studies of proteincoding genes, such as inferences of selection (<ref type="bibr" target="#b26">Yang et al., 2000</ref>), and extend the use of NGS methods to evolutionary analyses of non-model organisms (e.g. http://www.onekp.com). Popular progressive alignment programs (e.g.<ref type="bibr" target="#b9">Katoh et al., 2002;</ref><ref type="bibr" target="#b11">Larkin et al., 2007</ref>) indirectly exploit the connection between alignment and phylogeny (<ref type="bibr" target="#b21">Sankoff, 1975</ref>) as they divide the computationally intractable multiple alignment problem into many pairwise tasks. Yet, they ignore the phylogeny during the remainder of the alignment process and produce alignments whose gap patterns are not evolutionarily meaningful (<ref type="bibr" target="#b14">Löytynoja and Goldman, 2008</ref>). We showed earlier that phylogenetic information can be used to distinguish insertions from deletions and these two very different mutation events can then be treated correctly in the progressive alignment (<ref type="bibr" target="#b13">Löytynoja and Goldman, 2005</ref>). The phylogeny-aware algorithm based on these ideas and implemented in the program PRANK performs very well in evolutionary alignment comparisons (<ref type="bibr" target="#b2">Dessimoz and Gil, 2010;</ref><ref type="bibr" target="#b5">Fletcher and Yang, 2010;</ref><ref type="bibr" target="#b8">Jordan and Goldman, 2012;</ref><ref type="bibr" target="#b16">Markova-Raina and Petrov, 2011</ref>).The first alignment creates graph X to represent the inferred ancestor of A and B. In X, the character state of vertex 5 is Y, representing both pyrimidines, and has two incoming edges, from vertices 2 and 4, to indicate that the presence of vertices 3 and 4 is uncertain.</p><formula>(a) (b) (c)</formula><formula>(c)</formula><p>The optimal alignment path for graphs X and C jumps from vertex 2 in graph X to vertex 5 using the direct connecting edge; the edges flanking the skipped-over fragment are recorded as unused (asterisks)</p><p>Here, we outline a new general-purpose method for phylogenyaware alignment of sequence graphs and apply it to phylogenetic extension of existing alignments. Our method, called PAGAN, is based on the same principle as PRANK and uses evolutionary information to distinguish insertions from deletions. In contrast to the greedy insertion-calling of the original approach, sequence graphs provide a flexible framework to model the phylogenetic evidence from related sequences and allow building a robust progressive aligner that tolerates errors in the guide phylogeny. The idea of using graphs to represent a sequence alignment is old (<ref type="bibr" target="#b10">Kruskal and Sankoff, 1983</ref>) and has been revisited regularly (<ref type="bibr" target="#b7">Hein, 1989;</ref><ref type="bibr" target="#b12">Lee et al., 2002;</ref><ref type="bibr" target="#b20">Paten et al., 2008</ref>). Our approach has similarities to earlier methods for global alignment of multiple sequences, especially the tree alignment method (<ref type="bibr" target="#b7">Hein, 1989</ref>) and the sequence representation with partial-order graphs (<ref type="bibr" target="#b12">Lee et al., 2002</ref>), but differs from these in its emphasis on phylogenetic calling of insertion and deletion events. The key advantage of our graph representation of sequences is the ability to describe uncertainty regarding the presence of characters at certain sequence positions. This is beneficial during the progressive alignment of sequences (<ref type="figure" target="#fig_0">Fig. 1</ref>) but it can also be used to represent uncertainties in unaligned sequences or in the inferred ancestral sequences. As our approach considers all sequences as graphs that can be aligned against each other, it is easily extended to the placement of new sequences into existing reference alignments. Unlike most existing methods based on consensus sequence profiles, our approach correctly considers the phylogenetic context as it aligns new sequences against inferred ancestors. Moreover, it can add multiple related sequences to specific positions in the tree and thus correctly accounts for their relatedness and shared insertion and deletion events (<ref type="figure" target="#fig_1">Fig. 2</ref>).sequences, assumed to come from the species shown in red, to the same target node in a progressive manner. It reconstructs sequence graphs to represent the ancestral nodes and aligns the new sequences against the ancestor of their sister clade, indicated by X. Each alignment of a sequence, r n , creates a new parent node, p n , against which the next sequence is aligned. After finishing the alignment, the sub-tree with the new sequences is inserted back to the tree structure</p><p>We tested PAGAN in the extension of real reference alignments with new protein and DNA sequences and found that it can successfully handle data of great variety in length and evolutionary divergence as well as different sizes of reference alignments. The accuracy of alignment cannot be tested with real data so we simulated datasets representing gene families of closely related paralogues. We used PAGAN to extend both protein and DNA reference alignments with new data and compared its performance with that of alternative extension approaches. To test larger problems, we used PAGAN and the best alternative method, hmmalign (<ref type="bibr" target="#b3">Eddy, 2011</ref>), for a re-analysis of metagenomic data of<ref type="bibr" target="#b19">Mirarab et al. (2012)</ref>consisting of reference alignments of 500 sequences and addition of 5000 sequence fragments. Finally, we quantified the effects of different factors on alignment accuracy and compared PAGAN and hmmalign under a simplified setup that allowed changing the different parameters independently. Our results show that PAGAN produces exceptionally accurate alignments and its phylogenetic approach can efficiently use the evolutionary information available while remaining unimpaired by more distantly related sequences in the reference alignment.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>In the following sections we first describe the main concepts of our new method for phylogenetic alignment and placement of sequences using partialorder graphs. We then outline how we apply this method, called PAGAN, in the extension of DNA and protein alignments with new sequences and compare its performance with existing methods. Finally, we dissect in more detail the impact of the reference alignment and the query sequence on the performance of the best performing methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Phylogeny-aware graph alignment algorithm</head><p>The conversion of a regular sequence to a graph is trivial (Supplementary<ref type="figure" target="#fig_0">Fig. S1a</ref>) and two such graphs could be aligned with a standard dynamicprogramming algorithm. Partial-order graphs can represent more than a sequence of characters, however, and allow modelling of e.g. evolutionary units of multiple characters, non-linear dependencies among the characters and uncertainties in the input data (Supplementary Figs S1 and S2). The representation of sequences with graphs is especially attractive in progressive alignment that attempts to backtrack the tree-like hierarchical structure of relatedness among a set of sequences (<ref type="bibr" target="#b15">Löytynoja and Goldman, 2009</ref>). Each alignment clusters two sister nodes, representing either single</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.Löytynoja et al.</head><p>sequences or previous alignments, and defines a new node to represent this pairwise solution. The challenge of progressive alignment is that insertions cannot be distinguished from deletions at the time of aligning a pair of sequences but failing to account for their different properties is likely to cause alignment error (<ref type="bibr" target="#b14">Löytynoja and Goldman, 2008</ref>). A graph can describe this uncertainty regarding the type of mutation event with edges that connect vertices, representing characters in a sequence, to multiple preceding vertices; each edge is a hypothesis of the true structure of the ancestral sequence (<ref type="figure" target="#fig_0">Fig. 1</ref>and Supplementary<ref type="figure" target="#fig_3">Fig. S3</ref>). Our new method, PAGAN, follows the ideas we implemented earlier in program PRANK (<ref type="bibr" target="#b13">Löytynoja and Goldman, 2005</ref>) and uses phylogenetic information to distinguish insertions from deletions. However, instead of calling insertions based on one outgroup alignment only, PAGAN assigns weights to the graph edges—either skipping a deletion or connecting an insertion to the rest of the graph—and adjusts them according to the evolutionary evidence. The algorithm for the alignment of two graphs and reconstruction of a new graph to represent this alignment is given in the Supplementary Material. The algorithm differs from the standard algorithm (<ref type="bibr" target="#b6">Gotoh, 1982</ref>) in two aspects: it incorporates edge weights into the alignment cost; and, in the dynamicprogramming computation, it chooses a move to the current state (match or two types of gaps) not only from the possible preceding states but also from all preceding cells connected to the current cell by incoming edges. The scoring function of PAGAN follows that of PRANK. Assuming that chr(x i ) gives the character associated to a vertex i of graph x, the score for matching characters at vertices x i and y j is:</p><formula>sco(x i ,y j ) = log q z P(chr(x i ), chr(y j ); t ) q(chr(x i ))q(chr(y j ))</formula><formula>(1)</formula><p>where q(a) is the frequency of a, q z = (q(chr(x i ))+q(chr(y j )))/2, and P(a,b;t) is the substitution probability between characters a and b given the evolutionary distance t and the substitution model. A notable difference to the standard score is the additional term q z , discussed in more detail in the Supplementary Material. As a further simplification, PAGAN uses weighted parsimony reconstruction of ancestral characters states and, for greater speed, the number of alternative character states for amino acid and codon data is limited to two (see Supplementary Material). PAGAN can reconstruct ancestral sequences for an existing alignment and then extend that by aligning new sequences against the extant or inferred ancestral sequences. The reconstruction of ancestral sequence graphs for a reference alignment is not different from the de novo alignment except that the alignment solution is read from the input data. The addition of new sequences should be performed in their correct phylogenetic context: while PAGAN allows the user to define or constrain the possible phylogenetic positions for sequences coming from a known origin, it can also search for the optimal placement for unknown data. During the extension, PAGAN takes the target nodes, represented by sequence graphs, out of the tree structure and aligns the sequences assigned to each target using a progressive algorithm (<ref type="figure" target="#fig_1">Fig. 2</ref>). With data from mixed sources, the sequences for each target node can be aligned in a ranked order; on the other hand, the graph representation of reconstructed sequences tolerates inconsistencies between subsequent alignments and the algorithm can resolve conflicting gap patterns among a set of diverged sequences. Once finished, the extended sub-tree is put back to the alignment tree structure, the reference alignment is adjusted for insertions in the new sequences, and the process moves to the next node. In this article, we focus on the extension of existing alignments with new sequences and phylogenetic placement of sequences. We test two approaches to decide the location for the new sequences, either 'guided' or 'free'. The guided approach assumes that the approximate phylogenetic position of the query sequences is known and only the correct paralogue, if multiple exist, has to be resolved. The free approach is unsupervised and, in this study, is based on the use of an external local aligner to find the target node. The additional features implemented in PAGAN are explained in detail in the Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Comparison of methods for alignment extension</head><p>The test data for alignment extension were simulated using phylogenetic trees based on the Ensembl/UCSC tree (http://tinyurl.com/ensembltree;<ref type="figure" target="#fig_3">Fig. 3a</ref>). Three simulation trees representing different levels of evolutionary divergence, called EnsTr1, EnsTr2 and EnsTr3, were created by multiplying the branch lengths by 1.5, 2.0 and 2.5. The alignment simulator INDELible (<ref type="bibr" target="#b4">Fletcher and Yang, 2009</ref>) was used to generate codon sequences (see Supplementary Material for details) and the resulting data were analyzed both as DNA and protein. For EnsTr1, EnsTr2 and EnsTr3, respectively, the alignments were in average 1489, 1800 and 2151 codons long; the base/amino acid identity between human and Primate was 89–90, 86–87 and 84–85% and between mouse and Rodent it was 80, 75–76 and 70–73%. The sequences for the hypothetical target species, Primate and Rodent, were removed from the simulated alignments and the rest of the aligned sequences were used as the reference alignment (RA). Of the sequences for the target species, 50 fragments of the given length were sampled from each and considered as the set of query sequences (QSs) to be aligned to the RA. We used fragment lengths of 30, 60 and 120 bases/amino acids as well as the original full-length sequences. To understand the impact of fragmented information and sequencing error on the alignment accuracy, we introduced NGS-like noise in the DNA fragment data (<ref type="bibr">Massingham and Goldman, 2012</ref>). Two of the methods need a reference tree (RT) for the alignment extension: for those we used the true simulation tree and a tree inferred with RAxML (<ref type="bibr" target="#b24">Stamatakis, 2006</ref>) using Ornithorhynchus anatinus (platypus) as the outgroup; the results were indistinguishable and the ones with the estimated tree are shown. The details of the methods and options used for the alignment are found in the Supplementary Material. The accuracy of the resulting extended alignment was measured as the proportion of true homologies recovered between the QS and the closest human/mouse reference sequence. False homologies were not penalized and correctness of insertions inferred were not measured. The reported values are the mean accuracies over the 5000 aligned fragments (lengths 30, 60 and 120; 100 replicates, 50 fragments per sequence) or over the 100 full-length sequences for each target species paralogue.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Extension of large alignments</head><p>We downloaded the simulated test data of<ref type="bibr" target="#b19">Mirarab et al. (2012)</ref>and analyzed the first ten replicates of the three different evolutionary scenarios. We used true simulated reference alignments and reference trees with RAxMLestimated branch lengths. We extended these alignments with the 5000 query sequences using PAGAN's experimental heuristics to quickly assign the queries to target nodes. These heuristics perform Exonerate local alignments (<ref type="bibr" target="#b23">Slater and Birney, 2005</ref>) between the 5000 query sequences and 999 target sequences, the latter including extant sequences from the reference alignment and PAGAN-inferred ancestral sequences. The queries were assigned to their best-scoring target nodes and those not producing significant hits were discarded. We also aligned the same datasets with hmmalign from the HMMER package (<ref type="bibr" target="#b3">Eddy, 2011</ref>): for that, the model was based on the full reference alignment and default options were used. More details can be found in the Supplementary Material. The accuracy of the resulting extended alignment was measured as above except that each QS was compared with the closest reference sequence.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Impact of reference alignment</head><p>The impact of the RA composition on the accuracy of alignment extension was tested using the two best-performing methods from the first set of tests (see Section 3), PAGAN and hmmalign. The data were simulated using ultrametric trees that differed in the following parameters: (i) position of the QS; (ii) size of the ingroup; (iii) evolutionary divergence; and (iv) (for hmmalign) size of the outgroup. The simulation trees consisted of three 32sequence sub-trees with one additional query sequence placed at different positions within the central subgroup (<ref type="figure" target="#fig_3">Fig. 3b</ref>and c). We call these basic topologies 'close', 'intermediate' and 'distant' and their ingroup (the centralThe ingroup of two other topologies have 'large' ingroup but 'intermediate' and 'distant' QSs (top). Three additional sets of reference alignments with 'small' ingroup are created by reducing the central sub-tree to two sequences (bottom). Full reference alignments are used with PAGAN; hmmalign analyses are performed with full sets of sequences ('full': 96 or 66 sequences) or just the central subgroup ('clade': 32 or 2 sequences). The target node for PAGAN is indicated with a red dot subgroup most closely related to the query) 'large'. To study the effect of reduced phylogenetic information in the RA, further datasets were created with the ingroup cut down to two maximally divergent sequences. These three topologies are subsets of the full topologies but have 'small' ingroups. As the profile hidden Markov models (HMMs) of HMMER are affected by more distantly related reference sequences, we created six further sets of RA by keeping only the ingroup (either 2 or 32) sequences. In distinction to the 'full' sets, these sets are called 'clade'. To mimic analyses of RNA-seq data, we again simulated protein-coding data and added NGS-like noise in the QS. The simulation was repeated for tree depths of 0.30, 0.45 or 0.60 substitutions/codon with 50 replicates for each combination of tree topology and branch length. The average length of trees estimated from the full 96sequence RA were (all lengths as substitutions/nucleotide site) 3.14, 4.70 and 6.25 for the three levels of evolutionary divergence and those of their leaf branches were 0.016, 0.025 and 0.033, respectively. The length of the branch leading to the query was (for 'close', 'intermediate' and 'distant') 0.020, 0.053 and 0.085 for the tree depth of 0.30; 0.029, 0.077 and 0.127 for the tree depth of 0.45; and 0.036, 0.102 and 0.167 for the tree depth of 0.60. To mimic common practice used in metagenomic studies, the short-read simulator simNGS (<ref type="bibr">Massingham and Goldman, 2012</ref>) was used to create NGS data with target fragment length of 181 bases (fragments under 130 bases excluded), 5× coverage and 125-base pair-end reads. This gave 74– 76 reads for each RA with realistic noise in base call accuracy. To assess the effect of alignment error in the RA, the sequences were re-aligned with PAGAN and MAFFT (<ref type="bibr" target="#b9">Katoh et al., 2002</ref>). The details of the data simulation and alignment are given in the Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Phylogeny-aware graph alignment algorithm</head><p>PAGAN is capable of inferring de novo multiple alignments of DNA, protein and codon sequences when a guide tree is provided and, in the future, is meant to replace our earlier method PRANK. In this study, we focus on a novel feature of the method and a task that has no satisfactory existing solution, the extension of multiple alignments with new data in a phylogeny-aware manner. We tested our new method in the extension of EnsemblCompara GeneTrees alignments with new sequences, focusing on plausible use cases such as update of an alignment repository after inclusion of new species (Supplementary<ref type="figure" target="#fig_4">Fig. S4</ref>) and analysis of RNA-seq data from a non-model organism (Supplementary Figs S5 and S6). The resulting alignments and the assembled sequence contigs are highly similar to the original ones but, as the original data may also contain errors, the analyses do not allow assessment of the true accuracy of the method. To further understand and illustrate the performance of the method we tested it with simulated data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Comparison of methods for alignment extension</head><p>We compared methods for alignment extension using simulated data representing a mammalian gene family (<ref type="figure" target="#fig_3">Fig. 3a</ref>). The codon data, analyzed both as DNA and protein, were simulated under purifying selection [model M0 with ω = 0.15 (<ref type="bibr" target="#b26">Yang et al., 2000)]</ref>and many substitutions were synonymous on the protein level: despite the three-times greater number of sites for DNA, the sequence identity of DNA and protein sequences were similar, 84–90% between human and Primate and 70–80% between mouse and Rodent over the three levels of evolutionary divergence. Each reference alignment (RA), consisting of 67 sequences, was extended with 250 fragments of 30, 60 or 120 bases/amino acids (50 fragments per query sequence) or with five full-length sequences, and the accuracy of homology inference was measured. We tested five alignment methods for both data types and two additional methods that only support DNA or protein data. The methods tested for both were PAGAN/guided, PAGAN/free (v.0.33), hmmalign (from the HMMER package, v.3.0;<ref type="bibr" target="#b3">Eddy, 2011</ref>), MAFFT (v.6.860b;<ref type="bibr" target="#b9">Katoh et al., 2002</ref>) and ClustalW (v.2.1;<ref type="bibr" target="#b11">Larkin et al., 2007</ref>); for DNA we also used PaPaRa (RAxML v.7.2.6;<ref type="bibr">Berger and</ref>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER<ref type="bibr">[16:07 19</ref>, 2.0 and 2.5, respectively. The accuracy is measured as the correctness of the site-wise homology inference with respect to the closest human/mouse reference sequence</p><p>Stamatakis, 2011) and for protein ClustalO (v.1.0.3;<ref type="bibr" target="#b22">Sievers et al., 2011</ref>). All methods were provided with the true simulated RA and the QSs while PAGAN/free and PaPaRa were additionally given an inferred and PAGAN/guided the true RT. For PAGAN/guided, the species of origin (but not the correct paralogous copy) for the QSs were provided, giving two or three target nodes for the query sequences (<ref type="figure" target="#fig_3">Fig. 3a</ref>). PAGAN and hmmalign were consistently the two most accurate methods for the extension of alignments with new DNA and protein sequences (<ref type="figure" target="#fig_4">Fig. 4</ref>). The two modes of running PAGAN, the 'guided' approach with pre-defined locations to place the sequences and the 'free' approach using heuristic local alignment to find the best location, had slightly different performance on different datasets. PAGAN/guided did better on the alignment of very short fragments that contain little information to infer their correct placement. Despite the prior information, also the guided approach was affected by multiple target nodes and a proportion of shorter sequences were misplaced (Supplementary<ref type="figure">Fig. S7</ref>). PAGAN/free slightly outperformed the guided approach in the alignment of longer fragments (Supplementary<ref type="figure">Fig. S8</ref>) and it did this despite a high fraction of the new sequences being placed to incorrect nodes (Supplementary<ref type="figure">Fig. S7</ref>). An explanation of this considers the long branches around the query sequence in our simulation tree: it is often advantageous to use outgroup information to resolve the mutation events that have taken place in the descendants of the true target node and place the sequence at a deeper location. On the other hand, the placement algorithm visits the tip nodes first and, if no mutations have occurred in the descendants, the greedy approach places the sequences to nodes visited earlier: up to 7% of short fragments from Primate_1 are placed at the node visited very first (Supplementary<ref type="figure">Fig. S7</ref>). The performance of other methods shows that classical global alignment methods, MAFFT, ClustalW and ClustalO, struggle in the alignment of short sequence fragments (<ref type="figure" target="#fig_4">Fig. 4</ref>). MAFFT performed relatively well with full length sequences whereas the accuracy of two Clustal variants was unacceptably low. In contrast to these, hmmalign aligned short fragments nearly as well as full length sequences and was consistently one of the best performing methods. Hmmalign's excellent results should be taken with a grain of salt, however, as our accuracy score is based on sites shared by the query and reference only. By ignoring sites inserted since the species split, this score is overly lenient with profile-based methods that leave many insertions unaligned. The performance of PaPaRa, based on a variant of phylogenyaware algorithm, was good in the alignment of closely related DNA sequences but as it does not produce real multiple alignments—it deletes sites in the query sequences that are inferred as insertions— the method is only meaningful for its original task, phylogenetic placement of sequences. On the other hand, results for PaPaRa are based on reconstructed full-length query sequences (see the Supplementary Material for details) and in phylogenetic placement analyses its error may be smaller than reported. We repeated the PAGAN and hmmalign analyses of DNA fragment data after adding NGS-like errors. The added noise had only a small negative impact on their accuracy (Supplementary<ref type="figure">Fig. S9</ref>). The run times and peak memory usage of different methods were compared on a workstation with 2.40 GHz Intel Xeon CPUs. Two of the methods, MAFFT and hmmalign, are exceptionally fast and perform an alignment in seconds (<ref type="figure" target="#tab_1">Table 1</ref>). In contrast, PAGAN/free and PaPaRa needed 3.3 and 4.7 min for the most time-consuming alignment. These are the first versions of each software, however: the authors of PaPaRa have reported forthcoming speed-ups for their method and we are also working to accelerate ours. Of the methods tested, ClustalO is the most memory hungry but even that can easily be used on a standard personal computer. The memory usage of PAGAN is dominated by the dynamic programming matrix and, due to a more complex data structure needed for the graph representation, the requirements are, for example, somewhat higher than that of MAFFT with a comparable alignment strategy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Extension of large alignments</head><p>Our graph alignment algorithm is not yet well-optimized for speed and the first version of PAGAN is mainly targeted at small andthat consist of 500 reference sequences related by a phylogeny and 5000 query sequence fragments, a mixture of short and long ones, from related species. The alignment of 5000 query sequences to 999 possible target nodes (extant plus inferred ancestral sequences) with the graph alignment algorithm is too slow and we used an experimental acceleration for the placement step. These heuristics worked well for the easy case [M4 dataset from<ref type="bibr" target="#b19">Mirarab et al. (2012)</ref>] and PAGAN aligned 97.9% of query sequences with an accuracy of 98.5% (<ref type="figure">Fig. 5</ref>). In the alignment of moderate (M3) and hard (M2) problems, the heuristics were less successful: the accuracy was high, 94.0 and 93.5%, respectively, but only 50 and 38% of query sequences were actually included in the resulting alignments. The method of<ref type="bibr" target="#b19">Mirarab et al. (2012)</ref>divides the alignment extension problem into smaller sub-problems and performs alignments within each subgroup using hmmalign. That does not produce full multiple alignments of all sequences and the results cannot be meaningfully compared with those produced with PAGAN. We therefore used hmmalign only and aligned the query fragments to a model constructed from the full reference alignment. Hmmalign does not discard any query sequences but for the more challenging datasets, the alignments it produces were clearly less accurate. Importantly, the lower accuracy of hmmalign compared with PAGAN is not only explained by the latter discarding the difficult queries: also for the subset of sequences aligned by both methods the alignments from hmmalign were less accurate (<ref type="figure">Fig. 5</ref>). Hmmalign is fast and, on our test system, it builds a model for a M4 dataset and aligns the queries to that in 12.5 s with the peak memory usage of 84 Mb. PAGAN reconstructs graphs for all internal and extant nodes (totalling 10 999 for a full alignment) and needs 627 s and 2070 Mb for the analysis of the same data.<ref type="figure">5</ref>. The accuracy of PAGAN and hmmalign in the extension of reference alignments of 500 DNA sequences with 5000 query fragments. For the easy set (M4 dataset from<ref type="bibr" target="#b19">Mirarab et al., 2012</ref>; open symbols), both methods align &gt;96% sites correctly; for the moderate (M3; crossed) and hard (M2; solid) sets, the accuracy of PAGAN is high (circles) but the fast heuristics fails to place half of the queries. Hmmalign aligns all the queries but its accuracy for M2 and M3 is low (squares). For the fragments aligned by both methods, the alignments by hmmalign are less accurate (diamonds)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PAGAN: Accurate extension of alignments</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Impact of reference alignment</head><p>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER<ref type="bibr">[16:07 19</ref>), PAGAN shows the benefit from the phylogenetic information provided by denser sequence sampling: the alignments on the full RA are more accurate than those on the reduced ones, the difference growing with the increasing evolutionary divergence. Similarly, it is understandable that hmmalign's best performance is in the alignment of reads from a closely related query sequence against a profile based only on the two sequences from the sister subtree ('clade', 'small'); the information from more distant subgroups only brings noise and the noise-to-signal ratio is at its worst when the central subgroup is represented by two sequences only ('full', 'small'). The position of the query sequence is crucial, however, and the approach giving the best result for the closely related query sequence gives clearly the least correct alignments when the query sequence is deep and has a long history of its own. Although the profiles built from the full RA ('full', 'large') give marginally better results in the alignment of the most difficult cases (<ref type="figure" target="#tab_2">Table 2</ref>, bottom row), the inclusion of large numbers of sequences in the profile is generally not the best policy. Crucially, this conflicts with the requirements of real-life studies such as phylogenetic placement where the RA should be maximally representative. As expected, decreasing similarity between the query and the RA makes the alignment more difficult (<ref type="figure" target="#tab_2">Table 2</ref>, depths 0.45 and 0.60). Although both methods lose accuracy, PAGAN is more consistent in its performance and the improvement over hmmalign grows with evolutionary divergence. As a demonstration of its efficient use of phylogenetic information, the relative improvement of PAGAN with the full RA over any other approach is greatest on the analyses of most diverged datasets (Table 2, bottom row). The correct use of phylogenetic information is important for real-life analyses: de novo alignment of distantly related sequences is error-prone and good aligners produce much better reference alignments if long evolutionary branches are cut shorter by additional sequences. To understand the effects of alignment error on the different approaches, we re-aligned the reference sequences using MAFFT and PAGAN. The relative performance of the methods does not change with noisier RA (Supplementary<ref type="figure" target="#tab_1">Table S1</ref>). With PAGAN, the extension of densely sampled alignments (ingroup 'large') is more accurate than that of sparsely sampled ones (ingroup 'small'), the effect further growing with the evolutionary divergence of the QS and the reference sequences. The results for hmmalign using the different sized re-aligned RA mirror those from the true simulated RA. Regardless of the placement method used, the RAs generated with PAGAN give a better starting point for the alignment of NGS reads than those generated with MAFFT.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>We have generalized the concepts of our phylogeny-aware alignment algorithm and developed a method for phylogenetic alignment of partial-order sequence graphs. In this article, we focus on one specific application for the new method that has no satisfactory previous solution, the phylogeny-aware extension of existing alignments with new data. Re-computation of alignments for largely the same sets of sequences is wasteful and may occasionally introduce errors that require manual verification and corrections. Extension of existing alignments with new sequences avoids these problems and guarantees that the relative alignment of reference sequences is not changed. The new sequences should also be accurately aligned, however, and we strongly believe that this is best achieved by aligning them in their phylogenetic context, against the targets resembling them most. This is true for all sequences but its importance is even more pronounced in the alignment of short sequence fragments containing little information. We performed comprehensive simulation studies to compare the performance of our new method, PAGAN, to that of alternative methods for alignment extension and to test how the different approaches utilize the information available in related sequences. We focused on the accuracy of inferred evolutionary homology with the aim of using the resulting alignments for evolutionary studies. Our analyses show that PAGAN's phylogenetic approach clearly outperforms most alternative methods, the improvement being especially striking in the alignment of short sequence fragments. We were impressed by the good performance of hmmalign but also noticed that its performance is highly dependent on the reference alignment used for the construction of the profile HMM. With a carefully chosen reference alignment, hmmalign's accuracy was in some cases comparable to that of PAGAN. In reallife analyses, one cannot typically maximize both the sensitivity of the profile HMM and the breath of sequences included, and the widely used practice of including all the diversity available heavily penalizes hmmalign's performance. In contrast, PAGAN is a truly phylogenetic method and, while it efficiently uses the information from closely related sequences, it is not affected by the inclusion of more distantly related ones in the reference set. We tested PAGAN in the extension of large alignments and found the initial results very promising. We believe that improvements in the assignment of queries to target nodes and speed-ups in the algorithm will make PAGAN also a competitive method for largescale metagenomic analyses. Unlike alternative methods for the task, PAGAN aligns also insertion sites and includes full-length sequences in the resulting multiple alignment. The latter may not be crucial in phylogenetic placement of query fragments relative to the reference sequences but it will provide additional information to resolve the relations between the newly added sequences and will allow connecting related fragments to longer contigs. Alignment extension and phylogenetic placement has interesting applications in the analyses of increasingly abundant sequencing</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PAGAN: Accurate extension of alignments</head><p>data produced by NGS technologies and we have implemented extensive support for such data. Falling costs per base will allow the sequencing of full genomes for many new non-model species and transcriptomes for even more species. We believe that there remains a need for comparative methods like ours, e.g. in the integration of transcriptome datasets into large reference alignments of closely related species, including the precise differentiation of close paralogues. We also envision extending our approach to the alignment of graphs produced by the de novo assemblers and using phylogenetic information to disambiguate these graphs into the correct separate sequences. In addition to their alignment, we want to emphasize the advantages of graphs in the representation of the input sequence data. Graphs have direct applications in the modelling of NGS data from specific sequencing platforms but they can also be used to represent other features, such as repeat structures, that affect sequences' evolution and thus have an impact on their alignment. The evolutionary process varies across sequence sites and many features related to this may one day be inferred by sophisticated alignment methods from the input sequences along with their alignment. It seems easier, however, to start with separate tools for the annotation of sequences, such as detection of low-complexity repeat sequences, and pass this information to a generic alignment method. We believe that partial-order graphs are ideal for carrying that information.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. (a) A progressive alignment of three sequence graphs consists of two pairwise alignments. (b) The first alignment creates graph X to represent the inferred ancestor of A and B. In X, the character state of vertex 5 is Y, representing both pyrimidines, and has two incoming edges, from vertices 2 and 4, to indicate that the presence of vertices 3 and 4 is uncertain. (c) The optimal alignment path for graphs X and C jumps from vertex 2 in graph X to vertex 5 using the direct connecting edge; the edges flanking the skipped-over fragment are recorded as unused (asterisks)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. PAGAN can add multiple new sequences, assumed to come from the species shown in red, to the same target node in a progressive manner. It reconstructs sequence graphs to represent the ancestral nodes and aligns the new sequences against the ancestor of their sister clade, indicated by X. Each alignment of a sequence, r n , creates a new parent node, p n , against which the next sequence is aligned. After finishing the alignment, the sub-tree with the new sequences is inserted back to the tree structure</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [16:07 19/6/2012 Bioinformatics-bts198.tex] Page: 1686 1684–1691</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. (a) The phylogeny used for the first analysis is based on the Ensembl mammalian tree but includes two additional species, Primate and Rodent shown in magenta and red, and has undergone two duplication events (blue squares). The target nodes provided for the PAGAN guided alignment are shown with dots of matching colour. (b) The first tree topology for the second analysis has 'large' ingroup and 'close' QS. (c) The ingroup of two other topologies have 'large' ingroup but 'intermediate' and 'distant' QSs (top). Three additional sets of reference alignments with 'small' ingroup are created by reducing the central sub-tree to two sequences (bottom). Full reference alignments are used with PAGAN; hmmalign analyses are performed with full sets of sequences ('full': 96 or 66 sequences) or just the central subgroup ('clade': 32 or 2 sequences). The target node for PAGAN is indicated with a red dot</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. The accuracy of alignment of DNA (top row) and protein (bottom row) QSs against the corresponding reference alignment using different alignment methods. The x-axis indicates the length of the fragments aligned and the sub-panels show two of the five query species analyzed. Columns (a)–(c) correspond to trees with branch lengths multiplied by 1.5, 2.0 and 2.5, respectively. The accuracy is measured as the correctness of the site-wise homology inference with respect to the closest human/mouse reference sequence</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [16:07 19/6/2012 Bioinformatics-bts198.tex] Page: 1689 1684–1691</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.</head><figDesc>Fig. 5. The accuracy of PAGAN and hmmalign in the extension of reference alignments of 500 DNA sequences with 5000 query fragments. For the easy set (M4 dataset from Mirarab et al., 2012; open symbols), both methods align &gt;96% sites correctly; for the moderate (M3; crossed) and hard (M2; solid) sets, the accuracy of PAGAN is high (circles) but the fast heuristics fails to place half of the queries. Hmmalign aligns all the queries but its accuracy for M2 and M3 is low (squares). For the fragments aligned by both methods, the alignments by hmmalign are less accurate (diamonds)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><figDesc>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [16:07 19/6/2012 Bioinformatics-bts198.tex] Page: 1691 1684–1691</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>Table 1.</figDesc><table>Execution time and peak memory usage for the extension of EnsTr2 
reference alignment with 250 sequence fragments 

Method 
DNA fragments 
Protein fragments 

60 nt 120 nt 
60 aa 120 aa 

Time (s) 

MAFFT 
1.9 
1.0 
0.4 
0.3 
hmmalign 
2.2 
4.4 
1.9 
4.6 
ClustalO 
– 
– 
16.5 
26.3 
ClustalW 
75.8 
143 
27.0 
48.7 
PAGAN/guided 73.6 
137 
26.2 
46.0 
PAGAN/free 
186 
200 
47.2 
57.9 
PaPaRa 
144 
284 
– 
– 

Memory (Mb) 

MAFFT 
103 
103 
103 
103 
hmmalign 
198 
198 
198 
198 
ClustalO 
– 
– 
569 
518 
ClustalW 
31 
31 
16 
16 
PAGAN/guided 298 
334 
133 
155 
PAGAN/free 
356 
413 
153 
175 
(+104 for placement) 
(+104 for placement) 
PaPaRa 
84 
85 
– 
– 

nt, nucleotide; aa, amino acids. 

medium-sized alignment tasks. An obvious application for the 
method is in metagenomic studies, however, so we performed 
a preliminary analysis to see how the method scales to larger 
tasks. 
We analyzed the simulated test data of Mirarab et al. (2012) 
</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5" validated="true"><figDesc>Table 2. The accuracy of extending reference alignments with new sequences</figDesc><table>PAGAN 
hmmalign/full 
hmmalign/clade 

Simulation 
Ingroup 
Ingroup 
Ingroup 
Depth Query 
Large 
Small 
Large 
Small 
Large 
Small 

Close 
0.977 
0.977 
0.935 
0.928 
0.946 
0.967 

0.30 
Interm. 
0.969 
0.969 
0.938 
0.930 
0.947 
0.945 
Distant 
0.959 
0.957 
0.937 
0.932 
0.936 
0.922 

0.45 
Close 
0.978 
0.978 
0.917 
0.902 
0.933 
0.967 
Interm. 
0.965 
0.964 
0.926 
0.910 
0.937 
0.937 
Distant 
0.955 
0.944 
0.929 
0.922 
0.923 
0.898 

0.60 
Close 
0.978 
0.976 
0.887 
0.859 
0.909 
0.958 
Interm. 
0.955 
0.951 
0.898 
0.868 
0.915 
0.910 
Distant 
0.928 
0.905 
0.894 
0.878 
0.890 
0.846 

RA (ingroup 'large' versus 'small') is nearly identical. When the 
query sequence branches out deeper in the tree ('intermediate' 
and 'distant'</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">As shown by the previous analysis, PAGAN has the potential to scale up to large alignment extension tasks while its approach for modelling of insertions/deletions and uncertainty is especially wellsuited for analyses of short and noisy NGS data. Hmmalign has been used for the extension of reference alignments with new sequences in metagenomic analyses (Matsen et al., 2010; Stark et al., 2010) and recently Mirarab et al. (2012) developed an approach that applies hmmalign on subsets of the reference alignment. The latter mainly focused on computation time, however, and did not systematically study the strategies for choosing the optimal RA for alignment extension analyses, nor its effect on homology inference. To understand the factors affecting alignment extension with phylogenetic and profile-based methods, we tested PAGAN and hmmalign with idealized data mimicking an RNA-seq study (see Section 2 Fig. 3b, c). Our set-up lets us assess the effects of (i) phylogenetic position of the query species; (ii) the number of closely related reference species; (iii) the evolutionary divergence of the reference; and (iv) the inclusion of more-distantly related reference species. To assess the impact of sequence divergence on the ancestor reconstruction, we constrained the placement of the QS with the guide phylogeny. Incorrect topologies, or correct topologies but with incorrect root position, could cause alignment/placement errors. A full investigation of this, beyond typical use cases with known reference trees or inferred trees as studied here, is beyond the scope of this article but will be considered in future work. Although the magnitude of difference and the relative performance of alternative approaches varies, the phylogenetic approach of PAGAN with full data (ingroup &apos;large&apos;) consistently produces the most accurate alignments (Table 2). With &apos;close&apos; sets, the removal of sequences does not affect PAGAN&apos;s reconstruction of the target ancestor and its performance on full and reduced 1689 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="1691"> at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We thank Gregory Jordan, Tim Massingham, Javier Herrero and Paul Flicek for their help, insightful comments and support during the course of this project.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Aligning short reads to reference alignments and trees</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Berger</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2068" to="2075" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Performance, accuracy, and web server for evolutionary placement of short sequence reads under maximum likelihood</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Berger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="291" to="302" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Phylogenetic assessment of alignments reveals neglected tree signal in gaps</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Dessimoz</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gil</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome. Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">37</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Accelerated Profile HMM Searches</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Eddy</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">INDELible: a flexible simulator of biological sequence evolution</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Fletcher</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="1879" to="1888" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The effect of insertions, deletions, and alignment errors on the branch-site test of positive selection</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Fletcher</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2257" to="2267" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">An improved algorithm for matching biological sequences</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Gotoh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">162</biblScope>
			<biblScope unit="page" from="705" to="708" />
			<date type="published" when="1982" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">A new method that simultaneously aligns and reconstructs ancestral sequences for any number of homologous sequences, when the phylogeny is given</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Hein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="649" to="668" />
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">The effects of alignment error and alignment filtering on the sitewise detection of positive selection</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Jordan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Goldman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1125" to="1139" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Katoh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="3059" to="3066" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">An anthology of algorithms and concepts for sequence comparison</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Kruskal</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Sankoff</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Time Warps, String Edits, and Macromolecules: the Theory and Practice of Sequence Comparison</title>
		<editor>Sankoff,D. and Kruskal,J.</editor>
		<meeting><address><addrLine>Addison-Wesley Reading, MA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1983" />
			<biblScope unit="page" from="265" to="310" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Clustal W and Clustal X version 2.0</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Larkin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="2947" to="2948" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Multiple sequence alignment using partial order graphs</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Lee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="452" to="464" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">An algorithm for progressive multiple alignment of sequences with insertions</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Löytynoja</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Goldman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="10557" to="10562" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Löytynoja</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Goldman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">320</biblScope>
			<biblScope unit="page" from="1632" to="1635" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Uniting alignments and trees</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Löytynoja</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Goldman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">324</biblScope>
			<biblScope unit="page" from="1528" to="1529" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">High sensitivity to aligner and high rate of false positives in the estimates of positive selection in the 12 Drosophila genomes</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Markova-Raina</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Petrov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="863" to="874" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<monogr>
		<title level="m" type="main">2012) simNGS and simLibrary – software for simulating next-gen sequencing data</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Massingham</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Goldman</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Matsen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinform</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">538</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">SEPP: SATé-enabled phylogenetic placement</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Mirarab</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Pac. Symp. Biocomput</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="247" to="258" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Genome-wide nucleotide-level mammalian ancestor reconstruction</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Paten</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1829" to="1843" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Minimal mutation trees of sequences</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Sankoff</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Appl. Math</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="35" to="42" />
			<date type="published" when="1975" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Sievers</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">539</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Automated generation of heuristics for biological sequence comparison</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Slater</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Birney</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinform</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">31</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="2688" to="2690" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">MLTreeMap–accurate maximum likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Stark</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page">461</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Codon-substitution models for heterogeneous selection pressure at amino acid sites</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">155</biblScope>
			<biblScope unit="page" from="431" to="449" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>