
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:30+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis Detecting differential peaks in ChIP-seq signals with ODIN</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">. 24 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Manuel</forename>
								<surname>Allhoff</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">IZKF Computational Biology Research Group</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution" key="instit1">Aachen Institute for Advanced Study in Computational Engineering Science (AICES)</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kristin</forename>
								<surname>Ser</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Heike</forename>
								<surname>Chauvistr</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Qiong</forename>
								<surname>Lin</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Martin</forename>
								<surname>Zenke</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ivan</forename>
								<forename type="middle">G</forename>
								<surname>Costa</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">IZKF Computational Biology Research Group</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Cell Biology</orgName>
								<orgName type="department" key="dep2">Institute for Biomedical Engineering</orgName>
								<orgName type="institution">RWTH Aachen University Medical School</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Helmholtz Institute for Biomedical Engineering</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution" key="instit1">Aachen Institute for Advanced Study in Computational Engineering Science (AICES)</orgName>
								<orgName type="institution" key="instit2">RWTH Aachen University</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Center of Informatics</orgName>
								<orgName type="institution">Federal University of Pernambuco</orgName>
								<address>
									<country key="BR">Brazil</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis Detecting differential peaks in ChIP-seq signals with ODIN</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="page" from="3467" to="3475"/>
							<date type="published" when="2014">. 24 2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu722</idno>
					<note type="submission">Received on April 6, 2014; revised on October 3, 2014; accepted on October 24, 2014</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Gunnar Ratsch Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Detection of changes in deoxyribonucleic acid (DNA)– protein interactions from ChIP-seq data is a crucial step in unraveling the regulatory networks behind biological processes. The simplest variation of this problem is the differential peak calling (DPC) problem. Here, one has to find genomic regions with ChIP-seq signal changes between two cellular conditions in the interaction of a protein with DNA. The great majority of peak calling methods can only analyze one ChIP-seq signal at a time and are unable to perform DPC. Recently, a few approaches based on the combination of these peak callers with statistical tests for detecting differential digital expression have been proposed. However, these methods fail to detect detailed changes of protein–DNA interactions. Results: We propose an One-stage DIffereNtial peak caller (ODIN); an Hidden Markov Model-based approach to detect and analyze differential peaks (DPs) in pairs of ChIP-seq data. ODIN performs genomic signal processing, peak calling and p-value calculation in an integrated framework. We also propose an evaluation methodology to compare ODIN with competing methods. The evaluation method is based on the association of DPs with expression changes in the same cellular conditions. Our empirical study based on several ChIP-seq experiments from transcription factors, histone modifications and simulated data shows that ODIN outperforms considered competing methods in most scenarios. Availability and implementation: http://costalab.org/wp/odin.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Transcriptional regulation is dictated by a set of deoxyribonucleic acid (DNA) interacting proteins such as histones, which define the chromatin structure, and transcription factors (TFs). These proteins are responsible for recruitment of ribonucleic acid (RNA) polymerase and start of transcription (<ref type="bibr" target="#b20">Maston et al., 2006</ref>). Detection of the changes in DNA–protein interactions under distinct cellular conditions is a crucial step in unraveling the regulatory networks behind biological processes such as cell differentiation, the activation of signaling pathways and the onset of diseases (<ref type="bibr" target="#b11">Kaikkonen et al., 2013;</ref><ref type="bibr" target="#b19">Martens and Stunnenberg, 2013</ref>). Chromatin immunoprecipitation followed by DNA sequencing (ChIP-seq) allows to study the interactions of proteins with DNA regions in a genome wide manner (<ref type="bibr" target="#b5">Dahl and Collas, 2008</ref>). Computational methods identify DNA–protein interaction sites from ChIP-seq (also called peak detection) by detecting regions with a higher number of reads than expected by chance using sophisticated statistical models (<ref type="bibr" target="#b2">Ashoor et al., 2013;</ref><ref type="bibr" target="#b12">Kuan et al., 2011;</ref><ref type="bibr" target="#b25">Rozowsky et al., 2009;</ref><ref type="bibr" target="#b27">Song and Smith, 2011;</ref><ref type="bibr" target="#b28">Spyrou et al., 2009;</ref><ref type="bibr" target="#b31">Zhang et al., 2008;</ref>). With a few exceptions, widely used peak calling methods are based on the analysis of individual ChIP-seq signals. Here, we are interested in comparing ChIP-seq data from distinct experiments; we want to detect changes, which we call differential peaks (DPs), in protein– DNA interaction of a single protein in a pair of cellular conditions. We will refer to this signal detection challenge as differential peak calling (DPC). See<ref type="figure">Figure 1</ref>for examples of putative DPs after the induction of TLR4 signaling (<ref type="bibr" target="#b11">Kaikkonen et al., 2013</ref>). Initially, DPC was performed by peak calling on individual ChIP-seq signals. Peaks detected in only one of the conditions were then defined as cell-specific peaks (<ref type="bibr" target="#b9">Heinz et al., 2010</ref>). Such methods are not able to detect cases where peaks were presented (and called) in both cell types, but exhibit a significant increase (decrease) of the DNA–protein signal in one of the cells. In the example of<ref type="figure">Figure 1</ref>, based on peaks from PeakSeq (<ref type="bibr" target="#b25">Rozowsky et al., 2009</ref>), only DP1 would be detected as cell-specific. Moreover, most of single signal peak callers (SPCs) provide no functionality to normalize several ChIP-seq experiments and are likely to show bias in experiments with higher number of reads. A more sophisticated strategy to detect DPs is the combination of peaks from SPCs with statistical tools. These twostage differential peak callers (DPC) first combine peaks that are called on individual ChIP-seq conditions using SPCs. Next, they count the number of reads for each candidate peak, perform signal normalization and apply statistical tests assuming a differential count model like EdgeR (<ref type="bibr" target="#b24">Robinson et al., 2010</ref>) or DESeq (<ref type="bibr" target="#b1">Anders and Huber, 2010</ref>). Therefore, they can detect *To whom correspondence should be addressed. ß The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com candidate peaks where the number of read counts is significantly higher/lower in one of the ChIP-seq conditions. While this approach allows the detection of significant changes in ChIPseq within candidate peaks, it is highly dependent on the initial peak calling step as well as the strategy used to create the set of candidate peaks. For example, histone modifications associated to active regulatory regions occur in domains spanning several hundreds of base pairs and may have intricate patterns of gain/ loss of ChIP-seq signals within the same domain. SPCs tend to call the domains as single peaks and consequently the differential analysis is only able to evaluate the differential counts of the complete called peaks (<ref type="figure">Fig. 1</ref>). A more appropriate framework to analyze DPs is the use of segmentation methods like Hidden Markov Models (HMMs), which are able to analyze pairs of ChIP-seq signals and perform DPC in a single step (<ref type="bibr" target="#b30">Xu et al., 2008</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Previous approaches</head><p>Previous approaches of DPC can be categorized in two classes: one-stage and two-stage DPC. DBChIP (<ref type="bibr" target="#b16">Liang and Keles¸,Keles¸, 2012</ref>) is an example of a two-stage DPC, as it receives as input the summit information of peaks from SPCs like PeakSeq followed by the application of edgeR (<ref type="bibr" target="#b24">Robinson et al., 2010</ref>). DBChIP has as objective only the analysis of TF peaks, and therefore, uses predefined short regions around the peak summits as candidates for DPs. We have previously applied a similar approach using the peak caller MACS (<ref type="bibr" target="#b31">Zhang et al., 2008</ref>) and EdgeR accordingly (<ref type="bibr">Lin et al., in preparation)</ref>. Here, peaks for all ChIP-seq conditions analyzed were combined by merging overlapping regions, which allows the analysis of peaks of any size. Another approach, MAnorm (<ref type="bibr" target="#b26">Shao et al., 2012</ref>), also receives as input the regions from SPCs and normalizes the peak counts between two samples with a local robust regression approach followed by a P value calculation to define significant DPs. One-stage DPCs are based on signal segmentation approaches such as an HMM. To our knowledge, the only published method proposed specifically for the DPC problem is ChIPDiff (<ref type="bibr" target="#b30">Xu et al., 2008</ref>), which is based on a three state HMM, to detect DPs between two samples. The HMM emission is based on an approximation of a Beta-Binomial distribution, which is fixed after model initialization. The Baum–Welch algorithm is used to estimate transition parameters. Furthermore, the peak caller MACS has been recently extended to MACS2. MACS2 is able to perform DPC of ChIP-seq signal pairs. It works by first performing peak calling in individual signals followed by a fold change analysis within these regions (unpublished, available at https://github.com/taoliu/MACS/). RSEG (<ref type="bibr" target="#b27">Song and Smith, 2011</ref>) is specialized in the analysis of single ChIP-seq signals of repressive histones, which are distributed in very large and poorly sequenced genomic domains. It has an option for DPC with a three state model similar to ChIPDiff. RSEG uses Difference Negative Binomial distribution. There are also SPCs based on HMMs, such as HMCan (<ref type="bibr" target="#b2">Ashoor et al., 2013</ref>) and BayesPeaks (<ref type="bibr" target="#b28">Spyrou et al., 2009</ref>), which are not able to perform DPC.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Our approach</head><p>Here, we propose an One-stage DIffereNtial peak caller (ODIN), an HMM-based approach to detect and analyze DPs in pairs of ChIP-seq data. The HMM, which is based on a three state topology, uses the product of Binomial or mixture of Poisson distributions to model the observed values. Moreover, we constrain several HMM parameters to decrease the number of free parameters and to improve robustness and avoid label switching. Previous to the HMM application, we propose a pipeline with several steps for generation of the ChIP-seq profiles. The pipeline consists of automatic estimation of fragment size, DNA mappability, GC-content normalization, correction of signals with input-DNA and signal normalization. Moreover, we use the density estimates from the HMM for an efficient approach to estimate P values for the DPs. ODIN is the first DPC performing signal normalization, DP detection and statistical testing in an integrated way. We propose here a methodology and statistic to evaluate DPs, which is based on associating DPs with changes in expression on the same cellular conditions as the ChIP-seq data. This allows us to perform a comparative analysis with all competing methods (DBChIP, MAnorm, DESeq, MACS2 and ChIPDiff) for ChIP-seq data from TFs and histone modifications. The analysis also covers a simulated data approach tailored for the DPC problem. We use the simulated data to explore the method performance under distinct conditions, such as the complexity of DPs and the number of reads.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHOD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Profile construction</head><p>The first step in ChIP-seq analysis is the construction of a genomic profile. The basic idea is to fragment the genome into bins and count<ref type="figure">Fig. 1</ref>. We show an example of two distinct ChIP-seq signals for the histone modification H3K4me2 before (0 h, upper signal) and 24 hours after (24 h, lower signal) induction of TLR4 signaling of macrophages around the gene Irf1. We indicate with squares examples of regions, which are putative DPs with gain (or loss) of ChIP-seq signal after 24 hours of TLR4 treatment. The height of the squares indicates the size of the highest ChIP-seq signal for a DP. We also display results from the SPC PeakSeq and a two-stage peak caller based on applying DESeq on PeakSeq peaks (bars below the ChIP-seq signals). PeakSeq successfully detects broad peaks describing ChIP-seq signal for each cell. The twostage peak caller can detect DP1 and DP3, but cannot detect changes within the broad candidate peaks such as DP2 or complex changes in the signal around Irf1 gene body (DP4 and DP5) the reads falling in these bins. Let X be the matrix that represents the genomic signal X=fx ij g DÂL ;</p><p>where x ij indicates the number of reads in bin j of signal i, and where D is the number of genomic signals and L the number of bins. Here, we will have D = 2, as we are interested in DPs between two ChIP-seq signals. The ith genomic signal is represented by the row vector x iÁ =fx i1 ;. .. ; x iL g and the genomic signals for bin j is represented by the vector x Áj =fx 1j ;. .. ; x Dj g. Moreover, ChIP-seq experiments usually have reads from input-DNA for each cell type analyzed. The input-DNA contains all fragmented DNA not immunoprecipitaded in the ChIP experiment and can be used as a control signal. In particular, input-DNA can indicate sequencing bias associated to GC-content and DNA sheering process (<ref type="bibr" target="#b21">Park, 2009</ref></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">Read mappability filtering</head><p>We ignore reads mapping to genomic regions which are either unassembled (denoted by Ns) or that exhibit a poor mappability. Poor mappability regions stem from the fact that short reads cannot be uniquely mapped to repetitive regions that exhibit a higher length than the reads themselves (<ref type="bibr" target="#b27">Song and Smith, 2011</ref>). Reads aligned completely to a poor mappability region are ignored with the use of this filter.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Fragment size According</head><p>to the ChIP-seq protocol, only the beginning of the sample's DNA fragments is sequenced (<ref type="bibr" target="#b21">Park, 2009</ref>). To reconstruct the missing part of the DNA fragments, one has to compute the read fragment size f. Given the set F of the left most positions of all reads aligned to the forward strand and, respectively, R, the right most positions of all reads aligned to the reverse strand. We define the strand cross-correlation function cðfÞ= X p2F[R hðpÞ Á hðf+pÞ following (<ref type="bibr" target="#b18">Mammana et al., 2013</ref>) with</p><formula>hðpÞ= 0; p = 2 F [ R; 2; p 2 F \ R;</formula><p>1; else:</p><formula>8 &gt; &gt; &lt; &gt; &gt; :</formula><p>The convolution c gives the correlation between counts on the forward and reverse strands for a given fragment size f. We are interested to find the fragment size ^ f=arg max f2F cðfÞ, that is the value with the maximum correlation between both strands.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.3">Signal profile</head><p>We extend all forward (reverse) reads from the leftmost (rightmost) position to the 3 0 (5 0 ) direction by the estimated read fragment size ^ f. We use a sliding window approach to partition the genome into a set fb 1 ;. .. ; b L g. Each bin b j covers the genomic positions ½j Á s À 0:5 Á w; j Á s+0:5 Á w, where s and w are the step size and the window size. The value of the genomic profile x ij is simply the number of extended reads of ChIP-seq signal i aligned to regions overlapping bin b j. If a read lies entirely in a filtered region (Section 2.1.1), it will be ignored.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.4">GC-content Sequencing technologies usually exhibit an</head><p>unwished correlation between the number of reads and the GC-content of the regions the reads come from (<ref type="bibr" target="#b3">Benjamini and Speed, 2012</ref>). To model and correct this effect, we use an histogram-based approach introduced by<ref type="bibr" target="#b2">Ashoor et al. (2013)</ref>. Let g j indicate the GC-content of the genomic bin b j , that is the proportion of<ref type="bibr">Gs</ref>Loosely speaking, we increase (decrease) the genomic signal of a bin, if the average GC-dependent signal is lower (higher) than expected.with =S 2 =S 1. We round all values to obtain count data again. For simplicity we refer to this signal as read counts in the following text. We filter all bins b j with low number of reads (x 1j +x 2j 43) and x1j</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.5">Input subtraction</head><formula>S 1 + x2j S 2 5 2</formula><p>LÁM , where M represents the proportion of mappable regions. This filtering steps discards 80% of bins with low count evidence.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">DPC HMM</head><p>Our HMM receives as input a matrix X with two genomic signals representing the ChIP-seq values of two biological conditions to be compared. The signals are obtained after the application of all pre-processing steps described in Section 2.1. We define a first-order HMM containing a state for DPs gained in signal x 1Á (Gain 1), a state for DPs gained in signal x 2Á (Gain 2) and a background state (Back), as depicted in<ref type="figure">Figure 2</ref>. All states have transitions to other states and to themselves. We use the product of Binomial or mixture of Poisson distributions as emissions for our HMM.where n represents the number of events observed (number of reads in the libraries) and p si is the probability of observing a read in state s and signal i.</p><p>In contrary to the Negative Binomial, the Binomial distribution is not able to model over-dispersion (<ref type="bibr" target="#b14">Leleu et al., 2010</ref>). However, there is no closed form to obtain maximum likelihood estimates of these densities and it would require numerically intricate extensions of the Baum–Welch algorithm. Alternatively, we evaluate the use of a mixture of Poisson distribution, which has a close form and can cope with over-dispersion. In this case, we haveWe use function f(l) = l to ensure that the mean of each mixture component are multiple of each other (see Supplementary Section 2 for more details). This constraint was introduced to mitigate the fact that during mixture estimation some components can end up with little data support (or low mixing coefficients). This is usual when outliers (peaks with unusually high number of reads) are present in the data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Initial HMM parameter</head><p>We use a simple fold criteria to define a set of DPs to be used for the HMM initialization. More formally, a bin b j will be assigned to state Gain 1 if x 1j =x 2j 4t, to state Gain 2 if x 2j =x 1j 4t and to Back state otherwise. We use this annotation to define a posterior probability and to perform a single M-Step of the Baum– Welch algorithm to obtain initial parameters. Given the large size of the genomic signals, we only use a random selection of regions to train the HMM. We select genomic regions formed by contiguous bins not filtered in Section 2.1.1, which have at least a bin annotated with either Gain 1 or Gain 2 state. The selection is done until the training set has at least 3 Â 10 6 bins.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">HMM training The HMM</head><p>is estimated with the Baum–Welch algorithm (<ref type="bibr" target="#b23">Rabiner, 1989</ref>). Estimates of the initial state and transition probabilities follow usual methods. Concerning the emission distributions, the parameter n is equal in emissions and represents the number of reads of the largest library n=max ðS 1 ; S 2 Þ (the normalization steps ensure S 1 % S 2 ). To reduce the number of parameter estimates, we constrain the parameters from Back state (s = 3) to be equal p 31 =p 32. We also constrain emissions for state Gain 1 (s = 1) and state Gain 2 (s = 2) by p 11 =p 22 and p 12 =p 21. This makes the distributions of enriched signals (non-enriched signals) from states Gain 1 and Gain 2 to be equal (<ref type="figure">Fig. 2</ref>). For the Binomial distribution, given r sj to be the posterior probability that the HMM is at state s after observing x Áj , it can be shown that the maximum likelihood estimates of those parameters are:For the mixture of Poisson distribution, we can compute si1 for the first component as</p><formula>Â si1 = X L j=1 X M l=1 x ij Á sl ðjÞ X L j=1 X M l=1 fðlÞ Á sl ðjÞ ; and for component l Â sil =l Á Â si1</formula><p>where sl ðjÞ is the posterior probability of being in component l at state s at time j. All other parameters follow standard mixture model estimates. We constrain the HMM's mixture distributions accordingly to the case of the Binomial distribution (see Supplementary Section S2 for more details of the mixture of Poisson). Training is performed until convergence. Finally, we apply the Viterbi algorithm to the complete genomic signals. We merge all consecutive bins visited by either states Gain 1 or Gain 2 on the Viterbi path to obtain the candidate DPs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Post-processing</head><p>Next, we perform two post-processing steps to remove spurious DPs. First, we ignore all DPs with a size smaller than the estimated fragment size ^ f. We also merge concordant DPs, which have a distance less than the estimated fragment size ^ f. The second step is only suggested for histone modification data, which are usually localized in broader genomic regions. We perform a statistical test to assign a P value to each DP. Let</p><formula>y 1 = X v j=u x 1j and y 2 = X v j=u x 2j</formula><p>be the read counts for a DP spanning from bins u to v. For DP Gain 1, the P value is the sum of probabilities of the tuple (a,b) such that a4y 1 ; a+b=y 1 +y 2. More formally,</p><formula>Pr ða4y 1 jy 2 Þ= X a4y1; a+b=y1+y2</formula><p>Pr ða; bÞ;The sum of the nominator is a subset of the sum of the denominator. Consequently, we only need to evaluate the sum of the denominator and<ref type="figure">Fig. 2</ref>. Here we depict the three state HMM used for DP calling and samples of their emission distributions. We constraint the emission distribution of state Back as well as the emission distributions linked by dotted lines take into account the appropriate values for the nominator. Moreover, we can rewrite the main term in the nominator (denominator) as a function fðaÞ=Bða j n; p 31 Þ Á Bðy 1 +y 2 À a; p 32 Þ given that b=y 1 +y 2 À a. This function is axially symmetrical and has a global maximum at a max = ðy 1 +y 2 Þ=2 given that p 31 =p 32. That is, we only have to evaluate half of the sum's values of the numerator (denominator). Furthermore, as the function decrease monotonically departing from a max , we can approximate the P value calculation by making fðeÞ=fðaÞ for all e4a given that fðaÞ À fða+1Þ5. These steps allow a speed up of 100 times on the P value calculations on our experiments. Note that these improvements would not be possible in the mixture of Poisson distribution, therefore, we estimate a Binomial distribution using the posterior probability of the background model in this case.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">EXPERIMENTAL DESIGN</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Real datasets</head><p>We used data from two studies, both using cells of the mouse immune system, to evaluate the performance of our method. The first study analyses the response of macrophages after activation of the TLR4 signaling pathway (<ref type="bibr" target="#b11">Kaikkonen et al., 2013</ref>). We use ChIP-seq experiments from the TF PU.1 at time points 0, 1, 6, 12 and 24 h and from the histone modification H3K4me2 at time points 0, 1, 6 and 24 h (time point 12 h was not available). We perform DPC by comparing the time point 0 h with all other time points which leads to seven experiments (<ref type="figure" target="#tab_1">Table 1</ref>). The study provides an input-DNA signal of untreated cells (0 h), which is used as control. Moreover, we also use the genomic run-on sequencing (GRO-seq) experiments, which measures the quantity of nascent transcripts, in time points 0, 1, 6, 12 and 24 h for validation. These data were obtained from GEO accession number GSE48759. The second study comprises in-house data describing regulatory changes during the development of antigen-presenting dendritic cells (DCs). Our institute has established an in vitro protocol to differentiate multi-potent progenitors (MPP) from adult mouse bone marrow to common DC progenitors (CDP;<ref type="bibr" target="#b8">Felker et al., 2010</ref>). The CDP further differentiate into two distinct DC subsets, classical DC (cDC) and plasmacytoid DC (pDC). These four cell types were sorted by FACS and ChIP-seq experiments for H3K4me1 and PU.1 were performed (Lin et al., in preparation, data available at GSE57563). We have performed a DP analysis comparing the lineage commitment steps (MPP to CDP, CDP to cDC, CDP to pDC) and DC subset specification (cDC and pDC). This leads to eight further experiments as listed in<ref type="figure" target="#tab_1">Table 1</ref><ref type="bibr" target="#b15">Li and Durbin, 2010</ref>) version 0:6:1 À r104 with standard parameter for read mapping. All experiments were based on mouse genome (mm9).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Evaluation</head><p>There is no gold standard to evaluate DPs. A strategy commonly used to evaluate SPCs applied to ChIP-seq from TFs— measuring the proportion of candidate peaks with motifs of the TF (<ref type="bibr" target="#b4">Chen et al., 2012</ref>)—is not applicable to the DP problem. Sequence evidences (motifs) are independent of the cellular context and they will be found in the genomic sequence if binding is present in at least one of the cellular conditions. An alternative is to associate changes in protein–DNA with changes in gene expression, whenever gene expression is measured in the same cellular conditions, as usually performed in genomic studies with ChIP-seq data (<ref type="bibr" target="#b9">Heinz et al., 2010;</ref><ref type="bibr" target="#b11">Kaikkonen et al., 2013</ref>). Here, we propose a method that quantifies changes in expression in the proximity of DPs. The measure is independent of the number of called peaks and can be applied either to gene expression data from sequencing or microarray data. For sequencing data, we first extend the DPs to have at least a length of 1000 bps and then count the number of RNA/GRO-seq reads aligned to these regions for both cell samples. The use of small windows of RNA/GRO-seq is based on the fact that we want to capture the expression of known genes or uncharacterized lncRNAs in the close proximity of the DP. See Supplementary<ref type="figure">Figure 7</ref>for an example of GRO-seq profiles. More formally, we sort by increasing P value and take the top k ranked DPs for Gain 1 (or Gain 2). Next, we evaluate the logarithmic ratio log ðs 1 =s 2 Þ for the top k DPs, where s 1 and s 2 are the RNA/GRO-seq read counts associated to peaks in the first and second condition. By increasing k, we obtain curves depicted in<ref type="figure" target="#fig_8">Figure 4</ref>. The higher the value, the higher is the association between DP and changes in expression. Regarding gene expression from microarrays, we need an additional step to associate peaks to genes. Peaks are assigned to genes if they are located inside the gene body or close to the gene's promoter (1000 bp upstream); or if the peaks are located 50 Kbps away from the TSS and there is no other gene's TSS in between. The average expression value of genes assigned to a peak is used. Peaks not assigned to genes are ignored for the statistics. We compute the integral of the curves obtaining the single statistic differential average gene expression (DAGE). Let e(k) be the average log ratio expression associated to the best k DPsfor k 2 ½h; 2 Á h;. .. ; H where h is the step size and H the maximum number of DPs used. For visualization purposes, we display the negative values of the DAGE curve for DP Gain 2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Simulated datasets</head><p>The simulation of single ChIP-seq datasets has already been addressed by Zhang et al. (2008) and Humburg (2011), but none of these approaches can be directly used in the DPC problem. We, therefore, developed an algorithm inspired by Humburg (2011) to generate ChIP-seq reads simulating a pair of biological conditions with DPs. In short, for a given reference genome the procedure works as follows:</p><p>(1) selecting genomic regions to include protein domains (region with several binding proteins) and sampling the number of proteins in a domain following a negative Binomial distribution NB m1;p1 ; (2) sampling and placement of reads per protein following a Negative Binomial distribution NB m2;p2 and (3) assignment of a proportion of reads from a protein to each of the simulated biological condition. We use the mean and standard deviation to describe the Negative Binomial distribution. We take into account the original position of the proteins and the proportion of reads to define the true DP (see Supplementary Section S1 for details). We are particularly interested in the effect of protein domain sizes as well as the number of reads in the libraries. We set the parameters (m 1 ,p 1 ) to fð1; 4Þ; ð4; 6Þ; ð8; 14Þg obtaining datasets with an increasing number of proteins per domain. Furthermore, we set the parameters (m 2 ,p 2 ) to fð20; 200 Þ; ð20; 2000Þ; ð100; 200Þg obtaining both datasets with distinct number of reads per peak as well as high variance of reads per peak. We use chromosome 1 of the mouse genome (mm9) as reference genome. For each parameterization choice, we generate 50 pairs of simulated datasets. Methods were evaluated by sorting the DPs by smallest P value and calculating the proportion of true positives among the top r called DPs. A candidate DP is considered a true positive if it overlaps with a true DP (see Supplementary Section S1 for more details).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">HMM parameterization</head><p>For all datasets, we compute the fragment size from the range ^ f=arg max f2F cðfÞ, for F=½0; 5;. .. ; 600. Moreover, we use a step size of 50 and window size of 100 to compute the signal profile. This choice was based on visual inspection of peaks: smaller windows did not affect peaks and larger windows induced too large peaks. We only use input-DNA signal of chromosome 1 to build the GC-content histogram. We use the mappability files that are provided by<ref type="bibr" target="#b13">Landt et al. (2012)</ref>(http:// hgdownload-test.cse.ucsc.edu/goldenPath/mm9/encodeDCC/ wgEncodeMapability/, last access: 20th March 2014). We only consider regions with an mappability value of 1. We implemented our HMM in Python 2.7 by using the SciKit package (<ref type="bibr" target="#b22">Pedregosa et al., 2011</ref>). ODIN is part of the Regulatory Genomics Toolbox (see www.regulatory-genomics. org). Predictions for experiments and simulated data are available at the Web Supplement http://costalab.org/wp/odin. In our experiments, ODIN (with a single component in the mixture model) requires on average 12GB of memory. The calculations last on average 4 h on a 2.4 GHz machine. Computational time increases linearly with the number of components in the case of mixture models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Competing methods</head><p>We use PeakSeq, Quest and MACS as SPCs in combination with DBChIP, DESeq and MAnorm. The SPCs were selected based on their good performance (<ref type="bibr" target="#b4">Chen et al., 2012;</ref><ref type="bibr" target="#b29">Wilbanks and Facciotti, 2010</ref>). We run all SPCs with standard parameter and corresponding input-DNA. The simulated data does not provide input-DNA. As QUEST and PeakSeq can only be executed with input signal, they are not evaluated in the simulation experiments. We refer to the obtained peaks as candidate peaks for the two-stage DPC. DBChIP is proposed for TF data only. Therefore, it uses a fixed window size of 250 bps around the summits of candidate peaks. We also define an own two-stage DPC. This approach merges all candidate peaks and uses them as input for DESeq. Note that distinctly from DBChIP, this approach can find DPs with variable size common in histone ChIP-seq. We separately run DBChIP, DESeq, MAnorm with default parameters and the candidate peaks of PeakSeq, Quest and MACS. ChIPDiff is also run with default parameters (FC = 3, minRegionDist=1000 and minP=0:95). It finds less than 20 peaks for half of the experiments from the TLR4 study. For these experiments, we change parameters (FC = 1.5, minRegionDist=200 and minP=0:7) to obtain at least 100 DPs. Moreover, as ChIPDiff does not provide P values or any criteria for sorting peaks, we can only obtain points for the DAGE statistic. We also try to use RSEG with no success. For the dataset PU1-MPP-CDP, it returns very large peaks (mean size of 58 716 bps) in comparison to ODIN (315 bps). Per definition, RSEG is tailored for identifying broad genomic domains and will not be considered here. MACS2 is run with parameter C = 0.5 for the data from<ref type="bibr" target="#b11">Kaikkonen et al. (2013)</ref>and C = 1.5 for the DC data. We run DBChIP, MAnorm, ChIPDiff, MACS2, our DESeq approach and ODIN for all 15 experiments. DBChIP is only run for TFs data and our DESeq approach for histone data. Therefore, we distinguish between experiments with TF or histone modifications. We will call DPs to be Gain 1 (Gain 2) for all competing methods, whenever they are detected to have higher signal in x 1Á (x 2Á ). We then apply the Friedman-Nemenyi test (<ref type="bibr" target="#b6">Dem sar, 2006</ref>) on the DAGE values. This non-parametric test checks significant differences when more than two methods are applied to multiple datasets. It works in two steps: first, it ranks the methods under comparison and second, if a significant differences exist, it identifies the pairs of methods causing them. Here, the Friedman–Nemenyi test indicates whether one of the methods is assigned to significant higher DAGE values than others.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Genomic signal construction</head><p>We investigate the effect of the preprocessing steps to create the genomic signal (Section 2.1). In particular, we analyze all eight combinations of using: (1) the GC-content model, (2) filtering reads aligned to poor mappability regions and (3) the subtraction of input-DNA. DP predictions are based on chromosome 1 for all 15 experiments on real data. The Friedman–Nemenyi test on DAGE statistics for h=50; H=500 indicates a slight advantage of using input-DNA subtraction and GC-content model compared to using none of the steps for TF data (P value50:1). No significant difference is detected on histone data. However, the Friedman score ranks are similar in both scenarios reinforcing the advantage of the input-DNA subtraction and GC-content model, which will be further used in all experiments (see Supplementary Tables S3–S6).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Method parameterization</head><p>We empirically evaluate the use of parameter constraining and the choice of the HMM's emission distribution as presented in Section 2.2.2. Again, we restrict the analysis to the chromosome 1 of all 15 real data experiments and compute the DAGE statistic (h=50; H=500) with or without parameter constraining. The constraint model has statistical significant higher DAGE values (P value50:006, one-tailed Wilcoxon test) for experiments with TF, while no significant differences are obtained on histone modification experiments. This reinforces the advantage of parameter constraining, which is used in further experiments. Furthermore, we evaluate the use of distinct distributions: Binomial and mixture of Poisson with 1–4 components. As shown in Supplementary Tables S7–S10, no significant difference was found. We, therefore, use the Poisson mixture with the number of components that offers the highest ranking (4 for histones and 1 TFs) as well as the Binomial distribution in the following experiments. Moreover, we evaluate the P value estimation methods of ODIN, DESeq and EdgeR. We use DPs predicted by ODIN with Binomial distribution. ODIN's P value estimation has a significant higher DAGE score than DESeq and EdgeR for TF experiments and a significant higher DAGE score than EdgeR for histone experiments (see Supplementary Tables S15–S18). Finally, we inspect the impact of SPCs (MACS, QUEST and PeakSeq) on two stage peak callers DPChIP, DESeq and MAnorm. As shown in Supplementary Tables S11–S14, significant difference between the use SPCs was found. We use the best ranked combination: MAnorm-macs, DESeq-quest and DBChIP-quest. We discard chromosome 1 regions from all further analysis of real datasets, as they have been used for parameterization experiments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Comparative analysis on simulated data</head><p>Supplementary<ref type="figure">Figure S1</ref>shows the results for simulated data. As expected, methods obtained best performance on experiments with more reads and less number of proteins per domain (bottom left). The performance of MAnorm (green line) for top ranked DPs is quite competitive with ODIN variants (read and yellow lines) on data with few proteins per domains (left column), but its performance deteriorates whenever more proteins are present in the domains. MACS2 (blue line) has similar performance as ODIN variants (read and yellow lines) when large number of reads are present (bottom), but ODIN clearly outperforms MAC2 when peak sizes have a high variance (middle row). We calculate the area under the curve for each experiment to perform a Friedman–Nemenyi test. We then evaluate the overall performance of methods for all conditions (Supplementary Tables S1 and S2). Results indicates that ODIN with Binomial or single Poisson distribution has a significantly higher AUC than MACS2, MAnorm, DESeq and DBChIP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Comparative evaluation on real data</head><p>We perform a visual inspection of the DPs from experiment H3K4me2-0h-24h around the Irf1 gene (<ref type="figure" target="#fig_6">Fig. 3</ref>). MAnorm and our DESeq approach, which have same predictions for this region, can successfully detect changes in large peak areas. ChIPDiff detects most DPs, but have a tendency to call large regions. ODIN and MACS2 are able to detect detailed changes within the large domains. Note that MACS2 and ChIPDiff are not able to recover a DP upstream of Irf1 (marked as DP2) on H3K4me2 0h. The lost of this histone mark after TLR4 treatment is supported by gain of a PU.1 on the very sample location (see Supplementary<ref type="figure">Fig. S7</ref>for PU.1 ChIP-seq profiles). In<ref type="figure" target="#fig_8">Figure 4</ref>, we display DAGE curves for DBChIP, MACS2, our DESeq approach, MAnorm and ODIN for four selected experiments on real data. As ChIPDiff does not provide information to sort the DPs, its results are only represented as points, where the x-axis location corresponds to the number of called DPs. In most scenarios, curves approximate to zero for higher ranks, which indicates that higher ranked DPs are associated to higher expression changes. In some scenarios, such as H3K4me20h-6h, the curve associated to Gain 2 peaks (right bottom) are further from 0 than Gain 1 peaks (right middle). This is an indication that there are more changes in ChIP-seq peaks and gene expression in signal 2 (6 h) than in signal 1 (0 h). This is in accordance with the main message of the TLR4 study, which shows that induction of TLR4 promotes new enhancers<ref type="bibr" target="#b11">Kaikkonen et al., 2013</ref>). While there are some experiment-specific variations, both ODIN variants outperforms other methods on PU.1-MPP-CDP, H3K4me1MPP-CDP, while the performance of ODIN with Binomial distribution is similar to other methods on H3K4me1-0h-6h and PU.1-0h-6h. All DAGE curves can be found at Supplementary Figures S3–S6. Finally, we evaluate the performance of all methods over the 15 real data experiments listed in<ref type="figure" target="#tab_1">Table 1</ref>by computing the DAGE scores for Gain 1 and Gain 2 peaks. The Friedman– Nemenyi test indicates that both ODIN variants have significantly higher DAGE scores than DBChIP and MACS2 on TF experiments (P value50:1, see Supplementary Tables S19 and S20) and significantly higher DAGE scores than DESeq on histone data (P value50:05, see Supplementary Tables S21 and S22). Moreover, ODIN with Binomial distribution has a significant higher DAGE score than MACS2 and MAnorm on histone data. We also performed an evaluation of ChIPDiff by comparing the DAGE values of all methods with H equal to the number of peaks called by ChIPDiff. ODIN with Binomial distribution has significantly higher DAGE scores than ChIPDiff on TF experiments (P value50:1, see Supplementary<ref type="figure" target="#tab_2">Table S24</ref>), while no statistical difference was detected on histone data (see Supplementary<ref type="figure" target="#tab_2">Table S26</ref>). In all cases, both ODIN with binomial and mixture of Poisson distribution ranked best by the Friedman score compared to all competing methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CONCLUSION AND FUTURE WORK</head><p>We propose ODIN, a DPC method that performs genomic signal processing, DPC and P value calculation in an integrated framework. Empirical analysis shows that DPs detected by ODIN are best associated to changes in gene expression of genes neighboring these DPs than several of its competing methods. ODIN can be used with either a Binomial distribution or a mixture of Poisson distribution. It outperforms methods using complex distributions as the Negative Binomial used by DBChIP and PeakDE. These results are further supported with simulated data, where ODIN outperforms competing methods on scenarios with few reads and complex DPs. Moreover, we present the first approach to evaluate DPs methods, which is based on the association of DPs with expression changes in the same cellular conditions; and a methodology to simulate pairs of ChIP-seq read libraries with DPs. Calling DPs is an extremely important but so far poorly explored problem of ChIP-seq analysis. Epigenomic consortia are planning the analysis of ChIP-seq of patients with distinct disease phenotypes (<ref type="bibr" target="#b0">Adams et al., 2012</ref>). Methods capable for detection of DPs by simultaneous analysis of several ChIP-seq data will be crucial for such medical epigenomics applications. Aspects such as the presence the genetic variability of patients (<ref type="bibr" target="#b2">Ashoor et al., 2013</ref>) and the over-dispersion of peaks sizes in biological replicates are open challenges. We plan to extend ODIN to allow the analysis of biological replicates and the simultaneous analysis of more than two cellular conditions.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>and Cs in the bin's underlying sequence. We want to measure the average number of reads from input signal x input assigned to bins on a particular GC-content interval. For an interval ½v; v+ and genomic signal</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>x</head><figDesc>To avoid bias associated to the DNA shearing process, it is usual to subtract the input-DNA from the ChIP-seq genomic signals. We follow the sequencing extraction scaling (SES) approach of Diaz et al. (2012), which performs a signal normalization previous to the subtraction. The rationale is that while input-DNA-and ChIP-seq libraries usually have similar number of reads, the mass of ChIP-seq reads are concentrated in protein–DNA interaction sites. Therefore, a simple subtraction tends to over-penalize the ChIP-seq signal. For a scaling factor SES (see Diaz et al. (2012) for details) and input-DNA x input , we perform for both signals x SES iÁ =x iÁ À Á x input i : 2.1.6 Normalization and bin filtering We perform a sequencing depth scaling approach to normalize the two ChIP-seq signals to be2j be the signal's total sum for x 1Á and x 2Á. We scale up the genomic signal with less overall signal by the factor =max ðS 1 =S 2 ; S 2 =S 1 Þ. For example, if S 1 5S 2 , we have x norm 1Á = Á x 1Á</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><figDesc>More formally, for a given state s, we have Pr s ðx Áj Þ= Pr s1 ðx 1j Þ Á Pr s2 ðx 2j Þ. In case of the Binomial distribution as emission, we have Pr si ðx ij Þ=Bðx ij =k j n; p si Þ= n</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>N with c+d=a+b and n; p 31 ; p 32 are the parameters of the emission distributions of the Back state. The P value for DP Gain 2 can be defined accordingly. For large y 1 , y 2 values, the computation of the above equations are computationally expensive. Following Anders and Huber (2010), we can combine both equation and obtain</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>. We have gene expression data from microarrays for these four cell types from Felker et al. (2010) (GEO accession GSE22432). We use BWA (</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.3.</head><figDesc>Fig. 3. DPs detected on experiment H3K4me2-0h-24h around the Irf1 gene. Bars bellow the ChIP-seq signal indicate the regions called as DPs by distinct methods</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><figDesc>Funding: This work was supported by the Interdisciplinary Center for Clinical Research (IZKF Aachen), RWTH Aachen University Medical School, Aachen, Germany; the Excellence Initiative of the German Federal and State Governments and the German Research Foundation through Grant GSC 111;</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.4.</head><figDesc>Fig. 4. Here we depict the DAGE curves for selected experiments from TLR4 and DC studies. Lines in the first and third row represent DP gained in the first signal (Gain 1), while lines in the second and fourth row in the second signal (Gain 2)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 1. Overview of DP experiments; TLR4 experiments regards data from Kaikkonen et al. (2013) and DC experiments from the dendritic cell development study (Lin et al., in preparation)</figDesc><table>Exp. 
Name 
Protein 
Signal 1 
Signal 2 

TLR4 
PU.1-0h-1h 
PU.1 
0h 
1h 
TLR4 
PU.1-0h-6h 
PU.1 
0h 
6h 
TLR4 
PU.1-0h-12h 
PU.1 
0h 
12h 
TLR4 
PU.1-0h-24h 
PU.1 
0h 
24h 
TLR4 
H3K4me2-0h-1h 
H3K4me2 
0h 
1h 
TLR4 
H3K4me2-0h-6h 
H3K4me2 
0h 
6h 
TLR4 
H3K4me2-0h-24h 
H3K4me2 
0h 
24h 
DC 
PU.1-MPP-CDP 
PU.1 
MPP 
CDP 
DC 
PU.1-CDP-cDC 
PU.1 
CDP 
cDC 
DC 
PU.1-CDP-pDC 
PU.1 
CDP 
pDC 
DC 
PU.1-cDC-pDC 
PU.1 
cDC 
pDC 
DC 
H3K4me1-MPP-CDP 
H3K4me1 
MPP 
CDP 
DC 
H3K4me1-CDP-cDC 
H3K4me1 
CDP 
cDC 
DC 
H3K4me1-CDP-pDC 
H3K4me1 
CDP 
pDC 
DC 
H3K4me1-cDC-pDC 
H3K4me1 
cDC 
pDC </table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">M.Allhoff et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Detecting DPs in ChIP-seq signals with ODIN at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">BLUEPRINT to decode the epigenetic signature written in blood</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Adams</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="224" to="226" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Differential expression analysis for sequence count data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Anders</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Huber</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">106</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">HMCan: a method for detecting chromatin modifications in cancer samples using ChIP-seq data</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Ashoor</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2979" to="2986" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Summarizing and correcting the GC content bias in high-throughput sequencing</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Benjamini</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">P</forename>
				<surname>Speed</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">72</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Systematic evaluation of factors influencing chip-seq fidelity</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">609614</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">MicroChIP–a rapid micro chromatin immunoprecipitation assay for small cell samples and biopsies</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">A</forename>
				<surname>Dahl</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Collas</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page">15</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Statistical comparisons of classifiers over multiple data sets</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Dem Sar</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mach. Learn. Res</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="1" to="30" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Normalization, bias correction, and peak calling for ChIP-seq</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Diaz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>Article. 9</note>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Tgf-beta1 accelerates dendritic cell differentiation from common dendritic cell progenitors and directs subset specification toward conventional dendritic cells</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Felker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Immunol</title>
		<imprint>
			<biblScope unit="volume">185</biblScope>
			<biblScope unit="page" from="5326" to="5335" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Heinz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Cell</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="576" to="589" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<monogr>
		<title level="m" type="main">ChIPsim: Simulation of ChIP-seq experiments. R package version 1</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Humburg</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Remodeling of the enhancer landscape during macrophage activation Is coupled to enhancer transcription</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">U</forename>
				<surname>Kaikkonen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Cell</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="page" from="310" to="325" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">A Statistical framework for the analysis of ChIP-Seq data</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">F</forename>
				<surname>Kuan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Stat. Assoc</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="page" from="891" to="903" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">G</forename>
				<surname>Landt</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1813" to="1831" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Processing and analyzing chip-seq data: from short reads to regulatory interactions</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Leleu</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Lefebvre</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rougemont</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brief. Funct. Genom</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="466" to="476" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Fast and accurate long-read alignment with BurrowsWheeler transform</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="589" to="595" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Detecting differential binding of transcription factors with ChIP-seq</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Liang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Keles¸</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Keles¸</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="121" to="122" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<monogr>
		<title level="m" type="main">Dynamic chromatin signatures and cis-regulatory network control dendritic cell development</title>
		<author>
			<persName>
				<forename type="first">Q</forename>
				<surname>Lin</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Inferring nucleosome positions with their histone mark annotation from chip data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Mammana</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Vingron</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">H.-R</forename>
				<surname>Chung</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2547" to="2554" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">BLUEPRINT: mapping human blood cell epigenomes</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">H A</forename>
				<surname>Martens</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">G</forename>
				<surname>Stunnenberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Haematologica</title>
		<imprint>
			<biblScope unit="volume">98</biblScope>
			<biblScope unit="page" from="1487" to="1489" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Transcriptional regulatory elements in the human genome</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">A</forename>
				<surname>Maston</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annu. Rev. Genom. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="29" to="59" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">ChIP-seq: advantages and challenges of a maturing technology</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">J</forename>
				<surname>Park</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="669" to="680" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Scikit-learn: machine learning in Python</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Pedregosa</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mach. Learn. Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="2825" to="2830" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">A tutorial on hidden Markov models and selected applications in speech recognition</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Rabiner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE</title>
		<meeting>. IEEE</meeting>
		<imprint>
			<date type="published" when="1989" />
			<biblScope unit="page" from="257" to="286" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">D</forename>
				<surname>Robinson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">J</forename>
				<surname>Mccarthy</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Smyth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="139" to="140" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rozowsky</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="66" to="75" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Shao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">16</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Identifying dispersed epigenomic domains from ChIP-Seq data</title>
		<author>
			<persName>
				<forename type="first">Q</forename>
				<surname>Song</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">D</forename>
				<surname>Smith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="870" to="871" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Bayespeak: Bayesian analysis of chip-seq data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Spyrou</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">299</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b29">
	<analytic>
		<title level="a" type="main">Evaluation of algorithm performance in ChIP-seq peak detection</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">G</forename>
				<surname>Wilbanks</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">T</forename>
				<surname>Facciotti</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PloS one</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">11471</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b30">
	<analytic>
		<title level="a" type="main">An hmm approach to genome-wide identification of differential histone modification sites from chip-seq data</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Xu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="2344" to="2349" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b31">
	<analytic>
		<title level="a" type="main">Modeling chip sequencing in silico with applications</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<forename type="middle">D</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>