
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:49+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">treePL: divergence time estimation using penalized likelihood for large phylogenies</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">20 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Stephen</forename>
								<forename type="middle">A</forename>
								<surname>Smith</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Ecology and Evolutionary Biology</orgName>
								<orgName type="institution">University of Michigan</orgName>
								<address>
									<postCode>48109</postCode>
									<settlement>Ann Arbor</settlement>
									<region>MI</region>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Ecology and Evolutionary Biology</orgName>
								<orgName type="institution">University of Tennessee</orgName>
								<address>
									<postCode>37996</postCode>
									<settlement>Knoxville</settlement>
									<region>TN</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Brian</forename>
								<forename type="middle">C</forename>
								<surname>O &apos;meara</surname>
							</persName>
						</author>
						<title level="a" type="main">treePL: divergence time estimation using penalized likelihood for large phylogenies</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="2689" to="2690"/>
							<date type="published" when="2012">20 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts492</idno>
					<note type="submission">Received on April 14, 2012; revised on July 31, 2012; accepted on August 1, 2012</note>
					<note>Associate Editor: David Posada Contact: eebsmith@umich.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Ever larger phylogenies are being constructed due to the explosion of genetic data and development of high-performance phylogenetic reconstruction algorithms. However, most methods for calculating divergence times are limited to datasets that are orders of magnitude smaller than recently published large phylogenies. Here, we present an algorithm and implementation of a divergence time method using penalized likelihood that can handle datasets of thousands of taxa. We implement a method that combines the standard derivative-based optimization with a stochastic simulated annealing approach to overcome optimization challenges. We compare this approach with existing software including r8s, PATHd8 and BEAST. Availability: Source code, example files, binaries and documentation for treePL are available at https://github.com/blackrim/treePL.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Divergence times make phylogenetic hypotheses easier to interpret in light of other information on geology, biogeography and co-diversification. A number of methods exist for transforming branch lengths to be proportional to time. However, many of these methods do not scale well for phylogenies with thousands of taxa. The number of species included in published phylogenies has exploded (<ref type="bibr" target="#b3">Goloboff et al., 2009;</ref><ref type="bibr" target="#b7">Smith et al., 2009</ref>). With the increase in the size of phylogenies, there is the need to develop divergence time methods that are capable of handling larger datasets. Here, we present a method, implemented in the software treePL, for calculating divergence time estimates using penalized likelihood (<ref type="bibr" target="#b6">Sanderson, 2002</ref>) on large phylogenies. Penalized likelihood uses a semi-parametric approach that allows for different rates on different branches but has a smoothing parameter, set using cross-validation, that affects how much rate differences over the tree are penalized. Our approach attempts to overcome the problem of local minima, a problem amplified by including more taxa.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Penalized likelihood</head><p>The optimality criterion used in this article is the penalized likelihood framework described in Sanderson (2002). Note that though this is framed as a likelihood method, it is possible to interpret this as a maximum a posteriori estimate in a Bayesian context given particular priors (<ref type="bibr" target="#b8">Thorne and Kishino, 2005</ref>). It is also possible, following Sanderson's modifications to r8s, to use a related penalty that uses the differences of log rates rather than differences of untransformed rates (the additive penalty). This has been implemented in treePL, but analyses below use the original additive penalty.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">The algorithm</head><p>Divergence time estimation, and penalized likelihood especially, presents a number of optimization challenges. One challenge is the large number of parameters and the ratio of free parameters to observations. This can be dampened by a large penalty function, but still presents a parametric optimization problem. The second challenge is the presence of barriers placed by both the user and the hierarchical nature of phylogenies. We present a first step to overcoming these problems with extremely large phylogenies. Our algorithm includes two main phases: a greedy hill-climbing phase and a stochastic phase. This combination is meant to both speed optimization and avoid local optima. The greedy phase of the optimization step consists of two gradientbased optimization rounds. The first round of optimization uses gradient values from an exact gradient calculator with math derived from Sanderson (2002). The second round of optimization uses auto-differentiation (<ref type="bibr">Gay, 2005;</ref><ref type="bibr" target="#b4">Griewank et al., 1996</ref>). Auto-differentiation, because it has the same complexity as the original function, often continues hill climbing after the exact gradient calculator fails. However, we have found, empirically, that alone it is not as efficient and requires more rounds and restarts than combining exact gradients and auto-differentiation. We found that a stochastic phase, in this case a partial simulated annealing procedure, is helpful in easing the parameters away from local optima. We consider it partial as the step does not consist of a full simulated annealing run. Instead, the phase consists of thousands of stochastic optimization generations followed by intermittent greedy phases. Although this additional step may lengthen convergence time, the result will often improve. The performance of optimization methods can vary dramatically by dataset. We have provided a 'priming' step that will run through each optimization option and report those that show the greatest difference in starting and stopping likelihood scores. Although this can help, researchers should replicate analyses and experiment with settings to assure convergence. We have also provided a 'wiggle' option that will report divergence times that are within two log likelihood units of the best likelihood, suggested by Edwards (1992) as a confidence window. This allows for the visualization of nodes that are particularly uncertain, but *To whom correspondence should be addressed. does not account for all sources of uncertainty (e.g. calibration uncertainty or branch length errors).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Cross-validation The penalized likelihood approach requires</head><p>the identification of a smoothing parameter that affects the penalty for rate variation over the tree. A cross-validation procedure is used to determine the best smoothing parameter. We provide two options for cross-validation: leave one out cross-validation (LOOCV) and random subsample and replicate cross-validation (RSRCV). The LOOCV approach is described in Sanderson (2002) and requires iteratively removing each terminal node, recalculating rates and dates, and recording the error between the predicted value from the estimate and the observed value. RSRCV randomly samples, with replacement, multiple terminal nodes, recalculates rates and dates with these terminal nodes removed and calculates the average error over the sampled nodes. RSRCV replicates this procedure a number of times, with 10 times being typical. Potential sets of terminal nodes that cause the removal of internal nodes (such as a set of terminal nodes that form a clade) are not allowed. This procedure is much faster than LOOCV and produces similar results. Cross-validation can be unstable, but subsampling procedures such as RSRCV may improve this behavior (<ref type="bibr" target="#b5">Kohavi, 1995</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">Implementation</head><p>The above algorithm is implemented in treePL, which is open source and available at https://github.com/blackrim/treePL. Auto-differentiation uses RAD (<ref type="bibr">Gay, 2005;</ref><ref type="bibr" target="#b4">Griewank et al., 1996</ref>) on a single cores and ADOL-C for multiple cores. Likelihood calculations and cross-validation analyses may be distributed on multicore machines using the OpenMP library.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">SIMULATIONS</head><p>We test the performance of treePL, r8s and PATHd8 (<ref type="bibr" target="#b0">Britton et al., 2007</ref>) on simulated datasets with up to 10 000 taxa. Two empirical examples, including comparisons to BEAST, may be seen in the Supplementary Materials, as can details of the simulations. To measure the performance of each method, we measured the R 2 of the estimated node ages against the known node ages (<ref type="figure" target="#fig_0">Fig. 1</ref>). r8s and treePL perform quite similarly and both perform better than PATHd8. Some of the slight performance decrease of treePL as tree size increases may be explained by numerical error with treePL adding nonzero values to effectively zero branch lengths. The poor performance of PATHd8 for many of these trees may be a result of how it resolves conflicting dates and rates. In these cases, PATHd8 allows the conflicting branches to have the same height, thus sinking the branch to its parent, leading to a zero branch length. The time it took to run each analysis was also recorded (<ref type="figure" target="#fig_0">Fig. 1</ref>inset). PATHd8 analyses are almost instantaneous. treePL is far fasterthanr8sbutslowerthanPATHd8.Nevertheless,r8sperforms wellforsmallerdatasets.TheruntimefortreePLishighlydependent on the nature of the dataset, the settings for the stochastic phase of the run, and the optimization method used for the greedy phase. Parallelization in treePL was not used for the simulation runs. The simulated analyses demonstrate that, at least under the particular settings of the simulator, r8s and treePL perform well with treePL being significantly faster than r8s (see Supplemental Materials for performance with empirical datasets). Both programs perform better than PATHd8 in terms of accuracy when compared with the 'true' simulated tree. The simulated analyses also demonstrate that divergence-time analysis with penalized likelihood is reasonable on trees of over 10 000 taxa.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. The performance of r8s, treePL and PATHd8 on the simulated datasets as measured by R 2 of estimated node ages against known ages. The inset shows average runtimes of r8s, treePL and PATHd8 in minutes on simulated datasets. Error bars represent 95% confidence intervals</figDesc></figure>

			<note place="foot">ß The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">treePL at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors acknowledge the 'Floral assembly' working group at NESCent, helpful discussions with Michael Alfaro, Jeremy Beaulieu, Jonathan Eastman, and David Tank and treePL testers.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Estimating divergence times in large phylogenetic trees</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Britton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="page" from="741" to="752" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">W F</forename>
				<surname>Edwards</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1992" />
			<publisher>Johns Hopkins University Press</publisher>
			<pubPlace>Baltimore, MA</pubPlace>
		</imprint>
	</monogr>
	<note>2nd. edn</note>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Semiautomatic differentiation for efficient gradient computations Automatic Differentiation: Applications, Theory, and Tools</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">M</forename>
				<surname>Gay</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lecture Notes in Computational Science and Engineering</title>
		<editor>Bucker,H.M. et al.</editor>
		<imprint>
			<publisher>Springer</publisher>
			<biblScope unit="page" from="147" to="158" />
			<date type="published" when="2006" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Phylogenetic analysis of 73060 taxa corroborates major eukaryotic groups</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Goloboff</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cladistics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1" to="20" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Algorithm 755: ADOL-C: a package for the automatic differentiation of algorithms written in C/Cþþ</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Griewank</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM Trans. Math. Software</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="131" to="167" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A study of cross-validation and bootstrap for accuracy estimation and model selection</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Kohavi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedingsof the 14th International Joint Conference on A.I</title>
		<meeting>of the 14th International Joint Conference on A.I<address><addrLine>San Francisco, CA, USA, Canada</addrLine></address></meeting>
		<imprint>
			<publisher>Morgan Kaufmann Publishers Inc</publisher>
			<date type="published" when="1995" />
			<biblScope unit="page" from="1137" to="1143" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Estimating absolute rates of molecular evolution and divergence times: a penalized likelihood approach</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Sanderson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="101" to="109" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Mega-phylogeny approach for comparative biology: an alternative to supertree and supermatrix approaches</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">A</forename>
				<surname>Smith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Evol. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">37</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">Estimation of divergence times from molecular sequence data Statistical Methods in Molecular Evolution</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">L</forename>
				<surname>Thorne</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Kishino</surname>
			</persName>
		</author>
		<editor>Nielsen,R.</editor>
		<imprint>
			<date type="published" when="2005" />
			<publisher>Springer-Verlag</publisher>
			<biblScope unit="page" from="233" to="256" />
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>