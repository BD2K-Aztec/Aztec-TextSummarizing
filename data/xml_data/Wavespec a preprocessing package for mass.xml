
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:37+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Data and text mining Wave-spec: a preprocessing package for mass spectrometry data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Ming</forename>
								<surname>Li</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">Vanderbilt University</orgName>
								<address>
									<postCode>37232</postCode>
									<settlement>Nashville</settlement>
									<region>Tennessee</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Shuo</forename>
								<surname>Chen</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Biostatistics and Bioinformatics</orgName>
								<orgName type="institution">Emory University</orgName>
								<address>
									<postCode>30322</postCode>
									<settlement>Atlanta</settlement>
									<region>Georgia</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Joan</forename>
								<surname>Zhang</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Cancer Biostatistics Center</orgName>
								<orgName type="institution">Vanderbilt-Ingram Cancer Center</orgName>
								<address>
									<postCode>37232</postCode>
									<settlement>Nashville</settlement>
									<region>Tennessee</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Heidi</forename>
								<surname>Chen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">Vanderbilt University</orgName>
								<address>
									<postCode>37232</postCode>
									<settlement>Nashville</settlement>
									<region>Tennessee</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Yu</forename>
								<surname>Shyr</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">Vanderbilt University</orgName>
								<address>
									<postCode>37232</postCode>
									<settlement>Nashville</settlement>
									<region>Tennessee</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Data and text mining Wave-spec: a preprocessing package for mass spectrometry data</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">5</biblScope>
							<biblScope unit="page" from="739" to="740"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq724</idno>
					<note type="submission">Advance Access publication January 5, 2011 Received on October 27, 2010; revised on December 20, 2010; accepted on December 23, 2010</note>
					<note>[15:19 3/2/2011 Bioinformatics-btq724.tex] Page: 739 739–740 Associate Editor: Martin Bishop Contact: yu.shyr@vanderbilt.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Wave-spec is a pre-processing package for mass spectrometry (MS) data. The package includes several novel algorithms that overcome conventional difficulties with the pre-processing of such data. In this application note, we demonstrate step-by-step use of this package on a real-world MALDI dataset. Availability: The package can be downloaded at http://www.vicc.org/biostatistics/supp.php. A shared mailbox (wave-spec@vanderbilt.edu) also is available for questions regarding application of the package.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>This paper demonstrates how the Wave-spec package works, as an application note designed to complement a Wave-spec method paper published previously (<ref type="bibr" target="#b0">Chen et al., 2009</ref>). The rest of this paper is organized as a step-by-step demonstration on real MALDI-TOF data and follows the procedure presented in Supplementary<ref type="figure">Figure S1</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">WAVE-SPEC APPLICATION</head><p>Users of Wave-spec must have basic programming skills in Matlab as well as background knowledge on mass spectrometry (MS) data. Given the complexity of high-throughput datasets, it is unrealistic to expect that an inexperienced user would master the use of Wavespec, even with the thorough guidance outlined here.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Read in data</head><p>For the purpose of demonstration, we chose 210 spectra from one training cohort in a published dataset: 70 patients in 'Italian A' with 3 spectra per patient. Details of the data are given in (<ref type="bibr" target="#b1">Taguchi et al., 2007</ref>). For a batch read-in, it is best to put all the spectrum files in one folder. For example, we place the data in the following folder and the first command is to give the directory: dir = 'C:\Mass Project\Mass Data\';</p><p>In .txt format, each data file should have two columns. The first column is m/z, and the second is intensity. Based on our experience, * To whom correspondence should be addressed. in most cases, the spectra will have the same acquisition frequency but slightly different m/z values across all samples. The following two commands are used to combine all spectral intensities (denoted as Y ) and to provide a common m/z value with the same dimension for all spectra.It is important to note two other possible situations involving m/z values: (i) all spectra share exactly the same m/z values. In this case, we need only the first command; and (ii) the acquisition frequencies are different, in which case the m/z values exhibit a large discrepancy across all samples (for example, due to being acquired from different machines/institutes). In this case, an interpolation algorithm might be needed to decide a common m/z value.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Calibration</head><p>Calibration is a highly interactive process. First, prior to calibration, we need a candidate calibration peak list, which is typically provided by the investigator. Secondly, we select appropriate peaks from this list by viewing their shape in the data we have [criteria for candidate peak selection are described in (<ref type="bibr" target="#b0">Chen et al., 2009)]</ref>. For example, Supplementary<ref type="figure">Figure S2</ref>shows that 9428 might be a good choice, as are 6631, 11 649.3, and 15 868. Therefore, we use the following commands for spectral calibration. R=<ref type="bibr">[6631 9428 11649.3 15868]</ref>; idR=wsMz2Id(R,mz); id=<ref type="bibr">[1:9900]</ref>; YA=msalign(id',Y,idR);<ref type="bibr">[CutSt CutEd]</ref>=wsNaNRemoval(YA); YA = YA(CutSt:end-CutEd,:); mz = mz(CutSt:end-CutEd);</p><p>Note that, with the last three lines of code, we ignore some of the starting and ending values of the spectra, to avoid possible N/A values generated by the calibration process at starting and/or ending positions of spectra. The following process is not affected by these missing values. After calibration, we need to check the calibration performance, not only plotting the spectra before and after calibration around the calibration point, but also viewing the overall calibration performance for the full spectral range. For example, Supplementary Figures S2 and S3 show the results before and after calibration around candidate peak 9428. (Note that we generated and viewed additional plots to check the overall calibration performance, without presenting them here.)<ref type="bibr">[15:19 3/2/2011 Bioinformatics-btq724.tex]</ref>Page: 740 739–740</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>M.Li et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Feature selection</head><p>The step after calibration is to extract common features from the spectra. As explained in the initial method paper, the number of 'peaks' is determined by the level of wavelet denoising, and an appropriate smoothing threshold is obtained by a feedback index: the ratio of baseline area to total area under the peak location distribution curve. To balance the tradeoff between admitting false peaks and removing true peaks, we apply the following schema. First, we prespecify the feedback index upper limit (for example, 0.05). Then, we increase the wavelet threshold from relatively low levels until the feedback index is low enough to meet the upper limit constraint. To illustrate the threshold selection process, we set 3 values for the wavelet denoising threshold, thre, and set other parameters with fixed values in the code below.In most cases, the recommended selection range for thre is between 40 and 80. The other key parameters to tune and their recommended ranges are: (i) decomposition level, decomp,<ref type="bibr">[2,</ref><ref type="bibr">3,</ref><ref type="bibr">4]</ref>; (ii) spectral intensity signal-to-noise ratio, s,<ref type="bibr">[</ref>list =<ref type="bibr">[]</ref><ref type="figure">Figure S4</ref>shows that when the threshold is set at 60, the feedback index obtains optimal values along the whole spectral range. Such a figure is usually generated to assist on deciding the optimal threshold. We then apply this parameter to achieve the final smoothing.<ref type="bibr">[peak,YP]</ref>=wsDenos(YA,mz,decomp,60,s);<ref type="bibr">[inten,bins,snr]</ref>=wsKde(peak,0,0,st,ed,bw);</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Feature quantification</head><p>We quantify the selected features by calculating the area under a baseline-corrected (YB) and normalized (YN) curve. The final output intensity for selected features are auc. These steps can be achieved using the following code: YB = msbackadj(mz,YP); YN = msnorm(mz,YB); auc = wsAUC(bins,mz,YN); Supplementary<ref type="figure">Figure S5</ref>provides average curves for the whole m/z range at 3 different pre-processing stages: (i) denoised only; (ii) denoised plus background-corrected; and (iii) denoised, background-corrected and normalized. The identified peaks are contained in rectangles (bins). This plot is helpful when reviewing and verifying pre-processing at the end of the procedure: we expect to see all large peaks contained in bins, and the average curve is smooth without elevated background. (Supplementary<ref type="figure">Figure S6</ref>is a detailed version of Supplementary<ref type="figure">Figure S5</ref>for a small m/z range.) Such plots can be obtained using the following code: wsBinPlot(bins,mz,mean(YP')', mean(YB')',mean(YN')');</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Output results</head><p>The final step in the procedure is to write out the results or any intermediate values that might be needed for further statistical analysis. For example, for bin range, peak values and names of each spectrum, use the following code to write out results: dlmwrite('C:\bins.txt',bins,'delimiter','\t'); dlmwrite('C:\auc.txt',auc,'delimiter','\t'); cell2csv('C:\specNames.csv',<ref type="bibr">SpecName,',',2000</ref>);</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">DISCUSSION AND CONCLUSION</head><p>By using a publicly available mass spectrometry dataset, we have demonstrated how Wave-spec works. This package can be applied to many types of MS data, such as direct infusion or flow injection MS data, as well as MALDI-TOF MS reflectron-mode data. A user who wishes to apply our package should adapt our sample code accordingly and refer to the corresponding method paper.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[Y,mz,SpecName,MZ]=wsRead(dir,10000); [Y,mz]=wsMzAlign(MZ,Y,9900);</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>2 to 4]; (iii) band width, bw, [1 to 3]; and (iv) starting and ending m/z location, st and ed, respectively, [2k to 3k] and [17k to 20k] Dalton. (Note that the above parameter ranges have been successfully applied to most datasets we have analyzed; for any specific project with much tense or loose acquisition frequency, these values might not work and should be adjusted accordingly.) After setting the above parameters, we are ready to calculate the feedback index. The following codes calculate the feedback index and generate Supplementary Figure S4. (Note: inten is peak intensity value, bins provides peak location and range, and snr is the ratio of baseline area to the total area under the peak location distribution curve.)</figDesc></figure>

			<note place="foot">© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We wish to thank Lynne Berry and Yvonne Poindexter for their editorial work on this manuscript.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A novel comprehensive wave-form MS data processing method</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="808" to="814" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Mass spectrometry to classify non-small-cell lung cancer patients for clinical outcome after treatment with epidermal growth factor receptor tyrosine kinase inhibitors: A multicohort cross-institutional study</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Taguchi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Natl. Cancer Inst</title>
		<imprint>
			<biblScope unit="volume">99</biblScope>
			<biblScope unit="page" from="838" to="846" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>