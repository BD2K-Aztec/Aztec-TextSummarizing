
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:46+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis Improving SNP discovery by base alignment quality</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Heng</forename>
								<surname>Li</surname>
							</persName>
							<email>http://samtools.sourceforge.net Contact: hengli@broadinstitute.org</email>
							<affiliation key="aff0">
								<orgName type="institution">Broad Institute</orgName>
								<address>
									<addrLine>7 Cambridge Center</addrLine>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis Improving SNP discovery by base alignment quality</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">8</biblScope>
							<biblScope unit="page" from="1157" to="1158"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr076</idno>
					<note type="submission">Received on October 14, 2010; revised on January 20, 2011; accepted on February 6, 2011</note>
					<note>[11:44 21/3/2011 Bioinformatics-btr076.tex] Page: 1157 1157–1158 Associate Editor: John Quackenbush</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>I propose a new application of profile Hidden Markov Models in the area of SNP discovery from resequencing data, to greatly reduce false SNP calls caused by misalignments around insertions and deletions (indels). The central concept is per-Base Alignment Quality, which accurately measures the probability of a read base being wrongly aligned. The effectiveness of BAQ has been positively confirmed on large datasets by the 1000 Genomes Project analysis subgroup. Availability:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>One of the leading sources of errors in SNP discovery is errors caused by indels (<ref type="bibr" target="#b3">Li and Homer, 2010</ref>). Current solutions include realignment and filtering SNPs around predicted indels. However, realignment is computationally intensive; filtering SNPs around predicted indels is hampered by indel discovery which itself is a harder problem. This article aims to provide an effective and efficient solution to sorting out SNPs caused by misalignments. To begin with, we need to make a distinction between read mapping and read alignment, which are often taken as synonymous. I define the alignment of a read as the set of coordinate pairs of read and reference bases that are placed together, while define the mapping of a read as the coordinate interval between the first and the last reference bases inclusive in the alignment. We say an alignment is correct if all bases are aligned correctly and say a mapping is correct if it overlaps the true mapping. Therefore, an alignment can be wrong even if the underlying mapping is correct. Wrong alignments are mostly caused by the ambiguity in the presence of indels when we are unsure whether differences should be explained by mismatches or by indels. They tend to reoccur in the same context and deceive SNP callers into calling false SNPs. To account for the intrinsic alignment ambiguity, I model the read alignment with a profile HMM and compute a per-Base Alignment Quality (BAQ) to directly evaluate the probability of misalignment of each base. I will show that by replacing the original base quality with the minimum between the base quality and BAQ we can dramatically improve the SNP accuracy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">The profile HMM for computing BAQ</head><p>Let the nucleotide reference sequence be x = r 1 r 2 ...r L (in practice x is the reference subsequence around a mapping) and the read sequence be y = c 0 c 1 ...c l c l+1 where c 0 ≡ 'ˆ' marks the start of the read and c l+1 ≡ '$' marksthe end. Let i , i = 1...l, be the substitution probability associated with c i , which in practice is set to be the maximum between the scale mutation rate and the sequencing error probability deduced from the base quality. We can construct a profile HMM to simulate how to generate the read sequence y from the reference x without considering introns (<ref type="figure" target="#fig_0">Fig. 1</ref>). If we index the five types M, I, D, S and E by 0, 1, 2, 3 and 4, respectively, the transition matrix between types of states is:</p><formula>(a ij ) 5×5 = ⎛ ⎜ ⎜ ⎜ ⎜ ⎝ (1−2α)(1−γ) α(1−γ) α(1−γ) 0 γ (1−β)(1−γ) β(1−γ) 0 0 γ 1−β 0 β 0 0 (1−α)/L α/L 0 0 0 0 0 0 00 ⎞ ⎟ ⎟ ⎟ ⎟ ⎠</formula><p>where α is the site-independent gap open probability, β the gap extension probability and γ = 1/(2l) controls the average length of the read which does not affect the computation of BAQ in practice, although a formal proof is lacking. By default α and β are set to 0.001 and 0.1, respectively. They should be adjusted based on the sequencing indel error rate. As to emissions, the S state only emits the start symbol ('ˆ') and E emits the end ('$'). D are silent states that do not emit any symbols. The emission probability from I k is set to 0.25, and from M is a function of substitution probabilities { i }, which is, for i = 1,...,l:</p><formula>P(c i |M k ) = e ki = 1− i if r k = c i i /3 otherwise</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">The forward and the backward algorithms</head><p>The recurrence equations are given as follows where any undefined values in the forward matrix f or the backward matrix b are assigned to zeros. The initialization of the forward algorithm is (k = 1,...,L):Page: 1158 1157–1158</p><formula>f 0,S = 1, f 1,M k = e k1 a 30 , f 1,I k = a 31 /4</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>H.Li</head><p>For i = 2,...,l and k = 1,...,L:The probability of the read being generated from the reference equals f l+1,E = b 0,S. In development, evaluating the equality helps to check the correctness of the implementation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Computing BAQ</head><p>We define an alignment A as a set of coordinate pairs {(</p><formula>i 1 ,k 1 ),...,(i p ,k p )} with 1 ≤ i 1 &lt; ··· &lt; i p ≤ l and 1 ≤ k 1 &lt; ··· &lt; k p ≤ L. For convenience, define κ i = κ A i = k if (i,k) ∈ A 0</formula><p>otherwise as the coordinate of the reference base that the read base c i is aligned to. The BAQ is computed as Q(i|A) = −10log 10 1−Pr{i-th read base aligned to</p><formula>κ i |A} = −10log 10 1− f i,Mκ i ·b i,Mκ i f l+1,E As Q(i|A)</formula><p>is mostly above 40, the logarithm scale is appropriate. In SNP calling, we update the i-th base quality to min{q i ,Q(i|A)} where q i is the original base quality. The SNP calling algorithm may not need to be changed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Numerical stability and banded acceleration</head><p>Given long sequences, the forward/backward algorithm given above may suffer from floating point underflow. For numerical stability, we compute˜f</p><formula>compute˜ compute˜f i, ¯ k = f i, ¯ k i j=0 s j , ˜ b i, ¯ k = b i, ¯ k l+1 j=i s j</formula><p>instead, where ¯ k represents any state and the scaling factor s i is chosen such that</p><formula>¯ k ˜ f i, ¯ k = 1</formula><p>. I refer to<ref type="bibr" target="#b1">Durbin et al. (1998)</ref>and the source code for details on computing˜fcomputing˜ computing˜f , ˜ b and s. Another concern with the computation of BAQ is the quadratic time and space complexity O(L ·l). This can be resolved by only computing the forward and the backward matrices within a band that is large enough to contain the likely alignments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS AND DISCUSSIONS</head><p>BAQ is implemented in the SAMtools software package (<ref type="bibr" target="#b2">Li et al., 2009</ref>), distributed under the MIT open source license.<ref type="bibr" target="#b0">Consortium, 2010</ref>), which is done in 12 CPU hours with 110 MB memory.<ref type="figure">Figure 2</ref>compares the quality of the call sets with and without BAQ applied. Note that for human, the transition/transversion ratio (ts/tv) is above 2, while ts/tv of random errors is 0.5. Thus, a worse call set tends to have a lower ts/tv. The much higher ts/tv with BAQ applied indicates that BAQ has effectively suppressed many false SNPs. In conclusion, BAQ successfully resolves false SNPs caused by misalignment and improves the accuracy of SNP discovery. In addition to base quality and mapping quality (<ref type="bibr" target="#b3">Li and Homer, 2010</ref>), BAQ is another useful statistic towards accurate SNP calling.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. The topology of the profile HMM for BAQ computation. It consists of five types of states: alignment matches (M), insertions to the reference (I), deletions (D), alignment start (S) and alignment end (E). The S state points to every M and I state while every M and I points to E. States S and E are plotted together to avoid excessive dotted lines in the figure.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>[11:</head><figDesc>44 21/3/2011 Bioinformatics-btr076.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig</head><figDesc>Fig. 2. Transition–transversion ratio (ts/tv) as a function of the number of SNP calls. SNPs are sorted by the posterior probability of the site being a SNP (SNP probability). Given a threshold on the SNP probability, the number of SNPs of higher probability and their ts/tv are plotted. For the solid line, filters in use are as follows: (i) total depth below 500; and (ii) root mean square mapping quality above 10; (iii) P-value of reference and non-reference bases being evenly distributed on both strands is above 10 −4 (by exact test).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>f i,M k = e ki a 00 f i−1,M k−1 +a 10 f i−1,I k−1 +a 20 f i−1,D k−1 f i,I k = a 01 f i−1,M k +a 11 f i−1,I k /4 f i,D k = a 02 f i,M k−1 +a 22 f i,D k−1 and for i = l +1: f l+1,E = k a 04 f l,M k +a 14 f l,I k The initialization of the backward algorithm is b l+1,E = 1, b l,M k = a 04 , b l,I k = a 14 For i = l −1,...,1 and k = L,...,1: b i,M k = e k+1,i+1 a 00 b i 1 ,M k+1 +a 01 b i+1,I k /4+a 02 b i,D k+1 b i,I k = e k+1,i+1 a 10 b i+1,M k+1 +a 11 b i+1,I k /4 b i,D k = (1−δ i1 ) e k+1,i+1 a 20 b i+1,M k+1 +a 22 b i,D k+1 and for i = 0: b 0,S = k e k1 a 30 b 1,M k +a 31 b 1,I k /4</figDesc><table></table></figure>

			<note place="foot">© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>I am grateful to Gabor Marth and Hyun Min Kang whose works have inspired me to develop BAQ, to the 1000 Genomes Project analysis subgroup for the helpful discussions and to the three reviewers whose comments have helped me to improve the manuscript.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A map of human genome variation from population-scale sequencing</title>
		<author>
			<persName>
				<forename type="first">Consortium</forename>
				<surname>Genomes Project</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">467</biblScope>
			<biblScope unit="page" from="1061" to="1073" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title level="m" type="main">Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Cambridge University Press</publisher>
			<pubPlace>Cambridge, UK</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">A survey of sequence alignment algorithms for nextgeneration sequencing</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Homer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brief Bioinform</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="473" to="83" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>