
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:55+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">bio-samtools 2: a package for analysis and visualization of sequence and alignment data with SAMtools in Ruby</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Graham</forename>
								<forename type="middle">J</forename>
								<surname>Etherington</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Sainsbury Laboratory</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ricardo</forename>
								<forename type="middle">H</forename>
								<surname>Ramirez-Gonzalez</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">The Genome Analysis Centre</orgName>
								<orgName type="institution">Norwich Research Park</orgName>
								<address>
									<postCode>NR4 7UH</postCode>
									<settlement>Norwich</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Dan</forename>
								<surname>Maclean</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">The Sainsbury Laboratory</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">bio-samtools 2: a package for analysis and visualization of sequence and alignment data with SAMtools in Ruby</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv178</idno>
					<note type="submission">Received on August 18, 2014; revised on February 17, 2015; accepted on March 23, 2015</note>
					<note>Genome analysis *To whom correspondence should be addressed. Associate Editor: Gunnar Ratsch Availability and implementation: bio-samtools is available as a BioGem from http://www.biogems. info or as source code from https://github.com/helios/bioruby-samtools under the MIT License. Contact: dan.maclean@tsl.ac.uk</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: bio-samtools is a Ruby language interface to SAMtools, the highly popular library that provides utilities for manipulating high-throughput sequence alignments in the Sequence Alignment/Map format. Advances in Ruby, now allow us to improve the analysis capabilities and increase bio-samtools utility, allowing users to accomplish a large amount of analysis using a very small amount of code. bio-samtools can also be easily developed to include additional SAMtools methods and hence stay current with the latest SAMtools releases. Results: We have added new Ruby classes for the MPileup and Variant Call Format (VCF) data formats emitted by SAMtools and introduced more analysis methods for variant analysis, including alternative allele calculation and allele frequency calling for SNPs. Our new implementation of bio-samtools also ensures that all the functionality of the SAMtools library is now supported and that bio-samtools can be easily extended to include future changes in SAMtools. bio-samtools 2 also provides methods that allow the user to directly produce visualization of alignment data.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Many large scale genomics studies rely heavily on re-sequencing experiments in which genomes of individuals or populations are to be compared. Typically these experiments begin with shotgun sequencing of DNA using high-throughput methods followed by alignment of the sequences to a reference genome assembly. Overdeveloped SAMtools features and can produce publication-quality visualizations of data with minimal effort by the coder. We previously described bio-samtools (<ref type="bibr" target="#b7">Ramirez-Gonzalez et al., 2012</ref>) a Ruby language binding to the SAMtools library and a biogem of the BioRuby framework (<ref type="bibr">Bonnal et al., 2012</ref>). Since its release, bio-samtools has been downloaded &gt;25 000 times. SAMtools is in constant development and hence there is a need to accommodate any future functionality of SAMtools by facilitating extension of our software by other programmers.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Approach</head><p>The original bio-samtools package was implemented around libbam.so (for Linux) and libbam.1.dylib (for Mac OS X), the core shared object library in the SAMtools package. bio-samtools used the Ruby Foreign Function Interface (https://rubygems.org/gems/ffi) package as a bridge between the two languages. We now use a straightforward but simple and flexible pipe interface that captures the standard output stream from SAMtools directly. This allows all functions to be executed and captured with ease by parsing and presenting data as it passes in from SAMtools standard output. A number of new Classes and methods have been added to bio-samtools 2 which allows users to carry out complex analysis with only a small amount of code. The major additions are described here.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Bio::DB::Pileup</head><p>SAMtools MPileup utility provides data in a reference-position-wise format. bio-samtools abstracts this in the Bio::DB::Pileup class and returns simple objects that provide easy access to further methods, such as calculating allele frequencies, calling a consensus and creating a VCF (<ref type="bibr" target="#b0">Danecek et al., 2011</ref>) object. The code below demonstrates how easily pileup data can be used to extract the consensus bases from a BAM file. bam ¼ Bio::DB::Sam.new(:fasta ¼&gt; 'ref.fasta', :bam ¼&gt; 'my_bam.bam') bam.mpileup do jpileupj pileup.consensus end 2.2 Bio::DB::VCF The Bio::DB::VCF class represents variant information in an informative, concise and compact manner, allowing only variant positions to be maintained. Using the Bio::DB::VCF class, bio-samtools allows the analysis of VCF-formatted data, including the comparison of variants across any number of samples. It allows the user to easily carry out analysis of consensus calls, genotypes and allele frequencies, which can then be used for further downstream analyses. bio-samtools 2 also has a number of extra analysis methods not available in the SAMtools library. For example, with just a few lines of code a user could easily count the reference and nonreference bases at each position and then go on to calculate the allele frequencies of those bases. bio-samtools also allows users to calculate the consensus sequence for any site or identify the genotype for any indel or SNP. bio-samtools 2 also has the advantage of working within other Ruby code to complement bespoke analysis methods and can also be used in the development of web applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Visualization</head><p>We have also added the functionality of creating publication-quality visualizations of genome read coverage plots for regions of sequence alignments (<ref type="figure">Fig. 1</ref>). This is achieved by taking a Bio::DB::Sam object (from the class representing the SAM/BAM file), creating a pileup object and extracting the resulting read coverage. This is then plotted into SVG which can be written to a file or loaded straight into a webpage.<ref type="figure">1</ref>. Coverage plots demonstrating the formatting available to bio-samtools 2. The height of the plot represents coverage over a given region. The numbered scale above each plot represents the genome position. The width of each bar on the plot is set by the bin parameter when calling the plot_coverage method</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>We have provided an example of some bio-samtools 2 code to demonstrate the simple but effective code to create rich plots direct from bio-samtools 2. bam ¼ Bio::DB::Sam.new(:fasta ¼&gt; 'ref.fasta', :bam ¼&gt;'my_bam.bam') bam.plot_coverage( " chr_1 " , 201, 2000,:bin¼&gt;20, : svg ¼&gt; " out.svg " ,:fill_color ¼&gt; 'red') Funding RHRG is funded by a Norwich Research Park PhD Studentship and a Funding and Maintenance Grant from The Genome Analysis Centre. G.J.E. and D.M. are supported by The Gatsby Charitable Foundation. Conflict of Interest: none declared. References Bonnal,R.J. et al. (2012) Biogem: an effective tool-based approach for scaling up open source software development in bioinformatics. Bioinformatics, 28, 1035–1037.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.</head><figDesc>Fig. 1. Coverage plots demonstrating the formatting available to bio-samtools 2. The height of the plot represents coverage over a given region. The numbered scale above each plot represents the genome position. The width of each bar on the plot is set by the bin parameter when calling the plot_coverage method</figDesc></figure>

			<note place="foot" n="100"> different high-throughput aligners are now available (Wikipedia, 2014) (http://en.wikipedia.org/wiki/List_of_sequence_ alignment_software), including BWA (Li and Durbin, 2010), Bowtie (Langmead et al., 2009) and SOAP (Li et al., 2008). The standard storage format for this data is Sequence Alignment/Map (SAM) format (Li et al., 2009) which describes alignments in a read-wise fashion. Analysis of the alignments and downstream inference requires high-throughput interrogation of numerous alignment files; hence, programmatic interfaces allowing easy access to the data in these files are widely used. Manipulation of SAM (and the compressed, indexed variant, BAM) can be done in many high-level languages with a variety of packages, including SAMtools (Li et al., 2009), Picard (http://picard.sourceforge.net), GATK (McKenna et al., 2010), bio-samtools (Ramirez-Gonzalez et al., 2012) Bioperl (Stajich et al., 2002), Rsamtools (Morgan et al., 2013) and pysam (https://github.com/pysam-developers/pysam). Here, we describe bio-samtools 2, a new Ruby language SAMtools interface that provides new classes for describing genomic regions and genetic variants, allows the easy addition of newly V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2565 Bioinformatics, 31(15), 2015, 2565–2567 doi: 10.1093/bioinformatics/btv178 Advance Access Publication Date: 29 March 2015 Applications Note at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="3"> Conclusion bio-samtools 2 is a useful and flexible Ruby library for programmatic access to SAMtools. It contains extra analysis and visualization methods not present in the SAMtools library, which allows the coding of complex analysis methods with a small amount of code. The flexibility of bio-samtools 2 also allows new SAMtools methods to be implemented easily and quickly. bio-samtools 2 can also be integrated into other Ruby software, including web applications.</note>

			<note place="foot">G.J.Etherington et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>We thank Raoul J.P. Bonnal for maintaining the bio-samtools source code and gem repository and Jirapong Nanta, Ben J Woodcroft, Francesco Strozzi, Bradford Powell, Fedor Gusev and Yuri Pirola for contributions and useful suggestions.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">The variant call format and vcftools</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Danecek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2156" to="2158" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Ultrafast and memory-efficient alignment of short dna sequences to the human genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Fast and accurate long-read alignment with burrows-wheeler transform</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="589" to="595" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">The sequence alignment/map format and samtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Soap: short oligonucleotide alignment program</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="713" to="714" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The genome analysis toolkit: a mapreduce framework for analyzing next-generation dna sequencing data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Mckenna</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="1297" to="1303" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<monogr>
		<title level="m" type="main">Rsamtools: Binary alignment (BAM), FASTA variant call (BCF), and tabix file import, R package version 1.18</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Morgan</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>bioconductor. .org/packages/release/bioc/html/Rsamtools.htm</note>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Bio-samtools: Ruby bindings for samtools, a library for accessing bam files containing high-throughput sequence alignments</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Ramirez-Gonzalez</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Source Code Biol. Med</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">6</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">The bioperl toolkit: Perl modules for the life sciences</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">E</forename>
				<surname>Stajich</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="1611" to="1618" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">List of sequence alignment software</title>
	</analytic>
	<monogr>
		<title level="j">Wikipedia</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>