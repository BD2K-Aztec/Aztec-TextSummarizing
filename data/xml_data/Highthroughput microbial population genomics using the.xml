
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:30+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis High-throughput microbial population genomics using the Cortex variation assembler</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Zamin</forename>
								<surname>Iqbal</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Wellcome Trust Centre for Human Genetics</orgName>
								<address>
									<addrLine>Roosevelt Drive</addrLine>
									<postCode>OX3 7BN</postCode>
									<settlement>Oxford</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Isaac</forename>
								<surname>Turner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Wellcome Trust Centre for Human Genetics</orgName>
								<address>
									<addrLine>Roosevelt Drive</addrLine>
									<postCode>OX3 7BN</postCode>
									<settlement>Oxford</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Gil</forename>
								<surname>Mcvean</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Wellcome Trust Centre for Human Genetics</orgName>
								<address>
									<addrLine>Roosevelt Drive</addrLine>
									<postCode>OX3 7BN</postCode>
									<settlement>Oxford</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<surname>Barrett</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Statistics</orgName>
								<address>
									<addrLine>South Parks Road</addrLine>
									<postCode>OX1 3TG</postCode>
									<settlement>Oxford</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis High-throughput microbial population genomics using the Cortex variation assembler</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="issue">2</biblScope>
							<biblScope unit="page" from="275" to="276"/>
							<date type="published" when="2013">2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts673</idno>
					<note type="submission">Received on August 9, 2012; revised on November 12, 2012; accepted on November 13, 2012</note>
					<note>Advance Access publication November 19, 2012 Availability: http://cortexassembler.sourceforge.net (GPLv3 license). Contact: Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We have developed a software package, Cortex, designed for the analysis of genetic variation by de novo assembly of multiple samples. This allows direct comparison of samples without using a reference genome as intermediate and incorporates discovery and genotyping of single-nucleotide polymorphisms, indels and larger events in a single framework. We introduce pipelines which simplify the analysis of microbial samples and increase discovery power; these also enable the construction of a graph of known sequence and variation in a species, against which new samples can be compared rapidly. We demonstrate the ease-of-use and power by reproducing the results of studies using both long and short reads.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Genome sequencing of pathogens is of growing value to public health as a means of distinguishing genetic variants correlated with drug resistance (<ref type="bibr" target="#b5">Mwangi et al., 2007</ref>) or virulence (den<ref type="bibr" target="#b1">Bakker et al., 2011</ref>), for tracking of transmission chains, and for within-host evolution studies (<ref type="bibr" target="#b6">Young et al., 2012</ref>). At the heart of all these applications is the requirement to be able to compare the genomes of different samples. Most current tools (<ref type="bibr" target="#b3">Li et al., 2009;</ref><ref type="bibr" target="#b4">McKenna et al., 2010</ref>) are dependent on alignment to a reference genome, and cannot detect differences between genomes directly. It is known that alignment introduces a bias towards the reference (<ref type="bibr" target="#b0">Degner et al., 2009</ref>) and has limited power for indel discovery<ref type="bibr">[Fig. 3a in Iqbal et al. (2012)]</ref>. Furthermore, using a reference is inherently problematic as microbial strains can be highly diverged. We showed in<ref type="bibr" target="#b2">Iqbal et al. (2012)</ref>that the Cortex assembler has power to detect single-nucleotide polymorphisms (SNPs), indels and structural variants by simultaneously de novo assembling multiple samples (each corresponding to a 'colour' in a de Bruijn graph) and detecting variants as graph motifs. A limitation of a de Bruijn graph approach is the use of a single kmer size. There is in general no optimal kmer for variant discovery in a given dataset—variants near repeat sequence will only be discoverable at higher kmers, but lower coverage variants will need a lower kmer<ref type="bibr" target="#b2">[(Iqbal et al., 2012</ref>) Supplementary Information Section 1.3 onwards]. We have therefore introduced pipelines to do discovery on many samples at many kmer values, and then genotype all samples at all discovered sites. Discovery can be done jointly in all samples (with or without a reference), or per sample against a reference. We demonstrate by reproducing the results of two published studies. loaded into the graph for discovery/genotyping. Processing 1000 Staphylococcus aureus samples would require of the order of 106 Gb RAM (Supplementary Information, Section 5). Time complexity of each step is shown in<ref type="figure">Table 1</ref>; note the nonparallelizable steps scale linearly with number of samples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">A REPOSITORY OF VARIATION</head><p>Assembled graphs and callsets are a repository of known sequence and variation. If a new sample is obtained, pre-existing binaries (both workflows) and callsets (independent) are reused; the sample is compared with previous sequence (joint) or with the reference (independent) and all samples are regenotyped at all sites. Thus, Cortex allows new samples to be compared with the entire pan-genome (see Supplementary Information Section 13 for further details).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CASE STUDIES</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Rapid high-quality calls without manual curation</head><p>We show Cortex can generate results of comparable quality to those from labour-intensive whole-genome assembly and alignment. In<ref type="bibr" target="#b5">Mwangi et al. (2007)</ref>, the authors Sanger-sequenced two strains of S.aureus (depth 9Â), did two whole-genome assemblies, mapped reads to contigs, a three-way alignment between the assemblies and a reference, called variants, and removed alignment errors, giving 32 validated SNP differences on the chromosome. Post-publication, 8 further SNPs (one validated) were found when the assemblies were finished (M. Mwangi, personal communication). Using the joint workflow (k ¼ 31,61 and 160 MB RAM), it took 188 seconds to call 36 differences between the strains, including 29 (2) of the published (post-publication) Mwangi callset, 30 of the 33 validated calls and 33 confirmed by finished references (Supplementary Information Section 11).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Comparable sensitivity to mapping</head><p>We here show Cortex attaining the same sensitivity as mapping-cased calling for microbial genomes by reproducing the results of (<ref type="bibr">Young el al., 2012</ref>), who analysed 72 isolates (100Â each, 100 bp Illumina reads) of S.aureus. They used mapping (Stampy/samtools) to two references (MSSA476 and their own assembly), plus variant assembly (early release of Cortex), plus manual curation, to find 32 (2) SNPs/indels placeable on MSSA476 (their reference). We reproduced their 32 calls (independent workflow, kmer ¼ 61, 10 GB RAM), in 5.5 h (one CPU). The other two sites were also called (independentþtheir reference or joint workflow) (Supplementary Information Section 12).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">CONCLUSION</head><p>We have shown that the Cortex population assembler provides a method for rapid, high-quality variant discovery in microbial genomes and allows comparison of new samples with all previously known strains. We believe it will prove valuable in microbial population genomics.<ref type="figure">1</ref>. Cartoon shows two samples (red and blue) and a diverged reference genome (black) in a de Bruijn graph; symbols indicate which workflows call sites. Brackets indicate flanking regions cannot be placed on reference, so the call is filtered from VCF. At SNP B, the independent workflow would call the red and blue versions of H and would implicitly find B. C is only called if the reference is excluded from discovery, as it confounds the red allele. D is called by workflows that include the reference in discovery</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>D</head><figDesc>¼ depth of coverage, c ¼ number of colours/samples, G ¼ genome size, S ¼ number of sites, ¼ mean allele length, " ¼ time to load one sample graph (2.5 s for S.aureus), I ¼ independent, J ¼ joint. Column 3 gives estimates for analysis of 1000 S.aureus samples with 100 CPUs and the Bubble Caller, based on Case Study 2 (8 min based on fact that genotyping of 72 samples in Case Study 2 took 35 s).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.</head><figDesc>Fig. 1. Cartoon shows two samples (red and blue) and a diverged reference genome (black) in a de Bruijn graph; symbols indicate which workflows call sites. Brackets indicate flanking regions cannot be placed on reference, so the call is filtered from VCF. At SNP B, the independent workflow would call the red and blue versions of H and would implicitly find B. C is only called if the reference is excluded from discovery, as it confounds the red allele. D is called by workflows that include the reference in discovery</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>276Z.</head><figDesc>Iqbal et al.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Time complexity of workflow stages</figDesc><table>Step 
Complexity 
1000 samples/ 
100 CPUs 

Parallelizable 

Build 
O(D) 
45 min 
I,J 
Error clean 
O(G)þO(D) 
3.3 min 
I,J 
Load all samples 
"c 
40 min (1 CPU) 
no 
Discovery 
O(G) 
2 min 
I 
Genotyping 
O(S) þ O(c) 
8 min (1 CPU) 
no 

</table></figure>

			<note place="foot" n="2"> JOINT OR PER-SAMPLE DISCOVERY The new Cortex pipelines take sequence data as input (in FASTQ, FASTA or BAM format) and build and clean per-sample graphs for multiple kmer values. The joint workflow then uses a multi-colour graph to directly compare all samples using the Bubble Caller algorithm (Iqbal et al., 2012); discovery and genotyping of biallelic sites are done at the same time. A reference can be incorporated (a) not at all (in which case the VCF uses dummy coordinates), (b) for coordinates only or (c) in discovery as well as for coordinates (Fig. 1). Option (a) allows calling of sites where both alleles are non-reference (sites B and C in Fig. 1); (a) and (b) avoid any confounding effects of reference sequence divergence or reference errors (site C in Fig. 1) and (c) allows calling of monomorphic non-reference variants (site D in Fig. 1). In contrast, the independent workflow calls variants independently for each sample, for each kmer value in a two-colour sample-plus-reference graph [using either the Bubble Caller or Path Divergence Caller (Iqbal et al., 2012)], and genotypes all samples at all sites in a single traversal of a multi-colour graph. In combining biallelic per-sample calls, this can detect overlapping and multiallelic sites. See examples of these workflows in Fig 1. For eukaryote genomes, variant assembly sensitivity is limited by coverage and repeat content. This effect is reduced for microbial genomes (less repetitive, deeper sequencing), and assembly can have comparable power to mapping approaches (Supplementary Information Sections 2 and 4 and Case Study 2). False-discovery rate is independent of workflow, and driven by sequencing errors and repeats (Supplementary Information, Section 4). 3 SCALING TO THOUSANDS OF SAMPLES Cortex memory-use scales linearly with number of kmers and samples (Supplementary Information, Section 1). Error cleaning is done per sample, so sequencing errors have no impact on subsequent stages. Therefore, memory use peaks when all samples are *To whom correspondence should be addressed. ß The Author(s) 2012. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">F</forename>
				<surname>Degner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="3207" to="3212" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Genome sequencing reveals diversification of virulence factor content and possible host adaptation in distinct subpopulations of Salmonella enterica</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">C</forename>
				<surname>Den Bakker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">425</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">De novo assembly and genotyping of variants using colored de Bruijn graphs</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Iqbal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">199</biblScope>
			<biblScope unit="page" from="133" to="154" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Mckenna</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="1297" to="1303" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Tracking the in vivo evolution of multidrug resistance in Staphylococcus aureus by whole-genome sequencing</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Mwangi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2007" />
			<biblScope unit="page" from="9451" to="9456" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Evolutionary dynamics of Staphylococcus aureus during progression from carriage to disease</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Young</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="4550" to="4555" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>