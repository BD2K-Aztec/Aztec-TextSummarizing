
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Systems biology MSPrep—Summarization, normalization and diagnostics for processing of mass spectrometry–based metabolomic data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Grant</forename>
								<surname>Hughes</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics and Informatics</orgName>
								<orgName type="institution">University of Colorado School of Public Health</orgName>
								<address>
									<settlement>Aurora</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Charmion</forename>
								<surname>Cruickshank-Quinn</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Immunology</orgName>
								<orgName type="institution">National Jewish Health Center</orgName>
								<address>
									<settlement>Denver</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Richard</forename>
								<surname>Reisdorph</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Immunology</orgName>
								<orgName type="institution">National Jewish Health Center</orgName>
								<address>
									<settlement>Denver</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sharon</forename>
								<surname>Lutz</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics and Informatics</orgName>
								<orgName type="institution">University of Colorado School of Public Health</orgName>
								<address>
									<settlement>Aurora</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Irina</forename>
								<surname>Petrache</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Medicine</orgName>
								<orgName type="institution">Indiana University School of Medicine</orgName>
								<address>
									<settlement>Indianapolis</settlement>
									<region>IN</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nichole</forename>
								<surname>Reisdorph</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Immunology</orgName>
								<orgName type="institution">National Jewish Health Center</orgName>
								<address>
									<settlement>Denver</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Russell</forename>
								<surname>Bowler</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">Department of Pulmonary Medicine</orgName>
								<orgName type="institution">National Jewish Health Center</orgName>
								<address>
									<settlement>Denver</settlement>
									<region>CO</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Katerina</forename>
								<surname>Kechris</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics and Informatics</orgName>
								<orgName type="institution">University of Colorado School of Public Health</orgName>
								<address>
									<settlement>Aurora</settlement>
									<region>CO</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Systems biology MSPrep—Summarization, normalization and diagnostics for processing of mass spectrometry–based metabolomic data</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">1</biblScope>
							<biblScope unit="page" from="133" to="134"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt589</idno>
					<note type="submission">Received on August 22, 2013; revised on October 7, 2013; accepted on October 8, 2013</note>
					<note>Associate Editor: Martin Bishop Contact: grant.hughes@ucdenver.edu Supplementary Information: Supplementary materials are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Although R packages exist for the pre-processing of metabolomic data, they currently do not incorporate additional analysis steps of summarization, filtering and normalization of aligned data. We developed the MSPrep R package to complement other packages by providing these additional steps, implementing a selection of popular normalization algorithms and generating diagnostics to help guide investigators in their analyses. Availability: http://www.sourceforge.net/projects/msprep</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The primary goal of the MSPrep package is to prepare metabolomics data for advanced statistical analysis by automating the processing of datasets and generating diagnostic graphs. The initial processing of Liquid Chromatography coupled with Mass Spectrometry (LCMS) data is covered by a variety of software packages provided by instrument manufacturers and a number of open source packages such as xMSAnalyzer (<ref type="bibr" target="#b10">Uppal et al., 2013</ref>), XCMS (<ref type="bibr" target="#b8">Smith et al., 2006</ref>) and MzMine (<ref type="bibr" target="#b6">Pluskal et al., 2010</ref>). While these manage the initial data pre-processing steps of peak detection, chromatogram building, alignment and quantification, they often lack functions for further processing. We designed the MSPrep package to complement existing software by providing additional processing tools and statistical and graphical tools for evaluation of different methods. As there are no universally accepted procedures, the package provides implementation of a variety of novel and previously published methods. The primary functions of the MSPrep package are summarization of replicates, filtering, imputation of missing data, normalization and/or batch effect adjustment and dataset diagnostics.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">MATERIALS AND METHODS</head><p>Input: Three files are required for MSPrep: Aligned LCMS abundance/ intensity data, a dataset linking subject ID to LCMS run and a clinical dataset containing unique subject identifiers and any outcomes, phenotypes and batch number for normalization and PCA purposes.</p><p>Summarization/Averaging: The first processing step is summarization of technical replicates, three replicates required per subject/sample. MSPrep provides options to remove erroneous data and to reduce the effect of extreme observations. The user specifies a cutoff for the coefficient of variation (CV), calculated by dividing the standard deviation of the replicates by the average, yielding a measure for magnitude of the variation between replicates. The summarization routine summarizes each compound by subject (or sample) and returns a single observation per compound per subject. Only abundances that are found in at least two of three replicates are kept. If CV is below the user-specified level, the average of the replicates is used. If the CV is above the specified level and found in exactly two of three replicates, the summarization is not used and the observation is left blank. If the compound was found in all three replicates but with unacceptable CV, the median is used as the summarization measure. This approach removes potential erroneous data. We have found that most compounds with high CV have two consistent and one extreme observation. Using the median reduces the effect of the extreme observation.</p><p>Filtering: The resulting summarized dataset contains all compounds with one observation per subject (or sample). The next processing step filters the data to only compounds found in a user-specified percentage of subjects.</p><p>Missing Data: There are three primary modes of missing data in metabolomics datasets and each mode has different implications for subsequent analysis; therefore, different imputation routines and statistical methods are required and three are offered in the MSPrep package. The three modes are truly not present, present below the detectable limit of the instrument and absent owing to error in pre-processing algorithms. The MSPrep package implements three methods of managing missing data: (i) No imputation assumes the mode of missing is true zeros and therefore assigns the missing values as zeros. This dataset could be useful for PCA analysis, cluster analysis and methods that account for clustering at zero. Unless a stringent filter is applied, normalization routines may have poor performance, as most have assumptions about underlying distributions that are not valid with zero clustered data. (ii) The second option assumes missing compounds were below the detectable limit and imputes a value of one half of the minimum observed value for that compound (<ref type="bibr">Xia et al., 2009). (iii)</ref>The final method is a call to the Bayesian PCA (BPCA) imputation algorithm (<ref type="bibr" target="#b5">Oba et al., 2003</ref>) from the PCAMethods R package (<ref type="bibr" target="#b9">Stacklies et al., 2007</ref>) and assumes that the compound is present but failed to be accurately detected. This *To whom correspondence should be addressed. algorithm estimates the missing value by a linear combination of principal axis vectors, where the parameters of the model are identified by a Bayesian estimation method and is not sensitive to the quantity of missing data. Normalization: There are five options for normalization: Median (<ref type="bibr" target="#b11">Wang et al., 2003</ref>), Quantile (<ref type="bibr" target="#b0">Bolstad et al., 2003</ref>), Cross-Contribution Compensating Multiple Standard Normalization (CRMN) (<ref type="bibr" target="#b7">Redestig et al., 2009</ref>), Surrogate Variable Analysis (SVA) (<ref type="bibr" target="#b4">Leek et al., 2007</ref>) and Removal of Unwanted Variation (RUV) (<ref type="bibr" target="#b2">Gagnon-Bartsch et al. 2012</ref>). Median, quantile and CRMN all result in an adjusted (normalized) dataset. RUV and SVA each estimate a matrix of unobserved factors of importance using different methods of supervised factor analysis. The unnormalized, median and quantile adjusted data are adjusted with ComBat (<ref type="bibr" target="#b3">Johnson et al., 2007</ref>), an empirical Bayes batch effect correction algorithm for the removal of potential batch effects. For RUV and CRMN, users can either specify compounds to use as controls or data driven controls will be estimated if no negative controls exist (<ref type="bibr" target="#b1">DeLivera et al., 2012</ref>). Results will vary based on biological and technical differences in experiments. Users are encouraged to try different processing steps and MSPrep produces two documents to assist in comparing the methods. Examples of these are available online in the Supplementary Materials. The first contains distributional histograms of raw and log transformed abundances by all three imputation methods. The second can be used to compare normalization methods and contains color-coded PCA plots for a categorical phenotype or covariate and numbering for batches, box plots by subject (or sample, cell type, etc), box plots by batch and box plots by the phenotype or covariate. Examples of both output files are in the Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>An operator difference dataset was generated by the Reisdorph Mass Spectrometry laboratory at National Jewish Health. Three technicians performed all steps of sample prep for profiling of a base human plasma sample containing six spiked in control compounds at concentrations of 1X, 2X and 4X and two negative controls at 1X in all samples. Pre-processing was performed in Agilent's Mass Hunter software. For summarization, the CV cutoff was set at 0.50. There were 23 compounds (0.1% of compounds) that were present in all replicates but above this cutoff. Of these, all but one fit the pattern of two consistent observations and one outlier. The data were filtered at 80% present in all subjects, which resulted in 891 compounds. The BPCA imputation was used to maintain a Gaussian distribution and allows application and evaluation of all normalization methods. Owing to the design, we expect compounds to be consistently measured between subjects with the only detected differences occurring in the six compounds that were spiked into the datasets. Thus, all other differences are due to the batch/operator effect. As shown in<ref type="figure">Table 1</ref>, the SVA normalization method was the most effective at controlling false-positive rate while reducing the operator effect for this dataset, based on a linear model of the log2 abundances. While the operator effect is still apparent in the PCA plot of the SVA adjusted data in Supplementary<ref type="figure">Figure S2</ref>, the lower percentages and RMSE in<ref type="figure">Table 1</ref>represents an improvement over the other methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">CONCLUSION</head><p>The MSPrep package is designed to help investigators prepare their datasets for analysis, while reducing the amount of manual processing of datasets and generating useful diagnostic aids. Our package complements existing pre-processing methods such as xMSAnalyzer (<ref type="bibr" target="#b10">Uppal et al, 2013</ref>), and the output is in a format ready for input to leading software such as MetaboAnalyst (<ref type="bibr" target="#b12">Xia et al., 2009</ref>) to perform clustering and other downstream analyses. The SVA routine provided the best performance when applied to the dataset presented, but it is important to note the strengths and weaknesses of each routine, and, in our experience, no single method is best in all circumstances. We encourage users to examine the diagnostic plots generated by the package to compare different methods for their datasets.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>Funding: NIH/NHLBI P20 HL113445. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Percentage of compounds found significant by normalization method and RSME for detection of 4Â spiked compounds</figDesc><table>Method None Median Quant Quant 
Combat 

SVA RUV CRMN 

Spike 
6.0% 
7.4% 
5.6% 22.4% 
6.6% 12.1% 15.4% 
Operator 8.0% 11.4% 10.8% 0.0% 
3.7% 6.7% 5.8% 
RSME 
1.42 
1.31 
1.34 
1.34 
1.26 
1.42 
1.69 </table></figure>

			<note place="foot">ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">G.Hughes et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">M</forename>
				<surname>Bolstad</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="185" to="193" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Normalizing and integrating metabolomic data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Delivera</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">84</biblScope>
			<biblScope unit="page" from="10768" to="10776" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Using control genes to correct for unwanted variation in microarray data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">A</forename>
				<surname>Gagnon-Bartsch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="539" to="552" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Adjusting batch effects in microarray expression data using Empirical Bayes methods</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">E</forename>
				<surname>Johnson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="118" to="127" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Capturing heterogeneity in gene expression studies by surrogate variable analysis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Leek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genetics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">161</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A Bayesian missing value estimation for gene expression profile data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Oba</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="2088" to="2096" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">MZ Mine 2: Modular framework for processing, visualizing and analyzing mass spectrometry based molecular profile data</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Pluskal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">395</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Compensation for systematic cross-contribution improves normalization of mass spectrometry based metabolomics data</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Redestig</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="7974" to="7980" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Smith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="page" from="779" to="787" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">pcaMethods—a bioconductor package providing PCA methods for incomplete data</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Stacklies</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1164" to="1167" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">xMSanalyzer: automated pipeline for improved feature detection and downstream analysis of large-scale, non-targeted metabolomics data</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Uppal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page">15</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Quantification of proteins and metabolites by mass spectrometry without isotopic labeling or spiked standards</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="page" from="4818" to="4826" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">MetaboAnalyst: a web server for metabolomic data analysis and interpretation</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Xia</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="652" to="660" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>