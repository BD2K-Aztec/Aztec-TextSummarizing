
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:35+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis Comb-p: software for combining, analyzing, grouping and correcting spatially correlated P-values</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">. 22 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Brent</forename>
								<forename type="middle">S</forename>
								<surname>Pedersen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Medicine</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">David</forename>
								<forename type="middle">A</forename>
								<surname>Schwartz</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Medicine</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ivana</forename>
								<forename type="middle">V</forename>
								<surname>Yang</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Medicine</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Katerina</forename>
								<forename type="middle">J</forename>
								<surname>Kechris</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Biostatistics and Informatics</orgName>
								<orgName type="institution">University of Colorado</orgName>
								<address>
									<settlement>Denver</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution">Anschutz Medical Campus</orgName>
								<address>
									<postCode>80045</postCode>
									<settlement>Aurora</settlement>
									<region>CO</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alex</forename>
								<surname>Bateman</surname>
							</persName>
						</author>
						<title level="a" type="main">Sequence analysis Comb-p: software for combining, analyzing, grouping and correcting spatially correlated P-values</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="2986" to="2988"/>
							<date type="published" when="2012">. 22 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts545</idno>
					<note type="submission">Received on March 20, 2012; revised on August 28, 2012; accepted on August 30, 2012</note>
					<note>Associate Editor:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>comb-p is a command-line tool and a python library that manipulates BED files of possibly irregularly spaced P-values and (1) calculates auto-correlation, (2) combines adjacent P-values, (3) performs false discovery adjustment, (4) finds regions of enrichment (i.e. series of adjacent low P-values) and (5) assigns significance to those regions. In addition, tools are provided for visualization and assessment. We provide validation and example uses on bisulfite-seq with P-values from Fisher&apos;s exact test, tiled methylation probes using a linear model and Dam-ID for chromatin binding using moderated t-statistics. Because the library accepts input in a simple, standardized format and is unaffected by the origin of the P-values, it can be used for a wide variety of applications.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>A variety of high-throughput technologies generate genome-wide data used to study processes such as DNA-binding, methylation status and histone modifications. These technologies, including tiling arrays and sequence-based assays, generate data that are often auto-correlated across the genome, making inferences difficult. The significance of individual regions may be dampened after multiple-testing correction on potentially millions of sites. In such studies, hypotheses tests can be performed at each location to generate P-values for evaluating the effects of interest. For this purpose,<ref type="bibr" target="#b5">Kechris et al. (2010)</ref>developed a method for combining P-values in sliding windows and accounting for spatial correlations across the genome. Here, we build on this approach with software that allows for uneven data structure across the genome, more general auto-correlation calculations and multiple-testing corrections for peaks (i.e. genomic regions of enrichment) with applications to a variety of different technologies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">APPROACH</head><p>Tiling array studies relying on two-sample comparisons may be amenable to the calculation of sliding window averages of log ratios or two-sample test statistics. However, more complex study designs often require covariates and report P-values from linear models or other statistical tests. We utilize a 'moving averages' method of P-value correction that does not depend on the test used to generate the P-values.<ref type="bibr" target="#b1">Fisher (1948)</ref>developed an approach of combining P-values from independent tests to get a single meta-analysis test statistic with a 2 distribution and degrees of freedom based on the number of tests being combined. A similar method developed by<ref type="bibr" target="#b10">Stouffer et al. (1949) and</ref><ref type="bibr" target="#b7">Liptak (1958)</ref>first converts P-values to Z-scores which are then summed and scaled to create a single, combined Z-score. The Stouffer–Liptak method lends itself to the addition of weights on each P-value.<ref type="bibr" target="#b11">Zaykin et al. (2002)</ref>introduced a method to use weights to perform a dependence correction on correlated tests.<ref type="bibr" target="#b5">Kechris et al. (2010)</ref>used a sliding window correction where each P-value is adjusted by applying the Stouffer–Liptak method to neighboring P-values as weighted according to the observed auto-correlation at the appropriate lag. Here, we provide a generic, efficient and customizable implementation of these methods with additions including handling variably spaced probes, a peak finder for dynamically sized regions, and a means to calculate a P-value for each peak, adjusted for multiple comparisons. We refer to this implementation as comb-p and illustrate its application using three different technologies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">IMPLEMENTATION</head><p>All programs within comb-p expect files in simple BED format (<ref type="bibr" target="#b6">Kent et al., 2002</ref>) sorted by chromosome and start. Additional columns contain the P-value(s) of interest based on the study design and generated from any software or statistical test. comb-p first calculates the correlation at varying distance lags (here: auto-correlation—ACF). While Kechris' (<ref type="bibr" target="#b5">Kechris et al., 2010</ref>) and many ACF implementations rely on fixed offsets of adjacent probes, comb-p accepts a maximum distance and a single offset that segments that distance into intervals. If a given probe is 40 bases away from two (or more) other probes, then it will appear more than once in the bin containing probe pairs separated by 540 bases. This is useful in cases where the probes generating the P-values are unevenly spaced, as is common with methylation arrays. Once the ACF has been calculated, it can be used to perform the Stouffer–Liptak–Kechris correction (slk) where each P-value is adjusted according to adjacent P-values as weighted according to the ACF. The resulting BED file has an additional column containing the corrected P-value. A given P-value will be pulled lower if its neighbors also have low P-values (and little auto-correlation) and likely remain insignificant if the neighboring P-values are also high. A q-value score based on the Benjamini–Hochberg false discovery (FDR) correction or on a null model from shuffled data may then be calculated. The peak-finding algorithm can then be used to find enrichment regions or peaks on the FDR q-value, the slk-corrected P-value or on the original P-value. Once the regions are identified, a P-value for each region can be assigned using the Stouffer–Liptak correction. Note that the first ACF calculated above was only out to the distance specified and may not extend far enough to cover the longer regions. Therefore, this step first calculates the ACF out to a distance equal to the length of the longest region. The corrected P-value for each region is then calculated using the original P-values that fall within the peak and the full ACF. Because we use the original, uncorrected P-values in the calculation of significance for the peak, we side-step issues of altering the distribution in both the slk and FDR steps. The region_p program reports the slkcorrected P-value and a one-step S ˇ ida´kida´k (1967) multiple-testing correction. For a given region, the number of possible tests in the S ˇ ida´kida´k correction is the total bases covered by all input probes divided by the size of the given region. In short, we define the extents of the region using the FDR q-values, then we define the significance of the regions using the SLK correction of the original P-values. comb-p is implemented as a single command-line application that dispatches to multiple independent sub-modules and as a set of python packages that may be used programatically. Where possible, computationally intensive algorithms are parallelized automatically—for the ACF and the slk steps in the analyses described below—this results in a speed-up that is nearly linear with the number of cores available. The implementation has been tuned to minimize memory use and computation time. When run without arguments, the comb-p executable displays the available programs and a short description of each. Although each of these tools may be used independently, the progression of acf, slk, fdr, peaks, region_p works well for the examples presented. These steps can be run successively with the single command: pipeline.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">APPLICATION</head><p>We extend three previously published analyses to demonstrate the utility and breadth of use of comb-p and to validate against the published data. The full set of commands used to run each of these analyses is available in the corresponding subdirectory at: https://github.com/brentp/combined-pvalues/tree/ master/examples. Comprehensive, high-throughput array for relative methylation is a tiling array used to quantify methylation at CpG-rich sites (<ref type="bibr" target="#b3">Irizarry et al., 2008</ref>). Adjacent probes are correlated due to the regional nature of methylation and to the overlapping probes on the tiling array. The CHARM study reported in<ref type="bibr" target="#b4">Irizarry et al. (2009)</ref>contains probe data for tumor and normal samples from a variety of tissues. Using these data, we fit a linear model in R (http://www.R-project.org) to obtain P-values for the significance of tumor or tissue-specific effects on methylation status at each probe. We then run comb-p, which finds 85% of the tumor-specific differentially methylated regions (C-DMRs) reported by<ref type="bibr" target="#b4">Irizarry et al. (2009)</ref>and 75% of the tissue-specific T-DMRs reported. While these overlaps depend on the parameter choice, we show that the Irizarry DMRs that overlap with the comb-p DMRs have significantly (t-test, P ¼ 1.296eÀ145) lower FDR values (as reported by Irizarry) than those that do not, indicating that comb-p is reporting the best regions. We also show that our method yields only 39 false-positive DMRs on 20 runs of shuffled of CHARM data (33 of those come from two of the sets, because those shuffles of the clinical data happen to coincide well with the case–control status of the original data). This gives a FDR rate of 0.0008 for reasonable cutoffs. We found that comb-p recovers more significant probes than a simple FDR correction on the original P-values. We also found that the process of segmenting the genome into smaller chunks and calling regions independently in each chunk generates similar regions to those derived using the auto-correlation structure for the entire genome (the default). DamID technology followed by tiling arrays can be used to map genomic regions bound by DNA-binding proteins (van<ref type="bibr" target="#b10">Steensel et al., 2001</ref>). We recreate an analysis of the DamID tiling array data for the Ci transcription factor in Drosophila melanogaster (<ref type="bibr" target="#b0">Biehs et al., 2010</ref>).<ref type="bibr" target="#b5">Kechris et al. (2010)</ref>calculated the mean log ratios of intensities between Ci experimental and control samples to obtain P-values from a one-sided moderated t-test. Of the original 878 regions, 695 (79%) are represented in the comb-p predicted peaks. To score each peak, the authors report À log 10 of the smallest raw P-value for each peak. The published peaks overlapping the comb-p regions have a higher score than those that do not (t-test, P ¼ 2.98eÀ59), indicating that comb-p is finding the best regions among those previously reported. In addition, comb-p regions also yield a higher target enrichment score based on proximity to known Ci genes, indicating that comb-p is selecting for known targets. The corrected P-value reported by comb-p can be used as a filter to extract regions of interest; we calculated the enrichment ratio of the number of observed to expected Ci target genes at various comb-p-corrected P-value cutoffs. For a cutoff of 0.1, the enrichment is 2.41, this enrichment increases to 3.46 and 5.29 for more stringent cutoffs of 1eÀ3 and 1eÀ4, respectively. Bisulfite-sequencing (BS-Seq) is also used to measure methylation across the genome. As another example of the flexibility of our method, we demonstrate a possible analysis on data described in<ref type="bibr" target="#b2">Hsieh et al. (2009)</ref>from Arabidopsis thaliana using MethylCoder (<ref type="bibr" target="#b8">Pedersen et al., 2011</ref>) to map the bisulfite-treated reads to the genome. At each site, we use Fisher's exact test to obtain P-values for the counts of converted and un-converted cytosines between endosperm and embryo. We find DMRs between these two tissues associated with genes enriched for gene ontologies related to the ribosome (P ¼ 1eÀ3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CONCLUSION</head><p>The comb-p software is useful in contexts where auto-correlated P-values are generated across the genome. We have outlined our implementation and demonstrated the utility on data from three different technologies each from a different statistical test. We have also validated our method using previously published results from those studies. Future work could extend this framework to address applications with a more segmented structure such as DNA copy number and ChIP-seq. Currently, we recommend the use of comb-p for technologies with a more regular autocorrelation structure. In addition, we note that this method will have a sensitivity and specificity that will depend on each dataset and we recommend that users explore these tradeoffs on shuffled versions of their own data as demonstrated in the CHARM example.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>Funding: The National Institutes of Health (AA016922 to K.K., HL101251 to D.A.S. and I.V.Y. and AI90052 and HL101715 to D.A.S.). Conflict of Interest: none declared.</figDesc></figure>

			<note place="foot">*To whom correspondence should be addressed. y The authors wish it to be known that in their opinion, the last two authors should be regarded as joint Last Authors.</note>

			<note place="foot">ß The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Comb-p at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">B.S.Pedersen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Hedgehog targets in the Drosophila embryo and the mechanisms that generate tissue-specific outputs of Hedgehog signaling</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Biehs</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Development</title>
		<imprint>
			<biblScope unit="volume">137</biblScope>
			<biblScope unit="page" from="3887" to="3898" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Questions and answers #14</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Fisher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. Stat</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="30" to="31" />
			<date type="published" when="1948" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Genome-wide demethylation of Arabidopsis endosperm</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">F</forename>
				<surname>Hsieh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">324</biblScope>
			<biblScope unit="page" from="1451" to="1454" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Comprehensive high-throughput arrays for relative methylation (CHARM)</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Irizarry</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="780" to="790" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The human colon cancer methylome shows similar hypoand hypermethylation at conserved tissue-specific CpG island shores</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Irizarry</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="178" to="186" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Generalizing moving averages for tiling arrays using combined p-value statistic</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">J</forename>
				<surname>Kechris</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Article. 29</note>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">The human genome browser at UCSC</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="996" to="1106" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">On the combination of independent tests. Magyar Tudomanyos</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Liptak</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Akademia Matematikai Kutato Intezetenek Kozlemenyei</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="171" to="197" />
			<date type="published" when="1958" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">MethylCoder: software pipeline for bisulfite-treated sequences</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">S</forename>
				<surname>Pedersen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2435" to="2436" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Rectangular confidence region for the means of multivariate normal distributions</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>ˇ Ida´kida´k</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Z</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Stat. Assoc</title>
		<imprint>
			<biblScope unit="volume">62</biblScope>
			<biblScope unit="page" from="626" to="633" />
			<date type="published" when="1967" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">The American Soldier Adjustment during Army Life Chromatin profiling using targeted DNA adenine methyltransferase</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">A</forename>
				<surname>Stouffer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<publisher>Princeton University Press</publisher>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">27</biblScope>
			<biblScope unit="page" from="304" to="308" />
			<date type="published" when="1949" />
			<publisher>Princeton University Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Truncated product method for combining p-values</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">L</forename>
				<surname>Zaykin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genet. Epidemiol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="170" to="185" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>