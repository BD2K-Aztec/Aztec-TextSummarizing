
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:36+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression Matrix eQTL: ultra fast eQTL analysis via large matrix operations</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">10 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Andrey</forename>
								<forename type="middle">A</forename>
								<surname>Shabalin</surname>
							</persName>
							<email>shabalin@email.unc.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of North Carolina at Chapel Hill</orgName>
								<address>
									<postCode>27599</postCode>
									<settlement>Chapel Hill</settlement>
									<region>NC</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression Matrix eQTL: ultra fast eQTL analysis via large matrix operations</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="1353" to="1358"/>
							<date type="published" when="2012">10 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts163</idno>
					<note type="submission">Advance Access publication April 6, 2012 Received on October 13, 2011; revised on March 6, 2012; accepted on April 2, 2012</note>
					<note>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [15:36 7/5/2012 Bioinformatics-bts163.tex] Page: 1353 1353–1358 Associate Editor: Trey Ideker Availability: Matlab and R implementations are available for free at http://www.bios.unc.edu/research/genomic_software/Matrix_eQTL Contact:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Expression quantitative trait loci (eQTL) analysis links variations in gene expression levels to genotypes. For modern datasets, eQTL analysis is a computationally intensive task as it involves testing for association of billions of transcript-SNP (single-nucleotide polymorphism) pair. The heavy computational burden makes eQTL analysis less popular and sometimes forces analysts to restrict their attention to just a small subset of transcript-SNP pairs. As more transcripts and SNPs get interrogated over a growing number of samples, the demand for faster tools for eQTL analysis grows stronger. Results: We have developed a new software for computationally efficient eQTL analysis called Matrix eQTL. In tests on large datasets, it was 2–3 orders of magnitude faster than existing popular tools for QTL/eQTL analysis, while finding the same eQTLs. The fast performance is achieved by special preprocessing and expressing the most computationally intensive part of the algorithm in terms of large matrix operations. Matrix eQTL supports additive linear and ANOVA models with covariates, including models with correlated and heteroskedastic errors. The issue of multiple testing is addressed by calculating false discovery rate; this can be done separately for cis-and trans-eQTLs.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The goal of expression quantitative trait loci (eQTL) analysis is to identify single-nucleotide polymorphisms (SNPs) which are significantly associated with expression of known genes. These associations can help reveal biochemical processes underlying living systems, discover the genetic factors causing certain diseases and determine pathways that are affected by them. Expression QTL analysis is used to determine hotspots [DNA regions affecting multiple transcripts,<ref type="bibr" target="#b2">Breitling et al. (2008)]</ref>, construct causal networks, discover subclasses of clinical phenotypes, and select genes for clinical trials (see reviews of<ref type="bibr" target="#b8">Gilad et al., 2008;</ref><ref type="bibr" target="#b12">Kendziorski and Wang, 2006;</ref><ref type="bibr" target="#b28">Zhang and Liu, 2010</ref>). There are various approaches to eQTL analysis. Most eQTL studies perform separate testing for each transcript-SNP pair. The association between expression and genotype can be tested for using linear regression and ANOVA models, as well as nonlinear techniques including generalized linear and mixed models, Bayessian regression (<ref type="bibr" target="#b19">Servin and Stephens, 2007</ref>), and models accounting for pedigree (<ref type="bibr" target="#b0">Abecasis et al., 2001</ref>) and latent variables (<ref type="bibr" target="#b13">Leek and Storey, 2007</ref>). Several methods has been developed to find groups of SNPs associated with expression of a single gene (<ref type="bibr" target="#b10">Hoggart et al., 2008;</ref><ref type="bibr" target="#b11">Kao et al., 1999;</ref><ref type="bibr" target="#b14">Lee et al., 2008;</ref><ref type="bibr" target="#b27">Zeng, 1993</ref>). Expression QTL analysis is known to be computationally intensive. The issue is most pronounced for modern eQTL datasets, which have genotype measured over millions of SNPs and gene expression over tens of thousands of transcripts. For such data, the eQTL analysis involves over ten billion tests. The following three studies, analyzing relatively small datasets, indicate that non-linear methods can be prohibitively slow for large data.<ref type="bibr" target="#b5">Degnan et al. (2008)</ref>applied family-based association tests to a dataset with 142 samples. They tested only 40 227 transcript-SNP pairs and report the total computation time to be 'under 24 h on 20 processors in parallel on a Linux cluster'.<ref type="bibr" target="#b7">Ghazalpour et al. (2008)</ref>were running efficient mixed-model association (EMMA), which is said to be computationally efficient. They analyzed a dataset with 110 samples, 1813 SNPs, and 10 013 transcripts. They tested all transcript-SNP pairs and report the computation time of 'a few hours using a cluster of 50 processors'.<ref type="bibr" target="#b16">Listgarten et al. (2010)</ref>tested their method on a dataset measuring 40 639 transcripts and 48 186 SNPs in 188 samples. They report that estimation took 10 h when parallelized across 1100 processors (this is more than a processor-year). Note that the dimensions of a modern eQTL dataset can greatly exceed those in the examples above. In this article, we present a new tool, Matrix eQTL, for fast eQTL analysis of large datasets. Our tests show that Matrix eQTL is 2–3 orders of magnitude faster than existing popular QTL/eQTL software. Moreover, the computation time of Matrix eQTL stays practically unchanged when covariates are added to the model. Such performance is achieved, in particular, by expressing the most computationally intensive part of the algorithm in terms of large matrix operations. This allowed to implement the algorithm using high-level programming languages, R and Matlab, relying on their efficient implementation of matrix operations. Matrix eQTL tests for association between each SNP and each transcript by modeling the effect of genotype as either additive linear (least squares model) or categorical (ANOVA model). Optionally, Matrix eQTL can test for the significance of genotype-covariate interaction. Matrix eQTL does not require genotypes to be discrete unless ANOVA model is chosen. The models can include covariates to account for such factors as gender, clinical variables, population structure and surrogate variables. Matrix eQTL also supports heteroscedastic and correlated errors to account for relatedness of the samples. Matrix eQTL performs a separate test for each geneSNP pair and corrects for multiple comparisons by calculating false discovery rate (FDR,<ref type="bibr" target="#b1">Benjamini and Hochberg, 1995</ref>). It is known that the SNPs located near a gene are more likely to affect its expression. To account for this fact, Matrix eQTL supports separate</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.A.Shabalin</head><p>p-value thresholds and FDR calculation for local (cis-) and distant (trans-) eQTLs. It can often be helpful to make a Q–Q plot or a histogram of all p-values, including those that did not pass the significance threshold. These plots can be used to assess the quality of data preprocessing and model selection. Matrix eQTL can record the distribution of all p-values by counting the number of p-values that fall in usersupplied histogram bins. These counts are then used to create Q–Q plots or histograms of the p-values.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RESULTS</head><p>We measured the performance of Matrix eQTL and six programs for QTL and eQTL analysis: Plink (<ref type="bibr" target="#b17">Purcell et al., 2007</ref>), Merlin (<ref type="bibr" target="#b0">Abecasis et al., 2001</ref>), R/qtl (<ref type="bibr" target="#b3">Broman et al., 2003</ref>), snpMatrix (<ref type="bibr" target="#b15">Leung, 2007</ref>), eMap (<ref type="bibr" target="#b23">Sun, 2009</ref>) and FastMap (<ref type="bibr" target="#b6">Gatti et al., 2009</ref>). Plink is a command line toolset for whole genome association analysis. It is a general purpose tool written in C/C++ not particularly optimized for eQTL analysis. Merlin is a command line tool for fast pedigree analysis written in C/C++. It is designed for analysis in pedigree, but has an option for analysis of unrelated samples. R/qtl, snpMatrix and eMap are R packages for QTL/eQTL analysis. Part of eMap is coded in C and requires GSL library (GNU Scientific Library). FastMap is a fast association mapping tool written in Java. It uses the discrete nature of genotype data to speed up calculations. FastMap is optimized for permutation-based testing. Among selected tools, only FastMap and eMap do not handle covariates. Note that FastMap is the only tool out of seven that has a graphical user interface. All methods except R/qtl were set to use the simple linear model to test for association between levels of gene expression and frequencies of the minor allele of the genotype. R/qtl does not support the simple linear model and was set to estimate the ANOVA model (Haley–Knott method). We estimated the time that Matrix eQTL and other eQTL tools require to analyze a typical modern eQTL dataset. As the model dataset we chose cystic fibrosis (CF) dataset from<ref type="bibr" target="#b25">Wright et al. (2011)</ref>. The dataset contains genotype information for 573 337 SNPs and the gene expression measurements for 22 011 transcripts for 840 patients. We applied eQTL methods to a randomly generated dataset containing 2201 genes and 57 333 genes across 840 samples, which is ∼10% of the number of genes and SNPs in the CF dataset. The performance of all eQTL tools depends dominantly on the dimensions of the dataset, and the computation time is approximately linear with respect to the number of genes and the number of SNPs. We used this observation to estimate the time required for the analysis of the full dataset. The performance of each method is reported in<ref type="figure" target="#tab_1">Table 1</ref>. Matrix eQTL requires only 9–12 s to analyze the test dataset. This did not allow us to make precise estimates of its performance, so we applied Matrix eQTL to the whole dataset and reported the performance in<ref type="figure" target="#tab_1">Table 1</ref>. To reduce the output we set the p-value threshold at 10 −5 level for each method with such option. The specifications of the machine used to run the tests (except eMap, which does not run on Windows) are provided at the end of Section 3. All methods that support covariates were additionally tested with 10 covariates set to the first 10 eigenvectors of the genotype sample covariance matrix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">minutes</head><p>The time for all methods is projected from tests on a dataset with 2201 genes and 57 333 SNPs. The timings projections for Matrix eQTL implementations were refined by applying them to the complete dataset.</p><p>Two methods, Matrix eQTL (for R) and R/qtl were sensitive to the version of basic linear algebra subroutine (BLAS) installed in R (see Section 3.7 for more about BLAS). We ran both methods in three different settings: standard R installation, R with GOTO BLAS (<ref type="bibr" target="#b9">Goto and Geijn, 2008</ref>) by Ei-Ji Nakama, and Revolution R. We observed that the methods demonstrated better performance in Revolution R, so we report only corresponding times for R/qtl in<ref type="figure" target="#tab_1">Table 1</ref>. The code for generating the test dataset and running the tests is available at Matrix eQTL website. We note that the methods that use linear regression models in the analysis (Plink, snpMatrix and FastMap) report the same test statistics and p-values as Matrix eQTL. Matrix eQTL was the fastest tool among tested, with &lt;1 s difference between runs with and without covariates. It is followed by FastMap which was 50 times slower than Matrix eQTL. Note that the good performance of FastMap comes at the expense of a limited set of supported models (no covariates, only discrete genotypes). Third was R/qtl, which was 122 times slower Matrix eQTL when tested without covariates and 574 times otherwise. SnpMatrix was 384 times slower Matrix eQTL without covariates in the model and 618 times with them. Plink, Merlin and eMap were at least 1145 times slower than Matrix eQTL. The timing in<ref type="figure" target="#tab_1">Table 1</ref>does not include the time required to load the data. Each method loaded the test dataset in just few minutes. We also tested the ability of each method to load the full CF dataset. We observed that R packages that use standard R functions to load the data, R/qtl and eMap, were the slowest. They required excessive amounts of RAM (&gt;24 GB) and took hours to load the data. The remaining tools have demonstrated a good performance loading the data:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Computational efficiency</head><p>It is widely believed that the performance of most programs implemented in R and Matlab can be greatly improved if they are rewritten using a low-level programming language such as C/C++. Using simple calculations, presented below, we argue that this is not the case for both implementations of Matrix eQTL. The most computationally intensive part of the Matrix eQTL algorithm is the calculation of correlations using large matrix multiplications. As we point out in Section 3, the complexity of this part of the algorithm is equal to twice the product of the number of transcripts, the number of SNPs, and the number of samples. Thus, for the CF dataset the complexity of the Matrix eQTL algorithm is bounded from below by 2·573,337·22,011·840 = 2.12·10 13 floating point operations. According to the specifications of the processor of the test machine, it is theoretically capable of performing 38.4 billion floating point operations per second. The ratio of these numbers gives us the best theoretically possible time for a Matrix eQTL implementation of 9.2 min. Dividing the best theoretically possible time by the time observed in practice, we get the lower bound on the efficiency of Matrix eQTL implementations: 63% for R and 78% for Matlab.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">METHODS</head><p>The Matrix eQTL algorithm employs multiple optimizations. In what follows we first describe the algorithm for the simple linear regression model, which does not include covariates and assumes uncorrelated homoskedastic errors. Then, we extend the algorithm to handle ANOVA model, additive covariates, and heteroskedastic and correlated errors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Simple linear regression</head><p>The simple linear regression is one of the most commonly used models for eQTL analysis. For each gene-SNP pair, with the SNP encoded by 0,1 and 2 according to the frequency of the minor allele, the association between gene expression g and genotype s is assumed to be linear:</p><formula>g = α +βs+, where ∼ i.i.d. N(0,σ 2 ).</formula><formula>(1)</formula><p>The conventional algorithm for the analysis of the simple linear regression model involves calculation of a number of variables including: the sample means ¯ g and ¯ s, the slope coefficientˆβcoefficientˆ coefficientˆβ, the interceptˆαinterceptˆ interceptˆα, the residuals e i , the total sum of squares SST and the residual sum of squares SSE. This is followed by calculation of a test statistic, which can be t-statistic, Ftest or likelihood ratio (LR) test. Finally, the p-value is calculated for the test statistic; this step can also be computationally intensive as it involves calculation of incomplete beta or gamma functions. For better performance, Matrix eQTL does not calculate p-value for every transcript-SNP pair. Instead, for the test statistic of choice, we find the threshold, such that test statistics exceeding the threshold are significant at the required significance level. The test statistics for every transcript-SNP pair are then compared with the threshold, and the p-values are calculated only for those exceeding it. The number of significant transcript-SNP pairs is usually much smaller than the number of tests, so the p-values and other statistics of interest can be calculated for them in a much shorter time than is required to find them. The choice of the test statistic is important for the performance of the method. It is natural to choose the test statistic that can be calculated faster, among statistics of equal power. Observe that for the simple linear regression (1), the common test statistics: t, F, R 2 and LR, are equivalent and can be expressed as functions of the sample correlation r = cor(g,s)</p><formula>t = √ n−2 r √ 1−r 2 , F = t 2 = (n−2) r 2 1−r 2 , R 2 = r 2 , LR =−nlog(1−r 2 ).</formula><p>We choose the absolute value of the sample correlation |r| as the test statistic for the simple linear regression and threshold it in search for significant gene-SNP associations. Note that the correlation does not change if we standardize the genotype and gene expression variables to have zero mean and unit sum of squares g i = 0,</p><formula>g 2 i = 1, s i = 0, s 2 i = 1.</formula><p>The standardization does not add complexity to the calculations as it has to be performed only once for each transcript and once for each SNP, and it greatly simplifies the calculation of the sample correlation</p><formula>r gs = cor(s,g) = (s i −¯ s)(g i −¯ g) (s i −¯ s) 2 (g i −¯ g) 2 = s i g i ==s,g,</formula><p>where s,g denotes the inner product between vectors s and g. Now, let S be the genotype matrix, with each row containing measurements for a single SNP across samples. Let G be the gene expression matrix, with each row containing measurements for a single gene across samples and let the columns (samples) of matrices S and G match. Then the matrix of all geneSNP correlations can be calculated in one large matrix multiplication GS T as illustrated in<ref type="figure" target="#fig_1">Figure 1</ref>. The number of tests in a modern eQTL study may exceed tens of billions and the full correlation matrix GS T would require hundreds of gigabytes of RAM. To avoid excessive memory requirements we slice the data matrices in blocks of up to 10 000 variables and perform the analysis separately for each pair of blocks.<ref type="figure" target="#fig_1">Figure 1</ref>illustrates the slicing and the calculation of the correlation matrix. The algorithm of Matrix eQTL for the simple linear regression is then:</p><p>(1) Split input matrices into blocks of up to 10 000 variables.</p><p>(2) Standardize variables of both gene expression and genotype matrices.</p><p>(3) For each pair of blocks:</p><p>(a) Calculate the corresponding block of the correlation matrix in one matrix multiplication.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.A.Shabalin</head><p>(b) Find correlations which have absolute value that exceeds a predefined threshold.</p><p>(c) For the selected correlations, calculate and report the corresponding test statistic, p-value, FDR and other variables of interest.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Model with covariates</head><p>It is common to include covariates in an eQTL model to account for such effects as population stratification, gender, age, white blood count and other clinical variables. For simplicity, let us consider the model with one extra covariate x, g = α +γ x +βs+.</p><formula>(2)</formula><p>As for the simple linear regression, various test statistics measuring the significance of s, namely LR, F-test, and t-statistic, are equivalent. For fast computations, the testing of model (2) can be reduced to testing of the simple linear regression model (1) by orthogonalizing g and s with respect to x. The algorithm for the analysis is then:</p><p>(1) Center variables g, x, and s to remove constant α from the model.</p><p>(2) Orthogonalize g and s with respect to x:</p><formula>˜ g = g−−g,xx, ˜ s = s−−s,xx.</formula><p>(3) Perform the analysis for the simple linear regressioñ g = β˜s+eβ˜s+e using one less degree of freedom for the test statistic to account for the removed covariate.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">ANOVA model</head><p>Another common approach to eQTL analysis is to include both additive and dominant effect of the genotype. This is equivalent to treating each genotype variable as categorical and modeling its effect on gene expression with ANOVA model. ANOVA model can be viewed as a linear regression</p><formula>g = α +β 1 s 1 +β 2 s 2 + (3)</formula><p>where s 1 = I(s = 1) and s 2 = I(s = 2) are dummy variables constructed for the SNP s. For this model, F-test and LR statistics for testing joint significance of s 1 and s 2 are equivalent. Moreover, F and LR are monotone functions of R 2 for this model, and thus we use R 2 as the test statistic. The test statistic can be calculated efficiently if we orthogonalize the regressors. The algorithm for the analysis is then:</p><p>(1) Center variables g, s 1 and s 2 to remove the constant α from the model.</p><p>(2) Orthogonalize s 2 with respect to s 1 for every marker</p><formula>˜ s 2 = s 2 −−s 2 ,s 1 s 1 ,</formula><formula>(3) Standardize s 1 and˜sand˜ and˜s 2 .</formula><p>(4) Calculate test statistic: R 2 ==g,s 2 ++g,˜ s 2 2 via large matrix operations.</p><p>(5) The threshold for R 2 and p-values can be derived from the formula for F-test</p><formula>F = (n−k −1)R 2 k(1−R 2 ) ,</formula><p>where k = 2 is the number of regressors (s 1 and s 2 ).</p><p>The same algorithm can be used to estimate the model with two marker-bymarker variables, such as genotype and copy number variations. It can also be generalized to test for joint significance of any subset of regressors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Heteroskedastic and/or correlated errors</head><p>The previously described models assume the noise to be independent and identically distributed across samples. However, the errors can be heteroskedastic if the quality of the measurements differs across samples. The errors may also be correlated if the samples are taken from related individuals. To account for both possibilities, let us consider the model:</p><formula>g = α +βs+u, where U ∼ N(0,σ 2 K)</formula><formula>(4)</formula><p>and K is a known positive-definite covariance matrix. To apply the previously described methods to this problem we transform the input variables to make the errors independent and identically distributed:</p><formula>˜ g = K −1/2 g, ˜ s = K −1/2 s, ˜ q = K −1/2 1 n ,</formula><p>where 1 n is a vector of length n with unit elements. The new model equation is homoskedastic, has independent errors, but does not include a constant.</p><formula>˜ g = α ˜ q+β˜s+eq+β˜s+e, where e ∼ i.i.d. N(0,σ 2 ) (5)</formula><p>The model is tested using the algorithm for the linear model with covariates with Step 1 (centering) omitted.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Q–Q plots and histograms of all p-values</head><p>Matrix eQTL has an option to record the distribution of all p-values. This is done by counting the number of p-values that fall in user-defined histogram bins. For better efficiency, Matrix eQTL collects this information without calculation of the actual p-values. Instead, the histogram bins for p-values are transformed into corresponding bins for the test statistic (which depends on the model). Then, the number of test statistics that fall in each bin is counted as part of eQTL analysis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.6">False discovery rate</head><p>Matrix eQTL calculates FDR only for the gene-SNP pairs that passed user-defined significance threshold. The calculations follow<ref type="bibr" target="#b1">Benjamini and Hochberg (1995)</ref>procedure, adapted for the situation when not all p-values are recorded.</p><formula>Let p (1) &lt; p (2) &lt; ... &lt; p (K)</formula><p>be the p-values that passed the significance threshold and let N be the total number of tests performed. Then the FDR for the corresponding gene-SNP pairs is calculated as follows</p><formula>q (K) = N K p (K) , q (i) = min N i p (i) ,q (i+1) , for i = 1,...,K −1.</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.7">Matrix multiplication algorithms</head><p>Matrix eQTL gains its efficiency by expressing the most computationally intensive part of the algorithm in terms of operations with large matrices. The most time consuming operation is matrix multiplication. Naturally, the performance of Matrix eQTL dependents strongly on the performance of the employed BLAS. In<ref type="figure" target="#tab_2">Table 2</ref>, we compare the performance of matrix multiplication for Matlab and different versions of R for Windows. For the comparison we measured the time required to multiply two 4096 × 4096 matrices with elements set to random values uniformly distributed on<ref type="bibr">[0,</ref><ref type="bibr">1]</ref>. To test the performance, the matrix multiplication was performed 10 times and the best time is recorded. The test code is available at Matrix eQTL website. The standard installation of R for Windows (R Development Core Team, 2010) includes a generic BLAS, not optimized for any particular central processing unit (CPU). The test finished in 98 and 77 s for 32 and 64 bit versions of R, respectively. There are faster versions of BLAS available for R called ATLAS (32 bit only) by (<ref type="bibr" target="#b24">Whaley and Petitet, 2005</ref>) and GOTO (64 bit only) by (<ref type="bibr" target="#b9">Goto and Geijn, 2008</ref>) adapted for R by Ei-Ji Nakama<ref type="bibr">[</ref><ref type="bibr" target="#b22">Strassen, 1969</ref>) and even O(n 2.376 ) (<ref type="bibr" target="#b4">Coppersmith and Winograd, 1990</ref>). However, in practice, the new methods do not outperform the direct one even for relatively large matrices (n ≈ 2000), and in certain circumstances they may experience numerical instability. Specifications of the computer and software used for testing: CPU: Intel Xeon X3430 (2.4 GHz, 4 cores, 38.4 Gflop); RAM: 16 GB DDR3; OS: Windows 7 (64 bit); Matlab R2010b (64 bit); R 2.14.1; Revoluton R Enterprise 4.3 (64 bit).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Matrix eQTL</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION AND CONCLUSION</head><p>Matrix eQTL can perform analyses that previously required days or weeks in several minutes. QTL modelers who have only a handful of phenotypes understand the importance of testing several different models with covariates and interaction terms. Until now, this has not been feasible with eQTL analyses due to the computational burden. Matrix eQTL allows analysts to fit a variety of models with different mixes of covariates in &lt;1 h and compare the results. Likewise, it allows analysts to compare different preprocessing and quality control procedures. Furthermore, once an appropriate model has been selected, Matrix eQTL can be used to determine permutationbased significance thresholds in less time than most packages take to generate nominal p-values. Matrix eQTL will greatly improve the ability of analysts to find true eQTLs by fitting the right model and choosing the best preprocessing and quality control procedures. The utility of Matrix eQTL is not limited to association testing between microarray and genotype data. Matrix eQTL was used by<ref type="bibr">Xia et al. (2012)</ref>to analyze RNA-seq data. RNA-seq data was preprocessed by applying variance stabilizing transformation for the Poisson counts and correcting for the differences in total read counts across samples. Matrix eQTL can be used for the analysis pairs of genetic/genomic datasets of various types, including measurements of allele specific gene expression, genotype, methylation and copy number variations. It can also be applied to find strongly dependent variables within a single dataset (e.g. gene–gene interactions). For the future versions of Matrix eQTL we plan to consider several extensions and modification. First, we consider performing calculation on GPUs, instead of the CPU. The tests in Section 3.7 suggest that use of GPU in Matrix eQTL may provide 10-fold increase in the performance. We will also consider using Matrix eQTL optimization techniques for fast estimation of more complex models, such as multi-SNP models and generalized linear model (via efficient score statistic).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>FastMap — 18.4 min, Merlin — 12.3 min, Plink — 9.0 min, Matrix eQTL — 5.7 min and snpMatrix — 3.3 min. SnpMatrix was incredibly fast loading the genotype data (only 22 s), but it still relied on standard R functions to load the expression matrix. The performance of Martix eQTL depends on the choice of the model and other parameters. Table 1 shows that for the simple linear regression model Matrix eQTL (Rev R) performs the analysis in 14.6 min. The analysis using ANOVA model takes twice as long (29.1 min). Testing for significance of genotype-covariate interaction takes slightly longer than ANOVA model (32.7 min). Testing additive linear model with correlated errors takes 15.4 min. Addition of covariates has almost no effect on the performance of Matrix eQTL regardless of the model. Recording the distribution of all 12 billion</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. Matrix of correlations can be calculated using multiplication of large matrices. Due to the large number of tests the analysis performed in 10 000× 10 000 blocks.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [15:36 7/5/2012 Bioinformatics-bts163.tex] Page: 1356 1353–1358</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><figDesc>http://prs.ism.ac.jp/∼nakama/SurviveGotoBLAS2/binary/windows/x64/].</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>Copyedited by: TRJ MANUSCRIPT CATEGORY: ORIGINAL PAPER [15:36 7/5/2012 Bioinformatics-bts163.tex] Page: 1357 1353–1358</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>Funding: National Institutes of Health (R01-MH090936 and R01-ES015241), US Environmental Protection Agency (STAR RD83382501 and RD83272001), National Cancer Institute (R01CA138255), National Science Foundation grant (DMS-0907177), National Institute of Mental Health (R01-MH090936) and the Gillings Innovation Laboratory in Statistical Genomics. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Estimated performance of various eQTL software on the CF dataset</figDesc><table>Method\No. of covariates 
Zero 
Ten 

Plink 
9.4 
583.3 
days 
Merlin 
19.6 
20.0 
days 
R/qtl (Revolution R) 
1.0 
4.7 
days 
snpMatrix 
3.2 
5.1 
days 
eMap 
17.8 
N/A 
days 
FastMap 
10.3 
N/A 
hours 
Matrix eQTL (Matlab) 
11.8 
11.8 
minutes 
Matrix eQTL (Revolution R) 
14.6 
14.6 
minutes 
Matrix eQTL (R, Goto BLAS) 
19.4 
19.</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>Table 2.</figDesc><table>Speed of various software multiplying 4096 × 4096 matrices 

Package 
BLAS 
Time (s) 
Comment 

R x32 2.14.1 
Build-in 
98.1 
R x64 2.14.1 
Build-in 
77.0 
R x32 2.14.1 
Atlas C2D 
16.5 
R x64 2.14.1 
Goto 
5.5 
Revolution R 4.3 
Intel KML 
3.8 
Matlab R2010b 
Intel KML 
3.8 
Matlab R2010b 
Intel KML 
1.8 
Single precision 
Matlab R2010b 
GPU CUDA 
0.8 
GTX 480, double 
Matlab R2010b 
GPU CUDA 
0.2 
GTX 480, single 

The matrix multiplication test on R with ATLAS BLAS finished in just 
16.5 s. Next we tested Matlab and Revolution R, a commercial version 
of R available free of charge for academic purposes. They both employ 
Intel Kernel Math Library (KML), which is optimized for Intel CPUs (used 
in the test machine). Both Intel KML and GOTO BLAS are able to use 
multiple CPU cores and show 3–4 times better performance than ATLAS 
BLAS in R. About twice better performance can be achieved by switching 
from double to single precision calculations; we did not use this option in 
Matrix eQTL to avoid loss of accuracy. Single precision calculations are 
available only in Matlab. The last lines in the table show performance of 
Nvidia GeForce GTX 480 GPU (graphics processing unit). It offers ten 
times better performance than the best algorithm for the CPU for single 
precision calculations. Matlab 2010b has a limited build-in support for 
GPU-based calculations. 
The complexity of the direct matrix multiplication algorithm for square 
n×n </table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Merlin–rapid analysis of dense genetic maps using sparse gene flow trees</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Abecasis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="97" to="101" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Controlling the false discovery rate: a practical and powerful approach to multiple testing</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Benjamini</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Hochberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Roy. Stat. Soc. B Meth</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="289" to="300" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Genetical genomics: spotlight on QTL hotspots</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Breitling</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">R/qtl: QTL mapping in experimental crosses</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Broman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page">889</biblScope>
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Matrix multiplication via arithmetic progressions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Coppersmith</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Winograd</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Symb. Comput</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="251" to="280" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Genomics and genome-wide association studies: an integrative approach to expression QTL mapping</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Degnan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genomics</title>
		<imprint>
			<biblScope unit="volume">92</biblScope>
			<biblScope unit="page" from="129" to="133" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">FastMap: fast eQTL mapping in homozygous populations</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Gatti</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="25" to="482" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">High-resolution mapping of gene expression using association in an outbred mouse stock</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ghazalpour</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Revealing the architecture of gene regulation: the promise of eQTL studies</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Gilad</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Genet</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="408" to="415" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Anatomy of high-performance matrix multiplication</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Goto</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Geijn</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM Trans. Math. Softw</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page">12</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Simultaneous analysis of all SNPs in genome-wide and resequencing association studies</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Hoggart</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Multiple interval mapping for quantitative trait loci</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Kao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">152</biblScope>
			<biblScope unit="page">1203</biblScope>
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">A review of statistical methods for expression quantitative trait loci mapping</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Kendziorski</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mamm. Genome</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="509" to="517" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Capturing heterogeneity in gene expression studies by surrogate variable analysis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Leek</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">161</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Predicting unobserved phenotypes for complex traits from wholegenome SNP data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Lee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">An R package for analysis of whole-genome association studies</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Leung</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Hered</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="page" from="45" to="51" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Correction for hidden confounders in the genetic analysis of gene expression</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Listgarten</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci</title>
		<meeting>. Natl Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page">16465</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">PLINK: a tool set for whole-genome association and populationbased linkage analyses</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Purcell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="559" to="575" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Development</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Core</forename>
				<surname>Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Imputation-based analysis of association studies: candidate regions and quantitative traits</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Servin</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Stephens</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">114</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="m">Bioinformatics-bts163.tex] Page</title>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="1358" to="1353" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<monogr>
		<title/>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">A</forename>
				<surname>Shabalin</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Gaussian elimination is not optimal</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Strassen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Numer. Math</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="354" to="356" />
			<date type="published" when="1969" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<monogr>
		<title level="m" type="main">eQTL Analysis by Linear Model Available at</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Sun</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Minimizing development and maintenance costs in supporting persistently optimized BLAS</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Whaley</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Petitet</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Softw. Pract. Exp</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="101" to="121" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Genome-wide association and linkage identify modifier loci of lung disease severity in cystic fibrosis at 11p13 and 20q13.2</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Wright</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="page" from="539" to="546" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">2012) seeQTL: a searchable database for human eQTLs</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Xia</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="451" to="452" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Theoretical basis for separation of multiple linked gene effects in mapping quantitative trait loci</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Zeng</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci., 90</title>
		<meeting>. Natl Acad. Sci., 90</meeting>
		<imprint>
			<date type="published" when="1993" />
			<biblScope unit="page">10972</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">From QTL Mapping to eQTL Analysis</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Liu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Frontiers in Computational and Systems Biology</title>
		<editor>F. Jianfeng, F, Wenjiang, and Sun, F.</editor>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page" from="301" to="329" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>