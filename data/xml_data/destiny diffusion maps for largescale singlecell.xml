
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:40+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression destiny: diffusion maps for large-scale single-cell data in R</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Philipp</forename>
								<surname>Angerer</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Laleh</forename>
								<surname>Haghverdi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Maren</forename>
								<surname>Bü Ttner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Fabian</forename>
								<forename type="middle">J</forename>
								<surname>Theis</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Center for Mathematics</orgName>
								<orgName type="department" key="dep2">Chair of Mathematical Modeling of Biological Systems</orgName>
								<orgName type="institution">Technische Universität Mü nchen</orgName>
								<address>
									<addrLine>Boltzmannstr. 3</addrLine>
									<postCode>85748</postCode>
									<settlement>Garching</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Carsten</forename>
								<surname>Marr</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Florian</forename>
								<surname>Buettner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Institute of Computational Biology</orgName>
								<orgName type="department" key="dep2">Ingolstä dter Landstr. 1</orgName>
								<orgName type="institution">Helmholtz Zentrum Mü nchen -German Research Center for Environmental Health</orgName>
								<address>
									<postCode>85764</postCode>
									<settlement>Neuherberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression destiny: diffusion maps for large-scale single-cell data in R</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv715</idno>
					<note type="submission">Received on 5 August 2015; revised on 28 October 2015; accepted on 1 December 2015</note>
					<note>*To whom correspondence should be addressed. † Present address: European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Trust Genome Campus, Cambridge, CB10 1SD, UK. Associate Editor: Ziv Bar-Joseph Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Diffusion maps are a spectral method for non-linear dimension reduction and have recently been adapted for the visualization of single-cell expression data. Here we present destiny, an efficient R implementation of the diffusion map algorithm. Our package includes a single-cell specific noise model allowing for missing and censored values. In contrast to previous implementations , we further present an efficient nearest-neighbour approximation that allows for the processing of hundreds of thousands of cells and a functionality for projecting new data on existing diffusion maps. We exemplarily apply destiny to a recent time-resolved mass cytometry dataset of cellular reprogramming. Availability and implementation: destiny is an open-source R/Bioconductor package &quot; bioconductor.org/packages/destiny &quot; also available at www.helmholtz-muenchen.de/icb/destiny. A detailed vignette describing functions and workflows is provided with the package.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Recent technological advances allow for the profiling of individual cells, using methods such as single-cell RNA-seq, single-cell RT qPCR or cyTOF (<ref type="bibr" target="#b5">Roditi et al., 2015</ref>). These techniques have been used successfully to study stem cell differentiation with timeresolved single-cell experiments, where individual cells are collected at different absolute times within the differentiation process and profiled. While differentiation is a smooth but nonlinear process (<ref type="bibr" target="#b0">Buettner and Theis, 2012;</ref><ref type="bibr" target="#b3">Haghverdi et al., 2015</ref>) involving continuous changes of the overall transcriptional state, standard methods for visualizing such data are either based on linear methods such as Principal Component Analysis (see Supplementary<ref type="figure" target="#fig_0">Fig. S1</ref>) and Independent Components Analysis or they use clustering techniques not accounting for the smooth nature of the data. In contrast, diffusion maps—initially designed by<ref type="bibr" target="#b2">Coifman et al. (2005)</ref>for dimensionality reduction in image processing—recover a distance measure between each pair of data points (cells) in a low dimensional space that is based on the transition probability from one cell to the other through several paths of a random walk. Diffusion maps are especially suited for analysing single-cell gene expression data from differentiation experiments (such as time-course experiments) for three reasons. First, they preserve the global relations between data points. This feature makes it possible to reconstruct developmental traces by re-ordering the asynchronously differentiating cells according to their internal differentiation state. Second, the notion of diffusion distance is robust to noise, which is ubiquitous in single-cell data. Third, by normalizing for sampling density, diffusion maps become insensitive to the distribution of the data points(i.e. sampling density), which aids the detection of rare cell populations. Here, we present a user friendly R implementation of diffusion maps including previously proposed adaptations to single cell data (<ref type="bibr" target="#b3">Haghverdi et al., 2015</ref>) as well as novel functionality. The latter includes approximations allowing for the visualization of large data sets and the projection of new data on existing maps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Description: the destiny package</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Algorithm</head><p>As input, destiny accepts an expression matrix or data structure extended with annotation columns. Gene expression data should be pre-processed and normalized using standard workflows (see Supplementary Text S1) before generating the diffusion map. destiny calculates cell-to-cell transition probabilities based on a Gaussian kernel with width r to create a sparse transition probability matrix M. If the user does not specify r, destiny employs an estimation heuristic to derive this parameter (see Supplementary Text S2). In contrast to other implementations, destiny allows for the visualization of hundreds of thousands of cells by only using distances to the k nearest neighbors of each cell for the estimation of M (see Supplementary Text S2). Optionally destiny uses an applicationspecific noise model for censored and missing values in the dataset (see Supplementary<ref type="figure">Fig. S2</ref>). An eigendecomposition is performed on M after density normalization, considering only transition probabilities between different cells. By rotating M, a symmetric adjoint matrix can be used for a faster and more robust eigendecomposition (<ref type="bibr" target="#b1">Coifman et al., 2008</ref>). The resulting data-structure contains the eigenvectors with decreasing eigenvalues as numbered diffusion components, the input parameters and a reference to the data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Visualization and projection of new data</head><p>This data-structure can be easily plotted and colored using the parameters of provided plot methods. An automatic color legend integrated into R's palette system facilitates the generation of publication-quality plots. A further new feature in destiny is the ability to integrate new experimental data in an already computed diffusion map. destiny provides a projection function to generate the coordinates for the new data without recalculating the diffusion map by computing the transition probabilities from new data points to the existing data points (see Supplementary Text S3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Application</head><p>We applied destiny to four single-cell datasets of different size (hundreds to hundreds of thousands of cells) and characteristics (qRTPCR, RNA-Seq and mass cytometry, see Supplementary<ref type="figure">Table S1</ref>). We first estimate the optimal r that matches the intrinsic dimensionality of the data (<ref type="figure" target="#fig_0">Fig. 1A</ref>and Supplementary Figs S3A and S4A). Using a scree plot (<ref type="figure" target="#fig_0">Fig. 1B</ref>and Supplementary Figs S3B, S4B and S5A), the relevant diffusion components can be identified. However, for big datasets as the mass cytometry data from<ref type="bibr" target="#b6">Zunder et al. (2015)</ref>with 256 000 cells and 36 markers, corresponding Eigenvalues decrease smoothly. Although only a part of the intrinsic dimensionality can be represented in a 3D plot, the diffusion map reveals interesting properties of the reprogramming dynamics (<ref type="figure" target="#fig_0">Fig. 1C</ref>and Supplementary<ref type="figure">Fig. S6</ref>). We compared destiny's performance to other implementations, including our own in MATLAB (based on Maggioni code (http://www.math.duke.edu/mauro/code.html), published with<ref type="bibr" target="#b3">Haghverdi et al., 2015</ref>) and the diffusionMap R package (<ref type="bibr" target="#b4">Richards, 2014</ref>). destiny performs similarly well for small datasets, while outperforming other implementations for large datasets (Supplementary<ref type="figure">Table S1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Discussion and conclusion</head><p>We present a user-friendly R package of the diffusion map algorithm adapted to single-cell gene expression data and include new features for efficient handling of large datasets and a projection functionality for new data. We illustrate the capabilities of our package by visualizing gene expression data of 250 000 cells and show that our package is able to reveal continuous state transitions. Together with an easy to use interface this facilitates the application of diffusion map as new analysis tool for singlecell gene expression data.pressing stem cell markers is clearly separated, cells that revert to the MEF state are found proximal to the initial population in the diffusion map. Inset: destiny code to generate the diffusion map</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. destiny applied to the mass cytometry reprogramming dataset of Zunder et al. (2015) with 36 markers and 256 000 cells. (A) The optimal Gaussian kernel width r. (B) The Eigenvalues of the first 100 diffusion components decrease smoothly, indicating a large intrinsic dimensionality of the data. (C) The initial population of mouse embryonic fibroblasts (MEFs) is reprogrammed and profiled over 20 days. While a final cell population expressing stem cell markers is clearly separated, cells that revert to the MEF state are found proximal to the initial population in the diffusion map. Inset: destiny code to generate the diffusion map</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1241 Bioinformatics, 32(8), 2016, 1241–1243 doi: 10.1093/bioinformatics/btv715 Advance Access Publication Date: 14 December 2015 Applications Note</figDesc><table></table></figure>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">P.Angerer et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from (BioSysNet) and the ERC (starting grant LatentCauses to FJT). MB is supported by a DFG Fellowship through the Graduate School of Quantitative Biosciences Munich (QBM). Conflict of Interest: none declared.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>We thank Chris McGinnis (Seattle, USA), Vicki Moignard (Cambridge, UK), Eli Zunder and Garry Nolan (both Stanford, USA) for helpful comments on destiny.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>Supported by the UK Medical Research Council (Career Development Award to FB), the Bavarian Research Network for Molecular Biosystems</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A novel approach for resolving differences in single-cell gene expression patterns from zygote to blastocyst</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Buettner</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">J</forename>
				<surname>Theis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="626" to="632" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Diffusion maps, reduction coordinates, and low dimensional representation of stochastic systems</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Coifman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Multisc. Model. Simul</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="842" to="864" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Coifman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci</title>
		<meeting>. Natl. Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="7426" to="7431" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Diffusion maps for high-dimensional singlecell analysis of differentiation data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Haghverdi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="2989" to="2998" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<monogr>
		<title level="m" type="main">diffusionMap: Diffusion Map. CRAN. http://cran.r-pro ject</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Richards</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Computational and experimental single cell biology techniques for the definition of cell type heterogeneity, interplay and intracellular dynamics</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Roditi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Opin. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="9" to="15" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">A continuous molecular roadmap to iPSC reprogramming through progression analysis of single-cell mass cytometry</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">R</forename>
				<surname>Zunder</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell Stem Cell</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="323" to="337" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>