
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:50+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis Bayesian sampling of genomic rearrangement scenarios via double cut and join</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010">2010 . 2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">István</forename>
								<surname>Miklós</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Stochastics</orgName>
								<orgName type="institution">Rényi Institute</orgName>
								<address>
									<addrLine>Reáltanoda u. 13-15</addrLine>
									<postCode>1053</postCode>
									<settlement>Budapest</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Computer and Automation Institute</orgName>
								<orgName type="laboratory">Data Mining and Search Research Group</orgName>
								<orgName type="institution">Hungarian Academy of Sciences</orgName>
								<address>
									<settlement>Budapest</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Eric</forename>
								<surname>Tannier</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="laboratory" key="lab1">UMR5558</orgName>
								<orgName type="laboratory" key="lab2">Laboratoire de Biométrie et Biologie Évolutive</orgName>
								<orgName type="institution" key="instit1">INRIA Rhône-Alpes</orgName>
								<orgName type="institution" key="instit2">Université de Lyon</orgName>
								<orgName type="institution" key="instit3">Université Lyon 1</orgName>
								<orgName type="institution" key="instit4">CNRS</orgName>
								<address>
									<postCode>F-69622</postCode>
									<settlement>Villeurbanne</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis Bayesian sampling of genomic rearrangement scenarios via double cut and join</title>
					</analytic>
					<monogr>
						<title level="j" type="main">Bioinformatics-btq574.tex] BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">12</biblScope>
							<biblScope unit="issue">26 24</biblScope>
							<biblScope unit="page" from="30" to="48"/>
							<date type="published" when="2010">2010 . 2010</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq574</idno>
					<note type="submission">Received on June 16, 2010; revised on September 28, 2010; accepted on October 6, 2010</note>
					<note>Page: 3012 3012–3019 Associate Editor: Martin Bishop Contact: miklosi@renyi.hu</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: When comparing the organization of two genomes, it is important not to draw conclusions on their modes of evolution from a single most parsimonious scenario explaining their differences. Better estimations can be obtained by sampling many different genomic rearrangement scenarios. For this problem, the Double Cut and Join (DCJ) model, while less relevant, is computationally easier than the Hannenhalli–Pevzner (HP) model. Indeed, in some special cases, the total number of DCJ sorting scenarios can be analytically calculated, and uniformly distributed random DCJ scenarios can be drawn in polynomial running time, while the complexity of counting the number of HP scenarios and sampling from the uniform distribution of their space is unknown, and conjectured to be #P-complete. Statistical methods, like Markov chain Monte Carlo (MCMC) for sampling from the uniform distribution of the most parsimonious or the Bayesian distribution of all possible HP scenarios are required. Results: We use the computational facilities of the DCJ model to draw a sampling of HP scenarios. It is based on a parallel MCMC method that cools down DCJ scenarios to HP scenarios. We introduce two theorems underlying the theoretical mixing properties of this parallel MCMC method. The method was tested on yeast and mammalian genomic data, and allowed us to provide estimates of the different modes of evolution in diverse lineages. Availability: The program implemented in Java 1.5 programming language is available from http://www.renyi.hu/~miklosi/DCJ2HP/.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Although genome rearrangement was the very first clearly stated computational problem in biology introduced by<ref type="bibr" target="#b27">Sturtevant and Novitski (1941)</ref>, and many computational methods finding one most parsimonious rearrangement scenario have been published in the past 15 years, the statistical tools available for analysing genome rearrangements are still very limited.<ref type="bibr" target="#b12">Hannenhalli and Pevzner (1999)</ref>published the first polynomial running time algorithm that finds a most parsimonious scenario transforming one genome * To whom correspondence should be addressed. into another using reversals. The method has been extended to transforming multichromosomal genomes by reversals and translocations (<ref type="bibr" target="#b11">Hannenhalli and Pevzner, 1995</ref>). This general model is called the Hannenhalli–Pevzner (HP) model. Having a single parsimonious scenario is usually not enough to draw conclusions on the evolution of the genomes. For example,<ref type="bibr" target="#b1">Bergeron et al. (2008)</ref>have computed different values of the breakpoint reuse rate for different scenarios transforming a human genome into a mouse genome, which tell different stories about their evolution. Exact counting or sampling in the space of parsimonious HP scenarios seems to be difficult and has only been achieved for very small examples (<ref type="bibr" target="#b3">Braga et al., 2008</ref>). Several authors published Markov chain Monte Carlo methods that sample from a Bayesian distribution of genome rearrangement scenarios (<ref type="bibr" target="#b7">Durrett et al., 2004;</ref><ref type="bibr" target="#b14">Larget et al., 2002;</ref><ref type="bibr" target="#b18">Miklós, 2003</ref>), but these Markov chains have very poor mixing (<ref type="bibr" target="#b6">Darling et al., 2008</ref>), and it has been proved that there are series of data (pair of genomes) for which the mixing time of these Markov chains grows exponentially with the size of the data (<ref type="bibr" target="#b21">Miklós et al., 2010</ref>). This means that billions of Markov chain Monte Carlo (MCMC) steps are necessary to get a sufficient number of low-correlated samples from the Markov chain, making the approach computationally infeasible for large datasets.<ref type="bibr" target="#b19">Miklós and Darling (2009)</ref>introduced a massively parallel MCMC method that samples from the uniform distribution of most parsimonious reversal scenarios, and approximately counts the number of such scenarios. By applying the method on real biological data, they showed that it is superior to other available methods. However, they could not prove that fast mixing of their Markov chain is guaranteed for any input. Furthermore, their method works only for most parsimonious reversal scenarios, and it is not clear how to extend it to sampling from the Bayesian distribution of all possible HP scenarios. The double cut and join (DCJ) model was introduced by<ref type="bibr" target="#b28">Yancopoulos et al. (2005)</ref>and in a slightly different version by<ref type="bibr" target="#b0">Bergeron et al. (2006)</ref>. This model allows all types of mutations of the HP model, together with mutations that are rarely observed in biological data. In particular, the formation of circular chromosomes, which is frequent in the DCJ model, is never observed in the evolution of Eukaryote genomes. A few big transpositions possibly issued from such a mechanism are hypothesized (<ref type="bibr" target="#b26">Ross et al., 2005</ref>), and some cancer karyotypes carry circular chromosomes. However, observed as well as predicted rearrangements are almost always of HP type. For example,<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>infer a scenario with</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Rearrangement sampling via DCJ</head><p>144 rearrangements on the yeast genome that we also use in this study, all of them being HP mutations. So a current convention, supported by past observations, which might be refuted in the future, assumes that the DCJ scenarios have lower biological relevance than translocations and reversals scenarios. On the other hand, the algorithmics of DCJ is much simpler. Indeed, not only can the DCJ distance be calculated in linear time (<ref type="bibr" target="#b28">Yancopoulos et al., 2005</ref>) (as well as the HP distance), but also it is possible to quickly count the number of most parsimonious DCJ scenarios of co-tailed genomes (<ref type="bibr" target="#b4">Braga and Stoye, 2009;</ref><ref type="bibr" target="#b22">Ouangraoua and Bergeron, 2009</ref>). Furthermore, it is also possible to quickly sample from the uniform distribution of DCJ scenarios of co-tailed genomes (<ref type="bibr" target="#b23">Ouangraoua and Bergeron, 2010</ref>). The computational simplicity on its own would not be sufficient to intensively study the DCJ model; however, it opened a new perspective in developing novel methods for inferring genome rearrangements. Indeed, the DCJ model has turned to be a computationally useful concept, for example, the genome rearrangement distance under the HP model can be calculated in linear time via the DCJ distance (<ref type="bibr" target="#b2">Bergeron et al., 2009</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">APPROACH</head><p>In this article, we explore further how the DCJ model helps developing computational tools for inferring genome rearrangements. We conjecture that counting the number of most parsimonious HP scenarios is hard (#P-complete), and hence, sampling exactly from the uniform distribution of most parsimonious scenarios or from the Bayesian distribution of all possible scenarios is also hard. However, approximate stochastic counting or sampling could be possible, and one way to do it is to use the computationally simpler DCJ model. We introduce a parallel Markov chain Monte Carlo method sampling DCJ scenarios transforming one genome into another. Each Markov chain has its fixed temperature, and the distribution of the rearrangement scenarios depends on the temperature of the chain in the following way. We define an energy function mapping from the scenarios to real numbers. Scenarios containing many DCJs that are not in the HP model get a high energy, and the minimum energy is taken on the scenarios that have only HP-type mutations. At infinite temperature, all types of mutations of the DCJ model are equally probable. The probability of DCJ mutations that are not in the HP model decreases with the temperature, and at zero temperature, only the mutations in the HP model have non-zero probability. See Section 3 for details. We implemented the method in the Java programming language, and tested it on yeast and mammalian data. In Section 4, we show how our method can provide quantitative estimates of the ratio of different types of rearrangements. Such numbers were previously inferred by hand (<ref type="bibr" target="#b10">Gordon et al., 2009</ref>) with a lot of uncertainties, or from a single parsimonious scenario, which, given the huge number of equivalent ones, is unsound. We correct the manual estimate of<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>on yeast data, and show that the rates of reversal/translocation are very different among studied taxa. In addition to this demonstration of the applicability of our novel approach, we prove in the Appendix that</p><p>(1) Any DCJ scenario can be transformed into an HP scenario using the small changes of the Markov chains, such that the energy is monotonously decreasing. This means that the surface of the energy function we defined is smooth in the sense that all local minima are global minima.</p><p>(2) With an appropriately chosen number of parallel chains and temperatures, the probability of exchanging information between any two neighbour chains is above 1/2. Furthermore, the highest temperature can be chosen to infinite, and the lowest temperature can be chosen such that the probability of an HP scenario in its distribution is at least 1 2 .</p><p>The first theorem guarantees that the MCMC cannot be trapped in a local minimum. The second theorem shows that the MCMC will not be trapped even in a global minimum, it can break out from a global minimum to visit another global minimum. Such break out is essential for fast mixing, as<ref type="bibr" target="#b21">Miklós et al. (2010)</ref>proved that these global minima might be far from each other, thus causing slow mixing. In summary, we build theoretically founded and biologically sound rearrangement scenarios. This allows to observe some modes of evolution in different taxa, as well as to provide analyses for the construction of more precise models of structural evolution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Definitions and notations</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">Genomes</head><p>A gene a is an oriented sequence of DNA, identified by its tail a t and its head a h. Tails and heads are the extremities of the genes. An adjacency is an unordered pair of gene extremities. A genome is a set of adjacencies on a set of genes, where a gene extremity belongs to at most one adjacency. Each adjacency in a genome means that two gene extremities are consecutive on the DNA molecule. In a genome, a gene extremity g which does not belong to an adjacency is called a telomere. For a genome on a set of genes, we define the graph G : its vertex set is the set of all gene extremities, and its edge set is composed of a t a h for every gene a, plus the adjacencies of. The graph G is composed of disjoint cycles and paths. Each component of G is called a chromosome of. A chromosome is linear, if it is a path, and circular if it is a cycle. A genome is linear, if it has only linear chromosomes, and circular, if it has only circular chromosomes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">DCJ and HP operations If G</head><p>is the set of gene extremities, let G * = G ∪{T } be the same set extended with an additional null element T. A DCJ ρ is an oriented pair ((pq,rs),(pr,qs)), where p,q,r,s are elements of G * , and couples pq, rs, pr, qs, as well as couples (pq,rs) and (pr,qs) are not oriented. A DCJ is valid for a genome if pq and rs are either adjacencies of , of type Tx where x is a telomere of , or of type TT. Applying a valid DCJ on removes the two adjacencies pq and rs if they exist, and creates the two adjacencies pr and qs or telomeres x if pr or qs equals xT. The result of applying a valid DCJ ρ on a genome is denoted by /ρ. A DCJ scenario between two genomes and on the same set of genes is a sequence ρ 1 ...ρ k of valid DCJ operations (ρ i is valid for /ρ 1 /.../ρ i−1 ) such that /ρ 1 /.../ρ k =. The length of a shortest DCJ scenario between two genomes and is the DCJ distance, denoted by d DCJ (,). Given two genomes and , a valid DCJ operation for falls into one of these three categories: decreasing the distance by 1, not changing the distance and increasing the distance by 1. These three types will be denoted by-1-DCJ, 0-DCJ and +1-DCJ, respectively. In a scenario S, two consecutive DCJs ((pq,rs),(pr,qs)) and ((ab,cd),(ac,bd)) are said to commute if the intersection between {p,q,r,s} and {a,b,c,d} is empty or is the singleton {T }. It is easy to check that if two consecutive DCJ commute, then it is possible to swap their positions in the scenario, and obtain a valid scenario again.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Page: 3014 3012–3019</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I.Miklós and E.Tannier</head><p>A DCJ operation can change the structure of a genome in several ways. If it acts on one or two linear chromosomes and does not create any circular chromosome, then it is called an HP operation. The DCJs that are also HP operations are the following: reversals, changing the order and orientation of the genes in a segment of a chromosome, reciprocal translocations, where two chromosomes exchange an arm (possibly one of the arms is empty), fusions of two linear chromosomes, and fissions of one linear chromosome into two linear ones. The DCJs that are not HP operations are: fusions of one linear and one circular chromosome or of two circular chromosomes, fissions of one chromosome into a linear and a circular chromosome or into two circular chromosomes, circularization or linearization of chromosomes. The number of valid HP operations for a genome will be denoted by v().</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.3">Breakpoint graphs</head><p>The breakpoint graph of two genomes and on the same set of genes, denoted by<ref type="bibr">BP(,)</ref>, is the graph in which vertex set is the set of extremities of the genes, and in which there is an edge between two vertices x and y if xy is an adjacency in either (these are-edges) or (-edges).</p><p>The breakpoint graph of two genomes is a set of disjoint paths and cycles. The DCJ distance is immediately readable from the breakpoint graph. Theorem 1. (<ref type="bibr" target="#b0">Bergeron et al., 2006</ref>) For two genomes and ,</p><formula>d DCJ (,) = n− c(,)+</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">MCMC</head><p>We apply a parallel MCMC method, where there are several Markov chains, each converging to a prescribed distribution. Each chain has a fixed hypothetical temperature, the target distribution of the chain depends on the temperature. Unlike the usual Parallel Tempering method (<ref type="bibr" target="#b9">Geyer, 1991</ref>), the distribution is not simply a Boltzmann distribution. In Section 3.2.1, we precisely define the target distribution of a chain at a particular temperature. The chains are coupled in a Metropolis Coupling way described in Section 3.2.2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.1">The probability distribution of a chain at a particular temperature</head><p>The states of the Markov chains are the tuples {R,r}, where R is a DCJ scenario between genomes and , and r is the rate of any DCJ mutation. To reach a distribution over this state space, we first introduce a Markov model on HP scenarios. We model genome evolution with a continuous time Markov model, where any valid HP mutation can happen with a rate r. Since we cannot measure the evolutionary time and the rate of mutations independently, w.l.o.g., we can set the evolutionary time to unit 1, and let only the evolutionary rate vary. The probability density that the first HP mutation happens after time t is e −v()rt</p><formula>(1)</formula><p>The probability of a particular scenario R = ρ 1 ,ρ 2 ,...,ρ k starting from genome given parameter r is given by the integral</p><formula>P(R|,r) = 1 t k =t k−1 1 t k−1 =t k−2 ··· 1 t 1 =0 e −v()rt 1 r× ×e −v(/ρ 1 )r(t 2 −t 1 ) r ×···×e −v(/ρ 1 ρ 2 ...ρ k−1 )r(t k −r k−1 ) r× (2)</formula><p>×e −v()r(1−t k ) dt 1 dt 2 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>..dt k</head><p>Although there is no closed formula for Equation (2), it can be analytically calculated by an efficient algorithm introduced by<ref type="bibr" target="#b20">Miklós et al. (2004)</ref>. We can define the likelihood of parameter r using the data augmentation on the possible scenarios:</p><formula>L(r) = P(|r,,) = R|(,) P(R|r,,) (3)</formula><p>where R|(,) means a summation over scenarios R transforming into . By setting the prior distribution of r to the exponential distribution with expectation 1, we arrive to the posterior distribution of {R,r}:</p><formula>P {R,r} ∝ P(R|,r)e −r (4)</formula><p>We extend the formula in Equation (2) to DCJ scenarios. Note that in this case, P(R|,r) is not a probability distribution in the sense that the equation</p><formula>R|(,) P(R|,r) = 1 (5)</formula><p>holds only if we restrict the summation to HP scenarios. However, P({R,r}) in Equation (4) is still a well-defined distribution when R can be any DCJ scenario. Furthermore, if we restrict this extended distribution to the HP scenarios, we get back the proper Bayesian distribution. This restriction can be done by omitting the non-HP scenarios from the MCMC samples. For each scenario, we define the DCJ energy function, c(R), as the sum of the number of circular chromosomes along the scenario. The target distribution of the Markov chain is</p><formula>π i ({R,r}) ∝ P {R,r} ×e − c(R) T i (6)</formula><p>where T i is the temperature of chain i. The restriction of this distribution to the HP scenarios is exactly the Bayesian distribution defined in Equation (4), which is our aim.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.2">MCMC steps</head><p>There are two types of steps in the global MCMC, composed of k parallel chains: @BULLET chain-swapping steps @BULLET in-chain steps.</p><p>The probability of both types of steps is 0.5. In chain-swapping steps, a random i is drawn from the uniform distribution on<ref type="bibr">[1..k −1]</ref>. The two states of the two chains i and i+1 are swapped with probability min</p><formula>⎧ ⎨ ⎩ 1, e − c(R i )</formula><formula>T i+1 ×e − c(R i+1 ) T i e − c(R i ) T i ×e − c(R i+1 ) T i+1 ⎫ ⎬ ⎭ (7)</formula><p>Swapping the two states with this probability guarantees the convergence of the chains to their prescribed distribution (<ref type="bibr" target="#b9">Geyer, 1991</ref>).<ref type="bibr">Equation (7)</ref>shows that all hidden normalizing constants introduced by extending the HP scenarios to DCJ scenarios and by defining distributions up to unknown normalizing constants in Equation (4 and 6) cancel out. When an in-chain step is chosen, a random i is drawn from the uniform distribution on<ref type="bibr">[1..k]</ref>. With probability 1 2 , a random window w is chosen from state of chain i, and a new scenario is proposed for this window, independently from the current scenario in the window. The new scenario is constructed by iteratively proposing a new valid DCJ for the current genome. For each valid DCJ to be chosen, the type is first determined according to<ref type="figure" target="#tab_1">Table 1</ref>. Then we choose one DCJ of this type uniformly, and apply this mutation to the genome. If the result is not the genome , then the outcome will be the input of the next step. If the result is , then we stop with probability 0.99, and with probability 0.01 we propose as the input of the next step. Since we know the cardinality of all the three subsets of mutations, we can calculate the proposal and backproposal probabilities easily. The probability of accepting the new scenario is defined by the Metropolis– Hasting ratio (<ref type="bibr">Hastings, 1970;</ref><ref type="bibr" target="#b17">Metropolis et al., 1953</ref>). With probability 1 2 , mutation rate r is changed following a standard Metropolis–Hastings algorithm (<ref type="bibr" target="#b16">Liu, 2001</ref>). The method has been implemented in Java 1.6 and its correctness has been tested on some toy examples.There are only five different cases because it is easy to prove that if there is no −1-DCJ then there is no 0-DCJ, and in this case there must be at least one +1-DCJ. In all runs, we set α = 0.95, β = 0.04, γ = 0.01. See text for details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Rearrangement sampling via DCJ</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">MCMC diagnosis</head><p>Theorem 3 in Appendix B provides an upper bound on the number of chains which are necessary to guarantee an intensive exchange of states between the Markov chains. In practice, we used a significantly lower number of chains, only 10 parallel chains. Also, we used a different temperature scaling than the theoretical one in the Theorem 3. The inverse of the temperature for the k-th chain was set to 1</p><formula>T k = k 2 ×s (8)</formula><p>where s was set to 0.01 for the two yeast analyses and both to 0.01 and 0.04 in several runs of mammalian analyses. In this way, the temperature of the 0 index chain was set to infinity, and the coldest chain's temperature was set to 1 or 0.25. The empirical swap probabilities for the mammalian analysis are shown on<ref type="figure" target="#fig_2">Figure 1</ref>. Although the swap probabilities between high temperature chains were relatively small, there was still a reasonable swap frequency, providing hundreds of swaps in a 200 000 step long MCMC run. While this setup for the temperatures and number of chains provided reasonable mixing of the chains, we cannot say by any mean that these protocols are optimal. In general, the smaller the difference between neighbour chains, the higher the acceptance probability of accepting a swap between two chains; furthermore, the smaller the temperature of the coldest chain, the higher the fraction of HP scenarios in it. However, a smaller coldest temperature as well as smaller differences between the temperatures of neighbour chains call for a larger number of chains, hence increased computational time to perform one in-chain step on all chains. Furthermore, the increased number of chains also increases the hitting time of the coldest chain from the hotter chain (in terms of accepted swaps). We opted for the quadratic function in Equation (8) because according to our experience, the acceptance probabilities of swapping two chains decrease more with the temperature gap at high temperatures. The heuristic explanation for this is that the energy function varies more at high temperatures, and thus, c in Lemma 5 takes high values more frequently than at low temperatures. To show that the state swaps indeed influence all Markov chains, we calculated how many MCMC steps were needed to have a given number of chains whose state was at least once in the hottest chain during the MCMC run (<ref type="figure" target="#fig_3">Fig. 2</ref>). As expected, the number of necessary steps is smaller when the temperature difference is smaller. Similar results were obtained for the yeast analysis (data not shown).Among these samples, we found thousands of HP scenarios ranging from 1957 till 3354 in the mammalian analyses, and above 3000, ranging up to 4736 samples in the yeast analyses, showing that the higher indexed chains were cold enough to have HP scenarios in their target distributions with non-negligible probabilities. The minimum were taken on one of the runs with s = 0.01, showing that the HP scenarios are less frequent at high temperature. We also would like to mention that the hottest chains almost never sampled HP scenarios, the empirical frequency of HP scenarios in the hottest chain is &lt;0.0003. This shows that it is computationally inefficient to sample DCJ scenarios and restrict the samples to HP scenarios. Tempering is needed to sample HP scenarios frequently. MCMC runs on each input data were repeated at least three times with different random seeds, and the convergence was also checked by comparing the samples from different runs (see, e.g.<ref type="figure" target="#fig_5">Fig. 3</ref>). showing the empirical distribution of parameter r estimated from two different runs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Biological data analysis</head><p>We tested the MCMC sampler on two datasets. One is the comparison of the yeast Saccharomyces cerevisiae with its ancestral genome pre-dating the whole-genome duplication that occurred in that lineage 100 million years ago. This dataset was manuallyanalysed by<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>using parsimony principles and it is interesting to compare their results with the automatic method. The other one is a human mouse genome comparison, which is interesting for two purposes. The first is a possibility of comparing the modes of structural evolution in different lineages, i.e. in yeast versus mammals. The second arises from a debate on the computation of the breakpoint reuse rate, which is sometimes computed independently from any scenario (<ref type="bibr" target="#b25">Pevzner and Tesler, 2003</ref>) or from an ad hoc parsimonious scenario (<ref type="bibr" target="#b1">Bergeron et al., 2008</ref>), and has very different values according to the method, which drives opposite biological conclusions. Sampling among scenarios allows the computation of a mean breakpoint reuse. For the yeast genome, we used as 'genes' the markers constructed by Gavranovic and Tannier (2010) using a double synteny principle. These markers cover 97% of the genes used by<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>, from which we take the ancestral pre-duplication configuration [the ancestral genomes vary only by one DCJ (a non reciprocal translocation) from one method to the other].<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>estimated the number of rearrangements from the ancestor to S.cerevisiae to be 73 inversions, 66 reciprocal translocations and 5 non-reciprocal translocations. Our results are summarized in<ref type="figure" target="#tab_2">Table 2</ref>. The ratio of reversals/translocations is lower than in<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>(0.66 versus 1.03), confirming the propensity of yeasts to evolve mainly by translocations. This is also confirmed by the comparison of the same ancestral configuration to the non-duplicated genome Lachancea kluyveri, where the ratio is about 24% [the manual study of<ref type="bibr" target="#b10">Gordon et al. (2009)</ref>was limited to the scenario in the S.cerevisiae branch]. In contrast, for mammalian genomes, we used the Pecan alignment coordinates from the release 58 of the Ensembl-Compara database (<ref type="bibr" target="#b24">Paten et al., 2008</ref>), retrieving the seeds that were present in the Human, Macaca, Mouse, Rat, Dog, Horse, Cow and Opossum genomes. By joining consecutive alignments and discarding the groups covering &lt;100 kb in at least one species, we obtained 915 universal orthology blocks covering ∼70% of the chosen mammalian genomes. We used the euarchontoglire (human–mouse ancestor) ancestral genome reconstruction using the method of<ref type="bibr" target="#b5">Chauve and Tannier (2008)</ref>, and compared its organization with the extant genomes. The results, reported on<ref type="figure" target="#tab_2">Table 2</ref>for human and mouse, show that the modes of evolution are very different from yeast ones, and even can be very different among lineages.The presence of fusions and fissions contrasts with the evolution of</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I.Miklós and E.Tannier</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Rearrangement sampling via DCJ</head><p>We introduced a promising approach for inferring genome rearrangement evolution. The previous best method (<ref type="bibr" target="#b19">Miklós and Darling, 2009</ref>) was able to sample only from the uniform distribution of all most parsimonious reversal scenarios. Our new method provides a radically different approach that can sample also from the Bayesian distribution of all possible reversal scenarios. The MCMC we constructed has a theoretical ground; however, Theorems 2 and 3 work for more particular types of data than the MCMC itself, as they are limited to unichromosomal co-tailed hurdle-free genomes, and parsimonious scenarios. However, we conjecture they are true for a more general case, if not the most general one in which the MCMC stands. This new method also has the potential to be extended to multiple genome rearrangements. So far, no efficient method is available for the Bayesian inferring of genome rearrangement phylogenies. BADGER, the best method available for Bayesian rearrangement phylogenies (<ref type="bibr" target="#b15">Larget et al., 2005</ref>) needs tens of millions of MCMC steps to converge on moderate data containing less than 80 syntheny blocks (<ref type="bibr" target="#b6">Darling et al., 2008</ref>). We conjecture that the torpid mixing of BADGER is caused by the bottlenecks in the state space discovered by<ref type="bibr" target="#b21">Miklós et al. (2010</ref><ref type="bibr" target="#b21">). As Miklós et al. (2010</ref>already realized, the usual parallel tempering that heats up the distribution towards suboptimal scenarios cannot eliminate these bottlenecks. The new heating protocol introduced in this article, which heats the distribution towards DCJ scenarios can eliminate these bottlenecks.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX A</head><p>In this appendix, we prove in a particular case that all local minima on the energy surface defined by the sum of the number of circular chromosomes along a DCJ path are global minima. We conjecture the same result for the general case (multichromosomal genomes).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.1. Unichromosomal hurdle-free co-tailed genomes</head><p>A unichromosomal genome is a genome with only one chromosome. A couple of genomes is said to be co-tailed if they share the same telomeres. The DCJ distance between two unichromosomal linear co-tailed genomes is n−(c(,)+1). On unichromosomal linear genomes, DCJs are either reversals, or fusions or fissions of chromosomes involving at least one circular chromosome. A fission of a chromosome into two, immediately followed by the fusion of these two chromosomes (with different points of fusions) is called a blockinterchange. A-edge (respectively-edge) of the breakpoint graph of two genomes and is said to be oriented if it joins two gene heads or two gene tails. It is unoriented if it joins a head and a tail. A cycle is said to be oriented if it has an oriented edge.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Page: 3018 3012–3019</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I.Miklós and E.Tannier</head><p>Two cycles A,B of a breakpoint graph of unichromosomal co-tailed genomes and are said to cross if the minimal path of G containing the extremities of A also contains extremities from B, and vice-versa. The interleaving graph of two genomes and is the graph whose vertex set is the set of cycles of the breakpoint graph, and two cycles are linked by an edge if they cross. A component of and is the set of genes extremities of the cycles of a connected component of the interleaving graph of and if this set has cardinality at least 4. A component is said to be oriented if at least one edge of a cycle of the component has an oriented edge. It is unoriented otherwise. and are hurdle-free if they have no unoriented component. The following two results are corollaries of the Hannenhalli–Pevzner theorem (<ref type="bibr" target="#b12">Hannenhalli and Pevzner, 1999</ref>).The number of different DCJ scenarios between two hurdle-free co-tailed unichromosomal genomes and can be easily computed, while computing the number of DCJ scenarios containing only reversals, as well as only reversals and block-interchanges, are open problems.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Result 1. For two hurdle-free co-tailed unichromosomal genomes and</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.2. The theorem</head><p>For a DCJ scenario S between genomes and , denoted by S(i) the DCJ at the i-th position on S.</p><formula>Let S i = /S(1)/.../S(i) for 0 ≤ i ≤ d DCJ ( S 0 = and S d DCJ = ). For two scenarios S 1 and S 2</formula><p>, we define d(S 1 ,S 2 ) as the smallest integer d such that there exists k verifying:</p><formula>For all i ∈[k,k +d −1], S 1 (i) = S 2 (i).</formula><p>In other words, d(S 1 ,S 2 ) ≤ d if it is possible to replace d consecutive DCJs of S 1 , by d other DCJs to obtain S 2. For a genome , let circ() be the number of circular chromosomes of .</p><formula>Let c(S) = k i=0 circ( S i</formula><p>) be the score of the scenario S. For any DCJ scenario S between two unichromosomal co-tailed genomes, c(S) ≥ 0 and S is a scenario of reversals if and only if c(S) = 0.</p><formula>sequence S 1 S 2 ...S k of DCJ scenarios, such that @BULLET for all i, d(S i ,S i+1 ) ≤ 3 and c(S i ) ≥ c(S i+1 );</formula><p>@BULLET S k is a reversal scenario.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A.3. Proof of Theorem 2</head><p>Let</p><formula>S 1 = ρ 1 ...ρ k</formula><p>be a scenario between unichromosomal co-tailed hurdlefree genomes and such that c(S 1 ) &gt; 0. We prove that there always exists a finite sequence</p><formula>S 1 S 2 ...S l such that c(S l ) &lt; c(S 1 ) and for all i, d(S i ,S i+1 ) ≤ 3 and c(S i ) ≥ c(S i+1</formula><p>). This proves the theorem. A DCJ scenario that is not a reversal scenario contains fissions and fusions. If in a DCJ scenario every fission is immediately followed by a fusion, then we say it is a reversal/block-interchange scenario. The first step of our proof shows that any DCJ scenario can be transformed into a scenario of this type. The second step of the proof shows that this can further be transformed into a reversal scenario.By hypothesis on ρ q , ρ q−1 involves either only gene extremities from G 1 or only gene extremities from G 2. Suppose w.l.o.g. that it is G 1. If ρ q and ρ q−1 commute, let ρ q−1 = ρ q and ρ q = ρ q−1. If they do not commute, denote ρ q−1 by ((ab,cd),(ac,bd)) and ρ q by ((ac,ef ),(ae,cf )), with a,b,c,d being gene extremities of G 1 and ef being gene extremities from G 2. Now let ρ q−1 = ((ab,ef ),(ae,bf )) and ρ q = ((cd,bf ),(bd,cf )). In both cases, the scenario</p><formula>S 2 = ρ 1 ...ρ q−2 ρ q−1 ρ q ρ q+1 ...ρ n</formula><p>is composed of valid DCJ operations, we trivially have d(S 1 ,S 2 ) ≤ 2 and we also have c(</p><formula>S 2 ) ≤ c(S 1 ) because</formula><p>@BULLET For all i = q−1,</p><formula>S 1 i = S 2 i ;</formula><p>@BULLET Clearly , |circ()−circ(/ρ)|≤1 for any genome and DCJ ρ, so circ(</p><formula>S 1 q−1 ) ≥ circ( S 1 q−2</formula><p>)−1; @BULLET The DCJ ρ q−1 is a chromosome fusion so circ(</p><formula>S 2 q−1 ) = circ( S 2 q−2 )−1, yielding circ( S 1 q−1 ) ≥ circ( S 2 q−1 ).</formula><p>Now in S 2 , ρ q−1 is the first DCJ after ρ p which involves gene extremities both from G 1 and G 2. Applying this transformation again to S 2 decreases the index q of the first DCJ after ρ p which involves gene extremities both from G 1 and G 2. We may apply the same transformation until q = p+1, which means that ρ p ρ p+1 is a block interchange. Applying the same transformation to every ρ p fission which is the first DCJ of a non-block-interchange type eventually gives a reversal/blockinterchange scenario.Note that in that case the number of circular chromosomes in a scenario — its score—is also the number of block interchanges. So the goal will be to get progressively rid of all block interchanges and arrive at a reversal scenario. First, if for a block interchange ρ p ρ p+1 (both operations are DCJs), the genomes S p−1 and S p+1 have an oriented component, then ρ p ρ p+1 can easily be replaced by two reversals, as a direct consequence of Result 1. Doing this yields a scenario which is distant from the initial one of at most two, and the number of circular chromosomes is deceased by one, proving the theorem. So we may assume that all block interchanges ρ p ρ p+1 are unoriented, which means the breakpoint graph of S p−1 and S p+1 has only unoriented components. Let now ρ r and ρ b be a reversal and a block interchange in the scenario S. We note − the genome before the application of the first event among ρ r and ρ b , and + the genome after the application of the last one. We say that ρ r and ρ b cross if the minimal path on G − between the gene extremities used by ρ r contains extremities used by ρ b , vice-versa, exchanging ρ r and ρ b. It is easy to see that if they are consecutive and do not cross, then they commute and swapping their position yields a scenario which is distant of 3 from the original one, and has the same score (the reversal stays a reversal, the block interchange stays a block interchange). Choose now ρ r and ρ b which cross, and such that there are as few DCJs as possible between them in S. These exist because else the reversals and block interchange would act on different components, which is not possible because there is no unoriented component. From now we assume that ρ r is before ρ b , but a symmetric reasoning yields the proof for the opposite case. Suppose there are rearrangements between ρ r and ρ b. If among those rearrangements, there is a reversal which is immediately before a block interchange, then by hypothesis on ρ r and ρ b , they do not cross. So it is possible to swap them without changing the score of the scenario, nor the crossing properties of any pair or reversal and block interchange. Iteratively, applying this allows to assume that all reversals occur after all block interchanges between ρ r and ρ b .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Page: 3019 3012–3019</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Rearrangement sampling via DCJ</head><p>Now ρ r occurs before a block interchange, and if it is not ρ b , then they do not cross. So it is possible to swap them. This has the effect of applying a block interchange to −. As this block interchange does not cross any reversal applied before ρ b , it cannot change the crossing properties of reversals and block interchanges, so it is possible to repeatedly apply this procedure while there are block interchanges between ρ r and ρ b , there are only reversals left. In the same way, as ρ b occurs after a reversal, if it is not ρ r then they do not cross and it is possible to swap them without changing the crossing properties of reversals and block interchanges. After repeating this procedure there are no rearrangement anymore between ρ r and ρ b and they are immediately consecutive. The following lemma yields the theorem in that case.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX B</head><p>In this appendix, we prove the following theorem, showing that with a nonnegligible probability, the MCMC can diversify efficiently in the solution space of HP scenarios:</p><formula>π i (R(,)) ∝ e − c(R(,)) T i (9)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>can be defined with the following properties:</head><p>@BULLET The temperature of the first chain is infinite, @BULLET The swapping probability between any two consecutive chains given by Equation</p><p>(7) is at least 1 2 , @BULLET The probability of a HP scenario in the target distribution of the k-th chain is at least 1 2 .</p><p>The first property provides that all most parsimonious DCJ scenarios are equally probable in the target distribution of the first chain. We proved (Miklós,I. and Tannier,E., manuscript in preparation) that it is easy to sample from this distribution with Markov chains, and if the genomes are co-tailed, exact sampling is also possible (<ref type="bibr" target="#b23">Ouangraoua and Bergeron, 2010</ref>). The second property provides that the information change between the parallel chains is not negligible. The third property provides that a few samples from the k-th chain is sufficient to get HP scenarios. Although these together do not prove fast mixing of our method, it is definitely takes us closer to a final proof. The theorem is proved using the following lemmas. Lemma 2. For any most parsimonious DCJ scenario S between and ,</p><formula>c(S) ≤ n(n−2) 4 (10)</formula><p>Proof. Since and are linear, circ() = circ() = 0. |circ( )− circ(/ρ)|≤1 for any genome , thus c(S) is maximal, if the number of circles increases till the middle of the path, and then decreases. Since the maximum length of the path is n−1, Equation (10) immediately holds.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lemma 3. The number of most parsimonious DCJ scenarios between and is at most (4n 2 −n) n−1 .</head><p>Proof. n genes have 2n extremities, forming at most 2n telomeres and adjacencies. There are at most two DCJs acting on a given pair of telomeres and/or adjacencies, having an upper bound of 2 2n 2 DCJs acting on a pair of telomers/adjacencies. Above these, there are fissions involving one adjacency. The number of them is at most n, thus the number of DCJs applicable for a genome with n genes cannot be more than 4n 2 −n. The length of a most parsimonious DCJ scenario is at most n−1, thus the number of most parsimonious DCJ scenarios is a most (4n 2 −n) n−1 .</p><p>The following lemma sets the largest temperature we need.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lemma 4. If the inverse of the temperature of the Markov chain is greater</head><p>than (n−1)log(4n 2 −n), then the probability of the HP scenarios is at least 1 2 in the target distribution. Proof. c(S) is at least 1 for any non-HP path, thus the probability of any non-HP path is at least (4n 2 −n) n−1 times smaller than that of a HP path. Since there are less than (4n 2 −n) n−1 times more non-HP paths than HP paths, the probability of the HP paths in the target distribution is at least 1 2 .</p><p>The following lemma tells what difference between the temperature of neighbour chains is necessary for a swapping probability greater or equal than 1 2 .</p><p>Lemma 5. If the difference between the inverse temperatures is 4log2 n(n−2) , then the swapping probability given by<ref type="bibr">Equation (7)</ref>is at least 1 2. Proof. Let c denote the difference between c(R i ) and c(R i+1 ) and let</p><formula>T denote 1 T i+1 − 1 T i</formula><p>. Equation (7) can be simplified as min 1,e −cT</p><formula>(11)</formula><p>Since c is at most n(n−2) 4 , the swapping probability is at least 1 2 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.1. Proof of Theorem 3</head><p>We set the temperature of the first chain to infinite, as prescribed, and the temperature of the i+1 st chain as</p><formula>T i+1 := 1 4log2 n(n−2) + 1 T i (12)</formula><p>The swapping probability between two chains will be at least 1 2 , based on Lemma 5. The chain with index, and thus, the probability of the HP scenarios in its target distribution is at least 1 2 .</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[12:30 18/11/2010 Bioinformatics-btq574.tex] Page: 3013 3012–3019</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>[12:30 18/11/2010 Bioinformatics-btq574.tex] Page: 3015 3012–3019</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.1.</head><figDesc>Fig. 1. The frequency of swapping the states between chains i and i+1 in the MCMC run. The lower indexed chain is the hotter chain.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.2.</head><figDesc>Fig. 2. The invasion of the hottest chain. See text for more details. Each MCMC run took 200 000 MCMC steps, each chain was sampled after each 200 steps, making 1000 samples for each chain. Among these samples, we found thousands of HP scenarios ranging from 1957 till 3354 in the mammalian analyses, and above 3000, ranging up to 4736 samples in the yeast analyses, showing that the higher indexed chains were cold enough to have HP scenarios in their target distributions with non-negligible probabilities. The minimum were taken on one of the runs with s = 0.01, showing that the HP scenarios are less frequent at high temperature. We also would like to mention that the hottest chains almost never sampled HP scenarios, the empirical frequency of HP scenarios in the hottest chain is &lt;0.0003. This shows that it is computationally inefficient to sample DCJ scenarios and restrict the samples to HP scenarios. Tempering is needed to sample HP scenarios frequently. MCMC runs on each input data were repeated at least three times with different random seeds, and the convergence was also checked by comparing the samples from different runs (see, e.g. Fig. 3). showing the empirical distribution of parameter r estimated from two different runs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.3.</head><figDesc>Fig. 3. The empirical distribution of the parameter r estimated from two different MCMC runs (dashed line: s = 0.01, straight line: k = 0.01) on the euarchontoglire-human data.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>[12:</head><figDesc>30 18/11/2010 Bioinformatics-btq574.tex] Page: 3017 3012–3019</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><figDesc>Case 2: the scenario S 1 is a reversal/block-interchange scenario.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Probabilities for the sampling strategy</figDesc><table>There are 
Sampling 

−1-DCJs 
0-DCJs 
+1-DCJs 
−1-DCJs 
0-DCJs 
+1-DCJs 

Yes 
Yes 
Yes 
α 
β 
γ 

Yes 
Yes 
No 
α 
β +γ 
0.0 
Yes 
No 
Yes 
α 
0.00 
β +γ 

Yes 
No 
No 
1.00 
0.00 
0.00 
No 
No 
Yes 
0.00 
0.00 
1.00 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 2. Mean numbers of rearrangements according to their types: fusion, fission, reciprocal translocation, non-reciprocal (telomeric) translocation and reversals.</figDesc><table>Fus. 
Fis. 
Rec. Transl. Transl. 
Rev. 

Yeast anc. → Scerevisiae 
0 
0 
86.5 
6.7 
61.3 
Yeast anc. → Skluyveri 
0 
0 
66.9 
5.2 
17.6 
Euarch anc. → Human 
3.3 
0.3 
7.8 
10.9 
61.5 
Euarch anc. → Mouse 
6.6 
0.6 
112.9 
53.4 
34.5 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>, there is a DCJ scenario of size d DCJ (,) which contains only reversals. Result 2. In any DCJ scenario between two co-tailed unichromosomal genomes and of size d DCJ (,), there is no reversal involving gene extremities of an unoriented component.</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="false"><figDesc>Theorem 2. For two hurdle-free co-tailed unichromosomal genomes and , let S 1 be a DCJ scenario transforming into. There exists a finite</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5" validated="false"><figDesc>Case 1: not all fission is immediately followed by a fusion. Let ρ p be the first (with minimum p) such fission in S 1. So S 1 p−1 is a unichromosomal genome. The DCJ ρ p fissions the unique chromosome of S 1 p−1 into two chromosomes C 1 and C 2. Let G 1 (respectively G 2 ) be the set of gene extremities in C 1 (respectively C 2 ). Now let ρ q be the first DCJ after ρ p in S 1 which involves gene extremities both from G 1 and G 2 .</figDesc><table>It exists as 
is unichromosomal, and by hypothesis q &gt; p+1. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6" validated="false"><figDesc>Proof. By Result 2 the component of − and + containing the gene extremities involved in ρ r and ρ b is oriented since there is a scenario with a reversal transforming − into +. So by Result 1, there are three reversals transforming − into + , which proves the result.</figDesc><table>Lemma 1. In a scenario S, let ρ r and ρ b be, respectively, a reversal and a 

block interchange that are consecutive (in any order) and crossing. Then it 
is possible to replace them by three reversals in S. 

</table></figure>

			<note place="foot">© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">yeast species, even if the ratio between the two is biased because of a reconstruction of an ancestral genome with 27 contiguous ancestral regions, which are probably fused into 23 or 24 proto-chromosomes in reality. The reversal/translocation ratio is surprisingly variable, the human lineage evolving mainly by reversals, whereas in mouse, as in yeasts, reciprocal translocations are the dominant mechanism. If we count one break for a fission, one for a translocation and two for reversals and reciprocal translocations, we arrive at a breakpoint reuse rate of 1.46 for the human branch, and 1.59 for the mouse branch. Such a rate, which can have consequences on the construction of models of structural evolution, cannot be analysed on its own, its significance depends on the sizes of the chromosomal regions affected by the rearrangement breakages, thus on the properties of the constructed orthology blocks. Such an analysis is beyond the scope of this article, which nevertheless provides a way to have a good estimation of this value. 5 DISCUSSION The estimation of rates of different rearrangements, as well as the breakpoint reuse rate, are important to devise a model of genome structural evolution, just like the estimation of a substitution matrix is necessary to use a model of nucleotide or amino acid sequence evolution. Up to now, most models are limited to one kind of rearrangements, or provide only parsimonious solutions, giving an equal probability to any kind of event. The analysis of rearrangements for distant species is thus rarely possible. We arrived at estimations of the ratio of different kinds of rearrangements, showing that fusions and fissions are usual modes of evolution in mammalian genomes, but not in yeasts. Reversals are also much more frequent in mammals, compared with translocations. However, non-reciprocal translocations, called telomeric translocations in Gordon et al. (2009), are quite frequent in both taxa. The significance of the breakpoint reuse rate for refuting or not the Random Breakage Model is beyond the scope of this study, which can however propose a solution to the problem of its computation. These observations of different rates for different types of rearrangements, or the possible preferential usage of some breakpoints might be included as parameters in a more general model in a future work. We could also use this kind of work to test the hypothesis that non-HP DCJ, with or without immediate reincorporation of circular chromosomes, are indeed rare or irrelevant, by sampling from low but non-zero temperature, and compute the probabilities of the inferred scenarios. We leave this large debate to a future work.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors thank Wei Xu, Krister Swenson, Haris Gavranovic, Renaud Lenne and Jens Lagergren for fruitful discussions. The anonymous referees are thanked for their constructive criticisms.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A unifying view of genome rearrangements</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bergeron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lect. Notes Comput. Sci</title>
		<imprint>
			<biblScope unit="volume">4175</biblScope>
			<biblScope unit="page" from="163" to="173" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">On computing the breakpoint reuse rate in rearrangement scenarios</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bergeron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lect. Notes Comput. Sci</title>
		<imprint>
			<biblScope unit="volume">5267</biblScope>
			<biblScope unit="page" from="226" to="240" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">A new linear time algorithm to compute the genomic distance via the double cut and join distance</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bergeron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Theor. Comput. Sci</title>
		<imprint>
			<biblScope unit="volume">410</biblScope>
			<biblScope unit="page" from="5300" to="5316" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Exploring the solution space of sorting by reversals with experiments and an application to evolution</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">D V</forename>
				<surname>Braga</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE-ACM Trans. Comput. Biol. Bioinform</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="348" to="356" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Counting all DCJ sorting scenarios</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">D</forename>
				<surname>Braga</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Stoye</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lect. Notes Comput. Sci</title>
		<imprint>
			<biblScope unit="volume">5817</biblScope>
			<biblScope unit="page" from="36" to="47" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A methodological framework for the reconstruction of contiguous regions of ancestral genomes and its application to mammalian genomes</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Chauve</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Tannier</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="1097" to="1112" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Dynamics of genome rearrangement in bacterial populations</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Darling</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Bayesian estimation of genomic distance</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durrett</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">166</biblScope>
			<biblScope unit="page" from="621" to="629" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Guided genome halving: provably optimal solutions provide good insights into the preduplication ancestral genome of</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Gavranovic</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Tannier</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Saccharomyces cerevisiae Proc. PSB</title>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page" from="21" to="30" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Markov Chain Monte Carlo Maximum Likelihood</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">J</forename>
				<surname>Geyer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computing Science and Statistics: Proceedings of the 23rd Symposium on the Interface, Interface Foundation of North America Inc</title>
		<editor>Keramidas,E.M. and Selma,S.M.</editor>
		<meeting><address><addrLine>Fairfax Station, VA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1991" />
			<biblScope unit="page" from="156" to="163" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Additions, losses, and rearrangements on the evolutionary route from a reconstructed ancestor to the modern Saccharomyces cerevisiae genome</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">L</forename>
				<surname>Gordon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">1000485</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Transforming men into mice (polynomial algorithm for genomic distance problem)</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Hannenhalli</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of 36th Annual Symposium on Foundations of Computer Science (FOCS&apos;95)</title>
		<meeting>36th Annual Symposium on Foundations of Computer Science (FOCS&apos;95)<address><addrLine>Los Alamitos, CA, USA</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society Press</publisher>
			<date type="published" when="1995" />
			<biblScope unit="page" from="581" to="592" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Transforming cabbage into Turnip: polynomial algorithm for sorting signed permutations by reversals</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Hannenhalli</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. ACM</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="1" to="27" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Monte Carlo sampling methods using Markov chains and their applications</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">K</forename>
				<surname>Hastings</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrica</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="page" from="97" to="109" />
			<date type="published" when="1950" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Bayesian phylogenetic inference from animal mitochondrial genome arrangements</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Larget</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. R. Stat. Soc. B</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="page" from="681" to="695" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">A Bayesian analysis of metazoan mitochondrial genome arrangements</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Larget</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="485" to="495" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<monogr>
		<title level="m" type="main">Monte Carlo Strategies in Scientific Computing</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">S</forename>
				<surname>Liu</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2001" />
			<publisher>Cambridge University Press</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Equations of state calculations by fast computing machines</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Metropolis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1087" to="1091" />
			<date type="published" when="1953" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">MCMC genome rearrangement</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Miklós</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="130" to="137" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Efficient sampling of parsimonious inversion histories with application to genome rearrangement in Yersinia</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Miklós</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Darling</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="153" to="164" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">A &apos;long indel&apos; model for evolutionary sequence alignment</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Miklós</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="529" to="540" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">The metropolized partial importance sampling MCMC mixes slowly on minimum reversal rearrangement paths</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Miklós</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Comput. Biol. Bioinformatics</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2010" />
			<publisher>ACM</publisher>
		</imprint>
	</monogr>
	<note>to. appear. Available at</note>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Parking functions, labeled trees and DCJ sorting scenarios</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ouangraoua</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bergeron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lect. Notes Comput. Sci</title>
		<imprint>
			<biblScope unit="volume">5817</biblScope>
			<biblScope unit="page" from="24" to="35" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Combinatorial structure of genome rearrangements scenarios</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ouangraoua</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bergeron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="1129" to="1144" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Enredo and pecan: genome-wide mammalian consistency-based multiple alignment with paralogs</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Paten</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1814" to="1828" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Human and mouse genomic sequences reveal extensive breakpoint reuse in mammalian evolution</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Tesler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="page" from="7672" to="7677" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">The DNA sequence of the human X chromosome</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">T</forename>
				<surname>Ross</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">434</biblScope>
			<biblScope unit="page" from="325" to="337" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">The homologies of chromosome elements in the genus Drosophila</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">H</forename>
				<surname>Sturtevant</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Novitski</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="517" to="541" />
			<date type="published" when="1941" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Efficient sorting of genomic permutations by translocation, inversion and block interchange</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Yancopoulos</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="3340" to="3346" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>