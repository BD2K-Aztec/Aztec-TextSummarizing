
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:52+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Read-based phasing of related individuals</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Shilpa</forename>
								<surname>Garg</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Bioinformatics</orgName>
								<orgName type="institution">Saarland University</orgName>
								<address>
									<addrLine>Saarbrü cken</addrLine>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Max Planck Institute for Informatics</orgName>
								<address>
									<addrLine>Saarbrü cken</addrLine>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Saarbrü cken Graduate School of Computer Science</orgName>
								<orgName type="institution">Saarland University</orgName>
								<address>
									<addrLine>Saarbrü cken</addrLine>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Introduction</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Marcel</forename>
								<surname>Martin</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">Department of Biochemistry and Biophysics</orgName>
								<orgName type="laboratory">Science for Life Laboratory</orgName>
								<orgName type="institution">Stockholm University</orgName>
								<address>
									<postCode>SE-17121</postCode>
									<settlement>Solna</settlement>
									<country key="SE">Sweden</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Tobias</forename>
								<surname>Marschall</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Bioinformatics</orgName>
								<orgName type="institution">Saarland University</orgName>
								<address>
									<addrLine>Saarbrü cken</addrLine>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Max Planck Institute for Informatics</orgName>
								<address>
									<addrLine>Saarbrü cken</addrLine>
									<settlement>Germany</settlement>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Introduction</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Read-based phasing of related individuals</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw276</idno>
					<note>*To whom correspondence should be addressed. Contact: t.marschall@mpi-inf.mpg.de</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Read-based phasing deduces the haplotypes of an individual from sequencing reads that cover multiple variants, while genetic phasing takes only genotypes as input and applies the rules of Mendelian inheritance to infer haplotypes within a pedigree of individuals. Combining both into an approach that uses these two independent sources of information—reads and pedi-gree—has the potential to deliver results better than each individually. Results: We provide a theoretical framework combining read-based phasing with genetic haplotyp-ing, and describe a fixed-parameter algorithm and its implementation for finding an optimal solution. We show that leveraging reads of related individuals jointly in this way yields more phased variants and at a higher accuracy than when phased separately, both in simulated and real data. Coverages as low as 2Â for each member of a trio yield haplotypes that are as accurate as when analyzed separately at 15Â coverage per individual. Availability and Implementation: https://bitbucket.org/whatshap/whatshap</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Humans are diploid and determining the sequences of both homologous copies of each chromosome is desirable for many reasons. These two sequences per chromosome are known as haplotypes. The process of obtaining them is known as haplotyping or phasing, two terms that we will use interchangeably. Haplotype-resolved genetic data can be used, for instance, for population genetic analyses of admixture, migration and selection, but also to study allele-specific gene regulation, compound heterozygosity and their roles in human disease. We refer the reader to<ref type="bibr" target="#b25">Tewhey et al. (2011) and</ref><ref type="bibr" target="#b9">Glusman et al. (2014)</ref>for detailed reviews on the relevance of haplotyping. General Approaches for Haplotyping. There are three major approaches to phasing. First, haplotypes can be inferred from genotype information of large cohorts based on the idea that common ancestry gives rise to shared haplotype tracts, as reviewed by<ref type="bibr" target="#b1">Browning and Browning (2011)</ref>. This approach is known as statistical or population-based phasing. It can be applied to unrelated individuals and only requires genotype data, which can be measured at low cost. While very powerful for common variants, this technique is less accurate for phasing rare variants and cannot be applied at all to private or de novo variants. Second, haplotypes can be determined based on genotype data of related individuals, known as genetic haplotyping (<ref type="bibr" target="#b9">Glusman et al., 2014</ref>). To solve the phasing problem, one seeks to explain the observed genotypes under the constraints imposed by the Mendelian laws of inheritance, while being parsimonious in terms of recombination events. For larger pedigrees, such as parents with many children, this approach yields highly accurate phasings (<ref type="bibr" target="#b22">Roach et al., 2011</ref>). On the other hand, it is less accurate for single mother-father-child trios and has the intrinsic limitation of not being able to phase variants that are heterozygous in all individuals. Third, the sequences of the two haplotypes can be determined experimentally, called molecular haplotyping. Many techniques do not resolve the full-length haplotypes but yield blocks of varying sizes. Approaches furthermore largely differ in the amount of work, DNA and money they require. On one end of the scale, next-generation sequencing (NGS) instruments generate local phase information of the length of a sequenced fragment at everdecreasing costs. Another approach consists in breaking both homologous chromosomes into (larger) fragments and separating them into a number of pools such that each pool is unlikely to contain fragments from the same locus of both haplotypes. This can, for instance, be achieved by dilution followed by bar-coded short-read sequencing. To achieve molecular haplotyping over the range of a full chromosome, protocols have been invented to physically separate the two homologous chromosomes, for example by microscopybased chromosome isolation, fluorescence-activated sorting, or microfluidics-based sorting. These and other experimental techniques for molecular haplotyping have been surveyed by Snyder</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i234</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com<ref type="bibr">Bioinformatics, 32, 2016</ref>, i234–i242 doi: 10.1093/bioinformatics/btw276<ref type="bibr">ISMB 2016</ref><ref type="bibr">ISMB et al. (2015</ref>. They are of great interest because they facilitate phasing of rare variants for single individuals. Rare variants have been postulated to contribute considerably to clinical traits and are hence of major interest. Haplotype Assembly. When many haplotype fragments are available for one individual, for instance from sequencing, one can attempt to reconstruct the full haplotypes or at least to obtain larger blocks. This process is known as haplotype assembly, single-individual haplotyping, or read-based phasing (in case the fragments indeed stem from sequencing reads). It requires reads that span two or more heterozygous variants. In order to be successful, reads covering as many pairs of consecutive heterozygous variants as possible are desirable. At present, third generation sequencing platforms, as marketed by Pacific Biosciences (PacBio) and Oxford Nanopore, become more widespread and offer reads spanning thousands to tens of thousands of nucleotides. Although error-rates are much higher than for common second generation technologies, the longer reads provide substantially more phase information and hence render them promising platforms for read-based phasing. We adapt the common assumption that all variants to be phased are bi-allelic and non-overlapping. Then, the input to the haplotype assembly problem can be specified by a matrix with entries from f0; 1; Àg, having one row per read and one column per variant. Entries of 0 or 1 indicate that the read in that row gives evidence for the reference or alternative allele for the variant in that column, respectively. An entry of '–' signifies that a variant is not covered by that read. In case all reads are error-free and mapped to correct positions, the set of rows in that matrix admits a bipartition such that each of the two partitions is conflict free. Here, two rows are defined to be conflicting if they exhibit different non-dash values in the same column; that is, one entry is 0 and the other one is 1. If such a bipartition exists, the matrix is called feasible. To formalize the haplotype assembly problem in the face of errors, we define operations on the input matrix and ask for the minimum number of operations one needs to apply to render it feasible. Different such operations have been studied, in particular removal of rows, resulting in the Minimum Fragment Removal (MFR) problem, removal of columns, resulting in the Minimum SNP Removal (MSR) problem, and flipping of bits, resulting in the Minimum Error Correction (MEC) problem. All three problems are NP-hard (<ref type="bibr" target="#b4">Cilibrasi et al., 2007;</ref><ref type="bibr" target="#b13">Lancia et al., 2001</ref>). Flipping of bits corresponds to correcting sequencing errors and hence the MEC problem has received most attention in the literature and is most relevant in practice. A wealth of exact and heuristic approaches to solve the MEC problem exists. Exact approaches, which solve the problem optimally, include integer linear programming (<ref type="bibr" target="#b3">Chen et al., 2013b;</ref><ref type="bibr" target="#b8">Fouilhoux and Mahjoub, 2012</ref>), and fixed-parameter tractable (FPT) algorithms (<ref type="bibr" target="#b11">He et al., 2010;</ref><ref type="bibr" target="#b19">Patterson et al., 2015;</ref><ref type="bibr" target="#b20">Pirola et al., 2015</ref>). Refer to the reviews by Schwartz (2010) and<ref type="bibr" target="#b21">Rhee et al. (2015)</ref>for further related approaches. Here, we build upon our previous approach WhatsHap (<ref type="bibr" target="#b18">Patterson et al., 2014</ref><ref type="bibr" target="#b19">Patterson et al., , 2015</ref>) and generalize it to jointly handle sequencing reads of related individuals. WhatsHap is an FPT approach that solves the (weighted) MEC problem optimally in time exponential in the maximum coverage, but linear in the number of variants. In particular the runtime does not explicitly depend on the read length. These properties make it particularly apt for current long-read data. This has also been observed by<ref type="bibr" target="#b12">Kuleshov (2014)</ref>, who approached the weighted MEC problem in a message-passing framework and, by doing so, independently arrived at the same DP algorithm used in WhatsHap. The exponential runtime in the maximum coverage does not constitute a problem in practice because reads can be removed in regions of excess coverage without loosing much information. The evaluation by<ref type="bibr" target="#b19">Patterson et al. (2015)</ref>suggests that pruning data to a maximum coverage of 15Â yields excellent results while an even higher coverage does not deliver a big additional improvement. Hybrid Approaches. The ideas underlying population-based phasing, genetic haplotyping, and read-based phasing have been combined in many ways to create hybrid methods.<ref type="bibr" target="#b5">Delaneau et al. (2013)</ref>, for instance, use local phase information provided by sequencing reads to enhance their population-based phasing approach SHAPEIT. Exploiting pedigree information for statistical phasing has also been demonstrated to significantly improve the inferred haplotypes (<ref type="bibr" target="#b2">Chen et al., 2013a;</ref><ref type="bibr" target="#b15">Marchini et al., 2006</ref>). Using their heuristic read-based phasing approach HapCompass, Aguiar and Istrail (2013) note that combining reads from parentoffspring duos increases performance in regions that are identical by descent (IBD). Beyond this approach, we are not aware of prior work to leverage family information towards read-based phasing. Contributions. Here, we introduce a unifying formal framework to fully integrate read-based and genetic haplotyping. To this end, we define the Weighted Minimum Error Correction on Pedigrees Problem, termed PedMEC, which generalizes the (weighted) MEC problem and accounts for Mendelian inheritance and recombination. This problem is NP-hard. We generalize the WhatsHap algorithm for solving this problem optimally and thereby show that PedMEC is fixed-parameter tractable. When the maximum coverage is bounded, the runtime of our algorithm is linear in the number of variants and does not explicitly depend on the read length, hence inheriting the favorable properties of WhatsHap. We target an application scenario where related individuals are sequenced using error-prone long-read technologies such as PacBio sequencing. As a driving question motivating this research, we ask how much coverage is needed for resolving haplotypes in related individuals as opposed to single or unrelated individuals. Our focus is on phasing and we do not consider the genotyping step, which can either be done from the same data or from orthogonal and potentially cheaper data sources such as microarrays or short-read sequencing. On simulated and real PacBio data, we show that sequencing each individual in a mother-father-child trio to 5Â coverage is sufficient to establish a high-quality phasing. This is in stark contrast to state-of-the-art single-individual read-based phasing, which yields worse results even for 15Â coverage with respect to both error rates and numbers of phased variants. We furthermore demonstrate that our technique also exhibits favorable properties of genetic haplotyping approaches: Because of genotype relationships between related individuals, we are able to infer correct phases even between haplotype blocks that are not connected by any sequencing reads in any of the individuals. Example.<ref type="figure" target="#fig_2">Figure 1</ref>shows seven SNP positions covered by reads in three related individuals. It illustrates how the ideas of genetic and read-based haplotyping complement each other. All genotypes at SNP 3 are heterozygous. Thus, its phasing cannot be inferred by genetic phasing, that is, using only the given genotypes and not the reads. SNP 4, in contrast, is not covered by any read in the child. When only using reads in the child (corresponding to single-individual read-based phasing), no inference can be made about the phase of SNP 4 and neither about the phase between SNP 3 and SNP 5. By observing that all seven child genotypes are compatible with the combination of brown and green haplotypes from the parents, however, these phases can be easily inferred. This example demonstrates that jointly using pedigree information, genotypes and sequencing reads is very powerful for establishing phase information.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Read-based phasing of related individuals i235 problem on pedigrees</head><p>Thus far, read-based phasing has predominantly been formulated as the Minimum Error Correction (MEC) problem (<ref type="bibr" target="#b4">Cilibrasi et al., 2007</ref>) and its weighted sibling wMEC (<ref type="bibr" target="#b10">Greenberg et al., 2004</ref>). We first re-state these problems formally to introduce our notation and then proceed to generalizing them to pedigrees. The input to the MEC problem consists of a SNP matrix F 2 f0; 1; Àg RÂM , where R is the number of reads and M is the number of variants along a chromosome. Each matrix entry F ðj; kÞ is 0 (indicating that the read matches the reference allele) or 1 (indicating that the read matches the alternative allele) if the read covers that position and '–' otherwise. Note that the '–' character can also be used to encode the unsequenced 'internal segment' of a pairedend read.(Feasibility) A SNP matrix F 2 f0; 1; Àg RÂM is called feasible if there exists a bi-partition of rows (i.e. reads) into two sets such that all pairwise distances of two rows within the same set are zero. Feasibility of a matrix F is equivalent with the existence of two haplotypes h 0 ; h 1 2 f0; 1g M such that every read r in the matrix has a distance of zero to h 0 or to h 1 (or both). The MEC problem can now simply be stated in terms of flipping bits in F , where entries that are 0 or 1 can be flipped and '–' entries are fixed. PROBLEM 1:</p><p>(MEC) Given a matrix F 2 f0; 1; Àg RÂM , flip a minimum number of entries in F to obtain a feasible matrix.</p><p>The MEC problem is NP-hard (<ref type="bibr" target="#b4">Cilibrasi et al., 2007</ref>). The weighted version of the problem associates a cost to every matrix entry. This is useful since each nucleotide in a sequencing read usually comes with a 'phred-scaled' base quality Q that corresponds to an estimated probability of 10 ÀQ=10 that this base has been wrongly sequenced. These phred scores can hence serve as costs of flipping a letter, allowing less confident base calls to be corrected at lower cost compared to high confidence ones. PROBLEM 2:</p><p>(wMEC) Given a matrix F 2 f0; 1; Àg RÂM and a weight matrix W 2 N RÂM , flip entries in F to obtain a feasible matrix, while minimizing the sum of incurred costs, where flipping entry F ðj; kÞ incurs a cost of Wðj; kÞ</p><p>We now generalize wMEC to account for multiple individuals in a pedigree simultaneously while modeling inheritance and recombination. An overview of notation we use is provided in<ref type="figure" target="#tab_1">Table 1</ref>. We assume our pedigree to contain a set of N individuals I ¼ f1;. .. ; Ng. Relationships between individuals are given as a set of (ordered) mother-father-child triples T. For example, if I ¼ f1; 2; 3; 4g, then T ¼ fð1; 2; 3Þ; ð1; 2; 4Þg corresponds to a pedigree where individuals 1 and 2 are the parents of individuals 3 and 4. We only consider non-degenerate cases without circular relationships and where each individual appears as a child in at most one triple. Furthermore, we assume all considered variants to be nonoverlapping and bi-allelic. Each individual i comes with a genotype vector g i 2 f0; 1; 2g M , giving the genotypes of all M variants. Genotypes 0, 1 and 2 correspond to being homozygous in the reference allele, heterozygous and homozygous in the alternative allele, respectively. In the context of phasing, we can restrict ourselves to the set of variants that are heterozygous in at least one of the individuals, that is, to variants k such that g i ðkÞ ¼ 1 for at least one individual i 2 I. For each individual i 2 I, a number of R i aligned sequencing reads is provided as input, giving rise to one SNP matrix F i 2 f0; 1; Àg RiÂM and one weight matrix W i 2 N RiÂM per individual. We seek to compute two haplotypes h 0 i ; h 1 i 2 f0; 1g M for all individuals i 2 I. As before in the MEC problem, we want these haplotypes to be consistent with the sequencing reads.MotherIn addition, we want the haplotypes to respect the constraints given by the pedigree. Recall that in each parent, the two homologous chromosomes recombine during meiosis to give rise to a haploid gamete that is passed on to the offspring. Therefore, each haplotype of a child should be representable as a mosaic of the two haplotypes of the respective parent with few recombination events. To control the number of recombination events, we assume a persite recombination cost of XðkÞ to be provided as input. Controlling the recombination cost per site is important because recombination is not equally likely to happen at all points along a chromosome. Instead, recombination hotspots exist, where recombination is much more likely to occur (and should hence be penalized less strongly in our model). The cost XðkÞ should be interpreted as the (phredscaled) probability that a recombination event occurs between variant k – 1 and variant k. To formalize the inheritance process, we define transmission vectors t m!c ; t f !c 2 f0; 1g M for each triple ðm; f ; cÞ 2 T. The values t m!c ðkÞ and t f !c ðkÞ tell which allele at site k is transmitted by mother and father, respectively. The haplotypes we seek to compute have to be compatible with transmission vectors, defined formally as follows.With this notion of transmission vectors, recombination events are characterized by changes in the transmission vector, that is, by positions k with t m!c ðk À 1Þ 6 ¼ t m!c ðkÞ or t f !c ðk À 1Þ 6 ¼ t f !c ðkÞ. Given our recombination cost vector X , the cost associated to a transmission vector can be written as follows (in slight abuse of notation).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Child</head><formula>0/0 0/0 1 / 0 0 / 0 0 / 0 1 / 0 1 / 0 0/1 0/1 0/1 0/1 1 / 1 1 / 0 1 / 0 Father</formula><formula>DEFINITION 4:</formula><p>(Transmission cost) For a transmission vector t p!c 2 f0; 1g M with p 2 fm; f g and a recombination cost vector X 2 N M , the cost of t p!c is defined as</p><formula>Xðt p!c Þ :¼ X M k¼2 ·t p!c ðk À 1Þ 6 ¼ t p!c ðkÞ‚ Á XðkÞ;</formula><p>where ·S‚ ¼ 1 if statement S is true and 0 otherwise.</p><p>To state the problem of jointly phasing all individuals in I formally, it is instrumental to consider the set of matrix entries to be flipped explicitly. We will therefore introduce a set of index pairs E i &amp; f1;. .. ; R i g Â f1;. .. ; Mg where ðj; kÞ 2 E i if and only if the bit in row j and column k of matrix F i is to be flipped.Note that for the special case of I ¼ f1g and T ¼ 1, PedMEC is identical to wMEC. Therefore, the PedMEC problem is also NPhard. As discussed in Section 1, we are specifically interested in an application scenario where the genotypes are already known. By using genotype data, we aim to most beneficially combine the merits of genetic haplotyping and read-based haplotyping. We therefore extend the PedMEC problem to incorporate genotypes and term the resulting problem PedMEC-G.</p><formula>PROBLEM 4:</formula><p>(PedMEC with genotypes, PedMEC-G) Let the same input be given as for Problem 3 (PedMEC) and, additionally, a genotype vector g i 2 f0; 1; 2g M for each individual i 2 I. Solve the PedMEC problem under the additional constraints that h 0 i þ h 1 i ¼ g i for all i 2 I, where 'þ' refers to a component-wise addition of vectors.</p><p>For the classical MEC problem, additionally assuming that all sites to be phased are heterozygous is common (<ref type="bibr" target="#b3">Chen et al., 2013b</ref>). This variant of the MEC problem is a special case of PedMEC-G with I ¼ f1g and T ¼ 1 and g 1 ðkÞ ¼ 1 for all k.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Algorithm</head><p>Solving MEC and wMEC. WhatsHap (<ref type="bibr" target="#b19">Patterson et al., 2015</ref>) is a dynamic programming (DP) algorithm to optimally solve the wMEC problem. It runs in Oð2 c Á MÞ time, where M is the number of variants to be phased and c is the maximum physical coverage (which includes internal segments of paired-end reads). The general idea is to proceed column-wise from left to right while maintaining a set of active reads. Each read remains active from its first non-dash position to its last non-dash position in F. Let the set of active reads in column k be denoted by A(k). Note that c ¼ max k fjAðkÞjg. For each column k of F , we fill a DP table column Cðk; ÁÞ with 2 jAðkÞj entries, one entry for each bipartition B of the set of active reads A(k). Each entry C(k, B) is equal to the cost of solving wMEC on the partial matrix consisting of columns 1 to k of F under the assumption that the sought bipartition of the full read set Að1Þ [. .. [ AðkÞ extends B according to the below definition.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Read-based phasing of related individuals i237</head><p>As before, we consider all bipartitions of A(k) for each column k, but now additionally distinguish between all possible transmission values. We assume the set of trio relationships T to be (arbitrarily) ordered and use a tuple t 2 f0; 1g 2jT j to specify an assignment of transmission values. Such an assignment t can later (during backtracing) be translated into the sought transmission vectors: Assuming t to be an optimal such tuple at column k, its relation to the transmission vectors is given by t ¼ ðt m1!c1 ðkÞ; t f1!c1 ðkÞ; t m2!c2 ðkÞ; t f2!c2 ðkÞ; .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. .Þ:</head><p>The transmission tuples give rise to one additional dimension of our DP table for PedMEC(-G), as compared to the DP table for wMEC. For each column k, we compute table entries(2015), we first describe how to compute the cost incurred by flipping matrix entries in each column, denoted by D C ðk; B; tÞ, and then explain how to combine them with entries in Cðk À 1; Á; ÁÞ to compute the cost Cðk; B; tÞ. The crucial point for dealing with reads from multiple individuals in a pedigree is to realize that matrix entries from haplotypes that are identical by descent (IBD) need to be identical (or need to be flipped to achieve this). For unrelated individuals (i.e. T ¼ 1), none of the haplotypes are IBD, giving rise to 2jI j sets of reads for the 2jI j unrelated haplotypes. These 2jI j sets of reads are given by B and the cost D C ðk; B; tÞ can be computed by flipping all matrix entries of reads within the same set to the same value. For a non-empty T , the transmission tuple t tells which parent haplotypes are passed on to which child. In other words, t identifies each child haplotype to be IBD to a specific parent haplotype. We can therefore merge the corresponding sets of reads since all reads coming from haplotypes that are IBD need to show the same allele and need to be flipped accordingly. In total, we obtain 2jI j À 2jT j sets of reads, since each trio relationship implies merging two pairs of sets. We write Sðk; B; tÞ to denote this set of sets of reads induced by bipartition B and transmission tuple t in column k. The cost W a k;S of flipping all entries in a read set S 2 Sðk; B; tÞ to the same allele a 2 f0; 1g is given by</p><formula>W a k;S ¼ X ði;jÞ2S ·F i ðj; kÞ 6 ¼ a‚ Á W i ðj; kÞ;</formula><p>where we identify reads in S by a tuple (i, j), telling that it came from individual i and corresponds to row j in F i. For PedMEC, i.e. if no constraints on genotypes are present, every set S can potentially be flipped to any allele a 2 f0; 1g. Hence, the cost is given bythat is, we minimize the sum of costs incurred by each set of reads S 2 Sðk; B; tÞ over all possible assignments of alleles to read sets. For PedMEC-G, this minimization is constrained to only consider allele assignments consistent with the given genotypes. To ensure that valid assignments exist, we assume the input genotypes to be free of Mendelian conflicts. Computing a Column of Local Costs. To compute the whole column D C ðk; Á; ÁÞ, we proceed as follows. In an outer loop, we enumerate all 2 2jT j values of the transmission tuple t. For each value of t, we perform the following steps: We start with bi-partition B ¼ ðAðkÞ; 1Þ and compute all W a k;S for all sets S 2 Sðk; B; tÞ and all a 2 f0; 1g, which can be done in OðjAðkÞj þ jI jÞ time. Next we enumerate all bipartitions in Gray code order, as done previously (<ref type="bibr" target="#b19">Patterson et al., 2015</ref>). This ensures that only one read is moved from one set to another in each step, facilitating constant time updates of the values W a k;S. The value of D C ðk; B; tÞ is then computed from the W a k;S 's according to<ref type="bibr">Equation</ref>where BðAðkÞÞ denotes the set of all bipartitions of A(k) and d H is the Hamming distance. The distance d H ðt; t 0 Þ hence gives the number of changes in transmission vectors and thus the term d H ðt; t 0 Þ Á Xðk þ 1Þ gives the recombination cost to be added.Runtime. Computing one column of local costs, D C ðk; Á; ÁÞ, takes Oð2 2jT j Á ð2 jAðkÞj þ 2 2jI j Á jI jÞÞ time, as discussed above. For each entry, we use Equation (4) to compute the aggregate value of cost incurred in present and past columns. Over all columns, we achieve a runtime of OðM Á ð2 2jT jþcþjIj jI j þ 2 4jT jþc ÞÞ, where c ¼ max k fjAðkÞjg is the maximum coverage. Backtracing. An optimal bipartition and transmission vectors can be obtained by recording the indexes of the table entries that gave rise to the minima in Equations (4) and (3) when filling the DP table and then backtracing starting from the optimal value in the last column. Optimal haplotypes are subsequently obtained using the bipartition and transmission vectors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Experimental setup</head><p>To evaluate the performance of our approach, we considered both real and simulated datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Real data</head><p>The Genome in a Bottle Consortium (GIAB) has characterized seven individuals extensively using eleven different technologies (<ref type="bibr" target="#b26">Zook et al., 2014</ref>). The data is publicly available. Here we consider the Ashkenazim trio, consisting of three related individuals: NA24143 (mother), NA24149 (father) and NA24385 (son). We obtained a consensus genotype call set (NIST_CallsIn2Technologies_ 05182015) provided by GIAB, containing variants called by two independent technologies. For our benchmark, we consider all biallelic SNPs on Chromosome 1 called in all three individuals, amounting to 141 256 in total, and use the provided (unphased) genotypes. Ground Truth via Statistical Phasing. To generate a ground truth phasing for comparison, we used the population-based phasing tool SHAPEITv2-r837 (<ref type="bibr" target="#b6">Delaneau et al., 2014</ref>) with default parameters. The program was given the 1000 Genomes reference panel (https:// mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.tgz), the corresponding genetic map (http://www.shapeit.fr/files/genetic_map_b37. tar.gz), and the unphased genotypes as input. SNPs present in the GIAB call set but absent in the reference panel were discarded, resulting in 140 744 phased SNPs, of which 58 551 were heterozygous in mother, 57 152 in father and 48 023 in child. We refer to this set of phased SNPs as ground truth phased variants. We emphasize that this phasing is solely based on genotypes and does not use phase information present in the reads in any way and hence is completely independent. In the following, we refer to the original genotypes from the GIAB call set (without phase information) restricted to this set of SNPs as ground truth unphased genotypes, which we use as input for read-based phasing experiments described below. PacBio Data. For each individual, we downloaded aligned Pacific Biosciences (PacBio) reads (ftp://ftp-trace.ncbi.nlm.nih.gov/ giab/ftp/data/AshkenazimTrio/(HG002_NA24385_sonjHG003_NA 24149_fatherjHG004_NA24143_mother)/PacBio_MtSinai_NIST/ MtSinai_blasr_bam_GRCh37/), which had an average coverage of 42.3Â in mother, 46.8Â in father and 60.2Â in child, respectively. The average mapped read length across mother was 8328 bp, father was 8471 bp and child was 8687 bp. For each individual, we separately downsampled the aligned reads to obtain datasets of 2Â, 3Â, 4Â, 5Â, 10Â and 15Â average coverage. 10XGenomics Data. The GemCode platform marketed by 10XGenomics uses a barcoding technique followed by pooled shortread sequencing and data analysis through a proprietary software solution to resolve haplotypes. Data from this platform is available from the GIAB project and represents phase information obtained completely independently from either statistical phasing or PacBio reads. We downloaded the corresponding files (ftp://ftp-trace. ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/(HG002_NA24385_ sonjHG003_NA24149_fatherjHG004_NA24143_mother)/10XGe nomics) for comparison purposes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Simulated data</head><p>Despite the high-quality dataset provided by GIAB, we sought to complement our experiments by a simulated dataset. While the population-based phasing we use as ground truth is arguably accurate due to a large reference panel and the high-quality genotype data used as input, it is not perfect. Especially variants with low allele frequency present challenges for population-based phasers. Virtual Child. As basis for our simulation, we use the haplotypes of the two parents from our ground truth phased dataset. We generated two haplotypes of a virtual child by applying recombination and Mendelian inheritance to the four parent haplotypes. In reality, recombination events are rare: All of Chromosome 1 spans a genetic distance of approximately 292 cM, corresponding to 2.9 expected recombination events along the whole chromosome. To include more recombinations in our simulated dataset, we used the same genetic map as above, but multiplied recombination rates by 10. The recombination sites are sampled according to the probabilities resulting from applying Haldane's mapping function to the genetic distances between two variants. In line with our expectation, we obtained 26 and 29 recombination sites for mother and father, respectively. The resulting child had 41 676 heterozygous variants. Simulating PacBio Reads. We aimed to simulate reads that mimic the characteristics of the real PacBio dataset as closely as possible. For this simulation, we incorporate the variants of each individual into the reference genome (hg19) to generate two true haplotypes for each individual in our triple. We used the PacBiospecific read simulator pbsim by<ref type="bibr" target="#b17">Ono et al. (2013)</ref>to generate a 30Â dataset for Chromosome 1. The original GIAB reads were provided to pgsim as a template (via option-sample-fastq) to generate artificial reads with the same length profile. Next, we aligned the reads to the reference genome using BWA-MEM 0.7.12-r1039 by<ref type="bibr" target="#b14">Li (2013)</ref>with option-x pacbio. As before for the real data, the aligned reads for each individual were downsampled separately to obtain datasets of 2Â, 3Â, 4Â, 5Â, 10Â and 15Â average coverage.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Compared methods</head><p>Our main goal is to analyze the merits of the PedMEC-G model in comparison to wMEC; in particular with respect to the coverage needed to generate a high-quality phasing. The algorithms to solve wMEC and PedMEC-G described in Section 3 have been implemented in the WhatsHap software package (https://bitbucket.org/ whatshap/whatshap), distributed as Open Source software under the terms of the MIT license. We emphasize that WhatsHap solves wMEC and PedMEC-G optimally. Since the focus of this paper is on comparing these two models, we do not include other methods for single-individual haplotyping. We are not aware of other trioaware read-based phasing approaches that PedMEC-G could be compared to additionally. The runtime depends exponentially on the maximum coverage. Therefore we prune the input datasets to a target maximum coverage using the read-selection method introduced by<ref type="bibr" target="#b7">Fischer and Marschall (2016)</ref>, which is implemented as part of WhatsHap. This target coverage constitutes the only parameter of our method. For PedMEC-G, we prune the maximum coverage to 5Â for each Read-based phasing of related individuals i239 individual separately. For wMEC, we report results for 5Â and 15Â target coverage. The respective experiments are referred to as PedMEC-G-5, wMEC-5 and wMEC-15. For wMEC, we use the additional 'all heterozygous' assumption (see Section 3), to also give it the advantage of being able to 'trust' the genotypes, as is the case for PedMEC-G. Both wMEC and PedMEC-G were provided with the ground truth unphased genotypes for the respective dataset. PedMEC-G was additionally provided with the respective genetic map (original 1000G genetic map for real data and scaled by factor 10 for simulated data). As described above, the ground truth phasing was generated by SHAPEIT with default parameters, implying that SHAPEIT treated the three samples as unrelated individuals. For comparison purposes, we re-ran SHAPEIT and provided it with pedigree information. We refer to the resulting phased dataset as SHAPEIT-trio. Moreover, we ran duoHMM (v0.1.7) by O'<ref type="bibr">Connell et al. (2014)</ref>on the resulting files to further improve the phasing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Performance metrics</head><p>We compare each phased individual to the respective ground truth haplotypes separately and only consider sites heterozygous in this individual. Phased SNPs. For read-based phasing of a single individual (wMEC), we say that two heterozygous SNPs are directly connected if there exists a read covering both. We compute the connected components in the graph where SNPs are nodes and edges are drawn between directly connected SNPs. Each connected component is called a block. For read-based phasing of a trio (PedMEC), we draw an edge when two SNPs are connected by a read in any of the three individuals. In both cases, we count a SNP as being phased when it is not the left-most SNP in its block (for the left-most SNP, no phase information with respect to its predecessors exists). All other SNPs are counted as unphased. Below, we report the average fraction of unphased SNPs over all three family members. Phasing Error Rate. For each block, the first predicted haplotype is expressed as a mosaic of the two true haplotypes, minimizing the number of switches. This minimum is known as the number of switch errors. Note that the second predicted haplotype is exactly the complement of the first one, due to only considering heterozygous sites. When two switch errors are adjacent, they are subtracted from the number of switch errors and counted as one flip error. The phasing error rate is defined as the sum of switch and flip errors divided by the number of phased SNPs. Three-Way Phasing Comparison. To simultaneously compare phasings from three different methods (e.g. SHAPEIT, 10XGenomics and PedMEC-G-5), we proceeded as follows. For an individual, we considered all pairs of consecutive heterozygous SNPs that have been phased by all three methods. For each of these pairs, either all three methods agree or two methods agree (since only two possible phases exist). Below, we discuss the fraction of these different cases in relation to the total number of considered SNP pairs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Results</head><p>We report the results of wMEC-5, wMEC-15 and PedMEC-G-5 for both datasets, real and simulated. All combinations of the three methods, two datasets and six different average coverages (2Â, 3Â, 4Â, 5Â, 10Â and 15Â) were run. The predicted phasings are compared to the ground truth phasing for the respective dataset. That is, for the real dataset, we compare to the population-based phasing produced by SHAPEIT; for the simulated dataset, we compare to the true haplotypes that gave rise to the simulated reads.<ref type="figure" target="#fig_10">Figure 2</ref>shows the fraction of unphased SNPs in comparison to the phasing error rate (see Section 4.4) for all conducted experiments. A perfect phasing would be located in the bottom left corner. The Influence of Coverage. Increasing the average coverage is beneficial for phasing. For all three methods (wMEC-5, wMEC-15 and PedMEC-G-5) and both datasets, the phasing error rate and the fraction of unphased SNPs decrease monotonically when the average coverage is increased, as is clearly visible in<ref type="figure" target="#fig_10">Figure 2</ref>. The effect is much more drastic for wMEC than for PedMEC, however. Apparently, wMEC needs more coverage to compensate for PacBio's high error rate while PedMEC can resort to exploiting family information to resolve uncertainty. The Value of Family Information. When operating on the same input coverage, PedMEC-G-5 clearly outperformed wMEC-5 and even wMEC-15 in all cases tested. This was true for phasing error rates as well as for the fraction of phased positions. On the real dataset with average coverage 10Â for instance, wMEC-5 andwMEC-15 reached an error rate of 2.9 and 1.9%, while it was 0.5% for PedMEC-G-5. Most remarkingly, PedMEC-G-5 delivers excellent results already for very low coverages. When working with an average coverage as low as 2Â for each family member, it achieves an error rate of 1.4% and a fraction of unphased SNPs of 1.8% (on real data). In contrast, wMEC-15 needs 15Â average coverage on each individual to reach similar values (1.4% error rate and 1.3% unphased SNPs). When running on 5Â data, PedMEC-G-5's error rate and fraction of unphased positions decrease to 0.75 and 0.85%, respectively. Therefore, it reaches better results while requiring only a third of the sequencing data, which translates into significantly reduced sequencing costs. Comparison of Real and Simulated Data. When comparing results for simulated and real data, i.e. top and bottom plots in<ref type="figure" target="#fig_10">Figure 2</ref>, the curves appear similar, with some important difference. In terms of the fraction of phased SNPs (y-axis), results are virtually identical. This indicates that our simulation pipeline establishes realistic conditions regarding this aspect. Differences in terms of error rates (x-axis) are larger. In general, error rates in the real data are larger than in the simulated data, which might be partly caused by a too optimistic error model during read simulation. On the other hand, the population-based phasing used as ground truth for the real dataset will most likely also contain errors. Especially lowfrequency variants present difficulties for population-based phasers. Next, we therefore compare our ground truth statistical phasing to the independent phasing provided by 10XGenomics. Three-Way Comparison with 10XGenomics.shows the results of a three-way comparison of ground truth statistical phasing, 10XGenomics, and PedMEC-G-5 on 15Â coverage data. We observe that the total fraction of cases where there is disagreement between the three methods is below 1%. Out of these, 10XGenomics and the statistical phasing agree in a sizeable fraction of cases, shown in blue. In these cases, the PacBio-based PedMEC-G-5 is likely wrong. Given PacBio's high read error rate, the existence of such cases is not surprising. On the other hand, there also is a significant fraction of cases where PedMEC-G-5 and 10XGenomics agree, shown in red, indicating likely errors in the statistical phasing. Cases where PedMEC-G-5 and the statistical phasing agree but disagree with 10XGenomics are very rare, which is likely due to the low error rates of short-read sequencing underlying the 10XGenomics phasing and the resulting highly accurate phasing. SHAPEIT-trio and duoHMM.<ref type="figure">Figure 3</ref>(right) shows the same three-way comparison, but uses the results obtained from SHAPEIT when run in trio mode. We see that this improved the phasing for the child but dramatically worsened the agreement for the parents, with more than 4% of all phased SNP pairs for which 10XGenomics and PedMEC-G-5 agreed but disagreed with SHAPEIT-trio. Running duoHMM (O'<ref type="bibr">Connell et al., 2014</ref>) to improve the SHAPEIT-trio phasing did not lead to any changes, which might be related to that duoHMM is designed to be run for large cohorts of related individuals. Phase Information beyond Block Boundaries. Genetic phasing operates on genotypes of a pedigree, without using any sequencing reads.<ref type="figure">Figure 4</ref>illustrates a case where we have two blocks that are not connected by reads in any individual. Nonetheless phase information can be inferred from the genotypes: Each block contains a SNP that is homozygous in both parents and heterozygous in the child, which immediately establishes which haplotype is maternal and which is paternal in both blocks. Note that this, in turn, also implies the phasing of the parents. By design, PedMEC-G implicitly exploits such information. To demonstrate this, we used the real dataset and merged all blocks reported by PedMEC-G into one chromosome-wide block and determined the fraction of cases where phases were correctly inferred between blocks and hence between two SNPs that are not connected by reads in any individual. This resulted in a fraction of 89.7% correctly inferred phased (averaged over all individuals and coverages; standard deviation 1.4%). Repeating the same for wMEC yielded 50.4% correctly inferred phased, as expected equalling a coin flip. Runtimes. All experiments have been run on a server with two Intel Xeon E5-2670 CPUs (10 cores each) running at 2.5 GHz. The implementation in WhatsHap is sequential, i.e. only using one CPU core. In all cases, the time spent reading the input files dominated the time spent in the phasing routine itself. Processing all three individuals of the 5Â coverage real dataset took 31.1 min, 31.2 min and 26.2 min for wMEC-5, wMEC-15 and PedMEC-G-5, respectively. This time included all I/O and further processing. Of these times, 2.0, 4.1 and 101.0 s were spent in the phasing routine, respectively. For input coverage 15Â total processing took 89.3, 93.9 and 65.4 min for wMEC-5, wMEC-15 and PedMEC-G-5, respectively. Of this, 2.5, 149.9, 321.5 s were spent in the phasing routines, respectively. We conclude that the phasing algorithm presented here is well suited for<ref type="figure">3</ref>. Three-way comparison of phasings provided by SHAPEIT, 10XGenomics and PedMEC-G-5 (on 15Â coverage data). Of all pairs of consecutive SNPs phased by all three methods, the percentages of cases where the phasing reported by one method disagrees with the other two are reported. Missing to 100%: cases where all three methods agree. Left: SHAPEIT run with default parameters, corresponding to our 'ground truth phasing'; right: SHAPEIT run with pedigree information<ref type="figure">Fig. 4</ref>. Two disjoint unconnected haplotype blocks for which phase information can be inferred from the genotypes Read-based phasing of related individuals i241 handling current datasets swiftly. In the future, we plan to further optimize the implementation of I/O subroutines and provide automatic chromosome-wise parallelization of data processing.</p><formula>Child 0/1 0/1 1/1 1/1 0/1 0/1 Mother 0/1 0/0 0 / 0 1 / 0 1 / 0 0/0 0/0 0/0 0/1 0 / 1 0 / 0 0 / 0 Father</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Discussion</head><p>We have presented a unifying framework for integrated read-based and genetic haplotyping. By generalizing the WhatsHap algorithm (<ref type="bibr" target="#b19">Patterson et al., 2015</ref>), we provide a fixed-parameter tractable method for solving the resulting NP-hard optimization problem, which we call PedMEC. When maximum coverage and number of individuals are bounded, the algorithm's runtime is linear in the number of phased variants and independent of the read length, making it well suited for current and future long-read sequencing data. This is mirrored by the fact that the runtime is dwarfed by the time required for reading the input files in practice. PedMEC can use any provided costs for correcting errors in reads as well as for recombination events. By using phred-scaled probabilities as costs, minimizing the cost can be interpreted as finding a maximum likelihood phasing in a statistical model incorporating Mendelian inheritance, read error correction and recombination. Testing the implementation on simulated and real trio data, we could show that the method is notably more accurate than phasing individuals separately, especially at low coverages. Beyond enhanced accuracy, our method is also able to phase a greater fraction of heterozygous variants compared to single-individual phasing. Being able to phase more variants is a key benefit of the integrative approach. Whereas read-based phasing can in principle only phase variants connected by a path through the covering reads, adding pedigree information enables even phasing of variants that are not covered in all individuals since the algorithm can 'fall back' to using genotype information.<ref type="figure" target="#fig_2">Figure 1</ref>illustrates the increased connectivity while phasing a trio, resulting in more phased variants in practice. Genetic haplotyping alone cannot phase variants that are heterozygous in all individuals, emphasizing the need for an integrative approach as introduced here. We demonstrate that such an approach indeed yields better result and recommend its use whenever both reads and pedigree information are available. Most remarkingly, the presented approach is able to deliver outstanding performance even for coverages as low as 2Â per individual, on par with performance delivered by single-individual haplotyping at 15Â coverage per individual. Future work. We plan to implement phasing of de novo variants observed in the child, which would be impossible with pure genetic haplotyping but is straightforward with our approach. Since runtime is exponential in the maximum physical coverage, pruning of datasets is required in practice. The read selection approach currently implemented in WhatsHap (<ref type="bibr" target="#b7">Fischer and Marschall, 2016</ref>) aims to retain reads that both cover and connect many variants at the same time, in particular for heterogeneous combinations of datasets such as paired-end or mate-pair reads together with long reads. For pedigrees, each dataset is currently pruned individually, but results would likely improve if pedigree structure was taken into account in this step. Finally, since we show that it is possible and beneficial to integrate both read-based and genetic phasing, the next obvious question is whether it is possible to modify our unified theoretical framework to one that also includes statistical phasing.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.1.</head><figDesc>Fig. 1. Seven SNP loci covered by reads (horizontal bars) in three individuals. Unphased genotypes are indicated by labels 0/0, 0/1 and 1/1. The alleles that a read supports are printed in white</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>(</head><figDesc>Weighted Minimum Error Correction on Pedigrees, PedMEC) Let a set of individuals I ¼ f1;. .. ; Ng, a set of relationships T on I , recombination costs X 2 N M , and, for each individual i 2 I, a sequencing read matrix F i 2 f0; 1; Àg RiÂM and corresponding weights W i 2 N RiÂM be given. Determine a set of matrix entries to be flipped E i &amp; f1;. .. ; R i g Â f1;. .. ; Mg to make F i feasible and two corresponding haplotypes h 0 i ; h 1 i</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>(</head><figDesc>Bipartition extension) For a given set A and a subset A 0 &amp; A, a bipartition B ¼ ðP; QÞ of A is said to extend a bipartition B 0 ¼ ðP 0 ; Q 0 Þ of A 0 if P 0 &amp; P and Q 0 &amp; Q. By this semantics of DP table entries C(k, B), the minimum of the last column min B fCðM; BÞg is the optimal wMEC cost. Algorithm Overview: Solving PedMEC and PedMEC-G. In the following, we will see how this idea can be extended for solving PedMEC and PedMEC-G. The basic idea is to use the same technique on the union of the sets of active reads across all individuals i 2 I, while adding some extra book-keeping to satisfy the additional constraints imposed by pedigree and genotypes. Let A i ðkÞ be the set of active reads in column k of F i. We now define AðkÞ ¼ [ i2I A i ðkÞ. A bipartition B ¼ ðP; QÞ of A(k) now induces bipartitions for each individual: B i ¼ ðP \ A i ðkÞ; Q \ A i ðkÞÞ.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>Cðk; B; tÞ for all 2 jAðkÞj bipartitions of reads and all 2 2jT j possible transmission tuples, for a total of 2 jAðkÞjþ2jT j entries in this column. Computing Local Costs. Along the lines of Patterson et al.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>(1)</head><figDesc>, which takes Oð2 2jI j Á jIjÞ time. Computing the whole column D C ðk; Á; ÁÞ hence takes Oð2 2jT j Áð2 jAðkÞj þ 2 2jI j Á jI jÞÞ time. DP Initialization. The first column of the DP table, Cð1; Á; ÁÞ, is initialized by setting Cð1; B; tÞ :¼ D C ð1; B; tÞ for all bipartitions B and all transmission tuples t. DP Recurrence. Recall that Cðk; B; tÞ is the cost of an optimal solution for input matrices restricted to the first k columns under the constraints that the sought bipartition extends B and that transmission happened according to t at site k. Entries in column Cðk þ 1;Á;ÁÞ should hence add up local costs incurred in column kþ1 and costs from the previous column. To adhere to the semantics of Cðk þ 1;B;tÞ, only entries in column k whose bipartitions are compatible with B are to be considered as possible 'predecessors' of Cðk þ 1;B;tÞ. DEFINITION 6: (Bipartition compatibility) Let B ¼ ðP; QÞ be a bipartition of A and B 0 ¼ ðP 0 ; Q 0 Þ be a bipartition of A 0. We say that B and B 0 are compatible, written B ' B 0 , if P \ ðA \ A 0 Þ ¼ P 0 \ ðA \ A 0 Þ and Q \ ðA \ A 0 Þ ¼ Q 0 \ ðA \ A 0 Þ. Two bipartitions are therefore compatible when they agree on the intersection of the underlying sets. Besides ensuring that bipartitions are compatible, we need to incur recombination costs in case the transmission tuple t changes from k to k þ 1. Formally, entries in column k þ 1 are given by</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><figDesc>Projection Columns. To ease computing Cðk þ 1; B; tÞ via Equation (2), we use the same technique described by Patterson et al. (2015) and define intermediate projection columns C \ ðk; Á; ÁÞ. They can be thought of as being between columns k and k þ 1. Consequently, they are concerned with bipartitions of the intersection of read sets AðkÞ \ Aðk þ 1Þ and hence contain 2 jAðkÞ\Aðkþ1Þjþ2jT j entries, which are given byAðkÞ :¼ ðP \ AðkÞ; Q \ AðkÞÞ for B ¼ ðP; QÞ. We have therefore reduced the runtime of computing this minimum to Oð2 2jT j Þ. i238 S.Garg et al.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig.2.</head><figDesc>Fig. 2. Simulated dataset (top) and real dataset (bottom): phasing error rate (x-axis) versus completeness in terms of the fraction of unphased SNPs (yaxis) for PedMEC-G-5 (solid line), wMEC-5 (dashed line) and wMEC-15 (dotted line). Average coverage (per individual) of input data is encoded by circles of different sizes</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head></head><figDesc>Figure 3(left)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Fig.</head><figDesc>Fig. 3. Three-way comparison of phasings provided by SHAPEIT, 10XGenomics and PedMEC-G-5 (on 15Â coverage data). Of all pairs of consecutive SNPs phased by all three methods, the percentages of cases where the phasing reported by one method disagrees with the other two are reported. Missing to 100%: cases where all three methods agree. Left: SHAPEIT run with default parameters, corresponding to our 'ground truth phasing'; right: SHAPEIT run with pedigree information</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2016. Published by Oxford University Press.</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 1. Overview of common notation</figDesc><table>Notation 
Meaning 
</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>2 f0; 1g M for each individual i 2 I as well as two transmission vectors t m!c ; t f !c 2 f0; 1g M for each trio ðm; f ; cÞ 2 T such that X</figDesc><table>i2I 

X 

ðj;kÞ2Ei 

W i ðj; kÞ þ 
X 

ðm;f ;cÞ2T 

Xðt m!c Þ þ Xðt f !c Þ 

takes a minimum, subject to the constraints that all haplotypes are 
compatible with the corresponding transmission vectors, if existing. 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>We thank Sarah O. Fischer for developing the read selection routine in WhatsHap.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Haplotype assembly in polyploid genomes and identical by descent shared tracts</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Aguiar</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Istrail</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="352" to="360" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Haplotype phasing: existing methods and new developments</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Browning</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">L</forename>
				<surname>Browning</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="703" to="714" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Genotype calling and haplotyping in parent-offspring trios</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="142" to="151" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Exact algorithms for haplotype assembly from whole-genome sequence data</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<forename type="middle">Z</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1938" to="1945" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The complexity of the single individual SNP haplotyping problem</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Cilibrasi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithmica</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="13" to="36" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Haplotype estimation using sequencing reads</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Delaneau</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">93</biblScope>
			<biblScope unit="page" from="687" to="696" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Integrating sequence and array data to create an improved 1000 Genomes Project haplotype reference panel</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Delaneau</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Commun</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">3934</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title level="m" type="main">Selecting reads for haplotype assembly</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">O</forename>
				<surname>Fischer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Marschall</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2016" />
			<pubPlace>Biorxiv, 046771</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Solving VLSI design and DNA sequencing problems using bipartization of graphs</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Fouilhoux</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">R</forename>
				<surname>Mahjoub</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Optim. Appl</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="page" from="749" to="781" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Whole-genome haplotyping approaches and genomic medicine</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Glusman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Med</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">73</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Opportunities for combinatorial optimization in computational biology</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">J</forename>
				<surname>Greenberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">INFORMS J. Comput</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="211" to="231" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Optimal algorithms for haplotype assembly from wholegenome sequence data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>He</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="183" to="190" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Probabilistic single-individual haplotyping</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Kuleshov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="379" to="385" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">SNPs problems, complexity, and algorithms</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Lancia</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">) Algorithms – ESA 2001, Number 2161 in Lecture Notes in Computer Science</title>
		<editor>Meyer auf der Heide,F. (ed</editor>
		<meeting><address><addrLine>Berlin, Heidelberg</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="182" to="193" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<monogr>
		<title level="m" type="main">Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv preprint</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">A comparison of phasing algorithms for trios and unrelated individuals</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Marchini</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="page" from="437" to="450" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">A general approach for haplotype phasing across the full spectrum of relatedness</title>
		<author>
			<persName>
				<forename type="first">O &apos;</forename>
				<surname>Connell</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">1004234</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">PBSIM: PacBio reads simulator–toward accurate genome assembly</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Ono</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="119" to="121" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">WhatsHap: Haplotype assembly for futuregeneration sequencing reads</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Patterson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 18th Annual International Conference on Research in Computational Molecular Biology (RECOMB), Number 8394 in Lecture Notes in Computer Science</title>
		<editor>Sharan,R.</editor>
		<meeting>the 18th Annual International Conference on Research in Computational Molecular Biology (RECOMB), Number 8394 in Lecture Notes in Computer Science</meeting>
		<imprint>
			<publisher>Springer International Publishing</publisher>
			<date type="published" when="2014" />
			<biblScope unit="page" from="237" to="249" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">WhatsHap: Weighted haplotype assembly for future-generation sequencing reads</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Patterson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="498" to="509" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">HapCol: accurate and memory-efficient haplotype assembly from long reads</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Pirola</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page">495</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Survey of computational haplotype determination methods for single individual</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">K</forename>
				<surname>Rhee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genes Genomics</title>
		<imprint>
			<biblScope unit="page" from="1" to="12" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Chromosomal haplotypes by genetic phasing of human families</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Roach</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">89</biblScope>
			<biblScope unit="page" from="382" to="397" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Theory and algorithms for the haplotype assembly problem</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Schwartz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Inf. Syst</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="23" to="38" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Haplotype-resolved genome sequencing: experimental methods and applications</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">W</forename>
				<surname>Snyder</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="344" to="358" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">The importance of phase information for human genomics</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Tewhey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="215" to="223" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">M</forename>
				<surname>Zook</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="246" to="251" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<monogr>
		<title/>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Garg</surname>
			</persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>