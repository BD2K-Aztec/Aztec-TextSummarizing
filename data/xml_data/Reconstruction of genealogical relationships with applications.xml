
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:31+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Reconstruction of genealogical relationships with applications to Phase III of HapMap</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Sofia</forename>
								<surname>Kyriazopoulou-Panagiotopoulou</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Dorna</forename>
								<surname>Kashef Haghighi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sarah</forename>
								<forename type="middle">J</forename>
								<surname>Aerni</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Biomedical Informatics Training Program</orgName>
								<orgName type="institution">Stanford University School of Medicine</orgName>
								<address>
									<postCode>94305</postCode>
									<settlement>Stanford</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Andreas</forename>
								<surname>Sundquist</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">DNAnexus, Inc</orgName>
								<address>
									<postCode>94301</postCode>
									<settlement>Palo Alto</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sivan</forename>
								<surname>Bercovici</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Serafim</forename>
								<surname>Batzoglou</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stanford University</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Reconstruction of genealogical relationships with applications to Phase III of HapMap</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="page" from="333" to="341"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr243</idno>
					<note>[20:20 6/6/2011 Bioinformatics-btr243.tex] Page: i333 i333–i341 BIOINFORMATICS</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Accurate inference of genealogical relationships between pairs of individuals is paramount in association studies, forensics and evolutionary analyses of wildlife populations. Current methods for relationship inference consider only a small set of close relationships and have limited to no power to distinguish between relationships with the same number of meioses separating the individuals under consideration (e.g. aunt–niece versus niece–aunt or first cousins versus great aunt–niece). Results: We present CARROT (ClAssification of Relationships with ROTations), a novel framework for relationship inference that leverages linkage information to differentiate between rotated relationships, that is, between relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration. We demonstrate that CARROT clearly outperforms existing methods on simulated data. We also applied CARROT on four populations from Phase III of the HapMap Project and detected previously unreported pairs of third-and fourth-degree relatives. Availability: Source code for CARROT is freely available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Algorithms for relationship inference can greatly benefit association and linkage studies by detecting undeclared or misspecified relatives, and have applications in forensics and wildlife population management. Existing methods (<ref type="bibr" target="#b6">Epstein et al., 2000;</ref><ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>) based on Hidden Markov Models (HMMs) only consider a small number of relationship types. RELPAIR (<ref type="bibr" target="#b6">Epstein et al., 2000</ref>) examines eight types of relationships (full siblings, parent–child, avuncular, grandparent– grandchild, half siblings, first cousins, monozygotic twins, and unrelated). PREST-plus (<ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>) extends this set of alternative relationships to include the relationship types half avuncular, half first cousins and half-siblings first-cousins. Algorithms for pedigree reconstruction (<ref type="bibr" target="#b3">Berger-Wolf et al., 2007;</ref><ref type="bibr" target="#b13">Koch et al., 2008;</ref><ref type="bibr" target="#b19">Riester et al., 2009</ref><ref type="bibr" target="#b20">Riester et al., , 2010</ref>) partition the individuals into sets of sibling and parent–child pairs (<ref type="bibr" target="#b4">Blouin, 2003;</ref><ref type="bibr" target="#b12">Jones and Arden, 2003</ref>) and are not designed for datasets containing distantly related individuals. Additionally, the methods mentioned above cannot differentiate between rotated * To whom correspondence should be addressed. † The authors wish it to be known that, in their opinion, the first three authors should be regarded as joint First Authors. relationships, that is, between relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration (e.g. aunt–niece versus niece–aunt or first cousins versus great aunt–niece). Distinguishing between such relationships facilitates pedigree reconstruction from relatively distant relationships. We developed CARROT (ClAssification of Relationships with ROTations), a new framework for relationship inference that leverages linkage information to differentiate between rotated relationships. As suggested by<ref type="bibr" target="#b21">Skare et al. (2009)</ref>, we grouped relationships between outbred individuals into three categories, based on whether the individuals under consideration have one or two common ancestors or whether one of them is the ancestor of the other. Building on the ideas of<ref type="bibr" target="#b22">Stankovich et al. (2005) and</ref><ref type="bibr" target="#b2">Bercovici et al. (2010)</ref>, we defined three sets of HMMs, one for each category of relationships. CARROT uses a novel heuristic to decide whether one of the two individuals under consideration is closer to the common ancestors than the other and benefits from haplotype phasing in order to distinguish between certain rotated relationships. We demonstrated that CARROT achieves higher accuracy than maximum-likelihood approaches, such as RELPAIR and PRESTplus, using simulated data. We also applied CARROT on real data from Phase III of the HapMap Project (<ref type="bibr">The International HapMap 3 Consortium, 2010</ref>). In addition to validating relationships reported by<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>, we identified previously unreported third-and fourth-degree relationships in this dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Overview of CARROT</head><p>CARROT is a framework for predicting the relationship type for a pair of individuals from their genotypes. Similarly to previous work (<ref type="bibr" target="#b6">Epstein et al., 2000;</ref><ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>), CARROT uses HMMs to compute the likelihood of the genotype data under a set of alternative relationships. Unlike existing methods, which define a different HMM for each relationship type, CARROT defines three HMM templates from which it generates HMMs for a broad range of relationships. CARROT uses the likelihoods computed by all alternative models as features of a classifier together with additional features that quantify the overall genetic sharing between the two individuals. In this work, we use the term Identity By Descent or Identical By Descent (IBD) to refer to genomic regions inherited from the Most Recent Common Ancestors (MRCAs) of the two individuals. The additional features we consider are the percentage of IBD, the number of transitions between IBD and non-IBD regions and the haplo-frequencies of the two individuals in these regions. Roughly speaking, the haplo-frequency of an individual A in a given genomic region is the</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Kyriazopoulou-Panagiotopoulou et al.</head><p>fraction of the reference population that has the same haplotype as A in that region. The use of phased data enables CARROT to assign different likelihoods to relationships that are indistinguishable by previous methods: in the case of an aunt–niece pair, for instance, segments inherited from the common ancestors can lie on either haplotype of the aunt, but must lie on the same haplotype of the niece. This haplotype model, combined with linkage information captured in the haplo-frequencies, gives CARROT a significant advantage in differentiating between rotated relationships compared with the existing methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">HMMs and factorial HMMs</head><p>A HMM is a probabilistic model for capturing the dependencies of a sequence of observations G 1 ,G 2 ,...,G M on a chain of unknown (or hidden) variables S 1 ,S 2 ,...,S M taken from a set S. An HMM makes the following conditional independence assumptions: first, given S k , G k is conditionally independent of all observations and hidden states, that is</p><formula>P(G k |S 1 ,...,S k ,G 1 ,G k−1 ) = P(G k |S k ). Second, given S k−1 , S k</formula><p>is conditionally independent of all previous hidden states, that is,</p><formula>P(S k |S 1 ,...,S k−1 ) = P(S k |S k−1</formula><p>). An HMM is, therefore, defined by a set of transition probabilities P(S k |S k−1 ), a set of emission probabilities P(G k |S k ) a probability distribution over the initial states. Often, we want to infer the value of the hidden variables from the observed variables. The posterior probability P(S i |G) can be computed using the forward–backward algorithm in time O(M|S| 2 ) (<ref type="bibr" target="#b18">Rabiner and Juang, 1986</ref>), where |S| is the number of values in S. In a factorial HMM (<ref type="bibr" target="#b8">Ghahramani and Jordan, 1997</ref>), the observation at position k depends on multiple hidden variables, S 1 k ,S 2 k ,...,S T k , which are assumed to evolve independently, that is:</p><formula>P(S k = (s 1 k ,s 2 k ,...,s T k )|S k−1 = (s 1 k−1 ,s 2 k−1 ,...,s T k−1 )) = T t=1 P(S t k = s t k |S t k−1 = s t k−1 )</formula><p>A factorial HMM where each hidden variable S t k takes values from the set S is equivalent to an HMM with hidden variables taking values from the Cartesian product S T. Using the latter representation, running the forward–backward algorithm on a factorial HMM requires O(M|S| 2T ) time. However, by taking advantage of the independence assumptions for the hidden variables, the forward–backward algorithm can be modified to run in O(MT |S| T +1 ) time, which is a significant improvement when the number of hidden variables T is large.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Likelihood computation assuming linkage equilibrium</head><p>We want to infer the relationship between two individuals A and B, genotyped at a set of</p><formula>M unlinked SNPs. Let H A0 ,H A1 ,H B0 ,H B1 ∈{A,C,G,T } M</formula><p>be the two haplotypes of A and B, respectively,</p><formula>G A = (H A0 ,H A1 ), G B = (H B0 ,H B1 )</formula><p>be their ordered, or phased, genotypes, and θ k be the probability of recombination between SNPs k and k +1. Throughout this work, we assume that θ k is the same for both sexes. Let R be a set of putative relationships for individuals A and B. For any relationship R ∈ R, we want to compute the likelihood of R, or the probability of the observed genotypes under the assumption that the true relationship between A and B is R, L R = P(G A ,G B |R). As noted in<ref type="bibr" target="#b21">Skare et al. (2009)</ref>, assuming that A and B are not inbred, their relationship must fall into exactly one of the following categories:</p><p>(1) A and B share exactly 2 MRCAs (e.g. full siblings, first cousins);</p><p>(2) A and B share exactly 1 MRCA (e.g. half siblings, half cousins); and</p><p>(3) A is the ancestor of B or vice versa.</p><p>We call relationships R 1 and R 2 rotated, if R 1 and R 2 are in the same relationship category and the total number of meioses between the twoindividuals is the same in R 1 and R 2. Alternatively, we say that R 1 is a rotation of R 2. We defined a set of HMMs for each of three relationship categories similarly to<ref type="bibr" target="#b22">Stankovich et al. (2005) and</ref><ref type="bibr" target="#b2">Bercovici et al. (2010)</ref>, who defined HMMs for cousins parameterized by the number of generations between them. Unlike these methods, the state space of our models does not increase with the number of generations of the pedigree. Below, we describe our HMMs for the first type of relationships. The models for the other two cases are derived along similar lines. Given that A and B have two MRCAs, C and D (<ref type="figure" target="#fig_0">Fig. 1</ref>), the hidden state at SNP k depends on the following binary variables:</p><p>(= 1, we will say that there were off-chain donations in the lineage of A at position k. d B (k) is defined in an analogous way for the lineage of B.</p><p>(4) p A (k) indicates which of the alleles of A, H A0 (k) or H A1 (k), comes from E gen A and is used to capture phasing errors. p B (k) is defined in an analogous way. Each of these variables refers to a different set of meioses in the pedigree, therefore they all evolve independently from each other. We thus model the process of generating the genotypes G A and G B as a factorial HMM with hidden state s(k)</p><formula>= (m C (k),m D (k),m E 1 (k), m F 1 (k),d A (k),d B (k),p A (k),p B (k)).</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i334</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Relationship reconstruction</head><formula>m C θ 2 k +(1−θ k ) 2 2θ k (1−θ k ) m E 1 1−θ k θ k d A (1−θ k ) gen A −1 gen A −1 n=1 gen A −1 n θ n k (1−θ k ) gen A −1−n / 2 gen A −1 −1 p A 1−ω ω P(i → j)</formula><p>is the probability that a variable transitions from state i at SNP k to state j at SNP k +1, gen A and gen B are the generations between the MRCAs and each of A and B (<ref type="figure" target="#fig_0">Fig. 1</ref>), θ k is the recombination probability between SNPs k and k +1; and ω is the probability of a phasing error.The transition probabilities for all the variables are shown in<ref type="figure" target="#tab_1">Table 1</ref>. We now derive the transition probabilities for d A. Let gen A be the number of generations between the MRCAs and A (<ref type="figure" target="#fig_0">Fig. 1</ref>). The number of meioses between E 2 and A is gen A −1. Assume that d A (k) = 0, that is, the allele that E 2 inherited from the MRCAs at locus k was passed down to A. Any recombination between loci k and k +1 would result in</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The transition probabilities for the variables</head><formula>d A (k +1) = 1, therefore P(d A (k +1) = 0|d A (k) = 0) = (1−θ k ) gen A −1. If d A (k) = 1</formula><p>, then there exists at least one off-chain donation in the gen A −1 meioses between E 2 and A. The probability that there are exactly n off-chain donations between E 2 and A is gen A −1 n (1/2) gen A −1. Given that there are exactly n off-chain donations at SNP k, the probability that there are no off-chain donations at SNP k +1 is θ n k (1−θ k ) gen A −1−n. Therefore:</p><formula>P(d A (k +1) = 0|d A (k) = 1) = P(d A (k +1) = 0 and d A (k) = 1) P(d A (k) = 1) = gen A −1 n=1 θ n k (1−θ k ) gen A −1−n gen A −1 n (1/2) gen A −1 1−(1/2) gen A −1 = 1 2 gen A −1 −1 gen A −1 n=1 gen A −1 n θ n k (1−θ k ) gen A −1−n</formula><p>Given s(k), we can determine the IBD status at SNP k and use population allele frequencies to compute the emission probabilities (<ref type="bibr" target="#b6">Epstein et al., 2000</ref>). To account for genotyping errors, let be the probability of a genotyping error, and f (x,y) be the probability that allele x is genotyped as y:</p><formula>f (x,y) = 1− if x = y if x = y</formula><p>Then:</p><formula>P(H A0 (k) = a,H B0 (k) = b|H A0 and H B0 are IBD) = c∈{A,C,G,T } q c f (c,a)f (c,b)</formula><p>where q c is the frequency of allele c in the reference population. The rest of the emission probabilities are adjusted in a similar way.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Relationship notation</head><p>We refer to relationship types using the notation (mrcas,gen A ,gen B ). The variable mrcas is 2 when individuals A and B share two MRCAs and 1 otherwise. Unless A is the ancestor of B or vice versa, gen A and gen B are the number of generations between the MRCA(s) and A and B, respectively. If A is the ancestor of B, then gen A is set to −1, and gen B is the number of generations between A and B. For close relationships, we prefer to use the usual verbal description, unless space is limited.<ref type="figure" target="#tab_2">Table 2</ref>shows the numerical notation for some common relationships.For all relationships with gen A = gen B , there is a corresponding symmetric relationship, for example (1, 0, −1) denotes a child–parent pair. Note that the term 'avuncular' does not specify a direction. The terms 'aunt' and 'niece' should be read as 'aunt/uncle' and 'niece/nephew', respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Incorporating linkage information</head><p>HMMs that use unlinked markers have limited power to distinguish between relationships of the same degree (<ref type="bibr" target="#b23">Sun et al., 2002</ref>). Linkage information can help disambiguate such relationships. Assume, for instance, that we want to determine whether the relationship between individuals A and B is first cousins or great aunt–niece. An IBD block between A and B implies that they inherited overlapping genomic segments from their MRCAs (<ref type="figure" target="#fig_1">Fig. 2</ref>). If A and B are first cousins, the two scenarios of<ref type="figure" target="#fig_1">Figure 2</ref>are equally likely. However, if A is closer to the MRCAs than B, then it is more likely that A inherited a larger segment from the common ancestor than B [scenario (a)], because we expect fewer recombinations between the MRCAs and A than between the MRCAs and B. Therefore, if we compare the haplotypes of A and B in a small window around the IBD transitions to the haplotypes of a reference population, we are more likely to find a match for the haplotype of A, than for the haplotype of B.</p><p>To quantify this intuition, assume that there is a transition in IBD status between SNPs k and k +1, and let H i (k −w+1..k +w) be the haplotype of individual i at positions k −w+1,k −w+2,...,k +w, that is in a window of size 2w around k. The haplo-frequency of A is defined as:</p><formula>C A = i f (H i (k −w+1..k +w),H A (k −w+1..k +w)) N (1)</formula><p>where the sum is over all haplotypes in the reference population, N is the number of such haplotypes, and f (H i (k −w+1..k +w),H A (k − w+1..k +w)) is the probability that H i (k −w+1..k +w) is genotyped asThe overlapping part of the blue haplotypes is IBD in the two individuals. The first scenario is more likely if A is closer to the MRCA than B. H A (k −w+1..k +w):</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i335</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Kyriazopoulou-Panagiotopoulou et al.</head><formula>f (H i (k −w+1..k +w),H A (k −w+1..k +w)) = k+w j=k−w+1 f (H i (j),H A (j))</formula><p>The positions of transitions in IBD status are estimated from the posterior probabilities of IBD of the HMMs using two cutoffs, c ibd and c non−ibd. Positions with posterior probability for IBD larger than c ibd are called IBD, while positions with posterior probability lower than c non−ibd are called non-IBD. If position k is IBD, position is non-IBD, and positions k +1....−1 have IBD probabilities between c ibd and c non−ibd , then we consider k −w+1...+w−1 as the transition window.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Classifying relationships</head><p>Existing methods for relationship inference (<ref type="bibr" target="#b6">Epstein et al., 2000;</ref><ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>) use HMMs to compute the likelihood of the observed genotypes under a set of alternative relationships and then select the relationship that maximizes that likelihood. As explained in Section 2.5 and demonstrated in the Section 3, the likelihoods assuming unlinked markers have limited power to distinguish between relationships of the same degree.</p><p>To overcome this problem, we used simulated data to train a multiclass discriminant analysis model with the following features:</p><p>(1) the likelihoods of all the alternative models;</p><p>(2) the total number of transitions between IBD and non-IBD;</p><p>(3) the estimate of the IBD sharing,</p><formula>k 0.5p 1 (k)+p 2 (k) /M, where p 1 (k) and p 2 (k)</formula><p>are the posterior probabilities of sharing one and two alleles IBD at SNP k, respectively, and the sum is taken over all M SNPs; and</p><p>(4) the percentage r of transitions between IBD and non-IBD in which C A &lt; C B , where C A and C B are the haplo-frequencies of A and B, respectively<ref type="bibr">[Equation 1]</ref>. As explained in Section 2.5, when A and B are equally distant from their common ancestors, r is expected to be 0.5. A value of r much larger than 0.5 indicates that C A tends to be smaller than C B , so A is more distant from the common ancestors than B. Similarly, a value of r much smaller than 0.5 indicates that B is more distant from the common ancestors than A.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.7">Simulations</head><p>Phased genotypes of 165 individuals from UT, USA, with ancestry from northern and western Europe (CEU) and 88 Tuscans (TSI) were obtained from release 2 of Phase III of the HapMap Project. Some individuals in the CEU population were connected in parent–child pairs. We removed the offspring of all these pairs and combined the remaining 113 CEU individuals with the TSI individuals. After removing SNPs with minor allele frequency smaller than 1% in the combined CEU-TSI population, we obtained a set of 1 133 686 SNPs, which we call the linked set of SNPs. SNPs in the linked set that were in linkage disequilibrium (LD) were removed using the variance inflation factor method implemented in PLINK, version 1.07, (<ref type="bibr" target="#b17">Purcell et al., 2007</ref>) to obtain an unlinked set of 79 681 SNPs. The HMMs were run on the unlinked set, while the haplo-frequencies were computed from the linked set. The 201 individuals were divided randomly into two subgroups, T sim , containing 57 CEU and 44 TSI individuals and T ref , containing 56 CEU and 44 TSI individuals. T sim was used to simulate pedigrees, while T ref was used as a reference population, to compute allele and haplotype frequencies. Only autosomes were simulated. Following Haldane's model of recombination (<ref type="bibr" target="#b9">Haldane, 1919</ref>), we set the recombination probability between SNPs k and k +1 to 1−e −2g k /2, where g k is the genetic distance between the SNPs.</p><p>Genetic maps were obtained from the HapMap Project. The genotyping error was set to 0.9%. The window w for the computation of the haplo-frequencies was set to 20, and the cutoffs, c ibd and c non−ibd , were set to 0.9 and 0.2, respectively. These values were chosen based on the accuracy of capturing the IBD transitions on a set of simulated individuals distinct from the training and testing sets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.8">Comparison with RELPAIR and PREST-plus</head><p>We compared our method to RELPAIR, version 2.0.1 (<ref type="bibr" target="#b6">Epstein et al., 2000</ref>) and PREST-plus, version 4.09 (<ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>) on simulated individuals created as described in Section 2.7. PREST-plus was run on the same 79 681 unlinked SNPs that was used to run CARROT's HMMs. RELPAIR cannot handle more than 9999 markers, so, similarly to<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>, we ran it on 5 random subsets of the unlinked SNPs of size 9961 SNPs each. Each subset was created by dividing the 79 681 SNPs into non-overlapping windows of size 8, and then randomly selecting one SNP from each window. The prediction of RELPAIR for a given pair of individuals was set to the relationship predicted in the majority of the five runs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.9">Inference of relationships in Phase III of HapMap</head><p>Phased genotypes of 83 individuals of African ancestry from the southwestern USA (ASW), 165 CEU individuals, 171 individuals of Mexican ancestry from Los Angeles, CA, USA (MXL) and 167 Yoruba individuals from Ibadan, Nigeria (YRI) were obtained from release 2 of Phase III of HapMap. We inferred relationships in each population separately, since, according to<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>there is no evidence for populationlabeling errors. For each population, we removed SNPs with minor allele frequency smaller than 1%, SNPs in LD, as well as SNPs that failed the hypothesis test of Hardy–Weinberg equilibrium [P &lt; 10 −4 , computed by PLINK, version 1.07 (<ref type="bibr" target="#b17">Purcell et al., 2007)]</ref>, and created linked and unlinked sets as described in Section 2.7. To reduce computation time, we first obtained a rough estimate of the IBD sharing by running the HMM for full siblings for all pairs in each population. Pairs with predicted IBD percentage less than 3% were removed from further consideration. This threshold was selected to exclude most of the fifth-degree relatives, since the accuracy of our method is small in such cases. It is possible that some of the fourth-degree relatives were also excluded during this process. We note, however, that the goal of this analysis was not to exhaustively identify all the relationships in the populations studied, but rather to demonstrate the applicability of our method on a real dataset. For the pairs that passed the above cutoff, we ran our HMMs for all relationships of degree up to 5, using previously reported unrelated individuals of the corresponding population to compute allele and haplotype frequencies. The phasing error parameter ω, was set to 0.1%. To infer the relationships of these pairs, we trained our classifiers on 100 pairsPage: i337 i333–i341</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i336</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Relationship reconstruction</head><p>of individuals for each relationship of degree up to 5 and 100 unrelated individuals, simulated as described in Section 2.7. We verified our predictions for the first-and second-degree relationships by comparing them with the relationships reported in HapMap and the predictions of<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>. To verify our predictions for relationships of higher degree, we detected sets of three or more individuals that were all predicted to be related to each other and examined whether our predictions for these individuals were mutually consistent. We were very conservative in our verification process, reporting newly discovered thirdand fourth-degree relationships as verified only if they had strong support from relationships of smaller degrees. Pedigrees were drawn using HaploPainter, version 1.043 (<ref type="bibr" target="#b24">Thiele and Nürnberg, 2005</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Results on simulated data</head><p>Comparison with maximum-likelihood methods: we compared CARROT with two existing methods for relationship inference, RELPAIR (<ref type="bibr" target="#b6">Epstein et al., 2000</ref>) and PREST-plus (<ref type="bibr" target="#b15">McPeek and Sun, 2000;</ref><ref type="bibr" target="#b23">Sun et al., 2002</ref>). Both these methods use HMMs similar to those defined in Section 2.3 to compute the likelihoods of a set of alternative relationships and select the relationship within the set with the maximum likelihood. RELPAIR only considers the relationships such as full siblings, parent–child, avuncular, grandparent–grandchild, half siblings, first cousins, monozygotic twins and unrelated. PREST-plus considers the relationships examined by RELPAIR as well as the relationships half avuncular, half first cousins and half-siblings-first-cousins<ref type="bibr">[see Sun et al. (2002)</ref>for the definition of that relationship]. Neither RELPAIR nor PRESTplus differentiate between rotated relationships, so for example they do not distinguish between a grandparent–grandchild pair and a grandchild–grandparent pair. We first compared CARROT, RELPAIR and PREST-plus on the set of relationships that can be handled by RELPAIR, except twins, which are not considered by CARROT. We simulated 100 pairs of phased individuals for each of the relationships full siblings, parent–child, aunt/uncle–niece/nephew, grandparent–grandchild, half siblings, first cousins and unrelated. We ran RELPAIR and PREST-plus on all pairs using the seven aforementioned alternative relationships. The performance of CARROT was assessed using 10-fold cross-validation: The simulated pairs were divided into 10 subsets each containing 10 pairs from each relationship. CARROT was trained on 9 of the subsets, that is, on 90 pairs from each relationship, and tested on the remaining subset. This process was repeated 10 times and the accuracy was averaged over the 10 runs.<ref type="figure" target="#fig_2">Figure 3</ref>shows the number of pairs that were predicted incorrectly by each method. Although all three methods achieved excellent accuracy for the first-degree relationships, CARROT clearly outperformed both RELPAIR and PREST-plus on second degree pairs, particularly on half siblings. RELPAIR and PRESTplus classified more than half (56 and 68%, respectively) of the half sibling pairs as avuncular. We note that the difference in performance between RELPAIR and PREST-plus can probably be attributed to the fact that RELPAIR was run on smaller sets of SNPs (see Section 2.8). We also compared CARROT with PREST-plus on the set of nine relationships which includes the seven relationships above as well as half avuncular and half first cousins. As shown in<ref type="figure" target="#fig_3">Figure 4</ref>, CARROT outperformed PREST-plus for most relationships as well as onaverage. The only relationship for which CARROT performed worse than PREST-plus was first cousins: 13% of the first cousins pairs were classified as half avuncular by CARROT, probably because the haplo-frequencies of these two relationships are similar. As mentioned above, RELPAIR and PREST-plus use HMMs to compute the likelihoods of a set of alternative relationships and select the relationship with the maximum likelihood. However, i337direct comparison between these methods and CARROT can only be done for a small set of relationships. To extend this comparison to additional relationships, we implemented a classifier that uses the HMMs of Section 2.3 for the likelihood computation and then selects the relationship with the maximum likelihood. This classifier can serve as a proxy for any method that maximizes the likelihood of unlinked markers. We compared the maximumlikelihood classifier with CARROT using a set of 100 simulated pairs of phased individuals for each relationship of degree up to five, including all rotated relationships. We assumed that the degree of the relationship was known, so predictions were made only within each degree. To assess whether a classification-based approach is better that a maximum-likelihood approach, we also ran CARROT using only the likelihoods as features. We observed that for relationships of degree up to two, the likelihoods are sufficient to differentiate between relationships (<ref type="figure" target="#tab_3">Table 3</ref>). For higher degrees, the likelihoods become less informative and the additional features of CARROT result in a significant increase in accuracy. Additionally, we notice that CARROT performs consistently better than the maximumlikelihood approach, even when we only use the likelihoods as features. Intuitively, the classifier can capture correlations between the likelihoods of different relationships. We observed, for instance, that when the true relationship is great grandparent–grandchild, the likelihood of the relationship great aunt/niece tends to be increased, but this effect is overlooked when we use the maximum likelihood criterion. Differentiating between rotated relationships: to evaluate the ability of CARROT to distinguish between rotations of relationships, we simulated 100 pairs of individuals for each of the possible relationships of degree up to five, including all possible rotated relationships. We first assumed that the degree of each relationship was known, and ran CARROT separately for each degree. We started by examining the ideal case of perfect phasing, so we set the probability of phasing errors, ω, to zero. We assessed CARROT's accuracy using 10-fold cross-validation, as described in the previous section: the simulated pairs were divided into 10 subsets each containing 10 pairs from each relationship. CARROT was trained on nine of the subsets and tested on the remaining subset. This process was repeated 10 times and the accuracy was averaged over all 10 runs. We defined the prediction accuracy as the number of pairs that were classified in the correct relationship.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Kyriazopoulou-Panagiotopoulou et al.</head><formula>Rel. 2,0,2 2,1,1 2,2,0 1,−1,2 1,0,1 1,1,0 1,2,−1 2,0,2 88 – – 5 5 2 – 2,1,1 – 84 1 – 7 8 – 2,2,0 – 1 88 – 2 4 5 1,−1,2 2 – – 96 1 1 – 1,0,1 – 11 – – 68 21 – 1,1,0 – 8 – – 24 68 – 1,2,−1 – – 3 – 1 1 95</formula><p>The value at row i and column j is the percentage of pairs of relationship i that were predicted to be of relationship j. (2, 0, 2): great aunt–niece; (2, 1, 1): first cousins; (2, 2, 0): great niece–aunt; (1, −1, 2): great grandparent–grandchild, (1, 0, 1): half aunt–niece; (1, 1, 0): great niece–aunt; (1, 2, −1): great grandchild–grandparent.</p><p>When run on first-and second-degree relatives, CARROT achieved perfect performance. The results for the third-and fourthdegree relationships are summarized in Tables 4 and 5, respectively. The average accuracy over all the pairs of the corresponding degree, was 83.86 and 56.89%, respectively. For the fifth-degree relationships, the average accuracy was 34.45% (full results not shown). As expected, the accuracy of our classifiers drops as the degree of the relationship increases. However, even within the same degree, some relationships are much harder to predict correctly than others. For example, the two half-avuncular relationships, (1, 0, 1) and (1, 1, 0), are hard to differentiate from each other and from first cousins, since the difference in the distance of each of the individuals from their MRCA is not enough for the haplofrequencies to distinguish them from a balanced relationship where both individuals are equally distant from the MRCAs. Similarly, although the average accuracy for the fifth-degree relationships was 34.45%, the (2, 4, 0) and (2, 0, 4) pairs were predicted correctly in 48.5% of the cases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Predictions across degrees: since</head><p>in practice the degree of the relationship is not necessarily known, we also performed cross validation on a set of 200 pairs of individuals from each of the relationships of degree up to 5, including rotated relationships, as well as 200 pairs of unrelated individuals. The average classification accuracy was 57.5%, varying widely for different degrees: all the first-degree pairs were classified correctly; the average accuracy for the second-degree pairs was 99.5%, for the third-degree pairs 76.57%, for the fourth-degree pairs 46% and for the fifth-degree pairs 23.36%. Finally, 90% of the unrelated individuals were classified correctly. We note that there was a small decrease in accuracy compared with the results of the previous section, because some of the pairs were classified in relationships of the incorrect degree, while this was never the case when only within-degree predictions were made.<ref type="figure" target="#tab_6">Table 6</ref>shows the percentage of pairs that were classified in a relationship of the correct degree for each of the degrees examined. On average, the correct degree was predicted for 89.83% of the pairs.Page: i339 i333–i341The value at row i and column j is the percentage of pairs of relationship i that were predicted to be of relationship j.The value in row i and column j is the percentage of pairs of degree i that were classified in a relationship of degree j.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Relationship reconstruction</head><p>relationships, introduced phasing errors at various rates in the range 0–1% and performed 10-fold cross-validation, as described above. We observed that, as the phasing error increased from 0% to 1%, there was an almost linear decrease in classification accuracy from 84% to 67.57%, although for phasing errors in the range 0.0–0.1%, the accuracy was almost unaffected. Current algorithms for statistical phasing of genotype data, such as BEAGLE (<ref type="bibr" target="#b5">Browning and Browning, 2007</ref>), have phasing error rates ranging between 0.05% and 6%, depending on the number of genotyped individuals and markers. Recently, however,<ref type="bibr" target="#b7">Fan et al. (2011) and</ref><ref type="bibr" target="#b26">Yang et al. (2011)</ref>proposed new experimental techniques for wholechromosome haplotyping, which promise to achieve much smaller error rates than current methods. Given these recent developments in phasing techniques, we believe that the phasing error requirements of our algorithm are realistic.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Inference of relationships in Phase III of HapMap</head><p>Phase III of the HapMap dataset contains genotypes of 1184 individuals from 11 populations in more than a million SNPs. To facilitate phasing, many of these individuals are connected in trios (two parents and an offspring) or duos (a parent and an offspring). Recently, however,of degree greater than two, to verify the novel predictions of CARROT, we identified sets of three or more related individuals and examined whether our predictions for these individuals were consistent with each other and with previously reported relationships.<ref type="figure" target="#tab_7">Table 7</ref>summarizes our findings. For each population, we report:</p><p>(1) the number of predictions that agreed with previously known relationships;</p><p>(2) the number of identified pairs for which the relationship predicted by CARROT was inconsistent with previously known relationships but the degree of the relationship was in agreement with previously known relationships;</p><p>(3) the number of identified pairs for which the degree of the predicted relationship was inconsistent with previously known relationships; and</p><p>(4) the number of identified pairs for which we could not determine whether CARROT's prediction was correct or not based on previously known relationships.</p><p>We note that there are small discrepancies between the numbers of first-and second-degree relationships that we report here and the numbers reported by<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>. These discrepancies can be partially explained by the fact that<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>used release 3 of Phase III of HapMap, while we used release 2. Additionally, unlike<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>, we did not include in our analysis individuals who failed the quality control filters during phasing. In total, we identified 23 previously unreported third-degree pairs and 44 previously unreported fourth-degree pairs.<ref type="figure">Figure 5</ref>shows one of the pedigrees we detected. This pedigree involves three families from the MXL population, M008, M010 and M012. All the depicted first-degree relationships as well as the aunt–nephew relationship between the individuals NA19660 and NA19664 have been reported previously. However, our algorithm correctly identified the first cousin pairs NA19664–NA19685 and NA19664– NA19662, therefore CARROT reconstructs this pedigree even in the absence of genotype data for the mother of NA19685 and NA19662. A list of all the previously unreported relative pairs detected by CARROT is given in the supplement.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i339</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Kyriazopoulou-Panagiotopoulou et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Relationship reconstruction</head><p>and PREST-plus on simulated data. We also applied CARROT on data from four HapMap populations, ASW, CEU, MXL and YRI, and correctly identified the vast majority of the first-and seconddegree relatives recently detected by<ref type="bibr" target="#b16">Pemberton et al. (2010)</ref>. Additionally, CARROT detected 67 previously unreported third-and fourth-degree relative pairs. A possible shortcoming of CARROT stems from its current reliance on phased data. However, state of the art statistical methods for phasing achieve phasing errors smaller than 1% (<ref type="bibr" target="#b5">Browning and Browning, 2007;</ref><ref type="bibr" target="#b10">Howie et al., 2009</ref>) when large cohorts and dense SNP panels are used. Additionally, novel experimental phasing techniques have achieved haplotyping of whole chromosomes with accuracy of 99.8% (<ref type="bibr" target="#b7">Fan et al., 2011;</ref><ref type="bibr" target="#b26">Yang et al., 2011</ref>). Methods for detecting genealogical relationships and for disambiguating between rotated relationships can facilitate pedigree reconstruction from cohorts such as the HapMap and WTCCC (Wellcome Trust Case Control<ref type="bibr">Consortium, 2007</ref>) datasets, where most individuals are not expected to be closely related. Existing algorithms for pedigree reconstruction that are based on the detection of parent–offspring and sibling pairs cannot be applied in such datasets. In studies such as WTCCC, that are based on the premise that the individuals in the dataset are unrelated, putative relatives are usually removed or reweighted. Knowledge of the exact pedigrees, however, allows a more informed selection of the individuals to be removed. More importantly, instead of discarding the information captured in related individuals, one can leverage the reconstructed relationships in a meta-analysis step. Combining the linkage analysis from multiple reconstructed partial pedigrees with the association analysis over the remaining unrelated individuals can potentially increase the power of such studies. CARROT was designed with such applications in mind and aims at bridging the gap between algorithms for pedigree reconstruction from close relatives and traditional relationship inference methods.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Pedigree for a pair of individuals with two common ancestors: individuals A and B share two MRCAs, C and D. There are gen A generations between the MRCAs and A (i.e. gen A +1 meioses separating them) and gen B generations between the MRCAs and B. The sex of the individuals is arbitrary.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Illustration of the IBD sharing between a pair of relatives: the horizontal lines represent two haplotypes of individuals A and B and the bold blue box is inherited from an MRCA. The overlapping part of the blue haplotypes is IBD in the two individuals. The first scenario is more likely if A is closer to the MRCA than B.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. Comparison between CARROT, RELPAIR and PREST-plus on a set of seven relationships: the height of the bars is the percentage of pairs that were classified incorrectly, so smaller bars are better. In each relationship, the leftmost bar corresponds to RELPAIR, the middle bar to PREST-plus and the rightmost bar to CARROT. Avg. is the average error over all relationships examined. (2, 0, 0): full siblings; (1, −1, 0): parent–child; (2, 0, 1): auntniece; (1, −1, 1): grandparent-grandchild; (1, 0, 0): half siblings; (2, 1, 1): first cousins, unrel: unrelated.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.4.</head><figDesc>Fig. 4. Comparison between CARROT and PREST-plus on a set of nine relationships: the height of the bars is the percentage of pairs that were classified incorrectly, so smaller bars are better. In each relationship, the left bar corresponds to PREST-plus and the right bar to CARROT. Avg. is the average error over all relationships examined. (2, 0, 0): full siblings; (1, −1, 0): parent–child; (2, 0, 1): aunt–niece; (1, −1, 1): grandparent–grandchild; (1, 0, 0): half siblings; (2, 1, 1): first cousins; (1, 0, 1): half aunt–niece; (1, 1, 1): half first cousins, unrel: unrelated.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>The effect of phasing errors: the phasing error rate is defined as the proportion of successive pairs of heterozygote SNPs that are phased incorrectly with respect to each other. To examine the effect of phasing errors on the classification accuracy of CARROT, we simulated 100 pairs of individuals for each of the third-degree i338 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [20:20 6/6/2011 Bioinformatics-btr243.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>1) m C (k) and m D (k) indicate whether C and D, respectively, passed the same allele to their immediate descendants E 1 and F 1. For example, if both E 1 and F 1 inherited the maternal allele of C at position k, then m C (k) = 1. If E 1 received the maternal allele of C, and F 1 received the paternal allele of C, then m C (k) = 0. (2) m E 1 (k) and m F 1 (k) indicate whether E 1 and F 1 passed to E 2 and F 2 , respectively, the allele of C and not the allele of D. (3) d A (k) takes the value 0 if A inherited the allele that E 2 got from E 1 (which came from either C or D) and the value 1 otherwise. That is, d A (k) = 0, if for all i &gt; 2, E i got from E i−1 the allele of E i−2 and not the allele of G i−2. If d A (k)</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 1. Transition probabilities for the HMMs with two MRCAs.</figDesc><table>Variable 
Pr(0 → 0) 
Pr(1 → 0) 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>m D , m F 1 , p B and d B are derived similarly.</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="true"><figDesc>Table 2. Numerical notation for some common relationships</figDesc><table>Degree 
Relationship 
(mrcas,gen A ,gen B ) 

Full siblings 
(2, 0, 0) 
1 
Parent–child 
(1, −1, 0) 

Half siblings 
(1, 0, 0) 
Aunt-niece 
(2, 0, 1) 
Avuncular 
(2, 0, 1) or (2, 1, 0) 
2 

Grandparent–grandchild 
(1, −1, 1) 

First cousins 
(2, 1, 1) 
Great grandparent–grandchild 
(1, −1, 2) 
Great aunt–niece 
(2, 0, 2) 
3 

Half aunt–niece 
(1, 0, 1) 

4 
Half first cousins 
(1, 1, 1) 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6" validated="true"><figDesc>Table 3. Comparison between CARROT and two other approaches for relationship inference</figDesc><table>Method/Degree 
1 
2 
3 
4 
5 

Max likelihood 
100 
98.6 
62.29 
39.33 
26.73 
CARROT likelihoods 
100 
100 
74 
43.78 
29 
CARROT 
100 
100 
84 
57.56 
34.45 

max likelihood selects the relationship with the maximum likelihood; CARROT 
likelihoods uses only the likelihoods as features for the classification. We simulated 
100 pairs of individuals from each relationship and performed predictions only within 
each degree. The number reported is the percentage of pairs classified in the correct 
relationship. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7" validated="false"><figDesc>Table 4. Classification accuracy of CARROT on third-degree relatives</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8" validated="true"><figDesc>Table 5. Classification accuracy of CARROT on fourth-degree relatives</figDesc><table>Rel. 
2,0,3 
2,1,2 
2,2,1 
2,3,0 
1,−1,3 
1,0,2 
1,1,1 
1,2,0 
1,3,−1 

2,0,3 
76 
4 
1 
– 
8 
8 
3 
– 
– 
2,1,2 
1 
42 
24 
– 
– 
15 
11 
7 
– 
2,2,1 
– 
24 
43 
– 
– 
5 
1 3 
1 5 
– 
2,3,0 
– 
– 
4 
73 
– 
1 
3 
1 0 
9 
1,−1 , 3 
4 
1 
– 
– 
80 
13 
– 
2 
– 
1,0,2 
– 
13 
9 
– 
– 
52 
14 
12 
– 
1,1,1 
– 
8 
19 
– 
– 
28 
14 
31 
– 
1,2,0 
– 
5 
13 
– 
– 
13 
17 
52 
– 
1,3,−1 
– 
– 
1 
4 
– 
2 
1 
1 2 
80 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9" validated="false"><figDesc>Table 6.</figDesc><table>Ability of CARROT to predict the degree of a relationship 

Degree 
1 
2 
3 
4 
5 
Unrel 

1 
100 
– 
– 
– 
– 
– 
2 
– 
99.5 
0.5 
– 
– 
– 
3 
– 
0.57 
93.57 
5.71 
0.14 
– 
4 
– 
– 
3.94 
82.06 
14 
– 
5 
– 
– 
– 
12.41 
86.64 
0.95 
Unrel 
– 
– 
– 
– 
10 
90 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11" validated="false"><figDesc>Table 7. Predictions of CARROT on four HapMap populations</figDesc><table>Pop 
Degree 
Reported relatives 
New relatives 
Total </table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [20:20 6/6/2011 Bioinformatics-btr243.tex] Page: i336 i333–i341</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [20:20 6/6/2011 Bioinformatics-btr243.tex] Page: i338 i333–i341</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">We note that, although for the CEU and MXL populations, the accuracy of our algorithm is consistent with the simulation results of Section 2.7, in the other two populations there was a drop in accuracy. This difference in performance might be a result of an increased phasing error in the YRI and ASW populations. Additionally, in the ASW population, the degree of relatedness is unexpectedly high, with 94 identified relationships in a sample of 83 individuals. We observed, for example, that 14 individuals from eight HapMap families (2483, 2487, 2488, 2489, 2490, 2492, 2495, and 2496) are connected to each other. With less than 50 presumably unrelated individuals [there are 53 individuals reported as unrelated in the HapMap ASW dataset, even if we ignore the relationships reported here and in Pemberton et al. (2010)], the estimation of allele and haplotype frequencies becomes problematic, especially in an admixed population like ASW. To help determine whether the previously unreported pairs detected by CARROT are predicted correctly, we ran KING (Manichaikul et al., 2010) on all the identified third-degree relatives. KING uses identity by state to distinguish relatives of degree up to three from unrelated individuals. Six out of the seven pairs of individuals that were predicted to be third-degree relatives by CARROT and could not be otherwise verified, were also predicted to be third-degree relatives by KING. We thus concluded that these six pairs are most likely true third-degree relatives. We notice that KING correctly predicted only 13 out of the 16 verified third-degree relatives. It is therefore likely that the last unverified third-degree prediction for which there was a disagreement between CARROT and KING is also a true third-degree pair. 4 DISCUSSION We presented CARROT, a novel framework for relationship inference that uses linkage information to infer more distant relationships than existing methods and to distinguish between rotated relationships, that is, relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration (e.g. aunt–niece versus niece– aunt or first cousins versus great aunt–niece). We demonstrated that CARROT achieved superior accuracy on relationships of degree up to four, clearly outperforming previous methods, such as RELPAIR i340 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">i341 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We would like to thank M. Schaub for helpful discussions, as well as the two anonymous reviewers for their comments.</p></div>
			</div>

			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20206</biblScope>
			<biblScope unit="issue">6</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>btr243. .tex]</note>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName>
				<surname>Page</surname>
			</persName>
		</author>
		<imprint>
			<biblScope unit="page" from="341" to="333" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Estimating genome-wide IBD sharing from SNP data via an efficient hidden Markov model of LD with application to gene mapping</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Bercovici</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="175" to="182" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Reconstructing sibling relationships in wild populations</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Berger-Wolf</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="49" to="56" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">DNA-based methods for pedigree reconstruction and kinship analysis in natural populations</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">S</forename>
				<surname>Blouin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Ecol. Evol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="503" to="511" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Rapid and accurate haplotype phasing and missing data inference for whole genome association studies using localized haplotype clustering</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Browning</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">L</forename>
				<surname>Browning</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="1084" to="1097" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Improved inference of relationship for pairs of individuals</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">P</forename>
				<surname>Epstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="page" from="1219" to="1231" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Whole-genome molecular haplotyping of single cells</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<forename type="middle">C</forename>
				<surname>Fan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="51" to="57" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Factorial hidden Markov models</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Ghahramani</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Jordan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mach. Learn</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="245" to="273" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">The combination of linkage values, and the calculation of distances between the loci of linked factors</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">B S</forename>
				<surname>Haldane</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Genet</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="299" to="309" />
			<date type="published" when="1919" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">N</forename>
				<surname>Howie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">1000529</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Integrating common and rare genetic variation in diverse human populations</title>
	</analytic>
	<monogr>
		<title level="m">The International HapMap 3 Consortium</title>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page" from="52" to="58" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Methods of parentage analysis in natural populations</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">G</forename>
				<surname>Jones</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">R</forename>
				<surname>Arden</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Ecol</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="2511" to="2523" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Pedigree reconstruction in wild cichlid fish populations</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Koch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Ecol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="4500" to="4511" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Robust relationship inference in genome-wide association studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Manichaikul</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2867" to="2873" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Statistical tests for detection of misspecified relationships by use of genome-screen data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">S</forename>
				<surname>Mcpeek</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Sun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="page" from="1076" to="1094" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Inference of Unexpected Genetic Relatedness among Individuals in HapMap Phase III</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">J</forename>
				<surname>Pemberton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">87</biblScope>
			<biblScope unit="page" from="457" to="464" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">PLINK: a tool set for whole-genome association and populationbased linkage analyses</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Purcell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="559" to="575" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">An introduction to hidden Markov models</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Rabiner</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">H</forename>
				<surname>Juang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Acoust. Speech. Sign. Process. Mag</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="4" to="16" />
			<date type="published" when="1986" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">FRANz: reconstruction of wild multi-generation pedigrees</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Riester</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2134" to="2139" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Reconstruction of pedigrees in clonal plant populations</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Riester</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Theor. Popul. Biol</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="page" from="109" to="117" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Identification of distant family relationships</title>
		<author>
			<persName>
				<forename type="first">Ø</forename>
				<surname>Skare</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2376" to="2382" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Identifying nineteenth century genealogical links from genotypes</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Stankovich</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">117</biblScope>
			<biblScope unit="page" from="188" to="199" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Enhanced pedigree error detection</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Sun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Hered</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="page" from="99" to="110" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">HaploPainter: a tool for drawing pedigrees with complex haplotypes</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Thiele</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Nürnberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1730" to="1732" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Genome-wide association study of 14 000 cases of seven common diseases and 3000 shared controls</title>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<editor>Wellcome Trust Case Control Consortium</editor>
		<imprint>
			<biblScope unit="volume">447</biblScope>
			<biblScope unit="page" from="661" to="678" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Completely phased genome sequencing through chromosome sorting</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="12" to="17" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>