
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:43+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis ORMAN: Optimal resolution of ambiguous RNA-Seq multimappings in the presence of novel isoforms</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Phuong</forename>
								<surname>Dao</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ibrahim</forename>
								<surname>Numanagic´1numanagic´numanagic´1</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Yen-Yi</forename>
								<surname>Lin</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Faraz</forename>
								<surname>Hach</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Emre</forename>
								<surname>Karakoc</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Genome Sciences</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nilgun</forename>
								<surname>Donmez</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Vancouver Prostate Centre &amp; Department of Urologic Sciences</orgName>
								<orgName type="institution">University of British Columbia</orgName>
								<address>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Colin</forename>
								<surname>Collins</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Vancouver Prostate Centre &amp; Department of Urologic Sciences</orgName>
								<orgName type="institution">University of British Columbia</orgName>
								<address>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Evan</forename>
								<forename type="middle">E</forename>
								<surname>Eichler</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Genome Sciences</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<settlement>Seattle</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">S</forename>
								<forename type="middle">Cenk</forename>
								<surname>Sahinalp</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computing Science</orgName>
								<orgName type="institution">Simon Fraser University</orgName>
								<address>
									<settlement>Burnaby</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Division of Computer Science</orgName>
								<orgName type="department" key="dep2">School of Informatics and Computing</orgName>
								<orgName type="institution">Indiana University</orgName>
								<address>
									<settlement>Bloomington</settlement>
									<region>IN</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis ORMAN: Optimal resolution of ambiguous RNA-Seq multimappings in the presence of novel isoforms</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">5</biblScope>
							<biblScope unit="page" from="644" to="651"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt591</idno>
					<note type="submission">Received on March 2, 2013; revised on September 30, 2013; accepted on October 10, 2013</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Ivo Hofacker Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: RNA-Seq technology is promising to uncover many novel alternative splicing events, gene fusions and other variations in RNA transcripts. For an accurate detection and quantification of transcripts, it is important to resolve the mapping ambiguity for those RNA-Seq reads that can be mapped to multiple loci: 417% of the reads from mouse RNA-Seq data and 50% of the reads from some plant RNA-Seq data have multiple mapping loci. In this study, we show how to resolve the mapping ambiguity in the presence of novel transcriptomic events such as exon skipping and novel indels towards accurate downstream analysis. We introduce ORMAN (Optimal Resolution of Multimapping Ambiguity of RNA-Seq Reads), which aims to compute the minimum number of potential transcript products for each gene and to assign each multimapping read to one of these transcripts based on the estimated distribution of the region covering the read. ORMAN achieves this objective through a combinatorial optimization formulation, which is solved through well-known approximation algorithms, integer linear programs and heuristics. Results: On a simulated RNA-Seq dataset including a random subset of transcripts from the UCSC database, the performance of several state-of-the-art methods for identifying and quantifying novel transcripts, such as Cufflinks, IsoLasso and CLIIQ, is significantly improved through the use of ORMAN. Furthermore, in an experiment using real RNA-Seq reads, we show that ORMAN is able to resolve multimapping to produce coverage values that are similar to the original distribution, even in genes with highly non-uniform coverage. Availability: ORMAN is available at http://orman.sf.net Contact:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Massively parallel RNA sequencing (RNA-Seq) technologies are replacing microarrays in determining the structure and dynamics of the transcriptome. Analysis of RNA-Seq data helps to uncover many novel alternative splicing events, gene fusions and other variations in RNA transcripts. Unfortunately, there are many RNA-Seq reads that can be mapped to several loci equally well, and it is of key importance to resolve their mapping ambiguity in order to perform a comprehensive and accurate analysis of the whole RNA-Seq data. There are several mappers that can align RNA-Seq reads to a reference genome or previously known transcript sequences (<ref type="bibr" target="#b0">Au et al., 2010;</ref><ref type="bibr" target="#b15">Trapnell et al., 2009;</ref><ref type="bibr" target="#b17">Wang et al., 2010;</ref><ref type="bibr" target="#b19">Yorukoglu et al., 2012</ref>). Owing to the presence of paralogs and homologous regions within a gene, RNA-Seq mappers typically report a fraction of multireads, i.e. reads that map to multiple loci on a reference genome. Based on TopHat mappings on the human reference genome, $10% of human RNA-Seq reads are multireads. Similarly, $17% of mouse and 50% of some plant RNA-Seq reads are multireads (<ref type="bibr" target="#b5">Li and Dewey, 2011</ref>). The presence of multireads complicates the downstream analysis such as determining alternative splicing patterns, gene fusions and other variations. The common practice for handling multireads is ignoring them in the downstream analysis. This leads to inaccurate estimation of the abundance of expressed transcripts (<ref type="bibr" target="#b5">Li and Dewey, 2011;</ref><ref type="bibr" target="#b10">Nicolae et al., 2011</ref>). A simple approach for determining the exact genomic location of a multiread is 'RESCUE' (<ref type="bibr" target="#b9">Mortazavi et al., 2008</ref>). Here, the initial gene expression values are calculated based on the unique reads that map to them. Each multiread is then assigned to the gene with the fraction equal to the ratio between the gene's initial expression value and the total expression value of all genes that the multiread maps to. A more complex approach based on expected maximization (EM) (<ref type="bibr" target="#b11">Pasaniuc et al., 2011</ref>) is designed to handle mapping ambiguity of a read to two or more homologous genes—for the purpose of determining the expression value of each of these genes and not to determine or quantify isoforms. Finally, RSEM (<ref type="bibr" target="#b5">Li and Dewey, 2011</ref>), IsoEM (<ref type="bibr" target="#b10">Nicolae et al., 2011</ref>) and iReckon (<ref type="bibr" target="#b8">Mezlini et al., 2013</ref>) are EM methods based on statistical generative models for sequencing processes to resolve mapping ambiguity. *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first four authors should be regarded as joint First Authors. Many of the above approaches are designed specially for estimating expression values of known/annotated isoforms. Their performance is highly dependent on the completeness of the isoform database in use. Furthermore, they cannot handle alternative splicing events such as novel exon skipping, alternative 5 0 donor and 3 0 acceptor sites, intron retention and other structural differences such as insertions or deletions. Some recent computational approaches, in particular IsoLasso (<ref type="bibr" target="#b5">Li et al., 2011</ref>), CLIIQ (<ref type="bibr" target="#b7">Lin et al., 2012</ref>) and Cufflinks (<ref type="bibr" target="#b16">Trapnell et al., 2010</ref>), can identify and quantify unknown isoforms and certain types of transcriptomic variations. Unfortunately, neither IsoLasso nor CLIIQ takes into account multireads, and Cufflinks handles multireads through a simple RESCUE-based approach. In this article, we show how to resolve the multimapping ambiguity in the presence of novel isoforms involving exon skipping, intron retention and small indels towards accurate downstream analysis. To be mathematically precise, we introduce the notion of a partial transcript—a substring of a potential transcript product of a gene, which satisfies certain conditions (a formal definition is provided in the next section). The objective of our multiread resolution approach, ORMAN (Optimal Resolution of Multimapping Ambiguity of RNA-Seq Reads), is (i) to compute the minimum number of partial transcripts that cover all the multireads and (ii) to assign each multiread to one of these partial transcripts such that each partial transcript is covered according to the estimated local distribution. We achieve the first objective approximately through a reduction to the standard set cover problem. We achieve the second objective through an integer linear programming formulation, which we handle using available integer linear program (ILP) solvers such as CPLEX, or through greedy heuristics we describe in this article. We evaluate ORMAN on both simulated and real human RNA-Seq datasets. For the first experiment, we generate paired-end RNA-Seq reads from a random subset of transcripts from the University of California, Santa Cruz (UCSC) database with the expression distribution modelled after a real human dataset. On this simulated data, we show that the performance of state-of-the-art methods for identifying and quantifying transcripts such as CLIIQ, Cufflinks and IsoLasso is typically improved through the use of our multiread resolution approach. Notably, when combined with IsoLasso or CLIIQ, ORMAN gives the most accurate and comprehensive novel isoform detection and quantification pipeline available. To evaluate ORMAN in a more 'real world' setting, we also design an experiment using real RNA-Seq data from a cancer patient (<ref type="bibr" target="#b4">Lapuk et al., 2012</ref>). For this experiment, we implant artificial genomic repeats into several genes and compare the performance of ORMAN with that of RESCUE in resolving the multireads mapping to these regions. We show that on this dataset, the multiread assignment by ORMAN approximates the original distributions quite well with a maximum relative error of 0.3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>Online databases such as the UCSC browser provide known transcripts from specific gene regions. Let T ¼ fT 1 , T 2 ,. .. , T p g be the set of known transcripts from a gene region GR. Each transcript T i is a string that can be partitioned into 'exonic segments' EðT i Þ ¼ fE 1 , E 2 ,. .. , E jEðTiÞj g. We define the 'gene model' GM implied by the set of transcripts T as an ordered set of alternating substrings of the gene region called canonical exons and canonical introns. Each exonic segment is a maximal substring of a canonical exon, which is either completely present in a transcript or excluded by that transcript. We refer the readers to<ref type="figure" target="#fig_0">Figure 1</ref>for an illustration of a gene model derived from known transcripts. Given a read R mapping to a gene region GR, the partial transcript PT supported by R is the shortest substring of the gene model that completely covers R, which starts and ends with an exonic segment (or a canonical intron in the case of intron retention). If there is a small insertion or deletion (our method limits the size of each indel to 15 nt) between the read and the reference sequence, we introduce a modified partial transcript with the corresponding indel.<ref type="figure" target="#fig_1">Figure 2</ref>illustrates several examples of partial transcripts derived from read mappings to a gene model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Combinatorial optimization formulation</head><p>The set of partial transcripts present in a sample can be derived from the mappings of RNA-Seq reads to a reference genome with the supply of transcript annotation or to a reference transcriptome. Depending on the given mapping to the reference genome or transcriptome, our objective isto assign each multiread to a single locus on the genome or a transcript. We also need to determine the partial transcript that the multiread should map to. This is done in two phases. In the first phase, we are interested in the minimum number of partial transcripts that could cover all the (multi)reads. In the second phase, we try to distribute the (multi)reads to the set of partial transcripts from the first phase such that the distribution of mappings for each partial transcript follows the most likely distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">First phase Let</head><p>C ¼ fPT 1 , PT 2 , ::, PT p g be the collection of all the partial transcripts derived from mapping results. We also denote by PT i (1 i p) the set of all reads that support the same partial transcript PT i. In addition, each PT i is assigned a positive weight that is proportional to the number of splicing events, i.e. exon skipping and intron retention events with respect to the known transcript it is associated with. For the partial transcripts without any variations with respect to their associated known transcripts, the weight is 1. Each variation adds a user-defined fixed value to this weight. Our default weight contribution of exon skipping is 100 and of indel is 10 000. Indel events have high weight due to their significantly low relative frequency (<ref type="bibr" target="#b3">Karakoc et al., 2012</ref>). Note that, in the case of paired-end reads, each end of a fragment may be assigned to a different partial transcript. In that case, we assign such a pair to the partial transcript formed by taking the union of the exons from the partial transcripts on both ends. The weight of this new partial transcript PT i is assigned as the sum of the weights of the two partial transcripts it is composed of. We aim to determine the minimumweighted set of partial transcripts that can cover all the reads. This problem can be defined as an instance of the minimum-weighted set cover problem, where sets are represented by the partial transcripts, and reads represent set elements. Because the minimum-weighted set cover problem is NP-hard, we use the standard greedy algorithm, which provides a logarithmic factor approximation guarantee (<ref type="bibr" target="#b1">Chvatal, 1979</ref>) to solve this problem and obtain the set of partial transcripts used for the smoothing step.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Second phase</head><p>First, we give the formulation of the problem in this phase in terms of an ILP below. We then show the computational complexity of the problem. Finally, we show how to solve the problem in practice. Let C 0 ¼ fPT 1 , PT 2 , ::, PT p 0 g be a set of partial transcripts returned from the first phase. For the partial transcript PT j 2 C 0 , we aim to distribute multireads across the partial transcript such that the coverage function of the reads in each partial transcript resembles the most likely distribution. In the case of paired-end reads, we use both ends for the coverage determination. For a read R, let SPT(R) be the set of partial transcripts that R could map to. Now let len R be the read length and lenðPT j Þ be the length of the partial transcript PT j. Let R ij (1 i jRj and 1 j jSPTðR i Þj) be indicator variables, where R ij ¼ 1 means that we assign R i to the partial transcript PT j ; otherwise R ij ¼ 0. We enforce that R i can only be assigned to one partial transcript: X fjjPTj2SPTðRiÞg</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R ij ¼ 1 ð1Þ</head><p>Let NR jk (1 j p 0 and 1 k lenðPT j Þ) be the number of reads that cover position k in PT j. Let MultiðPT j , kÞ be the set of the multireads that cover the position k in PT j. In similar manner, we define UniqueðPT j , kÞ to be the number of reads that are uniquely mapped and cover the position k in PT j. NR jk could be written as the summation of the number of uniquely mapped reads and multireads that cover the location k:</p><formula>NR jk ¼ UniqueðPT j , kÞ þ X fijRi2MultiðPTj, kÞg R ij ð2Þ</formula><p>Let AV jk be the desired number of reads covering the position k in the partial transcript PT j. Because we do not know the original distribution of the reads, we approximate AV jk as follows. First, we find the multimapping region M k of PT j , which encompasses position k. Next, we calculate the average coverage in the left and right neighbourhoods of M k (the size of each neighbourhood is set to h Â len R base pairs, where h is a user-defined parameter). We use the calculated average values as defining points for a line l, which approximates the desired function AV. Then, AV jk is calculated as a value on the line l at the position k. The rationale of this approach lies in the observation that coverage level of a small region is often similar to the level of the immediately neighbouring regions, even when the coverage varies significantly along the entire gene (see<ref type="figure" target="#fig_3">Fig. 3</ref>). Let d j ! 0 denote the maximum difference between the desired number of reads AV jk per position of partial transcript PT j and the observed number of reads NR jk at any position k. We enforce the following constraints:</p><p>Àd j AV jk À NR jk d j ð3Þ</p><p>Our objective is to minimize the total difference:</p><formula>X 1 j p 0 d j ð4Þ</formula><p>The problem of smoothing of the distribution of reads along partial transcripts, named SMOOTH, is provably hard. In addition, it is unlikely to have a constant factor approximation algorithm for the SMOOTH problem. The proofs are described in Supplementary Materials.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.3">Practical implementation</head><p>The ILP formulation of ORMAN is solved by IBM ILOG CPLEX. In practice, the running time of the proposed ILP depends on the number of integer and non-integer variables and the number of constraints. The number of integer variables of the provided ILP is proportional to the number of mappings of multireads, which can be in the order of millions. Here we propose a strategy to decompose the original problem into smaller subproblems such that the solution of each smaller one is independent from each other. We create a graph G PT ¼ ðV PT , E PT Þ among the partial transcripts returned from the first phase, i.e. V PT ¼ C 0. There is an edge between two partial transcripts if there is a multiread r mapping to both of them. It is easy to see that the solution of the ILP corresponding to each connected component in G PT is independent from the solutions of other components. Thus, we can obtain the solution for each component separately using CPLEX. There may still exist some components that could not be solved using CPLEX. In these cases, we propose a heuristic strategy as described in the Supplementary Materials.<ref type="figure" target="#fig_0">Figure 1</ref>. The partial transcripts derived from these reads are as follows: r1:{e1,e2}; r2:{e2,e3,e4}; r3:{e5,e6,e7}; r4:{e8 ins ,e9} and r5:{e9,e11}. Above, e8 ins denotes exon 8 with the implied insertion</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">EXPERIMENTAL RESULTS</head><p>We evaluate the performance of ORMAN on both simulated and real datasets. On both types of data, we show that ORMAN resolves mapping ambiguity of multireads accurately and improves the performance of the leading transcript identification and quantification tools.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Transcript identification and expression quantification in simulated data</head><p>First, we focus on quantifying how much ORMAN improves downstream analysis tools. We compare the performance of the leading transcript identification and quantification tools by</p><p>(i) first running each tool without any pre-or postprocessing (ORIGINAL), and (ii) then running each tool after preprocessing the mappings by ORMAN. Because there are no real world benchmark datasets that provide comprehensive and accurate information on all transcripts and their abundance levels validated by wetlab techniques, we use simulation data for this evaluation. [Even though the MAQC project (<ref type="bibr" target="#b14">Shi et al., 2006</ref>) used RNA-Seq technologies to quantify the expression of a limited number of genes, a significant number of these genes have a single isoform and have unique sequence composition (<ref type="bibr" target="#b5">Li and Dewey, 2011</ref><ref type="bibr" target="#b13">Shen et al., 2012</ref>). The reference transcriptome has 76 969 transcripts based on the UCSC database. We used TopHat version 2.0.7—with the number of mismatches at most 2—to obtain the mappings of the RNA-Seq reads to the reference sequence (version hg19). We ran IsoEM to quantify the expression profile of the UCSC reference transcriptome and determined that 39 388 of them are highly expressed. For the simulations, we assigned one random transcript out of all 76 969 transcripts to each one of the expressed transcripts of the prostate dataset. These randomly assigned transcripts represented the expression of 17 956 genes. We then set the expression value of each random transcript to that of the prostate dataset transcript it is associated with. We finally selected 10% of this randomly selected set of the simulated transcripts for the production of novel transcripts; for each such transcript, we randomly skip an exon. To ensure this transcript is novel, we check whether it is highly similar to other known transcripts. We consider a novel transcript to be highly similar to a known transcript if they have the same number of exons and their percentage sequence similarity is 490%. The novel transcript is then assigned the same abundance level as the original transcript. We generated 80 million paired-end RNA-Seq reads of 75-bp length from the chosen transcripts. The fragment length is determined based on the normal distribution with a mean of 250 bp and a standard deviation of 25 bp. Each transcript received a number of reads proportional to its predetermined expression level, and each read was picked uniformly at random over all possible starting positions of the transcript. We then randomly introduced sequencing errors in the generated reads according to sequencing error model described in<ref type="bibr" target="#b2">Dohm et al. (2008)</ref>. This model places the majority of mismatch errors towards the 3 0-end of the reads. The error percentage per base was set to be 1%. We used TopHat with the above settings to map the generated reads to the reference genome. Approximately 4% of the generated reads had multiple mapping loci.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Performance evaluation</head><p>Our performance evaluation is based on three tools: Cufflinks (version 2.0.2), IsoLasso (version 2.6.0) and CLIIQ (version 0.1.0.2). Cufflinks uses a modified rescue strategy to resolve multireads, whereas the latter two are not capable of resolving multimappings. We run CLIIQ in both its standard mode, where it selects the minimum possible number of isoforms, which minimizes quantification errors, and preference mode, where it prefers known isoforms when there are multiple candidate solutions (abbreviated as CLIIQ_pref below). To measure the relative performance of these tools, we provided the complete UCSC gene annotations and disallowed any novel splice sites while allowing novel exon skipping and intron retention events. The expression values of transcripts are measured in fragments per kilobase per million mapped reads. For each transcript, we define the 'relative quantification error' produced by a given tool as follows.</p><p>(i) If the known expression value of the transcript is e and the expression value of the transcript reported by the tool is ^ e, then the relative quantification error is je À ^ ej=e. (ii) If the tool reports a transcript that is not among the simulated expressed transcripts, the relative quantification error is þ1. (iii) If the tool misses a known expressed transcript, the relative quantification error is 1. Following (<ref type="bibr" target="#b5">Li and Dewey, 2011;</ref><ref type="bibr" target="#b10">Nicolae et al., 2011</ref>), we first investigate the proportion of transcripts whose relative quantification error is above a threshold. For each tool, we also compare how ORMAN affects its performance on detecting novel isoforms. The novel isoforms in our simulation generate reads that are incompatible to any known gene annotations. For existing mapping ambiguity resolvingThe read distribution of gene USP5 taken from a real RNA-Seq dataset (see Section 3.2 for details). Although the overall sequence coverage varies significantly along the gene, a small region often coincides well with its neighbourhood tools that require the full list of known transcripts, these reads might be discarded; hence, novel isoforms with multireads may not be detected. On the other hand, ORMAN allows such reads to be used in the solution. In our experiments, all three tools detect more novel isoforms based on ORMAN mappings as can be seen from<ref type="figure">Table 1</ref>. In<ref type="figure" target="#fig_4">Figure 4</ref>, we see that ORMAN improves the performance of IsoLasso and CLIIQ significantly in both modes, which, in comparison with Cufflinks, return fewer incorrectly quantified isoforms for smaller error thresholds. Overall,<ref type="figure" target="#fig_4">Figure 4</ref>demonstrates that the combination of ORMAN and CLIIQ_pref provides the best results. We also report the performance of tools on genes that produce a high proportion of multimapping reads separately. Here, we focus on 3784 genes (expressing 7275 transcripts) to which TopHat mapped reads have the top 20% highest mapping multiplicity (see later).<ref type="figure">Figure 5</ref>shows the proportion of transcripts whose relative quantification error is above a threshold on this subset. As before, ORMAN improves the performance of IsoLasso and CLIIQ significantly in both modes, which are better compared with that of Cufflinks. Next, we consider the performance of each tool in novel isoform detection for those genes that produce multimapping reads. First, we sort all expressed genes according to their mapping multiplicity (i.e. the proportion of the reads that can be mapped to such a gene, which can also be mapped to other genes). Then for genes ranked in the top 10, 20, 30, 40 and 50%, we examine how each tool performs in detecting novel isoforms.<ref type="figure">Figure 5</ref>demonstrates that, in the case of novel isoforms, all tools benefit from ORMAN mappings. In addition, for those genes whose multiplicity is in top 10% in the sample, ORMAN performs particularly well.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Multimapping resolution in real RNA-Seq data</head><p>It has been known that real RNA-Seq experiments often suffer from various biases resulting in a rather non-uniform coverage across a gene model (<ref type="bibr" target="#b12">Roberts et al., 2011;</ref><ref type="bibr" target="#b18">Wu et al., 2011</ref>). Unfortunately, modelling of such complex biases in simulations would be cumbersome. To overcome this problem, we design a controlled experiment with real RNA-Seq reads. For this experiment, we use a previously published RNA-Seq dataset with 51-bp Illumina paired-end reads sampled from a human prostate cancer patient (<ref type="bibr" target="#b4">Lapuk et al., 2012</ref>). On this dataset, we introduce artificial repeats in 10 genes based on sequences of other genes. By modifying the sequences of the original reads mapping to the artificial repeats, yet keeping everything else intact, we essentially create a multimapping dataset for which the true coverage distribution is known. We then evaluate ORMAN's performance in resolving these multireads. The following section explains the experimental setup in detail.</p><p>In the next section, we elaborate on the experiment results.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.1">Experimental setup First</head><p>, we map the reads using TopHat (version 1.3.2) to the reference sequence (hg19) and Ensembl annotations (GRCh37.62). Next, we randomly select 10 'decoy' genes according to the following rules:</p><p>(1) The gene is annotated to have a single transcript based on the Ensembl annotations.</p><p>(2) The total gene length (i.e. the sum of all canonical exons) is at least 2000 bp.</p><formula>(3)</formula><p>The gene is sufficiently expressed in the sample, having an average coverage 4100.</p><formula>(4)</formula><p>The gene is uniquely mappable (i.e. there are no multireads mapping to the gene model).Similarly, we randomly select 10 'replacement' genes according to the rules 2, 3 and 4 above. Within each replacement gene, we select a 400-bp region to serve as an artificial repeat. This 400-bp sequence is then used to replace the sequence of a region of the same length in the decoy gene. In other words, in each decoy gene, we create an artificial repeat for which the sequence is taken from a randomly chosen replacement gene. The selected genes and the repeat regions are given in<ref type="figure">Table 2</ref>. In the next step, we identify the reads mapping to the coordinates coinciding with the artificial repeat region in each decoy gene. The sequences of these reads are changed according to the new sequence of the decoy gene. All other reads are kept the same. The entire set of reads is then mapped to the new genome reference and the original Ensembl annotations using TopHat with the same parameters.</p><formula>(a) ( b)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.2">Evaluation</head><p>In this experiment, we compare ORMAN with the modified version of RESCUE as used in Cufflinks (<ref type="bibr" target="#b9">Mortazavi et al., 2008;</ref><ref type="bibr" target="#b16">Trapnell et al., 2010</ref>). This modified version calculates the initial gene/transcript abundances first by equally distributing the multireads to each gene they map to. In the second phase, each multiread is distributed in proportion to the relative abundance of each gene as computed in the first phase.<ref type="figure">Figure 6</ref>shows the relative error of coverage in the artificial repeat regions after resolution with ORMAN and RESCUE. This measure is calculated as: jc original À c orman j c tophat ð5Þ where c original , c tophat and c orman are the original coverage, raw coverage after the second TopHat mappings and coverage after multiread resolution with ORMAN, respectively. The relative error for RESCUE is defined similarly. On genes APPBP2, CD164, PPM1H, RCOR1, RYBP, SERPINB6, SSR2, TXNDC16, UQCRC2 and ZBTB42, we see that ORMAN produces lower error values than RESCUE, whereas in the rest of the genes, it produces a higher relative<ref type="figure">Fig. 5</ref>. Comparative performance of each tool and its enhanced version with ORMAN on selected genes that produce multireads, measured as the proportion of transcripts whose relative quantification error is above a threshold, as a function of the threshold. We show results of three tools (ORIGINAL) as well as their ORMAN enhanced versions for 3784 genes containing high ratio of multi-loci reads (left). We also examine the performance of novel isoform detections for gene whose multiread ratio ranked as top 10–50% in the whole sample (right)<ref type="figure">Table 2</ref>. The genes and the artificial repeat locations used in the experiments error. On the other hand, the relative error of ORMAN never exceeds 0.3. Furthermore, a closer look on some of the genes suggests that ORMAN is still able to reproduce the look of the original distribution quite well despite the fact that RESCUE has a lower relative error.<ref type="figure" target="#fig_5">Figure 7</ref>illustrates two such genes. Note that although both genes have a high variation in coverage, the coverage distribution in the repeat region is close to the original distribution after processing with ORMAN.shows the mappings after multiread resolution with ORMAN. The boxes outlined with dashed orange lines depict the artificial repeat region<ref type="figure">Fig. 6</ref>. The relative error of coverage in the repeat regions after multimapping resolution by ORMAN and RESCUE in the decoy and replacement genes used in the experiments</p><formula>(a) ( b)</formula></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. A gene model, known transcripts (KT) of the gene model, a novel transcript (NT) derived from known transcripts and a novel transcript with indels (NTID). Note that the latter may also be derived from known transcripts</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Example reads mapping to the gene model of Figure 1. The partial transcripts derived from these reads are as follows: r1:{e1,e2}; r2:{e2,e3,e4}; r3:{e5,e6,e7}; r4:{e8 ins ,e9} and r5:{e9,e11}. Above, e8 ins denotes exon 8 with the implied insertion</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>)]. 3.1.1 Simulation data We generated RNA-Seq reads of human transcripts with expression distribution similar to one derived from a real dataset from the GEO database (accession number GSM759513). This dataset comprises paired-end 50-bp RNASeq reads of a prostate tissue from Illumina Human BodyMap 2.0 project (</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. The read distribution of gene USP5 taken from a real RNA-Seq dataset (see Section 3.2 for details). Although the overall sequence coverage varies significantly along the gene, a small region often coincides well with its neighbourhood</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. Comparative performance of each tool and its enhanced version with ORMAN measured as the proportion of transcripts whose relative quantification error is above a threshold, as a function of the threshold. We show results of three tools (ORIGINAL) as well as their ORMAN enhanced versions of (a) all 17 956 expressed genes (left) and (b) 3148 genes containing novel transcripts (right)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.7.</head><figDesc>Fig. 7. Coverage plots for two genes (left: ZBTB42, right: BCL2L2) before and after processing with ORMAN compared with the original mappings. Top track (red) shows the mappings in the unaltered dataset; middle track (blue) shows the TopHat mappings after artificial repeats are introduced and the bottom track (green) shows the mappings after multiread resolution with ORMAN. The boxes outlined with dashed orange lines depict the artificial repeat region</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>Table 1.</figDesc><table>Number of novel isoforms correctly identified by each tool with 
and without ORMAN 

Cufflinks2 
IsoLasso 
CLIIQ 
CLIIQ_pref 

ORIGINAL 
1043 
1292 
1513 
1325 
ORMAN 
1055 
1308 
1533 
1334 </table></figure>

			<note place="foot">ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">P.Dao et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="4"> DISCUSSION In this article, we introduce a combinatorial optimization formulation for resolving mapping ambiguity of RNA-Seq reads. Using a simulated RNA-Seq dataset on humans, we have shown that ORMAN improves the performance of popular computational tools in transcript identification and quantification, especially for genes with novel isoforms. Furthermore, our experiments based on real RNA-Seq reads suggest that the localized approach of ORMAN is able to approximate the original read distribution of the multimapping regions even in genes with highly variable coverage. Although ORMAN&apos;s performance was similar to that of RESCUE in our small-scale experiment, we suspect that datasets that suffer from elevated level of sequencing biases such as severe RNA degradation could benefit even more from our approach. Funding: This research was supported by NSERC Discovery and Discovery Accelerate Grant to S.C.S., Canadian Cancer Society Innovation Grant to C.C. and S.C.S., Vanier Canada Graduate Scholarship to I.N. and Ebco/Epic Visiting Chairs and ICGC Grant to N.D. Conflict of Interest: none declared.</note>
		</body>
		<back>
			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Detection of splice junctions from paired-end RNA-seq data by SpliceMap</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">F</forename>
				<surname>Au</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="4570" to="4578" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">A greedy heuristic for the set-covering problem</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Chvatal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Oper. Res</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="233" to="235" />
			<date type="published" when="1979" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Substantial biases in ultra-short read data sets from highthroughput DNA sequencing</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">C</forename>
				<surname>Dohm</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page">105</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Detection of structural variants and indels within exome data</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Karakoc</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="176" to="178" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">From sequence to molecular pathology, and a mechanism driving the neuroendocrine phenotype in prostate cancer</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">V</forename>
				<surname>Lapuk</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Pathol</title>
		<imprint>
			<biblScope unit="volume">227</biblScope>
			<biblScope unit="page" from="286" to="297" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">RSEM: accurate transcript quantification from RNASeq data with or without a reference genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">N</forename>
				<surname>Dewey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">323</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Isolasso: a lasso regression approach to RNA-seq based transcriptome assembly</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1693" to="1707" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">CLIIQ: accurate comparative detection and quantification of expressed isoforms in a population</title>
		<author>
			<persName>
				<forename type="first">Y.-Y</forename>
				<surname>Lin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithms Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">7534</biblScope>
			<biblScope unit="page" from="178" to="189" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Mezlini</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="519" to="529" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Mapping and quantifying mammalian transcriptomes by RNA-Seq</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Mortazavi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="621" to="628" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Estimation of alternative splicing isoform frequencies from RNA-Seq data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Nicolae</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithms Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">9</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Accurate estimation of expression levels of homologous genes in RNA-seq experiments</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Pasaniuc</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="459" to="468" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Improving RNA-seq expression estimates by correcting for fragment bias</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Roberts</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="1" to="14" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">A map of the cis-regulatory sequences in the mouse genome</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Shen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">488</biblScope>
			<biblScope unit="page" from="116" to="120" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">The MicroArray Quality Control (MAQC) project shows interand intraplatform reproducibility of gene expression measurements</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Shi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="1151" to="1161" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">TopHat: discovering splice junctions with RNA-Seq</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1105" to="1111" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="511" to="515" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">MapSplice: accurate mapping of RNA-seq reads for splice junction discovery</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page">178</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Using non-uniform read distribution models to improve isoform expression inference in RNA-seq</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Wu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="502" to="508" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Dissect: detection and characterization of novel structural alterations in transcribed sequences</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Yorukoglu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="179" to="187" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>