
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:31+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Data and text mining Statistical agglomeration: peak summarization for direct infusion lipidomics</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">19 2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Rob</forename>
								<surname>Smith</surname>
							</persName>
							<email>2robsmith@gmail.com or jtprince@chem.byu.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Tamil</forename>
								<forename type="middle">S</forename>
								<surname>Anthonymuthu</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Dan</forename>
								<surname>Ventura</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">John</forename>
								<forename type="middle">T</forename>
								<surname>Prince</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Janet</forename>
								<surname>Kelso</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Chemistry</orgName>
								<orgName type="institution">Brigham Young University</orgName>
								<address>
									<postCode>84602</postCode>
									<settlement>Provo</settlement>
									<region>UT</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Data and text mining Statistical agglomeration: peak summarization for direct infusion lipidomics</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="page" from="2445" to="2451"/>
							<date type="published" when="2013">19 2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt376</idno>
					<note type="submission">Received on November 17, 2012; revised on May 17, 2013; accepted on June 26, 2013</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Contact: Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Quantification of lipids is a primary goal in lipidomics. In direct infusion/injection (or shotgun) lipidomics, accurate downstream identification and quantitation requires accurate summarization of repetitive peak measurements. Imprecise peak summarization multiplies downstream error by propagating into species identification and intensity estimation. To our knowledge, this is the first analysis of direct infusion peak summarization in the literature. Results: We present two novel peak summarization algorithms for direct infusion samples and compare them with an off-machine ad hoc summarization algorithm as well as with the propriety Xcalibur algorithm. Our statistical agglomeration algorithm reduces peakwise error by 38% mass/charge (m/z) and 44% (intensity) compared with the ad hoc method over three datasets. Pointwise error is reduced by 23% (m/z). Compared with Xcalibur, our statistical agglomeration algorithm produces 68% less m/z error and 51% less intensity error on average on two comparable datasets. Availability: The source code for Statistical Agglomeration and the datasets used are freely available for non-commercial purposes at https://github.com/optimusmoose/statistical_agglomeration. Modified Bin Aggolmeration is freely available in MSpire, an open source mass spectrometry package at https://github.com/princelab/mspire/.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Direct infusion (injection) lipidomics, sometimes called 'shotgun' lipidomics for its similarity to shotgun genomics, is an emerging but a well-studied field (<ref type="bibr" target="#b1">Ejsing et al., 2006;</ref><ref type="bibr" target="#b2">Ekroos et al., 2002;</ref><ref type="bibr" target="#b15">Watson, 2006</ref>). Here, a liquid sample is injected into a mass spectrometer, yielding a set of [mass/charge (m/z), intensity, retention time (RT)] 3-tuples (<ref type="bibr" target="#b4">Han and Gross, 2005</ref>). For our purposes, we define a data point as a single m/z and intensity observation of a given isotope at a particular RT and a peak as the data points that comprise the observation of a distinct isotope. (Hereafter, we will more accurately use the term ridge instead of peak because of the fact that direct injection lipid intensity does not vary as a function of time.) Because there is no chromatographic separation in direct infusion lipidomics, each RT scan represents an independent measurement of the sample. Ideally, the species in the sample would be uniformly distributed across RT and measured in near-identical intensities across RT, making reduction to a single 2D vector of unique ridges trivial. Unfortunately, there are several noise factors that appear in real-world direct infusion samples. Sample distribution heterogeneity results in inter-scan variance in both m/z and intensity. What is more, technical and mechanical limitations in the mass spectrometer inculcate even more error into the output. Accurately estimating the true ridge values from the resulting output file is a non-trivial challenge (<ref type="figure" target="#fig_0">Fig. 1</ref>). To identify and quantify each lipid, its component ridges must somehow be isolated one from another, and the additive noise ridges removed. We will call this process ridge summarization. Only after ridge summarization can the isotopic envelopes be compared with theoretical databases to identify and quantify the individual lipids in the sample. The necessity of a solution for the ridge summarization problem in every direct infusion lipidomics application and the presumed effect of the results of such a solution on downstream quantitation would suggest that a description of ridge summarization be found in every shotgun lipidomics study (<ref type="bibr" target="#b9">Samuelsson et al., 2004</ref>). However, it is frequently left unmentioned (e.g.<ref type="bibr" target="#b1">Ejsing et al., 2006;</ref><ref type="bibr" target="#b8">Oresˇicˇ,OresˇicˇOresˇicˇ, 2009;</ref><ref type="bibr" target="#b13">Song et al., 2007</ref>). Although direct infusion methods have been around since the mid-1990s, we are only aware of two published solutions to this segment of the quantitation pipeline. The first is that of treating a survey scan as a true ridge measurement (<ref type="bibr" target="#b11">Schwudke et al., 2006</ref>). From a glance at a typical shotgun lipidomics plot, it should be clear that treating any single RT scan of data as a representative set of true ridges would be less than ideal, as the scan would include many ridges with incorrect m/z and intensity and exclude many other true ridges (<ref type="figure" target="#fig_0">Fig. 1</ref>). The second, a more robust approach, applies to shotgun lipidomics a technique that has been used in several proteomics studies (<ref type="bibr" target="#b3">Frank et al., 2008;</ref><ref type="bibr" target="#b6">Liu et al., 2007</ref>). This approach, which we label the fixed-width algorithm, averages scans across the RT dimension to yield an estimation of the true contents of the sample (<ref type="bibr" target="#b5">Herzog et al., 2011</ref>). Though this approach is simple to code and runs in linear time, it is nonstatistical and does not take into account the data densities along the m/z axis. Here, we present two statistical approaches to solving the ridge summarization problem and evaluate them against both synthetic and real-world ridge summarization problems. We also provide the first comparative performance analysis of Xcalibur and the fixed-width algorithm on the ridge summarization problem. *To whom correspondence should be addressed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">SYSTEM AND METHODS</head><p>We use a representative sample of three labeled datasets to test the capabilities of the methods we present, as well as the baseline results from the widely used Xcalibur software shipped with Thermo mass spectrometers.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Data</head><p>The methods presented in this article were evaluated on one synthetic dataset and two real-world hand-labeled datasets. The Noyce dataset is a synthetic dataset constructed as described in a study by<ref type="bibr" target="#b7">Noyce et al. (2013)</ref>with sampling rate 1, noise density factor 500 and 1 dimension mode. Sample_3_750-800 and Sample_3_1000-1050 are two m/z intervals of a rat soleus lipid extract (Supplementary Material for experimental protocol). Each ridge in these datasets was isolated and labeled by hand using TOPPView (<ref type="bibr" target="#b14">Sturm and Kohlbacher, 2009</ref>) and an exhaustive list of all (m/z, intensity, RT) triplets in the file. Each of the datasets used in lipidomics can be represented as a list of points where each point is a (m/z, intensity, RT) triplet. For the purposes of the algorithms detailed here, points are reduced to m/z and intensity values (<ref type="figure" target="#fig_1">Fig. 2</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Metrics</head><p>Each of the following metrics measures a different quality of ridge assignment. Because each algorithm has different strengths, these metrics allow a ranking of algorithms based on what is important for the practitioner. Because we cast the ridge selection problem as a clustering problem, all of the following metrics are established clustering metrics, with the exception of normalized true ridge distance, which is a metric devised specifically for measuring the quality of summarized ridges. In what follows, we define R as the set of observed ridges, ^ R as the set of predicted ridges and D as the set of data points. We define the intensity, ^ r int , of a predicted ridge ^ r as the sum of the intensities of the ridge's assigned points:</p><formula>^ r int ¼ X d2^ r d int ð1Þ</formula><p>and the m/z value, ^ r m=z , of ^ r as the intensity-weighted mean of the m/z value of the ridge's assigned points:</p><formula>^ r m=z ¼ X d2^ r d m=z d int ^ r int ð2Þ</formula><p>Normalized true peak distance. Normalized true peak distance (NTPD) is a metric we developed for this task, which indicates the normalized m/z or intensity difference between the predicted ridges and the nearest observed ridges. The nearest observed ridge, ~ r, to a predicted ridge ^ r is always calculated using m/z/ value as:The normalizing term controls score inflation whether the error is in predicting too many or too few ridges. The significance of this metric is reflected in its analytical relevancy. This perridge metric basically measures how easy it would be to correctly assign the true species label using a standard lipid species library. Such is not the case for a per-point error measure such as sumsquared error (SSE) or an intrinsic cluster metric like normalized mutual information (NMI) or purity. Á Number of ridges. In downstream algorithms, each estimated ridge will be treated as an actual isotope. It is clear that any identification or quantitation algorithms will be highly sensitive to the number of predicted ridges versus the number of actual ridges. Purity. Purity measures the averaged homogeneity of each estimated ridge over all data points. It is defined as:</p><formula>~</formula><formula>purityð ^ R, RÞ ¼ 1 jDj X ^ r2 ^ R max r2R j^ r \ rj ð 5Þ</formula><p>A purity of 1 is perfect, and 0 is the lowest possible score. One way to achieve high purity is to reduce the size of the predicted ridges. A naı¨venaı¨ve algorithm that simply assigns each data point into its own ridge will achieve a perfect score for purity.and H is entropy, given by Hð ^ RÞ ¼ À X ^ r2 ^ R j^ rj jDj log j^ rj jDj ð8Þ NMI indicates the dependence of sets ^ R and R. If they are completely independent, the ridge predictions provide no information about the observed ridge assignments (indicated by an NMI of 0). A perfect score of 1 indicates that the observed ridge assignments provide no additional information beyond that provided by the predicted ridge assignments. Sum-squared error. SSE is a common measurement of error. It is computed by summing the squared error of each assignment. For the SSE of the m/z dimension, we use:</p><formula>SSEð ^ R, RÞ ¼ X d2D ð^ r d m=z À r d m=z Þ 2 ð9Þ</formula><p>where ^ r d m=z indicates the m/z of the predicted ridge containing point d and r d m=z indicates the m/z of the observed ridge containing point d. Intensity SSE is calculated in the same fashion, with intensity replacing m/z in Equation (9).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">ALGORITHMS</head><p>While both methods proposed as well as the fixed-width method follow the ridge summarization paradigm by combining multiple scans (<ref type="figure" target="#fig_1">Fig. 2</ref>), each of the three methods diverges in the way the ridges are segmented once combined into one spectrum.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Fixed ridge width method</head><p>Many practitioners use some variant of this method (e.g.<ref type="bibr" target="#b9">Samuelsson et al., 2004</ref>). Defining the ridge width in terms of the mass of the given point models the variation of resolution along the m/z scale (<ref type="bibr" target="#b5">Herzog et al., 2011</ref>) (<ref type="figure" target="#fig_2">Fig. 3</ref>). The combined spectra (<ref type="figure" target="#fig_1">Fig. 2</ref>) are sliced into adjacent bins of width m=z resolution , where m/z is the m/z at the current point and resolution is the resolution of the machine. Each bin is then treated as a ridge.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Modified bin agglomeration</head><p>Modified bin agglomeration (MBA) uses a series of decisions based on the shape of intensity histogram bins to partition the data into ridges. First, the data are binned according to the Fixed-Width algorithm, except with a user-defined bin width whose default is 5 ppm for the Orbitrap XL (<ref type="figure">Fig. 4</ref>). After this initial binning, the contiguous bins demarcated by empty bins are considered ridges. Note the difference between this and the Fixed-Width algorithm, which considers hard contiguous bin intervals as ridges irrespective of the content of each bin. At this point, if the user has selected the 0 option, the algorithm is complete. There are two other options available: share and greedy_y.</p><p>Both options split all ridges where the sum of the intensities of each bin forms a local minima within a series of contigous bins. The difference between the share and greedy_y options consists of how these local minima are treated (<ref type="figure" target="#fig_3">Fig. 5</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Statistical agglomeration</head><p>Statistical agglomeration (SA) bases bin agglomeration decisions on statistical analysis of the data. The approach here is to treat ridges as distributions and bins of data as samples from those distributions. Although there is no guarantee that the samples being tested are normally distributed, we make this assumption to use the t-test. Ridges (distributions) whose means are not statistically different according to this test are combined iteratively until all remaining ridges are statistically different with high confidence. As with the previous methods, the data are first sorted by ascending m/z and split into bins of size m=z window (<ref type="figure" target="#fig_4">Fig. 6</ref>): m=z window ¼ resolution Â 10 À7 ð10ÞThe combined spectra (<ref type="figure" target="#fig_1">Fig. 2</ref>) are sliced into bins of width m=z resolution. Note how fixed width has neither means of detecting data density or comparing the intensity of points. The shadow ridge (gray) is indistinguishable from the green ridge next to it, despite the intensity difference. Also, the hard bin limits segmentobserved ridges that happen to fall on both sides of a bin interval. The colors delineate observed ridges. The red segments along the x-axis indicate bin boundaries. See online version for color<ref type="figure">Fig. 4</ref>. Modified bin agglomeration segmentation. The combined spectra (<ref type="figure" target="#fig_1">Fig. 2</ref>) is sliced into bins of user-defined width (default 5 ppm). MBA then segments existing bins into disparate ridges at local minima (black arrows). The colors delineate observed ridges. See<ref type="figure" target="#fig_3">Figure 5</ref>for more detail on MBA bin splitting. See online version for color</p><p>This formula was empirically derived from observation of several lipid samples to yield a good balance between minimal window size and sufficient size to estimate ridge statistics, and it should be applicable across many mass spectrometers. After the initial bin assignment, starting at the lowest m/z value, adjacent bins are subjected to a Welch t-test (<ref type="bibr" target="#b16">Welch, 1947)</ref>[we use the Welch t-test because the samples (bins) have potentially different sizes and variances] to test the hypothesis that the two sample distributions have the same mean:</p><formula>t ¼ X 1 À X 2 ffiffiffiffiffiffiffiffiffiffiffiffiffiffi s 2 1 N1 þ s 2 2 N2 q ð11Þ</formula><p>where X i , s 2 i and N i are the ith sample mean, sample variance and sample size, respectively. The degrees of freedom are approximated using the Welch–Satterthwaite equation (<ref type="bibr" target="#b10">Satterthwaite, 1946</ref>):</p><formula>v ¼ ð s 2 1 N1 þ s 2 2 N2 Þ 2 s 4 1 N 2 1 ÁðN1À1Þ þ s 4 2 N 2 2 ÁðN2À1Þ ð12Þ</formula><p>For each potential bin agglomeration, the P-value is obtained from a t-distribution for a two-tailed test for the computed t and v values [Equations (11) and</p><p>(12)] to validate the null hypothesis that the ridge means are equal. If the P40.01, meaning the confidence that they are different is 599%, we accept the null hypothesis and combine the bins being tested. To accommodate a test of both the m/z and intensity differences of the considered bins, each tested bin pair is subjected to two t-tests, one using the m/z data and one using the intensity data. As an overall measure of confidence, we use the maximum P-value for the two t-tests. The approach here is to be no more confident than our least confident t-test dimension (intensity or m/z). This design decision provides an implicit awareness of situations, which would be deceptive if the minimum P-value were used as an overall measure of confidence, such as when two bins have a very similar m/z values but different intensities. This situation, which we call shadow ridges, occurs surprisingly often when a low-intensity ridge appears directly adjacent to a high-intensity ridge. This approach also helps discriminate in cases when two bins that should not be combined are similar in average intensity. This is a common occurrence at low intensities. In this case, the lack of confidence in the m/z dimension will prevent combination of the two ridges. In the event that the two bins under consideration are combined, the resulting agglomerated bin is considered as a single bin in the next iteration's comparison with the next bin in ascending m/z order. If they are not combined, the first bin in m/z order remains unchanged, and with the next iteration the second bin is compared with the next subsequent bin in ascending m/z order (<ref type="figure">Fig. 7</ref>). The entire algorithm runs in just one pass, resulting in O(n) performance, where n is the number of bins. For post-processing noise removal, we use an established noise filtering method where all points with intensities below the estimated noise level (signal to noise ratio (s/n) ¼ 1) are labeled as noise and removed. This method is borrowed from Samuelsson et al., but we modify the quantitation of noise from an intensity level to a frequency count, which is more robust to lower intensity signals (<ref type="bibr" target="#b9">Samuelsson et al., 2004</ref>). This approach rests on the assumption that noise points are distributed uniformly, and thus should be equally distributed across the initial bins. The expected noise level is one noise point per bin.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Xcalibur</head><p>Xcalibur is a propriety mass spectrometry software platform from Thermo Scientific. Because Xcalibur will not accept data in the community standard mzML format, we were unable to use it on the Noyce synthetic dataset (<ref type="bibr" target="#b0">Deutsch, 2008</ref>). However, the raw data of the Sample_3 datasets were analyzed using Xcalibur 2.1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head><p>SA generally outperforms the other methods under consideration across all datasets on both the qualitative and quantitative measures considered in this study. SA and MBA outperform all other methods on NTPD m/z (<ref type="figure" target="#fig_5">Fig. 8</ref>). MBA had a slightly lower NTPD rate on Sample_3_750-800, whereas SA outperformed all other methods<ref type="figure" target="#fig_1">Fig. 2</ref>) are sliced into bins of width resolution Â 10 À7. The colors delineate observed ridges. The red segments along the x-axis indicate bin boundaries. See online version for color on the other two datasets. The relative performance was identical for NTPD intensity, with the exception being more disparity between the SA and MBA scores and fixed width on the Noyce dataset (<ref type="figure">Fig. 9a</ref>). Xcalbur's NTPD is dramatically higher for both NTPD intensity and NTPD m/z than all other methods on the two datasets that were comparable given Xcalibur's proprietary data limitations. SA predicted the number of ridges far more accurately than any other method tested, including Xcalibur, which was furthest from the actual number of ridges (<ref type="figure" target="#fig_0">Fig. 10</ref>). MBA was second best on average at predicting the correct number of ridges. On average, each of the three methods performs rather similarly on purity. The scores averaged across all three datasets are 0.73, 0.7 and 0.74 for SA, MBA and Fixed Width respectively (Supplementary Material). Because we are ignoring all noise points (real or assigned), and because Fixed Width produces the narrowest ridges, it is not surprising that Fixed Width performed so well on purity.</p><p>The NMI scores averaged across all three datasets are 0.95, 0.96 and 0.93 for SA, MBA and Fixed Width, respectively (Supplementary Material). It is surprising that they are so close, but this is likely a result of the modifications to this metric to handle noise. Each of the three methods performs inconsistently on SSE. SA outperforms the other methods on both Sample 3 datasets for m/ z SSE, but MBA has a dramatically lower SSE for the Noyce dataset than either of the other methods (<ref type="figure" target="#fig_0">Fig. 11</ref>). Fixed Width has a dramatically lower intensity SSE than either of the other methods on the Noyce dataset, but only slightly less SSE than SA on the Sample_3_750-800 dataset (Supplementary Material). MBA noticeably outperforms other methods on the Sample_3_1000-1050 dataset. Although the aforementioned metrics should give an overall quantitative measure of the performance of each method, the segments of the spectra in Figures 12 and 13 provide a qualitativeXcalibur only accepts data in its proprietary format, the results are not available for the Noyce dataset. Note the different scales. See online version for color. See online version for color<ref type="figure">Fig. 9</ref>. NTPD—Intensity. Here we compare predicted ridge intensities to the nearest observed ridge for each of the four methods (Statistical Agglomeration, Modified Bin Agglomeration and Fixed Width) using the (a) Noyce, (b) Sample_3_750-800 and (c) Sample_3_1000-1050 datasets. SA outperforms the other methods on average, providing a 51% error reduction from Xcalibur for the two measurable datasets given Xcalibur's proprietary data restrictions. SA provides a 44% reduction on average over Fixed Width. Note the different scales. See online version for color<ref type="figure">Fig. 7</ref>. SA bin agglomeration. After sorting the data by m/z value, and assigning data points to bins of fixed width, a t-test is conducted on the intensity and m/z means of the first two bins (a). If either of the t-tests fails to show a high confidence that the means are different, the bins are not combined and the algorithm considers the next two bins for agglomeration (b). Otherwise, the two bins are agglomerated, and the algorithm considers the agglomerated bin and the next bin for agglomeration (c). Dotted lines indicate ridge boundaries. See online version for color assessment of each method on the Sample 3 datasets (Supplementary Material for quantitative results for the Noyce dataset). The pattern that emerges across datasets is that, at least on these random segments, SA consistently summarizes ridges exactly or very close to the hand annotation. MBA also performs well. Fixed Width is not consistent in performance but usually adds extra ridges and/or shifts m/z values of ridges substantially. Across both Sample 3 datasets, Xcalibur drastically increases the number of ridges in the segment. Xcalibur's predicted ridges are also notably less intense than the hand-annotated dataset. The Supplementary information provides more metric results and an in-depth discussion of how noise is treated in this article.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">DISCUSSION</head><p>Fixed Width, to our knowledge the only extant algorithmic solution to this problem, is simple to code, yet has some obvious limitations. In mass spectrometry, the intra-sample resolution is inherently variable (<ref type="bibr" target="#b12">Schwudke et al., 2011</ref>). At least for the Orbitrap, low-intensity signal groups are more dispersed, whereas high-intensity signal groups have less m/z variance. Any fixed-width solution will either chop low-intensity ridges into incorrect component ridges, incorrectly agglomerate highintensity ridges or both. As shown in the results, fixed-width methods significantly overestimate the number of ridges, cascading error downstream into identification and quantitation. MBA attempts to provide robust means for dealing with ridges that overlap, and builds on the idea of Fixed Width binning by agglomerating any adjacent non-empty bins. Although the initial fixed width and the choice of which bin splitting options to use are parameters that must be determined and set by the operator, the information in manufacturer specifications, such as resolution, should assist in deciding the MBA parameters. In practice, the machine calibration to which the specifications are tied is not always the setup desired for the practitioner due to time requirements, desire to use MS/MS and so forth. Also, the true machine resolution can vary widely outside of the m/z value the specification is provided for. However, practical experience may assist in knowing when the manufacturer specs are sufficient and what changes need to be made when they are not. Because each ridge can be a different width, SA addresses the problem of bin size in a flexible data-driven manner. The ridge agglomeration procedure is statistically driven using the data itself, handling problems like overlapping ridges and avoiding the need for users to set parameters or for a priori knowledge about the dataset. Noise filtering allows for the avoidance of boundary conditions found in fixed-width methods such as ridges with just one data point. We consider s/n ¼ 1 to be a useful a priori setting, as it was the ideal setting across all three of our datasets. SA's ability to predict a far more accurate number of ridges than the other methods suggests it will increase accuracy in downstream processes over the current methods used, including Xcalibur (<ref type="figure" target="#fig_0">Fig. 10</ref>). One troubling observation from this study is the difficulty in accurately assessing intensity of discovered ridges. Both species identification and quantitation require an accurate intensity measurement. Yet, even SA's performance is simply the best of several inaccurate methods. Given the amount of lipid quantitation performed currently, and also the state-of-the-art, better methods of estimating intensity are needed. We have described the need for accurate ridge summarization in direct injection lipidomics samples. Interestingly, despite the importance of accuracy in this first step of the analysis pipeline, there has been no study of solutions to this version of the ridgesummarization problem to our knowledge. We present our estimate of what is currently done in the community and also propose two novel algorithms, MBA and SA, for resolving ridges in shotgun lipidomics samples. We show that SA outperforms open source and proprietary methods on average in a measure of ridgewise error, NTPD, on three datasets. We also show that SA significantly outperforms the proprietary program Xcalibur on the two datasets for which we could use Xcalibur. Incorporation of SA into existing analysis pipelines could drastically improve downstream quantitation and identification results in a variety of lipidomics experiments. Future work should continue improving our capacity to produce summarized ridges that more accurately estimate intensity. In light of the recent calls for greater reproducibility in mass spectrometry (<ref type="bibr" target="#b17">Wilkins et al., 2006</ref>), and to foster development of improved algorithms, these datasets and the SA algorithm (with ample documentation) are available freely for non-commercial use at http://github.com/optimusmoose/statistical_agglomeration.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. A typical direct infusion lipidomics sample. The lack of consistent repetition in data points in the RT dimension and the abundance of noise in each of the three dimensions make accurate ridge summarization difficult. The colors delineate observed ridges. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Scan combination. Here (a) multiple scans are combined into (b) one list of (m/z, intensity) pairs by removing the retention time (RT) dimension. Each data point (an m/z and intensity observation of a distinct isotope at a given RT) is depicted here with a pinhead, and the collection of pinheads of one color denotes a ridge. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. Fixed-Width segmentation. The combined spectra (Fig. 2) are sliced into bins of width m=z resolution. Note how fixed width has neither means of detecting data density or comparing the intensity of points. The shadow ridge (gray) is indistinguishable from the green ridge next to it, despite the intensity difference. Also, the hard bin limits segmentobserved ridges that happen to fall on both sides of a bin interval. The colors delineate observed ridges. The red segments along the x-axis indicate bin boundaries. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.5.</head><figDesc>Fig. 5. MBA bin splitting. After segmenting all points into fixed interval bins and creating initial ridges of each contiguous segment bounded by empty bins, the MBA algorithm further divides ridges by considering local minima. With the share method (a), the local minimum is split among adjoining ridges proportional to the neighboring ridges' intensities. The greedy_y method (b) awards the entire disputed bin to the adjoining ridge of greatest total intensity. The bars in this figure represent histograms of the intensity of the points in the assigned bins, not the component points themselves. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.6.</head><figDesc>Fig. 6. Statistcal agglomeration segmentation. The combined spectra (Fig. 2) are sliced into bins of width resolution Â 10 À7. The colors delineate observed ridges. The red segments along the x-axis indicate bin boundaries. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.8.</head><figDesc>Fig. 8. NTPD—m/z. NTPD is a difference metric that compares the predicted ridge to the nearest observed ridge. Here, we compare the ridges' m/z values resulting from each of the four methods (Statistical Agglomeration, Modified Bin Agglomeration and Fixed Width) using the (a) Noyce, (b) Sample_3_750-800 and (c) Sample_3_1000-1050 datasets. On average, SA provides a 38% reduction in error from Fixed Width and provides a 68% improvement over Xcalibur for the two datasets for which Xcalibur's propriety data restrictions precluded measurement. Note the different scales. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.10.</head><figDesc>Fig. 10. Á Number of ridges predicted by method. Each bar represents the difference from the actual number of ridges for each of the four methods (Statistical Agglomeration, Modified Bin Agglomeration and Fixed Width) summed across all datasets. SA's number of predicted ridges is much closer to the observed number than any other method. Xcalibur predicted far more ridges than any other method. Because Xcalibur only accepts data in its proprietary format, the results are not available for the Noyce dataset. Note the different scales. See online version for color. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig.11.</head><figDesc>Fig. 11. Sum-squared error (SSE)—m/z. The SSE of each of the three of the four methods (Statistical Agglomeration, Modified Bin Agglomeration and Fixed Width) is measured for each of the three datasets (a) Noyce, (b) Sample_3_750-800 and (c) Sample_3_1000-1050 datasets. SA outperforms the other methods on Sample_3_750-800 and Sample_3_1000-1050, but MBA outperforms the other methods on the Noyce dataset. SA's average error is 23% lower than Fixed Width. This metric could not be measured for Xcalibur's ridge assignments. Note the different scales. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.12.</head><figDesc>Fig. 12. Peak summarization of sample 3: 784-785. Note: all intensities have been log-transformed for fit. See online version for color</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.13.</head><figDesc>Fig. 13. Peak summarization of sample 3: 1040-1041. Note: all intensities have been log-transformed for fit. See online version for color</figDesc></figure>

			<note place="foot">ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">R.Smith et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Statistical agglomeration at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">mzML: a single, unifying data format for mass spectrometer output</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Deutsch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proteomics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="2776" to="2777" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Automated identification and quantification of glycerophospholipid molecular species by multiple precursor ion scanning</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">S</forename>
				<surname>Ejsing</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="page" from="6202" to="6214" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Quantitative profiling of phospholipids by multiple precursor ion scanning on a hybrid quadrupole time-of-flight mass spectrometer</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Ekroos</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<biblScope unit="page" from="941" to="949" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Clustering millions of tandem mass spectra</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Frank</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="113" to="122" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Shotgun lipidomics: electrospray ionization mass spectrometric analysis and quantitation of cellular lipidomes directly from crude extracts of biological samples</title>
		<author>
			<persName>
				<forename type="first">X</forename>
				<surname>Han</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">W</forename>
				<surname>Gross</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mass Spectrom. Rev</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="367" to="412" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A novel informatics concept for high-throughput shotgun lipidomics based on the molecular fragmentation query language</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Herzog</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">8</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Methods for peptide identification by spectral comparison</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Liu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proteome Sci</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Mspire-simulator: LC-MS shotgun proteomic simulator for creating realistic gold standard data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">B</forename>
				<surname>Noyce</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
	<note>epub. ahead of print</note>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Bioinformatics and computational approaches applicable to lipidomics</title>
		<author>
			<persName>
				<forename type="first">Oresˇicˇoresˇicˇ</forename>
				<surname>Oresˇicˇ</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Eur. J. Lipid Sci. Technol</title>
		<imprint>
			<biblScope unit="volume">111</biblScope>
			<biblScope unit="page" from="99" to="106" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Modular, scriptable and automated analysis tools for high-throughput peptide mass fingerprinting</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Samuelsson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="3628" to="3635" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">An approximate distribution of estimates of variance components</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">E</forename>
				<surname>Satterthwaite</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrics</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="110" to="114" />
			<date type="published" when="1946" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Lipid profiling by multiple precursor and neutral loss scanning driven by the data-dependent acquisition</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Schwudke</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Chem</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="page" from="585" to="595" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Shotgun lipidomics on high resolution mass spectrometers</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Schwudke</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cold Spring Harb. Perspect. Biol</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">4614</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Algorithm for processing raw mass spectrometric data to identify and quantitate complex lipid molecular species in mixtures by datadependent scanning and fragment ion database searching</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Song</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Soc. Mass Spectrom</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1848" to="1858" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Toppview: An open-source viewer for mass spectrometry data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Sturm</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Kohlbacher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="3760" to="3763" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Thematic review series: systems biology approaches to metabolic and cardiovascular disorders Lipidomics: a global approach to lipid analysis in biological systems</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">D</forename>
				<surname>Watson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Lipid Res</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="page" from="2101" to="2111" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">The generalization of Student&apos;s problem when several different population varlances are involved</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">L</forename>
				<surname>Welch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="28" to="35" />
			<date type="published" when="1947" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Guidelines for the next 10 years of proteomics</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">R</forename>
				<surname>Wilkins</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proteomics</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="4" to="8" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>