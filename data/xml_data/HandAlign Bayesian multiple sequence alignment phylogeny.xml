
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:59+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">HandAlign: Bayesian multiple sequence alignment, phylogeny and ancestral reconstruction</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Oscar</forename>
								<surname>Westesson</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Bioengineering</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<postCode>94720</postCode>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Lars</forename>
								<surname>Barquist</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Bioengineering</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<postCode>94720</postCode>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ian</forename>
								<surname>Holmes</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Bioengineering</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<postCode>94720</postCode>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">HandAlign: Bayesian multiple sequence alignment, phylogeny and ancestral reconstruction</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="issue">8</biblScope>
							<biblScope unit="page" from="1170" to="1171"/>
							<date type="published" when="2012">2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts058</idno>
					<note type="submission">Phylogenetics Advance Access publication January 28, 2012 Received on November 3, 2011; revised on January 18, 2012; accepted on January 20, 2012</note>
					<note>Copyedited by: GS MANUSCRIPT CATEGORY: APPLICATIONS NOTE [15:00 27/3/2012 Bioinformatics-bts058.tex] Page: 1170 1170–1171 Associate Editor: David Posada Contact: ihh@berkeley.edu Supplementary information: Supplementary material is available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We describe handalign, a software package for Bayesian reconstruction of phylogenetic history. The underlying model of sequence evolution describes indels and substitutions. Alignments, trees and model parameters are all treated as jointly dependent random variables and sampled via Metropolis–Hastings Markov chain Monte Carlo (MCMC), enabling systematic statistical parameter inference and hypothesis testing. handalign implements several different MCMC proposal kernels, allows sampling from arbitrary target distributions via Hastings ratios, and uses standard file formats for trees, alignments and models. Availability and Implementation: Installation and usage instructions are at http://biowiki.org/HandAlign</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">BACKGROUND</head><p>Multiple sequence alignments constitute a central part of many bioinformatics workflows. Commonly, an alignment is built from primary sequences, a tree is reconstructed from this alignment, and various analyses are run using the alignment and/or tree. This can be problematic for several reasons. First, inference of the tree and alignment is likely to be uncertain: many alternative trees or alignments may explain the data comparably well. Downstream analyses that assume the tree and alignment to be true ignore this uncertainty, and potentially inherit embedded bias and error. Second, this flow of information is circular: alignment algorithms often (implicitly or explicitly) make use of a guide tree, while treeand model-fitting algorithms typically use an alignment as input. This leads to a chicken-and-egg situation. In attempted resolution of these problems, the field of statistical alignment methods unifies alignment and tree-building as related inference tasks under a phylogenetic likelihood function. The handalign software is one such tool, building on a range of prior work in this area (<ref type="bibr" target="#b0">Bouchard-Côté et al., 2009;</ref><ref type="bibr" target="#b1">Holmes and Bruno, 2001;</ref><ref type="bibr" target="#b4">Redelings and Suchard, 2005</ref>). * To whom correspondence should be addressed. † Present address: Wellcome Trust Sanger Institute, Cambridge, UK.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">SAMPLING ALIGNMENTS, TREES AND PARAMETERS</head><p>handalign implements a Bayesian model of sequence phylogeny with separate substitution and indel components. To perform inference of unknown variables (i.e. trees, ancestral sequences or parameters) under this model, handalign makes use of Markov chain Monte Carlo sampling (MCMC). We cannot directly observe the indel history (H), tree (T ) or evolutionary model parameters (θ). However, we can estimate their a posteriori probability distribution, conditional on what we do observe: the extant sequences (S). That is, we aim to sample (H,T ,θ|S). Explicitly marginalizing H, T and θ is infeasibly expensive: there are combinatorially many trees T and histories H, and continuously varying parameters θ. MCMC provides a powerful alternative way to sample from (H,T ,θ|S) that is often not much more expensive than computing the joint likelihood of (H,T ,θ,S). Informally, MCMC randomly walks the space of (H,T ,θ) tuples, the number of steps spent at a particular tuple converging to the posterior probability P(H,T ,θ|S). The result is a series {(H n ,T n ,θ n )} of samples from the posterior. Depending on the investigator's goals, various analyses can then be performed using the collection of tuples {(H n ,T n ,θ n )}. The ensemble can be summarized with a single 'consensus' alignment or tree, including confidence levels (e.g. the probability that a given subset of species form a monophyletic clade, or that a given column is correct). Alternatively, downstream computations can be averaged over the ensemble: the sampled parameters can be used to estimate modes and moments (e.g. the most likely indel rate), or detect signatures of interest (e.g. positive selection). As well as MCMC, handalign can perform a stochastic search using the same underlying model, but returning a single best-guess (H,T ,θ) rather than a collection of such tuples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">CAPABILITIES</head><p>Given unaligned FASTA-format sequences, or (optionally) an 'initial guess' in the form of a Stockholm-format alignment with an embedded Newickformat tree. handalign performs N ×|S| sampling steps (where |S| is the number of input sequences). Each step uses one of the MCMC kernel moves (described below) to update one of H,T or θ. If requested (via a command-line option), the new tuple (H,T ,θ) is logged to a file. If operated in 'Stochastic search' mode, a greedy local search is performed every K samples to find the most likely nearby alignment. After N ×|S| samples, the final (H,T ,θ) tuple is output in Stockholm+Newick format.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Indel models</head><p>: the insertion–deletion model is an affine-gap transducer approximation to a Long Indel birth-death process (<ref type="bibr" target="#b3">Miklós et al., 2004)</ref>with insertion rate λ, deletion rate μ, deletion extension probability r.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>HandAlign</head><p>The approximation is that indel events never overlap on the same branch. Other indel length distributions, such as TKF91 or mixture-geometric, can be used.</p><p>Substitution models: any parametric continuous-time Markov chain can be used to model character evolution, via the file format of the companion program xrate. For instance, 20N-state amino acid models (with N-valued hidden states) and 64-state codon models have been used. Parameters of these substitution models can be sampled, allowing alignment-free estimation of statistics such as K a /K s. Ancestral characters are summed out(Holmes and<ref type="bibr" target="#b1">Bruno, 2001</ref>); they can be imputed using xrate. Tree prior: the prior over tree topologies is uniform, with a weak exponential prior over total branch length. Alternate priors can be implemented using the 'Arbitrary target distribution' mechanism.</p><p>Arbitrary target distribution: handalign allows any tree/alignment probability model to be implemented over a Unix pipe and used in a Metropolis–Hastings accept/reject step. MCMC kernel moves: the relative proportions of the various sampling moves can be set on the command line. All are variants of Gibbs-sampling moves. Some are full Gibbs (perfectly mixing the sampled variables at every step); others utilize Metropolis-within-Gibbs or a variant of importance sampling that includes the current point in the list of accessible points. The individual moves vary in the dependence of their complexities on the input sequence length, L. The worst-case complexity with default settings is O(L 2 ), comparable to BaliPhy (<ref type="bibr" target="#b4">Redelings and Suchard, 2005</ref>). Stochastic search: handalign can be used to do a partially randomized greedy search, yielding a relatively quick, approximate maximum likelihood estimate for the alignment and/or tree, in addition to a full MCMC trace. The iterative refinement command-line option interrupts the MCMC run periodically to perform a greedy (Viterbi) search for the locally maximal alignment close to the current sample.</p><p>Alignment banding: as the DP matrix may be costly to fill, both in time and memory, users may specify an alignment 'band' as a heuristic constraint. Command-line options can be used to prevent visiting cells more than M positions away from the current alignment path. This has the effect of causing indels longer than M to be excluded, but is otherwise ergodic, and generally converts an O(L a ) step into an O(LM a−1 ) step (for a ≥ 2). HMMoC adapter: handalign can optionally make use of the Hidden Markov Model Compiler hmmoc to craft optimized C++ code for DP-based sampling steps. This typically speeds things up by a large constant factor. MCMC trace analysis: the DART package includes several scripts for summarizing MCMC traces. constock.pl finds a consensus alignment and uses ANSI terminal color to render posterior probabilities of individual columns (<ref type="figure" target="#fig_1">Fig. 1</ref>). Alternatively, trees can be extracted using stocktree.pl and a separate program, such as CONSENSE in the PHYLIP package, used to estimate consensus trees. handalign sampling traces use Stockholm alignment format to embed trees and parameters. A trace can be rendered as an ANSI terminal color animation using stockfilm.pl, converted into other common formats (see http://biowiki.org/StockholmTools) or the parameters extracted and their distribution analyzed (<ref type="figure" target="#fig_2">Fig. 2</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Current limitations and performance</head><p>: the O(L 2 ) complexity may be limiting for longer sequences (e.g. genomes); alignment banding should ameliorate this (but its effect on mixing performance is untested). Underflow/precision issues may potentially be an issue with larger trees. A ongoing compilation of comparison tests is here: http://biowiki.org/HandAlignBenchmark</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>Copyedited by: GS MANUSCRIPT CATEGORY: APPLICATIONS NOTE [15:00 27/3/2012 Bioinformatics-bts058.tex] Page: 1171 1170–1171</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. A summary alignment of SIV/HIV gp120 proteins produced by constock.pl. Posterior probabilities of alignment columns are shown on the 'PP' line (most significant decimal digit) and by ANSI terminal color (white-on-cyan is most reliable, blue-on-black is least). Hypervariable (hV) region 5 [Leonard et al. (1990)] corresponds with a low-confidence region.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.2.</head><figDesc>Fig. 2. The indel rate of the SIV/HIV gp120 protein has most of its probability mass concentrated between 0.04 and 0.06 indels per substitution. handalign was run for 90 min on a 3.4 GHz CPU, generating 2000 samples (500 discarded as burn-in). Every fifth sample is plotted; the entire trace was used to estimate the density.</figDesc></figure>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors thank Benjamin Redelings, Marc Suchard, Jotun Hein, Joe Herman, Alexandre Bouchard-Côté and many others working in statistical alignment for their illuminating discussions.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Efficient inference in phylogenetic InDel trees</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Bouchard-Côté</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems 21 (NIPS)</title>
		<meeting><address><addrLine>Vancouver, Canada</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Evolutionary HMMs: a Bayesian approach to multiple alignment</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Holmes</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Bruno</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="803" to="820" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Assignment of intrachain disulfide bonds and characterization of potential glycosylation sites of the type 1 recombinant human immunodeficiency virus envelope glycoprotein (gp120) expressed in Chinese hamster ovary cells</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Leonard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. of Biol. Chem</title>
		<imprint>
			<biblScope unit="volume">265</biblScope>
			<biblScope unit="page">10373</biblScope>
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">A long indel model for evolutionary sequence alignment</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Miklós</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="529" to="540" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Joint Bayesian estimation of alignment and phylogeny</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">D</forename>
				<surname>Redelings</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">A</forename>
				<surname>Suchard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Systematic Biol</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="page" from="401" to="418" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">Note: References truncated to comply with page limit. See Supplementary Material for complete bibliography</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>