
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:44+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis seqlm: an MDL based method for identifying differentially methylated regions in high density methylation array data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Raivo</forename>
								<surname>Kolde</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Science</orgName>
								<orgName type="institution">University of Tartu</orgName>
								<address>
									<postCode>50409</postCode>
									<settlement>Tartu</settlement>
									<country key="EE">Estonia</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Center for Computational and Integrative Biology</orgName>
								<orgName type="institution">Massachusetts General Hospital</orgName>
								<address>
									<postCode>02114</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kaspar</forename>
								<surname>M€ Artens</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Science</orgName>
								<orgName type="institution">University of Tartu</orgName>
								<address>
									<postCode>50409</postCode>
									<settlement>Tartu</settlement>
									<country key="EE">Estonia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kaie</forename>
								<surname>Lokk</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Institute of Molecular and Cell Biology</orgName>
								<orgName type="institution">University of Tartu</orgName>
								<address>
									<postCode>51010</postCode>
									<settlement>Tartu</settlement>
									<country>Estonia †</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sven</forename>
								<surname>Laur</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Science</orgName>
								<orgName type="institution">University of Tartu</orgName>
								<address>
									<postCode>50409</postCode>
									<settlement>Tartu</settlement>
									<country key="EE">Estonia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jaak</forename>
								<surname>Vilo</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Science</orgName>
								<orgName type="institution">University of Tartu</orgName>
								<address>
									<postCode>50409</postCode>
									<settlement>Tartu</settlement>
									<country key="EE">Estonia</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis seqlm: an MDL based method for identifying differentially methylated regions in high density methylation array data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw304</idno>
					<note type="submission">Received on December 9, 2015; revised on April 17, 2016; accepted on May 6, 2016</note>
					<note>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. *To whom correspondence should be addressed. Associate Editor: Alfonso Valencia Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: One of the main goals of large scale methylation studies is to detect differentially methylated loci. One way is to approach this problem sitewise, i.e. to find differentially methylated positions (DMPs). However, it has been shown that methylation is regulated in longer genomic regions. So it is more desirable to identify differentially methylated regions (DMRs) instead of DMPs. The new high coverage arrays, like Illuminas 450k platform, make it possible at a reasonable cost. Few tools exist for DMR identification from this type of data, but there is no standard approach. Results: We propose a novel method for DMR identification that detects the region boundaries according to the minimum description length (MDL) principle, essentially solving the problem of model selection. The significance of the regions is established using linear mixed models. Using both simulated and large publicly available methylation datasets, we compare seqlm performance to alternative approaches. We demonstrate that it is both more sensitive and specific than competing methods. This is achieved with minimal parameter tuning and, surprisingly, quickest running time of all the tried methods. Finally, we show that the regional differential methylation patterns identified on sparse array data are confirmed by higher resolution sequencing approaches. Availability and Implementation: The methods have been implemented in R package seqlm that is available through Github: https://</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>DNA methylation is an important cellular mechanism that is associated to processes like X-chromosome inactivation and genomic imprinting. It has also been related to several diseases such as diabetes, schizophrenia and cancer (<ref type="bibr" target="#b1">Baylin and Jones, 2011;</ref><ref type="bibr" target="#b12">Mill et al., 2008;</ref><ref type="bibr" target="#b18">Toperoff et al., 2012</ref>). In recent years the role of methylation in various diseases has received considerable interest from the research community. This can be attributed largely to the development of high-density methylation microarrays, like Illumina Infinium 450K, which have made affordable the characterization of genome-wide methylation patterns on large disease related cohorts. The Illumina 450K microarray covers around 20 CpG sites per gene. Such resolution reveals a spatially correlated structure of DNA methylation. Closely situated CpG sites often display almost identical methylation patterns. This feature has been seen already in the early sequencing studies (<ref type="bibr" target="#b3">Eckhardt et al., 2006</ref>) and it has been also shown that methylation is regulated in longer regions (<ref type="bibr" target="#b9">Lienert et al., 2011</ref>). While strong spatial correlation is a dominant feature in the data, common analysis methods do not take this into account. For example, differential methylation analysis is commonly performed in a sitewise manner (<ref type="bibr" target="#b11">Marabita et al., 2013;</ref><ref type="bibr" target="#b20">Wessely and Emes, 2012</ref>), thus ignoring correlations between probes. To take spatial correlations into account when performing the analysis, it is natural to search for differentially methylated regions (DMRs) instead of sites. Statistically, it could improve the sensitivity of the analysis and make the results less redundant. Biologically, differential methylation supported by multiple independent probes is less likely to represent an experimental artefact. DMR centric analysis has been performed in multiple studies (<ref type="bibr" target="#b2">Bell et al., 2012;</ref><ref type="bibr" target="#b10">Lokk et al., 2014;</ref><ref type="bibr" target="#b16">Slieker et al., 2013</ref>) and there are several tools available for it (<ref type="bibr" target="#b5">Jaffe et al., 2012;</ref><ref type="bibr" target="#b13">Pedersen et al., 2012;</ref><ref type="bibr" target="#b17">Sofer et al., 2013;</ref><ref type="bibr" target="#b19">Wang et al., 2012</ref>). However, despite the numerous tools available, there is no standard approach for DMR identification. One possibility is to use predefined regions that are based on genomic features such as gene parts or CpG islands. This has been implemented in an R package IMA (<ref type="bibr" target="#b19">Wang et al., 2012</ref>), but it has several shortcomings. Such an analysis often reveals large amount of regions that cover the same set of differentially methylated sites, while their rankings are more based on the concordance between the borders of true DMRs and predefined regions than the true extent of differential methylation. Another, a more general approach is to define the regions dynamically based on the data. One such method is Comb-p (<ref type="bibr" target="#b6">Kechris et al., 2010;</ref><ref type="bibr" target="#b13">Pedersen et al., 2012</ref>) that combines single site P-values by using sliding windows and taking into account the correlation between sites. This method operates on P-values, which makes it flexible and computationally efficient. However, the DMRs are then based on summary statistics and this may lose some information compared to modeling directly on the measurements. Also, the user must pick the minimum P-value required to start a region, and the resulting regions strongly depend on this parameter value. Maybe the most well-known method is bump hunting (<ref type="bibr" target="#b5">Jaffe et al., 2012</ref>), integrated into R package minfi (<ref type="bibr" target="#b0">Aryee et al., 2014</ref>). Essentially, it performs site-level analysis on spatially smoothed data and then applies some rules to aggregate the sites into regions. Significance of these regions is assessed using permutations. The number and nature of bumphunter results depends strongly on the effect size cutoff and smoothing window size parameters that are hard to interpret in biological terms and thus tricky to optimize. Second, due to smoothing the method is unable to detect single-site differential methylation (<ref type="bibr" target="#b5">Jaffe et al., 2012</ref>), making it less effective in sparsely covered regions. Another tool Aclust (<ref type="bibr" target="#b17">Sofer et al., 2013</ref>) defines the regions by gradually clustering the consecutive sites together. The significance of identified clusters is tested using the Generalized Estimating Equations (GEE) model. This approach relies on an even larger number of user-defined parameters, such as correlation metric, agglomeration method, correlation threshold, etc. In this article we present a novel method for identifying DMRs. Probes are grouped into regions based similarity of differential methylation profiles by using the Minimum Description Length (MDL) principle. The significance of these regions is estimated using linear mixed models. Such an information theoretic background makes the model flexible in a variety of situations without the need of extensive parameter tuning. For validation, we show that our approach is effective in finding true DMRs while appropriately controlling the number of false positives both on simulated and real methylation datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Approach</head><p>Biologically, a differentially methylated region is a rather intuitive concept—a collection of consecutive metylation sites in the DNA where the average methylation levels differ significantly between the tissues of interest. However, the intuition does not translate into clear definition that could be used for DMR finding. For example, should we prioritize DMRs that cover most CpG sites, span the largest genomic distance or exhibit the highest differential methylation. As there is no obvious biological criterion to optimize, there are many ad hoc methods for finding DMRs. From the statistical point of view, however, it is clearer what we want to achieve. We know that the dataset contains redundant information in terms of spatially correlated probes. The goal is to find a smaller set of features by combining the correlated consecutive sites into regions, while preserving the underlying signal. The resulting smaller and more independent set of features can then be used for performing differential methylation analysis. In seqlm we implement this strategy as the following three stage procedure: 1. The genome is divided into initial segments, according to the distances between consecutive CpG probes. 2. These segments are subdivided into regions, based on the differential methylation patterns. 3. For each region, the statistical significance of differential methylation is assessed.</p><p>Stages 1 and 3 are relatively straightforward to carry out, while the main novelty of the method lies in step 2. Next we introduce all the stages (illustrated in<ref type="figure" target="#fig_0">Fig. 1</ref>) one by one.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Initial segmentation</head><p>As the second step in our analysis is computationally rather intensive, we do the initial partitioning using simpler rules. CpG sites on the genome cluster into tighter groups near promoters and other functional elements and the arrays concentrate also on these regions. Thus, we do not lose much information if we identify denser regions just based on genomic location. Therefore, we have chosen 1000 bp as an upper bound for the distance between two consecutive probes to belong into one region. The exact cut-off value was determined by exploring in a large dataset (<ref type="bibr" target="#b10">Lokk et al., 2014</ref>) the relation between methylation correlation of consecutive sites and the genomic distance (<ref type="figure" target="#fig_0">Fig. 1</ref>). As expected very close pairs of probes (less than 100 bp) are highly correlated. However, when the distance is already more than 1000 bp, the preferential correlation effect seems to be diminished. Such initial segmentation creates many isolated sites and short regions, but also substantial amount of more populous segments in areas of sufficient coverage of the array. In the next step, these will be subdivided into regions according to their methylation patterns.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Refined methylation based segmentation</head><p>Given a continuous stretch of CpG probes, we want to divide this into regions with homogeneous methylation patterns with respect to our variable of interest, e.g. extent of differential methylation is constant within each segment. Let y ij denote the methylation value for sample i and site j and x i be the variable describing the samples. For two distinct groups, discrete values x i 2 f0; 1g are appropriate. If the difference between our groups of interest is constant within a segment, it is well described by a linear model:</p><formula>y ij ¼ l j þ bx i þ e ij ; (1)</formula><p>where l j is the baseline methylation level of site j and b is the average effect size within this segment. The same model can also handle continuous x i , then we are looking for regions where the variable of interest affects methylation in an consistent manner. The core of the segmentation algorithm is depicted on the middle portion of<ref type="figure" target="#fig_0">Figure 1</ref>. In a given stretch of DNA we try out all the possible segmentations of CpG probes (five of those are displayed on the<ref type="figure">figure)</ref>. For each segment, we fit the linear model (1), the coefficients are shown for the first segmentation. The optimal segmentation should prefer longer regions to shorter ones, while assuring the segment-wise linear models provide a good fit. This goal can be viewed as a model selection problem and solved using the Minimum Description Length (MDL) principle.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Minimum description length principle</head><p>The MDL principle is a way to find an optimal trade-off between the complexity of the model and its accuracy (<ref type="bibr" target="#b14">Rissanen, 1978</ref>). It states that from a collection of models M, one should choose a model that gives the shortest description of the data. More formally, let L(M) is the description length of a model M and LðDjMÞ is the description length of data D given the model M. Then one should choose</p><formula>M Ã ¼ argmin M2M LðDjMÞ þ LðMÞ f g :</formula><p>The one-to-one correspondence between probability distributions and code lengths (<ref type="bibr" target="#b4">Hansen and Yu, 2001</ref>), allows us to calculate LðDjMÞ as the negative log-likelihood of data D given model M. Thus, finding the optimal model is equivalent to maximizing a penalized log-likelihood function f ðMÞ ¼ logLðDjMÞ À LðMÞ</p><formula>(2)</formula><p>where the term L(M) measures model complexity.</p><p>The MDL principle has been successfully used in various contexts in computational biology, such as for haplotype block detection (<ref type="bibr" target="#b7">Koivisto et al., 2003</ref>) and motif discovery (<ref type="bibr" target="#b15">Ritz et al., 2009</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">Finding the optimal segmentation</head><p>To apply the MDL principle for segmentation, we must first extend a linear regression model (1) for one segment to the entire collection of segments. Let the shorthand ½s i ; e i  denote a segment of consecutive CpG sites fs i ; s i þ 1;. .. ; e i g where s i and e i represent the start and end positions of the segment. Then a segmentation S is a gapless collection of non-overlapping segments f½s 1 ; e 1 ;. .. ; ½s k ; e k g. As a result, we can characterize methylation intensities in a fixed segmentation with a piecewise linear model</p><formula>M ¼ X k i¼1 M i I ½si;ei (3)</formula><p>where I is the indicator function and M i represents the linear model (1) that is fitted to segment i. Given a segmentation S, fitting the model (3) to a region reduces to finding the least squares estimates for the linear models in each segment. Thus, it is straightforward to find the minimal penalized log-likelihood f S ðMÞ for each segmentation. See supplementary ma terial for the exact expressions of L(M) and LðDjMÞ. To minimize description length over the entire region, we can check all possible segmentations. As a result, we obtain a balance between the number of the segments and goodness of fit of the linear models. Less segments implies a smaller number of parameters in model (3) and thus decreases the term L(M). As the increase in the number of segments provides better fitting models and decreases LðDjMÞ, there exist a balance point. In practice, exhaustive search for the optimum can be avoided by first fitting the linear model (1) to every possible segment and then using dynamic programming to find best segmentation. See the sup plementary material for further details. The complexity of such algorithm grows quadratically with the number of probes in the original region. In case of Illumina 450K array this is not a problem, since the regions created in the first step are short enough. For larger, the genome is segmented based on distance between consequent probes. The boxplots show the dependence between the distance and correlation of methylation patterns. Second, the resulting segments are divided further into regions with consistent methylation profiles. Finally, the differential methylation is tested using a linear mixed model seqlmregions, one could potentially limit the complexity growth, by introducing a restriction on the number of probes in one segment. Finally, the calculations can be trivially parallelized, making them feasible even for large datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Assessing statistical significance</head><p>The previous step provides a collection of genomic regions and single sites. To identify which of these regions show condition specific methylation, we have to assess the extent of differences in methylation. As we already fitted linear models in previous step to all of the regions, we can use the same models to assess the significance of these DMRs. However, the model (1) does not take into account that nearby measurements of a same sample are highly correlated. Hence, resulting P-values are greatly inflated. To take these correlations into account, we must add a sample specific methylation baseline b i $ N ð0; r 2 b Þ to the model (1). The resulting linear mixed model</p><formula>y ij ¼ l j þ bx i þ b i þ e ij ; (4)</formula><p>distinguishes sample-and condition-based effects. Interestingly, the extra term in the model (4) does not change the estimate of b compared to (1), but adjusts the respective P-values appropriately. Finally, these P-values must be adjusted for multiple testing. In general, using the same variable x i for finding segmentation and assessing the significance of regions can inflate P-values. For example, selecting region boundaries based on strength of differential methylation or removing 'less-promising' regions would immediately introduce bias. However, in our approach, the second stage maximizes coherence of the regions rather than differential methylation and we do not select regions before applying model (4). As a result, the method does not introduce false positive findings (see also<ref type="figure" target="#tab_1">Table 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>We demonstrate the utility of seqlm method in three parts. First, we study the statistical properties and performance of seqlm and other methods on simulated data. Second, we apply the methods to a large public methylation dataset covering 17 different tissues. In all cases we compare seqlm with bumphunter, Aclust, Comb-p and IMA. Finally, we validate several DMRs that were identified using seqlm on Illumina 450K chip data with Sanger sequencing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Simulation study</head><p>To study sensitivity and specificity of the DMR finding algorithms we need a dataset where we know true differential methylation patterns. For that we permuted labels on a real dataset and introduced differential methylation by changing methylation levels inside specific regions (see Section 4 for further details). This allowed us to preserve much of the structure of the original data, but at the same time introduce controlled variation into it. Without introducing any differential methylation, this schema was effective in generating data that was distributed according to the null hypothesis—the sitewise t-test P-values follow expected uniform distribution. To test our algorithm, we run all DMR finding algorithms on the simulated data, using FDR 0.05 as a cutoff. After that we counted the number of true and false positive results. If a detected DMR overlapped with a region where we inserted differential methylation, we classified this as a true positive, otherwise as a false positive. The results can be seen in<ref type="figure" target="#tab_1">Table 1</ref>. Each row corresponds to a different l value which represents the average generated effect size between the two groups. The columns show the number of detected regions or number of sites within them. Together with the true and false positives we also show the number of missed regions and sites.The first row serves as a check on the statistical validity of the algorithms, as we do not expect to find any DMRs for l ¼ 0. Neither bumphunter or seqlm find any DMRs in this case. Overall, the number of regions bumphunter identifies is an order of magnitude smaller compared to other methods, even with very large effect sizes. On the other hand, Aclust identifies 87 significant regions that cover 255 sites for the first row. This indicates, that the Generalised Estimating Equations (GEE) model used by Aclust, combined with the FDR correction, might be inappropriate for this type of data. Moreover, the proportion of false positive sites stays considerably higher than the expected 5% even if we introduce differential methylation. Interestingly, with Comb-p the number of false positives is not high overall, but there are several of them even if the dataset does not contain any signal. Thus, both Comb-p and Aclust can return too many false positives, especially, when the signal in the data is weak. Even if the number of true positive sites is comparable, it is still consistently lower than for seqlm. In terms of sensitivity, the performance of seqlm is comparable to Aclust and Comb-p. For higher effect sizes, it finds consistently larger number of true positive sites, while keeping the number of false positives below 5% for most cases. The comparison with the IMA package is more complicated, since IMA outputs overlapping results. For example, significantly differentially methylated region can partially overlap with several CpG islands, exons, promoters and other functionally relevant regions. Thus for the IMA results we calculated two sets of true and false positive values: for all and for unique results. The results for IMA are given in Supplementary Table 1. In brief, the IMA package finds the same order of magnitude of unique sites and regions as Aclust and seqlm without exceeding 5% threshold for false positives. The main problem with IMA is that on average each site is reported as a member of two regions, but in many cases few differentially methylated sites can drive the significance of tens of regions. One could merge the overlapping significant regions as we did, but this would lose the interpretability of the results. To summarize, seqlm displays the most sensitivity and specificity among the four alternative algorithms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Comparisons on the 17 tissues data</head><p>As a more practical comparison, we also applied all DMR finding methods also on a real dataset that describes methylation in 17 tissues. We searched for DMRs specific to single tissues and performed sitewise t-test as a comparison. The numbers of significant regions and sites covered by those is given in<ref type="figure" target="#tab_2">Table 2</ref>. The results are consistent with the simulation study. Bumphunter is finding a significantly smaller number of DMRs than Aclust, Comb-p or seqlm. Compared to the single site analysis, seqlm consistently identifies 10–15% more differentially methylated sites. As the single site analysis can be considered a good baseline, we can see that the seqlm algorithm does not pick up spurious signals. Instead, it gives roughly the same set of sites grouped into fewer regions. The behaviour of Aclust and Comb-p is less consistent. In some cases, the number of reported sites of Aclust is several times higher than for single site t-test. In other occasions, the numbers are more comparable but always higher. Given the over-sensitivity of Aclust we showed on simulated data, such differences are rather suspicious and are likely to contain more than 5% false positives. Comb-p, in turn, seems to find many regions in comparisons where other methods do not find much and less in other comparisons with stronger signals. When considering length of the identified regions we can also see slight differences. Supplementary<ref type="figure" target="#fig_0">Figure S1</ref>details the length distribution of all regions with at least 2 sites in<ref type="figure" target="#tab_2">Table 2</ref>. Bumphunter tends to identify the longest regions and does not return almost any regions with less than 3 sites, as the length of the region is also an important criterion in region selection. In other cases the distribution was more skewed towards short regions with Aclust giving the shortest and seqlm and combp giving slightly longer correspondingly. In summary, seqlm seems to give a consistent improvement over single site analysis without returning a suspiciously high amount of differentially methylated sites.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Validation of identified DMRs</head><p>While the 450K sites on Illumina methylation arrays represent a marked improvement over previous technologies, they still represent only 1.5% of the 29M CpG sites on the genome. Thus, it is not a priori clear that DMR-s inferred from such low-resolution measurements reflect biological reality and are not technical artifacts. To address this concern, we have validated 14 of the DMR-s identified in<ref type="figure" target="#tab_2">Table 2</ref>using Sanger sequencing.<ref type="figure">Figure 2A</ref>shows an example of such a validation. We can see that there is good overlap between the results of two approaches atthe sites that are measured by both. More importantly, the differential methylation pattern identified on the array level can also be observed at the intermediate sites.<ref type="figure">Figure 2B</ref>summarizes the results for all 14 regions by showing the estimated effect sizes from both array and Sanger sequencing data. We can see that differential methylation of all the regions is confirmed on the higher resolution. Moreover, the effect sizes from array and Sanger measurements are well correlated. In 6 cases out of 14 the effect size, seen independently from Sanger measurements, is within the confidence intervals of the array based estimate. All together the data shows that DMRs identified on array data adequately represent the underlying methylation patterns on single site resolution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Implementation and performance</head><p>Our method has been implemented in an R package seqlm, freely available through Github: https://github.com/raivokolde/seqlm. The method is not specific to the Illumina 450k methylation array and can be used with many other arrays. For example the code can be easily used for analyzing tiling array data. The performance of seqlm is sufficient to analyze any array based dataset on ordinary laptop computers. Moreover, as the implementation supports multi-core computations, it is possible to speed up the analysis on dedicated computation servers. To compare running time with competitors, we ran seqlm together with bumphunter and Aclust on our simulated dataset. Surprisingly, seqlm was the fastest of the three (Supplementary<ref type="figure" target="#tab_2">Table S2</ref>). Using multiple cores it is possible to improve the performance of seqlm and bumphunter, but not Aclust.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Datasets</head><p>For demonstrative purposes, we have used a large publicly available methylation dataset on Illumina 450k platform (GSE50192). There, the methylation of 17 tissues from four autopsied humans has been measured.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Data simulation</head><p>To simulate data while retaining most of the characteristics of a real methylation dataset, we have permuted a subset of the 17 tissues data. To obtain data with relatively homogeneous patterns, we chose the subset consisting of a total of 16 samples: coronary artery, splenic artery, thoracic aorta and abdominal aorta. We selected a set of similar tissues to avoid encountering a rather strong signal in the permuted data by chance. To start we split the genome into smaller pieces that have properties as follows. First, the genomic distances between consecutive sites remain below 1000 bp within each piece. Second, the correlation between all consecutive sites within each piece is above a threshold of 0.1. The aim of these choices was to extract those locations from the data where the methylation patterns are reasonably similar. As a result, we obtain 250 000 pieces with length greater than one, with average length 3.8 sites. For each piece, we assign the group labels randomly such that we would have eight samples in one group and eight in another. As a result, we get the data where on average there is no group effect, the single site P-values are following closely the uniform distribution. Finally, we choose randomly N ¼ 5000 pieces with length greater than 1 (with probability proportional to length) and change them into DMRs, by increasing the values in one group by b $ Log À N ðln l; 0:1 2 Þ. We varied l in f0; 0:025; 0:05; 0:075; 0:10 ; 0:15; 0:20g.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Parameters for tested methods</head><p>While comparing seqlm to other methods which require several input parameters, we either used the default values or the ones recommended in the original publication. For all methods except for bumphunter, we defined significant differential methylation with FDR corrected P-values below the threshold 0.05. As bumphunter does not divide the genome into regions and rather searches for DMRs, one cannot use FDR correction, so instead we used its reported familywise error rate with threshold 0.10, which was also used in<ref type="bibr" target="#b5">Jaffe et al. (2012)</ref>. For bumphunter the parameters used were: pickCutoffQ ¼ 0.99, maxGap ¼ 1000 and smooth ¼ TRUE (as suggested by<ref type="bibr" target="#b5">Jaffe et al., 2012</ref>). For Aclust,we used the 'best' configuration of the parameters reported in<ref type="bibr" target="#b17">Sofer et al. (2013)</ref>, i.e. Spearman correlation, average distance clustering, distance cutoff 0.2, and 999-base-pair-merge. For comb-p, we used P-value threshold of 0.05 for candidate regions.<ref type="figure">Fig. 2</ref>. Validation of identified DMR-s. Panel A has an example from the tissue dataset together with a DMR detected by seqlm (large grey box). The top plot shows the data on array resolution and in bottom plot a portion of the DMR has been zoomed in, and methylation levels of intermediate CpG sites obtained by Sanger sequencing are shown. Panel B shows the effect sizes that are estimated from array data and from Sanger sequencing data for all 14 regions. The 95% confidence intervals are shown for both sources of estimates</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>0.75</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Sanger sequencing</head><p>For validation we selected 14 DMR-s that were tissue specific, showed large effect size and where it was possible to design primers. Primers for PCR amplification of the bisulfite-treated DNA were designed using MethPrimer (<ref type="bibr" target="#b8">Li and Dahiya, 2002</ref>at 72 C, with a final-0.5 C /cycle step-down gradient over 21 cycles of 30 s at 95 C, 30 s at 52 C and 120 s at 72 C. The sequencing results were analyzed with Mutation Surveyor software (Softgenetics, State College, PA, USA).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Discussion</head><p>The method as defined in this article opens up a number of future directions for development. The current model can also handle continuous variables in addition to the two groups of data. Thus, it is possible to use seqlm to search for methylation quantitative trait loci (meQTLs). In such analysis, even small improvements in statistical power can have huge consequences. The method can be generalized to handle raw sequencing data with methylation counts instead of aggregated methylation values. For that we must replace linear regression with logistic regression. The change only alters the model fitting inside fixed region and not the core of the dynamic programming routine. The MDL framework underlying seqlm is a powerful way to identify genomic regions. By employing different statistical models it is possible to specify the properties of the desired regions. For example one can include more sophisticated linear models to test more complex hypotheses or use clustering methods instead, to perform unsupervised region finding.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Conclusion</head><p>We presented a novel approach for DMR identification, described as a three-stage process. First, the data is divided into smaller segments based on genomic distance between consecutive probes. Then, each of these segments is divided into regions with consistent differential methylation patterns. For this, all possible segmentations are considered and the optimal one is chosen according to the MDL principle. Finally, the significance of differential methylation in each region is assessed using linear mixed models. In our algorithm, the latter two steps are naturally related as both the segmentation and assessing the statistical significance are based on the b parameter. We showed that seqlm performs well on simulated data, being both more sensitive and more specific than the alternative methods. On a real dataset we can see that DMRs found by seqlm cover more sites than other methods while controlling the Type I error rate. At the same time, the redundancy within the results is smaller as the close sites are reported together. Finally, we validated 14 DMRs using Sanger sequencing and managed to show good correlation between the array and sequencing based estimates of differential methylation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>The research is funded by Estonian Research Council<ref type="bibr">[IUT34-4]</ref>and European Regional Development Fund through the EXCS and BioMedIT projects. Conflict of Interest: none declared.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Method workflow. First, the genome is segmented based on distance between consequent probes. The boxplots show the dependence between the distance and correlation of methylation patterns. Second, the resulting segments are divided further into regions with consistent methylation profiles. Finally, the differential methylation is tested using a linear mixed model</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>For</head><figDesc>each method and for each l, total number of the detected regions and the corresponding number of sites has been given (divided into true and false positives, 'TP' and 'FP'), together with the the number of missed regions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Detected DMRs in the simulation study with 5000 generated DMRs, with an average effect size l</figDesc><table>Bumphunter 
Aclust 

TP 
FP 
missed 
TP 
FP 
missed 

M 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 

0.0 
0 
0 
0 
0 
0 
0 
0 
0 
87 
255 
0 
0 
0.025 
0 
0 
0 
0 
5000 
28697 
1568 
6385 
352 
1273 
3464 
18545 
0.050 
1 
36 
0 
0 
4999 
28946 
3241 
15485 
537 
1980 
1947 
8903 
0.075 
5 
174 
0 
0 
4994 
28958 
4039 
20952 
581 
2068 
1213 
5067 
0.10 
18 
788 
0 
0 
4978 
28486 
4423 
24077 
619 
2158 
810 
3047 
0.15 
33 
1401 
0 
0 
4956 
28079 
4642 
26681 
646 
2254 
456 
1656 
0.20 
63 
2046 
0 
0 
4930 
26652 
4715 
26771 
641 
2224 
356 
1002 

comb-p 
seqlm 

TP 
FP 
missed 
TP 
FP 
missed 

M 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 

0.0 
0 
0 
71 
555 
0 
0 
0 
0 
0 
0 
0 
0 
0.025 
979 
6005 
61 
506 
3967 
21005 
1004 
4792 
65 
330 
3941 
22803 
0.050 
2353 
15518 
40 
295 
2538 
11540 
3014 
15713 
172 
862 
1988 
11079 
0.075 
3237 
20921 
29 
181 
1632 
6731 
4060 
21450 
201 
1027 
1055 
5892 
0.10 
3686 
23897 
28 
169 
1169 
4475 
4626 
24649 
232 
1241 
591 
3514 
0.15 
4140 
26599 
23 
158 
689 
2343 
5082 
27137 
257 
1373 
252 
1734 
0.20 
4360 
27005 
27 
185 
467 
1388 
5280 
27457 
263 
1354 
112 
917 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 2. For each approach, the number of significant DMRs and the corresponding number of sites has been given</figDesc><table>Single site 
Bumphunter 
Aclust 
Comb-p 
seqlm 

# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 
# regions 
# sites 

Lymph node versus others 
58 
1 
4 
2543 
6943 
93 
564 
21 
61 
Gall bladder versus others 
2875 
5 
99 
6585 
16054 
722 
3062 
1359 
2758 
Gastric mucosa versus others 
23359 
2 
64 
16661 
26494 
2663 
25248 
5218</table></figure>

			<note place="foot">R.Kolde et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Minfi: a flexible and comprehensive bioconductor package for the analysis of infinium DNA methylation microarrays</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Aryee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="1363" to="1369" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">A decade of exploring the cancer epigenomebiological and translational implications</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">B</forename>
				<surname>Baylin</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Jones</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Cancer</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="726" to="734" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Epigenome-wide scans identify differentially methylated regions for age and age-related phenotypes in a healthy ageing population</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Bell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">1002629</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Dna methylation profiling of human chromosomes 6, 20 and 22</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Eckhardt</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="1378" to="1385" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Model selection and the principle of minimum description length</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">H</forename>
				<surname>Hansen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Yu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Stat. Assoc</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="page" from="746" to="774" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Bump hunting to identify differentially methylated regions in epigenetic epidemiology studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">E</forename>
				<surname>Jaffe</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Epidemiol</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="200" to="209" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Generalizing moving averages for tiling arrays using combined p-value statistics</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">J</forename>
				<surname>Kechris</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">29</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">An MDL method for finding haplotype blocks and for estimating the strength of haplotype block boundaries</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Koivisto</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pac. Symp. Biocomput</title>
		<imprint>
			<biblScope unit="page" from="502" to="513" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Methprimer: designing primers for methylation pcrs</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">C</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Dahiya</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1427" to="1431" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Identification of genetic elements that autonomously determine DNA methylation states</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Lienert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="page" from="1091" to="1097" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">DNA methylome profiling of human tissues identifies global and tissue-specific methylation patterns</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Lokk</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">54</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">An evaluation of analysis pipelines for DNA methylation profiling using the illumina humanmethylation450 beadchip platform</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Marabita</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epigenetics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">333</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Epigenomic profiling reveals DNA-methylation changes associated with major psychosis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Mill</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Hum. Genet</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="page" from="696" to="711" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Comb-p: software for combining, analyzing, grouping and correcting spatially correlated P/i-values</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">S</forename>
				<surname>Pedersen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="2986" to="2988" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Modeling by shortest data description</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rissanen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Automatica</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="465" to="471" />
			<date type="published" when="1978" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Discovery of phosphorylation motif mixtures in phosphoproteomics data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ritz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="14" to="21" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Identification and systematic annotation of tissuespecific differentially methylated regions using the illumina 450k array</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">C</forename>
				<surname>Slieker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epigenet. Chromatin</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">26</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">A-clustering: a novel method for the detection of coregulated methylation regions, and regions associated with exposure</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Sofer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2884" to="2891" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Genome-wide survey reveals predisposing diabetes type 2-related DNA methylation variations in human peripheral blood</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Toperoff</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Mol. Genet</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="371" to="383" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">IMA: an r package for high-throughput analysis of illumina&apos;s 450k infinium methylation data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="729" to="730" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Identification of DNA methylation biomarkers from infinium arrays</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Wessely</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">D</forename>
				<surname>Emes</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Genet</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">seqlm</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>