
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:59+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">ProtTest 3: fast selection of best-fit models of protein evolution</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Diego</forename>
								<surname>Darriba</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biochemistry, Genetics and Immunology</orgName>
								<orgName type="institution">University of Vigo</orgName>
								<address>
									<postCode>36310</postCode>
									<settlement>Vigo</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Electronics and Systems</orgName>
								<orgName type="department" key="dep2">Computer Architecture Group</orgName>
								<orgName type="institution">University of A Coruña</orgName>
								<address>
									<postCode>15071 A</postCode>
									<settlement>Coruña</settlement>
									<country key="ES">Spain</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Guillermo</forename>
								<forename type="middle">L</forename>
								<surname>Taboada</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Electronics and Systems</orgName>
								<orgName type="department" key="dep2">Computer Architecture Group</orgName>
								<orgName type="institution">University of A Coruña</orgName>
								<address>
									<postCode>15071 A</postCode>
									<settlement>Coruña</settlement>
									<country key="ES">Spain</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ramón</forename>
								<surname>Doallo</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of Electronics and Systems</orgName>
								<orgName type="department" key="dep2">Computer Architecture Group</orgName>
								<orgName type="institution">University of A Coruña</orgName>
								<address>
									<postCode>15071 A</postCode>
									<settlement>Coruña</settlement>
									<country key="ES">Spain</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">David</forename>
								<surname>Posada</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biochemistry, Genetics and Immunology</orgName>
								<orgName type="institution">University of Vigo</orgName>
								<address>
									<postCode>36310</postCode>
									<settlement>Vigo</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">ProtTest 3: fast selection of best-fit models of protein evolution</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">8</biblScope>
							<biblScope unit="page" from="1164" to="1165"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr088</idno>
					<note>[09:25 26/3/2011 Bioinformatics-btr088.tex] Page: 1164 1164–1165 Associate Editor: Martin Bishop Contact: dposada@uvigo.es Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We have implemented a high-performance computing (HPC) version of ProtTest that can be executed in parallel in multicore desktops and clusters. This version, called ProtTest 3, includes new features and extended capabilities. Availability: ProtTest 3 source code and binaries are freely available under GNU license for download from http://darwin.uvigo.es/ software/prottest3, linked to a Mercurial repository at Bitbucket (https://bitbucket.org/).</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Recent advances in modern sequencing technologies have resulted in an increasing capability for gathering large datasets. Long sequence alignments with hundred or thousands of sequences are not rare these days, but their analysis imply access to large computing infrastructures and/or the use of simpler and faster methods. In this regard, high-performance computing (HPC) becomes essential for the feasibility of more sophisticated—and often more accurate— analyses. Indeed, during the last years HPC facilities have become part of the general services provided by many universities and research centers. Besides, multicore desktops are now standard. The program ProtTest (<ref type="bibr" target="#b0">Abascal et al., 2007</ref>) is one of the most popular tools for selecting models of amino acid replacement, a routinary step in phylogenetic analysis. ProtTest is written in Java and uses the program PhyML (<ref type="bibr" target="#b4">Guindon and Gascuel, 2003</ref>) for the maximum likelihood (ML) estimation of model parameters and phylogenetic trees and the PAL library (<ref type="bibr" target="#b2">Drummond and Strimmer, 2001</ref>) to handle alignments and trees. Statistical model selection can be a very intensive task when the alignments are large and include divergent sequences, highlighting the need for new bionformatic tools capable of exploiting the available computational resources. Here we describe a new version of ProtTest, ProtTest 3, that has been completely redesigned to take advantage of HPC environments and desktop multicore processors, significantly reducing the execution time for model selection in large protein alignments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">PROTTEST 3</head><p>The general structure and the Java code of ProtTest has been completely redesigned from a computer engineering point of view. * To whom correspondence should be addressed.</p><p>We implemented several parallel strategies as distinct execution modes in order to make an efficient use of the different computer architectures that a user might encounter:</p><p>(1) A Java thread-based concurrence for shared memory architectures (e.g. a multicore desktop computer or a multicore cluster node). This version also includes a new and richer graphical user interface (GUI) to facilitate its use.</p><p>(2) An MPJ (<ref type="bibr" target="#b6">Shafi et al., 2009</ref>) parallelism for distributed memory architectures (e.g. HPC clusters).</p><p>(3) A hybrid implementation MPJ-OpenMP (<ref type="bibr" target="#b1">Dagum and Menon, 1998</ref>) to obtain maximum scalability in architectures with both shared and distributed memory (e.g. multicore HPC clusters). Moreover, ProtTest 3 includes a number of new and more comprehensive features: (i) more flexible support for different input alignment formats through the use of the ALTER library (<ref type="bibr" target="#b3">Glez-Peña et al., 2010</ref>): ALN, FASTA, GDE, MSF, NEXUS, PHYLIP and PIR; (ii) up to 120 candidate models of protein evolution; (iii) four strategies for the calculation of likelihood scores: fixed BIONJ, BIONJ, ML or user defined; (iv) four information criteria: AIC, BIC, AICc and DT (see Sullivan and Joyce 2005); (v) reconstruction of model-averaged phylogenetic trees (<ref type="bibr" target="#b5">Posada and Buckley, 2004</ref>); (vi) fault tolerance with checkpointing; and (vii) automatic logging of the user activity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">PERFORMANCE EVALUATION</head><p>In order to benchmark the performance of ProtTest 3, we computed the running times for the estimation of the likelihood scores of all 120 candidate models from several real and simulated protein alignments (<ref type="figure">Table 1</ref>). When these data were executed in a system with shared memory, e.g. a multicore desktop, the scalability was almost linear as far as there was enough memory to satisfy the requirements. For example, in a shared memory execution in a 24-core node the speedup was almost linear with up to 8 cores, also scaling well with datasets with medium complexity, like HIVML or COXML (<ref type="figure" target="#fig_0">Fig. 1</ref>). In a system with distributed memory like an cluster, the application scaled well up to 56 processors (<ref type="figure" target="#fig_1">Fig. 2</ref>). With more processors, a theoretical scalability limit exists due to the hetereogeneous nature of the optimization times, from a few seconds for the simplest models to up to several hours for the models that include rate variation among sites (+G). This problem was solved with the hybrid memory approach. In this case, the scalability went beyond the previous limit, reaching up to 150 in the most complex cases with 8-core nodes (<ref type="figure" target="#fig_2">Fig. 3</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ProtTest 3</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">CONCLUSIONS</head><p>ProtTest 3 can be executed in parallel in HPC environments as: (i) a GUI-based desktop version that uses multicore processors; (ii) a cluster-based version that distributes the computational load among nodes; and (iii) as a hybrid multicore cluster version that achievesspeed through the distribution of tasks among nodes while taking advantage of multicore processors within nodes. The new version has been completely redesigned and includes new capabilities like checkpointing, additional amino acid replacement matrices, new model selection criteria and the possibility of computing modelaveraged phylogenetic trees. The use of ProtTest 3 results in significant performance gains, with observed speedups of up to 150 on a high performance cluster. In this way, statistical model selection for large protein alignments becomes feasible, not only for cluster users but also for the owners of standard multicore desktop computers. Moreover, the flexible design of ProtTest-HPC will allow developers to extend future functionalities, whereas thirdparty projects will be able to easily adapt its capabilities to their requirements.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Speed-ups obtained with the shared memory version of ProtTest 3 according to the numbers of threads used in a 24-core shared memory node (4 hexa-core Intel Xeon E7450 processors) with 12 GB memory.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Speed-ups obtained with the distributed memory version of ProtTest 3 according to the numbers of cores used in a 32-node cluster with 2 quad-core Intel Harpertown processors and 8 GB memory per node. Up to 4 processes were executed per node because of the memory requirements of the largest datasets (10K, 20K, 100K).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. Speed-ups obtained with the hybrid memory version of ProtTest 3 according to the numbers of cores used in the same 32-node cluster as Fig. 2. Up to 4 MPJ Express processes per node and at least 2 OpenMP threads for each ML optimization were executed.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Real and simulated alignments analyzed</figDesc><table>Dataset 
Protein 
Size 
Base tree 
Sequence 
Abbreviation 
N × L 
execution time 

RIB 
Ribosomal 
21 × 113 Fixed BIONJ 5.5 min 
protein 
RIBML 
 "  
 "  
ML tree 
28 min 
COX 
Cytochrome C 28 × 113 Fixed BIONJ 9.5 min 
oxidase II 
COXML 
 "  
 "  
ML tree 
55 min 
HIV 
HIV polimerase 36 × 1,034 Fixed BIONJ 44 min 
HIVML 
 "  
 "  
ML tree 
160 min 
10K 
Simulated aln 50 × 10K Fixed BIONJ 9.2 h 
20K 
 "  
50 × 20K  "  
24.5 h 
100K 
 "  
50 × 100K  "  
80 h 

N indicates the number of sequences and L the length of the alignment. Base tree is the 
tree used likelihood optimization and Seq. exec. time is the time required to calculate 
the likelihood scores using the sequential version (i.e. a single thread). 

</table></figure>

			<note place="foot">© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [09:25 26/3/2011 Bioinformatics-btr088.tex]</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>Special thanks to Stephane Guindon and to Federico Abascal for their help.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">ProtTest: selection of best-fit models of protein evolution</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Abascal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="1104" to="1105" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">OpenMP: an industry-standard API for shared-memory programming</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Dagum</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Menon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Comput. Sci. Eng</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="46" to="55" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Pal: an object-oriented programming library for molecular evolution and phylogenetics</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Drummond</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Strimmer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="662" to="663" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">ALTER: program-oriented conversion of DNA and protein alignments</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Glez-Peña</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="14" to="18" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Suppl. . 2</note>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Guindon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Gascuel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="page" from="696" to="704" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Model selection and model averaging in phylogenetics: advantages of akaike information criterion and bayesian approaches over likelihood ratio tests</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Posada</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">R</forename>
				<surname>Buckley</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="793" to="808" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Nested parallelism for multi-core HPC systems using Java</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Shafi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Parallel Distr. Com</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="page" from="532" to="545" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Model selection in phylogenetics</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Sullivan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Joyce</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annu. Rev. Ecol. Evol. S</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="445" to="466" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>