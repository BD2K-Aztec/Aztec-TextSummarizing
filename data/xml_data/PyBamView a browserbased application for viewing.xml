
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:30+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis PyBamView: a browser-based application for viewing short read alignments</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Melissa</forename>
								<surname>Gymrek</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">Whitehead Institute for Biomedical Research</orgName>
								<address>
									<addrLine>9 Cambridge Center</addrLine>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">Harvard-MIT Division of Health Sciences and Technology</orgName>
								<orgName type="institution" key="instit2">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Program in Medical and Population Genetics</orgName>
								<orgName type="institution">Broad Institute of MIT and Harvard</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis PyBamView: a browser-based application for viewing short read alignments</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">23</biblScope>
							<biblScope unit="page" from="3405" to="3407"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu565</idno>
					<note type="submission">Received on May 26, 2014; revised on July 27, 2014; accepted on August 14, 2014</note>
					<note>Associate Editor: Gunnar Ratsch Contact: mgymrek@mit.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Current sequence alignment browsers allow visualization of large and complex next-generation sequencing datasets. However, most of these tools provide inadequate display of insertions and can be cumbersome to use on large datasets. I implemented PyBamView, a lightweight Web application for visualizing short read alignments. It provides an easy-to-use Web interface for viewing alignments across multiple samples, with a focus on accurate visualization of insertions. Availability and Implementation: PyBamView is available as a standard python package. The source code is freely available under the MIT license at https://mgymrek.github.io/pybamview.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The rapid growth of next-generation sequencing (NGS) technologies has led to a wide variety of short read DNA datasets. Manual inspection of sequence alignments is an important aspect of quality control. While the majority of NGS analyses have focused on single nucleotide polymorphisms (SNPs), recent bioinformatics advances allow analysis of more complicated variants, such as small insertions or deletions (<ref type="bibr" target="#b7">Montgomery et al., 2013</ref>), larger structural variants (<ref type="bibr" target="#b9">Ye et al., 2009</ref>) and short tandem repeats (<ref type="bibr" target="#b3">Gymrek et al., 2012;</ref><ref type="bibr" target="#b4">Highnam et al., 2013</ref>). Furthermore, widely used genome engineering techniques, such as the CRISPR-Cas9 system (<ref type="bibr" target="#b0">Cong et al., 2013</ref>) can often produce a wide range of complex variants. In these cases, visualization of insertion and deletion events is a particularly critical analysis step. Current genome browsers, such as the UCSC Genome Browser (<ref type="bibr" target="#b5">Kent et al., 2002</ref>) and the Integrative Genomics Viewer (IGV) (<ref type="bibr" target="#b8">Robinson et al., 2011</ref>), offer visualization of alignments from SAM/BAM files across multiple samples and integration of many layers of genomics datasets. However, most existing tools have two important limitations. First, most are based on alignments to an ungapped reference sequence, which provides inadequate visualization of insertions. The SAM specification supports a padded reference, which captures multiple sequence alignment information and results in accurate insertion display by most browsers. However, most BAM files consist of pairwise alignments of short reads to a reference and do not use this feature. As a result, insertions are represented by an icon such as a vertical bar, which does not provide any visual information about the size or sequence of the inserted nucleotides. Second, the majority of alignment browsers are cumbersome to use, especially to visualize the large datasets typical of NGS experiments. They either require that the user upload large data files to a remote server or involve complicated installation and large resource requirements to run locally. Several alignment browsers, such as Bambino (<ref type="bibr" target="#b1">Edmonson et al., 2011</ref>), Consed (<ref type="bibr" target="#b2">Gordon and Green, 2013</ref>) and the text-based SAMtools (<ref type="bibr" target="#b6">Li et al., 2009</ref>) tview, overcome these limitations: they display the sequence of insertions even when using the standard ungapped reference, and are run locally with relatively low system requirements. However, tview does not allow the user to view multiple BAM files at once, and none of these tools allow for exporting alignments as snapshots or for sharing alignments remotely through a Web browser. Here, I present PyBamView, a lightweight Web application for viewing alignments from BAM files. PyBamView provides alignment visualizations that accurately represent SNP, insertion and deletion events that can easily be exported to create publicationready figures. It runs locally from the command line with minimal resource requirements and displays alignments in a Web browser. This interface allows users to quickly view alignments locally and to easily share alignments with local or remote collaborators.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">BASIC USAGE AND FEATURES</head><p>PyBamView is a Python-based Web application that is run from the command line. Users provide PyBamView with a directory containing indexed BAM files and an optional reference genome in fasta format:the URL with remote collaborators or as a public resource. For instance, adding the options-ip 0.0.0.0-port 5000 will serve PyBamView over port 5000 via http. The Supplementary Text and program Web site contain a complete description of this feature. The Web browser displays a list of all samples contained in the BAM files provided. Users can select one or more samples to open in the genome-browser view. This consists of a reference track, followed by collapsible alignment tracks containing reads for each sample. While there is theoretically no limit to the number of samples analyzed, PyBamView can reasonably display five low to moderate coverage samples at once. Users can navigate to the genomic region of interest by entering the genomic coordinate into the search bar (e.g. chr1:10000). In the default view, base pair differences from the reference genome are highlighted, allowing easy identification of SNPs and potential sequencing errors (<ref type="figure">Fig. 1a</ref>). A deleted base pair is indicated by a '.' in the alignment, and an insertion as a '.' in the reference sequence (<ref type="figure">Fig. 1b</ref>). This allows easy visualization of the sequence and size of inserted bases, which is not currently possible with most alignment browsers (Supplementary<ref type="figure">Fig. S1</ref>). Users can zoom out up to 100Ã‚ to easily visualize large insertions or deletions spanning hundreds or thousands of bases. Additional features are described in the Supplementary Text.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">EXAMPLE USE CASES</head><p>Alignment visualization is a critical step of any sequencing experiment. Here, I show three examples where PyBamView provides useful visualization of sequence variants. Use cases are not limited to these examples and can theoretically include any '-seq' experiment that can be represented by a BAM file. First, it provides accurate visualizations of different length insertions, such as different alleles of a tandem repeat (Supplementary<ref type="figure">Fig. S2a</ref>). Furthermore, zooming out allows for visualization of large repeat expansions, such as a 60bp CAG expansion in Huntington's Disease (Supplementary<ref type="figure">Fig.  S2b</ref>, simulated 250bp reads). Second, it can be used to analyze variation across samples. This is useful in such analyses as comparing matched tumor versus normal samples or looking for mutations in affected versus non-affected individuals in disease genetic studies. Supplementary<ref type="figure">Figure S3</ref>shows example comparisons of individuals at a SNP, small insertion and a large deletion spanning several kb. Third, it can visualize complex mutations generated by genome engineering technologies such as CRISPR-Cas9 (<ref type="bibr" target="#b0">Cong et al., 2013</ref>). Dissecting these mutations requires adequate visualization of indels. An example alignment from a CRISPR library is shown in Supplementary<ref type="figure">Figure S4</ref>.<ref type="figure">Fig. 1</ref>. PyBamView display of sequence variants. In each figure, the reference sequence is shown at the top followed by alignments of each read. Alignments were generated by PyBamView's PDF export feature. (a) Mismatches from the reference sequence, due to either SNPs or sequencing errors, are shown as highlighted bases. (b) Insertions are shown as gaps in the reference, which allows the length and sequence of the insertion to be easily visualized</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>pybamview â€“â€“bamdir DIRECTORY/WITH/BAMS â€“â€“ref REF.fa PyBamView will start a small Web server that can be accessed locally in a Web browser. Optional arguments can serve the application over a different address, for instance, for sharing ÃŸ The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</figDesc><table></table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="4"> IMPLEMENTATION PyBamView is implemented as a Python-based Web application using the Flask library. Alignments are processed using a Python backend, which then generates HTML, Cascading Style Sheets (CSS) and JavaScript files that are displayed in the Web browser. PyBamView takes advantage of BAM and fasta indexing to avoid loading large files into memory. It uses the pysam and pyfasta libraries for parsing BAM and fasta files, respectively. Both libraries use efficient index data structures, which allow them to quickly fetch data from specific genomic regions of interest. Read alignments are parsed from the CIGAR strings in the BAM file and are displayed as simple HTML tables as Scalable Vector Graphics (SVG) elements using Javascript. All CIGAR options reported in the SAM specification, including the padded reference option, are supported (Supplementary Fig. S5). 5 CONCLUSION As the use of NGS to analyze complex genomic events grows, there is a critical need for accurate and easy-to-use visualization tools. PyBamView provides a simple, yet powerful, interface for alignment visualization that facilitates collaborative data analysis.</note>

			<note place="foot">M.Gymrek at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">PyBamView at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The author would like to acknowledge members of the Erlich lab, Alon Goren, and Roy Ronen for helpful feedback, and Assaf Gordon for valuable programming guidance.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Multiplex genome engineering using CRISPR/Cas systems</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Cong</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">339</biblScope>
			<biblScope unit="page" from="819" to="823" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Bambino: a variant detector and alignment viewer for next-generation sequencing data in the SAM/BAM format</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">N</forename>
				<surname>Edmonson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="865" to="866" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Consed: a graphical editor for next-generation sequencing</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Gordon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Green</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2936" to="2937" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">lobSTR: a short tandem repeat profiler for personal genomes</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gymrek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="1154" to="1162" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Accurate human microsatellite genotypes from highthroughput resequencing data using informed error profiles</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Highnam</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page">32</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The human genome browser at UCSC</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="996" to="1006" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">The sequence alignment/map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">The origin, evolution, and functional impact of short insertion-deletion variants identified in 179 human genomes</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">B</forename>
				<surname>Montgomery</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="749" to="761" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Integrative genomics viewer</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Robinson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="24" to="26" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Pindel: a pattern growth approach to detect break points of large deletions and medium sized insertions from paired-end short reads</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Ye</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2865" to="2871" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>