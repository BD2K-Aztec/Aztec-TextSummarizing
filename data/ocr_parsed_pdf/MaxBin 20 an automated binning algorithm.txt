Bioinformatics, 32(4), 2016, 605—607

doi: 10.1093/bioinformatics/btv638

Advance Access Publication Date: 29 October 2015
Applications Note

 

 

Sequence analysis

MaxBin 2.0: an automated binning algorithm to
recover genomes from multiple metagenomic

datasets

Yu-Wei Wu1'2'*, Blake A. Simmons1'2'3 and Steven W. Singer1'2

Uoint BioEnergy Institute, Emeryville, CA 94608, USA, 2Biological Systems and Engineering Division, Lawrence
Berkeley National Laboratory, Berkeley, CA 94720, USA and 3Biological and Engineering Sciences Center, Sandia

National Laboratories, Livermore, CA 94551, USA

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on August 4, 2015; revised on October 1, 2015; accepted on October 26, 2015

Abstract

Summary: The recovery of genomes from metagenomic datasets is a critical step to defining
the functional roles of the underlying uncultivated populations. We previously developed MaxBin,
an automated binning approach for high—throughput recovery of microbial genomes from metage—
nomes. Here we present an expanded binning algorithm, MaxBin 2.0, which recovers genomes from
co—assembly of a collection of metagenomic datasets. Tests on simulated datasets revealed that
MaxBin 2.0 is highly accurate in recovering individual genomes, and the application of MaxBin
2.0 to several metagenomes from environmental samples demonstrated that it could achieve two
complementary goals: recovering more bacterial genomes compared to binning a single sample as
well as comparing the microbial community composition between different sampling environments.
Availability and implementation: MaxBin 2.0 is freely available at http://sourceforge.net/pr0jects/

maxbin/ under BSD license.
Contact: ywwei@lbl.gov

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Recovering individual genomes from metagenomic samples remains
a difficult task since sequences of all microbial populations are
sampled simultaneously; however, it is a critical procedure to under-
stand the functional potential of the uncultivated microbes in nat-
ural and engineered ecosystems. Binning is a process to classify
unassembled reads or assembled contigs into discrete clusters, in
which one bin represents one genome. Predominant binning
approaches include clustering by nucleotide frequencies (Dick et (11.,
2009; Iverson et (11., 2009; Mackelprang et (11., 2011; Wang et (11.,
2012; Wrighton et (11., 2012) or sequence coverages (Albertsen et (11.,
2013; Sharon et (11., 2013; Wu and Ye, 2011). Automating the bin-
ning process provides a high-throughput method to recover micro-
bial genomes from metagenomes. We previously developed MaxBin
(Wu et (11., 2014), an automated binnning algorithm that classifies

assembled genomic sequences from metagenomic datasets. Based on
both tetranucleotide frequencies and sequence coverages, MaxBin
automatically estimates the bin number from the target metage-
nome, classifies the sequences into genome bins, and measures the
coverage levels for the binned genomes in the metagenome. In total,
19 and 26 draft genomes were recovered from two cellulolytic bac-
terial consortia enriched from compost using MaxBin (Wu et (11.,
2014), demonstrating its utility in recovering the genomes of un-
cultivated microbes.

Recovering genomes from multiple samples may improve the per-
formance of binning algorithms. A differential coverage binning ap-
proach was developed to use the coverage information of the contigs
from two metagenomic samples to bin genomes by plotting them on a
two-dimensional map (Albertsen et (11., 2013). Binning tools that em-
ploy multiple samples also demonstrated better performances when

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 605

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

606

Y. W. Wu et al.

 

two or more samples are co-assembled and binned (Alneberg et al.,
2014; Imelfort et al., 2014; Kang et al., 2015).

Here we describe MaxBin 2.0, the next generation of the MaxBin
algorithm that recovers genomes from co—assembly of multiple meta-
genomic samples. By exploiting contig coverage levels across multiple
metagenomic datasets, MaxBin 2.0 achieves better binning results
than binning individual metagenomic samples. In comparison to
other binning algorithms that utilize multiple metagenomic datasets,
MaxBin 2.0 is highly accurate in recovering genomes from simulated
metagenomes. The ability of MaxBin 2.0 to measure the coverage
levels of the genome bins also allows comparisons of the genome-
resolved microbial community composition across multiple samples.

2 Methods

MaxBin 2.0 employs an EXpectation—Maximization (EM) algorithm
to recover draft genomes from metagenomes. Briefly, after co-
assembling sequencing reads of multiple metagenomic datasets,
MaxBin 2.0 measures the tetranuncleotide frequencies of the contigs
and their coverages for all involved metagenomes and classifies the
contigs into individual bins. The abundances of all genome bins, which
were unknown before the binning process, are estimated by the EM
algorithm.

The description that follows demonstrates the incorporation of
multiple metagenomic datasets into the MaxBin algorithm. Let the
number of metagenomes be M. The reads of all metagenomes are
combined and co-assembled. Let S be a contig in the co-assembly.
The probability that S belongs to a genome G can be measured
based on its tetranucleotide frequencies and contig coverages in all
metagenomic datasets, which is

M
HS 6 G) : Pdist(S E G) ' HPCW (S E G ( COL/(GD)
le:1

In which Pdis,() and P5090 are probability density functions for
Euclidean distance of tetranucleotide frequencies and coverages be-
tween S and C, respectively. This probability term is then applied in
the EXpectation-Maximization algorithm for binning genomes from
metagenomes. See Supplementary Materials for a more detailed de-
scription about the probabilities and the algorithm. Other improve-
ments include adding multi-thread support into the MaxBin
algorithm and adding more runtime options to allow users to adapt
MaxBin 2.0 to specific applications.

3 Results

The performances of MaxBin 2.0 was compared to three other auto-
mated binning software: GroopM (Imelfort et al., 2014),
CONCOCT (Alneberg et al., 2014) and MetaBAT (Kang et al.,
2015), using metagenomic datasets simulated by MetaSim (Richter
et al., 2008) and assembled by Megahit (Li et al., 2015).
Benchmarking the tools using different minimum contig length set-
tings (500 and 1000 bps) revealed that MaxBin performed relatively
well (in terms of F-score, which is the harmonic mean of precision
and recall) compared to other binning tools (Fig. 1). It was also
ranked first in tests involving 20 or more samples, indicating its ac-
curacy in classifying contigs into distinct genomes.

MaxBin 2.0 was also applied to two sets of real metagenomes.
One set consists of two cellulolytic consortia adapted from compost;
the other set contains ten Human Microbiome Project (HMP) data-
sets. Binning the co-assembly of the two compost metagenomes
yielded 84 bins, surpassing the number of bins generated by binning

Overall performances of the binning tools

°\°
O
:2
$1 — —-— -—-v
O
00 A—A—ﬁﬁtk4 *< 
\o *—‘*i \x3 1
m 5’:
'5 (D
'3 o -- MaxBin2_1000
LL 2 + MaxBin2_500
" —l— GroopM_1000
o —x— GroopM_500
g + MetaBat_2500
N —v— CONCOCT_1000
—- CONCOCT_500
°\°
O
5 1o 15 20 25 30 35 40

Sample numbers

Fig. 1. The overall performances (based on F-score, which is the harmonic
mean of precision and recall) estimated for binning 5-40 simulated metage-
nomes using different binning software. Numbers after each software tools
indicate minimum contig lengths

the two metagenomes separately (19 and 26 bins). Bins produced by
individual binning of the metagenomes are mostly present in the co-
assembly, and more than half of the bins (57) uniquely belong to the
co-assembled metagenome.

The co-assembly of the ten HMP metagenomes sampled from
five body sites was also binned using MaxBin 2.0. The co-assembled
metagenome yielded many more genome bins (96) compared to indi-
vidual binning of each metagenomic dataset (21.4 in average).
Clustering the ten HMP samples based on the coverage levels of the
genome bins suggested that similar body sites share similar micro-
bial community composition, demonstrating how MaxBin 2.0 helps
users compare microbial content among a number of distinct sam-
pling environments.

Acknowledgements

We thank Christopher S. Miller (University of Colorado at Denver) for valu-
able discussions that led to the conception of MaxBin 2.0.

Funding

This work was part of the DOE Joint BioEnergy Institute (http://
www.jbei.org) supported by the U. S. Department of Energy, Ofﬁce of
Science, Ofﬁce of Biological and Environmental Research, through contract
DE-AC02-05CH11231 between Lawrence Berkeley National Laboratory and
the U. S. Department of Energy. The United States Government retains and
the publisher, by accepting the article for publication, acknowledges that the
United States Government retains a non-exclusive, paid-up, irrevocable,
world-wide license to publish or reproduce the published form of this manu-
script, or allow others to do so, for United States Government purposes.

Conﬂict ofinterest: none declared.

References

Albertsen,M. et al (2013) Genome sequences of rare, uncultured bacteria ob-
tained by differential coverage binning of multiple metagenomes. Nat.
Biotechnol., 3 1, 533—538.

Alneberg,]. et al (2014) Binning metagenomic contigs by coverage and com-
position. Nat. Methods, 11, 1144—1146.

/310'S[EUm0prOJXO'SOIJEIIIJOJIIIOIq/ﬂduq

MaxBin 2.0

607

 

Dick,G.]. et al. (2009) Community-wide analysis of microbial genome se-
quence signatures. Genome Biol., 10, R85.

Imelfort,M. et al. (2014) GroopM: an automated tool for the recovery of
population genomes from related metagenomes. Peer], 2, e603.

Iverson,V. et al. (2012) Untangling genomes from metagenomes: re-
vealing an uncultured class of marine Euryarchaeota. Science, 335,
587—590.

Li,D. et al. (2015) MEGAHIT: an ultra-fast single-node solution for large and
complex metagenomics assembly via succinct de Bruijn graph.
Bioinformatics, 3 1, 1674—1676.

Kang,D.D. et al. (2015) MetaBAT, an efﬁcient tool for accurately recon-
structing single genomes from complex microbial communities. Peer] 3,
e1165.

Mackelprang,R. et al. (2011) Metagenomic analysis of a permafrost microbial
community reveals a rapid response to thaw. Nature, 480, 368—371.

Richter,Y. et al. (2008) MetaSim: a sequencing simulator for genomics and
metagenomics. PLOS One, 3, e3373.

Sharon,I. et al. (2013) Time series community genomics analysis reveals rapid
shifts in bacterial species, strains, and phage during infant gut colonization.
Genome Res., 23, 111—120.

Wang,Y. et al. (2012) MetaCluster 5.0: a two-round binning approach for
metagenomic data for low-abundance species in a noisy sample.
Bioinformatics, 28, i356—i362.

Wrighton,K.C. et al. (2012) Fermentation, hydrogen, and sulfur metabolism
in multiple uncultivated bacterial phyla. Science, 337, 1661—1665.

Wu,Y.W. and Ye,Y. (2011) A novel abundance-based algorithm for binning
metagenomic sequences using l-tuples.  Compnt. Biol., 18, 523—534.

Wu,Y.W. et al. (2014) MaxBin: an automated binning method to recover indi-
vidual genomes from metagenomes using an expectation-maximization al-

gorithm. Microbiome, 2, 26.

/310'S[BHmOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq

