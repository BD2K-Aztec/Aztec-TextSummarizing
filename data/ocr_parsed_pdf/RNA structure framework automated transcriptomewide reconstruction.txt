Bioinformatics, 32(3), 2016, 459—461

doi: 10.1093/bioinformatics/btv571

Advance Access Publication Date: 19 October 2015
Applications Note

 

Structural bioinformatics

RNA structure framework: automated
transcriptome-wide reconstruction of RNA
secondary structures from high-throughput

structure probing data

Danny lncarnato1'2, Francesco Neri1, Francesca Anselmi1'2 and

Salvatore Oliviero1'2'*

1Human Genetics Foundation (HuGeF), 10126 Torino, Italy and 2Dipartimento di Scienze della Vita e Biologia dei

Sistemi, Universita di Torino, 10123 Torino, Italy

*To whom correspondence should be addressed.
Associate Editor: Anna Tramontano

Received on June 2, 2015; revised on August 31, 2015; accepted on September 27, 2015

Abstract

Summary: The rapidly increasing number of discovered non—coding RNAs makes the understand—
ing of their structure a key feature toward a deeper comprehension of gene expression regulation.
Various enzymatic— and chemically— based approaches have been recently developed to allow
whole—genome studies of RNA secondary structures. Several methods have been recently pre—
sented that allow high—throughput RNA structure probing (ClRS—seq, Structure—seq, SHAPE—seq,
PARS, etc.) and unbiased structural inference of residues within RNAs in their native conformation.
We here present an analysis toolkit, named RNA Structure Framework (RSF), which allows fast and
fully—automated analysis of high—throughput structure probing data, from data pre—processing to

whole—transcriptome RNA structure inference.

Availability and implementation: RSF is written in Perl and is freely available under the GPLv3 li—

cense from http://rsf.hugef—research.org.
Contact: salvatore.o|iviero@hugef—torino.org

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The advent of high—throughput methods has rapidly led to the anno—
tation of thousands of novel transcripts (Derrien et (11., 2012;
Djebali et (11., 2012; ENCODE Project Consortium et (11., 2012),
mostly lacking coding capabilities (Banfai et (11., 2012; Guttman
et (11., 2013). As for large ribonucleoprotein complexes (Krummel
et (11., 2010; Nagai et (11., 2001), these RNAs are thought to regulate
gene expression through interactions mediated by their structure
(Tsai et (11., 2010; Wang and Chang, 2011). In the last years, a var—
iety of methods have been developed to interrogate RNA secondary
structures on a genome—wide scale (Ding et (11., 2014; Incarnato

et (11., 2014; Kertesz et (11., 2010; Li et (11., 2012; Lucks et (11., 2011;
Rouskin et (11., 2014; Underwood et (11., 2010; Wan et (11., 2012,
2014), but no tool has been developed to enable efficient analysis of
the large amount of data generated by these methods, with the ex—
ception of the SeqFold package, which has been developed to ana—
lyze PARS data (Ouyang et (11., 2013). Because the analysis of these
data and the subsequent inference of RNA structures constitute a
bottle—neck of these protocols, we here provide the RNA Structure
Framework (RSF), an open—source framework to analyze high—
throughput structure probing data (SPD), and to minimize the ef—
forts to get from raw sequencing reads to secondary structures.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 459

 

91oz ‘Og JSanV 110 salaﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 ﬁle'slvumofqutxo"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

460

D. Incarnato et aI.

 

2 Implementation

RSF is implemented in Perl as a modular package. An outline of a
sample RSF data analysis workﬂow is shown in Figure 1. Detailed
information on the core modules is provided in the Supplementary
material, as well in the package archive.

CIRS-sequAPEssqfs'mdue-sea (char-ml:
or PARS (enzymatic) FastQ lies
[Dr SAM Ines]

381W” ’2
- ISHIPE, nus su

Sam I samplers
UCSC Tm” |Nunuanb:ﬂ,‘\'1] l [CMCTI

 

' ', ' a . mm cupping.
mumoe dam Mimi. M'Eme mm” )—-| “am” I lead mambo, and
am hm: '— mmla module dam

 

mmummwmm: AccuracyI

an km W mum: aslirnalor ulilily :‘m 
............ . . mm.
Slruclure Decorwuvor
module

Deconvolution of
Illa RNA Wﬂcllllulm
from pruning data

   
 

Fig. 1. Overview of the RSF pipeline

RSF is composed of three core modules, and a number of other
utilities. The reference-builder module builds the transcriptome ref—
erence used in the read—mapping step. This module requires an
Internet connection to query the UCSC genome SQL database
(http://genome.ucsc.edu) and obtain transcript annotation. Because
the reference-builder module also requires the genome reference se—
quence for the species of interest, this can be either provided by the
user in multi—FASTA format, or can be automatically downloaded
from the UCSC DAS server (http://genome.ucsc.edu/cgi—bin/das/).
The analyzer module is the core of the framework. It requires a ref—
erence index, and a set of at least 2 FastQ files (3 for CIRS—seq), one
for each condition (e.g. non—treated control and DMS treatment).
Reads are pre—processed using the FASTX Toolkit (http://hannon—
lab.cshl.edu/fastx_toolkit/) to clip adapter sequences, while mapping
of reads on the reference index is performed using the Bowtie v1
tool (Langmead et al., 2009). Alternatively, the user can use differ—
ent tools for reads mapping, and then provide to the module the
SAM files instead of FastQ files. Following the mapping step, reads
are sorted and the number of reads mapping at each position of each
transcript are calculated in the provided conditions. Because each
read gives information only on the base immediately preceding the
start mapping position (Supplementary Fig. S1), the module auto—
matically accounts for eventual trimming of bases from the 5’ of the
read. Once raw counts have been computed, the analyzer module
calculates normalized raw reactivity scores using one of two possible
scoring schemes. The first scheme (Incarnato et al., 2014; Kertesz
et al., 2010) assumes an uniform distribution of read mappings
across samples, but it is more susceptible to cross—sample variations
since it uses the total number of mapped reads to normalize libraries
for different sequencing depths. The second scheme (Ding et al.,
2014) instead, is less affected by sample—to—sample variations in the
distribution of read mappings, as it performs per—transcript normal—
ization by considering the average number of RT—stops across the
transcript being analyzed.

Finally, overall reactivities for each position of each analyzed
transcript are normalized to values ranging from 0 (less single—
stranded) to 1 (more single—stranded). The analyzer module actually
incorporates three different normalization methods: 2—8% normal—
ization (Lucks et al., 2011), 90% winsorising (Incarnato et al.,

2014) and Box—plot normalization (Low and Weeks, 2010). For
each transcript being analyzed, the module reports data in a text—
based SPD file (see Supplementary materials). The third, and last,
core component of the toolkit is the structure-deconvolver module.
This module takes a set of SPD files and de—convolutes RNA struc—
tures from experimental data, using one of three different
approaches (Supplementary Fig. S2): (i) Hard—constrained structure
prediction using the ViennaRNA package (Lorenz et al., 2011), (ii)
Soft—constrained structure prediction using the RNAstructure tool
(Reuter and Mathews, 2010) or an (iii) Iterative cluster—refinement
approach. The hard constraint method uses the ViennaRNA pack—
age to predict a minimum free energy structure by imposing the con—
straint that RNA positions exceeding a given reactivity cutoff
(default: 0.7) must be unpaired. The soft constraint approach uses
instead the whole set of reactivity data for an RNA, by first convert—
ing it into a SHAPE data file (using the sdes/oape utility provided
with the RSF package), that can be supplied to the RNAstructure
software. RNAstructure then uses this data to compute a pseudo—en—
ergy term to adjust the free energy of individual nucleotides (Deigan
et al., 2009). The third approach (Supplementary Fig. S3), instead, is
a variant of that employed by SeqFold (Ouyang et al., 2013) soft—
ware. Brieﬂy, the partition folding for the RNA is computed using
the ViennaRNA package, then a backtracking through the
Boltzmann ensemble of structures is performed, and structures are
then clustered using Hamming distance, with a low—stringency cut—
off (default: distance:0.5). The base—pair probability profile for
each cluster is then calculated, and the cluster that better correlates
to RNA reactivity data is selected. Following the best—fitting cluster
selection, the cluster is iteratively refined by performing a progres—
sively more stringent clustering (default: distance : distance — 0.01 ),
followed by the subtraction of individual structures that contribute
to lower the correlation coefficient. Finally, the higher—correlation
cluster of structures (Boltzmann sub—ensemble) is returned, as well
as the minimum expected accuracy structure for the RNA (defined
as the structure in which only the concordant base—pairs in at least
the 50% of cluster structures are reported).

Predicted structures can be reported in dot—bracket or connectiv—
ity table notations, as well as in PostScript or SVG graphical
formats.

Additional tools and utilities are also shipped with the RSF pack—
age, and are described in the Supplementary material.

3 Conclusion

The advent of high—througput RNA structure probing methods has
provided a large amount of transcriptome—wide scale structural
data, although robust tools for the rapid elaboration of this informa—
tion are currently missing. RSF is a user—friendly toolkit that enables
automated inference of RNA secondary structures on a transcrip—
tome—wide scale, in a few steps. It can use data derived from many
different structure probing methods, both chemical (CIRS—seq,
SHAPE—seq, Structure—seq) and enzymatic (PARS). Due to the rapid
evolution of the field, and to the absence of a golden standard in the
analysis of high—throughput SPD, the implementation of several dif—
ferent scoring, normalization and structure prediction methods en—
ables a high degree of analysis ﬂexibility to the user. The use of
high—throughput structure probing methodologies coupled to RSF
provides an important toolkit for the genome—wide analysis of RNA
structures.

Conﬂict of Interest: none declared.

91oz ‘Og JSanV uo salaﬁuv soc] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[Buln0prOJXO'SOIJBLUJOJIIIOIq/ﬂduq 11101} papeolumoq

RSF automated transcriptome—Wide reconstruction of RNA secondary structures 461

 

References

Banfai,B. et al. (2012) Long noncoding RNAs are rarely translated in two
human cell lines. Genome Res., 22, 1646—1 65 7.

Deigan,K.E. et al. (2009) Accurate SHAPE—directed RNA structure determin—
ation. Proc. Natl. Acad. Sci. USA, 106, 97—102.

Derrien,T. et al. (2012) The GENCODE v7 catalog of human long noncoding
RNAs: analysis of their gene structure, evolution, and expression. Genome
Res., 22, 1775—1789.

Ding,Y. et al. (2014) In vivo genome—wide proﬁling of RNA secondary struc-
ture reveals novel regulatory features. Nature, 505, 696—700.

Djebali,S. et al. (2012) Landscape of transcription in human cells. Nature,
489,101—108.

ENCODE Project Consortium et al. (2012) An integrated encyclopedia of
DNA elements in the human genome. Nature, 489, 5 7—74.

Guttman,M. et al. (2013) Ribosome proﬁling provides evidence that large
noncoding RNAs do not encode proteins. Cell, 154, 240—25 1.

Incarnato,D. et al. (2014) Genome—wide proﬁling of mouse RNA secondary
structures reveals key features of the mammalian transcriptome. Genome
Biol, 15, 491.

Kertesz,M. et al. (2010) Genome—wide measurement of RNA secondary struc-
ture in yeast. Nature, 467, 103—107.

Krummel,D.A.P. et al. (2010) Structure of spliceosomal ribonucleoproteins.
F1000 Biol. Rep, 2.

Langmead,B. et al. (2009) Ultrafast and memory-efﬁcient alignment of short
DNA sequences to the human genome. Genome Biol., 10, R25.

Li,F. et al. (2012) Global analysis of RNA secondary structure in two meta—
zoans. Cell Rep., 1, 69—82.

Lorenz,R. et al. (2011) ViennaRNA Package 2.0. Algorithms Mol. Biol., 6, 26.

Low,J.T. and Weeks,K.M. (2010) SHAPE—directed RNA secondary structure
prediction. Methods, 52, 150—158.

Lucks,J.B. et al. (2011) Multiplexed RNA structure characterization with se—
lective 2’-hydroxyl acylation analyzed by primer extension sequencing
(SHAPE-Seq). Proc. Natl. Acad. Sci. USA, 108, 11063—11068.

Nagai,K. et al. (2001) Structure and assembly of the spliceosomal snRNPs.
Biochem. Soc. Trans, 29, 15—26.

Ouyang,Z. et al. (2013) SeqFold: genome-scale reconstruction of RNA sec—
ondary structure integrating high—throughput sequencing data. Genome
Res., 23, 377—387.

Reuter,J.S. and Mathews,D.H. (2010) RNAstructure: software for RNA
secondary structure prediction and analysis. BMC Bioinformatics, 11,
129.

Rouskin,S. et al. (2014) Genome—wide probing of RNA structure reveals active
unfolding of mRNA structures in vivo. Nature, 505, 701—705.

Tsai,M.-C. et al. (2010) Long noncoding RNA as modular scaffold of histone
modiﬁcation complexes. Science, 329, 689—693.

Underwood,J.G. et al. (2010) FragSeq: transcriptome-wide RNA structure
probing using high—throughput sequencing. Nat. Methods, 7, 995—
1001.

Wan,Y. et al. (2012) Genome—wide measurement of RNA folding energies.
Mol. Cell, 48, 169—181.

Wan,Y. et al. (2014) Landscape and variation of RNA secondary structure
across the human transcriptome. Nature, 505, 706—709.

Wang,K.C. and Chang,H.Y. (2011) Molecular mechanisms of long noncoding
RNAs. Mol. Cell, 43, 904—914.

9103 ‘Og isnﬁnv uo salaﬁuv soc] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'slcu1n0fp103x0"soticurJOJutotq/ﬁduq 11101} papeolumoq

