Bioinformatics, 31111), 2015, 1833—1835
doi:10.1093/bioinformatics/btv052

Advance Access Publication Date: 30 January 2015
Applications Note

 

Sequence analysis

SFA-SPA: a suffix array based short peptide
assembler for metagenomic data
Youngik Yang, Cuncong Zhong and Shibu Yooseph*

Informatics Department, J. Craig Venter Institute, La Jolla, CA 92037, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on June 16, 2014; revised on December 29, 2014; accepted on January 26,2015

Abstract

Summary: The determination of protein sequences from a metagenomic dataset enables the study
of metabolism and functional roles of the organisms that are present in the sampled microbial
community. We had previously introduced algorithm and software for the accurate reconstruction
of protein sequences from short peptides identified on nucleotide reads in a metagenomic
dataset. Here, we present significant computational improvements to the short peptide assembly
algorithm that make it practical to reconstruct proteins from large metagenomic datasets contain—
ing several hundred million reads, while maintaining accuracy. The improved computational
efficiency is achieved using a suffix array data structure that allows for fast querying during the
assembly process, and a significant redesign of assembly steps that enables multi—threaded
execution.

Availability and implementation: The program is available under the GPLV3 license from source—

 

forge. net/projects/spa—assembler.
Contact: syooseph@jcvi.org

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Next-generation sequencing (NGS) technologies are used routinely
in metagenomics, and provide a cost-effective approach to assay
microbial communities at a high sequencing depth (Simon and
Daniel, 2011). However, the computational analysis of these large
datasets is a challenge and is influenced by the genomic composition
and taxonomic divergence of the constituent microbes in the
sampled community. In particular, effective identification of
sequence and function of proteins from metagenomic datasets is
hampered by the short read lengths generated by NGS technologies,
and also by the fragmented nature of metagenomic assemblies (of
nucleotide reads) that are attempted to reconstruct genome
sequences. To address this problem, we had previously introduced a
framework that reconstructs proteins from metagenomic data by
first identifying partial protein sequences (or short peptides) from
the nucleotide reads using a gene finder and subsequently assem-
bling these short peptides into long protein sequences using a novel
algorithm (Yang and Yooseph, 2013). Our short peptide assembler

(SPA) algorithm and framework was compared to the alternate
strategy of first assembling the nucleotide reads and then identifying
proteins on the assembled contigs; several different nucleotide
assemblers were evaluated. We showed that SPA outperforms the
alternate strategy under multiple evaluation criteria, including speci-
ficity, sensitivity, read assembly rate and chimera rate (Yang and
Yooseph, 2013). However, while our evaluations included datasets
containing more than 100 million reads, we noted that the computa-
tional efficiency of SPA could be improved. Here, we present com-
putational improvements to SPA that result in a substantial speedup
of the assembly process, while maintaining assembly output quality.
Our new assembly algorithm and implementation, denoted as SFA-
SPA, uses the suffix array (Manber and Myers, 1993)
cient data structure that also allows for the computationally efficient

 

a space effi-

querying of patterns in a given text. The suffix array is used to speed
up the initial path finding step of SPA, which is a major run time
bottleneck. In addition, several assembly steps were significantly

redesigned and re-implemented, and these improvements now allow

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1833

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Idui‘} and W’atcrnmn, 1995

Supplcrncntai‘) 51

Yang and Yooseph,

2013

Mori, 2008

Kasai, (7/ rr/., 2001 Adanbcr and 1%} 01s, 1993

53.1, Fig. S2

 

F rltil'rIEl

sfnnll'I-np

Supplcrncntar) 53.1

Pig. 1

Supplcrncntai‘)

Pig.

Supplcrncntar) 53.1

/310'S[BIIJnOl-pJOJXO'SOpBLUJOJIIlOlq”K1111]

SFA—SPA

1835

 

(due to additional lookups needed to calculate the size of the read
support set), it is still nearly six—fold faster than SPA (m :25) on
these data (Fig. 1A). Chimera rates are very low in both implementa—
tions and SFA—SPA achieves similar read assembly rates as SPA
(Supplementary S3.1).

In addition to the effect of the minimum overlap length m, the
effects of other parameters (minimum seed depth 5 and minimum
read support r) on the performance of SFA—SPA were also evaluated
(Supplementary S32 and S3.3); these evaluations highlight the rela—
tive importance of the overlap parameter in on the assembly quality.
The peak memory usage for SFA—SPA is higher than that of SPA, with
SFA—SPA using 95 GB RAM (2.8 times more than SPA) for the oral.-
sim dataset (Supplementary S3.1). We note though that the sizes of
the suffix array and its associated data structures grow linearly with
the input size. The increased memory usage for SFA—SPA is expected
given the space versus run time tradeoff in our algorithm redesign;
however, this is not an issue since hardware costs associated with
these physical memory size requirements are reasonable. Finally, the
run time of SFA—SPA is comparable to that of other nucleotide
sequence assemblers for metagenomic data (Supplementary S3.4).

Funding

This material is based upon work supported by the National Science
Foundation [grant number DBI-1262295].

Conﬂict of Interest: none declared.

References

Idury,R.M. and Waterman,M.S. (1995) A new algorithm for DNA sequence
assembly.]. Compnt. Biol.,2, 291—306.

Kasai,T. et al. (2001) Linear-time longest-common-preﬁx computation in suf-
ﬁx arrays and its applications. In: Amir,A. (ed.) Combinatorial Pattern
Matching. Springer, Berlin, pp. 181—192.

Manber,U. and Myers,G. (1993) Sufﬁx arrays: a new method for on-line string
searches. SIAM]. Compnt. 22, 935—948.

Mori,Y. (2008) libdivsufsort—a lightweight sufﬁx-sorting library. https://
code.google.com/p/Iibdivsufsort/. (24 February 2004, date last accessed).

Simon,C. and Daniel,R. (2011) Metagenomic analyses: past and future trends.
Appl. Environ. Microbiol., 77, 1153—1161.

Yang,Y. and Yooseph,S. (2013) SPA: a short peptide assembler for metage-
nomic data. Nucleic Acids Res., 41, e91.

/810's12um0_fp10}x0'satmuuogutotq/ﬁduq

