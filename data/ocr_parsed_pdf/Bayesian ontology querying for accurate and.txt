ORIGINAL PAPER

Vol. 28 no. 19 2012, pages 2502-2508
doi: 10. 1 093/bioinformatics/bts4 71

 

Databases and ontologies

Advance Access publication July 26, 2012

Bayesian ontology querying for accurate and noise-tolerant

semantic searches

Sebastian Bauer1'*, Sebastian Kohler1 '2, Marcel H. Schulz?"4 and Peter N. Robinson1'2'3'*
1Institute for Medical Genetics and Human Genetics, 2Berlin-Brandenburg Center for Regenerative Therapies,
Charité—Universitatsmedizin Berlin, Augustenburger Platz 1, 13353 Berlin, Germany, 3Max Planck Institute for Molecular
Genetics, lhnestrasse 73, 14195 Berlin, Germany and 4Flay and Stephanie Lane Center for Computational Biology,

Carnegie Mellon University, Pittsburgh, PA 15213, USA
Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: Ontologies provide a structured representation of the
concepts of a domain of knowledge as well as the relations between
them. Attribute ontologies are used to describe the characteristics of
the items of a domain, such as the functions of proteins or the signs
and symptoms of disease, which opens the possibility of searching a
database of items for the best match to a list of observed or desired
attributes. However, naive search methods do not perform well on
realistic data because of noise in the data, imprecision in typical
queries and because individual items may not display all attributes
of the category they belong to.

Results: We present a method for combining ontological analysis
with Bayesian networks to deal with noise, imprecision and attribute
frequencies and demonstrate an application of our method as a dif-
ferential diagnostic support system for human genetics.

Availability: We provide an implementation for the algorithm and the
benchmark at http://compbio.charite.de/boqa/.

Contact: Sebastian.Bauer@charite.de or Peter.Robinson@charite.de
Supplementary Information: Supplementary Material for this article is
available at Bioinformatics online.

Received on April 19, 2012; revised on July 9, 2012; accepted on
July 23, 2012

1 INTRODUCTION

Ontologies are knowledge representations using controlled voca-
bularies that are designed to help knowledge sharing and com-
puter reasoning (Robinson and Bauer, 2011). An ontology can
be deﬁned as a specification of a conceptualization (Gruber,
1993), meaning that the ontology provides a computational rep-
resentation of the concepts of a domain together with the seman-
tic relations between them. Concepts are often represented as
nodes and the relations between them as edges in a directed
graph. Ontologies have become essential components of search
engines for the world-wide web, e-commerce and medicine
(Kohler et al., 2009; Labrou and Finin, 1999; McGuinness,
2003). They are used to represent items of a domain of know-
ledge, e. g. the ChEBI ontology not only provides a comprehen-
sive representation of biologically relevant small molecules
(Degtyarenko et al., 2008) but also to represent the attributes
of the items of a domain; for instance, the Gene Ontology

 

*To whom correspondence should be addressed.

(GO) provides a comprehensive representation of gene functions
(Ashburner et al., 2000), i.e. the attributes of items of the domain
of molecular biology.

Terms that describe only attributes of items are the base of
ontologies to which we refer as attribute ontologies. There is a
special annotation relation by which items are linked to the terms
in order to express the fact that an item possesses the attribute
described by the term. The annotation propagation rule implies
that the annotation relation is propagated along other relations
to parent terms and thus to all ancestor terms (Robinson and
Bauer, 2011). For instance, in GO, annotation propagation is
deﬁned over is a and part of relations. Hence, if a gene is anno-
tated to the GO term ATP binding, it is implicitly annotated to all
ancestors of the term including nucleotide binding. This leads to
statistical dependencies between ontology terms that can sub-
stantially degrade the performance of ontology analysis methods
(Alexa et al., 2006; Bauer et al., 2010; Grossmann et al., 2007;
Lu et al., 2008).

In addition, semantic similarity measures have been developed
that exploit information content or graph structure to compare
different items based on their annotations (Pesquita et al., 2009).
On the basis of these measures, we have previously developed an
algorithm for querying a database with ontology terms and rank-
ing the results (Kohler et al., 2009; Schulz et al., 2011). However,
none of the presently available ontology search algorithms has
been explicitly designed to deal with the kinds of noise to be
expected in real-life queries. For instance, in the setting of a
clinical differential diagnosis decision support system, false-
positive queries may ensue if a patient has signs or symptoms
unrelated to the underlying diagnosis. Consider phenylketonuria
(PKU), which is a hereditary metabolic disease that is character-
ized by numerous phenotypic abnormalities in untreated pa-
tients. A person with PKU may additionally develop an
unrelated disease such as rheumatoid arthritis (RA), but the
physician may not recognize the fact that the joint manifestations
of RA are unrelated to the manifestations caused by PKU. On
the other hand, not every person with a given disease necessarily
has all of the signs and symptoms that are associated with the
disease. For instance, most patients with Marfan syndrome have
aortic dilatation, i.e. an expansion of the ascending aorta, but
only about half have ectopia lentis, which is a displacement of
the lens of the eye. If a feature occurs more frequently in one
disease than in another, then, all else equal, we would tend to

 

2502 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions.com

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} popeolumoq

9103 ‘Og anﬁnV uo ::

Bayesian ontology query algorithm

 

Phenotypi: abormality
Abnormality of the integument

[Abnormality of the skinl [Abnormality of the nail]

i

   
     

 

 

iAbnormality of keratinizationl IApIasianypoplasia of the nails]

 

     
   

Hype rkeratosis
Epidermolysis Bullosa Simplex

Nail hypoplasia
Sclerotylosis

 
 

Show: only phenotype II.
but not phenotype 7

    
       
 

Patient Examination
. thsican identiﬁﬁ phenotype 3.
a parenl of phenotype d. and

ii " mistakenly pha'lutype 5
ll ll

Query
Physican enters phenutype 3
and nllulutype 5

 
      

  

Patient with disease 2

 

Disease Models

 

 

Disease 1.

—Phenotype 2 100%

—Phenatype 4 40% BOQA
D'seage g;

—Phenotype 4 100%
—Phenatype 7 40%

 

 

 

 

Disease n:

—Phenotype 2 100%

-Phenutype 9 40% Ranked List of Diseases
—Phenotype 12 10% Disease 2. disease 1. 

 

Fig. 1. Principle idea of the approach in the context of clinical diagnosis. BOQA takes the data model derived from an attribute ontology and
annotations together with a set of query terms to produce a ranked list of items. (A) A portion of the HPO with frequency-enhanced annotations to
OMIM diseases. This information is used to deﬁne the data model of our application. (B) The high-level speciﬁcation of the approach in the context of

the diagnostic setting

believe that the former disease explains the presence of that fea-
ture better than the latter disease and therefore can be considered
as the more likely candidate.

Medical diagnostic decision support systems have been under
development for decades, making use of algorithms based on
Bayes’ theorem, fuzzy set theory, Bayesian networks and artiﬁ-
cial neural networks. Many of these systems were designed for
the diagnosis of individual diseases such as appendicitis. Several
Bayesian network algorithms have modeled relations between
diseases, ﬁndings and probabilistic links between the findings,
but such Bayesian networks can be complex and intractable
for large-scale problems (W agholikar et al., 2011).

In this work, we develop the Bayesian Ontology Query
Algorithm (BOQA), which, in contrast to previous approaches,
integrates the knowledge stored in an ontology and the accom-
panying annotations into a Bayesian network (Neapolitan, 2003)
in order to implement a search system in which users enter one or
more terms of the ontology to get a list of the best matching
domain items. For this purpose, we propose a graphical model
that both reﬂects the hierarchical structure of the underlying at-
tribute ontology and the propagation of errors of queries.
We derive an efﬁcient algorithm to apply probabilistic inference
on this model given the queries and perform simulation studies to
assess the performance. We conclude that embedding the ontol-
ogy search into a Bayesian framework naturally enables a gen-
eral framework for searching that deals with false-negative and
false-positive query items, statistical dependencies in the attribute
ontology and annotation frequencies.

We demonstrate our method with an application as a deci-
sion support system for differential diagnosis in human
genetics. The model is built using the Human Phenotype
Ontology (HPO; Robinson et al., 2008), Online Mendelian
Inheritance in Man (OMIM; Amberger et al., 2009) and
Orphanet (Ayme, 2003). Figure 1A shows an excerpt of the
human ontology with annotated diseases, whereas Figure 1B
shows a high-level overview for the problem. We note that a
preliminary version of this application has been published in
Robinson and Bauer (2011).

Items Hidden Layer Query Layer

 

 legs 10. 000 phenotypic features}
Fig. 2. A Bayesian network with two items annotated using an ontology
with seven terms. Item 1 is annotated to term 3, and item 2 is annotated
to terms 4 and 7. The annotations are modeled by edges from the item to
the hidden layer. The edges within the hidden layer are directed from
child to parent terms in the ontology and implement the annotation
propagation rule. The edges within the query layer are directed in the
opposite direction, and together with the one-to-one edges from hidden to
query layer are used to model false-positive and false-negative queries.
We also depict a particular conﬁguration of the network, in which item 1
is active and term 6 forms the query. Thus, there is a false-negative event
for term 3 and a false-positive event for term 6. Probabilities of involved
non-trivial events are shown associated with the nodes of the query layer

2 METHODS
2.1 Modeling queries

We model the queries using a three-layered Bayesian network of Boolean
variables. A variable represents either a state of an item or a state of a

term (Fig. 2).
The first layer is referred to as the item layer I, and contains n Boolean
variables 11, . . . , In. Each variable stands for the state of one of the n

items of the domain. If I]- = 1, then item j is active, and iij = 0, then item
j is inactive.

 

2503

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og anﬁnV uo ::

S.Bauer et al.

 

The variables of I are connected only to variables of the second layer,
which contains Boolean variables H1, . . . ,Hm representing the hidden
states of the m ontology terms. If H,- = 1, then term i is on in the
hidden layer, and if H,- = 0, term i is off. For every annotation between
an item j and an term i, there is an edge from I]- to H,-. That is, the
connections between I and H reﬂect the explicit annotations of domain
items to ontology terms. Annotations implied by the annotation propa-
gation rule are modeled using edges in the hidden layer H that correspond
to the structure of the ontology.

Finally, the hidden states of the terms are connected to the query states
of the terms denoted as Q1, . . . ,Qm. They form the third layer Q. If
Q,- = 1, then term i is part of the query, whereas Q,- = 0 means that i is
not part of the query. The query state of a term depends on the corres-
ponding state of the hidden layer, so there are links between elements of
H and Q, i.e. for each i there is an edge from H,- to Q,-. The propagation
between H and Q is probabilistic and thus is used to model false negatives
(H,- = 1 but Q,- = 0) and false positives (H,- = 0 but Q,- = 1).

According to the annotation propagation rule for ontologies, if an item
j is annotated to term i then it is also annotated to all ancestors of i. We
assume that queries follow a similar rule. That is, if a term i is explicitly
used in the query, i.e. Q,- = 1, then it is assumed that all of the ancestors of
this term are also part of the query. This has implications for classifying
the query states, which we reﬂect using edges within the query layer that
are directed in the opposite orientation to the edges of the hidden layer.

2.2 Application

In our clinical diagnostics application, the domain items correspond to
diseases, and HPO terms describe the attributes (i.e. signs, symptoms or
other phenotypic abnormalities, all referred to as ‘symptom’ in the fol-
lowing) of the diseases. If I]- : 1, then the patient has disease j, and if
I]- : 0, the patient does not have the disease. If H,- = 1, then feature i is
present in the patient, whereas it is not present if H,- = 0. Q,- = 1 expresses
that symptom i was identified as present in the patient, whereas if Q,- = 0,
then symptom i was not observed by the physician making the diagnostic
query. A false positive occurs if the physician diagnosed a symptom even
though it is not truly present. A false negative occurs if the patient has a
symptom, which is not observed by the physician.

2.3 Notation

The joint probability distribution (JPD) of the model is denoted as P(I, H,
Q). In order to specify the local probability distribution (LPD) for each
type of variable, we use subscripts to refer to a set of indices, e.g. Q1131
refers to {Q1, Q2}. Expression pa(i) denotes the set that contains the parent
or parents of term i and ch(i) refers to the children of i. Note that parent
and children refer to relations of the ontology and not to edges of the
Bayesian network. Finally, ea(i) denotes the set of all items that are expli-
citly annotated to term i. In the example shown in Figure 2, we have

621(3) = {1} 621(4) = {2} 621(5) = {}
pa(3) = {2} pa(4) = {3} MG) = {3, 6}

011(3) = {4, 5} 011(4) = {} ch(5) = {1-

If X denotes a set of random variables X1, . . . ,Xn, then XV deﬁnes
another Boolean random variable, such that XV = 1, if and only if (iff)
there is any X ,- e X with X,- = 1, otherwise XV = 0. In other words, XV is
the logical disjunction deﬁned by XV 2 X1 V X2 V . . . V X,,. Similarly, we
deﬁne X" as the logical conjunction of all variables of X. That is, X" = 1
iff all members of X are 1, otherwise X A = 0.

2.4 LPDs of hidden term variables

For didactic purposes, we will ﬁrst present a simpliﬁed version of the
BOQA network in which the frequency of each annotation is 1.

Therefore, if an item j is active, then all terms to which j is explicitly
annotated are on in the hidden layer. If a term i in the hidden layer
is not annotated to an active item, then it is off if all of the children of
term i are oﬂ in the hidden layer, otherwise it is on. Thus, the state
propagation from the item layer to the hidden layer, i.e. the explicit an-
notations, as well as the propagation within the hidden layer, i.e. implied
annotations, is a deterministic function. Formally, the LPD of a single H,-
is speciﬁed as:

P(Hi = 1|]:a(i)’H<\:/h(i)) = maxlfd/a(i)’H<\:/h(i)}'

If we denote the set of items that are explicitly or implicitly annotated
to term i as a(i), it follows that, for a given conﬁguration I = (i1, . . . , in)
and H: (h1,...,hm)

m _ _ 1, Vj:i-=1<=>jea(i)
URI-Ii _ hillém’HQ/WQ _ {0, otheiwise. (1)

Equation (1) merely states that there is only one valid conﬁguration of
states of H for a given conﬁguration of states of I, namely that in which
only the hidden states for the terms are on to which any active item is
explicitly or implicitly annotated.

2.5 LPDs of query term variables

State propagation between the hidden layer and the query layer is mod-
eled probabilistically, whereby the global parameters or and ,8 represent
the probability of a false-positive and false-negative event. Edges between
nodes within the query layer are used to model the propagation of false
positives and false negatives within the query layer.

A false-negative query occurs if H,- = 1 7e Q,- = 0. Q,- is off with prob-
ability ,8, if the query state of at least one parent of i is on and the hidden
state of term i is also on. By assumption, if the query state of the parents
of term i is off, then the query state of term i must also be off. Formally,
we have

P(Qi=0|Hi=1,Ql/g\a(o =0) :1
P(Qi= 1|Hi= LQQam =0)=0

P(Qi = OlHi = laQQaU) =1): l3

P(QiZIIHiZlaQQa(0=1)=1_/3-

Thus, the off-case is propagated in a top-down fashion, in which a false
negative is only counted once per branch, when it is ﬁrst encountered.

A false-positive observation occurs if H,- = 0 7e Q,- = 1. We assign this
event a probability of or. Note that by assumption, the query state of
parents of i have to be on as well. The probability that the query state of a
term is correctly off given that the query state of all of its more general
terms are on is 1 7 or. Formally, we have

P(Qi = OlHi = 0, Q9210) = 0) =1
P(Qi= llHi =0aQQam :0) =0
P(Qi = OlHi = 0,Q1/g\a(i)=1)=1—05

P(Qi = llHi = 0,Ql/g\a(i)=1)= 05-

2.6 JPD for the basic network

Letting m represent the number of terms in the ontology and using the
LPDs of the last paragraphs, we can now specify P(I, H, Q):

P(I, H. Q) = P(I) 1‘1 P(Hiilzam. HZh(,))P(QilHi, 93.0,). (2)
i:1

 

2504

112 /310's1eu1nofp101x0"sotJBuiJOJHtotq/ﬁduq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

Bayesian ontology query algorithm

 

Given a particular conﬁguration (H, Q) for the variables of the hidden
and query layers, we deﬁne

mxyz1QI-I = HilQi = X /\ Hi = y /\ Q1/3210) = 2H

to represent the number of all pairs of nodes (Hi, Q,-) with the given
conﬁguration. Note that

mxyZ‘QH = m.
X.y.ZE(0.1l

We will assume that the probability of an invalid conﬁguration is zero,
i.e. mquH = mm‘QH = 0. Furthermore, observe that the conditional
probabilities for cases m0101QH and moomgﬂ do not contribute to the prod-
uct as they are 1. Therefore, only four of the eight possible values con-
tribute to the conditional probabilities of Q,-, so that we have

m
11 P(Q.-iH.-. Qua.) = lemma — lamina — a)m°°"Q”ocm'°"Q” (3)
i:1

2.7 Searching for items using probabilistic inference over
annotations

BOQA is designed to provide a query system by which users enter a list of
terms representing attributes of items in a database and get back a list of
the items ranked according to how well the attributes of the item match
the attributes in the query. In our model, this is captured by the prob-
ability distribution of the activity state of the items given the observation
or P(IlQ). After applying the deﬁnition of conditional probability and
demarginalizing P(I, Q) for H, we have

P(I. Q) 2 Zn P(LH. Q)
P(Q) P(Q) '

By using Equation (2), we get for the numerator:

P(I IQ) =

 

m
X) P(I. H. Q) = P(I) X) 1‘1 P(Hii1:.(.-,. th(.-,)P(Q.-iH.-. Q3“)- (4)
H HE(0,I1m i:1
Note that although there are 2’” distinct conﬁgurations of H, only one is
valid because of Equation (1). That is, for H, we only need to consider a
single conﬁguration (h’ , . . . , hf”), in which hf = 1, iff term i is explicitly or
implicitly annotated to the active items of i. The probability of other
possible assignments of H is 0. Thus, we have

Z P(I. H. Q) = PH) 11 P(QilHi = hi. Q1203) = P(I)P(QII). (5)
H i:1

Finding the conﬁguration of items that best explain the observed data is
equivalent to maximizing P(IlQ) for I. For this purpose, it is enough to
maximize the product of the likelihood P(QlI) and the prior P(I), since
P(Q) is the normalization constant. In general, the optimization problem
to maximize this product is NP-hard (Neapolitan, 2003). However, if we
limit to possible conﬁgurations of active items to ones in which only a
single item is active (e.g. a situation in which a patient only has one
disease), then we are able to ﬁnd the best item more efﬁciently. We im-
plement this restriction by deﬁning the prior P(I) to have a probability of
one only for such conﬁgurations, and zero otherwise:

n
L azgzi
j:1

0, otherwise.

P(Ilzila---a1n=in)=

We are also able to determine the marginals exactly without increasing
complexity, as

P(QIDPU) _ P(QIDPU)

P (1'9): P(Q) _IZP(QII’)P(I’)’

where the sum is taken over the n valid models. The procedure is sum-
marized in Algorithm].

 

Algorithm 1 Procedure BayesSearch

 

Data: Observations or, ,8, (11, . . . , q"
a <— 0 /* Normalization constant accumulator */
forje{1,...,n}do /* For each item*/

forie{1,...,m}do /* Foreachterm*/
if j is explicitly or implicitly annotated to I then
h,- <— 1
else h,- <— 0

for x,y 6 {0,1} do
mxy11QI-l <— l{illli = X /\ hi =y}l
a]. (_ ’Bmmugua _ [gynllllQHU _ a)n70011QHam1011QH
a <— a + a,-
forje {1,...,n} do

. ﬂ
p1(_a

 

Assuming that all involved mathematical calculations can be done in
0(1), the inference procedure as speciﬁed in Algorithm 1 has a complexity
of 0(nm). However, it is easily possible to conceive an algorithm with
running time 0(A +m) time steps, where A = 2;:1AU— 1, j) and
A(j — 1, j) is the Hamming distance between the annotation bit vectors
for item j 7 1 and j, by updating rather than calculating the counts for
subsequent items. For an optimal running time, the items are renumbered
in a preprocessing step such that A is minimal. Although this optimiza-
tion problem is NP-hard, efﬁcient algorithms such as the one by
Christoﬁdes (1976) can be used to get a constant factor approximation
of the optimal solution due to the relatedness of this problem with the
traveling salesman problem.

2.8 Parameter-augmented network

Up to now, we have treated the false-p0 sitive rate or and the false-negative
rate ,8 as constants. Since the true value of these parameters is unknown,
we choose to integrate over a range of values for or and ,8. Since the
integral is not tractable, we integrate over a grid of suitable range of
different combinations of or and ,8.

Formally, we augment the Bayesian network with two nodes A and B
that represent these parameter values, i.e. the realization of A is or and the
realization of B is ,8 and which have links to the nodes within the query
layer. Letting O = (A, B), then the LPD is parameterized as
P(Qile, Sam, 6). The JPD of the augmented network is factored as

m
P(I, H. 6). Q) = P(0P(®)1_1 P(HiIIE’ama HXh(o)P(QilHi-. Q3210, ®)-
i:1

The likelihood P(QlI) becomes
m m
P(QlI) = X) [1‘1 P(Hii1;(,,.H5.m)] 2319(6)) 11P(Q.-iH.-. Q34». 6)).

H i:1 o i:1
while we assume that A and B and thus 6 are discrete random variables.
A simple choice for values is an equal-sized grid over the range (0, 1).
However, assuming that only few false positives are entered, it is
appropriate to limit or. We choose or e {% |0<a<6} and
,8 E {0.1b|0<b< 10} with uniform prior.

2.9 Frequency awareness

In many diseases, any given symptom may not occur in all patients but
only in a certain proportion of the patients. We will refer to this quantity
as the frequency of a disease feature. The HPO project provides feature

 

2505

112 /3.10's112u.m0[p.101x0"sotJBuiJOJHtotq/ﬁduq 111011 popeo1umoq

9103 ‘0g anﬁnV uo ::

S.Bauer et al.

 

 

Fig. 3. Frequency-aware propagation. Here, 12 is active, whereas I] is
inactive. Given that, the probability that H4 is on is f2’4. The probability
that H7 is on is f2,7. In addition, the frequencies between the diseases and
all other terms are 0 so they can be omitted. Thus, there are four possible
conﬁgurations of the model. The probability of conﬁguration (A) is
f2,4f2,7. (B) is (1 —f2,4)f2,7. (C) is f2,4(1 —f2,7). Whereas for (D) it is
(1 —f2,4)(1 —f2,7)

frequencies for an increasing number of diseases based on original pub-
lications and data extracted from OMIM (Amberger et al., 2009) and
Orphanet (Aymé, 2003). We will now show how our framework can be
extended to exploit frequency information.

We deﬁne the frequency of an attribute represented by term i asso-
ciated to an itemj as 0 5f”- : 1. We assume thath-J- = 0, iff an itemj is
not annotated to a term i. Using this convention, we reformulate the
LPDs of the hidden nodes as follows:

P(H,-=1|I,H;’h® =0)=1_1‘[(1—I,-f,-,,-), (6)
j:1

P(H,- = 1|I, HCVW, = 1) = 1. (7)

Thus, the state propagation, which is exempliﬁed in Figure 3, is no longer
deterministic. By deﬁnition, represents the probability that term i is on
if item j is active, and thus the probability that the hidden state of i is off
if item j is active is 1 —  ,-. If we additionally incorporate the activity state
of the item, we get 1 — I,- that is, if item j is inactive, then term j is off
with probability of 1. Therefore, the hidden state of term i given all items
is off, if the propagation of each active item independently lead to an off
state. The probability of this event is the product of 1 — I,- for each
item j. Note that if only one item is active, then Equation (6) can be
simpliﬁed to P(H,- = 1|I, H2110.) = 0) =fj,,-.

Using this deﬁnition, the calculation for the likelihood becomes more
complex the more annotations with frequencies are available, i.e. the
more non-deterministic state propagations are included in the model,
because the number of possibilities that needs to be explored grows

exponentially in the number of such annotations. In the search procedure,
we therefore restrict the search space to the k least frequent annotations
which are not 0, all other annotations always considered as present. As
we will see in the benchmarks, even though this is a simple heuristic, we
are able maintain highly precise predictions for a greater recall.

2.10 Benchmarks

We performed a systematic benchmark of ﬁve search methods using data
from the HPO project supplemented by frequency information from
Orphanet. The HPO ontology ﬁle and phenotype annotation ﬁle were
downloaded at June 1, 2011. In total, there were n =2368 diseases with
frequency information annotated to a total of 6584 HPO terms, with
A(j — 1,1") 8 139 on average for any disease j.

We simulated ﬁve patients for each of the n diseases. For any one
simulated patient, phenotypic features were assigned according to the
frequency data, and it was assumed that features without any frequency
information are always present. The features of the simulated patient
were then used to generate a diagnostic query. We additionally simulated
the uncertainties of the diagnostic process by randomly adding assigned
unrelated features, i.e. false positives, with a probability or to the query.
Note that by this event, also terms that are the ancestors will be part of
the query. In order to simulate false-negative observations, we removed
disease features from the query with a probability of ,8. If a term is
removed from the query, then by assumption, all of its descendants
were also removed. These arrangements represent a kind of noise in-
tended to represent realistic clinical situations in which not all patients
have textbook presentations of disease, and not all physicians have the
same expertise. Finally, from the set of most speciﬁc terms, we randomly
drew s terms to simulate the fact that physicians, as well as users of other
search systems, are unlikely to enter more than a relatively small number
of search terms. Note that this has an impact on the true ,8.

For each set of simulated query terms, we applied one of following
search procedures: (i) Res: ranking according to Resnik-based semantic
similarity score as done in Kohler et al. (2009); (ii) Lin: similar to Res but
using term similarity measure deﬁned in Lin (1998); (iii) J C: similar to
Res but using term similarity measure deﬁned in Jiang and Conrath
(1997); (iv) ResP: ranking according to the P-value approach as in
K6hler et al. (2009). We use 250 000 random queries to approximate
the score distribution. Ties are resolved using the semantic similarity
score. A Bonferroni correction based on the number of diseases tested
for was applied. Although this has no inﬂuence on the ranking, this
affects how items are classiﬁed at a ﬁxed threshold; (v) BOQA’: the
Bayesian approach without taking frequency into account; (vi) BOQA:
the frequency-aware Bayesian approach with k = 10 and (vii) BOQA’: the
frequency-aware Bayesian approach with k = 10 and without integrating
over parameters, i.e. with the parameters or and ,8 set to the correct values.
This gives an upper bound for the performance of the algorithm.

Each method returns a result vector of length n, in which entry j rep-
resents either a score or a probability value for disease j. The concaten-
ation of all ﬁve n result vectors and the true labels are used to evaluate the
performance of the method by receiver operating characteristic (ROC)
and precision/recall analysis.

3 RESULTS

The result of this work is an efﬁcient search procedure called
BOQA that embeds an attribute ontology, items of a domain
and their annotations into a Bayesian network. Figure 2 depicts
a graphical representation of the network for an example ontol-
ogy. The objective of the method is to find appropriate items
given a set of user query terms, which we handle by applying
probabilistic inference on the Bayesian network instance.
Formulating the task as a Bayesian network problem allows

 

2506

112 /3.10's112u.m0[p.101x0"sotwuuqutotq/ﬁduq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

Bayesian ontology query algorithm

 

ROC (TPR/FPR) Roc (TPR/FPR)

 

 

 
    

      

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

<:>_ _ o
H .—i _
m a = 0.001 a = 0.002
0' — ﬂ=0-1 g — 5:01
a _ —e— BOQA-: 0.995 .9 _ —e— BOQAA: 0.99
o —-I— BOQA: 0.995 ‘3 —|— BOQA: 0.991
¢ —x— BOQA': 0.995 V —x— BOQA': 0.994
c; — -0— Res: 0.953 0' — —0— Res: 0.903
+ ResP: 0.982 -I- ResP: 0.953
g _ + Lin: 0.957 g _ + Lin: 0.908
+ JC: 0.972 -I- JC: 0.932
C, _ —l— MB: 0.94 o + MB: 0.895
0 c5 _
I I I I I I I I I I I I
0.0 0.2 0.4 0.6 0.8 1'0 0.0 0.2 0.4 0.6 0.8 1.0
o Precision/Recall (PPV/TPR) Precision/Recall (PPV/TPR)
e- — 2 —
co _ on
o o' _
to _ \o
o d _
<1; _ <r
o d 7
01 _ N
o :5 _
o_ _ o
o _ _
I I I I I I ° I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0_o ()2 0_4 (15 0,3 1,0

Fig. 4. Performance comparison using ROC and precision/recall ana-
lysis. The analysis was performed on 2368 diseases. For each disease,
ﬁve patients were generated according to available frequency informa-
tion. The true features of each patient were then obfuscated according to
different levels of noise (05,8) as indicated. The maximum query size s was
set to 6

one to take false-positive and false-negative user queries as well
as the attribute frequencies into account. Details are given in
Section 2.

We test BOQA by using it as a differential diagnostic tool for
clinicians by simulating 11 840 patients with 2368 diseases anno-
tated using information from the HPO, OMIM and Orphanet.
ROC and precision/recall analysis were used to compare the per-
formance of BOQA with two other ontology-based search pro-
cedures. We report the results for different settings for the
false-positive rate a, the false-negative rate 8 as well the
number of terms that are used to form a query of size s.

The upper part of Figure 4 shows the evaluation of simula-
tions through ROC curves. The Res, Lin and JC approaches,
which are all based on variants of raw semantic similarity scores,
have the worst performance. The P-Value method, ResP, shows
better performance, as has been previously reported (Kbhler
et al., 2009; Schulz et al., 2011). The Bayesian approaches pre-
sented here shows the best performance at all tested noise levels.
In particular, the BOQA performs better than the simpler
BOQA’ approach, which lacks the inclusion of frequency infor-
mation. BOQA is only beaten by the BOQA/ approach, in which
the true values of a and 8 are known.

Due to the large disproportion between the positive and nega-
tive classes, the difference between the methods is noticeable but
not very large in the ROC analysis. The difference becomes
clearer, if one looks at the positive prediction value (PPV) at a
ﬁxed threshold. For instance, for the setting in which a = 0.002,
8 = 0.002 and s: 6, from the data generated for the 11 840 pa-
tients, BOQA assigns 6933 items a marginal probability >05, of
which 5626 were true positives. This gives a PPV of 80%.

Table 1. Performance according to the positive predictive value TP/
(TP + FP) at a ﬁxed classiﬁcation threshold

 

 

 

BOQA (>05) P-value (<0.05)
or/8/s TP TP + FP PPV (%) TP TP + FP PPV (%)
0.001/0.1/6 8479 9448 90 6129 14913 41
0.002/0.1/6 5725 7139 80 3761 8636 44
0.001/0.1/3 3456 4648 74 2035 4721 43
0.002/0.1/3 1903 2988 64 1210 2753 44

 

In contrast, the P-Value approach ﬂagged 8636 items with a
P-Value <0.05, of which 3761 items were true positives, yielding
a PPV of only 44%. As reported in Table 1, the same conclusion
holds for other parameter settings.

The PPV and the precision of a classiﬁer refer to the same
quantity. In general, the so-called precision/recall analysis repre-
sents a complementary way of evaluating the results of prediction
methods in which a range of recall, i.e. sensitivity, thresholds are
analyzed. As shown in the lower part of Figure 4, the Bayesian
approaches indeed yield a higher precision over the entire range
of recall thresholds with all noise conﬁgurations tested.

4 DISCUSSION

We have demonstrated the use of BOQA as a decision support
tool in human genetics, in which physicians enter the phenotypic
abnormalities observed in a patient to search among 2368
Mendelian diseases for the most likely diagnosis to explain the
symptoms of the patient. In this setting, BOQA models a gen-
erative process, in which a disease causes observable phenotypic
abnormalities that are structured according to the HPO. After
the physician has entered the observations, probabilistic infer-
ence is applied in order to rank each disease according to the
probability that it explains the observed phenotypic
abnormalities.

We showed with simulations that a marginal probability of an
item being >05 of items as calculated by our model is a more
precise indicator for ﬁnding the true item as a P-Value <0.05
(Table 1). This holds true for the entire range of recalls
(Fig. 4). One obvious reason for this improvement is that
BOQA directly models false-positive and false-negative observa-
tions and seamlessly integrates available frequency information.
Another important reason is that BOQA is a global approach.
It models the generation of search queries and applies probabil-
istic inference by which the result of each item depends on the
result of all other items: the marginal probabilities add up to 1.

In order to derive an efﬁcient inference algorithm, we assume
that exactly one item is responsible for the terms part of the
query. This simpliﬁcation is often realistic in the field of medical
genetics, which we used as a demonstration. Clearly, BOQA can
also find combinations of items that best explain a given set of
query terms by deﬁning appropriate prior distribution P(I) in
Equation (6), which may be useful for certain applications.
Note that this generalization has consequences on the tractability

 

2507

112 /310's112u1nofp101x0"801112111101u101q/ﬁd11q 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

S.Bauer et al.

 

of the inference problem as combinations of items being active
may have to be considered. Furthermore, for reasons of efﬁ-
ciency, we considered merely the frequency information for
k—lowest probable features. In order to generalize the algorithm
with respect to these simpliﬁcations, it may be worthwhile to
apply more sophisticated probabilistic inference procedures
such as sampling based or approximative ones. These may also
help to reduce the still relative large gap between BOQA/ and
BOQA.

Our Bayesian approach to ontology-based searching allows a
wide range of extensions that may be useful in speciﬁc situations.
For instance, if a physician is absolutely sure that a certain
observed feature is present, then one could assign a very small
a-Value (probability of false positives) to that feature.
Analogously, a very small 8 range value can be asserted for a
particular feature, if the physician is sure that the feature is not
present in the patient, say because it has been ruled out by a
targeted laboratory investigation. On the other hand, if the phys-
ician is unsure, this could be encoded by larger values for these
parameters. This additional knowledge could help to distinguish
between different search results if no disease attains a probability
>0.5. Another conceivable enhancement is the inclusion of
knowledge about possible co-occurrences of features. As this re-
quires a more complex annotation model, a simulation experi-
ment similar to the proposed one could be used to verify the
usefulness of the approach.

Although we have presented an application of BOQA in the
medical domain, the search algorithm is by no means limited to
medicine. Applications for searching archives of documents in
order to ﬁnd documents belonging to categories that have been
annotated to certain concepts based on word usage may proﬁt
from BOQA. For instance, if a word such as semiconductor
occurs in 35 of 70 documents in the category computer hardware,
then the frequency of this term would be 0.5; categories such as
computer hardware would play the role of diseases in our ex-
ample, and documents would play the role of patients.

Funding: Deutsche Forschungsgemeinschaft (DFG RO 2005/4—2)
and the NIH (R01 HG004838-02).

Conflict of Interest: none declared.

REFERENCES

Alexa,A. et al. (2006) Improved scoring of functional groups from gene expression
data by decorrelating GO graph structure. Bioinformatics, 22, 160(kl607.

Amberger,J. et al. (2009) McKusick’s Online Mendelian Inheritance in Man
(OMIM). Nucleic Acids Res, 37, D79¥D796.

Ashburner,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology. The
Gene Ontology Consortium. Nat. Genet, 25, 25729.

Ayme,S. (2003) Orphanet, an information site on rare diseases. Soins., 46417.

Bauer,S. et al. (2010) GOing Bayesian: model—based gene set analysis of
genome—scale data. Nucle‘w Acids Res, 38, 352373532.

Christoﬁdes,N. (1976) Worst—case analysis of a new heuristic for the traveling sales—
man problem. SIAM J. Comput., 6, 563.

Degtyarenko,K. et al. (2008) ChEBI: a database and ontology for chemical entities
of biological interest. Nucleic Acids Res, 36, D34¢D350.

Grossmann,S. et al. (2007) Improved detection of overrepresentation of
Gene—Ontology annotations with parent child analysis. Bioinformatics, 23,
302473031.

Gruber,T.R. (1993) A translation approach to portable ontology speciﬁcations.
Know]. Acquis, 5, 1997220.

Jiang,J. and Conrath,D. (1997) Semantic similarity based on corpus statistics and
lexical taxonomy. In Proceedings of the International Conference Research on
Computational Linguistics (ROCLING). ACLCLP, Taiwan, pp. 13733.

K0hler,S. et al. (2009) Clinical diagnostics in human genetics with semantic simi—
larity searches in ontologies. Am. J. Hum. Genet, 85, 4574164.

Labrou,Y. and Finin,T. (1999) Yahoo! as an ontology: using yahoo! categories to
describe documents. In CIKM ’99: Proceedings of the Eighth International
Conference on Information and Knowledge Management. ACM, New York,
pp. 18%187.

Lin,D. (1998) An information—theoretic deﬁnition of similarity. In Shavlik,J.W. and
Shavlik,J.W. (eds) ICML. Morgan Kaufmann, San Francisco, CA,
pp. 29(r304.

Lu,Y. et al. (2008) A probabilistic generative model for go enrichment analysis.
Nucle’w Acids Res, 36, e109.

McGuinness,D.L. (2003) Ontologies come of age. In Dieter,F. et al. (ed.) Spinning
the Semantic Web: Bringing the World Wide Web to Its Full Potential. MIT
Press, Cambridge, Mass, pp. 1717194.

Neapolitan,R.E. (2003) Learning Bayesian Networks Prenstice Hall, Englewood
Cliffs, NJ.

Pesquita,C. et al. (2009) Semantic similarity in biomedical ontologies. PLoS
Comput. Biol., 5, 61000443.

Robinson,P.N. and Bauer,S. (2011) Introduction to Bio—Ontologies CRC Press Inc,
Boca Raton, FL.

Robinson,P.N. et al. (2008) The Human Phenotype Ontology: a tool for annotating
and analyzing human hereditary disease. Am. J. Hum. Genet, 83, 610—615.
Schulz,M.H. et al. (2011) Exact score distribution computation for ontological simi—

larity searches. BMC Bioinformatics, 12, 441.

Wagholikar,K.B. et al. (2011) Modeling paradigms for medical diagnostic decision

support: a survey and future directions. J Med Syst., Oct, 1721.

 

2508

12 /310's12u1n0[p101x0'so112111101u101q//:d1111 111011 pop201um0q

9103 ‘0g1sn8nv uo ::

