Vol. 26 no. 21 2010, pages 2786-2787
APP N doi:10.1093/bioinformatics/btq496

 

Structural bioinformatics

Advance Access publication August 27, 2010

XMSF: Structure-preserving noise reduction and

pre—segmentation in microscope tomography

J. R. Bilbao—Castrolazaik, C. O. S. SorzanoZ, |. Garc a3 and J. J. Fern ndezi2

1Department of Computer Architecture and Electronics, Univ. de Almer a, 04120, Almer a, 2National Centre for
Biotechnology (CSIC), Univ. Aut noma de Madrid, 28049, Madrid and 3Department of Computer Architecture,

Univ. M Iaga, Campus Teatinos, 29071, M Iaga, Spain
Associate Editor: Anna Tramontano

 

ABSTRACT

Summary: Interpretation of electron tomograms is difficult due to
the high noise levels. Thus, denoising techniques are needed to
improve the signal-to-noise ratio. XMSF (Microscopy Mean Shift
Filtering) is a fast, user-friendly application that succeeds in filtering
noise while preserving the structures of interest. It is based on the
extension to SD of a method widely applied in other image processing
fields under very different scenarios. XMSF has been tested for
a variety of tomograms, showing a great potential to become a
state-of-the-art filtering program in electron tomography. Applied
iteratively, the algorithm yields pre-segmented volumes facilitating
posterior segmentation tasks. Moreover, execution times remain low
thanks to parallel computing techniques to exploit current multicore
computers.

Availability: http://sites.google.com/site/xmsfilter/

Contact: jrbcast@ace.ual.es

Received on July 6, 2010; revised on August 23, 2010; accepted on
August 25, 2010

1 INTRODUCTION

Electron tomography (ET) has gained interest in recent years for
its ability to image relatively big and heterogeneous specimens in
a near-to-native state (Frank, 2006). Low electron doses are used
to reduce the radiation damage, which makes the reconstructed
volumes exhibit low signal-to-noise ratios (SNR). Thus, noise
reduction is essential to increase the SNR and to facilitate visual
inspection, segmentation and, in the end, interpretation of volumes.

Different denoising techniques have been applied with different
degree of success. Gaussian ﬁltering techniques allow fast noise
reduction but tend to blur volume features, not discerning between
noise and signal. Recently, iterative median ﬁltering (van der Heide
et (11., 2007) has emerged as a simple and nonlinear technique to ﬁlter
electron tomograms, but it is not optimal under extremely noisy
conditions. Bilateral ﬁltering is an anisotropic ﬁltering technique
that has drawn some attention in this ﬁeld (Jiang et (11., 2003). It is
based on adaptive Gaussian ﬁltering that accounts for both spatial
and intensity distances. Anisotropic nonlinear difﬁision (AND)
techniques adapt the strength and direction of the ﬁltering to the
local structure (Fernandez and Li, 2003). They are prevalent because
the SNR is signiﬁcantly enhanced while the important structural
information is preserved. However, their computational demands
are large and they have a number of parameters whose tuning is not

 

*To whom correspondence should be addressed.

trivial. For those reasons, the availability of new, fast methods that
are easy to use are very welcome in ET.

This work proposes to use a ﬁltering technique based on the Mean
Shift algorithm (Comaniciu and Meer, 2002). Mean Shift image
ﬁltering and segmentation has been previously used with success in
different image and video processing areas such as photo edition,
video tracking systems, etc. Here, we have extended this algorithm
for the 3D case and have prepared a program for public use, XMSF
(Microscopy Mean Shift Filtering). The resulting ﬁltering program is
highly intuitive and user-friendly and, moreover, yields good results
under different SNR circumstances. Also, if applied iteratively, it
has shown a great potential as a preliminary step for segmentation
tasks.

2 DESCRIPTION

XMSF is a portable. command-line application written in C++. It is
distributed as a stand-alone application and. due to its good performance.
it has also been fully integrated in the EM image processing package Xmipp
(Sorzano at al.. 2004). It can be used to process both 2D (images) and 3D
(volumes) datasets. Conceptually. the application works as follows (Fig. 1).
For each pixel/voxel (‘origin’) the centroid of its neighbours is calculated.
The new centroid is only calculated taking into account those voxels/pixels
falling within a certain spatial distance and within a certain intensity (i.e.
density) distance. Then. the new ‘origin’ is that pixel/voxel corresponding to
the calculated centroid. This process is repeated iteratively until the ‘origin’
does not change. This last ‘origin’ is the so-called ‘mode’ for the ﬁrst
‘origin’. whose intensity value is set to that of the last ‘origin’. Mean-shift
ﬁltering is closely related to bilateral ﬁltering but outperforms it thanks to
the use of different data during the mean-shift iterations through the adaptive
movements of the kernel (Song et al.. 2006).

There are two possible implementations available in XMSF. First. the
centroids are calculated using Gaussian kernels (one for pixels/voxels
distance and the other for intensity distance) centered on the ‘origins’. This is.
in principle. a slower but more accurate process. Second. an alternative and
simpler implementation replaces Gaussian kernels with uniform ones (i.e.
based on simple sums of the pixels/voxels in the kernel window). leading to
equally good results and a much faster execution.

The user should provide two main parameters (although default values are
provided otherwise). the width of both the spatial and intensity windows or
the equivalent Gaussian kernels bandwidths. These parameters are easy to be
tuned. Low spatial distances. in the range 5710 pixels/voxels. are normally
used. For the density distance. the standard deviation computed from the
whole dataset normally yields good results.

Due to its iterative nature and the high number of pixels/voxels to be
processed. a parallel implementation has been developed to reduce execution
times. specially high for big volumes. For user simplicity and compatibility.
POSIX threads. which are available for any Unix/Linux OS. have been
used (Bilbao-Castro at al.. 2009). With the number of cores in a single

 

2786 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq moi; pQPBOIII/lAOG

9103 ‘{g anﬁnv uo ::

XMSF

 

Inmal pomt p mode for point ‘p’
O .
0 000 Do
L'. ' O
O O O O 0

ﬁrst ‘mean—shift' vector

Fig. 1. Mean-shift procedure. Small circles represent N -dimensional points
[in our case N =3(x, y,z)+1(intensity)l, big circles represent the kernel.
Starting at a point ‘p’, calculate the ‘mean—shift’ vector and displace the
kernel to the new position. Repeat iteratively until no variation is observed
and apply the intensity of the ﬁnal point (the mode) to ‘p’. Repeat for all
voxels in the volume.

chip expected to grow rapidly in the near future, the user is expected to
beneﬁt from this feature greatly. Memory consumption is twice the size of
the tomogram/image being processed.

3 TESTING

To illustrate the performance of XMSF, tomograms with different noise
conditions and sizes were processed. Several window sizes were also tested
for both intensity and spatial distances. The spatial distances did not turn out
to be very important for the Visual result, with lower values yielding much
faster results. A single XMSF iteration produces good results, but more can
be used for presegmentation purposes.

Figure 2 shows the results after one iteration for an experimental cryo-
tomogram of HIV-1 Virions. It can be observed how background has been
effectively denoised and ﬂattened while the important structural features
remain clear and sharp. See supplementary material at the web site of the
program for additional illustrative examples that include datasets prepared
with different preparation techniques involving different SNR conditions.
Regarding execution times, Table 1 shows close-to-linear speed-ups for
different tomogram sizes up to eight cores (processors).

In order to carry out an objective assessment, we chose the HIV-1
tomogram and applied XMSF and different standard techniques: iterative
median, bilateral (both implemented in http://bsoft.ws) andAND (Fernandez
and Li, 2003). We then computed the SNR for the different results, with the
SNR deﬁned as (IS —I;,)/a;,, where I, and 1;, denote the average intensity
in the structure of interest and in the background, respectively, and a}, is
the standard deviation of the background. The background was deﬁned by
thresholdng the ﬁltered tomogram, followed by morphological operations.
Table 2 shows that XMSF outperforms the median and bilateral ﬁltering
in terms of performance and execution time. Though AND is superior, it
requires much more time and memory consumption (eight copies of the
volume).

4 CONCLUSION

XMSF has a great potential of application in ET. It has shown
to deal well with disadvantageous noisy conditions present in
electron tomograms while preserving important structural features.
The parallel implementation of the algorithm allows a nearly
linear speed-up in multicore machines, providing fast results at
a reduced cost. In terms of execution time and image quality,
XMSF outperforms other standard methods in many applications.
XMSF has the additional advantage of its ability to perform preseg-
mentation of complex tomograms, which is essential in this ﬁeld.

Funding: Spanish Ministry of Science (TIN2008-01117); Junta de
Andalucia (P06-TIC01426 and IAC09-II—5476). Ramon y Cajal
fellowship ﬁnanced by the European Social Fund and Ministerio
de Ciencia e Innovacion (t0 C.O.S.S.).

 

Fig. 2. Result of the ﬁltering of a cryo-tomogram of HIV-1 Virions (ID = 1155
in the EM Data Bank) with XMSF. A slice of the (left) original, noisy and
(right) ﬁltered cryo-electron tomogram.

Table 1. Average iteration execution times (in seconds) for different sizes
and a window size of radius = 5 voxels

 

 

Size (Slices x Rowstols) Sequential 4 Cores 8 Cores
91x281x 141 (3.6E6 voxels) 42.4 10.9 (3.9x) 5.6 (7.5 X)
154x586x270 (2.4E7 voxels) 287.1 74.4 (3.9x) 38.0 (7.6x)

125x1010x736 (9.3E7 voxels) 2615.6 685.0 (3.8x) 345.8 (7.6x)

 

In parentheses the speed-up obtained for the parallel executions is indicated. Note its
close-to-linear behaviour.

Table 2. Comparison of different ﬁltering algorithms over the HIV
tomogram

 

 

Algorithm SNR Exec. time Threads (multicore) Iterations
Median (bsoft) 2.6 6.5 1 3
Bilateral (bsoft) 2.7 59.2 1 1
AND (tomoand) 3.9 387.2 1 40
XMSF 3.4 5.7 8 1

 

When available (XMSF), parallel executions have been performed and those are the
shown times (with eight cores).

Conﬂict of Interest: none declared.

REFERENCES

Bilbao-Castro,J.R. et al. (2009) Exploiting desktop Supercomputing for 3D electron
microscopy reconstructions using ART with blobs. J. Struct. Biol., 165, 19726.
Comaniciu,D. and Meer,P. (2002) Mean shift: a robust approach toward feature space

analysis. IEEE Trans. Pattern Anal. Mach. Intell., 24, 6037619.

Fernandez,J.J. and Li,S. (2003) An improved algorithm for anisotropic nonlinear
diffusion for denoising cryo—tomograms. J. Struct. Biol., 144, 1527161.

Frank,J. (2006) Electron Tomography: Methods for Three-Dimensional Visualization of
Structures in the Cell. 2nd edn. Springer, New York.

Jiang,W. et al. (2003) Applications of a bilateral denoising ﬁlter in biological electron
microscopy. J. Struct. Biol., 144, 1144122.

Song,N. et al. (2006) Enhanced spatial-range mean shift color image segmentation by
using convergence frequency and position. In 14th European Signal Processing
Conference (EUSIPCO), (Florence, Italy).

Sorzano,C.O.S. et al. (2004) XMIPP: a new generation of an open-source image
processing package for Electron Microscopy. J. Struct. Biol., 148, 1944204.

van der Heide,P. et al. (2007) Efﬁcient automatic noise reduction of electron
tomographic reconstructions based on iterative median ﬁltering. J. Struct. Biol.,
158, 19&204.

 

2787

112 /3.IO'SIBIIII’IOprOJXO'SOIJBLUJOJIIIOIq”Idllq mot} pQPBOIHMOG

910Z‘1‘518n3nvuo ::

