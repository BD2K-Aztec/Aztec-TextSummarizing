BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Large-scale biological rhythm studies

 

used to investigate the algorithm’s ability to recover period,
phase and amplitude.

Previous studies generally focused on one type of periodic
signal or one type of organism. Our goal is to study how
algorithms perform across a variety of organisms and periodic
processes. We used algorithms to analyze experimental data from
several systems: the cell cycle (Orlando et al., 2008) and meta—
bolic cycle (Tu et al., 2005) in Scerevisiae, circadian rhythm
(Hughes et al., 2009) in Mmusculus and the root clock
(Moreno—Risueno et al., 2010) in Arabidopsis thaliana. We
focused on microarray datasets and designed the synthetic data
to capture the characteristics of these data types.

After evaluating a large collection of algorithms, de
Lichtenberg (DL) (de Lichtenberg et al., 2005a), LS (Lomb,
1976; Scargle, 1982), JTK_CYCLE (JTK) (Hughes et (11., 2010)
and persistent homology (PH) (Cohen—Steiner et al., 2010) were
selected for comparison. Several other algorithms were evaluated
but not included in further analysis because of similarity to tested
algorithms, being too general, using pre—processing algorithms,
lesser performance or no available implementation. These in—
cluded, but were not limited to, COSOPT (Straume, 2004),
ARSER (Yang and Su, 2010), LSPR (Yang and Zhang, 2011)
and address reduction (Ahnert et (11., 2006).

The four algorithms were chosen because they derive from
four different mathematical methods for identifying periodicity.
They were also selected for their ability to work on datasets with
limited numbers of periods, as the microarray datasets we exam—
ine contain 273 periods. Each deﬁnes periodicity differently,
weights aspects of rhythmicity differently (e. g. amplitude, proﬁle
shape) and responds differently to noise, irregular intervals and
missing data. Periodic signals are often described using the prop—
erties of cosine curves: period, amplitude and phase shift. Period
is the length of one cycle or, alternatively, the distance before a
pattern repeats. Amplitude is one half the peak—to—trough height.
Phase shift is the distance that the signal has been shifted in time.
Each of these algorithms returns a list of P—values or scores for
each of the time series evaluated based on some combination of
periodicity and/or amplitude.

The LS method was developed in the ﬁeld of astrophysics
(Lomb, 1976; Scargle, 1982) as a Fourier style method, but
was designed to deal with data that exhibit irregular sampling,
which is typical of observational data in astronomy. It measures
the correspondence to sinusoidal curves and determines their
statistical significance (Glynn et (11., 2006).

JTK has its origins in statistics but was adapted for biological
data in Hughes et a]. (2010). It correlates pairs of points and then
computes the significance of the correlation to that of a reference
curve.

The algorithm described by de Lichtenberg (DL) (de
Lichtenberg et al., 2005b) was constructed speciﬁcally for the
yeast cell cycle and thus comes directly from biology. It measures
the periodicity of a signal, but also takes into account a measure
of the amplitude. It uses permutations to generate a background
distribution for measuring signiﬁcance.

PH comes from the ﬁeld of computational topology, an area
that lies at the intersection of mathematics and computer science
(Cohen—Steiner et al., 2010). PH examines persistence pairings
of minima and maxima along the curve. A single minima and
maxima is considered to be the ideal perfect oscillation;

additional smaller oscillations create more minima and maxima
that are interpreted as a less perfect curve.

2 RESULTS
2.1 Synthetic data

To quantify algorithm performance and to make valid compari—
sons between each algorithm’s results, we developed several sets
of synthetic data to test the algorithms (Supplementary Tables S1
and S2). Four types of analysis were performed using synthetic
data.

The synthetic dataset included non—periodic cases: flat and
linear; and periodic cases: cosine, two cosines with different per—
iods and amplitudes, cosine damped, cosine peaked, cosine with
a linear trend and cosine with an exponential trend (Fig. 1). The
start time was 0 and the end time was 200, with period lengths of
100 (two cycles in a profile), the amplitude at 50 (for peak to
trough of 100), and the phase shifts were chosen on a uniform
distribution of 0 to the selected period length. Gaussian noise
was applied to the proﬁles with standard deviation 2 {0, 25, 50}.
These data were sampled evenly with three different numbers of
samples 2 {50, 25, 17}. This dataset was evaluated by each of the
algorithms, which were run to search for a large range of periods,
with period lengths between approximately 40 and 160 (except
DL, which was set to the target period because it only searches
for one period). Note that DL uses permutations on the entire
dataset to compute periodicity scores, so its results can vary
based on the profiles included in the dataset and the number
of permutations.

In the first analysis, we tested each algorithm’s performance
on separating periodic from non—periodic signals with different
signal shapes, noise levels and sampling rates. For each case,
1000 proﬁles were generated. We examined the ability of the
algorithms to classify periodic versus non—periodic proﬁles
using receiver operator characteristic (ROC) plots (Fig. 2 and
Supplementary Figs S17S3). ROC plots of algorithms visualize
the sensitivity and speciﬁcity on discriminating between positive
(periodic) cases and negative (non—periodic) cases as the P—value
or score cutoff is varied. These plots can inform the selection of
score or P—value cutoffs by looking at the trade—offs between

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A 100- 100 .
8 50- Cosine 50 cosme
25 Two
N 0-. . . o. . .
g 100 . 100 .
E 50_\/\/ Cosme 5° Cosme
E Damp Peak
33 o o
:5; 300 200-
% 150 \/\/ lE—rend 100W {rend
x Inear
I o, . p o-. . .
B 100 100
50 Flat 50 / Linear
o- o
o 100 200 . o 100 200
Time

Fig. 1. Test proﬁles for the synthetic datasets. The synthetic datasets
include (A) periodic proﬁles and (B) non-periodic proﬁles

 

3175

/810'spzum0_fp10}x0"soiJBmJOJuioiW/zdnq

an?kgogmomammowoio~&o:3m7.omm\

E H

J
JII .-

 

 

1 1
5. 5.
O O
O O
1 1
O O
O O
1 1
5. 5
o o__
O O

1
1

O5
05

O O O O O O

 

150

100

50

 

 

150

100

50

 

 

150

100

  

 

 

 

 

 

50

 

   

50 100 15050 100 15050 100 150

n o x
-|- A 0

/3.IO'S[EIIm0[p.IOJXO'SOIJEIIIJOJIIIOIq”Zduq

A.Deckard et al.

 

 

 

 

 

Ls JTK DL PH

ACF4 /\/‘ SRP1 W HTA2 /\/~— MET18 W
.5 i SKI7 \/\/ RRN1O /\/‘ NRM1 /\/~ RAD51 /\,~
g g TP03 W SKI7 \/\/ CLB1 /\/- N|P1OO \,\J
8 YILOO1W W ECM32 W S|M1 /\/~ RAD50 W
YDR239C \/\r\, PLB1 ’\/\, SRL1 fv" POP2 W
Elov|3 m Elov|3 m Tubb2a V1,, St39a|5 N
E: g Tars W Bnip3 N Avpr1a M Nampt N
g g Gys2 N St39a|5 N Elov|3 m St39a|5 N
E 5 Clpx My St39a|5 N Arntl m Adam1b I 1
8002 M Nampt N Nr1 d2 M Bnip3 N
AT3G52930 W AT1G0382O M RN82 W PBC1 W

E 73 FAR7 M CRR28 M AT5G1247O W AT1G284OO .1
E 8 AT1G0382O M PAP21 M PKT3 W DER1 W

5:“ AT4G1594O W 263507_s_at le UNE5 “MAJ AT1G6331O 1
AT5G1131O m 244917_at M KCR1 W AT3G03960 W
a, SSA3 MA sw15 MN swrs MN GUT1 M
a g S|P18 mm BUD4 \AJ‘V PRY2 \ 11 A r EFT1 EFT2 m
g g MRPL35 UUV ACE2 MA, YCLO48W-A AAA ADE17 M
*5 GRE2 [171/1 SUR7 ’\j\,/L/ SRL1 \AflJ AAH1 1 1 l
E GND2 MA CHS2 W\_, HBT1 {\j\_r\_ GLY1 W

 

Fig. 5. The top five scoring gene expression profiles from each algorithm for each datasct. Algorithms arc shown in columns and the datasets arc in rows.
All the expression profiles arc normalized minimum to maximum for their amplitude

Table 1. The number of genes considcrcd pcriodic at various cutoffs on
P—valucs and q—valucs

 

 

Datasct Algorithm P<0.05 P<0.01 q<0.05 q<0.01
Ycast cell cycle LS 4 0 0 0
JTK 800 208 0 0
Yeast mctabolic cyclc LS 3744 2660 2918 1819
JTK 4626 3828 4237 3396
Root clock LS 12 518 10 509 11 677 9322
JTK 13364 11990 12894 11491
Mammal circadian LS 6570 3849 2845 1577
JTK 9991 6204 5607 3935

 

sets with large differences in the number of genes considered peri-
odic. For example. in the yeast cell cycle data. using P<0.05 gives
800 genes from JTK but only four genes from LS. Additionally.
the algorithms PH and DL do not return P-values. Therefore. it is
difﬁcult to directly compare P-values or scores returned by these
algorithms. See Supplementary Figures 8107813 for the distribu-
tions of P-values or scores.

2.3 Recommendations

From these results and literature on the algorithms. we have
created a decision tree to recommend algorithms based on
their ability to distinguish periodic from non-periodic proﬁles

in synthetic data (Fig. 6). Sampling at least one full period is
recommended. and sampling across two periods is strongly pre-
ferred. as periodicity means that values are repeated at regular
intervals. which can only be veriﬁed with two full periods. LS can
handle data with one or less periods. but JTK and PH require at
minimum of one full period.

Considering the interactions of noise. sampling rate and shape
is complicated (See Supplementary Figs $1783 for ROC plots
with area under curve (AUC)). In an ideal situation with no
noise and high sampling rate. JTK. LS and PH performed well at
distinguishing periodic from non-periodic signals. At low noise
levels. PH worked well and its ignorance of shape can be used to
find peaked profiles. However. PH’s performance degrades more
rapidly than LS and JTK under increasing noise and decreasing
sampling rate. As noise increases or sampling rate decreases. the
ability to detect damped and peaked profiles degraded most rap-
idly for all the algorithms. Where the data are noisy (e. g.
Gaussian noise SD = 50 with a peak-to-trough amplitude of
100) and low sampling rate (e. g. 17 samples across two periods).
the algorithms perform most poorly in distinguishing damped.
peaked and cosine two signals from non-periodic signals. but
performed better on cosine and trended signals. In this case. it
would be advisable to repeat the experiment with a higher sam-
pling rate andg‘or lower noise levels. It would also be possible to
apply algorithms to correct for other signals in the data. such as
trending. damping or noise: however. we did not test these types
of preprocessing on the performance of periodicity detection al-
gorithms. Where high noise or low sampling rate (but not both)

 

3178

[310'sreumofp105xo'sopeuuopnorq/ﬁdnq

# Samples

# Samples

LS
DL
PH

Pre-Process OR New Exp.

 

/3.IO'S[BIImOfp.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

A.Deckard et al.

 

JTK_CYCLE (Hughes et al., 2010): A set of reference curves (sinus-
oidal, but can be deﬁned) is generated to varying periods and phase shifts.
A pair-wise comparison of all points in a curve calculates whether they
are increasing or decreasing in relation to one another. The increasing/
decreasing pattern of the time series is then compared with the increasing/
decreasing pattern of each reference curve to determine the statistical
signiﬁcance of the correlation. The period and phase shift for the refer-
ence curve with the most signiﬁcant correlation is returned. The authors
of JTK (Hughes et al., 2010) provided an implementation in R.

de Lichtenberg (de Lichtenberg et al., 2005b): To measure the signiﬁ-
cance of periodicity, a background distribution is generated by creating a
set of random proﬁles by permuting the proﬁle’s expression values. The
P-value is the proportion of permuted proﬁles with Fourier score at least
as large as the original proﬁles observed Fourier score. For the signiﬁ-
cance of regulation, the gene expression proﬁle is compared with a set of
random proﬁles generated by selecting a value from a randomly selected
gene proﬁle at each time point. The P-value for regulation (amplitude)
is measured as the proportion of permuted proﬁles with standard devi-
ation at least as large as a time series’ observed standard deviation. The
implementation in R from Orlando et al. (2008) was used (see
Acknowledgements).

Persistent Homology (Cohen-Steiner et al., 2010): PH normalizes the
data from 0 to 1, and then pairs (in a subtle way) minima and maxima of
a time series. A measure is obtained by summing the differences (persist-
ence) between the maximum and the minimum of each pair. If there is
only one minimum and maximum pair, the measure is one, indicating a
perfect oscillation. Additional oscillations in the time series will create
more pairs, which will increase the score, indicating a less perfect curve.
Sliding windows with widths equal to the range of periods are used; the
period with the lowest score is returned. The last author of Cohen-Steiner
et al. (2010) provided a C++ implementation of the PH algorithm (see
Acknowledgements). See Supplement for additional details.

In the yeast cell cycle data (GSE8799) (Orlando et al., 2008), there is a
stress response during the recovery period; we, therefore, ignored the ﬁrst
two time points and looked only at the last 13 time points. There were
two replicates, for our analysis we used only the ﬁrst replicate. The data
were provided by the authors. For the yeast metabolic data (GSE3431)
(Tu et al., 2005), we evened the sample times in the data by making the
sampling at every 24minutes. Any blanks in the data were ﬁlled with
zeros. The data were downloaded from Gene Expression Omnibus. In the
plant root clock data (GSE21611) (Moreno-Risueno et al., 2010), we
applied evenly spaced time points to approximate the inferred timing.
The data were provided by the authors. For the mammalian circadian
rhythm data (GSEl 1923) (Hughes et al., 2009), the data were provided by
the authors. See Supplement for additional details.

ACKNOWLEDGEMENTS

The authors would like to thank Dave Orlando for his imple—
mentation of the DL method and Yuriy Mileyko for his imple—
mentation of the PH method. For the informative discussions
and critical reading of the manuscript, we would like to thank
Sara Bristow, Adam Leman and Christina Kelliher. They would

also like to thank the four anonymous reviewers for their
suggestions.

Funding: Defense Advanced Research Projects Agency
(D12AP00001).

Conﬂict of Interest: none declared.

REFERENCES

Ahnert,S. et al. (2006) Unbiased pattern detection in microarray data series.
Bioinformaticx, 22, 147171476.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac—
tical and powerful approach to multiple testing. J. R. Stat. Soc. Seriex B
Met/1040]., 57, 2897300.

Cohen—Steiner,D. et al. (2010) Lipschitz functions have L p —stable persistence.
Found. Comput. Mat/1., 10, 1277139.

de Lichtenberg,U. et al. (2005a) Comparison of computational methods for the
identiﬁcation of cell cycle—regulated genes. Bioiiy’ormaticx, 21, 11644171.

de Lichtenberg,U. et al. (2005b) New weakly expressed cell cycle—regulated genes in
yeast. YeaSt, 22, 119171201.

Dequeant,M. et al. (2008) Comparison of pattern detection methods in microarray
time series of the segmentation clock. PMS One, 3, e2856.

Futschik,M.E. and Herzel,H. (2008) Are we overestimating the number of cell—
cycling genes? The impact of background models on time—series analysis.
Bioinformaticx, 24, 106371069.

Glynn,E.F. et al. (2006) Detecting periodic patterns in unevenly spaced gene expres—
sion time series using Lombiscargle periodograms. Bioinﬁnmalicx, 22, 31(F316.

Hughes,M.E. et al. (2009) Harmonics of circadian gene transcription in mammals.
PLoS Genet., 5, e1000442.

Hughes,M.E. et al. (2010) JTK_CYCLE: an efﬁcient nonparametric algorithm for
detecting rhythmic components in genome—scale data sets. J. Biol. Rliytlimx, 25,
3727380.

Kallio,A. et al. (2011) Randomization techniques for assessing the signiﬁcance of
gene periodicity results. BMC Bioiiy’ormaticx, 12, 330.

Lomb,N. (1976) Least—squares frequency analysis of unequally spaced data.
Astrophys. Space Sci, 39, 4474162.

Moreno—Risueno,M.A. et al. (2010) Oscillating gene expression determines compe—
tence for periodic Arabidopsis root branching. Science, 329, 130671311.

Orlando,D. et al. (2008) Global control of cell—cycle transcription by coupled CDK
and network oscillators. Nature, 453, 9447947.

Scargle,]. (1982) Studies in astronomical time series analysis. II—Statistical aspects of
spectral analysis of unevenly spaced data. Axtropliyx. J., 263, 8357853.

Spellman,P.T.P. et al. (1998) Comprehensive identiﬁcation of cell cycle—regulated
genes of the yeast Saccharomyces cerevisiae by microarray hybridization. Mol.
Biol. Cell, 9, 327373297.

Straume,M. (2004) DNA microarray time series analysis: Automated statistical
assessment of circadian rhythms in gene expression patterning. In: Brand,L.
and Johnson,M.L. (eds) Methods in Enzymology. Vol. 383, Elsevier Academic
Press, San Diego, pp. 1497166.

Tu,B. et al. (2005) Logic of the yeast metabolic cycle: temporal compartmentaliza—
tion of cellular processes. Science, 310, 115271158.

Yang,R. and Su,Z. (2010) Analyzing circadian expression data by harmonic regres—
sion based on autoregressive spectral estimation. Bioiiy’ormaticx, 26, i1687i174.

Yang,R. and Zhang,C. (2011) LSPR: an integrated periodicity detection algoritth
for unevenly sampled temporal microarray data. Bioiiy’ormaticx, 27, 102371025.

Zhao,W. et al. (2008) Detecting periodic genes from irregularly sampled gene ex—
pressions: a comparison study. E URASIP J. Bioinform. Syxt. Biol, 2008,
769293.

 

3180

ﬁm'spzumol‘pmyo'sopeuuopuoiq/ﬁdnq

