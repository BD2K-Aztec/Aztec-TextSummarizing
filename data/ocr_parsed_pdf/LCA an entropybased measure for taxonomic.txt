36“égowsmoddmmow0103‘ Gagambwmi

36“égowsmoddmmow0103‘ Gagambwmi

56“égowsmoidmmowoio~&o:3m7.omm\

 

56“égowsmoidmmowoio~&o:3m7.omm\

 

56“égowsmoidmmowoio~&o:3m7.omm\

36“égowsmoddmmow0103‘ Gagambwmi

 

 

LC *: an entropy-based measure for taxonomic assignment within assembled metagenomes

 

 

Small Large GEBA MDM

:ij 111

0.6-

 

>i I9/V\

 

 

RMSE

0.4-

GJJV\

0.2- I
 -h I uh I 1

I I I I I I
LCA2 Majority LCA“ LCA2 Majority LCA“
Method

 

 

 

 

 

 

 

 

I I I
LCA2 Majority LCA“

Fig. 4. Root-mean-squared error (RMSE) for LCA2, Majority, and LCA*,
across experiments and distances. Error bars represent 95% conﬁdence
intervals drawn from a Student’s t—distribution.

difference between the three methods at the 95% conﬁdence level
(Fig. S5). In no cases were the RMSE statistics of voting—based
methods LCA* and Majority signiﬁcantly different at the 95%
conﬁdence level.

The voting—based LCA* and Majority methods had similar
performance in terms of both the simple—walk and WTD with
LCA* exhibiting a slightly larger tail with reference annotations
present (Figs. S1 and S3). However, this difference is not seen
without reference annotations (Figs. S2 and S4). However, the
two methods differed signiﬁcantly in their supremacy p—values
with and without the presence of reference annotations, LCA*
reporting substantially smaller p—values on average (Figs. S6 and
S7), consistent with LCA* taxonomies providing greater statistical
conﬁdence. Moreover, when we compare pairwise p—values, we can
see that in the majority of instances, LCA* reported more conﬁdent
majority taxonomies. However, in many instances the two voting—
based methods were convergent, reporting the same p—value when
an a—majority is found in the original annotations and no collapsing
of annotations was necessary (Fig. S8). With reference sequences
removed, a similar pattern is observed, although the statistical
advantage of LCA* is diminished (Fig. 9). The cluster of points
where the Majority method’s p—values are 1.0 indicates a deﬁnite
hazard in interpreting the reported taxonomy. The p—value will equal
1.0 where there is a tie for a majority taxonomy (i.e., X k : M),
and highlights a situation where an arbitrary decision is being made
between two or more taxonomies. Interestingly, none of the LCA*
estimates in our experiments had a p—value of one, suggesting that
because LCA* is compelled to ﬁnd some majority, occurrence of a
such a stalemate election is extremely rare.

6 DISCUSSION

In this work we described, formulated, and implemented
LCA*, an entropy—based method to assign taxonomy to contigs

assembled from environmental sequence information. By deﬁning
a mathematical framework to reason about taxonomy, LCA*
identiﬁes a sufﬁciently strong majority on the NCBI Tree while
minimizing entropy changes to the observed taxonomic distribution.
This strikes a compromise between the competing goals of
obtaining a sufﬁcient majority of at least 50% of annotations
as recommended by Condorcet’s Theorem, while minimizing
changes to the underlying distribution. A likelihood—ratio test was
implemented to test for the supremacy of predicted taxonomies,
reporting a p—value that can be used as as a measure of conﬁdence
and hazard for reported taxonomies. Using simulated and real—
world datasets, we empirically demonstrated that voting—based
methods, majority vote and LCA*, are consistently more accurate
in taxonomically identifying a sequence than the simple LCA2
method, and that LCA* taxonomy strikes a balance between
speciﬁcity and conﬁdence to provide an estimate appropriate to the
available information in the data.

While LCA* has a compelling theoretical basis for constructing
a majority from a variable taxonomic distribution, it is necessary
to consider several assumptions that the statistic makes. Due to
the inherent variability in homology—search, annotation databases,
or taxonomic summary statistics (e.g., Best—BLAST, LCA, etc.),
observed annotations can appear on the tree at various taxonomic
levels. This raises a philosophical issue that observed multinomial
bins cannot be viewed as completely independent, as internal
taxonomic annotations could overlap in this model. One possible
remedy is to discard all annotations that do not fall on the leaves
of the NCBI Tree. However, annotation of metagenomic contigs
can be quite sparse, so discarding internal annotations in the
name of independence simply decreases valuable statistical power,
and can artiﬁcially bias the signal towards an arbitrary taxonomy
by removing internal nodes. Alternatively, one could attempt to
distribute annotations from internal nodes equally to the observed
leaves in the tree. However, this creates its own discretization
issue, as in many cases votes can not be distributed equally, and
vote—splitting violates basic assumptions of the multinomial model,
i.e., votes are non—negative integers. Moreover, vote—splitting can
make the ﬁnal predicted taxonomy more difﬁcult to interpret, as the
distribution in each case could be very different from the observed,
and risks electing a more speciﬁc taxonomy than supported by the
data. In the end, to avoid these issues we opted to leave internal
annotations in the election.

Though LCA* will attempt to give reasonable estimates when
observed annotations are highly variable, being an alignment—
dependent binning method its performance suffers substantially
when reference annotations are not presence in the database,
limiting its capacity to estimate unknown taxonomy. Here,
the method could beneﬁt by expanding the current framework
to incorporate information from the statistical properties of
sequences found in alignment—independent methods and ribosomal
or Clusters of Orthologous Group (COG) marker genes. The
election model could also be expanded to incorporate genomic—
signature information into a weighted—voting or vote—splitting
framework, which perhaps could help improve statistical conﬁdence
in cases where observed annotations are extremely sparse.
However, expanding our current voting theory model to include
continuous variables is not compatible with the current multinomial
distribution. Range voting provides an alternative perspective that
attempts to accommodate a continuous voting scale, but its theory

 

 

36“égogmoddmmow0103‘ Gagambwmi

