Bioinformatics, 31, 2015, i142—i150
doi:10.1093/bioinformatics/btv251
ISMB/ECCB 2015

 

Deconvolving molecular signatures of
interactions between microbial colonies
Y.-C. Harn1, M. J. Powersz, E. A. Shank2'3'4 and V. Jojic1'*

1Department of Computer Science, University of North Carolina, Chapel Hill, NC 27599-3175, USA, 2Department of
Biology, University of North Carolina, Chapel Hill, NC 27599-3280, USA, 3Department of Microbiology and
Immunology, University of North Carolina, Chapel Hill, NC 27599-7290, USA and 4Curriculum of Genetics and
Molecular Biology, University of North Carolina, Chapel Hill, NC, USA

*To whom correspondence should be addressed.

Abstract

Motivation: The interactions between microbial colonies through chemical signaling are not well
understood. A microbial colony can use different molecules to inhibit or accelerate the growth of
other colonies. A better understanding ofthe molecules involved in these interactions could lead to
advancements in health and medicine. Imaging mass spectrometry (IMS) applied to co—cultured
microbial communities aims to capture the spatial characteristics of the colonies' molecular finger—
prints. These data are high—dimensional and require computational analysis methods to interpret.
Results: Here, we present a dictionary learning method that deconvolves spectra of different mol—
ecules from IMS data. We call this method MOLecular Dictionary Learning (MOLDL). Unlike stand—
ard dictionary learning methods which assume Gaussian—distributed data, our method uses the
Poisson distribution to capture the count nature of the mass spectrometry data. Also, our method
incorporates universally applicable information on common ion types of molecules in MALDI mass
spectrometry. This greatly reduces model parameterization and increases deconvolution accuracy
by eliminating spurious solutions. Moreover, our method leverages the spatial nature of IMS data
by assuming that nearby locations share similar abundances, thus avoiding overfitting to noise.
Tests on simulated datasets show that this method has good performance in recovering molecule
dictionaries. We also tested our method on real data measured on a microbial community com—
posed of two species. We confirmed through follow—up validation experiments that our method re—
covered true and complete signatures of molecules. These results indicate that our method can dis—
cover molecules in IMS data reliably, and hence can help advance the study of interaction of
microbial colonies.

Availability and implementation: The code used in this paper is available at: https://github.com/friz
fealer/lMsiproject.

Contact: vjojic@cs.unc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

1.1 Background

Microbial metabolites have been of great importance as a source
of clinically relevant bioactive compounds. One microbial colony
may secrete different metabolites, or alter the quantity of certain me-
tabolites when encountering other colonies. Understanding the ef-
fects of co-culturing may provide a means to manipulate metabolite
production. However, few studies have investigated how changes in
microbial community composition shape metabolite production
by its members (Hoefler et (11., 2012; Watrous et (11., 2012). One

© The Author 2015. Published by Oxford University Press.

technology useful for such investigations is matrix-assisted laser
desorption/ionization time-of-flight (MALDI-TOP) imaging mass
spectrometry (IMS), or MALDI-1M8. MALDI-1M8 has been success-
fully applied to a variety of biological systems over the last decade.
It is a promising tool because it can be used on a wide array of sam-
ple types. In addition, it has ability to provide information about
spatial distribution of molecular species abundances (Alexandrov,
2012). However, the molecular species and their abundances are not
directly measured. Rather, they are reflected in ion counts across
over 104 7 105 mass-charge ratios. Each molecular species may con-
tribute to multiple mass-charge ratio measurements and different

i142

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

/310‘srcumo[p10}xo‘sopcuHOJIIrorq/ﬁdnq

Deconvolving molecular signatures of interactions between microbial colonies i143

 

molecular species may contribute to the same measurement.
An ability to uncover the molecular species and their abundances
from these mass spectra would make MALID—IMS especially useful
in unraveling the mechanisms of interactions in microbial commun—
ities. Due to the complexity of these data, direct inspection is not
practicable. Thus, it is natural to resort to statistical methods to ob—
tain succinct summaries of MALDI—IMS data.

Computational and statistical methods for MALDI—IMS analysis
have been proposed (Alexandrov, 2012; Jones et al., 2012; Kobarg
et al., 2013; Trede et al., 2012). These methods can be divided into
several groups depending on their focus. One group of methods
applies supervised learning, focusing on finding important features
(biomarkers) in the data for purposes of phenotype classification.
Such approaches include use of symbolic discriminant analysis
(Lemaire et al., 2007), Support Vector Machine (Groseclose et al.,
2008), genetic algorithms (Cazares et al., 2009), elastic net (Hong
and Zhang, 2010) and aNN (Rauser et al., 2010). Another group of
methods focuses on segmentation of IMS data with unsupervised
clustering of spectra (Alexandrov et al., 2013a,b).

Our work, in contrast, belongs to a group of methods focusing
on concise data representation. Previous methods in this group used
principal component analysis (PCA) (Leendert et al., 2007; Plas
et al., 2007), independent components analysis (ICA), non—negative
matrix factorization (NNMF) (Siy et al., 2008) and probabilistic la—
tent semantic analysis (pLSA) (Hanselmann et al., 2008). All of
these methods showed good results in decomposing IMS signals into
the components of biological interest. PCA and ICA use negative
values in the decomposition; negative values do not have a natural
interpretation as components of the mass spectrum or abundances
of molecular species. On the other hand, NNMF and pLSA produce
non—negative components. Nevertheless, NNMF uses alternating
least squares aimed at continuous values to decompose a count data
matrix. This approach lacks a generative model and thus its output,
while non—negative, is still not easily interpreted. Finally, pLSA has a
generative model for the data, allowing for a simple interpretation,
but its application has been focused only on modeling an anatomical
area in tissues or other biological meaningful unit that corresponds
to a composition of a large array of different compounds. For ex—
ample, the pLSA implemented in Bruker’s software (ClinProTools
3.0) was used in analyzing a tumor dataset in MALDI—IMS
(Hanselmann et al., 2008; Soren-Oliver and and Klaus Meyer,
2015). The report showed that the method can recover signature
spectra of cell types from the data. However, identification of cell
types can be accomplished using few discriminative spectra. Hence,
this approach is not suitable for fine—grained analysis of the whole
repertoire of microbial metabolites.

In this article, we model IMS data in terms of molecular signa—
tures and abundances of these molecules. By decomposing mass
spectra into contributions from different molecular species, we can
infer directly both novel molecules and their abundances. To accom—
plish this, we propose a Dictionary Learning method, drawing on
work in machine learning (Balasubramanian et 41., 2012; Lee et 41.,
2006; Maurer et al., 2013; Mehta and Gray, 2013; Olshausen and
Field, 1997). We deem this method Molecular Dictionary Learning
(MOLDL).

The key contributions of our work are outlined next. We intro—
duce the first generative model of IMS data. This model takes into
account the count nature of the data, background information on
the ionization types and the spatial organization of the data.
Recovery of abundances and spectra of molecular species can be
seen as probabilistic inference in our model. For this purpose, we
derived and implemented an efficient bi—convex optimization

algorithm. Crucially, our method does not require users to specify
the number of the molecular species in the sample, as this number is
uncovered automatically. We conducted computational experiments
to demonstrate performance of this method on both synthetic and
real datasets.

1.2 Notation and terminology

We will assume that each spectrum is of length 5, and we assume
W X la such spectra are arranged on a grid of width w and height la.
We will use y’l to denote spectrum measured at location i, j on the
grid, and Y to denote all of those spectra. Note that Y is a tensor of
size s X W X la. To denote measurement of ion counts of ith mass/
charge (m/z) in spectrum y, we will write 31,-. We will call each loca—
tion on the grid a grid cell.

We will refer to molecules with the same molecular weight and
ionization preferences as a molecular species (note that different
molecules can appear indistinguishable to a measurement technol—
ogy such as mass spectrometry and contribute to the same molecular
species). A measured spectrum can be seen as a linear combination
of spectra of different molecular species. We will organize spectra of
molecular species into a matrix D, referred to as a dictionary, with
each column of D being a single molecular species” spectrum.

We will assume that dictionary has 5 columns, hence 5 different
dictionary spectra. Hence, we will have a capacity to model as many
different molecular species as there are different mass—charge ratios.
However, this is simply an upper bound on the number of molecular
species. We will denote the lath spectrum in the dictionary with dk.
Hence, the ith charge of the lath dictionary element will be a scalar
dik, an entry in the ith row and lath column. To differentiate between
spectra in a dictionary and spectra in actual experimental data, we
will refer to spectra in the dictionary as dictionary elements.

We will refer to level of contributions from different dictionary
elements as abundances and denote them using w. A vector of abun—
dances w will be of length 5, since we can use at most 5 dictionary
elements. In addition because each position i, j on the grid has its
own set of abundances, we will use W, a tensor of size s X W X la, to
denote the set of all abundances on a grid, and w’l to denote an
abundance vector belonging to a location i, i. For each location i, i,
there is a offset wo added in the linear combination of predictors.
Therefore W0 is a matrix of size W X la to denote the set of all offsets
on a grid. We will use 1 to denote a vector of all 15.

2 Methods

In order to explain our model, we will incrementally approach the
full model by first introducing dictionary construction in Section
2.1, followed by the space independent model in Section 2.2, culmi—
nating in space dependent model in Section 2.3. We show that both
space—dependent and space—independent models give rise to bicon—
vex objectives. We then provide an algorithm that can fit both mod—
els in Section 2.5. We must emphasize here that the inputs of this
algorithm are only the IMS—data Y and a dictionary pattern that is
based on MALDI mechanism and is independent of data. Molecular
species number that is an input of many dimension reduction algo—
rithm is learned automatically by our algorithm.

2.1 Constructing a dictionary non—zero pattern based on
MALDI—IMS’s prior knowledge

Only ionized molecules have signals in mass spectrometry.
Molecules, depending on their characteristics, can be ionized with
positive or negative charge; therefore, mass spectrometry with

[310'sp2umofp105xo'sopeuuopnotq/ﬁdnq

i144

Y.—C.Harn et al.

 

different charge modes are applied to detect different molecules.
Different molecules have different ionization preferences. Because
MALDI mass spectrometry is a soft ionization technique, molecules
are rarely fragmented; however, numerous ion adducts are possible.
Common ion types of MALDI-TOF in both positive and negative
mode often observed in microbial MALDI-IMS data are listed in
Table 1 (Gross, 2011). Given a putative peak M + H, corresponding
to a molecule of weight M, we can compute other possible peaks for
this molecule by adding the mass differences between different ion-
ization types. We will refer to the set of differences as A. For ex-
ample, a molecule yielding ions M +H with m/z 301.1 in the
positive mode can produce other ions with m/z values of 301.01
+1703 (M+NH4), 301.01 + 21.98 (M+Na), ... ,301.01 + 76.18
(M+2K-H). Hence, given an m/z value for M+H, denoted by r,
we compile a full list of putative peaks as r+A : {7+ (5)6 E A}.
Since an m/z value may come from any of the six ion types listed in
the table (in the positive mode), a dictionary element associated
with a particular M + H ion has six candidate non-zero entries cor-
responding to these peaks (the same idea applies to the negative
mode).

For a given molecular species, a dictionary element is allowed to
have non-zero entries only corresponding to putative peaks arising
due to different ionization types. More precisely, the only non-zero
entries will be DTS+ijme,Is+q+0.5[lpm)a q E s + A (0.5 ppm accounts
for the measurement error of :0.5 ppm Da m/z). If the m/z values
we infer do not appear in our data, we discard these values (peaks).
We call these non-zero entries in a dictionary a dictionary pattern.
Importantly, this pattern only determines the sparsity of the diction-
ary; all putative non-zeros in the dictionary are still treated as par-
ameters that have to be learned. Consequently, if the data show no
support for a particular molecular species giving rise to an ion type,
the corresponding entry in the dictionary will be zero. An illustra-
tion of such a dictionary and its relationship to theoretical data is
shown in Figure 1a.

A dictionary pattern is constructed based on the prior knowledge
of MALDI-IMS, which is shown in Table 1. Using this pattern
greatly reduces the problem complexity. For a dataset containing 71
m/z values, without any dictionary patterns, a general assumption of
it would be that every m/z value could come from one molecular

Table 1. The common ion types and their mass (the row of this
table is sorted by their m/z, and all m/z 3 listed here are rounded to
the second decimal points) for positive and negative mode

 

(a) Positive mode

 

 

Ionization types m/z

M + H M + 1.01
M + NH4 M + 18.04
M + Na M + 22.99
M + K M + 39.10
M + 2Na-H M + 44.97
M+2K-H M+77.19

 

(b) Negative Mode

 

 

Ionization types m/z
M.H20.H M-19.02
M-H M-1.01
M-Na-2H M + 20.98
M + Cl M + 34.97
M-K-2H M + 37.08

 

species, and every molecular species could gathering any of the m/z
values. This assumption leads to a dictionary of dimension 0(712).
In contrast, using dictionary pattern, we know one molecular species
with molecular weight M only generates the ion types listed in the
Table 1, so the number of parameters in a dictionary reduces to
O(cn), where c is the number of ion types. Therefore, dictionary pat-
terns reduce the chance for overfitting, the number of local minima,
and the running time. We demonstrate the utility of using a diction-
ary pattern in a synthetic experiment.

2.2 Space independent model with poisson noise

In our space independent model, we assume that spectra in neigh-
boring locations on the grid are independent from each other.
Furthermore, once we determine the abundances, w, of different dic-
tionary elements, different entries of spectrum y will be independent
from each other. This is a typical independence assumption used in
dictionary models. Due to the type of the data collected (i.e. non-
negative counts rather than continuous values), we model the data
in each yk as Poisson distributed. Hence, we have

31;, ID, w ~ Poisson(D;¢‘:w + wo).

We note a difference here in comparison to the standard Poisson
regression. Loosely, the Poisson regression can be seen as modeling
log counts. However, we assume that the contributions of ions with
particular m/z from two different compounds add up rather than
multiply to yield the measured counts. Hence, in the generalized lin-
ear model view, we use an identity link function rather than a
logarithm.

We note here that D)“ is a row of matrix D, and hence not the
same as dk which is a column. This row reflects a proportion of each
molecular species ions that have lath m/z ratio.

Even though the dictionary could have a large number of poten-
tial molecular species, only a subset of ions have non-negligible
counts across all grid cells. Moreover, even smaller set of them are
measured in any one grid cell. Hence, given our assumption of dic-
tionary structure described in Section 2.1, only a subset of dictionary

(a) (b) (C)

Dictionary Space independent model Space dependent model

Molecular Abundance: Mass»spec data Molecular species abundances Massespec imaging data
specres _ wk. _ ya
M1 M2 M3  Wu yu
l

w... (my WI 1 mini 1

in... mm rum 0

momma; w2 2 ﬁg 1 05

w 1313: t .
N m Mus M 0.5 d um 05 n
\ E

E 0
:0
0
I i
il 1"

D w~Laplace()\) y~Poisson(Dw) w‘ri~Laplace(A) y“ ~Poisson(Dw‘J)
w‘t‘vl-w‘l~Gaussian(0,9) y"'~Poisson(Dw“')
w‘l*‘-w‘J~Gaussian(0,9)

mm 232m mm

mm 2:2 9c 1519:
mm was nus

Fig. 1. The dictionary learning framework for deconvolving molecular signa-
tures from MALDI-IMS data. (a) Our probabilistic model of IMS data utilizes a
dictionary, D, to represent peaks associated with molecular species. Each col-
umn of the dictionary corresponds to a potential molecular species. A spars-
ity pattern in a column reflects prior knowledge of possible ion types. (b) For
our space independent model, we assume abundances of most molecular
species are zero as we do not expect to see every molecular species present
in the sample. A linear combination of molecular species in the dictionary, ac-
cording to their abundances w, gives rise to observed counts, y. (c) In mass-
spec imaging data, spectra are measured on a grid covering the biological
sample of interest. In the illustration, orange and green areas correspond to
two microbial populations. The grid areas covering the same population are
expected to have similar abundances of molecular species. Our space de-
pendent model captures this homogeneity expectation by assuming that
abundances in nearby locations on grid are frequently similar

ﬁm'spzumol‘pmyo'sopeuHOJmorq/ﬁdnq

Deconvolving molecular signatures of interactions between microbial colonies i145

 

elements will be used: those that can produce ions with non—negli—
gible counts. In order to encode this kind of sparsity assumptions,
we introduce an 21 penalty or, equivalently, a Laplace prior, on mo—
lecular species abundances. Similarly, we do not assume a priori that
each molecular species will generate each of its putative ion types
and hence place a similar penalty on dictionary entries as well. This
additional penalty is only meaningful for the entries we deemed can—
didate non—zeros, the rest are by definition zero. Hence, we have

wI/l ~ Laplace(/l),DI¢> ~ Laplace(¢>)

This model is illustrated in Figure lb.

2.3 Space dependent model with fusion penalty

It is natural to assume that MALDI—IMS measurements taken at
nearby locations will have very similar abundances of molecular spe—
cies. For an illustration see Figure 1c. One way to introduce this as—
sumption in the model is to penalize differences in parameters at
neighboring locations. In particular, one such penalty is

i./' 1+1.) 2 i./' i./'+1 2
‘ZOIIWI — W1 II2 ‘I' 0IIWI — W1 
11).!
This sum of squares penalty promotes shrinkage of the differ-
ences of abundances between nearest neighbors. Penalties on the
parameter differences are referred to fusion penalties. Here, we em—

ploy Z%, or a sum—of—squares penalty, on the differences.
Hence, the penalized objective for the space dependent model is

FLP(W7W07D7 Ar (1)7   :  + w0)}

i.j.lz
— Emmi" + was — Bogota
i.j.lz i.j.lz
— 2:1er — a: 1d,...)

i.j.l lam
 . 1.. 2   1 2
- ZOIIWV - ij ’IIz + 0|le’ - WWI Hz-
11).!

This model is illustrated in Figure 1c. MOLDL optimizes the
function FLP by optimizing W given D and optimizing D given W
alternatingly. The details of these two algorithms and the details of
choosing hyperparameters are shown in the Supplementary data.

2.4 Biconvexity of space dependent model’s objective

THEOREM 1:The objective in Equation 2.3 is biconvex in abundances,
W and W0, and dictionary, D.

PROOF: Sketch: To show that the function FLP is bi—convex in
(W, W0) and D, we need to show that the function is convex in
(W, W0) for a fixed D and vice versa. For a fixed D the objective is a
sum of a convex function with an affinely transformed argument
Zi.z.klog{Dk.;wi‘/}, a linear functions of w and wo, a convex function
IwI‘l I and another convex function with an affinely transformed ar—
guments  — wI‘jH I  As a sum of convex functions, the function
FLP is convex for a fixed D.

For a fixed (W, W0), the function FLP has three terms that are
influenced by D. The first term is a convex function with an affinely
transformed argument linear function of D, Zi.j.klog{Dk.:wi:/}. The
second term is a linear function of D, —(ZWz Dk.:w’:/). The third
term is a convex function Idka. As a sum of convex function, the
function FLP is convex for a fixed W, W0. Hence, the function FLP
is biconvex in abundances and dictionary. III

The statement of biconvexity holds even for 0: 0 so fitting the
space independent model is also a biconvex optimization problem.

2.5 Algorithm

Algorithm 1 shows pseudo—code for MOLDL. We initialize 20 as log
(y + 1) and Din” can be any matrix which honors the non—zero pat—
tern constructed in Section 2.1. Here, we use NNMF on non—zero
entries for dictionary initialization in real cases. Also, we use
‘updateW—ADMM’ to refer to an implementation of W updates,
outlined earlier. The algorithm iteratively updates W, W0, and D
until the function FLP converges or the change in W and D becomes
smaller than a certain value.

 

Algorithm 1. Molecular Dictionary Learning

 

Input: Y, Dini’J, 0, d), loopNum, tol1, t012
Output: D,W,Wo
WW) 2 0; W30) 2 0; D(0) : Dinit;

o
If) I I {Y + 1}; 0
preva : —inf; lp : FLP(W(0) , WI) I,D(0) , A, 0, d); y);
for i: 1; i < loopNum; i++ do

W“),ng :

updateW — ADMM (D(i_1),W(i_1),Wg_1),

28‘1).zl"‘”.z¥‘“.i.my);

D“) : argmaxaFLPov“).WW1).(1w);

if Ilp — prevaI < t011 or

(max(WIi) — WOT“) < t012 and

max(D(’) — D(’_1)) < t012) then

break;

end ‘

prevlp 21p; 1p = FUN/I") . W3) . D“). A. 0. d» y);
end

 

3 Results

We ran our method on three synthetic datasets to show its perform—
ance. MOLDL was then applied to two real datasets and evaluated
based on its ability to recover dictionary elements corresponding to
known molecular species in the sample.

3.1 Synthetic data results
We present three synthetic experiments with different purposes.
Because the ground truth dictionaries of these experiments are
known, we quantify performance of our and other’s methods in
terms of dictionary recovery. Here, we use an entry—by—entry com—
parison and cross—dictionary coherence as indices of the recovery. If
a dictionary size is small, we can compare the ground truth diction—
ary and the dictionary learned by computational methods entry—by—
entry. If the dictionary size is large, we use cosine similarity to com—
pute agreement between pairs of dictionary elements. For a ground
truth dictionary element dm, and a learned dictionary element (1:11,
we will refer to a pair of dictionary elements with the same index as
matched. For example, if dm and d,“ are matched, all other pairs are
mismatched. The cosine similarity of the two (1:1,, d,“ vectors is com—
puted as cos(dm,d:,,) dm’d'“

- : ridmlldlur . . . . ~
and D we can compute a cosme Similarity matrix 6,3; : cos(di, dj).

. Hence, given two dictionaries, D,

 

We note that cosine similarity matrix between a non—negative dic—
tionary and itself may not be a diagonal matrix.

A reconstructed dictionary might contain the same elements as
the ground truth dictionary, but in a different order. To obtain

ﬁle'spzumol‘pmJXO'sopeuHOJHioiq/ﬁdnq

Kuhn, 1955

Figure 2

1111 I

th
EIMOLDL w p
I:IMOLDL w/o p

Figure 2

Figure 3

|:|ground truth
I:IMOLDL
EjNNMF
:IpLSA

 

/310'S[Buln0prOJXO'SOIJBLUJOJIIIOIq/ﬂduq

(2013)

Figure 4

 

Suppleiiieiitar) data
Suppleiiieiitar) data
Li and Ngom

Liu el al. (2010)

Figure 4

Figure 4

Figure 4
Figure 4

Figure 4

Fig. 4

I:Itrue dictionary elements
I:Italse dictionary elements

|:Itrue dictionary elements
:Italse dictionary elements

Fig. 4

Yang el al. (2012)

Chambers el al., 2012

Suppleiiieiitar) data

Gibb and Striiiiiiier, 2012
Du (7/ al., 2006

/310's112u1nofp10}xo"soiwuiJOJuioiqﬂ:duq

I:Iground truth
I:IMOLDL
I:IS—NNMF

IIoefler el al., 2012
\X’atrous el al., 2012

IIoefler el al., 2012
Atsushi el al., 1969 Boniiiatiii el al.,
1994

IIoefler el al., 2012
\X’atrous el al., 2012

Figures 5 6

 

I:Iground truth
I:IMOLDL
I:Is—NNMF

 

/310's112u1nofp10}xo"soiwuiJOJuioiqﬂ:duq

Deconvolving molecular signatures of interactions between microbial colonies i149

 

appear as false positives may indeed be real ions with a biochemical
hypothesis behind them.

In the positive mode, MOLDL, sparse—NNMF and sparse—pLSA
all learned four true positives. But sparse—NNMF and sparse—pLSA
also learned four false positives. In terms of false positives, MOLDL
performed better than other methods. Also the relative intensities of
the true positive entries from MOLDL has the smallest [1 distance
from those from purified surfaction compared to the other computa—
tional methods. The results for other surfactin molecules are shown
in the Supplementary data. In these cases, MOLDL performed better
then sparse—NNMF and sparse—pLSA by having less false positive
signal, and by recovering more accurate relative intensities of the
dictionary element entries.

Note that the relative intensities of some entries in the dictionary
element are less accurate. One reason might be due to poor initial—
ization such that MOLDL took more iterations to converge. The se—
cond reason might be we did not consider isotopic surfactin
molecules: they are one or two molecular weight difference and al—
ways appear together in the same sample (Pathak and Keharia,
2014). When considering different forms of surfactins, the ion type
of an isotopic surfactin variant might have similar molecular weight
of the ion type of another form of surfactin. For example, if a iso—
topic surfactin—C14 has the molecular weight 1024, it has a signal in
1047.29m/z ([M+Na]) that is within the error range of the m/Z
value of ion type [M + K] of surfactin—C13. As we did not group the
signal of isotopic surfactin—C14 into a dictionary element, it is pos—
sible that it was included in another element that made the
deconvolution of signals inaccurate. The third reason might be the
modeling of MALDI—IMS data is not accurate, due to distributional
assumptions such as Gaussian or Poisson noise. One possible
distribution choice that might lead to better results is negative—
binomial. Compared with pLSA and NNMF, the framework of dic—
tionary learning makes it easier to incorporate distributions other
then the Gaussian distribution into the modeling of MALDI—IMS
data, allowing this to be tested easily in future iterations of the
method.

In the results section, we compared all the state—of—the—art
computational methods of deconvolving MALDI—IMS data on syn—
thetic examples and real datasets. MOLDL performed better then
other methods both in true positive and true negative rate. It can
learn the most complete molecular signature of a molecular species.
Also, based on the dictionary pattern used, MOLDL can learn the
signatures corresponding to molecules based on biochemical know—
ledge, which other methods cannot. Third, with the framework of
dictionary learning, MOLDL is extensible to other distributions.
Our future work will be based on this framework to improve
learning the relative intensities in the dictionary elements more
accurately.

4 Conclusion

In this article, we present MOLDL, a Dictionary Learning method,
aimed at summarizing MALDI—IMS data. This method deconvolves
m/z signals into components that belong to different molecular spe—
cies. Our method models the data as Poisson distributed, incorpor—
ates the possible ion types of MALDI mass spectrometry, leverages
the spatial dependency of IMS data, and can learn the number of
molecular species present in the MALDI—IMS data automatically.
We implemented this method and develop a straightforward method
for choosing its hyperparameters. We tested it on three synthetic

and two real experimental datasets, and showed that, compared
with prior approaches, our method provides superior recovery of
molecular signatures.

Funding

This research is supported by Lineberger Comprehensive Cancer Center and
UNC University Cancer Research Fund.

Conﬂict of Interest: none declared.

References

Alexandrov,T. (2012) Maldi imaging mass spectrometry: statistical data ana-
lysis and current computational challenges. BMC Bioinformatics, 13
(Suppl. 16), S11.

AlexandrOV,T. et al. (2013a) Analysis and interpretation of imaging mass spec-
trometry data by clustering mass-to-charge images according to their spatial
similarity. Anal. Chem., 85,11189—11195.

AlexandrOV,T. et al. (2013b) Maldi-imaging segmentation is a powerful tool
for spatial functional proteomic analysis of human larynx carcinoma.
]. Cancer Res. Clin. Oncol, 139, 85—95.

Atsushi,K. et al. (1969) Determination of fatty acid in surfactin and elucidation
of the total structure of surfactin. Agric. Biol. Chem., 33, 973—976.

Balasubramanian,K. et al. (2012) Smooth sparse coding Via marginal regres-
sion for learning sparse representations. CORR, abs/1210.1121.

Bonmatin,]. et al. (1994) Solution three-dimensional structure of surfactin: a
cyclic lipopeptide studied by 1H-NMR, distance geometry, and molecular
dynamics. Biopolymers, 34, 975—986.

Cazares,L.H. et al. (2009) Imaging mass spectrometry Ofa speciﬁc fragment of
mitogen-activated protein kinase/extracellular signal-regulated kinase kin-
ase kinase 2 discriminates cancer from uninvolved prostate tissue. Clin.
Cancer Res., 15, 5541—5551.

Chambers,M. et al. (2012) A cross-platform toolkit for mass spectrometry and
proteomics. Nat. Biotechnol., 30, 918—920.

Du,P. et al. (2006) Improved peak detection in mass spectrum by incorporat-
ing continuous wavelet transform-based pattern matching. Bioinformatics,
22, 205 9—2065.

Gibb,S. and Strimmer,K. (2012) MALDI-quant: a versatile r package for the
analysis of mass spectrometry data. Bioinformatics, 28, 2270—2271.

Groseclose,M.R. et al. (2008) High-throughput proteomic analysis of forma-
lin-ﬁxed parafﬁn-embedded tissue microarrays using MALDI imaging mass
spectrometry. Proteomics, 8, 3715—3 724.

Gross,].H. (2011) Mass Spectrometry, 2nd edn. Springer, Berlin.

Hanselmann,M. et al. (2008) Concise representation of mass spectrometry
images by probabilistic latent semantic analysis. Anal. Chem, 80, 9649—9658.

Hoeﬂer,B. et al. (2012) Enzymatic resistance to the lipopeptide surfactin as
identiﬁed through imaging mass spectrometry of bacterial competition.
Proc. NatlAcad. Sci. U.S.A., 109, 13082—13087.

Hong,D. and Zhang,F. (2010) Weighted elastic net model for mass spectrom-
etry imaging processing. Math. Model. Nat. Phenom., 5, 115—133.

Jones,E. et al. (2012) Imaging mass spectrometry statistical analysis.
]. Proteomics, 75, 4962—4989.

Klerk,L. et al. (2007) Extended data analysis strategies for high resolution
imaging ms: New methods to deal with extremely large image hyperspectral
datasets. Int. ]. Mass Spectrom, 260, 222—236.

Kobarg,].H. et al. (2013) Numerical experiments with MALDI imaging data.
Adv. Compnt. Math., 40, 667—682.

Kuhn,H.W. (1955) The Hungarian method for the assignment problem.
Naval Res. Logist. Q, 2, 83—97.

Lee,H. et al. (2007) Efﬁcient sparse coding algorithms. In: SchOlkopf,B. et al
(eds), Advances in Neural Information Processing Systems, MIT Press, Vol.
19, pp. 801—808.

Lemaire,R. et al. (2007) Speciﬁc MALDI imaging and proﬁling for biomarker
hunting and validation: fragment of the 11s proteasome activator complex,

ﬁle'spzumol‘pmJXO'sopeuHOJHioiq/ﬁdnq

i150

Y.—C.Harn et al.

 

reg alpha fragment, is a new potential ovary cancer biomarker. ]. Proteome
Res., 6, 4127—4134.

Li,Y. and Ngom,A. (2013) The non—negative matrix factorization toolbox for
biological data mining. Source Code Biol. Med., 8, 10.

Liu,S. et al. (2010) Efﬁcient probabilistic latent semantic analysis with spars-
ity control. In: Data Mining (ICDM), 2010 IEEE 10th International
Conference, pp. 905—910.

Maurer,A. et al. (2013) Sparse coding for multitask and transfer learning. In:
Dasgupta, S. and Mcallester, D. (eds.) Proceedings ofthe 30th International
Conference on Machine Learning (ICML-13). JMLR Workshop and
Conference Proceedings, pp. 343—351.

Mehta,N. and Gray,A.G. (2013) Sparsity—based generalization bounds for
predictive sparse coding. In: Dasgupta, S. and Mcallester, D. (eds.)
Proceedings of the 30th International Conference on Machine Learning
(ICML-13). JMLR Workshop and Conference Proceedings, Vol. 28, pp.
36—44.

Olshausen,B.A. and Field,D.]. (1997) Sparse coding with an overcomplete
basis set: a strategy employed by V1?. Vision Res., 37, 3311—3325.

Pathak,K. and Keharia,H. (2014) Identiﬁcation of surfactins and iturins
produced by potent fungal antagonist, bacillus subtilis k1 isolated
from aerial roots of banyan (ﬁcus benghalensis) tree using mass spectrom-
etry. 3 Biotech, 4, 283—295.

Rauser,S. et al. (2010) Classiﬁcation of her2 receptor status in breast cancer tis—
sues by MALDI imaging mass spectrometry. ]. Proteome Res., 9,
1854—1863.

Siy,P. et al. (2008) Matrix factorization techniques for analysis of imaging
mass spectrometry data. In: BioInformatics and BioEngineering, 2008.
BIBE 2008. 8th IEEE International Conference, pp. 1—6.

SOren-Oliver, D. and Klaus Meyer,A.W. (2015) Application Note # mt-111:
Concise Interpretation of MALDI Imaging Data by Probabilistic Latent
Semantic Analysis (plsa). http://www.bruker.com/ﬁleadmin/user_upload/8-
PDF-Docs/Separations_MassSpectrometry/Literature/Iiterature/
ApplicationNotes/MT-111_pLSA_ebook.pdf (10 March 2015, date last
accessed).

Trede,D. et al. (2012) On the importance of mathematical methods for analysis
of MALDI-imaging mass spectrometry data. Integr Bioinform., 9, 189.

Van de Plas,R. et al. (2007) Imaging mass spectrometry based exploration of
biochemical tissue composition using peak intensity weighted PCA. In: Life
Science Systems and Applications Workshop, LISA 2007. IEEE/NIH, pp.
209—212.

Watrous,]. et al. (2012) Mass spectral molecular networking of living micro-
bial colonies. Proc. Natl Acad. Sci., 109, E1743—E1752.

Yang,]. et al. (2012) Primer on agar-based microbial imaging mass spectrom-
etry. ]. Bacteriol, 194, 6023—6028.

ﬁle'spzumol‘pmJXO'sopeuHOJHioiq/ﬁdnq

