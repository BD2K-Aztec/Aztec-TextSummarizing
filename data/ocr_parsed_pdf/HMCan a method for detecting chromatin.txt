ORIGINAL PAPER

Vol. 29 no. 23 2013, pages 2979—2986
doi:1 0. 1093/bioinfonnatics/btt524

 

Genome analysis

Advance Access publication September 9, 2013

HMCan: a method for detecting chromatin modifications in
cancer samples using ChlP-seq data

1234*, Aurelie Herault2'5

t2,3,4

Haitham Ashoor
Vladimir B. Bajicl, Emmanuel Barillo

, Aurelie Kamoun2'5, Francois Radvanyiz's,
and Valentina Boeva

2,8,4

1Computer, Electrical and Mathematical Sciences and Engineering Division, Computational Bioscience Research Center
(CBRC), King Abdullah University of Science and Technology (KAUST), Thuwal 23955-6900, Saudi Arabia, 2lnstitut
Curie, 75248 Paris Cedex 05, France, 3INSERM, U900, Bioinformatics and Computational Systems Biology of Cancer,
4Mines ParisTech, Fontainebleau 77300, France and 5UMR 144 CNRS, Subcellular Structure and Cellular Dynamics

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: Cancer cells are often characterized by epigenetic
changes, which include aberrant histone modifications. In particular,
local or regional epigenetic silencing is a common mechanism in
cancer for silencing expression of tumor suppressor genes. Though
several tools have been created to enable detection of histone marks
in ChlP-seq data from normal samples, it is unclear whether these
tools can be efficiently applied to ChlP-seq data generated from
cancer samples. Indeed, cancer genomes are often characterized by
frequent copy number alterations: gains and losses of large regions of
chromosomal material. Copy number alterations may create a sub-
stantial statistical bias in the evaluation of histone mark signal enrich-
ment and result in underdetection of the signal in the regions of loss
and overdetection of the signal in the regions of gain.

Results: We present HMCan (Histone modifications in cancer), a tool
specially designed to analyze histone modification ChlP-seq data pro-
duced from cancer genomes. HMCan corrects for the GC-content and
copy number bias and then applies Hidden Markov Models to detect
the signal from the corrected data. On simulated data, HMCan out-
performed several commonly used tools developed to analyze histone
modification data produced from genomes without copy number
alterations. HMCan also showed superior results on a ChlP-seq data-
set generated for the repressive histone mark H3K27me3 in a bladder
cancer cell line. HMCan predictions matched well with experimental
data (qPCR validated regions) and included, for example, the previ-
ously detected H3K27me3 mark in the promoter of the DLEC1 gene,
missed by other tools we tested.

Availability: Source code and binaries can be downloaded at http://
www.cbrc.kaust.edu.sa/hmcan/, implemented in C++.

Contact: haitham.ashoor@kaust.edu.sa

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 13, 2013; revised on September 2, 2013;
accepted on September 3, 2013

1 INTRODUCTION

ChIP-Seq is a combination of chromatin immunoprecipitation
and next-generation sequencing of extracted DNA fragments

 

*To whom correspondence should be addressed.

(Robertson et al., 2007). The ChIP—Seq technique is now
widely used for identiﬁcation of epigenetic marks such as histone
variants and different covalent modiﬁcations of histone tails
(Furey, 2012). Common histone modiﬁcations include lysine
acetylation, methylation, ubiquitylation and sumoylation,
serine and threonine phosphorylation and arginine methylation
(Kouzarides, 2007). Histone marks help partitioning the genome
into euchromatin, which is accessible for transcription, and
heterochromatin. For instance, trimethylation of lysine 9 of his-
tone 3 (H3K9me3) and trimethylation of lysine 27 of histone 3
(H3K27me3) are marks associated with pericentromeric hetero-
chromatin and regions of polycomb-mediated repression
(Kharchenko et al., 2011). Also, histone modiﬁcations and his-
tone variants are often associated with distinct biological func-
tions. For instance, trimethylation of lysine 36 of histone 3
(H3K36me3) is a mark of transcription elongation; trimethyla-
tion of lysine 4 of histone 3 (H3K4me3) marks active or poised
promoters; monomethylation of lysine 4 of histone 3 (H3K4mel)
together with acetylation of lysine 27 of histone 3 correlates with
active enhancers (Kouzarides, 2007). Some marks are narrow
and cover 1710 consecutive nucleosomes (e.g. H3K4mel or
H3K4me3), whereas others (e.g. H3K27me3 and H3K36me3)
can cover large genomic regions, from tens to hundreds of kilo-
bases in length.

Although genetic modiﬁcations remain the main cause of
cancer development, epigenetic modifications may also play a
role in cancer development and progression (Esteller, 2007).
DNA methylation and/ or histone methylation and deacetylation
can be observed either as local modiﬁcations or along large gen-
omic regions. When regional, these modiﬁcations may cause
chromatin remodeling and silence expression of most genes in
these regions. This phenomenon is often called regional epigen-
etic silencing (RES) or long range epigenetic silencing (LRES).
RES/LRES has been shown to affect gene expression in many
cancer types including bladder cancer (Stransky et al., 2006),
colorectal cancer (Dallosso et al., 2012; Frigola et al., 2006),
breast cancer (Novak et al., 2008) and prostate cancer (Coolen
et al., 2010).

Because of the reversible nature of epigenetic modiﬁcations, a
substantial effort is being made to develop anticancer drugs able
to interfere with the activity of enzymes involved in histone
modiﬁcation (Biancotto et al., 2010).

 

© The Author 2013. Published by Oxford University Press. All rights reserved.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

91oz ‘Og isnﬁnV uo ::

H.Ashoor et al.

 

Many tools have been developed to facilitate the analysis of
histone modiﬁcation data obtained with the ChIP-Seq technique.
Some tools are designed to detect narrow peaks of type of
H3K4me3 (Kharchenko et al., 2008; Rozowsky et al., 2009;
Zhang et al., 2008). Other methods are able to identify epigenetic
marks covering large genomic regions; this is mostly done
through clustering (Zang et al., 2009), gene-by-gene quantiﬁca-
tion (Hebenstreit et al., 2011), Hidden Markov Models (HMMs)
(Qin et al., 2010; Xu et al., 2008) and linear signalenoise models
0(u et al., 2010).

However, there is no tool speciﬁcally developed to detect
histone modiﬁcations in cancer genomes that takes into account
copy number alterations. As we show later, most of the tools
tend to detect more signals in the regions of gain and less signal
in the regions of loss.

GC—content is known to inﬂuence read depth in both Illumina-
and SOLiD-generated datasets (Boeva et al., 2011; Dohm et al.,
2008). A possible difference in GC—content dependencies between
ChIP and control datasets can result in false predictions of
enrichment in histone modification marks (Chen et al., 2012).

Here we present a tool designed to identify histone modiﬁca-
tions in genomes with large copy number alterations. HMCan
(Histone Modiﬁcations in Cancer) corrects for copy number bias
and for GC—content bias. It then uses HMMs to detect regions
rich in histone modiﬁcations.

We chose to compare HMCan with three tools commonly
used to detect histone modiﬁcations with CHIP-seq data:
CCAT 0(u et al., 2010), MACS (Zhang et al., 2008) and
SICER (Zang et al., 2009). We show that HMCan is able to
detect signal enrichment in simulated cancer genomes better
than these three tools. Only HMCan and CCAT did not show
copy number bias. Separately, on an experimental ChIP-seq
dataset of H3K27me3 in a bladder cancer cell line, HMCan
provided better results than CCAT.

2 METHODS
2.1 HMCan algorithm

The HMCan workﬂow consists of (i) estimation of the copy number
proﬁle using a window approach on the control dataset (usually, input
DNA), (ii) calculation of the density proﬁle, (iii) normalization of the
density proﬁle by copy number, GC-content and background signal and
(iv) application of HMMs to detect regions with histone modiﬁcations

(Fig. 1).

2.1.] Data proﬁle construction Reads of ChIP and control datasets
are transformed into density proﬁles. To construct the proﬁles, the reads
are extended from read starts to the length of DNA fragments. Similarly
to FindPeaks, we use the triangular distribution for read extension (Fejes
et al., 2008). This method allows the user to set minimum median and
maximum fragment length used in the original ChIP-seq experiment.
After read extension, we keep one density value for each 50 nucleotides
(this value can be changed by the user).

2.1.2 Correction for copy number To estimate the copy number
variations in ChIP-seq data, we apply the algorithm implemented in
Control-FREEC (Boeva et al., 2011, 2012a). When the copy number of
each position is estimated, each value in the density proﬁle is corrected
based on its copy number value.

 

HMCan workflow

ChlP Library Control Library 12>

G 9 Estimate Copy

Number
Build density profile (:2!

Normalize by copy number

4}

Normalize by data size

Normalize by (EC—content
8 estimate noise rate

Normalize with background signal
Regions
enriched in
histone
modiﬁcations

Estimate initial HMM parameters

Apply iterative HMM

 

 

 

Fig. 1. HMCan framework. HMCan initially estimates copy numbers
from control data and it builds density proﬁles for both libraries. Then,
HMCan performs a set of normalization steps including normalization by
copy number, GC-oontent and background noise. Finally, HMCan
detects histone modiﬁcation regions with HMMs after estimating initial
parameters from the normalized proﬁle

2.1.3 Data size correction Assuming that the ChIP dataset contains
N reads and the control dataset contains M reads, the ChIP density
proﬁle is multiplied by the ratio between these numbers (M/N).

2.1.4 Initial peak calling To calculate the correct GC-oontent proﬁle
on the ChIP data and correctly estimate the initial parameters of HMM,
preliminary peak (enrichment signal) calling should be applied to serve as
a guide for both operations. A one-sided exact Poisson test is used to
label whether a bin belongs to a peak or not.

As a post-processing step, singleton bins labeled as peaks are removed.
Then, the bins labeled as peaks within 1 Kb are merged into a single peak
reg1on.

2.1.5 GC—content normalization Sequencing technologies may result
in association between number of reads mapped to a speciﬁc DNA region
and its GC-content (Benjamini and Speed, 2012). Here, we apply a cor-
rection to remove GC-content bias, which otherwise may result in
aberrant read counts.

We estimate the GC-content bias from the density proﬁles previously
constructed. For each value of bin density, we take a window of length
twice that of the fragment length. With each window, we associate the
density value corresponding to the central point and we record the value
of the GC-oontent of that window.

GC-values are grouped in non-uniform groups, e.g. GC-oontent be-
tween 0 and 20% (group 1), GC-oontent between 20 and 22% (group 2),
and so forth. (Supplementary Methods). For each value gc in the group,
we will deﬁne Dgc 7 the sum of densities of the bins that have GC-content
gc and Ngc the total number of windows that have GC-content gc. We
denote the expected density for each gc value as Age, deﬁned as:

Age 2 Dgc/Ngc- (1)
We will denote the average expected density along the genome by A,
deﬁned as:
_ ch D 85

A _ .
ch N 85

(2)

 

2980

112 /310's112u1n0fp10}x0"sorJBHJJOJurorq/ﬁduq 11101} popcorn/neg

9103 ‘Og isanV uo ::

HMCan: a method for detecting chromatin modifications in cancer

 

Then, each density value D can be corrected as follows:
D > A
A

 

D corrected 2

- (3)
g,.
The correction process is applied to both ChIP and control data inde-
pendently. This leads to a more accurate correction compared with cal-
culating GC-content bias (A and Age) for the control data only and then
correcting the ChIP and control densities based on the same A values.

Applying the described method to the control data is straightforward,
as the control data are not supposed to contain any signal. In the case of
ChIP data, the process is trickier because the signal contained in the ChIP
data may interfere with the GC bias, e. g. some histone modiﬁcations can
occur more frequently in GC-rich regions. To overcome this issue, we
ﬁrst apply the module of initial peak calling to identify regions that most
probably belong to the signal (‘peaks’). Then, we apply the described
method for CG-bias evaluation to the regions labeled as ‘not peaks’.

We denote the expected density A in the control data as Ammm, and A in
the ChIP data as ACMP.

To get the noise values in the ChIP and control data on the same scale,
we multiply the values of density in the control by the noise ratio AM“,
where:

Anoise = A‘ChIP/A‘control- 
To calculate the ﬁnal density proﬁle for the ChIP sample, we apply the
following normalization:

Dﬁnal = DChIP _ Dcontrol Anomh 

corrected corrected ‘

2.1.6 Initial estimation of HMM parameters HMM is used at the
ﬁnal stage for peak calling. The motivation behind using HMM is that
this approach is able to call wide peaks regardless of the noise that may be
present. Such large peaks can correspond to RES/LRES, and thus the
HMM approach is preferable. Moreover, the HMM approach allows the
calling of narrow peaks if their signals are relatively strong. Thus, this
approach will not miss short regions with epigenetic changes, e.g. signal
present at the Transcription start sites (TSSs) of repressed genes.

The designed HMM has two states: ‘peak’ (1) and ‘not peak’ (0). The
description of HMM can be found in Supplementary Methods. The ﬁrst
step in estimating HMM parameters and inputs is to re-call the peaks
after all normalization steps using a one-sided Poisson test.

The transition probabilities of HMM are estimated by counting four
possible combinations of the states. The emission probabilities are derived
from the distributions of the normalized densities over the peak and non-
peak data independently.

2.1.7 Iterative HMMs To infer the correct states along the genome,
we use the Viterbi algorithm (V iterbi, 1967). The Viterbi algorithm can
decode most of the states from the ﬁrst run based on the estimated par-
ameters. We noticed that for our data, predictions obtained by the ﬁrst
run contained a substantial amount of noise and predicted regions were
not as large as we expected. To overcome these two shortcomings of the
Viterbi algorithm, we introduced the iterative Viterbi algorithm, which
results in predictions corresponding to longer regions containing less
noise.

We iteratively use the following procedure. Each region associated
with a peak state has a score S, where S is the Bayesian log-likelihood
ratio:

P(peaklregion) P(regionlpeak) > P(peak)

 

s = 10 (6)

P(not peakl region) 2 P(region i not peak) > P(not peak) ’

where the probabilities are calculated based on the peak and density
distributions observed at the previous step. After calculating S for each
putative peak, we consider regions with scores less than SO, the minimum
score to accept the current peak in the next iteration, as ‘non-peaks’.

Then, the emission and transition probabilities are recalculated based
on the new set of regions. The process of recalculating emission and
transition probabilities is identical to the one used for the evaluation of
initial parameters. The algorithm keeps iterating until no improvement is
noticed or some maximum number of iterations is reached.

Finally, at the post-processing step, peaks within 1 Kb are merged into
a single region.

We also provide an option to calculate posterior probabilities for each
bin. HMCan calculates posterior probability using forwardibackward
algorithm given the normalized density value at each bin.

2.2 ChIP assay

The human bladder cancer cell line CL1207 was derived from a muscle-
invasive bladder cancer (De Boer et al., 1997). CL1207 was cultured in
Dulbecco’s modiﬁed Eagle medium F-12 GlutaMAXTM (Invitrogen,
Cergy Pontoise, France) supplemented with 10% fetal bovine serum
(Lonza Verviers, Verviers, Belgium). One conﬂuent 75 cm2 dish of
CL1207 was used for each ChIP-seq experiment.

CL1207 chromatin was extracted from cell nuclei and sheared enzy-
matically using an Active Motif kit (Active Motif, Rixensart, Belgium).
An extract of the original chromatin was kept as an internal standard
(input DNA). The 5 x 105 cells were immunoprecipitated per ChIP assay
with 4pg of rabbit polyclonal antibodies against trimethyl histone H3
lysine 27 (Upstate Biotechnology, Santa Cruz, CA) and Dynabeads®
Protein A (Invitrogen, Cergy Pontoise, France) in dilution buffer con-
taining 1% Triton X-100, 150 mM NaCl, 2mM EDTA, 20 mM TrisiHCl
at pH 8.0 and protease inhibitors. Six ChIP assays in the same experi-
mental conditions were necessary to perform one ChIP-Seq experiment,
so we used the total of 6 x 106 cells.

2.3 ChIP-seq library and SOLiD sequencing

The SOLiD System 2.0 workﬂow for the lower input/lower complexity
DNA fragment library preparation kit was used following the manufac-
turers’ instructions (Applied Biosystems) starting with 50 and 58 ng of
ChIP or input DNA, respectively.

ChIP-seq DNA fragment libraries were sequenced using the SOLiD
5500 system to produce 75-bpreads. The sequencing reads were aligned to
the hg19 human genome using Bowtie 0.12.8 (Langmead et al., 2009) with
the following options: ‘-C -k 1 -y wol-keepends’.

2.4 Gene annotation for ChIP-seq data

To assign predicted H3K27me3 marks to genes, we used the annotation
tool included in the Nebula pipeline (Boeva et al., 2012b). A mark was
assigned to a gene (RefSeq Release 50; 34062 gene isoforms), if it over-
lapped the region 1000 bp upstream and 1000 bp downstream of the gene
TSS (Young et al., 2011).

3 RESULTS

3.1 Evaluation on simulated data

To investigate the performance of HMCan on cancer samples,
we constructed a simulated ChIP-seq dataset for a ﬁctional his-
tone mark. The signal covered multiple regions across chromo-
some 1 (human genome, hgl9), with each region being of length
from 1 to 20 Kb. These regions comprised 5% of chromosome 1.
We simulated histone marks covering different numbers of alleles
in the regions of normal copy number, gain (of copy number)
and loss (of copy number) (Supplementary Table S1). In
our simulations, we set read length: 76 bp, fragment
length = 150 bp, ~20% of the reads came from the signal regions

 

2981

112 /310's112u1n0fp10}x0"sorJBurJOJurorq/ﬁduq 11101} popcorn/neg

9103 ‘Og isnﬁnV uo ::

H.Ashoor et al.

 

and ~80% of the reads came from the non-signal regions. We
assumed a constant length of DNA around one nucleosome to
be equal to 185 bp. We simulated more errors at the end of reads
using the standard Illumina error distribution. As sequencing
depth depends on GC-content, we used the experimentally
observed GC-content dependency function from the ENCODE
dataset for the MCF—7 cell line (input and H3K9me3). The code
for read generation together with parameters used and necessary
ﬁles can be found at the HMCan webpage (package
‘GenerateReadsChIP-seq’). Generated reads were aligned to
the reference genome with BWA (Li and Durbin, 2009) using
default parameters.

To quantify the quality of predictions of HMCan and other
tools, we calculated overlap between the predicted regions and
the simulated regions at the base pair level. If a base pair within a
predicted region overlapped with a simulated one, this base was
counted as true positive. If it lay outside of the simulated region,
it was counted as false positive. Finally, if a base pair within a
simulated region was not covered by any prediction it was
counted as false negative. Next, recall the deﬁnitions of recall
and precision as:

TP

' Precision : — (6)

T
R 11: —, .
“a TP+FN FP+ TP

The recall measures the sensitivity of a prediction method,
whereas precision measures the proportion of true predictions
within all positively predicted regions. In cases where the
number of true negatives is large, it is advisable to use ‘precision
vs recall’ curves instead of standard ROC curves (‘recall’ versus
‘false positive rate’) (Davis and Goadrich, 2006), for more details
check (Supplementary Methods). In our case, the number of TN
is large because the true signal covers a small fraction of the
genome (5%).

On the simulated data, HMCan demonstrated a better predic-
tion accuracy than three tools commonly used to detect histone
modiﬁcations with ChIP-seq data: CCAT (Xu et al., 2010),
MACS (Zhang et al., 2008) and SICER (Zang et al., 2009)
(Fig. 2). CCAT applies an iterative method to estimate the
noise-to-signal ratio in ChIP-seq and control data based on a
linear model. MACS shifts the reads toward the fragment centers
and uses a dynamic Poisson model that is able capture the mean
and standard deviation of the data. SICER applies a read clus-
tering approach to detect regions enriched with histone marks.
For each tool, we ranked the predicted regions according to the
in-built score or P—Value and grouped them in sets of regions
having similar scores. By using a threshold on this score or
P—Value, we obtained ‘precision vs recall’ curves. The accuracy
of predictions was qualiﬁed on the basis of the closest (Euclidian)
distance from the ideal predictor performance as introduced in
Bajic (2000), which in our case is the distance from the (1,1)-
corner of the ‘precision vs recall’ graph (Fig. 2). To make the
comparison fair, we checked several combinations of parameters
of other tools such as CCAT (Supplementary Fig. S1) and
SICER (Supplementary Fig. S2). The best parameters for
CCAT were: minScore:2, window: 1000; for SICER:
Gap : 600.The result corresponding to the best combination of
parameters is shown in Figure 2. With the best configuration of
parameters, HMCan was able to identify 88.4% of base pairs
within simulated signal regions, and its positive predictions

 

   
 

 

 

 

1.00 —
0.75 M
I:
.9
.9
ﬂ 0'50 — CCAT
0- — HMCan
0 25 — MACS
' — sroen
0.00
0.00 0.25 0.50 0.75 1.00

Recall

Fig. 2. Relationship between recall and precision for HMCan and other
histone modiﬁcation detection tools on the simulated data. HMCan
shows higher prediction accuracy compared with other tools and a notice-
able difference in the precision

contained only 3% of false-positive predictions at the base pair
level (Table l). CCAT, MACS and SICER achieved lower ac-
curacy than HMCan. Generally, SICER demonstrated a high
sensitivity of predictions (recall: 87.4%) together with a consid-
erable false discovery rate (Precision:79.8%). CCAT showed
high precision (81.1%), being second only to HMCan, but failed
to detect a large part of the signal (recall: 81%).

We assessed sensitivity of the HMCan’s iterative HMM
method to the change of the initial parameters (i.e. threshold
on the P—Value of the exact Poisson test). We reported
high values of Jaccard similarity index between predictions
corresponding to different P—Value thresholds (>0.97, see
Supplementary Methods and Supplementary Table S2). The cor-
responding ‘Precision vs Recall’ curves (Supplementary Fig. S3)
for different P—Value thresholds also conﬁrm that the ﬁnal pre-
dictions are not inﬂuenced by the initial threshold setting.

We explored what combination of copy number status and
number of alleles with histone modiﬁcation signal was the
most challenging for histone modiﬁcation detection (Fig. 3). As
expected, for all tools it was more difﬁcult to detect the correct
regions in the situation when only one allele out of four was
bearing a histone modiﬁcation mark (Fig. 3: C:4, A: 3). In
this extreme situation, SICER demonstrated the best sensitivity
compared with other tools. However, the best combination of
recall and precision was achieved by HMCan. Interestingly, ac-
curacy of predictions of SICER and MACS highly depended on
copy number (Fig. 3, diagonal panels with A : C). For instance,
the precision values of SICER’s and MACS’ predictions were
close to one when the signal was present in one allele out of
one or in two alleles out of two (Fig. 3, A: C: l and
A: C:2). When the signal was present in three alleles out of
three or in four alleles out of four, both MACS and SICER
predicted more signal than it was put to the simulated data
(Fig. 3, A:C:3 and A:C:4).

HMCan and CCAT did not demonstrate such copy number
bias. Thus, we conclude that these two tools are the most suitable
for histone modiﬁcation signal detection in cancer data.

 

2982

112 /310's1izu1n01p101x0"sorJBurJOJHrorq/ﬁduq 111011 pap1201umoq

9103 ‘0g isanV uo ::

HMCan: a method for detecting chromatin modifications in cancer

 

Table 1. HMCan provides better accuracy of predictions than CCAT,
MACS and SICER on simulated data

 

Method Best precision Best recall Best combination

 

Precision Recall Precision Recall Precision Recall

 

HMCan 0.984 0.493 0.939 0.888 0.971 0.884
CCAT 0.841 0.578 0.354 0.913 0.811 0.810
MACS 0.766 0.052 0.682 0.750 0.699 0.735
SICER 0.828 0.288 0.271 0.958 0.798 0.874

 

Note: The ‘best combination’ corresponds to the shortest distance from the ideal
predictor performance. The results of the best performing methods are shown in bold.

3.2 Evaluation on H3K27me3 data

To assess the performance of HMCan on real data, we generated
ChIP-seq dataset for trimethylation of lysine 27 on histone H3
(H3K27me3) for the CL1207 human bladder transitional cell
carcinoma cell line (see Materials and Methods). We compared
HMCan and CCAT on this dataset. As the MACS and SICER
tools demonstrated a bias toward high copy number regions
(Figs 3 and 4), the comparison of HMCan with MACS and
SICER is given in Supplementary Materials (Supplementary
Figs S4 and S5 and Supplementary Table S3).

To detect the H3K27me3 mark, we ran HMCan and CCAT
with the parameters learned from the simulated data study. We
considered all regions detected by HMCan or CCAT regardless
of the score (see justiﬁcation in Supplementary Methods).
Overall, 32.8 and 28% of the genome were covered by regions
predicted by HMCan and CCAT, respectively. There was a large
overlap in the predictions (Fig. 5A and B). Further, we will
show that genomic regions, predicted to bear the repressive
H3K27me3 mark by HMCan only, are unlikely to be false-
positive predictions. We will demonstrate that such regions,
when falling within gene promoters, suggest lower gene expres-
sion. Also, the profile of HMCan predictions around gene TSS
has a relatively more prominent valley at TSS than the proﬁle of
CCAT predictions. Finally, we will show that predictions of
HMCan are more accurate for a set of qPCR validated
H3K27me3 regions in the CL1207 cell line.

We studied the correlation between gene expression and
H3K27me3 predictions by HMCan and CCAT in promoter
regions. We used gene expression values calculated from exome
arrays (unpublished data) for the CL1207 cell line. Normalization
was performed with the robust multiarray averaging (RMA)
method to get exon expression signals; then the median over
exon signals was calculated to get a signal value per gene.
H3K27me3 is a repressive histone mark associated with DNA
methylation of CpG islands in gene promoters (Ku et al., 2008).
Thus, we expected the genes with the real H3K27me3 mark in
promoter (TSS :l: 1 Kb) to have lower expression than genes with-
out H3K27me3 in the promoter. Indeed, genes for which none of
the tools predicted an H3K27me3 site had higher expression than
genes with H3K27me3 predicted by both CCAT and HMCan
(Fig. 5C; one-tailed Mann-Whitney test, P—Value<10_16,
median values 117.94 versus 29.24). Interestingly, expression
values of genes with H3K27me3 predicted by HMCan only

 

 

 

 

 

 

 

 

 

 

 

 

1.00 —_ — 1.00
015 m 075
0.50 1 l .
025 0:1 0:2 0:3 0:4 332
mm A=1 A=1 A=1 A=f 0m
0 .2505 .75 1. _._____ __— 1.00
0.75
(3:2 0:3 I Ch  :9
A:2 A:2 A=2 0'00 g
0 .25 0.5 .751. —— 1.00 {g-
- HMCan | 33 3
— CCAT 0:3 C- 0'25
- MACS A=3 A=3 ‘
- SICER . . . . . 9‘00
0 .25 0.5 .15 1 1.00
0.75
C = Copy number _ 0.50
A = Number of alleles with the signal if 0.25
‘4 0.00

 

 

 

0.25 0.5 .75 1.
Recall

Fig. 3. Relationship between recall and precision for HMCan and other
histone modiﬁcation detection tools on simulated data sub regions asso-
ciated with different copy number status and signal

 

Dohm

IogRatio copies

 

HMCan

 

CCAT — u--- l n l- |l_|llll|l nun-unu-ni—n-m l- lllln-l llllIl--ll nun—um-
num- nun-alum Inim- II IllIlIl-IIII IIIII IM-I II I.

MACE
SlCER -

 

- _..-..-a—. ui—n. uni-i u... -—-u - man" i- a

 

 

 

a suite 100m: 150MB
Position [cm-i)

Fig. 4. Predictions of SICER and MACS are biased toward regions of
genomic gain, whereas predictions of CCAT and HMCan do no show
copy number bias. Top track: copy number proﬁle for chromosome 8 of
the CL1207 human bladder transitional cell carcinoma cell line calculated
by GAP (Popova et al., 2009) using SNP array technology; Bottom
tracks: regions predicted to have the H3K27me3 mark by HMCan,
CCAT, MACS and SICER. The black frame shows the chromosome
arm 8p, which has lower density of sites predicted by MACS and SICER

were signiﬁcantly lower than expression values of genes with
H3K27me3 predicted by CCAT (Fig. 5C; one-tailed Mann-
Whitney test, P-Value 5.1x 10‘“), median values 35.02 versus
47.98). This result indirectly shows that HMCan generally pre-
dicts stronger H3K27me3 sites that CCAT. However, this result
does not reject the hypothesis that CCAT-only predictions may
correspond to weaker but true H3K27me3 sites. Only slightly
more of the HMCan-only predictions fall within the copy
number alteration regions as compared with the CCAT-only pre-
dictions: 60.3% versus 57.6%, respectively (see Supplementary
Materials and Supplementary Fig. S6 for more detail).

We calculated the H3K27me3 signal distribution around TSSs
of coding genes (RefSeq Release 50; 34062 gene isoforms). For
both HMCan and CCAT, we added to the density counts nu-
cleotide positions covered by the predicted regions. Generally,
the H3K27me3 mark exhibits a decreasing proﬁle from 5/ to
3/ with a pronounced valley in the Vicinity of TSS (Barski
et al., 2007; He et al., 2012). We observed the expected proﬁle
in regions predicted by HMCan and, to a slightly lower extent, in
the predictions of CCAT (Fig. 5D).

 

2983

112 /810's1cu1n01p101x0'sopcurJOJHrorq/ﬁduq 111011 popco1umoq

9103 ‘0g1sn8nv uo ::

H.Ashoor et al.

 

A

HMcan norTalijed Czhlpfmﬁle MimllMMIlmW-hﬂﬂlm .Mlulli ...ili ... l ._ll.l... l.

 

 

 

Regions predicted  HMCan - _ I- —I— I I _ _- I I I I
Regions predicted by CCAT ' ' "' ' ' ' ' '_ '-' ' '
lSﬁS_NM_173514 DDK‘LNMWUZM‘IE lL31RA_HM_UU
B C D
 E
— — HMCan
g z _ — CCAT

OMb

  

50
l

3:.
Gene EXpI'ESSIOI'I
200
I I |
Paul-boon o

10

 

°i
it!

 

 

 

 

Peak frequency

A;

 

 

 

 

HMCan HMCan CCAT No
only Peak

& CCAT only

 

I i I l l I
-10000 -5000 0 5000 10000

Distance from TSS

Fig. 5. Comparison of HMCan and CCAT on the H3K27me3 ChIP-seq dataset for the CL1207 (bladder cancer) cell line. (A) Predicted regions as well
as normalized density are visualized with Integrated Genome Browser (IGV) (Robinson et al., 2011; Thorvaldsdéttir et al., 2012); (B) Venn diagram
showing base pair overlap in the HMCan and CCAT predictions, numbers show the total number of nucleotides in predicted regions, Jaccard similarity
coefﬁcient 0.66; (C) Genes with an H3K27me3 mark predicted by HMCan in the promoter regions (TSS :l: 1 kb) tend to have lower expression than
genes with this mark predicted by CCAT. The graph shows the distribution of gene expression values after RMA normalization for the following gene
categories: genes with the promoter H3K27me3 mark predicted by (i) both HMCan and CCAT, 3846 genes, (ii) HMCan only, 635 genes, (iii) by CCAT
only, 391 genes and (iv) by none of the tools, 12 826 genes. The orange dot shows the mean expression value. The black line shows the median and the
boxes are plotted between the ﬁrst and the third quartiles; (D) Density of peaks detected by HMCan and CCAT around all gene TSSs for the H3k27me3

histone mark in the CL1207 cell line

In our previous study (Vallot et al., 2011), we validated by
qPCR several gene regions bearing the repressive H3K27me3
mark in the CL1207 cell line. HMCan successfully detected
H3K27me3 marks on the DLEC1 gene, which is commonly
deleted in various carcinomas (Chan et al., 2010; Ying et al.,
2009), as well as on the homeobox D (HOXD) gene cluster
located at 2q31-2q37 chromosome regions. The HOXD cluster
includes genes HOXD], HOXD3, HOXD4 and HOXD8—13.
Many of these genes have been shown to play a crucial role in
oncogenesis (Shah and Sukumar, 2010). Low expression of sev-
eral HOXD genes was detected in neuroblastoma (Manohar
et al., 1996; Zha et al., 2012), breast (Carrio et al., 2005) and
colorectal (Jung et al., 2005) cancer. Interestingly, although
CCAT successfully detected H3K27me3 on the HOXD cluster,
it failed to identify the H3K27me3 mark in the promoter
of DLEC1 [HMCan peak score 0.25, relative enrichment as-
sessed by ChIP-qPCR 0.22 (V allot et al., 2011), Supplementary
Fig. S7 and Supplementary Table S3].

4 DISCUSSION

We have developed HMCan, a tool for detection of histone
modiﬁcations in cancer samples using ChIP-seq data. On simu-
lated data, HMCan demonstrated better accuracy of prediction
compared with the other tools we tested.

HMCan was originally developed to identify broad signals
such as H3K27me3 or H3K36me3. However, it can be also
applied to a class of histone modiﬁcations with narrow signal
(e.g. H3K4me3). The output of HMCan includes information
about peak maxima to facilitate functional annotation of
peaks. The output also includes normalized density proﬁles
(Fig. 5A, top), which is convenient for inspecting predicted
regions with histone marks and can be also used for producing
figures for publication.

The run time of HMCan is signiﬁcantly longer than for the
majority of other tools (e. g. MACS, CCAT or SICER) and may
require up to 1 h on a standard PC (Supplementary Table S4).
Running iterative HMMs is the most time-consuming step.
However, we believe that the greater accuracy of HMCan
demonstrated in this study compensates for a longer run time.

In some cases, it might be interesting to detect differential his-
tone modiﬁcations using two ChIP-seq datasets generated for two
different conditions. HMCan does not as yet contain such a func-
tion, and we advise users to apply standard tools such as DESeq
(Anders and Huber, 2010) to the output from HMCan.

5 CONCLUSION

HMCan was speciﬁcally developed to analyze histone modiﬁca-
tion data obtained for cancer genomes. Cancer genomes are

 

2984

112 /810's1cu1n01p101x0'sopcurJOJHrorq/ﬁduq 111011 popco1umoq

9103 ‘0g1sn8nv uo ::

HMCan: a method for detecting chromatin modifications in cancer

 

characterized by frequent copy number alterations: gains and
losses of large regions of chromosomal material. The designed
algorithm explicitly corrects for copy number alterations, and
thus does not demonstrate bias within the number of predicted
sites in the regions of gain or loss. In addition, HMCan corrects
for possible GC-content bias independently in the ChIP and
control sample. This guarantees GC—content-unbiased results
even in the case when the two experiments are performed in
different laboratories and even using different sequencing tech-
niques. Also, the iterative HMM method formulated in HMCan
allows for getting the best distinction between signal and noise on
sequential data. HMCan accepts the most common alignment
formats: SAM/BAM and BED, and outputs predicted regions in
BED and WIG formats.

We successfully applied HMCan on both simulated and
experimental data. On simulated data, we demonstrated
HMCan’s higher accuracy in signal prediction compared with
the tools designed for normal genomes (MACS, SICER and
CCAT). Unlike MACS and SICER, HMCan did not show
bias in number of identiﬁed peaks toward gained regions. In
our simulations, we modeled signal in regions present in 1, 2, 3
or 4 copies. HMCan detected the signal in all of them, including
cases where the signal was initially present in only one out of four
alleles. On the experimental ChIP-seq dataset generated for the
repressive mark H3K27me3 in the CL1207 human bladder tran-
sitional cell carcinoma cell line, peaks in proximity of gene TSSs
that were detected only by HMCan corresponded to lower gene
expression compared with the peaks detected only by CCAT.
Overall, HMCan proves to be an appropriate tool for predicting
histone modiﬁcations in genomes with copy number alterations.

ACKNOWLEDGEMENTS

The authors thank A. Zinovyev for helpful suggestions and crit-
ical comments and K. Bleakley for english proofreading.

Funding: Project ABS4NGS, funded by the ‘Bioinformatique
2011’ call, action ‘Sante Biotechnologie’ of Investissement d’ave-
nir and Agence Nationale de la Recherche, under contract
[ANR-ll-BINF—0001]; grant INCA LABEL Canceropole Ile-
de—France 2011-1-LABEL-1 and the grant INVADE from
ITMO Cancer (Call Systems Biology 2012). EB. and VB. are
members of the team ‘Computational Systems Biology of
Cancer’, Equipe labellisee Ligue Nationale Contre le Cancer.
KAUST Base Research Fund of V.B.B (to HA. and V.B.B.).

Conflict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol, 11, R106.

Bajic,V.B. (2000) Comparing the success of different prediction software in sequence
analysis: a review. Brief. Bioinform, l, 214e228.

Barski,A. et al. (2007) High—Resolution Proﬁling of histone methylations in the
human genome. Cell, 129, 8237837.

Benjamini,Y. and Speed,T.P. (2012) Summarizing and correcting the GC content
bias in high—throughput sequencing. Nucleic Acids Res, 40, e72.

Biancotto,C. et al. (2010) 13 — histone modiﬁcation therapy of cancer. In:
Zdenko,Herceg and Toshikazu,Ushijima (eds) Advances in Genetics. Academic
Press, United States, pp. 3417386.

Boeva,V. et al. (2011) Control—free calling of copy number alterations in deep—
sequencing data using GC—content normalization. Bioinformatics, 27, 2687269.

Boeva,V. et al. (2012a) Control—FREEC: a tool for assessing copy number and
allelic content using next—generation sequencing data. Bioinformatics, 28,
4234125.

Boeva,V. et al. (2012b) Nebulaia web—server for advanced ChIP—seq data analysis.
Bioinformatics, 28, 251772519.

Carrio,M. et al. (2005) Homeobox D10 induces phenotypic reversion of
breast tumor cells in a three—dimensional culture model. Cancer Res, 65,
717777185.

Chan,W.H. et al. (2010) Transcriptional repression of DLEC1 associates with the
depth of tumor invasion in oral squamous cell carcinoma. Oral Oncol, 46,
874e879.

Chen,Y. et al. (2012) Systematic evaluation of factors inﬂuencing ChIP—seq ﬁdelity.
Nat Methods, 9, 609$14.

Coolen,M.W. et al. (2010) Consolidation of the cancer genome into domains of
repressive chromatin by long—range epigenetic silencing (LRES) reduces tran—
scriptional plasticity. Nat Cell Biol, 12, 2357246.

Dallosso,A.R. et al. (2012) Long—range epigenetic silencing of chromosome 5q31
protocadherins is involved in early and late stages of colorectal tumorigenesis
through modulation of oncogenic pathways. Oncogene, 31, 440941419.

Davis,J. and Goadrich,M. (2006) The relationship between precision—recall and
ROC curves. In: ICML'06: Proceedings of the 23rd International Conference
on Machine Learning. ACM Press, pp. 2337240.

De Boer,W.I. et al. (1997) Expression and functions of EGF, FGF and TGFbeta—
growth—factor family members and their receptors in invasive human transi—
tional—cell—carcinoma cells. Int J. Cancer, 71, 2847291.

Dohm,J.C. et al. (2008) Substantial biases in ultra—short read data sets from high—
throughput DNA sequencing. Nucleic Acids Res, 36, e105w105.

Esteller,M. (2007) Cancer epigenomics: DNA methylomes and histone—modiﬁcation
maps. Nat Rev. Genet, 8, 2867298.

Fejes,A.P. et al. (2008) FindPeaks 3.1: a tool for identifying areas of enrichment
from massively parallel short—read sequencing technology. Bioinformatics, 24,
172971730.

Frigola,J. et al. (2006) Epigenetic remodeling in colorectal cancer results in coord—
inate gene suppression across an entire chromosome band. Nat Genet, 38,
540549.

Furey,T.S. (2012) ChIPeseq and beyond: new and improved methodologies to
detect and characterize proteineDNA interactions. Nat Rev. Genet, 13,
840852.

He,Y. et al. (2012) Genome—wide bovine H3K27me3 modiﬁcations and the regula—
tory effects on genes expressions in peripheral blood lymphocytes. PLoS One, 7,
e39094.

Hebenstreit,D. et al. (2011) EpiChIP: gene—by—gene quantiﬁcation of epigenetic
modiﬁcation levels. Nucleic Acids Res, 39, e27.

Jung,C. et al. (2005) HOXB13 is downregulated in colorectal cancer to confer
TCF4—mediated transactivation. Br. J. Cancer, 92, 223%2239.

Kharchenko,P.V. et al. (2008) Design and analysis of ChIP—seq experiments for
DNA—binding proteins. Nat Biotechnol, 26, 135171359.

Kharchenko,P.V. et al. (2011) Comprehensive analysis of the chromatin landscape
in Drosophila melanogaster. Nature, 471, 480—485.

Kouzarides,T. (2007) Chromatin modiﬁcations and their function. Cell, 128,
6937705.

Ku,M. et al. (2008) Genomewide analysis of PRC1 and PRC2 occupancy identiﬁes
two classes of bivalent domains. PLoS Genet, 4, e1000242.

Langmead,B. et al. (2009) Ultrafast and memory—efﬁcient alignment of short DNA
sequences to the human genome. Genome Biol, 10, R25.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows—
Wheeler transform. Bioinformatics, 25, 17544760.

Manohar,C.F. et al. (1996) Up—regulation of HOXC6, HOXDl, and HOXD8
homeobox gene expression in human neuroblastoma cells following chemical
induction of differentiation. Tumour Biol, 17, 34—47.

Novak,P. et al. (2008) Agglomerative epigenetic aberrations are a common event in
human breast cancer. Cancer Res, 68, 86138625.

Popova,T. et al. (2009) Genome Alteration Print (GAP): a tool to visualize and
mine complex cancer genomic proﬁles obtained by SNP arrays. Genome Biol,
10, R128.

Qin,Z.S. et al. (2010) HPeak: an HMM—based algorithm for deﬁning read—enriched
regions in ChIP—Seq data. BMC Bioinformatics, 11, 369.

Robertson,G. et al. (2007) Genome—wide proﬁles of STAT] DNA association using
chromatin immunoprecipitation and massively parallel sequencing. Nat
Methods, 4, 651$57.

 

2985

112 /810's1cu1n01p101x0'sopcurJOJHrorq/ﬁduq 111011 popco1umoq

9103 ‘0g1sn8nv uo ::

H.Ashoor et al.

 

Robinson,J.T. et al. (2011) Integrative genomics viewer. Nat. Biotechnol., 29, 24w26.

Rozowsky,J. et al. (2009) PeakSeq enables systematic scoring of ChIP—seq experi—
ments relative to controls. Nat. Biotechnol., 27, 6(r75.

Shah,N. and Sukumar,S. (2010) The HOX genes and their roles in oncogenesis. Nat.
Rev. Cancer, 10, 3617371.

Stransky,N. et al. (2006) Regional copy numberiindependent deregulation of tran—
scription in cancer. Nat. Genet., 38, 138(r1396.

Thorvaldsdottir,H. et a]. (2012) Integrative Genomics Viewer (IGV): high—perform—
ance genomics data visualization and exploration. Brief. Bioinform., 14,
1787192.

Vallot,C. et al. (2011) A novel epigenetic phenotype associated with the most
aggressive pathway of bladder tumor progression. JNCI J. Natl Cancer Imt.,
103, 47760.

Viterbi,A. (1967) Error bounds for convolutional codes and an asymptotically
optimum decoding algorithm. IEEE T ram. Info. Theory, 13, 26(k269.

Xu,H. et al. (2008) An HMM approach to genome—wide identiﬁcation of differential
histone modiﬁcation sites from ChIP—Seq data. Bioinformatics, 24, 2344w2349.

Xu,H. et a]. (2010) A signal—noise model for signiﬁcance analysis of ChIP—seq with
negative control. Bioinformatics, 26, 119%1204.

Ying,J. et al. (2009) DLEC1 is a functional 3p22.3 tumour suppressor silenced by
promoter CpG methylation in colon and gastric cancers. Br. J. Cancer, 100,
6637669.

Young,M.D. et al. (2011)ChIP—seq analysis reveals distinct H3K27me3 proﬁles that
correlate with transcriptional activity. Nucleic Acids Res., 39, 741577427.

Zang,C. et al. (2009) A clustering approach for identiﬁcation of enriched domains
from histone modiﬁcation ChIP—Seq data. Bioinformatics, 25, 195271958.

Zha,Y. et al. (2012) functional dissection of hon cluster genes in regulation of
neuroblastoma cell proliferation and differentiation. PLoS One, 7, e40728.

Zhang,Y. et al. (2008) Model—based analysis of ChIP—Seq (MACS). Genome Biol., 9,
R137.

 

2986

112 /310'S[BIIJDO[pJOJXO'SOlJBHIJOJIIlOlq/ﬂdnq 11101} papeolumoq

91oz ‘Og anBnV uo ::

