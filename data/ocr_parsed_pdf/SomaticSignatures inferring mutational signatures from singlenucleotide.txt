Bioinformatics, 31 (22), 2015, 3673—3675

doi: 10.1093/bioinformatics/btv408

Advance Access Publication Date: 10 July 2015
Applications Note

 

 

Genome analysis

SomaticSignatures: inferring mutational
signatures from single-nucleotide variants

Julian S. Gehring1'2'*, Bernd Fischer1'3, Michael Lawrence2 and

Wolfgang Huber1'*

1European Molecular Biology Laboratory, Genome Biology Unit, 69117 Heidelberg, Germany, 2Department of
Bioinformatics and Computational Biology, Genentech Inc., South San Francisco, CA 94080, USA and
3Computational Genome Biology, German Cancer Research Center, 69120 Heidelberg, Germany

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on March 17, 2015; revised on June 9, 2015; accepted on July 2, 2015

Abstract

Summary: Mutational signatures are patterns in the occurrence of somatic single—nucleotide vari—
ants that can reflect underlying mutational processes. The SomaticSignatures package provides
flexible, interoperable and easy—to—use tools that identify such signatures in cancer sequencing
data. It facilitates large—scale, cross—dataset estimation of mutational signatures, implements exist—
ing methods for pattern decomposition, supports extension through user—defined approaches and

integrates with existing Bioconductor workflows.

Availability and implementation: The R package SomaticSignatures is available as part of the
Bioconductor project. Its documentation provides additional details on the methods and demon—

strates applications to biological datasets.
Contact: julian.gehring@embl.de, whuber@embl.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Mutational signatures link observed somatic single—nucleotide vari—
ants to mutation generating processes (Alexandrov et 111., 20133).
The identification of these signatures offers insights into the evolu—
tion, heterogeneity and developmental mechanisms of cancer
(Fischer et (11., 2013; Alexandrov et (11., 2013b; Nik—Zainal et (11.,
2012). Existing softwares offer specialized functionality for this ap—
proach and have contributed to the characterization of signatures in
multiple cancer types (Nik—Zainal et (11., 2012; Fischer et (11., 2013),
While their reliance on custom data input and output formats limits
integration into common workﬂows.

The SomaticSignatures package aims to encourage wider adoption
of mutational signatures in tumor genome analysis by providing an ac—
cessible R implementation that supports multiple statistical approaches,
scales to large datasets and closely interacts with the data structures and
tools of Bioconductor (R Core Team, 2015; Gentleman et (11., 2004).

©The Author 2015. Published by Oxford University Press.

2 Approach

The probability of a somatic single—nucleotide variant (SNV) to
occur can depend on the sequence neighborhood, and a fruitful ap—
proach is to analyze SNV frequencies together with their immediate
sequence context, the flanking 3’ and 5’ bases (Alexandrov et (11.,
2013b). As an example, the mutation of A to G in the sequence TAC
defines the mutational motif T[A>G]C. The occurrence patterns of
such motifs capture characteristics of mutational mechanisms, and
the frequencies of the 96 possible motifs across all samples define
the mutational spectrum. It is represented by the matrix M, with M,,-
enumerating over the motifs i and the samples /. The mutational
spectrum can be interpreted by decomposing M into two matrices of
smaller size (Nik—Zainal et (11., 2012),

7'
M17 2 2 Wikai + 8:77 (1)
13:1

3673

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310'S[BIIJDO[pJOJXO"SOTJBHIJOJIITOTCI/ﬂdnq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

3674

 

where the number of signatures r is typically small compared to the
number of samples, and the elements of the residual matrix a are
minimized such that WH is a useful approximation of the data. The
columns of W describe the composition of a signature: Wik is the
relative frequency of somatic motif 1' in the lath signature. The rows
of H indicate the contribution of each signature to a particular sam—
ple /. A primary goal of the SomaticSignatures package is the easy
application of this approach to datasets in an environment that pro—
vides users with powerful visualizations and algorithms.

3 Methods

Several approaches exist for the decomposition [Equation (1)] that
differ in their constraints and computational complexity. In principal
component analysis (PCA), for a given r, W and H are chosen such
that the norm Zil-  is minimal and W is orthonormal. Non—negative
matrix factorization (NMF) (Brunet et 41]., 2004) is motivated by
the fact that the mutational spectrum fulfills MiiZO and imposes
the same requirement on the elements of W and H. Different NMF
and PCA algorithms allow additional constraints on the results,
such as sparsity. To deduce the number r of signatures present in
the data, information theoretical criteria as well as prior biological
knowledge can be employed (Nik—Zainal et 41]., 2012; Alexandrov
et 41]., 2013a).

4 Results

SomaticSignatures is a ﬂexible and efficient tool for inferring charac—
teristics of mutational mechanisms, based on the methodology de—
veloped by Nik—Zainal et a1. (2012). It integrates with Bioconductor
tools for processing and annotating genomic variants. An analysis
starts with a set of SNV calls, typically imported from a VCF file
and represented as a VRanges object (Obenchain et 41]., 2014). Since
the original calls do not contain information about the sequence
context, we construct the mutational motifs first, based on the se—
quence of a reference or personalized genome.

ctx : mutationContext(VRanges, Genome)

Subsequently, we define the mutational spectrum M. While its
columns are by default defined by the sample labels, users can spe—
cify an alternative grouping covariate, for example tumor type.

in : motifMatrix(ctx, group)

Mutational signatures and their contribution to each sample’s
mutational spectrum are estimated with a chosen decomposition
method for a defined number of signatures. We provide convenient
access to implementations for NMF and PCA, and users can apply
functions with alternative decomposition methods through the API.

sigs : identifysignatures(m, nsig, method)

The user interface and library of plotting functions facilitate sub—
sequent analysis and presentation of results (Fig. 1). Accounting for
technical biases is often essential, particularly when analyzing across
multiple datasets. For this purpose, we provide methods to normal—
ize for the background distribution of sequence motifs and demon—
strate the adjustment for batch effects.

In the documentation of the software, we illustrate a use case by
analyzing 594 607 somatic SNV calls from 2408 TCGA whole—
exome sequenced samples (Gehring, 2014). The analysis, including
NMF, PCA and hierarchical clustering, completes within minutes on
a standard desktop computer. The different approaches yield a

 

 

 

 

 

 

 

 

 

 

 

 

J. S. Gehring et al.

(a) C>A C>G C>T T>A T>C T>G
0.2 - 0
°',‘,' I l J . E

 

 

 

 

 

iii l l.

 

r
r
r
r
r
;

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

l l - ll la

 ll .1 l l
EEEEL ll .1 .1 ll ll (E.
El l l... l ll ll lei

(b)      

353: .  . , 9
 |I.|.. ,  -‘4
 ,,,,, _,  ,,|._|_. - ..l.. ,, , . .,-,  . my”
 . . ,   ______ W 9

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

SI
82

$ at 53
Signature 0.0 0.5 1.0

Fig. 1. Analysis of mutational signatures for eight TCGA studies (Gehring,
2014). The observed mutational spectrum of each study (panel a) was decom-
posed into five distinct mutational signatures 81—85 (panel b) with NMF. The
presence of these signatures in the studies (panel c), as shown by hierarchical
clustering, underlines the similarities in mutational processes of biologically
related cancer types. An annotated high-resolution version of this figure is
available as Supplementary Figure S1

biologically meaningful grouping of the eight cancer types according
to the estimated signatures (Fig. 1).

We have applied this approach to the characterization of kidney
cancer and have shown that classification of subtypes according to
mutational signatures is consistent with classification based on RNA
expression profiling and mutation rates (Durinck et 41]., 2015).

Acknowledgement

We thank Leonard Goldstein and Oleg Mayba at Genentech Inc. for their in—
sights and suggestions.

Fu ndi ng
This work was supported by the NSF award 1247813 and Genentech Inc.

Conﬂict of Interest: none declared.

112 /310'S[BIIJDO[pJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} popcolumoq

91oz ‘Og isnﬁnv uo ::

SomaticSignatures

3675

 

References

Alexandrov,L.B. et al. (2013a) Deciphering signatures of mutational processes
operative in human cancer. Cell Rep., 3, 246—25 9.

Alexandrov,L.B. et al. (2013b) Signatures of mutational processes in human
cancer. Nature, 500, 415—421.

Brunet,J.P. et al. (2004) Metagenes and molecular pattern discovery using
matrix factorization. Proc. Natl. Acad. Sci. USA, 101, 4164—4169.

Durinck,S. et al (2015) Spectrum of diverse genomic alterations deﬁne non—
clear cell renal carcinoma subtypes. Nat. Genet., 47, 13—21.

Fischer,A. et al. (2013) EMu: probabilistic inference of mutational processes
and their localization in the cancer genome. Genome Biol., 14, R39.

Gehring,J.S. (2014) SomaticCancerAlterations. Bioconductor package, ver—
sion: 1.1.0. http://bioconductor.org/packages/SomaticCancerAlterations/
Gentleman,R.C. et al. (2004) Bioconductor: open software develop—
ment for computational biology and bioinformatics. Genome Biol., 5,

R80.

Nik-Zainal,S. et al. (2012) Mutational processes molding the genomes of 21
breast cancers. Cell, 149, 979—993.

Obenchain,V. et al. (2014) VariantAnnotation: a bioconductor package for
exploration and annotation of genetic variants. Bioinformatics, 30,
2076—2078.

R Core Team (2015) R: a language and environment for statistical computing.
R Foundation for Statistical Computing, Vienna, Austria.

112 /310'S[BIIJDO[pJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

