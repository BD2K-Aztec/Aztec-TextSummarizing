Bioinformatics, 31 (22), 2015, 3631—3637

doi: 10.1093/bioinformatics/btv436

Advance Access Publication Date: 27 July 2015
Original Paper

 

Gene expression

Designing alternative splicing RNA-seq studies.
Beyond generic guidelines

Camille Stephan-Otto Attolini”, Victor PeﬁaZ'T and David Rossel|3'*

1Institute for Research in Biomedicine (IRB Barcelona), Barcelona, Spain, 2Department of Statistical Science,
Duke University, Durham, North Carolina, USA and 3Department of Statistics, University of Warwick, Coventry, UK

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
Associate Editor: Ziv Bar-Joseph

Received on March 6,2015; revised on June 23,2015; accepted on July 19, 2015

Abstract

Motivation: Designing an RNA—seq study depends critically on its specific goals, technology and
underlying biology, which renders general guidelines inadequate. We propose a Bayesian frame—
work to customize experiments so that goals can be attained and resources are not wasted, with a
focus on alternative splicing.

Results: We studied how read length, sequencing depth, library preparation and the number of
replicates affects cost—effectiveness of single—sample and group comparison studies. Optimal set—
tings varied strongly according to the target organism or tissue (potential 50—500% cost cuts) and,
interestingly, short reads outperformed long reads for standard analyses. Our framework learns
key characteristics for study design from the data, and predicts if and how to continue experimen—
tation. These predictions matched several follow—up experimental datasets that were used for
validation. We provide default pipelines, but the framework can be combined with other data ana—
lysis methods and can help assess their relative merits.

Availability and implementation: casper package at www.bioconductor.org/packages/release/bioc/

 

html/casper.html, Supplementary Manual by typing casperDesign() at the R prompt.

Contact: rosselldavid@gmail.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The design of an RNA-seq experiment is crucial for its validity and
an adequate use of resources but is typically not assessed in detail.
General guidelines ignore critical aspects such as the specific
research goals or the nature of the studied phenomenon, e.g.
ENCODE guidelines recommend 30 million (m) paired-end reads of
>30 base pairs (hp) for expression estimation and 200m read
pairs of >76 hp for novel transcript discovery |ENCODE Project
Consortium, 2012 (encodeproject.org/ENCODE/protocols/
dataStandards/ENCODELRNAseq\7Standards\7Vl.0.pdf)|. As we
show below the adequacy of such guidelines can change signifi-
cantly between studies. Several experimental design strategies were
recently proposed. Grant et a1. (2011) and Li and Dewey (2011)
developed an RNA-seq simulator for single sample studies,

considering mapping issues and situations where a reference tran-
scriptome is unavailable, respectively. Given a series of experimen-
tal protocols, the simulation pipeline of Griebel et al. (2012) can
explore the potential effects of various biases and settings. Busby et
a1. (2013) and Rossell and Muller (2013) proposed sample size cal-
culations to compare overall gene expression across two groups,
where interestingly these can be based on pilot or public data and
hence incorporate some of the characteristics of this study. These
strategies focus mostly on specific settings such as one sample stud-
ies, a given data analysis or technology (e.g. short reads). Here we
propose a general framework for either single- or multi-sample
studies targeting gene or isoform expression that is flexible to
accommodate any goal, technology (including long reads) and data
analysis. The approach is guided by Bayesian decision theory, where

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3631

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Figure 1

Supplementary Section 6

at 41., 2011

Kendziorski, 2006
2009

Berger, 1 985

at £11., 2006
Supplementary Section 3

1—4 Supplementary Material

Rossell at £11., 2014
Salzman

Yuan and
Rossell,

Swartz

Supplementary Sections

/810'SIEumo_fp10}X0'satJEuIJogutotq/ﬁduq

Designing alternative splicing RNA—seq studies

3633

 

sample /, then f1,- : (ﬁg, ... , ﬁGi) ~ Multinomial(N,-,0,~), where 0,- :
(01,-,  ,OGI') are the true proportions of molecules from each gene
and N 1' the total aligned reads. N 1' is the number of reads in single—end
experiments and read pairs in paired—end experiments. We assume
that gene g has I g isoforms (from genome annotations or de novo pre—
dictions) and that reads come from each isoform with probabilities
ngi : (ugh. . . . . ngigj). That is, ngi are relative expressions of all
known or predicted isoforms of gene g for sample /. The distribution
of reads along a transcript is estimated non—parametrically from the
data, and likewise for the distribution of insert sizes (length of RNA
molecules after fragmentation). We set default symmetric Dirichlet
priors 0,- ~ Dir(2), ngi ~ Dir(2) which, while being non—informative,
induce a mild form of shrinkage to improve parameter estimates
(Rossell et 41., 2014). The extension to multiple samples uses
LNNMV model. Let f1 gii be any expression estimate of interest for iso—
form i in sample /, e.g. log—FPKM ﬁgii : log(109ngil~0g]~/wgi) where wg,
is the isoform length (bp). Then ﬁgil- ~ N(ug,-k, (pgi) with group mean
ugik ~ N(u0,t%) and (ﬁg—,1 ~ Gamma(uo/2,o%/2), where “40,13,110,
03) are estimated via empirical Bayes (Yuan and Kendziorski, 2006).
We note that (pg, models ﬂexibly isoform—specific variance, as it does
not impose any relationship with the mean Hgik, and that Var(f1gi]~) in—
cludes the true variability in expression ngij across samples and that
due to estimation error of ﬁg given ngii. Alternatively, GaGa assumes
ﬁgii ~ Gamma(ocgi, orgi/ggik) with hierarchical Gamma distributions
on Mg and ugik (Supplementary Section 1.2). Both casper, LNNMV
and GaGa lead to computationally tractable model fitting and poster—
ior simulation, rendering the approach practical.

3.2 Default utilities

We consider utility functions 14 : u(e. 31.)?) that measure usefulness of
a design e based on its cost, a (unknown) characteristic 3! of interest
related to gene/isoform expression and its estimate 9 based on data
eventually produced by e. We use the generic notation y to emphasize
that this can be any quantity deemed relevant by the researcher, but as
shown below y will often be a simple function of 1: or 0 (e.g. relative
expression, differences across groups). We propose default u(e.y.y)
but the user can easily incorporate alternatives. In studies with a single
sample / we let 3! : 1:1 be the vector with genome—wide relative expres—
sions for that sample. Denote the read length by r and the desired
number of reads by N (i.e. as indicated to the sequencing facility),
which is different from the eventually mapped reads N 1', then our de—
fault utility is u(e, y, y) : —co — c12Nr — MAE for paired—end experi—
ments (for single—ends replace 2 N by N), where the fixed cost co does
not depend on the design and can be ignored, c1 is a cost per base
sequenced to be defined and

1 G 1 I A
MAE : EZF1 E21; lug” _ “gill

is the MAE in estimating 1:1. To help the experimenter set 61 we note
that it has a simple interpretation. Setting c1 : 0.01/(2rAN) means
that the experimenter is willing to pay for AN extra reads to reduce
MAE by 20.01. The quotes given by sequencing facilities usually
depend on the number of reads N, hence 61 can be easily translated
to money. As an alternative we consider studies that aim to identify
the dominant isoform ygi : argmaxingii across 1': 1,  ,Ig, in
which case we set u(e.y.y) : —co — c12rN + D, where
D : G_1Z§:11(ygi : ygi) is the proportion of genes for which we
correctly identified the dominant isoform, I is the indicator func—
tion and c1 : 0.01/(2rAN) means that the experimenter will pay for
AN extra reads to increase D by 20.01.

In multi—sample studies we let ygi : 1 if isoform 1' is truly DE across
K groups by a user—defined margin (else ygi : 0) and ﬁg, are DE calls

obtained from any desired data analysis method. For instance, for
K22 groups we may set ygi : 1((ugi1 — Hgizl > log(t)) where t is the
minimal fold change (FC) between groups that the experimenter
deems to be relevant. We introduce it rather than testing strict equality
across groups (ugil : Hgiz) to reflect the custom in the field of not re—
porting FCs below a certain threshold t. In our examples we use if: 2
and t: 3 and set DE calls 9g, : 1 when LNNMV posterior probabil—
ities (PP) of ygi : 1 were > 1 — or or alternatively when TREAT
Benjamini—Hochberg (BH) adjusted P—values (McCarthy and Smyth,
2009; Benjamini and Hochberg, 1995) were 3 or, where or is the
desired false discovery proportion (FDP). Both LNNMV—PP and
TREAT—EH test the equivalence null hypothesis lug” — ugizl S log(t)
versus the alternative lug” — ugizl > log(t). The cutoff PP> 1 — or en—
sures that the posterior expected FDP g or, whereas TREAT—EH tar—
gets the usual frequentist FDR control. As a technical comment,
according to decision theory one should set 9g, to maximize posterior
expected utility, but instead we adopt a pragmatic standpoint and ac—
knowledge that the data analyst may have other preferred data ana—
lysis strategies. See Supplementary Section 2 for further discussion. Let
Sk be the sample size (number of replicates) in group k : 1,  ,K
and S : 25:1 Sk the total sample size. The default utility for multi—
sample studies is u(e.y.y) : —(co + c12rN)S + Zgjygi, which re—
wards having a larger number of DE calls ngpgi. This utility does not
explicitly include a penalty for false positives but recall that 9g,- are set
to control the FDP S or, and incorporates a sampling cost
(co + c12rN)S. Setting co + c12rN : ADE/As means the experimenter
would pay for As more samples if she were to obtain ZADE new DE
calls (Supplementary Table S4 has an example). As shown in our ex—
amples, often we do not need to set co, 61 as it is clear from the context
whether the increase in DE calls offsets the cost of additional samples.

3.3 Simulation

The utility u(e. 31.)?) obtained from conducting a study with design e is a
random variable that depends on the unknown state of nature 3! and de—
cisions y based on the eventual data (also unknown at the time of study
design). Following certain axioms, Bayesian decision theory dictates
that one should choose the design e maximizing U(e) : E (u(e, m?) (K),
the expected utility with respect to (m?) given current knowledge IC
Algorithms 1 and 2 below simulate B realizations of (m?) and thus of u
(e, 31,33) from their distribution given IC for single— and multi—sample
studies, respectively. In Algorithm 1 the user specifies a read length 1’,
target number of reads N, mean insert size 7' (bp) and, optionally, pilot
data consisting of a vector with exon path counts yo and total reads no
for each gene. Long single—end reads (e.g. r :1500 bp) are simulated as
two paired—ends of length r/ 2 with insert size 7': 7, which gives rise to
the same exon path that would be observed with a single read of length
1’. Although we recommend using pilot data whenever possible, and in
the absence of related RNA—seq data it could come from microarrays or
some other technology (see the Supplementary Manual for an example),
if no pilot data are available one may conduct prior predictive simula—
tion in Step 1 of Algorithm 1 (i.e. set f1 : (0. . . . .0), draw
ugh) ~ Dir(2)). We now outline the algorithms and give them in full de—
tail in Supplementary Section 3.

 

Algorithm 1. Simulation of one RNA—seq sample /. For
b : 1,  ,B

 

1. Simulate gene expressions 01),?) ~ Dir(2 +ﬁo) and relative
isoform expressions nlgb) given (ﬁo,y0) via Metropolis—
Hastings (Rossell et al., 2014). Find vim associated to
0th) (b)

( I 7751‘ 

[BJO'SWIIIHOFPJOJXO'SOplZIIJJOJLItOIQ/[idnq

3634

C. Stephan—Otto Atto/ini et al.

 

2. Simulate ij) : Nprmy reads, where pr is a known pro—
portion of uniquely mappable r—long reads (Li et al.,
2014), m N Unif(0.6,0.9) that of actually aligned reads
and y~Unif(0.8.1.2) a :20% random read yield. See
Supplementary Section 1.4 for details.

3. Simulate future data (yjb).ﬁjb)) given njb).0jb), i.e.
ﬁjb) ~ Multinomial(N,-, HEM), reads per isoform
(’7)

(b) ago)

~ Multinomial(ﬁj , I . Get expression estimates 9,.
(by default using casper, but BAM files Li et al. (2009)
can be generated for combination with other software).

4. Record 14””) : u(e.y§b).yjb)).

 

Algorithm 1 can be used either in single—stage studies where we
consider a single sequencing experiment and in multi—stage studies
where we consider sequencing a sample of interest multiple times to
increase precision. In single—stage studies a)” in Step 3 is based only
on the new data (yjb).ﬁjb)), whereas as in multi—stage studies 9}“
also uses the pilot data (yoﬂo) as these came from the sample of
interest.

Algorithm 2 below requires setting (1’, N, f) and the number of rep—
licates St in each group k : 1.  .K, where K is the number of
groups that one wishes to compare expression across. To estimate
statistical power accurately we recommend that Algorithm 2 uses
pilot data from the groups of interest, given that power depends critic—
ally on the size of the differences between groups relative to the
within—groups variance (pooled variance when variability is different
in each group). Although using pilot data from a different study is
also possible, this may lead to under—estimating the number of DE
calls (i.e. sequence too many samples) or over—estimating them (i.e. se—
quence too few samples). Hence we envision a use of Algorithm 2 in
two— or multi—stage studies, where batches are collected sequentially
and become the pilot data to decide if further replicates are needed.

 

Algorithm 2. Simulation of multiple samples. For
b:1,,B

 

1. Draw (if:le ~N(mgik,vgik), 1/4)? ~ Gamma(agi.bgi) for
all g, i, k, where (mgikwgihaghbgi) depend on the pilot
data and are given in Supplementary Section 1.2.
Compute 310’).

2. Draw ﬁg.) ~N(p$ll,¢(?)) for all g, i, k, [:1.  .Sk.
Find corresponding alibi 01),?) (Supplementary Section 1.2).

3. Use Steps 2 and 3 in Algorithm 1 to obtain ﬁgs.) for all g,
z, /.

4. Obtain DE calls 33””), record 14””) : u(e,y(b),y(b))

 

From Algorithms 1—2 we obtain the Monte Carlo estimate U(e)
: 25:1ulbl/B for any given design e. To choose amongst several
possible designs e one can apply Algorithms 1 and 2 for each of
them and choose that maximizing U(e). An advantage of these
simulation—based algorithms is that one may easily evaluate U(e) for
all values of the utility coefficients (co, 61). That is, one may report
the optimal e for each (co, c1) to find the best design for the range of
(co, 61) values deemed reasonable, which avoids the need to set a sin—
gle (co, c1) (Swartz et al., 2006). Another advantage is that one may
examine the distribution of the individual components in u(e.y.y)
for various e, e.g. the MAE in single—sample studies or DE calls and
FDP in multi—sample studies, as illustrated in our examples.
Algorithm 1 is implemented in the casper function simMAE and
Algorithm 2 in simMultSamples (Supplementary Manual).

3.4 Data

The FASTQ files for the K549 cell line and mouse bladder tissue
used as pilot data in Section 4 were obtained from the ENCODE
Project Consortium (2012), samples ngncodeEH002625 and
ngncodeEM003062, respectively. The human lymphoblastoids
sample was from the 1000 genomes project (Lappalainen et al.,
2013), sample ERS185276. For the multi—sample example we ob—
tained GSE37704 SRA files from ncbi .nlm.nih.gov/
sra?term:SRP012607, converted them to FASTQ format with
SRA toolkit 2.2.2 (eutils .ncbi.nih.gov/Traces/sra) com—
mand fastq—dump —split—3 filename . sra, and aligned to the
human genome hg19 with Tophat2 version 2.0.2 (Trapnell et al.,
2012) (default parameters and —a 5). GSE49712 SRA files
(ncbi.nlm.nih.gov/sra?term:SRP028705) were aligned
to hg19 with STAR 2.3.0 (Dobin et al., 2013) (default parameters).
We imporated the GENCODE v18 (Engstrom et al., 2013) iso—
forms.gtf file into Bioconductor and used casper function wrap
Known to import the data and obtain isoform expression estimates
(Supplementary Manual).

3.5 Preprocessing and goodness—of—fit

Our multi—sample model assumes that data are preprocessed to re—
move systematic differences between samples and potential biases
due to batches or other covariates. We used quantile normalization,
which Bullard et al. (2010) found useful for RNA—seq data, followed
by the linear model adjustment ﬁg” : ﬁgii — xiﬁgi, where ﬁgii are raw
expression estimates, x,- a covariate vector (e.g. batches) and fig, the
least—squares estimate from regressing ﬁgii on x; and the group indi—
cator. ﬁgii are the adjusted expression estimates fed into LNNMV or
GaGa (for the latter we add an offset to guarantee ﬁg” > 0). We
used casper function mergeExp to quantile—normalize and
mergeBatches for batch effect adjustment. We emphasize the im—
portance of an adequate normalization, e.g. if it cannot be safely
assumed that differences between samples are solely due to artifacts
one may consider alternatives such as quantro (Hicks and Irizarry,
2015).

Another important point is to assess that the assumptions
posed by our model are reasonable, as these drive the simulation.
For the multi—sample LNNMV/GaGa models we implemented
genome—wide residual quantile—quantile plots and asymmetry
checks for ﬁg”, i.e. the first hierarchical level of the model. The
LNNMV assumptions for log—FPKM held fairly well in datasets
GSE37704 and GSE49712, whereas GaGa had a slightly worse fit
and Poisson or Negative binomial qq—plots revealed a substan—
tially poorer fit to the aligned read counts (Supplementary
Sections 4.2 and 4.3). These checks include the hierarchical level
that isoform means Hgik arise from a common Normal (LNNMV)
or inverse Gamma (GaGa) distribution. Usually the fit was satis—
factory for genes with aligned read count above a certain min—
imum (roughly > 10). For our single—sample model we compared
the number of mapped reads f1 with posterior predictive simula—
tions, again finding a good fit (Supplementary Section 4.1). As
further validation, the examples in Section 4.2 compare observed
DE calls with out—of—sample predictions in GSE37704 and
GSE49712, finding a reasonably good agreement. For further de—
tails see Supplementary Sections 4—5. We note that while the
main role of LNNMV/GaGa for us is as a simulation engine, an
interesting side implication is that data analysis strategies devised
for continuous data often remain reasonable for RNA—seq. See
also Law et al. (2014) for the more advanced voom strategy based
on incorporating weights to consider that measurement precision
increases with read count.

[310‘SIEIIIHOFPJOJXO‘SOQEIIIJOJIIIOIQ/[Idnq

Supplementar) Fig. 515

ENCODE Project

(1 i ' 2012
Unwmuum ) Supplementar) Fig. 519

Figure 2

Li (7/ Lil. (2014) Supplementar)
Section 1.4

Supplementar)

Figs Slob 5181)

Trapnell (7/ al., 2013

Fig.

Lu

Quail (7/ al., 2012

Supplementar) Fig. 518

Figure 3
Supplementar) Table 52

Human Mouse

r:1 500

r=10| i=2oo

r:1 01 1:300

r:7 200

r:76 (:300
o

Rapaport (7/ Li]. (2013) Bush) (7/ Li]. (2013)

 

Quail (7/ al.. 2012

/3.IO'S[BIIJHOFPJOJXO'SOIJ’BLUJOJIIIOIq/ﬂduq

C.Stephan—Otto Atto/ini et al.

 

 

 

 

 

 

 

3636
(a)
° i
o _
9 !
o3». §-
0 u
/\ I I
E o 916
n O —
(V) (D
/\
o
E
1) O
3 9r _
LIJ
o
O
a _
916 Short reads (r=101,N=16m)
v Short reads (r=101,N=32m)
o _ 0 Long reads (r=750,N=1.8m)
l I I
3 6 9

Sample size per group

 

é

DE calls (FC>3, Post. Prob > 0.95)
20000 30000 40000
I | |

1 0000
i

 

*- Observed
916 Simulated
| | | |

2 3 4 5

0
|

 

 

 

 

Sample size per group

Fig. 3. Evaluating multi-sample studies. (a) Number of hg19 isoform DE calls
(lFCl > 3) with 51:3 MiSeq samples per group, 3 MiSeq+3 HiSeq from
GSE37704 (black) and simulations for 3k : 6., 9 based on 3k: 3 (grey). (b) DE
calls for GENCODE v18 transcripts with 3k : 2,3, 4., 5 per group from
GSE47912 (black) and simulations based on 51:2 (grey)

cost-equivalent of N216 m, 7:101 bp short reads is N : 2.1/4
: 0.52 m long reads, which gives even lower power (Supplementary
Tables S2 and S3). To assess robustness we repeated the simulations
under the GaGa model, obtaining very similar results
(Supplementary Figs S21 and S22, Supplementary Table S5).

Given the simulation output it is straightforward to evaluate
other FC cutoffs and analyses, which can be useful to further assess
robustness and also to compare the performance of several analysis
methods. We considered lowering the FC threshold to > 2 and also
using TREAT-BH (Section 3.2) instead of LNNMV-PP to make DE
calls. LNNMV-PP with the > 2 cutoff gave a higher number of DE
calls than for the more stringent > 3, but results were analogous in
terms of the optimal design (Supplementary Table S2). Regarding
TREAT-EH for > 3 and > 2 cutoffs we again found that adding in-
dependent replicates was preferable to increasing sequencing depth
and that long reads were not cost-effective (Supplementary Fig. S20,
Supplementary Tables S2 and S3). The predicted number of DE calls
in the simulations matched those in the validation HiSeq data also

for TREAT-EH. The FDP was adequately controlled but relative to
LNNMV-PP there was a sharp decrease in DE calls. This is not sur-
prising given that equivalence testing P-values control false positives
under the worst possible case that the FC lies at the boundary (,ugil
—,ugi2( : log(t) for all genes g, which results in a conservative behav-
ior when many FCs truly are of a smaller magnitude. So far our dis-
cussion was informal, but these results are easily integrated with
decision theory (Supplementary Section 5). For instance, Sk: 9
would only be preferable to Sk: 6 if the experimenter believed that
as few as 14 new DE calls already make it worth sequencing one
extra sample. That is, for most experimenters the decision Sk : 6 has
higher expected utility than Sk : 9.

The previous example illustrates a situation where continuation
beyond the pilot (Sk > 3) clearly improves statistical power, and that
this can be detected even when using MiSeq pilot data to assess a
HiSeq follow-up. It is equally important to detect situations where lit-
tle benefits are expected beyond the pilot, as then one can stop experi-
mentation. To illustrate this we selected 2 of the 5 universal human
and 5 brain reference samples from GSE49712 (Rapaport et al.,
2013) as pilot data and used Algorithm 2 to predict the number of DE
calls when increasing the sample size to Sk : 3,4,5. GSE49712 is a dis-
tinct example from GSE37704 due to having higher read yield
(roughly 61 m aligned reads per sample) and that here we considered
194 820 isoforms from GENCODE v18 (Engstrom et al., 2013) rather
than the 40 892 UCSC hg19 isoforms studied in GSE37704. Further,
the Principal Components plot reveals the existence of stronger differ-
ences between groups (Supplementary Fig. S11). In fact, 32596 DE
calls were found by LNNMV-PP with a fold-change > 3 based only
on the Sk : 2 pilot samples per group. Figure 3 (bottom),
Supplementary Table S6 and Supplementary Figure S23 show that lit-
tle benefits were predicted for increasing Sk further. For instance the
32596 LNNMV-PP calls were predicted to only increase to 35037
for Sk: 5, a prediction that was confirmed when analysing the five
available experimental samples per group, where in fact even slightly
fewer DE calls were made (33 595). Analogous results were found for
a > 2 cutoff and when making DE calls with TREAT-EH.
Interestingly, for a > 3 cutoff LNNMV-PP offered better statistical
power than TREAT-EH at a low FDP but for a > 2 cutoff LNNMV-
PP was overly liberal with an FDP around 0.12—0.13, whereas
TREAT-EH showed an FDP:0.05—0.06 much closer to the target
0.05. This example shows that, beyond choosing an experimental de-
sign, the simulations can help assess which amongst various analysis
strategies may be more appropriate for the problem at hand.

5 Discussion

In an era when high-throughput technologies and Big Data are hav-
ing a profound impact on biomedical research, experimental design
continues to be critical for the validity of science. Unfortunately de-
sign considerations are often overlooked, perhaps encouraged partly
by a naive feeling that with good enough technology design consid-
erations are less important and partly by practical difficulties such
as the lack of available tools. To address these challenges, we pro-
posed a general framework for RNA-seq experiments firmly
grounded in Bayesian decision theory and statistical design of ex-
periments. We focused on RNA-seq, but the framework can serve as
a basis to design other experiments, e.g. proteomics, genome-wide
association studies etc. The key components for such extensions are
a model that offers a good probabilistic representation of the data-
generating process, a utility function or multiple criteria that assess
cost-effectiveness taking into account the characteristics of the prob-
lem at hand and a computational strategy that produces answers

/810's12um0_fp10}x0'satmuuogutotq/ﬁduq

Designing alternative splicing RNA—seq studies

3637

 

within a practical time frame. Although there are other possible
routes to specify these components, Bayesian models equipped with
posterior and posterior predictive sampling algorithms become a
convenient choice that allow implementing our framework in a
straightforward manner.

Our results indicate that it is important to go beyond default guide—
lines to consider each individual study, i.e. to customize the design. By
taking into account the target organism or likely expression levels for
the tissue of interest one may cut sequencing costs by a factor of 2—5
and still estimate expression at a good precision. Similarly for multi—
sample studies, where the ability to find differential expression depends
critically on between—groups differences relative to within—groups vari—
ability and other characteristics. For instance, the contrast between
GSE37704 and GSE49712 resembles differences between studies en—
countered in practice in the underlying biology, technology used or
even the target transcriptome that one wishes to make inference for. By
adapting to such context—specific characteristics, customized designs
are a promising and currently under—explored framework to help re—
searchers decide if and how to conduct high—throughput studies in a
statistically principled manner. The associated savings in time and ex—
perimentation are not only ethical, but also help focus research efforts
where they are more likely to yield useful results.

Funding

D.R. was partially funded by National Institutes of Health (R01
CA158113—01) and Ministerio de Economia y Competitividad of
Spain (MTM2012—383337). C.S—O. was partially supported by
AGAUR Beatriu de Pinos fellowship BP—B 00068.

Conflict of Interest: none declared.

References

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. B., 57,
289—300.

Berger,]. (1985) Statistical Decision Theory and Bayesian Analysis. Springer,
New York.

Bullard,]. et al. (2010) Evaluation of statistical methods for normalization and
differential expression in mRNA-seq experiments. BMC Bioinformatics, 11,
1—13.

Busby,M. et al. (2013) Scotty: a web tool for designing RNA-seq experiments
to measure differential gene expression. Bioinformatics, 29, 656—657.

Dobin,A. et al. (2013) STAR: ultrafast universal RNA-seq aligner.
Bioinformatics, 29, 15—21.

ENCODE Project Consortium. (2012) An integrated encyclopedia of DNA
elements in the human genome. Nature, 489, 57—74.

Engstrom,P. et al. (2013) Systematic evaluation of spliced alignment programs
for RNA-seq data. Nat. Methods, 10, 1185—1 191.

Grant,G. et al. (2011) Comparative analysis of RNA-Seq alignment algorithms
and the RNA-Seq uniﬁed mapper (RUM). Bioinformatics, 27, 2518—2528.
Griebel,T. et al. (2012) Modelling and simulating generic RNA-Seq experi-

ments with the flux simulator. Nucleic Acids Res., 40, 10073—10083.

Hicks,S. and Irizarry,R. (2015) quantro: a data-driven approach to guide the
choice of an appropriate normalization method. Genome Biol., 16, 117.

Lappalainen,T. et al. (2013) Transcriptome and genome sequencing uncovers
functional variation in humans. Nature, 501, 506—51 1.

Law,C. et al. (2014) Voom: precision weights unlock linear model analysis
tools for RNA-seq read counts. Genome Biol., 15, R29.

Li,B. and Dewey,C. (2011) RSEM: accurate transcript quantiﬁcation from
RNA-Seq data with or without a reference genome. BMC Bioinformatics,
12, 323+.

Li H. et al., 1000 Genome Project Data Processing Subgroup (2009) The se-
quence alignment/map (SAM) format and SAMtools. Bioinformatics, 25,
2078—2079.

Li,W. et al. (2014) Diminishing return for increased mappability with longer
sequencing reads: implications of the k-mer distributions in the human gen-
ome. BMC Bioinformatics, 15, 1—12.

McCarthy,D. and Smyth,G. (2009) Testing signiﬁcance relative to a fold-
change is a TREAT. Bioinformatics, 25, 765—771.

Quail,M. et al. (2012) A tale of three next generation sequencing platforms:
comparison of Ion torrent, Paciﬁc biosciences and Illumina Miseq sequen-
cers. BMC Genomics, 13,1—13.

Rapaport,F. et al. (2013) Comprehensive evaluation of differential gene
expression analysis methods for RNA-seq data. Genome Biol., 14,
R95 +.

Rossell,D. (2009) GaGa: a simple and ﬂexible hierarchical model for differen-
tial expression analysis. Ann. Appl. Stat., 3, 1035—1 051.

Rossell,D. and Muller,P. (2013) Sequential stopping for high-throughput ex-
periments. Biostatistics, 14, 75—86.

Rossell,D. et al. (2014) Quantifying alternative splicing from paired-end
RNA-seq data. Ann. Appl. Stat., 8, 309—330.

Salzman,]. et al. (2011) Statistical modeling of RNA-seq data. Stat. Sci., 26,
62—83.

Swartz,R. et al. (2006) Inverse decision theory: characterizing losses for a deci-
sion rule with applications in cervical cancer screening. ]. Am. Stat. Assoc.,
101, 1—8.

Trapnell,C. et al. (2012) Differential gene and transcript expression analysis of
RNA-seq experiments with tophat and cufflinks. Nat. Protoc., 7, 562—578.

Trapnell,C. et al. (2013) Differential analysis of gene regulation at transcript
resolution with RNA-seq. Nat. Biotechnol, 31, 46—53.

Yuan,M. and Kendziorski,C. (2006) A uniﬁed approach for simultaneous
gene clustering and differential expression identiﬁcation. Biometrics, 62,
1089—1098.

[BJO'SWHJUOFPJOJXO'SOplZIIJJOJLItOIQ/[idnq

