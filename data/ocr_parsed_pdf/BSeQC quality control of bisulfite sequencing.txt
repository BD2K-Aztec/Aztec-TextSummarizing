APPLICATIONS NOTE V°" 2305-13biESE/Zgﬁiz‘i’iiiiifgiiii

 

Sequence analysis

Advance Access publication September 23, 2013

BSeQC: quality control of bisulfite sequencing experiments
Xueqiu Linl, Deqiang Sun2'3, Benjamin Rodriguezz‘e, Qian Zhaol, Hanfei Sunl, Yong Zhang1

and Wei Li1'2'3'*

1Department of Bioinformatics, School of Life sciences and Technology, Tongji University, Shanghai 20092, China,
2Dan L. Duncan Cancer Center and 3Department of Molecular and Cellular Biology, Baylor College of Medicine,

Houston, TX 77030, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Bisulfite sequencing (BS-seq) has emerged as the gold
standard to study genome-wide DNA methylation at single-nucleotide
resolution. Quality control (QC) is a critical step in the analysis pipeline
to ensure that BS-seq data are of high quality and suitable for subse-
quent analysis. Although several QC tools are available for next-
generation sequencing data, most of them were not designed to
handle QC issues specific to BS-seq protocols. Therefore, there is a
strong need for a dedicated QC tool to evaluate and remove potential
technical biases in BS-seq experiments.

Results: We developed a package named BSeQC to comprehen-
sively evaluate the quality of BS-seq experiments and automatically
trim nucleotides with potential technical biases that may result in
inaccurate methylation estimation. BSeQC takes standard SAM/
BAM files as input and generates bias-free SAM/BAM files for down-
stream analysis. Evaluation based on real BS-seq data indicates that
the use of the bias-free SAM/BAM file substantially improves the
quantification of methylation level.

Availability and implementation: BSeQC is freely available at: http://
code.google.com/p/bseqc/.

Contact: wl1@bcm.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 23, 2013; revised on September 2, 2013; accepted
on September 18, 2013

1 INTRODUCTION

DNA methylation, an epigenetic modiﬁcation affecting the organ-
ization and function of the genome, plays an important role in
several key biological processes, including transcriptional regula-
tion, X-chromosome inactivation, genomic imprinting, silencing
of repetitive elements and chromatin structure (Robertson,
2005). Bisulﬁte conversion followed by next-generation sequencing
(BS-seq) has emerged as a powerful technique for detecting
genome-wide DNA methylation at single-nucleotide resolution
(Laird, 2010). Ideally, BS-seq experiment should be able to directly
and exactly quantify the methylation level of every cytosine in
the genome. However, current BS-seq protocols possess several
intrinsic technical biases, which may impact methylation level
estimation. These biases include overhang end-repair, 5/ bisulﬁte
conversion failure, sequencing into the adaptor and 3/ low

 

*To whom correspondence should be addressed.

sequencing quality (Bock, 2012; Liu et al., 2012). Although the
last two biases are also present in other next-generation
sequencing data, the ﬁrst two biases, i.e. end-repair and 5/ bisulﬁte
conversion failure, are highly speciﬁc to BS-seq protocols. BS-seq
reads with the ﬁrst two biases can be perfectly mapped to the
reference genome; however, they will result in biased methylation
estimation. First, after sonication, the overhangs of DNA frag-
ments are normally end-repaired with unmethylated cytosines to
restore the double stranded DNA (Illumina WGBS for
Methylation Analysis Guide). This may introduce artiﬁcially
low methylation rates at both ends of the DNA fragments.
Second, bisulﬁte conversion failure is known to be enriched at
the 5/ end of reads, most likely caused by the re—annealing of
sequences adjacent to the methylated adapters in bisulﬁte conver-
sion (Berman et al., 2012). This may bring in artiﬁcially high
methylation rates at the 5/ end of reads. Most quality control
(QC) tools, such as htSeqTools (Planet et al., 2012) and FastQC
(Andrews, 2010), only focus on the general sequence quality and
adaptor trimming, or other next-generation sequencing applica-
tions such as RNA-seq (Wang et al., 2012). To the best of our
knowledge, BSmooth and Bis-SNP are the only two tools that
support QC speciﬁc to BS-seq ﬂ-Iansen et al., 2012; Liu et al.,
2012). However, their QC functions are highly limited. The QC
model in BSmooth was designed to work with its own alignment
and analysis pipeline, and thus cannot take standard BAM/ SAM
ﬁles as input. Furthermore, BSmooth can detect but not correct
the biases. Bis-SNP only supports the correction of 5/ bisulﬁte
conversion failure. Because BS-seq experiments are widely used
and the resulting data will continue to grow exponentially in the
near future, there is a strong need for a dedicated QC tool to
assess and improve the quality of BS-seq experiments. BSeQC,
the tool we developed, is focused on the technical biases speciﬁc
to BS-seq experiments. BSeQC can automatically evaluate and
remove the biases based on a user deﬁned statistical cutoff.
Evaluation based on real BS-seq data indicates that, after bias
removal, the quantiﬁcation of methylation level is signiﬁcantly
improved.

2 METHODS

BSeQC uses M-bias plot, i.e. average DNA methylation level for each
read position, to assess and visualize bisulﬁte-speciﬁc biases (Hansen
et al., 2011). For each CpG in uniquely aligned read, BSeQC records
its relative position in the read and methylation state (methylated: C or
unmethylated: T). For a given input SAM/BAM ﬁle, BSeQC piles up all
the records and plots the mean methylation level at each read position.

 

© The Author 2013. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com 3227

112 /310's112u1n0[p10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

91oz ‘Og isnﬁnV u0 ::

X.Lin et al.

 

   

A M-bias Plot of mouse NPC 5 Distribution of CpG methylation level
*- strand :_ "ml Before BSeQC trimman

-  m - "Hit!
a? a g ' - W
E 8  g; KLummu-qmr
g e  £5
E! a i
a a
E a 2

100

a

m 40 an an so 70 50 911 «w
Position In rand :5‘ 7> 3'] rnetlvylahon level (99)

 

H Slrand m—J. After BSeQC trimming
— i
1 E u, — maria! "
a? a  -' _ "um: ‘
E 2 e2
E w museum-p.129
g c. E
i ' U
z 8
0 2|} dd SO SB I00 50 BO 70 BO 90 cm

 

Position in lead (5‘ -> 3')

melhyiaticn level ('31:)

Fig. 1. BSeQC analyses of paired-end mNPC data. (A) M-bias plots
for two complementary strands of chrl. Horizontal line: M-bias plot;
dash vertical line: trimming positions. (B) Distributions of methylation
levels. Blue line: matel (++ and —+ strands); red line: mate2 (+— and
—— strands)

As the methylation levels are expected to be independent of the read
positions, the M-bias plot ought to exhibit a horizontal line. If there
are biases, the M-bias plot will show position-speciﬁc deviation from
the horizontal line, which are often observed at both ends of reads.
Because different DNA strands and read lengths can have distinct
biases, BSeQC generates separate M-bias plots for different strand and
read length conﬁgurations. BSeQC also produces non-CpG cytosine
M-bias plots to detect bisulﬁte conversion failure because non-CpG cyto-
sines should be almost completely converted.

To remove biases detected in the M-bias plot, BSeQC uses a statistical
cutoff to make trimming decision automatically. Given the observation
that read center positions (3&70% of read length) usually have high
quality, whereas both read ends are susceptible to technical biases, the
average methylation levels in read center positions can be used to ﬁt a
normal NULL distribution ~N(p,,02). The methylation level of each
read end position is then evaluated by a P-value, indicating the statistical
signiﬁcance of the deviation from the NULL. The positions of all the
reads will be trimmed if they exhibit signiﬁcant biases, i.e. P5001.
BSeQC automatically uses the most stringent trimming decision made
by either CpG or non-CpG cytosines M-bias plots. After bias removal,
BSeQC generates a corresponding bias-free SAM/BAM ﬁles for the
downstream analysis.

3 RESULTS

We demonstrated the capabilities of BSeQC using two publicly
available datasets: (i) paired-end WGBS from mouse ES-derived
neuronal progenitor cells (mNPC) (Stadler et at, 2011), and
(ii) single-end WGBS from H1 human ES cells (Lister et at,
2009). After reads mapping using BSMAP 0(i and Li, 2009),
we observed the end-repair bias in the 5/ of ‘:l:’ strand
(Supplementary Table S1) and the 5/ bisulﬁte conversion failure
in the ‘++’ strand in the M-bias plots of paired-end mNPC data
(Fig. 1A). This observation indicates that different DNA strands
may exhibit different technical biases in BS-seq experiments
(Supplementary Note S1). As expected, the 5/ bisulﬁte conver-
sion failure is more obvious in non-CpG cytosine M-bias plots
(Supplementary Fig. S1). In the single-end H1 data, we used
BSMAP to remove adaptor and low-quality nucleotides during
mapping. However, there are still biases in the 3/ of ‘++’ strands

of both replicates, probably indicating residual adapters and
low-quality nucleotides that cannot be fully removed by conven-
tional QC approaches (Supplementary Fig. S2A). In addition, we
observed different biases in different read length in H1 data
(Supplementary Fig. S3).

Because there is no ground truth for methylation estimation,
we decided to use the concordance between two replicates to
evaluate the performance of BSeQC bias trimming. As expected,
the agreement of methylation level distributions between two
read mates derived from the same paired-end mNPC data is
significantly increased after BSeQC trimming, especially in high
methylation levels (Fig. 1B). The KullbackiLeibler distance, a
measurement of difference between two probability distributions
(Kullback and Leibler, 1951), decreases from 0.207 to 0.129 after
BSeQC trimming. Similar improvement can also be observed in
single-end H1 data (Supplementary Fig. S2B), RRBS data
(Supplementary Fig. S4) and mouse NPC data (Supplementary
Fig. S5). Together, we conclude that the usage of BSeQC can
significantly improve the methylation estimation.

4 CONCLUSION

BSeQC serves as a critical step between reads mapping and
methylation estimation. BSeQC comprehensively evaluates the
technical biases related to BS-seq protocols and automatically
makes trimming decision using a statistical cutoff. This is a
vast improvement to arbitrarily read trimming (e.g. the ﬁrst
three and last three nucleotides). In addition to M-bias plot
guided bias trimming, BSeQC can also automatically remove
clonal reads from over-ampliﬁcation and avoid double counting
of overlapped segments in paired-end reads (Supplementary
Fig. S6). With its standard SAM/BAM input/output interface,
BSeQC can be easily incorporated into any existing BS-seq data
analysis pipeline. In summary, we believe BSeQC will greatly
facilitate the analysis and understanding of DNA methylation
bisulﬁte sequencing data.

Funding: 973 Program of China [2010CB944900], CPRIT
RP110471-C3 and NIH [R01HG007538].

Conﬂict of Interest: none declared.

REFERENCES

Andrews,S. (2010) FastQC. A quality control tool for high throughput sequence
data. http://www.bioinformatics.babraham.ac.uk/projects/fastqc/ (8 October
2013, date last accessed).

Berman,B.P. et a]. (2012) Regions of focal DNA hypermethylation and long—range
hypomethylation in colorectal cancer coincide with nuclear lamina—associated
domains. Nat Genet., 44, 40—46.

Bock,C. (2012) Analysing and interpreting DNA methylation data. Nat Rev.
Genet., 13, 7057719.

Hansen,K.D. et a]. (2012) BSmooth: from whole genome bisulﬁte sequencing reads
to differentially methylated regions. Genome Biol., 13, R83.

Hansen,K.D. et a]. (2011) Increased methylation variation in epigenetic domains
across cancer types. Nat Genet., 43, 7687775.

Kullback,S. and Leibler,R.A. (1951) On information and sufﬁciency, information
and sufﬁciency. Ann. Math. Stat, 22, 79786.

Laird,P.W. (2010) Principles and challenges of genome—wide DNA methylation
analysis. Nat Rev. Genet., 11, 1917203.

Lister,R. et a]. (2009) Human DNA methylomes at base resolution show widespread
epigenomic differences. Nature, 462, 3157322.

 

3228

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

91oz ‘Og isnﬁnv uo ::

BSeQC

 

Liu,Y. et al. (2012) Bis—SNP: combined DNA methylation and SNP calling for
Bisulﬁte—seq data. Genome Biol., 13, R61.

Planet,E. et a]. (2012) htSeqTools: high—throughput sequencing quality control,
processing and visualization in R. Bioinformatics, 28, 5897590.

Robertson,K.D. (2005) DNA methylation and human disease. Nat Rev. Genet, 6,
5977610.

Stadler,M.B. et al. (2011) DNA—binding factors shape the mouse methylome at
distal regulatory regions. Nature, 480, 490—495.

Wang,L. et al. (2012) RSeQC: quality control of RNA—seq experiments.
Bioinformatics, 28, 2184w2185.

Xi,Y. and Li,W. (2009) BSMAP: whole genome bisulﬁte sequence MAPping
program. BMC Bioinformatics, 10, 232.

 

3229

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papaolumoq

91oz ‘Og isnﬁnv uo ::

