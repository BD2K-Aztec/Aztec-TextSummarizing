APPLICATIONS NOTE

Vol. 28 no. 5 2012, pages 721-723
doi:10. 1 093/bioinformatics/btsO23

 

Genome analysis

Advance Access publication January 17, 2012

FX: an RNA-Seq analysis tool on the cloud

Dongwan Hong1’2’1, Arang Rhie1’3’4’5’1, Sung-Soo ParkB’T, Jongkeun Leez,

Young Seok Jul], Sujung KimB, Saet-Byeol Yue, Thomas Bleazardl, Hyun-Seok Park3,
Hwanseok Rhee7’8, Hyonyong Chong7’8, Kap—Seok Yang738, Yeon-Su Lee2, In-Hoo Kim2,
Jin Soo Leez, Jong—II Kim1’4’5’6’* and Jeong-Sun Seola4’6’7’8ai‘

1Genomic Medicine Institute, Medical Research Center, Seoul National University, Seoul 110—799, 2Cancer
Genomics Branch and Research Institute and Hospital, National Cancer Center, Goyang—si 410—769, 3Department of
Computer Science and Engineering, Ewha Womans University, Seoul 120—750, 4Department of Biochemistry, Seoul

National University College of Medicine, 5Department of Biomedical Sciences, Seoul National University Graduate
School, 6Psoma Therapeutics Inc., Seoul 110—799, 7Macrogen |nc., Seoul 153—023 and 8Axeq Technologies,

Rockville, MD 20850, USA
Associate Editor: Prof. Ivo Hofacker

 

ABSTRACT

Summary: FX is an RNA-Seq analysis tool, which runs in parallel on
cloud computing infrastructure, for the estimation of gene expression
levels and genomic variant calling. In the mapping of short RNA-
Seq reads, FX uses a transcriptome-based reference primarily,
generated from ~160 000 mRNA sequences from RefSeq, UCSC
and Ensembl databases. This approach reduces the misalignment
of reads originating from splicing junctions. Unmapped reads not
aligned on known transcripts are then mapped on the human
genome reference. FX allows analysis of RNA-Seq data on cloud
computing infrastructures, supporting access through a user-friendly
web interface.

Availability: FX is freely available on the web at (http://fx.gmi.
ac.kr), and can be installed on local Hadoop clusters. Guidance
for the installation and operation of FX can be found under the
‘Documentation’ menu on the website.

Contact: jeongsun@snu.ac.kr; jongil@snu.ac.kr

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 2, 2011; revised on December 28, 2011;
accepted on January 8, 2012

1 INTRODUCTION

Accurately quantifying gene expression levels and identifying
variants in the transcriptome is important for research into cell
differentiation and disease diagnosis. Recently, various genome
research groups have developed genome and transcriptome analysis
software based on Cloud computing technology to facilitate the
analysis of large amounts of sequencing data without the purchase
of computing resources. Bioinformatics Cloud resources using
the Hadoop Map/Reduce framework have been released, such as
CloudAligner (Nguyen et (11., 2011), CloudBurst (Schatz, 2009),
Crossbow (Langmead et (11., 2009) and MyRNA (Langmead et (11.,

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that, in their opinion, the ﬁrst three authors
should be regarded as joint First Authors.

2010) (Supplementary Table S1). However, operation of Cloud-
based analytic tools can be difﬁcult for non-expert users such as
biologists and medical doctors.

In our previous study (Ju et (11., 2011), we found a problem
inherent to RNA-Seq analysis tools that align to the human reference
genome: reads coming from spliced junctions of large introns
cannot be aligned due to indel (insertion and deletion) sensitivity
of alignment tools. To resolve this problem, recent studies have
analyzed gene expression and alternative splicing by aligning short
RNA-Seq reads against previously known or predicted transcripts
(Ju et (11., 2011; Trapnell et (11., 2010). Following this approach,
we enhanced the mapping of short reads by aligning toward a
reference composed of known genes and their isoforms. To identify
unannotated transcripts, FX aligns the remaining unmapped reads
onto human genome reference. When short reads align to multiple
CDNA sequences from the three databases, only the hit with the
highest mapping score is used (Supplementary Fig. S1). This method
allowed us to proﬁle gene expression and call variants with great
accuracy (Ju et (11., 2011).

In this work, we implemented these methods in the user-Friendly
gene eXpression analytic tool (FX), allowing RNA-Seq data analysis
to begin immediately upon completion of sequencing. FX can be run
by researchers without investment in their own high performance
computing (HPC) at low cost using the Amazon Web Services
(AWS, http://aws.amazon.com). The results output by FX are gene
expression proﬁles, SNP calls and short indels (Supplementary
Material 1). This service can be accessed through our web interface.
Alternatively, FX is freely available for local distribution.

2 METHODS

In FX. each step is processed by mapping. shufﬂing and reducing the
data over worker nodes. System conﬁguration is shown in Supplementary
Figure S2. FX splits data processing into several steps (Supplementary
Fig. S3). Due to this loosely coupled step design. the researcher can run
each step separately with custom ﬁlter conditions.

Preprocess: before aligning paired-end sequencing reads to the reference. the
preprocess step converts the FASTQ ﬁle to GSNAP (Wu and Nacu. 2010)
input format.

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 721

112 ﬁlo's[Bruno[pJOJXO'sorwurJOJurorqﬂ:duq wort papBOIII/lAOG

91oz ‘Og anﬁnv uo ::

D.Hong et al.

 

AWS Credentials

Sign up for Amazon Web Service, and subscribe for S3, Elastic MapReduce, Elastic

Compute Cioud For details, visit AWS at -.  . :-~:.- --..

AWS Access Key AKM‘U‘JTJTHOVHDODGBD

AWS Secret KEY

Define the Size of the Cloud

instance Type In1.x|arge (15 63 them If 3 E62 Units (4 virtual cores with 2 E82 Unis 9: El

Details for-    .. and ..

Number of 10

instances
If you wish to run more than 20 instances, complete the 
" ' -' at AWS.

Relerence

'9 hnglBuild 3?] . hgl3(8uild 36.3] . mmg

Configure Analysis Options

'9 Run at Once

l}: l. Preprocess lull have a sarn format file
This process splits raw FASTQ ﬁle for faster map-reduce manipulation and
prepare for GSNAP alignment. Split into 54 ﬁles

ii 2. GSNAP Alignment options £1 get result in sam format file
nmtmax—mismatchesl ID , -I(inde|-penaltvl 3 ,

other options: —n 41] —I ‘l —0
'You may leave it as it is

:3. 3. Base Call
From the alignment result, ﬁlter bases out under these criteria:

Filter bases uncler qualityI value of 20 , quality encoding: Solexa +64 

Trim 4 bases from each read ends to avoid adapter sequences

:3 4_ SNP Call
Count as SNP when allele appears more than 4 x

Deﬁne as SNP when frequency over wildtype is greater than 1.0 %

Project Directory

Point to the 53 URL for the project directory, the parent directory of ‘rawdata‘ or
'align_results' directory. 'rawdata' director‘,f contains the raw FASTQ sequence
ﬁles. and 'align_results' contains the GSNAP result or SAM ﬁles.

Project URL 33:.ftbt—sampleersamle_ans

For example, if the 53 structure looks as following.

53'.".'fx-samoles. sample_l .-
align_results'
pan—OOODOJesuIt
part-00001.result
oan-OOUOSsam
rawdata
seq_l 4_pairl .fastq
seq_l 4_pair2.fastq

than out s3:fo~—samplel sampleJ into the following ﬁeld.

' Custom path 53:“

See how to make a custom reference

' Step by Step

25"? 5_ INDEL Call
Count as INDEL when allele appears more than a x

Deﬁne as tNDEL when frequency over wildtvpe is greater than 1.0 $13

 6. Expression Proﬁling
Normalization Method : '. BPKM, a FPKM

Similar to RPKMlFPKM). normalize proﬁle expression level in base resolution

of each gene (BPKM)
Filter as 'expressed' with BPKMtFPKMl > 1.0

Gene Model. 'Union Gene Model, 9' Union Intersection Modei
Are you running Base Call? If NOT

 3?. map unmpped reads against reference genome
—m(max—mismatches) 10 , —i(indel—penaltyl 3 ,
Splice options: —5 splicesites —N
other options: —n 40 —t 1 ~0

'You may.r leave it as it is

Fig. 1. The web-based user interface of FX, which calls analysis modules exploiting Amazon Web Service cloud computing resources.

Mapping on cDNA sequences: FX uses GSNAP as its default alignment
tool. Alignment is done against our own cDNA reference which consists of
transcripts from refGenes (~34 000), Known Genes (~65 000) and Ensembl
(~62 000) from NCBI, UCSC and EBI, respectively. In addition, alignment
of unmapped reads is carried out on the human genome reference to detect
unannotated transcripts. These transcripts are reported if they have average
coverage 34 and do not overlap any genes. The preprocess and alignment
steps can be omitted if the user has already aligned with a different tool
yielding results in SAM format. FX is mainly intended for analysis of human
RNA-Seq data. However, users can add a custom reference to analyze other
species.

Bioinformatic ﬁlter conditions: the GSNAP output format and SAM format
are both accepted as input. This step ﬁlters out reads that have too many
mismatches (>5% of the read length) and bases with Phred quality score
<20 by default (Kim et a1., 2009). Some (4 by default) bases are trimmed in
order to avoid the ambiguity of alignment at read ends. Reads with multiple
alignments to the human reference genome are eliminated.

SNP and indel identiﬁcation: FX calls genomic variants (SNPs and indels)
with 3 4 uniquely aligned reads and allele frequency 3 1% using ﬁlter criteria
in (Ju et a1., 2011; Kim et a1., 2009).

Proﬁling of transcript expression: in this step, bases aligned on each gene
are aggregated. Similar to reads per kilobase of exon per million mapped
reads (RPKM) (Mortazavi et a1., 2008), FX uses a concept of bases per
kilobase of gene model per million mapped bases (BPKM) to normalize
the expression level of each gene. We deﬁned genes with BPKM 31 as
‘expressed’ (Supplementary Material 2). Users may alternatively select to
View results in terms of RPKM (Supplementary Material 2).

3 RESULTS

We developed FX as described in Section 2, to run on local Hadoop
systems as well as the Amazon cloud system. FX was implemented
using JDK 1.6.0, designed to run on clustered computers using the
Hadoop Distributed File System (HDFS) built by Apache Hadoop
0.21 (http://hadoop.apache.org). A user-friendly web interface was
designed, allowing researchers to adjust the bioinformatic ﬁlter
conditions as desired (Fig. 1). We analyzed the transcriptome data
of a Korean individual (designated AK6) using FX. Sequencing

 

722

112 /3.IO'S[BHmO[p.IOJXO'SOIJBLUJOJIIIOICWIdllq mot} popeommoq

9IOZ ‘OE ISUEHV Ho ::

FX: an RNA-Seq analysis tool

 

with Illumina Genome Analyzer IIx yielded ~70M paired-end
reads (78bp for each end) at a coverage of 69X. We found
evidence for active transcription of 1905 genes with expression level
31 BPKM. The total estimated running time was 81 min using
40 Amazon EC2 instances at a cost of US $45 (Supplementary
Tables S2—S5 and Supplementary Fig. S4). RNA-Seq data and
analysis results are available on TIARA (Hong et (11., 2011)
and FX’s website, respectively. We expect that FX will be used
widely in the RNA-Seq community due to the high accuracy
of its expression proﬁling and its user-friendly interface to the
cloud.

Funding: Green Cross Therapeutics (grant No. 0411-20080023
to J .-S.S.); Korean Ministry of Knowledge Economy (grant No.
10037410-2011-02 to J .-S.S.); Korean Ministry of Education,
Science, Technology (grant No. M 10305030000 to J .-S.S.; grant No.
2010-0013662 to J .-I.K.); Small Medium Business Administration
(grant No. 000358780109 to H.-S.P.); Amazon Web Services (June
2011 EDU research award) in part.

Conﬂict of Interest: none declared.

REFERENCES

Hong,D. et a1. (2011) TIARA: a database for accurate analysis of multiple personal
genomes based on cross-technology. Nucleic Acids Res., 39, D8837D888.

Ju,Y.S. et a1. (2011) Extensive genomic and transcriptional diversity identiﬁed through
massively parallel DNA and RNA sequencing of eighteen Korean individuals. Nat.
Genet, 43, 7457752.

Kim,J.I. et a1. (2009) A highly annotated whole-genome sequence of a Korean
individual. Nature, 460, 101171015.

Langmead,B. et a1. (2009) Searching for SNPs with cloud computing. Genome 3101.,
10, R134.

Langmead,B. et a1. (2010) Cloud-scale RNA-sequencing differential expression
analysis with Myrna. Genome 3101., 11, R83.

Mortazavi,A. et a1. (2008) Mapping and quantifying mammalian transcriptomes by
RNA-Seq. Nat. Methods, 5, 621$28.

Nguyen,T. et a1. (2011) CloudAligner: a fast and full-featured MapReduce based tool
for sequence mapping. BMC Res. Notes, 4, 171.

Schatz,M.C. (2009) CloudBurst: highly sensitive read mapping with MapReduce.
Bioinformatics, 25, 136371369.

Trapnell,C. et a1. (2010) Transcript assembly and quantiﬁcation by RNA-Seq reveals
unannotated transcripts and isoform switching during cell differentiation. Nat.
Biotechnol., 28, 5117515.

Wu,T.D. and Nacu,S. (2010) Fast and SNP-tolerant detection of complex variants and
splicing in short reads. Bioinformatics, 26, 8737881.

 

723

112 /3.to's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq uteri popcolumoq

9103 ‘Og isnﬁnv uo ::

