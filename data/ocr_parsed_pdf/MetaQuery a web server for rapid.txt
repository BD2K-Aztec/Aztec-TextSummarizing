Bioinformatics, 31120), 2015, 3368—3370

doi: 10.1093/bioinformatics/btv382

Advance Access Publication Date: 22 June 2015
Applications Note

 

Sequence analysis

MetaQuery: a web server for rapid annotation
and quantitative analysis of specific genes in the
human gut microbiome

Stephen Nayfach1'*, Michael A. Fischbach2 and Katherine S. Pollard1

1Integrative Program in Quantitative Biology, Gladstone Institutes, and Division of Biostatistics, University of
California San Francisco and 2Department of Bioengineering and Therapeutic Sciences and California Institute for
Quantitative Biosciences, University of California San Francisco, San Francisco, CA, USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on April 20, 2015; revised on June 2,2015; accepted on June 16, 2015

Abstract

Summary: Microbiome researchers frequently want to know how abundant a particular microbial
gene or pathway is across different human hosts, including its association with disease and its co—
occurrence with other genes or microbial taxa. With thousands of publicly available metagenomes,
these questions should be easy to answer. However, computational barriers prevent most
researchers from conducting such analyses. We address this problem with MetaOuery, a web
application for rapid and quantitative analysis of specific genes in the human gut microbiome. The
user inputs one or more query genes, and our software returns the estimated abundance of these
genes across 1267 publicly available fecal metagenomes from American, European and Chinese
individuals. In addition, our application performs downstream statistical analyses to identify fea—
tures that are associated with gene variation, including other query genes (i.e. gene co—variation),
taxa, clinical variables (e.g. inflammatory bowel disease and diabetes) and average genome size.
The speed and accessibility of MetaOuery are a step toward democratizing metagenomics
research, which should allow many researchers to query the abundance and variation of specific
genes in the human gut microbiome.

Availability and implementation: http://metaquery.docpollard.org.

Contact: snayfach@gmail.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

A number of large-scale shotgun metagenomics projects have been
made publicly available, enabling researchers to investigate the func-
tional composition of microbial communities from the human body
and how microbial functions correlate with disease or other traits
(Aagaard et (11., 2013; Li et (11., 2014). A common goal of many
microbiome studies is to quantify the abundance of specific genes
across these publicly available datasets. In most cases, this task in-
volves (l) downloading metagenomes from public repositories, (2)
mapping reads to a reference database and (3) estimating gene

(63 The Author 2015. Published by Oxford University Press.

abundances. For example, this was the approach used by Donia
et al. (2014) to estimate the abundance of 14000 biosynthetic gene
clusters in the human microbiome. However, this approach is time-
consuming and computationally demanding—requiring large
and is therefore

 

amounts of storage space and processing power
not practical for many research groups.

In an attempt to address this issue, several microbiome studies
have made their functional annotations publicly available. For ex-
ample, the Human Microbiome Project (HMP) Data Analysis and
Coordination Center provides the abundance of KEGG Orthology

3368

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

MetaQuery: a web server for genes in the human gut microbiome

3369

 

Groups across 649 metagenomes from the human microbiome.
Other studies have provided similar resources for other samples and
databases. While useful, these resources only represent a small pro—
portion of available samples and their annotations typically cover
only a small fraction of genes in most metagenomes. For example,
only 36% of reads from the HMP were mapped to a KEGG
Orthology Group (Abubucker et al., 2012). Furthermore, databases
such as KEGG use unsupervised methods to cluster genes into ortho—
log groups that may not track with protein function (Schnoes et al.,
2009).

More recently, there have been several efforts to create compre—
hensive gene catalogs that cover a much higher proportion of genes
in the gut microbiome. Most notably, Li et al. (2014) used 1267
samples from six different studies together with 511 genomes from
gut microbiota to assemble a gene catalog of 9.9 million non—redun—
dant genes. MetaQuery leverages this existing resource in order to
provide users the ability to rapidly estimate the abundance of one or
more query sequences across 126 7 fecal metagenomes. Instead of re—
mapping metagenomic reads for each query, reads were mapped
once to the gene catalog, which can then be queried many times.
Our framework allows the specification of sequence homology
thresholds, which enable the user to define the relationship between
sequence similarity and function. Finally, we use a set of 30 univer—
sal single—copy genes to normalize gene abundances to eliminate
biases due to average genome size and database coverage (Manor
and Borenstein, 2015; Nayfach and Pollard, 2015). This simple yet
efficient framework has the potential to make large—scale metage—
nomics research accessible to a greater number of microbiome
researchers.

2 Implementation

2.1 Gene abundance estimation

MetaQuery leverages the gene catalog and gene abundances pub—
lished by Li et a]. (2014) to rapidly estimate the abundance of one or
more query genes in the human gut microbiome (Supplementary Fig.
51). First, the user submits one or more protein sequences in FASTA
format, which are aligned against the gene catalog using either
BLAST (Altschul et al., 1990) or RAPsearch2 (Zhao et al., 2012).
Next, homologs of the query sequence(s) are identified in the gene
catalog based on the resulting alignments and user—specified thresh—
olds, which give the user flexibility to target either close or remote
homologs of the query sequence in the gene catalog. For each query,
the abundances of identified homologs are rapidly obtained from a
precomputed matrix, and these abundances are summed per—query
and per—sample. Next, gene abundances are optionally normalized
using the relative abundance of 30 universal single—copy genes.
Finally, gene abundance(s) are compared against a background set
of queries in order to give the user a context in which to interpret
their results.

2.2 Statistical analysis

After having obtained gene abundances, MetaQuery performs a
number of statistical analyses. In the case of multiple query se—
quences, MetaQuery will build a Spearman correlation matrix of
query genes across microbiome samples. Gene co—variation can iden—
tify genes that are physically linked on a genome, or genes that func—
tionally interact in a metabolic pathway or protein complex. Next,
Kruskal—Wallis tests are performed to identify genes that are differ—
entially abundant between sample groups including: host continent
(i.e. North America, Europe and Asia), and host health status (e.g.

inflammatory bowel disease and diabetes). Finally, MetaQuery per—
forms Spearman correlations of gene abundance versus average gen—
ome size (Nayfach and Pollard, 2015) and MetaPhlan (Segata et al.,
2012) taxonomic abundances.

3 Case study

We used MetaQuery to explore metagenomic variation of the fruc—
tan utilization locus found in Bacteroides thetaiotamicron. This
locus consists of a cluster of co—regulated genes that degrade non—di—
gestible fructose—based polysaccharides from the human diet
(Sonnenburg et al., 2010). We found that members of the locus
tended to be quite abundant and varied extensively across gut micro—
biome samples, with an average estimated copy number of 1 per 50
cells, which ranked in the top 2% relative to other genes in the gene
catalog. The locus was most abundant in American subjects
(mean:1 copy per 38 cells) and lowest in European individuals
(mean: 1 copy per 220 cells) (Supplementary Fig. 52A). We found
that the locus was marginally associated with both Crohn’s disease
(P20.048) and diabetes (P20.045), indicating a potential role of
microbes capable of fructan utilization in human disease
(Supplementary Fig. S2B—D). Interestingly, variation of the fructan
locus was strongly correlated with both AGS (p : 0.62) and the rela—
tive abundance of Bacteroides (p : 0.68), although even in commun—
ities with large AGS or high Bacteroides abundance, there was still a
large variation in the abundance of the locus (Supplementary Fig.
S3). Finally, we observed that the abundance of genes BT1757—58
and BT1760—63 was strongly correlated across hosts (all p > 0.97),
which is consistent with the fact that these genes are physically and
functionally linked (Supplementary Fig. S4).

4 Conclusions

MetaQuery is a web application that allows rapid and quantitative
analysis of genes in the human gut microbiome. Our simple
framework should enable researchers to easily investigate
metagenomic variation of specific genes of interest across a large co—
hort of samples from the gut microbiome. Our current reference
database contains genes and abundances for 1267 samples. In the
future, these databases could be updated as additional fecal
metagenomes become publicly available. Finally, this framework is
not restricted to the human gut microbiome and could be applied to
other environments, including metagenomes from soil and marine
environments.

Acknowledgements

We particularly thank Joseph Nayfach for helpful discussion and advice re-
garding the computational framework and design of our application. We also
thank Peter Turnbaugh and Thomas Sharpton for helpful feedback.

Funding

This work was supported by funding from NSF Grant #DMS-1069303,
Gordon 86 Betty Moore Foundation Grant #3300, the San Simeon Fund, and
institutional funds from Gladstone Institutes.

Conﬂict oflnterest: none declared.

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

3370

S.Nayfach et al.

 

References

Aagaard,K. et al. (2013). The Human Microbiome Project strategy for com-
prehensive sampling of the human microbiome and why it matters. FASEB
1,27,1012—1022.

Abubucker,S. et al. (2012). Metabolic reconstruction for metagenomic data
and its application to the human microbiome. PLoS Compnt. Biol, 8,
61002358.

Altschul,S.F. et al. (1990). Basic local alignment search tool. ]. Mol. Biol,
215, 403—410.

Donia,M.S. et al. (2014). A systematic analysis of biosynthetic gene clusters in
the human microbiome reveals a common family of antibiotics. Cell, 158,
1402—1414.

Li,]. et al. (2014). An integrated catalog of reference genes in the human gut
microbiome. Nat. Biotechnol, 32, 834—841.

Manor,O. and Borenstein,E. (2015). MUSiCC: a marker genes based frame-
work for metagenomic normalization and accurate proﬁling of gene abun-
dances in the microbiome. Genome Biol, 16, 53.

Nayfach,S. and Pollard,K.S. (2015). Average genome size estimation improves
comparative metagenomics and sheds light on the functional ecology of the
human microbiome. Genome Biol, 16, 51.

Schnoes,A.M. et al. (2009). Annotation error in public databases: misannota-
tion of molecular function in enzyme superfamilies. PLOS Compnt. Biol, 5,
e1000605.

Segata,N. et al. (2012). Metagenomic microbial community proﬁling using
unique clade-speciﬁc marker genes. Nat. Methods, 9, 811—814.

Sonnenburg,E.D. et al. (2010). Speciﬁcity of polysaccharide use in intestinal
bacteroides species determines diet-induced microbiota alterations. Cell,
141,1241—1252.

Zhao,Y. et al. (2012). RAPSearch2: a fast and memory-efﬁcient protein
similarity search tool for next-generation sequencing data. Bioinformatics, 28,
125—126.

/310'S[Bum0fplOJXO'SOIIBLUJOJIIIOICV/Idllq

