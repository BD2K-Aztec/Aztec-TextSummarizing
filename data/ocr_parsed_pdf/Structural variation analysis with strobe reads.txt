HITSEQ PAPER

Vol. 26 no. 10 2010, pages 1291-1298
doi: 1 0. 1 093/bioinformatics/btq153

 

Sequence analysis

Advance Access publication April 8, 2010

Structural variation analysis with strobe reads

Anna Ritz“, Ali Bashir2’l and Benjamin J. Raphaellasa‘k

1Department of Computer Science, Brown University, Providence, RI 02912, 2Pacific Biosciences, 1505 Adams Drive,
Menlo Park, CA 94025 and 3Center for Computational Molecular Biology, Brown University, Providence, RI 02912, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: Structural variation including deletions, duplications and
rearrangements of DNA sequence are an important contributor to
genome variation in many organisms. In human, many structural
variants are found in complex and highly repetitive regions of
the genome making their identification difficult. A new sequencing
technology called strobe sequencing generates strobe reads
containing multiple subreads from a single contiguous fragment
of DNA. Strobe reads thus generalize the concept of paired
reads, or mate pairs, that have been routinely used for structural
variant detection. Strobe sequencing holds promise for unraveling
complex variants that have been difficult to characterize with current
sequencing technologies.

Results: We introduce an algorithm for identification of structural
variants using strobe sequencing data. We consider strobe reads
from a test genome that have multiple possible alignments to
a reference genome due to sequencing errors and/or repetitive
sequences in the reference. We formulate the combinatorial
optimization problem of finding the minimum number of structural
variants in the test genome that are consistent with these alignments.
We solve this problem using an integer linear program. Using
simulated strobe sequencing data, we show that our algorithm has
better sensitivity and specificity than paired read approaches for
structural variation identification.

Contact: braphael@brown.edu

Received on March 4, 2010; revised on April 2, 2010; accepted on
April 5, 2010

1 INTRODUCTION

Identifying the DNA sequence differences that distinguish
individuals is a major challenge in genetics. Recent whole-
genome sequencing and microarray measurements have shown that
copy number variants (insertions, duplications and deletions) and
balanced rearrangements, such as inversions and translocations, are
common in most organisms including human (Sharp et a1., 2006),
mouse (Egan et a1., 2007), ﬂy (Dopman and Hartl, 2007) and yeast
(Faddah et a1., 2009). These larger differences in DNA sequences
are commonly referred to as structural variants. The Database of
Genomic Variants (Iafrate et a1., 2004) currently (winter 2010)
lists nearly 30 000 copy number variants and nearly 900 inversion
variants in the human genome. Although some of these variants are

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion. the ﬁrst two authors
should be regarded as joint First Authors.

redundant and/or erroneous, it is clear that structural variation is
an important component of human genome variation. In fact, there
are more total base pairs in human genome affected by structural
variants than single nucleotide polymorphisms (SNP; Redon et a1.,
2006). Both common and inherited structural variants and de novo
structural variants have recently been linked to a number of human
diseases (Girirajan et a1., 2010; Greenway et a1., 2009; Marshall
et a1., 2008). Moreover, somatic structural variants are common in
cancer genomes and lead to altered regulation of oncogenes and
tumor suppressor genes (Albertson et a1., 2003) and the creation of
novel fusion genes (Mitelman et a1., 2004).

Much of the recent excitement surrounding structural variation
stems from better measurement technologies. In particular, End
Sequence proﬁling (Raphael et a1., 2003; Volik et a1., 2003), also
known as paired read mapping (Korbel et a1., 2007; Tuzun et a1.,
2005), has been used to identify structural variants in both normal
and cancer genomes. In paired read mapping, DNA fragments from
a test genome are sequenced from both ends, and these sequences
(reads) are mapped to a reference genome. Paired reads, or mate
pairs, with discordant alignments identify inversions, translocations,
transpositions, insertions, deletions and other rearrangements that
distinguish the test genome from the reference genome. A number
of methods have been introduced to identify structural variants from
paired read sequencing data (Bashir et a1., 2008; Chen et a1., 2009;
Hormozdiari et a1., 2009; Korbel et a1., 2009; Lee et a1., 2008;
Quinlan et a1., 2010; Raphael et a1., 2003).

Structural variants vary widely in size and complexity, and are
more difﬁcult to characterize than SNPs. Many are associated
with repeated sequences in the genome (Korbel et a1., 2007),
complicating their detection and characterization. In extreme
cases, the variants themselves have highly repetitive or complex
organization relative to the reference genome. For example, different
lists of variants have been identiﬁed in the same individual using
older clone-based sequencing (Kidd et a1., 2008) and various next-
generation sequencing platforms (Bentley et a1., 2008; Hormozdiari
et a1., 2009; Korbel et a1., 2007). Characterizing these complex
variants requires longer reads, longer fragments, or both.

Paciﬁc Biosciences recently demonstrated strobe sequencing
technology (Turner, 2009). A strobe read, or strobe, consists of
multiple subreads from a single contiguous fragment of DNA. These
subreads are separated by a number of ‘dark’ nucleotides (called
advances), whose identity is unknown (Fig. l). A strobe with two
subreads is analogous to a paired read, while strobes with more than
two subreads provide additional information for structural variant
detection. Thus far, Paciﬁc Biosciences has demonstrated strobe
reads with lengths up to 10kb with 2—4 subreads each of 50—200 bp.
Additional improvements are expected as technology matures.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1291

112 /3.Io's[Bruno[p.IOJxosoiwuiJOJuioiq”:duq wort pepeolumoq

9103 ‘{g anﬁnv uo ::

A.Ritz et al.

 

subread subread Fl subread

T t  .ady 
e S

Genome

Reference ‘ ‘ ﬂ
Y2 X1

Genome yl xl 1—deletion—i3 y3 x3

 

 

 

 

 

a

concordant discordant

Fig. 1. A strobe read is a sequence of subreads and advances. When aligned
to a reference genome, pairs of adjacent subreads can either be labeled as
concordant or discordant, according to a derived minimum and maximum
allowed length of an advance.

Strobe sequencing provides reads from long, contiguous fragments
of DNA with low input DNA requirements, a feature missing
from current short insert sequencing technologies. However, a
consideration with strobe reads are the per-base error rates. While
the capabilities of the Paciﬁc Biosciences commercial machine
(expected later in 2010) are not yet known, we conservatively
assume that this error rate will be higher than existing next-
generation sequencing technologies. Thus, realizing the advantages
of strobe reads for structural variation detection demands new
algorithms that utilize information from multiple subreads while
allowing higher single-base error rates.

We introduce an algorithm to identify and characterize complex
structural variants with strobe reads by considering multiple possible
alignments for each subread. We formulate the combinatorial
optimization problem of selecting an alignment for each subread
of every strobe read so that the total number of structural variants
in the test genome is minimized. This generalizes a formulation that
has proved successful for paired read analysis (Hormozdiari et a1.,
2009). We show how to reduce the problem to an optimization
problem on directed graphs, and derive an integer linear program
(ILP) for the problem. We apply our method to simulated strobe read
sequencing data. We ﬁnd that strobe reads outperform paired reads
for structural variation detection. In particular, at a ﬁxed sensitivity
level strobe reads have nearly double the speciﬁcity of paired reads.

2 APPROACH

A strobe read, or n-strobe, S=(R1,A1,R2,A2,...,An_1,Rn) is an
alternating sequence of subreads Ri, whose sequence is known, and
advances Aj, unknown sequences of ‘dark’ bases. The sequencing
technology does not identify precisely the length, or number of dark
bases, in each advance. However, the length of an advance is related
to the time that the DNA polymerase incorporates dark bases. Thus,
a distribution f (a) for the length is obtained from the data. From this
distribution, we derive a minimum and maximum allowed length of
an advance which we denote by Lmin and Lmax, respectively.
Suppose one has strobe reads from a test genome and wants
to identify structural variants that distinguish this genome from a
reference genome. The ﬁrst step in structural variation identiﬁcation
is to align the strobe reads to the reference genome. Each subread
Rl- is aligned independently and corresponds to an interval [yi,xl-]
on the reference genome. Suppose that ([y1,x1],...,[yn,xn]) is a
sequence of alignments for the subreads of an n-strobe S. We say

that an adjacent pair of subread alignments ([yi,xi],[yi+1,xi+1])
is concordant provided alignments are on the same strand and
in the same order on the reference1 and Lmin f |yi+1 —xl-| fLmax.
Otherwise, we say that the pair of subread alignments is discordant.
Similarly, we say that a strobe read alignment is concordant if all
pairs of adjacent subread alignments are concordant; otherwise, the
strobe read is discordant.

A discordant pair ([yi,xi],[yi+1,xi+1]) suggests a structural
variant in the test genome. For example, the breakpoints of a deletion
from a pair of alignments mapped to the positive strand of the
reference genome satisfy the equation

Lmin£(a_xi)+(yi+1—b)ELmax (1)

See Figure 1. Similar equations hold for inversions, translocations
and other variants (Bashir et a1., 2008).

A collection of discordant strobe reads indicate the same structural
variant, if they have discordant pairs that simultaneously satisfy the
equation above for a particular Choice of breakpoints a and b.

Now consider the case when subreads of a strobe read do not have
unique alignments to the reference genome because of repetitive
sequences in the reference genome and/or sequencing errors. In
this case, the selection of an alignment for a subread determines a
candidate structural variant. Our intuition is that breakpoints of true
structural variants will be contained in many strobe reads. Thus, we
aim to choose an alignment for each subread of every strobe read
so that the resulting set of structural variants is optimal according
to some objective function. This problem has been considered in
the paired read case by Lee et al. (2008) and Hormozdiari et al.
(2009). In particular, Hormozdiari et al. (2009) deﬁne the maximum
parsimony objective function of Choosing alignments to minimize
the number of predicted structural variants.

Below we consider the equivalent problem for strobe reads, show
a reduction to an optimization problem on directed graphs and derive
an ILP for the problem.

3 METHODS

3.1 Problem formulation

Consider an n-strobe S =(R1,A1,R2,A2,...,A,,_1,R,,) consisting of subreads
R, and advances A]: For a subread Ri. let M (R,) denote the set of locations
in the reference genome where R, aligns, with each element of M (R,) being
an interval [y,x] on the reference genome. An alignment for S is obtained
by selecting an alignment mi EM(R,*) for each subread Ri. Thus, let M(S)=
M(R1)>< M(Rz) ><  >< M(Rn) be the set of alignments for S.

For meM(S). let B(m) be the set of genomic breakpoints indicated by
m. If m is concordant. then B(m)=ﬂ. Note that these breakpoints are only
approximately deﬁned according to the uncertainty in the advance lengths
[e.g. according to Equation (1)]. We deﬁne the following problem.

n-STROBE MINIMUM BREAKPOINTS PROBLEM. Given alignment sets
M(Sl),...,M(SK) for n-strobes S1,...,SK, ﬁna1 a set of breakpoints B of
minimum cardinality such that for all k: l,...,K there is an mk eM(Sk)
with B(mk) E B.

This problem is NP-hard, as was shown for the paired read case (n22)
by a reduction to the Set Cover problem (Hormozdiari et a1., 2009). Below.
we reformulate this problem for general n as an ILP.

 

1The deﬁnition of concordant is different for paired read sequencing
technologies (e.g. Illumina) that produce reads on opposite DNA strands.

 

1 292

112 /3.Io's[Bumo[p.IOJxosoneuiJOJuioiq”:duq uron papeolumoq

9103 ‘{g anﬁnv uo ::

Strobe structural variation

 

3.2 Graph construction

We derive our ILP from a directed graph G=(V,E) that represents
breakpoints shared by multiple strobe reads. We begin with a graph whose
edges are alignments of a subread and vertices are advances between
subreads. Formally. consider an individual strobe read S. We represent the
set of all possible alignments for S with a directed graph G5 = (VS,ES). The
vertex set VszUygll (M(R,)><M(R,+1))U{ots,ﬁs} is the set of all possible
pairs of alignments of adjacent subreads. with an additional source vertex
as and sink vertex [35 corresponding to the start of the ﬁrst subread and
the end of the last subread. respectively. We refer to vertices that are not
sources or sinks as internal vertices. The edge set E5 = U,M(R,), where each
m: [y,x] EM(R,) corresponds to a directed edge (y,x). The alignments for
strobe read S are exactly the set of paths in G5 from as to [35.

In the graph construction, we use concordant pairs to reduce the number
of alignments that we consider for subreads. In particular, if there exists
a concordant pair for subreads R, and R,+1, then we ignore all discordant
pairs for these subreads R, with lower alignment score. For every concordant
pair of alignments m, EM(R,) and m,+1 EM(R,+1), we consider the vertex
v=(m,,m,+1), add edges from all incoming neighbors to v to all outward
neighbors from v and ﬁnally remove v from the graph.

Now we form a graph G=(V,E) by merging vertices in the graphs Gs
whose alignments are consistent with a single breakpoint (a,b) according
to (1). We compute the vertices to merge using GASV (Sindi et a1., 2009).
a program that efﬁciently computes whether paired reads indicate the same
structural variant using a computational geometry algorithm. In each merged
vertex, we store the identities of strobe and subread alignments from the
original vertices.

The n-Strobe Minimum Breakpoints Problem reduces to ﬁnding a
subgraph H of minimum cardinality (fewest number of vertices) such that
H contains a path from source 01;, to sink 13k for all k: l,...,K. Note that
H will always contain the source and sink vertices.

3.3 ILP formulation

The graph formulation suggests that ﬁnding the subgraph H might be solved
as a ﬁxed charge network ﬂow problem. In particular, the graph formulation is
suggestive of a ﬁxed charge multi-commodity network ﬂow problem (Crainic
et a1., 2001). with each strobe representing a distinct commodity. However.
our problem differs from this and related problems in that we need to maintain
separate accounting of each strobe entering and exiting a vertex rather than
merely accounting for the net ﬂow as in a multi-commodity ﬂow problem.

Nevertheless, we are able to formulate our problem as an ILP. motivated
by an ILP for the ﬁxed charge ﬂow problem (Hochbaum and Segev. 1989).
For each vertex v, e G, we deﬁne binary indicator variables p, such that p, = 1
if and only if v, is in the optimal solution. Similarly, we introduce variables
 which represent the ﬂow across edge (v,, v,) for strobe k. Lastly. we deﬁne
Ni]; and N I»): as the outward and inward neighbors, respectively. of vertex v,
and strobe k.

Our ILP for minimizing structural variants is then given by.

min Zn (2)
i
s. t.

p,E{0,l} Vi
05:11:12.» Walk (3)
059,7 517] Vivjvk

1 if izask

Egg—2a: —1 ifi=13sk (4)

jeNlﬂ jeN,.“_ 0 otherwise.

Recall that each vertex v, corresponds to a breakpoint. perhaps common
to multiple strobes. The objective (2). minimizes the number of vertices.
thus minimizing the number of breakpoints. In the optimal solution. each

 

Step 1: Cluster Discordant Pairs \
M(S1)E—l:l------El

M(Sz) E- --------- ---l:l—El
M(Sa) El-----E-l----El
M(S4) E+----Ei—i:|
M(S5) El-----El—l:l

 

Candidate
De'e‘im —

 

 

 

 

\/

Step 3: Simplify Graph
(3a) Node Removal
D2,D4,D5,D6,D7 Removed
(3b) Strobe Removal
S3 Removed
D3 Decremented
(30) Edge Removal
(D3356) Removed
K D3 Decremented

      
   
      
  
   

 

 

 

Derive ILP

Fig. 2. Construction of graph for 3-strobes S1,...,S5. In Step 1. the
discordant pairs (dotted lines) are clustered. producing seven candidate
deletions. In Step 2. a graph is created with a source vertex at and a sink
vertex [3 for each strobe and one vertex for each cluster (candidate deletion).
The number on each vertex indicates the number of strobes with a discordant
pair consistent with the deletion. In Step 3. the graph is simpliﬁed using
heuristics described in Section 3.4. Step 3 is repeated until the graph has
converged, upon which it is used as input to the ILP.

edge (1;- must have weight 0 or liit is either used once or not used at all
per strobe. However. this does not need to be enforced as an explicit binary
integer constraint. Instead. constraint (3) bounds (1;- between 0 and 1. Note
that the ﬂow for any edge (1,, can only be non-zero if the v, and v, are in the
optimal solution. Constraint (4) ensures that each strobe has a valid sequence
of subread alignments.

3.4 Graph simpliﬁcation

In order to improve performance, we developed several heuristics to simplify
the graph G before solving the ILP (Fig. 2).

(l) Vertex removal: remove vertices in G that are supported by fewer
than A strobe reads. We deﬁne the support of a vertex as the number
of strobe reads with paths through it. We require that a breakpoint
be supported by at least A strobe reads. Thus. we remove internal
vertices with support less than A. Note that we must count the number
of strobe reads that travel through the vertex, rather than the number

 

1 293

112 /3.Io's[Bumo[p.IOJxosoiwuiJOJuioiq”:duq wort papeolumoq

9103 ‘{g anBnV uo ::

A.Ritz et al.

 

of discordant pairs that cluster together. because the same strobe read
might have multiple discordant pairs that support the same breakpoint.
We also remove all incoming and outgoing edges of a removed vertex.

(2

V

Strobe removal: remove a strobe read S in G with no path from source
big to sink ﬁg. Following vertex removal. some strobe reads will no
longer have a path from source to sink. We remove each of these
strobe reads from the graph. We use a dynamic program to efﬁciently
check the path constraint for each strobe.

(3

V

Edge removal: remove edges corresponding to subread alignments for
strobe read S that are on a path from source big to sink ﬁg. Following
vertex removal. each strobe S will have at least one path from source
to sink. but may have extraneous alignments that do not lie on any
path from source to sink. We remove such edges from the graph, since
they cannot appear in the ILP solution due to the ﬂow constraint. The
dynamic program for strobe removal is also used for this step.

We iteratively perform these three operations on G until no more vertices.
strobe reads or edges are removed.

3.5 Benchmarking

Here. we present the computations used to assess sensitivity and speciﬁcity
in detecting a set of known deletions. Consider a set of deletions deﬁned
by intervals P={[a1,bl],...,[a1p1,b1p1]} known to be present in the test
genome. Given a set B: {[cl ,dl],..., [c131,d131]} of intervals corresponding
to a prediction returned by the ILP. we compute two different Receiver
Operating Characteristic (ROC)-like plots.

(1) Variant-based ‘ROC'. We count the number of deletions [a,,b,] EP
that have a non-empty intersection with some interval [cj,dj] e B and

(dj _Cj)5(bi—ai)+Lm-axv

i.e. the prediction length must be smaller than the deletion length plus
the largest allowed length of an advance. Let the number of such
variants be V. The true positive rate is %. and the number of false
positives |B| — V. Note that this is not a true ROC curve because we
do not compute a false positive rate. but rather report the number of

false positives (hence the quotes).
(2

V

Pair-based ROC. We count the number of discordant pairs that support
variants. Let D(P) be the set of discordant pairs that support variants in
P, and let D(P) be the remaining discordant pairs. Similarly. let D(B)

be the discordant pairs that support variants in B. The true positive
lD<B>nD<P>l WELDTPM
lD<P)l lD(P)l

 

rate is then and the false positive rate is

4 RESULTS

We applied our algorithm to simulated strobe sequencing data from
Paciﬁc Biosciences. The Paciﬁc Biosciences simulator models the
errors in their single-molecule sequencing technology. Speciﬁcally,
the simulator models the higher rate of insertions and deletions
(using a roughly equivalent ratio of each) relative to miscall errors
in subreads that is typically seen in their data (Eid et al., 2009).
We analyze two datasets: structural variants identiﬁed in the Venter
whole-genome assembly (Levy et al., 2007) and a synthetic complex
rearrangement in highly repetitive regions. For each dataset, we
generated 3-strobe reads of length 3 kb, consisting of three subreads
of 200bp separated by l200bp advances. We then introduced
error into the subreads in each strobe using Paciﬁc Biosciences’s
error simulator. Since the capabilities of the Paciﬁc Biosciences
commercial machine (expected later in 2010) are not yet known,
we conservatively assume a sequencing error rate of 5%.

4.1 Comparison to paired reads

For each dataset, we compare the results with strobe reads to
those obtained via paired reads. To remove differences due to read
alignment, we construct paired reads using subsets of the subreads
in each strobe. We consider two sets of paired reads:

(1) Paired Read Library (1.6kb fragment length): for each
n-strobe S=(R1,A1,R2,A2,...,R,,_1,A,,_1,Rn), we deﬁne
the set of pairs £(S): {(R,,R,+1)}.

(2) Mixed Paired Read Library (1.6 and 3 kb fragment lengths):
we deﬁne the set of pairs A(S)= {(R,,Rj) :j > i}.

The Paired Read Library dataset corresponds to a paired read
dataset generated by a single size selection, while the Mixed Paired
Read Library dataset corresponds to multiple fragment sizes. Note
that for Illumina and ABI SOLiD machines, the latter requires
preparation of multiple sequencing libraries.

Given a set of strobe reads with physical coverage c, the Paired
Read Library will have approximately the same physical coverage
as strobe reads with twice as many reads. The Mixed Paired Read
Library will have physical coverage 2c with three times as many
reads. We subsample the reads in the Mixed Paired Read Library to
achieve physical coverage c.

4.2 Variant detection on Venter Chromosome 17

We simulated a test chromosome based on known rearrangements
from Chromosome 17 of the Venter genome (Levy et al., 2007),
following the procedure presented in Chen et al. (2009). Given a
list of 17 376 insertions, deletions and inversions on Chromosome
17, we concatenated intervals from the hgl8 human reference
corresponding to the rearrangements. We then simulated 3 kb strobe
reads at 10X, 20X and 30x coverage, producing 262 355, 524709
and 787 064 strobe reads, respectively. After aligning the subreads
to Chromosome 17 of hgl8 using Paciﬁc Biosciences’s in-house
aligner, BLASR, we generated a Paired Read library and a Mixed
Paired Read library as described in Section4.l. BLASR is designed
to quickly align large reads and is tolerant to a wide range of
sequencing errors (M.Chaisson, personal communication).

4.2.1 Deletions We considered the 124 deletions greater than
120 bp in Venter and computed the variant-based ROC curve by
varying A, the minimum support of a vertex (Fig. 3). In terms
of ‘Area under the ROC Curve’ (AROC) values, strobe reads
outperform paired reads for all three coverages. Moreover, strobe
reads outperform Mixed Paired Reads for 10>< and 30x coverages,
where the advantage in AROC for the Mixed Paired Read library is a
result of slightly better speciﬁcity at extremely low (< 20%) values
of sensitivity. On average, at ﬁxed values of sensitivity, strobe reads
make 57.18% :l:4.282 fewer false positive predictions than paired
reads. At 20>< coverage and a maximum sensitivity of 87.10% for
strobe reads, 90.32% for the Paired Read library and 92.74% for the
Mixed Paired Read library, strobe reads make 45.13% fewer false
positive predictions than the Paired Read library, and 61.53% fewer
false positive predictions than the Mixed Paired Read library.

It is possible that some of the predictions in the ILP solutions
are accurate, but we fail to identify them as a true positives
because the breakpoint coordinates might be shifted due to nearby
structural variants. Of the considered deletions, 39 have another
event (at least 50bp in size) within the corresponding advance.

 

1 294

112 /3.Io's172an0prOJxosoiwuiJOJuioiq”:duq urorj pepeo1umoq

9103 ‘1g15n8nv uo ::

Strobe structural variation

 

0,9 Variant-based "ROC": 10x Coverage

  

 

 

Variant—based "ROC": 20x Coverage , Variant—based "ROC": 30x Coverage

 

 

   

  

 

 

 

 

 

     

 

 

 

 

 

  

 

 

 

   

 

 

 

     

  

 

 

 

 

E 0.7 a: m
g 5 g 0.8
> 0.6 cu ‘1;
1% :E 5‘3 W
E 0.5 3 é
a . . . n- . . .
E 0.4 + $31.1)?“ Read “may 3 + Mixed Paired Read Library 5 0'5 . Mixed Paired Read Library
1— P I d  P "AROC"=O.7859 l— "AROC":0.7587
0‘3 + .. awe .. ea I ran, Paired Read Library 0'5 Paired Read Library
SARgc =0-7133 + "ARoc"=o,5725 .—"AROC"=0.6681
01 tro es Strobes °-4 Strobes
01 . AROC =0.7747 + "AROC-=0.7774 HAROC"=0.7745
' so 100 150 . t 100 250 50 100 150 200 0 50 100 150 200 250 300 350
# of of False Posmves # of of False positives # of of False Positives
Pair—based ROC: 10x Coverage Pair—based ROC: 20x Coverage Pair—based ROC: 30x Coverage
1 1 1
0.9 0 9 0.95
3 0.8 3 0'8 .9 0'9
6:“ § 0'7 §
0.85
E 0'7 g 0.6 g
.5 .5 IE 05
g 0.5 a 0.5 3
g 0.5 . Strobes g 0.4 . Strobes E 0'75 . Strobes
l— "AROC"=0.8200 I: 03 "AROC"=0.7950 l: 0.7 "AROC"=0.7290
0.4 . Paired Read Library ' Paired Read Library Paired Read Library
"AROC"=0.7179 0.2 . "AROC"=0.6593 0-65 . "AROC"=0.5252
0.3 Mixed Paired Read Library M‘ d Paired Read Libra ‘ ‘ '
. u u 0.1 . ixe W 0.6 . Mixed Paired Read Library
02 AROC =0.7089 "AROC"=0.6566 "AROC"=0.5408
' 0.02 0.04 0.06 0.08 0.1 0.12 0o 0.02 0.04 ' 0.05 0'08 0.1 ' 0.12 ' 0'55 9 9,02 0,04 0,05 0,03 0,1 0,12

False Positive Rate

False Positive Rate

False Positive Rate

Fig. 3. ROC curves for the Venter simulation. The top row is a variant-based ‘ROC’ curve for 124 deletions 3120 bp. which computes the number of real
deletions out of 124 that appear in the solution. The bottom row is a pair-based ROC curve for the same 124 deletions. which counts the number of discordant
pairs that support the real deletions (see Section 3.5). The reported ‘AROC’ is the area under the curves normalized by the maximum x-Value in each plot.
For 10>< coverage. A ranges from 2 to 10 in steps of 2. For 20>< and 30>< coverage A ranges from 4 to 20 in steps of 2.

Thus, we considered the pairs that span the 124 deletions in each
dataset and computed the ‘pair-based’ ROC curve (Fig. 3). Strobe
reads outperform paired reads and mixed paired reads for all three
coverages (AROC). Strobe reads decrease the false positive rate
by an average of 50.83%:l:4.83 compared with the Paired Read
datasets and 56.07% :l: 8.11 compared with the Mixed Paired Read
libraries at ﬁxed sensitivity.

The size and topology of the graph G used as input to the ILP
varies between the Strobe, Paired Read and Mixed Paired Read
libraries, affecting the runtime of the ILP. In particular, the Strobe
datasets construct graphs with fewer edges and vertices than the
Paired Read and Mixed Paired Read libraries. For example, with
support A=8 there are ~65% fewer edges and internal vertices
for 10>< coverage; ~80% fewer edges and internal vertices for
20>< coverage; and ~83% fewer edges and internal vertices for
30>< coverage (Table 1). Note that this does not necessarily indicate
that the Strobe dataset generates fewer clusters that are used to
construct the graph; Strobe and Paired Read datasets predict the
same number of clusters at each coverage (which is expected
due to the Paired Read library construction in Section 4.1); and
the Mixed Paired Read library uses a smaller set of clusters to
construct the graph G. In addition to the size of the input graph
G, the graph topology is different between the Strobe datasets and
the Paired Read libraries. In general, graphs with many connected
components are easily parallelizable, as each connected component
could be run independently of the others. While all graphs contain
many connected components, the graphs of Paired Read and Mixed
Paired Read libraries contain connected components with many

more internal vertices than graphs with Strobe data. For example,
at 10>< coverage with A :4, the largest connected component for
the Paired Read library contained 350 internal vertices while the
largest connected component for the Strobe dataset contained only
six internal vertices. One such connected component from the Strobe
dataset with 10>< coverage is shown in Figure 4.

4.2.2 Inversions Only four inversions appear on Venter
Chromosome 17 with lengths detectable by the simulated
sequencing data. Our method detects the two longest inversions
of these four for the Strobe and Paired Read libraries, while the
Strobe dataset predicts 22% fewer false positives (Table 2). Here,
the true positive rate computation described in Section 3.5 does not
apply; instead we counted an inversion if the mutual intersection
between the inversion interval and the prediction interval was
>50%, following Chen et al. (2009).

4.2.3 Comparison with short read sequencing To illustrate
the advantages of the longer fragments and subreads of strobe
sequencing, we compared strobe reads to simulated paired read
data that approximates the fragments sizes and read lengths that
are routinely obtained with short read, short insert sequencing
technologies (Fig. 5). Using the same Venter Chromosome 17,
we simulated 200 bp fragments with 50bp reads using the wgsim
program from SAMtools (Li et al., 2009) at 20>< coverage. The
simulated fragments have a base error rate of 0.02, a mutation rate
of 0.001, 10% indels and 30% probability that an indel is extended.
We aligned the reads using Burrows-Wheeleer Alignment (BWA)

 

1 295

112 /3.Io's1eu1noprOJxosoneuiJOJuioiq”:duq urorj papeo1umoq

9103 ‘1g15n8nv uo ::

A.Ritz et al.

 

Table 1. Clustering, graph construction, and ILP solution statistics for the Venter Chromosome 17 with A :8

 

 

 

Pairs Clustering statistics Graph statistics ILP sol. statistics
No. of No. of No. of No. of strobe reads or pairs No. of No. of No. of No. of
Discordant Deletions clusters — internal edges vertices in correct
2 8 Removed Retained vertices solution
10>< Strobe 50 554 12 762 145 362 410 50 978 45 27
10>< Paired Read 50 543 12 762 145 321 518 143 2638 66 26
10>< Mixed Paired Read 35 881 5984 83 330 542 83 1650 59 31
20>< Strobe 101367 25 701 807 389 1585 159 4182 131 89
20>< Paired Read 101352 25 698 807 265 1974 785 19 270 198 94
20>< Mixed Paired Read 70 022 11 896 372 288 1976 365 8658 179 100
30>< Strobe 151053 38711 1492 545 2540 229 7784 171 100
30>< Paired Read 151034 38 705 1492 345 3240 1465 42 322 283 104
30>< Mixed Paired Read 107 577 19451 810 430 3028 802 21650 228 105

 

The clustering statistics include the number of discordant pairs after removing concordant alignments, the number of these discordant pairs
that are deletions (their lengths are greater than Lmax and they have proper orientation) and the number of clusters. The graph statistics
include the number of strobe reads or paired ends that are removed from the graph, the number that are retained, the number of internal
vertices and the number of edges in the graph. The solution statistics report the number of internal vertices in the ﬁnal ILP solution and the
number of these vertices that are in the list of 124 deletions 3120bp.

(Li and Durbin, 2009). We then ran GASV (Sindi et al., 2009) on
the discordant pairs that map uniquely to the reference.

Since VariationHunter (Hormozdiari et al., 2009) utilizes reads
with non-unique alignments, we considered discordant pairs that
have multiple alignments to the reference. We considered reads
with low mapping quality (310) for BWA and aligned them with
Novoalign, an aligner that has higher sensitivity than BWA at the
cost of a longer running time (Krawitz et al., 2010). We considered
up to 100 alignments for reads aligned with Novoalign. At maximum
speciﬁcity for strobe reads, where the true positive rate is 0.87,
VariationHunter achieves a true positive rate of 0.35 and GASV
achieves a true positive rate of 0.34 at approximately the same
sensitivity (between 85 and 95 false positives).

We emphasize that this comparison is limited by its use of
simulated data, and by our use of VariationHunter and GASV
without further post-processing. For example, the VariationHunter
publication (Hormozdiari et al., 2009) describes several additional
steps used to achieve better performance. Additionally, uncontrolled
simulation parameters such as the fragment length and the
subread length affect the comparison, and explicitly comparing the
performance of different types of sequencing platforms is beyond
the scope of this article.

4.3 Variant detection in repetitive regions

Repetitive regions in the genome are notoriously difﬁcult for
structural variant detection. To test the ability of strobe reads to
capture breakpoints near repetitive regions, we constructed a 11.6 kb
sequence with two translocations by concatenating three different
transposons from hg18: a 6kb L1-family LINE (chr2:181406133-
181413161), a 503 bp Alu (chr7:66854543-66856104) and a 3kb
L2-family LINE (chr15:87930634-87933678), each ﬂanked by
500bp. From this sequence, we generated 10 simulations with
10>< coverage using the same sized 3kb strobe reads as above
and introduced 5% error. After aligning the subreads to hg18,

    
 
  
  
  

  

mm mssa sink

sum mm rlnk
\ nub: ssszs sink

Fig. 4. A connected component from the solution of the 10>< coverage strobe
dataset with A :4. Edges in the ﬁnal solution are in black. Six strobe reads
support the ﬁrst variant in the solution. four strobe reads support the second
variant in the solution and two strobe reads span both variants.

um um um

«572.0 6 Pairs. chm zusws and dim 2mm:
strobe 59525 salute

    

mm mm mm: P 1‘

I

i:/ ’
m.

strobe 111953 mm:

«5723 s palls' urn 23065350 and aim zsmaos

Table 2. Predicted Inversions for Venter Chromosome 17

 

 

Left Breakpoint Mixed

Coordinate Length (bp) Strobe Paired Read Paired Read
5 826 739 552

40 566 233 115 1 J J

55 552 838 3557 J J J

57 999 778 472

Total no. of predicted inversions 23 96 52

 

Inversions that appear in the solution for the Strobe, Paired Read, and Mixed paired read
libraries with 20>< coverage and A = 10. The Strobe and Paired Read libraries detect
two of the four inversions, while the Mixed Paired Read library detects only the longest
inversion.

we generated the paired read datasets as above and ran our
method.

The Strobe datasets and Paired Read libraries report similar true
positive rates on average, while the Strobe dataset reports fewer
false positives (Fig. 6). Many subreads in the simulations align to

 

1 296

112 /3.Io's1eu1noprOJxosoneuiJOJuioiq”:duq urorj papeo1umoq

9103 ‘1gisn8nv uo ::

Strobe structural variation

 

Variant-based "ROC" for Strobe Reads and
Short Read, Short Insert Paired Reads

 

+ Strobe 20x
M + GASV Short Read 20x (unique mappings)
+ VariationHunter Short Read 20x (unique &

 

True Positive Rate

. i i i i i i i i i
O 100 200 300 400 500 600 700 800 900 1000
# of False Positives

Fig. 5. Comparison of strobe reads to simulated short read. short insert paired
reads for 124 deletions 3120 basepairs. A ranges from 4 to 20 in steps of 2
for all curves.

Variant-based "ROC"

Input Graph Statistics

.0
to

.09

was
8
o

 

S
c

 

True Positive Rate
0
'm

+ Paired Read Libragy
+ Mixed Paired Rea Library
+ Strobes

it Internal Vertices

.0

u-
N
o
o

 

 

 

 

 

 

p
b
o A
a

2 3 _4. 5 3 4 5 6 7 8
it False Posmves Minimum Support Threshold A

 

 

Avg # Input Avg # Final Avg # Correct
Dataset Vertices* Predictions Predictions
Strobe 16 :l: 25.88 2.1 :l: 0.58 1.9 :l: 0.32
Paired Read 85 :l: 106.12 3.1 :l: 1.37 1.9 :l: 0.32
Mixed RR 133 :l: 183.20 2.9 :l: 1.60 1.7 :l: 0.48

 

 

 

 

* # of internal vertices in the input to the ILP.

Fig. 6. Statistics for 10 10>< coverage simulations of a highly repetitive
region. (Top left) ROC curve of average number of false positives and
average true positive rate. varying A from 3 to 8. (Top Right) Distribution
of the number of internal vertices in the generated graph.

hundreds of different regions on the genome, causing the Paired
Read libraries to contain many internal vertices in the input graph
for the ILP. However, the number of vertices in the graph is
greatly reduced using strobe reads, indicating that many pairs in
these repetitive regions are eliminated by incorporating concordant
information (Fig. 6).

5 DISCUSSION

Structural variants vary widely in size and complexity, and thus
are generally more difﬁcult to characterize than SNPs. Sensitive
and speciﬁc detection of structural variation in human genomes
from next-generation sequencing data remains a challenge. This
is due to both technological limitations (in read length, error
rates and insert sizes) and biological factors. Structural variants
in human are: (i) enriched for repetitive sequences near their
breakpoints (Kidd et al., 2008); (ii) may overlap or have complex
architectures; and (iii) recurrent (but not identical) variants may
exist at the same locus (Perry et al., 2008; Scherer et al.,
2007). We have shown that strobe reads have advantages in
sensitivity and speciﬁcity over paired reads for structural variant

detection. Since a single strobe can resolve multiple breakpoints,
inference of duplications and rearrangements become more direct.
The method handles both intra-chromosomal (Section 4.2) and inter-
chromosomal (Section 4.3) events, making it suitable for genome-
wide analyses. While we have examined deletions, inversions and
translocations in simulated strobe read data, explicitly testing the
detection power of insertions using strobe reads remains future work.
An interesting question is whether strobe reads will detect more
complex variants that are beyond the abilities of current sequencing
technologies.

We showed a preliminary comparison of simulated strobe
sequencing versus simulated short read, short insert sequencing.
Although this comparison demonstrates an advantage for strobes,
a more rigorous assessment with real sequencing data is required to
obtain a deﬁnite comparison of these technologies.

An inherent limitation in any approach is the accuracy of
the underlying alignments. Most second generation sequencing
technologies produce short reads with increasing error rates near
the end of the reads and few insertions. The Paciﬁc Biosciences
technology differs in that it has predominantly long reads, uniform
error over the entire read and an insertion/deletion heavy error model
(Eid et al., 2009). For these reasons, different alignment approaches
have been suggested that use k-mer seeding followed by alignment
extension (Li and Durbin, 2010). In our study, mappings were ranked
using a naive Smith—Waterman score, assuming uniform quality of
all sequenced bases. As mapping and scoring for single-molecule
sequencing technologies mature, the proposed ILP can be changed to
use more sophisticated scoring functions, increasing sensitivity (by
ensuring true alignments are included) and speciﬁcity (by reducing
spurious alignments).

Current and new technologies are continually increasing the read
length (or subread length in the case of strobe reads). Longer
subreads imply a higher frequency of split reads (subreads which
span a breakpoint). Such events can be readily incorporated into
the ILP by converting subreads with non-overlapping mappings
(relative to the subread) into psuedo-strobe reads, leading to paths
of variable length from source to sink for a given strobe read. The
advance in this case becomes the distance between the end of the
ﬁrst alignment and the start of second alignment on the subread. This
allows the method to be used as a generic framework for evaluating
genome-wide structural variation given any form of sequencing
data.

The suggested model is designed to handle germ-line mutations.
In scenarios with heterogeneous data or when somatic mutations are
abundant, such as in cancer, the assumptions in our model could
be limiting. For example, the notion of minimizing breakpoints
and clustering breakpoint junctions may be incorrect. In areas
of elevated chromosome instability, each individual cancer cell
may undergo different mutations leading to slightly (or greatly)
different breakpoint boundaries. Additionally, breakpoint clustering
is signiﬁcantly more challenging as some genomic aberrations may
only be present in a small fraction of cells. Integrating copy number
information on a per breakpoint basis could provide added power in
detecting these lower frequency events.

6 CONCLUSIONS

We introduce a combinatorial algorithm for structural variant
identiﬁcation from strobe read sequencing data. We show that strobe

 

1 297

112 /3.Io's1eu1noprOJxosoneuiJOJuioiq”:duq urorj papeo1umoq

9103 ‘1g15n8nv uo ::

A.Ritz et al.

 

reads outperform paired reads on simulated sequencing data. In
particular, strobe reads have nearly doubled the speciﬁcity at ﬁxed
sensitivity for structural variation prediction. In the near future, we
will test our algorithm on real sequencing data.

ACKNOWLEDGEMENTS

We thank Mark Chaisson for providing the alignment software for
strobe reads. We thank Luke Peng for his assistance in generating
simulated data.

Funding: National Science Foundation Graduate Research
Fellowship (to A.R.); Career Award at the Scientiﬁc Interface from
the Burroughs Wellcome Fund (to B.J.R.).

Conﬂict of Interest: Ali Bashir is an employee at Paciﬁc Biosciences.

REFERENCES

Albertson,D. et al. (2003) Chromosome aberrations in solid tumors. Nat. Genet, 34,
3697376.

Bashir,A. et al. (2008) Evaluation of paired-end sequencing strategies for detection of
genome rearrangements in cancer. PLoS Comput Biol, 4, e1000051.

Bentley,D. et al. (2008) Accurate whole human genome sequencing using reversible
terminator chemistry. Nature, 456, 53759.

Chen,K. et al. (2009) BreakDancer: an algorithm for high-resolution mapping of
genomic structural variation. Nat. Methods, 6, 6777681.

Crainic,T. et al. (2001) Bundle-based relaxation methods for multicommodity
capacitated ﬁxed charge network design. Discrete Appl Mat/1., 112, 73799.

Dopman,E. and Hartl,D. (2007) A portrait of copy-number polymorphism in Drosophila
melanogaster. Proc. Natl Acad. Sci. USA, 104, 1992&19925.

Egan,C. et al. (2007) Recurrent DNA copy number variation in the laboratory mouse.
Nat Genet, 39, 138431389.

Eid,J. et al. (2009) Real-time DNA sequencing from single polymerase molecules.
Science, 323, 1337138.

Faddah,D. et al. (2009) Systematic identiﬁcation of balanced transposition
polymorphisms in Saccharomyces cerevisiae. PLoS Genet, 5, e1000502.

Girirajan,S. et al. (2010) A recurrent 16p12.1 microdeletion supports a two-hit model
for severe developmental delay. Nat. Genet, 42, 2037209.

Greenway,S. et al. (2009) De novo copy number variants identify new genes and loci
in isolated sporadic tetralogy of Fallot. Nat Genet, 41, 9317935.

Hochbaum,D. and Segev,A. (1989) Analysis of a ﬂow problem with ﬁxed charges.
Networks, 19, 2917312.

Hormozdiari,F. et al. (2009) Combinatorial algorithms for structural variation detection
in high-throughput sequenced genomes. Genome Res, 19, 127071278.

Iafrate,A. et al. (2004) Detection of large-scale variation in the human genome.
Nat Genet, 36, 9497951.

Kidd,J. et al. (2008) Mapping and sequencing of structural variation from eight human
genomes. Nature, 453, 5364.

Korbel,J. et al. (2007) Paired-end mapping reveals extensive structural variation in the
human genome. Science, 318, 420426.

Korbel,J. et al. (2009) PEMer: a computational framework with simulation-based
error models for inferring genomic structural variants from massive paired-end
sequencing data. Genome Biol, 10, R23.

Krawitz,P. et al. (2010) Microindel detection in short-read sequence data.
Bioinformatics, 26, 7227729.

Lee,S. et al. (2008) A robust framework for detecting structural variations in a genome.
Bioinformatics, 24, 59$7.

Levy,S. et al. (2007) The diploid genome sequence of an individual human. PLoS Biol,
5, e254.

Li,l-I. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows-
Wheeler transform. Bioinformatics, 25, 175431760.

Li,l-I. and Durbin,R. (2010) Fast and accurate long-read alignment with Burrows-
Wheeler transform. Bioinformatics, 26, 589.

Li,l-I. et al. (2009) The Sequence Alignment/Map format and SAMtools. Bioinformatics,
25, 207872079.

Marshall,C. et al. (2008) Structural variation of Chromosomes in autism spectrum
disorder. Am. J. Hum. Genet, 82, 477488.

Mitelman,F. et al. (2004) Fusion genes and rearranged genes as a linear function of
chromosome aberrations in cancer. Nat. Genet, 36, 3317334.

Perry,G et al. (2008) The ﬁne-scale and complex architecture of human copy-number
variation. Am. J. Hum. Genet, 82, 685$95.

Quinlan,A.R. et al. (2010) Genome-wide mapping and assembly of structural variant
breakpoints in the mouse genome. Genome Res. [Epub ahead of print].

Raphael,B. et al. (2003) Reconstructing tumor genome architectures. Bioinformatics,
19 (Suppl. 2), i1627i171.

Redon,R. et al. (2006) Global variation in copy number in the human genome. Nature,
444, 444—454.

Scherer,S. et al. (2007) Challenges and standards in integrating surveys of structural
variation. Nat Genet, 39, 7715.

Sharp,A.J. et al. (2006) Structural variation of the human genome. Annu. Rev. Genomics
Hum. Genet, 7, 407442.

Sindi,S. et al. (2009) A geometric approach for classiﬁcation and comparison of
structural variants. Bioinformatics, 25, i2227i230.

Turner,S. (2009) Personal Genomes (conference talk). Cold Spring Harbor, NY.

Tuzun,E. et al. (2005) Fine-scale structural variation of the human genome. Nat. Genet,
37, 7277732.

Volik,S. et al. (2003) End-sequence proﬁling: sequence-based analysis of aberrant
genomes. Proc. NatlAcad. Sci. USA, 100, 769677701.

 

1 298

112 /3.Io's1eu1noprOJxosoneuiJOJuioiq”:duq urotj papeo1umoq

9103 ‘1g15n8nv uo ::

