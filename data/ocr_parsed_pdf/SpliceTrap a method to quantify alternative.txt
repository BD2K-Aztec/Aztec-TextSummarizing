ORIGINAL PAPER

Vol. 27 no. 21 2011, pages 3010-3016
doi:10. 1 093/bioinformatics/btr508

 

Gene expression

Advance Access publication September 6, 2011

SpliceTrap: a method to quantify alternative splicing under single

cellular conditions

Jie WU1’2’T, Martin Akermanl’l, Shuying Sunl, W. Richard McCombiel,

Adrian R. Krainer1 and Michael O. Zhang3a4a*

1Cold Spring Harbor Laboratory, 1 Bungtown Rd., Cold Spring Harbor, NY 11724, 2Department of Applied
Mathematics and Statistics, Stony Brook University, Stony Brook, NY 11794, 3Department of Molecular and Cell
Biology, Center for Systems Biology, The University of Texas at Dallas, Richardson, TX 75080, USA and
4Bioinformatics Div., Center for Synthetic and Systems Biology, TNLIST, Tsinghua University, Beijing 100084, China

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Alternative splicing (AS) is a pre-mRNA maturation
process leading to the expression of multiple mRNA variants from
the same primary transcript. More than 90% of human genes are
expressed via AS. Therefore, quantifying the inclusion level of every
exon is crucial for generating accurate transcriptomic maps and
studying the regulation of AS.

Results: Here we introduce SpliceTrap, a method to quantify
exon inclusion levels using paired-end RNA-seq data. Unlike other
tools, which focus on full-length transcript isoforms, SpliceTrap
approaches the expression-level estimation of each exon as an
independent Bayesian inference problem. In addition, SpliceTrap can
identify major classes of alternative splicing events under a single
cellular condition, without requiring a background set of reads to
estimate relative splicing changes. We tested SpliceTrap both by
simulation and real data analysis, and compared it to state-of-the-art
tools for transcript quantification. SpliceTrap demonstrated improved
accuracy, robustness and reliability in quantifying exon-inclusion
ratios.

Conclusions: SpliceTrap is a useful tool to study alternative splicing
regulation, especially for accurate quantification of local exon-
inclusion ratios from RNA-seq data.

Availability and Implementation: SpliceTrap can be implemented
online through the CSH Galaxy server http://cancan.csh|.edu/
splicetrap and is also available for download and installation at http://
rulai.cshl.edu/splicetrap/.

Contact: michael.zhang@utdallas.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on November 14, 2010; revised on August 18, 2011;
accepted on August 19, 2011

1 INTRODUCTION

In higher eukaryotes, a given transcribed locus can generate several
mature mRNA isoforms via the process of alternative splicing
(AS). AS is frequently a regulated mechanism, which coordinates

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion. the ﬁrst two authors
should be regarded as joint First Authors.

the removal of the internal non-coding portions of the transcripts
(introns) with the differential joining of the coding and 5’/3’
untranslated portions (exons). As a result, proteins with similar,
different or antagonistic activities can be generated from a single
genomic locus (Brett et (11., 2002; Maniatis and Tasic, 2002). In
addition, AS can lead to downregulation of gene expression by
diverting some of the mRNA isoforms to the nonsense-mediated
mRNA decay pathway (Lewis et (11., 2003).

More than 90% of human genes express primary transcripts that
undergo AS (Fan et (11., 2008; Wang et (11., 2008). Owing to the
regulatory power of this process, an increasing number of studies
are being directed at understanding AS regulation at the single-exon
level (Castle et (11., 2008; Johnson et (11., 2003; Lewis et (11., 2003;
Wang et (11., 2008). In general, researchers in the splicing regulation
ﬁeld have utilized comparative approaches to reveal tissue-speciﬁc
(Relogio et (11., 2005; Ule et (11., 2005) or disease-related (Baumer
et (11., 2009) AS events. However, such methodologies have not been
used to generate maps of AS activity within one cellular condition.
The completion of such maps would add a higher level of resolution
to transcriptome analysis, allowing precise quantiﬁcation of exon
inclusion levels within a population of related isoforms.

Until recently, systematic analysis of AS was done using
expressed sequence tags (EST) (Gupta et (11., 2004; Sorek et (11.,
2004; Xie et (11., 2002) or specialized microarrays (Castle et (11.,
2008; Clark et (11., 2002; Johnson et (11., 2003; Fan et (11., 2008).
These techniques facilitated the discovery of a large number of
alternative transcripts, and the extraction of distinctive features of
alternatively spliced exons. Nevertheless, these techniques suffer
from several limitations. ESTs are subject to cloning biases—
especially towards the 3’-end of transcripts—low coverage and
insufﬁcient robustness to allow reliable quantiﬁcation. Likewise,
the speciﬁcity of splicing microarrays is negatively affected by
cross-hybridization with related mRNA molecules.

The development of deep-sequencing technologies provided
an alternative to ESTs and microarrays for transcriptomic
quantiﬁcation. Two recent studies utilized single-end RNA-seq to
analyze a series of human tissues. In Fan et (11. (2008), the inclusion
level of alternative exons was quantiﬁed as the percentage of the
number of reads that match the two splice junctions formed by exon
inclusion, over the splice junction formed by exon skipping. Wang
et (11. (2008) also utilized splice-junction reads for quantiﬁcation of
minor isoforms with different frequencies, as a function of the read

 

3010 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[BrunoIpJOJXO'sorwurJOJurorq”:duq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

SpliceTrap

 

coverage or RPKM (reads per kilobase of exon per million mapped
reads. Although both studies demonstrated improved coverage
relative to microarrays and ESTs, they utilized only isoform-speciﬁc
reads, leaving out the majority of reads, which map to common exons
of different isoforms.

An improved version of the deep-sequencing technique utilizes
paired-end tags (Fullwood et (11., 2009), which allows a signiﬁcant
gain of coverage and a reduction in read ambiguity through the
generation of linked tag pairs that span longer stretches of sequenced
template. This technology is especially suitable for AS proﬁling,
because Inany exonqnapped tags are expemed to span spﬁce
junctions, and these can be exploited to improve AS quantiﬁcation.

Two recent methods exploit paired-end sequencing information
for transcript quantiﬁcation: Cufﬂinks (Trapnell et (11., 2009), which
is based on a previous RNA-seq model for single-end reads
(Jiang and Wong, 2009) and Scripture (Guttman et (11., 2010).
Both can reconstruct transcript structures using directed graphs,
and assign FPKM (fragment per kilobase of exon per million
mapped reads) or RPKM values to every transcript, without relying
on a reference genome. Cufﬂinks uses a mathematical model to
identify alternatively spliced transcripts at each gene locus. Scripture
employs a statistical segmentation model to distinguish expressed
loci, and ﬁlters out experimental noise. Both methods were originally
designed to identify and quantify full-transcript expression levels,
but in our tests they appear not to be optimal for inferring local exon-
inclusion ratios, presumably due to limited transcript coverage and
sequencing noise.

Here we introduce SpliceTrap, a method to quantify local exon
inclusion levels in paired-end RNA-seq data. SpliceTrap generates
alternative splicing proﬁles for different splicing patterns, such as
exon skipping, alternative 5’ or 3’ splice sites, and intron retention.
It utilizes a comprehensive human exon database called Tde
(see Section 2) to estimate the expression level of every exon as
an independent Bayesian inference problem. Unlike microarray-
based methods, SpliceTrap relies on RNA-seq, and therefore it can
determine the inclusion level of every exon within a single cellular
condition, without requiring a background set of reads.

We tested SpliceTrap both by simulation and real data analysis.
Compared to Cufﬂinks and Scripture, it demonstrated improved
accuracy, robustness and reliability in quantifying a large fraction
of AS activity. In particular, SpliceTrap is suitable for studying
changes at the single-exon levels and it can facilitate the discovery of
nearby cis-regulatory elements in diverse applications. SpliceTrap
can be implemented online through the CSH Galaxy (Goecks et (11.,
2010) server http://cancan.cshl.edu/splicetrap and is also available
for download and installation at http://rulai.cshl.edu/splicetrap/.

2 METHODS

2.1 Database construction

To quantify exon-inclusion levels, we designed an exon-trio database called
Tde. First, we captured all known transcripts encoded by every human
gene (Fig. 1A and B), using annotations from RefSeq (Pruitt et (11., 2007)
(downloaded from the UCSC genome browser, hng) and the EST-based AS
database dbCASE (Zhang et (11., 2007). Second, to account for every possible
exon-skipping event, we subdivided each transcript set (i.e. encoded by the
same gene) into exon trios, by sliding a 3-exon window along the transcript
(Fig. 1C). In particular cases in which an exon was ﬂanked by more than one
assembly of ﬂanking exons, every possible combination was represented in

 

 

A |
B I.- '- E I. K- g {-
ﬂ :3 ﬂ ii a u
C -  _ G —
— .m- — i f
i .l 3::
— -
— - E- —'  'L Duh El
— — g F: E: F
——i——_' 4" II"
_  H I- - I
- ‘- —
D .
f- :_ ___§‘.‘_____:I
E} E"

 

Fig. 1. Tde assembly. (A) From a given gene expression locus (blue
strip) (B) we extracted all the known transcript isoforms using available
transcriptome annotations. (C) Using a 3-exon sliding window, we
subdivided the transcript isoform population into exon trios, accounting
for all known transcriptomic variability. Every exon trio is then used as an
independent mappable unit, wherein the middle exon (red block) is queried
for alternative splicing activity and the ﬂanking exons (blue blocks) are
treated as constitutive exons. (D) Two isoforms are constructed for each
trio. Every exon-skipping event is represented by an inclusion isoform (fl)
and a skipping isoform (fz) which comprise a pair of ﬂanking exons (El,
E3) and an alternative exon (E2) present in f1 but not in f2. To examine
additional types of alternative splicing, such as (E) alternative 5’ splice sites,
(F) alternative 3’ splice sites, and (G) intron retention, we generated exon
duos to compare extended isoforms to shortened isoforms. (H) SpliceTrap
can detect consecutive alternative exons. When the alternative exon (1 or b is
used as a ﬂanking exon in an exon trio (flu, )5me, andfzb), ifit is skipped, the
exon trio will not pass the coverage cutoff, and thus will not be considered
to be reliable. However, if substitute exon trios are present in Tde (fl/a,
fz’a,fl’b and f2”), when f; a >f2’a and f; b <f2’b or Vice-versa (referring to their
expression levels), exon (1 and b are mutually exclusive. Or, if f; a <f2’a and
fl’b <f2’b, they are skipped together.

Tde as a separate case. About 20% of the exons in Tde are represented
by more than one assembly of ﬂanking exons (i.e. trios or duos). The pie
charts in Supplementary Figure S1 show the types and numbers of exons
represented by one or multiple assemblies.

Next, we formatted the database to allow quantiﬁcation of exon skipping
(CA: cassette exon). We assumed that the middle exon was a cassette exon
(E2) (regardless of whether it is annotated as alternatively or constitutively
spliced) and the ﬂanking exons (El and E3) are constitutive exons.
Accordingly, each exon trio in Tde was represented by two sequences
(Fig. 1D): an inclusion isoform (fl) with all three exons; and a skipping
isoform (fz) comprising the ﬂanking exons only. The ﬁrst and last exons
from every transcript were ﬁltered out, because transcriptomic variability
in these areas is primarily due to alternative transcription initiation or
polyadenylation, rather than to AS per se. By using Tde as a mapping
database, we can approach every exon as an independent case to estimate its
AS level.

Based on this concept, we extended Tde for detecting other types of
AS patterns (AA: alternative 3’ splice site, AD: alternative 5’ splice site. IR:
intron retention). To analyze AD (Fig. 1E) and AA (Fig. 1F) we compiled
exon duos (rather than trios), setting f1 as the extended isoform (spliced Via
the proximal splice site), and f; as the shortened isoform (spliced Via the
distal splice site). In addition, to account for IR (Fig. 1G), we deﬁned f1 as
the intron-retaining isoform, and f; as the spliced isoform.

To estimate the extent to which the trio/duo assemblies can
capture local AS variability, we downloaded the compendium of AS
events from the AStalaVista website (http://genome.crg.es/astalaviSta!)

 

3011

112 /3.Io's[BumoIpJOJXO'sorwuiJOJurorq”:duq uroii papeolumoq

9103 ‘Og isnﬁnv uo ::

J. Wu et al.

 

(Sammeth at 611., 2008). For hg18, we counted the numbers of events that
could be represented in the format of exon trio/duo. About 74.14% of the
events from RefSeq accounted for single-exon AS events, all of which were
covered by Tde with a single exon trio/duo. When ESTs annotations were
included, the percentage of covered events was 64.2%. It is important to note
that some EST-based annotations might be of poor quality, as a result of noise
in EST libraries (Sugnet at 611., 2004). In SpliceTrap, ESTs are used only as
mapping references, and not as a sole means to predict AS events; in this
way, EST-based predictions can be conﬁrmed if they align with a substantial
number of RNA-seq reads. In addition, 9.82% of the RefSeq AS events in
AStalaVista (8.96% with ESTs) could be described by combining two entries
in Tde (e.g. consecutive CAS), and 2.9% (RefSeq only) or 1.97% (ESTs
included) corresponded to assemblies of three or more exon trios/duos. The
rest corresponded to more complex AS events that could not be handled
directly by Tde.

Complex AS events (i.e. involving two or more exon trios/duos) can be
investigated by further comparing SpliceTrap quantiﬁcations. For example,
Figure 1H illustrates two consecutive exons that are alternatively spliced.
If either of them is skipped, the respective exon trios would not pass the
coverage cutoff (see Section 2.3 for details). However, if annotations exist,
the inclusion ratio may be quantiﬁed based on substitute exon trios available
in Tde (Supplementary Fig. Sl). By comparing the inclusion ratios of both
exons, one may detect if they are mutually exclusive or skipped together. It is
important to note that the ability of SpliceTrap to detect complex AS events
is limited, and depends on the availability of AS annotations to generate
several trios/duos for each examined exon. For this reason, we recognize
that some AS events may be overlooked, especially if they involve more
than two consecutive alternative exons.

The ﬁnal assembly of Tde for hg18 comprises a total of 167 4-45
CA candidates, of which 11812 have CA annotation, and the remaining
155 633 are annotated as constitutive exons (CS, to be examined whether
they are in fact skipped). In addition, Tde comprises 8667 AA, 4838 AD,
and 1170 IR candidates, based on annotations from dbCASE or RefSeq.
All together, SpliceTrap contains 224 995 exon trios (or duos) embodying
transcript variability from 182 560 human exons (Supplementary Table Sl).

Finally, we wish to bring to the reader’s attention that since ~6% of the
exons in Tde are uniquely annotated in dbCASE, a slight bias towards the
3’-end of the transcript may exist, especially for AAs. ADS and IRS, which are
generally unique to dbCASE (Supplementary Table Sl). Tde is available
online as part of the SpliceTrap package at http://rulai.cshl.edu/splicetrap/.

2.2 A Bayesian model to estimate inclusion ratios

In a paired-end RNA-seq experiment, a fragment is deﬁned as a sequence
segment encompassed between the ﬁrst and last nucleotides of a read-pair. We
assume that for each exon trio/duo, the positions of the mapped fragments
follow a uniform distribution, and that their sizes follow a nearly normal
distribution that depends upon the experimental protocol. Based on these
assumptions, a fragment j can be described as a vector r]- : (lg-,0), where b]-
and .0 denote the beginning position and size of the fragment, respectively.
Then, for every exon trio (or exon duo), we deﬁne the set of all possible
isoforms as F ={f1,f2}, where fl is an inclusion (or extended) isoform,
and f; is a skipping (or shortened) isoform (Fig. 1). The lengths and the
relative expression levels of these isoforms are L 2 {L1 ,L2} and E = {21 ,22}.
Accordingly, the probability of observing an isoform 1, given the expression
level E , can be written as:
e, -L,’
P(fllE)_ €1L1+62L2 (1)
Let m be the number of fragments R: {rj,j = 1,2, - -- ,m} that can be mapped
to F. Given that for each fragment r]- :(bj,sj), b]- and .0 are independent, the
probability of observing rj, given an isoformﬁ, is:

1
P(rjlfi,E) =P(bj U3,E)P(sj U3,E)=P(bj U3,E)P(sj) = fPUj) (2)

Map reads to Tde
I na mic
Cutoff

Estimation with eq.4

   
    
   
    

 

Inclusion
Ratio Modal
(IRM)

   
   

  

EXOI'I Inclusion Ratio

Fig. 2. SpliceTrap Pipeline. This chart illustrates the order and interrelation
among the different tasks performed by SpliceTrap. Squares represent
mapping steps; diamonds are ﬁltering steps; ellipses are prior-information
models; rounded-corner rectangles represent steps in the Bayesian model.

where 1,» is the effective length of ﬁ(li 2L, — 0+1), and P(sj) is the probability

of observing a fragment size .0 in the experiment. Note that if only one end

can be mapped to ﬁ, then P(sj) is set as 1 to ignore fragment-size information.
For all isoforms in F, we can write P(rle) as:

1 61-14
P -E: P 'i,EP 1E: —-P.'-— 3
ml >  (01f WI >  (v1) leWLz) (>

So for the whole data, we can write:

P(RIE) = H 1’01 IE) (4)

rf eR

Provided the prior distribution of E (see Section 2.4), a Bayesian posterior
function can be written as:

P(ElR)cx HP(rj|E)XP(E) (5)

rfeR

Then, we can maximize P(E |R) to estimate the inclusion ratio 21 for every
exon.

Note that throughout the text we refer to P(sj) as FSM (Fragment-
Size distribution Model), and to P(E) as IRM (Inclusion-Ratio distribution
Model), both of which are prior distributions and will be further described
in Section 2.4.

2.3 Pipeline design

We designed a simple pipeline to run SpliceTrap (Fig. 2). We started by
mapping the read-pairs onto Tde. For this purpose, we independently
aligned every read to the inclusion/skipping isoforms in Tde using Bowtie
(Langmead at 611., 2009). Then, the fragments unambiguously mapped to
single exons were used to build a FSM (Section 2.4).

To ﬁlter out poorly covered exon trios, we applied a dynamic, exon-size-
dependent cutoff strategy (Supplementary Fig. S2 and Section 3.1). Basically,
we applied different coverage thresholds to every exon, such that the size of
the exon and the coverage are inversely correlated. As an extreme example,
an exon that is shorter than a read would need to be covered several times
to be reliable. However, very long exons may be partially covered and still
be reliable. Accordingly, we ﬁltered exon trios with poorly covered ﬂanking
exons E1 and E3, but we did not require minimal coverage for exon E2 (i.e.
the exon under consideration). This ﬁltering method is intended to reduce
noise resulting from rarely expressed transcripts, truncated transcripts, DNA
contamination, wrongly mapped reads, etc., while avoiding unnecessary loss
of information from exons with good coverage (details in Section 3.1).

Next, we maximized Equation 4 for every exon trio, utilizing all the
mapped reads and the FSM to estimate the exon inclusion ratios. Finally,

 

3012

112 /3.Io's[BumoIpJOJXO'soiwuiJOJurorq”:duq 111011 popBo1umoq

9103 ‘0g15n8nv uo ::

SpliceTrap

 

to reduce variability noise, we corrected the results with an inclusion-
ratio distribution model (IRM) derived from high-conﬁdence data (see
Section 2.4).

2.4 Prior information models (FSM and IRM)

To generate FSMs, we took all the fragments uniquely mapped within the
boundaries of constitutive exons (i.e. not spanning across splice junctions)
and extracted the fragment sizes according to the positions of the reads.
Finally, the occurrence of each fragment size was recorded to generate
the distribution. The FSM distribution can be affected by variations in the
experimental protocols. In previous studies, it was approximated as a normal
distribution (Trapnell et (11., 2010); however, to increase prediction accuracy,
we chose to derive the FSMs directly from the dataset under study.

We generated IRMs for every type of splicing pattern separately
(Supplementary Fig. S3). Essentially, after mapping RNA-seq data onto
Tde, we selected the highest covered exon trios (FPKM > 10) and estimated
their inclusion ratios using Equation 4 (Supplementary Fig. S3A7D). As a
control, we also generated IRMs with Cufﬂinks (Supplementary Fig. S3E7
H). Notably, the distributions were very similar with both methods. To
avoid overﬁtting, we smoothed the IRMs by ﬁtting beta distributions
(Supplementary Fig. S317L) to the histograms, which were then used in
subsequent correction steps. Note that there is no speciﬁc IRM for CS,
because every CS is examined as a potential CA with a CA IRM.

2.5 Metrics for accuracy testing

To test the ability of SpliceTrap to discriminate alternative from constitutive
exons with inclusion ratios, we designed a series of metrics based on Tde
annotations. The assumption is that exons annotated as CA are enriched
within the fraction of exons with inclusion ratio i r < 1, and conversely, exons
annotated as CS are included at approximately ir: 1.

Cassette exon discovery rate (CAD): this metric is analogous to the
Positive Predictive Value (PPV). Given an ir <1, all cassette exons above
this ir are true positives (CA 1, denotes the number), whereas all constitutive
exons above the same ir are false positives (CSir); then,

CAD” =  (6)
CA ir + ir

Constitutive exon discovery rate (CSD): by analogy to the False Positive
Rate, above a certain i r(ir < 1), all constitutive exons are false positives (the
number of which is denoted by CS1,< 1), whereas all constitutive exons at
ir = 1 are true negatives (CSi,:1), because these are reported as constitutively
spliced, then CSDi, can be written as:

CSir<l
CSD> = — 7
Ir CSir<l +CSir:l ( )

Speciﬁcity (SP): using the deﬁnitions above, we calculate the speciﬁcity,
which is nearly the converse case of CSD:
CSir:l

SP’ 2 —
Ir CSir<l +CSir:l

(8)

3 RESULTS

SpliceTrap is a tool speciﬁcally designed to detect local alternative
splicing activity and quantify exon-inclusion ratios. Below, we
present both simulations and data analysis demonstrating that
SpliceTrap is highly accurate, reliable and robust, and we also
compare it to state-of—the-art RNAseq analysis tools.

3.1 Simulation of inclusion-ratio quantiﬁcation

We carried out a simulation in order to test the accuracy of
SpliceTrap compared to other methods. A series of exon trios was
generated by analogy to Tde. For every exon trio, the ﬂanking

Table 1. Simulation averages and standard deviations

 

Method Correlation coefﬁcient Mean absolute error

 

36 nt 75 nt 36 nt 75 nt

 

RPKM 0.76 :l: (0.18) 0.75 :l: (0.14) 0.16 :l: (0.11) 0.17 :I: (0.06)
Cufﬂinks 0.83 :l: (0.13) 0.78 :I: (0.12) 0.11 :I: (0.03) 0.16 :I: (0.03)
Scripture 0.72 :l: (0.22) 0.61 :l: (0.19) 0.18 :I: (0.10) 0.25 :I: (0.09)
MLE 0.84 :l: (0.14) 0.79 :l: (0.12) 0.10 :I: (0.05) 0.15 :I: (0.03)
SpliceTrap 0.87 :l: (0.14) 0.83 :l: (0.12) 0.11 :I: (0.05) 0.13 :I: (0.04)

 

exons (E1 and E3) were ﬁxed to a size of 120 nt (the average exon
size in Tde) whereas the middle exons (E2) varied in size from 9
to 500 nt. For these isoforms, we set expression levels based on the
distribution of inclusion ratios. We selected the IRM for CA, which
is the most common AS type (Supplementary Fig. S3I).

To simulate an RNA-seq experiment, we randomly fragmented
the isoforms into overlapping fragments of sizes following a
N (200, 152) distribution (by analogy to typical paired-end datasets),
and preserved only the 75 (or 36) nt ends of each fragment as read-
pairs. For every exon trio, the number of reads was adjusted to
achieve exon coverage between 0 and 10. All together, we ran a total
of 5555 simulations with different combinations of middle-exon size
and coverage per tested method. For each simulation, 1000 repeats
were made, and then the Pearson correlation coefﬁcient (FCC)
and the mean absolute error between the predicted and expected
inclusion ratios were calculated for accuracy evaluation.

We evaluated ﬁve different methods (Table 1): a naive method
based on RPKM counts alone (Wang et (11., 2008); Cufﬂinks
(Trapnell et (11., 2009); Scripture (Guttman et (11., 2010); a maximum
likelihood estimation model (MLE) (SpliceTrap using uniform IRM
and FSM models); and SpliceTrap. (see Supplementary Method 1.2
for the implementations of Cufﬂinks and Scripture). Our simulation
demonstrated that SpliceTrap can outperform all the other methods,
with higher PCCs and lower mean errors (Table 1). We observed
that using 36 nt or 75 nt reads, the average PCC of SpliceTrap was
the highest (0.83—0.87) compared to RPKM (0.75—0.76), Cufﬂinks
(0.78—0.83) and Scripture (0.61—0.72). In addition, we noticed
that by adding prior information (i.e. the full Bayesian model)
we obtained better results compared to MLE alone (0.79—0.84)
providing evidence for the contribution of the prior-information
models to the estimations. A similar pattern can be found in the
mean absolute errors, where SpliceTrap attained the lowest errors
(0.11—0.13) compared to the rest of the tools (0.11—0.25).

Next, we carried out simulations for the other three major
types of AS patterns (Supplementary Table S3). We kept the same
parameters, except for the IRM models, which were adjusted to each
splicing type (Supplementary Fig. S3). In all cases, the error means
and PCCs obtained were similar to those calculated using a CA IRM
with 36 nt and 75 nt reads. (Supplementary Table S3), indicating that
SpliceTrap can be used to investigate different splicing patterns.

Notably, these simulations revealed a general association between
the prediction accuracy, the size and the coverage of the exons
(Supplementary Fig. S4). Speciﬁcally, whereas smaller exons
required higher coverages, low-coverage but larger exons achieved
comparable accuracies. This resulted in a power-law-shaped surface,
both for the mean error and the PCC, which was independent of the

 

3013

112 /3.Io's[BumoIpJOJXO'soueuiJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

J. Wu et al.

 

100000 A B Exon Trios

/ 40k 80k 120k160k

0.1 —

10000 0.2 —
.3 ‘5 03 —
1:  S 0.4 —
5 1000 " 3
x -— 0.5 —
u] E

E06 —
n 0.7 —
08

09—

 

100

10
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

Inclusion Ratios

Fig. 3. Distribution of inclusion ratios (A) and number of detected exon trios
(B) based on RNA-seq data from HeLa cells (36 nt paired-end). The colors
correspond to dynamic cutoffs from 0.1dc to 0.9dc.

method used (Supplementary Fig. S4). We took advantage of this
observation and designed a dynamic cutoff strategy accordingly.
Using the simulation results shown in Supplementary Figure S4A,
cutoff curves were derived at different PCCs ranging from 0.1 to
0.9 (Supplementary Fig. S2). For convenience, these dynamic cutoff
curves are referred to as 0.1dc to 0.9dc throughout the text. Basically,
for every exon in the data, we required a minimum coverage,
depending on its size. Smaller exons required higher coverage, and
larger exons required lower coverage. In short, this procedure should
ﬁlter out most of the noise, and yet avoid unnecessary loss of exons
that are partially covered, albeit by a sufﬁcient number of reads.

3.2 Running SpliceTrap with RNA-seq data

To experimentally test SpliceTrap and compare it to other methods,
we generated more than 60 million 36 nt paired-end reads using
HeLa cell RNA (see Supplementary Methods 1.1). We applied
SpliceTrap to these data, using dynamic cutoffs from 0.1dc to 0.9dc
(Fig. 3 and Supplementary Fig. S2). We noticed that in general, the
distributions of the inclusion ratios had a ‘U’ shape (Fig. 3A) which
was also observed using Cufﬂinks (Supplementary Fig. S3E—H) and
in other studies based on ESTs (Peng et (11., 2008). This means that
in the sample analyzed, the exons tended to be highly included (i.e.
constitutive) or fully skipped from the transcripts. Nevertheless, a
substantial proportion of the exons showed intermediate inclusion
levels, regardless of the stringency of the dynamic cutoff.

In addition, we noticed that the number of selected exon trios
did not vary dramatically within the range of lower dynamic cutoffs
(0.1dc—0.6dc) although it dropped considerably above 0.7dc. Based
on these observations, we selected low (0.6dc), medium (0.7dc) and
high (0.8dc) stringency dynamic cutoffs for further analysis.

We ran Cufﬂinks and Scripture on the same datasets (provided
with Tde annotations), then we used three different cutoffs:
FPKM = 1, FPKM=2, FPKM: 10 for Cufﬂinks; and RPKM: 1,
RPKM = 2, RPKM = 10 for Scripture. For every AS candidate,
Cufﬂinks and Scripture reported the expression levels of the
inclusion and skipping isoforms. We used these numbers to calculate
inclusion ratios (See Supplementary Methods 1.2 for details).

3.2.] Predicting known splicing patterns We ﬁrst tested the
ability of SpliceTrap and other methods to detect known splicing
events. In Tde, every exon is assigned an annotation based on

high-conﬁdence ESTs and/or cDNAs (Supplementary Table S1).
Our assumption is that exons annotated as cassette (CA) should
be predominantly skipped (ir < 1), whereas exons annotated as
constitutive (CS) should be highly included at approximately ir = 1.

Based on this premise, we extracted all the exons (CA and
CS) and their inclusion ratios from the above results. CS exons
were examined in SpliceTrap as potential CAs using the CA
IRM. Therefore, in this assay, SpliceTrap was ‘blind’ to Tde
annotations (CS or CA). To test the ability of the different methods to
discriminate between CA and CS, we calculated the CAD, CSD and
SP (see Section 2.5). Notably, for any selected threshold, SpliceTrap
performed better at detecting low-included CAs, compared to the
other tools (Fig. 4A). Whereas Cufﬂinks and Scripture detected CAs
in any ir range to a similar extent, SpliceTrap was more efﬁcient at
identifying known CAs as the ir decreased. For example, at ir = 0.5,
the SpliceTrap CAD value was ~06, and at ir=0.1, it was almost
1. On the other hand, SpliceTrap detected CSs almost exclusively
at high inclusion ratios (Fig. 4B), with CSD values below 0.1 at
ir = 0.5 and ~ 0 at ir = 0.1. Accordingly, SpliceTrap exhibited higher
speciﬁcity than Cufﬂinks and Scripture (Fig. 4C), achieving levels
above 0.5 for ir < 0.5.

In summary, SpliceTrap quantiﬁcations appear to be consistent
with previous AS annotations; that is, most annotated CSs are
included at around ir= 1, whereas CAs are spread through the
whole range of inclusion ratios (Fig. 4). Using a U-shaped CA IRM
(Supplementary Fig. S3I) as prior information may have contributed
to the prediction accuracy of SpliceTrap. Also, wrongly annotated
CAs/CSs in Tde or novel AS events might have affected the
accuracy of the metrics.

3.2.2 Robustness and reliability of SpliceTrap We evaluated
the robustness of SpliceTrap estimations to technical variability
among different replicates of a same experiment. To this end, we
compared the results obtained from two independent RNA-seq lanes
(36-nt paired-end) generated under the same conditions. The plots
comparing the two lanes, using either SpliceTrap, Cufﬂinks or
Scripture with different thresholds, are shown in Figure 5.

Consistently with Figure 4, SpliceTrap predicted most exons to
be constitutively spliced (Fig. 5A—C). Using the stringent cutoff,
78% of the exons were included at ir30.9 in both experimental
replicates. In contrast, only 30% of the exons for Cufﬂinks (Fig. 5D—
F) and 23% for Scripture (Fig. 5G—I) showed ir: 0.9 in both
replicates. Notably, SpliceTrap could reliably reproduce the results
(PCC from 0.74 to 0.77) regardless of the threshold used. In contrast,
Cufﬂinks achieved a maximum PCC of 0.7 (Table 2), but only when
using the highest threshold (FPKM = 10). In other words, Cufﬂinks
could achieve a reproducibility comparable to that of SpliceTrap,
but only at the expense of the number of reported exons. whereas
SpliceTrap reported 97 068 exons at PCC = 0.74, Cufﬂinks reported
only 11606 exons at PCC=0.7. Scripture performed with high
reproducibility (0.83—0.92), however the predicted inclusion ratios
were averaged around 0.5. This would signify that most human
exons are alternatively spliced (Fig. 5), which is not in agreement
with previous transcript annotations.

Of note, Cufﬂinks achieved a high PCC in reproducing the
expression levels of the inclusion (0.91) and skipping (0.81)
isoforms (Supplementary Fig. S7), suggesting that Cufﬂinks has a
higher robustness in detecting full transcript expression than AS.

 

3014

112 /3.Io's[BumoIpJOJXO'soueuiJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

SpliceTrap

 

A 1 B 0.6
0.91 l
0.8 0.5

0’ II

E 0'7 E 0.4

r 0.6 r

W W

3 0.5 g 03

g 0.4 I;

'5
5 0'3 8 0.2

 

0 I I . I I

 

Specificity

 

 

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0

Inclusion Ratio

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1

Inclusion Ratio

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1

Inclusion Ratio

Fig. 4. Predicting known splicing patterns using 36 nt paired-end reads from HeLa cells. (A) The CAD, (B) CSD and (C) SP are shown as a function of the
inclusion ratios (x-axis) for SpliceTrap (black lines), Cufﬂinks (gray lines) and Scripture (dashed lines). Each method was applied using low (circles), mid
(squares) and high (triangles) cutoffs. (0.6dc, 0.7dc and 0.8dc for SpliceTrap, FPKM = 1, FPKM = 2 and FPKM = 10 for Cufﬂinks; RPKM = 1, RPKM = 2 and

RPKM = 10 for Scripture).

Low Cutoff

Mid Cutoff High Cutoff

  
  

  

SpliceTrap

 

Cufflinks

 

some}; uogsnpul 1 aue-I

Scripture

on 02 on no as

 

-: a .:u

Lane 2 Inclusion Ratios

Fig. 5. Robustness of the inclusion ratio estimations. The charts illustrate
the correlations between the inclusion ratios calculated in two independent
RNA-seq lanes (36 nt paired-end data from HeLa cells). (AiC) SpliceTrap
at 0.6dc, 0.7dc and 0.8dc, (ILF) Cufﬂinks at FPKM=1, FPKM=2 and
FPKM = 10, (Gel) Scripture at RPKM = 1, RPKM = 2 and RPKM = 10.

Table 2. Comparison of two replicates (36 nt paired-end reads)

 

 

Method Cutoff Exons PCC
Cufﬂinks FPKM: 1 52 243 0.41
Cufﬂinks FPKM = 2 38 140 0.49
Cufﬂinks FPKM = 10 11 606 0.7

SpliceTrap 0.6dc 97 068 0.74
SpliceTrap 0.7dc 90 896 0.75
SpliceTrap 0.8dc 80 052 0.77
Scripture RPKM = 1 70 466 0. 83
Scripture RPKM = 2 49 816 0. 87
Scripture RPKM = 10 14 022 0.92

 

Finally, we wanted to rule out dependencies between the net
expression levels and the inclusion ratios detected by SpliceTrap and
the other tools. To this end, we ranked all calculated inclusion ratios
from one lane in Figure 5(A, D and G) according to the expression
levels of the full-length exon trios reported by Cufﬂinks.

We observed that the inclusion ratios calculated with SpliceTrap
were independent of the expression levels, with a constant average
rate of ~0.95 (Supplementary Fig. S5). In contrast, the inclusion
ratios calculated with Cufﬂinks decreased proportionally to the
expression levels. The inclusion ratios calculated with Scripture
were also constant; however, as in Figure 5, they averaged around
0.5, meaning that most exons in the data are viewed as alternatively
spliced.

In conclusion, SpliceTrap can detect AS events in a more reliable
and reproducible way, compared to Cufﬂinks and Scripture, which
can be used to quantify local AS events, although with lower
accuracy.

4 DISCUSSION

SpliceTrap is a computational tool fully dedicated to quantify
major classes of AS activity based on paired-end RNA-seq data.
Unlike other available tools, SpliceTrap focuses on quantifying
local exon-inclusion ratios, instead of full-transcript expression
levels. Rather than reporting background-based read densities,
SpliceTrap utilizes Bayesian statistics to summarize exon-inclusion
probabilities derived from every single read-pair. For this reason,
SpliceTrap is also insensitive to transcript expression levels.

SpliceTrap was speciﬁcally designed to accurately quantify
alternative splicing at the single exon level. To achieve this goal, we
started by describing the problem with a statistical model based on
exon trios/duos, instead of full transcripts. To reduce the number of
false positives and yet minimize the loss of information, we applied
dynamic cutoffs derived from simulation, rather than using ﬁxed
cutoffs. Finally, we adjusted the results using speciﬁc inclusion-
ratio models for different AS patterns. In theory, full-transcript
quantiﬁcation tools like Cufﬂinks and Scripture can also be used
to calculate inclusion ratios with Tde annotations (Supplementary
Method 1.2), However, these tools were originally designed and
optimized for transcript-level estimation, and our analysis indicates
that they are less accurate than SpliceTrap for the speciﬁc problem
of calculating exon inclusion ratios.

 

3015

112 /3.Io's[BumoIpJOJXO'soueuiJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

J. Wu et al.

 

We have shown that it is possible to approach every exon as
a separate problem, and yet quantify its inclusion ratio without
knowledge of the full transcript structure. Given that our quantitative
units are the exons, we can disregard information from distant
exons (hence reducing complexity and noise), though it is certainly
important for transcript-level quantiﬁcation.

SpliceTrap can detect different splicing patterns. Even though the
original algorithm was developed to detect single cassette exons,
we have adapted it to other types of AS, such as alternative 3’ /5’
splice sites and intron retention. In combination, these patterns
account for 75% of all known human AS events in RefSeq
(Sammeth et (11., 2008). Additionally, some of the complex AS
patterns involving multiple exon trios/duos were also detected by
SpliceTrap (Supplementary Fig. S6). However, SpliceTrap’s ability
to detect very complex AS patterns may be limited, depending on
the annotations present in Tde.

At this stage, SpliceTrap does not offer an option for ab initio
exon prediction. We chose to focus on a set of ~200 000 well
characterized exons, and designed a transcript database (Tde) as a
mapping reference. In this way, we sought to reduce ambiguities
generated by rarer expressed isoforms, especially during the
mapping procedure. Because Tde is a collection of exon trios/duos,
in the future it can be expanded by adding newly discovered or
predicted splice juctions, such as those derived by splice-junction
mappers like TopHat, or novel exons predicted by gene-prediction
tools, e.g. GENSCAN (Burge and Karlin, 1997). In this way, the
depth and sensitivity of SpliceTrap can be enhanced.

SpliceTrap is based on the assumption that the reads are uniformly
distributed within the exon trio/duo. Although the uniformity in
a small region is presumably a better assumption than in a full
transcript, this factor will still bias the results and should be
considered in future versions of the model.

SpliceTrap’s running time depends on the number of mapped
reads. For instance, using a 2 GHz AMD CPU with 8 GB of memory,
the running time was ~3 h for one lane (20 X 2 million 36 nt paired-
end reads), and ~12h for three lanes. Less than 500 MB memory
and 10-30 GB of hard disk space were needed. SpliceTrap is easy to
operate and requires a small number of input parameters, reducing
the user’s setup time. SpliceTrap also supports SUN Grid engine
(SGE) qsub for parallel computing. It can be implemented online
through the CSH Galaxy server (http://cancan.cshl.edu/splicetrap)
or downloaded at http://rulai.cshl.edu/splicetrap/.

ACKNOWLEDGEMENTS

We thank Assaf Gordon for providing access and support to the CSH
Galaxy server and Chaolin Zhang for providing dbCASE. Thanks
also to Chaolin Zhang and Justin Kinney for helpful discussions.

Funding: National Institutes of Health (GM74688 to M.Q.Z.).

Conﬂict of Interest: none declared.

REFERENCES

Baumer,D. et a1. (2009) Alternative splicing events are a late feature of pathology in a
mouse model of spinal muscular atrophy. PLoS Genet, 5, e1000773.

Brett,D. et a1. (2002) Alternative splicing and genome complexity. Nat Genet, 30,
29730.

Burge,C. and Karlin,S. (1997) Prediction of complete gene structures in human genomic
DNA. J. Mol Biol, 268, 78794.

Castle,J.C. et a1. (2008) Expression of 24,426 human alternative splicing events and
predicted cis regulation in 48 tissues and cell lines. Nat Genet, 40, 141671425.

Clark,T.A. et a1. (2002) Genomewide analysis of mRNA processing in yeast using
splicing-speciﬁc microarrays. Science, 296, 9077910.

Fullwood,M.J. et a1. (2009) Next-generation DNA sequencing of paired-end tags (PET)
for transcriptome and genome analyses. Genome Res, 19, 5217532.

Goecks,J. et a1. (2010) Galaxy: a comprehensive approach for supporting accessible,
reproducible, and transparent computational research in the life sciences. Genome
Biol, 11, R86.

Gupta,S. et a1. (2004) Genome wide identiﬁcation and classiﬁcation of alternative
splicing based on EST data. Bioinformatics, 20, 257972585.

Guttman,M. et a1. (2010) Ab initio reconstruction of cell type-speciﬁc transcriptomes in
mouse reveals the conserved multi-exonic structure of lincRNAs. Nat Biotechnol,
28, 5037510.

Jiang,H. and Wong,W.H. (2009) Statistical inferences for isoform expression in RNA-
Seq. Bioinformatics, 2S, 102&1032.

Johnson,J.M., et a1. (2003) Genome-wide survey of human alternative pre-mRNA
splicing with exon junction microarrays. Science, 302, 214172144.

Langmead,B. et a1. (2009) Ultrafast and memory-efﬁcient alignment of short DNA
sequences to the human genome. Genome Biol, 10, R25.

Lewis,B.P. et a1. (2003) Evidence for the widespread coupling of alternative splicing
and nonsense-mediated mRNA decay in humans. Proc. Natl Acad. Sci. USA, 100,
1897192.

Maniatis,T. and Tasic,B. (2002) Alternative pre-mRNA splicing and proteome expansion
in metazoans. Nature, 418, 2367243.

Pan,Q. et a1. (2008) Deep surveying of alternative splicing complexity in the human
transcriptome by high-throughput sequencing. Nat Genet, 40, 141371415.

Peng,T. et a1. (2008) Functional importance of different patterns of correlation between
adjacent cassette exons in human and mouse. BM C Genomics. 9, 191.

Pruitt,K.D. et a1. (2007) NCBI reference sequences (RefSeq): a curated non-redundant
sequence database of genomes, transcripts and proteins, Nucleic Acids Res, 35,
D617D65.

Relogio,A. et a1. (2005) Alternative splicing microarrays reveal functional expression
of neuron-speciﬁc regulators in Hodgkin lymphoma cells. J. Biol. Chem, 280,
47794784.

Sammeth,M. et a1. (2008) A general deﬁnition and nomenclature for alternative splicing
events. PLoS Comput. Biol, 4, e1000147.

Sorek,R. et a1. (2004) A non-EST-based method for exon-skipping prediction. Genome
Res, 14, 161771623.

Sugnet,C.W. et a1. (2004) Transcriptome and genome conservation of alternative
splicing events in humans and mice. Pac. Symp. Biocomput, 66777.

Trapnell,C. et a1. (2009) TopHat: discovering splice junctions with RNA-Seq.
Bioinformatics, 25, 110571111.

Trapnell,C. et a1. (2010) Transcript assembly and quantiﬁcation by RNA-Seq reveals
unannotated transcripts and isoform switching during cell differentiation. Nat
Biotechnol , 28, 5117515.

Ule,J. et a1. (2005) Nova regulates brain-speciﬁc splicing to shape the synapse. Nat
Genet, 37, 8447852.

Wang,E.T. et a1. (2008) Alternative isoform regulation in human tissue transcriptomes.
Nature, 456, 470—476.

Xie,H. et a1. (2002) Computational analysis of alternative splicing using EST tissue
information. Genomics, 80, 3267330.

Zhang,C. et a1. (2007) Dual-speciﬁcity splice sites function alternatively as 5’ and 3’
splice sites. Proc. Natl Acad. Sci. USA, 104, 15028715033.

 

3016

112 /3.Io's[BumoIpJOJXO'soueuiJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

