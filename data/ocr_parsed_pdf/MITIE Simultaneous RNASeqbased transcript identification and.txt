BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

55,2kgowsmoddmmowoio~&o:~=£¢o~m\

12 131415

11

0
9
oo

6

12345

Segment No.
Read Coverage

 

MITIE: Transcript identification and quantification in multiple samples

 

events using microarray probes for exon junctions and ﬂanking
regions. Candidates were processed from annotated alternative
splicing events (Wang et a1.) or EST—alignments (Shair et al.),
respectively. Alternative splicing events were then embedded
into the reference transcript, and the resulting transcripts were
ﬁnally quantiﬁed using probabilistic models for the microarray
measurements. These methods constitute the algorithmic foun—
dation of RNA—Seq based approaches, but are not directly ap—
plicable to RNA—Seq data owing to the extensive differences in
abundance, error sources and biases of the underlying expression
measurements.

The following RNA—Seq based methods build on quantiﬁca—
tion approaches but identify additional transcripts by enumer—
ating all potential transcripts from a splicing graph. iReckon
(Mezlini et al., 2012) and NSMAP (Xia et al., 2011) are capable
of ﬁnding new transcripts but limit the search to transcripts
having the same transcription start and termination site as
known transcripts. Although this signiﬁcantly reduces the search
space and therefore allows simpler optimization techniques, it is
a biologically implausible restriction.

Scripture (Guttman et al., 2010) enumerates all potential
transcripts from a splicing graph and reports them in the result
ﬁle. Although this approach guarantees maximal sensitivity in
the case of unﬁltered data, it is in general not feasible, and align—
ments have to be ﬁltered stringently. The approach does not aim
to achieve specific results. IsoLasso (Li et al., 2011) and rQuant
(Bohnert et al., 2009) use the Il—norm to regularize transcript
abundance. This approach signiﬁcantly reduces the number of
reported transcripts, but the choice of the regularizer is subopti—
mal, given that all abundance values are positive and the sum is
ﬁxed. Thus, the regularizer does not sufﬁciently penalize a solu—
tion explaining the coverage with two similar transcripts
compared with a solution with only one transcript (compare
Mezlini et a[., 2012).

CLIIQ (Lin et al., 2012) addresses this problem by applying an
integer linear programing approach to limit the number of iso—
forms expressed in any sample combined with an [1 loss on the
difference of observed and expected coverage. Athough this is
conceptually similar to the MITIE optimization problem with
respect to the integration of multiple samples, the formulation
has signiﬁcant disadvantages. The number of integer variables in
the CLIIQ integer linear programing depends on the number of
potential isoforms, which increases exponential with the number
of exons. Thus, given S exonic segments, the theoretical runtime
of the algorithm is 0(223), and therefore stringent filters on the
read data and on the enumerated transcripts have to be applied
to prevent a combinatorial explosion.

The following approaches avoid the explicit enumeration of
transcripts using different techniques. Cufﬂinks reports the min—
imal number of transcripts such that each read alignment is
explained by at least one transcript. Although this parsimony
assumption reduces the computations signiﬁcantly, it is violated
by many known genes, and it does not deal well with inaccurate
read alignments. We will discuss the beneﬁts and drawbacks of
Cuﬂiinks in more detail in Sections 4.1 and 4.2. Montebello
(Hiller and Wong, 2012) uses a probabilistic model to score
sets of transcripts and implements a probabilistic search strategy
to generate and modify transcript sets until a certain criterion is
reached. Although this strategy allows for a wide range of

functions to quantify the quality of a solution, it does not pro—
vide any guarantee of optimality. MITIE instead guides the
search using the branch and bound strategy and can therefore
avoid regions in the search space that cannot yield the optimal
solution.

De novo transcript assemblers have been proven useful in cases
where the reference genome is missing or of poor quality. They
have the additional advantage of treating alternative transcripts
and paralogous genes (resulting in multiple mappings for reads in
genome alignment) naturally the same way. The optimization
problem formalized by MITIE generalizes to solve transcript
prediction also in the de novo setting, and we show in Section
4 that the MITIE strategy is superior to the dynamic
programming—based strategy of Trinity. OASES follows a differ—
ent heuristic, which has been shown by the authors to be more
sensitive but less specific than the Trinity approach.
T rans—ABySS extends the genome assembly method ABySS
(Simpson et al., 2009) to cope with the high variation in local
read densities observed in RNA—Seq data. Like Cufﬂinks and
OASES, T rans—ABySS does not aim to explain the read data
quantitatively during the transcript prediction.

Given this context, the strategy of MITIE is comparable with
quantiﬁcation methods like rQuant, NSMap, iReckon and
IsoLasso. The main distinctions are an improved loss function,
a parsimony regularizer and the ability of MITIE to avoid an
exhaustive enumeration of transcripts. The latter solves a com—
putational problem but raises difﬁculties of explicitely modeling
biases in the read count data with MITIE. As the improvements
in quantiﬁcation accuracy achieved by explicitely modeling biases
have shown to be moderate [Using rQuant with an [z—loss func—
tion, an explicit model of the transcript length bias increased the
pearson correlation coefficient by 0.44.7 percentage points
(Bohnert, 2011, Table 3.1)], we decided not to incorporate this
into our model. To our knowledge, MITIE and Cuﬂiinks are the
only approaches to RNA—Seq—based transcript identiﬁcation that
can perform predictions with and without prior annotations. We
will outline the details of MITIE in the following section.

3 METHODS

MITIE can build a segment graph based on given alignments of RNA-
Seq reads to a genome or start with segment graphs obtained by other
means, in particular by de novo assembly. Building such graphs from
RNA-Seq data has been reported several times before (e.g. Denoeud
et al., 2008), and we only describe it brieﬂy in Section 3.1 and
Supplementary Section B. In the following Sections 3273.4, we describe
(i) the main aspects of core optimization problem, (ii) how to ensure the
construction of valid transcripts and (iii) give a probabilistic derivation of
our loss function. We then discuss how to take advantage of paired-end
reads, cope with multi-mapping reads and approximate the solution of
the optimization problem in Sections 3.5 and 3.6.

3.1 Constructing the splicing graph

We start by deﬁning the boundaries of a region either based on annotated
genes or read coverage. If gene/transcript annotations are available, we
deﬁne regions within each annotated genic locus (see Fig. 1). Otherwise,
we deﬁne islands by identifying genomic regions that are connected by
fragment alignments (cf. Supplementary Section B). Each region may
contain exonic and intronic segments, and the splicing graph generation
is performed independently from other regions. This process is illustrated

 

2531

ﬁm'spzumofpmﬂo'sopnuuopnorq/ﬁdnq

Segment Graph G

Abundance W

Observed coverage Col”

Expected coverage Cexp

T

 

/310'S[BIIJHO[pJOJXO'SOlNZLUJOJIIlOlq/ﬂduq

MITIE: Transcript identification and quantification in multiple samples

 

from false alignments or incomplete RNA processing using a Poisson
distribution with ﬁxed mean 7b.

We deﬁne the likelihood of observing a count V in dependence of the
unknown expected count V* as follows

V
pM(VIV*) = EMMA) xpN(V— X|V*,(1+ n1)V* + n2V*'),
x20

where pp(-|A) is the probability under the Poisson distribution with
mean 7L, and pN(-| V*, (1 + n1)V* + n; X V*2) is the likelihood under the
negative binomial distribution with mean V* and variance
(1 + n1)V* + n; V*2. The choice for parameters n1, n2 2 0 depends on
the extent of biases present in the RNA-Seq library. These parameters
can be estimated for a given RNA-Seq library based on single transcript
genes (see Supplementary Section D for more details).

We assume deviations being independent between the segments and
can thus deﬁne the negative log-likelihood 110’”, 0”") for all segments
in sample r as follows:

S S
_ 10g (1‘1 m (62’? ICrf ) = — 2 logo.” (Cf? Iciif».
s21 s21

3.5 Exploiting paired-end reads

There are a number of ways to exploit paired-end reads. We chose a
simple and efﬁcient approach and incorporate paired end data into
MITIE as follows: For each pair of segments (s1,s2), N “J” stores the
number of read pairs, where one read overlaps segments s1 and the other
read overlaps segment s2 in sample r. We then add the penalty term
y; X 2le Pr to the objective function where

k

Pr = Z NvngJ X  _ UVIJ X UvgJ)

(s3. s3) (:1

This prefers solutions in which combinations of segments supported by
paired-end reads are part of a predicted transcript. A straightforward
extension of this strategy also allows for integration of partial transcript
information. This provides an efﬁcient way to directly integrate
information from ESTs or third-generation sequencing platforms (see
e.g. Rasko et al., 2011).

3.6 Solving the optimization problems

Optimal solutions by mixed-integer programming For certain classes of
mixed integer optimization problems, fast solver implementations are
available that guarantee to ﬁnd the optimal solution. An important
requirement is that the relaxed version of the problem (allowing real
values for integer variables) can be solved efﬁciently. This allows the
use of branch and bound techniques. The combinatorial tree deﬁned by
the different choices of integer variables is traversed, and on each node,
the relaxed optimization problem has to be solved. As the relaxed
solution is always a lower bound (in the minimization case) of the integer
solution, the result of the relaxed optimization can be used to prune
branches from the combinatorial tree, which cannot contain the optimal
solution. In the current study, we used CPLEX (http:/ /bioweb.me/cp1ex)
to solve the mixed integer optimization problems.

Piece-wise quadratic loss function For efﬁcient optimization, we
approximate the log-likelihood term — log(pM(C“\?”“'|C§XP)) using a piece-
wise quadratic proxy function l(Cf\f”“', Cf”) with the property that it is
convex and has the same global minimum as — log(pM(C“\?”“'| Cit?» (which
is reached at C?“ 2 Cf”). See Supplementary Section K for details on
estimating l(-, -). We then use this proxy function to deﬁne our loss
function:

S
L( Cup, Cubs) 2 Z Ci‘tbs‘, 
s21

We will further refer to this loss function as the approximate negative
binomial loss or IVE-loss.

Iterative approximations The run-time of the branch and bound algo-
rithm depends on how widespread the near optimal solutions are in the
combinatorial tree and how branched, i.e. complex, the tree is. The former
can be addressed to a certain extend by eliminating equivalent solutions if
possible (cf. Supplementary Section L). The complexity of the search tree
can be reduced using constraints to exclude transcripts that are not paths
in the splicing graph. However, it might become necessary to search
distant parts of the tree to ﬁnd the optimal solution, in particular when
the number of samples is insufﬁcient to exactly determine the solution (cf.
Section 4.1). We found that we can obtain good approximations to (1), if
we iteratively solve it in the following way: We ﬁrst solve it for one new
transcript (and available annotated ones). This speeds up computation
signiﬁcantly, as the number of free integer variables in U is S instead of
k X S. Moreover, the complexity of the combinatorial search space is
signiﬁcantly reduced. Once we found the ﬁrst transcript, we ﬁx the U
variables for this transcript, keep W free and ﬁnd a new transcript with a
row of free U variables. This strategy signiﬁcantly speeds up the opti-
mization, and we did not notice a signiﬁcant reduction in prediction
accuracy.

3.7 Conﬁdence quantiﬁcation for transcript calls

Given a set of k transcripts, we are interested in the importance of each
transcript for explaining the total RNA-Seq data. We make use of a
likelihood-ratio test (Huelsenbeck and Crandall, 1997) to quantify the
conﬁdence in each predicted transcript t. We compute the test statistic:

_ 13(DIM)
T_ —2ln TWO), (2)

Where p(D|]l/[) is the approximate likelihood of observing the read data D
under our model M based on all k transcripts and p(D|M,) is the ap-
proximate likelihood when restricting the quantiﬁcation value of tran-
script t to zero. To compute this, we solve the quantiﬁcation task k times
using all transcripts from the transcript inference step and set the quan-
tiﬁcation value of transcript t to zero. We compute the objective function
setting all regularization parameters to zero. We assume the test statistic
to be XZ- distributed with df = k — (k — 1) = 1 degrees of freedom and
compute a P-value for each transcript. This strategy allows us for ex-
ample to estimate the probability that a newly predicted transcript ex-
plains features of RNA-Seq data that cannot be explained by known
annotated transcripts.

3.8 A test for differential transcript expression

Similar to the strategy in the previous section, we can also perform a test
for differential transcript expression in two samples. We compute the like-
lihood of a model that quantiﬁes a set of k transcripts independently, and
the likelihood of a model that quantiﬁes the transcripts identically in the
two samples. We can then compute the log-likelihood ratio as test-statistic
and apply the XZ-test with df: k degrees of freedom. It is straightforward
to apply this test only to a subset of the transcripts. One can also extend this
strategy to take replicates into account. There are a few other approaches
for testing for differential transcript expression (Anders et al., 2012; Drewe
et al., 2012; Katz et al., 2010), and it goes beyond the scope of this work to
provide a thorough comparison with these methods.

3.9 Multi-mapper optimization

The quantiﬁcation of RNA-transcripts is strongly affected by reads that
map to multiple locations on the genome (multi-mapped reads; cf. Section
4.2.2, for results). Predicting transcripts is even harder, and one can there-
fore assume that appropriate handling of multi-mapped reads can lead to
signiﬁcant improvements.

 

2533

ﬁle'sreumofpmjxo'sopnuuopnorq/pdnq

J.Behr et aI.

 

Identification of Complete Transcript Sets

B

 

2 expressed
transcripts

 

lllllllill

 

 

 

 

 

 

 

 

 

 

 

 

A
spicegraph W
1 2 3 4 5 6 7
RNA-Seq
coverage
(4 Samples) H
* - E _ E _ E -
- E _ E _ -
P t t. I *- E _ _ E -
0 en la
transcripts *- E _ _ -
* - _ E _ E -
expressed I
_ . _ -
* - _ _ E -
- _ _ -

 

3 expressed
transcripts

iiiiiiiiii

 

 

4 expressed
transcripts

 

 

 

Fig. 3. (A) Example with four samples of simulated reads. All four samples express the same four transcripts (marde with asterisks) with different
relative abundances. The different relative abundances lead to distinct coverage patterns in the alternative regions. (B) We randomly selected 2 (top). 3
(middle) and 4 (bottom) transcripts and simulated four samples RNA—Seq reads each. For each sample. we uniformly redistributed the abundance
between the selected transcripts. We then predicted transcripts with different methods. The prediction was counted as correct if all transcripts were
exactly matched and no additional transcripts were predicted. To obtain more robust measurements. we repeated the whole procedure 50 times and

report the mean number of correct predictions for each method

Our strategy is based on the multi—mapper—resolution (MMR)
approach [Kahles and Ratsch personal communication: For each read
with multiple possible mapping location MMR decides for the location.
such that the variance in read coverage is minimized] that decides on the
read coverage distribution how to optimally choose one of several am—
biguous alignments. We augmented MMR now referred to as Mil/[0
(Multi Mapper Optimization) to take the predicted transcripts and
their abundance estimates into account. Given the latter. we can compute
the expected read coverage throughout the genome. For each read with
multiple mapping locations. we can then determine which mapping loca—
tion would lead to the smallest loss over all genes in the genome [cf. (1)].
This approach has the conceptual advantage that minimizing the same
loss in the core optimization step and in the multi—mapper optimization
step is a consistent way of integrative RNA—Seq analysis. As Mil/[0 de—
pends on transcript predictions and abundance estimates. it needs to be
run multiple times in conjunction with solving the MITIE core optimiza—
tion problem in an expectation—maximization—like manner. We describe
more details of this approach in Supplementary Section F.

4 RESULTS

4.1 An illustrative simulation study

We start by considering a specific case of transcript inference to
illustrate the limits of transcript identification from a single sam-
ple and to show how multiple samples can help identifying com-
monly expressed transcripts. In Figure 3A. we consider a splicing
graph encoding three exons skips leading to eight possible tran-
scripts. The task is to determine which transcripts are expressed.
We consider multiple samples and assume that the same small set
of transcripts is expressed in all samples but with different abun-
dances (including the possibility of zero abundance).

This problem can be reduced to solving systems of linear equa-
tions (Lacroix el (1].. 2008). If a system of equations is solvable.
then the corresponding set of transcripts can fully explain the
observed read coverage (see Supplementary Section G; for

simplicity. we ignore statistical fluctuations and use exact. i.e.
expected. quantities). In case of multiple samples. we identify
the sets of transcripts that are consistent with all samples (inter-
section of the sets of sets of transcripts). If only one such set of
transcripts remains. then we can be sure to have found the cor-
rect solution (“identiﬁable”). If several sets remain. the best strat-
egy is to randomly select one set out of the possible ones
(“optimal strategy").

It turns out inference for the considered example becomes in-
creasingly more difﬁcult. the more transcripts are expressed
(Fig. 3B). If only one transcript is expressed. all strategies always
find the correct answer. If two of the eight transcripts are
expressed. it is theoretically always possible to identify them cor-
rectly. Also. Caitlin/cs and MITIE often identify the correct set of
transcripts (see Fig. 3B. top). Repeating the same experiment for
three expressed transcripts. the observations change completely.
Only in 16 and 60% of the cases. there is exactly one solution or
the optimal algorithm identiﬁes the correct one (one sample).
respectively. The success rate increases significantly with the
number of samples (88 and 95%). The accuracy of MITIE is
close to the optimum and better than the optimal conservative
algorithm. Caitlin/cs ﬁnds the correct three transcripts in only
2% of the runs. which comes close to randomly guessing three
of eight (1.78%) (see Fig. 3B. middle). If four of eight transcripts
are expressed. Caitlin/cs never finds the correct solution. whereas
MITIE performs comparable with the optimal strategy (cf.
Fig. 3B. bottom) (Caitlin/cs was run on merged samples. as the
Cir/{fluiksfCir/{finerge combination as described in Section 4.2 did
perform worse).

4.2 Results for simulated human reads

4.2.] Read simulation A major obstacle for the evaluation of
tools for transcriptome reconstruction is the lack of a gold

 

2534

[310'sreumotp105xo'sopeuuopnorq/ﬁdnq

MITIE: Transcript identification and quantification in multiple samples

 

>

Effect of Loss Function on Quantification

 

+ NB—loss
MA... p_loss
«tub—loss

9
co
co

 

 

  

 

9
0
J;

Pearson Correlation
O
(O

 

 

 

 

 

 

 

 

 

 

0.86 “‘uc“
.‘~_~._
... “A
0.82
0 1 2 3 4 5
B Effect of Alignments on Quantification
0.99 -
C
2 0 98 _ —Ground Truth Alignments
E ' +MMO selected Alignments
93 -*- Only Best Alignments
:5 _ u-vAv-v All Alignments
O 0.97
E g
Q 0.96 -
(\‘5
a,    

 

 

 

o 1 2 3 4 5
Number of Allowed Mismatches

Fig. 4. (A) MITIE quantiﬁcation results for the three different loss func-
tions IVE, 1’3 and (ﬁg-loss. We consider stringent (0 mismatches) and liberal
read alignments (up to 5 mismatches), leading to fewer or more multi-
mapping reads, respectively. (B) MITIE quantiﬁcation results with IVE-
loss, when considering ground truth alignments, all multiple alignments,
or after multi-mapper handling with MMO (see Section 3.9)

standard set of RNA—Seq libraries and known expressed tran—
scripts. Simulated reads have the advantage that we can evaluate
different aspects of predictions, which we would not be able to
observe in reality. They are therefore an important part in
evaluating many RNA—Seq—based algorithms. To obtain realistic
RNA—Seq read alignments, we (i) randomly draw the transcript
abundances in multiple samples, (ii) used the FluxSimulator
(Griebel et al., 2012) to incorporate typical biases from library
preparation and sequencing, (iii) introduced errors into the gen—
erated reads and (iv) mapped the generated reads against the
whole genome (see Supplementary Section A for more details).
For this study, we generated simulated reads for a set of 1000
human genes with 8592 transcripts in total. The ﬁrst 500 genes
were used to tune hyper—parameters for all compared methods.
Reported results correspond to the performance on the second
set of 500 genes.

4.2.2 Quantification, loss functions and multi—mapper
resolution Figure 4A illustrates the effect of different loss func—
tions on the Pearson correlation of predicted and ground truth
transcript abundances. Similar to MITIE’s loss function (1V3—
1oss), we implemented a quadratic proxy function for the nega—
tive log—likelihood under the model of Poisson—distributed reads
(R—loss). The AFB—loss generally gives more accurate results than
the P—loss and the Zz—loss. Both the P—loss and AFB—loss are sig—
niﬁcantly more robust to erroneous data (for instance, spurious
alignments when allowing more mismatches) than the Zg—loss
(For independence of hyper—parameters, we only use the exon
coverage). The correlation of Cuﬂlinks quantiﬁcation values is
significantly lower and less robust to noise (cf. Supplementary
Fig. E) (We computed the correlation based on the lower

conﬁdence interval reported by Cuﬂlinks, which has higher cor—
relation to the true abundance than the estimated abundance
value itself). Bohnert (2011) performed a thorough comparison
of different quantiﬁcation strategies including Cuﬂlinks Trapnell
et al. (2010) and MISO (Katz et al., 2010) with and without bias
correction and found that the effect of bias correction are often
minor.

We also investigated the effect of multi—mapper handling on
the quantification performance (Fig. 4B). For this experiment,
we used the full set of MITIE features as described earlier in the
text and the IVE—loss. We observe that using all features, the
quantiﬁcation is much more robust with respect to noise in the
reads. Moreover, by using MMO (see Section 3.9), one can sig—
niﬁcantly improve the quantiﬁcation. After resolving multi—map—
pers with MM 0, the quantification improves even beyond less
stringent ﬁltering.

Finally, we evaluated how indicative the conﬁdence value
based on the likelihood—ratio test (Section 3.7) is for a transcript
to be expressed. We find that among the 4718 non—zero
quantiﬁed transcripts with P<0.1, we have 86% correct tran—
scripts with non—zero simulated expression, whereas of 326 tran—
scripts with P: 0.1, we ﬁnd 44% correct predictions. This result
shows that the confidence values accurately indicate cases with
possible alternative explanations. We argue that it is more favor—
able to use the conﬁdence values for ﬁltering transcripts than the
frequently used ﬁltering based on relative or absolute abundance
estimates because ambiguities might originate from the topology
of the splicing graph and may therefore be independent of the
expression level. This is supported by a relatively low Pearson
correlation between predicted relative transcript abundance and
P—values of only 0.18, indicating that the likelihood—ratio test
adds additional information about the topology of the graph
that cannot be retrieved from the predicted abundance alone.

4.2.3 Accuracy of transcript prediction ( MIT IE and
Cufﬂinks) For most genes of many organisms, we know a sub—
set of transcripts in advance. The known transcripts are likely the
ones with the highest expression level as those are easiest to
identify by traditional annotation strategies. To test the accuracy
for this realistic scenario, we omit the information of all tran—
scripts, except the one that has the highest simulated abundance.
We ran both MITIE and Cuﬂlinks, given only this one annotated
transcript and the RNA—Seq reads from a larger set of transcripts
to predict transcripts. We compare transcript—level sensitivity and
speciﬁcity of the predictions relative to all known transcripts. We
counted transcripts as being correct, if the intron structure
matched the one of an annotated transcript. Single exon tran—
scripts were counted as being correct if they overlapped with an
annotated single exon transcript. Each prediction was matched
to at most one annotated transcript, and each annotated tran—
script was associated to at most one predicted transcript (cf.
Section Supplementary Section J .1).

The results for one to five samples are shown in Figure 5A.
For Cuﬂlinks, we optimized the hyper—parameters (see
Supplementary Section H) and used two different strategies to
perform predictions. The ﬁrst strategy merged all RNA—Seq
alignments, and the second strategy merged individual
Cufﬂinks predictions for each of the samples with Cuffmerge.
We observe that the latter strategy outperforms the data merge

 

2535

ﬁle'sreumol‘pmJXO'sopeuuopnorq/pdnq

J.Behr et aI.

 

Human Simulated Data

  

 

   

A
0.45 - ..................... ..
""" "  MITIE + MMO
+ MITIE
0 4o _ é-Cufflinks + Cuffmerge
' —x— Cufflinks

 

 

 

F—score on Transcript Level

 

 

 

B
0.37 -

6 .

5

A 0.35 -

.5-

3”; _

E

m

.: 0.33 -

E

o .

9

o _ /

$ 0.31 /’/’ +MIT|E

u. _ A__—-——A -‘r- Cufflinks + Cuffmerge
0.29

 

1 2 3 4 5 6 7
Number of Samples
Fig. 5. (A) Transcript-level F-score as a function of the number of sam-
ples for the simulated human dataset. (B) Transcript-level F-score as a
function of the number of modENCODE samples for up to seven devel-
opmental stages of D.melanogaster

strategy, but both strategies cannot beneﬁt from additional sam—
ples. This is mostly attributed to a drastically decreasing specifi—
city, whereas the sensitivity improves with more samples (cf.
Supplementary Fig. D). MITIE with MMO outperforms the
best Cufﬂinks prediction on average by 6.7 percentage points
in F—score. MITIE/MMO on ﬁve samples is 2.4% more accurate
than with one sample. We observe that the signiﬁcant improve—
ments MM 0 contributes in quantification accuracy to not trans—
late to similarly high transcript recognition improvements. We
attribute this to the robustness of the loss function.

4.2.4 Comparison to Trinity On the same set of simulated reads,
we also compared the core optimization of MITIE to the tran—
script calling method Butterfly, which is part of the Trinity pipe—
line. We ran the entire Trinity pipeline and then generated
MITIE predictions based on the graphs reported by the Trinity
component Chrysalis.

We evaluated the performance of both methods by aligning
predicted mRNA sequences to the annotated mRNA sequences.
A prediction was counted to be correct if (i) it was 5 1% longer
than the annotated transcript and (ii) the region 20 nt upstream
of the first exonaexon junction to 20 nt downstream of the last
exoniexon junction aligned with at most five edit operations to
the reference sequence (For efﬁciency reasons, we ran the entire
experiment for each gene separately on a FASTA ﬁle only con—
taining the simulated reads, as they were simulated from this
genic locus without mismatches.). In its current implementation,
Trinity is not capable of integrating multiple samples. Therefore,
we compared the results using only a single sample. We per—
formed a model selection to tune hyper—parameters of Trinity
and observed that the parameter determining the merging/
splitting behavior of components (imin_glue) strongly influences

 

 

 

 

 

0.9 Human Simulated Data
x MITIE
0.85 o ................. "X 0 Trinity
3‘ O . . . . . . . . . . . . . . . . . . . ..x
3;» 0.8
'6
£0.75 
0.7  ,.
0.65 ‘ I ‘ ‘
0.4 0.45 0.5 0.55 0.6
Sensitivity

Fig. 6. Cycles show a subset of Trinity model selection runs. We selected
the best performing predictions for different trade-offs of sensitivity and
speciﬁcity. We ran M I TIE predictions on the De Bruijn graphs generated
by trinity. Dotted lines connect the corresponding predictions

the performance of Trinity. If 7min _glue 2 1 predictions are more
sensitive but approximately 15 percentage points less speciﬁc
compared to the performance with imin_glue=2 (default). For
both sets of predictions, we selected Pareto—optimal predictions
and ran MITIE on the corresponding graphs. The MITIE core
optimization problem outperforms Butterﬂy significantly in
terms of sensitivity while having similar or higher speciﬁcity
(cf. Fig. 6).

As Trinity applies stringent filtering in the Inchworm step, the
obtained segment graph does not contain all true transcripts.
From our results on genome—based assembly, we expect even
higher performance gains with a more sensitive graph generation
algorithm. Furthermore, we expect improvements from multiple
samples, which can theoretically be used in the same way as in
genome—based assembly.

4.3 Application to modENCODE RNA-Seq libraries

4.3.1 Setup To show that the performance improvements we
have seen on simulated data translate to large—scale experimental
datasets, we applied MITIE to a dataset of seven developmental
stages of D.melanogaster (550 M alignments from 38 RNA—Seq
libraries for seven developmental stages). We filtered the
modENCODE D.melanogaster genome annotation (available
from the MITIE website) for genes with at least two annotated
transcripts. We then randomly removed one transcript variant (a
transcript differing in splice structure to all other transcripts),
which had a non—zero Cuﬂlinks quantiﬁcation value. We dis—
carded genes where no such transcript could be found. From
the remaining genes, we randomly selected 1000 genes for tuning
the hyper—parameters and 1000 genes for testing. This setup
retrospectively simulates the identification of new transcripts in
already well—annotated genomes (as in Section 4.2.3).

4.3.2 Results We evaluated the sensitivity of MITIE and
Cuﬂlinks based on the omitted transcripts and the specificity
with respect to all annotated transcripts. Figure 5B shows a com—
parison of the F—score as a function of the number of samples.
MITIE outperforms the best (in terms of F—score) Cuﬂlinks pre—
diction in sensitivity and speciﬁcity. Similar to the simulated
data, the merge of the Cufﬂinks predictions using Cuﬂmerge sig—
niﬁcantly outperforms the Cuﬂlinks prediction on merged data
(not shown). Although having a similar performance for large
sample numbers, MITIE has a much higher F—score on up to ﬁve

 

2536

ﬁle'sreumol‘pmJXO'sopeuuopnorq/pdnq

MITIE: Transcript identification and quantification in multiple samples

 

samples. This is mostly due to a higher sensitivity at a similar
speciﬁcity.

We estimate the runtime for Cuﬂlinks and MITIE for genome—
wide predictions and obtain four and 19 CPU hours for one
sample, respectively (see Supplementary Section E for details).
Using multiple samples significantly increases the computing
time as well as the accuracy. Future releases of the software
will provide more efﬁcient strategies and implementations.

As we used the alignment ﬁles provided by Celniker et a1.
(2009), we had no control over the quality or sensitivity of the
alignments and multi—mapper resolution. Our results on
simulated data let us expect an even higher performance for
more sensitive alignments and appropriate multi—mapper
handling.

5 CONCLUSION

The transcript prediction problem is typically under—determined.
One important consequence of this observation is that deeper
sequencing only helps to reduce the variance of abundance esti—
mation and to close gaps in the splicing graph, but it does not
solve the transcript identiﬁcation problem as such. The proposed
method reduces the set of solutions by leveraging quantitative
information and multiple RNA—Seq samples combined with mild
biologically plausible assumptions. Furthermore, prior informa—
tion can be taken into account in a direct way within a single
optimization problem, which we think will turn out particularly
advantageous for integrating long reads from third—generation
sequencing platforms with RNA—Seq data.

Our results highlight the importance of a well—motivated loss
funcﬁgn to penalize the read count deviation. The application of
the NB—loss signiﬁcantly improved our quantification and tran—
script recognition results, while it comes at nearly zero additional
computational cost.

The underlying assumption of previously published transcript
calling strategies like Cuﬂlinks and Trinity is correctness and
completeness of the graphs. Achieving both at the same time is
challenging and typically not possible. This results in either
wrong transcript predictions that have to be ﬁltered out heuris—
tically or in fragmented transcript predictions. MITIE assumes
completeness of the graph, but not correctness. Completeness
can often be achieved by not filtering the input alignments or
not pruning the assembly graph. The decision of filtering can be
deferred to the optimization problem that may choose to discard
information in a context—dependent way. This is conceptually
more attractive than global and uninformed filtering as a pre—
processing step.

MITIE finds a solution that is compatible to the overall
observed read data. As observed on simulated and real world
RNA—Seq data, MITIE pushes the boundaries of what can be
observed from RNA—Seq data toward more complex mixtures of
transcripts by leveraging variability between samples. These im—
provements come with the downside of higher computational
costs; however, the vast majority of cases can be optimally
computed within seconds, and our implementation provides op—
tions for approximations in cases where exact computations are
too expensive. Furthermore, our experiments clearly show that
we can obtain the same performance as competing methods with

only a fraction of the data, which in turn can save the time,
money and storage capacity of deeper sequencing.

MITIE allows us to pool information from different samples
in an effective way. This conceptual improvement will further
future RNA—Seq studies; rather than spending efforts into deep
sequencing of a few samples, future studies will have the choice
to investigate a larger variety of samples at a lower depth. The
combination of these samples allows us to obtain more conﬁdent
transcript predictions in each sample and more insights into the
biological questions at the same time.

ACKNOWLEDGEMENTS

The authors thank Regina Bohnert, Georg Zeller, Gabriele
Schweikert, Nora Toussaint, Angel Rubio, Michael Brudno
and Cenk Sahinalp for fruitful discussions. They are thankful
to Georg Zeller, David Kuo, Katharina Hoff and Nora
Toussaint for proof—reading parts of the manuscript.

Funding: German Research Foundation (grants RA1894/1—1 and
RA1894/2—1), the Sloan—Kettering Institute and the Max Planck
Society.

Conﬂict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol, 11, R106.

Anders,S. et al (2012) Detecting differential usage of exons from RNA—seq data.
Genome Res., 22, 200872017.

Bahn,J.H. et al (2012) Accurate identiﬁcation of a—to—i rna editing in human by
transcriptome sequencing. Genome Res., 22, 142750.

B0hnert,R. (2011) Computational methods for high—throughput genomics and tran—
scriptomics. Ph.D. Thesis, Eberhard Karls Universitat, Tubingen. http://tobias—
lib .uni—tuebingen.de/v011texte201 1/5918/pdf/Dissertati0n_Regina_B0hnert.pdf.

B0hnert,R. et al (2009) Transcript quantiﬁcation with RNA—Seq data. BMC
Bioiip’ormatics, 10 (Suppl. 13), P5.

Bradley,R.K. et al (2012) Alternative splicing of RNA triplets is often regulated and
accelerates proteome evolution. PLoS Biol, 10, e1001229.

Celniker,S. et al (2009) Unlocking the secrets of the genome. Nature, 459, 9277930.

Coffey,A.J. et al (2011) The gencode exome: sequencing the complete human
exome. Eur. J. Hum. Genet., 19, 827731.

De B0na,F. et al (2008) Optimal spliced alignments of short sequence reads.
Bioiip’ormatics, 24, il744180.

Denoeud,F. et al (2008) Annotating genomes with massive—scale RNA sequencing.
Genome Biol, 9, R175.

D0bin,A. et al (2012) Star: ultrafast universal RNA—Seq aligner. Bioinformatics, 29,
15721.

Drewe,P. et al (2012) Accurate detection of differential rna processing. Nucleic
Acids Res., 41, 518975198.

ENCODE Project Consortium et al (2012) An integrated encyclopedia of dna
elements in the human genome. Nature, 489, 57774.

Flicek,P. et al (2012) Ensembl 2012. Nucleic Acids Res, 40, D84~D90.

Grabherr,M.G. et al (2011) Full—length transcriptome assembly from RNA—Seq
data without a reference genome. Nat. Biotechnol, 29, 644$52.

Griebe1,T. et al (2012) Modelling and simulating generic RNA—Seq experiments
with the flux simulator. Niwleic Acids Res., 40, 10073710083.

Guttman,M. et al (2010) Ab initio reconstruction of cell type—speciﬁc transcrip—
tomes in mouse reveals the conserved multi—exonic structure of lincRNAs. Nat.
Biotechnol, 28, 5037510.

Harrow,J. et al (2006) Gencode: producing a reference annotation for encode.
Genome Biol, 7 (Suppl. 1), S4179.

Heber,S. et al (2002) Splicing graphs and est assembly problem. Bioinformatics, 18
(Suppl. 1), 518175188.

 

2537

ﬁm'spzumofprqxo'sopeuuowrorq/pdnq

J.Behr et al.

 

Hi11er,D. and Wong,W. (2012) Simultaneous isoform discovery and quantiﬁcation
from RNA—Seq. Stat. Biosci., 1719.

Huelsenbeck,J.P. and Crandall,K.A. (1997) Phylogeny estimation and hypothesis
testing using maximum likelihood. Anna. Revi. Ecol. Svst., 28, 4374166.

Jean,G. et al. (2010) RNA—Seq read alignments with palmapper. Curr. Protoc.
Bioinform., 32, 1161711638.

Katz,Y. et al. (2010) Analysis and design of ma sequencing experiments for iden—
tifying isoform regulation. Nat. Methods, 7, 100971015.

Lacroix,V. et al. (2008) Exact transcriptome reconstruction from short sequence
reads. In: Proceedings of the 8th International Workshop on Algorithms in
Bioinformatics. WABI ’08. Springer—Verlag, Berlin, Heidelberg, pp. 50$3.

Li,W. et al. (2011) Isolasso: a lasso regression approach to RNA—Seq based tran—
scriptome assembly. In: Bafna,V. and Sahinalp,S. (eds) Research in
Computational Molecular Biology. Vol. 6577, Lecture Notes in Computer
Science. Springer, Berlin Heidelberg, pp. 1687188.

Lin,Y.Y. et al. (2012) Cliiq: accurate comparative detection and quantiﬁcation of
expressed isoforms in a population. In: Raphael,B. and Tang]. (eds) Algorithms
in Bioiip’ormatics. Vol 7534 Lecture Notes in Computer Science. Springer, Berlin,
Heidelberg. pp. 1787189.

Mezlini,A.M. et al. (2012) iReckon: simultaneous isoform discovery and abundance
estimation from RNA—Seq. Genome Res., 23, 5197529.

Mortazavi,A. et al. (2008) Mapping and quantifying mammalian transcriptomes by
RNA—Seq. Nat. Methods, 5, 621$28.

Nelder,J. and Wedderburn,R. (1972) Generalized linear models. J. R. Stat. Soc. 135,
375

Nilsen,T.W. and Graveley,B.R. (2010) Expansion of the eukaryotic proteome by
alternative splicing. Nature, 463, 4577463.

Rasko,D.A. et al. (2011) Origins of the e. coli strain causing an outbreak of hemo—
1ytic—uremic syndrome in Germany. N. Engl. J. Med., 365, 709717.

Rasmusen,C.E. and Nickisch,H. (2010) Gaussian processes for machine learning
(gpml) toolbox. J. Mach. Learn. Res., 11, 301173015.

Ratsch,G. et al. (2007) Improving the caenorhabditis elegans genome annotation
using machine learning. PLoS Comput. Biol, 3, e20.

Robertson,G. et al. (2010) De novo assembly and analysis of RNA—Seq data. Nat.
Methods, 7, 9097912.

Schulz,M.H. et al. (2012) Cases: robust de novo RNA—seq assembly across the
dynamic range of expression levels. Bioinformatics, 28, 108G1092.

Schweikert,G. et al. (2009) mGene: accurate SVM—based gene ﬁnding with an ap—
plication to nematode genomes. Genome Res., 19, 213%2143.

Shai,O. et al. (2006) Inferring global levels of alternative splicing isoforms using a
generative model of microarray data. Bioinformatics, 22, 606713.

Simpson,J.T. et al. (2009) ABySS: A parallel assembler for short read sequence data.
Genome Res., 19, 111771123.

Smith,L. et al. (2012) Multiple insert size paired—end sequencing for deconvolution
of complex transcriptomes. RNA Biol, 9, 596—609.

SnoekJ. et al. (2012) Practical bayesian optimization of machine learning algo—
rithms. Technical Report arXiv: 1206.2944, arXiv.

Sonnenburg,S. et al. (2007) Accurate splice site prediction using support vector
machines. BMC Bioinformatics, 8 (Suppl. 10), S7.

Trapnell,C. et al. (2009) TopHat: discovering splice junctions with RNA—Seq.
Bioiip’ormatics, 25, 110571111.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA—Seq re—
veals unannotated transcripts and isoform switching during cell differentiation.
Nat. Biotechnol, 28, 5117515.

Wang,H. et al. (2003) Gene structure—based splice variant deconvolution using a
microarry platform. Bioinformatics, 19 (Suppl. 1), i3157i322.

Wang,Z. et al. (2009) RNA—Seq: a revolutionary tool for transcriptomics. Nat. Rev.
Genet., 10, 57%}

Wang,K. et al. (2010) MapSplice: Accurate mapping of RNA—seq reads for splice
junction discovery. Niwleic Acids Res., 38, e178.

Wu,T.D. and Nacu,S. (2010) Fast and SNP—tolerant detection of complex variants
and splicing in short reads. Bioinformatics, 26, 873781.

Xia,Z. et al. (2011) NSMAP: a method for spliced isoforms identiﬁcation and quan—
tiﬁcation from RNA—Seq. BM C Bioinformatics, 12, 162.

Xing,Y. et al. (2004) The multiassembly problem: reconstructing multiple transcript
isoforms from est fragment mixtures. Genome Res., 14, 426—441.

 

2538

ﬁle'sreumofpmjxo'sopeuuqurorq/pdnq

