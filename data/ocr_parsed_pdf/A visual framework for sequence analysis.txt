ORIGINAL PAPER

Vol. 26 no. 6 2010, pages 737-744
doi: 1 0. 1 093/bioinformatics/btq042

 

Sequence analysis

Advance Access publication February 3, 2010

A visual framework for sequence analysis using n-grams and

spectral rearrangement

Stefan R. Maetschkelazl, Karin S. Kassahnlazal, Jasmyn A. Dunn‘, Slew-Ping Han3,
Eva Z. Curleyl, Katryn J. Stacey“3 and Mark A. Raganlagi‘

1Institute for Molecular Bioscience, 2ARC Centre of Excellence in Bioinformatics and 3School of Chemistry and
Molecular Biosciences, The University of Queensland, Brisbane QLD 4072, Australia

Associate Editor: Limsoon Wong

 

ABSTRACT

Motivation: Protein sequences are often composed of regions that
have distinct evolutionary histories as a consequence of domain
shuffling, recombination or gene conversion. New approaches are
required to discover, visualize and analyze these sequence regions
and thus enable a better understanding of protein evolution.
Results: Here, we have developed an alignment-free and visual
approach to analyze sequence relationships. We use the number
of shared n-grams between sequences as a measure of sequence
similarity and rearrange the resulting affinity matrix applying a
spectral technique. Heat maps of the affinity matrix are employed
to identify and visualize clusters of related sequences or outliers,
while n-gram-based dot plots and conservation profiles allow
detailed analysis of similarities among selected sequences. Using
this approach, we have identified signatures of domain shuffling in
an otherwise poorly characterized family, and homology clusters in
another. We conclude that this approach may be generally useful
as a framework to analyze related, but highly divergent protein
sequences. It is particularly useful as a fast method to study
sequence relationships prior to much more time-consuming multiple
sequence alignment and phylogenetic analysis.

Availability: A software implementation (MOSAIC) of the
framework described here can be downloaded from
http://bioinformatics.org.au/mosaic/

Contact: m.ragan@uq.edu.au

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 14, 2009; revised on January 14, 2010;
accepted on January 27, 2010

1 INTRODUCTION

Eukaryotic proteins often evolve in a modular fashion, acquiring
protein domains from related or unrelated sequences via domain
shufﬂing and non-homologous recombination (Patthy, 1999;
Schmidt and Davies, 2007; Vogel et al., 2004). In this way,
protein families can gain or lose protein domains over time.
Domain shufﬂing is a prominent feature of eukaryotic genomes

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion. the ﬁrst two authors
should be regarded as joint First Authors.

(Kaessmann et al., 2002), resulting in many sequences having
composite evolutionary histories (Vogel et al., 2004). Here, we use
the term reticulate to refer to these types of sequence relationships,
which resemble a network rather than a hierarchical, tree-like
structure. To date there have been few systematic attempts to
identify and characterize reticulate sequence relationships within
individual protein families; exceptions include the Markov clusters
of homologous subsequences (Wong and Ragan, 2008), the use
of intron phase as a signature of domain shufﬂing (Kaessmann
et al., 2002), and comparison of domain combinations across animal
taxa (Kawashima et al., 2009). Nonetheless, the signiﬁcance of the
modular nature of protein evolution remains largely unexplored.
In prokaryotes, lateral genetic transfer can as well create novel
recombinant sequences that are composed of subsequences of
distinct evolutionary origin (Chan et al., 2009). Identifying reticulate
sequence relationships is difﬁcult with established methods.

At present, the predominant approach for studying protein
sequence relationships is based on multiple sequence alignment
and phylogenetic inference (Baldauf, 2003), but the phylogenetic
analysis of large protein families is computationally expensive,
and protein families that have been subject to domain shufﬂing
do not lend themselves to a tree-based representation. A number
of efforts have thus explored phylogenetic network representations
in order to better capture reticulate sequence relationships (Bryant
and Moulton, 2004; Cardona et al., 2008; Makarenkov, 2001), but
these diagrams are difﬁcult to interpret for larger families and more-
complicated reticulate relationships, and the inference of network
topologies is even more computationally expensive than of trees.

In this context, spectral clustering offers an attractive alternative
for ﬁnding related sequences via clustering (Ng et al., 2001;
Shi and Malik, 2000). Based on the eigenvector decomposition
of a similarity matrix, it has already been used successfully
to cluster biological sequence data utilizing BLAST similarity
scores (Pentney and Meila, 2005). Furthermore, spectral clustering
performed favorably in comparison to three other, single-linkage
clustering algorithms when applied to cluster sequences from the
SCOP database based on BLAST scores (Pentney and Meila, 2005).
Similarly, Paccanaro et al. (2006) performed spectral clustering on
sequences extracted from SCOP to group homologous sequences,
but again relied on BLAST alignments and E-values to measure
sequence similarity.

Alignment-free approaches, in contrast, offer considerable
speed advantages and avoid problems associated with sequence
rearrangements and the modular makeup of eukaryotic proteins.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 737

112 /3.Io's[Bumo[p.IOJxosouBuJJOJurorq”:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

S.R.Maetschke et al.

 

Alignment-free approaches can be based on comparisons using
n-mers, words or patterns, with the former having speed advantages
over the latter two (Vinga and Almeida, 2003). Importantly,
alignment-free approaches can provide accurate estimates of genetic
distance (Hohl and Ragan, 2007; Hohl et al., 2006).

There is thus an opportunity for the development of new
approaches to study sequence relationships, especially approaches
that can help identify and explain reticulate sequence relationships
that reﬂect the modular nature of protein evolution. Here, we have
developed a fast and interactive visual framework for exploring
sequence relationships and introduce an alignment-free measure
of sequence similarity, which can be applied to a broad set
of data types, not only sequences but also structural data. The
proposed framework can serve as a basis for more-informed and
more-accurate phylogenetic analysis.

2 SYSTEM AND METHODS

Our method computes sequence similarities based on the number of
shared short subsequences (rt-grams) and organizes the resulting similarity
scores within an ordered matrix. Employing a spectral technique. the
rows and columns of the afﬁnity matrix are rearranged to allow
the Visual identiﬁcation of outliers. clusters of related sequences and
reticulate relationships. We furthermore extend the n-gram-based approach
and present algorithms to generate dot plots and conservation proﬁles.
A software implementation of this framework (MOSAIC) is available at
http://bioinformatics.org.au/mosaic/.

2.1 Sequence similarity

We deﬁne a sequence. X, as a tuple of N symbols. 01,». from a ﬁnite alphabet L.
s=(a1,...,aN)withaieL, (1)

where L may be any alphabet of interest. composed of amino acid. DNA.
RNA or secondary structure symbols for instance. To calculate the similarity
between sequences. we represent sequences by their n-grarn sets and compare
these sets. An n-gram is herewith deﬁned as a subsequence of length n
extracted from a sequence X at position i

n-grami(s)= (01,», . . . ,Oli-l—n—I )7 (2)

and for each sequence we construct the set S of overlapping but unique
n-grams as

S(s)={n-grami(s)|Vie1...N—n+1}. (3)

The n-gram similarity a between two sequences s1 and s2 and their
corresponding n-gram sets S1 =S(s1) and S2 =S(s2) is calculated as

lSlﬂS2l

—, 4
min(|51|.|52|) ( )

0(s1 ,s2)=
with a being the proportion of n-grams shared by both sequences relative to
the smaller n-grarn set. Note that a is always in the interval [0. . . 1] and that
n-gram similarity. in contrast to BLAST scores. is a symmetric similarity
measure. Replacing the min(.) operator by the max(.) operator leads to
a sequence comparison resembling the differences between a local versus
global alignment. Section 6 of the Supplementary Material explains the effect
in more detail.

The simplicity of the sequence similarity measure as deﬁned in
Equation (4) ensures interpretability of results and fast computation.
Speciﬁcally. its computation time scales linearly with sequence length.
For sequences with a length distribution similar to that of the sequences
analyzed here. simulations show that n-grarns (on average) are essentially
unique for n> 3 within amino acid sequences and for n> 6 in DNA/RNA

sequences (Supplementary Material. Section 5). and thus represent useful
units for comparisons of sequence similarity. We found that for amino
acid sequences an n-gram size of four and for DNA sequence an n-gram
size of 12 represent a suitable trade-off between speciﬁcity and sensitivity
(Supplementary Material. Section 4).

2.2 Spectral rearrangement

Typically. spectral clustering algorithms operate on points in Euclidean space
as input. calculate pairwise distances. and perform a spectral decomposition
of the afﬁnity matrix derived from point distances. The resulting eigenvectors
(or parts thereof) are evaluated by k-means to identify clusters within the
input data (Ng et al.. 2001; Shi and Malik. 2000). The MOSAIC framework
employs spectral clustering with two signiﬁcant differences.

First. instead of the Euclidean metric between points. n-gram similarity
between sequences is calculated. This. however. requires that n-gram
similarities a(.vi,.vj) are transformed into distances d(.vi,.vj). which is readily
achieved as follows:

d(.vi,.vj)=1—a(.vi,.vj). (5)

Second. we eliminate the ﬁnal k-means step of spectral clustering but
instead rearrange the rows and columns of the afﬁnity matrix in a way
that brings similar sequences together and allows the Visual identiﬁcation
of clusters. outliers and other special cases. This spectral rearrangement
avoids a decision upon the exact number of clusters to detectia decision
that is typically difﬁcult to make a priori. Furthermore. in case of reticulate
events. ﬁxing the number of clusters does not appropriately describe the
underlying sequence relationships.

Following Ng et al. (2001) and Shi and Malik (2000). we construct an
afﬁnity matrix A from all pairwise distances d(.vi,.vj). which accentuates the
local neighborhood of sequences within the n-gram similarity space

AU 2 e—d(s,',xf)‘/2r‘ ’ 

with r being the neighborhood radius of a Gaussian kernel that controls
how rapidly the afﬁnity AU- between sequences s, and sj decreases. Then the
Laplacian L of A is computed as

L=B—A, (7)

with B: diag(zk aik) being a diagonal matrix constructed from the row or
column sum of the afﬁnity matrix.

Note that there are alternative ways to construct the Laplacian (von
Luxburg. 2007) such as the normalized (L=I —B_1A) or the symmetric
Laplacian (L=I—B_l/2AB_l/2). and the MOSAIC software allows one to
switch between them.

Finally. the Laplacian is decomposed into its eigenvectors V and
eigenvalues e. The eigenvector v2. belonging to the second smallest
eigenvalue e; of the Laplacian. is called the F iea’ler vector and is indicative
of the cluster structure of the matrix (Fiedler. 1975). By reordering the row
and columns of D according to the magnitude of its components. related
sequences are grouped together.

Figure 1 shows the afﬁnity matrices and the corresponding Fiedler vectors
before (left) and after (right) spectral rearrangement for a set of 36 steroid
hormone receptor sequences. composed of four families [mineralocorticoid
receptor (MR). glucocorticoid receptor (GR). progesterone receptor (PR)
and androgen receptor (AR)]. The relative phylogenetic position of the four
steroid receptor types and which is the most-ancestral receptor type is a
topic of current research (Hu et al.. 2008). The MOSAIC plot does not resolve
this ambiguity. but does correctly cluster sequences that belong to the same
family. The Fiedler vector (Figure 1d) allows one to assess objectively how
well the four clusters are separated. Larger steps within the Fiedler vector
indicate more robust clusters. For instance. sequences belonging to the MR
family are clearly less distinguishable from sequences belonging to the GR
family than from members of the AR family. Importantly, this comparison
could be made using full-length receptor sequences as opposed to using only
selected. conserved domains.

 

738

112 /3.Io's[Bumo[p.IOJxosoueuIJOJurorq”:duq urorj papeolumoq

9103 ‘{g Isnﬁnv 110::

MOSAIC

 

 

 

 

 

 

 

 

 

 

 

MR_Xt
MR_Mm
MRiGg
MR_Ec

MR Hs
MR Pt

MR Md

3
:a
3

MR Dr
GR H5

0
:u
2

GR Mm
GR Ec
GR Bt
GR Md
GR_Gg
GR_Xt
GRiDr
PR_Dr
PﬁiMm
PR_Ec
PRiMd
PR_H5
PRiPt
PRJt
PR_Gg
PR_Xt
ARiGg
ARiHs
AR Md
AR Et
AR Mm

 

1w
:1
:5!

AR EC
AR Xt
AR Dr

 

 

 

 

 

 

 

§§§55535555§555§35ggggggggjggagggggg

Ens:Ezziszzuogowuuoomglanllae<<§<§<<<<
(d)o.
0.4
0.3
0.2
0.1
0.0
-o.1_
-O.z

O 5 10 15 20 25 30 35

Fig. 1. Spectral rearrangement (non-recursive) of four families of steroid hormone receptors. Top row shows the afﬁnity matrix before (a) and after (h)
spectral rearrangement. Bottom row shows the labeled corresponding Fiedler vectors before (c) and after (d) spectral rearrangement. For ease of comparison.
sequences belonging to the same receptor family are in the same color. Bt. Bos taurus; Dr. Danio rerio; Ec. Equus caballus; Gg. Gallus gallus; HS. Homo
sapt'ens; Md. Monoa'elphis domestica; Mm. Mus musculus; Pt. Pan troglodytes; Xt. Xenopus tropicalis.

For families with more than two clusters. the clustering is improved
considerably by performing a recursive spectral rearrangement. In such a
case. the afﬁnity matrix is spectrally rearranged as before but then split
into two smaller sub-matrices. for which the spectral rearrangement is
applied recursively. The split position (row/column index) is derived from
the position where the Fiedler vector changes its Sign (normalized cut: Shi
and Malik. 2000). The recursion terminates when either the components of
the Fiedler vector are all of the same Sign (indicating a uniform cluster) or
the sub-matrices are reduced to two rows/columns (for further details see
Supplementary Material).

2.3 n-Gram dot plots

While the overall relationships among multiple sequences can be Visualized
utilizing the spectral approach outlined above. it is frequently of interest to
analyze the similarity between two speciﬁc sequences in more detail. For
this purpose. we extend the traditional concept of a dot plot from individual
nucleotides or amino acids to n-grams. Let M: [mm] be a matrix that
represents the dot plot. then a dot will be drawn if n-grams at positions 1'
and j for two sequences s1 and s2 match (Fig. 2)

1 if n-grarni(s1)= n-gramj(s2)
m» - =
1’] 0 otherwise (3)

Vi,jel...N—n+1.

MSKRRMQQVTQ

MRRKMRRKSM

 

Fig. 2. n-Gram dot plot. Matching n-grams (of size four) that occur in both
sequences are indicated by horizontal and vertical lines outside the dot plot
and by ﬁlled squares within the dot plot. Due to an n-grarn size of four the
last three rows and columns of the plot are empty.

While dot plots for single symbols are typically noisy due to many cross-
matches. dot plots for n-grams of reasonable size (n 33) are comparatively
‘clean’. since n-grarns of a sequence are largely unique within the sequence.
For longer sequences. the sparseness of the dot plot has a negative impact on

 

739

112 /3.Io's[Bumo[p.IOJxosoueuIJOJurorq”:duq urorj papeolumoq

9103 ‘{g isnﬁnv 110::

S.R.Maetschke et al.

 

 

 

 

 

 

 

 

1 KERE. AARC I
12 I I '
2 ( KERE E AARC ,
18 ' I
3 ( AARC )
4 ‘ KER'E WIF EAARC’

 

frequency

   

median posiuan

Fig. 3. Illustration of proﬁle generation. Four sequences and some matching
4-grams are shown at the top. ‘AARC’ is conserved at homologous positions
in all four sequences. an n-gram ‘KERE’ is conserved in three sequences.
and ‘VVIF’ occurs only in one sequences. The proﬁle shown at the bottom
is basically the frequency plot of the most frequently occurring n-grams at
homologous positions.

its readability. We therefore construct a compressed matrix representation
M’ =[milgr] of the dot plot that averages over sub-matrices of size c><c
within M

6—1 6—1

, 1
mq.r=C_2§ E Mq-c—i.r-c—j

1:0 1:0 (9)
Vq,re 1...N/c.

Note that the sub-matrices are not overlapping and that the values of
M’ are not binary anymore. but give a representation of the density of
n-gram matches within a sub-matrix. Section 3.3 shows several examples
of compressed dot plots.

2.4 n-Gram proﬁles

As a further means to investigate the relationships within a set of sequences
Visually we compute n-gram proﬁles. which are similar to traditional
conservation proﬁles but combine n-grarns and alignment-free methods in a
novel way. The method relies on the assumption that n-grams with n 3 3 are
generally unique within a single sequence but occur at coherent positions in
homologous sequences.

For a given set of sequences. we extract the n-grams that appear in one
or more sequences and record their sequence positions (matching n-grarns).
For instance. n-gram ‘KERE’ may appear at position 12 in sequence 1. at
position 18 in sequence 2 and position 13 in sequence 4 but not in sequence 3
(Fig. 3). We then plot the frequency of matching n-grams over their mean
positions.

More formally. let C be the set of sequences over which the n-grarn proﬁle
is to be calculated. We deﬁne F(n-gram) as the mean position at which the
n-gram occurs in all sequences in C. Furthermore. we deﬁne N(n-gram)
as the number of sequences in C in which the n-gram occurs. The n-gram
proﬁle is generated by plotting the n-gram frequency N (n-grarn) over the
mean position F(n-gram) at which the n-gram occurs.

The resulting graph is. however. noisy and two reﬁnements are employed.
First. for a speciﬁc position int(F) we display only max(N). which is the
frequency of the most frequent n-gram at that position. and use the int(-)
function to map a mean position to its nearest integer value. Second. we
smooth the graph by applying a mean ﬁlter.

Figure 4 displays the n-grarn proﬁle (n24) over 36 sequences of steroid
hormone receptors (same set as used for Fig. 1). Common to steroid hormone
receptors are a highly conserved DNA-binding domain (DBD) consisting of
two zinc-ﬁnger motifs. and a more-variable ligand binding domain (LDB)
close to the C-terminus (Whitﬁeld et al.. 1999). These two domains can
easily be identiﬁed within the proﬁle. Considerably less conserved (Lavery

In

 

16

14

12

10

 

 

 

0 200 400 00 800 1000

 

 

 

 

 

AF-1 DBD LBD

Fig. 4. Proﬁle for steroid hormone receptors. The top graph shows the
4-grarn proﬁle derived from 36 steroid hormone receptors sequences. The
known domain architecture is illustrated below.

and McEwan. 2005) but still Visible is the transactivation function domain
(AF-1) within the N-terminal section.

3 RESULTS

3.1 Parameter optimization

The approach presented here requires the choice of two parameters,
the width r of the Gaussian kernel and the n-grarn size n. There is
no efﬁcient method to determine r optimally and various rules of
thumb are in use. We found that a simple heuristic that sets r to the
mean value of the elements of the distance matrix D usually leads
to good clustering results.

To optimize the n-gram size, we performed three different
types of experiments (Supplementary Section 4): (i) we calculated
the correlation between n-gram sequence similarity and species
divergence times for a range of sequence sets; (ii) we used a range
of protein families of varying relatedness to determine the n-gram
size at which the standard deviation of the elements of the distance
matrix is maximized; and (iii) we determined the area under the ROC
curve (AUC) when distinguishing between related and randomly
shufﬂed sequences using n-grarn similarity. In all three experiments,
we found that an n-grarn size of four was generally a good choice
for protein sequences, and that an n-gram size of 12 was usually
appropriate for DNA and RNA sequences.

3.2 Application to known cases of gene conversion

To study reticulate protein sequence relationships, we applied our
approach to a number of families that are known to have been
subject to gene conversion. In these cases, gene conversion was
identiﬁed on the basis that, at least for part of the gene sequence,
gene duplicates within a genome were more similar to each other
than to their orthologs in related species (e.g. Annilo et al., 2003;
Kruithof et al., 2007; Perelygin et al., 2008).

We used these protein families to test whether our approach was
sensitive enough to identify these known reticulate subsequence
relationships, and whether n-grarn composition and spectral
rearrangement provided biologically meaningful results. One
of these families included the toll-like receptors, TLR1 and
TLR6 (Kruithof et al., 2007). Importantly, our approach correctly

 

740

112 /3.Io's[Bumo[p.IOJxosoueuIJOJurorq”:duq urorj papeolumoq

9103 ‘{g isnﬁnv 110::

MOSAIC

 

grouped orthologs, so that mammalian TLR1 and TLR6 sequences
formed distinct clusters, while the two mouse receptors TLR1 and
TLR6 which had been previously identiﬁed as having been subject
to gene conversion formed a cluster of their own (Supplementary
Fig. 1).

Dot plots visualizing pairwise sequence relationships identiﬁed
a subsequence in TLR1 and TLR6 that shared greater similarity
between these mouse paralogs than with their respective orthologs
in other mammals, a signature characteristic of gene conversion
(Supplementary Fig. lc—e). MOSAIC can thus detect subsequence
relationships indicative of gene conversion.

3.3 Application to families that present challenges for
alignment-based approaches

The ﬁrst family is the mammalian HIN-200 protein family, with
critical roles in the response to cytoplasmic DNA (Roberts et al.,
2009). Phylogenetic analysis of this family is complicated by the
presence of highly divergent, ‘un-alignable’ sequence stretches
between two conserved protein domains, the pyrin and HIN
domains.

Here, we used MOSAIC to gain insight into the sequence
relationships within this family. n-Gram composition and spectral
rearrangement of sequence similarity indicated the presence of
several sub-clusters within this family (Fig. 5a). Some of these
clusters are well supported, such as the cluster containing the
human and mouse Aim2 sequences. Clusters A and B, in contrast,
show poor deﬁnition (Fig. 5a and b). For example, while p203
and p212 belong to clusters A and B, respectively, they both
share sequence components with p204 (Fig. 6b and d). Pairwise
sequence comparisons using dot-plots revealed reticulate sequence
relationships. For example, p203 is a composite of subsequences that
match p204 and p212, while p212 is a composite of subsequences
that match p204 and p203 (Fig. 60), suggesting domain shufﬂing
between family members. Two other sequences in cluster B, p209
and p214, share high sequence similarity across almost the full
length of the protein, indicating very recent duplication (Fig. 7).

Another set of proteins that poses challenges for phylogenetic
analysis includes the hnRNP proteins, a heterogeneous group of
nuclear proteins that regulate transcription and splicing (Dreyfuss
et al., 1993). While these sequences are often grouped as a family,
variation in domain content raises doubts over whether members of
this family are truly homologous, and multiple sequence alignment
is difﬁcult for these sequences (S.P. Han and Y.H. Tang, manuscript
in preparation). Using our approach, we identiﬁed several clusters
of putatively related sequences (Supplementary Fig. 2). Beyond
these ‘homology clusters’, we found very little similarity between
sequences, suggesting that a revision of the so-called hnRNP family
is warranted to exclude non-homologous sequences.

4 DISCUSSION

We present here a framework to analyze sequence relationships that
consists of three basic elements: n-grarn-based sequence similarity
measurement, spectral decomposition and afﬁnity matrix reordering.
These elements in combination yield distinctive advantages for
identifying composite evolutionary histories in protein sequences in
comparison to traditional methods, such as hierarchical clustering
based on BLAST scores.

 

Dog_i
Horseiii
MouseJZOZ
Human_AlM2
Chimpanzee_iv
Horse_i

Ratii
Mause_p210
Opossum_i
Mouse_p203
Mouse_p213
Mouseipzoﬁ
Rat_iv

Rat,“
Human_MNDA
Chimpanzeeiiii
Human_lFl16
Chimpanzee_i
chimpanzee,“
Human_lFlX
Horseiiii
Cow_i
MnusejZlZ
Mouse £205
Rat_iii

Mouse 9211
Mouse_p204
Mouse_p207
Mouse_p209
Mause_p214
Mouseip203

 

 

 

 

Chimpanzee_iv
m_i

Horse i
Rat i

Chimpanzee_iii

Chimpanzee_i

Horse iii

Cowgi
Mouse_leZ

Mnuse_p205

Rat iii

Mouse_p211

MOUSELpZO4
Mouse_pZO7
MouseJZOS
Mouse_le4
Mnuse_p203

Mnuse_leO

Rat ii

Human MNDA

Mouse_pZOZ
Human AIMZ
Mnuse_pZOB
Mousejzla
Mnuse_pZOG
Human IFI16
Chimpanzee_ii
Human IFIX

Opossu
Rat iv

 

 

o4 - -

 

 

 

Fig. 5. MOSAIC plot using recursive spectral rearrangement (a) and Fiedler
vector (b) of the mammalian HIN-200 protein family. The MOSAIC plot shows
many small clusters and an overlap between the weak clusters A and B. HIN-
200 protein sequences were taken from NCBI databases and mouse cDNAs
for uncharacterised proteins p207. p208. p209. p211. p212. p213 and p214
were cloned and sequenced. Sequences are available upon request.

4.1 n-Gram similarity

The n-gram similarity introduced above deﬁnes a symmetric
similarity measure—in contrast to BLAST or Smith—Waterman
scores—, which is an advantageous property for many applications
and speciﬁcally allows us to perform a spectral rearrangement
of the similarity matrix. The n-grarn similarity of two sequences
can be calculated in linear time, while traditional BLAST or
Smith—Waterman sequence alignments are of quadratic order
with respect to sequence length. As an alignment-free method,
n-grarn similarity reports appropriate similarity scores when
classical alignment-based methods fail, e.g. in the case of domain
rearrangement. Furthermore, alignment-free methods have been
shown to perform as well as alignment-based approaches, even
with families that present little challenge to multiple sequence
alignment (Hohl and Ragan, 2007). Finally, our method makes few
assumptions about the processes of evolution and their effects on
sequence similarity. It can be applied equally to amino acid, DNA,
RNA or other types of sequences.

Other possible approaches, such as computing sequence
similarities based on predicted motifs or domains (e.g. via
Pfam and InterPro), suffer from limited coverage (~70%

 

741

112 /3.Io's[Bumo[p.IOJxosoueuIJOJurorq”:duq urorj papeolumoq

9103 ‘{g isnﬁnv 110::

S.R.Maetschke et al.

 

 

 

 

 

 

 

(a) Mouse p212 ([3) Mouse p204
—wnn HINA — - pyrln HINA - HINB -
o s so :5 2n 25 an as o 10 2o —
,, ..—.—P
I I. l 1 1
= . .
g '- E 5
<0 I :0
o n o
(\l (\l 10
a. ___________ _d a.
3 IS 3 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _l
3 3
o o 1
E 2 1° 2 g - l
I i 1
25 1.:
5:!) an, n=4, (=l5 5:015, n=0, (=15 ‘
| 30 I ----------------------------------- -i
(c) (d) Mouse p204
- nyrln HINA - HINB -
oo 10 _o 40
I : .
c . :
1 15 30 E 5 I -
Mouse p212 N : i
v- 10 I '
(\l - :
— Q : '
m 15 _________ _. :
l 15 30 g 'l_ :
o 20 :
— E .
1 15 so ( 25 I
z .
E '- :
3" I:
V ;;&§E:n=1::;1§ V V V 7 V V V 7 V V V 7
I 35

 

 

Fig. 6. Dot plots of selected sequence pairs of the HIN protein family.
Mouse p212 and p203 only share sequence similarity in the ﬁrst part of their
sequence (a). while p203 is similar to p204 in the second half of its sequence
(b). Similarly. p204 is a composite of subsequences that are similar to p203
(b) and p212 (d). The modular makeup of these selected three sequences
is illustrated in (c). suggesting that shufﬂing of subsequences has occurred
between family members. The position of recognized Pfam domains is given
around each dot plot. demonstrating that the subsequences inferred to have
been subject to shufﬂing extend beyond recognized domain boundaries.

Mouse p209
0 5 10 15 20 25

0'.

 

Mouse p214

.
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
u
:
u
25 s=0.82, n=4, c=15 II.

Fig. 7. Dot plot for sequences p209 and p214. The dot plot shows high
n-gram similarity (020.82) for an n-gram size of four over almost the full
length of the two proteins. Note that the dot plot is compressed by a factor
of 15 (c: 15) to allow better recognition of the main diagonal.

 

 

 

for eukaryotic proteomes) and are considerably slower and more-
complex than n-grarn similarity, but may be of higher speciﬁcity.

Note that our method is currently not robust towards point
mutations as only perfect n-grarn matches are counted to measure
sequence similarity. However, n-gram similarity can easily be
extended to more sensitive, similarity measures, e.g. by allowing
n-grams with mismatches, utilizing n-grarns with sub-alphabets or
exploiting n-grams of different sizes. Furthermore, n-grams can
even be derived from secondary or tertiary structure information
to compute similarities between RNA or protein structures.

4.2 n-Gram proﬁles

Traditional sequence alignments such as Smith—Waterman or
Needleman—Wunsch utilize dynamic programming to determine
columns and/or blocks of matching residues in a set of sequences.
From the number of conserved residues within a column, a
conservation proﬁle can be derived to identify positions of high
or low conservation.

The n-gram-based conservation proﬁles proposed here have the
same purpose, but perform n-gram matching in place of dynamic
programming to identify regions of conservation. Furthermore,
apart from identifying identical n-grams in multiple sequences,
no sequence alignment in the traditional sense is required. As a
consequence, our algorithm: (i) has no gap or extension penalties;
(ii) is of linear complexity, whereas dynamic programming is of
quadratic complexity with respect to sequence length; and (iii) can
generate useful proﬁles in situations where traditional alignments
fail—for instance, in the case of domain rearrangement. Note,
however, that an n-gram proﬁle with strong conservation, as shown
in Figure 4, usually implies that there are alignable (sub)sequences.

The n-gram conservation proﬁles presented in this paper are
also different from entropy or complexity proﬁles (Crochemore
and Verin, 1999; Oliver et al., 1993; Troyanskaya et al., 2002;
Vinga and Almeida, 2007). The latter use a sliding-window
approach to determine regions of high or low complexity/entropy
within a single (DNA) sequence. These methods are well-suited
to search for deviation from randomness and aim to identify
functional or regulatory regions, e. g. promoter regions or repetitive
regions within a sequence. Conservation proﬁles, on the other
hand, strive to determine regions of sequence conservation across
multiple (related) sequences. A set of sequences may exhibit very
low complexity/entropy, but still produce very strong (n-gram)
conservation proﬁles.

To summarize, n-gram conservation proﬁles mesh well with
n-grarn similarity and n-gram dot plots. They are alignment-free,
faster to calculate than traditional conservation proﬁles and better-
suited for analysis of complex sequence relationships such as
those caused by reticulate events. On the other hand, n-gram
conservation proﬁles (in contrast to proﬁles based on multiple
sequence alignments) do not allow one to determine the conservation
of individual residues.

4.3 Spectral rearrangement

To identify clusters of related sequences we followed a spectral
approach, which has been shown to be superior to traditional
clustering methods in many applications (Ng et al., 2001).
Speciﬁcally, spectral clustering avoids both the difﬁculties that
k-means clustering encounters in the case of non-spherical clusters,
and the chaining problem inherent to single-linkage hierarchical
clustering. The optimization problem underlying spectral clustering
is unimodal and consequently results in a unique solution of the
clustering problem.

Spectral clustering relies on the eigenvector decomposition of
the Laplacian. The computational complexity of this operation
is of cubic order 0(n3) for dense matrices. However, sparse
matrices can easily be constructed by zeroing small similarities,
and this can lead to a signiﬁcant reduction of computational
complexity utilizing the Lanczos method (Cullum and Willoughby,
2002). Furthermore, algorithms have been recently developed to

 

742

112 /3.Io's[Bumo[p.IOJxosoueuIJOJurorq”:duq urorj papeolumoq

9103 ‘{g isnﬁnv 110::

MOSAIC

 

perform an approximative eigenvector decomposition in quasi-linear
time (Sakai and Imiya, 2009; Verma and Meila, 2001).

MOSAIC employs recursive spectral bisection for the matrix
rearrangement, which has been shown to generate good partitions
in comparison to other methods but in its simplest form is
computationally rather expensive (Barnard and Simon, 1993).
Signiﬁcantly faster implementations such as multilevel graph
partitioning are available (Barnard and Simon, 1993; Karypis and
Kumar, 1999). Our implementation is comparatively slow but also
considerably simpler and sufﬁciently fast (a few seconds on a
standard PC) for the comparatively small data sets that are typically
visualized within a MOSAIC plot.

4.4 Other visualizations

We also trialed graph-based methods for visualizing sequence
relationships, but found that graphs for larger sets of sequences
were unintelligible, creating ‘hairballs’ of difﬁcult-to-decipher
relationships (Supplementary Fig. 3). In addition, the graph display
can differ substantially depending on the layout chosen. The
commonly used spring layout, e.g. requires the time-consuming
optimization of a non-linear problem that has multiple optima.
The resulting layout minimizes the squared differences between
displayed and true distances, but individual distances are almost
always distorted. In contrast, a matrix-rendering approach as
employed here is fast, has a single solution and shows true,
undistorted distances.

Finally, the software implementation MOSAIC of the method
described here enables visualization of subsequence relationships
using dot plots and conservation proﬁles. The dot plots are
particularly useful for browsing pair-wise sequence relationships,
e.g. to detect stretches of sequence homology among largely
divergent sequences (illustrated here for the hnRNP family) or to
explore sequence relationships for signatures of reticulate events (as
illustrated for the HIN-200 protein family). The n-gram conservation
proﬁles can be used to identify the position of commonly recurring
subsequences even in the case of sequences that are impossible to
align using traditional approaches.

4.5 Scalability

In this article, we have successfully applied the MOSAIC framework
to data sets with no more than 50 sequences. However, since n-grarn
similarity can be calculated in linear time, it can be used to analyze
much larger sequence sets; we have, for instance, studied complete
bacterial proteomes using standard PCs (data not shown). Similarly,
efﬁcient algorithms to compute spectral rearrangement are available
(Section 4.3) and we analyzed large subsets of the SCOP database
using spectral rearrangement (data not shown).

One limiting factor concerning the evaluation of larger data sets
lies in the visual inspection of the MOSAIC plot. Beyond a few hundred
sequences the MOSAIC plot loses its advantage of providing both
overview and details in a single picture. While it is possible to
generate a compressed MOSAIC plot (similar to the compressed dot
plot described in Section 2.3), this would render the ﬁner details
invisible. The current implementation provides the functionality to
zoom into rectangular regions of a (potentially large) MOSAIC plot to
study sequence clusters in detail.

5 CONCLUSION

We have presented a framework that can be applied to a broad range
of sequence data types and that consistently utilizes n-grarns instead
of alignment-based methods for the visual analysis of sequence
relationships, consisting of n-gram-based dot plots, conservation
proﬁles and sequence similarity heat maps. We provide the software
application MOSAIC, an implementation of this framework, that
allows to interactively navigate and study sequence relationships.
Although the MOSAIC software makes no quantitative statements,
we found it to be very useful for the qualitative analysis of protein
families.

Applying our approach to three families, which present severe
challenges to traditional phylogenetic analysis, we identiﬁed
signatures of domain shufﬂing in one of the families and delineated
‘homology clusters’ in the other family, while we were able to
recapitulate known cases of gene conversion in the third. While
understanding sequence relationships is useful in its own right, it
also forms the basis for more-informed phylogenetic analysis. For
example, in the presence of domain shufﬂing, sequences can be split
into relevant subsequences before phylogenetic analysis. Similarly,
exclusion of outlying or non-homologous sequences will avoid
problems with erroneous inference of multiple sequence alignments.

More generally, gene conversion, non-allelic homologous
recombination, domain shufﬂing and other reticulate events are
increasingly recognized as having shaped the evolution of many
protein families, and there is hence a need to develop new
frameworks for analyzing and visualizing the relationships between
sequences in such families. The method presented here provides
a general framework for exploring sequence relationships and can
be easily extended or adjusted for application to speciﬁc types of
sequence comparisons.

Funding: Australian Research Council Centre of Excellence
in Bioinformatics (CE0348221); National Health and Medical
Research Council (grant 455920).

Conﬂict of Interest: none declared.

REFERENCES

Annilo,T. et al. (2003) Evolutionary analysis of a cluster of ATP-binding cassette (ABC)
genes. Mamm. Genome, 14, 7720.

Baldauf,S.L. (2003) Phylogeny for the faint of heart: a tutorial. Trends Genet, 19,
3457351.

Barnard,S.T. and Simon,H.D. (1993) A fast multilevel implementation of recursive
spectral bisection for partitioning unstructured problems. In Proceedings of the
Sixth SIAM Conference on Parallel Processing for Scientiﬁc Computing, Society
for Industrial & Applied Mathematics, pp. 7117718.

Bryant,D. and Moulton,V. (2004) Neighbor-Net: an agglomerative method for the
construction of phylogenetic networks. Mol. Biol. Evol, 21, 2557265.

Cardona,G et al. (2008) A distance metric for a class of tree-sibling phylogenetic
networks. Bioinformatics, 24, 148171488.

Chan,C.X. et al. (2009) Are protein domains modules of lateral genetic transfer? PLoS
ONE, 4, e4524.

Crochemore,M. and Verin,R. (1999) Zones of low entropy in genomic sequences.
Comput. Chem., 23, 2757282.

Cullum,J.K. and Willoughby,R.A. (2002) Lanczos algorithms for large symmetric
eigenvalue computations. Classics in Applied Mathematics, no. 41, Cambridge
University Press, Cambridge.

Dreyfuss,G. et al. (1993) hnRNP proteins and the biogenesis of mRNA. Annu. Rev.
Biochem., 62, 2897321.

Fiedler,M. (1975) A property of eigenvectors of nonnegative symmetric matrices and
its application to graph theory. Czechoslovak Math. J., 25, 6194633.

 

743

112 /3.io's[BumoIpJOJxosoueuIJOJurorqp:duq qurj papeolumoq

9103 ‘{g isnﬁnv 110::

S.R.Maetschke et al.

 

Hohl,M. and Ragan,M.A. (2007) Is multiple sequence alignment required for accurate
inference of phylogeny? Syst. Biol., 56, 20S221.

Hohl,M. et al. (2006) Pattern-based phylogenetic distance estimation and tree
reconstruction. Evol. Bioinform., 2, 3577373.

Hu,X. and Funder,J.W. (2008) The evolution of mineralocorticoid receptors.
Mol. Endocrinol., 20, 147171478.

Kaessmann,H. et al. (2002) Signatures of domain shufﬂing in the human genome.
Genome Res, 12, 164271650.

Karypis,G. and Kumar,V. (1999) A fast and high quality multilevel scheme for
partitioning irregular graphs. SIAM J. Sci. Comput., 20, 3597392.

Kawashima,T. et al. (2009) Domain shufﬂing and the evolution of vertebrates. Genome
Res, 19, 139371403.

Kruithof,E.K.O. et al. (2007) Gene conversion limits divergence of mammalian TLR1
and TLR6. BMC Evol. Biol., 7, 148.

Lavery,D.N. and McEwan,I.J. (2005) Structure and function of steroid receptor AFl
transactivation domains: induction of active conformations. Biochem. J., 391,
449464.

Makarenkov,V. (2001) T-Rex: reconstructing and visualizing phylogenetic trees and
reticulation networks. Bioinformatics, 17, 664468.

Ng,A.Y. et al. (2001) On spectral clustering: analysis and an algorithm. Adv. Neural Inf
Process. Syst., 14, 8497856.

Oliver,J.L. et al. (1993) Entropic proﬁles of DNA sequences through chaos-game-
derived images. J. Theor Biol., 160, 457470.

Paccanaro,A. et al. (2006) Spectral clustering of protein sequences. NucleicAcids Res,
34, 157171580.

Patthy,L. (1999) Protein evolution. Blackwell Science, Oxford.

Pentney,W. and Meila,M. (2005) Spectral clustering of biological sequence data. In
The Twentieth National Conference on Artiﬁcial Intelligence and the Seventeenth
Innovative Applications of Artiﬁcial Intelligence Conference, AAAI Press,
Pittsburgh, pp. 8457850.

Perelygin,A.A. et al. (2008) Concerted evolution of vertebrate CCR2 and CCR5 genes
and the origin of a recombinant equine CCR5/2 gene. J. Hered., 99, 50e51 1.
Roberts,T.L. et al. (2009) HIN-200 proteins regulate caspase activation in response to

foreign cytoplasmic DNA. Science, 323, 105771060.

Sakai,T. and Imiya,A. (2009) Fast spectral clustering with random projection and
sampling. Lect. Notes Comput. Sci., 5632, 3727384.

Schmidt,E.E. and Davies,C.J. (2007) The origins of polypeptide domains. Bioessays,
29, 2627270.

Shi,J. and Malik,]. (2000) Normalized cuts and image segmentation. IEEE Trans.
Pattern Anal. Mach. Intell., 22, 8887905.

Troyanskaya,O.G. et al. (2002) Sequence complexity proﬁles of prokaryotic genomic
sequences: a fast algorithm for calculating linguistic complexity. Bioinformatics,
18, 679488.

Verma,D. and Meila,M. (2001) A comparison of spectral clustering algorithms.
Technical Report 03-05-01. University of Washington Department of Computer
Science .

Vinga,S. and Almeida,]. (2003) Alignment-free sequence comparisionia review.
Bioinformatics, 19, 5137523.

Vinga,S. and Almeida,].S. (2007) Local Renyi entropic proﬁles of DNA sequences.
BMC Bioinformatics, 8, 393.

Vogel,C. et al. (2004) Structure, function and evolution of multidomain proteins.
Curr Opin. Struct. Biol., 14, 2087216.

von Luxburg,U. (2007) A tutorial on spectral clustering. Stat. Comput., 17, 395416.

Whitﬁeld,GK. et al. (1999) Steroid hormone receptors: Evolution, ligands and
molecular basis of biologic function. J. Cell. Biochem., 32/33, 1107122.

Wong,S. and Ragan,M.A. (2008) MACHOS: Markov clusters of homologous
subsequences. Bioinformatics, 24, i777i85.

 

744

112 /3.io's[BumoIpJOJxosoueuIJOJurorqp:duq qurj papeolumoq

9103 ‘{g isnﬁnv uo ::

