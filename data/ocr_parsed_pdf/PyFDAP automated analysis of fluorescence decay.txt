Advance Access Publication Date: 6 November 2014

Bioinformatics, 3116), 2015, 972—974
doi: 10.1093/bioinformatics/btu735

Applications Note

 

 

Systems biology

PyFDAP: automated analysis of fluorescence
decay after photoconversion (FDAP)

experiments

Alexander BlaBIe and Patrick Miiller*

Systems Biology of Development Group, Friedrich Miescher Laboratory of the Max Planck Society, 72076

Tiibingen, Germany

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on August 18,2014; revised on October 16, 2014; accepted on November 2, 2014

Abstract

Summary: We developed the graphical user interface PyFDAP for the fitting of linear and non—linear
decay functions to data from fluorescence decay after photoconversion (FDAP) experiments. PyFDAP
structures and analyses large FDAP datasets and features multiple fitting and plotting options.
Availability and implementation: PyFDAP was written in Python and runs on Ubuntu Linux, Mac
OS X and Microsoft Windows operating systems. The software, a user guide and a test FDAP data—
set are freely available for download from http://people.tuebingen.mpg.de/mueller—lab.

Contact: pmueller@tue.mpg.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Fluorescence microscopy techniques have been widely used to meas-
ure the properties of fluorescently labeled proteins in embryos, tis-
sues and cells (Pantazis and Supatto, 2014). Over the last decade, the
repertoire of fluorescent proteins has been extended with the discov-
ery and engineering of photoconvertible proteins that change their
emission properties upon light exposure and that can be used to
track sub-populations of pulse-labeled proteins (Adam et (11., 2014).

Photoconvertible proteins have recently been adapted to deter-
mine protein stability via microscopy-based fluorescence decay after
photoconversion (FDAP) assays |reviewed in Rogers et al. (2015)|.
In FDAP assays, a protein of interest is tagged with a photoconverti-
ble protein and expressed in viz/o. After photoconversion, the decay
in fluorescence intensity of the protein is monitored. The data is
then fitted with a decay function that models protein clearance to
calculate protein half-lives.

Protein stability is context-dependent. For example, protein sta-
bility might be different inside cells and in the extracellular space
(Muller et (11., 2013; Rogers et (11., 2015; Zhou et (11., 2012). Both
intra- and extracellular protein half-lives can be determined by
FDAP using a static intracellular signal to create masks for intra-
and extracellular intensities (Rogers et (11., 2015).

We have previously described how to execute FDAP experiments
in living zebrafish embryos (Muller et (11., 2012; Rogers et (11.,
2015). Here, we provide a standardized computational framework
to analyse the resulting datasets. Our software PyFDAP features (i) a
comprehensive data format for handling, sorting and annotating
large FDAP datasets, (ii) the ability to separate FDAP datasets into
their intra- and extracellular components based on counter-labeling,
(iii) established fitting algorithms and (iv) a user-friendly environ-
ment that allows researchers from a non-computational background
to easily evaluate FDAP datasets.

2 Implementation

PyFDAP was developed as an open-source graphical user interface
(GUI) in Python with PyQT and SciPy to make it accessible across
the most frequently used operating systems: Ubuntu Linux, Mac OS
X and Microsoft Windows. Python is a widely used scientific pro-
gramming language and provides PyFDAP users with enormous re-
sources and easily incorporated software packages (Millman and
Aivazis, 2011). The PyFDAP GUI was designed to enable the user to
simultaneously view the current project tree, project properties and
various tabbed plots.

(6) The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 972

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Automated analysis of FDAP experiments

973

 

Users import FDAP datasets as ‘.tif’ files. As intra— and extracel—
lular protein stabilities can be different, PyFDAP offers an option to
import a second dataset that counter—labels intra— or extracellular
space. The separation of fluorescence intensities into intra— or extra—
cellular masks is performed using the Otsu binarization algorithm
(Otsu, 1979). The masks and corresponding datasets can then be
investigated inside the PyFDAP GUI. The masks are applied to the
images of the photoconverted signal, and the average intensities in
the intra— and extracellular domains and in the entire image are cal—
culated. PyFDAP organizes all data into a logical hierarchical object
structure to facilitate data navigation (Fig. 1).

PyFDAP offers multiple fitting options to fit an exponential
decay function given by

c(t) : coil“ + yo

or an inverse power function given by

60> = (cs-n — km — we +1.

to the dataset to model linear (Muller et 41., 2012) or non—linear
decay (Eldar et 41., 2003), respectively. Here, c(t) is the intensity of
the decaying fluorescent signal, yo the baseline of the decay, co + yo
the fluorescent intensity at t: 0 and k the decay rate constant of the
fluorescent signal. In the case of non—linear decay, 11 controls the
degree of non—linearity. PyFDAP calculates the protein half—lives r
from k as ‘E : ln(2)/k or ‘E : (2”_1 — 1)c(1)_”/(k(n — 1)) for linear
and non—linear decay, respectively.

PyFDAP offers several established bounded and unbounded opti—
mization algorithms to fit the decay models to the data. The lower
bound of fluorescence measurements is limited by the intrinsic back—
ground signal of the microscope and the autofluorescence of the
imaged sample, and it is therefore crucial to define biologically rea—
sonable bounds for the fit. PyFDAP offers an option to import back—
ground and noise measurements and allows the user to choose a
lower bound of the baseline yo from four presets: (i) the level of
noise N estimated from the noise dataset, (ii) the mean level of the
pre—conversion background datasets Em, (iii) the mean background

Molecule project
—( FDAP measurements

   
        

Noise measurement

Pre»conversion
measurement

Measurement m
Background
measurements
Measurement 1
Pre»conversion
measurement
Measurement b

Fig. 1. Hierarchical PyFDAP data structure for FDAP experiments. Experiments
are grouped into a main molecule project and divided into FDAP (1 to m)
and background (1 to b) pre- and post-conversion measurements. Each FDAP
measurement can have multiple fits (1 to f) with different fitting options

 

 
      

 

level over all background datasets E or (iv) a special weighting func—
tion F (Mﬁller et 41., 2012) given by

1 b . B,,(t) — N,-
F,, — Egmin <—B _ Ni ,

prep

where i is the current FDAP measurement, 1’ E {
intracellular, extracellular. entire domain} is the investigated region
and j E {1.. . .. b} represents the indices of background datasets with
intensities B(t) at time t. Using the function F, users can compute the
lower bound of the baseline for measurement 1' and region r, you , by

yoUZFLr ' (IpreU _  ‘I' Ni7

where 1pm” denotes the pre—conversion intensity of the FDAP meas—
urement i in region 1’. Together, these four presets offer a wide range
of possibilities for the estimation of the baseline yo.

Multiple plotting options help the user to remove or improve
corrupt datasets or fits. The user can plot the optimized parameters
to find outliers and re—run the fits with different options. Moreover,
PyFDAP saves the fitting progress and lets the user ‘slide’ through it
to identify points at which optimization algorithms got arrested in a
local minimum and where parameters need to be changed.

PyFDAP allows data and results to be saved in various image
and video formats. Individual decay curves and fits can be exported
as ‘.csv’ files. Similarly, complete PyFDAP project trees (Fig. 1)
including all settings and properties can be exported as ‘.csv’ or
JavaScript Object Notation (JSON) object files. Object files can eas—
ily be reloaded into PyFDAP, which ensures full reproducibility of
data analysis and facilitates collaboration among researchers.

To offer customizability and debugging options, PyFDAP also
comes with a full Python terminal that allows users to modify FDAP
datasets or to improve FDAP data analysis without the need to edit
the main PyFDAP code.

A detailed user guide (Supplementary Material) describes the in—
stallation and usage of the PyFDAP software as well as the mathem—
atical background for data analysis.

3 Conclusion

PyFDAP is an open—source GUI for the analysis and handling of
FDAP data. Usage of PyFDAP does not require any programming
knowledge. The straightforward GUI provides a quick workflow,
and the integrated terminal and open—source nature of PyFDAP en—
able researchers to extend the software to suit their needs.

Acknowledgements

We thank Katherine Rogers, Luciano Marcon, David Morsdorf and Gary Soh
for useful suggestions and discussions. This work was supported by the
Emmy Noether Program of the Deutsche Forschungsgemeinschaft, the Max
Planck Society and a Career Development Award from the Human Frontier
Science Program.

References

Adam,V. et a1. (2014) Phototransformable ﬂuorescent proteins: future chal-
lenges. Curr. Opin. Chem. Biol., 20C, 92—102.

Eldar,A. et a1. (2003) Self-enhanced ligand degradation underlies robustness
of morphogen gradients. Dev. Cell, 5, 635—646.

Millman,K.]. and Aivazis,M. (2011) Python for scientists and engineers.
Comput. Sci. Eng, 13, 9—12.

Muller,P. et a1. (2012) Differential diffusivity of Nodal and Lefty underlies a
reaction-diffusion patterning system. Science, 336, 721—724.

ﬁm'spzumot‘pmﬂo'sopeuuowtotq/ﬁdnq

974

A.BlaBle and P. Mill/er

 

Muller,P. et al. (2013) Morphogen transport. Development, 140, 1621—1638.

Otsu,N. (1979) A threshold selection method from gray-level histograms.
IEEE Trans. Syst. Man Cybern., 9, 62—66.

Pantazis,P. and Supatto,W. (2014) Advances in whole-embryo imaging: a
quantitative transition is underway. Nat. Rev. Mol. Cell Biol., 15, 327—339.

Rogers,K.W. et al. (2015) Measuring protein stability in living zebraﬁsh em-
bryos using Fluorescence Decay After Photoconversion (FDAP).  Vis.
159617., [Epub ahead of print, doi: 10.3791/52266,]anuary 28, 2015].

Zhou,S. et al. (2012) Free extracellular diffusion creates the Dpp morphogen
gradient of the Drosophila wing disc. Curr. Biol., 22, 668—675.

/310'S[Bum0fplOJXO'SOIJBLUJOJIIIOICI”Zduq

