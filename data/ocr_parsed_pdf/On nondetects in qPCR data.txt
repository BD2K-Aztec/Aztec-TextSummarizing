BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

qPCR non-detects

 

A Dataset 1 B

Dataset 2 C

Dataset 3

 

 

 

@_ JL

 

0
Lo_ i

—AACt residuals
o

-ACt residuals
0

 

 

 

10
I
oo

 

 

 

 

 

 

—ACt residuals
0

 

-10

 

 

 

o T

 

 

 

' El —:
I T T E
L? _ El L12 _ ° i
o i
S _ 8 2 _
I I
I | | I I
obggirved 23:22:? whiz-tied nonl—Jdogt‘ects Obse rved no n _d ete Ct

observed non-detect

Fig. 1. Within replicate residuals stratified by the presence of non-detects. The average AACt (A) or ACt (B and C) values were calculated within each set
of replicates (same gene and sample type). The residuals, for each gene and sample from this summarization are plotted here, stratified by the presence of
non-detects. In dataset l, a non-detect could occur in the perturbation sample, the control sample or both samples. The left-most box in Panel A shows
the distribution of residuals in dataset 1 when there are no non-detects. The other boxes in Panel A (from left to right) show the distribution of residuals
when there are non-detects in the perturbation sample, the control sample and both samples. Similarly, the left box in Panels B and C shows the
distribution of residuals when there are no non-detects. The right box in Panels B and C shows the distribution of residuals when there is a non-detect.
Although one would expect some difference in the distribution of residuals between the detects and non-detects, the differences seen here are much larger
than one would expect and likely represent bias introduced by setting non-detects equal to 40

of interest. Finally, we show that the proposed approach greatly
reduces the bias introduced by non—detects in qPCR data ana—
lysis. Three published qPCR datasets (described in the Methods
Section) are used throughout the manuscript to motivate and
illustrate the results.

3 METHODS

3.1 Three example datasets

The first dataset consists of nine gene perturbations with matched control
samples (Almudevar et al., 2011); the second dataset is composed of two
cell types and three treatments (Sampson et al., 2013); the third dataset is
a study of the effect of p53 and/or Ras mutations on gene expression
(McMurray et al., 2008).

In the first dataset, cells transformed to malignancy by mutant p53 and
activated Ras are perturbed with the aim of restoring gene expression to
levels found in non-transformed parental cells via retrovirus-mediated re-
expression of corresponding cDNAs or shRNA-dependent stable knock-
down. The data contain four to six replicates for each perturbation, and
each perturbation has a corresponding control sample in which only the
vector has been added (Almudevar et al., 2011).

The second dataset consists of two cell typesiyoung adult mouse
colon (YAMC) cells and mutant-p53/activated-Ras transformed
YAMC cellsiin combination with three treatmentsiuntreated,
sodium butyrate or valproic acid. Four replicates were performed for
each cell-type/treatment combination (Sampson et al., 2013).

The third dataset is a comparison between four cell typesiYAMC
cells, mutant-p53 YAMC cells, activated-Ras YAMC cells and p53/Ras
double mutant YAMC cells. Three replicates were performed for the
untransformed YAMC cells, and four replicates were performed for
each of the other cell types (McMurray et al., 2008).

As in the original publications, all three datasets were normalized to a
reference gene, Becnl, with the resulting values denoted as ACt. In the
first dataset, AACt values were computed by comparing each perturbed
sample to its corresponding control sample. Additional details regarding
each of these datasets can be found in the original publications.

4 RESULTS

4.1 Setting non-detects equal to 40 introduces bias

We begin by examining the common practice of replacing non—
detects with a Ct value of 40. Replicates were summarized
by calculating the average ACt (datasets 2 and 3) or AACt
(dataset 1) values for each unique gene/sample—type combin—
ation. The residuals from this summarization for gene 1',
sample—type j and sample k were calculated as follows:

1 K
Dataset l I Vii]; = AACth — 

1 K
Datasets 2and 3 . rijk — ACth — REACy/k

The distribution of these residuals differs substantially between
those in which the ACt or AACt value contains a non—detect and
those in which these values were observed (Fig. 1). Note that
when calculating ACt values, the reference gene, Becnl, is
always detected, so non—detects can only occur in the target
gene; therefore, datasets 2 and 3 are each split into two groups
based on whether both Ct values were observed or a non—detect
was present in the target gene. A non—detect typically results in
lower absolute expression estimates (Fig. 1B and C). When
calculating AACt values, a non—detect can occur in the perturbed
and/ or control sample. In general, a non—detect in the perturbed
sample results in lower relative expression, and a non—detect
ina the control sample results in higher relative expression
(Fig. 1A). Non—detects in both samples yield AACt values
close to zerCchese values simply represent differences in
Becnl expression between the perturbed and control samples.
While one might expect some difference in the distribution of
residuals between the observed values and those containing a
non—detect, the large differences seen in Figure l likely

 

2311

ﬁm'spzumol‘pmﬂo'sopeuuopuorq/ﬁdnq

0 both observed
*6 perturbation n

 

0 observed
*6 etect

0 observed
ale etecl

/310'SIBanoprOJxo'sopBuiJOJuioiq”:duq

qPCR non-detects

 

Dataset 1

Dataset 2

Dataset 3

 

 

 

0.75
|

0.06
|
I
0.50
I

0.25
|

~— --—-r—1-ro‘-‘;;- gun-o... o 0

Proportion of non-detects >
Proportion of non-detects tn

 

 

 

 

- an

0.75
|

I
to a. c-,

0.50
I
i
‘-t

0.25
|
U
‘E.

 

Proportion of non-detects O

 

 

 

0.00
|
!

 

 

0.00
|
0.00
|

22 24 26 28 30 32 20 25
Average gene expression

Average gene expression

30 35 20 25 30 35 40
Average gene expression

Fig. 3. The proportion of non-detects versus median observed gene expression within control samples (A) or within each sample condition (B and C).
Logistic regression ﬁts (dashed lines) all show a strong relationship between the proportion of non-detects and the median observed gene expressioni

P-values of (A) 2.57 X 10*, (B) 1.58 X 10*”, (C) <2 X 10*16

First, the PCR reactions are run for a ﬁxed number of cycles
(typically 40), implying that the observed data are censored at the
maximum cycle number. This is a type of non—random missing—
ness in which the missing data mechanism depends on the unob—
served value. Knowledge of the technology allows us to conclude
that the data are at least subject to fixed censoring; however, as
we will later show, the qPCR censoring mechanism may actually
be a probabilistic function of the unobserved data.

Second, the experimental design of the first dataset, in which
there are a large number of control samples, allows one to esti—
mate an additional piece of information that is not typically
availableithe proportion of non—detects as a function of the
average sample expression across a large number of replicates
(Fig. 4). Here, we see a similar relationship between average
expression and proportion of non—detects. It appears that sam—
ples with overall lower signal, as a result of technical not biolo—
gical variability, also result in a greater number of non—detects.
Because most qPCR experiments are not designed to allow one
to estimate the relationship between overall sample signal and
the proportion of non—detects, qPCR data typically exhibit a type
of non—random missingness in which the missing data mechanism
depends on an unobserved variable.

This suggests that qPCR non—detects are probably not missing
at random; therefore, ﬁltering non—detects will introduce bias in
one’s inference. The only principled approach is to attempt to
model the missing data mechanism and incorporate this into
one’s analysis.

4.3 The missing data mechanism
Before proposing a missing data mechanism for qPCR non—
detects, it is important to ﬁrst determine what a non—detect rep—
resents. There are several possibilities:

(l) Truncation of a continuous expression distributionia
non—detect represents a true Ct value >40. This implies
that if the PCR were run for more cycles, one would even—
tually see an ampliﬁcation above the Ct threshold. This
would mean that the Ct values are a type of censored data.

 

LO
‘—.— ~.'
0

I
I
I
I
I
I
I

I
I
I
,0
I
I
I

0.05
|

 

Proportion of non-detects

 

000
I
i
i
i
+
Q

 

Average sample expression

Fig. 4. The proportion of non-detects versus median sample expression
within controls in dataset l. Logistic regression ﬁt (dashed line) shows a
strong relationship between the proportion of non-detects and the median
gene expressioniP-value of 0.0003

(2) A completely unexpressed transcriptino matter how long
the PCR was run, one would never see ampliﬁcation above
the Ct threshold.

(3) A failure to detect a true Ct value <4(Fthe Ct value
should be <40, but in the given experiment the transcript
failed to amplify or its amplification efﬁciency was poor.

We begin by evaluating the first potential explanation for non—
detects by examining the distribution of Ct values including non—
detects coded as 40 (Fig. 5). The number of non—detects in these
datasets far exceeds what one would expect based on fitting a
normal distribution to the detected Ct values. Approximately
1.2, 1.8 and 2.8% of the measurements are non—detects in data—
sets 1, 2 and 3, respectively, where one would expect 0.02, 0.03
and <0.0l%. This argues against non—detects being explained
completely by a truncation of the Ct value distribution, unless
the distribution has an extremely long upper tail.

 

2313

ﬁm'spzumoi‘pmyo'sopeuuowroiq/ﬁdnq

M.N.McCalI et al.

 

 

A 0 Dataset 1 B 0 Dataset 2 C 0 Dataset 3
8 L” 8
8 8
<r N 8
>5 >~. > (D
2 a 2 2 2
OJ 0.) G) o
2 e 2 8
O O
‘2 g 9 £2 ‘2
LL LL LL
8
§ 2 N
O o I I I I I I H O
16 20 24 28 32 36 4o 16 2o 24 28 32 36 4o 16 20 24 28 32 36 40
Ct values Ct values Ct values

Fig. 5. The distribution of Ct values in each of the three datasets. Here, non-detects are coded as 40

Furthermore, if the non—detects represented censoring of
values >40, one would expect a reduction in bias by replacing
the non—detects with a value 340. However, in general, bias is
reduced by replacing non—detects with a value of 35 rather than
40 (Fig. 6). This suggests that many non—detects are due to a
failure to amplify rather than a true Ct value >40.

Next, we evaluate the second potential explanation for non—
detectsithat a non—detect represents a completely unexpressed
transcript. As previously mentioned, Figure 4 shows a strong
relationship between low overall signal in a sample and a greater
proportion of non—detects. Although some non—detects may rep—
resent a completely unexpressed gene, this cannot be the only
explanation, given that samples with low signal (due to technical
not biological differences) typically have a greater proportion of
non—detects.

Finally, examination of Figure 5 shows a relatively low number
of Ct values between 35 and 40. Together with Figure 6, in which
replacing non—detects with a value of 35 rather than 40 reduced
the bias in ACt and AACt values, this suggests that some non—
detects represent a failure to detect a true Ct value <40.

4.4 A potential generative model

One model to explain the observed behavior of non—detects in the
Ct data is the following:

Y ﬂ911)+811 ifZi/ =1
I non — detect if ZV=0

where

807:“) if Yr<5r
Pr(Z[/=1)=: .1 .1 .1

0 otherwise

Here, Y i,- is the observed Ct value of gene 1' for sample j, 6” is the
true expression of gene 1' for sample j, ﬁe”) represents the non—
biological effects present in the observed data and 8V captures the
technical and biological variability in the data. Z),- is a binary
variable representing whether a Ct value was obtained for gene 1'
and sample j that takes on a value of 1 with probability g( Y )7) for
values of Y i,- less than some threshold S ij. Here, Si,- represents the
upper Ct value detection limit for gene 1' and sample j.

In this framework, one can represent the standard assump—
tions regarding non—detects as: (i) S V: 40 V(i, j), where 40 is the
total number of PCR cycles performed and (ii) g( Y )7) = 1 mean—
ing that Ct values <40 are never reported as non—detects.
However, the results shown above suggest that these assump—
tions are probably not valid. Speciﬁcally, Si,- may be <40 for
some genes and/or g(Y[,) may be <1.

Furthermore, this model captures several important aspects of
qPCR non—detects. The relationship between technical variability
in expression and the proportion of non—detects is formalized in
the dependence of Z),- on Y i,- rather than 6”. The gap in observed
Ct values between 35 and 40, i.e. the potential for Ct values <40
to be non—detects, is captured by g( Y”) <1 and/or SV<40.

4.5 An EM algorithm to handle non-detects

Having established that non—detects in qPCR data represent data
missing not at random, we now propose a method that incorp—
orates the missing data mechanism into subsequent statistical
analyses. The expectationemaximization (EM) algorithm pro—
vides a method to obtain maximum likelihood estimates in the
presence of missing data by iteratively calculating the conditional
expectation:

Q(¢|¢n)=E[1nf(X|¢) IY. <21]

and maximizing Q(¢|¢n) with respect to <15. Here, X is the com—
plete unobserved data and Y is the incomplete observed data, <1) is
the set of all parameters, lnﬂX|¢) is the complete data log—
likelihood, and d)" is the estimate of <1) at iteration n. This process
is repeated until convergence (Dempster et al., 1977).

The challenging aspect of applying the EM algorithm to qPCR
non—detects is calculating the conditional expectation. This re—
quires one to estimate the distribution of gene expression given
a non—detect. Here, we proceed via Bayes rule:

P’(Zii=0|YI/)*f(Y11)

f(Yi1|Zl/=O)= Pr(ZI/=0)

We can estimate Pr(Z[,«=0|Y[/) by examining the relationship
between the proportion of non—detects and average observed ex—
pression within replicates. This approach permits ﬂexible model—
ing of the data to either directly estimate the parameters of

 

2314

ﬁm'spzumol‘pmyo'sopeuuowroiq/ﬁdnq

qPCR non-detects

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Dataset 1 B Dataset 2 C Dataset 3
e — e - e - 8
a, o 8 o
_ L m m
g in - e 8 : {—5 m _ a m _ a
u a = =
90-51an ﬁg; eo-EEi—Ti=_:_. 9c:- —— I
5 H- a a T + E o 5 I 1 <=
1:) _ 0 Ln _ ° 5 In _ :
g ' o o E o $1 ' LL <|l '  E
I o a
e _ 8 e _ e _ 
I I o I 3—
| | I I I I | | I | | | | I I
40 35 40 35 40 35 4O 35 40 40 35 40 35 40 35
obzziced 1:23:23 "0153:; nongggt‘ects observed non-detect observed non—detect

Fig. 6. Same as Figure l, with additional boxplots showing the residuals when non-detects are replaced with 35 rather than 40. Here, Ct values >35 are
also replaced by a value of 35. By replacing non-detects with a value of 35 rather than 40, the distribution of the residuals is far more similar between
those in which the Ct values were observed and those containing a non-detect. However, this does not imply that one should replace non-detects with
a value of 35. Such an approach makes very strong assumptions about the missing data mechanism and would require one to discard observed Ct

 

 

 

 

 

 

 

 

 

 

 

 

 

values >35
A Dataset 1 B Dataset 2 C Dataset 3
O _ O _ O _
\— F ‘— 8
w 0
{—6 In - a T? Lo — % LO —
a 3 :5
EO-EEéE ago-El; (Do- IEE.f
: L l L
o r 4 — — as T a 1 .
E m _ <1 Ln _ <1 mm _ 8 o
I | o I I I I
C) C) O
‘T ' T — ‘T '
0.22333 12131522? .0312; "0333.... observed non—detect observed non—detect

Fig. 7. Same as Figure l, but after imputing the non-detects using the proposed EM algorithm

interest or to obtain estimates of the missing data that can be
used to impute the non—detect values.

To demonstrate the reduction in bias that one can achieve by
treating non—detects as missing data, we propose the following
model of the observed expression for gene 1', sample—type j and
replicate k, Y ilk:

 = 0

6” ‘l‘  ‘l‘ 8”];
11k =
non — detect

where 6k represents a global shift in expression across samples
and,

g(Y[/k) if YVk <40

Pr(Zi‘k = 1) =
'1 I 0 otherwise

Here, g(1’,~,«k) can be estimated via the following logistic regression:
[Ogit(Pr(Z.r/k = 1)) = 50 + ﬂiév‘

where 0,; is an estimate of the average expression for gene 1' and
sample—type j. For the data presented here, 6k can be estimated
using the reference gene, Becnl.

4.6 Treating non-detects as missing data reduces bias

We begin by examining the effect of replacing non—detects with
an imputed Ct value based on the conditional expectation calcu—
lated in the EM algorithm. Looking at the residuals within rep—
licates in each dataset, it is clear that replacing non—detects with
these imputed values results in far less bias in the ACt and AACt
values than if we replaced the non—detects with a value of 40
(Fig. 7).

The improvement in bias after imputing the non—detects can
also be seen in the example genes shown in Figure 2. After
replacing the non—detects with values imputed using the EM
algorithm, the non—detect ACt and AACt values are far more
similar to their replicate values, while retaining small differences
due to the informative missingness (Fig. 8). Figure 8C shows
one important limitation of the current implementation.
Because the ACt values from the three normal samples all con—
tained non—detects, their imputed values are fairly similar to the
initial values based on replacing the non—detects with a value of
40. One could address this by implementing a slightly more
complex EM algorithm that shrinks the imputed values
toward a global mean; however, such an approach assumes

 

2315

ﬁm'spzumol‘pmyo'sopeuuowroiq/ﬁdnq

0 both observed
ale per rbation n

 

 

0 observed
ale onedetect

/310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

