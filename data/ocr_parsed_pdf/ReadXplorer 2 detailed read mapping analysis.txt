Eﬁuégowsmgammowoio~&o:~=£¢o~m\

htt ://www.readx |orer.or

pression analysis, transcription start site detection, operon detection and
RPKM value and read count calculations. Although not optimal, it is still
common practice to exclude reads mapping to more than a single posi-
tion from downstream analyses (Li et al., 2015) and many read mapping
analysis tools do not address multiple mapped reads (e.g. TSSPredator
(Dugar er al., 2013), TSSer (Jorjani and Zavolan, 2014) and TSSAR
(Amman er al., 2014) for TSS detection or VarScan 2 (Koboldt er al.,
2012) for single nucleotide polymorphism (SNP) detection). For the
latter tools, we assume that they incorporate all reads present in the data
set provided by the user. A notable exception is the RNA-Seq analysis
tool Rockhopper (McClure er al., 2013). It uses all optimal alignments of
a read, but it remains unclear how multiple mapped reads are taken into
account when measuring the read count for a gene.

In contrast to common practice, various publications (Treangen and
Salzberg, 2012; Robert and Watson, 2015) have shown the importance of
properly handling multiple mapped reads instead of discarding them.
Generally, relying on a single randomly chosen mapping position for a
read leads to a possibly erroneous choice about read placement
(Treangen and Salzberg, 2012), while in RNA-Seq experiments the
exclusion of multiple mapped reads leads to underestimation of the data
(Robert and Watson, 2015).

To accommodate these issues, the first version of Reaprlorer already
featured a read mapping classification unique among read mapping
visualization tools. For the current work, we focused on a further refine-
ment of this read classification. Hereby, an even more detailed view on
the mapping data is enabled and allows for easy configuration of the
mapping classes included in all downstream analyses.

Besides the classification, the analysis capabilities of the software have
been largely enhanced to offer both more detailed (differential gene
expression, read count and normalization analysis and transcription start
site (TSS) detection) and new automatic analysis functions (genome
rearrangement detection and correlation analysis). Further, we introduce
technical improvements enabling integration of Reaprlorer 2 into
larger pipelines or workﬂow systems such as our Galaxy server, improv-
ing speed, broaden the support of large eukaryotic data sets and simplify-
ing the connection between GNU R (R Core Team, 2014) and Java.

1n the following, we present the enhanced read mapping classification,
newly implemented analysis functions and substantial enhancements of
existing analysis functions.

2.1. Extended Read Classification

For a more detailed distinction of the reads in comparison to the first
Reaprlorer version, two additional read mapping classes have been
added to the three existing ones (Perfect Match — a mapping without
mismatches, Best Match — a mapping with less deviations than all other
mappings of the read, and Common Match — a mapping of a multiple
mapped read with better mappings with less deviations elsewhere) (see
Table 1):
o The Single Perfect Match class contains all reads with exactly
one (single) perfect match.
The Single Best Match class contains all mappings that can-
not be allocated to another position in the reference with the

Table 1: Read mapping classification in ReaprIorer 2.

 

Read Mapping

Pro erties
Classiﬁcation p

 

Read has only one mapping without
mismatches, may have additional Com-
mon Match mappings

Single Perfect Match

 

Read has one mapping with less devia-
tions than all other mappings, may have
additional Common Match mappings

Single Best Match

 

Read has multiple mappings without

Perfect Match .
m1smatches

 

Read has multiple mappings with the
Best Match same number of deviations from the

reference

 

Qtegend  Dplmns
D J PerfertMakh D J Single PeriartMatrh

D -I BestMatrh D J Single BestMatrh

 

l J Cnmmnn Match D J lnrlude multhE MEDDEdrEads

I

Figure 1: The five read mapping classifications in the coverage
plot. Read counts per base of input sequence are shown separat-
ed by strand and colored by mapping classification. Reads align-
ing at the borders of the figure have a distinctive best mapping
(Single Perfect and Single Best Match classes in rich green and
yellow),while the light green (Perfect Match), light yellow (Best
Match) and red (Common Match) mappings display a repetitive
reglon.

same number or fewer mismatches than at the current posi-

tion - they exactly have one (single) best match.
The Perfect and Best Match mapping classes contain multiple mapped
reads with equally good mapping positions, e.g. two perfect mappings
without mismatches at different genomic positions. In contrast, the
Single Perfect Match and Single Best Match class contain both uniquely
mapped reads and the distinctive best mapping of multiple mapped
reads. This extended classification enables quick discrimination of reads
with only one distinctive best mapping from mappings with multiple
equally scoring mappings, while not requiring the read to be uniquely
mapped. Reads from both Single Match classes can have more mappings
with lower quality, falling in the Common Match class. Thus, this classi-
fication is not as strict as only considering uniquely mapped reads with
exactly one valid mapping to the reference. The extended read classiﬁca-
tion is not only used for visualization (Figure 1) but also for read selec-
tion during the wizard based setup of all analysis tools offered by
Reaprlorer 2. Hereby, additional use cases are enabled for the automat-
ic analysis of read mapping data. As one example, the “Coverage Analy-
sis” can now be used to identify almost identical repetitive regions. By
only selecting the Perfect, Best and Common Match mapping classes,
only genomic intervals covered by multiple mapped reads — representing
repetitive regions in the genome - are returned by the analysis. Such a
region is depicted in Figure 1 by the light yellow, red and light green
areas.

2: 112 /310'S[BIIJHO[pJOJXO'SOlJBLUJOJIIlOlq/ﬂduq 1110.1} papBOIII/lAOG

910z ‘09 Isnfv’nv 110

 

Figure 2: The histogram comfortably visualizes the frequency of
TPM values observed within the data set at log scale. The actual
number of features belonging to one bar is shown in the tooltip. It
can be switched to show RPKM values.

2.2. Read Count Normalization

The first Reaprlorer version featured an RPKM (total exon reads per
million mapped read per kilobase of exon model) (Mortazavi er al.,
2008) based read count analysis. This analysis has been enhanced by two
additions: the model for assigning reads to a genomic feature was im-
proved to allow for a more accurate way of read assignment to a feature
and the TPM (Transcripts per million) (Li et al., 2010) normalization
method was added to the analysis.

RPKM is meant to reﬂect relative molar concentrations of transcripts by
normalizing for transcript length and library size. This type of normaliza-
tion is necessary for reasonable comparisons of transcript abundances
both within one and among multiple samples. TPM was proposed as an
improvement to RPKM, because TPM has the advantage of being invari-
ant between samples and species (Li et al., 2010) while RPKM values
may change when the mean expressed transcript length changes due to
different sets of active genes in two samples.

TPM is defined according to (B. Li et al., 2010) as

TPM, =106x[%]x /
l. C./'
I 27
f l/

where c is the number of mappable reads for genomic feature 1' and j is
an integer ranging from 1 to the number of genomic features of the same
type (e.g. genes).

To take into account that reads of a given length cannot start at each
position in a transcript, the effective length of transcripts l~can optionally
be used for the normalization instead of the whole transcript length l.
The effective length of transcript i was first defined by (Trapnell er al.,
2010) as

Z=ZAF(X)><ZL, —x+1

x51,

where x is one of the observed read length values in transcript i of length
1,, and AF is the fraction of reads for i with length x.

The model for assigning reads to a transcript needs to be as precise as
possible, because the normalization outcome is determined by the chosen

transcript boundaries and the inclusion model for the reads. Our analysis
offers to either use the given boundaries of genomic features or define a
fixed offset for start and stop positions, separately. Using an offset can
be useful when most of the 5’UTRs and 3’UTRs are not taken into
account by the genomic features of the reference. Additionally, automat-
ically annotated gene start and stop positions might be incorrect, leading
to data loss.

The implemented read assignment model for read mappings overlapping
multiple genomic features (e.g. genes or CDS) is similar to the union
model of HTSeq-count (Anders er al., 2014) with one difference: we
include read mappings of the two cases marked as ambiguous by HTSeq-
count’s union model instead of discarding them (Supplementary Fig.
S1). In the ﬁrst case, reads fully contained in the first feature and over-
lapping the start of a second feature are associated to the first feature. In
the second case, reads fully contained in two overlapping feature are
counted proportionally for each of the overlapped features.

In addition to the general export functionality, the TPM or RPKM-value
distribution of the analyzed data set can be visualized in a log-scaled
histogram (see Figure 2). All bin borders are dynamically calculated
according to the percentage they contribute to the result.

2.3. TSS Analysis

The transcription start site (TSS) detection has been substantially en-
hanced towards a more detailed analysis of TSS properties. In some
cases the coverage increases in steps at a TSS. To consider this case, an
option was implemented to associate all predicted TSSs within a small
user-defined bp window to the statistically most significant TSS. Hereby,
neither several predicted TSS appear for one gene, nor is any of them
lost.

To identify at a glance if evidence for alternative TSSs exist, all identi-
fied TSSs within a user defined window are classified. The statistically
most significant position is designated as "primary" TSS, while all other
TSSs on the same strand are marked as "secondary". In many microbial
organisms the majority of transcripts contains a leader, but transcripts
can also be leaderless (Pfeifer-Sancar er al., 2013). To distinguish both
cases easily, leaderless transcripts are ﬂagged in the result and can thus
be retrieved instantly. The maximum distance of a TSS to the actual
translation start site can be adjusted in the wizard. To offer a deeper
insight into novel transcripts identified by the analysis, the TSS detection
further computes the next start codon on the respective strand, the leader
length and the next in-frame stop codon. The novel transcript length is
deduced from the assigned start and stop codons. Another new feature is
the option to configure the length of exported upstream and downstream
regions for promoter analysis.

2.4. Differential Gene Expression with DESeq2

To offer easy access to one of the most recent analysis tools for differen-
tial gene expression analysis, we added DESeq2 (Love er al., 2014) to
the set of integrated tools. With baySeq (Hardcastle and Kelly, 2010) and
the original DESeq (Anders and Huber, 2010) already integrated,
Reaprlorer 2 offers three widely used analysis tools for identifying
differentially expressed genes. The settings for the analysis can be easily
specified by a step-by-step wizard in the same fashion as for the already
integrated tools (Supplementary Fig. S2-S6).

: 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 1110.1} papBOIIIAAOG

910z ‘09 Isnfv’nv 110 2

 

Dashboard is Pseudumunas aeruginusa P7101 21114 nrhi gbk Detailedll'iewer Wll’ldqu7LE4ZDﬂn479D1 Jukgexhended bani a Rere rengereamre Window

4 in — 07,5121)um Linkgextmdedbaii
I] Hismgrem | , Type: cos

Legend Alignment | ll MUS: “10343

 

Read Pairs | GET:

start: 335554
peuaaz _ l I I
CulurHIslugram l | I i
335750 336000 306250 336500 Ship: 336351

I I I I I EC number:

I l I l I
305500 335750 306000 336250 306500
new;

Pruduet: hypnﬂ'thEal protein

ll

name

Strand: reverse

Parents: PRIZE-13
01111211um Link_emided.haii
Read Pair Details

Read Palr 1

Type: Unique Enlarged Pair
Repliratas‘ 1

Dlsfante: 1131

res: ND rhlldren

ll

Legend Options

‘ Mapping 1: -1ype:5ihgleaestMetch. -steri:335392. -5mp:3ss492. -0rlentahor\:Forward
MaDDlng2: rTVDEISlnglEBeslMalth. estarl:386423. smmsaszs. rOrlEnlatlun:REVErse elltlervaledgw

 

Left: 395129

Right: 3137575

Muuse pus : 3135411

Vlslble features:
CD5: 2

Highlighted couch:
Starts:

‘ITGCTG

snaps:

OulpuleGASVoulput Gnsvwingcrw as
Imported table from‘ D77342El£iriPAO1.]Dkgxtendadhamgasv in (luster; x

#CIUSDELID: Leﬂchr. LEHﬁrEakPalntSfErt: LeftBreakPninlfnd: Rightﬂhr: RighlﬁreekPnintslart: RighlﬁreekPmnlEnd. Nurn PRS.
e1575 1 333297 334275 1 2231575 2232442 93

C2065 1 3996-17 405637 400132 406201 51
E2220 1 434767 440225 435300 440740 54
e2495 1 499735 4991356 5D 1154 5u12a5 73
e2517 1 52u352 527234 521353 527735 51
52748 1 551137 5552313 55157-1 555732 55
C3043 1 610062 613255 619255 6194-43 53 1222 V

Figure 3: Visualization of genome rearrangement events using GASV (Sindi et a/., 2009). Reaprlorer 2 offers an effortless exploration of
the data underlying the genome rearrangements detected by GASV (table at the bottom). The region of the deletion selected in the table
is centered simultaneously in the reference, track and read pair viewer. In the example, the hypothetical protein PA0343 is deleted in P.
aeruginosa strain B420 from the study by (Hilker et a/., 2015). No reads map to the corresponding region of P. aeruginosa PAO1 and
many read pairs are observed in B420 with an enlarged distance of about 1200bp instead of the expected 300bp.

gions lead to many false positive rearrangement predictions obscuring
the correct predictions.

: 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 1110.1} papBOIIIAAOG

2.5. Genome Rearrangement Detection

Genome rearrangements or structural variations (SVs) are associated to 2_6_ Correlation Analysis
many diseases including cancer (Iafrate er al., 2004). In addition, ge-
nome rearrangement detection is useful for the phylogenetic analysis of
eukaryotic and prokaryotic organisms.

A correlation coefficient can be used to identify regions of two tracks
mapped to the same reference showing very similar or completely differ-

. . ent covera e to identif similarities and differences in the data sets
In general, the tools for SV detectlon are command-11ne based. Integrat- g y

910z‘0518n3nv 110 I

automatically. Two exemplary applications are: The comparison of 2
RNA-Seq data sets (e.g. a whole transcriptome and a 5’ enriched one) to
identify all TSS regions correlating in both tracks or retrieval of all

ing an established SV detection tool into Reaprlorer 2 makes genome
rearrangement detection accessible for researchers unfamiliar with
command-line tools and enables immediate visual inspection of read pair _ _ _ _ _
. . . . . . . . genom1c reglons w1th correlat1ng expresslon patterns. To compare 2
conf1guratlons 1n genom1c reglons w1th pred1cted SVs (see F1gure 3).

We chose GASV 2.0 (Sindi et al., 2009,
http://compbio.cs.brown.edu/projects/gasv/) for integration. Its develop-
ment focused on the human genome, but it has also been tested success-
fully on other genomes like yeast (Zeitouni er al., 2010). GASV supports
a broad range of rearrangements: insertions, deletions, inversions, trans-

tracks, we divide the genome into intervals of user defined length and
perform statistical correlation analysis of the coverage value pairs for
each position within each interval. The options are configured on a single
wizard page, where the user can choose the correlation method and
additional parameters. The two implemented methods to calculate the
correlation coefficient are (i) the Bravais-Pearson (Pearson, 1895) prod-
uct-moment and (ii) the Spearman’s rank (Spearman, 1904) correlation
coefficient.

Speannan’s rank correlation coefﬁcient has the advantage that no as-
sumptions on the underlying probability distribution have to be made and

locations and can handle more divergent rearrangement events i.e.
resulting from multiple rearrangements at the same locus.

To guarantee ﬂexibility for the user, the GASV wizard in Reaprlorer 2
offers all options available for the command line version of GASV.

Note that only Single Perfect Match and Single Best Match mappings are
allowed for the GASV analysis. Testing different mapping classifications
with different example data sets showed that it is inevitable to use only

these two classes to produce reasonable results. Otherwise, repeat re- 2_7_ Visualization of 3pm Read Mappings

no linear relationship is required between the random variables.

 

ht_tp://www.expasy.org[

ht_tps://www.computationalbio.uni-giessende/zalaxy/

/810's112um0fp10}x0"souBLuJOJutotq/ﬁduq

i i i i I I l i i i
7417200 7417300 7417400 7417500 7417600 7417700 7417800 :91: 1°75“ Nt‘Hillitlr- leilﬁiI/U

 

 

AT4G12510

CoIO-I, unique reads only

 

Colo-1, extended classification

 

Figure 4: The difference of the read coverage between only uniquely mapped reads (middle row) and using the “Single Pen‘ect Match” and
“Single Best Match” mapping classes is shown for the genes AT5G46900 and AT4G12510 (upper row). In total numbers 144 and 78 more

 

 

AT5G46900

Colo-1, unique reads only

 

Colo-1, extended classification

 

reads can be included in the analysis respectively when using the extended read mapping classification.

Results

We used Reaprlorer 2 for the evaluation of an Arabidopsis thaliana
RNA-Seq test data set that was generated for this purpose. Several of the
aspects described above were addressed, namely extended read classifi-
cation, improved handling of eukaryotic data and the DESeq2 integra-
tion. The experiment focused on differential gene expression analysis
between the A. thaliana Col-0 wild-type and a myb11-12-111 triple-
mutant line (Supplementary methods); array-based data for this biologi-
cal material are available (Stracke er al., 2007). Three biological repli-
cates, each of them consisting of two technical replicates, were created
from wild-type and mutant each. The 12 samples produced ~183 million
usable reads that were mapped to the TAIR 10 A. thaliana Col-0 refer-
ence. Besides Visual inspection, we started the analysis with a “read
count and normalization calculation”, to check the integrity of the bio-
logical and technical replicates. This was achieved by plotting their TPM
values against each other to check for correlation (Supplementary Fig.
S7). For all except one technical replicate, the resulting expression
values corresponded to each other (were located close to the 45° diago-
nal). Thus, the problematic technical replicate was excluded from further
analysis. Further investigation showed that in the problematic sample
rRNA removal was incomplete. This experimental complication occurs
at low frequency with the RNA-Seq kits from Illumina.

To identify differentially expressed genes between the wild type and the
mutant and simultaneously monitor the effect of employing the extended
read mapping classification, we applied DESeq2 via Reaprlorer 2
twice with different included read mapping classes. Once, we only used
the uniquely mapped reads and in the second case, we used the Single
Perfect and Single Best Match mapping classes — also including reads
with a distinctive best mapping. The latter selection enabled us to include
on average 1,400,000 more reads per data set in the analysis (Supple-
mental Table S1), leading to more accurate gene expression values and
minimizing underestimation of expression levels. This effect can be
observed even in the most differentially expressed genes (Figure 4). Two
examples are the genes AT5G46900 and AT4G12510. Their mean ex-
pression is increased from 299 to 379 reads in the first case and from 135
to 189 reads in the second case. These and other examples (Supplemen-
tary Table S2) convincingly show that the level of differential gene
expression is underestimated if only uniquely mapped reads are used. In
total, the expression of 13,850 of all 28,775 annotated genes is underes-
timated. Of these, 1896 genes can be assigned > 100 and 153 genes >

1000 additional mappings when applying the extended read classifica-
tion. The comparison of the DESeq2 results between only incorporating
uniquely mapped reads and using the Single Perfect and Single Best
Match mapping classes is shown in Supplementary Table S3.

Additionally, we show in Supplementary Table S4 that Reaprlorer 2
offers several unique features and combines many useful features that are
not present in this composition in one of the other commonly used read
mapping visualization tools like Savant (Fiume er al., 2012), 1GB (Nicol
er al., 2009), Artemis (Carver er al., 2012), IGV (Robinson et al., 2011)
and GenomeView (Abeel er al., 2012).

Finally, we assessed the performance of analysis functions offered by
Reaprlorer 2. We benchmarked the performance on small (~6 mb),
medium (~120 mb) and large (~3 gb) reference genomes (Supplementary
Table S5). This assessment also includes a comparative runtime bench-
mark between Reaprlorer 1 and Reaprlorer 2 (Supplementary Table
S6). The results show that on the same hardware the new version of our
software significantly outperforms the older release when the same tasks
are executed.

Discussion

The comprehensive read mapping data visualization and automatic
analysis tool Reaprlorer 2 features substantially enhanced capabilities
from one source. The major improvement presented here is the extended
read mapping classification which leads to more specific analysis results
as shown in the results section. Further, the extended classification
enables meaningful integration of multiple mapped reads and creates
awareness for the different types of multiple mapped reads, e. g. to identi-
fy repetitive regions (Figure 1). Moreover, two newly implemented
analysis functions and substantial improvement of existing analyses
widen the spectrum covered by Reaprlorer 2 and enable the user to
screen for genome rearrangements and correlation between two data sets
without the need to install additional software. The read count normali-
zation can now be compared between different samples as the added
TPM normalization is invariant between samples. With DESeq2 another
widely used differential gene expression analysis package is available
from within the software. The enhanced TSS detection allows deeper
insights into the TSS landscape by analyzing additional properties of the
TSS and presenting them to the user. The application range of ReadX-
plorer 2 is further broadened by improving the handling of eukaryotic
data.

U
0
S
5
._
O
m
D.
("D
D.
Pt
._I
O
B
:T'
Q
":2
Q
CF
i—i.
O
i—i.
5
Pr:
0
Pi
B
m
5’.
O
5’1
O
><
Pr:
0
Pi
8-.
O
:2
Pi
5
m
._
5’1
0
Pi
(IQ
\
m
i-r

910z ‘09 isnfv’nv 110

 

Eﬁigogmoﬁammowoio~&o:~=£¢o~m\

Eﬁigogmoﬁammowoio~&o:~=£¢o~m\

