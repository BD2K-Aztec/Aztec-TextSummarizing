ORIGINAL PAPER

Vol. 26 no. 7 2010, pages 939-945
doi: 1 0. 1 093/bioinformatics/btq0 74

 

Systems biology

Advance Access publication February 21, 2010

An optimal experimental design approach to model discrimination

in dynamic biochemical systems

Dominik Skandal and Dirk Lebied21’2’*

1Center for Analysis of Biological Systems (ZBSA), University of Freiburg, Habsburgerstr. 49, 79104 Freiburg and
2|nterdisciplinary Center for Scientific Computing, Im Neuenheimer Feld 368, 69120 Heidelberg, Germany

Associate Editor: Olga Troyanskaya

 

ABSTRACT

Motivation: Finding suitable models of dynamic biochemical
systems is an important task in systems biology approaches to the
biosciences. On the one hand, a correct model helps to understand
the underlying mechanisms and on the other hand, one can use the
model to predict the behavior of a biological system under various
circumstances. Typically, before the correct model of a biochemical
system is found, different hypothetical models might be reasonable
and consistent with previous knowledge and available data. The main
goal now is to find the best suited model out of different hypotheses.
The process of falsifying inappropriate candidate models is called
model discrimination.

Results: We have developed a new computational tool to compute
optimal experiments for biochemical kinetic systems with underlying
ordinary differential equation (ODE) models for the purpose of
model discrimination. We were inspired by the demands of
biological experimentalists which perform one run measurement
where perturbations to the system are possible. We provide a
criterion which calculates the number and location of time points
of optimal measurements as well as optimal initial conditions and
optimal perturbations to the system.

Availability: The model discrimination algorithm described here is
implemented in C++ in the package ModelDiscriminationToolkit.
The source code can be downloaded from http://omnibus.uni-
freiburg.de/~ds500/_software.html

Contact: dirk.lebiedz@biologie.uni-freiburg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 4, 2009; revised and accepted on February
17, 2010

1 INTRODUCTION

Typically, before the correct model of a biochemical system is found
different hypothetical models might be reasonable and consistent
with previous knowledge and available data. Let us assume that
all the models have in common that they ﬁt one initial series
of measurements. The main goal now is to ﬁnd the best suited
model out of different hypotheses. This is usually done by iterative
measurements and successive ﬁtting of the different models to the

 

*To whom correspondence should be addressed.

collectivity of all series of measurements. This is repeated until
all ‘wrong’ models do not ﬁt to the collectivity of all series of
measurements any more. Thus, the ‘wrong’ models are iteratively
falsiﬁed. The whole process is called model discrimination.

To discriminate a set of candidate models against a given set of
experimental data often likelihood ratio tests based on bootstrap
methods are preformed (see e.g. Horn, 1987; Stricker et (11., 1994;
Timmer et (11., 2004). Ranking methods like Stewart’s method
(Stewart et (11., 1998) or the well-known Akaike information criterion
(see e.g. Burnham and Anderson, 2002) are popular as well in the
ﬁeld of biological modeling. Applications can be found, for example,
in Jain et (11. (2006) or Bernacki and Murphy (2009).

This article deals with the problem of designing experiments
so that these methods can be applied in an optimal sense. This
fundamentally differs from the case of ﬁnding an experimental
design to best estimate the parameters of a model for a given
experimental system (see e.g. Balsa-Canto et (11., 2008; Bauer
et (11., 2000; Korkel et (11., 1999). An overview of different
experimental design techniques can be found in Kreutz and Timmer
(2009). Different approaches to design experiments for model
discrimination exist. Beside optimization methods (see e.g. Cooney
and McDonald, 1995; Kremling et (11., 2004; Lacey and Dunne,
1984; Takors et (11., 1997), a model-based feedback controller (see
e.g. Apgar et (11., 2008) and Markov Chain Monte Carlo sampling
methods (Myung and Pitt, 2009) are used to construct an appropriate
design.

We have developed a new computational tool to compute optimal
experiments for biochemical kinetic systems with underlying
ordinary differential equation (ODE) models for the purpose
of model discrimination. We were inspired by the demands of
biological experimentalists who perform one run measurement
where perturbations to the system are possible. We provide a
criterion which calculates optimal measurement time points instead
of a continuous design (see e.g. Atkinson and Fedorov, 1975;
Cooney and McDonald, 1995; Kremling et (11., 2004). The theory
of the new criterion is presented in Section 2. In Section 2.1,
we give a brief overview of KullbaCk—Leibler (KL)-optimality
introduced by Lopez-Fidalgo et (11. (2007). In Section 2.2, we derive
our optimality criterion by use of KL-optimality. In Section 2.3,
we present the numerical implementation of our optimal design
algorithm. Numerical results on allosteric models for glycolytic
oscillations are presented in Section 3. We provide Supplementary
Material for more details on theory and applications.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 939

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”Idllq mot} papBoru/vxoq

9103 ‘{g anﬁnv 110::

D.Skanda and D.Lebiedz

 

2 DISCRIMINATION BETWEEN DYNAMIC
BIOCHEMICAL MODELS

2.1 KL-optimal design

In this section, a model discrimination criterion based on the KL
distance called KL-optimality introduced by Lopez-Fidalgo et (11.
(2007) is brieﬂy presented.

Lopez-Fidalgo et (11. (2007) demonstrate that KL-optimality is
consistent with T-optimality (Atkinson and Fedorov, 1975) and
generalized T-optimality (Ucinski and Bogacka, 2004), which are
well-known model discrimination criteria.

The advantage of the KL-optimality criterion is that it does not
depend on the general non-linear regression models y1 and y; with
corresponding candidate Models 1 and 2

Y1,2=771,2(x791,2)+€7 XEX (1)

where the random variables 6 are independent and normally
distributed with zero mean and constant variance (72 and 111,2(x, 6112)
are the model functions with unknown parameters 61 6 £21 Cle
and 62 6 S22 CRmz, but treats the more general case of two rival
density functions f1(y,x,61,1') and f2(y,x,62,1'), where 1' is a
parameter, e.g. the variances of the models.

The KL distance (Eguchi and Copas, 2006; Lindsey, 1996) of
Model 2 with density ﬁinction f2(y,x,62,r) from Model 1 with
density functionf1(y,x,61 ,1") is deﬁned by

7 79 7
1(1’171371679179271):[1’10716791701025{1M}d 7 (2)

f2©7x7927ﬂ
Vxex.

The KL distance is a non-symmetric measure of the difference
between two probability distributions. The integral is computed over
the sample space of the possible observations. If the probability
space is discrete the integral Changes to a sum.

As reviewed by Eguchi and Copas (2006), the KL distance is
Closely related to likelihood ratio tests. Considering f1 (y,x,61 , 1') as
being a null hypothesis H and f2(y,x,62,1') being the alternative
hypothesis A, the log likelihood ratio is deﬁned as

13071679271) }
13071679171) -

Intuitively, one expects My) to have a high value if A is true and
both probability distributions are reasonably well separated.

The Neyman—Pearson lemma [a proof is given in Lindsey (1996)]
justiﬁes the optimality of the likelihood ratio critical region

W={y:My)Zu}7 (4)

with respect to Type I and Type II errors. We denote PH(W) as
the probability of the region W under the assumption that the null
hypothesis is true. By setting 11 such that PH(W) :01, one can use
W as a critical region to reject H by applying the likelihood ratio
test. The Neyman—Pearson lemma states that this critical region is
superior to any other W* with respect to the Type II error, i.e.

A=A(y)=10g{ (3)

PA(W)ZPA(W*)7 (5)

where PA (W) is the probability of W if the alternative hypothesis A
is true. For this critical region W, one can see that the Type II error
is as much smaller as the mean with respect to A of the likelihood
ratio My) is bigger.

The mean with respect to A of the likelihood ratio My) is given by
f2©7x7627 1) 
— y_
f1 0 7 X 7 91 7 T)

Therefore, E A {My)} = 71f; , f1 ,x, 62,61 ,1") which directly leads to
the KL-optimality criterion

121(5):

EA {A00} =/f2(y7x79271)10g{ (6)

 (7)
11071497617175) ’

where 5 denotes the set of all experimental conditions subject to
optimal design.

m§X/f2(y7x(§)7927f75)10g{

2.2 Mathematical construction of the optimal
experimental design

In the following section, we use the framework of the KL-optimal
design to derive an optimization criterion which is constructed
to best ﬁt the needs to discriminate between models of kinetic
time series experiments often performed by biologist, e.g in vitro
experiments of enzyme kinetics.

In most situations such experiments are time and cost consuming.
Therefore, one wants to get the most information out of a single
experiment taking place within a given ﬁxed time span. This
means that in an optimal experimental design the most informative
measurement time points for one measurement run have to be
calculated in such a way that only one measurement at one time
point can be performed.

Often, an experiment cannot produce measurements in a time
continuous way. Therefore, we assume that there has to be a minimal
time Al for the separation of measurement time points.

Additionally, the initial species concentrations of the participating
species should be Chosen in a most discriminating way.

A commonly used in vitro practice is to disturb time series
measurements by external adding of species quantities. In the
context of model discrimination, one wants to know the optimal
time point of perturbation and the optimal species quantities, which
should be added to the experimental system. We further assume that
a measurement cannot be done at the same time as a perturbation.

Given the measurement time-vector [6R1 with entries for
the N measurement time points ti,iel,...,N such that n+1:
ti, the model response vectors yig22=y112(ti_1,ti,yi1’_21+ci,6132),
ie {1, ...,N} are the solution of the ODEs

dY12 ‘ -_ .
d—t’=$01,2(Ii—17I7y121+Ci791,2)791,2)7 1617---7N- (8)

The vectors cl- denote species quantities the experimental system
gets perturbed with.  are the right hand side functions of

the ODEs of both models. ygz :=y1 denotes the initial species
concentration y] which is the same for both models.

The vector y), denotes the species concentration of a measurement
at measurement time point ti.

By assuming normally distributed error vectors 61.1 and 6; with
zero mean and variance functions (121(yli,ti,61))2 and (v2(y§, Il- , 62))2
according to models 1 and 2 one gets for the regression models

yti =y11 +611 7
i i 
yti =y 2 + 62

 

940

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”Idllq 11101} papeolumoq

9103 ‘{g anﬁnv 110::

Optimal experimental design approach

 

the two model probability distributions f1 for model 1 and f2 for
model 2 for one measurement time point
'—1
f1,2(Yt,IIi—17ti7y11,2 7912761):
1
v ZJTIVZLZI

e—1<y3,2—y,,)TV:,2<y;,2—y,)7 (10)

with lviﬁzl=nﬁlv€32(y12,ti,6132) and diagonal matrices V132
with diagonal entries [Vial]=(1/v€32(y12,ti,6132))2 and the

number of species concentrations M.
We allow for different error models for both candidate models.
The error model is dependent on the species concentrations yiﬁz,
the time t,- and possibly on parameters 61,2.
For the sake of simplicity we deﬁne

'—1
11,201,)2=f1,201,|Ii—17Ii7y12 791,279)- (11)

With this notation one gets both the probability distribution
models for all N measurement time points

N
mo): 1111207.). (12)
i=1

However, by assuming such a model probability distribution one
does not prohibit that at one time point several measurements can
be performed.

To overcome this problem, we ﬁrst extend the probability space
R94 (where M is the number of species) of the i-th measurement by
a one state set to

RM u/v,. (13)

The state of the set  with P M e[0, 1] denotes the probability
that no measurement is performed.

Then, we introduce the Heaviside functions

®,®*:R+—>[0,1] (14)
with .

®<~>={5:::::::7 
and

Wat-#111222:- 

By use of these Heaviside functions, we deﬁne the new model
probabilities

N
151,20): n@(ti)f1,2(yt,)7

i=1

f1,2i(y7.;ke{17...7N}\{i}>

N7i¢j
=e*(z,-) n 9091011201), iel,...,N
j=1
f1,2ilai2(y7.;ke{17...7N}\{i17i2}>=
N7i1¢1siﬁéj
eminent-2) ]'[ @(zj>f1,2(y7,>7
j=1

With 11,261,...,N,11<12, (17)

N
f1,21:"”N=1'[®*(z.->.
i=1

In this case ®*(Ii) is the probability P M that no measurement

is performed at the i-th measurement time. The sum over all )5
now gives the probability density of one experimental outcome. By
integrating the density one has to take care that the different )5 are
deﬁned on different spaces. The non-disjunct conjunction of these
different spaces now deﬁnes the probability space used.

By introducing these modiﬁcations, the reduced probability
distribution functions f~112(y) do not dependent on the measurements
that are performed in less than At time after the previous
measurement anymore.

To take into account that a species concentration perturbation to
the system can only be performed if no measurement is done, the
same procedure is repeated with the Heaviside functions

_ liftizAt
®(’l)—{0ifz,-<Az’ (18)
* ._ OiftizAt
® (tl)_{1ifti<At’ (19)
and
. _ 0 ifci>0
®(cz)—{ 1 ifci=07 (20)
1'f - 0
9*(Ci)={01f:l-:0‘ (21)
l_

The model probabilities now are deﬁned in the same way as above
by replacing @(Ii) with @(Ii)®(ci). One further has to exchange
9*(11)

9*(11') —> (®(Ii)®*(Ci)+®*(Ii)®(6i)+®*(Ii)®*(6i))- (22)

Inserting the two probability models into the KL-optimality criterion

I: [f1<y>log{j.%}dy7 (23)

one gets

®(Ii)®(Ci)f2(yt-)
I: i i . 1 —' d ‘
;[/®(t)®(c V201,) 0g{®(ti)®(6i)f1(yti)} y;, +

(em-)eﬂci)+®*(zi)®(ci>+®*(zi>®*(ci>)- (24)

®(Ii)®*(Ci) + 9*(Ii)®(Ci) + 9*(Ii)®*(Ci)
®(Ii)®*(Ci) + 9*(Ii)®(Ci) + 9*(Ii)®*(Ci) -

 

Due to the fact that log(1) :0 this simpliﬁes to

N
f2(Yt-)
I: eie, .71 —'d.. 25
g (2) (0/130) og{f1(yti)} yt, ( )

 

941

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”Idllq urog papBo1u/vxoq

9103 ‘1g15n8nv 110::

D.Skanda and D.Lebiedz

 

center b center b

 

 

 

 

 

 

 

 

 

 

4— width 3 width 3

 

Fig. 1. Switching functions: the left switching function is used to guarantee
that only one measurement is done at a time point, the right one is used to
guarantee that if a perturbation is done at a time point no measurement is
done at the same time point.

By inserting the normal distribution this further simpliﬁes to

1 N
I: 5 gem-me.)-

% (1(y37zi762>>2+((yg>j—(y§>j)2_

~=1 (7, 0' 727-761)?

2log<—V]2(y.271i762)):| —M).
710371-761)

A detailed derivation can be found in the Supplementary Material.

This criterion has to be maximized with respect to the initial
concentrations y], the measurement time points I and the system
perturbations c.

For our optimal experimental design, we generally start with more
measurement time points than needed. By use of the step functions,
the number of measurement time points gets reduced in the sense
that for t,- < At the corresponding measurement time point is ‘turned
off’.

It should be noted that the Heaviside functions can be replaced
by any appropriate switching functions i.e ®+®* = 1 and 8,
9* E [0, l], e.g. continuous functions.

(26)

2.3 Numerical implementation of the optimal
experimental design

To solve the maximization problem (7) numerically by applying

efﬁcient derivative-based optimizers, we replace the Heaviside

functions 90,-) and @(ci) by continuous approximations,

parameterized hyperbolic tangent functions

and [tanh (— —6(Aci_bz)) + 1]
e(c,-)=  (28)

The parameters (11,2 Characterize the width of the transition
region between 0 and 1. The parameters 191,2 determine the center
of the transition region (Fig. 1). By setting the parameters in an
adequate way, one can construct arbitrarily Close approximations of
the Heaviside functions.

The optimization problem is formulated in a multiple shooting
setup (see, e.g. Book and Plitt, 1984; Book, 1987; Stoer and Bulirsch,
2002). The idea of the multiple shooting method is to subdivide

modiﬁed
matching condition

Fixed end time T

 

concentration

 

4— At —> tim;

Fig. 2. Scheme of the multiple shooting setup for numerical computation of
the experimental design. One dot denotes one measurement time point. The
black line denotes Model 1 and the dashed gray one Model 2.

the interval [0,Tend] into several subintervals on each of which an
independent initial value problem is solved. In our implementation,
each end point of a subinterval corresponds to one measurement time
point. Matching conditions which enter the optimization problem as
additional equality constraints assure continuity of the optimal state
trajectory from one subinterval to the next one.

To incorporate the perturbations c, these matching conditions

Y1,2(Ii—17117311,2},i—1791,2)-S{1,2},i=0 (29)

where s{1,2}3i denotes the multiple shooting nodes are modiﬁed to

Y1,2(Ii—1 7117311,2},i—1 791,2)-S{1,2},i =Ci- (30)

A graphical scheme of the multiple shooting setup is shown in
Figure 2.

For simplicity, we consider the homoscedastic case with equal
variances, i.e. v1 =v2=02.

The overall optimization problem can be stated as
max I

Xinitiuls A176, 51 , 52

N
2
I=Z[y1(07Azi;s1,i761>—y2(07Amway] ampere»

i=1

 

 

subject to
dY1(I) rhv dy2(t) rhv
= ‘ I 1 = ‘ I 1
dt f1 0’10) dt f2 0’2( ))
31,0=y07 32,0=y07

y1(0, Ali;slgi,61)—s1,(i+1)=ci, 16 [0, ...,N—2],
y2(07 Ali;sz,i792)—32,(i+1)=Ci7 i6 [07 ---7N—2]7

you... Eyo 90.1.7

OEAIEImaX7

(31)

DECS Cmax7

31.... £31 Sslm

32.... E32 5 32

max 7

N
ZAIi=Tend.
i=1

Numerical optimization is performed by the interior point package
IPOPT (Wachter, 2002; Wachter and Biegler, 2006) using the linear
solver MA27 (HSL, 2007). The numerical integration as well as the

 

942

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”Idllq urog papBo1umoq

9103 ‘1g15n8nv 110::

Optimal experimental design approach

 

sensitivity generation within a multiple shooting discretization is
done by the CVODES integrator package (Serban and Hindmarsh,
2005). All derivatives are calculated by automatic differentiation
using CppAD (Bell and Burke, 2008).

3 NUMERICAL RESULTS

3.1 Allosteric models for glycolytic oscillations

As a test case for model discrimination, we implemented the
following models describing glycolytic oscillations (Goldbeter,
1996).

0 Model 1 describes an allosteric model with positive feedback
and linear product sink.
The differential equations are given by

do
a =v—o¢(a, y),
dy _
a —€I¢7¢(¢¥7 V) —ksl/7
_ wu+oz>u+y>2
(“a”)— L+(1+a)2(1+y)2-

0 Model 2 describes an allosteric model with positive feedback
in the absence of cooperativity when the product sink is
represented by Michaelis—Menten kinetics.

The differential equations are given by

 

d
d—(:=v—¢(0t7y)7
dy_ m/
a —q¢(w7y)— [H
_ a(l+y)
¢(“’y)_L+(1+a)(1+y>‘

The species concentration of the substrate is denoted by a and the
concentration of the product is denoted by y. For both models the
inﬂow parameter 1) is the same. It is regarded as known and was set to
v = 0.22. It represents the inﬂow of the substrate to the experimental
system, here a tank reactor. The parameter sets (a, q, ks , L) of Model 1
and (q, rs, I1,L) of Model 2 are independent of each other and are
regarded as unknown.

Due to the non-availability of experimental data, we simulate data
by use of Model 1. Note that a of the parameter set of Model 1 and
the variance (72 are not the same. To generate a measurement we
add a normally distributed error term with zero mean and variance
(72 = 1 to the simulated data. The used parameter set is (8.89 X 10—1,
2.16,1.11><10_1,1.76 X 104). We simulated in atime span of AT:
400 with initial concentrations ofa: 1.47 X 101 and y=2.21. After
10 numerical integration time steps, a simulated measurement is
generated. Both models were ﬁtted to the simulated data to determine
the model parameters as well as the initial species concentrations.
The ﬁtting was performed by stande least squares minimization
implemented in the same numerical optimization framework as the
model discrimination. The results of the ﬁtting procedure are shown
in Figure 3. The result after the ﬁtting procedure for Model 1 is
the parameter set (8.79 X 10—1, 2.03, 1.09 X 10—1, 1.61 X 104) and
initial concentrations a = 1.50 X 101 and y: 1.92. The result of
Model 2 is the parameter set (6.47, 3.33, 5.11, 2.44 X 102) and initial
concentrations (1:1.47 X 101 and y: 1.16.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a) X measurement speciest 
+ measurement species2
0_ —model response speciest 0.
o . o
N —mode| response species2 (\l
X X
x X X x
X X
X A X X r\ X X
    W
E x x X E x *x xx X
E E o
8 3 X 8 as X
E v— E v-
o o
o 0
++ + ++ +
+ +
A: AA + gala AA + 3:}.
+ ++f+ \t/ N + 9+ V \+
+ + + +
' +++ + ' + +++ +
o. 0.
93.0 200. 400.0 00.0 200.0 400.0
time time
model 1 model 2

Fig. 3. The parameter ﬁt of Model 1 (a) and Model 2 (b) to the generated
data are shown.

a o

E

20.
E
0

1 .

1/Model
1/Model

2/Model
2/Model

concentration
15 0

concentration
5 0

   

0.0
0.0

F00 200.0 400.0 0.0 200.0 400.0
time time

Fig. 4. The model responses are shown before the optimization procedure,
(a) species 1, (b) species 2. One square represents one measurement time
point.

3.2 Results of model discrimination procedure

With the so generated parameter estimates of Models 1 and 2, we
start the model discrimination algorithm on an overall time span
Tend=400. We insert 100 equally spaced possible measurement
points. The initial species concentrations to start the procedure are
set to (1:15 and y=2 and are restricted to be less than 25. The
parameters of the switching ﬁinction @(At) are Chosen as (11 :20
and bl = 10. With these parameters we expect the minimal time span
between two measurement points to be bigger than 10 time steps.
The parameters of the switching ﬁinction @(c) are Chosen as
(1; =0.05 and [9; =0.025. We ﬁrst calculate an experimental design
as the solution of problem 31 where no perturbations on the system
are allowed. Therefore, the design is optimal with respect to the
initial concentrations and the measurement time points. In Figure 4,
the situation before the optimization procedure is shown. One can
easily see that the model response of Models 1 and 2 are very similar.
The result after the optimization procedure is shown in Figure 5a.
The measurement time points were reduced from N = 100 to N = 31.
Both model responses are well separated. The computational time to
calculate the experimental design was 52 s on one core of a Intel(R)
Xeon(R) X5460 CPU with 3.16GHz. In a second run we add at
ﬁve measurement points the ability to perturb the system by adding
species quantities less or equal to 10 for each species. We further
restricted the sum of all initial species concentrations and species
perturbations to be less than 100. The results are shown in 5b.

 

943

112 /3.to's[BumoIpJOJxosotwurJOJutotq”:dnq urog papro1umoq

9103 ‘1g15n8nv 110::

D.Skanda and D.Lebiedz

 

A
in
v

10.0 20.0 30.0 40.0

A
5'
v

10.0 20.0 30.0 40.0

1/Model 1

1/Model 2 1/Model

concentration
concentration

   

0.0

o

.0 200.0 400.0 .0 200.0 400.0
time time

120.0 00.0
120.0

2/Model 2/Model

concentration
80.0
80.0

40. 0
concentration

40.0

   

.0

q
:00 200.0 400.0 out) 200.0 400.0
time time

Fig. 5. The discriminating optimal design is shown, (a) with respect to the
initial species concentrations and optimal time points and (b) additionally
with optimal perturbations to the system. One square represents one
measurement time point.

 

(a) X measurement speciest (b) J
+ measurement speciesZ

—model response speciest
—model response speciesZ

 

 

20.0
20.0
X

 

X X X

x X/\ 10 x, 7 A
’VX‘W EX

 

 

10.0
x

concentration
1 0. 0
X
concentration

 [\A

Jag: Vtx  wet/1X-

++ +

 

 

 

 

 

 

 

 

 

 

 

 

+ + + +
C2 C2 +
O00 200.0 400.0 O00 200.0 400.0
time time
measurement 1 measurement 2

Fig. 6. The coincidental parameter ﬁt of Model 1 to the ﬁrst generated dataset
(a) and second generated dataset (b) is shown.

Now both model responses are well separated over the entire time
span. The number of measurement time points is reduced to N = 27.
The computational time to calculate the experimental design was
118 s on one core of a Intel(R) Xeon(R) X5460 CPU with 3.16 GHz.

By use of the optimal design calculated with respect to the
initial species and optimal time points, we again generate data
with the correct Model 1 with correct parameters according to the
experimental design. After that we ﬁtted both models coincidentally
to the ﬁrst generated samples and the second generated samples. In
Figure 6, one can see that Model 1 naturally ﬁts both generated
samples as expected. To test for a local optimum Model 2 was
ﬁtted 50 times with uniform random distributed initial values in the
range of [0, ...,100000] for each parameter. The best ﬁt is shown
in Figure 7. As one can see Model 2 does not coincidentally ﬁt all
measurements and therefore Model 1 should be favored. In that sense
we are able to clearly discriminate between Model 1 and Model 2 by
the use of the optimal design. An effective way to search for a global

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a) Xmeasurementspeciest (b) '-
+ measurement speciesZ
—model response speciest
Q — d Ires onses eciesZ Q
a m e P P 8 xx X
X X X x X
N X X x )< X X
X X X y x
E a X x )0 x X E X
36 x X )9 Xx x 36 x XXX
: : .><
: c, X I: o )2
8 cs 8 cs X
E '— E '—
0 0
+ +
+ + + + ‘t
+ ++"’ .i.+¢ + +
+\ +‘r + I T +
+ 75"” + 1' 1’+ / + + +
+ + + + + ++++ +
++ + + + +
C2 c2 +
O00 200.0 400.0 O00 200.0 400.0
time time
measurement 1 measurement 2

Fig. 7. The coincidental parameter ﬁt of Model 2 to the ﬁrst generated dataset
(a) and second generated dataset (b) is shown.

optimum is the global scatter search method, see for example, Egea
et (11. (2007). A further numerical example for the situation that the
model to simulate the data is different from both candidate models
can be found in the Supplementary Material.

4 CONCLUSION

By use of the KL-optimality we derived a model discrimination
criterion that might be more appropriate for dynamic time series
experiments performed by biologist than the existing approaches,
e.g the continuous time design (Atkinson and Fedorov, 1975;
Cooney and McDonald, 1995; Kremling et (11., 2004). We included
optimal initial species concentrations, optimal measurement time
points for a one run experiment where the time span between
two measurements have to be larger than a given AI and optimal
perturbations to the system with respect to the perturbation time and
the amount of perturbing species quantities. We further exempliﬁed
our method on a simulated example for allosteric models for
glycolytic oscillations by performing the sequential run of making
an experiment (a simulated one in our test case) and afterwards
calculating an optimally discriminating design. After only one
iteration of an experimental design, we can clearly discriminate
between Model 1 and Model 2 which shows the efﬁciency of our
method.

Funding: Freiburg Initiative for Systems Biology (FRISYS); the
Freiburg part of the BMBF FORSYS systems biology initiative;
Freiburg excellence cluster Centre for Biological Signalling Studies
(BIOSS).

Conﬂict of Interest: none declared.

REFERENCES

Apgar,J.F. et a1. (2008) Stimulus design for model selection and validation in cell
signaling. PL0S Comput. Biol, 4, e30.

Atkinson,A.C. and Fedorov,V.V. (1975) The design of experiments for discriminating
between two rival models. Biometrika, 62, 57770.

Balsa-Canto,E. et a1. (2008) Computational procedures for optimal experimental design
in biological systems. IET Syst. Biol, 2, 1637172.

 

944

112 /3.to's[BumoIpJOJxosotwurJOJutotq”:dnq urog papao1umoq

9103 ‘1gisn8nv 110::

Optimal experimental design approach

 

Bauer,I. et a1. (2000). Numerical methods for optimum experimental design in DAE
systems. J. Comput. Appl. Math., 120, 1725.

Bell,B.M. and Burke,J.V. (2008) Algorithmic differentiation of implicit functions and
optimal values. In Bischof,C.H. et al. (eds) Advances in Automatic Diﬂerentiation.
Springer, pp. 67777.

Bernacki,J.P. and Murphy,R.M. (2009) Model discrimination and mechanistic
interpretation of kinetic data in protein aggregation studies. Biophys. J., 96,
287172887.

Bock,H.Gi and Plitt,K.J. (1984) A multiple shooting algorithm for direct solution of
optimal control problems. In Proceedings of the Ninth IFAC World Congress,
Budapest. Pergamon, Oxford.

Bock,H.Gi (1987) Randwertproblemmethoden zur Parameteridentiﬁzierung in
Systemen nichtlinearer Differentialgleichungen. In Bonner Mathematische
Schriften, Vol. 183. University of Bonn, Bonn, Germany.

Bumham,K.P. and Anderson,D.R. (2002) Model Selection and Multimodel Inference:
A Practical Information-theoretic Approach, 2nd edn., Springer, New York, USA.

Cooney,M.J. and McDonald,K.A. (1995) Optimal dynamic experiments for bioreactor
model discrimination. Appl. Microbiol Biot., 43, 8267837.

Egea,J.A. et a1. (2007) Scatter search for chemical and bio-process optimization.
J. Global 0ptim., 37, 4817503.

Eguchi,S. and Copas,J. (2006) Interpreting Kullback-Leibler divergence with the
Neyman-Pearson lemma. J. Multivar Anal, 97, 203442040.

Goldbeter,A. (1996) Biochemical Oscillations and Cellular Rhythms: The Molecular
Bases ofPeriodic and Chaotic Behaviour. Cambridge University Press, Cambridge,
UK.

Horn,R. (1987) Statistical methods for model discrimination. applications to gating
kinetics and permeation of the acetylcholine receptor channel. Biophys. J., 51,
2557263.

HSL (2007) A collection of fortran codes for large-scale scientiﬁc computation.
Available at http://www.hsl.rl.ac.uk.

Jain,R. et a1. (2006) Investigation of bacteriophage ms2 viral dynamics using model
discrimination analysis and the implications for phage therapy. Biotechnol. Progr,
22, 165071658.

K6rkel,S. et a1. (1999) A sequential approach for nonlinear optimum experimental
design in DAE systems. In Keil,F. et al. (eds) Scientiﬁc Computing in Chemical
Engineering II, Vol. 2. Springer, Berlin, pp. 387345.

Kremling,A. et a1. (2004) Abenchmark for methods in reverse engineering and model
discrimination: problem formulation and solutions. Genome. Res., 14, 177371785.

Kreutz,C. and Timmer,J. (2009) Systems biology: experimental design. FEBS J., 276,
9237942.

Lacey,L. and Dunne,A. (1984) The design of pharmacokinetic experiments for model
discrimination. J. Pharmacokinet. Phar, 12, 3517365.

Lindsey,J.K. (1996) Parametric Statistical Inference. Oxford University Press, New
York, USA.

Lopez-FidalgoJ. et al. (2007) An optimal experimental design criterion for
discriminating between non-normal models. J. R. Stat. Soc. Ser B, 69, 2317242.

Myung,J .I. and Pitt,M.A. (2009) Optimal experimental design for model discrimination.
Psychol Rev., 116, 4997518.

Serban,R. and Hindmarsh,A. (2005) CVODES: the sensitivity-enabled ODE solver in
SUNDIALS. In Proceedings of IDETC/CIE 2005 . Long Beach, CA.

Stewart,W.E. et a1. (1998) Discrimination and goodness of ﬁt of multiresponse
mechanistic models. AIChE. J., 44, 140471412.

Stoer,J. and Bulirsch,R. (2002) Introduction to Numerical Analysis. Number 12 in Texts
in Applied Mathematics, 3rd edn. Springer, New York.

Stricker,C. et a1. (1994) Statistical analysis of synaptic transmission: model
discrimination and conﬁdence limits. Biophys. J. R. Stat. Soc. Ser B, 67, 5327547.

Takors,R. et a1. (1997) Experimental design for the identiﬁcation of macrokinetic models
and model discrimination. Biotechnol. Bioeng., 56, 5647576.

Timmer,J. et a1. (2004) Modeling the nonlinear dynamics of cellular signal transduction.
Int. J. Bifurcat. Chaos, 14, 206972079.

Uciriski,D. and Bogacka,B. (2004) Heteroscedastic T-optimum designs for
multiresponse dynamic models. In Bucchianico,A.D. and Lauter,H. (eds)
Proceedings of the 7th International Workshop on Model-Oriented Design and
Analysis, Physica Verlag Germany, Heidelberg, pp. 1917199.

W'achter,A. (2002) An interior point algorithm for large-scale nonlinear optimization
with applications in process engineering. PhD Thesis, Carnegie Mellon University,
Pittsburgh, Pennsylvania, USA.

W'achter,A. and Biegler,L.T. (2006) On the implementation of a primal-dual
interior point ﬁlter line search algorithm for large-scale nonlinear programming.
Math. Program., 106, 25757.

 

945

112 /3.to's[BumoIpJOJxosotwurJOJutotq”:dnq mot} papeo1umoq

9103 ‘1gisn8nv 110::

