Bioinformatics, 31 (6), 2015, 886—896

doi: 10.1093/bioinformatics/btu754

Advance Access Publication Date: 13 November 2014
Original Paper

 

 

Genetics and population analysis

ViQuaS: an improved reconstruction pipeline for
viral quasispecies spectra generated by
next-generation sequencing

Duleepa Jayasundara1'*, I. Saeed1, Suhinthan Maheswararajahz,
B.C. Chang3, S.-L. Tang4 and Saman K. Halgamuge1

1Optimisation and Pattern Recognition Research Group, Department of Mechanical Engineering, Melbourne
School of Engineering, The University of Melbourne, Parkville, VIC 3010, 2Portland House Research and Advisors
Ltd., Melbourne, VIC 3000, Australia, 3Yourgene Bioscience, No. 376-5, Fuxing Rd., Shu-Lin District, New Taipei City,
Taiwan and 4Biodiversity Research Center, Academia Sinica, Nan-Kang, Taipei 11529, Taiwan

*To whom correspondence should be addressed.
Associate Editor: Gunnar Ratsch

Received on February 3, 2014; revised on October 28, 2014; accepted on November 11,2014

Abstract

Motivation: The combined effect of a high replication rate and the low fidelity ofthe viral polymer—
ase in most RNA viruses and some DNA viruses results in the formation of a viral quasispecies.
Uncovering information about quasispecies populations significantly benefits the study of disease
progression, antiviral drug design, vaccine design and viral pathogenesis. We present a new
analysis pipeline called ViOuaS for viral quasispecies spectrum reconstruction using short next—
generation sequencing reads. ViOuaS is based on a novel reference—assisted de novo assembly al—
gorithm for constructing local haplotypes. A significantly extended version of an existing global
strain reconstruction algorithm is also used.

Results: Benchmarking results showed that ViOuaS outperformed three other previously published
methods named ShoRAH, OuRe and PredictHaplo, with improvements of at least 3.1—53.9% in re—
call, 0—12.1% in precision and 0—38.2% in F—score in terms of strain sequence assembly and
improvements of at least 0.006—0.143 in KL—divergence and 0.001—0.035 in root mean—squared error
in terms of strain frequency estimation, over the next—best algorithm under various simulation set—
tings. We also applied ViOuaS on a real read set derived from an in vitro human immunodeficiency
virus (HIV)—1 population, two independent datasets of foot—and—mouth—disease virus derived from
the same biological sample and a real HIV—1 dataset and demonstrated better results than other
methods available.

Availability and implementation: http://sourceforge.net/projects/viquas/

Contact: d.jayasundara@student.unimelb.edu.au

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 IntrOducuon replication rates (Brunetto et (11., 1999; Lauring and Andino, 2010).

Inside an infected host, most RNA viruses such as human immuno- The low fidelity of the proof-reading function of the viral polymer-
deficiency virus (HIV), hepatitis C, foot-and-mouth-disease virus ase (Brunetto et (11., 1999; Lauring and Andino, 2010) coupled with
(FMDV) and some DNA viruses like hepatitis B exhibit very high this high replication rate results in the formation of a viral

(C7 The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 886

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

ViOuaS

887

 

quasispecies population. More specifically, a quasispecies is a set of
genetically related but non—identical viral mutant types (which can
also be referred to as strains) that are able to co—exist within the host
(Lauring and Andino, 2010).

As anti—viral vaccines and drugs make use of the knowledge on
various stages of the host—viral interaction process and viral replica—
tion process (Carter and Saunders, 2007; Dimmock et al., 2007), the
presence of different viral strains in the population affects the nat—
ural host—immune response as well as the antiviral drug therapy
(Brunette et al., 1999; Dimmock et al., 2007; Lauring and Andine,
2010; Vignuzzi et al., 2006). Therefore, information about these
strains, or quasispecies spectra, is of critical importance to antiviral
drug design and vaccine design. In particular, such information
would enhance research into viral evolution, disease progression
and provide insights into the biology and pathogenesis of viruses
(Baldick et al., 2008; Brunette et al., 1999; Carter and Saunders,
2007; Dimmock et al., 2007; Nishijima et al., 2012).

During the analysis of quasispecies, identifying the co—occurrence
of nucleotide level mutations is as important as identifying individ—
ual mutations. As such, there are two main challenges in this
analysis: assembling nucleotide sequences of each individual strain
to identify co—occurring mutations and to estimate the relative fre—
quency of each strain within the quasispecies. Collectively, these
two challenges constitute Quasispecies Spectrum Reconstruction
(QSR).

The most similar problem to QSR is the metagenemic binning
problem as applied to bacterial metagenemes (Kunin et al., 2008),
but Kunin et al. (2008) emphasizes the inability of binning methods
based on sequence similarity and sequence composition to discrim—
inate between strains of the same species due to high nucleotide
compositional similarity.

Single—genome de novo assembly is another similar problem to
QSR (Astrovskaya et al., 2011). These algorithms are optimized to
overcome technical sequence errors assuming the existence of a sin—
gle species in the sequenced sample (Astrovskaya et al., 2011;
Beerenwinkel et al., 2012). Hence given a metagenemic dataset as
input, most assemblers work towards generating a single assembly
of reads misinterpreting genetic variability as potential technical
sequencing errors.

One of the earliest methods for viral population estimation using
next—generation sequencing (NGS) was proposed in Eriksson et al.
(2008). It uses a multiple read alignment and clustering strategy for
read error correction, a combinatorial algorithm for strain recon—
struction and a statistical model—based expectation—maximization
strategy for strain frequency estimation. The method formulated in
Zagordi et al. (2011), named ShoRAH, extends the method of
Eriksson et al. (2008) and uses a Bayesian inference algorithm for
read error correction and a probabilistic clustering algorithm
for strain reconstruction (Zagordi et al., 2010). Three other interesting
approaches to solve the QSR problem are the combinatorial method
proposed in Prosperi et al. (2011), which was later published as a soft—
ware named QuRe (Prosperi and Salemi, 2012), the method proposed
in Astrovskaya et al. (2011) named ViSpA and the method proposed
in Prabhakaran et al. (2010, 2014) named PredictHaplo.

Current methods that address the QSR problem rely on the fact
that the NGS reads of a quasispecies sample can be assigned with a
unique alignment position to a known reference genome or a con—
sensus sequence. This has become possible due to the rarity of
repeats in viral genomes (Astrovskaya et al., 2011). Following read
alignment, a typical quasispecies analysis pipeline consists of three
major steps: (i) First, the genetic diversity is determined on either
overlapping or non—overlapping local windows of the reference

genome by clustering reads within each window together with strat—
egies to eliminate or correct technical sequencing errors. This is also
referred to as constructing local haplotypes. (ii) Second, the global
diversity is inferred by connecting the local haplotypes to form the
nucleotide sequences spanning the entire genomic region of interest
(i.e. strain reconstruction). (iii) Third is the step of estimating the
relative frequencies of the reconstructed strains. Comprehensive re—
views on different techniques used within these main steps of an
analysis pipeline are found in Beerenwinkel et al. (2012) and
Beerenwinkel and Zagerdi (2011).

The most critical component within this pipeline is global diver—
sity estimation, where previous studies have relied on one of two
key concepts (Beerenwinkel et al., 2012). The most popular strategy
of inferring global diversity is based on graph—based methods, as has
been implemented in Zagordi et al. (2011), Prosperi and Salemi
(2012), Astrovskaya et al. (2011), Mancuso et al. (2011), Huang et
al. (2011) and O’Neil and Emrich (2012). Alternatively, the problem
has also been approached using probabilistic clustering methods
(Prabhakaran et al., 2010, 2014; Quince et al., 2011; Zagordi et al.,
2012a). Less common, but a very useful third approach for quasis—
pecies identification based on de novo assembly has been published
in Ramakrishnan et al. (2009). Even though Ramakrishnan et al.
(2009) does not address the QSR problem from strain assembly to
frequency estimation, it provides an interesting initiation point for
the total strain assembly problem using short NGS reads. We have
further developed the idea of using a de novo assembly algorithms
for quasispecies assembly in this work.

An analysis of the effects of average read length, depth of cover—
age and technical sequencing errors on total strain reconstruction is
presented in Zagordi et al. (2012b), and it highlights the fact that
inferring quasispecies population diversity of larger genomic regions
using short NGS reads remains a challenging problem.

In this article, we present a new analysis pipeline named ViQuaS
for viral QSR using short NGS reads. Our main focus is en inferring
quasispecies spectrum within a certain genomic region of a viral
sample using sequence reads that are several folds shorter in length
compared with the region, in the presence of a moderate level of
technical sequencing errors. The novelty of our method is 2—fold. (i)
We propose a novel reference—assisted de novo assembly algorithm
for defining local haplotypes. (ii) We propose a significant extension
to the global reconstruction algorithm presented in Prosperi et al.
(2011), based on relative coverage depths and overlap agreement of
local haplotypes. Moreover, we present the first benchmark study of
ViQuaS and three other existing methods named ShoRAH (Zagerdi
et al., 2011), QuRe (Prosperi and Salemi, 2012) and PredictHaplo
(Prabhakaran et al., 2010, 2014), on a broad spectrum of simulated
data allowing for a thorough comparison of performance between
the four methods.

The correctness of the nucleotide sequences reconstructed is pri—
marily evaluated based on the measures Recall and Precision. Under
different simulation conditions, the four methods used in the bench—
mark study outperformed each other in Recall and Precision with—
out a particular pattern. Hence, the geometric mean of Recall and
Precision termed as F-score is used to measure the performance
using a single measure. On the other hand, the accuracy of the esti—
mated relative frequency distribution of the reconstructed strains is
measured using KL—a'ivergence (Kullback and Leibler, 1951) and
root mean-squared error. ViQuaS outperformed ShoRAH, QuRe
and PredictHaplo, demonstrating improvements of at least
3.1—53.9% in Recall, 0—12.1% in Precision and 0—38.2% in F—score
in terms of strain sequence assembly and improvements of at least
0.006—0.143 in KL-a'ivergence and 0001—0035 in root

/310‘s112umo[p10}xo‘sopcuHOJIItotq/ﬁdnq

888

D.Jayasundara et al.

 

mean-squared error over the next—best algorithm under various
simulation settings.

2 Materials and Methods

2.1 Datasets

We evaluated ViQuaS on a broad spectrum of simulated viral qua—
sispecies NGS read samples. The complexity of a sample of reads
primarily depends on three independent factors; the number of dif—
ferent strains in the population (N5), the average hamming distance
between all strains (Diversity) and the extent of technical sequencing
errors present in the NGS reads.

An important factor in measuring the performance of the recon—
struction algorithm is the number of theoretically reconstructible
strains (Np) out of NS. Given a set of nmtal number of NGS
reads with a mean read length L, NP depends on the minimum rela—
tive frequency (fmm) that a strain can have, in order to have a prob—
ability of at least 17min of being completely covered during the
sequencing process. fmin is calculated according to the relationship
between nmtal, Lr, 17mm and the length of the reference genome,
derived with the assumption of Lander—Waterman model of
sequencing (Eriksson et al., 2008). In calculating fmin values corres—
ponding to the read sets described below, we set Pmin : 0.99. In per—
formance evaluation of the method, we used NP instead of NS as the
expected number of strains to be retrieved through the method.

2.1.1 Platform-independent simulated datasets

The samples used have Diversity values in the range of 1—10%
(Diversity 6 {1%,2%,3%,4%,5%,6%,7%, 8%,9%,10%}),

N5 in the irregularly spaced range of 3—100 (NS 6 {3, 5, 7, 10, 25,50,
75, 100}) and substitutional technical error probability (e) of 0%
(error—free reads) and 0.1% (theoretical maximum substitutional error
probability of quality trimmed reads with a PHRED threshold of 30).
An irregularly spaced range between 3 and 100 was used for N5 to
evaluate the behaviour of methods under both small and moderately
high number of strain numbers without unnecessarily increasing the
number of simulated datasets. Different strains were derived by mutat—
ing a reference sequence at randomly chosen locations to achieve
desired Diversity values. A total of 6400 read samples categorized in to
eight sets (SS1—SS8) were simulated using the read simulating software
named Grinder (Angly et al., 2012) (version 0.5.3). Supplementary
Table S1 of Supplementary File S4 summarizes the simulation param—
eters of SS1 —SS8 and Supplementary File S4 provides further details on
the simulation settings.

2.1.2 Platform-independent simulated dataset with real HBV
mutations

To evaluate the performance of ViQuaS on ‘near real’ data, we de—
signed a simulated dataset (SS9) where the strains contain mutations
at nucleotide positions from 1814 to 1956 (a region of 143 nt length
in the pre-C/core gene), summarized under Table 1 of Brunette et al.
(1999). Supplementary Table S2 of Supplementary File S4 summar—
izes the simulation parameters of SS9.

2.1.3 Platform-independent simulated datasets with real HIV-1
strains

We simulated two psudo—real (simulated with a mix of real and artifi—
cial parameters) quasispecies sample datasets (SS10 and SS11) by
using 10 real HIV—1 strains published in Zagordi et al. (2010).
Supplementary File S4 provides further details on SS10 and SS11 and
Supplementary Table S3 summarizes the simulation parameters used.

2.1.4 HIV-1 in vitro population real dataset

We used the 5-Uirus-rnix dataset published in Giallonardo et al.
(2014) to evaluate the performance of ViQuaS and other existing
method on real Illumina sequence reads derived from a quasispecies
population generated in vitro using five known HIV—1 strains named
as HIV — 1896, HIV — 1mm, HIV — 1,R_CSF, HIV — 1NL4_3 and
HIV — 1YU2. Sequencing has been performed on an Illumina MiSeq
Benchtop sequencer. The reads from the sequencer are paired end
with 2 X 250 bp length. We selected a 5000—bp—long genomic region
encompassing the 4036—bp—long gap-pol region of the HIV—1
genome as the region of interest for the global reconstruction of
haplotypes. Supplementary File S4 provides further details on data
pre—processing.

2.1.5 Real Illumina FMDV dataset

We used two Illumina Genome Analyzer IIx datasets (GenBank ac—
cession numbers ERR180978 and ERR180979) derived from the
same biological sample (GenBank accession number ERS182429)
presented in Morelli et al. (2013) to evaluate the performance of the
four methods on real data. Supplementary File S4 provides further
details on this dataset and pre—processing.

2.1.6 Real Roche 454 HIV-1 dataset

Roche 454 was the first new generation sequencing platform used
for rare variant analysis. Even though our main focus is on data gen—
erated from Illumina platform, we used V11909 dataset derived
from an antiretroviral—experienced HIV—1 infected patient, pub—
lished in Wang et al. (2007), to evaluate the applicability of ViQuaS
on Roche 454 sequences. Supplementary File S4 provides further
details on this dataset and pre—processing.

2.2 ViQuaS analysis pipeline

The proposed analysis pipeline assumes the availability of a set of
NGS reads (Rmtal) generated out of a viral quasispecies sample and
the availability of an appropriate reference genome (Gref). Gref could
either be a reference sequence of the viral type of interest obtained
from a public sequence database or the consensus sequence of the
multiple sequence alignment of Rmtal. Both Rmtal and Gref are the in—
puts to the pipeline, and we are interested in identifying the co—
occurring mutations in each strain and the relative frequency of each
strain in the population. Following is a description of the main steps
of the pipeline. A detailed description of ViQuaS analysis pipeline
with an example is presented in Supplementary File S1.

2.2.1 Read filtering

Rmtal is aligned to Gref and is partitioned into two sets denoted by
RPEI and Rmu based on whether or not each read has a perfect align—
ment with Gref or not [i.e. mutated (mu)], respectively.

2.2.2 de nouo assembly

This step involves unsupervised partitioning of Rmu into contigs
based on the greedy graph—based short NGS read assembly algo—
rithm presented in Warren et al. (2007), named SSAKE (version 3.8)
[a brief review of this algorithm can be found in Miller et al.
(2010)].

A major concern in using a de not/o assemblers for quasispecies
assembly is that they produce chimeric contigs when the strains are
closely related in genetic content. SSAKE, which is a greedy graph—
based a'e HOUO assembler, tries to overcome this by reusing similar
reads that do not agree with an existing extension iteration at a later
stage to generate new contigs (Miller et al., 2010). This property of

[310‘SIEIIIHOIPJOJXO‘SOQEIIIJOJIIIOIQ/[Idnq

ViQuaS

889

 

Table 1. Performance comparison of ViQuaS, ShoRAH and QuRe
under different quasispecies population characteristics and NGS
sequencing characteristics when Diversity > 3%

 

 

 

 

 

 

 

 

 

 

 

Sample set ViQuaS ShoRAH QuRe PredictHaplo
name
Recall (strain reconstruction)
551 0.903 0.732 0.338 0.750
552 0.954 0.831 0.498 0.735
SS3 0.682 0.454 0.016 0.651
SS4 0.888 0.802 0.300 0.678
SS5 0.900 0.737 0.341 0.760
SS6 0.695 0.472 0.015 0.654
SS7 0.838 0.000 0.317 0.000
SSS 0.848 0.000 0.309 0.055
Precision (strain reconstruction)
551 0.782 0.657 0.628 0.840
552 0.786 0.791 0.866 0.852
SS3 0.499 0.381 0.038 0.712
SS4 0.830 0.776 0.604 0.821
SS5 0.778 0.664 0.628 0.854
SS6 0.565 0.405 0.033 0.740
SS7 0.697 0.000 0.617 0.000
SSS 0.713 0.000 0.592 0.064
F-score (strain reconstruction)
551 0.830 0.682 0.421 0.773
552 0.851 0.805 0.612 0.763
SS3 0.560 0.403 0.022 0.670
SS4 0.853 0.778 0.385 0.718
SS5 0.827 0.687 0.421 0.784
SS6 0.611 0.420 0.019 0.681
SS7 0.753 0.000 0.401 0.000
SSS 0.767 0.000 0.385 0.058
KL-diz/ergence (frequency estimation)
551 0.005 0.042 0.284 0.213
552 0.004 0.010 0.222 0.247
SS3 0.043 0.186 0.619 0.209
SS4 0.005 0.019 0.252 0.205
SS5 0.004 0.047 0.328 0.212
SS6 0.036 0.144 0.492 0.198
SS7 0.018 0.060 0.326 0.206
SSS 0.015 0.064 0.383 0.207
Root mean-squared error (frequency estimation)
551 0.011 0.021 0.047 0.132
552 0.009 0.010 0.063 0.129
SS3 0.024 0.059 0.128 0.138
SS4 0.018 0.021 0.106 0.153
SS5 0.010 0.022 0.100 0.131
SS6 0.030 0.062 0.142 0.148
SS7 0.016 0.028 0.079 0.131
SSS 0.015 0.027 0.111 0.131

 

In comparison to SS1, Where Lr = 200 bp, e = 0%, only SNPs are present
(T: P) and fmm = 0.7%, SSZ has a longer read length (Lr = 300 bp), SS3 has
a shorter read length (Lr = 100 bp), SS4 has a reduced depth of coverage
(fmm =2.1), SSS contains sequencing errors (e = 0.1%), SS6 has both a
shorter read length (Lr = 100 bp) and a reduced depth of coverage
(fmm= 1.4), SS7 has indels (T = P, LB) and SSS contains sequencing errors
(e = 0.1%) and has indels (T = P, I, D). Each point indicates the mean value
of the measure. Bold face ﬁgures show the best performance measure in
each row.

SSAKE was the main reason to choose it for this step over the well—
known a'e hrui/n graph—based assemblers. This algorithm may still
produce chimeric contigs and we address this issue under the
Chimeric error correction step. The pipeline is developed in a modu—
lar architecture, such that SSAKE is replaceable with any other bet—
ter performing algorithm as far as it keeps track of the individual
reads contributing the contigs.

SSAKE is designed and tested for assembling high—throughput
Illumina short reads. Let NC]; be the number of contigs produced by
SSAKE. Each contig consists of a subset of overlapping reads from Rm“.

Moreover, within the de 7101/0 assembly algorithm, SSAKE elim—
inates probable technical sequencing errors. The two user defined
parameters, 0 (which stands for the minimum number of reads
needed to call a base during an extension) and r (which stands for
the minimum base ratio used to accept an overhang consensus base),
are used to determine the probable bases with technical sequencing
errors. Further details regarding these parameters are found in the
support documents provided with the SSAKE software package.
Parametrization of SSAKE (i.e. setting 0 and r values) is done, such
that mutation arising from low abundant strains is not misinter—
preted as technical sequencing errors. Accordingly, 0 gets a value in
the range of 3—5 and r gets the default value of 0.7. An accurate as—
sessment of the technical sequencing error profile of the input read
set will enable specific parametrization of SSAKE. We observed that
o : 3 and r: 0.7 produces the best results under the ideal scenario
of error free reads. For an appropriately quality—controlled input
read set with an Illumina technical error profile (average error
rate<0.12%), o : 5 and r : 0.7 produces the best results.

2.2.3 Mutation calling

Each read in Rmu consists of at least one mutation with respect to
Gref. Hence, appropriate parametrization of SSAKE produces con—
tigs from Rm“, such that each contig contains at least one mutation.
The Mutation calling step involves aligning each contig to Gref using
an altered version of Smith—Waterman algorithm (Smith and
Waterman, 1981), which performs a semi—global alignment without
end gap penalties to identify the nucleotide variations (i.e. mutation)
with respect to Gref. The output of this step is NCE number of muta—
tion sets where each contig produces one mutation set.

2.2.4 Chimeric error correction
The de not/o assembly algorithm does not guarantee that all the mu—
tations present in one contig correspond to a single strain. During
the graph generation step of SSAKE, reads corresponding to two dif—
ferent strains can have significant common overlap regions resulting
such reads being included in a single contig. This phenomenon leads
to mutations corresponding to different strains to be present in a sin—
gle contig, which we consider as a chimeric error. On the contrary,
in a technical error—free experiment, the NGS technology ensures
that the nucleotide sequence captured in each read in Rmtal corres—
ponds to a genomic region of only one of the strains in the sample
(Zagordi et al., 2010). Because Rmu is a subset of Rmtal, the nucleo—
tide sequence (and hence the set of mutations) captured in a single
read of Rmu corresponds to a single strain. In other words, we
assume that no chimeric reads occur during the sequencing process.
Therefore, the Chimeric error correction algorithm is based on the
assumption that the set of mutations captured in a single read of
Rmu corresponds to a single strain.

Based on the above assumption, each of the NCE number of
mutation sets and the corresponding contigs will be split into two or
more subsets if insufficient evidence is found in the reads of Rmu

ﬁm'spzumofpmyo'sopeuuopIIoIq/ﬁdnq

890

D.Jayasundara et al.

 

supporting the co—occurrence of any pair of consecutive mutations.
Assume that this step results in a total of NCC number of error—free con—
tigs (Ncc ZNCE). Each of the NCC number of error—free contigs (and
the corresponding mutation sets) represents a set of closely located mu—
tations of a single strain, which is also referred to as a local haplotype.

The three steps: a'e not/o assembly, Mutation calling and
Chimeric error correction constitute the proposed new reference—as—
sisted a'e not/o assembly algorithm.

2.2.5 Local haplotype frequency estimation
Assume that IS and 16 be the start and end alignment positions,
respectively, of a local haplotype to Gref. Then, the relative
frequency of the particular local haplotype is the ratio between the
number of reads in Rmu contributing to it and the total number of
reads in Rmtal having an alignment to Gref, entirely Within l5 and [6.
At the end of this step, we obtain NCC number of local haplotype
sequences (HS, where i6 1,. . .,Ncc) and the corresponding local
haplotype frequencies (HF, where i E 1,. . ., NCC).

2.2.6 Global spectrum reconstruction
The two goals of Global spectrum reconstruction are combining
local haplotypes, such that all mutations from the same strain are
grouped together forming each of the original strains and estimating
the corresponding relative frequencies. The algorithm used here
was derived from the algorithm described in Prosperi et al. (2011),
which is based on matching multinomial distributions. The Global
spectrum reconstruction algorithm iteratively connects overlapping
(HS,,HS,) sequence pairs, where iaéi, if the overlapping regions
agree with each other. If two or more such pairs show overlap
agreement, the pair with the closest (HF,,HF,) value pair will take
precedence. At the end of each iteration, the connected set of over—
lap—agreeing HS,’s gives the nucleotide sequence of the reconstructed
strain. The lowest value out of the corresponding HF,’s gives the
relative frequency of the reconstructed strain.

The three major extensions we propose to the existing algorithm
in Prosperi et al. (2011) are as follows:

1. Instead of partitioning the nucleotide space of Gref into windows
having a predefined constant width (the window width is typic—
ally set equal to the average read length) to infer the local diver—
sity (i.e. local haplotypes), we allow contigs to grow along the
nucleotide space of the Gref without restricting to a predefined
nucleotide width. This approach reduces the number of partition
boundaries at which heuristic decisions are made to connect
overlapping HS,’s during the reconstruction process.

2. We use the HF, values to determine the closeness of prevalence
of two overlapping HS,’s. In contrast, the existing algorithm em—
ploys the read numbers contributing to the read clusters corres—
ponding to HS,’s. This alteration leads to accurate strain
reconstruction and frequency estimation without relying on the
assumption of a uniform coverage depth.

3. We hypothesize that the lowest value out of the HF,’s corres—
ponding to the connected set of HS,’s gives the most accurate es—
timate to the relative frequency of a reconstructed strain. In
contrast, the existing algorithm in Prosperi et al. (2011) calcu—
lates it based on the number of reads contributing to the local
haplotype that belongs to both the set of connected local haplo—
types and the partition window of Gref through which the max—
imum number of haplotypes pass.

Supplementary File 51 describes the iterative algorithm in detail
with an example.

3 Results

Performance evaluation of QSR is 2—feld. The performance in terms
of total strain reconstruction is evaluated based on the metrics
Recall, Precision and F— score as defined below.

True positive strains with a relative frequency > fmin

 

 

Recall : . 1
Expected number of strains (Np) ( )
_ _ True positive strains with a relative frequency > fmin
Preczszon : . . .
Total number of reconstructed strainswrth a relative frequency > fmin
(2)
Recall >< Precision
F—score : 2 X ( ) (3)

(Recall + Precision)

The performance in terms of frequency estimation is evaluated
based on KL—a'iuergence and root mean-squared error between the
input and output relative frequency distributions. We compared
ViQuaS with three other previously published software, named
ShoRAH (Zagordi et al., 2011), QuRe (Prosperi and Salemi, 2012)
and PredictHaplo (Prabhakaran et al., 2010, 2014), based en en—
tirely simulated, psudo—real and real data.

A noteworthy factor in performance comparison is the distinc—
tion between the objectives of the global spectrum reconstruction al—
gorithms used by these three methods. ShoRAH aims to output the
most parsimonious set of strains that is consistent with a given set of
reads (Eriksson et al., 2008), which in general produces a larger
number of strains than the actual number of strains present in the
population. This leads to a better chance of producing true strains,
while also producing many false in silico recombinants. In contrast,
QuRe, PredictHaplo and ViQuaS aim to output a selective set of
strains that is likely to be totally covered by the given set of reads,
minimizing the production of false in silico recombinants. Our
choice to consider only the number of theoretically reconstructible
strains (NP) as the expected number of strains in calculating Recall
(eq. 1) and to disregard the number of reconstructed strains having a
relative frequency less than fmin in calculating Precision (eq. 2) pro—
vide practical and fair grounds to compare the performance in terms
of the metrics Recall, Precision and F-score. Also, in calculating KL—
a'iuergence and root mean-squared error, we only considered the in—
put and output strains with relative frequency values greater than
fmirv

In Sections 3.1—3.3, we validate ViQuaS and benchmark it
against ShoRAH, QuRe and PredictHaplo using the simulated
datasets SS1—SS11 using the metrics Recall, Precision, F—score, KL—
a'iuergence and root mean-squared error. In Section 3.4, we validate
and benchmark the methods using average pair—wise alignment cost
between the known and reconstructed haplotypes. Finally, in
Sections 3.5 and 3.6, we compare the results of the four methods on
real datasets. As a result of the fact that the exact nucleotide content
of the strains and their relative frequencies are unknown in these
real datasets, we have used other criteria as described under the re—
spective subsections to evaluate the results.

3.1 Performance comparison on platform—independent
simulated data

Sample set SS1 was selected as the reference dataset to compare the
performance of ViQuaS, ShoRAH, QuRe and PredictHaplo. The in—
tention of selecting SS1 was to nullify any effect on performance
from technical sequencing errors and the presence of indels, focusing
solely on the capability of the four methods in strain reconstruction
and frequency estimation. ShoRAH and QuRe were initially

ﬁm'spzumofpmyo'sopeuuopIIoIq/ﬁdnq

ViQuaS

891

 

published with pyrosequencing reads (Prosperi and Salemi, 2012;
Zagordi et al., 2011) (>300 bp), and ShoRAH was later used in a
comparison study (Zagordi et al., 2012b) on shorter read lengths
(36 bp, 75 bp and 150 bp). Hence, we chose an intermediate mean
read length of 200 bp for SS1 and platform—independent simulation
parameters for SS 1—SS8.

On the reference dataset SS1, ViQuaS clearly outperformed
ShoRAH, QuRe and PredictHaplo in total strain reconstruction
when Diversity > 3% [Fig. 1(a)]. We observe that the higher the
complexity of a quasispecies population, the better the performance
of ViQuaS compared with ShoRAH, QuRe and PredictHaplo in
terms of total strain reconstruction. ViQuaS produced the highest
number of correct strains out of the four methods when Diuersity23
% as shown by the Recall graph [Fig. 1(a)]. ShoRAH and
PredictHaplo performed at comparable levels (with ShoRAH per—
forming marginally better) in terms of Recall, while QuRe showed
the lowest levels of Recall out of the four methods. Because of the
highly conservative reconstruction of strains by PredictHaplo, it per—
formed better in terms of Precision [Fig. 1(b)] over the other three
methods, but ViQuaS performed comparably with PredictHaplo
at higher Diversity levels. When considering the F—score values
[Fig. 1(c)], which measures the trade—off between Recall and
Precision, ViQuaS performed better than the competitors, whereas
PredictHaplo held an advantage over ShoRAH due to its much su—
perior Precision values compared ShoRAH. PredictHaplo showed
higher Precision due to its inherent drawback of underestimating the
number of strains in a population (i.e. richness) as confirmed by a
previous study by Schirmer et al. (2012). Therefore, PredictHaplo
performed better than ShoRAH in terms of Precision and F—score,
but on average ShoRAH managed to produce a higher number of
true strains than PredictHaplo.

Figure 1(d) shows that both ViQuaS and ShoRAH perform at
comparable levels to each other, while significantly outperforming
QuRe and PredictHaplo in terms of frequency estimation.
Moreover, we calculated root mean-squared error between the input
and output frequency distributions and observed similar patterns to
KL—a'iuergence (refer Supplementary Figs. S23(d) and S24(d) of
Supplementary File S3).

Considering the performance of the four methods on the refer—
ence dataset SS1, we observe that ViQuaS performs the best in both
aspects of total strain sequence reconstruction and strain frequency
estimation. ShoRAH reconstructs marginally higher number of
true strains than PredictHaplo and significantly outperforms
PredictHaplo in strain frequency estimation. We assume that the
comparable levels of performance of ShoRAH and PredictHaplo is
due to the fact that both methods use of a Dirichlet process mixture
model for read clustering (Prabhakaran et al., 2010; Zagordi et al.,
2011). Even though QuRe demonstrates the lowest levels of per—
formance on SS1, we observe that QuRe is the only existing method
out of the three used in our study that is capable of performing a
successful spectrum reconstruction when the strain contain muta—
tions in the form of indels in addition to substitutions (Fig. 21).
Furthermore, the results of PredictHaplo are not reproducible.

Figure 2 presents the variations in performance of the four meth—
ods under different sequencing and population parameters simulated
in SS1—SS8 in terms of both total strain reconstruction measured by
Recall (Fig. 21) and strain frequency estimation measured by KL—
a'iuergence (Fig. 2H). Barring the samples within the Diversity range
1—3%, under which all three methods performed poorly, Table 1
summarizes the performance of the three methods on SS 1—SS8.

In comparison to SS1 [Lr : 200 bp, e : 0% and only SNPs are
present (T: P)], the performance of all four methods was negatively

affected by a shorter read length (SS3: Lr : 100 bp) [Fig. 21(b) and
Fig. 211(b)], the presence of indels (SS7: T : P,I,D) [Fig. 2I(e) and
Fig. 2II(e)] and the presence of technical sequencing errors (SS5:
e : 0.1%) [Fig. 2I(g) and Fig. 211(g)]. Even though a reduced read
length has a significant negative impact, the performance measures
tend to converge for higher Diversity and NS values [Fig. 2I(a),
Fig. 211(3), Fig. 21(b) and Fig. 211(b)].

It was observed that the number of true positives reduces under
a reduced depth of coverage. Nevertheless, in terms of Recall, the
performance of the method under a reduced depth of coverage (SS4:
nmtal : 10 000) was comparable with SS1 (nmm: 30 000)
[Fig. 21(d)]. This observation is due to the fact that the inverse
proportionality between fmin and nmtal makes Recall, Precision and
F—score values comparable, as the number of strains to be recon—
structed (NP) reduces with an increased fmin.

SS6 was employed to evaluate the combined effect of a shorter
read length and a reduced depth of coverage. Performance patterns
of all four methods under SS6 [Fig. 21(a) and Fig. 211(a)] were com—
parable to the performance patterns under SS3 [Fig. 21(b) and
Fig. 2II(b)] providing evidence for the conclusion that a shorter read
length has a significant negative effect on performance compared
with a reduced coverage depth. Comparison of performance
patterns between SS3 [Fig. 21(b) and Fig. 211(b)], SS1 [Fig. 2I(d) and
Fig. 2II(d)] and SS2 [Fig. 21(f) and Fig. 211(f)] shows that for a given
depth of coverage, performance of all four methods increases with
an increased read length.

As the mean read length (L,) and the total number of reads
(nmtal) of a sequenced sample are user—controllable parameters of an
NGS experiment, the presence of indels and technical sequencing
errors become the two inevitable negative influential factors of a
sample dataset. SS8 was employed to evaluate the combined effect
of indels and technical sequencing errors on the performance of the
four methods and ViQuaS showed clear advantage over ShoRAH,
QuRe and PredictHaplo [Fig. 2I(h) and Fig. 2II(h)].

Having observed the performance patterns of the four methods
over a broad range of parameters, we further evaluated the perform—
ance of them under a more adverse sequencing error rate including
errors in the form of indels in addition to mismatches. We chose two
sets of 10 sample populations from SS8 having parameters
(Diversity : 1%, N5: 3) and (Diversity : 7%, N5: 75). These two
sets represent comparatively simple and complex population struc—
tures, respectively. We generated 20 sample datasets from these
populations keeping all parameters except the error rate unchanged
from the values of SS7 and SS8. The error rate was set at a level of
0.3% with a 4:1 ratio between mismatch errors and indel errors.
Table 2 summarizes the performance of the four methods under dif—
ferent levels of technical sequencing errors. The observed perform—
ance pattern under e : 3% shows similarity to the pattern observed
in Figure 2I(h).

In summary, ViQuaS managed to maintain its superior perform—
ance compared with ShoRAH, QuRe and PredictHaplo under the
negative inﬂuences of a shorter read length, the presence of technical
sequencing errors, the presence of indels and a reduced coverage
depth. Under all simulated settings used in this benchmark study,
ViQuaS managed to produce the highest average number of true
strains (refer Recall measures in Table 1) and the most accurate fre—
quency estimates (refer KL—a'iuergence and root mean-squared error
measures in Table 1). On average, PredictHaplo performed better
than ShoRAH, QuRe and ViQuaS in terms of Precision (refer
Precision measures in Table 1). This superiority in Precision becomes
prominent under shorter read lengths. Nevertheless, on average,
ViQuaS managed better F—score values over PredictHaplo, ShoRAH

[310'sp2umofp105xo'sopeuuotquIq/ﬁdnq

Suppleinentar) File S3 Suppleinentar} Figs. 515—524

Suppleinentar} File 52

Figure 3

Suppleinentar) Table S4 Suppleinentar) File 55

Suppleinentar) Table 55 Suppleinentar} File 55

(a) (b)
f/N
(d)
1” \‘ﬁ

QuRe PredictHaplo ViQuaS ShoRAH

(b) _ 883
V V
(c) — ss4 (d) — ss1 (e) — ss7
m _ 882 (g) _ 885 (m _ SSS

 
 

 

 

ViQuaS ShoRAH

QuRe PredictHaplo

 
 

 

 

/310'spzumofp10}xo'soIJBuIJOJquIq”:duq

ViQuaS

893

 

Table 2. Performance variation in terms of F-score with technical
sequencing errors

 

 

Population Method e = 0% e = 0.1% e = 0.3%
parameters (1:0) (4:1)
Diversity = 1%, ViQuaS 0.083 0.218 0.174
N, = 3 QuRe 0.280 0.450 0.267
ShoRAH 0.000 0.000 0.000
PredictHaplo 0.000 0.000 0.000
Diversity = 7%, ViQuaS 0.702 0.682 0.413
N, = 75 QuRe 0.421 0.542 0.364
ShoRAH 0.000 0.000 0.000
PredictHaplo 0.000 0.000 0.000

 

e = x%(y : z) denotes a technical sequencing error probability of x% with
a y : z ratio between the mismatch errors and indel errors. Each value
indicates mean value of the measure.

Table 3. Running time comparison: SS1—SS8

 

 

Sample set name ViQuaS ShoRAH QuRe PredictHaplo
551 100.16 311.61 1640.74 484.94
552 224.60 257.49 1745.03 490.51
SS3 124.23 564.13 1827.87 390.07
SS4 35.39 167.68 298.73 269.06
SS5 101.55 308.20 1715.03 549.54
SS6 60.29 320.07 713.37 275.43
SS7 101.23 343.35 2009.11 566.42
SSS 102.26 326.06 2017.94 602.75

 

All reported running time measures are in seconds and indicate the average
over 10 samples. From each dataset SS1—SSS, the 10 most complex (i.e.
Diversity = 10% and NS = 100) samples were chosen for this analysis. All meas-
uretréents were done on an Ubuntu 12.04 (64-bit) operating system running on a
Intel CoreTM i5-4200U CPU at 1.60 GHz X 4 with 5.6—GB random access
memory. For ViQuaS and QuRe, input reads were given in FASTA format,
whereas ShoRAH was provided with BAM alignment format, and PredictHaplo
was provided with SAM alignment format. Indicated running times of ShoRAH
and PredictHaplo do not include the time taken to perform sequence alignment.
Bold face ﬁgures show the best performance measure in each row.

methods. On the other hand, ShoRAH could not produce a proper
output on the dataset as it experienced a runtime error and QuRe
could not handle the volume of input data and resulted in a memory
handling error without producing an output. A comparison between
the methods in terms of average pair—wise alignment cost between
the known and reconstructed haplotypes is presented in Table 4. We
observed that both ViQuaS and PredictHaplo have reconstructed
strains with similar pair—wise alignment distances from the true
strains with the exception of ViQuaS becoming very close to recon—
structing HIV — 1HXBZ (pair—wise alignment cest:197).

3.5 Performance on real Illumina FMDV data
Ideally, the reconstructed populations should be identical for the
two input datasets ERR180978 and ERR180979 as they were
derived from the same biological sample. Indicators of similarity be—
tween the pairs of populations reconstructed using the ViQuaS,
ShoRAH and QuRe are summarized in Supplementary Table S6 of
Supplementary File SS.

On ERR180978, ViQuaS reconstructed 153 strains out of which
62 strains (all 62 were <0.2% relative frequency) had internal stop
codons. On ERR180979, ViQuaS reconstructed 52 strains out of
which 35 strains (all 35 were <0.2% relative frequency) had internal
stop codons. Both spectra contained the same dominant strain with

relative frequencies of 97.29% (ERR180978) and 99.08%
(ERR180979), respectively.

On ERR180978, ShoRAH reconstructed 114 strains out of
which 14 had internal step cedens and en ERR180979, 195 strains
were reconstructed out of which 3 had internal stop codons. On the
other hand, ShoRAH reconstructed two dominant strains of
40.73% and 31.90% for ERR180978 and a single dominant strain
of 96.53% for ERR180979. Furthermore, both dominant strains in
ERR180978 were different from the dominant strain of
ERR1 80979 indicating a clear deviation from identical spectra.

On ERR180978, QuRe reconstructed four strains out of which
none had internal stop codons and on ERR180979, two strains were
reconstructed, none of which had internal stop codons. Similar to
ShoRAH, QuRe reconstructed two dominant strains of 50.32% and
48.99% for ERR180978 and a single dominant strain of 96.30%
for ERR180979. Also, both dominant strains in ERR180978 were
different from the dominant strain of ERR180979 indicating a clear
deviation from identical spectra.

On ERR180978, PredictHaplo reconstructed two strains out of
which none had internal stop codons and on ERR180979, one strain
was reconstructed, which did not have internal stop codons. Similar to
ViQuaS, both spectra reconstructed by PredictHaplo contained a single
dominant strain with relative frequencies of 98.43% (ERR180978)
and 100.00% (ERR180979), respectively. Even though PredictHaplo
reconstructed similar spectra on ERR180978 and ERR180979, it is
evident that it significantly underestimates the richness of the quasispe—
cies populations confirming the observation under simulated data.

As second criteria of justifying the better performance of ViQuaS
over ShoRAH and QuRe on sequence reads with Illumina platform—
specific technical sequencing errors, we simulated 10 quasispecies
populations each with a sequencing error profile that mimics Illumina
platform, modelled in Korbel et al. (2009) and implemented in the
read simulator software named Grinder (Aneg et al., 2012), 60—bp
read length and nmtal : 100 000. Having observed the performance of
the three methods over different Diversity and NS values (Fig. 2), we
set the Diversity of these 10 samples to be around 7% to minimize
performance degradation due to a low Diversity. Also, we selected
NS:75 to eliminate undue bias towards any particular method by
using a very low or very high value for N5. Strains were derived from
the same 339—nt—long region analysed using ERR180978 and
ERR180979. The overall error rate was calculated to be ~ 0.11% for
each sample. It should be noted that ShoRAH and QuRe were de—
signed for Roche 454 reads. The comparison of performance of
ViQuaS, ShoRAH, QuRe and PredictHaplo on this dataset is pre—
sented under Supplementary Table S7 of Supplementary File SS,
which highlights the better performance of ViQuaS under Illumina
error profile. Especially, the clear improvement in Recall and KL—
a'iuergence provides evidence to conclude that the populations recon—
structed by ViQuaS on ERR180978 and ERR180979 have a much
higher likelihood of representing the actual but unknown FMDV
populations in the biological sample.

3.6 Performance on real Roche 454 HIV—1 data

Analysis of the dataset V11909 (Wang et al., 2007) using ViQuaS
resulted 24 different strains out of which 6 strains had internal stop
codons in the protease and reverse transcriptase genes due to the
presence of indels. We used two criteria to evaluate the biological
validity of the remaining 18 strains. First criterion was to check the
agreement between the mutations present in the reconstructed
strains and that are published in Rhee et al. (2003). All 18 strains
under consideration produce amino acid sequences in the protease

ﬁm'spzumofpmyo'sopeuuopIIoIq/ﬁdnq

ViQuaS ShoRAH —QuRe

PredictHaplo

(b)

V”.

 

cl Lil. (2003)

Rhee (71 Lil. (2003)

Rhee (71 III. (2007)

(2003)

Table

LI)

Rhee (71 III.

Rhee ct rzl. (2003)

Rhee (71 Lil. (2003)

Rhee (71 Lil. (2003)

/310'spzumofp10}xo'soIJBuIJOJquIq”:duq

ViQuaS

895

 

interest. This pattern of performance was common to all four
methods considered in our study. Under all eight different simula—
tion conditions, ViQuaS gave the highest average Recall values
demonstrating the best total strain reconstruction capability.
ViQuaS and ShoRAH performed at comparable levels in terms of
strain frequency estimation, while clearly outperforming QuRe and
PredictHaplo.

Due to the unavailability of real datasets with known quasispe—
cies populations, the best alternative for validating these methods
under real world conditions was to use simulated datasets such
as SS9—SS11 that can be assumed to resemble such conditions.
Agreement between the performance patterns of entirely simulated
data (SS1—SS8) and data resembling real conditions (SS9—SS11) fur—
ther confirmed the enhanced performance of ViQuaS over ShoRAH,
QuRe and PredictHaplo.

Even though the correctness of the reconstructed strains cannot
be evaluated due to the unavailability of exact nucleotide content
of the strains in the real FMDV samples (ERR180978 and
ERR180979) and real HIV—1 dataset V11909 (Wang et al., 2007),
the consistency of results produced by ViQuaS on real FMDV
samples and the higher degree of biological validity of the strains
reconstructed from real HIV—1 data by ViQuaS indicate the applic—
ability of ViQuaS on real sequence data and better performance
over ShoRAH, QuRe and PredictHaplo. In addition, simulated sam—
ples with Illumina sequencing parameters further confirmed the
superior performance of ViQuaS.

In this study, we performed a comprehensive comparison of per—
formance between ViQuaS, ShoRAH, QuRe and PredictHaplo in a
broad range of Diversity and NS values. Because of the requirement
of ViSpA (Astrovskaya et al., 2011) to have the Diversity of a sam—
ple as an input parameter, which is impractical for real data, and its
poor performance under read lengths in the range of 100 bp and
200 bp, we did not use it in this study. Another method found in lit—
erature named QuasiRecomb (Tepfer et al., 2013) was also omitted
from further analysis due to its poor performance even on SS2 (on
which the other three method used in the analysis showed their best
performance). Two of the most significant observations of the com—
parison study are the drastic drop of performance of ShoRAH and
PredictHaplo under the presence of indels [refer Fig. 2I(e) and
Fig. 2I(h)] and of QuRe under a shorter (100 bp) read length
[Fig. 2I(h)]. On the contrary, ViQuaS was much less susceptible
against both indels and reduced read lengths. All four methods
handled the sequencing error rate of 0.1% without a significant
drop of performance. In particular, we observed a better perform—
ance of ShoRAH and PredictHaplo on SS9 in the presence of indels
compared with their poor performance on SS7. This observation is
due to the fact that some strains in SS9 do not have insertions (but
SNPs and deletions), which are correctly reconstructed, while every
strain in SS7 has both insertions and deletions. It was not evident
that ShoRAH and PredictHaplo eliminates all insertion considering
them as technical sequencing errors because some reconstructed
strains in SS7 contain a few (but not all) correct insertions. This also
explains the improved performance of ShoRAH on SS10 and SS11
compared with QuRe (Supplementary Table SS), as the 10 real HIV
strains used in SS10 and SS11 does not have any mutations in the
form of insertions. On the other hand, QuRe performed better than
ShoRAH and PredictHaplo on SS9 (Supplementary Table S4) where
some of the simulated HBV strains contain insertions.

The second significant factor is that ShoRAH, QuRe and
PredictHaplo define local analysis windows a priori. These window
boundaries restrict the growth of the read clusters along the nucleo—
tide space of the region of interest. In contrast, ViQuaS allows the

contigs to extend as far as the reads provide information supporting
the co—occurrence of mutations. This unrestricted growth of contigs
becomes advantageous in the total strain reconstruction stage. In
ShoRAH, each of the paths in the cover of the read graph contains a
number of nodes equal to the number of windows (Eriksson et al.,
2008). In QuRe, the complexity of the global reconstruction algo—
rithm is proportional to the number of windows (Prosperi et al.,
2011). The window length is typically set equal to the average read
length in both ShoRAH and QuRe. Hence, the algorithmic complex—
ity of the global reconstruction methods of both ShoRAH and QuRe
increases in proportionate to the ratio between the genomic region
of interest and the read length. These factors significantly affect the
performance of the respective methods as been discussed in Eriksson
et al. (2008) and Prosperi et al. (2011). Similar to ShoRAH,
PredictHaplo also uses a Dirichlet process mixture model to analyse
reads within fixed local windows and uses the local analysis results
as prior knowledge in its propagating probabilistic global strain
inference method (Prabhakaran et al., 2014). In contrast, the Global
Spectrum Reconstruction algorithm in ViQuaS, which was extended
from Prosperi et al. (2011), takes advantage of the unrestricted a'e
not/o assembly algorithm and dynamically defines the local haplo—
type boundaries for each strain, at which the decisions for connect—
ing local haplotypes are made. This dynamic definition of local
haplotype boundaries significantly reduces the number of heuristic
decisions to be made when connecting local haplotypes providing a
clear advantage over QuRe. This advantage becomes prominent
especially under shorter read lengths.

The third source of performance enhancement in ViQuaS is the
improvement of estimated strain frequency values (demonstrated in
terms of KL—a'iuergence and root mean-squared error) resulted from
the second and third major extensions to the algorithm in Prosperi
et al. (2011) described under the subsection 2.2.6.

Limitations of ViQuaS include the requirement of higher compu—
tational resources when analysing longer read lengths owing to the
use of Smith—Waterman algorithm in the pipeline. However, this
computational complexity does not degrade the performance of the
pipeline. A shorter read length compared with the genomic region of
interest reduced coverage depth of the sequences and a higher rate of
technical sequencing errors were identified as the factors influencing
negatively on the performance of ViQuaS. In fact, these factors were
common to all four methods in our study and ViQuaS was observed
to be the least susceptible to them. Also, all four methods failed to
reconstruct strains with a relative frequency less than fmin, and the
correctly reconstructible minimum relative frequency increased with
the presence of technical sequencing errors.

We notice that the performance of the methods analyzed vary
with different population characteristics and sequencing parameters.
Therefore, it is a difficult task to define parameters within which a
certain method performs at an acceptable level. In fact, the accept—
able level of performance varies according to the needs of the indi—
vidual user. Hence, the decision on choosing the best method of
analysis and the appropriate sequencing parameters is left to the end
user. Furthermore, the longest region that can be successfully recon—
structed depends on both the read length and Diversity. For in—
stance, when the region of interest and the Diversity are given, we
observe that the performance increases with increasing read length.
This does not imply that we can expect the same levels of perform—
ance with the same Diversity and read length over a larger genomic
region. A thorough analysis of this fact is presented in Zagordi et al.
(2012b).

We anticipate the use of ViQuaS to extend beyond quasispecies
spectra profiling with applications in other omics fields including

ﬁm'spzumofpmyo'sopeuuopIIoIq/ﬁdnq

896

D.Jayasundara et al.

 

cancer genomics, metagenemics and immunogenomics. For in—
stance, applications such as estimating genetic diversity of tumour
cells and understanding gene heterogeneity and diversity of micro—
biomes in various environments such as human gut or waste treat—
ment plants may benefit from the underlying methodology.

Acknowledgements

We wish to acknowledge the contributions of Rene Warren for providing
valuable feedback on SSAKE algorithm and Osvaldo Zagordi, Irina
Astrovskaya and Mattia Prosperi for their support during the comparison
study.

Funding

This work was partially supported by Australian Research Council [grant
number LP140100670] and by MIFRS and MIRS scholarships of The
University of Melbourne (to 

Conﬂict of interest: none declared.

References

Angly,F.E. et al. (2012) Grinder: a versatile amplicon and shotgun sequence
simulator. Nucleic Acids Res., 40, e94.

Astrovskaya,I. et al. (2011) Inferring viral quasispecies spectra from 454 pyro-
sequencing reads. BMC Bioinformatics, 12, 1—10.

Baldick,C. et al. (2008) Hepatitis b virus quasispecies susceptibility to enteca-
vir conﬁrms the relationship between genotypic resistance and patient viro-
logic response. ]. Hepatol., 48, 895—902.

Beerenwinkel,N. and Zagordi,O. (2011) Ultra-deep sequencing for the ana-
lysis of viral populations. Curr. Opin. Virol., 1, 413—418.

Beerenwinkel,N. (2012) Challenges and opportunities in estimating viral gen-
etic diversity from next-generation sequencing data. Frontiers in
Microbiology, 3, 329.

Brunetto,M. et al. (1999) Hepatitis b virus mutants. Intervirology, 42, 69—80.

Carter,].B. and Saunders,V.A. (2007) Virology: Principles and Applications.
John Wiley, Chichester, UK.

Dimmock,N.]. et al. (2007) Introduction to Modern Virology. Blackwell Pub.,
Malden, MA.

Eriksson,N. et al. (2008) Viral population estimation using pyrosequencing.
PLOS Comput. Biol., 4, 1—13.

Giallonardo,F.D. et al. (2014) Full-length haplotype reconstruction to infer
the structure of heterogeneous virus populations. Nucleic Acids Res., 42,
e115.

Huang,A. et al. (2011) Qcolors: An algorithm for conservative viral
quasispecies reconstruction from short and non-contiguous next generation
sequencing reads. In: 2011 IEEE International Conference on
Bioinformatics and Biomedicine Workshops (BIBM W), IEEE, Atlanta, GA,
pp. 130—136.

Korbel,]. et al. (2009) Pemer: a computational framework with simulation-
based error models for inferring genomic structural variants from massive
paired-end sequencing data. Genome Biol., 10, R23.

Kullback,S. and Leibler,R. (1951) On information and sufﬁciency. Ann. Math.
Stat., 22, 7986.

Kunin,V. et al. (2008) A bioinformatician’s guide to metagenemics.
Microbiol. Mol. Biol. Reu, 72, 557—578.

Lauring,A.S. and Andino,R. (2010) Quasispecies theory and the behavior of
RNA viruses. PLOS Pathog., 6, e1001005.

Mancuso,N. et al. (2011) Viral quasispecies reconstruction from amplicon
454 pyrosequencing reads. In: 2011 IEEE International Conference on
Bioinformatics and Biomedicine Workshops (BIBM W), IEEE, Atlanta, GA,
pp. 94—101.

Miller,].R. et al. (2010) Assembly algorithms for next-generation sequencing
data. Genomics, 95, 315—327.

Morelli,M. et al. (2013) Evolution of foot-and-mouth disease virus intra-sam-
ple sequence diversity during serial transmission in bovine hosts. Vet. Res.,
44, 12.

Nishijima,N. et al. (2012) Dynamics of hepatitis b virus quasispecies in associ-
ation with nucleos(t)ide analogue treatment determined by ultra-deep
sequencing. PLOS One, 7, 1—10.

O’Neil,S. and Emrich,S. (2012) Haplotype and minimum-chimerism consen-
sus determination using short sequence data. BMC Genomics, 13(Suppl. 2),
S4.

Prabhakaran,S. et al. (2010) HIV—haplotype inference using a constraint-based
dirichlet process mixture model. Machine Learn. Comput. Biol. NIPS
Workshop.

Prabhakaran,S. et al. (2014) HIV haplotype inference using a propagating
dirichlet process mixture model. IEEE/ACM Trans. Comput. Biol.
Bioinform. 11, 182—191.

Prosperi,M. et al. (2011) Combinatorial analysis and algorithms for quasispecies
reconstruction using next-generation sequencing. BMC Bioinformatics, 12, 5.
Prosperi,M.C.F. and Salemi,M. (2012) Qure: software for viral quasispecies
reconstruction from next-generation sequencing data. Bioinformatics, 28,

132—133.

Quince,C. et al. (2011) Removing noise from pyrosequenced amplicons. BMC
Bioinformatics, 12, 38.

Ramakrishnan,M.A. et al. (2009) The feasibility of using high resolution gen-
ome sequencing of inﬂuenza a Viruses to detect mixed infections and quasis-
pecies. PLOS One, 4, e7105.

Rhee,S.-Y. et al. (2003) Human immunodeﬁciency virus reverse transcriptase
and protease sequence database. Nucleic Acids Res., 3 1, 298—303.

Rhee,S.-Y. et al. (2007) HIV-1 subtype b protease and reverse transcriptase
amino acid covariation. PLOS Comput. Biol., 3, e87.

Schirmer,M. et al. (2012) Benchmarking of viral haplotype reconstruction pro-
grammes: an overview of the capacities and limitations of currently avail-
able programmes. Brief. Bioinform., 15, 431—442.

Smith,T. and Waterman,M. (1981) Identiﬁcation of common molecular
subsequences.]. Mol. Biol., 147, 195—197.

Topfer,A. et al. (February 2013) Probabilistic inference of viral quasispecies
subject to recombination. ]. Comput. Biol., 20, 113—123.

Vignuzzi,M. et al. (2006) Quasispecies diversity determines pathogenesis
through cooperative interactions in a viral population. Nature, 439, 344—348.

Wang,C. et al. (2007) Characterization of mutation spectra with ultra-deep
pyrosequencing: application to HIV—1 drug resistance. Genome Res., 17,
1195—1201.

Warren,R.L. et al. (2007) Assembling millions of short DNA sequences using
ssake. Bioinformatics, 23, 500—501.

Zagordi,O. et al. (2010) Error correction of next-generation sequencing data
and reliable estimation of HIV quasispecies. Nucleic Acids Res., 38,
7400—7409.

Zagordi,O. et al. (2011) Shorah: estimating the genetic diversity of a mixed
sample from next-generation sequencing data. BMC Bioinformatics, 12,
119.

Zagordi,O. et al. (2012a) Probabilistic inference of viral quasispecies subject
to recombination. In: B. Chor (ed.) Research in Computational Molecular
Biology, volume 7262 of Lecture Notes in Computer Science. Springer,
Berlin, Germany, pp. 342—354.

Zagordi,O. et al. (2012b) Read length versus depth of coverage for viral qua-
sispecies reconstruction. PLOS One, 7, e47046.

ﬁm'spzumofpmyo'sopeuuopIIoIq/ﬁdnq

