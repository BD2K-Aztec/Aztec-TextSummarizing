ORIGINAL PAPER

Vol. 30 no. 20 2014, pages 2852-2859
doi:10. 1093/bioinfonnatics/btu401

 

Genome analysis

Advance Access publication June 24, 2014

H3M2: detection of runs of homozygosity from whole-exome

sequencing data

Alberto Magi”, Lorenzo Tattinil, Flavia Palomboz, Matteo Benelli3, Alessandro Gialluisi4,
Betti Giusti‘, Rosanna Abbate‘, Marco Seri2, Gian Franco Gensini‘, Giovanni Romeo2 and

Tommaso Pippucciz'

1Department of Experimental and Clinical Medicine, University of Florence, Florence 50019, 2Medical Genetics Unit,
Polyclinic Sant’Orsola—Malpighi, Department of Medical and Surgical Sciences, University of Bologna, Bologna 40138,
3Diagnostic Genetic Unit, Careggi Hospital, Florence 50019, Italy and 4Language and Genetics Department, Max Planck
Institute for Psycholinguistics, Nijmegen 6525 EN, The Netherlands

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: Runs of homozygosity (ROH) are sizable chromosomal
stretches of homozygous genotypes, ranging in length from tens of
kilobases to megabases. ROHs can be relevant for population and
medical genetics, playing a role in predisposition to both rare and
common disorders. ROHs are commonly detected by single nucleo-
tide polymorphism (SNP) microarrays, but attempts have been made
to use whole-exome sequencing (WES) data. Currently available meth-
ods developed for the analysis of uniformly spaced SNP-array maps
do not fit easily to the analysis of the sparse and non-uniform distri-
bution of the WES target design.

Results: To meet the need of an approach specifically tailored to WES
data, we developed H3M2, an original algorithm based on heteroge-
neous hidden Markov model that incorporates inter-marker distances
to detect ROH from WES data. We evaluated the performance of H3
M2 to correctly identify ROHs on synthetic chromosomes and exam-
ined its accuracy in detecting ROHs of different length (short, medium
and long) from real 1000 genomes project data. H3A42 turned out to
be more accurate than GERMLINE and PLINK, two state-of-the-art
algorithms, especially in the detection of short and medium ROHs.
Availability and implementation: HSMQ is a collection of bash, R and
Fortran scripts and codes and is freely available at https://sourceforge.
net/projects/h3m2/.

Contact: albertomagi@gmail.com

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on February 25, 2014; revised on May 21, 2014; accepted
on June 13,2014

1 INTRODUCTION

Runs of homozygosity (ROH) are chromosomal stretches that in
a diploid genome appear in the homozygous state, that is, display
identical alleles at multiple contiguous loci.

The study of ROH can be relevant for both population and
medical genetics. Genomic ROH patterns are governed by a
number of factors, among which population genetic history
(e.g. historical bottleneck, geographic isolation and population

 

*To whom correspondence should be addressed.

size), evolutionary forces (e.g. selective sweeps) (Sabeti et al.,
2007) and cultural habits or historical and geographical factors.
Recent parental relatedness favors the formation of long ROH
(several megabases) that occur because of IBD (identity by des-
cent, when the two alleles at a locus match because they originate
from the same common ancestor), as opposed to identity by state
(when the two alleles at a locus match simply by coincidence).
Homozygosity originating from the occurrence of individual
IBD regions owing to parental relatedness (autozygosity) is
known to possibly contain recessive highly penetrant deleterious
disease-causing mutations surrounded by an unusually long
homozygous haplotype. This is the principle that inspired homo-
zygosity mapping in the study of rare recessive disorders affect-
ing inbred individuals (Lander and Botstein, 1987). In outbred
individuals, short (up to few hundreds of kilobases) or medium-
sized ROH (from hundreds of kilobases to a few megabases) can
surround disease-causing mutations as well (Hildebrandt et al.,
2009), playing a role in predisposition to disease through the
effect of mildly deleterious recessive variants (Wang et al., 2009).

To date, ROH detection has been achieved by microarray-
based technologies. Currently available single nucleotide poly-
morphism (SNP)-array platforms contain millions of markers
from the HapMap Project (International HapMap Consortium,
2003) and have a mean SNP-to-SNP distance of around 3 kb. The
past few years have seen the emergence of several next-generation
sequencing (NGS) platforms that are capable to sequence a full
human genome per week at a cost 400-fold less than the previous
methods. The advent of NGS platforms has revolutionized our
ability of studying human genetic variation (Wang et al., 2009)
allowing the achievement of large-scale re-sequencing projects,
such as the 1000 Genomes Project (1000GP) (1000 Genomes
Project Consortium et al., 2010) and the Cancer Genome Atlas
(www.cancergenome.nih.gov). Recently, the 1000GP consortium,
by combining low-coverage whole-genome sequencing (WGS)
and high-coverage whole-exome sequencing (WES) of 1092 indi-
viduals from 14 populations, has genotyped ~38 million single
nucleotide polymorphic positions (1000 Genomes Project
Consortium et al., 2012). This provided a genetic map character-
ized by a mean SNP—to-SNP distance of 73 bp and with >75% of
the inter-marker distances under 200 bp. This catalog captures up
to 98% of accessible SNPs with minor allele frequency of 31%.

 

2852 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} papBoIII/noq

9103 ‘Og anﬁnV uo ::

HBMZ: detection of runs of homozygosity

 

At present, the cost and the computational complexity still limit
the routine use of WGS and make WES an effective alternative that
has been successfully used for the discovery of single-nucleotide vari-
ants (N g et al., 2009), short indels and copy number variants aVIagi
et al., 2013) and that can be applied to the detection of ROH
(Pippucci et al., 2011). However, the sparse nature of the WES
target design makes this latter application challenging. The distance
between adjacent 1000GP exomic SNPs ranges from 1 bp to 26 Mb
(with an average value of around 500 bp), and consequently, large
ROH may be covered by few and not uniformly spaced SNPs,
whereas small and isolated ROH may display exceptionally high
marker density. Currently available sliding-window methods, such
as PLINK (Purcell et al., 2007) or GERMLINE (GuseV et al., 2009),
were developed for the analysis of uniformly spaced SNP-array maps
and do not ﬁt easily to the analysis of the sparse and non-uniform
distribution of WES SNP maps. The identiﬁcation of long ROH,
typically those detected in a context of consanguinity, may be faced
by applying these methods to WES data (Pippucci et al., 2011).
However, medium or short ROH cannot be as easily captured
from WES data by using traditional sliding-windows approaches.

To meet the need of an approach specifically tailored to WES
data, which could overcome the inherent limitations of currently
available tools, we developed a novel computational approach
[homozygosity heterogeneous hidden Markov model (HMM),
H3M2] for the identiﬁcation of ROH. The algorithm is based
on a heterogeneous HMM that, incorporating the distance be-
tween consecutive polymorphic positions into the transition
probabilities matrix, is able to detect with high sensitivity and
speciﬁcity ROH of every genomic size. The key feature of the
algorithm is its heterogeneity, which makes it well-suited for
WES data. To evaluate the capability of this novel method to
detect ROH of different sizes, we applied it to the analysis of a
synthetic dataset and compared its performance with that of
PLINK and GERMLINE on real WES data. Another method
for homozygosity IBD detection from sequences based on a
HMM algorithm, IBDseq, has recently been reported
(Browning and Browning, 2013). We did not compare H3M2
with IBDseq because this latter method is conceived explicitly
for genome sequences and has never been applied to WES data.

As a whole, the results we obtained in these analyses demon-
strated that H3M2 has the potentiality to capture most of the
genomic ROH that overlap regions covered by exomic targets,
and that it outperforms the existing algorithms especially in the
detection of medium and short ROH.

2 METHODS

2.1 B—allele frequencies

As a measure of the homozygo us/heterozygo us genotype state of each
polymorphic position i, we adopted the B-allele frequency (BAP). BAF, is
deﬁned as the ratio between B-allele counts (N B, the number of reads that
match with the 1000GP alternate allele at position i) and the total number
of reads mapped to that position (N, the depth of coverage):

NB
BAR-=7 l
N ()

BAF, may thus assume values that belong to the interval [0,1]: when
BAF, = 0, all the reads aligned to position 1' match with the major allele;
when BAF, = 1, all the reads match with the minor allele; and when

BAF, 7e 0, 1, some reads match with the major allele, whereas some
others match with the minor allele (see Supplementary Methods). It fol-
lows that BAF, can predict the homozygous/heterozygous genotype state
of each polymorphic position i:

a when BAF, % 0, the polymorphic position is homozygous reference;
a when BAE— % 0.5, the polymorphic position is heterozygous; and
a when BAF, % 1, the polymorphic position is homozygous alternate.

To the scope of the present work, the use of the BAF measure has some
advantages compared with that of NGS genotype calls. First, BAF cal-
culation does not require computationally intensive steps like binary
sequence alignment/map (Li et al., 2009) ﬁle realignment and recalibra-
tion, which are widely adopted to improve reliability of variant calls.
Second, genotype calling is usually performed for variant sites only,
thereby an additional genotype calling step would be needed to cover
also non-variant sites.

2.2 Map construction

To create a map of exomic SNPs, we included all the polymorphic pos-
itions discovered by 1000 Genomes Project Consortium (2012) falling
into the range of the 1000GP exomic target regions (downloaded at
http://www.1000genomes.org/) plus 1000 bp of sequences ﬂanking both
sides of each target region. As a result of this procedure, we selected
4163299 SNPs: the distance between adjacent SNPs ranged from lbp
to 22 Mb with mean and median values of 47 and 686 bp, respectively,
(and 375% of the distances under 110 bp).

2.3 H3M2 model and algorithm

To identify homozygous DNA segments, we decided to model BAF data
by means of a discrete state HMM with continuous output. A discrete
HMM with continuous output is characterized by the following elements:

a The number of hidden states, K, in the model. The states are denoted
as S={S1, ..., SK} while (1,- denotes the actual state at position i
(1 5 i 5 n).

o The observed data O={01, ..., ON}.

a The initial state distribution, :1, where 111k = P011 = Sk).

o The emission probability distributions bk(i), that is, the probability
of observing O,- at position 1' given the state Sk: bk(i) = P[O,-|q,- = Sk].

o The transition matrix, A, giving the probability of moving from one
state to another, Aim =P(qi+1 =Sm|qi=Sl) for 1 5 [5 n — 1 and
1 5 l, m 5 K.

To model our problem, we used a two-state HMM (K = 2) where the
hidden states represent non-homozygous (S1=non — Ham) and homo-
zygous (S2 =Hom) states of the genome, and the observations are the
BAF values at each polymorphic position 1' (BAR). The emission distri-
butions are mixture of truncated Gaussian density with the following
form:

' P(BAFilqi = 51) = C1g7(BAFi; 91) 1' 6257709141711 92) 1' C3g7(BAFi; 93)
' P(BAFilqi = 52) = C1g7(BAFi; 91) 1' C3g7(BAFi; 93)

whe3re ck is the proportion of the k-th component in the mixture with

k:16k=1311d91=(ll«1=0,F‘01),92=(M2=0-5,02)311d93 =(M3=1,
F > 03) are the means and the variances of the three truncated Gaussians. The
lower and upper bounds are l = 0 and u = 1 for the three truncated Gaussians.

F is a parameter used to modulate the spread of the two truncated
Gaussian distributions with mean Ml = 0 and M3 = 1. F can take values in
the range [1, co], and the larger is its value the larger is the probability to
include in homozygous regions BAF values that strongly deviate from 0
and 1. In practice, the parameter F allows our model to recognize ROH

 

2853

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} papBoIII/noq

9103 ‘Og isnﬁnV uo ::

A.Magi et al.

 

taking into account sequencing and alignment errors that, in complex
regions of the genome, could generate BAF values that belong to the g2
distribution (heterozygous state). The expression of a truncated Gaussian
density g with lower bound 1 and upper bound u can be easily derived
from the density of a non-truncated Gaussian:

ﬂBAE; 9)

g7(BAE; 9): W

17(BAF1), (2)
where f(o; 6) and F(o; 6) represent the density and cumulative distribution
functions of a non-truncated Gaussian of parameter 6: (11., 02) and 17(3
AF,-) = 1 if BAF,- belongs to the interval [1, u] and I7(BAF,—) = 0 otherwise.
Finally, to take into account the distance between consecutive poly-
morphic positions d =(d1, d2, ..., .dnzl), we decided to incorporate them
into the transition probabilities matrix A,- deﬁned for 1 5 i 5 n — 1:

A_=(1—p1(1—e*ﬁ) p10 —e*fi) )
' p20 — e’fi) 1 —p2(1 — e’fi)

where [71 ([72) represents the probability of moving from State 1 to State 2
(from State 2 to State 1) in the homogeneous HMM, f,- =d,-/dN,,,m and
dNorm is the distance normalization parameter. The parameter dNorm
modulates the effect of genomic distance d,- on the transition probabilities:
the larger is dNorm the smaller is the probability to jump from one state to
another.

To estimate the parameters of the heterogeneous HMM, we developed
a two-step computational recipe based on expectation-maximization
(EM) and Viterbi algorithms. In the ﬁrst step, we estimate the variances
0k and the proportions ck of the mixture of three truncated Gaussians,
whereas in the second step we estimate the best state sequence (we asso-
ciate each BAF value to particular states) by using the Viterbi algorithm.
The inputs to the algorithm are the sequence of BAF values
BAF=(BAF1, BAFZ, .., BAFN), the distance between consecutive poly-
morphic positions d =(d1, d2, ..., .dnzl), the values of the parameters F,
[71, p2 and dNom, and the output are genomic regions with consecutive
SNPs in homozygous and heterozygous states. We decided to use the two
transition probabilities p1 and [72 as algorithm parameters instead of
estimating them with an EM algorithm, as we do believe that they can
be useful in setting the resolution of our algorithm (the capability of our
computational method to detect ROH of different size and with different
number of SNPs).

To estimate the parameters 0k and ck of the Gaussian mixture model,
we make use of the classical EM algorithm (Dempster et al., 1977). In
brief, denoting with Zk, the hidden state for BAF,- (Zk, is a random vari-
able equal to 1 if BAF,- belongs to state k and 0 otherwise), we can deﬁne
the conditional probabilities 1k,- = Pr(Zk,- = 1|BAF,-). The basic ingredient
of the EM family of algorithms is the iterative application of an expect-
ation step followed by a likelihood maximization step. EM starts with
initial values (cm), 020)) for the parameters and iteratively performs the
two steps until convergence. In the E-step, the conditional probabilities

1k,- are computed. Given the parameters estimated at h-th iteration, c)!”

and 6)!” = (My), 0):”), the conditional probabilities  1 are obtained with

the following formula:

(3)

h u .
c5. )g, (ml, 6:)

N (4)
Z Ckgﬂmr; 9:)
i= 1

+1_
I? L

I

In the M-step, the proportions of the components in the mixture and the
empirical estimators of the mean and the variance are computed. In par-
ticular at the iteration (h -l- 1) of the M-step, we compute a)“ 1) and c)“ 1)

with the following formulas:

N h+1 (h+1) 2
Garth: Zi=1rki (mi _”‘k )

k N h+1 ’
i=lrki

(5)

N
c(h+l): Zi=lfzi+1 
k N '

Finally, once all the parameters of the mixture of Gaussians have been
estimated, we apply the Viterbi algorithm to ﬁnd the best state sequence
and consequently to associate each BAF value to one of the two (non-
homozygous/homozygous) states, thus identifying ROH.

3 RESULTS

3.1 BAF properties and distributions

To evaluate the capability of BAF to predict the homozygous/
heterozygous SNP state, and of BAF profiles to discriminate
between homozygous and heterozygous DNA segments, we stu-
died the distribution of BAF values by analyzing WES data of
three individuals (NA12878, NA12891 and NA12892) sequenced
by the 1000GP consortium and previously genotyped with SNP-
array technologies by the HapMap consortium (see
Supplementary Methods). For each position i of the SNP-map,
we compared the BAF value with HapMap genotypes and with
genotypes independently generated by SAMtools (Li et al., 2009)
and the Genome Analysis ToolKit (GATK) (McKenna et al.,
2010) on WES data (see Supplementary Methods). All the ana-
lyses were performed by progressively ﬁltering out SNPs covered
less than a deﬁned threshold (5x, 10x, 15x and 20x). The re-
sults of these comparisons are reported in panels a, b and c of
Figure 1 and Supplementary Figures 173, and clearly show
strong correlation between BAF and SNP genotypes calls. The
‘Violin Plots’ reported in panels a, b and c of Figure 1 illustrate
the capability of BAF values to predict the genotype calls made
by SAMtools (R = 0.988), GATK (R = 0.993) and SNP-array
data (R = 0.99). Moreover, as expected, higher the coverage over
the polymorphic position higher the correlation between BAF
and genotype calls (Supplementary Figs 173). Based on these
results, we performed all the downstream analyses by using
only SNPs covered 3 10.

As a further step, to evaluate the capability of BAF profiles to
discriminate between homozygous and non-homozygous regions
of the genome, we studied the distributions of BAF in different
sets of genomic regions. To this end, we defined as homozygous
and non-homozygous gold standard regions, those classiﬁed as
such by PLINK on HapMap calls (see Supplementary Material).
The four sets in which we studied BAF distribution were (i) all
the regions of the genome, (ii) the homozygous regions only, (iii)
the non-homozygous regions only and (iv) the non-pseudoauto-
somal X chromosome of male individuals. The results reported
in panels d, e, f and g of Figure 1 reveal that the BAF distribution
across all the polymorphic positions can be well approximated by
a mixture of three truncated normal distributions:

3
gr(BAF.-; c. 6)=chgr(BAF.-; at). (7)
k= 1

where ck is the proportion of the k—th component in the mixture
with Z : l ck = 1 and 6k = (Mk, 0k) are the means and the vari-
ances ofjfthe three Gaussians with 01:0, #2 =0.5 and #3 =1.
The lower and upper bounds are I = 0 and u = 1 for the three
truncated Gaussians.

 

2854

112 /310's112u1n0fp101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

HBMZ: detection of runs of homozygosity

 

 

mm...“
>_i

WMlkMMF U-
._._._._._.
>—E

Mai-Lama” O

 

«mm-w

 

 

1.:

 

 

«men->1

an 02 n.A m m m" an 02 m nu ma Ln

«gun,

as 02 m u an in

 

 

 

 

 

 

 

ID

i

Fig. 1. BAF data distribution. Panels a, b and c show the distributions of
BAF values against the genotype calls generated by the HapMap con-
sortium on SNP-array data (a), the genotype calls made by SAMtools (b)
and the genotype calls made by GATK (c). For each genotype caller, the
distribution of BAF values is reported for homozygous reference calls
(HMr), heterozygous calls (HT) and homozygous alternative calls
(HMa). R is the Pearson correlation coefﬁcient. Panels dig show the
distribution of BAF values in all the regions of the genome (d), in het-
erozygous regions (e), in homozygous regions (1) and in the X chromo-
some of male individuals (g). For each panel, the main plot reports the
zoomed histogram, the left subplot shows the BAF values against gen-
omic positions, whereas the right subplot shows the entire histogram of
BAF values

Figure 1 also shows that in non-homozygous regions (Fig. 1e)
ck 75 0 for all the three distributions, whereas in homozygous
regions (Fig. 2f and g) cz = 0. Thus, homozygous and non-homo-
zygous regions can be discriminated based on BAF distribution
as signature. Genomic regions with BAF values generated by
Equation 7 with cz 75 0 can be classiﬁed as non-homozygous,
whereas genomic regions with BAF values generated by
Equation 7 with Q = 0 can be classiﬁed as homozygous.

3.2 Synthetic validations

To test the ability of H3M2 to detect ROH of different sizes and
constituted by different number of SNPs as a function of the
distance between consecutive markers, we performed an intensive
simulation based on synthetic data. To this end, we generated
synthetic chromosomes starting from the BAF data of the three
samples used in previous section. BAF data from the non-pseu-
doautosomal X chromosome of the male individual NA12891
were used to simulate homozygous DNA segments, whereas
BAF data from the autosomal chromosomes of all the three
samples were used to simulate heterozygous segments.

Each synthetic chromosome was generated as a stretch of 2000
polymorphic positions in which:

0 Homozygous segments were simulated as N consecutive
data sampled from the BAF values of the non-pseudoauto-
somal X chromosomes regions of male individuals.

0 Non-homozygous segments were simulated by sampling
(2000—N) data from the BAF values of the autosomal
chromosomes of the three aforementioned individuals.

(a) 0.8 — 1.0 (13)“ ma

0.:

as - 06

 

0.1 u.2 0.: 0.4 0.5 0.5 0.7 0.3 0.1 0.2 0.3 0.4 as as 07 0.3

(c) m (d) (e) n pl

_ an
15

 

a

Sanallwily

on 0.2 04 u u.a ta
Spacﬂicmy

0.0 0.2 0.4 0.6 0.0 I

 

 

 

 

 

3.
a
3,.
5
<1.

10‘ 10‘ w u u. a. in
Guam “Nam miss

Fig. 2. H3M2 algorithm and parameter settings on synthetic chromo-
somes. The contour plots of panels a and b show the sensitivity and
speciﬁcity of H3M2 for different combinations of values of [71 and [72
parameters. Panel c and (1 show the sensitivity and speciﬁcity of H3M2
against dNorm. Panel e shows the performance of H3M2 as a function of
the parameter F

Heterozygous segments were imposed to have SNPs in a
heterozygous/homozygous ratio of 1:9. To this end, we
sampled one BAF value from SNPs called as heterozygous
by GATK every nine sampled SNPs called as homozygous
by GATK.

The 1:9 ratio was imposed to simulate at best the actual het-
erozygous/homozygous proportion and to prevent the emergence
of false-positive (FP) homozygous segments. To reproduce the
complex architecture and distribution of homozygous and het-
erozygous WES regions, we generated distances between adja-
cent SNPs as follows:

0 The distances between consecutive SNPs in non-homozy-
gous regions are sampled from the distribution of the dis-
tances between adjacent WES polymorphic positions.

0 The distances between adjacent polymorphic positions in
homozygous regions are fixed to a predeﬁned distance D.

We performed simulations with N = (50, 100, 200, 300, 400,
500, 600, 700, 800, 900 and 1000) and D= (10 bp, 100 bp, 1 kb,
10 kb and 100 kb), and for each combination of N and D we
generated 100 synthetic chromosomes: all the synthetic datasets
were analyzed by using different values of the parameter dem
(de... =103, 104, 105 and 106), p1 and [)2 (from 0.05 to 0.8 by
0.05).

To evaluate the performance of H3M2 for different parameter
settings, we calculated sensitivity (true-positive rate, TPR) and
speciﬁcity (l-FPR, false-positive rate). TPR was deﬁned as the
number of markers inside the synthetic ROH called by H3M2 as
homozygous divided by the total number of markers inside the
synthetic ROH. FPR was deﬁned as the number of markers
outside the synthetic ROH called by H3M2 as homozygous
divided by the total number of markers outside the synthetic
ROH. The results of these analyses are summarized in Figure 2.

Figure 2a and b report the sensitivity and speciﬁcity for all the
combinations of the [)1 and [)2 parameters. Figure 2a shows that

 

2855

112 /310's112u1n0fp101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.Magi et al.

 

the larger [)2 the smaller the range of [)1 values that ensure high
sensitivity. In particular, when [)2 =0.1, almost any value of [)1
guarantees the best performance in term of sensitivity. On the
other hand, Figure 2b demonstrates that for values of [)1 >04
the speciﬁcity of our method drastically decreases. In summary,
because global performance of H3M2 is a result of the trade-off
between sensitivity and speciﬁcity, we argue that the best per-
formance can be obtained by setting [)1 =0.1 and [)2 e [0.1, 0.3].
Figure 2c and d report the results of this analysis as a function of
the dem parameter and show that dNnrm has strong effect on
global performance of H3M2: the larger is dNnrm the smaller
(larger) is sensitivity (speciﬁcity).

To study the effect of the parameter F in modulating the cap-
ability of H3M2 to tolerate sequencing and alignment errors in
the detection of ROH, we built another synthetic dataset. The
synthetic chromosomes of this dataset were generated with the
same procedure described above, apart from the central SNP of
the homozygous stretch. With the purpose of reproducing
increasing error rates, BAF values ranging from 0.1 to 0.9 were
assigned to the central SNP. We applied H3M2 to this synthetic
dataset using different values of the parameter F (F e [1, 20]),
and the results are reported in the contour plot of Figure 2e.
Each point in the plot represents the fraction of times the algo-
rithm detects a unique ROH instead of splitting it in two ROH.
These results show that larger F values make H3M2 more toler-
ant of positions characterized by higher sequencing and align-
ment error rates that appear to be heterozygous sites: as an
example, F = 10 induces the algorithm to include in a homozy-
gous region BAF values as large as 0.35.

As a further test, to evaluate the capability of H3M2 to detect
ROH of different size and comprising different number of SNPs,
we calculated TPR and FPR as follows: a detected ROH is con-
sidered a true positive if it has any overlap with a synthetic ROH,
whereas it is considered a FP if it has no overlap with a
synthetic ROH. These analyses were performed by setting
p2=0.l, [)1 e [0.05.0.3] and dN.,.,,,=(103,104,105,106). As ex-
pected, the results (Fig. 3) show that the larger the number of
SNPs falling within a given ROH the higher the probability to
correctly identify the homozygous region. The same holds, con-
sidering the distance between adjacent positions (D): the larger D
the higher the probability to call the region as homozygous.

A detailed analysis of Figures 3a and b reveals that the sensi-
tivity of H3M2 increases with increasing values of the parameter
p1. However, setting [)1 3 0.1 has little effect on the resolution of
H3M2 (i.e. the capability of the algorithm to detect ROH con-
stituted by a small number of SNPs), while it favors the detection
of FP events (Fig. 3c). On the other hand, the results of
Figure 3dif show that the parameter dNnrm strongly affects the
performance of the H3M2 algorithm in terms of both sensitivity
and speciﬁcity: the smaller dNnrm the higher the probability to
detect small ROH (ROH characterized by high SNP density) and
FP events. The results of these analyses (Supplementary Figs
4e8) also show that the parameter dem rules the capability of
H3 M2 to detect homozygous segments characterized by variable
SNP densities. When dem is set to large values (105, 106), H3M2
is not able to detect homozygous segments made of even hun-
dreds of densely distributed SNPs and increasing [)1 has poor
effect on the resolution of the algorithm. On the contrary,
when dNnrm is set to small values (103,104), H3M2 is able to

 

 

 

 

:6 :m

,,;10‘— 0,.=w‘- dwm‘- ham

(e) f (0

¢

200 m um um mm mu» mm no: mm. mm

s
.
«
3
m

 

I n m m «7 so

 

 

Fr
m on

 

 

 

 

 

 

an 02 at u an lﬂn

 

I n m m u: so

Fig. 3. Performance evaluation of the H3 M2 algorithm in the detection of
ROHs on synthetic chromosomes. Panels aw report the performance of
H3M2 as a function of parameter [7], whereas panels def as a function of
parameter DNorm. Panels a and (1 show TPR versus the number of SNPs
within the detected ROH. Panels b and e show the TPR as a function of
the distance between consecutive polymorphic positions in the detected
ROH. Panels c and f show the number of FF ROH detected by the H3M2

detect homozygous segments made of densely distributed
SNPs, and increasing [)1 has a relevant effect on resolution.

Taken as a whole, these results suggest that to detect large
homozygous segments and limit the false discovery rate, large
values of dem (105, 106) and small values of [)1 (0.1) should be
used. On the other hand, to detect homozygosity with a high
level of resolution, small dem (103, 104) and large [)1 values
(0.2, 0.3) are recommended.

3.3 Real data analysis

To test the proposed computational pipeline for the identifica-
tion of homozygous segments on real data, we analyzed the WES
data of 15 individuals (ﬁve CEU, Utah residents with ancestry
from Northern and Western Europe, ﬁve JPT, Japanese in
Tokyo, and five YRI, Yoruba in Ibadan) sequenced by
1000GP consortium (see Supplementary Methods) by using the
following parameter settings: [)2 =0.1, p1 =[0.1, 0.2, 0.3] and
de =[103,104,105].

First, we studied the detected ROH in terms of both cumula-
tive global size and fraction of SNPs within them. As expected
(Fig. 4aif), the larger the value of the parameter [)1 the larger the
total size of the detected ROH, and accordingly the larger the
total fraction of SNPs within the detected ROH. Conversely, the
smaller is dem the larger is the total size and the total fraction of
SNPs detected by H3M2. By setting the most conservative set of
parameters (dNorm = 105 and p1 = 0.1), H3 M2 detected an average
of around 160 Mb (10% of SNPs) in the YRI individuals,
330Mb in the CEU (18% of SNPs) and 380 in the JPT (21%
of SNPs), whereas using more inclusive parameters
(dNorm =103,p1=0.3), we detected 860 Mb (38% of SNPs) for
YRI, and around 1.25 Gb for both CEU and JPT individuals
(50% of SNPs).

Subsequently, we compared the results of H3M2 with those
obtained by PLINK and GERMLINE on the GATK calls. To
allow for a comprehensive evaluation of the performance of the
two tools, we deﬁned six different parameter conﬁgurations for
each of the tools (see Supplementary Methods). By using the
most conservative conﬁguration, PLINK (— —homozyg—snp
500 and ——homozyg—window—het 0) detected around 11 Mb

 

2856

112 /310's112u1n0fp101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

HBMZ: detection of runs of homozygosity

 

 

E (a) g (b)

a r:

g as

iaaaAJAabaaanAA
(E) g (5)

0521mm)...
1

##Qééaa¥!!!AJ££

awimimm

ninmsamsa-a

 

 

nwmwmwu

 

(k

we on in

   

 

 

 

 

 

 

 

DOZDANDBI 0020405031 aozuouosi

Fig. 4. Performance comparison between H3M2, GERMLINE and
PLINK on the WES data of the 15 individuals sequenced by the 1000
Genomes Project Consortium. The bar plots of panels a, c and e show the
total length of ROH detected by the three approaches in the YRI (a),
CEU (c) and JPT (e) individuals. The bar plots of panels b, d and f show
the total percentage of SNPs that belong to the ROH detected by the
three approaches in the YRI (b), CEU (d) and JPT (1) individuals. Each
bar of the bar plot is colored with three different graduated shading: dark
shading represents small ROHs (ROI-Is 5 500kb), lighter shading repre-
sents medium ROHs (500kb< ROI-Is 5 1500Kb) and light shading repre-
sents large ROHs (ROHs>1500kb). The bar plots of panels gj report
the fraction of heterozygous single nucleotide variants that belong to all
(g), small (h), medium (i) and large (i) ROHs detected by the three algo-
rithms. The performance of the H3M2 algorithm have been reported for
different settings of the DN0,,,, (103, 104, 105) and [71 (0.1, 0.2, 0.3) param-
eters. The performance of PLINK have been reported for different values
of heterozygote allowance (PL-H = Oand PL-H = 1) and different values
of SNP threshold to call a ROH/sliding window size in SNPs (-snp = 50,
250 and 500). The performance of GERMLINE has been reported for
different values of mismatching heterozygote allowance (G-H = 0 and
G-H = 1) and different window size in SNPs (-bits = 50, 250 and 500).
Panels kim report the results of the precisionirecall analysis for small,
medium and large ROHs, respectively

(1% of the analyzed SNPs) of ROH for the YRI individuals,
26 Mb (3% of SNPs) for the CEU and 53 Mb (4% of SNPs) for
JPT, whereas GERMLINE (—bits 500 and err_het 0) iden-
tiﬁed 32 Mb (2% of analyzed SNPs) for the YRI, 141 Mb (8% of
SNPs) for CEU and 202 Mb (11% of SNPs) for JPT. On the
other hand, using the less stringent configuration (— —homozyg—
snp 50, ——homozyg—window—het l for PLINK and —bits
50, —err_het 1 for GERMLINE), PLINK detected around
1.35 Gb (60% of analyzed SNPs) for each YRI, 1.7 Gb (76%
of SNPs) for CEU and 1.62 Gb (73%) for JPT, whereas
GERMLINE identiﬁed 2.6Gb (90% of analyzed SNPs) for
YRI, 2.7 Gb (94.5% of SNPs) for CEU and 2.65 Gb (92% of
SNPs) for JPT.

The total ROH length per individual detected with the most
conservative parameter setting of H3M2 is in general agreement
with previously published work that studied homozygosity at a
population level (Auton et al., 2009; Kirin et al., 2010;
Pemberton et al., 2012). The YRI population has the shortest
ROH per individual, reﬂecting the longer time over which re-
combination has been breaking haplotypes in this sub-Saharan
African population, whereas the individuals in East Asia popu-
lations (JPT) have a slightly greater cumulative length of ROH
than the other populations, which most likely reflects smaller
founder population sizes in these populations.

Subsequently, we studied the properties of the detected ROH
by classifying them into three classes: ROH smaller than 500 kb
(A), ROH in the interval (500 kb, 1.5 Mb) (B) and ROH >1.5
Mb (C), grossly following the classiﬁcation adopted by
(Pemberton et al., 2012). The ﬁrst class (A) gathers short ROH
mainly governed by local LD patterns; the second class (B) is
that supposedly resulting from background relatedness in the
population; and finally the third class (C) includes ROH origi-
nated from recent parental relatedness. The results obtained in
this analysis completely reﬂect those of the synthetic data. When
dNnrm is large (105), increasing [)1 poorly affects the total amount
of ROH detected in the three classes: Class A ranges between 101
and 141 Mb, Class B between 176 and 233 Mb and Class C be-
tween 232 to 310 Mb. Conversely, when dNnrm is small (103) the
parameter [)1 has strong effect on the total size of ROH detected
in each of the three classes: Class A ranges from 200 to 460 Mb,
Class B ranges from 311 to 520 Mb and Class C from 392 and
567 Mb. With regard to SNP proportions (Fig. 4b, d and 1),
when dNnm, is large, increasing [)1 has little effect on the total
fraction of SNPs involved in ROH regions (independently of the
class), whereas for small values of dem, increasing [)1 drastically
inﬂates the total fraction of SNPs within Class A ROH but has
limited effect on the other two classes. All these results are ex-
plained by the fact that dNnrm dictates the resolution of the algo-
rithm. Large values of dNnrm enable the algorithm to detect only
large ROH or small ROH featuring a large number of SNPs. In
this situation, increasing [)1 only improves the capability to detect
Class B or C ROH containing a small number of markers. On
the other hand, small dNnrm values enable H3M2 to efﬁciently
detect also Class A ROH. In this case, increasing [)1 enables H3
M2 to identify the huge amount of small ROH made of small
number of markers. On the three ROH class analysis, PLINK
provided results similar to those of the present approach, while
GERMLINE efﬁciently detected only large ROH.

As a further step, to study the accuracy of the three algo-
rithms, we examined the proportion of heterozygous variants
independently called by GATK that in each of the 15
HapMap individuals overlapped the ROH detected by each of
the three methods. Globally, as well as for any ROH class sep-
arately, ROH detected by H3 M2 are characterized by the smal-
lest fraction of heterozygous GATK calls, with the sole exception
of Class B ROH where one of the PLINK parameter conﬁgur-
ations (— —homozyg—snp 500 and ——homozyg—window—het
0) performs slightly better (Fig. 4gij). These results demonstrate
the capability of our algorithm in detecting genuine homozygous
segments with respect to the other methods.

Finally, to evaluate H3M2 ability to identify ROH from WES
data and to compare its performance with respect to the other

 

2857

112 /310's112u1n0fp101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.Magi et al.

 

two state-of—the-art methods, we used the ROH detected by
PLINK on the HapMap data as gold standard regions. The
1.6 million HapMap SNPs are rather uniformly distributed
across the entire genome with a mean SNP-to-SNP distance of
around 2 kb. Conversely, the 4.2 million SNPs that we used are
densely clustered in the exome target regions with a mean dis-
tance of 686 bp. It follows that these two different experimental
designs may show limited overlap, making it difﬁcult to compare
results obtained by the respective analysis. To overcome this
drawback, we evaluated only those polymorphic positions inter-
rogated by both platforms and calculated precision and recall in
the following manner:

0 To calculate precision, we considered all the polymorphic
positions called in ROH by each of the three methods that
belong to the HapMap dataset, and we then calculated the
fraction of these positions that were called as homozygous
also in the gold standard dataset.

c To calculate recall, we considered all the polymorphic pos-
ition called in ROH in the gold standard dataset that belong
to WES experimental design, and we then calculated the
fraction of these positions called as homozygous by each
of the three state-of-the-art methods.

These analyses were performed for the three A, B, C ROH
classes separately and the results are reported in Figure 4kim.
The precisionirecall plots of Figure 4 show that the combination
of large values of [)1 (0.2, 0.3) and small values of dNnrm (103, 104)
increases the recall rate at the expense of the precision of H3M2.
On the other hand, the combination of small [)1 values (0.1) and
large dem values (105) increases the precision of H3M2, while it
decreases the recall rate. Moreover, changes in parameter con-
ﬁguration significantly perturb the performance of H3M2 for
Class A, but not for Class B and C, ROH. The combination
of parameters that ensure the best trade-off between precision
and recall is [)1 = 0.1 and dNarm = 105. Unlike H3M2, the perform-
ance of the two state-of—the-art algorithms is profoundly altered
by changes in parameter conﬁgurations, whatever the ROH
class. The high recall rate reached by GERMLINE and
PLINK with less stringent parameter settings (—bits 50,
——homozyg—snp 50) is obtained paying a tremendous cost in
terms of precision at least for A and B ROH classes. On the other
hand, attempts to improve precision adopting conservative par-
ameter configurations (—bits 500 and ——homo zyg—snp 500)
lead to a drastic deterioration of recall rates. With its best par-
ameter conﬁguration (— —homo zyg—snp 250, — —homo zyg—
window—het 1), PLINK achieves a performance comparable
with H3M2 in the detection of Class C ROH (Fig. 4m), but
not of Class A and B (Fig. 4k71). Taken as a whole, these results
disclose how H3M2 outperforms the existing state-of-the-art
methods in terms of both precision and recall (sensitivity and
speciﬁcity), and how H3M2 performances are more robust with
respect to changes in parameter conﬁgurations.

4 DISCUSSION AND CONCLUSION

In this article, we present a novel approach for the detection of
ROH from individual WES data. The major computational issue
we had to deal with was the non-uniform distribution of DNA

markers in the exomic space. Current state-of-the-art methods
for ROH detection have been conceived to be used with SNP-
array data, which in principle rely on genomic maps featuring
equally spaced SNPs. This represents an intrinsic limitation to
the application of such approaches to SNP maps retrieved from
exome-targeted designs. If this issue can be overcome when
focusing on ROH as large as megabases (Class C in the present
article) (Pippucci et al., 2011), it can be less easily resolved when
handling regions of smaller size (Class A and B in the present
article). To meet the need of an approach tailored to WES data
and develop a method that could efﬁciently capture exomic
ROH of any size, we designed the H3M2 algorithm that incorp-
orates the distances between consecutive SNPs into the transition
matrix of the heterogeneous HMM.

We compared H3M2 performances with those of two methods
based on slidingiwindow algorithms, GERMLINE and PLINK.
Previous application of GERMLINE to WES data offered poor
speciﬁcity/sensitivity trade-offs to isolate even long IBD seg-
ments beyond 10 cM (Zhuang et al., 2012). We conﬁrmed this
observation: the highest recall rates reached by GERMLINE
were obtained at a tremendous expense in precision.
Conversely, demanding higher precision caused an indiscrimin-
ate fall of recall rates (Fig. 4kim). As expected, based on what
was already reported for SNP-array data (Howrigan et al., 2011),
PLINK algorithm holds well even on WES data, and behaved
better than GERMLINE independently of the ROH class
(Fig. 4kim). H3 M 2, using the parameter configuration that guar-
antee the most appropriate F-measure according to the synthetic
data analysis ([71 = 0.1 and dNarm = 105), outperforms both
GERMLINE and PLINK for A and B classes. The previously
reported (Pippucci et al., 2011) ability of PLINK to detect long
exomic ROH emerges also from the present analysis, where its
performance in the detection of Class C is excellent with two
different parameter conﬁgurations (— —homozyg—snp 50,
——homo zyg—window—het 0 and ——homozyg—snp 250,
— —homo zyg—window—het 1) and highly comparable with
that of H3M2. Survey of the heterozygous genotypes independ-
ently called by GATK within detected regions emphasized how
H3M2 ensures the most accurate global ROH identiﬁcation. The
gain in performance of H3M2 in the detection of Class B and
Class A ROHs should not be undervalued. As it has been re-
cently highlighted, despite their small size, such regions may be
biologically relevant (Pemberton et al., 2012) and surround a
causative mutation (Hildebrandt et al., 2009).

In ROH studies, it might be useful to take into account for
LD, especially for Class A ROHs. This has been done in different
ways (McQuillan et al., 2008; Nothnagel et al., 2010). Similarly,
it might be desirable to identify autozygous ROHs according to
the probability of ROHs to be IBD (Pemberton et al., 2012). H3
M2 detects all ROHs, without making such functional distinc-
tions. All these approaches can be applied to ROHs identified by
H3M2 as part of downstream analysis.

A notable advantage of H3M2 is that its performance appears
to be little altered by changes in parameter conﬁguration. This is
a particularly important property in the context of WES-based
analyses, where the number and distribution of markers can vary
extensively according to target design and experimental yield.
Performance of sliding-window methods appears to be severely
affected by this variability. Parameter changes affect H3M2

 

2858

112 /310's112u1n0fp101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

HBMZ: detection of runs of homozygosity

 

performance less drastically than they do for PLINK and
GERMLINE, indicating that H3M2 results are robust across a
wide range of parameter conﬁgurations. This is more evident for
Class B and C, where all the F—measures fall in the range
[0.7,0.8], than in Class A, where F—measures span the range
[0.5, 0.7].

Another important feature of H3M2 is its fast computational
performance and its basic hardware requirements. Relying on
BAF proﬁles instead of NGS genotype calls for the detection
of ROH, the analysis of an aligned WES experiment with a
mean coverage of 100x requires around 20 min on a single
2.4GHz processor with 2 Gb of RAM. Conversely, preparation
of input genotype calls for tools like GERMLINE or PLINK
requires at least few hours in the same machine.

In conclusion, H3M2 is a WES-based ROH-detection algo-
rithm well-suited for direct identiﬁcation and classiﬁcation of
exon—rich homozygous regions of every size. It outperforms
GERMLINE and PLINK applied to the same training dataset,
and most importantly it is less sensitive to parameter speciﬁca-
tion, ensuring that analysis results are not severely affected by the
chosen parameter conﬁguration as in GERMLINE and PLINK.
The present work supports the use of H3M2 for homozygosity
mapping where it can efﬁciently replace SNP-arrays, and in stu-
dies of ROH variation and variation content across individuals
in human populations.

Funding: This work was supported by the Italian Ministry of
Health, Young Investigators Programme, Project GR-2009-
1574072 to T.P.

Conﬂict of interest: none declared.

REFERENCES

1000 Genomes Project Consortium. et a]. (2012) An integrated map of genetic
variation from 1,092 human genomes. Nature, 491, 56—65.

1000 Genomes Project Consortium. et a]. (2010) A map of human genome variation
from population—scale sequencing. Nature, 467, 106171073.

Auton,A. et a]. (2009) Global distribution of genomic diversity underscores
rich complex history of continental human populations. Genome Res., 19,
7957803.

Browning,B.L. and Browning,S.R. (2013) Detecting identity by descent and
estimating genotype error rates in sequence data. Am. J. Hum. Genet., 93,
840851.

Dempster,A.P. et a]. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Stat. Soc., 39, 1738.

Gusev,A. et a]. (2009) Whole population, genome—wide mapping of hidden related—
ness. Genome Res., 19, 3187326.

Hildebrandt,F. et a]. (2009) A systematic approach to mapping recessive disease
genes in individuals from outbred populations. PLoS Genet., 5, e1000353.
Howrigan,D.P. et a]. (2011) Detecting autozygosity through runs of homozygosity:
a comparison of three autozygosity detection algorithms. BMC Genomics, 2,

460.

International HapMap Consortium. (2003) The International HapMap Project.
Nature, 426, 7897796.

Kirin,M. et a]. (2010) Genomic runs of homozygosity record population history and
consanguinity. PLoS One, 5, e13996.

Lander,E.S. and Botstein,D. (1987) Homozygosity mapping: a way to map human
recessive traits with the DNA of inbred children. Science, 236, 156771570.
Li,H. et a]. (2009) The sequence alignment/map format and SAMtools.

Bioinformatics, 25, 207872079.

Magi,A. et a]. (2013) EXCAVATOR: detecting copy number variants from whole—
exome sequencing data. Genome Biol., 14, R120.

McKenna,A. et a]. (2010) The Genome Analysis Toolkit: a MapReduce framework
for analyzing next—generation DNA sequencing data. Genome Res., 20,
129771303.

McQuillan,R. et a]. (2008) Runs of homozygosity in European populations. Am. J.
Hum. Genet., 83, 3597372.

Ng,S.B. et a]. (2009) Targeted capture and massively parallel sequencing of 12
human exomes. Nature, 10, 2727276.

Nothnagel,M. et a]. (2010) Genomic and geographic distribution of SNP—deﬁned
runs of homozygosity in Europeans. Hum. M0]. Genet., 19, 292772935.

Pemberton,T.J. et a]. (2012) Genomic patterns of homozygosity in worldwide
human populations. Am. J. Hum. Genet., 10, 2757292.

Pippucci,T. et a]. (2011) EX—HOM (EXome HOMozygosity): a proof of principle.
Hum. Hered., 72, 45753.

Purcell,S. et a]. (2007) PLINK: a toolset for whole genome association and popu—
lation based linkage analyses. Am. J. Hum. Genet., 81, 5597575.

Sabeti,P.C. et a]. (2007) Genome—wide detection and characterization of positive
selection in human populations. Nature, 449, 9137918.

Wang,S. et a]. (2009) Genome—wide autozygosity mapping in human populations.
Genet. Epidemiol, 33, 1727180.

Zhuang,Z. et a]. (2012) Detecting identity by descent and homozygosity mapping in
whole—exome sequencing data. PLoS One., 7, e47618.

 

2859

112 /310's112u1n01p101x0"sotwurJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g1sn8nv uo ::

