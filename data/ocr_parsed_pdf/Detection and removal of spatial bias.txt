Bioinformatics, 32(13), 2016, 1959—1965

doi: 10.1093/bioinformatics/btiA/092

Advance Access Publication Date: 28 February 2016
Original Paper

 

 

Gene expression

Detection and removal of spatial bias in
multiwell assays

Alexander Lachmann1,2,3,r’ Federico M_ Giorgi2,3,4,t' Mariano J. Alvarezz
and Andrea Califano112,3,5,6,7,*

1Department of Biomedical Informatics (DBMI), 2Department of Systems Biology, 3Center for Computational
Biology and Bioinformatics (C2B2), Columbia University, New York, NY, USA, 4Scuola Superiore Sant'Anna, Pisa,
Italy, 5Department of Biochemistry and Molecular Biophysics, 6Institute for Cancer Genetics and 7Herbert Irving
Comprehensive Cancer Center, Columbia University, New York, NY, USA

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.
Associate Editor: Jonathan Wren

Received on August 6, 2015; revised on January 8, 2016; accepted on February 14, 2016

Abstract

Motivation: Multiplex readout assays are now increasingly being performed using microfluidic
automation in multiwell format. For instance, the Library of Integrated Network—based Cellular
Signatures (LINCS) has produced gene expression measurements for tens of thousands of distinct
cell perturbations using a 384—well plate format. This dataset is by far the largest 384—well gene ex—
pression measurement assay ever performed. We investigated the gene expression profiles of a
million samples from the LINCS dataset and found that the vast majority (96%) of the tested plates
were affected by a significant 2D spatial bias.

Results: Using a novel algorithm combining spatial autocorrelation detection and principal compo—
nent analysis, we could remove most of the spatial bias from the LINCS dataset and show in
parallel a dramatic improvement of similarity between biological replicates assayed in different
plates. The proposed methodology is fully general and can be applied to any highly multiplexed
assay performed in multiwell format.

Contact: ac2248@columbia.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

A revolution has occurred in the field of Quantitative
Transcriptomics in the last 15 years, fueled by a significant drop in
the cost of technologies for multiple gene expression profiling
(Montgomery and Dermitzakis, 2011). Such technologies, namely
gene microarrays (Hertzberg and Pope, 2000) and RNASeq (Wang
et (11., 2009), are now standard procedures in biological and medical
research, and they are becoming increasingly more popular as robust
research and diagnostic tools in all biological fields, spanning from
crop research (Hansey et (11., 2012) to drug discovery (Jenkins and
Ma’ayan, 2013) and from microbiology (Westermann et (11., 2012)
to personalized medicine (Derks and Diosdado, 2015). Recently,
both gene expression assays and other multiplexed readout assays

have been implemented in a multiwell format (microplate), lending
themselves to significant microﬂuidic automation and scale—up. This
type of experiments lend themselves to detection and normalization
of a variety of potential bias sources, including effects representing
2D spatial bias introduced by the specific microﬂuidics apparatus.
For instance, multiplex gene expression has been recently used as a
reporter for large—scale cell perturbation assays, allowing for the
quantitative characterization of the corresponding perturbagens as
inducers of specific transcriptional responses at the molecular level
(molecular phenotypes). This new class of studies, named gene ex—
pression high throughput screening (GE—HTS), promise to have sig—
nificant impact on biomedical research (Ma’ayan et (11., 2014), and
have already shown their potential to accelerate drug discovery for

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1959

9103 ‘Org rsnﬁnv 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOlJ’BLUJOJIIlOlq”K1111] 11101} popcolumoq

1960

A.Lachmann et aI.

 

human diseases, such as for leukemia (Stegmaier et (11., 2004) and
muscle atrophy (Kunkel et (11., 2012). Detecting and correcting any
systematic bias generated by such large—scale assays is obviously of
paramount importance to maximize the value of these studies.
Principal component analysis for bias removal has been applied suc—
cessfully to increase the ability to increase power in eQTL identifica—
tion (Fehrmann et (11., 2015). Spatial biases in the probe intensity
levels, commonly observed on oligonucleotide arrays, are removed
by normalization techniques such as GC—RMA (Wu et (11., 2004) or
LOESS normalization (Smyth and Speed, 2003). The largest dataset
of this kind to date, has been generated by the Library of Integrated
Network—based Cellular Signatures (LINCS) effort (Vempati et (11.,
2014). It represents a direct extension of the Connectivity Map
(CMAP), the first large—scale GE—HTS study (Lamb et (11., 2006).
LINCS adopted an innovative approach to measuring gene expres—
sion at an ultra—low cost, based on medium—throughput profiling of
978 Landmark (L1000) genes across a consistent number of perturb—
ations and cell lines (Duan et (11., 2014). The rest of the transcrip—
tome (20 000 genes) is then inferred by a mathematical model built
on top of thousands of gene expression measurements from GEO
(Barrett et (11., 2013). The LINCS dataset collects roughly a million
experiments where different cell types (primary and transformed
human cell lines) are chemically (by small molecule compounds) and
genetically (by shRNA knock—down or cDNA over—expression)
perturbed (Liu et (11., 2015). The LINCS dataset was conducted on
384—well (24 X 16 format) microplates and is so far the biggest
microplate—based experiment ever produced. As such, it offers an
unprecedented opportunity to both detect and normalize bias intro—
duced by the experimental setup.

2 Methods

2.1 LINCS dataset

The normalized LINCS dataset was obtained from the LINCS consor—
tium (http://support.lincscloud.org). Specifically, the dataset analyzed
in the current manuscript is composed of a total of 1894 microplates
of which 963 are perturbed by targeted gene Knock—Downs (KD),
747 by Chemical/Pharmaceutical Compounds (CPC), and 184 by
gene Over—Expression (OE). In total, the dataset we analyzed is com—
posed of eight different cell lines (PC3, MCF7, VCAP, HT29, HA1E,
A375, HCC515, and A549). The total number of different experi—
ments included in the analysis was comprised of 685 612 gene expres—
sion profiles. Following the L1000 procedure (Duan et (11., 2014), a
total of 978 genes have a direct measurement (landmark genes) while
for 22 000 more genes the transcript amounts were inferred.

2.2 Bias detection

In order to detect 2D spatial bias, we formulated the problem
through a spatial autocorrelation framework. Spatial autocorrel—
ation is a 2D space measure to assess how variables at neighboring
locations in 2D space co—vary (Dale and Fortin, 2002). The most
common way to measure spatial correlation is by calculating
Moran’s I (Moran, 1950), which measures the correlation of signal
amongst spatial neighbors (Equation 1):

N Z Z til-(X.- — Xxx,- — X)
I I
ZZE‘,‘ Z<Xi—X)2
I .

i z

1(x, T) :

 

(1)

where N is the number of samples in an array (e.g. a microplate),
each X is a variable (gene), X is the mean of X, and Ti,- (plate row i

and plate column /) is the topology encoded as a weight matrix (i.e.
which wells are neighbors). T,,- is a symmetric N X N matrix with
t,,- E {0, 1}. t,,- is 1 if well i is adjacent to well i and 0 otherwise. Like
Pearson’s correlation, the values for Moran’s I can range from 1
(where the values of the variables are completely correlated to the
values of their neighbors) to —1 (a checkerboard—like scenario,
where every sample is inversely correlated to its neighbors).

2.3 Bias removal

The main assumption in the spatial bias removal is the redundancy
of biases across multiple genes. With redundancy we specifically
mean that a bias affects all genes with to a certain degree. The
observed gene expression (3 for a gene is composed of the true biolo—
gical signal e and additive bias components. For a set of genes size G
and well (i, j) on a given plate with a set of M biases r/Im(i,/') of ‘I’
and the corresponding coefficient matrix C E G X M, the observed
gene expression can be noted as:

M
é(g. 13/) : e(g, 13/) + Z cg». x 111M131) (2)

m:1

e(g, i, j) is the true biological gene expression in well (i, i) when all
biases are removed from the observed gene expression. r/Im(i, /) E ‘I’ is
a function, representing a bias and ‘I’ is the set of all biases that are
defined over the coordinates of the plates. In our approach we specif—
ically search for the bias functions in ‘I’ that result in significant spa—
tial autocorrelation. The coefficients CM 6 C are defining the impact
of the bias n on gene g. The coefficient cgm stays constant for gene g
and bias m is not depended on well coordinate (i, j). A larger absolute
coefficient represents a stronger effect of the bias on the gene expres—
sion. In return the coefficient indicates how much it contributes to the
bias with respect to the other genes. For any of the bias functions we
assume that multiple genes are contributing, resulting in non—zero co—
efficients for this bias. This redundancy is a key attribute of the biases,
enabling the proposed solution of the problem.

To account for spatial biases, we ﬁrst decompose the expression data
into the major orthogonal components of variance by Singular Value
Decomposition (SVD) (Golub and Reinsch, 1970; Alter et (11., 2000):

X : UDVt (3)

where X is the G—gene ><N—sample matrix (N : I X ], I rows and ]
columns of the plate) of expression values, D is a diagonal matrix
with the positive singular values d1 > d2 >  > d, > 0 on its diag—
onal and 0 for all other entries, with r : min(G; N), and U and V are
the orthogonal left— and right—singular vectors, which represent the
basis, eigensamples >< genes and eigengenes >< samples square matri—
ces, respectively. We compute the principal components on of Xt
using the R function preamp, resulting in PCs that are linear combin—
ations of the genes in X. The output is C : UD 6 G X r, containing
the scaled eigenvectors and a square N X r matrix V containing the
principal component values. The columns of C contain the coeffi—
cients describing the linear combination of genes for the correspond—
ing PC. The PC values in V are the expression values of the
eigengenes. The original gene expression can be back transformed
throughX : CVt.

Due to the redundancy assumption we expect to find eigengenes
that describe bias functions of ‘I’. Each column of V represents a PC
and the rows represent samples/wells of the plate. As such we calcu—
late the Moran’s I spatial autocorrelation for each column of V by
mapping its values to the corresponding plate coordinate. If a princi—
pal component shows a significant spatial autocorrelation the PC
represents a function of ‘I’ as described above.

9103 ‘Org rsnﬁnv 110 seleﬁuv soc] ‘Btulomcg 30 AJtSJQAtuf] 112 /3.10'speu.rn0fp1q1x0"sothJJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

Detection and removal of spatial bias

1961

 

The autocorrelation score is transformed into a weight determin—
ing how much the principal component should be removed
from the data. The weight function is defined as W(x, a, If) : 1 — 1/
(1 + fax—5)) for autocorrelation score x, l)’ defining the climb of W
and a for the function offset. (7 defines in what range the phase tran—
sition from 0 to 1 occurs and [3 how quickly (Supplementary Fig. 1).
For the LINCS data we choose a that maximizes the average in—
crease in RS for the three separate datasets KD, OE and CPC (see
Supplementary Methods, Section 6).

From V we compute vector 5' of length m by converting the
autocorrelation scores x to weights by the weight function
W(x, a, [3) :w. The higher the autocorrelation of the column in V
the lower the weight applied to it. The function is sigmoidal and
ranges from 0 to 1. Unbiased PCs will receive a weight of about 1.
We compute the down—weighted PC value matrix V"' from V by
V"': V X diag(w), with matrix diag(w) of size m X m with vector 5’
on the diagonal and 0 otherwise. We can build a new gene expres—
sion matrix X" : CV“ with matrix V" from which the biased prin—
cipal components are removed. The procedure is shown in
Supplementary Algorithm 2 and 3.

2.4 Reproducibility score

The LINCS data is organized in batches of replicate plates. There
are 2—5 plates in each batch in which the cell line, plate layout and
measurement time are identical. The LINCS data has no replicates
on the same plate, instead the whole plate is replicated. The repro—
ducibility score (RS) is a measure as to how similar replicates are
across the plates of a batch compared to all other perturbations.
Each well of a batch with N plates can be defined by i E {A, . . . ,P}
and [E {1,...,24} and plate index 17,]: E {1,...,N}. X is the
z—score normalized gene expression matrix of all samples in the
batch. Xi/k is the sample on plate [2 at well (i, i). We define the un—
normalized replicate score (RS "') as follows:

N
RS*(Xi/'k) : 2507(Xiieriip)/(N - 1) (4)
12%}:

To normalize RS" we build a null model for each individual sam—
ple of the batch. For this we select one sample from each of the other
plates and re—compute the average correlation. We calculate a set of
1000 random RS values and fit a normal distribution N (u, 02). The
normalized reproducibility score is calculated by RS : RS*/a. We
define ARS(X,X*) : RS(X") — RS(X) for uncorrected gene expres—
sion X and corrected gene expression X". Positive ARS mean
increased and negative decreased in reproducibility.

2.5 Removal of random principal components

We developed a naive method or removing random PC from the
data. For this, we apply the bias correction on all plates of all three
datasets (KD, OE and CPC). The naive method calculates the princi—
pal component decomposition X : UDVt for each plate analog to
our method. The singular values on the diagonal of D indicate the
amount of variance encoded in the PCs. We iteratively set a diagonal
entry of D to zero until we removed the same amount of variance
from the plate as the bias removal resulting in D". As not the exact
amount of variance can be removed unless we remove the same PCs
we allow an error of i e, for e : 0.005 of the total variance. Setting
entries of D to zero is identical as setting a column of V to zero.
XR : UD*Vt is the residual gene expression and we can compute
the reproducibility scores for all batches for X" and XR with
[var(X*) — var(XR)j/var(X) : +/ — e.

2.6 Gene set enrichment analysis

We performed Gene Set Enrichment Analysis (GSEA, (Subramanian
et (11., 2005)) between the values of each PC heavily affected by bias
in the LINCS dataset (weight 2 0.5) and all Gene Ontology (GO)
Biological Processes (GeneOntologyConsortium, 2013), as provided
by the MSigDB database (Liberzon et (11., 2011). P—values were cor—
rected according to the Benjamini—Hochberg procedure (Benjamini
and Hochberg, 1995). The normalized enrichment scores of the GO
terms were integrated using the Stouffer procedure (Stouffer et (11.,
1949), and the 50 terms showing the highest integrated enrichment
across the dataset are shown in Figure 4.

3 Results

3.1 Detection of spatial bias in gene expression
Consistent spatial bias affecting gene expression profiles was identi—
fied in 1825 out of 1894 (96%) of the tested microplates of the
LINCS dataset, as evident from observing landmark gene expression
profiles on a display structure that recreates the original microplate
sample positioning (Fig. 1). We could detect apparent effects on
gene expression that were dependent on the sample location on the
microplate, which supports the hypothesis that cells in the micro—
plate suffered from a non—controlled gradient of external perturb—
ation. Since the visual inspection of gene expression profiles offered
such a striking display of 2D bias, we measured its effects across the
dataset in terms of spatial autocorrelation. The observed autocorrel—
ation between samples in the LINCS dataset was significantly higher
than expected (Wilcoxon test P < 2.2 X 10‘”), indicating that the
location of a sample on a microplate partially determines the de—
tected transcript abundance of landmark genes (Fig. 2). This is evi—
dent in all the three experiment subsets (KD, OE, CPC). We then
applied Principal Component Analysis (PCA) on the entire dataset
and decomposed the gene expression into X : UDVt. We calculate
the autocorrelation for the columns of V analogue to the gene spatial
autocorrelation. We detected that most plates have Principal
Components (PCs) with significant autocorrelation. 2445 PCs were
detected with autocorrelation 2 0.5 (See Supplementary Methods
for further details).

3.2 Bias correction improves reproducibility score

We applied the bias correction on all KD, OE and CPC plates and
calculated RS before and after correction. Strict a values can al—
most entirely negate the bias from the transformed matrix
(Supplementary Fig. 2); however, we noticed that this has a nega—
tive impact on the experimental quality of the corrected data in
terms of agreement between biological replicates (Supplementary
Fig. 3). The KD subset achieved the best results with a more strin—
gent correction (a : 0.15) than the other two subsets (a : 0.35).
We then applied these a values to each LINCS subset and used
them to correct the entire data matrix to obtain a consistent reduc—
tion in spatial bias (Fig. 2). Globally, the dataset presented an aver—
age of 3.58 significantly biased PCs per plate with a weight 2 0.5
(i.e. removal of more than 50% of their contribution to gene ex—
pression). In terms of total variance, the autocorrelation bias ac—
counted for 22% of the gene expression variability observed in the
dataset. Removing spatial bias allowed us to significantly improve
the agreement between replicated conditions between plates. Our
procedure significantly improved the capability of clustering biolo—
gical replicates located on different microplates (ARS mostly posi—
tive, Wilcoxon Test p: 107100). We observed the highest ARS in
the KD subset (Fig. 3). Similar results were observed in the CPC

9103 ‘Org rsnﬁnv 110 seleﬁuv soc] ‘Btulomcg 30 AJtSJQAtuf] 112 /3.10'speu.rn0fp1q1x0"sothJJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

1962

A.Lachmann et aI.

 

TOP2A JUN

KDCUD5_PC3_QBH_X2 0.919

rial |s7aatailI?'Jldtntnlrlstam!12l?d?l

CPCDZU_VCAP_6H_X5 0.926

1aaAa:7aaraurzuursrnuraraaonuraal

{eager
_i
mt»:

Encaa

III I?
- EOEEOIOEEPE P11111111

‘ 111 El

HGF
KJIHGFEDCE.‘

PONML
bONML

 

l4R ITGBS

CPCDO4_HTZQ_BH_X4 0.929

12:1 an rIIoInIIuuumu'rlallmzlnzrr

KDCC102_PC3_96H_X2 0.92?

Ilrltal rIIImIIwuulsmwlllnmzlunx

‘1 G l' E D C E A

HGFEocan

J
J

K
K

. #4.
mm
In?“

111 PM

PONML
DONML

 

 

 

CDK4

CPCU16_HT29_6H_X5 0.91

1;;- :araorunuraumunrsranunnn

max exp va U9

NGFEOCBI‘

.r I

K

D O N NI L

 

USP1

CPCCIO§_PC:3_24H_X4 0.335

12:1 sataemunulllalblrlnllnzlnnn

relative expression value

K J

 

min exp va ue

D O N M L

 

Fig. 1. Spatial bias affecting gene expression levels. The heatmaps show the most affected genes in each of the six LINCS plates shown. The columns of the

plates are labeled from 1 to 24 and the rows from A to P. Plates contain 384 unique perturbations and no replicates. The color scale reflects the differential gene

expression (Duan et al., 2014). Grey wells marked with X are experiments for which no gene expression was available

1
I

 

kl)

KD CPC OE KD CPC OE
Random Observed Corrected

Autocorrelation Score

-1 4118 -{16 -0.4 -02 0 0.2 04 0.6 0.8
r

 

 

Fig. 2. Systematic spatial bias affecting the LINCS dataset. The violin plots
show the probability distribution for the autocorrelation score (Moran's I) of a
bias-free spatial location on a 24 X 16 microplate (Random, shown in blue);
for each the three uncorrected LINCS subsets (KD, CPC and DE, shown in
red); and for their corresponding corrected versions (shown in yellow). LINCS
subsets were corrected using 0' : 0.15 for KD experiments, and 0' : 0.35 for
CPC and OE experiments

subset (Supplementary Fig. 4) and in the OE subset
(Supplementary Fig. 5), however with weaker effects, possibly due
to these parts of the dataset generally being less responsive to per—
turbations (Supplementary Fig. 6). To test this hypothesis we com—
pared the strength of KD and OE perturbation with ARS. CPC
samples do not have a direct measure of perturbation effect. For
knockdown samples we show that the fold change of target genes
negatively correlates with RS while in OE the correlation is posi—
tive (Supplementary Materials). We used signature strength (abso—
lute sum of z—score values of a sample) and correlated it with ARS.
We could show a correlation between signature strength and ARS
in all three datasets (Supplementary Materials). In total, 85% of
the samples showing significant reproducibility before spatial bias
removal (see Supplementary Materials) had improved RS when
compared to the original expression matrix. In CPC, the average
improvement is not as drastic as in the other two subsets with indi—
vidual percentages of improved replicate scores at 89% for KD,
81% for OE, and 68% for CPC.

Removing spatially biased variance, as proposed, thus clearly im—
proves reproducibility; however, it could be argued that any method
that reduces data variance may produce similar results. Therefore, we
show that removal of random principal components has no positive
systematic effect on the reproducibility score. Specifically, we applied
a naive method based on the removal of non—statistically significant
principal components from the dataset. The autocorrelation based

910g ‘09 anﬁnv no sejeﬁuv $01 ‘Bttuomrzg JO KITSJQATII f] 112 /310'slcu1nofp103xo"sotJBurJOJutotq/ﬁduq 11101} pepBoIH/noq

Detection and removal of spatial bias

1963

 

PC3 MCFT

2o

      

at e.
1:
E’ 
a: .3:
"’. o s In 15 a! s o 5 m rs 2n 2.
Uncorrected RS Uncorrected RS
HA1 E m A375

15

Corrected Rs
1O

5

 

o 5 to 15 an n

5
Uncorrected RS Uncorrected RS

    

no 15 an 25

VCAP HT29

15

     
   

    

   
  

3 e E i
'U
s E 2
E“ E
8 a a "
. ﬂ 5
a o s to 15 "-' o 5 w is
Uncorrected RS Uncorrected RS
A549 HCCS1 5
111 g . . '
g m
E a E
1:: u e
t2 2
I)
r: E ..
a» a
a I o
O to 15 25 n I! 1‘0

 

s 1‘0 5 In
Uncorrected R5 Uncorrected RS

Fig. 3. Effect of spatial bias correction on the reproducibility score (RS). Scatter plot showing RS values before (X—axis) and after (y—axis) spatial bias correction for
the KD subset in 8 cell lines. The colors indicate a Gaussian kernel estimation for the joint probability density, from blue (low density) to red (high density). The di-

agonal line indicates the points where the correction had no effect in terms of RS

Table 1. Top 10 biased biological processes (mean autocorrelation)
across all plates in LINCS

 

 

Process name avg AC
Cation homeostasis 0.287
Cellular cation homeostasis 0.287
Chemical homeostasis 0.285
Nuclear organization and biogenesis 0.284
Apoptotic nuclear changes 0.284
Ion homeostasis 0.279
Cellular homeostasis 0.279
Energy derivation by oxidation of organic compounds 0.278
Coenzyme metabolic process 0.277
Homeostatic process 0.273

 

method significantly outperformed removal of equivalent amounts of
variance from gene expression data using principal components,
when tested for overall replicate agreement in the three datasets (KD,
OE and CPC) (Supplementary Fig. 7, Supplementary Algorithm 4).
The left three panels show the distribution of fractions # positive
ARS/# ARS over all batches. In OE and CPC the random removal of
PCs resulted in and average decrease of RS in all batches (fraction 3
0.5). In KD most batches also show a decrease in reproducibility after
correction, with only few plates showing a fraction of 2 0.5.

3.3 Biased biological processes

To test whether the bias in gene expression affects enrichment ana—
lysis we apply GSEA (Subramanian et 41]., 2005) on the individual
samples of a plate and calculate the autocorrelation of z—scores of
each biological process in MsigDB. After correction the autocorrel—
ation of enrichment scores is reduced in all three datasets. We calcu—
late enrichment scores over the landmark gene signatures for all
plates for 323 biological processes from MsigDB with at least 5
landmark genes and infer the autocorrelation score. Similar to the

Nuciear Org f Biogenesis AC: 0.84 Nuclear Org I Biogenesis AC: 0.15

    
    

KDAUOQ VCAF‘ 120H X2

+.+.. .43.
.._...,.,

CPC004  6H X4

H
+ - + 41+ ﬂ'e‘o'o’e‘r ‘ For:
uncorrected cerrected

low enrichment score high

Fig. 4. Enrichment of two commonly biased biological processes for two
example plates.+marked wells indicate significant up-regulation and -
significant down-regulation. The left shows enrichment z-scores for uncor-
rected and the right bias corrected plates. AC is the autocorrelation score for
the enrichment scores. Wells marked with X are experiments for which gene
expression was not available

biases observed in individual genes biological processes are biased
by plate location (Supplementary Fig. 8). Processes sorted by aver—
age autocorrelation score are shown in Table 1 (for a full list see
Supplementary Table 3). The processes are related to homeostasis
and apoptosis suggesting that cells in different plate locations

910g ‘09 isnﬁnv no sejeﬁuv s01 ‘Bnuomrzg JO KITSJQATII f] 112 /3.10'spzu.mofp10}xo'sopcurJOJutotq/ﬁduq 11101} pepBoIH/noq

1964

A.Lachmann et al.

 

encounter varying growth conditions resulting in gene expression
changes. As shown in Figure 4 the location of the sample on the
plate affects enrichment analysis. Significant down and upregulation
in uncorrected gene expression is linked to well coordinate. After
correction the biases are resolved. Negatively and positively en—
riched samples are not spatially separated and there are generally
fewer significant enrichments observed.

Finally, in order to get additional insights about the source of the
spatial bias, we performed the enrichment of functional gene sets on
the PCs significantly associated to the spatial bias (with a correction
weight 2 0.5) using Gene Set Enrichment Analysis. We noted a few
recurring Gene Ontology Biological Processes (GeneOntology
Consortium, 2013) that were significantly associated to the biased
components across the entire dataset (Fig. 5). Specifically we use the
columns of the coefficient matrix C from the singular value decompos—
ition as signatures for the enrichment analysis (see Supplementary
Methods). Although not extraordinarily significant (with adjusted
p—values reaching a minimum value 10‘7), the enriched components
seem to circumscribe the source of bias into two major groups inversely
correlated to each other and characterized by alterations in (i) cell pro—
liferation and (ii) ion channel activity. Furthermore, similar PCs could
be observed across distinct microplates and cell lines, indicating that
spatial bias affects similar biological processes across different plates
and cell lines.

HME
HCC515
PC3
VCAP
A35
H729
MCF!
A549

rRNA Processrrig

rRNA Metabolic Process

Ribusome Biogenesis Arid Assemm
RNA sokcngvre Transeslerrl'rcmen Reoclions
Historic mﬁcalhn

Establisl'irnenl Arid Or Mahlenrince oi Chroniam

RNA Spire-19
Protein Rm Complex Asseva

Coenzwriq Metabolic Process

Cotonou Melubdie Process

Proiein Catuboli: Process

Cellular Protein Comedic Process

Midear Eiioorl

Golgi \Ileside Transoorl

Translational mil-alien

Protein Felting

Phosphoi'ries'lide Biosynlheiic Process
Phosphorriosdltle Melttiolic Process
Mei-mane Lipid Biesynlneuc Process
Phosvhdlord Brosviilhetir: Process
Phosphate-d Mmzbotii: Process

Lipid Biosyrill'ieii'c Process

Prolel'r Modificatim by Snell Protein [20anma
Plotel'i Ubiqurlnalion

Lib-mm Cycle

Cellular Resp-mien

Mrlochomi'ion Organization And Biogeriesrs
Mr F r‘  w

Riboriudeooroterrl Complex Biogenesis Arid Assembly

 

Micromule Based Process

Regulelion oi Miiesis

Cell Cycle Checkpoint

DNA Deoenderrl DNA Replication

Mrlosrs

M Phase ol‘ Mitotic Cel Cycle

SerisonrI Perceulon 01 Chemical Sunni-s
Sirisory Perception 01me

Deteclim of Chemical StITiul’us

Cellular Defense Re

Detection of External Simulus
Detech of Simuhe

CAMP Mediated Signaling

G Fume-n Signaling Counted Io WP
mulenl Iriorgomc Canon Transom
Peinssium Inn Tim
Neuropeplide Signian Pallimy
Feedinu Beheriior

 

spouse
Detection of Slmuius Involved In Seventy Perception

4 Discussion

The overarching achievement of transcriptomics is the ability to ob—
tain large quantities of highly reliable gene expression data repre—
senting multiple cellular states. Thus, as dataset size increases with
microfluidic automation, computational approaches for data pro—
cessing are becoming more and more important. This study shows
that 2D spatial bias, likely associated with gradient driven differen—
tial conditions affecting the microﬂuidic setup, is a significant source
of error that can be effectively detected and corrected. Previous stud—
ies have dealt with similar problems in contexts other than that of
gene expression measurement; however, these studies simply eval—
uated the issue without proposing a solution (Harrison and
Hammock, 1988) or proposed a solution that involved changing the
design layout of the microplates (Liang et 41]., 2013). In other cases,
the systematic bias was observed in high—throughput screening tech—
nologies with a reduced set of experimental variables (Caraus et 41].,
2015). No method to our knowledge addresses the spatial bias prob—
lem in the context of multivariate assay scenarios, like the LINCS
dataset.

Therefore, we propose here a pure data—driven solution for multi—
variate gene expression datasets based on reducing the principal com—
ponents of the variance most associated with spatial bias. We
introduce a tunable parameter that can either be set a priori or can be
assessed to optimize biological replicate agreement in a large

Number of eieirioms: 22268 [in full list}, 1'4 {in element set]

I||l| ||

Ill Phase of Mitotic Cell Cycle

   
  

e E3 = case

0 NES = 5 ss
9 D-valus = 7.13435
3
i; Z
0
s
i N
= CI
Ill

q

CI

0 some romeo Isoeu 2mm
Sorted gene values in PC
° . 
i s — ——__
if g «N
G 5000 moon 15000 212000
Number of eieiriems: 22263 [In full list). 52 (In element eel]
Potassium Ion Transport
:3 = D ssr
NES = 4.29

  
  

p-Iralue = 1.60435

EnncnmenlSoore
DD 0.] 0.2 113 114 0.5

CI SODD IODDO lmﬂ ZDDOD
Sorted gone values in PC

'1 —‘—\—I_._
.3. s ——___
:v 9 EH
_'—‘—\—\_,__
E E a.“
q
I: soon moon 15000 zoom:

Fig. 5. Association between Gene Ontology Biological Processes (GO-BF) and the Principal Components capturing most of the spatial bias. (A) Heatmap showing
the enrichment in GO-BP gene sets (rows), expressed as relative normalized enrichment score (NES), for each of the 2,445 PCs (columns) most affected by spatial
bias (weight 2 0.5). Hierarchical clustering was performed using Euclidean distance and the Wards method. The eight cell lines included in the analysis are indi-
cated by the color scale on top of the heatmap. (B and C) Gene Set Enrichment Analysis for the most enriched GO-BP term in the upper cluster (B) and in the lower

cluster (C) in their respectively most co-segregating PCs

910g ‘09 isnﬁnv no sejeﬁuv s01 ‘Biiuomizg JO [firms/xiii f] 112 /810'slcumoip103xo"sotJBHIJOJutotq/ﬁduq 11101} pepBoIH/noq

Detection and removal of spatial bias

1965

 

multiplate assay. Our solution significantly improved replicate simi—
larity in the LINCS dataset, an effect that could not be achieved by
simply removing equivalent levels of global and non—specific variance
from gene expression profiles. The optimal parameters differed be—
tween specific portions of the LINCS dataset, but every subset ana—
lyzed benefited from the bias removal independently of the analyzed
cell line. In fact, these results strongly support the incorporation of
spatial bias analysis and removal as a critical step in the normalization
of all GE—HTS assays. While spatial bias can occur both before and
after cell lysis and nucleic acids extraction presence of spatial bias in
biological process enrichment values on most plates and consistent en—
richment of a reduced set of biological processes on the most biased
principal components suggests that part of such effects are originated
prior to cell lysis. Processes most strongly biased on average across all
plates in KD, OE, and CPC were associated to homeostasis and apop—
tosis. Our analysis of the principal component coefficients shows dif—
ferential cell proliferation associated exclusively with the sample
positioning on the microplates, a recurring effect that seems to be in—
dependent from the microplate or the cell line affected by the bias.
This difference in cell proliferation can be caused by differential
growth conditions of the plated cells, perhaps due to a gradient in the
evaporation of the medium partially connected to the parallel enrich—
ment of Potassium Channel activity (Abdul et al., 2002). No matter
how carefully monitored and executed, any GE—HTS experiment can
suffer from such operational bias issues. The proposed method allows
for the detection and correction of the most significant location—spe—
cific undesired perturbation effects, regardless of the experimental
stage at which they were introduced. Given that the LINCS dataset is
the first of its kind, such spatial bias in multivariate gene expression
data has never been observed at this scale before. Our method is simi—
lar to PCA—based noise removal techniques (Thomas et al., 2002)
since it operates on the Principal Component space in order to im—
prove the measurement reliability. However, while previous methods
remove the low variance components to reduce random noise
(Liebermeister, 2002), our method is the first that specifically captures
location—dependent effects, and decreases their contribution to the
corrected dataset.

Acknowledgements

We thank Kristin M. Beiswenger and Mahalaxmi Aburi for the help during
manuscript preparation.

Funding

This work was supported by the LINCS grant for designing new computa-
tional tools.

Conﬂict of Interest: none declared.

References

Abdul,M. et al. (2002) Activity of potassium channel—blockers in breast can—
cer. Anticancer Res, 23, 3347—3351.

Alter,O. et al. (2000) Singular value decomposition for genome—wide expres-
sion data processing and modeling. Proc. Natl. Acad. Sci., 97,
10101—10106.

Barrett,T. et al. (2013) Ncbi geo: archive for functional genomics data sets up—
date. Nucleic Acids Res, 41, D991—D995.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. I. Royal Stat. Soc. B
(Methodological), 289—300.

Caraus, I. et al. (2015) Detecting and overcoming systematic bias in high—
throughput screening technologies: a comprehensive review of practical
issues and methodological solutions. BriefBioinform., 16, 974—986.

Dale,M.R. and Fortin,M.I. (2002) Spatial autocorrelation and statistical tests
in ecology. Ecoscience, 162—167.

Derks,S. and Diosdado,B. (2015) Personalized cancer medicine: next steps in
the genomic era. Cell. Oncol., 38, 1—2.

Duan,Q. et al. (2014) Lincs canvas browser: interactive web app to query,
browse and interrogate lincs 11000 gene expression signatures. Nucleic
Acids Res, 42, W449—W460.

Fehrmann,R.S. et al. (2015) Gene expression analysis identiﬁes global gene
dosage sensitivity in cancer. Nat. Genet, 47, 115—125.

GeneOntologyConsortium (2013) Gene ontology annotations and resources.
Nucleic Acids Res, 41, D530—D535.

Golub,G.H. and Reinsch,C. (1970) Singular value decomposition and least
squares solutions. Numerische Mathematik, 14, 403—420.

Hansey,C.N. et al. (2012) Maize (zea mays l.) genome diversity as revealed by
rna-sequencing. PLoS One, 7, e33071.

Harrison,R.O. and Hammock,B.D. (1988) Location dependent biases in auto-
matic 96-well microplate readers. I. Assoc. Off. Anal. Chem, 71, 981—987.

Hertzberg,R.P. and Pope,A.I. (2000) High—throughput screening: new tech—
nology for the let century. Curr. Opin. Chem. Biol., 4, 445—451.

Ienkins,S.L. and Ma’ayan,A. (2013) Systems pharmacology meets predictive,
preventive, personalized and participatory medicine. Pharmacogenomics,
14,119.

Kunkel,S.D. et al. (2012) Ursolic acid increases skeletal muscle and brown fat
and decreases diet-induced obesity, glucose intolerance and fatty liver dis-
ease. PloS One, 7, e39332.

Lamb,I. et al. (2006) The connectivity map: using gene-expression signatures
to connect small molecules, genes, and disease. Science, 313, 1929—1935.
Liang,Y. et al. (2013) Correction of microplate location effects improves per—

formance of the thrombin generation test. Thrombosis I., 11, 12.

Liberzon,A. et al. (2011) Molecular signatures database (msigdb) 3.0.
Bioinformatics, 27, 173 9—1740.

Liebermeister,W. (2002) Linear modes of gene expression determined by inde—
pendent component analysis. Bioinformatics, 18, 51—60.

Liu, C. et al. (2015) Compound signature detection on lincs 11000 big data.
Mol. BioSyst., 11, 714—722.

Ma’ayan,A. et al. (2014) Lean big data integration in systems biology and sys—
tems pharmacology. Trends Pharmacol. Sci., 35, 450—460.

Montgomery,S.B. and Dermitzakis,E.T. (2011) From expression qtls to per—
sonalized transcriptomics. Nat. Rev. Genet., 12, 277—282.

Moran,P.A. (1950) Notes on continuous stochastic phenomena. Biometrika,
17—23.

Smyth,G.K. and Speed,T. (2003) Normalization of cdna microarray data.
Methods, 31, 265—273.

Stegmaier,K. et al. (2004) Gene expression based high—throughput screening
(ge—hts) and application to leukemia differentiation. Nat. Genetics, 36,
25 7—263.

Stouffer,S.A. et al. (1949). The American soldier: adjustment during army life.

Subramanian,A. et al. (2005 ) Gene set enrichment analysis: a knowledge-
based approach for interpreting genome—wide expression proﬁles. Proc.
Natl. Acad. Sci. USA, 102, 15545—15550.

Thomas,C.G. et al. (2002) Noise reduction in bold—based fmri using compo-
nent analysis. Neuroimage, 17, 1521—1537.

Vempati,U.D. et al. (2014) Metadata standard and data exchange speciﬁca—
tions to describe, model, and integrate complex and diverse high—throughput
screening data from the library of integrated network-based cellular signa-
tures (lincs). I. Biomol. Screen., 19, 803—816.

Wang,Z. et al. (2009) Rna-seq: a revolutionary tool for transcriptomics. Nat.
Rev. Genetics, 10, 57—63.

Westermann,A.I. et al. (2012) Dual rna-seq of pathogen and host. Nat. Rev.
Microbiol, 10, 618—630.

Wu,Z. et al. (2004) A model-based background adjustment for oligonucleo-
tide expression arrays. I. Am. Stat. Assoc., 99, 909—917.

9103 05 isnﬁnv uo so1e§uv soc} ‘BIIIJOJIIBD JO AJISJQAiuf] 112 IBJO'SIBHJnOprOJXO'SOIJBLUJOJIIIth/Iiduq 11101} popco1umoq

