BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

A.C.MI'1'IIer and A.Bockmayr

 

(Beard et al., 2002; Qian and Beard, 2005), extending the stand—
ard non—negativity constraints for thermodynamic irreversibility
of individual reactions. It has been shown that the flux values
computed with thermodynamic constraints are more consistent,
for example, with respect to gene expression data (Feist et al.,
2007; Fleming et al., 2009; Jol et al., 2012; Price et al., 2006;
Schellenberger et al., 2011a). In recent years, there has been
increasing interest in thermodynamic constraints, as they can
also be used to link metabolite concentrations to flux modes
(Henry et al., 2006; Hoppe et al., 2007; Kilmmel et al., 2006a,
b; Singh et al., 2011).

In this article, we present a new method for efﬁcient thermo—
dynamically constrained FBA and FVA. We will work with the
relaxed form of thermodynamic constraints, as it was introduced
by Beard et al. (2004). There, thermodynamic constraints are
formulated as follows:

SJ 2 0 steady—state assumption (1)

Z 3 J g u ﬂux bounds, e.g. irrev. (2)

AmJi<0 V J ,~ 2 0 Vi e I thermodynamic constraint (3)

AMT 2 “TS; potential differences (4)

JERR, MEIRM, AMERI

Here S denotes the stoichiometric matrix, J the ﬂux vector, M
the set of metabolites, R the set of all reactions, 8 the set of
exchange reactions, I = R \ S the set of internal reactions and
a the chemical potential of each metabolite (Gibbs free energy of
formation). The operator -T denotes transposition. If the concen—
trations and equilibrium constants are known (Jankowski et al.,
2008; Mavrovouniotis, 1990; Noor et al., 2012a), it is possible to
further constrain [,L. However, because this information is often
not available, we will work here without additional constraints
on a.

In a thermodynamically constrained ﬂux balance problem, we
maximize a linear objective function cTJ, where c 6 RR, with re—
spect to the constraints (1}(4). In thermodynamically constrained
ﬂux variability analysis ( tF VA ), we analyse the ﬂux variability
within the feasible (respectively optimal) solutions of a thermo—
dynamically constrained ﬂux balance problem, i.e. for all i e R,
we solve the optimization problems max{:I:J,~|(1)—(4)} (respect—
ively max{:|:J,~|(1)—(4), cTJ = opt}).

To simplify notation, we do not only use reactions as indices
(e.g. J,- to denote ﬂux through reaction i) but also sets of reac—
tions to index sub—vectors. For example, J1 denotes the ﬂux
vector on the internal reactions only and SI contains only the
columns corresponding to internal reactions.

DEFINITION 1 (Thermodynamically Feasible Flux). A ﬂux
vector J is called thermodynamically feasible if there exists a
vector a such that (I), (3) and ( 4 ) are satisfied. If additionally
(2 ) holds, J will be called a thermodynamically feasible ﬂux that
satisﬁes bounds Z and 14.

By multiplying MT from the left side with S1, the
potential differences for internal reactions are obtained. This is

equivalent to the often found formulation KA/z = 0, where K is
the null—space matrix of S1. The motivation behind Equation (3)
is that normally a chemical reaction carries ﬂux if and only if it
reduces Gibbs free energy (Alberty, 2003; Beard et al., 2002;
Qian and Beard, 2005). Since many reactions are catalysed by
enzymes, however, it can happen that an enzyme is not present,
for example because of regulatory control and hence,
the corresponding reaction is not possible and does not carry
flux, even if there is a negative potential difference. Thus,
zero ﬂux in Equation (3) is always allowed as well. Note that
other formulations of thermodynamic constraints, for
example the one used by Fleming et al. (2012), do not have
this property. Hence, the different results have to be applied
with care.

Using Boolean variables a e {0,1}I, a sufﬁciently large con—
stant M >0 and a small constant s>0, this formulation can be
translated into a mixed integer linear program (MILP), where
a,~ = 0 indicates that a forward flux J,~>0 on reaction i is not
allowed, and a,~ = 1 forbids a backward ﬂux J,~<0. This is done
by replacing (3) with the inequalities (5) and (6):

SJ=0

ZfSJfSu,‘

[,(l — (If) E J,' E Midi Vi E I 
—Ma,~+8§A/z,~§M(l—a,~)—8Viel (6)
AMT: MS:

JERR,/LEIRM, Alrele,ae{0,1}I

This formulation is used in a similar form by Schellenberger et al.
(2011a) for the COBRA toolbox and many others (Beard et al.,
2004; Cogne et al., 2011; Henry et al., 2007; Hoppe et al., 2007).
It can be shown that if S does not contain any zero—columns,
this MILP formulation is equivalent to the original one
(Muller, 2012). Although solving MILPs is NP—hard in general,
practical tests have shown that current MILP solvers are able
to optimize ﬂux with respect to the above formulation also on
genome—scale networks like the iAF1260 reconstruction
of Escherichia coli (Schellenberger et al., 2011a).

Beard et al. (2004) observed that a steady—state ﬂux
vector J [i.e. which satisﬁes Equation (1)] is thermodynamically
feasible if and only if there is no internal cycle contained by
J. A sketch of the proof using oriented matroids can be found
in (Beard et al., 2004). A detailed version using LP—duality is
available in Muller (2012) and was also recently published by
Noor et al. (2012b). This result is used by Yang et al. (2005) to
detect reactions that are irreversible due to thermodynamic
constraints. In particular, one of their methods simply runs
tFVA.

This article is organized as follows: In Section 2.1, we show
that the thermodynamically constrained flux balance problem is
NP—complete, and thus, MILP is an appropriate tool. In Section
2.2, we derive a tractability result and analyse how much this
applies to current genome—scale models. These theoretical results

 

904

ﬁm'spzumofpmﬂo'sopeuuoonIq/ﬁdnq

Fast-tFVA

 

are the backbone of a new algorithm, which is described in
Section 3. In Section 4, we apply our new method to study the
importance of thermodynamic constraints in the analysis of
genome—scale metabolic networks.

2 METHODS
2.1 NP-completeness

In FVA, a series of optimization problems are solved. The ﬂux through
each reaction in the network is maximized and minimized. In the follow-
ing, we will see that already determining whether there exists a positive
ﬂux through a given reaction is NP-complete. Thus, the optimization
problem is NP-hard, and it is unlikely that an efﬁcient algorithm exists
for the general case.

Problem 1 (THERMOFLUX).

o Instance:

0 Metabolic network N = (M, R = 105, S E @MXR)

0 Objective reaction r e R

0 Question: Does a thermodynamically feasible ﬂux J 2 0 with Jr>0
exist?

THEOREM 1. THERMOFLUX is NP—complete.

The proof of this result can be found in the Supplementary Material.

2.2 Tractability

It was observed early on by Price et al. (2002) that a thermo-
dynamically infeasible ﬁux can be turned feasible by removing
internal cycles. For the following tractability result, it is important to
understand when these internal cycles can be removed without
changing the ﬂux through the objective reactions. Reactions that are
contained in internal cycles and reactions that are ﬂux-forcing are
problematic.

DEFINITION 2. Let N: (M, R =IU8, S e IRMXR) be a
metabolic network. A reaction r e R is contained in an internal
cycle ifthere exists a J 6 IR: with SIJ = 0 and J,.>0.

Given lower and upper ﬂux bounds Z, u 6 RR, a reaction r is
called ﬂux—forcing if £,.>0 or u,.<0.

For a linear objective function c 6 RR, a reaction r is called
objective if c,. 75 0.

THEOREM 2. Let/V = (M, R = IUS, S e IRMXR) be a meta—
bolic network with lower and upper ﬂux bounds [,u 6 RR and
a linear objective function c 6 RR. Let C Q I be the set of reac—
tions contained in internal cycles, let F E R be the set of reactions
that are ﬂux—forcing and let 0 Q R be the set of objective
reactions.

Given a steady—state ﬁux J with Z 3 J g u, a thermodynamic—
ally feasible ﬂux J* with cTJ = cTJ* and Z 3 J* g u can be com—
puted in polynomial time w.r.t. the size of the network N if
C n (F U 0) = (Z).

The key to the proof of Theorem 2 is Algorithm 1, which gives the
wanted polynomial-time algorithm. The complete proof can be found in
the Supplementary Material.

 

Algorithm 1: This algorithm computes a thermodynamically feasible ﬂux
out of a possibly thermodynamically infeasible ﬂux, if the conditions of
Theorem 2 are satisﬁed. It runs in polynomial time. (1] denotes a vector
where all entries are 1.)

 

Input: A steady-state ﬂux J
repeat
1+:={ieI:J,»ZO}
I’:={ieI:Ji50}

llL1+ —llL17 : SIL=0,
L := argmax J], 5 L1, 5 0,
JIIZJI—L J1+ZL1+ZO
until llL1+ — 11L], 2 0
return J

 

It should be noticed that this theorem is similar to the result by
Fleming et al. (2012). Although these authors use a different deﬁnition
of thermodynamic feasibility, they also propose a method that keeps the
ﬂux through exchange reactions invariant.

Since we can compute optimal steady-state ﬂuxes in polynomial time
by solving an LP, it follows that we can compute an optimal thermo-
dynamically feasible ﬂux in polynomial time, if all of the reactions con-
tained in internal cycles are neither ﬂux-forcing nor contained in the
objective function. In practice, however, there will be reactions contained
in internal cycles, and we have also to consider this case.

For the following result, we need to quantify how often a reaction is
contained in internal cycles. For this, it comes in very handy that internal
cycles are simply steady-state ﬂux vectors that do not use exchange
reactions. Hence, we can describe the space of all internal cycles by
elementary ﬂux modes (Schuster and Hilgetag, 1994; Schuster et al.,
2000). The elementary ﬂux modes that do not contain exchange reactions
will be called internal circuits or simply circuits. They may also be
interpreted in terms of oriented matroid theory, which was introduced
into metabolic network analysis by Oliveira et al. (2001) and used by
Beard et al. (2004) to describe the internal circuits. The number of in-
ternal circuits containing the given reaction will be the quantiﬁcation
measure.

We observed that the number of internal circuits is small for many
genome-scale networks. See the Supplementary Materials for more
details.

THEOREM 3. If the number of internal circuits containing ﬂux—
forcing or objective reactions is bounded by a constant, the thermo—
dynamically constrained ﬂux balance ( and ﬂux variability ) problem
can be solved in polynomial time w.r.t. the size of the network.

PROOF. Let F resp. 0 denote again the set of ﬂux—forcing
resp. objective reactions. Let C be the set of internal circuits
that contain a reaction of F U 0.

We know that the optimal thermodynamically feasible solution
must not contain any internal circuits. Hence, in every internal
circuit C e C, we can find a reaction that does not carry any ﬂux
in the direction of the circuit. Any such set of reaction/circuit
direction pairs will be called a blocking set B C R X {—, +} (cf.
Figs 1 and 2). We can enforce such a blocking set by adding sign
constraints to the reactions in B, i.e. if (r, +) e B, we add J,. g 0
to the problem and if (r, —) e B, we add J,. 2 0.

It follows that after we enforced a blocking set, there exist no
internal circuits that contain reactions of F U 0 anymore. Hence,
by Theorem 2 we can use linear programming to solve the
thermodynamically constrained ﬂux balance problem.

 

905

ﬁm'spzumofpmjxo'sopeuuqquIq/ﬁdnq

 

55,2\Ewogmoddmmowoio~&o:~=£¢o~m\

55,2kgogmoddmmowoio~&o:~=£¢o~m\

 

an?kgogmomammowoio~&o:3m7.omm\

 

Fast-tFVA

 

Our current algorithm works without additional information
on metabolite concentrations. However, in more and more cases,
such information becomes available. In future work, we plan to
extend our method by incorporating metabolite concentrations
and other experimental data (Kummel et al., 2006a; Pey et al.,
2011; Shinar and Feinberg, 2010).

Funding: This work was supported by Berlin Mathematical
School (in terms of a PhD stipend).

Conﬂicts of Interest: none declared.

REFERENCES

Achterberg,T. (2009) SCIP: Solving constraint integer programs. Math. Program.
Compul, l, 1411.

Alberty,R.A. (2003) Thermodynamics of Biochemcal Reactions. Massachusetts
Institute of Technology, Cambridge, MA.

Beard,D.A. et al. (2002) Energy balance for analysis of complex metabolic net—
works. Biophys. J., 83, 79786.

Beard,D.A. et al. (2004) Thermodynamic constraints for biochemical networks.
J. Theor. Biol, 228, 3277333.

Bilu,Y. et al. (2006) Conservation of expression and sequence of metabolic genes is
reﬂected by activity across metabolic states. PLoS Comput. Biol, 2, e106.

Bradley,S.P. et al. (1977) Applied Mathematical Programming. Addison—Wesley
Publishing Company, Reading, MA, pp. 46, 186, chap 2.2, 5.3.

Burgard,A.P. et al. (2001) Minimal reaction sets for Escherichia coli metabolism
under different growth requirements and uptake environments. Biotechnol.
Prog., 17, 7917797.

Burgard,A.P. et al. (2004) Flux coupling analysis of genome—scale metabolic net—
work reconstructions. Genome Res., 14, 3017312.

Cogne,G. et al. (2011) A model—based method for investigating bioenergetic pro—
cesses in autotrophically growing eukaryotic microalgae: application to the
green algae Chlamydomonas rein/tardtii. Biotechnol. Prog., 27, 631$40.

Driouch,H. et al. (2012) Integration of in vivo and in silico metabolic fluxes for
improvement of recombinant protein production. Metab. Eng., 14, 4758.

Durot,M. et al. (2009) Genome—scale models of bacterial metabolism: reconstruc—
tion and applications. FEMS Microbiol Rev., 33, 1647190.

Edwards,J.S. et al. (2001) In silico predictions of Escherichia coli metabolic capabil—
ities are consistent with experimental data. Nat. Biotechnol, 19, 1257130.

Feist,A.M. et al. (2007) A genome—scale metabolic reconstruction for Escherichia
coli K—12 MG1655 that accounts for 1260 ORFs and thermodynamic informa—
tion. Mol Syst. Biol, 3, 121.

Fleming,R. et al. (2009) Quantitative assignment of reaction directionality in
constraint—based models of metabolism: application to Escherichia coli.
Biophys. Chem., 145, 47756.

Fleming,R.M. et al. (2012) A variational principle for computing nonequilibrium
ﬂuxes and potentials in genome—scale biochemical networks. J. Theor. Biol, 292,
71777.

Gudmundsson,S. and Thiele,I. (2010) Computationally efﬁcient ﬂux variability ana—
lysis. BMC Bioinformatics, 11, 489.

Hadicke,O. et al. (2011) Metabolic network modeling of redox balancing and bio—
hydrogen production in purple nonsulfur bacteria. BMC Syst. Biol, 5, 150.
Haus,U.—U. et al. (2008) Computing knock—out strategies in metabolic networks.

J Comput. Biol, 15, 2597268.

Henry,C. et al. (2006) Genome—scale thermodynamic analysis of Escherichia coli
metabolism. Biophys. J., 90, 145371461.

Henry,C.S. et al. (2007) Thermodynamics—based metabolic ﬂux analysis. Biophvs. J.,
92, 179271805.

Hoppe,A. et al. (2007) Including metabolite concentrations into ﬂux balance ana—
lysis: thermodynamic realizability as a constraint on ﬂux distributions in meta—
bolic networks. BMC Svst. Biol, 1, 23.

Jankowski,M.D. et al. (2008) Group contribution method for thermodynamic ana—
lysis of complex metabolic networks. Biophys. J., 95, 148771499.

Jol,S.J. et al. (2012) System—level insights into yeast metabolism by thermodynamic
analysis of elementary ﬂux modes. PLoS Comput. Biol, 8, 3.

Kaleta,C. et al. (2009) Can the whole be less than the sum of its parts? Pathway
analysis in genome—scale metabolic networks using elementary ﬂux patterns.
Genome Res., 19, 187271883.

Khannapho,C. et al. (2008) Selection of objective function in genome scale ﬂux
balance analysis for process feed development in antibiotic production.
Metab. Eng., 10, 2277233.

Kummel,A. et al. (2006a) Putative regulatory sites unraveled by network—embedded
thermodynamic analysis of metabolome data. Mol Syst. Biol, 2, 2006.0034.

Kummel,A. et al. (2006b) Systematic assignment of thermodynamic constraints in
metabolic network models. BMC Bioinformatics, 7, 512.

Mahadevan,R. and Schilling,C. (2003) The effects of alternate optimal solutions in
constraint—based genome—scale metabolic models. Metab. Eng., 5, 26¢276.
Mavrovouniotis,M.L. (1990) Group contributions for estimating standard Gibbs
energies of formation of biochemical compounds in aqueous solution.

Biotechnol. Bioeng., 36, 107(F1082.

Muller,A. (2012) Thermodynamic Constraints in Metabolic Networks. Master's
Thesis. Fachbereich Mathematik und Informatik, Freie Universitat Berlin,
Berlin.

Noor,E. et al. (2012a) An integrated open framework for thermodynamics of reac—
tions that combines accuracy and coverage. Bioinformatics, 28, 203772044.
Noor,E. et al. (2012b) A proof for loop—law constraints in stoichiometric metabolic

networks. BMC Svst. Biol, 6, 140.

Oliveira,J.S. (2001) An algebraic—combinatorial model for the identiﬁcation and
mapping of biochemical pathways. Bull Math. Biol, 63, 116371196.

Orman,M.A. et al. (2012) Metabolic network analysis of perfused livers under fed
and fasted states: incorporating thermodynamic and futile—cycle—associated regu—
latory constraints. J. Theor. Biol, 293, 1017110.

Orth,J.D. et al. (2010) What is ﬂux balance analysis. Nat. Biotechnol, 28, 2457248.

Pey,J. et al. (2011) Do elementary ﬂux modes combine linearly at the “atomic”
level? integrating tracer—based metabolomics data and elementary ﬂux modes.
Biosystems‘, 105, 1407146.

Price,N.D. et al. (2002) Extreme pathways and Kirchhost second law. Biophys. J.,
83, 287%2882.

Price,N.D. et al. (2004) Genome—scale models of microbial cells: evaluating the
consequences of constraints. Nat. Rev. Microbiol, 2, 88(r897.

Price,N.D. et al. (2006) Candidate states of Helicobacter pylori 's genome—scale meta—
bolic network upon application of “loop law" thermodynamic constraints.
Biophys. J., 90, 391973928.

Qian,H. and Beard,D.A. (2005) Thermodynamics of stoichiometric biochemical
networks in living systems far from equilibrium. Biophys. Chem., 114, 2137220.

Schellenberger,J. and Palsson,B.O. (2009) Use of randomized sampling for analysis
of metabolic networks. J Biol. Chem, 284, 54575461.

Schellenberger,J. et al. (2011a) Elimination of thermodynamically infeasible loops in
steady—state metabolic models. Biophys. J., 100, 5447553.

Schellenberger,J. et al. (2011b) Quantitative prediction of cellular metabolism
with constraint—based models: the COBRA toolbox v2.0. Nat. Protoc., 6,
129(k1307.

Schilling,C.H. et al. (2000) Theory for the systemic deﬁnition of metabolic pathways
and their use in interpreting metabolic function form a pathway—oriented per—
spective. J. Theor. Biol, 203, 2297248.

Schuster,S. and Hilgetag,C. (1994) On elementary ﬂux modes in biochemical
systems at steady state. J. Biol. Syst., 2, 1657182.

Schuster,S. et al. (2000) A general deﬁnition of metabolic pathways useful for sys—
tematic organization and analysis of complex metabolic networks. Nat.
Biotechnol, 18, 3267332.

Schuster,S. et al. (2007) Is maximization of molar yield in metabolic networks fa—
voured by evolution? J. Theor. Biol, 252, 4977504.

Schwartz,J.—M. and Kanehisa,M. (2006) Quantitative elementary mode analysis of
metabolic pathways: the example of yeast glycolysis. BMC Bioinformatics, 7,
186.

Shinar,G. and Feinberg,M. (2010) Structural sources of robustness in biochemical
reaction networks. Science, 327, 138971391.

Singh,A. et al. (2011) Manipulating redox and atp balancing for improved produc—
tion of succinate in E.coli. Metab. Eng., 13, 7&8].

Terzer,M. et al. (2009) Genome—scale metabolic networks. Wiley Interdiscip. Rev.
Syst. Biol. Meal, 1, 2857297.

Teusink,B. et al. (2009) Understanding the adaptive growth strategy of Lactobacillus
plantarum by in silico optimisation. PLoS Comput. Biol, 5, e1000410.

Varma,A. and Palsson,B.O. (1994) Metabolic ﬂux balancing: basic concepts, scien—
tiﬁc and practical use. Nat. Biotechnol, 12, 99¢998.

Wolsey,L.A. (1998) Integer Programming. Wiley—Interscience Series in Discrete
Mathematics. John Wiley & Sons, New York, NY.

Yang,F. et al. (2005) Ab initio predicition of thermodynamically feasible reaction
directions from biochemical network stroichiometry. Metab. Eng., 7, 2517259.

 

909

ﬁm'spzumofpmjxo'sopeuuqurorq/ﬁdnq

