APPLICATIONS NOTE V°" 232%.lﬁgi‘iliéiﬁéﬁaﬁféiﬁiéi

 

Genetics and population analysis

Advance Access publication April 14, 2014

R PheWAS: data analysis and plotting tools for phenome-wide
association studies in the R environment

Robert J. Carroll”, Lisa Bastarache1 and Joshua C. Denny1 '2
1Department of Biomedical Informatics and 2Department of Medicine, Vanderbilt University School of Medicine,

Nashville, TN 37212, USA
Associate Editor: Jeffrey Barrett

 

ABSTRACT

Summary: Phenome-wide association studies (PheWAS) have been
used to replicate known genetic associations and discover new
phenotype associations for genetic variants. This PheWAS implemen-
tation allows users to translate ICD-9 codes to PheWAS case and
control groups, perform analyses using these and/or other phenotypes
with covariate adjustments and plot the results. We demonstrate the
methods by replicating a PheWAS on r33135388 (near HLA-DRB,
associated with multiple sclerosis) and performing a novel PheWAS
using an individual’s maximum white blood cell count (WBC) as a
continuous measure. Our results for r53135388 replicate known asso-
ciations with more significant results than the original study on the
same dataset. Our PheWAS of WBC found expected results, including
associations with infections, myeloproliferative diseases and asso-
ciated conditions, such as anemia. These results demonstrate the
performance of the improved classification scheme and the flexibility
of PheWAS encapsulated in this package.

Availability and implementation: This R package is freely available
under the Gnu Public License (GPL-3) from http://phewascatalog.org.
It is implemented in native R and is platform independent.

Contact: phewas@vanderbilt.edu

Supplementary information: Supplementary data are available at
Bioinfonnatics online.

Received on November 12, 2013; revised on April 3, 2014; accepted
on April 9, 2014

1 INTRODUCTION

Genome-wide association studies (GWAS) have been an import-
ant research method for the past 10 years. These studies typically
take the form of a case-control study where many genotypes are
analyzed with a speciﬁc phenotype. Many software packages,
such as Plink and SNPTEST, have been developed to support
GWAS (Marchini et al., 2007; Purcell et al., 2007).

More recently, phenome-wide association studies (PheWAS)
have been used to interrogate with which phenotypes a given
genetic variant may be associated (Denny et al., 2010).
PheWAS was originally described within an electronic medical
record (EMR) cohort, and EMR-based PheWAS have been re-
cently shown to replicate 66% of sufﬁciently powered known
associations across many disease domains as well as discover
new associations (Denny et al., 2013). PheWAS methods have
been applied to research cohorts as well, successfully replicating

 

*To whom correspondence should be addressed.

many known associations and finding potential novel associ-
ations (Pendergrass et al., 2013). Visualization software has
also been developed to help present and investigate PheWAS
results (Pendergrass et al., 2012). Focused on evaluating many
phenotypes for a given set of genotypes, PheWAS methods do
not translate well to traditional GWAS software, which typically
follows a one phenotype, many genotypes paradigm. Although it
is possible to perform analyses using existing software packages,
it requires scripting many runs of the software. To foster adop-
tion of PheWAS, we developed an R implementation of the most
common functionality needed to perform and Visualize
EMR-based PheWAS. This R package follows the methods
detailed in Denny et a]. (2013), but has been designed to use
either genetic or non-genetic data as the independent variable.

2 METHODS

2.1 Data input

Data to perform a PheWAS using this package can include, for a popu-
lation, the following: demographic data, International Classiﬁcation of
Disease codes diagnostic code data, the independent variables (e.g. geno-
type or laboratory data) and any other covariates, such as principal
components generated to adjust for genetic ancestry. Users can pass
into the phewas method any data types R supports for regression.
Although the original PheWAS study used genetic data as predictors,
studies using phenotypes as predictors are also feasible in this framework.

2.2 Mapping phenotypes

Investigators can perform a PheWAS using ICD-9 codes or ‘PheWAS
codes’, which represent ~1600 hierarchical phenotypes formed from
grouped ICD-9 codes. Each PheWAS phenotype also includes an
optional set of exclusion phenotypes for similar diagnoses to more accur-
ately identify true controls. This step prevents patients with common ‘rule
out’ codes or similar diseases from being marked as a control during the
statistical analysis (e.g. a patient with an unknown arrhythmia cannot
serve as a control for atrial ﬁbrillation). As requiring multiple codes
occurring on different days for a given diagnosis improves phenotype
precision, users can specify count thresholds required to establish a
patient as a ‘case’ for a given phenotype or simply use the code count
in the regression model. This threshold is often set to a minimum of two
unique code days (Denny et al., 2013).

2.3 Statistical analysis

Users can choose among different statistical tests when performing a
PheWAS, including adjusted and unadjusted models. The default ana-
lyses are linear or logistic regression. X2 and t-tests are available for fast
unadjusted tests. P-values, betas, case and control counts and odds ratios

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 2375

112 /310's112u1n0fp10}x0"sotwuiJOJutotq/ﬁduq 11101} papBOIIIAAOG

91oz ‘Og isanV uo ::

R.J. Carroll et al.

 

assume
mm is
. Multiple 9 a

  
 

40min]
5. u. o u a.

n—Mu

tion

. oi conmma ion

3 1 dw'n‘iﬁijd‘ . Hypoiefﬁ
C C

   
 
 

a. r «s;  a» “a “r “is 13"» ittl‘iié'ft
“same ﬁgﬁs‘qﬁg 30% “ﬂat as °%%"cio% :11;
a

Fig. 1. PheWAS Manhattan plot for rs3135388, with phenotypes ordered
by PheWAS code

(OR; if applicable) are reported. Hardineinberg Equilibrium values
and allele frequencies are reported if additive allele counts are supplied.

Meta-analysis of results is included using the meta package. Users can
request several statistical signiﬁcance thresholds: an uncorrected P-value,
Bonferroni correction, false discovery rate or an adaptation of the
SimpleM method. Parallelization is available with the snowfall package.

2.4 Plotting methods

The package’s phewasManhattan function allows for creation of
PheWAS ‘Manhattan’ plots (Figs 1 and 2) with many options for
customization, including labeling points, deﬁning sort order and
groupings, P-value threshold lines and color maps. Descriptions and
groupings are provided for the PheWAS phenotype codes. The plots
are generated using ggplot2 and can be altered after they are generated.
Plotting functions can also plot P-values from other association studies or
data not P-value based, such as ICD9 or PheWAS code counts. Users can
also vary point size by OR, as in Figure 3 of Denny et a]. (2011). An R
Shiny interface for the phewasManhattan plotting method is included.

2.5 Example applications of the PheWAS package

To show the functionality of this package, we repeated one of the original
PheWAS analyses for rs3135388, which is highly correlated with HLA-
DRBI*1501 and associated with multiple sclerosis with an OR of 2.24
and a P-value of 2.8 x 1076. For this example, we analyzed the same 6005
individuals and data included in the original analysis (Denny et al., 2010).
We performed logistic regression, adjusting for age and gender as covari-
ates, and used the current PheWAS hierarchy (Denny et al., 2013) with all
PheWAS codes occurring in :20 individuals (n = 1127 PheWAS codes).
This is an improvement over the previous analysis that included 733
phenotypes and used a X2 test. The second example applied linear regres-
sion to PheWAS codes adjusted for age and gender to predict maximum
white blood cell count (WBC) in the same population.

3 RESULTS AND DISCUSSION

We found an association between multiple sclerosis and
rs3135388 with an OR of 2.56 and P—Value of 1.4 x10—7
(Fig. 1). The improved methods, including a covariate-adjusted
analysis and revised phenotypes, yielded an OR more consistent
with the largest published study on this association, which re-
ported an OR of 2.75 (De Jager et al., 2009). Maximum WBC
was associated with infections, leukemias and other expected
conditions (Fig. 2).

         
   
   
 

Maximum MC.
I Elevated white blood cell cnunl
25- _
: Wiﬁ'ﬁiremwe disease
a 20‘ 3 7 I Respiratory failure: insufficiency; arrest
‘2 IS ' l . . 3 Pneumonia I
- ' 001$ anemiaa
$‘U_i§§&gnallnieclioo a Heart fgijure 'Renal failure. :
v 0 d o
‘ " ‘ c
5 .‘ ' I __ _
o.

 

at “W :2? “is 3%.

«9.904% 6 am a «3% q. a, at,“
bogéﬁeck tee a, at, Shag??? % dogma «has» 3%

* a

.Q
Phenotypes
Fig. 2. PheWAS Manhattan plot for maximum WBC, with phenotypes
ordered within each phenotype category by P-value

These analyses were performed from ICD-9 codes and demo-
graphic data using the createPhewasTable, phewas, and
phewasManhattan methods of the R PheWAS package.
The top lines represent Bonferroni signiﬁcance, and differing
output options were used to showcase functionality.
Supplementary Tables S1 and S2 include the top 25 hits by
P-Value for each analysis.

As more investigators leverage EMR data for clinical and gen-
omic analyses, available validated methods will become more
valuable. These methods should permit easier adoption of
EMR-based PheWAS by more researchers. As shown in the
WBC analysis, the PheWAS methodology can also be applied
to non-genetic data, providing new avenues of investigation for
PheWAS.

Funding: The project was supported by National Library of
Medicine (5T15LM007450 and R01 LM010685).

Conﬂict of Interest: none declared.

REFERENCES

De Jager,P.L. et a]. (2009) Meta—analysis of genome scans and replication identify
CD6, 1RF8 and TNFRSFIA as new multiple sclerosis susceptibility loci.
Nat. Genet., 41, 77(r782.

Denny,J.C. et a]. (2010) PheWAS: demonstrating the feasibility of a
phenome—wide scan to discover genekiisease associations. Bioinﬁtrmatics, 26,
120571210.

Denny,J.C. et a]. (2011) Variants near FOXEl are associated with hypothyroidism
and other thyroid conditions: using electronic medical records for genome— and
phenome—wide studies. Am. J. Hum. Genet., 89, 5297542.

Denny,J.C. et a]. (2013) Systematic comparison of phenome—wide association study
of electronic medical record data and genome—wide association study data.
Nat. Biotechnol., 31, 110271110.

Marchini,J. et a]. (2007) A new multipoint method for genome—wide association
studies by imputation of genotypes. Nat. Genet., 39, 90(r913.

Pendergrass,S.A. et a]. (2012) Visually integrating and exploring high throughput
phenome—wide association study (PheWAS) results using PheWAS—view.
BioData Min., 5, 5.

Pendergrass,S.A. et a]. (2013) Phenome—wide association study (PheWAS) for
detection of pleiotropy within the population architecture using genomics and
epidemiology (PAGE) network. PLoS Genet., 9, e1003087.

Purcell,S. et a]. (2007) PLINK: a tool set for whole—genome association and
population—based linkage analyses. Am. J. Hum. Genet., 81, 5597575.

 

2376

112 /310's112u1n0fp10}x0"sorteuiJOJuioiq/ﬁduq 11101} papeoiumoq

9103 ‘Og isanV uo ::

