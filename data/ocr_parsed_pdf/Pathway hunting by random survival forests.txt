BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

X.Chen and H.Ishwaran

 

algorithm and a testing procedure for pathway analysis. In
Section 3.1, we show that our method performs favourably com—
pared with ﬁve popular pathway testing methods using a simu—
lation study. We illustrate the pathway hunting approach in
Sections 3.2 and 3.3 using two microarray survival datasets
involving colon cancer and ovarian cancer. Section 4 presents a
summary discussion.

2 METHODS

2.1 Random survival forests

RF (Breiman, 2001) is a non-parametric ensemble tree learning method
that has become increasingly popular for genetic and gene expression
data analyses (Diaz-Uriarte and de Andres, 2006; Lunetta et al., 2004;
Pang et al., 2006). An RF ensemble comprises randomly grown recur-
sively partitioned binary trees. Each tree is grown from an independent
bootstrap sample. Trees are generally grown deeply, and during the tree
growing process, each node is split using a randomly selected subset of
variables. These features enable RF to reduce both bias and variance.

RSF is a new extension of RF to right-censored survival data settings
(Ishwaran et al., 2008). RSF possesses similar properties to RF. It is a
data adaptive procedure able to model non-linear effects and complex
interactions among features. These properties make it an attractive tool
for the analysis of complex survival data. RSF has been successfully
applied to cancer staging and integrative genomic modelling (Chen
et al., 2010; Ishwaran et al., 2009; Weichselbaum et al., 2008).

In this article, RSF models were constructed using the following four
steps:

(1) A total of ntree independent bootstrap samples are drawn. Each
bootstrap sample excludes on average 36.8% of the original data,
called out-of-bag (OOB) data. For each bootstrap sample, a single
random survival tree is grown.

(2) When growingthe tree, at each treenode, mtry variables are randomly
selected. A maximum of nsplit split-points are chosen randomly
for each of the mtry variables. The node is split by ﬁnding the vari-
able that maximizes the log-rank test across its nsplit randomly
selected split points (in our examples, we used nsplit equal to 10).

(3) Each survival tree is grown to full size under the constraint that the
minimum number of unique event times in a node is no smaller
than the integer nodesize.

(4) The forest ensemble is the tree-averaged cumulative hazard func-
tion. The predicted value mortality is deﬁned as the forest cumu-
lative hazard function summed over the event times.

All RSF models in this article were calculated using the R-package
randomSurvivalForest. Default settings for the software were used except
for nsplit, which was set to 10 (as stated earlier in the text).

2.2 Minimal depth

A useful feature of RF is that it provides a rapidly computable internal
measure of variable importance (VIMP) that can be used for ranking
features. To calculate VIMP for a variable, the given variable is randomly
permuted in the OOB data, and the permuted OOB data are dropped
down the tree. OOB prediction error is then calculated. The difference
between this estimate and the OOB error without permutation (i.e. from
the original tree), averaged over all trees, is the VIMP of the variable. The
larger the VIMP of a variable, the more predictive the variable (Breiman,
2001). VIMP has been widely used to rank predictors in microarray ex-
pression and genetic association data analysis.

Recently, Ishwaran et a]. (2010) described a new high-dimensional
variable selection method based on a tree concept referred to as minimal

depth which measures the importance of a variable in terms of its splitting
behaviour relative to the root node. This avoids directly working with
prediction error and is non-randomized, which makes it possible to pro-
vide a theoretical basis for selecting variables (something that is not avail-
able with VIMP). The minimal depth of a variable v is the depth at which
the variable ﬁrst splits within a tree, relative to the root node. The smaller
the minimal depth, the more predictive the variable.

Denote the minimal depth for a variable v by Dv. In high-dimensional
sparse settings under the assumption that v is noisy (i.e. is unrelated to the
outcome), it was shown (Ishwaran et al., 2010) that for 0 5 d 5 D(T) — 1,
where D(T) is the depth of the tree T,

In, “Li 14
PD‘ysz,...,E = l— l—— l—— , l
{ |0 D(T)} [ < p)  p) ()

where 6,; equals the number of non-terminal nodes at depth d and [7
equals the number of features.

Minimal depth selection selects a variable v if its tree-averaged minimal
depth is less than or equal to the mean of Dv under the distribution (1).
Although Equation (1) is conditional on the tree-node values 6,), which
are unknown, in practice, 6,; is estimated using forest averaged values.
This makes minimal depth selection easily and rapidly computable in
practice. The performance of minimal depth variable selection was sys-
tematically compared with VIMP in Ishwaran et a]. (2011). The results
repeatedly demonstrated superiority to VIMP. Thus, we use minimal
depth to measure importance of a gene in this article.

2.3 Pathway hunting

Although minimal depth is reliable in moderately high-dimensional
settings, it is still difﬁcult to obtain accurate measurements in ultra-
high-dimensional scenarios (Ishwaran et al., 2010). To overcome this
dimensionality problem, we propose a minimal depth pathway hunting
approach adapted from the variable hunting method of Ishwaran et a].
(2010). The algorithm consists of the following steps:

(1) Split the data into training and test sets (we used 80 and 20%,
respectively).

(2) Select P genes randomly from all available genes 17. The default
setting is P=p/5 when P< 1000, otherwise P: 1000.

(3) Fit a survival forest, [F, to the training data using P genes.
(4) Determine the minimal depth for each of the P genes.

(5) Calculate the test set prediction error of [F using the test data.
(6) Repeat step 175 B times.

(7) Determine the average minimal depth for each of the 17 genes from
the B RF.

(8) Compute the pathway minimal depth by averaging the minimal
depth of all genes within the given pathway. The smaller the aver-
aged pathway minimal depth measure, the more important the
pathway.

The algorithm breaks the ultra-high-dimensional feature space into
more manageable subspaces to better estimate the minimal depth for
each gene. The number of replicates B generally needs to be large
enough to fully span all genes. In this article, we set B = 200 for all ana-
lyses. A pathway-ranked list of genes can be obtained using the ordered
pathway level minimal depth values.

2.4 Pathway signiﬁcant testing

For signiﬁcance testing of pathways, permutation tests that permute
sample labels are often used. However, this approach is too computation-
ally extensive with RSF, as it requires that the entire pathway hunting
steps be repeated for each permutation sample. Instead, we shall adopt
the random-set enrichment scoring framework (Newton et al., 2007) to

 

100

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

Pathway hunting by random survival forests

 

analyse pathway minimal depth. Speciﬁcally, for a given pathway with m
genes, we calculate its entire set of gene minimal depth values
G 2 {D1, D2, . . . ,Dm}. We deﬁne the enrichment score for the pathway
to be I? = ZveG Dv/m. We test the null hypothesis that I? is not different
from the mean of a random set of m distinct genes drawn randomly from
a total of 17 genes representing the genome background. When 17 is large,
the distribution of minimal depth is approximately Gaussian. Applying
the 8 method, we obtain

_ 1 P
\':l

2
2: - 2167*“) l” 2 _ l”
a Var(X) m p_1 [(1721:]; pan. .

The null hypothesis can be tested by comparing the standardized path-
way minimal depth enrichment score Z =()_( —p,)/a to a standard
normal distribution. Small values of Z indicate a pathway enriched
with predictive genes.

 

3 RESULT

3.1 Simulation studies

We use simulation studies to assess the effectiveness of the RSF
pathway hunting method for identifying pathways with genei
gene interactions. We compare our method with several well—
known pathway analysis methods. We focus on a pathway
cross—talk simulation, as it poses a difﬁcult scenario for standard
pathway approaches.

We set 11 = 250 for the sample size and P = 500 for the number
of genes. For each observation, expression values for the p genes
(x1, ..., xp)T were generated from a multivariate normal distri—
bution with mean zero and autoregressive correlation structure
corr(x,~,xk) = pH’k' for two genes 1' and k. The 500 genes were
divided into 50 pathways with 10 genes each. The survival time
of each sample was generated based on six randomly selected
causal genes (x1,...,x6) from an exponential distribution with
mean

M = expl-ﬂC’CIM + X2965 + X3X6)] (2)

where the coefﬁcient was set at B = 8. Censoring times were
drawn independently from an exponential distribution with
mean [1, the average of [L over the samples.

To simulate pathways associated with the survival outcomes,
we designed two scenarios. In the first scenario, there was one
disease associated pathway and three of the six causal genes
(x1,x2,x3) were randomly selected from the 10 genes in
Pathway 1, and genes (x4,x5,x6) were randomly selected from
the remaining 490 genes. Under this simulation set—up,
Pathway 1 was the only disease associated pathway. Note,
genes x4,x5,x6 were disease associated genes, but not located
within the causal pathway (i.e. Pathway 1).

In the second scenario, there were two causal pathways that
included disease associated genes. Genes (x1,x2,x3) were again
randomly selected from Pathway 1, whereas genes (x4,x5,x6)
were randomly selected from another single pathway, which
was drawn randomly from the remaining 49 pathways. Both
pathways were considered as disease associated pathways in
this case. In each of two cases aforementioned, the correlation

parameter ,0 was 0.5, 0.7 and 0.9. We repeated each of the six
simulation scenarios 100 times independently.

We compared the performance of our RSF pathway hunting
approach to ﬁve other pathway testing methods. These included
(i) the random—set method (Newton et al., 2007) implemented in
the R—package allez; (ii) Fisher’s exact test, where the threshold
for classifying signiﬁcant genes was set at a nominal P—value of
0.05 obtained from univariate Cox regression modelling of a
gene; (iii) GSEA (Subramanian et al., 2005) implemented using
the javaGSEA program available from the Broad Institute at
http://www.broadinstitute.org/gsea/downloads.jsp; (iv) the max—
mean test (Efron and Tibshirani, 2007) implemented in the
R—package GSA; and (v) the RSF pathway approach
Pwayrfsurvival of Pang et a]. (2010) based on single pathways.

In the ﬁrst scenario, there was one disease associated pathway
in each simulation dataset (or repetition); therefore, there
were 100 (2 1 x 100 repetitions) pathways associated with the
survival outcome and 49 x 10024900 control pathways. In
the second scenario, there were two disease associated pathways
in each simulation dataset; therefore, there were 200
(2 2 x 100 repetitions) survival outcome associated pathways
and 4800 (2 48 x 100) control pathways. In each scenario, the
P—values obtained for these 5000 pathways were then used to
compute the receiver operator characteristics (ROC) curves.
These show the trade—off between sensitivity and specificity as
the threshold for declaring a signiﬁcant pathway varies. To com—
pare the overall discriminative abilities of the methods over all
possible cut—offs, we calculated the area under the ROC curve
(AUC). Table 1 records the AUC under all six simulation scen—
arios. We ﬁnd that our RSF method (denoted simply as RSF)
signiﬁcantly outperforms all other methods. Figure 1 displays the
ROC curves of all six methods for scenario 2 of Table 1. RSF
sensitivity is better across all levels of speciﬁcities.

We also performed another simulation study based on a real
gene expression dataset, GSE17538 (with 250 patients), pulled
from the NCBI GEO database. Three BioCarta and KEGG
pathways with sizes 10, 21 and 43 were selected as the causal
pathways for comparison. These were chosen as all had similar
pairwise gene correlations (~0.17; see the Supplementary
Material). Then 37 pathways were randomly chosen as back—
ground pathways. The number of genes for all 40 pathways
was 987. We designed the following three simulations. Genes
(x1,x2,x3) were randomly selected from 10 genes in Pathway 1,
and genes (x4,x5,x6) were randomly selected from the remaining
977 genes. These represent the x—variables in the simulation.
Then survival times and censoring status for the x—variables
were generated as in Equation (2) with B = 15. A similar proced—
ure was applied to Pathways 2 and 3, with the number of causal
genes set to 12 and 26, where half of them were from the causal
pathway and the rest were from other genes. Each simulation
was repeated 100 times. The AUC values from the simulation
results are shown in Table 2. Once again, the RSF pathway
hunting method has the best performance.

3.2 Colon cancer data

For our next example, we applied the RSF pathway hunting
method to a colon cancer gene expression data (Smith et al.,
2010). The data were from 223 colorectal adenocarcinoma

 

101

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

an?kgogmomammowoio~&o:3m7.omm\

 

Pathway hunting by random survival forests

 

Table 2. Simulation study results comparing RSF, random-set, Fisher’s
exact test, GSEA and Pwayrfsurvival using real microarray data

 

 

 

Pathway AUC
RSF Random-set Fisher GSEA GSA Pwayrfs
1 0.868 0.608 0.537 0.554 0.653 0.628
2 0.856 0.527 0.534 0.581 0.511 0.624
3 0.861 0.560 0.501 0.505 0.510 0.606

 

Table 3. Top pathways for colon cancer data identiﬁed by RSF using a
0.2 FDR cut-off

 

 

Pathway term Size P-value FDR
PPAR signalling pathway 68 6.82E-11 2.75E-08
Adipocytokine signalling pathway 66 2.08E-06 0.00042
Leptin pathway 11 6.91E-06 0.00092
ECM receptor interaction 83 8.78E-05 0.00884
mTOR signalling pathway 23 0.00046 0.037
TGF-ﬁ signalling pathway 83 0.001 0.068
Focal adhesion 196 0.002 0.101
P53hypoxia pathway 22 0.004 0.179
Tryptophan metabolism 39 0.005 0.179
P53 pathway 16 0.005 0.179
VEGF pathway 29 0.005 0.179

 

Table 4. Top pathways for ovarian cancer data identiﬁed by RSF using a
0.1 FDR cut-off

 

 

Pathway term Size P-value FDR
ECM receptor interaction 81 1.29E-09 5.20E-07
Focal adhesion 190 5.74E-06 0.00088
Inositol phosphate metabolism 49 6.55E-06 0.00088
Phosphatidylinositol signalling system 70 2.48E-05 0.002
Endocytosis 163 2. 70E-05 0 .002
Intrinsic pathway 23 2.54E-03 0.014
Regulation of actin cytoskeleton 195 2.56E-03 0.026
Fc gamma R-mediated phagocytosis 88 5.34E-03 0.026
Adipocytokine signalling pathway 63 8.88E-03 0.039
Acute myeloid leukaemia 57 0.001 0.057
Parl pathway 36 0.002 0.063
Leukocyte transendotheial migration 106 0.003 0.089
Extrinsic pathway 13 0.003 0.095
AMI pathway 20 0.003 0.098

 

For the inositol phosphate metabolism and phosphatidylinositol
signalling system pathways, PIK3CA had been identiﬁed as an
oncogene in ovarian cancer, and clinical trial data support that
inositol hexaphosphate (1P6) plus inositol can enhance the antic—
ancer effect of chemotherapy and slow tumour metastasis

(Shayesteh et al., 1999; Vucenik and Shamsuddin, 2003). Extrin—
sic (cytoplasmic) and intrinsic (mitochondrial) pathways are
apoptosis signal transduction pathways in cancer cells and are
targets of variety of anticancer chemotherapies (Fulda and
Debatin, 2006). In contrast, GSA and Fisher’s exact test did
not ﬁnd any significant pathways associated with survival out—
comes (see the Supplementary Material).

The most interesting ﬁndings were the top two pathways:
ECM receptor interaction and focal adhesion, which were also
among our top pathways from the colon cancer analysis. Focal
adhesions are macromolecules that mediate the regulatory effects
of ECM, which connects cells within most tissues. Signalling
between cells and ECM is essential for cell migration, prolifer—
ation and survival. Cross—talk between tumour cells and the
microenvironment of the local host is critical for development
of tumours (Liotta and Kohn, 2001). Knowledge and control of
the microenvironment become more important for understand—
ing the mechanism of carcinogenesis and developing effective
chemotherapy (Albini and Sporn, 2007).

The importance of the ECM pathway agrees well with another
recent study. To increase power for detecting pathway—level per—
turbations, Krupp et a]. (2011) conducted a large—scale gene ex—
pression meta—study that combined 649 tumour samples from
>1400 experiments and 58 tumour types. Even though there
were only 39 ovarian cancer samples and no colon cancer sam—
ples in this combined dataset, ECM receptor interaction and
PPAR signalling pathway were signiﬁcantly enriched and con—
served across tumour types.

The important genes within each pathway can be screened
using minimal depth. For the ECM receptor interaction path—
way, the minimal depth of all genes within the pathway from
both colon cancer and ovarian cancer is plotted in Figure 2. The
overlapping genes from the first quartile of each data are labelled
with their gene symbols. These genes can be further evaluated
and used as biomarkers for metastasis risk prediction in multiple
cancer types.

4 DISCUSSION

Complex diseases are generally the consequences of interactions
from multiple genes and pathways. Although pathway enrich—
ment and association testing approaches have been developed,
because of computational and statistical modelling challenges,
the information from geneigene interactions are either ignored
or restricted to within an individual pathway.

In this article, we presented a novel RSF pathway hunting
method for identifying and ranking the importance of pathways
for their association with survival outcome. The proposed
method is based on a new measure of variable importance,
termed minimal depth, which has been shown to be an efﬁcient
and effective method for variable selection in high dimensions
(Ishwaran et al., 2010, 2011). Our RSF pathway hunting ap—
proach is capable of capturing both marginal gene effects and
geneigene interactions at the genome level, and it approximates
the complexity of the transcriptome by taking advantage of
a priori biological knowledge.

In our simulation studies, we speciﬁcally designed scenarios
where censored survival outcomes were associated with gene
interactions and pathway cross—talk. The RSF approach

 

103

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

an?kgogmomammowoio~&o:3m7.omm\

I.
3
m
m
.m
p
E
d
m
d
.m
.I

 

Pathway hunting by random survival forests

 

Vucenik,I. and Shamsuddin,A.M. (2003) Cancer inhibition by inositol hexapho—
sphate (ip6) and inositol: from laboratory to clinic. J. Nutr., 133, 37785737848.

Wang,L. et ul. (2008) An integrated approach for the analysis of biological path—
ways using mixed models. PLoS Genet., 4, e1000115.

Wang,L. et ul. (2009) A uniﬁed mixed effects model for gene set analysis of time
course microarray experiments. Stat. Appl. Genet. Mol. Biol, 8, Article 47.
Wasan,H.S. et ul. (1997) Dietary fat inﬂuences on polyp phenotype in multiple

intestinal neoplasia mice. Proc. Natl Avail. Sci. USA, 94, 330873313.

Weichselbaum,R.R. et ul. (2008) An interferon—related gene signature for dna
damage resistance is a predictive marker for chemotherapy and radiation for
breast cancer. Proc. Natl Avail. Sci. USA, 105, 1849(P18495.

Yamauchi,T. et ul. (2003) Cloning of adiponectin receptors that mediate antidia—
betic metabolic effects. Nature, 423, 7627769.

Yang,W.L. and Frucht,H. (2001) Activation of the ppar pathway induces apoptosis
and cox—2 inhibition in ht—29 human colon cancer cells. Carcinogenesis, 22,
137971383.

 

105

/3.IO'S[BIIInO[p.IOJXO'SOIIBLUJOJIIIOICV/Idllq

