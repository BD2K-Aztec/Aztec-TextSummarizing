BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

an?kgowsmomammowoxmoa‘ocgawbmﬁ

 

STAR
TonHaxz
GSNAP
HUM

MapSpIice - - -

sun
ropnau
GSNAP
RUM

MapSpllce

solid: annotated
dashed: unanﬁolaie'xi ' ' ' ' ' '

solid: common to 2 2 mappers

_ _dashed:exc|u.si. . .tmapper. .

STAR STAR
TopHat2 TopHatZ
GSNAP GSNAP

STAR
TopHalZ
GSNAP

RUM
MapSplice

STAR
TopHat2
GSNAP
RUM
MapSplice

 

/3.10'S[Bum0[p10}x0'SOpBLUJOJIITOTq”:duq

STAR

 

parameters and for the present state of Illumina sequencing tech—
nology. As both sequencing technologies and tools improve,
these rankings may change and have to be reevaluated.

Similarly to other RNA—seq aligners, STAR’s default param—
eters are optimized for mammalian genomes. Other species may
require signiﬁcant modiﬁcations of some alignment parameters;
in particular, the maximum and minimum intron sizes have to be
reduced for organisms with smaller introns.

3.3 Speed benchmarks

Speed benchmarks were performed on a server equipped with
two 6—core Intel Xeon CPUs X5680@ 3.33GHz and 148 GB
of RAM (random—access memory). Six or 12 threads were re—
quested for each run, using half or full capacity of the server.
All mappers were run with their default parameters on the ~40
million 2 x 76 Illumina human RNA—seq dataset described in the
previous section.

The ‘wall’ time (i.e. the total run time required to complete the
mapping) and RAM usage are presented in Table 1. STAR
achieves a speed of 550 million 2><76 Illumina paired—end
reads per hour using 12 threads (full capacity of the server),
i.e. 45 million paired reads per hour per processor, outperform—
ing the second fastest mapper (TopHat2) by a factor >50. STAR
exhibits close to linear scaling of the throughput rate with the
number of threads, losing ~10% of per thread mapping speed
when the number of threads is increased from 6 to 12.

STAR’s high mapping speed is traded off against RAM usage:
STAR requires ~27 GB of RAM for aligning to the human
genome. Like all other aligners, with the exception of RUM,
the amount of RAM used by STAR does not increase signiﬁ—
cantly with the number of threads, as the SA is shared among all
threads. Although STAR’s RAM requirements would have been
prohibitively expensive several years ago, at the time when the
ﬁrst short read aligners were developed, recent progress in semi—
conductor technologies resulted in a substantial drop of RAM
prices, and modern high performance servers are commonly
equipped with RAM >32GB. STAR has an option to use
sparse SAs, reducing the RAM consumption to <16 GB for
the human genome at the cost of ~25% decrease in the mapping
speed, while maintaining the alignment accuracy.

Table 1. Mapping speed and RAM benchmarks on the experimental
RNA-seq dataset

 

 

 

Aligner Mapping speed: million Peak physical

read pairs/hour RAM, GB

6 threads 12 threads 6 threads 12 threads

STAR 309.2 549.9 27.0 28.4
STAR sparse 227.6 423.1 15.6 16.0
TopHat2 8.0 10.1 4.1 11.3
RUM 5.1 7.6 26.9 53.8
MapSplice 3.0 3.1 3.3 3.3
GSNAP 1.8 2.8 25.9 27.0

 

3.4 Experimental validation

As part of the characterization of human transcriptome by the
ENCODE (Djebali et al., 2012), STAR was used to map poly—
adenylated (poly A+) long (>200 nt) transcripts isolated from
whole cell extracts of primary human HlES (embryonic stem
cells) and HUVEC (umbilical vein endothelial cells) cell lines.
These RNAs were sequenced using a duplex—speciﬁc nuclease
protocol (Parkhomchuk et al., 2009) that generated 2 x 76bp
strand—speciﬁc reads.

Not surprisingly, unannotated (novel) splice sites show lower
abundance levels than the annotated junctions, as indicated by
the significant drop in the number of unannotated junctions with
the number of supporting reads (Supplementary Fig. S7).
Because each of the cell lines was sequenced in biological dupli—
cates, a collection of high conﬁdence splice sites could be identi—
ﬁed based on their reproducibility between replicas. To assess the
reproducibility of the detected splice junctions, we developed a
non—parametric irreproducible discovery rate (anDR) approach,
speciﬁcally suitable for the discrete nature of the RNA—seq data
(see Supplementary Materials for the detailed description). This
approach is similar to the anDR concept extensively used in the
analysis of the ENCODE ChIP—seq experiments (Landt et al.,
2012). Supplementary Figure S8 shows the dependence of
anDR=0.1 on the read count per junction, providing a prin—
cipled method for selecting the read count threshold with a desired
level of reproducibility. For example, five staggered reads per junc—
tion are required to achieve an anDR of 0.1, i.e. the 90% likeli—
hood that these junctions will be observed again in another
experiment on the same cell line with the same sequencing depth.

Experimental validation was carried out on 1920 novel splice
junctions in a wide range of RNA—seq reads support, both below
and above the anDR threshold. Only splice junctions mapped to
intergenic or antisense loci to Gencode 7 genes (Harrow et al.,
2012) were chosen for validation, as these junctions are more
likely to be false positive than the junctions that map within the
annotated genes. The high—throughput validation pipeline
involved reverse transcription polymerase chain reaction amplifi—
cation of targeted regions followed by Roche 454 sequencing of
the pooled products. The reverse transcription polymerase chain
reaction primer design took advantage of the ~250 nt insert length
of the paired—end reads supporting targeted junctions, and en—
tailed the production of long 30(P600 nt amplicons. These ampli—
cons were pooled and sequenced by a Roche 454 sequencer to
provide long and more conﬁdently mappable reads that were
aligned to the genome with BLAT. Detailed description of the
experimental protocols can be found in Djebali et a]. (2012).

We selected 1920 intergenic and antisense splice junctions from
HlES and HUVEC cell lines, including both highly
(anDR<0. 1) and poorly (anDR>0.1) reproducible junctions.
Of all the tested novel intergenic/antisense junctions supported
by at least ﬁve RNA—seq reads (corresponding to anDR<0.1),
~82789% (HlES) and “495% (HUVEC) were corroborated by
at least two amplicons sequenced by 454 (Table 2). Notably, the
validation rate remains at a high level of 72% (HlES) and 74%
(HUVEC) even for the candidate junctions that were supported
by as few as two RNA—seq reads. These results confirm high
precision of the STAR’s splicing detection algorithm even for
rare novel junctions.

 

19

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

A.Dobin et al.

 

Table 2. Number of selected junctions and percentage of selected junctions that were validated by at least two 454 reads, as a function of the RNA-seq

read count per junction

 

HlES

 

Read count per Number of
junction from tested

Proportion of
junctions validated

HUVEC

 

Read count
per junction

Number of
tested junctions

Proportion of
junctions validated

 

two replicates junctions by at least two from two replicates by at least two
454 reads (%) 454 reads (%)

2 192 72.4 2 192 74.0

3 192 77.6 3 192 75.0

4 96 74.0 4 96 76.0

5 96 82.3 576 96 84.4

6*7 96 79.2 778 96 84.4

8711 96 81.3 9712 96 86.5

12724 96 87.5 13723 96 94.8

:25 96 88.5 :24 96 90.6

 

The upper bound of the false discovery rate (FDR) can be
estimated from the validation rate (EVR) as FDRg 1 —VR.
For low abundance junctions, the experimental FDR is lower
than the anDR predicted from the dissimilarity between the
replicates: for example, although 45% of junctions, supported
by just two reads, are not reproducible (Supplementary Fig.
S8), >70% of them are successfully validated (Table 2). Hence,
anDR can serve as a conservative upper bound FDR estimate
in cases where validation experiments are impractical.

4 DISCUSSION

Despite several years of ongoing improvements, alignment of the
non—contiguous RNA—seq reads to a reference genome is not a
solved problem yet, owing both to its intrinsic complexity and
rapid transformations of the sequencing technologies. Several
critical problems have been found to afﬂict previously published
approaches, such as high mapping error rate, alignment biases,
low sensitivity for unannotated transcripts, poor scalability with
the read length, restrictions in the number of junctions/mis—
matches/indels per read, inability to detect non—linear transcripts
(such as chimeric RNAs), and, crucially, low mapping
throughput.

In this work, we described STAR, a novel algorithm for align—
ing high—throughput long and short RNA—seq data to a reference
genome, developed to overcome the aforementioned issues.
Unlike many other RNA—seq mappers, STAR is not an extension
of a short—read DNA mapper, but was developed as a
stand—alone C++ code. STAR is capable of running parallel
threads on multicore systems with close to linear scaling of prod—
uctivity with the number of cores. STAR is fast: on a modern,
but not overly expensive, 12—core server, it can align 550 million
2 x 76 nt reads per hour to the human genome, surpassing all
other existing RNA—seq aligners by a factor of 50. At the same
time, STAR exhibits better alignment precision and sensitivity
than other RNA—seq aligners for both experimental and simu—
lated data.

One of the main inherent problems of all de novo RNA—seq
aligners is the inability to accurately detect splicing events that
involve short (<&10nt) sequence overhangs on the donor or
acceptor sides of a junction. This causes a significant
underdetection of splicing events, and also increases signiﬁcantly
the misalignment rate, as such reads are likely to be mapped with
a few mismatches to a similar contiguous genomic region. In
addition, this effect also biases the alignments toward processed
pseudogenes, which are abundant in the human genome.
Similarly to other RNA—seq aligners, to mitigate this problem,
STAR has an option to obtain information about possible splice
junction loci from annotation databases (Supplementary Section
4). It is also possible to run a second mapping pass, supplying it
with splice junction loci found in the first mapping pass. In this
case, STAR will not discover any new junctions but will align
spliced reads with short overhangs across the previously detected
junctions.

To demonstrate STAR’s ability to align long reads, we have
mapped the long (055 kb) human mRNA sequences from
GenBank (see Supplementary Section 5 for details). The accur—
acy of STAR alignments is similar or higher than that of BLAT
(Kent, 2002) a popular EST/mRNA aligner. At the same time,
STAR outperforms BLAT by more than two orders of magni—
tude in the alignment speed, which is important for
high—throughput sequencing applications.

The algorithm extensibility to long reads shows that STAR
has a potential to serve as a universal alignment tool across a
broad spectrum of emerging sequencing platforms. STAR can
align reads in a continuous streaming mode, which makes it
compatible with novel sequencing technologies such as the one
recently announced by Oxford Nanopore Technologies. As the
sequencing technologies and protocols evolve, new mapping stra—
tegies will have to be developed, and STAR core algorithm can
provide a ﬂexible framework to address arising alignment
challenges.

Data access
GEO: GSE38886 (Roche 454 sequencing)
GEO: GSE30567 (Illumina long RNA—Seq)

 

20

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

STAR

 

Funding: This work was funded by NHGRI (NIH) grant
U54HG004557.

Conﬂict of Interest: none declared.

REFERENCES

Au,K.F. et ul. (2010) Detection of splice junctions from paired—end RNA—seq data
by SpliceMap. Nucleic Aciilx' Re.\'., 38, 45704578.

Darling,A.C. et ul. (2004) Mauve: multiple alignment of conserved genomic se—
quence with rearrangements. Genome Re.\'., 14, 13944403.

Darling,A.E. et ul. (2010) progressiveMauve: multiple genome alignment with gene
gain, loss and rearrangement. PLoS One, 5, e11147.

De Bona,F. et ul. (2008) Optimal spliced alignments of short sequence reads.
Bioinﬁ)rmutic.\‘, 24, i174~180.

Delcher,A.L. et ul. (1999) Alignment of whole genomes. Nucleic Acids Re.\'., 27,
236972376.

Delcher,A.L. et ul. (2002) Fast algorithms for large—scale genome alignment and
comparison. Nucleic Aciilx' Rec, 30, 247872483.

Djebali,S. et ul. (2012) Landscape of transcription in human cells. Nature, 489,
1017108.

Flusberg,B.A. et ul. (2010) Direct detection of DNA methylation during
single—molecule, real—time sequencing. Nut. Met/lolly, 7, 461465.

Grant,G.R. et ul. (2011) Comparative analysis of RNA—Seq alignment algo—
rithms and the RNA—Seq uniﬁed mapper (RUM). Bioinfommticx, 27,
251872528.

HanJ. et ul. (2011) Pre—mRNA splicing: where and when in the nucleus. Tremlx'
Cell. Biol, 21, 33(r343.

Harrow,J. et ul. (2012) GENCODE: The reference human genome annotation for
the ENCODE project. Genome Re.\'., 22, 176(F1774.

Hastings,M.L. and Krainer,A.R. (2001) Pre—mRNA splicing in the new millennium.
Curr. Opin. Cell. Biol, 13, 3027309.

Kurtz,S. et ul. (2004) Versatile and open software for comparing large genomes.
Genome Biol, 5, R12.

Kent,W.S. (2002) BLATithe BLAST—like alignment tool. Genome Rec, 12,
656—664.

Landt,S.G. et ul. (2012) ChIP—seq guidelines and practices of the ENCODE and
modENCODE consortia. Genome Rec, 22, 181371831.

Manber,U. and Myers,G. (1993) Sufﬁx arraysia new method for online string
searches. SIAM J. Comput., 22, 9357948.

Parkhomchuk,D. et ul. (2009) Transcriptome analysis by strand—speciﬁc sequencing
of complementary DNA. Nucleic Aciilx' Re.\'., 37, e123.

Rothberg,J.M. et ul. (2011) An integrated semiconductor device enabling
non—optical genome sequencing. Nature, 475, 3487352.

Trapnell,C. et ul. (2009) TopHat: discovering splice junctions with RNA—Seq.
Bioinformuticx‘, 25, 1 105711 11.

Wang,K. et ul. (2010) MapSplice: accurate mapping of RNA—seq reads for splice
junction discovery. Nucleic Acids Re.\'., 38, e178.

Wu,T.D. and Nacu,S. (2010) Fast and SNP—tolerant detection of complex variants
and splicing in short reads. Bioiiy’ormuticx, 26, 8737881.

Zhang,Y. et ul. (2012) PASSion: a pattern growth algorithm—based pipeline for
splice junction detection in paired—end RNA—Seq data. Bioiiy’ormuticx, 28,
479486.

 

21

ﬁm'spzumol‘pmjxo'sopnuuqurorq/ﬁdnq

