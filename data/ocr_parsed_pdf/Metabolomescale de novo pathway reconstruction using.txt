Bioinformatics, 31,2015, i161—i170
doi: 10.1093/bioinformatics/btv224
ISMB/ECCB 2015

 

Metabolome-scale de novo pathway
reconstruction using regioisomer—sensitive
graph alignments

Yoshihiro Yamanishi1'2'l, Yasuo Tabei3"r and Masaaki Kotera4'*

1Division of System Cohort, Medical Institute of Bioregulation, Kyushu University, Higashi-ku, Fukuoka, Fukuoka
812-8582, 2Institute for Advanced Study, Kyushu University, Higashi-ku, Fukuoka, Fukuoka 812-8581, 3PRESTO,
Japan Science and Technology Agency, Kawaguchi, Saitama 332-0012 and 4Graduate School of Bioscience and
Biotechnology, Tokyo Institute of Technology, 2-12-1 Ookayama, Meguro-ku, Tokyo, 152-8550, Japan

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.

Abstract

Motivation: Recent advances in mass spectrometry and related metabolomics technologies have
enabled the rapid and comprehensive analysis of numerous metabolites. However, biosynthetic
and biodegradation pathways are only known for a small portion of metabolites, with most meta—
bolic pathways remaining uncharacterized.

Results: In this study, we developed a novel method for supervised de novo metabolic pathway re—
construction with an improved graph alignment—based approach in the reaction—filling framework.
We proposed a novel chemical graph alignment algorithm, which we called PACHA (Pairwise
Chemical Aligner), to detect the regioisomer—sensitive connectivities between the aligned substruc—
tures of two compounds. Unlike other existing graph alignment methods, PACHA can efficiently
detect only one common subgraph between two compounds. Our results show that the proposed
method outperforms previous descriptor—based methods or existing graph alignment—based meth—
ods in the enzymatic reaction—likeness prediction for isomer—enriched reactions. It is also useful for
reaction annotation that assigns potential reaction characteristics such as EC (Enzyme
Commission) numbers and PIERO (Enzymatic Reaction Ontology for Partial Information) terms to
substrate—product pairs. Finally, we conducted a comprehensive enzymatic reaction—likeness pre—
diction for all possible uncharacterized compound pairs, suggesting potential metabolic pathways

 

for newly predicted substrate—product pairs.
Contact: maskot@bio.titech.ac.jp

 

1 Introduction

Understanding cell metabolism is essential in a wide range of fields,
e.g. metabolic engineering, synthetic biology, drug discovery and
clinical treatments of metabolic disorders (Toya and Shimizu, 2013;
Newman and Cragg, 2012; Ramautar et (11., 2013). Recent advances
in mass spectrometry and related metabolomics technologies have
enabled the rapid and comprehensive analysis of numerous metabol—
ites. However, biosynthetic and biodegradation pathways are only
known for a small portion of metabolites, with the majority of path—
ways remaining uncharacterized (Sreekumar et (11., 2009). For ex—
ample, it is estimated that at least 1 060 000 metabolites are
produced within all plants, for which most chemical transform—
ations remain to be identified (Afendi et (11., 2012). Elucidation of

©The Author 2015. Published by Oxford University Press.

potential metabolic pathways in plants would provide a significant
benefit for environmental, agricultural, pharmaceutical and public
health matters. Experimental determination of metabolic pathways
is difficult, expensive and time consuming (Nakabayashi and Saito,
2013); thus automatic pathway reconstruction on a metabolome
scale is a challenging issue in current computational biology.

The traditional in silico method for metabolic pathway recon—
struction is the predefined pathway approach, where enzyme—coding
genes are mapped onto appropriate positions in the predefined path—
way diagrams based on gene—gene sequence similarities (Bono et (11.,
1998). This method has been used for analyzing metabolic pathways
in fully sequenced organisms or in specific conditions of cellular
processes (Kanehisa et (11., 2014). Another method in the predefined

i161

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.U/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /3.10'speum0fp1q1xo"sorwurJOJurorq/ﬁduq 11101} popcorn/bog

9103 ‘Og anﬁnv uo ::

i162

Y. Yamanishi et aI.

 

pathway approach is to consider chemical structures for finding
pathways that conserve atoms from start to the target compounds in
predefined pathway diagrams (Boyer and Viari, 2003; Heath et (11.,
2010). However, these methods are not applicable to the identifica—
tion of previously unknown pathways (absent from predefined path—
way maps).

Conversely, various de novo pathway reconstruction methods
have been developed to elucidate novel reactions based on metabol—
ite chemical structures, known enzymatic reactions and possible
chemical transformations. The overall problem resembles that of
synthetic organic chemistry (Faulon and Sault, 2001), but few
studies have tackled this problem for enzymatic reactions.
Previously developed de novo methods can be categorized into ei—
ther the compound—filling framework (Darvas, 1988; Ellis et (11.,
2008; Greene et (11., 1999; Moriya et (11., 2010; Talafous
et (11., 1994) or the reaction—filling framework (Hatzimanikatis
et (11., 2005; Nakamura et (11., 2012; Tanaka et (11., 2009). However,
previous methods in both frameworks are not applicable to metabo—
lome—scale compound sets because of prohibitive computational
burden.

Recently, de novo pathway reconstruction in the reaction—filling
framework has been formulated as a problem of enzymatic reaction—
likeness, and an efficient supervised method has been proposed to
predict whether the given pairs of metabolites can be chemically
interconverted by single enzymatic reactions (Kotera et (11., 2013b).
With this method, the use of chemical descriptors—binary/integer
vectors representing compound chemical characteristics (e.g.
chemical substructures) (Steinbeck et (11., 2003)—is key for compu—
tational efficiency, which enables metabolome—scale application for
tens of thousands of metabolites at a time. However, chemical
descriptors cannot handle connectivities among substructures in a
compound; thus, in theory, it is difficult to distinguish regioisomers
(positional isomers), resulting in many false positive predictions in
practice. Regioisomers are a group of compounds with the
same compositional formula (numbers of respective elements)
but are different in connectivity among the substructures. Proper
distinction of isomers is required for appropriate interpretation of
metabolome data (Mitchell et (11., 2014). Thus, there is a
strong need to develop an efficient approach that can deal with
regioisomers, thus strengthening the de novo pathway reconstruc—
tion study.

In this study, we developed a novel method for supervised de
novo metabolic pathway reconstruction with an improved graph
alignment—based approach in the reaction—filling framework. We
propose a novel chemical graph alignment algorithm, which we
called PACHA (Pairwise Chemical Aligner), in order to detect
regioisomer—sensitive connectivities between the aligned substruc—
tures of two compounds. Unlike other existing graph alignment
methods [such as SIMCOMP (Hattori et (11., 2003)], PACHA can
efficiently detect only one common subgraph between two com—
pounds. Our results show that the proposed method outperforms
previous descriptor—based methods or existing graph alignment—
based methods in the enzymatic reaction—likeness prediction for iso—
mer—enriched reactions. It is also useful for reaction annotation
that assigns potential reaction characteristics such as EC (Enzyme
Commission) numbers (McDonald and Tipton, 2014) and PIERO
(Enzymatic Reaction Ontology for Partial Information) terms
(Kotera et (11., 2014) to substrate—product pairs. Finally, we
conducted a comprehensive enzymatic reaction—likeness prediction
for all possible uncharacterized compound pairs, suggesting poten—
tial metabolic pathways for newly predicted substrate—product
palrs.

2 Materials

2.1 Chemical structures of compounds

Chemical structures of metabolic compounds were retrieved from
the KEGG LIGAND database (Kanehisa et (11., 2014). MDL mol—
files, which are the de facto standard of chemical structure format
files, were converted to the KEGG Chemical Function (KCF) format
(Hattori et (11., 2003). In KCF, atoms (with the exception of hydro—
gen atoms) and bonds were represented as vertices and edges, re—
spectively. Each vertex was given three labels representing the
different levels of physicochemical properties, e.g. ‘C’ for a carbon
atom, ‘C1’ for an 5173 carbon and ‘C1a’ for a methyl carbon (CH3—).
Hydrogen atoms were not explicitly represented as vertices but were
implicitly represented in the attached atoms (see http://www.genome.
jp/kegg/reaction/KCF.html). In this study, the one—letter label (e.g.
C), two—letter label (e.g. C1) and three—letter label (e.g. Cla) were
referred to as the primary, secondary and tertiary labels,
respectively.

2.2 Substrate—product pair datasets

Substrate—product relationships were retrieved from KEGG RPAIR
and used as the positive examples of enzymatic reaction likeness.
Different reaction directions were dealt as different pairs (e.g. ‘L-
Argim'ne — L-Ornit/oine’ and ‘L-Ornit/oine - L-Arginine’) in order to
not miss the similarity between the forward direction of a reaction
and the reverse of another reaction.

Known substrate—product pairs were regarded as positive ex—
amples, whereas the remaining compound pairs were regarded as
negative examples. To a certain extent, substrate—product pairs
share common structures, therefore, chemical similarity is one of the
efficient measures to distinguish positive and negative examples. In
this study, we focused on dealing with similar pairs (Jaccard coeffi—
cient > 0.5), which are more difficult and realistic condition. The
numbers of positive examples and negative examples are 10 852
and 51 8 854, respectively, which is referred to as the ‘all’ dataset.

From the all dataset, the positive and negative pairs were
grouped by the same compositional formulas (i.e. the compound on
one side of a pair is a regioisomer of the compound on the same side
of another pair). The groups were then removed if there were less
than four positive or negative pairs within a group. The set of the re—
maining compound pairs was referred to as the ‘isomer—enriched’
dataset. The numbers of positives and negatives in the isomer—
enriched dataset were 1632 and 53 046, respectively. Note that the
isomer—enriched dataset is more difficult than the ‘all’ dataset in
terms of enzymatic reaction—likeness prediction because of the issue
of regioisomers.

2.3 Chemical descriptors

Chemical structures of compounds were represented by high—
dimensional chemical descriptors, which are the binary/integer
vectors representing the chemical structural characteristics of metab—
olites. We tested CDK Extended fingerprint, CDK GraphOnly fin—
gerprint, CDK Hybridization fingerprint (Steinbeck et (11., 2003),
EState fingerprint (Hall and Kier, 1995), KlekotaRoth fingerprint
(Klekota and Roth, 2008), MACCS fingerprint (Durant et (11.,
2002), PubChem fingerprint (Chen et (11., 2009), the atomic environ—
ment (AE) descriptor (Nakamura et (11., 2012) and KCF—S descriptor
(Kotera et (11., 2013a). For example, KCF—S descriptors represent the
number of biochemical substructures, e.g. methyl, n—butyl, benzene
and adenine residue. AE and KCF—S descriptors were calculated by
our in—house program, whereas the other descriptors were generated
using the Chemistry Development Kit (Steinbeck et (11., 2003).

112 /3.10'speum0fp1q1xo"sorwurJOJurorq/ﬁduq 11101} popcorn/bog

9103 ‘Og anﬁnv uo ::

Metabolome—scale de novo path way reconstruction

i163

 

2.4 Manually curated reaction annotations

EC numbers and PIERO terms were retrieved from KEGG and
GenomeNet, respectively. EC numbers represent the hierarchical en—
zyme classification based on the full reaction equation (McDonald
and Tipton, 2014). EC sub—subclasses (upto the third digit of the EC
numbers) were used as the reaction annotation by EC. PIERO is a
collection of terminology annotating substrate—product relation—
ships in enzymatic reactions (Kotera et (11., 2014).

3 Methods

3.1 Chemical graph alignment problem

We address the problem of chemical graph alignment using a simple
example. Figure 1 shows two compounds of n—butylamine (com—
pound A) and methyl—n—propylamine (compound B) that are
regioisomers (positional isomers). Figure 1(a) shows the atom—atom
mapping by the chemical graph alignment of the two compounds,
which detects the preserved substructure in a putative reaction and
the changed chemical bonds. In this example, four vertices are pre—
served, two of which changed labels; an edge labeled ‘C1a—C1b’ is
eliminated and an edge labeled ‘C1a—N1b’ is generated. To charac—
terize reactions and distinguish regioisomers, it is crucial to detect
type of bond that has changed and the position where it has
changed.

Since the two compounds are regioisomers, no differences would
be detected by counting the elements (C, H and N). Figure 1(b)
shows a feature vector representation of the compound pairs, such
as, using KCF—S descriptors representing the number of substruc—
tures, e.g. methyl (C1a—), ethyl (C1a—C1b—) and n—propyl (C1a—C1b—
C1b—), etc. The feature vector detects preserved (common) and
changed (decreased and increased) chemical characteristics.
However, the descriptor—based feature vector does not necessarily
reﬂect the exact chemical changes that actually occur in the reaction.
For example, although the feature vector indicates that vertex C1a is
preserved in two compounds, the C1a vertices do not form an
atom—atom pair in the graph alignment. Thus, it is very difficult for
descriptor—based methods to capture the chemically important char—
acteristics of reactions.

In this study, we propose a novel method for chemical graph
alignment that can handle the issue of regioisomers and show
the potential of the proposed method for applications to the enzym—
atic reaction likeness prediction and reaction annotation on a
metabolome—scale. The details of the proposed method are ex—
plained below.

3.2 Pairwise chemical aligner (PACHA)
We propose a novel, efficient algorithm named PACHA for chemical
graph alignments. We represent each compound chemical structure
G by a labeled graph defined as G : (V, E, L), where V is the set of
vertices (i.e. atoms in this study), E is the set of undirected edges (i.e.
bonds in this study) and L : V —> 2 is a function that assigns labels
from an alphabet 2 to vertices (i.e. primary, secondary or tertiary
labels in this study). Let s : V X V —> R be a similarity function be—
tween a vertex pair (i.e. an atom—atom pair in this study) and re—
turns —00 if the vertex pair is unmatched. The function 5 will be
detailed in the next subsection.

Suppose we are given two chemical graphs G : (V,E,L) and
G’ : (V’, E’,L’). We formulate the graph alignment as the problem
of finding a set of matching vertex pairs M E V X V’ that maximizes
the summation of vertex similarities 5(11, 11’) for (141/) E M as follows:

(3) Graph alignment-based vector

Compound A T Compound B
C|H3

      

Graph alignment

C|H2 C|H3
C|H2 CH2
I
CIIH2 (EH2
NH2 hIH
CH3
Aligned Eliminated Generated
[ii I] HEEEE mourn
92929291.  
9993 99999 99999
NW“ are??? as“???
c”>c"uc"a£ 29333 99353
cccwwwwcmw
(b) Descriptor-based vector
Compound A Compound B
Descriptor A o . Descriptor B
peratron
nu HEIDI]
9 9 9 9 E E 9 9 9 9 E E
m r r r? m U m r e tr 0 U
9 9 9 9 9 9
U C! C! U C! Cr
9 9 9 9
5' 9' U’ CIT
9 9
CT CT
Common Decreased Increased

 

I1 I1 I1 IOIOIOI I0|0|0|1 I1 IOI I1 |0|0|0|0|1I

Fig. 1. (a) Graph alignment-based vector proposed in this study. Graph align-
ment yields atom—atom mapping (represented by dashed lines).
Subsequently, the number of atom—atom pairs in the alignment (e.g. the col-
umn labeled ‘a:C1a: C1a’ in the white boxes on the left), the number of elimi-
nated bonds (e.g. the column labeled ‘e:C1a-C1b’ in the gray boxes in the
middle) and the number of generated bonds (e.g. column labeled ‘g:C1a-N1b’
in the gray boxes on the right) were represented as a vector. The symbols ‘2'
and ‘7' represent the atom—atom mapping and the chemical bond, respect-
ively. (b) Descriptor-based vectors in the previous studies (e.g. KCF-S). Each
compound vector represents chemical characteristics (e.g. number of sub-
structures). The feature vector for the compound pair consists of three parts:
common features between the two compounds (in the white boxes on the
left), excess number of features in the left compound (in the gray boxes in the
middle) and right compound (in the gray boxes on the right)

max 2 s(v,1/), (1)
MQVXV (mam

under the following two constraints:

(i) If (141/) E M, then (u, z) g M for all z E V’ and (z, 11’) g M for
all z E V, i.e. a vertex in V can be matched to at most one ver—
tex in V’.

(ii) The matching vertices in M of C (respectively, G’) and edges E’
(respectively, E’) form connected subgraphs, i.e. there is a pass
from any vertex to the other vertices in C (respectively, G’).

Note that constraint (ii) is absent from existing graph alignment
methods such as SIMCOMP (Hattori et (11., 2003), which causes the
generation of many (possibly small) subgraph matches, thus prevent—
ing the sensitive detection of regioisomers.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} popco1um0q

9103 ‘0g anBnV uo ::

i164

Y. Yamanishi et aI.

 

Because computing the exact solution for the graph alignment is
intractable, we solved it using a greedy strategy. To efficiently select
vertex pairs with the highest similarity in order, we propose to use
the priority queue PQUEUE that stores vertex pairs (11, 11’) E V X V’
and their similarities S(11,11’ PQUEUE supports the following
operations:

' Insert: insert a vertex pair (11, 11’) E V X V and its similarity 5(11,
11’) into PQUEUE.

' Get: get the vertex pair (11, 11’) with the highest similarity in
PQUEUE.

' Pop: delete the vertex pair (11, 11’) with the highest similarity from
PQUEUE.

We propose the following algorithm. We initialize PQUEUE as a
vertex pair (11, 11’) E V X V’ with the highest similarity and its simi—
larity 5(11, 11’ The algorithm iterates as follows. We first get the ver—
tex pair (11, 11’) with the highest similarity in PQUEUE and delete it
from PQUEUE. We then insert the vertex pair (11, 11’) into a set M”.
Let N (11) be a set of vertices adjacent to 11 E V. We next insert all
combinations of vertex pairs adjacent to 11 and 11’, i.e.
(x,x’) E N(11) >< N(11’), into PQUEUE, which is necessary to satisfy
constraint (ii) in the graph alignment. Considering constraint (i), we
insert only vertex pairs (x,x’) E N (11) X N(11’) into PQUEUE such
that (x,z) g M‘ for all z E V’ and (z, x’) g M‘ for all z E V. When
PQUEUE is empty, the algorithm stops. For accurate alignments,
the algorithm restarts from each vertex pair chosen among
those with top—k highest similarities, where k is a user defined
parameter; k is set to 10 in this study. The algorithm finally returns
the set of vertex pairs with the highest summation of similarities in
M”. The pseudocode of the algorithm is presented in Algorithm 1.

 

Algorithm 1 Chemical graph alignment for two compounds.

Suppose we are given a chemical graph G : (V, E,L). The first
fingerprint of a vertex 11 E V is obtained by collecting vertex labels
from N(11), adjacent vertices of 11, to create a string. The string is
then converted into a unique integer using a hash function, and it is
added to the fingerprint as a new element. The integer is also as—
signed to a new vertex label for 11. The same procedure is repeated T
times. As a consequence, we obtain a fingerprint of T elements per
vertex. The pseudocode of the WL procedure is presented in
Algorithm 2.

 

Algorithm 2 WL procedure for computing ﬁngerprints
for vertices in a graph. T is a user-deﬁned parameter for
deciding the number of iterations. g : 2* —> 2 is a hash
function that maps a string 5;, (11) to an integer such that
g(s;,(11)) : g(s;,(w)) if and only if 5;,(11) : 5;,(w).

 

 

1: function PACHA(G, G’)
2: Set K E V X V’ as a set of k vertex pairs with the top—k
highest vertex similarities
for each (11, 11’) E K do
Insert (11, 11’) and 5(11, 11’) into PQUEUE
M‘ <— (j) > Initialize MC
while PQUEUE is not empty do
Get (11, 11’) from PQUEUE and pop PQUEUE
M‘ <— M‘ U (11,11’)
for each (x,x’) E N(11) >< N(11’) do
10: if (x,z) g M‘ for Vz E V’ and (z, x’) ¢MC for
Vz E V then
11: Insert (x,x’) and s(x,x’) into PQUEUE if
s(x,x’) 5A —00
12: M <— M‘ if the score 2 5(11, 11’) is at its highest
ever (11,1/)EM‘
13: return M

PPFDIQY'PRJ

 

3.3 Vertex similarity function based on fingerprints

We propose to evaluate the similarity of each vertex pair in a graph
by computing the similarity between two fingerprints of the vertices
using the Weisfeiler—Lehman (WL) procedure (Shervashidze et (11.,
2011). A fingerprint defined as a binary vector is conceptually
equivalent to the set that contains elements 1' if the ith bit of the fin—
gerprint is 1, thus we use the set representation of fingerprints in this
paper.

1 function WLprocedure(G)
2 W(11)<—¢>forall11€V
3 Initialize [0(11) to 11’s vertex label L(11) for all 11 E V
4: for/7:1,...,Tdo
5 for each 11 E V do

6 Assign a multi—label M),(11) :: {£h_1(u);u E N(11)}

to 11

7: Sort elements in M;,(11) in the ascending order of
vertex labels and concatenate them into a string
5170/)

8: Set [17(11) :: g($;,(11)) as a new vertex label of 11

9: W01) <— W(”) U {(1701)}

10: return {W(11);11 E V}

 

Each vertex in the chemical graph has three types of labels: pri—
mary, secondary and tertiary labels in this study. We apply the WL
procedure to each label. Figure 2 shows an illustration of the WL
procedure. The fingerprint for a vertex 11 is defined as W(11), which is
the union of the resulting fingerprints for three labels.

Given two compound chemical graphs G : (V, E, L) and
G’ : (V’, E’,L’), we propose the following similarity function 5 : V
><V’ —> R for a vertex pair (11, 11’) using the corresponding finger—
prints W(11) and W(11’) generated by the WL procedure:

IW(U) D W(WI - . . . .
— f ’ l l 1
5(1) vi) .7  U WW,” 1 11spr1mary abe lsldentlca to
’ '_ 11’s primary label,
—00 otherwise.

The vertex similarity is computed by the Tanimoto (also known as
Jaccard) coefficient of fingerprints W(11) and W(11’) if 11’s primary label
is identical to 11”s primary label. Otherwise, the vertex similarity is set
to —00, which forces atom pairs with different primary labels to be
unmatched in the graph alignment between two compounds.

3.4 Graph alignment—based feature vector
The PACHA—based graph alignment enables us to assign one of
three alignment states: ‘aligned’, ‘generated’ and ‘eliminated’ to each
vertex pair, defined as follows: (i) aligned: 11 is aligned to 11’ if
(11, 11’) E M; (ii) generated: z is generated from 11’ if Elz, 11’ E V’ s.t. z
E N(11’), (11,11’) 6 M for any 11 E V; (iii) eliminated: z is eliminated
from 11 if Elz,11 E V s.t. z E N(11), (11,11’) 6 M for any 11’ E V’. Figure
1(a) shows an example of the three alignment states.

We represent a compound pair (G, G’) as a D—dimensional
non—negative integer vector Qpacha(G, G’) 6 ND using matching
vertex pairs in M. Considering the three alignment states, we define

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201um0q

9103 ‘0g anBnV uo ::

Metabolome—scale de novo path way reconstruction

i165

 

(i) Build a multi-label from adjacent vertices ®
ex) primary: {S,O,N},

secondary: {02, N2, 83}

tertiary: {02c, N2c, 83x}

(ii) Sort
ex) primary: N, O, S
secondary: N2, 83, 02 ®
tertiary: N2c, 83x, 02c
(iii) Add the vertex label as a prefix (iv) Map the label sequence to a unique value
ex) primary: C, N, O, S ex) prrmary: C: N, O, S a X
secondarymy “12183103 secondary. C1, N2, 83, 03 a X10

tertiary: C1c, N2c, 83x, 02c a X10y
tertiary: C10, N26, 33X, 020 (v) Assign the unique value as a new vertex label

Fig. 2. Updating a node label surrounded by double circle by aggregating
with neighboring labels in the WL procedure. The WL procedure is applied to
each label class of primary, secondary and tertiary labels

Qpacha(G, G’) as a combination of three sub—vectors: the aligned sub—
vector <I>"(G,G’), the generated sub—vector <I>g(G’) and the elimi—
nated sub—vector (1)9(G).

The aligned sub—vector <I>"(G, G’) counts the number of vertices
11 aligned to vertices 11’ for each pair of labels L(11) and L’(11’). Let
Fa(11, 11’) be a local vector for <I>"(G, G’) and each element of F"(11, 11’)
be the following indicator function:

1 if 11 is aligned to 11’ With L(11) and L(11’),
2%. 11) 2:

0 otherwise.

The aligned sub—vector is defined as <I>"(G, G’) : 2(1)“) EVX V, F"(11, 11’).

The generated sub—vector (Pg (G’) counts the number of vertices z
generated from vertices 11’ for each pair of labels L’(z) and L’ Let
Fg(z, 11’) be a local vector for <I>g(G, G’) and each element of Fg(z, 11’)
be the following indicator function:

1 if z is generated from 11’ with L’ (z) and L’ (11’),

g I .7

f (z’v) ’ {0 otherwise.
The generated sub—vector is defined as <I>g(G’) : EMINEer
Fg (z, 11’).

The eliminated sub—vector (1)8(G) counts the number of vertices z
eliminated from vertices 11 for each pair of labels L(z) and L(11). Let
F8 (z, 11) be a local vector for (1)8(G) and each element of F (z, 11) be
the following indicator function:

1 if z is eliminated from 11 with L(z) and L(11),

f"(zrv) I: {

0 otherwise.

The eliminated sub—vector is defined as CI>e(G) : ZWKVXV Fe (z, 11).

Finally, Qpacha(G, G’) is constructed as Qpacha(G, G’) :
(MG,G')T,q>g(c')i,q>e(G)T)T, which is referred to as ‘PACHA
descriptor’ in this study. We built the PACHA descriptors using 68
tertiary labels, resulting in 3567—dimensional integer vectors.
Figure 1a represents an example of the PACHA descriptor.

3.5 Predictive models for metabolic pathway
reconstruction

We propose to apply the above PACHA descriptor to the enzymatic
reaction—likeness prediction and reaction annotation, Which are im—
portant applications for metabolic pathway reconstruction.

Given two compound chemical graphs G and G’, we consider a
predictive model defined as the linear function f (G, G’) :
WTCDPKChJG, G’), Where W 6 RD is a weight vector. In the case of en—
zymatic reaction—likeness prediction, the weight vector W is esti—
mated such that it can correctly predict the enzymatic reaction—
likeness of compound—compound pairs. In the case of reaction

annotation, the weight vector W is estimated such that it can cor—
rectly predict a specific reaction annotation class (i.e. EC sub—sub—
class or PIERO term in this study) of the compound—compound
pairs.
Given a collection of compound—compound pairs and their
labels (Qpacha(Gi, Gi),y,-,-), where 31,; 6 {+1, —1}(i : 1, ,n,/' 2 1,
. ,n,i 54 j) and n is the number of compounds in the learning set,
we optimize the weight vector W by L1—regularized linear support
vector machine (L1SVM) formulated as

n
m1nrrwrrr+ c:{
i:1

where P,,- : max {1 — yiiWTCIDPKCha(G,-, Gi), 0}2, C is a hyper—
parameter and  - Ill is L1 norm (the sum of absolute values in the

i—1 n
2P1," + 2 P11},

,:1 1:141

vector). L1—regularization has an effect of making the weights of unin—
formative features zeros Without loss of classification accuracy, Which
enables to extract important features characteristic of each task.

4 Results

4.1 Performance evaluation of the enzymatic reaction—
Iikeness prediction

We tested the proposed PACHA descriptor for its ability to predict
enzymatic reaction—likeness of compound—compound pairs from
their chemical structure data. We compared this With previously
developed chemical descriptors and graph alignment methods:
CDK Extended fingerprint, CDK GraphOnly fingerprint, CDK
Hybridization fingerprint, EState fingerprint, KlekotaRoth finger—
print, MACCS fingerprint, PubChem fingerprint, AE descriptor,
KCF—S descriptor and SIMCOMP alignment (see Section 2 for more
details). First, we focused on analysis of the isomer—enriched reac—
tion data to validate the ability of PACHA to solve the issue of
regioisomers.

We performed the following five—fold cross—validation. First, we
randomly split the compound—compound pairs in the gold standard
reaction data into five subsets of roughly equal sizes, Where known
substrate—product pairs were regarded as positive examples and the
other compound—compound pairs were regarded as negative ex—
amples. Second, we took each subset as a test set and the remaining
four subsets as a training set. Third, we learned a predictive model
based only on the training set. Finally, we evaluated the prediction
accuracy based on the prediction scores of compound—compound
pairs in the test set over the 5—folds.

We evaluated the prediction performance using the receiver
operating characteristic (ROC) curve, Which is a plot of true—positive
rates as a function of false—positive rates, and the precision—recall
(PR) curve, Which is a plot of precision (positive predictive value) as
a function of recall (sensitivity). We summarized the performance by
the area under the ROC curve (AUC) score, Where 1 is perfect infer—
ence and 0.5 is random inference, and the area under the PR curve
(AUPR) score, Where 1 is perfect inference and the ratio of positive
examples in the gold standard data is random inference.

The third column of Table 1 shows the resulting AUC and AUPR
scores and their standard deviations (SDs) in performing 5—fold
cross—validation experiments for the isomer—enriched reaction data.
It was observed that PACHA worked best among the graph align—
ment—based methods and KCF—S worked the best among the descrip—
tor—based methods. In total, PACHA outperformed the previously
developed methods in terms of higher AUC and AUPR scores. These
results suggest that PACHA can capture the important features of

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201um0q

9103 ‘0g anBnV uo ::

i166

Y. Yamanishi et aI.

 

Table 1. Performance evaluation of the enzymatic reaction-likeness prediction for isomer-enriched reaction data and all reaction data

 

 

 

Method Input feature vector Isomer—enriched reaction data All reaction data
Descriptor Graph alignment AUC : SD AUPR : SD AUC : SD AUPR : SD
based based
Random — — 0.5000 0.0306 0.5000 0.0204
CDK extended Yes — 0.7112 : 0.0065 0.0840 : 0.0021 0.6918 : 0.0042 0.0594 : 0.0001
CDK graph—only Yes — 0.7243 : 0.0080 0.0842 : 0.0042 0.7158 : 0.0002 0.0614 : 0.0005
CDK hybridization Yes — 0.7061 : 0.0055 0.0792 : 0.0026 0.7013 : 0.0010 0.0502 : 0.0006
E—state Yes — 0.5455 : 0.0021 0.0607 : 0.0057 0.6046 : 0.0012 0.0346 : 0.0002
KlekotaRoth Yes — 0.5702 : 0.0011 0.0512 : 0.0013 0.6028 : 0.0029 0.0354 : 0.0001
MACCS Yes — 0.7001 : 0.0033 0.0750 : 0.0007 0.6830 : 0.0004 0.0504 : 0.0006
PubChem Yes — 0.6945 : 0.0018 0.0744 : 0.0028 0.7199 : 0.0008 0.0538 : 0.0001
AE Yes — 0.8476 : 0.0012 0.1521 : 0.0033 0.8853 : 0.0001 0.2110 : 0.0004
KCF—S Yes — 0.9340 : 0.0013 0.2815 : 0.0062 0.9654 : 0.0006 0.4050 : 0.0060
SIMCOMP — Yes 0.9222 : 0.0018 0.2533 : 0.0014 0.9470 : 0.0001 0.3127 : 0.0004
PACHA — Yes 0.9401 : 0.0004 0.3205 : 0.0052 0.9617 : 0.0001 0.3880 : 0.0005
PACHA +KCF—S Yes Yes 0.9454 : 0.0006 0.3224 : 0.0044 0.9741 : 0.0003 0.4711 : 0.0061

 

isomer—related chemical changes in reactions, While other methods
can not capture isomer—specific chemical changes.

Next, we tested the PACHA descriptor on its ability to predict
enzymatic reaction—likeness using the ‘all’ reaction data that con—
tains not only isomer—enriched reactions but also other enzymatic re—
actions. We performed Five—fold cross—validation experiments in a
similar manner as the previous experiments.

The fourth column of Table 1 shows the resulting AUC and
AUPR scores and their SDs in performing the Five—fold cross—valid—
ation experiments of the enzymatic reaction—likeness prediction for
all reactant pair data. It was also observed that PACHA worked the
best among graph alignment—based methods and KCF—S worked the
best among the descriptor—based methods. Thus, we attempted to
combine PACHA and KCF—S by vector concatenation, Which we call
‘PACHA + KCF—S’. As a result, PACHA + KCFS worked much bet—
ter than other individual methods, implying that descriptor— and
graph alignment—based methods are complementary to each other
and the integration of both approaches is useful in practice.

4.2 Analysis of chemical changes in isomer—related
reactions

We examined the detailed prediction results of the cross—validation
experiments and analyzed the relationship With chemical changes in
isomer—related reactions. We then compared PACHA (the best
among graph alignment—based methods) and KCF—S (the best among
descriptor—based methods).

Figure 3 shows some examples of the predicted chemical trans—
formations grouped by isomeric compounds. Most positive ex—
amples (a1, b1 and c1) were predicted correctly by KCF—S and
PACHA, Whereas some negative examples (a2, a3, b2, b3, c2 and
c3) were predicted differently. Pairs a2, b2 and c2 were predicted as
negative by KCF—S and positive by PACHA. Although these pairs
were not known substrate—product pairs, these chemical changes
were already known in other compounds, Which occurs only once in
each pair. Therefore, we can conclude that these pairs represent po—
tential reactions that are likely to occur.

Conversely, pairs a3, b3 and c3 were predicted negative by
PACHA and positive by KCF—S. If these chemical conversions were
to occur, at least two reactions would be needed for each pair. Pair
a3, representing the chemical change from pinocarveol (C11941) to
myrtenal (C11939), would require dehydroxylation and hydroxyl—
ation reactions and the isomerization of the pi—conjugated system.

Pair b3, genistein (C06563) and vitexin (C01460), would require
not only C—glycosylation but also in the rearrangement of the ring
attachment. Pair c3, benzo[e]pyrene (C14435) and benzo[a]pyrene—
7,8—epoxide (C14850), would also require at least two reactions, not
only an epoxydation but also the rearrangement of the ring struc—
ture. Thus, we can conclude that these pairs do not represent single
reactions.

4.3 Performance evaluation of reaction annotation and
extraction of reaction class—specific features

We investigated the usefulness of the proposed PACHA descriptor
for reaction annotation. As enzymatic reaction characteristics, we
used EC sub—subclasses and PIERO terms. Reaction annotation is
generally performed by predicting potential EC sub—subclasses or
PIERO terms directly from differential chemical structures of com—
pound—compound pairs, Which is referred to as ‘direct approach’.
Here, we proposed a two—step approach that first performs enzym—
atic reaction—likeness prediction for compound—compound pairs,
followed by the reaction annotation for only the predicted sub—
strate—product pairs, Which is referred to as the ‘filtering approach’.
Because PACHA+KCF—S worked the best in the cross—validation
experiments for enzymatic reaction—likeness prediction, we focused
on the use of PACHA + KCF—S and made a performance comparison
between the previous direct approach and our proposed filtering
approach.

We performed the following Five—fold cross—validation. First, we
randomly split compound—compound pairs in the gold standard re—
action data With an EC sub—subclass (respectively, PIERO term) into
five subsets of roughly equal sizes, Where compound—compound
pairs With the EC sub—subclass (respectively, PIERO term) were re—
garded as positive examples and other compound—compound pairs
were regarded as negative examples. Second, we took each subset as
a test set and the remaining four subsets as a training set. Third, we
learned an EC—specific (respectively, PIERO—specific) predictive
model based only on the training set. Fourth, we evaluated the
prediction accuracy based on the prediction scores of compound—
compound pairs in the test set over the Five—folds. Finally, we re—
peated the above processes for all EC sub—subclasses (respectively,
all PIERO terms).

Figures 4 and 5 show the resulting AUC and AUPR scores for EC
sub—subclasses and PIERO terms, respectively. In both cases, our pro—
posed filtering approach outperformed the previous direct approach

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201um0q

9103 ‘0g anBnV uo ::

Metabolome—scale de novo path way reconstruction

i167

 

(a) CroHrsO ' CIOHMO

(1) OH ,0

known pair

positive by PACHA 6

positive by KCF-S 5:13.113 a1 CH”:
011533 C11939

(2)  0":

unknown pair 0 0

positive by PACHA H

negative by KCF-S 32 A
H36 cu, 11,1: CH3
Cllilﬁ 611333

 H26 /0

unknown pair H0

negative by PACHA CH H

positive by KCF-S 6H3“ a3 51.31113:

£11941

c1193!

 

 Creroos ' CerzoOro

Cease:

H0

C135 56‘!

COJ‘HSD

 

(c) Conrz ' Conrzo

a

C07535

cnrsas

C1434!

C111“

.

Guns C1435“

Fig. 3. Examples of predicted chemical transformations grouped by isomeric compounds, with compositional formula (a) C10H150 - C10H140, (b) C15H1005 -
C21H20010 and (c) C20H12 - C20H120. Vertically aligned compounds, e.g. C11938, C11415 and C11491 in (a), are regioisomers. Pairs a1, b1 and c1 are known sub-
strate—product pairs for which the predictions were correct for KCF-S and PACHA. Pairs a2, b2 and c2 are negative examples and were predicted negative by KCF-
S and positive by PACHA. Pairs a3, b3 and c3 are also negative examples and were predicted negative by PACHA and positive by KCF-S

AUC for EC sub—subclasses

AUPR for EC sub—subclasses

Boxplot representation for EC sub—subclasses

 

Lo

AUC
CA as
r r

02
r

on
r

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

c 0
AW. 0.. We 0 images”. —' —' E
o o 0 °
to 8 0° .
o D $ 0 $0 0 —i— .
o m. _ A o A m. - —v— r
0 o ‘ a 0 r r
A A I I
c . r
A A a r .
A % A r .
g — o if oa A“, c; 449A A o 3 I I
m A a A 5A 8 8° A 0 AZ? 0% A AA I
or
1 A: o A A ‘5 A A 9 An 7
3 V. _ Aﬁ A Q A. m A 8 V.
c A A A o A A a A 0
93A 0 o °A°o ° ° 6’ AA A .
e A o 8 A 0 ° A A AA I
g _ o A 0 ° A 9° 3 :
O 0 m I
oo o A o 0 °., 0 : :
o o a A o -J-—
c c
c' ' c'
0 Direct approach 0 Direct approach
A Filtering approach A Filtering approach
I I I I I I I I I I I I I I
o 2o 4o so so o 2o 4o so so AUCdirect AUCliltering AUPR direct AUPRliltering

EC sub—subclass index

EC sub-subclass indm

Fig. 4. AUC and AUPR scores for EC sub-subclasses using previous direct approach and our proposed filtering approach

 

Lo

AUC
CA
I

02
r

on
r

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

AUC tor PIERO terms AUPR tor PIERO terms Boxplot representation for PIERO terms
"' ' "' E —=p—
+
A —.—
g _ o A A g -w-— r
c o o A 0 I I
A A 1 1
A A A - r
«a. _ f A", a M ° 0 A A A AA #529 w. I I
c ‘ 2 ° A A AA Ac? ° 0 1
A ° A ADA! ° 9 a? I
E (AA 0 A A A A A M. o g o a A “'0 E
3 V AA o no a A 9 AA AA 939‘ 9 <r
d _ o “no qt A &)A 4E6 A 02 o d
o A o o o ‘49 ° r
0 AA A %A a f” o r
A A A a 0A A at A A 1 :
3 - o a 3 % ° ‘A ° ° o g I I
f ° 0 0 ° ° . __L_
o 0 0 0° _._
0. _ 0.
c c
approach
gapproach
I I I | I I I I | I I I I I I I
o 2o 4o so so 1oo o 2o 4o so so 1oo AUC direct AUC lilterin AUPR direct AU PR lilterin
9 9

Fig. 5. AUC and AUPR scores for PIERO terms using previous direct approach and our proposed filtering approach

PIERO term index

PIERO term indm

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Iduq 11101} pap1201um0q

9103 ‘0g anBnV uo ::

i168

Y. Yamanishi et aI.

 

Table 2. Examples of correctly assigned reaction annotations

 

 

 

Direct Filtering
AUC AUPR AUC AUPR
EC sub—subclasses
EC1.3.5 0.9317 0.7782 0.957 0.8364
EC5.1.3 0.9988 0.7673 0.9982 0.808
EC1.8.1 0.965 0.7564 0.9906 0.7626
EC2.7.4 0.997 0.605 0.9982 0.7302
EC6.2.1 0.9852 0.6583 0.9916 0.715
PIERO terms
Diesteriﬁcation 0.9912 0.3795 0.9989 0.8496
Transacylation 0.9983 0.6753 0.9989 0.8467
Sulfonation 0.9978 0.6545 0.9986 0.8301
Diphosphorylation 0.995 0.4714 0.9987 0.7836
Lipoxygenation 0.9973 0.6307 0.9985 0.7522

 

The EC and PIERO annotations are listed in the descending order of the
AUPR scores by the ﬁltered approach.

in terms of higher AUC and AUPR scores. These results suggest that,
in practice, comprehensive filtering of compound—compound pairs by
enzymatic reaction—likeness is useful for more accurate reaction
annotation.

Table 2 shows the examples of respective reaction annotations
predicted by the direct and filtering approaches. The filtering ap—
proach worked better than the direct approach in terms of AUC and
AUPR. The best performance was achieved for EC1.3.5 ‘oxidore—
ductase reactions acting on the CH—CH group of donors With a
quinone or related compound as an acceptor’ as EC sub—subclasses
and ‘diesterification’ as PIERO. Regardless of AUC or AUPR, the
predictive values were generally higher in PIERO than in EC. This
result reﬂects the fact that EC numbers were given to full reaction
equations, Whereas PIERO terms were given to substrate—product
pairs.

Table 3 shows several examples of the extracted vector features
in PACHA and KCF—S that are significant to EC and PIERO. Note
that the predictive model used in this study (i.e. L1SVM) has the
ability of feature extraction. Interestingly, the extracted PACHA
features correspond to the chemical changes that occurred in the
preserved atoms. For example, the feature ‘a:O2x:O7x’ repre—
sents the preserved oxygen atom that changes from a cyclic ether to
a cyclic ester, Which is one of the typical EC1.1.1 reactions that
causes dehydrogenation of sugars to yield lactone sugars. This
feature was a reasonably important and characteristic feature of
EC1.1.1 and ‘dehydrogenation’. Conversely, the extracted fea—
tures from descriptors—based methods (e.g. KCF—S) were generally
difficult to interpret because descriptor—based methods cannot dis—
tinguish the relationships between preserved atoms and their
chemical changes. All results can be found at http://WWW.bioreg.
kyushu—u.ac.jp/labo/systemcohort/pacha/.

4.4 Novel prediction

Finally, we conducted a comprehensive prediction of enzymatic reac—
tion—likeness for all possible compound pairs, With the exception of
known substrate—product pairs. We trained a predictive model using
all known substrate—product pairs in the gold standard data (10 852
pairs retrieved from KEGG as of December 2012) and applied the
model to all possible uncharacterized compound—compound pairs (30
719 540 pairs) for Which pathways and reaction characteristics were
not known. PACHA and PACHA+KCFS predicted 54 919 and 28

Table 3. Examples of extracted vector features significant to re-
spective annotations

 

 

Subvector Feature Weight
EC sub—subclasses and PACHA
EC1.1.1 Aligned a:O2x: 07x 2.5502
EC1.4.3 Aligned a:C1b =C4a 2.1923
EC3.1.3 Aligned a:01a=02b 1.9833
EC3.5.1 Aligned a:C5a=C6a 1.8904
EC4.1.1 Generated g:C6a—C8y 1.8426
PIERO terms and PACHA
Dehydrogenation Eliminated e:Clz—O7x 2.488 1

Dehydrogenation Aligned a:O2x = 07x 2.4666

Dehydrogenation Generated g:Clz—O7x 2.4621

Monooxygenation Eliminated e:C1b—C8x 2.0967
Deamination Aligned a:C 1 b = C4a 2.0079
EC sub—su bclasses and KCF—S
EC1.2.7 Common C1c—01a 1.7583
EC3.1.2 Decreased O—C—S 1.3214
EC4.2. 1 Increased C8y—C8x—N4x 1 .2998
EC1.14.13 Common C8y—O7x 1.196
EC2.5.1 Common C1b—C1b—N1a 1.0245
PIERO terms and KCF—S
Hydration Common C1y—C1b—O2b 1.5443
Oxidoreduction Increased C2b—C1b—S2a 1.4682
Oxidoreduction Increased C1y—N1 b— C2c 1 .3741
Decarboxylation Decreased C1a—C1c—N1a 1.2947
Oxidoreduction Decreased C2c—C1b—01a 1.2013

 

 

 I R0744?

    

on CH3 011cm
H3116! I CHJ Hscm'l 1 CH3
Hrs Ha I R07788 ﬂ
.3 ' ' O
HO“  L) '51

616251 C157")?

Fig. 6. One of the newly predicted pathway supported by both PACHA and
PACHA+ KCF-S, as well as the recent KEGG release

192 compound pairs as potential substrate—product pairs, respect—
ively. We confirmed the validity of 672 compound pairs predicted by
PACHA and 683 compound pairs predicted by PACHA+KCF—S
using independent resources such as recent scientific literatures and
the latest databases (KEGG as of December 2014).

Figure 6 shows an example of the newly predicted pathways by
PACHA and PACHA + KCF—S methods, Which are supported by the
latest database information. Note that the reactions in the pathway
were not used in the learning set for constructing the predictive
model. These reactions and compounds were not in the January
2014 release of KEGG but were recently added to the December
2014 release. This pathway represents the biosynthesis of

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Iduq 11101} pap1201um0q

9103 ‘0g isanV uo ::

Metabolome—scale de novo path way reconstruction

i169

 

brassinosteroids, important steroid hormones that regulate plant de—
velopment and physiology (Ohnishi et (11., 2006). This pathway was
successfully reconstructed by our proposed methods but was not re—
constructed by previous methods.

5 Discussion

We developed a novel method for supervised de no110 metabolic
pathway reconstruction With an improved graph alignment algo—
rithm called PACHA. Our proposed PACHA enabled us to detect
regioisomer—sensitive connectivities between aligned substructures
of two compounds. The novelty of our proposed method lies in the
detection of a unique graph alignment, scalability for analyzing a
vast amount of compounds on a metabolome—scale and applicability
to many tasks in metabolic pathway reconstruction. We showed the
usefulness of the PACHA descriptors for enzymatic reaction—likeness
prediction and reaction annotation With a sparsity—induced
classifier.

This study addressed the importance of the distinction of
regioisomers for metabolic pathway analysis. Although a popular
approach for representing compounds is to use chemical descriptors
that deal With many small chemical substructures, they cannot cor—
rectly consider the substructure connectivity. Thus, the comparison
of two chemical descriptors is insufficient to generate atom—atom
mapping, which makes it impossible for all descriptor—based meth—
ods to describe sensitive chemical changes in a single enzymatic reac—
tion, as illustrated in Figure 1.

SIMCOMP (Hattori et (11., 2003), the most related previous
graph—based method, was designed for searching similar compounds
in databases by allowing some small common substructures. The
common procedure in SIMCOMP and PACHA is to generate an as—
sociation graph, Where the vertices (association nodes) represent the
atom—atom pairs of two compounds and obtain common sub—
graph(s) considering adjacency. The difference between SIMCOMP
and PACHA lies in the definition of ‘adjacency’ in the association
graph. PACHA defines the association nodes as being adjacent to
each other only When the corresponding atoms are adjacent in both
compounds; therefore, only one common subgraph occurs and the
second common subgraph is not allowed. SIMCOMP defines the as—
sociation nodes to be adjacent either When the corresponding atoms
are adjacent in both compounds or When they are not adjacent in
both compounds. The adjacency in the SIMCOMP association
graph often generates multiple common subgraphs, Which are inte—
grated afterwards; however, in some cases, the integrated subgraph
contains many gaps.

Having such gaps is not an issue when finding similar com—
pounds, e.g. for pharmaceutical purposes. However, it is of crucial
importance for metabolic pathway analysis, because most reactions
generate or eliminate only a feW chemical bonds. Therefore, the
number of gaps affects the prediction accuracy of enzymatic reac—
tion—likeness. Our proposed PACHA algorithm solved this problem
successfully as demonstrated by significant improvement of the de
no110 pathway reconstruction, especially in the analysis of isomer—
enriched data. Future extensions would involve the detection of fre—
quent substructure changes and stereoinversions, Which requires
more sophisticated tuning of PACHA.

Funding

This work was supported by MEXT/ISPS Kakenhi (25108714 and
24700140) and the JST PRESTO program (MEXT: the Ministry of
Education, Culture, Sports, Science and Technology of Japan; ISPS: the Japan

Society for the Promotion of Science; JST: the Japan Science and Technology
Agency). This work was also supported by the JST/MEXT Program to
Promote the Tenure Track System and Kyushu University Interdisciplinary
Programs in Education and Projects in Research Development.

Conﬂict of Interest: none declared.

References

Afendi,F. et al. (2012) KNApSAcK family databases: integrated metabolite-
plant species databases for multifaceted plant research. Plant Cell Physiol,
53, e1.

Bono,H. et al. (1998) Reconstruction of amino acid biosynthesis pathways
from the complete genome sequence. Genome Res., 8, 203—220.

Boyer,F. and Viari,A. (2003) Ab initio reconstruction of metabolic pathways.
Bioinformatics, 19, ii26—ii34.

Chen,B. et al. (2009) PubChem as a source of polypharmacology. I. Chem.
Inﬁ Model, 49, 2044—2055.

Darvas,F. (1988) Predicting metabolic pathways by logic programming.
I. Mol. Graphics, 6, 80—86.

Durant,J. et al. (2002) Reoptimization of MDL keys for use in drug discovery.
I. Chem. Inf. Comput. Sci., 42, 1273—1280.

Ellis,L. et al. (2008) The University of Minnesota pathway prediction system:
predicting metabolic logic. Nucleic Acids Res., 36, W427—W432.

Faulon,I. and Sault,A. (2001) Stochastic generator of chemical structure. 3. re—
action network generation. I. Chem. Inf. Comput. Sci., 41, 894—908.

Greene,N. et al. (1999) Knowledge-based expert systems for toxicity and me—
tabolism prediction: DEREK, StAR and METEOR. SAR QSAR Environ.
Res., 10, 299—314.

Hall,L. and Kier,L. (1995) Electrotopological state indices for atom types: a
novel combination of electronic, topological, and valence state information.
I. Chem. Inf. Comput. Sci., 35, 1039—1045.

Hattori,M. et al. (2003) Development of a chemical structure
comparison method for integrated analysis of chemical and genomic
information in the metabolic pathways. I. Am. Chem. Soc., 125, 11853—
11865.

Hatzimanikatis,V. et al. (2005) Exploring the diversity of complex metabolic
networks. Bioinformatics, 21, 1603—1609.

Heath,A. et al. (2010) Finding metabolic pathways using atom tracking.
Bioinformatics, 26, 1548—1555.

Kanehisa,M. et al. (2014) Data, information, knowledge and principle: back
to metabolism in KEGG. Nucleic Acids Res., 42, D199—D205.

Klekota,I. and Roth,F.P. (2008) Chemical substructures that enrich for biolo-
gical activity. Bioinformatics, 24, 2518—2525.

Kotera,M. et al. (2013a) KCF—S: KEGG chemical function and substructure
for improved interpretability and prediction in chemical bioinformatics.
BMC Syst. Biol., 7(Suppl 6), 52.

Kotera,M. et al. (2013b) Supervised de novo reconstruction of metabolic
pathways from metabolome—scale compound sets. Bioinformatics, 29,
i135—i144.

Kotera,M. et al. (2014) PIERO ontology for analysis of biochemical trans-
formations: effective implementation of reaction information in the IUBMB
enzyme list. I. Bioinform. Comput. Biol., 12, 1442001.

McDonald,A. and Tipton,K. (2014) Fifty—ﬁve years of enzyme classiﬁcation:
advances and difﬁculties. FEBS I., 281, 583—592.

Mitchell,J. et al. (2014) Development and in silico evaluation of large—scale
metabolite identiﬁcation methods using functional group detection for
metabolomics. Front. Genet., 5, 237.

Moriya,Y. et al. (2010) PathPred: an enzyme-catalyzed metabolic pathway
prediction server. Nucleic Acids Res., 38, W138—W143.

Nakabayashi,R. and Saito,K. (2013) Metabolomics for unknown plant metab—
olites. Anal. Bioanal. Chem., 405, 5005—5011.

Nakamura,M. et al. (2012) An efﬁcient algorithm for de novo predictions of
biochemical pathways between chemical compounds. BMC Bioinformatics,
13, 58.

Newman,D. and Cragg,G. (2012) Natural products as sources of new drugs
over the 30 years from 1981 to 2010.]. Nat. Prod., 75, 311—335.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Iduq 11101} pap1201um0q

9103 ‘0g isanV uo ::

i170

Y. Yamanishi et al.

 

Ohnishi,T. et al. (2006) C—23 hydroxylation by arabidopsis cyp90c1 and
cyp90d1 reveals a novel shortcut in brassinosteroid biosynthesis. Plant Cell,
18, 3275—3288.

Ramautar,R. et al. (2013) Human metabolomics: strategies to understand
biology. Cur. Opin. Chem. Biol, 17, 841—846.

Shervashidze,N. et al. (2011) Weisfeiler—Lehman graph kernels. ]. Machine
Learning Res., 12, 2539—25 61.

Sreekumar,A. et al. (2009) Metabolomic proﬁles delineate potential role for
sarcosine in prostate cancer progression. Nature, 457, 910—914.

Steinbeck,C. et al. (2003) The chemistry development kit (CDK): an open-
source java library for chemo— and bioinformatics. ]. Chem. Inf. Comput.
Sci., 43, 493—500.

Talafous,J. et al. (1994) A dictionary model of mammalian xenobiotic metab—
olism.]. Chem. Inf. Comput. Sci., 34, 1326—1333.

Tanaka,K. et al. (2009) Metabolic pathway prediction based on inclusive rela-
tion between cyclic substructures. Plant Biotech., 26, 45 9—468.

Toya,Y. and Shimizu,H. (2013) Flux analysis and metabolomics for systematic
metabolic engineering of microorganisms. Biotechnol. Adu, 31, 818—826.

112 /3.10'speum0[p1q1x0'sopBHJJOJuioiq/ﬁduq 11101} papBOIHMOG

91oz ‘Og isnﬁnv uo ::

