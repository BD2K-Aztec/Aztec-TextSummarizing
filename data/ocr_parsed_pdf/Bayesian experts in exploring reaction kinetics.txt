Vol. 26 E005 2010, pages i589—i595
doi: 1 0. 1 093/bioinformatics/btq389

 

Bayesian experts in exploring reaction kinetics of

transcription circuits

Ryo Yoshida*, Masaya M. Saito, Hiromichi Nagao and Tomoyuki Higuchi

The Institute of Statistical Mathematics, Research Organization of Information and Systems, 10—3 Midori—cho,

Tachikawa, Tokyo, 190—8562, Japan

 

ABSTRACT

Motivation Biochemical reactions in cells are made of several
types of biological circuits. In current systems biology, making
differential equation (DE) models simulatable in silico has been
an appealing, general approach to uncover a complex world of
biochemical reaction dynamics. Despite of a need for simulation-
aided studies, our research field has yet provided no clear answers:
how to specify kinetic values in models that are difficult to measure
from experimental/theoretical analyses on biochemical kinetics.
Results: We present a novel non-parametric Bayesian approach to
this problem. The key idea lies in the development of a Dirichlet
process (DP) prior distribution, called Bayesian experts, which
reflects substantive knowledge on reaction mechanisms inherent in
given models and experimentally observable kinetic evidences to
the subsequent parameter search. The DP prior identifies significant
local regions of unknown parameter space before proceeding
to the posterior analyses. This article reports that a Bayesian
expert-inducing stochastic search can effectively explore unknown
parameters of in silico transcription circuits such that solutions of
DEs reproduce transcriptomic time course profiles.

Availability: A sample source code is available at the URL
http://daweb.ism.ac.jp/~yoshidar/lisdas/

Contact: yoshidar@ism.ac.jp

1 INTRODUCTION

Cells can sense many different environmental signals, and respond
to extraneous stimuli by switching activation/inactivation of speciﬁc
molecules, such as transcription factors, via several types of
biological circuits. Kinetic biochemical modelling of such reaction
circuits (often called biochemical reaction networks) using DEs
realizes experiments in silico to enhance our understanding of
the complex dynamic systems (Alon, 2006; Chen et al., 2004;
Wilkinson, 2006). It enables us to test a plausibility of current
knowledge and hypothetical models on biological circuits and to
create new ﬁirther models when inconsistencies arise in simulation,
domain knowledge and experimentally observed quantitative data
(Yoshida et al., 2008).

Despite of a growing need for simulation-aided studies on
bio-pathways, some fundamental issues prevent us from drawing
their full potentials. One critical issue addressed here is related
to uncertainty in speciﬁed kinetic parameters of models: in
many cases, we have no clear answer on how to specify
kinetic values and initial conditions on simulations because
biochemical reaction kinetics differ depending on a cell-by-cell

 

*To whom correspondence should be addressed.

basis and intra-/extracellular environments such as temperatures,
presence/absence of biochemical components in speciﬁc tissues.

With the aim to explore kinetic parameters in in silico biological
circuits that make solutions of DEs ﬁt experimental data, a range
of advanced technologies have appeared in the last several years of
computational systems biology, involving genetic algorithm (GA;
Kikuchi et al., 2003; Kimura et al., 2004; Koh et al., 2006),
sequential Monte Carlo (SMC; Nagasaki et al., 2006; Nakamura
et al., 2009), MCMC-driven parameter search methods (Finkenstadt
et (11., 2008) and also gradient descent algorithms (Cao et al., 2008;
Fujarewicz et (11., 2007; Yoshida et al., 2008). Quantitative data, such
as transcriptomic proﬁles and protein expression values, are usually
measured over times. In general, a Bayesian statistical method
involves all the preceding methods as a uniﬁed framework: any
estimation tasks are treated as evaluations of posterior distributions
in which prior distributions embodying our prior belief on reaction
kinetics are adapted to experimental data using likelihood functions.
As demonstrated later, however, the practical relevance of the
existing approaches remains far below what practical analyses
require. Our view on this is that such a low performance depends
highly on the lack of effective biochemical kinetic priors.

This article presents a previously unexplored class of prior
distributions, called Bayesian experts on biochemical reaction
kinetics. The key notion of our approach can be found in the
construction of Dirichlet process (DP) prior distribution (Blei et al.,
2005; Escobar et al., 1995; MacEachem et al., 1998) whose base
measure G0(6) is modelled by a mixture of m Gibbs distributions:

m
Oli ¢i(9)
00(9)=ZZeXp<—T (1)
1:1
with mixing rates on (i: l, ...,m), temperature T > 0 and partition

functions Z. The m potential functions ¢,~(6) deﬁned on unknown
parameters 6 reﬂect substantive knowledge on reaction kinetics for
a given model such that regions of interest in the parameter space
are prescribed prior to a posterior analysis. In many applications, we
are able to collect several kinetic evidences on such local regions
by observing temporal patterns of experimental data. For instance,
rates of increasing and/or decreasing to which DE solutions have to
match can be guessed in advance by observing steepness of relevant
local patterns of given time course data. Alternatively, maximum and
minimum levels of gene expression data provide a helpful clue to
determinations of steady-state levels to which a transcription circuit
model reaches in equilibrium. The Gibbsian mixture distribution,
enabling Bayesian expert system in kinetic explorations, aggregates
such m constraint conditions on the kinetic parameters that are
induced automatically in light of experimental data and reaction
speeds inherent in given models.

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/Iicenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papcolumoq

9103 ‘{g anﬁnv 110::

R. Yoshida et al.

 

This article describes our Bayesian experts, focusing on key
examples of speciﬁc types of in silico transcription circuits.
Transcription factor activities are modelled on Hill functions and
mass action kinetics (Alon, 2006; Wilkinson, 2006) as described in
Section 2. To emphasize the ability of the Bayesian expert prior, we
explore unknown parameters using a simpliﬁed stochastic search
algorithm without using more advanced computational techniques.
The DP prior with additional technical details is introduced in
Section 3. Experimental results appear in Section 4, demonstrating
drastic efﬁciency gains from uses of the Bayesian experts and
a benchmark on computational times. Section 5 concludes with
more generalization of our approach. Supplementary Material and a
sample program—called LiSDAS (Life Science Data Assimilation
Systems)—are accessible at the Supplementary web site. LiSDAS
features some basic functions to explore kinetic parameter values
for given data and a model. The user can develop biological circuit
models with the LiSDAS model construction ﬁle in place.

2 MODEL AND INVERSION ANALYSIS

2.1 Transcription regulatory circuits

The proposed Bayesian method will be derived and described, in
later sections, with examples on analyses of transcriptional reaction
kinetics. Before that, we brieﬂy summarize speciﬁc forms of the
DEs making up elements of the transcription circuit models.

2.1.1 Transcription Control of transcription factor-inducing gene
expressions is a key regulatory mechanism in cells. Transcription
factors can sense external stimuli of cells by mediations of
signal transduction pathways. A transcription factor—activated by
the transmitted signals—acts as either activator or repressor in
transcription processes of speciﬁc target genes with many recruited
enzymatic activities at the promoter regions. One commonly used
DE for describing the transcriptional process is Hill ﬁmction which
is in theory derived by considering an equilibrium binding of a
transcription factor to its target site on the promoter (see Appendix
of Alon, 2006). The time evolution of mRNA concentration [X] is
modelled as

d X
g = —1//rd[X] +11% 1'[ ham-1:190» ]'[ hrqu-rKl-m)

dt
i e427 ie.%’
where the mRNA decay rate and the maximal rate of transcription are
denoted by Illrd and Illtc. In addition to this, some studies commonly
include a baseline 1]”, (e.g. Cantone et al., 2009). The Hill ﬁmctions
involving the transcriptional activators 527 and repressors .% are

ha([Pil;Kiﬂi) —

_  —> I([Pil>Ki)7 (2)

hr([Pl]7Klral) 1+([Pi]/Ki)ai
The unknown kinetic parameters a,- and K,- control, respectively,
location and steepness of each Hill function. As a,- gets larger, the
Hill ﬁmction becomes steeper and looks more like the indicator
ﬁmction I (~), taking the value one if argument is true, otherwise zero.
The multiple set of the Hill functions totally deﬁnes the AND gate
that describes an abrupt increasing/decreasing of mRNA transcript
level in response to excess concentrations of the regulatory proteins
in 527 and ﬂ.

4 I([Pi] <19). (3)

2.1.2 Mass action law Multimeric molecules can make up
a transcription factor complex in any of transcription regulatory
circuits. In modelling, we need to build a DE describing molecular
binding reactions, such as protein—protein binding or one or more
proteins interacting with small molecules. Instantaneous rate of a
binding reaction is described here by mass action kinetics

m_
dt __

d
I/xcd[C]+1/xcb1'[[P.-rn (4)

i=1

In the formation of a complex C, the binding efﬁciency among d
molecules, P,- (i = l, ... , d), is determined on the afﬁnity proportional
to the active masses with the binding rate constant 1]ch and powers Ti.

2.1.3 Translation An mRNA transcribed at level [X] proceeds
to its translation process. The model that we employ describes a
production of protein P simply as

d[P]

d
7 = —1//pd[P] +1/I;1[X] — mil—[tern (5)

i=1

Instantaneous rate of translation is represented by the linear
functions in the ﬁrst two terms with the rates of degradation Illpd
and translation I/Iﬂ, respectively. The last term involving (4) appears
in (5) when the protein P binds to the other d — 1 molecules {Pl- |Pi 7E
P,i=1,...,d} in system. Note that we omit dissociation processes
of the protein—protein complex C, relying on the assumption that
molecular stability of C is much higher and reaction kinetics
involved in the dissociation is negligible in the entire system.

2.2 State space model

A biological circuit is modelled as a set of DEs dxl-(t)/dt=
fi(pal-(x), 1/1) deﬁning rates of change in evolving concentrations of
the p biological entities, x(t)= (Jet-(0)1351” over continuous times
t e .7 . In the above context, each endogenous variable involved in a
bio-pathway makes up a state variable Jet-(t). The i-th state variable
is regulated by the parent variables pal-(x)—a subset of the state
variables appearing in the right-hand side of each DE—with the
rate equation fl- deﬁned by the kinetic parameters 1//. Conduction
of quantitative experiments along times enables us to measure
changes of the unknown state variables, x(t), directly or indirectly
via observed data y(t)=(yi(t))15i5peRZ_ at discrete time points
tEJV C 3. Here, to cope with partially observed systems where
data of the state variables are in part missing, it is helpful to deﬁne
a set of observable variables, ieyC{l, ...,p}. For instance, in
transcriptomic experiments using DNA microarrays, it is the case
that amounts of protein expression levels are unobservable.

To proceed with an inversion analysis, the DEs are related to the
experimental data using a state space model:

 

yi(t)=xi(t)+wi(t) for IEJV and i6 5” (6)
din)
dt =fi(Pai(x)71//) (7)

where wi(t) denotes measurement error independently and
identically distributed.

The processes Y={yi(t)|teﬂ,iey} and X={x(t)|tey}
follow (6) and (7) with initial state variables x(0) having
a certain prior distribution x(0)~p(x(0)). Bayesian inversion

 

i590

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq 11101} popcolumoq

9103 ‘{g anﬁnv 110::

Bayesian experts in exploring reaction kinetics of transcription circuits

 

analysis explores all the unknown parameters in the model—
initial states x(0) and kinetic parameters I/I—based on the
posterior distribution P(x(0), 1//| Y, Pa) under which a circuit
structure Pa = {pai(x)}15i5p—a collection of parent variable sets—
is speciﬁed and a priori knowledge on reaction kinetics is expressed
via a prior distribution P(1//). Rather than P(x(0), 1//| Y ,Pa), in many
cases, it is of more interest to evaluate the augmented posterior
distribution P(x(0), 1/1, Pa| Y) where a circuit structure is unknown or
unreliable. In what follows, we focus on the estimation of 1/1 with a
given circuit structure. LiSDAS, however, has a pre-mature ﬁmction
for structural search of reaction circuits.

2.3 Learning reaction kinetics and relevant methods

All the unknown parameters relevant to an analysis are expressed
by 6, i.e. 6={1//,x(0)} or augmented parameters involving circuit
structures Pa. In usual, an analytical form of the posterior
distribution P(6| Y) 0(P(Y |6)P(6) is unavailable due to non-linearity
of DEs, thereby driving a need for efﬁcient posterior approximation
techniques in solving the inversion problems—search for posterior
means or modes. The recent systems biology has explored parallel
developments of SMC, MCMC-driven posterior explorations and
gradient descent methods. However, with a view to scaling to larger
numbers of unknown parameters, efﬁcient and effective computation
remains a challenge.

Our study started from Nagasaki et al. (2006) that applied
a simplest SMC to the stochastic search for transcriptional
reaction kinetics. The use of SMC algorithm had been suggested
also by Quach et al. (2007) whereas they actually applied the
unscented Kalman ﬁlter as a variant of conventional SMC. A
key notion of the SMC and MCMC-driven search—a more
efﬁcient counterpart of SMC—is that the posterior distribution
is approximately evaluated on a ﬁnite number of Monte Carlo
samples called particles such that the empirical distributions are
ensured to reach the true posterior distribution as the number
of particles approaches to inﬁnity. Whenever following such an
approach, however, a quite huge number of particles are needed
to draw as raising the number of unknown parameters. Nagasaki
et al. (2006) and Yoshida et al. (2008) reported that the practical
relevance of the SMC was limited by estimations of only a few
parameters.

Some early studies focused on GA (Kikuchi et al., 2003; Kimura
et al., 2004; Koh et al., 2006) that explores values of parameters by
alternating crossover and mutation of initially generated seeds for the
parameters. With no loss of generality, any optimization problems
for which GA aims to solve can be converted to posterior mode
searches in Bayesian context. The key for success in GA is whether
or not an initial set of candidate parameters lies in the region close to
the posterior mode. According to Higuchi (1997), the intrinsic nature
of GA is essentially the same to the SMC. Hence, the low practical
relevance of the SMC (Nagasaki et al., 2006; Yoshida et al., 2008)
can be a rule of thumb for a performance of GA.

The substantial merit of Bayesian kinetic inference is in the use
of prior distributions, P(6), for conducting effective regularization
in the inversion analysis. To the best of our knowledge, however, no
one has addressed this ﬁmdamental issue while the range of cutting-
edge computational technologies have appeared over the last several
years. The Bayesian expert system that we present is the ﬁrst attempt

to make a class of prior distributions aiming to enhance the power
of previously explored class of kinetic search methods.

3 BAYESIAN EXPERTS ON KINETIC LEARNING

3.1 Dirichlet process

A prior distribution P(6) on the unknown parameters is modelled by
a DP written as

G~DP(G|]/, G0) and 6|G~G

The distribution G that 6 follows is treated as an inﬁnite dimensional
random variable distributed according to the DP—DP(G|y,G0).
The DP is deﬁned by the two parameter: base measure G0 and
concentration parameter y30. The G0 is a distribution function
deﬁned on the support same as G. The smaller y is, the more
G looks like the G0, and vice verse as larger y. A key notion
of DP is in a discrete representation of probability measure; G is
decomposable via the sum of the Dirac measures 69(() at the inﬁnite
set of atoms 6,- ~ G0 (i= 1, ..., 00). The explicit form is hence given
as the inﬁnite mixture G(6)=Zl9°:1 711-691(6) with the mixing rates,
711-30 and 25:17”: 1. The inﬁnite sequence of 6,- can be made
by successively conducting stick breaking construction or Chinese
restaurant process (Blei et al., 2005; Escobar et al., 1995).

3.2 Base measure construction by a mixture of experts

Of the base measure with the Gibbsian mixture (1), the m potential
functions represent a set of implicit ﬁmctions ¢,~(6) B 0 (i = 1, ...,m)
that speciﬁes regions of interest in the kinetic parameters. We here
describe a simple idea on how to make such potentials with an
example of the transcription regulatory models in Section 2.1.

3.2.1 Experts on maximaninimal production rates In many
applications, maximal or minimal level of each observable variable
can be a helpful kinetic evidence to prescribe steady-state conditions
on which each variable should reach in simulation. We illustrate
some examples on how to make such prior distributions.

The transcriptional process shown in Section 2.1 with each Hill
curve varying sigmoidally between 0 and 1 deﬁnes the maximal
production rate as

d[X]

7 =—1//rdIXl+I//tc+I//b

where the AND gate opens. The equilibrium condition d[X]/dt=0
induces the steady-state level of [X ]—the maximal level of the ODE
solution—as the ratio of the production and dilution rates [X] max =
(II/t6 +1/Ib)/1//,d. If time course proﬁles are available on the mRNA,
we are able to evaluate, in some ways, the maximal expression
level of each mRNA, ymax. Then, all possible conﬁgurations of
{II/t6 7 1llrd 7 1ljb} suCh that ymax >>(1//tc ‘I’ 1[’17)/1//rd can be eliminated
in advance by making an arbitral potential function. For instance,
we will use, in later, ¢max =(Aymax —(1//tc+1//1,)/1//,d)2 with a
given discount factor A 6 [1,00). Solutions with the parameters
satisfying ¢max B 0 yield trajectories saturated around at ymax when
A: 1. The speciﬁed 2:1 is to express the prior belief that the
observed maximal level results in an equilibrium state to which
the underlying dynamic system reaches. The restriction can be
weaken/strengthen by the control of the temperature parameter T.
By analogy, the minimal expression level ymin can also be associated

 

i591

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqp:duq 11101} papco1umoq

9103 ‘1g15n8nv 110::

R. Yoshida et al.

 

(i) Maximal level of transcription
Exclude, beforehand in the posterior search, regions of parameters
making solutions of ODE with the steady-states much higher/lower

 

 

    
  

 

 

 

 

 

(A) Experts on maximal/minimal transcription levels

 

than this level. (1) = (M 7 We + vb ) 2
ymax ’ c max max WM
0 f tog ) (iii) Experts on reaction speeds in local duration times ¢min : (Aymin 7 ‘l’b )2
- m" - Once ﬁtting a nonparametric regression to each mRNA profiles, we can identify “(1rd
: o f au‘ ve/ii ML. ive duration of transcription process according to signs of the evaluated
' gradient - m- .im One expert is made for the search of kinetic parameters (B) Experts on maximal/ minimal speeds in transcriptional reactions
re UduLh g a rea:tion speed in each local duration that is either active or inactive. 2

   

      
   

Reacﬁonspeedin
active “ration. -

19022.1)

  
       
     
   
   

 

 

'/

pf.
" Reactions eedilL , 
active du aﬁon

76:3...)

 

  

: f(t2§d
n

iii) Mi a1 level of transcription

 

n Lon

 

 

active: "min. AWL: ‘

 

ymin

 

 

 

 

 

 

 

 

 

 

a on o
tgtai‘t tgnd tstart tend  es
—> im

Prune a parameter space associated with the soluﬁons
~eac‘n’png minimal production levels far below this level.
v

(active duration) can = {131-0220 7 —wL:/1:wb 7 (figggrt) , LtZI‘iI/kaewmtm}

 

 

2
(inactive duration) (15fo : ﬂag! _ wb _ (ﬂagfm _ 1’5 )e—wmtan
wrd il’ra
(C) Experts on maximal translation and mass action kinetics
1A1 Ileax ) 2

translation) m : (Mm — 

{1 . n 2
(molecular binding) (#me : (Agmax _ web H1:1IR]mﬂ-X)
¢cd

Fig. 1. Schematic expression on making Bayesian experts for (i)7(ii) maximal/minimal production levels. and (iii) local reaction speeds.

with the minimal production rate on the model with the closed
AND gate, —1//rd [X]+1//1,=0, which derives a potential ﬁinction
¢min = (Aymin _ Illb/Illrd)2'

Relevant to the mass action kinetics (4) and the translation process
(5) that involve protein-level reactions, we can often specify the
maximal/minimal expression level of protein in data-driven ways
or empirical bases. Conventional DNA microarray experiments
measure transcript levels of mRNA molecules in arbitrary units,
and hence any kinetic parameters in a ﬁtted model result in unit
free as well as quantities of regulatory proteins. A natural way to
cope with such cases is to put an arbitrary chosen maximal/minimal
value to the solutions for (4) and (5). The DE (5) attains the
maximal speed of translation when the maximal level of mRNA,
[leax =(1/ltc +1/lb)/1//rde is SpeciﬁedZ
% =_1//pd[Pl+1//tl[leax_1//cb[P] l—I [Pilgﬁn-

P,;éP

where the minimal protein concentrations [Pl-hml are speciﬁed
arbitrary in the rest of d — 1 reactants. Given this, a maximal level
pmax is then related to the equilibrium state 1/1ﬂ[X]max/(1//pd+
wcbnpi#P[Pi]min), which makes a potential ﬁinction ¢max=
(Apmax—1/xtz[Ximax/(I/xpd+1/xcb up, spin-1,13,“)? with a discount
factor A. By analogy, the solution of (4) describing a complex
formation attains at the maximal rate of production with
[Pﬂmax (i= 1, ...,d). The steady-state condition induces an
expert ¢max =(Acmax _1//cbI—I§1=1[Pilitrliax/1/jcd)2 With an arbitrary
speciﬁed maximum value of the complex, cmax.

3.2.2 Experts on reaction speeds As well as the maximal and
minimal levels of production, experimental data provide us a ﬁirther
clue to what temporal patterns—reaction speeds—DEs must exhibit
in simulation. Suppose that a temporal proﬁle of mRNA is observed
as shown in Figure 1, showing increasing and decreasing trends
alternatively. Gradients of any ﬁtted DE models should reproduce
the observed steepness during each trend.

Of many possible ways to develop such experts, we present a
practically useful, simple procedure that is implemented on LiSDAS.
The ﬁrst task to be addressed is a decomposition of an entire time
interval into active and inactive durations according to observed
gene expression proﬁles, and values of gradients or steepness in

each of the identiﬁed phases. The proposed procedure starts with
ﬁtting a non-parametric regressor, fi(t)= lil- +wgrg(t)+vi(t), to the
i-th mRNA proﬁle, yi(t) (IEJV), where u,- and vi(t) are intercept
and residual, respectively. The J basis functions placed at equally-
spaced grids in .7 are aggregated to g(t)eRJ, and M ER] is a
vector of coefﬁcients. LiSDAS ﬁts the Gaussian radial functions by
using [2 regression scheme. A value of bandwidth common to all
basis functions and a shrinkage parameter in the £2 regression are
prescribed by users.

The ﬁtted curve 121-0) = [2,- +w;rg(t) offers a gradient ﬁinction over

time, wgr(dg(t)/dt). Let Don and Doff be duration times of increasing
and decreasing trends that are identiﬁed as subsets of the entire time
interval. Each duration keeps a same sign of the evaluated gradients
during the consecutive times. The key idea here is to derive a set of
experts such that each potential ﬁinction reﬂects a reaction speed of
increasing or decreasing during each of the identiﬁed local times.
The Hill curve transcription dynamics in Section 2.1 are locally
linear where the concentration levels of all the transcription factors
rise much above or fall much below the relevant Kis. At the reaction
speeds of transcriptional process with open/closed AND gates, we

have the solutions:
Lil/ff” + ([Xlo — W)?” (open gate)
[X] = ’ ’

 + (one — ﬁy-W (closed gate)

where [X ]0 is an initial condition.
Denote the start and end times of each identiﬁed duration by
ff ff -
(tg’tgrtjggd) for D011 and (tg’tmjgnd) for Doff, respectively. Of
interest here is to identify regions of the parameter spaces such
that the simulations instantaneously reproduce the observed reaction

speeds—)(t), respectively, for IE [tg’tart,tgrrlld] or IE [tg’tgfrt,tgrflg].
Specify fi(t§’tm) and ﬁ(t§rrl‘d) to [X] and [A10 in the former ODE
solution corresponding to the active duration where t is set to the
length of the duration, t0n  tgrrl‘d — tg’tgrt. An expert on reaction speed
is then made of the potential function:

¢on = [ﬁ(t§£d)— Will—if _ @033“) _ Will—iyy)e_wtm 12-

By analogy, the implicit ﬁinction relevant to the latter solution
induces the expert on speed in the inactive duration with toff =

 

i592

112 /3.io's[Bumo[pJOJXO'soiieuiJOJuioiqp:duq uioii papeo1umoq

9103 ‘1gisn8nv 110::

Bayesian experts in exploring reaction kinetics of transcription circuits

 

off off .

tend—Istan‘
Aff 1//b A 1//b_,,02
¢off=[ﬁ(l§nd)—ﬁ—<ﬁ(l§:n)—ﬁ)e w" “1 .

These two potential functions form elements of a Gibbsian
distribution in various ways, for instance 0(exp(—¢Off ><¢0n / T).
Alternatively, we would develop an expert based on either 0(
exp(—¢Off/T) or 0(exp(—¢On/T). In advance to the posterior
exploration, LiSDAS generates many experts for all the identiﬁed
duration times by joining/dissociating (1)0“ and $05 at random.

3.2.3 Summary Figure 1 summarizes all the potential functions
that we use in later and a schematic view on the idea. It is important
to see that the preceding potential ﬁinctions constitute, with their
combination, a single potential ﬁinction in (1). For instance, the
potential functions relevant to each mRNA—(pmax, (amin, (1)011 and
¢Off—are deﬁned on the transcriptional parameters (II/rd,1//tc,1/lb),
while the other potentials involve only the kinetics relevant to
protein regulations. LiSDAS draws at random potential functions
and conventional Gaussian priors (the user can specify in the model
construction ﬁle) for each set of kinetic parameters. Each (1),- in (1)
is then constructed by aggregating the extracted component prior
distribution corresponding to different types of kinetic parameters.

3.3 Computational algorithm

DP is discrete with probability one, and represented as an inﬁnite
mixture P(QIQOO)=Z?:17Tidgi(6) conditional on inﬁnite number
of the atoms, 900 = {Qt-Ii: 1, ..., 00} following G0. Hence, the time
course data also follow the inﬁnite mixture

00
P(Y|®m>=Zm-P(Ylei>.

i=1
Of interest in the subsequent posterior analysis is to realize random
sample from the posterior distribution of 900, a posteriori, and
also the mixing rates 71,-, conditional on Y. The Bayesian model
in total forms a DP mixture (DPM) with the key hierarchical
structure: (i) G~DP(G|y,G0), (ii) 6|G~G and (iii) Y|6~p(Y|6).
In statistical science, there have been several excellent reviews,
providing technical details on DPM (Blei et al., 2005; Escobar et al.,
1995; MacEachem et al., 1998). We therefore present only a speciﬁc
computational algorithm.

The procedure is computationally very straightforward. Sample
from the posterior is constructed in a recursive way as a conventional
sampling algorithm does (e.g. Escobar et al., 1995). Suppose that,
in a current distinct parameter set, ®k={6i|i= 1, ...,k} with the
realized values being all distinct, there are ni occurrences of each
61-. The total sample size is Nk =Zf=1nlu Then, the (k+1)-th case
is newly generated by the conditional posterior (6k+1 |®k, Y) given
as the mixture

k
Paine/.1) o< ijae,(6k+i>+wk+iP(6/.+iI001),
j=1
with the mixing rates given by

"f
Y‘I‘Nk

 

P(YIQj) forj=1,...,k,
ijC

—y+yN, fP(Y|6)dGo(6) for j: H 1

The ﬁrst k component distributions consist of the Dirac measures
(Saw/(+1) placed at the preceding sample points, with the mixing
rates involving the frequency of sampling nj and the likelihood
P(YIQj). The last component represents the conditional posterior
P(6k+1|G0,Y)0(P(Y|6k+1)G0(6k+1), and the normalizing constant
cannot be evaluated analytically. If a sample 6k+1 is drawn from
one of the preceding samples, the occurrence rate is updated,
nj —> nj + 1. Given a new 6* coming from the (k + 1)-th distribution,
we increment the current set such that ®k+1 = @k +{6*} and
nk+1 = 1. Random draws having the higher likelihood P(Y IQ) appear
more frequently and result in an approximation of the posterior
distribution P(Ql Y) as the sampling process proceeds iteratively until
convergence.

The remaining task to be addressed is to make a sample from
P(6k+1|G0,Y), and evaluation of its normalizing constant. We
here provide a simple Monte Carlo technique using importance
sampling (IS). One difﬁculty is relevant to making a sample from the
Gibbsian mixture G0 0(  1 ail-Z171 exp(—T_1¢i(6)). Our approach
is very straightforward: (i) conduct the second-order approximation
of each potential function (in-(aw¢,(é,)+(6—é,)T<I>,(é,)(6—6,)
around 9i=argmax¢i(6) with (DZ-(6) the Hessian matrix of ¢,~,
and (ii) the proposal distribution of IS is then deﬁned as the
Gaussian distribution Qi(6) =N(6|9i , T<I>(9i)_1) with the covariance
matrix given by the inverse of Hessian matrix times T. Let
Q(6) =  1 OtiQi(6) be the Gaussian mixture proposal distribution.
Assuming that we have a realization of k samples from the Q
and the importance weights 5,- = G0(6i)/Q(6i) (i= 1, ..., k), then the
normalization constant appearing in the mixing rate of the (k+ 1)-th
component can be approximated by (Zleﬂjrl leﬂjP(Y|6j).
The approximated mixing rates are then proportional to

ﬂjP(Y|9j) forj=1,...,k,

"f

A (r+Nk)ZL1ﬁ.~
a) 0( y k .
—(y+Nk)Zf:l ﬁi 21:1 5,-P(Y|a,-) for} =k+1
One of the previously obtained k samples is replicated if a sampling
process draws a component coincident to one of {1, ..., k}. If not,
we add a new case 6k+1 = 6* from Q, and then assign the likelihood
P(Y|6k+1) and the IS weight ﬂk+1 . All the cases, whether new or old,
are independently distributed according to the Q, thereby ensuring
the statistical consistency of the Monte Carlo approximation of d).

4 APPLICATION

An example in kinetic search of a circadian clock transcriptional
circuit illustrates the practical relevance of the Bayesian expert
systems, and we make a comparison to the non-expert approach
using a conventional SMC (Nagasaki et al., 2006; Nakamura et al.,
2009). Our model considered here is an extended version of the gene
regulatory model developed in Matsuno et al. (2000) where among
several studies used in evaluating relevance of various parameter
search algorithms (Nagasaki et al., 2006; Nakamura et al., 2009;
Yoshida et al., 2008). The original model describes a reaction circuit
of 12 endogenous variables, involving ﬁve mRNAs, ﬁve translated
proteins and two protein complexes, which constitute an interlock
of several types of positive and negative feedback loops. We here
added, to the previous model, seven clock-related variables and
their regulatory mechanisms, reﬂecting in part the recent discoveries
(Baggs et al., 2009; Ueda et al., 2005). The newly constructed DE

 

i593

112 /3.io's[Bumo[pJOJXO'soiieuiJOJuioiqp:duq uioii papeo1umoq

9103 ‘1gisn8nv 110::

R. Yoshida et al.

 

 

 

 

 

 

 

 

 

 

 

 

[clock

 

 

 

 

 

 

 

 

 

 

rev-erbA a Rev-E rbA a

 

 

l
l
l
1

 

 

'Ror(a ror(a)
04-0—1

I 1‘ Normal are ’1‘ Inhibitory arc

 

 

 

rev/erbAbeta

o E

            
    
 
 
 

0.5 1.5
0.5 1.0

0.5 1.0 1.4
1.0

 

0.0

0 200 400 l 600
rorAlpha

'9

 

 

1.5

05
0

Zoo

      
   

0.0 1.0 2.0
0.0 1.0 2.0
0 1 2 3 4

 

o 200 400 600 o 200 400 600

—W_P°',2!°. 1 ,

 

RelerbAbeta

 

0.0 1 .0 2.0
0.5 1 .5 2.5
0 1 2 3

01234

 

 

D 200 400 600 D 200 400 600

Bmal1 Clock/Bmal1

 

 

 

       

 

 

 

01234
01234

 

 

 

 

’ l i a
D 200 400 500 n 200 400 600 n 200 400 can

Per1 RorAlpha Per1/Cry1

 

 

  

 

 

 

 

 

 

0.0 0.4 0.8

   

 

l : , .
0 2m] 4110 son 0 200 400 Mm

Fig. 2. Results of analysis of reaction kinetics. (A) Petri net diagram for in silico circadian clock transcriptional circuit involving 19 endogenous variables
and 116 unknown parameters. (B) Simulation trajectories of the 19 variables with the estimated parameters (red; Bayesian expert. blue; non-expert SMC). The

black circles in the panels corresponding to the seven mRNAs denote the experimental data at the 12 time points. The error bars (vertical red lines) indicate
the maximum and minimum values among 20 simulated trajectories with different sets of the parameters that were estimated by repeating the Bayesian expert

search independently.

model—its mathematical form is available in the Supplementary
Material—contains 116 unknown parameters in total, consisting of
97 kinetic parameters and 19 initial conditions on x(0).

The search methods were applied to time course gene
expression indices from GeneChip mouse genome microrrays
(Ueda et al., 2002). Of the 19 variables, temporal expression
changes of the seven mRNAs were measured along 12 time
points equally spaced on 44 h (http://sirius.cdb.riken.j p/MouseSCN/
MouseSCNCCG(020707).html). A much detailed information on
the speciﬁed prior distributions—values for y, temperature and
conventional Gaussian priors used in combinations—is accessible
from the Supplementary web site, as well as the LiSDAS code that
can reproduce the subsequent numerical analyses with a default
conﬁguration ﬁle.

Figure 2 displays simulation trajectories of the 19 endogenous
variables, where the identiﬁed kinetic parameters and initial state
variables were deﬁned as the 61- exhibiting the best ﬁt in terms of
P(Y |a,-). The DEs were solved using the Euler discretization with
700 time steps equally spaced on the entire time interval. CPU time
required for the execution of LiSDAS was ~40 min (Intel Core2
Quad processor, 2.66GHz) for the particles of size k=5 X105.
Compared with the very poor results of the non-expert SMC method
using only the conventional Gaussian priors, the LiSDAS could
capture the underlying circadian rhythm inherent in the observed
data with much better degree of ﬁtness. Note that the applied search
procedure is almost the same as a random search. The particles
were all drawn from G0, and then the best ﬁt value was merely
chosen. Therefore, the good performance arose from only the added
Bayesian expert system. To the best of our knowledge, the methods
being able to estimate such many parameters have never appeared in
the related research ﬁeld, while so far, our previous study (Yoshida
et al., 2008) and the GA of Koh et al. (2006) could draw reasonably
good performances in analyses of a transcription model and in

silico signal transduction pathway, containing, 44 and 84 unknown
parameters respectively.

5 CONCLUDING REMARKS

This brief article has described the new idea on data-driven
parameter search for bio-pathway DE models. The key contributions
lie in the novel Bayesian expert systems induced by the base measure
of DP prior. The expert systems rely on the Gibbsian potential
functions that reﬂect automatically recognized model-speciﬁc
contexts—reaction speeds, equilibrium states—to the subsequent
search process so as to prune insigniﬁcant parameter spaces. The
ability to aid in improving efﬁciency has been demonstrated in the
example on transcriptional regulatory models. The practical beneﬁt
was surprisingly signiﬁcant; the applied simple search algorithm
could draw fairly good performances only by a plug-in of the expert
systems.

With a view to general versatility of the current approach,
developments of more practically relevant expert systems remain
a challenge yet. A biological circuit is made of several
types of biochemical reactions—phosphorylation cascade-mediated
signal transductions and metabolic reactions—other than the
transcriptional processes we studied. In many cases, these reactions
are modelled by more complex equations, being either stochastic or
non-stochastic, than the Hill ﬁinctions used in this article. Though
it would be straightforward, even for more complex DE systems,
to relate observed maximal/minimal production levels to steady-
state conditions, some difﬁculties arise in evaluations of experts
on reaction speeds with a given more complex model due to
unavailability of the analytical expression for the reaction speeds.
We then need to explore some numerical techniques for making
expert system priors.

 

i594

112 /3.io's[Bumo[pJOJXO'soiieuiJOJuioiqp:duq uioii papeo1umoq

9103 ‘1gisn8nv 110::

Bayesian experts in exploring reaction kinetics of transcription circuits

 

Making ﬁirther variants in expert construction is possible, and
will then be inherently context speciﬁc. In view of biochemical
kinetics, it would be more helpful to incorporate, to further prior
modelling, differences of time scales on each reaction speed, such
as difference in molecular stability of different proteins and mRNAs.
Signal transduction pathways usually change in transcription factor
activities on subsecond time scales. Binding of transcription factor
to its target promoter reaches equilibrium in seconds. Transcription
and translation of genes take many minutes in reaching steady state.
We need to explore ways of reﬂecting these time scales to subjective
prior distributions expressing a biologically signiﬁcant subspace of
kinetic parameters.

Another important issue is unreliability of model. In silica circuits
embody currently obtained knowledge on many pairs of interacting
molecules. In many applications, such a circuit structure is totally
unreliable because of environmental dependency and diversity
of cells. Very often, simulations fail to reproduce experimental
data irrelevant to which kinetic parameters are speciﬁed. The
inconsistency indicates presence or absence of some regulatory
mechanisms to be reﬂected into model reconstruction. Recent
systems biology therefore has explored a structural learning of
reactions circuits in data-driven ways (Cantone et al., 2009; Cao
et al., 2008; Porreca et al., 2010). LiSDAS with the procedure
speciﬁcation ﬁle in place can explore the most plausible circuit with
the highest degree of ﬁt as well as kinetic values by adding/deleting
edges completely at random. However, with a view to larger
scale models, the ability of such a low-level search method
reaches a performance limit due to a huge space of possible edge
conﬁgurations. Our next challenge is the development of Bayesian
experts in exploring circuit structure.

Conﬂict of Interest: none declared.

REFERENCES

Alon,U. (2006) An Introduction to Systems Biology. Chapman and Hall, London, UK.

Baggs,J.E. et al. (2009) Network features of the mammalian circadian clock. PLoS
Biol, 7, e1000052.

Blei,D.M. et al. (2005) Variational inference for Dirichlet process mixtures. Bayesian
Anal, 16, 1217144.

Cantone,1. et al. (2009) A yeast synthetic network for in vivo assessment of reverse-
engineering and modeling approaches. Cell, 137, 1727181.

Cao,J. et al. (2008) Estimating dynamic models for gene regulation networks.
Bioinformatics, 24, 161971624.

Chen,K.C. et al. (2004) Integrative analysis of cell cycle control in budding yeast.
Mol Biol. Cell, 15, 384173862.

Escobar,M.D. et al. (1995) Bayesian density estimation and inference using mixtures.
J. Am. Stat. Assoc, 90, 5777588.

Koh,G. et al. (2006) A decompositional approach to parameter estimation in pathway
modeling: a case study of the Akt and MAPK pathways and their crosstalk.
Bioinformatics, 22, 627146280.

Finkenst'adt,B. et al. (2008) Reconstruction of transcriptional dynamics from gene
reporter data using differential equations. Bioinformatics, 24, 290172907.

Fujarewicz,K. et al. (2007) Adjoint systems for models of cell sinaling pathways
and their applications to parameter ﬁtting. IEEE/ACM Trans. Comput. Biol.
Bioinformatics, 4, 3227335.

Higuchi,T. (1997) Monte Carlo ﬁlter using the genetic algorithm operators. J. Stat.
Comput. Simul, S9, 1723.

Kikuchi,S. et al. (2003) Dynamic modeling of genetic networks using genetic algorithm
and S-system. Bioinformatics, 19, 643$50.

Kimura,S. et al. (2004) Inference of S-system models of genetic networks using a
cooperative coevolutionary algorithm. Bioinformatics, 21, 115441163.

MacEachem,S.N. et al. (1998) Estimating mixture of Dirichlet process models.
J. Comput. Graph. Stat, 7, 2237238.

Matsuno,H. et al. (2000) Hybrid Petri net representation of gene regulatory network.
Pac. Symp. Biocomput., 5, 3417352.

Nagasaki,M. et al. (2006) Genomic data assimilation for estimating hybrid functional
petri net from time-course gene expression data. Genome Inform, 17, 46$1.
Nakamura,K. et al. (2009) Parameter estimation of in silico biological pathways
with particle ﬁltering towards a petascale computing. Pac. Symp. Biocomput., 14,

2277238.

Perrin,B.E. et al. (2003) Inference of gene regulatory network using dynamic Bayesian
networks. Bioinformatics, 19, 11138711148.

Porreca,R. et al. (2010) Identiﬁcation of genetic network dynamics with unate structure.
Bioinformatics, 26, 123971245.

Quach,M. et al. (2007) Estimating parameters and hidden variables in non-linear state-
space models based on ODEs for biological networks inference. Bioinformatics,
23, 320973216.

Ueda,H.R. et al. (2002) A transcription factor response element for gene expression
during circadian night. Nature, 418, 5347539.

Ueda,H.R. etal. (2005) System-level identiﬁcation of transcriptional circuits underlying
mammalian circadian clocks. Nat. Genet, 37, 1877192.

Wilkinson,D.J. (2006) Stochastic Modelling for Systems Biology. Chapman and Hall,
London, UK.

Yoshida,R. et al. (2008) Bayesian learning of biological pathways on genomic data
assimilation. Bioinformatics, 24, 259272601.

 

i595

112 /3.io's[Bumo[pJOJXO'soiieuiJOJuioiqp:duq uioii papeo1umoq

9103 ‘1gisn8nv 110::

