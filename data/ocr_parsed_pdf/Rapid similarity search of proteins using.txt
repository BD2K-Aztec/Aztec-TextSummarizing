ORIGINAL PAPER

Vol. 30 no. 2 2014, pages 274—281
doi:10. 1 093/bioinformatics/bt13 79

 

Sequence analysis

Advance Access publication July 4, 2018

Rapid similarity search of proteins using alignments of

domain arrangements

Nicolas Terrapon‘“, January Weinerz'i, Sonja Grath1'§, Andrew D. Moore1 and

Erich Bornberg-Bauer1'*

1Westfalian Wilhelms University, Institute of Evolution and Biodiversity, Huefierstr. 1, 48149 Muenster, Germany and
2Max Planck Institute for Infection Biology, Charitéplatz 1, 10117 Berlin, Germany

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Homology search methods are dominated by the central
paradigm that sequence similarity is a proxy for common ancestry
and, by extension, functional similarity. For determining sequence
similarity in proteins, most widely used methods use models of
sequence evolution and compare amino-acid strings in search for
conserved linear stretches. Probabilistic models or sequence profiles
capture the position-speciﬁc variation in an alignment of homologous
sequences and can identify conserved motifs or domains. While pro-
file-based search methods are generally more accurate than simple
sequence comparison methods, they tend to be computationally more
demanding. In recent years, several methods have emerged that per-
form protein similarity searches based on domain composition.
However, few methods have considered the linear arrangements of
domains when conducting similarity searches, despite strong
evidence that domain order can harbour considerable functional and
evolutionary signal.

Results: Here, we introduce an alignment scheme that uses a clas-
sical dynamic programming approach to the global alignment of
domains. We illustrate that representing proteins as strings of domains
(domain arrangements) and comparing these strings globally allows
for a both fast and sensitive homology search. Further, we demon-
strate that the presented methods complement existing methods by
finding similar proteins missed by popular amino-acid—based compari-
son methods.

Availability: An implementation of the presented algorithms, a
web-based interface as well as a command-line program for batch
searching against the UniProt database can be found at http://rads.
uni-muenster.de. Furthermore, we provide a JAVA API for program-
matic access to domain-string—based search methods.

Contact: terrapon.nicolas@gmail.com or ebb@uni-muenster.de
Supplementary information: Supplementary data are available
at Bioinformatics online.

Received on December 30, 2012; revised on June 12, 2013; accepted
on June 27, 2013

 

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as joint First Authors.

iPresent address: Architecture et Fonction des Macromolecules
Biologiques, Aix-Marseille Université, CNRS UMR 7257, 162 av. de
Luminy, 13288 Marseille, France.

§Present address: Department of Biology 11, University of Munich
(LMU), Grosshaderner Str. 2, 82152 Planegg-Martinsried, Germany.

1 INTRODUCTION

Accurate identification of sequence similarity is a crucial and
integral part of modern biological analysis. Sequence similarity
is often used to infer functional similarity when comparing an
unknown protein sequence to a set of well described sequences
and can be the result of conservation or convergent evolution.
Homologous sequences are often identiﬁed by comparing a
query sequence with a large collection of sequences (subjects)
in public databases. In such comparisons, a pairwise alignment
attempts to match the homologous characters (nucleotides or
amino-acid residues) of query and subject sequences according
to an evolutionary model. Pairwise alignments can be evaluated
in terms of similarity or distance scores (Spang and Vingron,
1998). Furthermore, the probability to obtain an identical or
better score by chance alone is computed (Karlin and Altschul,
1993) and a threshold is chosen to accept or reject potential
homology.

Given an underlying evolutionary model, calculating the opti-
mal pairwise alignment is possible (Needleman and Wunsch,
1970) but computationally demanding. Therefore, many similar-
ity searches use heuristic approaches. Table 1 shows an overview
of the main methods used for sequence homology search.

Local alignment algorithms such as BLAST (Altschul et al.,
1990) focus on conserved regions only, and hence do not enforce
an alignment of entire sequences. This approach has advantages
in finding homology. First, homologous proteins can have
regions that are not similar, for example, if these regions have
not been under selectional constraints or are fast-evolving.
Second, proteins often have regions of local similarity, which
correspond to protein domains. Finally, heuristics are much
faster because only stretches of local similarities are considered
(Altschul et al., 1990).

However, using local alignments also bears drawbacks. The
most obvious drawback is that multi—domain proteins that share
one domain may exhibit a high degree of local similarity, which
can mask an overall low degree of global similarity (Song et al.,
2008). Ergo, applying a local alignment approach for finding
functional homologs may be misleading. In contrast, global simi-
larity suffers the opposite extreme: remote homologs of a query
can be missed owing to the low amount of global sequence simi-
larity. To address these problems, the protein’s domain compos-
ition or domain arrangement (i.e. the N to C terminal order of
domains) can be taken into account (Table 1). Protein domains
are the units of protein structure, function and evolution

 

274 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papaolumoq

9103 ‘Og isnﬁnV uo ::

Similarity search using domain arrangements

 

Table 1. Overview of selected algorithms used for protein homology search

 

Algorithm Type

Reference

 

Optimal sequence alignment algorithms
Needleman-Wunsh
Smith7Waterman

Global alignment algorithm
Local alignment algorithm

Heuristic sequence alignment algorithms
FASTA
BLAST
DELTA-BLAST

Proﬁle-based sequence alignment algorithms

PSI-BLAST Proﬁle-based BLAST
HMMER Proﬁle-based search with HMMs
JACKHMMER Iterative proﬁle-HMM search

Domain-based algorithms
CDART Number of domains common to two proteins
DomainTeams Local microsyntenies irrespective of protein boundaries
Domain Distance Number of mismatches between two arrangements
RASPODOM Dynamic-programmingibased algorithm for search of

circularin permutated homologs
Measure based on a weighted sum of three similarity scores
Combination of local sequence similarity and domain information
Dynamic-programmingibased algorithm for domain alignment

DAhunter, WDAC
Neighbourhood correlation
RADS/RAMPAGE

and global protein alignment

Fast on-the-ﬂy heuristic sequence similarity search
Heuristic search algorithm relying on a preformatted database
Domain enhanced lookup time accelerated BLAST

Needleman and Wunsch (1970)
Smith and Waterman (1981)

Pearson and Lipman (1988)
Altschul et a]. (1990)
Boratyn et a]. (2012)

Altschul et a]. (1997)
Eddy (1998)
Johnson et a]. (2010)

Marchler-Bauer et a]. (2007)
Pasek et a]. (2005)
Bjorklund et a]. (2005)
Weiner et a]. (2005)

Lee and Lee (2008, 2009)
Song et a]. (2008)
This study

 

[see Moore et al. (2008) for a review]. Tools that consider do-
mains to find functionally similar, or even homologous, proteins,
do exist. For example, CDART (Geer et al., 2002) measures
similarity by considering the number of domains shared between
two proteins. CDART does not consider the order of domains,
the number of repeats or the non-shared domains when deter-
mining similar proteins; in essence, CDART treats proteins as a
‘bag of domains’. Several approaches have been developed that
attempt to circumvent the problems with local similarity, which
modern search and alignment algorithms face. Song et al. (2008)
defined local sequence similarity scores with the analysis of a
local neighbour similarity network into a ‘Neighbourhood
Correlation Score’, thus extending the local similarity score to
include a global perspective. Lin et al. (2006) deﬁned a similarity
measure between proteins as the weighted average of three simi-
larity scores, which consider the number of shared domains and
the number of domains that are speciﬁc for one protein, domain
duplications and the local order of domains (incidence of ordered
domain pairs). A similar approach is used by DAhunter and
WDAC, which also incorporates domain versatility and
domain frequency into the search for similar domain arrange-
ments (Lee and Lee, 2008, 2009). Bj orklund et al. (2005) defined
the domain distance, a protein distance measure based on the
number of domains that are not matched between two proteins.
In essence, the domain distance is an edit distance as it measures
the number of edit operations (domain additions or deletions)
needed to move from one arrangement to another.

In addition to similarity search, domain-based approaches
have been also used for protein clustering [e.g. Enright and
Ouzounis (2000)]. The DomainTeams tool, for example, analyses
domainwise local similarities (microsyntenies) on bacterial

chromosomes, irrespective of gene boundaries. By using micro-
syntenies, DomainTeams is able to detect clusters of orthologous
genes even if domain arrangements are variable (Pasek et al.,
2005).

Several approaches demonstrated that domain content can be
used to reconstruct phylogenies (Werren et al., 2010).
Furthermore, beyond domain content, the order of domains in
a protein can help elucidate functional and structural constraints
(Kummerfeld and Teichmann, 2009). While aforementioned
domain-based algorithms are promising, to date none takes ad-
vantage of such a context-based analysis, i.e. the knowledge that
the linear combinations of domains bear a strong phylogenetic
and functional signal.

Here, we present two algorithms for ﬁnding homologous pro-
teins that exploit this signal of conserved domain arrangements.
The first algorithm, RADS (Rapid Alignment of Domain
Strings), represents proteins as domain arrangements and does
not require any sequence information. The similarity between
two proteins is determined by aligning the proteins’ domain ar-
rangements to each other using a dynamic programming algo-
rithm. A key advantage to this approach is the reduction in time
complexityiwhile proteins in UniProt contain on average 324
amino acids, they harbour an average of only 1.5 domains (2.63
for multi-domain arrangements), making the number of required
comparisons considerably smaller. Further, by only considering
proteins that share at least one common domain, the search
space can be drastically reduced. While abandoning the informa-
tion contained within the sequences does come at the cost of
sensitivity, it is well established that domains are the units of
protein evolution and are a good proxy for sequence similarity
(Buljan and Bateman, 2010; Chothia and Gough, 2009;

 

275

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papaolumoq

9103 ‘Og isnﬁnv uo ::

N. Terrapon et al.

 

Hunter et al., 2012; Moore et al., 2008; Sjolander et al., 2011;
Wang and Caetano-Anolles, 2009). It follows that the alignment
of domains can be used for swift detection of potential
homologs.

The second presented algorithm, RAMPAGE (Rapid
Alignment Method of Proteins based on domain
ArranGEments) complements RADS and addresses the need
for increased sensitivity. RAMPAGE creates global alignments
of amino-acid sequences using the domainwise alignments pro-
vided by RADS as guideline, similar to previously described
approaches such as the segment-based approach applied in
DIALIGN—T (Subramanian et al., 2005). We demonstrate that
methods searching for domain arrangements yield biologically
meaningful results, which are often complementary to
sequence-based methods and, at the same time, work at a
speed that is signiﬁcantly faster than local alignment tools.

2 MATERIALS AND METHODS
2.1 Data

For domain annotation, we used the current version (26.0) of the Pfam
database (Punta et al., 2012). Pfam is based on a sequence database—
Pfamseqiwhich is currently based on UniProt release 2011_06 [Universal
Protein Resource, UniProt Consortium (2012)]. The Pfam database con-
sists of two sections: Pfam-A (manually curated) and Pfam-B (automat-
ically deﬁned). Throughout the complete study, we used Pfam-A
annotations. All sequences have been annotated with domains using
HMMER 3.0 (Eddy, 2011). The current data consist of 15 929 002 non-
redundant proteins, 79.4% (11 769 563) of which are assigned to at least
one Pfam domain.

2.2 Algorithms

2.2.] RADSiRapid Alignment of Domain Strings In the ﬁrst
approach, proteins are represented by domain arrangements, i.e. N- to C-
ordered strings of domains. Subsequently, domain arrangements are com-
pared using a version of the Needleman7Wunsch (NW) algorithm
(Needleman and Wunsch, 1970) with values for match (same domain
ID), mismatch (different domain IDs) and afﬁne gap costs. In the
RADS implementation with default parameters, a matched pair of do-
mains receives a score of 150, a mismatch or internal gap opening a score
of —100, and the cost for internal gap extension is set to —50. The costs
for terminal gap opening is set to —50, and for terminal gap extension to
—25. Low terminal gap penalties correspond to the ﬁnding that indels are
more frequent on protein termini (Weiner et al., 2006). Additionally, we
introduce a score normalization scheme that considers the following:

a Domain length, because a match between two larger domains cor-
responds to a conservation between longer stretches of amino acids.
The match score between domains is weighted by the length of the
shortest domain occurrence within the pair, and therefore, longer
matching domains get higher scores.

a Difference in length between domains, as strong variation in size
might indicate functional divergence. For example, if, in a given
protein, only a short fragment of a certain domain is found, the
extent to which this fragment is still fully functional is uncertain.
Furthermore, the fragmentation of a domain can hold phylogenetic
signal. Ergo, matching a fragment to a more complete domain re-
ceives a lower score than two complete domains or two fragmented
domain matches.

 

First step: align domain arrangements

Dmn am-mse, global

Second step: align AA sequences of matching domains

 

 

Amino acid, local

 

Third step; align remaining AA sequences

*5!-
w

Amino acid. global

 

 

Fourth step: juin aligned fragmenls

 

 

 

 

Fig. 1. Scheme of the domain-driven amino-acid alignment
(RAMPAGE). In the ﬁrst step, the matching homologous domains are
identiﬁed by RADS. Second, local amino-acid sequence alignments of the
matching domains are created. In the third step, all remaining fragments
of the protein sequences are aligned globally. Finally, all subalignments
are assembled to produce a full alignment

The normalized match score Sal, d2) between the two domains d1 and
d2 is deﬁned as follows:

Lmin(d1a d2) 1 Lmin(d1 7 d2)
id) Lmax(d1, d2) ,

where SW42 is the original score of the matching domains d1 and d2, 5qu
is the average length of a Pfam domain in UniProt and is used to have a
per-position score in matching domains and Lm,n(d1, d2) and me(d1, d2)
represent the short and long domain in a matching pair, respectively. We
ﬁnd that the application of this simple normalization scheme improved
the classiﬁcation power of RADS (Supplementary Material S1).

501,42) = $011,112) ‘ (1)

2.2.2 RAMPAGE—Rapid Alignment Method of Proteins based
on domain ArranGEments RAMPAGE produces full sequence-
based alignments between query and hits based on a preceding RADS
search. This can be relevant if large stretches between proteins are not
aligned by RADS, such as may result from poor domain-annotation
coverage or strong sequence divergence. The procedure is described in
Figure 1. After conducting a domain string alignment using RADS, the
pairs of sequence fragments corresponding to matched domains are 10-
cally aligned using the Smith7Waterman algorithm (Smith and
Waterman, 1981). The remaining fragments are terminal sequences and
inter-match fragments. These fragments are now aligned using the global
NW algorithm. Finally, all alignments are joined together to give a full
global alignment.

2.3 Estimation of the false-negative rate

To estimate the probability that two proteins contain a detectable region
of similarity without sharing any domains, we randomly selected one
million pairs of proteins from UniProt that did not share any domain.
For each pair, we searched for homologous regions using the program
bl2seq from the BLAST package. Furthermore, for each pair, we

 

276

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv uo ::

Similarity search using domain arrangements

 

recorded information about the number of domains and the fraction of
sequences not assigned to any domain to test for possible bias.

2.4 Correlation of alignment scores for NW with RADS
and RAMPAGE

To test for a possible inﬂuence of incorrect domain matches introduced
by the RADS algorithm on the overall alignment quality, we determined
correlations between RADS and RAMPAGE scores and NW scores
using the Spearman’s rank correlation. We tested different datasets.
First, correlations were assessed for 10000 pairs of randomly selected
sequences from UniProt. Each pair consisted of two proteins that had
at least one domain in common. Second, we randomly selected pairs of
proteins that share a certain number (one, two, three, four or more than
four) of domains. Each group contained 100 protein pairs. The second
dataset allowed us to illustrate the impact of arrangement length on
RADS and RAMPAGE.

2.5 Receiver-0perating-characteristics curves

We compared the aforementioned approaches for detecting homology: (i)
based on domain annotation: RADS, CDART, domain distance and
DAhunter; (ii) based on amino-acid sequence alignement: RAMPAGE,
BLAST and DELTA-BLAST; (iii) based on proﬁle search: PSIBLAST
and JACKHMMER. For each of these methods, we calculated receiver-
operating-characteristics (ROC) curves to evaluate their performance in
retrieving close orthologs. We used data from the OMA (Orthologous
MAtrix) project (Altenhoff et al., 2011) obtained via the OMA browser
(http://omabrowser.org/). The OMA browser offers orthologous relation-
ships for proteins from more than 1000 species. We were able to match
3 322 654 sequences from the OMA browser (version May 2011) to
UniProt identiﬁers (unique protein IDs). Then, we randomly selected
1000 proteins and performed searches with all six algorithms. For each
algorithm, we determined for each hit whether it appears with the query
in the list of homologous pairs (http://omabrowser.org/All/oma-pairs.txt.
gz); if so, the hit was counted as true positive, otherwise as false positive.
For a given algorithm, ROC curves for both single- and multi-domain
queries were then derived from the pooled and sorted results of all
searches. We further tested performance of the different methods against
more difﬁcult datasets, notably with short repeated domains or long
amino-acid stretches without domain annotation.

2.6 Implementation

The core algorithms RADS and RAMPAGE are implemented in ANSI
C, and are provided as a command-line application, which can be used to
scan any type of non-overlapping domain annotation against any custom
database. For convenience, we implemented a web application that can
be used to perform searches against UniProt using Pfam domain deﬁn-
itions (Supplementary Material S2). Domain arrangements of UniProt
proteins were precomputed and indexed to ensure swift identiﬁcation of
proteins that share at least one domain as only these are further con-
sidered in RADS and RAMPAGE searches (not true for BLAST). For
database access, query and management as well as for visualization pur-
poses, a set of Perl modules was developed. To achieve maximum port-
ability, simplicity and speed, the databases were created using SQLite and
stored on a solid state drive. An average RADS web interface search
against the approximately 15000 000 proteins of PfamSeq takes ~1.5 s
on an Intel Core i3-2120 machine (3.30 GHz, 4 GB RAM). An additional
0.3 s are required if the query must ﬁrst undergo domain annotation. The
web interface for RADS and RAMPAGE searches was combined with
an interface for BLAST and an internal HMMSCAN pipeline (Eddy,
2011), making parallel sequence- and domain-based searches as well as
on-the-ﬂy sequence annotation possible. This allows users to speciﬁcally
target results that were missed by one of the search algorithms. Results

can be sorted by RADS, RAMPAGE or BLAST scores and are pre-
sented along with a graphical representation of domain arrangements.
Because the underlying UniProt release corresponds to the Pfam release
(used for domain annotation), updates of the web interface will follow
Pfam releases.

Besides the C command-line application and the web interface, we
provide an initial JAVA archive, which can be used as a command-line
application to batch-query the web interface or as a JAVA API for pro-
grammatic access to the web interface. We have recently incorporated the
JAVA API into DoMosaics, a graphical tool for domainwise analysis of
proteins (Moore et al., 2013).

The web interface, the command-line implementation as well as the
JAVA jar can be obtained under http://rads.uni-muenster.de. DoMosaics
is available under http://www.domosaics.uni-muenster.de. All programs
and libraries can be used on all major platforms and are freely availability
under the GNU public licence.

3 RESULTS AND DISCUSSION

3.1 Impact of domain misannotation

Domain-based similarity search algorithms can only be applied
to pairs of proteins that have at least one domain in common. As
one of the ﬁrst steps of RADS, the search space is reduced by
removing all proteins that do not share any domains with the
query. Domains that are wrongly annotated (or wrongly absent)
(Beaussart et al., 2007; Terrapon et al., 2009) may lead to ﬁlter
out sequences that harbour signiﬁcant similarity to the query. To
quantify this possible error, we randomly selected one million
sequence pairs that do not share any domain and aligned
them. Less then 0.01% (60 pairs) exhibited similarity at an
e value threshold <10’5, a widely used default threshold for
database searches; even relaxing to a threshold of 10’3 results
in <0.1% error (682 pairs). Moreover, distinct domain families
belonging to the same Pfam clan explain 24 cases out of 60 at
10’5 (and 92 cases out of 682 at 10’3). As the deﬁnition of
subfamilies is a central aspect of the recent Pfam annotation
strategy, we believe such errors will become increasingly rare.
Ergo, the error caused by the initial filtering step in which only
sequences are retained that share at least one domain with the
query is negligible.

3.2 Correlation of sequence- and domain-based
alignments

Next, we wanted to know whether domain-based alignments are
reliable in the sense that they reﬂect an exact global amino-acid
alignment. To investigate this, we tested if scores from an align-
ment of domain arrangements are correlated with scores from
pairwise amino-acid sequence alignments. There are at least three
possible explanations why scores from an alignment of domain
arrangements may not perfectly correlate with scores from pair-
wise amino-acid sequence alignments. First, by aligning domains
as characters (as opposed to aligning amino acids as characters),
one might expect a lower resolution in closely related proteins.
At the domain level, closely related proteins tend to have similar,
if not identical, arrangements (Forslund et al., 2011). In com-
parison, closely related proteins can still exhibit variation at the
sequence level, which can provide higher resolution in elucidating
the exact relationships. Hence, aligning domains alone makes it
difﬁcult to correctly rank close homologs, as they may share the

 

277

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv uo ::

N. Terrapon et al.

 

same arrangements and hence the same score. Second, a domain-
based homology search can provide relevant results for divergent
proteins by the use of accurate annotations delivered through
domain family proﬁles. Such remote domain homologs are usu-
ally not recognized with amino-acid alignments (Gonzalez and
Pearson, 2010). Third, domain arrangements might be incor-
rectly aligned, e.g. matching domains are not aligned optimally
or different domains are wrongly aligned with each other. In this
case, the score of a domain-based homology search will strongly
differ from the score obtained in an amino-acid sequence
comparison.

To test the correlation of domain-based and sequence-based
scores, we ﬁrst ran RADS on random protein pairs. Next, apply-
ing RAMPAGE, we build global amino-acid alignments from
domainwise RADS searches (Fig. 1 and ‘Materials and Methods’
section). Because the alignment reported by RAMPAGE is a
suboptimal solution of the NW alignment for a pair of
sequences, the maximum score that can be achieved by
RAMPAGE will be the NW score. If RADS misaligns domains,
then scores from RAMPAGE should be significantly worse than
scores reported by the NW algorithm. We show that both RADS
and RAMPAGE scores correlate significantly with NW scores
on the 10000 protein-pair set (Spearman’s rank correlation,
RADS versus NW: p:0.42, P<0.001; RAMPAGE versus
NW: ,0:0.98, P<0.001). Additionally, we investigated the
effect of domain number per protein by using a second set of
random domain pairs. As to be expected, we ﬁnd that
correlations for RADS are higher when more domains are
shared between the protein pairs. This indicates that RADS per-
forms better when applied to multi-domain searches than to
single-domain searches (see Supplementary Material S1 for
details).

3.3 Using ROC curves to evaluate algorithm performance

We used the OMA database to evaluate the performance of
RADS, RAMPAGE and other methods (see ‘Materials and
Methods’ section for details). Whereas BLAST and
RAMPAGE generally perform equally well, we ﬁnd an overall
lower performance for RADS and the other domain-based meth-
ods. An in-depth manual investigation of the results shows that
the main problem with pure domain-based approaches is the low
resolution resulting for queries which contain only a single anno-
tated domain (Fig. 2, top). Domain-based methods treat single
domain hits almost equally if they consist of the same domain
arrangement as the query. Again, this indicates that domain-
based approaches are better suited for multi—domain proteins.
Indeed, for proteins that contain at least two domains, RADS
and the other domain-based methods exhibit increased perform-
ance (Fig. 2, bottom). A manual analysis of the results reveals
that the domain-based approaches achieve their better perform-
ance not necessarily by providing exactly the same results as
BLAST, but rather by being able to detect distant homologs,
which are missed by BLAST. While the discriminative perform-
ance of the domain-based methods grows with the number of
domains in the query, the reverse is true for BLAST. The high
predictive power of domain-based approaches has been further
demonstrated using proteins with long non-repeated domains. In
contrast, proteins with short repeated domains challenge all

Single—domain proteins

 

 

   
 

 

 

 

 

 

 

 

 

‘3. _
1_ _ _ _ _ _ _ _ _
°°. _
c:
2
CU
D: ‘0. _
E o
E
n— ‘t s CDART
% C3 -- - Domain Distance
'F  DAhunter
- -- RADS
c"! a — RAMPAGE
C3 — BLAST
-- - DELTABLAST
e PSIBLAST
CI _ — JACKHMMEFI
D | | | | t
0e+00 29—04 49—04
False Positive Rate
Multi—domain proteins
CI _
,_
°Q _
o
2
0 <0. _
.3 O
'1 ‘2 s  — CDAFIT
g D ‘ - - - Domain Distance
'1;  DAhunter
I , - - - RADS
0‘! - _-‘ RAMPAGE
O — BLAST
- - - DELTABLAST
— PSIBLAST
‘3 _ — JACKHMMER

 

 

 

 

O- | | l | |
0.0000 0.0005 0.0010 0.0015 0.0020

False Positive Rate

Fig. 2. ROC curves for sequence- and domain-based approaches. ROC
curves are obtained from ortholog-group assignments for 1000 random
query proteins in the OMA database

tested methods (Supplementary Material S3.1). We addition-
ally scrutinized the performance of methods when applied to
proteins with long stretches of amino acids that lack domain
assignment (Supplementary Material S3.2). Here, we ﬁnd that
all methods achieve a good sensitivity/speciﬁcity trade-off,
even if such a stretch is found in the center of a given protein
and splits a domain arrangement. For the latter, we ﬁnd that
RAMPAGE performs well despite its global-alignment strategy.
It is important to note that these ROC analysis are biased
in favour of sequence-based methods, as the definition of
orthologous groups in the OMA database is based on BLAST
results.

 

278

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv uo ::

Similarity search using domain arrangements

 

Table 2. Combined BLAST and RADS search with RGA3_SCHPO as query

 

BLAST RADS Domain

 

 

 

 

Idemlﬁer e value score Arrangement

RGA3_SCHPO 0.0 379 u—n—r

RGA4_SCHPO 16—23 248 ~——-

CHIN_HUMAN 7e-18 118 m

CHIN_MOUSE 6e-17 118 m

RGA2_YEAST 46—13 326 "——

RGA7_SCHPO 26-12 128 H

MYO9A_HUMAN 56-12 30 min—l“—
MYO9A_MOUSE 5e-12 30 --— —-H- =
RGD1_YEAST 2e-11 118 H

RGALYEAST 2e-10 213 4——

RGA2_SCHPO 66-08 135 —-——-—

SAC7_YEAST 1e-04 —4 —---—

BAG7_YEAST 0.001 53 —m—

BEM2_YEAST 0.002 168 —-—-—<}—-—
BEM3_YEAST 0.004 135 —oa——+

RGA5_SCHPO 0.12 58 —---— u.- 
RGA6_SCHPO 0.16 32 —-—— E 3::‘7‘“’°7‘
RGA1_SCHPO 9.6 357 —w—-—— - rcu
RGA8_SCHPO > 10 94 -—-—-—— g '3"
RGA9_SCHPO > 10 57 -—-—— a :ggwm
Y1L2_SCHP0 > 10 116 run—— 53 pi.
LRG1_YEAST > 10 297 av—v—m— : :1;
ECM25_YEAST > 10 125 "— Q 
RGD2_YEAST > 10 84 H—III—  
YHY2_YEAST > 10 -102 —n— - snz

 

Shown are all RhoGAP—proteins in S.p0mbe and S.cerevisiae, additional human and mouse chimaerins (CHIN_HUMAN and CHIN_MOUSE) and non—
typical 9a myosins (MYO9_HUMAN and MYO9_MOUSE). RGA1_SCHP07the best RADS hitiis missed by BLAST. In contrast, BLAST reports the

human and mouse chimaerins as highly signiﬁcant hits.

3.4 Case studies

Next, we investigated hits where RADS obtains a high score,
while BLAST does not show a signiﬁcant hit or, Vice versa,
hits where RADS reports a poor score, while BLAST reports
significant similarity. In the following, we demonstrate two se-
lected examples.

3.4.1 Yeast Rho-GTPase—activating proteins The yeast species
Saccharomyces cerevisiae and Schizosaccharomyces pombe both
contain paralogs of yeast Rho-GTPase-activating (RGA) pro-
teins. RGA proteins are characterized by an N-terminal LIM
domain, a repetitive central region and a C—terminal RhoGAP
domain (Table 2). We performed a BLAST search (e value
<10’3) against UniProt using the protein RGA3_SCHPO as
query. As the RGA protein family exhibits a high degree of se-
quence divergence (Tcherkezian and Lamarche—Vane, 2007),
BLAST does not find all subjects with a similar or identical
domain arrangement. In contrast, some proteins in human and
mouse with a different function and domain arrangement such as
chimaerins (CHIN_HUMAN and CHIN_MOUSE) or non-typ-
ical 9a myosins (MYO9_HUMAN and MYO9_MOUSE) are

reported as signiﬁcant BLAST hits owing to high similarity
within the RhoGAP domain. BLAST correctly identiﬁes several
fungal proteins with a domain arrangement similar to that of the
query (e.g. RGA4_SCHPO and RGA2_YEAST), but fails to
identify distant homologs. BLAST does not report, for instance,
the RGA1_SCHPO protein, which has exactly the same arrange-
ment as the query and comes from the same species S.pombe.
Similarly, BLAST fails to identify the S.cerevisiae protein
LRG1_YEAST, which exhibits an arrangement that only differs
from the query by an additional third LIM domain. In contrast,
RADS reports this protein and other identical arrangements with
high scores and is therefore able to find more remote homologs.
The identiﬁcation of remote homologs that escape BLAST
searches but have similar domain arrangements is of high im-
portance because they are usually considered to have a more
similar function (Gerstein and Hegyi, 2001). We report
e values and RADS scores for the query and relevant hits in
Table 2 (an exhaustive list is provided in the Supplementary
Material S4.1).

3.4.2 Phosphomannomutases Phosphomannomutases are a
large family of enzymes containing a highly conserved domain

 

279

112 /3.10's112u.m0fp.101x0"s01112u1101u101q/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

N. Terrapon et al.

 

AZVPEJ EZVPSd

21%

24%

CTTK‘I‘I
C929C4

22%

 

¥ 21%|
1 39%

.mujuu .PGILPMILII
.mnjmun ‘PGILPMILN
'Hexupep *IITPJI'allslerue

Fig. 3. Example results of a combined RADS/BLAST search in enzyme
family of phosphomannomutases illustrating the differences between the
two algorithms. Left: comparison between the original query
(A2VP54_MYCTU) and a protein with the same domain arrangement
(C7TXY1_SCHJA, a putative phosphoglucomutase) and high RADS
score that is not detected by BLAST at an e value of 0.1; Right:
comparison with a signiﬁcant (e value <10’6) BLAST hit
(C9Z9C4_STRSW) with little agreement with the query in domain
arrangement

arrangement of four domains (PGM_PMM I-IV, Fig. 3). Owing
to high sequence divergence between members of the family, a
sequence-based search using one family member as query may
not necessarily find the entire family. With RADS or other
domain-based approaches, all conserved arrangements are
found in one step, and will furthermore be shown as more
closely related than proteins containing only a strong, but
local, similarity. Starting with one Phosphomannomutase
(A2VP54_MYCTU) as query, we performed a BLAST and a
RADS search against the whole UniProt database. The com-
bined search (BLAST+ RADS) reports 10396 hits, which con-
tain all 8078 proteins with the same domain arrangement as the
query. BLAST detects 6758 proteins at an e value cut-off of 10’3,
1065 of those have a different domain arrangement. Therefore,
BLAST misses 2385 (29.5%) proteins with the same domain ar-
rangement as the query (more details in the Supplementary
Material S42).

4 CONCLUSION

It has been shown that proteins with identical multi-domain ar-
rangements have similar function in 90% of all cases, whereas
35% of multi-domain proteins sharing only one domain are
functional homologs (Gerstein and Hegyi, 2001). We therefore
consider the RADS approach to identify all identical arrange-
ments to a given query as a fast and valuable step in determining
protein similarity across large datasets. For single-domain pro-
teins and proteins that lack domain annotation, however,
sequence-based algorithms provide more relevant results as
they are able to identify local similarities, which are crucial in
distinguishing close homologs. RAMPAGE alleviates this prob-
lem and perform with similar sensitivity but signiﬁcantly faster
than BLAST (Supplementary Material S5).

We propose that RADS is complementary to sequence simi-
larity-based approaches and that exploiting domain arrange-
ments for similarity search is, in particular for multi-domain
proteins, an important means for identifying functional homo-
logs. Although RADS explicitly disregards sequence information
at the alignment stage, the comparison of domains is nonetheless
driven by sequence information, as multiple sequence alignments
are used to construct the proﬁle. Indeed, such sequence proﬁles
are sensitive, as they in essence describe the variation at the se-
quence level of a large set of related proteins. This is particularly
valuable when dealing with the increasing amount of available
sequence data, as the ability to use the strong discrimination
power of hidden Markov models (HMMs) or other proﬁle-
based methods can be used to initially reduce search space.
The sensitivity of RADS/RAMPAGE is theoretically compar-
able with proﬁle-based searches such as PSI-BLAST (Schaffer
et al., 2001), yet a sensitive similarity search can be achieved
without compromising the actual search time because the com-
putationally heavy stage is shifted to protein annotation.
However, recent advancements in the HMMER package
(Eddy, 2011) have made on—the-ﬁy annotation of protein do-
mains feasible, such that a RADS search is swift even for raw
sequence queries. Several published approaches use domain com-
position or arrangements for homology detection (Table 1).
Nonetheless RADS/RAMPAGE will be a valuable resource
for the communityifor several reasons. First, CDART
(Geer et al., 2002) does not rank results based on domain ar-
rangement similarity. Rather, it provides the user with the
number of shared domains without taking any additional
domain or sequence information into account. Moreover, be-
cause CDART uses custom-deﬁned domain deﬁnitions, results
are difﬁcult to compare with more widespread domain deﬁn-
itions such as Pfam. Second, the domain distance introduced
by Bjérklund et al. (2005) provides a simple but efﬁcient
metric for describing the dissimilarity of domain arrangements,
which is deﬁned as the number of domains that remain unaligned
in a global alignment of domain arrangements. Forslund et al.
(2011) recently published an analogous approach where domain
arrangement similarity is expressed as the number of aligned
domains. To the best of our knowledge, neither of these metrics
has been implemented in a publicly available resource. Third, in
the most recently described method (Lee and Lee, 2009), which
includes a web interface, the authors proposed a complex meas-
ure based on information theory that combines the domain com-
position similarity with ordered pairs and domain duplications.
However, the method is ‘kingdom’-dependent (Eukaryota,
Bacteria, Archea), limiting the possibility of large-scale, cross
kingdom comparisons. Furthermore, the scoring system as
implemented has not been tested on large datasets and we were
unable to reproduce the results provided by the web interface,
which only reports the 10 most similar arrangements and seems
to be outdated (2009). Fourth, we ﬁnd that RADS/RAMPAGE
perform signiﬁcantly faster than all other methods tested in this
study (Supplementary Material S4). Finally, we provide a set of
implementations to meet the needs of various groups. We pro-
vide a fast C-based command-line application for running
custom domain-string comparisons, a web interface for querying
UniProt with Pfam and a command-line JAVA application for
querying the web interface in batch mode, which can also be used

 

280

112 /3.10's112u.m0fp.101x0"s01112u1101u101q/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

Similarity search using domain arrangements

 

as a JAVA library for programmatic access. Furthermore, we
have integrated the RADS/RAMPAGE search into a GUI-
based tool termed DoMosaics, which is available for download
from http://domosaics.uni-muenster.de (Moore et al., 2013).

In summary, the complementary approaches RADS and
RAMPAGE and their implementations allow for fast similarity
searches using domain arrangement comparisons. The web
service provides a fine-grained arrangement scoring with user-
adjustable parameters and comparison with BLAST. Results can
be ordered, filtered by scores and/or reduced to non-redundant
arrangements. Searches can be saved and downloaded, and we
are currently developing new ﬁlters to allow for taxon- and spe-
cies-speciﬁc searches. To ensure that the sequence database of
the web service remains current, we are using Pfamseq annota-
tions, and have developed routines to ensure that this resource is
updated with each new Pfam release. Given the large amount of
sequence data that has so much become an integral part of
modern biological analysis and the increasing speed of profile-
based annotation methods, we believe that both RADS and
RAMPAGE will prove useful in identifying homology of inter-
est, and that it can help to put the available data to work in
pursuing interesting and relevant questions in molecular biology
and evolution.

ACKNOWLEDGEMENT

E.B.B. gratefully acknowledges many useful and encouraging
discussions with Spices from the Janet Thronton group during
a sabbatical at EBI in 2009.

Funding: DFG (Deutsche Forschungs Gemeinschaft) (B0 2445/
4-1 to BBB.)

Conﬂict of Interest: none declared.

REFERENCES

Altenhoff,A.M. et al. (2011) OMA 2011: orthology inference among 1000 complete
genomes. Nucleic Acids Res., 39, D2897D294.

Altschul,S.F. et al. (1990) Basic local alignment search tool. J. Mol Biol, 215,
403410.

Altschul,S.F. et al. (1997) Gapped BLAST and PSI—BLAST: a new generation of
protein database search programs. Nucleic Acids Res., 25, 338973402.

Beaussart,F. et al. (2007) Automated improvement of domain annotations using con—
text analysis of domain arrangements (AIDAN). Bioinformatics, 23, 183441836.

Bj0rklund,A.K. et al. (2005) Domain rearrangements in protein evolution. J. Mol
Biol, 353, 9117923.

Boratyn,G.M. et al. (2012) Domain enhanced lockup time accelerated blast. Biol.
Direct, 7, 12.

Buljan,M. et al. (2010) Quantifying the mechanisms of domain gain in animal pro—
teins. Genome Biol, 11, R74.

Chothia,C. and Gough,J. (2009) Genomic and structural aspects of protein evolu—
tion. Biochem. J., 419, 1&28.

Eddy,S. (201 1) Accelerated proﬁle HMM searches. PLoS Comput. Biol, 7, e1002195.

Eddy,S.R. (1998) Proﬁle hidden Markov models. Bioinformatics, 14, 7557763.

Enright,A.J. and Ouzounis,C.A. (2000) GeneRAGE: a robust algorithm for se—
quence clustering and domain detection. Bioinformatics, 16, 451457.

Forslund,K. et al. (2011) Domain architecture conservation in orthologs. BMC
Genomics, 12, 326.

Geer,L.Y. et al. (2002) CDART: protein homology by domain architecture. Genome
Res., 12, 161971623.

Gerstcin,M. and Hegyi,H. (2001) Annotation transfer for genomics: measuring
functional divergence in multi—domain proteins. Genome Res., 11, 163271640.

Gonzalez,M.W. and Pearson,W.R. (2010) Homologous over—extension: a challenge
for iterative similarity searches. Nucleic Acids Res., 38, 217772189.

Hunter,S. et al. (2012) Interpro in 201 1: new developments in the family and domain
prediction database. Nucleic Acids Res., 40, D30(rD312.

Johnson,L.S. et al. (2010) Hidden Markov model speed heuristic and iterative
HMM search procedure. BMC Bioinformatics, 11, 431.

Karlin,S. and Altschul,S.F. (1993) Applications and statistics for multiple high—
scoring segments in molecular sequences. Proc. Natl Acad Sci. USA, 90,
587375877.

Kummerfeld,S.K. and Tcichmann,S.A. (2009) Protein domain organisation: adding
order. BMC Bioinformatics, 10, 39.

Lee,B. and Lee,D. (2008) DAhunter: a web—based server that identiﬁes homologous
proteins by comparing domain architecture. Nucleic Acids Res., 36, W6(%W64.

Lee,B. and Lee,D. (2009) Protein comparison at the domain architecture level.
BMC Bioinformatics, 10, S5.

Lin,K. et al. (2006) An initial strategy for comparing proteins at the domain archi—
tecture level. Bioinformatics, 22, 208172086.

Marchler—Bauer,A. et al. (2007) CDD: a conserved domain database for interactive
domain family analysis. Nucleic Acids Res., 35, D2377D240.

Moore,A.D. et al. (2008) Arrangements in the modular evolution of proteins.
Trends Biochem. Sci., 33, 444451.

Moore,A.D. et al. (2013) DoMosaics: software for domain arrangement visualiza—
tion and domain—centric analysis of proteins. Bioinformatics (in press).

Needleman,S.B. and Wunsch,C.D. (1970) A general method applicable to the
search for similarities in the amino acid sequence of two proteins. J. Mol
Biol, 48, 443453.

Pasek,S. et al. (2005) Identiﬁcation of genomic features using microsyntenies of
domains: domain teams. Genome Res., 15, 8677874.

Pearson,W.R. and Lipman,D.J. (1988) Improved tools for biological sequence com—
parison. Proc. Natl Acad. Sci. USA, 85, 2444w2448.

Punta,M. et al. (2012) The pfam protein families database. Nucleic Acids Res., 40,
D29(%D301.

Schaffer,A.A. et al. (2001) Improving the accuracy of PSI—BLAST protein database
searches with composition—based statistics and other reﬁnements. Nucleic Acids
Res., 29, 299443005.

Sj01ander,K. et al. (2011) Ortholog identiﬁcation in the presence of domain archi—
tecture rearrangement. Brief. Bioinform., 12, 413422.

Smith,T.F. and Watcrman,M.S. (1981) Identiﬁcation of common molecular subse—
quences. J. Mol Biol, 147, 1957197.

Song,N. et al. (2008) Sequence similarity network reveals common ancestry of
multidomain proteins. PLoS Comput. Biol, 4.

Spang,R. and Vingron,M. (1998) Statistics of large—scale sequence searching.
Bioinformatics, 14, 2797284.

Subramanian,A.R. et al. (2005) DIALIGN—T: an improved algorithm for segment—
based multiple sequence alignment. BMC Bioinformatics, 6, 66.

Tchcrkczian,J. and Lamarche—Vane,N. (2007) Current knowledge of the large
rhogap family of proteins. Biol. Cell, 99, 67786.

Tcrrapon,N. et al. (2009) Detection of new protein domains by co—occurrence: ap—
plication to Plasmodiumfalciparum. Bioinformatics, 23, 307773078.

UniProt Consortium. (2012) Reorganizing the protein space at the universal protein
resource (uniprot). Nucleic Acids Res., 40, D717D75.

Wang,M. and Caetano—Anolles,G. (2009) The evolutionary mechanics of domain
organization in proteomes and the rise of modularity in the protein world.
Structure, 17, 6(r78.

Weiner,J. 3rd et al. (2005) Rapid motif—based prediction of circular permutations in
multi—domain proteins. Bioinformatics, 21, 9327937.

Weiner,J. 3rd et al. (2006) Domain deletions and substitutions in the modular pro—
tein evolution. FEBS J., 273, 203772047.

Werren,J.H. et al. (2010) Functional and evolutionary insights from the genomes of
three parasitoid nasonia species. Science, 327, 3437348.

 

281

112 /310's112u1n0fp101x0'so1112111101u101q//:d1111 111011 pap1201um0q

9103 ‘0g1sn8nv u0 ::

