BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

T.M.Drucker et al.

 

Keys are 32 bits in length (32 encoded consecutive base pairs) and
index into an array of 232 (4294967296) slots, requiring ~30 GB of
RAM per hash table. During hash table creation, keys are generated
every base pair (31-bp overlap between consecutive keys), with the asso-
ciated slot being populated with the reference genome position. A single
slot may contain up to 215 (32 768) reference genome positions. During
read mapping, keys are typically generated every 8bp (24-bp overlap
between consecutive keys) over the entire read in both orientations
(forward and reverse compliment). A 100-bp read will have 60 keys gen-
erated (10 keys per orientation >< two orientations >< three encodings)
during mapping. Overlapping keys generated from the entire read
ensure that a subset of keys do not bridge biotin or breakpoint junctions.

A list of candidate positions for each read is generated from the ref-
erence positions associated to the keys created from the read. To reduce
runtime, keys associated to >750 reference genome positions are excluded
from processing, unless too few keys generate candidate positions (refer-
ence 0 or >750 positions). If two candidate positions for a single read are
within 50 bp (e.g. keys from separate parts of the read associate to refer-
ence genome positions close in locality), the read is evaluated for an InDel
at the leftmost candidate position.

All candidate positions are scored using fast binary operations (XOR
and POPCOUNT) to count the base pairs from the read that do not
match the reference genome. An optimal concordant alignment is gener-
ated by evaluating the combined score of every pair of candidate pos-
itions from each read that is within the expected insert size. An optimal
discordant alignment is generated by selecting the overall best combined
score paired alignment. If a junction is detected in either the concordant
and/or discordant alignments, their score/s are adjusted. A 5% scoring
penalty is applied to the discordant alignment (favoring concordant align-
ments), and the highest scoring paired alignment is reported.

BIMA V3 is implemented in C, leverages OpenMP for index and
alignment parallelization, supports 64-bit Linux operating systems and
uses standard file formats (fastq and SAM). BIMA supports read pairs
with individual read lengths between 64 and 512bp and efficiently scales
up to 16 concurrent threads. BIMA does not currently support single-end
reads.

3 RESULTS

The accuracy and execution time of BIMA V3 were compared
with two popular NGS alignment programs, Burrows—Wheeler
Aligner (BWA; Li and Durbin, 2009) and Novoalign (http://
www.novocraft.com). Two data sets, one synthetic and one
real, were used to measure alignment accuracy and single
threaded execution time. Each data set consisted of
1000000 MP read pairs (2000000 total reads), each 100 bp in
length. The whole—genome simulator for Next—Generation
Sequencing (dwgsim) (https://github.com/nh13/DWGSIM/wiki)
were used to generate and evaluate the synthetic data set (Table
1). The real data set was sequencing from the lymph node pros—
tate cancer cell—line (LNCAP) (prostate adenocarcinoma) and
was evaluated by comparing the reference genome position pre—
dicted by the NGS alignment programs with reference genome
positions predicted by BLAST—like alignment tool (BLAT; Kent,
2002; Table 2).

The synthetic data set (Table 1) portrays all evaluated aligners
being roughly equivalent in accuracy (BIMA having a slight ad—
vantage) but vary signiﬁcantly in alignment time. Unfortunately,
synthetic MP sequencing does not accurately model all artifacts
present in real MP sequencing (biotin/breakpoint junctions,
paired—end read contamination, chimeras, etc). Both Novoalign
and BWA require a considerable amount of additional

Table 1. Evaluation of synthetic mate-pair read pairs (dwgsim)

 

BIMA BWA Novoalign

 

Time to align(s) 489 870 7378
Correctly mapped (%) 92.27 90.82 91.04
Incorrectly mapped (%) 2.27 3.51 3.50
Unmapped that should be mapped (%) 0.00 0.21 0.00
Unmapped that should not 5.46 5.46 5.46

be mapped (%)

 

One million synthetic mate—pair read pairs were generated with dwgsim from the
th9 human reference genome (100—bp reads, 4 000—bp insert, 054.5% error rate,
0.1% mutation rate, etc). Alignment time, in seconds, was captured on a single core
of an Intel Xeon 2.9—GHz E5—2690. See Supplemental materials for an expanded
comparison (including Burrows—Wheeler Aligner Maximal Exact Matches; BWA—
MEM), algorithm invocation details and the full dwgsim_eval reports.

Table 2. Evaluation of real mate-pair read pairs (LNCAP)

 

BIMA BWA Novoalign

 

Time to align(s) 606 3260 11 091
Within 50 bp of a BLAT result (%) 85.17 60.67 74.35
Not mapped by algorithm (%) 7.29 34.74 21.50
Not mapped by BLAT (%) 1.03 0.49 0.69
Exactly matches a BLAT result (%) 68.76 56.96 68.44
1750 bp distant from a BLAT result (%) 16.42 3.71 5.91
More than 50 bp distant from a 6.51 4.11 3.46

BLAT result (%)

 

The LNCAP cell line was sequenced using an optimized Illumina mate pair protocol
(Murphy et ul., 2012), 100—bp reads, ~2400—bp insert, etc. One million read pairs
were aligned on a single core of an Intel Xeon 2.9—GHz E5—2690. Reported reference
genome positions were compared with individual read alignments predicted by
BLAT. See Supplemental materials for an expanded comparison (including
BWA—MEM), algorithm invocation details and a detailed explanation of the ana—
lysis performed.

processing time (~50% to ~250%) to deliver signiﬁcantly
fewer accurately mapped reads (~10% to ~25%) on real MP
sequencing (Table 2).

BIMA V3’s utilization of three hash tables with 32—bit keys
requires a significant amount of process memory, 128 GB during
hash table creation and 100 GB during alignment, compared
with Novoalign and BWA (8 GB and 5GB, respectively). It is
faster for BIMA to generate indexes during every invocation
(~800 seconds using three threads), than read in a compressed
pre—computed index from a shared file system. Because
Novoalign and BWA pre—compute their indexes, the alignment
times reported in Tables 1 and 2 do not include index generation.

BIMA V3 accurately aligns more MP reads in less time than
popular NGS alignment programs, enabling researchers to dis—
cover more structural variants with less coverage. Researchers
are already using it to develop new genetic testing methods
(K.Cradic et al., manuscript submitted) and reprocess 100s of
existing MP data sets to identify previously undetected structural
variants.

Funding: Center for Individualized Medicine, Mayo Clinic

 

1 628

ﬁm'spzumol‘pmjxo'sopeuuowrorq/ﬁdnq

BIMA V3

 

Conﬂict of Interest: none declared.

REFERENCES

Feldman,A.L. et a]. (2011) Discovery of recurrent t(6;7)(p25.3;q32.3) translocations
in ALK—negative anaplastic large cell lymphomas by massively parallel genomic
sequencing. Blood, 117, 9157919.

Kent,W.J. (2002) BLATithe BLAST—like alignment tool. Genome Re.\'., 12,
65(r664.

Kovtun,I.V. et a]. (2013) Lineage relationship of Gleason patterns in Gleason score
7 prostate cancer. Cancer Re.\'., 73, 327573284.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows—
Wheeler transform. Bioinformutiex, 25, 17544760.

Li,H. and Homer,N. (2010) A survey of sequence alignment algorithms for next—
generation sequencing. Brief. Bioinform., 11, 4734183.

Murphy,S.J. et a]. (2012) Mate pair sequencing of whole—genome—amplified DNA
following laser capture microdissection of prostate cancer. DNA Re.\'., 19,
3954106.

Vasmatzis,G. et a]. (2007) Quantitating tissue specificity of human genes to facilitate
biomarker discovery. Bioinformutiex, 23, 134871355.

Vasmatzis,G. et a]. (2012) Genome—wide analysis reveals recurrent structural
abnormalities of TP63 and other p53—related genes in peripheral T—cell lymph—
omas. Blood, 120, 228(k2289.

 

1 629

/810'spzum0fp10}x0"sotJBuIJOJutotqﬂ:duq

