ORIGINAL PAPER

Vol. 28 no. 20 2012, pages 2569—2575
doi:10. 1093/bioinformatics/bt5501

 

Genome analysis

Advance Access publication August 22, 2012

An empirical Bayes mixture model for SNP detection in pooled

sequencing data
Baiyu Zhou*

Department of Epidemiology & Population Health, Albert Einstein College of Medicine, Bronx, NY 10461, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Detecting single-nucleotide polymorphism (SNP) in
pooled sequencing data is more challenging than in individual sequen-
cing because of sampling variations across pools. To effectively dif-
ferentiate SNP signal from sequencing error, appropriate estimation of
the sequencing error is necessary. In this article, we propose an em-
pirical Bayes mixture (EBM) model for SNP detection and allele fre-
quency estimation in pooled sequencing data.

Results: The proposed model reliably learns the error distribution by
pooling information across pools and genomic positions. In addition,
the proposed EBM model builds in characteristics unique to the
pooled sequencing data, boosting the sensitivity of SNP detection.
For large-scale inference in SNP detection, the EBM model provides
a flexible and robust way for estimation and control of local false dis-
covery rate. We demonstrate the performance of the proposed
method through simulation studies and real data application.
Availability: Implementation of this method is available at https://sites
.google.com/site/zhouby98

Contact: baiyu.zhou@einstein.yu.edu

Received on April 22, 2012; revised on July 6, 2012; accepted on
August 8, 2012

1 INTRODUCTION

Recent advances in next-generation sequencing (NGS) technolo-
gies have signiﬁcantly reduced the cost and time involved in
sequencing the human genome in hundreds or thousands of indi-
viduals. The resulting comprehensive genomic analyses will pro-
vide powerful tools for discovering the genetic variations
underlying complex phenotypic traits. NGS holds the promise
of revolutionizing genetic studies due to its ability to detect rare
variants that are not observed in array-based genome-wide asso-
ciation studies (GWAS). The importance of rare variants under-
lying complex diseases has been discussed in a number of recent
articles (Bodmer and Bonilla, 2008; Cohen et al., 2006; Ji et al.,
2008). It is believed that rare variants account for a signiﬁcant
proportion of genetic heritability missed by previous GWAS
(Manolio et al., 2009). Although the cost of NGS has dropped
dramatically over the past few years, it is still prohibitively expen-
sive to sequence individual genome at a sufﬁcient read depth. An
alternative approach to reduce the cost of sample preparation and
sequencing is to pool genomic DNA from multiple individuals
and sequence the pooled DNA samples (Kim et al., 2010; Wang
et al., 2010). The feasibility of pooled sequencing has been

 

*To whom correspondence should be addressed.

demonstrated in several studies (Bansal et al., 2011; Nejentsev
et al., 2009). Nejentsev et a]. (2009) used pooled sequencing to
identify causal rare variants in candidate genes of Type I diabetes.

When analyzing NGS data, the ﬁrst step is to identify
polymorphic sites in the genomic regions. A number of compu-
tational methods have been developed to identify single-
nucleotide polymorphisms (SNPs) in individual sequenced sam-
ples (Bansal et al., 2010; Koboldt et al., 2009; Li et al., 2008;
Martin et al., 2010; Muralidharan et al., 2011; Zhou and
Whittemore, 2012). These methods use sequencing and mapping
quality scores to distinguish true SNPs from sequencing and
mapping errors. Some methods utilize cross-sample information
to estimate sequencing error at each genomic position (Bansal
et al., 2010; Martin et al., 2010; Muralidharan et al., 2011; Zhou
and Whittemore, 2012). In addition, incorporation of pedigree
information and linkage disequilibrium (LD) has been demon-
strated to significantly improve SNP calling accuracy in individ-
ual sequencing (Zhou and Whittemore, 2012).

Methods for individual sequencing do not directly apply to
SNP calling in pooled sequencing. Characteristics unique to
pooled sequencing make SNP calling more challenging than in
individual sequencing. First, because of sampling variation, the
frequency of a variant allele will vary across the pools. Allele
frequency in a pool is a function of the population allele fre-
quency and pool size (number of individuals in a pool; Bansal,
2010). In cases in which there exists a rare variant with small pool
size, the presence of the variant allele will be sporadic across
pools. In contrast, in individual sequencing, the variant allele
frequency for a diploid sample is 0, 0.5 or 1. Variation of allele
frequency across pools makes it difficult to differentiate the true
SNP signal from sequencing error. Second, external information,
such as pedigree and LD information, is not available in pooled
sequencing. Third, because of the small number of pools, it is
almost impossible to get a good estimate of the sequencing error
using only cross-pool information. Therefore, sophisticated
methods are needed to call SNPs in pooled sequencing.

Recently, several SNP calling methods designed for pooled
sequencing have been reported (Bansal, 2010; Druley et al.,
2009; Wei et al., 2011). SNPSeeker (Druley et al., 2009), derived
from large deviation theory, requires negative control data to es-
timate error model. CRISP (Comprehensive Read analysis for
Identiﬁcation of Single Nucleotide Polymorphisms from Pooled
sequencing, Bansal, 2010) models allele counts across multiple
pools using contingency tables. It uses Fisher’s exact test to
detect uneven distributions of variant reads across pools and
then uses Chernoff bound to compute an upper bound on the
P—Value of the overabundance of alternate alleles within each

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 2569

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

B.Zhou

 

pool against the sequencing error. This method builds on the as-
sumption that the presence of a rare variant in a pool is likely to
cause excess variant reads compared with the other pools. Such an
assumption does not hold for less rare or common variant and
is questionable when the pool size is large. Consequently, CRISP
is not effective for detection of less rare and common SNPs. As an
alternative approach, SNVer (Wei et al., 2011) models variant
reads in a single pool using a binomialibinomial model and com-
bines P—Values from multiple pools to identify SNPs. Because it
is difﬁcult to simultaneously estimate the population allele
frequency and sequencing error using the binomialibinomial
model, SNVer arbitrarily speciﬁes the sequencing error to be
0.01 for all positions. As we show in the simulation studies,
inaccurate speciﬁcation of sequencing error will lead to high
false-positive rates and low sensitivity.

In this article, we introduce an empirical Bayes mixture (EBM)
model for detecting SNPs in pooled sequencing data. In contrast
to the existing methods that detect SNPs one at a time, the EBM
model learns error distribution by pooling information across
multiple pools and genomic positions. It is well known that the
sequencing error at each position is highly reproducible across
samples or pools. Cross-sample information in individual
sequencing has been gathered to estimate sequencing error.
However, in pooled sequencing, direct estimation sequencing
error has not been explored due to the small number of pools
available and the variations of allele frequency across pools.
Additional information is needed to obtain a good estimate of
the sequencing error in pooled sequencing. Using the EBM
model, data across genomic positions can be pooled to learn
the error distribution. Since the density of a SNP is estimated
to be approximately 1 of 1000 bases (Wei et al., 2011), leveraging
the information from a large number of null positions will allow
fairly accurate estimation of the error distribution.

The fundamental idea of pooling information to estimate null
distribution in empirical Bayes methods has been applied to gen-
omic data since the advent of microarray analysis (Efron et al.,
2001). Recently, Muralidharan et a]. (2011) extended Efron’s em-
pirical Bayes method to detect SNPs in individual sequencing. In
this article, different from previous methods, we propose an
EBM model that builds in characteristics unique to pooled
sequencing for SNP detection. The EBM model blurs the line
between hypothesis testing and parameter estimation. In addition
to SNP detection, the proposed method produces empirical
Bayes shrinkage estimation of allele frequency. Allele frequency
estimation is important for downstream analyses, such as asso-
ciation studies or population genetic analysis. Yet, it is left un-
explored by the current SNP detection methods. In the EBM
model, SNP detection and allele frequency estimation are nicely
integrated. In the following sections, we will present mathemat-
ical formulation of the EBM model and demonstrate its perform-
ance through simulation studies and a real data application.

2 METHODS

Our objective is to build an EBM model to pool information across gen-
omic positions and utilize sequence reads from multiple pools to identify
SNPs. Consider a sequencing study in which a targeted region of I nu-
cleotides is sequenced in K pools. Each pool contains n diploid individuals
(i.e. 2n haplotypes, n is not necessarily equal across pools). We assume

that the reads from each pool have been aligned to a reference genome.
Suppose there are N ,1- reads covering position i in pool j, among which Vi]-
are mismatches (Vij- is the count of the most frequent non-reference base
and we ignore reads of other bases). In the absence of a variant, mis-
matched reads are merely the result of sequencing error (base calling error
or/and alignment error) and are expected to be similar across pools since
most sequencing errors are local context dependent (Bansal, 2010). On the
other hand, the presence of a variant will result in excessive mismatches in
one or more pools, and the variant allele reads distribution is likely to be
uneven across pools for rare variants. Existing methods, such as CRISP,
use the uneven distribution across pools as a signal to identify SNPs. Our
proposed EBM model also incorporates such cross-pool information to
enhance the sensitivity of SNP detection. In addition, the EBM model
pools data across genomic positions to learn the error distribution. Due to
small number of pools, sequencing error is difﬁcult to estimate from the
data for each individual position. To overcome this difﬁculty, empirical
Bayes approach speciﬁes a prior distribution on position-speciﬁc param-
eters and learns the prior distribution by aggregating the data across dif-
ferent positions. Simultaneously incorporating information across pools
and positions increases the sensitivity for detection of true SNP sites.
Next, we present the detailed formulation of the EBM model.

2.1 EBM model

For a particular position i in pool j, we model the mismatch counts Vi]- as
drawn from a binomial distribution V,-- ~ Binomial(N,—-, 1),-j). Instead of
specifying an EBM model for Vij, we ﬁrst apply a normalizing and vari-
ance stabilizing transformation to the data (Vij, Nil):

Z,-- = arcsin J +‘: (1)

ij+2

 

Brown (2008) has shown that transformed data are approximately
normal for moderate or large size of Ni]- (for example, Ni]- : 12):
Z; ~ N(p.,-j, 4+”) and m]- : arcsin  By using equation (1), the count
data are transformed to more familiar Gaussian data. Importantly,
the transformation equation (1) ensures the variance of Z; is known
and independent of Mg.

Data across pools are collected into vectors. Let Z,- =(Z,-1,...,Z,-K)’
and p,- = ([141th2, . . . , uiK)’. Bold letters are used to denote vectors and
matrices. We assume (Z,, 11,) are generated from the following hierarch-
ical model:

Pi ~ MM): Zillli ~ N(il,-, 2If), (2)

where 2,- : diag(,ﬁil , . . . , ﬂ) is the diagonal matrix whose elements are
4+”. In this hierarchical model, Zij is independently normal with a vari-
ance of 4%,", conditioned on the mean vector 11,-. The empirical Bayes
approach oes not specify the prior distribution h in advance. Instead,
it models h using a mixture of multivariate Gaussians and estimates the
mixture distribution from the data. The mixture Gaussians can approxi-
mate any smooth density and gives a ﬂexible and nearly non-parametric
way to model the prior distribution (Liao et al., 2004; Muralidharan,

2010; Pan et al., 2003). Speciﬁcally, let

Go+Gl

he.) = Z) @1190»). (3)

g:l

where each component hlg)(p,-) = N(vg, Agi) is a multivariate normal with
mean vg and covariance Agi. 11g are unknown mixture proportions. In the
mixture distribution, g = 1, 2. . . , G0 are null components used to capture
the sequencing error distribution. The remaining non-null components
capture true SNP signals that are beyond the error distribution.

For a null position i, we expect its pijs (i.e. sequencing error) is ap-
proximately the same across pools, so 11,- is a constant vector with equal
components: p.“ 2 an 2 >~= am. To impose this constraint on the

 

2570

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

91oz ‘Og isnﬁnv uo ::

An EBM model for SNP detection

 

null components of equation (3), let P = K’lee’ be the K x K projection
matrix onto the rank 1 space of constant vectors, where e’ = (1, . . . , 1)
is a K x 1 vector of 1 5. Let Q = IK — P be the projection matrix onto
the orthogonal complement of R(P). We can write any vector
p,- 2 Pp,- + Qni. For the null position i, the second term Q11,- vanishes.
Given 2,, we model it,- drawn from the g th null component as

11,12, ~ N(vge, rgP2,P), (4)

where vgand 1g are scalars. The covariance matrix rgP2,P guarantees that
n,- is a constant vector. For a SNP position 1', whose n,- is drawn from a
non-null component g, we model the distribution of n,- as

"ilzi ~ N(Vg, rgPEiP + Kngl-Q) (5)

The extra component KgQ2,Q adds further variance to n,- so that the n,-
beoomes a non-constant vector. The hyper-parameters (vg, 1g, Kg) will be
estimated from the data by pooling information across positions.

Under the hierarchical model (2), the marginal distribution of Z,is the
mixture of multivariate Gaussians:

Go+Gl
ﬂzi) = Z) ngﬂgkzi), (6)
g:1
where ﬂ3)(Z,) = N(vge, rgP2,P + 2,) for g = 1, . . . , G0, ﬁg)(Z,) =
N(vg, rgP2,P + KgQ2,Q + 2,) for g 2 G0 +1, ..., G0 + G. The poster-
ior distribution of nilZ, is also the mixture of Gaussians. It can be easily
shown that

Go+Gl
mil,- ~ Z p<g’(zi)h<g)(u,-iz,-). (7)

g:1
where p(g)(Z,) 2 (ﬁg ﬂ3)(Z,)) /( f(Z,)) is the posterior probability that Z, is
drawn from component g, and h(g)(n,-|Z,) is the posterior distribution
if the prior were Hg). The structure of the model is illustrated in Figure 1.
With this model, we proceed in three steps to call SNPs. We ﬁrst
estimate the parameters 0 = (Hg,vg, Tg,Kg) by maximizing the marginal
likelihood using a modiﬁed expectationimaximization (EM) algorithm.
Details are given in the next section. We then use the estimated param-
eters to ﬁnd the posterior probability that Z, is drawn from the null
components of equation (3). Finally, we use the estimated posterior prob-
ability to call SNPs. The posterior probability that Z, is drawn from the
null components relates to the local false discovery rate (fdr). In statistical
testing framework, let H, be the null hypothesis that the position [is
non-SNP. The fdr is deﬁned as the posterior probability
fdr(z) = P(H, is true |Z, = 2). It is related to the commonly used FDR
and possesses features that are more attractive than FDR in certain scen-
arios. See Efron (2007) and Liao et a]. (2004) for comprehensive

Fig. 1. Hierarchical structure of the EBM model. Z, is observed. vg, 1g
and Kg are hyper-parameters to be estimated from data

discussions about FDR. The EBM model makes it straightforward to
calculate FDR. Speciﬁcally,

Go G0 g) Zi
fdr(Z,-) = Zplgkzg = 2%. (8)
5:21 g:1 I

Positions with FDR less than a pre-speciﬁed threshold are identiﬁed as
SNP sites.
For SNP sites, we estimate the mean vector p,— by its posterior mean:

Go+Gl
11,-: Eat-|Z,) = Z p<g)(Z.-)E<g>(u,-izi). (9)

g:l

where HERE-|Z,) is the posterior mean under h(g)(n,-|Z,). The empirical
Bayes estimator shrinks the positional estimate toward the common

mean shared across positions. The allele frequency estimate is obtained

by [31' = 117 szl Sim/2:7)?

2.2 Model ﬁtting and parameter estimation

We ﬁt the EBM model using the expectation-conditional maximization
(ECM) algorithm (Meng and Rubin, 1993). The ECM algorithm replaces
the M-step of the usual EM algorithm with a series of partial maximiza-
tions. It is computationally simpler than using the EM algorithm, yet
possesses many of the same convergence properties.

We ﬁrst deﬁne indicator 8,g = [(11,- is from component g) for each pos-
ition i and treat it as missing data. The log-likelihood for the complete
data (z,, 3%) is 1(z, a) = 2;, Egg“ 8,g(log1'tg +ﬂg)(Z,)). In the E-step,
we compute E(8,g|Z) at the current vales of the parameters. It is then
straightforward to show E(8,g|Z) = ngf(g)(Z,)/ 2530' ngflg)(Z,). In the
CM step, we sequentially optimize parameters using the expected values
of the indicators (for simplicity, we will write 8,gfor E(8,g|Z)). Hg is
updated by ﬁg =%Zf;18,g. vg is estimated by fig 2 2,8,gZ,/ 2,8,g for
non-null components and 13g 2 2,8,g(PZ,)/ 2,8,g for null components,
where PZ, is the projection of Z, on R(P). Using the ﬁtted ﬁg and fig, we
estimate 1g and Kg by maximizing the marginal likelihood of Z.

The EBM model has two tuning parameters: the number of null com-
ponents, G0, and the number of non-null components, G1. The tuning
parameters can be determined using various model selection criteria, such
as Akaike Information Criterion or the Bayesian Information Criterion
(Liao et al., 2004; Muralidharan, 2010; Pan et al., 2003). The tuning
parameters are not critical for the purpose of fitting distribution function
(Pan et al., 2003; Muralidharan, 2010). In the simulations and real data
analysis, we choose G0 = 2 and G1 = 4. We use two null components to
capture the sequencing error distribution and two non-null components
to capture SNP signals beyond the sequencing error. We put other two
non-null components at the same location of the null components but
add KgQ2,Q to the covariance matrix to allow cross-pool variations.
These two non-null components are used to detect rare variants, whose
signals are at the same level or lower than the sequencing error but exhibit
cross-pool variations.

For starting values, we use 11g 2 0.498 and 11g 2 0.001 for the null and
non-null components. We initialize the center vg of the two null compo-
nents (and two non-null components) at 40% and 80% quantile of the
data. The centers of the two remaining non-null components are set to
be at the 92.5% and 97.5% quantile of the data. We initialize 1g and Kg to
be 1. After initialization, the ECM iterations will ﬁne-tune the parameters
and reach the ﬁnal estimate.

3 RESULTS

3.1 Simulations studies

We simulate synthetic data to evaluate the performance of
the EBM model and compare it with other methods. Data are

 

2571

112 /310's112u1n0[p10}x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIII/lAOG

91oz ‘Og isnﬁnv uo ::

B.Zhou

 

Table 1. AUC and false-positive rate of the EBM model

 

 

 

 

 

Read depth 10 50
Pool size 10 25 50 10 25 50
Error MAF
AUC
0.01 0.01 0.809 0.955 0.994 0.817 0.956 0.994
0.05 0.998 1 1 0.998 1 1
0.1 0.999 1 1 1 1 1
0.05 0.01 0.762 0.802 0.842 0.822 0.954 0.986
0.05 0.994 0.997 0.998 0.995 0.999 0.999
0.1 0.999 0.999 1 0.999 0.999 1
Error fdr False-positive rate (x104)
0.01 0.01 0.2 1.0 0.4 1.5 1.6 1.1
0.05 1.2 2.2 1.2 2.4 2.7 2.5
0.1 2.0 2.9 1.5 3.7 3.0 3.6
0.05 0.01 1.1 1.2 1.1 1.2 1.5 0.7
0.05 2.7 2.2 2.2 2.6 3.0 2.1
0.1 3.6 2.7 3.2 3.4 3.7 3.4

 

MAF: minor allele frequency; error: sequencing error generated from uniform (0, 0.01) or uniform (0, 0.05).

generated for a region of 1000 positions. Assuming the ﬁrst 30
positions are SNPs, we simulate sequencing studies with five
pools. Simulations are conducted under each combination of
the following settings: (i) minor allele frequencies (MAF) of
SNPs are 0.01, 0.05 and 0.1, respectively; (ii) the sequencing
coverage is 10x or 50x per haplotype; (iii) the sequencing
error of each position is generated from a random uniform dis-
tribution (0, e), where e=0.01 or 0.05 and (iv) the number of
individuals in each pool (i.e. pool size) is 10, 25 or 50.

We generate 100 datasets under each setting and rank the
position based on the posterior probability of being a SNP.
Positions with high posterior probability of being drawn from
the non-null components in equation (3) are ranked at the top of
the list. Then, we assess the quality of ranking by computing the
area under the receiver operating characteristic (ROC) curve
averaged over the 100 datasets. The ROC curve is the plot of
l-speciﬁcity versus sensitivity, which is equivalent to the Type I
error rate versus l-Type II error rate. The area under the curve
(AUC) value close to one indicates high sensitivity and high
speciﬁcity in identifying true SNPs.

Table 1 shows the AUC of the EBM model for a variety of
settings. Several observations are noteworthy. First, increasing
read depth signiﬁcantly improves the sensitivity of SNP detection
for rare variants with a high sequencing error. The largest im-
provement of AUC (~19%) by increasing read depth comes
from MAF of 0.01 and sequencing error of 0.05. Second, large
sample size helps improve sensitivity, particularly in detecting
rare variants. This is because with larger sample size, rare vari-
ants are more likely to be included in pools. For example, the
probability of presence in at least one pool (assuming ﬁve pools
in total) for a variant with MAF: 0.01 is 99.3% if the pool size
includes 50 samples. This probability dramatically decreases to
63.3% if the pool size is 10 (i.e. with probability 36.7%, the SNP
can never be identiﬁed no matter how sensitive the method is).

Third, the EBM model is sensitive enough to identify SNPs as
long as the read depth is sufﬁcient even in situations where the
signal is weaker than the sequencing error. For example, with
MAF 0.01 and pool size of 50, the SNP signal (1%) is lower than
the sequencing error of 0.05, but the EBM model still achieves
AUC of 0.986 under the read depth of 50. The EBM model is
sensitive enough to detect rare variants because of two reasons.
First, it borrows information from other genomic positions to
help estimate the error distribution. Second, it detects the uneven
distribution of variant reads across pools when a rare variant is
present.

Next, we evaluate the false-positive rate of the EBM model,
which is controlled by specifying the fdr to be less than a certain
threshold. For the data generated above, we call SNPs by setting
the threshold fdr 5 0.001 (0.05 or 0.1). The FDR is estimated by
equation (8). For each threshold, the FDR and false-positive rate
are well controlled (data not shown). We then generate sequen-
cing data as previously described, except all 1000 positions are
non-SNP sites. We use the threshold fdr 5 0.001 (0.05 or 0.1) to
call SNPs. Table 1 shows the false-positive rate under each
threshold, demonstrating that it is effectively controlled.

We then compare the efficiency of ranking candidate SNPs by
different methods. We focus on comparisons with CRISP and
SNVer, since they have been shown to outperform other meth-
ods for SNP calling in pooled sequencing (Bansal, 2010; Wei
et al., 2011). CRISP uses Fisher’s exact test followed by
additional filtering steps. The positions are ranked based on
the P-Values from Fisher’s exact test. In contrast, SNVer ﬁrst
computes a P—Value based on a binomialibinomial model for a
single pool and then uses Simes’ method to calculate a pooled
P—Value for the multiple pools. Positions are ranked by the
pooled P-Value. Table 2 shows the AUC comparisons of the
three methods. We can see that the EBM model outperforms
other methods in every scenario. CRISP has a good sensitivity

 

2572

112 /310's112u1n0[p10}x0"soiJBuiJOJuioiq/ﬁduq 11101} pQPBOIII/lAOG

91oz ‘Og isnﬁnv uo ::

An EBM model for SNP detection

 

Table 2. Comparisons of AUC of different methods for calling SNPs

 

 

 

MAF 0.01 0.05 0.1

Error 0.01 0.05 0.01 0.05 0.01 0.05
EBM 0.994 0.842 1 0.998 1 1
CRISP 0.967 0.826 0.972 0.946 0.969 0.954
SNVer 0.985 0.760 1 0.886 1 0.886

 

Shown are AUCs under different settings of MAF (minor allele frequency) and
error (sequencing error) for pooled sequencing with read depth of 10 per haplotype
and pool size of 50.

for SNP detection when the variant is rare but does less well
when the allele frequency becomes less rare or common. This
is because the working hypothesis of CRISP (i.e. uneven distri-
bution of variant reads across pools) does not hold well for less
rare and common variants. SNVer performs reasonably well
when the assumed error rate matches the true sequencing
error, but is the least efficient in ranking candidate SNPs when
the true sequencing error deviates from the specified error rate.
In practice, the sequencing error is unknown and varies across
position. Specifying an arbitrary error rate for all positions
would be problematic for application of SNVer to real data.

Different from the previous methods, the EBM model inte-
grates hypothesis testing and allele frequency estimation in a
single procedure: By ﬁtting the hierarchical model (2), we
obtain the posterior probability that Z, is drawn from the null
components of the prior distribution (3), based on which the
position iis declared as SNP or null. Meanwhile, we use the em-
pirical Bayes estimator II,- to estimate the minor allele frequency
of a SNP i, i.e. [3, =  singly-)2. As an alternative, the naive
estimator for MAF of SNP i is I}, =  V,j/N,j. We compare
the accuracy of these two estimators by simulating 1000 pos-
itions, among which the ﬁrst 30 positions are SNPs with al-
lele frequencies ranging from 0.01 to 0.3, each incrementing
by 0.01. Estimation accuracy is measured by the total sum
of squared errors (SSE) deﬁned as: SSE:  —p,)2 or
SSE = 2,3210), — 10,)2 for the two estimators respectively,
where p, is the true allele frequency. The SSE averaged over
100 datasets is plotted in Figure 2 for a variety of settings. The
EB estimator outperforms the naive estimator in every setting.
The improvement is more noticeable when the sample size is
small. By pooling information across positions, the EB estimator
overcomes the small sample size and improves the allele fre-
quency estimation.

3.2 Real data application

We applied the EBM model to analyze pooled sequencing data
downloaded from Bansal et a]. (2011). One hundred HapMap
samples including 20 Utah residents with ancestry from northern
and western Europe (CEU), 20 Han Chinese (CHB), 20 Tuscan
in Italy (TSI) and 40 Yoruba (YRI) were sequenced in five pools.
The samples were pooled by population with each pool consist-
ing of 20 individuals W RI were divided into two equal pools:
YRI_l and YRI_2). Approximately 600 kb of coding regions
were sequenced by Illumina GAIIx. The sequenced reads were

 

 

 

 

 

 

 

 

 

 

 

m _
q _
o _
I EB:e=0.01
g _ El Naive: e=0.01
0 El EB:e=0.05
El Naive: e=0.05
(0
q _
o
N
q _
O
,_
q _
o
o
q _ __ __
0

(10,10) (10,25) (10,50) (50,10) (50,25) (50,50)

Fig. 2. Comparisons of total SSE for EB estimator and naive estimator.
The y-axis is the SSE. The pairs of numbers on x-axis are read depth and
pool size. For example, (10, 25) represents read depth of 10 and pool size
of 25. €20.01 (or €20.05) represents the sequencing error generated
from uniform (0, 0.01) [or uniform (0, 0.05)]

0.025
|

Proportion of sites
0.015 0.020
I

0.010
|

0.005

 

 

 

 

0.000

 

 

I I I I I I I
10 20 30 40 50 60 70

Coverage per haplotype

c.

Fig. 3. Empirical distribution of sequence coverage per haplotype
(chromosome 16)

mapped to reference human genome (HG18) by Burrows-
Wheeler Alignment (BWA) (Li and Durbin, 2009), resulting in
averaged coverage of 34x per individuals. Figure 3 shows the
distribution of coverage per haplotype.

We use the EBM model to identify SNPs in the ~20kb
sequenced coding region on chromosome 16. Before applying
the EBM model, the data were preprocessed by ﬁltering out
reads with base calling quality score <10 and mapping quality
score <20. Positions with coverage <20 in one or more pools
were not included in the analysis. After applying the EBM
model, 93 SNPs were identiﬁed at the threshold of fdrf 0.001.
As a comparison, we applied CRISP with the default parameters
and identiﬁed 75 SNPs. Sixty SNPs were identiﬁed by both
methods. Fifteen SNPs were identiﬁed by CRISP alone, and
33 SNPs were identiﬁed by the EBM model alone (Fig. 4a).
Figure 4b plots the distribution of allele frequencies (averaged
over ﬁve pools) of the 60 SNPs identiﬁed by both methods.
Among these SNPs, 66.7% had MAF <0.05, 10% had MAF

 

2573

112 /310'S[BIIJHO[pJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} pQPBOIII/lAOG

9103 ‘Og isanV uo ::

B.Zhou

 

E
é

 

EB CRISP

Frequency
5 10 15 20 25

 

 

O
0

 

0.00 0.05 0.10 0.15 0.20 0.25

MAF

A
O
V
681
A
D.
V
6810

4

 

Frequency
Frequency

2

 

 

 

 

_|—i_l N
O O

 

0.0 01 0.2 03 0.4 0.00 0.02 0.04 0.06 0.08
MAF MAF

Fig. 4. (a) Venn diagram of the SNPs detected by the EBM model and
CRISP; (b) distribution of allele frequencies of the 60 SNPs detected by
both methods; (c) distribution of allele frequencies detected by the EBM
model alone and ((1) distribution of allele frequencies detected by CRISP
alone

between 0.05 and 0.1 and 23.3% had MAF>0.1. We compare
with a list of variants on the same set of 100 samples from the
HapMap and the 1000 Genomes Projects (HM + lKG dataset).
Due to the missing data in the 1000 genomes dataset for three of
the pools, the HM+1KG dataset is only a partial list of the
variants. Forty-four (73%) of the 60 SNPs are on the list of
HM + lKG dataset.

For the 16 SNPs identiﬁed by both the EBM model and
CRISP but not on the list of HM + lKG, we inspect the aligned
sequence reads from the pooled data and found that 10 of the 16
sites are strongly supported by the pooled sequence data as SNP
sites. Among the 33 SNPs identiﬁed by the EBM model but not
by CRISP, 97% (32 SNPs) have allele frequencies >0.05 (Fig.
4c). The excess variant allele reads strongly suggest these sites are
true SNPs. Of note, CRISP failed to detect these SNP sites,
which is consistent with the simulations results showing that
CRISP is not sufﬁciently sensitive for detection of less rare and
common SNPs. We further inspected the 15 SNPs identiﬁed by
CRISP but not the EBM model. Fourteen of the SNPs were rare
(MAF<0.05; Fig. 4d), and eight of them had the variant allele
present in only one pool. Three of the 15 sites are strongly sup-
ported by the alignment data to be true SNPs. The remaining
sites were inconclusive based on the alignment data.

We then compared the allele frequency estimated by the em-
pirical Bayes shrinkage estimator and the naive estimator. We
calculated the total SSE between the estimated allele frequencies
with those obtained from 1000 genome data for the overlapping
44 SNPs. The SSEs were 0.102 and 0.185 when using empirical
Bayes estimate and the naive estimate, respectively. Correlations
of the estimated allele frequencies and the 1000 genome allele
frequencies were 0.973 for the empirical Bayes estimate and
0.951 for the naive estimate. The empirical Bayes estimator per-
forms slightly better than the naive estimator.

4 DISCUSSIONS

We have developed an EBM model for SNP calling in the ana-
lysis of pooled sequencing data. The EBM model is able to learn
the error distribution reliably by borrowing information across
pools and positions. Because of the small number of pools, it is
necessary to borrow information across positions to infer the
error distribution in pooled sequencing. Muralidharan et a].
(2011) developed an empirical Bayes model to detect SNPs in
individual sequencing, but their model is not applicable to
pooled sequencing. The proposed EBM model effectively incorp-
orates characteristics of the pooled sequencing data to increase
the sensitivity of SNP detection. Simulation studies and real data
application have demonstrated the superior performance of the
EBM model over other methods.

In contrast to previously available methods, such as CRISP,
which use P—Value as threshold to call SNPs, the EBM model
uses fdr as the threshold for SNP calling thereby controlling the
false-positive rate. It has been established that the FDR and fdr
are more appropriate than P—Values for large-scale inference of
genomic data (Benjamini and Hochberg, 1995; Storey, 2002).
The concept of fdr was developed by Efron et a]. (2001) for
the analysis of microarray data. In the context of SNP calling,
fdr quantiﬁes the site-speciﬁc evidence indicating that each pos-
ition is a SNP site. The usual FDR, on the other hand, averages
over other sites with stronger evidence. Several authors have
argued that FDR may result in misleading inferences and advo-
cated the use of fdr in genomic studies (Finner and Roters, 2002;
Liao et al., 2004). However, fdr is often more difﬁcult to estimate
than FDR. The FDR can be formulated in terms of the cumu-
lative distribution functions, for which the empirical distribution
is a consistent and stable estimator. But to estimate fdr, it is
necessary to estimate the density of distributions, which requires
parametric models or non-parametric smoothing methods (Liao
et al., 2004). The EBM approach provides a simple and ﬂexible
way to estimate fdr (Liao et al., 2004; Muralidharan, 2010; Pan
et al., 2003) and effectively controls the false-positive rate. As a
comparison, the P—Value approach of CRISP has been shown to
result in inﬂated type I errors (Wei et al., 2011).

Another advantage of the EBM model is that it integrates the
allele frequency estimation in a single procedure with SNP de-
tection. The EBM model estimates allele frequency using an em-
pirical Bayes shrinkage estimator, which shrinks the SNP-speciﬁc
MAF toward a genome-wide consensus. Statistical properties of
the empirical Bayes estimator have been extensively discussed in
the literature (Brown, 2008; Efron and Morris, 1975; Robbins,
1954). We have shown here that it outperforms the naive esti-
mator for MAF estimation especially when the sample size is
small. In NGS, sampling bias is a non-trivial issue. Reads cover-
age is almost certainly non-uniform across positions. By con-
sidering one position at a time, previous methods completely
ignore the non-uniform distribution of reads coverage. The
EBM model is able to incorporate coverage information in the
covariance matrix of equation (2) to reﬂect the noise level of
different positions.

Before applying the EBM model, appropriate ﬁltering of se-
quence reads is necessary. The EBM model uses transformation
(1), which requires the coverage to be at least 12 or so (Brown,
2008). Positions with read coverage <12 are not suitable for

 

2574

112 /310'S[BIIJHO[pJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} pQPBOIII/IAOG

9103 ‘Og isnﬁnv uo ::

An EBM model for SNP detection

 

transformation as the mean and variance formula no longer hold
well. It is recommended to discard or manually inspect these
poorly covered positions. Reads with low base calling or map-
ping qualities should also be excluded. It is possible to apply
more sophisticated filtering strategies to eliminating systematic
error or strand bias, see Rivas et a]. (2011) for detailed
discussions.

The EBM model can be extended in several ways for future
work. First, detection of small indels is not supported by our
current model. The indels impose a great challenge for NGS.
DNA ampliﬁcation and reads mapping techniques to handle
indels are under development. In future work, we may incorpor-
ate indels calling in the EBM model. Second, we may extend the
EBM framework to include downstream analysis, such as asso-
ciation analysis of caseicontrol data. Currently, there is a lack of
methods for association analysis for pooled sequencing data. In
summary, we have developed an efficient EBM model for SNP
calling in pooled sequencing data that is applicable to NGS data
generated by various sequencing platforms.

ACKNOWLEDGEMENTS

I would like to thank Dr Mimi Kim, Dr Kenny Ye, Dr Harry
Ostrer and members of Ostrer group for their constructive
comments.

Funding: This work was supported by Einstein initiative grant.

Conﬂict of Interest: none declared.

REFERENCES

Bansal,V. (2010) A statistical method for the detection of variants from
next—generation resequencing of DNA pools. Bioinformatics, 26, i318ri324.
Bansal,V. et a]. (2010) Accurate detection and genotyping of SNPs utilizing popu—
lation sequencing data. Genome Res., 20, 5377545.

Bansal,V. et a]. (2011) Efﬁcient and cost effective population resequencing by pool—
ing and in—solution hybridization. PLoS One, 6, e18353.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac—
tical and powerful approach to multiple testing. J. R. Stat. Soc. B., 57, 2897300.

Bodmer,W. and Bonilla,C. (2008) Common and rare variants in multifactorial sus—
ceptibility to common diseases. Nat Genet., 40, 6957701.

Brown,L.D. (2008) In—season prediction of batting averages: a ﬁeld test of empirical
Bayes and Bayes methodologies. Ann. Appl. Statist., 2, 1137152.

Cohen,J.C. et a]. (2006) Multiple rare variants in NPClLl associated with reduced
sterol absorption and plasma low—density lipoprotein levels. Proc. Natl. Acad.
Sci. USA., 103, 181G1815.

Druley,T.E. et a]. (2009) Quantiﬁcation of rare allelic variants from pooled genomic
DNA. Nat. Methods, 6, 2637265.

Efron,B. (2007) Size, power and false discovery rates. Ann. Statist., 35, 135171377.

Efron,B. et a]. (2001) Empirical bayes analysis of a microarray experiment. J. Am.
Stat. Assoc., 96, 115171160.

Efron,B. and Morris,C. (1975) Data analysis using Stein’s estimator and its gener—
alizations. J. Amer. Stat. Assoc., 70, 3117319.

Finner,H. and Roters,M. (2002) Multiple hypotheses testing and expected number
of type I errors. Ann. Stat., 30, 22W238.

Ji,W. et a]. (2008) Rare independent mutations in renal salt handling genes contrib—
ute to blood pressure variation. Nat. Genet., 40, 5927599.

Kim,S.Y. et a]. (2010) Design of association studies with pooled or un—pooled
next—generation sequencing data. Genet. Epidemiol, 34, 47%491.

Koboldt,D.C. et a]. (2009) VarScan: variant detection in massively parallel sequen—
cing of individual and pooled samples. Bioinformatics, 25, 228372285.

Li,H. et a]. (2008) Mapping short DNA sequencing reads and calling variants using
mapping quality scores. Genome Res., 18, 185171858.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with
Burrows—Wheeler transform. Bioinformatics, 25, 17544760.

Liao,J.G. et a]. (2004) A mixture model for estimating the local false discovery rate
in DNA microarray analysis. Bioinformatics, 20, 2694e2701.

Manolio,T.A. et a]. (2009) Finding the missing heritability of complex diseases.
Nature, 461, 7477753.

Martin,E.R. et a]. (2010) SquM: an adaptive genotype—calling approach for
next—generation sequencing studies. Bioinformatics, 26, 280372810.

Meng,X. and Rubin,D.B. (1993) Maximum likelihood estimation via the ECM
algorithm: a general framework. Biometrika, 80, 2677278.

Muralidharan,O. (2010) An empirical Bayes mixture method for effect size and false
discovery rate estimation. Ann. Appl. Stat., 4, 4224138.

Muralidharan,O. et a]. (2011) A cross—sample statistical model for SNP detection in
short—read sequencing data. Nucleic Acids Res., doi: 10.1093/nar/gkr851.

Nejentsev,S. et a]. (2009) Rare variants of IFIHl, a gene implicated in antiviral
responses, protect against type 1 diabetes. Science, 324, 3877389.

Pan,W. et a]. (2003) A mixture model approach to detecting differentially expressed
genes with microarray data. Funct. Integr. Genomics, 3, 1177124.

Rivas et a]. (2011) Deep resequencing of GWAS loci identiﬁes independent rare
variants associated with inﬂammatory bowel disease. Nat. Genet., 43, 106G1073.

Robbins,H. (1954) An empirical Bayes approach to statistics. In Neyman,J. (ed.)
Proc. T hrid Berkeley Sympos. Math. Statist. Probab. 1. Univ. California Press,
Berkeley, CA, pp. 1577163.

Storey,J.D. (2002) A direct approach to false discovery rates. J. R. Stat. Soc. B, 64,
4794198.

Wang,T et a]. (2010) Resequencing of pooled DNA for detecting disease associ—
ations with rare variants. Genet. Epidemiol, 34, 4927501.

Wei,Z et a]. (2011) SNVer: a statistical tool for variant calling in analysis of pooled
or individual next—generation sequencing data. Nucleic Acids Res., 39, e132, doi:
10.1093/nar/gkr599.

Zhou,B. and Whittemorc,A.S. (2012) Improving sequence—based genotype calls with
linkage disequilibrium and pedigree information. Ann. Appl. Stat., 6, 4574175.

 

2575

112 /310's1eu1n0[p101x0'soIJBuIJOJHIoIq/ﬁduq 01011 papeo1umoq

9103 ‘0g1sn8nv uo ::

