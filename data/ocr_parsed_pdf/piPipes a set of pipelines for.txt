BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

  

NM
N R
Transposon

 

of

    

Fold-enrichment
IogLR
Poisson p-value

 

  

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

piPipes

 

detects novel transposition events as well as structural variation.
Supplementary Figure S1 illustrates the general piPipes workﬂow, using
the small RNA-seq pipeline as an example. First, all reads aligned to
ribosomal RNA (rRNA) sequences are removed. The remaining reads
are then mapped to microRNA (miRNA) hairpin sequences to quantify
the abundance and 5’- and 3’-end heterogeneity of mature miRNAs.
Reads that do not match rRNAs or miRNAs are then mapped to the
reference genome. piPipes next assigns reads to different genomic features
(e.g., transposons, piRNA clusters and genes) by their coordinates. To
achieve maximal speed, piPipes parallelizes this step on multiple threads
using ParaFly software from the Trinity package (Grabherr et al., 2011).
For the reads assigned to each genomic feature, piPipes draws publica-
tion-quality graphs of length distribution and nucleotide composition, as
well as the distance between the 5’ ends of two small RNAs from opposite
strands of the same locus, a standard method for detecting piRNA ‘Ping-
Pong’ ampliﬁcation or siRNA phasing (Fig. 1A and Supplementary Fig.
SlB). Furthermore, piPipes generates a table that summarizes the number
of unique and multiple mappers counted as species (distinct sequences) or
reads. The RNA-seq pipeline also starts with rRNA removal. The re-
maining reads are then mapped to the genome using STAR (Dobin et al.,
2013). piPipes quantiﬁes transcript abundance from genomic alignment
by both Cufﬂinks (Trapnell et al., 2010) and HTSeq-count (Anders et al.,
2014). In addition, direct mapping of the reads to the transcriptome is
performed using Bowtie2 followed by eXpress quantiﬁcation (Roberts
and Pachter, 2013). Degradome-seq and CAGE-seq share the same pipe-
line because both methods aim to characterize the 5’ ends of RNAs. This
pipeline discards reads that can only be mapped to the genome via soft
clipping of their 5’ ends (i.e. the preﬁxes of these reads do not map to the
genome). The alignment procedure is otherwise similar to that used for
RNA-seq data. The nucleotide composition for each genomic feature is
calculated as in the small RNA pipeline (Supplementary Fig. S3B). The
ChIP-seq pipeline aligns the ChIP and input libraries to the genome using
Bowtie2. piPipes calls peaks using MACS2 (Zhang et al., 2008), which
supports both narrow (such as transcription factors) and broad (such as
histone 3 trimethyl lysine 9, H3K9me3) peaks. Transcription start site,
transcription end site and metagene analyses of different genomic features
are implemented by bwtool (Pohl and Beato, 2014). The genome-seq
pipeline applies different algorithms, including BreakDancer (Chen
et al., 2009), RetroSeq (Hormozdiari et al., 2010; Keane et al., 2013)
and TEMP (Zhuang et al., 2014), to discover transposon insertion,
deletion and other structural variation events (Supplementary Fig. S5).
piPipes uses a Circos plot (Zhang et al., 2013) to represent the variant
loci discovered by each algorithm across different chromosomes
(Fig. 1D).

The small RNA-seq, RNA-seq and ChIP-seq pipelines can each be run
in two modes, allowing analysis of a single sample or a pair of samples.
The dual-sample mode uses the output from the single-sample mode and
performs pair-wise comparison as illustrated by balloonplots and
scatterplots (Supplementary Fig. SlC and D). The comparison can be
performed on miRNA, piRNA or mRNA. Figure 1B illustrates a
scatterplot showing the mRNA abundance in an RNA-seq dataset ana-
lyzed by the RNA-seq pipeline in the dual-sample mode. The dual-sample
mode of the RNA-seq pipeline also uses Cuffdiff (Trapnell et al., 2013) to

perform differential analysis on genic transcripts. In the dual-sample
mode, the ChIP-seq pipeline uses MACS2 to identify differentially
enriched loci (Supplementary Fig. S4).

ACKNOWLEDGEMENTS

The authors thank the members of the Zamore and Weng
laboratories for helpful discussions, and Jia Xu, Jui—Hung
Hung and S00 Lee for their initial work.

Funding: This work was funded by National Institutes of Health
grants [GM62862 and GM65236] to P.D.Z. and [U41HG007000]
to Z.W.

Conﬂicts of interest: none declared.

REFERENCES

Anders,S. et ul. (2014) HTSeq — A Python framework to work with high—
throughput sequencing data. Bioinformutim‘, 31, 1667169.

Brennecke,J. et ul. (2007) Discrete small RNA—generating loci as master regulators
of transposon activity in Drosophilu. Cell, 6, 108971103.

Chen,K. et ul. (2009) BreakDancer: an algorithm for high—resolution mapping of
genomic structural variation. Nut. Met/wily, 9, 677%81.

D0bin,A. et ul. (2013) STAR: ultrafast universal RNA—seq aligner. Bioinformutim‘,
1, 15721.

Grabherr,M.G. et ul. (2011) Full—length transcriptome assembly from RNA—Seq
data without a reference genome. Nut. Biotechnol, 7, 644%52.

Hormozdiari,F. et ul. (2010) Next—generation VariationHunter: combinatorial algo—
rithms for transposon insertion discovery. Bioinformutim‘, 12, i35(%i357.

Keane,T.M. et ul. (2013) RetroSeq: transposable element discovery from next—gen—
eration sequencing data. Bioiiy’ormuticx, 3, 3897390.

Khurana,J.S. et ul. (2011) Adaptation to P element transposon invasion in
Drosopltilu melunoguxter. Cell, 7, 155171563.

Luteijn,M.J. and Ketting,R.F. (2013) PIWI—interacting RNAs: from generation to
transgenerational epigenetics. Nut. Rev. Genet, 8, 5237534.

P0hl,A. and Beat0,M. (2014) bwtool: a tool for bigWig ﬁles. Bioiiy’ormuticx, 11,
161871619.

Reuter,M. et ul. (2011) Miwi catalysis is required for piRNA ampliﬁcation—inde—
pendent LINEl transposon silencing. Nature, 7376, 26¢267.

R0berts,A. and Pachter,L. (2013) Streaming fragment assignment for real—time ana—
lysis of sequencing experiments. Nut. Met/wilt, 1, 71773.

Sienski,G. et ul. (2012) Transcriptional silencing of transposons by Piwi and
maelstrom and its impact on chromatin smte and gene expression. Cell, 5,
96¢980.

Trapnell,C. et ul. (2010) Transcript assembly and quantiﬁcation by RNA—Seq re—
veals unannotated transcripts and isoform switching during cell differentiation.
Nut. Biotechnol, 5, 5117515.

Trapnell,C. et ul. (2013) Differential analysis of gene regulation at transcript reso—
lution with RNA—seq. Nut. Biotechnol, l, 4&53.

Zhang,H. et ul. (2013) RCircos: an R package for Circos 2D track plots. BMC
Bioinformuticx, 14, 244.

Zhang,Y. et ul. (2008) Model—based analysis of ChIP—Seq (MACS). Genome Biol, 9,
R137.

Zhuang,J. et ul. (2014) TEMP: a computational method for analyzing transposable
element polymorphism in populations. Nucleic Aeiilx Re.\'., 11, 6826$838.

 

595

ﬁm'spzumol‘pmﬂo'sopeuuopuotq/ﬁdnq

