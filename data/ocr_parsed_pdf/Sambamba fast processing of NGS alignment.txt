Bioinformatics, 31(12), 2015, 2032—2034

doi: 10.1093/bioinformatics/btv098

Advance Access Publication Date: 19 February 2015
Applications Note

 

Genome analysis

Sambamba: fast processing of NGS alignment
formats

Artem Tarasov1, Albert J. Vilellaz, Edwin Cuppen3'4, Isaac J. Nijman4
and Piotr Prins4'5'*

1Department of Statistical Simulation, St. Petersburg State University, St. Petersburg, Russia, lelumina Cambridge,
Cambridge, UK, 3Hubrecht Institute, Royal Netherlands Academy of Arts and Sciences, Utrecht, The Netherlands,
4Department of Medical Genetics, Institute for Molecular Medicine, University Medical Centre Utrecht, Utrecht,
The Netherlands and 5Department of Nematology, Wageningen University, Wageningen, The Netherlands

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on December 13, 2014; revised on February 2,2015; accepted on February 10, 2015

Abstract

Summary: Sambamba is a high—performance robust tool and library for working with SAM, BAM
and CRAM sequence alignment files; the most common file formats for aligned next generation
sequencing data. Sambamba is a faster alternative to samtools that exploits multi—core processing
and dramatically reduces processing time. Sambamba is being adopted at sequencing centers, not
only because of its speed, but also because of additional functionality, including coverage analysis
and powerful filtering capability.

Availability and implementation: Sambamba is free and open source software, available under a
GPLv2 license. Sambamba can be downloaded and installed from http://www.open—bio.org/wiki/

 

Sambamba.

Sambamba v0.5.0 was released with doi:10.5281/zenodo.13200.

Contact: j.c.p.prins@umcutrecht.nl

 

1. Introduction

Processing speed matters, not only for diagnostics, but also for ana-
lysis and sharing of computational resources. Next-generation
sequencing (NGS) is increasingly used as a genetic screening tool in
diagnostics (Gullapalli et (11., 2012) and reducing time from sample
intake to test result/diagnosis potentially saves lives. Introducing
multi-core processing can accelerate steps in a pipeline when the
CPU is the bottleneck (Trelles et (11., 2011).

Since its introduction by the 1000 Genomes Project (Siva, 2008),
the sequence alignment/map format (SAM) and its compressed bin-
ary counterpart (BAM) have become the de facto file formats used
for storing and distributing NGS data. Samtools is the original tool
for SAM/BAM files processing, including data extraction and filter-
ing (Li et (11., 2009). Recently, samtools added the CRAM format as
a compressed alternative to SAM/BAM (Cochrane et (11., 2013).
While samtools exploits the speed of the low-level C programming

(63 The Author 2015. Published by Oxford University Press.

language and uses streamed data for efficiency, it has limited sup-
port for parallel processing (Fig. 1). Samtools has inspired a number
of other BAM processors, notably Picard (Picard, 2009), samblaster
(Faust and Hall, 2014), biobambam (Tischler and Leonard, 2014)
and Scramble (Bonfield, 2014), each of which is either slower than
samtools, or offers a subset of its functionality.

To accelerate analysis pipelines we created Sambamba, a new in-
carnation of samtools that fully utilizes parallel processing.
Sambamba (which means ‘parallel’ in Swahili) is written in the D
programming language, a modern programming language with run-
time performance similar to that of C (Alexandrescu, 2010). D has
powerful abstractions for parallel computing which make it possible
to scale computations with the number of cores (Fig. 1). When run-
ning a Human cancer exome SNV calling pipeline on the results of a
single Illumina HiSeq 2500 flowcell in fast mode (2000 genes, 300

2032

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘srcumo[p10}xo‘soucuHOJIItotq/ﬁdnq

 

.21., 2011

Bonficld, 2014

Fig. 1

Table 1

Trellcs cl

Thurston, 2006

Figure 1

Prins cl (1]., 2014

/310'S[BHmOprOJXO'SOﬂBLUJOJIIlOlq/ﬂduq

2034

A. Tarasov et al.

 

Gullapalli,R.R. et al. (2012) Next generation sequencing in clinical medicine:
challenges and lessons for pathology and biomedical informatics. Pathol.
Inﬁ, 3, 40.

Li,H. et al. (2009) The sequence alignment/Map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Picard (2009) Picard. http://picard.sourceforge.net/.

Prins,P. et al. (2014) Small tools MANIFESTO for bioinformatics. 10.5281/
zenodo.11321.

Siva,N. (2008) 1000 Genomes project. Nat. Biotechnol., 26, 256.

Thurston,A.D. (2006) Parsing computer languages with an automaton com-
piled from a single regular expression. In: Ibarra,O.H. and Yen,H.-C. (eds.),
CIAA. Lecture Notes in Computer Science, vol. 4094, Springer, New York,
pp. 285—286.

Tischler,G. and Leonard,S. (2014) biobambam: tools for read pair collation
based algorithms on BAM ﬁles. Source Code Biol. Med., 9, 13.

Trelles,O. et al. (2011) Big data, but are we ready? Nat. Rev. Genet, 12, 224.

/310'S[BHmOprOJXO'SOTJBLUJOJIITOlq/ﬂduq

