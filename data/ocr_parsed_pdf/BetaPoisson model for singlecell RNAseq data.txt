Bioinformatics, 32(14), 2016, 2128—2135

doi: 10.1093/bioinformatics/btw202

Advance Access Publication Date: 19 April 2016
Original Paper

 

Gene expression

Beta-Poisson model for single-cell RNA-seq data
analyses

Trung Nghia Vu1, Quin F. Willsz'3, Krishna R. Kalari4, Nifang Niu5,
Liewei Wang5, Mattias Rantalainen”'* and Yudi Pawitan1'1'*

1Department of Medical Epidemiology and Biostatistics, Karolinska lnstitutet, 17177 Stockholm, Sweden,
2Wellcome Trust Centre for Human Genetics, University of Oxford, Oxford OX3 7BN, UK, 3Weatherall Institute of
Molecular Medicine, University of Oxford, Oxford OX3 9DS, UK, 4Department of Health Sciences Research, Mayo
Clinic, Rochester, MN 55905, USA and 5Department of Molecular Pharmacology and Experimental Therapeutics,
Mayo Clinic, Rochester, MN 55905, USA

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Last Authors.
Associate Editor: Ziv Bar-Joseph

Received on December 1, 2015; revised on March 2,2016; accepted on April 9, 2016

Abstract

Motivation: Single—cell RNA—sequencing technology allows detection of gene expression at the sin—
gle—cell level. One typical feature of the data is a bimodality in the cellular distribution even for
highly expressed genes, primarily caused by a proportion of non—expressing cells. The standard
and the over—dispersed gamma—Poisson models that are commonly used in bulk—cell RNA—sequenc—
ing are not able to capture this property.

Results: We introduce a beta—Poisson mixture model that can capture the bimodality of the single—
cell gene expression distribution. We further integrate the model into the generalized linear model
framework in order to perform differential expression analyses. The whole analytical procedure is
called BPSC. The results from several real single—cell RNA—seq datasets indicate that ~90% of the
transcripts are well characterized by the beta—Poisson model; the model—fit from BPSC is better
than the fit of the standard gamma—Poisson model in > 80% of the transcripts. Moreover, in differ—
ential expression analyses of simulated and real datasets, BPSC performs well against edgeR, a
conventional method widely used in bulk—cell RNA—sequencing data, and against scde and MAST,
two recent methods specifically designed for single—cell RNA—seq data.

Availability and Implementation: An R package BPSC for model fitting and differential expression
analyses of single—cell RNA—seq data is available under GPL—3 license at https://github.com/
nghiavtr/BPSC.

Contact: yudi.pawitan@ki.se or mattias.rantalainen@ki.se

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 IntrOducuon (Wills et (11., 2013). Previous studies (Daigle et (11., 2015; Sanchez

Gene expression at single-cell level is a stochastic process affected by
extrinsic and intrinsic noise. The extrinsic noise comes from the en-
vironment outside the cell such as hormones or drugs. The intrinsic
noise involves intra-cellular factors such as transcription rate (burst
frequency), the number of mRNAs (burst size) and degradation rate

et (11., 2013; Shahrezaei and Swain, 2008) have introduced different
models to capture the stochastic process due to the intrinsic noise. In
general there are two main approaches to measure expression of
genes in a single cell (i) targeted and (ii) whole transcriptome-based.
The former—e.g. using qPCR or immunohistochemistry—is used to

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2128

/310‘sreumo[p10}xo‘soutzuHOJIItotq/ﬁdnq

Beta—Poisson model for scRNA—seq

2129

 

investigate a limited number of genes, while the latter exploits the
single—cell RNA sequencing (scRNA—seq) technology to estimate
abundances of genes/transcripts of the whole transcriptome. In this
study, we focus on modeling gene expression from scRNA—seq
studies.

Gene expression of traditional bulk—cell RNA sequencing is the
integration of gene expression from multiple single cells; the distri—
bution is commonly modelled by the gamma—Poisson mixture
model, or equivalently, the negative—binomial distribution. This
model cannot capture the bimodality of gene expression in single—
cell data (Shalek et al., 2013). Recently Wills et al. (2013) briefly
introduced the beta—Poisson model to capture the bimodality as well
as the long—tailed behavior in the distribution. As an attractive fea—
ture, unlike the purely empirical gamma—Poisson model for bulk—
RNA, the beta—Poisson model parameters introduce one biological
interpretation in terms of burst size and burst frequency of the cell—
level expression. However, due to computational problems with the
beta—Poisson model, Wills et al. used an alternative discrete Poisson
mixture, a less—parameterized version of the beta—Poisson model, to
extract the information of the burst size and frequency. The model
was applied for modelling of gene—level expression in qPCR—based
datasets. Furthermore, no details of evaluation of modeling perform—
ance were reported. Another attempt of using the beta distribution
to capture bimodality property of single—cell gene expression was
introduced in the BATBayes model (Velten et al., 2015). However,
in this approach, instead of integrating it with the Poisson distribu—
tion, the beta distribution was combined with binomial distribution
to mimic the partitioning process of RNA molecules into transcripts.

Here we develop BPSC, an analysis tool based on the beta—
Poisson model for the single—cell gene expression data, and imple—
ment and apply it to several scRNA—seq datasets. BPSC addresses
practical and realistic issues such as non—integer expression values or
low expression values. Theoretically it is suitable for both tran—
script—level and gene—level expression, which is usually higher than
the transcript—level expression. It is worth noting that the term ‘tran—
script’ herein includes both isoform and other types of splicing vari—
ants. The beta—Poisson model allows for control of the expression
drop—off caused by technical noises or sequencing sensitivity. BPSC
includes a generalized linear model (GLM) based on the beta—
Poisson model to perform differential expression analyses of single—
cell RNA—seq data. Experiments using simulated and real datasets
show that BPSC performs well against edgeR, an established method
for bulk—cell RNA—seq, and against MAST and scde, two recent dif—
ferential—expression analysis methods designed for single—cell RNA—
seq.

2 Beta-Poisson model

The beta—Poisson model captures the burst frequency and burst size
through the shape and scale parameters or and [3, respectively. Large
or indicates high burst frequency; large [3 means large burst size
(Wills et al., 2013). Instead of using a range [11, b], we consider the
beta distribution in [0, 1] and scale it by /l in order to avoid optimiz—
ing two boundary parameters a and b. We then extend the model
with more parameters to increase its flexibility. We start with the
simplest model with three parameters, then describe its extensions
with four and five parameters.

2.1 Three—parameter beta—Poisson model
The simplest beta—Poisson model is a mixture of Poisson distribu—
tions with mean Liz/Tu, where /l is a scale parameter, and 14 has a

beta distribution with parameters (01,13). Thus, the probability distri—
bution function (pdf) can be computed as follows:

P(X S x) ZJZHX S xll’)f(l’)dv- (1)
0

Using ﬂv)dv :f(u)du, we first replace U by u to get
1

P(X g x) :J P(X g x)1u)f(u)du
0

 

1 1
: PX<x2uuaT11—uﬁ_1du (2)
Changing the variable t E 214 — 1, so that u : (t+ 1)/2 and
dt : 2du, with some algebra we have:

1 1 1

2t+1
_x‘ (2)

 

)(1 + t)“‘1(1 — t)”‘1dt (3)

The integral (3) can be easily and rapidly computed by using the
Gauss—Jacobi quadrature method (Hildebrand, 2013). Thus, similar
to the discrete Poisson mixture model (Wills et al., 2013), our first
model requires only three parameters. However, in practice, this
model proves inadequate for modeling single—cell transcript expres—
sion data. Therefore, we extended the model in the following
sections.

2.2 Four—parameter beta—Poisson model

The simple beta—Poisson model has a serious weakness in that
its sample space contains non—negative integers only. Because of
various preprocessing steps of the sequence data, expression values
are generally not discrete counts. Transcript expression is typically
estimated in the form of normalized indices such as fragments
per kilo—base per million reads (FPKM) or counts—per—million
reads (cpm). Figure 1a shows an example that the expression values
(in FPKM) of a transcript are not discrete and small (mostly < 2.0).
As displayed in the middle plot, this makes the three—parameter
beta—Poisson model fail to capture the distribution. To address
this problem, we introduce an extra parameter as follows. First
we denote the three—parameter beta—Poisson model in a simpler
form as

BP3 (x151, [3,21) : Poisson(x)21Beta(oc.  (4)

In this formula, we use 21 in place of 2 in formula (1). Then, de—
fine the four—parameter beta—Poisson model with the extra param—
eter 22 as

BP4(xl“7l37/l17/lz) EAZBPSOlexvﬁJ-ll (5)

In practice we expect the parameter 22 to be a small positive
value less than one, so that the BP4 model allows fractional values in
its sample space. The pdf of the four—parameter beta—Poisson model
can be computed using the following connection:

x
BMW“) [3711712) : BPsQElW/Ir/h) (6)

The transcript expression in Figure 1a is now successfully mod—
elled by BP4 as presented in top—right plot of the panel. In this BP4
model, the goodness—of—fit x2 is 5.79 with 4 degrees of freedom
(P—value: 0.21), indicating the BP4 model fits well and better than
the BP3 model.

ﬁm'spzumol‘pmyo'sopcuuowtotq/ﬁdnq

2013

Figure lb

\Xfills at (11.,

/310'S[BHm0[pJOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

Beta—Poisson model for scRNA—seq

2131

 

beta—Poisson model is set to zero. Alternatively, we could fit a model
to non—zero expressed values only; this approach leads to longer
overall time and generally produces similar final estimates.

3.2 Model evaluation

In order to evaluate how well the model fits the data, the observed
and the expected frequencies from the model are compared using
the goodness—of—fit statistic

K
T : Z nklogn—k.
12:1 ek

where nk is the observed frequency of the kth bin and eh is the ex—
pected frequency. Asymptotically, under the null hypothesis that the
model fits the data, T has a x2 distribution with (K — p — 1) degrees
of freedom, where p is the number of parameters. However, because
of small samples, many bins at the tail of the distribution always
have low expected frequencies, so the asymptotic distribution is not
appropriate.

We use a Monte—Carlo method to generate a more appropriate
null distribution as follows: first 1000 random datasets are created,
each containing 11 values from the estimated beta—Poisson model.
Then we apply the estimation procedure to each random dataset
and compute T”r as the goodness—of—fit statistic above. The collection
of 1000 T’is represents the Monte—Carlo null distribution, and the
P—value is computed as the proportion of T’is greater than the
observed T. We declare a transcript is well—fitted by the beta—Poisson
model if its P—value 20.05. An example of the Monte—Carlo null dis—
tribution is shown in Figure S2 in Supplementary report.

4 Differential expression analysis

In this section we integrate the beta—Poisson model into the general—
ized linear model (GLM) framework, so we can easily perform dif—
ferential expression analyses. In general, given response variable
Y :yi,i : 1, ..,n and explanatory variable X : x,./' : 1. ...k, a
GLM consists of a linear predictor

"i:ﬁ0+ﬁ1x1i+"'+ﬁkxki (10)

where the dependence of the expectation of the response variable
u,:E(y,) on the linear predictor is set by a link function gm) : 11,. In
this study, the distribution of the response variables is a beta—
Poisson model and we use the log—link function. In order to estimate
the model parameters we use the iterative weighted least—squares
(IWLS) algorithm (Pawitan, 2013), which only requires a variance
function that specifies the relationship between the mean and

variance.
For the BP3 model, using (1)1 : ﬂ and (1)2 : W, from for—
mula (8) and (9), with some algebra we have:
M 5 E(X) : A1‘1’1
Var(X) : Mn + Afﬁrm (11)

2 14+ 142%-

Similarly, we extend the variance function for BP4 with the add—
itional parameter 22 as follows:

)4 E E(X) : 1112(1),
Var(X) 2 Main + mm. (12)
2 W12 + (42(22-

In group comparisons, we assume the mean u varies across
groups, but the shape parameters 22 and (1)2 are fixed and estimated
from control group. In our implementation we utilize the glm(.)
function in R software for fitting the GLM based on the BP4 model
with variance function defined by (12). The whole analytic proced—
ure including the differential—expression analysis will be called the
BPSC, which is also the name of the resulting R package made avail—
able at https://github.com/nghiavtr/BPSC.

5 Datasets

5.1 Real datasets

The first dataset in this study including 384 cells from a triple—nega—
tive breast cancer cell line (MDA—MB—231), half of which were
treated with metformin. The cells were captured using the Fluidigm
C1 system on a 96—well format. Two independent cell culture
batches were used from which 2 X 96 untreated cells were captured,
and similarly 2 X 96 treated cells. Sequencing libraries were pre—
pared using the standard Fluidigm protocol based on SMARTer
chemistry and Illumina Nextera XT kit. Library sizes of samples are
in a range of 1—10 million.

The second dataset consists of 96 cells from HTC116 cell—line
extracted from a public dataset (Wu et al., 2014). These single—cell
RNA—seq libraries were also prepared with SMARTer cDNA synthe—
sis using the C1 microfluidic system (Fluidigm), based on Nextera li—
brary construction (Illumina). The 96 libraries, divided into two
pooled samples of 48 libraries, were put in two lanes for a Illumina
HiSeq sequencing. More details about this dataset are given in the
original paper (Wu et al., 2014). Library sizes in this dataset vary
from 0.1 to 4 million.

There are various available transcript expression estimation
methods that can be used for RNA—seq datasets. In this study, we se—
lected a widely—used method Cufflinks (Trapnell et al., 2010) to esti—
mate transcript expression in the MDA—MB—231 dataset, and
Sailfish (Patro et al., 2014) to quickly extract transcript expression
in the HTC116 dataset. The reference annotation was obtained
from the most recent hg19 Homo sapiens reference built from
UCSC data sources and extracted from igenomes website http://sup
p0rt.illumina.com/sequencing/sequencing_software/igenome.html
(in folder archive—2014—06—02—13—47—56).

For the distribution analysis, the MDA—MB—231 dataset contains
21 728 transcripts from 165 cells from the control group and the
HTC116 dataset consists of 23 889 transcripts from 96 cells. The
cells from treated group were excluded in order to avoid the con—
founding effects of the metformin treatment.

For differential expression analysis, the MDA—MB—231 dataset
includes also transcript—level expression of 162 cells from the treated
group. Moreover, we use Htseq software (Anders et al., 2015) to
generate gene—level expression of the MDA—MB—231 dataset. This
dataset consists of 12 079 genes in total.

5.2 Simulated datasets
We use two simulation settings to evaluate and compare the per—
formance of BPSC in differential expression analyses. In each set—
ting, the data consist of two equal—sized groups with 100 samples in
each group and a total of 10 000 genes measured per sample. Five
percent of the genes are set to be differentially expressed (DE) with
fold—change 4.0, half of which are upregulated and the rest
downregulated.

The first setup chim simulates bulk—cell RNA—seq data. We use
the simulation design of a recent study (Law et al., 2014) to create a

ﬁm'spzumol‘pmyo'sopcuuowtotq/ﬁdnq

2132

T.N. Vu et al.

 

bulk—cell RNA—seq dataset. In brief, a baseline distribution from the
real dataset is used to generate relative proportion of expected
counts of genes. To create biological variation of DE genes, we
multiply their proportions by the fold—change. Then the proportion
multiplies by library size to obtain expected count of gene. In this
simulation, the library sizes of the samples are randomly selected in
a range from 2 to 20 million. An inverse—chi—squared distribution is
used to create dispersions in the simulation (Law et al., 2014). After
that, the counts of genes are generated from the gamma—Poisson
model with the specified mean and dispersion.

The second simulation setup scSim is designed to mimic a single—
cell RNA—seq dataset. We use the well fitted four—parameter
beta—Poisson models from HTC116 (Monte—Carlo P—value 25%) as
baseline distributions for the gene expression of the dataset. For
each gene, the expression across samples in the control group and
the treated group is generated from the same beta—Poisson model.
To create biological effects for the DE genes, we multiply the param—
eter 21 of one group by the fold—change, while the other parameters
are kept fixed. We also scale the gene expression to the predefined li—
brary sizes of the cells, which are randomly sampled from a range of
1—3 million. This range is taken from the HTC116 dataset.

In the analyses, we filter out genes whose total reads across all
samples <10. We generate 100 replications for each setting, and the
final results are based on these replications.

6 Results and discussion
6.1 Model fitting

The analysis results for the two real datasets are summarized in
Table 1. In general, these two datasets have similar performances,
where ~90% of transcripts are successfully modeled (Monte—Carlo
P—value 25%) by the BP4 and BP5 models. This proportion increases
to 94% if we set the P—value threshold to 1% (data not shown). It is
worth noting that the BP4 model is only slightly worse than the BP5
model. As illustrated in Figure 1b, the BP4 model is already able to
capture the proportion of unexpressed cells, so it appears sufficient
for practical applications. The BP5 model may need to be utilized
only for the failed BP4 models to improve overall performances. The
poor performances of the BP3 model in both datasets demonstrate
the important effect of the 22 fractional—scaling parameter in the BP4
model.

To demonstrate the value of the beta—Poisson model, we also
compare its performance to the traditional gamma—Poisson (GP)
model through their Akaike information criterion (AIC) scores. As
shown in Figure 1b the beta—Poisson model performs much better
than the gamma—Poisson model for transcripts with many unex—
pressed cells. To have a more even comparison, hence harder for the
beta—Poisson model, we compare the simplest model BP3 and GP on
a subset of high—abundance transcripts which are defined by the
transcripts that have top 10% sums of expression across cells. From
Table 2, for more than 80% of the transcripts in both datasets, the
AIC of the BP model (AICBp) is less than the AIC of the GP model
(AICGP), indicating the BP model has better performance than the
GP model. Figure 2 shows the scatterplot of the AIC scores from the

Table 1. Proportion of transcripts that fits the beta-Poisson model
(P-value 2 0.05)

 

 

BP3 BP4 BP5
MDA-MB—231 0.31 0.87 0.90
HTC116 0.37 0.88 0.91

 

two models applied to the MDA—MB—231 dataset. A great majority
of the points falls below the line of identity, indicating that the BP
model has lower AIC than the GP model.

To capture the improvement, we also compare the AIC of the
BP3 model with the AIC of the GP model up to a constant difference,
i.e. we count the transcripts satisfying the condition
AICBp + c < AICGP, where c : 0, 2, 5 in Table 2. The proportion is
~60% when we allow an AIC difference of 5.

To investigate why the BP model still sometimes fails to fit the
data, we bin the expression values of the MDA—MB—231 data into a
high resolution histogram with 100 equal—size breaks. Then a hier—
archical clustering is applied to investigate transcript similarities,
and we identify 4 groups categorizing the failed models. These
groups are shown in Figure S3 in Supplementary report. Most of the
failed models are in groups 1 and 3, where the right tail of the distri—
bution is marked by several extreme values. These values will be
investigated further in our future study.

To assess the sensitivity of the beta—Poisson model (BP4 model)
to sample size, we simulate datasets from scSim setup with different
numbers of cells 100, 50, 25 and 20. The results (Fig. S4 in
Supplementary report) show that the proportion of genes that fits
the beta—Poisson model (P—value 20.05) is higher than 85% for the
dataset with at least 25 cells. Therefore, we recommend that BPSC
should be applied for datasets with at least 25 cells. Besides, due to
the requirements for computing the goodness—of—fit statistic, the

Table 2. Comparisons between BP3 and the standard gamma-
Poisson model , where 0 represents the level of improvement in
the AIC score.

 

 

c 0 2 5
MDA-MB—231 0.82 0.73 0.59
HTC116 0.88 0.78 0.60

 

The entries in the table are the proportion of transcripts where
AICBp + c < AIC(;p, where 6 represents the level of improvement in the AIC
score.

 

50
I

40

30
|

AIC scores of BP model

 

 

 

 

AIC scores of GP model

Fig. 2. BP3 model versus GP model in AIC scores from MDA-MB-231 dataset.
In more than 80% of the transcripts, the AIC of the BP model (AICBP) is less
than the AIC of the GP model (AICGp)

ﬁm'spzumol‘pmyo'sopcuuowtotq/ﬁdnq

Beta—Poisson model for scRNA—seq

2133

 

number of bins K also should be greater than 17+ 1. For example,
number of bins K of the BP4 model is at least 6 for practical use.

Differential expression analysis

To evaluate the performance of BPSC for differential expression
analysis, we use the four—parameter beta—Poisson model combined
with the generalized linear model. We compare the results to edgeR—
glm of the edgeR software version 3.10.2 (McCarthy et al., 2012;
Robinson et al., 2010) as a representative of methods for bulk—cell
RNA—seq data analyses based on the negative—binomial distribution
or equivalently the gamma—Poisson distribution. The edgeR software
is applied on the read—count dataset as the input requirements of the
software, and a normalization step is integrated inside the software.
We use the protocol in a recent study (Anders et al., 2013) for
edgeR—glm implementation. We also compare BPSC to MAST ver—
sion 1.0.1 (Finak et al., 2015 ), a recent method for differential ex—
pression analysis in scRNA—seq data. In brief, MAST proposes to
use a hurdle model (Finak et al., 2015 ) to capture bimodality of
gene expression, then apply likelihood ratio to test for differential
expression.

BPSC works on the data normalized to library sizes from cpm
function of the edgeR software (in the simulated datasets) or directly
on the FPKM data (in the real datasets). In the original study,
MAST was input from log2(TPM+ 1) expression matrix. Herein,
TPM (or transcripts per million) indicates normalized expression
data. In our implementation, we replace TPM by FPKM for the real
dataset and cpm for simulated datasets. Default parameter settings
of the software are applied. Finally, we extract the P—values from
each method and report the false discovery rates (Pawitan et al.,
2005), called estimated FDR. In simulated datasets, we are also able
to calculate the true FDR by comparing the top genes ranked by the
P—values to the true status of DE genes. These FDR values are
ranked in increasing order and used for method comparison in
Figure 3. In this figure, the method with a lower FDR at a certain
number of top genes (transcripts) is better.

We first compare BPSC, MAST and edgeR in the two simulation
setups: chim and scSim. The chim uses the gamma—Poisson model
to generate a traditional bulk—cell RNA—seq dataset, while scSim
simulate a single—cell RNA—seq dataset from the beta—Poisson model.
We report the average FDR values of 100 simulations, and for visual
purposes we present the top 1000 genes for comparison. For the
chim setting, Figure 3a shows that BPSC, MAST and edgeR have
similar performances, both in terms of estimated FDR (left) and true
FDR (right). The estimated FDRs from BPSC and MAST are close to
the true FDR when the true value <0.2, and they slightly under—esti—
mate when the value FDR > 0.2. These results indicate that BPSC is
also able to work well on the conventional bulk—cell RNA—seq data
in this experiment.

Figure 3b shows that BPSC outperforms MAST and edgeR in
both the true FDR (right) and estimated FDR (left). Moreover,
Figure S5 of Supplementary report, a zoomed—out of Figure 3 with
more genes and a larger FDR range, shows BPSC and MAST are
more reliable than edgeR in the scSim setting: there is a large dis—
crepancy between the estimated FDR and the true FDR curves of the
edgeR method, which is in contrast to the curves from BPSC. Since
we have shown above that the beta—Poisson model fits the single—cell
data well, this is an indication that edgeR may not be suitable for
single—cell RNA—seq data.

For the MDA—MB—231 dataset, in Figure 3c (left plot) BPSC
shows lower FDR than both MAST and edgeR. Moreover, in the
zoomed—out version (Fig. S5c of Supplementary report), the pattern

 

 

 

 

 

(a) 8- 8.-
D D
D D
N - N —
D D
1:: cr:
0 0 -
LL LL
5’— 5’—
0' ' 0' '
_ — BPSC
-o- edgeR -o- edgeR
g _ + MAST g _ + MAST
D I D

 

 

o 260 460 660 860 who o 260 460 660 860 who

Top ranked genes Top ranked genes

 

   
  

 

 

 

(b) 8 . 8..
r 0
I
_ I.  _
C) I .' C)
N - ' s N -
0 I? 0
cc ,1." cc
E '  E
I,
C) i C)
F. - 2 F. -
0 3 0
s. — BPSC _ — BPSC
»o- edgeR -o- edgeR
g_ + MAST g_ + MAST
0 0

 

 

 

o 260 460 660 860 who o 260 460 660 860 who
Top ranked genes Top ranked genes

 

  

 

 

   

   

(c) 8. . 8 . r +.
0' o’ 1+ 0' ’
, o 1
I .+ I
a + I +
l + ,
0 o r
N - or . ,
0 0 I“
1:: 1:: r
0 0 — r
u. LL 1
C) C) I
,_ _ v— . 1
0' I 0' I
— BPSC — BPSC
-o- edgeR -o- edgeR

 

 

+ MAST + MAST

o 500 who 15'oo zobo d 500 who 15'oo 20'oo
Top ranked transcripts Top ranked genes

 

 

 

 

0.00
0.00

 

Fig. 3. False discovery rates evaluated in (a) chim, (b) scSim and (c) MDA-
MB-231 datasets using BPSC, MAST and edgeR methods. In each plot, the
horizontal axis indicates the number of top ranked genes/transcripts obtained
by the methods. The vertical axis presents corresponding FDR values of
gene/transcripts in the horizontal axis. In simulated datasets, the FDR value is
the average from 100 simulations. In (a) and (b), the left plots present esti-
mated FDR, while the right ones display the true FDR of the simulated data-
sets. (c) The estimated FDR of the transcript-level (left) and the gene-level
(right) expression datasets

is quite similar to the scSim simulation, so the most likely explan—
ation is that the beta—poisson model is more appropriate than the
gamma—poisson model in this single—cell RNA—seq dataset. Figure 30
(right plot) shows that the analyses at transcript—level and at gene—
level expression produce similar results.

Table 3 presents the top 10 DE transcripts discovered by BPSC.
The FDR values of these transcripts from the edgeR method in the
last column expresses that they are also well differentially expressed
by the method. Next we investigate the affected biological pathways
using the Reactome tool (Croft et al., 2014) and the website of
human gene database http://www.genecards.org. Many of the top
DE genes (RPS17, RPL28, EIF6 and EIF5AL1) are involved in the
mRNA translation processes, such as the eukaryotic translation ini—
tiation, eukaryotic translation elongation and eukaryotic translation
termination. Since it is known that metformin can induce the down—
regulation of translation of some mRNAs (Larsson et al., 2012), the
perturbation of metformin in this study may have a similar effect.
We also discover two DE genes PRDX2 and PRDX3. These genes
encode for peroxiredoxin (Prdx) proteins and are involved in the de—
toxification of reactive—oxygen—species pathway, which is previously
shown to protect a breast cancer cell—line against doxorubicin—medi—
ated toxicity (McDonald et al., 2014). A full biological analysis of
the results is out of the scope of this current methodological study
and will be done separately.

ﬁlO'SIlZIImOprOJXO'SOplZILLIOJLIIOIQ/[idnq

2134

T.N. Vu et al.

 

Table 3. List of top 10 DE transcripts in the MDA-MB-231 dataset
discovered by the BPSC method. The gene symbols and FDR val-
ues of these transcripts are displayed in column Gene and BPSC,
respectively

 

 

Rank Transcript Gene BPSC edgeR

1 NM_00119047O MTRNRZLZ 1.365439e-84 6.0940116-98
2 NM_000146 FTL 1.134770e-23 6.180201e-36
3 NM_001021 RPSl7 2.842266e-20 1.560132e-13
4 NM_OOO991 RPL28 1.722874e-12 1.052418e-15
5 NM_OO5782 ALYREF 6.952639e-11 1.006880e-14
6 NM_001267810 EIF6 2.069525e-10 1.166470e-05
7 NM_001099692 EIF5AL1 6.553389e-10 4.268580e-09
8 NM_001165415 LDHA 3.359049e-09 2.806511e-06
9 NM_OO6793 PRDX3 1.1822706-08 9.0442646-08

H
O

NM_005809 PRDX2 1.684913e-08 1.320194e-07

 

The last column presents the corresponding FDR values of the transcripts

 

 

 

 

 

 

 

 

 

 

 

 

 

discovered by edgeR.

LO LO
N N _
0' — BPSC 0'
O -o- edgeR O
N - -»+-- MAST N -
O -A- scde O
1‘3 1‘3 _

cc 0' cc 0'

D 0

LL 0 LL 0
0' 0' '
LO LO
0 O .
0' 0'
O O
O. O. - ' '
° (5 5'0 160 10 O 0 5'0 160 10

Top ranked genes Top ranked genes

Fig. 4. True FDR evaluated in the chim (left) and scSim (right) simulation set-
ting using the scde, edgeR and BPSC methods. The horizontal axis indicates
the number of top-ranked genes obtained by the methods; the vertical axis
presents the corresponding FDR values. The FDR value is the average from
10 simulations

We also compare BPSC to scde (Kharchenko et al., 2014) version
1.99.0, a recent method for differential expression analysis of single—
cell RNA—seq data using a Bayesian approach. Due to the heavy
computation of the scde software (see more details in Fig. S6 of
Supplementary report), we keep the same number of cells in each
group, but reduce the number of genes down to 3000 genes in both
simulated bulk—cell and single—cell RNAseq datasets. Similar to
edgeR, the scde uses read counts as input. Default parameter settings
of the software are applied. Since the scde does not report P—values
but use Z—scores for the differential expression analysis, we do not
compare the methods in terms of estimated FDR. Instead, as sug—
gested by the software tutorials, we use the top genes ranked by the
absolute of their Z—scores, then compute the true FDR for
comparison.

We run the simulation 10 times (low number due to computa—
tional demands of scde), and the average results are shown in
Figure 4. The left panel shows that all methods are successful in the
bulk—cell simulation setting (chim) and achieve the same FDR.
However, for the single—cell setting (scSim), the BPSC method has
better performance as compared to the scde, as shown in right panel
of figure. Table 4 briefly summarizes the performance of the meth—
ods on differential expression analysis for different benchmarks.

7 Conclusions

We have presented a model for gene expression of single—cell RNA—
seq data based on the beta—Poisson mixture model. Experiments

Table 4. Performance of BPSC, scde, MAST and edgeR on differen-
tial expression analysis using different benchmarks

 

 

Setting edgeR MAST scde BPSC
Bulk-cell (GP model, true FDR) + + + +
Bulk-cell (GP model, estimated FDR) + + NA +
Single-cell (BP model, true FDR) + — — ++
Single-cell (BP model, estimated FDR) — + NA ++
Single-cell (real data, estimated FDR) — + NA ++
Computational time ++ ++ — +

 

The methods are assessed as very positive (++), positive (+), not positive
(7) or result not available (NA).

with real datasets show that our approach is able to correctly model
a great majority of the transcripts. We also introduce an application
of the model for differential expression analysis through a combin—
ation with the generalized linear model. The results of differential
expression analysis in both simulated and real single—cell RNA—seq
datasets demonstrate that the proposed method performs well
against a traditional method commonly used in bulk—cell RNA—seq
data and recent methods designed for differential expression analysis
in single—cell RNA—seq dataset. The success of the model helps
understand further the transcription mechanism of gene expression
in single—cell level and opens opportunities for better analyses of sin—
gle—cell RNA—seq data.

Funding

This work was supported by grants from the Swedish Science Council and the
Swedish Cancer Foundation.

Conﬂict of Interest: none declared.

References

Anders,S. et al. (2013) Count-based differential expression analysis of RNA
sequencing data using R and Bioconductor. Nat. Protoc., 8, 1765—1786.

Anders,S. et al. (2015) HTSeqa Python framework to work with high-through-
put sequencing data. Bioinformatics, 31, 166—169.

Croft,D. et al. (2014) The Reactome pathway knowledgebase. Nucleic Acids
Res., 42, D472—D477.

Daigle,B.]. et al. (2015) Inferring single-cell gene expression mechanisms using
stochastic simulation. Bioinformatics, btv007.

Finak,G. et al. (2015) MAST: a ﬂexible statistical framework for assessing
transcriptional changes and characterizing heterogeneity in single-cell RNA
sequencing data. Genome Biol., 16, 278.

Hildebrand,F.B. (1974). Introduction to Numerical Analysis. 2nd edition.
McGraw-Hill, New York.

Kharchenko,P.V. et al. (2014) Bayesian approach to single-cell differential ex-
pression analysis. Nat. Methods, 11, 740—742.

Larsson,O. et al. (2012) Distinct perturbation of the translatome by the anti-
diabetic drug metformin. Proc. Natl. Acad. Sci. USA, 109, 8977—8982.

Law,C.W. et al. (2014) voom: precision weights unlock linear model analysis
tools for RNA-seq read counts. Genome Biol., 15, R29.

McCarthy,D.J. et al. (2012) Differential expression analysis of multifactor
RNA-Seq experiments with respect to biological variation. Nucleic Acids
Res., 40, 4288—4297.

McDonald,C. et al. (2014) Peroxiredoxin proteins protect MCF-7 breast can-
cer cells from doxorubicin-induced toxicity. Int. Oncol., 45, 219—226.

Patro,R. et al. (2014) Sailﬁsh enables alignment-free isoform quantiﬁcation
from RNA-seq reads using lightweight algorithms. Nat. Biotechnol., 32,
462—464.

Pawitan,Y. (2013). In All Likelihood: Statistical Modelling and Inference
Using Likelihood. Oxford University Press, Oxford.

ﬁle'srcumol'pmﬂo'sopcuuoprtotq/ﬁdnq

Beta—Poisson model for scRNA—seq

2135

 

Pawitan,Y. et al. (2005) False discovery rate, sensitivity and sample size for
microarray studies. Bioinformatics, 21, 3017—3024.

Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for differential ex—
pression analysis of digital gene expression data. Bioinformatics, 26, 139—140.

Sanchez,A. et al. (2013) Stochastic models of transcription: from single mol-
ecules to single cells. Methods, 62, 13—25.

Shahrezaei,V. and Swain,P.S. (2008) Analytical distributions for stochastic
gene expression. Proc. Natl. Acad. Sci. USA, 105, 17256—17261.

Shalek,A.K. et al. (2013) Single-cell transcriptomics reveals bimodality in ex-
pression and splicing in immune cells. Nature, 498, 236—240.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti-
ation. Nat. Biotechnol., 28, 511—515.

Velten,L. et al. (2015) Single-cell polyadenylation site mapping reveals 3 iso-
form choice variability. Mol. Syst. Biol., 11, 812.

Wills,Q.F. et al. (2013) Single-cell gene expression analysis reveals genetic as-
sociations masked in whole-tissue experiments. Nat. Biotechnol., 31,
748—752.

Wu,A.R. et al. (2014) Quantitative assessment of single-cell RNA-sequencing
methods. Nat. Methods, 11, 41—46.

/3.IO'S[BIIInOIp.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

