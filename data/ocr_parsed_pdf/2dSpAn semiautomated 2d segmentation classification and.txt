Bioinformatics, 32(16), 2016, 2490—2498

doi: 10.1093/bioinformatics/btw172

Advance Access Publication Date: 1 April 2016
Original Paper

 

 

Bioimage informatics

ZdSpAn: semiautomated 2-d segmentation,
classification and analysis of hippocampal
dendritic spine plasticity

Subhadip Basu1'*, Dariusz Plewczynskiz, Satadal Saha3,
Matylda Roszkowska“, Marta Magnowska", Ewa Baczynska4
and Jakub Wlodarczyk4'*

1Department of Computer Science and Engineering, Jadavpur University, Kolkata 700032, India, 2Center of New
Technologies, University of Warsaw, Warsaw, Poland, 3Department of Electronics and Communication
Engineering, MCKV Institute of Engineering, Howrah 711204, India and 4Department of Molecular and Cellular
Neurobiology, Nencki Institute of Experimental Biology, Polish Academy of Sciences, Warsaw, Poland

*To whom correspondence should be addressed.
Associate Editor: Robert Murphy

Received on October 2, 2015; revised on March 21, 2016; accepted on March 26, 2016

Abstract

Motivation: Accurate and effective dendritic spine segmentation from the dendrites remains as a
challenge for current neuroimaging research community. In this article, we present a new method
(2dSpAn) for 2—d segmentation, classification and analysis of structural/plastic changes of hippo—
campal dendritic spines. A user interactive segmentation method with convolution kernels is de—
signed to segment the spines from the dendrites. Formal morphological definitions are presented
to describe key attributes related to the shape of segmented spines. Spines are automatically clas—
sified into one of four classes: Stubby, Filopodia, Mushroom and Spine—head Protrusions.

Results: The developed method is validated using confocal light microscopy images of dendritic
spines from dissociated hippocampal cultures for: (i) quantitative analysis of spine morphological
changes, (ii) reproducibility analysis for assessment of user—independence of the developed soft—
ware and (iii) accuracy analysis with respect to the manually labeled ground truth images, and also
with respect to the available state of the art. The developed method is monitored and used to pre—
cisely describe the morphology of individual spines in real—time experiments, i.e. consequent
images of the same dendritic fragment.

Availability and Implementation: The software and the source code are available at https://sites.
google.com/site/stpan/ under open—source license for non—commercial use.

Contact: subhadip@cse.jdvu.ac.in or j.wlodarczyk@nencki.gov.pl

Supplementary information: Supplementary data are available at Bioinformatics online.

9103 ‘Org JSanV 110 salaﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 ﬁle'smumofqurxo"sothJJOJutotq/ﬁduq 11101} popcolumoq

 

1 Introduction

Neuronal cells in different brain regions are covered with dendritic
spines (Ramon and Cajal, 1904), which are small membranous pro—
trusions having a length of around few microns. They form the post—
synaptic compartment of most excitatory synapses in the central
nervous system (Bourne and Harris, 2008). Dendritic spine is

usually composed of a spine head and a spine neck that connects the
spine head to the dendritic shaft (Gray, 1959). More specifically, a
spine head, Where the excitatory synapse is located, is separated
from the parent dendrite by a thin neck, isolating the spine cyto—
plasm from the dendrite (Harris, 1994). Spines are likely to play an
essential role in neural circuits but their exact function is still a mat—
ter of debate ($313 and Segal, 2014; Shepherd, 1996; Yuste, 2011).

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2490

ZdSpAn: segmentation, classification and analysis of dendritic spine plasticity 2491

 

Because of their morphology, dendritic spines are assumed to play a
role in electrical and biochemical compartmentalization (Bonhoeffer
and Yuste, 2002; Lee et al., 2012; Tunnesen et al., 2014; Yuste
et al., 2000).

Synaptic plasticity is essential for brain development and higher
brain functions (Alvarez and Sabatini, 2007; Holtmaat and Svoboda,
2009). Changes in dendritic spine morphology are believed to associ—
ate synaptic plasticity (Holtmaat and Svoboda, 2009; Matsuzaki
et al., 2004; Oh et al., 2013; Tunnesen et al., 2014; Yuste and
Bonhoeffer, 2001), which seem to be critical for synaptic function
(Matsuzaki et al., 2001; Nusser et al., 1998). However, the under—
standing of the relationship between the changes in dendritic spine
structure and synapse functions remains inadequate. The quantitative
contribution of spine morphology to biochemical compartmentaliza—
tion is still unknown, in spite of being a long—standing hypothesis
(Chang, 1952; Crick, 1982). Therefore, the important question is,
whether or how much the synaptic strength may be adjusted through
structural changes in spine necks (or the complete spine) (Araya
et al., 2014). Effective solution to this problem is particularly difficult
due the complex morphology of the dendritic spines. The problem
gets compounded with the limited resolution of optical microscopic
images (Papa et al., 1995). In many situations, the spines are difficult
to be segmented from the images of dendritic segments having hun—
dreds of these protrusions. Identification of true spine boundaries is
difficult and time—consuming (Mishchenko et al., 2010; Mukai et al.,
2011; Son et al., 2011). Accurate quantitative analyses of the spines
depend on the question, ‘how easily and effectively the spines can be
segmented from the dendrite?’

Recently, some researchers have tried to address the earlier issue.
A Patent Cooperation Treaty (PCT) application (Wong et al., 2006)
presents a method for characterizing one or more neurons compris—
ing dendritic spines utilizing a grassfire process. The technique is
particularly efficient for detecting separated spine heads. However,
no detailed description is provided on how to precisely detect the
contours of the spine. The work by Ruszczycki et al. (2012a,b) pre—
sents a method for segmentation and analysis of every spine separ—
ately using a contour tracing algorithm. Two points are marked for
each spine, one at the bottom of the neck and the other at the head
[the farthest point (FP) on the spine from the neck]. Then a parame—
terized contour tracing algorithm detects the spine boundary and the
morphological attributes. This process requires extensive user—inter—
vention. In images with hundreds of spines, marking two end—points
and choosing appropriate segmentation parameters for every spine
is a rigorous job. This makes segmentation of dendritic spines both
times consuming and error—prone. In one of the recent develop—
ments, Heck et al. (2015) proposed an advanced 3D approach for
segmentation of the spines, however, that kind of approach requires
many optimization steps and extensive manual supervision.

Apart from the works mentioned earlier, several neuromorpho—
logical tracing tools are also available (Donohue and Ascoli, 2011).
Many of these techniques use the commercial reconstruction soft—
ware Neurolucida (Halavi et al., 2012). Existing tracing tools like,
Filament Tracer (http://quIuI.bitplane.com/imaris/ﬂlamenttracer),
Amira (http://quIquei.com/software/amira—3d—for—life—sciences/),
Eutectic NTS {/7ttp://neuronland.org/NLMorploologyCom/erter/
MorphologyFormats/Eutectics/Spec.lotml), 3DMA-Neuron (http://
quIuI.ams.sunysb.edu/~lindquis/3dma/3dma_neuron/3dma_neuron.
lotml), Neuron] (http://www.imagescience.org/mei/ering/software/neu
ran/Y), NeuronStudio (https://en.ulikipedia.org/wiki/NeuronStudio),
Neuron_Morp/70 {/7ttp://quIuI.southampton.ac.uk/~dales/morploo/),
etc. require extensive manual annotations and parameter selection
for automated/semiautomated reconstructions. For example,

Filament Tracer (a module of the commercial Imaris software) in—
corporates visualization and editing utilities and performs morpho—
metric calculations by fitting the objects from the finite list of shapes
(such as, cone, ball and cylinder). Similarly, Neuron_Morp/70, an
open—source tool for semiautomatic digital tracing of neurons from
image stacks, generates outline of the neurite or soma by drawing
straight lines across the width of the section. None of these applica—
tions provides formal morphological definitions of spines. Some ap—
plications like Neuron] are developed as Image] (Abramoff et al.,
2004) plugins and are slow in analyzing images. These tools are
often applicable on specific types of images, like, 8—bit grayscale or
indexed color images.

The proposed 2dSpAn method significantly reduces human in—
volvement and allows the operators to quantitatively assess den—
dritic spine plasticity. Users need to mark a specific dendritic
segment, automatically segment the spines using the designed convo—
lution kernels and finally mark the spines of interest to extract rele—
vant features with high accuracy and minimal intervention.
Moreover, the proposed 2dSpAn method allows morphological ana—
lysis of spines from different type of images including those acquired
by super—resolution, confocal and wide field microscopy images.

The overall method is divided in two steps: (i) segmentation of
the dendritic spines and (ii) quantitative assessment of spine morph—
ology. In the article, we brieﬂy describe the theory behind the de—
veloped segmentation algorithm and highlight the main features of
the 2dSpAn interface and software architecture. The performed ex—
perimental validation is done with respect to the confocal images of
dendritic spines from dissociated hippocampal cultures. Finally, we
conclude with a discussion on open—source software development,
limitations and future plans.

2 Theory and methods

Present work considers a 2D grayscale image (I) of dendrites with
spines as the input to the segmentation method. In I, dendrites with
the spines are defined as the object region ((9) and the region (I — O)
is considered as the background (B). For segmentation of the den—
dritic spines, a dendritic segment is first identified by marking the
two points 17, q in (9. We then estimate the region of interest (ROI)
around 17, q as R, such that R Q I. We have used adaptive binariza—
tion algorithm (Otsu, 1975) in R to segment 0 from B (Fig. 1).

w

 

Fig. 1. A grayscale image (I) with dendrites and spines, along with the object
region (0) and the background (B). The ROI (R) is identified by manually se-
lecting the points (p, q) in O and binarized using adaptive thresholding. R3 is
the segmentation result obtained after applying the complementary convolu-
tion kernels with or : 45

9103 ‘Org rsnﬁnv uo salaﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 ﬁle'smumoiqurxo"sothJJOJutotq/ﬁduq 11101} papeolumoq

2492

S.Basu et al.

 

 

kﬂl

   

lbl K45

Fig. 2. Convolution kernels (Km) for (a) or : 90 and (b) or : 45

Moreover, previously we have designed a set of convolution kernels
(Basu et al., 2007), for segmentation of the dendritic spines in R.

Convolution kernels (K0,) are represented as mutually exclusive set
of3—tuples, such that, K“ 2 {(06, [2117/212), (067/2217l222) ...(0€,l€M1,l€M2)},
where or represents the angular spread (in degree) of the kernel and
M : 360/u. Designed convolution kernels with u : 90 and u : 45
are shown in Figure 2a and b. During the segmentation process, we
first apply the kernel [2,1 from p until q or a boundary condition is
reached. Let the expanded region in this step be R1 C (9 [Fig. 3(a—e)].
Then [2,2 is applied from q until p or a boundary condition is reached.
Let the region expanded after applying [2,2 be R2 C (9 (Fig. 3f and g).
Then, we estimate, R3 : (R1 ﬂ R2) as the intersection of the two ex—
panded regions generated by the two kernels, km and [212 (Fig. 3h).
We then manually select a spine seed 5;, as a point inside a potential
dendritic spine region, bounded by B and R3 (Fig. 3h). The bounded
region, expanded from 5,3 using a region growing algorithm (Adams
and Bischof, 1994), is marked as segmented spine (Sk) (Fig. 3i).
Variation of segmentation results with different choices of u, and
varying binarization thresholds are illustrated in Figure 4(a—g). The
rationale behind the choice of the segmentation kernels is included in
supplementary.

2.1 Quantitative assessment of spine morphology

The morphology of the dendritic spines is complex and difficult to
segment and quantify. In most cases, they are described by simple
parameters like length and head uIidth (Ruszczycki et al., 2012a,b).
However, high resolution confocal microscopy allows visualization
of the complex structures in greater details. In this work, we have at—
tempted to define key morphological attributes from the 2D images
of dendritic spines and classify the segmented spines in four catego—
ries; (a) Stubby, (b) Mushroom, (c) Filopodia and (d) Spine—head

Protrusion (see Fig. 5 for illustration). Specifically, we propose for—
mal definitions of the base, neck and head of the spine, using the
standard mathematical notations of digital topology and geometry.
First, we identify the base (3),) of the dendritic spine S;a as the set of
points (Shase) in R3 such that Shage and S;a are adjacent. Please note
that, 8 — neighbourhood of a point is used to define the adjacency
criterion.

Definition 1: The central hase point (CBP) is defined as
CBPk : ‘31—“:in where, (Bk) is the cardinality of the set of points in
Bk, CBP}a E (R3 U Sk) and [71' E Bk.

Now, we compute distance transform (DT) (Borgefors, 1986;
Saha et al., 2015) in R by considering Skas the object and (R — Sk)
as background. Let the DT values (distance of each point from the
background) for any point (p) in R be Q(p). We use local scale of an
object pixel as the DT value (depth) at the closest locally deepest
pixel. Specifically, a pixel p E S;a is said to be locally deepest if
Vq E N[(p), (2(a) g (2(p), where N)(p) is the (2l+ 1)2 neighbor—
hood of p; here, I : 2 is used to avoid noisy local maxima. To find
the length of the spine, from the FP to CBP,a in Sk, we compute DT
in S;a by considering CBP,a as background and represent it as 

Definition 2: The central head point (CHP) is defined as
CHP;a : ‘Hl—mzipi, where, HP;a C S;a be the set of all locally
deepest pixels in Si, lHPkl is the cardinality of the set of points in
HP)“ CHP}a E Sk and [7," E HPk.

Definition 3: The FP, pESk, is defined such that, VqESk,
9(4) S 907)}.

Please note that, CBP, CHP and FP play key roles in estimation
of the spine attributes like, length of the spine, neck-length, neck-
uIidth, head-width, etc. To estimate these features, we further
extend the earlier definitions to find the geodesic path from base
to head (BHk) of the spine S;a by joining the two central points CBP;a
and CHP;a such that ZPiEBHkQ(p,-) is minimized (Fig. 6a and b).
Likewise, we compute the central path from head to farthest
point (HFk) of the spine S;a by joining CHP;a and FPk, such that
ZPiEHFkQ(p,-) is minimized (Fig. 6a and b).

Now, we estimate the neck length of S;a as NL;a : BHk—
(2(CHPk). Minimum neck-width (MNW) of S;a is estimated as
MN Wk :minvpiEBHk(Q(p,-)). Average head-width (AHW) of the
spine S;a is estimated as AHWk : avgvpiEHPk (Q(p,-)) and the length of
the spine S;a is estimated as, L;a : IBHkI + lHFkl.

 

Algorithm 1. 2dSpAn spine classiﬁcation algorithm

 

Input: S : set of segmented spines in R, such that R g I
Output: Classification of each S;a E S as Stuhhy, Filopodia,
Mushroom or Spine — head Protrusion

for (each segmented spine S;a E S) do
{if(NL;a 2: 0) then
S;a : Stuhhy

if ((NL,a > 0)&&(%:ﬂm > y))then S,a : Filopodia

if ((NL,a > 0)&&(Sk 5A Filopodia)&8c(%f < 5))then
S;a : Mushroom

if ((NL;a > 0)8€8€(S;a 9E Filopodia)8(8€(S;a 9E Mushroom)) then
S;a : Spine — head Protrusion

}end for

 

 

 

9103 ‘Org JSanV uo sajaﬁuv 50'] ‘Btulomrzg JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeolumoq

2dSpAn: segmentation, classification and analysis of dendritic spine plasticity 2493

 

   

  

 

p I

 

 

 

 

 

 

 

 

Object region (0)

Bat kground region (B)

obiect region Rk after application 0! convolution kernel 1:”

object region R; after applicatim of toovolution kernel k”

 

 

p 1?

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Segmented dendrite region R: = R, n R;
Manuain placed seed pier
Segmented spine region

Base ol the spine

Fig. 3. A step-by-step representation of the segmentation process over a synthetic dataset, by applying the convolution kernel K90 : {(90,k11,k12)}; (a) the start (p)
and end (q) points are marked on a synthetic dataset, (b) the convolution kernel k“ is first applied on p, (c and cl) results of successive application of the convolution
kernel k“, on p2 and p3, respectively, marked in (b), (e) result obtained after iterative application of kn on the image (stop, when q is reached or no further application
of the kernel is possible), (f) now, the convolution kernel kn is first applied on q, (g) result obtained after iterative application of km on the image, (h) the segmented
dendrite region (R3) is estimated by intersection of the regions generated by kn and km, a manual seed point is then placed inside the potential spine region, (i) the
spine region is segmented using region growing from the manual seed and the base pixels are identified following the Definition 1

2.2 Classification of the segmented spines
Using the morphological definitions discussed in Subsection 2.1, we
classify the spine shapes into one of the four categories: Stubby,
Mushroom, Filopodia and Spine—head Protrusion. Formal morpho—
logical definitions for these spine categories are not available in the
literature and these classifications were largely subjective and
decided empirically by the experimental biologists. To address this
issue, we have developed a rule—based approach for automatic cat—
egorization of the spine shapes into one of the four classes as dis—
cussed in Algorithm 1, where, 0 g y, 5 g 1 and Dmax(HPk) is the
distance between the two farthest locally deepest points (HPk) in Sk.
The basic classification logic relies on the accurate estimation of
the neck length (NLk) of a spine. If the neck length is zero, we clas—
sify a spine as Stubby. Otherwise, we check the positions of the 10—
cally deepest points (HPk). In case of a thin, Filopodia, the locally
deepest points are usually spread along the length (LK) of the spine.
This is not common in Mushroom or Spine—head Protrusions, where
the locally deepest points are usually concentrated around the spine-
head regions. Therefore, the ratio Dm,,x(HPk)/L;a returns higher val—
ues in case of a Filopodia. Then, to classify the Mushroom type
spines we estimate the hase-to-head distance (BHk) of a spine. We
have observed that the Mushroom spines have short hase—to-head
distance in comparison to the overall length of spine and the ratio
BHk/L;a decisively classifies the Mushroom spines from the Spine—
head Protrusions. Spine classification results on different dendritic
segments with v : 0.5 and 5 : 0.5 are shown in Figure 7.

3 Results

The developed 2dSpAn tool is useful in a variety of applications
involving large—scale annotation of dendritic spines for quick and ac—
curate assessment of spine plastic changes. There are two specific
challenges involved in this process: (i) accurate segmentation of indi—
vidual spines from the dendritic segment and (ii) quantitative ana—
lysis of spine morphology for effective assessment of dendritic
spines’ structural changes. As discussed before, the objective of this
work is to demonstrate the efficacy of the 2dSpAn tool in annotation
of dendritic spines and to compare its performance with respect to
the available tools. Specifically, we have concentrated on the ana—
lysis of spine plasticity using the morphological features presented in
the previous section. The confocal light microscopy images of den—
dritic spines from dissociated hippocampal cultures have been used
for: (i) quantitative analysis of spine morphological changes, (ii) re—
producibility analysis for assessment of user—independence of the de—
veloped software,(iii) accuracy analysis with respect to the ground
truth (GT) annotations generated by the experimental biologists and
also with respect to the available state of the art. In the following
subsection, we first describe the image acquisition protocol and the
image sets used for the experimental validation. Then, we present
the analysis of spine structural changes of the mentioned datasets,
mutually blind three—user reproducibility analysis using the de—
veloped 2dSpAn software and finally, the error analysis with respect
to the GT annotations and also with respect to the work by
Ruszczycki et al. (2012a,b).

9103 ‘Org JSanV uo sajaﬁuv 50'] ‘Btulomrzg JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeolumoq

2494

S.Basu et al.

 

 

Fig. 4. Variation of segmentation results with different choices of or and binar-
ization thresholds (Th); (a) original image segment, (b) or : 45 with adaptive
Th : 128, (c) or : 45 with Otsu Th : 98, (d) or : 90 with adaptive Th : 128, (e) or
: 45 with custom Th : 160, (f) spines are segmented using the image ob-
tained in (e) by clicking once on each spine (please note that the connected
spines #5 and #6 are segmented by a ‘Blue' line using the ‘Manual Seg' tool),
(g) final spine segmentation result obtained from (f)

I‘ ' In). 
(ll)

(cl


Fig. 5. Different examples of dendritic spine categories; (a) Stubby, (b)
Mushroom, (0) Filopodia and (d) Spine-head Protrusion (Color version of this
figure is available at Bioinformatics online.)

 
  

i

3.1 Description of the dataset

3.1.1 Dissociated hippocampal cultures preparation

Dissociated hippocampal cultures from P0 (postnatal Day 0) Wistar
rats were prepared as described later. Brains were removed and hip—
pocampi were isolated on ice in dissociation medium DM; 81.8 mM
Nast4, 30 mM K2504, 5.8 mM MgClz, 0.25 mM CaClz, 1mM
HEPES pH 7.4, 20 mM glucose; 1 mM kynureic acid; 0.001%
Phenol Red. Next, hippocampi were incubated twice for 15 min at
37°C with 100 units of papain (Worthington, NY) in DM, then
rinsed three times in DM and subsequently three times in plating
medium [MEM, 10% fetal bovine serum and 1% penicilin—strepto—
mycin]. Hippocampi were triturated in plating medium, then centri—
fuged for 10 min at room temperature, at 208.5 g. The resulting cell
pellet was suspended in plating medium, cells were counted and
plated at density 120 000 cells per 18—mm—diameter coverslip
(Assistent, Germany) coated with 1 mg/ml poly—L—lysine (Sigma) and
2.5 gig/ml laminin (Roche). At 3 h after plating medium was
exchanged for maintenance medium (Neurobasal—A without Phenol
Red, 2% B—27 supplement, 1% penicillin—streptomycin, 0.5 mM
glutamine, 12.5 11M glutamate, 25 11M ll—mercaptoethanol) and cells
were kept at 37°CC, under a humidified 5% C02 atmosphere.

3.1.2 Live cell imaging and chemical long-term potentiation (cLTP)
stimulation

Cultured hippocampal neurons were transfected at 14 days in vitro
(DIV) with Syn—GFP plasmid to visualize neuronal morphology.
Live cell imaging was performed on 20—22 DIV. Prior the imaging,
the cells were placed in an acquisition chamber with controlled

   
 

I Multiplelocally
deepest pornls
HPx = {junk-ml

 

Fig. 6. Key structural points in a spine; (a) Multiple locally deepest points are
identified as HPk : {p1,p2,p3}, such that Dmax(HPk)is the distance between
the two farthest locally deepest points (p1,p3) and the CHP is identified as the
center of {p1,p2,p3}, (b) the key morphological points, CBPk, CHPk and FPk,
and the two geodesic paths BHk and HFk between these points in a spine Sk
are shown

 

Fig. 7. Spine classification results on three dendritic segments. The circle rep-
resents the AHW of the spine Skat the central head-point. The red, yellow,
blue and cyan colors of the circle represent the four spine classes, Stubby,
Mushroom, Filopodia and Spine-head Protrusion, respectively

temperature (37°C) and stable C02 (5%) concentration. Dendritic
segments decorated with dendritic spines were imaged at the Time
0, before stimulation, and then was induced by bath application of a
mixture of 50 11M forskolin, 50 11M picrotoxin and 0.1 ‘uM rolipram
(each dissolved in DMSO) in maintenance media. Dendritic seg—
ments were imaged at 10min after cLTP induction. Images were
acquired using the Carl Zeiss LSM780 confocal microscope with a
C—Apochromat 40 ></ 1.2 NA water immersion objective using
488 nm wavelength argon laser at 3% transmission at 70 nm/pixel
resolution. A series of z—stacks were acquired at 0.4 pm step.

3.1.3 Dataset preparation and nomenclature

Nine different neurons from rat dissociated hippocampal cultures
were imaged using a confocal light microscope, before and after
cLTP. All the images were captured twice, one at baseline (before
cLTP stimulation) and the other after 10 min from cLTP induction.
During image preprocessing, we took maximum intensity projection
(MIP) of the confocal z—stack and perform Gaussian de—noising on
the 2D MIP image. The preprocessed MIP images at Time 0 is
labeled as T0 and the images captured after 10min are labeled as
T10. In this experiment, total 459 dendritic spines are manually seg—
mented and annotated by experimental biologists in both T0 and
T10 images using an open—source image analysis software, Fiji
(Schindelin et al., 2012).

9103 05 JSanV uo so1a§uv soc] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeo1umoq

2dSpAn: segmentation, classification and analysis of dendritic spine plasticity

2495

 

3.2 Analysis of spine plasticity

For detailed quantitative analysis of the dendritic spines, first we
have analyzed the 2dSpAn classification results of 459 segmented
spines obtained from nine sets of T0 and T10 images. Initially in T0,
~31% were classified as Stubby (S), ~32% as Filopodia (F), ~27%
as Mushroom (M) and the rest 10% as Spine—head Protrusions (P).
After imaging of the same spines 10 min after cLTP (in T10), we got
~35% Stubby spines, ~33% Filopodia, ~23% Mushroom and
~9% Spine—head Protrusion spines. More than half of the spines
(~54%) remain in the same state 10 min after cLTP induction. The
transition patterns of spines are illustrated in Figure 8a. The transi—
tion patterns among three types of spine categories, Stubby,
Mushroom and Filopodia (by combining Spine—head Protrusions
with Filopodia) are shown in Figure 8b.

To further investigate the relative changes in various morpho—
logical attributes of the segmented spines, two important features,
area and length are considered from the overall experiment
(Supplementary Fig. S1). Please note that, the method allowed to re—
cord noticeable changes in area and length of dendritic spines, the
two most important attributes for spine plasticity, during cLTP in—
duction. In the previous section, we have morphologically defined
the neck-length attribute, and used this feature to classify the Stubby
spines (when neck-length is zero). In T0, the initial population of
some Stubby spines remains in the same state, whereas some get
transformed to Filopodia or Mushroom. On the other hand, some
Filopodia spines in T0 became Mushroom in T10. All these activities
are reﬂected in the changes of length and neck-length attributes
(Supplementary Fig. S2). Likewise, the variations in average neck-
uIidth along the neck region of the segmented spines are also
observed during the experiment. Stubby spines are excluded in this
analysis since they do not have any neck region. Head-width esti—
mates are important for all spine categories. The changes in neck
width and head-width for all Mushroom spines at T10 are included
in Supplementary Figure S3.

3.3 Reproducibility analysis

In this section, we present both qualitative and quantitative analysis
of multiuser reproducibility of the 2dSpAn tool to assess the reliabil—
ity and robustness of the developed software. The reproducibility
analysis is performed on the two image datasets from three mutually
blinded independent experimental biologists. In the first image, 112
spines are segmented by each of the users in both T0 and T10
images. In the second image, 39 spines are segmented in T0 and T10
images by the independent experts using our custom designed 2D
graphical interface.

Segmented images of dendritic spines from T10 by three different
users are illustrated in Figure 9. Although segmentation results show
significant similarity, there are some mismatches in classification re—
sults. For example, in case of segmented spine#9, results from
user#1 automatically annotates it as Spine—head Protrusion, whereas
the results from user#2 and user#3 annotate the same spine as
Filopodia. Similarly, there are some mismatches in the classification
results in spine#12, 13, 28, 41, 47, etc. The reason behind such dis—
agreements may be illustrated from the example of spine#47, where
different users segment the spine in different ways leading to varying
classification results for the segmented spine. The differences in seg—
mentation results are due to the differences in the choice of the seed
pixels and other segmentation parameters like binarization thresh—
olds, etc. Also, we have some manual segmentation and joining op—
tions in our developed 2dSpAn tool, to give more controls to the

Baseline [TO]

R s
10% ‘ .3193

2%
M
2m

(8)

       
 

2% .

5% 3%

After 10 Minutes (T10)

Baseilne (To)

5
' I” §
D M OM
27% 23%

5% After 10 Minutes (T10)

Fig. 8. Analysis of spine plasticity using automatic spine classification results,
where S, F, M and P represent spine categories: Stubby, Filopodia,
Mushroom and Spine-head Protrusions, respectively. The numbers and the
edge thickness represent relative transition (in % of total population) between
different spine categories before and after cLTP induction. (a) four class ana-
lysis, (b) three class analysis (by combining Spine-head Protrusions with
Filopodia) (Color version of this figure is available at Bioinformatics online.)

users. Uses of these advanced controls/parameters often lead to dif—
ferences in segmentation and classification results.

For quantitative evaluation of the reproducibility, we have used
the statistical SD of the area estimates of individual spines by the
three independent users. In T0 and T10 images, the average SD val—
ues are observed as 0.09 and 0.07, respectively (see Supplementary
Fig. S4 for detailed analysis).

3.4 Accuracy analysis and comparison with prior works

For accuracy analysis, we first generated GT spine segmentation re—
sults for all the nine neuronal images using the open source image
processing software called Fiji (Schindelin et al., 2012). Although,
Fiji is a general purpose image analysis tool and not capable of ex—
tracting morphological attributes specific to a dendritic spine, we
have considered the most generic and one of the most significant
features, area of a spine (in micronz), for comparative analysis. For
accuracy assessment of the features, we have used mean absolute
error (MAE) to measure the differences of the 2dSpAn estimates
with respect to the GT annotations. We measure the MAE for
area with respect to Fiji based GT annotations as,
MAEESEPAPGTI : ﬁZIQ ﬁZdSPA” — yicT , where, n is the total num—
ber of spines,  and y,- are the area estimates of the it” spine by
2dSpAn and Fiji based GT annotations, respectively. The

9103 05 JSanV uo so1a§uv soc] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeo1umoq

2496

S.Basu et al.

 

 

\

Fig. 9. Segmented images of dendritic spines from three mutually blind users (Color version of this figure is available at Bioinformatics online.)

Area (micronAZ)
_’

Area of Segmented Spines (TO)

I 1‘, I I II‘ 1 1 r i ‘ ‘ ‘
1 v (Inﬁll. (I.  ‘ : (1)11») ‘ (1 I, (I I ‘Ilrj

 

Ground Truth

 

 

Ruszczyc ki et al.

 

 

— 2dSpAn I

I n I'

 

 

Fig. 10. Comparative accuracy analysis of the area feature on all the segmented spines at baseline (T0), with respect to the manually annotated GT and the results
obtained by the software developed by Ruszczycki et al. (Color version of this figure is available at Bioinformatics online.)

MA EESSPAHTGTI values for 459 spines over T0 and T10 images are
obtained as 0.23 and 0.21, respectively. The SD of errors over T0
and T10 images are observed as 0.18 and 0.19, respectively. To
compare with the prior works, we have extensively evaluated the
spine segmentation and annotation tool developed by Ruszczycki
et al. (2012a,b) over all the images. Although there are significant
differences in the working principal and user intervention, we found
this software as the closest match with the work developed by us.
Please note that, the work by Ruszczycki et al. use extensive man—
ual intervention for segmentation of individual spines. The
MA EESZCZYCM “ “I‘_GTI for T0 and T10 are obtained as 0.26 and
0.24, respectively. The SD of errors over T0 and T10 images are
observed as 0.21 and 0.17, respectively. Likewise, MA
EESEI’APRL‘SKWCM “ “LI values for T0 and T10 are estimated as 0.22
and 0.21, respectively. We also estimated and compared the length
of the spine with respect to the work by Ruszczycki et al. Manual
annotations in Fiji could not effectively estimate length of individual
spines. MAEli???”—Rusmycki 8t “LI values for T0 and T10 are esti—
mated as 0.25 and 0.37, respectively. Figure 10 shows the compara—
tive plot of the area feature estimated by our developed 2dSpAn
tool, the Ruszczycki et al. software and Fiji based GT annotations
over the segmented spines in the complete image set (T0). The accur—
acy analysis shows that the developed 2dSpAn tool is more accurate
than the work by Ruszczycki et al. with respect to the estimated
area of the segmented spines on both T0 and T10 images. Also,
2dSpAn requires considerably less user involvement in comparison
to the work by Ruszczycki et al. (2012a,b)Therefore, large number

of spines can be annotated quickly and effortlessly without compro—
mising on the accuracy of the estimated spine features.

We have also assessed the accuracy of the spine classification re—
sults with respect to the manual annotations done by the one experi—
mental neurobiologist. The spines are annotated in three classes as
Mushroom, Stubby or Filopodia. 2dSpAn successfully classified
63.7% spines in T0 and 60.4% spines in T10 images. In many cases,
the manual annotator was unsure about the true label of the seg—
mented spine, thus a consensus of manual annotators would be
required to improve the quality of the manual annotations. Also,
automatic spine classification module itself may be improved in the
future by incorporating advanced machine learning algorithms.

4 Discussion

In this work, we present a new tool for fast and accurate annotation
of dendritic spines from confocal microscopy images. However, the
2dSpAn method allows determining the morphology of spines from
super—resolution microscopy and is not limited only to confocal
images. Please note that, the applied confocal imaging technique
provides sufficient resolution to detect the changes of dendritic
spines morphology (Szepesi et al., 2014). We also define and extract
several morphological features from the segmented spine images for
quantitative assessment of spine structural plasticity. Although there
are some tools that serve somewhat similar purposes, like the one
developed by Ruszczycki et al. (2012a,b), they do not provide the

9103 05 JSanV uo so1a§uv soc] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeo1umoq

2dSpAn: segmentation, classification and analysis of dendritic spine plasticity 2497

 

formal morphological definitions to different spine compartments.
For example, there were no formal morphological characterizations
to base, neck and head of a spine, in the prior works. There are
plenty of biological discussions in contemporary literature but most
of them are subjective with respect to digital image segmentation
and analysis. We also provide an automatic spine classification
framework based on the features extracted from the segmented
spines. The proposed spine classification model works on a rule—
based decision tree framework and may be improved further in fu—
ture versions of the software. The performance of the classifier is
assessed by comparing the manual annotations from experimental
biologists. The developed spine segmentation methodology is
based on a novel convolution kernel—based approach. This meth—
odology is effective in isolating the dendritic segment in between
two manually embedded seed points on the image, using the 2D
graphical user interface of the developed software. The spines on
either side of the dendritic segment are marked by the user by
placing a single inside seed, leading to segmentation of the spine
from the dendritic segment. The morphological features like area
and length of the spine are computed immediately. Other features
like neck-length, neck-width and head-width are also estimated
for each segmented spine. The segmentation and classification
steps in the 2dSpAn tool are extremely fast and almost instantan—
eous on a standard desktop computer. The segmentation task
takes N1 5 and the classification of individual spines takes several
milliseconds computation time on the desktop computer used in
our experiment.

To assess the efficacy of the developed tool, we first analyzed
dendritic spine structural changes with respect to two image data—
sets, before and after cLTP. We have quantitatively assessed the
transitions between the spine categories Stubby, Filopodia,
Mushroom and Spine—head Protrusions. The changes in spine area
and length are observed over all segmented spines. For all non—
Stubby spines, the changes in neck-length and neck-width values are
analyzed. We have also assessed the changes in head-width in all
Mushroom type spines. Please note that the objective of this study is
to demonstrate the capabilities of the developed 2dSpAn tool and
therefore we are not inferring any biological significance from the
experimental observations.

For stability and robustness study, a three—user reproducibility
analysis has been performed. Both qualitative and quantitative
analysis show exciting results on the T0 and T10 image sets. The
accuracy analysis is performed with respect to the manually
annotated GT dataset and also with respect to the prior works
available in this domain. There are still scopes for improvement
especially with respect to the design of the user interface and also
with respect to the preprocessing steps for the image sets. The
complete work depends on the binarization algorithm applied on
the ROI marked by the user. At this moment, we use a global
binarization on the complete region. This process may sometime
inﬂict noise in the data, leading to inappropriate segmentation of
the spines. We are currently working on that issue and hope to
improve the same in the upcoming version of the software. The
basic software architecture, along with a representative screen—
shot (Supplementary Fig. S5) is discussed in supplementary and
also in the user manual. Finally, on the availability of the de—
veloped software, we would like to mention that the complete
open—source, platform—independent package is available at https://
sites.google.com/site/2dspan/ for non—commercial use by the re—
search community.

Funding

S.B. and 5.5. were supported by Erasmus Mundus Mobility with Asia—West
grant from E.U. S.B. was also supported by FASTTRACK grant [SR/FTP/
ETA-O4/2012] by Department of Science and Technology, Government of
India. D.P. was supported by the Polish National Science Center [Grant num-
ber 2013/09/B/NZ2/00121 and 2014/15/B/ST6/05082] and COST BM1405
and BM1408 EU actions. J.W., M.R., M.M. and EB. were supported by the
National Science Center [grant number UMO—2012/O6/M/NZ3/00163,
UMO—2013.09/N/NZ3/03527].

Conﬂict of Interest: none declared.

References

Abramoff,M.D. et al. (2004) Image processing with image]. Biophotonics Int.,
11, 36—41.

Adams,R. and Bischof,L. (1994) Seeded region growing. Pattern Anal. Mach.
Intell. IEEE Trans., 16, 641—647.

Alvarez,V.A. and Sabatini,B.L. (2007) Anatomical and physiological plasticity
of dendritic spines. Annu. Rev. Neurosci., 30, 79—97.

Araya,R. et al. (2014) Activity—dependent dendritic spine neck changes are cor—
related with synaptic strength. Proc. Natl. Acad. Sci., 111, E2895—E2904.
Basu,S. et al. (2007) Text line extraction from multi-skewed handwritten

documents. Pattern Recogn., 40, 1825—1839.

Bonhoeffer,T. and Yuste,R. (2002) Spine motility: phenomenology, mechan—
isms, and function. Neuron, 35, 1019—1027.

Borgefors,G. (1986) Distance transformations in digital images. Comput.
Vision Graph. Image Process., 34, 344—371.

Bourne,J.N. and Harris,K.M. (2008) Balancing structure and function at hip—
pocampal dendritic spines. Annu. Rev. Neurosci., 31, 47.

Chang,H.T. (1952) Cortical neurons with particular reference to the apical
dendrites. In: Cold Spring Harbor Symposia on Quantitative Biology. Cold
Spring Harbor Laboratory Press, pp. 189—202.

Crick,F. (1982) Do dendritic spines twitch? Trends Neurosci., 5, 44—46.

Donohue,D.E. and Ascoli,G.A. (2011) Automated reconstruction of neuronal
morphology: an overview. Brain Res. Rev., 67, 94—102.

Gray,E. G. (1959) Electron microscopy of synaptic contacts on dendrite spines
of the cerebral cortex. Nature, 183, 15 92—15 93.

Halavi,M. et al. (2012) Digital reconstructions of neuronal morphology:
three decades of research trends. Front. Neurosci., 6, 49. doi: 10.3389/
fnins.2012.00049. eCollection 2012.

Harris,K.M. (1994) Dendritic Spines. In: eLS. John Wiley 86 Sons, Ltd. doi:
10.1038/npg.e1s.0000093.

Heck,N. et al. (2015 ) A new automated 3D detection of synaptic contacts re—
veals the formation of cortico-striatal synapses upon cocaine treatment
in vivo. Brain Struct. Funct., 220, 2953—2966.

Holtmaat,A. and Svoboda,K. (2009) Experience-dependent structural synap-
tic plasticity in the mammalian brain. Nat. Rev. Neurosci., 10, 647—65 8.

Lee,K.F.H. et al. (2012) Examining form and function of dendritic spines.
Neural Plast., 2012, doi: 10.1155/2012/704103.

Matsuzaki,M. et al. (2001) Dendritic spine geometry is critical for AMPA re—
ceptor expression in hippocampal CA1 pyramidal neurons. Nat. Neurosci.,
4,1086—1092.

Matsuzaki,M. et al. (2004) Structural basis of long-term potentiation in single
dendritic spines. Nature, 429, 761—766.

Mishchenko,Y. et al. (2010) Ultrastructural analysis of hippocampal neuropil
from the connectomics perspective. Neuron, 67, 1009—1020.

Mukai,H. et al. (2011) Automated analysis of spines from confocal laser mi—
croscopy images: application to the discrimination of androgen and estrogen
effects on spinogenesis. Cereh. Cortex, 21, 2704—2711.

Nusser,Z. et al. (1998) Cell type and pathway dependence of synaptic AMPA
receptor number and variability in the hippocampus. Neuron, 21, 545—55 9.

Oh,W.C. et al. (2013) Synapse—speciﬁc and size—dependent mechanisms of
spine structural plasticity accompanying synaptic weakening. Proc. Natl.
Acad. Sci., 110, E305—E3 12.

Otsu,N. (1975) A threshold selection method from gray—level histograms.
Automatica, 1 1, 23—27.

9103 05 isnﬁnv uo so1a§uv soc] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeo1umoq

2498

S.Basu et al.

 

Papa,M. et al. (1995) Morphological analysis of dendritic spine development
in primary cultures of hippocampal neurons. ]. Neurosci., 15, 1—11.

Ramon y Cajal,S. Textura del Sistema Nervioso del Hombre y de los
Vertebrados. Vol. 2. Nicolas Moya, Madrid.

Ruszczycki,B. et al. (2012a) Method and a system for processing an image
comprising dendritic spines. U. S. Pat. Appl., 14/237,352.

Ruszczycki,B. et al. (2012b) Sampling issues in quantitative analysis of den—
dritic spines morphology. BMC Bioinformatics, 13, 213.

Saha,P. et al. (2015 ) Digital topology and geometry in medical imaging: a sur-
vey. Med. Imaging IEEE Trans., 34, 1940—1964.

Sala,C. and Segal,M. (2014) Dendritic spines: the locus of structural and func—
tional plasticity. Physiol. Rev., 94, 141—188.

Schindelin,]. et al. (2012) Fiji: an open—source platform for biological—image
analysis. Nat. Methods, 9, 676—682.

Shepherd,G.M. (1996) The dendritic spine: a multifunctional integrative unit.
]. Neurophysiol., 75, 2197—2210.

Son,J. et al. (2011) Morphological change tracking of dendritic spines based
on structural features. ]. Microsc., 241, 261—272.

Szepesi,Z. et al. (2014) Synaptically Released Matrix Metalloproteinase
Activity in Control of Structural Plasticity and the Cell Surface Distribution
of GluAl-AMPA Receptors. PLoS One, 9, e98274.

Tonnesen,J. et al. (2014) Spine neck plasticity regulates compartmentalization
of synapses. Nat. Neurosci., 17, 678—685.

Wong,S.T.C. et al. (2006) Methods and systems for the analysis of 3d micro-
scopic neuron images. U. S. Pat. Appl., PCT/USZOO6/0195 89.

Yuste,R. (2011) Dendritic spines and distributed circuits. Neuron, 71,
772—781.

Yuste,R. et al. (2000) From form to function: calcium compartmentalization
in dendritic spines. Nat. Neurosci., 3, 653—65 9.

Yuste,R. and Bonhoeffer,T. (2001) Morphological changes in dendritic spines
associated with long-term synaptic plasticity. Annu. Rev. Neurosci., 24,
1071—1089.

9103 05 isnﬁnv uo so1a§uv soc] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeo1umoq

