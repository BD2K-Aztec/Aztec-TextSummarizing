Bioinformatics Advance Access published August 2, 2016

Bioinformatics, 2016, 1—7

doi: 10.1093/bioinformatics/btw416

Advance Access Publication Date: 13 July 2016
Original Paper

 

 

Gene expression

cisASE: a likelihood-based method for detecting
putative cis-regulated allele-specific expression
in RNA sequencing data

Zhi Liu1, Tuantuan Gui1, Zhen Wang1, Hong Li1, Yunhe Fuz, Xiao Dong3'*
and Yixue Li1'4'5'6'*

1Key Laboratory of Computational Biology, CAS-MPG Partner Institute for Computational Biology, Shanghai
Institutes for Biological Sciences, Chinese Academy of Sciences, Shanghai 200031, China, 2Key Laboratory of
Systems Biology, Institute of Biochemistry and Cell Biology, Shanghai Institutes for Biological Sciences, Chinese
Academy of Sciences, Shanghai 200031, China, 3Department of Genetics, Albert Einstein College of Medicine,
Bronx, NY 10461, USA,4Schoo| of Life Science and Technology, Shanghai Jiaotong University, Shanghai 200240,
China, 5Shanghai Center for Bioinformation Technology, Shanghai Industrial Technology Institute, Shanghai
201203, China and 6Collaborative Innovation Center for Genetics and Development, Fudan University, Shanghai
200438, China

*To whom correspondence should be addressed.
Associate Editor: Ziv Bar-Joseph

Received on October 27, 2015; revised on May 16, 2016; accepted on June 24, 2016

Abstract

Motivation: Allele—specific expression (ASE) is a useful way to identify cis—acting regulatory vari—
ation, which provides opportunities to develop new therapeutic strategies that activate beneficial
alleles or silence mutated alleles at specific loci. However, multiple problems hinder the identifica—
tion of ASE in next—generation sequencing (NGS) data.

Results: We developed cisASE, a likelihood—based method for detecting ASE on single nucleotide
variant (SNV), exon and gene levels from sequencing data without requiring phasing or parental in—
formation. cisASE uses matched DNA—seq data to control technical bias and copy number variation
(CNV) in putative cis—regulated ASE identification. Compared with state—of—the—art methods, cisASE
exhibits significantly increased accuracy and speed. cisASE works moderately well for datasets
without DNA—seq and thus is widely applicable. By applying cisASE to real datasets, we identified
specific ASE characteristics in normal and cancer tissues, thus indicating that cisASE has potential
for wide applications in cancer genomics.

Availability and Implementation: cisASE is freely available at http://lifecenter.sgst.cn/cisASE.
Contact: biosinodx@gmail.com or yxli@sibs.ac.cn

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 |ntroducﬁon pronounced effect on human phenotypic polymorphism and com—

. . , , , mon diseases. Somatic ASEs (ASEs of somatic mutations) in tumors
Allele—specific gene expresslon (ASE) refers to the d1fferent1al expres—

. . . . , , , are often genetically linked to tumor drivers. Thus, ASE studies pro—
slon of two alleles In a d1p101d genome. ASE is primarily a result of

vide an opportunity for the development of new therapeutic strat—
egies that activate beneficial alleles or silence mutated alleles at
specific loci (Huang et (11., 2012).

the associated cis—element variation and allele—specific epigenetic
modifications (Pastinen, 2010). Germline ASEs are usually associ—
ated with the existence of regulatory elements, which exert a

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1

91oz ‘Og JSanV 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /310'S[Bu1n0prOJXO'SOlIBLUJOJIIlOlCWIdllq 11101} popcolumoq

ZLiu et al.

 

Next—generation sequencing (NGS) allows for the genome—wide
identification of ASE (Heap et al., 2010; Lee et al., 2013; Smith,
2013); however, several problems exist. The first problem is technical
and intrinsic allele bias, which we and others have previously demon—
strated (Degner et al., 2009; Liu et al., 2014). For example, reads car—
rying single nucleotide variants (SNVs) are less likely to be correctly
mapped than those carrying reference genotype (Degner et al., 2009).
Another example is that, a large proportion of previously identified
ASEs, especially in tumor samples, have been found a result of copy
number variations (CNVs) rather than cis—regulation (Tuch et al.,
2010). The second problem is that gene—level ASE detection usually re—
quires phased—SNVs or parental genomes (Montgomery et al., 2010;
Rozowsky et al., 2011; Skelly et al., 2011; Zhang et al., 2009), which
are usually not available. Although methods to phase single—
nucleotide polymorphisms (SNPs) into individual haplotypes exist
(Browning and Browning, 2007; Howie et al., 2009), these methods
cannot be applied to somatic mutations in tumors. The third problem
relates to testing ASE with statistical confidence. Two simple statis—
tical methods, i.e. binomial and chi—square tests, have been frequently
used in SNV—level ASE detection (Ge et al., 2009; Heap et al., 2010;
Zhang et al., 2009); however, these methods do not make full use of
the information of these complex sequencing datasets. Although sev—
eral tools have been developed for ASE detection, none has addressed
all of these concerns (Mayba et al., 2014; Pandey et al., 2013;
Rozowsky et al., 2011; Skelly et al., 2011).

To overcome the problems outlined above, we proposed a new com—
putational method and developed a software tool, cisASE, based on a
likelihood ratio test. cisASE uses DNA—seq data to make site—by—site ad—
justments for RNA allele imbalance assessment to reduce the effects of
technical bias and CNV, and reports ASE putatively caused by cis—regu—
lation. cisASE also considers the base quality of each base to reduce the
inﬂuence of sequencing error. We tested cisASE on both simulated and
real datasets, and compared it with other methods (Mayba et al., 2014;
Skelly et al., 2011). cisASE exhibits significantly improved accuracy and
computational speed compared with existing methods.

We applied cisASE to public colon tumor datasets, and observed
several important features, i.e. germline ASE hotspots of human
leukocyte antigen (HLA) loci, cancer somatic ASE genes in focal ad—
hesion and extracellular matrix (ECM)—recept0r interaction path—
ways. These findings revealed a landscape of germline and somatic
ASE in colon tumors and highlighted broad applications of our
cisASE method in ASE detection.

2 Materials and methods
2.1 Simulated data

We selected normal tissue data (71:46) of a human colon dataset
(n : 92) (Seshagiri et al., 2012) as the basis for generating a simu—
lated dataset (Supplementary Material) because this dataset contains
high—quality matched DNA—seq and RNA—seq data with high
sequencing depth. The dataset was also used to test our method
(described in the following sections).

First, fold changes of adjusted RNA allele counts of the real data
were calculated using the following equation,

it: RNAref/En: RNAalt,
f6 : 1:1 1:1
2 DNAref/Z DNAalt,
i:1 i:1

where n is the number of SNVs for a specific feature (SNV, exon
or gene). The distributions of log2 fc and log2 DNA depth were

then modeled using Laplace (Supplementary Fig. S1) and normal
distributions, respectively. For each simulated SNV, its DNA
sequencing depth was drawn from the normal distribution, and its
RNA sequencing depth was sampled from the real data. Both
DNA and RNA reference allele counts were assumed to exhibit a
binomial distributionr ~ B(n,p), where n is the sequencing depth
of DNA—seq or RNA—seq, and p is the frequency of reference
allele.

To simulate data without CNV (non—CNV data), DNA refer—
ence allele counts were subjected to a binomial distribution with
parameter p estimated from real DNA—seq data. To mimic the pro—
portion of ASEs in real data, we sampled fc for each SNV from the
above Laplace distribution. When the sampled fc exceeded a cer—
tain cutoff (1.5, 2, 3, 4 or 5), we generated a true positive ASE
SNV, whose RNA reference allele count was subject to a binomial
distribution with parameter p determined as the fraction of DNA
reference allele after adjustment by the sampled fc (illustrated in
Supplementary Fig. S2). Otherwise, we generated a true negative
site with the parameter p of the binomial distribution setting as its
DNA reference allele fraction. We simulated 1000 genes for each
fc cutoff, and the number of SNVs in each gene was also sampled
from the real data.

To simulate data carrying CNV (CNV data), DNA reference allele
count of each SNV was assumed to have a binomial distribution, with
a DNA ratio of reference (R) and alternative (A) alleles n(R):n(A):2,
3 or 4, for DNA copy numbers of 2, 3 and 4, respectively.

Next, to assess the performance of cisASE at different sequencing
depths, we simulated another non—CNV dataset with fixed depth
(10—20, 20—30, 30—40 and 40—50) and fixed number of SNVs per
gene (1, 2, 3, 4 or 5 ), resulting in datasets with 125 strata
(Supplementary Material).

2.2 Real sequencing datasets

We collected three real sequencing datasets to test cisASE. First,
we obtained RNA and Exon sequencing data of 46 pairs of
matched human colon tumor—normal samples from the European
Genome—Phenome Archive (EGA) under accession number
EGAS00001000288 (Seshagiri et al., 2012). Second, RNA—seq
and DNA—seq data for a well—studied individual NA12878 were
obtained from the Gene Expression Omnibus (GEO) under acces—
sion number GSE30401 (Rozowsky et al., 2011) and the ENA
with accession number ERR194147, respectively. The phased gen—
omic variants of individual NA12878 in hg19 coordinates were
obtained from Rozowsky et al. (2011). Additionally, a mouse
dataset including exon and RNA sequencing data was down—
loaded from the European Nucleotide Archive (ENA) under acces—
sion numbers PRJEB5321 and PRJEB5320, respectively (Castle
et al., 2014). DNA—seq and RNA—seq reads were mapped to the
reference genome using b0wtie2, and all duplicated reads were
removed to avoid the effects of polymerase chain reaction (PCR)
duplication.

2.3 Methods

The allele ratios of reference and alternative alleles in normal sam—
ples deviate from expected value (1:1) (Supplementary Fig. S3) be—
cause of technical bias in strand capture, sequencing process and
mapping. Additionally, in cancer samples, because of somatic struc—
ture variations, e.g. CNV, the bias is more severe (Supplementary
Fig. S3). To detect putative cis—regulated ASE regardless of bias and
CNV, we use DNA—seq data for site—by—site adjustment based on the
assumption of Zhang et al. (2009) that technical bias in the

9103 ‘Og JSanV 110 sejeﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /3.10'spzu.tn0fp.tq1x0"sothJJOJutotq/ﬁduq 11101} pepmjumoq

Applications of cisASE in RNA sequencing data

 

 

 

 

 

 

 

 

 

 

 

      
 

RNA-m Wm: plluup SIIIMWUD mam 
7 , a .
— — __ _ unzip;th I_ am»  
= rilwlﬂzf’lﬁ 1.. (.w: g
ohm-q ' " .
Sample summarize Aiminer threshold
5 d
, a 3 .
E a a Slmul'uiiona
3 z  mum-«hm

  
  
 
 

rim .rm‘ wen-(r)

5 {W} rDIDJl
a Innranu mm

 

..
m7

Fig. 1. Overview of cisASE algorithm. Mapped RNA-seq and DNA-seq data
are piled up using samtools. LLR of the null and alternative models is calcu-
lated for each feature, i.e. SNV, exon or gene. Simulated DNA and RNA allele
counts are generated from the data to produce a null distribution of the LLR,
which is used to define an LLR cutoff with respect to a particular significance
level. The LLR of each measured feature is compared to the LLR cutoff to de-
termine whether it is an ASE

measurement of the allele ratio for DNA is the same for RNA.
cisASE pipeline is illustrated in Figure 1, including following steps:
(1) pileup files are generated from DNA—seq and RNA—seq data
(mapped bam files after duplication removal) using samtools
(Supplementary Material) (Li et al., 2009). (2) The pileup files are
submitted to cisASE, and log—likelihood ratio score (LLR) for each
feature (SNV, exon or gene) is calculated. (3) For each input sample,
the null distribution of LLRs is simulated from the input itself, and
the LLR cutoffs corresponding to alpha levels of 0.05 and 0.01 are
determined from the null distribution. (4) The LLRs are compared
with a cutoff at a specific alpha level to determine whether the fea—
tures are ASEs.

2.3. 1 Model for SNV-level LLR calculation

We take standard pileup files as input and calculate the probability
of observing base b,- on read 1' (i : 1. . .d, where d is the coverage of
base b,) at each SNV following Cibulskis et al. (2013),

f.%+(1—f)(1—e,) if b,:r

Ham-w) : f(1 — e» + <1 4).; if b.- :a <2>
% otherwise

where r and a refer to the reference and alternative allele respect—
ively. f refers to the fraction of the alternative allele. e, is the
probability of errors in that base call (each base has an associated
Phred—like quality score, 11,-, where e,- : 10“” 10). We assume
that the sequencing errors are independent for each read and that
substitution errors are uniformly distributed and occur with prob—
ability e,-/3.

To assess allelic imbalance, we explain the observations with the
following two hypotheses,

Ho : f : DNAalt/(DNAref + DNAalt)

3
H1 : f : RNAalt/(RNAref + RNAalt) I I

where DNAref/alt and RNAref/alt represent the allele read counts
of the reference and alternative alleles in the DNA and RNA
sequencing data, respectively. ASE detection is performed by
comparing the likelihoods of two hypotheses. When the LLR, as

defined below, exceeds a decision threshold, we identify the SNV as
an ASE.

LLR = log10 

d d (4)
= Zlog10(P(biIfma,e.-,r,a)) — Zlog10(P(biIfdm,enW)
>1

17 i:1

2.3.2 Model for gene/exon—level LLR calculation
For genes harboring n informative heterozygous SNVs, the hypothe—
ses are modified as follows,

2 DNAhapZ
Ho If I —,, 1T1 ;
Z(DNAIoap1 + DNAhapZ)
i:1

RNAhapZ
1

szf: I:

n

Z(RNAhap1 + RNAhapZ)
i:1

where DNAhapI/Z and RNAhapI/Z represent the allele counts of
the haplotype 1/2 allele. We implemented the pseudo—phasing pro—
cess applied by Mayba et al. (2014) in cisASE. This process esti—
mates the major and minor haplotypes by assigning SNV—level
alleles with higher RNA read counts to the ‘major’ haplotype (hap1)
and those with lower RNA read counts to the ‘minor’ haplotype
(hap2). This process is applied to both gene—level and exon—level
ASE detection when no phasing information is provided.
Alternatively, users can provide their own phasing information to
cisASE.

One problem in gene—level ASE detection is that alternative splic—
ing can affect the ASE identification when skip efficiency differs be—
tween two haplotypes. cisASE can accept annotation files containing
labels for constitutive exons (parameter — C1) and considers only
SNVs within constitutive exons when measuring gene—level ASE. A
chi—square test is applied to check the consistency of the allele ratios
for all SNVs within a gene. For multi—SNV genes, a small P—value
from the chi—square test indicates that individual SNVs differ signifi—
cantly in their allelic ratios. This inconsistency can arise because of
differences in ASE between various transcript isoforms of a gene or
counting errors for SNVs prone to technical bias. Candidate ASE
genes with this inconsistency (e.g. P—value of the chi—square test
<0.05) should be filtered out by users.

2.3.3 Generating a null distribution

To determine a decision threshold to reject the null hypothesis, we
perform the following simulation to calculate the threshold for a
specific significance level a.

For each input dataset, we simulate paired DNA and RNA data
from the dataset itself. The simulated DNA and RNA sequencing
depths are randomly sampled from the input. Read counts of both
the simulated DNA and RNA reference alleles are assumed to follow
a binomial distributionr N B (n, p), where p is the average DNA or
RNA reference allele frequency of the input. Base qualities and the
number of SNVs in each feature (i.e. SNV, exon or gene) are also
sampled from the input, and sequencing errors (0.001 errors per
base) are added to the simulated reads. The LLR of each simulated
feature is calculated according to Equation (4).

9103 ‘Og JSanV uo sejeﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOlIBLUJOJIIlOlqﬂIdllq 11101} papacjumoq

ZLiu et al.

 

By repeating the simulation S times, we estimate a null distribu—
tion of the LLR and determine a cutoff corresponding to significance
level a according to Equation (6),

P(A(X) S ﬂIHo) 2 0t (6)
The default simulation repeat time S is set to 2000, which is rea—
sonable for obtaining a robust cutoff (Supplementary Fig. S4; dis—
cussed in the Supplementary Material), and the LLR cutoffs at alpha
levels of 0.05 and 0.01 are provided.cisASE can also be applied to
datasets without parallel DNA—seq data. In this situation, the pre—
existing DNA bias can be set by users; otherwise, the pre—existing
DNA bias is assumed to be the same as the mean of the RNA bias.
In addition, when simulation is disabled by users, we recommend
SNV—level LLR cutoffs of 0.85 and 1.47 and gene—level LLR cutoffs
of 0.82 and 1.50 for alpha levels of 0.05 and 0.01, respectively,
based on a simulation of 92 sets of high—quality sequencing data
(Seshagiri et al., 2012). To test the robustness of the recommended
LLR cutoff, we applied it to Seshagiri’s data (Seshagiri et al., 2012)
and NA12878, and used the recommended LLR and the LLR calcu—
lated from the dataset itself as the cutoff to define ASE genes. This
process revealed 4.2 and 2.3% differences in the Seshagiri’s data
and NA12878, respectively (see the Supplementary Material for de—
tails), indicating that, with the recommended LLR, cisASE has ac—
ceptable performance.

2.3.4 Implementation of the chi-square test

We also implemented chi—square test, a widely used test that uses
count information of both DNA and RNA for ASE identification
(Heap et al., 2010; Zhang et al., 2009), in cisASE. We adjust the
DNA and RNA counts for the chi—square test using base qualities.
The adjusted counts for each base is defined as 1 — (3,, where e,
is the error rate of base i. In the absence of DNA input, we simulate
the DNA reference and alternative allele counts for each SNV
from the RNA sequencing depth and assume a DNA bias as men—
tioned in the Section 2.3.3. The allelic counts are summed for each
haplotype for multi—SNV genes and exons for testing.

3 Method evaluation

3.1 Evaluation in simulated data

To evaluate the effectiveness of taking DNA—seq data as a reference
for reducing bias, we ran cisASE with the following four settings,
using simulated non—CNV data and compared the performance
(Fig. 2 and Supplementary Table S1):

A. cisASE default (adopt site—by—site bias adjustment with DNA—
seq data);

B. set no DNA bias;

C. set DNA bias as the mean reference allele fraction of all SNVs
in the DNA—seq data; and

D. set DNA bias as the mean reference allele fraction of all SNVs
in the RNA—seq data.

The highest performance was achieved when using setting A.
The performances of cisASE with settings B and C were similar
(overlapping in Fig. 2) and inferior to that obtained with setting A.
These results suggest that bias is a local event and global adjustment
does not perform better than no adjustment. The performance was
worst when we estimated DNA bias from RNA—seq data (setting D).
Because of overdispersion (Skelly et al., 2011) and uneven sequenc—
ing depth of RNA—seq data, allele bias in a small percentage of
highly expressed transcripts may shift the mean bias away from 0.5,
resulting in higher false positive and false negative rates. Therefore,
we recommend running cisASE with setting B, in which the DNA

Fold change > 1.: Fold change > 2

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

   

C? - Q _
CD CD
0' T 0' T
.1”; c0. _ .1?! c9 _
.2 o .2 o
.1:' .1:
a .. Q «a-
a o- - a o- -
N. _ ("I _
O O
C! _ Cl _
° 1 I I I I 1 c
1.0 0.8 0.6 0.4 0,2 0.0 1.0 0.3 0.6 0.4 0.2 0.0
Speciﬁcity Specificity
Foldchange) 3 Fold change > 4
Cl _ Cl _
m m
0' T 0' T
E a. .. E 0:1 H
,5 o ,5 o
E q E“ a
a as - a as -
N. _ N. _
C) C)
C) C)
:6 T C) T
1.0 0.8 0.8 0.4 0.2 0.0 1.0 0.6 0.5 0.4 0.2 0.0
Spaclﬂclty Specrﬂcrty

Fig. 2. The performance of cisASE in simulated data with four different set-
tings. We applied cisASE to simulated data with four different settings for
pre-existing DNA bias. (A) site-by-site bias calculated from DNA-seq; (B) no
bias; (C) mean bias of the DNA-seq data; and (D) mean bias of the RNA-seq
data. B and C are overlapped

reference allele fraction is set to the expected value (0.5), for experi—
ments without matched DNA—seq data. Of note, in this case, users
cannot distinguish between cis—regulated ASE and CNV—resulted
ASE.

We compared cisASE with MBASED (Mayba et al., 2014),
which, to the best of our knowledge, is the only currently published
ASE—detection method that allows for gene—level ASE detection
without phasing information (Supplementary Table S2). We applied
MBASED to our simulated data with its default settings. For simu—
lated CNV data, cisASE substantially outperformed MBASED
(Fig. 3a). As illustrated in the table in Figure 3a, when a SNV is
located in a CNV region with a DNA ratio of 3:1 and its RNA allele
ratio is 1:1, MBASED produced a false negative result, whereas for
an RNA allele ratio of 3:1, MBASED produced a false positive re—
sult. cisASE also performed better with simulated non—CNV data
(Fig. 3b). Additionally, the computational speed of cisASE was
faster than that of MBASED. On average, for a sample with 3500
SNVs, the running time for MBASED was 460 min, and cisASE was
seven times faster, i.e. 68 min.

Next, we compared our method with the chi—square test. The re—
sults showed that, although the two methods exhibited comparable
specificity, the sensitivity of cisASE was much higher than that of
the chi—square test (Supplementary Fig. S5). We also measured the
accuracy of the chi—square test relative to that of cisASE. cisASE out—
performed the chi—square test in each stratum of the simulated data,
especially when the fold change threshold of the simulated data was
low (fc : 1.5), indicating its superior performance in detecting
mildly biased ASE and ASE at low sequencing depth (Fig. 4).

3.2 Evaluation in real data

We assessed the performance of cisASE in paired human colon
tumor—normal samples (Seshagiri et al., 2012). We randomly se—
lected 16 of the 46 pairs of paired data to compare the methods

9103 ‘01; JSanV uo so1e§uv 50'] 0211110111123 10 [(1151910qu 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Idllq 111011 pep201umoq

 

 

 

 

 

 

 

 

 

 

 

 

   

 

 

 

 

 

 

 

   

 

Applications of cisASE in RNA sequencing data 5
Fold change > 1.5 FIIIa mange > 2 Cancer Normal
(a) o _ .I _
v r In II
a ' 5‘ ' — oIsnscqeraur  m 7 —
é. o 7 g. u 7 In nunsrunnmt
II II III I; air 5 ° 5 " “MED
E ., a . I:
1:: 91 I25 Is: In I; 5 - a g,- - v
"I I I \‘E! Isl MI
1.1 II In mm! as: 3' 3' i a. a
o _ E, _ c m E
0 I I I I I I =' . I I I I I a 3 .9
10 as as In In on I0 III as n4 a: nu
Soocmmw swim " n
Fold was 3 3 Fcld change =- 4 Fold mange =- 5 f
— - - c. _- »' c. _- ‘4.-
I I I I I I I I I I
00 02 04 as W In 0.0 02 04 05 as 10

 

 

 

 

52mm»,
on 02 on no on LG

 

 

 

   

 

semi-III;

00 02 01 06 08 I0
EEWW

on M m no on 1.0

I I I I I I | I I I I I I I I
1.0 0.3 0.6 0.4 0.2 0.0 1.0 M 0.5 0‘ a) on 1.0 03 0.5 DA 0.: 00

 

 

   

 

 

 

 

 

 

 

 

 

 

 

Spaclllclly Sammy Spear-a,-
Fnld many» I 5 rum mange > 2 Fun dliiga>3
F! _ 0 _ F! _
It _ w _ ﬂ? _
a a a
—" 'D. _ E '9 _ .E‘ “I _
2 D 2 o .2 :I
e E '2
III 3 - II 5 - .3 S -
.. _ .. _ .. _
a a E.
E! _ 0 _ E! _
D I I I I I I o I I I I I I u I I I I I I
l.0 0.3 0.6 0.4 0.2 0.0 1.0 Ill 0.0 0‘ 02 0.0 L0 00 0.5 DA 0.2 00
Specillnirt Snack", .5th
Fold mange>4 Fold mange a 5
.- — I- . - ' _
I, A a ,
a o
.9, 3 7 a 2. a
II _ _ m; Iv _ _ m.
a r r WED G r IBA-‘IEI'I
a _ 9 _
n I I I I I l a | I I I I
1.0 0.5 0.6 0.0 0.2 0.0 1.0 0.0 0.0 0 J 02 0.0
5996111041? 599mm).

Fig. 3. Comparison of cisASE with MBASED in simulated data. cisASE per-
forms better than MBASED in each stratum of the simulated data with (a) and
without (b) CNV

1.5 2 3
5.
4-
3.
2—
1.
Iééééiééiéiéééé

GNP per gene

 

   

Coverage
4 5
Relativeaccuracy
g 1.0
0)
E‘ 0.9
3
n_ 0.3
2
‘0 or
I 2‘ é A é. I é 5 A é.
Coverage

Fig. 4. Comparison of cisASE with the chi-square test in simulated data. The
colors represent accuracy of the chi-square test relative to that of cisASE

because some of the methods have speed limitations. Ideally, with—
out technical and assessment bias, we would expect a balanced pro—
portion of ASE SNVs over—expressing reference allele and
alternative allele (0.5 versus 0.5). For ASE SNVs identified in the
data, the proportion of ASEs over—expressing reference alleles was

Paﬂlml 01 ASE Speclli: IU Feiemnce allele F‘Dﬂlclrl cll ASE SPEEIIIC In [EI'EIEHEE aIEIe

Fig. 5. Distribution of the percentage of ASE overexpressing reference alleles
in a real dataset. For each cancer (N: 16) and normal sample (N: 16), we cal-
culated the percentage of ASE specific to the reference allele (ASE with over-
expressed reference allele)

0.50 when using cisASE and 0.67 when using MBASED (Mayba
et al., 2014) (Fig. 5). We also compared the performance of cisASE
with and without DNA—seq data as an input for bias adjustment
(Fig. 5). These results indicate that cisASE efficiently decreased the
false positive results caused by pre—existing bias, especially bias to—
ward the reference allele.

Next, we applied cisASE to a mouse colon carcinoma cell line
(Castle et al., 2014). We identified 43 ASE SNVs with cisASE, cover—
ing all 31 SNVs identified by chi—square test at the same significance
level (P-value : 0.01). As demonstrated in Supplementary Figure S5,
for the SNV—level ASE detection, even for the most biased SNVs
(fc :5), sensitivity of the chi—square test was not as high as that of
cisASE until the sequencing depth increased to 40. Of the 12 ASE
SNVs only detected by cisASE, 10 had sequencing depths less than
40 for DNA or RNA, and one had a sequencing depth less than 60.
The remaining one had a chi—square P—value that fell slightly short
of the chosen cutoff of 0.01 (Supplementary Table S3). These results
were consistent with our conclusions based on the simulated data,
suggesting that cisASE has higher sensitivity, especially in cases of
low sequencing coverage.

We further applied cisASE to a high—quality phased individual,
NA12878, from the 1000 Genomes Project. First, we assessed the
performance of cisASE with and without known phasing informa—
tion. RNA and DNA sequencing data were pre—processed analo—
gously to our previous dataset (Supplementary Material). Overall
2295 genes were tested, including 963 (42%) with >1 heterozygous
locus. In total, 274 and 291 genes (Supplementary Table S4) were
classified as ASE genes at a significance level of 0.05 with and with—
out the known haplotype as input, respectively. Among these genes,
273 were shared. Similar to previous reports (Mayba et al., 2014),
pseudo—phasing had a high recovery rate of the true haplotype, and
98.0% (950/963) of the multi—SNV genes were correctly classified
by cisASE when no phasing information was supplied. These results
indicated that cisASE is an accurate method, even without phasing
information.

We then compared cisASE with MBASED(Mayba et al., 2014)
and Skelly’s method (Skelly et al., 2011) (see the Supplementary
Material for details). Skelly’s method requires known haplotype data
as input and incorporates DNA—seq information as the overall adjust—
ment for bias. In this comparison, haplotypes were supplied to all
three methods. A total of 274 (significance level: 0.05, adjusted
MAF 2 0.7), 114 (P g 0.05, MAF 2 0.7) and 137 [posterior
P(ASE) >0.95, posterior median MAF 2 0.7] ASE genes were detected
by cisASE, MBASED and Skelly’s method, respectively
(Supplementary Table S5). cisASE identified 85% ASE genes reported

9103 05 JSanV uo se1ef§uv 50'] 0211110111123 10 1015191011 {1 112 /310'S[BHmOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq mm} pep201umoq

ZLiu et al.

 

 

Ska”)!

Fig. 6. Comparison of cisASE with other methods in individual NA12878

by MBASED and 64% of those identified by Skelly’s method but was
more sensitive (Fig. 6 and Supplementary Fig. S6). Additionally,
cisASE required much less computation time, i.e. 90 min compared to
360 min for Skelly’s method and 660 min for MBASED.

4 Applications

To demonstrate the application of cisASE, we applied it to a panel
of 46 paired tumor—normal samples (Seshagiri et al., 2012).

4.1 Higher cis—regulated ASE level in tumor samples

For methods that do not use DNA—seq as a reference for bias adj ust—
ment, a high rate of CNV in tumor tissues (Shlien and Malkin,
2009) distorts the ASE detection results. For example, according to
Mayba et al. (2014), the ASE genes identified by MBASED in tumor
samples are mainly driven by large—scale genomic alterations, espe—
cially CNVs. However, the ASEs reported by cisASE should be un—
affected by CNV. Applying cisASE to colon samples revealed that
only 1 % of the ASE genes in tumor samples are located within CNV
regions (Fig. 7) and that the CNV genes are not significantly en—
riched in ASE genes (Fisher test P—value : 0.273). This result valid—
ates the effectiveness of cisASE in identifying cis—regulated ASEs.

By comparing tumor and normal samples, we found that tumor
samples exhibited 1.8—fold—higher ASE rates than normal samples
(P : 9.961e—06). This result indicates that the cis—regulation of gene
expression is more extensive in tumors.

4.2 Recurrent germline ASE and ASE hotspots in
normal and tumor samples

In the human colon dataset, we found that most ASE SNVs are
sample—specific (Supplementary Fig. S7). Low—frequency ASEs in the
population randomly distribute across chromosomes. However,
some hotspots exist (Supplementary Fig. S8 and Table S6), e.g. HLA
regions (Supplementary Table S7). MHC loci are some of the most
genetically variable coding loci in mammals, including humans
(Parham and Ohta, 1996). In normal tissues, polymorphisms in the
HLA loci have been found to be associated with a large number of
human phenotypic traits and common diseases (Shiina et al., 2009).
In tumors, HLA is frequently altered in comparison to the tissue
from which it originates (Yip et al., 2000). Our identification of
ASE hotspots in HLA loci indicated that the HLA loci are enriched

 

02

Normal
Cancer
mnCNV
CNV

"E
3
In
9
'5
m
3
E
0
g

 

00

Fig. 7. Comparison ofASE in paired tumor and normal samples

with regulatory polymorphisms, which contribute to phenotypic
polymorphism and disease in humans.

4.3 Highly overexpressed somatic mutant alleles in
tumor samples

Somatic ASEs, which are caused by linked somatic events in the
regulatory regions of genes or the somatic mutation itself, may con—
tribute to tumor progression. Because of the high genetic heterogen—
eity of tumors, matched DNA—seq data are required to identify
somatic ASEs with high accuracy.

We observed that 75% of the somatic ASEs overexpressed their
mutant alleles. The significantly up—regulated expression level of the
mutant alleles (Fisher exact test P—value < 2.2e—16, odds
ratio : 2.99) suggests the existence of widespread selective pressure
to produce more mutant proteins in tumors. Of the 25% somatic
ASEs, which underexpressed their mutant alleles, 73% lost the mu—
tant allele expression completely. This is possibly because potential
tumor suppressors are involved in suppressing the expression of
these somatic mutations.

By mapping somatic mutations to genes, we found that genes
with underexpressed mutant alleles are significantly enriched in
focal adhesion and ECM—receptor interaction pathways
(Supplementary Table S8). Abnormal behaviors of these two path—
ways have been reported to play important roles in cancer progres—
sion in many cancer types (Lu et al., 2012; Nagano et al., 2012;
Stewart et al., 2004), including colon cancer (Lascorz et al., 2011;
Peng et al., 2015). Our ASE study reveals detailed information about
how somatic mutations in these genes affect gene expression and
identifies possible therapeutic targets.

5 Discussion

In this work, we present a novel ﬂexible computational method,
cisASE, to detect ASE at the SNV, exon and gene levels. cisASE
makes full use of information from DNA—seq and RNA—seq data to
achieve an unbiased estimation of ASE. By default, cisASE adopts a
site—by—site adjustment for ASE identification by using the DNA al—
lele ratio. This procedure reduces the artifacts from technical and
mapping bias (Degner et al., 2009) and CNVs (Mayba et al., 2014),
making cisASE efficient for detecting putative cis—regulated ASEs. In
the absence of matched DNA—seq data, cisASE performed moder—
ately well. Additionally, the implementation of a pseudo—phasing
function in cisASE allows the incorporation of unphased SNV data
into an individual exon, gene or isoform.

To evaluate the performance of cisASE for ASE detection, we
performed extensive analyses based on both simulated and real data
from multiple resources, i.e. human and mouse colon tumor cell

9103 ‘09 isanV no so1e§uv soq 0211110111123 JO 101319101111 11; /310'S[BHmOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq 11101} pepeo1umoq

Applications of cisASE in RNA sequencing data

 

lines and a phased 1000 Genomes Project individual. cisASE outper—
formed the chi—square test in terms of accuracy, especially for genes
with low sequencing depth. Additionally, cisASE exhibits greatly
increased accuracy and computation speed compared with other
previous methods based on complex models.

By applying cisASE to a panel of paired tumor—normal human
colon samples, we identified HLA loci as the most significant
‘hotspot’ of germline ASEs in both tumor and normal samples. In
tumor samples, somatic ASE showed widespread overexpression of
mutant alleles, indicating oncogenic roles of the mutant genes.
These results confirmed the ability of cisASE to detect tumor—
associated ASEs.

Acknowledgements

The authors thank Mr. Jie Bi of Shanghai Institutes for Biological Sciences for
useful advice on web development and Dr. Guoqing Zhang of Shanghai
Center for Bioinformation Technology for managing the websites.

Funding

This work was supported by the National Basic Research Program of
China (2011CB910204, 2011CB510102 and 201003529200), the
National Key Scientiﬁc Instrument and Equipment Development Project of
China (2012YQ03026108), the National Key Technology Support Program
of China (2013BA1101B09) and the Strategic Priority Research Program of
the Chinese Academy of Sciences (XDAIZOOOOOO).

Conﬂict of Interest: none declared.

References

Browning,S.R. and Browning,B.L. (2007) Rapid and accurate haplotype phas—
ing and missing—data inference for whole—genome association studies by use
of localized haplotype clustering. Am. ]. Hum. Genet., 81, 1084—1097.

Castle,J.C. et al. (2014) Immunomic, genomic and transcriptomic character-
ization of CT26 colorectal carcinoma. BMC Genomics, 15, 190.

Cibulskis,K. et al. (2013) Sensitive detection of somatic point mutations in im—
pure and heterogeneous cancer samples. Nat. Biotechnol, 31, 213—219.

Degner,J.F. et al. (2009) Effect of read-mapping biases on detecting allele-
speciﬁc expression from RNA—sequencing data. Bioinformatics, 25,
3207—3212.

Ge,B. et al. (2009) Global patterns of cis variation in human cells revealed by
high—density allelic expression analysis. Nat. Genet., 41, 1216—1222.

Heap,G.A. et al. (2010) Genome—wide analysis of allelic expression imbalance
in human primary cells by high—throughput transcriptome resequencing.
Hum. Mol. Genet., 19,122—134.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method
for the next generation of genome-wide association studies. PLoS Genet., 5,
e1000529.

Huang,H.S. et al. (2012) Topoisomerase inhibitors unsilence the dormant al—
lele of Ube3a in neurons. Nature, 481, 185—189.

Lascorz,J. et al. (2011) Consensus pathways implicated in prognosis of colo—
rectal cancer identiﬁed through systematic enrichment analysis of gene ex—
pression proﬁling studies. PLoS One, 6, e1886 7.

Lee,R.D. et al. (2013) Large—scale proﬁling and identiﬁcation of potential
regulatory mechanisms for allelic gene expression in colorectal cancer cells.
Gene, 5 12, 16—22.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Liu,Z. et al. (2014) Comparing computational methods for identiﬁcation of
allele-speciﬁc expression based on next generation sequencing data. Genet.
Epidemiol, 38, 591—598.

Lu,P. et al. (2012) The extracellular matrix: a dynamic niche in cancer progres-
sion.]. Cell Biol., 196, 395—406.

Mayba,O. et al. (2014) MBASED: allele-speciﬁc expression detection in cancer
tissues and cell lines. Genome Biol., 15, 405.

Montgomery,S.B. et al. (2010) Transcriptome genetics using second gener-
ation sequencing in a Caucasian population. Nature, 464, 773—777.

Nagano,M. et al. (2012) Turnover of focal adhesions and cancer cell migra-
tion. Int. ]. Cell Biol., 2012, 310616.

Pandey,R.V. et al. (2013) Allelic imbalance metre (Allim), a new tool for meas—
uring allele-speciﬁc gene expression with RNA—seq data. Mol. Ecol.
Resour., 13, 740—745.

Parham,P. and Ohta,T. (1996) Population biology of antigen presentation by
MHC class I molecules. Science, 272, 67—74.

Pastinen,T. (2010) Genome—wide allele-speciﬁc analysis: insights into regula—
tory variation. Nat. Rev. Genet., 11, 533—538.

Peng,G. et al. (2015) Transcriptome proﬁling of the cancer and adjacent non—
tumor tissues from cervical squamous cell carcinoma patients by RNA
sequencing. Tumour Biol., 36, 3309—3317.

Rozowsky,J. et al. (2011) AlleleSeq: analysis of allele-speciﬁc expression and
binding in a network framework. Mol. Syst. Biol., 7, 522.

Seshagiri,S. et al. (2012) Recurrent R—spondin fusions in colon cancer. Nature,
488, 660—664.

Shiina,T. et al. (2009) The HLA genomic loci map: expression, interaction, di—
versity and disease]. Hum. Genet., 54, 15—39.

Shlien,A. and Malkin,D. (2009) Copy number variations and cancer. Genome
Med., 1, 62.

Skelly,D.A. et al. (2011) A powerful and ﬂexible statistical framework for test—
ing hypotheses of allele—speciﬁc gene expression from RNA—seq data.
Genome Res., 21, 1728—1737.

Smith,R.M. (2013) Whole transcriptome RNA-Seq allelic expression in
human brain. BMC Genomics, 14, 571.

Stewart,D.A. et al. (2004) Changes in extracellular matrix (ECM) and ECM-
associated proteins in the metastatic progression of prostate cancer. Reprod.
Biol. Endocrinol, 2, 2.

Tuch,B.B. et al. (2010) Tumor transcriptome sequencing reveals allelic expres-
sion imbalances associated with copy number alterations. PLoS One, 5,
e9317.

Yip,D. et al. (2000) Immunomodulation therapy in colorectal carcinoma.
Cancer Treat. Rev., 26, 169—190.

Zhang,K. et al. (2009) Digital RNA allelotyping reveals tissue—speciﬁc and
allele-speciﬁc gene expression in human. Nat. Methods, 6, 613—618.

9103 05 isanV uo so1e§uv 50'] 0211110111123 10 [(1151910qu 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq won pep201umoq

