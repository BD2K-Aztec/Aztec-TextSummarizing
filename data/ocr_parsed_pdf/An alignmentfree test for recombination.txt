BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

B.Haubold et al.

 

2.5

 

1.5 -

TMRCA

0.5 -

 

 

 

 

 

0 WW
0 20 40 60 80 100
Position (X 104)

Fig. 1. Simulated time to the most recent common ancestor (TMRCA)
and mutations (vertical lines) along a recombining stretch of DNA
sequence. TMRCA is proportional to the population size

GENECONV (Sawyer, 1989), our test is based on the detection
of polymorphism clustering. But instead of scoring single nucleo—
tide polymorphisms (SNPs), we record the lengths of exact
matches between pairs of sequences. To a ﬁrst approximation
this corresponds to the distances between SNPs. Recombination
leads to an increase in the ﬂuctuation of match lengths when
compared with no recombination. Because match lengths can
be looked up efﬁciently using modern string algorithms (Puglisi
et al., 2007), our test scans a pair of Escherichia coli genomes
totaling 10 Mb in only 8 s on a contemporary laptop.

In the following, we derive our test and demonstrate its sensi—
tivity and speciﬁcity through simulation. We also use simulations
to compare it with two published tests, Max—X2 and (DW. Finally,
we apply our test to 58 Ecoli genomes to search for horizontal
gene transfer.

2 METHODS

2.1 Derivation

Consider the query q = ATATC and the subject 3 = ACGTG. At every
position i in q we look for the shortest substring q[i. .1] that is absent from
s. We call this SHortest Unique subSTRING ‘shustring’ (Haubold et al.,
2005) at position i and denote its length by X,. For example, AT is the
shustring starting at the ﬁrst position in q, hence X1 = 2. Our approach is
built on the assumption that in pairs of homologous DNA sequences the
shustrings correspond to homologous matches and hence their lengths
represent distances to the next SNP. This assumption is reasonable for
closely related sequences such as those sampled from populations or
recently diverged species.

Conceptually, we identify shustrings using a sufﬁx tree of q and s
(Gusﬁeld, 1997). We say ‘conceptually’ because our actual implementa-
tion is based on an abstract version of a sufﬁx tree called ‘enhanced sufﬁx
array’ (Abouelhoda et al., 2002). Figure 2 shows the suffix tree of q and 3.
Each sufﬁx is represented by a path from the root to a leaf. For example,
q[1] is the leaf that corresponds to the sufﬁx starting at position 1 in q,
ATATC. Moreover, repeated preﬁxes are collapsed into single paths. For
example, the sufﬁxes q[5..5] = C and s[2..5] = CGTG share the preﬁx C,

 

.In
qATATC$
sACGTG$

 

 

 

 

 

 

 

 

 

 

 

 

.9111 r115] .9121 sis] sis] am r114] .9141

r111] r113]

Fig. 2. Sufﬁx tree of our example query and subject sequences 3 and q

which appears only once in the tree. The sentinel character 3% at the end of
q and s differs from every character in q and 3, even from itself. Its
addition ensures that a sufﬁx such as q[5..5] = C, which is a preﬁx of
the sufﬁx s[2..5] = CGTG, is also represented by a leaf in the tree.

To identify the shustring starting at, say, q[1], we visit leaf q[1], and
climb toward the root until we ﬁnd a node, n, with a subject leaf in the
subtree rooted on n. In our example, we carry out two climbing steps.
Then we extend the path label from the root to the node we have reached
by one character toward the starting leaf, to ﬁnd our ﬁrst shustring, AT.
In this way, we calculate the shustrings at every position in q.

Our test statistic is based on the lengths of shustrings, Xi. Without
recombination, and if sequences differ at a fraction 7'! of their sites,
every site i has probability 7'! of differing between q and 3, independently
of other sites. Using this model based on the inﬁnite sites model from
population genetics, we obtain for the average shustring length

1

ii:—
[i

— 1
X1 Ele = ElXi] =;-

Mb

1

Hence, 7'! can be estimated from unaligned sequences as the inverse of
the average shustring length (Haubold et al., 2011). Recall that recom-
bination leads to ﬂuctuations in the coalescence times along a sequence
and therefore to clustering of polymorphisms (Fig. 1). As a result, the
mean shustring length increases, which might be used as an indicator of
recombination (Haubold and Pfaffelhuber, 2012). Unfortunately, we
found that it was impossible to infer the expected average shustring
length without estimating TI to a precision attainable only with align-
ments. However, the empirical variance of shustring lengths is a more
promising statistic. Its expectation without recombination is

1 1 _ 1 _
s2 = 7 2 (X1 — 202, E1191 ~ g 2 EM,
[:1

where we can estimate 7'! from the average shustring length (Haubold and
Pfaffelhuber, 2012). E[sz] is then compared yvith the observed variance, 32,
to test the null hypothesis H0 : E[sz] = E[X]2. For this, we derived

Var(sz m 12—4: (1)
JT

and assumed that 32 is normally distributed with expectation X2
(Supplementary Material). This means that ca_n we use a one-sided test
for the normalized difference between 32 and X2
52 — i2
Dr 2 —_ , (2)
x/24 - X5 /l

which is approximately normally distributed with mean 0 and standard
deviation 1. We also deﬁne the ratio

32

F

as a rough measure of recombination.

Q:

 

3122

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

Test for recombination

 

2.2 Implementation

We implemented our test in the program rush, which stands
for ‘Recombination detection Using SHustrings’. The program rush
takes as input a query and a subject DNA sequence in FASTA format and
computes Q, Dr, and the corresponding P-value. Its sufﬁx tree construc-
tion is based on the deep-shallow algorithm and implementation by
Manzini and Ferragina (2002), which is one of the most efﬁcient string
indexing methods available (Puglisi et 0]., 2007).

2.3 Data

We downloaded complete genome sequences from GenBank for the 58
Ecoli strains listed in Supplementary Table S1. Because rush is
restricted to the analysis of sequences consisting solely of the nucleotide
designations {A, C, G, T}, all other characters were removed prior to the
analysis.

2.4 Simulations and computer programs

We generated samples of homologous DNA sequences using the coales-
cent simulation program ms (Hudson, 2002) in conjunction with ms2dna
available from http://guanine.evolbio.mpg.de/bioBox/

These simulations were conditioned on the population mutation
rate, 6, and the population recombination rate, 0. 6 = 2N0”, where NC
is the effective population size and p, is the mutation probability
per generation. Under the inﬁnite sites model, 6 is equal to the
expected number of pairwise mismatches, 71. Similarly, p = 2Ncc, where
c is the probability of recombination per generation. For more back-
ground on coalescent theory see the excellent introduction by Wakeley
(2009).

Max-X2 and (PW-values were computed using the program
Phi (Bruen et 0]., 2006). The distances between the Ecoli genomes
were computed using kr (Domazet-Loso and Haubold, 2009) and
the tree based on these distances was computed and drawn with
Phylip (Felsenstein, 2005) using neighbor joining and mindpoint
rooting.

3 RESULTS

3.1 Simulations

We explored the accuracy of the newly derived Equation (1)
through simulations. In Figure 3A, we varied sequence length.
The simulated values of Var(52) were always smaller than
Equation (1), but the two curves are close. Similarly, when vary—
ing 71' in Figure 3B, we found that Equation (1) is greater than the
simulated value, though not much. Notice also that as expected
from Equation (1), a 10—fold change in sequence length corres—
ponds to a 10—fold change in Var(52) (Fig. 3A), whereas a 10—fold
change in 71' corresponds to an enormous 105—fold change in
Var(52) (Fig. 3B).

This comparison between simulated and computed Var(52)
values suggests that our test is conservative. Accordingly,
we found that for the low rate of recombination of
,0/bp = 10’7 the null hypothesis of no recombination is rejected
at a = 0.05 with a frequency of only 0.032 rather than the
expected 0.05 (Fig. 4). However, with increasing recombination
the rejection rate grows to >0.99 until ,0 8 71'. When ,0 exceeds 71',
the rejection rate declines again, as our test statistic Dr is max—
imal if 71' B ,0. We also compared the rejection rate with Dr to
that with the homoplasy—based test statistic <I>w, which is
computed from four or more aligned sequences (Bruen et al.,

A .
2x100

 

Colmputcd 'Varw )' _..'_
Simulated Var(s2) 

2><106-
2x106 
1><106-

5X105-

 

 

 

 

0 100 - - - - - - I I
X 1 2 3 4 5 6 7 8 9 10
Sequence Length (X 105)

 

1016 _ I
Computed Var(.s2) _.._
Simulated Var(.s2) 

1014 -

1012 -

1010 -

108 -

106 -

 

 

 

 

104 . f .
10*4 10*“ 10*2

71'

Fig. 3. Comparing the observed variance of the variance in shustring
length, Var(sz), simulated without recombination to Var(sz) calculated
according to Equation (1) along the two dimensions of Var(sz), sequence
length (A) and genetic diversity, 7'! (B). Number of replicates: 104; in A
7'! 2 10*; in B sequence length 105

2006). Figure 4 shows that <I>w has a similar rejection curve as
Dr, with slightly less sensitivity at the simulated parameter
combination.

However, the sensitivity of Dr and <I>w depends on the number
of mismatches sampled. Figure 5 shows the rejection rate as a
function of sequence length at 7T 2 10’3 and a length—invariant
expected number of recombination events of 100. When sequence
length is 105, Dr and <I>w have little power, whereas 10 times
longer sequences yield rejection in 3 97% of cases, with <I>w mar—
ginally outperforming Dr.

It is reassuring that Dr is highly sensitive in the limit of long
sequences. This is equivalent to saying that Dr is sensitive when
applied to polymorphic sequences as long as IT is small. This
proviso follows from the assumption that shustrings are hom—
ologous. The greater 71', the more shustrings occur that are
generated by random non—homologous matches between query
and subject.

 

3123

ﬁm'spzumol‘pmjxo'sopeuuopuoiq/ﬁdnq

B.Haubold et al.

 

 

 

 

 

 

 

 

. . 1 1 Dr,
<1>w 
LO
Q
Q
ll
es
‘z'u'
'U
8
.8
§
:
.2
‘5
8
[L4
0 . . . . .
10’7 10’6 10’5 10’4 10’3 10’2 10’1

P/bp

Fig. 4. Dr has similar sensitivity as the alignment-based <I>w (Bruen et al.,
2006). The graph shows the fraction of hypothesis tests rejected
with signiﬁcance P 5 0.05 as a function of the rate of recombination,
0. Horizontal line: 0.05; Sequence length = 106, 7'! 2 10’3,
replicates = 104; sample size for (DH: 4

Traditional methods for detecting recombination such as Max—
X2 were designed for sequences no longer than a few kilobase. To
compare Dr with Max—X2, we used the simulation scheme by
Bruen et a]. (2006): for <I>w and Max—X2, we simulated samples
of 10 sequences with Q/bp = 0.01 and ,0 = 16. For 1 kb sequences,
<I>w was more sensitive than Max—X2, in agreement with Bruen
et a1. (2006) (Fig. 6). For Dr, we simulated pairs of sequences
with the same 6, and a ,0 value that resulted in the same expected
number of recombination events as in the sample of 10; that is, we
used ,0 = 16 x 2:1 1/i: 45.3 (Hudson and Kaplan, 1985). For
kilobase length sequences, Dr has little power (Fig. 6). However,
the power of all methods to detect recombination increases with
sequence length (Wiuf et al., 2001). For sequences of 100 kb or
more Dr is sensitive. Incidentally, this is the sequence length where
we stopped the Max—X2 simulations as they became too slow.

The <I>w statistic was developed as a fast alternative to methods
such as Max—X2. We, therefore, simulated sequence quartets of
lengths 1047107 bp and timed Phi given an alignment. The slope
of the resulting run time curve was 2.2, that is, doubling the
sequence length increases the run time 22‘2 = 4.6—fold. We com—
pared this with rush when applied to sequence pairs of the same
lengths. The slope of its run time curve is 1.2. This is still a bit
steeper than the optimal slope of 1, but means that with double
the input data rush takes 2.3 times longer. As a consequence,
Phi is eventually outperformed by rush for sequences longer
than 100 kb (Fig. 7).

Because Phi requires aligned sequences as input, we also
timed aligning sequence quartets with Mavid (Bray and
Pachter, 2004). Mavid is fast and the slope of its run time
curve is only 1.1, making it virtually optimal. Still, rush is
roughly 100 times faster than alignment—based Phi.

In our ﬁnal set of simulations, we investigated the potentially
confounding effects of codon data and changes in GC content,
and found that the rejection rate was unaffected by either
(Supplementary Figs. S1 and S2).

 

 

Fraction rejected at a = 0.05

 

 

 

 

1 i 3 21 5 6 i 5'; 1'9 10
Sequence Length (X 105)
Fig. 5. Rejection rate as a function of sequence length for Dr compared

with <I>w (Bruen et al., 2006); 71:10’3, p: 100 for entire region,
replicates = 104

 

Fraction rejected at a : 0.05

 

 

 

 

0 I I I

103 104 105 106 107
Sequence Length (hp)

Fig. 6. Comparing rejection frequencies between <I>,.,, Max-X2 and Dr as a

function of the length of the input sequences. The simulation parameters
are described in the text

3.2 Horizontal gene transfer in E.coli

Having established the accuracy and robustness of rush
through simulations, we applied it to the 58 fully
sequenced Ecoli genomes available from GenBank at the
time of writing (Supplementary Table S1). Figure 8 shows a
cluster diagram of the strains computed from their complete
genomes.

The 58 X 57 = 3306 pairwise recombination tests between the
58 Ecoli strains took rush 15 h, 9 min and 15 s on an Intel Xeon
2.40 GHz CPU, an average of 16.5 5 per test. In all, 97% of these
tests were rejected with significance P g 0.05, indicating that the
model assumption of uniformly distributed mutations is usually
violated across whole bacterial genomes. Figure 9 shows the dis—
tribution of the 3306 values of our recombination measure Q;

 

3124

ﬁm'spzumol‘pmjxo'sopeuuopuoiq/ﬁdnq

Test for recombination

 

 

   
   
   

 

 

 

Mavid+P11i _._
1000 - “82;? i:ii:.::::
rush .. 
Optimal -~-».»... 
100 . 
ﬂ
@ 10 . 
d.) 11/
e f,
1-‘
1 3
0.1
0.01 s x - . .
104 105 106 107

Sequence Length (bp)

Fig. 7. Comparing the run times of Phi and rush as a function of
sequence length. Q/bp = 0.01, p = 1000

its median is 2.951 with a huge range of 0587740939. We
focused on the two strains with the largest Q, K011 versus
K12_MG1655, which are marked by arrows in the cluster dia—
gram (Fig. 8).

To search for evidence of horizontal gene transfer, we looked
for regions in the K011 genome that were more closely related to
K12_MG1655 than to its closest relative. The cluster diagram
(Fig. 8) indicates that the closest relative of K011 is K01 1FL.
However, this is an artifact of the clutering algorithm, which
guarantees ﬁnding the correct tree only for distances that actu—
ally ﬁt a tree. Empirical distances are often not strictly tree—like,
especially in the presence of recombination. When we look up the
raw pairwise distances, we ﬁnd that the distance between K011
and KOllFL is 2.1 x 105, whereas that between K011 and
W1 or W2 is below the sensitivity of kr, the program we used for
estimating the substitution rates between genomes (Domazet—
Loso and Haubold, 2009). Hence, we took W1 as the closest
relative of K011. Figure 10 shows that at position 4.4 Mb,
K011 contains large fragments more similar to K12_MG1655
than to W1. The longest of these spans 102 kb and is located at
4385 8664487 685. When blasting this region against W1, the
best hit is 46.9 kb long and contains 367 mismatches and 13 gaps.
In contrast, the best hit in K12_MG1655 is 78.6 kb long withjust
8 mismatches and 1 gap. The next best hit in K12_MG1655 is
23.5 kb long with 4 mismatches and 0 gaps. This is strong evi—
dence for horizontal gene transfer. It looks as if it affected a
common ancestor of K011 and KOllFL because in KOllFL
the 102kb query generates two top hits, one 68.2kb long, the
other 33.5 kb with just 2 mismatches and 0 gaps.

4 DISCUSSION

To make the most of genomic sequences, we would ideally use
software that allows us to query them interactively. Our fast
alignment—free test of recombination is intended as a step
toward this goal. The program rush achieves its speed by
using similar string—indexing techniques as applied in the
genome—aligner MUMmer (Kurtz et al., 2004). The central feature

 

 

 

0127 H6 E2
SE15

NA114

 

 

UMN026
1: 042

 

 

 

 

 

0157 H7 Sa

0157 H7 EC

0157 H7 TW
XuzhouZl

055 H7 CB9
055 H7 RM]

 

 

Fig. 8. Midpoint-rooted neighbor joining tree of 58 Ecoli strains. The
two genomes with the highest recombination measure Q, K12_MG1655
and K011, are indicated by arrows

of this approach to sequence analysis is that it is ‘optimal’ in the
sense that in theory it runs in time linear in the length of the
sequences analyzed. In practice, programs based on modern
string—indexing techniques are fast and memory efficient
(Puglisi et al., 2007). We have been interested for some time
now in bringing the power of these algorithms to biology by
combining them with modeling the distribution of shortest
unique substrings (shustrings), which we take as proxy for the
distribution of the distances to the next polymorphism
(Domazet—Loso and Haubold, 2009, 2011; Haubold et al.,
2005, 2009;). In particular, in our previous derivation of an align—
ment—free estimator of genetic diversity we noted that the mean
shustring length is sensitive to recombination (Haubold and
Pfaffelhuber, 2012).

Here, we have used the test statistic Dr defined in Equation (2),
which is based on the variance of the shustring length.
Speciﬁcally, we compared its observed value, 52, with its expect—
ation, X2. We tested the null hypothesis that Dr 2 0 by deriving
Var(52) and constructing a parametric hypothesis test. This con—
trasts with the approach taken by the authors of Phi, our main
point of reference: They test the null hypothesis of no recombin—
ation using a permutation test (Bruen et al., 2006). This was not
an option for us because generating the null distribution of

 

3125

ﬁm'spzumol‘pmjxo'sopeuuopuoiq/ﬁdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

Test for recombination

 

Conﬂict of Interest: none declared.

REFERENCES

Abouelhoda,M. et al. (2002) The enhanced sufﬁx array and its applications to
genome analysis. In: Proceedings of the Second Workshop on Algorithms in
Bioinﬁ)rmatics. Lecture Notes in Computer Science 2452, Springer—Verlag,
pp. 449463.

Baquero,F. (2004) From pieces to patterns: evolutionary engineering in bacterial
pathogens. Nat. Revi. Microbiol, 2, 5107518.

Bray,N. and Pachter,L. (2004) MAVID: constrained ancestral alignment of multiple
sequences. Genome Res., 14, 693499.

Bruen,T.C. et al. (2006) A simple and robust statistical test for detecting the pres—
ence of recombination. Genetics, 172, 266572681.

Darling,A.C.E. et al. (2004) Mauve: multiple alignment of conserved genomic
sequence with rearrangement. Genome Res., 14, 13944403.

Didelot,X. et al. (2010) Inference of homologous recombination in bacteria using
whole genome sequences. Genetics, 186, 143571449.

Domazet—Lo§o,M. and Haubold,B. (2009) Efﬁcient estimation of pairwise distances
between genomes. Bioinformatics, 25, 322173227.

Domazet—Lo§o,M. and Haubold,B. (2011) Alignment—free detection of local simi—
larity among viral and bacterial genomes. Bioinformatics, 27, 146G1472.

Felsenstein,J. (1974) The evolutionary advantage of recombination. Genetics, 78,
7377756.

Felsenstein,J. (2005) PHYLIP (phylogeny interference package) version 3.6.

Fisher,R.A. (1930/1999) The Genetical Theory of Natural Selection. Variorum edn.
Oxford University Press, Oxford.

Gusﬁeld,D. (1997) Algorithms on Strings, Trees, and Sequences: Computer Science
and Computational Biology. Cambridge University Press, Cambridge.

Haubold,B. and Pfaffelhuber,P. (2012) Alignment—free population genomics: an
efﬁcient estimator of sequence diversity. Genes Genomes Genet., 2, 8837889.

Haubold,B. et al. (2009) Estimating mutation distances from unaligned genomes.
J. Comput. Biol., 16, 148771500.

Haubold,B. et al. (2005) Genome comparison without alignment using shortest
unique substrings. BMC Bioinformatics, 6, 123.

Haubold,B. et al. (2011) Alignment—free estimation of nucleotide diversity.
Bioinﬁ)rmatics, 27, 449455.

Hudson,R.R. (1985) The sampling distribution of linkage disequilibrium under an
inﬁnite allele model without selection. Genetics, 109, 6117631.

Hudson,R.R. (2002) Generating samples under a Wright—Fisher neutral model of
genetic variation. Bioinformatics, 18, 3377338.

Hudson,R.R. and Kaplan,N.L. (1985) Statistical properties of the number of
recombination events in the history of a sample of DNA sequences. Genetics,
111, 1477164.

Kurtz,S. et al. (2004) Versatile and open software for comparing large genomes.
Genome Biol., 5, R12.

Manzini,G. and Ferragina,P. (2002) Engineering a lightweight sufﬁx array
construction algorithm. In: ESA'02: Proceedings of the 10th Annual European
Symposium on Algorithms. Springer—Verlag, London, pp. 6987710.

Maynard Smith,J. (1992) Analysing the mosaic structure of genes. J. Mol. Evol., 34,
12(r129.

Muller,H.J. (1932) Some genetic aspects of sex. Am. Nat., 66, 1187138.

Muller,H.J. (1964) The relation of recombination to mutational advance. Mutat.
Res., 1, 279.

Ohta,K. et al. (1991) Genetic improvement of Escherichia coli for ethanol produc—
tion: chromosomal integration of zymomonas mobilis genes encoding pyruvate
decarboxylase and alcohol dehydrogenase II. Appl. Environ. Microbiol, 57,
8937900.

Otto,S.P. (2007) Unravelling the evolutionary advantage of sex: a
commentary on ‘Mutation—selection balance and the evolutionary advantage
of sex and recombination” by Brian Charlesworth. Genet. Res. Caml7., 89,
447449.

Otto,S.P. and Lenormand,T. (2002) Resolving the paradox of sex and recombin—
ation. Nat. Rev. Genet., 3, 2527261.

Posada,D. (2002) Evaluation of methods for detecting recombination from DNA
sequences: empirical data. Mol. Biol. Evol., 19, 7087717.

Puglisi,S.J. et al. (2007) A taxonomy of sufﬁx array construction algorithms. ACM
Comput. Surv., 39, 4.

Sawyer,S.A. (1989) Statistical tests for detecting gene conversion. Mol. Biol. Evol., 6,
52(r538.

Turner,P.C. et al. (2012) Optical mapping and sequencing of the Escherichia coli
K01] genome reveal extensive chromosomal rearrangements, and multiple
tandem copies of the Zymomonas mobilis pdc and ath genes. J. Ind.
Microbiol. Biotechnol., 39, 629439.

Wakeley,J. (2009) Coalescent Theory: An Introdiwtion. Roberts & Company,
Colorado.

Wiuf,C. et al. (2001) A simulation study of the reliability of recombinaiton detection
methods. Mol. Biol. Evol., l8, 192%1939.

 

3127

ﬁm'spzumol‘pmjxo'sopeuuopuotq/pdnq

