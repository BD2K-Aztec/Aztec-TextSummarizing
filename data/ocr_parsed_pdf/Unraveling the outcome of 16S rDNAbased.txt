BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

15 species
in vitro mock damsets
(Mock-I & Mock-II)

   
 

Abundance &
properties of
chimeras

Relatch

abundance
of species

 
   
 

 

ore Human
Oral
M icm

 
 
     

 

Pre

Clustering with Clustering with
Algorithm 1 Algorithm ll

 

 

/810'SIBum0[pJOJXO'sopELuJOJuioiq”:duq

A.May et al.

 

were evaluated based on the set of high-conﬁdence chimeras identiﬁed by
SEQERR.

2.2.3 Error analysis (in vitro reads ) Error rates were calculated
using the non-chimeric reads only. To determine the reference sequences
of these reads and their relative abundance, chimeras detected by
SEQERR were removed from the datasets and the remaining reads (pri-
mers removed) were queried against the set of reference sequences using
BLASTN (Altschul et al., 1990, 1997) with a minimum similarity thresh-
old of 80%. Reads that were mapped to a reference with a unique top
score were then globally aligned to their parents using the needle program
in EMBOSS v6.5.7 (Rice et al., 2000). Global alignments were truncated
to discard the end gaps. The error rate per base for insertions, deletions,
substitutions and ambiguous base calls was normalized by dividing the
number of occurrences of each error type by the sum of truncated (pair-
wise) alignment lengths of all reads. The overall error rate per base for
mismatches was calculated as the sum of error rate per base for each error

type.

2.3 Simulations

First, the Mock-I-sim dataset was generated to replicate the in vitro
Mock-I dataset as closely as possible. After establishing the in silico re-
producibility of the in vitro data properties, two groups of composition-
ally more complex datasets, collectively referred to as CORE-sim, were
simulated. Below, we ﬁrst detail the methods shared by Mock-I-sim and
CORE-sim simulations and then describe these individually.

2.3 .1 In silico dataset generation Grinder v0.5.3 (Angly et al., 2012)
was used to simulate the PCR ampliﬁcation of full-length (V57V7) non-
chimeric amplicons based on a given total read count and a relative
abundance proﬁle for the reference sequences. The percentage of non-
erroneous reads in Mock-I after quality ﬁltering, which was 66% of non-
chimeric reads, was approximated by merging two Grinder-produced
datasets: a dataset of amplicons with uniformly distributed substitution
errors and another dataset with non-erroneous amplicons (6.2 and 93.8%
of Grinder reads, respectively). Further errors were subsequently intro-
duced by 454Sim as described below. Chimeras that constitute 14.5% of
all reads in the datasets, in the form of bimeras, trimeras and quadmeras,
were generated using CHSIM (Edgar et al., 2011), based on a slightly
modiﬁed n-mera state distribution (bi:81%, tri:18.7% and quad: 0.3%)
reported in Quince et a]. (2011). The relative abundance of chimeras for
each top-parent similarity interval between 89 and 99% was modeled to
have a linear increase from 0.05 to 0.15 (e.g. 5% of all chimeras were
89790% similar to their top-parents). The relative abundance of a given
parent (reference) sequence in the CHSIM input was assigned the same as
that in the Grinder-generated amplicons. Next, Grinder and CHSIM
reads were used as input for 454Sim v1.04 (Lysholm et al., 2011) to
generate the corresponding ﬂowgrams, which included further insertion
and deletion errors. The 454Sim parameters that control the read lengths,
homopolymer model for positive ﬂows, and degeneration of positive
and negative ﬂows, were manually tuned to obtain a comparable length
distribution and error rates to those of the Mock-I dataset.

2.3.2 Mock—I—sim: simulation of 15—species mock dataset The ref-
erence sequences of in vitro mock species and their relative abundances
found in Mock-I were used in Grinder to simulate 34172 full-length and
non-chimeric amplicons, of which 32047 (93.8%) did not contain any
errors, while the remainder contained 0.72% substitution errors on aver-
age. In accordance with the abundance of chimeric sequences detected by
SEQERR in Mock-I, 5786 chimeras were simulated using CHSIM.
Finally, a FASTA ﬁle of 39 958 reads was processed with 454Sim to
obtain ﬂowgrams. To analyze the errors, reads were quality-ﬁltered/
demultiplexed in QIIME by removing primers (‘truncate_remove’
option) and true chimeras, known by their read labels, were discarded.

The remaining non-chimeric reads were aligned to the reference sequences
from which they were generated by the needle program, and error rates
were calculated as described above for in vitro datasets (Section 2.2).
In addition, to investigate the inﬂuence of the pre-processing order, the
putative chimeras were identified by UCHIME (Section 2.2), without or
with denoising the reads using denoiser (Reeder and Knight, 2010). For
both treatments, the performance of UCHIME was calculated based on
the set of simulated chimeras that remained after quality filtering.

2.3.3 Complex mock dataset simulations (CORE—sim) CORE
v2012-02-09 (Griffen et al., 2011), an oral microbiome database of 1159
phylogenetically curated 16S rDNA sequences, was ampliﬁed in silico
using TaxMan (Brandt et al., 2012) with the 785F and 1175R primers
(no mismatches allowed). Sequences containing ambiguous bases or more
than one unique taxonomic lineage in their headers were discarded. The
thus filtered CORE database (COREI) contained 672 amplicons from
447 taxonomic lineages (447 species; 139 genera). Next, we constructed
a second database in which each taxonomic lineage contained only one
amplicon, and then used alignments constructed by the needle program
(Rice et al., 2000) to remove all amplicons that had (based on the shorter
sequence) 297% similarity to any other sequence. This second database
(COREZ) contained 292 sequences from 292 taxonomic lineages (292
species; 126 genera). When present, the subspecies part of a lineage
label (starting with ‘subsp.’) was removed (for CORE 1 and COREZ).

Simulations For each database (COREI and COREZ), 50 composition-
ally different datasets were generated. To obtain ~200 OTUs for each
dataset at a 97% similarity threshold, 250 (COREI) or 200 (COREZ)
reference sequences were randomly drawn from their respective data-
bases. For each dataset, ~40 000 reads were simulated, as for Mock-I-
sim (see Section 2.3.2). However, in this case, the relative abundances of
the sequences were randomly assigned using a powerlaw distribution with
parameter 0.4 (Grinder). Reads were quality ﬁltered (QIIME) using the
following options: reverse primer removal: ‘truncate_only’; minimum
sequence length: 150; ambiguous bases: 0; maximum homopolymer
run: 6nt; one forward and two reverse primer mismatches; a minimum
quality score of 25; sliding window: 50; and zero barcode errors. Next, the
reads were pre-processed in five different ways: no cleaning (NC),
denoised (D), chimera checked (CC), denoised and chimera checked
(DCC) and chimera checked and denoised (CCD).

Clustering After each pre-processing approach, the remaining reads
were clustered at a 97% similarity threshold with 11 different clustering
algorithms with their default parameters: CD-HIT v3.1.1 (Li and Godzik,
2006), DNACLUST parallel release 2 (option: -1) (Ghodsi et al., 2011),
ESPRIT-Tree 64-bit v11152011 (Cai and Sun, 2011), UCLUST v1.2.22q
(Edgar, 2010), USEARCH v6.1.544 (Edgar, 2010), CLUSTOM v0.10
(Hwang et al., 2013), TBC version January 31, 2011 (Lee et al., 2012),
CROP v1.33 (options: -e 4400 -s -m 20 -z 400 -r 2 -b int[#uniq sequences/
50+0.5]) (Hao et al., 2011), M-pick (-f 1) (Wang et al., 2013), swarm
v1.2.2 (-d 11; https://github.com/torognes/swarm) and CRUNCHCLUST
v43 (-strict -min 0 -max 1000 -keep_n -diff 11 -d_hl -noendgaps)
(Hartmann et al., 2012). USEARCH was also evaluated with options
‘maxaccepts’ and ‘maxrejects’ set to zero (referred to as USEARCH
Optimal). Before clustering with USEARCH and swarm, the reads
were dereplicated, sorted by abundance and sequence length. In the
case of M-pick, the reads were dereplicated and randomly shufﬂed to
avoid crashes during clustering. To improve its memory usage, some
code changes that do not inﬂuence the clustering output were made
in the M-pick package (see the patch ﬁle at http://www.ibi.vu.nl/
downloads).

To obtain ground truths for the clustering algorithms, non-erroneous
datasets (50 for CORE 1 and 50 for COREZ) were generated, which con-
tained only the complete V57V7 reference sequences of non-chimeric
reads (primers removed). These non-chimeric and non-erroneous reads
were clustered using each algorithm to obtain the ‘reference clusterings’.
For evaluating the clustering results of COREZ simulations, the reference

 

1532

ﬁm'spzumol‘pmﬂo'sopeuuopnorq/ﬁdnq

Lactobacillu.‘ casei

Variant difference

U]
._r
N

Primer
degenerate
position

ox
4;

{I}
"U
as
a.)
H
«H
0')
$18
,5
§
pl
Z

m
N

Amplicop length

— - Reads mapped
Insertion
Deletion

— Substitution
Ambiguous

Primer
degerenate
positions

Ref. GGATTAGATACCCTCGTAGTC . . . GTGGT . . . GAGGAAGG'I‘GGGGATGACGT

 

/3.10's112um0fp10}x0"sorwuuoiurorqﬂ:duq

A.May et al.

 

Table 1. Properties of the in vitro and in silica datasets

 

 

Datasets Number of reads Number of chimeras Non-erroneous reads (%) Insertion Deletion Substitution Ambiguous Total
Mock-I“ 39 557 5729 66 0.059 0.041 0.043 0.0041 0.14
Mock-1’3 39 557 5401 66 0.064 0.046 0.071 0.0041 0.18
Mock-II“ 37 932 6669 74 0.049 0.026 0.048 0.0022 0.12
Mock-[1’3 37 932 6277 73 0.051 0.028 0.077 0.0022 0.16
Mock-I-sim“ 39 600 5753 65 0.056 0.040 0.045 5.30E-06 0.14
Mock-I-sim’g 39 600 5535 65 0.059 0.042 0.058 5.60E-06 0.16
Mock-I-sim” 39 600 5761 65 0.056 0.040 0.043 5.40E-06 0.14

 

The number of raw reads and chimeras identiﬁed by SEQERR and UCHIME after quality ﬁltering (on primers and bar—code errors only), respectively, are shown (Mock—I,
Mock—II and Mock—I—sim), along with the number of chimeras generated by CHSIM (Mock—I—sim). The error rates per base (%) after the removal of chimeras by different

methods are listed. or, chimera removal by SEQERR; ,8, chimera removal by UCHIME; y, chimera removal based on CHSIM read labels.

Table 2. The sensitivity of UCHIME in de nava mode and the reference-based mode, and their union is shown for the Mock-I-sim

dataset

 

Chimera checking mode

UCHIME’s sensitivity for different top-parent similarity intervals

 

 

[89792)% [92795)% [95798)% [98799)%
De nava CC 0.64 0.63 0.69 0.61
Reference CC 0.93 0.98 0.95 0.69
Union CC 0.97 0.99 0.98 0.82
De nava DCC 1.00 0.98 0.32 0.01
Reference DCC 0.97 0.96 0.31 0.01
Union DCC 1.00 0.98 0.32 0.01

 

A given percentage interval describes the sequence similarity of chimeras in that group to their parents. CC, chimera checked; DCC, denoised and

chimera checked.

(Supplementary Table S1). We note that achieving such resem—
blance between Mock—I and Mock—I—sim datasets was possible
only after extensive re—parameterization of Grinder, CHSIM
and 454Sim packages and adjustments in several parts of the
simulation pipeline.

To determine the effects of the order of the pre—processing
steps, chimera checking was performed separately on denoised
and non—denoised datasets, using the de novo and reference—based
modes of UCHIME. The latter mode outperformed the ﬁrst in
terms of sensitivity, an outcome that was more pronounced on
non—denoised sequences (Table 2). Taking the union set of chi—
meras detected by the two modes resulted in an improved sensi—
tivity in chimera detection and did not inﬂate the number of
false—positive chimeras.

When the reads were denoised prior to chimera checking, the
majority of chimeric sequences with high similarity to their par—
ents were altered by denoising. These reads with altered se—
quences were not detected as chimeras by UCHIME, resulting
in a >40% decrease in UCHIME’s sensitivity with respect to the
original read labels (Table 2, DCC approach). However, these
denoised chimeras did not inﬂate the diversity estimation, as
clustering the reads using UCLUST did not yield any unexpected
OTUs. Indeed, chimeric sequences with high parent similarity are
likely to be denoised to a non—chimeric state.

3.2.2 C ORE—sim simulations Having been able to replicate the
in vitro Mock—I dataset in considerable detail, we extended the
simulations to generate datasets of more realistic diversity. To
obtain two reference databases of different compositional prop—
erties, COREI and CORE; were derived from the CORE oral
microbiome database (see Section 2.3.3). COREI contained
amplicons that are >97% similar to each other, as well as differ—
ent amplicons from the same taxonomic lineage. To probe the
limitations of a database with such properties, the CORE; data—
base was constructed, where the reference sequences were <97%
similar to each other and had unique taxonomic lineages. Using
each database, 50 representative datasets of ~40 000 amplicons
were simulated from randomly selected reference sequences. To
assess the taxonomy analysis pipeline, each dataset was pre—pro—
cessed in ﬁve different ways: no cleaning (NC), denoised (D),
chimera checked (CC), denoised and chimera checked (DCC)
and chimera checked and denoised (CCD). The resulting reads
were clustered separately by 11 clustering algorithms at a 97%
similarity threshold. CRUNCHLUST and swarm do not use
percentage similarity, but Levenshtein distance. We set this par—
ameter to 11 based on the average read length (368 nt) and 3%
divergence. The clusters were evaluated by calculating the NMI
score and the number of OTUs. For each simulated dataset, a
non—erroneous dataset was created by discarding chimeric reads

 

1534

ﬁre'spzumol‘pmﬂo'sopauuowrorq/ﬁdnq

168 rDNA-based taxonomy analysis through mock data and simulations

 

and replacing the erroneous reads with the non—erroneous refer—
ence amplicon sequences from which they originated.
These datasets were used to obtain reference clusterings for
each clustering algorithm. Additionally, we set the number of
expected OTUs to 200 for CORE; simulations because the se—
quences in CORE; are <97% similar to each other.

The distinctive compositions of COREl and CORE; databases
are reﬂected in the clustering results. In simulations performed
using the CORE database, OTUs formed by clustering the non—
erroneous (reference) datasets resulted in species—level NMI
scores between 0.93 and 0.97 (Fig. 3A). This outcome is expected
when amplicons from different taxonomic lineages that are
397% similar to each other cluster together. In contrast, the
average NMI score per clustering algorithm for non—erroneous
datasets in CORE; simulations ranged between 0.98 and 1.00
(Fig. 3B), indicating that almost all reads were correctly clustered
when reads with different taxonomic labels were <97% similar to
each other. Likewise, for all CORE; datasets, a given clustering
algorithm produced more consistent numbers of OTUs than in
COREl datasets. The variance in the number of OTUs formed
by the clustering algorithms for the reference datasets also shows
the difference between these databases (Fig. 3E and F).

At species level (Fig. 3A and B), clustering algorithms expect—
edly yielded higher NMI scores when clustering the non—
erroneous datasets than the pre—processed datasets. At genus
level, however, denoising followed by chimera checking (CCD),
as well as chimera checking followed by denoising (DCC) re—
sulted in NMI scores higher than reference clusterings (Fig. 3C
and D). This was found to be a consequence of denoising, where
sequences of different species of the same genus, which were not
assigned to the same cluster at a 97% similarity threshold in
reference clusterings, were clustered together in the case of the
DCC and CCD approaches. Correspondingly, the number of
OTUs formed by sequences of the same genus in the reference
clusterings was higher than the number of OTUs formed by the
DCC and CCD approaches. This also explains why all clustering
algorithms (applied after DCC or CCD) underestimate the
number of expected OTUs: denoising decreases the divergence
of very similar sequences (Fig. 3E and F). When the average
number of OTUs for the 50 COREZ simulations (per algorithm)
after the CCD pre—processing approach is considered, the largest
diversity underestimation with respect to the number of expected
OTUs (200) was observed with CROP (13.6%), whereas
DNACLUST, USEARCH, USEARCH Optimal and swarm
provided the smallest underestimation (3.4%). When the same
comparison is performed between the average number of OTUs
obtained in the reference clusterings and after the CCD ap—
proach, CLUSTOM yielded the largest overestimation (4.2%),
whereas CRUNCHCLUST resulted in the smallest underestima—
tion (1.7%), suggesting that CRUNCHCLUST is rather robust
against the remaining noise. CROP resulted in a 2.9% overesti—
mation of the number of OTUs obtained in the reference clus—
tering (173 versus 168 OTUs). The run times of the clustering
algorithms are given in Supplementary Table S2.

The NC approach resulted in the lowest NMI scores along
with diversity overestimations as high as 20—fold (Fig. 3E and
F), conﬁrming earlier clusterings (Bonder et al., 2012). Chimera
checking or denoising alone was insufﬁcient to obtain accurate
clustering. The removal of chimeras was the most important step

because the clustering accuracy deteriorated far more by the pres—
ence of low—parent similarity chimeras (D) than by the occurrence
of erroneous reads (CC). The low error rate in the NC sequences
and successful chimera removal by UCHIME gave rise to high
NMI scores in the CC approach. This is especially salient in
CORE; simulations, where achieving a good agreement with
ground truth labels is more likely because reference sequences in
these simulations were at least 3% distant from each other,
making inaccurate clustering due to sequence errors less probable.

The best agreement with the number of OTUs formed in
reference clusterings was obtained by the DCC and CCD
approaches. Although hardly any difference was observed in
the number of OTUs formed between the two approaches, the
clusters formed using the latter approach showed consistently
higher NMI scores. This was due to a large portion (~10%) of
undetected chimeras in the DCC approach: denoising not only
converted the chimeras into non—chimeric sequences but also re—
sulted in disagreements between the non—detected chimeras and
their taxonomic labels. We observed the same denoising effect
for undetected chimeras in the CCD approach; however, because
their number was substantially lower (~10—fold), the NMI score
was not affected.

The differences (NMI scores and number of OTUs) between
the various clustering algorithms became less pronounced when
they were applied after denoising (D, DCC, CCD). Four excep—
tions here were CLUSTOM, CRUNCHCLUST, CROP and
M—pick, which in both COREl and CORE; simulations resulted
in slightly lower species—level NMI scores than other algorithms,
whereas at genus level they achieved slightly higher NMI scores.
Along with these, the relatively small number of OTUs formed
by CLUSTOM and CROP, especially for NC datasets, is indi—
cative of over—clustering, which in this case occurs when
sequences from two species of the same genus with <97% simi—
larity are assigned to the same cluster. In contrast, clustering by
ESPRIT—Tree and TBC resulted in consistently higher species—
and genus—level NMI scores after NC and CC approaches, as
well as good estimations of the reference number of OTUs after
the DCC and CCD approaches.

4 DISCUSSION

Pre—processing and clustering are two major steps in the analysis
of pyrosequenced 16S rDNA amplicons, which have a dramatic
inﬂuence on the accuracy of downstream efforts such as diversity
estimation. In this study, we aimed to improve our understand—
ing of how these methods transform the sequencing datasets
into community profiles. To this end, we analyzed data from
two pyrosequencing runs that were performed for a 15—species
mock microbial community. Data properties derived from these
analyses were adapted in computer simulations to overcome the
main shortcoming of in vitro studies, namely, the absence of
ground truth. Error rates, error distributions, read length distri—
butions, and percentage of chimeras are good examples of basic
data features that can be incorporated in silico. To the best of our
knowledge, this is the first study where such characteristics of a
given pyrosequencing dataset are replicated with high precision
in the raw experimental output (ﬂowgrams). This, for example,
resulted in similar chimera detection sensitivity for in vitro Mock—
I and in silico Mock—I—sim data.

 

ﬁre'spzumol‘pmjxo'sopauuowrorq/ﬁdnq

A.May et al.

 

l\ 1.00-

0.95-

0.90-

NMI (species)

0.85-

0.80-

0.75-

C 1.00-

0.95-

0.90-

NMI (genus)

0.85-

0.80-

0.75 —
E 4000 —
3600 —
3200 —
2800 —
2400 —
2000 -

1600-

Number of OTUs

1200-

400 -
300 -
200 -
100 -

0 _

 

mmmmm—N

species level

 

 

Reference

—wamr~wu~g:g

NC

CC

DCC

CCD

NMI (species)

genus level

 

 

 

OTUs

 

Reference NC D CC DCC CCD
i
‘ e 2%“! .13 ;
m-I-‘ﬁé-r- * '1' WWI};
Reference? NC D co DCC CCD

D 1.00-

NMI (genus)

F 4000 —

Number of OTUs

1.00-

0.95-

0.90-

0.85-

0.80-

0.75-

0.95-

0.90-

0.85-

0.80-

0.75-

3600-
3200-
2800-
2400-
2000-
1600-
600-
500-
400-
300-
200-

100'
0-

 

 

—mwmr~¢w>o—N

 

Reference NC D CC DCC CCD

 

 

  

 

Reference NC D CC DCC CCD
ii 
'5 0.
11'
ti
. a
g .
i
4 !
‘Jﬁé .
e *i
_._.,. WW.
Reference NC D co DCC CCD

Fig. 3. Clustering results after each pre-processing approach. Species- and genus-level NMI scores and the number of OTUs formed by each algorithm
after each pre-processing are shown for the 50 CORE] (A, C, E) and 50 COREZ (B, D, F) simulations. Reference, reference clustering of non-chimeric
and non-erroneous reads; NC, no cleaning; D, denoised; CC, chimera checked; DCC, denoised and chimera checked; CCD, chimera checked and
denoised. The order of the clustering algorithms in all pre-processing blocks is as follows: (1) CD-HIT, (2) DNACLUST, (3) ESPRIT-Tree, (4)
UCLUST, (5) USEARCH, (6) USEARCH Optimal, (7) CLUSTOM, (8) TBC, (9) swarm, (10) CRUNCHCLUST, (11) CROP and (12) M-pick

 

ﬁre'spumol‘pmyo'sopeuuowrorq/ﬁdnq

168 rDNA-based taxonomy analysis through mock data and simulations

 

The sequencing error rate (0.14%) in our in vitro and simu—
lated datasets is low compared with other reported values, such
as 1.07% (Gilles et al., 2011) or 0.61% (Schloss et al., 2011). This
may appear to be limiting the resolution at which the perform—
ance of different clustering algorithms can be compared for the
pre—processing approaches that include denoising. Other than
CLUSTOM and CROP, there was no prominent difference
between the outcomes of different algorithms in the DCC and
CCD approaches, and they all yielded underestimations of
the expected number of OTUs [minimum (min): 3.4% with
CCD—swarm; maximum (max): 13.7% with DCC—CROP for
COREZ, averaged over all 50 simulations]. Highly erroneous
CORE; simulations with a 6—fold higher error rate (0.86%) did
not help differentiate between clustering methods when denoising
was applied either (results not shown). In this case, all methods
excluding CLUSTOM, CRUNCHCLUST and CROP yielded a
small (min: 0.7% DCC—TBC; max: 5.8% CCD—USEACH), but
significant, overestimation of the expected number of OTUs
(200) instead of an underestimation (M—pick could not be
included due to its large memory requirement). These findings
suggest that studies where accurate estimations of the sample
complexity is of crucial importance should include a thorough
analysis to appropriately adjust the sequence/ﬂowgram similarity
thresholds used for denoising, preferably with the guidance of an
experimental mock dataset, to avoid over— or underestimations.
This is supported by an earlier study (Gaspar and Thomas,
2013), which thoroughly examined the spectrum of changes
caused by a variety of pyrosequencing noise—removal tools. The
authors report that some of these changes were inconsistent with
removing noise and could potentially lead to undesired outcomes
such as removing rare variants. Similarly, Bakker et al. (2012)
provide a discussion on the effects of subsampling and error
correction, where they observed the loss of rare OTUs as a
denoising outcome. Because the datasets used in both studies
are derived from environmental samples lacking a ground
truth, results presented here can be regarded as complementary
with respect to such earlier predictive conclusions.

Recently, Bonder et al. (2012) analyzed the diversity in human
saliva samples using a taxonomy—independent approach. After
denoising, chimera checking and clustering with ESPRIT—Tree,
they reported 306 OTUs. In our 50 simulated datasets of closely
related sequences (COREl), DCC followed by ESPRIT—Tree
clustering, on average, yielded a 6.0% underestimation of the
sample diversity (min: 1.3%; max: 12.1%). In 50 simulations
of more divergent sequences (COREZ), the same approach re—
sulted in a 4.2% underestimation on average (min: 1.0%; max:
7.0%). When our in silico ﬁndings are projected on the results
reported by Bonder et al., we predict the microbial diversity in
this saliva dataset to be slightly higher, namely, between 319 and
326 OTUs.

Although we did not observe major differences in the perform—
ance of different clustering algorithms after the DCC and CCD
approaches, the NC and CC approaches, as well as the calcula—
tion of the NMI scores at different taxonomic levels, provide
useful information for the comparison of different clustering
methods. An indication of accurate clustering is a high NMI
score at both the species and genus level for a given dataset.
A method that clusters sequences at similarity thresholds that
are lower than a speciﬁed value (e.g. 97%) will have a high

NMI score at genus level, whereas the species—level NMI score
will be low. When the CORE—Sim results are evaluated in this
context, ESPRIT—Tree and TBC are identified as the two best
clustering algorithms of the 11 considered in this study. They
consistently achieved the highest NMI scores at both taxonomic
levels in pre—processing approaches that do not include denois—
ing, while simultaneously providing very close approximations
after the DCC or CCD treatments to the reference number of
OTUs.

Here, we assessed different data pre—processing strategies in
combination with several clustering algorithms that are com—
monly used in taxonomy analysis. Based on our as well as pre—
vious results (Bonder et al., 2012; Schloss et al., 2011), we suggest
an analysis workﬂow, which (after quality ﬁltering) starts with
chimera removal. We showed that the most accurate chimera
detection is obtained when the union of chimeras detected by
UCHIME de novo and reference—based modes are taken, where
the reference database should be extensive, quality checked [e. g.
SILVA (Quast et al., 2013) or Greengenes (DeSantis et al., 2006)]
and preferably trimmed to the HVR of interest (Brandt et al.,
2012). As the current UCHIME algorithm is remarkably fast,
chimera checking can be performed before denoising, resulting in
2—fold shorter denoising time due to the reduction in unique
ﬂowgrams after chimera removal. The resulting reads should
be corrected for sequencing errors, preferably with a denoising
algorithm that is ﬁne—tuned for the error rate that is speciﬁc to
the dataset. The chimera—checked and denoised reads can be
clustered with ESPRIT—Tree, TBC or a signiﬁcantly faster clus—
tering algorithm such as USEARCH or swarm in the case of
run—time constraints.

ACKNOWLEDGEMENTS

The authors thank Mark Buijs for preparing the amplicons for
Sanger sequencing and the authors of 454Sim for their help in
re—tuning the 454Sim parameters. The authors also thank
SURFsara (www.surfsara.nl) for the support in using the Lisa
Compute Cluster.

Funding: University of Amsterdam under the research priority
area ‘Oral Infections and Inﬂammation’ (to WC.) and The
Netherlands Organisation for Scientiﬁc Research (NWO) (to
SA).

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et al. (1990) Basic local alignment search tool. J. Mol. Biol, 215,
4034110.

Altschul,S.F. et al. (1997) Gapped BLAST and PSI—BLAST: a new generation of
protein database search programs. Niwleic Acids Res., 25, 338973402.

Angly,F.E. et al. (2012) Grinder: a versatile amplicon and shotgun sequence simu—
lator. Nucleic Acids Res, 40, e94.

Bakker,M.G. et al. (2012) Implications of pyrosequencing error correction for bio—
logical data interpretation. PLoS One, 7, e44357.

Balzer,S. et al. (2010) Characteristics of 454 pyrosequencing datagenabling realistic
simulation with ﬂowsim. Bioiiy’ormutics, 26, i42fki425.

Bonder,M.J. et al. (2012) Comparing clustering and pre—proeessing in taxonomy
analysis. Bioinformutics, 28, 289172897.

Brandt,B.W. et al. (2012) TaxMan: a server to trim rRNA reference databases and
inspect taxonomic coverage. Niwleic Acids Res., 40, W827W87.

 

ﬁre'spumol‘pmyo'sopeuuowrorq/ﬁdnq

A.May et al.

 

Cai,Y. and Sun,Y. (2011) ESPRIT—Tree: hierarchical clustering analysis of millions
of 16S rRNA pyrosequences in quasilinear computational time. Nucleic Acids
Res., 39, e95.

Caporaso,J.G. et al. (2010) QIIME allows analysis of high—throughput community
sequencing data. Nat. Methods, 7, 3357336.

Crielaard,W. et al. (2011) Exploring the oral microbiota of children at various
developmenml stages of their dentition in the relation to their oral health.
BMC Med. Genomics, 4, 22.

DeSantis,T.Z. et al. (2006) Greengenes, a chimera—checked 16S rRNA gene data—
base and workbench compatible with ARB. Appl. Environ. Microbiol, 72,
506975072.

Edgar,R.C. (2010) Search and clustering orders of magnitude faster than BLAST.
Bioinformatics, 26, 246(F246l .

Edgar,R.C. et al. (2011) UCHIME improves sensitivity and speed of chimera
detection. Bioinformatics, 27, 219442200.

Gaspar,J.M. and Thomas,W.K. (2013) Assessing the consequences of denoising
marker—based metagenomic data. PLoS One, 8, e60458.

Ghodsi,M. et al. (2011) DNACLUST: accurate and efﬁcient clustering of phylo—
genetic marker genes. BMC Bioinformatics, 12, 271.

Gilles,A. et al. (2011) Accuracy and quality assessment of 454 GS—FLX Titanium
pyrosequencing. BMC Genomics, 12, 245.

Griffen,A.L. et al. (2011) CORE: a phylogenetically—curated 16S rDNA database of
the core oral microbiome. PLoS One, 6, e19051.

Haas,B.J. et al. (2011) Chimeric 16S rRNA sequence formation and detection in
Sanger and 454—pyrosequenced PCR amplicons. Genome Res., 21, 494504.
Hao,X. et al. (2011) Clustering 16S rRNA for OTU prediction: a method of

unsupervised Bayesian clustering. Bioinformatics, 27, 611%18.

Hartmann,M. et al. (2010) V—Xtractor: an open—source, high—throughput software
tool to identify and extract hypervariable regions of small subunit (165/185)
ribosomal RNA gene sequences. J. Microbiol. Methods, 83, 2507253.

Hartmann,M. et al. (2012) Signiﬁcant and persistent impact of timber harvesting on
soil microbial communities in Northern coniferous forests. ISME J., 6,
219972218.

Hugenholtz,P. and Huber,T. (2003) Chimeric 16S rDNA sequences of diverse origin
are accumulating in the public databases. Int. J. Syst. Evol. Microbiol, 53,
2897293.

Huse,S.M. et al. (2010) Ironing out the wrinkles in the rare biosphere through
improved OTU clustering. Environ. Microbiol, 12, 188971898.

Hwang,K. et al. (2013) CLUSTOM: a novel method for clustering 16S rRNA next
generation sequences by overlap minimization. PLoS One, 8, e62623.

Kembel,S.W. et al. (2012) Incorporating 16S gene copy number information im—
proves estimates of microbial diversity and abundance. PLoS Comput. Biol., 8,
e1002743.

Kirchman,D.L. et al. (2010) The structure of bacterial communities in the western
Arctic Ocean as revealed by pyrosequencing of 16S rRNA genes. Environ.
Microbiol, 12, 113271143.

Kittelmann,S. et al. (2013) Simultaneous amplicon sequencing to explore co—
occurrence patterns of bacterial, archaeal and eukaryotic microorganisms in
rumen microbial communities. PLoS One, 8, e47879.

Klindworth,A. et al. (2013) Evaluation of general 16S ribosomal RNA gene PCR
primers for classical and next—generation sequencing—based diversity studies.
Nucleic Acids Res., 41, e1.

Kraneveld,E.A. et al. (2012) The relation between oral Candida load and bacterial
microbiome proﬁles in Dutch elderly. PLoS One, 7, e42770.

Kunin,V. et al. (2010) Wrinkles in the rare biosphere: pyrosequencing errors can
lead to artiﬁcial inﬂation of diversity estimates. Environ. M icrohiol., 12, 118r123.

Le Chatelier,E. et al. (2013) Richness of human gut microbiome correlates with
metabolic markers. Nature, 500, 5417546.

Lee,J.H. et al. (2012) TBC: a clustering algorithm based on prokaryotic taxonomy.
J. Microbiol, 50, 1817185.

Li,W. and Godzik,A. (2006) Cd—hit: a fast program for clustering and comparing
large sets of protein or nucleotide sequences. Bioinformatics, 22, 165871659.
Lysholm,F. et al. (2011) An efﬁcient simulator of 454 data using conﬁgurable stat—

istical models. BMC Res. Notes, 4, 449.

Quast,C. et al. (2013) The SILVA ribosomal RNA gene database project: improved
data processing and web—based tools. Niwleic Acids Res., 41, D5907D596.
Quince,C. et al. (2011) Removing noise from pyrosequenced amplicons. BMC

Bioinformatics, 12, 38.

Reeder,J. and Knight,R. (2010) Rapidly denoising pyrosequencing amplicon reads
by exploiting rank—abundance distributions. Nat. Methods, 7, 668%69.

Rice,P. et al. (2000) EMBOSS: the European Molecular Biology Open Software
Suite. Trends Genet, 16, 27(r277.

Richter,D.C. et al. (2008) MetaSim: a sequencing simulator for genomics and meta—
genomics. PLoS One, 3, e3373.

Roesch,L.F. et al. (2007) Pyrosequencing enumerates and contrasts soil microbial
diversity. ISME J., 1, 2837290.

Schloss,P.D. et al. (2009) Introducing mothur: open—source, platform—independent,
community—supported software for describing and comparing microbial com—
munities. Appl. Environ. Microbiol, 75, 753777541.

Schloss,P.D. et al. (2011) Reducing the effects of PCR ampliﬁcation and sequencing
artifacts on 165 rRNA—based studies. PLoS One, 6, e27310.

Sergeant,M.J. et al. (2012) High—throughput sequencing of 16S rRNA gene ampli—
cons: effects of extraction procedure, primer length and annealing temperature.
PLoS One, 7, e38094.

Siqueira,J.F. Jr et al. (2012) Pyrosequencing as a tool for better understanding of
human microbiomes. J. Oral Microbiol, 4, 10743.

Somboonna,N. et al. (2012) Metagenomic proﬁles of free—living archaea, bacteria
and small eukaryotes in coastal areas of Sichang island, Thailand. BMC
Genomics, 13 (Suppl. 7), S29.

Sun,Y. et al. (2012) A large—scale benchmark study of existing algorithms for
taxonomy—independent microbial community analysis. Brief. Bioinform., 13,
1077121.

Tamaki,H. et al. (2011) Analysis of 16S rRNA amplicon sequencing options on the
Roche/454 next—generation titanium sequencing platform. PLoS One, 6, e25263.

Wang,X. et al. (2013) M—pick, a modularity—based method for OTU picking of 16S
rRNA sequences. BMC Bioinformatics, 14, 43.

White,J.R. et al. (2010) Alignment and clustering of phylogenetic markersi
implications for microbial diversity studies. BMC Bioinformatics, 11, 152.

Woo,P.C.Y. et al. (2008) Then and now: use of 16S rDNA gene sequencing for
bacterial identiﬁcation and discovery of novel bacteria in clinical microbiology
laboratories. Clin. Microbiol. Infec., 14, 9087934.

 

ﬁre'spumol‘proyo'sopeuuowrorq/ﬁdnq

