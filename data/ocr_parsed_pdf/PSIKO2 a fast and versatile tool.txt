Bioinformatics, 31(21), 2015, 3552—3554

doi: 10.1093/bioinformatics/btv396

Advance Access Publication Date: 2 July 2015
Applications Note

 

 

Genetics and population analysis

PSIKOZ: a fast and versatile tool to infer
population stratification on various levels

in GWAS

Andrei-Alin Popescu* and Katharina T. Huber*

School of Computing Sciences, University of East Anglia, Norwich, NR4 7TJ, UK

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on February 3, 2015; revised on May 22, 2015; accepted on June 24,2015

Abstract

Summary: Genome—wide association studies are an invaluable tool for identifying genotypic loci
linked with agriculturally important traits or certain diseases. The signal on which such studies rely
upon can, however, be obscured by population stratification making it necessary to account for it
in some way. Population stratification is dependent on when admixture happened and thus can
occur at various levels. To aid in its inference at the genome level, we recently introduced PSIKO,
and comparison with leading methods indicates that it has attractive properties. However, until
now, it could not be used for local ancestry inference which is preferable in cases of recent admix—
ture as the genome level tends to be too coarse to properly account for processes acting on small
segments of a genome. To also bring the powerful ideas underpinning PSIKO to bear in such studies,
we extended it to PSIKOZ, which we introduce here.

Availability and implementation: Source code, binaries and user manual are freely available at

https://www. uea.ac. uk/computi ng/psi ko.

Contact: Andrei—Alin.Popescu@uea.ac.uk or Katharina.Huber@cmp.uea.ac.uk
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

A major confounding factor in genome-wide association studies
(GWAS) is population stratification, that is reproductive isolation of a
sampled population. A powerful way to account for it is to assume
that the genotype ofeach individual |generally called an accession and
represented in terms of a single-nucleotide polymorphism (SNP) se-
quencel in a study is an admixture of genotypes of K22 (generally un-
known) founder (populations). This admixture can then be expressed
in terms of a dataset’s principal components (PCs) or its population
stratification matrix (i.e. its Q-matrix), which indicates for each acces-
sion of a study the proportion of its genotype that came from each of
the K founders. Contrary to leading tools such as EIGENSIRAI (Price et
(11., 2006), which only infers a dataset’s PCs and SIRUCIURE (Pritchard
et (11., 2000) (and its extension to rASiSiRUCiuue (Raj et (11., 2014)),
ADMIXIURE (Alexander et (11., 2009) and SNALr (Fricho et (11., 2014),
which only infer a dataset’s Q-matrix, l’Sll\’() (Popescu et (11., 2014) is

able to infer both. Furthermore, comparison of l’Sll\’() against compet-
ing methods suggests that while the quality of its Q-matrices is on par
with those generated by them, l’Sll\’() has better scaling properties.
However, until now, l’Sll\’() could not be used for local ancestry infer-
ence (LAI), which is important for applications ranging from human
population studies to identification of disease causative loci (Brisbin et
(11., 2012). Furthermore, it could only be used on a LINUX platform,
and the efficiency of its principle component analysis (PCA) step was
not benchmarked. 1>Sll<02 addresses these shortcomings.

2 Features

l’Sll\’() combines linear-kernel PCA with least-squares optimization to
quickly infer the PCs, number of founders and Q-matrix of a data-
set. Its successor 1>Sll<02 significantly extends it by also allowing for
LAI and usage of l’Sll\’() within a Mac environment.

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3552

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

PSIKO

3553

 

2.1 PCs and number K of founders of a dataset

To obtain a dataset’s PCs and thus estimates for its K, we perform a
PCA analysis. Rather than using standard PCA, we employ linear—
kernel PCA (see e.g. Murphy 2012) due to its good scaling proper—
ties in terms of the number of variables (SNPs in our case).

2.2 Q—matrix inference

The Q—matrix for the PCA—reduced dataset is returned as Q—matrix
for a given dataset. To obtain that matrix, we combine properties of
PCA relating to simplices observed in e.g. Ma and Amos (2012) and
Patterson et al. (2006) with an iterative least squares approach.

2.3 Local ancestry inference

Combining a sliding window approach with information about
founder genotypes allows us to map, for each individual of a dataset,
each such window to one of the K founders. The window size can be
chosen by the user, and the mapping is closely related to PCADMIx’s
(Brisbin et al., 2012). Contrary to PCADMIX which requires informa—
tion about founder genotypes as input and thus cannot be used in its
absence, this input is optional for PSIKOZ. For datasets where this
information is not available, we infer it from the estimate of its
Q—matrix (see Supplementary Material for details).

3 Implementation and usage

Released under a GPL license, PSIKOZ is command line based and
takes as input a genotype matrix in the form of the widely used
.geno file format (Price et al., 2006). It is written in C++ and comes
with directly linked binary executable files that should work on all
modern Linux platforms/Mac environments. Alternatively, the user
may compile the program himself if all required libraries are present
on their system (see user manual for details). Its output can be used
to inform a study in terms of a dataset’s local ancestry, PCs, K and
Q—matrix [which can then be graphically represented in terms of a
barplot using R (R Core Team, 2014)] or as input to approaches
such as STRUCTURE (in the form of e.g. a starting point for estimation
of that number) or packages for association mapping such as TASSEL
(Bradbury et al., 2007), BOLT—LMM (Loh et al., 2015) and FASTLMM
(Lippert et al., 2011).

4 Testing and performance measure

To ensure the correctness of PSIKOZ’s predecessor regarding K and
Q—matrix estimation, we rigorously tested it in Popescu et al. (2014)
on both real biological and simulated data. This testing did not in—
clude scrutinizing the efficiency of our implementation of linear—
kernel PCA. We rectify this here by comparing PSIK02 against an
implementation of that strategy in the freely available SKLEARN soft—
ware (Pedregosa et al., 2011). Furthermore, to better understand
PSIKO2’s performance with respect to LAI, we used an approach simi—
lar to the one described in Brisbin et al. (2012) to compare it against
PCADMIX. See Supplementary Material for details for both.

4.1 Linear—kernel PCA

Key to PSIKO’s impressive performance (see Popescu et al. 2014) with
respect to large (in the number of SNPs) datasets common with NGS
data is a compact representation of genotype data. One of the rea—
sons for this is owing to the fact that SNPs can only attain one of
three possible values (i.e. 0, 1 or 2) allowing PSIKO to efficiently store
them using a bitwise implementation. In the context of linear—kernel
PCA, this also allows for quick dot product computation which

Table 1. Runtime comparison (in seconds)/memory consumption
(in megabytes) of PSIKO and SKLEARN

 

100K 250K 1M 2.5M

 

PSIKO 4.0/36 10.5/36 35/833 75/1192
SKLEARN 71.4/2436 337.9/10284 1415/39 891 NA/>63 000

 

PSIKO requires for finding a dataset’s PCs (see Supplementary
Material).

Using the R2 correlation coefficient between the PCA—reduced
datasets generated by the two kernel—PCA methods [where we ob—
tained the input datasets as described by Popescu et al. (2014)] as as—
sessment measure, we found R2 to be larger that 0.999 for all
simulated datasets indicating that both methods produce, to all ex—
tends and purposes, identical output with differences attributable to
floating point arithmetic precision errors. However, PSIKO’s runtime
was a fraction of that of SKLEARN (Table 1), with SKLEARN running
out of memory for sequences of length 2.5M.

4.2 LAI algorithm

To assess PSIKOZ’s suitability for LAI, we used simulated datasets
which we generated by combining the dataset provided by PCADMIX
with the methodology described by Brisbin et al. (2012). We con—
sidered two main scenarios. In the first, we provided PSIKO2 with
founder (genotypes), and thus our results are directly comparable
with those reported for PCADMIX in (Brisbin et al., 2012). In the se—
cond, we withheld that information rendering PCADMIX inapplicable
as it requires that information as input. Using the Q—matrix esti—
mated by PSIKOZ and taking as proxy for the dataset’s founders all
accessions which had more than 91% of their genome originating
from the same population, this dataset did not pose a problem for
PSIK02.

In both cases, the performance of PSIKOZ was notable with it cor—
rectly reporting, within less than a second, the ancestry of 91.2%/
91.1% (first/second scenario) of the loci under consideration for the
input dataset. This is of the same quality as the results that PCADMIX
obtained for a dataset with similarly diverged founders.

In summary, we believe PSIKO2 to hold great promise for popula—
tion stratification correction on various genomic levels.

Acknowledgements

Both authors thank the referees for helpful comments.

Funding

This work was supported by the Norwich Research Park (to A.-A.P.). The re-
search presented was carried out on the High Performance Computing
Cluster supported by the Research and Specialist Computing Support service
at the University of East Anglia.

Conﬂict oflnterest: none declared.

References

Alexander,D.H. et al. (2009) Fast model-based estimation of ancestry in unre-
lated individuals. Genome Res., 19, 1655—1664.

Bradbury,P.]. et al. (2007) Tassel: software for association mapping of com-
plex traits in diverse samples. Biomformatics, 23, 2633—2635.

Brisbin,A. et a]. (2012) PCAdmix: principal components-based assignment of
ancestry along each chromosome in individuals with admixed ancestry from
two or more populations. Hum. Biol., 84, 343.

/3.IO'S[EIIm0fp.IOJXO'SOIJEIIIJOJIIIOIq/ﬂduq

3554

A.—A.Popescu and K. T.Huber

 

Fricho,E. et al. (2014) Fast inference of admixture coefﬁcients using
sparse non-negative matrix factorization algorithms. Genetics, 196, 973—
983.

Lippert,C. et al. (2011) FaST linear mixed models for genome-Wide associ-
ation studies. Nat. Methods, 8, 833—835.

Loh,P.R. et al. (2015) Efﬁcient Bayesian mixed-model analysis increases asso-
ciation power in large cohorts. Nat. Genet., 47, 284—290.

Ma,]. and Amos,C.I. (2012) Principal components analysis of population ad-
mixture. PLOS One, 7, e40115.

Murphy,K.P. (2012) Machine Learning: A Probabilistic Perspective. The MIT
Press, Cambridge, MA.

Patterson,N. et al. (2006) Population structure and Eigenanalysis. PLOS
Genet, 2, 2074—2093.

Pedregosa,F. et al. (2011) Scikit-learn: machine learning in Python. ] Machine
Learning Res., 12, 2825—2830.

Popescu,A.A. et al. (2014) A novel and fast approach for population structure
inference using kernel-PCA and optimisation (PSIKO). Genetics, 198,
1421—1431.

Price,A.L. et al. (2006) Principal components analysis corrects for stratiﬁca—
tion in genome-wide association studies. Nat. Genet., 38, 904—909.

Pritchard,J.K. et al. (2000) Inference of population structure using multilocus
genotype data. Genetics, 155, 945—959.

R Core Team (2014) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Raj,A. et al. (2014) fastSTRUCTURE: variational inference of population
structure in large SNP datasets. Genetics, 197, 573—589.

/310'S[BHmOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq

