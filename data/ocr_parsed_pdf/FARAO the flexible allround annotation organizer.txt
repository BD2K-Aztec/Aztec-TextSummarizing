Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw499

Advance Access Publication Date: 4 August 2016
Applications Note

 

 

Genome analysis

FARAO: the flexible all-round annotation

organizer

Rickard HammarénI'Z, Chandan Pa|1'3 and Johan Bengtsson-Palme1'3'*

1Department of Infectious Diseases, Institute of Biomedicine, The Sahlgrenska Academy, University of
Gothenburg, Guldhedsgatan 10, SE-413 46, Gothenburg, Sweden, 2Science for Life Laboratory, Department of
Medical Epidemiology and Biostatistics, Karolinska Institute, SE-171 21 Solna, Stockholm, Sweden and 3Centre for
Antibiotic Resistance Research (CARe) at University of Gothenburg, Gothenburg, Sweden

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on May 20, 2016; revised on July 21, 2016; accepted on July 22, 2016

Abstract

Summary: With decreasing costs of generating DNA sequence data, genome and metagenome
projects have become accessible to a wider scientific community. However, to extract meaningful
information and visualize the data remain challenging. We here introduce FARAO, a highly scalable
software for organization, visualization and integration of annotation and read coverage data that
can also combine output data from several bioinformatics tools. The capabilities of FARAO can

greatly aid analyses of genomic and metagenomic datasets.

Availability and Implementation: FARAO is implemented in Perl and is supported under Unix—like
operative systems, including Linux and macOS. The Perl source code is freely available for down—
load under the MIT License from http://microbiology.se/software/farao/.

Contact: johan.bengtsson—paIme@microbiology.se

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Rapid advancements in DNA sequencing technology have quickly
shifted the bottleneck for biological knowledge generation from re-
stricted availability of sequence data to limited ability to analyze
and mine the datasets generated (Heather and Chain, 2016). Thus,
the analysis of nucleotide sequences from recent genomics projects
requires tools that cannot only handle massive amounts of sequence
data, but can also filter it and present the most relevant information
to the user in an efficient manner. In this process, visualization of
DNA sequence data and its associated annotations is key. However,
annotations are often generated using a range of tools and data-
bases, each with its own output formats and restrictions (Oulas
et (11., 2015). Hence the ability to combine annotations from differ-
ent sources is instrumental to form a complete picture of the se-
quences under scrutiny. Furthermore, with the advent of shotgun
metagenomics, which can produce highly fragmented assemblies
with thousands or even millions of contigs from a single sample

(Bengtsson—Palme et (11., 2014), scalability becomes an important
issue to consider. Metagenomics and RNA sequencing also intro-
duce the ability to quantify the abundance of contigs and features in
the data based on read coverage, which therefore also becomes
an important part to incorporate in analysis and visualization
frameworks.

A multitude of tools for visualization of annotated sequence fea-
tures exist, but most of them either cannot integrate annotation and
read coverage data (e.g. Kumar et (11., 2011; Lee et (11., 2009; Pan
et (11., 2010; Wilkinson et (11., 2002), focus mainly on visualizing
coverage information (Carver et (11., 2012; Wozniak et (11., 2011),
lack scalability beyond a few hundred sequences (Fiume et (11.,
2010), cannot efficiently filter the data to the needs of the user (Hou
et (11., 2010; Peterson et (11., 2012), or pose restrictions on what tools
and file formats that can be used for input of annotated features
and/or coverage information (Milne et (11., 2010; Okonechnikov
et (11., 2012). There also exist a range of web-based tools that can

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

/310‘sleumo[p10}xo‘soueuHOJIItotq/ﬁdnq

R.Hammare'n et al.

 

Table 1. Brief description of the FARAO command-line tools

 

Name of tool Description

 

setup_annotation_db
add_annotation
get_annotations

Creates a new FARAO database from a FASTA ﬁle, for annotation or coverage information
Adds annotations from a bioinformatics software to an annotation database
Queries an annotation database for information, e.g. entries matching reference proteins in a cer-

tain database with >90% identity

remove_annotations
add_mapped_reads
get_coverage
remove_mapped_reads
estimate_coverage

Deletes speciﬁc annotation information from an annotation database

Adds coverage information from a read mapping software to a coverage database

Queries a coverage database for information on mapped reads to each database sequence
Deletes coverage information for a speciﬁc library from a coverage database

Used to estimate the coverage of speciﬁc features from an annotation database, based on the in-

formation in a coverage database

annotation_db_to_mysql
coverage_db_to_mysql

Convert annotation databases to MySQL format
Convert coverage databases to MySQL format

 

visualize high—throughput data, generally connected to automated
pipelines for sequence annotation (e.g. Cantor et al., 2015; Meyer
et al., 2008; Sharma et al., 2015). However, none of these tools pre—
sent a scalable, multi—purpose framework for integrating annotation
and coverage information from several different database sources
into a database that can be queried at the request of the user.

Consequently, there is a need for highly flexible and adaptable
software tools that can bridge disparate annotation and quantifica—
tion approaches. Such a toolkit should be agnostic to what kind of
bioinformatic tools that have been used to annotate sequences, and
must be able to adapt to novel annotation utilities as they are intro—
duced, for example by providing extension modules to the software
that can be tapped into by users skilled in programming. Given the
challenges associated with filtering the data, the software needs to
be able to process it in a way that is scalable up to millions of se—
quences with hundreds of features each. Finally, it is desirable if the
software is able to produce publication quality visual output that
can be further processed by users. Cantor et al. (2015) recently
introduced a web server tool with many of these capabilities, which,
however, requires the user to upload the sequence and annotation
data. This might be prohibitive for users with limited Internet con—
nection, and while web based tools are convenient for many users,
they do not lend themselves to integration with Unix and/or Linux
based workflows, which typically rely on command—line tools.

With these limitations in mind, we have developed FARAO — the
Flexible All—Round Annotation Organizer — that functions as a
highly configurable set of command—line tools that: (i) integrate an—
notation and coverage information for the same sequence set; (ii) are
scalable to millions of sequences and features; (iii) can filter out se—
quences with annotations satisfying criteria given by the user; (iv)
can handle annotations produced by a range of bioinformatics tools;
and (v) provide a flexible interface for writing custom parsers for
virtually any format not supported out of the box.

2 Implementation

FARAO is a set of command—line tools implemented in Perl 5 and
should be functional under any version of Unix or Linux, including
macOS. It uses the DB1 and DBD modules for MySQL compatibil—
ity, the PostScript—Simple module for EPS graphics creation, and
the GD library for PNG image generation. None of these libraries
are required to install FARAO and use its basic functionality,
although installing them greatly extends the capabilities of the
software.

FARAO consists of ten programs, each with specific functions
for interacting with annotation and coverage data (Table 1). In add—
ition, FARAO comes with a bundled set of parsers for various bio—
informatics software (see the manual; Supplementary Item 1). The
set of parsers can easily be expanded upon with additional parsers
written by the user or downloaded from the library located at http://
microbiology.se/software/farao/parsers. Detailed instructions on
how to create custom parsers are available in the FARAO manual.
The runtimes and memory requirements of FARAO are highly de—
pendent on the use cases. For example, for a database consisting of
1.7 million contigs (encompassing 2.4 Gbp of sequence data) with
annotations from 8 different sources, occupying 1.4 Gb of disk
space, running a typical request for retrieving all annotations of a
certain kind took 1 minute and 31 s, using 1.7Gb of RAM. In con—
trast, looking up all annotations for a specific entry only took 15 s
and used less than 32 Mb of RAM.

3 Conclusions

We introduce FARAO, an annotation and read coverage visualiza—
tion software that enables integration of annotation and coverage
information, is highly scalable, can combine output data from sev—
eral bioinformatics tools and produces high—quality EPS output for
figures. In addition, FARAO eases annotation of genomes and meta—
genomes by enabling filtering of sequence data by the features they
contain.

Acknowledgements

The authors would like to thank Dr. Anna Johnning, Dr. Fredrik Boulund
and Dr. Carl-Fredrik Flach for valuable input on FARAO features and

Visualization.

Conﬂict ofInterest: none declared.

References

Bengtsson-Palme,]. et al. (2014) Shotgun metagenomics reveals a wide array
of antibiotic resistance genes and mobile elements in a polluted lake in
India. Front. Microbiol., 5, 648.

Cantor,M. et al. (2015) Elviz — exploration of metagenome assemblies with an
interactive Visualization tool. BMC Bioinformatics, 16, 130.

Carver,T. et al. (2012) Artemis: an integrated platform for Visualization and ana-
lysis of high-throughput sequence-based experimental data. Bioinformatics,
28, 464—469.

ﬁm'spzumol‘pmyo'sopcuuowtotq/ﬁdnq

FARAO

 

Fiume,M. et al. (2010) Savant: genome browser for high-throughput sequenc-
ing data. Bioinformatics, 26, 1938—1944.

Heather,].M. and Chain,B. (2016) The sequence of sequencers: the history of
sequencing DNA. Genomics, 107, 1—8.

Hou,H. et al. (2010) MagicViewer: integrated solution for next-generation
sequencing data visualization and genetic variation detection and annota-
tion. Nucleic Acids Res., 38, W732—W736.

Kumar,K. et al. (2011) AGeS: a software system for microbial genome se-
quence annotation. PLoS ONE, 6, e17469.

Lee,D. et al. (2009) WeGAS: a web-based microbial genome annotation sys-
tem. Biosci. Biotechnol. Biochem., 73, 213—216.

Meyer,F. et al. (2008) The metagenomics RAST server - a public resource for
the automatic phylogenetic and functional analysis of metagenomes. BMC
Bioinformatics, 9, 386.

Milne,I. et al. (2010) Tablet—next generation sequence assembly Visualization.
Bioinformatics, 26, 401—402.

Okonechnikov,K. et al. (2012) Unipro UGENE: a uniﬁed bioinformatics tool-
kit. Bioinformatics, 28, 1166—1167.

Oulas,A. et al. (2015) Metagenomics: tools and insights for analyzing next-
generation sequencing data derived from biodiversity studies. Bioinf. Biol.
Insights, 9, 75—88.

Pan,X. et al. (2010) Domain View: a web tool for protein domain Visualization
and analysis.]. Struct. Funct. Genomics, 11, 241—245.

Peterson,E.S. et al. (2012) VESPA: software to facilitate genomic annotation
of prokaryotic organisms through integration of proteomic and transcrip-
tomic data. BMC Genomics, 13, 131.

Sharma,A.K. et al. (2015) Woods: A fast and accurate functional annotator
and classiﬁer of genomic and metagenomic sequences. Genomics, 106, 1—6.

Wilkinson,M.D. et al. (2002) Genquire: genome annotation browser/editor.
Bioinformatics, 18, 1398—1399.

Wozniak,M. et al. (2011) CAMBerVis: visualization software to support com-
parative analysis of multiple bacterial strains. Bioinformatics, 27, 3313—3314.

/310'S[Bum0fplOJXO'SOIJBLUJOJIIIOICI”Zduq

