Bioinformatics, 31 (24), 2015, 3890—3896

doi: 10.1093/bioinformatics/btv496

Advance Access Publication Date: 30 August 2015
Original Paper

 

 

Genome analysis

A hybrid bayesian approach for genome-wide
association studies on related individuals

A. Yazdani1'* and D. B. Dunson2

1Human Genetic Center, University of Texas at Houston Health Science Center, Houston, USA and 2Department of
Statistical Science, Duke University, Durham, North Carolina USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on April 14, 2015; revised on August 15, 2015; accepted on August 18, 2015

Abstract

Motivation: Both single marker and simultaneous analysis face challenges in GWAS due to the
large number of markers genotyped for a small number of subjects. This large p small n problem is
particularly challenging when the trait under investigation has low heritability.

Method: In this article, we propose a two—stage approach that is a hybrid method of single and sim—
ultaneous analysis designed to improve genomic prediction of complex traits. In the first stage, we
use a Bayesian independent screening method to select the most promising SNPs. In the second
stage, we rely on a hierarchical model to analyze the joint impact of the selected markers. The
model is designed to take into account familial dependence in the different subjects, while using
local—global shrinkage priors on the marker effects.

Results: We evaluate the performance in simulation studies, and consider an application to animal
breeding data. The illustrative data analysis reveals an encouraging result in terms of prediction

performance and computational cost.
Contact: Akram.Yazdani@uth.tmc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Genome—Wide association studies (GWAS) have been Widely con—
ducted in humans with the goal of identifying genetic factors pre—
dictive of disease. GWAS chips collect data on single nucleotide
polymorphisms (SNPs) across the genome, focusing on common
variants in which the minor allele frequency is at least 5%. The
dominant focus in GWAS has been on independent screening meth—
ods, which consider the association between disease and each SNP
separately While adjusting for false discoveries. This strategy tends
to produce a small number of SNPs having modest effect sizes, fail—
ing to explain a substantial proportion of the known heritability in
disease. Given the size of the multiple testing problems in which the
number of SNPs (p) is dramatically larger than the number of indi—
viduals under study (71), it is not surprising that independent screen—
ing has failed to identify much signal in the data. As the identified
SNPs typically explain a small proportion of the variability in the
phenotype, GWAS has been unsuccessful at producing accurate

predictive models in humans (see, e.g. Buckler et (11., 2009; Hoggart,
2008; Diabetes Genetics Initiative of Broad Institute of Harvard
et (11., 2007; Wellcome Trust Case Control Consortium, 2007;
Weedon et (11., 2008).

Dramatic reduction in cost has driven the increased use
of GWAS beyond humans to animal breeding studies. In animal
breeding a major focus is on prediction of genetic merit (breeding
value) when the pedigree structure is taken into account. Based on
predictions early in life, animals having a high probability of de—
veloping desired traits will be differentially selected. When the focus
is on prediction of traits instead of identification of the top individ—
ual variants, it has been suggested that all markers should be
included instead of attempting variable selection (Meuwissen et (11.,
2001).

Because in GWAS the number of SNPs exceeds the number of
samples, simultaneous analysis requires using penalized or shrinkage
approaches. The most popular approach is the Lasso (Tibshirani,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3890

9103 ‘Org JSanV 110 salaﬁuv soc] ‘Btulomrzg 30 AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pQPBOIIIAAOG

A Hybrid Bayesian Approach for GWAS

3891

 

1996), which includes an L1 penalty on the coefficients to induce
simultaneous variable selection and shrinkage. However, a rich var—
iety of alternative penalties have been proposed (Fan and Li, 2001;
Zhang, 2010; Zou and Hastie, 2005) to provide desirable shrinkage
behavior. Most of the point penalization estimates of marker effects
correspond with the mode of a posterior distribution obtained under
shrinkage priors. These priors typically can be expressed as local—
global scale mixtures of normal distributions (see, e.g. Armagan et
(11., 2013; Carvalho et (11., 2009; Griffin and Brown, 2011; Park and
Casella, 2008). Carefully designed priors in this class shrink small
signals towards zero while limiting shrinkage of larger signals.
Compared with variable selection, such methods have computa—
tional advantages (avoid an intractable search over all possible sub—
sets) and better accommodate lots of small but non—zero
coefficients. In Bayesian analyses of animal breeding, it has been
common to rely on mixture priors that include a mass at zero for
zero coefficients (see, e.g. Gianola et (11., 2009). Such priors are tabu—
lated in Supplementary Appendix A, Table 1.

Although the aforementioned simultaneous approaches have
been applied to 17 >> 71 problems, there are some clear limitations in
scaling computation to very large p, as well as issues in obtaining re—
liable results when n is too small relative to p. In sparse signal pro—
cessing problems involving large 17 small 71 linear regression, it has
been discovered that there is often a phase transition that depends
on the relative values of n and p and the true sparsity level. When n
is too small, so that one is on the wrong side of the phase transition,
results are very unreliable. Such transitions have been characterized
only in idealized cases, making assumptions on the design matrix
that are not appropriate in genomic studies due to strong correl—
ations that arise given the linkage disequilibrium (LD) structure. We
hope to push back the phase transition by using a carefully struc—
tured Bayesian approach.

To combat the computational intractability of variable selection
in massive dimensions, multistage approaches are recommended
(see, e.g. Beattie et (11., 2002; Fan and Lv, 2008; Huanga et (11.,
2010; Li et (11., 2011; Paul et (11., 2008; Shariati et (11., 2012). For
family based studies, Kessler et al. (2014) proposed two—stage
screening based on a Bayesian non—parametric regression model.
Here, we instead propose a two—stage approach for a polygenic
mixed model to predict phenotypic variation in the trait of interest
from genomic information for data collected on genetically related
individuals. In the first stage, we apply a Bayesian independent
screening method, which takes into account familial dependence
while examining SNPs one at a time. This Bayesian screening
method has better performance than competitors in our experience,
and is expected to select a superset of the important predictors (Ball,
2011; Stephens and Balding, 2009). In the second stage, we imple—
ment a Bayesian hierarchical model to control the level of sparsity
and amount of shrinkage relative to the size of signals. We use the
generalized double Pareto (GDP) prior (Armagan et (11., 2013)
within a polygenic mixed model, extending previous implementa—
tions of the GDP to problems in which the samples are related. We
evaluate the predictive performance and computational efficiency of
the proposed approach called two—stage—GDP by conducting a simu—
lation and real data analysis.

2 Model

The overwhelming majority of the literature on analysis of GWAS
data focuses on unrelated individuals, while our interest is in animal
breeding data from pedigrees. It is important to take the familial de—
pendence structure into account in the analysis to avoid finding

spurious associations (see for e.g. Kang et (11., 2010). A common
model—based approach to incorporate familial dependence is ran—
dom effects modeling. In particular, we let

y:X ﬁ+u+e, e~N(0,‘r—1R). (1)

Here, y is an 7; vector of a quantitative trait measured on 71 subjects
(animals), [i is a p vector of additive genetic effects and X is an n X 17

matrix of genotypes measured at genetic markers, such that each
SNP is coded as

2 if the genotype of the SNP is BB
1 if the genotype of the SNP is Bb
0 if the genotype of the SNP is bb,

where B represents the allele with lower frequency. In model (1), R
is an n X 71 diagonal matrix accommodating heterogenous residual
variance, which is estimated in a preliminary data preprocessing
step, and u is an 71 random vector such that

u~N(0.r;1I<).

where K is an n X n relatedness matrix. Entries of K are in (0, 1) and
correspond to the degree of relationship between pairs of subjects,
ranging from 0 for unrelated individuals to 1 for self—kinship. This
matrix is calculated based on the pedigree measuring genetic similar—
ity between subjects as 2,, (.5 )LW, with the sum being over all paths
[7 connecting two subjects with unique common ancestors and L(/7)
is the length of path 17. If the pedigree is incomplete or not available,
K can be estimated based on genotype data (see for e.g. Oliehoek et
(11., 2006).

2.1 First—stage

In this stage, we select a set of promising SNPs by testing the ef—
fect of each marker individually. By far the most common approach
used in the literature relies on independent testing for association be—
tween each SNP and the phenotype using frequentist methods.
This produces P—values for each SNP, and the set of significant SNPs
can be obtained by choosing a small threshold on these P—values.
This threshold is often chosen to maintain a desired false discovery
rate (FDR). We instead rely on Bayes factors (BFs) measuring
the weight of evidence in the data against the local null hypothesis
Ho,- of no association between a given SNP and the phenotype. In
this initial screening stage, we rely on Bayes factors in favor of the
model with only the jth SNP included against the global null model
that has no SNPs included. These BFs can be defined under model
(1) as

JJf(YrulH1/'r 91i)7r(01ilH1/') d“ doli
BF,- :

 

JJf(YrulH0ir 90i)7r(00ilH0i) d“ door

where 0),,- : (la/ii, r, I“) is the set of parameters under Hki for
k 6 {0,1}, n(0k,-lHk,-) is its prior density, and f(y,ulHk,-, OM) is the
probability density of (y, u) given 0g.

The separate analysis of each SNPs makes it appropriate to spe—
cify the usual conjugate prior on the set of parameters 0rd. In particu—
lar, we consider

ﬁilr~N(Orr—1)ri: 177177

17 ~ Gamma(a1,b1), 17,, ~ Gamma(a2, b2).

9103 ‘Org JSanV 110 salaﬁuv soc] ‘Btulomrzg 30 AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Idllq 11101} pQPBOIIIAAOG

3892

A. Yazdani and D. B. Dunson

 

To calculate the BF,s, we first integrate out the parameters l)’,s and
the random effects u and obtain

—1/2
balb‘12 A K
2“ —7t/2 1 2 1111—1142—1—k _
 ) moron) "

1 1,,

 

 

—1
><exp(—1b1 — 1ubz)exp [— éyT (% +  y d1,,d1,

u

 

where A}, : R + k(x,-X,T) corresponding to H1,- for k : 0, 1 in the de—
nominator and numerator, respectively. These integrals are analytic—
ally intractable. Hence, we approximate the integrals by applying
Laplace transformation. To avoid having the mode on the boundary
due to the constraints 1 > 0 and 1,, > 0, the precision parameters are
reparameterized with log transformation.

The calculated BF,s provide a list of ranked SNPs for select—
ing the most promising markers. In the screening stage, our goal is
to reduce the number of SNPs under consideration to a manageable
number, while erring on the side of including too many SNPs.
Usual thresholds on BFs, such as the common value of 10 recom—
mended in (Jeffreys, 1961), are too small due to the massive mul—
tiple comparisons problem. On the other hand, thresholds that
are fully adjusted for multiple comparisons, such as those recom—
mended by Ball (2011) and Stephens and Balding (2009), will tend
to select too few SNPs. Motivated by our goal of building a model
for prediction, we instead rely on cross validation for threshold
choice.

2.2 Second—stage

In this stage, we simultaneously include all SNPs selected in the first
stage, while incorporating a shrinkage prior on their coefficients. In
building a predictive model, it is necessary to characterize the simul—
taneous impact of the different SNPs on the phenotype. We find that
including the first stage instead of incorporating all the SNPs in the
simultaneous analysis improves performance in two respects. The
first is a considerable computational speedup as the number of SNPs
grows. The second is an improvement in accuracy of the resulting
predictive model. This second improvement is due to the fact that
most shrinkage priors are insufficiently ﬂexible to handle truly mas—
sive—dimensional predictors that are not highly sparse in their effects.
Shrinkage priors are designed to have separate parameters control—
ling concentration around zero and tail heaviness, but such control
is insufficient in GWAS.

In the second stage, model (1) is rewritten as

y:>"<ii+u+é. é~N(0.r—1R). (3)

where vector ii represents the effects of 175 selected SNPs and X is the
corresponding design matrix.

2.2. 1 Prior specification
We incorporate a local—global shrinkage prior into polygenic mixed
model (3) as

ii~ Nor-12,), (4)

where 2,} : diag{11,-}. The variance of each coefficient, 3,, includes
two parameters, 1 and 11,-, representing global and local shrinkage ef—

fects, respectively. In GWAS settings, 1‘1

is expected to be close to
zero, corresponding to a high degree of overall shrinkage to stabilize
estimation and incorporate the expectation that most coefficients
are close to zero. To avoid over—shrinkage of the most inﬂuential

SNPs, the prior on 11,- is designed to have heavy tails. To obtain a

ﬂexible prior with the desired behavior, which also leads to compu—
tational advantages, we let

11, ~ eXp(€?/2)-

Instead of presetting values for 5,-s, it is appealing to assign a prior
distribution to these parameters as

5,- ~ Gamma(c,d),

which induces a heavy—tailed marginal on 11,-.

The above hierarchical shrinkage prior on the SNP coefficients
corresponds to a representation of the GDP introduced by Armagan
et al. (2013). To complete a specification of the prior, the precision
parameters 1 and 1,, are given gamma priors as in (2). The GDP has
substantial advantages over simpler shrinkage priors, such as ridge
and Bayesian Lasso, in terms of limiting over—shrinkage of the larger
coefficients.

2.2.2 Posterior interpretation
Under the proposed model, the total phenotypic variance for the
trait can be decomposed as

p: 125

V, : 223,3,1cov(£,,£7)+51_1+5,,1;1, (5)
[:1 3:1
where 5 and 5,, are the mean of diagonal elements in R and K, re—
spectively; i.e. 5 :  r,,- and 5,, : iZIQ [2,,- where r,,- and [2,,- are
the i/th elements of matrices R and K. In the case that K is calculated
from a pedigree, 5,, is one. The proportion of the phenotypic vari—
ance explained by total genetic variance is called heritability,
denoted by 172. As is clear from (5 ), 172 accounts for the covariance
between markers as well. If we ignore the contribution from the co—
variance (Cai et (11., 2011), the proportion of the phenotypic vari—
ance explained by each marker is approximately
1,]? Z  (6)
y
By relying on MCMC samples from the posterior for the parameters
in our model, we can obtain posterior summaries for both total her—
itability 172 and individual 17,3 contributions.

2.2.3 MCMC algorithm

The joint posterior distribution is

“(1371171117  7111;57517  7512571771714)” CX  ‘)

p5 ~
X H103,- ln,» r)7r(11,-l€,-)Tr(€,-lc, d)
,':1

><Tl(ul17u)ﬂ(flai , b1)75(17u1427 52),

where 11(yl.) is the probability density of y given all parameters in
the model. From this joint posterior, we obtained full conditional
posterior densities for Gibbs sampling as

ﬁly,u,1~ N(p%,2%)

ulyriirmu ~ Magma),
1)y,ii,u,p,2,~, ~ Gamma(a11’,b11’),
1,,lu ~ Gamma(a2 + 71/2, uTK‘lu + b2),
5,13,,1 ~ Gamma(c + 1, 11/213,) + d),

2 1/2

~ , 5-
11,—11/i,, 5,,1 ~ IN — Gauss1an +2 75,2
Tl)’

i

9103 05 JSanV 110 sa1a§uv $011 ‘BIIIJOJIIBD 30 [(1151919qu 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂdnq 11101} pap1201um0q

A Hybrid Bayesian Approach for GWAS

3893

 

where
,1: (XTR‘1X + 2,1)-15<TR—1(y — u),
#5 = (K—11, + 1R‘1)‘1R‘1(y - 5(3),
21,; : 1'1(XTR'1X + 210—1,

25 : (K‘11,, + 1R'1)_1,

 

+ s
511:” 217 +a1,
bi : gay —>"<ﬁ — u>TR-1<y —>"<ﬁ — u) + 15,113) + b1.

Gibbs sampling alternates sampling from these simple conditional
distributions, with the draws converging to samples from the joint
posterior. From these samples, posterior summaries for any mar—
ginal of interest can be calculated; e.g. the posterior mean provides
the optimal point estimate under squared error loss.

3 Simulation study

To evaluate the prediction performance of two—stage—GDP, we con—
ducted a simulation study. We first generated a pedigree based on a
non—random mating scheme using the R package synbreed. This
pedigree structure was then utilized in simuPOP (Peng and Amos,
2008), which generated genotype data for each individual taking
into account their relatedness. To mimic our motivating real data,
we selected the subset of individuals having the same gender for ana—
lysis. We then applied Rpackage kinship2 to calculate the related—
ness matrix based on the pedigree.
We considered four different scenarios for the effect sizes:

Model—1: 300 SNPs with non—zero regression coefﬁcients generated
from U(—1, 1) for 100 individuals with 300 SNPs in total.

Model—2: 500 SNPs with non—zero regression coefﬁcients generated
from U(—1, 1) for 100 individuals with 500 SNPs in total.

Model—3: 100 SNPs with non—zero regression coefﬁcients generated
from U(1, 1.5)and U(—1.5, —1) for 200 individuals with 2000
SNPs in total.

Model—4: 400 SNPs with non—zero regression coefﬁcients generated
from U(1, 1.5)and U(—1.5, —1) for 200 individuals with 4000
SNPs in total.

The first two models are designed for dense problems in which
most of the predictors have small effects on the complex trait. The
last two models are designed for sparse problems with different level
of sparsity. We used cross validation (CV) to assess performance.
CV is intrinsically a frequentist idea, but has become routinely used
in assessing the frequentist operating characteristics of Bayesian
methods (Ghosh et (11., 2007). For each scenario, we generated 20
datasets as training sets and 20 as validation sets. Evaluation is
based on mean square prediction errors, MSPEs and correlations be—
tween observed values and predictive values. The predictions of fu—
ture values are obtained from

E (ylerryo) = 59E (lilyo) + 19,0191 E01000),

IZZI~N(ler )-

Index f and 0 denote the future data and observed data, respectively.
To evaluate the predictive performance of the model and its

where
Ko,o Kof
Klan Kff

 

 

computational efficiency, we made a comparison between two—
stage—GDP and the widely applied method, SSVS, as well as some
well—known shrinkage priors on [3,- including Bayesian Lasso,
Student—t and one—stage GDP.

SSVS places a mixture of two normals on [3,- as (1 — y,)
N(0,  + y,N(0,c,21/,2), where y,- 6 {0,1}. Bayesian Lasso (BL) as—
signs a double—exponential prior to 11,- in (4) as 11,- ~ exp(€2/2), with
52/2 ~ Gamma(c’, d’) following Park and Casella (2008). The stu—
dent—t can be expressed as a scale mixture of normal distributions
ii ~ N(0, 2,1), with 2,, : diag{11,-} and 11,- ~ Inv—gamma(c”,d”).

To set the hyperparameters for SSVS, we let  :
(001,10), with p(y,- : 1) : 0.5 in Model-1 and Model-2 and to 0.1
in Model-3 and Model-4. In BL, the posterior is relatively insensitive
to the prior on 52 as long as c’ and d’ are small (Park and Casella,
2008), and we set these hyperparameters to 0.1. For the student—t
prior, we fixed 6” : 3 as a small value greater than 2 as suggested by
Friihwirth—Schnatter and Wagner (2011). We considered different
values for d” as 0.001; 0.01; 0.1 and found 0.01 as the best choice.
For GDP hyperparameters, we considered d : m, since this
choice ensures the continuity property and creates a trade—off be—
tween sparsity and tail—robustness. We increased 6 from 1 in Model-
1 and Model-2 to 3 in Model-3 and Model-4 in order to allow more
shrinkage for sparse models. We sent hyperparameters of 1 and 1,,
equal to 10—3.

Table 1 represents the average MSPEs of 20 simulated validation
subsets for each model. The index numbers are the average of stand—
ard errors of MSPEs across 200 bootstrap samples of 20 standard
errors. The correlation between predicted and observed values in
validation sets are also represented in the table. The correlation
gives insight into the accuracy of performance comparing different
shrinkage approaches.

Table 1 shows that the t—prior performs better than the other
approaches in dense problems, Model-1 and Model-2. For the sparse
cases, Model-3 and Model-4, two—stage—GDP outperforms the other
competitors. Although in Model-3 two—stage—GDP is slightly better
than SSVS, by increasing the sparsity level in Model-4, two—stage—
GDP shows noticeably better predictive performance. In addition,
its computational cost makes feasible the use of two—stage—GDP in
GWAS.

The effect of sparsity level on prediction performance is pre—
sented in Figure 1. The figure shows mean of correlation between
observed values and predicted values in 20 validation sets versus
number of predictors in the model, while the number of predictors
with non—zero effects in the model is 100 and n : 100. The perform—
ance of one—stage approaches are highly related to the 17/71 ratio. The
correlations among observed values and predicted values are less
than 0.7 for 1722000. The computational time of these
approaches versus the number of predictors in the model is pre—
sented in Figure 2 . Our programming code for t—priors, BL, GDP
and two—stage—GDP is based on C++ in order to speed up the
MCMC algorithm. The SSVS implemented in JAGS is also based on
C++ programming.

Figures 1 and 2 represent one line corresponding to t—prior, BL
and GDP since they almost have the same performance or running
time with comparison to SSVS and two—stage—GDP. This line that is
depicted using the average point of t—prior, BL and GDP quantities,
provides better visualization for the comparison.

Available packages using frequentist approaches for linear mixed
model with p > n are restricted to specific cases, such as group struc—
ture. As those packages do not allow general linear mixed effect
structure, such as that induced by familial dependence, we could not
provide comparison with frequentist approaches.

9103 05 JSanV 110 sa1a§uv $011 ‘BIIIJOJIIBD 30 AJtSJQAtuf] 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂdnq 11101} pap1201um0q

3894

A. Yazdani and D. B. Dunson

 

Table 1. Average of MSPEs and average of correlation between
predicted and observed values over 20 validation sets for SSVS,
t—priors, BL, GDP and Two-stage-GDP

 

Model SSVS t—prior BL GDP Two—stage—

GDP

 

1 MSPE 0644,02,, 0.616(_035, 0692,03,, 0691,03,, 0655,0380,
Cor 0.805 0.863 0.711 0.713 0.789

2 MSPE 0604,0277, 0567,05,), 0711,04,, 0718,03,, 0623,03,,
Cor 0.786 0.819 0.640 0.643 0.757

3 MSPE 0572,01,, 0923,02,, 0791,02,, 0742,03,, 0526,03,,
Cor 0.884 0.631 0.742 0.780 0.9020

4 MSPE 0995,01,, 1045,03,, 0992,03,, 0935,04,, 0.610(_034,
Cor 0.544 0.501 0.511 0.567 0.827

 

- BL- GDP — r—priors

‘9

- Z-Stage-GDP

 

1.0

0—'—°-"‘-'-I-._._

°—_-._._._ _,_,_.-.—°
9

0.0

Correlation
0 5
I

\.
_ \c
_ \.

0 2000 4000 0000 3000 10000
p

0.4

 

 

0.2

 

Fig. 1. Mean of correlation between observed values and predicted values
versus number of predictors in 20 validation sets while the number of pre-
dictors with nonzero effects in the model is 100 and n:100. Green line: I-
prior/BL/GDP and Red line: two-stage-GDP

I SSVS 'BL—GDP—t—ﬁriors l 2-stage-GDP

C, /
a—
CD

 

lime

D /
c:—
‘RI'

 

 

 

.
c/
B
a _ i .. .__..——a f
N o _._.-l—"-'-
a °i___—-
0 2000 4000 6000 8000 10000

9

Fig. 2. Computational time versus the number of predictors or SNP in the
model where n: 100. Blue line: SSVS, Green line: lprior/BL/GDP and Red
line: two-stage-GDP

4 Application to real data

We applied two—stage—GDP on a GWAS dataset from an animal
breeding study. The aim of study is to improve quantity and quality
of milk production through investigating milk protein yield. The
data contain 707, 962 SNPs genotyped for 607 Holstein Bulls. After
quality control, excluding SNPs with minor allele frequency below

5%, samples with low genotyping efficiency, and violating Hardy—
Weinberg Equilibrium test, the dataset contains 555, 651 SNPs. We
further reduced the dimensionality of the set of SNPs by considering
the fact that SNPs in the genome have groups of neighbors such that
they are all nearly perfectly correlated with each other. Hence, the
genotype of one SNP can perfectly predict those of correlated neigh—
boring SNPs; i.e. one SNP can thereby serve as proxy for many
others in the analysis. As the segments of SNPs in high linkage dis—
equilibrium in cattle is longer than human because of inbreeding, we
reduced the number of SNPs down to 135, 545 via a hierarchical
clustering approach. In this agglomerative clustering, we defined the
distance between two SNPs as 1 — r2, where 12, the square of correl—
ation between two SNPs, is 0.85.

After the preliminary analysis, we first evaluated the impact of
each SNP by BF and selected 878 top—ranking SNPs using the algo—
rithm in Supplementary Appendix B. In the second—stage, we first
ran a 5 —fold cross validation in order to set the hyperparameters. For
hyperparameters of marker effects, we considered d : x/c + 1, since
this choice ensures the continuity property and creates a trade—off
between sparsity and tail—robustness (Armagan et (11., 2013). We ran
5—fold cross validation for different values of c: 1, 2.5, 3, 3.5.
Generally, the rate of shrinkage increases along this path. For the
other hyperparameters of the model, we set (a1,b1) : (a2,b2) as
(0.001, 0.001), (0.01, 0.01), (0.1, 0.1), (0.3, 0.3). Table 2 pre—
sents average of MSPEs for different sets of hyperparameters for 5—
fold cross validation and the standard deviation from 50 bootstrap
samples in subscript. It shows 6 : 3 and (a1, b1) : (a2, b2) : (0.01
, 0.01) provides smallest MSPE.

In addition, we considered two other prior specifications for the
second—stage analysis, t—priors and BL, in order to compare their pre—
dictive performance. The hyperparameters of t—priors and BL were
chosen the same as in the simulation study.

Table 3 represents average of MSPEs of 10—fold cross validation.
The index numbers are the average standard errors of MSPEs ob—
tained by averaging 100 bootstrap samples of 10 MSPEs. We also
calculated average of correlation between predicted and observed
values in 10—fold cross validation. Although two—stage GDP shows
slightly better predictive performance in terms of mean of MSPEs in
10—fold cross validation shown in Figure 3, the variation of 10—fold
cross validation result based on two—stage—GDP is smaller than two—
stage—BL and two—stage—t—priors.

The calculated total phenotypic variance from (5) for two—stage—
GDP is 1.700. The total genetic variance contributed by the additive
effects of the markers calculated from the first term of the right
hand side in (5) is 0.483. Although the aim of this study is predic—
tion, if one is interested in selecting the set of SNPs with the most
contribution, heritability is a good criteria. To select a set SNPs
based on heritability, Hoti and Sillanpaa (2006) suggested present—
ing a threshold value, t, such that one SNP is included in the final
model if the heritability explained by this SNP is greater than t.
Under such an approach, the heritability for milk protein yield is ex—
pected to be small based on previous studies. Hence, instead of set—
ting a threshold on heritability of each SNP, we considered a
threshold on total heritability of a set of top SNPs ranked based on
calculated 17,2s. To this end, we first calculated heritability for each
SNP by substituting the mean of posterior samples of l)’,s in (5). This
provided a list of ranked SNPs. We then selected a set of top SNPs
with total heritability above 0.2. The estimated effect sizes and mar—
ginal heritabilities of 32 selected SNPs as well as their chromosomes’
numbers are tabulated in Table 4.

Among these selected SNPs, 19 SNPs out of 32 have been found
in known genes or nearby them. Figure 4 shows pieces of

9103 ‘01; JSanV uo sopﬁuv 50’] 0211110311123 JO 10151911111 {1 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂdnq 11101} pap1201umoq

A Hybrid Bayesian Approach for GWAS

3895

 

Table 2. Average of MSPEs for different values of hyperparameters
for 5-fold cross validation and the standard deviation from 50 boot-
strap samples in subscript

 

 

(a1, b1) = 1 2.5 3 3.5
(£12, 52)

 

0001,0001) 0.698 0018) 0.539 0012 0.526 0013, 0.529 0010

l ( ( u ( ( u
(0.01, 0.01) 0686,0019, 0528,0011, 0519,0011, 0523,0015,
(0.1,0.1) 0736,02,, 0564,0018, 0551,02,, 0557,0023,
(0.3,0.3) 0845,0028, 0576,0018, 0572,0058, 0569,0023,

 

Table 3. Average of 10-fold cross validation MSPEs and correlation
of observed values and predicted values using two-stage meth-
ods, GDP, t-priors and BL. The subscripts are standard deviations
based on 100 bootstrap samples

 

Model Two—stage— GDP Two—stage—t—priors Two—stage—BL

 

MSPE 0518,00,“, 0551,00,,” 0.568,0_0344,
Cor 0.751 0.712 0.703

 

Table 4. Position of selected SNPs with their effect sizes and
heritabilities

 

 

Chr 13, 17,2(0/0) Chr 13, 1730/0)
1 —0.0562 0.131 13 —0.0578 0.150
1 0.0617 0.192 13 0.0585 0.173
1 —0.0983 2.930 13 0.0569 0.138
3 —0.0580 0.120 14 —0.0595 0.232
3 —0.0572 0.156 17 0.0905 2.552
3 —0.0572 0.138 18 0.0569 0.140
4 —0.0595 0.204 18 0.0790 1.584
4 —0.0591 0.206 22 0.0586 0.179
4 0.0796 1.529 25 0.0715 0.976
6 0.0707 0.906 25 —0.0753 1.091
7 —0.0726 0.950 25 —0.0553 0.110
8 0.0571 0.136 28 —0.0503 0.100
8 0.0606 0.798 28 0.0617 0.741
9 0.0636 0.821 28 0.0691 0.880
10 0.0566 0.140 28 0.0589 0.197
12 —0.0581 0.182 29 0.0580 0.200

 

chromosome 1 and 10 as examples. The red regions in these pictures
indicate the locations of the genes associated with milk protein yield
that have been found through previous studies. The two vertical red
lines represent the locations of two selected markers in our study. As
it shows, the selected SNP in Chromosome 1 is in gene PPP2R3A
and the one in Chromosome 10 is between genes SAVl and NIN.

We further examined the correlations between the SNPs that are
selected from the same chromosome. The correlation matrices of
these markers presented in Supplementary Appendix C reveal de—
tected SNPs in most of the Chromosomes are weakly correlated.
Although, the correlation matrix for chromosome 3 shows two
markers closely link to each other. Hence, selecting those two
markers might be due to linkage disequilibrium.

5 Discussion

In 17 >> 71 problems, current variable selection and mixture priors
face problems in scaling to very large p when n in small relative to p.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

If) —!—
LLI h‘ T i
o. D _ : :
E '8. _ T I E
>' C’ _ :
o m .
E m. —
9 c:
I _.
9 If} I
“r. — ' l
D 1
| I |
Z—S-GDP 2-S~NIG Z-S-BL
c 8 — I . —1—
 d ' l
‘10 _
E
B '9 _ I
0. cs I
> _ I
D j I :
‘0 ' ' l
e % - 4 i =
CIJ C5 I _I—

 

 

 

I I I
2-s-GDP Z-S-NIG z-S-BL

Fig. 3. Top: box plot of MSPE obtained through 10-fold cross validation, bot-
tom: box plot of correlation between predicted and observed values in 10-
fold cross validation

Chromosome 1: ‘34.!73205-151273207
ﬂ 4 5:5 W

   
  

 

:-.-..
Dun 2mm.

 

 

 

 

Fig. 4. Location of two selected markers from chromosome 1 and 10

These problems include computational bottlenecks and insufficient
ﬂexibility. To solve these problems, multistage approaches have
been proposed, but not yet in the case in which the subjects under
study are related. We address this gap via new two—stage Bayesian
approaches that account for familial dependence. The method is a
hybrid of single marker and simultaneous analyses. In the first—stage,
we select a superset of the most promising SNPs by evaluating the
impact of each SNP individually while accounting for related sam—
ples. In the second stage, we simultaneously select and estimate the
parameters of the model by placing a GDP prior on the SNP coeffi—
cients, again accounting for relatedness.

Our simulation analyses revealed that two—stage—GDP improves
predictive performance in comparison to one—stage analysis when n
is too small relative to p. The computational cost of this proposed
approach also makes it feasible for large scale problems like GWAS.

In the real data analysis, we made a comparison among different
prior specifications in the second stage of analysis. This comparison
represented that two—stage—GDP performs better than two—stage—
t—priors and two—stage—BL. We then estimated breeding value for
protein yield based on two—stage—GDP. Although the prediction
accuracy was sufficient for the small sample size that we had, a
small proportion of phenotypic variation is explained by SNPs. In
problems that the sample size is not severely limited, splitting the
data in two subsets and applying each stage on a subset of data

9103 ‘01; JSanV uo sopﬁuv soc] ‘BIIIJOJIIBD JO 10151911111 {1 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂdnq 11101} pap1201umoq

3896

A. Yazdani and D. B. Dunson

 

(see for e.g. Wasserman and Roeder, 2009) may better recover this
missing heritability, which may also arise from interactions.

Acknowledgements

This makes use of data generated by INNOVAGEN Project. More informa-
tion about this project is available from http://centridiricerca.unicatt.it/dicdr—
centridiricerca/hiodna_2057. htmlfrdeLocaleAttr=en. First author thanks
Mohammad Shariati for his comments on this manuscript.

Conﬂict of Interest: none declared.

References

Armagan,A. et al. (2013) Generalized double pareto shrinkage. Statistica
Sinica, 23, 119—143.

Ba11,R.D. (2011) Experimental designs for robust detection of effects in gen—
ome—wide casecontrol studies. Genetics, 189, 1497—1514.

Beattie,S.D. et al. (2002) A two-stage Bayesian model selection strategy for
supersaturated designs. Technometrics, 44, 55—63.

Buckler,E.S. et al. (2009) The genetic architecture of maize ﬂowering time.
Science, 325, 714—718.

Cai,X. et al. (2011) Fast empirical Bayesian lasso for multiple quantitative trait
locus mapping. BMC Bioinformatics, 12, 211.

Carvalho,C.M. et al. (2009) Handling sparsity via the horseshoe. I. Mach.
Learn. Res., 5, 73—80.

Diabetes Genetics Initiative of Broad Institute of Harvard, MIT LUND
University, Novartis Institutes for BioMedical Research. (2007) Genome—
wide association analysis identiﬁes loci for type 2 diabetes and triglyceride
levels. Science, 316, 1331—136.

Fan,I. and Li,R. (2001) Variable selection via nonconcave penalized likelihood
and its oracle properties. I. Amer. Statist. Assoc., 96, 1348—1360.

Fan,I. and Lv,I. (2008) Sure independence screening for ultrahigh dimensional
feature space.I. R. Stat. Soc. Ser. B, 70, 849—8911.

Fruhwirth—Schnatter,S. and Wagner,H. (2011) Bayesian variable selection for
random intercept modeling of Gaussian and non—Gaussian data. In:
Bernardo,I.M. et al. Bayesian Statistics, 9, 165—200. Oxford University
Press, London.

Ghosh,I.K. et al. (2007) An introduction to Bayesian analysis: theory and
methods. Springer Science 86 Business Media, LLC, New York.

Gianola,D. et al. (2009) Additive genetic variability and the Bayesian alpha-
bet. Genetics, 183, 347—363.

Grifﬁn,I.E. and Brown,P.I. (2011) Bayesian Hyper—lasso with non—convex pen-
alization. Aust. NZ I. Stat., 53, 423—442.

Hoggart,C.I. (2008) Simultaneous analysis of all snps in genome-wide and
resequencing association studies. PLoS Genet., 4, e1000130.

Hoti,F. and Sillanpaa,M.I. (2006) Bayesian mapping of genotype >< expression
interactions in quantitative and qualitative traits. Heredity, 97, 4—18.

Huanga,H. et al. (2010) Bayesian approach to transforming public gene expres-
sion repositories into disease diagnosis databases. PNAS, 107, 6823—6828.

Ieffreys,H. (1961) Theory ofProhahility. Oxford University Press, New York.

Kang,H.M. et al. (2010) Variance component model to account for sample
structure in genome-wide association studies. Nat. Genet., 42, 348—354.

Kessler,D.C. et al. (2014) Learning phenotype densities conditional on many
interacting predictors. Bioinformatics, 30, 15 62—15 68.

Li,I. et al. (2011) The Bayesian lasso for genome—wide association studies.
Bioinformatics, 27, 516—523.

Meuwissen,T.H.E. et al. (2001) Prediction of total genetic value using
genomewide dense marker maps. Genetics, 157, 1819—1829.

Oliehoek,P.A. et al. (2006) Estimating relatedness between individuals in gen—
eral populations with a focus on their use in conservation programs.
Genetics, 173, 483—496.

Park,T. and Casella,G. (2008) The Bayesian lasso. I. Am. Stat. Assoc., 103,
681—686.

Paul,D. et al. (2008) Preconditioning for feature selection and regression in
high—dimensional problems. Ann. Stat., 36, 1595—1618.

Peng,B. and Amos,C.I. (2008) Forward—time simulations of nonrandom mat—
ing populations using simupop. Bioinformatics, 24, 1408—1409.

Shariati,M.M. et al. (2012) A two step bayesian approach for genomic predic—
tion of breeding values. BMC Proceedings, 6, 512. BioMed Central Ltd.

Stephens,M. and Balding,D.I. (2009) Bayesian statistical methods for genetic
association studies. Nat. Rev. Genet., 10, 681—690.

Tibshirani,R. (1996) Regression shrinkage and selection via the lasso. I. R.
Stat. Soc. Ser.B, 58, 267—288.

Wasserman,L. and Roeder,K. (2009) High dimensional variable selection.
Ann. Stat., 37, 2178.

Weedon,M.N. et al. (2008) Genome—wide association analysis identiﬁes 20
loci that inﬂuence adult height. Nat. Genet., 40, 5 75—5 83.

Wellcome Trust Case Control Consortium. (2007) Genome—wide association
study of 14 000 cases of seven common diseases and 3 000 shared controls.
Nature, 447, 661—678.

Zhang,C.H. (2010) Nearly unbiased variable selection under minimax con—
cave penalty. Ann. Stat, 38, 894—942.

Zou,H. and Hastie,T. (2005) Regularization and variable selection via the
elastic net.I. R. Stat. Soc. Ser. B, 67, 301—320.

9103 ‘01; 1sn8nv uo sopﬁuv soc} ‘21111011123 10 10151911111 {1 12 /310's12u1noip101x0"$0112u1101u101q//:d11q 111011 pap2o1umoq

