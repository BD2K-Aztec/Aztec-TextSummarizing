Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw490

Advance Access Publication Date: 27 July 2016
Applications Note

 

 

Sequence analysis

WALT: fast and accurate read mapping for

bisulfite sequencing

Haifeng Chen1, Andrew D. Smith1'* and Ting Chen1'*

1Molecular and Computational Biology, University of Southern California, Los Angeles, CA 90089, USA

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on April 18, 2016; revised on June 17, 2016; accepted on July 16, 2016

Abstract

Summary: Whole—genome bisulfite sequencing (WGBS) has emerged as the gold—standard tech—
nique in genome—scale studies of DNA methylation. Mapping reads from WGBS requires unique
considerations that make the process more time—consuming than in other sequencing applications.
Typical WGBS data sets contain several hundred million reads, adding to this analysis challenge.
We present the WALT tool for mapping WGBS reads. WALT uses a strategy of hashing periodic
spaced seeds, which leads to significant speedup compared with the most efficient methods cur—
rently available. Although many existing WGBS mappers slow down with read length, WALT im—
proves in speed. lmportantly, these speed gains do not sacrifice accuracy.

Availability and implementation: WALT is available under the GPL v3 license, and downloadable

from https://github.com/smithlabcode/walt.
Contact: andrewds@usc.edu or tingchen@usc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

DNA methylation is essential for many biological processes and is
found altered in a variety of human diseases (Bock, 2012).
Technological advances over the past decade have enabled whole-
genome bisulfite sequencing (WGBS), which has become the gold-
standard approach for studying cytosine (C) methylation due to its
ability to quantify methylation levels unambiguously for nearly all
Cs in mammalian genomes. Treatment with sodium bisulfite con-
verts each unmethylated C into uracil, which is reported as thymine
(T) in sequenced reads. The most computationally intensive step
analysis of WGBS data is to map reads to the reference genome. The
bisulfite conversion makes mapping more complicated, and each
data set typically includes hundreds of millions of reads.

In recent years, several mappers have been developed specifically
for reads from bisulfite sequencing, which we refer to here as ‘hisul-
fite reads’. These mappers use a variety of strategies. For example,
Bismark (Krueger and Andrews, 2011) converts every C in the reads
and the reference genome to T, then applies Bowtie (Langmead
et (11., 2009) to map the converted reads to the converted reference
genome. BSMAP (Xi and Li, 2009) builds a pre-compiled hash table

to minimize the cache-miss latency when searching possihle genome
positions for k-mers. BSMAP also applies a hitwise masking method
to efficiently count the number of mismatches for asymmetric con-
version of CﬂT. Existing tools are not fast enough to map a large
WGBS data set in a day using a single processing core. The challenge
in mapping bisulfite reads is derived from two related sources:
accommodating the asymmetric conversion of CﬂT, and the
reduced entropy of the alphabet (i.e. nearly 50% T). Here we pre-
sent WALT, a new mapper for bisulfite reads. WALT is faster than
existing methods, and has advantages in accuracy.

2 Methods

WALT employs periodic spaced seeds, originally described by Chen
et a1. (2009), to filter candidate mapping positions for each read.
Three spaced seeds (010) “‘, 0(010)  and 00(010)  are used to guar-
antee full sensitivity for two mismatches (Supplementary Table S1).
The ones (‘1’) in the spaced seeds indicate positions that must
match, while the zeros (‘0’) indicate positions that are not required
to match. The star (““’) indicates repeating of the 010 pattern until

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

 

Supplcnicntar) Fig. 52

Su pplcmcnta 1‘} Table 513

Supplcnicntar) Fig. 51 Figure 1
Supplementar) Table 512

Supplementar) 1\1L1tcrial

Supplcnicntar) 1\1L1tcrial
Fortin (7/ LIL, 2014
Yong-Villalolms (7/ LIL, 2015

Table 1

Mach (7/ LIL, 2010

/310'S[BIIJDO[pJOJXO'SOTJBLUJOJIITOTq/ﬂdnq

WALT

 

otherwise false negative (FN). For a read found to be ambiguously
mapped or unmapped, if the bisulfite mapper reports it as such it
counts as TN, otherwise FP. We then compute precision and recall
for each mapper:

Recall : TP/(TP + FN) and Precision : TP/(TP + FP).

WALT had the best precision while BSMAP had the best recall
on all datasets (Table 3). Bismark had the lowest recall and preci—
sion. BSMAP reported 27 and 293% more incorrect uniquely
mapped reads than WALT in single— and paired—end mapping,
respectively.

Acknowledgement

We thank Benjamin Decato and Meng Zhou for valuable comments.

Funding

This work was partially supported by National Institutes of Health grant
HG006015 (ADS)

Conﬂict ofInterest: none declared.

References

Bock,C. (2012) Analysing and interpreting DNA methylation data. Nat. Rev.
Gen., 13, 705—719.

Chen,Y. et al. (2009) PerM: efﬁcient mapping of short sequencing reads with
periodic full sensitive spaced seeds. Bioinformatics, 25, 2514—2521 .

Fortin,].P. et al. (2014) Functional normalization of 450k methylation array
data improves replication in large cancer studies. Genome 3101., 15, 503.

Hach,F. et al. (2010) mrsFAST: a cache-oblivious algorithm for short-read
mapping. Nat. Methods, 7, 5 76—5 77.

Krueger,F. and Andrews,S.R. (2011) Bismark: a ﬂexible aligner and methyla-
tion caller for bisulﬁte-seq applications. Bioinfonnatics, 27, 1571—1572.

Langmead,B. et al. (2009) Ultrafast and memory-efﬁcient alignment of short
DNA sequences to the human genome. Genome 3101., 10, R25.

Xi,Y. and Li,W. (2009) BSMAP: whole genome bisulﬁte sequence MAPping
program. BMC Bioinformatics, 10, 232.

Yong-Villalobos,L. et al. (2015) Methylome analysis reveals an important role
for epigenetic changes in the regulation of the Ambidopsis response to phos-
phate starvation. P705. Natl. Acad. Sci. USA, 112, E7293—E7302.

/3.IO'S[BIImOfp.IOJXO'SOTJBLUJOJIITOTq/ﬂdnq

