Bioinformatics, 32115), 2016, 2297—2305

doi: 10.1093/bioinf0rmatics/btw156

Advance Access Publication Date: 29 March 2016
Original Paper

 

 

Structural bioinformatics

HLaffy: estimating peptide affinities for Class-1
HLA molecules by learning position-specific pair
potentials

Sumanta MukherieeI, Chiranjib Bhattacharyya2 and
Nagasuma Chandra3'*

11180 Mathematics Initiative, Indian Institute of Science, Bangalore, India, 2Department of Computer Science and
Automation, Indian Institute of Science, Bangalore, India and 3Department of Biochemistry, Indian Institute of
Science, Bangalore, India

*To whom correspondence should be addressed.
Associate Editor: Anna Tramontano

Received on September 30, 2015; revised on February 12, 2016; accepted on March 3, 2016

Abstract

Motivation: T—cell epitopes serve as molecular keys to initiate adaptive immune responses.
Identification of T—cell epitopes is also a key step in rational vaccine design. Most available methods
are driven by informatics and are critically dependent on experimentally obtained training data.
Analysis of a training set from Immune Epitope Database (IEDB) for several alleles indicates that
the sampling of the peptide space is extremely sparse covering a tiny fraction ofthe possible non—
amer space, and also heavily skewed, thus restricting the range of epitope prediction.

Results: We present a new epitope prediction method that has four distinct computational mod—
ules: (i) structural modelling, estimating statistical pair—potentials and constraint derivation, (ii)
implicit modelling and interaction profiling, (iii) feature representation and binding affinity predic—
tion and (iv) use of graphical models to extract peptide sequence signatures to predict epitopes for
HLA class I alleles.

Conclusions: HLaffy is a novel and efficient epitope prediction method that predicts epitopes for
any Class—1 HLA allele, by estimating the binding strengths of peptide—HLA complexes which is
achieved through learning pair—potentials important for peptide binding. It relies on the strength of
the mechanistic understanding of peptide—HLA recognition and provides an estimate of the total
ligand space for each allele. The performance of HLaffy is seen to be superior to the currently avail—
able methods.

Availability and implementation: The method is made accessible through a webserver http://pro
Iine.biochem.iisc.ernet.in/HLaffy.

Contact: nchandra@biochem.iisc.ernet.in

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 lntroductlon exhibit variations in their peptide binding pockets (Murphy et (11.,

Recognition of short peptides by HLA molecules is a fundamental 2007) so that each allele preferentially binds a distinct subset of pep-
requirement for triggering T-cell responses. HLA genes are highly tides. In an individual, cells expressing up to six different alleles are
polymorphic forming hundreds of different alleles (Sette and Sidney, present, each capable of recognizing a large number of peptides.
1999), The alleles understandably have a common scaffold and Such multi-specificity enables them to recognize a wide array of

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2297

/310‘srcumo[p10}xo‘sopcuHOJHtotq/ﬁdnq

2298

S.Mukherjee et al.

 

potential antigens from pathogenic organisms and other sources.
The most preferred length of the peptide is 9 amino acids, although
peptides with 8—10 amino acids, are also recognized in some cases
(Hewitt, 2003). The number of possible nonameric peptides that are
theoretically possible is as high as 512 billion. Experimental identifi—
cation of such a large repertoire of epitopes for each allele is virtu—
ally impossible, making it important to have reliable and accurate
methods for predicting epitopes for different alleles. The need for
powerful methods to predict potential epitopes has become even
more important as hundreds of bacterial and viral genomes have
been sequenced, increasing the need for understanding their antige—
nicity profiles.

A number of methods have been developed for predicting T cell
epitopes over the last two decades (Lundegaard et al., 2010). They
can be broadly divided into four classes, as methods based on: (i) se—
quence motif detection, (ii) empirical scoring matrices and profiles
implicitly encoding more complex sequence patterns, (iii) machine
learning algorithms applied to experimentally determined data and
(iv) structure—based methods. The motif methods are the first to be
developed among all the prediction methods and are based on the
identification of preferred amino acid residues at different positions.
Some positions which were identified as heavily contributing to rec—
ognition were termed ‘anchor residues” in the nonameric peptides
(Hobohm and Meyerhans, 1993). The motifs or patterns describing
the positions of the anchors and the residue preferences were derived
for different alleles (Rammensee et al., 1999). Anchor motifs have
been used to search for antigenic regions in sequences of infectious
viruses, bacteria and parasites. The amino acid preferences in these
motifs however turn out to be an insufficient criteria for recognition,
leading to prediction accuracies of only about 70%. Although an—
chor residues contribute significantly to the HLA—peptide binding,
large scale analysis of experimental data have shown that other resi—
due positions on binder peptides contribute equally in stabilizing the
peptide—HLA complex. Consequently new scoring matrices were
derived by analyzing experimentally measured binding affinities for
hundreds of different peptides to each allele (Parker et al., 1994).
However, these methods assume that the contribution of different
residues were independent of each other and most models were addi—
tive in nature.

Data—driven methods were developed to utilize available large—
scale experimental data. One such approach is regression analysis
that estimates the response function, which in this case is binding af—
finity, from a given set of data and response variables, generally
using a polynomial function. Regression analysis based methods
were used to obtain quantitative prediction in terms of half lives of
dissociation of ﬁ—microglobulin from the HLA complex. Other ma—
chine learning (Lundegaard et al., 2008; Peters and Sette, 2005;
Roomp et al., 2010) and QSAR approaches (Doytchinova et al.,
2004) that have been attempted include artificial neural networks
and hidden Markov models that correlate measurable properties of
different peptides with their binding potential.

Approaches that use explicit structural information in general
are believed to provide detailed insights into the process of peptide
recognition, thereby resulting in more accurate predictions.
However, progress in this direction has been very slow, primarily be—
cause structural modelling is a computationally intensive process,
rendering it feasible only on a small scale (Kumar and Mohanty,
2007; Schueler-Furman et al., 2000). More recently, a method based
on molecular dynamics simulations and estimation of free energy of
binding between peptide and HLA molecules has been attempted
(Yanover and Bradley, 2011). The applicability of this method is
seen to be limited due to the amount of time each simulation

requires. Methods that indirectly capture structural information
have also been used, which show reasonable prediction accuracies
(Hoof et al., 2009; Lundegaard et al., 2008).

This work introduces a new method HLaffy, for prediction of
peptide HLA binding affinity. The method stands on the strength of
a mechanistic model of peptide—HLA recognition. Distinct advan—
tages of this method are: (i) it uses structural information explicitly,
(ii) it samples the naturally occurring peptide space in bacteria and
viruses systematically and hence is not restricted by available experi—
mental data, (iii) it assigns weights to different interactions and
through that, it identifies important pair potentials and (iv) it uses a
graphical model to represent the epitope pool efficiently. The
method is implemented on a webserver, made accessible at http://pro
line.biochem.iisc.ernet.in/HLaffy/.

2 Methods

2.1 Datasets

The list of 2010 HLA class—1 alleles was obtained from
ImMunoGeneTics database (IMGT) (Robinson et al., 2013). For 43
of these alleles, information about peptides they recognize along
with their individual binding strengths, was obtained from IEDB
(Vita et al., 2010). Similar but independently curated data for HLA—
peptide association for 32 alleles is available from MHC Binding,
Non—binding peptide database (MHCBN) (Bhasin et al., 2003).
Only those unique to MHCBN were taken for validation purposes.
Crystal structures of 21 different alleles as complexed with their re—
spective peptides are available from PDB (Berman et al., 2000).

2.2 Implementation and web—server

Affinity estimation and peptide ranking modules are computation—
ally intensive, and are therefore implemented in C++. Publicly
available GLPK library is used for solving linear optimization.
Eigen3 library is used for linear algebraic operations and solving the
graphical model (http://eigen.tuxfamily.org). The prediction tool is
made publicly available at http://proline.biochem.iisc.ernet.in/
HLaffy.

The HLaffy suite involves four core modules. Figure 1 shows
the different computational steps involved in these processes and
their logical dependencies. (i) Structural modelling of z 16 000 com—
plexes from a dataset of experimentally determined peptides, fol—
lowed by computation of statistical pair—potentials. (ii) Design of a
representative peptide library and obtaining allele specific inter—mo—
lecular residue—residue contact profiles. (iii) Implicit modelling of
peptide binding modes and feature extraction and binding affinity
estimation. (iv) Deriving a graphical model for each allele, and 0b—
taining a sequence profile of the predicted set of high—affinity
epitopes.

2.3 Structural modelling of peptide—HLA complexes

This computational module includes three distinct steps: (i) obtain—
ing a dataset of known peptides, (ii) molecular modelling and (iii)
computing statistical contact potentials. First, a set of z 16 000 ex—
perimentally known peptides with respective HLA alleles was ob—
tained from the IEDB database. Peptides with binding affinities
S 500 nM are considered to be strong binders. Models of HLA—
molecules are built using homology modelling (Sali and Blundell,
1993). In Class—1 HLA molecules, the peptide binding groove is
closed at both ends and narrow, thereby restricting conformational
flexibility for the bound peptides. Structural superposition of nona—
meric bound peptides obtained from the PDB shows high

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

claL,2009

claL,2008

Van Der Spool cl al., 2005

Implicit Strncl re Modeling:

[SK .r. uwalrmg—.

Stntlstlcal Palr Potential
n Eululh'nn

II E-(lull'rall I contBCt
Pair-Potential
- y Fill-aw maﬁa.

Graphical Model

HLA Specific
2D Logo low—AI

Strong Binders

Krivov

Hess

HLaffy Binding Affinity Prediction Sult '

Interaction

9 W
prediction

[0'91 unlith

 

/810'sreumofp1o1xo'sopeuiJOJutotq”:dnq

2300

S.Mukherjee et al.

 

factorized into a set of circular permutation groups. Groups are ab—
stract algebraic structures. It refers to a finite/infinite set of elements
that satisfies closure, associativity, identity property and inverse
property. Permutation groups consist of elements corresponding to
permutations of all elements of a given set M. Permutation groups
are written as

1 2 3 . . . n
(2)
(0(1) 0(2) 0(3) ... 0(n)>

where 0(i) is a corresponding permutation map of position i. A cir—
cular permutation generates the element permutation map as
0(i) : (i + k) mod n, denoted by IP’ZJZ, where k is a number between
0 to n, n being the number of elements the set contains. 0 refers to
an identity permutation. Due to the group property IP’ZJ,‘ >< IP’ZJZ/
6 P2,. All possible tuples can be factored as S X S : Uk:om)s)
{S'IP’TSHZ}. The ' operator defines concatenation of two fields, gener—
ating a tuple. It must be noted that, in case of a prime value of n, the
tuple set generated by this process is non—overlapping and covers the
entire tuple set. Therefore, S-IP’;.k1-IP’;J,2- . . . 11);,“ , defines a (p + 1)—
length peptide sequence. Right from the very first sequence position,
for any two positions 1' and j in the sequence, the sequence permuta—
tion can be given as PTSWZHZA. In order to efficiently explore the pep—
tide nonameric sequence space, character sets were extended to
prime number cardinality by repeating naturally frequently occur—
ring amino acid residues. The peptide library generator sequence is
then given as

IP20 ' Fiﬁ ' IP22 '  ' IP24;
IPitJ .  .  .  . 1P>:t.(2[7+1)modn

71.571—6 .  . 1P>rt.(([7+71)n—(ijrl))modn
(3)

IP> IP> IP>

n.n—2 n.(2n—4)modn

The design steps are explained in Algorithm 1. ‘A’ refers to set of
all possible amino—acids. The design reports a matrix of size
m2 X (m + 1), m being the size of the character set used for the de—
sign. As per this design, all possible amino acid pairs between any
two positions are explored. This design strategy can generate a pep—
tide library of maximum sequence length m which is same as the
length of the character set. Permutation of the columns in any order
will generate a new set of peptide sequences, still satisfying the
paired exploration condition. The generator described in Eq. 3 gen—
erates a compressed peptide library, ensuring that at all possible pos—
ition pairs of the sequence, all possible binary aminoacid tuples have
occurred atleast once. With a minimum redundancy of two for 20
naturally occurring amino—acids, and for 9 length peptide sequence,
the size of this peptide library is 1012.

2.6 Implicit structure prediction

The previous section is restricted to z 16 000 peptide—HLA com—
plexes whose structures were explicitly modelled. However, in real—
ity, the number of complexes was not restricted to these 16 000, but
may run into several billions. Explicit structural modelling is a com—
putationally intensive step. A faster approximation of inter—residue
contact patterns is therefore necessary. To address this, a linear opti—
mization problem was framed. For a given peptide—HLA pair, the
interaction profile is estimated by choosing weights any that maxi—
mize the contact potential by using the statistical pair potentials

(CPP). Bounds on the selection of co); incorporates structural restric—
tion information.

Irzi/a/x Z 601;; * “(010707 “(171”

N
Subjectedto : 0 3 co); 3 6),;(oc(pi))Vi,/'

Zak]. S H/inaxvl-
i

2602:; S Pimx(“(l7i))Vi
1'

where
“(07 0)
represents the CPP, as obtained from Eq. 1.
621/0070) H)“
and
Pimx(0<(z7i))

represent the geometric constraints for each peptide—HLA residue
pair interaction, cumulative HLA and peptide residue interactions
respectively. An accurate estimate of these geometric constraints
was obtained by detailed modelling of each peptide—HLA complex
from the RPL (Section 2.3).

2.7 Feature representation and binding affinity
prediction

The half maximal inhibitory concentration (I C50) is a measure of ef—
fective concentration of a substance required to inhibit a particular
biological function. The I C50 measure for peptide—HLA complex is
often used as a yard—stick for evaluating binding strength of an anti—
genic peptide. At a very low concentration a log(IC5o) value closely
estimates the Gibbs free energy (AG) associated with the binding.
The Gibbs free energy associated with the physical binding process
has enthalpic and entropic components. These energy contributions
arise due to the network of inter—atomic interactions. Thus the change
in Gibb’s free energy of binding (AG) should be a function of all pos—
sible atomic interactions at the molecular interface. Implicit structural
modelling explained in Section 2.3 yields atomic contact patterns at
the peptide interface. These molecular interaction patterns are used
to define feature representations. Earlier studies have shown that lin—
ear classifiers show poor performance in predicting strong HLA—bind—
ing peptides. The exact functional form of the dependencies between
different variables are not known. To capture the non—linear nature
of the function, Gaussian process regression methods were used.

A Gaussian process defines a ‘prior’ over functions, which are
later converted to a ‘posterior’ over functions on observation
(Rasmussen and Williams, 2006). A Gaussian process for regression
resembles the k—neighbourhood predictor, but it provides much
more smooth and stable prediction with standard error estimates.
Neighbour information is encoded in terms of a kernel function (K).
Kernel functions are positive definite and commutative in nature. A
squared exponential kernel, Ic(x,x’) : 0%exp(—d(’;gxlI), was used in
this study. A Gaussian process assumes that the response variable
follows a Gaussian distribution over the observations. For a given
set of observations X : {x1,x2, . . . ,xn} and their reported response
value y : {311,312, . . . ,yn}, it writes the joint probability distribution

 

ﬁm'srcumol‘pquo'sopcuuowtotq/ﬁdnq

HLaffy: peptide HLA affinity prediction

2301

 

as a Gaussian distribution with zero mean and covariance matrix.
Covariances are estimated using a kernel function. Thus for a new
observation (,7 t), the distribution is given as

m > 

This property of Gaussian distribution, enables the estimation of
the value for the new observation as ytly ~ N(K*K‘1y,K*.*K‘1K;I-).
The evaluation of the inverse of the covariance matrix is computa—

K KI
K* K*,*

 

 

tionally intensive. The Covariance matrix is a positive definite ma—
trix in nature. The computational intensive step of computing the
inverse is averted by use of ‘Cholesky decomposition”.

This module estimates I C50 values for each implicitly modelled
complex. The total energy estimate for the system can be approxi—
mated as an individual contribution by electrostatic, van der Waals
and solvation energy terms. Earlier studies have explored linear
models and have found the prediction accuracy to be low (Lafuente
and Reche, 2009). Therefore, a non—linear Gaussian process regres—
sion scheme is used, with a square exponential kernel.

2.8 Graphical models and representation of epitope
pools
The Regression model described in the previous section estimates
the binding affinity. The predicted affinity provides a basis for clas—
sifying peptide sequences into binder and non—binder classes. This
decision is threshold based. 500 nM is considered as a cut—off for
strong binder peptides. Regression model is non—linear in nature,
and does not provide insight into the mechanistic understanding of
the process of binding. A graphical model representation is used to
gain an insight to the nature of antigenic peptide sequence profiles.

Graphical models express the positional dependency among pep—
tide residue positions. A probabilistic graphical model (PGM) is a
tool that helps to represent the conditional dependence structures
among random variables, for probabilistic inference for modelling
problems involving many variables. PGM defines a unique factor—
ization of random variables. In a PGM, factorization is a process of
presenting joint probabilities for Bayesian inference, in terms of
multiplication of conditionally independent joint probabilities of
factor graphs as P(X1,X2, . . . ,Xn) : Hidmn P(X,-Irt(X,-)), where X,
represents each random variable in the process and TE(X,‘), represents
its parent nodes. Each sequence position of the nonameric sequence
is modelled as a discrete random variable, which takes a value be—
tween {1 . . .20}, corresponding to 20 distinct amino acids. For the
appropriate factorization scheme, the dependence structure among
the variables must be known. Chow-Lia algorithm has been used to
extract the dependency structure between the random variables
(Chow and Liu, 2006). This algorithm uses mutual information be—
tween all pairs of variables. Mutual information (MI) content be—
tween two variables describes the extent of dependence between two
variables. The variables with strong correlation show a high value
for mutual information content, while a zero value represents inde—
pendence between the variables. Chow-Lia algorithm poses the
structure determination problem as a two clique problem. It reports
a maximum weighted (based on MI content) spanning tree that cap—
tures dependencies between different variables. The MI is evaluated
from a set of strong binder epitope sequences, as predicted by the
non—linear predictor from a pool of a large set of naturally occurring
sequences.

The basic assumptions associated with the Chow-Lia algorithm
are: (i) it cannot handle missing data, (ii) variables are discrete and
(iii) data is independently and identically distributed.

3 Results and discussion
3.1 Contact based pair potential (CPP)

The workﬂow used in this study is illustrated in Figure 1. Since experi—
mental binding affinities are available only for 16 450 peptide—HLA
pairs, covering 43 alleles, three dimensional structures of these com—
plexes were modelled (Supplementary Material). For each complex, a
contact matrix is computed by counting number of different residue—
pairs involved in interactions between peptide (17,) and HLA (10,) resi—
dues. The frequency of occurrence of such residue—pairs in all com—
plexes are then combined to derive a contact pair—potential(CPP).
Figure 2 illustrates the CPP matrix, which indicates observed prefer—
ences of the 20 amino acids in the peptide (in rows) and in different
HLA alleles (in columns). Higher preference for arginine and lysine of
the peptides interacting with aspartic acid of the HLA molecule and
similarly tyrosine of the peptides interacting with asparagine of the
HLA molecule are clearly seen. Figure 2 illustrates the contact potential
for all residue—combinations. Conserved residues in the HLA molecules
such as the tyrosine can also be seen to interact with several amino acid
types in peptides. The derived matrix is asymmetric unlike those for
protein—protein interactions and also shows specific residue biases.

3.2 Interaction profiles for each allele

A second line of input that is required for affinity prediction is allele—
specific interaction information. 57 different residues form the binding
site. Of these it is well known that, at least 21 positions vary signifi—
cantly across alleles. Therefore the interaction profiles for individual
alleles will provide a more accurate picture of the nature and affinity
of the peptides it can recognize. Experimental information about the
peptide ligands is not available for all alleles. A representative peptide
library was first designed. The library was designed with a goal of (i)
covering all possible tuples in the peptide size and (ii) covering inter—
actions of all possible residue—pairs between the peptide and the HLA
molecules. The representative peptide library (RPL) consisting of
1012 peptides was generated (Supplementary Material). For each al—
lele, a complex was modelled with each peptide in the RPL, ultimately
yielding 2010 X 1012 complexes. The number of polar and non—polar
contacts were calculated in each case and summarized over each allele
to output a 57 X 20 X 9 matrix. From this, the contact range statistics
for each allele are derived and the maximum values in the range serve
as bounds or structural constraints for the next step in the workﬂow
(Fig. 1). The bounds derived for one sample allele each in the A, B
and C loci is shown in Figure 3. The figure shows the strength of inter—
action for each residue—pair between the two molecules, for example
alleles. Similar figures can be obtained for all alleles through an inter—
active query using the web—resource http://proline.biochem.iisc.ernet.
in/HLaffy. On an average a binding site residue in the HLA molecule
is seen to interact with four peptide residues and ranges from one to
six depending on its position. Similarly, the number of HLA residues a
peptide residue can interact with is decided by its position on the pep—
tide. The HLA bound peptide conformation is generally seen to have
a central bulge, because of which residues P4 and P5 have fewer inter—
actions restricting the number of contacts to three, whereas for P2 and
P9 positions, which serve as anchor residues, interactions with six resi—
dues on an average are observed. P1 and P8 residues are also located
deep inside the grooves, consistent with a higher number of hydropho—
bic interactions as compared to those in the middle of the peptide.

3.3 Implicit interaction modelling to cater to any
peptide—HLA complex

The previous section provides information about allele—specific
interaction profiles, computed from explicit structural models of 16

ﬁm'srcumol‘piqxo'sopcuuowiotq/ﬁdnq

 

mus—....mmoﬁ at:

 
 

._

lllllll_
llllllllll.
llllllllll
llllllllll
EIIIIIIIIII
llulnlllI-I
Illlllllll
lllllllllI-
Illlllllll_
lllllllnlll
Illlllllll
llllllllll,
llllllllll
llllllllﬂll
llllllllll
Illlllllﬂl.
llﬂlllﬂll'l
Illlllllll
IEEIIIIIEI
Illlllllll,
llllllllll,
Illlllllﬂ'l
llllllllﬂl-
Illlllllll.
llllllllDll
Illlllllll_
llllllllll-
llllllllll.
Illlllllll
lﬂlﬂlllll'l
Illlllllll,
nﬂlllllllll
lllﬂllllll.
DIIIIIIIIII
Illlllllll
llllllllll.
Illlllllll
llllllllll
Illlllllll_
llllllllll
Illlllllll.
IDIIIIIIIII

Figure 3

Fig. 4

Supplementar) l\4aterial

Figure 4b

supplementar) material

Supplementar) l\4aterial

Roomp (71 al.,
2010

ROC curve ior different peptide HLA binding predictor

Experimental vs Predicted ICED

 

/310'S[Bu1n0prOJXO'SOIIBLUJOJIIIOICI”Idllq

an?kgogmomammowoio~&o:3m7.omm\

*02:02

1
a

C.

.02

B’I‘OT'

 

HLaffy: peptide HLA affinity prediction

2305

 

Robinson,]. et al. (2013) The imgt/hla database. Nucleic Acids Res., 41,
D1222—D1227.

Roomp,K. et al. (2010) Predicting MHC class I epitopes in large datasets.
BMC Bioinformatics, 11, 90.

Sali,A., and Blundell,T.L. (1993) Comparative protein modelling by satisfac-
tion of spatial restraints. ]. Mol. Biol., 234, 779—815.

Schueler-Furman,O. et al. (2000) Structure—based prediction of binding pep-
tides to MHC class I molecules: application to a broad range of MHC al-
leles. Protein Sci., 9, 1838—1846.

Sette,A. and Sidney,]. (1999) Nine major HLA class I supertypes account for
the vast preponderance of hla-a and -b polymorphism. Immunogenetics, 50,
201—212.

Van Der Spoel,D. et al. (2005) Gromacs: fast, ﬂexible, and free. ]. Commit.
Chem., 26,1701—1718.

Vita,R. et al. (2010) The immune epitope database 2.0. Nucleic Acids Res.,
38, D854—D862.

Yanover,C. and Bradley,P. (2011) Large-scale characterization of peptide-
MHC binding landscapes with structural simulations. Proc. Natl. Acad. Sci.
U. S. A., 108, 6981—6986.

/810'sieumofp1oixo"soueuuoguioiqﬂ:duq

