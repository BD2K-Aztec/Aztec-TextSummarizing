APPLICATIONS NOTE

Vol. 29 no. 8 2013, pages 1083-1085
doi:1 0. 1093/bioinfonnatics/bt1090

 

Gene expression

Advance Access publication February 21, 2013

DeconRNASeq: a statistical framework for deconvolution of
heterogeneous tissue samples based on mRNA-Seq data

Ting Gong* and Joseph D. Szustakowski

Biomarker Development, Translational Medicine, Novartis Institutes for BioMedical Research, Cambridge,

MA 02139, USA

Associate Editor: lvo Hofacker

 

ABSTRACT

Summary: For heterogeneous tissues, measurements of gene expres-
sion through mRNA-Seq data are confounded by relative proportions
of cell types involved. In this note, we introduce an efficient pipeline:
DeconRNASeq, an R package for deconvolution of heterogeneous
tissues based on mRNA-Seq data. It adopts a globally optimized
non-negative decomposition algorithm through quadratic program-
ming for estimating the mixing proportions of distinctive tissue types
in next-generation sequencing data. We demonstrated the feasibility
and validity of DeconRNASeq across a range of mixing levels and
sources using mRNA-Seq data mixed in silico at known concentra-
tions. We validated our computational approach for various bench-
mark data, with high correlation between our predicted cell
proportions and the real fractions of tissues. Our study provides a
rigorous, quantitative and high-resolution tool as a prerequisite to
use mRNA-Seq data. The modularity of package design allows an
easy deployment of custom analytical pipelines for data from other
high-throughput platforms.

Availability: DeconRNASeq is written in R, and is freely available at
http://bioconductor.org/packages.

Contact: tinggong@gmail.com

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 30, 2012; revised on January 22, 2013; accepted on
February 18, 2013

1 INTRODUCTION

High-throughput next-generation sequencing (NGS) technolo-
gies are becoming quickly established in biomedical research
and discovery (Huang et al., 2011). NGS-based sequencing of
mRNA (referred to as mRNA-Seq) offers several potential ad-
vantages over microarray-based methods (Haas and Zody, 2010;
Tang et al., 2009). Heterogeneous tissues are frequently collected
(e.g. blood, tumour, etc.) from humans or model animals (Zhao
and Simon, 2010). Therefore, mRNA-Seq samples are often het-
erogeneous with regard to those cell types, making it difﬁcult to
distinguish gene expression variability that reﬂects shifts in cell
populations from variability that reﬂects change of cell-type-
speciﬁc expression (Kuhn et al., 2011).

Recently, we have described the deconvolution of microarray
data from complex samples such as blood samples collected in a
clinical trial (Gong et al., 2011). Quon and Morris (2009)

 

*To whom correspondence should be addressed.

described a probabilistic framework to address the similar prob-
lem using high-throughput sequencing. Their approach requires
strong assumptions about the distributions of gene abundance
and is not able to generate per-sample estimates of tissue or cell
abundance. mRNA-Seq data are inherently different than micro-
array data, which are able to give the more reﬁned information
necessary to tackle the deconvolution problem; we therefore ex-
pected that these methods need to be updated and re-validated.
However, transferring the approach of microarray data into a
robust analysis pipeline is an inherently study-speciﬁc task and
poses ongoing challenges. Although mRNA-Seq is promising, it
is widely accepted that many factors could introduce variation
and bias to mRNA-Seq data. Therefore, proper pre-processing
methods are needed to de-noise and ﬁne-tune the mRNA-Seq
data before they are used in downstream deconvolution. In light
of these considerations, we have developed DeconRNASeq, an
R/Bioconductor-based pipeline for constituent fraction estima-
tion and quality assessment of deconvolution on mRNA-seq
datasets.

Here, we describe the DeconRNASeq package that encapsu-
lates the method in a convenient-to-use format. DeconRNASeq
is based on a linear model of a sum of pure tissue- or
cell-type-specific reads of all cell types, weighted by the respective
cell-type proportions. To estimate the proportions of known
tissue types in a sample, DeconRNASeq solves a non-negative
least-squares constraint problem with quadratic programming to
obtain the globally optimal solution for estimated fractions.
Results from mRNA-Seq data described here demonstrate that
our method is able to accurately predict mixing fractions for
multiple species of tissues or cells. Using the mixing samples
containing relatively rare cell types (52%), we show that correl-
ation coefficient between the estimate proportions and the true
proportions can reach 0.9754. In principle, DeconRNASeq is
also applicable to other types of proﬁling data from heteroge-
neous samples. For example, the same approach could be used to
track species in metagenomics data (Knights et al., 2011) or
DNA contamination in tumour samples (Cibulskis et al., 2011).

2 METHODS

Figure 1a depicts the workﬂow of our transcriptome quantiﬁcation and
deconvolution pipeline. Given the information of the short-read align-
ment, followed by transcript quantiﬁcation, we apply a statistical ap-
proach to model expression from a mixed cell population as the
weighted average of expression from different cell types. We solve these
equations using quadratic programming, which efﬁciently identiﬁes the

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 1083

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

9103 ‘Og anﬁnv uo ::

T.Gong and J.D.Szustakowski

 

 

Elma-uh
Read alignment 1
has IIignn—il

Transcript quar‘iliiicatlnn I I

'Iu‘mrrnna- n arr-unm. unnaun

(d)

Mum-munch."

 

  

 

   

"mm-q;me unanim- “grammqu

- .,.-"Cell Dewnuolutinn :I

 

fluari'lell Iranian

 

// (e)

 

WNKIMHIJ!

  

 

 

 

 

 

 

 

 

(a) ’ ‘kiﬁ'ﬂxloi‘vU' “ '
g}? / g3? / :5:
:13? . ' £33 if ('1
Ii: _/' E: E: '
lb) (3)

Fig. 1. (a) The workﬂow of our transcriptome deconvolution analysis
pipeline for mRNA-Seq data. The preprocessing steps include short-read
alignment onto a reference genome, followed by transcript quantiﬁcation.
A nonnegative least-squares constraint problem is solved by quadratic
programming to obtain the globally optimal solution for estimated frac-
tions of known tissue types in a sample. (b—f) Statistical deconvolution of
mRNA-Seq yields accurate estimates of pure tissue fractions for multiple
tissues. Plotting of estimated proportions (y axis) vs. actual proportions (x
axis) shows strong congruity for brain (b), muscle (0), lung ((1), liver (e)
and heart (f) tissues. Each green dot represents a sample

globally optimal solution while preserving non-negativity of the fraction
of the cells. Consequently, we can accurately estimate the fractions of
various cell populations. The details are described as follows.

DeconRNASeq requires input in the form of two R data frames that
contain normalized transcriptional measurements from pure tissues (S)
and the heterogeneous samples (X) to be analysed respectively. The gene
was used as the expression unit in our example, although the method-
ology can be extended to transcripts or exons, provided the quantiﬁcation
of their expression is properly obtained.

More speciﬁcally, the expression level xjk of gene j in a sample k is the
average of expected expression levels across the cell types Si, weighted by
the respective cell-type proportions ak, (i = 1 . . . N, N: the total number of
cell types):

1v
Xjk = Zi21aki.s,-j 

Or more generally, we represent the above equation in matrix form as:
X=AS. (2)

Here, X denotes the observed mixture gene expression matrix (genes
by samples). S, the signature matrix derived from the training data
(homogeneous samples), gives the tissue-type-speciﬁc gene expression
proﬁles (genes by tissue types), and A, the proportion matrix, is the
quantity to estimate tissue proportions over samples (tissue types by sam-
ples). We solve this weighted non-negative least squares problem for each
gene by

Zak,- =1

aki Z 0, Vi

minAui AS — X “2). s.t.{ (3)
where the coefficient ak, is a scalar parameter between 0 and 1 to represent
the fraction of tissue type. The formulation can then be efﬁciently solved
by quadratic programming (Bertsekas, 1999; Mackey et al., 1996).

3 RESULTS

To systematically examine the accuracy of our deconvolution
algorithm, we designed several in silico mixing experiments that
made use of mRNA-Seq data from Illumina’s Human BodyMap
2.0 (generated on a HiSeq 2000) [GSE30611] to generate
tissue-speciﬁc transcriptional proﬁles (Training Data). In silica
mixed data were simulated using Pan et al.’s (2008) data, with
disparate proportions drawn from random numbers. The mixing
proportions used by each type of tissue are shown in
Supplementary Table S4. It should also be noted that we inves-
tigated the inﬂuence of extremely low fractions of contaminating
cell types (<2%). More experiments including the deconvolution
of biologically related cell population can be found in
Supplementary Material.

We estimated the number of expression signatures (genes)
through the condition number of the signature matrix (see
Supplementary Sections 3.2 and 3.3 for its detailed derivation).
Consequently, we seleted first 1570 genes that consist of the sig-
natures for the ﬁve tissues and deconvoluted the data (refer to
the Supplementary Section 3.3 for the validation of the ‘optimal’
number of expression signatures in terms of condition number).
The results are shown in Figure 1(bif), with correlation coefﬁ-
cient between the estimation and the real frations 20.9754.
Reassuringly, our algorithm was able to accurately predict the
level of mixing across a wide range of proportions including
multiple pure sources for mRNA-Seq data.

4 CONCLUSION

We have introduced a statistical workﬂowiDeconRNASeqito
estimate proportions of tissue or cell types by incorporating
tissue-type-specific genes. Simulations show that our deconvolu-
tion analysis accurately detects expression heterogeneity and
assesses proportions of multiple tissue types in newly advent
NGS platform. The main objective of our work is to develop
comprehensive and ﬂexible deconvolution software effectively
applicable to expression proﬁling experiments. Thereby, it is
worth noting that the algorithmic items are shared with our pre-
vious work (Gong et al., 2011) and can also be applied to micro-
array data. However, microarray data require appropriate
normalization and other pre-processing methods as described
in Gong et a]. (2011). The independent proﬁle-generating
module in DeconRNASeq grants great freedom to users, who
can combine with other R or Bioconductor packages to perform
upstream and downstream analysis of NGS data.

ACKNOWLEDGEMENTS

The authors thank N.R. Nirmala for critical review of the manu-
script. The authors especially thank Robin Ge for running the
pre—processing programs of mRNA-Seq and Claudia Hon for
assistance with the software release. We also thank the bioinfor-
matics team in the Biomarker Development department (BMD)
for fruitful discussions. We are grateful to Dr Isaac S. Kohane
(Harvard Medical School, Children’s Hospital Medical Center)
for his guidance. T.G. thanks the NIBR Education Ofﬁce for
their support Via a Presidential Postdoctoral Fellowship.

 

1084

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

9103 ‘Og isnﬁnv uo ::

DeconRNASeq

 

Conflict of Interest: T.G. was an employee of Novartis when she
conducted this research. J.S. is an employee of Novartis and
holds stock in the company.

REFERENCES

Bertsekas,D.P. (1999) Nonlinear Programming, 2nd edn. Athena Scientiﬁc, Belmont,
MA.

Cibulskis,K. et a]. (2011) ContEst: estimating cross—contamination of human sam—
ples in next—generation sequencing data. Bioinformatics, 27, 260172602.

Gong,T. et a]. (2011) Optimal deconvolution of transcriptional proﬁling data using
quadratic programming with application to complex clinical blood samples.
PLoS One, 6, e27156.

Haas,B.J. and Zody,M.C. (2010) Advancing RNA—Seq analysis. Nat. Biotechnol.,
28, 4214123.

Huang,W. et a]. (2011) Efﬁciently identifying genome—wide changes with
next—generation sequencing data. Nucleic Acids Res, 39, e130.

Knights,D. et a]. (2011) Bayesian community—wide culture—independent microbial
source tracking. Nat. Methods, 8, 7617763.

Kuhn,A. et a]. (2011) Population—speciﬁc expression analysis (PSEA) reveals mo—
lecular changes in diseased brain. Nat. Methods, 8, 9457947.

Mackey,M.D. et a]. (1996) CHEMTAxia program for estimating class abun—
dances from chemical markers: application to HPLC measurements of phyto—
plankton. Mar. Ecol. Prog. Ser., 144, 2657283.

Pan,Q. et a]. (2008) Deep surveying of alternative splicing complexity in the human
transcriptome by high—throughput sequencing. Nat Genet, 40, 141371415.
Quon,G. and Morris,Q. (2009) ISOLATE: a computational strategy for identifying
the primary origin of cancers using high—throughput sequencing. Bioinformatics,

25, 288272889.

Tang,F. et a]. (2009) mRNA—Seq whole—transcriptome analysis of a single cell. Nat.
Methods, 6, 3777382.

Zhao,Y. and Simon,R. (2010) Gene expression deconvolution in clinical samples.
Genome Med, 2, 93.

 

1085

112 /310's112u1n0fp101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g1sn8nv uo ::

