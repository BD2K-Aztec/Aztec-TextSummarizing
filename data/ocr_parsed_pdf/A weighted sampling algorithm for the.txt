Vol. 29 ISMB/ECCB 2013, pages i308—i315
doi:10. 1 093/bioinformatics/btt21 7

 

A weighted sampling algorithm for the design of RNA sequences
with targeted secondary structure and nucleotide distribution

Vladimir Reinharz‘, Yann Ponty2'3'* and Jerome WaldispUhI1'*

1School of Computer Science & McGiII Centre for Bioinformatics, McGill University, Montreal, QC, Canada, 2Laboratoire
d’lnformatique (LIX), CNRS UMR 7161, Ecole Polytechnique, 91128 Palaiseau, France and 3AMIB team/project, INRIA

Saclay, Batiment Alan Turing, 91128 Palaiseau, France

 

ABSTRACT

Motivations: The design of RNA sequences folding into predefined
secondary structures is a milestone for many synthetic biology and
gene therapy studies. Most of the current software uses similar local
search strategies (Le. a random seed is progressively adapted to ac-
quire the desired folding properties) and more importantly do not allow
the user to control explicitly the nucleotide distribution such as the
GC-content in their sequences. However, the latter is an important
criterion for large-scale applications as it could presumably be used
to design sequences with better transcription rates and/or structural
plasticity.

Results: In this article, we introduce IncaRNAtion, a novel algo-
rithm to design RNA sequences folding into target secondary struc-
tures with a predefined nucleotide distribution. IncaRNAtion uses a
global sampling approach and weighted sampling techniques. We
show that our approach is fast (i.e. running time comparable or
better than local search methods), seedless (we remove the bias of
the seed in local search heuristics) and successfully generates high-
quality sequences (i.e. thermodynamically stable) for any GC-content.
To complete this study, we develop a hybrid method combining our
global sampling approach with local search strategies. Remarkably,
our glocal methodology overcomes both local and global approaches
for sampling sequences with a specific GC-content and target
structure.

Availability: IncaRNAtion is available at csb.cs.mcgill.
ca/incarnation/

Contact: jeromew@cs.mcgill.ca or yann.ponty@lix.polytechnique.fr
Supplementary Information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

At the core of the emerging field of synthetic biology resides, our
capacity to design and reengineer molecules with target func-
tions. RNA molecules are well tailored for such applications.
The ease to synthesize them (they are directly transcribed from
DNA) and the broad diversity of catalytic and regulation func-
tions they can perform enable to integrate de novo logic circuits
within living cells (Rodrigo et al., 2012) or reprogram existing
regulation mechanisms (Chang et al., 2012). Future advances
and applications of these techniques in gene-therapy studies
will strongly rely on efﬁcient computational methods to design
and reengineer RNA molecules.

Most of RNA functions are, at least partially, encoded by the
3D molecular structures, which are themselves primarily

 

*To whom correspondence should be addressed.

determined by the secondary structures. The development of ef-
ficient algorithms for designing RNA sequences with predeﬁned
secondary structures is thus a milestone to enter the synthetic
biology era. RNAinverse pioneered RNA secondary structure
design algorithms. It has been developed and distributed with the
Vienna RNA package (Hofacker et al., 1994). However, only
posterior experimental studies revealed the potential and prac-
tical impact of these techniques. Thereby, during the past 6 years,
many improvements and variants of RNAinverse have been
proposed. Conceptually, almost all of existing algorithms
follow the same approach. First a seed sequence is selected,
then a local search strategy is used to mutate the seed and
find, in its Vicinity, a sequence with desired folding properties.
Using this strategy, INFO—RNA (Busch and Backofen, 2006),
RNA— S SD (A guirre-Hernandez et a]. , 2007) and
NUPACKzDesign (Zadeh et al., 2011) signiﬁcantly improved
the performance of RNA secondary structure design algorithms.
More recent research studies aimed to include more constraints
in the selection criteria. RNAeXinv focused on the design of
sequences with enhanced thermodynamical and mutational ro-
bustness (Avihoo et al., 2011), while Frnakens tein enables to
design RNA with multiple target structures (Lyngsra et al., 2012).

We recently introduced with RNA—ensign a novel paradigm
for the search strategy of RNA secondary structure design algo-
rithm (Levin et al., 2012). Instead of a local search approach, we
proposed a global sampling strategy of the mutational landscape
based on the RNAmutants algorithm (Waldispiihl et al., 2008).
This methodology offered promising performances, but suffered
from prohibitive runtime and memory consumption. Following
our work, Garcia-Martin et a]. (2013) proposed RNAiFOLD, an
alternate methodology that uses constraint programming tech-
niques to prune the mutational landscape. While also suffering
from prohibitive running times, it is worth noting that this latter
algorithm also proposes a seedless approach to the RNA second-
ary structure design problem.

In this article, we introduce IncaRNAtion, an RNA second-
ary structure design algorithm that beneﬁts from our recent al-
gorithmic advances (Reinharz et al., 2013) to expand our original
RNA—ensign algorithm (Levin et al., 2012). IncaRNAtion
addresses previous limitations of RNA—ensign and offers new
functionalities. First, while our previous program had a running
time complexity of 0(n5), IncaRNAtion now runs in linear-
time and space complexity, allowing it to demonstrate similar
speeds as any local search algorithm. Next, IncaRNAtion is
seedless. Unlike RNA—ensign, it does not require a seed se-
quence to initiate its search. Finally, IncaRNAtion implements
a novel algorithm based on weighted sampling techniques

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOTJBLUJOJIITOTCI”Zdllq 11101} papBoru/noq

9103 ‘Og isanV uo ::

Constrained RNA design using a weighted sampling algorithm

 

(Bodini and Ponty, 2010) that enables us to control, for the ﬁrst
time, explicitly the GC-content of the solution. This functionality
is essential because wild-type sequences within living organisms
often present medium or low GC—content, presumably to offer
better transcription rates and/or structural plasticity. Previous
programs do not allow to control this parameter and tend to
output sequences having high GC—contents (Lyngsra et al., 2012).

We demonstrate the performance of our algorithms on a set of
real RNA structures extracted from the RNA STRAND data-
base (Andronescu et al., 2008). To complete this study, we de-
velop a hybrid method combining our global sampling approach
with local search strategies such as the one implemented in
RNAinverse . Remarkably, our glocal methodology overcomes
both local and global approaches for sampling sequences with a
speciﬁc GC—content and target structure.

2 METHODS

We introduce a probabilistic model for the design of RNA sequences with
a speciﬁc GC-oontent and folding into a predeﬁned secondary structure.
For the sake of simplicity, we choose to base this proof-of-concept im-
plementation on a simpliﬁed free-energy function E(>), which only con-
siders the contributions of stacked canonical base pairs. We show how a
modiﬁcation of the dynamic programming scheme used in RNAmutants
allows for the sampling of good and diverse design candidates, in linear
time and space complexities.

2.1 Deﬁnitions

A targeted secondary structure S* of length n is given as a non-crossing
arc-annotated sequence, where S? stands for the base-pairing position of
position i in S* if any (and, reciprocally, S’gf = i), or —1 otherwise. In
addition, let us denote by #gc(s) the number of occurrences of G and C in
an RNA sequence s.

2.1.] Simpliﬁed energy model We use a simpliﬁed free-energy
model, which only includes additive contributions from stacking base
pairs. Using individual values from the Turner 2004 model [retrieved
from the NNDB (Turner and Mathews, 2010)]. Given a candidate se-
quence s for a secondary structure S, the free energy of any sequence s of
length |S| is given by

E(S’ S) = Z Eras/es”;
(110% (i/af)ES
slacking pairs

where Egan/b, is set to 0 if abzﬂ (no base pair to stack onto),
the tabulated free energy of stacking pairs (ab)/(a’b’) in the Turner
model if available, or ,8 6 [0,00] for non7Watson-Crick/Wobble pairs
(i.e. not in {GU, UG, CG, GC,AU or UA}). This latter parameter
allows one to choose whether to simply penalize invalid base pairs
(,B>0), or forbid them altogether (,8 = +00). Position-specific sequence
constraints can also be enforced at this level (details omitted for the sake
of clarity) by assigning to E a +00 penalty (leading to a null probability)
in the presence of a base incompatible with a user-speciﬁed constraint
mask.

2.1.2 GC—weighted Boltzmann ensemble and distribution To
counterbalance the documented tendency of sampling methods to gener-
ate GC-rich sequences (Levin et al., 2012), we introduce a parameter
x e R+, whose value will inﬂuence the GC-oontent of generated se-
quences. For any secondary structure S, the GC-weighted Boltzmann
factor of a sequence s is ngs) such that

r E(.w, S)

ngs) = e RT . x#gc(s) (1)

 

where R is the Boltzmann constant and T the temperature in Kelvin.

Summing the GC-weighted Boltzmann factor over all possible se-
quences of a given length |S|, one obtains the GC-weighted partition
function 2%], from which one deﬁnes the GC-weighted Boltzmann prob-
ability PE‘Rs) of each sequence s, respectively, such that

x x x B[X](S)
29:27:39“) and IP[S](s)= 2g] .

 

(2)

2.2 Linear-time stochastic sampling algorithm for the
GC-weighted Boltzmann ensemble

Let us now describe a linear-time algorithm to sample sequences at
random in the GC-weighted Boltzmann distribution. This algorithm fol-
lows the general principles of the recursive approach to random gener-
ation (Wilf, 1977), pioneered in the context of RNA by the SFold
algorithm (Ding and Lawrence, 2003). The algorithm starts by precom-
puting the partition function restricted to each substructure occurring in
the target structure, and then performs a series of recursive stochastic
backtracks, using preoomputed values to decide on the probability of
each alternative.

2.2.] Precomputing the GC—weighted partition function Firstly, a
dynamic programming algorithm computes 253:? the GC-weighted par-
tition function (the dependency in x is omitted here for the sake of clarity)
for a structure S, assuming its (previously chosen) ﬂanking nucleotides
are a and b, respectively, either forming a closing base pair (N = T) or not
(N = F). Remark that the empty structure only supports the empty se-
quence, having energy 0, so one has

21“? = 2%.“ = 60/” = 1. (3)
The general recursion scheme consists in three different terms, depend-
ing on the ﬁrst position in S:
Case 1. First position is unpaired ( S 2 0S):

,b ,b _ d /,b
2%.15. = zlﬁﬂs. .= Ext“ ﬁzlﬁsl (4)

11/68

Case 2. First position is paired with last position [S = (S/)],
stacking onto a preexisting exterior pair ( N = T ).'

4:”
Z¥Iflt== Z x#g°‘”"””e “W ‘31“,14’] (5)
a/J/EBZ

 

Case 3. First position is involved in a base pair [S = (S/)S”],
which is not stacking onto an exterior base pair ( N = F or
S” 75 8):

4:”

J, _ t'b/ ﬂea/H /, b/ be b
Zita/W -= Z rig“ "e RT ‘Z¥,s/] ﬁlm] (6)
a/,b/EBZ

Remark that the number of combinations of a, b and N re-
mains bounded by a constant, thus the complexity of
computing 253:2] mainly depends on the values taken by S on
subsequent recursive calls. Such values are entirely determined by
S at any given step of the recursion, and their dependency can be
summarized in a tree having ®(|S|). Therefore, the computation
of  requires @(n) time and space using dynamic
programming.

 

i309

112 /310's112u1n0fp10}x0"sorJBurJOJurorq/ﬁduq 11101} papnorumoq

9103 ‘Og isnﬁnv uo ::

V.Reinharz et al.

 

 

Algorithm 1: 5B,, ((1, b, N, S)

 

r<—Random  // Random real in [0,2931%
switch do

case S = areturn e; // Empty structure
caseS=oS' // First position is unpaired
for a' E 13 do

r <_ r _ w#gc(a’) , 31:31

ifr < 0 then return a".SBm(a', b, F, 5")

cases 2 (S’) andN = T // Extremities are
involved in stacking base pair

for(a’,b’) EBXBdo

 

r <— r — x#g°(“l'bl) - e_E51Ha’b’/RT ' Zia-[’51:]
ifr < Othen return a’.SBx(a’,b’,T,S’).b’

 

otherwise // First position is paired
without a stacking pair
// S = (S') S"
for (a’,b') E B X Bdo
ﬂ
7' <— r — a:#gc(”/'bl) -e% -Z[:I’;/I] ' 33,571
if r< 0 then return i ’
a'.SBx (a', b',T, S’) .b’.SBw (b', b, F, S”)

 

 

 

2.2.2 Stochastic backtrack Once the GC-weighted partition func-
tions have been computed and memorized, a stochastic backtrack starts
from the target structure S* with any exterior bases [a, b] and no nesting
base pair, corresponding to a call SBx (0,0, F, S*) to Algorithm 1. At
each step, a suitable assignment for one or several positions is chosen,
using probabilities derived from the precomputation, as illustrated by
Figure 1. One or several recursive calls over the appropriate substructures
are then performed. On each recursive call, the algorithm assigns at least
lnt to a previously unassigned position. Moreover, the number of exe-
cutions of each loop is bounded by a constant. Consequently, the com-
plexity of Algorithm 1 is in @(n) time and space.

2.2.3 Self-adaptive sampling strategy Let us remind that our goal is
to produce a set of sequences whose GC-content matches a prescribed

Case 1: First position is unpaired.

value gc. An absolute tolerance K may be allowed, so that the GC-content
of any valid sequence must fall in [gc — K, gc + K]. Because sequences of
arbitrary GC-content may be generated by Algorithm 1, we use a rejec-
tion-based approach (Bodini and Ponty, 2010), previously adapted by the
authors in a similar context (Waldispﬁhl and Ponty, 2011). This gives an
algorithm that generates k valid sequences in expected time @(k > nﬁ)
when K = 0 [or @(k n) when K is a positive constant] and memory in
@(k > n). A complete analysis of the rejection process can be found in an
earlier contribution (Waldispﬁhl and Ponty, 2011), but let us brieﬂy out-
line the approach, and the main arguments used to establish its
complexity.

As summarized by Figure 2, our adaptive sampling approach simply
generates sets of sequences by repeatedly running the stochastic backtrack
algorithm. The average GC-content induced by the current value of the x
parameter can then be adequately estimated from the sample, or com-
puted exactly using recent algorithmic advances (Ponty and Saule, 2011).
The set of sequences is ﬁltered to only retain valid sequences. The value of
the parameter x is then adapted to match the average GC-content
(induced by the value of x) with the targeted one. It can be shown that
the expected GC-content is a continuous and strictly increasing mono-
tonic function of x, whose limits are 0 when x: 0 and n when x —> +00.
Consequently, for any targeted GC-content gc e [0%, 100%], there exists
a unique value xgc such that generated sequences feature, on the average,
the right GC-content. In practice, a simple binary search (Waldispiihl and
Ponty, 2011) is used in our implementation, and typically converges after
few iterations. An optimal value for x can also be derived analytically
using interpolation after @(n) evaluations of Z)?“ for different candidate
values of x, as previously noted (W aldispﬁhl and Ponty, 2011), and could
be implemented using the Fast-Fourier Transform (Senter et al., 2012).

2.2.4 Overall complexity It was previously established (Waldispuhl
and Ponty, 2011) that, for each value of x, there exists constants ax and
ex such that the distribution of GC-content asymptotically converges
toward a normal law having expectation in ax n > (1 + 0(1)) and stand-
ard deviation in ex > ﬂ > (1 +o(1)). Furthermore, the distribution of
GC-content is highly concentrated, as asserted by its limited standard
deviation; therefore, the expected number of attempts required to gener-
ate a valid sequence when K = 0 [respectively K 6 9(1 /ﬁ)] grows like
@(ﬁ) [respectively @(1), i.e. a constant], leading to the announced com-
plexities. Formally, because a suitable weight x must be recomputed for
each targeted structure and GC-content, then the number M of iterations

 

Case 2: Extremities are paired, surrounded by another base-pair, forming a stacking base-pair.

_E-8
A : #gc(ﬂ!_bt) _  . Z[af’br] Ebb] A
“ p“-’=”' "T 8 T.S’/ T.S
 CPS: WW  o M 9 :32;-

1‘3

x“, paﬂb’
Cb‘:

  

r
u

TE 1 r I.
= mirscta’b} . e—gﬁ’ﬂ . 31:11:11 ,Zlb’ﬁl/Zkﬁl

 

F13” 'JS _

 

Fig. 1. Stochastic backtrack procedure for a given substructure S. Either the ﬁrst position is left unpaired (top), a base pair is formed between the two
extremities, stacking onto an exterior base pair (middle) or paired without creating a stacking, deﬁning two regions on which subsequent recursive calls
are needed (bottom). For the empty structure (omitted here), the empty sequence is returned. Positions indicated in red are assigned at the current stage

of the backtrack

 

i310

112 /310'S[BIIJHO[pJOJXO'SOINZLUJOJIIIOIq/ﬂduq 11101} paprorumoq

9103 ‘Og isnﬁnv uo ::

Constrained RNA design using a weighted sampling algorithm

 

 

at := 1 Samples 2: Z

 

Draw sequences in
z—weighted distribution

1

Filter on GC%
Add suitable seqs to Samples

 

 

 

Estimate average GC% for an
Update x

 

 

 

 

 

l

 
   

 

|Samples| 2 k?

yes
Return Samples

Fig. 2. General workﬂow of our adaptive sampling algorithm
(Waldispiihl and Ponty, 2011)

required for the converge can be accounted for explicitly, leading to time
complexities in @((M + ﬂ) > k n) (if K = 0, i.e. without any tolerance)
and @(M>k n) (if K>0).

2.3 Postprocessing unpaired regions: a local/global
(glocal) hybrid approach

Owing to our simpliﬁed energy model, unpaired regions are not subject to
design constraints other than the GC-content, leading to modest prob-
abilities for refolded design candidates to match the targeted structure. To
improve these performances and test the complementarity of our global
sampling approach with previous contributions based on local search, we
used the RNAinverse software to redesign unpaired regions. We speci-
ﬁed a constraint mask to prevent stacking base pairs from being modiﬁed
and, whenever necessary, reestablished their content a posteriori, as
RNAinverse has been witnessed to take some liberties with constraint
masks. As shown in the Supplementary Material, this postprocessing
does not drastically alter the GC-content, so the glocal approach reason-
ably addresses the constrained GC-content design problem.

3 RESULTS

3.1 Implementation

Our software, IncaRNAtion, was implemented in Python
2.7. We used RNAinverse from the Vienna Package 2.0
(Hofacker et al., 1994). All-time benchmarks were run on a
single AMD Opteron(tm) 6278 Processor at 2.4GHz with
cache of 512 kb. The penalty )3, associated with invalid base
pairs, was set to 15.

Figure 3 presents the average times spent running
IncaRNAtion+RNAinverse to generate one sequence with
the required GC-content. As expected, the time grows linearly in
function of the length of the structures for IncaRNAtion.

3.2 Dataset

To evaluate the quality of our method, we used secondary struc-
tures from the RNA STRAND database (Andronescu et al.,

4.5 v I . y .

 

 

4_o _ H lncarnation+RNAinverse
o—o RNA-SSD

 

 

3.5

 

3.0

A

U)
v2.5 -

a)
g 2.0
I—
1.5
1.0
0.5

 

 

 

0.0
20 30 40 50 60 7O 8O 90

Length

Fig. 3. Average time in seconds to generate one sequence for
IncaRNAtion and RNAinverse

2008). Those are known secondary structures from a variety of
organisms. We considered a subset of 50 structures selected by
Levin et al. (2012), whose length ranges between 20 and 100 nt.
To ease the visualization of results, we clustered together struc-
tures having similar length, stacks density and proportion of free
nucleotides in loops, leading to distributions of structures shown
in Figure 4.

3.3 Design

We ran our method as follows. First, we sampled approximately
100 sequences per structure. Then, we use these sequences as seed
in RNAinverse . Finally, we computed the Minimal Free-
Energy (MFE) with the RNAfold program from the Vienna
Package 2.0 (Hofacker et al., 1994).

Before starting our benchmark, we asses the need for our
methods and performed an analysis of the GC-content drift
achieved with state-of—the-art software. Using our dataset of 50
structures, we generated 100 samples per structure with classical
softwares that do not control the GC-content. Namely,
RNAinverse, INFO—RNA, NUPACK: Design and Frnaken—
stein. We show the distribution of the GC—content of the se-
quences produced with these softwares in Figure 5.

As anticipated, we observe a clear bias toward high GC-con—
tents and a complete absence of sequence with <30% of GC.
This striking result motivates a need for methods that enable to
explicitly control the GC-content and more precisely that enable
to design sequences with low GC-content (i.e. 530%). To pro-
vide a complete overview of the performance of IncaRNAtion,
we provide additional statistics for these softwares in the
Supplementary Material.

3.4 Success rate

We started by estimating the success rate of our methodology
and computed the percentage of sequences with a MFE structure
identical to the target secondary structure. Figure 6 shows our
results. We clearly see that before the postprocessing step (i.e.
RNAinverse) the sequences sampled by IncaRNAtion have a

 

i311

112 /3.10'spzu.mofp10}xo"sorJBMJOJurorq//:d11q uron papsorumoq

9103 ‘Og isanV uo ::

V.Reinharz et al.

 

 

14 12 16
C C C
5 12 5 10 '5 14
L 10 L 8 L 12
<1) 8 w a) 10
o. D- 5 D- 8
e 6 e 4 e e
3 4 3 3 4
b 2 b 2 b 2
m o m o m o

10 20 30 40 50 60 70 80 90 100 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.0 0.1 0.2 0.3 0.4
Length Stack density % Free nt in loops

Fig. 4. Number of secondary structures per bin, according to our three clustering criteria

 

 

 

 

 

0.35 . . . . . .
- NUPACK
030' - INFO-RNA '
- RNAinverse
a 0'25' - Frnakenstein —
U
$0.20 _
J
O"
G)
S 0.15 -
O
as
0.10- -
0.05- _

 

 

 

0'090 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95
%GC content

Fig. 5. Overall GC-content distribution for sequences designed using

RNAinverse, INFO—RNA, NUPACK: Design and Frnakenstein
folding in the desired structure

low success rate (ﬁrst row). As mentioned earlier, this could be
explained by the fact that no selection criterion has been at this
stage applied to unpaired nucleotides. Remarkably, after the
local search optimization (with RNAinverse) of nucleotides in
unpaired regions (second row), we observe a dramatic improve-
ment of our success rate. As expected, we observed that length is,
in general, not a good predictor for the hardness of designing a
structure. Instead, a high number of free nucleotides in the struc-
ture seems to be a good measure of the hardness of its design.
Similarly, these data also show that designing sequences with low
GC-content is challenging for all types of targets.

We investigated further the quality of the sequences generated
by IncaRNAtion. In particular, we estimated the capacity of
our methods to generate ‘good’ sequences with desired folding
capabilities regardless of the property to fold exactly into the
target structure. In Figure 7, we show the ratio of well-predicted
base pairs in the MFE structure of our sampled sequences. As
above, we can observe that, in all cases, the sequences that are
the hardest to design are those with an extremely low GC-con—
tent. Indeed, the energetic contribution of the base pairs to the
stability of the structure is weaker. Interestingly, we also notice
that the most accurate sequences yield a GC-content of
70 :i: 10%. Overall, we observe that all our samples have good
folding properties, and that there is a correlation between the
‘precision’ of the samples and the hardness of the design.

We noticed a highly decreased structural sensitivity for the
sequences with 15% free nucleotides in the loops. However,

one must remain careful interpreting this observation, as the
structures within this class all originate from the PDB, and are
relatively small (for the complete STRAND DB, the average
length is ~ 526 nt, compared with ~ 38 nt around 15% unpaired
bases).

3.5 Properties of designed sequences

In this section, we further analyze the generated sequences with a
MFE structure that folds into the target structure.

A desirable feature in sequence design is to produce samples
with a high sequence diversity and stable secondary structure.
Therefore, in the following, we will use two useful measures,
which are the sequence identity of the samples, and the
Boltzmann probability of the target structure in the low-energy
ensemble.

The sequence identity is deﬁned over a set S of aligned se-
quences (in our case, all sequences have the same length and can
be trivially aligned) as follows:

2 L21 Seq.identity (7)

l
s1,s268><8 Isl
.YiEAZZ
. .

where s,- is the nucleotide at position i in sequence s. Intuitively,
this measure captures the diversity of sequences generated by a
given method. Next, the Boltzmann frequency is defined for a
structure S and a sequence s as follows:

efﬁgy /Z‘YFrequency (8)

where Z‘Y is the partition function of sequence s. This measure
tells us how dominant is a structure S in the Boltzmann ensemble
of structures over a sequence s. A high value implies a stable
structure. We compute this frequency with RNAfold from the
Vienna Package 2 . O (Hofacker et al., 1994).

Figure 8 shows the number of solutions generated (i.e. se-
quences with a MFE structure identical to the target structure).
Here, we note that low GC-contents have a strong (negative)
inﬂuence on the number of sequences generated, and in parallel
also affect negatively the sequence diversity. This observation
emphasizes the difﬁculty to design sequences with low GC—con—
tent. Once again, large percentages of free nucleotides increase
the difﬁculty of the task.

The thermodynamical stability of the target structure on the
designed sequence is another important property when estimat-
ing the performance of RNA design algorithms. We estimate the
quality of our solutions in Figure 9. First, we observe a slow

 

i312

112 /310's1cu1noipio1xo"sorwurJOJurorq/ﬁduq uron papso1umoq

9103 ‘0g isanV uo ::

Constrained RNA design using a weighted sampling algorithm

 

-—- Incarnation 10%G+C -—- 30%5+c -—- 50%G+C -—- ?0%G+C -—- 90%G+C

 

 

 

 

w 1.0 1.0 1.0 -
“- LLI I“
g 0.3 E 0.3 g 0.0
E 0.6 ti 0.6 t.‘ 0.6 -
L g E
5 0.0 D 0.4 5 0.4
U u U
as 0.2- - a: 0.2 - as 0.2-
0. " " 0. 0 w
‘10 20 30 40 50 60 T0 00 90 100 %2 0.3 0.4 0.5 0.5 0.? 0.8 €00 0.05 0.10 0.15 0.20 0.25 0.30 0.35

IncarnatioMNﬁinverseH 10%G+C -—- 30%G+c -—- 50%G+c -—- name -—- 90%G+C

 

 

 

 

 

 

 

 

 

 

 

 

u 1.0 ' ' ' ' ' 1.0 1.0 ' '

IL w u;

g 0.0 - g 0.0 - E 0.0 - -

3 0.5 u 0.6 u 0.5

g 0'4 - g 0.0 a 0,4 - _

g 0.2 - s 0.2 - s 0.2 - -
“10 20 30 00 50 00 70 00 90 100 “0.2 0.3 0.4 0.5 0.6 0.? 0.3 015100 0.05 0.10 0.15 0.20 0.25 0.30 035 0.40

Length Stack density at: Free nt in loops

Fig. 6. Success rate IncaRNAtion before and after RNAinverse postprocessing. The ﬁrst row shows the percentage of sampled sequences folding into
the target when using only IncaRNAtion. The second shows after processing previous results with RNAinverse

lncarnation+RNAinrerseH10%G+C .—. 30966.1(: .—. 50066.1(; ._. 70965.1(;

0.0 -

0.7

0.6

0.4

0.3

0.2 -
0'3 ‘4 05 0:6 0:? 0.5

-—. gonetc

Y
a
m

 

%Strucrural Sensitivity
a
-.l

 

llizs'tructural Se nsitivit
0
UI

 

 

 

 

 

0.0 -
0.5 -
1 . . . . . . . a}: Big . . . . . . .
0 20 30 40 50 60 10 00 90 100 .2 . 0. . .05 0.10 o. 15 0.20 0.25 0.30 0.35 0.40 0.45 0.50
Length Stack density 90 Free nt in loops

Fig. 7. Structural sensitivity (i.e. number of well predicted base pairs/number of base pairs in target) of the sampled sequences MFE

'W'MWWMIW‘F—‘m‘mﬁ -—- 3000+: -—- 50mm ~ io%0+c —- 90%0+c

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

% 100. 66.0.
.7; “10% 3 m 5 mo
600 600
3 500 2 5°“ 3 500
c m : m : .100
an 300 o a 300
E 200 2 m 2 200
100 A 100 a 3 $0 E
‘10 2O 30 £0 50 00 3'0 83 90 100 0.2 0.3 0.4 0.5 0.6 0.} 0.8 0:00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40
Length Stack density 96 Free nt m loops
05° ImamﬂmmM'meH 10%G+C r—- anss+c -—- 50mm -—- meme -—- 90mm
‘«3.0.05 3.0.45 3.0.45
EOJDE 2 r: ':' E000 go“
£10.35 £0.35 $0.35
o,3o—;___._....—-— ——-.. 0.30 0.30 m
0'2‘2‘0 30 40 50 60 TO 80 90 0220 30 40 50 60 1'0 80 0250 5 10 15 20 25 30 35
Length Stack densityI '16 Free at in loans

Fig. 8. Number of solutions generated with IncaRNAtion + RNAinverse on the ﬁrst row and their average sequence identity on the second

IncarnatiomiNﬁimerseH1000c -—- 30%G+C —- so%e+c H179%e+c -—- 90%s+c

       

 

 

 

1.0
3' 0'8 3' W 3- 0.0
.1: 0.0 .t 0.6 I: 0.6
a! m m
E 0.4 g 0.4 5 0.4

0.2 0.2 0.2

ML . . . 0% 03

D 20 30 #10 50 60 1'0 80 90 100 .2 0.3 0.4 0.5 0.6 0.1" 0.8 .00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 [MCI
Length Stack density ‘10 Free nt in loops

Fig. 9. Thermodynamical stability of the target structure. The curves report the average Boltzmann probability of the target structure (which is also the
MFE structure) at various GC-contents with respect to the length of the target (left), density of stacked base pairs (centre) and number of unpaired
nucleotides in loops (right)

 

i31 3

112 /810's1izumo_fpiogxo'sonsuuogu1o1q/ﬁdm1 uron papBo1u/noq

9IOZ ‘OE ISUEHV Ho ::

V.Reinharz et al.

 

 

[v—v lncaRNAtion

H lncamation+RNAinverse

H RNA-SSD]

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

10%GC 10%GC 10%GC
 | | | | | I  | ' | |  I I I I I I
'43 0.45— — 'g 0.45— 1 E 0.45— —
E 0.40 — E 0.40% a 0.40 —
E; 0.35 — — 0.35 — J 035 — —
03% 30 40 50 60 70 30 90 03% 30 40 50 60 70 30 0'300 5 10 15 20 25 30 35
Length Stack density % Free nt in loops
0 O 0
#140 . . mimic . . ,040 . .30/T’GC. 0.40 . . 3959C . .
I: 0.38 .t‘ 0.38 .4? 0.33 — —
E 0.36 E 0.36 E 0.36- —
III 0.34 m 0.34 m 0.34— —
 335  as E as
E 0228— 80228 30228— —
U1  I I I I I | T m  I I I I I m  ' I I I I I I '
20 30 40 50 60 70 30 90 20 30 40 50 50 70 so 0 5 10 15 20 25 30 35

Length Stack density

 

% Free nt in loans

Fig. 10. Sequence identity of IncaRNAtion and RNAinverse for 10 and 30% of GC

decline of the structure stability (i.e. the frequency) when the
target structure increases in size. Yet, for an average GC-content,
the frequency stays >10% even at size of 100 nt. Next, we note
that for the most difﬁcult target structures (i.e. the longer ones or
those with high percentages of unpaired nucleotides in loops) the
GC-content has a limited (almost null) inﬂuence on the stability
of the target structure on the designed sequence. By contrast, this
is less true for easiest and small structures with only few free
nucleotides in internal loops.

3.6 Global sampling versus Local search versus Glocal
approach

To conclude this study, we estimate the impact of the design
methodology on the performances. More precisely, we aim to de-
termine the merits of a global sampling approach (IncaRNA
tion) , compared with a glocal procedure (IncaRNAtion+
RNAinverse) and a local search methodology (RNA—SSD). To
the best of our knowledge, RNA—SSD, beside IncaRNAtion, is
the only software that implements an explicit control of the GC-
content.

Here, we compare the running time and the sequence diversity
of the solutions produced by each software. In addition, we focus
on the design of sequences with low GC-contents (530%) as they
are almost impossible to design with classical software (Figure 5).

Figure 3 shows the running time of each software. These data
demonstrate the efﬁciency and scalability of our techniques. In
particular, this ﬁgure suggests that our strategy has the potential
to be applied efficiently for designing sequences on long (and
difﬁcult) target secondary structures at low GC—contentia
task that could have not been achieved before due time
requirements.

Next, we show in Figure 10 the average sequence identity
achieved by the various methods. Our results show that at ex-
tremely low GC-contents (i.e. 10%), IncaRNAtion slightly out-
performs RNA—SSD, while this advantage becomes less evident
when the GC-content increases. Our experiments on higher

GC—contents (i.e. 350%) showed that our glocal strategy and
the local search approach perform similarly. Similarly, we did
not find any clear evidence that a global, local or glocal approach
outperforms others when we compare at the thermodynamical
stability of the target structure (data not shown).

4 CONCLUSION

In this article, we described a novel algorithm, IncaRNAt ion,
for the RNA secondary structure design problem, i.e. the design
of an RNA sequence adopting a predeﬁned secondary structure
as its minimal free-energy fold. Implementing a global sampling
approach, it optimizes afﬁnity toward the target secondary struc-
ture, while granting the user full control over the GC-content of
the resulting sequences. This extended control does not necessar-
ily induce additional computational demands, and we showed
the linear complexity of both the preprocessing stage and the
generation of candidate sequences for the design, allowing for
the design of larger and more complex secondary structures in a
matter of minutes on a single processor (e.g. ~28 min for 100
candidate sequences for a ~1500 nt 16S rRNA). We evaluated
the method on a benchmark composed of target secondary struc-
tures extracted from the RNA STRAND database. We observed
good overall success rate, with the notable exception of very low
targeted GC—content (10%), and a good to excellent entropy
within designed candidates. Finally, we implemented a hybrid
approach, using the RNAinverse software as a postprocessing
step for unpaired regions. This approach greatly increased the
success rate of the method, allowing for the design of highly
diverse candidates for almost all of the structures in our bench-
mark, while largely preserving the targeted GC-content.

In the future, we would like to complement this study by fur-
ther investigating the potential of hybrid local/globalwr
glocaliapproaches. A global sampling approach would capture
the positive aspects of design, optimizing afﬁnity toward a given
structure while allowing the speciﬁcation of expressive systems of
constraints. Designed sequences would serve as a seed for a

 

i314

112 /310's1cu1noipio1xo'sopcurJOJurorq/ﬁduq 0101} papso1umoq

9103 ‘0g isanV uo ::

Constrained RNA design using a weighted sampling algorithm

 

restricted local approach which, by breaking unwanted symme-
tries, would perform the negative part of the design, while ideally
maintaining obedience to the constraints. Another perspective of
this work is the incorporation of the full Turner energy model,
which should in principle yield better designs for unpaired
regions.

ACKNOWLEDGMENTS

The authors would like to thank Rob Knight for his suggestions
and comments.

Funding: This work was funded by the French Agence Nationale
de la Recherche (ANR) through the [check] Magnum ANR 2 01 O
BLAN O2 04 project (to Y.P.), the FQRNT team grant 232983 (to
V.R. and J .W.) and NSERC Discovery grant 219671 (to J .W.).
This article has been developed as a result of a mobility stay
funded by the Erasmus Mundus Programme of the European
Commission under the Transatlantic Partnership for Excellence
in Engineering TEE Project (V.R.).

Conflict of Interest: none declared.

REFERENCES

Aguirre—Hernandez,R. et al. (2007) Computational RNA secondary structure design:
empirical complexity and improved methods. BM C Bioinformatics, 8, 34.

Andronescu,M. et al. (2008) RNA STRAND: the RNA secondary structure and
statistical analysis database. BMC Bioinformatics, 9, 340.

Avihoo,A. et al. (2011) RNAexinv: an extended inverse RNA folding from shape
and physical attributes to sequences. BMC Bioinformatics, 12, 319.

Bodini,O. and Ponty,Y. (2010) Multi—dimensional Boltzmann Sampling of
Languages. In DMT CS Proceedings, number 01 in AM, Vienne, Autriche, pp
49—64.

Busch,A. and Backofen,R. (2006) INFO—RNAia fast approach to inverse RNA
folding. Bioinformatics, 22, 182}1831.

Chang,A.L. et al. (2012) Synthetic RNA switches as a tool for temporal and spatial
control over gene expression. Curr. Opin. Biotechnol, 23, 679$88.

Ding,Y. and Lawrence,E. (2003) A statistical sampling algorithm for RNA second—
ary structure prediction. Nucleic Acids Res., 31, 728(F7301.

Garcia—Martin,J.A. et al. (2013) RNAiFold: a constraint programming algorithm
for RNA inverse folding and molecular design. J. Bioinform. Comput. Biol, 11,
1350001.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary struc—
tures. Monatsh. Chem., 125, 1677188.

Levin,A. et al. (2012) A global sampling approach to designing and reengineering
rna secondary structures. Nucleic Acids Res., 40, 10041710052.

Lyngsa,R.B. et al. (2012) Frnakenstein: multiple target inverse RNA folding. BMC
Bioinformatics, 13, 260.

Ponty,Y. and Saule,C. (2011) A Combinatorial Framework for Designing
(Pseudoknotted) RNA Algorithms. In: WABI — 11th Workshop on Algorithms
in Bioinformaticsi2011, Saarbrucken, Allemagne.

Reinharz,V. et al. (2013) A linear inside—outside algorithm for correcting sequencing
errors in structured RNA sequences. In: Research in Computational Molecular
Biology. Lecture Notes in Computer Science, Vol. 7821. Springer, pp. 1997211.

Rodrigo,G. et al. (2012) De novo automated design of small RNA circuits for
engineering synthetic riboregulation in living cells. Proc. Natl Acad. Sci. USA,
109, 15271715276.

Senter,E. et al. (2012) Using the fast fourier transform to accelerate the computa—
tional search for RNA conformational switches. PLoS One, 7, e50506.

Turner,D.H. and Mathews,D.H. (2010) NNDB: the nearest neighbor parameter
database for predicting stability of nucleic acid secondary structure. Nucleic
Acids Res., 38, D28(FD282.

Waldispiihl,J. and Ponty,Y. (2011) An unbiased adaptive sampling algorithm for
the exploration of RNA mutational landscapes under evolutionary pressure.
J. Comput. Biol, 18, 146571479.

Waldispiihl,J. et al. (2008) Efﬁcient Algorithms for probing the RNA mutation
landscape. PLoS Comput. Biol, 4, e1000124.

Wilf,H.S. (1977) A uniﬁed setting for sequencing, ranking, and selection algorithms
for combinatorial objects. Adv. Math, 24, 2817291.

Zadeh,J.N. et al. (2011) Nucleic acid sequence design via efﬁcient ensemble defect
optimization. J. Comput. Chem., 32, 4397452.

 

i315

112 /310'S[BHJnOprOJXO'SOIJ’BLUJOJIIIOICI”Zduq uron papao1umoq

9103 ‘0g isanV uo ::

