BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

J.Becker et al.

 

regulation remain active areas of research. A major challenge in
addressing these questions is that the precise identiﬁcation of
individual nucleosomes is rendered complex by current assays
which (i) are biased and (ii) sample nucleosomes positions
across a cell population, as discussed below, raising the need
for nucleosome calling methods that account for both issues.

The main experimental bias arises from the use of the micro—
coccal nuclease (MNase) to isolate the DNA fragments bound to
histones (nucleosomal DNA). In addition to digesting naked
DNA, the MNase is known to cleave AT/TA dinucleotide
motifs as well as showing other, more subtle, sequence specificity
(Horz and Altenburger, 1981). After measuring the nucleosomal
DNA either by microarray (MNase—chip) or deep sequencing
(MNase—seq), the resulting nucleosome map thus reﬂects regions
both depleted of nucleosomes and rich in AT/TA dinucleotides.
Even though Kaplan et al., (2010) showed that nucleosome
protection is the dominant factor in MNase digestion, it is desir—
able to control for this bias along other potential experimental
biases. In MNase—Chip experiments, this is done by hybridizing
nucleosomal DNA against a control sample (naked genomic
DNA). By contrast, in MNase—Seq experiments, because nucleo—
somal and control DNA are assayed separately, the experimental
biases can only be corrected at the nucleosome calling stage.
However, because the majority of the MNase—Seq studies do
not include control samples (notable exceptions including
Valouev et al., 2008, 2011; Zhang et al., 2009), current nucleo—
some calling methods tailored to MNase—Seq data do not take
into account control samples.

Regarding the second point, because nucleosomes are assayed
in a cell population, their associated reads (or intensities in the
case of MNase—Chip) are either normally distributed within
~15bp of the nucleosome centre when highly phased, or
uniformly distributed otherwise (Jiang and Pugh, 2009). This
variation in read positions reﬂects both the positional heterogen—
eity across cells and the over—trimming or under—trimming of the
DNA at nucleosome borders during sample preparation.

Nucleosome calling methods recently developed aim to iden—
tify the footprint of phased nucleosomes from a signal processing
perspective. They commonly involve two steps of background
noise ﬁltering and peaks scoring. These methods include
Laplacian of Gaussian (Zhang et al., 2008a), Fourier
Transform (Flores and Orozco, 2011), correlation with nucleo—
some footprint (Weiner et al., 2010), mixed methods (Di Ges
et al., 2009) for MNase—Seq data and Hidden Markov Models
for MNase—Chip data (Kuan et al., 2009; Lee et al., 2007;
Yassour et al., 2008; Yuan et al., 2005). However, no current
methods include control data that can provide important
additional information for inferring nucleosome positioning.

In this article, we introduce NucleoFinder, a new statistical
approach for MNase—Seq data analysis that aims to identify
nucleosomes consistently positioned in a cell population
(phased) and showing a signiﬁcant enrichment relative to a
control sample. NucleoFinder is based on nucleosome position—
ing, a concept commonly used in MNase—Seq analyses (Field
et al., 2008; Kaplan et al., 2009; Valouev et al., 2008, 2011;
Zhang et al., 2009) to quantify the extent to which nucleosome
positions vary across the cell population assayed. This statistic
relates the number of read counts in a 30 bp window (to account
for the MNase cleavage uncertainty, Jiang and Pugh, 2009) to

the number of read counts in the two 60 bp ﬂanking windows.
The larger is this ratio, the more precisely positioned the nucleo—
some is. To take into account the control information in the
nucleosome positioning measurement, we extend this idea by
looking for the pattern not enriched, enriched, not enriched be—
tween the nucleosome and control samples in three consecutive
windows 60, 30, 60 bp long.

Our ﬁrst attempt was based on the binomial test that measures
the relative enrichment in the nucleosome sample relatively to the
control sample. Because it is based on the relative enrichment, this
test did not deal well with background noise and led to a high false
positive rate: when in a given region, few random reads (a couple)
were present in the nucleosome sample but not in the control
sample, the null hypothesis (equal enrichment in both samples)
was rejected and the region declared as nucleosome. To circum—
vent this, we model the difference in read counts between nucleo—
some and control samples. The difference is truncated to zero, as
negative values do not provide any additional information apart
from the fact that the considered region is not enriched. This
truncated difference is then modelled using a Poisson distribution
where prior distributions on the rate parameter are either gamma
or uniform. Lastly, to distinguish relatively high background noise
from local peaks in the two side windows, we split them into two
30 bp long windows. Ideally, even smaller windows would be pref—
erable to differentiate regions where reads cluster from those with
a high number of randomly distributed reads, but the ~30 bp
measurement uncertainty prevents us to do so.

2 METHODS

In this section, we provide details on the data and statistical model
developed.

2.1 Data

The dataset and preprocessing steps used in this analysis are taken from
Valouev et a] (2011), where nucleosomes were isolated from three haem-
atopoietic cell lines (CD4+, CD8+ T cells and granulocytes) as well as
in vitro and in a control samples. They were then treated with micrococcal
nuclease to release nucleosome cores, and deep sequenced using the
SOLiD platform (Pandey et al., 2008). The resulting 25 bp reads derived
from the 5’ end of nucleosomal DNA were subsequently mapped against
the human hgl8 assembly and yielded a genome coverage ranging be-
tween 16k28><. Reads that mapped to more than one single location were
discarded. Following the data processing used by Zhang et al. (2008b), (i)
genomic positions covered by an excessive number of reads were removed
(because likely to arise from amplification and sequencing errors, Zhang
et al., 2008b), and (ii) nucleosome centres were obtained by adding 75 bp
to the 5’ end position of the reads (Zhang et al., 2009). Reads position
were then binned into 30 bp windows in each dataset. The CD4+, CD8+
T cells, granulocytes and in vitro samples were ﬁnally corrected by sub-
tracting the number of reads in each 30 bp window by the number of
reads in the control falling in the same window. Negative values were
truncated to 0.

2.2 Statistical model

2.2.1 Likelihood Given a 150 bp region, let x = {X1,X2,X3,X4,X5}
denote the corrected number of nucleosome centres falling in each of the
ﬁve 30 bp bins. The bins are grouped into three segments S = {$1 , 52, S3}
that include bins {{1,2},{3},{4,5}}, respectively. Each random variable X,»
is assumed Poisson distributed with parameter 2,». The number of reads is

 

712

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

NucleoFinder

 

assumed independent from one bin to another, which allows the likeli-
hood to be factorized. The likelihood of x is expressed as:

5
mm = 1113mm.) (1)
[:1

2.2.2 Priors Whether segment j is background or enriched, the
prior on A,» is either:

o nabg) = Ga(&,/§), i.e. gamma distributed with parameters {cl/é}
estimated chromosome by chromosome from the data using the
method of moments. The hyperparameters are not directly estimated
with Ga(&, )9) but from the marginal distribution that we introduce
below. Since most of the nucleosomes in the human genome show
little or no sign of positioning, the data consist mainly of randomly
distributed reads. Hence, the estimation of the hyperparameters from
the data should allow to capture the background nucleosome
distribution.

71MB") 2 Unif(0, Xmux), i.e. uniformly distributed in the interval
[0,Xmux], where Xmm. denotes the maximum read counts in the cor-
responding chromosome x. Unlike Ga(&, 3) which has most of the
mass concentrated around 0, this prior gives same weight to all read
counts.

2.2.3 Marginal likelihood Our main interest is to ﬁnd regions that
match the proﬁle of well-positioned nucleosomes, i.e. when S2 is enriched
and {S1, S3} are background. To capture this pattern, we introduce eight
models that cover all possible combinations of Mg and 26,, in S1, S2 and
S3, as indicated in Table 1. In each 150 bp sliding region, the marginal
likelihoods associated with these eight models are calculated. When M1
has the largest marginal likelihood among the models, this region is con-
sidered as a well-positioned nucleosome. The reason for using eight
models is that it allows a better discrimination between well-positioned
nucleosomes and background or randomly enriched regions.

Since the calculation of the marginal likelihood is similar across the
models, we only illustrate it with M1, where the priors are as follows:

Ga(&, 3) ,i;£ 3

7124M =
(I 1) jumf(o,xm) ,i=3

mm» = / n(xll,M1)H(llM1)d/1
= / Poi(X3 |/13)Unif(0, xm)d,t3. (2)

1‘1 / Poi(x.»|Ai)Ga(&,/é)dn
iE(l.2.4.5}
1 24.3823
JT(X|M1)  3X3' d13-

where n(2|-) = ﬁ TIM-1+)

 

H Neg—Bin(xi|&, 1%)

ie(1.2.4.5}

The poisson l2:1i1d gamma distributions being conjugate, the marginal
likelihood can be calculated in closed form using the negative-binomial
distribution (Gelman et al., 2004). This is, however, not the case with the
uniform prior, where the marginal likelihood can nevertheless be calcu-
lated by successive integrations by part. To avoid the calculation of this
integral every 150 bp window, we compute it for X3 6 [0, Xmux] and store
the results during the initiation stage of NucleoFinder to speed-up the
execution.

As mentioned above, a nucleosome is detected when the marginal
likelihood associated with M1 is the largest of all models. In addition
to the information of the presence/absence of a nucleosome, it would be
desirable to have a sense of how enriched and well-positioned are the
detected regions. A good measurement is provided by the Bayes factor

Table 1. Models Priors: to precisely capture the proﬁle of well-positioned
nucleosomes, we introduce eight models that cover all possible combin-
ations of 2,7,; and A”, in S1, S2 and S3

 

 

 

Model Parameters
11,2 (51) 13(52) 14,5 (53)

M o lbg 417g 417g
M1 117}; Aer: 117};
M2 Aer: Aer: Aer:
M3 Aer: 117g Aer:
M4 Aer: Aer: 4-17};
M5 117}; Aer: Aer:
M6 Aer: 117g 117};
M7 417g 417g 4-01

 

between M1 and M0, which measures how much the data support M1
compared with the null model made of background priors only:

_7T(X|M1)

‘ 71(XIM0) (3)

3 RESULTS

An important feature of the nucleosome organization in eukary—
otic genomes is that nucleosome positions are variable across
conditions, tissues and individuals. This implies that large—scale
regions consistently occupied by nucleosomes on which
nucleosome calling methods could be compared do not exist.
Even in yeast, considered mainly populated by well—positioned
nucleosomes (Radman—Livaja and Rando, 2010), substantial
divergences have been found across studies. An example is
provided in Yassour et a]. (2008) where the authors compared
their predictions with a small set of experimentally veriﬁed
nucleosomes taken in Segal et a]. (2006). The authors found
that neither their predictions nor those of Yuan et a]. (2005)
and Lee et a]. (2007) are consistent with this reference dataset.
This means that there are no true positives available on
which nucleosome calling methods can be tested with high
conﬁdence.

Despite this absence of large—scale validated dataset, we com—
pare the performance of NucleoFinder with two popular
(MNase—Seq) nucleosome calling methods, NPS (Zhang et al.,
2008a) and TemplateFilter (Weiner et al, 2010) based on (i) their
speciﬁcity, (ii) their ability to identify the uniform nucleosome
spacing occurring near active promoters in vivo and (iii) their
ability to detect the stereotypical A/T and G/C dinucleotide pat—
terns present at well—positioned nucleosomes in vitro (Valouev
et al., 2011). These two methods are run with the parameters
set to their default values. To rule out the possibility that the
signature detected by these methods could be identiﬁed by simple
clustering, we also run K—means by iteratively increasing the
number N of clusters until one of them matches the pattern of
well—positioned nucleosomes (i.e. not enriched, enriched, not
enriched in three consecutive windows 60, 30, 60bp long).
In the following analysis, N = 4.

 

713

ﬁm'spzumofpmjxo'sopeuuopnorq/ﬁdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

NucleoFinder

 

low background in the side windows (Fig. 1b). After permuta—
tion, the average level of enrichment decreases substantially in all
four methods and, except for K—means and NucleoFinder, their
proﬁles ﬂatten out. Although both have a pronounced enrich—
ment in the central segment, these last two methods resulted in
very different numbers of predictions (Table 2). This difference is
likely owing to the higher stringency of NucleoFinder in the side
segments, as the low average read counts shows (Fig. 1b and c).
This is consistent with the high specificity of NucleoFinder
described earlier and supports the idea that NucleoFinder only
detects the signature of well—positioned nucleosomes.

3.2 Inter-nucleosome distance comparison

According to the barrier model (Mavrich et al, 2008), the steric
hindrance imposed by RNA Pol II induces a compact and regu—
larly spaced nucleosome array within ~1 kb and progressively dis—
sipates when moving away from the TSS. The spacing just
downstream of the TSS is therefore expected to be of the same
order of magnitude as estimated at active promoters (178+187 bp,
Valouev et al., 2011). For each approach, we estimate the
inter—nucleosome distance in the 1kb region downstream of
TSSs of highly expressed genes, deﬁned as those with RPKM
(reads per kilobase of exon per million mapped reads,
Mortazavi et al, 2008) >10. This criterion follows the classiﬁca—
tion in four gene groups used in Valouev et a]. (2011). The gene
expression data used here come from the same CD4+T cells as
those used to assay the nucleosomes (Valouev et al, 2011), avail—
able on GEO, accession number GSE25133. To account for miss—
ing predictions, nucleosomes are enumerated from the TSS to the
3/ end of the 1 kb window, without constraining them to be con—
secutive, and a linear model is used to ﬁnd optimal numbering.

From the inter—nucleosome distances estimated at 2754 highly
expressed genes, the mean and standard deviation are computed
for each method (Table 3). Substantial differences are found
across methods where, taking Valouev et a]. (2011) value of nu—
cleosome spacing as a reference (182 bp), K—means and
TemplateFilter result in an under—estimation of ~20 bp and
~10 bp, respectively, unlike NPS and NucleoFinder that provide
improved estimations. In addition to being biased, K—means re—
sults in a standard deviation almost twice as large as those found
in the other methods, indicating that this method perform poorly
both in term of accuracy and precision.

3.3 Ability to recover nucleosome-specific dinucleotides

The relationship between nucleosome position and DNA se—
quence has been the subject of intense research (Field et al.,
2008; Peckham et al, 2007; Tillo et al., 2010; Valouev et al,
2011; Yuan and Liu, 2008), which has revealed that, owing to
their poor distortion properties, poly—dA/dT sequences result in
nucleosome exclusion, whereas sequences with 10 bp periodicity
of AA/TT/TA dinucleotides facilitate the sharp bending of DNA
around the nucleosome (Anselmi et al., 1999). In human,
Valouev et a]. (2011) demonstrated that in vitro, the centre of
well—positioned nucleosomes is characterized by an enrichment of
G/C motifs and a depletion of A/T motifs.

This information can be used to compare methods, where a
large discrepancy between GC and AT frequencies at the centre
of nucleosome predictions in vitro will suggest a high speciﬁcity

Table 3. Estimation of the inter-nucleosome distance (mean and standard
deviation)

 

 

 

Region/Method Inter-nucleosome distance

Mean SD
Active promoters 1787187 7
K-means 1 59 36
NPS 1 87 21
NucleoFinder 1 80 24
TemplateFilter 1 72 20

 

of the considered method for well—positioned nucleosomes. To
quantify this pattern, we measure the difference between the GC
and AA/TT frequencies at the centre of nucleosomes predicted in
chromosome 22. To account for the two—fold symmetry axis of
the nucleosome structure (Richmond and Davey, 2003), the GC
and AA/TT frequencies are calculated from both the sense and
antisense sequences associated with the predictions. 95% confi—
dence intervals are then computed for the difference
A =fGC —fAA/TTI

A A A _ 02
A 6 A i 2&(1— ot/rn>fGC+fA+A (5)

where A zfgc —yfAA/TT, xﬂl — ai/m) is the 100(1 — ai/m)th per—
centile of the chi—square distribution with 1 degree of freedom, n
the number of sequences used for the estimation of f,~ and m the
number of dinucleotides (Goodman, 1965).

Consistently with their role in promoting or repelling nucleo—
some, AA/TT and GC frequencies display U—like and bell—like
shapes in the four methods (Fig. 2). This pattern is more or less
pronounced across methods, as reﬂected by the values of A that
vary from 0.0024 (00018410030) for K—means to 0.0037
(00028410046) for NucleoFinder. When looking at the confi—
dence intervals associated with the four methods, it can be
noticed that they all overlap (Fig. 2), implying that none of
these methods significantly outperform the others. However,
the larger values found in NPS and NucleoFinder support the
idea that these two approaches have a greater ability to detect
well—positioned nucleosomes.

4 DISCUSSION

The recent development of high—throughput sequencing methods
has provided a global insight into how the combination of nu—
cleosome positions and their post—transcriptional modiﬁcations
are key to gene regulation. The precise identiﬁcation of nucleo—
somes is therefore crucial to understanding what determines the
nucleosome architecture and how changes in this organization
induce variation in gene expression. This task is made non—trivial
by the fact that nucleosomes are assayed across cell populations
and consequently result in complex patterns of reads. Another
difﬁculty also arises from the known bias of MNase toward
AT/TA motifs, which potentially can limit the accuracy of nu—
cleosome detection. From our knowledge, no existing
MNase—Seq methods have addressed this issue. To ﬁll this gap,

 

715

ﬁm'spzumofpmjxo'sopeuuopnorq/ﬁdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

