BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

J.-M.Comuet et al.

 

locus of all genes sampled in all populations of the studied data—
set is simulated until the most recent common ancestor according
to coalescence theory. Then a single mutation event is put at
random on one branch of the genealogy (the branch being
chosen with a probability proportional to its length relatively
to the total gene tree length). This algorithm provides the simu—
lation efficiency and speed necessary in the context of ABC,
where large numbers of simulated datasets including numerous
SNP loci have to be generated (see Supplementary Appendix S1
for additional comments on Hudson’s algorithm).

2.2 Computation of scenario probability

Estoup et a]. (2012) recently proposed a methodological innov—
ation to deal with the discrimination among a large set of com—
plex scenarios through efflcient ABC probability computation. It
is based on a linear discriminant analysis on summary statistics
before the logistic regression analysis (introduced by Fagundes
et al., 2007). A major practical advantage is that it substantially
decreases the dimension of explanatory variables making com—
putation of scenario probability (~100 times) faster. We have
implemented this methodological innovation in DIYABC v2.0
for the analysis of both the real datasets and the simulated
pseudo—observed datasets used to evaluate the amount of confi—
dence that can be put into the discrimination of a given set of
scenarios.

2.3 New graphical interface and random number
generator

DIYABC v2.0 has a new user—friendly graphical interface
structured into two main parts: (i) one part including the def—
inition of scenarios, prior distributions, summary statistics and
the production of simulated datasets drawing parameter values
into priors and (ii) other part including all types of post—pro—
cessing computations typical of ABC analyses. Among the new
options proposed, part (i) allows the deﬁnition of different
groups of markers characterized by different mutation
models and summary statistics and part (ii) allows launching
serially multiple post—processing analyses (Supplementary
Appendix S2).

Random number generators (RNG) are an important issue
especially when several processors are used simultaneously for
parallel computing. In DIYABC v2.0, we used RNG of
Mersenne Twister types. In the multithreaded sections of the
codes, which require random draws, each thread uses its own
random generator. We initiate the different RNG with the algo—
rithm proposed by Matsumoto and Nishimura (2000) to produce
independent random streams.

2.4 Implementation

DIYABC v2.0 is a multithreaded program that runs on three
operating systems: GNU/Linux, Microsoft Windows and
Apple Os X. Computational procedures are written in C++,
and the graphical user interface is based on PyQt, a Python
binding of the Qt framework.

3 DISCUSSION

One of the main innovations of DIYABC v2.0 is that it can
analyze SNP data, using an efﬁcient simulation algorithm, there—
fore allowing the treatment of multi—population datasets with
large number of loci (e.g. several thousands to ten thousands
of loci within a few hours to a few days). The analyzed SNP
data are assumed to correspond to independent selectively neu—
tral loci, without any ascertainment bias (AB, i.e. the deviations
from expected theoretical results due to the SNP discovery pro—
cess in which a small number of individuals from selected popu—
lations are used as discovery panel). AB may distort measures of
diversity and possibly change conclusions drawn from these
measures in unexpected ways (e.g. Albrechtsen et al., 2010).
AB is mainly a concern when using SNP data obtained from
chip—based high—throughput genotyping. It should impact to a
much lower extent SNP data obtained from recent next—gener—
ation sequencing technologies, such as shotgun sequencing or
restriction—site associated DNA sequencing techniques that are
increasingly popular, including in population genetics studies of
non—model species (Davey et al., 2012). See Supplementary
Appendix S1 for additional comments on AB. Another advan—
tage of DIYABC v2.0 is that it provides the posterior distribu—
tions of demographic parameters scaled either by the mutation
rate or by the effective population size, in parallel to those of
original parameters. Scaled parameters are sometimes if not
often the only type of parameters that can be robustly inferred
under many evolutionary scenarios (e. g. Wakeley, 2005). Owing
to the compilation optimization of C++ code and the multi—
threading of additional computation sections of the program,
DIYABC v2.0 is also running faster than the previous version
of the program (Supplementary Appendix S3). Finally, the new
interface includes an automatic procedure to produce the differ—
ent files to easily launch simulations on a computer cluster, hence
obtaining access to larger computational resources.

ACKNOWLEDGEMENTS

The authors thank the ‘beta—users’ (Eric Lombaert, Michael
Fontaine, Carine Brouat, Thomas Guillemaud, Christophe
Plantamp, Johan Michaux and Marie—Pierre Chapuis) who
tested the software with their data.

Funding: French Agence Nationale de la Recherche (ANR—09—
BLAN—0145—01), InraiJeune Equipe IGGiPop, CBGP HPC
computational platform and NUMEV Labex.

Conﬂict of Interest: none declared.

REFERENCES

Albrechtsen,A. et a]. (2010) Ascertainment biases in SNP chips affect measures of
population divergence. Mol. Biol. Evol., 27, 2534ﬁ2547.

Beaumont,M.A. (2010) Approximate Bayesian computation in evolution and ecol—
ogy. Annu. Rev. Ecol. Evol. Syn, 41, 3794106.

Beaumont,M.A. et a]. (2002) Approximate Bayesian computation in population
genetics. Genetics, 162, 202572035.

Bertorelle,G. et a]. (2010) ABC as a ﬂexible framework to estimate demography
over space and time: some cons, many pros. Mo]. £001., 19, 260972625.

Cornuet,J.M. et a]. (2008) Inferring population history with DIY ABC: a user—
friendly approach to approximate Bayesian compumtion. Bioiiy’ormuticx, 24,
271372719.

 

1188

ﬁm'spzumofpmJXO'sopnuuopnorq/ﬁdnq

DIYABC V2.0

 

Cornuet,J.M. et a]. (2010) Inference on population history and model checking
using DNA sequence and microsatellite data with the software DIYABC
(V1.0). BMC Bioinformctticx, 11, 401.

Csillery,K. et a]. (2010) Approximate Bayesian computation (ABC) in practice.
Trench“ Ecol. Evol., 25, 41(F418.

Davey,J.W. et it]. (2012) Genome—wide genetic marker discovery and genotyping
using next—generation sequencing. Nat. Rev. Genet, 12, 4997510.

Estoup,A. et a]. (2012) Estimation of demo—genetic model probabilities with ap—
proximate Bayesian computation using linear discriminant analysis on summary
statistics. Mol. Ecol. Re.\'., 12, 84(r855.

Fagundes,N.J.R. et a]. (2007) Smtistical evaluation of alternative models of human
evolution. Proc. Natl Acctd. Sci. USA, 104, l76l¢l7619.

Hudson,R. (2002) Generating samples under a Wright—Fisher neutral model of
genetic variation. Bioiiy’ormuticx, 18, 3377338.

Matsumoto,M. and Nishimura,T. (2000) Dynamic Creation of Pseudorandom
Number Generators. In: Fang,F. et a]. (eds) Monte Carlo and Qua.\'i—Monte
Carlo Met/wih' 1998. Springer—Verlag, New York, pp. 56—69.

Wakeley,J. (2005) The limits of theoretical population genetics. Genetics, 169, 177.

 

1189

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

