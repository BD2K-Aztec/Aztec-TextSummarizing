BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

an?kgowsmomammowoxmom&o:_.=m_w.omm\

median(MEF)

$53“. 390020 mean.

0 PcauE-ll

000V 0r _..0 00_. _. 5.0
D AmmEEmEmE AmevcmﬁmE

a} +0 

++ o
m a

a

+3 0” no
++ G
+ +05 GWDO

0T ,0

Aligned Reads (millions)

O

medianlﬁUpg 1-42)

_|_|_|0|_|_
0000 000% 09 e _.0.0 888— 082

922$“. 09850 C it? maomvcmﬁmE E mm2m> .E52 E30

 

SAMstrt: statistical test for differential expression in single-cell transcriptome

 

which is normalization by putative stably expressed endogenous
features. Although the mES cells with less mRNA had fewer
aligned reads and fewer detected features (Fig. 1A), actually
the original method increased the estimated mRNA content of
mES cells (Fig. 1E) because the original normalization assumes
that the majority of co—expressing genes are not differentially
expressed. However, it contradicts our validated observations
(Islam et al, 2011). In contrast, the proposed SAMstrt judged
that there were only 15 highly expressed features in mES cells,
whereas there were 8441 less expressed features (Fig. 1F).
However, the sum of normalized reads was less in mES cells
than MEF (Fig. 1E), as we had observed (Islam et al, 2011).
Moreover, well—known ES cell markers, e. g. P0u5f1 and Dppa5a,
were still among the signiﬁcantly accumulated genes in mES.

These results lead to the conclusion that the spike—in normaliza—
tion yields accurate quantitation and sensible statistical tests. For
example, if a mononuclear—cell A contained 100 000 transcripts, a
mononuclear—cell B contained 400 000 transcripts and a gene ex—
pressed 100 transcripts in both cells, the proposed method would
avoid to detect it as differentially expressed. We consider that as a
valid interpretation, as there was no change of the transcript count
per nucleus between those two cells. Instead, there must have been
(many) other genes that were overexpressed in cell B.

4 IMPLEMENTAHON

The proof—of—concept was implemented in R (version 3.0) with the
samr package (version 2.0). Presently, users need to install this
package by R CMD install with a downloaded ﬁle from
https://github.com/shka/R—SAMstrt/archive/0.99.0.tar.gz followed
by installation of samr. However, this package will be in the future
bioconductor releases (submitted), and the bug—ﬁx and new fea—
tures will be released at github and bioconductor. This package is
released under the GNU Lesser General Public License (LGPL)
version 3. Although the help documents of the package contain
basic usages, Supplementary Data ﬁle of this article includes more
concrete sample codes and the input data for Figure 1D and F.

It is necessary to prepare a SAMseq—compatible feature matrix
as input, and the matrix must contain several rows beginning
wﬁh FNA_SPIKE_’(eg RNA_SPIKE_1) Thom am ran
counts, which aligned to the spike—in sequences. Therefore,
users can apply this package to any RNA—seq libraries using
not only 8 ArrayControl spike—in molecules but also, for ex—
ample, 92 ERCC spike—ins.

This implementation contains two functions; one is a statistical
test for differential expression, and the other one is calculation of
the normalized values. Loading of the SAMstrt package
[library ( SAMstrt)] overwrites the sequencing—depth estima—
tion of SAMseq for the spike—in normalization. Therefore, users
can use all problem types (e.g. comparisons of more than two
groups, or paired comparison of two groups) and the other op—
timization parameters also for the spike—in—based statistical tests
via function SAMseq after loading of the SAMstrt package.

SAMstrt .normalization calculates the spike—in—based nor—
malized values with conversion to estimated transcripts/sample
values based on the initial concentration of spike—in RNAs.
Those estimations would be transcripts/cell in single—cell experi—
ments and would be transcripts/1 ng—totalRNA in case of 1—ng
experiment; however, users should count number of cells before

RNA extraction for the latter case. This function would be useful
for visualization of the expression changes, or the other type
of statistics, e.g. principal component analysis. However, this
package does not normalize mRNA length bias (neither does
SAMseq), as theoretically STRT synthesizes only one ﬁrst—
strand cDNA from one poly(A)+ RNA (Islam et al, 2012),
whereas full—length RNA—seq expects several fragmented cDNAs
from one RNA molecule with the number of fragment correlating
to the length of the original RNA molecule. Moreover, neither this
package nor the original SAMseq normalizes GC—content bias of
the sequencing templates. Therefore, additional experimental (e.g.
incorporation of unique molecular identiﬁers into the ﬁrst—strand
cDNAs before ampliﬁcation, Kivioja et al, 2012) or mathematical
normalization before the spike—in—based normalization would
improve accuracy of the estimation and the statistical tests.

In conclusion, this proof—of—concept package SAMstrt would
be applicable to user’s own results by STRT and other sequen—
cing—based transcriptome profiling methods, including usual
RNA—seq, with spike—in control molecules. This package with
highly multiplexed library preparation enables ﬂexible experi—
mental designs and more accurate interpretations of differential
expression, especially to reveal complex behaviors between many
cells at single—cell resolution.

Funding: Karolinska Institutet Distinguished Professor Award
(to J .K.); and the Strategic Research Programme in Diabetes at
Karolinska Institutet. The computations were performed on re—
sources provided by SNIC through Uppsala Multidisciplinary
Center for Advanced Computational Science (UPPMAX) under
Project b2010037.

Conﬂict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol, 11, R106.

Bullard,J.H. et a]. (2010) Evaluation of statistical methods for normalization and
differential expression in mRNA—Seq experiments. BMC Bioinformutiex‘, ll, 94.

Chubb,J.R. et a]. (2006) Transcriptional pulsing of a developmental gene. Curr.
Biol, 16, 101871025.

Dobson,A.T. et a]. (2004) The unique transcriptome through day 3 of human pre—
implantation development. Hum. Mol Genet., 13, 146171470.

Hashimshony,T. et a]. (2012) CEL—Seq: single—cell RNA—seq by multiplexed linear
ampliﬁcation. Cell Rep., 2, 666—673.

Islam,S. et a]. (2011) Characterization of the single—cell transcriptional landscape by
highly multiplex RNA—seq. Genome Res., 21, 11601167.

Islam,S. et a]. (2012) Highly multiplexed and strand—speciﬁc single—cell RNA 5/ end
sequencing. Nut. Proton, 7, 8137828.

Kivioja,T. et a]. (2012) Counting absolute numbers of molecules using unique
molecular identiﬁers. Nut. Met/wily, 9, 72774.

Li,J. et a]. (2011) Normalization, testing, and false discovery rate estimation for
RNA—sequencing data. Biox'tutixtiex‘, 13, 5237538.

Li,J. and Tibshirani,R. (2011) Finding consistent patterns: a nonparametric
approach for identifying differential expression in RNA—Seq data. Stat.
Methods Med. Res. [Epub ahead of print, November 28, 2011].

Loven,J. et a]. (2012) Revisiting global gene expression analysis. Cell, 151, 4764182.

Raj,A. et a]. (2006) Stochastic mRNA synthesis in mammalian cells. PLoS Biol, 4,
e309.

Ramskold,D. et a]. (2012) Full—length mRNA—Seq from single—cell levels of RNA
and individual circulating tumor cells. Nat. Biotechnol, 30, 7777782.

Robinson,M.D. and Oshlack,A. (2010) A scaling normalization method for differ—
ential expression analysis of RNA—seq data. Genome Biol, 11, R25.

Tang,F. et a]. (2011) Development and applications of single—cell transcriptome
analysis. Nut. Methods, 8, SGSII.

 

2945

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

