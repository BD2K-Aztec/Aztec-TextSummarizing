Vol. 26 no. 15 2010, pages 1910-1912
APP N doi:10.1093/bioinformatics/btq315

 

Phylogenetics

Advance Access publication June 15, 2010

Count: evolutionary analysis of phylogenetic profiles with

parsimony and likelihood
Mikl s CSL’jr s

Department of Computer Science and Operations Research, University of Montr al, Montr al, Qu bec, Canada

Associate Editor: David Posada

 

ABSTRACT

Summary: Count is a software package for the analysis of numerical
profiles on a phylogeny. It is primarily designed to deal with
profiles derived from the phyletic distribution of homologous gene
families, but is suited to study any other integer-valued evolutionary
characters. Count performs ancestral reconstruction, and infers
family- and lineage-specific characteristics along the evolutionary
tree. It implements popular methods employed in gene content
analysis such as Dollo and Wagner parsimony, propensity for gene
loss, as well as probabilistic methods involving a phylogenetic
birth-and-death model.

Availability: Count is available as a stand-alone Java application,
as well as an application bundle for MacOS X, at the web site
http://www.iro.umontreal.ca/~csuros/gene_content/count.html. It
can also be launched using Java Webstart from the same site. The
software is distributed under a BSD-style license. Source code is
available upon request from the author.

Contact: csuros@iro.umontreal.ca

Received on April 12, 2010; revised on May 27, 2010; accepted on
June 8, 2010

1 INTRODUCTION

Some aspects of genome evolution are best captured by integer
quantities. Given a phylogeny with terminal taxa X, such a quantity
forms a numerical proﬁle, which extends the so-called phylogenetic
proﬁle of presence—absence (Koonin and Galperin, 2002; Pellegrini
et al., 1999) CD: Xl—> {0, 1,2, ...,}. In a typical application, <I>[x]
denotes the number of genes in genome x e X for a certain homolog
gene family: a homolog family comprises all descendants of the
same ancestral gene (Fitch, 2000) in evolutionary lineages. Such
families are routinely identiﬁed by pairwise sequence comparisons,
coupled with the Clustering of postulated homolog pairs (Alexeyenko
et al., 2006; Tatusov et (11., 1997). In other interesting examples, <I> [x]
might be the size (Caetano-Anolles, 2005) of genome x or a sequence
length polymorphism in population x (Witmer et al., 2003).

Given a phylogeny, an evolutionary character’s history can be
inferred by various means in order to reconstruct its state at ancestral
nodes or to estimate the tempo of evolution (Pagel, 1999). The Count
software package provides a convenient graphical user interface to
sophisticated computational methods in such analyses, and to the
manipulation of datasets involving numerical proﬁles. Count was
already used to study the evolution of gene repertoire in Archaea
(Csﬁros and Miklos, 2009) and nucleo-cytoplasmic DNA viruses
(Yutin et al., 2009).

2 FEATURES

Count is designed primarily to work with a dataset of numerical
proﬁles for homolog gene families. It allows for combining multiple
proﬁles with various annotations, as found in databases of Clustered
homolog families such as COG (Tatusov et (11., 1997). Proﬁles
can be ﬁltered by criteria based on presence, membership count
and annotations, in order to compile winnowed datasets for further
analysis.

Given an evolutionary tree T, Count computes the states 5 [u] at
tree nodes ue T, based on each proﬁle CD by imposing <I>[u] :5 [u]
for all terminal taxa u. In parsimony approaches, the ancestral
reconstruction minimizes a criterion based on the implied state
Changes 5 [u] —> 5 [12] over the edges uv. Alternatively, Count works
with so-called phylogenetic birth-and-death models that consider
(5 [u] : u e T) as a random variable with a well-deﬁned distribution.

2.1 Parsimony

Count implements Dollo parsimony (Farris, 1977) and Wagner
parsimony (Farris, 1970). In case of the latter, it also implements an
asymmetric version (Csﬁros, 2008) that penalizes losses and gains
differently. Count also computes Propensity for Gene Loss (Krylov
et al., 2003), which quantiﬁes the frequency of loss for each family
using Dollo parsimony.

2.2 Phylogenetic birth-and-death models

The probabilistic model employed in Count relies on linear birth-
death-immigration processes (Kendall, 1949), commonly used to
model population growth and queuing systems. In the general
phylogenetic birth-and-death model, three rates are assigned to each
branch: gene loss rate H, gene duplication rate A and a gain rate K.
‘Gain’ covers multiple phenomena without specifying the origin of
the gain, including de novo gene formation and lateral gene transfer.
Speciﬁcally, Character evolution on each edge uv with length ‘L' is
stochastically determined by a continuous time Markov process X
with X (0)=E[u] and X (1:)=E[v]. The process is Characterized by
the gain rate K, loss rate [L and duplication rate A: for 0 < n, 0 f t f ‘L'
and any 0 < 6,

lP’[X(t+6)=n‘X(t)=n— 1] =3(K+(n— 1)A+o(1))

P[X(t+6)=n— 1 ‘X(t)=n] =6(nu+0(1))

Less general models may forbid gain (K=0), or duplication
(A = 0), or even both. Paralogs evolve independently in this model,
capturing the birth-and-death evolution of multigene families (Nei
and Rooney, 2005), as opposed to concerted evolution, or events

 

1910 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq uror} popeolumoq

9103 ‘{g anﬁnv 110::

Count: evolutionary analysis of numerical profiles

 

 

 

 

  
 
  

 

|<I ..II.
In ..In
mm a:

 

:- I- | n
will HEIII IillIIl ' I

 .1;- 

l
‘J|.|
I
ILIJ;
' EDI

| I:II"

..--. Mil)r.."l .mulhdo'1 ... “mo-n

 

   

_ r..I.-.
lKr'Jlf‘l
\li

   
 

-
lll.'|| IIJII‘

 

 

 

E i ..... .m. u.

| | l'lel I m.

| I um I III‘

: : mg I I.

: I I-.-: I u I If r

:u II. I In. In ...

:r- I T _

... ...-.-. I..-K 0a.; v-ﬂnnevi

.-. u H um um... I... lulu. r... ..I. -

.: ..... , ,, H, ...f', "m. v kalmruuhn mwmlm
u 3. ma. n In; “if Iran: I
u I... .. I.. I. mi
"5.. ...o lllllﬂ
II III I '
.. .. .. .. I. ... 0  
...u um. ...m;
u .1; n... um:
«us
"as III!“ I. In; . .---. .- --.--.- l.-|.'

“I'm—mo ' I | |

l I : - I
ll |||l| l
- l.“  M

II.

I


 

 

   

 

 

 

Fig. 1. Some graphical displays in Count. On the left. ancestral reconstruction using posterior probabilities. On the right. display of a phylogenetic birth-
and-death model. Annotated features: (1) Dataset of numerical (phylogenetic) proﬁles. (2) Gene family annotations loaded from separate ﬁle. (3) Small proﬁle
logo for each family (black bars show <I>[u] at terminal nodes). (4) Aggregate family-speciﬁc information on number of branches where the family was lost.
gained. expanded and contracted (estimated as expectations. hence the fractional values). (5) Multiple family selection by cell content or the mouse. Selection
is reﬂected on the content of the top-right table and the bottom tree. The top-right table shows lineage-speciﬁc aggregate information on number of families
lost. gained. expanded and contracted on each branch. The bottom tree shows the inferred probabilities for family presence and absence at ancestral nodes
(ﬁlled rectangles). (6) Lineage selection by the mouse in the table row or the node of the bottom tree. The selection brings up more detailed information at
the corresponding node in the bottom tree. (7) Lineage-speciﬁc rates displayed in the top-left table. and depicted on the bottom tree. along with a legend.
(8) Family-speciﬁc rate variation depicted on the top-right. (9) Lineage selection by the mouse in the table row or the node of the bottom tree. The selection
brings up more detailed information at the corresponding node in the bottom tree.

involving multiple members at a time. The standard pruning
algorithm (Felsenstein, 1973) for computing likelihoods cannot be
used with numerical characters, because the ancestral state space
is not bounded. Adequate algorithms were proposed for K = 0, A > 0
(Arvestad et al., 2004, 2009) and for K). > 0 (Csﬁros and Miklos,
2006). Count computes the likelihood using our algorithm described
before (Csﬁros and Miklos, 2009), which applies to the general
model and all the restricted models. Count allows for rate variation
across branches and gene families. Model parameters are set by
maximizing the likelihood. The optimized model can be used for
ancestral reconstruction and to infer lineage-speciﬁc trends by using
posterior probabilities conditioned on the proﬁles.

2.3 User interaction

Figure 1 illustrates the rich graphical user interface of Count. The
program can work with multiple datasets and models at the same
time, in order to help comparisons between different analyses. Entire
work sessions can be saved, and individual analysis results can be
exported into tab-delimited text ﬁles, in order to use with other
programs such as spreadsheet tools. Main software components (rate
optimization and ancestral reconstruction) can also be launched from
the command line without invoking the graphical interface.

2.4 Implementation

Count is written entirely in Java (Java SE 6), and was tested on
various computer platform, including Microsoft Windows, MacOS
X and Linux. In addition, Count is also available as an integrated
application bundle on MacOS X and a Java Webstart application.
The software is distributed with test data and a detailed User’s Guide.

ACKNOWLEDGEMENTS

I am grateful for valuable feedback on the software from Aaron
Darling, Dannie Durand, Maureen Stoltzer, Gergely Szollosi,
Natalya Yutin and Yuri Wolf.

Funding: Natural Sciences and Engineering Research Council of
Canada grant.

Conﬂict of Interest: none declared.

REFERENCES

Alexeyenko,A. et al. (2006) Automatic clustering of orthologs and inparalogs shared
by multiple genomes. Bioinformatics, 22, 697615.

Arvestad,L. et al. (2004) Gene tree reconstruction and orthology analysis based on
an integrated model for duplications and sequence evolution. In Gusﬂeld,D. (ed)
RECOMB '04: Proceedings of the Eighth Annual International Conference on
Research in Computational Molecular Biology. ACM, New York, NY, pp. 3267335.

 

1911

112 /3.IO'S[BHmO[p.IOJXO'SOIJBLUJOJIIIOICWZduq uror} popeolumoq

9103 ‘{g isnﬁnv 110::

M.Csu’r s

 

Arvestad,L. et al. (2009) The gene evolution model and computing its associated
probabilities. J. ACM, 56, 7.

Caetano-Anollés,G. (2005) Evolution of genome size in the grasses. Crop Science, 45,
180971816.

Csﬁros,M. (2008) Ancestral reconstruction by asymmetric Wagner parsimony over
continuous characters and squared parsimony over distributions. In Proceedings
of the Sixth RECOMB Comparative Genomics Satellite Workshop. Vol. 5267 of
Springer Lecture Notes in Bioinformatics, Heidelberg, pp. 72786.

Csﬁros,M. and Miklos,I. (2006) A probabilistic model for gene content evolution
with duplication, loss, and horizontal transfer. In Proceedings of the Tenth
Annual International Conference on Research in Computational Molecular Biology
(RECOMB). Vol. 3909 of Springer Lecture Notes in Bioinformatics, Heidelberg,
pp. 20&220.

Csﬁros,M. and Miklos,I. (2009) Streamlining and large ancestral genomes in
Archaea inferred with a phylogenetic birth-and-death model. Mol. Biol. Evol., 26,
208772095.

Farris,J.S. (1970) Methods for computing Wagner trees. Syst. 2001., 19, 83792.

Farris,J.S. (1977) Phylogenetic analysis under Dollo’s law. Syst. 2001., 26, 77788.

Felsenstein,J. (1973) Maximum likelihood and minimum-steps methods for estimating
evolutionary trees from data on discrete characters. Syst. 2001., 22, 24w249.

Fitch,W.M. (2000) Homology a personal view on some of the problems. Trends Genet,
16, 2277231.

Kendall,D.G (1949) Stochastic processes and population growth. J. R. Stat. Soc. B, 11,
2307282.

Koonin,E.V. and Galperin,M.Y. (2002) Sequence-Evolution-Function: Computational
Approaches in Comparative Genomics. Kluwer Academic Publishers, New York.

Krylov,D.M. et al. (2003) Gene loss, protein sequence divergence, gene dispensability,
expression level, and interactivity are correlated in eukaryotic evolution. Genome
Res., 13, 222972235.

Nei,M. and Rooney,A.P. (2005) Concerted and birth-and-death evolution of multigene
families. Ann. Rev. Genet., 39, 1217152.

Pagel,M. (1999) Inferring the historical patterns of biological evolution. Nature, 401,
8777884.

Pellegrini,M. etal. (1999) Assigning protein functions by comparative genome analysis:
protein phylogenetic proﬁles. Proc. Natl Acad. Sci. USA, 96, 42854288.

Tatusov,R.L. et al. (1997) A genomic perspective on protein families. Science, 278,
631$37.

Witmer,P.D. et al. (2003) The development of a highly informative mouse simple
sequence length polymorphism (SSLP) marker set and construction of a mouse
family tree using parsimony analysis. Genome Res., 13, 485491.

Yutin,N. et al. (2009) Eukaryotic large nucleo-cytoplasmic DNA viruses: clusters of
orthologous genes and reconstruction of viral genome evolution. Virol. J., 6, 223.

 

1912

112 /3.Io's[Bumo[p.IOJxosorwuiJOJurorq”:duq uror} popeolumoq

9103 ‘{g isnﬁnv 110::

