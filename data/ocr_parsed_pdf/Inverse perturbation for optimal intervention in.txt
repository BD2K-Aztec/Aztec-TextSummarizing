ORIGINAL PAPER

Vol. 27 no. 1 2011, pages 103-110
doi: 1 0. 1 093/bioinformatics/btq605

 

Systems biology

Advance Access publication November 8, 2010

Inverse perturbation for optimal intervention in gene regulatory

networks

Nidhal Bouaynayalai‘, Roman Shterenberg2 and Dan Schonfeld3

1Department of Systems Engineering, University of Arkansas at Little Rock, Little Rock, AR 72204, 2Department of
Mathematics, University of Alabama at Birmingham, Birmingham, AL 35294 and 3Department of Electrical and
Computer Engineering, University of Illinois at Chicago, Chicago, IL 60607, USA

Associate Editor: Joaquin Dopazo

 

ABSTRACT

Motivation: Analysis and intervention in the dynamics of gene
regulatory networks is at the heart of emerging efforts in the
development of modern treatment of numerous ailments including
cancer. The ultimate goal is to develop methods to intervene in
the function of living organisms in order to drive cells away from
a malignant state into a benign form. A serious limitation of much
of the previous work in cancer network analysis is the use of
external control, which requires intervention at each time step, for
an indefinite time interval. This is in sharp contrast to the proposed
approach, which relies on the solution of an inverse perturbation
problem to introduce a one-time intervention in the structure of
regulatory networks. This isolated intervention transforms the steady-
state distribution of the dynamic system to the desired steady-state
distribution.

Results: We formulate the optimal intervention problem in gene
regulatory networks as a minimal perturbation of the network in
order to force it to converge to a desired steady-state distribution
of gene regulation. We cast optimal intervention in gene regulation
as a convex optimization problem, thus providing a globally optimal
solution which can be efficiently computed using standard toolboxes
for convex optimization. The criteria adopted for optimality is chosen
to minimize potential adverse effects as a consequence of the
intervention strategy. We consider a perturbation that minimizes
(i) the overall energy of change between the original and controlled
networks and (ii) the time needed to reach the desired steady-state
distribution of gene regulation. Furthermore, we show that there is an
inherent trade-off between minimizing the energy of the perturbation
and the convergence rate to the desired distribution. We apply the
proposed control to the human melanoma gene regulatory network.
Availability: The MATLAB code for optimal intervention in gene
regulatory networks can be found online: http://syen.ualr.edu/
nxbouaynaya/Bioinformatics2010.html.

Contact: nxbouaynaya@ualr.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 21, 2010; revised on October 5, 2010; accepted
on October 23, 2010

 

*To whom correspondence should be addressed.

1 INTRODUCTION

The cell maintains its function via an elaborate network of
interconnecting positive and negative feedback loops of genes and
proteins that send different signals to a large number of pathways and
molecules. Understanding the dynamic behavior of gene regulatory
networks is essential to advance our knowledge of disease, develop
modern therapeutic methods and identify targets in the cell needed
to reach a desired goal. In classical biological experiments, cell
function is ascertained based on rough phenotypical and genetic
behavior. On the other hand, the use of dynamical system models
allows one to analytically explore biological hypotheses. Within this
context, investigators have sought to discover preferable stationary
states, the effect of distinct perturbations on gene dynamics and the
‘dynamical function’ of genes (Abhishek et (11., 2008; Datta et (11.,
2007; Fathallah-Shaykh et (11., 2009; Fathallah-Shaykh, 2005; Qian
and Dougherty, 2009; Qian et (11., 2009; Ribeiro and Kauffman,
2007; Shmulevich et (11., 2002b).

The complexity of biological systems and the noisy nature of
the sampled data suggest the use of probabilistic methods for
system modeling, analysis and intervention. Markov chain models
have been shown to accurately emulate the dynamics of gene
regulatory networks (Kim et (11., 2002). In particular, the dynamics
of Probabilistic Boolean Networks (PBNs) (Shmulevich et (11.,
2002b) and Dynamic Bayesian Networks (Murphy, 2002) can be
studied using Markov chains. The long-run behavior of a dynamic
network is characterized by the steady-state distributions of the
corresponding Markov chain. It has been argued that steady-
state distributions determine the phenotype or the state of the
cell development, such as cell proliferation and apoptosis (Ivanov
and Dougherty, 2006; Kauffman, 1993). The long-run dynamic
properties of PBNs and their sensitivity with respect to network
perturbations were investigated in several manuscripts (Qian and
Dougherty, 2008, 2009; Shmulevich et (11., 2003).

The ultimate objective of gene regulatory network modeling
and analysis is to use the network to design effective intervention
strategies for affecting the network dynamics in such a way as
to avoid undesirable cellular states. As futuristic gene therapeutic
interventions, various control strategies have been proposed to alter
gene regulatory network dynamics in a desirable way. Biologically,
such alterations may be possible by the introduction of a factor
or drug that alters the extant behavior of the cell. Current control
strategies can be grouped into three main approaches (Datta et (11.,
2007): (i) reboot the network by resetting its initial condition
(Shmulevich et (11., 2002c), (ii) introduce external control variables

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 103

112 ﬁlo's[Bruno[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g isnﬁnv 110::

N.Bouaynaya et al.

 

to act upon some control genes, in such a way as to optimize a
given cost function (Datta et (11., 2003, 2007; Faryabi et (11., 2008;
Pal et (11., 2006), (iii) alter the underlying rule-based structure of the
network in order to shift the steady-state mass of the network from
undesirable to desirable states. This last type of intervention is also
referred to as structural intervention (Qian and Dougherty, 2008;
Qian et (11., 2009; Shmulevich et (11., 2002a).

The ﬁrst strategy requires knowledge of the basin of attraction of
the desirable steady-state distribution. For large networks, ﬁnding
the basin of attraction of a given steady state is a computationally
expensive task (Kauffman, l993; Wuensche, 1998). The second
strategy minimizes a given cost function by controlling the
expression level of target genes in the network. In particular, this
strategy assumes prior knowledge of the genes to be used as control
agents and the cost associated with each state of the network. More
importantly, this strategy produces a recurrent control policy, over
a possibly inﬁnite time horizon interval (Datta et (11., 2003, 2007;
Faryabi et (11., 2008; Pal et (11., 2005b, 2006). Clinically, such an
inﬁnite-horizon intervention can be viewed as connecting the patient
to an inﬁnitely recurrent feedback control loop. If the control is
applied over a ﬁnite time horizon and then stopped, the steady-state
distribution of the network (and hence the cell fate) may not change.

The third strategy aims at altering the long-run behavior of
the network or its steady-state distributions. A simulation-based
study was ﬁrst conducted in Shmulevich et (11. (2002a), where
a procedure to alter the steady-state probability of certain states
was implemented using genetic algorithms. Xiao et (11. (Xiao
and Dougherty, 2007) considered an analytical study, where they
explored the impact of function perturbations on the network
attractor structure. However, their algorithms are rather cumbersome
as they need to closely investigate the state changes before and
after perturbations. Moreover, their practical useﬁllness is limited
to singleton attractors, and they do not provide a steady-state
characterization for Boolean networks (Qian and Dougherty, 2008).
An analytical characterization of the effect on the steady-state
distribution caused by perturbation of the regulatory network
appears in Qian and Dougherty (2008). They relied on the general
perturbation theory for ﬁnite Markov chains (Kemeny and Snell,
1960) to compute the perturbed steady-state distribution in a
sequential manner. They subsequently proposed an intervention
strategy for PBNs that affects the long-run dynamics of the network
by altering its rule structure. However, they considered rank-
one perturbations only. The extension of their method to higher
rank perturbations is iterative and computationally very expensive.
Finally, a performance comparison of the above strategies has been
conducted in Qian et (11. (2009).

In summary, the ﬁrst two approaches do not guarantee
convergence toward the desired steady-state distribution. The third
approach, referred to as structural intervention, aims to shift the
steady-state mass from undesirable to desirable states. The proposed
solutions thus far have been limited to either simulation-based
studies (Shmulevich et (11., 2002a) or special cases (e.g. rank-one
perturbations) (Qian and Dougherty, 2008; Xiao and Dougherty,
2007). In this article, we provide a general solution to the problem of
shifting the steady-state mass of gene regulatory networks modeled
as Markov chains. We formulate optimal intervention in gene
regulation as a solution to an inverse perturbation problem and
demonstrate that the solution is (i) unique, (ii) globally optimum,
(iii) non-iterative and (iv) can be solved efﬁciently using standard

convex optimization methods. The analytical solution to this
inverse problem will provide a minimally perturbed Markov chain
characterized by a unique steady-state distribution corresponding
to a desired distribution. Such a strategy introduces an isolated,
one-time intervention that will require a minimal change in the
structure of the regulatory network and converges to a desired
steady-state. Moreover, we cast optimal intervention as a convex
optimization problem, thus providing a globally optimal solution
that can be efﬁciently computed using standard toolboxes for
convex optimization (Boyd and Vandenberghe, 2003). In particular,
we no longer need simulation-based or computationally-expensive
algorithms to determine the optimal intervention. The criteria
adopted for optimality is designed to minimize potential adverse
effects caused by the intervention strategy. Speciﬁcally, we will
focus on minimization of the change in the structure of the network
and maximization of the convergence rate toward the steady-state
distribution. We will therefore investigate the following criteria
for minimal-perturbation control in the solution of the inverse
perturbation problem.

0 Reduce the level of change in the expression level of speciﬁc
genes that are introduced by control agents; that is , we will
minimize the overall energy of change between the original and
perturbed transition matrices as characterized by the Euclidean
norm of the perturbation matrix.

0 Increase the rate of convergence of the network to the
desired steady-state distribution; thus, we will minimize the
time needed to reach the desired steady-state distribution as
evaluated by the second largest eigenvalue modulus of the
perturbed matrix.

This work differs from previous research in optimal structural
intervention in at least three ways: ﬁrst, we do not evaluate the effect
of network perturbation on the steady-state distribution (Qian and
Dougherty, 2008, 2009; Qian et (11., 2009). Although the subject
of perturbation of Markov chains is a well-studied ﬁeld, unlike
the previous works reported in the literature, we do not tackle the
subject of perturbation of Markov chains; instead we propose a new
framework for the solution of the inverse perturbation problem. That
is, the perturbation problem aims to characterize the variation in the
stationary distribution in response to a perturbation of the transition
matrix (Schweitzer, 1968). The inverse perturbation problem, on
the other hand, investigates the perturbation required in order to
reach a desired stationary distribution. The proposed approach to
the inverse perturbation problem therefore has the potential to
have a wide impact in many applications that rely on dynamic
systems. Second, unlike the previous work, which is limited to rank-
one perturbations, we consider any perturbation that preserves the
irreducibility of the original network (Qian and Dougherty, 2008).
Third, whereas previous efforts considered unconstrained optimal
intervention strategies, we focus on optimal control strategies, which
incorporate (energy and rate of convergence) constraints on the
protocols employed in gene regulation designed to reduce adverse
effects as a result of the intervention strategy.

The mathematical notation used in the article as well as the proofs
of several new results are detailed in the Supplementary Material of
this article.

 

104

112 ﬁlo's[Bruno[pJOJXO'sorwurJOJurorqﬂ:duq wort papBOIII/lAOG

9103 ‘1g1sn8nv 110::

Optimal intervention in gene regulatory networks

 

2 METHODS

We consider a gene regulatory network with m genes g1, ...,gm. Where the
expression level of each gene is quantized to 1 values. The expression levels
of all genes in the network deﬁne the state vector of the network at each
time step. Gene g, evolves according to a time-invariant probabilistic law
determined by the expression levels of the genes in the network; i.e. Pr(gi =
xi|g1=x1,...,g,,,=x,,,). for xje {0,l,...,l—l} andj=l,...,m. An approach
to obtain the conditional probabilities of the genes from gene expression data
has been presented in Kim et al. (2002). Shmulevich et al. (2002d) based on
the coefﬁcient of determination in Dougherty et al. (2000). The dynamics of
this network can be represented as a ﬁnite-state homogeneous Markov chain
described by a probability transition matrix Po of size n = 1’". The probability
transition matrix encapsulates the one-step conditional probabilities of the
genes thus indicating the likelihood that the network will evolve from one
state vector to another.

The Markov probability transition matrix. describing the dynamics of
the network at the state level. can be shown to be related to the actual
gene network by observing that the probability law describing the genes”
dynamics can be obtained as the marginal distribution of the state transition
probabilities:

Pr(gi=xilgl---vgm)= 

ZPr(gl =xlv-“7gnl =10):ng "'vgnl)v
it

where 5;,» denotes the set of all xj’s except xi; i.e. 5;,» =
{x 1 , . . . ,xi_1 ,xi+1 , . . . ,xm}. Consequently. if the probability transition
matrix Po is perturbed linearly with a zero-row sum matrix E: {em} 1 ELI-Sn.
then conditional probability of each gene Pr(gi=xi|g1, ...,g,,,) is perturbed
linearly by 21.6] ehj. where h is the index of the state vector [g1,...,g,,,] and
J is an interval isomorphic to {l,2,..., %}. Thus. we observe that ‘small’
perturbations 6,]- << 1 of the probability transition matrix that satisfy the
zero-row sum condition [em-=0. lead to ‘small’ perturbations of the
genes” dynamics.

We assume that Po is ergodic. i.e. irreducible and aperiodic. Therefore.
the existence and uniqueness of the steady-state distribution are guaranteed.
In practice. there are several fast algorithms for checking irreducibility and
aperiodicity in graphs (Sharir. 1981). If Po is ergodic. then the limiting matrix
P80 =lim,,_,OOP6‘ satisﬁes P80 =lnf) (Seneta. 2006). In particular. the rows
of the limiting matrix P80 are identical. This demonstrates that. in the ergodic
case. the initial state of the network has no inﬂuence on the long-run behavior
of the chain.

DEFINITION l. A row probability vector u’=(;11,...,;1,,) is called a
stationary distribution or a steady-state distribution for Po if pf Po 2 pf.

Because Po is stochastic (i.e. its rows sum up to l). the existence of
stationary distributions is guaranteed (Kemeny and Snell. 1960).

Let no denote the undesirable steady-state distribution of Po. We wish to
alter this distribution by linearly perturbing the probability transition matrix
Po. Speciﬁcally. we consider the perturbed stochastic matrix

P=P0+C. (2)

where C is a zero row-sum perturbation matrix. The zero row-sum condition
is necessary to ensure that the perturbed matrix P is stochastic. Let us denote
by nd the desired stationary distribution. We seek to design an optimal zero
row-sum perturbation matrix C such that the perturbed matrix P is ergodic
and converges to the desired steady-state distribution nd.

2.1 The feasibility problem

Schweitzer (1968) showed that the ergodic perturbed matrix P=Po+C
possesses a unique stationary distribution nd. which satisﬁes

71;, = 7130 — C20)“, (3)

where Zo is the fundamental matrix of Po given by Zo=(I —Po+P8°)_l.
Equation (3) requires the computation of no. the initial undesired steady-state

distribution and the fundamental matrix Zo. which involves the computation
of the inverse of an n><n matrix. The following proposition shows that
Equation (3) is equivalent to a simpler and computationally more efﬁcient
condition.

PROPOSITION 1. Consider a stochastic n X n ergodic matrix Po with steady-
state distribution no and fundamental matrix Zo. If C is any n X n matrix,
and nd any probability distribution vector, then we have

nf,=nf,(1—Czo)—‘ <=>n§,(P0+C)=n§,. (4)

In the gene regulatory control problem. we are interested in the inverse
perturbation problem. Namely. given the desired stationary distribution. nd.
we wish to determine a perturbation matrix C that satisﬁes Equation (4).
Notice that there may be multiple solutions to Equation (4); i.e. different
perturbation matrices C could lead to the same desired stationary distribution.
The problem of ﬁnding the set of perturbation matrices satisfying
Equation (4) can be formulated as the following feasibility problem.

The feasible set of the control problem: Given an ergodic network
characterized by its probability transition matrix Po, with stationary
distribution no, and given a desired stationary distribution nd, then the set
of perturbation matrices C, which force the network to transition from no to
nd satisfy the following constraints:

(i) nt’i =nttl,(Po+C), (ii) C120, (iii) Po +CZO. (5)

Constraints (ii) and (iii) ensure that the perturbed matrix P is a proper
probability transition matrix: constraint (ii) imposes that the perturbation
matrix C is zero-row sum. and hence the perturbed matrix P is stochastic
and constraint (iii) requires the matrix P to be element-wise non-negative.
Let D denote the feasible set of perturbation matrices. i.e.

D={CER"X”:nﬁ,=nf,(Po+C),C1=0,Po+C20}. (6)

D is a polyhedra as the solution of a ﬁnite number of linear equalities
and inequalities (Boyd and Vandenberghe, 2003). It is easily shown that
polyhedra are convex sets (Boyd and Vandenberghe, 2003). Observe that D
is non-empty because it contains the perturbation matrix C = In; —Po.

Observe that there are numerous (possibly inﬁnite) perturbation matrices
C which can force the network to transition from an undesirable steady state
to a desirable one. All such perturbations. in principle. constitute plausible
control strategies and can therefore be used to drive the network from
one steady state to another. We impose the minimum-energy and fastest
convergence rate constraints in order to limit the structural changes in the
network and reduce the transient dynamics after perturbation.

2.2 The minimal intervention problem

Because the feasible set deﬁned in Equation (5) is non-empty. there exists
at least one perturbation matrix C . which forces the network to converge to
the desired distribution. A natural question arises then: ‘Which perturbation
matrix should we choose?’. In practice. we are interested in perturbation
matrices. which incorporate speciﬁc biological constraints; e.g. the potential
side effects on the patient and the length of treatment. We translate these
limitations into the following optimality criteria.

2.2.] Minimal-perturbation energy control The minimal perturbation
energy control is deﬁned by minimization of the Euclidean-norm of the
perturbation matrix. It corresponds. biologically. to the control which
minimizes the overall ‘energy’ of change between the perturbed and
unperturbed gene regulatory networks. The Euclidean- or spectral-norm of
C is deﬁned as

||C||2 = maxi||CX||1XERnwllxll=ll (7)
= x/Amax(C’C)= max <C’Cx,x>, (8)
x:IlXIl=l

where Amax(C’ C) 3 0 is the highest eigenvalue of the positive-semi-deﬁnite
matrix CC. and <,> denotes the inner product operator. The minimum

 

105

112 ﬁlo's[BrunoprOJXO'soneuiJOJuioiq”:duq wort pepeolumoq

910E ‘IE JSHBHV 110::

N.Bouaynaya et al.

 

perturbation energy control can be formulated as the following optimization
problem:

M inimal-perturbation energy control:
Minimize ||C||2 subject to Ce D, (9)

where D is the feasible set in Equation (6).

The optimization problem formulated in Equation (9) is a convex
optimization problem. A convex optimization problem is deﬁned as one
that satisﬁes the following three requirements: (i) the objective function
is convex; (ii) the inequality constraint functions are convex; and (iii) the
equality constraint functions are afﬁne (Boyd and Vandenberghe, 2003). A
fundamental property of convex optimization problems is that any locally
optimal point is also globally optimal.

Next. we express the convex optimization problem as a semi-deﬁnite
programming (SDP) problem. which can be solved efﬁciently using standard
SDP solvers. such as SDPSOL (Wu and Boyd. 1996). SDPpack (Alizadeh
et al.. 1997) and SeDuMi (Sturm. 1999). A list of 16 SDP solvers can be
found at the SDP website maintained by Helmberg (2003). We can thus rely
on SDP solvers to efﬁciently compute the optimal perturbation of Boolean
gene networks consisting of 10715 genes (i.e. 21021024 to 215232768
states). Note. however. that the computational efﬁciency of SDP solvers for
larger networks will be lower.

Semi-deﬁnite programming formulation: using the fact that
IICII2 St<=>CtCﬁtzL 220.
we can express the problem in Equation (9) in the following form
Minimize t
subject to CC 5 121, P0 +C 3 0 (10)
ntti(P+C)=nt’i, C1=O

with variables t e R and C 6 RM”. The problem (10) is readily transformed
to a SDP standard form. in which a linear function is minimized. subject to a
linear matrix inequality and linear equality constraints. We ﬁrst observe that.
from the Schur complement. we have
C’Cj121(and120)<=><ﬂ, C):0. (11)
C t]
The inequalities in (10) can be expressed as a single linear matrix inequality

by using the fact that a block diagonal matrix is positive-semi-deﬁnite if and
only if its blocks are positive semi-deﬁnite.

Minimize t
11 C 0

subject to C’ t] 0 i 0 (l2)
0 0 vec(Po + C)

nt’i(P+C)=n:i, Cl=0

At this stage. it is important to notice that we can similarly consider the
L1 norm to produce a sparse perturbation matrix (Boyd and Vandenberghe,
2003).

2.2.2 Fastest convergence rate control A clinically Viable optimality
criterion is to select the perturbation that yields the fastest convergence
rate to the desired steady-state distribution. We know that the convergence
rate of ergodic Markov chains is geometric with parameter given by the
second largest eigenvalue modulus (SLEM) of the probability transition
matrix (Seneta. 2006). The smaller the SLEM. the faster the Markov chain
converges to its equilibrium distribution. The fastest convergence rate control
can be casted as the following optimization problem:

Fastest convergence rate control:
Minimize SLEM (Po + C) subject to C e D, (13)

where D is the feasible set in Equation (6). Observe that for a general (non-
symmetric) matrix. about the only characterization of the eigenvalues is the
fact that they are the roots of the characteristic polynomial. Therefore. the
objective function in (13) is not necessarily convex. and thus the optimization
problem is not convex.

The following obvious proposition determines the optimal fastest
convergence rate perturbation matrix.

PROPOSITION 2. The optimal solution of the optimization problem in (13) is
given by

C* = Inf, —Po. (14)
The optimal SLEM (Po+C*) = 0.

That is the perturbation C* reaches the desired state in a single jump.

The fastest convergent perturbation may. however. result in a large
energy deviation between the original and perturbed networks. Next. we will
investigate the trade-offs between minimal-energy and fastest convergence
criteria.

2.2.3 Trade-oﬁ‘s between minimal-energy and fastest convergence rate
control We denote by P; the minimal-energy perturbed matrix. i.e.
P:— =CE+Po. where C; is the solution of the SDP problem in (12). Let us
consider the family of matrices parameterized by s. along the line between
P:— and the fastest convergent matrix lnﬁi.

P(s) =(1 — op; +s1nt’i. (15)

Equation (15) can be thought of as a continuous transformation of PE into
lntti. The perturbation matrix C (s) =P(s) —Po is then given by

C(s)=p;; —P0 +s(1n;, —P;;). (16)

It is easy to check that C(s)eD for all 05s: 1. When s20. we obtain
the minimal energy perturbation. and when s: l. we obtain the perturbation
that results in the fastest convergence rate toward the desired steady state.
When O<s <1. we will show that we have an inherent trade-off between
minimizing the energy and maximizing the convergence rate.

We say that the vector f is a non-trivial eigenvector of a stochastic matrix
P if f is not proportional to the vector 1. The following proposition provides
an explicit expression of the SLEM of P(s).

PROPOSITION 3. A is an eigenvalue of P(s), 05s: 1, corresponding to a
non-trivial eigenvector if and only if 11: ﬁ is an eigenvalue of P; with a
non-trivial eigenvector. In particular, we have

SLEM (P(s)) =(1 — s) SLEM (Pg). (17)

The following proposition shows that the spectral-norm of C(s) is an
increasing function of s.

PROPOSITION 4. ||C(s)||2, where C(s) is given by Equation (16), is an
increasingfunction ofs, for all 05 s 5 1.

From Proposition (3). it follows that when s increases. the SLEM of the
perturbed matrix decreases. and hence the convergence (toward the desired
state) is faster. On the other hand. from Proposition 4. the norm of the
perturbation matrix. and hence the energy deviation between the original
and perturbed networks. increases as a function of s. Therefore. we have an
inherent trade-off between the energy of the perturbation matrix and the rate
of convergence. The faster we converge toward the desired steady state. the
higher the energy between the initial and perturbed networks.

We would. therefore. like to ﬁnd the optimal trade-off perturbation matrix.
Speciﬁcally. we determine the optimal perturbation matrix. which minimizes
the SLEM while keeping the energy bounded. Such a constraint can be
imposed. for instance. to minimize the side effects due to the rewiring of

 

106

112 /3.10's[1211,1110prOJXO'soneuIJOJuioiq”:duq wort papeolumoq

9103 ‘1g1sn8nv 110::

Optimal intervention in gene regulatory networks

 

the original network. The optimal trade-off problem is readily written as the
following optimization problem:

Minimize SLEM (Po +C)
subject to ||C||256, CED, (18)

where e 3 “C; H is a given threshold. We consider the solution to the
optimization problem in (18) along the line deﬁned in Equation (15). A
local minimum of the optimization problem in (18) might not belong to the
family {P(s)}xdo, 1]. However. the line search seems areasonable choice. and
presents several advantages: (i) it provides a closed-form expression of the
SLEM of P(s) for all 0 5 s5 1; (ii) Contrary to most eigenvalue problems.
which are numerically unstable. the line search has an explicit formula. and
hence is numerically stable; and (iii) it describes a linear behavior of the
optimal solution.

It is straightforward to see that the optimal trade-off perturbation matrix
on the line. deﬁned by Equation (15). is given by C* = C(s*). where s" is the
unique solution to ||C(s*)| l; = 6. However. the optimal trade-off perturbation
matrix requires a numerical computation of the minimal energy perturbed
matrix “P; M. More importantly. if the bound on the energy 6 < “C; | I2, then
we have no solution for the problem (18). Indeed. in some cases. we might
want to constrain the energy of the perturbation matrix C to be no larger
than a ‘small’ speciﬁed threshold (i.e. e< ||CE||2). We will show that. in
this case. we might not be able to reach the desired steady-state distribution.
Intuitively. if the energy of the perturbation matrix is constrained to be too
small. then we might not be able to force the network to transition from one
steady state to another. In this case. we will quantify how far we are from
the desired steady state.

Mathematically. the general energy constrained optimization problem can
be formulated as follows

Energy-constrained fastest convergence rate control:
Minimize SLEM (Po+C) (19)
subject to ||C||2§é, C120, (Po+C)ZO.

where e Z 0. Observe that the optimization problem in (19) is different from
the problem in (18) in two points: ﬁrst. the bound 6 can be any non-negative
number. Second. the perturbation matrix C does not necessarily belong to D.
Observe that the optimization problem in (19) is not a convex optimization
problem as the SLEM of a general (non-symmetric) matrix is not necessarily
convex. We will look for a solution on the line between Po and lntti. i.e. we
consider the family

Q(s)=(1—s)Po +s1nt’i, 05s: 1. (20)
The perturbation matrix. CQ. is therefore given by
CQ(s)=Q(s)—Po=s(1n§i—Po). (21)

In particular. the norm ||CQ “2 = s|| In; —Po||2 can be made arbitrarily small
by choosing a small s. On the other hand. it is easy to see that

SLEM (Q(s)) =(1 — s) SLEM (P0). (22)

The proof of Equation (22) follows the same steps of the proof of
Proposition 3. Therefore. it seems that the family {Q(s)}osxsl provides a
perturbation matrix with an arbitrarily small energy. and an explicit formula
for the SLEM of the perturbed network as a function of the SLEM of the
original network. The drawback. however. is that Q(s) does not necessarily
converge to the desired steady-state distribution. The following proposition
quantiﬁes the difference between the steady state of Q(s) and the desired
steady-state nd.

PROPOSITION 5. The family of matrices Q(s), given in Equation (20), is
ergodic for all 0 5 s 5 1, and therefore converges toward a unique steady-state
distribution nd(s) given by

nd(s) = s(1 — s)(I —(1—s)Pf))_le)(nd — no) +(1 — s)no +snd. (23)

That is
21,,(s) —n,, = (1 — s) (I —s(I— (1 —s)P5)—‘P5) (no —n,,). (24)
Furthermore, we have
“HMO—71d“ SA(P0)(1—S)IIJT0 —7le|~ 05 S S 11 (25)

where A(Po)=1+supk21 “Pg”; which is ﬁnite because Pg has a limit as
k —> 00. If Po is symmetric, then we have a simpler upper bound given by

2 film—mu. 03:1. (26)

 

2
“HAW-7111” S

From Proposition 5. it is clear that when s—> 1. nd(s)—> nd.

3 OPTIMAL INTERVENTION IN THE HUMAN
MELANOMA GENE REGULATORY NETWORK

The inverse perturbation control is applicable in every gene
regulatory network that can be modeled as a Markov chain. In
particular, we note that two of the most popular gene regulatory
network models, PBNs and Dynamic Bayesian Networks (DBNs)
can be modeled as Markov chains (Lahdesmakia et (11., 2006). In
this article, we consider the Human melanoma gene regulatory
network, which is one of the most studied gene regulatory networks
in the literature (Datta et (11., 2007; Pal et (11., 2006; Qian and
Dougherty, 2008). The abundance of mRNA for the gene WNTSA
was found to be highly discriminating between cells with properties
typically associated with high versus low metastatic competence.
Furthermore, it was found that an intervention that blocked the
WntSa protein from activating its receptor, the use of an antibody that
binds the WntSa protein, could substantially reduce WntSA’s ability
to induce a metastatic phenotype (Pal et (11., 2006). This suggests a
control strategy that reduces WNTSA’s action in affecting biological
regulation.

A seven-gene probabilistic Boolean network model of the
melanoma network containing the genes WNTSA, pirin, S100P,
RETl, MARTl, HADHB and STC2 was derived in Pal et (11.
(2005a). Figure 1a illustrates the relationship between genes in the
human melanoma regulatory network. This diagram is a conceptual
abstraction and is not intended as an explicit mechanistic diagram
of regulatory actions. The inﬂuences depicted may be the result of
many intervening steps that are not shown. Some generalizations that
emerge from this conceptual diagram, such as the wide inﬂuence
of the state of WNTSA on the states of other genes, have been
conﬁrmed experimentally (Kim et (11., 2002). Note that the Human
melanoma Boolean network consists of 27:128 states ranging
from 00.0 to 11...1, where the states are ordered as WNTSA,
pirin, S100P, RETl, MARTl, HADHB and STC2, with WNTSA
and STC2 denoted by the most signiﬁcant bit (MSB) and least
signiﬁcant bit (LSB), respectively. The probability transition matrix
of the human melanoma network, derived in Zhou et (11. (2004) and
used in this article, is courtesy of Dr Ranadip Pal.

A naive control strategy, which would exclusively target the
gene WNTSA by reducing its expression level while keeping the
expression levels of the other genes in the network unchanged, will
inevitably fail as it basically resets the initial state of the underlying
process and does not alter the network structure. Biologically, the
complex gene interactions in the network will almost certainly
bypass this gene perturbation and return to their initial cancerous

 

107

112 /3.10's112an0prOJXO'soneuIJOJuioiq”:duq 111011 pepeo1umoq

9103 ‘1g1sn8nv 110::

N.Bouaynaya et al.

 

 

0))

Initial. desired and :nritmlled stationary distributions

 

' Desired disinbuhon
—- Controlled stalionary dISIIIbUIIOn
- Inmal Steady-slate distnbuuun

 

 

 

 

 

 

1le

Fig. 1. Optimal intervention in the human melanoma gene regulatory network. (a) An abstract diagram of the melanoma gene regulatory network (Kim et al..
2002). Thicker lines or closer genes are used to convey a stronger relationship between the genes. The notion of stronger relation between genes is used convey
a higher probability of inﬂuence on their gene expression levels. For instance. WNT5A and pirin have a strong relationship to each other as illustrated by their
proximity in the diagram and the thickness of the lines connecting between them; (b) The original (red line). desired (blue line) and minimal-perturbation
energy controlled (green line) steady-state distributions of the human melanoma gene regulatory network. The x-axis represents the 128 states of the network
ranging from 00. . .0 to 11... 1. and the y-axis indicates the probability of each state. Note that the controlled and desired steady-state distributions are identical.

state. On the other hand, determining the optimal gene intervention
by a brute-force approach is computationally intractable and
experimentally infeasible: even within the context of Boolean
regulation (two-level quantization), the number of experiments to
perform increases exponentially in the number of genes in the
network. For instance, in the seven-gene melanoma network, an
extensive control search amounts to performing 2186 laboratory
experiments; i.e. downregulate and upregulate the expression level
of every gene, every pair of genes, every triple of genes, etc.,
thus requiring ZZ=1(§)2I‘=2186 laboratory experiments. The
proposed inverse perturbation control provides the optimal one-time
intervention that rewires the network in order to force it to converge
to the desired steady state.

Using the breadth ﬁrst search algorithm (Russell and Norvig,
2003), we found that the melanoma probabilistic Boolean network
is irreducible. Therefore, it has a unique stationary distribution,
and we can apply the inverse perturbation control developed in
this article. Because the control objective is to downregulate the
WNT5A gene, we consider the desired steady-state distribution
where the probability of the states having WNT5A upregulated
is 10‘4 and the probability of the other states, which correspond
to WNT5A downregulated is set equal to 0.015525 (see Fig. 1b).
Observe that the states from 0 to 63 have WNT5A downregulated
(0) and hence are desirable states, as compared with states 64 to 127
that have WNT5A upregulated (1) and hence are undesirable. The
probability transition matrices of the human melanoma networks
corresponding to the original and perturbed networks are portrayed
in Figure 2. Observe that the family of perturbed matrices
{P(s)}se10q1, deﬁned in Equation (15), converges toward the desired
steady-state distribution nd, in the sense that P(s)"—>1n:1 as
n—>oo. On the other hand, the family of matrices Q(s), deﬁned
in Equation (20), does not converge to the desired distribution
nd, for 0§s< 1. Figure 3c shows the norm difference between
the steady-state distribution of Q(s), nd(s), and nd as a function
of s. As the parameter s increases, nd(s)—>nd. The advantage
of considering the family {Q(s)} resides in the ability to design

perturbation matrices C (s) with arbitrary small norms (energy) (see
Fig. 3b). This is in contrast to the family {P(s)} where the norm of
the perturbation matrices is lower bounded by the minimal-energy
perturbation matrix norm || C; H. The trade-off between the minimal-
energy and fastest convergence rate is depicted in Figure 3a and 3b.
The steady-state distribution of the human melanoma network of
the original and perturbed networks are shown in Figure 1. Observe
that the after-control steady state is identical to the desired steady
state. Therefore, the control has enabled us to shift the steady-state
probability mass from the undesirable states to states with lower
metastatic competence.

The minimal-energy perturbed matrix, which optimally solves the
SDP problem in (12), is “CE”; = 1.20667 and its SLEM =0.4696.
We have shown that the optimal SLEM of the fastest convergence
rate control is equal to 0, and its energy is given by “C “2 =
||1n:1—P0||2 = 1.81854. The SDP problem has been implemented
in MATLAB and uses the CVX software for convex optimization
(Grant and Boyd, 2010).

The mathematical ﬁndings derived were conﬁrmed by computer
simulation experiments by demonstrating that the optimal
perturbation of a known melanoma gene regulatory network leads
to a desired steady state. In order to reach the ﬁill impact of the
proposed research on gene regulation in biological systems, we plan
to investigate changes in the cell that induce the optimal perturbed
transition matrix. In particular, our current and ﬁiture work will
focus on determining the optimal biological design rules needed to
induce the optimal intervention strategy while limiting ourselves to
biologically viable design rules that rely on modern methods for
molecular control in cellular systems.

4 CONCLUSION

In this article, we introduced a novel method for optimal intervention
in gene regulatory networks posed as an inverse perturbation
problem. The optimal perturbation has been derived such that the

 

108

112 /3.10's112an0prOJXO'soiquJOJuioiq”:duq 111011 pepeo1umoq

9103 ‘1g1sn8nv 110::

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

so mo in so m 139
i I :
m su so
m in m
m m m
3. a " i so m m
,. m I, a m ID. in
1 i i
’0 ’ in
m mo in
m us is:
,, m .3. I w in. m
i so m m I 3. m m
. .. i
- i i
: ' .  '
 _ E i I
. . ' I '
:‘ ' : . I
:: '2 ' I l
,0 so an  I )0 ’° '  I 3° so so
\ -'. j _ I
‘ - a . . . .l .
I . ‘i: - .-  j
. I ' I
we m m .  :  I m w I I  "I. M W.
: I _
i:- ' - - .3 m ' I; 5 us no ' 'l u: .3. u,
1 sii E m | n Inc In I w m m I ,. pm 1,

Fig. 2. Initial and controlled probability transition matrices for the human melanoma gene regulatory network. The matrix plots are obtained using the function
MatrixPlot in MATHEMATICA. They provide a Visual representation of the Values of elements in the matrix. The color of entries Varies from white to red
corresponding to the Values of the entries in the range of 0 7 1. (a) The probability transition matrix of the original melanoma network Po, which converges
toward an undesirable steady-state distribution; (b) the minimal-energy perturbed probability transition matrix P"; (c) P210; ((1) the fastest convergence rate
perturbed probability transition matrix 1112,; (e) P(0.1) in Equation (15); (f) P(0.9) in Equation (15); (g) P(0.1)10; (h) P(0.9)10; (i) Q(0.1) in Equation (20);
(j) Q(0.9) in Equation (20); (k) Q(0.1)10; (l) Q(0.9)10. Observe from (c) and (g) that P}:— and P(s) ‘converge’ toward the desired steady-state distribution 110},
whereas Q(s) ‘converges’ toward nd only for s = 1.

(a)
— SLEM (P(s))
0.8 - x - — -SLEM (Q(s))

0.7 - ‘

 

 

— llpid(s) — pidll
— - - Upper bound

0.6 - \ \

0.5 - ‘ \

0.4 - ‘ c

0.3 - ‘ x

0.2 - \

0.1 - \

 

 

 

 

 

 

 

 

 

0.2 0.4 0.6 0.8 1

Fig. 3. The human melanoma gene regulatory network: (a) Plot of SLEM(P(s)) in Equation (17) (blue continuous line) and SLEM(Q(s)) in Equation (22)
(red dashed line) versus s; (b) Plot of ||C(s)|| in Equation (16) (blue continuous line) and ||CQ(s)|| in Equation (21) (red dashed line) versus s; (c) Plot
of ||nd(s)—nd|| (blue continuous line), and the upper bound 2(21__SS)||no—nay|| (red dashed line) versus 05s: 1, in Proposition 5. The trade-off between
minimal-energy and fastest convergence rate control is clear from (a) and (b). The parameterized family of perturbed matrices P(s) in Equation (15) results in
a faster convergence toward the desired steady-state nd at the expense of a higher norm (energy) of the perturbation matrix. On the other hand, the family of
perturbed matrices Q(s) in Equation (20) leads to a perturbation matrix with norm (energy) as small as desired, but at the expense of not converging toward
the desired steady state for small s. The distance between the steady state of Q(s) and the desired steady state as a function of s is shown in (c).

 

12 ﬁlm's[sumo[prejxosopmurogmorqﬂ:duq mot} pepeo1umoq

9103 ‘19]sanV 110::

N.Bouaynaya et al.

 

regulatory network will transition to a desired stationary or steady-
state, distribution. Biological evidence suggests that steady-state
distributions of molecular networks reﬂect the phenotype of the cell.
In other words, both malignant (e.g. cancer) and benign phenotypes
correspond to steady-state distributions in dynamic system models
of gene regulatory networks.

We developed a mathematical framework for the solution of the
inverse perturbation problem for irreducible and ergodic Markov
chains. Our aim was to derive a minimal-perturbation intervention
policy designed to introduce an isolated, one-time intervention
and induce few changes in the original network structure, thus
minimizing potential adverse effects on the patient as a consequence
of the intervention strategy. The mathematical analysis presented
provides a general framework for the solution of the inverse
perturbation problem for arbitrary discrete-event ergodic systems.

ACKNOWLEDGEMENTS

The authors would like to extend their gratitude to Dr Ranadip Pal
from Texas Tech University for providing the human melanoma gene
regulatory network dataset. The authors are also grateful to Dr S.
Friedland from the University of Illinois at Chicago for illuminating
discussions about this work.

Funding: This project is supported by Award Number
R01GM096191 from the National Institute Of General Medical
Sciences (NIH/NIGMS). The content is solely the responsibility of
the authors and does not necessarily represent the ofﬁcial views of
the National Institute Of General Medical Sciences or the National
Institutes of Health.

Conﬂict of Interest: none declared.

REFERENCES

Abhishek,G et al. (2008). Implicit methods for probabilistic modeling of gene regulatory
networks. In Annual International Conference of the IEEE Engineering in Medicine
and Biology Society, pp. 46214627.

Alizadeh,F. et al. (1997)0 SDPPACK: a package for semideﬁnite-quadratic-linear
programming.

Boyd,S. and Vandenberghe,L. (2003) Convex Optimization. Cambridge University
Press.

Datta,A. et al. (2003) External control in markovian genetic regulatory networks. Mach.
Learn., 52, 1697191.

Datta,A. et al. (2007) Control approaches for probabilistic gene regulatory networks -
what approaches have been developed for addreassinig the issue of intervention?
IEEE Signal Process. Mag, 24, 54463.

Dougherty,E.R. etal. (2000) Coefﬁcient of determination in nonlinearsignal processing.
Signal Process, 20, 221972235.

Faryabi,B.et al. (2008) Optimal constrained stationary intervention in gene regulatory
networks. EURASIP J. Bioinformatics Syst. Biol., 2008, Article ID 620767.

Fathallah-Shaykh,H.M. et al. (2009) Mathematical model of the drosophila circadian
clock: loop regulation and transcriptional integration. Biophys. J., 97, 239942408.

Fathallah-Shaykh,H. (2005) Noise and rank-dependent geometrical ﬁlter improves
sensitivity of highly speciﬁc discovery by microarrays. Bioinformatics, 23,
42554262.

Grant,M. and Boyd,S. (2010) CVX: Matlab software for disciplined convex
programming, version 1.21. Available at http: / /cvxr . com/cvx.

Helmberg,C. (2003) Semideﬁnite programming page. Available at http://www-user.tu-
chemnitz.de/~helmbergsemidef.html.

Ivanov,I. and Dougherty,E.R. (2006) Modeling genetic regulatory networks: Continuous
or discrete? J. Biol. Syst., 14, 2194229.

Kauffman,S.A. (1993) The Origins of Order: Self-Organization and Selection in
Evolution. Oxford University Press, New York.

Kemeny,J.G and Snell,J.L. (1960) Finite Markov Chains. Von Nostrand, New York.

Kim,S. et al. (2002) Can Markov chain models mimic biological regulation? J. Biol.
Syst., 10, 3377357.

L'ahdesm'akia,H. et al. (2006) Relationships between probabilistic Boolean networks
and dynamic Bayesian networks as models of gene regulatory networks. Signal
Process, 86, 8144834.

Murphy,K.P. (2002) Dynamic Bayesian Networks: Representation, Inference and
Learning. PhD Thesis, University of California, Berkeley.

Pal,R. et al. (2005a) Generating Boolean networks with a prescribed attractor structure.
Bioinformatics, 21, 402144025.

Pal,R. et al. (2005b) Intervention in context-sensitive probabilistic Boolean networks.
Bioinformatics, 21, 121141218.

Pal,R. et al. (2006) Optimal inﬁnite horizon control for probabilistic Boolean networks.
IEEE Trans. Signal Process, 54, 237572387.

Qian,X. and Dougherty,E.R. (2008) Effect of function perturbation on the steady-state
distribution of genetic regulatory networks: Optimal structural intervention. IEEE
Trans. Signal Process, 52, 49664976.

Qian,X. and Dougherty,E.R. (2009) On the long-run sensitivity of probabilistic Boolean
networks. J. Theor Biol., 257, 5607577.

Qian,X. et al. (2009) Intervention in gene regulatory networks via greedy control
policies based on long-run behavior. BMC Syst. Biol., 3, 1416.

Ribeiro,A.S. and Kauffman,S.A. (2007) Noisy attractors and ergodic sets in models of
genetic regulatory networks. J. Theor Biol., 247, 7434755.

Russell,S. and Norvig,P. (2003) Artiﬁcial Intelligence: A Modern Approach. Prentice
Hall.

Schweitzer,P.J. (1968) Perturbation theory and ﬁnite Markov chains. J. Appl. Probab,
5, 401413.

Seneta,E. (2006) Non-negative Matrices and Markov Chain, 2nd edn. Springer .

Sharir,M. (1981) A strong-connectivity algorithm and its applications in data ﬂow
analysis. Comput. Math. Appl., 7, 67772.

Shmulevich,I. et al. (2002a) Control of stationary behavior in probabilistic Boolean
networks by means of structural intervention. J. Biol. Syst., 10, 431445.

Shmulevich,I. et al. (2002b) From Boolean to probabilistic Boolean networks as models
of genetic regulatory networks. Proc. IEEE, 90, 177841792.

Shmulevich,I. et al. (20020) Gene perturbation and intervention in probabilistic Boolean
networks. Bioinformatics, 18, 131971331.

Shmulevich,I. et al. (2002d) Probabilistic Boolean networks: a rule-based uncertainty
model for gene regulatory networks. Bioinformatics, 18, 2614274.

Shmulevich,I. et al. (2003) Steady-state analysis of genetic regulatory networks
modelled by probabilistic Boolean networks. Comp. F unct. Genomics, 4,
601408.

Sturm,J.F. (1999) Using sedumi 1.02, a matlab toolbox for optimization over symmetric
cones. 0ptim. Methods Softw., 11, 6254653.

Wuensche,A. (1998) Genomic regulation modeled as anetwork with basins of attraction.
In Paciﬁc Symposium on Biocomputing, pp. 897102.

Wu,S. and Boyd,S. (1996) SDPSOL: A parser/solver for semideﬁnite programming
and determinant maximization problems with matrix structure. Technical Report,
Stanford University.

Xiao,Y. and Dougherty,E. (2007) The impact of function perturbations in Boolean
networks. Bioinformatics, 23, 126571273.

Zhou,X. et al. (2004) A Bayesian connectivity-based approach to constructing
probabilistic gene regulatory networks. Bioinformatics, 20, 291842927.

 

110

112 /3.10's112an0prOJXO'soneuIJOJurorq”:duq 111011 pepeo1umoq

910E ‘IE JSHBHV 110::

