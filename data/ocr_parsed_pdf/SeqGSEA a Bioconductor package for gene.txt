BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

X.Wang and M.J.Cairns

 

combination and a rank-based integration. The rank-based strategy has a
tendency to generate slightly more overrepresented gene sets than the
linear combination. (See Supplementary Note S1 for more details on
DE and DS integration.) We term the integrated scores as gene scores,
representing each gene’s association with the phenotype studied. Finally,
SquSEA uses the state-of-the-art GSEA method (Subramanian et al.,
2005) for functional enrichment analysis. The GSEA method then com-
putes normalized enrichment scores (NESs) for each gene set against the
permutation background, and calls statistical signiﬁcance based on the
observed NESs compared with those on the permutated datasets.
SquSEA ignores the direction of gene expression changes in its analysis,
as the signiﬁcance of direction in DS is ambiguous, and the signiﬁcance of
direction in DE can also be variable, as interacting gene pairs are often
inversely regulated. An overview of SquSEA’s analysis workﬂow is
shown in Supplementary Figure S1.

The SquSEA package includes a built-in capacity to generate well-
designed ﬁgures for users to easily present the results of analysis, and
well-formatted output text ﬁles to archive analysis outcomes with relevant
information. For example, Supplementary Figure S2a shows the distri-
bution of NESs compared with those on the permutated datasets, from
which it is clear that a few gene sets are signiﬁcantly overrepresented in
the studied dataset. Another example in Supplementary Figure S2b shows
the relationship between NESs and P-values, false discovery rates and
family-wise error rates, providing a quick and direct overview of
SquSEA’s analysis results. For each signiﬁcantly overrepresented gene
set, functions are also available to generate detailed gene set-speciﬁc plots
(Supplementary Fig. S3).

SquSEA is implemented in R, and has been deposited in
Bioconductor. With a regular update cycle, SquSEA will keep updating
by taking users’ comments and implementing new functions that make
the package more comprehensive. To reduce analysis running time,
SquSEA was made multi-thread compatible so that users can easily
run SquSEA with a speciﬁed number of multiple cores.

3 APPLICATION EXAMPLES

We applied the SquSEA package to a prostate cancer RNA—
Seq dataset, downloaded from the NCBI SRA database with
accession number SRP002628. The data were generated from
20 prostate cancer samples and 10 matched benign samples by
Illumina GAII, ~22.2 million reads on average per sample. We
mapped the reads to the human reference genome using Tophat,
resulting in BAM files. Read counts at the exon level were com—
puted using Python scripts based on HTSeq released with the
package. DE and DS analyses were then conducted, followed by
DE and DS score integration and gene set analysis with the
GSEA algorithm. The analysis scripts are exempliﬁed in the
package vignette (released with the Bioconductor package; sec—
tion “An analysis example”) and provided in Supplementary
Note S2 with corresponding mathematical explanation. With
linear combination of DE and DS equally contributed,
SquSEA resulted in 16 overrepresented gene sets at false dis—
covery rate 0.05 (Supplementary Fig. S2b).

Comparison with alternative methods. We have compared
SquSEA with alternative analysis pipelines, which can only
account for DE and DS separately, on the prostate cancer
dataset as well as two schizophrenia transcriptome sequencing
datasets and shown that more gene sets with high biological
relevancy can be detected by SquSEA (Wang and Cairns,
2013). A brief summary of this comparison study is provided
in Supplementary Note S3. Moreover, while the existing
GOSeq strategy compensates for biased selection of long and

highly expressed genes (Young et al., 2010), we have not
observed any bias in SquSEA’s gene scores against gene
length or read counts (Supplementary Note S4).

Typical running time. We have recorded the running time with
the cancer data on the MsigDB collection 5 (05, 1454 gene sets).
Using eight cores of Intel Sandy Bridge E5—2600 CPUs, it took
<16 h to ﬁnish. If a gene set collection contains more gene sets, it
takes slightly more time for the whole procedure. We summar—
ized running time of the cancer data and two schizophrenia
datasets across two gene set collections in Supplementary
Table S1.

4 DISCUSSION

SquSEA provides an RNA—Seq data analysis pipeline for func—
tional integration of DE and DS, gathering multiple analysis
steps together into a Bioconductor package, which enables bioin—
formaticians and biologists to interpret their own RNA—Seq data
into biological insight, quickly and easily. The advantage of
SquSEA over existing functional analysis pipelines includes
(i) taking into account sequencing bias and biological variation
with negative binomial models in DESeq and DSGseq, (ii) efﬁ—
ciently accounting of both differential expression and splicing,
(iii) permutation—based gene scores securing enrichment analysis
without bias toward gene sets of long and highly expressed genes
and (iv) cutoff—free property that facilitates detection of subtle
accumulating alteration in gene activity.

This package can also be used for DE— or DS—only GSEA by
setting the weighting parameter in DE/DS score combination to
1 or 0. DE—only GSEA is particularly useful for organisms with
few or none AS, such as prokaryotes. Therefore, SquSEA can
be applied to any organisms and not just higher eukaryotes.

SquSEA performs statistical signiﬁcance assessment based
on subject permutation, and thus requires a moderate samples
size. Greater than five samples per group meets the least require—
ment for running SquSEA. More importantly, enough sample
size is critical to secure accurate analysis results because of the
sample heterogeneity, particularly when studying human sam—
ples, which are generally subject to much larger biological vari—
ation than cell lines or model organisms (Oberg et al., 2012).

Funding: This study was supported by the Schizophrenia
Research Institute, utilizing funding from NSW Health and the
Henderson Foundation; X.W. is supported by a National Health
and Medical Research Council project grant (631057) and MC.
is supported by an MC. Ainsworth Research Fellowship in
Epigenetics. Computational infrastructure used in this work
was provided by Intersect Australia Ltd.

Conﬂict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol, 11, R106.

Djebali,S. et a]. (2012) Landscape of transcription in human cells. Nature, 489,
1017108.

Goeman,J.J. and Buhlmann,P. (2007) Analyzing gene expression data in terms of
gene sets: methodological issues. Bioinformatim‘, 23, 98(k987.

Oberg,A.L. et a]. (2012) Technical and biological variance structure in mRNA—Seq
data: life in the real world. BMC Genomim‘, 13, 304.

 

1 778

ﬁm'spzumol‘pmjxo'sopeuuopuorq/ﬁdnq

SquSEA

 

Subramanian,A. et ul. (2005) Gene set enrichment analysis: a knowledge—based ap—
proach for interpreting genome—wide expression proﬁles. Proc. Natl Acud. Sci.
USA, 102, 15545715550.

Wang,X. and Cairns,M.J. (2013) Gene set enrichment analysis of RNA—Seq data:
integrating differential expression and splicing. BMC Bioiiy’ormuticx, 14
(Suppl. 5), $16.

Wang,E.T. et ul. (2008) Alternative isoform regulation in human tissue transcrip—
tomes. Nature, 456, 470—476.

Wang,W. et ul. (2013) Identifying differentially spliced genes from two groups of
RNA—seq samples. Gene, 518, 164470.

Young,M.D. et ul. (2010) Gene ontology analysis for RNA—seq: accounting for
selection bias. Genome Biol., 11, R14.

 

1779

/810'spzum0fp10}x0"sotJBuIJOJutotqﬂ:duq

