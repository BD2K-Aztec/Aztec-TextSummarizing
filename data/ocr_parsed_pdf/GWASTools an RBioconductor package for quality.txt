BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

S.M.Gogarten et al.

 

SnpAnnotationDataFrame and scanID in a ScanAnnotation
DataFrame), but any number of other variables of different
types may also be included.

An important component of GWAS analysis is ensuring that
annotation is mapped correctly to its corresponding genotype
data. The classes GenotypeData and IntensityData each contain
a NetCDF reader object, a SNP annotation object and a scan
annotation object. On object creation, validity methods ensure
that the primary keys of the NetCDF and annotation objects
match. Most functions in GWASTools take GenotypeData
and IntensityData objects as arguments, such that all necessary
information (e.g. genotype, chromosome and sex) is contained
in a single object. Common methods are provided to access
data across multiple classes, including getSanD, getScanID,
getChromosome, getPosition, getSex and getGenotype.

In designing GWASTools, we took care to separate the appli—
cation programming interface of the GenotypeData and
IntensityData classes from the format in which the data are
stored. This design allows for extension to other data formats
without changing any of the functions that use GenotypeData
and IntensityData objects. For example, GWASTools contains
classes for storing SNP and scan annotation in SQLite format,
and for storing genotype data in—memory as a matrix or on disk
in the highly efficient genomic data structure (GDS) format used
by SNPRelate (Zheng et al., 2012). A GenotypeData object can
be constructed with these objects as well. In addition to the func—
tionality already included in GWASTools, one could make use
of the GenotypeData and IntensityData classes to apply the
many statistical functions available in R to GWAS data.

3 AVAILABLE FUNCTIONALITY

In this section, we present some common tasks utilizing the
GWASTools package.

3.1 Creating NetCDF files

NetCDF ﬁles can be created from data in plain text format, such
as files for Illumina and Affymetrix arrays released by a geno—
typing centre or from PLINK PED/MAP files.

3.2 Statistics by SNP or scan

Allele frequency, missing call rate or heterozygosity can all be
calculated by SNP and by scan, with the option to exclude cer—
tain SNPs or scans. For sex chromosomes, male and female sub—
jects are considered separately. Mean intensity can be calculated
by scan.

3.3 Batch quality

Missing call rate by scan can be compared with genotyping batch
to look for outliers. The allele frequency of each batch compared
with all other batches can also be an indicator of problematic
batches.

3.4 Chromosome anomalies

The B allele frequency (BAF) and log R ratio (LRR) are useful
metrics for detecting chromosome anomalies (Conlin et al., 2010;
Peiffer et al., 2006). BAF and LRR values may be calculated

from the genotype and intensity data if they are not included
in the raw data files. GWASTools uses circular binary segmen—
tation (Venkatraman and Olshen, 2007) to find change points
in BAF and detects loss of heterozygosity by identifying homo—
zygous runs with change in LRR. See Laurie et a]. (2012) for an
application of this method.

3.5 Relatedness

GWASTools contains functions for checking pedigrees for ac—
curacy, as well as inferring pairwise relationships from and plot—
ting kinship coefﬁcients. The companion package SNPRelate
is recommended for relatedness and population structure, and
its native data format may be used in GWASTools.

3.6 SNP quality

SNP quality can be addressed by (i) checking the genotyping con—
cordance between duplicate scans of the same sample; (ii) looking
for Mendelian errors in families; and (iii) f1nding deviations from
Hardineinberg equilibrium in control subjects. Other useful fll—
ters involve removing SNPs with poor genotyping quality scores,
high missing call rate, low minor allele frequency and sex differ—
ences in allele frequency and heterozygosity.

3.7 Association tests

Regression tests (on genotype calls and imputed dosages) and
survival analysis can be performed.

3.8 Plotting

GWASTools contains many plotting functions, including geno—
type cluster plots, BAF/LRR plots with chromosome ideograms,
quantileiquantile plots and Manhattan plots.

3.9 Summary and Performance

For a full description of recommended QC methods and
GWASTools functionality, see Laurie et a]. (2010) and the vign—
ette ‘GWAS Data Cleaning’ supplied with GWASTools.

We compared the performance of GWASTools against PLINK
on a system with a 2.66 Ghz Intel Core i5 processor with 16 GB
RAM and running Mac OS X 10.6.8. The test dataset had 269
samples and 1 134514 SNPs. (i) Missing call rate by SNP:
GWASTools 72s, PLINK with PED format 352s, PLINK with
binary format 153s. (ii) Mendelian errors: GWASTools 199s,
PLINK with PED format 382s, PLINK with binary format 181s.

ACKNOWLEDGEMENTS

GWASTools was developed and tested using data from
the Gene—Environment Association Studies Consortium
(GENEVA, Cornelis et al., 2010, http://www.genevastudy.org).
The authors thank the anonymous reviewers for the helpful
comments that improved the article.

Funding: National Institutes of Health, GENEVA Coordinating
Center (U01 HG 004446); GARNET Coordinating Center
(U01 HG 005157).

Conﬂict of Interest: none declared.

 

3330

ﬁm'spzumofpmjxo'sopnuuopnorq/ﬁdnq

Gumsnmb

 

REFERENCES

Clayton,D. and Leung,H.—T. (2007) An R package for analysis of whole—genome
association studies. Hum. Hered., 64, 4&5].

Conlin,L.K. et a]. (2010) Mechanisms of mosaicism, chimerism and uniparental
disomy identiﬁed by single nucleotide polymorphism array analysis.
Hum. Mol. Genet., 19, 126371275.

Cornelis,M.C. et a]. (2010) The gene, environment association studies consortium
(GENEVA): maximizing the knowledge obtained from GWAS by collaboration
across studies of multiple conditions. Genet. Epidemiol, 34, 3647372.

Laurie,C.C. et a]. (2010) Quality control and quality assurance in genotypic data
for genome—wide association studies. Genet. Epideme 34, 591%02.

Laurie,C.C. et a]. (2012) Detectable clonal mosaicism from birth to old age and
its relationship to cancer. Nat. Genet., 44, 642%50.

Peiffer,D.A. et a]. (2006) High—resolution genomic proﬁling of chromosomal
aberrations using Inﬁnium whole—genome genotyping. Genome Re.\'., 16,
113G1148.

Venkatraman,E.S. and Olshen,A.B. (2007) A faster circular binary segmentation
algorithm for the analysis of array CGH data. Bioiry’ormutiex, 23, 657$63.
Zheng,X. et a]. (2012) A high—performance computing toolset for relatedness
and principal component analysis of SNP data. Bioiry’ormuties [Epub ahead

of print, doizl0.1093/bioinformatics/bts606, October 11, 2012].

 

3331

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

