BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

an?kgowsmomammowoxmoa‘ocgawbmﬁ

 

Supervised de novo reconstruction of metabolic pathways

 

2.3 Reactant pairs

In addition to the conventional reaction equation format, KEGG stores
‘reactant pair’ format (Kotera et al., 2004) to describe enzymatic reac-
tions. A reactant pair represents a pair of substrate and product with
conserved chemical moiety in the reaction. For example, the reaction
equation ‘glucose+ATP=glucose 6-phosphate+ADP’ consists of the
following three reactant pairs: ‘glucose<=>glucose 6-phosphate’ (conser-
ving a glucose moiety), ‘A TP<=>ADP’ (conserving an ADP moiety) and
‘A TP<=>glucose 6-phosphate’ (conserving a phosphate moiety). The
compound pair ‘glucose<=>ADP’ cannot be deﬁned as a reactant pair
because these two compounds do not conserve any atoms in a reaction.
As of November 2012, there were 13564 reactant pairs stored in the
KEGG RPAIR database, which was used as the gold standard dataset.

Reactant pairs are classiﬁed into ﬁve types, main, trans, cofac, leave
and ligase, depending on the context in metabolic pathways, the topology
of the reactant pair graph (the pattern of substrate-product relations in
the reaction representing the ﬂow of atoms) and the atomic element in-
formation. The main type is given manually for at least one of the pairs in
the reactant pair graph, representing the main ﬂow of atoms, which gen-
erally includes the ﬂow in the pathway diagram and/or the ﬂow of or-
ganic carbon atoms. We used the reactant pair that was given main types
in this study.

2.4 Compound—compound pairs

A compoundwompound pair has to be described in two distinct direc-
tions, i.e. forward and backward, to avoid to miss the similarity between a
forward direction of a reaction and a backward of another reaction.
Considering the distinction of forward and backward reactions, the
number of all possible compound pairs is n(n—1)=0(n2), where n is
the number of compounds. The computational cost of searching for simi-
lar compoundwompound pairs would be 0(n4). Among all possible com-
poundwompound pairs, those involved in enzymatic reactions (reactant
pairs) found in all enzymatic reactions in KEGG were 13 564 (as of
November 2012). The number of compounds involved in these reactions
was 6729; thus, the number of all the combination of compounds (com-
poundwompound pairs) was 45 272 712. The number of all possible com-
poundwompound pairs in KEGG LIGAND (involving 15 698
compounds) is 246411 506.

3 METHODS

We formulate the de novo metabolic pathway reconstruction as a series of
reaction predictions (estimation of the enzymatic-reaction likeness) of
each pair of chemical compounds on a metabolic pathway, where the
reaction prediction is solved as the following supervised classiﬁcation
problem. Given a collection of n(n— 1) compoundwompound pairs
(Ci, Cj)(i= 1, ...,n,j= 1, ...,n,i;£j), we estimate a function f(C, C’)
that would predict whether a chemical compound C is converted to an-
other compound C’ in an enzymatic reaction. In addition, we aim to
extract biochemical features contributing to the reaction prediction. In
this section, we present a general approach to solve these problems in a
uniﬁed framework. Our approach consists of three major components: (i)
prediction model, (ii) vector representation of compoundwompound
pairs and (iii) binary classiﬁer.

3.1 Prediction model

Linear models are a useful tool for classiﬁcation and regression especially
for high dimensional data. Basically, a linear model represents an object
0 by a feature vector <I>(0) e m”, and then deﬁnes a linear function
f(0) = wT<I>(0), where w e f)?” is a weight vector. The weight vector w
is estimated such that it can correctly predict the class of objects. The
object 0 is classiﬁed into positive or negative by thresholding the

computed value of f(0). Linear models also have an interpretability of
features. As each element of a feature vector <I>(0) corresponds to an
element of the weight vector w, we can extract effective features contri-
buting to the prediction by sorting elements of <I>(0) according to the
corresponding values of the weight vector w.

The prediction of enzymatic-reaction likeness is not trivial because the
object corresponds to a compoundwompound pair in this study. Let C
and C’ be two chemical compounds. To apply the previous machine
learning approach to this problem, we need to represent a compoundi
compound pair by a feature vector <I>(C, C’) and then estimate a linear
function f(C, C’) = wT<I>(C, C’). The weight vector w is estimated such
that it can correctly predict enzymatic-reaction likeness of compoundi
compound pairs. Finally, the reaction between C and C’ is predicted by
thresholding the value of f(C, C’).

3.2 Vector representation of compound—compound pairs

The design of feature vectors is crucial for the classiﬁcation ability and
interpretability of features in the linear model. We propose two kinds of
feature vectors for each compoundwompound pair based on the bio-
chemical knowledge about enzymatic reactions.

Compounds C and C’ are represented by D-dimensional
ﬁngerprints (binary vectors) as <I>(C) 2 (c1, c2, . . . , cD)T and
<I>(C’) = (c’l, c’z, . . . , c’D)T, respectively, where ck, cj‘, e {0, 1},
k = 1, ..., D. Let I(cond) be an indicator function, where I(cond) = 1 if
cond is true and otherwise I(cond) = 0. Here, we deﬁne two operations for
the ﬁngerprints as follows:

(<1>(C) A <1>(C’)) = (1(61 = Ci = 1), ---J(CD = 62; = 1)).
and
(<I>(C) e <I>(C’)) = (I(c1 = 1, c’1 = 0), ...,I(cD =1,c’D= 0)).

(<I>(C) /\ <I>(C’)) represents the common features in <I>(C) and <I>(C’),
which is referred to as common feature vector. On the other hand,
(<I>(C)e <I>(C’)) represents the features present in <I>(C) and absent in
<I>(C’), which is referred to as differential feature vector. Thus, the both
feature vectors are expected to capture chemical transformation patterns
between compounds C and C’. Using these feature vectors, we propose
two kinds of feature vectors of any compoundwompound pair as follows:

<I>(C, C) = (<I>(C) /\ <I>(C’), <I>(C) e <I>(C), <I>(C’) e <I>(C))T,
and
<I>(C, 0) = (<I>(C) e <I>(C’), <I>(C’) e <I>(C))T.

We shall refer to <I>(C, C’) and <I>(C, C’) as diff-common feature vector
and diff-only feature vector, respectively. The diff-common and diff-only
feature vectors are different in that the diff-common feature vector has
common features in addition to differential features. The diff-only feature
vector is expected to capture substructure changes around the reaction
center in the conversion of a chemical compound to another compound.
The diff-common feature vector is expected to additionally capture core
substructures kept in the conversion of a chemical compound to another
compound.

For example, if <I>(C) = (1,1,0) and <I>(C’) = (1, 0,1) are given,
the corresponding feature vectors are computed as
<I>(C, C’) = (1,0, 0,0,1, 0, 0, 0,1) and <I>(C, C’) = (0, 1, 0, 0, 0,1). The
both feature vectors are asymmetry, i.e. <I>(C, C’) 75 <I>(C’, C) and
<I>(C, C’) 75 <I>(C’, C).

3.3 Binary classifier

We apply linear SVM as a binary classiﬁer. Models are typically learned
to minimize the objective function with a regularization for SVM. It is
well-known that the use of regularization is necessary to achieve a model
that generalizes well to unseen data, particularly if the dimension of

 

i137

ﬁre'spzumol‘pmJXO'sopeuHOJmoiq/ﬁdnq

M.Kotera et al.

 

features is high. One common regularization is Lz-regularization, which
keeps most elements in the weight vector to be non-zeros; therefore, one
can suffer from interpreting features from learned weights. Another pos-
sible regularization is L l-regularization that makes most elements in the
weight vector to be zeros; therefore, one can interpret a limited number
of informative features. In this study, we introduce linear SVM with
Ll-regularization for its high interpretability.

Given a collection of compoundicompound pairs and their labels
(<I>(C,»,Cj),y,»j) where y,»,- 6 {+1, — 1} (i=1, ...,n,j=1, ...,n,i;£j),
linear SVM is formulated by the following unconstrained optimization
problem:

n [71 n
“131121244er 2%},
[:1 j:1

j:i+1
where
M, = max{1 — yiij<1>(C,», C,-), 0}.

To enhance the interpretability of linear models, the weight vector is
optimized with Ll-regularization as follows:

[71
mjnllwlh + Ci :ZMw  Mr},
[:1 j:1

j:i+1

where H - H] is L, norm (the sum of absolute values in the vector) and C is
a hyper-parameter. L l-regularization has an effect of making the weights
of uninformative features zeros without loss of classiﬁcation accuracy.
Ll-regularized linear SVM is referred to as L1SVM, whereas Lz-regular-
ized SVM is referred to as L2SVM.

Learning weight vectors from compoundwompound pairs is a difﬁcult
problem. As the number of compoundwompound pairs is the product of
all the compounds in a dataset, the problem becomes extremely large-
scale. In fact, our dataset consists of 15698 compounds; thus, there are
246 411 506 possible compoundicompound pairs in total. The previous
studies on classifying object pairs (e.g. compoundiprotein and proteini
protein pairs) have used kernel SVM, where the input of the SVM clas-
siﬁer is the kernel similarity matrix (Ben-Hur and Noble, 2005; Faulon
et al., 2008; Jacob and Vert, 2008). However, it is difﬁcult to apply the
kernel SVM to large-scale applications. This is because the time complex-
ity of the quadratic programming problem for the kernel SVM is 0(n6),
where n is the number of compounds, and the space complexity is 0(n4),
which is just for storing the kernel matrix. Moreover, the kernel SVM
does not have an interpretability of features. Another crucial observation
is that <I>(C, C’) and <I>(C, C’) are a sparse binary vector. For such sparse
binary vectors, weight vectors can be learned via efﬁcient optimization
algorithms (Hsieh et al., 2008). In this study, we used an efﬁcient algo-
rithm named LIBLINEAR, which is available from http://www.csie.ntu.
edu.tw/cjlin/liblinear/.

In practical applications, we regarded known reactant pairs as positive
examples and the other compoundwompound pairs as negative examples
because it is impossible to obtain true negative data for enzyme reactions
in reality. In the learning phase, we randomly selected negative examples
for computational efﬁciency, where the ratio of negative examples against
positive examples is set to ﬁve in this study.

3.4 Baseline method

The most straightforward method for the reconstruction is a similarity-
based approach, assuming that reactive compoundwompound pairs are
likely to share high chemical structure similarity. Actually, a substrate
compound and a product compound in an enzyme reaction tend to have
a big core structure, and their different region tend to be small (Kotera
et al., 2008). Tanimoto similarity (Jaccard similarity) between compound
ﬁngerprints can often be considered as a measure of chemical structure
similarity between two compounds. A direct strategy is therefore to

predict the enzyme-reaction likeness between two compounds whenever
the Tanimoto similarity value between these compounds is above a
threshold to be determined. We refer to this approach as BASELINE.

4 RESULTS AND DISCUSSION

4.1 Performance evaluation on enzymatic-reaction
likeness

We tested LlsVM and L2SVM and BASELINE on their
abilities to predict the enzymatic—reaction likeness of given com—
poundicompound pairs from their chemical fingerprint data. We
performed the following 5—fold cross—validation. (i) We randomly
split compoundwompound pairs in the gold standard data into
five subsets of roughly equal sizes. We regarded known reactant
pairs as positive examples and the other compoundwompound
pairs as negative examples. (ii) We took each subset as a test set
and the remaining four subsets as a training set. (iii) We trained a
predictive model based only on the training set. (iv) We com—
puted the prediction scores for compoundwompound pairs in
the test set. (v) Finally, we evaluated the prediction accuracy
over the ﬁve folds.

We evaluated the prediction performance by the receiver oper—
ating characteristic curve, which is a plot of true positives as a
function of false positives based on various thresholds, where
true positives are correctly predicted reactions and false positives
are positively predicted pairs that are not present in the gold
standard reactions. We summarized the performance by the
area under the receiver operating characteristic curve (AUC)
score, where 1 is for a perfect inference and 0.5 is for a
random inference. We repeated the cross—validation experiment
five times and computed the average of the AUC scores over the
five cross—validation folds. The parameters involved in the meth—
ods were optimized with the AUC score as the objective
function.

Table 2 shows the resulting AUC scores and their standard
deviations. Among the eight ﬁngerprints, the PubChem finger—
print achieved the highest AUC scores in some conditions. The
AUC scores of the diff—common feature vector were slightly
higher than those of the diff—only feature vector in both
LlsVM and L2SVM. This result implies that it is important to
take into account not only substructure transformation patterns
but also common substructures in the reaction prediction.
LlsVM and L2SVM outperformed BASELINE, which suggests
that supervised learning with the proposed feature vectors is
meaningful.

LlsVM has a strong advantage over L2SVM in terms of high
interpretability of features. Although the AUC scores of LlsVM
are comparable or slightly worse than those of L2SVM, the
number of features with non—zero weights in LlsVM is signiﬁ—
cantly smaller than that in L2SVM owing to sparsity constraints.
Figure 2 shows a comparison of the number of extracted features
between LlsVM and L2SVM in the case of using the PubChem
fingerprint, where ALL means the number of all elements in the
feature vectors. It was observed that LlsVM extracted a limited
number of features, compared with L2SVM. This allows mean—
ingful analysis of the extracted features for biological interpret—
ation, which is shown in Section 4.4.

 

i138

ﬁre'spzumol‘pmJXO'sopeuHOJmoiq/ﬁdnq

55,2kgogmoddmmowoxwoa‘oﬁsambmﬁ

53x\Ewogmoizmnnw.oxmoagoﬁsiwbwﬁ

EgonmEE ucm
:ozmumcmonoﬁ wuzoﬁocmx

mmEonSmE Emucoomw
.920 E m_mo£:>mo_m

0 $3328 Ucm

mpocmEmCo E 5992

o m:_Em:> Ucm

9929.8 do E 3322

Ew:onmEE vcm mzmwcﬁimoﬁ $020
08 mqu oEEm
555 do E nm.m_>_

826399: Eom 02:3
#839: muzoﬂozz
Em__onm«mE U
o

Em__on£oE 36cm.

E EQEmE ESPEBEU

Em:on£mE ucm
cozmvmcmwuoﬁ wozoﬁocmx

m9 QSQE Emucoomw
EEO E m_mo£:>mo_m

o $39.23 Ucm

c8520 Em__onm_m_>_

thuUNhOO FD Em ODNaQE

Em:onEmE Em m,wm£§mo.n :8sz
mu. m oEEm

355 do Ew__onm.m_>_

Ew__on£mE Eon oc_E<

WamzonEmE muzomﬁzz

Em__0n_£mE $9358ch

 

 

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

o a. e
c o m. n.
6 m. e ale.
0 -e . G
9 //.ﬂA \\ O
. 9'
G r o C 0
o N
g o _. e a
OJ
C O 0 \ ('th
0
i V” I. \&m
u
a o o \
ﬂ
6 6 6 0 a.
g 6 z 0
O C 9
( c... 

c

‘X

0
n!

.0 U
0 / 0 call
3.6?\\l \
0., ie an.
.9
0 w
e. oﬂo
.3 e ®\\H.o
o e. 
/ m.
e e
A.
.IL “xi/I
. e43... to
9
age
0
o
a)
«are
er
0 1

0

(0

 

Supervised de novo reconstruction of metabolic pathways

 

same task is not feasible by other reaction—ﬁlling framework
methods because of their methodological limitation (Kotera
et al., 2008; Tanaka et al., 2009). The compoundifilling frame—
work methods (Gao et al., 2011; Moriya et al., 2010) needed tens
of seconds per compound (corresponding to thousands of hours
for all possible compound pairs).

We examined the newly generated reaction network in detail
(Figs 5 and 6). Among the predicted pairs connected with exist—
ing pathways, some pairs formed triangles with existing path—
ways (e.g. pair B in Fig. 5), meaning that some predicted pairs
may represent two— or more—step reactions. With the closer look
at the chemical structures (Fig. 6), it was also assumed that some
pairs (D, E, G and H) would be possibly converted in more than
one reaction steps. Some pairs were found to have the same
chemical transformations as those in known reactions (e. g.
pairs A, B and C), which looks reasonable to occurr. Among
those without known chemical transformations (e. g. pairs D, E,
F, G, H, I), it would be safe to say some pairs (e.g. pairs D, E
and F) are false positives, and it would not be for other pairs (e. g.
pairs G, H and I). It was found that using chemical fingerprints
can easily produce chemically unrealistic false predictions, which
can possibly be filtered out using graph isomorphism. The effect—
ive integration of the speed of the ﬁngerprints and the accuracy
of the graph isomorphism would be one of the important future
developments.

We further investigated the distribution of possible Enzyme
Commission (EC) numbers for the predicted reactions, and it
was clearly shown that the distribution of predicted reactions is
different from that of known reactions, and diff—common and
diff—only feature vectors favor different molecules or reactions
(see Supplementary Material). For example, diff—common fea—
ture vector found compoundwompound pairs that are possibly
catalyzed by EC3, and diff—only feature vector found those by
EC4. It is supposed that this bias is partly due to the given
compound sets and partly due to the reaction types that the
proposed method can deal with. We assume that the former is
the main reason of the bias in the new prediction because the re—
assignment experiments did not show signiﬁcant difference from
the original EC classiﬁcations compared with new predictions.

As described earlier in the text, our method based on super—
vised reaction—ﬁlling framework has the potential to suggest pos—
sible reactions among large number of known chemical
compounds not only with known chemical transformation pat—
terns but also with unknown transformation patterns. Reaction
reversibility is not considered in this study. One reason is that
only small numbers of enzymatic reactions are known irrevers—
ible in vitro, and the direction of the reactions in vivo may change
according to the context in pathways and conditions. The other
reason is, more importantly, the purpose of this study is gener—
ating the pathways that can be used as a template for modeling
metabolic flux. Testing the generated pathways with metabolic
ﬂux analysis is an interesting and unavoidable future direction of
this study.

5 CONCLUSION

We presented a novel de novo metabolic pathway reconstruction
method in the reaction—filling framework. The proposed method
does not require manually predeﬁned rules, i.e. it automatically

learns a statistical model to predict enzymatic reaction likeness
for any compound pairs based on all possible existing know—
ledge. This method can deal with any compounds (even if they
are not found in KEGG) as long as they are represented in
chemical fingerprints.

An advantage of our method lies in ﬁnding potential reactions
among many compounds at a time. The previous study (Kotera
et al., 2008) used graph isomorphism, which contributed to the
accuracy of the method but took much more calculation time.
The current study used ﬁngerprints (instead of graph isomorph—
ism) to improve calculation time and deal with vast amount of
compounds. For more accurate prediction, we are going to de—
velop the two—step prediction, where ﬁngerprints are applied to
ﬁlter out vast amount of negative pairs in the ﬁrst step, and
graph isomorphism is applied to reﬁne the predicted pairs in
the second step.

In principle, our method (i.e. reaction—ﬁlling framework) is
insufﬁcient to correctly predict a multi—step pathway, which
can be better dealt with the other framework (i.e. compound—
ﬁlling framework). This does not imply which framework is su—
perior; these two frameworks can complement each other for
more successful de novo metabolic pathway reconstruction. We
assume the proposed study is an important preliminary step
toward the hybrid framework.

Further improvement of the de novo metabolic pathway recon—
struction method would enable the on—demand integration of
reaction network and gene (or protein) networks derived from
metabolome and other omics, e.g. genome, transcriptome and
proteome.

ACKNOWLEDGEMENTS

Computational resources were provided by the Bioinformatics
Center, Institute for Chemical Research and the Super
Computer Laboratory, Kyoto University.

Funding: The Ministry of Education, Culture, Sports, Science
and Technology of Japan; the Japan Science and Technology
Agency; and the Japan Society for the Promotion of Science;
MEXT Kakenhi (24700140); Program to Disseminate Tenure
Tracking System, MEXT, Japan.

Conﬂict of Interest: none declared.

REFERENCES

Ben—Hur,A. and Noble,W. (2005) Kernel methods for predicting proteiniprotein
interactions. Bioiiy’ormaticx, 21 (Suppl. 1), i387i46.

Bono,H. et a]. (1998) Reconstruction of amino acid biosynthesis pathways from the
complete genome sequence. Genome Res, 8, 2037220.

Cascante,M. et a]. (2002) Metabolic control analysis in drug discovery and disease.
Nat. Biotechnol, 20, 2437249.

Dandekar,T. et al. (1999) Pathway alignment: application to the comparative ana—
lysis of glycolytic enzymes. Biochem, 343, 1157124.

Darvas,F. (1988) Predicting metabolic pathways by logic programming. J. Mol.
Graph, 6, 8&86.

Faulon,J. et a]. (2008) Genome scale enzyme—metabolite and drug—target interaction
predictions using the signature molecular descriptor. Bioinformaticx, 24,
2257233.

Forst,C. and Schulten,K. (1999) Evolution of metabolisms: a new method for the
comparison of metabolic pathways using genomics information. J. Comput.
Biol, 6, 3437360.

 

i143

ﬁle'spzumol‘pmJXO'sopeuuopuotq/ﬁdnq

M.Kotera et al.

 

Galperin,M. and Koonin,E. (1999) Functional genomics and enzyme evolution.
homologous and analogous enzymes encoded in microbial genomes. Genetica,
106, 1597170.

Gao,J. et al. (2011) The University of Minnesota Pathway Prediction
System: multi—level prediction and visualization. Nucleic Acids Res., 39,
W40(rW4l 1.

Greene,N. et al. (1999) Knowledge—based expert systems for toxicity and metabol—
ism prediction: DEREK, StAR and METEOR. SAR QSAR Environ. Res., 10,
2997314.

Hatzimanikatis,V. et al. (2005) Exploring the diversity of complex metabolic net—
works. Bioiiy’ormatics, 21, 160371609.

Hellerstein,M. and Murphy,E. (2004) Stable isotope—mass spectrometric measure—
ments of molecular ﬂuxes in vivo: emerging applications in drug development.
Curr. Opin. Mol. Then, 6, 2497264.

Hsieh,C.J. et al. (2008) A dual coordinate descent method for large—scale linear
SVM. In Proceedings of the 25th international conference on Maching
Learning, pp. 408415, Helsinki.

Jacob,L. and Vert,]. (2008) Protein—ligand interaction prediction: an improved che—
mogenomics approach. Bioiiy’ormatics, 24, 214972156.

Kanehisa,M. et al. (2012) KEGG for integration and interpretation of large—scale
molecular data sets. Nucleic Acids Res., 40, D1097D114.

Kotera,M. et al. (2004) Computational assignment of the EC numbers for genomic—
scale analysis of enzymatic reactions. J. Am. Chem. Soc., 126, 16487716498.
Kotera,M. et al. (2008) Eliciting possible reaction equations and metabolic path—

ways involving orphan metabolites. J. Chem. Inf. Model, 48, 233572349.

Moriya,Y. et al. (2010) PathPred: an enzyme—catalyzed metabolic pathway predic—
tion server. Nucleic Acids Res., 38, W1387W143.

Nakamura,M. et al. (2012) An efﬁcient algorithm for de novo predictions of bio—
chemical pathways between chemical compounds. BMC Bioiiy’ormatics, 13, S8.

Simmond,M. and Grayer,R. (1999) Plant drug discovery and development. In:
Walton,N. and Brown,D. (eds) Chemicals from Plants: Perspectives 0n Plant
Secondary Products. Imperial College Press, London.

Sreekumar,A. et al. (2009) Metabolomic proﬁles delineate potential role for sarco—
sine in prostate cancer progression. Nature, 457, 9107914.

Steinbeck,C. et al. (2003) The Chemistry Development Kit (CDK): an open—source
Java library for chemo— and bioinformatics. J. Chem. Inf. Compat. Sci., 43,
4937500.

Talafous,J. et al. (1994) A dictionary model of mammalian xenobiotic metabolism.
J. Chem. Inf. Compat. Sci., 34, 132671333.

Tanaka,K. et al. (2009) Metabolic pathway prediction based on inclusive relation
between cyclic substructures. Plant Biotechnol, 26, 4594168.

 

ﬁle'spzumol‘pmjxo'sopeuuopuotq/ﬁdnq

