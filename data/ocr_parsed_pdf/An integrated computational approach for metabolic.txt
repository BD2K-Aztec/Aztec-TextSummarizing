ORIGINAL PAPER

Vol. 29 no. 23 2013, pages 3045-3052
doi:1 0. 1 093/bioinfonnatics/btt5 1 6

 

Systems biology

Advance Access publication October 10, 2013

An integrated computational approach for metabolic flux analysis
coupled with inference of tandem-MS collisional fragments

Naama Tepper1 and Tomer Shlomi1'2'*

1Department of Computer Science, Technion—Israel Institute of Technology, Haifa 32000, Israel and
2Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, NJ 08544, USA

Associate Editor: John Hancock

 

ABSTRACT

Motivation: Metabolic flux analysis (MFA) is a commonly used
approach for quantifying metabolic fluxes based on tracking isotope
labeling of metabolite within cells. Tandem mass-spectrometry (MS/
MS) has been recently shown to be especially useful for MFA by
providing rich information on metabolite positional labeling, measuring
isotopic labeling patterns of collisional fragments. However, a major
limitation in this approach is the requirement that the positional origin
of atoms in a collisional fragment would be known a priori, which in
many cases is difficult to determine.

Results: Here we show that MS/MS data could also be used to
improve flux inference even when the positional origin of fragments
is unknown. We develop a novel method, metabolic flux analysis/un-
known fragments, that extends on standard MFA and jointly searches
for the most likely metabolic fluxes together with the most plausible
position of collisional fragments that would optimally match measured
MS/MS data. MFA/UF is shown to markedly improve flux prediction
accuracy in a simulation model of gluconeogenesis and using experi-
mental MS/MS data in Bacillus subtilis.

Availability and Implementation: Freely available at www.cs.
technion.ac.iI/~tomersh/methods.html

Contact: tomersh@cs.technion.ac.il

Received on June 27, 2013; revised on August 19, 2013; accepted on
August 28, 2013

1 INTRODUCTION

Metabolic ﬂux analysis (MFA) enables the determination of
in vivo metabolic ﬂuxes and is commonly used to address prob-
lems in biotechnology and medicine (Antoniewicz et al., 2007;
Boghigian et al., 2010; Jin et al., 2004; Sauer, 2006; Sillers et al.,
2009; Wiechert, 2002). It is based on feeding cells with isotope-
labeled nutrients, measuring isotopic labeling patterns of intra-
cellular metabolites and applying computational approaches that
analyze metabolite labeling data to estimate ﬂuxes (Antoniewicz
et al., 2007; Wiechert et al., 1999). Biotechnological applications
of MFA are especially diverse and include metabolic engineering,
pathway discovery, ﬁlling gaps in annotated genomes and
mapping of environmental microbial metabolism (Creek et al.,
2012; Kelleher, 2001; Tang et al., 2012; You et al., 2012). The
measurement of isotopic labeling patterns uses either NMR
(Burgess et al., 2003; Jones et al., 1997) or mass-spectrometry
coupled with liquid (LC-MS) or gas (GC-MS) chromatography

 

*To whom correspondence should be addressed.

(Burgess et al., 2003; Kleijn et al., 2007). NMR provides detailed
information on positional labeling of metabolites. However,
NMR analysis requires a large amount of sample, long analysis
times and expensive equipment (Jones et al., 1997). On the other
hand, mass spectrometry is more readily accessible, although it
typically provides limited information on positional labeling, as
isotopomers (i.e. distinct labeling patterns) with the same number
of labeled atoms have the same mass regardless of their position.
A set of isotopomers with the same mass is referred to as mass-
isotopomers, whereas the relative abundance of a metabolite’s
mass-isotopomers is denoted as mass-isotopomer distribution.

Tandem mass-spectrometry (MS/MS; e.g. GC-MS/MS and
LC—MS/MS) provides information on metabolite positional
labeling that can be used to improve flux inference (Choi and
Antoniewicz, 2011; Jeffrey et al., 2002; Ruhl et al., 2012). It
works by isolating a single parent ion from the full spectrum
and measuring its mass, followed by a collision that yields
product ions whose mass is also measured. We denote the
mass-isotopomers of a parent ion by M0 (having no labeled
atoms), M1 (having one labeled atom) and so forth, and the
mass-isotopomers of a product ion by m0, m1 and so forth.
Various MS/MS ion scanning modes enable to measure the
mass-isotopomer distribution of a parent molecule as well as
that of a fragmented product. Ruhl et al. have recently used
LC—MS/MS to measure the mass-isotopomer distribution of
various metabolite fragments in Bacillus subtilis, which were
shown to improve flux inference (Ruhl et al., 2012). MS/MS
can further measure the abundance of speciﬁc collisional transi-
tions from certain parent to product mass-isotopomers, referred
to as tandem mass-isotopomers [e.g. a transition from parent
mass-isotopomer M1 to product mass-isotopomer m1, denoted
(M1 > m1)]. The relative abundance of all tandem mass-isoto-
pomers is referred to as tandem mass-isotopomer distribution.
The importance of tandem mass-isotopomer distribution data
for ﬂux inference was also recently demonstrated (Choi and
Antoniewicz, 2011).

A current limitation of using MS/ MS data for MFA is that the
positional origin of atoms in a collisional fragment must be
known a priori, which in some cases may be difﬁcult to infer.
One method for inferring fragment positions involves injecting
the mass-spec with multiple isotopically labeled standards (Choi
et al., 2012). However, this approach is limited by the lack of
availability of such standards for most metabolites, as well as
the high price of existing isotopic labeled standards. Another
approach is to computationally predict fragment positions
using rule-based and combinatorial fragmentation methods

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 3045

112 /310's112u1n0fp10}x0"sotJButJOJutotq/ﬁduq 11101} popcolumoq

9103 ‘Og isnﬁnv uo ::

N. Tepper and T.Shlomi

 

(Heinonen et al., 2008). Ruhl et al. have recently applied such
methods to examine the position of 172 MS/MS collisional
fragments of 20 metabolites in B.subtilis. However, considering
that these methods predicted multiple possible positions for most
fragments and that further experimental validation of predicted
positions is of need, the unique position of just ~10% of the
fragments was determined and used for ﬂux inference.

Here, we show that MS/MS data can be highly valuable for
MFA, even when fragment positions are unknown. Speciﬁcally,
we suggest an extension to the standard MFA approach, meta-
bolic ﬂux analysis/unknown fragments (MFA/UFs), which uses
steady-state MS/MS data to jointly infer the most likely ﬂuxes in
a metabolic network and the positional origin of fragment
atoms. The method is first applied to predict ﬂuxes in a simula-
tion model of gluconeogenesis given metabolite tandem mass-
isotopomer distribution data. Then, it is applied to predict
ﬂuxes in B.subtilis given measured mass-isotopomer distributions
for both intact metabolites and their collisional fragments.
In both cases, an improved ﬂux prediction performance of
MFA/UF in comparison with the standard MFA approach is
demonstrated.

2 METHODS

2.1 The mathematical formulation of MFA/UF

MFA aims to ﬁnd a steady-state ﬂux distribution (v), satisfying stoichio-
metric mass-balance constraint (and potentially other constraints on
nutrient uptake and by—product secretion rates), such that metabolite
labeling patterns, which are uniquely determined by the ﬂux distribution
(Mollney et al., 1999; Wiechert et al., 1997; Wiechert et al., 1999), would
optimally match experimental measurements. Speciﬁcally, given experi-
mental mass-isotopomer distribution MID?” for each metabolite i in
some metabolite set E, MFA is formulated as an optimization function
that aims to maximize the log likelihood of these measured mass-isoto-
pomers. Assuming a Gaussian error model for measured mass-isotopo-
mer data, maximum log likelihood is obtained by minimizing the
variance-weighted sum of squared residuals between measured and
predicted (MIDf’”d(v)) mass-isotopomer distributions:

mvin 2|:(M1Df’q’ — MIDf’”d(v)) T; VAR;1 . (MIDfXI’ — MIDf’”d(v))]

ieE
S.t.
S > v = 0

where VAR,— represents the measurement variance matrix (having meas-
urement variances on the diagonal), and S represents a stoichiometric
matrix. In all applications of MFA/UF performed here, we assumed a
variance of 0.2 mol% in measured isotope distributions, following Choi
and Antoniewicz (201 1). The mass-isotopomer distribution for metabolite
i (MIDfmd(v)) can be efﬁciently computed for a given ﬂux vector v (while
evaluating the objective function of the above optimization problem) via
either elementary metabolite unit (Antoniewicz et al., 2007) or based on
the complete isotopomer distribution of metabolite i (denoted 1D,)
derived by either cummomer (W iechert et al., 1999) or ﬂuxomer (Srour
et al., 2011) approach. Given the isotopomer distribution of metabolite i,
its mass-isotopomer distribution can be calculated as following:

MIDi’Wv) = Cir/Div) (1)

where C,- is a matrix in which CL);( = 1, if the k’th isotopomer of
metabolite i has j labeled atoms.

Applying MFA given a mass-isotopomer distribution for a fragment F
of metabolite i (denoted MID???) would require computing the corres-
ponding mass-isotopomer distribution for that fragment based on the
ﬂux vector v (MI i?d(v)), which could also be easily calculated from
the predicted isotopomer distribution:

MIDQ’ﬁ‘Qv) = CfID,(v) (2)

where Cf is a matrix in which Cf“ = 1 , if fragment F of the k’th
isotopomer of metabolite i has j labeled atoms. Similarly, given a
tandem mass-isotopomer distribution for fragment F of metabolite i
(representing the abundance of detected transitions from a speciﬁc
parent to product mass-isotopomers in metabolite i; denoted TMIDE"; ,
it can be calculated from the isotopomer distribution as following:

TMIDﬁ’ﬁﬂv) = CfID,(v) (3)

where in this case, C,—F is a matrix in which Cf“ = 1 if the k’th isotopo-
mer of metabolite i is consistent with the j’th tandem isotopomer, in
respect to fragment F of metabolite I, i.e. if (i) the total number of labeled
atoms in the isotopomer is the same as in the parent ion of the tandem
isotopomer, (ii) the number of labeled atoms in that isotopomer, within
the fragment F, is the same as in the product ion of that tandem
isotopomer. An example for how C,—F is deﬁned is shown in Equation
(5) later in the text (see also Choi and Antoniewicz, 2011). Notably, the
predicted tandem-mass isotopomer distribution for metabolite i in respect
to fragment F can be adjusted for natural isotope abundances as shown in
Choi and Antoniewicz (2011).

Given a mass-isotopomer distribution or tandem mass-isotopomer
distribution for some unknown fragment of metabolite i [denoted
(DMIDfXP for simplicity], assuming that each possible fragment F
(within a predefined fragments list) can be produced by the MS/MS col-
lision with probability AiF , the corresponding prediction [denoted
(DMIDf’C‘ﬁ can be calculated as following:

(DMIDimd(V’ A) = ZFE{ fragments of

tic-Flaw) (4)
metabolitei }

here, we suggest a variant of MFA, MFA/UF, that simultaneously
searches for a ﬂux vector v and fragment probabilities A (also referred
to as fragment weight variables) that maximizes the log likelihood of the
measured mass-isotopomer or tandem mass-isotopomer distributions:

T
min“), Z [((DMIDfXP — (7)MID§”""(v,i,—)) . VAR;1

ieE

.(mMIDjiXP — (T)MID§””"(v, A,))]

F _ . .
2F { fragments of} AI. _ 1, for each metabolite [6E
E

metabolite i

To solve the above optimization problem, we used Matlab’s implemen-
tation of the sequential quadratic optimization (SQP) algorithm. To over-
come local minima, the SQP optimization was run multiple times, starting
from random starting points.

To compute ﬂux conﬁdence intervals for a given reaction by MFA/UF
(or by our implementation of MFA), we used the likelihood ratio test to
compare the maximum log-likelihood estimation, computed by the above
SQP optimization, to that obtained when constraining the ﬂux to higher
or lower values. Speciﬁcally, we iteratively run the SQP optimization to
compute the maximum log-likelihood estimation while constraining the
ﬂux to increasing (and then decreasing) values (with a step size equal to
5% of the ﬂux predicted in the initial maximum log-likelihood estima-
tion). The conﬁdence interval bounds were determined based on the 95%

 

3046

112 /310's112u1n0fp10}x0"sotwuuoiutotq/ﬁduq 11101} papeolumoq

9103 ‘Og isanV uo ::

MFA coupled with inference of MS/MS fragments

 

quantile of XZ-distribution with one degree of freedom (Antoniewicz
et al., 2006). The results of this iterative process (i.e. the probability of
a reaction having a range of possible ﬂux rates) were also used to calcu-
late the standard deviation of ﬂux predictions. A similar method was used
to compute conﬁdence intervals for fragment weights (i.e. A variables).
Although the running time of each SQP optimization was on the order
of a few minutes, computing accurate conﬁdence intervals with the
described approach is computationally intensive and was run on a com-
puter cluster with ~100 CPU cores (taking a total of ~30h for the
analysis presented later in the text).

3 RESULTS

3.1 An example of using MS/MS data for inferring ﬂux
rates and position of collisional fragments

Figure 1 shows an example metabolic network, demonstrating
how MS/MS data can be used to jointly infer metabolic ﬂuxes
and position of collisional fragments. In the example, a 3-carbon
metabolite (A), labeled in carbons 1 and 2, is being taken up from
the medium in a known rate (v1). Reaction v4 transforms
metabolite A to D, making an isotopomer of D that is labeled
in the first two out of three carbons (denoted D110). A pathway
through v2 makes D that is labeled in the first carbon (D100),
and a pathway through V3 makes D that is labeled in the third
carbon (D001). Hence, based on isotopomer balance consider-
ations, all ﬂuxes can be determined given the D’s isotopomer
distribution (denoted IDD; representing the relative abundance
of each isotopomer of D): v2=v1*IDD100, v3=v1*IDD001, and
v4=v1*IDD110. Given the mass-isotopomer distribution of
D (denoted M IDD), standard MFA cannot determine the speciﬁc
ﬂuxes through v2 and v3, as both D100 (made through V2) and
D001 (made through V3) belong to the M1 mass-isotopomer
of D. Next we examine whether the abundances of all three
isotopomers of D (and hence all ﬂuxes in this network) can be
inferred given: (i) a tandem mass-isotopomer distribution of D
with either known or unknown fragment positions and (ii) a
mass-isotopomer distribution for both intact D and its fragment,
whose position is either known or not.

First, we assume that a tandem mass-isotopomer distribution
for metabolite D with a 2-carbon fragment F is given (denoted
TMIDD,F). Assuming, that the position of fragment F is known
and that F consists of the ﬁrst two carbons of D (denoted D 1,2),

 

V4 v1

 

 

 

 

 

Fig. 1. An example metabolic network model and the labeling pattern of
its metabolites. As shown, metabolite D is labeled in its ﬁrst two carbons
(for D made Via reaction v4), only in its ﬁrst carbon (for D made Via v2)
or only in its last carbon (for D made Via v3)

the abundance of all three isotopomers can be inferred [based on
Equation (3)]:

TMIDD,F, M0>m0 0

TMIDD, F, Ml >m0 [Doom

TMIDD,F,Ml>ml : 100100 (5)
TMIDD,F,M2>ml 0

TMIDD,F, M2>m2 IDDl 10

TMIDD,F, M3 >m2 0

Alternatively, we assume that the MS/MS collision makes either
one of two fragments: D1; and D23, or a combination of both
with probabilities A 1, 2 and A 2, 3, respectively (where A I; + A 2, 3 = 1).
Under this assumption, both the isotopomer distribution and
fragment probabilities can be calculated as follows [based on
Equation (4)]:

TMIDD,F,M0>m0 0 0
TMIDD,F,Ml>m0 [Doom 100100
TMIDD F Ml >ml 100100 [Doom

’ ’ — A + A 6
TMIDD,F,M2>m1 1’ 0 2’3 100110 ( )
TMIDD,F,M2>m2 100110 0
TMIDD,F, M3 >m2 0 0

As shown, tandem mass-isotopomer [M2>m2] is produced solely
from the D12 fragmentation of D110, and [M2>m1] produced
from the D23 fragmentation of D110; hence, the abundance of
D110 is equal to the sum of abundances of [M2>m2] and [M2>m1]
(as A I; + A 2, 3 = 1). The fragment probabilities can hence be calcu-
lated based on the relative abundance of the two tandem mass-
isotopomers: A12:[M2>m2]/([M2>m2]+[M2>m1]). Given the

Table 1. Four examples of tandem mass-isotopomer distributions for
metabolite D in the example network (Fig. 1) and the corresponding
predictions of collisional fragment probabilities and ﬂuxes [as inferred
from Equation (4)]

 

 

Parameter Case I Case II Case III Case IV
[MO > m0] 0 0 0 0
Tandem mass—isoto— [M1 > m0] 0.1 0.1 0.2 0
pomer [Ml >ml] 0.3 0.3 0.2 0.4
distribution of [M2>m1] 0 0.15 0.3 0.15
metabolite D [M2 > m2] 0-6 0.45 0.3 0.45
[M3 > m3] 0 0 0 0
Fragment 112 1 0.75 0.5
probabilities 123 0 0.25 0.5
v2 0.3 0.4 [041.4]
Fluxes v3 0.1 0 [04).4]
v4 0.6 0.6 0.6

 

Note: In ‘Case I’, the non—zero abundance of [M2>m2] and zero abundance of
[M2>m1] suggests the existence of a single fragment of D, D12, and hence the ﬂux
through reactions v2 and v3 is proportional to the abundance of [M1 >ml] and
[M1 >m0], respectively. In ‘Case 11’, the ratio between [M2>m2] and [M2>m1] is
3:1, suggesting that fragment D13 is three times more frequent than D23. In ‘Case 111’,
the probability of the two fragments is equal (A 1,2 = 0.5 and A 2, 3 = 0.5), and it is hence
impossible to differentiate between ﬂux going through reactions v2 and v3 [which is
reﬂected by the multiple solutions to Equation (7)]. In ‘Case IV’, there is no solution to
Equation (7), suggesting that one of the undelaying assumptions regarding the net—
work structure, reactions atom mapping or possible fragment positions is incorrect.

 

3047

112 /3.10's112u.1n0[p.10}x0"sotwuiJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og isanV uo ::

N. Tepper and T.Shlomi

 

inferred fragment probabilities, IDDIOO IDDIOO and IDDOOI linearly
depend on the abundances of [M 1>m0] and [M 1>m1] and are
straightforwardly calculated. Table 1 shows several examples of
possible tandem mass-isotopomers of D, and the corresponding
fragment probabilities and ﬂuxes derived based on Equation (6).
Two notable examples are ‘Case 111’, where the probability of the
two fragments is equal to 0.5, and hence Equation (6) is under-
determined and cannot be used to uniquely infer IDDloo and
IDDOOI. In ‘Case IV’, there is no solution to Equation (6), suggest-
ing that at least one the undelaying assumptions regarding the net-
work structure, reactions atom-mapping or considered fragment
positions of D is incorrect.

Next, we consider the case where a mass-isotopomer distribu-
tion for both the intact D (denoted MIDD) and a 2-carbon frag-
ment F of D are given (denoted MIDD, F). If the fragment
position is known to be D13, for example, then all three isoto-
pomers of D can be easily inferred (not shown). Alternatively,
assuming the fragment position is unknown, and may be either
D32 or D23 (with probabilities A 12 and A23, respectively), as
in the above example, MIDDJ: MIDDJ: can be expressed as
following [based on Equation (4)]:

MIDD,F,M0 [Doom
MIDD,F,M1 = 41,2 IDDIOO
MIDD,F,M2 IDDllO (7)
IDDIOO
+ 42,3 100110 + [Doom
0

Considering that the mass-isotopomer distribution of the intact
D can be expressed as:

MIDQMQ 0

M100,141 : 100100 + [Doom (8)
MIDD,M2 IDDllO

MIDD,M3 0

both the fragment probabilities and abundances of all three
isotopomers of D can be inferred from equations in Equations
(7) and (8).

3.2 Applying MFA/UF in a simulation model of
gluconeogenesis

To evaluate the performance of MFA/UF, we applied it as well
as on standard MFA on a simpliﬁed model of gluconeogenesis
shown in Figure 2 (adapted from (Choi and Antoniewicz, 2011).
The stoichiometry and atom transitions for the network reac-
tions are given in Choi and Antoniewicz (2011). Aspartate and
acetyl-CoA are provided as substrates, whereas glucose and
carbon dioxide are products. We assumed a mixture of aspartate
isotopomers in the media as in Choi and Antoniewicz (2011),
with the following composition: 30% [1, 2-13C] aspartate, 20%
[4-13C] aspartate, 25% [2, 3, 4-13C] aspartate and 25% unlabeled
aspartate, while provided acetyl-coA is unlabeled. The carbon
dioxide pool is assumed to remain non-labeled, owing to high
rate of mixing with the non-labeled, atmospheric C02. In all
applications of MFA and MFA/UF, citrate synthase ﬂux

Glucose
9.1] AcetyIPCoA mo
SD 1110 100
"In 911 t s 100
so 1 z

 
  

13
[ CIAspartate I Oxaloacetate

an 2 4
1m
nln an
140 i 1 nlo Glyoxylate
a

017

   
 

22:1
15:) "1°
m 220 a 1

150! 7

Fumarate u—Ketoglutarate
so 1 4
10
mo 63 1 53
1°“ Succinate m i 1
100

Fig. 2. A metabolic network of gluconeogenesis, with TCA cycle and
glyoxylate shunt [adapted from (Choi and Antoniewicz, 2011)]. For
each reaction, the assumed ﬂux, predicted ﬂux Via MFA given a mass-
isotopomer distribution for citrate and predicted ﬂux Via MFA/UF given
a tandem mass-isotopomer distribution for citrate with the fragment
citrate1’2’3 are shown (from top to bottom). Reactions for which the
predicted ﬂux standard deviation is as high as the assumed ﬂux were
considered non-observable (and marked ‘n/o’)

(making citrate from oxaloacetate and acetyl-CoA) was assumed
to be equal to 100:I:0.1.

The evaluation of MFA/UF and MFA involved the following
procedure: (i) We assumed that metabolic ﬂuxes are known for
all reactions in the network, considering the ﬂuxes from Choi
and Antoniewicz (2011) (shown in Fig. 2). (ii) Given these ﬂuxes,
we computed the mass-isotopomer distribution for five metabol-
ites: citrate, a-ketoglutarate, succinate, fumarate and oxaloace-
tate. We further computed tandem-mass isotopomer
distributions for citrate considering 4 different fragments of
size 4, for a-ketoglutarate considering 3 fragments of size 3,
and for succinate, fumarate and oxaloacetate considering 3 frag-
ments of size 2, giVing a total of 16 tandem mass-isotopomer
distributions. (iii) We applied MFA given the mass-isotopomer
distribution of citrate, a-ketoglutarate, succinate, fumarate or
oxaloacetate (a total of 5 runs), and applied MFA/UF given
each of the 16 tandem mass-isotopomer distributions described
earlier in the text. In the application of MFA/UF, we assumed
that the fragment position is unknown, providing the algorithm
with a list of possible fragments in each run (assuming the same
four possible fragments for citrate and three fragments for
a-ketoglutarate, succinate, fumarate and oxaloacetate used
earlier in the text). (iV) Reassuringly, in all applications of
MFA and MFA/UF, the predicted 95% ﬂux conﬁdence intervals
encompassed the assumed ﬂuxes (used in the generation of label-
ing data), and hence the predictive performance of the two
approaches was evaluated based on the size of the conﬁdence
intervals (expressed in percentage of the assumed ﬂux).

We ﬁnd that the prediction performance of MFA/UF, given
tandem mass-isotopomer distributions (assuming fragment pos-
itions are unknown), is markedly higher than that of standard
MFA given the mass-isotopomer distribution data (Fig. 3).
Specifically, conﬁdence interval sizes derived by MFA/UF are
~2-fold smaller on average than those derived by MFA (across
all reactions and applications of MFA/UF and MFA). Given 11

 

3048

112 /3.10's112u.1n0[p.101x0"sotwuuqutotq/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

MFA coupled with inference of MS/MS fragments

 

 

150

14° -MFA10F
-MFA
100
so
so
70
60- . -
50
4o . 1 ‘ "
30 ‘
20 i . .
1o
0 \- @111;

Fig. 3. Average size of ﬂux conﬁdence intervals in the gluconeogenesis
model predicted by MFA based on mass-isotopomer distributions of
intact metabolites and by MFA/UF given tandem mass-isotopomer dis-
tributions of various collisional fragments of oxaloacetate, or-ketogluta-
rate, fumarate, citrate and succinate (fragment carbons in metabolite M
denoted by Mx-y). Applications of MFA/UF that result in signiﬁcantly
smaller ﬂux conﬁdence intervals compared with those obtained by MFA
(based on Wilcoxon ranked sum test) are marked with an asterisk.
Metabolite abbreviations: OAA, oxaloacetate; AKG, or-ketoglutarate;
Fum, fumarate; Cit, citrate; Suc, succinate

_t_t_i
-1uw
DOG

average conﬁdence interval size
(in "if: of assumed ﬂux rates)

 

 

 

 

1—4911- I _*_f I_-__

a :1 TI —11

a 7 7

.2

.so.a— -

s

C

a

,:05-

I:

o x I n x

0

50.4— -

(D

3

E

ED.2- -

I!)

9

LL
0* _
"r'bv'bv‘o‘lr‘b revch 93v
ddeggégggggggﬂya

“\GG‘anU

§0c§$$$k°q°<¢°o “fee?

Fig. 4. Predicted fragment weights by MFA/UF given tandem mass-
isotopomer distributions of various collisional fragments of oxaloacetate,
or-ketoglutarate, fumarate, citrate and succinate. For each application of
MFA/UF given a tandem mass-isotopomer distribution for a metabolite
with a certain fragment, the conﬁdence interval of the weight variable
corresponding to that speciﬁc fragment is shown. A value of 1 represents
a prediction of the correct fragment being the only product of the
collision, whereas lower values represent the possible existence of other
fragments. Metabolite abbreviations are as in Figure 3

of the 16 tandem-mass isotopomer distributions, the conﬁdence
interval sizes predicted by MFA/UF are signiﬁcantly smaller
than those predicted by MFA-based labeling data of the corres-
ponding intact metabolites (W ilcoxon ranked sum P< 0.05;
FDR corrected for multiple testing; marked with asterisk in
Fig. 3). For example, the conﬁdence intervals predicted by
MFA/UF given the tandem mass-isotopomer distribution of cit-
rate with the fragment citrate1,2,3 are of an average size of 14%,

whereas those predicted by MFA are of an average size of 112%
(show in Fig. 2).

Next, we explored whether MFA/UF correctly inferred the
true fragment positions when applied to predict ﬂuxes with
each of the 16 given tandem mass-isotopomer distributions.
We found that for citrate, a-ketoglutarate and oxaloacetate,
the most likely solution predicted by MFA/UF correctly identi-
ﬁed the position of the single fragment used to simulate the
tandem mass-isotopomer distribution (with the corresponding
fragment weight variable A being equal to 1; Fig. 4). In simula-
tions with tandem mass-isotopomer data for fumarate and
succinate, the correct position of some fragments could not be
inferred owing to structural symmetry of these metabolites. For
example, for fumarate, MFA/UF cannot differentiate between
a 2-carbon fragment consisting of carbons 1 and 2 (Fuml’z) or
carbons 3 or 4 (Fum3,4).

3.3 Applying MFA/UF to predicting metabolic ﬂuxes in
B.subtilis based on measured MS/MS data

To further demonstrate the applicability of MFA/UF, we
applied it to predict metabolic ﬂuxes in central metabolism of
B.subtilis, using recent MS/MS mass-isotopomer measurements
(Ruhl et al., 2012). Measurements were done with a growth
media consisting of a mixture of 20% (w/w) [U-13C] and 80%
[1-13C] glucose. The used metabolic model includes 42 reactions
in glycolysis, pentose-phosphate pathway and TCA cycle (Ruhl
et al., 2012). For seven metabolites in the network (glucose-6-
phosphate, pentose-S-phosphate, phosphoenolpyruvate, pyru—
vate, oxoglutarate, succinate, oxaloacetate), a mass-isotopomer
distribution is available for both the intact metabolite and for
between 1 and 4 known fragments. In all applications of MFA
and MFA/UF to predict ﬂuxes in this model, metabolite uptake
and secretion rates as well as growth-associated biomass demand
were ﬁxed based on experimental measurements (Ruhl et al.,
2012). We assume experimental error of 20% in measurement
of metabolite uptake and secretion and biomass demand, and
hence allow predicted rates through the corresponding reactions
to deViate by up to 20% from the measured ﬂuxes. The abun-
dances of extracellular glucose and C02 isotopomers used as
input for all MFA and MFA/UF analysis were adjusted to
account for natural isotopic abundances and impurity of labeled
glucose [as done in Ruhl et al. (2012)].

To evaluate the performance of MFA/UF versus that of
standard MFA in predicting ﬂuxes in this model, we applied
both approaches given labeling data for randomly sampled sets
of metabolites. Speciﬁcally, we sample sets of metabolites with 2,
3 and 4 metabolites (5 sets of each) and considered also 7 add-
itional sets each haVing a single metabolite (resulting in a total of
22 metabolite sets). Given each metabolite set, we performed the
following analysis: (i) Run MFA given the labeling data of the
intact metabolites; (ii) Run MFA/UF given the labeling data for
both intact metabolites and their fragments, assuming fragment
positions are unknown. In this case, for each fragment with a
given mass-isotopomer distribution, MFA/UF considered all
possible positions such that fragment carbons are connected in
the parent molecule (considering between 1 and 4 possible pos-
itions per fragment). (iii) To evaluate the accuracy of predictions
made by MFA (in i) and by MFA/UF (in ii), we compared the

 

3049

112 /3.10's112u.1n0[p.101x0"sotwuuqutotq/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

N. Tepper and T.Shlomi

 

[II
a

a? ‘
(  -MFAIUF
ﬁg”. I-MFA
an.
$7:
5::

$5.20 ‘ t

¥

3%

an: ,

3gp

s

E

a

 

2 3 4
Number of metabolilﬁ with labeling dab:

 

 

(big an. . .
% -MF.MUF
St 0.5. -Mm .
Hi
5%
gs. 11-17 1
is -
._ h 0.3.
ﬁe
m!
g: oz,
1'5
B? x =‘ ‘
0.1- 4
g . . i t .

 

 

Fig. 5. (a) Size of ﬂux conﬁdence intervals in B.subtilis predicted by MFA
based on MS data and by MFA/UF given MS/MS data for randomly
chosen sets of metabolites of different sizes (x-axis). The y-axis represents
the average percentage increase in conﬁdence interval size predicted by
MFA and MFA/UF compared with those predicted by the optimal pre-
dictor (i.e. MFA using MS/MS data, assuming fragment positions are
known). Metabolite set sizes for which the conﬁdence interval sizes pre-
dicted by MFA/UF are signiﬁcantly smaller than those predicted by
MFA (based on Wilcoxon ranked sum test) are marked with an asterisk.
(b) The average error in ﬂux conﬁdence intervals predicted by MFA given
MS data and MFA/UF given MS/MS data (y-axis) for randomly chosen
sets of metabolites (x-axis). The error measure is deﬁned as 1 minus the
Jaccard similarity coefﬁcient between a conﬁdence interval predicted
by MFA or MFA/UF and that derived by the optimal predictor.
Applications of MFA/UF that result in signiﬁcantly smaller ﬂux conﬁ-
dence intervals errors than those predicted by MFA (based on Wilcoxon
ranked sum test) are marked with an asterisk. Metabolite abbreviations:
G6P, glucose-6-phosphate; P5P, pentose-S-phosphate; PEP, phosphoe-
nolpyruvate; PYR, pyruvate; OGA, oxoglutarate; SucFUM succinate/
fumarate; OAA, oxaloacetate

ﬂux predictions made by these methods with those obtained by
an optimal predictor, which is MFA given labeling data for both
the intact metabolites and their fragments, assuming fragment
positions are known.

Examining the size of the 95% ﬂux conﬁdence intervals pre-
dicted by MFA/UF and MFA (without using fragment label-
ing data), we find that the conﬁdence intervals derived by
MFA/UF are markedly smaller (Fig. 5a). For example, given
the labeling pattern of just single metabolites, the conﬁdence
intervals derived by MFA/UF are just 9% larger on average
than those obtained by the optimal predictor, whereas conﬁ-
dence intervals predicted by MFA without fragment labeling
data are 47% larger on average than those of the optimal
predictor. Notably though, the average conﬁdence interval
size predicted by MFA decrease as labeling data for more
metabolites is given as input. Given the labeling data for all
metabolites, MFA/UF’s and MFA’s predicted conﬁdence

interval sizes are roughly the same (11% higher than the op-
timal predictor).

To further evaluate the predicted ﬂuxes by MFA/UF versus
those of MFA (with no fragment labeling data), we compared
the conﬁdence interval derived by these methods with those
obtained by the optimal predictor based on Jaccard coefﬁcient
(i.e. size of intersection diVided by size of union). The error in
predicted ﬂux conﬁdence intervals was deﬁned as one minus the
Jaccard coefﬁcient. We ﬁnd that in 19 of 22 applications of
MFA/UF, its prediction error is signiﬁcantly lower than that
of MFA (Wilcoxon ranked sum P<0.05; FDR corrected for
multiple testing; Fig. 5b). Overall, we ﬁnd an average reduction
of 40% in prediction error in MFA/UF versus standard MFA.
A notable example is the ﬂux prediction given the labeling data
for phosphoenolpyruvate, where MFA/UF predicts the same
ﬂux confidence intervals as those derived by the optimal pre-
dictor, whereas MFA predicts markedly different conﬁdence
intervals, with an average error of 0.18 (Fig. 5b). As another
example, Table 2 shows ﬂuxes and conﬁdence intervals predicted
by MFA, MFA/UF and the optimal predictor given labeling
data for pyruvate, oxoglutarate, pentose-5-phosphate and oxa-
loacetate. In this case, we highlight several reactions for which
MFA but not MFA/UF predicted confidence interval falsely
consists of a zero ﬂux.

4 DISCUSSION

Tandem-MS data holds great promise in improving the accuracy
of metabolic ﬂux inference, by providing higher measurement
precision over standard MS (Kiefer et al., 2007) and providing
information on metabolite positional labeling (Choi and
Antoniewicz, 2011; Jeffrey et al., 2002). To make usage of MS/
MS data for ﬂux inference, preVious computational approaches
require data on the positional origin of atoms in collisional frag-
ments, which is difﬁcult to obtain in many cases. Here, we show
that tandem MS data can be highly useful even when collisional
fragment positions are unknown, suggesting a computational
framework, MFA/UF, that simultaneously determines both
ﬂux rates and likely fragment positions. MFA/UF can be applied
on both measurements of tandem mass-isotopomer distributions
(as demonstrated with the gluconeogenesis simulation model)
and mass-isotopomer distribution for collisional fragments (as
shown with experimental data in B.subtilis). For both types of
MS/MS data, MFA/UF is shown to markedly improve ﬂux pre-
diction accuracy compared with standard MFA, relying solely
on MS data.

The applicability of MFA/UF was demonstrated for cases in
which MS/MS analysis does not induce in—source fragmentation
and hence the mass of the parent, non-fragmented metabolite is
measured. However, it can be easily adapted to handle the fol-
lowing cases: (i) Standard MS analysis (either GC—MS or LC-
MS) in which the mass-isotopomer distribution of an in—source
fragment (with an unknown position) is given. In this case,
MFA/UF would consider alternative in-source rather than
post-source fragments, without requiring any change to the
MFA/UF formulation itself. (ii) MS/MS analysis in which the
position of an in—source fragment is known though that of the
post-source collisional fragment is unknown. This case would
require deﬁning Cf, in Equation (3), considering the known

 

3050

112 /310's112u1n0[p1q1x0"sotwm101utotq/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

MFA coupled with inference of MS/MS fragments

 

Table 2. Fluxes and conﬁdence intervals predicted by MFA, MFA/UF and the optimal predictor (i.e. MFA given labeling data for both the intact
metabolites and their fragments, assuming fragment positions are known) in B.subtilis [see complete model in (Ruhl et al., 2012)], given labeling data for

pyruvate, oxoglutarate, pentose-S-phosphate and oxaloacetate

 

 

 

Reaction MFA MFA/UF Optimal predictor
Flux Conﬁdence interval Flux Conﬁdence interval Flux Conﬁdence interval
G6P —> F6P 5.7 3.7, 8 5.6 4.4, 6.6 5.3 3.9, 6.2
F6P —> FBP 6.7 6, 7.5 6.6 6.1, 7.1 6.6 6.1, 7
FBP —> GAP+DHAP 6.7 5.9, 7.5 6.6 6.1, 7 6.6 6.1, 7
DHAP —> GAP 6.7 5.9, 7.5 6.7 6.1, 7.1 6.6 6.1, 7
GAP —> BPG 13.6 12.5, 14.6 13.6 12.8, 14.2 13.6 12.8, 14.1
BPG —> PGA 13.6 12.5, 14.6 13.6 12.8, 14.2 13.5 12.8, 14.1
PGA —> PEP 12.0 10.7, 13.2 11.9 10.7, 12.8 12.0 11.1, 12.5
PEP —> PYR 11.4 9.8, 12.5 11.2 9.8, 12.1 11.3 10.2, 12
G6P —> P6G 2.3 0, 4.1 2.4 1.4, 3.6 2.7 1.8, 3.8
P6G —> P5P+C02 2.3 0, 4.3 2.4 0.9, 3.8 2.7 1.8, 3.8
P5P+E4P —> GAP+F6P 0.3 —0.5, 1 0.3 —0.1, 0.7 0.5 0.2, 0.9
(2) P5P 7> S7P+GAP 0.7 0, 1.4 0.7 0.4, 1.1 0.8 0.5, 1.3
GAP+S7P —> E4P+F6P 0.7 0, 1.4 0.7 0.3, 1.3 0.9 0.5, 1.3
PYR —> AcCoA+CO2 6.8 5.2, 7.9 6.4 4.8, 7.6 6.7 5.6, 7.3
OAA+AcCoA —> CitICit 3.2 1.7, 4.5 2.8 1.2, 4 2.8 1.4, 3.8
CitICit 7> OGA+CO2 3.3 1.7, 4.3 2.9 1.2, 4 2.8 1.4, 3.8
OGA 7> SucFUM+C02 2.4 0.9, 3.5 2.1 0.5, 3 1.9 0.5, 3
SucFUM —> MAL 1.2 0.5, 1.8 1.1 0.3, 1.5 1.0 0.2, 1.5
MAL —> 0AA 1.3 —0.3, 2.4 1.2 —0.4, 2.5 1.2 —0.4, 2.5

 

Note: Reactions for which standard MFA but not MFA/UF predicted conﬁdence interval falsely crosses 0 are colored.

position of the in—source fragment. (iii) MS/MS analysis in which
the position of both the in—source and post-source fragments are
unknown. Adapting MFA/UF for this case would require chan-
ging Equation (4) to account for all combinations of possible in-
source and post-source fragment positions. The extent to which
MFA/UF would improve ﬂux estimates in the above scenarios is
an open question.

Notably, fragment positions inferred by MFA/UF may the-
oretically be further used by standard MFA for ﬂux analysis Via
MS/MS data. In practice, this may be complicated by noise
in experimental data preventing MFA/UF from uniquely deter-
mining fragment positions. For example, in all simulations
described earlier in the text in gluconeogenesis, a single
collisional fragment was assumed when generating tandem
mass-isotopomer distributions, though MFA/UF predicted the
potential existence of other low probability fragments (in cases
not involving symmetric metabolite structures where speciﬁc
fragment positions could not be inferred; Fig. 4). The probabil-
ity of such additional possible fragments is taken into account
by MFA/UF when computing the most likely ﬂuxes and conﬁ-
dence intervals.

A major open question in MFA, which has been partially
addressed by recent studies, is how to design labeling experi-
ments that maximize the accuracy of ﬂux inference or revealing
new pathways in novel microbes? (Crown and Antoniewicz,
2012; Crown et al., 2012; Mollney et al., 1999; Schellenberger
et al., 2012; Tang et al., 2012). The design of a labeling ex-
periment entails ﬁnding an optimal set of labeled nutrients,
which produce a pattern of intracellular metabolite labeling,
which can be decoded to infer relevant ﬂuxes. To improve

the utility MS/MS experiments for ﬂux inference, further chal-
lenges remain. First, identify speciﬁc metabolite fragmentation
patterns whose positional labeling can improve ﬂux inference.
Second, design speciﬁc labeling experiments to identify the
position (or validate predicted positions, e.g. by MFA/UF)
of collisional fragments that are likely to improve ﬂux infer-
ence. For example, to ﬁnd the position of a collisional frag-
ment that appears in an MS/MS, possible experiments could
involve feeding a speciﬁc labeled nutrient to a microbe, poten-
tially in combination with one or more gene knockouts, and
applying MS/MS analysis.

As the difﬁculty of identifying the positional origin of colli-
sional fragments is a major bottleneck preventing broader use of
MS/MS data for metabolic ﬂux inference, the computational
approach presented here could promote broader usage of this
technology.

ACKNOWLEDGEMENT

The authors would like to thank Sean Hackett for commenting
on the article.

Funding: Israel Ministry of Science (to TS).

Conflict of Interest: none declared.

REFERENCES

Antoniewicz,M.R. et al. (2006) Determination of conﬁdence intervals of metabolic
ﬂuxes estimated from stable isotope measurements. Metab. Eng, 8, 3247337.

Antoniewicz,M.R. et al. (2007) Elementary metabolite units (EMU): a novel frame—
work for modeling isotopic distributions. Metab. Eng, 9, 6&86.

 

3051

112 /310's112u1nofp101x0'so1112111101u101q//:d1111 111011 pap1201um0q

9103 ‘0g1sn8nv u0 ::

N. Tepper and T.Shlomi

 

Boghigian,B.A. et al. (2010) Metabolic ﬂux analysis and pharmaceutical produc—
tion. Metal). Eng, 12, 81795.

Burgess,S.C. et al. (2003) Noninvasive evaluation of liver metabolism by 2H and
13C NMR isotopomer analysis of human urine. Anal. Biochem., 312, 2287234.

Choi,J. and Antoniewicz,M.R. (2011) Tandem mass spectrometry: a novel
approach for metabolic ﬂux analysis. Metab. Eng, 13, 2257233.

Choi,J. et al. (2012) Measuring complete isotopomer distribution of aspartate using
gas chromatography/tandem mass spectrometry. Anal. Chem., 84, 462874632.

Creek,D.J. et al. (2012) Stable isotope—assisted metabolomics for network—wide
metabolic pathway elucidation. Anal. Chem, 84, 844278447.

Crown,S.B. and Antoniewicz,M.R. (2012) Selection of tracers for 13C—metabolic
ﬂux analysis using elementary metabolite units (EMU) basis vector
methodology. Metab. Eng, 14, 15(Fl61.

Crown,S.B. et al. (2012) Rational design of (1)(3)C—labe1ing experiments for
metabolic ﬂux analysis in mammalian cells. BMC Syst. Biol, 6, 43.

Heinonen,M. et al. (2008) FiD: a software for ab initio structural identiﬁcation
of product ions from tandem mass spectrometric data. Rapid Commun. Mass
Spectrom., 22, 304373052.

Jeffrey,F.M. et al. (2002) 13C isotopomer analysis of glutamate by tandem mass
spectrometry. Anal. Biochem., 300, 1927205.

Jin,E.S. et al. (2004) Glucose production, gluconeogenesis, and hepatic tricarboxylic
acid cycle ﬂuxes measured by nuclear magnetic resonance analysis of a single
glucose derivative. Anal. Biochem., 327, 1497155.

Jones,J.G. et al. (1997) Measurement of gluconeogenesis and pyruvate recycling in
the rat liver: a simple analysis of glucose and glutamate isotopomers during
metabolism of [l,2,3—(13)C3]propionate. FEBS Lett., 412, 1317137.

Kelleher,].K. (2001) Flux estimation using isotopic tracers: common ground for
metabolic physiology and metabolic engineering. Metab. Eng, 3, 103110.

Kiefer,P. et al. (2007) Determination of carbon labeling distribution of intracellular
metabolites from single fragment ions by ion chromatography tandem mass
spectrometry. Anal. Biochem., 360, 1827188.

Kleijn,R.J. et al. (2007) Metabolic ﬂux analysis of a glycerol—overproducing
Saccharomyces cerevisiae strain based on GC—MS, LC—MS and NMR—derived
C—labelling data. FEMS Yeast Res., 7, 2167231.

Mollney,M. et al. (1999) Bidirectional reaction steps in metabolic networks: IV.
Optimal design of isotopomer labeling experiments. Biotechnol Bioeng, 66,
8(rlO3.

Ruhl,M. et al. (2012) Collisional fragmentation of central carbon metabolites in LC—
MS/MS increases precision of (1)(3)C metabolic ﬂux analysis. Biotechnol
Bioeng, 109, 76%771.

Sauer,U. (2006) Metabolic networks in motion: 13C—based ﬂux analysis. Mol Syst.
Biol, 2, 62.

Schellenberger,J. et al. (2012) Predicting outcomes of steady—state (1)(3)C isotope
tracing experiments using Monte Carlo sampling. BMC Syst. Biol, 6, 9.

Sillers,R. et al. (2009) Aldehyde—alcohol dehydrogenase and/or thiolase overexpres—
sion coupled with CoA transferase downregulation lead to higher alcohol titers
and selectivity in Clostridium acetobutylicum fermentations. Biotechnol Bioeng,
102, 38419.

Srour,O. et al. (2011) Fluxomers: a new approach for 13C metabolic ﬂux analysis.
BMC Syst. Biol, 5, 129.

Tang,J.K. et al. (2012) Recent advances in mapping environmental microbial
metabolisms through 13C isotopic ﬁngerprints. J. Roy. Soc. Interface, 9,
276772780.

Wiechert,W. (2002) An introduction to 13C metabolic ﬂux analysis. Genet. Eng, 24,
2157238.

Wiechert,W. et al. (1997) Bidirectional reaction steps in metabolic networks: 11. Flux
estimation and statistical analysis. Biotechnol Bioeng, 55, 1187135.

Wiechert,W. et al. (1999) Bidirectional reaction steps in metabolic networks: III.
Explicit solution and analysis of isotopomer labeling systems. Biotechnol
Bioeng, 66, 6%85.

You,L. et al. (2012) Metabolic pathway conﬁrmation and discovery through
(13)C—labeling of proteinogenic amino acids. J. Vis. Exp, e3583.

 

3052

112 /310's112u1nofp101x0'so1112111101u101q//:d1111 111011 pap1201um0q

9103 ‘0g1sn8nv u0 ::

