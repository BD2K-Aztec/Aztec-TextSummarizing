Bioinformatics, 31117), 2015, 2761—2769

doi: 10.1093/bioinformatics/btv293

Advance Access Publication Date: 7 May 2015
Original Paper

 

Genome analysis

Using combined evidence from replicates to
evaluate ChlP-seq peaks

Vahid Jalili1, Matteo Matteucci1, Marco Masseroli1 and
Marco J. Morel|i2'*

1Dipartimento di Elettronica, lnformazione e Bioingegneria, Politecnico di Milano, 20133, Milan, Italy and 2Center
for Genomic Science of ||T@SEMM, lstituto ltaliano di Tecnologia (MT), 20139 Milan, Italy

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on August 6, 2014; revised on April 24,2015; accepted on May 4, 2015

Abstract

Motivation: Chromatin lmmunoprecipitation followed by sequencing (ChlP—seq) detects genome—
wide DNA—protein interactions and chromatin modifications, returning enriched regions (ERs), usu—
ally associated with a significance score. Moderately significant interactions can correspond to true,
weak interactions, or to false positives; replicates of a ChlP—seq experiment can provide co—localised
evidence to decide between the two cases. We designed a general methodological framework to
rigorously combine the evidence of ERs in ChlP—seq replicates, with the option to set a significance
threshold on the repeated evidence and a minimum number of samples bearing this evidence.
Results: We applied our method to Myc transcription factor ChlP—seq datasets in K562 cells avail—
able in the ENCODE project. Using replicates, we could extend up to 3 times the ER number with re—
spect to single—sample analysis with equivalent significance threshold. We validated the ’rescued’
ERs by checking for the overlap with open chromatin regions and for the enrichment of the motif
that Myc binds with strongest affinity; we compared our results with alternative methods (IDR and
jMOSAiCS), obtaining more validated peaks than the former and less peaks than latter, but with a
better validation.

Availability and implementation: An implementation of the proposed method and its source code
under GPLV3 license are freely available at http://www.bioinformatics.deib.polimi.it/MSPC/ and
http://mspc.codeplex.com/, respectively.

Contact: marco.morelli@iit.it

Supplementary information: Supplementary Material are available at Bioinformatics online.

 

1 Introduction

 

Chromatin immunoprecipitation followed by next-generation
sequencing (ChIP-seq) is the most commonly used method to study
genome-wide chromatin modifications or protein—DNA interactions.
Computational tools like MACS (Zhang et (11., 2008) or ZINBA
(Rashid et (11., 2011) are applied on aligned ChIP-seq reads to detect
enriched regions (ERs) over the genome (often called ‘peaks’), where
the local accumulation of sequencing fragments exceeds that of a
background distribution, typically estimated from randomly frag-
mented chromatin or by performing the ChIP-seq protocol with a

control antibody (Bailey et (11., 2013). As the protocol is subjected to
multiple sources of noise (Chen et (11., 2012), some low-intensity accu-
mulation of reads is possible even in absence of a true interaction with
the target. These low-intensity peaks, which are usually present in
large amounts, contain therefore a mixture of false positives and true,
although weak, interactions; they are typically discarded when strin-
gent thresholds on the peak call are used. This approach leads to the
discovery of the strongest interactions only, and might distort the gen-
ome-wide picture of the genomic locations of the transcription factor
binding sites or histone modifications of interest.

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2761

/310‘srcumo[p10}xo‘sogcuHOJIItotq/ﬁdnq

Supplcrncntai‘) lVl‘JtCl‘i‘Jl

 

L;111dt€/rrl., 2012

Fig. 1

Table 1

Supplcrncntai‘) Table 51

1-!ch L
1.1.1.":- I u I- Inn. n I I: III I: IIIIIII

Hch l stringent Peaks

My :3_ 1_l-Ir=a k_Er:m2' 'L tmEd_P ea ks.

Hyc3_2

umnllﬂr urn run I III I IIIIII|.-III r-rl
stringent_9eak5
Case 1

_ No.1 lI._CUrI f i nun-IL PM! he

DNase—seq
 _ ___._.

 

Discarded
Peaks

/310'SIBano[pJOJxo"sorJBuiJOJurorqﬂ:duq

Combining replicate Ch/P—seqs

2763

 

Table 1. ENCODE alignment files used and their quantitative
features

 

Sample name Short Aligned R5 R’”
name reads

 

WgEncodeOpenChromChip Myc1_1 10 719209 19 171 287651
K562CmycAlnRep1
WgEncodeOpenChromChip Myc1_2 8 763 362 32 850 3 1 1 409
K5 62CmycAlnRep2
WgEncodeOpenChromChip Myc1_3 9 649 688 1 3 623 1 04 91 1

K562CmycAlnRep3

ngncodeSythfbs Myc2_1 17 507 1 94 42 456 64 01 6
K562CmyclggrabAlnRep1

WgEncodeSythfbs Myc2_2 22 256 240 33 015 54 773
K5 62CmyclggrabAlnRep2

WgEncodeSythfbs Myc3_1 6 077 198 5473 22 965
K5 62CmycStdAlnRep1

WgEncodeSythfbs Myc3_2 5 897211 12 832 18 753
K5 62CmycStdAlnRep2

WgEncodeSythfbs Ifna30_1 10 115 596 1901 13 654
K5 62CmycIfna30StdAlnRep1

WgEncodeSythfbs Ifna30_2 18 600 414 2527 97 620
K5 62Cmyclfna30StdAlnRep2

ngncodeSythfbs lfna6h_1 9 377 798 5852 12 087
K562Cmyclfna6hStdAlnRep1

WgEncodeSythfbs lfna6h_2 19 334 5 18 4547 1 02 168
K562Cmyclfna6hStdAlnRep2

WgEncodeSythfbs lfng30_1 11 602 299 8227 13 190
K5 62CmycIfng30StdAlnRep1

WgEncodeSythfbs Ifng30_2 16 666 560 30 524 25 484
K5 62Cmyclfng30StdAlnRep2

ngncodeSythfbs Ifng6h_1 14 01 9 564 2485 13 376
K562Cmyclfng6hStdAlnRep1

WgEncodeSythfbs lfng6h_2 19 666 823 27 728 25 118

K5 62Cmyclfng6hStdAlnRep2

 

Peaks were called with the software package MACSZ. R5: stringent ER set
(ERs with P-Value <Ts). Rt”: weak ER set (ERs with TSP-value<T”).
r :10”, 112104.

Peak calling was performed with the software package MACS2
(Zhang et al., 2008) with the following parameters: ‘—auto—bimodal
—p 0.0001 —g hs’ (thus setting a p—value threshold of 104), using
alignment files available in the ENCODE repository, together with
the corresponding background (standard input for all samples ex—
cept for Myc2, for which the input signal from rabbit IgG ChIP—seq
was used). In each sample—input pair, the total number of reads was
made equal by randomly down—sampling the largest alignment file.
The performed call determined between ~15k and ~345k peaks
across the different samples (see Table 1).

2.2 Definitions

Given a set of ] replicates, each sample / is associated with a set R, of
I enriched regions 7,,: R,: {7,,, 7,2, . . ., 7,,, . . ., 7,,}. Each region 7,, is
defined by (ch7omosome,,, sta7t,,, end,,, ID,,, p,,), where {7,, denotes a
measure of the significance of 7,, (i.e. its P—value). TS is a stringent
threshold on P—values, defining a set R,5 of stringent (highly en—
riched) ERs; R,S: 7,, E R,5 iffp,, < T‘. Similarly, we define a set R,’” of
weak (moderately enriched) ERs, containing all regions whose P—
value is between T‘ and a weak threshold T”, with T” > T‘, i.e. R,’”:
7,, E R,'” ifTSp,,<T”. Clearly, R,'” N R,S:@ and, if T” is the
maximum P—value allowed for an ER to be associated with sample /,
R,WU R; : R,.

For each region 1' of each sample /, let 7,,, denote the region of
sample k overlapping with 7,,, if any. If sample k has multiple re—
gions overlapping with 7,,, we choose the most significant one, i.e.
the one with the lowest p—value. Let R,, be the collection of 7,,,,5 for
k E {1, . . ., 1}, including 7,, itself. Let K: )R,,,») be the cardinality of
R,,)», the set of the ERs intersecting with 7,,, with 13K: ] by
definition.

We distinguish between technical and biological replicates of an
experiment. Technical replicates aim at controlling the variability of
the experimental procedure used to obtain the data and should yield
exactly the same results in absence of experimental noise. In a ChIP—
seq experiment, this corresponds to performing multiple times the
same ChIP protocol on the same biological sample, followed by in—
dependent sequencing on the same platform; we expect to observe a
significant overlap between ER lists in these samples. Conversely,
biological replicates are obtained by applying the same protocol on
biologically equivalent samples, what could give rise to different
binding profiles of a transcription factor, as in the case of tumor
samples; here, the variability in the data can also stem from the
‘true’ biological variation of the phenomenon of interest.
Consequently, the lack of overlap between ERs in biological repli—
cates does not necessarily correspond to a false positive result, as it
could reflect a true biological interaction occurring only in some
samples. With our method, the user is able to control for the
required level of overlap and combined significance, according to
the specificities of the dataset.

2.3 Algorithm: overall procedure

The main idea behind our method is that repeated evidence across
replicates can compensate for a lower significance in a single sample,
which is implemented through the Fisher’s method. The Fisher’s
method combines the P—values of each test in a global test statistics
that follows a chi—squared distribution with 2k degrees of freedom
(where k is the number of tests combined); therefore, it can be used
to falsify the statement ‘all null hypotheses are true’, i.e. ‘all overlap—
ping ERs are due to background noise”. Comparing intersecting ERs
from a set of ] replicates is equivalent to test the same genomic re—
gion in independent experiments against the same null hypothesis
H0, i.e. ‘the number of reads in the region under study is sampled
from the background distribution”, and obtaining independent prob—
abilities of rejecting Ho (i.e. independent P—values). Here, we briefly
outline the structure and motivation of our algorithm, following the
flowchart given in Figure 3, while we discuss its details in the
Extended Methods (data structures, search algorithms and combin—
ing test statistics sections).

We assign every ER 7,, in a given sample / to either R,5 or R,'” ac—
cording to its significance. For a given ER, we then determine R,,,»
as the set of ERs in the replicates that overlap with 7,,, including 7,, it—
self (see Definitions subsection). The cardinality K of R,,,» represents
a measure of the reproducibility of the signal in the region spanned
by 7,,, while the significance of 7,,, E R,,,» is a measure of the inten—
sity of the signal in a specific replicate k, given the background. We
rigorously combine the significance of the overlapping ERs in R,,,»
with the Fisher’s method, as described in the Extended Methods,
and define a new score for their combined evidence ppm”). Then,
we compare this new score with an adjustable threshold y: if the
desired stringency is obtained, we assign 7,, to the set R,” of con—
firmed peaks for sample /; if the condition is not met, i.e. the com—
bined evidence is not strong enough, we assign 7,, to the set R,” of
discarded peaks for sample /. All the ERs in R,,,» are assigned to the
corresponding confirmed Rh” or discarded de set, respectively.

ﬁm'srcumol‘pquo'sopcuuoptrorq/ﬁdnq

 

Benjainini and Ilochbcrg, 1995

Bailc‘} ,
2011
1\4athclicr (Ii LIL, 2014
Gupta (Ii LIL, 2007

Supplementar)

Fig. 51

Li (’l LIL, 2011

chg (Ii LIL, 2013

/310'SIBanoprOJxo"sorJBuiJOJurorqﬂ:duq

Combining replicate ChIP—seqs

2765

 

discovery rate after the Benjamini—Hochberg correction), together
with the choice of ‘technical replicate” versus ‘biological replicate”
mode. For our evaluations we used: TS : 1078, T” : 1074, y : 1078,
or : 0.05 for all comparisons, C: 1 for biological replicates and
C :1 for technical replicates. Required time was a few minutes for 2
samples with 100 000 peaks each on a standard desktop computer.

3.1 Technical replicates

Technical replicates are used to evaluate and remove the noise intro—
duced in the experimental procedure. In the case of ChIP—seq experi—
ments, they are usually generated by performing the same ChIP
protocol on the same biological sample, and then performing the
sequencing independently. As the ENCODE datasets include only
biological replicates, we tested our method on artificial technical
replicates, simulated as described in the Methods section. Details
about these samples can be found in the Supplementary Table 51.
An alternative to our strategy to generate technical replicates would
be to randomly split the reads in each original alignment file in repli—
cates rather than merging biological replicates in ENCODE first.
However, this procedure gives rise to a much poorer signal, prevent—
ing the identification of most ERs. The statistics of these alternative
technical replicates are described in the Supplementary Table 52.

Results for T : 1078, T” : 1074, y : T‘, or : 0.05 and C : 2 are
shown in Figure 4. For each replicate sample (panels A—G), we show
two bars: the left bar (SS) represents the peaks called in a single—
sample analysis (R5 in light gray and R'” in dark grey), while the
right bar (MS) classifies the same peaks, according to the output of
our algorithm, in the four sets described above: RS’C (light gray), R'”’C
(medium—light grey), Rs’d (medium—dark grey) and R'”’” (dark grey).

As expected, the number of RS stringent and R'” weak peaks
called in the same technical replicates is always very similar, even if
the absolute numbers differ significantly across the different condi—
tions considered. Each output set has a consistent fraction of R'”’”
weak confirmed ERs, which ranges from 20% to 98% (mean 46%,
standard deviation 30%) of the starting number of stringent peaks
(R’”’C / RS, panel H); thus by combining evidence in replicates, our
method ‘rescues” (i.e. confirms) a large amount of weak co—localised
peaks that would otherwise be discarded through a usual single sam—
ple evaluation. The percentage of stringent discarded peaks (Rs’d /
RS, panel H) is very low and varies from 0% in Myc2 to 12% in
Myc3 (mean 5.6%, standard deviation 3.8%). The output set R"
corresponds to the set of confirmed peaks Rcst’C U R’”’“, where
the significance of each peak has been adjusted for multiple testing;
combining the evidence present in replicates increases the number of
obtained peaks up to almost the double of what obtained with a sin—
gle sample at the same stringency (RO/ RS, panel H).

For technical replicates, we expect the output of each replicate to
be similar, and therefore the parameter C was set to C2]: 2 for all
technical replicate comparisons. Setting C: 1 would be instead
equivalent to trust even isolated peaks, which are not present in the
other replicate. With the latter choice, and y : TS, no stringent peaks
would be discarded.

As a preliminary evaluation of the results obtained, we con—
sidered the overlap of the peaks with the enriched regions in
DNase—seq data. On average, 95.4% of the peaks in R", 95.4%
of peaks in RS and 94.6% of peaks in R’” were in open chroma—
tin regions, while this fraction was only 89.4% for Rs’d and
93.0% for R’”’” (Supplementary Table S3). The overlap with
open chromatin, however, is not yet a validation of a specific
binding event. We performed then motif analysis on the nucleo—
tide sequences corresponding to the ERs in the four sets: R”, R",

R’”’” and Rs’d. Myc is known to bind a large number of sites on
the DNA, particularly with high affinity to those with the 6—nu—
cleotide motif called Enhance7—box or E-box. This protein—bind—
ing region has the generic consensus nucleotide sequence
CANNTG (with N representing any nucleotide; Murre et al.,
1989). In particular, Myc binds with maximum strength to the
CACGTG motif (also called the ‘canonical” Myc E—box [Walhout
et al., 1997]). Therefore, we consider the enrichment of the E—
box in a set of peaks a sufficient condition to consider the set as
containing ‘true” binding sites. Panel I in Figure 4 shows that the
E—box is always enriched in the RS stringent and R" output sets,
as well as in the R’”’” weak confirmed set. This result confirms
that in the large majority of cases the weak peaks overlapping in
replicates identify real binding sites, which are missed by a strin—
gent single—sample call. In 4 out of 14 cases, the Rs’d stringent
discarded set is enriched for the E—box, although at much lower
significance (Supplementary Table 55), while in the remaining
cases the number of peaks in the Rs’d set is low. This analysis sug—
gests that the default value C2] used for our artificial technical
replicates may be too conservative and still discards a small frac—
tion of real binding sites.

3.2 Biological replicates

The ENCODE data repository always includes one or more biolo—
gical replicates for each ChIP—seq experiment. For the transcription
factor Myc, multiple data sources are available, either obtained in
independent experiments, or scored against different backgrounds
(in Myc2, the input was derived from immune—precipitating normal
rabbit IgG, while in all the other samples the standard input for the
K562 cell line was used). We applied our method to biological repli—
cates obtained from each of the ENCODE experiments considered,
and we also combined replicates from 2 experiments (Myc2 and
Myc3). Parameters for the method were the same as for the technical
replicate evaluation reported in the previous section (i.e. TS: 1078,
T”: 1074, y : T, or : 0.05); for the additional parameter C, in the
case of biological replicates we adopted the permissive choice of
C: 1 (default for the analysis of biological replicates). With these
values (i.e. y : TS and C: 1), our method never discards a stringent
peak (we consider that a single strong evidence is enough for biolo—
gical replicate evaluation). Results are shown in Figure 5.

The number of peaks in biological replicates of the same experi—
ment can be very different (panels A—H), reflecting the different effi—
ciency of the ChIP—seq protocol, and the number of weak peaks (R'”)
is usually much larger than the number of stringent peaks (RS). In
the considered cases, the number of confirmed weak peaks (R’”’“) is
often much bigger (up to N4 times) than the number of stringent
peaks (RS) (column Rw’C/RS in panel I), confirming that the evidence
in a ‘good” replicate allows the rescue of many peaks in a ‘bad” repli—
cate. We observe a similar situation when we combine samples ob—
tained with different inputs. For example, by combining together
the four replicates of the Myc2 and Myc3 cases (panel D), we in—
crease massively the number of peaks in the output set for the sam—
ples with lower peak counts (Myc3) by confirming a number of their
weak peaks much larger than in the evaluation performed without
Myc2. Therefore, the presence of high—quality replicates can be of
great help in improving the call on many low—quality replicates. The
average overlap with open chromatin regions of the R’”’“ weak con—
firmed sets is 91.0% (compared with the 51.6% for the weak dis—
carded peaks), and motif analysis confirms that in all the samples
the ERs contain the canonical Myc binding site (panel J and
Supplementary Tables 56 and S8).

ﬁm'srcumol‘piqxo'sopcuuoptrorq/ﬁdnq

r of peak.-

F!

Numb

Number of pea ks

m
x
m
:11
EL
6
E .
.D
E
2

GD

60

.E

SE |'-.-’lS

Rep-1 Flam HepE Repi‘

M S

Rep1 Flep1 Rep}? Fl

M S

1

Fin1 Flep1 Rep}? Fir—:pE

Rem Rem Reps

Single Sample

Multiple Sample
stringent conﬁrmed peaks
weak conﬁrmed peaks
stringent discarded peaks
weak discarded peaks

-<-c
-<-<-<

4i!

-< «:4
f

-<

-<
<<<

4:

<4:
<<-<-<-<-<-<

E

l‘H

 

mp1 Hun] ' r— Hunt

lfna 6 h Ifn 30
F 9

Single Sample

Multiple Sample
stringent conﬁrmed peaks
weak conﬁrmed peaks
stringent discarded peaks
weak discarded peaks

D Myc2+3

lfngSh

' 2
I
II

 

 

 

 

2768 V.Jalili et al.
Table 3. Comparison with jMOSAiCS

Sample R‘ R" jMOSAiCS R°\jMOSAiCS E-box jMOS AiCS\R° E-box
Myc1_1 19171 42 663 50 539 7649 Y 31 750 N
Myc1_3 13623 34 858 33 867 4156 Y 17249 N
Myc2_1 42456 56 989 91 252 1346 Y 46 979 N
Myc2_2 33 015 54 889 92 423 799 Y 50 428 Y
Myc3_1 5473 14 411 18244 2801 Y 9061 N
Myc3_2 12832 16401 27116 1390 Y 13181 Y
Ifna30_1 1901 4839 32 711 111 - 28 752 Y
Ifna30_2 2527 5605 30 695 527 - 26 616 Y
Ifna6h_1 5852 9570 38517 114 Y 29 703 N
Ifna6h_2 4547 10 547 36 258 408 Y 28 028 Y
Ifng30_1 8227 18 112 49 843 257 Y 33 763 N
Ifng30_2 30 524 33 203 69 128 150 - 39 996 N
Ifng6h_1 2485 12 052 31 160 483 Y 22 678 Y
Ifng6h_2 27 728 28 564 70 888 98 - 45 601 Y

 

Comparison of the output set R0 (3rd column) with ERs obtained by jMOSAiCS (4th column). The 5th and 6th columns show the number of peaks that are
present in R0 but not in the jMOSAiCS output, and the enrichment of the Myc canonical E-box in this last set, respectively. Vice versa, the 7th and 8th columns

show the number of peaks present in the jMOSAiCS output but not in R0, and the corresponding enrichment of the E-box, respectively. For Myc1, the comparison

was done only with replicates 1 and 3. jMOSAiCS outputs a large number of ERs, including most of the peaks identiﬁed by our method, but only a fraction of the

jMOSAiCS-speciﬁc peaks contains the Myc binding motif. Each E-box column refers to the set described in the previous column and is marked as follows: ‘Y’:

presence of the E-box; ‘N’: absence of the E-box; ‘-’: set too small to ﬁnd any enriched motif.

sixth and seventh columns of Table 2. First of all, the IDR—validated
peaks are few and often entirely contained in our output sets.
This highlights that the IDR method is rather stringent and generates
only a small set of validated (reproducible) peaks. We repeated our
analysis for the Myc2 sample for a lower T” threshold and
found similar results (see Supplementary Material). Our method
does not score the reproducibility of a peak, but it rather combines
evidence in replicates, and has the option to accept very stringent
peaks even if they are not found in other replicates. We conclude
that our method confirms weak peaks that are considered ‘irrepro—
ducible” by IDR (with a 0.05 threshold), and are validated by
motif analysis (Figs 4 and 5, Supplementary Tables S3—511).
Finally, differently from our method, which accepts any number of
replicates, the IDR can be directly computed only for pairs of
replicates.

3.3.3 jMOSAiCS

We compared our results also with those obtained with jMOSAiCS
(Zeng et al., 2013), a tool designed to detect combinatorial patterns
of enrichment in multiple ChIP—seq samples. Even if jMOSAiCS is
conceived to integrate different ChIP—seq datasets that profile dis—
tinct features on the same biological sample, it can also be applied to
replicates of the same ChIP—seq. Applying jMOSAiCS to our biolo—
gical replicates (Table 3) resulted in a very large amount of ERs in
each experiment, which were on average around 5 times larger than
our peaks (ER average size data are not shown). These sets of peaks
contained by far the majority of the ERs identified by our method.
We checked for the enrichment of the Myc E—box in the peaks iden—
tified by our method, but not by jMOSAiCS and vice versa (peaks
identified by jMOSAiCS, but not by our method). While in the for—
mer case the Myc binding motif was enriched in all the sets with an
enough number of peaks to detect any enriched motif, the latter case
showed the presence of the Myc canonical E—box only in half of the
samples. Moreover, the running times of jMOSAiCS for two repli—
cates were in the order of 3 hours, with about 40 GB of memory
consumption, on a server with two Intel Xeon E5—2650 processors
and 64 GB of RAM, as this tool starts from alignment files and finds
ERs independently. On the same platform, our method ran in a few

minutes; the preliminary peak calling step needed to obtain the sets
of enriched regions required about 40 min for each of the replicates
with MACS2 (Zhang et al., 2008). We conclude that jMOSAiCS,
when applied to replicates of the same ChIP—seq experiment, has the
tendency of introducing a large amount of extra peaks, which are
not always validated by motif analysis, and it requires significant
computational resources. On the other hand our method is much
faster, as it allows to start from pre—determined ER lists, and at least
equally specific.

4 Discussion

We introduced a novel and rigorous method to combine evidence in
ChIP—seq replicates and we applied it to several ENCODE datasets
for the transcription factor Myc in the K562 cell line. Our results
confirmed that a considerable number of ERs, which display a weak
significance in single—sample analysis, can be ‘rescued” by the help of
co—localised evidence in multiple replicates. We proved that the nu—
cleotide sequences spanned by these weak peaks are almost always
found in open chromatin regions and enriched for the Myc canon—
ical E—box motif, for which the Myc protein has the highest affinity.
Surprisingly, even in the case of technical replicates, where reprodu—
cibility should be high, we found that discarding ERs only on the
base of the lack of overlap often results in the dismissal of true bind—
ing sites. This can be due to the fact that our technical replicates
were simulated using a computational procedure starting from the
biological replicates available; nonetheless, we recommend to be
careful in setting the overlapping parameter to high stringency (i.e.
C : 1).

We stress that our method works as a post—processing of a per—
missive peak call and it does not question the reliability of the output
of the peak caller (any peak caller providing a P—value score can be
used; we recommend using the same peak caller with the same par—
ameters on all the replicates). The method has three main strengths:
(i) rigour: single—sample evidence from each replicate is combined
through the Fisher”s method; (ii) versatility: with the choice of a few
parameters, it can be decided to weight co—localisation (C) and com—
bined significance (y) differently; (iii) efficiency: typically, the

ﬁm'srcumol‘piqxo'sopeuuopnorq/ﬁdnq

Combining replicate ChlP—seqs

2769

 

required time is in the order of few minutes on a standard desktop
computer and does not require special hardware.

Comparing our method with two other common approaches
(replicate merging and IDR) confirmed the stable identification of a
core of stringent, reproducible peaks. Besides this, our tests demon—
strated that less stringent evidence consistently present across repli—
cates can be combined, leading to the ‘rescue” of sets of ERs
corresponding to real binding sites, e.g. of the transcription factor
(TF) Myc. In particular, our results are compatible with those found
with IDR, a method widely used in ENCODE to assess the consist—
ency of each detected peak: IDR works by comparing peak rankings
and inferring the proportion of reproducible and irreproducible sig—
nal in the replicates, while our algorithm provides complementary
information by computing the combined significance of a number of
overlapping peaks. Despite comparable running times, we differ
from IDR as we do not automatically discard non—overlapping peaks
and we can directly apply our method to more than two replicates
without relying on multiple pairwise comparisons. We stress that
our method should not be considered an alternative to IDR, but ra—
ther complementary to it.

A further comparison with a tool designed for more complex
analysis (identifying combinatorial patterns of enrichment across
different ChIP—seq experiments performed over the same biological
sample), jMOSAiCS, revealed that, in the specific task of comparing
replicates of ChIP—seq experiments performed against the same tar—
get, this last tool confirms more peaks, which however do not al—
ways enrich for the E—box.

Recently, JAMM (Ibrahim et al., 2015), a tool based on local
multivariate Gaussian mixture models for directly finding ERs on
ChIP—seq replicates, has been introduced. JAMM confirms that
pooling replicates can blur the specific spatial resolution of single—
sample peaks and lead to less accurate calls in terms of peak width
and intensity.

In summary, our strategy represents a promising trade—off be—
tween stringent techniques (IDR) and permissive techniques
(jMOSAiCS).

Acknowledgements

We thank Mattia Pelizzola and Stefano de Pretis for useful discussions.

Funding

This work was supported by the Fondazione Istituto Italiano di Tecnologia
and by AIRC [grant no. IG_13182], and it is part of and supported by the
‘Data-Driven Genomic Computing (GenData 2020)” PRIN project (2013—
2015), funded by the Italian Ministry of the University and Research (MIUR).

Conﬂict ofInterest: none declared.

References

Bailey,T.L. (2011) DREME: motif discovery in transcription factor ChIP-seq
data. Bioinformatics, 27, 1653—1659.

Bailey,T. et al. (2013) Practical guidelines for the comprehensive analysis of
ChIP—seq data. PLOS Compnt. Biol., 9, e1003326.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. Series B,
289—300.

Chen,Y. et al. (2012) Systematic evaluation of factors inﬂuencing ChIP-seq ﬁ-
delity. Nat. Methods, 9, 609—614.

Gupta,S. et al. (2007) Quantifying similarity between motifs. Genome Biol.,
8, R24.

Ibrahim,M.M. et al. (2015) JAMM: a peak ﬁnder for joint analysis of NGS
replicates. Bioinformatics, 31, 48—55.

Landt,S.G. et al. (2012) ChIP-seq guidelines and practices of the ENCODE
and modENCODE consortia. Genome Res., 22, 1813—1831.

Li,Q. et al. (2011) Measuring reproducibility of high-throughput experiments.
Ann. Appl. Stat., 5, 1752—1779.

Mathelier,A. et al. (2014) JASPAR 2014: an extensively expanded and
updated open—access database of transcription factor binding proﬁles.
Nucleic Acids Res., 42, D142—D147.

Murre,C. et al. (1989) A new DNA binding and dimerization motif in im-
munoglobulin enhancer binding, daughterless, MyoD, and myc proteins.
Cell, 56, 777—783.

Rashid,N.U. et al. (2011) ZINBA integrates local covariates with DNA-seq
data to identify broad and narrow regions of enrichment, even within ampli—
ﬁed genomic regions. Genome Biol., 12, R67.

Walhout,A.]. et al. (1997) c-Myc/Max heterodimers bind cooperatively to the
E-box sequences located in the ﬁrst intron of the rat ornithine decarboxylase
(ODC) gene. Nucleic Acids Res., 25, 1493—1501.

Zeng,X. et al. (2013) jMOSAiCS: joint analysis of multiple ChIP-seq datasets.
Genome Biol., 14, R38.

Zhang,Y. et al. (2008) Model-based analysis of ChIP-Seq (MACS). Genome
Biol., 9, R137.

ﬁm'srcumol‘piqxo'sopeuuopnorq/ﬁdnq

