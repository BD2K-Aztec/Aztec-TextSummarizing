APPLICATIONS NOTE V°"3333:iaoéglégﬁifiialliﬁii

 

Systems biology

Advance Access publication January 2, 2014

CMGRN: a web server for constructing multilevel gene regulatory
networks using ChlP-seq and gene expression data
Daogang Guan‘, Jiaofang Shaol, Youping Dengz, Panwen Wang's, Zhongying Zhao‘,

Yan Liangl, Junwen WangS'4‘* and Bin Yan

1.5.*

1Department of Biology, Hong Kong Baptist University, Hong Kong, China, 2Department of Internal Medicine and
Biochemistry, Rush University Medical Center, Chicago, IL, USA, 3Department of Biochemistry and HKU-SIBI, 4Centre
for Genomic Sciences, LKS Faculty of Medicine, The University of Hong Kong, Hong Kong, China and 5Key Laboratory
of Acupuncture and Medicine Research of Minister of Education , Nanjing University of Chinese Medicine, Nanjing,

Jiangsu 210046, China
Associate Editor: Gunnar Ratsch

 

ABSTRACT

Summary: ChlP-seq technology provides an accurate characteriza-
tion of transcription or epigenetic factors binding on genomic
sequences. With integration of such ChlP-based and other high-
throughput information, it would be dedicated to dissecting cross-
interactions among multilevel regulators, genes and biological
functions. Here, we devised an integrative web server CMGRN (con-
structing multilevel gene regulatory networks), to unravel hierarchical
interactive networks at different regulatory levels. The newly de-
veloped method used the Bayesian network modeling to infer causal
interrelationships among transcription factors or epigenetic modifica-
tions by using ChlP-seq data. Moreover, it used Bayesian hierarchical
model with Gibbs sampling to incorporate binding signals of these
regulators and gene expression profile together for reconstructing
gene regulatory networks. The example applications indicate that
CMGRN provides an effective web-based framework that is able to
integrate heterogeneous high-throughput data and to reveal hierarch-
ical ‘regulome’ and the associated gene expression programs.
Availability: http://bioinfo.icts.hkbu.edu.hk/cmgrn; http://www.byan
bioinfo.org/cmgrn.

Contact: yanbinai6017@gmail.com or junwen@hku.hk
Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on July 3, 2013; revised on November 12, 2013; accepted
on December 25, 2013

1 INTRODUCTION

The combinational performance of transcriptional and epigenetic
factors is central regulatory mechanisms to control gene expres-
sion networks. A fundamental challenge in post-genome era is to
dissect such complex regulation associations underlying biolo-
gical functions. ChIP—seq technology allows high-ﬁdelity map-
ping of different regulators, such as transcription factors (TFs)
or epigenetic modifications to genomic locations, thus providing
a basis for profiling transcriptional or epigenetic regulatory rela-
tionships. Accurate binding features of these factors on the gen-
omic sequences can also be used to identify regulatory modules

 

*To whom correspondence should be addressed.

and reconstruct gene regulatory networks (GRNs). Various al-
gorithms and computational methods have been proposed to
investigate gene regulation promoted by cooperation of TFs
and epigenetic alterations. Some online tools or servers were de-
signed to build GRNs derived from ChIP—seq data, for instance,
Cscan (Zambelli et al., 2012) and ChIP—Array (Qin et al., 2011).
Although the existing web-based software can predict potential
target genes of the multiple regulators, they are not able to dis-
cover hierarchical organizations formed by cross-interactions be-
tween the regulators and genes simultaneously. Currently, there
is a lack of effective web resources to generate the topology of
networks controlled by the interacting factors at transcriptional,
post-transcriptional and epigenetic layers.

To provide an easy-to-use bioinformatics tool to interpret
these ChIP—seq high-throughput data, we devised an integrative
web server, constructing multilevel gene regulatory networks
(CMGRN) to unveil interrelationships between TFs or epigen-
etic modiﬁcations and to robustly construct hierarchical regula-
tory network structures in biological complex systems. It is
system wide and enables biologists to analyze the mixture infor-
mation of ChIP—seq and gene expression levels, using standard
data formatted with minimal need of bioinformatics skills.

2 METHODS

2.1 Overview

The schematic procedure and layout of CMGRN are illustrated in
Figure 1. Our server provides a web-based framework with two main
tasks: (i) inference of causal relationships between TFs or epigenetic
modiﬁcations by using Bayesian network-based methodology. One
input is required: gene counts of TFs or epigenetic modiﬁcations based
on ChIP-seq BED data mapped to genomic regions. (ii) Construction of
GRNs coordinated by the multilevel factors. Two types of input are
required: regulatory signal of TFs, epigenetic modiﬁcations or
microRNAs and gene expression data. The regulatory signal represents
binding/modiﬁcation activities of TFs or epigenetic factors identiﬁed by
calling peaks of ChIP-seq or binding targets of microRNAs. Through the
integrated analysis, CMGRN would establish hierarchical regulatory net-
work organizations at multiple levels, which quantify the interactions
among regulators and genes by using Bayesian hierarchical model and
Gibbs sampling. Thus, CMGRN can generate two outputs following the
two procedures and also provides an option for network reconstruction

 

1190 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOTNZLUJOJIITOlq/ﬂduq 11101} papBOIIIAAOG

91oz ‘Og isnﬁnV uo ::

CMGRN

 

 

 

Tstepigenetic mudiﬁcaduns: REEulaer Tstepige neti;

 

 

 

 

 

gene mu nls 0f ChiP—seq data signal modiﬁcations; Gene “Demon plume
mapped to promoters binding peaks on
I i I I grommets
+ K
L micmH Nil target-s
“We:  I
_._:2L'_
rum

 

 

 

 

Simian V Bayesian hierarchital
netwmk ‘ Q , Gibbs sampling
' Q

 

 

causal relationships Causal relaﬂonshlps
between us and between epigenetic
mfacmrs modiﬁcauons

   

A multI-leuelgene regulatorv
network at epigenetic
modiﬁcaﬂons. TF5 and microRNAs

Fig. 1. An overview of data-integrated analysis and regulatory network
construction. The triangle nodes represent TFs (pink), epigenetic regula-
tors (red) and cofactors (blue), whereas the V-type nodes represent
microRNAs (yellow). Target genes were indicated by using the circle
nodes

depending on what are the types of input data (Fig. 1). The ﬁrst one will
obtain a causal network linking TFs or epigenetic factors if only ChIP-
seq gene counts are provided. The second one will construct a ﬁnal net-
work exploring interactions of both regulatoriregulator and regulator7
gene if all three types of input are satisﬁed. The output tables and ﬁgures
will be displayed via a user-friendly web interface and be easily down-
loaded. Usage of our service is simple and does not need user’s knowledge
on speciﬁc algorithm. The detailed information for the web tool imple-
mentation is explained in supplementary information and help page of
the Web site.

2.2 Algorithms and statistical methods

2.2.] Inference of causal relationships between regulators We
used a Bayesian network-based model to infer causal interactions
among regulators (TFs or epigenetic modiﬁcations) and examine how
these regulators inﬂuence or associate with each other. The basic algo-
rithm of Bayesian network structure searching for possibility of depend-
ence between two nodes was described by Heckerman et al. (1995). There
are two challenges to overcome, high posterior probability and the com-
pelled edges in the network. In particular, compelled edge identiﬁcation is
critical because these edges indicate causal relationships when certain
assumptions hold. A series of optimization is needed for such ‘cause-
effect’ network structures with high posterior probability. In this study,
we adopted BD metric (Bayesian metric with Dirichlet prior) strategy
proposed by Heckerman et al. (1995) to ﬁnd the high likelihood of pos-
terior probability. First, we set a Bayesian network of regulators as fol-
lows: B : {D35}, D 2 {(xi, ...,x,,),Ek}, D is an acyclic-directed graph
(DAG); x,- represents nodes (regulators) of the DAG, Ek is set of edges of
DAG and *5 contains the set of conditional probability distributions that
correspond to D. To ﬁnd likelihood structures, the probability can be
calculated by the following formula:

Iogp(D, Bflé) = Z logs(x,-in,-) = Z) wot-.211) + Z log S0019)
i:1 i:1

1:1

where n,- is the (possibly) null parent of xi. For edge xj —> x,, the strategy
is to associate with a weight w(x,-,xj) = logs(x,—|xj) — logs(x,-|6),6 is a
node set without edges. A weight is deﬁned for edge x,- to xj as
w(x,—, xj) = logG(x,—|xj) — logG(x,—|(p). To search for the best network
structure, we used maximal value for ELI w(x,-, 21,-). The aforementioned

algorithm uses greedy strategy, so the next step is to identify compelled

edges as potential network structures. Chickering developed mathemat-
ical algorithm for identifying compelled edges between two nodes to de-
termine their causal relationship (Chickering, 1995). Yu et al. (2008)
applied a similar methodology to predict causal relationships between
histone modiﬁcations and gene expression in human T cells.

The ChIP-seq reads in BED format were mapped to genomic regions
and were then transferred to gene counts or signals of TFs or epigenetic
modiﬁcations that could be detected. CMGRN used the gene count of
ChIP-seq as input for inferring the causal relationships between regula-
tors. First, the input gene counts will be discretized by using k-means++
algorithm. The k-means method is a widely used clustering technique that
seeks to minimize the average and squared distance between points in the
same cluster. Although its simplicity and speed are appealing in practice,
it offers no accuracy guarantees for discretization. One reason is that
k-means usually chooses initial k centers in an arbitrary way. If the cen-
ters are not properly taken, the resulting clusters will be also arbitrary and
thus leading to generation of unstable ‘cause-effect’ relationships. In this
study, we adopted a k-means++ method, which proposes a speciﬁc ap-
proach to choose centers like ‘D2 weighting’ (Arthur and Vassilvitskii,
2007). The main step of k-means++ is as follows: (i) take one center
k1, chosen uniforrnly at random from x; (ii) take a new center k,-, choos-
ing x e X with probability ELEXV; (iii) repeat the second step until we
take k centers altogether; and (iv) do the k-means algorithm. The strategy
used by the k-means++ is able to improve both speed and accuracy of
k-means. We have also demonstrated that the k-means++ method can
increase the stability of the inferred causal relationships (see
Supplementary Fig. Sl).

2.2.2 GRNs construction We used Bayesian hierarchical model with
Gibbs sampling implementation to identify correct sets of regulatorigene
interactions that explore underlying network structures. This method will
combine two types of data, regulatory signals of multifactors and gene
expression proﬁle. The ChIP-seq binding peaks of TFs and epigenetic
modiﬁcations on the promoters were used as their regulatory signals.
The regulatory signals of microRNAs were expressed by their binding
targets based on both known and predicted sites on 3’-untranslated re-
gions. The main aim of this method is to incorporate the heterogeneous
data, to capture essential regulatory features behind high-throughput
data and to provide a basis for reconstructing GRNs. An integrated
model COGRIM using the similar algorithm showed its capacity of iden-
tifying potential regulatory interactions between TFs and genes (Chen
et al., 2007). Previously, we successfully used this statistical model to
identify target regulons of oncogenic TF family of NF-KB in different
cell types of head and neck cancer (Y an et al., 2008). Here, we assign the
gene expression proﬁle and binding data of regulators to Bayesian hier-
archical with an extensible linear model as following:

1
en = 051' + Z ,BjPri' jt + 8ft
j:1

t f

Bibby) OC Hp(e,—,|Pr,-j, ‘ 

2:1 1:1

Where 8,, ~ Normal(0, M), e,—, is the log expression of gene i (i: 1 . . . N)
in experiment t (t: 1 . . .T). The or,- is baseline expression for gene i in
absence of known regulators. The fj, is the regulation activity estimated
by log expression of TF gene j (j = 1 . . .J) in experiment t. Prij refers to
the probability of gene i regulated by regulator j. Prior
Prij ~ Bernoulli(h(b,-j)) where bi]- means regulator j physically binds in
proximity to gene i. In this study, this parameter can be considered as
the regulatory signal from ChIP-seq binding peaks, or targets contain
binding sites of microRNAs. 0 represents parameter set (05,-,,Bj,u2).
Both Prij and 0 can be estimated one set given the other by Gibbs

 

1191

112 /3.IO'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] 11101} papeolumoq

91oz ‘Og isnﬁnV uo ::

D.Guan et al.

 

sampling, one of Markov chain Monte Carlo algorithm that is able to
iteratively sample new values for each set of unknown parameters condi-
tional on the current values of all other parameters. This process can be
described as follows: estimating 0 given Prij, e,—, and bi), estimating Prij
given 0, e,—, and bi). To test the performance of CMGRN, we compared it
with other three methods by using four different types of cancer gene
expression data. The result showed that our method could improve the
reliability of TF target identiﬁcation from the cancer datasets (see
Supplementary Fig. S2).

2.3 Implementation
CMGRN was implemented with PHP and pascal.

3 SAMPLES TEST

We applied CMGRN to address the complex structures of regu-
latory networks underlying mouse embryonic stem cell pluripo-
tency and differentiation. Our analysis provides computational
proof that three pluripotent TFs (Oct4, Sox2 and Nanog), active
histone methylations and microRNAs form a hierarchical
‘regulome’ that downregulates gene expression related to tran-
scriptional processes and upregulates developmental genes facil-
itating differentiation. The hierarchical regulatory feature also
works in an estrogen-stimulated breast cancer cell line and re-
veals that estrogen receptor a is a driving factor that links to
other TFs and cofactors that control estrogen-associated gene
expression programs (see Supplementary Figs S3 and S4).

Funding: Grant of Science Faculty of Hong Kong Baptist
University (Grant no: FRG2/ 12-13/066), National Nature

Science Foundation of China (Grant no: 91229105), Hong
Kong Research Grants Council (Grant no: 781511M) and
Collaborative Research Fund of Hong Kong Research Grants
Council (Grant no: HKBUS/CRF/ 11G).

Conflict of Interest: none declared.

REFERENCES

Arthur,D. and Vassilvitskii,S. (2007) kmeans++2 the advantages of careful seeding.
Proceedings of the Eighteenth Annual ACM—SIAM Symposium on Discrete
Algorithms. Society for Industrial and Applied Mathematics, Philadelphia,
PA, USA, pp. 102771035.

Chen,G. et al. (2007) Clustering of genes into regulons using integrated modeling—
COGRIM. Genome Biol., 8, R4.

Chickering,D.M. (1995) A transformational characterization of equivalent bayesian
network structures. In: Besnard,P. and Hanks,S. (eds) Proceedings of 11th
Conference on Uncertainty in Artiﬁcial Intelligence. Morgan Kaufmann
Publishers Inc., San Francisco, CA, USA, pp. 87798.

Heckerman,D. et a]. (1995) Learning Bayesian networks: the combination of know—
ledge and statistical data. Mach. Learn., 20, 1977243.

Qin,J. et a]. (2011) ChIP—Array: combinatory analysis of ChIP—seq/chip and micro—
array gene expression data to discover direct/indirect targets of a transcription
factor. Nucleic Acids Res., 39, W43(FW436.

Yan,B. et al. (2008) Systems biology—deﬁned NF—kappaB regulons, interacting
signal pathways and networks are implicated in the malignant phenotype of
head and neck cancer cell lines differing in p53 status. Genome Biol, 9, R53.

Yu,H. et a]. (2008) Inferring causal relationships among different histone modiﬁca—
tions and gene expression. Genome Res., 18, 13144324.

Zambelli,F. et a]. (2012) Cscan: ﬁnding common regulators of a set of genes by
using a collection of genome—wide ChIP—seq datasets. Nucleic Acids Res., 40,
W51(¥W515.

 

1192

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] 11101} popeolumoq

91oz ‘Og isnﬁnV uo ::

