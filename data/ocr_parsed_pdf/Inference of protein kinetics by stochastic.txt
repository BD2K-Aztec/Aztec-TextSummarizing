ORIGINAL PAPER

Vol. 31 no. 3 2015, pages 355—362
doi:1 0. 1093/bioinfonnatics/btu619

 

Systems biology

Advance Access publication September 30, 2014

Inference of protein kinetics by stochastic modeling and
simulation of fluorescence recovery after photobleaching

experiments

Maria Anna Rapsomanikil'z, Eugenio Cinquemanie, Nickolaos Nikiforos Giakoumakisl,
Panagiotis Kotsantis‘, John Lygerosz'* and Zoi Lygerou”

1Department of Biology, School of Medicine, University of Patras, 26505, Rio, Patras, Greece, 2Institut fiJr Automatik,
ETH Zijrich, 8092 Zijrich, Switzerland and 3INRIA Grenoble-Rhone-Alpes, Montbonnot, 38334 Saint-lsmier Cedex,

France
Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: Fluorescence recovery after photobleaching (FRAP) is a
functional live cell imaging technique that permits the exploration of
protein dynamics in living cells. To extract kinetic parameters from
FRAP data, a number of analytical models have been developed.
Simplifications are inherent in these models, which may lead to inex-
haustive or inaccurate exploitation of the experimental data. An ap-
pealing alternative is offered by the simulation of biological processes
in realistic environments at a particle level. However, inference of kin-
etic parameters using simulation-based models is still limited.
Results: We introduce and demonstrate a new method for the infer-
ence of kinetic parameter values from FRAP data. A small number of in
silico FRAP experiments is used to construct a mapping from FRAP
recovery cun/es to the parameters of the underlying protein kinetics.
Parameter estimates from experimental data can then be computed
by applying the mapping to the observed recovery cun/es. A bootstrap
process is used to investigate identifiability of the physical parameters
and determine confidence regions for their estimates. Our method
circumvents the computational burden of seeking the best-fitting par-
ameters via iterative simulation. After validation on synthetic data, the
method is applied to the analysis of the nuclear proteins Cdt1, PCNA
and GFPnls. Parameter estimation results from several experimental
samples are in accordance with previous findings, but also allow us to
discuss identifiability issues as well as cell-to-cell variability of the
protein kinetics.

Implementation: All methods were implemented in MATLAB R2011b.
Monte Carlo simulations were run on the HPC cluster Brutus of ETH
Zurich.

Contact: lygeros@control.ee.ethz.ch or lygerou@med.upatras.gr
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 29, 2013; revised on August 1, 2014; accepted
on September 12, 2014

1 INTRODUCTION

The development of modern microscopy systems coupled with
advances in ﬂuorescent protein technology and sophisticated

 

*To whom correspondence should be addressed.

computational methods have made it possible to visualize,
track and quantify ﬂuorescent molecules within living cells.
Functional live cell imaging techniques, such as ﬂuorescence re-
covery after photobleaching (FRAP), are increasingly used by
biology laboratories to explore the dynamic behavior of proteins
in vivo (Reits and Neefjes, 2001). During a typical FRAP experi-
ment, molecules tagged with a ﬂuorescent protein (such as the
Green Fluorescent ProteiniGFP) in a subcellular region are
irreversibly bleached by a short laser pulse. Then, the recovery
of the ﬂuorescence due to unbleached molecules moving into the
bleached region is measured by standard time-lapse microscopy.
Analysis of this recovery data aims at providing information
regarding the diffusion and binding of the bleached molecules,
reﬂecting biomolecular interactions within the cell (Phair and
Misteli, 2001).

Conventional quantitative FRAP analysis focuses on param-
eters associated with the shape of the recovery curve (e.g. value
of plateau and half-maximal recovery time), easily estimated
using curve-ﬁtting techniques (Phair and Misteli, 2001;
Rapsomaniki et al., 2012). However, this approach provides a
limited understanding of protein kinetics and is heavily depend-
ent on the experimental setup, especially on the time frame of
observation (Bancaud et al., 2010). To estimate the kinetic par-
ameters of the underlying molecular processes, including associ-
ation and dissociation constants, relative size of mobile and
immobile pools and protein diffusion rates, model-based quan-
titative FRAP analysis is necessary (Phair et al., 2004).

Modeling approaches traditionally rely on developing stream-
lined models of the diffusion, binding and photobleaching pro-
cesses to derive approximate closed-form expressions of
ﬂuorescence recovery. The parameters yielding recovery curves
that correspond best to the data are chosen as the most likely
explanation of the underlying protein kinetics (Mueller et al.,
2010). Over the past years, a variety of models have been pro-
posed, broadly classiﬁed into diffusion models, reaction models
and reaction-diffusion models, depending on the phenomenon
considered dominant (Sprague and McNally, 2005). It has also
been observed (Tardy et al., 1995) that the FRAP recovery curve
is composed of two phases: a ﬁrst phase with fast dynamics,
where the recovery is mainly attributed to diffusion (diffusion
regime), and a second phase with slower dynamics, where the

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 355

112 /310'S[BIIJHO[pJOJXO'SOlIBLUJOJIIlOlq/ﬂduq 11101} papeolumoq

9103 ‘Og anﬁnv 110 ::

M.A.Rapsomaniki et al.

 

recovery is regulated by binding and unbinding events (turnover
regime).

Models giving rise to a sum of exponential terms have been
extensively used for quantitative analysis. In the reaction models
domain, exponential expressions are derived through compart-
mental modeling approaches pioneered in (Jacquez, 1996), where
the presence of one or two exponential terms is dictated by the
number of binding sites. An alternative compartmental modeling
approach is proposed in (Carrero et al., 2003), which again re-
sults in a theoretical curve with two exponential terms. Here, the
coefﬁcients of the terms are non-linear functions of all physical
parameters (diffusion coefﬁcient, binding/unbinding rates) of the
underlying molecular kinetics.

The derivation of explicit (parametric) expressions for FRAP
curves relies on simplifying assumptions about cellular/nuclear
geometry [2D (Carrero et al., 2003), 3D (Beaudouin et al., 2006)],
nature of diffusion [isotropic (Ellenberg et al., 1997) or aniso-
tropic (Sbalzarini et al., 2006)], binding site number [one
(Beaudouin et al., 2006) or many (Sprague et al., 2004)] and
distribution [homogeneous (Sprague et al., 2004) or heteroge-
neous (Beaudouin et al., 2006)], to name a few. The accuracy
of these approximations is, however, difﬁcult to determine.
Furthermore, it has been shown that different models or different
parameter sets of the same model can ﬁt FRAP curves equally
well. Indeed, contrasting estimates of the kinetic parameters of
even the same molecule species have been reported in various
studies (Mueller et al., 2010). At the same time, the use of aver-
ages of several cell proﬁles is common practice in traditional
FRAP analysis, which may mask the underlying biological in-
formation contained in single-cell measurements.

In the past years, the availability of computational resources
of ever-increasing power has stimulated modeling and simulation
of molecular mobility and interactions at a particle level and
within realistic environments (Cowan et al., 2009; Farla et al.,
2004; Houtsmuller et al., 1999; van Royen et al., 2009).
Stochastic hybrid models, coupling continuous diffusion dy-
namics with discrete (random) interaction events and providing
a realistic account of the complexity of the cellular environment,
can be built and simulated in reasonable time (Cinquemani et al.,
2008). Analysis of the ﬁt between simulated and experimental
recovery curves allows one to (in)validate hypotheses on the
values of kinetic parameters. Unfortunately, in this context, a
parameter inference method cannot be obtained easily by numer-
ical optimization of the ﬁt, as the repeated simulation of the
system for iteratively reﬁned values of the parameters is compu-
tationally demanding. To account for this, existing simulation-
based methods propose the a priori creation of a large dataset of
simulated FRAP curves for varying combinations of kinetic par-
ameter values, obtained by gridding the parameter space (van
Royen et al., 2009). Parameter inference from experimental
data is then performed by searching in the dataset the simulated
curve that fits best the experimental one, thus forcing the esti-
mates to take values on the grid of simulated parameters.

In this article, we propose an alternative approach for the
inference of the kinetic properties of proteins within living
cells. The key idea and novelty of our method is the construction
of a mapping from recovery curves to the parameters of the
underlying molecule kinetics. The method is based on the numer-
ical simulation of a stochastic hybrid model of protein diffusion

and binding in a realistic setup at a particle level (Cinquemani
et al., 2008). It assumes that FRAP recovery curves are repre-
sented through a sum-of-exponentials. Then, a relatively small
number of simulations for different physical parameter values is
used to train an Artiﬁcial Neural Network (ANN) implementing
the required mapping of physical parameters to the parameters
of FRAP recovery curves. Given an experimentally determined
recovery curve, inference of the underlying kinetic parameters
then simply amounts to fitting the data with a sum-of-exponen—
tial curve and feeding the obtained recovery parameters to the
mapping. In addition, a bootstrap process is used to compute
confidence intervals on the parameter estimates. Through the a
priori construction of the mapping, our method circumvents the
burden of resimulating the model iteratively every time a param-
eter estimate is sought. Unlike existing methods, our method
provides interpolation within the range of parameters of the
simulated curves. This allows us to reduce the number of simu-
lations required and yet provide estimates that are not biased
toward values fixed a priori. At the same time, the bootstrap
process allows us to investigate the identiﬁability of the physical
model parameters. We validate the proposed method first in
silica and then through the analysis of in vivo data for the nuclear
proteins Cdt1, PCNA and GFPnls. Our method predicts behav-
ior in accordance with earlier findings (Essers et al., 2005;
Mortusewicz and Leonhardt, 2007; Roukos et al., 2011; Xouri
et al., 2007) and provides elements for the discussion of cell-to-
cell variability.

2 METHODS

2.1 Model description

We brieﬂy outline the stochastic hybrid model of FRAP experiments,
thoroughly presented in (Cinquemani et al., 2008). An outline of the
stochastic model is shown in Figure 1, where black boxes represent the

 

 

 

Phi/5103' Model of particle dim: innI I Position
and binding l l Binding state

F'hotobleaching Mada of FRAP
parameters experiment

Stochastic modeling

 

 

 

 

 

 

 

 

 

state

 

 

 

 

 

 

 

 

 

 

 

Normalized Fluorescence Intensity

0 5 10 15 20
time (s)

Fig. 1. Above: Outline of the stochastic hybrid model of FRAP experi-
ments. Below: An example simulated curve for a diffusion coefﬁcient of
2 me/s, a bound fraction of 25% and a residence time of 3 s. A 205
experiment is simulated with time step 0.068 s leading to 302 FRAP meas-
urements; the approximation parameter (h) used was 0.1 pm

 

356

112 /310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeolumoq

9103 ‘Og isnﬁnv 110 ::

Inference of protein kinetics from FRAP experiments

 

model of particle diffusion and binding and green boxes the model of the
photobleaching process.

Protein diffusion and binding are modeled at a particle level, by taking
into account explicitly the stochastic nature of diffusion and binding
events. For the purposes of this article we have tailored the model to
the case of nuclear proteins binding to chromatin and assume that there
are no interactions between different particles, i.e. all molecules diffuse
and bind independently. In addition, we consider for simplicity that dif-
fusion is isotropic and space-homogeneous and binding and unbinding
propensities are uniform over the nucleus. Generalizations of the model
are also possible, so that its use is extended for other cases.

We describe the cell nucleus as a 3D ellipsoid with imper-
meable boundaries, containing N copies of a protein. Let
[7,-(7) = [xi(t) y,—(t) z,—(t)]T, with i = 1, . . . , N denote the position of molecule
i at time 7. At each time, every particle is either bound or unbound.
Bound molecules do not move, while diffusion of unbound molecules is
described by a Brownian motion process through the following stochastic
differential equation:

dpz—(t) = 01dWi(t) + dRi(pi(t)) (1)

where W(t) is a 3D Wiener process with zero mean and covariance equal
to the identity matrix I, o>0 and R(p(t)) is a process that reﬂects the
molecules back into the nucleus when they would cross the boundaries. In
the context of biological systems, the diffusion coefﬁcient of a particle,
denoted as D with units me/s, is associated with a particle’s mean square
displacement over time. It can be shown (see Section 81.1 of the
Supplementary material) that the diffusion coefﬁcient is related to a
through the following equation:

D = 02/2. (2)

Transitions of a molecule between bound and unbound states are
modeled as random events with propensities Mind 3 0 for binding and
Ame”. 3 0 for unbinding (These propensities are equivalent to the asso-
ciation and dissociation rates k0,, and km, often found in the biochemical
reaction literature). Let F e [0, 1] denote the average bound fraction, i.e.
the expected fraction of the population of molecules that are bound at
any given time. Similarly, let T be the residence time (in seconds), i.e. the
time a molecule spends on average in the bound state. Then one has

Andante =  T, 

Abind/A‘relmSc =  _  

That is, Mind and Are/me determine F and T, and vice versa.

We note here that traditional FRAP analysis involves assessing the
immobile fraction (deﬁned as the fraction of bleached molecules that
remain in the bleached region at the end of the experiment) and the
half-maximal recovery time (denoted as 71/2 and deﬁned as the time at
which ﬂuorescence intensity within the bleached region equals half of the
maximal intensity). Although related, the immobile fraction should not
be confused with the bound fraction F deﬁned here; while the ﬁrst is
associated with permanent interactions manifested as plateau values <1
at the end of the experiment and depends on the duration of observation,
the latter describes transient as well as permanent interactions depending
on the value of the residence time and is not affected by experimental
setup. Similarly, 71/2 should not be confused with the residence time T, as
the ﬁrst also depends on the speed of diffusion while the second does not.
Unlike immobile fraction and half-maximal recovery time, our physical
parameters D, F and T explicitly characterize the behavior of the protein
of interest and do not depend on experimental settings. For more infor-
mation on this see Section 82.1 of the Supplementary material.

Overall, the above model results in N independent continuous-time
switching diffusions, each describing the position and mobility
state of one particle over time. A discrete approximation allows for
numerical implementation and simulation of the continuous model.

The approximation method is based on the idea of gridding both the
state-space and time according to a gridding parameter h>0. Standard
results in stochastic analysis (Kushner and Dupuis, 1992) show that the
approximate process converges in distribution to the original process as
h —> 0. The value of h heavily inﬂuences the time needed for simulation,
with smaller values (thus greater resolution) leading to longer simulation
times. For practical purposes, our numerical investigation
(Supplementary material, Section 81.2) suggests that the approximation
is sufficiently accurate for h = 0.1 pm, as no differences in the statistical
properties of the resulting simulations are noticed when h is decreased
further.

A model of FRAP experiments over an experimental period [0,7] in-
volves the model of protein diffusion and binding described above to-
gether with a stochastic description of the bleaching process. To model
the labeling of proteins with ﬂuorescent tags, we use an additional dis-
crete state (bleaching state) associated to every particle and we assume
that initially (pre-bleach time interval) all particles ﬂuoresce. Bleaching is
carried out by a continuous laser pulse over a predeﬁned time interval
[t*, 7*] g [0,7] (bleaching interval) in a predeﬁned 3D region inside the
nucleus (bleaching region). Following experimentations with various
shapes of the bleaching region (see Section 81.4.] of the Supplementary
material), we currently approximate it as a sphere of a ﬁxed radius, pos-
itioned in the center of the nucleus. To model the bleaching process, we
assume that all particles that enter the bleaching region during the bleach-
ing interval will get bleached with a probability that is proportional to the
time spent in the bleaching region and [ch/each, a constant related to the
photobleaching efﬁciency. The value of [ch/each, associated with the inten-
sity of the laser pulse, was determined empirically, so that the bleaching
pattern resembles that of experimental data (more details in Section S] .3
of the Supplementary material).

The ﬂuorescence proﬁle inside the bleaching region, denoted by y(t), is
obtained by a count of the ﬂuorescent particles inside the region at each
measurement time t e {71, . . . , 7M} g [0,7]. For normalization purposes,
the total number of ﬂuorescent proteins over the whole nucleus, denoted
by Y(t), is also recorded at measurement times. The effects of varying the
size of the bleaching region and of positioning the bleaching region near
the boundaries were also investigated (see Sections 8142 and 81.4.3 of
the Supplementary material). Experimental assessment of the simulation
procedure was performed by comparison with real data in (Cinquemani
et al., 2008).

2.2 Parameter inference method

Let us associate every recovery curve with a vector of parameters

p=(or,,8,y,8) taking values in P g R10. The value ofp for a given

curve is determined by ﬁtting the model
2,,(t) = 1 — ae’ﬁ' — ye’at (5)

to that curve. Details about the ﬁtting process are given in Section 2.2.2;
for the moment, we simply assume that every curve corresponds to a
single value of p, and that different curves correspond to different
values of [7. Let Q g [Rio be the set of all possible physical parameter
vectors 6=(D,F, T), where D, F and T denote diffusion coefficient,
bound fraction and residence time, respectively. In accordance with our
stochastic model, several recovery curves, i.e. several parameter values
p e P, correspond to the same 6. The region of P associated with a given 6
could be obtained by repeated simulation of the model. Alternatively,
given one recovery curve with parameters [70, a cluster of parameters [7
[denoted as C(p0)] approximating this region is obtained by bootstrap-
ping, i.e. by resampling a family of curves from the po ﬁtting residuals.
This strategy applies both to simulated and experimental recovery curves.
In the former case, only one simulation of the stochastic model is
required, with great computational savings (one simulation takes one
to several minutes, depending on 6 and the experimental period of
interest).

 

357

112 /310's112u1n0fp101x0"sotJBHJJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

M.A.Rapsomaniki et al.

 

Stochastic
model

  
   
     

 

   
 

 

     
   
      

  
  

 

............................ .. . FRAP .........................
experiment
Cun/e
Space Simulated Experimental
Curves Curve
Fitting ———————————————————————— --
Bootstrapping Bootstrapping
________________________ __ Neural Network ______________________
Training :
Ospace i
TRAINING : ESTIMATION

Fig. 2. Outline of the parameter inference method. Left: Training pro-
cess, executed for many kinetic parameter combinations to generate the
desired mapping. Right: Estimation process, executed once per experi-
mental curve to infer kinetic parameters. The methods used for ﬁtting and
bootstrapping are common for the training and estimation processes

We can now outline our inference method. The procedure, depicted in
Figure 2, is organized in two processes: (i) training process: build a map-
ping from recovery curves to physical parameters using simulated curves,
i.e. from P to O and (ii) estimation process: apply the mapping to experi-
mental curves for which an estimate of 6 is sought. During the training
process (left panel of Fig. 2), we ﬁrst extract several values of 6 randomly
distributed over 6. For each of these values we simulate the model once
to get a reference recovery curve, ﬁt the curve with a parametrized func-
tion of the form (5) and perform bootstrapping to get a cluster of par-
ameters [7. These clusters and the corresponding values of 6 are used to
train an ANN that maps P into 6. During the estimation process (right
panel of Fig. 2), given an experimental recovery curve, we ﬁt the model of
equation (5) to get [3 and perform bootstrapping to get a cluster of par-
ameters C(13). Then, the mapping constructed during the training process
is applied to [3 as well as to every element in the cluster, which yields an
estimate of 6 (from [3) and a conﬁdence region around it in the form of a
cluster of points in Q (from the cluster of points in P). The accuracy of
the method clearly depends on a number of factors and will be discussed
based on numerical simulation in Section 3.1. The details of the procedure
are given next.

2.2.] Simulation of FRAP curves To generate recovery curves that
represent different FRAP behaviors, we ﬁrst select randomly n combin-

ations of physical parameter values 61, . . . , 6" in the set
®=[0,5]X[0,11X[0,71- (6)
Each parameter vector 6’, i = 1, . . . ,n is then used to simulate a single

FRAP curve yi(t) along with the total nuclear ﬂuorescence intensity Yi(t)
from time 0 to time 7. The resulting sample recovery proﬁles are normal-
ized using the double normalization process described in (Phair et al.,
2004), also used for experimental recovery curves. Normalized recovery
curves zi(t) are deﬁned as follows: for all measurement times
te {tl,...,tM},

2"(t) = W(t)/yii/i Y"(t)/ 11;],

where y* and Y* are, respectively, the time averages of y(t) and Y(t) over
the pre-bleach period [0, 7*]. Background ﬂuorescence subtraction, usu-
ally carried out on real data before normalization, is not needed for
simulated data. Division by total ﬂuorescence corrects for loss of ﬂuor-
escence due to the photobleaching step, as well as for ﬂuctuations in the
ﬂuorescence intensity during the time course of the experiment, due e.g.
to acquisition bleaching or ﬂuctuations in laser intensity. Division by pre-
bleach intensities corrects for differences across cells or experiments in the
starting intensity in the bleach region relative to the overall nuclear in-
tensity. Such differences may be caused by different cell or bleaching
geometries. A direct effect of this normalization process is that, as
t —> co, the normalized curve will rise to plateau values of 1, as ﬂuores-
cence will progressively become again homogeneous over the whole nu-
cleus. For more details on this and the implications in parameter
estimation, see Section 81.4 of the Supplement.

2.2.2 Curve ﬁtting Consider the vector of parameters [7:(0t, ,8, y, 8)
e P and the parametric curve z],(t) deﬁned in equation (5). We use the
two-term exponential equation because of its ability to ﬁt well both re-
gimes (diffusive and reaction) typically observed in FRAP curves. The
constant term of z],(t) was set to 1 to reﬂect the fact that, under full
recovery (7 —> oo), normalized FRAP curves are expected to plateau to
1 (see Section 2.2.1 above). We ﬁt each (simulated or experimental) curve
2(7) as follows. Let r1,(t) denote the residuals r1,(t)=z(t) —z,,(t), with
7: 7m, m= 1, . . . , M. The vector [3 e P we associate with the curve is
deﬁned as the solution of the following optimization problem:

M
minimize: r,,(tm)2 with respect to p e P

m=l

subjectto,8>8 and 1 —0t— y 3 0.

The ﬁrst constraint disambiguates the role of the two exponential terms
and ensures that the ﬁrst exponential accounts always for the diffusive
(fast recovery) regime. For biological consistency and numerical stability,
the second constraint ensures that the ﬁtted curve never goes below zero
over the whole post-bleach period (including the time between 7* and the
ﬁrst measurement after it). To solve the resulting non-linear constrained
optimization problem, we use the global optimization algorithm OQNLP
(Ugray et al., 2006), implemented in MATLAB as the GlobalSearch
function.

2.2.3 Bootstrapping Next, we obtain uncertainty clusters using a sto-
chastic approach based on bootstrapping (Efron et al., 1986). For each
simulated (or experimental) curve 2(7), consider the ﬁtted curve 213(7) and
the ﬁtting residuals r]; (t), which we assume to be identically distributed. A
new artiﬁcial FRAP curve is obtained by bootstrap sampling (sampling
with replacements) of the ﬁtting residuals r1301), . . . , r]; (W) and adding
them to the ﬁtted curve 213(71), . . . ,zi,(tM). This step is repeated 1 times
and results in l artiﬁcial curves, which can be seen as local perturbations
of the initial simulated (or experimental) curve, subject to the same
amount of noise. Then, by ﬁtting the resulting l artiﬁcial FRAP curves
as in Section 2.2.2, we construct a cluster C(13) of 1 parameters [7. This
cluster serves as a local estimate of the sensitivity of the p vectors due to
noise and process randomness.

2.2.4 Neural network training We construct a simple function-ﬁtting
ANN, trained by gradient descent using the LevenbergiMarquardt algo-
rithm, as implemented in the MATLAB Neural Network toolbox. The
ANN’s architecture is described by an input vector of four features (the
entries of the parameter vector [7), one hidden layer of 25 neurons and 1
output vector of 3 output elements (the entries of 6). The dataset used for
training and testing the ANN comprises the n triplets (6’, 13’, C(13’)), with
i = 1, . . . ,n, where each 6i is one combination of kinetic parameters,
sampled as described in Section 2.2.1, [3i is the ﬁt of the corresponding

 

112 /310's112u1n0[p1q1x0"soticurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

Inference of protein kinetics from FRAP experiments

 

simulated trajectory 2,-(7) determined as in Section 2.2.2 and C(13') is the
uncertainty cluster computed from if as in Section 2.2.3. The input vec-
tors of the ANN are scaled to [71 1] and the hyperbolic tangent sigmoid is
used both as a transfer and activation function. In this way the output
range of the ANN is implicitly bounded to [71 1]. By transforming back
to the initial scaling, the output range is bounded to the search space as
expressed in (6), preventing the prediction of parameter estimates that
lack biological meaning.

The dataset is divided in two subsets: The ﬁrst (90% of the triplets) is
used during the learning phase and the second (the remaining 10% of the
triplets) is used as an external test set for a posteriori independent assess-
ment of the generalization ability of the trained ANN (ability to predict 6
from p for triplets not used in the learning). During the learning phase,
the learning dataset is iteratively and randomly partitioned in a training
subset (70% of the total triplets) and a validation subset (20%). In each
iteration, the training set is used to adjust the network’s internal param-
eters by specifying each 6i as the output of pi and of all parameters in the
corresponding cluster C(pi). The validation set is used to evaluate the
training process, which continues until a termination criterion is met
(more details in Section 82.3 of the Supplementary material). On execu-
tion of this procedure, one gets an ANN that implements the desired
mapping 6 : P —> 6.

2.2.5 Implementation We performed a round of 100 Monte Carlo
simulations, using as input the physical parameter vectors 6', obtained
by random sampling in the @-space as described in Section 2.2. 1. For the
purposes of this study, D was sampled in the interval [0, 50] me/s by
sampling a uniformly in the interval [0, 10] and using equation (2). Twas
sampled uniformly in the interval [0, 25] 5. To account for the cases of
proteins that portray only a diffusive behavior, 10 more 6 vectors were
added to the dataset with F = 0 and D drawn at random in [0, 50] me/s
(note that T is irrelevant in this case). The total of n = 110 in silico
experiments were simulated; in all cases, the nucleus was represented as
an ellipsoid with semi-principal axes of length 5, 4 and 4 pm, the bleach-
ing region as a sphere of radius 2pm, positioned in the center of the
nucleus and the number of particles N was set to 50000.

Approximation parameter h was set to 0.10m for the reasons ex-
plained in Section 2.1. Fifty pre-bleach and 250 post-bleach measure-
ments were taken at 0.0665 time intervals and bleaching was attained
by a single bleach pulse of 0.066 s. For the above setting, simulation
times vary in the order of hours and depend heavily on the choice of
the input vector 6i (for example, fast diffusion demands greater approxi-
mation resolution, leading to longer simulation times). The respective
simulated curves were ﬁtted as described in Section 2.2.2, yielding 110
p vectors. Following the bootstrap process of Section 2.2.3, I = 100 arti-
ﬁcial curves were created for each simulated curve and subsequently ﬁtted
to obtain the clusters C(pi).

2.2.6 Parameter estimation from experimental data Parameter in-
ference for an experimental curve is done by repeating the same steps as
for the training part, as shown in Figure 2. More speciﬁcally, for every
given curve yobs we proceed as follows:

(1) Normalize the curve to get 201,], (Section 2.2.1);

(2) Fit 2p to 201,, and get [30b1, (Section 2.2.2);

(3) Compute the cluster C(ﬁm) by bootstrapping (Section 2.2.3);

(4) Get the estimate of 6 by feeding [30b], to the ANN, yielding 6030,”);

(5) Get the uncertainty of the estimate 6 by feeding the elements of
C(ﬁm) to the ANN, yielding {6(p) :p e C(pmﬂ.

2.3 Cell culture and F RAP experiments

MCF7 cells were grown in Dulbecco’s modified Eagle’s medium with
20% fetal bovine serum at 37°C and 5% C02 and were transiently

transfected with Cdtl-GFP, PCNA-GFP or GFPnls as described in
(Roukos et al., 2011). FRAP experiments were performed on a Leica
SP5 confocal microscope, equipped with a 63 x 1.4 NA oil immersion
lens and FRAP booster. During experiments, cells were plated on Ibidi
30 mm diameter glass-bottom dishes in phenol red-free COz-independent
medium (Invitrogen) and maintained at 37°C and 5% C02. Bleaching of
GFP was accomplished on a deﬁned region of interest of 2pm radius
within the cell nucleus. Fifty pre-bleach images were recorded with 4%
laser power of the 488 nm line at 40% argon laser intensity, and bleaching
was attained by a single bleach pulse of 0.066 s using the 488 and 496nm
laser lines combined at maximum power. After bleaching, 250 images
were recorded at 0.0665 time intervals with 4% laser power of the
488nm line. Raw data were double normalized using the easyFRAP
software (Rapsomaniki et al., 2012). For FRAP experiments after
DNA damage, cells were ultraviolet (UV) irradiated for 10 5 (moderate
UV dose) using a CL-1000 Ultraviolet Crosslinker UVP and incubated
for 1 h before the FRAP experiment.

3 RESULTS AND DISCUSSION

3.1 Performance assessment of the inference method

We ﬁrst evaluate the performance of the proposed inference
method using simulated data. To assess the predictive perform-
ance of the ANN in a way that is independent of the speciﬁc
choice of the test set, we applied a procedure of external k-fold
cross-validation. During this process, we repeat the construction
of the ANN as described in Section 2.2.4, but for iterative and
complementary partitions of the n triplets into learning and test-
ing data. More speciﬁcally, the n = 110 triplets are randomly
partitioned into k = 10 subsets (each one of size n/k=11) of
which one is set aside as the independent test set and the remain-
ing ones are used as the learning set of the ANN. This process is
repeated k = 10 times, so that all k subsets are iteratively used as
a test set. Note that, for this choice of k, in any iteration the
learning and test set represent, respectively, 90 and 10% of the
triplets.

In Figure 3 boxplots of the prediction residuals (true minus
predicted parameter values) for all k = 10, disjoint test sets are
plotted. Each boxplot corresponds to all I = 100 cluster points of
the n/k=11 test samples, i.e. to 1100 prediction residuals. We
can see that the ANN’s performance for different choices of the
training and the test set is comparable, leading to the conclusion
that the network training is relatively insensitive to the speciﬁc
choice of the training data. This fact is crucial for the reliability
of our method, which is based on a small simulated dataset.
Furthermore, the distribution of the prediction residuals indi-
cates that parameter estimates are effectively unbiased and loca-
lized with high conﬁdence near the true parameter values.

3.2 Inference of kinetic parameters from F RAP experi-
mental data

The proposed parameter inference method was used for the ana-
lysis of DNA licensing protein Cdtl and DNA replication/repair
protein PCNA. GFP-tagged Cdt1, GFP-tagged PCNA following
whole-cell UV irradiation as well as a GFPnls protein were ex-
pressed in MCF7 cells and analyzed by FRAP. A total of 14
GFPnls, 16 Cdtl-GFP and 13 PCNA-GFP FRAP curves were
analyzed. In Figure 4, the individual FRAP curves (normalized
data) for each cell as well as their respective means are shown.

 

359

112 /310's112u1n0[p101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

M.A.Rapsomaniki et al.

 

 

 

 

 

 

 

40 e i Diﬂusion coellicient (D) e
+ +
+
a 20— + + 7 -
a . s: é % - a -
g 0 g % El :1 % J— El
g _20_ + + i + J_ :I: _
.9
E —40— i .
a + * Bound traction (F)
9 0.5—
r:
-— +
E i +
E °'= % % Q % i it I-‘—+L'- g- 1%“
6 i
l!
v—ose 7
g i + i
a +
'g + Residence time (T)
_ + _v
mg: 10 _ 3 i + + +
go-@¥E$%E$rﬁl%%'
e I
u. -10— + J— _
+ +
—207 + e
1 2 a a 9 10

4 5 6 7
Index 01 Cross Validation run (k)

Fig. 3. Boxplots showing the distribution of the prediction residuals
(actual minus predicted value) for each parameter and each cross valid-
ation run. Diffusion coefficient varies from 0 to 50 me/s, bound frac-
tion from 0 to 1 and residence time from 0 to 25 s. The red line represents
the median, the edges of the box represent the 25th and 75th percentiles
and the whiskers extend to the most extreme data points. Outliers are
plotted individually as red crosses

A preliminary analysis of Figure 4 reveals that the different
proteins are characterized by markedly different behaviors, both
in terms of average behavior (Fig. 4, right) and in terms of vari-
ability (Fig. 4, left). Several conclusions can be drawn from the
mean curves of Figure 4; the observations that GFPnls exhibits a
fast and full recovery, Cdtl-GFP a slow but ongoing recovery
and PCNA-GFP a partial recovery hint to their underlying kin-
etics. The parameter inference method was used to draw esti-
mates of diffusion coefﬁcient, bound fraction and residence
time of the three protein species from each curve individually,
thus obtaining 14 GFPnls, 16 Cdtl-GFP and 13 PCNA-GFP
initial estimates. For each of these, the uncertainty clusters
were also computed. The results are shown graphically in
Figure 5; numerical values are reported in Supplementary
Tables S3785.

3 .21 Predictions agree with known protein behaviors A first ob-
servation from Figure 5 is that estimates associated with different
proteins localize in different regions of the physical parameter
space O, separable even by visual inspection. GFPnls estimates
are located in the area close to zero bound fraction and zero
residence times, indicating a purely diffusive behavior.
Estimates for Cdtl-GFP are located in a subspace of O where
the residence time varies in the order of seconds and the bound
fraction varies up to 40%, indicating transient interactions (scan-
ning behavior) coupled to diffusion. Finally, estimates for
PCNA-GFP are saturated in the area of higher residence
times, suggesting longer immobilization coupled to diffusion
for PCNA following UV irradiation. These results agree with
qualitative and quantitative analysis of the behavior of these
proteins in earlier work (Essers et al., 2005; Mortusewicz and
Leonhardt, 2007; Roukos et al., 2011; Xouri et al., 2007).

3.2.2 Estimation of PCNA residence time In agreement with the
expectation of a non-negligible fraction of PCNA molecules with
longer residence times, predictions for the latter saturate onto the
side of O corresponding to T. Motivated by this, we repeated the
estimation process for PCNA-GFP by training the ANN with a

 

 

 

P
m

 

P
a:

 

 

 

 

P
b

7 GFPnls
— Cdt1rGFP
7 PCNArGFP

 

Mean Normalized Fluorﬁcence Recovery

P
m

 

PCNAAGFP

 

 

 

 

 

 

time (5) “me (5)

Fig. 4. Experimental FRAP recovery curves (individual curves on the left

and their respective means on the right) for GFPnls (green), Cdtl-GFP
(blue) and PCNA-GFP (red)

new simulated dataset, for which the values of T are exponen-
tially distributed in the range [0, 1000] s. As shown in Figure 6,
the resulting estimates of Tfor PCNA-GFP appear to localize in
much higher residence times of up to 15min. At the same time,
the expansion of the search space allowed for a better estimation
of bound fraction (values of F vary around 50%, which is sup-
ported by the biological expectations) and reconfirmed the esti-
mates of D (numerical values reported in Supplementary Table
S6). Estimates for the other proteins remained largely unchanged
(results not shown), albeit with slightly worse accuracy, which is
expected because the much larger search space is explored by the
same number of simulated curves.

Regardless of the choice of T, a further limitation concerning
the accuracy of the estimation of Tcomes from the fact that large
values of T (high residence times) are in general difﬁcult to re-
solve based on the short time span of the experiment (recoveries
were followed for 18s in this dataset). In these cases, longer
FRAP experiments would facilitate a more accurate estimation.
Simulation results presented in Section S2.2 of the Supplement
show that the sensitivity of the recovery curves to different values
of T decreases with T itself, and becomes marginal as T gets
larger. This sensitivity depends as well on the other physical par-
ameters; in particular it increases with D and F. The latter can be
explained considering that for molecules with a higher bound
fraction, unbinding events participate more in the recovery,
and thus for increasing values of T there is a more noticeable
difference in the curves.

3.2.3 Cell-to—cell variability For all three proteins, cell-to-cell
variability of the FRAP curves indeed ﬁnds its counterpart in
the variability of the kinetic parameter estimates, as captured by
the different locations of clusters in the O space. We observe that
clusters corresponding to different GFPnls curves are relatively
concentrated (Fig. 5), whereas in the case of Cdtl-GFP (Fig. 5)
and PCNA-GFP (Fig. 6) the clusters are more spatially dis-
persed, indicating higher cell-to-cell heterogeneity. In particular
for Cdtl-GFP, the cluster estimates for bound fraction and resi-
dence times seem to vary signiﬁcantly, roughly with inverse pro-
portionality. Because the cells are not synchronized and Cdtl is a
cell cycle regulator, this relation may be owing to changes in the
binding behavior of Cdtl. During the cell cycle, non-speciﬁc

 

360

112 /310's112u1n0[p101x0"sotJBurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

Inference of protein kinetics from FRAP experiments

 

Residence time (s)

    

is)

2
Diffusion kin“

P
on

 

25

 

 

 

 

 

 

 

 

 

 

\ \ r\
E 0.4 n @20
s a
E “'3 L .. :15 ‘ \
E 02 I“ 8 m
a a I ‘
a: m n. _.. u... E 5
CE ‘
4“ ‘. ‘ -
0 H a
o
o 20 40 0 02 M

Diffusion (me/S) Diffusion (me/s) Bound Fraction

Fig. 5. Cluster estimates for the proteins of interest: GFPnls (green),
Cdtl-GFP (blue), PCNA-GFP (red). Top: Parameter estimates shown
in the 3D space of kinetic parameters. Estimates for the experimental
curves are shown as black dots. Bottom: Respective pairwise projections
of the estimates

scanning for binding sites of a larger percentage of Cdtl mol-
ecules could be followed by a more permanent binding of less
molecules.

We also notice that variability of FRAP curves may be decep-
tive: visual inspection of Cdtl and PCNA curves (Fig. 4, left)
suggests a similar amount of cell-to-cell variability, as individual
curves seem to spread apart similarly. However, the estimation
process reveals a completely different pattern of variability of the
Cdtl and PCNA kinetics, the latter being essentially confined to
variable residence times.

3.2.4 Identifiability Finally, we note that both the spread and
shape of the estimation clusters is an indication of the identiﬁa-
bility of the underlying kinetic parameters on a single-cell level.
In particular, as observed in Figure 5, Cdtl-GFP clusters are
relatively symmetrical and concentrated around the estimates
of the experimental curve, suggesting that their parameters are
identifiable. On the other hand, most PCNA-GFP clusters
(Fig. 6) are fairly concentrated in the directions of diffusion
and bound fraction, but spread along the dimension of residence
time. This is clearly revealed by the conﬁdence intervals reported
in Supplementary Table S6 and points to practical identiﬁability
issues concerning this parameter. Inherent difﬁculties with iden-
tifying PCNA residence times can be explained in the light of the
discussion in Section 3.2.2.

These ﬁndings also show that the sensitivity of FRAP curves,
hence the uncertainty of the resulting estimates, is non-uniform
over O and depends on the actual underlying kinetic parameters.
Furthermore, through the construction of the bootstrap clusters,
our method allows us to expose identifiability issues, such as
when curves are explained by multiple sets of physical param-
eters. Less clear, but perhaps more intriguing, is whether and
how this uncertainty links with the different features of cell-
to-cell variability discussed above for the different proteins.
This fact is only partially uncovered in the present analysis and
deserves future investigation.

Residence time (s)

30

20

 

2
DWS‘O“ (“m is)

1 1000 1...",

a

5m 0.
ll
0 5

 

0

Bound fraction
3
oi
~
Q
‘

Q
Residence time (s)
S
a
d

any
Re5idence time (s)

 

 

 

 

 

0 0 u
0 20 40 0 20 40 0

Diffusion (me/s) Diffusion (me/s)
Fig. 6. Predictions for PCNA-GFP for T: 1000 5 reveal residence times
up to 15min. Top: Parameter estimates shown in the 3D space of kinetic
parameters. Estimates for the experimental curves are shown as black
dots. Bottom: Respective pairwise projections

 

 

. 1
Bound Fraction

4 CONCLUDING REMARKS

In this work, we have proposed a novel kinetic parameter infer-
ence method for the quantitative analysis of FRAP data. Our
method constructs off-line a mapping between parameters of the
FRAP curves and the parameters of an underlying kinetic model.
Once this mapping is available, it can be used for inexpensive
parameter inference on many FRAP datasets. Thanks to nor-
malization, the same mapping can, to some extent, be applied to
varying experimental setups.

Quantitative validation using simulated experiments showed
that the method is capable of reconstructing kinetics that were
not directly explored via simulation with a reasonable accuracy
at an affordable computational cost. When applied to experi-
mental FRAP data for different proteins and from different
cells, estimation results were found to be in agreement with exist-
ing knowledge. Analysis of the results from individual cells also
showed the potential of the method in the study of cell-to-cell
variability of protein kinetics and emphasized the importance of
single-cell rather than mean recovery curves in this type of
analysis.

Through this work, several open problems in FRAP quanti-
tative analysis have emerged. Identiﬁability and sensitivity of
kinetic parameters is a critical issue, which we partially address
here by a local analysis based on bootstrapping. On the one
hand, a straightforward generalization of the method, based on
the use of repeated simulations of the same kinetic parameters at
a learning stage, may improve the information on local sensitiv-
ity of FRAP curves and resulting estimation uncertainty.
However, more work needs to be done so that global informa-
tion on parameter identiﬁability is available. Whatever the mod-
eling and estimation method used, quantitative validation of
modeling and estimation on experimental data is of critical im-
portance. A big step toward this end would be the availability of
benchmark datasets of real experimental data along with accur-
ate and accessible information on the underlying parameter
values.

 

361

112 /310's1izu1n0[p101x0'sotieurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isanV 110 ::

M.A.Rapsomaniki et al.

 

ACKNOWLEDGEMENTS

We thank the Advanced Light Microscopy Facility of the
University of Patras.

Funding: This work was supported by a grant from the European
Research Council to Z.L. (DYNACOM, ERC StG 281851) and
by the European Commission under the HYCON2 Network of
Excellence. M.A.R. was supported by a Swiss Government
Scholarship.

Conflict of interest: none declared.

REFERENCES

Bancaud,A. et a]. (2010) Fluorescence perturbation techniques to study mobility
and molecular dynamics of proteins in live cells: FRAP, photoactivation, photo—
conversion and FLIP. Cold Spring Harb. Protoc., 2010, pdb.top90.

Beaudouin,J. et a]. (2006) Dissecting the Contribution of Diffusion and Interactions
to the mobility of nuclear proteins. Biophys. J., 90, 187871894.

Carrero,G. et a]. (2003) Using FRAP and mathematical modeling to determine the
in vivo kinetics of nuclear proteins. Methods, 29, 14328.

Cinquemani,E. et a]. (2008) Numerical analysis of FRAP experiments for DNA
replication and repair. In: Proceedings of the IEEE Conference on Decision and
Control. Cancun, Mexico, pp. 51835185.

Cowan,A.E. et a]. (2009) Using the virtual cell simulation environment for extract—
ing quantitative parameters from live cell ﬂuorescence imaging data. Microsc.
Microanal., 15, 152271523.

Efron,B. and Tibshirani,R. (1986) Bootstrap methods for standard errors, conﬁ—
dence intervals, and other measures of statistical accuracy. Stat. Sci., 1, 54375.

Ellenberg,J. et a]. (1997) Nuclear membrane dynamics and reassembly in living cells:
targeting of an inner nuclear membrane protein in interphase and mitosis. J.
Cell Biol, 138, 119371206.

Essers,J. et a]. (2005) Nuclear dynamics of PCNA in DNA replication and repair.
Mol. Cell. Biol, 25, 93509359.

Farla,P. et a]. (2004) The androgen receptor ligand—binding domain stabilizes DNA
binding in living cells. J. Struct. Biol, 147, 5061.

Houtsmuller,A.B. et a]. (1999) Action of DNA repair endonuclease ERCCl/XPF in
living cells. Science, 284, 958961.

Jacquez,J.A. (1996) Compartmental Analysis in Biology and Medicine. 3rd edn.
Biomedware, Ann Arbor, MI, p. 512.

Kushner,H.J. and Dupuis,P.G. (1992) Numerical Methods for Stochastic Control
Problems in Continuous Time. Springer, New York, NY.

Mortusewicz,O. and Leonhardt,H. (2007) XRCCl and PCNA are loading plat—
forms with distinct kinetic properties and different capacities to respond to
multiple DNA lesions. BMC Mol Biol, 8, 81.

Mueller,F. et a]. (2010) FRAP and kinetic modeling in the analysis of nu—
clear protein dynamics: what do we really know? Curr. Opin. Cell. Biol, 22,
4037411.

Phair,R.D. and Misteli,T. (2001) Kinetic modelling approaches to in vivo imaging.
Nat. Rev. Mol. Cell Bio., 2, 8987907.

Phair,R.D. et a]. (2004) Measurement of dynamic protein binding to
chromatin in vivo, using photobleaching microscopy. Method Enzymol, 375,
3937414.

Rapsomaniki,M.A. et a]. (2012) easyFRAP: an interactive, easy—to—use tool for
qualitative and quantitative analysis of FRAP data. Bioinformatics, 28,
180071801.

Reits,E.A.J. and Neefjes,J.J. (2001) From ﬁxed to FRAP: measuring protein mo—
bility and activity in living cells. Nat. Cell Biol, 3, 1457145.

Roukos,V. et a]. (2011) Dynamic recruitment of licensing factor Cdtl to sites of
DNA damage. J. Cell Sci., 124, 42434.

Van Royen,M.E. et a]. (2009) Fluorescence recovery after photobleaching (FRAP)
to study nuclear protein dynamics in living cells. Methods Mol Biol, 464,
3637385.

Sbalzarini,I.F. et a]. (2006) Simulations of (An)Isotropic diffusion on curved biolo—
gical surfaces. Biophys. J., 90, 8787885.

Sprague,B.L. et a]. (2004) Analysis of binding reactions by ﬂuorescence recovery
after photobleaching. Biophys. J., 86, 347373495.

Sprague,B.L. and McNally,].G. (2005) FRAP analysis of binding: proper and ﬁt—
ting. Trends Cell. Biol, 15, 84P91.

Tardy,Y. et a]. (1995) Interpreting photoactivated ﬂuorescence microscopy meas—
urements of steady—state actin dynamics. Biophys. J., 69, 167431682.

Ugray,Z. et a]. (2006) Scatter search and local NLP solvers: a multistart framework
for global optimization. INFORMS J. Computing, 19, 3287340.

Xouri,G. et a]. (2007) Cdtl associates dynamically with chromatin throughout G1
and recruits geminin onto chromatin. EMBO J., 26, 130%1314.

 

362

112 /310's1izu.rn0[p.rq1x0'sotieurJOJHtotq/ﬁduq 111011 papeo1um0q

9103 ‘0g1sn8nv 110 ::

