Bioinformatics, 31113), 2015, 2159—2165

doi: 10.1093/bioinformatics/btv096

Advance Access Publication Date: 19 February 2015
Original Paper

 

Systems biology

CycleFreeFlux: efficient removal of
thermodynamically infeasible loops from flux
distributions

Abdelmoneim Amer Desouki1'4 Florian Jarrez, Gabriel Gelius-Dietrich1
and Martin J. Lercher1'3

1Institute for Computer Science, 2Institute for Mathematics, 3Cluster of Excellence on Plant Sciences, Heinrich
Heine University, 40225 Diisseldorf, Germany, and 4Faculty of Computers and Informatics, Suez Canal University,
lsmailia, Egypt

Associate Editor: Jonathan Wren

Received on April 4, 2014; revised on January 27,2015; accepted on February 10, 2015

Abstract

Motivation: Constraint—based metabolic modeling methods such as Flux Balance Analysis (FBA)
are routinely used to predict metabolic phenotypes, e.g. growth rates, ATP yield or the fitness of
gene knockouts. One frequent difficulty of constraint—based solutions is the inclusion of thermo—
dynamically infeasible loops (or internal cycles), which add nonbiological fluxes to the predictions.
Results: We propose a simple postprocessing of constraint—based solutions, which removes in—
ternal cycles from any given flux distribution v10) without disturbing other fluxes not involved in the
loops. This new algorithm, termed CycleFreeFlux, works by minimizing the sum of absolute fluxes
llvll1 while (i) conserving the exchange fluxes and (ii) using the fluxes of the original solution to
bound the new flux distribution. This strategy reduces internal fluxes until at least one reaction of
every possible internal cycle is inactive, a necessary and sufficient condition for the thermo—
dynamic feasibility of a flux distribution. If alternative representations of the input flux distribution
in terms of elementary flux modes exist that differ in their inclusion of internal cycles, then
CycleFreeFlux is biased towards solutions that maintain the direction given by v10) and towards so—
lutions with lower total flux llvll1. Our method requires only one additional linear optimization, mak—
ing it computationally very efficient compared to alternative strategies.

Availability and implementation: We provide freely available R implementations for the enumer—
ation of thermodynamically infeasible cycles as well as for cycle—free FBA solutions, flux variability
calculations and random sampling of solution spaces.

Contact: lercher@cs.uni—duesseldorf.de

 

1 Introduction

 

Constraint-based methods for the functional analysis of metabolic
networks (CBM or COBRA methods) rely on stoichiometric equa-
tions and do not require kinetic information for individual reactions.
They are thus applicable to genome-scale metabolic systems (Lewis
et (11., 2012). Flux-balance analysis (FBA), which involves the maxi-
mization of a fitness-related objective function in steady-state condi-
tions (Orth et (11., 2010), has been successfully applied to predict

phenotypes such as growth rates, ATP yield and the effects of gene
knockouts. Recent publications have applied FBA to predict drug
targets (Colijn et (11., 2009; Plata et (11., 2010), while others have
used FBA to study the evolution of metabolic systems (Barve and
Wagner, 2013; Pal et (11., 2005, 2006).

FBA predicts the maximal value of the objective function—often
the yield of biomass production (Orth et (11., 2010; Schuster et (11.,
2008)—together with a set of flux values for all reactions included

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2159

/310‘srcumo[p10}xo‘sopcuHOJHrorq/ﬁdnq

2160

A.A.Desouki et al.

 

in the metabolic system (a ‘flux distribution”) (Colijn et al., 2009).
One of the difficulties of FBA predictions is that they frequently in—
clude thermodynamically infeasible internal cycles, i.e. sets of
reactions that together carry a flux that has no influence on the
exchange reactions of the model (De Martino et al., 2013; Price
et al., 2002; Schellenberger et al., 2011; Schilling et al., 2000;
Wright and Wagner, 2008). These are metabolic ‘perpetual motion
machines” and do not occur in biological reality. Such internal cycles
thus distort predicted flux distributions and should be removed
from the predictions. Thermodynamically infeasible cycles affect not
only the predictions of FBA, but also those of many other con—
straint—based analysis methods. In particular, thermodynamically
infeasible cycles distort the output of sampling algorithms that aim
to characterize the steady—state solution space, and lead to the as—
signment of unrealistically high values to the flux ranges that can be
carried by individual reactions in flux variability analysis (FVA)
(Mahadevan and Schilling, 2003).

At least for FBA, there exists a strategy that ensures the thermo—
dynamic feasibility of the flux distribution: the minimization of the
sum of absolute fluxes under the additional constraint of an optimal
value for the original objective function (minimization of total flux,
MTF) (Holzhiitter, 2004; Schuetz et al., 2012). This method aims to
approximate a flux distribution that minimizes cellular investment
into enzymes, and is hence sometimes called parsimonious FBA
(Lewis et al., 2010). As a side effect of its parsimonious strategy,
MTF also removes any internal cycles. MTF solutions do not repre—
sent the full thermodynamically feasible solution space of the ori—
ginal FBA problem; hence, they cannot be used to characterize this
full space, which is the purpose of random sampling algorithms and
FVA calculations.

Several approaches for the identification and/or exclusion of
thermodynamically infeasible cycles have been proposed (De Martino
et al., 2013; Schellenberger et al., 2011; Wright and Wagner, 2008).
The most widely used method, ll—COBRA (Schellenberger et al.,
201 1), is based on the integration of thermodynamic constraints with
FBA into a mixed—integer linear problem (MILP). However, this
approach is computationally expensive, resulting in runtimes that se—
verely limit its applicability to large—scale studies.

Here, we propose a new algorithm, termed CycleFreeFlux, which
removes all thermodynamically infeasible cycles from any given flux
distribution with a single linear optimization step; this makes it
orders of magnitude faster than previous approaches when applied
to sampling or flux variability analyses of genome—scale metabolic
networks.

2 Results

2.1 Characterization of thermodynamically feasible flux
distributions

To motivate the CycleFreeFlux algorithm, we first formally charac—
terize thermodynamically feasible flux distributions. Consider the
following standard FBA problem (bold face indicates vectors):

max CTV

subjectto: Sv : 0 (1)
lgvgu
Here, S is a stoichiometric matrix, where each row corresponds
to one metabolite, and each column contains the stoichiometric co—

efficients of one reaction; v is a vector of fluxes through these reac—
tions; Sv : 0 enforces a steady state in which all internal metabolite

concentrations are constant; 1 and u are vectors of lower and upper
bounds for v, respectively, where S is applied element—wise; and ch
with a constant weight vector c is a linear combination of fluxes that
is maximized (the ‘gain’ of v). In many applications, this objective
function contains just one hypothetical flux that corresponds to the
rate of biomass production, ch : tibia (Schuster et al., 2008).

In the following, we will call a flux distribution ‘feasible’ if it is
nonzero and adheres to all constraints in the FBA problem (1) (i.e. if
it lies in the space of feasible solutions of (1)). support(v’) denotes
the set of indices / with U," 9E 0. A flux distribution v’ is thermo—
dynamically feasible if, and only if, there exists an assignment of
free energies G to the metabolites such that the free energy change
caused by each active reaction is strictly negative, i.e. 1!,"ch < 0 for
all j E support(v’), with AG; : siTG, where 5, denotes the /—th col—
umn of S (Beard et al., 2002; Schellenberger et al., 2011).

We will explicitly consider the free energies of external metabol—
ites in order to deal correctly with thermodynamically infeasible
flux distributions that involve transport reactions (reactions that
shuttle metabolites between internal compartments and the external
compartment). For each external metabolite, we add one reversible
‘exchange’ reaction between the external compartment and an add—
itional ‘NULL’ compartment that is not explicitly modeled. Many
genome—scale metabolic reconstructions already define exchange re—
actions in that way. For any given free energy of a metabolite pre—
sent in the external compartment, we can set a hypothetical free
energy outside the external compartment that drives the exchange
reaction in the desired direction. Thus, exchange reactions as
defined here are always thermodynamically feasible. When consider—
ing thermodynamical feasibility, we only need to examine internal
reactions (including transport reactions), and it is hence convenient
to partition the stoichiometric matrix into an internal and an ex—
change part, S : (Sim, Sex].

We call a nonzero flux distribution Av ‘internal’ if, and only if, it
fulfills the conditions SAV : 0, min {1,-,0}§U,-§max {0,14,} for all
fluxes 11,, and if all its exchange fluxes are zero. Thus, internal flux
distributions do not change any internal or external metabolite con—
centrations; they can be thought of as combinations of internal
cycles that collectively neither consume nor produce anything. If the
constraints of (1) do not enforce any nonzero fluxes, then internal
flux distributions are also feasible.

As free energy is a state variable of metabolites, the free energy
changes of the reactions active in Av must add to zero in steady
state: AVAG : 0 (Beard et al., 2002; Schellenberger et al., 2011).
Thus, AUkAGkZO for at least one reaction k E support(Av). There is
hence no thermodynamic driving force for at least one reaction in
support(Av); consequently, all internal flux distributions are
thermodynamically infeasible.

The following theorem characterizes thermodynamically feasible
flux distributions:

Theorem: A flux distribution vaé 0 that is feasible for (1) is
thermodynamically feasible if, and only if, there does not exist
any internal flux distribution Av 9E 0 with support(Av)Csupport(v)
and AWL/[220 for all k.

Proof: We may assume, without loss of generality, that Uk 9E 0 for
all k. (If not delete the k—th component of v and the k—th column of
S.) We may further assume that Uk > 0 for all k. (If not replace the
k—th component ‘Uk’ by ‘—Uk’ and the k—th column ‘sk’ of S by ‘—sk’.)
Then, by definition, v is thermodynamically feasible, if, and only if,
T G < 0 (i.e. each

there exists a vector of free energies G such that Sim

component of the vector S-T

WG must be negative).

/3.IO'S[EIIm0fp.IOJXO'SOIJEIIIJOJIIIOIq”Zduq

Borwein and

Lewis, 2006

v4—10
ﬂ’ﬁ
‘ﬁn’

V1=1 ' ' v2=—999

 

Sehuster and IIilgetag, 1994

Price

6/ al., 2002

Price (7/ al., 2002

Figure 1

/310'SIBanoprOJxo"sotJBuiJOJutotqﬂ:duq

Schellenberger

et al., 2011
1
1
2
Schellenberger II  
et al., 2011 _-I II-
Table 1
Schellenberger et al. (2011)
Schellenberger et al., 2010
M0 at al.,
2009
Feist et al., 2007
Mo et al., 2009 .
Figure 1
Bordel et al., 2010
Schellenberger et al., 2011)
Figure 2
Feist et al., 2007
Figure 1
Fig. 2 Fig. 2

Fig. 2

/3.IO'S[EIIm0fp.IOJXO'SOIJEIIIJOJIIIOIq”Zduq

and Schilling, 2003

Schilling, 2003

Mahadevan and Schilling, 2003

Figure 1

Mahadevan

Mahadevan and

Figure 1

Figure 1

Feist et al., 2007 Figure 3

Fig. 3
Fig. 3
Fig. 3

/3.IO'S[EIIm0fp.IOJXO'SOIJEIIIJOJIIIOIq”Zduq

2164

A.A.Desouki et al.

 

one reaction not shared with another cycle must be identified as
soon as this unique reaction is considered. However, it is possible to
construct examples where all reactions in one loop are also involved
in other loops; in this case, the corresponding loop might be missed
by our algorithm. The enumeration algorithm is thus only approxi—
mate: we may fail to identify some internal cycles if these share all
their reactions with other internal cycles. On the other hand, we can
be sure that all reactions involved in internal cycles are identified,
and the algorithm is exact in this sense.

We used our algorithm to identify thermodynamically infeasible
cycles in the genome—scale metabolic model for Ecoli (Feist et al.,
2007). The identification of internal cycles in this network took less
than five minutes on a standard laptop (core i7 processor and 8GB
RAM). Excluding trivial cycles involving only two reactions (i.e. for—
ward and backward reactions of the same stoichiometry), we identi—
fied 26 nontrivial thermodynamically infeasible cycles. This is very
close to the number reported by (Wright and Wagner, 2008), 27; as
the detailed results of (Wright and Wagner, 2008) are not available,
we could not examine if the one additional cycle consists entirely of
reactions involved in the other cycles, which would explain why it is
not contained in our results.

Recently, (De Martino et al., 2013) reported a lower bound
of189 nontrivial thermodynamically infeasible loops (22 reactions
each) in the same metabolic network model. 11 of these internal
cycles were also identified by our approach; the remaining 178
cycles violate at least one a priori thermodynamic constraint, i.e. at
least one reaction in the cycle carries flux in a direction not allowed
by the published model (Feist et al., 2007).

3 Conclusions

The CycleFreeFlux algorithm described above, MTF (Holzhiitter,
2004), and ll—FBA (Schellenberger et al., 2011) each put out one
thermodynamically feasible ﬂux distribution. However, these algo—
rithms are not directly comparable, as they differ in both their goals
and their inputs. MTF delivers very special flux distributions, which
minimize the total sum of absolute fluxes )lvlll, constrained only by
the optimal value of the objective function. In contrast, cycleFreeFlux
takes any given steady—state flux distribution (which may or may not
be the result of an FBA calculation) and reduces it to its loopless contri—
bution. Finally, ll—FBA solves an FBA problem such that the resulting
flux distribution already lies in the thermodynamically feasible sub—
space. Given that the MTF flux distribution will often be biologically
more realistic than many alternative solutions to an FBA problem
(Schuetz et al., 2012), MTF (or parsimonious FBA) should be
the method of choice when just one thermodynamically feasible
solution to an FBA problem is required. In contrast, CycleFreeFlux and
ll—COBRA provide means to characterize the full space of thermo—
dynamically feasible (optimal) steady—state solutions. CycleFreeFlux
solutions are biased towards solutions that run in the same direction as
internal cycles with which they overlap and towards solutions with
lower total ﬂux (Mil whenever alternative decompositions into elem—
entary modes exist; in many applications, these biases will not be
important.

The CycleFreeFlux algorithm and its extensions allow the reli—
able identification and exclusion of thermodynamically infeasible in—
ternal cycles. We implemented corresponding functions as an
extension package for sybil (Gelius-Dietrich et al., 2013), an open—
source library for constraint—based analyses in the framework of the
R—project for statistical computing (R Development Core Team
2013). The implemented CycleFreeFlux functions are orders of

magnitude faster than previously available algorithms for the gener—
ation of thermodynamically feasible random flux samples and flux
variability analyses and are freely available from CRAN (http://cran.
r—project.org/web/packages/sybilcycleFreeFluid ).

Acknowledgements

A.A.D. and M.].L. conceived of the project and wrote the manuscript. A.A.D.
carried out the work. G.G.D. participated in the discussions and helped with
the implementation of the sybil extension. FJ. developed the formal proof to
the Theorem.

Funding

We thank Stefan Schuster for helpful discussions. A.A.D. was supported by a
DAAD scholarship. M.].L. was supported by the German Research
Foundation (DFG grants EXC 1028 and CRC 680).

Conﬂict of Interest: none declared.

References

Barve,A. and Wagner,A. (2013) A latent capacity for evolutionary innovation
through exaptation in metabolic systems. Nature, 500, 203—206.

Beard,D.A. et al. (2002) Energy balance for analysis of complex metabolic net-
works. Biophys. ]., 83, 79—86.

Bordel,S. et al. (2010) Sampling the solution space in genome-scale metabolic
networks reveals transcriptional regulation in key enzymes. PLOS Compnt.
Biol, 6, e1000859.

Borwein,]. and Lewis,A. (2006 ) Convex Analysis and Nonlinear Optimization.
2nd edn. CMS Books in Mathematics. Springer, New York, pp. 23—27.

Colijn,C. et al. (2009) Interpreting expression data with metabolic ﬂux mod—
els: predicting Mycobacterium tuberculosis mycolic acid production. PLoS
Compnt. Biol, 5, e1000489.

De Martino,D. et al. (2013) Counting and correcting thermodynamically
infeasible ﬂux cycles in genome-scale metabolic networks. Metabolites, 3,
946—966.

Feist,A.M. et al. (2007) A genome-scale metabolic reconstruction for
Escherichia coli K-12 MG1655 that accounts for 1260 ORFs and thermo-
dynamic information. Mol Syst. Biol, 3, 121.

Gelius-Dietrich,G. et al. (2013) sybil - Efﬁcient constraint-based modelling in
R. BMC Syst. Biol, 7,125.

Holzhu'tter,H.-G. (2004) The principle of flux minimization and its applica-
tion to estimate stationary ﬂuxes in metabolic networks. Federation Eur.
Biochem. Soc. ]., 271, 2905—2922.

Lewis,N. E. et al. (2010) Omic data from evolved E. coli are consistent with
computed optimal growth from genome-scale models. Mol Syst. Biol, 6, 390.

Lewis,N.E. et al. (2012) Constraining the metabolic genotype-phenotype rela-
tionship using a phylogeny of in silico methods. Nat. Rev. Microbiol, 10,
291—305.

Mahadevan,R. and Schilling,C. (2003) The effects of alternate optimal solu-
tions in constraint-based genome-scale metabolic models. Metah. Eng, 5,
264—276.

Mo,M.L. et al. (2009) Connecting extracellular metabolomic measurements
to intracellular flux states in yeast. BMC Syst. Biol, 3, 37.

Orth,].D. et al. (2010) What is ﬂux balance analysis? Nat. Biotechnol, 28,
245—248.

Pal,C. et al. (2005) Adaptive evolution of bacterial metabolic networks by
horizontal gene transfer. Nat. Genet., 37, 1372—1375.

Pal,C. et al. (2006) An integrated View of protein evolution. Nat. Rev. Genet.,
7, 337—348.

Plata,G. et al. (2010) Reconstruction and ﬂux-balance analysis of the
Plasmodinm falciparnm metabolic network. Mol Syst. Biol, 6, 408.

Price,N.D. et al. (2002) Extreme pathways and Kirchhoff’s second law.
Biophys. 1., 83, 2879—2882.

R Development Core Team. (2013) R: A Language and Environment
for Statistical Computing. R Foundation for Statistical Computing, Vienna,
Austria.

ﬁm'sreumol‘piqxo'sopeuuowtotq/ﬁdnq

Efficient removal of loops

2165

 

Schellenberger,]. et al. (2010) BiGG: a Biochemical Genetic and Genomic
knowledgebase of large scale metabolic reconstructions Database. BMC
Bioinformatics, 11, 213.

Schellenberger,]. et al. (2011) Elimination of thermodynamically infeasible
loops in steady-state metabolic models. Biophys. ]., 100, 544—553.

Schilling,C.H. et al. (2000) Theory for the systemic deﬁnition of metabolic
pathways and their use in interpreting metabolic function from a pathway-
oriented perspective. ], Theor, Biol, 203, 229—248.

Schuetz,R. et al. (2012) Multidimensional Optimality of Microbial
Metabolism. Science, 336, 601—604.

Schuster,S. and Hilgetag,C. (1994) On elementary flux modes in biochemical
reaction systems at steady state. ]. Biol Syst., 2, 165—182.

Schuster,S. et al. (2008) Is maximization of molar yield in metabolic networks
favoured by evolution?], Theor, Biol, 252, 497—504.

Wright,]. and Wagner,A. (2008) Exhaustive identiﬁcation of steady state
cycles in large stoichiometric networks. BMC Systems Biol, 2, 61.

/3.IO'S[BIImOfp.IOJXO'SOIIBLUJOJIIIOICV/Idllq

