Bioinformatics, 32110), 2016, 1493—1501
doi:10.1093/bioinformatics/btw018
Advance Access Publication Date: 14 January 2016

 

Original Paper

 

Genetics and population analysis

FINEMAP: efficient variable selection using
summary data from genome-wide association

studies

Christian Benner1'2*, Chris CA. Spencer3, Aki S. Havulinna4,
Veikko Salomaa4, Samuli Ripatti1'2'5 and Matti Pirinen1*

1Institute for Molecular Medicine Finland (FIMM), University of Helsinki, Helsinki, Finland, 2Department of Public
Health, University of Helsinki, Helsinki, Finland, 3Wellcome Trust Centre for Human Genetics, University of Oxford,
Oxford, UK, 4National Institute for Health and Welfare (THL), Helsinki, Finland and 5Wellcome Trust Sanger

Institute, Wellcome Genome Campus, Hinxton, UK

*To whom correspondence should be addressed.
Associate Editor: Oliver Stegle

Received on 22 September 2015; revised on 11 December 2015; accepted on 7 January 2016

Abstract

Motivation: The goal of fine—mapping in genomic regions associated with complex diseases and
traits is to identify causal variants that point to molecular mechanisms behind the associations.
Recent fine—mapping methods using summary data from genome—wide association studies rely on
exhaustive search through all possible causal configurations, which is computationally expensive.

Results: We introduce FINEMAP, a software package to efficiently explore a set 0fthe most import—
ant causal configurations of the region via a shotgun stochastic search algorithm. We show that
FINEMAP produces accurate results in a fraction of processing time of existing approaches and is
therefore a promising tool for analyzing growing amounts of data produced in genome—wide asso—

ciation studies and emerging sequencing projects.

Availability and implementation: FINEMAP v1.0 is freely available for Mac OS X and Linux at

http://www.ch ristia nben ner.com.

Contact: christian.benner@helsinki.fi 0r matti.pirinen@helsinki.fi

 

1 Introduction

Genome-Wide Association Studies (GWAS) have identified thou-
sands of genomic regions associated with complex diseases and
traits. Any associated region may contain thousands of genetic vari-
ants with complex correlation structure. Therefore, one of the next
challenges is fine-mapping that aims to pinpoint individual variants
and genes that have a direct effect on the trait. This step is crucial
for fully exploiting the potential of GWAS: to unveil molecular biol-
ogy of complex traits and, eventually, provide targets for therapeutic
interventions. For a recent review on fine-mapping, see Spain and
Barrett (2015).

A standard approach for refining association signals is a step-
wise conditional analysis, an iterative procedure that conditions
on the Single-Nucleotide Polymorphisms (SNPs) with the lowest

(63 The Author 2016. Published by Oxford University Press.

P-value of association until no additional SNP reaches the pre-as-
signed P-value threshold. While conditional analysis is informative
about the number of complementary sources of association signals
within the region, it fails to provide probabilistic measures of causal-
ity for individual variants. To overcome this problem, many recent
fine-mapping methods have adopted a Bayesian framework.
Approaches for Bayesian analysis of multi-SNP GWAS data in-
clude exhaustive search as implemented in software BIMBAM
(Servin and Stephens, 2007), MCMC algorithms (Guan and
Stephens, 2011), variational approximations (Carbonetto and
Stephens, 2012) and stochastic search as implemented in software
GUESS (Bottolo and Richardson, 2010, Bottolo et (11., 2013) and
GUESSFM (Wallace et (11., 2015). Bayesian fine-mapping has also
been conducted under a simplified assumption of a single causal

1493

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

VTCCC cl (1]., 2012

\Wood r?! (11., 2014

Kichacv r?! (11.,
2014 Kichacv and Pasaniuc, 2015 llorniozdiari r?! (11.,
2014 Chen 8101., 2015

Chen 8101., 2015

Hans cl (1]., 2007

Chen 8101., 2015

Borodulin cl (1]., 2015
UKPDC and \VTCCCZ, 2011

Yang r?! (11., 2011

Pirincn r?! (11., 2013

unnnnnnnnn
nanmnnnmnn
nammammaam

/810'sreum0[p103x0"sotJBuIJOJutotqﬂ:duq

FINEMAP

1495

 

that with 95% probability the effect of a causal SNP on the odds—
ratio scale is less than 1.15 for common variants (MAF : 0.5) and
less than 2.0 for low—frequency variants (MAF : 0.01), where MAF
is the minor allele frequency. Robustness to the values of 5,: has been
studied previously by Chen et al. (2015).

To define the prior for each causal configuration, we use a gen—
eral discrete distribution for the number of causal SNPs

pk :Pr(ll of causal SNPs is k), k : 1,...,K,

where K << m is the maximum number of SNPs in the causal config—
uration. Note that we assume that the region to be fine—mapped in—
cludes at least one causal SNP, i.e. p0 : 0. For a fixed value of k, we
assume the same probability for each configuration with k causal
SNPS. Thus, a priori,

17(7) —Pk/<m> when it” : k.
k (:1

PAINTOR does not use an explicit prior on k but restricts k S 3
in practice. The default prior used by CAVIARBF builds on that of
CAVIAR and assumes that each SNP is causal with probability 1 /m
and that k S 5. This is a special case of our prior when we set

i m 1 k m _ 1 m—k
Pk — k m m
and renormalize for K : 5 except that CAVIARBF assigns non—zero
prior also for the null configuration k : 0.

2.3 Marginal likelihood for y
We now show how the marginal likelihood for the causal configur—
ation y can be computed efficiently.

2.3.1 Integrating out causal effects A
The likelihood function p(yl}.,X) of the causal SNP effects is (pro—
portional to) a Normal density N(2l}.,az(nR)_1). This enables an
analytic solution for the marginal likelihood of y eliminating the
causal effects
pow) : jpryvxwmu

I N010) 0201104 + 51024))

: N(210,R + R2,,R),
where we defined 2,, E 115221.). Importantly, an evaluation of the
marginal likelihood requires only single—SNP z—scores and SNP cor—
relations from a reference panel and does not depend on 02. This
elimination of A is similar to the one used by CAVIAR and
CAVIARBF and differs from PAINTOR that fixes those values
based on the observed z—scores. Next, we describe two implementa—
tions to evaluate N (£10,R+RE,,R) with high computational
efficiency.

2.3.2 Reducing the complexity from 0(m3) to 0(k3)
Option 1. Let C: {1,...,k} and N : {k + 1,...,m} be respect—
ively the set of causal and non—causal SNPs. Consider the quadratic

form
Q : 2T(R + Ram—12 : 2TH... + spa-1a

inside the exponential function in N(£)0,R+RE,,R), where
a:R_1£ can be precomputed. We solve the linear system

(Im + E,,R)b : a for b by observing that the m — k elements in b
corresponding to non—causal SNPs (W : 0) are by : 11g and the re—
maining elements result from solving a system of k equations

(112 + "SERCCﬂ’C 2 ac — "SERCNaNa

where RCC is the k X k correlation matrix of the causal SNPs and
RCN the k X (m — k) submatrix of R corresponding to the correl—
ations between the causal and non—causal SNPs. In addition, we ob—
serve that det(Im + ER) is simply det(I;z + nngcc) after expanding
with respect to the rows corresponding to non—causal SNPs.
Computationally, these computations require one Cholesky decom—
position with complexity 0(k3) and provide thus a considerable sav—
ing compared to the naive way of decomposing the whole m X m
matrix with complexity 0(m3).

This derivation differs from the one used by CAVIARBF that is
similar to our option 2 below. It also differs from PAINTOR that
fixes 1. based on the observed z—scores and performs once a Cholesky
decomposition of the whole m X m SNP correlation matrix that is
used repeatedly in each likelihood evaluation. Note that option 1
cannot be used in case of collinearity among the SNPs, because the
correlation matrix R is not invertible if two SNPs are perfectly corre—
lated and is unstable with nearly perfectly correlated SNPs.

Option 2. We partition the observed z—scores into components 2c
and 2N and permute rows and columns of the SNP correlation ma—
trix and covariance matrix E), such that

and Z), : diag{oy} with 0H1 : - - - : am : 0. This partitioning en—
tails a block structure in the covariance matrix of N(2)0, R + R2,,R)

23.0.91 599.299.13.619.j._1391Y_t_!‘_99§9€_1391Y_]
RNC + RNCECC R00  RNN + RNCZ'CC RCN

Using properties of the multivariate Normal distribution, the condi—
tional expectation and covariance matrix of 2N given 2c are readily
available
A A _1 A
lEllezc] : RNCRCCzc

verlzci : RNN — RNcREéRcN

and do not depend on 2),. We rewrite the marginal likelihood
p(yly,X) :N(2)0,R+RZ,,R) in terms of the marginal distribution
of 2c and conditional distribution of 2N given ac to obtain the fol—
lowing expression

N(2)0, R + REVR) : A/(éclo7 Rcc + RCCECCRCC) ><
N<leEl2Nl2Cl7Vlle2Cl)

N(£lO,R)

: A R R E R —
N(zc107 cc+ cc cc CC)XN(2C‘07RCC)

This means that we can compute the Bayes factor for assessing the
evidence against the null model by using only the causal SNPs

N(210.R +R2,,R)
N (210.1%)

2 W
A/(éclo7 Rcc)

Em : NULL) 2

and that the marginal likelihood is proportional to this expression.
CAVIARBF utilizes this result, although without a mathematical

ﬁm'sreumol‘pquo'sopcuuowtotq/ﬁdnq

Fig.

Chen (7/ 11/. (2015

1111115 (7/ ML, 2007

In Score

an Score
 Score
E Score
nu Score
Score

v  Score

V  Score

an Score
V E Score
v E Score
v Score

/310'S[BIIJHO[pJOJXO'SOTJBLUJOJIITth/ﬂduq

5111‘11l\'l\'11el.r/., 2015

Boi‘odulin e! 11/., 2015

UKPDC 11nd WTCCCL 2011

Lu

Figure

Table 1

Figure 4

D/D/A/a

A FINEMAP (K=5)
0 FINEMAP (K=3)

n CAVIARBF (K = 3)

AI/A_——Ar——A
o—/’O———O———O

 

o FINEMAP (m = 150)
1:1 CAVIARBF (m = 150)

 

/310'S[BIIJHO[pJOJXO'SOTJBLUJOJIITth/ﬂduq

o Causal

o Non—causal

A Difference between
single—SNP inclusion
probabilities

UKPDC 11nd \V’TCCCZ,

 

 

Figure 6

Surakka e! 11/., 2015

e! 11/., 2015
UKPDC 11nd \V’TCCCZ (2011)

Figure 7
Durstenfeld e! 11/., 1994

2011 Deer 11nd Peng, 2000

FINEMAP (K : 5)
FINEMAP (K : 3)
CAVIARBF (K : 3)
OPTIMAL

llolmen e! 11/., 2014

Borod ulin

/310'S[BHJHO[pJOJXO'SOTJBLUJOJIITth/ﬂduq

FINEMAP

0.032
0.036
0.093
0.113
0.132

rs356220 Q

rs7687945

| rs356220, rs1899389
| rs356220, rs1372522
- rs356220

- rs356220, rs2301134
|:| rs356220, 7687945

FINEMAP rs113298164

rs7350789

190x higher likelihood
than 3-SNP configuration

r51800588 from conditional analysis

0 8
O O
rs2043085 O

3-SNP configuration
from conditional
analysis

twin
«(0‘ \Jxv

I rs7350789,rs8033940,rs1 13298164

I rs7350789,rs17240869,rs1800588,rs1 13298
I 7350789,rs261334,rs1 13298164

- 350789,rs2070895,rs1 13298164
- rs7350789,rs1800588,rs113298164

 

1111115 e/ 11/., 2007
Andrieu e/ 11/. (2003

Hastings, 1970 bdetropolis e/ 11/., 1953
(101111111 11nd (101111111, 1984

/3.10's112u.1n0[p.10}x0"sotwuuogutotqﬂ:duq

1500

C.Benner et al.

 

FINEMAP is accurate when the set of causal configurations
explored captures a large majority of the total posterior probability.
Our results show that this is the case in all datasets we have tested:
the maximal error in any single—SNP inclusion probability is smaller
than 0.11 across all 2000 datasets of Scenario B. Using exhaustive
search, we observed in genomic regions with 750 SNPs of which five
were truly causal that on average only the top 123 (median : 14)
causal configurations out of all possible 70.3 X 106 already cover
95% of the total posterior probability. (Similar results were also
observed for genomic regions with different numbers of SNPs.) This
explains why an efficient stochastic search can achieve accurate re—
sults in a tiny fraction of the processing time of an exhaustive search.
Our datasets were generated by requiring that the causal SNPs had
highly correlated proxies (absolute correlation greater than 0.5)
among the other variants. The high accuracy of FINEMAP through—
out these tests makes us believe that FINEMAP is accurate in typical
GWAS data with complex correlation structure among the SNPs.

Although we have not encountered any dataset where FINEMAP
would not have performed well, theoretically, it remains possible
that an in—exhaustive search could miss some relevant causal config—
urations. A simple way to assess possible problems is to run many
searches in parallel and compare and combine their outcomes.
Another way is parallel tempering (Geyer, 1991) where several
searches are run in parallel in different ‘temperatures’. Intuitively,
increasing temperature flattens the likelihood function and hence a
search in a higher temperature moves around more freely than one
in a colder temperature. Such an approach, together with complex
global transition mechanisms to escape from local modes, was intro—
duced in an evolutionary stochastic search algorithm by Bottolo and
Richardson (2010) that was later tailored for genetic analyses of
multiple SNPs and multivariate phenotypes in the software package
GUESS (Bottolo et al., 2013). These two papers could give ideas
how FINEMAP could be further modified if trapping into local
modes of the search space were encountered in real data analyses of
GWAS regions.

Summary data based fine—mapping methods require a high—
quality correlation estimate. Ideally, the correlation matrix is com—
puted from the same genotype data from which the z—scores origin—
ate. In that case, for quantitative traits, the equations in Section 2.1
connecting original genotype—phenotype data and GWAS summary
data are exact and hence no information is lost by working with
summary data. For case—control data, a normal approximation to
the logistic likelihood causes some difference between the two
approaches but the difference is expected to be small with current
GWAS sample sizes (Pirinen et al., 2013). For some populations,
sequencing of many thousands of individuals have either already
been carried out or will complete soon. Such reference data allow re—
liable fine—mapping down to low—frequency variants also when the
original genotype data are not available. A more challenging prob—
lem is large meta—analyses that combine individuals from varying
ancestries. Assuming that the causal variants are included in the
data and have the same effect sizes across the ancestral backgrounds,
FINEMAP can be run with the sample size weighted SNP correl—
ation matrix. If these assumptions are not met, then a hierarchical
model allowing separate SNP correlation structures in each ancestry
would perform better (Kichaev and Pasaniuc, 2015 ).

Summary data based fine—mapping methods assume that the
causal variants are included in the data. Recent advances in z—score
imputation (Lee et al., 2013; Pasaniuc et al., 2014) help to satisfy
this requirement also when a causal variant might not be genotyped.
However, some SNPs are difficult to impute because they are not
tagged well by the SNPs in the data. We do not expect to capture

well the association signal from such SNPs either through imput—
ation or indirectly through other SNPs in the data.

The output from FINEMAP is a list of possible causal configur—
ations together with their posterior probabilities and Bayes factors
similar to CAVIARBF. These probabilities contain all the informa—
tion from the model needed for downstream analyses. Examples of
useful derived quantities are the single—SNP inclusion probabilities,
single—SNP Bayes factors, credible sets of causal variants (WTCCC
et al., 2012) and a regional Bayes factor to assess the evidence
against the null model where none of the SNPs are causal (Chen
et al., 2015). We believe that FINEMAP, or related future applica—
tions of shotgun stochastic search to GWAS summary data, enables
unprecedented opportunities to reveal valuable information that
could otherwise remain undetected due to computational limitations
of the existing fine—mapping methods.

Acknowledgements

This study makes use of GWA data generated by the Wellcome Trust Case-
Control Consortium 2 (WTCCC2) on UK PD cases and on UK controls from
the 1958 Birth Cohort (58BC) and National Blood Service (NBS). We thank
the participants of the FINRISK cohort and its funders: the National Institute
for Health and Welfare, the Academy of Finland [139635 to Veikko Salomaa]
and the Finnish Foundation for Cardiovascular Research. We also wish to ac-
knowledge CSC — IT Centre for Science, Finland for computational resources.

Funding

This work was ﬁnancially supported by the Doctoral Programme in
Population Health (C.B.), the Academy of Finland [257654 and 288509 to
M.P.; 251217 and 255847 to S.R.] and a Wellcome Trust Career
Development Fellowship to C.C.A.S [097364/Z/11/Z]. S.R. was further sup-
ported by the Academy of Finland Center of Excellence for Complex Disease
Genetics, EU FP7 projects ENGAGE (201413), BiOSHaRE (261433), the
Finnish Foundation for Cardiovascular Research, Biocentrum Helsinki and
the Sigrid Jusélius Foundation.

Conﬂict of Interest: C.C.A.S. is a founder and shareholder of GENOMICS
plc, a company that develops genome analytics.

References

Andrieu,C. et al. (2003) An introduction to MCMC for machine learning.
Mach. Learn., 50, 5—43.

B0tt010,L. and Richardson,S. (2010) Evolutionary stochastic search for
Bayesian model exploration. Bayesian Anal, 3, 583—618.

B0tt010,L. et al. (2013) GUESS-ing polygenic associations with multiple
phenotypes using a GPU-based evolutionary stochastic search algorithm.
PLOS Genet., 9, e1003657.

Borodulin,K. et al. (2015) Forty-year trends in cardiovascular risk factors in
Finland. Eur.  Public Health, 25, 539—546.

Carbonetto,P. and Stephens,M. (2012) Scalable variational inference for
Bayesian variable selection in regression, and its accuracy in genetic associ-
ation studies. Bayesian Anal, 1, 73—108.

Chen,W. et al. (2015) Fine mapping causal variants with an approximate
Bayesian method using marginal test statistics. Genetics, 200, 719—736.

Deeb,S. and Peng,R. (2000) The C-514T polymorphism in the human hepatic
lipase gene promoter diminishes its activity.]. Lipid Res., 41, 155—158.

Durstenfeld,A. et al. (1994) Molecular characterization of human hepatic lip-
ase deﬁciency. in Vitro expression of two naturally occurring mutations.
Arterioscler. Thromb., 14, 381—385.

Geman,S. and Geman,D. (1984) Stochastic relaxation, Gibbs distributions,
and the Bayesian restoration of images. IEEE Trans. Pattern Anal. Mach.
Intell., 6, 721—741.

ﬁm'sreumol‘prqxo'soptzuuonnorq/ﬁdnq

FINEMAP

1501

 

Geyer, C.]. (1991) Computing science and statistics. In: Proceedings of the
23rd Symposium on the Interface, pp. 156—163.

Guan,Y. and Stephens,M. (2011) Bayesian variable selection regression for
genome-wide association studies and other large—scale problems. Ann. Appl.
Stat., 5,1780—1815.

Hans,D. et al. (2007) Shotgun stochastic search for “large p” regression.
]. Am. Stat. Assoc., 102, 507—516.

Hastings,W. (1970) Monte Carlo sampling methods using Markov chains and
their applications. Biometrilza, 57, 97—109.

Holmen,O.L. et al. (2014) Systematic evaluation of coding variation identiﬁes
a candidate causal variant in TM6SF2 inﬂuencing total cholesterol and myo-
cardial infarction risk. Nat. Genet., 46, 345—351.

Hormozdiari,F. et al. (2014) Identifying causal variants at loci with multiple
signals of association. Genetics, 198, 497—508.

Kichaev,G. et al. (2014) Integrating functional data to prioritize causal vari-
ants in statistical ﬁne mapping studies. PLOS Genet., 10, e1004722.

Kichaev,G. and Pasaniuc,B. (2015) Leveraging functional-annotation data in
trans-ethnic ﬁne-mapping studies. Am. Hum. Genet., 97, 260—271.

Lee,D. et al. (2013) DIST: direct imputation of summary statistics for unmeas-
ured SNPs. Bioinformatics, 29, 2925—2927.

Metropolis,N. et al. (1953) Equations of state calculations by fast computing
machines]. Chem. Phys., 21, 1087—1092.

Pasaniuc,B. et al. (2014) Fast and accurate imputation of summary statistics en—
hances evidence of functional enrichment. Bioinformatics, 30, 2906—2914.

Pirinen,M. et al. (2013) Efﬁcient computation with a linear mixed model on
large-scale data sets with applications to genetic studies. Ann. Appl. Stat., 7,
369—390.

Servin,B. and Stephens,M. (2007) Imputation-based analysis of associ-
ation studies: candidate regions and quantitative traits. PLoS Genet., 3,
e1 14.

Spain,S. and Barrett,]. (2015) Strategies for ﬁne mapping complex traits.
Hum. Mol. Genet., 42,1001—1006.

Surakka,I. et al. (2015) The impact of low-frequency and rare variants on lipid
levels. Nat. Genet., 47, 589—597.

The UK Parkinson’s Disease Consortium and The Wellcome Trust Case
Control Consortium 2. (2011) Dissection of the genetics of Parkinson’s dis-
ease identiﬁes an additional association 5’ of SNCA and multiple associated
haplotypes at 17q21. Hum. Mol. Genet.,20, 345—353.

Wallace,C. et al. (2015) Dissection of a complex disease susceptibility region
using a Bayesian stochastic search approach to ﬁne mapping. PLoS Genet.,
11, e1005272.

Wellcome Trust Case Control Consortium. et al. (2012) Bayesian reﬁnement
of association signals for 14 loci in 3 common diseases. Nat. Genet., 44,
1294—1301.

Wood,A. et al. (2014) Deﬁning the role of common variation in the genomic and
biological architecture of adult human height. Nat. Genet., 46, 1173—1186.
Yang,]. et al. (2011) GCTA: a tool for genome-wide complex trait analysis.

Am. ]. Hum. Genet., 88, 76—82.

ﬁm'sreumol‘prqxo'soptzuuonnorq/ﬁdnq

