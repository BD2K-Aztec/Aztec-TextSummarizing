Vol. 27 no. 16 2011, pages 2304-2305
APPS N O  doi:10.1093/bioinformatics/btr341

 

Genetics and population analysis

Advance Access publication June 8, 2011

HAPGEN2: simulation of multiple disease SNPs

Zhan Su1’*, Jonathan Marchinila‘Z’Jr and Peter Donnellylazair
1Welloome Trust Centre for Human Genetics, Oxford OX3 7BN and 2Department of Statistics, University of Oxford,

Oxford OX1 STG, UK

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Performing experiments with simulated data is
an inexpensive approach to evaluating competing experimental
designs and analysis methods in genome-wide association studies.
Simulation based on resampling known haplotypes is fast and
efficient and can produce samples with patterns of linkage
disequilibrium (LD), which mimic those in real data. However, the
inability of current methods to simulate multiple nearby disease SNPs
on the same chromosome can limit their application.

Results: We introduce a new simulation algorithm based on a
successful resampling method, HAPGEN, that can simulate multiple
nearby disease SNPs on the same chromosome. The new method,
HAPGEN2, retains many advantages of resampling methods and
expands the range of disease models that current simulators offer.
Availability: HAPGEN2 is freely available from
http://www.stats.ox.ac.uk/~marchini/software/gwas/gwashtml.
Contact: zhan@well.ox.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 31, 2011; revised on May 22, 2011; accepted on
May 24, 2011

1 INTRODUCTION

Genome-wide association studies have become a powerful approach
for uncovering the genetic variants that impact human phenotypes.
Simulation studies are a popular and inexpensive approach to
evaluate new methods for statistical analysis (Su et al., 2009) and to
examine the power of different experimental designs (Spencer et al.,
2009).

The traditional approach of simulating a population forwards
(Lambert, 2008) or backwards (Hudson, 2002) in time ignore
the large amount of observed genetic data that are available,
can be computationally intensive and can struggle to match real
LD patterns. To overcome these problems, Spencer et al. (2009)
introduced a novel simulation approach, HAPGEN, which uses
an alternative resampling approach. Given a reference panel of
haplotypes, this method produces a sample of haplotypes with
patterns of LD similar to those in the reference panel. Using the
HapMap3 and 1000G haplotype data as reference panels, HAPGEN
is able to simulate data for many populations. In addition, it is fast
and can simulate a single disease SNP under a general disease model,
allowing the user to specify the risk allele and heterozygote and

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion. the last two authors
should be regarded as joint Last Authors.

homozygote relative risks. Other resampling methods also exist (Li
and Li, 2008; Wright et al., 2007), but they and HAPGEN can only
simulate a single disease SNP on the same haplotype. There are
many complex diseases with multiple-associated loci on the same
Chromosome, some of them in Close proximity (e.g. Strange et al.,
2010), so the ability to simulate multiple disease SNPs on the same
Chromosome would be desirable. To address this issue, we have
devised a new approach, extending HAPGEN, to simulate multiple
nearby disease SNPs on the same Chromosome.

2 METHODS

The HAPGEN2 simulation approach is similar to that of HAPGEN and is
based on the Li and Stephens (LS) model (Li and Stephens. 2003) of LD.
Brieﬂy. given a reference panel of haplotypes. HR={h1,...,h,} as input.
where each haplotype is typed at L biallelic sites. that is h, 2 (110,1), ...,h(i,L))
and kW) 6 {0, l}. the LS model models each newly simulated haplotype as
an imperfect mosiac of the haplotypes in HR and the haplotypes that have
already been simulated (see below for more details). Simulation of case7
control data is based on a set of disease SNPs. D: {dk :51), e {l,...,L},k=
l,...,K} with effect sizes and RR: {(rrlg ,rr§)}. where rrlg and rrlg are the
disease risks of carrying one and two copies of the 1 allele relative to carrying
two copies of the 0 allele at dk. which combine multiplicatively across the K
disease SNPs. The haplotypes. HP 2 {h,+1, . . . , hp}. for the control individuals
are simulated ﬁrst. followed by the haplotypes. HQ 2 {h],+1, ...,h,,}. for the
case individuals.

2.1 Simulating control data

We simulate the control data as population controls (so that some of them may
be cases) and simulate each additional haplotype. hi+1 EHP. sequentially
under the LS model. We use the copying states. z(,»+1,j)e{l,...,i}. which
evolve in a Markov manner. to indicate the haplotype that h<i+1,j) copies at
site j. We simulate each haplotype in three stages. First. the cross-over events.
which are locations where z(i+ 1, j) #z(i+1,j_1). are simulated according to the
transition probabilities

(l—exp(—"—f>>
P(Z(i+1,j) =Z|Z<i+1,j—1))= 

wax—$1.. (1)

where I2 is 1 if z=z(,»+1,j_1) and 0 otherwise. and p]- is genetic distance
between SNPs (j— l) and j. Conceptually. the cross-over events mimicks
the effect of recombination and breaks up hi+1 into independent segments.
{h(i+1,51),...,h(i+1,5n)}. where each segment is a haplotype of SNPs between
two cross-over events. Second. the copying state for each segment is
sampled uniformly from {1, . . . , i }. Finally. the allele at each SNP is simulated
conditional on the copying state and a mutation parameter ui:

[7(h(i+l,j) = h(z,j)lZ(i+l,j)=Z)=1— MI: (2)

Spencer et al. (2009) found that u, where 6:  simulated

_ 6

— 201—6) ’ :11 n
amounts of novel haplotype variation similar to data simulated under the
coalescent model.

 

2304 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq mot} popeolumoq

9103 ‘Og anﬁnv uo ::

HAPGEN2

 

2.2 Simulating case data
We simulate the case haplotypes in a similar way. but we simulate them
sequentially in pairs (with each pair corresponding to a case individual) and
oversarnple haplotypes carrying the risk alleles based on the relative risks.
Simulation of each haplotype pair. (hi+1,hi+2)eHQ. proceeds in four
stages. First. the cross-over events are simulated in the same way as for
the controls. according to (1). Second. the alleles at the disease SNPs are
simulated. Let (h1 ,hg) be the subset of (11H. 1,151.2) that consist of the
alleles at the disease SNPs. so that Wb=(h(i+jgdl),...,h(i+j,dk)) forj: 1,2.
The cross-over events separate hi) and h?) into segments. {h:i,...,h‘:1 }
. "I

and mfg,”th2 }. We simulate (h1 1%) from its joint distribution. which
i 1 

is calculated from the relative risks and the marginal frequencies of each
segment in HP and H R . using Bayes Theorem:

p((hb,h12))|case) oc p(case|(hg,hg))*p(hg,hg)
K

= HP(Cﬂse|gdk)*l7(hi))*P(hi))
k2]

K n1 n2
3
cx (11w)*nmwnmha.
k:l i:l ' j:l ’

where gdk 211112,}: +1112“: is the genotype at dk. and 1701,.) is the frequency of
the haplotype segment h, in HR and HP. Third. the copying state for each
segment. 110+”). is simulated independently and is drawn uniformly from
{1,...,t'}. like we do for the controls. if s does not include any disease SNPs;

or else it is drawn from

0—41 > .
P(Z<i+1,j>=z)0< l—l M<i+1>k *(1-M<i+1>)["k VJESi

dkttt'kES
where Idk is 1 if h<i+1,dk) =h(z,dk) and 0 otherwise. Finally. each allele for
110+”) is simulated according to (2). Copying states and alleles for hi+2 are
simulated in the same way.

3 RESULTS

To demonstrate HAPGEN2, we have simulated, using HapMap2
CEU as the reference panel, 2000 cases and 2000 controls at
880 SNPs across a 700 kb region on chromosome 21, with 3
disease SNPs, at positions d1 :25 356790, d2 =25 390071 and
d3=25 691378, each under a log-additive disease model with a
heterozygote relative risk of 1.3. The simulation process took <10 s
on a 2.93 GHz processor laptop, and will increase linearly with the
number of SNPs and individuals.

Figure 1, produced by HAPLOVIEW (Barrett et al., 2005), shows
the similarity between the LD patterns of the reference panel (top)
and the simulated haplotypes (bottom). The top plot in Figure 2
shows the —log10(P-values), for the log-additive test, across the
region, illustrating the signal of association at the disease SNPs;
subsequent plots show the P-values conditioned on the genotypes at
d1, at d1 and d2 and at d1, d2 and d3, respectively, conﬁrming that
there are indeed three independent disease SNPs.

4 DISCUSSION

We have introduced a new resampling method that can simulate
multiple disease SNPs on the same haplotype, which will be
particularly useful for investigating disease models involving
multiple disease SNPs within close proximity. HAPGEN2
is fast, simple to use and available as a C++ package from
http://www.stats.ox.ac.uk/~marchini/software/gwas/gwas.html,
along with instructions and supporting resources, such as
recombination rates, HapMap and 1000G reference panels.

 

Fig. 1. LD patterns. in terms of r2. in the HapMap reference haplotypes
(top) and the simulated haplotypes (bottom).

10

 

was

 

 

usmqswos

253 254 255 256 57 56

Fig. 2. Top plot shows the —logm(P-values) under the log-additive test at
each SNP in the simulated data. The location of the disease SNPs. d1. d2.
d3. are indicated (from left to right) by the vertical lines. Subsequent plots
(from the top) show the P-values conditioned on the genotypes at [1']. at [1’1
and d; and at d1. d; and d3.

The model described here can be easily extended to simulate
interacting disease SNPs (we currently provide an R package that
does this) and admixture (using reference panels from multiple
populations), which we hope to implement in the future.

Funding: Wellcome Trust grants 084575/Z/08/Zand075491/Z/04/B.
PD was supported in part by a Wolfson Royal Society Merit
Award.J.M. was supported by United Kingdom Medical Research
Council grant number G0801823.

Conﬂict oflnterest: none declared.

REFERENCES

Barrett,J.C. et al. (2005) Haploview: analysis and visualization of LD and haplotype
maps. Bioinformatics, 21, 2637265.

Hudson,R.R. (2002) Generating samples under a Wright-Fisher neutral model.
Bioinformatics, 18, 3377338.

Lambert,B.W. et al. (2008) ForSim: a tool for exploring the genetic architecture of
complex traits with controlled truth. Bioinformatics, 24, 182171822.

Li,C. and Li,M. (2008) GWAsimulator: a rapid whole-genome simulation program.
Bioinformatics, 24, 1407142.

Li,N. and Stephens,M. (2003) Modeling linkage disequilibrium and identifying
recombination hotspots using single-nucleotide polymorphism data. Genetics, 165,
21372233.

Spencer,C.C.A. et al. (2009) Designing genome-wide association studies: sample size,
power, imputation, and the choice of genotyping chip. PLOS Genet, 5, 61000477.

Strange,A. et al. (2010) A genome-wide association study identiﬁes new psoriasis
susceptibility loci and an interaction between HLA-C and ERAPl. Nat. Genet,
42, 9857990.

Su,Z. et al. (2009) A Bayesian method for detecting and characterizing allelic
heterogeneity and boosting signals in genome-wide association studies. Stat. SOL,
24, 430450.

Wright,F.A. et al. (2007) Simulating association studies: a data-based resampling
method for candidate regions or whole genome scans. Bioinformatics, 23,
258172588.

 

2305

112 /3.Io's[Burno[pJOJXO'soueurJOJutotqﬂ:duq uror} popcorn/hog

9103 ‘Og isnﬁnv uo ::

