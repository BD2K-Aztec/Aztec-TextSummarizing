Bioinformatics, 31(10), 2015, 1674—1676

doi: 10.1093/bioinformatics/btv033

Advance Access Publication Date: 20 January 2015
Applications Note

 

Sequence analysis

MEGAHIT: an ultra-fast single-node solution for
large and complex metagenomics assembly
via succinct de Bruijn graph

Dinghua Li1'T,Chi-Man Liu2'1,Ruibang Luoz'T, Kunihiko Sadakane3 and
Tak-Wah Lam1'2'*

1HKU-BGI Bioinformatics Algorithms Research Laboratory & Department of Computer Science, University of Hong
Kong, Hong Kong, 2L3 Bioinformatics Limited, Hong Kong and 3National Institute of Informatics, Chiyoda-ku, Tokyo,
Japan

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first three authors should be regarded as Joint First Authors.
Associate Editor: Inanc Birol

Received on September 25, 2014; revised on December 17, 2014; accepted on January 14, 2015

Abstract

Summary: MEGAHIT is a NGS de novo assembler for assembling large and complex metagenomics
data in a time— and cost—efficient manner. It finished assembling a soil metagenomics dataset with
252 Gbps in 44.1 and 99.6h on a single computing node with and without a graphics processing unit,
respectively. MEGAHIT assembles the data as a whole, i.e. no pre—processing like partitioning and
normalization was needed. When compared with previous methods on assembling the soil data,
MEGAHIT generated a three—time larger assembly, with longer contig N50 and average contig length;
furthermore, 55.8% 0fthe reads were aligned to the assembly, giving a fourfold improvement.

Availability and implementation: The source code of MEGAHIT is freely available at https://github.

 

com/voutcn/megahit under GPLV3 license.
Contact: rb@l3—bi0inf0.com 0r twlam@cs.hku.hk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Next generation sequencing technologies have offered new opportu-
nities to study metagenomics and understand various microbial
communities such as human guts, runien and soil. Due to the lack of
reference genomes, (16 1101/0 assembly of metagenomics data (short
reads) is a beneficial and almost inevitable step for metagenomics
analysis (Qin et (11., 2010). This step is, however, constrained by the
heavy requirement of computational resources, especially for large
and complex datasets encountered in environmental metagenomics
(Howe et (11., 2014). The soil metagenomics dataset recently pub-
lished by Howe et al. comprises 252 Gbp even after trimming low
quality bases. The dataset was successfully assembled with pre-
processing steps including partitioning and digital normalization. At
present no (16 1101/0 assembler can assemble the data as a whole using
a feasible amount of computer memory. Estimated memory

requirement for SOAPdenovoZ (Luo et (11., 2012) and IDBA-UD
(Peng et (11., 2012) to assemble the soil data is at least 4 TB. As the
volume of metagenomics data keeps growing, we are motivated to
develop MEGAHIT, an assembler that can assemble large and con]-
plex metagenomics data in a tinie- and cost-efficient manner, espe-
cially on a single-node server (current maximum memory capacity
768 GB for a 2-socket server).

2 Methods

MEGAHIT makes use of succinct dc Bruijn graphs (SdBG; Bowe
et (11., 2012), which are compressed representation of de Bruijn
graphs. A SdBG encodes a graph with m edges in ()(m) bits, and
supports 0(1) time traversal from a vertex to its neighbors. Our ini-
plementation has added a bit-vector of length m to mark the validity

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1674

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

input reads R

count fl?" +1l-n‘IF-r

11
output solid & mere edges

 

Peng (7/ LIL, 2012

Liu (7/ LIL, 2014

Table 1
Bankmich (7/ LIL, 2012

2013

2014
(lhikhi and Rizk, 2012

Figure 1

(iui‘e\ ich (7/ LIL,

Table 2

Table 1

llowe (7/ LIL,

/310'S[BHJnOl-pJOJXO'SOtJBLUJOJIItth/ﬂdnq

1676

D.Li et al.

 

Table 3. Alignment statistics of MEGAHIT, Howe et al. and Minia

 

 

MEGAHIT Howe et al. Minia
Total # of reads 3 252 369 195
Reads overall aligned (%) 55.81 10.72 13.03
Total # of SE reads 356 742 333
SE aligned 1 time (%) 37.00 8.72 12.38
SE aligned > 1 time (%) 14.68 0.32 0.02
Total # of PE reads 1 447 813 431
PE p. aligned 1 time (%) 36.78 7.41 9.48
PE p. aligned > 1 time (%) 8.90 0.20 0.01
PE improperly aligned (%) 2.67 0.54 0.82

 

SE, single-end; PE, paired-end; p., properly; Bowtie2 were run with ‘-L 27’.

can assemble this dataset with as little as 260GB memory, using
55.3 h (Supplementary Section 4).

To be consistent with Howe’s analysis, we only considered
contigs 2 300 bp for further analysis. The contigs produced by
MEGAHIT had a total size at least three times larger than by other
methods, and achieved better statistics on N5 0, average length, and
the number of long contigs (length 2 1000 bp). Thus MEGAHIT
gives better assembly contiguity. Raw reads were aligned back to the
assembled contigs using Bowtie2 (Langmead and Salzberg, 2012).
As shown in Table 3, MEGAHIT gets > 4 times more reads mapped
and 5—6 times more read pairs properly aligned. 37% of distinct 17—
mers appeared 2 2 in the assembly, which might imply that
MEGAHIT did a better job in recovering low—abundance subspecies
in ultra—diversified metagenomics (Supplementary Fig. S3).

4 Conclusions

MEGAHIT enables an efficient assembly of large and complex
metagenomics data on a single server, while giving better complete—
ness and contiguity. MEGAHIT is available in both CPU—only and
CPU—accelerated versions. With GPU, the assembly time of the soil
dataset is shortened from 4 days to less than 2 days.

Acknowledgements

The authors thank S.M. Yiu, C.M. Leung and Y. Peng for the detailed explan—
ation about IDBA-UD. The authors also thank C. Titus Brown for providing
the open evaluation with the Ecoli data (Table 1).

Funding

This work was funded by Hong Kong GRF (General Research Fund) HKU-
713512E and ITF (Innovation and Technology Fund) GHP/011/12. The fun-
ders had no role in study design, data collection and analysis, decision to pub-
lish, or preparation of the manuscript.

Conﬂict of Interest: None declared.

References

Bankevich,A. et al. (2012) SPAdes: a new genome assembly algorithm and its
applications to single-cell sequencing. Commit. Biol., 19, 455—477.

Bowe,A. et al. (2012) Succinct de Bruijn Graphs. In: B., Raphael and J., Tang
(eds.) Algorithms in Bioinformatics. Springer, Berlin, pp. 225—235.

Chikhi,R. and Rizk,G. (2012) Space—efﬁcient and exact de Bruijn graph repre-
sentation based on a bloom ﬁlter. In: B.,Raphael and ].,Tang (eds.),
Algorithms in Bioinformatics. Springer, Berlin, pp. 236—248.

Gurevich,A. et al. (2013) QUAST: quality assessment tool for genome assem-
blies. Bioinformatics, 29, 1072—1075.

Howe,A.C. et al. (2014) Tackling soil diversity with the assembly of large,
complex metagenomes. Proc. NatlAcad. Sci. USA, 111, 4904—4909.

Langmead,B. and Salzberg,S.L. (2012) Fast gapped-read alignment with
Bowtie 2. Nat. Methods, 9, 357—359.

Liu,C.-M. et al. (2014) GPU-accelerated BWT construction for large collection
of short reads. arXiv:1401.7457.

Luo,R. et al. (2012) SOAPdenovoZ: an empirically improved memory-efﬁcient
short-read de novo assembler. GigaScience, 1, 18.

Peng,Y. et al. (2012) IDBA-UD: a de novo assembler for single—cell and meta-
genomic sequencing data with highly uneven depth. Bioinformatics, 28,
1420—1428.

Qin,]. et al. (2010) A human gut microbial gene catalogue established by meta-
genomic sequencing. Nature, 464, 59—65.

[310'sp2umotp105xo'sopeuHOJIItotq/ﬁdnq

