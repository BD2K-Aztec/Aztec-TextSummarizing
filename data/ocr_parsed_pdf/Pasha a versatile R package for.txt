Bioinformatics, 32116), 2016, 2528—2530

doi: 10.1093/bioinformatics/btw206

Advance Access Publication Date: 22 April 2016
Applications Note

 

Sequence analysis

Pasha: a versatile R package for piling chromatin
HTS data

Romain Fenoui|1'*'1, Nicolas Descostesz'f, Lionel Spinelli3'1,
Frederic Koch4, Muhammad Ahmad Maqboo|5, Touati Benoukraf5,
Pierre Cauchy7, Charlene lnnocentis, Pierre Ferrier3 and
Jean-Christophe Andrau5'*

1Icahn Institute for Genomics and Multiscale Biology, Icahn School of Medicine at Mount Sinai, New York, NY,
USA, 2Department of Biochemistry and Molecular Pharmacology, Howard Hughes Medical Institute, New York
University Langone School of Medicine, New York, NY, USA, 3Centre D'lmmunologie De Marseille-Luminy, Aix
Marseille Université UMZ, lnserm, U1104, CNRS UMR7280, 13288 Marseille, France, 4Department of Developmental
Genetics, Max Planck Institute for Molecular Genetics, Berlin 14195, Germany, 5Institute of Molecular Genetics of
Montpellier (IGMM), UMR5535 CNRS, 34293 Montpellier, France, 6Cancer Science Institute of Singapore, National
University of Singapore, Singapore, Singapore, 7Institute of Cancer and Genomic Sciences, University of
Birmingham, Birmingham B15 ZTT, UK and 8CHU Montpellier, INSERM U1203, Institute of Regenerative Medicine
and Biotherapy, Montpellier, France

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first three authors should be regarded as joint First Authors.
Associate Editor: John Hancock

Received on December 18, 2015; revised on April 7, 2016; accepted on April 8,2016

Abstract

Summary: We describe an R package designed for processing aligned reads from chromatin—ori—
ented high—throughput sequencing experiments. Pasha (preprocessing of aligned sequences from
HTS analyses) allows easy manipulation of aligned reads from short—read sequencing technologies
(ChlP—seq, FAIRE—seq, MNase—Seq, ...) and offers innovative approaches such as ChlP—seq reads
elongation, nucleosome midpoint piling strategy for positioning analyses, or the ability to subset
paired—end reads by groups of insert size that can contain biologically relevant information.
Availability and implementation: Pasha is a multi—platform R package, available on CRAN reposito—
ries under GPL—3 license (https://cran.r—project.0rg/web/packages/Pasha/l.

Contacts: rfenouil@gmail.c0m 0rjean—christophe.andrau@igmm.cnrs.fr

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

Transcription regulation analyses benefited from the transition to
High Throughput Sequencing (HTS) technology, which offers an un-
precedented coverage by sequencing a large number of small se-
quences in parallel. However, while library preparation protocols
recommend the selection of sheared DNA fragments ranging from
less than 100 bp to more than 500 bp, the read size generated by the
sequencing process is often shorter (25—100 bp). As a consequence,
typical single-end sequencing reads will display a gap between

enrichments on both strands after alignment to the reference gen-
ome. In most analyses scenarios, peak detection algorithms are mak-
ing use of the lag between the strands to infer the theoretical center
of enrichment (Liu, 2014; Valouev et (11., 2008). However, while the
localization of binding events is a crucial step for analyzing stable
binding factors in ChIP-seq experiments, an additional layer of
qualitative and quantitative analyses are often required for an ex-
haustive description of transient or dynamic chromatin association
(e.g. RNA Polymerase). To characterize such profiles, it is critical to

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2528

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Pasha

2529

 

restore the missing coverage information from read sequences in
order to preserve the qualitative and quantitative aspect of the data.
Here, we describe a piling tool that addresses this question by trans—
forming aligned reads to piled enrichment scores. The modular
structure of this pipeline makes it adaptable to most experimental
scenarios for chromatin—oriented analyses, as well as short RNA
sequencing. Pasha pipeline is for instance able to process seamlessly
paired—ends or single—ends dataset by loading appropriate module,
and allows the user to focus on biologically relevant parameters.
Importantly, a versatile set of options decorates the core pipeline
and enables innovative approaches for downstream analyses, such
as an alternative midpoint piling strategy often used for nucleosome
positioning analyses, or the ability to subset paired—end reads by
groups of insert size for a finer analysis of fragments population.
Finally, in order to maximize the compatibility with public tools and
facilitate the integration to existing pipelines, a broad range of input
and output file formats were implemented (Supplementary Fig. 1).

2 Description

2.1 Elongating from the edges

We developed an original method to estimate the original DNA
fragments size from the observed lag between both strands. Because
it relies on a simple multiplicative operation on piled scores, most
represented fragment sizes are given more importance during elong—
ation estimation, which confers a significant advantage for samples
displaying a vast heterogeneity in fragments size as compared to
concurrent techniques often based on cross—correlation.

By applying this method, and adjusting the coordinates of the re—
gion covered by reads, we were able to restore the crucial informa—
tion required for an accurate representation of reads coverage
(Supplementary Fig. 2).

2.2 Paired—ends and orphan reads

Alternative paired—end sequencing technique waives the requirement
for elongation estimation by performing the simultaneous sequenc—
ing of both ends of each DNA fragment. Their subsequent alignment
to the reference genome provides direct information about the initial
fragment length. In some cases—because of insufficient sequence
quality, insertions/deletions events, or repeated regions on the gen—
ome—one read from a pair fails to align to the reference genome.
These broken pairs can represent a considerable amount of informa—
tion that is lost when the orphan reads are discarded. In an attempt
to provide a thorough handling of paired—end experiments to our
pipeline, we developed additional options to rehabilitate orphan
reads by elongating them to the median fragment size represented by
the remainder of the sample.

2.3 Midpoint piling

A common theme in nucleosomal studies (MNase—seq) is to represent
data as midpoint to emphasize positioning. Whereas densities (gener—
ated by tag elongation) will allow better characterization of nucleo—
some apparent depletion, midpoints will give a better view of the
precise positioning of nucleosome more specifically at promoters
(Pugh, 2010; Seila et al., 2008; Weiner et al., 2010). This type of ana—
lysis reduces reads coverage to a single base footprint, centered on
the theoretical region covered by the initial DNA fragment. While
this compromises the quantitative and qualitative aspect of the obser—
vations, it allows a more resolutive outlook for factors with a high
density of binding events, and is particularly suited for analyzing
binding patterns in large scale analyses (e.g. average profiles).

This method is available as an alternative piling method in our
package and provides additional options (summarized in
Supplementary Fig. 3) such as the possibility to highlight borders of
binding events rather than their centered position, as seen in
(Schones et al., 2008).

2.4 MultiReads

Some genomic regions (eventually large, e.g. telomeric and centro—
meric) are composed of repeated sequences that can interfere with
the assignment of unambiguous coordinates during alignment. These
reads are often discarded although they can sum a precious amount
of information. Our pipeline integrates specific strategies designed to
rehabilitate signal in these regions: one affects a weight divided by
the number of candidate positions for each read, while the other it—
erative algorithm preferentially affect reads to positions showing sur—
rounding enrichments (Chung et al., 2011). In both cases, the
complexity threshold is determined by adjusting the maximal num—
ber of candidate regions reported during the alignment step.
Although their use prevents a strict quantitative comparison between
genomic regions, these methods have proven to highlight some signal
on relevant repeated genomic features (i.e. miRNAs, snRNAs;
Supplementary Fig. 4) and centromeric and telomeric regions.

2.5 Size segregation

Because chromatin fragmentation process is likely to be affected by
biological factors (e.g. MNase treatment is less efficient where nu—
cleosomes are bound to DNA), it is expected that subpopulations of
reads in the fragmented population can reflect relevant biological
features. This approach has been used in several studies coupled
with MNase—Seq approach to probe for subnucleosomal structures
linked to chromatin (Henikoff et 41., 201 1).

Our pipeline allows for isolation of fragments size subpopulations
in paired—end samples and automatically generates reports for specified
ranges, possibly revealing relevant biological information in ChIP—seq
experiments (Supplementary Fig. 5). Other specific protocols targeting
small populations of RNAs (Core et al., 2008; Fenouil et al., 2012;
Seila et al., 2008) can also benefit from this option as RNA populations
can be are characterized by their size (ie. MicroRNAs, tRNAS).

3 Conclusion

The described pipeline is a versatile tool that summarizes chromatin—
oriented HTS data to enrichment scores using various strategies. It in—
tegrates several options allowing a seamless adaptation to various ex—
perimental setups. Additionally, the R package provides several tools
for programmers that need to develop or integrate additional features.

Funding

Work in the JCA laboratory is supported by Centre National de la Recherche
Scientifique (CNRS), Agence Nationale de la Recherche (ANR), Institut
National du Cancer (INCa) and Commission of the European Communities.
ND was supported by grant from the Ligue Nationale contre le Cancer and
MAM by a grant from the ANR iSPLICE ANR—ll—BSV8-0013.

Conﬂict of Interest: none declared.

References

Chung,D. et al. (2011) Discovering transcription factor binding sites in highly
repetitive regions of genomes with multi-read analysis of ChIP—Seq data.
PLOS Comput. Biol., 7, e1002111.

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

2530

R.Fenouil et al.

 

Core,L.]. et al. (2008) Nascent RNA sequencing reveals Widespread pausing
and divergent initiation at human promoters. Science, 322, 1845—1848.

Fenouil,R. et al. (2012) CpG islands and GC content dictate nucleosome de—
pletion in a transcription-independent manner at mammalian promoters.
Genome Res., 22, 2399—2408.

Henikoff,].G. et al. (2011) Epigenome characterization at single base-pair
resolution. Proc. Natl. Acad. Sci. USA, 108, 18318—18323.

Liu,T. (2014) Use model-based Analysis of ChIP-Seq (MACS) to analyze short
reads generated by sequencing protein-DNA interactions in embryonic stem
cells. Methods Mol. Biol., 1150, 81—95.

Pugh,B.F. (2010) A preoccupied position on nucleosomes. Nat. Struct. Mol.
Biol., 17, 923.

Schones,D.E. et al. (2008) Dynamic regulation of nucleosome positioning in
the human genome. Cell, 132, 887—898.

Seila,A.C. et al. (2008) Divergent transcription from active promoters.
Science, 322, 1849—1851.

Valouev,A. et al. (2008) Genome-Wide analysis of transcription factor binding
sites based on ChIP-Seq data. Nat. Methods, 5, 829—834.

Weiner,A. et al. (2010) High-resolution nucleosome mapping reveals tran-
scription-dependent promoter packaging. Genome Res., 20, 90—100.

/3.IO'SIBIIII’IOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

