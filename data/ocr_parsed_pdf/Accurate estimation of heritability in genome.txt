Vol. 27 ISMB 2011, pages i317-i323
doi:10. 1 093/bioinformatics/btr219

 

Accurate estimation of heritability in genome wide studies using

random effects models
David Golan and Saharon Rosset*

School of Mathematical Sciences, Tel Aviv University, Tel Aviv, Israel

 

ABSTRACT

Motivation: Random effects models have recently been introduced
as an approach for analyzing genome wide association studies
(GWASs), which allows estimation of overall heritability of traits
without explicitly identifying the genetic loci responsible. Using this
approach, Yang et al. (2010) have demonstrated that the heritability
of height is much higher than the ~10% associated with identified
genetic factors. However, Yang et al. (2010) relied on a heuristic for
performing estimation in this model.

Results: We adopt the model framework of Yang et al. (2010)
and develop a method for maximum-likelihood (ML) estimation in
this framework. Our method is based on Monte-Carlo expectation-
maximization (MCEM; Wei et al., 1990), an expectation-maximization
algorithm wherein a Markov chain Monte Carlo approach is used in
the E-step. We demonstrate that this method leads to more stable
and accurate heritability estimation compared to the approach of
Yang et al. (2010), and it also allows us to find ML estimates of
the portion of markers which are causal, indicating whether the
heritability stems from a small number of powerful genetic factors
or a large number of less powerful ones.

Contact: saharon@post.tau.ac.il

1 INTRODUCTION

Many complex traits display a remarkable gap between the overall
genetic variance estimated by population studies (such as twin
studies) and the variance explained by speciﬁc genetic variants
identiﬁed by genome wide association studies (GWASs). This gap
has been coined the ‘dark matter’ of heritability (Manolio e1 (11.,
2008). Suggested explanations for this gap include gene—gene and
gene-environment interactions (Manolio e1 (11 ., 2008; Visscher e1 (11 .,
2008), unidentiﬁed by the univariate GWAS scheme, though some
of these explanations have been reﬁited by studies (Hill et (11 ., 2008).

Height, being a trait that is easy to measure but genetically
complex, has attracted special attention. Heritability of height,
deﬁned as the portion of height variability due to genetic factors, was
estimated at around 80% (Macgregor e1 (11., 2006; Visscher, 2008;
Visscher e1 (11., 2008) while the tens of speciﬁc single nucleotide
polymorphisms (SNPs) identiﬁed by large-scale GWASs account
for only 10% of the heritability (Gudbjartsson e1 (11., 2008; Lettre
e1 (11., 2008; Weedon e1 (11., 2008). Extrapolating from these data,
under speciﬁc statistical assumptions, Goldstein (2009) estimated
the number of causal SNPs affecting height at 93 000, which is at
the high end of reasonable values.

Yang et (11. (2010) recently suggested the use of random effects
models as a multivariate approach for estimating the heritability of

 

*To whom correspondence should be addressed.

height directly from GWAS data. In their model, each individual’s
height is affected by a genetic random effect, which is correlated
across individuals by virtue of sharing some of the genetic variants
affecting height, and an environmental random effect, which
is uncorrelated across individuals. Consistent with the common
deﬁnition, they deﬁne heritability as the ratio of the variance of
the genetic random effect to the total variance.

Using a straightforward maximum-likelihood approach for
estimating heritability in this model requires knowledge of the
identity of the causal SNPs, and hence the covariance matrix. This is
of course not available, so Yang et (11 . (2010) approximate the genetic
correlation between every pair of individuals across the set of causal
SNPs by the genetic correlation across the set of all genotyped SNPs.
Using this approximation they estimate the heritability of height at
45%. By adding some further assumptions about the nature and
distribution of the causative SNPs they obtain heritability estimates
of 56% and 80%.

While the random effects approach proposed by Yang et (11.
(2010) is innovative and appropriate, the concept of using an
estimated correlation matrix instead of the actual correlation matrix
is a questionable heuristic. The very large number of SNPs used
for estimating the genetic correlations—most of them likely not
causative—might mask out the correlations on the set of causal
SNPs. As we show below, this indeed leads to inaccurate and
suboptimal estimation of heritability.

Instead, we propose here to treat the identity of the causal
SNPs as missing data, and ﬁnd true maximum-likelihood estimates
of our parameters of interest in this setting. Towards this end,
we develop an expectation-maximization (EM) algorithm for this
problem. Because of the exponentially large data space, we employ
Markov chain Monte Carlo (MCMC) methods for the estimation of
the E-step. This approach is known as Markov-chain expectation-
maximization (MCEM; Wei et (11., 1990). We also develop an
efﬁcient optimization approach for the M-step, based on spectral
decomposition of the estimated covariance matrix.

The resulting algorithm is computationally intensive, yet tractable
for reasonably sized problems, as we demonstrate. As a by-product
of our approach, we also get maximum-likelihood estimates of
the portion of genotyped SNPs that are causative in the random
effect model. This represents independently useful information, as
it indicates whether the estimated heritability is likely due to a small
number of large genetic effects, or a large number of smaller effects.
For example, this knowledge may be useﬁil in planning further
studies to identify these speciﬁc factors.

We empirically demonstrate using simulations that our method,
in addition to being theoretically sound, does indeed lead to
signiﬁcantly more accurate estimation of heritability than the
heuristic approach of Yang et (11. (2010).

 

© The Author(s) 2011. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

D. Golan and S.Rosset

 

2 METHODS AND SIMULATIONS

2.1 Random effect models of genetic causality

We ﬁrst describe the random effects model proposed by Yang et a1. (2010).
Assume we have n individuals with their quantitative phenotype (say, height)
denoted by yj , j = 1 . . .n, and we know there are m genetic factors affecting
the phenotype, as described by the following model:
Ill
yj =M+ZZijui+ejv
1’21
where zij is the value of the i-th causative SNP of the j—th individual after
xii—2p,-
the minor allele frequency (MAF), so E(z,j) =0 and V(zij) = 1. 11,» ~N(O, of)
is the effect of the i-th SNP on height. 21- ~N(O, :73) is the environmental effect
which is assumed to be i.i.d. across individuals. )1 is the mean term, that is
typically assumed to be known and equal to O (i.e. it has been subtracted),
and m is the number of causal SNPS.
Deﬁning gj = lzijui as the genetic random effect of individual j, the
genetic variance is given by var(gj)=a§ =maf, and

standardization, i.e. zij = where xi]- is the actual genotype and [7) is

n 02 r1
2 g
COV(8j~gk) = U“ ZZijZik = Z ZZijZik-
1:1 1:1
From here it follows that y~N(O, Ga§+Ia§) where G: ﬁZZT and Z is
the genotypes matrix. G can be interpreted as the genetic correlation matrix.
Heritability, or the share of the genetic variance in the overall variance, is
a)?
0% +692 .

 

given by 112 = All that is needed for maximum-likelihood estimation

of 112 using standard random effects regression approaches (Searle at (11.,
1992) is the genetic correlation matrix G and the phenotypes vector y.

2.2 Estimation approach of Yang et al. (2010)

Yang et a1. (2010) acknowledge the fact that the identity of the causal SNPs
is unknown, and therefore G cannot be directly obtained. Assume that we
have performed genome-wide genotyping on the n individuals, with a total
of N genotyped SNPS on each. Yang et a1. (2010) propose to use the overall
genetic correlations matrix A = ﬁWWT computed on the entire genotyped
data W (instead of just the ‘causative’ matrix Z) as an estimate of G. Yang
et a1. (2010) further improve this estimate in two ways.

First, Yang et a1. (2010) correct the sampling bias along the diagonal of
the matrix by deﬁningA not as the cross-product of the genotype matrix, but
by deﬁning instead:

1 N (xii-2170(Xik-2Pi) -
A_ _ N 21:1 21310—171) 6 17H:
1k _ 1 l N xi‘f—(l+2]J,-)xif+2plf ._k '
+ N 21:1 21710-171) J _

Second, Yang et a1. (2010) account for linkage disequilibrium (LD)
between genotyped SNPs and causal SNPs by replacing A with A* =
)3(A —I)+I where )3 is a parameter which is estimated from the genotyped
data, using simulations which are based on assumptions as to the number of
causal SNPs and their MAF. This can be thought of as regressing G on A
and replacing A with the conditional expectation of G given A.

After obtaining the A* matrix, Yang et a1. (2010) use restricted maximum
likelihood (REML) for obtaining estimates of the variance components and
hence heritability in the model y ~N(O,A*a§ +103) instead of the real model
y~N(O, Ga§+Ia§) for which the wriancewovariance matrix is unknown.
As we discuss later, this heuristic is statistically unbased and introduces
substantial error to the estimation. We thus seek a more rigorous estimation
approach.

2.3 Missing data representation of the problem

We wish to treat the identity of the causal SNPS as missing data, and therefore
assume each SNP is causal with probability [7. It is convenient to think about

the set of causal SNPs as a bit mask represented by the number 0 with that bit
mask as a binary representation. So 0 represents no causal SNPS while 2N — 1
means all SNPs are causal (where N is the number of genotyped SNPS), and
the probability of observing a causal SNPs set c is [7(0) 2 p#c(1 —p)N_#‘
where #c is the number of causal SNPs in c. We denote by G(c) the genetic
correlation matrix based on the causal SNPs in 0. Given 0, the log of the full
likelihood can now be written as:

2” —1
6(a§,a3,p:y,c>= Z Hic=j}[log(pm>— glogan)
1:0

1 . 1 . _
— E 1090ng +1a§| — EyT[GQ)a§+Ia§] 1y].

Since we do not know 0 we use EM (Dempster 61611., 1977) to ﬁnd maximum-
likelihood estimates of our parameters of interest.

2.4 E-Step
The E-step takes the form:

Q(U§’03,17;y’U§(t)’gg(t)’p(t))=E[g ly; U§(t)’03(t)’p(t)] =

2N—1

Z Eggnﬂgwpu, (111mm [logw>>— glogan)
1:0

1 , 1 . _
— E logIGg)a§+1a§| — EyT[G(;)a§+Ia§] 1y].
From Bayes” theorem it follows that for all j:

E anﬂgutpm (MC  =

‘72
P(c =j|y 2y; 030) , 030) ’pm):
p")(c)¢ (y; 0mg?” +105”)

where ¢(y; E) is the multivariate normal density of the observed vector y
given the variance-covariance matrix 2.

2.5 MCMC estimation of the E-step

Clearly, it is not feasible to sum over 2N summands for even modest values of
N. We therefore use a MCMC scheme to estimate the conditional expectation
of the log-likelihood. Given M samples from the conditional distribution of
c: P(c|y;a§<t),ag(t),p(’)) labeled 01,...,cM we estimate the E-step with the
empirical mean Q:

Qwé 0? ~17: 0,3") ~ 03") ~17”) =
1 M 1
M Z [logoa(ci>> — 5 log lama; +Ia3I
i2]

1 _1 n
_ Eyr [C(ci)a§ + Inf] y — E log(27't)].

To sample the conditional distribution of c, we specify the Metropolis
algorithm in a manner similar to McCulloch (1990). We specify the candidate
distribution 116(0) from which potential values are drawn and the acceptance
function that gives the probability of accepting the new value.

Let c be the last draw from the conditional distribution of c with
(b1,b2,...,bN) being its binary representation. We generate a new value I):
for the k-th component of c using the candidate distribution he. We accept
0* 2(1)], . . . , 111:“, . . . , bN) as the new value with the probability Ak(c, 0*) given
by:

Ak(€, 6*) = min { 1,f—cly(c* ly' 6)h6(c) }.
fcly(c lyv 9)hc(0*)

 

i318

112 /3.Io's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

Heritability estimation using random effects models

 

Taking hc(c)=p#‘(1—p)l_#c the second term takes a particularly
convenient form:

flc<yic*.6>P<c*I6>
fcIy(C*|)/~9)hc(€)_ y fy<yI6) MC)

— ,3 v .913 9
fcly(clyv9)hc(6*) Whom“)

 

=fylc(yl6*v9)P(C*)hc(C) Zﬁic0|c*,9)
fyIcUICﬂ)P(C)hc(C*) fyic(ylc,9)'

which is simply the ratio of the likelihoods.

2.6 M-step

Rewriting the empirical mean Q resulting from the MCMC:

M
2 n 1
(2w; 037p: y, a§®m§<’>,p<’>> = — 5 log(2n>+ M Zlogwi»

i:l

M
1 1 _
— w Z[10glG(Ci)U§‘i—IU§| — gamma; +Ia3] 0].
i2]
indicates that the optimization in the M-step is done separately for p and for
the variance components. For [7 we wish to solve:

1 M
arr;ng : M 21015070»): =

i2]

1)

M
argmax {Z [#cilogonHN —#ci>log(1 —p>1} .

i:l

Differentiating w.r.t [7 yields:

M
p(1+1) = i E

M , N i
[:1
which is simply the average of causal SNPs proportions in the samples.
For the variance components, it is beneﬁcial to rewrite the equation as a

2
function of (no?) with r: :4; instead of (03,03). We then get:
2

~ 71
Q0, 03 ~17: y, “0103 “117(0) 2 T 51014271)

1 M 1 M
+ M Dogma») — ﬂ 210g IU§[G(Ci)r+Il|

i:l

M
1 T 2 —1
——2y a, [G(c,»>r+11 y:
2M i:l

M
n 1 n
— E log(27'r)+ M 21310150101» — 510803

1
2M :73

 

M M
1
—WE lOgIG(Ci)r+II— E yT[G(c,»>r+I]“y.
i2] i2]

Differentiating w.r.t. :73 yields:

M
1 _
2 1
as 0+1) = W 2); [G(Ci)r(t+l) +1] y.
1:
Notice that plugging the last result into the E-step, the last term of the
E-step expression becomes constant:

M

1 _
Z 202(r)yT[(G(Ci)r+1)l 1y:

i:l
M
n

1 _ M
yT[(G(c,»>r+I>] ‘y=—.
l

2030)

 

2

i:

so the optimization problem for r becomes:

” 1 M T _ —1
argrrrtax{—§log(W;y [G(c])r+I] y)

M
l
_ mziogiccjvwi}.
1'21

which has no closed form solution. However, given the spectral
decomposition of each GU) it is easy to solve numerically. G0) is a
correlation matrix and therefore has n real and non-negative eigenvalues.
Let {Ai0)}?:l denote the eigenvalues of a matrix GU) associated with
eigenvectors {vim};l , then for all (1,1):

det(G(j)a+Ib) = H(M(i)a+b),

i2]

and:

yT(Gv>a+Ib>—‘y=yT[Ziaxim+b1-‘vimvi(/>T]y

i2]

= Z [aAiU)+b]_l [yTv,(j)]2.

i:l

It is useful to denote my): [yTviU)]2.

Hence, the maximized function is easy to compute when the spectral
decomposition of each G(j) is known by setting a=r,b= 1 and solving the
following maximization problem:

M r1
argrrnax{ — glog[$ ZZDMUH‘ 11—1Wi0)]
J

'21 i2]

1 M r1
—ﬁzzl:log(ki(j)r+l)}.

1:1 i:

Recall that the densities ¢(y; G0), a; , :73) are computed during the MCMC
process for each GU) matrix used. Computing the normal likelihood involves
inverting the varianceicovariance matrix G(j)a§ +103 which takes 0(n3)
operations. Using the previous results, we can easily compute the log
likelihood given the spectral decomposition by setting a: a; and b :03:

. n n .
logw: Gmaécé): —§ 2 :loguimagwb
i2]

1 ” . _ .
— E Z[U§A,(;)+a§] lwi0)+log2n.
[:1
Since obtaining the spectral decomposition is also done in 0(n3), we can
compute the spectral decomposition and use it for the likelihood calculations
as well as for constructing the optimization problem for r with hardly any
additional complexity cost. Doing so, the complexity of the optimization of r

is negligible compared to the time complexity of the spectral decomposition
and the MCMC burn-in.

2.7 Simulation settings

In order to test our method on data with realistic LD structure, we used
HapGen (Spencer et (11., 2009) to simulate 700 genotypes of 10000 SNPs
each, roughly corresponding to every 10th SNP of the ﬁrst 100 000 HapMap
SNPs on chromosome 1, thus simulating the same SNP density as in the data
used by Yang et a1. (2010). Given a desired proportion of causal SNPs p and a
set of variances 0;, :73, each SNP was chosen to be causal with probability [7
independently of other SNPS. Following that, the genetic correlation matrix
G was calculated, and the phenotypes were sampled from N (0, Ga; +103). It

is important to note that, due to the randomization process, setting the value

 

i319

112 /3.Io's[Bumo[pJOJXO'soerJJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

D. Golan and S.Rosset

 

of 03,03 or p to a certain value does not necessarily imply that the actual
values of the parameters in-sample would be the same. To avoid confusion,
we use the term ‘population value” to note the value of the parameters used
to generate the data, and ‘in-sample value” to note the parameters in each
sample.

The length of the burn-in period of each MCMC step, which is
used to estimate the E-step, was determined using Geweke”s convergence
diagnostics (Geweke, 1992). We then collected 2000 samples by taking
every 500th sample from the MCMC process before proceeding to the
M-step.

We began by studying the convergence of the MCEM estimators. Towards
this end, we set the expected variances to a; :03 = 1 and simulated a single
set of phenotypes. Then, initializing the proportion of causal SNPs (denoted
[70) at its population value p, we set the initial estimators of the variance
components to a range of values between 0.2 and 2 (in 0.2 intervals) thus
creating a 10 X 10 grid of initial values around the expected values. We then
ran the algorithm for 7 iterations. This exercise was repeated once with
p: 1% and once withp=0.1%.

A similar exercise was carried out to study the convergence properties of
the estimator of the proportion of causal SNPs  initializing the variance
components estimators to their expected values and setting the actual
proportion of causal SNPS to p=0.5%, we then set [70 to a range of values
from 0.1% to 1% (in 0.1% intervals).

As mentioned earlier, the method suggested by Yang et a1. (2010)
approximates the actual genetic correlation matrix G by a modiﬁcation
to the observed correlation matrix A, which is the correlation across all
genotyped SNPS, causal and non-causal alike. With this in mind, we wanted
to compare the methods in scenarios where this approximation is appropriate,
i.e. when the proportion of causal SNPs is high, and in scenarios when the
approximation would be very different from the actual G matrix, i.e. when
the proportion of causal SNPs is very small. We therefore deﬁned a ‘high”
proportion of causal SNPS to be 1% of SNPS, and a ‘low” proportion of
causal SNPs to be 0.1% of SNPs and ran two sets of 50 simulations each. In
the ﬁrst set, we set [7:170 = 1%, while in the second we set [7:170 20.1%.
It is important to stress that the actual number of causal SNPs in each
simulation run is not ﬁxed to the value of p, but is distributed Bin(p,N) with
N being the total number of SNPS. This means that in the aforementioned
simulations the initial estimate of the proportion of causal SNPs was not
necessarily the ‘correct” (in-sample) estimate, but only close to the true
value.

To test the robustness of our method to the initial estimate of the proportion
of causal SNPS, we ran two more sets of simulations, one where p: 1%
and [70 20.1%, and one where [720.1% and p0 = 1%. The four simulation
scenarios were labeled A,B, C and D, respectively.

3 RESULTS

We ﬁrst study the convergence properties of the MCEM algorithm.
As can be seen in Figure 1, convergence is achieved after a relatively
small number of iterations, after which the estimators are almost
identical, independent of their starting points. Clearly, some level
of variance is expected due to the stochastic nature of the MCMC
approximation of the E-step, and could therefore be reduced by
either taking more samples or averaging over several consecutive
MCEM iterations. The number of EM iterations required for
convergence did not vary greatly even when the proportion of
the causal SNPs was low (data not shown). We have also found
that the lengths of bum-in periods, as determined by the Geweke
(1992) algorithm varied greatly between simulations and between
consecutive iterations of the MCEM algorithm. In general, we have
found that burn-in periods were longer when the proportion of causal
SNPs was high, and shorter when the estimators were closer to their
true value.

 

 

 

 

 

 

 

 

 

 

 

 

(a)«b. 3_ _'_
g _
E 3-— E?—_——__
a D— _I_
”" 0' I I 1 I I I I I
U 1 2 3 d 5 E "I"
MCEMiteraiion
(bw 3— T I
g - -I-
:5 0.- ﬁ—%—+—-h-—————-
E ‘- _I_
= _
m c, _I_
"'" a I I 1 I I I I I
0 1 2 3 4 5 6 7
MCEMIherallon
(C) E
.D _
2 — T
a: W
1: D— +_ﬂ—_Q——h_——
E I .
n: D _,_
E ci— I I I I I I I I
"” o 1 2 3 4 5 s 1

MC EM its rali on

Fig. 1. Evolution of MCEM estimators when [721%. (a) and (b) The
evolution of :73 and a; estimators, starting from values ranging from 0.2
to 2 in 0.2 increments. The population value is 1 in both cases. (c) The
evolution of the estimated heritability, showing a rapid convergence within

a small number of iterations.

 

D
E——'——I——u——I—
a I I | I
I I | l
l I x I
I I | I—I—
|....
I I | |
81:...
“l:— l_'_—l—
0'0” ..,
2 In.
a: | | I
a T
G I
3
23 '
EQ— l:l
OD
C
G
E I I I
3" | | I
I'll
93— '-‘-—L—‘—
a- I . I I
go lIII
a ' . I I
E I:I_I__I_
.
||
ﬁg I II
_I_
“’ct-I —*—
DI
.
_I_
D
D
Q-
C)

 

 

 

MCEM ileralion

Fig. 2. The evolution of the estimator of the proportion of causal SNPs [3 for
various starting points. Initial values range from 0.1% to 1% with increments
of 0.1%. The actual value is 0.5%.

The estimators of the proportion of causal SNPs converged much
slower, but did display convergence, as can be seen in Figure 2.
Starting from the 10 starting points that spread uniformly in the
range (0.1%, 1%), all 10 estimators were in the range (0.4%,0.7%)
within 7 iterations.

We noticed that the in-sample variances, and hence the in-sample
heritability, varied greatly between simulations, especially when the
number of causal SNPs was small. Thus, to compare the methods we
ﬁrst calculated the difference between the in-sample heritability (as
estimated using the actual genetic correlation matrix G generated in

 

i320

112 /3.Io's[Bumo[pJOJXO'souBHIJOJurorqH:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

Heritability estimation using random effects models

 

 

 

W—
C. o
u
o
0 ﬁ
0 0
~—._ 4:1 e T
a I o 0 I
T I a T I
: I I #- I
l —,— I I I I
I I I : I I
I -I- I
D_ E
:- g E
I I i .
I ' I I I —'— .
I T”— | -‘- I I
_I. I g I I
I I I I
v I " -'- : I
q- o I 0 ° I -'-
‘5‘ 3 .I.
o
3 o
N
c.5_
| | I |
A B C D

Fig. 3. comparing heritability estimation errors obtained using the method
suggested by Yang et a1. (2010) (left box in each pair) and 5 iterations
of the MCEM method (right box in each pair) for various values of the
proportion of causal SNPS (p) and the initial estimate ([70). A: [7:170 = 1%,
B: p=p0=0.1%, C: p=1%,p0=0.1% and D: p=0.1%,p0=1%.

our simulation) and the heritability estimates obtained by the Yang
et (11. (2010) method and our method. An advantage of this variability
of in-sample heritability is that we, in fact, compared the methods
over wide range of heritability values ranging from ~ 0.2 to ~ 0.8,
and not just for 0.5.

When comparing the heritability estimators obtained after 5
MCEM iterations to the estimators obtained by the Yang et (11 . (2010)
method (Fig. 3), we found that in sets A and B, where the initial
estimators of the proportion of causal SNPs were set close to the in-
sample proportion, our method signiﬁcantly reduced the variance
of the heritability estimation errors (p<0.03 in both cases using
Bartlett’s test (Snedecor and Cochran, 1989)).

It is important to note that while the performance of the method
of Yang et (11. (2010) deteriorates as the proportion of causal SNPs
decreases, our method is more robust to such differences. The
heritability estimation errors of Yang et (11. (2010) in scenario A,
where the proportion of causal SNPs is high, display a signiﬁcantly
lower variance than the heritability estimation errors of the same
method in scenario B, when the proportion of causal SNPs is low
(1) < 10T3). This is reasonable, as a lower proportion of causal SNPs
means that the approximation of G used by the method of Yang
et (11. (2010) is less appropriate. Our method explicitly models the
causal SNPs, and therefore we expected it to be less affected by this
problem. Indeed, while our method does show higher estimation
error variance in scenario B, the difference between the variances in
scenarios A and B is not signiﬁcant.

When initializing the estimate of the proportion of causal SNPs at
a very different value, as in scenarios C and D, we saw a signiﬁcant
reduction in heritability estimation error from using our method only
for scenario D (p < 0.03). We suspect this is due to slow convergence
of the estimators of p in scenario C, as discussed later.

It is also interesting to note that the estimation errors of the
environmental random effects variance were smaller than the
estimation errors of the genetic random effects variance. This was
true for both methods and for all simulation scenarios, as well as for
the convergence studies we conducted earlier. We suggest that this

is because the environmental random effects are uncorrelated while
the genetic random effects are correlated (with G as the correlation
matrix) and thus provide a more difﬁcult estimation problem.

3.1 Estimation of the proportion of causal SNPS

In scenarios A and B, in which the estimators of the proportion of
causal SNPs were initialized to a value close to the true in-sample
proportion, the estimators quickly converged. For the estimation
error, the 95% conﬁdence intervals (the difference between the
estimated proportion and the in-sample proportion) are given by
(—0.098%,0.075%) and (—0.013%,0.2%) for scenarios A and B,
respectively (using inter-quantile range).

In scenarios C and D, the estimators of the proportion of causal
SNPs did not seem to converge, but in both cases (111 100 estimators
were closer to the expected value than the starting point, suggesting
that given enough running time they, too, would have converged.
Convergence was slower for scenario C, probably explaining the
non signiﬁcant change in heritability estimation error variance.
The 95% conﬁdence intervals for the estimation error of the
proportion of causal SNPs in scenarios C and D are given by
(—0.69%, —0.53%) and (—0.2%,0.6%), respectively. Note that in
both cases the estimation error is signiﬁcantly smaller than the
estimation error of the initial estimator, which is 0.9%. We suspect
that the high LD between SNPs allows ﬁnding sets of SNPs with
different sizes which lead to a similar genetic correlation matrix, for
example, by adding SNPs which are approximately a convex linear
combination of other SNPS. We believe this slows the convergence
of the estimators of the proportion of causal SNPs, and can be solved
by running more iterations of the MCEM algorithm.

4 DISCUSSION

The idea of using random effects models for analyzing genetic data
is appealing and powerﬁil. Even when only tag SNPs are genotyped,
the high LD between tag SNPs and ungenotyped SNPs allows us to
expect it to yield accurate results. However, the method suggested by
Yang et (11. (2010) might carry some hidden pitfalls. Replacing the
correct genetic correlation matrix by a different matrix estimated
from the data as if the latter matrix were the correct matrix is
unfounded statistically. Indeed, using the A* matrix as the variance—
covariance matrix introduces two additional sources of variance to
the estimation. One is the error originating from the element-wise
difference betweenA* and G (the noise from the non-causal variants)
and one stems from the built-in variance of the estimated (3. The
former in particular is highly sensitive to the proportion of causal
SNPs, as our simulations have demonstrated: with few causal SNPs,
the noise in A* overwhelms the signal and estimation accuracy in the
approach of Yang et (11. (2010) deteriorates signiﬁcantly. Ignoring
both sources of variances would lead to inaccurate estimation and
incorrect inference (overly optimistic conﬁdence intervals).

Our approach avoids these issues by performing maximum
likelihood-estimation of the relevant parameters: the genetic and
environmental effects (variances) and the proportion of causal SNPs.
To intuitively understand how this is accomplished, it is beneﬁcial to
think of the Metropolis algorithm used in the MCMC evaluation of
the E-step as a ‘soft’ simulated annealing optimization scheme where
we always switch to a SNP combination with higher likelihood, but
switch to a lower likelihood combination with a probability that

 

i321

112 /3.Io's[Bumo[pJOJXO'souBHIJOJurorqH:duq 11101} papeolumoq

91oz ‘Og Isnﬁnv uo ::

D. Golan and S.Rosset

 

depends on the likelihood ratio. We thus expect the MCMC to visit
often high-likelihood areas of the search space, corresponding to
combinations of candidate causal SNPs that lead to good estimation.
The M-step combines all these good combinations to estimate the
parameters.

Convergence of EM in general, and MCEM in particular, to the
true maximum-likelihood estimates is hard to guarantee and test
(Boyles, 1983; Wu, 1983). Our simulations present evidence that
the estimators of the variance components and heritability do, in
fact, converge quickly to the neighborhood of the true value of the
parameters, and provide some evidence that the estimator of the
proportion of causal SNPs also converges. Some variance of the
estimators is of course due to the Monte-Carlo nature of the MCMC
approximation of the E-step and can be reduced either by taking
more samples from the MCMC process, or by averaging consecutive
EM iterations. More extensive research and simulations would
be required to establish clear criteria for how long to run the
algorithm in order to obtain optimal tradeoff between accuracy and
computation time.

Putting aside the theoretical difﬁculties with convergence of EM,
maximum-likelihood estimates possess many desirable qualities,
which facilitate accurate estimation and statistical inference
(Lehmann and Casella, 1998). In particular they are consistent and
asymptotically normal. Moreover, once the process converges we
can easily extract the information matrix (Meilijson, 1989), with
which we can construct asymptotically accurate conﬁdence intervals
and carry out proper statistical inference.

Running times of the MCEM estimation are governed by two main
factors: the number of individuals and the number of genotyped
SNPs. Our current simulations have dealt with a toy example of
700 individuals and 10000 SNPs. Current running times of the
MCEM algorithm would render it difﬁcult, but not impossible, to
estimate the heritability when using a realistic number of genotyped
SNPs. Since the lion’s share of running time is ‘wasted’ on bum-
in iterations (over 90% in most runs) before the MCMC process
converges (as indicated by the convergence diagnostics of Geweke,
1992), we believe that smarter initialization of the MCMC process
could reduce running times by an order of magnitude or more.
Increasing the number of individuals is more problematic, as the
time-complexity is cubic in the number of individuals, since every
MCMC step involves computing the likelihood, and hence the
inversion of a n X n matrix. We have shown that with even a small
number of individuals our method produces very accurate estimates.
Moreover, as noted earlier, the main bottleneck of the estimation is
the eigenvector—eigenvalue decomposition, which is done in each
MCMC iteration. The time complexity of this decomposition can
be reduced from 0(n3) to 0(n2) using parallel algorithms (see, for
example, Bientinesi et (11., 2006). We therefore believe that using
the MCEM method for heritability estimation in realistic databases
is deﬁnitely feasible.

It is also appealing to think of replacing the ‘soft’ EM scheme
we propose by a ‘hard’ EM, where in each M-step the parameters
are estimated using the combination of SNPs with the highest
likelihood encountered. In this case the Metropolis algorithm
represents a simulated annealing optimization scheme. This setup
has the advantage of also offering a possible identiﬁcation of the
set of causal SNPs, in addition to parameter estimation. We also
expect such an approach to dramatically reduce running times.
However, the hard approach is not a proper EM algorithm and is

not as theoretically based as the standard EM approach. Therefore,
it does not possess the favorable properties of EM estimators. We
aim to study this alternative as means of reducing running times.
Another alternative is to adopt a Bayesian approach altogether, as
suggested by Guan,Y. and Stephens,M. (submitted for publication).
The two approaches are not necessarily exclusive, as one might
use the Bayesian estimate as a good starting point for the MCEM
algorithm to reduce running times.

In this article, we have concentrated on the application of
random effects linear regression models for estimating heritability of
quantitative traits like height. While this application area is clearly
important, many of the phenotypes of interest in current research
are dichotomous, like disease status. The extension to the linear
regression approach that would apply in such cases would be to apply
random-effects generalized linear models (Breslow and Clayton,
1993), such as logistic regression. This direction presents signiﬁcant
complications because of fundamental differences in the statistical
setup between linear random effects models and their generalized
counterparts and the complexities involved in estimation methods
of the latter (for example a MCEM algorithm by McCulloch, 1990).
We intend to pursue this direction ﬁirther in future work.

ACKNOWLEDGEMENTS
The authors wish to thank Ronny Luss for helpful discussions.

Funding: Open Collaborative Research grant from IBM;
Israeli Science Foundation (grant 1227/09); European Research
Commission (grant MIRG-CT—2007-208019); Fellowship from the
Edmond J. Safra Bioinformatics program at Tel-Aviv university
(to D.G., in part).

Conﬂict of Interest: none declared.

REFERENCES

Bientinesi,P. et a1. (2006) A parallel eigensolver for dense symmetric matrices based on
multiple relatively robust representations. SIAM J. Sci. Compnt T, 27, 43766.
Boyles,R.A. (1983) On the convergence of the EM algorithm. J. R. Stat. Soc., 45, 47750.
Breslow,N.E. and Clayton,D.G (1993) Approximate inference in generalized linear

mixed models. J. Am. Stat. Assoc, 88, 9725.

Dempster,A.P et a1. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Stat. Soc., 39, 1738.

Geweke,J. (1992) Evaluating the accuracy of sampling-based approaches to calculating
posterior moments. In Bernado,J.M. et al. (eds) Bayesian Statistics 4. Clarendon
Press, Oxford UK, pp. 1697193.

Goldstein,D.B. (2009) Common genetic variation and human traits. N. Engl. J. Med.,
360, 169671698.

Gudbjartsson,D.F. et a1. (2008) Many sequence variants affecting diversity of adult
human height. Nat Genet, 40, 6097615.

Hill,W.G et a1. (2008) Data and theory point to mainly additive genetic variance for
complex traits. PLOS Genet, 4, e1000008.

Lehmann,E.L. and Casella,G (1998) Theory of Point Estimation, 2nd edn. Springer,
New York.

Lettre,G et a1. (2008) Identiﬁcation of ten loci associated with height highlights new
biological pathways in human growth. Nat Genet, 40, 58L591.

Macgregor,S. et a1. (2006) Bias, precision and heritability of self-reported and clinically
measured height in Australian twins. Hum. Genet, 120, 5717580.

Manolio,T.A. et a1. (2008) Finding the missing heritability of complex diseases. Nature,
461, 7477753.

McCulloch,C.E. (1990) Maximum likelihood algorithms for generalized linear mixed
models. J. Am. Stat. Assoc., 92, 6997704.

Meilijson,I. (1989) A fast improvement to the EM algorithm on its own terms. J. R.
Stat. Soc., 51, 1277138.

Searle,S.R. et a1. (1992) Variance Components. 1st edn. Wiley-Interscience, New York.

 

i322

112 /3.Io's[Bumo[pJOJXO'souBHIJOJurorqH:duq urorr papeolumoq

91oz ‘Og isnﬁnv uo ::

Heritability estimation using random effects models

 

Snedecor,GW. and Cochran,W.G. (1989) Statistical Methods, 8th edn. Iowa State
University Press, Ames, Iowa, USA.

Spencer,C.C.A. et al. (2009) Designing genome-wide association studies: sample size,
power, imputation, and the choice of genotyping chip. PLaS Genet, 5, e1000477.

Weedon,M.N. et al. (2008) Genome-wide association analysis identiﬁes 20 loci that
inﬂuence adult height. Nat Genet, 40, 5757583.

Wei,GC.G and Tanner,M.A. (1990) AMonte Carlo implementation of the EM algorithm
and the Poor Man’s Data augmentation algorithms. J. Amer Stat. Assoc, 85,
6997704.

Wu,J.C.F. (1983) On the convergence properties of the EM algorithm. Ann. Stat, 11,
957103.

Visscher,P.M. et al. (2008) Heritability in the genomics era - concepts and
misconceptions. Nat Rev. Genet, 9, 2557265.

Visscher,P.M. (2008) Sizing up human height variation. Nat Genet, 40, 489490.

Yang]. et al. (2010) Common SNPs explain a large proportion of the heritability for
human height. Nat Genet, 42, 5657569.

 

i323

112 ﬁlo's[Bumo[pJOJXO'soiieuJJOJuioiqﬂ:duq uIOJJ popeolumoq

91oz ‘Og isnﬁnv uo ::

