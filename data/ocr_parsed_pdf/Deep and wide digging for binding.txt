Vol. 26 no. 20 2010, pages 2622-2623
APPS N O  doi:10. 1093/bioinformatics/btq488

 

Sequence analysis

Advance Access publication August 24, 2010

Deep and wide digging for binding motifs in ChlP-Seq data

I. v. Kulakovskiyljai‘, v. A. Boeva1’2’3’4’5, A. v. Favorovl’e and v. J. Makeev”

1Research Institute for Genetics and Selection of Industrial Microorganisms, Moscow 117545, Russia, 2Institut Curie,
26 rue d’UIm, 3INSERM, 0900, 4INSERM, U830, Paris F—75248, 5Mines ParisTech, Fontainebleau F-77soo, France,
6Johns Hopkins University, Baltimore, MD 21205, USA and 7Engelhardt Institute of Molecular Biology, Russian

Academy of Sciences, Moscow 119991, Russia
Associate Editor: John Quackenbush

 

ABSTRACT

Summary: ChlP-Seq data are a new challenge for motif discovery.
Such a data typically consists of thousands of DNA segments
with base-specific coverage values. We present a new version of
our DNA motif discovery software ChlPMunk adapted for ChlP-
Seq data. ChlPMunk is an iterative algorithm that combines greedy
optimization with bootstrapping and uses coverage profiles as
motif positional preferences. ChlPMunk does not require truncation
of long DNA segments and it is practical for processing up to
tens of thousands of data sequences. Comparison with traditional
(MEME) or ChlP-Seq-oriented (HMS) motif discovery tools shows
that ChlPMunk identifies the correct motifs with the same or better
quality but works dramatically faster.

Availability and implementation: ChlPMunk is freely available
within the ru_genetika Java package: http://line.imb.ac.ru/
ChlPMunk. Web-based version is also available.

Contact: ivan.kulakovskiy@gmail.com

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 25, 2010; revised on August 7, 2010; accepted on
August 18, 2010

1 INTRODUCTION

ChIP-Seq (Valouev et (11., 2008) is an efﬁcient technology for the
identiﬁcation of DNA sites of a speciﬁc protein binding. Being
coupled with peak ﬁnding algorithms (Fejes et (11., 2008), it yields a
set of DNA segments with each sequence position having a weight
reﬂecting how often DNA nearby was cross-linked with the protein
of interest during ChIP stage (the so-called peaks). There can be tens
of thousands of DNA segment, some longer than 1000 bp. Classic
tools like Weeder (Pavesi et (11., 2001), Gibbs Sampler (Lawrence
et (11., 1993) or MEME (Bailey et (11., 2009) were tested for motif
discovery in ChIP-Seq segments, but proved to be inefﬁcient for the
whole amount of data. Therefore, a fraction of top DNA segments
was usually taken (Chen et (11., 2008) or/and the segments were
truncated around the peak maxima (Ji et (11., 2008). Tools like
CERMIT (Georgiev et (11., 2010) and HMS (Hu et (11., 2010) have
been developed for motif discovery from ChIP-Seq data. In this
note, we present a motif discovery algorithm that can extract the
single optimal motif from large datasets like ChIP-Seq without any
preprocessing, while taking into account the peak shape.

 

*To whom correspondence should be addressed.

2 METHODS

The basic ChlPMunk implementation (Kulakovskiy and Makeev, 2009. see
also the Supplementary text section 1. STSl) was extended with three
features. necessary for motif discovery from ChIP-Seq data: accounting for
the background nucleotide composition (via KDIC concept). zero-or-one-
occurrence-per-sequence (ZOOPS) mode and positional proﬁles in the initial
data (necessary to consider the base coverage in ChIP-Seq data).

2.1 KDIC concept

The basic version of the ChlPMunk algorithm searches for the motif with
the highest discrete information content (DIC) (Kulakovskiy at (11.. 2009).
DIC does not take into account the background nucleotide composition. To
allow for the background. we use the discrete analog of KullbackiLeibler
divergence (Kullback DIC. KDIC) (Kullback and Leibler. 1951):

w
KDIC = DIC — Z Z x“)- 10qu
1:1 ae(A,C,G, T)

where xw- are elements of the position count matrix (i.e. letter counts). w is
the motif length and (1.1 are the background nucleotide probabilities. Please
refer to the STS 2 for the mathematical details related to KDIC.

2.2 ZOOPS mode

ChlPMunk searches for the gapless multiple local alignment that has
the maximum KDIC value. Then a positional weight matrix (PWM) is
constructed. and all the aligned words are sorted by their PWM scores. They
are classiﬁed into ‘the signal” and ‘the noise” sublists. To ﬁnd the boundary
word we construct a series of PWMS. made from top 1. 2.  . n words. The
idea is that for ‘the signal” the score of n-th word calculated with the n-th
PWM should be visibly greater than that calculated with N -th PWM (where
N is the total words count). See STS 3 for details.

2.3 Positional proﬁles

There are two types of weights assigned to the initial sequence data.
Sequences are weighted as a whole; also the weights are assigned to the each
sequence position forming the sequence proﬁles. The source of all weights
is the peak shape data. A weight W,» for the i-th sequence is its normalized
maximal peak value; by normalization the sum of W,» over all i is equal to
the total number of sequences. The sequence proﬁles are normalized to make
them ﬁt in [0.1] interval.

PWM optimization includes two alternating steps: (i) the alignment is
rebuilt from words with maximal PWM scores in each data sequence and
(ii) the PWM is rebuilt from new motif occurrences. PWM scores for putative
hits are weighted from sequences proﬁles:

w
score (PWM.word) = ZSwordD-Lj -proﬁle[j]
j:l
where w is the word length and SwordU]J-. is the PWM element for the j—th letter
in the word. Thus. the positions with a larger proﬁle values contribute more

 

2622 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq wort popeolumoq

9103 ‘{g anﬁnv 110::

Motif discovery in ChIP-Seq data

 

(either positively or negatively) into the PWM score. Then, the positional
count weights xw- for letter 01 at motif position j are calculated:
at e {A, C, G, T}: xw- = 2W,» -proﬁlei[j] -8 (oz, word,»[j])
i
a=Nz xNJ- =  (l —proﬁlei[j])
i
if a: b then 1
Vj: Z x,-=ZW* 8a,b={.,
adAgcgchgN) 0‘] i l ( ) 1fa7ébthen0

Here proﬁleiﬁ] is the value of proﬁle of sequence 1 at position j, and N
denotes ‘unknown nucleotide” letter. After collecting the data from all words,
xNJ- values are uniformly split between x“, j (01 EA, C, G, T) so the total sum
is equal to the number of words.

The convergence depends on the data. If high proﬁle regions cannot be
aligned or their composition is similar to the background, different motifs
can have very close KDIC values, rendering the convergence poor. Yet, for
the real ChIP-Seq data, convergence improves after proﬁle smoothing by
substituting the proﬁle values for their maxima within a sliding window
with the length equal to the motif length.

3 RESULTS

We took three ChIP-Seq datasets: NRSF (Johnson et (11., 2007),
GABP (Valouev et (11., 2008) and EWS-FLIl (Guillon et (11., 2009).
We used FindPeaks (Fejes et (11., 2008) to obtain enriched regions
(the peaks). Segments with strict GGAA-type repeats were excluded
from the EWS-FLIl dataset. Motif lengths were ﬁxed at 21, 12 and
11 for NRSF, GABP and EWS-FLIl, respectively.

Top 100 (NRSF, GABP) and top 500 (EWS-FLIl) peaks were
taken to test several motif discovery tools, including MEME (Bailey
et (11., 2009), SeSiMCMC (Favorov et (11., 2005) and HMS, the novel
ChIP-Seq-oriented Gibbs sampler (Hu et (11., 2010). We used sets of
segments that were truncated from 10% to 100% of the peak lengths
and were centered at the peak maxima.

The fraction of peaks truncated to 10% of initial length centered
at the peak maximum with motif hits having scores greater than
the mean+3 SD of score distribution over all w-mers was used
as the measure of motif quality. We assessed the time efﬁciency
of motif discovery and the resulting quality of motifs identiﬁed
from 500 EWS-FLIl peaks (Fig. 1). For short segments covering
only 10% of the peaks, all the tested tools performed equally well.
When the segment length was increased MEME and SeSiMCMC,
that did not take the peak shape into account, identiﬁed incorrect
motifs. In contrast, ChIPMunk (in peak mode) always identiﬁed the
correct motif. In the mode that did not take peak shapes into account,
ChIPMunk failed to identify the correct motif in longer segments.
Nevertheless, in both modes, ChIPMunk clearly outperformed HMS
that took into account peak shapes, both in speed and quality. For
NRSF and GABP, the correct motifs were extracted by the all tools
in a wider range of sequence lengths, which probably indicates better
data quality (see the STS 4).

All in all, here we presented an extended version of our motif
discovery tool ChIPMunk that allows using information from strong
but also from weaker sites (see STS 10). ChIPMunk is reasonably
fast and practically can process datasets of thousands of sequences
(see the STS 8) even on a personal computer, taking advantage of
the modern multi-core processors.

ACKNOWLEDGEMENTS

We thank Biobase and personally Alexander Kel for providing us
with the free access to the TRANSFAC database.

I

   
 
      
  
 
 
  

  

SeSiMCMC —.L—
MEME +
HMS o

3500 -

2500

Execution time
[seconds]

1500

5110

 

1O 20 30 4D 50 60 70 80 90 100
Percentage of sequence length around peak maxima

1 - l | | I

 

 

 

gacaGGAAatg acaGGm {gm
1; 0a — — _
§ ‘1

Ea; 0.0 — —

a M '

G g M _nnnCAGgaaat A.” _
E aTgt:Htl(:r1al '0 - 9- .. H. _. - ...
u 0.2 — _

AllgaATlcaa
D I | | | |

 

10 20 30 40 50 60 70 80 9'0 100

Fig. 1. The time efﬁciency of motif discovery and resulting quality of the
motifs identiﬁed in top 500 EWS-FLIl peaks. Refer to the text for more
details. The correct motif consensus gacaGGAAatg is similar to that in
Guillon et a1. (2009).

Funding: Russian Federal Agency for Science and Innovation State
Contract [02.531.11.9003, 02.740.11.5008]; Russian Fund for Basic
Research Project [10-04-92663 to V.J.M.].

Conﬂict of Interest: none declared.

REFERENCES

Bailey,T.L. etdl. (2009) MEME SUITE: tools for motif discovery and searching. Nucleic
Acids Res, 37, W2027 W208.

Chen,X. et al. (2008) Integration of external signaling pathways with the core
transcriptional network in embryonic stem cells. Cell, 133, 110671117.

Favorov,A.V. et al. (2005) A Gibbs sampler for identiﬁcation of symmetrically
structured, spaced DNA motifs with improved estimation of the signal length.
Bioinformdtics, 21, 22402245.

Fejes,A.P. et al. (2008) FindPeaks 3.1: a tool for identifying areas of enrichment
from massively parallel short-read sequencing technology. Bioinformdtics, 24,
172971730.

Georgiev,S. et al. (2010) Evidence-ranked motif identiﬁcation. Genome Biol, 11, R19.

Guillon,N. et al. (2009) The oncogenic EWS-FLIl protein binds in vivo GGAA
microsatellite sequences with potential transcriptional activation function. PLoS
ONE, 4, e4932.

Hu,M. et al. (2010) On the detection and reﬁnement of transcription factor binding sites
using ChIP-Seq data. Nucleic Acids Res, 38, 215L2167.

Ji,H. et al. (2008) An integrated software system for analyzing ChIP-chip and ChIP-seq
data. Nat. Biotechnol, 26, 129371300.

Johnson,D.S. et al. (2007) Genome-wide mapping of in vivo protein-DNA interactions.
Science, 316, 149771502.

Kulakovskiy,I.V. and Makeev,V.J. (2009) Discovery of DNA motifs recognized
by transcription factors through integration of different experimental sources.
Biophysics, S4, 667$74.

Kulakovskiy,I.V. et al. (2009) Motif discovery and motif ﬁnding from genome-mapped
DNase footprint data. Bioinformdtics, 25, 231872325.

Kullback,S. and Leibler,R.A. (1951) On information and sufﬁciency. Ann. Math. Stat,
22, 79786.

Lawrence,C.E. et al. (1993) Detecting subtle sequence signals: a Gibbs sampling
strategy for multiple alignment. Science, 262, 2087214.

Pavesi,G. et al. (2001) An algorithm for ﬁnding signals of unknown length in DNA
sequences. Bioinformdtics, 17 (Suppl. 1), $2077 $214.

Valouev,A. et al. (2008) Genome-wide analysis of transcription factor binding sites
based on ChIP-Seq data. Nat. Methods, 5, 8297834.

 

2623

112 /3.Io's[Bumo[proixosoueuuoiutotqﬂ:duq 11101} popeolumoq

9103 ‘{g isnﬁnv 110::

