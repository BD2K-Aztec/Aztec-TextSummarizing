BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

geiger v2. 0

 

the function fitDiscrete. We have rewritten this function
for geiger v2 . 0, again using an alternative, more efficient algorithm
for calculating the likelihood of observing trait values under a model
(FitzJohn et al., 2009). In the new version of fitDiscrete, the compu-
tational time required for the likelihood calculation scales approximately
linearly with the number of character states, whereas the previous version
scaled superlinearly (see Appendix 2 in Supplementary Material for
details). This improvement allows for more complex models to be
efficiently fit to large phylogenies.

2.2 Bayesian methods for ﬁtting models of character
evolution

A major addition to geiger is the implementation of several Bayesian
methods for fitting models of trait evolution to comparative data. These
include the Accomodating Uncertainty in Trait Evolution Using R
(AUTEUR) approach of Eastman et a]. (2011), which uses reversible
jump Markov chain Monte Carlo machinery (Green, 1995) to move
across multirate models of various complexities. The implementation of
this method in geiger v2 . O improves on the original by allowing
model partitions to be constrained a priori and alternate models to be
compared (Eastman et al., 2013b). Additionally, geiger now includes
the following: a method for fitting models to phylogenies including un-
resolved clades using Approximate Bayesian Computation (Modeling
Evolution of Continuous Characters using Approximate Bayesian
Computation, MECCA; Slater et al., 2012b); a method for including
fossil information as priors on node states (Slater et al., 2012a); and a
posterior predictive simulation approach for assessing the adequacy of
common models of trait evolution (Slater and Pennell, 2013). These types
of approaches, which allow for greater complexity both in models and
data, will be essential to make robust evolutionary inferences from large
comparative datasets.

2.3 Inferring shifts in the rate of lineage diversiﬁcation

Alfaro et a]. (2009) developed an approach, Modeling Evolutionary
Diversification Using Stepwise-AIC (MEDUSA), to detect shifts in diver-
sif1cation rates from molecular phylogenies using a stepwise-Akaike
Information Criteria (AIC) algorithm. A single-rate birth4ieath model
is fit to the entire tree, and then the tree is partitioned into two rate
classes, breaking the tree at all possible nodes. The partition that im-
proves the fit of the model is then fixed and the process is repeated,
breaking the tree into three partitions and so on, until a stopping criterion
is reached. MEDUSA can be applied to both fully bifurcating and unre-
solved trees.

For this release of geiger, the MEDUSA algorithm has been
improved in a number of ways. First, it has been recoded so that it
is now orders of magnitude faster and scales well to large trees;
this version of MEDUSA has already been applied to a phylogeny of
all 9,993 extant bird species (Jetz et al., 2012). Second, we used simula-
tions to develop a threshold-AIC value as a stopping criterion (see
Appendix 3 in Supplementary Material for details) to correct for multiple
comparisonsithe larger the phylogeny, the greater the threshold for ac-
cepting a new partition to the model [a similar approach was developed
by Thomas and Freckleton (2012) for studying variation in rates
of phenotypic evolution]. Last, we have developed tools for
summarizing MEDUSA analyses across a distribution of trees, such
as from a Bayesian posterior or from non-parametric bootstrapping,
so that uncertainty in both topology and branch lengths can
be accomodated.

3 CONCLUSION

In this note we provide a broad overview of the methods now
available in geiger. We have not discussed some methods
implemented in geiger (e.g. ‘Congruification’ for time—scaling
large trees; Eastman et al., 2013a) and many of the nuances
of the methods described here have been left out. We refer read—
ers to associated publications and the package documentation
for more information.

It is an exciting time for macroevolutionary research. We now
have access to datasets of unparalleled size and a wide variety
of new statistical approaches with which to analyze them.
We hope that the software presented here will help researchers
address some fundamental and long—standing questions
in macroevolution.

ACKNOWLEDGEMENTS

The authors are grateful to the large community of researchersi
both method developers and usersiwho have been so generous
with their time and expertise. The authors speciﬁcally thank
Brian O’Meara, Liam Revell, Dan Rabosky, Carl Boettiger,
Jeremy Beaulieu, Dan Wegmann and Simon Uribe—Convers
who gave numerous helpful insights in the development of this
work. The auhtors thank David Posada, Daniele Silvestro
and two anonymous reviewers for comments on this note.

Funding: M.W.P. was supported by a Bioinformatics and
Computational Biology Graduate Fellowship from the
University of Idaho and a National Science and Engineering
Research Council PGS—D Fellowship. This work was also sup—
ported by the National Science Foundation (DEB 0919499,
1208912 and 0918748).

Conﬂict of Interest: none declared.

REFERENCES

Alfaro,M.E. et a]. (2009) Nine exceptional radiations plus high turnover explain
species diversity in jawed vertebrates. Proc. Natl Acad. Sci. USA, 106,
13410713414.

Eastman,J.M. et a]. (2011) A novel comparative method for identifying shifts in the
rate of character evolution on trees. Evolution, 65, 357873589.

Eastman,J.M. et al. (2013a) Congruiﬁcation: support for time scaling large
phylogenetic trees. Methods Ecol. Evol., 4, 688%91.

Eastman,J.M. et al. (2013b) Simpsonian ‘evolution by jumps” in an adaptive radi—
ation of anolis lizards. ArXiv 1305.4216.

Felsenstein,J. (1973) Maximum—likelihood estimation of evolutionary trees from
continuous characters. Am. J. Hum. Genet, 25, 4714192.

FitzJohn,R.G. (2012) Diversitree: comparative phylogenetic analyses of diversiﬁca—
tion in R. Methods Ecol. Evol., 3, 108471092.

FitzJohn,R.G. et a]. (2009) Estimating trait—dependent speciation and extinction
rates from incompletely resolved phylogenies. Syst. Biol., 58, 595%11.

Freckleton,R.P. (2012) Fast likelihood calculations for comparative analyses.
Methods Ecol. Evol., 3, 9407947.

Green,P.J. (1995) Reversible jump Markov chain Monte Carlo computation
and bayesian model determination. Biometriku, 82, 7117732.

Harmon,L.J. et a]. (2008) Geiger: investigating evolutionary radiations.
Bioinformatics, 24, 1297131.

H0,L.S.T. and Ane,C. (2014) A linear—time algorithm for gaussian and non—gaus—
sian trait evolution models. Syst. Biol., 63, 3977408.

 

2217

ﬁm'spzumol‘pmjxo'sopeuuopuorq/ﬁdnq

M.W.Pennell et al.

 

Jetz,W.G. et ul. (2012) The global diversity of birds in space and time. Nature, 491,
444—448.

Pagel,M. (1994) Detecting correlated evolution on phylogenies: a general
method for the comparative analysis of discrete characters. Proc. R. Soc. Lon.
B Biol. Sci, 255, 37415.

Paradis,E. et ul. (2004) Ape: analyses of phylogenetics and evolution in R language.
Bioinformatics, 20, 2897290.

Pennell,M.W. and Harmon,L.J. (2013) An integrative view of phylogenetic
comparative methods: connections to population genetics, community ecology,
and paleobiology. Ann. N. Y. Aeud. Sci, 1289, 9&105.

Slater,G.J. et ul. (2012a) Integrating fossils with molecular phylogenies improves
inference of trait evolution. Evolution, 66, 393173944.

Slater,G.J. et ul. (2012b) Fitting models of continous trait evolution to incom—
pletely sampled comparative data using approximate Bayesian computation.
Evolution, 66, 7527762.

Slater,G.J. and Pennell,M.W. (2014) Robust regression and posterior predictive
simulation increase power to detect early bursts of trait evolution. Svst. Biol.,
63, 2937308.

Thomas,G.H. and Freckleton,R.P. (2012) Motmot: models of trait macroevolution
on trees. Methods Ecol. Evol., 3, 1457151.

 

2218

/810's112um0fp10}x0"sotJBLuJOJutotqﬂ:duq

