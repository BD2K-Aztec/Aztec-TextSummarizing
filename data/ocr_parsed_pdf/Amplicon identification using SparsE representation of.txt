BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

SparsE representation of multiplex PYROsequencing

 

MultiPSQ softwares were recently developed to help researchers
designing and analyzing multiplex pyrosequencing assays
(Dabrowski and Nitsche, 2012; Dabrowski et al., 2013). The
mPSQed software is used to deﬁne pyrosequencing primers,
which generate unique uniplex pyrosequencing fingerprints
and prevent the occurrence of competing signals from SNPs at
different locations. The MultiPSQ software enables the analysis
of multiplex pyrogramTM originating from various pyrosequen—
cing primers. MultiPSQ computes the similarity between multi—
plex pyrosequencing raw data and fingerprints resulting from
any combination of theoretical uniplex pyrosequencing signals
generated from a known sequence. The goal is to select the com—
bination leading to the highest similarity. While MultiPSQ was
claimed to suit the analysis of multiplex pyrosequencing signals
generated by an unrestricted number of sequencing primers for
identifying an unlimited number of polymorphisms, the applica—
tion was practically validated on duplex signals (i.e. pyrosequen—
cing reactions performed with two pyrosequencing primers).

In this study, the new SENATOR method was developed to
improve the nucleotide dispensation order to be used all along
the multiplex pyrosequencing experiment. Irrespective of the
location of the pyrosequencing primer, the dispensation order
is a crucial feature for avoiding similarities between uniplex
pyrosequencing signals. The SENATOR function considers all
unique nucleotide sequences (UNS) expected to be found within
each genomic region of interest, hence improving the selection of
a dispensation order that produces uncorrelated uniplex pyrose—
quencing signals. The global multiplex pyrosequencing signal is
then interpreted using a new signal processing method based on a
sparse representation of the pyrosequencing signal. The problem
solved by sparse representation consists in creating a compact
signal representation in terms of a linear combination of signals
in an over—complete dictionary [i.e. a dictionary including a
number of signals (p) that exceeds the dimension of the signal
space (n)].

Sparse representation was recently used to develop AdvISER—
PYRO, a new method dedicated to the analysis of low pyrose—
quencing signal intensities and complex signals from several
target amplicons (Ambroise et al., 2013). While used for rapidly
identifying mycobacterial species—specific signals after pyrose—
quencing, AdvISER—PYRO showed high prediction perform—
ances. In this article, AdvISER—M—PYRO is used as a modiﬁed
and updated version of original AdvISER—PYRO. AdvISER—
M—PYRO is designed to enable the analysis and interpretation
of multiplex pyrosequencing signals. Considering the steady
increase of extended spectrum beta—lactamase producing bacteria
(ESBL) worldwide and the occurrence of large ESBL—related
outbreaks, a speciﬁc, high—throughput and multiplex DNA—
based identiﬁcation methods would have outstanding clinical
relevance. This new analytical application was therefore selected
as a proof—of—concept for SENATOR and AdvISER—M—PYRO.

In this study, AdvISER—M—PYRO was used to interpret pyrose—
quencing signals generated during quintuplex pyrosequencing ex—
periments (i.e. pyrosequencing reactions performed with ﬁve
speciﬁc pyrosequencing primers) to genotype SNPs within
blaTEM and blaSHV beta—lactamase resistance genes [9]. To the
best of our knowledge, it is the ﬁrst time that quintuplex pyrose—
quencing signals are produced and reliably translated in sequences
corresponding to each of their ﬁve respective targets.

2 METHODS

As a proof-of-concept, the new procedure for improving the selection of
a nucleotide dispensation order and the new signal processing method
were both applied to DNA extracted from four conﬁrmed ESBL clinical
bacteria of three different species (i.e. Escherichia coli, Klebsiella pneumo-
niae, Enterobacter cloacae), and four reference strains (ATCC700603,
ATCC35218, DSM22313 and DSM22314), including three antibiotic-re-
sistant and one antibiotic-susceptible strains. The method was used to
generate and analyze quintuplex pyrosequencing signals resulting from
simultaneous pyrosequencing of 11 unique SNPs distributed through
three and two genomic regions of blaTEM and blaSHV beta-lactamase
resistance genes (Cohen Stuart et al., 2010), respectively. A multiplex
polymerase chain reaction (PCR) was carried out in 50 ul of a reaction
mixture containing the extracted DNA as template, primers and
Power SYBR ® Green reagents (Applied Biosystems, Nieuwerkerk,
The Netherlands). Ampliﬁcation was performed on a 7900HT Fast
Real-Time PCR System (Applied Biosystems, Nieuwerkerk, The
Netherlands). Pyrosequencing was then carried out with a pyrosequencer
PyroMark Q96 ID Sequencer from Qiagen (Hilden, Germany) on PCR
products by using a mixture of the ﬁve pyrosequencing primers.
Dispensed nucleotides produced distinct pyrogramTM peaks, each
peak height being proportional to the number of identical nucleotides
consecutively incorporated.

2.1 SENATOR: SElecting nucleotide dispensATion
ORder

Dispensation of selected nucleotides is carried out all along a pyrosequen-
cing experiment and is absolutely mandatory to produce a pyrosequen-
cing signal. For all uniplex pyrosequencing applications, this order of
dispensation is determined using commercial software. As said above,
this is, however, not applicable when designing multiplex applications.
Consequently, the new SENATOR method was developed for selecting
a suitable nucleotide dispensation order.

In a ﬁrst step, a list was compiled with all UNS expected to be
found within each genomic region of interest (i.e. three well-deﬁned
regions in blaTEM and two in blaSHV genes). Then, a series of dis-
pensation order candidates was randomly generated and each dispen-
sation order was evaluated. Accordingly, all theoretical UNS-based
pyrosequencing signals were generated using an internal R function,
and pairwise correlation coefﬁcients between theoretical pyrosequen-
cing signals were computed to identify the maximum correlation
value. At the end of this analysis, the dispensation order producing
the smallest maximum correlation was selected. Parameters of the
SENATOR function include the length of the dispensation order as
well as the number of dispensation order candidates to be evaluated.
The length of the dispensation order can be chosen by trial and error
but depends on the number of UNSs. When this number increases,
a longer dispensation order is usually required to avoid the occurrence
of perfectly correlated signals between distinct UNSs. If adequately
selected, a longer dispensation order should indeed produce larger dif-
ferences between highly similar UNS signals. On the other hand,
a longer dispensation order increases the turnaround time and cost
of the pyrosequencing reaction. Increasing the number of dispensation
order candidates increases the probability of identifying an optimal
dispensation order but at the expense of longer computational time.
On an Intel(R) Core(TM) i7-2640M CPU  2.80GHz computer, the
computation times for a list of 27 UNS and a dispensation order
including 15 nt were 23 and 46s for 1000 and 2000 candidates, respect-
ively. Considering that SENATOR computation time is low compared
with PCR and pyrosequencing time, it is therefore recommended to
test a sufﬁcient number of candidates.

 

3591

ﬁre'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

J.Ambroise et al.

 

2.2 AdvISER-M-PYRO

In the ﬁrst step, of the AdvISER-M-PYRO algorithm development,
a standardized learning dictionary was created that included theoret-
ical pyrosequencing signals corresponding to all UNSs expected to be
found within each genomic region of interest. For some UNSs, available
experimental pyrosequencing signals (i.e. a signal obtained after
carrying out uniplex pyrosequencing analysis of a gene of interest)
were used to enrich the dictionary. Each experimental pyrosequencing
signal was standardized by dividing the whole signal (i.e. the
global pattern integrating all successive peak heights) by the first
peak height that was representative of the incorporation of a single
nucleotide.

In a second step, the multiplex pyrosequencing signal was
modeled as a sparse representation of the signals from the dictionary.
For the y testing signal of length n, the issue for sparse representa-
tion was to ﬁnd a vector )3 (ﬁj, j = 1, . . . , p) minimizing the following
function:

r! P
Dy.» — Zﬁjxnzwmjnl, (1)
i=1 j=1

where Xi) is i-th element of the j—th signal, llﬁjlll is the L1 —norm of vector
[31- and A is a shrinkage parameter. In this study, the L1— penalty was set
at 0.05 because this value delivered high performance in a previous
application of AdvISER-PYRO (Ambroise et al., 2013). In this study,
all penalized regression models were built using the penalized function of
the corresponding R package (Goeman, 2008). Considering that the
signal contribution of each UNS should have a positive value, an add-
itional constraint imposing this prerequisite was implemented through the
‘positive’ parameter of the penalized function. The sum of regression
coefﬁcients corresponding to each UNS was computed and recorded as
the UNS contribution to the signal. The contributions of each genomic
region to the signal were also computed by summing the corresponding
UNS contributions.

While not implemented with the previous AdvISER-PYRO version,
the third step was a key feature of current AdvISER-M-PYRO. The
main reason is related to the hierarchical structure of the UNS list in
case of multiplex application. Considering that all UNSs belong to a
restricted number of genomic regions, it is therefore required to select
a single UNS for each genomic region. This selection was carried out
by iteratively removing pyrosequencing signals from non-contributive
UNSs from the standardized dictionary. This iterative process was

sequentially applied on each genomic target, starting ﬁrst with those
with the highest contributions. At each iteration, a new penalized
regression model was built and the UNS with the lowest contribution
was identiﬁed and removed to obtain a reduced dictionary. This itera-
tive process was stopped when a single UNS was obtained for each
genomic target.

Finally, UNSs with a contribution lower than the ‘Signiﬁcant
Contribution Threshold’ (SCT) parameter were also removed from the
reduced dictionary. The SCT parameter was ﬁxed at 1 to avoid
false-negative results. However, this low SCT value is likely to result in
false-positive value and UNS contribution <2 were therefore tagged with
an ‘unsafe’ label.

The ultimate step was to build a last penalized regression model with
the ﬁnal reduced dictionary. A correlation coefﬁcient (r) was computed
between predicted values of the penalized regression model and peak
heights of the observed multiplex pyrosequencing signal. Considering
that a low correlation coefﬁcient is indicative of a signiﬁcant difference
between the observed multiplex pyrosequencing signal and the selected
combination of uniplex pyrosequencing signals from the dictionary, this
coefﬁcient was used to assess the global conﬁdence of the predicted UNS
combination.

3 RESULTS

3.1 Nucleotide dispensation order selection

A list of all UNS expected to be found for each genomic region
of interest was ﬁrst compiled (Table 1). Because each genomic
region can either be present or absent and because of the number
of possible variants in each genomic region, the number of dis—
tinct genetic proﬁles in each bacteria can be as high as 5250 in
total (i.e. 5*14*3*5*5).

As all pyrosequencing experiments were designed with reverse
primers only, the reverse complement sequence was computed
for each UNS. SENATOR was used to select a suitable dispen—
sation order by integrating the list of all possible UNSs. Various
lengths (between 10 and 20 with incremental steps of 2) of the
dispensation order were tested and candidates (n = 1000) were
generated and compared for each length. A nucleotide dispensa—
tion order (AGTGCGTACGTACA) of 14 nt was finally selected
as it produced non—correlated uniplex pyrosequencing signals,

Table 1. List of all UNS expected to be found for each genomic region of interest

 

SHV179

SHV238

TEM104

TEM164

TEM238

 

ACGCCCGCGAC
ACGCCCGCGCC
ACGCCCGCAAC
ACGCCCGCGCC

AGCTGGCGAGC
AGCTAGCGAGC
AGCTGCCGAGC
AGCTGGCGAAC
AGCTAGCGAAC
AGCTCCCGAAC
AGCTGGCAAAC
AGCTAGCAAAC
AGCTCCCAAAC
AGCTGGCAAGC
AGCTAGCAAGC
AGCTCCCAAGC
AGCTCCCAAAC

GGTTGAGTACT
GGTTAAGTACT

CTTGATCGTTG
CTTGATAGTTG
CTTGATTGTTG
CTTGATCATTG

TGGAGCCGGTG
TGGAGCCAGTG
TGGAGCCGGTA
TGGAGCCAGTA

 

Note. In each UNS, SNPs are shown with bold black letters.

 

3592

ﬁre'spzumofpmﬂo'sopnuuopnotq/ﬁdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

J.Ambroise et al.

 

Table 2. UNS within the ﬁve genomic regions of the eight bacteria, as determined using Sanger Sequencing and uniplex pyrosequencing

 

 

Strain SHV179 SHV238 TEM 104 TEM164 TEM238
ATCC700603 ACGCCCGCGAC AGCTGCCAAAC 7 7 7

ATCC3521 8 7 7 GGTTGAGTACT CTTGATCGTTG TGGAGCCGGTG
DSM22313 7 7 GGTTAAGTACT CTTGATCGTTG TGGAGCCAGTG
DSM22314 7 7 GGTTAAGTACT CTTGATAGTTG TGGAGCCGGTA
R021 ACGCCCGCGAC AGCTAGCAAGC GGTTGAGTACT CTTGATCGTTG TGGAGCCGGTG
MMA55 ACGCCCGCGAC AGCTAGCAAGC GGTTGAGTACT CTTGATCGTTG TGGAGCCGGTG
B8031 ACGCCCGCGAC AGCTGGCGAAC GGTTGAGTACT CTTGATCGTTG TGGAGCCGGTG
B8035 ACGCCCGCGAC AGCTGGCGAGC GGTTGAGTACT CTTGATCGTTG TGGAGCCGGTG

 

multiplex pyrosequencing but such tuning is likely to result in
overoptimistic results and was therefore not used in the present
proof—of—concept study. While reducing the number of pyrose—
quencing from 40 (uniplex) pyrosequencing reactions down to 11
reactions (i.e. eight quintuplex and three uniplex for conﬁrming
‘unsafe’ tagged results), AdvISER—M—PYRO produced high—
quality results.

3.3 Illustration of AdvISER-M-PYRO

Figure 2 illustrates the results obtained with AdvISER—M—PYRO
when applied on two distinct pyrosequencing signals generated
with resistance genetic determinants from strains DSM22314 and
R021, respectively. When the over—complete dictionary was used,
the pyrosequencing signal generated with former and latter
strains was correctly converted into three (DSM22314, upper
left panel) and ﬁve (R021, upper right panel) corresponding
UNSs. In both cases, the correlation coefﬁcient between pre—
dicted values of the penalized regression model and the 14
values of the pyrosequencing signal was 0.999.

The presence of a new mutation was simulated by removing all
signals corresponding to UNSs TEM238—TGGAGCCGGTG
and TEM238—TGGAGCCGGTA from the dictionary. In both
cases, AdvISER—M—PYRO was prompted to create, from the
library, an irrelevant combination of UNS signals to match the
multiplex pyrosequencing signals (bottom panels of Fig. 2).
Considering the high number of UNSs in each genomic region
characterizing this proof—of—concept study, the irrelevant
combination matched closely the pyrosequencing signal.
Consequently, the correlation coefﬁcient between predicted
values of the penalized regression model and the 14 values of
the pyrosequencing signal remained high (0.994 for DSM22314
and 0.997 for R021). As these conﬁdence values were higher than
those found with some correctly interpreted signals (i.e. 0.991
and 0.996 obtained with correct identiﬁcation of ATCC700603
and MMA55, respectively), the correlation coefficient appeared
to be totally inappropriate to detect such misinterpretation in the
present application.

3.4 Impact of the AdvISER-M—PYRO
enriched dictionary

To assess the impact of having an enriched dictionary, all
multiplex signals were analyzed with a dictionary excluding all

experimental pyrosequencing signals generated by genuine
sample analyses. This reduced dictionary restricted, therefore,
the analysis to a comparison of sample signals with 27 theoretical
pyrosequencing signals. With this limited library, the analysis
produced a high number of uncorrect (15 of 31; 48.4%) and
false—positive identiﬁcations (6 of 9; 66.6%). In addition, all
global conﬁdence indexes were signiﬁcantly reduced (0.848 <R
<0.987).

4 DISCUSSION

Pyrosequencing is a cost—effective DNA sequencing technology
that can be used for genotyping short DNA stretches within
bacterial genomes. When the genotyping application requires
analyzing multiple DNA stretches for diagnostic relevance,
each pyrosequencing reaction must be carried out successively
or in parallel, which increases reagent costs and technician
work load. An alternative would consist in performing multiplex
PCR followed by a multiplex use of pyrosequencing primers but
visual interpretation of the resulting multiplex signals is tedious,
time—consuming and mostly unreliable.

In this study, AdvISER—M—PYRO was, therefore, developed
and used to test the feasibility of analyzing and automatically
interpreting signals resulting from quintuplex pyrosequencing of
SNPs located within blaTEM and blaSHV beta—lactamase resist—
ance genes, all being ﬁrst amplified by multiplex PCR. The huge
(11 = 5250) number of possible genetic proﬁles characterizing
each bacterial strain made this case study highly challenging.
Nonetheless, it enabled us to demonstrate the feasibility and
strengths of the new analytical approach while also clarifying
its potential limitations.

Dealing with a huge number of potential genetic proﬁles cre—
ates the possibility that any new mutation, being by deﬁnition
not yet included in the original dictionary, produces a multiplex
pyrosequencing signal, which may coincidentally match an irrele—
vant combination of UNS signals already present in the library
(as illustrated in bottom panels of Fig. 2). This would unavoid—
ably lead to misleading interpretation of the pyrogramTM, result—
ing in genetic sequences assigned to wrong resistance
determinants. Moreover, the high correlation coefficient between
the recorded signal and model predictions would prevent the
operator from detecting such misinterpretation, but would also
lead to overlooking this yet unidentiﬁed mutation. Occurrence of

 

3594

ﬁre'spzumofpmﬂo'sopnuuopnotq/ﬁdnq

SparsE representation of multiplex PYROsequencing

 

0.991
0.997
0.999
0.999
0.999
0.996
0.999
0.999

R

TEM238
Contribution
0.00

5.58

7.27

3.66

2.61

1.38

1.88

2.47

TGGAGCCGGTG
TGGAGCCAGTG
TGGAGCCGGTA
TGGAGCCGGTG
TGGAGCCGGTG
TGGAGCCGGTG
TGGAGCCGGTG

TEM238
UN8

TEM 164
Contribution
0.00

6.99

7.33

6.97

5.04

2.87

5.29

5.87

CTTGATCGTTG
CTTGATCGTTG
CTTGATAGTTG
CTTGATCGTTG
CTTGATCGTTG
CTTGATCGTTG
CTTGATCGTTG

TEM164

UN8

Contribution
1.14

19.21

18.14

17.69

12.76

11.52

14.04

14.72

TEM104

GGTTAAGTACT
GGTTGAGTACT
GGTTAAGTACT
GGTTAAGTACT
GGTTGAGTACT
GGTTGAGTACT
GGTTGAGTACT
GGTTGAGTACT

TEM104

UN8

8HV238
Contribution

11.71
0.00
0.00
0.00
5.81
8.28
4.74
4.87

AGCTGCCAAAC
AGCTAGCAAGC
AGCTAGCAAGC
AGCTGGCGAAC
AGCTGGCGAGC

8HV238

UN8

8HV179
Contribution
3.81

0.00

0.00

0.00

3.00

2.91

2.93

3.45

ACGCCCGCGAC
ACGCCCGCGAC
ACGCCCGCGAC
ACGCCCGCGAC
ACGCCCGCGAC

8HV179
UNS

 

 

 

Note. For each genomic region, the ﬁrst column corresponds to the identiﬁed UN8, while the second column corresponds to the contribution of this UN8 to the global multiplex pyrosequencing signal. UN8 contributions

Table 3. Results obtained with AdvISER-M-PYRO on multiplex pyrosequencing signals from eight bacterial DNA
lower than two were tagged as ‘unsafe’.

Strain
ATCC700603
ATCC35218
D8M22313
D8M22314
R021
MMA55
B8031

B8035

those issues is, however, less probable when the multiplex pyr—
osequencing application targets a limited number of well—defined,
highly stable and reproducible genetic alterations, such as these
found in human multiple SNP genotyping.

In other applications, a regular update of the dictionary is
compulsory for integrating newly discovered UNSs. In the cur—
rent application, the dictionary was therefore updated to reﬂect
exactly the state of the art, as for today. Deﬁning the upper
threshold for the number of various genetic proﬁles minimizing
the risk of misinterpretation would be highly valuable and
extremely useful when designing new multiplex applications.
This is unfortunately hardly achievable, except on a case—
by—case basis, as too many factors inﬂuence directly the quality
of genotyping results, among which the quality of the
pyrogramTM (i.e. the signal—to—noise ratio), the number of gen—
omic regions targeted in the application, the length of the sig—
nals (i.e. the length of the target sequence that determines
the number of dispensed nucleotides), and the pairwise correl—
ation between uniplex pyrosequencing signals referenced in the
dictionary. The same factors also inﬂuence the optimal number
of genomic regions to be considered in the updated dictionary
for ensuring a reliable multiplex identification of SNPs.
Including more than five genomic regions in a multiplex appli—
cation is perfectly feasible but with an increased risk of ‘unsafe’
results. The respective contribution of each genomic region
in sparse representation of the multiplex result decreases when
additional genomic regions are included. Likewise, the latter
would increase the total number of UNSs, hence the probability
of ﬁnding UNSs that are so similar that they cannot reliably
be discriminated from one another, irrespective of the selected
dispensation order.

In addition to its regular update on the basis of new data from
the literature, the dictionary needs also to integrate experimental
uniplex pyrosequencing signals generated by the analysis of
genuine target samples. In the present study, using a dictionary
only based on theoretical signals, decreased signiﬁcantly the per—
formances of AdvISER—M—PYRO. To be able to include experi—
mental pyrosequencing signals appears therefore to be a clear
and significant beneﬁt of AdvISER—M—PYRO, compared with
the MultiPSQ software. Moreover, the SCT parameter of
AdvISER—M—PYRO enables to discard less contributing UNS,
hence avoiding false—positive results, which can not be prevented
by MultiPSQ.

In summary, an essential prerequisite of AdvISER—M—PYRO
is to build an over—complete dictionary based on a list of all
UNSs expected to characterize the genotyping application, and
to update it regularly if necessary. When a compiled over—
complete dictionary is available, multiplex pyrosequencing
produces highly reliable results, as shown in the current proof—
of—concept study. Most UNSs were correctly identiﬁed and
tagged with a ‘safe label’, enabling to reduce substantially the
total number of pyrosequencing reactions from 40 to 11. This
novel multiplex pyrosequencing approach, which integrates the
selection of the nucleotide dispensation order with SENATOR
and the signals interpretation with AdvISER—M—PYRO reading
software, enables therefore to lower the global turnaround time
of genotyping and to decrease substantially analytical reagent
costs while providing reliable target—speciﬁc results.

 

3595

ﬁlO'SIIZIImOprOJXO'SODBILLIOJLIIOICV/idnq

E8“\Ewowsmgamnnwbxmgna oswbiwbwﬁ

SparsE representation of multiplex PYROsequencing

 

ampliﬁcation with microarray analysis. J. Antimicrob. Cliemother., 65,
137771381.

Dabrowski,P. and Nitsche,A. (2012) mpsqed: a software for the design of multiplex
pyrosequencing assays. PloS One, 7, e38140.

Dabrowski,P.W. et a]. (2013) Multipsq: a software solution for the analysis of
diagnostic n—plexed pyrosequencing reactions. PloS One, 8, e60055.

Deccache,Y. et a]. (2011) Development of a pyrosequencing assay for rapid assess—
ment of quinolone resistance in acinetobacter baumannii isolates. J. M icrobiol.
Mei/1043‘, 86, 1157118.

Goeman,J. (2008) Penalized: ll (lasso) and 12 (ridge) penalized estimation in glms
and in the cox model. R package version 09—21 2008. (Available from
http://cran.rproject.org/web/packages/penalized/index.html.).

Hawkey,P.M. (1998) Action against antibiotic resistance: no time to lose. Lancet,
351, 129871299.

Koontz,D.A. et a]. (2009) Rapid detection of the cyp2a6* 12 hybrid allele by
pyrosequencing® technology. BMC Med. Genet., 10, 80.

Langaee,T. and Ronaghi,M. (2005) Genetic variation analyses by pyrosequencing.
Muiui. Re.\'., 573, 9&102.

Pourmand,N. et a]. (2002) Multiplex pyrosequencing. Nucleic AcidS Rec, 30,
e314331.

Ronaghi,M. (2001) Pyrosequencing sheds light on dna sequencing. Genome Re.\'., 11,
3711.

Ronaghi,M. and Elahi,E. (2002) Pyrosequencing for microbial typing.
J. Chromatogr. B, 782, 67772.

 

3597

/810'sleum0prOJxo'sopBLuJOJuioiq”:duq

