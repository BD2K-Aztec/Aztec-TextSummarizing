ORIGINAL PAPER

Vol. 28 no. 22 2012, pages 2930—2939
doi: 10. 1 093/bioinformatics/bt55 62

 

Gene expression

Advance Access publication September 17, 2012

MeDlP-HMM: genome-wide identification of distinct DNA
methylation states from high-density tiling arrays
Michael Seifert1'2'3'*, Sandra Cortijoz, Maria Colome-Tatche4, Frank Johannes“,

Francois Roudier2 and Vincent Colot2

1Department of Molecular Genetics, Leibniz Institute of Plant Genetics and Crop Plant Research (IPK), Gatersleben,

Germany, 2Institut de Biologie de I’Ecole Normale Superieure, Centre National de la Recherche Scientifique (CNRS),
UMR8197, Paris, France, 3Cellular Networks and Systems Biology, Biotechnology Center of the Technical University
Dresden, Dresden, Germany and 4Groningen Bioinformatics Centre, University of Groningen, Groningen, The

Netherlands
Associate Editor: Trey ldeker

 

ABSTRACT

Motivation: Methylation of cytosines in DNA is an important epigen-
etic mechanism involved in transcriptional regulation and preservation
of genome integrity in a wide range of eukaryotes. Immunoprecipita-
tion of methylated DNA followed by hybridization to genomic tiling
arrays (MeDlP-chip) is a cost-effective and sensitive method for
methylome analyses. However, existing bioinformatics methods only
enable a binary classification into unmethylated and methylated gen-
omic regions, which limit biological interpretations. Indeed, DNA
methylation levels can vary substantially within a given DNA fragment
depending on the number and degree of methylated cytosines. There-
fore, a method for the identification of more than two methylation
states is highly desirable.

Results: Here, we present a three-state hidden Markov model
(MeDlP-HMM) for analyzing MeDlP-chip data. MeDlP-HMM uses a
higher-order state-transition process improving modeling of spatial
dependencies between chromosomal regions, allows a simultaneous
analysis of replicates and enables a differentiation between unmethy-
lated, methylated and highly methylated genomic regions. We train
MeDlP-HMM using a Bayesian Baum—Welch algorithm, integrating
prior knowledge on methylation levels. We apply MeDlP-HMM to the
analysis of the Arabidopsis root methylome and systematically inves-
tigate the benefit of using higher-order HMMs. Moreover, we also
perform an in-depth comparison study with existing methods and
demonstrate the value of using MeDlP-HMM by comparisons to cur-
rent knowledge on the Arabidopsis methylome. We find that MeDlP-
HMM is a fast and precise method for the analysis of methylome data,
enabling the identiﬁcation of distinct DNA methylation levels. Finally,
we provide evidence for the general applicability of MeDlP-HMM by
analyzing promoter DNA methylation data obtained for chicken.
Availability: MeDlP-HMM is available as part of the open-source Java
library Jstacs (www.jstacs.deﬁndex.php/MeDlP-HMM). Data files are
available from the Jstacs website.

Contact: seifert@ipk-gatersleben.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 29, 2012; revised on September 11, 2012; accepted
on September 12, 2012

 

*To whom correspondence should be addressed.

1 INTRODUCTION

Methylation of genomic DNA is one of the best characterized
epigenetic modiﬁcations catalyzed by DNA methyltransferases
that methylate cytosines at their carbon-5 position (Beck and
Rakyan, 2008). In mammals, DNA methylation is found exclu-
sively in the CpG dinucleotide context, except in embryonic stem
cells, where a small proportion of cytosines in other contexts
(CpA, CpT and CpC) are also methylated. In plants, DNA
methylation is found in symmetric CpG and CpHpG and in
asymmetric CpHpH contexts (H=A, T or C). Generally,
DNA methylation plays important roles in regulation of gene
expression (Barlow, 2011; Esteller, 2007; Wutz, 2011;
Zilberman et al., 2007) and silencing of transposons (Law and
Jacobsen, 2010; Teixeira and Colot, 2010).

Despite recent developments of next-generation sequencing
approaches for determining methylomes at single base pair reso-
lution (e.g. Cokus et al., 2008; Lister et al., 2008, 2009), methy-
lomes of different organisms or cell tissues are also frequently
analyzed using whole-genome tiling arrays (e.g. Borgel et al.,
2010; Natt et al., 2012; Zilberman et al., 2008), which provide
cost-effective alternatives. Most array-based studies are
done based on methylated DNA immunoprecipitation coupled
with hybridization to a tiling array (MeDIP—chip) (Beck and
Rakyan, 2008; Harrison and Parle-McDermott, 2011).
MeDIP—chip enables to analyze the methylome of a genome at
a resolution of few hundred base pairs, which in most applica-
tions is sufﬁcient to draw biologically meaningful conclusions.

The analysis of MeDIP-chip data puts similar challenges on
bioinformatics methods, as identiﬁed for the analysis of closely
related array-based chromatin immunoprecipitation data
(ChIP—chip). Different methods for the analysis of ChIP—chip
data were proposed over the last years. Especially, methods
based on hidden Markov models (HMMs) (e.g. Humburg
et al., 2008; Ji and Wong, 2005; Seifert et al., 2009) and on mix-
ture models (e.g. Banaei et al., 2011; Johannes et al., 2010;
Martin-Magniette et al., 2008) were shown to enable reliable
predictions of chromosomal target regions of transcription fac-
tors or histone modiﬁcations. A common characteristic of all
these methods is the modeling of two different populations of
measurements to differentiate non-enriched genomic regions
from enriched ones. Main conceptual differences exist in the

 

2930 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og anﬁnV uo ::

HMM-based analysis of DNA methylation profiles

 

way of modeling dependencies between adjacent measurements
on a chromosome, in handling of replicates and in training al-
gorithms. From these methods, only approaches based on
HMMs integrate dependencies between directly adjacent meas-
urements on a chromosome. Some methods only enable a sep-
arate analysis of replicates (e.g. Humburg et al., 2008;
Martin-Magniette et al., 2008; Seifert et al., 2009), whereas
others try to improve the analysis by simultaneous modeling of
replicates (e. g. Banaei et al., 2011; Ji and Wong, 2005; Johannes
et al., 2010). Mixture models are typically trained by speciﬁcally
designed expectation maximization (EM) algorithms (Dempster
et al., 1977). HMM-based methods except TileMAPHMM
(Ji and Wong, 2005) and HMMs by Seifert et al. (2009) use a
BaumiWelch training (Baum, 1972), representing a special case
of an EM algorithm. TileMAPHMM is based on data-dependent
ad hoc settings, and HMMs by Seifert et al. (2009) enable the
integration of prior knowledge on measurements using a
Bayesian BaumiWelch algorithm.

All these methods are useful tools for the analysis of
ChIP-chip data. Additionally, some methods like ChIPmix
(Martin-Magniette et al., 2008) and a mixture-model approach
by Johannes et al. (2010) have already been applied to the ana-
lysis of MeDIP—chip data. One general limitation of all these
methods in the context of MeDIP—chip data analyses is that
they only enable a binary classiﬁcation into unmethylated and
methylated regions. MeDIP—chip data is known to be more com-
plex, showing differences in methylation levels of individual
chromosomal regions as, for example, revealed for Arabidopsis
thaliana having moderately methylated genes and highly methy-
lated transposons (Zilberman et al., 2008). To address that, a
three-state HMM specifically designed for the analysis of
Arabidopsis MeDIP—chip data has been developed in a compan-
ion work by Cortijo et al. (2012). This approach uses
Arabidopsis-speciﬁc ad hoc settings and enabled a better inter-
pretation of MeDIP—chip data using a classiﬁcation of methyla-
tion states of genomic regions according to the underlying three
states. Generally, organism-speciﬁc ad hoc settings can only be
hardly transferred to MeDIP—chip data of other organisms.
Thus, there is still a great demand of having a general method
that is able to differentiate between different methylation levels
without being dependent on a speciﬁc organism. Moreover, a
systematic performance evaluation of different methods for ana-
lyzing DNA methylation data has not been carried out up to
now, and current HMM-based methods only focus on standard
ﬁrst-order HMMs.

Here, we present MeDIP—HMM, a method speciﬁcally
designed for the analysis of MeDIP—chip data. MeDIP—HMM
utilizes three states to differentiate between unmethylated,
methylated and highly methylated regions overcoming limita-
tions of typically used ChIP—chip methods only enabling a
binary classiﬁcation into unmethylated and methylated regions.
Additionally, MeDIP—HMM can perform a simultaneous ana-
lysis of replicates and integrates prior knowledge on measure-
ments to improve the identiﬁcation of methylated genomic
regions. Moreover, MeDIP-HMM can also take advantage of
higher-order hidden Markov chains to improve spatial modeling
of dependencies between neighboring regions. This has recently
been found to improve the analysis of comparative genomics
data (Seifert et al., 2012) and provides a valuable option for

improving the analysis of MeDIP-chip data. We apply our
MeDIP—HMM to the analysis of the Arabidopsis root methy-
lome and systematically evaluate the inﬂuence of using
higher-order Markov chains on the identiﬁcation of methylated
genomic regions. We further perform an in-depth comparison
study to widely used existing methods and demonstrate advan-
tages of using MeDIP—HMM based on comparisons to current
knowledge on the Arabidopsis methylome. We also show that
MeDIP—HMM can be applied to non-Arabidopsis data by per-
forming an additional study on promoter DNA methylation data
obtained for chicken (Natt et al., 2012).

2 METHODS

In this section, we initially describe our root methylome data. Then, we
provide the mathematical background of MeDIP-HMM. Finally, we
consider publicly available data for model evaluations.

2.1 Arabidopsis root methylome dataset

We performed a MeDIP-chip experiment to identify genomic regions that
are methylated in root tissue of the accession Col-0 of the ﬂowering plant
A.thaliana according to the experimental protocol described by Cortijo
et a]. (2012). The dataset is publicly available from GEO (GSE36750).
This dataset represents log ratios of ﬂuorescent intensities of immuno-
precipitated methylated DNA versus reference input DNA measured for
T: 711320 genomic regions in two biological replicates. We applied
quantile normalization (Bolstad et al., 2003) to the log ratios of both
replicates and summarized the resulting normalized log ratios of each
replicate in chromosome-speciﬁc methylation proﬁles. This leads to a
methylation proﬁle 5(k) := (251(k), ...,5Tk(k)) for each chromosome
k e {1, . . . , 5} containing chromosome-speciﬁc measurements
5,(k) := (0,1(k),ot2(k)) of both replicates in increasing order of their
chromosomal positions. Thus, each methylation level 5,(k) of a region
t e {1, . . . , Tk} is represented by the corresponding normalized log ratios
0,1 (k) and 0,2(k) measured in replicates 1 and 2, respectively. A histogram
of average methylation levels is shown in Figure 1a. Measurements of
both biological replicates are highly reproducible, reaching a Pearson
correlation coefficient of 0.92 (Supplementary Fig. Sla).

2.2 MeDIP-HMM: HMM for MeDIP-chip analyses

We use a three-state HMM with state-speciﬁc multivariate Gaussian
emission densities to analyze methylation levels of chromosomal regions
in methylation proﬁles. Motivated by the distribution of methylation
levels in Figure 1a, three states S := {’U’,’M’,’I’} are deﬁned to model
distinct classes of methylation states. State ’U’ models unmethylated
regions characterized by log ratios of about or much less than zero.
Highly methylated regions having log ratios much greater than zero are
modeled by state ’M’. Methylated regions having log ratios in between
unmethylated and highly methylated genomic regions are modeled by
state ’I’. These states are the basis of the fully connected three-state archi-
tecture of the HMM shown in Supplementary Figure S2.

More formally, the state of a region t on chromosome k is denoted
by q,(k) e S. To account for correlations between measurements of
closely adjacent regions on a chromosome, a state sequence
Zj(k) := (111(k), . . . , 113(k)) underlying a methylation proﬁle 5(k) is mod-
eled by a homogeneous Markov model of order L (e.g. Berchtold and
Raftery, 2002). Thus, the state-transition process of an HMM of order
L 3 1 is parameterized by an initial state distribution 2? := (21,-),ES with
initial stateprobability :1,- e (0, 1) and a set of stochastic transition matrices
A := {A1, ...,AL}. The initial state distribution fulﬁlls the constraint
2,65 :1,- = 1. Each transition matrix A, := (aij)iesl,jES E A with 1 5 l 5 L
speciﬁes the transition probability ail- e (0, 1) for each transition from the

 

2931

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

9103 ‘Og anﬁnV uo ::

M. Seifert et al.

 

(a) Root Methylome (b) Methylation Candidates

30 10
MC) m0
E20 E
3'- :1
8 8 s
S 3
31” g
L: L:
o u
-4 -2 o 2 4 .4 .2 o 2 4
Log-Ratio Log-Ratio

Fig. 1. Overview of measurements in the Arabidopsis root methylome
dataset. (a) Histogram of average methylation levels measured in root
tissue using two biological replicates. Three groups of methylation levels
are observed comprising unmethylated genomic regions with log ratios
much less than zero peaking around —1.0, highly methylated genomic
regions with log ratios much greater than zero peaking around 2.0 and
genomic regions having methylation levels between unmethylated and
highly methylated regions peaking around 1.0. (b) Histogram of average
methylation levels of genomic regions in the root methylome dataset that
has been labeled as potential candidates for DNA methylation based on
an initial study by Zilberman et a]. (2008). The distribution of measured
methylation levels for the candidate regions is clearly shifted into the
positive range of log ratios peaking at log ratios of about 2.0. This
strongly indicates that candidate regions of DNA methylation from
Zilberman et a]. (2008) are also present in our root methylome dataset.
This motivates the usage of these information for evaluating different
methods for MeDIP-chip analyses

current state i, of a state-context i = (i1, . . . , 1,) e S’ to a next state j e S.
Thus, this means that, for l> 1, transitions from i, are depending on its
1 — 1 predecessors i1, . . . , ilzl. Hence, a transition matrix A, with 1 5 l<L
is used for the transition from the current state q,(k) to the next state ql+1 (k)
under consideration of the l — 1 predecessor states 111(k), . . . , q,,1(k). The
transition matrix A L e A is used for each transition from q,(k) to q,+1(k)
for all regions t 3 L in dependency of the complete memory on L — 1
predecessor states (1,, L+1(k), . . . , q,,1(k). Finally, each A, e A also fulﬁlls
the constraint 21.65 a,, = 1 for each i e S’.

Practically, only small model orders should be considered due to an
exponential increase of transition parameters with increasing model
order, leading to higher computational complexities and potentially over-
ﬁtted models. Thus, different studies in other domains mainly focused on
second-order HMMs (e.g. Eng et al., 2009; Mari et al., 1997) or
developed different strategies to obtain parsimonious models (e.g. du
Preez, 1998; Seifert et al., 2012; Wang, 2006). For our approach, the
most parsimonious model is obtained for L = 0. This reduces the
HMM to a mixture model (e. g. Bilmes, 1998) that does not model depen-
dencies between measurements.

Generally, the state sequence [j(k) underlying a methylation proﬁle
5(k) is unknown. To enable the inference of a state sequence, measure-
ments contained in a methylation proﬁle must be integrated into the
HMM by making use of state-speciﬁc emission distributions. The usage
of univariate Gaussian emission distributions represents a common
choice for HMM-based analyses of single ChIP-chip experiments (e.g.
Li et al., 2005; Seifert et al., 2009). Similar to Johannes et a]. (2010),
we extend this assumption by using multivariate Gaussian emission dis-
tributions, enabling the simultaneous analysis of replicates of an experi-
ment. Thus, a methylation level 5 := (01, . . . , 0") that represents the log
ratios of a region measured in d replicates is modeled under state i e S of
the HMM by the state-speciﬁc Gaussian emission distribution

1
Jan)" det(2,)

12,-(22) := exp(— $07 — iii) A 2,71 ‘(5 — W)

with mean vector [1, 6 [Rd and covariance matrix 2, 6 Rd”. Here, the
determinant of the covariance matrix is denoted by det(2,), where 2,71
represents the inverse of the covariance matrix, and the transpose vector
of (5 — [1,) is given by (5 — [1,)T. The emission parameters of all states of
the HMM are summarized by B := ([1,, 2,),65. All parameters of the
HMM are denoted by A := (2?, A,B). The underlying state-space model
highlighting dependencies modeled between states and emissions is illu-
strated in Supplementary Figure S3 for a second-order HMM.

To quantify the methylation status of a genomic region, the HMM is
used to compute the probability that a region t in methylation proﬁle 5(k)
is modeled by a state i e S. The corresponding state-posterior probability
yﬂi) := P[q,(k) = i | 5(k), A] is computed by the forward-backward algo-
rithm adapted to higher-order HMMs (e.g. Seifert, 2010). These
state-posterior probabilities allow to decode the most likely underlying
methylation state of each region. Additionally, the state-posterior prob-
abilities enable a ranking of genomic regions according to their probabil-
ities of being methylated (’I’ or ’M’) using the probability 1 — yﬂ’U’) as
score.

2.3 Integration of prior knowledge

The integration of prior knowledge on the distribution of measurements
enables a problem-speciﬁc characterization of model parameters.
Especially, the modeling of prior knowledge on emission parameters
can substantially improve HMM-based predictions compared with pre-
dictions of HMMs ignoring prior knowledge during training (Seifert
et al., 2011). For that reason, a prior distribution for an HMM
A := (2?,A, B) is deﬁned by

PHIQl3=D1(7?|®1)‘D2(A|®2)‘Da(3|®3) (1)

given speciﬁc hyperparameters ® :2 (@1, @2, @3). This prior represents a
product of independent conjugate priors for each class of model param-
eters, enabling analytical parameter estimations and integration of prior
knowledge during model training.

Following the usual choice of prior distributions for initial state and
transition parameters (e.g. Durbin et al., 1998; Seifert et al., 2011, 2012),
the prior 01(2? | @1 ) for the initial state distribution is given by a
Dirichlet distribution, and the prior 02(A | @2) for the set of transition
matrices is speciﬁed by products of Dirichlet distributions. Appendix A of
the Supplementary Material provides details to both prior distributions
and chosen hyperparameters.

For the state-speciﬁc multivariate Gaussian emission densities enabling
simultaneous modeling of measurements of replicates of an experiment,
we use a Gaussian7Wishart prior to integrate prior knowledge on differ-
ent methylation levels. This choice is motivated by Gauvain and
Lee (1994) introducing this prior into HMM-based speech recognition.
We transfer this to HMM-based modeling of multivariate MeDIP-chip
data. Thus, the prior distribution for the emission parameters is a
product of state-speciﬁc independent Gaussian7Wishart distributions
deﬁned by

03(3 1 e3) oc H det(2f1)’_ii;d . exp(—%tr(9, . 2,3)
iES

‘exp(_;(ﬂi — ﬁi) ‘ 2,71 ‘(ﬂi — 770T)

with hyperparameters @3 := (77,, 6,, S2,, r,),-ES. Here, 77, 6 [Rd speciﬁes an a
priori mean vector for methylation levels modeled by state i e S, and
e, e [R+ deﬁnes a corresponding scaling factor of the a priori mean
vector weighting its strength of inﬂuence on the state-speciﬁc mean
vector [1, during training. Similarly, Q, 6 Rd” is a positive deﬁnite
scale matrix for the covariance matrix 2, of state i, and r,>d — 1 is a
scaling parameter for 2,. Additionally, tr(S2, > 2,71) speciﬁes the trace of
the matrix product S2, > 2,71.

The inﬂuence of the emission prior on the estimation of emission par-
ameters is shown in the following section. Details to chosen prior

 

2932

112 /310's1tzu1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g anﬁnV uo ::

HMM-based analysis of DNA methylation profiles

 

hyperparameters for the analysis of the MeDIP-chip data are given in the
section model initialization.

2.4 Bayesian Baum—Welch training

The adaptation of the HMM parameters to the MeDIP-chip data is done
by a Bayesian Baum:Welch training outlined in Seifert et a]. (2011) for
HMMs with univariate Gaussian emission distributions. This training
algorithm is a special case of an EM algorithm (Dempster et al., 1977),
enabling the integration of prior knowledge. Based on a choice of
initial model parameters, the Bayesian Baum:Welch algorithm iteratively
maximizes the posterior density (product of likelihood and prior
distribution) of the model parameters given a dataset, reaching at
least a local optimum in dependency of the initial parameters. This is
usually done in log space by successively computing updated HMM
parameters

A(h + 1) = arg mAaMQUv | A(h)) + log(P[?~ | 91))

maximizing the sum of Baum’s auxiliary function Q(A | A(h))
(see Appendix B, Supplementary Material) and the logarithm of the
prior distribution P[A | G] in Equation (1). This enables an iterative es-
timation of the new HMM parameters A(h + 1) under consideration of
current parameters A(h) (for h = 1 initial HMM) until the log posterior
grows less than a predeﬁned threshold. Here, we use a threshold of 10’3
for two successive iterations.

Details to the estimation of initial state and transition parameters are
given in Appendix B of the Supplementary Material. Since we make use
of state-speciﬁc multivariate Gaussian emission densities in combination
with a Gaussian:Wishart prior, estimation formulas of the state-speciﬁc
mean vector [1, and the corresponding covariance matrix 2, are given in
the following. Detailed derivations of these formulas are outlined in
Appendix B of the Supplementary Material.

Considering the iteration step h of the Bayesian Baum:Welch training,
the mean vector of the multivariate Gaussian emission density of state
i e S is given by

K 17. _. _.
Z Z (Mk) ‘  + Eini
—~(_h+1) ._ :1 1:1

I _ K 17.
(Z 2 mo) + 
k:1 2:1
with respect to the measured methylation level 5,(k), the state-posterior
probability yt"(i) := P[q,(k) = i | 5(k), A(h)] under the current model A(h),
and the state-speciﬁc a priori mean vector 77, with its scaling factor 6,
speciﬁed by the Gaussian:Wishart prior. The corresponding state-speciﬁc
covariance matrix

K a.
2 14010.11.) + EiVi + 9,-
2(_h+1) : :1 2:1
I K T,
(Z Eyre) +r,- — d

k:1t:1
is computed based on the state-posterior ytl‘(i) under the
current model A(h) and two state-speciﬁc
matrices O,,;( := (5,(k) — [1Eh+l))T > (5,(k) — [1Eh+l)) 6 Rd” and
V, := ([1EhH) — 77,)T >([1§h+1) — [1,) 6 Rd“. The a priori mean vector 77,,
the scale matrix Q, and the scaling factor r, are speciﬁed by the

state-speciﬁc Gaussian:Wishart prior.

The obtained parameter estimation formulas for the mean vector and
the covariance matrix generalize the estimation formulas for multivariate
Gaussian emission densities typically used in the standard Baum:Welch
training that does not enable the integration of prior knowledge (e.g.
Bilmes, 1998). A computational scheme summarizing the main steps of
the Bayesian Baum:Welch training is given in Appendix B of the
Supplementary Material.

2.5 Model initialization

To enable the identiﬁcation of distinct DNA methylation states from
MeDIP-chip data, an initial HMM is speciﬁed in a data-dependent
manner. We use the following heuristic approach to set the initial
model parameters.

Initially, the user has to specify the model order L and rough estimates
of expected proportions JT/U/ 6 (0,1) and 111M 6 (0,1) of unmethylated
and highly methylated genomic regions in an experiment. Here, a histo-
gram or a cumulative density plot of measured methylation levels helps to
select these proportions. Alternatively, these proportions can also be
chosen based on prior knowledge from previous experiments. Based on
that, the initial state distribution is set to 1? := (IT/U, 1111/, 111M) with
1111/ := 1 — JT/U/ — 111M. Additionally, the initial transition matrix
A, := (a,,-)Ljes is deﬁned to have a stationary distribution identical to 1?
by using state-speciﬁc diagonal and non-diagonal elements a,, := 1 — s/rr,
and a,, := s/(21'r,) with respect to s e (0, min{1'r/U/, 1111/, n/M/}) for control-
ling the state durations (default s = 0.05). For transition matrices
A, := (a,,),ESiJ-Es with 1 <1 5 L, we initially set a,, := a,,,- for each
state-context i := (i1, . . . , i,) to the value of the corresponding transition
probability a,,, deﬁned for A1. These settings realize that the
state-transition process of the initial HMM is modeling the speciﬁed pro-
portions of unmethylated and highly methylated genomic regions.

In addition to this, the states of the initial HMM need to be character-
ized by speciﬁc Gaussian emission densities to enable the differentiation
of methylation levels. For realizing this, average methylation levels of
genomic regions are initially computed based on all replicates of an ex-
periment. The resulting distribution of average methylation levels is fur-
ther divided into three parts by computing data-dependent quantiles Qmu,
and Qmu,+,,,l, for the corresponding initial proportions JT/U/ and 1111/.
These two quantiles are used to obtain the following partitioning in
which unmethylated genomic regions are assumed to have average methy-
lation levels less than Qmu, , highly methylated genomic regions are
assumed to have average methylation levels greater than Qmu,+,,,l, and
less strongly methylated genomic regions are assumed to have average
methylation levels between Qmu, and Qmu,+,,,l,. For these three groups,
the mean values [1,/U, [111/ and [1,/M, and the standard deviations mm, 011/
and 0M are computed for the corresponding averaged methylation levels.
Additionally, Pearson’s correlation coefﬁcients R/U/(v, w), R/I/(v, w) and
R/M/(v, w) of methylation levels between each pair of replicates (v, w) with
1 5 v, w 5 d and v 7e w are computed for the three groups. Based on
these precomputations, the initial mean vector [1, of each state i e S is
set to [1, := ([1,, . . . , [1,) using the precomputed mean value [1,. The cor-
responding covariance matrix 2, := (o,(v, w)) with 1 5 v, w 5 d is speci-
ﬁed by diagonal elements o,(v, v) := 0,2 and by non-diagonal elements
o,(v, w) := 0,2 >R,(v, w) based on the precomputed standard deviation 0,
and the correlation coefﬁcient R,(v, w). These initial emission parameters
realize an appropriate characterization of the three HMM states for iden-
tifying distinct classes of methylation levels.

All initially chosen model parameters are further reﬁned during the
Bayesian Baum:Welch training using precomputed data-dependent prior
knowledge. This is done by setting each a priori mean vector 77, := [1, for
modeling the methylation levels under state i e S to the initially com-
puted state-specific mean vector [1,. The corresponding scaling factor is
speciﬁed by e, := 11, > Trepresenting the number of measurements initially
assumed to be modeled by state i. The scale matrix of the covariance
matrix of state i is set to S2, := T/ 100 > Z, in dependency of the precom-
puted covariance matrix 2, weighted by 1% of the total number of meas-
urements. The corresponding scaling parameter is set to r, := 11, > T.

The approach for setting the initial parameters of the HMM and for
specifying the parameters of the prior distribution has been tested on
different MeDIP-chip datasets of root and shoot tissue for varying
user-speciﬁed proportions JT/U/ and 111M. The performance of the resulting
identiﬁcation of methylation levels by HMMs trained based on these
initial settings was found to be robust (e.g. Supplementary Table S1

 

2933

112 /3.10's112u.1n0fp.101x0"$01112u1101u101q/ﬁd11q 111011 pap1201umoq

9103 ‘0g anﬁnV uo ::

M. Seifert et al.

 

for four different initializations on root data). Some more general hints
considering the initialization are summarized in Appendix C of the
Supplementary Material.

Motivated by the mapping of candidate regions of DNA methylation
from Zilberman et al. (2008) to our tiling array, we use JT/U/ = 0.8 and
111M 2 0.1 for all studies and investigate models of order zero up to four.

2.6 Publicly available data for model evaluations

The methylome of Arabidopsis roots has initially been studied on a
genome-wide scale by Zilberman et al. (2008). This study used a tiling
array with 382178 tiles, which is less dense than the tiling array platform
that we used for our experiments. Still, genomic regions quantiﬁed as
being methylated in this study provide a useful resource for evaluating
the performance of different methods for MeDIP-chip analyses, because
they also analyzed the accession Col-0. For that purpose, we downloaded
the corresponding two DNA methylation proﬁles from GEO
(GSM307382, GSM307384) and applied quantile normalization to the
log ratios of both experiments. We then averaged both log ratios mea-
sured for each genomic region and determined all chromosomal seg-
ments, consisting of successive genomic regions with an average log
ratio greater or equal than one. This restrictive log-ratio cutoff ensures
that only strongly enriched genomic segments are considered as potential
targets of DNA methylation. This led to 18 061 potential candidate seg-
ments of DNA methylation widespread across all chromosomes of
A.thaliana. These segments were mapped back to the 711320 genomic
regions present on our tiling array. Based on this mapping, each genomic
region that was at least partially covered by one of the candidate seg-
ments has been labeled as a putative candidate for DNA methylation in
root tissue. This resulted in 156091 genomic regions being potential can-
didates for DNA methylation (22% of regions present on our tiling
array). The remaining 555229 genomic regions are potential candidates
for being unmethylated.

To demonstrate the value of using this public dataset to evaluate
potential candidates of DNA methylation in our root methylome data,
the distribution of measured methylation levels of genomic regions
labeled as being methylated is shown in Figure 1b (see Supplementary
Fig. Slb for a bivariate density plot). Most of these genomic regions have
log ratios clearly greater than zero peaking at about 2.0. Thus, genomic
segments identiﬁed as being potential candidates of DNA methylation in
the Zilberman et al. (2008) data are also present in our root methylome
dataset and can be used as a useful resource for comparisons of different
MeDIP-chip analysis methods.

3 RESULTS AND DISCUSSION

In this section, we first investigate the effect of using higher-order
MeDIP-HMMs for analyzing the Arabidopsis root methylome.
We next perform a systematic comparison study to existing
methods and analyze predictions of MeDIP-HMM in the con-
text of the Arabidopsis genome annotation. Finally, we show an
application of MeDIP—HMM to publicly available promoter
DNA methylation data obtained for chicken.

3.1 Comparison of MeDIP—HlVIMs of different
model orders

To compare the inﬂuence of different model orders on the iden-
tification of methylated genomic regions by MeDIP-HMMs, we
analyzed our root methylome dataset with respect to methylated
regions from Zilberman et al. (2008). We initially trained
MeDIP-HMMs of orders zero up to four on our root methylome
data. For each model, we next ranked all genomic regions

     
  
    
 

(a) (b)
0.72 0.9
I 0.8
n:
:1 0.67 E _
'— 07 — 333511
— HMM(Z]
I Will?
0.62 0-6 "
0 1 2 3 4 0.00 0.03 0.05
Model Order FPR

Fig. 2. Evaluation of identiﬁed known candidate regions of methylation
by MeDIP-HMMs of different model orders. (a) TPRs obtained at a
ﬁxed FPR of 1.5%. The greatest improvement is reached for the transi-
tion from a zero-order model to a ﬁrst-order model, leading to a more
than 7% increase in TPR. The second-order MeDIP-HMM reaches the
best TPR among all models. (b) Part of ROC curves up to an FPR of 6%
comparing different MeDIP-HMMs. HMM(L) denotes the correspond-
ing MeDIP-HMM of order L. The second-order MeDIP-HMM (red)
reaches the best TPRs at small FPRs

according to their probabilities of being methylated (’I/ or /M/)
as described in the methods section. Based on that, we computed
for each MeDIP-HMM the corresponding true-positive rates
(TPRs) of identiﬁed methylated regions reached at different
levels of ﬁxed false-positive rates (FPRs). The performance of
the different MeDIP—HMMs at small FPRs is shown in Figure 2.

The largest improvement in the identiﬁcation of known can-
didate regions of DNA methylation is achieved by the transition
from order zero to order one. The zeroth-order MeDIP-HMM
represents a mixture model of multivariate Gaussians that does
not enable the modeling of dependencies between measurements
in close chromosomal proximity. This is overcome by the
first-order MeDIP-HMM capable of modeling dependencies be-
tween measurements of directly adjacent chromosomal regions.
Moreover, an additional increase in performance is reached by
the second-order MeDIP-HMM that extends the first-order
model by realizing dependencies between two directly adjacent
regions to identify the state of the next region. This is exemplarin
shown in Figure 2a for a fixed FPR of 1.5% and also observed
among the small FPRs considered in Figure 2b. MeDIP—HMMs
of order three and four did not reach the performance of the
second-order model. These two models identified methylated
regions only slightly better than the ﬁrst-order MeDIP-HMM
potentially due to overﬁtting caused by exponentially growing
numbers of transition parameters. All these ﬁndings are also
supported by performance evaluations based on different train-
ing and test sets (Supplementary Table S2).

In summary, the transition from a mixture model to an HMM
has led to the largest improvement in the identification of methy-
lated genomic regions. Overall, the second-order MeDIP—HMM
reached the best performance among all considered models.
We focus on this model in the following studies.

3.2 Comparison of MeDIP-HMM to existing methods

To compare the second-order MeDIP-HMM against other exist-
ing methods, we again utilize our root methylome dataset and
known potential candidate regions of DNA methylation
obtained from Zilberman et al. (2008). In recent years, especially,

 

2934

112 /3.10's112u.1n0fp.101x0"$01112u1101u101q/ﬁd11q 111011 pap1201umoq

9103 ‘0g anﬁnV uo ::

HMM-based analysis of DNA methylation profiles

 

methods based on mixture models (e.g. Banaei et al., 2011;
Johannes et al., 2010; Martin-Magniette et al., 2008) and meth-
ods based on HMMs (e.g. Humburg et al., 2008; Ji and Wong,
2005; Seifert et al., 2009) were developed for the analysis of
ChIP-chip data to enable reliable identiﬁcations of chromosomal
target regions of transcription factors or histone modiﬁcations.
Because the analysis of ChIP-chip data is closely related to that
of MeDIP-chip data and Johannes et al. (2010) have already
shown that mixture models can be used to analyze DNA methy-
lation data, we compare the identiﬁcation of known candidate
regions of methylation against these different methods. We also
include the three-state HMM speciﬁcally developed for the ana-
lysis of Arabidopsis MeDIP-chip data described in a companion
work by Cortijo et al. (2012) into the comparison. This model
uses the observation that introns of protein coding genes are
usually unmethylated in Arabidopsis. Based on that, MeDIP-
chip data is rescaled and state-speciﬁc emission functions are
estimated with respect to biological constraints customized for
Arabidopsis. Two state-speciﬁc Gaussian emission densities with
ﬁxed means and equal variances are used to model probes with
high or low methylation levels, whereas a mixture of 30
Gaussians with ﬁxed variances is used to model unmethylated
probes based on the measurement distribution obtained from
intronic probes. The estimation of 30 Gaussians is done exter-
nally, and the obtained parameters are used as fixed emission
parameters for the unmethylated state. This approach cannot be
directly transferred to other organisms like human, where introns
are usually found to be methylated (Lister et al., 2009).

The ﬁrst four columns of Table 1 provide more detailed infor-
mation about the considered methods. Conceptionally, our
MeDIP—HMM is speciﬁcally designed for the analysis of
MeDIP—chip data by making use of three distinct states to
enable the differentiation between different degrees of methyla-
tion. Except for CortijoHMM (Cortijo et al., 2012), this cannot

be realized by all the other methods that only perform a binary
classiﬁcation into unmethylated and methylated regions.
Additionally, MeDIP-HMM also enables the modeling of
higher-order dependencies, which has not been addressed by
other methods so far.

All methods listed in Table l were analyzed for their ability to
identify the potential candidate regions of DNA methylation in
our root methylome dataset. The methods were adapted
to the data using their standard initialization and training algo-
rithms. User-deﬁned settings were required to obtain an initial
StandardHMM (Seifert et al., 2009) and an initial
JohannesModell (Johannes et al., 2010). For both models, the
initial parameter settings of the ﬁrst-order MeDIP-HMM have
been transferred by taking into account that these models only
differentiate between unmethylated and methylated regions. This
was done using average initial parameter values of states /I/ and
/M/ modeling methylations in MeDIP-HMM to initially specify
the state representing methylated regions in StandardHMM and
JohannesModell. The settings for the state modeling unmethy-
lated regions were directly transferred.

The time and memory complexity for analyzing a methylation
profile of length T by a MeDIP-HMM of order L during one
training step is given by 0(T- NL“) with respect to N = 3 states.
For each of the T measurements, all possible NLJr1 state transi-
tions must be considered. Thus, the complexity is mainly domi-
nated by the extended state-transition process involving the
last L predecessor states to determine the next state
(e. g. Supplementary Fig. S3). This time and memory complexity
can also be transferred to the mixture models (L = 0) and the
ﬁrst-order HMMs (L = l) in Table 1.

To quantify the potential of genomic regions of being methy-
lated, corresponding scores based on state-posterior probabilities
were provided by each of the different methods. A score close to
one indicates that the corresponding genomic region is a

Table 1. Performance comparison of different methods applied to the analysis of the MeDIP-chip root methylome dataset

 

 

Method Model SIM Training Reference TPR at AU-ROC AU-PRC Run time
1% FPR
MeDIP-HMM HMM Yes Bayesian BW This manuscript 0.66 0.98 0.93 637 s
CortijoHMM HMM No Constrained BW Cortijo et al. (2012) 0.66 0.98 0.93 402s
tileHMM HMM No Viterbi +BW Humburg et al. (2008) 0.65 0.98 0.93 741 s
StandardHMM HMM No Bayesian BW Seifert et al. (2009) 0.63 0.98 0.93 218 s
ChIPmixHMM HMM No BW C.Bérard (personal communication)a 0.58 0.97 0.91 914s
TileMAPHMM HMM Yes 7 J1 and Wong (2005) 0.56 0.96 0.90 61 s
JohannesModell MixMod Yes Incremental EM Johannes et al. (2010) 0.55 0.97 0.90 4936 s
multiChIPmix MixMod Yes EM C.Bérard (personal communication)a 0.52 0.97 0.90 1109 s
ChIPmix MixMod No EM Martin-Magniette et al. (2008) 0.51 0.97 0.90 1204s

 

The methods are compared based on their identiﬁcation of methylated DNA—regions in the root methylome dataset. The ‘Method’ column contains the shortcuts of the
different methods. The ‘Model’ column speciﬁes the basic model of the corresponding method. This is either a HMM or a mixture model (MixMod). The ‘SIM’ column
speciﬁes whether a method considers all replicates of an experiment simultaneously. The ‘Training’ column speciﬁes the algorithm used for adapting the corresponding method
to the data. For an HMM—based method, this is either a Bayesian Baum:Welch training (Bayesian BW), Viterbi training (V iterbi) or a standard Baum:Welch training (BW).
For methods based on a mixture model, speciﬁc versions of the EM algorithm are used. The ‘Reference’ column provides the link for getting more information about a speciﬁc
method. The methods are compared based on different criteria, considering the TPR reached at a ﬁxed FPR of 1%, AU—ROC, AU—PRC and the run time in seconds required
for the complete analysis of the dataset. The run time was measured on a standard desktop computer with 2.6GHz and 4 GB of memory, except for CortijoHMM evaluated
on a cluster node with 3 GHz and 8 GB of memory. For MeDIP—HMM only, results obtained by the second—order model are shown. Corresponding ROC and PRC curves of
all methods are shown in Supplementary Figure S4. An additional summary for MeDIP—HMMs of order zero up to four is given in Supplementary Table S3.

“Source code available upon request from C.Berard (caroline.berard@agroparistech.fr).

 

2935

12 /310's12u1n0[p101x0'so112111101u101q//:d11t1 111011 pap201um0q

9103 ‘0g1sn8nV 110 ::

M. Seifert et al.

 

potential candidate of being methylated, while a score close to
zero speciﬁes that this region is potentially unmethylated. For
methods that do not allow the simultaneous analysis of both
replicates of our root methylome dataset, average state-posterior
probabilities obtained from separate analyses of replicates were
considered as scores.

Based on these scores, the identiﬁcation of candidate regions
of methylation was evaluated for the different methods. For each
method, we computed the TPR at a ﬁxed FPR of 1%. To
enable a more global performance comparison, we also com-
puted the area under the receiver-operating-characteristic curve
(AU-ROC) and the area under the precision-recall curve
(AU-PRC). Because run times of methods can also be important
for the analysis of high-density tiling array data, we additionally
measured the time required by each method for performing the
analysis of our root methylome data. All results are summarized
in Table 1. Corresponding ROC and PRC curves are shown in
Supplementary Figure S4. An additional summary for MeDIP-
HMMs of order zero up to four is given in Supplementary
Table S3.

The best performing methods in terms of accuracy of
identifying methylated regions are the proposed MeDIP-
HMM, CortijoHMM (Cortijo et al., 2012) and tileHMM
(Humburg et al., 2008). In comparison to CortijoHMM, which
has been speciﬁcally developed for the analysis of Arabidopsis
MeDIP-chip data, MeDIP-HMM reaches the same performance
without being dependent on organism-speciﬁc settings. As
expected, the second-order MeDIP-HMM required longer for
performing the analysis than the first-order CortijoHMM. The
ﬁrst-order MeDIP-HMM reaches nearly identical AU—ROC and
AU-PRC values but could not reach the level of TPR at 1%
FPR as CortijoHMM (Supplementary Table S3). Thus, at the
price of a slightly higher run time, the second-order MeDIP-
HMM is able to compensate Arabidopsis-specific ad hoc settings
required by CortijoHMM. Compared with tileHMM, MeDIP-
HMM reaches a higher TPR at 1% FPR. Additionally,
MeDIP-HMM is faster than tileHMM and provides the pos-
sibility to differentiate between different methylation levels
due to the usage of the three states. StandardHMM is also
reaching a good performance, but has a smaller TPR at 1%
FPR compared with MeDIP-HMM, CortijoHMM and
tileHMM. Generally, all these four methods reach comparable
global performances as indicated by nearly identical AU—ROC
and AU—PRC values.

Comparing all six tested HMM-based methods,
TileMAPHMM (Ji and Wong 2005) reaches the lowest perform-
ance potentially because this method does not use a training
algorithm, which also leads to the fastest run time among all
tested methods. More generally, MeDIP-HMM, CortijoHMM,
tileHMM, StandardHMM and ChIPmixHMM are reaching
clearly higher TPRs at 1% FPR and higher AU—PRCs than
methods based on mixture models. This is again obtained due
to the modeling of dependencies between measurements of dir-
ectly adjacent chromosomal regions, which cannot be realized by
mixture models. Further support to this is given considering all
ChIPmix-based methods (Martin-Magniette et al., 2008) for
which ChIPmixHMM clearly outperforms multiChIPmix and
ChIPmix that are both using a mixture model. The best
method based on a mixture model is J ohannesModell reaching

an accuracy comparable with that of TileMAPHMM but requir-
ing nearly 81 times longer for the analysis.

Generally, also these comparisons indicate that the
second-order MeDIP-HMM is well suited for the identification
of methylated regions. This model reaches a high accuracy, has a
low run time, does not depend on organism-speciﬁc settings and
additionally enables to differentiate between different levels of
DNA methylation. Additionally, considering more stringent val-
idation data from Zilberman et al. 2008 than utilized for this
comparison, the second-order MeDIP-HMM is clearly outper-
forming all other tested methods (Supplementary Fig. S4).

3.3 Functional analysis of DNA methylation states
identiﬁed by MeDIP-HMM

The Arabidopsis Information Resource (TAIR8) genome anno-
tation (Rhee et al., 2003) enables us to analyze whether predic-
tions by the second-order MeDIP-HMM are targeting speciﬁc
functional units of the genome and to which extent these findings
are in accordance with current knowledge on the Arabidopsis
methylome. We initially assigned each genomic region to its
most likely underlying state (unmethylated, methylated or
highly methylated) of the MeDIP-HMM using state-posterior
decodings. This resulted in 463 877 (652%) unmethylated,
143017 (201%) methylated and 104 426 (147%) highly methy-
lated regions. Thus, 65.2% of regions are unmethylated, whereas
34.8% of regions are targeted by methylation, which is in good
agreement with previous studies for aerial and root tissues by
Zilberman et al. (2007, 2008).

We next classiﬁed all regions according to the genome anno-
tation and identiﬁed under- or overrepresentations of speciﬁc
functional categories by sampling the same numbers of unmethy-
lated, methylated and highly methylated regions randomly from
all regions on the tiling array using 500 repeats (Fig. 3).

Regions identiﬁed as being unmethylated are enriched in genie
categories (gene, mRNA, protein, exon and CDS), and 5/ and 3/
untranslated regions (UTRs), whereas transposons are clearly
underrepresented (Fig. 3a). About 62.4% of all genes and
21.2% of all transposons are identiﬁed as being unmethylated
over their whole-tiled sequences (Supplementary Fig. S5).
This is in good agreement with results of previous studies (e.g.
Ahmed et al., 2011; Cokus et al., 2008; Zilberman et al., 2007).
Furthermore, using the chromatin classiﬁcation by
Bernatavichute et al. (2008), we find that 72.8% of unmethylated
regions are located in euchromatin, which is in agreement with
these regions being gene-rich and transposon—poor (Supplemen-
tary Table S4).

Regions identiﬁed as being methylated include a large fraction
of genie regions and a small fraction of 5/ and 3/ UTRs (Fig. 3b).
About 35.6% of genes are at least partially methylated
(Supplementary Fig. S5). This is in good accordance with previ-
ous findings of gene body methylation (Cokus et al., 2008; Zhang
et al., 2006; Zilberman et al., 2007). Additionally, regions identi-
fied as being methylated are clearly enriched in transposons. This
is expected and coincides with the three previous studies, because
methylation of transposons is a known mechanism to silence
these elements (Law and Jacobsen 2010; Teixeira and Colot
2010). Overall, the fraction of methylated regions modeled by
state /I/ targeting genie regions is greater than that of

 

2936

12 /310's12u1n0[p101x0'so112111101u101q//:d11t1 111011 pap201um0q

9103 ‘0g1sn8nv 110 ::

HMM-based analysis of DNA methylation profiles

 

(a) State ’U’: Unmeth lated (b)
y
300000 70000
250000 w 60000
a g 50000
'§’200000 E) 40000
D: ~—
»— 0
g 150000 E 30000
5
$100000 E 20000
50000 10000
0 ..l]lu 0
c o a: < E c <0 a: n: n: 8 8
§§§E588§55 85
51 ea 80% 29
E C a g
= a

State ' Ii: Methylated (c)

gene

State ’M’: Highly Methylated

80000
70000
9 60000
.9
a 50000
D:
5 40000
§ 30000
2 20000
10000
<._ C°°J<EC<D<DDCE
e§§§§55 2555355555
5‘5. 8291:) %0‘ En. gag-n
a  a
a r a

Fig. 3. Functional analysis of genomic regions in the Arabidopsis root methylome dataset according to the underlying DNA methylation states identiﬁed
by MeDIP-HMM. Genomic regions were annotated using the functional categories defined by the TAIR8 genome annotation. Colored bars represent
the number of regions in each category identiﬁed by MeDIP-HMM. Gray shaded bars represent the average number of regions obtained for each
category by randomly sampling the same number of regions from all genomic regions in the dataset using 500 repeats. Genomic regions identiﬁed as
being unmethylated are shown in (21), regions identiﬁed as being methylated are shown in (b) and regions identiﬁed as being highly methylated are shown
in (c). All identiﬁed genomic regions classiﬁed into the different categories are signiﬁcantly different from random sampling with P-values less than 0.01.
The states ’I’ and ’M’ modeling different degrees of DNA methylation are having obviously distinct functional interpretations. Less strongly methylated
transposons and genes with gene body methylation are covered by state ’1’, whereas strongly methylated transposons are mainly characterizing regions

assigned to state ’M’

transposons. Generally, the prevalence of methylated regions in
euchromatin is signiﬁcantly enriched, comprising about 53% of
methylated regions (Supplementary Table S4), which is much less
stronger than observed for unmethylated regions because trans-
posons identiﬁed as being methylated are mostly located within
the heterochromatic regions.

Regions identiﬁed as being highly methylated are clearly
enriched in transposons, whereas only very small fractions of
genie regions, 5/ and 3/ UTRs, are highly methylated (Fig. 30).
About 27.2% of all transposons and only about 2% of all genes
are highly methylated over their whole tiled sequences
(Supplementary Fig. S5). This coincides with previous findings
(Ahmed et al., 2011; Zilberman et al., 2008). Overall, we ﬁnd
that highly methylated regions modeled by state /M/ are
preferentially located in heterochromatin. We identified a
significantly enriched proportion of 86.3% heterochromatic
regions compared with only 13.7% euchromatic regions
(Supplementary Table S4).

We further analyzed identiﬁed DNA methylation states of
transposon superfamilies using the extended TAIR8 transposon
annotation of Ahmed et al. (2011). We observe clear tendencies
that especially unmethylated or methylated transposons of the
superfamilies LTR/Gypsy, LTR/Copia, LINE/L1 and DNA/
En—Spm are much smaller in size than highly methylated mem-
bers of the same superfamin (Supplementary Fig. S6). Shorter
sizes and less strong methylation are known to be indicative of
non-functional transposon relics (Ahmed et al., 2011). These
dependencies can only be observed so explicitly using the
three-state decoding of MeDIP-HMM.

Summing up, predictions by MeDIP—HMM are in good
accordance with current knowledge on the Arabidopsis methy-
lome assembled in previous studies using tiling array and bisulﬁte
sequencing experiments. Moreover, differentiations between
unmethylated, methylated and highly methylated regions are

only possible with MeDIP-HMM and cannot be achieved
using standard methods for ChIP-chip analysis designed to dis-
criminate between two populations of measurements. Thus,
MeDIP-HMM allows a more detailed analysis and potentially
a more advanced interpretation of results.

3.4 Application of MeDIP—HMM to
non-Arabidopsis data

To illustrate the general applicability of MeDIP-HMM, we ana-
lyzed publicly available promoter DNA methylation data of
brain tissue of domesticated White Leghorn (WL) and wild-
type Red Jungle fowl (RJF) chickens (Natt et al., 2012). We
downloaded processed data for parents and offspring chickens
from ArrayExpress (E-MTAB-648 and E-MTAB-649) and cre-
ated a small dataset containing measurements of tiles in corres-
ponding promoter regions for two selected genes ABHD7 and
PCDHACl shown to have a stable transgenerational methyla-
tion proﬁle. This dataset includes four replicates (females and
males each with high and low fear behavior) for WL and RJ F.
We trained a second-order MeDIP-HMM with four-variate
Gaussian emissions on this dataset using initial proportions of
unmethylated and highly methylated tiles like those applied for
the Arabidopsis root methylome data. Finally, we performed a
state-posterior decoding into the most likely underlying methy-
lation states. The results are shown in Supplementary Figure S7.
In accordance with Natt et al. (2012), we also find that the
methylation patterns of ABHD7 and PCDHACl are very
stable between parents and offspring. Additionally, the decoding
into three states by MeDIP-HMM enables a more detailed View
on promoter DNA methylation, potentially highlighting do-
mains with high and low levels of DNA methylation. Thus,
this additional study indicates that MeDIP-HMM can also be
applied to non-plant data.

 

2937

12 /310's12u1n0[p101x0'so112111101u101q//:d11t1 111011 pap201um0q

9103 ‘0g1sn8nv 110 ::

M. Seifert et al.

 

4 CONCLUSIONS

We developed a three-state MeDIP-HMM for the analysis of
DNA methylation data from high-density tiling arrays, enabling
the identiﬁcation of distinct methylation levels. MeDIP-HMM
enables a simultaneous analysis of replicates and improves mod-
eling of spatial dependencies between chromosomal regions using
a higher-order state-transition process.

We carefully evaluated our model and existing methods for
ChIP—chip analyses on DNA methylation data of Arabidopsis
root tissue. Compared with these methods, MeDIP-HMM
reached an overall good performance in combination with a
fast run time. This also revealed that HMMs modeling spatial
dependencies between chromosomal regions are generally better
suited for the analysis of MeDIP-chip data than mixture models
ignoring these dependencies. Besides this, moderately
higher-order MeDIP-HMMs were identiﬁed to be more precise
than the first-order MeDIP-HMM and other existing ﬁrst-order
HMMs. This is in good accordance with a previous study in
comparative genomics (Seifert et al., 2012). Generally, we identi-
ﬁed that a second-order MeDIP—HMM is working best on the
root methylome data, reaching a performance comparable to a
three-state ﬁrst-order HMM speciﬁcally developed for the ana-
lysis of Arabidopsis MeDIP-chip data in a companion study by
Cortijo et al. (2012). The companion approach uses the observa-
tion that introns in Arabidopsis are typically found to be
unmethylated for estimating the emission parameters of the
unmethylated state. This cannot be directly transferred to other
organisms like human, where introns are usually found to be
methylated (Lister et al., 2009). Our results indicate that the
second-order MeDIP-HMM is able to compensate
Arabidopsis-specific ad hoc settings required by the companion
approach. Moreover, we also showed that our MeDIP-HMM
can be applied to the analysis of non-plant data as well.
Overall, MeDIP-HMM is more versatile by being independent
of organism-speciﬁc settings, using a higher-order state-
transition process and enabling simultaneous analyses of
replicates.

Generally, the differentiation between unmethylated, met-
hylated and highly methylated regions by MeDIP-HMM enables
an improved interpretation of predictions compared with existing
ChIP—chip analyses methods only enabling a binary classiﬁcation
into unmethylated and methylated regions. Moreover, the pre-
dictions of MeDIP-HMM were in good accordance with current
knowledge on the Arabidopsis methylome. All these ﬁndings
clearly indicate that MeDIP-HMM is a useful method for the
analysis of DNA methylation data. Given that MeDIP—HMM is
independent of organism-speciﬁc settings, it should be applicable
to the analysis of methylomes of plant and non-plant species
equally.

ACKNOWLEDGEMENTS

We thank Caroline Berard (AgroParisTech) for providing source
codes of multiChIPmix and ChIPmixHMM. We thank Jens
Keilwagen (IPK) and Jan Grau (University of Halle) for Jstacs
support, Marc Strickert (University of Marburg) for critical
reading of the manuscript and the anonymous reviewers for
their valuable comments.

Funding: This work was supported by the Ministry of
Culture Saxony-Anhalt (grant XP3624HP/0606T), DAAD
PROCOPE (grant 50748812), EU FP7 Network of Excellence
‘EPIGENESYS’ and ANR-GPLA ‘REGENEOME’.

Conﬂict of Interest: none declared.

REFERENCES

Ahmed,I. et al. (2011) Genome—wide evidence for local DNA methylation spreading
from small RNA—targeted sequences in Arabidopsis. Nucleic Acids Res, 39,
6919$93L

Banaei,A.M. et al. (2011) Additive inheritance of histone modiﬁcations in
Arabidopsis thaliana intraspeciﬁc hybrids. Plant J., 67, 691:700.

Barlow,D.P. (2011) Genomic imprinting: a mammalian epigenetic discovery model.
Annu. Rev. Genet, 45, 3794103.

Baum,L.E. (1972) An inequality and associated maximization technique in statis—
tical estimation for probabilistic functions of Markov processes. Inequalities, 3,
1:8.

Beck,S. and Rakyan,V.K. (2008) The methylome: approaches for global DNA
methylation proﬁling. Trends Genet, 24, 231:236.

Berchtold,A. and Raftery,A.E. (2002) The mixture transition distribution model for
high—order Markov chains and non—Gaussian time series. Stat. Sci., 17, 32&356.

Bernatavichute,Y.V. et al. (2008) Genome—wide association of histone H3 lysine
nine methylation with CHG DNA methylation in Arabidopsis thaliana. PLoS
One, 3, e3156.

Bilmes,].A. (1998) A gentle tutorial of the EM algorithm and its applications to
parameter estimation for Gaussian mixture and hidden Markov models.
Technical report ICSI—TR, 97:021.

Bolstad,B.M. et al. (2003) A comparison of normalization methods for high density
oligonucleotide array data based on variance and bias. Bioinformatics, l9,
185:193.

Borgel,J. et al. (2010) Targets and dynamics of promoter DNA methylation during
early mouse development. Nat Genet, 42, 1093:1100.

Cokus,S.J. et al. (2008) Shotgun bisulphite sequencing of the Arabidopsis genome
reveals DNA methylation patterning. Nature, 452, 215:219.

Cortijo,S. et al. (2012) Genome—wide analysis of DNA methylation in Arabidopsis
using MeDIP—chip. In: McKeown,P. and Spillane,C. (eds) Plant Epigenome:
Understanding and Analysis. Humana Press/Springer, New York.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. Roy. Stat. Soc. B, 39, 1:38.

du Preez,].A. (1998) Efﬁcient training of high—order hidden Markov models using
ﬁrst—order representations. Comput Speech Lang., 12, 23:39.

Durbin,R. et al. (1998) Biological Sequence Analysisiprobabilistic Models of
Proteins and Nucleic Acids. Cambridge University Press, UK.

Eng,C. et al. (2009) A new data mining approach for the detection of bacterial
promoters combining stochastic and combinatorial methods. J. Comp. Biol,
16, 1211:1225.

Esteller,M. (2007) Cancer epigenomics: DNA methylomes and histone—
modiﬁcations. Nat Rev. Genet, 8, 28G298.

Gauvain,J.—L. and Lee,C.—H. (1994) Maximum a posterior estimation for multivari—
ate Gaussian mixture observations of Markov chains. IEEE Trans. Speech
Audio Process, 2, 2917298.

Harrison,A. and Parle—McDermott,A. (201 1) DNA methylation: a timeline of meth—
ods and applications. Front Genet, 2, 1:13.

Humburg,P. et al. (2008) Parameter estimation for robust HMM analysis of
ChIP—chip data. BMC Bioinformatics, 9, 343.

Ji,H. and Wong,W.H. (2005) TileMap: create chromosomal map of tiling array
hybridizations. Bioinformatics, 21, 3629:3636.

Johannes,F. et al. (2010) Comparing genome—wide chromatin proﬁles using ChIP—
chip or ChIP—seq. Bioinformatics, 26, 1000:1006.

Law,J.A. and Jacobsen,S.E. (2010) Establishing, maintaining and modifying DNA
methylation patterns in plants and animals. Nat Rev. Genet, 11, 204:220.
Li,W. et al. (2005) A hidden Markov model for analyzing ChIP—chip experiments on
genome tiling arrays and its application to p53 binding sequences.

Bioinformatics, 21, 1274:1282.

Lister,R. et al. (2008) Highly integrated single—base resolution maps of the epigen—
ome in Arabidopsis. Cell, 133, 523536.

Lister,R. et al. (2009) Human DNA methylomes at base resolution show widespread
epigenomic differences. Nature, 426, 315322.

 

2938

12 /310's12u1n0[p101x0'so112111101u101q//:d11t1 111011 pap201um0q

9103 ‘0g1sn8nv 110 ::

HMM-based analysis of DNA methylation profiles

 

Mari,J.—F. et al. (1997) Automatic word recognition based on second—order hidden
Markov models. IEEE Trans. Speech Audio Process, 5, 22:25.

Martin—Magniette,M.—L. et al. (2008) ChIPmix: mixture model of regressions for
two—color ChIP—chip analysis. Bioinformatics, 24, i181:i186.

Natt,D. et al. (2012) Heritable genome—wide variation of gene expression and
promoter methylation between wild and domesticated chickens. BMC
Genomics, 13, 59.

Rhee,S.Y. et al. (2003) The Arabidopsis Information Resource (TAIR): a model
organism database providing a centralized, curated gateway to Arabidopsis biol—
ogy, research materials and community. Nucleic Acids Res., 31, 24:28.

Seifert,M. (2010) Extensions of hidden Markov models for the analysis of DNA
microarray data. PhD Thesis, Martin Luther University, Halle, Germany.

Seifert,M. et al. (2012) Parsimonious higher—order hidden Markov models for
improved array—CGH analysis with applications to Arabidopsis thaliana.
PLoS Comput Biol., 8, e1002286.

Seifert,M. et al. (2009) Utilizing gene pair orientations for HMM—based analysis of
ChIP—chip data. Bioinformatics, 25, 2118:2125.

Seifert,M. et al. (2011) Exploiting prior knowledge and gene distances in the analysis
of tumor expression proﬁles with extended hidden Markov models.
Bioinformatics, 27, 1645:1652.

Teixeira,F.K. and Colot,V. (2010) Repeat elements and the Arabidopsis DNA
methylation landscape. Heredity, 105, 14:23.

Wang,Y. (2006) The variable—length hidden Markov model and its applications on
sequential data mining. Technical report. Department of Computer Science,
Tsinghua University, Beijing, China.

Wutz,A. (2011) Gene silencing X—chromosome inactivation: advances in under—
standing facultative heterochromatin formation. Nat Rev. Genet, 12, 542553.

Zhang,X. et al. (2006) Genome—wide high—resolution mapping and functional ana—
lysis of DNA methylation in Arabidopsis. Cell, 126, 1189:1201.

Zilberman,D. et al. (2008) Histone H2A.Z and DNA methylation are mutually
antagonistic chromatin marks. Nature, 456, 125:130.

Zilberman,D. et al. (2007) Genome—wide analysis of Arabidopsis thaliana DNA
methylation uncovers an interdependence between methylation and transcrip—
tion. Nat Genet, 39, 61:69.

 

2939

12 /310's12u1n0[p101x0'so112111101u101q//:d11t1 111011 pap201um0q

9103 ‘0g1sn8nv 110 ::

