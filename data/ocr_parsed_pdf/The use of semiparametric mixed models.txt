ORIGINAL PAPER

Vol. 27 no. 20 2011, pages 2859—2865
doi:10. 1 093/bioinformatics/btr4 75

 

Gene expression

Advance Access publication August 16, 2011

The use of semiparametric mixed models to analyze PamChip®
peptide array data: an application to an oncology experiment

Pushpike J. Thilakarathnelai‘, Lieven Clement1’2, Dan Lin1’2, Ziv Shkedy2,

Adetayo Kasim3, Willem Talloen4, Matthias Versele4 and Geert Verbeke1

1Interuniversity Institute for Biostatistics and Statistical Bioinformatics, Katholieke Universiteit Leuven, BSOOO Leuven,
2|nteruniversity Institute for Biostatistics and Statistical Bioinformatics, Universiteit Hasselt, Agoralaan 1, B3590
Diepenbeek, Belgium, 3Wolfson Research Institute, Durham University Queen’s Campus, University Boulevard,
Thornaby, Stockton—on—Tees, UK and 4Janssen Pharmaceutica N.V., Beerse, Belgium

Associate Editor: John Quackenbush

 

ABSTRACT

Motivation: Phosphorylation by protein kinases is a central theme
in biological systems. Aberrant protein kinase activity has been
implicated in a variety of human diseases (e.g. cancer). Therefore,
modulation of kinase activity represents an attractive therapeutic
approach for the treatment of human illnesses. Thus, identification of
signature peptides is crucial for protein kinase targeting and can be
achieved by using PamChip® microarray technology. We propose a
flexible semiparametric mixed model for analyzing PamChip® data.
This approach enables the estimation of the phosphorylation rate
(Velocity) as a function of time together with pointwise confidence
intervals.

Results: Using a publicly available dataset, we show that our model
is capable of adequately fitting the kinase activity profiles and
provides velocity estimates over time. Moreover, it allows to test for
differences in the velocity of kinase inhibition between responding
and non-responding cell lines. This can be done at individual time
point as well as for the entire velocity profile.

Contact: pushpike@med.kuleuven.be

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on February 24,2011; revised on August 2, 2011 ; accepted
on August 8, 2011

1 INTRODUCTION

Scientiﬁc advances in biotechnology bring us in a new era of targeted
therapies and personalized medicine. Biomarkers are essential
for selecting patients that beneﬁt from certain treatments, and
biomarker discovery is nowadays driven by novel platforms that
measure more biological properties more precisely. Evidently, these
technological advances often require the development of optimal
analysis approaches for its generated data in order to increase its
detection power.

Here, we progose a statistical model to efﬁciently analyze output
from PamChip microarrays. These high-content peptide arrays
are capable of measuring phosphorylation changes over time for
more than hundred peptides simultaneously (Hilhorst et al., 2009;
Nagaoka et al., 2005; Perera et al., 2006; Versele et al., 2009).

 

*To whom correspondence should be addressed.

Compared to conventional microarrays, PamChips have two main
advantages. First, proteins are closer to phenotypic expression than
DNA or mRNA proﬁles. Second, PamChips are not measuring
concentrations but biological activity, i.e. phos<ghorylation over
time. An important application area of PamChip microarrays is
the study of protein kinase activity (Versele et al., 2009). Protein
kinase inhibitors can speciﬁcally block key signaling pathways in
cancer, making kinases very popular targets in anticancer-targeted
therapy discovery programs (Kondapalli et al., 2005). PamChip®
microarrays have a very distinct technical design (see Section 1
of the Supplementary Material for more details) and the data
properties of the PamChip® read-out are atypical compared with
more traditional microarrays. Hence, speciﬁc data analysis pipeline
has to be developed for PamChip® microarrays.

In this article, we demonstrate the statistical methodology
to model the kinase activity proﬁles and thereby estimate the
phosphorylation rate, referred to as velocity. With the proposed
approach, phosphorylation rates can be investigated and tested
for each peptide. The article is organized as follows. Section 2
describes a real-life PamChip® microarray experiment that is used
to demonstrate our method. In Section 3, we describe existing
methods for analyzing PamChip® array data and motivate our
approach. In Section 4, we give a brief review of penalized
smoothing splines formulated as mixed models, specify the proposed
model, speciﬁcally adapt it to the PamChip® array data at hand and
focus on the inference problem of this study. The results are given in
Section 5. The discussion and conclusions are presented in Sections 6
and 7, respectively.

2 REAL-LIFE PAMCHIP® ARRAY DATA

We use a real-life dataset described in Versele et al. (2009) as a
motivating example for our method. It consists of an oncology
experiment where phosphorylation of peptides is measured in 20
different cell line lysates in the absence (control) and presence of
a kinase inhibitor (compound) using peptide arrays with a kinetic
read-out. Ten out of twenty cell lines are known to be responsive
and others are non-responsive to the speciﬁc kinase inhibitor under
study. The cell lines were randomly assigned to six 96-well plates,
of which each well contains a l44-peptide array. Each cell line was
typically replicated 5—6 times. For quality control issues, some wells
were excluded.

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2859

112 /3.Io's[Bumo[p.IOJxosotwuiJOJutotq”:duq 11101} papBOIH/lAOG

9103 ‘Og anﬁnv uo ::

F!J.Thilakarathne et al.

 

 

 

.é‘ a?
V) 0)
Co Co
28 .98
So So
2‘— 2‘—
050 mo
m8- <08-
m in
O— O-

 

 

 

 

 

 

I I I I I I | | | | | | | | | | | | | | | | | | | |
0 10 20 30 40 50 60 0 10 20 30 40 50 60
Time [min] Time [min]

Fig. 1. PamChip® microarray kinetic output: observed kinase activity
proﬁles for a responsive cell line. Proﬁles for a non-responsive cell line
is given in Supplementary Figure S2. (A) Control responsive cell line;
(B) Compound responsive cell line.

The intensities of 14-4 peptides were measured at 5 min time
intervals over a period of 60 min using PamChip® technology. The
ﬁrst kinetic reading is done 11 min after the assay mix was pumped
to the plate. The last reading is done at 71 min. For simplicity, we
shift the time by subtracting 11 min from each time point leading to
a time range I = 0, ..., 60 min. Therefore, I = 0 corresponds to the ﬁrst
kinetic read. Figure 1 shows kinase activity over time for a selected
peptide of a responsive cell line under the treatment (Fig. 1B) and
control (Fig. 1A). Proﬁles for a non-responsive cell line are given
in Supplementary Figure S2. The graphical illustration of intensity
measurements for a selected peptide across all the cell lines are given
in Supplementary Figure S3.

3 MOTIVATION

Signal intensity proﬁles are the outcomes of the peptide microarray
experiment and correspond to the degree of phosphorylation.
For assessing the impact of the kinase inhibitor compound,
however, the phosphorylation rate is required. Hilhorst et al.
(2009) modeled peptide array data with an exponential model,
Yij = Y0 + Ymax[l —e_’7tf], where the Yl-j values stand for the signal
intensity of subject 1' at j—th time point, Y0 is the signal intensities at
the beginning of the experiment and Ymax is the maximum observed
intensity. )7 is the reaction rate constant and tj is the time point when
the image was recorded. Only the initial velocity of the peptide
phosphorylation was used for subsequent data analysis. Versele
et al. (2009) preprocessed each PamChip® proﬁle separately using
CurveFitHT software for deriving the initial velocity at the ﬁrst
kinetic time point read. They only used the ﬁrst 30 min of the
assay and based all subsequent data analysis on the estimated
initial velocities. In particular, the estimated initial velocities were
log transformed and are used for comparing responsive and
non-responsive cell lines with a mixed model.

Both Versele et al. (2009) and Hilhorst et al. (2009) use a
two stage approach where (i) exponential models are used in the
ﬁrst stage to summarize the individual time series into a single
value i.e initial velocities and (ii) these estimated initial velocities
are assessed in the downstream analysis without accounting for
their associated uncertainty. Hence, they ignore the within replicate
variability and only capture the technical variation between the
replicates. This can have a severe effect on the outcome of the second
stage analysis if the within variability of the replicates is large as
compared to the between variability and in case that the uncertainty

of the initial velocity estimates differs among replicates, cell lines
or treatments. Hence, the Hilhorst method and the Versele method
might suffer from a loss in power, efﬁciency and an incorrect control
of the type I error (Verbeke and Molenberghs, 2000).

We propose a semiparametric mixed effects model that combines
both the estimation and modeling stage into a single analysis.
Moreover, the link between mixed models and smoothing provides
a very ﬂexible framework for estimating the kinase activity proﬁles
in a data-driven way. Within the mixed model framework, it is
very natural to account for the dependence structure of the intensity
signals within and across activity proﬁles by modeling all data for a
given peptide, simultaneously. The proposed semiparametric mixed
model allows for testing whether the change in phosphorylation
rate (velocity) induced by the treatment (compound) effect differs
between responsive and non-responsive cell lines. The tests can
be performed at any time point as well as for the entire proﬁle,
simultaneously. Further, velocity proﬁles can be derived as a
function of time along with 95% pointwise conﬁdence bands.

4 METHODS

High-content PamChip® microarrays produce longitudinal time series
proﬁles. For inference. it is necessary that we properly capture the form of
the evolution of proﬁles over time. In longitudinal studies. the mean proﬁle
is often estimated by parametric functions. Examples of longitudinal studies
and an extensive overview on longitudinal data analysis and inference using
parametric models can be found in Fitzmaurice et al. (2008); Molenberghs
and Verbeke (2005); Pinheiro and Bates (2000); Verbeke and Molenberghs
(2000). However. many biomedical experiments typically generate non-
linear data and imposing parametric functions might yield unsatisfactory
results (Bowman and Azzalini. 1997; Wood. 2006). In the context of
PamChip® experiments. for instance. the individual proﬁles are non-linear
and parametric models may be too restrictive. Moreover. the experimental
setup gives rise to a complex dependence structure. which can obscure
the interpretation and inference on the non-linear phosphorylation proﬁles.
Therefore. we propose a data-driven approach based on semiparametric
regression models. Particularly. we use penalized thin plate regression splines
to analyze PamChip® data. Penalized thin plate regression splines avoids
problems of knot selection and knot placement. as they both emerge naturally
from the mathematical formulation of the smoothing problem (Ramsay
and Silverman. 2005; Wood. 2006). The smoothing parameters that control
the degree of smoothing typically have to be tuned toward the speciﬁc
application. Interestingly. these smoothing parameters can also be estimated
within the linear mixed-model framework (Maringwa et al.. 2008; Ruppert
et al.. 2003; Wood. 2006).

Let Y,»(t) denote the log transformed and background corrected intensity
measurement on cell line i (i=1,...,n). taken at time point t. The penalized
spline model. with cell line-speciﬁc random effects [10), ...,b],i can be
expressed as

m) = 180+ ﬁrm)
[:1

 

S(t)
+ bOi‘I—blit‘l'---+bpitp+5i(t)v (1)

where ﬁ(t)s are a set of thin plate spline basis functions (Supplementary
Figure S4). )3) are the coefﬁcients of the basis functions (Ramsay
and Silverman. 2005; Ruppert et al.. 2003; Wood. 2006).
[170),...,b],i]T~MVN(0,E;,) and 8m) i.i.d. N(0,a§). The cell line-
speciﬁc random effects bpfs accounts for the correlated nature of
the intensities. Statistical signiﬁcance of the cell line-speciﬁc random
effects can be tested by using an approximate likelihood ratio test
(Verbeke and Molenberghs. 2000). The spline model parameters can be

 

2860

112 /3.Io's[Bumo[p.IOJxosotwuiJOJutotq”:duq 11101} papBOIII/IAOG

9103 ‘Og anﬁnv uo ::

Mixed model for PamChip® peptide arrays

 

estimated by considering the goodness-of—ﬁt and the degree of smoothness
(Bowman and Azzalini. 1997; Ramsay and Silverman. 2005; Wood. 2006).
The model (1) can be ﬁtted by ﬁnding the function from an appropriate
reproducing kernel Hilbert space which minimizes

Q=lly—S||2+A/[S’"(t)]2dt, (2)

where f[S(’")(t)]2dt is the roughness penalty which penalizes for the lack
of smoothness of S. Roughness is quantiﬁed by the integral of squared m-th
order derivatives. The most commonly used roughness penalty is m = 2. Note
that. for m=2 and a given A.  the minimizer of Q. is a cubic smoothing
spline. In the literature. the smoothing parameter A is often tuned by using
an optimization criterion such as generalized cross-validation. Penalized thin
plate regression splines (TPRS). however. can also be represented within the
mixed model framework (Wood. 2006). It allows for the estimation of the
smoothing parameter Azosz/USZ. where of is the variance of the random
effects that are involved in the mixed model representation of the spline.

In this study. our aim is to estimate the marginal phosphorylation rate over
all cell lines. which is the ﬁrst-order derivative of the smoother. S(t). with
respect to time Z. Note that. the ﬁrst-order derivative S’(t)= 22):] ﬁLfl/(t) is
a linear combination of the derivatives of the basis functions.

S’(t) is a smooth function of time when using cubic splines. However.
they give rise to biased velocity estimates at the boundaries (Supplementary
Section S9) and are not suitable in our situation. Therefore. we will penalize
on the third-order derivative. which provides a more smooth ﬁrst derivative
that does not suffer from boundary artifacts (Ramsay and Silverman. 2005;
Wood. 2006). Because the TPRS are adopted within the mixed model
framework. standard errors and conﬁdence bands for the velocity follow
from standard theory of mixed models (e.g. Verbeke and Molenberghs. 2000;
Ruppert. Wand and Carroll. 2003. Section 6.8.1; and Wood. 2006).

Fitting penalized splines models within the linear mixed model framework
has some appealing advantages. such as the estimation of the smoothing
parameter A. a uniﬁed framework for inference and straightforward extension
of the model. Moreover. the mixed model representation also provides a
natural way for handling clustered data. missing data and measurement error
(Durban et al.. 2004; Maringwa et al.. 2008; Ruppert et al.. 2003; Wood.
2006). In the following section. we describe how we draw the inference
from the proposed approach.

4.1 Inference on ﬁrst-order derivative

In this particular study. we are interested in marginal velocity. Hypothesis
tests on the velocity can be formulated by using general linear hypotheses.

H0 :LV=0 versus Ha :LV7EO,

where L is the contrast matrix and V is a vector which contains coefﬁcients
of the ﬁrst derivatives of the basis functions (25(1)) discussed in Section 4.

4.2 Formulation of the model for PamChip ® array
data

This section provides the formulation of the spline model (1) for the
PamChip® array data at hand. We propose a full factorial model structure
for treatment and responsive status. For a desired ﬂexibility. the penalized
thin plate regression smoothing splines with penalization on the third-order
derivative (m=3) are considered (Ramsay and Silverman. 2005; Wood.
2006).

For the present study. we have two treatments (control and compound)
and two responsive statuses (responsive: R and non-responsive: NR) for
cell lines. This data structure formulates four distinct groups namely. g: 1:
Compound - R. g=2z Compound - NR. g=3z Control - NR and g=4z
Control - R.

Let Ygiﬂ denote the log transformed and background corrected intensity
measurement of cell line i. replicate j. measured at time t. on the l-th plate
for groupg. with i: l,...,20;j= l,...,6; t:0,5,lO,...,55,60min. l:l,...,6

and g: l,  We propose the following semiparametric mixed model with
quadratic random effects structures (17:2) for replicates as well as for cell
lines

Ygiil = Sg(t)+b0gi+blgit+b2gitz
+ Corgi)+€1j<gi>l+€2j<gi>l2 (3)
+ “1+8giﬂ<r>-

In this proposed model. the cell line-speciﬁc random intercept is
considered to capture correlation of the intensity measurement over time
within the cell line. We assumed cell line-speciﬁc random slopes for
linear as well as for quadratic time effects to capture different evolution
of kinase activity over time. Moreover. we allow these cell lines-speciﬁc
random structures to be different for each group. We assumed group-speciﬁc
random structure for cell lines for which [bogi,b1gi,b2gi]T~MVN(0,Z;,)
where g is the group indicator and 2;, denote the variance covariance
matrix of cell line-speciﬁc random effects. There are technical replicates
for each cell line under each treatment and therefore. the replicate-speciﬁc
random effect within the cell line. cox/5.)). is speciﬁed. Replicate-speciﬁc
random slopes for linear and quadratic time effects nested within the cell
line. capture the different evolutions of replicate-speciﬁc proﬁles (Durban
et al.. 2004). We assumed that the replicate-speciﬁc random structure is
[col-(3,0,clj(gi),czj(gi)]T ~M VN (0, EC) and EC denote the variance covariance
matrix of replicate-speciﬁc random effects. A random 96-well plate-speciﬁc
effect. a) ~N(0,o§). is assumed for the correlation of the cell lines on the
same 96-well plate. Ten out of twenty cell lines are known to be responsive
and others are non-responsive. Therefore. we assumed heterogeneous error
variability across the four different groups. Hence. the residuals egg-m) are
assumed to be i.i.d. N(0,o€2g).

Further. we assume a different smoother. Sg(t). for the four different
groups. which is deﬁned as

I}
Sgrz>=r0g+2ﬁrgmzi
[:1
with group-speciﬁc smoothing parameter Ag. Note. that the design matrix.
corresponding to the smoother. is a block diagonal with each diagonal entry
corresponding to a particular group.

4.3 Comparing group-speciﬁc velocities

The data structure for the present study formulates four distinct groups as
described in Section 4.2. We deﬁne Sgt) as the velocity for each group g.
g: l,  and we are interested in investigating whether kinase inhibitor
induces a similar velocity change in responsive and non-responsive cell lines.
To test whether the treatment effect is the same for responsive and non-
responsive cell lines. we formulate the general linear hypothesis.

H0:S1(t)—S:1(t) = S’2(t)—Sé(t) versus
HaISi(l)—Si(l) 3'5 5/2(l)—Sé(l)- (4)

This hypothesis can be tested at any time point t as well as for the
entire time proﬁle Vte[0,...,60]. The null hypothesis obviously implies
that the velocity contrast between the treatment and control is the same for
responsive and non-responsive cell lines. Supplementary Figure S5 illustrates
a hypothetical example for a possible scenario related to the evolution
of velocity over time under the alternative hypothesis. The left panel of
Supplementary Figure S5 shows a velocity at [:0 under the alternative
hypothesis and the right panel shows the evolution of velocity over time for
each group. Four groups have different velocities over time and the groups
differ in both linear and smooth parts.

First we consider testing at a particular time point 121*. Let L: [S] (1*)
—S’2(t*) SgU") —S:1(t*)] be the contrast for which Slat"): [fl/(1*), ...,f,,’(t*)]
is the vector of ﬁrst derivatives of basis functions. V: [)31,)32,)33,)34]T is
the vector of group-speciﬁc coefﬁcients of the basis functions for which
ﬂg=[ﬁ1g,...,)3vg]. Therefore. the null hypothesis is HozLV=0 and the

 

2861

112 /3.Io's1Bu1no[p.IOJxosotwuiJOJutotq”:duq 11101} pepBo1u/noq

9103 ‘0g isanV uo ::

F!J.Thilakarathne et al.

 

L17
«LEI/LT
the estimated variance covariance matrix of the coefﬁcients of the basis

functions. Second. we illustrate how we can perform the test (4) for entire
time proﬁle i.e. Vt 6 [0,60]. The contrast matrix L is now simpliﬁed to

test statistic

 

asymptotically follows a N(0, 1) under H0. EV is

l—ll—l
l—ll—l

1 —1 1 —1

The L-th row represents the contrast on the coefﬁcients of the L-th basis
function ﬁ(t) for four different groups. with l: 1, . . . , v. In this case.
hypothesis (4) can then be tested using the test statistic LI;(LEVLT)_1LI7T.
which follows a chi-squared distribution with degrees of freedom equal to
the rank of L. The test can be performed for each peptide and illustrations are
given in Section 5. We provided a proof for the equivalence between testing
on the entire proﬁles and testing on the coefﬁcients of the basis functions in
the Supplementary Section $11.

In what follows. we apply the proposed semiparametric mixed model (3) to
the PamChip® array data and test the scenarios illustrated in Supplementary
Figure SS.

5 RESULTS

We apply the proposed method to a publicly available dataset from
Versele et al. (2009), which we described in Section 2. Similar
to microarray technology, ParnChip® data are also subject to
noise and we use background corrected intensity measurements
for the data analysis. Prior to ﬁtting the model, we examine
the data for unusual observations and extreme proﬁles. Outlier
removal has been done in three steps. First, we notice that some
of the observations are negative for a given kinase activity proﬁle.
The ParnChip® software reports background corrected intensities.
Hence, negative observations might occur when the measured
intensity for a particular peptide in a certain well does not exceed the
background signal. Negative intensity measurements are replaced
by half of the positive minimum intensity measurement of that
proﬁle. Second, we compute the area under the curve (AUC) for
each proﬁle of a given cell line. Analysis of variance has been carried
out based on those AUC values while taking the treatment as oo-
variate with two levels. Extreme proﬁles whose residuals are beyond
:I:2 X the square root of the mean squared error are removed. Third,
we look at the observations within a proﬁle and remove the extreme
observations if they differ more than :I:2>< standard deviations of the
proﬁle-speciﬁc mean. In this step, we are able to remove extremely
high intensity measurements (spikes). All these steps are repeated
for each peptide and each cell line. Supplementary Figures S6 and S7
illustrate these preprocessing steps for peptide AMPE_5_17_Y12
and cell line N87. The ﬁltered data are then log transformed to
stabilize the variability over time.

5.1 Results on a single peptide

We begin with analyzing peptide, TYRO3_67 9_69 l_Y6 8 6, which
is known to be biologically signiﬁcant (Versele et al., 2009). The
proposed penalized thin plate regression splines model is ﬁtted for
the particular peptide by using the gamm procedure available in
R package mgcv. The smoothing parameters can be estimated via
generalized cross-validation (Bowman and Azzalini, 1997; Ramsay
and Silverman, 2005; Wood, 2006). In this study, we use the link
between mixed model and splines. This is an advantage of ﬁtting
the thin plate regression splines within the mixed model framework.

 

>
CD

|092[ Intensity]
12
I
|092[ Intensity]
12
I

 

I I I I I I I I
0 10 20 30 40 50 60 0 10 20 30 40 50 60
Tlme[min] Time[min]

 

l092[ Intensity]
12
I
l092[ Intensity]
12
I

 

 

 

 

 

I I I I I I I I I I I I I I
0 10 20 30 40 50 60 0 10 20 30 40 50 60
Tlme[min] Time[min]

Fig. 2. Fitted smoothing spline for peptide ‘TYRO3_679_691_Y686’. Note.
that roughness penalty is set to m=3. The thick solid curve shows the
group-speciﬁc mean smoothing spline and the gray lines shows observed
logz transformed time proﬁles. The cell line-speciﬁc ﬁt and replicate-speciﬁc
ﬁts are given in Supplementary Figures S8 and S9. respectively. Replicate-
speciﬁc ﬁts for all the cell lines are shown in Supplementary Figure S10.
(A) NRiControl; (B) R£ontrol; (C) NR£ompound; (D) R£ompound.

We used penalized thin plate regression splines with a roughness
penalty on the third-order derivative m = 3 to obtain a smooth ﬁrst-
order derivative.

For this particular peptide, we test whether the group-
speciﬁc error variances are the same. The null hypotheses H0:
012?,Compound=012{Control and H0201%iR,Compound=aI%’R,Control are
tested using a Wald test. We found that treatment and control
have the same variance irrespective of their responsive statuses
(p1=0.521 and p2=0.189). Therefore, we reﬁt the model while
assuming different error variances for responsive and the non-
responsive cell line groups. The null hypothesis H0: GENR :03]? is
tested against alternative hypothesis H01 : GENR 5150621e using a Wald
test. We found that responsive and non-responsive cell line groups
have signiﬁcantly different error variances (p = 0.0001).

Further, we tried to reduce the proposed model by reducing the
cell line-speciﬁc as well as the replicate-speciﬁc random effects
structures. We test the null hypotheses H0: 0132 = 0 and H0: 062 :0
separately by using approximate likelihood ratio tests. However,
testing for the variance components has to be done with care because
the parameter of interest is on the boundary of the parameter space
(Pinheiro and Bates, 2000; Verbeke and Molenberghs, 2000). To
account for the boundary problem under H0, we can approximate
the null distribution of the test statistic with a mixture of X2-
distributions (Verbeke and Molenberghs, 2000). It is found that both
variance components are signiﬁcant (with P-values P1=0.0001
and P2=0.0001), implying the need for the random effects bzl'g
and c2j(l-g). Therefore, the proposed model (3) is not reduced.
Supplementary Table S1 shows the restricted maximum likelihood
estimates for the ﬁxed effects and variance components for the
model (3). Figure 2 shows the observed time series proﬁles and

 

2862

112 /3.10'S[1211,1110IpJOJXO'SOIJBLUJOJIIIOIq”K:qu uror} pepBo1u/noq

9103 ‘0g15n8nv uo ::

Mixed model for PamChip® peptide arrays

 

>

Velocity(t)
0.00 0.05 0.10 0.15 0.20 0.25
I I I I I I

Velocity(t) m
0.00 0.05 0.10 0.15 0.20 0.25

 

 

 

 

 

 

1 0 20 30 40 50 60

o.
o
N
o
o)
o
Js
o
m
o
a)
0
oz

 

 

 

 

 

 

Time [min] Time [min]
C m D m
N. — N. —
O O
O O
N. < N_ 7
O O
A "n A Ln
3 cs" 3 cs‘
8 e _ :3 e _
g d g g d
LO LO
0. < O. a
O O
O O
O. — O. —
O O
I I I I I I I I I I I I I I
0 10 20 30 40 50 60 0 10 20 30 40 50 60
Time [min] Time [min]

Fig. 3. Estimated velocity and the 95% pointwise conﬁdence
bands using the penalized thin plate regression splines for peptide
‘TYRO3_679_691_Y686’. Note. that roughness penalty is set to m :3. The
solid black curve indicates the estimated velocity and the gray color indicates
the conﬁdence bands. (A) NRiControl; (B) R£ontrol; (C) NRiCompound;
(D) RiCompound.

the estimated smoothers for each group. The solid thick curve
indicates the group-speciﬁc smoothing curve and gray lines indicate
the observed time series proﬁles for all replicates. Note, that the
replicate speciﬁc curves suggest a multimodal distribution of the
data for the control, which can be modeled by the hierarchical
structure of the random effects in Model (3). This is illustrated in
Supplementary Figures S8 and S9. There is a huge variation among
replicate speciﬁc proﬁles and among cell line-speciﬁc proﬁles. These
variations are incorporated in our model by replicate-speciﬁc and
cell line-speciﬁc random effects. Further, the variation between the
different 96-well plates is captured with the plate-speciﬁc random
effects. In Supplementary Figure S10, all ﬁtted replicate speciﬁc
proﬁles for all cell lines are displayed along with the data. It can
be seen that the model captures the variability between the proﬁles
adequately.

The phosphorylation rate, velocity, in model (3) is available over
time and therefore the initial velocitygan be extracted very easily
by evaluating the ﬁrst derivative of S (t) at 1:0. Further, standard
errors for the estimated velocity are also available. We construct
the conﬁdence bands around the group-speciﬁc velocity proﬁles
using the methodology discussed in Wood (2006) and Ruppert
et al. (2003). The estimated velocity proﬁles and 95% pointwise
conﬁdence bands for each group are shown in Figure 3. These are
the ﬁrst-order derivatives of the ﬁtted group-speciﬁc curves. The
phosphorylation rate is higher at the beginning of the experiment
and reaches a plateau after a few minutes. The estimated group-
speciﬁc mean curve for the R—Control ﬂattens slightly between time
interval 5—25 min (Fig. 2). This corresponds to the shape on the
corresponding ﬁrst derivative in Figure 3. This might seem unusual
for individual proﬁles if phosphorylation follows ﬁrst-order kinetics.
However, the relationship might be obscured, because we measure
phosphorylation indirectly by using noisy intensities corresponding

to ﬂuorescence of labeled antibodies that bind to the phosphorylated
peptides. Moreover, the average proﬁle should not necessarily have
the same ﬁinctional relationship as the individual curves. Although
the group speciﬁc mean curve ﬂattens slightly between 5 and 25 min,
this does not happen for the observed and ﬁtted individual kinase
activity proﬁles: they seem to reﬂect a realistic physiochemical
behavior (see Fig. 2 and Supplementary Figure S10, respectively).
However, the individual proﬁles reveal a huge variation among the
different cell lines within this time interval. Therefore, the shape in
the group-speciﬁc mean velocity proﬁle might be attributed to the
averaging process in a region where huge differences occur among
the cell lines.

Supplementary Figure S11 illustrates velocity proﬁles for
different groups and the differences in initial velocities between
the non-responsive and responsive groups. Later we show that
the difference for signature peptide TYRO3_679_691_Y6 86 is
statistically signiﬁcant.

5.2 Selecting the signature peptides

This section describes the identiﬁcation of signature peptides based
on both initial velocity and the entire velocity proﬁle using the
proposed model. Similar to Section 4.3, our aim is to identify
peptides with velocities that are different across the groups. The
hypotheses in (4) are tested at the initial time point as well as for
the entire velocity proﬁle.

The rate of phosphorylation is expected to be higher at the
start of the experiment than at later time points. Thus, the test
is ﬁrst performed using the initial velocities only. The hypothesis
given in (4) can be used to test for time [:0 with contrast
matrix L=[S’1(0) —S’2(0) Sg(0) —S:1(0)]. Second, we update this
hypothesis for drawing inferences based on entire velocity proﬁles
(Section 4.3). The updated contrast matrix L has as many rows
as the number of basis functions in the smoother described in
Section 4.3. The proposed model is ﬁtted for each peptide and the
testing procedure is repeated. P-values are corrected for multiplicity
using the false discovery rate (FDR) procedure of Benjamini and
Hochberg described in Benjamini and Hochberg (1995).

Based on the tests using the entire velocity proﬁle, 30 signature
peptides are discovered and tabulated in Supplementary Table S2
with the FDR corrected P-values. Supplementary Table S3
summarizes the maximum likelihood estimates of initial velocities
of signiﬁcant peptides along with their standard errors for each
group. P-values for all peptides are summarized in Supplementary
Figure S12.

6 DISCUSSION

Protein kinases are key regulators of important cellular processes,
including growth, stress response, differentiation and apoptosis.
For drug development, signal transduction research and clinical
research, in-depth insight in the effects of stimuli on multiple protein
kinases is often required in order to ﬁill understand the effects
of kinase inhibitors. The novel ParnChip technology enables us
to monitor kinase activity in a highly multiplex setting with wide
range of peptides. We have proposed a semiparametric mixed model
to analyze ParnChip® array data. Our aim was to model the kinase
activity proﬁles and estimate the rate of phosphorylation (velocity)
over time. The proposed approach is capable of modeling these

 

2863

112 /3.10'S[1211,1110IpJOJXO'SOIJBLUJOJIIIOIq”K:qu uror} pepBo1u/noq

9103 ‘0g15n8nv uo ::

F!J.Thilakarathne et al.

 

activity proﬁles while incorporating the correlation structure of the
data. Moreover, our approach does not require restrictive parametric
model assumptions and thus allows greater ﬂexibility by estimating
phosphorylation proﬁles with thin plate regression splines. Hence,
the risk of bias is greatly reduced as the estimates depend more on
empirical data and less on a priori assumptions. Further, estimation
and inference is performed in an uniﬁed way within the mixed model
framework. This approach makes it easy to ﬁt more complex models
by including additional ﬁxed effects, random effects or interactions.
Moreover, various error structures may be formulated for the errors
to account for spatial or longitudinal correlations (Pinheiro and
Bates, 2000; Verbeke and Molenberghs, 2000; Wood, 2006).

The main interest of this study was to estimate the phosphorylation
rate. Therefore, a smooth ﬁrst derivative of the ﬁtted phosphorylation
proﬁles is desirable. We have investigated different sets of basis
functions for model (3) and thin plate regression splines with a
smoothness penalty on the third derivative had the best performance
(Supplementary Section 9). Thin plate regression splines have the
additional advantage that basis functions, number of knots and
position of the knots naturally arise from optimizing the objective
ﬁinction given in (2). The proposed model belongs to the additive
mixed model family and can be ﬁtted using standard mixed model
software, e.g. with the gamm procedure in the R package mgcv
(Wood, 2006) or with procedure GLIMMIX in SAS.

Our semiparametric model overcomes several drawbacks of the
methods (Versele et al., 2009 and Hilhorst et (11., 2009). With
our model, we found 30 signiﬁcant peptides using tests based
on the entire proﬁles, and 25 based on the initial velocities,
10 of which were also found with the Versele method. The
differences between both methods can be explained as follows. Our
single stage approach captures the complex dependence structure
of PamChip® data and accounts for heteroscedasticity between
responsive and non-responsive cell lines. Therefore, it correctly
incorporates the uncertainty in the ﬁnal statistical inference. The
Versele and Hilhorst methods, however, are two-stage approaches
that summarize information of the individual time proﬁle into
a single summary statistic (initial velocities) and use the initial
velocities in the downstream analysis step without accounting for
the uncertainty on these estimates. Hence, they ignore the within
replicate variability and only capture the technical variation between
the replicates. The outcome of the second stage analysis can be
severely affected if the within variability of the replicates is large
compared with the between variability or if the uncertainty on
the initial velocity estimates differs arnong replicates, cell lines or
treatments. In the Versele experiment, the uncertainty on the velocity
estimates is bound to be different, because (i) some observations are
missing and preprocessing steps are necessary to remove outliers,
which results in a different number of observations for the different
proﬁles and (ii) due to the inherent heteroscedasticity between
the responsive and non-responsive cell lines. Hence, the model
assumptions in the second stage analysis of Versele et al. (2009)
were violated. Additionally, both Hilhorst and Versele approaches
also ignore the correlation between treatments, cell lines and
replicates that are assessed on the same 96-well plate, because
each phosphorylation proﬁle is preprocessed independently. The
random plate effect was also not included in their second stage
analysis. For our particular experimental design, the random plate
effect does not affect inference on the contrasts between Compound
and Control. However, we incorporate the random plate effect in

our model for three reasons. First, to ensure that we capture the
complex dependence structure of PamChip® data correctly: the data
of different cell lines that are placed on the same plate are correlated.
Second, to propose a more general model, which provides correct
inference for other potential contrast of interest and for unbalanced
designs. Third, to accommodate for experiments where the replicates
of a speciﬁc cell line are placed on different plates. Based on all
these arguments, the Hilhorst and the Versele methods are expected
to suffer from a loss in power, efﬁciency and an incorrect control of
the type-I error (Verbeke and Molenberghs, 2000).

The exponential model (Y; = Y0+ Ymax[1—exp(—ntj)]) that is
suggested by Hilhorst et al. (2009) can be integrated within a single
stage non-linear mixed model by specifying random effects on the
exponential model parameters:

Yiﬂg =b0ig +C0j(ig) +al + Y08+
(blig+clj(ig)+Ymax,g)X (5)
{1 —exp[—(ng +b2ig +62j(ig))’jl}

where bot-g, bug, c0j(l~g), c1108) and a) are cell line, replicate and
plate speciﬁc random effects, respectively. We adopted the model
in R and encountered issues related to numerical stability for some
peptides. In model (5), we explicitly assume that the individual time
proﬁles follow the Hilhorst model. However, this assumption does
not necessarily hold for the average group-speciﬁc phosphorylation
proﬁles. Usually there is no closed form solution for the average
evolution of non-linear mixed effects models (Fitzmaurice et al.
2008; Molenberghs and Verbeke 2005). Hence, it might not be
sufﬁcient to draw inference on the parameters Ymaxsg and 118
when assessing differences in the marginal group-speciﬁc velocity
proﬁles. This was conﬁrmed in our analysis; only one signiﬁcant
peptide could be detected with contrasts on model parameters Ymaxﬁg
and 118 (results not shown). Inference at speciﬁc time points is
even more challenging. The average velocity can be estimated at
a particular time point, however, standard errors and estimates of
the correlation between the velocities are lacking. In principle, they
can be approximated by the delta method or by using bootstrap
techniques. Alternatively, one could also perform Monte Carlo
Markov Chain (MCMC) simulations to sample from the posterior
mean of the velocity proﬁles. But, both bootstrapping and MCMC
will lead to a tremendous increase in numerical complexity. From
the discussion above, it is clear that inference on the average
group-speciﬁc velocity proﬁles of non-linear mixed models is not
straightforward. Another argument against non-linear mixed model
(5) is that we feel that the parametric assumptions of the exponential
model should be relaxed. The model is motivated by the assumption
that peptide phosphorylation follows ﬁrst-order reaction kinetics. In
practice, this might be too restrictive and competing kinetic models
might be more appropriate. The reaction kinetics, however, will
also be obscured as the phosphorylation is followed indirectly by
measuring the ﬂuorescence of labeled antibodies that bind to the
phosphorylated peptides. Similar to conventional microarray data,
a log transformation of the intensities is beneﬁcial to stabilize the
variance, which again will affect the functional form of the proﬁles
that have to be modeled. Our semiparametric method estimates
the phosphorylation proﬁles in a data-driven way by using thin
plate regression splines without imposing an a priori ﬁinctional
relationship. The thin plate regression splines can be represented as a

 

2864

112 /3.10'S[1211,1110IpJOJXO'SOIJBLUJOJIIIOIq”K:qu uror} pepBo1u/noq

9103 ‘0g15n8nv uo ::

Mixed model for PamChip® peptide arrays

 

linear combination of a set of non-linear basis functions. Therefore,
our model is very ﬂexible while remaining linear in the model
parameters. This approach is very attractive: it relaxes the model
assumptions and simpliﬁes statistical inference as it can build upon
the standard theory of linear mixed models.

7 CONCLUSION

We have applied penalized thin plate regression splines within
a linear mixed model framework to ParnChip® microarray
data. We discovered 30 signature peptides that are signiﬁcantly
phosphorylated by the novel multitargeted kinase inhibitor. From
the 30 peptides, 10 are also identiﬁed by the Versele et al. (2009).
We demonstrate how one can obtain the group-speciﬁc velocities
and provide inference on velocity contrasts at individual time points
or based on the entire proﬁle. Our ﬂexible modeling approach can
easily be adapted to ParnChip® array data with various experimental
designs.

ACKNOWLEDGEMENT
We would like to thank the three anonymous referees for very useﬁil

comments and suggestions in an earlier version of this article.

Funding: This research was supported by IAP research network
grantnr. P6/03 of the Belgian government (Belgian Science Policy)
and by SymBioSys, the Katholieke Universiteit Leuven, Center of
Excellence on Computational Systems Biology, (EF/05/007).

Conﬂict of Interest: none declared.

REFERENCES

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. R. Stat. Soc. Ser B, 57, 2897300.

Bowman,A.W. and Azzalini,A. (1997) Applied Smoothing Techniques for Data Analysis.
Oxford Science Publications, New York.

Durban,M. et al. (2004) Simple ﬁtting of subject-speciﬁc curves for longitudinal data.
Stat. Med., 24, 115371167.

Fitzmaurice,G. et al. (eds) (2008) Longitudinal Data Analysis. Chapman & Hall/CRC,
New York.

Hilhorst,R. et al. (2009) Peptide microarrays for detailed, high-throughput substrate
identiﬁcation, kinetic characterization, and inhibition studies on protein kinase A.
Anal. Biochem, 387, 1507161.

Kondapalli,L. et al. (2005) The promise of molecular targeted therapies: Protein kinase
inhibitors in the treatment of cutaneous malignancies J. Am. Acad. Dermatol., 53,
2917302.

Maringwa,J. et al. (2008) Analysis of cross-over designs with serial correlation within
periods using semi-parametric mixed models. Stat. Med, 27, 600976033.

Nagaoka,T. et al. (2005) Use of a three-dimensional microarray system for detection
of levoﬂoxacin resistance and the mec A gene in Staphylococcus aureus. J. Clin.
Microbiol., 43, 518775194.

Molenberghs,G. and Verbeke,G. (2005) Models for discrete longitudinal data. Springer
Series in Statistics. Springer, New York.

Perera,T. et al. (2006) JNJ-26483327 is a novel multi-targeted tyrosine kinase inhibitor
with cellular activity against EGFR, Her2, Src and VEGFR3. EJC, 4, 178.

Pinheir0,J.C. and Bates,D.M. (eds) (2000) Mixed-Eﬂects Models in S and S-PLUS.
Springer Series in Statistics and Computing. Springer, New-York.

Ramsay,J.O. and Silverman,B.W. (eds) (2005) Functional Data Analysis, 2nd edn.
New York, Springer.

Ruppert,D. et al. editors (2003). Semiparametric Regression. Cambridge University
Press, New York.

Verbeke,G. and Molenberghs,G. (2000) Linear Mixed Models for Longitudinal Data.
Springer Series in Statistics. Springer, New York.

Versele,M. et al. (2009) Response prediction to a multitargeted kinase inhibitor in cancer
cell lines and xenograft tumors using high-content tyrosine peptide arrays with a
kinetic readout. Mol. Cancer Therap, 8, 184&1855.

W00d,S.N. (2006) Generalized Additive Models: An Introduction with R . Chapman &
Hall/CRC, New York.

 

2865

112 /3.Io's1Burno[pJOJXO'sothJJOJutotqp:duq uror} pepeo1umoq

9103 ‘0g isanV uo ::

