ORIGINAL PAPER

Vol. 28 no. 18 2012, pages 2297-2303
doi:10. 1 093/bioinformatics/bt3362

 

Gene expression

Advance Access publication June 23, 2012

Inferring epigenetic and transcriptional regulation during blood
cell development with a mixture of sparse linear models

Thais G. do Regol, Helge G. Roider2, Francisco A. T. de Carvalho1 and Ivan G. Costa“
1Center of Informatics, Federal University of Pernambuco, Recife 50740—560, Brazil and 2Discovery Bioinformatics,

Merck KGaA, Merck Serono, Darmstadt, 64293, Germany

Associate Editor: Gunnar Ratsch

 

ABSTRACT

Motivation: Blood cell development is thought to be controlled by
a circuit of transcription factors (T Fs) and chromatin modifications
that determine the cell fate through activating cell type-specific
expression programs. To shed light on the interplay between histone
marks and TFs during blood cell development, we model gene
expression from regulatory signals by means of combinations of
sparse linear regression models.

Results: The mixture of sparse linear regression models was able
to improve the gene expression prediction in relation to the use of
a single linear model. Moreover, it performed an efficient selection
of regulatory signals even when analyzing all TFs with known
motifs (>600). The method identified interesting roles for histone
modifications and a selection of TFs related to blood development
and chromatin remodelling.

Availability: The method and datasets are available from
http://www.cin.ufpe.br/~igcf/SparseMix.

Contact: igcf@cin.ufpe.br

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 4, 2012; revised on June 4, 2012; accepted on
June 18, 2012

1 INTRODUCTION

Blood development in mammals is an ideal system to study cell
differentiation and proliferation. All blood cells arise from a single
multipotent hematopoietic stem cell (HSC). This stem cell can
differentiate in lymphoid and myeloid progenitors, which will
give rise to erythrocytes and immune cells such as monocytes,
megakaryocytes, B and T cells (Matthias and Rolink, 2005; Orkin
and Zon, 2008; Rothenberg and Taghon, 2005). The different cell
types are distinguishable by speciﬁc cell surface proteins and can
readily be obtained from the blood of adult individuals through
cell sorting. For the puriﬁed cell populations, cell type-speciﬁc
expression proﬁles and DNA—protein interactions can subsequently
be obtained using microarrays and Chromatin immunoprecipitation
(ChIP) assays (Novershtern et (11., 2011; Weishaupt et (11., 2010).
Blood cell development is thought to be controlled by a Circuit
of transcription factors (TFs), that determine the cell fate through
activating cell type-speciﬁc expression programs (Barreda and
Belosevic, 2001; Dor and Crispino, 2011; Matthias and Rolink,
2005; Orkin and Zon, 2008; Rothenberg and Taghon, 2005).

 

* To whom correspondence should be addressed.

In addition, there is an increasing awareness of the role of Chromatin
structure in regulating expression during development (Goldberg
et (11., 2007). In particular, the presence or absence of post-
transcriptional histone modiﬁcations (HMs), termed the ‘histone
code’, modulates the afﬁnity of histones to DNA and thus determines
whether a DNA region is accessible for the transcriptional
machinery (Kouzarides, 2007; Turner, 2007). For instance, the
histone marks H3k4me3, H3k79me and H3kac are known to be
associated with genes that are either actively transcribed or whose
transcription is readily activated upon stimulus while promoters
bearing the histone marks H3k27me3 and H3k9me3 tend to be
inactive. Understanding the interplay between particular HMs and
TF binding is crucial for uncovering cell differentiation processes.

To shed light on the interplay between histone marks and TFs
during blood cell development, in this study we model gene
expression by means of combinations of linear regression models.
The main idea behind this approach is to combine all regulatory
signals to explain the expression pattern of the genes, as TFs
and HMs can act in a multi-ﬁinctional manner, conveying both
transcriptional repression and activation depending on their location
with respect to the transcription start site (T55) and the presence of
other TFs in the surroundings (Fig. 1). The value of the regression
coefﬁcients thereby indicates not only the importance of a particular
regulatory signal (Bussemaker et (11., 2001; Karlie et (11., 2010;
Keles et (11., 2002) but also whether a signal activates or represses
transcription. We have recently shown that combining more than one
regression model in a mixture, where each of the regression models
explains the expression of a particular group of genes, improves
the expression prediction and identiﬁcation of important regulatory
players (Costa et (11., 2011).

Previous works were however based on the analysis of only a
small subset of possible regulatory signals (<100) (Bussemaker
et (11., 2001; Costa et (11., 2011; Karlie et (11., 2010; Keles et (11.,
2002), as standard linear regression suffers from over-ﬁtting on
high-dimensional space (Hastie et (11., 2003). In addition, regulatory
signals tend to be correlated, with a given subset of TFs and/or
HMs being present on the same group of promoters. Although
it is important that the model indicates all regulatory signals
that are important to a particular cell type, standard regression
models give arbitrary coefﬁcients for correlated (or co-linear)
variables, failing to give a proper interpretation of all important
variables (Tibshirani, 1996; Zou and Hastie, 2005). Here, we propose
a novel methodology, mixture of sparse linear regression models,
to describe the expression of genes. Sparse linear models perform a
time efﬁcient selection of important features even in the presence of a
high number of regression variables. The sparse model is determined

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2297

112 /3.Io's[BrunoIpJOJXO'sotwurJOJutotq”:duq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

T.G.do Rego et al.

 

Blood Cell Development

 

V1= X1 ' 8‘
[I] 2
(U
’ : igm_
.E“
tn IE
3‘ Earn
0 ru
= H
.2 2 8
m , :l .an—numnx
 / eeww NEE:
D. ’ 5555 I ".23.;
x ’ "4 g zﬁmf
W :5"; I:
g \ II
\ —
.J \v,— 1r2 - a,
'3 i.»
Q. m
o. I: .3 ._
E ’g cm
‘” 2  I
>'- U
.0- E00
O-I' U Mgggu
. '—° 8 § iii
-. 3 Liv—:ihg
mgﬁﬂﬁﬁ 1:2;
Bung: 11
man.
:%:"I
=

Mixture of Sparge Linear Regression

Fig. 1. Schematic blood cell developmental tree (top) and a sample mixture
model inferred on the MPP cell (bottom). The mixture model predicts
the gene expression of genes of a particular cell type Yidepicted as a
redigreen bariby the regulatory signals of the genes X idepicted as the
blueiwhite plot, where blue values indicate a higher presence of the histone
in a gene promoter. The coefﬁcients B indicate the roles of each regulatory
signal. The mixture of sparse linear regression search for groups of genes,
whose expression are determined by the same regulatory network. For
example, model 1 predicts genes with high expression and indicates that
H3k4me3 and H3k79me2 are activators of expression and H3k27me3 and
H3k27me3 are repressors of expression. The elastic net method gives similar
coefﬁcients to co-linear signals, such as the pairs H3k79me2/H3k4me3 and
H3k27me3/H3k9me3. Also, irrelevant signals, such as H3ac are removed,
i.e. have the coefﬁcient set to 0. Note that distinct models indicate distinct
regulatory elements. For model 2, only the HMS H3k4me3, H3k79me2 and
H3kac were selected as relevant for determining the activity of low expressed
genes

with the elastic net algorithm from Zou and Hastie (2005) and
Friedman et (11. (2009). The elastic net displays the so-called
grouping effect, that is, co-linear variables are simultaneously
included in or excluded from the model and all grouped variables
have equivalent regression coefﬁcients (Fig. 1). Therefore, our
method is not only capable of analyzing all TFs with known motifs
(>600) but also allows to identify all regulatory signals (co-linear
or not), which play an important role in a particular cell type.

1.1 Related work

The use of linear regression methods for predicting gene expression
from TF binding sites were ﬁrst proposed in Bussemaker et (11.
(2001) and Keles et (11. (2002), and regarding HMs, in Karlie et (11.
(2010). In Keles et (11. (2002), the problem of the dimensionality

was approached with a computationally expensive backward feature
selection. Ouyang et (11. (2009) performed the prediction of gene
expression on stem cells from a few TF binding sites derived
from genome wide Chromatin immunoprecipitation assays. Later,
Park and Nakai (2011) proposed an extension of this work by
integrating HM and DNA methylation data. The method was based
on an initial discretization of histone marks to detect epigenetic
states and indicated an advantage in combining both data types.
Recently, Cheng et (11. (2011) proposed a methodology for predicting
the expression over genomic regions, as measured by RNA-Seq, for
>50 regulatory signals during Caenorhabditis Elegans development.
Regression predictions were based on a Support vector machine
(SVM), which can deal with high dimensionality but did not
indicated feature importance.

2 METHODS

2.1 Sparse linear regression

Here, we propose the use of a mixture of sparse linear models for modeling
the expression of genes given their regulatory signals: presence of HMS or TF
binding sites in the promoter region of a gene. Let y, be the gene expression
level of gene 1' (the dependent variable), and xi=(xi1, ...,Xip) be a vector with
the P regulatory signals (the regressor variables) of gene 1', where i = 1,..,N.
A single linear regression model can be deﬁned as

YiZXiB‘l‘éiv (1)

where B is a vector (In , ...,bp)T representing regression coefﬁcients and 6,» is
an error term (we ignore for simplicity the b0 coefﬁcient). We use an Elastic
Net estimation for obtaining a sparse linear model (Zou and Hastie, 2005).
For a given data X and Y, where X is a set on N observations x, and Y a
vector with N observations )1), the elastic net is based on ﬁnding B, which
minimizes the criterion (Zou and Hastie, 2005)

1
Lone): ﬁrY—XBVHI -A2IB|+M 11—12136. (2)

where |B|=Zf21|bj| and |B|§=ﬂzf:,b}).

The last two terms on the right are the L1 and L2 penalizations. The
L1 penalty, also denoted as lasso penalty, performs feature selection by
shrinking some of the coefﬁcients until reaching zero (Tibshirani, 1996).
The L2 penalty shrinks coefﬁcients towards zero and is equivalent to the
ridge regression (Hastie at 611., 2003). However, the L2 penalty does not
perform feature selection as it is unable to assign zero values to coefﬁcients.
The parameter A] gives the stringency of the penalizations and M, which
varies from 0 to 1, balances between the L1 and L2 penalties. The main
advantage of the elastic net is the so-called ‘grouping effect”, that is, highly
correlated variables tend to be either included or excluded from the model
in groups (Zou and Hastie, 2005). Such an effect is not present in the lasso
penalization alone, which tends to include only one of the correlated features
in the model.

2.2 Bayesian elastic net

We use a Bayesian interpretation of the elastic net. Therefore, we can easily
plug in the models in a mixture model framework. Assuming the error e
in equation (1) follows a Normal distribution with variance :72, the linear
regression model has the following distribution:

 

My,»Ixi.B.a2)=N(yi|xiBT.a2> (3)
1 a a
_ -(yr-Xi3)‘/20‘

— 27102 exp i (4)

As pointed out by (Li and Lin, 2010), the L1 and L2 penalization terms are
equivalent to a Laplace and Gaussian distribution, respectively, with mean 0,

 

2298

112 /8.IO'S[BHmO[p.IOJXO'SOIJBLUJOJIIIOIq”Idllq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

Inferring epigenetic and transcriptional regulation

 

that is
1P(B|a2)=Lap1ace(B|0P,IPrf‘)N(B|0p.1pr{”2) (5)

111’ _ I; P/2 _ 2
=— exp ‘8‘“ — exp 8 12
2 271

. (6)

where OP is a P-dimensional vector with entries equal to 0 and Ip is a P X P
identity matrix. We use a gamma distribution as prior to regularize r72 (Hastie
et (11., 2003)

a

 

mow): b (1/a2>"“e"’/"2. (7)

PM)
where a and b are hyper-parameters. Maximum-a-posteriori (MAP) estimates
of the regression parameters can be determined by maximizing the posterior
distribution

1P(B,02|X,Y,7:1,12):nfilN(y1|X1BT,oz)lP(B|oz,7:1,rz)1P’(o‘2 |a,b). (8)

It is straightforward to see that the log of the posterior distribution is
equivalent to equation (2) for rlszlkz/az and 12=NA1(1—A2)/c72.
Therefore, the minimization of B for ﬁxed :72, A] and A2 is equivalent to
the Elastic net and any algorithm for solving the Elastic Net can be applied.

2.3 Mixture of sparse linear models

A mixture of linear regression models is obtained by a convex summation of
K linear distributions

K
Poilxi. @) = 2m. News? of). (9)
k:l

where 01 = (011 , ...,01K) are the mixture coefﬁcients such that 01k 3 0,
21:100. :1 and 8 are the model parameters (01,B1 , ...,BK,012, ...,a,%). For
given data X and Y, where X is a set on N observations x, and Y a vector with
N observations )1), the mixture of sparse linear models is estimated with a
(MAP) version of the expectationimaximization (EM) algorithm (Dempster
et (11., 1977; DeSarbo and Cron, 1988). The EM algorithm ﬁnding estimates
8 that maximize the posterior distribution over the data X and Y,

1P(®|X,Y,Z)%1P(Y,Z|X,®)lP(®), (10)

where Z is the vector of hidden variables with z, e {1, ...,K} indicating which
linear model an observation 1' belongs to and 1P(Y,Z|X ,8) is the complete
data likelihood. 1P(®) is the prior distribution over the model parameters

K
Fresnel—[Penman (11)
k2]

where 113(01) follows a Dirichlet distribution and 1P(Bk) and 113(0)?) are equal
to the Elastic Net priors deﬁned in equation (6). The EM algorithm works by
iteratively estimating the posterior probabilities that an observation belongs
to a linear model and the parameters of the linear models 8 until convergence.
Let rik be the posterior probability (or responsibility) (McLachlan and Peel,
2000) that observation 1' belongs to the linear model k:

Olk/Wyz’ IXin 1 013)

Vik=P(Zi=klyi,xi)=—_ (12)
215;; 011a 'NUiIXin/ﬂkzi)
Considering the linear model parameters, a]? is estimated as follows:
N 2
» r» »—x»B 2b
U13 2 M (13)

N+3P+2a—2

where a and b are hyper-parameters. This is an approximation of 0,3, which
is independent of the shrinkage of Bk, and yields good empirical results (Sun
and Zhang, 2010). The estimator of Bk is analogous to the Elastic Net. Here
we use an efﬁcient implementation of the algorithm based on gradient descent
described in Friedman et a1. (2009), where observations are weighted by their
posterior probabilities to give estimates for each mixture component.

2.4 Data

2.4.] TF aﬁ‘inity In this work, we use the Transcription factor Afﬁnity
Prediction (TRAP) approach (Roider et (11., 2007) to predict the binding
afﬁnity of a given TF to a given promoter sequence. The TRAP method
computes a continuous score estimating the expected number N ofTFs bound
to the promoter. As input, TRAP takes for each TF a position frequency matrix
(PFM) suitable for computing mismatch energies and a DNA sequence of
interest (see Roider et a1. (2007) for details). PFMs represent how often a
given base occurs at a given position within a set of aligned known binding
sites of a TF. In our study, we use 599 PFMs from the Transfac database
version 11.1 (Matys et (11., 2003). To minimize the number of false-binding
predictions, we limit the analysis to proximal promoters covering the ﬁrst
200 bp upstream of the TSSs of the genes. In the end, we obtain a matrix X
containing the TF binding predictions, where xigj corresponds to the afﬁnity
of TF j to the promoter of gene 1'.

2.4.2 Blood gene expression and HM data Affymetrix mRNA expression
data were obtained from the Gene Expression Omnibus (GEO) database
for HSCs, multipotent progenitors (MPPS), megakaryocyte/erythrocyte
progenitors (PreMegE) and CD4+ T cells (TCD4) in Mus museulus (GEO
accession number GSE18669). We use the MASS normalized data provided
by the authors (Weishaupt et (11., 2010). Final expression values are computed
by taking the median of replicates followed by a log transformation. In
addition, for each of the above cell types, we also obtained the binding
location of the histone marks H3K4me3, H3K79me2, H3ac, H3K9me3 and
H3K27me3 (Weishaupt et (11., 2010). These HM data were measured with
mini ChIP-chip experiments and are available from GEO (accession number
GSE18734).

For computing the histone mark proﬁles, we use the MA2C program (Song
et (11., 2007) using a window-size of 1000 bp at P-Value cutoffs of 0.5 and
the minimum number of probes required in the sliding window to be 5. The
choice of a high P-Value is based on the fact that we want continuous location
measurements over the most possible genes regardless of the presence of a
peak. Bound regions are annotated with the CEAS program (Shin et (11.,
2009). All analysis are based on the genome version NCBI36/MM8. As
‘regulatory signal”, for each gene and histone mark, we compute the sum of
the binding signals in the region :1: 1000 bps around the respective TSS. HM
values are incremented by a small value (0.0001) to avoid zeros and then
log-transformed. For subsequent analysis, we excluded genes for which less
than two histone were measured. Previous studies have shown that CpG rich
promoters tend to be active in many tissues and contain few cell type-speciﬁc
TF binding signals while CpG depleted promoters are often active in a cell
type-speciﬁc manner and have cell type-speciﬁc TF binding sites close to
their TSS (Roider et (11., 2009). We therefore restrict our analysis to those
4089 genes which have CpG-depleted promoters (normalized CpG content
< 0.5). Finally, each binding signal is normalized to have mean equal 0 and
standard deviation equal 1 across all genes.

2.4.3 ES gene expression, HM and1 TF data As a second test case, we
obtained a gene expression dataset from murine embryonic stem (ES) cells
(Ouyang et (11., 2009). In addition, we downloaded ChIP-Seq binding location
data for the histone marks H3K4me3, H3K36me3, H3K9me3, H4K20me3
and H3K27me3 from (Mikkelsen et (11., 2007) as well as for the TFs E2f1,
n-Myc, fo, c-Myc, Klf4, chcp211, Esrrb, Nanog, Oct4, Sox2, Stat3 and
Smadl from Park and Nakai (2011) (GEO accessions GSE18734, GSE12241
and GSE11431). For normalization of the data, we applied the same pipeline
as describe above.

2.5 Experimental design

We perform mixture estimation for modeling expression in four
hematopoietic cell types (HSC, MPP, PreMegE and Tcd4) and one ES cell.
We use in each scenario either TF afﬁnities, HM and their combination
(HM/TF). We vary the number of linear models from 1 to 10, the parameter
A; is set to 0.5 and A] is varied within (0,0.01,0.05,0.1,0.5, 1.0). The choice

 

2299

112 /3.Io's[BumoIpJOJXO'soneurJOJHtotq”:duq urog papeo1umoq

9103 ‘0g15n8nv uo ::

T.G.do Rego et al.

 

of A2 represents the most parsimonious parametrization: L1 and L2 penalty
are equal. The choice of A 1 , which is the main parameter controlling model
sparsity, varies from no sparsity (0) to very high sparsity (>1).

We use the Bayesian Information Criterion (BIC) as deﬁned in (Zou
and Hastie, 2005) to indicate the best A] parameterization. BIC is a model
selection procedure that indicates which models present the best tradeoff
between ﬁt of the data and model complexity. A mixture with several models
and using all regulatory signals can yield a good ﬁt to the training data,
but due to its complexity will most likely over-ﬁt the data. To evaluate the
performance of the best A] parameterization as indicated by the BIC criteria,
we perform a costly but more powerful 10-fold cross-validation procedure
and measure the normalized mean squared regression error (NMSE).

1 N
NMSE: N 201—9,»)? (14)
i2]
Lastly, we use a statistical test proposed by Cule et a1. (2011) to identify the
regression coefﬁcients which are signiﬁcantly distinct from 0. This test takes
into consideration the penalization imposed by the Elastic Net and sample
size.

The method implementation is based on Pymix (Georgi et al., 2010) and is

freely available at http : / /www. cin . ufpe .br/ Nigc f /SparseMix.

3 RESULTS AND DISCUSSION

In the following, we apply our method for predicting gene
expression using HM data, TF or HM data in combination with
TF (HM/T F) binding predictions as input. The quality of the
expression predictions made by our algorithm relies on identifying
the appropriate number of regression models to be used as well as
on the optimal model parameter M which determines how many
regulatory signals will be used in the predictions. The larger the Al,
the smaller is the number of regulatory signals used in the model.

3.1 Predicting gene expression in blood cells

We apply our regression model to four mouse blood cell
types (Weishaupt et (11., 2010) for which both mRNA expression
data as well as histone binding data are available (Fig. 1). To identify
the optimal settings for our algorithm, we apply the model selection
criteria BIC (see Section 2.5 for details).

BIC indicates that using two regression models and M = 0.05 for
HM data, M = 0.1 for TF and M = 0.01 for HM/TF data are optimal
to predict gene expression over all cell types. We base the ﬁirther
analysis on these model selections.

For predicting gene expression in HSC cells and HM data alone
using two linear models, the algorithm selects four histone marks out
of ﬁve available while for the highly dimensional scenario with TF
data only 67 regulatory signals out of 599 were selected. For HM/T F
data, 39 regulatory signals out of 604 are selected. As desired the
feature selection is more stringent when providing also TF data. This
indicates that HM signals are more predictive of gene expression and
as expected not all TFs are relevant for the cell types analyzed.

Another interesting aspect is the robustness with which speciﬁc
regulatory signals are selected by the mixture with different number
of linear models. For HSC cells with HM and TF combined, the
number of selected regulatory signals for 1 to 10 models are 4, 29,
51, 54, 55, 55, 55, 55, 55 and 55, respectively. We observe that more
regulatory signals are retained when more linear models are added.
Importantly, the signals selected by the simple mixtures are thereby
retained in the more complex ones, demonstrating a high degree of
robustness (see Supplementary Material for complete data).

 

1 2 3 4 5 6 7 3 9 1 0 1 2 3 4 5 6 7 3 9 1 0
No. Components No. Components
- HM/TF
Tcd4 PreMegE E HM

 

B 9 10 1 2 3 B 9 10

4 7
No. Linear Models

4 7
No. Linear Models

Fig. 2. NMSE of mixture models using HM, TF and HM/TF signals on
HSC, MPP, Tcd4 and PreMegE cells. Asterisks indicate cases where HM/TF
data have signiﬁcantly smaller NMSE values than HM and TF alone (paired
t-test P-Value < 0.05)

To further evaluate the appropriate number of regression models,
we perform a cross-validation procedure using the optimal values
of M as indicated by BIC. As shown in Figure 2, compared with the
single linear model NMSE improves signiﬁcantly when two models
are used (paired t-test P-value <0.01). However, no signiﬁcant
difference was found when comparing the NMSE from two linear
models with that of three or more linear models.

Interestingly, the two linear models always separate the data into
high and low expression genes on all blood cells. For instance,
on HSC and HM data, the high expression module has a mean
expression of 4.9 (1.6 std) over 790 genes and the low expression
a mean of 2.5 (0.85 std) over 3297 genes (see supplement for a
histogram with expression distributions). Similar results are found
for all cell types or with TF data. Note that some genes belonging
to the low expression models also display some level of expression
and we cannot make assumptions about their activity.

A close look at the relation between the main regulatory signals
controlling HSC expression reveals that mixture models improve the
prediction by capturing non-linearities. As exempliﬁed in Figure 3,
in HSCs the repressive histone mark H3k27me3 is found on
all low expression genes with similar frequency while for high
expression genes, the amount of H3k27me3 is inversely proportional
to expression level.

As shown in Figure 2, the use of combined HM/TF data results
in the smallest NMSE in all cell types. A paired t-test (P-value
<0.05) indicates a signiﬁcant NMSE improvement for HM/TF data
in several cases (see * marks in Fig. 2). In Sections 3.3 and 3.4, we
will look at predictions for individual histone marks and TFs based
on the HM/TF data.

An alternative to use NMSE for evaluating the gene expression
prediction is to compute Pearson correlation coefﬁcients. For HM
data on HSC, we obtain a correlation coefﬁcient of 0.54 for one
model and 0.75 for two models. This correlation coefﬁcient is
smaller than reported in Karlic et (11. (2010), which was 0.72 for
low CpG genes for a single linear model based on H3K4me3 and
H3K79me2 histone markers on T CD4 cells. We stress however
that the T CD4 data used in Karlic et (11. (2010) were based on
ChIP-Seq, which yield more precise histone location signals than
the mini-ChIP-Chip protocol used in the blood cells.

 

2300

112 /3.Io's[BumoIpJOJXO'soneurJOJHtotq”:duq urog papeo1umoq

9103 ‘0g15n8nv uo ::

Inferring epigenetic and transcriptional regulation

 

  
 

H3k79me2

 

: HSC Exprasion

Fig. 3. Association between the presence of histone markers (H3k79me2
and H3k27me3) and gene expression in HSC cells. Lines indicate the
regression models for the lowly and highly expressed genes

3.2 Predicting gene expression in ES cells

As a second and independent test case for validating the expression
prediction power of the proposed method, we applied the mixture
of sparse linear models to an embryonic stem ES cell dataset, which
contains gene expression and ChIP-Seq measurements for ﬁve HMs
and 12 TFs (Mikkelsen et (11., 2007; Ouyang et (11., 2009). For this
dataset, BIC indicates that two models with Al =0.01 are optimal,
while NMSE obtained after cross-validation indicates three models
to be optimal. Pearson correlation coefﬁcients for 1, 2 and 3 models
are thereby 0.68, 0.76 and 0.89, respectively, demonstrating a clear
improvement of the mixture models over a single linear regression
model.

Similarly to what was obtained for blood cells, the mixture
consists of a low expression model capturing 3312 genes and, in this
case, two high expression models capturing the expression of 451
and 476 genes. This again suggests that there exist distinct modes of
regulatory control for lowly and highly expressed genes (for detailed
results see supplement).

3.3 Inferred role of histone marks in blood cells

In this section, we analyze the speciﬁc effects of the HMs H3K4me3,
H3K79me2, H3ac, H3K9me3 and H3K27me3 on gene expression in
blood cells as indicated by the optimal model obtained in Section 3.1
(two linear models and 21:0.05). The relevance of a particular
modiﬁcation can be estimated from the regression coefﬁcients of
the optimal linear model. That is, we apply a statistical test (Cule
et (11., 2011) that indicates how signiﬁcantly a particular coefﬁcient
deviates from zero for each of the regression models. In Figure 4,
we display the signiﬁcant coefﬁcients of the HMs as obtained for
the models for lowly and highly expressed genes across all blood
cell types.

For highly expressed genes, H3k79me2 shows signiﬁcant positive
association with gene expression levels across all cell types while
H3ac and H3K4me3 have signiﬁcant positive association in MPP
and T cells. For genes with low expression, H3K4me3 is positively
associated with expression in MPP and T cells and H3k79me2 in
HSC and PreMegE cells. These ﬁndings are mostly in accordance
with previous works (Barski et (11., 2007; Ernst and Kellis, 2010;
Weishaupt et (11., 2010), where these modiﬁcations are related
to active promoters and expressed genes. Considering repressive
marks, we observe that for genes with high expression both
H3k9me3 and H3k27me3 have negative coefﬁcients in HSC, MPP
and T cells. For PreMegE, only H3k27me3 has a signiﬁcant negative
coefﬁcient. For the group of lowly expressed genes, only H3k9me3
in MPP cell obtained a signiﬁcant negative coefﬁcient.

HM Coefficients — High Exp. Genes

0.5
H3ac
0.4
H3K4me3
0.2
H3K79me2
H3K9me3 ‘02
_o.4
H3K2?me3

HSC MPP PreMegE T—cell

O

 

HM Coefficients — Low Exp. Genes

0.1
H3K4me3
0.05
H3K79me2 0
—0.05
H3K9me3
—0.1

HSC MPP PreMegE T—cell

 

Fig. 4. Heatmaps of HM coefﬁcients that signiﬁcantly affect the expression
of distinct groups of genes (high or low expression) and cell types (P-
value <0.05). Red and green indicate positive and negative coefﬁcients,
respectively

Importantly, the selection of histone marks and their regulatory
role indicated by the models is highly robust against changes in
the complexity of the mixture model. The only exceptions are the
positive correlation between H3ac and H3k79me2 with expression
in MPP cells which was only detected with the mixture model as
well as the association of H3k4me3 in HSC and PreMegE which
was only detected with the single model. Therefore, the simple
linear model and the mixture model appear largely equivalent with
respect to correctly inferring the role of histone marks on expression,
despite the clear advantage of the mixture model for predicting gene
expression levels.

3.4 Inferred role of TFs in blood cells

In addition to the modiﬁcations of histones, we also observe the
effects of TFs in the four blood cell types (two linear models,
Al =0.01 and HM/T F data). Out of the 600 TFs, 31 had a statistical
signiﬁcant coefﬁcient (P-value <0.05) in at least one condition (see
Fig. 5 for the list of TFs). Out of the 31 TFs, 15 were related
to development on hematopoietic system (E2F1, Foxj2, Nf-E2,
Nrf2, Cp2, Foxd3, Hifl, Evil, sz1, sz1, Gﬁ1, Arp1, Hox9-
MeislB, Pax1 and er), 5 with chromatin structure remodeling
(Facl, Hsf, Kaiso, Sp1 and Egr-l), 7 embryonic development (Pax6,
Axl4, Pbx, Pax4, Rbpjk, fol and ChCh) and only 3 had no
relation to hematopoiesis (Capl, Lxr and Cdx-l). See supplement
for an detailed discussion of these factors. This indicates a clear
enrichment of recovering TFs related to chromatin reorganization,

 

2301

112 /3.Io's[BumoIpJOJXO'soneurJOJHtotq”:duq urog papeo1umoq

9103 ‘0g15n8nv uo ::

T.G.do Rego et al.

 

TF Coefficients — High Exp. Genes

Facf 0.05
Hsf
E2E1
FOEZ
Nf- 2
Ner

   

Pax1
fo1
Lxr

HSC MPP Pre MegE T-cell

TF Coefficients — Low Exp. Genes

-0.01

 

HSC MPP PreMegE T-cell

Fig. 5. Heatmaps of TF coefﬁcients that signiﬁcantly affect the expression
of highly expressed genes (top) and lowly expressed genes (bottom) in
different cell types (P-Value < 0.05)

hematopoiesis and development. Moreover, the results with a single
linear model had none TF with a signiﬁcant regression coefﬁcient
value. These indicates the power of the mixture of sparse linear
models in recovering interesting TF candidates from hundreds of
candidates.

We concentrate our discussion on TFs with potential chromatin
remodeling function. Of the selected TFs, 11 are involved in the
activation process of expression in genes associated with high
expression (Fig. 5 top). The TF FACl—also known as Bptf—is
present in the process of gene activation in HSC, MPP and T-cell.
This gene is a component of the NURF complex, which is known
to promote trimethylation of the H3 lysine 4 and gene activation
in mammals (Wysocka et (11., 2006). Another protein that has been
related to immune cell development is HSF (Morange, 2006), which
acts as a activator of expression in HSC and PreMegE cells. This
protein has been recently implicated with histone acetylation and
gene activation in mammals (Fritah et (11., 2009). On the other hand,
15 TFs were involved in the repression of expression in genes
associated with high expression (Fig. 5 top). Of those, Kaiso is
a known chromatin remodeling factor. Kaiso is known to bind to
methylated DNA and the recruitment of H3 lysine 9 methylation
and gene repression (Yoon et (11., 2003).

Regarding the ﬁve TFs related to group of low expressed genes,
the method detects two chromatin-related proteins Sp1 and Egr-l
(see Fig. 5 bottom). Sp1, which is indicated to be active in all cell

types, has a known role in chromatin modeling by interacting with
HDAC enzymes or p300 for either repressing or promoting gene
expression (Doetzlhofer et (11., 1999; Sun et (11., 2006). Another gene
with a putative chromatin remodeling role is Egr-l (Krox). This
gene was detected as an activator of gene expression in HSC and
MPP cells. It interacts with EP300 and CBP, which are known to
promote histone acetylation and activation of expression (Silverman
et (11., 1998). These examples demonstrate the recovery of a TFs
with chromatin remodeling roles and the accurate prediction of their
functional role (repression or activation). Note that most of these
predictions were not previously characterized in hematopoiesis.

4 CONCLUSION

We have developed a novel method for predicting gene expression
that combines the use of linear mixture models with an efﬁcient
way to select the relevant predictor variables from a large set
of regulatory signals. The approach is ideally suited to integrate
high-dimensional data normally not applicable in standard linear
regression analysis. For instance, when provided the full set of
binding afﬁnities from vertebrate TRANSFAC matrices together
with HM data to model gene expression in blood cells, the algorithm
performed a sparse selection retaining only 29 out of over 600
input variables. The resulting sparse linear mixture models not only
signiﬁcantly improved gene expression predictions by capturing
non-linear relations with the retained regulatory signals but also
allowed to readily identify and characterize the relevant regulatory
signals. In particular, the model predicted known roles of HMs
and could select a small set of TFs related to development and
hematopoiesis to particular developmental stages.

The proposed method has three main parameters to be optimized
(K, M and Ag) and at the moment cannot make use of the
regularization paths (Friedman et (11., 2009) together with the EM
algorithm. Further work will thus be required to develop efﬁcient
methods for optimizing the parameters. In addition, TF binding
afﬁnities can accurately be predicted only for proximal promoters
and well-conserved upstream elements. The addition of epigenetic
information, which can ﬁirther characterize distal enhancers and
active promoters (Ernst and Kellis, 2010), is likely to improve the
TF binding predictions and is current work in progress.

Large consortia such as the Epigenetic Roadmap, ENCODE
and Blueprint Epigenome are releasing expression, epigenetic and
binding data on an unprecedented scale. Although our approach
offers a new way to integration such large-scale datasets it remains
a big challenge to further unravel the regulatory mechanisms
underlying the developmental processes shaping the human body.

Funding: Brazilian ﬁinding agencies dont require more information
than that. This ﬁgure could also be made wider.

Conﬂict of interest: none declared.

REFERENCES

Barreda,D.R. and Belosevic,M. (2001) Transcriptional regulation of hemopoiesis. Dev.
Comp. Immunol., 25, 7637789.

Barski,A. et al. (2007) High-resolution proﬁling of histone methylations in the human
genome. Cell, 5, 8234837.

Bussemaker,H.J. et al. (2001) Regulatory element detection using correlation with
expression. Nat. Genet, 27, 1674171.

 

2302

112 /3.Io's[BumoIpJOJXO'soneurJOJHtotq”:duq mot} papeo1umoq

9103 ‘0g isnﬁnv uo ::

Inferring epigenetic and transcriptional regulation

 

Cheng,C. et al. (2011) A statistical framework for modeling gene expression using
chromatin features and application to modENCODE datasets. Genome Biol., 12,
R15+.

Costa,I. et al. (2011) Predicting gene expression in t cell differentiation from histone
modiﬁcations and transcription factor binding afﬁnities by linear mixture models.
BMC Bioinformatics, 12(Suppl. 1), $29.

Cule,E. et al. (2011) Signiﬁcance testing in ridge regression for genetic data. BMC
Bioinformatics, 12, 372.

Dempster,A. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Stat. Soc. Ser B, 39, 1438.

DeSarbo,W. and Cron,W. (1988) A maximum likelihood methodology for clusterwise
linear regression. J. Classif, 5, 2494282.

Doetzlhofer,A. et al. (1999) Histone deacetylase 1 can repress transcription by binding
to spl. Mol. and Cell. Biol., 19, 550445511.

Dor,L.C. and Crispino,J.D. (2011) Transcription factor networks in erythroid cell and
megakaryocyte development. Blood, 118, 2314239.

Ernst,J. and Kellis,M. (2010) Discovery and characterization of chromatin states for
systematic annotation of the human genome. Nat. Biotechnol, 8, 8174825.

Friedman,J. et al. (2009) Regularization paths for generalized linear models via
coordinate descent. Journal of Statistical Software, 33.

Fritah,S. et al. (2009) Heat-shock factor 1 controls genome-wide acetylation in heat-
shocked cells. Mol. Biol. Cell, 20, 4976—4984.

Georgi,B. et al. (2010) Pymixithe python mixture packageia tool for clustering of
heterogeneous biological data. BMC Bioinformatics, 11, 9.

Goldberg,A.D. et al. (2007) Epigenetics: a landscape takes shape. Cell, 128, 6354638.

Hastie,T. et al. (2003) The Elements of Statistical Learning. Springer, Berlin, corrected
edition.

Karlic,R. et al. (2010) Histone modiﬁcation levels are predictive for gene expression.
Proc. Natl. Acad. Sci. USA, 107, 292672931.

Keles,S. et al. (2002) Identiﬁcation of regulatory elements using a feature selection
method. Bioinformatics, 18, 116771175.

Kouzarides,T. (2007) Chromatin modiﬁcations and their function. Cell, 128,
6937705.

Li,Q. and Lin,N. (2010) The bayesian elastic net. Bayesian Anal., 5, 1514170.

Matthias,P. and Rolink,A.G (2005) Transcriptional networks in developing and mature
b cells. Nat. Rev. Immunol., 5, 4977508.

Matys,V. et al. (2003) Transfac: transcriptional regulation, from patterns to proﬁles.
Nucleic Acids Res., 31, 3747378.

McLachlan,G.J. and Peel,D. (2000) Finite Mixture Models. Wiley Series in Probability
and Statistics. Wiley, New York.

Mikkelsen,T.S. et al. (2007) Genome-wide maps of chromatin state in pluripotent and
lineage-committed cells. Nature, 448, 5537560.

Morange,M. (2006) Hsfs in development. Handb. Exp. Pharmacol, 172, 1534169.

Novershtem,N. etal. (2011) Densely interconnected transcriptional circuits control cell
states in human hematopoiesis. Cell, 144, 2964309.

Orkin,S.H. and Zon,L.I. (2008) Hematopoiesis: an evolving paradigm for stem cell
biology. Cell, 132, 6314644.

Ouyang,Z. et al. (2009) ChIP-Seq of transcription factors predicts absolute and
differential gene expression in embryonic stem cells. Proc. Nat. Acad. Sci. USA,
106, 21521421526.

Park,S.-J.J. and Nakai,K. (2011) A regression analysis of gene expression in ES cells
reveals two gene classes that are signiﬁcantly different in epigenetic patterns. BM C
bioinformatics, 12(Suppl. 1), $50.

Roider,H.G et al. (2007) Predicting transcription factor afﬁnities to dna from a
biophysical model. Bioinformatics, 23, 1344141.

Roider,H.G et al. (2009) Cpg-depleted promoters harbor tissue-speciﬁc transcription
factor binding signalseimplications for motif overrepresentation analyses. Nucleic
Acids Res., 37, 6305£315.

Rothenberg,E.V. and Taghon,T. (2005) Molecular genetics of T cell development. Annu.
Rev. Immunol., 23, 6017649.

Shin,H. et al. (2009) CEAS: cis-regulatory element annotation system. Bioinformatics,
25, 260572606.

Silverman,E. et al. (1998) camp-response-element-binding-protein-binding protein
(cbp) and p300 are transcriptional co-activators of early growth response factor-1
(egr—l). Biochem. J., 336, 1837189.

Song,J. et al. (2007) Model-based analysis of two-color arrays (ma2c). Genome Biol.,
8, R178.

Sun,H.-J. et al. (2006) Transcription factors ets2 and spl act synergistically with
histone acetyltransferase p300 in activating human interleukin-12 p40 promoter.
Acta Biochimica et Biophysica Sinica, 38, 1947200.

Sun,T. and Zhang,C-H. (2010) Comments on: iii-penalization for mixture regression
models. TEST Ofﬁcial J. Spanish Soc. Stat. Oper. Res., 19, 27e275.

Tibshirani,R. (1996) Regression shrinkage and selection via the lasso. J. R. Stat. Soc.
(Ser B), 58, 2674288.

Turner,B.M. (2007) Deﬁning an epigenetic code. Nat. Cell Biol., 9, 2%.

Weishaupt,H. et al. (2010) Epigenetic chromatin states uniquely deﬁne the
developmental plasticity of murine hematopoietic stem cells. Blood, 2, 2474256.

Wysocka,J. et al. (2006) A PHD ﬁnger of NURF couples histone H3 lysine 4
trimethylation with chromatin remodelling. Nature, 442, 86490.

Yoon,H.-G et al. (2003) N-cor mediates DNA methylation-dependent repression
through a methyl cpg binding protein kaiso. Mol. Cell, 12, 7234734.

Zou,H. and Hastie,T. (2005) Regularization and variable selection via the elastic net. J.
R. Stat. Soc. Ser B, 67, 3017320.

 

2303

112 /3.Io's[BumoIpJOJXO'soneurJOJHtotq”:duq mos} papeo1umoq

9103 ‘0g isnﬁnv uo ::

