ORIGINAL PAPER

Vol. 30 no. 7 2014, pages 971-974
doi:1 0. 1093/bioinfonnatics/btt752

 

Gene expression

Advance Access publication December 25, 2013

TSSer: an automated method to identify transcription start sites in
prokaryotic genomes from differential RNA sequencing data

Hadi Jorjani and Mihaela Zavolan*

Computational and Systems Biology, Biozentrum, University of Basel, Klingelbergstrasse 50-70, 4056 Basel, Switzerland

Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: Accurate identification of transcription start sites (T SSS) is
an essential step in the analysis of transcription regulatory networks. In
higher eu karyotes, the capped analysis of gene expression technology
enabled comprehensive annotation of TSSs in genomes such as those
of mice and humans. In bacteria, an equivalent approach, termed
differential RNA sequencing (dRNA-seq), has recently been proposed,
but the application of this approach to a large number of genomes is
hindered by the paucity of computational analysis methods. With few
exceptions, when the method has been used, annotation of TSSs has
been largely done manually.

Results: In this work, we present a computational method called
‘TSSer’ that enables the automatic inference of TSSs from dRNA-
seq data. The method rests on a probabilistic framework for identifying
both genomic positions that are preferentially enriched in the dRNA-
seq data as well as preferentially captured relative to neighboring
genomic regions. Evaluating our approach for TSS calling on several
publicly available datasets, we find that TSSer achieves high consist-
ency with the curated lists of annotated TSSs, but identifies many
additional TSSs. Therefore, TSSer can accelerate genome-wide iden-
tification of TSSs in bacterial genomes and can aid in further charac-
terization of bacterial transcription regulatory networks.

Availability: TSSer is freely available under GPL license at http://www.
clipz.unibas.ch/TSSerﬁndex.php

Contact: mihaela.zavolan@unibas.ch

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 27, 2013; revised on December 16, 2013; accepted
on December 21, 2013

1 INTRODUCTION

Identification of transcription start sites (TSSs) is a key step in
the study of transcription regulatory networks. It enables iden-
tiﬁcation of promoter regions, and thereby the focused search for
binding sites of transcription factors. Although for species such
as mouse and human, methods to capture TSSs have been
developed >10 years ago (Shiraki et al., 2003), owing to differ-
ences in messenger RNA (mRNA) processing, these methods
cannot be applied to bacteria. Recently, however, a method for
genome-wide identiﬁcation of bacterial TSSs has been proposed
(Sharma et al., 2010). The method, called differential RNA
sequencing (dRNA-seq), uses the 5/ mono-phosphate-dependent
terminator exonuclease (TEX) that speciﬁcally degrades

 

*To whom correspondence should be addressed.

5/ mono-phosphorylated RNA species such as processed RNA,
mature ribosomal RNAs and transfer RNAs, whereas primary
mRNA transcripts that carry a 5/ triphosphate remain intact.
This approach results in an enrichment of primary transcripts,
allowing TSSs to be identiﬁed by comparison of the TEX-treated
samples to control untreated ones. As an automated computa-
tional method to identify TSSs based on dRNA-seq data has not
been available, TSS annotation based on dRNA-seq data
required substantial effort on the part of the curators. The aim
of our work was to develop an automated analysis method to
support future analyses of dRNA-seq data. We here introduce a
rigorous computational method that enables identiﬁcation of a
large proportion of bona ﬁde TSSs with relative ease. The
method is based on quantifying 5/ enrichment of TSSs and
also the signiﬁcance of their expression relative to nearby puta-
tive TSSs. Benchmarking our method on several recently pub-
lished datasets, we find that the identiﬁed TSSs are in good
agreement with those annotated manually, and that a relatively
large number of additional TSSs that also have the expected
transcription regulatory signals are identified. TSSer is freely
available at http://www.clipz.unibas.ch/TSSer/indexphp.

2 APPROACH

The input to TSSer is dRNA-seq data, consisting of one or more
pairs of TSS-enriched (TEX-treated) and TSS-not—enriched sam-
ples. There are two main criteria that we use to define TSSs. The
ﬁrst criterion stems from the obvious expectation that TSSs are
enriched in the TEX-treated compared with the TEX-untreated
samples (Sharma et al., 2010). To quantify the enrichment, we
explored two methods. In one approach we calculated, for each
genomic position, a ‘z—score’ of the observed number of reads in
the TEX-treated sample compared with number of reads in
the TEX-untreated sample. The second method aims to take
advantage of the information from multiple replicates: we use
a Bayesian framework to quantify the probability that a genomic
position is overrepresented across a number of TEX-treated sam-
ples. The second main criterion that we use to pinpoint reliable
TSSs rests on the observation that in bacteria, the majority of
genes have a single TSS (Cho et al., 2009). Thus, we expect that
in a speciﬁc sample, for each transcribed gene, there will typically
be one main TSS, as opposed to multiple TSSs in relatively close
Vicinity. In other words, bona fide TSSs should exhibit a ‘local
enrichment’ in reads compared with neighboring genomic
positions. We will now describe the computation of different
measures of TSS enrichment.

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 971

112 /3.IO'S[BIIJI’IO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} papBOIIIAAOG

9103 ‘Og anﬁnv uo ::

H.Jorjani and M.Zavolan

 

3 METHODS

3.1 Quantifying 5’ enrichment in a TEX-treated compared
with a TEX-untreated sample

In preparing the dRNA-seq sample, one captures mRNAs from bacterial
cells and sequences their 5’-ends. The capture of the mRNAs could be
viewed as a sampling process that gives rise to hypergeometrically distrib-
uted counts of reads from individual positions in the genome. However,
given that the number of reads originating at a given genomic position is
small relative to the total number of obtained reads, we can approximate
the hypergeometric distribution by a binomial distribution. That is, if the
total number of reads in the sample is N, and the fraction f of these cor-
responds to a given TSS of interest, then the probability to observe the TSS
represented by n of the N reads in the sample follows a binomial
distribution:

Paw) = )f"(1 —r)”*"

Letting fir and f, denote the frequency of reads derived from a given
genomic position in the TEX-treated (TSS-enriched) and TEX-untreated
(non-enriched) samples, respectively, what we would like to determine is
the enrichment deﬁned as follows:

P(f+>f’In+7N+an71Ni)= P(f+ ‘fe >0In+aN+,n7,Ne)-

We do not know the underlying frequencies fir and f,. Rather, we
approximate the probability of enrichment based on observed counts as
explained in the Supplementary Material. With x being the observed
frequency of reads derived from a given position (i.e. xir 22—: and
x, = 17,—: for the TEX-enriched and not enriched samples, respectively),
the probability that a genomic position has a higher expression in the
TEX-treated compared with the untreated sample is given by the follow-

ing equation:

X — X,
P(f+ -f7 >0ln+, N+JLa N7) = ¢(+—)
/x+(17x+) +x-(17x-)
N, N,

where d) is the cumulative of Gaussian distribution (error function).
In case of having multiple paired samples, the average value of ¢(t) for
a given genomic position would quantify the 5’ enrichment probability.
We call this measure ‘z-score’. Alternatively, when we have replicates
of paired (TEX-treated and untreated) samples, we can calculate the
5’ enrichment A, for each pair separately:

AS = 

f,

Assuming that A, follows a normal distribution with mean a and variance
02, we can calculate the probability that a TSS is enriched across a panel
of k replicate paired samples:
00 1 m
f (T) 2 dll
P(M>1|A) 2 100m in) +03

1 ’5?
0 (minim) d”

where A = (A1,A2, ...,Ak) and m, and 0* are mean and variance of A,
respectively, and k is the number of replicates (details of the derivation
are given in the Supplementary Material).

3.2 Quantifying local enrichment

To quantify the local enrichment of a putative TSS, we examine the
frequencies of sequenced reads in a region of length 21 centered on the
putative TSS ([x — l, x + 1]). That is, we deﬁne the local enrichment L as
follows:

Zie[xil,x+ﬂ,n+7,-5n+yx n+ai

L: (1)

Zjepcil, x+l] n+J

where nir, ,- is number of reads derived from position i in the TEX-treated
sample. The value of L would be 1 for the position with maximum ex-
pression in the interval, corresponding to a perfect local enrichment.
When replicates are available, we compute the average local enrichment
over these samples. We chose 1 such that it covers typical 5’ UTR lengths
and intergenic regions, i.e. 300 nt. This value is of course somewhat ar-
bitrary, but we found that it allows a good selection of TSSs in practice.

3.3 Identiﬁcation of TSSs

To identify TSSs, we compute these measures based on all available sam-
ples. Because we observed that the precision of start sites is not perfect
but there are small variations in the position used to initiate transcription,
we also apply single linkage clustering to select the representative among
closely spaced (up to 10 nt) TSSs. We then select the parameters that give
us the maximum number of annotated genes being associated with TSSs,
restricting the total number of predicted TSSs to be in within a narrow
range, :I:50% of the number of annotated genes in the genome.

4 EVALUATION OF THE TSS IDENTIFICATION
METHOD

To evaluate our method and verify its accuracy, we applied it to
several recently published datasets [Helicobacter pylori,
Salmonella enterica serovar Typhimurium (Kroger et al., 2012)
and Chlamydia pneumoniae (Albrecht et al., 2009)] for which a
mixture of computational analysis and manual curation was used
to annotate TSSs. We here present an in-depth analysis of the
TSS identiﬁcation approaches for H .pylori. Similar analyses for
the other species are given in the Supplementary Tables SLS6.

In the H.pyl0ri genome, our method identified 2366 TSSs. Of
these, 1306 (55%) TSSs are in the reference set of 1893 curated
TSSs reported by Sharma et al., 2010, which we refer to them as
‘Common’ TSSs. Thus, 69% of the curated sites are included in
our TSS list. A number of reasons contributed to our method
failing to identify another 31% curated TSSs, which we refer to
them as ‘Reference only’.

0 In our approach, we only use reads that were at least 18 nt in
length and mapped with at most 10% error to the genome.
This selection appears to have led to the loss of 187 (32%) 0f
the 587 curated TSSs in the mapping process, before apply-
ing the TSSer inference.

o The majority of the curated sites that we did not retrieve
appear to have been supported by a small number of reads.
Two hundred twenty-six (38%) of the 587 curated TSSs that
we did not identify were supported by less than a single read
per 100 000 on average and we required that a TSS is
supported by at least 1 read (see Fig. 1a).

0 Finally, 174 (30% of the curated TSSs that we did not re-
trieve) did not pass our enrichment criteria (see Fig.lc).
Accepting these TSSs as putative TSSs would have to be
accompanied by the inclusion of many false positives.

In summary, 70% of the manually curated TSSs that are not in
the ‘TSSer’ prediction set were not lost due to TSSer scoring but
rather before because they had little evidence of expression, even
though we mapped 70.43% of the reads to the genome, com-
pared with 80.86% in the original analysis (Sharma et al., 2010).
Only 30% of the TSSs that were in the reference list were not

 

972

112 /310's112u1n0fp10}x0"sotJBHJJOJutotq//:d11q 11101} papBOIIIAAOG

9103 ‘Og isnﬁnv uo ::

TSSer

 

{a} 45 Normalized expression distributions _

4n

Reference only Common TSSer only

 

lb) 60% TSS to TLS distance distributions
400m  —;
“d 2000' ' — 5
I: ‘ _._'
E
—znun I I
_4000|Reference only Common TSSer only
{0)

_R.Qf_91ﬂ1933.9111}' comma“

m T5 Ber_o my

  

g

:

 

Local emichment
9}

1
Local enrichment
'2‘

Local enrichment

        

'k'—')ir' '1' ' ail—'l‘tin 'iv—

4‘11 _ 8 —m'—"|iin 'I'.—'~n' —'m'— iﬂl'_'|'m'_ IM
5' enrichment

ir.'—'Jil'_—"m _ _
5' enrichment 5' ennchment

Id)

 = 

fthauwﬁéﬁ, .13$E¢Hf.?itﬂ¥i3+l§ﬁléﬁ<':;=3?:‘

 

2"?71333'Irxi‘ﬁ‘

r

 

- ' 111%,HazrrttftﬁnI$§hu:IE‘gmLtha-r

“huh:-

Fig. 1. Properties of TSSs that were present only in the reference list
(left), both in the reference and the TSSer list (middle) or only in the
TSSer list (right). (a) Box plot of averaged normalized expression (the
boxes are drawn from the ﬁrst to the third quantile and the median is
shown with the red line). (b) Box plot of the displacement distribution
relative to the start codon. (c) Scatterplots of 5’ versus local enrichment
(both shown as percentage). ((1) Sequence logos indicating the position-
dependent (5’ —> 3’ direction) frequencies of nucleotides upstream of the
TSS (datasets are shown from top to bottom rather than from left to
right)

present in the TSSer list because they did not satisfy our criteria
for enrichment in reads. Further investigating the features [en-
richment values, distance to start codon (TLS) and presence of
transcriptional signals (see Supplementary Material)] of these
TSSs that we did not identify, we found that a large proportion
are likely to be bonaﬁde TSSs, i.e. false negatives of our method.

On the other hand, we identiﬁed an even larger number of
TSSs (1060) that were not present in the curated list. We refer
to these as ‘TSSer only’. Of these, 198 TSSs correspond to 142
genes that were not present in the reference list. Of the remaining
862 TSSs that are only identified by our method, 287 TSSs are

‘Antisense’ TSSs, 58 TSSs are ‘Orphan’ and 379 TSSs are alter-
native TSSs for genes that did have at least one annotated TSS in
the reference set (the deﬁnition of these categories is given in
Section 2.3 of Supplementary Material). These TSSs share the
properties of TSSs jointly identiﬁed by our method and the
manual curation (Fig. 1), indicating that they are also bona
ﬁde TSSs. To further support the TSSs that were identiﬁed by
TSSer and were missing in the reference list, we compared these
TSSs with the ‘Common’ category and also ‘Reference only’
category in the following aspects:

0 Average normalized expression (Fig. 1a): ‘TSSer only’ TSSs
have almost the same expression distribution as TSSs in
‘Reference only’ category and both have lower expression
compared with the TSSs in the ‘Common’ set. This indicates
that TSSs with high expression are equally well identiﬁed by
the two methods, and that the difference between methods
manifests itself at the level of TSSs with low expression.

0 TSS to TLS distance: Figure 1b shows that TSSer identiﬁes
putative TSSs that are closer, on average, to the translation
start, compared with the TSSs that were manually curated.
The proportion of internal TSS identiﬁed by TSSer is also
higher and it remains to be determined what proportion of
these represents bona ﬁde transcription initiation starts.

0 Enrichment values: Figure 1c shows that TSSs identified by
TSSer only have strong 5’ and local enrichment, whereas
those that are present in the ‘Reference only’ set have low
local enrichment. This indicates that these sites are located
in neighborhoods that give comparable initiation at spurious
sites and thus these sites would be difﬁcult to identify simply
based on their expression parameters.

0 Strength of transcriptional signals: Figure 1d shows that
TSSs identiﬁed by TSSer share transcriptional signals such
as the — 10 box with the other categories of sites. The overall
weaker sequence bias may indicate that a larger proportion
of ‘TSSer only’ sites are false positives, consistent with the
higher proportion of sites that TSSer identiﬁed downstream
of start codons (Fig. 1a). To further investigate the tran-
scription regulatory signals, we also implemented a hidden
Markov model (HMM) that we trained on the ‘Common’
sites to ﬁnd transcription regulatory motifs. We then applied
this model to the sequences from each individual subset (see
Supplementary Material for details). The results from
the HMM further conﬁrm that a large proportion of the
‘TSSer only’ sites have similar scores to the sites in the
other two categories, indicating that TSSer captures a sub-
stantial number of bona fide TSSs that were not captured
during manual curation.

5 DISCUSSION

Deep sequencing has truly revolutionized molecular biology. It
enabled not only the assembly of the genomes of thousands of
species, but also annotation of transcribed regions in these gen-
omes and the generation of a variety of maps for DNA-binding
factors, non-coding RNAs and RNA-binding factors. High-
throughput studies revealed that not only eukaryotic but also

 

973

112 /310's112u1n0fp101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isanV uo ::

H.Jorjani and M.Zavolan

 

prokaryotic genomes are more complex than initially thought. In
particular, bacterial genomes encode relatively large numbers of
non-coding RNAs with regulatory functions (Waters and Storz,
2009) and antisense transcripts (Georg and Hess, 2011). Such
transcripts are of particular interest because they are frequently
produced in response to and contribute to the adaptation to
speciﬁc stimuli (Repoila and Darfeuille, 2009). The availability
of a large number of bacterial genomes further enables identiﬁ-
cation of regulatory elements through comparative genomics-
based approaches (Arnold et al., 2012). However, these methods
beneﬁt from accurate annotation of TSSs that enables a focused
search for transcription factor binding sites. Although the data
supporting TSS identiﬁcation can be obtained with relative ease
(Sharma et al., 2010), the annotation of TSSs has so far been
carried out manually, which is tedious and likely leads to an
incomplete set of TSSs. Only recently, as our manuscript was
in the review process, methods for automated annotation of
TSSs based on dRNA-seq data started to emerge (Dugar et al.,
2013) (see also http://www.tbi.uniVie.ac.at/newpapers/pdfs/TBI—
p-2013-4.pdf). The method that we propose here is meant to
provide a starting point into the process of TSS curation.
Because it uses dRNA-Seq data, it is clear that only TSSs from
which there is active transcription during the experiment can be
annotated. As we have determined in the benchmark against the
H.pylori, there remain TSSs for which the expression evidence is
poor, yet have the properties of bonafide TSSs. Additional sam-
ples, covering conditions in which these TSSs are expected to be
expressed are necessary to identify them. Alternatively, they can
be brought in during the process of manual curation.
Nonetheless, the advantage of an unbiased automated method
such as the one we propose here is that it allows the discovery of
TSSs that may not be expected or easily evaluated such as those
of antisense transcripts, alternative TSSs and TSSs correspond-
ing to novel genes. Furthermore, this method can provide an
initial set of high-conﬁdence TSSs that can be used to train
more complex models of transcription regulation, which could
be used to iteratively identify additional TSSs, that may be sup-
ported by a small number of reads. To illustrate this point, we
here used an HMM, which we trained on high-conﬁdence TSSs
from the ‘Common’ category, to provide an additional list of
putative TSSs that appear to have appropriate transcription
regulatory signals but that were not captured with high abun-
dance or enrichment in the experiment (Supplementary
Table S8). Thirty-six percent of the TSSs that were only present
in the reference annotation are part of this list. More sophisti-
cated versions of this approach could be used toward compre-
hensive annotation of TSSs in bacterial genomes. Finally, the
method can be applied to other systems in which genomic

regions give rise to an increased number of transcripts in speciﬁc
conditions.

6 CONCLUSION

We have proposed an approach for genome-wide identification
of TSSs in bacteria, which uses dRNA-Seq data to quantify the
5’ and local enrichment in reads at putative TSSs and their cor-
responding significance. The method is implemented in an auto-
mated pipeline, which we applied to several recently published
dRNA-Seq datasets. A thorough benchmarking of the TSSs pro-
posed by our method relative to manual curation indicates that
the method performs well in identifying known TSSs and is able
to further detect novel TSSs that have the expected properties of
bonafide TSS. Thus, our method should enable rapid identifica-
tion of TSSs in bacterial genomes starting from dRNA-Seq data.

ACKNOWLEDGEMENTS

The authors thank A. R. Gruber and A. Rzepiela for critical
reading of the manuscript.

Funding: Work in the Zavolan laboratory is supported by the
University of Basel and the Swiss National Science Foundation
(grant number 31003A_147013).

Conﬂict of Interest: none declared.

REFERENCES

Albrecht,M. et a]. (2011) The transcriptional landscape of Chlamydia pneumoniae.
Genome Biol, 12, R98.

Arnold,P. et a]. (2012) MotEvo: integrated Bayesian probabilistic methods for
inferring regulatory sites and motifs on multiple alignments of DNA sequences.
Bioinformatics, 28, 4877494.

Cho,B.K. et a]. (2003) The transcription unit architecture of the Escherichia coli
genome. Nat. Biotechnol, 27, 104371049.

Dugar,G. et a]. (2013) High—resolution transcriptome maps reveal strain—speciﬁc
regulatory features of multiple Campylobacter jejuni isolates. PLoS Genet, 9,
e1003495.

Georg,J. and Hess,W.R. (2011) cis—antisense RNA, another level of gene regulation
in bacteria. Microbiol. Mol. Biol. Rev., 75, 2867300.

Krdger,C. et a]. (2012) The transcriptional landscape and small RNAs of
Salmonella enterica serovar Typhimurium. Proc. Natl Acaa’. Sci. USA, 109,
127771286.

Repoila,F. and Darfeuille,F. (2009) Small regulatory non—coding RNAs in bacteria:
physiology and mechanistic aspects. Biol. Cell, 101, 1177131.

Sharma,C.M. et a]. (2010) The primary transcriptome of the major human pathogen
Helicobacter pylori. Nature, 464, 25%255.

Shiraki,T. et a]. (2003) Cap analysis gene expression for high—throughput analysis of
transcriptional starting point and identiﬁcation of promoter usage. Proc. Natl
Acad. Sci. USA, 100, 1577(r15781.

Waters,L.S. and Storz,G. (2009) Regulatory RNAs in bacteria. Cell, 136, 61$628.

 

974

112 /310's112u1n0[p101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g1sn8nv uo ::

