ORIGINAL PAPER

Vol. 26 no. 7 2010, pages 905-911
doi: 1 0. 1 093/bioinformatics/btq059

 

Gene expression

Advance Access publication February 21, 2010

GO-Bayes: Gene Ontology-based overrepresentation analysis

using a Bayesian approach

Song Zhang1’*, Jing Caoz, Y. Megan Kong3 and Richard H. Scheuermann1’3’*

1Department of Clinical Sciences, U.T. Southwestern Medical Center, 5323 Harry Hines Boulevard Dallas,
TX 75390—9072, 2Department of Statistical Science, Southern Methodist University, Dallas, TX 75275—0332,
3Department of Pathology, U.T. Southwestern Medical Center, 5323 Harry Hines Boulevard Dallas,

TX 75390—9072, USA
Associate Editor: David Rocke

 

ABSTRACT

Motivation: A typical approach for the interpretation of
high-throughput experiments, such as gene expression microarrays,
is to produce groups of genes based on certain criteria (e.g. genes
that are differentially expressed). To gain more mechanistic insights
into the underlying biology, overrepresentation analysis (ORA) is
often conducted to investigate whether gene sets associated with
particular biological functions, for example, as represented by Gene
Ontology (GO) annotations, are statistically overrepresented in the
identified gene groups. However, the standard ORA, which is based
on the hypergeometric test, analyzes each GO term in isolation
and does not take into account the dependence structure of the
GO-term hierarchy.

Results: We have developed a Bayesian approach (GO-Bayes) to
measure overrepresentation of GO terms that incorporates the GO
dependence structure by taking into account evidence not only
from individual GO terms, but also from their related terms (i.e.
parents, children, siblings, etc.). The Bayesian framework borrows
information across related GO terms to strengthen the detection of
overrepresentation signals. As a result, this method tends to identify
sets of closely related GO terms rather than individual isolated GO
terms. The advantage of the GO-Bayes approach is demonstrated
with a simulation study and an application example.

Contact: song.zhang@utsouthwestern.edu;
richard.scheuermann@utsouthwestern.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 4, 2009; revised on December 21, 2009;
accepted on February 3, 2010

1 INTRODUCTION

In typical high-throughput experiments, such as gene expression
microarrays, the ﬁrst step in the analysis of the results is often to
produce groups of genes based on certain criteria (e. g. genes that are
differentially expressed). To gain more mechanistic insights into the
underlying biology, overrepresentation analysis (ORA) is conducted
to use the knowledge of the functional Characteristics of the genes to
investigate whether gene sets associated with particular biological
functions are overrepresented in the identiﬁed gene groups. Draghici
et a1. (2003) is the ﬁrst paper to discuss the overrepresentation

 

*To whom correspondence should be addressed.

problem and propose different statistical methods that can be used
in this area. ORA is based on the postulate that if a biological
process has more identiﬁed genes than expected by Chance alone,
that biological process is probably linked to the experiment.

One of the most popular gene description databases used in ORA
was developed by the Gene Ontology (GO) Consortium (Ashbumer
et al., 2000). Each GO term annotates a set of genes, indicating their
known molecular functions, involvement in biological processes
and cellular component locations. GO terms are structured in a
directed acyclic graph (DAG) of parent—Child relationship, where
a Child indicates a more speciﬁc biological Classiﬁcation than its
parent(s). Based on the true-path rule the annotation of a gene to
a GO term implies automatic annotation to all the ancestors of that
term. Another feature is that a GO term is allowed to have more
than one parent nodes, a feature known as multiple inheritance. For
example, immune response is not only a speciﬁc form of organismal
movement but also a part of defense response. Furthermore, some
genes might be annotated by a parent GO node but not by any of its
Children because less is known about that gene’s speciﬁc function.
For a rigorous analysis, these dependency Characteristics of the GO
DAG need to be considered when developing statistical methods to
detect overrepresentation of GO annotations.

In ORA, the most commonly used statistical test is based on
the hypergeometric distribution or its binomial approximation (Cho
et al., 2001; Khatri et al., 2002; Draghici et (11., 2003; Al-Shahrour
et (11., 2004; Beissbarth and Speed, 2004; Lee et al., 2005; Lee et (11.,
2006; Luo et al., 2007; among others). Let A denote a GO term or
the set of genes annotated toA (with cardinality IA), and let S denote
the set of genes (with cardinality I 5) based on a certain criterion (i.e.
differential expression) from a ﬁill gene list G (with cardinality I )
in an experiment. The number of genes belonging to both S and
A (S DA), denoted by nA, indicates the representation of A in S.
Under the null hypothesis that S and A are independent (i.e. the GO
term is irrelevant to the gene Cluster), nA follows a hypergeometric
distribution. The P-value measuring the signiﬁcance of association
is the tail probability of observing nA or more genes annotated by A
in S,

min(IA,I_.) (IA) (I—IA)
P-value = Z 
k=nA (IS)

where   is the binomial coefﬁcient. Many software
and webtools (Onto-Express, CLASSIFI, GoMiner, EASEonline,

, (1)

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 905

112 /3.Io's[Bruno[pJOJXO'sotwurJOJutotqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

S.Zhang et al.

 

®

 

abode fghi jklmnopqrs tuvwxyz

 

abode fghi jk

(118)
0.003
0761

(26,10)

(10,0)
10
0.046 0.144

(113)
0.922

 

 

abodefg lhi jl lelmnl
(7,6) (4,2) (3,2) (5,0)
0 005 0.504 0 323
0 948 0.487 0 802

® ® @ @
m
(3.3) (1.0) (2.2) (2.0) (2.2) (1 0) (3 0)
0.046 1.0 0.139 1.0 0 9 1
0.988 0.674 0.958 0.231 0.914 0.

(4,0)
.0 0.323
0 056 0.397

A

1,0)
.0
.2

 

t

Fig. 1. Comparison of the P-Value and the B-score with an artiﬁcial DAG. The full list of genes (G) are denoted as lowercase letters; the genes in set S are
marked in red. The rectangles contain the subset of genes annotated by each node, where (IA , nA) are listed under each rectangle. The hypergeometric P-Values
are listed in blue and the B-scores are listed in black underneath the P-Values.

GeneMerge, FunCAssociate, GOTree Machine, etc.) have been
developed based on the hypergeometric P-value. Detailed review
can be found in Khatri and Draghici (2005).

The hypergeometric P-value provides a straightforward measure
of overrepresentation for each individual GO term. However, the
major drawback of this approach is that it ignores the hierarchical
structure in the GO DAG, which contains a substantial amount of
information regarding the interactions among the GO terms.

We use an artiﬁcial DAG (Fig. l) to illustrate this issue. It consists
of 25 nodes {Aj,j= l,...,25}, each denoted by a Circle. Let G:
{(1, b, . . . , z} denote the full list of genes, and 10 genes in S are marked
in red. The rectangles contain the subset of genes annotated by
each node, where (IA,nA) are listed under each rectangle. Figure 1
includes some important features of the GO DAG, such as multiple
inheritance (e.g. A14 and A23 have two parent nodes) and that a gene
might be annotated at different speciﬁc level (eg. gene k is annotated
by A2, but not by any of its Children: A5, A6 and A7). Note that in
this example S is overrepresented in the regions under A2, while
underrepresented in the regions under A3 and A4. We report the
hypergeometric P-values estimated by (l) in blue.

First, given I and 15, GO terms with the same (IA,nA) have
exactly the same hypergeometric P-values. For example, with
(IA,nA)=(2,2), the P-values for A14 and A24 are both 0.139.
Based on Figure 1, A14 is more likely to be linked with S because
of the stronger evidence of overrepresentation in its neighboring
nodes (related biological ﬁinctions). Using evidence only from
individual terms, the hypergeometric P-value does not differentiate
between A14 and A24. Second, given I and I S, the hypergeometric
P-value has a lower limit determined by IA, which is denoted

as L(IA). Speciﬁcally, L(IA) is achieved when nA =IA, i.e. the
P-value reaches its lower limit when all the genes annotated by
A are in S. The smaller the IA, the larger the L(IA). For example,
we have L(3)=0.046 as in A12 and L(2)=0.l39 as in A14. This
observation suggests that if we set the threshold for the P-value
at L(k), then the hypergeometric test could not identify any GO
terms with I A < k. In ORA, detecting more speciﬁc GO terms, which
usually have a relatively smaller IA, might be more desirable because
they provide more detailed biological information. However, the
hypergeometric test tends to identify less speciﬁc GO terms because
of the constraint of L(IA). In Figure l, the most signiﬁcant term
selected by the P-value is A2, a term next to the root. The more
speciﬁc terms that are associated with S (i.e. A12 and A14) are
considered less signiﬁcant compared with A2. All of these issues
essentially stem from the limitation of the hypergeometric test in
treating the GO terms as independent entities and ignoring their
interrelated structure.

Recently some new methods have been proposed in ORA. Lewin
and Grieve (2006) propose to group Closely related GO nodes
together and then compute a hypergeometric P-value for each group.
In their approach, the graphical distance between nodes in the GO
DAG is assumed to have some quantitative biological meaning.
Alexa et al. (2006) calculate the overrepresentation of a GO term
from leaf to root by downweighting the contribution of genes which
are annotated by a Child term that has been found to be signiﬁcantly
enriched. Grossmann et al. (2007) measure the overrepresentation
of each GO term relative to its parent(s). From root to leaf, their
method computes the signiﬁcance of overrepresentation for a GO
term conditional on the representation at the parent term(s). The last

 

906

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

GO-Bayes

 

two methods purposely remove the dependence between parent and
Child terms.

In this article, we develop a Bayesian hierarchical model to
incorporate the dependence structure of the DAG in assessing GO
term overrepresentation. It takes into account evidence not only from
individual GO terms, but also from their related terms (i.e. parents,
Children, siblings, etc.). The Bayesian framework enables borrowing
information across related GO terms to strengthen the detection of
overrepresentation signals. As a result, this method tends to identify
sets of Closely related GO terms rather than individual unrelated
GO terms. The utility of the method is demonstrated using a gene
expression microarray dataset from a human B cell stimulation
experiment.

2 METHOD

2.1 The Bayesian model

The proposed method is called GO-Bayes: GO-based ORA using a Bayesian
approach. In the model, each GO term has a relevance parameter measuring
its association with the selected genes in S. The novelty of the model is
that the complex dependence structure in the GO DAG is incorporated Via a
hierarchical prior on the relevance parameters.

To introduce GO-Bayes, we deﬁne the following notations. Let A:
{Aj,j=1,...,J} be the set of GO terms involved in the annotation of the
full list of I genes (i.e. IA]. >0, forj=1,...,J), among which 15 genes are
grouped in S in the experiment. We use Ajl —>Aj2 to indicate that Ajl is
a parent ofAJ-z. We deﬁne Pj={Ak :Ak—>Aj} and C‘={Ak :Aj—>Ak} to be
the sets of parent and child nodes of Aj, respectively. We use |U| to denote
the cardinality of set U. Without loss of generality, let A1 denotes the root
node and |P1| :0. For the non-root nodes, we have |Pj| Z 1, where |Pj| > 1
indicates multiple inheritance. We call Aj an end node if |Cj| =0 and an inner
node otherwise. For example, in Figure 1, A1 is the root node, P10 2 {A4},
C10 2 {A22,A23} and |P14| = |P23| :2 indicating multiple inheritance.

At the gene level, we use gi EAj to denote that gene 1' is annotated by
A]: We further use gi <Aj to indicate that Aj is the most speciﬁc GO term
that annotates gene 1', with the formal deﬁnition being gi EAj and g ¢Ak for
any Ak eCj. We deﬁne Bi: {Aj :gi <lAj} to be the set of the most speciﬁc
annotations of gene 1'. The true-path rule implies that B,- contains all the
annotation information about gene 1'. In Figure 1, we have Ba ={A12} and
Bk 2 {A2,A13,A22}. Let )1,» (i: 1, - -- ,I) be the observed expression status of
gene i, )1,» :1 if gene 1' is in S and )1,» :0 otherwise.

The binary )1,» is assumed to follow a Bernoulli distribution,
)1,» |p,»~Bernoulli(p,»), where [7) is the probability that gene 1' belongs to S.
Using the idea that if Aj is associated with S , the genes annotated by Aj have
a higher chance of being grouped in S, we construct the following logistic
model,

 

J
log<1plp>) =b0+ZI(AjeB,-)aj+e,. (2)

l 
We specify [)0 as a constant and set 110 =log[po/(1—p0)] with [70 215/],
where [70 is the background probability that gene 1' is grouped in S by chance.
The random error 2,» is assumed to have a normal distribution with mean 0

and variance :72, denoted by ein~dN(0,r72). Parameter ozj characterizes the
relevance of GO term Aj to the set of identiﬁed genes S , where it modiﬁes
the odds of gene 1' being grouped in S by a factor of exp(ozj) if gi<1Aj. Thus,
positive (negative) values of 011- indicate over(under)-representation. Based on
the true-path rule, we only include a}? from B), the most speciﬁc annotations,
in model (2) to avoid repeated use of information. The (Xi-X from less-speciﬁc
annotations are assumed to affect the odds indirectly Via a hierarchical prior
on at = { ozj , j = 1, . . . ,J } , constructed according to the dependence structure in
the GO DAG. We set or] = 0 for the root node. Then the prior ofozj U = 2, . . . ,J)
is speciﬁed conditionally given the relevance parameters of its parent nodes,

denoted by up]. 2 {01k :Ak er}. Speciﬁcally,
1
aj|ap,,52~ Z ?N(ak,82). (3)

k:AkeP,v I jl

Prior (3) assumes that 011- arises from a mixture distribution of |Pj|
components, each component being a normal distribution centered at the
relevance parameter of one of its parents. The equal mixing probability 1 / |Pj|
in (3) assumes a priori that each parent has equal inﬂuence over a]: Parameter
82 characterizes the variability among the children nodes. The joint prior of
at is obtained by the product of (3) over j=2,...,J. This prior provides a
mechanism to share information among the GO terms based on the DAG
structure. It also naturally accommodates multiple inheritance.

We assign an inverse gamma prior, IG(a3,b3), on 82, which has been
used extensively in Bayesian models (Gelman et al., 2003). Similarly, an
IG(a0,bg) prior is assumed for :72. We infer the relevance of GO term
Aj based on the posterior distribution of 011-, denoted by [011- | Y]. Here,
Y={yi,i=1,...,I} is the collection of observations. Speciﬁcally, we use
r]- EP((¥]' > 0 | Y) (denoted as the B-score) to measure the relevance of a GO
term to S. It is the posterior probability ofAj being positively associated with
S. Making inferences based on posterior probabilities is a common practice
in Bayesian analysis of microarray data (Newton at al. 2004; Do at al., 2005;
Cao et al., 2009). Markov Chain Monte Carlo (MCMC) sampling algorithm
is employed to simulate random samples from the joint posterior distribution.
We implement the adaptive-rejection sampling method to take advantage of
the log-concave property of the full conditional distributions (Gilks and Wild,
1992). The computation can be performed efﬁciently.

2.2 Demonstration of GO-Bayes with the artiﬁcial DAG

GO-Bayes is applied to the artiﬁcial DAG (Fig. 1) to detect
overrepresentation of the terms. We present the B-score, rj, below the
hypergeometric P-Value. In the following discussion, we use association
to refer to positive association between a GO term and S.

By incorporating the dependence structure of the GO DAG, GO-Bayes
shows distinctive advantages over the hypergeometric test. First, GO-Bayes
is capable of distinguishing terms with the same (1A1. , nAf). For example, GO-
Bayes produces r14 20.958 and r24 20.772, for A14 and A24, respectively,
indicating thatA14 is more likely to be associated with S based on the stronger
evidence of overrepresentation of its neighboring nodes. Second, the B-score
for all nodes has arange of 071 regardless ofIA. Thus, GO-Bayes can identify
more speciﬁc GO terms as long as their neighboring nodes are consistently
overrepresented. For example, the top two terms selected by GO-Bayes are
A12 and A14. Third, GO-Bayes also highlights underrepresentations as well
as overrepresentations. In Figure 1, all the terms with m; :0 have the same
P-Value of 1.0. Under all the branches ofAz, A3 and A4, there are terms with
a P-Value of 1.0. GO-Bayes suggests that it is the terms under A3, whose rj’s
are close to 0, that are most underrepresented in S.

We have also compared the GO-Bayes B-score with the elim P-Value
(Alexa et al., 2006) and the parentwhild (union) P-Value (Grossmann
et al., 2007) based on the artiﬁcial DAG. Due to the space limit, the
results are presented in Supplementary Figure 3. In general, both the elim
method and the parentichild method address the ‘dependency problem”
caused by overlapping annotations between parentwhild GO terms. The elim
method removes (or downweights) all genes annotated to a signiﬁcantly
enriched node from all its ancestors. By doing this, the method tends to
identify strongly overrepresented GO terms that remain signiﬁcant even
after discounting evidence from their offsprings. For illustrative purpose,
we set the P-Value cutoff at 0.05 for the elim method. Thus, A12 is
considered signiﬁcantly overrepresented and genes (a,b,c) are removed
from its ancestor terms A5 and A2. Based on the elim P-Value, the
term A12 becomes the most signiﬁcant, where A; ranks second and A5
ranks sixth. The parentichild method computes the signiﬁcance of a node
conditional on the signiﬁcance of its parents. It implements the idea by
computing a hypergeometric P-Value for each GO term in the context
of its parent (treating the genes annotated by the parent term as the full

 

907

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘{g anﬁnv 110::

S.Zhang et al.

 

gene list). This approach tends to identify GO terms that show stronger
overrepresentation compared with their parents. Take A7 and A11, for
example, which have the same (IA, nA). Based on the parentichild P-Value,
A11 has a higher rank (second) because its overrepresentation (2 out of 3)
is stronger than its parent A4 (3 out of 11). In contrast, A7 has a lower rank
(10th) because its overrepresentation (2 out of 3) is weaker compared with
its parentA2 (8 out of 11). The GO-Bayes method accounts for the parent7
child relationship through the hierarchical prior. The strategy of borrowing
information from neighboring terms allows GO-Bayes to detect moderate but
consistent signals from closely related GO terms. As a result,A7 has a higher
rank thanA 11 (r7 = 0.802 and r11 = 0.397) because the overrepresentation in
A7 is corroborated by related terms in its neighborhood. With the biological
truth unknown, there is no gold standard to compare the methods in real
studies (Grossmann at al., 2007). The results based on the artiﬁcial DAG,
however, help to illustrate the distinctive characteristics of each method.

3 APPLICATION

3.1 Dataset

In order to test the utility of the GO-Bayes approach, we
selected a gene expression microarray dataset in which a B-Cell
lymphoma cell line (Ramos) was stimulated either through the
B-Cell antigen receptor (BCR), CD40 or a combination of the two
(Basso et al., 2005). Speciﬁcally, we used an Affymetrix gene
expression dataset selected from the GSE2350 series (GSM44051
to GSM44074) downloaded from the NCBI GEO database
(http://www.ncbi.nlm.nih.gov/projects/geo/). The expression values
of all six replicates under four experimental conditions were
normalized by rows and a list of 3952 differentially expressed
genes (1 =3952) were selected using the Signiﬁcance Analysis of
Microarray (SAM) approach (Tusher et al., 2001). The differentially
expressed genes were subdivided into 20 groups based on their
expression pattern by K -means Clustering using Euclidean distance
as the similarity metric.

Gene Cluster #7 (GC7) was Chosen for detailed analysis because it
promised to reveal some interesting biology about B-Cell responses
to receptor signaling. The 196 genes (15:196) present in GC7
showed a particularly interesting expression pattern: these genes
were upregulated in response to BCR signaling alone; however, this
upregulation was suppressed when CD40 signaling was included
(Fig. 2). These treatment conditions mimic important biological
responses of immature B cells (Hsueh and Scheuermann, 2000).
Immature B cells must learn to distinguish between signals delivered
by authentic pathogen-derived antigens and signals delivered by
self-antigens. In the former case, B cells need to respond by
productive proliferation and differentiation into immune effector
cells. In the later case, B-Cell responses need to be suppressed either
through the induction of a state of unresponsiveness or apoptotic
cell death. The two-signal hypothesis is one mechanism proposed
to elicit either responsiveness or non-responsiveness to antigen
exposure, which states that B cells receiving only one signal, through
the BCR, will proliferate and die, but B cells receiving two signals
both through the BCR and a co-stimulatory receptor-like CD40 will
proliferate and survive due to suppression of the cell death response.
Thus, gene present in GC7 are those genes whose expression is
suppressed with the addition of CD40 signaling and could thus be
involved either in the cell death response or in the induction of
unresponsiveness.

CD40
UNTR CD40 BCR +BCR

damage-specific DNA binding protein 1

eukaryotic translation initiation factor

PDZ and LIM domain 7

makorin, ring finger protein, 1

stromal cell-derived factor 2

interleukin-1 receptor-associated kinase

adenosine A2a receptor

NIMA-related kinase

dih drolipoamide S-succinyltransferase

del ex 4 homolog

FIho GEF

ring finger protein 14

hypothetical protein A-211C6.1

translin-associated factor X

protein phosphatase 2, regulatory subunit

epidermodysplasia verruclformis 1

microtubule—actin crosslinking factor 1

protein phosphatase 2, regulatory subunit B

dCMP deaminase

CD1 a antigen

Rrotective protein for beta-galatosidase
IAA0476

CD63 anti en

reticulon

dihydropyrimidine dehydrogenase

ubiquitin-coniugating enzyme E2D

early growth res onse 3

hypot etical pro ein FLJ20232

importin 13

ca hepsnn C

leosomal-associated protein transmembrane
TP-binding cassette, sub-family C
lucan (1,4-alpha-), branching enzyme 1

rIng finger protein 167

solute carrier family 2

CD53 antigen

WD repeat and SOCS box-containin 2

G protein-coupled rece tor kinase

early growth response

checkpoint suppressor 1

Rotassium channel, subfamily K, member 1
ruppel-like factor 12

death-inducing protein

NGFl-A binding protein 2

chromosome 0 en readin frame 132

FINA binding region (FINP1, FIM) containing

check oint suppressor 1

major istocompatibility complex, class II

 

Fig. 2. Gene expression pattern of Gene Cluster #7. A heat map of
normalized expression values is shown in which green represents relatively
low expression and red represents relatively high expression. Each column
represents data from a single microarray. Six replicates from each of four
experiment conditions were performediuntreated (UNTR), stimulation
through the CD40 receptor (CD40), stimulation through the BCR and the
combined stimulation. The expression pattern for a subset of 196 genes in
GC#7 is shown.

3.2 Result

For the full list of 3952 differentially expressed genes (1 =3952),
6768 GO terms (J =6768) have been used to annotate their
functions. Four groups of GO terms are found in the top 20 list of
most signiﬁcant terms based on the GO-Bayes approach (Table 1).
The GO term with the highest B-score (0.9004) is ‘transferase
activity, transferring hexosyl groups’ (GO:0016758). Nine of the top
20 GO terms based on the B-score are related to this group. Five of
the top 20 GO terms are related to ‘G-protein signaling, coupled to
CAMP nucleotide second messenger’ (GO:0007188); six are related
to ‘lysosome’ (GO:0005764); and two are in the group of ‘negative
regulation of transcription, DNA-dependent’ (GO:0045892). In the
case of the ‘transferase activity, transferring hexosyl groups’, all
nine related terms (GO:0016758, GO:0016757, GO:0000030,
GO:0003844, GO:0008375, GO:0015020, GO:0042328,
GO:0004703, GO:0004674) can be found near GO:0016758
in the GO hierarchy (see Supplementary Fig. 4). Even though
some of these terms are poorly represented in this dataset (e.g.
GO:0003844 represented by only a single gene in the dataset),
all of these terms have relatively high B-scores due to the
overrepresentation of other terms that are Close relatives in the
hierarchy.

In some cases, the association of the group of GO terms
highlighted by the GO-Bayes approach matches our expectations.

 

908

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq 11101} papeolumoq

9103 ‘{g anﬁnv 110::

GO-Bayes

 

Table 1. The top 20 lists GO terms associated with Gene Cluster #7 by CLASSIFI and GO-Bayes

 

 

GO ID IA nA P-Value Rankp B-score Rankg Group GO name
GO:0019933 21 6 4.00E-04 1 0.7652 149 a cAMP-mediated signaling
GO:0005773 91 13 4.61E-04 2 0.7544 187 b Vacuole
GO:0001726 23 6 6.85E-04 3 0.7724 118 b Rufﬂe
GO:0007188 16 5 7.95E-04 4 0.8688 7 a G-protein signaling, coupled to cAMP nucleotide second messenger
GO:0007190 10 4 9.73E-04 5 0.6928 508 a Activation of adenylate cyclase activity
GO:0045762 10 4 9.73E-04 5 0.65 82 778 a Positive regulation of adenylate cyclase activity
GO:0031281 10 4 9.73E-04 5 0.4976 3148 a Positive regulation of cyclase activity
GO:0051349 10 4 9.73E-04 5 0.4712 3545 a Positive regulation of lyase activity
GO:0019935 25 6 1.11E-03 9 0.7568 177 a Cyclic-nucleotide-mediated signaling
GO:0007189 5 3 1.12E-03 10 0.8346 27 a G-protein signaling, adenylate cyclase activating pathway
GO:0016757 57 9 1.71E-03 11 0.8716 6 c Transferase activity, transferring glycosyl groups
GO:0000323 80 11 1.74E-03 12 0.8276 33 b Lytic vacuole
GO:0005764 80 11 1.74E-03 12 0.8762 5 b Lysosome
GO:0010324 69 10 1.87E-03 14 0.5084 2957 b Membrane invagination
GO:0006897 69 10 1.87E-03 14 0.5596 2015 b Endocytosis
GO:0007187 20 5 2.40E-03 16 0.8220 43 a G-protein signaling, coupled to cyclic nucleotide second messenger
GO:0006898 20 5 2.40E-03 16 0.5870 1601 b Receptor -mediated endocytosis
GO:0001609 2 2 2.45E-03 18 0.2706 6218 a Adenosine receptor activity, G-protein coupled
GO:0032230 2 2 2.45E-03 18 0.7562 178 f Positive regulation of synaptic transmission, GABAergic
GO:0048285 2 2 2.45E-03 18 0.5246 2625 f Organelle ﬁssion
GO:0007217 2 2 2.45E-03 18 0.8452 17 a Tachykinin signaling pathway
GO:0051319 2 2 2.45E-03 18 0.5124 2878 f G2-phase
GO:0015851 2 2 2.45E-03 18 0.3764 5103 f Nucleobase transport
GO:0016519 2 2 2.45E-03 18 0.1972 6600 f Gastric inhibitory peptide receptor activity
GO:0000085 2 2 2.45E-03 18 0.5650 1945 f G2-phase of mitotic cell cycle
GO:0016021 874 59 4.68E-03 31 0.8924 3 a, b Integral to membrane
GO:0005886 727 50 6.95E-03 36 0.8562 9 a, b Plasma membrane
GO:0004703 3 2 7.10E-03 40 0.8536 15 c G-protein-coupled receptor kinase activity
GO:0000030 4 2 1.37E-02 61 0.8556 11 c Mannosyltransferase activity
GO:0016758 41 6 1.45E-02 70 0.9004 1 c Transferase activity, transferring hexosyl groups
GO:0015020 5 2 2.22E-02 92 0.8538 14 c glucuronosyltransferase activity
GO:0045892 89 9 3.09E-02 104 0.8996 2 d Negative regulation of transcription, DNA dependent
GO:0015075 135 12 3.41E-02 115 0.8568 8 b Ion transmembrane transporter activity
GO:0003844 1 1 4.96E-02 281 0.8506 16 c 1,4-Alpha-glucan branching enzyme activity
GO:0022891 160 13 5.22E-02 289 0.8562 10 b Substrate -speciﬁc transmembrane transporter activity
GO:0042328 2 1 9.67E-02 471 0.8414 20 c Heparan sulfate N -acetylglucosaminyltransferase activity
GO:0000122 66 6 1.07E-01 491 0.8556 12 d Negative regulation of transcription from RNA polymerase 11 promoter
GO:0004674 200 14 1.18E-01 512 0.8550 13 c Protein serine/threonine kinase activity
GO:0008375 14 2 1.51E-01 620 0.8770 4 c Acetylglucosaminyltransferase activity
GO:0007186 101 7 2.33E-01 814 0.8430 19 a G-protein-coupled receptor protein signaling pathway
GO:0042629 2 0 1.0 NA 0.8432 18 b Mast cell granule

 

The columns 1A and 11A represent the cardinality of the relevant GO term and the number of genes in the GO term that also appear in Gene Cluster #7; P-value and Rankp
represent the hypergeometric P-value computed by CLASSIFI, and the rank of the GO terms based on the P-value; and B-score and Rankg represent the GO-Bayes measure and the

545

corresponding rank of the GO terms. Under the column ‘Group , a represents GO terms closely related to 6020007188 (G-protein signaling, coupled to cAMP nucleotide second
messenger) in the GO hierarchy; ‘b’ represents GO terms closely related to GO:0005764 (lysosome); ‘c’ represents GO terms closely related to GO:0016757 (transferase activity,
transferring glycosyl groups); ‘d’ represents GO terms closely related to 6020045892 (negative regulation of transcription, DNA-dependent); and ‘f’ represents GO terms unrelated

to the above four groups. NA, not applicable.

It is well known that activation of B cells through the BCR induces
endocytosis and the fusion of endocytic vesicles with lysosomes
as a mechanism to capture antigen for presentation to T cells
in order to stimulate the helper immune response (Lee et (11.,
2006). Thus, the presence of lysosome-related GO terms in the
cluster of genes upregulated in response to BRC stimulation might
be expected. In other cases, the association is not immediately
expected, but subsequent investigations revealed that the association
is supported by previous experiment data. For example, the majority

of genes giving rise to the ‘negative regulation of transcription,
DNA-dependent’ association, including ID3 (Fan et (11., 1999),
CTCF (Qi et (11., 2003), SMAD3 (Ramesh et (11., 2009), KLF12
(Roth et (11., 2000), E2F6 (Xu et (11., 2007), FosB (Yin et (11., 2007)
and PA2G4 (Zhang et (11., 2008), have been found to be upregulated
in response to BCR stimulation in B cells or somehow involved in
B-cell signaling responses. In the case of CTCF, Qi et (11. (2003)
showed that this upregulation is associated with the induction of
apoptosis in B cells and can be suppressed by co-stimulation through

 

909

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq 11101} papeolumoq

9103 ‘{g isnﬁnv 110::

S.Zhang et al.

 

CD40 in agreement with the ﬁndings reported here. In still other
cases, no direct corroborative evidence could be found (e.g. for
‘transferase activity, transferring hexosyl groups’). Thus, this ﬁnding
serves as a hypothesis for ﬁiture testing.

In order to compare the results of the GO-Bayes approach with the
standard ORA based on the hypergeometric test, we processed the
gene set in GC7 with the CLASSIFI algorithm (Lee et (11., 2006) and
selected the top 20 GO terms. The top 20 lists by CLASSIFI and
GO-Bayes, respectively, are presented in Table 1. While four GO
terms were ranked in the top 20 by both methods, the remaining top
20 terms from each method were distinct. Based on this comparison,
several distinctions between the two approaches can be made.

First, three of the four GO term groups are found in both top 20
term lists. Two of the groups, G protein signaling and lysosome,
have multiple terms in both top 20 lists. One group, transferase
activity, is only represented once in the CLASSIFI list, but multiple
times in the GO-Bayes list. Given that little could be found in the
literature about these genes in B cell biology, this association would
likely be ignored from the hypergeometric analysis. One group,
the negative regulation of transcription group was not found in the
hypergeometric top 20, and yet is potentially the most interesting
given the strong literature support described above.

Second, eight GO terms in GC7 with (IA,nA)=(2,2) have the
same hypergeometric P-value of 0.0024, and all of them are in the
hypergeometric top 20. The GO-Bayes measure suggests that they
are very different in their association with the cluster. For example,
GO:0007217 (tachykinin signaling pathway) has a B-score of 0.8452
and it ranks in the GO-Bayes top 20. In contrast, GO:0016519
(gastric inhibitory peptide receptor activity) has a B-score of 0.1972
and its GO-Bayes rank is 6600. To shed light on the difference
in the B-scores between these two terms, we compare their regional
DAGs, which are shown in Supplementary Figures 5 and 6. The three
direct ancestors of GO:0007217 have a stronger association with the
cluster than those of GO:00165 1 9. In addition, GO:0007217 has nine
siblings, ﬁve of which have genes represented in the cluster (nA > 0).
By comparison, GO:0016519 has 13 siblings, of which only one
sibling has genes represented in the cluster. The support from the
related GO terms is substantially higher for GO:0007217 than for
GO:0016519, and thus GO:0007217 is judged to be more likely
associated with the cluster based on the GO-Bayes measure. While
there is no evidence for the involvement of the gastric inhibitory
peptide receptor activity in the regulation of B-cell ﬁinction in
the literature, tachykinin (also known as hemokinin-l) has been
found to be secreted during the differentiation of B-cell precursors
thereby regulating their own development (Milne et (11., 2004). Thus,
GO:0007217 does appear to be biologically associated with GC7.

Among the top 20 GO terms identiﬁed by GO-Bayes, 8 GO terms
have two genes or fewer belonging to GC7 (GO: 0007217,
GO:0004703, GO:0000030, GO:0015020, GO:0003844,
GOZ42328, GO:0008375 and GO:0042629). Researchers may
have concern over these ﬁndings, suspecting that they may
be false positives. Based on the GO hierarchy, GO: 0007217
is a child of GO:0007186, which ranked seventh in the top
20 GO-Bayes list. The term is also found to be biologically
associated with the experiment (Milne et (11., 2004). Six of the GO
terms (GO:0004703, GO:0000030, GO:0015020, GO:0003844,
GOZ42328 and GO:0008375) are all related to ‘transferase activity’,
and all of them are in a close neighborhood in the GO DAG
as shown in Supplementary Figure 4. As for GO:0042629, the

fact that none of the two annotated genes were found in GC7
requires in-depth discussion on the term. Note that GO:0042629
is a direct child of ‘lysosome’ (GO:0005764), which ranked
ﬁfth in the top 20 GO-Bayes list. The two genes annotated with
GO:0042629 are IL8 receptor beta (IL8RB) and serglycin (SRGN).
IL8RB has been found to be involved in B-cell chemotaxis across
the blood-brain barrier (Alter et (11., 2003). Mice deﬁcient for
IL8RB show lymphadenopathy due to a speciﬁc expansion of the
B-cell compartment (Cacalano et (11., 1994). Importantly, IL8RB
was found to be dramatically upregulated (~9-fold) in response
to BCR stimulation of primary splenic B cells by microarray
analysis (Sato et (11., 2005) (see IL8RB expression proﬁle in
http://www.ncbi .nlm.nih. gov/sites/GDSbrowser?acc=GDS 1467).
Although less is known about the function of SRGN in B cells, it was
also found to be upregulated following BCR stimulation of B cells
from TAKl-deﬁcient mice in the same microarray experiment.
Taken together, these ﬁndings suggest that the identiﬁcation of
GO:0042629 by GO-Bayes is signiﬁcant and represents an example
where the GO-Bayes approach was able to overcome false negative
results generated by deﬁciencies in microarray data generation or
processing. Thus, GO-Bayes will only identify a GO term with
relatively few annotated genes belonging to S when there is strong
evidence of overrepresentation from its neighboring GO terms.

4 DISCUSSION

In this article, we proposed GO-Bayes, a Bayesian approach for
GO-based OR. The model has a relatively simple format, with
the ﬁrst level as a logistic regression model and straightforward
prior speciﬁcation. The key innovation is that it can incorporate
the dependence structure of the GO DAG on a global scale.
The resulting measure on the association between GO terms and
selected genes borrows information across related GO terms to
strengthen the detection of overrepresentation signals. We have
given detailed comparison between the GO-Bayes approach and the
hypergeometric test, which is widely used in ORA. Our analysis
using an artiﬁcial dataset and a real microarray dataset suggests that
the GO-Bayes approach can produce more biologically meaningful
results than the hypergeometric test.

Relying on individual GO terms, the hypergeometric P-value
has a closed form, which only requires the information on I , IS
and (IA,nA) for each GO term. GO-Bayes, on the other hand,
does not have a closed form and it needs the information on the
structure of the GO DAG. We have developed a program in C to
implement the GO-Bayes approach. For the B-cell lymphoma cell
line example in the application section, the B-score calculations
were completed in ~10 min on a MAC (OS X 10.4.11, 1.83 GHZ
Intel Core Duo processor) computer. The program is available upon
request from S2.

The GO-Bayes measure, rj EP((1]~ >0| Y), is the posterior
probability of a GO term being positively associated with S. As a
reviewer pointed out, rj behaves like a frequentist P-value under the
null hypothesis (Bochkina and Richardson, 2007), and a frequentist-
type estimator of false discovery rate (Storey, 2002) can be employed
to assess the statistical signiﬁcance.

Currently, the proposed method is based on binary outcomes
(membership of genes in S). We are working on generalizing
the GO-Bayes approach to cases with ordinal or continuous
outcomes. Although we have focused on the use of this approach

 

910

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq 11101} papeolumoq

9103 ‘{g isnﬁnv 110::

GO-Bayes

 

for the interpretation of gene expression microarray data and
GO annotation, the general strategy can be applied to any
circumstance in which groups of entities are annotated with
terms derived from any ontology hierarchy or similar dependency
structure.

ACKNOWLEDGEMENTS

The authors thank the three reviewers for their constructive
comments and suggestions.

Funding: US. National Institutes of Health (N01AI40076 and UL1
RR024982, in part).

Conﬂict of Interest: none declared.

REFERENCES

Alexa,A. et al. (2006) Improved scoring of functional groups from gene expression data
by decorrelating GO graph structure. Bioinformatics, 22, 160&1607.

Alter,A. et al. (2003) Determinants of human B cell migration across brain endothelial
cells. J. Immanol., 170, 44974505.

Al-Shahrour,F. et al. (2004) FatiGO: a web tool for ﬁnding signiﬁcant associations of
Gene Ontology terms with groups of genes. Bioinformatics, 20, 5787580.

Ashburner,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology. The Gene
Ontology Consortium. Nat. Genet, 25, 25729.

Basso,K. et al. (2005) Reverse engineering of regulatory networks in human B cells.
Nat. Genet, 17, 1827190.

Beissbarth,T. and Speed,T.P (2004) GOstat: ﬁnd statistically overrepresented gene
ontologies within a group of genes. Bioinformatics, 20, 146L1465.

Bochkina,N. and Richardson,S. (2007) Tail posterior probability for inference in
pairwise and multiclass gene expression data. Biometrics, 63, 111771125.

Cacalano,G. et al. (1994) Neutrophil and B cell expansion in mice that lack the murine
IL-8 receptor homolog. Science, 265, 6827684.

Cao,J. et al. (2009) Bayesian optimal discovery procedure for simultaneous signiﬁcance
testing. BMC Bioinformatics, 10, 5.

Cho,R.J. et al. (2001) Transcriptional regulation and function during the human cell
cycle. Nat. Genet, 27, 48754.

Do,K. et al.(2005) A Bayesian mixture model for differential gene expression.
Appl. Stat, 54, 627$44.

Draghici, S. et al. (2003) Global functional proﬁling of gene expression. Genomics, 81,
98-104.

Grossmann,S. etal. (2007) Improved detection of overrepresentation of Gene-Ontology
annotations with parent-child analysis. Bioinformatics, 23, 302473031.

Gelman,A. et al. (2003) Bayesian Data Analysis. CRC Press, London.

Gilks,W. and Wild,P (1992) Adaptive rejection sampling for Gibbs sampling.
Appl. Stat, 41, 3377348.

Hsueh,R. and Scheuermann,R.H. (2000) Tyrosine kinase activation in the growth,
differentiation and death responses initiated from the B cell antigen receptor.
Adv. Immanol., 75, 2837316.

Khatri,P et al. (2002) Proﬁling gene expression using Onto-Express. Genomics, 79,
26G270.

Khatri,P and Draghici,S. (2005) Ontological analysis of gene expression data: current
tools, limitations, and open problems. Bioinformatics, 21, 358773595.

Lee,H.K. et al. (2005) Ermine]: tool for functional analysis of gene expression data
sets. BM C Bioinformatics, 6, 269.

Lee,J.A. et al. (2006) Components of the antigen processing and presentation pathway
revealed by gene expression microarray analysis following B cell antigen receptor
(BCR) stimulation. BMC Bioinformatics, 7, 237.

Luo,F. et al. (2007) Modular organization of protein Interaction networks.
Bioinformatics, 23, 2077214.

Lewin,A.M. and Grieve,I.C. (2006) Grouping Gene Ontology terms to improve the
assessment of gene set enrichment in microarray data. BMC Bioinformatics, 7, 426.

Milne,C.D. et al. (2004) Mechanisms of selection mediated by interleukin-7, the
preBCR, and hemokinin-l during B-cell development. Immunol. Rev., 197, 75788.

Newton,M.A. et al. (2004) Detecting differential gene expression with a semiparametric
hierarchical mixture method. Biostatistics, 4, 1557176.

Pan,L. et al. (1999) Impaired Immune Responses and B-Cell Proliferation in Mice
Lacking the Id3 Gene. Mol. Cell. Biol., 19, 596975980.

Qi,C. et al. (2003) CTCF functions as a critical regulator of cell-cycle arrest and death
after ligation of the B cell receptor on immature B cells. Proc. NatlAcad. Sci. USA,
100, 6337638.

Ramesh,S. et al. (2009) Transforming growth factor )3 (TGFB)-induced apoptosis.
Cell Cycle, 8, 11717.

Roth,C. et al. (2000) Genomic structure and DNA binding properties of the human zinc
ﬁnger transcriptional repressor AP-2rep (KLF12). Genomics, 63, 3847390.

Sato,S. et al. (2005) Essential function for the kinase TAKl in innate and adaptive
immune responses. Nat. Immanol., 6, 108771095.

Storey,J.D. (2002). A direct approach to false discovery rate. J. R. Stat. Soc. Sen B, 64,
479498.

Tusher,V.G et al. (2001) Signiﬁcance analysis of microarrays applied to transcriptional
responses to ionizing radiation. Proc. NatlAcad. Sci. USA, 98, 511675121.

Xu,X. et al. (2000) A comprehensive ChIP-chip analysis of E2Fl, E2F4, and E2F6
in normal and tumor cells reveals interchangeable roles of E2F family members.
Genome Res., 17, 155071561.

Yin,Q. et al. (2007) B-cell receptor activation induces BIC/miR- 155 expression through
a conserved AP-l element. J. Biol. Chem, 283, 265472662.

Zhang,Y. etal. (2008) Alterations in cell growth and signaling in ErbB3 binding protein-
1 (Ebpl) deﬁcient mice. BMC Cell Biol., 9, 69.

 

911

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

