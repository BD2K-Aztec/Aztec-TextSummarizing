ORIGINAL PAPER

Vol. 29 no. 23 2013, pages 2995-3002
doi:1 0. 1093/bioinfonnatics/btt533

 

Genome analysis

Advance Access publication September 18, 2013

Assessing gene-level translational control from ribosome profiling
Adam B. Olshenl'z, Andrew c. Hsieh2‘3'4, Craig R. Stumpf3'4, Richard A. Olshen5,

Davide Ruggeroz'4 and Barry S. Taylor1'2'3'*

1Department of Epidemiology and Biostatistics, 2Helen Diller Family Comprehensive Cancer Center, 3Department of
Medicine and 4Department of Urology, University of California, San Francisco, CA 94158, USA and 5Department of
Health Research and Policy, Stanford University School of Medicine, Stanford, CA 94305, USA

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: The translational landscape of diverse cellular systems re-
mains largely uncharacterized. A detailed understanding ofthe control of
gene expression at the level of messenger RNA translation is vital to
elucidating a systems-level view of complex molecular programs in
the cell. Establishing the degree to which such post-transcriptional regu-
lation can mediate specific phenotypes is similarly critical to elucidating
the molecular pathogenesis of diseases such as cancer. Recently, meth-
ods for massively parallel sequencing of ribosome-bound fragments of
messenger RNA have begun to uncover genome-wide translational con-
trol at codon resolution. Despite its promise for deeply characterizing
mammalian proteomes, few analytical methods exist for the compre-
hensive analysis of this paired RNA and ribosome data.

Results: We describe the Babel framework, an analytical method-
ology for assessing the significance of changes in translational regu-
lation within cells and between conditions. This approach facilitates
the analysis of translation genome-wide while allowing statistically
principled gene-level inference. Babel is based on an errors-
in-variables regression model that uses the negative binomial distribu-
tion and draws inference using a parametric bootstrap approach. We
demonstrate the operating characteristics of Babel on simulated data
and use its gene-level inference to extend prior analyses significantly,
discovering new translationally regulated modules under mammalian
target of rapamycin (mTOR) pathway signaling control.

Availability: The Babel framework is freely available as source code at
http://taylorlab.ucsf.edu/software_data.html.

Contact: barry.taylor@ucsf.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 7, 2013; revised on August 19, 2013; accepted on
September 7, 2013

1 INTRODUCTION

The translation of cellular messenger RNAs (mRNAs) is the all-
important final product of gene expression. Nevertheless, a com-
plete understanding of gene expression at the level of mRNA
translation is generally lacking. As mRNA levels explain only
a modest fraction of protein abundance, we must establish the
landscape of mRNA translation and determine the mechanisms
by which it is regulated to fully elucidate diverse cellular systems.
Nevertheless, genome-scale characterization of translational

 

*To whom correspondence should be addressed.

changes has lagged behind the development of similar methods
for exploring mammalian transcriptomes. Recent advances in
profiling ribosome occupancy with deep sequencing (Ingolia
et al., 2009), however, now allows a near codon resolution
View of ribosome-bound mRNAs. Brieﬂy, ribosome proﬁling en-
tails isolating fragments of such mRNAs, which results in ~30 bp
ribosome-protected fragments (RPFs) that are puriﬁed and pro-
cessed for massively parallel sequencing. Simultaneously, and
from the same cells, poly(A)+ mRNA is puriﬁed, and concurrent
sequencing of both ribosome and RNA libraries generates short
sequence reads that identify either the position of a bound ribo-
some or the expression of the cognate transcript. These methods
have been used to explore translation in diverse genomes includ-
ing those from yeast, zebrafish, murine models and human can-
cers (Bazzini et al., 2012; Guo et al., 2010; Hsieh et al., 2012;
Ingolia et al., 2011; Thoreen et al., 2012).

These studies have revealed a complex and multifaceted trans-
lational landscape in mammalian transcriptomes. Although open
reading frames (ORFs) that initiate with an AUG codon are
canonical and are perhaps best characterized, a variety of non-
canonical structures also contribute to the diversity and complex-
ity of translation. These include upstream ORFs, non-AUG ini-
tiation of translation, internal ribosome entry sites, translational
re-initiation and frameshift, leaky scanning and the ever expand-
ing world of small RNAs: expressed short and long non-coding
sequences that lack an ORF.

So, although ribosome profiling promises a new window into
the nature and dynamics of normal and anomalous mRNA
translation, progress is predicated on the development of
robust methodologies to facilitate statistically principled analysis.
Prior analyses have described the global features of translational
eﬂiciency in different systems, species and upon multiple perturb-
ations by comparing the log of scaled ribosome counts to the log
of scaled mRNA counts for groups of genes (Bazzini et al., 2012;
Guo et al., 2010; Hsieh et al., 2012; Ingolia et al., 2009, 2011;
Thoreen et al., 2012). However, it is unclear how such a measure
would lead naturally to inference about the biological signiﬁ-
cance of individual changes in genes, especially in the presence
of few replicates. There is, therefore, a great need for robust
methods for drawing gene-level inference on the basis of changes
in translational regulation or even subtle shifts in patterns of
ribosome occupancy. The importance of such quantitative meth-
ods will only grow as ribosome profiling is adopted more widely
to characterize translational abnormalities that drive diverse
pathologies including human cancers. Such efforts would serve

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 2995

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} papaolumoq

9103 ‘Og anﬁnV uo ::

A.B.Olshen et al.

 

   

 

   

 

 
  
 
  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A - B
Ribosome occupancy mRNA abundance 105 _ Locally_weighted polynomial (lowess)
M , ..... AAA Super-smoother
y. 5 Least squares
V 10 - Robust linear
.‘ ‘. Trimmed Linear
* E
a 104 -
U
'U
E
Adapter match+trim t, 103 -
a.)
E
Genome alignment Spliced alignment 8 102 _
.0
00 r:
Assembled alignment and QC 101
Ribosome density Expressed mRNAs 100
' .. I I I I I I I I
A; 100 101 102 103 104 105 106
’ mRNA (read count)
E
E 0.020 -
m ; 32768- (53
I d)
E
w 1024-
mRNA 0.015 - 3
. . a: H
Sample-specific gene-level A 32-
translational regulation 5
o- I l l
g 0 010 - g Q g
Within-condition Between-condition ; ' 0 0
A a mRNA
3 N 5
2 8 D
.S g
g: g 0.005 -
E a
g g /
n. o‘_ \
P»va|ue (replicate 1) P»va|ues (condition 1) 0 '
~1l:lO~ '
Pﬂalue 100 500 1000 1500

mRNA (read count)

Fig. 1. The Babel framework and analysis. (A) A schematic of the Babel framework in which ribosome proﬁling data are processed and aligned, and an
NB-regression-NB model is developed in each sample to identify genes whose ribosome association is higher or lower (red and blue arrows, respectively)
than expected (gray) from its mRNA expression level. Signiﬁcant translationally regulated genes across all the samples of a given condition are
determined (left) as are those that change signiﬁcantly between conditions (right). (B) Although multiple candidate parametric and non-parametric
regression forms were evaluated for estimating ribosome association based on mRNA abundance (plotted here as read counts in log-scale), the trimmed
least squares approach was chosen (see text). (C) Errors-in-variables regression is justiﬁed by the intrinsic uncertainty of mRNA levels under the NB
distribution where variability increases with increasing level of expression, demonstrated here for three genes with NB means of 100, 500 and 1000. The
NB model of ribosome-given-mRNA counts is further necessitated by signiﬁcantly greater variance than mean RPF counts across the distribution of

mRNA abundance (inset)

as a Vital companion to extensive genetic characterization efforts
already underway, such as The Cancer Genome Atlas (http://
cancergenome.nih.gov/).

Here, to facilitate such efforts, we describe a statistical frame-
work, Babel, for determining genes with unexpected ribosome
occupancy: those insufﬁciently explained by their intrinsic tran-
script abundance within a condition, and those whose ribosome
association changes in magnitude or direction between condi-
tions (Fig. 1A). We demonstrate its statistical properties through
simulations, and its applicability through the re-analysis of
ribosome proﬁling data interrogating translational control
downstream of the mTOR signaling pathway.

2 METHODS
2.1 Outline of methods

The relationship between the level of ribosome occupancy and mRNA
expression transcriptome-wide can be described quantitatively from

sequencing data. We sought to exploit the monotonic relationship be-
tween ribosome association and mRNA levels as the basis for the gene-
level inference described here (Fig. 1B). For a transcript with a given
abundance, the expected level of ribosome occupancy can be inferred
so that translationally regulated genes are those for which the level of
bound ribosome deviates signiﬁcantly from that expected value. To esti-
mate this expected level, we developed an errors-in-variables regression
model. Unlike typical regression, our model treats the mRNA level (pre-
dictor) as measured with error rather than as ﬁxed. As a ﬁrst step, mRNA
levels are modeled by the negative binomial (NB) distribution, as is con-
vention (Robinson and Smyth, 2008), because the variance of the counts
is greater than the mean. As a second step, because ribosome occupancy
involves counts for which there is again extra Poisson variation (Fig. 1C),
we also model the level of bound ribosome given mRNA abundance as
NB. To estimate the mean in the second part of the model, we tested
multiple regression forms (Fig. 1B). A trimmed least-squares approach
(for which a fraction of genes with outlying mRNA levels were excluded
before model ﬁtting) was most stable over all experiments (data not
shown). This second over-dispersion parameter is modeled using an it-
erative algorithm to prevent overestimation. Subsequent inference under

 

2996

112 /310's112u1n0fp10}x0"sotJButJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og isnﬁnV uo ::

Assessing gene-level translational control

 

 

 

 

 

 

 

 

 

 

 

-1
B
N
w _
% (O’d) 0.5
?
Q (0.0”)
1d,?) ,0
p-value 1 0 (d',0) 0.5 1
1 - (d1) c D - 0.1
1
05' (1’d) This study; p=0.0013005 '0-05
Fisher’s; p=0.00005
0_ . (0.05,0.001) _0
0 0.5 1 0 0.05 0.1

Fig. 2. Combining multiple tests. (A) Fisher’s method for combining two
independent tests. (B) Our alternative approach based on the arithmetic
mean of P-values. All equally signiﬁcant pairs deﬁne a line passing
through (d, 0) and (0, (1), whereas more signiﬁcant pairs correspond to
a line with d’ < (1 (dark blue). Thus, the combined P-value corresponds to
the area of the triangle. (C) One-sided P-values are used; therefore, the
opposite triangle is used for pairs of consistently large P-values. (D) A
practical example of the difference between approaches

Babel is based on a parametric bootstrap. Speciﬁcally, in every sample
with mRNA and ribosome data, we estimate a P-value for every gene
under the null hypothesis that the level of bound ribosome is as expected
from mRNA abundance. These P-values are estimated for a one-sided
test in which both low and high P-values are of interest; low P-values
correspond to higher than expected ribosome-given-mRNA counts and
high P-values correspond to the opposite.

Because Babel quantiﬁes gene-level mRNA translation (ribosome oc-
cupancy given mRNA levels) as a P-value in each sample of a given
condition, a particularly important challenge is to combine these into a
single assessment of the signiﬁcance of translational regulation based on
at best a few biological replicates. A long-standing approach for combin-
ing multiple independent P-values is Fisher’s method (see Equation 4).
One aspect of Fisher’s method is that when the number of P-values is
small, a single low P-value can lead to a signiﬁcant combined P-value
(Fig. 2A). We exploited an alternative method that instead emphasizes
consistency among replicates, reasoning that consistently strong signals
are most likely to represent true events of biological signiﬁcance. This
approach results in a combined P-value that is a function of the arith-
metic mean of the individual P-values. This method maintains symmetry
between each of two or more tests of hypotheses and their P-values as
well as convexity (of the acceptance and rejection regions) (Fig. 2B and
C). It produces a small combined P-value from consistently small one-
sided P-values of ribosome-given-mRNA levels (and the reverse for two
or more large one-sided P-values). Once combined, two-sided P-values
can be estimated and genes are considered regulated at the translational
level if their corresponding P-values are low after adjusting for multiple
comparisons (Fig. 2D).

An equally important problem is identifying genes whose ribosome
occupancy relative to its mRNA abundance changes between conditions.
We developed a statistical test for this purpose based on the differences in
the within-condition P-values. After transforming the P-values using the
Gaussian quantile function, a Z-test is used and two-sided P-values are
obtained.

All analyses conducted here, unless otherwise speciﬁed, were per-
formed using the R statistical language, version 2.11.

2.2 Sequencing and alignment

The ribosome proﬁling strategy, described elsewhere (Ingolia et al., 2009),
produces short single-end sequencing reads of between 36 and 50 bp.
Data analyzed here were generated from libraries prepared and
sequenced as previously described (Hsieh et al., 2012) and downloaded
from the NCBI Gene Expression Omnibus under the accession number
GSE3S469. Because the ribosome-bound mRNA fragment may be a vari-
able-length component of each sequencing read followed by a known
adapter sequence (CT GTAGGCACCATCAAT), raw sequencing reads
in FASTQ format were ﬁrst clipped of the adaptor and remaining 3’
sequence with the FASTX-Toolkit, retaining only reads of 24 bp post-
clipping length or longer. Reads were mapped to the human assembly
(NCBI build 36) with Burrows7Wheeler Alignment (ver. 0.5.9-r16, de-
fault parameters) (Li and Durbin, 2009). Unaligned reads were then
mapped to known splice junctions with Tophat (ver. 1.4.1) (Trapnell
et al., 2009) using a transcriptome index created from version 11 of the
Gencode gene set (Harrow et al., 2006). Provisional merged BAM ﬁles (Li
et al., 2009) were created from aligned and unaligned reads from either
the genome or spliced alignment, and read groups were enforced across
lanes and experiments. BAM ﬁles were then indexed, coordinate sorted
and had alignment metrics determined, all with the Picard suite (http://
picard.sourceforge.net/).

2.3 Gene-level assessment

For all gene-level inference, only those protein-coding transcripts of levels
1 or 2 of Gencode support (veriﬁed or manually curated loci, respectively)
were used. We initially assessed two candidate gene models. The ﬁrst
retained only the longest transcript of multi-isoform genes. The second
was a uniﬁed gene model in which the union of coding sequence across all
isoforms of a given gene was collapsed into a single model per gene. As no
signiﬁcant difference in read mapping or expression (as reads per kilobase
of exon model per million mapped reads; rpkM) was observed between
these two models, all subsequent analyses used the uniﬁed model. The
gene-level inference of ribosome-given-mRNA levels described here eval-
uated only those genes that we estimated to be expressed in the studied
transcriptome. To determine expressed genes, we ﬁrst mapped aligned
reads to their coding sequences, treated spliced reads between exons as
a single fragment and excluded ambiguous reads (those aligning to over-
lapping coding sequence of two distinct genes: 1.527279% of coding
sequence reads across the aligned libraries). We then calculated a normal-
ized RPKM expression estimate based on scaled library sizes using
Trimmed Mean of M-values (TMM) normalization (Robinson and
Oshlack, 2010). We also generated a null distribution of similar expression
(normalized rpkM) in randomly selected regions of the genome with a size
distribution sampled from the empirical size distribution. These regions
were selected from a genome masked of all coding and non-coding RNAs
(Gencode; levels 172) as well as any known or putative human expressed
sequence tags. A P-value was estimated for each gene by comparison
with the distribution of random genomic intervals. Genes with a nominal
P-value<0.05 were considered expressed (Supplementary Fig. S3).

2.4 Errors-in—variables regression of ribosome association
on mRNA abundance

The NB distribution is used throughout the Babel statistical model (see
Fig. 1). One parameterization of the NB distribution is with mean A and
variance A(1 + Mb), where d) represents the parameter for over-dispersion
(variance above what would be expected from the Poisson distribution).
When d) is zero, the variance is equal to the mean, and the NB distribu-
tion is the same as the Poisson distribution.

 

2997

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og isnﬁnV uo ::

A.B.Olshen et al.

 

Let xg,g= 1,. . . ,n represent the mRNA level for the gth gene and
yg,g=1,...,n represent the level of bound ribosome for the same
(levels are read counts in both cases). As is typical in modeling
RNA-seq data, the mRNA levels for the gth gene are modeled as
coming from a NB distribution. Because there are typically few repli-
cates, we estimate a single over-dispersion parameter (1),, across genes
using the method of Robinson and Smyth (Robinson and Smyth,
2008) as implemented in edgeR (Robinson et al., 2010). Then, we
also model yglxg as NB with mean xgﬁ, where )3 is estimated from
regression, and over-dispersion ¢y_ We tested multiple regression meth-
ods to identify the optimal approach for estimating  Candidate
models included SuperSmoother, locally weighted regression (lowess),
least squares, and robust least squares (Fig. 1B). Whereas the smooth-
ing-based approaches tended to overestimate ribosome level in genes
with low mRNA levels, robust least squares underestimated the ex-
pected ribosome level because of skew in the models for count data (in
which median<mean) and least squares was susceptible to high lever-
age from genes with high expression (those in the right tail of the
mRNA distribution). In all experimental conditions, a trimmed least-
squares approach, where the g-percent of the genes (by default, g: 10)
with lowest and highest mRNA levels are trimmed before model ﬁt,
was most stable, and thus is used. Although univariable in its current
form, exploiting regression here will allow additional covariates to be
incorporated that measure different facets of translational control,
thereby increasing the accuracy of the model.

To estimate (by, after removing the s-percent of the genes with the
lowest and highest abundances, we partition the data based on mRNA
abundance into B bins containing an equal number of genes (by default,
B = 20 and a = 10). For each bin, we compute the empirical variance of
ribosome levels, Vb,b=1, . . . , B. Then, (by is estimated by minimizing the
squared error across bins:

B
(is), = argvfnin Z(V;, — ¢)2. (1)
b:1

Because there exists a set of genes for which ribosome levels are dif-
ferent than expected from their intrinsic mRNA levels, which are in fact
the very genes we are trying to identify, we developed an iterative process
to avoid overestimating (by. Here, we deﬁne an initial value (2)0 = 0.2 and
eliminate genes in the variance calculations with P-values <0.01 under the
NB model with mean equal to the product of )3 and the median mRNA
abundance in the bin. To calculate the ﬁnal  this process is repeated,
seeded with (2)1 (again, excluding outlier genes from the calculation of
variance).

We use the parametric bootstrap and the modeling described previ-
ously to estimate P-values under the null hypothesis that the ribosome
level is as expected from the mRNA level. Here, we begin by simulating
mRNA values x*g1, . . . ,x*gN for every gene from the NB distribution
with mean xg and over-dispersion 15x, where N is typically 107 to
obtain sufﬁcient granularity of the P-values. Then each y*g1, . . . , y*gN is

simulated once from a NB distribution with mean x*gj/3 and over-disper-

sion (in, where )3 and (13,. are as described earlier. A one-sided P-value is
calculated from these simulations as:

_ Elf/211(ka >yg)

N (2)

Pg

where I is the indicator function. This corresponds to the proportion of
simulated read counts for bound ribosome greater than the observed
count. Low P-values imply ribosome levels are greater than expected
from a gene’s mRNA level, whereas high P-values imply the reverse. If
there is only a single experiment, two-sided P-values are obtained as:

p; = 29(ng —pg). <3)

These P-values are corrected for multiple comparisons using the
q-value method of Storey (Storey, 2002). Although the focus so far has
been on the estimate of signiﬁcance in a single sample, the next section
details how to estimate both one- and two-sided P-values when there is
more than one experiment in a condition.

2.5 Combining P—Values within a condition

For every condition with two or more replicates, we would like a single
consensus P-value to quantify how unexpected the ribosome levels are
given the mRNA abundance of the gene in that condition. A common
approach for combining independent P-values is Fisher’s method, which
uses a test statistic S:

S = Z -210g(p,-). (4)
['21

where S is distributed as X2 with 2n degrees of freedom. Here, S is a
function of the product of the independent P-values, and thus it is pro-
portional to the geometric mean of the P-values. Fisher’s method is sen-
sitive to single small P-values. We have used and developed an
application of alternative methodology proposed by Edgington
(Edgington, 1972). The method, which is based on the arithmetic mean
of P-values, estimates a combined P-value that is more appropriate than
Fisher’s method in this context because it is less sensitive to single outlier
P-values. In the case of two replicates i and j in a given condition, we let
d = p; + pj for [7; +17) 5 1. This deﬁnes a line that passes through (d, 0) and
(0, d) (as in Fig. 2). Here, all pairs of P-values satisfying this condition are
considered equally signiﬁcant, whereas pairs satisfying d’<d are con-
sidered more signiﬁcant. Therefore, all more signiﬁcant pairs of
P-values trace out a triangle to the left of d. For [7,- +17) 5 1, the combined
P-value is thus:

in 2 05(1).- + 17,-)? (5)

whereas for p,- +pj> 1,

P=0.5+(12i+pj—1)*(1—(’%j_1)). (6)

The ﬁrst term corresponds to the triangle for d=1 and the se-
cond corresponds to the trapezoid to the right of this line. Critically,
input for this method is the one-sided P-values of ribosome level on
mRNA, such that pairs of small one-sided P-values give small combined
P-values and pairs of large one-sided P-values give large combined
P-values.

Additionally, this methodology can be generalized to any number of
dimensions using the same principles. The assumption, however, under-
lying the appropriate sampling distribution used to estimate P-values is
difﬁcult to compute. It is the distribution of the sum of independent,
identically distributed random numbers, each uniformly distributed on
the unit interval [0, 1]. This is known as the IrwiniHall distribution (Hall,
1927; Irwin, 1927), where the density of d is:

1 a k 7' n71
fn(8)=m;(—l) (k)(8—k) . (7)

Integration gives the cumulative distribution function of d:

1 5
Fits) = ;Z(—1)"(,’:)(8 — k)". (8)
'k:0

The one-sided P-value is then P=F,,(d). A two-sided combined
P-value can be obtained as before (3) and corrected for multiple com-
parisons as described previously.

 

2998

112 /310's112u1n0[p101x0'sopvuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Assessing gene-level translational control

 

2.6 Assessing changes in translational regulation between
conditions

To compare the translational regulation for every gene between pairs of

conditions, we test for equality of the within-condition P-values, which

allows mRNA levels to change while maintaining a valid test. P-values

are converted to standardized Z-statistics using the Gaussian quantile

function GT]:

Z = G710?)- (9)

Let p,-/ represent the one-sided P-value for ribosome relative to mRNA
level for the ith condition and jth replicate for one gene. Assuming two
replicates, the corresponding Z-statistics are 2 I: 1,2, j: 1,2. The test
statistic for every gene g is therefore:

2 ((le + 212) — (221 + 222)),
SE

in

tg (10)
where Sng is the estimated standard error of the numerator. Accurately
estimating SEg from a small number of values for every gene is challen-
ging. Although previous methods developed for the analysis of small
microarray studies have used moderated approaches (Smyth, 2004), we
believe insufﬁcient information exists within genes to derive an accurate
estimate in this way. Therefore, we derive a single Sng across genes. We
calculate the varianCHovariance matrix for the Zs, which leads to the
estimate:

 

2
SEg =   + 2(Sn,12 + S21,22) — 2(1111,21 + Sn,22 + Si2,21 + 1112,22)-
i,j:l

(11)

where the ﬁrst term is for the variances and the second and third terms
are for the covariances. Generally, if there exists other than two repli-
cates, all within condition covariance terms are added, whereas all be-
tween condition covariance terms are subtracted. Now Sng would be
estimated ideally from only the genes where there has been no change
between conditions, but these genes are unknown. Therefore, if there are
m total samples in the test, we screen out genes with numerators corres-
ponding to Equation (10) greater than 3% before estimating Sng. Test
statistics (10) can then be converted into two-sided P-values by compari-
son with the standard Gaussian distribution and corrected for multiple
comparisons as described previously.

We note that although genes are correlated across conditions, this test
uses only the P-values within conditions. Nevertheless, the denominator
of the test includes the covariance of the statistics in the numerator, so
this correlation is incorporated. Additionally, a more natural test may use
ribosome occupancy counts directly instead of the Gaussian quantile
transformation of the P-values that we use here. Nevertheless, because
of our use of the errors-in-variables model and the skewness of the NB
distribution, there was no clear formulation to us of such a test. We did
examine test statistics based on differences and log ratios and none were
as powerful as the one described here. This method is suitable for any
number of replicates (including as few as one) after making the requisite
adjustments to (10) and (11).

2.7 Simulations to assess size and power

We performed simulations to evaluate the size and power of the Babel
framework that assumed the NB-regression-NB model was correct. The
parameters used for all simulations were those inferred from the second
replicate of the control (DMSO) experiment in Hsieh et al. (Hsieh et al.,
2012). Speciﬁcally, for each set of parameters, we generated 100 datasets
with two replicates in each of three conditions. Using 10 S82 expressed
genes, for every replicate and condition we simulated mRNA levels from
a NB distribution with mean according to the observed mRNA abun-
dances and over-dispersion estimated from the Hsieh et al. data. From

these simulated mRNA levels, we further simulated expected ribosome
levels from a NB distribution with mean and over-dispersion again esti-
mated from the Hsieh et al. data, where the former was the product of the
regression value and the simulated mRNA levels. To evaluate power in
these simulations, we increased or decreased the ribosome levels (as RPF
counts) 2-, 3- and 4-fold for the same 50 genes in each simulation. We
increased or decreased genes either in the bottom 5%, the middle 90% or
the top 5% of mRNA abundance to examine whether the procedure
behaved differently at varying mRNA levels. These genes were altered
for only one of the three conditions. Once the data were generated, our
standard procedure for ﬁtting and P-value estimation was used (as
described previously) and altered genes were identiﬁed based on two-
sided tests.

2.8 Comparisons with published gene sets

A strict comparison was made between published results and the mRNAs
identiﬁed as translationally regulated by Babel. In total, 144 mRNAs were
previously reported as being reduced translationally in PC3 cells upon
PP242 inhibition, as determined by a threshold of translational efﬁciency
(Hsieh et al., 2012). Translational efficiency was deﬁned previously as the
difference in the log ratio of ribosome occupancy to mRNA level between
treated and untreated cells. Owing to differences in the gene sets used
(UCSC Known Gene versus Gencode version 11), 30 genes could not be
mapped to a Gencode record of level 172 of support and, therefore, a
comparison based on 1 14 genes was made. For all presumptive false nega-
tives in the present analysis, manual inspection of read alignments across
the UCSC canonical form and Gencode gene models (including a General
Transfer Format (GTF) ﬁle of all uniﬁed models used here) was under-
taken with the Integrative Genomics Viewer (http://www.broadinstitute.
org/igv/) to conﬁrm coding sequence differences.

3 RESULTS
3.1 Operating characteristics of Babel

To determine the operating characteristics of Babel, we per-
formed simulations from our errors-in-variables doubly NB re-
gression model. We assessed the type I error rate and the power
both within and between conditions by varying the number of
replicates; signiﬁcance and mRNA expression levels; and in the
case of power, fold change. Both within and between conditions,
Babel produced accurate nominal P—Values in the tails for null
data, that is, data for which there is no true difference for any
gene. As an example, for a = 0.05 for both within and between
conditions, 5.21 and 4.94% of genes were signiﬁcant for two
replicates, respectively (Supplementary Table S1; Fig. 3A).

We also evaluated the power of Babel by altering 50 genes at
multiple levels of mRNA expression, increasing or decreasing the
ribosome association between 2- and 4-fold. Within a given con-
dition, Babel had similar power for increases and decreases
across different levels of the mRNA distribution, except for the
expected reduction in power for identifying decreases of any
magnitude in ribosome association at low levels of mRNA ex-
pression. At a = 0.05, mRNAs with a 4-fold increase or decrease
in ribosome association in two replicates were identiﬁed 87.4 and
92% of the time, respectively, in the middle 90% of the mRNA
abundance distribution (Fig. 3B, see Supplementary Table S2).
As expected, increasing either the fold change of ribosome-given-
mRNA levels or the number of replicates increased the power in
all cases. For testing between conditions, additional replicates are
needed to achieve similar power to the within test. For the

 

2999

112 /310's112u1n0[p101x0'sopvurJOJHtorq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.B.Olshen et al.

 

Replicates (n=1-3)

 

 

A - B ‘44
replicates (n = 1 2 3) ," 1.0- u.- T -.- i
E T 5’,o.'(expecled) T g 7E.  :
0999- HE'- , : : _ J. . v ,
0.8- E I I ' - I
e xii? 59:51 I a
E 0.999 E  E i 7 , 5
g 0-95' L0.6- .4, “ I ::E:
a) 01 i ‘ T l i i
u 3 1 ' 1 i i ‘
(Cu ‘ S .L 2  i
#33 0.05- 0.4- ; TB EH
C I l
.9 I I i l
(I) i ' g " .1
0.001 - 0.2-  El
2- - E
- 3- : -*
0_0. - 4-fold changes -
' 0.001

 

 

0'05 Significance level

Fig. 3. Characterizing Babel performance. (A) The proportion of P-values below the given cutoffs as a function of the number of replicates for simulated
data in which there are no translationally regulated genes. Results across simulated datasets indicate the type I error rates in Babel are as expected.
(B) The power of the Babel framework for detecting translationally regulated genes (24-fold increase in ribosome association) as a function of the
number of replicates at signiﬁcance levels of 0.05 and 0.001 among genes in the middle 90% of the distribution of mRNA abundance

aforementioned parameters (4—fold increases among middle 90%
mRNA levels at 0:20.05), 73% of increased genes were identi-
ﬁed (as compared with the 87.4% described previously).
Nevertheless, the power increases to 88% with the addition of
a third replicate, emphasizing the need for proper study design
when considering a multifaceted analysis of changes both within
and between conditions. Finally, we conﬁrmed that increasing
the fold change or the mRNA level always increased the power in
Babel and that for ﬁxed levels of both, there was more power to
detect genes with increased translation than those with decreased
translation.

3.2 Reassessing mRNA translation downstream of mTOR
ﬁgnahng

To assess the performance of Babel, we analyzed translational
control downstream of mTOR signaling (Supplementary Fig.
S1). Ribosome profiling was previously performed on the PC3
prostate cancer cell line upon perturbation with one of two
pharmacological inhibitors of mTOR: either the allosteric inhibi-
tor rapamycin or the stringent adenosine triphosphate (ATP) site
inhibitor PP242 (Hsieh et al., 2012). Each experiment was per-
formed in duplicate as a biological replicate, and control experi-
ments were performed with DMSO.

The original analysis identiﬁed 144 mRNAs that were
decreased selectively in ribosome association upon PP242 inhibi-
tor treatment. Of these, 114 were analyzed here (because of dif-
ferences among gene deﬁnitions; see Methods). Notably, at
(120.05, Babel analysis identiﬁed 90 of these 114 genes from
the original analysis (79%; P-Value~0, McNemar’s test), indi-
cating strong concordance (Fig. 4A). These included a large
number of the components of the translation machinery and a
functionally validated pro-invasion gene signature, both consist-
ent with upstream inhibition of mTOR signaling (Hsieh et al.,
2012). Among 24 presumptive false negatives, those identiﬁed by
the previous study but not signiﬁcant in Babel, some had high
variability between replicates (Supplementary Fig. S2), whereas
others varied because of differences in the gene models used by
the two analyses (see Methods).

Notably, at a q-Value cutoff of 0.25, Babel analysis identiﬁed
163 genes with a signiﬁcant increase or decrease in ribosome as-
sociation upon robust mTOR inhibition with PP242. Of those,
100 were not previously observed (Supplementary Table S3).
Although many of these new ﬁndings were attributable to the
broader range of mRNA expression Babel uses to credential
genes for analysis, others revealed specific facets of mTOR regu-
lation of translational control. Babel appeared particularly effect-
ive at identifying networks of functionally related genes. One such
inter-connected module was comprised of multiple Rab family
Ras-related GTPases involved in endocytosis. Although both
the original study and Babel identiﬁed PP242-inhibitor related
translational regulation of RABGGTC, a Rab geranylgeranyl—
transferase, Babel also identified RAB3A and RABI3, indicating
mTOR signaling may play a role in the translational regulation of
multiple molecular components of endocytic trafﬁcking.

Among core functional modules, Babel analysis identiﬁed ﬁve
subunits of the eukaryotic initiation factor 3 (eIF3) that were
significantly reduced in ribosome association upon mTOR-
kinase inhibition (Supplementary Table S4). Although two
non-conserved subunits eIF3l and eIF3h were identiﬁed previ-
ously (Hsieh et al., 2012; Thoreen et al., 2012), we found three
additional components that had lower than expected ribosome-
given-mRNA levels upon mTOR inhibition with PP242 that
were absent upon rapamycin treatment, an effect that was
eIF3-speciﬁc (Fig. 4B). Although the precise biochemical func-
tions of eIF3 remains to be determined, it is known that eIF3
interacts with eIF4G to mediate the assembly of the 43 S ribo-
some on individual mRNAs and its depletion reduces transla-
tion. Notably, all of the translationally repressed subunits, both
conserved and non-conserved, have a direct physical interaction
(Fig. 4B, inset), four of which (eIF3a, f, h and e) are also con-
stituents of the functional core essential for eIF3 complex for-
mation (Masutani et al., 2007; Siridechadilok et al., 2005; Zhou
et al., 2008). These ﬁndings support a direct contribution of eIF3
loss to PP242, but not rapamycin-mediated inhibition of trans-
lation. Additionally, subunits dispensable for active eIF3 com-
plex formation(Masutani et al., 2007) (eIF3l) were also
translationally repressed, indicating a regulatory function may

 

3000

112 /310's112u1n0[p101x0'sopvurJOJHtorq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Assessing gene-level translational control

 

 

 

B
0
59°
3 104 a; 060° 0 o o
m ' - /'
? 40020009 0
O 90% <7 ’29, /
__ 0
10'5- \

10-8-

 

O

 

 

I I I I I I I I
0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5

|Translational efficiencyl

B e|F1 e|F2 eIF3 e|F4 elF5

 

$3

103'

ll

Nominal p-value

 

 

I FDR < 25% I N.S. I Not assessed

Fig. 4. Analysis of mTOR inhibition. (A) The relationship between Babel-produced q-values for genes after mTOR inhibition with the adenosine
triphosphate site inhibitor PP242 compared with the absolute value of translational efficiency as previously calculated (Hsieh et al., 2012). The rank of
genes identiﬁed by Babel or by the original study is shown (inset), ranked by Babel signiﬁcance. (B) Babel analysis of mTORCl inhibition with PP242
identiﬁed several genes encoding distinct subunits of the eIF3 complex as selectively inhibited at the translational level, a signature that was absent upon
rapamycin treatment or among the other eIF complexes. The eIF3 complex bound to the 408 ribosome is represented schematically [inset; inferred from
references Masutani et al. (2007); Siridechadilok et al. (2005); Zhou et al. (2008)] with subunits colored as a function of the signiﬁcance of their

translational repression upon mTOR inhibition (as indicated)

exist beyond complex formation that is controlled at the trans-
lational level rather than at the transcriptional level in response
to upstream mTOR signals. Together, these results demonstrate
eIF3 may be a key downstream effector of mTORikinase-
mediated inhibition of translation.

4 DISCUSSION

The ability to draw statistically principled inferences about trans-
lationally regulated genes from ribosome proﬁling is necessary
for the discovery of speciﬁc mechanisms of, and abnormalities in,
translational control in diverse cellular systems. Here, we intro-
duce the Babel framework for performing just such an analysis.
Babel produces a natural and readily interpretable summary
(P—Value) of the level of ribosome-given—mRNA for individual
genes within samples and between conditions. On simulated
data, we demonstrated that Babel has proper type I error both
within and between conditions and possesses good power that
increases with sample and effect size, emphasizing the need for
careful design of ribosome proﬁling experiments. A reanalysis of
ribosome proﬁling in response to multifaceted mTOR inhibition
both conﬁrmed prior ﬁndings, and importantly, extended them
to identify novel functional modules subject to translational
control in prostate cancer cells.

Among the greatest strengths of Babel is model ﬂexibility. As
more is learned about the layers of overt post-transcriptional
regulation that impact ribosome occupancy and may uncouple
the abundance of a transcript from its level of active translation,
quantitative measures of these underlying processes can be incor-
porated as covariates to improve the accuracy of the model.
Babel also introduces a new approach for combining P-Values
across independent tests in this context that has applicability far
beyond the analysis of ribosome proﬁling. Nevertheless, chal-
lenges remain. Our simulations and experience indicate that
modeling RPFs for genes with low mRNA abundance (and,

therefore, low RPFs) can produce inaccurate P—Values based
on what may be small stochastic ﬂuctuations in read counts be-
tween samples (see Supplementary Note). Although beyond the
scope of this work, improving this will require a joint estimate of
RPF and mRNA counts sufﬁcient to produce accurate P—Values
from the bootstrap in the left tail of the mRNA distribution.
Furthermore, additional improvements to the ribosome proﬁling
protocol are necessary to extend these analyses to isoform-
speciﬁc translational patterns.

Despite these challenges, Babel establishes a statistical frame-
work for inferring changes in translational regulation of cellular
mRNAs. In conjunction with ribosome proﬁling, the Babel
framework will help bridge the gap in our understanding of
the translational control of normal and pathogenic phenotypes.

Funding: Prostate Cancer Foundation (PCF) Young Investigator
Awards (to A.C.H. and B.S.T.); Burroughs Wellcome Fund
Career Award for Medical Scientists (to A.C.H.); David H.
Koch Foundation (to B.S.T.); National Institutes of Health
[4R37EB002784—35 to R.A.O.; F32CA162634 to C.R.S.;
lK08CAl75154—01 to A.C.H.; P30 CA82103 to A.B.O.;
R01CA154916 and R01CA140456 to D.R.]; A.C.H. is a post-
doctoral fellow of the American Cancer Society. D.R. is a
Leukemia and Lymphoma Society Scholar.

Conflict of Interest: none declared.

REFERENCES

Bazzini,A.A. et al. (2012) Ribosome proﬁling shows that miR—430 reduces transla—
tion before causing mRNA decay in zebraﬁsh. Science, 336, 2337237.

Edgington,E.S. (1972) An additive method for combining probability values from
independent experiments. J. Psychol., 80, 3517363.

Guo,H. et al. (2010) Mammalian microRNAs predominantly act to decrease target
mRNA levels. Nature, 466, 8357840.

Hall,P. (1927) The distribution of means for samples of size n drawn from a popu—
lation in which the variate takes values between 0 and 1, all such values being
equally probable. Biometrika, 19, 2407245.

 

3001

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papao1umoq

9103 ‘0g1sn8nV uo ::

A.B.Olshen et al.

 

Harrow,J. et al. (2006) GENCODE: producing a reference annotation for
ENCODE. Genome Biol, 7(SuppL l), 34.17349

Hsieh,A.C. et al. (2012) The translational landscape of mTOR signalling steers
cancer initiation and metastasis. Nature, 485, 5&6].

Ingolia,N.T. et al. (2009) Genome—wide analysis in vivo of translation with nucleo—
tide resolution using ribosome proﬁling. Science, 324, 2187223.

Ingolia,N.T. et al. (2011) Ribosome proﬁling of mouse embryonic stem cells
reveals the complexity and dynamics of mammalian proteomes. Cell, 147,
7897802.

Irwin,J.O. (1927) On the frequency distribution of the means of samples from a
population having any law of frequency with ﬁnite moments, with special ref—
erence to Pearson’s Type II. Biometrika, 19, 2257239.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows—
wheeler transform. Bioinformatics, 25, 175471760.

Li,H. et al. (2009) The sequence Alignment/Map format and SAMtools.
Bioinformatics, 25, 207872079.

Masutani,M. et al. (2007) Reconstitution reveals the functional core of mammalian
eIF3. EMBO J., 26, 337373383.

Robinson,M.D. and Oshlack,A. (2010) A scaling normalization method for differ—
ential expression analysis of RNA—seq data. Genome Biol, 11, R25.

Robinson,M.D. and Smyth,G.K. (2008) Small—sample estimation of negative bino—
mial dispersion, with applications to SAGE data. Biostatistics, 9, 3217332.
Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for differential expres—

sion analysis of digital gene expression data. Bioinformatics, 26, 1397140.

Siridechadilok,B. et al. (2005) Structural roles for human translation factor eIF3 in
initiation of protein synthesis. Science, 310, 151371515.

Smyth,G.K. (2004) Linear models and empirical bayes methods for assessing dif—
ferential expression in microarray experiments. Stat. Appl Genet. Mol Biol, 3.
Article3.

Storey,J.D. (2002) A direct approach to false discovery rates. J. R. Statist. Soc. B,
64, 4794198.

Thoreen,C.C. et al. (2012) A unifying model for mTORCl—mediated regulation of
mRNA translation. Nature, 485, 1097113.

Trapnell,C. et al. (2009) TopHat: discovering splice junctions with RNA—Seq.
Bioinformatics, 25, 110571111.

Zhou,M. et al. (2008) Mass spectrometry reveals modularity and a complete subunit
interaction map of the eukaryotic translation factor eIF3. Proc. Natl Acad. Sci.
USA, 105, 18139718144.

 

3002

112 /BJO'S[BHJnOIpJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papao1umoq

9103 ‘0g1sn8nv uo ::

