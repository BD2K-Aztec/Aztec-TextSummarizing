Vol. 27 no. 17 2011, pages 2437-2438
APP S N O  doi:10.1093/bioinformatics/btr403

 

Phylogenetics

Advance Access publication July 6, 2011

spacodiR: structuring of phylogenetic diversity in ecological

communities

Jonathan M. Eastman1’2’*, C. E. Timothy Paine3 and Olivier J. Hardy4’*

1Department of Biological Sciences, 2Institute for Bioinformatics and Evolutionary Studies (IBES'D, University of
Idaho, Moscow 83844, 3Institutf r Evolutionsbiologie und Umweltwissenschaften, Universit tZ rich, Z rich
CH—8057 Switzerland and 4Evolutionary Biology and Ecology Unit, CP 160/12, Facult des Sciences, Universit

Libre de Bruxelles, B—105O Brussels, Belgium
Associate Editor: David Posada

 

ABSTRACT

Motivation: SPACODIR is a cross-platform package, written for the
R environment, for studying partitioning of diversity among natural
communities in space and time. Complementing and extending
existing software, SPACODIR allows for hypothesis testing and
parameter estimation in studying spatial structuring of species-,
phylogenetic- and trait diversities.

Availability: Integrated with other software in the R environment and
with well documented and demonstrated functions, SPACODIR is an
open-source package and available at http://cran.r-project.org.
Contact: jonathan.eastman@gmail.com; ohardy@ulb.ac.be

Received on April 5, 2011; revised on June 10, 2011; accepted on
July 1, 2011

1 INTRODUCTION

Until recently, the formalized importance of historical processes
in the development of communities had been largely neglected
(see Webb et al., 2002). With ongoing development in the ﬁeld
of community phylogenetics, time-dependent processes can now
be directly integrated into the study of community diversity
and assembly. Yet, available software for such analyses is often
idiosyncratic, requiring unique data formats or a particular platform
(but see Kembel et (11., 2010). Our aim here is to provide a
cross-platform package (SPACODIR) that can inform the processes
contributing to sorting of phylogenetic-, species- and trait diversities
among communities. To this end, we use the highly ﬂexible and
actively developed R environment (R Development Core Team,
2010), providing SPACODIR as an adaptation and extension of the
C-coded software SPACoDi (Spatial and Phylogenetic Analysis
of Community Diversity) developed by Hardy (2010). Here,
we describe the central functionality of the SPACODIR package.
SPACODIR is poised to study scale dependencies of diversity
partitioning in space and time. Fast computation for the most
demanding tasks is facilitated by compiled C-coded functions.

2 DESCRIPTION

Here, we adopt the statistical framework of Hardy and Senterre
(2007) in testing pattern deviation of diversity partitioning in

 

*To whom correspondence should be addressed.

communities from null expectations. Relevant measures of diversity
in SPACODIR concern species identity, evolutionary relatedness
and (or) trait similarity. The framework implements a variance-
decomposition approach of Rao’s (1982) quadratic entropy (QE),
which partitions total entropy into within- and among-sample
components. The measure of diversity can be explicitly phylogenetic
by considering the extent of coancestry shared by two organisms in
a community ecological sample. If evolutionary relatedness among
organisms within a subcommunity is quite high (i.e. all sampled
organisms descend from a recent ancestor), the subcommunity
would be said to exhibit little phylogenetic diversity (Cadotte et al.,
2010; Cavender-Bares et (11., 2009; Faith, 1992).

Hardy and Senterre (2007) use a spatial decomposition of pairwise
divergences among organisms—sampled from within and between
different subcommunities—to deﬁne a balance in diversity found
within versus between samples. Diversity in SPACODIR is thus
measured in two primary manners: one index considers species
composition (IST) and another considers evolutionary relatedness
(PST) within and among samples. These indices of diversity
partitioning, [ST and PST, estimate parameters ranging from 0 to
1 and respectively correspond to the average deﬁcit of species- and
phylogenetic diversity within versus among samples. IST signiﬁes
the extent to which the average likelihood of species identity for
two randomly drawn individuals in a local sample exceeds that at
the regional scale; PST expresses the local excess of phylogenetic
relatedness relative to the mean phylogenetic relatedness of species
pairs drawn from the regional sample (Hardy and Senterre, 2007;
Hardy and Jost, 2008). If phylogenetic structure among species
is completely lacking (i.e. as for a star phylogeny), PST, as a
generalized expression of the Gini—Simpson index of diversity
(Gini, 1912; Simpson, 1949), simply reduces to IST. Unlike similar
implementations of QE in community phylogenetics (e.g. see
Dray and Dufour, 2007; Kembel et al., 2010), we explicitly treat
community data as statistical samples for parameter estimation,
following Hardy and Jost (2008).

A key parameter of interest in community phylogenetics and
which we estimate in SPACODIR is how phylogenetic diversity
is partitioned among samples. Species occurrence data may be
given as presence—absence, individual abundances by species, or as
relative abundances. Insofar as PST involves a measure of species
diversity (the phylogenetic diversity of two samples drawn from the
same species is null), we can consider extracting the component
of PST explained solely by phylogeny. For this purpose, Hardy

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2437

112 /3.Io's[Bumo[pJOJXO'sonBurJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

J.M.Eastman et al.

 

its; OIOOItO
itt1'( wt

 

DIE-I

 

 

 

 

 

PST“ lsr" 0 PST~IST> 0 PST>IST> 0 lsT>P5T> 0
Plsr ~ 0 Ply ~ 0 Ply > 0 Ply < 0
BST~ 0 357 ~ 0 BST > 0 BST< 0

Fig. 1. Illustration of the partitioning of diversity in four situations (AiD).
Shown are four distinct conﬁgurations of species assemblages (labeled A-D
and enclosed by dashed boxes), where each is collection of four local
communities (represented by pie-charts) that comprise up to four species
(denoted by different grey tones). Evolutionary relationships of the species
are depicted in the phylogenetic tree at left. (A) All local communities
have the same species composition; there is no species turnover and hence
no phylogenetic turnover. (B) Local communities have different species
composition (species turnover) but species assemble by pairs irrespective
of their phylogenetic relationship (no phylogenetic turnover). (C) Same as B
except that the most related species assemble together (spatial phylogenetic
clustering). (D) Same as B except that the most related species do not
assemble together (spatial phylogenetic overdispersion). These situations can
be distinguished using the diversity partitioning indices in SPACODIR.

and Jost (2008) constructed the index BST, which isolates the
balance of evolutionary relatedness at local and regional scales from
PST. The BST index, then, is closely related to PST—IST. Where
BST > 0 or where PST > IST, distinct species within a local sample
are more related on average than distinct species from different
samples, a pattern referred to as spatial phylogenetic clustering (or
underdispersion; e. g. Fig. 1C). Alternatively, where BST < 0 or IST <
PST, distinct species within a local sample are less related on average
than distinct species from different samples; phylogenetic diversity
is thus spatially overdispersed (even) in distribution (e.g. Fig. 1D).
A fourth index, HST (Hardy and Senterre, 2007), is equivalent to
BST but considers presence—absence rather than relative abundances
of species within samples, thereby reducing the relative weight of
the most abundant species. (In SPACODIR, HST is termed ‘PIST’
owing to the difﬁculty displaying Greek letters.) Note that, as
BST, HST cannot be estimated when a community has fewer than
two species because the index considers only pairs of distinct
species (a typographical error in the formula given in Hardy and
Senterre (2007) is corrected in the R documentation of SPACODIR).
Signiﬁcant departures from zero for these estimators may be used
to inform processes of community assembly (Hardy and Senterre,
2007; Kembel et (11., 2010; Parmentier and Hardy, 2009), and several
permutation tests (see Hardy 2008) are available within the software.
SPACODIR provides the capability to compute each of these four
indices at the global scale (i.e. considering all data) as well as for all
pairwise comparisons between samples. Partial tree-randomization
tests allow investigators to discern whether non-random patterns of
structuring exhibit temporal- or lineage dependency (see Hardy and
Senterre, 2007).

Direct assessment of spatial structuring of trait diversity may
be essential to distinguishing neutral from non-neutral processes
of assembly. We note that estimation of PST, BST and HST need
not only involve phylogenetic distances also but is amenable to
applications involving phenotypic dissimilarities between species.

Indeed, QE can be appropriately used for all dissimilarity matrices
constructed from ultrametric distances between species (Pavoine
et (11., 2005). Structuring of phylogenetic diversity is often used as a
surrogate to make inferences concerning trait-based assembly, where
hypotheses for which traits are assembly relevant are absent. In
essence, the phylogeny expresses the expected covariance structure
among species for an idealized phenotype (see Felsenstein, 1973).
Spatial clustering of phylogenetic diversity is often interpreted
as evidence for local environmental ﬁltering of (these idealized
and unknown) traits (e.g. Cavender—Bares et (11., 2009; Ives and
Helmus, 2010). The contrast between structuring of phylogenetic
and phenotypic diversities should provide substantial new insights
into non-neutral evolutionary and assembly processes.

Beyond constructing tests to determine whether diversity
partitioning departs signiﬁcantly from null expectations, SPACODIR
can be readily applied to formal tests of which environmental or
spatial correlates provide signiﬁcant explanations of the indices of
diversity partitioning. We refer readers elsewhere for examples of
such tests (see Hardy and Senterre, 2007; Hardy, 2008).

Funding: F.R.S.-FNRS F.4.519.10.F to O.J.H.; BRIDGE
(programme Biodiversite of the Agence Nationale de la Recherche,
France to C.E.T.P. and O.J.H.).

Conﬂict of Interest: none declared.

REFERENCES

Cadotte,M.W. et al. (2010) Phylogenetic diversity metrics for ecological
communities:integrating species richness, abundance and evolutionary history.
Ecol. Lett., 13, 967105.

Cavender—Bares,J. et al. (2009) The merging of community ecology and phylogenetic
biology. Ecol. Lett., 12, 6934715.

Dray,S. and Dufour,A.B. (2007) The ade4 package: implementing the duality diagram
for ecologists. J. Stat. Softw., 22, 1420.

Faith,D.P. (1992) Conservation evaluation and phylogenetic diversity. Biol. Conserv.,
61, 1410.

Felsenstein,]. (1973) Maximum likelihood estimation of evolutionary trees from
continuous characters. Am. J. Hum. Genet, 25, 471492.

Gini,C. (1912) Variabilité matabilité (Variability and Matability). C. Cuppini, Bologna.

Hardy,O.J. (2008) Testing the spatial phylogenetic structure of local communities:
statistical performances of different null models and test statistics on a locally
neutral community. J. Ecol., 96, 9144926.

Hardy,O.J. (2010) SPACoDi 0.10: a program for Spatial & Phylogenetic Analysis of
Community Diversity. Available at http://ebe.ulb.ac.be/ebe/Software.html.

Hardy,O.J. and Jost,L. (2008) Interpreting and estimating measures of community
phylogenetic structuring. J. Ecol., 96, 8494852.

Hardy,O.J. and Senterre,B. (2007) Characterizing the phylogenetic structure of
communities by an additive partitioning of phylogenetic diversity. J. Ecol., 95,
4937506.

Ives,A.R. and Helmus,M.R. (2010) Phylogenetic metrics of community similarity. Am.
Nat., 176, E1284E142.

Kembel,S.W. et al. (2010). Picante: R tools for integrating phylogenies and ecology.
Bioinformatics 26, 146371464.

Parmentier,l. and Hardy,O.J. (2009) The impact of ecological differentiation and
dispersal limitation on species turnover and phylogenetic structure of inselbergs
plant communities. Ecography, 32, 6134622.

Rao,C.R. (1982) Diversity and dissimilarity coefﬁcients: a uniﬁed approach. Theor
Popal. Biol, 21, 2443.

R Development Core Team (2009) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Simpson,E.H. (1949) Measurement of diversity. Nature, 163, 688$88.

Webb,C.O. et al. (2002) Phylogenies and community ecology. Anna. Rev. Ecol. Syst.,
33, 4757505.

 

2438

112 /3.Io's[BumoprOJXO'soneurJOJurorq”:duq wort papeolumoq

91oz ‘Og anﬁnv uo ::

