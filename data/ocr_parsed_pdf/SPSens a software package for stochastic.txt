BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

SPSens

 

Infinitesimal Finite
perturbation perturbation

Fm

GLR RPD IRN CRN CRP CFD

 

 

Fig. 1. Monte Carlo stochastic parameter sensitivity algorithms included
in SPSens

For MC methods, a sensitivity estimator, denoted Z, is constructed
and computed via stochastic simulation. A large number of samples (N)
of the estimator are simulated, and the sample average, 2]- := 1 Z3”),
is then taken as the sensitivity estimate. Its accuracy can be assessed by
taking into account its bias (when present) and by constructing conﬁdence
intervals of the point sensitivity estimate in terms of the sample variance.
Estimators with no or little bias and low variance are thus desired for
the most accurate estimates. Several different sensitivity estimators
have been proposed, each differing in its bias and variance properties.

Finite difference (FD) estimators are among the most straightforward
and generally applicable estimators. FD estimates are computed by ﬁrst
simulating the system at a nominal parameter set and then at a parameter
set perturbed by a small but ﬁnite amount and then taking the FD quo-
tient. The resulting estimate given by the sample average of many FD
quotient samples has a bias that depends on the particular discretization
scheme implemented. The variance of the estimates depends on how the
samples are generated. A direct approach is to generate samples using
independent and identically distributed random numbers (IRN), but this
estimate often has high variance and requires many samples. This vari-
ance can be reduced signiﬁcantly by instead generating samples that are
correlated in an appropriate manner. Using common random numbers
(CRN) can reduce variance signiﬁcantly to increase efﬁciency. Although
this approach combined with the direct method SSA (Gillespie, 1977) can
be easily applied to reduce variance considerably, further gains in efﬁ-
ciency can be achieved by using the common reaction path (CRP) method
(Rathinam et al., 2010). CRP implements CRN with an SSA based on the
random time change representation of Markov processes to reduce vari-
ance signiﬁcantly. Another approach is the coupled ﬁnite difference
(CFD) method (Anderson, 2012), which simultaneously simulates
coupled processes for each parameter set to yield a FD estimate with
highly desirable variance properties in many situations, especially when
considering larger time intervals.

Other approaches directly consider inﬁnitesimal perturbations to the
parameters to obtain the estimate. One such method, the Girsanov like-
lihood ratio (GLR), was ﬁrst introduced in the context of stochastic
chemical kinetics in (Plyasunov and Arkin, 2007). This method derives
numerically tractable weighting coefﬁcients using the Girsanov measure
transformation that can be computed during simulation to give an
unbiased sensitivity estimate. GLR, although unbiased, often has high
variance and can be inefﬁcient in some situations. The Regularized
Pathwise Derivative (RPD) method is an alternative approach that con-
siders a close regularization of the original problem and computes the
derivatives for each sample path to estimate the sensitivities (Sheppard
et al., 2012). RPD estimates are often signiﬁcantly more efﬁcient than the
other methods, with variance reduction of over 10 orders of magnitude
demonstrated for certain problems.

A brief numerical comparison of these methods using example stochas-
tic biochemical networks is provided in the Supplementary Material.

2.2 Implementation

SPSens implements the sensitivity algorithms summarized in Figure 1 in
C and requires no external libraries outside the standard distributions. To
run the program, the biochemical network of interest is ﬁrst deﬁned in a

C source ﬁle by specifying the species, reactions and parameters, and
additionally the partial derivatives of the propensity functions with re-
spect to system parameters if GLR or RPD are desired. Several examples
are provided with the SPSens distribution and can be easily modiﬁed for
user-deﬁned networks.

Once the problem is deﬁned, the code is compiled to build an execut-
able program that can be run from the command line or using a scripting
language. The sensitivity analysis algorithm can be speciﬁed within the
problem ﬁle or at run-time by setting the appropriate command line ﬂag.
The sampling times, parameters and initial conditions can also be speci-
ﬁed via command-line, permitting sensitivity analysis to be performed for
a variety of conditions without the need to recompile any code.

The methods using common random numbers (CRP, CRN) require
special handling of the pseudo random numbers driving the SSA.
Random number generation is therefore handled using the RngStream
package (L’Ecuyer et al., 2002). The package supports parallel random
number generation streams of long period, which are quite useful for
ensuring proper synchronization of random numbers and independence
of parallel streams.

2.3 Other features

In addition to sensitivity analysis programs, SPSens includes exact SSA
that can be used to generate individual sample paths or ensembles of
trajectories using the identical model deﬁnition. The command line sen-
sitivity analysis and simulation programs are also implemented using the
Message Passing Interface (MPI), permitting the programs to be run in
parallel on a grid or on multi-core personal computers.

SPSens includes the option to perform sensitivity analysis or simula-
tion using antithetic sampling (AS). AS is a widely used variance reduction
technique that in many cases induces negative correlation in samples to
produce estimates with tighter conﬁdence intervals. AS is easily incorpo-
rated with all algorithms in SPSens by setting a single ﬂag from the
command line. It should be noted, however, that variance reduction
with AS is typically modest and that variance reduction is not guaranteed
in general, so AS should be used keeping this in mind.

Finally, source code allowing SPSens C-code to be compiled and run
from MATLAB using the MEX interface are included with SPSens. An
example m-ﬁle script is included to demonstrate how to build and call the
programs from within MATLAB.

Much more detailed information can be found in the User Guide
provided with the SPSens distribution.

3 CONCLUSION

SPSens is a freely available and easy to use software package that
implements efﬁcient methods for parameter sensitivity analysis
of discrete stochastic biochemical reaction networks. SPSens
allows users to quickly and easily switch between algorithms to
ﬁnd the most efﬁcient method for their particular problem.

In general it is impossible to say which algorithm is best for a
given problem, as the performance of each method depends on a
number of factors. However there are some general guidelines
that can be followed in practice. GLR is the only unbiased
method, but it is often very inefﬁcient and requires signiﬁcant
computational effort to produce accurate results. The FD meth—
ods with IRN and CRN are signiﬁcantly less efﬁcient than the
CFD and CRP methods in most situations and are provided
mainly for demonstration purposes. The RPD method is ex—
tremely efﬁcient for a wide variety of problems when applicable,
but requires judicious choice of the regularization parameter for
efﬁcient performance. Which of the three highly efﬁcient meth—
ods (RPD, CFD and CRP) is most efficient will depend on the

 

141

ﬁm'spzumol‘pmﬂo'soptzuuopnoiq/ﬁdnq

P. W.Sheppard et al.

 

problem, however. Example results computed with SPSens and a
more detailed discussion of these matters is provided in the
Supplementary Material.

Funding: M.K. acknowledges research funding from the
National Science Foundation through Grant ECCS—0835847
and from the Human Frontier Science Program Grant
RGP0061/2011.

Conﬂict of Interest: none declared.

REFERENCES

Anderson,D. (2012) An efﬁcient ﬁnite difference method for parameter sensitivities
of continuous time markov chains. SIAM J. Numer. Anal, 50, 223772258.

Gillespie,D. (1976) A general method for numerically simulating the
stochastic time evolution of coupled chemical reactions. J. Comput. Phys, 22,
4037434.

Gillespie,D. (1977) Exact stochastic simulation of coupled chemical reactions.
J. Phys Chem., 81, 234(F236l.

Komorowski,M. et a]. (2012) StochsensiMATLAB package for sensitivity analysis
of stochastic chemical systems. Bioiiy’ormuties, 28, 7317733.

L’Ecuyer,P. et a]. (2002) An object—oriented random—number package with many
long streams and substreams. Oper. Res, 50, 107%1075.

Plyasunov,S. and Arkin,A. (2007) Efﬁcient stochastic sensitivity analysis of discrete
event systems. J. Comput. Phys, 221, 7247738.

Rathinam,M. et a]. (2010) Efficient computation of parameter sensitivities
of discrete stochastic chemical reaction networks. J. Chem. Phys, 132,
034103.

Sheppard,P. et a]. (2012) A pathwise derivative approach to the computation of
parameter sensitivities in discrete stochastic chemical systems. J. Chem. Phys,
136, 34115.

 

142

/810'sleum0fp103x0"53112131031110qu:duq

