APPLICATIONS NOTE V°" 225%.ligi‘iéiéiféiiZSEE/ﬁiél

 

Sequence analysis

Advance Access publication June 17, 2014

DAFGA: diversity analysis of functional gene amplicons

Yongkyu Kim* and Werner Liesack

Department of Biogeochemistry, Max Planck Institute for Terrestrial Microbiology. 35043 Marburg, Germany

Associate Editor: John Hancock

 

ABSTRACT

Summary: Diversity analysis of functional marker genes provides
physiological insights into microbial guilds that perform an ecologically
relevant process. However, it is challenging to group functional gene
sequences to valid taxonomic units, primarily because of differences
in the evolutionary rates of individual genes and possible horizontal
gene transfer events. We developed a python script package named
DAFGA, which estimates the evolutionary rate of a particular functional
gene in a standardized manner by relating its sequence divergence to
that of the 168 rRNA gene. As a result, DAFGA provides gene-speciﬁc
parameter sets for operational taxonomic unit clustering and taxo-
nomic assignment at desired rank, and it can be implemented into
the diversity measurements offered by QIIME.

Availability and implementation: DAFGA is freely available with a
manual and test data from https://github.com/outbig/DAFGA.
Contact: yongkyu.kim@mpi-marburg.mpg.de

Received on April 14, 2014; revised on May 22, 2014; accepted on
June 11, 2014

1 INTRODUCTION

Microbes are the most abundant and most diverse organisms on
earth playing crucial roles in ecosystem functioning. Massively
parallel sequencing of 168 rRNA genes allows us to explore the
phylogenetic diversity and taxonomic composition of microbial
communities in any environment (e.g. Serkebaeva et al., 2013).
Contrary to the 168 rRNA gene, genes encoding key catalytic
enzymes deﬁne particular functional guilds that perform eco-
logically relevant functions, e.g. methane-oxidizing bacteria
(pmoA) and nitrogen-ﬁxing bacteria (m‘fH). Exploring the preva-
lence and diversity of these protein-coding genes can help iden-
tify novel lineages of particular functional guilds as well as
physiologically differentiate closely related phylotypes.
Similarity of tree topology with that of the 168 rRNA gene
should reveal the potential of a functional gene to be used as a
phylogenetic marker (Case et al., 2007). Protein-coding genes,
however, evolve faster than the 168 rRNA gene, and at varying
rates. There are considerable variations in the evolutionary rates
(ERs), even among individual genes present in the same genome
(Du et al., 2013). Use of arbitrary threshold values for clustering
functional gene amplicons into operational taxonomic units
(OTUs) could lead to incorrect estimates of microbial diversity
within functional guilds. Therefore, computational tools for
functional gene amplicon analysis have to take into account
the ER of a targeted gene. Because variations in ER result pri-
marily from changes in the protein sequence itself rather than

 

*To whom correspondence should be addressed.

from external factors such as changing environment or lifestyle
(Bedford et al., 2008), the ER of individual genes can be mea-
sured in relation to that of 168 rRNA genes (Degelmann et al.,
2010). DAFGA compares the sequence divergence of functional
genes with that of 168 rRNA genes obtained from the same
source organisms. It then extrapolates the sequence identity
thresholds that deﬁne different taxonomic ranks and use them
for OTU clustering and taxonomic assignment to the lowest rank
possible.

2 FEATURES AND METHODS

2.1 Reference database and correlation plots

DAFGA parses the publicly available sequences of a functional
gene, which are retrieved from the NCBI protein database in
genpept format. It excludes all the environmental sequences lack-
ing taxonomic information and subsequently constructs the ref-
erence database to be used for taxonomic assignment. DAFGA
retrieves the full taxonomic lineage of each reference sequence
from the NCBI taxon ID, and fetches near full-length l6S rRNA
gene sequences (120(kl600 bp in length) of the source organisms
from the NCBI nucleotide database, but only from those organ-
isms that were identiﬁed at strain level. The pairs of functional
and 168 rRNA gene sequences are used to compute the ER of
the functional gene in relation to that of its 168 rRNA gene by
pairwise alignments between all the strain-level source organisms
using the EMBOSS SmithiWaterman alignment tool (Goujon
et al., 2010). The identity thresholds of a functional gene that
correspond to different taxonomic ranks are deduced from a
linear regression curve of identity scores in sequence alignments
and used for OTU clustering and taxonomic assignment.
Alternatively, similarity scores can be used to taxonomically
assign OTUs (Fig. l).

2.2 OTU clustering of functional gene amplicons

Insertion and deletion errors in next-generation sequencing (e. g.
454 pyrosequencing and Ion Torrent semiconductor sequencing)
can often cause a shift in reading frame during translation,
thereby inﬂating diversity of functional gene sequences. To over-
come this problem, DAFGA uses a two-step procedure for OTU
clustering. Amplicon reads, which passed user-deﬁned quality-
filtering, are preclustered into OTUs deﬁned by high nucleotide
sequence identity (>97%), using USEARCH (Edgar, 2010).
A consensus sequence of each OTU is generated from multiple
sequence alignment and selected to represent the preclustered
OTU. The translated consensus sequences are subjected to
final OTU clustering using the gene-dependent sequence identity
threshold that corresponds to the desired taxonomic rank.

 

2820 © The Author 2014. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1nofp10}x0"sotwurJOJutotq/ﬁduq 11101} pQPBOIHAAOG

91oz ‘Og anﬁnV uo ::

DAFGA

 

A [1] Reference database and correlation plots
- dal'ga_rel1)B.pyexcludes environmental sequences and constructs the rel'erence
database.
- dafga_corre1ation.py creates the correlation plot between functional and 165
rRNA gene sequence divergence and determines identin and similarity thresholds
corresponding to dilt'erent taxonomic ranks.

[2] OTU clustering of functional gene amplicons
- dafga_ottts.py clusters amplicons into O'l'Us by tare—clustering at the nucleotide

level followed by final clustering using the translated consensus sequences of the
Tire-clustered O'I'Us.

[3] Taxonomic assignment and phlogenetic tree

- dafga_tamnnmy.p_v takes into account alignment scores and lengths to assign
valid taxonomy at the lowest rank possible and constructs a phylogenetic tree ot‘the
representative sequences.

[4] Diversity analysis using QIIME or Mothur

 

   
 

 

 

a g Inc
3-.
:t‘
E 90
ill
.12
‘5: so
.L“
I—
2 r,
 70
In y: 1.80x— 87.48 .
3 so it” “(JFJH r,
E, e-vaiuc = urine—rm '
:t ‘. 
3 SD Stalk” {101.381
I11
2 
no
3 y=|.|6x-18.48  :-
E R3 (1.??82 '
E 3'0 P-vrriin.’ =fJ.I’NJe—UU
'g StdEr-r -— 1?.(NJ48
3
'4- "20 30 40 so so to an 90 me

165 rRNA gene sequence identity 1%:-

Fig. 1. Workﬂow of DAFGA (A) and correlation plot of pmoA and 16S
rRNA gene sequence divergence (B). The pmoA gene was selected as a
representative example. pmoA reference sequences deposited in FunGene
(http://fungene.cme.msu.edu/) were obtained in genpept format from
NCBI non-redundant protein database. Similarity and identity values
of protein sequence alignments were plotted in green and blue, respect-
ively. Dashed red line is a linear regression curve of, respectively, simi-
larity and identity of pmoA over 16S rRNA gene sequence identity

Centroid sequences are selected to represent each final OTU and
used for both taxonomic assignment and phylogenetic tree con-
struction. The OTU mapping ﬁle is generated by merging
preclustering and clustering output. When examined with
pmoA test amplicon data (Liike and Frenzel, 2011), this two-
step clustering reduced the number of OTUs as compared with
a single-step approach based on translated amino acid sequences.
In particular, singleton OTUs signiﬁcantly declined.

2.3 Taxonomic assignment and phylogenetic tree

The number of functional gene sequences that are available for
the construction of reference databases is limited and biased to-
ward taxa characterized by sequenced genomes. For instance,
dependent on the functional marker gene, the number of
sequences deposited in FunGene ranges from 100 to maximum
77 876 (including environmental sequences), while >3 million 16S
rRNA sequences are available (Fish et a], 2013). In similarity-
based taxonomic classiﬁcation of functional gene sequences, lack
of homologues at low taxonomic ranks, such as genus or species,
can often lead to incorrect classiﬁcation due to high sequence
divergence with the most homologous sequence. For instance, a

statistically signiﬁcant alignment (E-Value< le-10) shows 40%
amino acid identity between environmental sequence and the
reference sequence of a particular species. This explicitly indi-
cates that the environmental sequence is derived not from the
same species but from another species, so that the relationship is
validly recognized only on a higher taxonomic level such as, for
example, family or order level. Therefore, DAFGA takes into
account the query coverage and the absolute identity or similar-
ity scores in alignment with the best homologues, and performs
assignment at the most likely taxonomic rank by referring to the
correlation plot between the functional and 16S rRNA gene se-
quences. It creates an OTU table with taxonomic information
and a phylogenetic tree of representative sequences. These out-
puts can be used as input files for various diversity measurements
in QIIME (Caporaso et a], 2010) or Mothur (Schloss et a],
2009).

3 CONCLUSION

The most critical step in the diversity analysis of functional
marker genes and rRNA genes is to cluster taxonomically homo-
geneous sequences into valid OTUs. DAFGA offers a standar-
dized procedure to determine the ER of functional genes in
relation to that of the 16S rRNA gene, and it provides sequence
identity thresholds that correspond to different taxonomic ranks.
As such, DAFGA allows for the automated cluster analysis and
taxonomic categorization of environmental sequence data and
provides a computational means to evaluate the potential of
a functional gene as a phylogenetic marker.

Funding: Yongkyu Kim received a postdoctoral fellowship of
the Max Planck Society. The project was supported by the
Deutsche Forschungsgemeinschaft (collaborative research
center SFB 987).

Conﬂict of Interest: None declared.

REFERENCES

Bedford,T. et a]. (2008) Overdispersion of the molecular clock varies between yeast,
Drosophila and mammals. Genetics, 179, 9777984.

Caporaso,J.G. et a]. (2010) QIIME allows analysis of high—throughput community
sequencing data. Nat. Methods, 7, 3357336.

Case,R.J. et a]. (2007) Use of 16S rRNA and rpoB genes as molecular markers for
microbial ecology studies. App]. Environ. Microbio]., 73, 2787288.

Luke,C. and Frenzel,P. (2011) Potential of pmoA amplicon pyrosequencing for
methanotroph diversity studies. App]. Environ. Microbio]., 77, 6305$309.

Degelmann,D.M. et a]. (2010) Different atmospheric methane—oxidizing commu—
nities in European beech and Norway spruce soils. App]. Environ. Microbio].,
76, 322&3235.

Du,X. et a]. (2013) Why does a protein’s evolutionary rate vary over time? Genome
Bio]. Evo]., 5, 494e503.

Edgar,R.C. (2010) Search and clustering orders of magnitude faster than BLAST.
Bioinformatics, 26, 246%2461.

Fish,J.A. et a]. (2013) FunGene: the functional gene pipeline and repository. Front.
Microbio]., 4, 1714.

Goujon,M. et a]. (2010) A new bioinformatics analysis tools framework at EMBL—
EBI. Nucleic Acids Res., 38, W69$W699.

Serkebaeva,Y.M. et a]. (2013) Pyrosequencing—based assessment of the Bacteria
diversity in surface and subsurface peat layers of a northern wetland, with
focus on poorly studied phyla and candidate divisions. PLoS One, 8, e63994.

Schloss,P.D. et a]. (2009) Introducing mothur: open—source, platform—independent,
communityisupported software for describing and comparing microbial com—
munities. App]. Environ. Microbio]., 75, 753777541.

 

2821

112 /310'spzu.mofp.to;xo"sotwuuoiutotq/ﬁduq 11101} popcorn/nag

9103 ‘Og isnﬁnV uo ::

