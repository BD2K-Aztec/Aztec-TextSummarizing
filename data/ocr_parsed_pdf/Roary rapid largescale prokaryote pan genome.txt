Bioinformatics, 31 (22), 2015, 3691—3693

doi: 10.1093/bioinformatics/btv421

Advance Access Publication Date: 20 July 2015
Applications Note

 

Sequence analysis

Roary: rapid large-scale prokaryote pan genome
analysis

Andrew J. Page1'*, Carla A. Cummins1, Martin Hunt1,
Vanessa K. Wong1'2, Sandra Reuterz, Matthew T.G. Holden3,
Maria Fookes1, Daniel Falush4, Jacqueline A. Keane1 and Julian Parkhill1

1Pathogen Genomics, The Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Hinxton, Cambridge,
2Department of Medicine, University of Cambridge, Cambridge, 3School of Medicine, University of St. Andrews,
North Haugh, St Andrews and 4College of Medicine, Swansea University, Swansea, UK

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on May 14,2015; revised on June 26,2015; accepted on July 14, 2015

Abstract

Summary: A typical prokaryote population sequencing study can now consist of hundreds or
thousands of isolates. lnterrogating these datasets can provide detailed insights into the genetic
structure of prokaryotic genomes. We introduce Roary, a tool that rapidly builds large—scale pan
genomes, identifying the core and accessory genes. Roary makes construction of the pan genome
of thousands of prokaryote samples possible on a standard desktop without compromising on the
accuracy of results. Using a single CPU Roary can produce a pan genome consisting of 1000 iso—

 

lates in 4.5 hours using 13 GB of RAM, with further speedups possible using multiple processors.
Availability and implementation: Roary is implemented in Perl and is freely available under an
open source GPLV3 license from http://sanger—pathogens.github.io/R0ary

Contact: roa ry@sa nger.ac. uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The term microbial pan genome was first used in 2005 (Medini
et (11., 2005) to describe the union of genes shared by genomes of
interest (Vernikos et (11., 2014). Since then, availability of micro-
bial sequencing data has grown exponentially. Aligning whole-
genome-sequenced isolates to a single reference genome can fail to
incorporate non-reference sequences. By using (16 1101/0 assemblies,
non-reference sequences can also be analyzed. Microbial organisms
can rapidly acquire genes from other organisms that can increase
virulence or promote antimicrobial drug resistance (Medini et (11.,
2005). Gaining a better picture of the conserved genes of an organ-
ism, and the accessory genome, can lead to a better understanding of
key processes such as selection and evolution.

The construction of a pan genome is NP-hard (Nguyen et (11.,
2014) with additional difficulties from real data due to contamin-
ation, fragmented assemblies and poor annotation. Therefore, any
approach must employ heuristics to produce a pan genome

(63 The Author 2015. Published by Oxford University Press.

(reviewed in Vernikos et a1. 2014). The most complete standalone
pan genome tools are PanOCT (Fouts et (11., 2012), which uses a
conserved gene neighborhood in addition to homology to accurately
place proteins into orthologous clusters; LS-BSR (Sahl et (11., 2014)
which uses a preclustering step before running BLAST to rapidly as-
sign genes to families and PGAP which takes annotated assemblies,
performs an all-against-all BLAST, clusters the results and produces
a pan genome (Zhao et (11., 2012).

PanOCT and PGAP require an all-against-all comparison using
BLAST, with the running time growing approximately quadratically
with the size of input data and are computationally infeasible with
large datasets. They also have quadratic memory requirements,
quickly exceeding the RAM available in high performance servers
for large datasets. LS-BSR introduces a pre-clustering step that
makes it an order of magnitude faster than PGAP; however, it is less
sensitive (Sahl et (11., 2014). We have developed a method to gener-
ate the pan genome of a set of related prokaryotic isolates. It works

3691

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicehses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Supplementar) Figs 51—58
Supplementar) Figs 51—58
Table 2

Stein, 2013
Seemann, 2014

Supplementar) Figures

Lu (7/ 17]., 2012

Application

150000 - + LS—BSR

Enright '1“ PanOCT
(7/ 17]., 2002 _._ PGAP
-l- Roary

E
G.)
E
|_
E
E

Supplementar)
1\4aterial
r

50 160 150 200
No. of Samples

 

Table 1

/310'sreu1nofp103xo"sorwuuoqurorqﬂ:duq

Roary

3693

 

shown in Supplementary Figs S11 and S12, with Roary achieving a
speedup of 3.7X using 8 CPUs and GNU Parallel (Tang, 2011).

4 Discussion

We have shown that Roary can construct the pan genomes of large col—
lections of bacterial genomes using a desktop computer, where it was
not previously computationally possible with other methods. Further
speedups in running time are possible by providing more processors to
Roary. On simulated data, Roary is the only application to correctly
identify all clusters. This increased accuracy comes from using the con—
text provided by conserved gene neighborhood information. Roary
scales well on large real datasets, identifying large numbers of core
genes, even in the presence of a varied open pan genome.

Acknowledgement

The authors thank Torsten Seemann, Geoff Winsor and Marco Galardini for
their helpful advice and contributions.

Fu ndi ng
This work was supported by the Wellcome Trust (grant WT 098051).

Conﬂict of Interest: none declared.

References

Enright,A.]. et al. (2002) An efﬁcient algorithm for large—scale detection of
protein families. Nucleic Acids Res., 30, 1575—1584.

Fouts,D.E. et al. (2012) PanOCT: automated clustering of orthologs
using conserved gene neighborhood for pan-genomic analysis of
bacterial strains and closely related species. Nucleic Acids Res., 40, e172.

Fu,L. et al. (2012) CD-HIT: accelerated for clustering the next-generation
sequencing data. Bioinformatics, 28, 3150—3152.

Medini,D. et al. (2005) The microbial pan-genome. Curr. Opin. Genet. Deu,
15, 5 89—5 94.

Nguyen,N. et al. (2014) Building a pangenome reference for a population. In:
Sharan,R. (ed.) Research in Computational Molecular Biology, Springer
International Publishing, pp. 207—221 .

Sahl, J. et al. (2014) The large-scale blast score ratio (LS-BSR) pipeline: a
method to rapidly compare genetic content between bacterial genomes.
Peer], 2, e332.

Seemann,T. (2014) Prokka: rapid prokaryotic genome annotation.
Bioinformatics, 30, 2068—2069.

Stein,L. (2013) Generic feature format version 3 (GFF3). Seq. Ontol. Pro/.,
1.21.

Tang,O. (2011) GNU parallel—the command-line power t001.;10gin: The
USENIX Magazine, 36, 42—47.

Vernikos,G. et al. (2014) Ten years of pan-genome analyses. Curr. Opin.
Microbiol, 23C, 148—154.

Zha0,Y. et al. (2012) PGAP: pan-genomes analysis pipeline. Bioinformatics,
28, 416—418.

/810's113um0_fp103x0"sarJBmJOJurorq/ﬁdnq

