BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

HapMuC

 

were then computed by using proﬁle hidden Markov models
(proﬁle HMM; Albers et al., 2011; Eddy, 1998). Next, we
inferred the haplotype frequencies and calculated the marginal
likelihoods by using a variational Bayesian algorithm (Beal,
2003; Blei et al., 2003). Finally, we derived a Bayes factor
(BF), which is the ratio of the marginal likelihoods of these
two models, to evaluate the possibility of the presence of somatic
mutations.

We ﬁrst demonstrated the effectiveness of HapMuC in a simula—
tion study. Second, we also conﬁrmed its efﬁciency based on a real
sequence dataset obtained from breast cancer cell line samples,
which forms part of the The Cancer Genome Atlas (TCGA) Muta—
tion Calling Benchmark 4 datasets. Third, we tested HapMuC in
the context of a whole genome using the TCGA datasets, and the
analysis suggested that our algorithm performed better than the
existing methods, including VarScan 2, SomaticSniper, Strelka
and MuTect. In addition, we conﬁrmed that the sensitivity of our
algorithm was superior or comparable with the existing methods
using the COLD—829 dataset with its list of validated somatic mu—
tations (Pleasance et al., 2010). Finally, we discuss limitations and
propose future research directions for accurate mutation calling.

2 METHODS
2.1 Bayesian latent Dirichlet models

We constructed a generative model of observed reads. Suppose that X
is an observed read and generated from one of four haplotypes. Let 2,7 be
an indicator variable that is equal to 1 if the ith read X,- was generated
from the jth haplotype or, alternatively, is equal to 0 if X,- was generated
from other haplotypes. We also deﬁne z,- as the ith row of Z. A likeli-
hood of the vector of reads x is formulated by a conditional dens-
ity p(x|Z), where Z is a haplotype matrix whose (i, j)th element is 2,).
Fixing the haplotype matrix Z, we can compute the value of the like-
lihood by a proﬁle HMM (Albers et al., 2011). The proﬁle HMM
formulates alignment probabilities of a read given a reference haplo-
type, considering mapping qualities, base qualities and homopolymer
length:

17(Xiv Xi, 111ij 0),

 

A

O heterozygous SNP
haplotype 1

Y candidate mutation

 

 

 

haplotype 2 —O—

B C

haplotype 1 haplotype 1

haplotype 2 —O—
haplotype 3 —'—

haplotype 4 —O—'—

Fig. 1. Possible types of haplotypes around a candidate mutation.
(A) Normal haplotypes around a heterozygous germ line variant.
Under the assumption that a somatic mutation occurs within one of
two normal haplotypes, haplotype 3 was generated by mutating
the ﬁrst or second haplotype. (B) Haplotype l was mutated, yielding
haplotype 3. (C) Mutated haplotype 2 yields haplotype 3. In both
cases, haplotype 4 was generated only by sequencing errors

haplotype 2 —O—

haplotype 3 —.—'—
haplotype 4 —'—

where X,- is a hidden variable for alignment states, I,- is a hidden variable
for insertion states and 0 represents the proﬁle HMM model parameters.
Albers et al. also provided a Viterbi algorithm to infer the maximum-
likelihood alignment efﬁciently:
(X, 1,») = argmaxp(x,», Xi, IilHj. 0).
x;.1,-

We used their modeling and algorithm to infer the probability of

observing a short read given a reference haplotype, that is,

17(Xilzi 5 Zij = 1) :p(Xi|Hj) =17(Xi~ Xi, it’lij 0)

In addition, when read-pair information is available, we approximate
the likelihood by multiplying the likelihoods of the ﬁrst read and the
second read, as a paired-read is considered to arise from the same
haplotype.

The haplotype matrix is, however, usually unknown, and we regard the
elements in Z as latent variables that follow a multinomial distribution

with density:
p(Z|7T)=| || Inf-‘7,
i 1'

where 77 is a vector of haplotype frequencies.

In this article, we also aimed to use information of a heterozygous
germ line variant located near a candidate somatic mutation. Here,
we focus on a candidate somatic mutation, which is located near a
heterozygous germ line mutation. Therefore, around the targeted
candidate mutation, there are two normal haplotypes, as shown in
Figure 1. We should note that because we assume that a somatic muta-
tion occurs independently on one of two normal haplotypes, the fourth
haplotype is not observed in the ideal case, i.e. 714 =0 and
71-:(711, 712, 713)’. However, in practice, the observed reads contain
sequencing errors; thus, to achieve robust statistical inference, we added
a variable a for representing haplotype error, which achieves an extension
of p(Z | 77) to p(Z|77, 8). Because tumor and normal samples have different
haplotypes, it is necessary to construct statistical models of p(Z|77, a) in
tumor and normal samples, separately. The concrete modelings are
shown in later sections.

Because the haplotype frequencies, 77, are also parameters, we built a
Bayesian hierarchical structure as p(77|a), using Dirichlet distribution
with a parameter vector (1. We also assumed that the haplotype error,
8, follows the beta distribution, p(a|y), with parameter 7/.

Using the probabilistic distributions described above, we define the
decomposition of the joint distribution of the form:

17(X~ Z, 77’ Slaw 7) =P(x|Z)P(Zl7T~ 8)17(7T|a)17(8|7)- (1)

In our case, there are two types of sequencing data: one is from a tumor
sample, denoted by xT, and the other is from a matched normal sample,
xN. Therefore, the haplotype matrix Z and the vector of haplotype fre-
quencies 77 should be considered for each of tumor (T) and normal (N)
tissue. Hence, the joint distribution is extended to

17(Xv Zlan aTv ‘1’) =17(wa ZNv 7TN~ (9|an 70170573 Zr, 77% Elan 7’)17(8|‘Y)~

where X=(xN, xT) and Z=(ZN, ZT, 7m, 717, a). We can decompose
p(xN, ZN, 7m, alaN, y) and p(xT, ZT, 77f, alaT, y) by the same way as
Equation (1). A key concept in our method involves the model-
ings of p(Z|77,a) in tumor and normal tissues and is described in
the following sections.

2.2 Modeling of sequencing data from a normal sample

First, we consider modeling of sequencing data of a normal sample.
Because a normal sample contains two haplotypes, the frequencies of
these haplotypes can be represented by one parameter TIN, and the
third and fourth haplotypes can be regarded as the noise generated

 

3303

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

N.Usuyama et al.

 

from the ﬁrst and second haplotypes, respectively. Therefore, for haplo-
type matrix ZN, p(ZN|JTN, a) is modeled by

NN
17(ZNIJTN, 8) = HMM] _ 8)}ZNII

[=1

-{(l — ma — 8W «Maw-3 . {(1 _ MW...

where NN is the number of normal reads. Because the haplotype fre-
quency of a normal sample can be represented by a scalar parameter
TIN, p(JTN|aN) yields the density of beta distribution.

2.3 Modeling of sequencing data from a tumor sample

As mentioned above, as we assumed that one of two haplotypes
is mutated in the tumor sample, the fourth haplotype does not exist
in the ideal situation. Let the ﬁrst haplotype be the mutated haplotype.
The fourth haplotype is then produced by the second haplotype
with error rate a; the haplotype frequencies of the second and
fourth haplotypes are nn - (l — a) and NH - a, respectively. Therefore,
we obtain

NT
pawn, a)= 1—121? - {ma — or” - «warm.
i=1

where NT is the number of tumor reads and 777-:(717-1, NH, 71“) with
717'] + NH + 717-3 = l. The haplotype frequencies 77T =(JTj-1, NH, 7113) then
follows multinomial distribution p(7TT|aT), with parameter
aT=(€¥T1~€¥T2~ Gin),-

2.4 BF for finding somatic mutations

Although we can ﬁt the Bayesian latent Dirichlet model to the sequencing
data of tumor and matched normal samples using some statistical meth-
ods, for evaluating the possibility of a variant being a true somatic mu-
tation, we need to deﬁne a model that can be considered as a control
against the model constructed under the premise of the existence of the
mutation. In a Bayesian framework, we can compare the likelihoods of
these two models by the BF given by

:pM(xviT|anaTv ‘1’)

BF 7
PE(XN~ lean “T7 ‘1’)

where 17M and [75 represent the models constructed under the premise of
the existence of a mutation and without a mutation, respectively, and 17M
(xN, xrlaN, ar, y) is the marginal likelihood deﬁned by

Pix/1(wa lean (IT, ‘1’):

Z pr(X,Z|aN,aT, y)dJTNd7TTd£.
ZNZT

If the value of the BF is signiﬁcantly large, we regard the candi-
date mutation as likely to be a true somatic mutation, with high
probability.

As for the two models, 17M and 175, pM is the model already described
in the previous sections, which we designate a mutation model. The
latter model, 175, can be constructed by replacing the haplotype
frequencies in [7(ZTI7TT,8) with those in [7(ZTIJTN,8), i.e. only two
haplotypes ideally exist, and the third and fourth haplotypes are sim-
ply errors. We designate pE as an error model. It is not an easy task
to compute the marginal likelihood pM(xN,xT|aN,aT,7/) because it
contains high-dimensional integrals and sums. To achieve efﬁcient
computation of the marginal likelihood, we derived a variational Bayes
procedure for our proposed model.

2.5 Variational Bayes method for computing marginal
likelihood

Suppose that q(Z) is the variational distribution that yields the decom-
position

[1(3): [1(ZN)£1(Z r)q(JTN)q(7Tr)q(8)- (2)

Although the variational distribution should be prepared for each of
the mutation and error models, we omit the index M or E for simplifying
the representation. Using the variational distribution, we obtain a lower
bound of the marginal likelihood

17(Xv Zlan “T7 7)]

M) (3)

10gp(XlaN,ar, 7/) 2 E41 [10g
where E] represents the expectation under the distribution q, as
deﬁned in Equation (2). In the variational Bayes framework,
a functional of q in the right side of Equation (3) is called free
energy and an iterative update of q, which maximizes the free
energy achieved to an estimated posterior density of ZN,ZT,JTN,7TT
and a. The update formula of q in the right side of Equation (2) can
be represented by

NN 4
mm = H H (amt

i=1j=1
N7- 4
q*(ZT) = 1‘1 H (tag-W,
i=1j=1
q*(”N) :pbcta(”N|a7v)w
4*(7TT) =17Dir(7TT|a*T),
q*(8):pbcta(817*)v

where pbm and pDir are the densities of beta and Dirichlet distribu-
tions, respectively, and the updated parameters can be obtained by

*
g. : (’sz
’sz 4 v
*H/
E j/:1p1vy
*
g. : pm
’m —4 v
E p*»-/
17:] T2]
NN Nv

* _ * _
0[N] T E (ZNi1+ZNi3)+avaOl/V2’ E (2N12+ZNT4)+€¥N2,
i=1 i=1

N7- NT

* _ * _
an T E 2771 +€¥T1~OlnT E (ZTz2+ZTi4)+aT2v
i=1 i=1

NT

* _2
057-37 27341—05737
i=1

N7- NN
Vi = Z 2774 ‘1‘ 2(2Ni’3 ‘1‘ ZNi’4) + V1,
1’: 1

i’=1

NT NN
V: = Z Zm ‘1‘ 2(2Ni’1 ‘1‘ ZNi’Z) + 1/2,
i=1

i’=1

 

3304

ﬁre'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

HapMuC

 

 

 

 

 

with

10% Pivn =log f+l* +10% *1/26 * +10gP(XN1|H1)~

“N1 ‘1' “N2 V1 ‘1‘ V2
* *

10% Diva : 10% ﬂ 1 Willy; ‘1‘ 10gP(XNi|H2)v

10% ﬁlm :log fLIJ. +10% *1/16 * ‘1'10g17(XNi|7‘(3)w
“N1 + “N2 7/1 + V2

10% pivm : 10% f4 +10% VT ‘1‘ 10gP(XNi|H4)v
“N1 + “N2 Vi + V2

“’6

10% Pin :log 3—Tl* +10gP(XTz’|H1)v
1:1 0‘“
“*Tz Viv2

10% Pin =10g 3— +10% W +10gP(XTi|H2)v

k : 1 01*” N1 N2

“’6
10g 0% =10g 3—n* ‘1‘ 10gP(X T117131

 

1:1 0‘“
“’6 y*

10% Kim =10g 3—n* +10% M} * +10gP(XTi|H4)-
Ail an, 7’1 V2

Here, H,- is the jth haplotype, and XM and XT, are the ith read of
normal and tumor samples, respectively.

We describe the derivation of the variational procedure in
Supplementary Method S1.

2.6 Inferring local normal haplotypes when there exist
multiple heterozygous germ line variants

When multiple heterozygous germ line variants are located nearby, the
number of candidate haplotypes in the normal sample is two to the power
of the number of the germ line variants. We use a haplotype assembly
algorithm (He at al., 2010) to infer the two normal local haplotypes from
the set of possible haplotypes. The method constitutes a dynamic pro-
gramming algorithm, which will ﬁnd an optimal solution with respect to
the minimum error correction (MEC) score. The MEC score is the number
of conﬂicts between the reads and the two constructed haplotypes. The
problem of minimizing the MEC score is Non-deterministic Polynomial-
time hard (Cilibrasi et al., 2005; Genovese et al., 2008); however, the op-
timal algorithm is computationally practical for up to reads of length 15,
where the length is the number of heterozygous germ line variants.

3 RESULTS

3.1 Sequence errors occur randomly on normal haplotypes
in real data

We investigated the relationships between somatic mutations and
heterozygous germ line variants nearby, using exome tumor and
matched normal sequences of 10 ccRCC patients (Sato et al.,
2013; Shiraishi et al., 2013). First, we focused on orthogonally
validated somatic mutations with a heterozygous germ line single
nucleotide polymorphism (SNP) nearby. The somatic mutations
were detected based on tumor and matched normal exome se—
quences, and then validated by using RNAseq and whole
genome sequence data. For each true somatic mutation, we

classiﬁed the reads, which overlap both the somatic mutation pos—
ition and the heterozygous SNP position, into four types: (i) RR,
reads that do not support either the somatic mutation or the het—
erozygous SNP; (ii) VR, reads that support the somatic mutation
without the heterozygous SNP; (iii) RV, reads that support the
heterozygous SNP without the somatic mutation; and (iv) VV,
reads that support both the somatic mutation and the heterozygous
SNP. As a heterozygous germ line SNP was located nearby, we
observed both RR and RV reads for each somatic mutation.
However, we mostly observed either VR or W reads (Fig. 2B).
This experiment indicated that somatic mutations occur on one of
normal haplotypes. Second, we investigated the behaviors of se—
quence errors. We collected mismatches in error loci (Shiraishi
et al., 2013) using the same exome data as above, and excluded
potential mapping errors by using human chained self—alignments
(Chiaromonte et al., 2002; Kent et al., 2003; Schwartz et al., 2003),
simple tandem repeats (Benson, 1999), dbSNP 138 (Sherry et al.,
2001), BLAT aligner (Kent, 2002) with human decoy sequences
(37d5) (Genovese et al., 2013) and indels located nearby (see
Supplementary Method S2). For each probable sequence error pos—
ition, we classiﬁed the reads, which overlap the sequence error pos—
ition and the heterozygous SNP position, into four types (RR, VR,
RV and VV). We observed both VR and VV reads simultaneously
in most cases (Fig. 2B), in contrast to the observations made for the
somatic mutations. This observation indicates that sequence errors
occur randomly on normal haplotypes.

3.2 Simulation Study

We tested HapMuC using synthetic data. In this simulation, we
used several read lengths (100, 150, 300 and 1000 bp) and com—
pared the results between these as well as single—end reads versus
paired—end reads.

We generated positive and negative examples as follows:

(1) Generate a random reference DNA sequence

(2) Generate a heterozygous germ line variant in a random
location, as well as two haplotypes (h1 and h2)

(3) Generate a somatic mutation randomly, according to an
empirical distribution (Supplementary Fig. S1), as well as
two haplotypes (h3 and h4)

(4) Setting parameters were as follows: tumor purity was set at
20% for positive examples and 0% for negative examples.
Note that a tumor purity of 20% leads to an average allele
frequency of 10%.

(5) For 50 repetitions:

0 Select a source haplotype randomly, according to the
multinomial distribution (haplotype frequencies),
given the parameters

0 Select a start point of a read randomly such that the
read overlaps the candidate position

0 Select a strand direction randomly, and generate
a paired—read with 1% sequence errors and an in—
sertion size given by a normal distribution
(Ir=3 X I, a=l/2), where I is the read length, by
referring to an empirical distribution (Supplementary
Fig. S2).

 

3305

ﬁre'spzurnofpmJXO'sopeuuowrorq/ﬁdnq

Vahdaled somath mulallons

 

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

 

Som cmuta ns
Sequencing errors

HapMuC with SNP
HapMuC without SNP
0 Fisher

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

HapMuC with SNP

HapMuC without SNP
o VarScanZ

Strelka

MuTect

SomaticSniper

HapMuC with SNP

HapMuC without SNP
o VarScanZ

Strelka

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

HapMuC

 

showed that our algorithm has sensitivity better than or compar—
able with that of the existing methods.

For future studies, we intend to incorporate further informa—
tion into our algorithm. First, sequence strand bias, which is
suggested as a false—positive filter by SomaticSniper, VarScan
2, MuTect and so on, could be considered. We can integrate
the information of strand bias into HapMuC’s score by extend—
ing our generative model. Second, we may consider the distance
to the effective 3’end, which is suggested as an additional ﬁlter by
SomaticSniper. We can achieve this by modifying the profile
HMM alignment algorithm to consider the distances from the
edges of reads. In addition, when sequencing data of other sam—
ples are available, we can infer background error rates and use
these as prior information. A recent statistical approach, called
EBCall (Shiraishi et al., 2013), has succeeded in achieving out—
standing performance using pooled normal samples. MuTect
also uses a simple false—positive filter, which checks whether can—
didate mutations exist in other normal samples. In terms of stat—
istical modeling, if we could modify the mutation model and the
error model as a nested model—pair, we can use a variable selec—
tion approach, such as lasso, for detecting somatic mutations.

ACKNOWLEDGEMENTS

The super—computing resource was provided by Human Genome
Center, the Institute of Medical Science, the University of
Tokyo.

Funding: This work was partly supported by Grant—in—Aid for
Scientiﬁc Research on Innovative Areas (22134004).

Conﬂict of interest: none declared.

REFERENCES

Albers,C.A. et al. (2011) Dindel: accurate indel calls from short—read data. Genome
Res., 21, 9617973.

Beal,M.J. (2003) Variational Algorithms for Approximate Bayesian Inference. PhD
thesis, The Gatsby Computational Neuroscience Unit, University College
London, London, UK.

Benson,G. (1999) Tandem repeats ﬁnder: a program to analyze DNA sequences.
Nucleic Acids Res., 27, 573.

Blei,D.M. et al. (2003) Latent dirichlet allocation. J. Mack. Learn. Res., 3,
99371022.

Bradley,A.P. (1997) The use of the area under the ROC curve in the evaluation of
machine learning algorithms. Pattern Recognit., 30, 114571159.

Chiaromonte,F. et al. (2002) Scoring pairwise genomic sequence alignments. In:
Pacific Symposium on Biocomputing. V01. 7, pp. 1157126.

Cibulskis,K. et al. (2013) Sensitive detection of somatic point mutations in impure
and heterogeneous cancer samples. Nat. Biotechnol, 31, 2137219.

Cilibrasi,R. et al. (2005) On the complexity of several haplotyping problems. In:
Algorithms in Bioinformatics. Springer, pp. 1287139.

Ding,L. et al. (2012) Clonal evolution in relapsed acute myeloid leukaemia revealed
by whole—genome sequencing. Nature, 481, 50(r510.

Eddy,S.R. (1998) Proﬁle hidden Markov models. Bioinformatics, 14, 7557763.

Fawcett,T. (2006) An introduction to ROC analysis. Pattern Recognit. Lett., 27,
8617874.

Forbes,S.A. et al. (2011) COSMIC: mining complete cancer genomes in the
Catalogue of Somatic Mutations in Cancer. Nucleic Acids Res., 39, D9457D950.

Genovese,G. et al. (2013) Mapping the human reference genomes missing sequence
by three—way admixture in latino genomes. Am. J. Hum. Genet., 93, 4114121.

Genovese,L.M. et al. (2008) Speedhap: an accurate heuristic for the single individual
SNP haplotyping problem with many gaps, high reading error rate and low
coverage. IEEE/ACM Trans. Comput. Biol. Bioinform., 5, 4927502.

G0ya,R. et al. (2010) SNVMix: predicting single nucleotide variants from next—
generation sequencing of tumors. Bioinformatics, 26, 7307736.

He,D. et al. (2010) Optimal algorithms for haplotype assembly from whole—genome
sequence data. Bioinformatics, 26, 118}il90.

Kent,W.J. (2002) BLAT—the BLAST—like alignment tool. Genome Res., 12, 656$64.

Kent,W.J. et al. (2003) Evolution’s cauldron: duplication, deletion, and rearrange—
ment in the mouse and human genomes. Proc. Natl Acail. Sci. USA, 100,
11484711489.

K0b01dt,D.C. et al. (2012) VarScan 2: somatic mutation and copy number alter—
ation discovery in cancer by exome sequencing. Genome Res., 22, 5687576.
Larson,D.E. et al. (2012) SomaticSniper: identiﬁcation of somatic point mutations

in whole genome sequencing data. Bioinformatics, 28, 3117317.

Ley,T.J. et al. (2008) DNA sequencing of a cytogenetically normal acute myeloid
leukaemia genome. Nature, 456, 6&72.

Meyerson,M. et al. (2010) Advances in understanding cancer genomes through
second—generation sequencing. Nat. Rev. Genet., 11, 6857696.

Nik—Zainal,S. et al. (2012) The life history of 21 breast cancers. Cell, 149, 9944007.

Pleasance,E.D. et al. (2010) A comprehensive catalogue of somatic mutations from
a human cancer genome. Nature, 463, 1917196.

R0bin,X. et al. (2011) pROC: an open—source package for R and S + to analyze and
compare ROC curves. BMC Bioinformatics, 12, 77.

R0th,A. et al. (2012) JointSNVMix: a probabilistic model for accurate detection of
somatic mutations in normal/tumour paired next—generation sequencing data.
Bioiiﬁ’ormatics, 28, 9077913.

Sat0,Y. et al. (2013) Integrated molecular analysis of clear—cell renal cell carcinoma.
Nat. Genet., 45, 8604567.

Saunders,C.T. et al. (2012) Strelka: accurate somatic small—variant calling from
sequenced tumor—normal sample pairs. Bioinformatics, 28, 181171817.

Schwartz,S. et al. (2003) Human—mouse alignments with BLASTZ. Genome Res.,
13, 1037107.

Shah,S.P. et al. (2009) Mutational evolution in a lobular breast tumour proﬁled at
single nucleotide resolution. Nature, 461, 8094513.

Sherry,S.T. et al. (2001) dbSNP: the NCBI database of genetic variation. Nucleic
Acids Res., 29, 3087311.

Shiraishi,Y. et al. (2013) An empirical Bayesian framework for somatic mutation
detection from cancer genome sequencing data. Nucleic Acids Res., 41, e894389.

Thorvaldsdottir,H. et al. (2013) Integrative Genomics Viewer (IGV): high—perform—
ance genomics data visualization and exploration. Brief. Bioinform., 14,
1787192.

Yoshida,K. et al. (2011) Frequent pathway mutations of splicing machinery in
myelodysplasia. Nature, 478, 64—69.

 

3309

ﬁre'spzurnofpmJXO'sopnuuowrorq/ﬁdnq

