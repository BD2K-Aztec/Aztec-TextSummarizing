BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

E.P.Nawrocki and S.R.Eddy

 

_L
O

Infernal v1.1 (no filters) 4359 hours

W

cm i i Infernal v1.0.2 (default 49.31 h urs
Infernal v1.1 (default) 0.44 hours
nhmmer (sequenoe profiles) 0.02 hours

BLASTN (FFW) 0.01 hours

0.001 0.005 0.010 0.050 0.100
false positives per Mb searched per query

9 9 9 9
N b o) co

Sensitivity (fraction of true positives)

9
o

0.500 1.000

Fig. 1. ROC-like curves for the benchmark. Plots are shown for the new
Infernal 1.1 with and without ﬁlters, for the old Infernal 1.0.2, for proﬁle
HMM searches with nhmmer (from the HMMER package included in
Infernal l.l, default parameters) and for family-pairwise-searches with
BLASTN (ncbi-blast-2.2.28+, default parameters). The maximum sensi-
tivity (not shown) for default Infernal 1.1 is 0.81 (629 of 820 true positives
found), which is achieved at a false-positive rate of 0.19/Mb/query. For
non-ﬁltered Infernal, maximum sensitivity is 0.87 at 2.9 false positives per
Mb per query. This indicates that at high false-positive rates the ﬁlters
prevent some true positives from being found, but prevent many more
false positives from being found. CPU times are total times for all 106
family searches measured for single execution threads on 3.0GHz Intel
Xeon processors. The Infernal times do not include time required for
model calibration.

ranked list of top scoring hits and hit alignments. The cmalign
program takes a CM file (calibrated or not), aligns all sequences
to the model and outputs a structurally annotated MSA in
Stockholm format. Version 1.1 introduces the cmscan program
for determining whether a given sequence contains homologies to
any known RNA families in a CM library like Rfam. Before
running cmscan, the CM database must be converted to a special
format using empress, which enables faster scanning.

4 PERFORMANCE

An independent benchmark of RNA homology search (Freyhult
et al., 2007) found covariance model—based programs, including a
previous version of Infernal, to be the most specific and sensitive
of the tools tested. We present here results from an updated
version of our previously published internal RMARK bench—
mark (Nawrocki et al., 2009), mainly to indicate the relative
performance of Infernal 1.1 and the previous version 1.0.2.

The RMARK3 benchmark was constructed from the seed
alignments of the Rfam 10.0 database as previously described
(Nawrocki et al., 2009). It is composed of a set of 106 families,
each represented by a training alignment of 35 aligned sequences
and a test set of 31 sequences. No two test sequences are >70%
identical, and no train/test sequence pair is >60% identical. The
780 test sequences were embedded into ten 1 Mb genome—like
sequences, to create a benchmark ‘pseudo—genome’ of 10.16 Mb.
For each included family, a model was built from the training set
using the Rfam alignment, calibrated and used to search the
pseudo—genome. The resulting hits from all searches were then
sorted by E—value and a sensitivity versus false—positive rate
ROC—like curve was generated from the results (Fig. 1).

Figure 1 shows that default Infernal 1.1 performs the bench—
mark searches in 0.44h and is ~100 times faster than the

previous version 1.0.2 (49.31 h) and ~10000 times faster than
exhaustive non—ﬁltered 1.1 search (4359 h); yet all three search
methods have similar sensitivity at the low false—positive rates ne—
cessary for large database searches. We also tested two sequence—
only methods: proﬁle HMMs implemented in HMMER3 (Eddy,
2008, 2011) and family—pairwise (Grundy, 1998) single—sequence
BLASTN queries (Altschul et al., 1997), which were faster (0.02
and 0.01h, respectively), but signiﬁcantly less sensitive than
CMs, indicating the beneﬁt of secondary structure modeling.

The relatively fast speed of default version 1.1 on the bench—
mark is maintained on real genomic sequences. The average
speed is 1.5 s/Mb/query on the benchmark and 0.6 s/Mb/query
on a several gigabase database that includes a sampling of 15
genomes (ﬁve each of archaea, bacteria and eukarya) using the
same query models from the benchmark. As database size
increases, Infernal increases ﬁlter stringency resulting in faster
search rates without sacriﬁcing appreciable sensitivity at low
false—positive rates based on further RMARK benchmarking
(results not shown).

Infernal is now a more practical tool for RNA homology
search. The increased speed should enable its incorporation
into automated sequence annotation pipelines and obviate the
need for additional ﬁltering schemes for large—scale CM searches,
such as the BLAST—based ﬁlter paradigm used by Rfam
(Grifﬁths—Jones et al., 2003). Rfam—based annotation of one typ—
ical bacterial or archaeal genome (i.e. searching all 2208 Rfam
11.0 models against a 275 Mb target) now takes ~1 h on a single
quad—core desktop computer. Analysis of larger datasets, how—
ever, such as vertebrate genomes or all reads from a high—
throughput sequencing run, still requires a compute cluster. As
an example, a search of all Rfam models against the le
chicken genome would require ~3 h on a 100—CPU compute
cluster. The most expensive programs (cmalign, cmcalibrate,
cmscan and cmsearch) are implemented for use with multiple
threads on multi—core machines and in coarse—grained MPI ver—
sions for clusters.

ACKNOWLEDGEMENTS

Travis Wheeler adapted HMMER3’s filters for chromosome—
length sequences, and his code is integral to Infernal’s pipeline.
We thank Goran Ceric and his team for managing Janelia
Farm’s high—performance computing resources.

Funding: Infernal development is supported by Howard Hughes
Medical Institute.

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et ul. (1997) Gapped BLAST and PSI—BLAST: a new generation of
protein database search programs. Nucleic Acirls Res., 25, 338%3402.

Brown,M.P. (2000) Small subunit ribosomal RNA modeling using stochastic
context—free grammars. Proc. Int. Conf. Intell. Syst. Mol. Biol, 8, 57%6.

Burge,S.W. et ul. (2013) Rfam 11.0: 10 years of RNA families. Nucleic Acirls Res.,
41, D22(rD232.

Cole,J.R. et ul. (2009) The Ribosomal Database Project: improved alignments and
new tools for rRNA analysis. Nucleic Acirls Res., 37, D1417D145.

Durbin,R. et ul. (1998) Biological Sequence Analysis: Probabilistic Models of
Proteins unrl Nucleic Acids. Cambridge University Press, Cambridge, UK.

 

2934

/810's113um0_fp103x0"soiJBmJOJuioiq/ﬁdnq

Mﬂynalt1

 

Eddy,S.R. (2003) The HMMER2 user's guide. http://hmmer.janelia.0rg/ (1 July
2013, date last accessed).

Eddy,S.R. (2008) A probabilistic model of local sequence alignment that simpliﬁes
statistical signiﬁcance estimation. PLoS Comput. Biol, 4, e1000069.

Eddy,S.R. (2011) Accelerated proﬁle HMM searches. PLoS Comp. Biol, 7,
e1002195.

Freyhult,E.K. et al. (2007) Exploring genomic dark matter: a critical assessment of
the performance of homology search methods on noncoding RNA. Genome
Res., 17, 1177125.

Griffiths—Jones,S. et al. (2003) Rfam: an RNA family database. Niwleic Acids Res.,
31, 4394141.

Grundy,W.N. (1998) Homology detection via family pairwise search. J. Comput.
Biol, 5, 4797491.

Kolbe,D.L. and Eddy,S.R. (2009) Local RNA structure alignment with incomplete
sequence. Bioinformatics, 25, 123(r1243.

Nawrocki,E.P. (2009) Structural RNA Homology Search and Alignment Using
Covariance Models. PhD Thesis, Washington University School of Medicine,
USA.

Nawrocki,E.P. et al. (2009) Infernal 1.0: inference of RNA alignments.
Bioiry’ormatics, 25, 133571337.

Weinberg,Z. and Ruzzo,W.L. (2004) Exploiting conserved structure for faster
annotation of non-coding RNAs without loss of accuracy. Bioinformatics, 20
(Suppl. 1), 13344341.

Weinberg,Z. and Ruzzo,W.L. (2006) Sequence—based heuristics for faster annota—
tion of non—coding RNA families. Bioinformatics, 22, 35739.

 

2935

/3.IO'S[BIImO[p.IOJXO'SOlJBLUJOJIIlOlq/ﬂduq

