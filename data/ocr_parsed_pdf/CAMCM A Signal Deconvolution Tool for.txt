Vol. 27 no. 18 2011, pages 2607-2609
APP N doi:10.1093/bioinformatics/btr436

 

Systems biology

Advance Access publication July 23, 2011

CAM-CM: a signal deconvolution tool for in vivo dynamic
contrast-enhanced imaging of complex tissues

Li Chen“, Tsung—Han Chantal, Peter L. Choyke3, Elizabeth M. o. Hillman4,
Chong-Yung Chi2, Zaver M. Bhujwalla5, Ge Wange’, Sean S. Wang7, Zsolt Szabo5 and

Yue Wang“

1Bradley Department of Electrical and Computer Engineering, Virginia Tech, Arlington, VA 22203, USA, 2Department
of Electrical Engineering, National Tsing Hua University, Taiwan, ROC 30013, 3Molecular Imaging Program, National
Cancer Institute, NIH, Bethesda, MD 20892, 4Department of Biomedical Engineering and Radiology, Columbia
University, New York, NY 10027, 5Department of Radiology and Radiological Science, Johns Hopkins University
School of Medicine, Baltimore, MD 21205, 6School of Biomedical Engineering and Sciences, Virginia Tech,
Blacksburg, VA 24061 and 7Science, Mathematics, Computer Science House, Poolesville High School, Poolesville,

MD 20837, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Summary: In vivo dynamic contrast-enhanced imaging tools provide
non-invasive methods for analyzing various functional changes
associated with disease initiation, progression and responses to
therapy. The quantitative application of these tools has been hindered
by its inability to accurately resolve and characterize targeted tissues
due to spatially mixed tissue heterogeneity. Convex Analysis of
Mixtures — Compartment Modeling (CAM-CM) signal deconvolution
tool has been developed to automatically identify pure-volume pixels
located at the corners of the clustered pixel time series scatter
simplex and subsequently estimate tissue-specific pharmacokinetic
parameters. CAM-CM can dissect complex tissues into regions with
differential tracer kinetics at pixel-wise resolution and provide a
systems biology tool for defining imaging signatures predictive of
phenotypes.

Availability: The MATLAB source code can be downloaded at the
authors’ website www.cbil.ece.vt.edu/software.htm

Contact: yuewang@vt.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 23, 2011; revised on July 17, 2011; accepted on
July 18, 2011

1 INTRODUCTION

In vivo dynamic contrast-enhanced imaging tools provide non-
invasive methods for analyzing various functional Changes
associated with disease initiation, progression and responses to
therapy (McDonald and Choyke, 2003). Typical modalities include
dynamic contrast-enhanced magnetic resonance imaging (DCE-
MRI) (Costouros et (11., 2002), dynamic contrast-enhanced optical
imaging (Hillman et (11., 2007), positron emission tomography
(Zhou et (11., 1997) and spectroscopic computed tomography

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion. the ﬁrst two authors
should be regarded as joint First Authors.

(Anderson et (11., 2010). These tools exploit the dynamics of
contrast accumulation and washout to produce functionally relevant
images of vascular perfusion and permeability, metabolism or gene
expression, and can potentially test novel hypotheses and predict
drug efﬁcacy.

However, due to spatially mixed tissue heterogeneity, the precise
imaging-based phenotyping by these tools has been hindered by its
inability to accurately resolve and Characterize targeted functional
tissue compartments (Hillman and Moore, 2007). This indistinction
between contributions of different tissues to the mixed tracer
signals could signiﬁcantly confound subsequent pharmacokinetics
compartmental modeling (CM) (Zhou et (11., 1997) and affect the
accuracy of genotype—phenotype association studies (Costouros
et (11., 2002; Segal et (11., 2007).

We developed convex analysis of mixtures — compartment
modeling (CAM-CM) signal deconvolution tool that
enables geometrically principled, unsupervised and accurate
Characterization and delineation of major functional tissue
structures from dynamic contrast-enhanced imaging data, not only
dissecting complex tissue into regions with differential tracer
kinetics at pixel-wise resolution, but also substantially improving
tissue-speciﬁc pharmacokinetic parameter estimation (Wang et (11.,
2010). CAM-CM is supported by a well-grounded mathematical
framework, and combines the advantages of multivariate Clustering,
convex geometry analysis and compartmental modeling. The
algorithm possesses a novel, powerful feature allowing pure-
volume pixels to be readily identiﬁed from the measured pixel time
series, without any knowledge of the associated compartmental
pharmacokinetics, leading to a completely unsupervised approach.
We provide CAM-CM software as an open-source standalone
MATLAB application.

2 DESCRIPTION
2.1 Method and software

Under the framework of compartment modeling in dynamic
contrast-enhanced imaging studies, the spatial-temporal

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2607

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq 11101} pepeolumoq

91oz ‘Og anﬁnv uo ::

L.Chen et al.

 

 
  
      

Multivariate clustering

— affinityI prupagaljun ciuater—
rm; (APO)

— elandard ﬁnite normal mix-
tures (SFNNH model

Pier time courses

---""\ — expectation-maximizalion
 . ' (EM) aIgorlthm
' ‘- partial-volume

“‘\
\.

 
  
    
  
     
   

 

 

pure-volume
clusters

 
  
 

Convex analysis
of mlxturas {CAM}
- minimum margin error

pu revolume
CIUSIBI‘ centers

Compartment modeling {CM}
— J-Iissue parallel cornparlrnerll modal

Tissue-speciﬁc racer concemrauons

I plasma input

I fast flow
I slowﬁmnr

 

«—

 

 

 

Con-codad volume trmsfar constant map
Fig. 1. Software ﬂowchart of the CAM-CM algorithm.

signals x(i,t) of tracer concentration at pixel i can be
expressed as a non-negative linear combination of the latent
tissue-speciﬁc compartmental time activity curves (11(1),
weighted by the relative tissue type proportions Kj(i) at that
pixel: x(i,t)=(1t1(t)K1(i)+-~~+aj(t)I§(i)+~~~+aJ(t)KJ(i), where
J is the number of functional tissue compartments (Hillman et (11.,
2007). This falls neatly within the deﬁnition of a convex set:

J
X: Elﬁnaj ajeA,Kj(i)20,ZKj(i)=l,i=1,...,N
j=1 j=1

where aj is the vector notation of (11(1) over time . We have shown
that the comer points of the pixel time series convex hull 7-106)
correspond to the pure-volume pixels for each tissue compartments
(Wang et (11., 2010).

The ﬂowchart of CAM-CM algorithm is given in Figure l.
The three core components of CAM-CM software include: (i)
initialization-free multivariate Clustering of pixel time series
into an optimum number of representative and robust Clusters
using afﬁnity propagation Clustering and expectation—maximization
mixture model ﬁtting (Frey and Dueck, 2007); (ii) convex analysis
of mixtures that automatically identiﬁes the pure-volume pixel
Clusters geometrically located at the comers of the Clustered pixel
time-series scatter simplex via minimum-error-margin convex-hull-
to-data ﬁtting (Wang et (11., 2010); and (iii) compartment modeling
that estimates tissue-speciﬁc pharmacokinetic parameters using
only pure-volume pixel time series. The CAM-CM software is
implemented in MATLAB, and runs successfully on both Microsoft
Windows and Linux platforms.

The CAM-CM software takes input from the .mat data ﬁles
that record the pixel time series of dynamic contrast-enhanced
images in matrices. Each row corresponds to a time frame and
each column corresponds to a pixel. Running CAM-CM software is
automatic and convenient, with only two user-controlled parameters:
the number of tissue types J and the sampling time interval between
two consecutive dynamic image frames. Results of CAM-CM are
provided to the users via a multiplatform graphical summary that

     
    

‘Ei‘.

 

 

 

_.
g plasma mom I 095
a i
E : ﬂ 9
E .'
. o 95 ,_ mm
E —Snm
g u a — animate
3 — Large nleslme
T D F5 — run:
100 200 300' 400 500 600 MI] E ' _ am“ “.9445
e: WWW] E w —w
a — Sum
(b) b

O 55 Swear:

 

 

—- Lung

 

 

ﬂ 5 ‘0 If 39 25
IE] I ma n-ini

    

xaidwgs 1311835 sagas awn iaxid

 

 

Fig. 2. Output of CAM-CM software on biomedical case studies (see
Supplementary Material for more detailed discussions).

includes compartment time activity curves, convexity-preserved
Clustered scatter simplex, and dissected and composite compartment
parametric images (Fig. 2). The displays are visually simple to
interpret, yet still convey considerable mathematical and biological
insights.

2.2 Biomedical case studies

CAM-CM has been tested on real dynamic contrast-enhanced
imaging data. Using DCE-MRI dataset of an advanced breast cancer
case (McDonald and Choyke, 2003), CAM-CM analysis reveals
two biologically interpretable vascular compartments with distinct
kinetic patterns: fast Clearance in peripheral ‘rim’ and slow Clearance
in inner ‘Core’ (Fig. 2a—C) which otherwise could not be seen if
tissue heterogeneity (84% in this case) was not taken into account,
plausibly consistent with the previously reported heterogeneity
within tumors (Costouros et (11., 2002). Since angiogenesis is
essential for tumor development, it has been widely observed that
active angiogenesis in advanced breast tumors often occurs in the
peripheral ‘rim’ with co-occurrence of inner-core hypoxia, due to the
defective endothelial barrier function and outgrowth blood supply
(McDonald and Choyke, 2003).

In another application to dynamic ﬂuorescence molecular imaging
data acquired on a mouse after bolus injection of indocyanine green
dye (Hillman and Moore, 2007), CAM-CM provides physiologically
interpretable biodistribution dynamics of the major organs. Ten
ﬂuorescence time courses (Fig. 2d) show distinct patterns of
Circulating, accumulating or metabolizing the dye in different
organs, which agree with expected physiological trends, such as
late uptake by adipose tissue and fast Clearance from the brain
region. The merged and color-coded maps of these dissected tissue
compartments constitute anatomical structures of the mouse that
agree well with a digital anatomical mouse atlas, allowing the

 

2608

112 /3.Io's[Bruno[pJOJXO'sotwurJOJutotqﬂ:duq urorj papBOIIIAAOG

9103 ‘Og anﬁnv uo ::

CAM-CM

 

longitudinal identiﬁcation of the internal organs (Fig. 2e) (Hillman
and Moore, 2007).

Detailed descriptions on method, simulation-based validation and
more biomedical case studies are included in the Supplementary
Material.

3 DSCUSSON

CAM-CM spatial-temporal analysis can be very effective at
revealing multi-compartment structure within dynamic contrast-
enhanced imaging data of complex tissues, estimating tissue-speciﬁc
kinetic parameter values and characterizing the roles of different
functional tissue compartments. We would expect the CAM-CM
method, with publicly available open-source software package, to be
a very useful tool for the exploratory analysis of dynamic functional
imaging data in many research and clinical applications. We plan to
develop and deliver future versions of the software written in both
R and Java languages.

Funding: National Institutes of Health, under Grants (EB000830,
EB008627 and HHSN261200800001E) in part.

Conﬂict of Interest: none declared.

REFERENCES

Anderson,N.G. et al. (2010) Spectroscopic (multi-energy) CT distinguishes iodine and
barium contrast material in MICE. Eur Radiol., 20, 212672134.

Costouros,N.Gi et a1. (2002) Microarray gene expression analysis of murine tumor
heterogeneity deﬁned by dynamic contrast-enhanced MRI. M01. Imaging, 1,
3017308.

Frey,B.J. and Dueck,D. (2007) Clustering by passing messages between data points.
Science, 315, 9727976.

Hi11man,E.M.C. and Moore,A. (2007) All-optical anatomical co-registration for
molecular imaging of small animals using dynamic contrast. Nat. Photonics, 1,
52&530.

Hi11man,E.M. et al. (2007) Depth-resolved optical imaging and microscopy of
vascular compartment dynamics during somatosensory stimulation. NenmImage,
35, 897104.

McDonald,D.M. and Choyke,P.L. (2003) Imaging of angiogenesis: from microscope to
clinic. Nat. Med., 9, 7137725.

Segal,E. et al. (2007) Decoding global gene expression programs in liver cancer by
noninvasive imaging. Nat. Biotechnol., 25, 675$80.

Wang,F.Y. et al. (2010) Nonnegative least-correlated component analysis for separation
of dependent sources by volume maximization. IEEE Trans. Pattern Anal. Mach.
Intell., 32, 8757888.

Zhou,Y. et a1. (1997) A modelling-based factor extraction for determining spatial
heterogeneity of Ga-68 EDTA kinetics in brain tumors. IEEE Trans. Nuclear Sci.,
44, 252272527.

 

2609

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq urorj pepeolumoq

9103 ‘Og isnﬁnv uo ::

