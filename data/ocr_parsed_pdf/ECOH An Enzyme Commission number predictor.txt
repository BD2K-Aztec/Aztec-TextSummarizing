BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Y.Matsuta et al.

 

discussed (Almonacid and Babbitt, 2011; Babbitt and Gerlt,
1997). Some studies have proposed methods for automatically
predicting EC numbers, by focusing on chemical transformations
between substrates and products and ignoring protein sequences
and structures.

The RPAIR database was constructed to map information on
atom types in three regions of the molecular structures of sub—
strateiproduct pairs (Kotera et al., 2004a). Using the RPAIR
database, E—zyme predicts possible EC number of a target reac—
tion by comparing the correlation between vectors that represent
the occurrence of atom mapping patterns (Yamanishi et al.,
2009). These researchers achieved a prediction accuracy of
82.5%. E—zyme is a rule—based method. In two of their studies,
Gasteiger’s group converted reactions only within classes EC 1
and EC 3 to physicochemical descriptors relating to the reacting
bonds and classiﬁed them into EC sub—subclasses by using a
self—organizing neural network, a SVM, and hierarchical cluster—
ing (Hu and Garcia, 2010; Sacher et al., 2009). Their SVM gave
an accuracy of 97.7%. Leber et a]. (2009) proposed a method for
the mapping of atom and bond types between substrates and
products in a reaction using matrices, and they obtained
unique matrices for each EC sub—subclass. The use of a reaction
graph kernel (RGK) along with a random walk kernel was pro—
posed for performing approximate matching between atom map—
ping patterns (Saigo et al., 2010). The matching accuracy was
82.5%. Although this method also uses the RPAIR database to
achieve high prediction performance, it is used to identify the
main substrateiproduct pairs in a reaction. Latino and
Aires—de—Sousa (2009) proposed physicochemical and topological
descriptors, named the MOLMAP descriptor, encoding bonding
changes during chemical reactions using matrices. Their random
forest predictors, a semi—supervised learning algorithm, gave an
accuracy of 82.4% for EC sub—subclasses for a genome—wide set
of reactions. Their work showed that the predictions were reli—
able if a full balanced description of the reaction is used.
Egelhofer et a] (2010) used typical chemoinformatics approaches
to EC sub—subclasses, that is, a string—type descriptor and a
Tanimoto similarity metric. Nath and Mitchell (2012) evaluated
a combination of five descriptors and three machine learning
algorithms; they used a SVM, random forest and k—nearest
neighbour algorithm. They achieved accuracies of 74.4% and
83.7% in the case of the SVM and random forest, respectively.
However, their tanning set was limited to 260 reactions, and it
was derived from the MACiE database (Holliday et al., 2012).

In this study, we investigated the automatic selection of im—
portant chemical transformations from reactions for predicting
the EC numbers of the reactions; in the selection process, we
removed outliers and noise from chemical transformations with—
out any preconditions. We propose a new method to ﬂexibly
predict EC numbers from the chemical structure of substrates
and products of unclassiﬁed enzymatic reactions by the use of a
maximal common substructure (MCS) algorithm, mutual infor—
mation (MI) and SVM through comparison of the structural
ﬁngerprint to a list of classiﬁed reactions.

2 METHODS

To predict the EC number for an enzymatic reaction, the user enters the
chemical structures of substrates and products in the MDL Molﬁle

format, and Enzyme COmmission numbers Handler (ECOH) outputs
the predicted EC sub-subclasses. The ECOH algorithm consists of the
following three steps: (i) extraction of substructures from the substrates
and products by using a MCS algorithm; (ii) calculation of MI for the
extracted substructures by comparison with a standard set of
EC-classiﬁed reactions, and subsequent generation of a candidate list of
EC numbers for the target reaction; and (iii) prediction of the EC number
using an SVM for the target reaction.

2.1 Extraction of substructures

We have focused on the difference in chemical structure between the
substrate and product of an enzymatic reaction, and extracted their
shared/unshared substructures by using the MCS algorithm (Tonnelier
et al., 1991). The chemical structures of the compounds were represented
as graphs in which the nodes represented atoms and the edges represented
bonds. The MCS algorithm was based on that implemented in the chem-
istry development kit (CDK) ver. 1.2.5 (Steinbeck et al., 2003), an open
source Java toolkit for manipulating small molecules using Java 6. A
main issue with using MCS is that it is non-deterministic polynomial
time (NP)-complete. The MCS algorithm based on CDK was therefore
limited by both the number of searches and the computational time. If no
MCS was found within these limits, then the program terminated the
search and generated the MCS from the solution at that point.

In this study, we improved the original MCS algorithm implemented in
CDK by cache management of the results and accelerating bit-string
operations. Furthermore, the criteria conﬁrming whether two chemical
bonds were matched were modiﬁed by subjecting them to the following
matching standards: (i) the electrical charge on the atom, (ii) the number
of hydrogens, (iii) the bond order of both atoms, (iv) its cis- or
trans-isomerism, and, for the whole molecule, (v) the number of atoms
involved in bonds that are part of ring structures. This modiﬁed MCS
algorithm improved the sensitivity of our method as it improved the
likelihood of ﬁnding equivalent atoms or bonds between two chemical
structures.

By applying the modiﬁed MCS algorithm, we extracted four types of
substructure pairs from the target enzymatic reaction (Fig. 1a): a ‘con-
served substructure pair’, which is a combination set of matching bonds
extracted from the substrates and products of an enzymatic reaction by
using the MCS algorithm (Fig. 1b); a ‘changed substructure pair’, which
is a combination of the remaining bond sets and their adjacent atoms that
were not in the conserved substructure pair (Fig. 1c); a ‘neighbouring
substructure pair’, which is a combination of adjacent atom sets belong-
ing to the conserved substructures and located adjacent to the changed
substructures (Fig. 1d); and a ‘small substructure pair’, which is a com-
bination of substructures having three or less atoms (except hydrogen)
(Fig. 1e). As a result, water, oxygen, ammonia and metal ions were
categorized as small substructures in the ECOH algorithm.

2.2 Calculation of mutual information and generation of
the candidate EC numbers

Feature selection is the process of selecting a subset of the informative
terms to solve a given inference problem. MI, which represents the meas-
ure of the statistical dependence between two variables, has previously
been used as the feature selection strategy with promising results (Guyon
and Elisseeff, 2003; Wang and Liu, 2011). We measured MI with a func-
tion [(3, e), which was formally deﬁned by Manning et a]. (2008) accord-
ing to the equation

[(3, e) = Z Z p(s = 13., e 2 re) logz

r;e(1.0}rﬂe(1.0}

17(5 2 rue 2 re)

— 1
ms = name =14.) ( )

where s is a random variable that assumes the value r321 when the
reaction contains substructure pair 3 and assumes rs = 0 when the reaction
does not contain the substructure pair 3. Furthermore, e is another

 

366

ﬁm'spzumofpmjxo'sopeuuopnorq/ﬁdnq

 N-Acetylaspartate amidohydrolase iKEGG reaction ID: RDDdBB}

|"-J-i_.
L-As pa rtate

N-Acetylaspa rtate

Ac state

(b'JConserved substructure pairs

 Neighbouring substructure pair

.1—‘5.
.41.!-

(9) Small substructure pair

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

Y.Matsuta et al.

 

Although LibSVM supports multi-class classiﬁcation using the ‘one-a-
gainst-one’ technique by combining all binary classiﬁers (Vapnik, 1998),
we ﬁnally used an SVM as a binary classiﬁer after considering the results of
experiments. Thus, the top two predicted EC sub-subclasses in the candi-
date list of EC sub-subclasses covered 92.0% of the correct predictions
(Supplementary File S2). In practice, the prediction performance for our
data when the multi-classiﬁer SVM from top 11 predicted EC
sub-subclasses (2<n 5 10) is lower than that in the case of a binary
SVM from top two predicted EC sub-subclasses (Supplementary File
S3). As we will see later in the dataset section, the EC classiﬁcation repre-
sents an imbalanced distribution, i.e. the number of reactions in one class is
much smaller than that in another. For example, in the data, EC 1.1.1
contains 528 reactions, whereas EC 6.6.2 covers two reactions. This im-
balance problem is of concern to many researchers who analyse datasets
(Hsu et al., 2003). Indeed, a highly imbalanced data distribution generally
results in a poor classiﬁcation performance for unseen samples belonging
to the minority class in a conventional SVM classiﬁer; this is because the
classiﬁer may be strongly biased towards the majority class (He and
Garcia, 2009). Cost-sensitive sampling and kernel-based methods are all
designed to address this problem of imbalanced classiﬁcation (Japkowicz
and Stephen, 2002). For multi-class SVMs, the distribution is even more
imbalanced (You et al., 2011). Therefore, we formally used a binary SVM
to predict EC sub-subclasses for enzymatic reactions in the ECOH.

In the study, we consider all reactions as reversible, and used 1328-bit
string representations of irreversible enzymatic reactions as the input and
training data for the SVM. To generate the 1328-bit string, if more than
one substructure pair are extracted from an irreversible reaction (e.g.
‘conserved’ in Fig. 1b), all the pairs are encoded in the same 332-bit
string. The 332-bit strings representing the substructure pairs extracted
from an irreversible reaction were further converted into a single 1328-bit
string by joining the bit strings of each type of substructure pair in the
order of ‘conserved’, ‘changed’, ‘neighbouring’ and ‘small’. Using this
1328-bit string representation, the EC sub-subclass of the target reaction
can be predicted from the similarity of its bit string to the substructure
pairs extracted from the reactions in the training set, and each type of
substructure pair can be simultaneously assessed. Because two types of
1328-bit strings are generated from a reaction by the previous procedures,
two types of outputs are provided by the SVM for a reaction. When the
outputs conﬂict with each other, the EC sub-subclass that is ranked ﬁrst
in the candidate list generated by the MI is used as the prediction result
by the SVM for the targeted reaction.

3 RESULTS AND DISCUSSION

3.1 Dataset and performance measurement

The REACTION database of the KEGG database (version 58.1)
(Kanehisa et al., 2012) contains 7 976 individual reactions. From
the original dataset, reactions with no EC sub—subclass assigned
(1255 entries) or reactions with an incomplete EC sub—subclass
classiﬁcation (487 entries) were removed. Of the remaining 6234
reactions, 5643 reactions covering the chemical structures of sub—
strates and products in the MDL Molﬁle format were targeted.
All reactions in the data were considered to be reversible reac—
tions. We extracted 2744 conserved substructure pairs, 5860
changed substructure pairs, 3391 neighbouring substructure
pairs and 388 small substructure pairs from the targeted reac—
tions. Following the aforementioned procedure, 1328—bit string
representations were obtained for the target reactions, which
covered 162 EC sub—subclasses. The minimum number of reac—
tions in 26 EC sub—subclasses is 1.

As EC sub—subclasses are more difﬁcult to predict than EC
subclasses and the last digit in the identiﬁer is merely a serial

number, an attempt was made to predict the EC sub—subclass for
the query reaction (Latino and Aires—de—Sousa, 2009; Saigo et al.,
2010; Yamanishi et al., 2009). All evaluations were conducted by
a simple jack—knife (leave—one—out) cross—validation procedure.
Namely, the reactions alternate with each other in being the
query reaction, and the EC sub—subclass is predicted on the
basis of the remaining reactions in the dataset. The positive
(the query reaction is labelled with the predicted EC
sub—subclass, and for reactions that have more than one EC
sub—subclass, at least one of the sub—subclasses is predicted) or
negative (the query reaction is not labelled) result of the predic—
tion is recorded. This is repeated for all reactions. The perform—
ance of the ECOH method was measured by assessing its
precision {[TP/(TP + FP)] X 100%}, sensitivity {[TP/
(TP+ FN)] x 100%} and accuracy {[(TP+ TN)/
(TP+FP+ TN+FN)] x 100%}; TP, FP, TN and FN represent
the number of enzymatic reactions labelled as true positive, false
positive, true negative and false negative, respectively.

3.2 Jack-knife prediction

The effectiveness of SVM in the ECOH approach was demon—
strated by a comparison between the predicted EC sub—subclass
based on MI (taking the highest candidate score in the generated
candidate list), and the EC sub—subclass predicted by SVM from
the top two EC sub—subclasses (MI + SVM). As shown in
Table 1, the experimental results show that overall, the SVM
based on the selection of target EC sub—subclass by MI has a
superior performance (sensitivity 2 86.1%, precision = 87.4%
and accuracy: 99.8% by the jack—knife test; see the dataset sec—
tion). Of the correct predictions, 180 predictive efforts matched
well with the candidate list ordered by MI, rather than the SVM,
which resulted in a run—off between the #1 and #2 candidates. In
contrast, 298 predictions matched better with the list ordered by
the SVM compared with the extent of its agreement with the list
ordered by MI. The results also reveal that accuracy is not an
appropriate measure to evaluate the detailed performance of the
ECOH method because it spans only a narrow range from
99.7% to 99.9% (Table 1). This narrowness derives from the
fact that all reactions in EC sub—subclasses, excluding the
target reaction, tend to be categorized into TN. Therefore, in
the following analyses, we mainly measured performance by sen—
sitivity and precision, except when comparing the ECOH method

Table 1. Prediction performance (%) for the EC sub-subclasses

 

Method Number of Total EC 1 EC 2 EC 3 EC 4 EC 5 EC 6
reactions (n) (5643) (2015) (1816) (917) (535) (213) (202)

 

MI Sensitivity 84.0 81.5 92.4 81.7 77.3 60.8 85.9
Precision 85.3 81.4 90.0 84.1 87.7 87.2 80.1
Accuracy 99.8 99.8 99.8 99.8 99.7 99.8 99.9
MI + SVM Sensitivity 86.1 87.1 88.9 86.0 80.3 67.0 85.9
Precision 87.4 87.2 92.0 84.7 79.7 89.3 81.6
Accuracy 99.8 99.9 99.8 99.9 99.7 99.9 99.9

 

Total number of reactions categorized into each EC sub—subclass is greater than the
number of reactions in total because a single reaction corresponds to multiple EC
sub—subclasses.

 

368

ﬁle'sreumoi‘pmjxo'sopnuuopnotq/ﬁdnq

r_'r._::r r E'f. 1.

I modiﬁed

Origins!

 

/3.10's112u.1n0fp.10}x0"soncuuqutotqﬂ:duq

no match
at least one match

full match

 .i|._

(bjszGG reaction ID: £03332 [ECs 3.1.1:.3 and 4.5.1.13}

 

/3.10's112u.1n0fp.10}x0"soncuuqutotqﬂ:duq

I modiﬁed

original

:2: 5:] -::= .50
Number of atoms. in MCS

(a) KEGG compound Io: 035-394

(5'

 HE'SG compoundlﬂ. C'l "

 

/3.10's112u.1n0fp.10}x0"soncuuqutotqﬂ:duq

Y.Matsuta et al.

 

Hu,X. and Garcia,E.A. (2010) Similarity perception of reactions catalyzed by oxi—
doreductases and hydrolases using different classiﬁcation methods. J. Chem. Inf.
Model, 50, 108971100.

IUPAC—IUBMB. (1999) IUPAC—IUBMB Joint Commission on Biochemical
Nomenclature (JCBN) and Nomenclature Committee of IUBMB
(NC—IUBMB), Newsletter 1999. Eur. J Biochem., 264, 607409.

Japkowicz,N. and Stephen,S. (2002) The class imbalance problem: a systematic
study. Intel. Data Anal, 6, 4297449.

Kanehisa,M. et al. (2012) KEGG for integration and interpretation of large—scale
molecular data sets. Nucleic Acids Res., 40, D1097D114.

Kotera,M. et al. (2004a) RPAIR: a reactant—pair database representing chemical
changes in enzymatic reactions. Genome Informatics, 15, P062.

Kotera,M. et al. (2004b) Computational assignment of the EC numbers for
genomic—scale analysis of enzymatic reactions. J. Am. Chem. Soc., 126,
16487716498.

Latino,D.A. and Aires—de—Sousa,J. (2009) Assignment of EC numbers to enzymatic
reactions with MOLMAP reaction descriptors and random forests. J. Chem. Inf.
Model, 49, 183971846.

Leber,M. et al. (2009) Automatic assignment of reaction operators to enzymatic
reactions. Bioinformatics, 25, 313573142.

Lu,L. et al. (2007) ECS: an automatic enzyme classiﬁer based on functional domain
composition. Compat. Biol. Chem., 31, 22(r232.

Manning,C.D. et al. (2008) Introduction to Information Retrieval. Cambridge
University Press, Cambridge.

McGregor,M.J. and Pallai,P.V. (1997) Clustering of large databases of compounds:
using MDL "keys" as structural descriptors. J. Chem. Inf. Comput. Sci., 37,
443448.

Nath,N. and Mitchell,J.B. (2012) Is EC class predictable from reaction mechanism?
BM C Bioiiﬁ’ormatics, 13, 60.

Sacher,O. et al. (2009) Investigations of enzyme—catalyzed reactions based on phy—
sicochemical descriptors applied to hydrolases. J. Chem. Inf. Model, 49,
152571534.

Saigo,H. et al. (2010) Reaction graph kernels predict EC numbers of unknown
enzymatic reactions in plant secondary metabolism. BMC Bioinformatics, 11,
S31.

Steinbeck,C. et al. (2003) The Chemistry Development Kit (CDK): an open—source
Java library for chemo— and bioinformatics. J. Chem. Inf. Compat. Sci., 43,
4937500.

Tohsato,Y. et al. (2000) A multiple alignment algorithm for metabolic pathway
analysis using enzyme hierarchy. Proc. Int. Conf. Intell. Syst. Mol. Biol, 2000,
37(r383.

Tonnelier,C. et al. (1991) Machine learning of generic reactions: 3. An efficient
algorithm for maximal common substructure determination. Tetrahedron
Comput. Methodol, 3, 3517358.

Vapnik,V.N. (1998) Statistical Learning Theory. Wiley, New York.

Wang,Y. and Liu,X. (2011) Prediction of silicon content in hot metal based on SVM
and mutual information for feature selection. J. Inf. Comput. Sci., 8, 42754283.

Yamanishi,Y. et al. (2009) E—zyme: Predicting potential EC numbers from the
chemical transformation pattern of substrate—product pairs. Bioinﬁ)rmatics, 25,
11797186.

You,M.Z. et al. (2011) MAPLSC: A novel multi-class classiﬁer for medical diag—
nosis. Int. J. Data Min. Bioinf., 5, 383401.

Yu,C. et al. (2009) Genome—wide enzyme annotation with precision control:
Catalytic families (CatFam) databases. Proteins, 74, 449460.

 

372

ﬁle'sreumoi‘pmjxo'sopnuuopnotq/ﬁdnq

