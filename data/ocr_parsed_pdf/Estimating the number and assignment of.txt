Bioinformatics, 3219), 2016, 1281—1285

doi: 10.1093/bioinformatics/btw005

Advance Access Publication Date: 6 January 2016
Discovery Note

 

Phylogenetics

Estimating the number and assignment of clock
models in analyses of multigene datasets

Sebastian Duchéne1'2'*, Charles S. P. Foster1 and Simon Y. W. Ho1

1School of Life and Environmental Sciences and 2Sydney Medical School, University of Sydney, Sydney, NSW
2006, Australia

*To whom correspondence should be addressed.
Associate Editor: David Posada

Received on 16 September 2015; revised on 3 January 2016; accepted on 4 January 2016

Abstract

Motivation: Molecular—clock methods can be used to estimate evolutionary rates and timescales
from DNA sequence data. However, different genes can display different patterns of rate variation
across lineages, calling for the employment of multiple clock models. Selecting the optimal clock—
partitioning scheme for a multigene dataset can be computationally demanding, but clustering
methods provide a feasible alternative. We investigated the performance of different clustering
methods using data from chloroplast genomes and data generated by simulation.

Results: Our results show that mixture models provide a useful alternative to traditional partition—
ing algorithms. We found only a small number of distinct patterns of among—lineage rate variation
among chloroplast genes, which were consistent across taxonomic scales. This suggests that the
evolution of chloroplast genes has been governed by a small number of genomic pacemakers. Our
study also demonstrates that clustering methods provide an efficient means of identifying clock—
partitioning schemes for genome—scale datasets.

Availability and implementation: The code and data sets used in this study are available online at

 

https://github.com/sebastia nd uchene/pacemake riclusteri ngimethods.

Contact: sebastian.duchene@sydney.edu.au

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Evolutionary rates and timescales can be estimated from nucleotide
sequences using molecular-clock models, which describe the pattern
of rate variation among lineages. The various clock models share a
reliance on age calibrations, but they differ in their assumptions
about the number and distribution of distinct evolutionary rates (re-
viewed by Ho and Duchene, 2014). For example, the strict molecu-
lar clock assumes a single rate across all lineages (Zuckerkandl and
Pauling, 1962), whereas uncorrelated relaxed clocks allow branches
to have distinct rates that are drawn from the same distribution
(Drummond et (11., 2006; Rannala and Yang, 2007). There are vari-
ous model-selection methods for identifying the best-fitting clock
model for a dataset of interest (e.g. using marginal likelihoods; Baele
et (11., 2013). The choice of clock model can have substantial impacts
on phylogenetic estimates, particularly those of evolutionary rates
and timescales.

Rates of molecular evolution often vary among lineages, but this
pattern of variation can differ across sites and across genes (Gaut
et (11., 2011; Muse and Gaut, 1997). Therefore, when complex se-
quence data are being analyzed, the use of multiple clock models
might provide a better fit (e.g. higher marginal likelihood) than a
single clock model. For example, separate clock models might be
applied to different genes or codon positions.

In analyses of multigene datasets, there are usually many possible
partitioning schemes. Identifying the best-fitting schemes involves
two components: determining the optimal number of clusters, and
assigning the genes to these clusters. In Bayesian analyses, this can
be done using Bayes factors to compare different clock-partitioning
schemes (Ho and Lanfear, 2010). However, such an approach is im-
practical when there are many candidate schemes, as is often the
case for multigene or genome-scale datasets, because the statistical
fit of every possible scheme would need to be assessed.

(6) The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1281

/310‘sreumo[p10}xo‘soueuHOJIItotq/ﬁdnq

1282

S.Duchéne et al.

 

Clustering methods provide a computationally feasible means of
identifying appropriate clock—partitioning schemes, by grouping
subsets of the data according to their pattern of among—lineage rate
variation (Duchéne et al., 2014). Similar approaches are available
for selecting partitioning schemes for substitution models (Frandsen
et al., 2015 ). The software ClockstaR, which was designed to iden—
tify the best—fitting clock—partitioning scheme for multigene datasets
(Duchéne et al., 2014), employs a k—medoids clustering algorithm
known as partitioning around medoids (Kaufman and Rousseeuw,
2005). However, other clustering methods, such as k—means and
Gaussian mixture modeling, have not been tested in the context of
clock—model selection. One advantage of Gaussian mixture models
is that they can represent the shapes of clusters flexibly by using c0—
variance matrices. For example, they can use a diagonal covariance
matrix to identify clusters with ellipsoidal shapes, such that they
might have higher accuracy than k—medoids.

Here we test the performance of three different clustering meth—
ods for identifying the clusters of patterns of among—lineage rate
variation in multigene datasets: variational inference Gaussian mix—
ture model (VBGMM), Dirichlet process Gaussian mixture model
(DPGMM), and partitioning around medoids (PAM). We evaluate
these three methods using simulated data and apply them to chloro—
plast genome sequences from angiosperms. We find that the optimal
number of clusters for these datasets range from one to three. Our
results also reveal that mixture models, such as VBGMM and
DPGMM, tend to detect a larger number of clusters than methods
based on partitioning, such as PAM. Mixture models also appear to
be more robust than PAM in that they can detect the correct number
of clusters in a broader range of simulation conditions.

2 Methods

2.1 Clustering methods
We compared the performance of three different methods: VBGMM
and DPGMM, as implemented in the Python module Scikit—learn
v0.16 (Pedregosa et al., 2012), and PAM implemented in the R
package Cluster v1.15 (Maechler et al., 2005). The PAM algorithm,
also known as k—medoids, is very similar to the k—means algorithm.
It involves randomly choosing k data points from the data, known
as the ‘medoids’. The remaining data points are assigned to their
closest medoid to form k clusters. In the next step, the medoids are
replaced by the data points that are closest to the center of each clus—
ter, resulting in new medoids. The data points are reassigned to the
new medoids. The last two steps are repeated until the medoids are
the same for successive iterations. To select the optimal value of k,
we use the Gap statistic, which uses the ratio of cluster width to dis—
tance between clusters, as a measure of goodness—of—fit (Tibshirani
et al., 2001). In our analyses, each cluster represents a group of
genes that have similar patterns of among—lineage rate variation.
The VBGMM and DPGMM assume that the data were gener—
ated from a mixture of Gaussian probability distributions, also
known as ‘components’, with unknown parameters. Both of these
methods incorporate information about the covariance structure of
the data. The most commonly used are the spherical and the diag—
onal covariance matrices. The spherical covariance matrix assumes
that each cluster has the same variance across dimensions, resulting
in spherical clusters. In contrast, in the diagonal covariance matrix
the variance can differ among dimensions, such that clusters can
take ellipsoidal shapes. The number of components for VBGMM is
finite, so they need to be specified a priori. To select the optimal
value, we calculate the Bayesian Information Criterion (BIC) for

values of k from 1 to 11—1, where n is the number of data points. In
DPGMM, the number of components is infinite, but the number of
clusters to which the data are assigned is defined by a Dirichlet pro—
cess. In practice, the implementation of DPGMM requires an upper
bound for the number of components, which we set as n— 1. For
both the VBGMM and the DPGMM algorithms, we used the BIC to
compare the fit of diagonal and spherical covariance matrices.
However, the BIC cannot be computed for PAM, such that the per—
formance of this method cannot be assessed using this metric.

2.2 Chloroplast genome data

We obtained complete chloroplast genome sequences of angio—
sperms from GenBank (accession numbers in Supplementary Table
51). The advantage of analyzing genes from the non—recombining
chloroplast genome is that they all share the same topology, which
is an important requirement of these methods. We initially aligned
all protein—coding genes using MUSCLE v3.5 (Edgar, 2004), fol—
lowed by visual inspection. Three genes (ian, ycfl and ycf2) were
excluded because of alignment ambiguities, leaving 76 genes for sub—
sequent analysis, although this number varied among taxonomic
groups. To reduce potential impacts of missing data, we excluded
any sites in the alignment at which a gap was present for 280% of
taxa.

Our initial dataset contained 183 taxa, including representatives
of all major angiosperm groups. We drew subsamples to form five
datasets representing different taxonomic levels: (i) angiosperms (18
taxa); (ii) eudicots (15 taxa); (iii) rosids (13 taxa); (iv) Poaceae (20
taxa); and (v) Asteraceae (7 taxa). For the Poaceae and Asteraceae
datasets, some gene alignments consisted primarily of missing data,
so we removed these alignments and used 61 and 74 genes, respect—
ively, instead of the 76 genes in the complete set of gene alignments.
For each of the five taxonomic datasets, we concatenated all of the
genes to infer the topology using maximum likelihood in PhyML
v3.1 (Guindon et al., 2010) with the GTR+F nucleotide substitution
model. We then estimated individual gene trees while constraining
the tree topology to that inferred from the concatenated data, which
is equivalent to optimizing the branch lengths.

Clustering algorithms typically cluster data points represented in
an n—dimensional space. Previous studies have used individual
branch lengths as dimensions in which to represent gene trees as
data points (e.g. dos Reis et al., 2012; Duchéne et al., 2014;
Duchéne and Ho, 2015). We used the same approach by treating the
branch lengths as a proportion of the total tree length and using a
logm transformation. Our empirical data and example code are
available online (https://github.com/sebastianduchene/pacemaker_
clustering_methods).

2.3 Simulations

To test the performance of the clustering methods under known con—
ditions, we first generated datasets by simulating data points using
the mixture model with the highest fit according to the BIC. This
involved sampling data points from the mixture of distributions
inferred by the model. We also simulated data under optimal condi—
tions for the PAM algorithm. To do this, we estimated the mean and
standard deviation of each dimension for each cluster inferred using
the mixture models to represent the clusters as multivariate normal
distributions. We then sampled data points from these distributions.
In both simulation scenarios, the simulations have the same dimen—
sions as the chloroplast genome data described above, but they differ
in the shape and spread of the clusters. We conducted 100 simula—
tions for each of the chloroplast datasets and analyzed them using

ﬁm'sreumol‘prqxo'sopcuuowtotq/ﬁdnq

 

Table 1
Fig. 1
Supplementary Fig. S1

Table 2

Table 2

/310‘sreumo[p10}xo‘sopeuuorutotq/ﬁdnq

1284

S.Duchéne et al.

 

Table 2. Estimated number of clusters (k) of branch-length patterns
among genes in simulated datasets

 

 

Dataset True k kmixmre Frequency kpAM Frequency
0f kmixture 0f kPAM
VB GMM simulations
Angiosperms 1 1 1.00 1 1.00
Poaceae 2 2 1.00 5 0.66
Eudicots 2 2 1.00 7 0.30
Asteraceae 3 3 0.69 7 0.20
Rosids 2 2 0.97 8 0.32
PAM simulations
Angiosperms 1 1 1.00 1 1.00
Poaceae 2 2 1.00 2 1.00
Eudicots 2 2 1.00 2 1 .00
Asteraceae 3 3 1.00 3 1 .00
Rosids 2 2 1.00 2 1 .00

 

Results are based on analyses of 100 simulations under the model ﬁtted to
each of the ﬁve chloroplast datasets. In all cases, the most frequently chosen
mixture model was the VGBMM with a spherical covariance matrix (fre-
quency of 1.00). kmmum is the most frequent 1: for analyses of the data simu-
lated using mixture models. lap/(M is the most frequent I: for the analyses using
the PAM algorithm, with its corresponding frequency.

analyses of simulated data show that mixture models and the PAM
algorithm perform well when the model used to generate the data
matches that used to infer the number of clusters. However, mixture
models performed well even when the data were simulated using a
scenario based on PAM, such that they provide more robust
estimates.

4 Discussion

We investigated the performance of three different clustering meth—
ods for grouping genes according to their pattern among—lineage
rate variation. We have found that the VBGMM with a spherical c0—
variance matrix provides the best fit among the mixture models to a
range of chloroplast datasets, and our simulation study confirms the
stability of this method. The PAM algorithm failed to recover the
simulation conditions under VBGMM in most cases, probably be—
cause the shape of the clusters is difficult to capture using this
method. In contrast, VBGMM frequently estimated the correct
number of clusters irrespective of the simulation method. This dif—
fers from the results of previous studies of clustering methods for
branch—length patterns, which found that the PAM algorithm ap—
peared to perform well (Duchéne and Ho, 2014, 2015; Duchéne
et al., 2014). However, we reanalyzed a mammalian genome dataset
from our previous study (Duchéne and Ho, 2015) and found a simi—
lar number of clusters (Supplementary Material); the most stable
mixture model (DPGMM) supported seven clusters, compared with
13 using PAM in the original study. This suggests that, in empirical
studies, it is important to compare the inferences from different clus—
tering algorithms. In this study, for example, the estimated numbers
of clusters for the empirical data are very similar among clustering
algorithms. We find that mixture models provide a powerful alter—
native that can flexibly accommodate different cluster shapes. The
results from these models also appear more stable under different
simulation conditions, at least for the datasets analyzed here.
Another advantage of these methods is that their parametric nature
offers a simple framework for conducting simulations, which should
be done routinely to assess the robustness of the results.
Importantly, the shape of the clusters and choice of covariance

structure do not necessarily have biological implications. Rather,
they provide a convenient mathematical description of the cluster
shapes.

The clusters identified in our analyses represent groups of genes
that have similar patterns of among—lineage rate variation. All of the
clustering algorithms suggest that the evolution of chloroplast gen—
omes in angiosperms and nuclear genomes in mammals has been
governed by a small number of pacemakers, each of which leads to a
distinct pattern of rate variation among lineages (Ho, 2014; Snir
et al., 2012). This is consistent with previous findings from prokary—
otes (Snir, 2014), Drosophila, and yeast (Snir et al., 2014).
Furthermore, comparing the gene clusters across our five angio—
sperm datasets reveals that there is some consistency in pacemakers
across different taxonomic scales (Fig. 1). However, additional
work will be needed to understand the biological bases of these
pacemakers.

Identifying genes with similar patterns of among—lineage rate
variation has important applications in phylogenetic analyses.
Notably, in molecular dating studies, estimates of divergence times
have been shown to be more accurate if a separate relaxed—clock
model is assigned to each cluster of genes (Duchéne and H0, 2014).
Our results indicate that multigene datasets might only exhibit a
small number of distinct patterns of rate variation among lineages.
This has notable implications for analyses of genome—scale datasets,
for which only a small number of relaxed—clock models might be
sufficient to capture the key components of evolutionary rate vari—
ation. To this end, clustering methods provide a feasible and reliable
alternative to more computationally demanding approaches to se—
lecting clock—partitioning schemes for molecular dating analyses. In
particular, mixture models might have better performance than the
k—medoids and k—means algorithms for genomic data because they
can model clusters of different shapes. Increasing the adoption of
these methods will help to improve estimates of evolutionary rates
and timescales from genome—scale datasets.

Funding

C.S.P.F. was supported by the Australian Award. S.Y.W.H. was supported by
the Australian Research Council (grant DP110100383).

Conﬂict of Interest: Home declared.

References

Baele,G. et al. (2013) Accurate model selection of relaxed molecular clocks in
Bayesian phylogenetics. Mol. Biol. Evol., 30, 239—243.

dos Reis,M. et al. (2012) Phylogenomic datasets provide both precision and
accuracy in estimating the timescale of placental mammal phylogeny. P706.
R. SOC. Lond. B, 279, 3491—3500.

Drummond,A.]. et al. (2006) Relaxed phylogenetics and dating with conﬁ-
dence. PLOS Biol., 4, 699—710.

Duchene,S. et al. (2014) ClockstaR: choosing the number of relaxed-clock
models in molecular phylogenetic analysis. Bioinformatics, 30, 1017—1019.

Duchene,S. and Ho,S.Y.W. (2014) Using multiple relaxed-clock models to es-
timate evolutionary timescales from DNA sequence data. Mol. Phylogenet.
Evol., 77, 65—70.

Duchene,S. and Ho,S.Y.W. (2015) Mammalian genome evolution is governed
by multiple pacemakers. Bioinformatics, 31, 2061—2065.

Edgar,R.C. (2004) MUSCLE: multiple sequence alignment with high accuracy
and high throughput. Nucleic Acids Res., 32, 1792—1797.

Frandsen,P.B. et al. (2015) Automatic selection of partitioning schemes for
phylogenetic analyses using k-means clustering of site rates. BMC Evol.
Biol.,15, 13.

ﬁm'sreumol‘prqxo'sopcuuowtotq/ﬁdnq

Estimating the number and assignment of clock models

1285

 

Gaut,B. et al. (2011) The patterns and causes of variation in plant nucleotide
substitution rates. Annu. Rev. Ecol. Evol. Syst., 42, 245—266.

Guindon,S. et al. (2010) New algorithms and methods to estimate maximum
likelihood phylogenies: assessing the performance of PhyML 3.0. Syst. Biol.,
59, 307—321.

Ho,S.Y.W. (2014) The changing face of the molecular evolutionary clock.
Trends Ecol. Evol., 29, 496—503.

Ho,S.Y.W. and Duchene,S. (2014) Molecular-clock methods for estimating
evolutionary rates and timescales. Mol. Ecol., 23, 5947—5965.

Ho,S.Y.W. and Lanfear,R. (2010) Improved characterisation of among-lin-
eage rate variation in cetacean mitogenomes using codon-partitioned
relaxed clocks. Mitochondr. DNA, 21, 138—146.

Kaufman,L. and Rousseeuw,P.J. (2005) Finding Groups in Data: An
Introduction to Cluster Analysis. 1st edn. Wiley, Hoboken, NJ, USA.

Maechler,M. et al. (2005) Cluster Analysis Basics and Extensions. R Statistics
Package.

Muse,S.V. and Gaut,B.S. (1997) Comparing patterns of nucleotide substitution rates
among chloroplast loci using the relative ratio test. Genetics, 146, 393—399.

Pedregosa,F. et al. (2012) Scikit-learn: machine learning in Python.  Mach.
Learn. Res., 12, 2825—2830.

Rannala,B. and Yang,Z. (2007) Inferring speciation times under an episodic
molecular clock. Syst. Biol., 56, 453—466.

Snir,S. (2014) On the number of genomic pacemakers: a geometric approach.
Algorithms Mol. Biol., 9, 26.

Snir,S. et al. (2012) Universal pacemaker of genome evolution. PLOS
Comput. Biol., 8, e1002785.

Snir,S. et al. (2014) Universal pacemaker of genome evolution in animals and
fungi and variation of evolutionary rates in diverse organisms. Genome
Biol., 6,1268—1278.

Tibshirani,R. et al. (2001) Estimating the number of clusters in a data set
via the gap statistic. ]. R. Stat. Soc. Ser. B (Statistical Methodol.), 63,
411—423.

Zuckerkandl,E. and Pauling,L. (1962) Molecular disease, evolution and genic
heterogeneity. In: Kasha,M. and Pullman,B. (eds.) Horizons in
Biochemistry. Academic Press, New York, pp. 189—225.

/810'sreumofp103xo'sopeuiJOJutotq”:duq

