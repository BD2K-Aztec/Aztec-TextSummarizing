ORIGINAL PAPER

Vol. 30 no. 5 2014, pages 601-605
doi:1 0. 1093/bioinfonnatics/btt5 75

 

Genome analysis

Advance Access publication October 9, 2013

Robust adjustment of sequence tag abundance

Douglas D. BaumannT and Rebecca W. Doerge*
Department of Statistics, Purdue University, West Lafayette, IN 47907, USA

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: The majority of next-generation sequencing technologies
effectively sample small amounts of DNA or RNA that are amplified
(i.e. copied) before sequencing. The amplification process is not per-
fect, leading to extreme bias in sequenced read counts. We present a
novel procedure to account for amplification bias and demonstrate its
effectiveness in mitigating gene length dependence when estimating
true gene expression.

Results: We tested the proposed method on simulated and real data.
Simulations indicated that our method captures true gene expression
more effectively than classic censoring-based approaches and leads
to power gains in differential expression testing, particularly for shorter
genes with high transcription rates. We applied our method to an
unreplicated Arabidopsis RNA-seq dataset resulting in disparate
gene ontologies arising from gene set enrichment analyses.
Availability and implementation: R code to perform the RASTA pro-
cedures is freely available on the web at www.stat.purdue.edu/
~doerge/.

Contact: doerge@purdue.edu

Received on June 4, 2013; revised on September 19, 2013; accepted
on September 27, 2013

1 INTRODUCTION

One cause of technical variation in next-generation sequencing
(NGS) studies is ampliﬁcation bias. Fragmented complementary
DNA is subjected to ampliﬁcation Via polymerase chain reaction
in all NGS applications (Bennet, 2004; Mardis, 2008; Margulies
et al., 2005). The ampliﬁcation process is not perfect, and reads
can suffer from amplification bias (Chepelev et al., 2009). This
means that there may be extra copies of certain reads, perhaps
tens of thousands of extra copies. The typical statistical proced-
ure to correct for this bias is to ignore any duplicate reads by
limiting the number of reads starting at the same base to be one
read. This censoring procedure, herein referred to as ‘Censoring’,
ignores the possibility of natural read duplication (multiple
copies of the same read that is not due to amplification bias)
and thus underestimates true read count. For example, in the
human liver samples analyzed by Marioni et al. (2008),
l(%lS% of the genic bases exhibited duplication, accounting
for ~30% of the observed reads. Although approximately only
1% of the bases exhibited >10 duplicated reads, the number of
reads starting at these bases comprised ~10% of the total reads.
The prevalence of duplicated reads in these samples illustrates

 

*To whom correspondence should be addressed.
7‘Present address: Department of Mathematics, University of Wisconsin -
La Crosse, La Crosse, WI 54601.

the need for statistical methods that are able to correct for amp-
lification bias without needlessly censoring natural duplication.

The effects of Censoring on gene expression depend primarily
on gene length and rate of transcription. Under Censoring, at
most only one read is considered to originate from each nucleo-
tide in a gene. This artiﬁcially limits the estimate of gene expres-
sion to values less than or equal to gene length. Assuming that
the sonication process randomly fractionates the messenger
RNA (mRNA), the expected occurrence of natural read dupli-
cation decreases as gene length increases for a given level of gene
expression. Thus, the effects of Censoring decrease as gene length
increases. Conversely, for a given gene, the effects of Censoring
are more pronounced when gene transcription increases or when
the total number of reads increases. In these cases, the sensitivity
to detect differences between genes of short length is typically
lower than that for longer genes when reads are censored. This
length bias can be dramatically reduced when natural read
duplication is allowed, as the dependence on gene length is
mitigated.

We present a novel approach to correct for ampliﬁcation bias
while allowing for natural duplication. The proposed method,
Robust Adjustment of Sequence Tag Abundance (RASTA), ac-
curately estimates true tag abundance by separating legitimate
reads from incorrectly ampliﬁed reads through a novel applica-
tion of hierarchical clustering. Further, it sets appropriate thresh-
olds for the ampliﬁed reads through a novel application of the
zero-truncated Poisson (ZTP) distribution. The impact of prop-
erly accounting for ampliﬁcation bias using RASTA when test-
ing for differential gene expression testing, both in terms of
power and ranking of results, are investigated.

2 METHODS

Observed RNA-seq reads are assumed to be generated by two distinct
processes: legitimate reads (including natural duplication) and ampliﬁca-
tion bias. For a given mapped read, we deﬁne ‘read count’ as the number
of observed mapped reads that start at the same base in the genome. Let
x? be the read counts for base i = l, . . . , n for a given gene g, where n is
the number of bases with observed reads in gene g. Given that the  are
generated by two distinct processes, the goal in correctly accounting for
ampliﬁcation bias is to accurately classify each  into legitimate and
erroneous clusters.

RASTA approaches this goal in two steps: hierarchical clustering and
distributional approximation. Hierarchical clustering, using complete
linkage and Canberra distance (Lance and Williams, 1966), is used to
cluster the read counts into two distinct groups. Because NGS gene ex-
pression studies produce discrete read counts, clustering is performed on
the unique read count values. Let (Sg, H.355), where m 5 n, be the
unique read counts values corresponding to (x‘f, ...,x5) for gene g.

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 601

112 /310's112u1n0[p10}x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIII/lAOG

91oz ‘Og isanV uo ::

D.D.Baumann and R.W.Doerge

 

The Canberra distance for two unique read counts (Sf, Sf) is deﬁned as
follows:

___ IS? -%‘fl
'1 ‘ IS§+5fl

 

(1)

In practical settings and simulations m <<n, thus providing a marked
computational time improvement over traditional clustering algorithms
based on all read counts.

To estimate the distribution of the legitimate reads for each gene g, we
assume that the sonication and selection process (Bennet, 2004) randomly
fragments the mRNA. Given this random fragmentation process, let 
be the read counts for the n legitimate bases with observed reads for a
given gene g. Because  are restricted to be positive only, the legitimate
base counts for a given gene are modeled using a zero-truncated
Poisson(y;) (ZTP) distribution via the vector generalized linear and addi-
tive models package (Y ee, 2010) in R (R Core Development Team, 2011).

For an estimated value of 17;, a threshold 7: can be deﬁned such that
any counts >7: at a given base location can be considered to be a result
of ampliﬁcation bias. Here, Tk is deﬁned as the 95* percentile of the

g
ZTP(y;) distribution. Then, for each , deﬁne

y? = mimxf. 7:) (2)
and the digital gene expression (DGE) estimate for gene g is deﬁned as

DGEg = Zn?- (3)

3 SIMULATION

3.1 Simulation design

A simulation study was conducted to evaluate and compare the

performance of RASTA with ‘Censoring’. For 1000 genes, gene

counts were simulated following Auer and Doerge (2011) with

the following modiﬁcations: ampliﬁcation bias was incorporated
bias

by setting the prevalence of bias to 71g 2 .05 (or 1 of every 1000

bases) and the bias DGE count to
bias -
Ag ~ exp(Pozsson(A = 4)) (4)

for each of the 1000 genes. The value of 712W and the distribution
of A?” are based on the Arabidopsis samples sequenced in Lister
et a]. 2008. Gene lengths were also simulated based on
Arabidopsis with

Lg ~ exp(N0rmaI(/1. = 7, a =  (5)

For a given gene with parameters Ag and AS”, the legitimate
reads follow

A
P0isson(yg = L—g) (6)
g

and the counts arising from amplification bias follow

bias

P0isson(7r:m  (7)

For each gene, these counts were preprocessed by either truncat-
ing all counts to one (the current Censoring practice) or Via
RASTA, in addition to investigating the uncorrected data.
These counts were then summed, giving rise to three separate
DGE values for each gene. This process was repeated 500

times to account for simulation-to-simulation (sampling)
variability.

For the 1000 simulated genes, both non-differentially ex-
pressed (500) and differentially expressed (500) genes were gen-
erated for three replicates in two treatments. DGE rates for each
gene were generated [Equations (6) and (7)] with the following
modiﬁcations: for differentially expressed genes, means were
sampled separately from (6), yielding A? and A? for treatments
T1 and T2; for non-differentially expressed genes, the means were
sampled together (Ag). In addition, bias prevalence was set at
ngia‘Y(T1)=.05 and ngla‘lm) = .02 for the two treatments. For
each simulated dataset, we applied RASTA and ‘Censoring’ to
the observed base counts. The adjusted gene counts were ana-
lyzed for differential expression using the exact negative binomial
model in edgeR under a common dispersion assumption
(Robinson and Smyth, 2008). P—Values were adjusted using the
BenjaminiiHochberg false discovery rate (FDR) procedure in
edgeR (Benjamini and Hochberg, 1995).

3.2 Simulation results

Genewise log fold changes, as estimated by edgeR, were com-
pared against simulated true log fold changes across the 1000
genes in each simulation. RASTA yields the greatest correlation
between estimated and true values (r = 0.52), compared with the
correlations yielded by uncorrected (r2032) and censored
(r = 0.29) data. To assess the effects of gene length on differential
expression estimates, adjusted P—Values and gene length were
compared using 2D histograms (Fig. l) for each of the three
read count adjustment methods (Censoring, RASTA, No
Correction). By more accurately estimating DGE using
RASTA, especially for shorter genes with high DGE, RASTA
is able to all but eliminate length bias in these simulations.

4 APPLICATION TO ARABIDOPSIS

4.1 Materials and methods

The Censoring and RASTA approaches were used to preprocess
the unreplicated Arabidopsis RNA-seq data from Lister et a].
(2008) and were compared with uncorrected read counts. In
this study, metI-3 mutants (deﬁcient in methylation) were com-
pared with wild-type (Col-0) controls. Gene start and stop loca-
tions were used to deﬁne 22 266 annotated genomic regions and

Censoring RASTA N0 Correction

Adjusted Main-s Hoglﬂ scale)

 

Gene Lengths (i092 scale)

Fig. 1. Gene length bias simulation results. FDR-adjusted P-values are
compared against corresponding gene lengths for each of the three read
count adjustment methods (Censoring, RASTA, No Correction). The
Censoring approach displays a bias of signiﬁcant P-values toward
longer genes. This bias is not evident in the RASTA and No
Correction P-values, though RASTA allowed for more signiﬁcant test
results

 

602

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papBOIH/noq

9103 ‘Og isanV uo ::

RASTA

 

Table 1. Distribution of read duplication for the unreplicated met1-3 and
Col-0 Arabidopsis lines in Lister et a]. (2008)

 

 

Read Count Information met1-3 Col-0

Total reads 5 997 689 6 283 230
Unique reads 2 991 256 1264135
Single bases with 3 5 reads 139 972 285610
Single bases with 3 10 reads 38 718 72 227
Single bases with 3 100 reads 232 849
Maximum number of reads at 5525 17063

a single base

 

Note: The Col—0 wild—type sample displays considerably more duplication than the
metl—3 mutants at each of the levels presented.

were based on the Columbia reference genome gained from The
Arabidopsis Information Resource [TAIR, Swarbreck et a].
(2008)]. Although the total number of mapped reads for the
metI-3 and Col-0 samples were approximately equal (5997 689
and 6283 230, respectively), the occurrence of read duplication,
either from natural duplication or ampliﬁcation bias, was dra-
matically different between the two samples (Table 1).

Gene counts under each of the control procedures were ana-
lyzed using the exact negative binomial model in edgeR
(Robinson and Smyth, 2008). P-Values were adjusted using
the BenjaminiiHochberg FDR procedure (Benjamini and
Hochberg, 1995), and the nominal signiﬁcance threshold was
set at a = 0.01. Gene set enrichment analysis (GSEA) was per-
formed on the resulting lists of signiﬁcant genes using agriGO
(Berg et al., 2009; Du et al., 2010). The agriGO toolkit performs
GSEA based on a hypergeometric distribution to assess the over-
or underrepresentation of gene ontologies in the lists of signiﬁ-
cant genes when compared with all genes with annotated
ontologies and corrects for multiple testing using FDR under
dependence assumptions (Benjamini and Yekutieli, 2001). The
collection of gene ontologies for each differentially expressed
gene is collated, and if the proportion of a particular ontology
in the differentially expressed genes is significantly different
(higher or lower) than the corresponding proportion in the
entire gene set, that function is reported in agriGO.

4.2 Results

The presence of DNA methylation typically serves as a transcrip-
tional regulator in eukaryote species; when depleted, gene tran-
scription typically increases (Riggs, 1975; Robertson, 2005;
Shames et al., 2007). The RASTA and No Correction
approaches yielded many more statistically signiﬁcant differen-
tially expressed genes than the Censoring method (8912, 9366
and 2855 genes, respectively). This increase is in concordance
with the biological knowledge that when comparing the two
Arabidopsis lines, metI-3 is deﬁcient in methylation maintenance
that reduces the degree of gene regulation (Lister et al., 2008).
The differentially expressed genes vary between the three
approaches, though nearly all of signiﬁcant genes yielded by
the Censoring approach were also found in the other two
approaches. In addition, the RASTA and uncorrected

  

Censoring Uncorrected

500

Frequency
300

 

0 100

 

Gene Lengths (I092 scale)

Fig. 2. Distribution of signiﬁcantly differentially expressed genes under
Censoring (red), RASTA (blue) and No Correction (orange) ampliﬁca-
tion bias controls procedures for the unreplicated met1-3 and Col-0
Arabidopsis lines in Lister et a]. (2008). The RASTA and uncorrected
approaches both yielded many more signiﬁcant results than the
Censoring method, and these signiﬁcant genes were shorter on average
than the Censoring results

approaches yielded more signiﬁcant genes with shorter length
than did the Censoring approach (Fig. 2). The agriGO GSEA
results based on the three gene lists (Table 2) display a stark
contrast in enriched gene ontologies, indicating that appropriate
ampliﬁcation bias control is important for discovery and down-
stream conﬁrmation studies. In fact, of the top ten signiﬁcant
ontologies produced by each approach, only two are similar
between the Censoring and RASTA, and only six are similar
between RASTA and No Correction.

5 DISCUSSION

Accurately estimating DGE, and subsequently differential gene
expression, is a primary challenge in next-generation RNA
sequencing studies. One of the key sources for technical variation
between samples, and between or within treatments, is amplifi-
cation bias. Controlling for this bias not only improves the ac-
curacy of DGE estimates, it dramatically changes downstream
analyses. Because conﬁrmatory studies often target the most stat-
istically signiﬁcant differentially expressed genes (i.e. the genes
with the lowest P—Values), the ordering of results plays an
important role in downstream analyses.

As the costs for sequencing decrease, we anticipate that re-
searchers will want a greater number of sequenced reads to
more accurately detect differences in expression levels between
treatments. This scenario provides some cause for caution, as

 

603

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq mm; papeoIH/noq

9IOZ ‘OE ISUEHV Ho ::

D.D.Baumann and R.W.Doerge

 

Table 2. GSEA results (top ﬁve ontologies) from the agriGO toolkit
under Censoring, RASTA and No Correction ampliﬁcation bias control
procedures for the unreplicated met1-3 and Col-0 Arabidopsis lines in
Lister et a]. (2008)

 

 

Gene Ontology Ontology description Adjusted

term P-value

Censoring

GO:0009628 Response to abiotic stimulus 2.2e-19

GO:0050896 Response to stimulus 8.2e-17

GO:0009791 Post-embryonic development 1.6e-16

GO:0006950 Response to stress 3e-16

GO:0044262 Cellular carbohydrate metabolic 3.3e-16
process

RASTA

GO:0009791 Post-embryonic development 4.2e-76

GO:0034641 Cellular nitrogen compound 5.7e-33
metabolic process

GO:0032501 Multicellular organismal process 2.4e-24

GO:0009987 Cellular process 5.9e-24

GO:0007275 Multicellular organismal 1.4e-23
development

No correction

GO:0009791 Post-embryonic development 1.4e-80

GO:0034641 Cellular nitrogen compound 1.6e-40
metabolic process

GO:0010035 Response to inorganic substance 1.1e-30

GO:0009987 Cellular process 1.1e-29

GO:0006950 Response to stress 6.3e-23

 

Note: The ‘G0 Term’ and ‘Description’ columns represent the gene ontologies en—
riched in the signiﬁcant gene lists when compared with all Arabidopsis gene ontolo—
gies. The P—values are based on the hypergeometric distribution and are adjusted via
FDR under dependence (Benjamini and Yekutieli, 2001). The resulting enriched
ontologies for the Censoring and RASTA approaches are disparate, whereas the
RASTA and No Correction approach several similar ontologies. These results indi—
cate that the control procedure is highly influential in downstream analyses.

blindly seeking high read counts invites the possibility of over-
ampliﬁcation to achieve a particular observed sequencing depth
or coverage. If sequenced reads are systematically over-ampli-
ﬁed, as is the case in Shiroguchi et a]. (2012), the hierarchical
clustering used in RASTA erroneously classiﬁes many amplified
reads as legitimate, therein overestimating true read counts. In
these cases, researchers are relegated to only two approaches:
Digital RNA Sequencing [DRS, (Shiroguchi et al., 2012)],
when the additional ampliﬁcation is expected before sequencing,
and Censoring, when the ampliﬁcation is not planned. DRS is a
promising biological approach to account for ampliﬁcation bias,
but its use comes at signiﬁcant cost to the researcher. First, it
requires greater sequencing depth than conventional RNA-seq
studies to effectively sample read/barcode pairs. Secondly, DRS
prohibits barcoding for efﬁcient sequencing. Where several sam-
ples could be sequenced in the same lane using sample-speciﬁc
barcodes normally, the DRS procedure requires separate lanes
for each sample. Finally, at least in the Escherichia coli data from
Shiroguchi et a]. (2012), the extra time and sequencing costs
associated with DRS could be eliminated by just using the
Censoring approach, as both approaches yield similar results in
these data. This would be true when reads are systematically

over-ampliﬁed in general. However, the Censoring approach is
insensitive to natural read duplication, which in turn results in an
underestimation of true DGE when reads are actually naturally
duplicated.

Achieving greater sequencing depth can be done correctly,
without limiting the choice in ampliﬁcation bias control proced-
ures, simply by using a larger sample of mRNA from subjects.
As sequencing depth increases due to larger biological samples of
mRNA, the occurrence of legitimately duplicated reads will in-
crease. Assuming that reasonable amplification is used before
sequencing, the proposed RASTA approach is well suited to ac-
count for ampliﬁcation bias even in the context of increased
natural read duplication. In these settings, the Censoring ap-
proach will consistently underestimate the true DGE; on the
other hand, the DRS approach is likely to produce similar results
to RASTA, though with greater restrictions and increased
sequencing cost.

The clustering and distributional considerations made in
RASTA assume that the mRNA fragmentation process is
random, and the ampliﬁcation process is unbiased to genomic
content. These assumptions may be violated under GC ampliﬁ-
cation bias, differential isoform expression or genomic sonication
bias. In these cases, the ZTP distribution used in RASTA could
be replaced by a similarly formed zero-truncated negative
binomial (ZTNB) distribution. When the ZTNB distribution
was applied to simulated data and the Lister et a]. (2008)
Arabidopsis data, the resulting model ﬁts were similar to the
ZTP model ﬁts, and the analyses took nearly three times
longer when using the ZTNB parameterization. However, the
negative binomial approach may be more applicable in other
datasets and is a straightforward extension to RASTA. In add-
ition, the hierarchical clustering and ZTP/ZTNB estimation pro-
cedures used in RASTA could serve as a precursor to subsequent
isoform discovery and abundance estimation analyses proposed
by Mezlini et a]. (2013).

As a statistical procedure, RASTA costs little to the re-
searcher, as it is computationally efﬁcient and requires no add-
itional sequencing or sequencing reagents. At the same time, the
hierarchical clustering and ZTP estimation procedures used in
RASTA are powerful and are able to accurately classify legitim-
ate and erroneous reads when both exist for a given gene.

ACKNOWLEDGEMENTS

The authors thank Andrea Schorn from the Martienssen labora-
tory at Cold Spring Harbor Laboratory and Sanvesh Srivastava
from the Doerge group in the Department of Statistics, Purdue
University for helpful discussions.

Funding: National Science Foundation (DBI-1025976) grant (to
R.W.D. and colleagues).

Conﬂict of Interest: none declared.

REFERENCES

Auer,P. and Doerge,R. (2011) A two—stage poisson model for testing RNA—Seq
data. Stat. Appl. Genet. M0]. Biol., 10, 26.

 

604

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] 11101} papeolumoq

9103 ‘Og isanV uo ::

RASTA

 

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac—
tical and powerful approach to multiple testing. J. R. Stat. Soc. Series B Stat.
Methodol, 57, 2897300.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Stat., 29, 116571188.

Bennet,S. (2004) Solexa ltd. Pharmacogenomics, 5, 4337438.

Berg,B. et al. (2009) Comparing gene annotation enrichment tools for functional
modeling of agricultural microarray data. BMC Bioinformatics, 10, S9.

Chepelev,I. et al. (2009) Detection of single nucleotide variations in
expressed exons of the human genome using RNA—Seq. Nucleic Acids Res.,
37, e106.

Du,Z. et al. (2010) agriGO: a G0 analysis toolkit for the agricultural community.
Nucleic Acids Res., 38, W6¢W70.

Lance,G. and Williams,W. (1966) Computer programs for hierarchical polythetic
classiﬁcation (“similarity analysis”). Comput. J., 9, 6&64.

Lister,R. et al. (2008) Highly integrated single—base resolution maps of the epigen—
ome in Arabidopsis. Cell, 133, 5237536.

Mardis,E. (2008) Next—generation DNA sequencing methods. Ann. Rev. Genomics
Hum. Genet., 9, 3874102.

Margulies,M. et al. (2005) Genome sequencing in microfabricated high—density
picolitre reactor. Nature, 437, 3767380.

Marioni,J. et al. (2008) RNA—Seq: an assessment of technical reproducibility and
comparison with gene expression arrays. Genome Res., 18, 150971517.

Mezlini,A.M. et al. (2013) iReckon: simultaneous isoform discovery and abundance
estimation from RNA—seq data. Genome Res., 23, 5197529.

R Core Development Team. (2011) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Riggs,A. (1975) X inactivation, differentiation, and DNA methylation. Cytogenet.
Cell Genet., 14, 9725.

Robertson,K. (2005) DNA methylation and human disease. Nat. Rev. Genet., 6,
597$10.

Robinson,M. and Smyth,G. (2008) Small—sample estimation of negative binomial
dispersion, with applications to SAGE data. Biostatistics, 9, 3217332.

Shames,D. et al. (2007) DNA methylation in health, disease, and cancer. Curr. Mol.
Med, 7, 857102.

Shiroguchi,K. et al. (2012) Digital RNA sequencing minimizes sequence—dependent
bias and ampliﬁcation noise with optimized single—molecule barcodes. Proc.
Natl Acad. Sci, 109, 134771352.

Swarbreck,D. et al. (2008) The Arabidopsis Information Resource (TAIR): gene
structure and function annotation. Nucleic Acids Res., 36, 100971014.

Yee,T. (2010) The VGAM package for categorical data analysis. J. Stat. S0ftw., 32,
1734.

 

605

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papeolumoq

91oz ‘Og isanV uo ::

