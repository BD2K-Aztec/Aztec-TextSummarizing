BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Rapid formula predictions by a relational database

 

formula calculations that we tested (Supplementary Fig. S1), was selected
for comparison. As HR2 filters some elemental compositions according
to the Seven Golden Rules (Kind and Fiehn, 2007), another database
‘ExactMassDB-HR2’ (EX-HR2), which returns the same results as does
HR2, was prepared. The search time was measured by an in-house Java
program on Windows PCs. To evaluate the search time, we prepared lists
of mass values that consist of 1000 mass peaks and 1000 MS2 peaks
detected by high-resolution MSs in practical analyses (practical mass
lists). To help users query their mass values in ExactMassDB, we con-
structed a RESTful web service named ‘MFSearcher’ with Apache,
Tomcat and MySQL. The web service also provides querying functions
for other databases, e.g. EX-HR2 database, KEGG, PubChem,
KNApSAcK, FlavonoidViewer and a database of possible linear poly-
peptides. The search time for the MFSearcher web service was measured
by querying from several PCs in different countries. Details are described
in the Supplementary Material.

3 RESULTS AND DISCUSSION

The search times of the pre—calculated MySQL database
EX—HR2 were significantly shorter than those of HR2 by 1097
123 times (Table l). The creation of an index for the formula
weight column of the MySQL table contributed to the reduction
of the search time; however, it was still at the same level as HR2
at 5ppm mass tolerance (Supplementary Table S1). The search
time was largely dependent on the record numbers found, and
hence on the mass tolerance (Supplementary Figs. S17S4). A
drastic improvement of the search rate was observed when the
records of EX—HR2 were sorted by formula weight
(Supplementary Table S1 and Fig. S4). It was speculated that
the minimization of time for searching record data on the hard
disk drive contributed to the reduction of the search time. This is
proven by a further remarkable speed—up (48871833 fold) when a
solid—state drive (SSD) was applied (Table 1). These improve—
ments were enhanced in a lower—spec Windows XP PC
(Machine B) (Supplementary Tables S17S3). The search time
of HR2 was largely dependent on the evaluated formula
number during the calculation (Supplementary Fig. S5). A par—
allel execution of HR2 by threads reduces the total search time
for a mass list, although it requires higher CPU occupations
(Supplementary Fig. S7). EX—HR2 was still 2&29 times faster
than HR2 executed with threads in the Windows 7 PC (8
threads), and 5&61 times faster in the Windows XP PC (2
threads) (Table 1, Supplementary Table S2). In a practical
usage of EX—HR2, further speed—up was expected by the cache
of MySQL and the OS (Supplementary Table S3 and Figure S8).
Searching with the MFSearcher web service needs a longer time
than those on the PCs, but was still faster than HR2 as far as we
tested, except for the search at 5 ppm mass tolerance from Peru
(Supplementary Table S4).

A high—throughput prediction of elemental compositions by
our database approach will improve comprehensiveness and
throughput of annotations of metabolite peaks, and so will ac—
celerate metabolomic data productions. For example, our ap—
proach boosts the analysis of elemental compositions of MS"
fragments, which is one of the perspective strategies towards
semi—automatic de novo identiﬁcation of metabolites
(Rojas—Cherto et al., 2011). Other tools such as HR2 are never—
theless powerful for thorough investigation of a small number of

Table 1. Comparison of search times of EX-HR2 database with those of
HR2 for practical mass lists consisting of 1000 metabolite peaks and 1000
MS2 fragment peaks

 

 

 

ppm“ Search time (s)b Fold
EX- EX-HR2 HR2 HR2 HR2/’EX- HR2/’EX- HR2 HR2
HR2“ (SSD)“ (thread)c HR2 HR2 (SSD) (thread)/ (airway
EX-HR2 EX-HR2
(SSD)
0.1 15.48 1.04 1900 449 123 1833 29 433
0.5 15.84 1.38 1911 449 121 1387 28 326
1 16.13 1.69 1901 449 118 1128 28 267
5 17.59 3.92 1912 449 109 488 26 115

 

Windows 7 PC (Machine A) was used (See Supplementary Material). "Mass toler—
ance given for elemental formula searching. bTen sets of practical mass lists were
searched, and average values of processing time are shown. CEX—HRZ database was
indexed and sorted by the formula weight column. dDatabase files of EX—HRZ were
placed on the solid—state drive (SSD). 6Maximum of 8 threads of HR2 were executed
in parallel.

metabolites by searching various atom settings. Our database
approach can be complementary with all these other tools.

ACKNOWLEDGEMENTS

We are grateful to all the people who kindly helped measure the
search times of MFSearcher (Supplementary Material).

Funding: This work was partly supported by the New Energy and
Industrial Technology Development Organization (NEDO,
Japan) as part of a project named ‘Development of
Fundamental Technologies for Controlling the Material
Production Process of Plants’ [P02001], and by National
Bioscience Database Center (NBDC) of Japan Science and
Technology Agency (J ST).

Conﬂict of Interest: none declared.

REFERENCES

B6ttcher,C. et al. (2008) Metabolome analysis of biosynthetic mutants reveals a
diversity of metabolic changes and allows identification of a large number of
new compounds in Arabidopsis. Plant Pliyxiol., 147, 210772120.

Beale,M.H. and Sussman,M.R. (2011) Metabolomics of Arabidopsis thaliana. In
Hall,R.D. (ed.) Annual Plant Reviews. Vol. 43, Wiley—Blackwell, Chichester,
UK, pp. 1577180.

Feng,X. and Siegel,M.M. (2007) FTICR—MS applications for the structure deter—
mination of natural products. Anal. Bioanal. Chem, 389, 134171363.

Iijima,Y. et al. (2008) Metabolite annotations based on the integration of mass
spectral information. Plant J., 54, 9497962.

Kind,T. and Fiehn,O. (2007) Seven Golden Rules for heuristic filtering of molecular
formulas obtained by accurate mass spectrometry. BM C Bioiiy’ormatiex, 8, 105.

Nakamura,Y. et al. (2008) A tool for high—throughput prediction of molecular for—
mulas and identification of isotopic peaks from large—scale mass spectrometry
data. Plant Biotechnol, 25, 3777380.

R0jas—Chett6,M. et al. (2011) Elemental composition determination based on MS”.
Bioinformaticx, 27, 237(r2383.

Sait0,K. and Matsuda,F. (2010) Metabolomics for functional genomics, systems
biology, and biotechnology. Anna. Rev. Plant. Biol, 61, 4637489.

Steinbeck,C. et al. (2006) Recent developments of the chemistry development kit
(CDK)7an open—source java library for chemo— and bioinformatics, Carr.
Pltarm. Dex, 12, 211172120.

 

291

ﬁm'spzumol‘pmﬂo'sopeuuopuotq/ﬁdnq

