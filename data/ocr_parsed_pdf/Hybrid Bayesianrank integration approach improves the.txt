BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

M.A.Badgeley et al.

 

can be viewed as an instance of rank aggregation where each
dataset supplies a prediction list (that is not necessarily complete)
in order of differential expression, correlation or some other
metric of relevance. Unfortunately treating all datasets equally
can make these methods unacceptably sensitive to noise and
outliers.

To address these limitations, we propose a new data integra—
tion method that combines the rank aggregation framework with
the power of Bayesian reasoning. Our method assumes that there
is a ground truth to be discovered and this is represented with
varying fidelity in the datasets to be integrated. Starting with an
equally weighted consensus generated by rank averaging, we it—
eratively fit Bayes Factors to each dataset and recompute the
integration result. Thus, this approach combines the advantages
of being agnostic to dataset—speciﬁc statistics and external stand—
ards while using the robustness of the Bayesian framework to
handle outliers and inconsistencies. We demonstrate that this
approach has favorable theoretical properties on an established
simulation pipe—line and improves over other rank aggregation
methods in real data integration tasks. The method is computa—
tionally simple, yet significantly increases the predictive power of
rank—based aggregations. Additionally it provides a reliable esti—
mate of dataset relevance and can be used to produce context—
sensitive integrations that focus in on specific areas of interest.
Because it requires only ranked lists, it is readily applicable to
many integration problems.

2 APPROACH

Our method is inspired by Latent Class Analysis (LCA), a stat—
istical technique widely used in social science and medical diag—
nostics to analyze a series of related measurements by assuming
that they capture an underlying latent trait. For example, in the
absence of deﬁnitive knowledge regarding disease status, LCA
can be used to infer the sensitivities and speciﬁcities of a series of
diagnostic tests. In essence, the technique works by consensus, if
multiple diagnostic tests report a positive result the individual is
more likely to have the disease. The entire combination of diag—
nostic test—specif1c false—positive and false—negative rates and the
disease status probability of individual patients can thus be esti—
mated by maximum likelihood.

While the underlying problem appears to be similar to gen—
omic data integration and a related approach has been successful
in integrating binary interaction networks (W eile et al., 2012), the
methodology is not directly transferable to arbitrary genomic
data. LCA operates on categorical data, while genomic data
are usually continuous valued. Moreover, the assumption of
the existence of a few discrete latent classes is often incorrect
and genomic datasets can be extremely discordant, resulting in
many solutions with similar likelihoods. For example, in a case
of large disagreements, solutions dictating that one dataset is
right and all others are wrong are all equally valid. We address
these limitations with several heuristic techniques, which give
good results in practice. Our methods works by iteratively com—
puting an aggregated ranking from dataset—speciﬁc Bayes factors
and using the ranking to update the Bayes factor calculation. We
refer to our method as Bayesian Iterative Robust Rank
Aggregation (or BIRRA).

While the method can be applied to any data integration task,
for the purpose of illustration we can assume that the input to
our method is a set of datasets that rank genes in order of disease
relevance, for example, a set of differential expression studies. If
we had a representative set of genes that were known to be dif—
ferentially expressed in the disease, we could infer the probability
of disease relevance (DR) for the rest of the genes given the set of
evidence (gene’s ranks within a dataset) Elm" via the standard
Bayesian approach

P(DR|E1,E2,...E,,)=C- HP(E,~|DR) (1)
i=1

Where C is a normalization constant and P(E,~|DR) is calcu—
lated from the set of known positive examples. This approach
naturally captures the fact that individual datasets vary in how
well they are able to discriminate disease—relevant genes and their
relative contribution to the final ranking should be adjusted ac—
cordingly. Our method uses the same principle without relying
on a set of positive examples to calculate P(E,~|DR) but rather
estimating it from the structure of the data.

Require: input data to be integrated for 11 genes, rank ordered
by some measure of relevance (such as differential expres—
sion P—values or correlation). Missing values in each data—
set are assigned the lowest rank P a prior probability for
the ‘positive class’ B number of bins.

1: Compute initial aggregate ranking by mean ranks

2: Compile a working standard by assigning the top np of
aggregated predictions to be the positive class and the
rest of the predictions to the negative class

3: Discretize the data into B bins
4: repeat

5: Compute bin—wise cumulative Bayes factors for each data—
set by comparing with the working standard

6: Aggregate the data by naive Bayesian integration accord—
ing to Equation 1

7: Update working standard with new rankings obtained in
step 6

8: until rankings unchanged or max iterations exceeded

9: return Final ranking

In principle, for complex genomic datasets, this kind of pro—
cedure can be unstable because in cases of large disagreements
or low signal, multiple solutions are equally valid. We imple—
ment several heuristic techniques to make this approach more
robust. In particular, we compute Bayes factors cumulatively
starting from the top bin and enforce a monotone decrease.
Thus, the minimum Bayes factor is limited by the prior prob—
ability, and each piece of data can only contribute positive
evidence. Secondly, we use a winzorization step whereby for
each bin we decrease the maximum Bayes factor to that of
the second maximum. This ensures that at least two datasets
are always combined and prevents the appearance of singleton
solutions whereby only one datasets is predicted to have any
signal.

 

210

ﬁle'sreumofpmJXO'sopeuuowrorq/ﬁdnq

 

naive Bayes
BI RRA
Stuart

RRA

mean Ranks

 

signal data

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

 

t.‘i.$i§$¢§.¢..&..sgg;:oo.0..
ooot‘ .

U
i?
O
A

90*.

0M0

0*

0*!”

0».

0».

DIED.

0-D.

*0

01>”

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

E GSE20141 XX GSE20164
* GSE20146 B GSE20168

9 GSE20159 E GSE20291
e GSE20163 IN GSE20292

 

GSE20314 ' GSE7621
GSE22491 - GSE8397
GSE6613
GSE7307

DOik-O

D-IO
[III-o
wok

0D“-

1-D.

OH.

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

M.A.Badgeley et al.

 

 

Fig. 7. Comparing BIRRA estimates to Bayes factors computed using
the independent ChIPseq dataset we ﬁnd that the dataset weights as
estimated by BIRRA are in agreement with their ability to recapitulate
the ChIPseq signal. Importantly, datasets varied widely in their ability to
recapitulate the ChIPseq interactions for different TFs, and the BIRRA-
computed Bayes factors were consistent in each case

We plot the dataset—specific Bayes factors derived from the two
methods (BIRRA and naive Bayes) side by side in Figure 7 and
ﬁnd that the relative dataset quality as judged by the self—con—
tained BIRRA approach is in fairly good agreement with that
obtained by using an independent standard. Importantly the true
dataset quality (as estimated by direct comparison with ChIPseq
data) varied for different TFs, and BIRRA was able to correctly
identify which speciﬁc datasets were informative in each case.
For example, based on comparisons with the gold standard,
GSE4308 (black dashed lines) performs well at predicting targets
for Myc, yet is completely uninformative for Smad1, and this
trend if fully captured by BIRRA (Fig. 7).

While the ChIPseq—based validation relies only on the correl—
ations between TFs and other genes, we can use the BIRRA—
computed Bayes factors to produce integrations over all gene
pair correlations. Importantly, however, focusing on a specific
TF produces different relevance estimates for the same dataset,
and the relative contribution of each dataset to the ﬁnal result
varies substantially (Fig. 7). Consequently, when extended to the
complete correlation network, our method produces different net—
works depending on the TFs of interest. Thus, unlike other rank
integration methods that can only output a single result, BIRRA
can produce context—sensitive rank aggregations that maximize
the agreement over a speciﬁc subset of the biological signal.

4 DISCUSSION

We present a method that implements rank aggregation via
Bayesian reasoning. Our method differs from previous rank ag—
gregation approaches in that it directly estimates the reliability of
individual datasets, weighing them accordingly. We have shown
that the BIRRA method outperforms established approaches on

simulations and performs well in real data integration scenarios.
However, the method will likely not be applicable to all data
integration tasks without some further developments. For ex—
ample, as it operates entirely by bootstrapping, it is even more
susceptible to deviations from the independence assumption
underlying the naive Bayes calculations. In general, the Bayes
factors and probabilities calculated by our method are always
inﬂated relative to those that are calculated with an external gold
standard, and the gap widens when dataset dependence is pre—
sent. BIRRA performance on the stem cell expression integra—
tion, which has considerable dataset dependence, demonstrates
that the method is effective despite the independence assumption.
However, dependence will have to be addressed directly for in—
tegrations that involve a larger number of datasets. It is likely
that in those cases, the deleterious effects of data dependence can
be negated using regularization techniques commonly applied to
standard—based Bayesian integration (Huttenhower et al., 2009;
Lee et al., 2008), and ﬁnding a suitable regularization method
will be an important direction for future research.

5 METHODS
5.1 Rank aggregation methods

The BIRRA method was programmed in R, and the source code is avail-
able in the supplement. The RRA and Stuart methods were called from
the RobustRankAggreg R package.

5.2 TF target networks

Data for 14 ES-related studies were downloaded from InSilicoDB
(Coletta et al., 2012), which provides Robust Multi-array Average
(RMA)-processed Affymetrix ﬁles mapped to gene symbols. As in
(Kolde et al., 2012) we created a standard for TF target interaction
using the ChIPseq-determined TF-promoter mapping provided by
(Chen et al., 2008). Following (Kolde et al., 2012), we considered all
genes with a score of 20.6 as targets. We noted that for two of the
TFs considered in the ChIPseq study, Smadl and Suzl2, the majority
of individual expression datasets were predictive of their targets only
when anti-correlation was considered, suggesting that these TFs act as
repressors. Suzl2 is known to be directly involved in gene repression (Cao
and Zhang, 2004), and though Smadl is not a dedicated repressor, in ESs
it interacts with Nanog to repress its targets (Suzuki et al., 2006).
Therefore, for these two TFs, we ranked genes in order of anti-correl-
ation. For the remaining TFs, correlation was used.

5.3 PD meta-analysis

We collected the majority of the datasets used in a previously reported
Parkinson’s meta-analysis (Zheng et al., 2010). For Affymetrix datasets,
we downloaded the data from InSilicoDB. For Illumina datasets, the
data was taken from the Gene Expression Omnibus database (GEO)
(Edgar et al., 2002) and processed with background correction using
the ‘bg.adjust’ function in the ‘affy’ Bioconductor package, log trans-
formation and quantile normalization. Datasets were ﬁltered by discard-
ing the bottom 20% of low expression and low variance genes, and
processed for differential expression with respect to disease status, includ-
ing additional covariates, such as gender and brain region, whenever
those were applicable and available in GEO.

Funding: Funded by NIH Contract HHSN272201000054C and a grant
from the Michael J Fox Foundation.

Conﬂict of interest: none declared.

 

214

ﬁm'spzumofpmjxo'sopeuuowrorq/ﬁdnq

Hybrid Bayesian-rank integration approach

 

REFERENCES

Akey,J.M. et al. (2007) On the design and analysis of gene expression studies in
human populations. Nat. Genet., 39, 8074508; author reply 8087809.

Cao,R. and Zhang,Y. (2004) SUZ12 is required for both the histone methyltrans—
ferase activity and the silencing function of the EED—EZH2 complex. Mol. Cell,
15, 57$7.

Chen,X. et al. (2008) Integration of external signaling pathways with the core tran—
scriptional network in embryonic stem cells. Cell, 133, 110(r1117.

Coletta,A. et al. (2012) InSilico DB genomic datasets hub: an efﬁcient starting point
for analyzing genome—wide studies in GenePattern, Integrative Genomics
Viewer, and R/Bioconductor. Genome Biol., 13, R104.

Edgar,R. et al. (2002) Gene expression omnibus: NCBI gene expression and hybrid—
ization array data repository. Nucleic Acids Res., 30, 2077210.

Huttenhower,C. et al. (2009) Exploring the human genome with functional maps.
Genome Res, 19, 109}1106.

Kolde,R. et al. (2012) Robust rank aggregation for gene list integration and meta—
analysis. Bioinformatics, 28, 5737580.

Lee,I. et al. (2004) A probabilistic functional network of yeast genes. Science, 306,
155571558.

Lee,I. et al. (2008) A single gene network accurately predicts phenotypic effects of
gene perturbation in Caenorlzalnlitis elegans. Nat. Genet., 40, 1817188.

Spielman,R.S. et al. (2007) Common genetic variants account for differences in gene
expression among ethnic groups. Nat. Genet., 39, 2267231.

Stuart,J.M. et al. (2003) A gene—coexpression network for global discovery of con—
served genetic modules. Science, 302, 2497255.

Suzuki,A. et al. (2006) Nanog binds to Smadl and blocks bone morphogenetic
protein—induced differentiation of embryonic stem cells. Proc. Natl Acatl. Sci.
USA, 103, 1029440299.

Tseng,G.C. et al. (2012) Comprehensive literature review and statistical consider—
ations for microarray meta—analysis. Ntwleic Acitls Res., 40, 378573799.

Weile,J. et al. (2012) Bayesian integration of networks without gold standards.
Bioinformatics, 28, 149571500.

Zheng,B. et al. (2010) PGC—l, a potential therapeutic target for early intervention in
Parkinson’s disease. Sci. Trans]. Meal, 2, 52ra73.

 

215

/810'slcum0prOJxo'sopBLuJOJutotq”:duq

