BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

M.Hu et al.

 

We further calculated the GC content within a 200 bp region
upstream of each fragment end (GC content feature) and the
mappability score within a 500 bp region next to each fragment
end (mappability feature). The GC content feature and the
mappability feature of each genomic locus are deﬁned as the
average of the corresponding features among all fragment ends
falling into this locus. Supplementary Figure S1 illustrated these
three systematic biases in Hi—C contact maps at 1 MB resolution
level, which share similar patterns to the biases at the fragment
end level (Yaffe and Tanay, 2011).

To remove aforementioned systematic biases, we propose
HiCNorm, a Poisson regression model for Hi—C contact maps
normalization (Supplementary Material). In HiCNorm, we esti—
mated the bias effects of the effective length feature and the GC
content feature while ﬁxing the mappability feature as a Poisson
offset. We applied HiCNorm to the Hi—C cis (trans) contact map
of each chromosome (chromosome pair) separately, and
reported the estimated biases in Supplementary Figure S2. We
observed a positive correlation between the effective length in
each locus pair and the number of contacts in both HindIII
dataset and NcoI dataset. The GC content feature is negatively
associated with the number of contacts in the HindIII dataset
and positively associated with that in the NcoI dataset.
Noticeably, the magnitude of the estimated effective length
biases is signiﬁcantly larger than that of the estimated GC con—
tent biases (paired t—test P—value<2.8e—1 1). These results suggest
that the effective length is the dominant bias factor at 1MB
resolution level, and the bias owing to the GC content is second—
ary. We further conducted the residual analysis (Supplementary
Material) and found that HiCNorm flts data well in spite of
over—dispersion. To account for the over—dispersion, we also im—
plemented a negative binomial (NB) regression model for Hi—C
contact maps normalization (Supplementary Material). The NB
regression model achieved a slightly better fit to the data than the
Poisson regression model in terms of the Akaike information
criterion (Akaike, 1974), but these two models provided very
similar bias reductions. We therefore focused on the Poisson re—
gression model henceforth, which is mathematically simpler. Our
R package provides a choice for the user to use either the NB or
the Poisson regression models.

We used the residuals of the Poisson regression as the
normalized Hi—C contact maps (Supplementary Material). For
comparison, the normalization results of the YT approach
were downloaded from Yaffe’s webpage: http://compgenomics
.weizmann.ac.il/tanay/?page_id=283. The better normalization
method achieves higher reproducibility (measured by
Spearman’s rank correlation coefﬁcient) between the HindIII
dataset and the NcoI dataset. We also reported the reproducibil—
ity of raw Hi—C contact maps.

We first calculated the Spearman correlation coefﬁcients of the
two raw Hi—C cis contact maps obtained from the HindIII data—
set and the NcoI dataset for each of the 23 chromosomes
(chromosome 1~22 and X). We found that the YT approach
improves the average Spearman correlation coefficients across
the 23 chromosomes from 0.7241 to 0.8041, whereas HiCNorm
further improves the correlation coefficient to 0.8111
(Supplementary Fig. S3a). HiCNorm achieved signiﬁcantly
higher reproducibility than raw Hi—C reads (paired t—test

P—value = 1.3e—14) and the YT approach (paired t—test
P—value = 0.0004) for the population of 23 chromosomes.

We further evaluated the reproducibility of Hi—C trans contact
maps obtained from the HindIII dataset and the NcoI dataset
for each chromosome pair (253 chromosome pairs in total). As
the 1 MB Hi—C trans contact maps are sparse, instead of measur—
ing the reproducibility of Hi—C trans contact maps directly, we
studied the reproducibility of two one—dimensional (1D) coverage
vectors, which are deﬁned as vectors of row and column sum—
mations, respectively, of each Hi—C trans contact map and used
in Yaffy and Tanay’s study (Yaffe and Tanay, 2011). Across the
total 506 1D coverage vectors, the average Spearman correlation
coefﬁcient of raw Hi—C 1D coverage vectors obtained from the
HindIII dataset and the NcoI dataset was — 0.1106. After nor—
malization, the correlation coefﬁcient was increased to 0.5818
(highly signiﬁcant) using the YT approach, and further increased
to 0.5832 using HiCNorm (Supplementary Fig. S3b) (statistically
insigniﬁcant).

While providing comparable reproducibility of Hi—C trans
contact maps with respect to the YT approach, HiCNorm is
more robust. The standard deviations of the Spearman correl—
ation coefﬁcients of 1D coverage were 0.1199 and 0.1679 for
HiCNorm and the YT approach, respectively (Supplementary
Fig. S3b). As an illustrative example, the Spearman correlation
coefﬁcient of the raw 1D coverage of chromosome 22 (using the
trans contact between chromosome 4 and chromosome 22)
was — 0.2058 before normalization and — 0.0689 after normaliza—
tion using the YT approach, but it was improved dramatically to
0.6518 using HiCNorm (Supplementary Fig. S4).

Due to the intensive computation requirement, it was not feas—
ible to normalize the whole genome contact maps (Lieberman—
Aiden et al., 2009) with the YT approach on a computer with
one single CPU, but with HiCNorm, it took ~8 min. To make a
feasible and fair comparison of the computation times of the YT
approach and HiCNorm, we used the testing dataset published
with the source code of the YT approach (downloaded
from http://compgenomics.weizmann.ac.il/tanay/?page_id=283),
which is a subset of the Hi—C dataset (Lieberman—Aiden et al.,
2009) used in this study (cis and trans interactions of chromo—
some 19, 20, 21 and 22 in the NcoI dataset), as the benchmark to
evaluate the computation time. For this testing dataset, the YT
approach took ~4h (14041s), whereas HiCNorm only took
~2 s, i.e. HiCNorm is >7000 times faster than the YT approach.

In this work, we propose HiCNorm, a novel normalization
procedure based on Poisson regression to remove systematic
biases in Hi—C contact maps. Compared with the YT approach,
HiCNorm improves the reproducibility between the Hi—C data—
sets obtained from libraries prepared using different restriction
enzymes. Additionally, because HiCNorm involves a much smal—
ler number of parameters (only three parameters in HiCNorm
compared with 420 parameters in the YT approach), we are able
to signiﬁcantly reduce the computation cost. The significant im—
provement is made possible due to two reasons: ﬁrst, we directly
model the frequency of chromatin interaction in the desired reso—
lution level Hi—C contact maps so as to enable sufﬁcient data
reduction at an early stage; second, the hyperbola—shaped con—
tour plot of the effective length bias and the GC content bias
(Supplementary Fig. S1) motivated us to adopt a parametric
method to account for multiple systematic biases, which makes

 

3132

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

HiCNorm: removing biases in Hi-C data via Poisson regression

 

the inference much simpler than the non—parametric method used
in the YT approach. We also found that increasing the model
complexity (adding more interaction terms among the features in
HiCNorm) did not lead to further improvement in terms of the
reproducibility using real data. Our study conﬁrms the critical
importance of proper normalization of the Hi—C read map data.
With the increased popularity of the Hi—C technology in the bio—
medical ﬁeld, HiCNorm has the potential to become a conveni—
ent and powerful normalization tool for Hi—C data analysis.

Funding: This work was supported by US National Institutes of
Health grants R01HG005119 (to Z.Q.), 5R01GM080625 (to
J .S.L.) and the Ludwig Institute for Cancer Research (to ER).

Conﬂict of Interest: none declared.

REFERENCES

Akaike,H. (1974) A new look at the statistical model identiﬁcation. IEEE Tram“.
Automat. Control, 19, 7167723.

Lieberman—Aiden,E. et al. (2009) Comprehensive mapping of long—range
interactions reveals folding principles of the human genome. Science, 326,
2897293.

McCullagh,P. and Nelder,J.A. (1989) Generalized Linear Models. Chapman & Hall/
CRC, London.

Naumov,N. and Dekker,J. (2010) Integrating one—dimensional and three-
dimensional maps of genomes. J. Cell Sci., 123, 197971988.

Yaffe,E. and Tanay,A. (2011) Probabilistic modeling of Hi—C conmct maps elimin—
ates systematic biases to characterize global chromosomal architecture.
Nat. Genet., 43, 105%1065.

 

3133

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

