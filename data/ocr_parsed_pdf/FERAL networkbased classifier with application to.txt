Biainfarmatics, 31, 2015, i311—i319
doi: 10.1093/bioinformatics/btv255
ISMB/ECCB 2015

 

FERAL: network-based classifier with
application to breast cancer outcome prediction
Amin Allahyar and Jeroen de Ridder*

Delft Bioinformatics Lab, Faculty of Electrical Engineering, Mathematics and Computer Science, Delft University of
Technology, Delft, The Netherlands

*To whom correspondence should be addressed.

Abstract

Motivation: Breast cancer outcome prediction based on gene expression profiles is an important
strategy for personalize patient care. To improve performance and consistency of discovered
markers of the initial molecular classifiers, network—based outcome prediction methods (NOPs)
have been proposed. In spite of the initial claims, recent studies revealed that neither performance
nor consistency can be improved using these methods. NOPs typically rely on the construction of
meta—genes by averaging the expression of several genes connected in a network that encodes
protein interactions or pathway information. In this article, we expose several fundamental issues
in NOPs that impede on the prediction power, consistency of discovered markers and obscures bio—
logical interpretation.

Results: To overcome these issues, we propose FERAL, a netvvork—based classifier that hinges
upon the Sparse Group Lasso which performs simultaneous selection of marker genes and training
of the prediction model. An important feature of FERAL, and a significant departure from existing
NOPs, is that it uses multiple operators to summarize genes into meta—genes. This gives the classi—
fier the opportunity to select the most relevant meta—gene for each gene set. Extensive evaluation
revealed that the discovered markers are markedly more stable across independent datasets.
Moreover, interpretation of the marker genes detected by FERAL reveals valuable mechanistic in—
sight into the etiology of breast cancer.

Availability and implementation: All code is available for download at: http://homepage.tudelft.n|/

OXFORD

 

53a60/resources/FERAL/FERAL.zip.
Contact: j.deridder@tudelft.nl

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Breast cancer is the most frequently diagnosed type of cancer and
one of the leading causes of death in women (Fantozzi and
Christofori, 2006). The main cause of death in these patients is,
however, not the primary tumor, but its metastases at distant sites
(e.g. in bone, lung, liver and brain) (Weigelt et (11., 2005). Typical
risk factors such as lymph node status and tumor size are insufficient
to accurately predict the risk of metastasis in patients (Shapiro and
Recht, 2001; Weigelt et (11., 2005). Over the last few years, substan—
tial efforts have been made on deriving molecular classifiers to pre—
dict clinical outcome based on gene expression profiles obtained
from the primary tumor (van’t Veer et (11., 2002; Van De Vijver
et (11., 2002; Weigelt et (11., 2005).

A fundamental limitation of breast cancer outcome prediction is
that it has proved very difficult to obtain a robust classifier

©The Author 2015. Published by Oxford University Press.

performance across different datasets. It was found that, despite
properly cross—validated classifier training, prediction performance
decreases dramatically when a classifier trained on one dataset is
applied to another one (Lazar et (11., 2013; Soneson et (11., 2014).
Moreover, the prognostic gene signatures identified using these clas—
sifiers have poor concordance across different studies (Ein—Dor
et (11., 2005; van Vliet et (11., 2008). This points to a lack of a unified
mechanism through which clinical outcome can be explained from
gene expression profiles, which is still a major hurdle in clinical can—
cer biology.

Several studies ascribe the lack of classification robustness to in—
sufficient patient sample size (Hua et (11., 2009). Other causes may
be the inherent measurement noise in microarray experiments or
heterogeneity in the samples (Ein—Dor et (11., 2005; Symmans et (11.,
1995). To mitigate these issues, breast cancer datasets are often

i311

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journa|s.permissions@oup.com

112 /310'slcumofp1q1xo"soiwurJOJuioiq/ﬁduq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

i312

A.AIIahyar and J. de Ridder

 

pooled to capture the information of as many samples as possible in
the predictor (Shen et (11., 2004; van Vliet et (11., 2008). It remains,
however, an open question how many samples are sufficient to ac—
count for all the noise and heterogeneity.

One of the hallmarks of cancer is that it is caused by deregula—
tion of several processes or cellular pathways through multiple som—
atic mutations (Hanahan and Weinberg, 2000, 2011). More recent
efforts of outcome prediction aim to exploit this hallmark by taking
existing knowledge on relations between genes and pathways into
account in the classifier. A common approach is to aggregate several
functionally related genes to produce discriminative meta—genes or
subnetvvorks (Babaei et (11., 2011; D30 et (11., 2010; Pujana et (11.,
2007; Taylor et (11., 2009; Van den Akker et (11., 2011). Often, func—
tional relationships between genes are determined based on the top—
ology of a pre—defined biological network such as a co—expression
network (Park et (11., 2007), cellular pathway map (Lee et (11., 2008)
or protein—protein interaction (PPI) network (Chuang et (11., 2007).
Therefore, we refer to such approaches as network—based outcome
prediction methods (NOPs).

The approach proposed by Park et al. (2007) is among the first
NOPs. Initially, the co—expression network is partitioned into gene
sets using a linkage algorithm. Next, meta—genes are formed by tak—
ing the average expression of the genes in each gene set.
Consequently, highly correlated genes will be aggregated which re—
duces the number of features and co—linearity among genes. The ap—
propriate number of clusters, which determines the scale at which
meta—genes are assembled, is determined by cross—validation.

Chuang et al. (2007) exploit the PPI network to identify predict—
ive gene sets (called sub—networks in their work). Gene sets are con—
structed by a greedy procedure which starts with a gene (i.e. seed
gene) and extends iteratively by adding the neighboring gene that
provides the highest mutual information between corresponding
average meta—gene and target label.

Taylor et al. (2009) exploit the topology of the PPI network. In
this method, predictive hub genes (i.e. genes with more than five
connections) are ranked based on the absolute difference in within—
class correlation between the hub and its neighbors. The corres—
ponding meta—genes are constructed by taking the difference of
expression between the hub and its neighbors.

Unfortunately, contrary to previous claims, recent studies re—
ported that many NOPs do not outperform a model trained over sin—
gle gene features (Cun and Frohlich, 2012; Staiger et (11., 2012,
2013). Notably, in the analysis carried out by Staiger et al. (2013),
neither significant improvement of classification performance nor
an improvement of gene signature stability was observed, despite
the fact that these authors examined many different methods and ex—
perimented with several biological networks. Perhaps even more
striking is the finding that utilizing random networks (Staiger et (11.,
2012) or integrating random genes as markers (Venet et (11., 2011)
performs on par with complex NOPs. Taken together, it appears
that current NOPs have produced very limited progress on solving
the issue of robust classification performance and robust prognostic
gene signature selection. This also casts doubt on the potential to ex—
tract useful insights from the derived prognostic gene signatures into
the mechanisms underlying the disease.

The main goal of this article is to identify and alleviate several
fundamental issues in current NOPs that impede on reaching robust
prediction performance and identify a stable prognostic gene signa—
ture. We find that the main bottleneck in current NOPs is that the
frequently used average operator is a poor choice to integrate the ex—
pression of functionally related genes. Moreover, the use of a single
operator may not be sufficient to capture and summarize the

aberration of higher level functions in cell. In addition, we conclude
that decoupling the training of the classifier from the selection of
genes to be used in meta—genes or the selection of the meta—genes
themselves hampers the stability of gene signature identification.

To address these issues, we propose FERAL (DelFt nEtwoRk—
bAsed cLassifier), a new NOP that is based on the Sparse Group
Lasso (SGL) (Simon et (11., 2013; Yuan and Lin, 2006). SGL exploits
groups of features (i.e. gene sets) and yields sparsity at both group
(i.e. gene set) and feature (i.e. gene/meta—genes) levels (Friedman
et (11., 2010). In this way, simultaneous selection of features and
training of the prediction model is achieved (see Supplementary
Section S1 for explanation of Lasso and its variants). Furthermore,
instead of using a single operator to integrate gene—expression into
meta—genes, FERAL exploits a wide range of such operators, includ—
ing a previously unexplored supervised integration strategy.

We present extensive experiments using a compendium dataset
called ACES (Amsterdam Classification Evaluation Suite), which
was recently used for NOP model evaluation (Staiger et (11., 2013).
FERAL achieves statistically significant performance improvement,
owing to the regularization of the SGL and inclusion of multiple in—
tegration operators. We moreover find substantially improved sta—
bility of the selected prognostic gene sets. Taken together, these feats
enable biological interpretation of the trained classifier, which, we
find, results in highly relevant mechanistic insights.

2 Method

To motivate the design choices of FERAL we start by outlining the
basic properties of existing NOPs. We focus on three well—known
models proposed for network—based outcome prediction.
Nonetheless, there are numerous network—based methods, which we
do not take into consideration. A closer look at these methods re—
veals that in fact they all take two main steps to incorporate network
information: gene set selection and integration (Fig. 1a). The selec—
tion step should result in gene sets that represent (part of) a cellular
process or pathway that collectively exhibit aberrant behavior. In
the integration step, the selected genes are summarized to produce a
meta—gene capable of representing the aberrant behavior in the cor—
responding cellular process. Typically, this is followed by an add—
itional round of selection and integration in which meta—genes are
selected and integrated to produce a final prediction.

FERAL

[Sparse Group Lasso:

(Iasﬂfkatinn

in
= Selectlon

= Super-(laudinlt'gmliur-

is. Imul
=

a: LlrlLupt-wiu-dintegraliun
IAu'gl. Val. l'ulnul. Min. Mrd|

 

Fig. 1. Overview of the proposed model (FERAL). (a) Current models follow a
similar path in which several nearby genes (according to a given network) are
selected and then integrated using an average operator resulting in a meta-
gene. These meta-genes are then ranked based on a pre-defined scoring
function and top candidates are presented to the final classifier. (b) Instead of
being limited to average-based meta-genes, FERAL computes several
meta-genes using different operators and employs the SGL to select the most
appropriate meta-gene for each specific gene set while simultaneously per-
forming selection, integration and classification

112 /310'slcumofp1q1xo"soiwurJOJuioiq/ﬁduq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

FERAL: network—based classifier with application to breast cancer outcome prediction i313

 

2.1 Integration of gene sets into meta—genes

Most NOPs use the average operator to summarize gene expression
into meta—gene expression. However, other biologically inspired oper—
ations, such as the max/min (to model AND/OR relations) or the vari—
ance (to capture variability of expression levels among genes close in the
network) might also be suitable for representing higher level functions
in cell. The assumption in many NOPs is that the directionality of the
aberrant activity is the same (i.e. over/under expression) for nearby
genes in the network. This may be inappropriate, for instance when
genes exhibit opposite association with respect to the class label. In such
cases, the average operator can even cancel out their predictive contri—
bution. By assessing the expression correlation of PPIs, we established
that this is a frequent event (Fig. 2a and Supplementary Fig. S3).

This problem arises because the aforementioned operators are
unsupervised, i.e. an identical meta—gene would be produced using
shufﬂed sample labels. This can be resolved by using a linear or non—
linear regressor that considers the labels for achieving the best per—
formance. In spite of their superior performance (see Fig. 2b;
Supplementary Fig. S4), supervised integration operators may pro—
mote overfitting. This issue is apparent when linear operators are
compared with non—linear ones (e.g. Decision Tree and support vec—
tor machine). Hence, in the integration procedure, a trade—off exists
between performance and complexity.

To alleviate this issue, we propose the Direction Aware Average
(DA2) operator, which adjusts the direction of genes before taking
the average (see also Supplementary Section S13). DA2 is defined as:

DA2g :  sgn(C,-) X E,
ngl iswg

where ‘I’g is the gene set of seed gene g and E,- and C,- contain the ex—
pression and correlation values with the class label of gene /, respect—
ively. Just like all supervised meta—gene constructors, DA2 only uses
training samples for calculating Ci. The DA2 provides a balance be—
tween stability of unsupervised operators (owing to its simplicity)
and performance of supervised operators. It suffers less from overfit—
ting due to the fact that labels are only employed to detect the direc—
tion of genes which is more stable compared with their individual
predictive power. This is also apparent from our experiment
(Fig. 2b), as the DA2 provided a comparable performance to top
integrating operators (e.g. regression and the Lasso).

 

It is worth noting that different integration operators offer differ—
ent representations of higher level cellular functions. The proper op—
erator for each gene set is not known a priori. It might be beneficial
to use multiple of such operators and allow the classifier to select
the appropriate operator to describe a gene set or allow a single gene
set to be described using multiple operators. In addition to poten—
tially achieving better performance, it provides insights into the
underling aberrant behavior of each gene set. To the best of our
knowledge, there are no NOPs that use multiple integration
operators.

In FERAL, gene sets are formed by the individual gene expres—
sion profiles extended with several meta—genes produced by aggre—
gating gene expression of these genes. We included the following
unsupervised aggregations. The average operator, to model the over—
all expression level of the gene set in a fully unsupervised way. The
median operator, similar to average but with reduced sensitivity to
outliers. The variance operator, to measure the ﬂuctuation in ex—
pression of interacting genes as this may point to a loss of regulation
due to rewiring. Min and max, to model the AND/OR relationship
between genes. In addition to these unsupervised operators, the lin—
ear integration (which is implicitly provided by the SGL) and DA2
were also included as supervised operators. However, the supervised
non—linear meta—genes, which are presented in the analysis in
Figure 2b were not included, since it was observed that they were
prone to overfitting (data not shown).

2.2 Selection of genes in gene sets

To determine which genes will be summarized in a meta—gene, Park
selects all genes in a correlation cluster whereas Taylor uses all genes
that are connected to the same hub gene in the PPI network. Both of
these methods are likely to produce a highly skewed cluster size dis—
tribution, with a few very large clusters and many smaller ones
(Albert, 2005; Chen et (11., 2002). These large clusters will contain a
substantial number of irrelevant genes that may not only hamper the
performance but also limit the interpretability of the meta—gene as it
is difficult to identify the driver genes amongst all genes in the gene
set (Cheng et (11., 2014). Moreover, in case of Taylor, only genes
connected to hub genes can appear in a meta—gene, which a priori
greatly limits the repertoire of genes that can be used in the final
predictor.

 

‘ 0.3
0.2
c U.
ﬁe;-
E
I.
O
U
a.
l
c354 «Ia .n'. ti o" a) «a '0'5 I

Magnitude of difference

I
Var Min Max Mad Flag Lasso DA2 DT SUM

Fig. 2. Evaluation of different integration operators. (a) Visualization of the consistency in the direction of association with the target label for connected gene
pairs in the I2D network. The X—axis represents the magnitude of difference, defined as abs(Ca 7 Ch) >< Sgn(Ca >< Cb), where CX denotes the correlation between
gene xand the target label and Sgn is sign function. The y—axis is the correlation between two genes (see Supplementary Section 83 for details). (b) Performance
comparison between 11 operators including (from left to right): average, average of differences between seed gene and its interactors (implemented in Taylor),
variance, minimum, maximum, median, regression, lasso, DA2, Decision Tree (DT) and support vector machine with an RBF kernel. To generate each violin plot,
5000 randomly selected seed genes and their 9 closest neighbors according to the I2D network were integrated into a meta-gene using one of the operators, and
the predictive performance (AUC) is determined. The y—axis represents the improvement log ratio of the AUC obtained with the meta-gene with the highest AUC
of the individual genes. This comparison shows that other operators are able to provide similar or even better performance compared with average operator.
Interestingly, adjusting the direction of genes before taking the average can improve the performance considerably

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} papacjumoq

9103 ‘Og anﬁnv uo ::

i314

A.AIIahyar and J. de Ridder

 

Instead, in FERAL, the gene set size is kept constant. This is
achieved by defining gene sets as groups of k genes—a seed gene
with k — 1 of its closest neighbors. If performance is the only goal,
the setting of k is determined by an additional inner cross—validation.
By varying k we found, however, that a tradeoff exists between per—
formance and relevance of the marker genes to cancer and set [2 : 10
to provide a balance between them (see Supplementary Section S11).

To ensure each gene is included in at least one gene set, all genes
were considered as seed genes, resulting in a total of N gene sets. In
case a seed gene has more than k — 1 neighbors, the gene set is
reduced to a total of [2 genes by randomly removing genes. This ran—
dom selection did not result in large performance variation (see
Supplementary Section S12 for details). In case a seed gene has less
than k — 1 neighbors, the neighbors of the neighbors are considered
in a similar fashion. When a weighted network is used, the edge
weights are taken into account while determining the closest
neighbors.

Chuang employs a greedy search to define subnetvvorks. This is
done by iteratively extending the network from a seed gene guided
by a supervised performance criterion. Because label information is
used to guide the network growing, this increases the risk of overfit—
ting and thereby it reduces the performance and the stability of se—
lected gene sets. Moreover, this procedure also critically depends on
the accuracy of gene—gene interactions, which may be problematic
as concerns exist about the reliability of individual interactions in
these networks (Cusick et (11., 2008; Von Mering et (11., 2002).

Instead of including all genes in a group (Park and Taylor) or
using a greedy search in a noisy network (Chuang), FERAL lever—
ages the fact that the SGL performs embedded feature selection.
This is realized because SGL provides regularization both at the level
of the individual genes and the gene set level. As a result, selection of
the most relevant genes will be performed if sufficiently large gene
sets are provided. Because feature selection and classifier training
are performed simultaneously, classifiers that offer embedded fea—
ture selection often provide improved performance and select more
relevant features (Guyon et (11., 2006). Moreover, embedded feature
selection techniques prevent the need of additional cross—validation
loops that are required to prevent overfitting.

2.3 Pre—ranking and integration of meta—genes
After producing the meta—genes, most NOPs employ a ranking step.
This step can be considered as a second selection step at the meta—
gene level. Typically, each meta—gene is assessed based on a pre—
defined ranking function (e.g. mutual information, t—test or permu—
tation test) and the top candidates will be used in the final prediction
step (akin to so—called individual feature selection). Evaluation of
meta—genes in the methods of Chuang and Taylor is performed one
at a time. Hence, the ranking procedure cannot identify multiple
synergistic meta—genes when they have poor individual performance
nor can it determine whether several meta—genes contain the same
information and are therefore redundant (see Supplementary Fig.
S2.2 for an example of such cases in Chuang’s method).

As FERAL employs the SGL, which performs embedded feature
selection at the gene set level, the need of meta—gene selection is cir—
cumvented altogether. This greatly improves gene set stability.

2.4 Improvements on standard NOPs

To compare against, we use the methods from Park, Chuang and
Taylor, henceforth referred to as standard methods. Based on our
discussion so far, it seems reasonable to change a few parts of these
standard methods that evidently impede their performance.

The original version of each method (prefixed by 0) is implemented
by strictly following the procedure described in the authors’ paper.
Additionally, we implemented an improved version (prefixed by i),
which includes obvious improvements beneficial for their perform—
ance and stability (see Supplementary Section S2 for details). More
specifically for Park’s method, instead of training individual Lasso
over the meta—genes produced in each level of hierarchical tree, sin—
gle Lasso was trained over all meta—genes collected from levels of
hierarchical tree. For Taylors method, similar to Staiger et al., we
took the average of differences between hub and its interactor for
corresponding meta—gene. Finally, we removed the ranking proced—
ure in Taylor and Chuang methods and, similar to Park, used the
Lasso to achieve a simultaneous selection and integration of the
meta—genes. To assess the utility of biological networks in the out—
come prediction problem, we also included a Lasso trained on the
individual genes, i.e. without exploiting network information.

2.5 Ranking and scoring of marker genes

One of the main objectives in NOPs is to detect marker genes that
play a role in driving this complex disease. This can be achieved by
ranking them on a pre—defined score that captures the contribution
of the genes on the final prediction performance. In the Chuang
method, gene sets (i.e. sub—networks) are ranked based on P value
that is obtained using a permutation test. In Taylor, the average dif—
ference of the correlation coefficient between classes is used. Finally
in Park, the coefficients provided by lasso are used as gene sets score,
which are subsequently propagated to the genes in the cluster. In
FERAL, genes are scored based on the coefficients of the SGL. To
take into account the contribution of the meta—genes, gene scores are
supplemented by the largest coefficient of the meta—genes in which it
occurs. If a gene receives multiple scores, which is possible due to
overlapping gene sets, the scores are averaged (see Supplementary
Section S5 for more details).

2.6 Implementation of FERAL

The following steps are taken to train FERAL (Fig. 3). Initially, for
all genes, nine of its closest neighbors are selected based on a gene
network. After z—score normalization of the expression data, meta—
genes are computed. Next, the SGL classifier is trained using the
training samples. Implementation of the SGL in this work is based
on SLEP (Liu et (11., 2009). We further added a wrapper around this
package to implement sample weighting to mitigate unbalanced
classes along with a search for estimating the optimal parameters
using an inner cross—validation. The parameters 21 and 22, which
control the sparsity at the group level and within the groups, respect—
ively, are determined by the inner cross—validation. Finally, the per—
formance of the current fold is determined using the area under the
ROC curve (AUC) measure.

3 Results and discussion

For evaluation of FERAL, we use the ACES (Staiger et (11., 2012), a
cohort of 1606 breast cancer samples collected from 12 studies in
NCBIs Gene Expression Omnibus (see Supplementary Section S7 for
details). The label for each patient corresponds to recurrence free
survival time with respect to a 5—year threshold (good versus poor
outcome). Three different networks are used in the evaluation: I2D,
a PPI network that is also employed in Staiger et al., a co—expression
network and a random network. The co—expression network was
defined on training data only and thresholded at a correlation of
0.6. To produce the random network, we shufﬂe the nodes in the

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Zduq 11101} papacjumoq

9103 ‘Og anﬁnv uo ::

FERAL: network—based classifier with application to breast cancer outcome prediction i315

 

Train
Samples
- _---
I l...-
m
3
u- . I...-
- I...-
- _---

Test
PH

o :  ?
ﬁe
.3 I '®

   

Fig. 3. Schematic of the training and testing procedures of FERAL. (a) In the first step, 10 genes are selected using given network. (b) Corresponding genes in ex-
pression dataset are selected and normalized using z—score. (c) Meta-genes are computed using the expression profiles of the gene set and target label (in case of
a supervised integration). The expression of the individual genes is retained within the gene set. (d) The SGL is trained using training samples. (e) Test samples
are used to assess the prediction performance (in terms of AUC) in the current fold

(a)
0.76-
_ Random Single
2 , .
q 0.50- |
' ' .r .4 — m - —l a '
E 5 E E 5 E = 5
° an

or

ianludlotﬂol-

U

H-
IIID
5
J
E03}

   

2‘
‘S

IZD Co-Errpr Random

(b)
0.70
o n IZD Co-Expr Random Single
0.72
g 0.7
‘£0.68
0.06
0.04
0.62
M ageagi-I -I :gzagt-I e
settgeﬁ - :o%rseﬁ "
u 10
oTyI .
oChg a g
oPrk |
ITyl * s g
'Cha 4 e
rm 3
FRL 2 E
Std . . n
*mx-mx; —m{—wf_ltr
ﬁggéﬁerﬁ Eggééeﬁﬁ
IZD Random

 

Fig. 4. Performance evaluation (AUC). Performance of the methods under study for the PPI network (I2D), a co-expression network (Co-Expr) and a random net-
work (Random). We also added the result when a classical Lasso is employed (Single). Error bars denote the 95% confidence interval. The heatmaps indicate the
Pvalue of the paired t—test between pairwise comparison of the AUCs of the individual CV folds. (a) Sub-type stratified CV. (b) Sampled Ieave-one-study-out CV

I2D network to destroy any biological knowledge while keeping its
structure.

We used AUC as the main measure of performance throughout
the article. Two types of cross—validation are considered. In the first
type (sub—type stratified CV), the ratio of breast cancer sub—types is
kept constant in the training and test set. In the second type
(sampled leave—one—study—out CV), half of the samples in each study
is randomly selected (with replacement), while all samples from one
study are excluded from selection and kept hidden as a test set. This
configuration forms 12—folds, equal to the number of studies avail—
able in ACES. For both cross—validations, the indices of training and
testing samples in each fold are kept identical across all methods.

3.1 Performance comparison
Figure 4a shows the obtained average AUCs for 10 repeats of the
subtype stratified CV. As a first observation, we note that the im—
proved versions of the standard methods offer better performance.
This improvement is most notable for Park’s method, which
achieves this improved performance despite the fact that the clearly
suboptimal average operation was used to construct meta—genes.
This points to a relatively small impact of the integration step on the
performance of NOPs, an observation that can also be drawn from
Figure 2b.

Secondly, as a general trend, all methods produced a similar per—
formance using the random network compared with the case where
biologically relevant networks are used. The only exception is the

oPrk method, which performs slightly better when a random net—
work is used. The negligible positive contribution of biologically
relevant networks on performance of NOPs has been previously
observed (Ein—Dor et 41]., 2005; Staiger et 41]., 2012, 2013). The most
likely explanation for this is the presence of large number of genes
that are correlated with the target label which, in turn, makes it
possible to construct many alternative features with comparable
performance (Ein—Dor et 41]., 2005; Venet et 41]., 2011). This points
to a limited inﬂuence of the selection step on predictive power
of NOPs.

Based on these two observations, it can be concluded that the
most important factor in the performance improvement is the simul—
taneous selection and integration achieved by the Lasso. This is
most clearly demonstrated by comparing oChg with iChg in
Figure 4, as employment of the Lasso is the only difference between
these methods.

Even though existing methods can easily be improved by includ—
ing a simultaneous selection and integration step, we observe that
FERAL still offers superior performance across all three networks
considered. This performance improvement is very significant
(P value < 7 X 10—8; paired t—test with the best other method iPrk
using the co—expression network). This demonstrates that, on top of
the SGL approach, it is beneficial to provide the classifier with a rich
collection of meta—genes based on different aggregation strategies.

Figure 4b shows the results for 10 repeats of the sampled leave—
one—study—out CV. As expected, all classifiers showed performance
reduction, but the general trends remain the same, that is the

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201umoq

9103 ‘0g15n8nv uo ::

i316

A.AIIahyar and J. de Ridder

 

l2D Co-Expr

N
888

...._ L
s3:
0%.:

"’Tfo'éfaiifigl'm
a 8 8
—urr+
+Ill+
r—ﬂl—r
are

lTyl

@-
,=:
0

I
m
.I:
9

Random Single

eeei eeee %

lPrk
Std

.1
E
Ill.

ibis-£-
32:: 5:“
'Sg% I-I-

lTyl
iChg
lPrk

Fig. 5. Stability measurement (using Fisher's exact test) for three different networks including I2D, Co-Expr and random network. The original version of the

standard methods produced a much a lower overlap between folds due to pre-ranking of meta-genes. Similarly, Lasso produced a low overlap due to random se-
lection of correlated features. FERAL obtained a higher gene set stability across folds for the I2D and Co-Expr network

standard methods performed poorly compared with their improved
counterparts and FERAL significantly outperforms all other classi—
fiers. It should be noted that, although FERAL achieves a better
overall performance, the overall classification performance improve—
ment stay relatively modest. It is likely that there is a limit on the
maximum performance that can be achieved for the problem at
hand (~70% AUC). This is in line with previous observations
(Staiger et (11., 2013; van Vliet et (11., 2008; Venet et (11., 2011).

3.2 Stability of marker genes

Finding robust marker genes is one of the key challenges in breast
cancer research as prognostic gene signatures identified in independ—
ent datasets often show little to no overlap. To assess how FERAL
and the (improved) standard methods perform in terms of signature
stability, we follow Staiger et al. and assess the stability of selected
gene across folds by means of a Fishers exact test. To this end, we
measured the overlap between the top 100 genes selected by each of
the methods in every fold (see Supplementary Section S5 for details
on these score functions). The leave—one—study—out CV was used
without subsampling, resulting in a 12—fold cross—validation and the
same initial genesets were used in each fold.

Figure 5 shows boxplots of the marker gene stability for all pair—
wise comparisons between the 12—folds. It is striking to see that
FERAL and the improved standard methods clearly have better
marker gene stability compared with the standard methods (least
significant P value: 1.7 X 10—52), which perform poorly, irrespective
of the network employed. For the oChg and oTyl methods, this can
be explained by the fact that only very few meta—genes are used in
the classifier, which apparently vary substantially between folds.
The poor consistency for the oPrk method is caused by a combin—
ation of variability of the linkage tree and unstable regression coeffi—
cients resulting from the Lasso.

The concordance is highest for FERAL, which even has signifi—
cantly improved marker gene stability compared with the improved
standard methods (least significant P value: 1.8 X 10—10). This dem—
onstrates that FERAL’s approach to refrain from a pre—filtering of
top genes or gene sets and providing the embedded feature selection
of SGL with all genes and many meta—genes using different operators
is beneficial for marker gene stability.

Marker gene stability is also improved compared with the single
gene classifier. This method performs a Lasso using all genes as pre—
dictors and therefore also no pre—filtering is applied in this method.
Nevertheless, the overlap of marker genes between folds is still
much lower than that obtained with FERAL (P value: 5.3 X 10—53).
One explanation is that Lasso randomly selects features if they are
highly correlated (Grave et (11., 2011). Another reason is that in dif—
ferent samples, separate—yet functionally related—genes play the
strongest role in predicting the outcome. As a result, in any subset of

the data, different marker genes will be selected. FERAL (and to
some extent also the improved standard methods) are able to miti—
gate this by exploiting network information and summarize func—
tionally related or interacting genes into meta—genes. This is
supported by the observation that marker gene stability is signifi—
cantly reduced when the random network is used (P value:
1.6 X 10—29). For the improved standard measures there is no sig—
nificance different in case the random network is used. Thus, al—
network
performance substantially, it is helpful in producing more stable sets

though utilizing information does not improve

of marker genes.

3.3 Functional enrichment of marker genes

If an NOP attains reasonable and robust performance and the
marker genes selected across the folds are stable, the selected genes
may be amenable to interpretation. This facilitates improved under—
standing of the underlying aberrant processes that play a role in this
complex disease. To assess whether the methods under study are
capable of detecting relevant genes, we evaluate the concordance of
sets of known cancer—related genes with the ranked set of genes pro—
duced by each methods under study using the AUC measure. For
this purpose, all genes are ranked based on the average score across
all folds and repeats of the leave—one—study—out cross—validation (see
Supplementary Section S5 for details). For a comprehensive evalu—
ation, we included a ranking based on the individual predictive
power of genes (indicated by Ind "') and further a random ranking of
genes (indicated by Rnd’i). We performed functional enrichment
based on a collection of nine cancer—related gene sets, including six
cancer—related GO terms (see Supplementary Section S8 for a com—
plete list of these genes within each set).

The observed enrichments obtained using the I2D network are
depicted in Figure 6a. The results show that all methods have very
modest enrichments not exceeding 0.6 for all but one cancer—related
gene set. The notable exception is the enrichment obtained with
FERAL, which is vastly superior and close to 0.7 for most cancer—
related gene sets and 0.75 for two of them. The enrichment obtained
using the Ind" ranking is generally poor, which confirms that differ—
ential expression analysis is unsuitable for finding genes involved in
the disease. Surprisingly, we observed a severe reduction of gene en—
richment using the co—expression network for all methods (see
Supplementary Section S6). This corroborates previous findings that
PPI networks capture regulatory interaction and functional relations
(Kelley and Ideker, 2005).

Taken together, these observations support those made in
Sections 3.1 and 3.2, that is incorporating network information
does not greatly improve performance, but it does contribute to sta—
bilizing the marker gene sets and finding the biologically relevant
genes.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201umoq

9103 ‘0g15n8nv uo ::

FERAL: network—based classifier with application to breast cancer outcome prediction i317

 

b
( } Gene enrichment using BINGO

 

F'
.4
on

P
...

9
r.»
U!

Enrichment score (rank nut]
E
— 1—r—' —1— r—

0.5

P». PM,
“‘“Wwﬁee

     

Pawf‘gtean. u
"we...

|||!3

ii

10 15
{carom-value}

3

Fig. 6. Gene enrichment. (a) Gene enrichment of top genes for each method when the I2D network is employed. The values on top of each group represent the

number of genes in each gene set. A notably increased enrichment is obtained using the gene sets produced by FERAL. (b) Result of top 15 gene enrichments by

BiNGO applied to top 400 genes provided by FERAL

(a) (b)
- -
- “m
- _ m -
mam BBL:
m I — I
ecu —
- -
— I E
m - m
M9 M0
Var Var —
Mln Min -
Mar: Illa):
Med - Med
m2 _ DA:
‘7 ° °

“1
a

41.5

'9
I?

(G) (d)
MOI-“m — "m"
- —
- - I
m M
 - _
cm - l
—
_ —
rum OONI’J
Mg “"0
W— W
"In Min
Mu — M-x
Med Med
DA2 m2 |
.— un a In w v.- II? a It! -
' q' d I? a

Fig. 7. Frequently identified gene sets by FERAL. The bars represent the median coefficient across folds, normalized to the range {71,1}. Background colors indi-

cate the correlation with target label ranging from positive (blue) to negative (red)

Finally, we used BiNGO (Maere et 41]., 2005) to determine en—
richment across all available gene sets. The hypergeometric test with
a Benjamini—Hochberg false discovery rate of 5% is performed for
detecting overrepresentation of the top 400 genes in the
GO_Biological_Process category. The top 15 most enrichment GO
categories are summarized in Figure 7b. Most significant enrich—
ments are observed in various functional categories related to regu—
lation, signaling and proliferation. This finding suggests that FERAL
is able to uncover a wide diversity of genes that may play a role in
the processes underlying breast cancer metastasis.

3.4 Interpretation of meta—genes in frequently selected
networks

Next, we investigated the selected gene sets and meta—genes by
FERAL and determine whether they provide new insights into the
mechanisms of breast cancer metastasis. To this end, we trained
FERAL using the leave—one—study—out CV and obtained optimized l1
and 22. In this model, still about 1000 gene sets received non—zero
coefficients. In an effort to reduce this further, while retaining the
most essential ones, 22 was increased until the number of selected
gene sets was less than 100 in each fold. The majority (66) of the se—
lected gene sets were selected in at least 10 of the 12—folds, demon—
strating the stability of selected gene sets across studies. These 66
gene sets were then investigated for relevance to breast cancer in
general and metastasis in particular (see Supplementary Section S9
for a complete list).

We performed gene set enrichment for all 66 gene sets using
BiNGO (see Supplementary Section S10 for a complete list). The
majority of gene sets (94%) were enriched (hypergeometric test with
a Benjamini—Hochberg false discovery rate of 5%) for key processes
involved in cancer development, such as signaling of cell growth and
survival, (regulation of) cell cycle, cell division, proliferation and
apoptosis. This shows that FERAL is able to retrieve coherent sets of
genes that are involved in cancer. We observe that for all gene sets,
at least one of the genes was selected as a predictor in the final
model. In the complete set of 66 gene sets, there were 11 that exclu—
sively used expression of individual genes. This corroborates the
finding that it is important to supply the classifier with the actual ex—
pression profiles of the genes (Babaei et 41]., 2011; Van den Akker
815611., 201 1).

Figure 7 displays four of the selected gene sets, along with their
median coefficient across the folds (horizontal bars) and association
of the individual genes with the survival label (shading behind the
gene names). In all four gene sets (and in 83% of all gene sets), a
meta—gene obtained a non—zero coefficient. In three cases (and in
62% of all gene sets), even more than one meta—gene was selected.
This demonstrates the importance of including multiple summariza—
tions of the gene expression in addition to expression profiles of the
genes. Finally, we note that the simple, yet effective, DA2 operator
was selected in gene set (a). This was the case in 33% of all gene
sets. Taken together, we observe that the final predictor was able to
exploit both the raw gene expression profiles and a number of care—
fully constructed meta—genes.

112 /3.IO'S[BIImOfp.IOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201umoq

9103 ‘0g15n8nv uo ::

i318

A.AIIahyar and J. de Ridder

 

Next we investigated each of the gene sets in Figure 7 using in—
genuity pathway analysis (IPA). Gene set (a) is strongly enriched for
p38 MAPK signaling (P value:1.4 X 10‘“). There is ample evi—
dence to suggest that MAPK signaling plays an important role in
breast cancer, specifically through Notch regulation (Izrailit et al.,
2013). Interestingly, among the genes in this gene set is P53, which
typically is not detected through differential expression analysis
(Chuang et al., 2007). In this gene set, P53 is also not directly
selected but is included in the final prediction model through
the meta—genes that are constructed using the DA2 and Median
constructors. IPA also suggested a strong involvement of these
genes in proliferation of T—lymphocytes (P value:1.5 X 10‘”).
This is of particular interest as tumor—infiltrating lymphocytes may
be a good biomarker and have recently been implicated in predicting
response to neoadjuvant chemotherapy in breast cancer (Mao et al.,
2014).

Gene set (b) was most enriched for PI3K/AKT signaling
(P value: 8.4 X 10‘s), which is one of the major pathways dir—
ectly related to proliferation and cancer and for which there exist
promising therapeutic intervention possibilities (Davis et al., 2014).
For the genes in gene set (c), IPA revealed a strong enrichment for
breast cancer regulation by stathmin1, a downstream target of
CDK1, which is included in gene set (c) (P value:1.4 X 10‘6).
This gene set also included RACGAP1, which was recently
shown to have prognostic significance in high—risk early breast
cancer (Pliarchopoulou et al., 2013). Finally, the gene set (d)
was significantly enriched for estrogen—mediated S—phase entry
(P value:2.9 X 10‘”). Estrogen is strongly implicated in breast
cancer risk due to its role in promoting division of breast cells
(Foster et al., 2001).

4 Conclusion

In this work, we proposed a network—based outcome prediction
method FERAL that exploits network information in molecular
classification of breast cancer outcome. Our method deviates from
traditional NOPs in two important aspects. First, FERAL includes
several different integration strategies to construct meta—genes,
including a novel supervised integration strategy. Our results indi—
cate that the final classification model frequently uses meta—genes
produced by these constructors, often even multiple meta—genes
based on the same gene set. This underscores the importance of ex—
tending traditional meta—genes based on a simple average. The se—
cond important improvement is that FERAL performs simultaneous
selection and training of the classifier by employing the SGL. This
mitigates the need for pre—ranking of genes and/or meta—genes,
which is likely to severely reduce the stability of selected genes.

FERAL reached a significant performance increase compared
with all standard NOPs, including those that contained significant
improvements made by us. This improvement was also obtained
using a random network, leading to the conclusion that the biolo—
gical knowledge encoded in the network is not used to obtain these
improvements. The stability of marker genes improves substantially
as a result of the procedure implemented in FERAL. This improve—
ment was not observed when the random network was used, indicat—
ing that the biological knowledge contributes to the stability of the
gene signatures. This improvement was exclusively observed for the
PPI network and not for the co—expression network.

Because FERAL attains robust performance and stable marker
gene selection, the selected genes and gene sets might reveal insight
into the underlying aberrant processes that play a role in this com—
plex disease. We find that almost all the gene sets used in the final

model were enriched for cancer related processes. The four gene sets
that were studied in more detail revealed very strong suggestive evi—
dence for their involvement in breast cancer, with clear links to
MAPK, PI3K and AKT signaling and regulation by stathmin1. In
summary, although classification performance of breast cancer out—
come obtained with NOPs is unlikely to improve beyond ~70%
AUC, we have shown that FERAL achieves much more stable
marker gene selection that enables valuable mechanistic insight into
the etiology of breast cancer.

Funding

This work was carried out on the Dutch national e—infrastructure with the
support of the SURF Foundation. J.d.R. was supported by the Netherlands
Organisation for Scientific Research (NWO—Veni: 639.021.233).

Conﬂict of Interest: none declared.

References

Albert,R. (2005) Scale-free networks in cell biology. ]. Cell Sci., 118, 4947—
4957.

Babaei,S. et al. (2011) Integrating protein family sequence similarities with
gene expression to ﬁnd signature gene networks in breast cancer metastasis.
In: Loog,M. et al. (eds), 6th IAPR International Conference, Pattern
Recognition in Bioinformatics (PRIB). Springer-Verlag Berlin Heidelberg,
Delft, The Netherlands, pp. 247—25 9.

Chen,G. et al. (2002) Evaluation and comparison of clustering algorithms in
analyzing ES cell gene expression data. Stat. Sin., 12, 241—262.

Cheng,W. et al. (2014) Graph-regularized dual lasso for robust eqtl mapping.
Bioinformatics, 30, i139—i148.

Chuang,H.-Y. et al. (2007) Network-based classiﬁcation of breast cancer me—
tastasis. Mol. Syst. Biol., 3, 140.

Cun,Y. and Frohlich,H. (2012) Prognostic gene signatures for patient stratiﬁ-
cation in breast cancer—accuracy, stability and interpretability of gene se—
lection approaches using prior knowledge on protein-protein interactions.
BMC Bioinformatics, 13, 69.

Cusick,M.E. et al. (2008) Literature—curated protein interaction datasets. Nat.
Methods, 6, 39—46.

Dao,P. et al. (2010) Inferring cancer subnetwork markers using density-con—
strained biclustering. Bioinformatics, 26, i625—i631.

Davis,N.M. et al. (2014) Deregulation of the egfr/pi3k/pten/akt/mtorc1 path-
way in breast cancer: possibilities for therapeutic intervention. Oncotarget,
5, 4603—4650.

Ein—Dor,L. et al. (2005) Outcome signature genes in breast cancer: is there a
unique set? Bioinformatics, 21, 171—178.

Fantozzi,A. and Christofori,G. (2006 ) Mouse models of breast cancer metasta—
sis. Breast Cancer Res., 8, 212.

Foster,J.S. et al. (2001) Multifaceted regulation of cell cycle progression by
estrogen: regulation of cdk inhibitors and cdc25a independent of cyclin
d1-cdk4 function. Mol. Cell. Biol., 21, 794—810.

Friedman,J. et al. (2010) A note on the group lasso and a sparse group lasso.
arXiv preprint arXiv:1 001.073 6.

Grave,E. et al. (2011) Trace lasso: a trace norm regularization for
correlated designs. In: Shawe—taylor,J. et al. (eds), Advances in Neural
Information Processing Systems 24: 25th Annual Conference on Neural
Information Processing Systems 2011, Neural Information Processing
Systems. pp. 2187—2195.

Guyon,I. et al. (2006) Feature Extraction: Foundations and Applications
(Studies in Fuzziness and Soft Computing). Springer—Verlag New York, Inc.,
Secaucus, NJ.

Hanahan,D. and Weinberg,R.A. (2000) The hallmarks of cancer. Cell, 100,
5 7—70.

Hanahan,D. and Weinberg,R.A. (2011) Hallmarks of cancer: the next gener-
ation. Cell, 144, 646—674.

Hua,J. et al. (2009) Performance of feature-selection methods in the classiﬁca-
tion of high—dimension data. Pattern Recognit., 42, 409—424.

112 /310'S[BIIJnOprOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} pap1201umoq

9103 ‘0g isanV uo ::

FERAL: network—based classifier with application to breast cancer outcome prediction i319

 

Izrailit,I. et al. (2013) High throughput kinase inhibitor screens reveal trb3
and mapk-erk/tgf pathways as fundamental notch regulators in breast can—
cer. Proc. Natl. Acad. Sci. USA, 110, 1714—9.

Kelley,R. and Ideker,T. (2005 ) Systematic interpretation of genetic inter—
actions using protein networks. Nat. Biotechnol., 23, 5 6 1—5 66 .

Lazar,C. et al. (2013) Batch effect removal methods for microarray gene ex—
pression data integration: a survey. Brief Bioinform., 14, 469—490.

Lee,E. et al. (2008) Inferring pathway activity toward precise disease classiﬁca-
tion. PLoS Comput. Biol., 4, e1000217.

Liu,I. et al. (2009) SLEP: Sparse Learning with Efﬁcient Projections.
Arizona State University, http://www.public.asu.edu/~jye02/Software/
SLEP.

Maere,S. et al. (2005) Bingo: a cytoscape plugin to assess overrepresentation
of gene ontology categories in biological networks. Bioinformatics, 21,
3448—3449.

Mao,Y. et al. (2014) The value of tumor inﬁltrating lymphocytes (tils) for pre-
dicting response to neoadjuvant chemotherapy in breast cancer: a systematic
review and meta-analysis. PLoS One, 9, e115103.

Park,M.Y. et al. (2007) Averaged gene expressions for regression.
Biostatistics, 8, 212—227.

Pliarchopoulou,K. et al. (2013) Prognostic signiﬁcance of racgapl mRNA ex-
pression in high-risk early breast cancer: a study in primary tumors of breast
cancer patients participating in a randomized hellenic cooperative oncology
group trial. Cancer Chemother. Pharmacol., 71, 245—55.

Pujana,M.A. et al. (2007) Network modeling links breast cancer susceptibility
and centrosome dysfunction. Nat. Genet., 39, 1338—1349.

Shapiro,C.L. and Recht,A. (2001) Side effects of adjuvant treatment of breast
cancer. N. Engl. I. Med., 344, 1997—2008.

Shen,R. et al. (2004) Prognostic meta-signature of breast cancer developed by
two-stage mixture modeling of microarray data. BMC Genomics, 5, 94.

Simon,N. et al. (2013) A sparse-group lasso. I. Comput. Graphical Stat., 22,
231—245.

Soneson,C. et al. (2014) Batch effect confounding leads to strong bias in per—
formance estimates obtained by cross—validation. PLoS One, 9, e100335.
Staiger,C. et al. (2012) A critical evaluation of network and pathway-based clas—

siﬁers for outcome prediction in breast cancer. PloS One, 7, e34796.

Staiger,C. et al. (2013) Current composite—feature classiﬁcation methods do
not outperform simple single—genes classiﬁers in breast cancer prognosis.
Front. Genet., 4, 289.

Symmans,W.F. et al. (1995) Breast cancer heterogeneity: evaluation of clonal-
ity in primary and metastatic lesions. Hum. Pathol., 26, 210—216.

Taylor,I.W. et al. (2009) Dynamic modularity in protein interaction networks
predicts breast cancer outcome. Nat. Biotechnol., 27, 199—204.

Van De Vijver, M.I. et al. (2002) A gene—expression signature as a predictor of
survival in breast cancer. N. Engl. I. Med., 347, 1999—2009.

Van den Akker, E.B. et al. (2011) Integrating protein-protein interaction net-
works with gene-gene co-expression networks improves gene signatures for
classifying breast cancer metastasis. I. Integr. Bioinform., 8, 188.

van Vliet, M.H. et al. (2008) Pooling breast cancer datasets has a synergetic ef—
fect on classiﬁcation performance and improves signature stability. BMC
Genomics, 9, 375.

van’t Veer, LI. et al. (2002) Gene expression proﬁling predicts clinical out-
come of breast cancer. Nature, 415, 530—536.

Venet,D. et al. (2011) Most random gene expression signatures are signiﬁ-
cantly associated with breast cancer outcome. PLoS Comput. Biol., 7,
e1002240.

Von Mering,C. et al. (2002) Comparative assessment of large-scale data sets
of protein—protein interactions. Nature, 417, 399—403.

Weigelt,B. et al. (2005) Breast cancer metastasis: markers and models. Nat.
Rev. Cancer, 5, 591—602.

Yuan,M. and Lin,Y. (2006) Model selection and estimation in regression with
grouped variables. I. R. Stat. Soc. B (Stat. Methodol.), 68, 49—67.

112 /310'S[BIIJnOprOJXO'SOIJ’BLUJOJIIIOICI”Zduq 11101} pap1201umoq

9103 ‘0g isanV uo ::

