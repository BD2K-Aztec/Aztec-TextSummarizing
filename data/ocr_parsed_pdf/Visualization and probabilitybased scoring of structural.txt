ORIGINAL PAPER

Vol. 30 no. 11 2014, pages 1514—1521
doi:10. 1093/bioinfonnatics/btu054

 

Sequence analysis

Advance Access publication February 4, 2014

Visualization and probability-based scoring of structural variants

within repetitive sequences

Eitan Halper-Stromberg1‘2'3'*

Sarven Sabunciyang'1O and Rafael A. Irizarry

, Jared Steranka4, Kathleen H. Burns
1,11

5,6,7,8
’

1Department of Biostatistics, Bloomberg School of Public Health, Johns Hopkins University, 2Program in Human
Genetics and Molecular Biology, Johns Hopkins University School of Medicine, 3Computational Bioscience Program,
University of Colorado, Denver, 4Department of Molecular Biology and Genetics, 5Department of Oncology, 6The Sidney
Kimmel Comprehensive Cancer Center, Johns Hopkins Hospital, 7Department of Pathology, Johns Hopkins University,
8High Throughput Biology Center, Johns Hopkins University School of Medicine, Johns Hopkins University, 9Center for
Epigenetics, Johns Hopkins University School of Medicine, 10Department of Pediatrics, Johns Hopkins University School
of Medicine, Baltimore, MD and 11Department of Biostatistics and Computational Biology, Dana Farber Cancer Institute,

Boston, Massachusetts, MA, USA
Associate Editor: Prof. Gunnar Ratsch

 

ABSTRACT

Motivation: Repetitive sequences account for approximately half of the
human genome. Accurately ascertaining sequences in these regions
with next generation sequencers is challenging, and requires a different
set of analytical techniques than for reads originating from unique se-
quences. Complicating the matter are repetitive regions subject to pro-
grammed rearrangements, as is the case with the antigen-binding
domains in the Immunoglobulin (lg) and T-cell receptor (TCR) loci.
Results: We developed a probability-based score and visualization
method to aid in distinguishing true structural variants from alignment
artifacts. We demonstrate the usefulness of this method in its ability
to separate real structural variants from false positives generated with
existing upstream analysis tools. We validated our approach using
both target-capture and whole-genome experiments. Capture
sequencing reads were generated from primary lymphoid tumors,
cancer cell lines and an EBV-transformed lymphoblast cell line over
the Ig and TCR loci. Whole-genome sequencing reads were from a
lymphoblastoid cell-line.

Availability: We implement our method as an R package available
at https://github.com/Eitan177/targetSquiew. Code to reproduce
the figures and results are also available.

Contact: ehalper2@jhmi.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on February 28, 2013; revised on November 10, 2013;
accepted on January 23, 2014

1 INTRODUCTION

Structural variants (SVs), including deletions, insertions, inver-
sions and translocations, are known to contribute to a wide
range of human phenotypes (Schinzel, 1988). High-throughput
technology has facilitated exciting ﬁndings, associating SVs
with multi-genic diseases like autism (Pinto, et al., 2010) and
schizophrenia (Stefansson et al., 2008), and revealing genomic

 

*To whom correspondence should be addressed.

rearrangements in cancer (Molenaar et al., 2012). Thousands of
genomic loci in humans are now known to vary structurally. Next
generation sequencing (NGS) is central to the ﬁeld, evidenced by
the high Visibility of consortia that use NGS, like the 1000
Genomes Project (The 1000 Genomes Project Consortium, 2010).

Despite group efforts and recent advances, discovering and
annotating the full landscape of SVs in humans is incomplete.
This is in part owed to the inaccuracy of NGS in deﬁning repeti-
tive DNA. Repetitive DNA, stretches of nucleotides present in
more than one copy in the haploid genome, accounts for about
half of the human genome. These stretches may be sub-classiﬁed
by length, copy number, base composition and linear organiza-
tion, all of which are difﬁcult to assay with NGS (Treangen and
Salzberg, 2012).

Paired-end mapping, the most widely used NGS method for
detecting SVs, has some ability to define SVs in repetitive se-
quences. The idea is to find readipairs that map with an unex-
pected distance or orientation relative to one another, therefore
implying an SV. When one or both ends of a readipair map to
the reference genome in multiple locations they provide evidence
for multiple, contradictory structural arrangements. This is par-
ticularly problematic with NGS because a standard approach,
among the most widely used aligners, is to randomly pick and
report only one location for reads that map to multiple locations.
This can easily lead to paired-end alignments that appear to be
SVs when in fact the reads were from a contiguous piece of the
reference genome. In this article we demonstrate how this is a
substantial problem in practice and present a method that greatly
helps ameliorate the problem.

Currently, a handful of tools, including HYDRA (Quinlan
et al., 2010), GASVPro (Sindi et al., 2012) and VariationHunter
(Hormozdiari et al., 2010), attempt to resolve the inconsistencies
generated from ambiguously mapped reads. HYDRA and
VariationHunter choose one alignment per read from a set of
possibilities to designate as correct. GASVPro weighs multiple
mappings per read in proportion to their probability.

Despite clever algorithms, the accuracy of these tools is limited
when the ends map ambiguously (this point will be demonstrated

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} papaolumoq

9103 ‘Og anﬁnV uo ::

Scoring of structural variants

 

in Section 3.2). As a result, one must either discard results in
repetitive DNA, or perform independent validation. One popular
form of the latter involves Visualizing alignments over candi-
dates. Several Viewers are available but there is a lack of options
tailored to discriminating false SVs from true SVs (Koboldt
et al., 2012).

We developed a probability-based score that can be used to
prioritize candidate SVs. Our score weighs two contradictory
hypotheses: readipairs either belong to both the junctions of
an SV, one read per junction or they belong to just one of the
junctions (Fig. 1). Because univariate scores are sometimes too
simplistic we also developed a Visualization tool for alignments
for candidate SVs. To avoid reinventing the wheel, the starting
point of our method is the outputs of the existing SV discovery
tools.

We illustrate the usefulness of our method on two experiments
both of which provided a way to validate ﬁndings (described in
detail in Section 2.2 and in the supplement). The first was a
typical whole-genome sequencing experiment and the second
was a target-capture sequencing on a region known to have a
high prevelance of SVs (Halper-Stromberg et al., 2013). For the
whole-genome experiment we sequenced a diploid lymphobas-
toid cell-line from an anonymized female individual (Halper-
Stromberg et al., 2011). For the capture experiment we targeted
sequences in the 1g and TCR loci in primary lymphoid cancer
samples, cancer cell lines and an EBV transformed cell line.
These loci, the building blocks of antigen binding domains in
immunoglobulins and T-cell receptors, are characterized by con-
secutive homologous sequences. This repetitive, segmentally
duplicated architecture makes these loci notoriously difﬁcult to
assay using NGS (Watson and Breden, 2012). These loci are
an area of much interest because of their fundamental role in
immunology and cancer (Mills et al., 2003).

At the heart of our contribution to SV detection, our proced-
ure ﬁltered out false positives resulting from repetitive sequence
in these data. For validation of our target-capture results we used
PCR. Our target sequence was enriched for segmental duplica-
tions about six times above the genome-wide level. They repre-
sented 37% of the target sequence while they are present in 5.7%
of the human genome. Of validated false positives in the target-
capture sequences, 75% (29/38) contained breakpoints overlap-
ping a segmental duplication. Importantly, we also identiﬁed true
SVs within segmental duplications in our target-capture data.
Of validated true positives in the target-capture, 50% (13/26)
contained breakpoints that overlapped a segmental duplication.
Segmental duplications were also a signiﬁcant source of spurious
results in our whole-genome data. Of validated false positives in
the whole-genome data, 48% (73/151) contained breakpoints
overlapping a segmental duplication while for true positives in
the whole-genome data only 15% (6/39) did so. To validate these
results we used readidepth-based CNV calls from three whole-
genome sequencing runs of our lymphoblast sample. Our results
demonstrate that our method effectively distinguishes artifacts
from true SVs in repetitive loci.

2 METHODS

We realign reads to three reference sequences, one supporting the SV
and two supporting contiguous fragments, one contiguous fragment for

junction 1 A SV—supporting realignment

—)

Junction 2

 

(I.
b

B Contiguous-fragmentrealignmenti C Contiguous-fragmentrealignmentl
—> ——-)

 

Fig. 1. Schematic of three alignments considered (A) readipair aligned so
as to support the existence of an SV. Each read in the pair aligns to one
side of the junction. Different colors indicate different loci within the
genome (B) The same readipair from (A) aligned so as to support a
contiguous sequence fragment, generated by sequence from junction 1.
(C) The same readipair from (A) aligned so as to support a contiguous
sequence fragment, generated by sequence from junction 2. The colors
indicate that the readipair supports the SV more so than either contigu-
ous sequence fragment since in each of (B) and (C), one of the reads does
not match the reference

each side of the putative junction. We summarize whether alignments
supporting the SV are better than both of the alignments supporting
contiguous fragments with a probability-based score. We also visualize
the three alignments to evaluate all of its aspects. In this section we pre-
sent the main ideas leaving some details in Supplementary Material.

2.1 Generating a candidate SV list

For our target-capture experiment, we generated a list of candidate SVs
using HYDRA, GASV (Sindi et al., 2009) (the Supplementary Material
explains why we did not use GASVPro with our target-capture data), and
VariationHunter. For our whole-genome experiment we used these three
tools as well as GASVPro. In both cases we mapped reads to the th9
reference and preprocessed alignment ﬁles as required by each tool
(details in the Supplementary Material).

For our target-capture experiment, we created a master list of follow-
up candidates using HYDRA. This was the ﬁrst software we used and
we undertook validation immediately upon generating candidates. We
generated candidates from GASV and VariationHunter primarily to
compare their prioritization against our method, not to make unbiased
comparisons (favors HYDRA) between the three existing methods.

For our whole-genome experiment, we created a master list of candi-
date SVs to interrogate for follow-up using results from all four tools,
HYDRA, GASV, GASVPro and VariationHunter.

2.2 Validation data

To obtain our validation set for the target-capture experiment we sub-
stantially ﬁltered the results of HYDRA in an attempt to retain only high
conﬁdence calls. Our filtering criteria required that a candidate: (i) be
supported by at least ﬁve readipairs, (ii) overlap with at least one of our
bait sequences and (iii) be supported by readipairs aligning with relatively
few mismatches (supporting readipairs were required to have a mean edit
distance <26). Only 70 candidate junctions met these three criteria. We
further processed this list down to 52 junctions, primarily with manual
inspection to remove likely artifacts (described in further detail in the
Supplementary Material). These 52 junctions were PCR validated. An
additional 12 junctions representing canonical V(D)J recombination were
not PCR validated but were assigned as true positives based on the fact
that canonical V(D)J recombination is an expected result in our samples.
Of the ﬁnal list of 64 junctions, validation revealed that 26 (41%) were
positives and 38 were negatives (59%).

 

1515

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papBOIH/noq

9103 ‘Og isnﬁnV uo ::

E.Halper-Stromberg et al.

 

To obtain validation for the whole-genome experiment readi
depth-based deletion calls were generated using independent software
on the results of three whole-genome sequencing runs on the same
lymphoblast sample. We created two low coverage (6X) single-end data-
sets and one higher coverage (15X) paired-end dataset. Speciﬁcally, we
generated readdepth-based deletion calls on all three of these samples
using ERDs (Zhu et al., 2012) and CNVnator (Abyzov et al., 201 l) on the
paired-end sample and CNVnator on the single-end samples (ERDs does
not work on low coverage samples). A candidate deletion was assigned as
positive if it was identiﬁed by readwlepth in the paired-end sample and at
least one of the single-end samples (further details in the Supplementary
Material).

We used these data to compare and contrast different approaches for
SV detection in terms of sensitivity and speciﬁcity.

2.3 Realignment

We realigned all reads within candidate SV sites using Smith7Waterman-
based alignment utilities provided through the Biostrings package (Pages
et al., 2013) in Bioconductor (Gentleman et al., 2004), with parameters
reﬂecting the probabilities of observing alignment errors, explained fur-
ther in Section 2.4 and Supplementary Material ‘Smith7Waterman align-
ment parameters’ (Malde, 2008). Note that available short-read aligners
are optimized for speed and memory efficiency as opposed to speciﬁcally
returning the three alignments per readipair most usede to determining
the accuracy of an SV. Note also that SV callers depend on third-party
alignment, e.g. Bowtie (Langmead et al., 2009), Bowtie2 (Langmead and
Salzberg, 2012), BWA (Li and Durbin, 2009), Novoalign (Novocraft,
2010) and MrFast (Alkan et al., 2009), and are bound to the alignments
in these third-party-generated ﬁles.

We recommend aligners that report multiple alignments per read.
If multiple alignments are not returned, false positives will be reduced
but at the cost of reduced sensitivity. Our method removes false positives
but cannot recover false negatives. Random placement is well suited to
readwlepth analysis but it denies direct comparisons of the three align-
ment patterns we seek.

Understanding precisely how a particular aligner will behave with
respect to repetitive sequences is outside the scope for most users and
contributes to the popularity of ignoring repetitive loci (Y u et al., 2012).
The complexity in choosing aligner settings and the potential for missing
alignments makes the case against dependence on primary alignments.
We believe Smith7Waterman realignment of reads mapping to candidate
SVs is a means to overcome the deﬁcits of placing full faith in an align-
ment ﬁle.

2.4 Probability-based score

After the SV software generates long lists of candidates (most of them
false positives) we need to isolate those that are likely to be SVs. The
naive approach of looking at quality metrics for the reported alignments
does not work because some reported SVs might have been just as likely
to come from a contiguous region, but this possibility was never con-
sidered. We developed a score-based relative evidence statistic: how much
more likely is this candidate to be an SV as opposed to an uninteresting
contiguous sequence. We will form a log-likelihood after deﬁning a prob-
ability model.

We made several simplifying assumptions for our likelihood model
similar to those made by SHRiMP (Rumble et al., 2009). These include
the assumption that mismatches and indels are independent of one an-
other and each other, within and across reads. We also assume mismatch
and indel rates are independent of genomic context. Further, we assume
that readipairs aligning at the junctions of a candidate SV either belong
at both junctions, thereby supporting the SV, or they belong at only one
of those junctions, thereby refuting the SV. We do not consider the scen-
ario whereby readipairs aligning at the junctions of one SV actually

belong to a different SV (it is for this reason that we recommend an
aligner that will report multiple alignments per read). With these assump-
tions in place we use a binomial distribution of mismatches and indels
within our experiment, again similar to SHRiMP (Rumble et al., 2009).
Our model, unlike SHRiMP, accounts for varying error rates along reads.
Position-speciﬁc error rates are known to affect Illumina short reads
(Bravo and Irizarry, 2010). The ends of reads are most negatively affected
due to the long cycle time of the first cycle and the tendency of phase
errors to accumulate at the end of a run (Kircher et al., 2009). To
accommodate this phenomenon we use a different binomial distribution
for each position within the reads.

For simplicity, our statistical model integrates only indels and mis-
matches because Illumina sequencing technology, in contrast to those re-
porting reads in color-space, does not allow mismatches to be easily
categorized as SNPs or errors when evaluating single reads. Of note,
we explored the possibility of separating mismatches into two separate
categories, SNPs and sequencing errors, by using concordantly called
mismatches at a given reference position across multiple reads
(Supplementary Figure S1), but we do not distinguish SNPs from sequen-
cing errors in the method presented here. Under our model the probability
of a sequencer generating mp mismatches in 1 reads at read position [7 is:

1 m 7m,
pm, 2 (mp  (1 _ ¢m,,)l -

Where I is the number of reads, mp is the observed number of mismatches
in all 1 reads at readiposition p and (pm, is the position-speciﬁc mismatch
rate. Similarly, the probability of a sequencer generating [p indels in 1
reads at readiposition p is:

W = (Dita — 

Where I is the number of reads, [p is the observed number of indels at
readiposition p, and 11>,” is the position-speciﬁc indel rate. We simplify
calculations by assuming independence, as SHRiMP did: the probability
of seeing mp and [p at a given readiposition was their product. The prob-
ability of a sequencer generating a group of aligned reads, each with some
observed number of mismatches and indels at each position, and assum-
ing positions are independent of one another is then:

pmj = H":1(pm, Xpi,)-

To estimate the rates of indels and mismatches within our experiments
we sampled 100 000 concordant readipairs, realigned these reads and
assigned the mismatch and indel rates for each readiposition to be the
means of observed mismatches and indels in the realignments at each
readiposition, respectively. This estimation was performed separately
for each experiment calculation of experiment-speciﬁc rates is a built-in
feature of our tool.

Now to actually construct the score in practice, for each candidate SV,
we ﬁrst extract readipairs from an alignment file that have one side map-
ping to each of the two loci indicated to be involved in the event. Second,
we realign these reads to three reference sequences, one supporting the SV
and two supporting contiguous fragments. Third, we compute the prob-
ability of each of these three alignments based upon a binomial model.

The score for the candidate SV is then the log likelihood comparing the
probability of the rearranged reference sequence generating the observed
reads versus the probability that the reads were generated from a con-
tiguous section of the reference with respect to either side of the candidate
junction.

pg
L = l — .
0g (max (pg. ,pc2 ))

Here [76 is the probability of a rearranged reference sequence generating a
group of observed reads, p,l is the probability of a contiguous sequence

 

1516

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papBOIH/noq

9103 ‘Og isnﬁnV uo ::

Scoring of structural variants

 

taken from the 5’-side of candidate junction generating those reads, and
[7,, is the probability of a contiguous sequence taken from the 3’-side of a
candidate junction generating those reads. Since we generate probabilities
for each of the two possible contiguous fragments, we use only the prob-
abilities from the fragment with the better alignments to construct the
likelihood. This fragment is the more likely of the two possible contiguous
sequences to be the true fragment generating the reads.

2.5 Visualization method

The three alignment conﬁgurations for each candidate SV are made into
a picture to provide an intuitive representation of the data used to con-
struct the likelihood. Realigned readipairs are represented as gray bars,
one readipair per row, with black caps added to the 3’-end of each
aligned read to signify the alignment orientation. Red dashes within the
reads represent mismatches between the read and reference. Light blue
within reads represent deletions, or a split-read. If the blue within a read
crosses a junction, i.e. between the left and right pictures representing the
5’- and 3’-junctions of the SV, respectively, the read is a split-read.
Deleted bases at the ends of reads are not shown, and appear as shor-
tened bars. The three alignments are always shown with the alignment
supporting the SV on top and the two alignments supporting contiguous
sequences below.

3 RESULTS

We used our method with four SV ﬁnders, HYDRA, GASV,
GASVPro and VariationHunter, to analyze sequences from
whole-genome and targeHzapture data. The ﬁnal validation set
from the whole-genome data included 190 distinct deletions, 39
(21%) positives and 151 (79%) negatives and 64 distinct SVs, from
the target-capture, 26 (41%) positives and 39 (59%) negatives.

Our sequencing library for the targetwapture experiment
included fragments selectively captured from V(D)J loci on
chromosomes 2, 7, 14 and 22 in a panel of neoplastic B and T
lymphocytes and an EBV transformed cell line. Each of the three
SV callers we used for this dataset, HYDRA, GASV and
VariationHunter, returned many results. GASV and HYDRA
returned a similar quantity (>13 000 and >12 000, respectively)
while VariationHunter returned 843. The callers also returned
many results for the whole genome sample. Two callers,
GASVPro and VariationHunter, returned >8000 results, and
the other two callers, GASV and HYDRA, returned >58 000
and >30 000, respectively.

Without accurate prioritization, a result list with thousands of
calls is not particularly useful. Based upon validation of 64 junc-
tions in the targetwapture dataset, and 190 deletions in the
whole-genome sample, a small fraction of all candidate SVs,
the callers did not appear to adequately provide this capability.
Caller performance individually (see Section 3.1) and in combin-
ation, using agreement between callers, was wanting, especially
for the targetwapture experiment.

In our targeticapture dataset, agreement between callers was
relatively low and did not serve to distinguish validated true
positives from false positives. When considering the top 500
calls from each method, ~74% were made by only one
method, ~20% were made by exactly two methods and ~7%
were made by all three (Fig. 2A). The existence of calls made by
multiple methods raised the possibility of using consensus to
circumvent the weaknesses of any individual caller. However,
when considering the validated SVs, this prospect did not

A Ta rget—capture B Wh ale-3e name
HYDRA HYDRA

    

5,.

GASVPro Uar-aiionHunzer

aAsv

Var IalinnHunte:

Fig. 2. Overlap between the top 500 candidate junctions reported by
three methods. GASV is prioritized based upon coverage, GASVPro is
prioritized based upon the log likelihood score ﬁeld, VariationHunter is
prioritized based upon the heuristic score ﬁeld, and HYDRA is priori-
tized based upon the ﬁnal weighted support ﬁeld. Numbers in parentheses
represent validated junctions in the top 500, annotated as (true positives,
false positives)

translate to reality. In the call sets of top 500 candidates, there
were nearly equal proportions of validated true positives and
false positives called by multiple methods. In these sets, 24
false positives, 63% of those validated and 18 true positives,
69% of those validated, were reported by at least two callers.
Additionally, there was no apparent advantage to distinguishing
between calls made by exactly two methods and calls made by all
three methods. Five out of the 18 true positive calls made by
multiple methods (28%) were made by all three methods. Eight
out of the 24 false positive calls made by multiple methods (25%)
were made by all three methods.

We show results for agreement between HYDRA
VariationHunter, and GASVPro for the whole-genome sample
because we were able to use GASVPro, a probabilistic version of
GASV, in the whole-genome case. When considering the top 500
calls from each method, 55% were made by just one method,
20% were made by exactly two methods and 25% were made by
all three (Fig. 2B). Of validated deletions within this set, calls
made by multiple methods were enriched for true positives much
more than false positives. Twenty true positives, 51% of those
validated, were reported by at least two callers, while only seven
false positives, 5% of those validated were reported by at least
two callers.

Based on these results, using agreement between callers to
prioritize candidates was a mixed bag. It was not useful for the
targeticapture and somewhat useful for the whole-genome re-
sults. In the whole-genome sample, calls made by multiple meth-
ods were trustworthy compared with calls made by just one
method, yet about half of validated positives were not multiple
method calls. These data indicated that a different prioritization
was needed.

3.1 Superior prioritization using likelihood
In our targetwapture dataset we assigned 26 of the candidate
SV junctions originating from the output of HYDRA as true

 

1517

112 /310's1nu1nofp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

E.Halper-Stromberg et al.

 

positives and 38 as false positives. This was based upon PCR (52
junctions) or the observation of canonical V(D)J recombination
(12 junctions). Most (14) validated junctions were deletions al-
though there were many (9) inversions and a few translocations
(3). A table describing the breakdown of all 64 tested junctions is
included in the supplement (Supplementary Table S1). We tested
the performance of each of the three methods that were compat-
ible with targetwapture data against our likelihood score using
these 64 junctions (Fig. 3A). The truncated curves for
VariationHunter and GASV are owed to our choosing validation
junctions based upon the candidate list from HYDRA. As a
result, some of these SVs, both true positives and false positives,
did not appear in the results from the other two methods. The
ROC-like curve shows the superiority of our scoring method,
with the three other methods performing similarly to each
other by comparison. The plot is ROC-like rather than a true
ROC because it only contains validated junctions, not all of the
many thousands of results returned by the tested methods. That
said, likelihood scores of the top 500 candidates from each
method suggested that our validation set included most of
the positive events present in the targeticapture dataset
(Supplementary Figure S2). Of note, the three especially high
scoring false positives in Figure 3A, signiﬁed by horizontal seg-
ments at y-axis positions 6, 14 and 17, may, in fact, be PCR
failures. All three occurred in the same sample (pre-B ALL)
and PCR produced multiple bands in both control and sample
DNA. They are assigned as false positives because we could not
decisively conclude that they were real based upon the validation.

To assess performance on the whole-genome sample, we
restricted results of HYDRA, GASV, GASVPro and
VariationHunter to high conﬁdence deletions >8-kb long. We
used this cutoff because the majority, 81%, of the validation
regions were >8-kb long. We focused on the top 100 calls meet-
ing these criteria from HYDRA and VariationHunter, and all
such calls from GASV (82 total) and GASVPro (39 total). As
with the targetwapture data, we compared the prioritization of
validated positive and negative deletions from existing methods
to our likelihood score (Fig. 3B). For the whole-genome analysis
we were also able to incorporate GASVPro results, as this tool is
compatible with whole-genome data. From this dataset we as-
signed 39 of the candidate deletions originating from the output
of one of the four tools as true positives and 151 as false posi-
tives. Only deletion candidates >8-kb long were considered for
follow-up due to our validation technique, which was based on
readwlepth. Again, the ROC-like curve demonstrated the advan-
tage of our method. Notably, GASVPro performs quite well in
relation to the other three existing methods, and only slightly
underperforms relative to our likelihood score. Based upon this
result we recommend our tool most avidly for reprioritizing can-
didate deletions from HYDRA, GASV and VariationHunter in
whole genome data. We recommend a cut-off score of 100, a
compromise between our whole-genome and our targetwapture
results. A cutoff score of 170 is optimal for our targetwapture
experiment, as this is the score at the inﬂection point
in Figure 3A, however it is too conservative for our whole-
genome results, which scored somewhat lower in general than
the targetwapture results (Supplementary Figure S3). A score of
100 enables us to identify 34 of 39 (87%) true positives while still

Whole-genome

A Target-capture B

h'aklmd

    

    

Hal-am am Gwen-cal VtDH'

— GASV
- GASVPIU

— GASV
- HYDRA

— Semi-aw — HYDRA
-— VariationHunter — Sailfish!
u-I- Variallmﬂunlar
Felon Muslim Failed “Damian

Fig. 3. ROC-like plot comparing our method to four existing methods
for a subset of validated results. (A) Results for target-capture sequen-
cing. The blue line represents our method, prioritized based upon our
likelihood score. Numbers along the blue line indicate our likelihood
scores at ranked positions indicated by the arrows (28, 30 and 33).
Ranked scores 3M4 all are false positives. Green, red and purple lines
represent the other methods tested. GASV is prioritized based upon
coverage, VariationHunter is prioritized based upon the heuristic score
ﬁeld and HYDRA is prioritized based upon the ﬁnal weighted support
ﬁeld. (B) Results for whole-genome sequencing. Colors and candidate
prioritizations are the same as panel (A). Since GASVPro works on
whole-genome data we show results for this method as well, prioritized
by the log likelihood score ﬁeld. Numbers along the blue line indicate our
likelihood scores at ranked positions indicated by the arrows (39, 51 and
64). Ranked scores 6&190 all are false positives

ruling out 134 of 151 false positives (89%) in the whole-genome
data (Fig. 3B).

3.2 Why the likelihood approach works

The likelihood approach worked because it focused on one
simple characteristic that deﬁned events that failed to valid-
ate: realignment of supporting reads was consistent with the
unrearranged reference (Fig. 4). For instance, the event shown
in Figure 4 is a false positive chromosomal translocation. It
was called in our Ramos cell-line by GASV and HYDRA.
Figure 4A depicts the reads supporting the candidate deletion
as demonstrated by the majority of the readipairs mapping one
end to each of the two loci and oriented towards each other.
Figure 4B and C show realignments of these same reads in con-
figurations consistent with an unrearranged sequence. Both ends
of readipairs map well to side 1 (Fig. 4B) of the alleged junction
and to a lesser, but still noticeable extent, side 2 (Fig. 4C),
demonstrating that these two loci are homologous. Without
the information in Figure 4B and C, it would be difﬁcult to
know that this candidate SV is a false positive. It is through
our realignment scheme that we obtain the information to do
this comparison, information that upstream SV callers cannot
access since they do not manipulate read alignments, and instead
rely on an alignment file ‘as is’. The score provides a one number
summary useful for prioritization.

3.3 Importance of Visualization

Visualization is not strictly necessary to use our method but there
are reasons it is a feature. For one, the research community
commonly integrates Visualization of read alignments into

 

1518

112 /310's1nu1nofp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Scoring of structural variants

 

Alignment supporting a structural varianl
31¢“ Miami—1m

mzwsmim

 

Coverage

 

 

Coverage

 

Fig. 4. Visualizing a false positive. (A) Realignment of readipairs from a
PCR-validated false positive to a repetitive region of chromosome 15 and
the IGH locus on chromosome 14. Each row shows one readipair, with
19 junction spanning readipairs shown in total. Red indicates mis-
matches. Black caps signify the 3’-end of the read. For pairs with over-
lapping read alignments the black cap is indicative of the 3’-end of the
forward read. Readipairs are connected with lines (with a short gap at
the junction). (B) Same reads as (A) aligned to an expanded reference
section from the left side of (A). (C) Same reads as (A) aligned to an
expanded reference section from the right side of (A)

next-generation sequencing data-analysis pipelines. Second,
available Viewers are not capable of also realigning reads, so
they will not be able to show our realignments, which are crucial
to conveying the information in our score. Since we are unaware
of a Viewer that is also an aligner our provided Visualization is
likely the most convenient way to produce alignment Views gen-
erated by our method. Viewing also provides more detail than a
univariate score, including coverage, error locations within reads
and read orientations.

To illustrate the point, consider two validated positive junc-
tions, an interstitial deletion in the ARH-77 cell line (Fig. 5A)
and a t(14;l8) junction on der(l4) in the DB cell line (Fig. 5B).
In both cases we observed that the nucleotides right at the
breakpoint did not match the reference sequence. In Figure
5A, mismatching breakpoint sequence is identiﬁable as stretches
of red at the ends of most aligning readipairs. In Figure 5B,
mismatching breakpoint sequence is identiﬁable within split-
reads crossing the deletion junction. Flanking the split, illustrated
with light blue bars, are thin areas of red, representing mis-
matches. These mismatching bases are a normal phenomenon
resulting from V(D)J recombination and are owed to the activity
of the enzyme terminal deoxynucleotidyl transferase (TdT).

CCGMCL‘mMACGGCAECTm
TTTCTGACACTCTCAGRATGTGGGHTTCMTGTGTCTGDCWCTCTCGQCAGTMTMCGGGGGTGTCCWG
Side I ChrMﬂmW—Imm1 I aide z cm4-1cmszm—1umaso5

      
 

coverage

 

 

  

COHIiﬁIIDl-B Fraulluml Nigan Side 2

coverage

 

 

' 'EAAATGGGECC
immature:caGmmcmmmmc“mmctmmmmuamcmmmmmmc
I I 5168 I mn‘klmm-lmlm  2 m1a:m?85945-BO?BGE1?

 

 

 

 

 

 

Fig. 5. Observing added bases at the breakpoints of two events. (A) Top:
realignment of reads from the ARH-77 cell line to reference positions
indicating an interstitial deletion with inserted bases on chromosome 14.
Black caps indicate the 3’-end of the reads. The extra bases may be seen as
red at the ends of the reads abutting the breakpoint, as these are mis-
matches between the reference and the reads. Readipairs are connected
with lines (with a short gap at the junction). The sequence of a split-read
is shown above the alignment, with added bases in red above bases
matching the two sides of the reference. Bottom: the same readipairs
as in panel (A), aligned to expanded sections of the reference sequences
from the two sides of the above junction. (B) Top: realignment of reads
from the DB cell line indicating a [(14;18) chromosomal translocation.
Rows with light-blue bridging the two sides of the junction are split-reads.
The added bases may be seen as red at the ﬂanks of split positions. The
sequence of a split-read is shown above the alignment, with added bases
in red above bases matching the two sides of the reference. Bottom: same
reads as (B) top aligned to expanded sections of the reference from the
two sides of the above junction

Above the alignments we include the sequence of a split-read
crossing each junction, with bases matching the reference
sequence at the two involved loci in black and mismatched,
untemplated bases in red. We include Sanger Sequencing results
for these two junctions in the Supplementary Material (section
‘Sanger Sequencing’). TdT is known to add untemplated bases at
the junctions of juxtaposed V(D)J coding segments in B and T-
cell lymphocytes. Visualizing these junctions facilitated the iden-
tiﬁcation of TdT activity, and though it was not necessary to
conﬁrm the events, added to understanding the events at a mo-
lecular level.

 

1519

112 /310's1nu1nofp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

E.Halper-Stromberg et al.

 

4 DISCUSSION

We have shown that our method for distinguishing false positives
from true SVs is a useful addition to upstream analysis tools.
It enables assessment of candidate SVs, either individually, as
part of manual inspection of alignments (Figs 4 and 5), or in
summary with a probability-based score. Without our post-
processing Visualization and scoring, we would have had an un-
manageably large list of candidate SVs replete with artifacts.
Although our method relies on assumptions known not to
hold exactly, approximate model permits the implementation
of a fast and stable algorithm that greatly improves downstream
results. Extending our method to avoid depending on these
assumptions is a matter of future work.

Our method retains the sensitivity to detect events within
repeat elements demonstrated on segmental duplications. Our
method is an improvement over existing tools for distinguishing
likely artifacts within these regions (Fig. 3). Of note in the ROC-
like plot depicting our targetwapture data (Fig. 3A), the slightly
decreased slopes of GASV and VariationHunter in comparison
to HYDRA are likely not due to true underperformance but
rather to selection bias in our choice of candidates to validate.
The important feature of the plot is to demonstrate our superior
classiﬁcation of candidates in the repetitive loci present in our
data. Accordingly, our scheme successfully identiﬁed 19 SVs
having at least one junction within a segmental duplication (13
in the target-capture and six in the whole-genome sample) while
ruling out another 102 (29 in the target capture and 73 in the
whole-genome sample) candidate junctions within a segmental
duplication that did not validate (Supplementary Material).
Because our method serves not only to rule out candidates in
repetitive DNA, but also to identify true events in these regions,
it is not simply a proxy for sequence masking algorithms like
repeatMasker (Smit et al., 199G2010).

Visual inspection of read alignments is an important means
for candidate SV follow-up for good reason. Resolving sequences
from short reads generated from repetitive regions of the genome
is challenging. As such, skepticism towards the initial results of
an analysis pipeline designed to use these alignments to detect
SVs is warranted and a post-candidate—list—analysis step appears
to be the de-facto norm. Alignment Viewers, such as the
Integrative Genome Viewer (IGV) (Robinson et al., 2011), are
popular, but not specifically designed for the task. In fact, there
is a general lack of systematic approaches for candidate SV
analysis. Furthermore, statistical models of the SV detection
problem fail to incorporate important information, such as
cycle-dependent error rates. Our method models this but none
of the others we tested do so.

We provide our Visualization scheme in recognition of the
large role alignment Viewers have come to play. Inspecting the
three alignments per candidate SV necessary to understand our
likelihood score seems likely to be a part of any pipeline that
would integrate our method. As such, this feature is convenient
since it will be easier to generate Visualizations using our tool
rather than to do so independently, a process that would involve
both realignment and side-by-side Viewing of realignments in a
Viewer. Our Visualization also provides more information than is
possible with a one-number score. This is apparent by the fact
that Visualization helped to identify nucleotides added by the

enzyme terminal deoxynucleotidyl transferase (TdT) at the junc-
tions of juxtaposed V(D)J coding segments in our targetwapture
experiment (Fig. 5). Of note, for those uninterested in Visualiza-
tion and only seeking a quick result, we also provide a faster
implementation of our score that skips plotting and only per-
forms a fraction of the full realignment (described further in
the Supplementary Material section ‘R Package Notes:
Implementation of the probability score’).

High-throughput short-read technology has facilitated single-
base inspection of much of the human genome. However, we
believe that manual scrutiny of repetitive region alignments will
remain popular and necessary until the ambiguity surrounding
these alignments is resolved with superior technology. This likely
will remain especially true in cases where the standard reference
genome is known to be an untrustworthy representation of the
genome in question, as is the case with cancer genomes and cell
lines. Here we have handled these types of genomes and shown
that likelihood scoring and Visual inspection of candidate SVs
is an effective means to eliminate a common type of artifact
appearing in lists of events generated by upstream analysis
techniques.

ACKNOWLEDGEMENTS

The authors would like to thank Dr Robert Scharpf for helpful
discussions regarding Visualization techniques.

Funding: The National Institutes of Health (R01HG005220).

Conﬂict of Interest: none declared.

REFERENCES

Abyzov,A. et al. (2011) CNVnator: an approach to discover, genotype, and char—
acterize typical and atypical CNVs from family and population genome sequen—
cing. Genome ReS., 21, 974w984.

Alkan,C. et al. (2009) Personalized copy number and segmental duplication maps
using next—generation sequencing. Nat. Genet, 41, 106171067.

Bravo,H.C. and Irizarry,R.A. (2010) Model—based quality assessment and base—
calling for second—generation sequencing data. Biometrics, 66, 665$74.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com—
putational biology and bioinformatics. Genome Biol., 5, R80.

Halper—Stromberg,E. et al. (2011) Performance assessment of copy number micro—
array platforms using a spike—in experiment. Bioinformatics, 27, 105271060.

Halper—Stromberg,E. et al. (2013) Fine mapping of V(D)J recombinase mediated
rearrangements in human lymphoid malignancies. BMC Genom., 14, 565.

Hormozdiari,F. et al. (2010) Next—generation VariationHunter: combinatorial algo—
rithms for transposon insertion discovery. Bioinformatics, 26, i3507i357.

Kircher,M. et al. (2009) Improved base calling for the Illumina Genome Analyzer
using machine learning strategies. Genome Biol., 10, R83.

Koboldt,D.C. et al. (2012) Massively parallel sequencing approaches for character—
ization of structural variation. Methods M0]. Biol., 838, 3697384.

Langmead,B. and Salzberg,S.L. (2012) Fast gapped—read alignment with Bowtie 2.
Nat. Methods, 9, 3577359.

Langmead,B. et al. (2009) Ultrafast and memory—efficient alignment of short DNA
sequences to the human genome. Genome Biol., 10, R25.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows—
Wheeler transform. Bioinformatics, 25, 17544760.

Malde,K. (2008) The effect of sequence quality on sequence alignment.
Bioinformatics, 24, 8977900.

Mills,K.D. et a]. (2003) The role of DNA breaks in genomic instability and tumori—
genesis. Immunol. Rev., 194, 77795.

Molenaar,J.J. et al. (2012) Sequencing of neuroblastoma identiﬁes chromothripsis
and defects in neuritogenesis genes. Nature, 483, 5897593.

Novocraft (2010) Novoalign. Novocraft, Selangor, Malaysia.

 

1520

112 /310's1eu1nofp101x0"sotwuiJOJHtotq/ﬁduq 111011 papao1umoq

9103 ‘0g1sn8nv uo ::

Scoring of structural variants

 

Pages,H. et al. (2013) Biostrings: string objects representing biological sequences,
and matching algorithms. R package version 2.28.0.

Pinto,D. et al. (2010) Functional impact of global rare copy number variation in
autism spectrum disorders. Nature, 466, 3687372.

Quinlan,A.R. et al. (2010) Genome—wide mapping and assembly of structural vari—
ant breakpoints in the mouse genome. Genome Res, 20, 623$35.

Robinson,J.T. et al. (2011) Integrative genomics viewer. Nat Biotechnol., 29,
2426.

Rumble,S.M. et al. (2009) SHRiMP: accurate mapping of short color—space reads.
PLoS Comput Biol., 5, e1000386.

Schinzel,A. (1988) Microdeletion syndromes, balanced translocations, and gene
mapping. J. Med. Genet, 25, 454—462.

Sindi,S. et al. (2009) A geometric approach for classiﬁcation and comparison of
structural variants. Bioinformatics, 25, i2227i230.

Sindi,S.S. et al. (2012) An integrative probabilistic model for identiﬁcation of struc—
tural variation in sequencing data. Genome Biol., 13, R22.

Smit,A.F.A. et al. (199G2010) RepeatMasker Open—3.0. Available at http://www.
repeatmaskerorg.

Stefansson,H. et al. (2008) Large recurrent microdeletions associated with schizo—
phrenia. Nature, 455, 2327236.

The 1000 Genomes Project Consortium (2010) A map of human genome variation
from population—scale sequencing. Nature, 467, 106171073.

Treangen,T.J. and Salzberg,S.L. (2012) Repetitive DNA and next—generation
sequencing: computational challenges and solutions. Nat Rev. Genet, 13,
36—46.

Watson,C.T. and Breden,F. (2012) The immunoglobulin heavy chain locus: genetic
variation, missing data, and implications for human disease. Genes Immun., 13,
3637373.

Yu,X. et al. (2012) How do alignment programs perform on sequencing data with
varying qualities and from repetitive regions? BioData Min., 5, 6.

Zhu,M. et al. (2012) Using ERDS to infer copy—number variants in high—coverage
genomes. Am. J. Hum. Genet, 91, 4084121.

 

1521

112 /310'S[Buln01pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papao1umoq

9103 ‘0g1sn8nv uo ::

