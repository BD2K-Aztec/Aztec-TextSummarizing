ORIGINAL PAPER

Vol. 30 no. 11 2014, pages 1555-1561
doi:1 0. 1093/bioinfonnatics/btu088

 

Gene expression

Advance Access publication February 11, 2014

Analysis of gene expression data using a linear mixed model/finite
mixture model approach: application to regional differences in the

human brain

Daniah Trabzuni1'2, the United Kingdom Brain Expression Consortium (UKBEC)1 and

Peter C. Thomson”

1Department of Molecular Neuroscience, UCL Institute of Neurology, Queen Square, London WC1 N 38G, UK,
2Department of Genetics, King Faisal Specialist Hospital and Research Centre, Riyadh 11211, Saudi Arabia and
3ReproGen — Animal Bioscience Group, Faculty of Veterinary Science, The University of Sydney, 425 Werombi Road,

Camden, NSW 2570, Australia
Associate Editor: Ziv Bar—Joseph

 

ABSTRACT

Motivation: Gene expression data exhibit common information over
the genome. This article shows how data can be analysed from an
efficient whole-genome perspective. Further, the methods have been
developed so that users with limited expertise in bioinformatics and
statistical computing techniques could use and modify this procedure
to their own needs. The method outlined first uses a large-scale linear
mixed model for the expression data genome-wide, and then uses
finite mixture models to separate differentially expressed (DE) from
non-DE transcripts. These methods are illustrated through application
to an exceptional UK Brain Expression Consortium involving 12 human
frozen post-mortem brain regions.

Results: Fitting linear mixed models has allowed variation in gene
expression between different biological states (e.g. brain regions,
gender, age) to be investigated. The model can be extended to
allow for differing levels of variation between different biological
states. Predicted values of the random effects show the effects of
each transcript in a particular biological state. Using the UK Brain
Expression Consortium data, this approach yielded striking patterns
of co-regional gene expression. Fitting the finite mixture model to the
effects within each state provides a convenient method to filter tran-
scripts that are DE: these DE transcripts can then be extracted for
advanced functional analysis.

Availability: The data for all regions except HYPO and SPCO are
available at the Gene Expression Omnibus (GEO) site, accession
number GSE46706. R code for the analysis is available in the
Supplementary file.

Contact: peter.thomson@sydney.edu.au

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 20, 2013; revised on January 14, 2014; accepted
on February 6, 2014

1 INTRODUCTION

Research efforts in molecular and cellular biology are Vital to
develop our understanding of, for example, the human central

 

*To whom correspondence should be addressed.

nervous system (CNS) function, and to dissect the functional
complexity and the progress of diseases. These rapid advance-
ments were mainly determined by the genomic, transcriptomic
and diagnostic technological innovations (Geschwind and
Konopka, 2009). These technologies, such as expression arrays
and RNA sequencing, are applicable at the genome-wide scale,
and their application results in more insightful information being
produced, and this can lead towards more informed investiga-
tions and in turn through to clinical applications. However, the
analyses and the volume of the data that are generated from
these complex techniques are computationally challenging. To
date, there is no standard protocol available to normalize and
process the raw data from these experiments into a manageable
format that can then be further interrogated on a personal com-
puter and to align and assemble the data to a reference genome
by scientists with no great experience in bioinformatics
(Auer et al., 2012).

With expression arrays and RNA sequencing increasing in
coverage and reducing in cost, they are now widely used with
increasingly large sample sizes. Consequently, there is an ongoing
need to develop and assess computationally efficient means of
analysing ‘big data’. Although there is no ‘universal’ approach to
gene expression analysis, the conventional approach is to con-
sider a model for one gene at a time, and consider if this par-
ticular gene is differentially expressed (DE) between any of the
biological states considered, for example, as implemented in the
limma package of R (Smyth, 2004). Naturally, this results in an
extreme multiple testing situation, which is usually overcome by
using an appropriate false discovery rate (FDR) control, such as
the q-value procedure. The alternative is to consider a global
model for all the expression data and replace the many thou-
sands of null and alternative hypotheses by more global tests to
dissect causes of variation in gene expression. Such an approach
would have two advantages. First, transcripts are not independ-
ent identities, and there is much common information across the
genome, so combining this would be expected to increase power
of signal detection. Second, although a more philosophical point,
we question whether it is best practice to consider many thou-
sands of separate hypotheses: as students, we were taught the
importance of writing out the null and alternative hypotheses

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 1555

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq uteri papeolumoq

91oz ‘Og anﬁnV uo ::

D. Trabzuni et al.

 

for every statistical test, and this pragmatic approach would seem
to fail here. So a global or genome-wide approach can be
achieved by ﬁtting linear mixed models (LMMs) to all the
data, for example, as has been done by Kerr et a]. (2000), with
the variation between transcripts as another source of variation.
Ji and Liu (2010) suggested a similar process using hierarchical
models. One potential limitation of the approach of using an
LMM fitted to all the expression data is that it may not allow
for differences in variability in expression across the biological
states of the system under study. For example, in the human
brain, some regions of the brain show greater levels of variation
in gene expression than in other regions, However, improve-
ments in LMM software, for example, as described in Butler
et al. (2007) and Pinheiro and Bates (2000), allowing ﬂexible
variance structure modelling, make it worthwhile again consider-
ing the use of large-scale LMMs in expression data analysis.

Fitting LMMs by themselves does not lead to the determin-
ation of which individual transcripts are DE, nor do the LMMs
identify clusters of transcripts with similar expression proﬁles.
However, ﬁtting of finite mixture models has been used success-
fully in this endeavour, to separate out potential DE from non-
DE transcripts (McLachlan et al., 2002).

The following article demonstrates how these two approaches
can be adopted in the analysis of a large gene expression dataset.
The methods are described to allow easy implementation in other
situations. While some of this approach has been described in
previous papers (Singh et al., 2013), the present article provides
additional detail and extends these methods. To illustrate the
methods, one of the most comprehensive gene expression
databases related to human brain tissue, namely, the UK Brain
Expression Consortium (UKBEC), is used, highlighting dif-
ferent expression patterns across the brain regions (Trabzuni
et al., 2011).

2 METHODS
2.1 Data

Assume that we have expression data recorded from a number of arrays
(m), and each array has expression measures for n transcripts. Further,
each array measures expression levels in one of s different biological states
(e.g. regions of the brain). Possibly, the number of replicates for each
state is equal (k), in which case m =ks, but this is not essential. So the
entire expression dataset of m x n observations is described as yWC),
i: 1,. . . , m;j= 1,. .. , n; withk: 1,. . . , s being speciﬁed for aparticular
array 1'. It is assumed that the expression arrays have been normalized
[e.g. using the RMA procedure (Irizarry et al., 2003)], and that appropri-
ate quality control checks have been undertaken. It is also assumed here
that yWC) is expressed on a logarithmic (base 2) scale.

2.2 Linear mixed model

A large-scale LMM is ﬁtted to all the gene expression data simultan-
eously. This is used to assess sources of variation in gene expression at
an overall level, i.e. to estimate and interpret the variance components.
The form of the model, in its simplest form, is

yij-(k) = p. + Array,- + Transcriptj + TranscriptStateJ-k + 8,-1-
where y,-,~(k)=normalized expression value on a logarithmic scale;

uzoverall mean expression value; Arrayizrandom effect due to
array, assumed N(0,0ﬁ); Transcript/zrandom effect due to transcript,

assumed N(0, 0%); Transcript. State/k 2 random effect due to transcript in
a state, assumed N(0,02TS); and aiszrandom error, assumed N(0,o§ .
Note that although normalization should remove any between-array
effects, the random array effect (Army) is included to account for any
variation not adjusted for by that process. So it is expected that an esti-
mate of 03, would be close to 0. The random transcript effects
(Transcriptj) account for overall differences in gene expression between
transcripts across all states (i.e. some transcripts have a consistently high
or low expression value): this variation must be adjusted for, but is not
the term of interest in exploring between-state variation in gene expres-
sion: it is the transcript x state effects (Tran script. State/k) that are of inter-
est here.

To ﬁt the LMM, a residual maximum likelihood (REML) method is
preferable, particularly when the design is unbalanced. Note that REML
as a model-ﬁtting procedure is available in some commercial packages
commonly used for brain expression analysis, such as Partek® Genomics
SuiteTM; however, the approach implemented there is still ‘one gene at a
time’. For example, the REML method is available in the nlme (Pinheiro
and Bates, 2000), lme4 (http://CRAN.R-project.org/package=lme4) and
ASReml-R (Butler et al., 2007) packages in R, the latter being a com-
mercial package. REML estimates of 031, UZT and 0sz (as well as a?) can
be obtained and their signiﬁcance assessed, either in relation to their
standard errors (as available in ASReml-R) or the intervals and conﬁnt
functions in nlme and lme4, respectively. However, a preferable method is
using a REML likelihood ratio test (LRT), comparing full and reduced
models (by omitting the random effect in being tested).

Estimated effects, or more precisely the best linear unbiased predic-
tions (BLUPs) of the random effects, can then be obtained, although, as
mentioned before, it is the BLUPs of the Transcript.State,-,~ effects that will
be most useful. Typically, these will need to be re-formatted into an n x s
array of effects (transcripts x states). These show how expression changes
across states, and relatively simple data exploration including boxplots
(by state) and pairwise scatterplots (by state) can reveal much informa-
tion, particularly in patterns of co-expression. This will be returned to
later, in Section 3.

2.3 Extending the LMM

One important way in which the above LMM can be extended is to
include additional factors that may be associated with gene expression,
X,, I: 1, . . . , [7. For example, expression may differ according to gender
or age group. Further, these factors may also differ between states. For
example, there may be different age-related expression effects, but these
may differ across regions of the brain. This can be accommodated by
extending the model as

yij-(k) = p. + Array,- + Transcriptj + TranscriptStateJ-k

p p
+ [21: TranscrithJ-l + [21: Transcript.State.X,-k1 + 8,-1-

where the additional terms are also random effects with
Transcript.le ~ N(0, 0%,“), l = 1, . . . ,p and Transcript.State.XJ-k,
~ N(0, UZTSXI). Again, inclusion of additional ﬁxed effects (and random
interaction effects of these with transcripts) is not uncommon in expres-
sion analysis; however, the approach here is that this information is
included in a genome-wide model.

A second important way the LMM can be extended is by including
variance heterogeneity. For example, there may be different levels of
genetic variation across regions of the brain, so rather than a single vari-
ance component UZTS, there may need to be separate variances for each
region (state), say 02“, k, k = 1, . . . , s; further, there may also need to be
separate residual variances for each state, i.e. oik, k: 1, . . . , s. The need
for these can be diagnosed by plots of the BLUPs of the Transcript. State/k
effects, or the residuals.

 

1556

112 /310's112u1n0fp10}x0"soiJBuiJOJuioiq/ﬁduq moi; papnolumoq

91oz ‘Og isnﬁnV uo ::

Application to regional differences in the human brain

 

2.4 Computational aspects of ﬁtting LMMs

Fitting a large-scale mixed model can be computationally demanding,
especially for a large expression dataset. One solution to this is to ﬁt
the model separately to q subsets of the data, each subset having a ran-
domly selected 1 /q of the transcripts. Note that all records on the one
transcript should be retained in the same data subset file. Hence, any
differences could be attributed to sampling ﬂuctuations; nevertheless,
this is checked by comparing parameter estimates (ﬁxed effect )1, and
variance component estimates) from each model fit. The estimates from
all subsets can then be combined in a weighted average,

x2 _ 1] A2 I]
at _ 21:1 Wight/21:1 W

and the standard error of the estimate obtained as se(6L2,) : (ELI wi)T1/2
where w,- : [se(6€L,)]T2, with 63L, and se(&€L,) being the estimate of vari-
ance component c and its standard error, based on dataset i: 1,. . ., 11.
Note that while the se(6i2L,) are available in ASReml-R, they are not
available using nlme or lme4. In that instance, they may be approximated
as one quarter of the conﬁdence interval width, as returned using the
intervals function in the nlme package, or the conﬁnt function in the
lme4 package. However, an unweighted average would also be appropri-
ate, given that the only differences would be due to sampling variation
associated with the random splitting of the full dataset.

There are also beneﬁts of ﬁtting the model to random subsets of the
expression data while developing the model, as this will allow a variety of
models to be evaluated in a reasonable time. Estimates of variance com-
ponents are remarkably similar when using only a sample of m: 1000
transcripts compared with a full dataset of m: ~20 000 transcripts, so
inferences made on a smaller sample may be appropriate.

2.5 Finite mixture model to assess DE transcripts

Having obtained the model-based predicted values of the tran-
script x state effects, the next issue is to assess which transcripts are dif-
ferentially expressed across the states. The deﬁnition here of DE is a
transcript showing an unusually high or low expression level in that par-
ticular state, compared with all the other gene transcript expression levels
in that state, i.e. it is not deﬁned in terms of DE between states. Typically,
a histogram (or normal Q—Q plot) of the BLUPs of these
TranscriptState/k effects (say gjk) within any one state k shows extreme
tails. This can be modelled as a ﬁnite mixture distribution consisting of

two components, the one with the larger variance 0% consisting of DE

transcripts and the other with a smaller variance 0% consisting of non-DE
transcripts (non-DE). The proportions of transcripts that are DE versus
non-DE, i.e. the prior probabilities, are 111 : P(DE) and 110 : 1 7
111:P(non-DE). Further, it is assumed that the expression values are
normally distributed, i.e. ngE ~ N(0,o%) and glnon-DE ~ N(0,o§).
This is indicated in Supplementary Figure S2. Fitting the mixture
model separately for the transcript effects in state k can be undertaken
using maximum likelihood. The log-likelihood is calculated as
n
loge L(012ka 03k; gk) 2 Zloge[nlkf(gjk; 012k) + (1 — 771k)f(gjk; 031)]
1:1

where ﬁg; 02) : (211)T1/ 2 exp[—g2/(202)] is the probability density func-
tion for an N(0,02) random variable. This mixture distribution is easily
ﬁtted using the expectationimaximization (EiM) algorithm (McLachlan
and Krishnan, 1997). The details of implementing the EiM algorithm as
well as assessing the ﬁt of the ﬁnite mixture model can be found in
Supplementary File Section 1.6.

As a by-product of the EiM algorithm, the (posterior) probability (1,1,)
of each speciﬁc transcript being DE is returned. Any transcript
with rfk>0.5 is more likely DE than non-DE. However, to reduce
false-positive results, a higher threshold is recommended. Typically, a
threshold of rfk> 0.8 is a good choice, and there is usually a distinct

subset of transcripts with high DE probabilities (as indicated from a
histogram of these values). This choice can be evaluated by calculation
of the corresponding FDR, FDR : 1 — mean{'EJ-k|'EJ-k >0.8}, i.e. the aver-
age of the posterior probability of a transcript being non-DE, given it was
declared as being DE.

The end result of these two processes, i.e. ﬁtting the LMM to obtain
genetic effects for each state, and then assessing which transcripts are DE
in each state, provides a smaller dataset (no transcripts x k states), where
likely, no << n, which can then be used for further targeted analysis. This
may involve assessing patterns of co-expression across different states, or
leading towards evaluation of functional gene networks. Some of these
further explorations are considered in the following section that describes
the implementation of these methods outlined above.

3 APPLICATION

3.1 Description of study and data

To illustrate the methods presented here, use is made of a study
involving 101 frozen human post-mortem brain and CNS tissue
samples of Caucasian controls with no neurological conditions,
and these were obtained from the Medical Research Council
(MRC) Sudden Death Brain and Tissue Bank, Edinburgh, UK
(Millar et al., 2007). From each brain, tissue samples from up to
12 brain regions were collected, namely, cerebellum (CRBL,
from n : 95 brains), frontal cortex (FCTX, n : 96), hippocampus
(HIPP, n : 93), hypothalamus (HYPO, 11: 13), medulla (specif-
ically inferior olivary nucleus, MEDU, 11:92), occipital cortex
(speciﬁcally primary Visual cortex, OCTX, 11:95), putamen
(PUTM, 11:94), substantia nigra (SNIG, 11:68), spinal cord
(SPCO, 11: 13), temporal cortex (TCTX, 11: 84), thalamus
(THAL, 11: 83) and intralobular white matter (WHMT,
11: 91). RNA samples were extracted and expression levels ana-
lysed using Affymetrix Exon 917 arrays with 19215 gene tran-
scripts recorded. This represents a major part of the UKBEC
dataset, the most comprehensive CNS expression dataset to
date. The expression dataset was normalized using the RMA
procedure, and routine quality control checks were applied,
including detection above background filtering. Further details
of the study are found in Trabzuni et a]. (2011).

3.2 Analysis of the UKBEC data

For the analysis of this dataset, the initial model ﬁtted to the
expression data was based on n : 1000 randomly selected tran-
scripts. The form of the model was

yiﬂkl) : [L + Array,- + Transcriptj + Transcript.Regionjk+
Transcript.Genderﬂ + bjAgel- + 8,]

where yij-(kl) is the RMA-normalized data, on a log-2 scale, and all
terms except [L are random effects. Note that gender was
included to test if there were gender-speciﬁc expression patterns.
Also, the age of the brain donor was included as a random
covariate effect, i.e. different linear effect of age associated
with each gene transcript, bj ~ N(0, cage). However, while stat-
istically signiﬁcant based on crude Wald tests and on LRTs, the
magnitude of these two variance components was substantially
smaller than all other variance components (including array);
consequently, these two effects were subsequently dropped
from the model. [Analyses of this dataset where the age and

 

1 557

112 /310'S[BHJHO[pJOJXO"SOTJBHIJOJuioiq/ﬂdnq moi; papBoIH/noq

9103 ‘Og isnﬁnV uo ::

D. Trabzuni et al.

 

gender effects have been reported in detail can be found in
Kumar et al. (2013) (age) and Trabzuni et al. (2013) (gender).]
However, this initial modelling also indicated that the variation
in these gene transcript effects differed across regions, so a
common transcript x region variance (0%,?) was replaced by a

separate variance for each region (0%,; k; k : 1,  12). Also
as a check, separate residual variances were fitted for each
region (a: k; k : 1,  12), but the estimated variance compo-

nents were similar across the 12 regions, and this did not improve
the fit of the model. This is also supported by the examinations
of residuals by brain region (Supplementary Fig. S3).

In the deﬁnitive analysis, the data were split randomly into
two (1]: 2) subsets (due to computational limits on the server),
each containing half of the 19 215 transcripts. These were labelled
Part 1 and Part 2. Consequently, each model involved predicting
1/; x 19215 x 13 B 125 000 random effects (Transcript+Tran
script.Region), as well as 917 array random effects. These
BLUPs of the Transcript. Region effects from each fitted model
were combined into the one dataset. This dataset then becomes
the main dataset for subsequent gene expression analysis
(i.e. 19 215 transcripts x 12 regions), including fitting the mixture
model within each region. Note that some coding details in R are
provided in the Supplementary File Section S1, including using
the asreml, lmer and lme functions, as well coding of the EiM
algorithm for ﬁtting the ﬁnite mixture models.

4 RESULTS

The estimates of the overall expression mean (ii) and the vari-
ance components from each random subset, as well as their
combined estimates, are shown in Table 1. It is clear that the
estimates from both subsets are similar and consistent with sam-
pling fluctuations.

There is very little between-array variation, as indicated by its
small estimated variance component (8A : 0.007 :l:0.0002).
There was a relatively large estimated variance component to
assess between-transcript variation (6% : 2.032 :l: 0.0209).
(BLUPs of overall transcripts effects can be obtained to highlight
differing overall expression levels between transcripts.) For the
transcript-speciﬁc effects in individual regions, the level of vari-
ation differed widely: CRBL showed the greatest level of vari-
ation (62m,l : 0.799 :l: 0.0083), followed by WHMT
(6%,{12 : 0.411 :l: 0.0044), with HYPO displaying the least vari-
ation (8%,4 : 0.042:l: 0.0008). Note the formal REML LRTs
indicate the heterogeneous model was superior to a homoge-
neous model with a common between-transcript variance: for
Part 1, LRT:21044 and for Part 2, LRT:20 327, and com-
pared with a chi-square distribution with 11 df returns P: 0 in
both. Estimated residual variation (63 : 0.202:l:0.0001) ac-
counted for between 6.6 and 8.8% of the variation in expression
levels (depending on the region). Supplementary Figure S4 shows
a boxplot of the BLUPs of the transcript x region interaction
effects. It corroborates the large estimated variance for CRBL
and WHMT, and the small variance for HYPO.

Supplementary Table S2 shows the correlation matrix
(Pearson correlation, r) between these region-speciﬁc transcript
effects. Correlations (almost) >05 in absolute value have been
coloured (red: positive; blue: negative), and those >0.75 are
shown in bold. It is noteworthy that the expression levels in

Table 1. Parameter estimates for the two randomly selected subsets of
transcripts and their combined estimates

 

 

Parameter Subset 1 Subset 2 Combined
Estimate :l: SE Estimate :l: SE Estimate :l: SE
n 5.305:l:0.015 5.297:l:0.015 5.301:l:0.011
oﬁArray 0.007 :l: 0.000 0.007 :l: 0.000 0.007 :l: 0.000
oZTTranscript 2.040 :l: 0.030 2.025 :l: 0.029 2.032 :l: 0.021
Ug—RJCRBL 0.795:l:0.012 0.803 :l:0.012 0.799:l:0.008
02m 2FCTX 0.222 :l: 0.004 0.227 :l: 0.004 0.225 :l: 0.003
Ug—RJHIPP 0.117:l:0.002 0.131 :l:0.002 0.123:l:0.001
Ug-RAHYPO 0.042:l:0.001 0.041 :l:0.001 0.042:l:0.001
Ug—RSMEDU 0.143:l:0.002 0.134:l:0.002 0.138:l:0.002
02m 6OCTX 0.246 :l: 0.004 0.258 :l: 0.004 0.252 :l: 0.003
Ug-RJPUTM 0.174:l:0.003 0.190:l:0.003 0.181 :l:0.002
oZTR,SSNIG 0.123:l:0.002 0.125:l:0.002 0.124:l:0.002
oZTIUSPCO 0.176:l:0.003 0.167:l:0.003 0.171 :l:0.002
Ug-R,10TCTX 0.244 :l: 0.004 0.251 :l: 0.004 0.247 :l: 0.003
oZTRJlTHAL 0.141 :l:0.002 0.142:l:0.002 0.142:l:0.002
02m 12WHMT 0.419:l:0.006 0.404:l:0.006 0.411:l:0.004
ogResidual 0.202 :l: 0.000 0.202 :l: 0.000 0.202 :l: 0.000

 

CRBL were not substantially correlated with those in other re-
gions, the greatest being with OCTX (r:0.318). The highest
correlations (all positive) were between the three cortex regions
(FCTX, OCTX and TCTX). To illustrate, Figure 1 shows a
smoothed scatter plot (using the smoothScatter function in the
geneplotter package of R) indicating the strong correlations be-
tween FCTX and OCTX (r:0.86). Supplementary Figure S5
shows similar pairs of regions for which |r| >0.5, including a
negative correlation between TCTX and SPCO (r: —0.75).

Figure 2 shows details of the region-speciﬁc transcript effects
for HYPO. (Similar results for the other 11 regions can be found
in the Supplementary Figs S&S9). Figure 2A shows the histogram
of the distributions of transcripts effects, supported by a corres-
ponding QQ plot in Figure 2B. They show evidence of some
extreme effects, i.e. differential gene expression, both upregulated
and downregulated, as indicated by the departures from the line in
the QQ plot. Similar ﬁndings are found in the other regions.

The two-component mixture model was fitted to the transcript
effects within each region, and these are summarized in Table 2.
On average, just <30% of transcripts show differential expres-
sion in any one region, although this varies from 16 (HYPO) to
45% (OCTX). In terms of variation in expression, the DE tran-
scripts show on average 3.3x greater standard deviations than
non-DE transcripts, and this ratio is fairly consistent across re-
gions (r : 0.90). Note that using results for mixture distributions,
the overall REML variance estimates in Table 1 can be approxi-
mately reproduced here, as 0%,“ : 7110? + (1 — 71003 (because
the means of both mixture components can be taken as 0). To
illustrate here for CRBL, from Table 2,
0.338 x 1.3062 + 0.662 x 0.5592 : 0.784, compared with
6T,“ : 0.799 in Table 1.

 

1 558

112 /310'S[BHJHO[pJOJXO"SOIJBHIJOJIIIOICI/ﬂdnq moi; papBoIH/noq

9103 ‘Og isnﬁnV uo ::

Application to regional differences in the human brain

 

 

* - r=I1351 _

OCTX

 

 

 

 

.2 .1 o 1 2 3 4
FCTX

Fig. 1. Smoothed scatter plot of the estimated Region.Transcript effects
for OCTX versus FCTX

Figure 2C shows the QQ plot for the fitted mixture model for
HYPO: while not a perfect fit, they ﬁt the expression effects
reasonably well, indicating that a two-component mixture
model is adequate. (Two transcripts are identiﬁed on that plot
as being even more extreme: one upregulated and one
downregulated). Figure 2D shows the distribution of the prob-
abilities of transcripts being DE in HYPO. What is apparent for
each region is a cluster of transcripts with extremely high prob-
abilities of being DE, i.e. DE transcripts. Transcripts with a
probability r>0.8 can be selected as being DE. The average of
the values (1 a T) for transcripts declared DE is the FDR: for the
current dataset, this is calculated as 4.3% [although it varies
across regions, from 3.1 (HIPP) to 5.7% (CRBL)].

5 SUBSEQUENT FUNCTIONAL ANALYSIS OF DE
GENES

Fitting the LMM results in the production of a ‘dataset’ of
Transcript.Region effects (19 215 rowsx 12 columns). Fitting
the ﬁnite mixture model within each region identiﬁed 7786 tran-
scripts that are DE in one or more regions. These can be ex-
tracted to form a reduced file (7786 rows x 12 columns) and
apply standard bioinformatic approaches for downstream ana-
lysis. For example, a heatmap of this dataset (using the heatmap
function in R) confirms the similar patterns of expression across
the three cortex regions, and distinct separation of CRBL and
WHMT from other regions (Fig. 3). It also demonstrates two
‘super-clusters’ of transcripts.

A simple means of clustering transcripts with similar expres-
sion proﬁles is to group together transcripts with the same pat-
terns of DE (upregulation, +; downregulation; 7) or non-DE (.)
across the 12 regions (Fig. 4). While Figure 4A shows a simple
cluster (upregulated in CRBL only, 381 transcripts), Figure 4B
shows a far more complex cluster of gene expression showing up-
and downregulation in 6 of the 12 regions (82 transcripts). With

A Histogram of effects: HYPO

F I 0 II ll c u LI;
6000 8000

4000

2000

 

 

sled
B Normal o-Q Plot M effects: HYPO

 

Snmnlu Dllﬂl'IlIL‘S

 

 

 

 

Tneoren cal Uuanliles

 

 

 

 

c Mixture 04} F101 of M'I'Oﬂl: HYPO
n
"-2 _
o
a
_ 19’
a
2
2* 0 _
a o
a:
‘3' — j“),
a
o
I I I I . I
{I E -0 4 -3 2 0.0 0 2 0.4 0 6
The DlEI‘l :al Uuanules
D Histogram cl' PIDE]: HY PD

FICl'llICrICI‘
3000 4000

7000

I000

 

l—l—l—l—I

02 0.4 0.6 0.3 1.0
pronanim,
Fig. 2. Analysis of expression data from the hypothalamus (HYPO). The
four panels show (A) histogram of the estimates of the Transcript.Region
effects in that region; (B) normal (LPQ plot of these effects demonstrating
the extreme tails of this distribution; (C) mixture model Q—Q plot (DE
and non-DE) of these effects indicating a satisfactory model ﬁt; and
(D) histogram of the posterior probability of the transcripts being DE;
note the subset of transcripts with a high probability of being DE

 

112 /310's12u1nofp101x0"soiwuiJOJHioiq/ﬁduq won pap1201u/IA0C1

9103 ‘0g anﬁnV uo ::

D. Trabzuni et al.

 

Table 2. Parameter estimates of the mixture model ﬁtted separately to
each brain region

 

Region CRBL FCTX HIPP HYPO MEDU OCTX

 

:11 0.338 0.380 0.185 0.155 0.294 0.451
60 0.559 0.225 0.161 0.112 0.160 0.203
61 1.306 0.685 0.688 0.286 0.597 0.689

 

Region PUTM SNIG SPCO TCTX THAL WHMT

 

£1 0.225 0.201 0.347 0.340 0.153 0.382
60 0.181 0.179 0.223 0.272 0.203 0.322
61 0.792 0.642 0.572 0.735 0.774 0.932

 

1’11 : probability that a transcript is DE; 570: SD of non-DE transcripts; (11 : SD of
DE transcripts.

 

40330 53(31an
002; I—t-FFE!
gsgwxgasesIg

Fig. 3. Heatmap of estimates of Transcript.Region effects for transcripts
identiﬁed as being DE in any of the 12 regions

the exception of CRBL, all transcripts in this cluster show a
similar pattern, whether it be DE or non-DE in a particular
region. Other clusters using this method are shown in
Supplementary Figure S10.

Naturally, more complex methods for analysing this reduced
dataset are appropriate. For example, the weighted gene co-ex-
pression network analysis method (Zhang and Horvath, 2005)
may also be applied to identify network connectivity modules in
speciﬁc regions or between all regions (Johnson et al., 2009), as
well as gene annotation and functional analysis such as DAVID
to identify enriched biological themes such as functional and
clustering classiﬁcation using gene ontology (GO) (Huang da,
et al., 2009). Singh et al. (2013) demonstrated the use of
DAVID, in conjunction with the current LMM/ﬁnite mixture
model approach. Identiﬁcation of over-represented transcription
factor binding sites in targeted modules (Ho Sui et al., 2005) and

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Sequence I  {II I381)

‘, _

n .
8
" O
0

I? _

'T _

CR-EL FCTX HFF HYFD MEN OCTX PIJIM ENIE SFDG TCTX THAI. WHMT
Hap-I

B = .-..-v-..-r-.-r In =32!

w _

N _

"\“KR

_ \\
g D '
u.

n, _

1- _

cR'aI. rcrx l1 P I-Irpo MEDU oc‘nI Fund 5 Is spec 1ch rm warn

 

509m

Fig. 4. Clusters of transcripts with similar pattern of being DE (up- and
downregulated) on non-DE across the 12 brain regions. Top (A) shows
the most common cluster (381 transcripts) that was upregulated in CRBL
but non-DE in the other regions. Bottom (B) shows a more complex
pattern of co—regional expression for a cluster (82) of transcripts

the use of a bioinformatics database, Encyclopaedia of DNA
Elements (ENCODE) consortium, are also applicable.

6 DISCUSSION AND CONCLUSIONS

With ever-increasing volumes of data generated from expression
arrays or RNA sequencing, there is a need to increase the efﬁ-
ciency and sensitivity in analysing large biological datasets. There
is also a need to provide methods that are accessible to re-
searchers without a strong bioinformatic and statistical back-
ground. The methods outlined here are aimed at addressing
these goals: the method described should be able to be adapted
to other situations, and some R code has been provided to assist
with this (see Supplementary File Section S1). The use of LMMs
as a means for analysing all expression data simultaneously is
intuitively appealing, as there is much common information
across the entire genome that can be used simultaneously to es-
timate genetic parameters and obtain predicted effects of individ-
ual transcripts. The analysis outlined here demonstrates how the
standard LMM can be extended to include variance heterogen-
eity in the genetic effects but also in residual effects. Using recent
developments in mixed model theory, we can incorporate a spa-
tial correlation structure over the array.

The method as described here, and also as illustrated using the
brain expression data, assumes that the expression data have
been normalized. However, even in the absence of normalization,
results are fairly similar, but with some indications of more tran-
scripts being ﬂagged as being DE (Supplementary File, Section
S4). Although not suggesting that expression data should not be
normalized, it does indicate that a low-level form of normaliza-
tion would be expected to return similar results to the RMA
method used here.

Another important consideration is the software used to ﬁt the
large-scale LMM to the expression data. For the analyses pre-
sented here, the commercial package ASReml-R has been used

 

1560

112 /810's112umofp1q1x0"sonBuIJOJuioiq/ﬁduq mm; p9p1201um0q

9IOZ ‘OE ISUE’HV Ho ::

Application to regional differences in the human brain

 

because of the ﬂexibility of model speciﬁcation, in particular the
ability to specify a heterogeneous variance model, all conducted
within the R environment. However, for this dataset, the impact
of ﬁtting a homogeneous variance model was not found to have
serious consequences (see Supplementary File, Section S1.5),
allowing the freely available lme4 or nlme packages to be used.

Naturally, we are aware that using any analysis method to
detect DE transcripts will have its own limitations. For example,
there might be a functionally important DE transcript missed out
as part of the detection above background process used to reduce
some of the background ‘noise’. Or alternatively, it may fail the
test for being DE (threshold 1' : 0.8). However, such a transcript
still may be detected using one of the clustering methods men-
tioned here, which only requires information on the effect size,
and not the DE status. Note that the LMM/ﬁnite mixture model
method proposed here produced a more targeted list of DE tran-
scripts, the list becoming more accurate with increasing number
of arrays. This is a point of contrast to the ‘gene by gene’ ap-
proach in limma (Smyth, 2004): with increasing sample size
(number of arrays), the limma approach will ﬂag the majority
of transcripts as DE, but these will not necessarily be biologic-
ally important. Some comparisons of analysis using limma
and the current method are included in Supplementary File
Section S5.

In the method proposed here, there are two separate proced-
ures, namely, (i) fitting the LMM and then (ii) ﬁtting a ﬁnite
mixed model to the BLUPs of these effects, separately in each
state (brain region, in the current example). Ideally, the two
processes would be combined, fitting a mixture model to capture
DE/non—DE within the LMM. However, with a large number of
states (s), the theoretical number of possible DE/non—DE pat-
terns becomes immense (2S: 4096), and ﬁtting a mixture model
with this many components would be infeasible. However, the
LMM is reasonably robust against model misspecification. As an
illustration, the correlation between the BLUPs of the
Transcript.Region effects obtained from models with and with-
out variance heterogeneity included was 0.98 (see Supplementary
Table S2), despite the obvious between-region variance hetero-
geneity. Nonetheless, further research in combining these two
stages is warranted.

The main endpoint of the methods outlined here is to
produce a table of effects of gene transcripts in different states,
the table being restricted to transcripts that are DE in any one of
the s states: following this, further analysis is of course required
to identify clusters and the functional pathways using different
advanced tools as mentioned in the previous section. This
provides a way forward to obtain more reliable information
about transcriptional regulation in the human CNS to under-
stand the effect of genetic disorders targeting specific human
CNS regions.

ACKNOWLEDGEMENTS

UKBEC Brain expression data scientists are John Hardy,
Michael E. Weale, Daniah Trabzuni, Mina Ryten, Colin
Smith, Robert Walker and Adaikalavan Ramasamy. The

authors thank AROS Applied Biotechnology AS company
laboratories. They also specially thank Jane Ramsey, Geoff
Scopes and Wilson Lew (Affymetrix) for their valuable input.
(PMID: 21848658, 22723018, 23967090).

Funding: This study was performed using the UK Brain
Expression Consortium (UKBEC), which was supported by
the MRC through the MRC Sudden Death Brain Bank (C.S.),
by a project grant (G0901254 to J.H. and M.W.). D.T. was sup-
ported by the King Faisal Specialist Hospital and Research
Centre, Saudi Arabia. Computing facilities used at King’s
College London were supported by the National Institute for
Health Research (NIHR) Biomedical Research Centre at
King’s College London.

Conflict of Interest: none declared.

REFERENCES

Auer,P.L. et al. (2012) Differential expressionithe next generation and beyond.
Brief. Funct. Genomics, 11, 57$2.

Butler,D. et al. (2007) ASReml—R Reference Manual. Queensland Department of
Primary Industries and Fisheries, Brisbane.

Geschwind,D.H. and Konopka,G. (2009) Neuroscience in the era of functional
genomics and systems biology. Nature, 461, 9087915.

Ho Sui,S.J. et al. (2005) oPOSSUM: identiﬁcation of over—represented transcription
factor binding sites in co—expressed genes. Nucleic Acids Res, 33, 3154e3164.

Huang da,W., Sherman,B.T. and Lempicki,R.A. (2009) Systematic and integrative
analysis of large gene lists using DAVID bioinformatics resources. Nat. Protoc.,
4, 4457.

Irizarry,R.A. et al. (2003) Exploration, normalization and summaries of high dens—
ity oligonucleotide array probe level data. Biostatistics, 2, 2497264.

Ji,H. and Liu,X.S. (2010) Analyzing ‘omics data using hierarchical models. Nat.
Biotechnol, 28, 3377340.

Johnson,M.B. et al. (2009) Functional and evolutionary insights into human brain
development through global transcriptome analysis. Neuron, 62, 4947509.

Kerr,M.K. et al. (2000) Analysis of variance for gene expression microarray data.
J. Comp. Biol., 7, 8194137.

Kumar,A. et al. (2013) Age—associated changes in gene expression in human brain
and isolated neurons. Neurobiol. Aging, 34, 119971209.

McLachlan,G.J. et al. (2002) A mixture model—based approach to the clustering of
gene expression data. Bioinformatics, 18, 4134122.

McLachlan,G.J. and Krishnan,T. (1997) The EM Algorithm and Extensions. Wiley,
New York.

Millar,T. et al. (2007) Tissue and organ donation for research in forensic
pathology: the MRC sudden death brain and tissue bank. J. Pathol, 213,
3697375.

Pinheiro,J.C. and Bates,D.M. (2000) Mixed Effects Models in S and S—PLUS
( Statistics and Computing). Springer, New York.

Singh,M. et al. (2013) Comparative transcriptome analyses reveal conserved and
distinct mechanisms in ovine and bovine lactation. Funct. Integr. Genomics, 13,
1717.

Smyth,G.K. (2004) Linear models and empirical Bayes methods for assessing
differential expression in microarray experiments. Stat. Appl. Genet. Molec.
Biol, 3, Article 3.

Trabzuni,D. et al. (2011) Quality control parameters on a large dataset of regionally
dissected human control brains for whole genome expression studies.
J. Neurochem., 11‘), 2757282.

Trabzuni,D. et al. (2013) Widespread sex differences in gene expression and splicing
in the adult human brain. Nat. Commun., 4, Article 2771.

Zhang,B. and Horvath,S. (2005) A general framework for weighted gene co—expres—
sion network analysis. Statistical Applications in Genetics and Molecular Biology,
4, Article 17.

 

1561

112 /310's1cu1n0fp101x0"soiwuiJOJHioiq/ﬁduq won pap1201u/IA0C1

9103 ‘0g tsnﬁnV uo ::

