BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

n
w 20 'm

D 5
Rmenhon mm;

Tune 0' prom-we
8 S 3 3
\Hlensuy

c

4

20 3a 4a 2“ 3” 40 an ‘ cums

Time or sam‘e Relanhun me

a;
§
E
E
a
E
E
F

m 394

u 50 an
Rammmn Wm:

 

We 20 so 40 50 50
mm 0! sample

duq

/3.10'spzum0[p10}x0"souvuuowyquﬂ

T. -H. Tsai et al.

 

Ui(S)|S ~ NW2“) (1)

where the mean function is an identity function, i.e. a“ = s, and
the R x R covariance matrix 2,, is defined via a squared expo—
nential covariance function K, which reﬂects greater dependence
between neighboring time points than distant points. The likeli—
hood function is defined as p(r|u,~(s)) = N(r|u,~(s), 031). Based on
the deﬁned likelihood function and the GP, it can be shown (see
Supplementary Material) that the predictive distribution of the
mapping function u,~(t) at time t is a Gaussian with mean

E[u,~(t)] = t + m, sT)[2,, + 0,2,1]"(r — s) (2)
and variance
Var[u,~(t)] = m, z) — m, sT)[2,, + a;I]"K(s, z) (3)

where K(t, ST) 2 (K(t,sl), K(t,52), . . . ,K(t,SR)), and K(s, t) =
(K(Sl, t), K(52, t), . . . , K(sR, t))T. This provides an effective way to
infer the mapping functions, and the estimation depends on the
number of standard peaks that can be reliably used and the
coverage of RT by these peaks. As discussed in Section 1, we
propose to use more comprehensive chromatographic informa—
tion in our profile—based approach, in which the GP can be
incorporated using the predictive distribution of the mapping
function as the prior for subsequent estimation.

2.2 Proﬁle-based alignment

In this section, we give a brief introduction of the previously
reported proﬁle—based alignment using a single chromatogram,
e. g. base peak chromatogram from each LC—MS run (Tsai et al.,
2013). Then, we discuss how we extend the model to handle
multiple representative chromatograms simultaneously.

2.2.1 Single—profile modeling We use a generative model to
characterize the chromatographic elution process, where the
observed chromatograms from N replicates, y,~(t), i = 1, . . . ,
N, t = t1, . . . , tT, are assumed to share a similar prof11e charac—
terized by the prototype function m(t). For the i—th chromato—
gram at RT t, the intensity value is referred to as the prototype
function indexed by the mapping function u,~(t), i.e. m(u,~(t)). By
incorporating the variability of intensity using afﬁne transform—
ation, each chromatogram is modeled as

y,~(t) = c,~ + a,~ -  + 8,(t), i: 1,2, ...,N (4)

where a,- and c,- are scaling and translation parameters, and
the errors s,(t)’ s are independent and identically distributed nor—
mal random variables s,(t) gN(0, of). The prototype function is
modeled with B—spline regression, m = Bm1/r, and the prior for
each of the regression coefficients is deﬁned as
1/1; ~N(I//H,oi), where 1/10 2 0. The mapping function u,~(t)
is a piecewise linear function characterized by a set of knots
‘L' = (To, 11, ...,TK+1) and their corresponding mapping indices
<15, 2 (¢i‘0, (15,31, ...,¢,~‘K+1). The prior of u,~(t) is specified by the
GP prior as described in Section 2.1, and conjugate priors are
chosen for the other model parameters.

2.2.2 Multi—profile modeling For complex biological samples,
collapsing the 3D data into a 2D chromatogram may blur ori—
ginally distinct patterns. In such cases, the lack of a consistent

pattern can hinder the estimation of mapping functions. To
retain better chromatographic prof11es, we propose to identify
multiple representative chromatograms and perform the align—
ment by considering these chromatograms simultaneously.
Extension of the generative model to handle multiple chromato—
grams can be made by introducing associated prototype func—
tions of the representative chromatograms. That is,

yéglm = c.~ + a. - mama» + 82%) (5)

where sample index i = 1, . . . , N, and chromatogram index
g = 1, .. . , G. As in the single—prof11e (SP) modeling, the proto—
type function associated to each of the representative chromato—
grams is modeled with B—spline regression: mg 2 BMI/Ig, and the
errors 8:57)“), s are independent and identically distributed
normal random variables 8:87)“) 25‘ N(0, of). The relationship be—
tween the G pairs of prototype functions and chromatograms is
characterized by the mapping function.

2.2.3 Parameter inference We use Markov chain Monte Carlo
methods to draw inference based on the posterior distribution of
model parameters. Once posterior estimates are obtained, the
alignment can be performed based on the estimated mapping
function, i.e. by replacing the RT t of the i—th run by 12,(t). For
parameters whose full conditionals have closed forms, we use
Gibbs sampling to update their values. The only exception is
(1),, which is updated using an efficient block Metropolisi
Hastings algorithm with a uniform proposal density that reﬂects
the constraints on the boundaries. Details of the prof11e—based
alignment including the full conditionals and the Metropolisi
Hastings algorithm are provided in the Supplementary Material.

2.3 Chromatographic clustering

A critical issue involved in the multi—profile modeling is the iden—
tiﬁcation of representative chromatograms from the LC—MS
runs, where a trade—off between computational efficiency (less
chromatograms) and information retention (more chromato—
grams) needs to be considered. Naively binning along the m/z
dimension is not desirable, as chromatograms with similar m/z
values do not necessarily resemble each other, and this would
inevitably blur the chromatographic prof11es. With an initial set
[B of binned chromatograms xfb) at a resolution of 0.5 Da/bin,
b e B, we propose a clustering procedure consisting of screening
of unqualiﬁed chromatograms, identiﬁcation of exemplars and
agglomerative clustering as follows.

2.3.] Screening of unqualified chromatograms Quality of each
binned chromatogram is assessed by the mass chromatogram
quality (MCQb) and cross—correlation across LC—MS runs
(XCb), where the value of MCQb is computed using the compo—
nent detection algorithm by Windig et al. (1996) to identify con—
taminated binned chromatograms in any of the LC—MS runs,
and the cross—correlation is to gauge the consistency of the chro—
matographic pattern across the runs. The chromatograms are
screened based on their quality. Only those satisfying the speci—
fied criterion, e.g. MCQb 3 0.9 and XCb 3 0.85, are retained for
further processing.

2.3.2 Identification of exemplars We apply the afﬁnity propa—
gation algorithm (Frey and Dueck, 2007) to identify exemplars

 

2776

ﬁm'spzumofpmﬂo'sopnuuopnorq/ﬁdnq

Bayesian alignment model for LC-MS data analysis

 

of the retained chromatograms that best represent the whole
chromatographic profiles, where Pearson correlation coefficient
is used as the similarity measure, and the average of all the simi—
larity measures is assigned as the exemplar preference. In afﬁnity
propagation, the sum of the similarity measure between each
chromatogram and its exemplar is maximized, where the exem—
plar belongs to the chromatograms retained from the previous
step.

2.3.3 Agglomerative clustering Based on the set of identiﬁed
exemplars, we perform the hierarchical agglomerative approach
to cluster the exemplars, which is a bottom—up approach.
Initially, each exemplar forms a singleton cluster, and two closest
clusters are iteratively merged. At each level, the clustered chro—
matogram ygg)(t) is summarized by

#10): 2 x90) (6)

beBg

where [HEg denotes the set of chromatograms in the g—th cluster.
The distance between two clusters is deﬁned based on the over—
lapping level between two clustered chromatograms

N t»,
dang, B...) = Z Z min[yf~g)(t), y$g°(t)] (7)

i=1 t=t1

Our goal is to cluster together chromatograms with less over—
laps, i.e. agglomeration of fairly distinct chromatographic pro—
ﬁles, to better retain the chromatographic proﬁles. The
procedure continues until all the exemplars are merged into a
single cluster. Once the hierarchy is built, the number of clusters
is determined using the L—method by Salvador and Chan (2004).
On the plot of overlapping level against the number of clusters,
we observe incremental decrease of the overlapping level and the
L—method searches for the knee of the overlapping curve, where
the benefit of adding an additional cluster starts decreasing. A
sequence of two piecewise lines that fit the overlapping curve and
their sum of squared errors are considered. The point minimizing
the ﬁtted sum of squared errors is chosen as the sufﬁcient
number of clusters.

3 LC-MS DATASETS

We applied BAM to three LC—MS datasets from metabolomic,
proteomic and glycomic studies. These datasets present scenarios
of real LC—MS experiments and capture the variabilities due to
sample type, sample preparation methods and instrument condi—
tion, which all play a role in the quality of chromatographic
reproducibility. It should be emphasized that none of these
datasets can solely represent the complexity of all —omic studies.
The metabolomic dataset is from a benchmark study by Lange
et al. (2008), provided with ground—truth data (Available at
http://msbi.ipb—halle.de/msbi/caap). The proteomic and glycomic
datasets were generated by our group, where serum samples
were spiked with internal standards, and peaks associated to
the internal standards and the ground—truth data were deter—
mined. We provide the internal standards and the ground—truth
data for both the proteomic and glycomic datasets in the
Supplementary Material.

3.1 Metabolomic dataset

The metabolomic dataset consists of 24 LC—MS runs of
Arabidopsis thaliana extract, acquired by an Agilent 1100
HPLC coupled to a Bruker micrOTOF—Q. To evaluate the align—
ment result, ground—truth data were generated based on ion an—
notation, correlation of chromatographic proﬁle and consistency
of peak. Comparison was carried out by evaluating recall and
precision of the alignment results against the ground—truth data.
For more details about this dataset, we refer interested readers to
Lange et al. (2008).

3.2 Proteomic dataset

The proteomic experiment was designed to evaluate the applica—
tion of the MARS Hu—14 column (Agilent Technologies) for
depletion of high abundant proteins in human serum. The tryptic
peptides are a mixture of the following five non—human proteins
(Bruker—Michrom): Alcohol dehydrogenase (yeast), Carbonic
anhydrase (bovine), Cytrochrome c (equine), Enolase (yeast)
and Myoglobin (equine). Serum samples from ﬁve healthy indi—
viduals were analyzed. LC—MS/MS analysis of the serum samples
was performed on an Agilent 1200 nano—LC coupled to a
ThermoFisher LTQ—Orbitrap mass spectrometer, where data
were acquired with double injections from two groups, with
two different concentrations of the spike—in tryptic peptides.
LC—MS/MS analysis of the internal standard mixture was also
performed in duplicate right before the analysis of the serum
samples. The mass spectrometer was scanned approximately
every second using a 60 000 resolution setting. For each scan,
up to five ions were automatically selected based on their inten—
sities for the MS/MS analysis in the LTQ. The MS/MS spectra of
the internal standard mixture were searched with Mascot, and 22
peaks corresponding to the internal standards were identiﬁed.

3.3 Glycomic dataset

The glycomic dataset is from an untargeted LC—MS study aimed
at identifying N—glycan disease biomarkers. We analyzed human
serum samples representing two distinct biological groups (cases
and controls). The dataset was generated from sera of 11 cases
and 12 controls. Sample preparation consists of release, purifi—
cation, reduction and permethylation of N—glycans. Following
sample preparation, LC—MS data were acquired using a
Dionex 3000 Ultimate nano—LC system interfaced to an LTQ—
Orbitrap Velos mass spectrometer on positive mode. An internal
standard (galactose) was added to the serum samples before the
LC—MS data acquisition, and five peaks (galactose 377) corres—
ponding to the internal standard were consistently detected in all
the analyzed samples.

4 RESULTS

We evaluate the alignment results based on the consensus list of
the ground—truth data. Speciﬁcally, we compare the RT differ—
ence across LC—MS runs, the CV of extracted ion chromato—
grams and the peak—matching performance. The RT difference
measures the difference between the largest and smallest RTs for
a consensus peak. The CV evaluates the variability across chro—
matograms. The peak—matching performance is evaluated

 

2777

ﬁm'spzumol‘pmﬂo'sopnuuopnorq/ﬁdnq

an?kgogmomammowoio~&o:3m7.omm\

 

Normallzed overlapping level

Intensity (A.

Intensity (A.

10 15 36 3 25
Number of clusters

(min)

10

3
$
2
'n
c
2

Intensity (A U

30 7' J0
Retention lime (min)

Intensin (A U )

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

T. -H. Tsai et al.

 

Table 2. Multi-proﬁle alignment of the glycomic dataset with and without using a GP prior

 

Performance Binning without GP prior

Clustering without GP prior

Binning with GP prior Clustering with GP prior

 

measure
2 3 4 5 2 3 4

2 3 4 5 2 3 4 5

 

Precision 0.957 0.960 0.964 0.963 0.964 0.980 0.979

0.980 0.976 0.977 0.978 0.974 0.980 0.979 0.980 0.980

(0.007) (0.008) (0.007) (0.006) (0.007) (0.004) (0.004) (0.002) (0.003) (0.003) (0.004) (0.006) (0.003) (0.003) (0.002) (0.003)

Recall 0.766 0.783 0.770 0.780 0.796 0.906 0.910

0.913 0.848 0.856 0.830 0.837 0.904 0.904 0.907 0.908

(0.138) (0.122) (0.147) (0.154) (0.138) (0.094) (0.099) (0.092) (0.151) (0.141) (0.160) (0.156) (0.098) (0.099) (0.095) (0.096)

 

Note: Precision and recall are compared between cases where G chromatograms (G = 2, . . . , 5) are derived either by binning along m/z or using the chromatographic clustering

procedure.

The alignment model proposed here considers underlying pat—
terns for LC—MS runs in samples drawn from the same biological
group. When samples arise from different biological subgroups,
the model needs to be extended to account for the heterogeneity
across these subgroups. Future work will focus on developing a
uniﬁed approach that allows the simultaneous alignment of sam—
ples from multiple biological groups to ensure coherence in the
processing step and data comparability.

The LC—MS raw data, the preprocessed peak lists and the
ground—truth data used in this article have all been made publicly
available to serve as a benchmark for the evaluation of new
preprocessing methods.

ACKNOWLEDGEMENT
The authors thank Martin Lindner for his help on SIMA.

Funding: National Institutes of Health (NIH) Grant
(R0 1 CA 143420).

Conflict of Interest: none declared.

REFERENCES

Aebersold,R. and Mann,M. (2003) Mass spectrometry—based proteomics. Nature,
422, 1987207.

An,H.J. et al. (2009) Glycomics and disease markers. Curr. Opin. Chem. Biol, 13,
601$07.

Christin,C. et al. (2010) Time alignment algorithms based on selected mass traces for
complex LC—MS data. J. Proteome Res., 9, 148371495.

Fischer,B. et al. (2006) Semi—supervised LC/MS alignment for differential prote—
omics. Bioinformatics, 22, e1327e140.

Frenzel,T. et al. (2003) A methodology for automated comparative analysis of me—
tabolite proﬁling data. Eur. Food Res. Tecltnol, 216, 3357342.

Frey,B.J. and Dueck,D. (2007) Clustering by passing messages between data points.
Science, 315, 9727976.

Hawkridge,A.M. and Muddiman,D.C. (2009) Mass spectrometry—based biomarker
discovery: toward a global proteome index of individuality. Annu. Rev. Anal.
Cltem., 2, 2657277.

Karpievitch,Y. et al. (2010) Liquid chromatography mass spectrometry—based
proteomics: biological and technological aspects. Ann. App]. Stat., 4, 179771823.

Lange,E. et al. (2007) A geometric approach for the alignment of liquid chroma—
tography mass spectrometry data. Bioinﬁ)rmatics, 23, i2737i281.

Lange,E. et al. (2008) Critical assessment of alignment procedures for LC—MS prote—
omics and metabolomics measurements. BMC Bioinformatics, 9, 375.

Listgarten,J. et al. (2007) Difference detection in LC—MS data for protein biomarker
discovery. Bioiiy’ormatics, 23, e1987e204.

Madsen,R. et al. (2010) Chemometrics in metabolomicsia review in human disease
diagnosis. Anal. Cltim. Acta, 659, 23733.

Mann,M. and Kelleher,N.L. (2008) Precision proteomics: the case for high
resolution and high mass accuracy. Proc. Natl Acad. Sci. USA, 105,
18132718138.

Patti,G.J. et al. (2012) Innovation: metabolomics: the apogee of the omics trilogy.
Nat. Rev. Mol Cell Biol, 13, 2637269.

Rasmussen,C.E. and Williams,C.K.I. (2006) Gaussian Processes for Machine
Learning. The MIT Press, Cambridge, MA, USA.

Salvador,S. and Chan,P. (2004) Determining the number of clusters/segments in
hierarchical clustering/segmentation algorithms. In: 16th IEEE International
Conference on Tools with Artificial Intelligence, Boca Raton, FL, USA,
pp. 57(r584.

Smith,C.A. et al. (2006) XCMS: processing mass spectrometry data for metabolite
proﬁling using nonlinear peak alignment, matching, and identiﬁcation. Anal.
Cltem., 78, 7797787.

Tomasi,G. et al. (2004) Correlation optimized warping and dynamic time
warping as preprocessing methods for chromatographic data. J. Cltemom., 18,
2317241.

Tsai,T.—H. et al. (2013) Proﬁle—based LC—MS data alignment 7 a Bayesian ap—
proach. IEEE/ACM Trans. Comput. Biol. Bioinform., 10, 494~503.

Vandenbogaert,M. et al. (2008) Alignment of LC—MS images, with applications to
biomarker discovery and protein identiﬁcation. Proteomics, 8, 650%72.

Voss,B. et al. (2011) SIMA: simultaneous multiple alignment of LC/MS peak lists.
Bioinfommtics, 27, 9877993.

Windig,W. et al. (1996) A noise and background reduction method for component
detection in liquid chromatography/mass spectrometry. Anal. Chem, 68,
360273606.

Zaia,J. (2010) Mass spectrometry and glycomics. OMICS, 14, 4014118.

 

2780

ﬁm'spzumol‘pmyo'sopnuuopnorq/ﬁdnq

