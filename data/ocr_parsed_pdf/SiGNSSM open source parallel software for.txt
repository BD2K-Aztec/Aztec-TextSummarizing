Vol. 27 no. 8 2011, pages 1172-1173
APPS NO  doi:10.1093/bioinformatics/btr078

 

Systems biology

Advance Access publication February 10, 2011

SiGN-SSM: open source parallel software for estimating gene
networks with state space models
Yoshinori Tamadala*, Rui YamaguchiZ, Seiya Imotol, Osamu Hirose3, Ryo Yoshida4,

Masao Nagasaki5 and Satoru MiyanolaQa6

1Laboratory of DNA Information Analysis, 2Laboratory of Sequence Analysis, Human Genome Center, Institute of
Medical Science, The University of Tokyo, 4—6—1 Shirokanedai, Minato—ku, Tokyo 108—8639, 3Bioinformation
Engineering Laboratory, Department of Biotechnology, Graduate School of Agricultural and Life Sciences, The
University of Tokyo, 1—1—1 Yayoi, Bunkyo—ku, Tokyo 113—8657, 4Department of Statistical Modeling, Institute of
Statistical Mathematics, Research Organization of Information and Systems, 10—3 Midori—cho, Tachikawa, Tokyo
190—8562, 5Laboratory of Functional Genomics, Human Genome Center, Institute of Medical Science, The University
of Tokyo, 4—6—1 Shirokanedai, Minato—ku, Tokyo 108—8639 and 6Data Analysis Fusion Team, RIKEN Computational
Science Research Program, 2—1 Hirosawa, Wako, Saitama 351—0198, Japan

Associate Editor: Martin Bishop

 

ABSTRACT

Summary: SiGN-SSM is an open-source gene network estimation
software able to run in parallel on PCs and massively parallel
supercomputers. The software estimates a state space model
(SSM), that is a statistical dynamic model suitable for analyzing
short time and/or replicated time series gene expression profiles.
SiGN-SSM implements a novel parameter constraint effective to
stabilize the estimated models. Also, by using a supercomputer,
it is able to determine the gene network structure by a statistical
permutation test in a practical time. SiGN-SSM is applicable not only
to analyzing temporal regulatory dependencies between genes, but
also to extracting the differentially regulated genes from time series
expression profiles.

Availability: SiGN-SSM is distributed under GNU Affero General
Public Licence (GNU AGPL) version 3 and can be downloaded
at http://sign.hgc.jp/signssm/. The pre-compiled binaries for some
architectures are available in addition to the source code. The pre-
installed binaries are also available on the Human Genome Center
supercomputer system. The online manual and the supplementary
information of SiGN-SSM is available on our web site.

Contact: tamada@ims.u-tokyo.ac.jp

Received on December 1, 2010; revised on January 21, 2011;
accepted on February 6, 2011

1 INTRODUCTION

Analyzing the dynamical regulatory mechanisms of gene
expressions in a cellular system is a Challenging problem in systems
biology. To this end, many computational methods have been
proposed to estimate dynamical systems of regulatory dependencies
between gene expressions from temporal gene expression proﬁles.
The major difﬁculty of these studies comes from insufﬁcient data
time points as opposed to the number of variables (genes) in a
computational model. A state space model (SSM) (Hirose et al.,
2008; Kitagawa and Gersch, 1996; West and Harrison, 1997) is

 

*To whom correspondence should be addressed.

a statistical model that is applicable to small time-point temporal
datasets because it can reduce the number of parameters to be
estimated. The SSM decomposes the temporal gene expressions
into a dynamical system of modules called the system model (or
state space) and a mapping from the modules to the particular genes
called the observation model. There are a number of gene network
studies using the SSM (Beal et al., 2005; Hirose et al., 2008; Rangel
et al., 2004).

SiGN-SSM is a re-implemented, new version of the previously
released one called TRANS-MNET (Hirose et al., 2008). In addition
to TRANS-MNET, SiGN-SSM has the following improvements:
(i) it implements a novel constraint on the model parameters
effective to stabilize the estimated models for the short time
series data with irregular time intervals; (ii) runs in parallel as
a multithreaded program exploiting multicore CPUs, as a bulk
(array) job through a job dispatching system such as Sun (Oracle)
Grid Engine (SGE) on PC Cluster systems, and a multi-process
MPI (Message Passing Interface) application on massively parallel
supercomputers; (iii) is an open-source software so that everyone can
freely access the source code and improve, modify and distribute
it, and (iv) implements a statistical permutation test to determine
a gene network structure as proposed in Hirose et al. (2008) and
differentially regulated gene extraction presented in Yamaguchi et al.
(2008) on the Human Genome Center (HGC) supercomputer system.

2 STATE SPACE MODEL

We introduce the SSM brieﬂy. For detailed deﬁnitions, see Hirose
et al. (2008). Let y" be a vector of 1) variables representing gene
expression proﬁles for 1) genes observed at time n f N, where N is the
total number of time points. In the SSM, the observable expression
proﬁles y" are assumed to be generated from the k-dimensional
hidden state variables (vector) x". Here, we assume that k <1). The
SSM is deﬁned by the following two formulae:

x" =Fxn_1+vn, vn ~N(0, Q), [System model]
y" =Hxn +wn, wn ~N(0, R), [Observation model]

 

1172 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 ﬁlo's[sumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

SiGN-SSM: Gene network estimation with SSM

 

 

 

 

 

 

# dimensions I I
I 0‘ O . . \ I
I ‘ \ \ a.) I
<< \ ~ o ‘
k p : 3’1 3’ 2 \ y N I
# genes | (p)-vector I
\ Observation Model (= input data) yn = Hxn 1' w" I

Fig. 1. Conceptual View of the state space model.

 

 

      

E
‘3
i
3
5‘

log examinn level

 

 

 

 

time 1m) time w)

 

 

nswisznzsanaswtssa 051ﬂ1520253035w4559

Fig. 2. Comparison without (left) and with (right) the proposed constraint
on F. The plotted lines are the estimated smoothing observation variables
for the very short. triplicate sample data.

where F is the (k,k)-state transition matrix and H the (p,k)-
observation matrix that maps from the state variables x" to the
observation variables y". The two vectors v" and w" are the system
and the observation noise, respectively, where Q and R are the
covariance matrices of the normal distributions. The initial state
variables x0 is required to be estimated from the data and we assume
x0~N(/t0,20). The SSM estimation problem is to estimate the
unknown parameters {H ,F ,Q,R,/t0} from the observed temporal
gene expression data. The dimensions of the state vector (k) is also
an unknown parameter to be determined. The parameter estimation
from the observed data is realized by the expectation-maximization
(EM) algorithm. The dimensions of the state vector, k, can be
determined by comparing the Bayesian Information Criterion values
of the estimated models with different k. Figure 1 shows the
conceptual view of the SSM.

3 IMPLEMENTATION AND PARALLELIZATION

SiGN-SSM is written in C, using the BLAS/LAPACK library.
Since the EM algorithm ﬁnds only locally optimal parameters,
it is required to run the algorithm many times to obtain better
estimate for a single k. To speed up the parameter estimation
and the optimal k determination, SiGN-SSM supports multiprocess
parallelization using MPI, multithread parallelization using OpenMP
and parallelization by bulk jobs on PC clusters. By using MPI,
we conﬁrmed that SiGN—SSM can optimize multiple k in parallel
very efﬁciently with up to 256 CPU cores. See Supplementary
information on our web site for detailed results. The permutation
test determines the gene network structure from the estimated model

parameters. However, it requires much more computational time
than the parameter estimation. To solve this problem, we parallelized
it on the HGC supercomputer using SGE.

4 NEW CONSTRAINT ON PARAMETERS

When the algorithm estimates the model parameters from short time
series data measured for irregular time intervals, they often oscillate
undesirably (Fig. 2). To suppress such spurious patterns, we propose
a novel constraint on the system transition matrix F along with the
smoothness prior approach (Kitagawa and Gersch, 1996). With the
constraint, we assume that the value of the state vector at time n is
similar to that at time n— l. The constrained version of F, denoted
by F = {fl-j}, has its diagonal elementsfl-l- =g for i = l, ,k where 0 f
g f l is a constant to control the smoothness, which user can choose
(we set 0.8 as the default value). The off-diagonal components of F
are estimated by the EM algorithm with the constraint of the diagonal
components, in which we utilize the general framework of Wu et al.
(1996) to constrain parameters of an SSM in the EM algorithm. The
value of g can be determined by such as comparison of BIC values,
cross-validation, etc.

5 CONCLUSION

SiGN-SSM is a highly-scalable, open-source implementation of
an SSM estimation algorithm. The newly proposed constraint on
the parameters can signiﬁcantly stabilize the estimation of the
parameters for the very short time point temporal data with irregular
time intervals. Users can analyze their time series expression
datasets using SiGN-SSM, and the estimated model can be applied
to other data to extract differentially expressed genes.

ACKNOWLEDGEMENT

Computational resources required for the development of SiGN-
SSM was provided by the HGC Supercomputer System, Human
Genome Center, Institute of Medical Science, The University of
Tokyo and RIKEN Supercomputer system RICC.

Funding: ISLiM (Next-generation integrated simulation of living
matter) project in RIKEN Computational Science Research
Program.

Conﬂict of Interest: none declared.

REFERENCES

Beal,M.J. et al. (2005) A Bayesian approach to reconstructing genetic regulatory
networks with hidden factors. Bioinformaties, 21, 3497356.

Hirose,O. et al. (2008) Statistical inference of transcriptional module-based gene
networks from time course gene expression proﬁles by using state space models.
Bioinformatics, 24, 9327942.

Kitagawa,G and Gersch,W. (1996) Smoothness Priors Analysis of Time Series, Springer,
New York.

Rangel,C. et al. (2004) Modelling T-cell activation using gene expression proﬁling and
state space models. Bioinformaties, 20, 136171372.

West,M. and Harrison,J. (1997) Bayesian Forecasting and Dynamic Models, 2nd edn.,
Springer, New York.

Wu,L.S.-Y. et al. (1996) An algorithm for estimating parameters of state-space models.
Stat. Probah. Lett., 28, 997106.

Yamaguchi,R. et al. (2008) Predicting differences in gene regulatory systems by state
space models. Genome Inform, 21, 1017113.

 

1173

112 ﬁlo's[sumo[pJOJXO'sorwuiJOJurorqﬂ:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

