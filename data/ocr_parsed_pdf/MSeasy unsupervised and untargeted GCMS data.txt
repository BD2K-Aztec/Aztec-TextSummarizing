BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

MSeasy

 

(netCDF, szML and ASCII) and can be obtained from many
providers.

When DataType=‘ ‘CDF' ', netCDF or szML are the
input formats of MS, a peak list named peaklist.txt should be
added in each sample folder. When DataType=‘ ‘ASCII ' ',
data have to go through the trans .ASCII function to obtain
compatible sample folders. Then the MS .DataCreation func—
tion smoothes the chromatograms (N_filt option) and detects
peaks by the succession of three points of increasing intensity
directly followed by three points of decreasing intensity.

When working with data from Agilent Technologies
(DataType = ‘ ‘Agilent ' ' ), the peak list is directly extracted
from the rteres.txt file in the .D directory and MS are extracted
from the AIA/ANDI ﬁles generated with the Chemstation
software.

Depending on the apex option, the relative MS of a peak is
obtained by either averaging several MS around the apex or
directly extracting the MS at the apex. If quantzTRUE, one
or two quantification measures of peak size are added in
initiaZ_DA TA. This option generates one or two distinct proflling
matrices after MS . clust. If the two quantiflcation columns are
absent, then a fingerprinting matrix (absence or presence of each
putative compound) is generated. From Agilent Technologies
constructor ﬁles, the two measures are corrected peak area and
percentage of the total corrected area.

The user can skip Step 1 and go directly to Step 2 by entering a
ﬁle corresponding to initiaZ_DA T A.txt.

In Step 2, MS.clust runs unsupervised clustering methods
on MS from the initiaZ_DA TA matrix or equivalent.

Prior to MS.clust, an optional function MS . test.clust
can be used to identify the best clustering algorithm. User should
create a training dataset where molecules are already well identi—
ﬁed and represented by several sample MS. Since the total
number of true molecules is usually unknown in untargeted
metabolic approaches, the use of unsupervised clustering algo—
rithms is required. These include partitional and hierarchical al—
gorithms with various combinations of distance metrics and link
methods (Steinbach et al., 2004). The results of clustering algo—
rithms are evaluated with three cluster validity indices that assess
which clustering scheme best ﬁts the data. The matching coefﬁ—
cient computes for correct assignment of each MS to the ex—
pected molecules. Silhouette Width (Rousseeuw, 1987) and
Dunn’s Index (Dunn,1974), based on cluster compactness and
isolation, assess for the quality of clustering.

MS . test . clust was run on various datasets: lavender spe—
cies on Agilent GC—MS (Guitton, 2010), tropical trees on Varian
GC—MS (Courtois, et al., 2009), Petrel birds on Varian GC—MS
(Mardon, 2010) and Mandrills on Shimadzu GC—MS
(Charpentier, pers. com.). Perfect clustering and best perform—
ances were always obtained with the hierarchical agglomerative
clustering with Euclidean distance and Ward link. This method is
recommended by default in MS. clust.

Since the best clustering method is established, the function
MS . clust can be used. When the total number of molecules in
the dataset is unknown, MS . clust can ﬁrst identify the optimal
number of clusters. After running the clustering on a
user—deﬁned range of numbers of clusters (c 1V = TRUE), a gra—
phic window displays the mean Silhouette Width as a function of
the number of clusters. A red line indicates the optimal number

of clusters. The user can deﬁne one or several optimal numbers
of clusters (multimodal distribution or limits of a plateau).

For each user—deﬁned number of clusters, a set of output ﬁles is
generated to control the quality and identify putative compounds:
0utput_cluster.txt and Output _peak.txt summarize, respectively,
cluster and peak information. They provide different quality cri—
teria for manual investigation: among others, peak and cluster
Silhouette Width, the eight more abundant mass fragments per
peak, peak redundancy (indicate if a cluster contains several peaks
from the same chromatogram), the range of retention time and
homogeneous cluster status. Homogeneous clusters are deﬁned by
a shift in RT/RI lower than varRT (varRT = RTmax — RTmin <
0.1 by default but can be ﬁxed to high value for omission).

For molecule identiﬁcation, automatic assignment is per—
formed if a set of commercial standards or manually assigned
reference compounds are added in the initial_DAT A matrix. In
addition, MSeasy output ﬁles can be used directly for molecule
identiflcations with NIST mass spectral search program
(MSeasytoNI ST, SeachNIST) and ARISTO webtool
(MSeasyToARISTO).

Finally, depending on the quant option, MS .clust returns a
flngerprinting matrix (0 for absence and 1 for presence) or one or
two proflling matrices for homogeneous clusters. These matrices
of processed data can be directly used for data analysis.

3. CONCLUSION

The novel R package MSeasy is a free, easy—to—use and powerful
raw data processing pipeline that extracts essential information
from raw GC—MS data with minimal effort. It is insensitive to
shift in retention time and does not require chromatogram
alignment.

MSeasy speeds up greatly GC—MS data processing, allows
handling large amount of data and limits labor—intensive and
error-prone tasks.

ACKNOWLEDGEMENTS

We thank the contributions of all beta—testers, members of the
GDR d’ecologie chimique and GDR BioChiMar, Frederic
Hache, Cyrille Conord, Jerome Chave, Sylvie Baudino,
Bernard Pasquier and the CNPMAI.

Funding: GDR d’ecologie chimique, Region Rhone—Alpes,
University Jean Monnet Saint Etienne, Region Nord—Pas—
de—Calais.

Conﬂict of Interest: none declared.

REFERENCES

Courtois,E.A. et a]. (2009) Diversity of the volatile organic compounds emitted by
55 species of tropical trees: a survey in French Guiana. J. Chem. Ecol, 35,
134971362.

Dunn,J.C. (1974) Well separated clusters and fuzzy partitions. J. Cybern, 4,
957104.

Fiehn,O. (2002) Metabolomicsithe link between genotypes and phenotypes. Plant
Mol. Biol., 48, 1557171.

Guitton,Y. (2010) Diversite des composes terpeniques volatils au sein du genre
Lavandula: aspects evolutifs et physiologiques. PhD Thexis. LBVpam,
University Jean Monnet, Saint Etienne, France.

Katajamaa,M. and Oresic,M. (2007) Data processing for mass spectrometry—based
metabolomics. J. Chromatogr. A, 1158, 3187328.

 

2279

ﬁm'spzumofpmﬂo'sopeuuopuorq/ﬁdnq

F. Nicolé et al.

 

Mardon,J. (2010) Olfaction chez les petrels : caracterisation chimique d’une signa—
ture olfactive et implications evolutives. PhD Thexis. University Montpellier II,
Montpellier, France, CEFE UMR 5175.

Rousseeuw,P.J. (1987) Silhouettes: a graphical aid to the interpretation and valid—
ation of cluster analysis. J. Comput. App]. Mat/1., 20, 53765.

Steinbach,M. et a]. (2004) The challenges of clustering high dimensional data. In
Wille,L.T. et al. (ed.) New directiom‘ in Statistical pliy.\'ic.\'.' econop/ty.\'ic.\', bioinfor—
mutics, undputtern recognition. Springer—Verlag, Berlin Heidelberg, pp. 27%309.

Sugimoto,M. et a]. (2012) Bioinformatics tools for mass spectroscopy—based meta—
bolomic data processing and analysis. Curr. Bioinform., 7, 9&108.

 

2280

/810'sleum0prOJxo'sopBLuJOJutotq”:duq

