BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Bioconductor VariantAnnotation

 

> param <— ScanchParam(info="CGA_BF",
geno="AD’ ’)

> tabix<— TabixFile(fl, yieldsizeleO 000)

> vcf <— reachf{tabiX, ‘ ‘hgl9”, param) ##
chunk l

readInfo, readGeno and readGT retrieve individual fields
as standard R objects. f i1 teerf identiﬁes records satisfying
predeﬁned and ad hoc criteria, creating a new VCF ﬁle.

1.2 Annotating and transforming variants

locateVariants associates variants with coding, intron,
splice site, promoter, UTR or intergenic regions.

> library(TxDb.Hsapiens.UCSC.hgl9.known
Gene)

> txdb ‘<— TxDb.Hsapiens.UCSC.hgl9.known
Gene

> vcf <— c(’7’=
’chr7’))

> 100 <— locatevariants(vcf, txdb, Intron
variants())

renameSeql evel s ( vcf,

The gene, transcript and coding region identifiers provided in
the output can be used with other Bioconductor resources to
map to additional identiﬁers such as protein families database
(PFAM) or gene ontology project (GO).

> library(org.Hs. eg.db)

> select (org.Hs. eg.db, loc$GENEID, c

(I ‘PFAMnI IIGOI 1))

predictCoding computes amino acid coding changes for
non—synonymous variants that overlap coding regions.
Reference sequences are retrieved from a BSgenome package
or FASTA file. Variant sequences are constructed by substituting
or inserting variant alleles into the reference sequence. Custom
genomes can be imported as a Transcriptdb object with one
of the makeTranscriptDb functions available in the
GenomicFeatures package.

> library (BSgenome . Hsapi ens. UCSC. hgl 9)
> predictCoding (vcf, thb, Hsapiens)

geno typeToSanatrix performs probability—based encod—
ing of the genotype calls in a VCF object to create an
Sanatrix object for use in downstream packages.
snpSummary provides counts and distribution statistics.

1.3 Integration and comparison with other resources

VariantAnnotati on offers highly ﬂexible tools to interrogate
and transform VCF ﬁles into R objects for exploration and ana—
lysis. In contrast to programs such as VCFtools (Danecek et al.,
2011) or PLINK/ SEQ, VariantAnnotation provides an
interactive environment for integrated portable analysis and
methods development. The ens emblVEP package is an interface
to the VEP (McLaren et al., 2010) tool, while functions in
VariantAnnotati on allow close integration with SNP

Table 2. VariantAnnotation and Rplinkseq runtimes (min)

 

 

Function Range (All ﬁelds) Range (Select ﬁelds) Iterate
Rplinkseq
load.vcf 359.8 NA NA
var.fetch 291.8 NA NA
meta.fetch NA 120.9 NA
var.iterate NA NA 1583.1
VariantAnnotation
scanch 359.1 35.5 50.3

 

analysis routines in packages such as snpStats. I/O capabilities
are compatible with upstream alignment and variant calling R
packages such as gmapR and VariantTools, as well as VCFs
produced by VarScan (Koboldt et al., 2012), GATK (McKenna
et al., 2010), etc. The ability to transform and output VCF sub—
sets enables creation of ﬁles for use in tools such as ANNOVAR
(Wang et al., 2010). R VCF objects can be visualized with pack—
ages such as ggbio (Yin et al., 2012).

VariantAnnotat ion has good performance relative to other
R tools operating on VCF files, e.g. Rpl inkseq (http://atgumgh.
harvard.edu/plinkseq/r—intro.shtml), as illustrated using a com—
pressed indexed VCF (ftp: / /ftp—trace.ncbi.nih. gov/ 1000genomes/
ftp/release/201 10521 /ALL.chr22.phase l_release_v3.20101 123.
snps_indels_svs.genotypes.vcf.gz) (494 328 records, 1092 samples
and 22 INFO and 3 genotype ﬁelds). Testing was done on a 64—bit
387 Gb 2.90 GHz Linux server; test scriptis available ininst/scripts/
of the built tarball or scripts /of the installed package. Runtimes for
four Rplinkseq functions and scanch from
VariantAnnotation are summarized in Table 2. NA values
indicate the function could not perform the abstraction.

A range of 63 088 records and two INFO and two genotype fields
were arbitrarily chosen for testing. VariantAnnotation out—
performed load . vcf when reading the range with all fields and
meta . fetch when reading in speciﬁc INFO and genotype ﬁelds.
Vari antAnno tation was ~30 >< faster than Rpl inks eq when
iterating over all records in the file. Input times for s canVc f scale
linearly with the number of variants or samples.

2 CONCLUSIONS

This Note introduces the VariantAnnotation package to
ﬂexibly interrogate, annotate and transform VCF ﬁles.
The package integrates with Bioconductor packages for
advanced SNP and variant analysis, gene and genome annota—
tion and rich tools for range—based queries.
VariantAnnotation is performant compared with other R
solutions and scales to handle large ﬁles with reasonable
memory requirements. Read/write capabilities allow ready inte—
gration with third party software.

Funding: National Human Genome Research Institute of the
National Institutes of Health (U41HG004059 to M.M.).

Conﬂict of Interest: none declared.

 

2077

ﬁm'spzumofpmjxo'sopnuuopnorq/ﬁdnq

V.Obenchain et al.

 

REFERENCES

Danecek,P. et ul. (2011) The variant call format and VCFtools. Bioinformuticx, 27,
215G258.

Drmanac,R. and Sparks,A.B. (2010) Human genome sequencing using unchained
base reads on self—assembling DNA nanoarrays. Science, 327, 78781.

Gentleman,R.C. et ul. (2004) Bioconductor: open software development for com—
putational biology and bioinformatics. Genome Biol., 5, R80.

Heng,L. (2010) Tabix: fast retrieval of sequence features from generic TAB—
delimited ﬁles. Bioiiy’ormuticx, 27, 7187719.

Koboldt,D. et ul. (2012) VarScan 2: somatic mutation and copy number alteration
discovery in cancer by exome sequencing. Genome Rec, 22, 5687576.

Lawrence,M. et ul. (2013) Software for computing and annotating genomic ranges.
PLoS Comput. Biol., 9, e1003118.

McKenna,A. et ul. (2010) The Genome Analysis Toolkit: a MapReduce framework
for analyzing next—generation DNA sequencing data. Genome Re.\'., 20,
129771303.

McLaren,W. et ul. (2010) Deriving the consequences of genomic variants
with the Ensembl API and SNP Effect Predictor. BMC Bioiiy’ormuticx, 26,
206972070.

The 1000 Genomes Project Consortium. (2012) An integrated map of genetic vari—
ation from 1,092 human genomes. Nature, 491, 56—65.

Wang,K. et ul. (2010) ANNOVAR: functional annotation of genetic variants from
high—throughput sequencing data. Nucleic Acids Re.\'., 38, e164.

Yin,T. et ul. (2012) ggbio: an R package for extending the grammar of graphics for
genomic data. Genome Biol., 13, R77.

 

2078

/810'sleum0prOJxo'sopBLuJOJutotq”:duq

