ORIGINAL PAPER

Vol. 28 no. 5 2012, pages 607-613
doi:10. 1 093/bioinformatics/btsOOQ

 

Genome analysis

Advance Access publication January 19, 2012

An effective statistical evaluation of ChlPseq dataset similarity

Maria D. Chikina1 and Olga G. Troyanskaya2’*

1Department of Neurology, Mount Sinai School of Medicine, New York, NY 10029 and 2Lewis—Sigler Institute for
Integrative Genomics, Department of Computer Science and Molecular Biology, Princeton University, Princeton,

NJ 08540, USA

Associate Editor: Alex Bateman

 

ABSTRACT
Motivation: ChlPseq is rapidly becoming a common technique
for investigating protein—DNA interactions. However, results from
individual experiments provide a limited understanding of chromatin
structure, as various chromatin factors cooperate in complex
ways to orchestrate transcription. In order to quantify chromtain
interactions, it is thus necessary to devise a robust similarity
metric applicable to ChlPseq data. Unfortunately, moving past
simple overlap calculations to give statistically rigorous comparisons
of ChlPseq datasets often involves arbitrary choices of distance
metrics, with significance being estimated by computationally
intensive permutation tests whose statistical power may be sensitive
to non-biological experimental and post-processing variation.
Results: We show that it is in fact possible to compare ChlPseq
datasets through the efficient computation of exact P-values for
proximity. Our method is insensitive to non-biological variation in
datasets such as peak width, and can rigorously model peak location
biases by evaluating similarity conditioned on a restricted set of
genomic regions (such as mappable genome or promoter regions).
Applying our method to the well-studied dataset of Chen et al.
(2008), we elucidate novel interactions which conform well with
our biological understanding. By comparing ChlPseq data in an
asymmetric way, we are able to observe clear interaction differences
between cofactors such as p300 and factors that bind DNA directly.
Availability: Source code is available for download at
http://sonorus.princeton.edu/lntervalStats/lntervalStats.tar.gz
Contact: ogt@cs.princeton.edu
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 2, 2011; revised on January 2, 2012; accepted
on January 4,2012

1 INTRODUCTION

With the advent of genome sequencing, a central question of
genome biology concerns how genetic instructions in the genome
translate into biochemical states of a cell, and how completely
different cellular phenotypes can arise from the same genetic
background. In particular, how do the various histone modiﬁcations,
transcription factors and other Chromatin proteins orchestrate a
particular transcriptional proﬁle?

Sequencing technology now makes it possible to map the location
of the various Chromatin proteins with great precision. ChIPseq

 

*To whom correspondence should be addressed.

studies can thoroughly Characterize the binding sites of transcription
factors, giving a global View of the genes they regulate, making
the identiﬁcation of speciﬁc binding motifs much easier, and
uncovering previously uncharacterized variation (Johnson et (11.,
2007; Wederell et (11., 2008). ChIPseq has also been used to proﬁle
histone modiﬁcations, increasing our understanding of the role of
such modiﬁcations in transcription and differentiation (Hoffman
et (11., 2010; Mikkelsen et (11., 2007; Rugg-Gunn et (11., 2010) as
well as allowing for the discovery of novel genes not detected by
other methods (Guttman et (11., 2009).

Ultimately, a complete understanding of Chromatin organization
must involve not only actual Characterization of the locations of
individual Chromatin proteins but also an understanding of how they
interact with each other to regulate transcription. Gene regulations in
metazoan organisms can be quite complex, with transcription factors
interacting combinatorially with each other as well as with histone
modiﬁcations and the various Chromatin modiﬁers (Cuddapah et (11.,
2009; Hoffman et (11., 2010). Although ChIPseq experiments hold
the promise of investigating these effects on a system-wide level,
suitable methods of analysis are still being developed [e.g. Pepke
et (11. (2009), Park (2009)]. An initial step in building genome-wide
understanding of Chromatin organization is developing methods
that infer biologically meaningful co-occurrence of Chromatin
components from a series of ChIPseq experiments. The simplest
approach to this problem [used in (Chen et (11., 2008; Johnson et (11.,
2007; Wederell et (11., 2008)] is to compute the total overlap of peak-
enrichment regions from different experiments. While this method
has a strong intuitive basis, it has several limitations. One problem
simply concerns the variability in size of enrichment regions:
transcription factors appear as distinct punctate peaks, for example,
while Chromatin modiﬁcations produce broad enrichment regions
(Park, 2009). Moreover, general variations in peak distribution
(such as peak length, peak number, etc.) can arise anywhere in the
experimental pipeline, as well as in subsequent data processing,
making direct comparisons between datasets, especially those
produced by different protocols, difﬁcult (Teytelman et (11., 2009).

More recently, statistical methods to assess co-occurrence have
been proposed. These methods involve the computation of some
metric of similarity between datasets such as correlation (Zhang
et (11., 2007), number of Clustered transcription factors (Chen
et (11., 2008), distance-based measures (Carstensen et (11., 2010;
Huen and Russell, 2010), etC., and then the estimation of the
probability the observed metric would occur by Chance, either by
simulation (Chen et (11., 2008; Huen and Russell, 2010; Zhang
et (11., 2007) or analytically using bounds from parametric models
(Cuddapah et (11., 2009). [See Fu and Adryan (2009) for a

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 607

112 /3.Io's[BumoprOJXO'sotwuiJOJurotq”:duq 11101} popeolumoq

91oz ‘Og anﬁnv uo ::

M.D.Chikina and O.G.Troyanskaya

 

comprehensive review.] With these methods, rankings of similarity
of pairs of ChIPseq experiments depend both on the Chosen metric
and on the effectiveness of the signiﬁcance estimates for the
particular outcomes observed. These dependencies can lead to a
lack of robustness with respect to variation in simple parameters
such as enrichment-region length, which can easily result from
small differences in experimental setup and post-processing steps
(fragment size selection, peak calling algorithm parameters, etc.).
Additionally, when compared with the simple overlap method, these
approaches can be quite technical due to the methods used to
obtain signiﬁcance bounds, or even because of the similarity metric
used, making it possible that some experimental biologists might be
reluctant to adopt the more rigorous methods.

We present a method for testing the similarity of peak distributions
between two sets of ChIPseq experiments in an asymmetric fashion,
comparing each single peak region from a ‘query’ experiment to the
set of peak regions in a ‘reference’ experiment. Apart from allowing
analysis that can capture important asymmetry in the relationships
between datasets, this approach eliminates the arbitrary Choice of
a similarity metric and dependence on the quality of signiﬁcance
estimates, and is the ﬁrst which evaluates signiﬁcance with exact
P-values—i.e. P-values which represent the exact probability of a
similarity event conditioned on the null hypothesis.

We use the term ‘exact’ to differentiate the P-values we obtain
in our method from those obtained by either parametric methods
that make assumptions about distributions or methods that employ
permutation tests and thus are only able to provide estimates limited
by the sample size. The fact that these P-values are exact in this sense
allows for more robust comparisons among calculated strengths of
association as even small differences in P-values indeed imply a real
difference in the signiﬁcance of the observed events.

Finally, the principles of our method are intuitive and easy to
grasp, as our approach relies on the same biological intuition as the
widely used overlap method. We hope this simplicity increases the
likelihood of adoption by experimental biologists.

2 METHODS

Our method compares the results of ChIPseq experiments by comparing
the sets of genomic interval peaks associated with the enrichment regions.
The inputs to our algorithm are: the query set. which consists of enrichment
regions from the query experiment (presented in blue in Fig. 1). the reference
set. which consists of enrichment regions from the reference experiment (in
red). and a third set of intervals. the domain set (in black). representing the
line-space of possible interval locations. In the simplest case. the domain
set is the entire sequence genome. but by restricting the domain set further,
one can make a comparison allowing for known biases in overall interval

l—l
l—I

 

I I I | | | |
910111213141

I I I I I

4 5 6 7 8 5161718192021
0000. on 00....
00000000 0000000

Fig. 1. A hypothetical domain set (black). reference set (red) and query
interval (blue). All possible midpoint locations for the query are shown in
black dots. Locations where the minimum distance is at most 2 are denoted
in blue.

locations. For example. if we suspect that both the reference and the query
are biased towards upstream regions of genes. we can reduce the region of
the genome considered by adjusting the domain set. This has the effect of
giving a much more conservative estimate on the probability of overlap or
proximity between the query and the reference set.

A principal difference between our method and alternative methods for
determining statistical signiﬁcance of peak distribution similarity is that our
comparison is essentially asymmetric (the query and reference sets are treated
differently). Other methods compare datasets in a symmetric way. assigning
a score to a pair of interval sets based on distances between intervals. extent
of overlap. etc.. and then estimating statistical signiﬁcance. Consequently.
particular comparisons are affected both by the choice of metric and the
power of the signiﬁcance estimates for the metric values observed in the
comparison. Our method instead makes an asymmetric one-against-many
comparison in which we compare query intervals individually against the
whole set of reference intervals. Performing the signiﬁcance calculation for
each interval means that. unlike for many-to-many symmetric comparisons.
our algorithm’s output would be identical for any distance/overlap-based
metric (distance. distance-squared. etc.), eliminating the necessity to make
an arbitrary choice of the scoring metric. We thus simply adopt the notion
that a query interval of ﬁxed length 6 which is closer in distance to (or
has greater overlap with) the reference set is more similar to it. and then
explicitly calculate for each query interval an exact P-Value representative
of the signiﬁcance of its proximity to the reference setiin other words. we
calculate the probability that a randomly located interval of the same length
6 would have been at least as close to the reference set.

We thus carry out a calculation for each individual query interval
separately (we only carry out the calculation for intervals which intersect
the domain). Considering Figure 1A. we calculate an exact P-Value for the
proximity of a query interval (the blue interval) to the reference set (the red
intervals). conditioned on the query length 6 (3 in this case. the length is the
number of points contained in the interval) as well as intersection with the
domain set (the black intervals). if applicable.

The calculation is as follows. After excluding any intervals in the reference
set that do not intersect the domain set. we calculate the minimum distance.
d. of the query interval to the nearest interval remaining in the reference set.
This distance is the minimum distance between endpoints of the intervals (in
Fig. 1 it is 2). In the case where intervals overlap. we differentiate different
degrees of closeness by setting the distance to a negative number equal to

E +(reference length)
2 .

Note that this is —1 in the case of overlap at a single point. —2 in the case
of overlap at 2 points. etc.. but can be even less than the negative overlap
when one interval completely contains the other.

We then calculate the denominator of the P-Value. This is simply the
number of possible locations on the chromosome where an interval of length
6 could be located so that it intersects the domain set. If we are not considering
the domain set. this would essentially be the size of the sequenced genome (it
is not exact because of the edges). In Figure 1. the denominator is 15. because
there are 15 different possible locations for query intervals of length 3 which
intersect the domain set.

Finally. we calculate the numerator for the P-Value. This is the number of
possible locations on the chromosome where an interval of length 6 could
be located so that it both intersects the domain set. and is at distance at most
[1 from the reference set. In the example shown in Figure 1. where (:3
and d = 2. the numerator of the P-Value is 13. because there are 13 possible
locations for query intervals of length 3 which both intersect the domain set.
and are within distance 5 2 of a reference interval. The P-Value is the ratio
of the calculated numerator and denominator; in the example from Figure 1.
it is g ~0.87.

The algorithm scales linearly with the number of query intervals as well
as the number of endpoints used for the calculation (approximately the size
of the domain set plus the size of the reference set ﬁltered for domain
intersection). Although working through the example from Figure 1 might

(midpoint distance) —

 

608

112 /3.Io's[BumoprOJXO'sotwuiJOJurotq”:duq 11101} popeolumoq

91oz ‘Og anﬁnv uo ::

ChIPseq dataset

 

give the impression that determining the exact numerator for the P-Value can
be tricky. our algorithm implements the calculation with simple and efﬁcient
operations on intervals. allowing very fast output. For example. the running
time is about 5 5 per 1000 query intervals on a personal computer when the
total number of reference and domain intervals is 3500 and about 50 5 per
1000 query intervals when the total number is 40 000.

Since the algorithm computes the exact P-Value for each proximity event.
as expected, it generates the null distribution if the interval sets are distributed
completely randomly. as demonstrated by simulated results in Figure 2A.
On the other hand. real data from interacting chromatin factors produce
distributions that are skewed towards small P-Values (Fig. 2B).

3 RESULTS

3.1 Results overview

Our algorithm provides a highly intuitive way of evaluating ChIPseq
dataset similarity while maintaining statistical rigor. It is robust
to non-biological variation that may arise from the experimental
technology, such as total genome coverage and average peak width.
Additionally, the method allows us to explicitly account for global
chromatin distribution biases.

Applying our method to reanalyse the Chen et (11. dataset (we
use processed data reported in GSE11431) of chromatin factors
involved in stem cell maintenance, we are able to capture previously
established conclusions, such as that spacial clustering of stem
cell factors occurs independently of biases towards promoter
regions, within a simple rigorous framework. We also resolve
some disagreements in prior literature and identify several novel
observations. For example, our similarity metric predicts that Nanog
is much more tightly associated with Smadl than other members
of the cluster (Sox2, Oct4, p300) which is consistent with the
known direct interaction between these two proteins. Additionally,

p—value distribution

>

0—0 plot of p—values from randomally
generated intervals

 

 

 

 

0. _
8 .-
m
g Ln 3  _
|_ (E
E T (O
.E 8 Q o. _
‘E m a ,,
8 a o' ‘
E E
z 8 o g —
O
o . _
I—l—l—l—l—I o I I l l I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
p—value uniform
B 80x2 vs Oct4 n—Myc vs c—Myc

500 1001) 1500
2500

Number of intervals
Number of Intervals
1500

5

l—l—l—l—I—l
0.0 0.2 0.4 0.6 0.8 1.0

8 LED
0 O
0.0 0.2 0.4 0.6 0.8 1.0

p—value p—value

Fig. 2. (A) P-Value histogram and QiQ plot generated from intervals
randomly placed on mouse chromosomes. (B) P-Value histograms generated
from real data in Chen et a1. (2008).

the asymmetric nature of our comparison method (as switching
the roles of query and reference produces distinct results) provides
important information about global chromatin organization.

3.2 Mapping minimal distance to P-value

ChIPseq datasets are often compared by counting overlapping peaks
which is a good ﬁrst pass way of assessing which DNA binding
proteins co-occur. However, overlap counts depend on parameters
of the peak distribution that may not be biologically meaningful,
such as the total coverage and the distribution of peak widths.
Intuitively, our method may be viewed as applying the biological
intuition of the overlap approach, with two important differences.
First, our method uses distance as well as overlap to evaluate
similarity, allowing greater sensitivity when total overlap may be
small. More importantly, the essential feature of our method is that
it allows statistically rigorous evaluation of similarity of interval
sets, by mapping minimum distances between intervals, which are
not comparable across datasets, to exact P-values, which can be
easily compared.

The important point is that, depending on the particular
characteristics of a reference set, it may be ‘easier’ or ‘harder’ to
be close to the reference set—that is, statistical signiﬁcance for a
speciﬁc proximity event may be weaker, or stronger, respectively. To
demonstrate this effect, we generate a reference set-speciﬁc function,
Pref(d) that maps minimal distances (including overlap) to P-values
for some ﬁxed query interval length. By analysing the function
Pref(d) for different sets, we can evaluate the beneﬁts of using our
statistical comparison method, rather than trying to compare overlap
or distance statistics directly.

The function Pref(d) for all interval sets generated in Chen et (11.
(2008) (a dataset of 15 DNA binding proteins involved in stem cell
maintenance) is shown in Figure 3A. Each reference set generates a
unique function, supporting a key motivation of our approach that
minimal distances (including overlaps corresponding to a negative
distance) are not directly comparable. However, such analysis
suggests a natural question as to what distribution characteristics of
the reference set determine Pref(d). An obvious candidate is the total
coverage of the interval set: the greater area of the genome covered,
the easier it is to overlap with it (or be close to it). It is important
to note that total genome coverage may not have a direct biological
meaning (such as being related to the total number of binding events)
since variation may be introduced anywhere in the experimental
pipeline as well as in the peak calling algorithm. Nevertheless,
since coverage does vary widely between datasets, total coverage
will affect subsequent processing steps. Indeed, we ﬁnd that total
coverage is the dominant factor that determines the Pref(d); however,
it does not completely explain the explicitly calculated relationship.

For example, as evident in Figure 3A, the various Pref ((1) distance
functions can cross; for example PSUZ12(—10bp) is smaller than
Psmad1(—10bp), but the relationship is reversed at d=10bp. We
further illustrate the discordance between total coverage and the
Pref(d) ﬁinction in Figure 3B, which shows a bar plot of total
coverage for the analysed datasets sorted by their P-value at 1000
bp. We do observe the expected global pattern: the dataset with the
most coverage (thf) is the least signiﬁcant at 1000 bp, whereas
the dataset with the least coverage (p300) is most signiﬁcant; yet
the relationship is not entirely monotone. The reason for this non-
monotonic behaviour is that the distance to P-value ﬁinction depends

 

609

112 /3.Io's[BrunoprOJXO'sorwuiJOJurorq”:duq 11101} popeorumoq

9103 ‘Og anﬁnv uo ::

M.D.Chikina and O.G.Troyanskaya

 

 

 

 

 

 

 

 

 

A
(\l
‘1‘
a)
,_
a)
2
GS
Te w
0.0 O
I- s
a) _
‘- _
to.
cf-
0)
to
co-
Ol_/
8 2 I I I I I I I I
|_ —20 —10 0 10 20 30 40 50
a)
‘- | | | | |

0 200 400 600 800
Minimum Distance to Set

 

 

I I I I
0e+00 1e+05 2e+05 3e+05 4e+05 5e+05 6e+05
Total Coverage (bp)

Fig. 3. (A) The mapping of proximity to P-Value for the various ChIPseq
experiments from Chen et a1. (2008). The functions differ signiﬁcantly
demonstrating that proximity statistics are not comparable and the need for
a rigorous statistical method. (B) Bar graph showing total coverage for the
datasets in A sorted by their P-Value at 1000 bp.

not only on total coverage but also on how that value grows as the
peak regions are expanded, which may vary depending on subtle
aspects of peak distribution, such as the distribution of lengths and
the distribution of intervals relative to one another (e.g. clustering).
Thus, since Pref(d) cannot be accurately parameterized in terms of
easily calculated reference distribution characteristics, our empirical
approach, which is not computationally intensive, presents a viable
alternative.

Since the P-values calculated are exact and the query length
is explicitly accounted for, our method is robust to variation in
interval length that may be introduced (for example, by changing
parameters in the peak calling method). In fact, if the intervals are
expanded even by a large factor (relative to the size of the interval)
equally on both sides, the P-values computed are exactly the same
(Fig. 4A) when the domain intervals are contracted by the same
factor (so that the set of discarded query intervals is identical). This
is because expansion affects the distance of each query interval to
the reference set equally, leaving the numerator of each P-value the
same, and the corresponding contraction of the domain set results in

 

 

 

A B
cf 8
— I_
U 2 E w
W 1:
Em a;
mwm U...
I:on Ezm
1H,- 88?
05v- éE w—
>0 m.- x
54:: o .
IELn >E
0°C #a
mol. 0:“
>On) O
Umv- :5 GI)—
E‘E‘ , 0‘“—
I l\ E
E cl) é l\
3 c?
{D

 

 

 

 

 

 

I I I I I I I I
1e—07 1e—05 1e—03 1e—01 1e—07 1e—05 1e—03 1e—01

n—Myc vs c—Myc n—Myc vs c—Myc

Fig. 4. Robustness of our method to interval expansion. (A) Reference
(c-Myc) and query (n-Myc) are expanded to 500 bp on both sides.
representing a more permissive peak calling parameter. If reference and query
are expanded by 500 bp on both sides. the resulting P-Values are exactly the
same. (B) When a more realistic perturbation of random expansion (mean
500 bp) is applied. only small P-Values are affected while the distribution
shape remains constant.

an unchanged denominator. (Note also that the algorithm correctly
handles a transition from proximity to overlap that inevitably results
from a large expansion.) If on the other hand the intervals are
expanded unequally, representing a more realistic scenario (Fig. 4B),
substantial variability arises only in the low P-values (P <0.01)
and does not affect the overall distribution shape. Repeating the
experiment 100 times produced a very tight distribution of summary
statistics (fraction of P <0.01) with all but one run being the same
to three signiﬁcant ﬁgures. However, it is important to note that
while the distribution of P-values is nearly unchanged with this
perturbation, the rank order of signiﬁcant proximity events may be
quite different.

While it is obvious that simple methods such as overlap or
correlation are affected by these perturbations in the data to
which our algorithm is robust, sophisticated alternatives can also
be vulnerable. For example, ‘Cooccur’ (Huen and Russell, 2010)
reports a P-value of 1 for the n-Myc versus c-Myc comparison,
while even the exact symmetric expansion by 500 bases on both
sides (used to generate Fig. 4A for our method) changes the P-value
to 0.000999.

3.3 Controlling for global distribution biases

It should be clear that even the most ‘unrelated’ chromatin proteins
will have some clustering of ChIP peaks, for reasons which are both
biological and technical. On the technological side, various artifacts
may be introduced at any step of the process from library preparation
to read alignment, though many of these are markedly reduced with
an appropriate control (Park, 2009). On the biological side, ChIPseq
regions may be biased towards broad classes of chromosomal
locations such as promoters, transcribed regions, GC rich regions,
etc. (Teytelman et (11., 2009). With our algorithm, such hypotheses
can be tested directly by supplying different domain sets to explicitly
model these biases and thereby normalize the results against them.
To demonstrate the effect of domains with our method, we consider
a set of mouse promoters (deﬁned as 5000 upstream to 500
downstream of transcription start site). We simulate two unrelated
transcription factors by randomly assigning a binding along the
chromosome with sites in promoter regions over-represented over
what would be expected by chance. The simulated peak regions are

 

610

112 /3.Io's[BumoprOJXO'sorwuiJOJurorq”:duq 11101} popeorumoq

9103 ‘Og anﬁnv uo ::

ChIPseq dataset

 

then used as input to our method. Using whole chromosomes as the
domain regions (i.e. not using background correction) produces a
P-value distribution indicative of a non-random association (Fig. 5,
black). However, when promoter regions are used for the domain
set, the resulting P-value distribution is uniform (Fig. 5, red), as
expected, demonstrating that our method correctly computes the
conditional probability of proximity events. In practice, knowledge
of bias regions is not always perfect, making the normalization
problem more difﬁcult. We can simulate incomplete knowledge
of bias regions with a set of ‘noisy promoters’, in which the
promoters are perturbed randomly allowing them to move, expand
and contract. When we use this noisy promoter set for background
correction, the association between the two simulated factors is
reduced (fewer small P-values are observed at any cutoff). It does
not disappear, however, as the distribution is not uniform (Fig. 5,
green). A realistic scenario in practice, however, is the ability to
make a conservative estimate of the bias region, aiming to describe
not the bias region exactly but a subset of it. Our domain-based
calculation is ideally suited to this type of correction: considering
a set of ‘noisy promoters’ which are incorrect only in the sense
that promoter regions are too small or not represented, i.e. a strict
subset of the real promoter regions, our method correctly calculates a
uniform P-value distribution for the association of the two simulated
transcription factors (Fig. 5, blue).

Various biological biases are an important concern when
evaluating the similarity among distributions of binding site.
For example, Chen et (11. (2008) took care to show that the clustering
of proteins assayed did not simply result from bias towards promoter
regions. The authors’ approach was to demonstrate that many of the
clusters occurred outside of promoter regions and that the number
of clustered TFs was not different the between promoter and distal
regions. While this analysis is a convincing control for this dataset,
it may not generalize well to other cases. Since such analysis is only
a statement about the distribution of peaks that lie outside promoter
regions, it relies on the fact that the hypothesized bias region
(promoter regions) is nearly completely known, and the analysis
would be less effective if many real genes were not annotated. Our
method on the other hand directly tests if distributions are non-
randomly clustered given that we expect that peak regions to occur
within promoters (or any other subset). Aside from being statistically
motivated, our method has the advantage of testing the distribution
of intervals that occur within the domain set and not outside of it,
and thus the domain set does not have to be exhaustive.

Using our method, we conﬁrm the Chen et (11. (2008) conclusion
that the assayed TFs cluster independently of their bias towards
promoters; however, peak regions generated from the chromatin
modiﬁer Suz12, used as a control by the authors, presents an
interesting test case for our method. Though the authors concluded
that Suz12 does not signiﬁcantly cluster with any of the other
TFs, a later reanalysis of the same dataset in Carstensen et (11.
(2010) reported a signiﬁcant association between Suz12 and
Oct4, which was supported by some experimental evidence of a
meaningful association between these factors. Our approach detects
the weak association observed by Carstensen et (11. (2010), but
when correcting for promoter regions by restricting the domain set,
the association between Suz12 and Oct4 disappears and a uniform
probability distribution is observed, suggesting that the association
between Suz12 and Oct4 may be explained by the co-occurrence in
promoter regions (Fig. 6A and B).

 

 

    

 

 

 

 

Q _
09 _
O
(I)
g
— <0
g d ‘
c'.
'C
.03
3 V. _
E O
O
Q
I chromosome background
N _
O I promoterpackground
I noisy promoter background
0 I noisy conservative
o' _ promoterbacquound
I I I I I
0.0 0.2 0.4 0.6 0.8 1.0
uniform
O
O
o V
0
l0 0
a F a 8
E E o
3 3
3 3 8
LL “8) LL ‘3
O O
0.0 0.4 0.8 0.0 0.4 0.8
p—value p—value
O
8 8
(O
>. >.
E 8 E E
3 N 3
3 3
L1: 8 L1: S
O O
0.0 0.4 0.8 0.0 0.4 0.8
p—value p—value

Fig. 5. Effects of applying background correction to simulated data. Two
non-interacting transcription factors were simulated by choosing random
binding sites along the chromosome with sites in promoters over-represented
by a factor of 2.5. The two datasets were tested for association using
different backgrounds: chromosome background (black). correct promoter
background (red). noisy promoter background. where promoter regions are
allowed to shift expand and contract (green). and a conservative noisy
promoter set which is a strict subset of the correct set (blue).

Thus, despite the fact that experimental results have shown some
cooperation between Suz12 and Oct4, the Chen et (11. (2008) dataset
may not provide independent evidence of an association. Of course,
since the normalization in our analysis works by restricting the
domain to promoter regions, the possibility remains that Suz12 and
Oct4 do not interact inside promoters but do interact elsewhere
[though we have also carried out the same analysis with DHS (Wu
et (11., 201 1) regions in place of promoter regions; see Supplementary

 

611

112 /3.ro's[sumo[p.IOJxosorwurJOJurorq”:duq uror} papeo1umoq

9103 ‘0g15n8nv uo ::

M.D.Chikina and O.G.Troyanskaya

 

Su212 vs Oct4
A (uncorrected)

 

1.0

500

number at intervals
300
Computed p—values

100

 

 

 

0.0 0.2 0.4 0.6 0.8
l

I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

p—value uniform

Su212 vs Oct4
B (promoter corrected)

 

1.0

120

number at intervals
Computed p—values

 

 

0 20 40 60 80
0.0 0.2 0.4 0.6 0.8
l

 

I—fﬁﬁ—l—I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

n W

p—value uniform

Fig. 6. Effects of applying background correction to real and simulated
data. Association between Su212 and Oct4 seen using the chromosome
background (A) disappears when the promoter correction is applied (B).
Corrected P-Values are near uniform (P = 0.104. KS-test).

Fig. S1]. It seems likely, however, that the positive result of
Carstensen et (11. (2010) is due to promoter bias, which was not
corrected for in their study. Most interesting to us is that these
results demonstrate that it is in fact possible to observe uniform
P-value distributions for associations in ChIPseq experiments by
including a fairly crude promoter correction, suggesting that a
careful application of our approach can conﬁdently distinguish true
biological interaction from coordinated bias.

3.4 A simple summary statistic

As the number of chromatin proteins proﬁled with ChIPseq methods
is rapidly increasing, it will be necessary to move beyond analyses of
single experiments to understanding global chromatin organization
in terms of interactions. In order to achieve this goal, it is necessary to
derive a similarity measure that can be treated much like correlation
in gene expression in order to quantify interaction, compare them
and ultimately analyse chromatin organization at a global network
level. So far our proposed method generates a distribution of
P-values as opposed to a single number. The fraction of P-values
below a signiﬁcance threshold provide a summary statistic that is
straightforward to interpret and robust to changes in the threshold
parameter. Setting the parameter to 0.05 or 0.01 has little effect on
rank order of all pairwise similarity measures. For the Chen et (11.
(2008) data, the resulting ranks have Spearman’s correlation of 0.97.
In fact, this threshold approach is a natural analogue of counting
overlap events: instead of doing it in distance space, we do it in a
more principled corrected P-value space.

4 DISCUSSION

By using the threshold-based summary statistic, we can visualize an
all-against-all comparison of the Chen et (11. (2008) data (Fig. 7).

Color Key
and Histogram

    

Count
0 4 a 12

.0
an

0.1 0.3
Value

 

 

Su 11 2
p300
Oct4
80x2
Nan og
Sm ad1
thf
c—Myc
Stat3
Esrrb
chcp2l 1
K|f4
fo
E211

 

 

 

 

n—Myc

Esrrb

thf

c. Myc
Stat8
chcp2l 1

K|f4
fo
E2f1
n Myc

NO {7)
Pages
N000:
2Q (01“
<0 Z

Smadt

Fig. 7. Heatmap for promoter-corrected similarity values for all factors
proﬁled in Chen et a1. (2008). Labels on the y-axis represent queries. whereas
labels on the x-axis represent references.

While our method is similar in principle to overlap-based statistics,
the results differ signiﬁcantly from overlap (Supplementary Fig. S2).
The general similarity structure produced by our analysis agrees
well with previous studies (Carstensen et (11., 2010; Chen et (11., 2008;
Ouyang et (11., 2009). Two main clusters emerge, one composed of
c-Myc, n-Myc, E2f1, fo and Klf4, and the second composed of
Nanog, Sox2, p300, Oct4 and Smadl. However, there are some
notable differences from the previous studies. For example, since
our method performs an asymmetric comparison, we observe some
one-sided interactions. In particular, all interactions involving p300
are highly asymmetric, implying that while p300 co-occurs with
many other factors, the reverse associations are much weaker. The
natural interpretation of such asymmetric interactions is that one
factor (p300) binds to a subset of genomic locations of another
(Oct4, Sox2, etc.). In the case of p300, the pattern of asymmetric
interactions with many other factors is indicative of its co-factor
function as p300 does not bind DNA on its own but is recruited by
other DNA binding proteins (Janknecht and Hunter, 1996).
Another result particular to our analysis is that while Nanog
is tightly associated with the Sox2, Oct4, p300 cluster, by far
its strongest association is with Smadl. While Nanog has been
shown to co-occur in proteins complexes with Oct4 (Wang et (11.,
2006), Smadl is the only factor in this dataset that has been
shown experimentally to interact directly with Nanog (Suzuki et (11.,
2006). The interaction serves to block bone morphogenetic protein
(BMP) induced differentiation that is meditated by Smadl. The
Smadl—Nanog interaction is also highly asymmetric, so that Smadl
co-occurs with Nanog more often than Nanog co-occurs with
Smadl. This pattern indicates that the Nanog—Smadl interaction
occurs at a subset of Nanog’s genomic locations and is consistent
with Nanog having diverse roles in stem cell maintenance that

 

612

112 /8.IO'S[BumOfplOJXO"SOIJBLUJOJIIIOICIH2611111 uror} popBo1umoq

9103 ‘0g15n8nv uo ::

ChIPseq dataset

 

 

 

Fig. 8. Graph representation of interactions in Figure 7. Top 35 interactions
are included. Two main clusters highlighted in red and blue have an overall
hierarchical relationship.

involves both activation and repression of target genes (Pan and
Thomson, 2007).

Overall, the complete interaction pattern presents a hierarchical
structure depicted as a directional interaction graph in Figure 8. In
particular, the second cluster (Nanog, Sox2, p300, Oct) interacts
more strongly with the ﬁrst (c-Myc, n-Myc, E2f 1, fo, Klf4) than
vice versa, indicating a subset relationship. This global hierarchical
pattern is consistent with the ﬁrst cluster being more broadly
distributed and having a more general role, as several of the proteins
in this cluster are involved in proliferation and have important roles
outside embryonic stem cells (Leung et (11., 2008; Singh and Dalton,
2009; Zajac-Kaye, 2001). On the other hand, the factors in cluster
2 (Nanog, Sox2, Oct4) have a more restricted distribution and are
considered to be speciﬁc markers of pluripotency (Kunisato et (11.,
2010; Wernig et (11., 2007).

We have developed a method for ChIPseq comparisons that
is statistically rigorous, yet frilly transparent and thus intuitive
to biology researchers. In particular, our method makes simple
assumptions and does not rely on any numerical optimizations
or permutation tests; our ability to observe uniform P-value
distributions in simulated and non-interacting real datasets lends
conﬁdence to our predictions for real data. Our method naturally
extends to the concept of conditional similarity making it easy to
investigate how general biases in genomic locations of chromatin
factors affect the perceived clustering among them. The transparency
of our method should aid in its adoption in the general biology
community as the output is very easy to interpret. For every
query interval, our method produces the closest reference interval,
the distance between them and the corresponding numerator,
denominator and P-value, making it easy to trace the results back
to the proximity events in the original data.

Funding: This research was supported by NSF CAREER award
DBI-0546275, NIH grant R01 GM071966, NIH grant R01
HG005998, and partially supported by NIGMS Center of Excellence
grant P50 GM071508 and NIH grant T32 HG003284.

Conﬂict of Interest: none declared.

REFERENCES

Carstensen,L. et al. (2010) Multivariate Hawkes process models of the occurrence of
regulatory elements. BMC Bioinformatics, 11, 456.

Chen,X. et al. (2008) Integration of external signaling pathways with the core
transcriptional network in embryonic stem cells. Cell, 133, 110671117.

Cuddapah,S. et al. (2009) Global analysis of the insulator binding protein ctcf in
chromatin barrier regions reveals demarcation of active and repressive domains.
Genome Res., 19, 24732.

Fu,A.Q. and Adryan,B. (2009) Scoring overlapping and adjacent signals from genome-
wide chip and damid assays. Mol. Biosyst., 5, 142971438.

Guttman,M. et al. (2009) Chromatin signature reveals over a thousand highly conserved
large non-coding RNAs in mammals. Nature, 458, 2237227.

Hoffman,B.G. et al. (2010) Locus co-occupancy, nucleosome positioning, and h3k4me1
regulate the functionality of foxa2-, hnf4a-, and pdxl-bound loci in islets and liver.
Genome Res., 20, 103771051.

Huen,D.S. and Russell,S. (2010) On the use of resampling tests for evaluating statistical
signiﬁcance of binding-site co-occurrence. BMC Bioinformatics, 11, 359.

Janknecht,R. and Hunter,T. (1996) Versatile molecular glue. transcriptional control.
Curr Biol., 6, 9517954.

Johnson,D.S. et al. (2007) Genome-wide mapping of in vivo protein-dna interactions.
Science, 316, 149771502.

Kunisato,A. et al. (2010) Generation of induced pluripotent stem cells by efﬁcient
reprogramming of adult bone marrow cells. Stem Cells Dev., 19, 2297238.

Leung,J.Y. et al. (2008) A role for Myc in facilitating transcription activation by e2f 1.
Oncogene, 27, 41724179.

Mikkelsen,T.S. et al. (2007) Genome-wide maps of chromatin state in pluripotent and
lineage-committed cells. Nature, 448, 5537560.

Ouyang,Z. et al. (2009) Chip-seq of transcription factors predicts absolute and
differential gene expression in embryonic stem cells. Proc. Natl Acad. Sci. USA,
106, 21521721526.

Pan,G. and Thomson,J.A. (2007) Nanog and transcriptional networks in embryonic stem
cell pluripotency. Cell Res., 17, 4249.

Park,P.J. (2009) Chip-seq: advantages and challenges of a maturing technology. Nat.
Rev. Genet., 10, 669480.

Pepke,S. et al. (2009) Computation for chip-seq and rna-seq studies. Nat. Methods, 6
(11 Suppl.), $224932.

Rugg-Gunn,P.J. et al. (2010) Distinct histone modiﬁcations in stem cell lines and
tissue lineages from the early mouse embryo. Proc. Natl Acad. Sci. USA, 107,
10783710790.

Singh,A.M. and Dalton,S. (2009) The cell cycle and Myc intersect with mechanisms
that regulate pluripotency and reprogramming. Cell Stem Cell, 5, 1417149.

Suzuki,A. et al. (2006) Nanog binds to smadl and blocks bone morphogenetic protein-
induced differentiation of embryonic stem cells. Proc. Natl Acad. Sci. USA, 103,
10294410299.

Teytelman,L. et al. (2009) Impact of chromatin structures on dna processing for genomic
analyses. PLoS One, 4, e6700.

Wang]. et al. (2006) A protein interaction network for pluripotency of embryonic stem
cells. Nature, 444, 3647368.

Wederell,E.D. et al. (2008) Global analysis of in vivo foxa2-binding sites in
mouse adult liver using massively parallel sequencing. Nucleic Acids Res, 36,
45494564.

Wemig,M. et al. (2007) In vitro reprogramming of ﬁbroblasts into a pluripotent es-cell-
like state. Nature, 448, 3187324.

Wu,W. et al. (2011) Dynamics of the epigenetic landscape during erythroid
differentiation after GATAl restoration. Genome Res, 21, 165971671.

Zajac-Kaye,M. (2001) Myc oncogene: a key component in cell cycle regulation and its
implication for lung cancer. Lung Cancer, 34 (Suppl. 2), $434946.

Zhang,Z.D. et al. (2007) Statistical analysis of the genomic distribution and correlation
of regulatory elements in the encode regions. Genome Res, 17, 7877797.

 

613

112 /3.ro's[Bumo[p.IOJxosorwurJOJurorq”:duq uror} popeo1umoq

9103 ‘0g isnﬁnv uo ::

