Biainfarmatics, 32, 2016, i147—i155
doi: 10.1093/bioinformatics/btw283
ISMB 2016

 

Analysis of differential splicing suggests
different modes of short-term splicing
regulation

Hande Topa1'2'* and Antti Honkela2'*

1Helsinki Institute for Information Technology HIIT, Department of Computer Science, Aalto University, Espoo
00076, Finland and 2Helsinki Institute for Information Technology HIIT, Department of Computer Science, University
of Helsinki, Helsinki 00014, Finland

*To whom correspondence should be addressed.

Abstract

Motivation: Alternative splicing is an important mechanism in which the regions of pre—mRNAs are
differentially joined in order to form different transcript isoforms. Alternative splicing is involved in
the regulation of normal physiological functions but also linked to the development of diseases
such as cancer. We analyse differential expression and splicing using RNA—sequencing time series
in three different settings: overall gene expression levels, absolute transcript expression levels and
relative transcript expression levels.

Results: Using estrogen receptor or signaling response as a model system, our Gaussian process—
based test identifies genes with differential splicing and/or differentially expressed transcripts. We
discover genes with consistent changes in alternative splicing independent of changes in absolute
expression and genes where some transcripts change whereas others stay constant in absolute
level. The results suggest classes of genes with different modes of alternative splicing regulation
during the experiment.

Availability and Implementation: R and Matlab codes implementing the method are available at
https://github.com/PROBIC/diffsplicing. An interactive browser for viewing all model fits is available
at http://users.ics.aalto.fi/hande/splicingGP/

Contact: hande.topa@helsinki.fi or antti.honkela@helsinki.fi

 

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Alternative splicing is an important mechanism for increasing prote—
ome complexity in eukaryotes. A great majority of human genes
have been found to exhibit alternative splicing with a growing num—
ber of annotated spliceforms (Djebali et (11., 2012; Sultan et (11.,
2008; Wang et (11., 2008). Changes in splicing are important for cell
differentiation (Trapnell et (11., 2010). Abnormal splicing has been
associated with many diseases, including cancer (Barrett et (11.,
2015; David and Manley, 2010) as well as neurodegenerative dis—
eases (Cooper—Knock et (11., 2012).

Our ability to study and understand alternative splicing is limited
by the technology to measure it. The most widely used method is
RNA—sequencing (RNA—seq). There are emerging sequencing tech—
niques that enable sequencing of full—length mRNAs (Tilgner et (11.,
2014), but they do not match the sequencing depth and economy of
short—read sequencing technologies which are needed at least to com—
plement the long read sequencing for more reliable quantification of

©The Author 2016. Published by Oxford University Press.

low—abundance genes and transcripts. Analysis of short—read RNA—
seq data raises a difficult problem to identify and infer the expression
levels of transcript isoforms from reads that are too short to uniquely
map to a single isoform. Several methods have been developed to
solve this problem (e.g. Glaus et (11., 2012; Jiang and Wong, 2009; Li
et (11., 2010; Trapnell et (11., 2010), whereas others have focused on in—
ference of individual alternative splicing events instead of full tran—
script quantification (Katz et (11., 2010). A recent evaluation found
that especially the transcript assembly problem is currently too diffi—
cult to solve reliably from short—read data (Janes et (11., 2015 ), and rec—
ommended quantification based on known annotated transcripts.
Even for this problem there is significant variation between alternative
methods (Kanitz et (11., 2015; SEQC/MAQC—IH Consortium, 2014).
Our study is motivated by the desire to understand the principles
of the regulation of splicing. On a large scale, DNA/RNA sequence
motifs (Barash et (11., 2010; Xiong et (11., 2015) and epigenetics
(Luco et (11., 2010) are important factors in regulation of splicing

i147

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journaIs.permissions@oup.com

112 /310'slcumofp1q1xo"soiJBurJOJuioiq/ﬁduq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

i148

H. Topa and A.Honkela

 

(Luco and Misteli, 2011), especially between individuals as well as
between tissues. In this article, we study short—term changes in splic—
ing during signaling response within a single tissue or cell line, hap—
pening on a time scale of minutes to a few hours. We use estrogen
receptor or signaling response on MCF7 breast cancer cell line as our
model system here using data from Honkela et al. (2015). The first
studies performing genome—wide RNA—seq analyses on similar time
scale (Aijo et (11., 2014; Trapnell et (11., 2010) have investigated cell
differentiation, while ours is the first to study signaling in this detail.

Methodologically, our work resembles that of Aijo et al. (2014),
except they only focus on analysis of gene expression from RNA—seq
and do not study splicing. A similar dynamical model and test for
generic gene expression analysis that does not take the properties of
RNA—seq data into account was proposed by Kalaitzis and
Lawrence (201 1).

2 Materials and methods

2.1 Methods overview

We present a method for ranking the genes and transcripts accord—
ing to the temporal change they show in their expression levels. In
order to identify differential splicing and its underlying dynamics,
we model the expression levels in three different settings: overall
gene expression level, absolute transcript expression level and rela—
tive transcript expression level expressed as a proportion of all tran—
scripts for the same gene.

An outline of our method is shown in Figure 1. Having the
RNA—seq time series data, we first start by aligning the RNA—seq
reads to the reference transcriptome by Bowtie (Langmead et (11.,
2009) and then estimate the transcript expression levels by BitSeq
(Glaus et (11., 2012) separately at each time point. We use BitSeq be—
cause it was found to deliver state—of—the—art performance in recent
evaluations (Kanitz et (11., 2015; SEQC/MAQC—III Consortium,
2014). The same procedure could be applied to other methods that
provide reliable uncertainties on quantification results, such as
RSEM with posterior sampling (Li and Dewey, 2011). Finally, we
model the time series of log—expression or relative expression by two
alternative Gaussian process (GP) models, namely time-dependent
and time-independent GPs. In time—dependent GPs, we combine a
squared exponential covariance matrix to model the temporal de—
pendency and a diagonal covariance matrix to model the noise
whereas in the time—independent GP, we use only the diagonal noise
covariance matrix. Finally, we rank the time series by Bayes factors
which are computed by the ratio of the marginal likelihoods under
alternative GP models.

Our GP—based ranking method utilizes the expression posterior
variances from BitSeq in the noise covariance matrices of our GP
models, which allows us to set different lower bounds on the noise
levels at different time points. A similar approach for modeling the
variance from count data has recently been shown to yield higher
precision than the naive application of GP models in detecting SNPs
(single—nucleotide polymorphisms) selected under natural selection
in an experimental evolution study (Topa et (11., 2015).

We further introduce a method for improving the variance esti—
mation in situations where the replicates are available only at a
small number of time points. More specifically, we perform a simu—
lation with an L—shaped experiment design which consists of three
replicates only at the first time point and only one observation at
each of the subsequent time points. We then develop a mean—
expression—dependent variance model in order to identify the rela—
tion between the mean and the variance of the expression levels by

 

Reads

 

 

 

 

Reference

transcriptome Angned

reads

 

 

 

 

  
 

Expression
level
estimates

.1 H; m‘

GP models for

 

 

 

GP models for GP models for

overall transcript transcript
gene absolute relative
expression expression expression
levels levels levels

Fig. 1. Methods pipeline: (A) The reads are aligned to the reference transcrip-
tome at each time point. (B) Expression levels are estimated for each tran-
script at the given time points. After appropriate normalization and filtering,
time series are ranked by the Bayes factors which are computed by dividing
the marginal likelihoods under time-dependent and time-independent GP
models in three settings: (I) overall gene expression; (ll) absolute transcript
expression and (Ill) relative transcript expression.

using the replicated data available at the first time point and ex—
trapolate this relation to the other time points in order to determine
the variance estimates depending on the mean expression level
estimates.

With a small—scale simulation study, we evaluate the perform—
ances of our GP—based ranking method under different scenarios in
which the variance information is obtained or used in different
ways. We then apply the best—performing variance method in
genome—wide real data set and present interesting short—term splic—
ing modes observed in the absolute and relative transcript expres—
sion levels. In the following subsections, we will elaborate the
intermediate steps in the methods pipeline which have been summar—
ized in Figure 1.

2.2 Gene and transcript expression estimation

As the data were based on an rRNA depletion protocol, we con—
structed the reference transcriptome by combining cDNA sequences
of the protein—coding transcripts, long non—coding RNA and pre—
mRNA sequences from gencode.v19 human transcriptome files,

112 /310'slcumofp1q1xo"soiJBurJOJuioiq/ﬁduq 11101} popcolumoq

91oz ‘Og anﬁnv uo ::

Different modes of short—term splicing regulation

i149

 

which we downloaded from ftp://ftp.sanger.ac.uk/pub/gencode/
Gencode_human/release_19/. Then we ran Bowtie (Langmead et (11.,
2009) to align the RNA—seq reads to our reference transcriptome ac—
cording to instructions of the BitSeq package.

Having obtained the aligned reads, we estimated the transcript
absolute expression levels by BitSeq (v.0.7.0). BitSeq is a Bayesian
method for inferring transcript expression levels from RNA—seq ex—
periments (Glaus et (11., 2012) and it returns a posterior distribution
over expression levels represented as Markov chain Monte Carlo
(MCMC) samples from the distribution.

After obtaining the BitSeq MCMC samples of the expression
level estimates for each transcript, we focused to mature mRNAs by
removing the pre—mRNAs and renormalizing the reads per kilobase
per million reads (RPKM) values of the remaining transcripts with
respect to the new number of total mapped reads after exclusion of
the reads mapped to the pre—mRNAs. This was necessary to stand—
ardize the samples against possible changes in mRNA/pre—mRNA
ratio. In addition, we normalized the gene expression levels across
time points using the method of Anders and Huber (2010).

2.3 GP modeling of expression time series

A GP is defined as a collection of random variables, any finite subset
of which have a joint Gaussian distribution (Rasmussen and
Williams, 2006). A GP is specified by its mean function m(t) and co—
variance function E(t, t’):

f0) ~ GP(m(t)72(t7 11)) (1)

Let us assume that we have noisy observations y, measured at time
points t for t : 1, . . . ,n and the noise at time t is denoted by 6,. Then,
y, : f(t) + at. (2)

To make the computation simpler, let us subtract the mean from
the observations and continue with a zero—mean GP. From now on,
y, will denote the mean—subtracted observations and hence
f (t) N GP (0, 2(t, t’)). Let us combine all the observations in the vector
y such that y : [311,312, . . . ,yn]. Assuming that the noise at is also dis—
tributed with a Gaussian distribution with zero mean and covariance
2‘, and combining the sampled time points in vector T : [1, . . . ,n]
and the test time points in vector T“ the joint distribution of the train—
ing values y and the test values f, : f (T*) can be written as:

y 2(T, T) +241 T) 2(T,T.)
[ ]~N 0, . (3)
ﬂ ( I 20m Emmi)

Applying the Bayes’ theorem, we obtain

, 170712)
where
Y"‘ N(072(T7T) +26(T7 

The computation of Equation 4 leads to:
f*IY~N(Im72*)7 (6)
where
111* I EIﬁIYI 2 HT“ T)I2(Ta T) + 241 T)I_1Y (7)
and

2. 2 2m, T.) — 2m, T) [2(T, T) + 2.(T, T)j—12(T, n). (8)

The covariance function 2(t, t’) of the GP determines the shape
of the model, and for estimation purposes it can be constructed
based on the assumptions of the underlying model. Squared expo—
nential covariance (25B) is one of the commonly used covariance
functions which is suitable for modeling smooth temporal changes
with its two parameters: the length scale, 2, and the variance, 
Each element of the matrix 25}; can be computed as

(171’)2

25E(t,tl) : (Tilda— 212 . (9)

 

As demonstrated in Topa et al. (2015 ), the performance of the
GP—based ranking methods can be improved by incorporating the
available variance information into the GP models. For this reason,
we modify the noise covariance matrix such that the variances given
in the diagonal have lower bounds which are determined by the vari—
ances estimated at each time point separately:

EEZdIangxI‘I'Sia-naafvd'sﬁl (10>

2‘ resembles the white noise covariance (Till except for the fact that
the variances are not identical at each time point, being restricted by
a lower bound. Note that the only parameter of 2‘ is (7%] since the
variances 5% are considered fixed for t : 1, . . . ,n.

The log marginal likelihood of the GP model can be written as:
1 (me—1T2 -1 Jim: (in 21: (11)
n p y _  obs Y 2 obs 2 7

where 20b, : 2(T, T) + 26(T, T). We estimate the parameters of the
covariance matrices by maximizing the log marginal likelihoods by
using the gptk R package which applies scaled conjugate gradient
method (Kalaitzis and Lawrence, 2011). In order to prevent the al—
gorithm from getting stuck in a local maximum, we try out different
initialization points on the likelihood surface.

2.4 Ranking by Bayes factors

For ranking the genes and transcripts according to their temporal ac—
tivity levels, we model the expression time series with two GP mod—
els, one time—dependent and the other time—independent. While
time—independent model has only one noise covariance matrix 2‘,
time—dependent model additionally involves 25}; in order to capture
the smooth temporal behavior. Then, the log marginal likelihoods of
the models can be compared with Bayes factors, which are com—
puted by their ratios under alternative models where the log mar—
ginal likelihoods can be approximated by setting the parameters to
their maximum likelihood estimates instead of integrating them out,
which would be intractable in our case. Therefore, we calculate the
Bayes factor (K) as follows:

K i P(yI01, ‘time — dependent model’) (12)
P(yI00, ‘time — independent model’) I

 

where 00 and 01 contain the maximum likelihood estimates of the
parameters in the corresponding models. According to Jeffrey’s
scale, log Bayes factor of at least 3 is interpreted as strong evidence
in favor of our ‘time—dependent’ model (Jeffreys, 1961).

2.5 Application of the methods in three different
settings

Assuming we have M transcripts whose expression levels have been
estimated at n time points, let us denote the lath MCMC sample
from the expression level estimates (measured in RPKM) of tran—
k for t:1,...,n,m:1,...,M and

script m at time t by 0M,
k:1,...,500. Here we will explain how we determine the

112 /310'slcumofp1q1xo"soiJBurJOJuioiq/ﬁduq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

i150

H. Topa and A.Honkela

 

52) which we

7 n

observation vector y and the fixed variances (5%, . . .
incorporated into the noise covariance matrix 2. in our GP models
in three different settings:

2.5.1 Gene-level

We compute the overall gene expression levels by summing up the
expression levels of the transcripts originated from the same gene,
and we calculate their means and variances as following:

yit,gen : E}: 10g 2 of,” 7 

mEI,»

where I,- is the set of the indices of the transcripts which belong to
gene /.

2 i zbitseq Zmodeled
Sitageﬂ _ max (Sitageﬂisitageﬂ 7 (14)

where

 : Var;a (log(Z 0%)) (15)

mEI,»

. modeled
and modeled var1ances (5%, gm

variance model which will be explained in Section 2.6.

) are obtained by a mean—dependent

2.5.2 Absolute-transcript—level

Note that in order to remove the noise that could arise from lowly
expressed transcripts, we filtered out the transcripts which do not
have at least 1 RPKM expression level at two consecutive time
points. Subsequent transcript—level analyses, both in absolute and
relative level, were performed by keeping these transcripts out. Then
we computed the means and the variances for the absolute transcript
expression levels as:

ymt,abs :  
2 zbitseq Zmodeled
Smt,abs : max (Smt,abs7 Smt,abs ) 7 
where
bitse
Sinafys : Vark(10g(0fnt)) 
2modeled

and modeled variances (s ) are obtained by a mean—dependent

mt,abs
variance model which will be explained in Section 2.6.

2.5.3 Relative-transcript—level
We computed the relative expression levels of the transcripts by
dividing their absolute expressions to the overall gene expression

 

 

levels:
0}:
ymt,rel : Ek mt 7 
Z 0‘
mt
"161)
and
zbitseq 2modeled
Sinnrel : maX($mt,re17$mt,rel )7 
where
la
bise 0
53...}; = Vark "‘3. (21>
2 0m
"161)

and modeled variances for transcript relative expression levels

modeled , . . .
(53m,rel ) are obtalned by Taylor approx1matlon usmg the modeled
variances of logged gene and logged absolute transcript expression

levels:

modeled 2 2 2
53nt,rel : (Smt,abs + Sit,gen)(ymt,r81) - (22)

2.6 Modeling the mean—dependent variance

In this section, we will explain how we model the mean—dependent
variances by utilizing the MCMC samples generated by BitSeq for
each of the replicates available at one time point. Our variance
model resembles that of BitSeq Stage 2 (Glaus et (11., 2012) except
for the fact that we have only one condition and we assume the
mean expression levels are fixed. A similar approach is also used by
DESeq (Anders and Huber, 2010). Let us assume that at a time point
we have R replicates, each of which can be estimated by the mean of
the MCMC samples generated by BitSeq. We start by dividing the
genes into groups of $500 such that each group contains the genes
with similar mean expression levels. Let us denote the expression
level (log RPKM) of the rth replicate of the jth gene in the gth group
by 312, and the mean expression level by ugﬁi, which is calculated as

u..- =Er<yéf2> (23>

Let us also assume that 314;?-
1

434’

follows a normal distribution with
mean Mg”,- and variance

y?)- ~ Norm (Ma-7 7 (24>
M
where
4&1" N Gamma(“g7 ﬁg) (25)
and
nag. ﬁg) ~ Uniw. 00). (26>

Setting pg”,- fixed to the mean of the MCMC samples over repli—
cates, we apply a Metropolis—Hastings algorithm to estimate the

hyperparameters org and ﬁg for each gene group g. Then we estimate
2

, modeled . .
the modeled variance 5/. for any given expressmn level W by

Lowess regression which is fitted by smoothing the estimated group
 (: E—g) across group means.
“3 Gig

variances (

The details about the estimation of the hyperparameters with
Metropolis—Hastings algorithm can be found in ‘Supplementary
text’.

2.7 Evaluation of the variance estimation and feature
transformation methods with synthetic data

Although high—throughput sequencing technologies have become
less costly during the last decade, the trade—off between the cost and
the number of replicates still remains as an important factor which
needs to be handled with caution. Especially in time series experi—
ments, having replicated measurements at each and every time point
could still be very costly.

Here, we evaluate our method under different experiment de—
signs with different numbers of replicates by developing appropriate
variance estimation methods for each design.

For this aim, we simulated small—scale RNA—seq time series data
and compared the performances of different variance estimation
methods in GP models when replicates are available only at some
time points or are not available at all. We simulated RNA—seq reads

112 /310'slcumofp1q1xo"soiJBurJOJuioiq/ﬁduq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

Different modes of short—term splicing regulation

i151

 

at 10 time points (t E {1, . . . ,10}) for 15 530 transcripts originating '
from 3811 genes

tive expression levels, respectively. As RNA—seq data is generally
known to follow a negative binomial distribution (Robinson et (11., '
2010), we generated three replicates at each time point from a nega—
tive binomial distribution in which the variance (02) depends on the
mean (u) and the overdispersion parameter ((1)) with the function '
02 : u + (1)2112. We simulated three sets of experiments with overdis—
persion parameter ((1)) set to 0.05, 0.1 and 0.2.

We compare average precision (AP) values of the methods in '
which the variances which are incorporated into the noise covari—
ance matrix of the GP models are estimated in different ways. We

in chromosome 1

in the transcriptome
Homo_sapiens.GRCh37.73. Expression levels of 384 (z 10%) genes
are changing in time while the rest are constant except for noise.
Similarly, 2868 (w 18%) and 1530 (w 10%) of the transcripts have '
been generated from a time—dependent model in absolute and rela—

can list the variance estimation methods as following:

      

 

Overall gene expression ($20.05)

 

 

 

 

 

 

 

  
 

 

 

 

 

0.75
E 3-rep_bitseq (0.99)
 0.5 2-rep_bitseq (0.97)
g unrep_modeled (0.93)
unrep_bitseq (0.91)
025 -------- -- 3-rep_naive (0.99)
- - - 2-rep_naive (0.98)
unrep_naive (0.88)
O
0 0.25 0.5 0.75

0.75

0.5

Precision

0.25

0.5

Precision

0.25

{Itanscript absolute

Transcript rel
1 i .

Recall

expression (43:0.05)

 

   

 

 

3-rep_bitseq(0.82)
2-rep_bitseq(0.78)
unrep_modeled (0.70)
unrep_bitseq (0.67)
-------- -- 3-rep7naive (0.82)

— — - 2-rep7naive (0.75)
unrep_naive (0.57)

 

 

 

 

 

/"

 

 

 

 

 

0 0.25 0.5
Recall

0.75

    

.__\"

ative expression (45:0.05)

 

 

3-rep_bitseq (0.85)
2-rep7bitseq (0.79)
unrep_modeled (0.72)
unrep_bitseq (0.69)
-------- -- 3-rep_naive (0.79)

- - - 2-rep_naive (0.72)

 

 

 

 

 

unrep_naive (0.52)

 

 

 

 

 

 

0 0.25 0.5
Recall

0.75

Precision

Precision

Precision

0.75

0.5

0.25

0.75

0.5

0.25

1 Transcript relative expression (¢:0.1)

0.25

 

1Transcript absolute expression (215:0.1)

not include any ﬁxed variances s

unrep_naive: Standard GP regression which does not incorporate
the variance information into the noise covariance matrix. In
other words, the noise covariance matrix in Equation 10 does

n-reszaiI/e: Standard GP regression which does not incorporate
the variance information into the noise covariance matrix.
However, there are 71 replicates available at all time points.
unrep_bitseq: Only one observation is available at each time
point. The means and the variances of the expression level esti—
mates are computed by using the BitSeq MCMC samples.
n-rep_bitseq: The ideal case in which 71 replicates are available at
all time points. BitSeq variances are computed separately for

each replicate and are included in the noise covariance matrix.

unrep_modeled: There are three replicates only at the ﬁrst time
point and only one observation at the other time points. At the
ﬁrst time point, genes are divided into groups with similar mean

expression levels and mean—dependent variances are estimated

Overall gene expression ($20.1)

 

 

3-rep_bitseq (0.98)
2-rep_bitseq (0.97)
unrep_modeled (0.90)
unrep_bitseq (0.87)

. . . . . . . . .. 3.rep_naIVe (0.99)

_ _ — 2.rep_naive (0.98)
unrep_naive (0-83)

 

 

 

 

 

 

 

 

 

0 0.25 0.5
Recall

0.75 1

‘u

    

 

 

3-rep7bitseq(0.81)
2-rep_bitseq(0.76)
unrep_modeled (0.65)
unrep_bitseq (0.62)
........ .. 3-rep_naive (0.82)

— — — 2-rep_naive (0.75)
unrep_naive (0.53)

 

 

 

 

 

 

 

 

 

 

 

0 0.25 0.5
Recall

0.75 1

  

 

3-rep_bitseq (0.84)
2-rep_bitseq (0.78)
unrep_modeled (0.67)
unrep_bitseq (0.65)
-------- -- 3-rep7naive (0.77)

— — - 2-rep_naive (0.70)

 

 

 

 

 

 

 

unrep_naive (0.47)

 

 

 

0.25 0.5
Recall

0.75 1

Precision

0.75

0.5

Precision

0.25

 

 

 

    
 
 

 

 

 

..... .. 3.rep_naive (0.99)
_ _ — 2.rep_naive (0.95)

 

3-rep_bitseq (0.98)
2-rep_bitseq (0.95)
unrep_modeled (0.79)
unrep_bitseq (0.75)

unrep_naive (0.72)

 

 

 

 

 

0.25 0.5
Recall

0.75 1

 

1Transcript absolute expression ((15:02)

0.75

0.5

Precision

0.25

.‘

 

 

 

 

 

 

..... .. 3.rep_naive (0.78)
— — — 2-rep_naive (0-67)

 

3-rep7bitseq(0.73)
2-rep_bitseq(0.67)
unrep_modeled (0.52)
unrep_bitseq (0.49)

unrep_naive (0.42)

 

 

 

0.25 0.5
Recall

0.75 1

1 Transcript relative expression (¢:0.2)

0.25

 

 

-- 3-rep7naive (0.72)
— — - 2-rep_naive (0.60)

3-rep_bitseq (0.80)
2-rep_bitseq (0.70)
unrep_modeled (0.54)
unrep_bitseq (0.50)

 

unrep_naive (0.32)

 

 

 

0.25 0.5

0.75 1
Recall

Fig.2. Precision—recall curves for the GPs with different variance estimation methods and overdispersion parameters (qb). The numbers in the legend denote APs
of the methods (equivalent to area under the curve). The circles indicate the cut-off log(BF) > 3. The low precision values obscured by the legend correspond to
high false discovery rate (FDR) that would not be used in practice.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂduq 11101} pap1201umoq

9103 ‘0g anBnV uo ::

i152

H. Topa and A.Honkela

 

Transcript absolute expression (¢=0.05)
1 1 2 ~ ~

  

Transcript absolute expression ((15:01)
1

 

Transcript absolute expression ((15:02)
1  . _

 

 

    
 
 

 

  
 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

   

   

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

  

 

 

 

 

 

 

 

 

 

 

 

ti.
0.75 0.75 0.75
.5 3-rep_bitseq(0.97) § 3-rep_bitseq(0.97) g 3-rep_bitseq(0.93)
 0_5 grepibitseqwge)  0.5 2-rep_bitseq(0.95)  0.5 2-rep_bitseq(0.86)
‘3 unrepimodeled (0.93) g unrep_modeled (0.85) g unrep_modeled (0.62)
n' unrepibitseq (0.90) unrepibitseq (0.79) unrepibitseq (0.54)
0.25 -------- -- 3-rep_naive(0.96) 025 -------- -- 3-rep_naive (0.96) 025 -------- -- 3-rep_naive (0.94) 1
— — - 2-rep_naive (0.95) — — - 2-rep_naive (0.94) — — — 2-rep_naive (0.85)
unrep_naive (0.83) unrepinaive (0.74) unrepinaive (0.52)
O 0 r 0 r
O 0.25 0.5 0.75 1 0 0.25 0.5 0.75 1 0 0.25 0.5 0.75 1
Recall Recall Recall
Transcript relative expression (¢=0.1) Transcript relative expression (45:02)
1 ‘ f cc "3 ~ 5 1 ——:»= w  1:: , e
0.75 0.75
E 3-rep_bitseq (0.98) § a-rep_bitseq (0.98) ,5 3-rep_bitseq (0.98)
 0.5 2.rep_bitseq (0.97)  0.5 2-rep_bitseq (0.97)  0.5 2-rep_bitseq (0.96)
“:3 unrep modeled (0.96) 9 unrep_mOdeled (0.94) ‘3 unrep_modeled (0.84)
o. i . D- . n. .
unrep_bltseq (0.94) ~ unrep_bltseq (0.92) unrep_bltseq (0.81)
025 -------- -- 3-rep_naive (0.98) 025 -------- -- 3-rep_naive (0.98) 0.25 -------- -- 3-rep_naive (0.98)
— — - 2-rep_naive (0.97) - - - 2-rep_naive (0.96) - - - 2-rep_naive (0.95)
unrep_naive (0.90) unrep_naive (0.88) unrep_naive (0.77)
0 0 0
0 0.25 0.5 0.75 1 0 0.25 0.5 0.75 1 0 0.25 0.5 0.75 1
Recall Recall Recall

Fig. 3. Precision—recall curves for the GPs with different variance estimation methods and overdispersion parameters (qb) for the highly expressed (mean log-
RPKM 2 4) transcripts. The numbers in the legend denote APs of the methods (equivalent to area under the curve). The circles indicate the cut-off log(BF) > 3.

for each group. Then, the variances for the gene and transcript
expression levels at the unreplicated time points are modeled by
smoothing the group variances as described in Section 2.6. We
use the modeled variances at the unreplicated time points if they
are larger than the BitSeq variances, and we use the BitSeq vari—
ances for each replicate at the ﬁrst time point.

Additionally, we compute the BitSeq variances for the relative tran—

script expression levels after applying the following transformations:

' Isometric log ratio transformation (ILRT): It is a popular transform—
ation which is used for transforming compositional data into linearly
independent components (Aitchison and Egozcue, 2005; Egozcue
et al., 2003). ILRT for a set of m proportions {171,172, . . . ,pm} is
applied by taking component wise logarithms and subtracting
the constant i2), log(pk) from each log—proportion component.
This results in the values q,- :log(p,)—%Zf:1log(pk) where

Zr log(qk) = 0.
' Isometric ratio transformation(IRT): Similar to the above transform—

ation, but without taking the logarithm, that is, q,- : 
13:1 k m

3 Results and Discussion

3.1 Comparison of variance estimation methods with
simulated data

Having simulated the RNA—seq data, we estimated the mean expres—
sion levels and variances from the samples generated by BitSeq
separately for each replicate at each time point. We evaluated our
GP—based ranking method with different variance estimation meth—
ods under the scenario where the replicates are not available at all
time points. As can be seen in Figure 2, using BitSeq variances in the
GP models in unreplicated scenario yields a higher AP than the naive
application of GP models without BitSeq variances. An L—shaped

Table 1 Numbers of nonDE and DE genes which have at least one
transcript belonging to the corresponding absolute-relative (abs-
rel) transcript groups

 

 

Gene
NonDE DE Sum
DE-DE 3 3 6 8 8 424
Transcript NonDE-DE 1 5 2 1 2 1 64
Abs-rel DE-nonDE 101 4 700 1 714
NonDE-nonDE 16 51 1 449 16 960
Sum 18 013 1249 19 262

 

The values in the table have been calculated by excluding the single—tran-
script genes, and only expressed transcripts have been taken into account, i.e.
transcripts which had at least 1 RPKM expression level at two consecutive
time points.

design with three replicates at the first time point and the mean—
dependent variance model increase the precision of the methods fur—
ther. In this model, we use the BitSeq samples of these replicates for
modeling the mean—dependent variances and we propagate the vari—
ances to the rest of the time series, and use these modeled variances
if they are larger than the BitSeq variances of the unreplicated meas—
urements. Comparison of the precision recall curves in Figure 2 indi—
cates that this approach leads to a higher AP for all settings. We also
observed that the modeled variances become more helpful for highly
expressed transcripts when overdispersion increases as can be seen
in Figure 3, in which the precision and recall were computed by con—
sidering only the transcripts with mean log expression of at least 4
log—RPKM. The figures also show the conventional log(BF) > 3 cut—
off. This highlights the fact that the naive model can be very anti—
conservative, leading to a large number of false positives.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pap1201umoq

9103 ‘0g anBnV uo ::

Different modes of short-term splicing regulation

i153

 

 

2.8

22

Expression (log-rpkm)
1.1 1.5 .
Expression (log-rpkm)

0.5

n

 

 

    
 
  
 

1.0

Frequency
0.4 0.6 0.8

I.
III

I l l I
320 0 5 20 80 320 1280

 

 

 

 

00 0i2
b—O—I

 

 

 

 

 

o 5 20 so 320 12so
Time (mins) Time (mins) Time (mins)
(a) Gene expression levels of (b) Absolute transcript (c) Relative transcript expres—

 

 

 

 

gene GRHLS. expression levels of gene sion levels of gene GRHLS.

log—BF: 9.86 GRHLS’. log—BFs: log—BFs:
GRHL3-008(blue): 1.26 GRHL3-008(blue): 0
GRHL3-201 (red): 6.05 GRHL3-201 (red): 0.50

E“. EN 

58 5g is

o 5 20 so 320 12so I o 5 20 so 320 12so o 5 20 so 320 12so
Time (mins) Time (mins) Time (mins)

(d) Gene expression levels of (e) Absolute transcript ex— (f) Relative transcript expres—

gene RH 062.

log—BF: 8.16 log—BFs:

RHO Q-OOJ (red): 0.56
RHO 62-006 (purple): 1.07
RHO Q-007(blue): 4.80

pression levels of gene RH 0Q. sion levels of gene RH 0Q. 10g—

BFs:

RHOQ-OOJ (red): 3.66
RHOQ-006(purple): 0.22
RHOQ-007(blue): 4.10

 

|
4

3.5

Expression (Iog- rpkm)
4 .4
Expression (Iog- rpkm)
3 .2

2.8

 

 

2.3

 

 

1.0

0.5 0.8

Frequency

0.0 0.2 0.4

 

 

 

I I I I I I I I I I
o 5 20 so 320 12so o 5 20
Time (mins)
(g) Gene expression levels of (h)
gene M TCHQ.
log—BF: 0.27

   

   

| l | | I I || | | | | | | I
80 320 1280 0 5 20 80 320 1280

Time (mins) Time (mins)

Absolute
expression levels of gene sion levels of gene M TCHQ.
MTCHQ. log—BFs:
MTCH2-001(red): 0.98
MTCH2-002(blue): 7.83
MTCH2-201 (purple): 1.64

transcript  Relative transcript expres—

log—BFs:

MTCH2-001 (red): 0
MTCH2-002 (blue): 6.56
MTCH2-201 (purple): 3.64

Fig. 4. GP profiles of three example genes and their transcripts. Error bars indicate :2 fixed-standard-deviation (square root of the fixed variances) intervals and
the colored regions indicate the :2 standard-deviation confidence regions for the predicted GP models. The transcripts are shown in the same color in absolute
(b,e,h) and relative (c,f,i) transcript—expression-level plots. Prior to GP modeling, time points were transformed by log(t + 5) transformation.

Figure 2 also shows results for fully two—way and three—way
replicated time series. Introducing the second replicate at each time
point improves the performance very significantly while the mar—
ginal benefit from the third replicate is much smaller. Introducing
the BitSeq variances increases the accuracy significantly for
transcript—level analyses, especially for transcript relative expression.

3.2 Comparison of feature transformation methods on
relative transcript expression levels with synthetic data
Transcript relative expression levels represent a special type of data
called compositional data because they always sum to 1 for each gene.
This property generates an artificial negative correlation between the
transcripts which can make analysis more challenging. Several

112 /810's1eumo_fpiogxo"soneuuogu1o1q/ﬁdm1 11101} papeo1umoq

9IOZ ‘OE ISUEHV Ho ::

i154

H. Topa and A.Honkela

 

transformation techniques have been recommended in the literature
for this task. ILRT is one of the most commonly used transformations
for breaking the linear dependency between the proportions.

We applied ILRT as well as its unlogged version (IRT) to the
relative transcript expression levels. Calculating the BitSeq variances
for the transformed values, we compared the performance of our
method with the performance when no transformation is applied.
As can be seen in Supplementary Figure 1, we observed that the fea—
ture transformations were not useful for increasing the performance
of our method. Therefore, we did not apply any transformation to
the relative expression levels in real data analysis. The reason for
their poor performance may be that the new transformation was
poorly compatible with our GP model and variance models.

3.3 Differential splicing in ER—oc signaling response
Encouraged by the good performance of the modeled variances and
especially their good control of false positives, we apply that method
for real data using the estrogen receptor—or (ER—or) signaling as a
model system using RNA—seq time series data from Honkela et al.
(2015) (accession GSE62789 in GEO).

The data set contains RNA—seq data obtained from MCF7 breast
cancer cell lines treated with estradiol at 10 different time points (0,
5, 10, 20, 40, 80, 160, 320, 640 and 1280 min). We treat the first
three time points as if they were the replicates measured at the same
time point to fit the variance model. This approach is reasonable be—
cause the system starts from a quiescent steady state and only very
little new transcription is expected to occur during the first 10 min.

We build our reference transcriptome from gencode.v19 by com—
bining the protein—coding cDNA sequences, long non—coding RNA
sequences and pre—mRNA sequences. The reference transcriptome
contains 34 608 genes and their 119 207 transcripts. We exclude
15 346 single—transcript genes from our transcript—level analyses.

The numbers of non—differentially expressed (nonDE) and DE
genes which have at least one transcript belonging to the corres—
ponding abs—rel (absolute—relative) transcript groups (DE—DE,
nonDE—DE, DE—nonDE, nonDE—nonDE) are given in Table 1. We
assumed that a transcript is expressed only if it has at least 1 RPKM
expression level at two consecutive time points, and we ignored the
unexpressed transcripts which do not satisfy this criterion in order
to avoid the noise originated from lowly expressed transcripts. We
call genes and transcripts DE in absolute expression levels if the GP—
smoothed fold change (the ratio of the maximum GP mean expres—
sion to the minimum GP mean expression) is at least 1.5, and the
log—Bayes factor is larger than 3. We set the same thresholds for the
relative transcript expression levels except for the fold change which
we replaced with the condition that the difference between the GP—
smoothed maximum and minimum proportions be larger than 0.1.

According to the table, ~11% of genes undergo either differen—
tial splicing or have DE transcripts. There is a significant number of
genes which are not called DE or differentially spliced, but have at
least one DE transcript. The model fits for these genes can be viewed
in the online model browser, which shows that many of these ex—
amples are probably due to lower sensitivity of relative expression
change detection. There are also many cases where the absolute ex—
pression signal of a single transcript appears very clean, but the
other transcripts mess up the gene and relative expression signals
making them appear more like noise.

3.4 Evidence for different modes of splicing regulation
The results in Table 1 suggest that different genes employ different
strategies for the regulation of splicing. This is confirmed by visual

observation of the model fits, available in the online model browser.
Illustrative examples of genes from the different classes are shown in
Figure 4.

The gene GRHL3 in the top row shows an example of a gene
where the relative proportions of the different transcripts remain
constant throughout the experiment even though the expression of
the gene changes. This appears to be a relatively common case. Even
using stringent criteria for no change in relative expression
(log—BF < 1) almost 450 genes follow this pattern.

The RHOQ and MTCHZ genes in the middle and bottom rows
show two slightly different interesting examples where the absolute
expression level of one of the transcripts remains constant while the
others change, suggesting highly sophisticated regulation of the indi—
vidual transcript expression levels. These are both examples of the
class with both differential relative and absolute expression which
covers more than 400 genes. The behavior of these genes is extremely
diverse and hard to categorize further, but by visual inspection one
can find many more examples where the gene and some of its tran—
scripts are changing whereas some expressed transcripts remain con—
stant, such as ARLZBP, RBICCI, HNRNPD, TBCEL, OSMR,
ESRI, ADCYI, PMPCB, AP006222.Z, EPSS, RAVERZ and P4HAZ.

4 Conclusion

In this article, we have presented a method for detecting temporal
changes in gene expression and splicing as well as transcript expres—
sion patterns that successfully incorporates uncertainty arising from
RNA—seq quantification in the analysis.

We evaluated the performance of our method under different ex—
periment designs in a simulation study. Our results again confirm
the importance of replication in genomic analyses. In our clean syn—
thetic data adding a second replicate gives a dramatic boost but im—
provements from having more than two replicates of the entire time
course are modest. Things may of course not be as simple for real
data where a third replicate could at least be very useful for detect—
ing corrupted and otherwise significantly diverging measurements
that could otherwise decrease the power.

We compared approaches based on noise variances inferred only
from the data and using posterior variance from BitSeq as a lower
bound on the noise for the GP. The BitSeq variances were found to be
very useful in unreplicated case as well as for transcript—level analyses.

We also experimented with a computational method for modeling
variances to fill in missing replicates with information propagated
from a single replicated time point. The results indicate that this
method can increase the accuracy of the analyses. However, in the
case of transcript relative expression there are still unsolved technical
challenges that may have a role in the performance. As the variance of
the relative transcript expression levels depends on the variances of
the overall gene expression levels and the absolute transcript expres—
sion levels as well as the covariance between them, which we did not
take into account here, it is not straightforward to model the variance
for the relative transcript expression levels and it would require more
powerful methods which would be suitable for compositional data.

Application of our method to the analysis of splicing patterns
during estrogen receptor signaling response in a human breast can—
cer cell line lead to the discovery of classes of genes with different
kinds of splicing and expression changes. We found several genes
for which the relative expression levels of different transcripts re—
main approximately constant whereas the total gene expression level
changes and for which the relative expression levels change appar—
ently independently of the total expression level, consistent with a

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pap1201umoq

9103 ‘0g anBnV uo ::

Different modes of short—term splicing regulation

i155

 

model of independent regulation of total expression level and rela—
tive splicing levels. There appears however to also be a potentially
more interesting set of genes where the absolute expression of some
transcripts remains constant whereas the expression level of others
changes. These examples suggest a link between regulation of gene
expression and splicing, but further research with careful controls is
needed to assess how common this phenomenon is. The finding
nevertheless suggests that alternative splicing analyses need to com—
bine both absolute and relative transcript expression analyses.

Acknowledgements

We thank Peter Glaus for providing his Python code for creating the FASTA
ﬁles in the simulation of RNA—seq reads. We also acknowledge the computa-
tional resources provided by the Aalto Science—IT project.

Funding

H.T. was supported by Alfred Kordelin Foundation, and AH. was supported
by the Academy of Finland [259440, 251170].

Conﬂict of Interest: none declared.

References

Aijo,T. et al. (2014) Methods for time series analysis of RNA—seq data with ap-
plication to human Th17 cell differentiation. Bioinformatics, 30, i113—i120.

Aitchison,J.J. and Egozcue,J. (2005) Compositional data analysis: where are
we and where should we be heading? Math. Geol., 37, 829—850.

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence
count data. Genome Biol., 11, R106.

Barash,Y. et al. (2010) Deciphering the splicing code. Nature, 465, 53—5 9.

Barrett,C.L. et al. (2015 ) Systematic transcriptome analysis reveals tumor—
speciﬁc isoforms for ovarian cancer diagnosis and therapy. Proc. Natl.
Acad. Sci. USA, 112, E3050—E305 7.

Cooper—Knock,J. et al. (2012) Gene expression proﬁling in human neurodege-
nerative disease. Nat. Rev. Neurol., 8, 518—530.
David,C.J. and Manley,J.L. (2010) Alternative pre-mRNA splicing regulation
in cancer: pathways and programs unhinged. Genes Dev., 24, 2343—2364.
Djebali,S. et al. (2012) Landscape of transcription in human cells. Nature,
489,101—108.

Egozcue,J. et al. (2003) Isometric logratio transformations for compositional
data analysis. Math. Geol., 35, 279—300.

Glaus,P. et al. (2012) Identifying differentially expressed transcripts from
RNA—seq data with biological variation. Bioinformatics, 28, 1721—1728.

Honkela,A. et al. (2015) Genome-wide modeling of transcription kinetics re—
veals patterns of RNA production delays. Proc. Natl. Acad. Sci. USA, 112,
13115—13120.

Janes,J. et al. (2015) A comparative study of RNA—seq analysis strategies.
BriefBioinform., 16, 932—940.

Jeffreys,H. (1961). Theory ofProhahility, 3rd edn. Oxford Classic Texts in the
Physical Sciences. Oxford University Press, Oxford.

Jiang,H. and Wong,W.H. (2009) Statistical inferences for isoform expression
in RNA-Seq. Bioinformatics, 25, 1026—1032.

Kalaitzis,A.A. and Lawrence,N.D. (2011) A simple approach to ranking dif-
ferentially expressed gene expression time courses through Gaussian process
regression. BMC Bioinformatics, 12, 180.

Kanitz,A. et al. (2015) Comparative assessment of methods for the computa-
tional inference of transcript isoform abundance from RNA—seq data.
Genome Biol., 16, 150.

Katz,Y. et al. (2010) Analysis and design of RNA sequencing experiments for
identifying isoform regulation. Nat. Methods, 7, 1009—1015.

Langmead,B. et al. (2009) Ultrafast and memory-efﬁcient alignment of short
DNA sequences to the human genome. Genome Biol., 10, R25.

Li,B. and Dewey,C.N. (2011) RSEM: accurate transcript quantiﬁcation from
RNA-Seq data with or without a reference genome. BMC Bioinformatics,
12,323.

Li,B. et al. (2010) RNA—Seq gene expression estimation with read mapping un—
certainty. Bioinformatics, 26, 493—500.

Luco,R.F. and Misteli,T. (2011) More than a splicing code: integrating the
role of RNA, chromatin and non-coding RNA in alternative splicing regula-
tion. Curr. Opin. Genet. Dev.,21, 366—372.

Luco,R.F. et al. (2010) Regulation of alternative splicing by histone modiﬁca—
tions. Science, 327, 996—1000.

Rasmussen,C.E. and Williams, C.K.I. (2006). Gaussian Processes for Machine
Learning. The MIT Press, Cambridge, MA.

Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for differential
expression analysis of digital gene expression data. Bioinformatics, 26,
139—140.

SEQC/MAQC—III Consortium (2014) A comprehensive assessment of RNA—
seq accuracy. Nat. Biotechnol., 32, 903—914. reproducibility and informa-
tion content by the Sequencing Quality Control Consortium.

Sultan,M. et al. (2008) A global View of gene activity and alternative
splicing by deep sequencing of the human transcriptome. Science, 321,
95 6—960.

Tilgner,H. et al. (2014) Deﬁning a personal, allele-speciﬁc, and single—
molecule long—read transcriptome. Proc. Natl. Acad. Sci. USA, 111,
9869—9874.

Topa,H. et al. (2015) Gaussian process test for high—throughput sequencing
time series: application to experimental evolution. Bioinformatics, 31,
1762—1770.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti—
ation. Nat. Biotechnol., 28, 511—515.

Wang,E.T. et al. (2008) Alternative isoform regulation in human tissue tran-
scriptomes. Nature, 456, 470—476.

Xiong,H.Y. et al. (2015) The human splicing code reveals new insights into
the genetic determinants of disease. Science, 347, 1254806.

112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pap1201umoq

9103 ‘0g isanV uo ::

