Bioinformatics, 32(16), 2016, 2556—2558

doi: 10.1093/bioinformatics/btw198

Advance Access Publication Date: 19 April 2016
Applications Note

 

Genetics and population analysis

TreeQTL: hierarchical error control for eQTL
findings
C. B. PetersonI, M. Bogomolovz, Y. Benjamini3 and C. Sabatti4'*

1Department of Health Research and Policy, Stanford University, Stanford, CA 94305, USA, 2Faculty of Industrial
Engineering and Management, Technion, Haifa 32000, Israel, 3Department of Statistics and Operations Research,
Tel Aviv University, Tel Aviv 6997801, Israel and 4Departments of Biomedical Data Science and Statistics, Stanford
University, Stanford, CA 94305, USA

*To whom correspondence should be addressed.
Associate Editor: Oliver Stegle

Received on August 6, 2015; revised on March 25,2016; accepted on April 10, 2016

Abstract

Summary: Commonly used multiplicity adjustments fail to control the error rate for reported find—
ings in many expression quantitative trait loci (eOTL) studies. TreeOTL implements a hierarchical
multiple testing procedure which allows control of appropriate error rates defined relative to a

 

grouping ofthe eOTL hypotheses.

Availability and Implementation: The R package TreeOTL is available for download at

http://bioi nfo rmatics.org/treeqtl.
Contact: sabatti@sta nford.ed u

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The goal of eQTL analysis is to gain insight into the genetic regula-
tion of gene expression. Typically, this is carried out by testing a
vast collection of hypotheses H,,g probing association between the
genotype at variant 1/ and the measured expression for gene g, where
1/ :1.....M.g :1.....G, M is on the order of hundreds of thou-
sands, and G of tens of thousands. Given the large number of
hypotheses tested, the need to adjust for multiplicity is universally
recognized and the false discovery rate (FDR) (Benjamini and
Hochberg, 1995) is typically adopted as the target global error rate.

In an effort to improve interpretability, reporting of results is
typically organized along more general findings such as the discov-
ery of genes subject to local regulation (eGenes) (Goring
et (11., 2007) or regulatory SNPs (eSNPs) (Nica et (11., 2010). The
adopted strategy for multiplicity adjustment needs then to offer
guarantees on these reported ‘global’ discoveries. For example, im-
agine testing the H,,g hypotheses using the BH rule (Benjamini and
Hochberg, 1995) and defining as an eSNP those variants 1/ for which
Hyg is rejected for at least some gene g. While this would control the
FDR among the Hyg rejections, it would not control any measure of
global error for the discovery of eSNPs, as shown by the simulations
in Peterson et al. (2016).

Researchers in the eQTL field have recognized this challenge,
and have additionally noted that since local regulation is more com-
mon than distal (Albert and Kruglyak, 2015), hypotheses probing
these two mechanisms should be tested separately. However, there
is no single standard in the literature for error rates targeted or
error-controlling strategies: for example, one finds the notion of per-
gene error rates (Nica et (11., 2010) or the application of Bonferroni
across genes (Zeller et (11., 2010) in local regulation, while for distal
effects significance cut-offs vary from 5 X 10’8 (Grundberg
et (11., 2012) to 5.78 x 10’12 (Zeller et (11., 2010). This makes com-
parison across studies and replicability challenging.

2 Approach

To overcome the confusion generated by the plurality of approaches
and to provide guarantees relative to the discoveries reported, it is
useful to recognize the structure among the hypotheses tested in an
eQTL study and to introduce some terminology. We distinguish be-
tween hypotheses testing local (when the distance between variant 1/
and gene g is less than a threshold) and distal regulation, indicating
them with Lyg and Dyg, respectively.

Further, we recognize that we might be interested mainly in iden-
tifying which genes appear to have local (distal) regulation prior to

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2556

/310‘Sjcumo[p10}xo‘soucuHOJIItotq/ﬁdnq

TreeQTL: hierarchical error control for eQTL

2557

 

obtaining a detailed list of the variants involved in this regulation;
or we might want to pinpoint SNPs that appear to have local (distal)
effects on multiple genes, even without committing to a comprehen—
sive list of these genes. We use the term ‘local eGene” to signify a
gene whose expression is influenced by some local DNA variants
and ‘local eSNP’ to designate a specific SNP associated to variability
in expression for some local genes. With ‘local eAssociation’ we sig—
nify the local association between one specific SNP and one specific
gene. For distal regulation, ‘distal eGene”, ‘distal eSNP’ and ‘distal
eAssociation’ are similarly defined. These terms can be mapped
back to the original collection of hypotheses noting, for example,
that discovering a distal eSNP is equivalent to rejecting the intersec—
tion hypothesis Dy. : ﬂgDVg, that is, the null stating that SNP U has
no effect on any distal gene g.

To control global error rates defined in terms of the reported dis—
coveries (local eSNPs, local eAssociations, etc.), we have imple—
mented in TreeQTL a multi—resolution approach based on results in
Benjamini and Bogomolov (2014) whose practical effectiveness in
GWAS has been described in Peterson et al. (2016). Furthermore,
TreeQTL has the potential to increase power: by focusing on the
promising SNPs with possibly higher proportions of true
eAssociations, one capitalizes on the adaptivity of FDR.

3 Methods

TreeQTL is a hierarchical testing procedure that distinguishes two levels
of discoveries within each class of local or distal regulation. In Level 1,
users can specify their primary interest as the identification of either
eGenes or eSNPs. Given this choice, all the pair—wise association hypoth—
eses are given a position in a tree similar to that shown in Figure 1: each
eGene or eSNP hypothesis indexes the collection of simple hypotheses
by whose intersection it is defined. Level 1 hypotheses are tested control—
ling for global errors within the two regulation classes. The more granu—
lar eAssociation hypotheses in Level 2 are tested only when they
correspond to a global hypothesis rejected in Level 1.

TreeQTL takes as input the P—values for each hypothesis in Level
2: these may be computed via Matrix eQTL (Shabalin, 2012) and
their validity is of crucial importance. Regardless of how the P—val—
ues were obtained, the input file for TreeQTL should follow the for—
mat used by Matrix eQTL, i.e. a tab—delimited file with columns
SNP, gene, beta, t—stat, p—value and FDR (note that the
fields beta, t—stat and FDR can be empty). The P—values for the
Level 1 hypotheses are computed using Simes’ rule (Simes, 1986) on
the families they index. This summary of the evidence for the global
null hypotheses is relatively robust to dependence (Benjamini and

A11 hypotheses

Level 0

(local V5 distal) Local regulauon Distal regulation

,//\ /'/\

Level 1

 

 

 

 

 

 

 

 

 

 

 

*
(local eGene, L.1 L.2 [ac D1. D2. DM.
distal eSNP) l j l l l l

L11 L12 {’16 D11 D21 DMI
Level 2 L21 L22 Lm D12 D22 DMZ
(eAssociation) : . . . ,

* .

Lm; 1 ngz LmGG ‘ I ‘

*
D191 D711: DMQM

 

 

 

 

 

 

 

 

Fig. 1. Organization of eQTL hypotheses in TreeQTL. Local regulation hypoth-
eses have been grouped by gene and distal regulation hypotheses are
grouped by SNP, so that Level 1 rejections will result in discoveries of local
eGenes and distal eSNPs. Tested hypotheses are colored in red, and rejected
hypotheses indicated with a star

Heller, 2008). Users can, however, input alternative P—values for
Level 1, such as those obtained via permutation.

Testing proceeds from Level 1, where three options are available:
controlling FDR at level q1 using BH or BY (Benjamini and
Yekutieli, 2001) or controlling the family—wise error rate via Bonferroni.

In Level 2, significance is established using a modified BH within
each set of eAssociation hypotheses corresponding to an eSNP or
eGene identified at Level 1, using a more stringent target FDR to ac—
count for selection. The expected average proportion of false discov—
eries across the selected Level 2 families is controlled to the user—
specified target level qz. (See Supplementary Material).

4 Example application

Purely to demonstrate feasibility, we applied TreeQTL to whole—
blood data from the pilot phase of the GTEx project (Ardlie
et 41., 2015): genotype data at 6 820 472 SNPs and expression levels
for 30 115 genes are available across 156 subjects. Local associations
correspond to SNP—gene pairs where the SNP is within 1 Mb of the
transcription start site (T55) of the gene; all other SNP—gene associ—
ations are considered distal. This definition results in approximately
142 million local tests (reﬂecting an average of 21 genes in the local
region for each SNP) and 205 billion distal tests. Following the steps
in Ardlie et al. (2015), P—values were obtained by applying Matrix
eQTL to normalized gene expression, adjusting for both known and
unknown technical covariates by the inclusion of gender, 3 genotype
principal components and 15 PEER factors. In applying TreeQTL, we
identified eSNPs as the discovery of interest in Level 1, choose the BH
procedure in level 1 and set q1 211220.01. This led to the discovery
of 136 609 local eSNPs (with 229 821 local eAssociations) and 164
860 distal eSNPs (with 216 933 distal eAssociations). This analysis
required around 2 h in R version 3.1.0 to complete. Note that because
of linkage disequilibrium, the number of eSNPs (and eAssociation)
discoveries is likely much larger than the number of true causal vari—
ants. A discussion of this point as well as an indicative comparison
with the analysis of these data published in Ardlie et al. (2015) is
included in the Supplementary Material.

5 Conclusion

By analyzing local and distal regulation separately, TreeQTL has less
stringent cut—offs for tests probing local effects, where it is expected
that a larger number of hypotheses will be non—null. By grouping
hypotheses relative to the same SNP or the same gene, TreeQTL capit—
alizes on the inherent heterogeneity of the problem. For example,
while few SNPs will act as distal regulators of expression and might
influence multiple genes, the vast majority of SNPs will not have such
an effect: testing all the eAssociation hypotheses relative to one SNP
together, separately from those concerning other loci, increases the
discovery of eSNPs with many associations, which may play a true
regulatory role, and reduces the discovery of SNPs with few associ—
ations, which are more likely to correspond to false positives. Finally,
the hierarchical structure of TreeQTL assures control of the FDR for
eSNP and eGene discoveries. While the current version of TreeQTL
implements methodology relative to studies involving only one tissue,
future releases will incorporate approaches for the more complex
structure of multi—tissue investigations.

Acknowledgements

The pilot release of the GTEx data (accession no. ph5000424.v3.p1) is avail-
able through dbGaP (http://www.ncbi.nlm.nih.gov/gap).

ﬁlO'SWHmOIpJOJXO'SOIJBIIIJOJIIIOTCV/Idnq

2558

C. B. Peterson et al.

 

Funding

This work was supported by the National Institutes of Health [MH101782 t0
C.P. and CS, HG006695 to CS. and Y.B.]; and the Israel Science
Foundation [1112/14 to 

Conﬂict of Interest: none declared.

References

Albert,F. and Kruglyak,L. (2015) The role of regulatory variation in complex
traits and disease. Nat. Rev. Genet, 16, 197—212.

Ardlie,K.G. et al. (2015) The Genotype-Tissue Expression (GTEX) pilot ana-
lysis: multitissue gene regulation in humans. Science, 8, 648—660.

Benjamini,Y. and Bogomolov,M. (2014) Selective inference on multiple fami-
lies of hypotheses. ]RSS B, 76, 297—318.

Benjamini,Y. and Heller,R. (2008) Screening for partial conjunction hypothe-
ses. Biometrics, 64, 1215—1222.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]RRS B, 57, 289—300.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Statist, 29, 1165—1188.

G6ring,H.H. et al. (2007) Discovery of expression QTLs using large-scale
transcriptional proﬁling in human lymphocytes. Nat. Genet, 39,
1208—1216.

Grundberg,E. et al. (2012) Mapping cis- and trans-regulatory effects across
multiple tissues in twins. Nat. Genet, 44, 1084—1089.

Nica,A.C. et al. (2010) Candidate causal regulatory effects by integration of
expression QTLs with complex trait genetic associations. PLOS Genet, 6,
e1000895.

Peterson,C.B. et al. (2016) Many phenotypes without many false discoveries:
error controlling strategies for multi-trait association studies. Genet.
Epidemiol., 40, 45—56.

Shabalin,A. (2012) Matrix eQTL: ultra fast eQTL analysis via large matrix op-
erations. Bioinformatics, 28, 1353—1358.

Simes,R. (1986) An improved Bonferroni procedure for multiple tests of sig-
niﬁcance. Biometrilza, 73, 751—754.

Zeller,T. et al. (2010) Genetics and beyond — the transcriptome of human
monocytes and disease susceptibility. PIOS One, 5, e10693.

/310'S[BHmOprOJXO'SOIJBLUJOJIIIOlq/ﬂduq

