APPLICATIONS NOTE V°" 335%.fégiiliiféiiZSSS/Zﬂg?

 

Data and text mining

Advance Access publication July 22, 2014

sapFinder: an R/Bioconductor package for detection of variant
peptides in shotgun proteomics experiments

Bo Wen”, Shaohang Xul'l, Gloria M. Sheynkmanz, Qiang Fengl'S, Liang Lin‘,

Quanhui Wang”, Xun Xu‘, Jun Wangl'e’j'6 and Siqi Liu1'4'*

1BGl-Shenzhen, Shenzhen 518083, China, 2Department of Chemistry, University of Wisconsin-Madison, Madison, WI
53706, USA, 3Department of Biology, University of Copenhagen, Copenhagen DK-2200, Denmark, 4Beijing Institute of

Genomics, Chinese Academy of Sciences, Beijing 100101, China, 5Princess Al Jawhara Albrahim Center of Excellence
in the Research of Hereditary Disorders, King Abdulaziz University, Jeddah 21589, Saudi Arabia and 6Macau University

of Science and Technology, Taipa, Macau 999078, China

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: Single nucleotide variations (SNVS) located within a reading
frame can result in single amino acid polymorphisms (SAPS), leading
to alteration of the corresponding amino acid sequence as well as
function of a protein. Accurate detection of SAPS is an important
issue in proteomic analysis at the experimental and bioinformatic
level. Herein, we present sapFinder, an R software package, for de-
tection of the variant peptides based on tandem maSS spectrometry
(MS/MS)-based proteomics data. This package automates the con-
Struction of variation-associated databases from public SNV reposi-
torieS or sample-Specific next-generation sequencing (NGS) data and
the identification of SAPS through database searching, post-process-
ing and generation of HTML-based report with visualized interface.
Availability and implementation: sapFinder iS implemented aS a
Bioconductor package in R. The package and the vignette can be
downloaded at http://bioconductor.org/packageS/devel/bioc/html/
sapFinder.html and are provided under a GPL-2 license.

Contact: Siqiliu@genomics.cn

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 5, 2014; revised on June 11, 2014; accepted on
June 16, 2014

1 INTRODUCTION

Recent advances in next-generation sequencing(NGS) technolo-
gies, such as whole-genome sequencing and total RNA sequen-
cing (RNA-Seq), have yielded large volumes of genetic variation
data (1000 Genomes Project Consortium, 2012; Peng et al.,
2012). Among these variations, single nucleotide variations
(SNVs) are recognized as one of the most common type of
genetic variants in human genome. The SNVs that are located
within protein-coding regions can cause the changes in the cor-
responding amino acids, which could result in change of protein
functions and further inﬂuence particular physiological or patho-
logical traits in individuals. Detection of the proteins containing

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

single amino acid polymorphisms (SAPs) derived from SNVs
provides valuable information in studying the functional signiﬁ-
cance of the genetic variations. Tandem mass spectrometry (MS/
MS)—based proteomics, especially shotgun proteomics, is a
powerful means to detect SAPs on a large scale (Sheynkman
et al., 2014; Wang et al., 2014). A common strategy for peptide
and protein identiﬁcation is database searching by comparing
experimental MS/MS spectra against theoretical mass spectra
derived from a reference protein sequence database; however,
this strategy fails to identify the varied amino acid sequences
that do not exist in the reference database. Several researchers
have addressed this problem by developing new searching
approaches. For instance, one approach is developed by
MASCOT by using error-tolerant searching (Creasy and
Cottrell, 2002) or by XlTandem by conducting the refinement
search (Craig and BeaVis, 2004). As this approach allows ex-
haustive test of all amino acid substitutions and greatly expands
search space, statistical signiﬁcance for the variant identiﬁcations
is not easily evaluated (Creasy and Cottrell, 2002). Another ap-
proach is based on the construction of a database that includes
SAPs found within SNVs or cancer mutation repositories, such
as dbSNP (Sherry et al., 2001), COSMIC (Forbes et al., 2011) or
sample-speciﬁc NGS data (Li et al., 2011; Sheynkman et al.,
2014; Wang et al., 2014). The SAPs are detected through MS
searches against the SAP-containing databases. A technical
bottleneck in this approach is how to effectively and conveniently
integrate diverse sources of sequence variation information into
an MS-searchable protein database. Wang et a]. developed
customProDB, an R package that generates customized data-
bases from RNA-Seq data or public SNV repositories (Wang
and Zhang, 2013). To deﬁne a SAP site, we could not only
depend on the variant peptide database but also need to search
the variant peptides based on MS/MS spectra. Unfortunately,
CustomProDB does not possess such function. SysPIMP is a
Web-based platform for identifying human disease-related
mutant sequences using XlTandem as the search engine 0(i
et al., 2009). SysPIMP collects human disease-related mutant
sequences from the Online Mendelian Inheritance in Man
(Hamosh et al., 2005), Protein Mutant Database (Kawabata
et al., 1999) and SwissProt database (Boeckmann et al., 2003);
however, it does not incorporate sample-speciﬁc NGS data,

 

3136 © The Author 2014. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOtJBLUJOJIItth”Zduq 11101} pQPBOIII/lAOG

9103 ‘Og anﬁnV uo ::

sapFinder

 

and its Web-based nature prevents analysis of large ﬁles and
scale-up.

Herein, we describe sapFinder, a program that can use data
from public repositories of genetic variants or sample-speciﬁc
NGS data to automate the generation of variant-containing
databases and thereby enable detection of SAP-containing
peptides. The program also allows for efﬁcient MS/MS data
searching, post-processing and report generation from HTML-
based format.

2 METHODS AND IMPLEMENTATION

As illustrated in Figure l, the workﬁow for identifying canonical
and variant peptides based on shotgun proteomics data is
broadly divided into four steps.

2.1 Construction of variation-associated database

sapFinder was used to construct a variation-associated database.
The inputs contained three ﬁles: a variant call format (V CF) file,
which was either generated from a Binary Alignment/Map
(BAM) ﬁle using SNV calling tools such as SAMtools (Li
et al., 2009) or the Genome Analysis Toolkit (McKenna et al.,
2010) or was directly downloaded from dbSNP or COSMIC; a
gene annotation ﬁle downloaded from the University of
California, Santa Cruz (UCSC) table browser; and a FASTA
format mRNA sequences ﬁle, which was also downloaded
from UCSC table browser. Based on the three ﬁles, SAPs at
the protein level were obtained by identifying SNVs and translat-
ing them into protein. Correspondingly, all possible tryptic pep-
tides derived from two possible missed cleavage sites and
including the SAP were extracted from the protein variations.
Only peptides with more than five amino acid residues were ac-
cepted. The FASTA headers for the peptides were prefixed with
‘VAR’ as to distinguish from canonical protein entries. The SAP-
containing sequences were appended to the reference protein se-
quences (FASTA format). In addition, reverse sequences were

   
     
 
 
 

Gennme neqneneing (wnnie
genome and cxmne) or RNA—
Seq am. VCF iiie

  
  
   
 
 
 
 

FDR cllculation, prolein
inference and spectrum

woman

   
   
 

H ML-hased
report generation

  

Post-processing

A vaﬁuﬁvn-mociated database nun
: ﬁle contained variant peptides
infnrmlﬁun

B C

 

Density
0.00 0.01 0.02 0.03 0.04

 

 

 

 

sapFinder(403) Sheynkman, el al., 2014(421) u 10

ElggﬂEviIIue) 4
Fig. 1. (A) Schematic overview of the sapFinder package. (B) A Venn
diagram illustrating the overlap of identiﬁed variant peptides between
sapFinder and Sheynkman et a]. study. (C) Search score distribution of
variant and canonical peptides

appended to the original forward sequences to act as decoys in
false discovery rate (FDR) estimation (Elias and Gygi, 2007).

2.2 MS/MS data searching

XlTandem can recognize the varied MS/MS data formats in
database searching, such as DTA, PKL or mgf (Craig and
BeaVis, 2004). In this article, rTANDEM, an R encapsulation
of XlTandem (Fournier et al., 2014), was adopted to search the
variation-associated databases against tandem mass spectra.
Alternatively, sapFinder also accepts Mascot dat file as input.

2.3 Post-processing

XlTandem Parser (Muth et al., 2010) was used to extract the
information of peptide and protein identiﬁcation from the
rTANDEM result. Taken into consideration the high FDR
risk for variant peptide identiﬁcation, a refined FDR estimation
approach for these identiﬁcations was used in our workﬁow (Li
et al., 2011). After PSMs ﬁltration based on a speciﬁed FDR
threshold, the Occam’s razor approach (Nesvizhskii et al., 2003)
was adopted to deal with degenerated canonical peptides, by
ﬁnding a minimum subset of proteins that are covered by all
of the identified canonical peptides, and to export two txt
format ﬁles containing the identification results of either peptides
or proteins.

2.4 HTML-based report generation

sapFinder outputs an HTML-based interactive report, which
contained quality control plots, annotated spectra and identiﬁ-
cation information of variant peptides and canonical peptides.

3 APPLICATION

To evaluate the utility of sapFinder, a published dataset was
processed using our pipeline (Sheynkman et al., 2014). MS/MS
spectra files and SNVs listed in the VCF file in the dataset, the
mRNA database and the gene annotation file downloaded from
UCSC table browser were treated as the input for sapFinder. We
used similar MS database search parameters as in the original
paper. The canonical and variant peptides were ﬁltered with a
threshold of 1% FDR. As shown in Figure 1B, 403 variant pep-
tides were identiﬁed and ~80% of them were also identiﬁed in
the original study, and a density distribution plot of their E—Value
distributions was compared in Figure 1C. As also found in the
Sheynkman et a]. paper, the distributions reveal that there is a
slight shift to higher score distributions for the variant peptides
as compared with that for canonical peptides, suggesting that the
variant peptide identifications as a group have a similar or lower
FDR as compared with the canonical peptide identifications.
The HTML-based report can be found in Supplementary
Data. These results demonstrate the utility of sapFinder in de-
tecting genetic variations at the protein level.

Funding: We acknowledge the support from the State Key Devel-
opment Program for Basic Research of Chinai973 Program (NO.
2010CB912703, 2013CB945204); the Program of International
S&T Cooperation (2014DFB30020); Guangdong Provincial
Engineering Laboratory for Proteomics; Shenzhen Key

 

3137

112 /310'S[BHJHOIPJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} popcorn/nag

9103 ‘Og isnﬁnV uo ::

B. Wen et al.

 

Laboratory of Transomics Biotechnologies (NO.CXB20110
8250096A); ShenZhen Engineering Laboratory for Proteomics.

Conﬂict of interest: none declared.

REFERENCES

Boeckmann,B. et al. (2003) The SWISS—PROT protein knowledgebase and its sup—
plement TrEMBL in 2003. Nucleic Acids Res., 31, 3657370.

Craig,R. and Beavis,R.C. (2004) TANDEM: matching proteins with tandem mass
spectra. Bioinformatics, 20, 146(rl467.

Creasy,D.M. and Cottrell,].S. (2002) Error tolerant searching of uninterpreted
tandem mass spectrometry data. Proteomics, 2, 142(rl434.

Elias,J.E. and Gygi,S.P. (2007) Target—decoy search strategy for increased conﬁ—
dence in large—scale protein identiﬁcations by mass spectrometry. Nat.
Methods, 4, 2077214.

Forbes,S.A. et al. (2011) COSMIC: mining complete cancer genomes in the
Catalogue of Somatic Mutations in Cancer. Nucleic Acids Res., 39, D9457D950.

Fournier,F. et al. (2014) rTANDEM, an R/Bioconductor package for MS/MS
protein identiﬁcation. Bioinformatics.

1000 Genomes Project Consortium. (2012) An integrated map of genetic variation
from 1,092 human genomes. Nature, 491, 56—65.

Hamosh,A. et al. (2005) Online Mendelian Inheritance in Man (OMIM), a knowl—
edgebase of human genes and genetic disorders. Nucleic Acids Res., 33,
D514eD517.

Kawabata,T. et al. (1999) The protein mutant database. Nucleic Acids Res., 27,
3557357.

Li,H. et al. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinformatics, 25, 207872079.

Li,J. et al. (2011) A bioinformatics workflow for variant peptide detection in shot—
gun proteomics. Mol. Cell. Proteomics, 10, M110 006536.

McKenna,A. et al. (2010) The Genome Analysis Toolkit: a MapReduce frame—
work for analyzing next—generation DNA sequencing data. Genome Res., 20,
129771303.

Muth,T. et al. (2010) XTandem Parser: an open—source library to parse and analyse
XlTandem MS/MS search results. Proteomics, 10, 152271524.

Nesvizhskii,A.I. et al. (2003) A statistical model for identifying proteins by tandem
mass spectrometry. Anal. Chem, 75, 4646—4658.

Peng,Z. et al. (2012) Comprehensive analysis of RNA—Seq data reveals
extensive RNA editing in a human transcriptome. Nat. Biotechnol, 30,
2537260.

Sherry,S.T. et al. (2001) dbSNP: the NCBI database of genetic variation. Nucleic
Acids Res., 29, 3087311.

Sheynkman,G.M. et al. (2014) Large—scale mass spectrometric detection of variant
peptides resulting from nonsynonyrnous nucleotide differences. J. Proteome
Res., 13, 2287240.

Wang,Q. et al. (2014) Omics evidence: single nucleotide variants trans—
missions on chromosome 20 in liver cancer cell lines. J. Proteome Res., 13,
20(P211.

Wang,X. and Zhang,B. (2013) customProDB: an R package to generate customized
protein databases from RNA—Seq data for proteomics search. Bioinformatics,
29, 323573237.

Xi,H. et al. (2009) SysPIMP: the web—based systematical platform for identifying
human disease—related mutated sequences from mass spectrometry. Nucleic
Acids Res., 37, D91}D920.

 

3138

112 /310'S[BIIJDOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papBo1u/noq

9103 ‘0g isnﬁnV uo ::

