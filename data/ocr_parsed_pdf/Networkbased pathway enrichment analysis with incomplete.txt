Bioinformatics, 2016, 1—10
doi:10.1093/bioinformatics/btw410

Advance Access Publication Date: 29 June 2016
Original Paper

 

Systems biology

Network-based pathway enrichment analysis
with incomplete network information
Jing Ma,1'* Ali Shojaie2 and George Michailidis3

1Department of Biostatistics and Epidemiology, University of Pennsylvania Perelman School of Medicine, PA
19104, USA, 2Department of Biostatistics, University of Washington, Seattle, WA 98915, USA and 3Department of
Statistics, University of Florida, Gainesville, FL 32611, USA

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on January 22, 2016; revised on June 21, 2016; accepted on June 22,2016

Abstract

Motivation: Pathway enrichment analysis has become a key tool for biomedical researchers to
gain insight into the underlying biology of differentially expressed genes, proteins and metabolites.
It reduces complexity and provides a system—level view of changes in cellular activity in response
to treatments and/or in disease states. Methods that use existing pathway network information
have been shown to outperform simpler methods that only take into account pathway member—
ship. However, despite significant progress in understanding the association amongst members of
biological pathways, and expansion of data bases containing information about interactions of bio—
molecules, the existing network information may be incomplete or inaccurate and is not cell—type
or disease condition—specific.

Results: We propose a constrained network estimation framework that combines network estima—
tion based on cell— and condition—specific high—dimensional Omics data with interaction informa—
tion from existing data bases. The resulting pathway topology information is subsequently used to
provide a framework for simultaneous testing of differences in expression levels of pathway mem—
bers, as well as their interactions. We study the asymptotic properties ofthe proposed network esti—
mator and the test for pathway enrichment, and investigate its small sample performance in simu—
lated and real data settings.

Availability and Implementation: The proposed method has been implemented in the R—package
netgsa available on CRAN.

Supplementary information: Supplementary data are available at Bioinformatics online.

Contact: jinma@upenn.edu

 

1 Introduction

 

Recent advances in high-throughput technologies have transformed
biomedical research by enabling comprehensive monitoring of com-
plex biological systems. By profiling the activity of different molecu-
lar compartments (genomic, proteomic, metabolomic), one can
delineate complex mechanisms that play key roles in biological
processes or the development of distinct phenotypes. These techno-
logical advances have thus motivated new methodological develop-
ments, most notably the adaptation of systems perspectives to

analyze biological systems. Pathway analysis represents a key

component in the analysis process and has been used successfully in
generating new biological hypotheses, as well as in determining
whether specific pathways are associated with particular pheno-
types. Examples include analysis of pathways involved in initiation
and progression of cancer and other complex diseases (Wilson et (11.,
2010), discovering novel transcriptional effects and co-regulated
genes (Green et (11., 2011), and understanding the basic biological
processes in model organisms (Gottwein et (11., 2007; Houstis et (11.,
2006). See Huang et al. (2008) for additional examples of

applications.

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

J.Ma et al.

 

Pathway analysis methods have evolved since the seminal work
by Subramanian et al. (2005 ). As pointed out in the review article by
Khatri et al. (2012), earlier techniques such as over—representation
analysis (Al-Shahrour et al., 2005), and gene set analysis (GSA)
(Efron and Tibshirani, 2007; Subramanian et al., 2005) treat each
pathway as a set of biomolecules. These methods assess whether
members of a given pathway have higher than expected levels of ac—
tivity, either by counting the number of differentially active mem—
bers, or by also accounting for the relative rankings of pathway
members and/or the magnitude of their associations with the pheno—
type. On the other hand, more recent and statistically powerful
methods also account for interactions between biomolecules. These
interactions are increasingly available from carefully curated biolo—
gical databases, such as Kyoto Encyclopedia of Genes and Genomes
(KEGG, Kanehisa and Goto, 2000), Reactome (Joshi-Tope et al.,
2003), RegulonDB (Huerta et al., 1998) and BioCarta (Nishimura,
2001).

A network topology—based method that exhibits superior statis—
tical power in identifying differential activity of pathways was pro—
posed in Shojaie and Michailidis (2009, 2010). The Network—based
Gene Set Analysis (NetGSA) method also allows testing for potential
changes in the network structure under different experimental or
disease conditions. However, it requires a priori knowledge of inter—
actions among pathway members, which, despite rapid progress, re—
mains highly incomplete and occasionally unreliable (see e.g. Zaki
et al., 2013 and references therein). Moreover, existing network in—
formation often determine molecular interactions in the normal
state of the cell, and do not provide any insight into condition/
disease—specific alterations in interactions amongst components of
biological systems.

The increased availability of large sets of high—dimensional
Omics data [e.g. from The Cancer Genome Atlas (TCGA), http://can
cergenome.nih.gov/], coupled with the development of network esti—
mation techniques based on graphical models (Lauritzen, 1996)
offers the possibility to validate and complement existing network
information, and to obtain condition—specific estimates of molecular
interactions. Such an approach for leveraging existing knowledge to
enhance the analysis of low signal—to—noise biological datasets was
advocated in Ideker et al. (2011).

The first contribution of this article is the development of a
method for constrained network estimation from high—dimensional
data, together with establishing the consistency of the resulting esti—
mate. Estimation of high—dimensional networks subject to hard (or
soft) constraints on conditional dependence relationships amongst
random variables represents a canonical problem in the context of
graphical models, and the proposed method for addressing this
problem is of independent interest. By incorporating the condition—
specific network estimates from the proposed method into the
NetGSA framework, we also provide a rigorous statistical frame—
work for assessing alterations in biological pathways, referred to as
differential network biology (Ideker and Krogan, 2012).

The proposed framework accounts for two sources of uncer—
tainty: the first concerns the reliability of the external information
used for constructing the network estimate from data. The second is
the variability of the network estimate, which can impact the path—
way enrichment testing procedure. We establish that, under certain
regularity conditions, consistent estimates of the network can be ob—
tained, leading, in turn, to an asymptotically most power unbiased
test for pathway enrichment analysis. Our theoretical analysis also
sheds light into the potential improvements in accuracy and power
by directly accounting for the amount of reliable external network
information.

A second objective of this study is to scale up the NetGSA esti—
mation algorithm to very large size networks. The main bottleneck
in applying the NetGSA methodology arises from the estimation of
mixed effects linear parameters—specifically the variance compo—
nents—for thousands of variables. We develop efficient and stable
computational methods for estimation of these parameters based on
a profile likelihood approach. In particular, we employ a Cholesky
factorization of the covariance matrices to speed up matrix inver—
sions, and use it to develop a stable algorithm based on Newton’s
method with backtracking line search (Boyd and Vandenberghe,
2004: 487) for step size selection. To supply reliable starting points
for this algorithm, we further develop an approximate method—0f—
moment—type estimator.

The proposed methods are illustrated on both metabolomics and
gene expression data. For mass spectrometry metabolomics profiling
one can obtain good quality measurements for a few hundred me—
tabolites that do not provide complete coverage of the underlying
biochemical pathways. The small number of metabolites in each
pathway and the incomplete coverage of the metabolites particularly
hinder the application of over—representation and GSA methods in
this setting. In our experience, only topology—based pathway enrich—
ment analysis methods, such as NetGSA, are capable of reliably
delineating pathway activity, as illustrated in Section 4. Further, our
investigation of previously analyzed gene expression data set on
lung and breast cancer provides new useful insights.

The remainder of the article is organized as follows. Section 2.1
presents the new method for network estimation under external in—
formation constraints and establishes its consistency. Section 2.2
outlines the new computational algorithm for scaling up NetGSA,
as well as the inference procedure for both pathway enrichment and
differential network analysis. The performance of the developed
methodology is evaluated in Section 3 and is examined on real data
sets in Section 4.

2 Methods

Gaussian graphical models (Lauritzen, 1996, Chapter 5) are widely
used in biological applications to model the interactions among
components of biological systems (Dehmer and Emmert—Streib,
2008, Chapter 6). Specifically, partial correlation networks are com—
monly used to model interactions in molecular networks; these net—
works are represented by an undirected graph G : (V,E) with node
set V and edge set E corresponding to biomolecules interactions
among them, respectively. The edge set E corresponds to the p>< p
precision, or inverse covariance, matrix Q, whose nonzero elements
wig refer to edges between nodes i and i’, and indicate that i and i’
are conditionally dependent given all other nodes in the network.
The magnitude of the partial correlation Aiil : —wiil / deter—
mines the strength (positive or negative) of the conditional associ—
ation between the respective nodes. In the sequel, the matrix A will
also be called the weighted adjacency matrix, with Ah: being the as—
sociation weight between i and i’.

2.1 Network estimation under external information
constraints

As discussed in Section 1, the availability of large collections of sam—
ples for different disease states and biological processes together
with carefully curated information of biomolecular interactions en—
ables the estimation of network structures within the setting of
Gaussian graphical models. However, the availability of external
network information provides a novel and unexplored modification

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

Network—based path way enrichment analysis

 

of the corresponding network estimation problem. Denote by Ec the
set of node pairs not connected in the network, i.e. wig : 0. Then,
the external information can be represented by the following two
subsets

E1 : {(11) e E : i 55 i’.w,~,v 5A 0},
E0 2 {(11) e E5 : 115511.60“! : 0}.

In words, E1 contains known edges, while E0 contains node pairs
where it is known that no interaction exists between them. Note
that E1 Q E and E0 Q EC. The external information available in E1
does not imply exact knowledge of the magnitude of wig nor Aiil.

Suppose we observe an m X 17 data matrix Z : (Z1, . . . ,Zp),
where each row represents one sample from a p—variate Gaussian
distribution N(0.Q_1) for a given biological condition (e.g. cancer
or normal). Our goal is then to estimate the network structure, or
equivalently the precision matrix Q, subject to external information
encoded in E1 and E0. Let D : diag(Q) represent the diagonal ma—
trix whose diagonal entries are the same as Q and 1,, be the p—identity
matrix. Then, A : 1,, — D_1/2QD_1/2 is the partial correlation ma—
trix. When E1 : E and E0 : E, the problem becomes that of covari—
ance selection (Dempster, 1972), which has been studied extensively
in the literature. However, to the best of our knowledge, the prob—
lem of estimating Q (and the partial correlation matrix A) when
E1 and E0 only contain partial information (ElgE and EOQE‘) has
not been investigated before.

In this section, we assume that the m observations used for esti—
mating condition—specific networks are separate from those used for
pathway enrichment analysis (highlighted by the use of Zi’s and m
to denote the random variables and sample size, respectively). The
framework introduced in this section reduces the potential bias in
small sample settings, and takes advantage of the additional publicly
available samples, in lieu of reliable network information. With
large enough samples, network estimation and pathway enrichment
can be performed using the same set of samples by incorporating
sample splitting strategies. Although the problem considered in this
section is seemingly similar to matrix completion (Candes and
Recht, 2009), the two problems are fundamentally different in na—
ture. In particular, in this setting, matrix completion corresponds to
completing the remaining entries from the partially observed p X 17
matrix A, under some structural assumptions on A, such as low—
rankness. On the other hand, in the setting of graphical models, the
entries of the weighted adjacency matrix are estimated based on
data on the nodes of the graph.

In biological settings, both the structure of the network, as well as
strengths of associations may be condition—specific. Therefore, we
need to accurately estimate the nonzero entries in Q to recover both
the structure of the network and the strength of associations between
nodes. In the absence of any external information, the Zl—penalized
negative log—likelihood estimate of Q is obtained by solving

argmin {trace(QE) — logdetQ + A) )Q))1 }, (1)

Q>U

wherein E : ZTZ/m is the empirical covariance matrix of the data,
HQH1 : Egg-I (wig) denotes the Z1 norm of the parameters, and /l is
the regularization parameter. In the presence of external informa—
tion, the problem can be cast as the following constrained optimiza—
tion one
gluon {trace(QE) —logdetQ}, (2)
subject to com : 0 for (i.i’) E E0. wig 9E 0 for (i.i’) E E1, and
2w. (i.i’)¢E0UE1wii’l S t-

In the following, we present a two—step procedure to solve the
constrained optimization problem (2). The proposed approach
combines the neighborhood selection technique (Meinshausen and
Biihlmann, 2006) with constrained maximum likelihood estima—
tion. It exploits the fact that the estimated neighbors of each node
using neighborhood selection coincide with the nonzero entries of
the inverse covariance matrix (Friedman et al., 2008). Specifically,
in neighborhood selection the network structure is estimated by
finding the optimal set of predictors when regressing the random
variable Z, corresponding to node ie V on all other variables,
using an 11—penalized linear regression. The coefficients for this 0p—
timal prediction l9i are closely related to the entries of the inverse
covariance matrix: for all i’ 9E i, 0;, : —w,~,~:/w,~,~. The set of nonzero
coefficients of l9i is thus the same as the set of nonzero entries in
the row vector of com (i’ 9E i), which defines the set of neighbors of
node i.

Let ] and [6 denote the subsets V\i for which external information
is available: ["1 is the set of nodes which are known to be in the neigh—
borhood of i, and [6 is the set of nodes which are known to be not con—
nected to i. Let 2., denote the submatrix obtained by removing the ith
column of Z. Assume all columns of Z are centered and scaled to have
norm 1. Denote by Si the set of all p X 17 positive definite matrices and
811;: {Q 6 IRpo : wig : 0, for all (i,i’) g E where iyé i’}. The pro—
posed algorithm proceeds in two steps.

i. Estimate the network structure E. For every node i, ﬁnd 01 via
the following steps. .
a. For i’ E [6, set air: 0.
b. For i’ E  ﬁnd  using linear regression

Ai . 1
0].] : argminEHZ,‘ — 21.10)); (3)

QERll‘ll

c. For i’ EjE V\{j’i1 U16 U {i}}, ﬁnd  using lasso

i , 1 -
0; = argmlngllwi — 21011: + 212101-11. (4)
(JEle i’E]

where W,- : Z,- — 2111f)er is the residual vector after regressing
Z,- on the known connections. . .
The edge set E is estimated to be {(i. i’) : 9E 0 OR  9E 0}.
ii. Given the structure E, estimate the inverse covariance matrix Q

by

Q : argmin {trace(iQ) — logdetQ}. (5)
Resins?

Remark 1. In step (i—b) of the algorithm, the coefficients l9i for
known edges have not been penalized in (3). In settings where the
external information may be unreliable, we can augment (3) with a
lasso penalty 22,-.6111 ti: )0; l, where the penalty weights til (i’ E 
allow for different penalization depending on the reliability of exist—
ing information.

The second step focuses on estimation of the magnitude of non—
zero entries in the precision matrix Q, given the estimated network
topology  The optimization problems in both steps are convex
and can be solved efficiently using existing software (e.g. glmnet and
glasso in R).

The proposed estimator enjoys nice theoretical properties under
certain regularity conditions. Before presenting the main result,
we introduce some additional notations. Let 20 be the true c0—
variance matrix and Q0 : 261. For i : 1. . . . .1), denote by (WHO : #
{i’: 0;, 9E 0} the [0 norm of 0'. Write szmaxi:1wp ((Billo and

ﬁm'spzumol‘pmyo'sopeuuowtotq/ﬁdnq

J.Ma et al.

 

So : 2L1 ((Billo. For a subset] C {1. . . . .p}, let Z] be the submatrix
obtained by removing the columns whose indices are not in ]. We
make the following assumptions.

Assumption 1. There exist (b1, (p2 > 0 such that the eigenvalues of
20 are bounded, i.e. 0 < d); S (pmin(20) g (pmx(20) 3 1M), < oo.

Assumption 2. There exists Ic(s) > 0 such that

mm 11mm;
lllﬁ «Sew M11611), _
115/111 < 31151111

 

16(5). (6)

Assumption 1 is standard in high—dimensional settings.
Assumption 2 corresponds to the restricted eigenvalue assumption
introduced in Bickel et al. (2009), which is presented here for
completeness.

Denote by  the cardinality of the edge set E. Let r E ()Eo) + )
E1 /{p(p — 1) / 2} represent the percentage of external network in—
formation available. Clearly, 0 S r < 1. We are now ready to state
our first result.

Theorem 1. Suppose Assumption 1 holds and Assumption 2 is sat—
isfied with rc(2s). For constants c1 > 4 and 0 < k1 < 1, assume
also that the sample size satisfies

1661 2
m 2 {W} (1 ‘ r>Solog(z> — r17), (7)

where S0 is the total number of nonzero parameters excluding the di-
agonal. Consider Q defined in (5). Then, with probability at least
1 — 2p2_‘i/8, under appropriately chosen /l, we have

A A $1 —
n—oozsn—QOF—o( lﬂﬂllﬂ) (a

m

Remark 2. In addition to the improved sample complexity (7), the
convergence rate in (8) indicates an improvement of the order of

Solog(1 — r)_1/m in the presence of external information. This
improvement is particularly important for our analysis of power
properties of NetGSA in Section 2.2.2, which requires norm consist—
ency of adjacency matrix estimation. Although consistency can be
established using a theoretical analysis similar to graphical lasso
(Rothman et al., 2008), our proofs in the Supplementary Materials
Section A utilize the techniques from Bickel et al. (2009) and Zhou
et al. (2011) to characterize the improvement in rates resulting from
the external information.

Let A0 be the true partial correlation matrix, i.e.
A0 : 1,, — Dgl/ZQngl/Z, where Do : diag(Qo). The following cor—
ollary is an immediate result of Theorem 1.

Corollary 1. Let assumptions in Theorem 1 be satisfied. Assume
further that So : o(m/log(p — rp)). For Q defined in (5), let A be
the corresponding partial correlation matrix. Then, with probability
at least 1 — 2p2_‘i/8, under appropriately chosen /l, we have

HK—Aw22d0-

Remark 3. Corollary 1 implies that, under certain regularity con—
ditions, the error in the condition—specific network estimate A is
negligible. This proves essential for establishing power properties of
NetGSA with estimated network information, as shown in the next
section. The proof of Corollary 1 is available in the Supplementary
Materials Section A.

The tuning parameter /l in the first step of the proposed algo—
rithm is important for selecting the correct structure of the network,
which further affects the magnitude of the network interactions in
the second step. Accurate estimation of these magnitudes is crucial
for topology—based pathway enrichment methods. We propose to se—
lect /l using the Bayesian Information Criterion (BIC). Specifically,
for a given 2, we define

BIC(/l) : trace(EQg) — logdet(Qg) +@ (E). (9)

where Q ,1 is the estimated precision matrix from the data and E ,1 is
the estimated edge set. The optimal tuning parameter is thus
2* : argmin/:BICUL).

2.2 NetGSA with estimated network information

Next, we discuss how (condition—specific) estimates of bimolecular
interactions from Section 2.1 can be incorporated into the NetGSA
framework to obtain a rigorous inference procedure for both path—
way enrichment and differential network analysis. To this end, we
formally define the NetGSA methodology based on undirected
Gaussian graphical models in Section 2.2.1. In Section 2.2.2, we dis—
cuss how the constrained—network estimation procedure of Section
2.1 can be combined with NetGSA to rigorously infer differential
activities of biological pathways, as well as changes in their network
structures.

2.2.1 The latent variable model
Consider p genes (proteins/metabolites) whose activity levels across
n samples are organized in a p X n matrix D. In the framework of
NetGSA, the effect of genes (proteins/metabolites) in the network is
captured using a latent variable model (Shojaie and Michailidis,
2009, 2010). Denote by Y an arbitrary column of the data matrix
D. Suppose the observed data can be decomposed into signal, X,
plus noise e N N,,(0. c731,), i.e. Y : X + e. The latent variable model
assumes that the signal X follows a multivariate normal distribution
with partial correlation matrix A. Based on the connection between
linear recursive equations and covariance selection proposed in
Wermuth (1980), there exists a lower triangular matrix A such that
A_1X : y, where y N N,,(/1. c731,) and AAT : (1,, — A)_1. Note that
the current version of the NetGSA model differs from the original
model in Shojaie and Michailidis (2009, 2010). This difference is
primarily manifested through the definition of A in the two models:
A is defined here based on the undirected partial correlation net-
work A, whereas it was previously defined based on directed (phys—
ical) interactions among genes (proteins/metabolites) in Shojaie and
Michailidis (2009, 2010).

Assuming that y and e are independent, the NetGSA model can
then be summarized as

Y:Ay+e. (10)

The NetGSA methodology allows for more complex models,
including time course observations. For expositional clarity, we pre—
sent the methodology in the setting of two experimental conditions
and consider the general case Where Am 9E Am. Details of NetGSA
under multiple conditions can be found in Shojaie and Michailidis
(2010) and are applicable for the undirected networks presented in
this work. Let Y/W (/ : 1, . . . ,n;k : 1,2) be the /—th sample in the
expression data under condition k (ith column of data matrix D),
with the first n1 columns of 1) corresponding to condition 1 (control)
and the remaining n2 : n — n1 columns to condition 2 (treatment).

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

Network—based path way enrichment analysis

 

Denote by AW the influence matrix and 11”“ the mean vector under
condition k. The NetGSA framework considers a latent variable
model of the form

Y)“ = A(1)II(1)+A(1)7;+8;, (/ 2 1,---,n1),
Y/(2) : A(2)”(2) +A(2).yj +8].7  2 "1+ 17___7n)_

Here, y,- is the vector of (unknown) random effects, and e, is the
vector of random errors. They are independent and normally distrib—
uted with mean 0 and variances c731,, and 031,” respectively.

Inference in NetGSA requires estimation of the mean parameters
[1(1) and [1(2) and variance components a; and 03. The variance com—
ponents can be estimated via maximum likelihood or restricted max—
imum likelihood, which can be computationally demanding for
large networks. To extend the applicability of the NetGSA, we con—
sider using Newton’s method for estimating the variance parameters
based on the profile log—likelihood to improve the computational
stability. See Supplementary Materials Section B for more details.

2.2.2 Joint pathway enrichment and differential network analysis
using N etGSA

To test for enrichment of a pre—specified pathway P, Shojaie and
Michailidis (2009) propose the contrast vector (Searle, 1971)
l : (—bA(1) ©b,bA(2) (Db), where b is a row binary vector deter—
mining the membership of genes in a pre—specified pathway P and 0
denotes the Hadamard product. The advantage of this contrast vec—
tor is that it isolates influences from nodes outside the pathways of
interest. Let If : (,umT, pal-[)1- be the concatenated vector of means.
The null hypothesis of no pathway activity vs the alternative of
pathway activation then becomes

Hozlﬂzo, H1;r/;;e0. (11)

The significance of individual contrast vectors in (11) can be
tested using the following Wald test statistic

ii

TS : —1,
SEW)

(12)

where SEQ/A?) represents the standard error of if? and f? is the esti—
mate of If. Both 2 and SEQ/A?) depend on the underlying networks,
which are estimated using data from the two experimental condi—
tions. Under the null hypothesis, TS follows approximately a t—dis—
tribution whose degrees of freedom can be estimated using the
Satterthwaite approximation method (Shojaie and Michailidis,
2010).

The above general framework allows for test of pathway enrich—
ment in arbitrary subnetworks, while automatically adjusting for
overlap among pathways. In addition, the above choice of contrast
vector 2 accommodates changes in the network structure. Such
changes have been found to play a significant role in development
and initiation of complex diseases (Chuang et al., 2012), and
NetGSA is currently the only method that systematically combines
the changes in expression levels and network structures, when test—
ing for pathway enrichment. However, the applicability of the exist—
ing NetGSA framework (Shojaie and Michailidis, 2009, 2010) is
limited by the assumption of known network structure (namely
A(k),k : 1, 2). In the current framework, we estimate AM (k : 1, 2)
from data as discussed in Section 2.1. We next show that NetGSA
with estimated network information provides valid inference for
pathway enrichment and differential network analysis.

For 13:1, 2, let ZOE) of dimension mk X p be the data matrix
used to separately estimate the partial correlation matrix under

condition k. Denote by St the number of nonzero off—diagonal
entries in the true partial correlation matrix Al,“ and by rk the per—
centage of available external information. We obtain the following
result.

Theorem 2. Let assumptions in Theorem 1 be satisfied and S, : o
(mk/log(p — rkp)) under each kcondition k (k : 1,2). Consider the
inverse covariance matrices Q estimated from (5) of Section 2.1.
Then the test statistic in (12) based on the corresponding networks
A is an asymptotically most powerful unbiased test for (11).

Remark 4. Theorem 2.1 of Shojaie and Michailidis (2010) says
that NetGSA is robust to uncertainty in network information.
Specifically, Shojaie and Michai(llidis (2010) show that if the error in
network information AA? : A — Alf) satisfies HAAEAHZ : onm(1),
then NetGSA is an asymptotically most powerful unbiased test for
(1 1). The result in Theorem 2 establishes this property for (partially)
estimated networks using the consistency of our proposed network
estimation procedure in Theorem 1 and Corollary 1. A detailed
proof can be found in the Supplementary Materials Section A.

3 Simulation results

We present two simulation studies to assess the performance of the
proposed network estimation procedure, as well as its impact on
NetGSA. We refer readers to the Supplementary Materials Section C
for additional simulation scenarios—including validation of Type 1
errors and settings with a large number of variables p—and subse—
quent discussion.

Our first experiment is based on an undirected network of size
p2100. The network structure is extracted from the DREAM3
challenge (Prill et al., 2010) corresponding to the Ecoli network
(labeled Ecoli 1). The pathways of interest are determined through a
community detection algorithm based on the leading nonnegative
eigenvector of the modularity matrix of the network (Csardi and
Nepusz, 2006). Under the null hypothesis, all nodes have the same
mean expression values of 1. Under the alternative hypothesis, the
mean expression levels of 0%, 30%, 40% and 60% of nodes in sub—
networks 1, 3, 5 and 7 are increased by 0.5, respectively.

Our second experiment considers a network of size p : 160 with
8 subnetworks of equal sizes, all of which are generated from the
same scale—free graph of size 20. To allow for interactions across
subnetworks, there is 20% chance for the hub node in each subnet—
work to connect to the hub node in another subnetwork. Mean ex—
pression values for all nodes are the same under the null hypothesis.
Under the alternative hypothesis, we allow, respectively, 0, 40, 60
and 80% of the nodes to have positive mean changes of magnitude
0.5 for subnetworks 1—4. Subnetworks 5—8 follow the same pattern.

In both experiments, we also allow the structures in four subnet—
works under the alternative hypothesis to differ from their null
equivalent by a small amount, in order to simultaneously test path—
way enrichment and differential networks. Figure 1 shows the net—
work topologies as well as the structural changes for the chosen
subnetworks from the null to the alternative hypothesis in the two
experiments. Further, we study the robustness of NetGSA to model
misspecification by including scenarios where a proportion (50%
for r : 0.2 and 20% for r: 0.8 in experiment 1, and 60% in experi—
ment 2) of the supplied structural information is incorrectly speci—
fied, i.e. they are not present in the true model.

To illustrate how external network information affects the esti—
mation accuracy, we vary the percentage of information r from 0 to
1. When r is less than 1, we estimate the adjacency matrices using

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

I I
.0 I.
II. I . II' I .
.l . . I' I I
.‘ . I.... .i . I..I.
r. . ‘. :I. c '-
5 . I I .- . l I
I I
I I
I I
I. . .. I . '. I II ' I
'. ’Iu' '. '-u'
I I
I I
O. O .. O
I I.. I II.
0.. . 0 , . .... 'I' . ° 0 I .II-
I I I . 0 I . . I I I I 0 I . I
I I .I I . . I I .I I I .
I I
' o. . I I ' I. . I I
. .0. - I'-
‘c' l.o
0. II
.. .I
I . . I
I I
II '."‘ ..IOO. '. In. °.°" I'l... '.
0" II'°'°_’.I0 II: II1 II "'....Id' IO:
.II.I .0... .l... .II.I
I 0 ' I I l ' I
II '. IO. 0. III I. II. I.
"III: IoII: III-I: III-I:
.0... .0... .II.I III.-
I . . I I . . I
I. . I. I I. . OI .
. I I . I I I
.. ...,,-..., ..: .. ..._.-._.I ..:
I I
.QI.....‘ .....O .0 .u ...-_‘ I.I.IOI.I
.II .I .II ,I
I I

Table 1

2007

Tables 2 3

Efron and Tibshirani,

Benjamini and Hochberg (1995)

Table 2

/810's12um0_fp10}x0'sauuuuogutotq/ﬁduq

Putluri et al., 2011

Benjamini and Yekutieli (2001)

Kanehisa and Goto, 2000

Figure 2

Table 4

(2011)

Putluri et al.

Subramanian et al., 2005

Subramanian et al., 2005

Supplementary Table S9

/3.IO'S[BIIm0fp.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

J.Ma et al.

 

       

;

1gb,
v j???

    

  

l“,

       
 
 

O erbb_signaling '\° ' « .
O chemokine_signaling '

O jak_stat_signaling 0 °

0 fc_epsi|on_ri_signaling

. gnrh_signa|ing

O adipocytokine_signaling

. epithelia|_cel|_signaling_in_he|icobacter_py|ori_infection

The complete pathway topology

  

_ . ‘

The subnetwork surrounding the ErbB pathway

Fig. 3. The estimated pathway topology in the TCGA cancer study: (A) the
complete pathway topology and (B) the subnetwork surrounding the ErbB
pathway. Edges in black are present in both classes, whereas red and green
edges are only present in ER positive and ER negative class, respectively.
Node size is proportional to the size (number of genes) of the corresponding
pathway.

the complete list of FDR adjusted P-values. Nevertheless, using
NetGSA and a relaxed FDR cutoff threshold of 0.30 (similar to the
strategy adopted in Subramanian et al., 2005), we obtain the follow-
ing top three ranked signaling pathways: Jak-STAT, p53 and Wnt.
All three are implicated in lung cancer, although the latter two are
also implicated in multiple other types of human malignancies.
However, the Jak/STAT pathway has been recently shown to play a
key role in non small cell lung cancer cells (Song et al., 2011).

Our third and final application is based on a data set from
TCGA (2012). The data set contains RNA-seq measurements for
17 296 genes from 1033 breast cancer specimens, including ER posi-
tive, ER negative and other unevaluated cases. As in the previous
gene microarray study, the external network information is ex-
tracted from the BioGRID database. We focused on a subset of the
genes that have recorded network information and are present in
KEGG pathways with at least 5 members. This leaves for further
consideration 800 genes with 403 samples from the ER positive and
117 from the ER negative classes, spanning over 45 KEGG path-
ways. We then applied the constrained network estimation proced-
ure with the tuning parameter selected via BIC in (9) to obtain the
partial correlation networks for the ER positive and ER negative
classes, respectively. Due to the large number of variables, visualiza-
tion of the estimated networks at the individual gene level is

Table 5. P-values for the differential pathways in the TCGA data,
with FDR correction at q* = 0.01

 

 

Pathway NetGSA GSA-s GSA-c
Epithelial cell signaling in Helicohacter 5e‘95 0.00 1.00
pylori infection
Cell cycle 2547 0.00 1.00
Galactose metabolism 3531 0.00 1.00
Glutathione metabolism 1e‘27 0.00 1.00
NOD-like receptor signaling pathway 16—24 0.00 1.00
Pyrimidine metabolism 46—23 0.00 1.00
Cysteine and methionine metabolism 1e‘22 0.00 1.00
Starch and sucrose metabolism 1e‘18 0.00 1.00
Toll-like receptor signaling pathway 16—18 0.00 1.00
Glycolysis/Gluconeogenesis 3e‘17 0.00 1.00
Jak-STAT signaling pathway 9515 0.00 1.00
Chemokine signaling pathway 36—14 0.00 1.00
ErbB signaling pathway 7513 0.00 1.00
p53 signaling pathway 76—12 0.00 1.00
Hedgehog signaling pathway 5510 0.00 1.00
beta-Alanine metabolism 1e‘7 0.00 1.00
Fc epsilon R1 signaling pathway 56—7 0.00 1.00
Fructose and mannose metabolism Ze'6 0.00 1.00
Pentose phosphate pathway 2e"6 0.00 1.00
PPAR signaling pathway 56— 6 0.00 1.00
Adipocytokine signaling pathway 4e‘5 0.00 1.00
Purine metabolism 6e‘5 0.00 1.00
Valine, leucine and isoleucine degradation 5e4 1e‘3 1.00
GnRH signaling pathway 2e‘3 0.00 1.00
TGF-beta signaling pathway 3e‘3 0.00 1.00

 

Here 0.00 represents a zero p-value produced out of ﬁnite permutations.
GSA-c/GSA-s refer to Gene Set Analysis with/without randomization of the
genes based on 3000 permutations.

challenging. Instead, we examine the interactions among pathways
in Figure 3 to gain insight into their co-regulation behavior. The
weighted pathway level network is defined as follows. Let each node
in the network represent one pathway, with size proportional to the
size of the corresponding pathway. A weighted edge between two
pathways P1 and P2 is defined as the number of nonzero partial cor-
relations between genes in P1 and those in P2 (normalized by the
sizes of the two pathways). Links visualized in Figure 3 are the top
5% of the weighted edges, where ranking is based on edge weights.
Table 5 presents the FDR corrected P—values for the selected dif-
ferential pathways using NetGSA based on the estimated partial cor-
relation networks, as well as GSA-c and GSA-s. The complete table
is presented in the Supplementary Materials Section D. At q"r :0.
01, NetGSA reports 25 out of the 45 KEGG pathways as signifi-
cantly enriched, whereas GSA either rejects the null for all pathways
(GSA-c) or fails to reject any pathway (GSA-s). Selected differential
pathways identified by NetGSA are also highlighted in Figure 3. Of
particular interest is the set of connected, enriched pathways cen-
tered around the ErbB pathway in Figure 3(b). This pathway con-
tains receptors that signal through various pathways to regulate cell
proliferation, migration, differentiation, apoptosis, and cell motility
and play a key role in breast cancer (Howe and Brown, 2011), al-
though its role in breast carcinogenesis not very well understood.
Note that the Jak-STAT pathway is downstream of the ErbB one
and can be activated by key epidermal growth factor receptors in
the former to create signaling cascades (Henson and Gibson, 2006).
Further, the GnRH signaling pathway has been reported to interact
with the ErbB pathway receptors (Morgan et al., 2011). All these

/810's12um0_fp10}x0'sauuuuogutotq/ﬁduq

Network—based path way enrichment analysis

 

interconnected pathways are related to receptors that have been
implicated in various studies with over—expression in the ER nega—
tive class and hence faster tumor growth and poorer clinical

outcomes.

5 Discussion

This article introduces a constrained partial correlation network es—
timation method that seamlessly incorporates externally available
interaction information for genes and other biomolecules. The end
product is a reliable condition—specific estimate of the underlying
networks. The resulting estimated network structures are then used
for network—based pathway enrichment analysis. For the purpose of
constrained network estimation, one might also try the one—step
constrained maximum likelihood estimation (a functionality offered
in the R—package glasso) to recover the underlying partial correl—
ation network. However, this one—step approach requires sophisti—
cated specification of the tuning parameters at positions for which
structural information is available, and can be challenging to imple—
ment in practice.

Two sources of uncertainty can be identified in the proposed
framework: one from the reliability of the external database infor—
mation in the network estimation procedure and the other from the
uncertainty regarding the estimated network itself, as well as how it
propagates into the NetGSA testing procedure. As discussed in
Remark 1, the proposed method can conveniently accommodate the
first source of uncertainty by incorporating a non—zero penalty on
parameters that are uncertain. Further, as shown in Theorem 2, the
proposed test via the extended NetGSA framework is asymptotically
unbiased and most powerful, given the consistency of the estimated
network, and hence accounts for the second source of uncertainty.
Nevertheless, in finite samples as the numerical work in the
Supplementary Materials Section C illustrates, Type 1 errors may be
slightly off in the presence of numerous errors in the estimated net—
work (either due to misspecification of the external information or
lack of samples for accurate estimation). The topic of dealing with
network estimation errors and possible ways to address it is dis—
cussed in Narayan and Allen (2016).

Finally, the current framework of NetGSA uses the Cholesky de—
composition of the covariance matrix of the underlying network. It
is natural to ask whether the order of the variables affects the result
of enrichment analysis. In simulations and the real data analyses, we
find that the estimated powers/P—values from NetGSA are compar—
able after permutation of the variables.

Acknowledgements

The authors would like to thank the reviewers for many constructive com-

ments and suggestions.

Funding

Ali Shojaie was supported by NSF award (DMS-1161565) and National
Institutes of Health award (1K01HL124050-01A1). George Michailidis was
supported by NSF awards (DMS-1228164 and DMS-1545277) and National
Institutes of Health award (7R21GM10171903).

Conﬂict of Interest: none declared.

References

Al-Shahrour,F. et al. (2005) Discovering molecular functions signiﬁcantly
related to phenotypes by combining gene expression data and biological in-
formation. Bioinformatics, 21, 2988—2993.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R Stat. Soc. B, 57,
289—300.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Stat., 29, 1165—1188.

Bickel,P.]. et al. (2009) Simultaneous analysis of lasso and dantzig selector.
Ann. Stat., 37, 1705—1732.

Boyd,S. and Vandenberghe,L. (2004). Convex Optimization. Cambridge
University Press, Cambrridge.

Candes,E.J. and Recht,B. (2009) Exact matrix completion Via convex opti-
mization. Found. Comput. Math., 9, 717—772.

Chuang,H.Y. et al. (2012) Subnetwork-based analysis of chronic lymphocytic
leukemia identiﬁes pathways that associate with disease progression. Blood,
120, 2639—2649.

Csardi,G. and Nepusz,T. (2006) The igraph software package for complex
network research. Interjournal. Compl. Syst, 1695. http://igraph.org.

Dehmer,M. and Emmert-Streib,F. (2008). Analysis of Microarray Data:
A Network-Based Approach. Wiley-VCH Verlag GmbH 86 Co. KGaA,
Weinheim.

Dempster,A.P. (1972) Covariance selection. Biometrics, 28, 157—175.

Efron,B. and Tibshirani,R. (2007) On testing the signiﬁcance of sets of genes.
Ann. Appl. Stat., 1, 107—129.

Friedman,]. et al. (2008) Sparse inverse covariance estimation with the graph-
ical lasso. Biostatistics, 9, 432—441.

Gottwein,E. et al. (2007) A Viral microrna functions as an orthologue of cellu-
lar mir-155. Nature, 450,1096—1099.

Green,M.R. et al. (2011) Signatures of murine b-cell development implicate
yy1 as a regulator of the germinal center-speciﬁc program. Proc. Natl. Acad.
Sci. USA, 108, 2873—2878.

Henson,E.S. and Gibson,S.B. (2006) Surviving cell death through epidermal
growth factor (egf) signal transduction pathways: implications for cancer
therapy. Cell. Signal, 18, 2089—2097.

Houstis,N. et al. (2006) Reactive oxygen species have a causal role in multiple
forms of insulin resistance. Nature, 440, 944—948.

Howe,L.R. and Brown,P.H. (2011) Targeting the her/egfr/erbb family to pre-
vent breast cancer. Cancer Prevent. Res., 4, 1149—1157.

Huang,D.W. et al. (2008) Systematic and integrative analysis of large gene lists
using david bioinformatics resources. Nat. Protoc., 4, 44—57.

Huerta,A.M. et al. (1998) Regulondb: a database on transcriptional regulation
in escherichia coli. Nucleic Acids Res., 26, 55—59.

1deker,T. and Krogan,N.]. (2012) Differential network biology. Mol. Syst.
Biol., 8, 565.

1deker,T. et al. (2011) Boosting signal-to-noise in complex biology: prior
knowledge is power. Cell, 144, 860—863.

Joshi-Tope,G. et al. (2003) The genome knowledgebase: A resource for biolo-
gists and bioinformaticists. Cold Spring Harb. Symp. Quant. Biol., 68,
237—244.

Kanehisa,M. and Goto,S. (2000) Kegg: Kyoto encyclopedia of genes and gen-
omes. Nucleic Acids Res., 28, 27—30.

Khatri,P. et al. (2012) Ten years of pathway analysis: current approaches and
outstanding challenges. PLoS Comput. Biol., 8, e1002375.

Lauritzen,S.L. (1996). Graphical Models. Oxford University Press, Oxford.

Meinshausen,N. and Buhlmann,P. (2006) High dimensional graphs and vari-
able selection with the lasso. Ann. Stat., 34, 1436—1462.

Morgan,K. et al. (2011) Gnrh receptor activation competes at a low level with
growth signaling in stably transfected human breast cell lines. BMC Cancer,
11, 476.

Narayan,M. and Allen,G.1. (2016) Mixed effects models to ﬁnd differences in
multi-subject functional connectivity. Front. Neurosci., 10,

Nishimura,D. (2001) Biocarta. Biotech Softw. Internet Rep., 2, 117—120.

Prill,R.]. et al. (2010) Towards a rigorous assessment of systems biology mod—
els: the dream3 challenges. PloS One, 5, e9202.

ﬁle'sreumol‘pmJXO'sopeuuowtotq/ﬁdnq

10

J.Ma et al.

 

Putluri,N. et al. (2011) Metabolomic proﬁling reveals potential markers and
bioprocesses altered in bladder cancer progression. Cancer Res., 71,
7376—7386.

Rothman,A.]. et al. (2008) Sparse permutation invariant covariance estima-
tion. Electron. Stat., 2, 494—515.

Searle,S. (1971 ). Linear Models. John Wiley 8c Sons.

Shojaie,A. and Michailidis,G. (2009) Analysis of gene sets based on the under-
lying regulatory network. Comput. Biol., 16, 407—426.

Shojaie,A. and Michailidis,G. (2010) Network enrichment analysis in complex
experiments. Stat. Appl. Genet. Mol. Biol., 9, 22.

Song,L. et al. (2011) Jak1 activates stat3 activity in non-small—cell lung cancer
cells and il-6 neutralizing antibodies can suppress jak1-stat3 signaling. Mol.
Cancer Ther., 10, 481—494.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-
based approach for interpreting genome-wide expression proﬁles. Proc.
Natl. Acad. Sci. USA, 102, 15545—15550.

TCGA (2012) Comprehensive molecular portraits of human breast tumours.
Nature, 490, 61—70.

Wermuth,N. (1980) Linear recursive equations, covariance selection, and path
analysis]. Am. Stat. Assoc., 75, 963—972.

Wilson,B.G. et al. (2010) Epigenetic antagonism between polycomb and swi/
snf complexes during oncogenic transformation. Cancer Cell, 18, 316—328.

Zaki,N. et al. (2013) Protein complex detection using interaction reliability as-
sessment and weighted clustering coefﬁcient. BMC Bioinformatics, 14, 163.

Zhou,S. et al. (2011) High-dimensional covariance estimation based on gaus—
sian graphical models]. Mach. Learn. Res., 12, 2975—3026.

/3.IO'S[BIIInOfp.IOJXO'SOIJBLUJOJIIIOlq/ﬂduq

