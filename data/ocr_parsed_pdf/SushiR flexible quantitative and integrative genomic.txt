APPLICATIONS NOTE V°" 3%,71‘3 lggiiliéiféiiZSEE/i‘igg

 

Genome analysis

Advance Access publication June 5, 2014

Sushi.R: flexible, quantitative and integrative genomic
visualizations for publication-quality multi-panel figures

Douglas H. Phanstiel, Alan P. Boyle, Carlos L. Araya and Michael P. Snyder*
Department of Genetics, Stanford University School of Medicine, Stanford, CA 94305, USA

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: Interpretation and communication of genomic data re-
quire flexible and quantitative tools to analyze and visualize diverse
data types, and yet, a comprehensive tool to display all common gen-
omic data types in publication quality figures does not exist to date. To
address this shortcoming, we present Sushi.R, an R/Bioconductor
package that allows flexible integration of genomic visualizations into
highly customizable, publication-ready, multi-panel figures from
common genomic data formats including Browser Extensible Data
(BED), bedGraph and Browser Extensible Data Paired-End (BEDPE).
Sushi.R is open source and made publicly available through GitHub
(https://github.com/dphansti/Sushi) and Bioconductor (http://biocon-
ductor.org/packages/release/bioc/html/Sushi.html).

Contact: mpsnyder@stanford.edu or dphansti@stanford.edu

Received on April 17, 2014; revised on May 28, 2014; accepted on
June 2, 2014

1 INTRODUCTION

Genomic science is a rich data-intensive ﬁeld in which diverse
data types are combined to uncover and explore characteristics
of sequence elements on a large scale. However, despite a grow-
ing set of mature standard Visualization techniques and ﬁle for-
mats, no comprehensive tools exist to facilitate multi-panel
Visualization across a broad range of standard genomic data
types. To address this deﬁciency, we developed Sushi.R, a ﬂex-
ible R library that leverages standard Visualization techniques
and ﬁle formats to produce highly customizable publication-
quality figures of genomic data within the widespread analysis
environment, R(R Core Team, 2013).

2 METHODS

Sushi.R is written exclusively in the R software environment. The Sushi.R
package includes 13 example datasets and a vignette detailing the
usage of each (Sanyal et al., 2012; Li et al., 2012; ENCODE Project
Consortium et al., 2012; Neph et al., 2012; International
Consortium for Blood Pressure Genome-Wide Association Studies
et al., 2011; Dixon et al., 2012; Rhee and Pugh, 2011). Datasets that
were mapped to hg19 were converted to hg18 using the liftOver tool.
Sushi is compatible with all organisms and genome builds. Large datasets
were ﬁltered to include only regions shown in Figure 1. ChIA-PET inter-
actions were additionally ﬁltered to remove interactions between regions
51000 bp apart. To facilitate use, Sushi.R is open source and is distrib-
uted through both Bioconductor for one-step installation and GitHub for

 

*To whom correspondence should be addressed.

version control, issue management and third-party development
(Gentleman et al., 2004).

3 FEATURES

Quantitative and qualitative genomic information can typically
be broken down into three data types: features, signals and inter-
actions. Sushi.R provides ﬂexible methods to plot each data type,
allowing users to represent Virtually any type of genomic data
in an aesthetically pleasing, coherent and integrative fashion.
A Sushi plot made entirely within R (without any modifications
in image-editing software) displaying multiple data types is
shown in Figure l. The code and data to make Figure l are
included as part of the Sushi.R package.

Feature data describe genomic regions characterized by a
unique combination of chromosome, start and stop coordinates.
Often stored in Browser Extensible Data (BED) format, feature
data can be used to represent sites of transcription factor bind-
ing, gene structures, transcript structures, sequence read align-
ments, Genome-Wide Association Studies (GWAS) hits and data
from an array of other sources. The Sushi functions plotBed,
plotGenes and plotManhattan facilitate the Visualization of fea-
ture data in a host of different formats ranging from heatmaps of
feature density to feature pileups (Figure 1A, GEK, N).

Signal data representing quantitative values across genomic
coordinates are commonly stored in bedGraph format and can
be used to represent diverse forms of data including sequence
conservation, transcription, transcription factor binding, chro-
matin accessibility and nascent transcription rates, among
others. The Sushi function plotBedgraph provides ﬂexible meth-
ods to plot, overlay and compare signal track data with appro-
priately represented data from each one of these disparate
sources (Figure 1E, F, L, M).

Finally, interaction data can be used to describe interactions
between distal genomic elements in both a qualitative or quanti-
tative fashion. Interaction data describing, for example, 3D chro-
matin structure are commonly stored in Browser Extensible Data
Paired-End (BEDPE) format or in interaction matrices. Sushi
functions plotHiC and plotBedpe are used to plot interactions
data as either trapezoidal heatmaps, arched lines or box and line
structures, and support quantitative mapping of interaction sig-
nals on y-axis values, color scales and line widths (Figure lBrD).

Sushi plots can easily be combined and augmented via a
number of annotation functions including zoomsregion, 200m-
box, maptocolor and addlegend, allowing customizable scaling
of colors, line types and line widths for ﬂexible quantitative pres-
entation. Zoom inset features facilitate Visualization at multiple

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0fp10}x0"sothJJOJutotq//:d11q 11101} pQPBOIII/lAOG

9103 ‘Og isnﬁnv 110 ::

Sushi.R

 

 

   

 

 

 

 

 

 

 

 

 

 

 

 

  

 

 

 

 

     

 

 

 

 

i r- -1 ' g u 5

l‘ "I n at: 5

m nu n I5 a 5

 _.  . - .  It- r’\l W n flirt . A”.

5 chm its t 232 Mb 5 5 arms via 55 5 III: 5
D EcnIA—mtpalz) : E
i " .. 3:: H... ‘—_‘ u i
' H'—'.—. u" -'—_'IH H " II I : I I I." u_ u a :
: ~12: .u' 3'55"” . 1:; . ." .3 :' '.
: .. --a-_. '25‘9’ . 1 £ 1 3 S 3 '
: EH. 3:: = :. a o o o o :4 0- . o I
E F a m I W _-_ ._.'_I_ .____ I..__ _ _ _.___ I't _!'!_ _' I __
5cm" 1‘; ‘59 i 251 2‘2 Mb; was 71.9 ________ __ _ _ fa 51b
L 565.3%; (Putz) _!

n I

21:: l

in» a

_ _ _ _ _ _ _ 0: chr15 ratios ralm nhis 

  M :nNA—m I
F :ChIP-SeqrcnIP-Exo _ 5 5
: IMF-mm:  Inn-ulna In. .Ja. .. i in nan .... u... l I
I gin-15 75.505 7350! 73515 Mb I

N IGene Structures I

' :I I -II ‘ I E g g S g I
Wins—Mb chr1‘l MINE 2432 Mb chr15 rains NED! N115 Illh

Fig. 1. Multi-panel Sushi plot made without modiﬁcation by external image-editing software. The Sushi functions used to create the plot include
(A) plotManhattan, (B) plotHic, (C) plotBedpe, (D) plotBedpe, (E) plotBedgraph, (F) plotBedgraph, (G) plotBed, (H) plotManhattan, (I) plotBed,
(J) plotGenes, (K) plotBed, (L) plotBedgraph, (M) plotBedgraph and (N) plotGenes. The code and data to make this ﬁgure are included as part of the

Sushi.R package

scales and diverse genomic contexts. Images can be written to all
formats supported by R including Encapsulated PostScript
(EPS), Portable Document Format (PDF) and Portable
Network Graphics (PNG).

4 DISCUSSION

The rapid proliferation and complexity of genomics experi-
mentsifueled by high-throughput sequencingihas concomi-
tantly driven demand for analysis and visualization tools that
facilitate interpretation and communication of rich and diverse
genomic data types. Sushi fills a critical void among currently
available visualization tools by providing a means to easily pro-
duce sophisticated, customizable, genomic visualizations.
Sushi.R will be of great use to the genomic community, as it
accelerates our ability to uncover, document and communicate
important scientific ﬁndings derived from increasingly abundant,
and complex, genomic data.

Funding: This project is funded by NIH grant U54HG006996
(to M.P.S) and K99HG007356 (to A.P.B). D.H.P. is a Damon
Runyon fellow supported by the Damon Runyon Cancer
Research Foundation (DRG-2l22-l2).

Conﬂict of interest: M.P.S. is a cofounder and scientiﬁc advisory
board (SAB) member of Personalis and also on the SAB of
Genapsys.

REFERENCES

ENCODE Project Consortium et al. (2012) An integrated encyclopedia of DNA
elements in the human genome. Nature, 489, 57774.

Dixon,J.R. et a]. (2012) Topological domains in mammalian genomes identiﬁed by
analysis of chromatin interactions. Nature, 485, 3767380.

International Consortium for Blood Pressure Genome—Wide Association Studies.
et al. (2011) Genetic variants in novel pathways inﬂuence blood pressure and
cardiovascular disease risk. Nature, 478, 1037109.

Gentleman,R.C. et a]. (2004) Bioconductor: open software development for com—
putational biology and bioinformatics. Genome Biol, 5, R80.

 

2809

112 /310's112u1n0fp10}x0"sotwurJOJutotq/ﬁduq uteri papeolumoq

9103 ‘Og isnﬁnv 110 ::

D.H.Phanstiel et al.

 

Li,G. et al. (2012) Extensive promoter—centered chromatin interactions provide a
topological basis for transcription regulation. Cell, 148, 84w98.

Neph,S. et al. (2012) An expansive human regulatory lexicon encoded in transcrip—
tion factor footprints. Nature, 489, 83790.

R Core Team. (2013) R: a language and environment for statistical computing.
http://www.R—project.org.

Rhee,H.S. and Pugh,B.F. (2011) Comprehensive genome—wide protein—DNA inter—
actions detected at single—nucleotide resolution. Cell, 147, l40&l419.

Sanyal,A. et al. (2012) The long—range interaction landscape of gene promoters.
Nature, 489, 1097113.

 

281 0

112 /310's1eu1n0[p101x0"sorreurJOJutotq/ﬁduq 111011 popeo1um0q

9103 ‘0g isnﬁnv 110 ::

