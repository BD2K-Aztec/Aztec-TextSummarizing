ORIGINAL PAPER

Vol. 30 no. 21 2014, pages 3012-3019
doi:10. 1093/bioinfonnatics/btu4 79

 

Sequence analysis

Advance Access publication July 11, 2014

A new approach for detecting riboswitches in DNA sequences
Jessen T. Havill”, Chinmoy Bhatiya3, Steven M. Johnson“, Joseph D. Sheets5 and

Jeffrey S. Thompson2

1Department of Mathematics and Computer Science, 2Department of Biology, Denison University, Granville, OH 43023,
3Capco, New York, NY, 10005, 4Department of Computer Science, Wake Forest University, Winston-Salem, NC 27109
and 5College of Human Medicine, Michigan State University, Grand Rapids, MI 49503, USA

Associate Editor: John Hancock

 

ABSTRACT

Motivation: Riboswitches are short sequences of messenger RNA
that can change their structural conformation to regulate the expres-
sion of adjacent genes. Computational prediction of putative ribos-
witches can provide direction to molecular biologists studying
riboswitch-mediated gene expression.

Results: The Denison Riboswitch Detector (DRD) is a new computa-
tional tool with a Web interface that can quickly identify putative ribos-
witches in DNA sequences on the scale of bacterial genomes.
Riboswitch descriptions are easily modifiable and new ones are
easily created. The underlying algorithm converts the problem to a
‘heaviest path’ problem on a multipartite graph, which is then solved
using efficient dynamic programming. We show that DRD can achieve
~88—99% sensitivity and >99.99% specificity on 13 riboswitch
families.

Availability and implementation: DRD is available at http://drd.deni-
son.edu.

Contact: havill@denison.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 4, 2014; revised on July 5, 2014; accepted on
July 7, 2014

1 INTRODUCTION

The regulation of gene expression is a critical process that dic-
tates the ability of cells to function properly, to establish cellular
identity, and to respond to changes in environmental conditions.
Gene regulation is manifested in a variety of ways, ranging from
the action of transcriptional activators and repressors through
cis—acting regulatory binding sites, DNA accessibility Via chro-
matin structure, and localization of DNA within the cellular/
nuclear conﬁnes. In addition to these mechanisms, RNA has
surfaced as a player in gene regulation (Mondal and Kanduri,
2013). Specific forms of RNA, such as microRNAs, small inter-
fering RNAs and many others, have been identiﬁed and charac-
terized as important components of gene regulation.

One speciﬁc manner by which RNA molecules serve as regu-
lators of gene expression is in the form of riboswitches.
Riboswitches are short sequences (~5(%250 nt in length) located
in the non-coding portions of speciﬁc messenger RNAs
(mRNAs) that regulate the expression of the coding sequences

 

*To whom correspondence should be addressed.

contained within the mRNA (Miranda-Rios, 2007; Montange
and Batey, 2008). They function Via their ability to fold into
distinct secondary structures that inﬂuence the ability of the
mRNA to be transcribed, processed or translated.
Riboswitches consist of two speciﬁc components: an aptamer
region that binds to a speciﬁc organic molecule, often some
type of metabolite; and an expression platform that produces a
change in structural conformation as a result of binding to the
aptamer (Winkler and Breaker, 2003). The aptamer region is
generally a highly conserved sequence, capable of binding to a
number of organic molecules with high speciﬁcity (NahVi et al.,
2007). Binding to the aptamer triggers changes in the intramo-
lecular base pairing within the expression platform, leading to
changes in secondary and tertiary structure of the RNA. The
change in conformation in turn inﬂuences the ability of the
mRNA to be expressed in a variety of different ways, depending
on the speciﬁc riboswitch. The activation of some riboswitches
results in premature termination of transcription, ending synthe-
sis of the mRNA before the coding region. Others act by directly
blocking translation of the mRNA by restricting access to the
ribosomal binding site (Nudler and Mironov, 2004). In eukary-
otes, riboswitch folding may also inﬂuence expression Via regu-
lation of mRNA splicing.

There are currently about 20 known families of riboswitches
that bind to a variety of nucleobases, amino acids, metal ions and
other organic compounds (Batey, 2012). Many of the more ex-
tensively studied riboswitches serve as part of a feedback regu-
latory system for genes that participate in cellular metabolism
(Miranda-Rios, 2007). The metabolites that bind to the aptamer
serve as indicators of the relative activity of speciﬁc metabolic
pathways, and upon binding, inﬂuence expression of genes that
participate in the pathway. For example, certain genes involved
in the synthesis of Vitamin B1 (thiamin) are regulated by a ribos-
witch that binds thiamin pyrophosphate (TPP), the biologically
active form of thiamin. TPP binds to a conserved RNA sequence
known as a THI-box, which represses transcription of genes pos-
sessing this sequence in the 5/ untranslated region. The THI-box
is a particularly intriguing example of a riboswitch, as it is found
in a wide range of bacteria, archaea and eukaryotes and func-
tions in a variety of contexts. The TPP riboswitch is the only
known eukaryotic riboswitch identified to date (Bocobza and
Aharoni, 2008).

Given the importance of riboswitches in gene regulation in the
context of whole-genome regulation, methods to identify such
sequences are needed. A variety of efforts have been previously

 

3012 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sorJBurJOJurorq/ﬁduq 11101} pepeolumoq

9103 ‘Og anﬁnV uo ::

A new approach for detecting riboswitches

 

undertaken to develop bioinformatics tools to predict the pres-
ence of riboswitches in RNA sequences (Bengert and Dandekar,
2004; Chang et al., 2009, 2013; Freyhult et al., 2007; Veksler-
Lublinsky et al., 2007). Most programs that have been developed
operate on the principle of sequence alignment to identify con-
served sequences in previously identiﬁed riboswitches, coupled
with RNA structural folding algorithms. Programs that are cur-
rently available are generally limited to the identiﬁcation of a
speciﬁc subset of known riboswitch types, and are only able to
search modest sized sequence inputs. To date, few programs have
been developed to take advantage of the abundance of completed
full genome sequences.

To address the need for riboswitch prediction on the whole-
genome scale, we have developed a new computational tool with
a Web interface that can identify putative riboswitches in DNA
sequences, called the Denison Riboswitch Detector (DRD).
DRD can quickly (typically <1 min) process complete bacterial
genomes and achieve ~90% sensitivity and almost 100% speci-
ﬁcity. DRD’s description of a riboswitch is simple and easily
modiﬁable, based on the highly conserved motifs found in all
known riboswitches. To identify an optimal sequence of short
motifs, DRD transforms the search into a path-ﬁnding problem
on a directed multipartite graph, which is then solved by an
efﬁcient dynamic programming algorithm. DRD can be accessed
at http://drd.denison.edu. Researchers interested in using the
program as a stand-alone tool may also contact the ﬁrst author.

2 RELATED RESEARCH

There are three primary approaches currently used to detect
riboswitches. The first approach compares conserved stem-loop
features in the secondary structure, determined by an algorithm
like mFold (Zuker, 2000). For example, RiboSW (Chang et al.,
2009) and RegRNA (Chang et al., 2013) focus on the character-
istic secondary structures of 12 different riboswitches.
Riboswitch Finder (Bengert and Dandekar, 2004) searches for
the characteristic secondary structure of purine riboswitches.
RNAMotif (Macke et al., 2001) deﬁnes a general descriptor lan-
guage, allowing one to search for any desired structure.

The second approach takes advantage of the fact that the
aptamer regions of riboswitches are highly conserved for the
metabolite that they bind to. Thus, it is possible to recognize
motif sequences that are speciﬁc to a certain family of ribos-
witches. To detect a riboswitch, the input is ﬁrst scanned for
the motif sequence(s), and then the optimal secondary structure
is predicted. If the predicted structure matches the known struc-
ture of the riboswitch, it may be considered a putative ribos-
witch. This approach is also incorporated into Riboswitch
Finder (Bengert and Dandekar, 2004) and the unpublished
SequenceSniffer algorithm (Sudarsan et al., 2003). Motif search
is used exclusively by RibEx (Abreu-Goodger and Merino,
2005), which also searches for translational attenuators.

The third, more recent, approach is to characterize a ribos-
witch family using a probabilistic model. Singh, et a]. (2009)
consider using proﬁle hidden Markov models and Infernal
(Nawrocki et al., 2009), upon which Rfam (Gardner et al.,
2011) is based, uses a covariance model. RiboSW (Chang
et al., 2009) also uses HMMER (Eddy, 1998) after it performs
a search for conserved structural characteristics.

Our technique primarily falls into the second category.
DRD is designed to be fast, working quickly on entire bacterial
genomes, with conveniently modiﬁable deﬁnition ﬁles.
Although this approach sacriﬁces some of the accuracy of
the more comprehensive probabilistic models, it still achieves
~90% speciﬁcity, compared with Rfam, in our comprehensive
tests.

3 METHODS

Here we will give an overview of our algorithm, followed by a more
detailed description and a discussion of its implementation.

3.1 The DRD algorithm

To detect instances of a particular riboswitch with n known motifs in a
long DNA sequence, we ﬁrst break the sequence and its reverse comple-
ment into short overlapping segments of a few hundred nucleotides each.
We assume that at most one riboswitch can occur in each segment. In
each segment, we identify all matches for each of the n motifs. If at least
one match is found for each motif, we then ﬁnd the highest scoring se-
quence of matches in the segment that conforms to given ordering and
spacing requirements. This step is accomplished by transforming the
problem into a heaviest path problem on an n-partite graph, and using
an efﬁcient dynamic programming algorithm to ﬁnd the best path. (This
is described in detail in Section 3.2.) If such a path exists and its weight
exceeds a given threshold, we then fold the corresponding putative ribos-
witch using mFold (Zuker, 2000). Finally, we align the resulting Vienna
(dot-bracket) string, with motifs inserted to guide alignment, with a given
consensus Vienna string. If the number of identities in this alignment
exceeds another given threshold, we display the result with a graphical
representation of its secondary structure.
DRD accepts the following parameters describing a riboswitch:

o a maximum length of the riboswitch M;
o a segment length l and segment overlap length [7 3 M;
o n motifs m1, m2, . . . ,mn (may contain degenerate symbols);

0 minimum motif identity scores (By ‘identity score’, we mean the
number of nucleotide matches in a local alignment between a
motif and a portion of the query sequence with the same length.
An indel subtracts one from the score in the local alignment algo-
rithm but is not counted in the ﬁnal motif identity score.)
11.1, 11.2, . . . , u", where u,- is the score corresponding to motif mi;

0 maximum inter-motif distances Do, Dl, Dz, . . . , D", where D,-,
1': 1, 2, . . . ,n — 1, is the maximum distance between motifs m,- and
mH 1, and Do and D” are distances on the 5’ side of the ﬁrst motif and
the 3’ side of the last motif, respectively, that are used to define the 5’
and 3’ boundaries of a reported riboswitch;

a minimum inter-motif distances d1, d2, . . . , dnzl, where d,-
i= 1, 2, . . . ,n — 1, is the minimum distance between motifs m,- and
mi+1;

a minimum total motif identity score S1 3  1 11,-;

a consensus secondary structure representations F and F (in Vienna
notation), where F is the consensus secondary structure, and F is the
consensus secondary structure with motifs inserted in their appropri-
ate locations; and

a minimum total Vienna identity score S2.
DRD begins by cutting the input sequence and its reverse complement

into short segments of l (8 70071000) nucleotides that overlap each other
in p (w 200) nucleotides. The overlap length should exceed the expected

 

3013

112 /310's112u1n0fp10}x0"sorJBurJOJurorq/ﬁduq 11101} popcorn/hog

9103 ‘Og anﬁnV uo ::

J.T.Havill et al.

 

maximum length of the riboswitch. For each segment, our approach
consists of the following steps:

(1) Use the Smith7Waterman local alignment algorithm to locate, for
each speciﬁed motif mi, all matches with identity score at least 0,.
Indels subtract one from the alignment score. For the jth discovered
match for motif mi, record both its starting position bid- and its
identity score sm- 3 m. If not all motifs are found, abort and con-
tinue with the next segment.

(2) Construct a directed n-partite graph G = (V, A) in which each layer
i contains a node v,-,,- for each match to motif m,- found in the
previous step. Connect a node vid- in layer i to a node vii”, in
layer [‘1‘ I  [21+ 1,k>b,',j and  +d,‘ 5 [21+ pk — by S Di. Each
node is given a weight equal to the associated motifs Smithi
Waterman identity score.

(3) Find the maximum weight path (vlJ-l, sz-z, . . . , ann) from a node
in Layer 1 to a node in Layer h, using a dynamic programming
algorithm described below. If no such path exists, abort and con-
tinue with the next segment. Otherwise, this path corresponds to a
subsequence containing matches to all the motifs, and its weight

llsiJ-i is the surrln of the identify scores of the correspond-
ing motifs. If xi: 1 sth 3 S1, consider the subsequence be-
tween positions le-l — Do and an-n -l- |m,,| -l- D,, to be a
putative riboswitch. Otherwise, abort and continue with the next
segment.

(4) Optionally, check whether the putative riboswitch discovered in
the previous step overlaps with any sufﬁciently long open read-
ing frames (ORFs). If so, abort and continue with the next
segment.

(5) Fold the putative riboswitch using the mFold algorithm (Zuker,
2000) and convert it to a Vienna string in dot-bracket notation.

(6) Insert the discovered motifs into the Vienna string at their correct
locations and perform a global alignment of the resulting Vienna
string and the modiﬁed consensus string F. If the resulting identity
score is at least S2, output the sequence as a putative riboswitch.

(7) Also, for informational purposes only, perform a global alignment
of the unmodiﬁed Vienna strings, convert the Vienna representa-
tions of both the putative and consensus riboswitches to shape
notation (Giegerich et al., 2004; Lorenz et al., 2008), and perform
a global alignment of the two shape strings.

3.2 Heaviest path problem

We will illustrate the heaviest path problem described in Steps 273 with a
small example. Consider a search for a short ﬁctitious riboswitch with
only three conserved motifs m1 = AAAA, m2 = CCCC, and m3 = TTTT;
threshold identify scores 11.1 = 11.2 = a3 = 3; and minimum and maximum
distances d1 = d2 = d3 = 2 and 01 = 02 = D3 = 20. Suppose our current
segment is the following, with matches for each motif underlined
(single for AAAA, double for CCCC and triple for TTTT). (There are
more overlapping matches, but we will ignore them here.)

GAAGCAACAGCGTTTC ACCCC TGCAAAAGAGAGATAAGCCTC

 

 

 

 

 

GGTCCC GGATATATGTATT CGAGAAGTTTT ACCCA TAG

 

 

With these matches, we construct the directed tripartite graph below.
In the ﬁrst layer are vertices representing matches for motif AAAA, in
the second layer are matches for motif CCCC and in the third layer
are matches for motif TTTT. Each vertex is connected to all vertices
in the next layer corresponding to motifs between distance 2 and 20 down-
stream.

 

We now wish to ﬁnd a path connecting a vertex in Layer 1 with a vertex
in Layer 3 with the maximum total vertex weight. The unique maximum
weight path in this case is shown with dashed lines. This path corresponds
to the subsequence indicated below with the chosen motifs still under-
lined.

GAAGCAACAGCGTTTCACCCCTGC

AAAAGAGAGATAAGCCTCGGTCCC GGATATATGTATTCGAGAAGTTTT

 

 

 

 

 

 

AC C CATAG

The heaviest path problem is solved using a dynamic programming
algorithm based on the following recurrence. Let HU- denote the weight of
the heaviest path from a node in Layer 1 to node vid- in Layer i. Then we
can deﬁne Hid- recursively as follows:

SiJ'  i: I
ifig (W71ch ViJ) E A

max {Hisz-l-sw} otherwise
(View, Vi./')EA

_ 00
Hid'i

Then, we ultimately want the heaviest path, satisfying

H* = max HM.
J

The associated dynamic programming algorithm has time complexity
@(nmz), where m is the maximum number of matches for a motif.

3.3 Implementation as a Web tool

We implemented DRD as a multithreaded C -l--l- program for the Linux
operating system and placed it behind a PHP Web interface, shown in the
top half of Figure 1. The interface allows one to input a query sequence in
FASTA format and choose one or more query riboswitch types. Each
riboswitch is represented by a text deﬁnition ﬁle containing the param-
eters outlined in Section 3.1. Clicking on the name of the riboswitch
displays the corresponding ﬁle. One may also supply their own deﬁnition
ﬁle (or a modiﬁed version of one of the given ﬁles) by selecting the ‘Other’
option. Finally, one may opt to have the program disregard any motifs
that overlap ORFs (by checking ‘ORF Search?’). An ORF is deﬁned to
be a sequence of codons that starts with the start codon ATG and ends
with one of three stop codons (TAA, TAG, TGA), with no stop codons in
between. Only ORFs containing at least the number of codons given by
the user in the ‘Minimum ORF Length’ box (120 by default) impact the
search.

The format of the description ﬁle is straightforward; one example is
shown in Figure 2. Line 1 contains the values of l and [7. Line 2 contains
n, the number of motifs, followed by a motif m,- and its minimum identity
score a,- on each of the following n lines. After the motifs (on Line 8 in
the example in Fig. 2), are the maximum inter-motif distances
Do, Dl, Dz, . . . , B". These are followed on the next line by the minimum
inter-motif distances d1, d2, . . . , dnzl. On the next line are the values of
S1, S2 and M. Finally, we have the Vienna string for the consensus sec-
ondary structure and the same Vienna string with motifs inserted.

 

3014

112 /310's1eu1nofp101x0"sorJBurJOJHrorq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A new approach for detecting riboswitches

 

Denison Riboswitch Detector

A had far Ending rib-alumina within 1 DNA 2mm

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

III-nth“ W
CI-EAEBBkIcnmrilelaomm
-_ mm Intuit: 
0m“ cm mm; ;mm:
3m|RLTSSIl7|MTIﬂCdTyI It new i nlaettn all“! a I“. W. on t 5 l
"’ ' '"’ T” . um  am:
-_chg'.|cnmnk|nomm _m&m1
WM Whimﬂ mummmmtmiia
m‘m'" Owl'me
[Ipntﬁtn minor: inpuu(lﬁ?!)?bm,3345egmm.scgmnﬂuvndnplengmam1
WWW TPP:§'- « 11 au- maria: « [5.5a] » pcmgan « [2.5m » Icccull « I1.2ﬂ1 » Item-1!!! « I10.5ﬂl 9:- Mcmtill « 1! 3:- -:I'
Thruhnldm nudiideuﬂdesaZT.anidenndes256.maxinwm|ength=ITO
Ollth on. tine-aha“ = II!) amino acid:
Queryllesnlts
ZWMWMMM.
I H_ ._ “as _glmm,3ﬂ .H ._
T — !
Queryﬂnnltnetalls
Result 1: position 94354 — 94439 [29 i 10 mir identities]
5'— .m. —3'
I'll tIIlll'r Hal |:II.| .illl'l
nee: men none new we
Vienna global alignment (53 i 91 identitich
......|[..:u|.............. ..-.1J||-||.......-----.ugu....1:13:.........|:(.....:n (candidate)
I||||!i |||||| !| Hill ||||||| |||!| 'IIIJIIlI-IIIII I! “II
u-nilEHIt“nlElli“NIH-u--(ll-1]I--IHJ-A---Hliutlll A A - - uani..nn..mn--..-.. (WM-19]
Vienna global alignment with motifs [60 i 91 identities)
. . . . ..u..|nmn.........--ncm..“nuance:.n.ncmn.u::(....:anmnum.|:{.....:n (candidate)
=|||I!l IlllII || lllII-l | ll||l| IIllIl|=||1Ill:I Illlllilii ||||
.....(tttllm.|uu..llimtlldll.nccc:....ncm.uu . . . . ..:|1acnnnnnunIIJ-...... (mam)
snapegiobnangnmmrermmums)
[--l[I-ll- {ME}
I III II
{[[lllllll {consensus}
Candidate sequence folded wiﬂl minis! Consensus image courtesy 0! 3.11m
(I i
Fig. 1. The Web interface of DRD (above) and a sample result (below)
When Submit is pressed, work begins and a results window, describing 4 RESULTS

the progress so far, appears for each selected riboswitch. The pages
will refresh every 35, leading ultimately to the ﬁnal results, like those in
Figure 1, listed in the order of motif identity score, then Vienna identity
score. In our tests, matches to previously annotated riboswitches were
virtually always displayed on top. Clicking on a result sets up a BLAST
query. Below the alignments and scores, optimal and suboptimal second-
ary structures computed by mFold are displayed with the Rfam consen-
sus image.

We tested DRD on 13 riboswitch families, using deﬁnition ﬁles
derived from multiple sequence alignments of the families’ Rfam-
designated seed sequences. These deﬁnition ﬁles may be Viewed
in Supplementary Table $1 or in the Web interface by clicking on
the riboswitch name. For each riboswitch, we performed two
types of tests. First, to obtain robust sensitivity results for each
riboswitch family, we tested DRD on all known riboswitch

 

301 5

1r: /810's112um0_fp101x0'so1112u1101u101q/ﬁdnt1 mm; papno1umoq

9103 ‘09 isanV uo ::

J.T.Havill et al.

 

700 200

5

GGGG 3

GCTGAGA 6

ACCC 3

BCYTGH 5
RCGDAGGRR 9

11 60 80 20 50 12

5 2 l 10
2'? 56 1'10
u...(HHHH..(HH..H}H-----HI-H}.JHI....JH(..
....-(iiiiiGGGG.(iiil..iiiGCTGAGRili-iii.ACCC}....ACYTGA.

Fig. 2. The TPP riboswitch deﬁnition ﬁle, with the last two lines
truncated

sequences predicted for each family in the Rfam database at
http://rfam.xfam.org. The sensitivity, or true-positive rate
(TPR), is TP/ (T P+ FN), where TP is the number of true-positive
ﬁndings, and FN is the number of false-negative ﬁndings.
Second, to measure the corresponding false-positive rate (FPR)
for each family in genome-scale sequences, we randomly selected
a small number of Rfam-predicted riboswitch sequences and
tested DRD on the set of GenBank sequence records in which
they are contained. The false-positive rate is 1-speciﬁcity; speci-
ﬁcity is defined to be TN/(TN -l- FP), where TN is the number of
true-negative ﬁndings, and FP is the number of false-positive
ﬁndings. We discuss each of these tests in detail below.

4.1 Sensitivity

We used a specialized front-end program to test how well DRD
detects Rfam-predicted riboswitches in isolation. The number
of sequences assigned to a family in Rfam ranges from 356
(SAM-II) to 11 197 (TPP). For each riboswitch family, we set
S 1 = 0 in the deﬁnition file to ascertain the sensitivity over the full
range of possible 51 values. The results, displayed in Figure 3 and
Table 1, show that, with the exception of the cobalamin ribos-
witch, we get a sensitivity of ~90% or better for each riboswitch
family when 51 is set to be ~95% of the maximum possible motif
identify score. The data in the left half of Table 1 show the
detailed sensitivity results for the default values of $1 in DRD.
Higher values of $1 allow for too little deviation from the given
motifs, and therefore, the sensitivity drops off quickly. Sensitivity
for the cobalamin riboswitch on the full set of 9056 Rfam
sequences reaches a maximum of ~83%. However, sensitivity
for the smaller set of 430 seed sequences easily exceeds 90%.
Looking at the multiple sequence alignment for the full set of
cobalamin riboswitch sequences reveals much less consensus
than the seed sequences, especially at the 5/ end.

We ﬁnd that, upon closer inspection, when DRD fails to iden-
tify an Rfam-predicted riboswitch, it is commonly due to
missing one or two identities in one or two motifs. By reducing
individual minimum motif identity scores a,- and the value of S1,
we can easily generate higher sensitivity values. However, we also
found that this will result in much lower specificity values when
DRD is applied to genome-scale input files. We discuss these
results next.

4.2 Speciﬁcity

To contextualize these sensitivity results, we would ideally com-
pute corresponding speciﬁcity values for every GenBank

 

         
 

 

 

 

 

 

 

 

 

1.00- ' ' . . . . . . . ., ' '-
0.95- i
0.90—
0.85-
0.80-
0.75—
0.70-
.4? 0.65 -
.2
:5; 0.60_ — RF00174 Cobalamin (full) _
QC) — RF00174 Cobalamin (seed)
tn 0.55- — RFOOOSO FMN -
RF00234 glmS
050' — - - RFOOSO4 Glycine ‘
0.45_ — — - RF00168 Lysine _
- - - RF00522 Prte
0_40— RF00167 Purine -
------ -- RF00162 SAM-l
035- ------ -- RF00521 SAM-ll . ‘
0.3m ------ -- RF00634 SAM-IV '-__ _
RF00059 TPP :_
0.25-  RF00442 yka-yka 
 RF00080 yybP-ykoY '
0.20- I v I '-
0.85 0.90 0.95 1.00

Threshold score / Maximum score

Fig. 3. Sensitivity values for each riboswitch family over a range of S1
values. To display the results on a common x-axis, S1 values are normal-
ized by the maximum possible motif identity score for each family. The
ﬁlled circle on each curve marks the value of S1 in that riboswitch’s
default deﬁnition ﬁle

sequence record containing an Rfam-predicted riboswitch.
Because this is infeasible, we instead estimated sensitivity by ran-
domly selecting a small set of Rfam-predicted sequences from
each riboswitch family and running DRD on their corresponding
GenBank sequence records. For each family, we selected records
that covered at least ﬁve organisms and totaled at least 12 million
nt. In the case of three riboswitch familiesiﬂavin mononucleo-
tide (FMN), purine and TPPiwe conducted tests on a larger set
of 30 GenBank records. To derive speciﬁcity values over a range
of 51 values, we set 51 to be three less than the maximum possible
identity score for each family.

Because DRD searches for a riboswitch in each segment, we
considered each segment to be an individual trial. If a segment
contained a riboswitch that has been annotated in either Rfam or
GenBank, it was considered a true positive when DRD detected
the riboswitch and a false negative otherwise. If a segment did
not contain an annotated riboswitch, it was considered to be
a false positive when DRD detected a riboswitch and a true
negative otherwise. We note that this may not be a perfect clas-
siﬁcation because either (i) a segment may actually contain a
previously unannotated riboswitch or (ii) two overlapping seg-
ments may both contain the same annotated riboswitch, but
DRD will report only one hit. In the ﬁrst case, the reported
speciﬁcity may be too low. In the second case, the reported spe-
ciﬁcity will be too high. However, because the number of anno-
tated riboswitches is so small relative to the number of segments,
these errors are negligible.

Our results, displayed in Figure 4 and Table 1, show that
DRD achieves very high speciﬁcity while generally maintaining

 

3016

112 /310's1eu1nofp101x0"sorJBuiJOJHrorq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A new approach for detecting riboswitches

 

Table 1. Sensitivity and 1 — speciﬁcity when S1 is the default value

 

 

 

 

 

Family Sensitivity tests Speciﬁcity tests Default S1/
Maximum
Seed Full
Name Rfam ID Number of Sensitivity Number of Sensitivity Number of Number of 1 — Speciﬁcity
sequences sequences nucleotides segments
Cobalamin RF00174 430 0.93 9056 0.72 26 954 544 67 385 0.000178 33 / 35
FMN RF00050 144 0.97 4516 0.89 78 082 630 173 519 0.000161 41 / 43
glmS RF00234 18 0.94 842 0.93 12 042 233 30 104 0.000266 27 / 29
Glycine RF00504 44 0.93 6875 0.93 27 624 292 2 762 348 0.000001 26 / 28
Lysine RF00168 47 0.96 2422 0.96 22 451 184 52 213 0.000038 50 / 53
prte RF00522 41 0.95 894 0.98 13 487 486 23 256 0.000086 21 / 24
Purine RF00167 133 0.96 2427 0.94 80 376 637 146 145 0.000363 34 / 37
SAM-I RF00162 433 0.89 4757 0.91 13 752 571 28 651 0.000140 40 / 42
SAM-II RF00521 40 1.00 356 0.92 18 875 429 49 672 0.000000 31 / 33
SAM-IV RF00634 40 0.98 468 0.93 26 737 655 53 476 0.000056 45 / 47
TPP RF00059 115 0.89 11 197 0.88 62 623 450 125 251 0.000453 27 / 30
yka-yka RF00442 109 0.99 741 0.94 18 698 253 38 955 0.000077 27 / 29
yybP-ykoY RF00080 17 1.00 1882 0.99 23 704 402 49 385 0.000162 30 / 32

 

Note: The last column contains the default S1 values, relative to the maximum motif identities.

 

1.00— ,, _ —
0.95
0.90 .

 

0.85 
0.80 '
0.75
0.70

    

 

   

 

 

 

 

 

 

 

.4? 0.65 —
.2
9% 0'60_ RF00174 Cobalamin (full)
5 — RF00174 Cobalamin (seed)
W 0.55— — RF00050 FMN —
I RF00234 glmS
0-50'I — - - RF00504 Glycine '
0.454 - - - RF00168 Lysine _
— — — RF00522 Prte
0.40— RF00167 Purine —
------ -- RF00162 SAM-I
035' : ------ -- RF00521 SAM-ll '
0.30_ .5 ------ -- RF00634 SAM-IV _
_: RF00059 TPP
0.25-5‘  RF00442 yka-yka .
-‘ ----- RF00080 yybP-ykoY
0.20—: i i . . _
0.0000 0.0002 0.0004 0.0006 0.0008 0.0010
1 7 Specificity

Fig. 4. The receiver-operator characteristic curve for each riboswitch
family correlating sensitivity values from Section 4.1 to 1 — speciﬁcity
on a representative sample of GenBank sequence records. The ﬁlled
circle on each curve marks the value of S1 in that riboswitch’s default
deﬁnition ﬁle

sensitivity at least 90%. The data in the right half of Table 1
show the detailed speciﬁcity results for the default values of $1 in
DRD. The raw data for these experiments can be found in
Supplementary Tables S27S14.

4.3 Other observations

While we found that the default ORF threshold length (120
codons) worked well for a variety of inputs, we also found
that, in some cases, especially with cobalamin and yka-yka,
it was necessary to increase the ORF threshold to locate a ribos-
witch reported by Rfam. Some examples of this are annotated in
Supplementary Tables S27S14. In many cases, increasing the
ORF threshold did not introduce many more false-positive re-
sults, but in a very few cases it did.

Because DRD defines the ends of its reported riboswitches
with respect to distances on either side of the first and last
motif (D0 and D”, respectively), the accuracy of these predicted
positions is better when there are deﬁned motifs close to the 5/
and 3/ ends. Because this is true in almost all of the tested
families, the bounds reported by DRD are very close to those
in Rfam. One exception is the cobalamin riboswitch. While a
multiple sequence alignment of the cobalamin seed sequences
predicts a well-conserved short GGT motif near the 5/ end, we
eliminated this motif from our definition ﬁle because it resulted
in an even lower hit rate for the full set of sequences. (An inspec-
tion of the multiple sequence alignment for the full set of se-
quences reveals significantly more variability than the seed
sequences and no clear consensus on the 5/ end.) The leaves
the first motif 4&50 bases from the 5/ end, resulting in more
variability in the predicted 5/ boundary.

To detect glycine riboswitches, which tend to appear as
two similar structures in tandem, DRD must have contiguous
segments overlap signiﬁcantly. Therefore, in our deﬁnition
ﬁles, we set each segment length to be 150, with a 140 bp over-
lap, resulting in a 150bp ‘window’ that shifts down by 10 bp
in each iteration. This signiﬁcantly slows the search, but
it still completes within a few minutes on genome-scale
sequences.

 

3017

112 /310's1eu1nofp101x0"soiwuiJOJHioiq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnV uo ::

J.T.Havill et al.

 

Riboswitches are most commonly found in bacterial genomes,
but the TPP riboswitch has also been identiﬁed in eukaryota and
archaea. Therefore, in the TPP riboswitch speciﬁcity tests, we
included three archaeal organisms from the Thermoplasma
genus and two eukaryotic organisms [Arabidopsis thaliana
and Glycine max (soybean)]. The results on this small sample
were comparable with those on bacterial genomes. (See
Supplementary Table S12.)

4.4 Comparison with existing tools

Table 2 compares the functionality of DRD with some other
recently developed riboswitch search tools discussed in Section
2. As discussed previously, DRD is able to scan genome-scale
ﬁles for riboswitches, whereas other tools have relatively con-
straining input size limits. Like RiboSW (Chang et al., 2009),
DRD also allows a user to deﬁne new riboswitch deﬁnition
ﬁles, but the format of DRD’s files is signiﬁcantly more
straightforward.

We compared the sensitivities of DRD and RiboSW (Chang
et al., 2009) on all riboswitch families but SAM-IV, which
RiboSW does not consider. For the purine riboswitch, we also
compared the sensitivities of DRD and Riboswitch ﬁnder
(Bengert and Dandekar, 2004). We chose to omit RibEx because
a similar comparison with RiboSW was already undertaken by
Chang et al. (2009).

Table 2. A basic comparison of the main features of each tool

 

 

Feature Riboswitch RibEx RiboSW DRD
ﬁnder

Maximum input length 3 Mb 40 kb 10 kb none

Number of riboswitches 1 317 12 13

New user deﬁnitions No No Yes Yes

 

Table 3. Test results illustrating the relative sensitivity (TPR) of each tool

For these comparisons, we randomly selected up to 50 Rfam
seed sequences for each family. If the number of seed sequences
was <50, we used the entire seed set. We chose to test on this
reduced set because of RiboSW’s size constraints and computa-
tion times. The results, summarized in Table 3, show that DRD’s
sensitivity at least rivals that of RiboSW for all riboswitch
families, and signiﬁcantly exceeds it in four cases (glycine,
TPP, yka-yka and yybP-ykoY) (For TPP and yka-yka,
we used the most favorable results for RiboSW over four
random sets to validate these more signiﬁcant differences).
Over all sequences, RiboSW achieves sensitivity of 0.85, whereas
DRD achieves sensitivity of 0.95. Overall, there were 12 instances
in which RiboSW detected a riboswitch that was not detected by
DRD, and 64 instances in which the opposite was true. Complete
results can be found in Supplementary Tables S1&S26.

Because of the input size constraint and the different way in
which RiboSW searches a sequence, it was not possible to com-
pute comparable specificity values for RiboSW. Such a compari-
son was omitted by Chang et al. (2009) as well.

In conducting this comparison, we found the response time of
RiboSW to be mostly comparable with that of DRD on inputs
with similar sizes (but searches for a single cobalamin riboswitch
sometimes took up to a few minutes). RiboSW’s limited input
size prevented comparisons on larger inputs.

5 CONCLUSIONS

We have designed a new Web-based tool for identifying putative
riboswitches on a whole-genome scale. To efﬁciently identify
high-quality strings of short conserved motifs, DRD transforms
the problem into a heaviest path problem on a directed multi-
partite graph and solves the transformed problem with an efﬁ-
cient dynamic programming algorithm. We have shown that this
technique is both fast and can achieve relatively high sensitivity
and speciﬁcity.

There are several directions that could be pursued in the future
to improve DRD. First, we could enhance our motif model to

 

 

 

 

Family Riboswitch ﬁnder RiboSW DRD

Name Number of sequences Number of hits TPR Number of hits TPR Number of hits TPR
Cobalamin 50 7 7 44 0.88 46 0.92
FMN 50 7 7 48 0.96 49 0.98
glmS 18 7 7 16 0.89 17 0.94
Glycine 44 7 7 24 0.55 41 0.93
Lysine 47 7 7 45 0.96 45 0.96
prte 41 7 7 36 0.88 39 0.95
Purine 50 48 0.96 47 0.94 48 0.96
SAM-I 50 7 7 45 0.90 44 0.88
SAM-II 40 7 7 37 0.93 40 1.00
TPP 50 7 7 32 0.64 45 0.90
yka-yka 50 7 7 42 0.84 49 0.98
yybP-ykoY 17 7 7 13 0.76 17 1.00
Totals 507 7 7 429 0.85 480 0.95

 

 

3018

112 /310's1eu1nofp101x0"soiwuiJOJHioiq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnV uo ::

A new approach for detecting riboswitches

 

include site-speciﬁc characterizations of motifs, akin to a proﬁle
hidden Markov model, with a likely increase in computation
time. Second, we could consider replacing our somewhat crude
method for secondary structure in comparison with an alterna-
tive method, such as that used by Macke et al. (2001).

Funding: This work was performed by C.B., S.M.J. and J.D.S.
while they were students at Denison University.

Conﬂict of Interest: none declared.

REFERENCES

Abreu—Goodger,C. and Merino,E. (2005) RibEx: a web server for locating ribos—
witches and other conserved bacterial regulatory elements. Nucleic Acids Res.,
33, W69(%W692.

Batey,R.T. (2012) Structure and mechanism of purine—binding riboswitches. Q. Rev.
Biophys, 45, 3457381.

Bengert,P. and Dandekar,T. (2004) Riboswitch ﬁnderia tool for identiﬁcation of
riboswitch RNAs. Nucle‘w Acids Res, 32, W1547W159.

Bocobza,S. and Aharoni,A. (2008) Switching the light on plant riboswitches. Trends
Plant Sci., 13, 523533.

Chang,T—.H. et al. (2009) Computational identiﬁcation of riboswitches based on
RNA conserved functional sequences and conformations. RNA, 15, 142671430.

Chang,T.—H. et al. (2013) An enhanced computational platform for investigating the
roles of regulatory RNA and for identifying functional RNA motifs. BMC
Bioinformatics, 14 (Suppl. 2), S4.

Eddy,S.R. (1998) Proﬁle Hidden Markov Models. Bioinformatics, 14, 7557763.

Freyhult,E. et al. (2007) Boltzmann probability of RNA structural neighbors and
riboswitch detection. Bioinformatics, 23, 205472062.

Gardner,P.P. et al. (2011) Rfam: wikipedia, clans and the “decimal” release. Nucleic
Acids Res., 39 (Suppl. 1), D1417D145.

Giegerich,R. et al. (2004) Abstract shapes of RNA. Nucleic Acids Res., 32,
484374851.

Lorenz,W.A. et al. (2008) Asyrnptotics of RNA Shapes. J. Comput. Biol, 15, 31763.

Macke,T. et al. (2001) RNAMotifia new RNA secondary structure deﬁnition and
discovery algorithm. Nucleic Acids Res., 29, 4724—4735.

Miranda—Rios,J. (2007) The THI—box riboswitch, or how RNA binds thiamin pyro—
phosphate. Structure, 15, 2597265.

Mondal,T. and Kanduri,C. (2013) Maintenance of epigenetic information: a non—
coding RNA perspective. Chromosome Res., 21, 615$25.

Montange,R.K. and Batey,R.T. (2008) Riboswitches: emerging themes in RNA
structure and function. Ann. Rev. Biophys, 37, 1177133.

Nahvi,A. et al. (2007) Genetic control by a metabolite binding mRNA. Chem. Biol,
9, 104371049.

Nawrocki,E.P. et al. (2009) Infernal 1.0: inference of RNA alignments.
Bioinformatics, 25, 133571337.

Nudler,E. and Mironov,A.S. (2004) The riboswitch control of bacterial metabolism.
Trends Biochem. Sci., 29, 11717.

Singh,P. et al. (2009) Riboswitch detection using proﬁle hidden markov models.
BMC Bioinformatics, 10, 325.

Sudarsan,N. et al. (2003) Metabolite—binding RNA domains are present in the genes
of eukaryotes. RNA, 9, 644—647.

Veksler—Lublinsky,I. et al. (2007) A structure—based ﬂexible search method for
motifs in RNA. J. Comput. Biol, 14, 9087926.

Winkler,W.C. and Breaker,R. (2003) Genetic control by metabolite—binding ribos—
witches. ChemBioChem, 4, 102471032.

Zuker,M. (2000) Calculating nucleic acid secondary structure. Curr. Opin. Struct.
Biol, 10, 3037310.

 

3019

112 /310's1eu1nofp101x0"soiwuiJOJHioiq/ﬁduq 111011 papeo1um0q

9103 ‘0g1sn8nv uo ::

