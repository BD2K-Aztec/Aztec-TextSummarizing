ORIGINAL PAPER

Vol. 28 no. 6 2012, pages 838-844
doi:1 0. 1 093/bioinformatics/bts033

 

Genetics and population analysis

Advance Access publication January 17, 2012

Exact coalescent simulation of new haplotype data from existing

reference haplotypes
Chul Joo Kang* and Paul Marjoram

Department of Preventive Medicine, Keck School of Medicine, University of Southern California, Los Angeles,

CA 90089, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: We introduce a coalescent-based method (RECOAL) for
the simulation of new haplotype data from a reference population of
haplotypes. A coalescent genealogy for the reference haplotype data
is sampled from the appropriate posterior probability distribution,
then a coalescent genealogy is simulated which extends the sampled
genealogy to include new haplotype data. The new haplotype
data will, therefore, contain both some of the existing polymorphic
sites and new polymorphisms added based on the structure of
the simulated coalescent genealogy. This allows exact coalescent
simulation of new haplotype data, compared with other methods
which are more approximate in nature.

Results: We demonstrate the performance of our method using a
variety of data simulated under a coalescent model, before applying
it to data from the 1000 Genomes project.

Availability: The source code is freely available for download at
ftp://popgen.usc.edu

Contact: chulkang@usc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 17, 2011 ; revised on December 21 , 201 1 ; accepted
on January 11,2012

1 INTRODUCTION

We live in an era in which the genome-wide association study
(GWAS) is one of the standard tools by which we interrogate the
genome for polymorphisms that relate to phenotype. There is also
a growing use of next-generation sequence (NGS) data. A large
number of new methodological approaches are being developed and
published in both areas. There is much discussion about the degree
to which the GWAS approach has been successful, for example, see
Eichler et a1. (2010); Heard et a1. (2010); Vineis and Pearce (2010),
but in humans many new associations between genotype and disease
status have been discovered.

An important part of the process of methods development in
the GWAS era is the testing of those methods on both real and
simulated test data. Frequently investigators have a single, smaller
set of data from a given population, the features of which they wish to
mimic when producing multiple, larger datasets for testing purposes.
A common example is the HapMap data (The International HapMap
3 Consortium, 2010) or 1000 Genome Project (1000GP) data (1000
Genomes Project Consortium, 2010). In this article, we present an

 

*To whom correspondence should be addressed.

exact coalescent method for simulating test sets of new haplotype (or
genotype) data, based upon such an existing, smaller, initial sample.

The goal is to sample new datasets, D’, consisting of n (say)
haplotypes, conditional upon some observed, existing data, D, which
contains no < < n haplotypes. Under the assumption that the popular
coalescent model is a reasonable approximation to the evolution of
the data, the goal here is to produce new data, D’ , conditional on the
unobserved genealogy, G, of the existing data, D (since it is through
G that the dependence of D’ on D is expressed). Note that in the
presence of recombination G will be a graph, the so-called ancestral
recombination graph (ARG), rather than a tree.

The problem of sampling G conditional on D is computationally
challenging, and for that reason several approximate methods have
been proposed, the most relevant here being HAPGEN (Spencer
et (11., 2009) and HAP-SAMPLE (Wright et (11., 2007), which are
based-upon the PAC-likelihood method of (Li and Stephens, 2003).
The algorithm of Li and Stephens is an appealing way to reduce
the computational burden involved in calculating probabilities
under a full coalescent model. Instead, it uses an approximation
scheme, based upon a model in which haplotypes are explained
as mosaics of other existing haplotypes. This scheme is shown to
(i) reduce computational burden signiﬁcantly, and (ii) provide a good
approximation to probabilities that would be obtained under the full
coalescent model. However, it remains the case that one would prefer
to sample from the exact coalescent model when such a thing is
tractable. In this article, we present software that makes this practical
for regions of length up to 500kb, using as many as about no = 100
reference haplotypes.

2 METHODS

Let D denote an existing sample of haplotype data. assumed to evolve under
an unstructured. neutral coalescent model. The evolutionary parameters
for this model. assuming the underlying population has effective size Ne.
are the per site mutation rate (8:4N9u). per site recombination rate
(p=4Ngr) and exponential population growth rate g. where #0) is the
mutation(recombination) rate per generation per site. We refer to these
parameters collectively as \11. We simulate new haplotype data D’ from the
conditional distribution P(D’ | D, \11) using the coalescent model. This process
can be written as

P(D’|D,\Il)
2/ fP(D’|G’,D)P(G’|G,\II)P(G|D,\II)
G/ G

where G is the (unobserved) ARG underlying D. and G’ is the new ARG that
underpins the newly generated haplotypes (SO G C G’).

 

838 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papBOIII/lAOG

91oz ‘Og isnﬁnv uo ::

Coalescent simulation from reference haplotypes

 

Our method. RECOAL (REference haplotype simulation using a
COALescent approach). proceeds in several steps. each of which we detail
below. First we sample an unobserved G. underlying D. Then. using a
coalescent prior. we generate a new G’ that contains G but adds n new tips.
each of which will correspond to a new haplotype. The no original haplotypes
are then discarded. The general scheme of RECOAL is represented in
Figure 1. Speciﬁcally. we proceed as follows.

2.1 Sampling of coalescent genealogy for reference
haplotypes

An ancestral recombination graph G for no reference haplotypes is sampled
from the conditional distribution P(G | D, \Il). We use the Metropolis-Hastings
Markov chain Monte Carlo method of C.J.Kang and J .Felsenstein (submitted
for publication) to sample graphs from this distribution.

2.2 Simulation of coalescent genealogy for new
haplotypes

After sampling G. we propose a larger ancestral recombination graph G’.
containing G and also including n new tips that will lead to the new data D’ .
We let G* denote the newly simulated ancestry. so that G’ =GUG*. G* is
sampled using the usual coalescent prior. conditional on G and \II.

2.3 Simulation of data for new haplotypes

For each site. 1'. types for the new haplotype data at those sites. denoted by
D;. are simulated conditional on the types at the same sites in the reference
haplotypes. denoted by D,. as well as on G’ and the mutation rate. We let G;
denote the genealogy (a tree in this case) deﬁned by G’ at site i. We do this
using the following procedure.

First. the type of the node If. corresponding to the root of G;. is sampled
from P(If’ |G;.,D,»). We then work our way from top-to-bottom (i.e. root-to-
leal) through Gg. generating the type of each internal node. Let 1) denote
such an internal node and denote its type by 1?. We sample I? from PHI.” |
dll’,1f,G;.,\Il). where If is the (already sampled) type of the parental (higher)
node. 0. directly connected to b. and d? is the types of the subset of haplotypes
that are descendants of node b. After sampling the types of the all internal
nodes. the types for the new haplotype data are sampled. The type of a
new haplotype a? is sampled from P(dl?‘ |Iic, Gg, \Il). where x is the tree tip
representing this new haplotype and c is the internal node directly connected
tox (and which has type 1). Note that RECOAL uses the ﬁnite sites model for
mutationsiallowing for multiple mutation events at each site. In particular.
we used the Hasegawa—Kishino-Yano model (HKYSS) (Hasegawa at al..
1985) as the DNA substitution model.

2.4 Ascertained SNPs

Many SNP datasets are collected using an ascertainment process in which
some kind of bias is likely to be present. An example is the use of a so-called
SNP-chip. in which SNPs are often selected to be included on the platform
only if they are common. Another example is data from NGS technologies. in
which. under a variety of calling schemes. the more copies of a mutant allele
that are present. the easier the polymorphism is to call (See Supplementary
Material for a full discussion.) This leads to an ascertainment bias in that
rarer SNPs are preferentially missing from the reference haplotypes. and the
number of polymorphisms is thereby decreased.

Applying our algorithm without respecting this ascertainment bias would
lead to incorrect performance. For example. we would tend to sample graphs
that were shorter. on average. than is correct (since the method would be
ignorant of the ascertainment process). Ascertainment is a difﬁcult problem to
deal with. but we present an ascertainment-corrected version of our algorithm
that allows for ascertainment schemes in which the probability of detecting
an SNP is dependent upon its frequency. We give theoretical details of the
ascertainment correction in the Supplementary Material.

 

Fig. 1. The simulated coalescent genealogy G’ for one site. The solid
line represents the sampled coalescent genealogy (G) for the reference
haplotypes. (For simplicity sake. we illustrate this as a tree. but it will
in general be a graph.) The dotted line represents the newly simulated
component G*. which shows the ancestry of the new haplotypes (indicated
in italics). G’ is the union of G and G*.

3 RESULTS

We demonstrate performance of the proposed method using
both data simulated under the coalescent model and data drawn
from the 1000 Genomes Project. We begin with examples using
simulated data.

3.1 Coalescent data

We used Hudson’s coalescent-based simulation program (called ms)
(Hudson, 2002) to simulate 1040 haplotypes for a given parameter
combination \I’. We then randomly selected 40 haplotypes from those
1040 haplotypes. Using the selected 40 samples as the reference
haplotypes, referred to as Href, we applied our method to simulate
1000 new haplotypes using the same \I’. We refer to these as
Hnew. We then compare properties of Hnew to the 1000 unsampled

haplotypes in the initial coalescent data (referred to as Hcoal).

3.1.1 SNP frequency and allele frequency spectrum Figure 2
plots the the MAF of each polymorphic locus in Hcoal against
the frequency of the same locus in Href. We then make the same
comparison between Hnew and Href. The correlation between
MAFs is r2 =0.905 in the former case and r2 =0.903 in the latter,
indicating very similar behavior in the actual and generated 1000
haplotypes. We show aggregate results from 100 replicate analyses.

In Table 1, we present the results of applying our algorithm to
data generated under a range of different mutation rates, and no
recombination, across 100 replicates. We show the average number
of SNPs over a 10 kb region in Href, Hcoaj and Hnew. We also
show the results of applying Watterson’s estimate 8 of the mutation
rate to each dataset (Watterson, 1975). This shows that the ability
of RECOAL to both reproduce SNPs in the reference haplotypes,
as well as add new SNPs, leads to a good agreement between the
overall polymorphism level in Hnew and H 1. Tables 2 presents

coa
the results of similar analyses, but with recombination included, for

 

839

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

C.J.Kang and RMarjoram

 

 

 

 

 

 

 

 

 

A _
0.5:  3:
:— 00. i. . 
é“: . Vin.” '.
E033- - IllllliEl35'
8 E . 1| .8; ‘: .
ol02:— °,:  5.1: o
- 8
I01: i !.'
0:....l....l....l....l....l
0 0.1 0.2 0.3 0.4 0.5
H_refMAF
B
 ..';'1i'ls
1.1.0.4;- .' “Saki”
20.3:— ""i.:i: El.
3 g  E:
.0 I.
I0.1;-|| l“,-
 ....I....I....I....I
0

i
0.1 0.2 0.3 0.4 0.5
H_refMAF

Fig. 2. Comparison of minor allele frequencies (MAFs) between H0031
and Href (A) and between Hnew and Href (B).

Table 1. The average number of SNPs (with 95% conﬁdence interval). and
Watterson’s estimate of mutation rate (8). for H0031. Href and Hnew

 

Table 2. The average number of SNPs (with 95% conﬁdence interval) and

Watterson’s estimate of mutation rate (8). for Hcoal. Href and Hnew

 

 

Region 10 kb 50 kb 100 kb

size
SNPs 74.13 374.7 783.6

H0031 (712647.17) (357843927) (739048321)
0 0.9177x10-3 1.001.x10-3 1.047x10-3
SNPs 39.87 214.8 456.2

Hm» (37.554226) (19942318) (412645032)
9 0.9373x10-3 1.010><10_3 1.073><10_3
SNPs 74.40 385.8 787.8

Hnew (720146.88) (36814051) (711446.72)
e 0.9941x10-3 1.031x10-3 l.053><10_3

 

e 10-4 10-3 10-2
SNPs 7.51 73.34 737.6

Hcoal (6.974806) (70.694607) (706547704)
é) 1.003 ><10_4 0.9799 ><10_3 0.9856><10‘2
SNPs 4.25 39.87 419.4

Hm» (3.80471) (37.554226) (39014522)
9 0.9992><1O_4 0.9373 ><10_3 0.9861 X 10-2
SNPs 7.78 74.40 733.4

Hnew (718838) (72014688) (703747642)
9 1.039 ><10_4 0.9941 X 10-3 0.9799 ><10_2

 

a number of different region lengths. In all cases, we see an excellent
agreement between the degree of polymorphism in Hnew and Hcoal.

In Figure 3, we compare the MAF distribution at polymorphic loci
in Hcoal and Hnew across 100 datasets. We show this for a variety
of population growth rates. We see a good agreement between the
MAF spectrum patterns simulated by ms and by RECOAL.

3.1.2 Pattern of linkage disequilibrium As well as preserving the
distribution of the number of polymorphic loci and their MAFs,

 

Here 9:000] and p=0.0005.

 

A
0.2

0.15

0.1

0.05

  
  

 

 

 

0.002 0.006 0.01 0.014

MAF

 

0.2 —

0.15 — ,

0.1 — 
\

0.05 -

   

 

 

0.002 0.006 0.01 0.014 0.018

Fig. 3. The MAF spectrum for datasets simulated by ms (A) and RECOAL
(B) with different growth rates.

it is also important to preserve patterns of linkage disequilibrium
(LD). In Figure 4, we show the pairwise r2 values between adjacent
markers in Href, Hcoaj and Hnew across 100 replicate analyses
in which data were simulated over a 10 kb region with 8 = 0.001,
p =0.0005. In Figure 4A, the comparison is between each adjacent
pair of markers in Href and the same pair of markers in Hcoal, and in
Figure 4B the comparison is between pairs in Href and Hnew. Again,
we see a good agreement between the ﬁgures. RECOAL reproduces
the LD values from the reference haplotypes with similar variation

 

840

113 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

Coalescent simulation from reference haplotypes

 

 

   
    

 

 

 

 

  
  

A 1— . .
E :‘I"“'- I
 I.— ’ . o ': 0.3: : :
CE : .  o'." , :
 _'_ 1... I} t. o . . 3
o : . . z .. 0 Z 0 . 8
0,0... .. gin ~.;- .
 r 8.14.. -
:o ....I.’ .
0 .....l....l...l...l
0 0.2 0.4 0.6 0.8 1
H_ref r2
B 1_— .. . I
Z ' . I. \
0.8 _- . 3 . -: ’.
CE I .1- "-3°o“ g3 I
06 _- . ~O. , 3
0;) I .~ '0..:... o! . o :
C|0.4 _— .: :I'Izo‘ . ° .° . .
I - ° '“0 .1 . .0 I .
0.2 '- ﬁ". ." '
: 4.3.". . o '
0 .l..'.l...l...l...l

 

 

 

0 0.2 0.4 0.6 0.8 1
H_ref r2

Fig. 4. Changes of pair-wise r2 values between pairs of adjacent loci in Href

and Hcoal (A) and in Href and Hnew (B).

V.VI‘VV$V".,"~""\:I- ..
O. .1 .
0‘, *6. ’99,

  
 
  

' ‘3‘ '0' '4 "'8‘?
1’.- wk?”

’I'O$\/
«91 .

v v . . w. -,.
0.1 , ‘0'...
I 0.01-(’4?

Fig. 5. LD patterns in a single. representative example dataset for Hcoal
(top). Href (middle) and Hnew (bottom).

(an r2 of 0.93 compared with r2=0.95 for the actual coalescent
data), suggesting that data produced by RECOAL are good proxies
for the unobserved data in this context.

Next, to illustrate the behavior in a single dataset, Figure 5 shows
an example of LD patterns, plotted by Haploview (Barrett et al.,
2005), for data simulated with ms using an overall recombination
rate of p=0.0005 but with the presence of a single hotspot in the
middle at which the rate of recombination is 100 X greater than in
the rest of the region. The LD patterns are well preserved.

3.1.3 Application to ascertained SNPs We now give an example
of applying RECOAL to ascertained data. Here, we simulate a
situation in which the probability of an SNP being reported as
polymorphic is a ﬁinction of the frequency of the mutant allele in
the sample at that position, such as might be appropriate for data

Table 3. The number of observed SNPs in Href and Hnew without
ascertainment correction (no asc.) and with ascertainment correction (asc)

 

 

A 0 0.1 0.2
Href 41.16 23.20 16.96
(37.424528) (196872724) (134472100)
S0 40.70 23.20 16.96
(36.754465) (196872724) (134472100)
no asc SH 0 0 0
(0’0) (CPO) (CPO)
SN 35.42 40.66 45.08
(33.513733) (37.864374) (41.844832)
Hnew 76.12 63.86 61.04
(722078026) (59.546868) (56.874642)
S0 40.70 23.20 16.96
(36.754465) (196872724) (134472100)
SH 0 17.92 24.76
(070) (158442000) (222247.30)
asc S0+SH 40.70 41.12 41.72
(36.754465) (37.014531) (37.484632)
SN 35.42 36.60 37.16
(335173733) (344443876) (353873902)
Hnew 76.12 77.72 78.88

(722078026) (73 41782.61) (739878420)

 

The 95% conﬁdence intervals are also shown. We simulated 100 replicates of 1000
new haplotypes over a 10kb region with 9:000] and p=0.0005 using 40 reference
haplotypes.

from NGS. We denote the number of SNPs present in Hnew that
were also observed in Href by S0. S H denotes new SNPs present in
Hnew that will also be present in Href—these are the SNPs added to
reﬂect the ascertainment scheme (Supplementary Material). Finally,
S N denotes SNPs which are present in Hnew as the result of new
mutation in G* and which are non-polymorphic in Href. Table 3
shows the number of SNPs in the newly simulated haplotypes from
the reference haplotypes ascertained with the different SNP calling
threshold A, in each of these categories, both with and without
the ascertainment correction scheme. Without application of the
ascertainment correction, the new haplotypes have fewer SNPs than
they should. (The results for )t=0 give the correct null behavior,
since there the ascertainment has no effect.) When ascertainment
correction is used, the new haplotypes have a number of SNPs that
is close to the correct value, although we see a slight tendency to
introduce too many new SNPs as A increases.

3.2 Comparison with other methods

Next, we compare RECOAL to another haplotype simulation
method that creates new haplotype data by resampling existing
reference haplotypes. There are two such methods: HAPGEN
(Spencer et al., 2009) and HAP-SAMPLE, (Wright et al., 2007).
Both these methods simulate new haplotypes using schemes based
upon Li and Stephen’s elegant PAC likelihood algorithm (Li and
Stephens, 2003). Both methods also perform well in terms of
reproducing the pattern of LD in the region considered (results not
shown). However, the models do differ in how they treat the mutation
process. There is no mechanism for introducing new polymorphic
sites in HAP-SAMPLE. As such, HAP-SAMPLE will necessarily
under-represent the degree of polymorphism in the newly generated

 

841

113 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

C.J.Kang and RMarjoram

 

 

      
  

 

 

 

 _- o
100 :— A ,
_ ' X“
_ I} I 1) ‘MS
80 .— ’ ’A x RECOAL
: A HAPGEN
60 _—°  MS RL
3  — RECOAL RL
4o  x I I - - HAPGEN Rll_
2o 40 60 80 100

Fig. 6. The relationship between the number of SNPs in the reference
haplotypes (x-axis) and the number of SNPs in simulated haplotypes (y-axis).
We simulated 1000 haplotypes from 40 reference haplotypes with RECOAL
(cross) and HAPGEN (ﬁlled triangle) using 8 = 0.001. For comparison. we
plot the number of SNPs in the reference and original populations (y-axis)
in the initial data [simulated by ms (circle)]. We also drew linear regression
lines (RL) for three cases.

haplotypes. For this reason, we focus our comparison on HAPGEN,
which introduces new mutations using a mutation rate that decreases
as each new haplotype is produced (reﬂecting the intuition that
as more haplotypes are sampled, the probability of detecting new
polymorphism will decrease).

As before, we examine the number of SNPs that are observed on
the haplotypes generated by each algorithm. We show results for
a range of sizes for Href. Figure 6 shows the relationship between
the number of SNPs in Href and the number of SNPs in Hnew,
using both methods. For reference, we also include a comparison
between Href and Hcoaj in the initial data, which were simulated
using ms, with ®=0.001. We show results across 50 replicates.
As a summary, we ﬁt a regression line in each case. We see a
good agreement between Hcoal and Hnew when using RECOAL,
and a good agreement between the regression line for results from
RECOAL and those from ms. The agreement is also quite good when
using HAPGEN, but there appears to be a systematic tendency to
add slightly too few SNPs when using HAPGEN.

Tables 4 and 5 show the number of SNPs simulated by HAPGEN
and RECOAL for a variety of sizes of Href. While the 95%
conﬁdence interval for RECOAL includes the mean number of SNPs
in the simulated population data in each case, and appears to show
no systematic dependency upon the size of Href, we observe that
the average number of SNPs in haplotypes simulated by HAPGEN
appears to be dependent on the size of both Href and Hnew. In
defense of the latter algorithm, we recall that it is an approximation
designed to improve computational tractability, thereby allowing
application of such a resampling scheme in a range of contexts that
is broader than is permissible using our own method. Our point
in this article is to present an exact coalescent method that can
be used when the region of interest is reasonably small (less than
~500 kb).

3.3 Simulation with 1000 Genome Project data

We close by showing an example application of RECOAL
aimed at simulating new haplotypes from the low-coverage

Table 4. The average number of SNPs (with 95% conﬁdence interval) when
simulating 1000 haplotypes using RECOAL (RC) and HAPGEN (HG) from
reference haplotype sets of differing sizes

 

 

Ref. size 10 40 100

Href 29.75 41.83 51.55
(26.0(L34.08) (373046.70) (47.2(L56.40)

RC 72.98 73.05 69.88
(687277753) (67.2(L78.90) (65.1(L75. 15)

HG 56.15 61.68 78.53

(52.1876058) (57.0276658) (740083.67)

 

For sake of comparison, an average of 72.07 SNPs (695447488) were simulated by
ms when generating 1000 haplotypes with the same parameter values.

Table 5. The average number of SNPs (with 95% conﬁdence interval) when
simulating datasets of new haplotypes of differing sizes using RECOAL(RC)
and HAPGEN (HG)

 

 

Sample 100 500 1000 5000

size

MS 50.45 66.55 72.07 93.3
(467575430) (622577092) (695477488) (88.6(L98.05)

RC 53.75 64.45 72.43 92.23
(488375870) (602376892) (665477331) (876779722)

HG 51.43 58.85 61.68 72.65

(465875790) (537576212) (57.024658) (67.607888)

 

Forty reference haplotypes were used. For comparison, we also show results obtained
when using ms to simulate a population of the same size in each case (MS).

Table 6. The number of SNPs and mean MAFs of those SNPs in data
simulated using reference haplotypes drawn from 1000GP

 

 

Total S0 SH SN
1000 GP SNPS 3536.5 1669.78 98.36 1767.98
MAF 0.055 0.106 0.033 0.009

 

1000GP data. We simulated 1000 haplotypes for a 500 kb
region (21—21.5 MB) of Chromosome 21 using haplotypes
constructed from the 4X coverage 1000GP CEU data. Since the
data are low coverage, some SNPs are not called. The rate at which
this occurs (i.e. the ascertainment bias), is reported as a function
of allele frequency (in the sample) in (1000 Genomes Project
Consortium, 2010) (Fig. 2). When applying RECOAL, we used
ﬁne-scale recombination rates estimated by the HapMap consortium
(The International HapMap 3 Consortium, 2010). ® for that region
is ~0.001 per site (Kang and Marjoram, 2011).

We summarize the simulation results in Table 6. Again, we report
SNPs in three classes: S0, SNPs which are also observed in the
reference haplotypes; S N, SNPs which appear only on the simulated
haplotypes; and S H, SNPs present in Hnew that will also be present,
but were not observed due to ascertainment, in Href. We see that
the ascertainment correction adds 98.4 SNPs on average to correct
for the estimated ascertainment probabilities.

 

842

113 /3.IO'S[1211an[pJOJXO'SOIJBLUJOJIIIOIqﬂIdllq mot} pop1301umoq

9103 0:; isnﬁnv uo ::

Coalescent simulation from reference haplotypes

 

   

Fig. 7. The LD patterns of the 1000 Genome Project reference haplotypes
(top) and of new haplotypes simulated by RECOAL (bottom).

We also show an example of the LD pattern observed in Hnew
and Href in Figure 7. The pattern of LD of the simulated haplotypes
shows high agreement.

4 DSCUSSON

In this article, we introduce an exact coalescent method for
the simulation of new haplotype data from an existing set of
reference haplotypes. Our method, RECOAL, simulates data from
the distribution P(Dl ID, \I’) using the full coalescent model rather
than using an approximation to that model. In addition to the
replication of SNPs present in the reference haplotypes, RECOAL
also simulates new SNPs using a coalescent prior. It preserves LD
structure well, and we demonstrate that new polymorphism is added
at an appropriate level.

Because of its exact nature, RECOAL is less computationally
tractable than the approximation underpinning HAPGEN, but it
is produces data under the full coalescent model rather than the
approximation to the coalescent model exploited by HAPGEN.
As such, we argue that it is appropriate to use RECOAL when
computational considerations permit. Nonetheless, we believe
HAPGEN remains an excellent alternative approach.

It should be noted that Step 1 of our approach is based on an
MCMC method. As such the user must allow the MCMC chain to
converge to the stationary distribution of P(G | D, W). The time taken
to reach convergence increases with both overall recombination
rate and number of reference haplotypes. Thus, the combination
of recombination rate and the number of reference haplotypes
determine the limits of computational tractability of RECOAL. As
an example, the simulation used in this article, which includes 40
reference haplotypes over a 100 kb region with human population
parameters, takes ~4 h to simulate 1000 new haplotypes on a typical
desktop machine. As such, RECOAL is intractable for simulation of
regions larger than ~500 kb. However, in the context of follow-
up of a GWAS, for example, in which the area being investigated
may be quite short, our software allows for the exact coalescent
simulation of new haplotypes conditional on the existing data,
under the coalescent model, rather than using a more approximate
method. When larger regions are desired, or much larger reference
samples exist, we recommend the approximate method HAPGEN
still be used.

Of course, our method is model-based and, as such, is exact
in the sense that it samples from exactly the correct distributions
conditional on that model. This, then, is a good time to remind
the reader of a quote attributed to George Box: ‘All models are
wrong; some are useful’. The coalescent has proven itself to be
widely useful, but it is still, of course, ‘wrong’. One example of
its ‘wrong-ness’ in the present context is that we use a neutral
model of molecular evolution, ignoring natural selection. There is
a literature about the coalescent with selection included (Kaplan

et al., 1988; Neuhauser and Krone, 1997), and some programs
(Spencer and Coop, 2004; Teshima and Innan, 2009) can simulate
data with the presence of the selective mutation. But those models
are not tractable when one wishes to condition upon the existing
data, so, like most other coalescent simulators, RECOAL simulates
data under neutrality. Another area in which our model is wrong
is that it is based upon an unstructured coalescent. In other words,
we assume random mating. While this has proven to be a robust
approximation to the behavior of single populations, it has proven
necessary to introduce extensions to the coalescent when population
structure is present. As such we would recommend caution when
applying our method to datasets in which multiple populations are
present, or selection is expected to have occurred. In the former
context, for example, it might be more appropriate to produce
new haplotypes for each subpopulation separately, by dividing
the data into its subpopulations and applying RECOAL to each
subpopulation in turn.

The existing version of RECOAL allows for ﬁne-scale variation
of recombination rates and for exponential growth of population
size. Extensions to other more complex demographic scenarios such
as bottlenecks and population admixture are also possible, and are
currently under development.

Finally, we also presented an extension of our method to
ascertained data in which the probability of ascertainment is a
function of allele frequency. Admixture is an extremely challenging
problem in coalescent methods and we note in passing that our
correction illustrates how sampling of an underlying coalescent
genealogy, condition upon observed polymorphism data, can be
adapted to respect such an ascertainment scheme.

Funding: National Institutes of Health (MH084678) and National
Science Foundation (HG005927), as well as improvements due to
comments received from the reviewers.

Conﬂict of Interest: none declared.

REFERENCES

1000 Genomes Project Consortium (2010) A map of human genome variation from
population-scale sequencing. Nature, 467, 106171073.

Barrett,J.C. et al. (2005) Haploview: analysis and visualization of 1d and haplotype
maps. Bioinformatics, 21, 2637265.

Eichler,E.E. et al. (2010) Missing heritability and strategies for ﬁnding the underlying
causes of complex disease. Nat. Rev. Genet, 11, 446450.

Hasegawa,M. et al. (1985) Dating of the human-ape splitting by a molecular clock of
mitochondrial dna. J. Mol. Evol., 22, l6&174.

Heard,E. et al. (2010) Ten years of genetics and genomics: what have we achieved and
where are we heading? Nat. Rev. Genet, 11, 7237733.

Hudson,R. (2002) Generating samples under a Wright-Fisher neutral model.
Bioinformatics, 18, 3377338.

Kang,C.J. and Marjoram,P. (2011) Inference of population mutation rate and
detection of segregating sites from next-generation sequence data. Genetics, 189,
5957605.

Kaplan,N.L. et al. (1988) The coalescent process in models with selection. Genetics,
120, 8197829.

Li,N. and Stephens,M. (2003) Modelling linkage disequilibrium, and identifying
recombination hotspots using SNP data. Genetics, 165, 22137223.

Neuhauser,C. and Krone,S.M. (1997) The genealogy of samples in models with
selection. Genetics, 145, 5197534.

Spencer,C.C.A. and Coop,G (2004) Selsim: a program to simulate population genetic
data with natural selection and recombination. Bioinformatics, 20, 367373675.
Spencer,C.C.A. et al. (2009) Designing genome-wide association studies: sample
size, power, imputation, and the choice of genotyping chip. PLoS Genet, 5,

61000477.

 

M3

113 /3.IO'S[1211an[pJOJXO'SOIJBLUJOJIIIOIqﬂIdllq mot} popeo1umoq

9103 0:; isnﬁnv uo ::

C.J.Kang and RMarjoram

 

Teshima,K. and Innan,H. (2009) mbs: modifying hudson’s ms software to generate
samples of dna sequences with a biallelic site under selection. BMC Bioinformatics,
10, 166.

The International HapMap 3 Consortium (2010) Integrating common and rare genetic
variation in diverse human populations. Nature, 467, 52758.

Vineis,P. and Pearce,N. (2010) Missing heritability in genome-wide association study
research. Nat. Rev. Genet, 11, 589.

Watterson,G.A. (1975) On the number of segregating sites in genetical models without
recombination. Therm Popn. Biol, 7, 2567276.

Wright,F.A. et al. (2007) Simulating association studies: a data-based resampling
method for candidate regions or whole genome scans. Bioinformatics, 23,
258172588.

 

844

113 /3.IO'S[1211an[pJOJXO'SOIJBLUJOJIIIOIqﬂIdllq mot} popeo1umoq

9103 0:; isnﬁnv uo ::

