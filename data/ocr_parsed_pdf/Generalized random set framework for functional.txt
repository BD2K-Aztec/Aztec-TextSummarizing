ORIGINAL PAPER

Vol. 27 no. 1 2011, pages 70—77
doi: 1 0. 1093/bioinformatics/btq593

 

Gene expression

Advance Access publication October 22, 2010

Generalized random set framework for functional enrichment
analysis using primary genomics datasets
Johannes M. Freudenbergl, Siva SivaganesanZ, Mukta Phatakl, Kaustubh Shinde1 and

Mario Medvedovic“

1Department of Environmental Health, University of Cincinnati College of Medicine, Cincinnati, OH 45267 and
2Mathematical Sciences Department, University of Cincinnati, Cincinnati, OH 45221, USA

Associate Editor: Olga Troyanskaya

 

ABSTRACT

Motivation: Functional enrichment analysis using primary genomics
datasets is an emerging approach to complement established
methods for functional enrichment based on predefined lists of
functionally related genes. Currently used methods depend on
creating lists of ‘significant’ and ‘non-significant’ genes based on
ad hoc significance cutoffs. This can lead to loss of statistical power
and can introduce biases affecting the interpretation of experimental
results.

Results: We developed and validated a new statistical framework,
generalized random set (GRS) analysis, for comparing the genomic
signatures in two datasets without the need for gene categorization.
In our tests, GRS produced correct measures of statistical
significance, and it showed dramatic improvement in the statistical
power over other methods currently used in this setting. We also
developed a procedure for identifying genes driving the concordance
of the genomics profiles and demonstrated a dramatic improvement
in functional coherence of genes identified in such analysis.
Availability: GRS can be downloaded as part of the R package
CLEAN from http://ClusterAnalysis.org/. An online implementation is
available at http://GenomicsPortals.org/.

Contact: mario.medvedovic@uc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 29, 2010; revised on October 4, 2010; accepted
on October 12, 2010

1 INTRODUCTION

Elucidating the functional signiﬁcance of differences in gene
expression, or of patterns of different gene expression regulatory
events in the context of existing knowledge about gene function has
not only become the most Challenging, but also the most rewarding
aspect of the genomics data analysis (Rhodes and Chinnaiyan, 2005).
The most commonly used strategy relies on sets of reference lists
containing functionally related genes, such as Gene Ontologies
(GOs; Ashburner et (11., 2000) and KEGG pathways (Kanehisa
and Goto, 2000), to identify functional categories enriched by the
differentially regulated genes.

Statistical methods and computational procedures for identifying
functionally related sets of genes that are associated with new

 

*To whom correspondence should be addressed.

experimental data have been studied in detail (Ackermann and
Strimmer, 2009; Newton et (11., 2007; Sartor et (11., 2009;
Subramanian et (11., 2005; Tian et (11., 2005). Two basic approaches
are used to establish statistical signiﬁcance of such enrichment.
The ﬁrst approach relies on counting the number of genes in a
given functional category that are also differentially expressed,
and using the Fisher’s exact or Chi-squared tests to establish the
statistical signiﬁcance of such overlaps. The inherent limitation
of this type of analysis is the requirement to Choose statistical
signiﬁcance cutoff levels for differential expression. This can reduce
the statistical power of the analysis (Ackermann and Strimmer,
2009; Newton et (11., 2007; Sartor et (11., 2009; Subramanian et (11.,
2005), and different threshold Choices may in some situations lead to
different enriched categories (Fan et (11., 2005). The second approach
uses the complete distribution of differential expressions of all
genes to identify enriched gene lists, without categorizing them
into differentially and non-differentially expressed. Statistically,
these methods use either rank-based Kolmogorov—Smirnov-like
tests (Subramanian et (11., 2005), or the traditional location shift tests
(Newton et (11., 2007; Sartor et (11., 2009; Tian et (11., 2005) to identify
lists of functionally related genes that are ‘more differentially
expressed’ than a randomly drawn list of genes of the same
length. Systematic performance assessments established that, in
general, ‘location shift’ methods using all data outperform Chi-
squared- and Kolmogorov—Smirnov-like methods (Ackermann and
Strimmer, 2009; Sartor et (11., 2009; Tian et (11., 2005). In a further
reﬁnement of this approach, the ProbCD methodology (Vencio
and Shmulevich, 2007) accommodates the use of the complete
distribution of differential expression as well as the probabilistic
rather than binary assignment of genes to functional categories such
as GO by using a probabilistic categorical data analysis approach.

Comparing a new, experimentally derived gene list to other,
predeﬁned lists of ﬁinctionally related genes, while widely used,
has its limitations. Despite the large number of such gene lists,
they are often not adequate for precisely Characterizing functional
consequences of experimentally derived genomics proﬁles. First,
functional relationship does not necessarily imply co-expression or
co-regulation. For example, only a fraction of genes associated with
the same GO term also exhibit coordinated gene expression (Wren,
2009). Consequently, a potentially large portion of genes belonging
to a functional category or pathway will never be informative about
the association between a genomics proﬁle and the pathway. Second,
gene lists associated with a biological concept or process are often
incomplete (Pena-Castillo et (11., 2008).

 

70 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bruno[p.IOJxosorwurJOJurorq”:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

GRS framework for functional enrichment analysis

 

The alternative is to use the vast array of public domain genomics
datasets currently available through major public repositories
(Barrett et (11., 2009; Parkinson et (11., 2009) to perform ﬁinctional
enrichment analysis by primary genomics data. In this approach,
newly generated genomics proﬁles are directly compared with
proﬁles from a large collection of reference genomics datasets.
Functional interpretation of new data is then based on phenotypic
Characteristics of the reference datasets that have concordant
genomics proﬁles. A number of methods use this approach including
EXALT (Yi et (11., 2007), expression-based pathway signature
analysis (EPSA; Tenenbaum et (11., 2008), GEMS (Li et (11., 2008)
and GEM-TREND (Feng et (11., 2009). A related strategy is to
identify a set of genes of interest and then search for datasets or
genomic proﬁles where these genes exhibit coherent expression
patterns (Caldas et (11., 2009; Hibbs et (11., 2007; Vazquez et (11.,
2010). Hibbs et (11. ( 2007) combine this strategy with a subsequent
search for additional genes that are Closely related to the query
set within the identiﬁed datasets. Previous methods to search for
genes correlated with a set of query genes (Owen et (11., 2003) had
not ﬁrst identiﬁed the related datasets. All these methods require a
set of query genes, essentially categorizing genes into ‘signiﬁcant’
and ‘non-signiﬁcant’ based on, for example, a ﬁxed signiﬁcance
threshold [e.g. false discovery rate (FDR)<0.1], which can result
in loss of statistical power as well as biases as is the case in the
traditional analysis of gene sets.

Here, we introduce a new statistical framework, generalized
random set (GRS) analysis, to assess the concordance in genomics
proﬁles between two datasets. GRS extends the random set (RS)
method for ﬁinctional enrichment analysis by gene lists (Newton
et (11., 2007) and does not require speciﬁcation of a signiﬁcance
cutoff for neither the query signature nor the reference datasets.
We ﬁrst describe our approach in detail and then compare our
new method to other existing procedures which employ primary
genomics data in this way. We ﬁnd that GRS outperforms the other
methods due in part to the loss of statistical power associated
with the categorization of genes that is necessary for the other
methods. GRS is implemented in the CLEAN R package (available
at http://ClusterAnalysis.org/), and the online version is available
through Genomics Portals (http://GenomicsPortals.org/) (Shinde
et (11., 2010).

2 METHODS
2.1 GRS analysis

Suppose that we calculated measures of differential expression and
associated statistical signiﬁcances for a set of genes G and let sg denote
a score measuring the level of differential expression for gene g to be used
in the analysis. Previously, we demonstrated that deﬁning sg as

sg = — log10(P-Valueg) (1)

is preferable over any other choice of differential expression scores in such
setting (Sartor at (11., 2009).

Let (1g be an index variable for the membership of each gene in a speciﬁc
functional category F .(1g is set to 1 if gene g is the member of the functional
category F and it is set to 0 otherwise:

I ‘f F
ch: 1‘6 (2)
O 1fg§éF

The RS statistics, measuring the overall level of differential expression for
genes in F, is deﬁned as the average score for the genes in F.

nggsg
ngg
Under the null hypothesis that there is no enrichment of differentially
expressed genes among the genes in category F, the RS statistics is
approximately distributed as the normal random variable with the mean

p. being equal to the average of sg over all genes and the variance being
derived using the simple delta method (Casella and Berger, 2001):

fr: (3)

X~N([1, 572), where

S
:3 g , and
W (4)

5.2:;(IGI—IFI) 
|F| lGl—l IGI IGI

This method (Newton at (11., 2007) can be applied to our problem by
simply using one genomics datasets to create the functional category F by
declaring only the genes that are differentially expressed for some cutoff, to
be members of the category F.

Now, suppose rather than discrete assignments of either ‘differentially’
or ‘non-differentially’ expressed for each gene, we have continuous
probabilities of differential expression for each gene g in two datasets
(pi, and 17%). These probabilities can be estimated based on the P-Values
for differential expression (Sellke at (11., 2001). To avoid the need for
categorizing genes into ‘signiﬁcant’ and ‘non-signiﬁcant’, we propose to
compute a statistic E12 by replacing the index variable (1g with pg, while the
score sg for the other dataset remains the same as deﬁned in Equation (1). In
order to ensure that the statistic remains the same regardless of the ‘query’
and ‘reference’ designation, we make the statistic symmetric with respect
to two datasets by also computing the statistic E21 in which the scores and
probabilities are reversed and then deﬁning the overall GRS statistic as the
average of the two:

 

,1:

 

 

E E
E: E, where
2
» ' (5)
Ep__ 2,717,274;
,,_—.
Esp/lg

Deﬁning E in this manner allows us to analytically derive the approximate
distribution for the test statistic Q, a standardized version of E, under the
null hypothesis of no concordance between the two datasets:

 

E_.
as: IGI< .ME).zE~N(0.1), where
UE

s1+ s2

ﬁEZZg g 2. g7 and (6)
2|G|

6,. 23535

That is, 65 is approximated using the multivariate delta method (Casella
and Berger, 2001) such that a: 1/2-(131—1jgg'71—1 ,1'72—1,§1132_1)’ and $3 is
the estimated wriancewovariance matrix of the random variable X:
(X1,X2,X3,X4)/, X1 =p1S2, X22171, X3 21723], and X4 2172. Details Of the
derivation can be found in the Supplementary Material.

2.2 Estimating probability of differential expression

We approximate the probabilities of differential expression based on the
P-Values of differential expression (Sellke at (11., 2001). The posterior
probability of a gene being differentially expressed is the l-posterior
probability of the null hypothesis and can be estimated as:

, where (7)

B
H H
ppdsl = 1 _ppd)st = 1— m

 

71

112 /3.Io's[Bruno[proixosorwuuoiurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

J.M.Freudenberg et al.

 

—e-P-Value-log(P-Value) if P-Value <e‘l
B: , (8)

1 if P-Value 3 e—
However, Equation (8) implies that, a priori, H0 and H1 are equally likely.
In other words, the proportion m0 of not differentially expressed genes is
assumed to be 0.5. Using the false discovery rate approach (Storey and

Tibshirani, 2003), we estimate m0 from the data and modify Equation (7) as

follows:
1

—l
1+(.::2. )

2.3 Identifying genes with concordant patterns

(9)

H1 _
ppm—1—

 

In addition to assessing the existence of the concordant gene expression
patterns, it is important to identify genes responsible for this concordance.
A straightforward way to rank genes based on the likelihood of concordance
is to use the scaled measure Eg of the individual contribution of gene g to

the GRS statistics:
2 2 1
lGl pésg pgsg
E = — + (10)
g 2 2gp; 23.17%

where |G| is the total number of genes.

We estimate the null distribution ong by ﬁrst randomly re-assigning gene
labels in both, the query and the reference signature and then re-computing Eg
for each gene. After repeating this procedure n times, the resulting quantiles
are averaged in order to describe the EIS. null distribution.

 

 

2.4 Data preprocessing, differential expression proﬁles
and gene matching

We use two primary breast cancer gene expression datasets (Miller et (11.,
2005; Schmidt et (11., 2008) and the collection of genome-wide expression
experiments systematically assessing small molecule perturbations in vitro
(‘Connectivity Map’) (Lamb et (11., 2006) in the analysis. Raw data are
preprocessed using the RMA normalization procedures (Irizarry et (11., 2003)
and the Entrez Gene-based custom CDFs (version 10) (Dai et (11., 2005).

Statistical signiﬁcance of differential expression between two groups of
samples [e. g. positive versus negative estrogen receptor status (ER+/ —)] is
assessed using empirical Bayes linear models (Sartor et (11., 2006; Smyth,
2004). An average expression signature for a given pair of conditions (e.g.
ER+ versus ER—) is computed as the per-gene average difference of log
expression levels between the conditions.

To match genes across datasets, platform-speciﬁc identiﬁers are ﬁrst
mapped to Entrez gene IDs (Maglott et (11., 2005) or, if the datasets are
from different species, to Entrez HomoloGene IDs. Next, average P-Values
(geometric mean) and expression measures (arithmetic mean) for each Entrez
ID are computed where necessary, and ﬁnally genes are matched across
datasets by Entrez ID.

2.5 Other methods to assess gene list concordance

We ﬁrst compared our GRS analysis to four other methods currently used to
identify concordant genomics proﬁles. All four procedures require subsetting
genes into ‘differentially expressed’ and ‘not differentially expressed’ using
a statistical signiﬁcance cutoff (Table 1). In addition, we compared GRS
with ProbCD (Vencio and Shmulevich, 2007), a related method that does
not require a signiﬁcance cutoff, but so far has not been used in this context,
as well as to more naive approaches such as using Pearson’s correlation or
the Wilcoxon rank test. The alternative methods are as follows.

EPSA (Tenenbaum et (11., 2008): EPSA was developed to identify
the relevant disease-related datasets among a large collection of publicly
available microarray data. The EPSA score is deﬁned as the Spearman’s
correlation coefﬁcient between average differential expression levels in the
Query and the Reference datasets for genes with statistically signiﬁcant
differential expression (FDR < 0.1) in the Query dataset. If none of the genes

Table 1. Methods included in the comparisons

 

 

Method (Reference) Similarity Signif. cutoff
measure
CS (Lamb et (11., 2006) Kolmogorov- 0.1 FDR (query)
Smirnoff
statistic

EXALT (Yi et (11., 2007) Signiﬁcance score 0.2 FDR (query & ref.)
ProbCD (Vencio et (11., 2007) Probabilistic Not required

categorization

EPSA (Tenenbaum et (11., 2008) Spearman’s 0.1 FDR (query)
correlation

LRpath (Sartor et (11., 2009) Logistic 0.1 FDR (reference)
regression

Wilcoxon rank test W statistic Not required

Simple correlation Pearson, Not required
Spearman

GRS Random set Not required
statistic

 

had statistically signiﬁcant differences in expression then the score is set to
zero.

EXALT (EXpression signature AnaLysis T001) (Yi et (11., 2007): EXALT
was developed to identify gene expression signatures, which in this case
consist of P-Values and differential expression levels for all genes, from
public databases such as gene expression omnibus (GEO) (Barrett et (11.,
2009) that are related to a user-deﬁned query signature based on the ‘total
identity score’ (TIS). First, genes are considered to be differentially expressed
if the FDR (‘Q-Value’) is less than 0.2. Each gene is then labeled either U
(upregulated), D (downregulated) or X (uncertain) in both the Query and
the Reference datasets. The TIS is the weighted sum of Q-scores (i.e. the
—log[Q-Value]) for concordant genes (UiU, DiD) minus the weighted sum
of Q-scores for discordant genes (UiD, DiU). Genes labeled X for either
one of the signatures do not contribute to the TIS.

ProbCD (Vencio and Shmulevich, 2007): this approach is designed to
address uncertainties in the assignment of genes to functional categories
such as the ones represented in GO (Ashburner et (11., 2000). The usual
association between rows and columns in a contingency table is generalized
using probabilities of group membership, and then an empirical P-Value of
the observed association is determined (Vencio and Shmulevich, 2007). Here,
we use the Query and Reference P-Values as input, respectively, with default
parameter settings and use the ProbCD P-Value to rank Reference sets.

CS (Connectivity score) (Lamb et (11., 2006): the CS is a widely used
non-parametric rank-based method to evaluate the similarity of a query
signature (i.e. a list of genes) and a number of reference signatures [e.g.
GSEA (Subramanian et (11., 2005), GEM-TREND (Feng et (11., 2009), SCSS
(Toyoshiba et (11., 2009) and MARQ (Vazquez et (11., 2010)]. Differentially
expressed genes in the Query dataset (FDR 5 0.1) are used as the query list
and tagged ‘up’ or ‘down’, respectively, based on their average expression
signature. The CS is then computed using the average reference expression
signature to compute a metric based on the Kolmogorovismirnov statistic
as described in Lamb et a1. (2006) which compares the ranks of the query
genes with the corresponding ranks in the reference signature.

LRpath (Sartor et (11., 2009): LRpath is a logistic regression-based method
to identify lists of biologically related genes (‘functional category’) that are
overrepresented in a query signature. It has also been recently applied to
assess gene list concordance (Shinde et (11., 2010). Instead of predeﬁned
functional categories, we use the list of differentially expressed genes in
the Query dataset (FDR 5 0.1). The LRpath P-Value is then computed as
described in the original publication by testing the differential expression
enrichment in the Reference datasets.

 

72

112 /3.Io's[BumoprOJXO'soueurJOJHrorq”:duq uron pepeo1umoq

9103 ‘1g15n8nv 110::

GRS framework for functional enrichment analysis

 

Wilcoxon signea1 rank test (Wilcoxon, 1945): this is a pairwise non-
parametric test. We rank pairwise comparisons of the Query and Reference
datasets by the respective W statistic assuming that datasets with the smallest
W statistic are the most similar.

Correlation coeﬁicients: we compute Pearson’s and Spearman’s
correlation between the Query and Reference datasets for both, P-values
and 710g transformed P-values. The higher the correlation coefﬁcients are
the higher is the concordance between the proﬁles.

2.6 Comparing GRS to other methods

To compare GRS to other methods, we test their ability to identify concordant
expression proﬁles deﬁned by the ER status of human primary breast tumors
between two independent datasets, as well as expression proﬁles deﬁned by
perturbations that are caused by a number of small molecules (Lamb et al.,
2006).

Breast cancer datasets (Miller et al., 2005; Schmidt et al., 2008): for each
iteration, we deﬁne a Query dataset of size 2N (N :2... 10) by randomly
selecting N samples without replacement among ER+ and N samples among
ER— samples in the Schmidt dataset (Schmidt et al., 2008). The Reference
datasets are constructed using samples from an independent primary breast
cancer dataset (Miller et al., 2005) and consist of a single Target that is
constructed in the same way as the Query dataset, and 20 Decoys for which
two groups of samples of size N are selected randomly from all remaining
samples. Using the eight different methods (Table 1), we compute respective
21 scores between the Query and Reference datasets and rank Reference
datasets based on these scores. We repeat this procedure 500 times for each N
(Fig. 1).

Connectivity map a'ataset (Lamb et al., 2006): here, we use the same
principle to generate Query and Reference sets except Decoy datasets that
are based on the true gene expression proﬁles for perturbants that are different
from the Query perturbant. For Query datasets, we randomly draw without
replacement a subset of size N from the pool of samples treated with the
same compound (e.g. estrodial, wortmannin, etc.) and then draw N samples
from the pool of corresponding control samples. For Target datasets, we
randomly draw without replacement a subset of size N from remaining pool
of samples treated with the same compound and from remaining controls,
respectively. For a Decoy dataset, we draw N samples from a sample pool
treated with a compound other than the query compound and N samples from
its corresponding controls.

Receiver operating characteristics: to compute the true positive rate
(TPR), we consider only the QueryeTarget pair a true match, any
QueryeDecoy pairing is considered false match. For a ﬁxed sample size,
we construct receiver operating characteristics (ROCs) curves based on the
rankings of each QueryeReference pair in 500 trials. For the ﬁxed ranking
threshold t (t: 1,  ,20), TPRs are deﬁned as the proportion of trials for

 

 

 

 

 

 

 

 

 

 

Query (Schmidt at at.
6;“ Nd IDSIIaﬂD Computing concordance scores
5‘ 3” Ir” between query and reference datasets
.' l.‘ l.‘
G? pun In3 - Generalized Random Set (GRS:
   - Wilcoxon test - LRpath
G", pv_._., Ir"J - Correlation - EPSA
- EXALT - ProbCD
Reference (Miller et at] - Connerm'vityr Score
Target Decors I
Gene p—val fr 0
G: W): Irn ' -.
G; W” II” % DmasetGRSLRp EPSR  Further
G] Wu ")1 B (I Ir" analysis
   5 d. (-r: I—I.
6.. m...  E  
a. d. r1.

 

 

 

     

 

 

Fig. 1. Computational study for assessing abilities of different methods to
distinguish between Target and Decoy datasets constructed from samples
in the Miller (Miller et al., 2005) dataset using the Query dataset based on
samples from the Schmidt (Schmidt et al., 2008) dataset.

which the rank of QueryeTarget score is less than t and false positive rates
are the average proportion of QueryeDecoy ranks less than t. In case of ties,
ranks are assigned randomly among the tied scores. For each sample size,
we construct ROC curves by varying t from 1 to 21, and summarize them
by calculating the area under each such ROC curves (AUC).

3 RESULTS

We implemented our new approach and the other methods listed in
Table 1 and performed a comparison study using expression data
from primary human breast cancers (Miller et (11., 2005; Schmidt
et (11., 2008) and the Connectivity Map (Lamb et (11., 2006). We then
evaluated each method based on their ability to correctly identify a
Target signature concordant with a Query signature among a number
of unrelated Decoy signatures. This approach allows us to estimate
the speciﬁcity and sensitivity of each method, while mimicking the
functional analysis by primary genomics data where the researcher
compares a new dataset (Query) to a diverse collection of existing
genomics datasets (References) in order to identify gene signatures
that are similar to the Query.

3.1 Evaluating GRS measures of statistical signiﬁcance

To assess how well our null distribution approximates the true
null distribution, we plotted the average cumulative distribution
of P-values for different sample sizes (Fig. 2) under the null
hypothesis of no concordance (dashed lines) and the alternative
hypothesis (solid lines). The distribution under the null hypothesis
was simulated by randomly permuting gene labels in the Decoy
datasets, while leaving the expression data intact. The cumulative
distribution of P-values under the null hypothesis fell on the diagonal
line indicating perfect control of the Type I error rate. Supplementary
Figure 1 shows the distribution of the GRS score under the
null hypothesis for increasing N using histograms (Supplementary
Fig. 1A) and quantile—quantile plots (Supplementary Fig. 1B)
indicating that the GRS score is approximately standard normal as
expected. Under the alternative hypothesis (solid lines in Fig. 2),

 

 

 

 

 

0. .'
E 00.
2: C)
3
:9
E ‘0.
13 c:
(D
e n-
3: C,- - r UnderHA solld
E W Under H0 dashed
J .
E N . i n = 5
3 O (I — n = 5
o , — n=7
0' 1 ' I nl=10 I
0.0 0.2 0.4 0.6 0.8 1.0
p-value

Fig. 2. Cumulative distribution of GRS P-values under the null hypothesis
(dashed) and Query versus Targets (solid) comparisons using the two breast
cancer datasets.

 

73

112 /3.Io's[BumoprOJXO'soueurJOJHrorq”:duq uron pepeo1umoq

9103 ‘1g15n8nv 110::

J.M.Freudenberg et al.

 

   
 

     
 

 

 

A o B E — EPSA
- - EXALT , ..... .-
50" m --- CS . '
£0 0 —- LRpth  g
ah. ah" GR?” 1
.3 c: Q o -
" 3
EV. . ' q I»
g ‘3 EPSA I25 "
e — - EXALT
,_
g- - --- cs 3
—- LFlpalh
0. . “' GHS |n_ _
o r: . .
C.U 0.2 0.4 0.6 0.8 1.3 2 it 6 3 10
False positive rate numbe' of samples
0 E D E- — Wilcoxon  GRS
-- Pearson _.-"
“3. 0!. -—- Spesiman - '
e '3 ‘3 —- ProbCD -- ‘1
m .
; “c. w. . ’f” I’d-F
3 E o 5' z"
E; _J /
Q s “ h. .
3: f — Wilcoxon o ,5} /
'— r\ / -- Pearson m 9 /
I33 [I -—- Spearman ‘25 ' /
—' ProbCD /
E . . '7' 693 . 2 ' . . . .
0.0 0.2 0.4 0.6 0.8 1.0 9 :1 G 8 1b

False positive rate

number ol samples

Fig. 3. ROC curves comparing the performance of different methods for the
breast cancer data (Miller et al., 2005; Schmidt et al., 2008). (A, C) Examples
of the ROC curves for a ﬁxed samples size (N :5). (B, D) Areas under the
ROC curves for different methods and sample sizes (N :2, 3,  , 10).

P-values were highly enriched by small P-values and enrichments
increased with the increased sample size indicating increasing
statistical power to detect the concordance.

3.2 Evaluating methods using subsampling of breast
cancer datasets

To compare our GRS approach to methods currently used for
assessing gene list concordance (EPSA, EXALT, Connectivity
Score and LRpath), we tested their ability to identify concordant
expression proﬁles deﬁned by the ER status of human primary
breast tumors among a number of Decoys. The analysis was
performed and ROC curves established for a series of sample sizes
N. Figure 3A shows the ROC curve for N :5. GRS (dashed line)
Clearly outperforms the other methods producing signiﬁcantly higher
TPRs for any given FPR. ROC curves were summarized for each
N by calculating the area under each such curve (Fig. 3B). Our
GRS method provided dramatic improvement in precision over four
alternative approaches which all rely on designating ‘differentially
expressed’ genes. For example, when N: 5, allowing 10% false
positives will, on average, resulted in 70% TPR for our GRS
method and only ~40% TPR for other methods (Fig. 3). Figure 3C
and D show similar ROC and AUC plots for the simple alternative
statistical methods that do not require signiﬁcance cutoffs. In this
case, GRS does not appear to outperform the Wilcoxon test and the
correlation coefﬁcients. To test if this result is due to the large number
of concordant genes in this particular situation, we re-labeled an
increasing number of randomly selected genes in the target signature
and computed the AUC (Supplementary Fig. 2). As the number of
‘scrambled’ genes increases, the AUC for the correlation methods
and the Wilcoxon test rapidly approach the 50% mark while GRS
remains relatively high even for 80% ‘scrambled’ genes.

   
    

 

 

 

 

A Q B o
no 3?.
n, D D
i
E «:2 0..
E D 0 a
's , :I
3 s. ,' ‘t r: .
in C? r O
E ' —- EXALT
1..
. in
g ._. c3 6 .
—- LRpath
0.. "* GRS 0..
o , . . D . . .
0.0 0.2 0.4 0.6 0.8 1.0 2 4 6 8 10
False positive rale number of samples
C D
.D.‘ E — Wilcoxon
-- Pearson
D. CPL -—- Spearman
iii 5' D —- ProbCD
a .
; .q Q _  GRS l.
:3" 0°  "
g , :> .-'
a s. “ r2.
5 ‘3 Wilcoxon D
l- N_ — — Pearson Q
0 -—- Spearman o
—- ProbCD
a  Gas 3 -.

 

oh 022 0.4 015 0:3 1:0
False positive rale

number of samples

Fig. 4. ROC curves comparing the performance of different methods for the
Connectivity Map data (Lamb et al., 2006). (A, C) Examples of the ROC
curves for a ﬁxed samples size (N = 5). (B, D) Areas under the ROC curves
for different methods and sample sizes (N22, 3,  , 10).

To evaluate the effect of Choosing the number of decoys (20) and
the number of trials (500), we repeated these experiments for GRS
for different numbers of decoys (Supplementary Fig. 3) and trials
(Supplementary Fig. 4). Increasing the number of decoys allows
us to increase the number of data points in the ROC curves, but it
does not affect the accuracy of ROC curves (Supplementary Fig. 3).
Similarly, increasing the number of trials does not affect the accuracy
of ROC curves but reduces the error associated with each data point
of ROC curve and consequently the AUC (Supplementary Fig. 4).
Finally, increasing the number of targets has no discernible effect
on the ROC curves (Supplementary Fig. 5).

3.3 Evaluating methods using the Connectivity Map

In this case, we tested the ability of different methods to identify
datasets generated by using the same ‘perturbant’ as used in the
Query dataset. This time, Decoy datasets were not formed based
on randomly permuted data, but based on the true gene expression
proﬁles for perturbants different from the Query perturbant. As with
the breast cancer data, GRS outperformed alternative methods across
all sample sizes, while all methods had increased statistical power
with increased sample size (Fig. 4). All methods performed worse
in this setting than in the breast cancer data. This is most likely due
to the fact that most Decoys in the breast cancer data are true decoys
since they are based on randomly permuted sample labels, whereas at
least some of the decoys generated in the Connectivity Map setting
could be similar to the Target as multiple perturbants can affect
the same biological processes and hence produce highly concordant
transcriptional signatures. It is also possible that transcriptional
signatures include fewer genes than the signatures distinguishing
ER+ from ER- breast tumors. In that case results are expected to
be similar to what we observe after re-labeling a certain portion

 

74

112 /3.Io's[sumoprOJXO'soueuiJOJHroiq”:duq uror} pepeo1umoq

9103 ‘1g15n8nv 110::

GRS framework for functional enrichment analysis

 

 

     
  

 

 

A8-
mm
2
(U
?o
0.53-
g —I— BCa(human)
no + Diets (Rat)
EE' —0— GenelevelGRS
“é
on
28- \
I
+/
O— i 'I I i 'I
sasrgweare
.H m
Nessa-5’s“
‘5 E ‘0 § 3 a: “Q ‘53: 3.35
-:-.-' a s as v .9 U
E' 0 o 6 a? g
c; s g z? .3
§ 0 .5; E 37

Fig. 5. Precision of functional analysis is greatly improved by combining
two proliferation-related datasets.

of genes in the breast cancer dataset as we did in the previous
section.

3.4 Identifying genes with concordant patterns

We examined the utility of the gene-level scores (Eg) to identify
genes associated with overlapping patterns of expression. As
an example, we used two gene expression datasets comparing
samples with different proliferation levels in two very distinct
biological systems: diets-induced differential proliferation in normal
rat mammary epithelium (Medvedovic et (11., 2009) and differential
proliferation of primary human tumors of different histologic grades
(Grade 3 versus Grade 1) (Schmidt et (11., 2008). The GRS indicated
the existence of a strong concordant gene expression signature
in the two datasets (GRS, P < 10_50). The functional analysis of
individual datasets using LRpath (Sartor et (11., 2009) against GOs
(Ashburner et (11., 2000) indicated the strong enrichment of cell-
cycle-related genes. Using LRpath with gene-level GRS scores (Eg)
as the independent variable, we compared the statistical signiﬁcance
of enrichment of top 10 GO terms with results based on individual
datasets (Fig. 5). All top 10 GO terms were cell-cycle related and
there was a dramatic increase in the statistical signiﬁcance of these
GO terms over the analysis of individual datasets. This indicates
that GRS analysis was able to effectively identify genes associated
with the concordant proﬁles in the two datasets and accentuate their
importance in the functional analysis.

3.5 Example: diets proliferation signature

To demonstrate how the GRS framework can be used to functionally
annotate a newly generated genomics dataset, we continue the

example shown in Figure 5 involving diets-induced gene expression
Changes in normal rat mammary epithelium (Medvedovic et (11.,
2009). First, we used our web interface (Shinde et (11., 2010) to
analyze a single reference dataset (query: dataset ‘BcercDiets’,
parameter ‘Diet’; reference: dataset ‘GSE11121Entrez’, parameter:
‘Grade 1’ versus ‘Grade 3’). The resulting gene list contained 7814
common genes where 123 (396) genes had a gene-speciﬁc GRS
score greater than the 99th (95th) percentile. These genes were
highly enriched for proliferation-related pathways, which can be
viewed by clicking on the corresponding link on the result page.
A heatmap for the top 396 genes showing the relative expression
levels for the two datasets can be found in Supplementary Figure 6.
A comparison with the distribution of absolute GRS scores among a
collection of 2980 human reference signatures obtained from GEO
(Barrett et (11., 2009) shows that 1.7% of all pairwise comparisons
between these signatures have a GRS score as high as or higher
than the observed score for the diets versus breast cancer signature
comparison (Supplementary Fig. 7). As a ‘negative control’ system
that is not related to increased proliferation, we use a signature
comparing estrogen (E2)-treated samples without ectopic expression
of the estrogen receptor (ESR1) to control samples (Moggs et (11.,
2005; GEO accession GDS1326). As expected, this signature
shows no concordance with the diet proliferation signature (GRS
score = 0.53, P = 0.59).

Next, we used the procedures implemented in the R to analyze
the 2980 GEO signatures and 3135 signatures derived from
Connectivity Map (Lamb et (11., 2006). Both reference sets yielded
concordant signatures with highly signiﬁcant GRS scores that
complement the proliferation-related functional annotations found
by traditional methods. The GEO reference datasets with the
most signiﬁcant scores include a comparison of mesenchymal
and proliferative cells in gliomas (accession GDS1815), breast
cancer cells with inactivated FOXMl transcription factor, and
(GDS1477) breast cancer cells affected by 17B-estradiol (GDS2324)
(Supplementary Table 1). The most concordant perturbation
signatures are caused by compounds (etoposide and methotrexate)
that are commonly used in cancer Chemotherapies and inhibit DNA
replication. The third most signiﬁcant compound (monobenzone)
also is a cytotoxin that is used for depigmentation therapy but its
working mechanism is not yet fully understood (Supplementary
Table 2).

4 DISCUSSION

We have developed a new method to assess the concordance of
gene signatures. The new method was compared with other existing
methods evaluating their ability to identify genomics datasets similar
to a query dataset based on their respective gene signatures. The
ultimate goal of such analysis is to use the phenotypic characteristics
of the identiﬁed reference sets to elucidate underlying molecular
functions of the genomic proﬁle in the new dataset. Comparisons
were made with methods speciﬁcally used in this context, as well
as alternative statistical methods that are applicable in this setting.
All of the currently used methods (EPSA, EXALT, CS and
LRpath) use a signiﬁcance cutoff to designate which genes are
differentially expressed in the Query dataset. However, the a priori
Choice of the optimal cutoff is a difﬁcult problem. A too restrictive
cutoff leads to a low number of genes in the signature, particularly
in experiments with small sample sizes. Choosing less restrictive

 

75

112 /3.Io's[sumoprOJXO'soueuiJOJHroiq”:duq uror} pepeo1umoq

910E ‘IE JSHBHV 110::

J.M.Freudenberg et al.

 

 

 

 

 

0.
CO

0) d

E“

a; ‘0.

.2 0

“E

as.

a: 0 _

3 .0’ a

ﬁ N l.) .o' + FDFI<0.1-set1
0‘ .o I." + p<0.01-set1

' .o' -l- FDR<O.1-set2

gt ' -0- p<0.01-se12

 

I

0.0 0.2 014 OIB 0:8 1.0
False positive rate

Fig. 6. Effect of signiﬁcance cutoff choice. In this example, we use
Connectivity Map data (Lamb et al., 2006) to compute the EPSA score
for two sets of Query and corresponding Reference signatures as described
(N :5) and compute the respective ROC curves. Query set 1 is a set of
compound-vehicle comparisons with a relatively large number of genes with
low P-values. Set 2 is a more ‘difﬁcult’ set of comparisons where the number
of differentially expressed genes for each signature and cutoff is lower. For set
1, the FDR cutoff results in a better ROC curve than for P-value cutoff (upper
two curves) while for set 2, the less conservative P-Value cutoff produces a
better ROC curve than the FDR cutoff (lower two curves).

cutoffs, on the other hand, often leads to high numbers of genes
in the signature which then results in reduced speciﬁcity when
computing the concordance measures. To illustrate the impact of
the cutoff Choice on subsequent concordance analyses, we used the
Connectivity Map data (Lamb et (11., 2006) to ﬁrst calculate the EPSA
score for two sets of Query and corresponding Reference signatures
as described (N :5) each time using (i) a stringent signiﬁcance
cutoff (FDR<0.1) and (ii) a less conservative one (P < 0.01). We
then computed the respective ROC curves (Fig. 6). Query set 1
is a set of compound-vehicle comparisons with a relatively large
number of genes with low P-values. Set 2 is a more ‘difﬁcult’ set
of comparisons where the overall number of signiﬁcant P-values is
lower for each signature and cutoff Choice (Supplementary Fig. 8).
In the former case, the FDR cutoff was the better Choice (i.e. the
ROC curve for the FDR cutoff is above the curve for the P-value
cutoff) as it resulted in Query signatures that were more informative
for the concordance assessment compared with a larger signature
based on a less-conservative cutoff containing many uninformative
genes. In the latter case, however, FDR proved to be too restrictive
not producing a sufﬁciently large gene signature and the P-value-
based cutoff was the better alternative still producing signatures with
informative genes. That is, ROC curves for set 2 overall are worse
than for the less ‘difﬁcult’ set 1 but the curve for the P-value cutoff
is above the non-informative ROC curve for the FDR cutoff in this
case (Fig. 6).

In an elegant theoretical analysis within their unifying RS
framework, Newton et (11. (2007) showed that in certain situations
(small number of very signiﬁcant genes), methods based on

categorizing genes can outperform methods that rely on the complete
expression proﬁles in the traditional enrichment analysis by gene
lists. While it is possible that this result holds in the context of
enrichment by primary data, our procedure indicates that it is
probably impossible to a priori deﬁne optimal signiﬁcance cutoffs
for assessing the concordance of gene signatures. Consequently,
one may always be better off using methods that do not rely on
deﬁning such cutoffs.

Alternative simple statistical methods that do not require
specifying statistical signiﬁcance cutoffs (correlation coefﬁcients,
Wilcoxon test) showed surprisingly strong performance in the breast
cancer datasets analysis, but performed worse than other methods
based on selecting differentially expressed genes (EPSA, EXALT,
CS and LRpath) in the more difﬁcult Connectivity Map data. Our
analysis in which we progressively remove the ‘signal’ by random
re-labeling of genes indicates that simple methods perform well
when most genes are differentially expressed, but their performance
deteriorates when only a fraction of genes are concordant. This
could be explained by the fact that if most genes are differentially
expressed and concordant, using all genes is better than losing many
informative ones due to imperfect statistical power of the differential
expression analysis. The fact that our GRS method performs as well
as, or better than, any other method in all settings implies that it
is capable of correctly weighing the contribution of different genes
based on the statistical signiﬁcance of their differential expression.
Our results indicate that simple methods utilizing complete gene
expression proﬁles (correlation, Wilcoxon) and methods that rely
on preselecting differentially expressed genes (EPSA, EXALT,
CS and LRpath) both have domains of superiority. However, our
procedure performs optimally in all settings and in difﬁcult situations
(such as the Connectivity Map data) Clearly outperforms all tested
alternatives.

Our method provides additional means to functionally annotate
newly generated genomics data exploiting the vast number of
datasets publicly available through repositories such as GEO (Barrett
et (11., 2009). It is readily available as part of the add-on R
package CLEAN (Freudenberg et (11., 2009) and through our web
interface Genomics Portals (Shinde et (11., 2010). The online version
(http://GenomicsPortals.org) facilitates the use of datasets uploaded
by the user as well as using any one of the >2000 primary genomics
datasets currently deposited in the Genomics Portals as query and
reference datasets.

Funding: National Human Genome Research Institute (R01
HG003749); National Library of Medicine (R21 LM009662);
National Institute of Environmental Health Sciences Center for
Environmental Genetics grant (P30 ES06096).

Conﬂict of Interest: none declared.

REFERENCES

Ackermann,M. and Strimmer,K. (2009) A general modular framework for gene set
enrichment analysis. BM C Bioinformatics, 10, 47.

Ashbumer,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology. The Gene
Ontology Consortium. Nat. Genet, 25, 25729.

Barrett,T. et al. (2009) NCBI GEO: archive for high-throughput functional genomic
data. Nucleic Acids Res, 37, D8857D890.

Caldas,J. et al. (2009) Probabilistic retrieval and visualization of biologically relevant
microarray experiments. Bioinformatics, 25, i1457i153.

Casella,G. and Berger,R.L. (2001) Statistical Inference. Duxbury Press.

 

76

112 /3.to's[sumoprOJXO'soueuiJOJHroiq”:duq uror} pepeo1umoq

910E ‘IE JSHBHV 110::

GRS framework for functional enrichment analysis

 

Dai,M. et al. (2005) Evolving gene/transcript deﬁnitions signiﬁcantly alter the
interpretation of GeneChip data. Nucleic Acids Res, 33, e175.

Feng,C. et al. (2009) GEM-TREND: a web tool for gene expression data mining toward
relevant network discovery. BM C Genomics, 10, 411.

Freudenberg,J.M. et al. (2009) CLEAN: CLustering Enrichment ANalysis. BMC
Bioinformatics, 10, 234.

Hibbs,M.A. etal. (2007) Exploring the functional landscape of gene expression: directed
search of large microarray compendia. Bioinformatics, 23, 269272699.

Irizarry,R.A. et al. (2003) Summaries of affymetrix GeneChip probe level data. Nucleic
Acids Res, 31, e15.

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and genomes.
Nucleic Acids Res, 28, 27730.

Lamb,J. et al. (2006) The Connectivity Map: using gene-expression signatures to
connect small molecules, genes, and disease. Science, 313, 192971935.

Li,Y. et al. (2008) Gene expression module-based chemical function similarity search.
Nucleic Acids Res, 36, e137.

Maglott,D. et al. (2005) Entrez Gene: gene-centered information at NCBI. NucleicAcids
Res, 33, DSLDS8.

Medvedovic,M. et al. (2009) Inﬂuence of fatty acid diets on gene expression in rat
mammary epithelial cells. Physiol. Genomics, 38, 8&88.

Miller,L.D. et al. (2005) From The Cover: An expression signature for p53 status in
human breast cancer predicts mutation status, transcriptional effects, and patient
survival. Proc. Natl Acad. Sci. USA, 102, 13550713555.

Moggs,J.G. et al. (2005) Anti-proliferative effect of estrogen in breast cancer cells that
re-express ER{ alpha} is mediated by aberrant regulation of cell cycle genes. J. Mol.
Endocrinol, 34, 5357551.

Newton,M.A. et al. (2007) Random-set methods identify distinct aspects of the
enrichment signal in gene-set analysis. Ann. Appl. Stat, 1, 857106.

Owen,A.B. et al. (2003) A gene recommender algorithm to identify coexpressed genes
in C. elegans. Genome Res, 13, 182871837.

Pan,K.H. et al. (2005) Effects of threshold choice on biological conclusions reached
during analysis of gene expression by DNA microarrays. Proc. Natl Acad. Sci. USA,
102, 896178965.

Parkinson,H. et al. (2009) ArrayExpress updateefrom an archive of functional genomics
experiments to the atlas of gene expression. Nucleic Acids Res, 37, D8687D872.

Pena-Castillo,L. et al. (2008) A critical assessment of Mus musculus gene function
prediction using integrated genomic evidence. Genome Biol, 9, $2.

Rhodes,D.R. and Chinnaiyan,A.M. (2005) Integrative analysis of the cancer
transcriptome. Nat Genet, 37 (Suppl), $31537.

Sartor,M.A. et al. (2009) LRpath: a logistic regression approach for identifying enriched
biological groups in gene expression data. Bioinformatics, 25, 2117217.

Sartor,M.A. et al. (2006) Intensity-based hierarchical Bayes method improves testing
for differentially expressed genes in microarray experiments. BMC Bioinformatics,
7, 538.

Schmidt,M. et al. (2008) The humoral immune system has a key prognostic impact in
node-negative breast cancer. Cancer Res, 68, 540575413.

Sellke,T. et al. (2001) Calibration of p-values for testing precise null hypothesis. Am.
Stat, 55, 62771.

Shinde,K. et al. (2010) Genomics Portals: integrative web-platform for mining
genomics data. BMC Genomics, 11, 27.

Smyth,G.K. (2004) Linear models and empirical Bayes methods for assessing
differential expression in microarray experiments. Stat. Appli. Genet. Mol. Biol,
3, Article 3.

Storey,J.D. and Tibshirani,R. (2003) Statistical signiﬁcance for genomewide studies.
Proc. Natl Acad. Sci. USA, 100, 944079445.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-based
approach for interpreting genome-wide expression proﬁles. Proc. Natl Acad. Sci.
USA, 102, 15545715550.

Tenenbaum,J. et al. (2008) Expression-based Pathway Signature Analysis (EPSA):
Mining publicly available microarray data for insight into human disease. BMC
Med. Genomics, 1, 51.

Tian,L. et al. (2005) Discovering statistically signiﬁcant pathways in expression
proﬁling studies. Proc. Natl Acad. Sci. USA, 102, 13544713549.

Toyoshiba,H. et al. (2009) Similar compounds searching system by using the gene
expression microarray database. Toxicol. Lett, 186, 52757.

Vazquez,M. et al. (2010) MARQ: an online tool to mine GEO for experiments
with similar or opposite gene expression signatures. Nucleic Acids Res, 38,
W2287W232.

Vencio,R.Z. and Shmulevich,I. (2007) ProbCD: enrichment analysis accounting for
categorization uncertainty. BM C Bioinformatics, 8, 383.

Wilcoxon,F. (1945) Individual comparisons by ranking methods. Biomet Bull, 1,
80783.

Wren,J.D. (2009) A global meta-analysis of microarray expression data to predict
unknown gene functions and estimate the literature-data divide. Bioinformatics,
25169441701.

Yi,Y. et al. (2007) Strategy for encoding and comparison of gene expression signatures.
Genome Biol., 8, R133.

 

77

112 /3.to's[sumoprOJXO'soueuiJOJHroiq”:duq uror} pepeo1umoq

9103 ‘1gisn8nv 110::

