Advance Access Publication Date: 4 November 2015

Bioinformatics, 3215), 2016, 789—791
doi:10.1093/bioinformatics/btv651

 

Applications Note

 

Phylogenetics

TESS: an R package for efficiently simulating
phylogenetic trees and performing Bayesian
inference of lineage diversification rates

Sebastian Hohna1'2'3'4'*, Michael R. May3 and Brian R. Moore3

1Department of Integrative Biology, 2Department of Statistics, University of California, Berkeley, CA 94720, USA,
3Department of Evolution and Ecology, University of California, Davis, CA 95616, USA and 4Department of

Mathematics, Stockholm University, Stockholm, SE-106 91, Sweden

*To whom correspondence should be addressed.
Associate Editor: David Posada

Received on June 19, 2015; revised on October 29, 2015; accepted on October 30, 2015

Abstract

Summary: Many fundamental questions in evolutionary biology entail estimating rates of lineage di—
versification (speciation—extinction) that are modeled using birth—death branching processes. We le—
verage recent advances in branching—process theory to develop a flexible Bayesian framework for
specifying diversification models—where rates are constant, vary continuously, or change episodic—
ally through time—and implement numerical methods to estimate parameters of these models from
molecular phylogenies, even when species sampling is incomplete. We enable both statistical infer—
ence and efficient simulation under these models. We also provide robust methods for comparing the
relative and absolute fit of competing branching—process models to a given tree, thereby providing
rigorous tests of biological hypotheses regarding patterns and processes of lineage diversification.

Availability and implementation: The source code for TESS is freely available at http://cran.r—pro

ject.0rg/web/packages/TESS/.
Contact: Sebastian.Hoehna@gmail.com

 

1 Introduction

Stochastic-branching process models (e.g. birth—death models) describe
the process of diversification that gave rise to a given study tree, and in-
clude parameters such as the rate of speciation and extinction.
Statistical analysis of lineage diversification rates involves: (i) simulat-
ing trees under null and alternative hypotheses; (ii) estimating param-
eters in, e.g. a Bayesian framework, and; (iii) evaluating the relative
and absolute fit of candidate models. These considerations motivated
our development of TESS, an R package for statistical inference of lin-
eage diversification rates that allows researchers to address three fun-
damental questions: (i) What are the rates of the process that gave rise
to my study tree? (ii) Have diversiﬁcation rates changed through time
in my study tree? (iii) Is there evidence that my study tree experienced
mass extinction? We compare TESS to other software in the accom-
panying vignette (http://cran.r-project.org/web/packages/TESS/).

2 Methods and algorithms

2.1 Branching—process models

Inferring rates of lineage diversification is based on the recon-
structed evolutionary process described by Nee et al. (1994); a
birth—death process in which only sampled, extant lineages are
observed. Our implementation exploits recent theoretical work
(Hohna, 2015) that allows the rate of diversification to be specified
as an arbitrary function of time (but is constant across lineages at
any instant). By adopting this generic approach, we can specify an
effectively infinite number of branching-process models in TESS.
These possibilities correspond to four main types of diversification
models: (i) constant-rate birth—death models; (ii) continuously
variable-rate birth—death models; (iii) episodically variable-rate
birth—death models, and; (iv) explicit mass-extinction birth—death

models.

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 789

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

_E,_s..l

Leslie et al. (2012)

Hohna, 2013

etal., 2011 Hohna, 2014

Fig. 1

Hohna

Haario et a[., 1999

and Raftery, 1995

2011

1996

May et a[., 2015

Fig. 2

Fig. 1

Kass

Xie et al.,
Lartillot and Philippe, 2006

Gelman et a[.,

Moore et a[., 2004

Green, 1995

/810'spzumo_fp10}xo"soiJBmJOJHiOiW/zdnq

TESS

791

 

under and/or infer parameters of these models. Additionally, TESS pro—
vides robust methods for assessing the relative fit of competing models
to a given tree, providing users with an extremely ﬂexible yet intuitive
framework for testing hypotheses regarding the patterns and processes
of lineage diversification. TESS is accompanied by a comprehensive vi—
gnette that provides detailed explanations of the methods and ex—
amples (http://cran.r—project.org/web/packages/TESS/).

Conflict of Interest: none declared.

References

Gelman,A. et al. (1996) Posterior predictive assessment of model ﬁtness Via
realized discrepancies. Stat. Sin., 6, 733—807.

Green,P. (1995) Reversible jump Markov chain Monte Carlo computation
and Bayesian model determination. Biometrilza, 82, 711.

Haari0,H. et al. (1999) Adaptive proposal distribution for random walk
Metropolis algorithm. Compnt. Stat., 14, 375—396.

Hohna,S. (2013) Fast simulation of reconstructed phylogenies under global
time-dependent birth—death processes. Bioinformatics, 29, 1367—1374.

Hohna,S. (2014) Likelihood inference of non-constant diversiﬁcation rates
with incomplete taxon sampling. PLoS One, 9, e84184.

Hohna,S. (2015) The time-dependent reconstructed evolutionary process with
a key-role for mass-extinction events. Theor. Biol., 380, 321—331.

H6hna,S. et al. (2011) Inferring speciation and extinction rates under different
species sampling schemes. Mol. Biol. Evol., 28, 2577—2589.

Kass,R. and Raftery,A. (1995) Bayes factors. ]. Am. Stat. Assoc., 90, 773—795.

Lartillot,N. and Philippe,H. (2006) Computing Bayes factors using thermo-
dynamic integration. Syst. Biol., 55, 195.

Leslie,A.B. et al. (2012) Hemisphere-scale differences in conifer evolutionary
dynamics. Proc. Natl. Acad. Sci. USA, 109, 16217—16221.
May,M.R. et al. (2015) A Bayesian approach for detecting mass-extinction
events when rates of lineage diversiﬁcation vary. Systematic Biology, in press.
Moore,B.R. et al. (2004) Detecting diversiﬁcation rate variation in supertrees.
In: Bininda—Emonds,O.R.P. (ed.) Phylogenetic Supertrees: Combining
Information to Reveal the Tree of Life, pp. 487—533. Kluwer Academic
Press, Dordrecht, The Netherlands.

Nee,S. et al. (1994) The reconstructed evolutionary process. Philos. Trans.
Biol. Sci., 344, 305—311.

Xie,W. et al. (2011) Improving marginal likelihood estimation for Bayesian
phylogenetic model selection. Syst. Biol., 60, 150—160.

ﬁm'sreumol‘pquo'sopeuuopttotq/ﬁdnq

