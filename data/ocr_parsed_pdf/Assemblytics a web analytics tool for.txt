Bioinformatics Advance Access published July 6, 2016

Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw369

Advance Access Publication Date: 17 June 2016
Applications Note

 

Genome analysis

Assemblytics: a web analytics tool for the
detection of variants from an assembly

Maria Nattestad1'* and Michael C. Schatz1'2

1Cold Spring Harbor Laboratory, Simons Center for Quantitative Biology, Cold Spring Harbor, NY, USA and
2Department of Computer Science, Johns Hopkins University, Baltimore, MD, USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on March 20, 2016; revised on May 20, 2016; accepted on June 7, 2016

Abstract

Summary: Assemblytics is a web app for detecting and analyzing variants from a de novo gen—
ome assembly aligned to a reference genome. It incorporates a unique anchor filtering approach
to increase robustness to repetitive elements, and identifies six classes of variants based on their
distinct alignment signatures. Assemblytics can be applied both to comparing aberrant genomes,
such as human cancers, to a reference, or to identify differences between related species.
Multiple interactive visualizations enable in—depth explorations of the genomic distributions of

 

variants.

Availability and Implementation: http://assemblytics.com, https://github.com/marianattestad/

assemblytics
Contact: mnattest@cshl.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

De novo genome assembly is becoming increasingly tractable on
large genomes due to advances in long—read sequencing and map—
ping. This is leading to a greater quality and quantity of reference
genomes across the tree of life (Lee et (11., 2014; Roberts et (11.,
2013). Researchers can now sequence and assemble the genomes of
several related strains or species in order to compare them. This is a
vast improvement over more common resequencing approaches
where sequencing reads are aligned to a single reference genome,
often allowing only SNPs or short indels to be identified. Now that
increasing numbers of high—quality genome assemblies are available,
there is a need to detect the large structural variants that mark im—
portant differences between these genomes. For example, there may
be more than 10 000 structural variations representing megabases of
genetic diversity present per human genome (see below).
Assemblytics builds on the innovations of the whole genome align—
ment suite MUMmer (Kurtz et (11., 2004) in order to detect and ana—
lyze these variants.

2 Methods

Assemblytics analyzes the alignments from MUMmer’s nucmer pro—
gram to identify high—confidence structural variants in each se—
quence (contig) in the sample relative to a reference or another
de novo assembly. It begins by using a plane—sweep algorithm to
quickly identify all overlapping alignments with respect to the sam—
ple. It then filters the alignments to report those with at least a min—
imum amount of unique contig sequence anchor (default: 10 kbp)
contained in no other alignments of that contig. This is similar to
the filtering performed by delta-filter component of dnadiff
(Phillippy et (11., 2008), although guarantees uniqueness of the align—
ments while dnadiff may select equally matching repetitive align—
ments arbitrarily (Supplementary Note 1).

The variant identification algorithm then considers each pair of
consecutive alignments along a sample contig, determining variant
presence and class by the spacing and orientation between these
alignments. Assemblytics identifies all insertion and deletion vari—
ants as small as 1 bp up to a maximum of 10 kbp in size, with this

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1

91oz ‘Og JSanV uo seleﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOlJBLUJOJIIlOlq”K1111] 11101} popcolumoq

M. Nattestad and M. C. Schatz

 

reference

.lIlllll

conﬁ:

      
    

between alignments

 

 

we“
Insertion Deletion
refunmw reference
Deﬁned pclnt 1
m

Tandem Contractions

Tandem Expansions

Overlapping
alignments suggest
tandem repeat

   

Repeat Expa nsiuns

Repeat Contractions

Gap where sequences flfel'ence
do not align uniquely
suggests a repeat
‘ 5 I .

 

 

Dmvdelh her-rein uﬂmd

 

Arabidopsis thaliana MHAP assembly

5.; L,

   :   

 

rr'

 

I

interactive out plat

an me an Initial” mu- .Dng am “we: mmgmm Download mm mm and an be used m mﬂulluls 2 u.
A=§nlrl1lyﬂr5

Fig. 1. (A) Schematic illustrating how variants are called between consecutive alignments of a contig to the reference as well as within alignments. Each variant
class is characterized by the degree of gap and/or overlap between alignments. (B,C) Screen shots of the Assemblytics web interface including output plots.
Additional screen shots in Supplementary Note 3 show summary tables, variant file preview and ability to download all data including the Assemblytics unique

anchor filtered delta file

maximum adjusted to match the size of the unique sequence anchor.
This prevents translocations and complex variants from being inter—
preted as indels. Variants from multiple alleles are reported inde—
pendently and tagged with contig of origin. Figure 1A illustrates the
differences between variant classes. Tandem and repeat expansions
are insertions taking place within tandem and repeat sequences, re—
spectively, while tandem and repeat contractions are deletions
within these elements. Insertions and deletions are characterized by
a defined breakpoint (less than 50bp overlap or gap) on one side.
Tandem variants occur between overlapping alignments (over
50bp). Repeat variants occur within unmappable gaps between
alignments. The individual alignments are also scanned to detect in—
sertions or deletions spanned by the alignment. Finally variant
classes, size distributions, and genomic coordinates of all variants
are summarized through plots and tables, as well as an interactive
dot plot of alignments (Fig. 1B and C). Supplementary Note 3 pro—
vides more details on the web interface.

3 Results

We first evaluated the accuracy of the variation detection by apply—
ing Assemblytics to analyze simulated structural variations within
the human genome (Supplemental Note 2). To do so, we created a
modified version of the human genome with simulated insertions
and deletions embedded at known positions, and then aligned both
the original unmodified reference genome and the human genome
assembled by MHAP presented by Berlin et a1. (2015) to this modi—
fied reference. Our results show that Assemblytics is able to cor—
rectly identify the vast majority of variants present (90.9—99.9%
recall) and with very low false positive rates (0.29—0.40%).

We next applied Assemblytics to all five de novo assemblies (human,
D.melanogaster, Atloaliana, S.cerevi$iae and E.coli) presented by Berlin
et a1. (2015) to their respective reference genomes (Supplementary Note
4). In each case, the genome was analyzed in less than 5 min and the
full interactive results are available on the Assemblytics website. All
assemblies showed a large number of structural variations, proportional
to the size of the genome and the sizes of the events approximated a
log—normal distribution with a long tail of large events. Drosophila was
a notable exception with a relatively small number of variants identi—
fied, with only 204 compared to 2501 for Athaliana of similar size.
This was because the assembly was derived from the same inbred popu—
lation as the original reference (ISO1). In the case of the human analysis,
Assemblytics reported 11 206 structural variations spanning over 7.0
Mb. This included a noticeable enrichment for N320 bp insertions and
deletions which we characterized as novel Alu variants.

4 Discussion

Assemblytics allows researchers to take advantage of high—quality
genome assemblies for detecting structural variation between species
or even between aberrant and normal genomes in human disease.
Here we applied Assemblytics to study 5 de novo assemblies pro—
duced using MHAP from PacBio reads, although it is capable of
exploring assemblies produced by any algorithm and sequencing
technology, including local assemblies. The accuracy of variant calls
depends on the qualities of both assembly and reference genome as
well as the accuracy of the whole genome alignments. A key advan—
tage of Assemblytics is unique length filtering which disregards
alignments that are not anchored in a significant amount of unique
sequence. This provides a conservative filter, similar to requiring

91oz ‘Og JSanV uo seleﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[BHmOprOJXO'SOIJBLUJOJIIIth/ﬂduq 11101} pepeolumoq

Assemblytics

 

high mapping quality for read alignment, something that was not
previously available for genome—genome alignments.

Acknowledgements

We thank Jason Chin, Adam Phillippy, Art Delcher, W. Richard McCombie,
Fritz Sedlazeck and James Gurtowski for their helpful discussions and testing.

Funding

National Science Foundation DBI—1350041 and National Human Genome
Research Institute R01—HG006677.

Conﬂict of Interest: none declared.

References

Berlin,K. et al. (2015) Assembling large genomes with single—molecule
sequencing and locality—sensitive hashing. Nat. Biotechnol., 33,
623—630.

Kurtz,S. et al. (2004) Versatile and open software for comparing large gen-
omes. Genome Biol., 5, R12.

Lee,H. et al. (2014) Error correction and assembly complexity of single mol-
ecule sequencing reads. bioinv. (doi: http://dx.doi.org/lo.1101/006395).
Phillippy,A.M. et al. (2008) Genome assembly forensics: ﬁnding the elusive

mis—assembly. Genome Biol., 9, R55.

Roberts,R.J. et al. (2013) The advantages of SMRT sequencing. Genome
Biol., 14, 405.

9103 ‘Og isanV uo seleﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'sleu1nofp103xo"sotJBuiJOJutotq/ﬁduq 11101} pepeolumoq

