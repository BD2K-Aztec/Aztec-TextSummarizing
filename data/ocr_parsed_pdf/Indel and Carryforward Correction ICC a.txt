BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Indel and Carryfom/ard Correction

 

to ensure that no rare variants are lost. Indel and Carryforward
Correction (ICC) provides a complete suite for users to analyze
pyrosequencing data, including read quality filtering and align—
ment, indel and carryforward error correction, variant calling
and calculation of single nucleotide variant and haplotype fre—
quencies. To determine the efﬁciency of ICC in correcting errors,
we calculated and compared error rates before and after ICC
correction on datasets derived from previously sequenced plas—
mid DNAs. Using pyrosequencing data of PCR fragments
derived from a mixture of 15 HIV—1 plasmid clones at various
frequencies, we used ICC to estimate sensitivity and specificity
and compared these results with several other commonly used
error correction and variant calling algorithms.

2 SAMPLE PREPARATION AND
PYROSEQUENCING

2.1 Control datasets

pNL4—3, a plasmid containing a full—length HIV—1 genome, served
as a control for pyrosequencing error calculations and compari—
sons. Two sets of first round PCR products were generated with
primers that targeted portions of the gag—p01 genes to produce a
2.6 kb amplicon and the env gp120 coding sequence for a 2.1 kb
amplicon. Nested second round PCR reactions were multiplex
PCRs that generated four amplicons (gag3, poll, env3 and env5)
from the mixture of two ﬁrst round products that ranged from 391
to 597 bp in size with primers containing the 454 sequencing adap—
ter and Multiplex Identiﬁer (MID) adapter (Supplementary
Table S1). PCR reactions are described in supplementary data.

2.2 HIV-1 plasmid mixture

Fifteen HIV—1 plasmid clones (Rousseau et al., 2006) were mixed
to reach the ﬁnal proportions (Supplementary Table S2), with
individual DNA concentrations determined using a Nanodrop
instrument (Thermo Scientific, USA). The plasmid mixture was
further quantiﬁed by limiting dilution endpoint PCR (Rodrigo
et al., 1997) with the program Quality (http://indra.mullins.
microbiol.washington.edu/quality/). An estimated maximum of
1000 (691 :I: 310) plasmid molecules were used as templates for
PCR ampliﬁcation and subsequent pyrosequencing. Primers and
nested PCR conditions were the same as for pNL4—3 mentioned
previously (and see Supplementary Data).

2.3 HIV-1 clinical sample

RNA was extracted from ﬁve plasma specimens from one HIV—1
infected individual from the Seattle Primary Infection Cohort
(Schacker et al., 1996; Stekler et al., 2012) using the QIAamp
Viral RNA Mini Kit (Qiagen, Valencia, CA) according to the
manufacturer’s protocol. A total of 560 pl of plasma was ex—
tracted in each case and eluted in 80 ul of elution buffer.
cDNA was synthesized using Takara BluePrint First
Strand Synthesis Kit (Clontech 6115A) according to the manu—
facturer’s protocol. cDNA was synthesized with gene speciﬁc
primers, R3337-1 (5/-TTTCCYACTAAYTTYTGTATRTCAT
TGAC—3/) for gag-p01 and R9048 (5/-AGCTSCCTTGTAA
GTCATTGGTCTTARA—3’) for gp120, at final concentrations
of 400 nM. Fragments of gag—p01 (2.6 kb) and env (2.1 kb) were

ampliﬁed in ﬁrst round reactions separately, then mixed together
and used as template for multiplex second round ampliﬁcation of
a 505 bp gag and a 597 bp env fragment (gag3 and env5)
(Supplementary Table S1). PCR ampliﬁcations are described in
supplementary data.

PCR products were visualized using a Qiaxcel (Qiagen, USA),
puriﬁed using Agencourt AMPure beads (Beckman Coulter,
USA) and then pyrosequenced on the 454 Life Sciences GS—
FLX Titanium platform according to the manufacturer’s
protocols.

3 ALGORITHM
3.1 Multiple sequence alignment

Sequences in a user—deﬁned window were aligned using the
NeedlemaniWunsch algorithm (Needleman and Wunsch, 1970).
First, sequences were collapsed so that only unique sequences
were presented, and unique sequences were ranked by their abun—
dance. The two most abundant unique sequences S 1 and 52 were
pairwise aligned using dynamic programming (Gusﬁeld, 1997):

I; ls<—, we» a = 0)
E 'E/

2 some), —> (1' = 0)
V0.1) = 1516' (1)

V(i — 1,j— 1) +s(Sl(i), 52(1))
max V(i — l,j) + 561(1), —)
V03] — 1) + S(—, 520))

V(i,j) is defined as the value of the optimal alignment of preﬁxes
Sl[1..z] and SZ[1..J]. s(x,y) denotes the score obtained by aligning
character x against character y. Second, the proﬁle of the align—
ment was computed, taking into account the abundances of the
aligned unique sequences. The third most abundant unique
sequence was then aligned to the proﬁle, which produced a
new multiple sequence alignment including the first three most
abundant unique sequences:

Azse k) (i = 0)
'E/
. _ gawk), —> 0' = 0)
V04) 2 V(i I1, j — 1) + S(Sl(i),j) (2)
max V(i — 1,j)+ 5(510), —)

V(i-j — 1) + 5(—,j)

V(i,j) denotes the value of the optimal alignment of preﬁx
Sl[1..z] with the ﬁrst j columns of the proﬁle. For a character y
and column j, let p(y,j) be the frequency that character y appears
in column j of the proﬁle; S(x,j) denotes Z", [s(x, y) x p(y,j)], the
score for aligning x with column j. The process of calculating the
profile of the newly produced multiple sequence alignment and
aligning the next most abundant unique sequence to the updated
profile was repeated until the last unique sequence was aligned.
The default scoring parameters for alignment were as follows:
match, 10; mismatch, —9; gap penalty, —15.

3.2 Computing sequence similarity and edit transcript

The similarity of two sequences, and associated optimal align—
ment and edit transcript, can be computed by dynamic program—
ming (Gusﬁeld, 1997). An edit transcript is a string over the

 

2403

ﬁre'spzumofpmJXO'sopeuuopnorq/ﬁdnq

tdll lrumrrl

 

n .. 1 abui’ldant rea
Indr—I dlﬁ

p15 betv
r programming

n dismbunnn

 

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

Indel and Carryfom/ard Correction

 

abundant sequence are clustered together with the most
abundant sequence. Finally, after correcting homopolymer
and non—homopolymer indels, carryforward errors are cor—
rected by clustering sequences only showing carryforward
patterns.

(iv) Variant calling and proﬁling: A Poisson probability model
approximates the expected distribution of mismatch error
rates to distinguish sequencing errors from authentic
minor variants (Wang et al., 2007). The nucleotide variant
frequencies at each site across the reference sequence are
calculated. Local haplotypes in each window are con—
structed by the most abundant/consensus sequence in
each cluster. The cluster size is interpreted as the haplotype
frequency in the population.

4.2 Error rate calculation

Pyrosequencing reads that served as the control for error rate
calculations were processed by read quality ﬁltering [step (i) men—
tioned previously]. The remaining qualiﬁed reads were aligned to
the pNL4—3 reference sequence using BLASTN with the align—
ment parameters as followsimatch reward, 1; mismatch pen—
alty, —1; gap existence, 1; gap extension, 2. Each type of error rate
(number of errors/total number of mapped reference bases) was
calculated by parsing the BLASTN output file, categorized by
insertion, deletion and mismatch.

5 RESULTS AND DISCUSSION

5.1 Efﬁciency of sequencing error correction

To characterize the frequency of pyrosequencing errors and de—
termine the efficiency of the ICC method in correcting errors, we
sequenced a control dataset of six PCR—derived amplicons from
the HIV—1 gag, pol and env genes within the pNL4—3 plasmid. We
compared these reads with the Sanger—derived sequence of the
clone. Table 1 shows the comparison of sequencing error fre—
quencies of the six amplicons before and after error correction
by ICC. These errors include both those introduced by PCR and
those introduced during pyrosequencing. Overall error frequen—
cies were reduced by 93795%, whereas the frequencies of inser—
tion and deletion errors were reduced by 98799%, and mismatch
errors were reduced by 48771%, the latter due to correction of

Table 1. Comparison of error rates before and after ICC

carryforward errors because no substitution mutations were cor—
rected (see Section 5.2 later in the text).

We also applied ICC to data from an individual (PIC64236)
with HIV—1 infection. We pyrosequenced PCR—derived ampli—
cons from the viral gag and env genes found in the patient at
ﬁve different time points, and we analyzed variants by their fre—
quency. Table 2 shows the analysis of one of the amplicons
(gag3, 383 bp with primers trimmed). ICC reduced the number
of variable sites by an average of 84%, and the overall trend was
as expected for early HIV infection, with a slightly higher level of
diversity early and then increasing diversity through time
(Herbeck et al., 2011).

5.2 Correction of carryforward errors

The 454 pyrosequencing is known to be particularly prone to
errors in homopolymeric regions due to carryforward and in—
complete extension errors (Margulies et al., 2005). Incomplete
extension refers to a homopolymer that is not completed due
to insufﬁcient local nucleotide concentrations within a ﬂow.
Carryforward errors occur when reagent ﬁushing between the
ﬂows is insufﬁcient, and leftover nucleotides are introduced
near but not adjacent to homopolymers. With commonly used
parameters for alignment, including the settings we used, one
carryforward error was usually interpreted as two mismatches
when aligned to the reference sequence. Because most carryfor—
ward errors were found immediately 3/ to homopolymers, we
investigated carryforward errors as a function of homopolymer
length using the same control dataset of six amplicons.
Carryforward errors increase as the length of the homopolymer
increases, with a large increase noted with homopolymers of 6 nt
in length (mean rate increased from 0.03 to 1.3% as homopoly—
mer length increased from 3 to 6) (Fig. 3). According to these
results, we conservatively corrected carryforward errors when
found in up to 5% of reads. However, users can set different
cutoff values. Because ICC does not correct mismatches, the re—
duction in mismatch errors noted above is attributable solely to
the correction of carryforward errors.

5.3 Comparison with other error correction and variant
calling algorithms

We used several other error correction and variant calling pro—
grams to process our control datasets: V—Phaser (Macalalad

 

Before correction

After correction

 

 

Amplicon Size Reads passing Insertion Deletion Mismatch Overall Insertion Deletion Mismatch Overall
(bp) quality ﬁlter (W (W (%) (%) (W (W (%) (%)
Run3 gag3 383 16 987 0.2017 0.1242 0.0412 0.3671 0.0041 0.0011 0.0146 0.0198
Run3 poll 317 22 456 0.29 0.0358 0.0305 0.3563 0.0027 0.0005 0.0097 0.0129
Run3 env3 269 21271 0.2131 0.0299 0.0297 0.2727 0.0011 0.0001 0.0135 0.0147
Run3 env5 443 20 593 0.1915 0.1585 0.0432 0.3932 0.0032 0.003 0.0125 0.0187
Run4 gag3 383 8247 0.1602 0.055 0.0282 0.2434 0.0017 0.0008 0.0144 0.0169
Run4 poll 317 12 001 0.1348 0.0729 0.0254 0.2331 0.0024 0.0009 0.0131 0.0164

 

 

2405

ﬁre'spzumofpmJXO'sopeuuopnorq/ﬁdnq

an?kgogmomammowoio~&o:3m7.omm\

.n
t
g
n
b
r
e
m
N.
o
a.
o
m
D
H

0.00001

3.: Btw Ema—LE.»th

 

Raw hen-mm

Fquui-rnzy

E2 I II

AGCCTGACTG   :  .:  '1;0,-1.-1,0:1,0,0,-1 (In

AGCATGACTG <—> n 1,0,1:D..D,1,0:0,1,0,0:1,0,0,1:0,l,1,0:1,0,0.1 t'lll']

 

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂdnq

W.Deng et al.

 

Table 5. Error frequency by type and sequence context

 

Amplicon Type

Context

 

Insertion (%) Deletion (%)

Mismatch (%)

Non-homopolymeric
mismatch (%)

Homopolymeric
mismatch (%)

Overall (%)

 

Run3 gag3 0.2861 0.1535 0.0121
Run3 poll 0.3496 0.0678 0.0114
Run3 env3 0.261 0.04 0.0125
Run3 env5 0.3254 0.19 0.014

Run 4 gag3 0.2134 0.082 0.0141
Run4 poll 0.1729 0.1042 0.0127
Average 0.2681 0.1063 0.0128

0.4517 0.0097 0.02
0.4288 0.0115 0.011
0.3135 0.0138 0.0039
0.5294 0.0134 0.0171
0.3095 0.0151 0.011
0.2898 0.0135 0.0097
0.3871 0.0128 0.0121

 

applied in other next—generation sequencing platforms such as
Ion Torrent and Illumina. Ion Torrent has similar technology
and the same source of errors as 454 pyrosequencing. ICC is able
to analyze Ion Torrent data with the same efﬁciency as 454
pyrosequencing data. It can also be run on Illumina data, al—
though there is low indel error in Illumina platform. By applying
a Poisson probability model, ICC is able to distinguish sequen—
cing errors from authentic minor variants and remove sequen—
cing noise to a large extent. With the high sensitivity and
speciﬁcity achieved by ICC, it should expedite analysis of vari—
able sequence populations.

Funding: This work was supported by the National Institute of
Allergy and Infectious Diseases of the National Institutes of
Health [POlA1057005, UM1A1068618 and R37AI47734 to
J.I.M.], including the University of Washington Centers for
AIDS Research Computational Biology Core [P30AIO27757].

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et a]. (1990) Basic local alignment search tool J. Mol Biol, 215,
403410.

Archer,J. et a]. (2010) The evolutionary analysis of emerging low frequency HIV—1
CXCR4 using variants through time—an ultra—deep approach. PLoS Comput.
Biol, 6, e1001022.

Bimber,B.N. et a]. (2009) Ultradeep pyrosequencing detects complex patterns of
CD8+ T—lymphocyte escape in simian immunodeﬁciency virus—infected ma—
caques. J. Virol, 83, 824778253.

Bimber,B.N. et a]. (2010) Whole—genome characterization of human and simian
immunodeﬁciency virus intrahost diversity by ultradeep pyrosequencing.
J. Virol, 84, 12087712092.

Bragg,L. et a]. (2012) Fast, accurate error—correction 0f amplicon pyrosequences
using Acacia. Nat. Met/toilx‘, 9, 4254126.

Burwitz,B.J. et a]. (2011) Pyrosequencing reveals restricted patterns of CD8+ T cell
escape—associated compensatory mutations in simian immunodeﬁciency virus.
J. Virol, 85, 13088713096.

Eriksson,N. et a]. (2008) Viral population estimation using pyrosequencing. PLoS
Comput. Biol, 4, e1000074.

Fischer,W. et a]. (2010) Transmission of single HIV—1 genomes and dynamics of
early immune escape revealed by ultra—deep sequencing. PLoS One, 5, e12303.

Gilles,A. et a]. (2011) Accuracy and quality assessment of 454 GS—FLX Titanium
pyrosequencing. BMC genomies, 12, 245.

Gusfleld,D. (1997) Algorithms on Strings, Trees, and Sequences: Computer Science
and Computational Biology. Cambridge University Press, Cambridge CB2 lRP.

Hedskog,C. et a]. (2010) Dynamics of HIV—1 quasispecies during antiviral treatment
dissected using ultra—deep pyrosequencing. PLoS One, 5, e11345.

Henn,M.R. et a]. (2012) Whole genome deep sequencing of HIV—1 reveals the
impact of early minor variants upon immune recognition during acute infection.
PLoS Pat/tog, 8, e1002529.

Herbeck,J.T. et a]. (201 1) Demographic processes affect HIV—1 evolution in primary
infection before the onset of selective processes. J. Virol, 85, 752%7534.

Huse,S.M. et a]. (2007) Accuracy and quality of massively parallel DNA pyrose—
quencing. Genome Biol, 8, R143.

Huse,S.M. et a]. (2010) Ironing out the wrinkles in the rare biosphere through
improved OTU clustering. Environ. Microbiol, 12, 188971898.

L0ve,T.M. et a]. (2010) Mathematical modeling of ultradeep sequencing data re—
veals that acute CD8+ T—lymphocyte responses exert strong selective pressure in
simian immunodeﬁciency virus—infected macaques but still fail to clear founder
epitope sequences. J. Virol, 84, 580275814.

Macalalad,A.R. et a]. (2012) Highly sensitive and speciﬁc detection of rare variants
in mixed viral populations from massively parallel sequence data. PLoS
Comput. Biol, 8, e10024l7.

Margulies,M. et a]. (2005) Genome sequencing in microfabricated high—density
picolitre reactors. Nature, 437, 37(r380.

Needleman,S.B. and Wunsch,C.D. (1970) A general method applicable to the
search for similarities in the amino acid sequence of two proteins. J. Mol
Biol, 48, 4437453.

O’Connor,S.L. et a]. (2012) Conditional CD8+ T cell escape during acute simian
immunodeﬁciency virus infection. J. Virol, 86, 605%09.

P00n,A.F. et a]. (2010) Phylogenetic analysis of population—based and deep sequen—
cing data to identify coevolving sites in the nef gene of HIV—1. Mol Biol. Evol,
27, 8197832.

Prosperi,M.C. and Salemi,M. (2012) QuRe: software for viral quasispecies recon—
struction from next—generation sequencing data. Bioinformatiex', 28, 1327133.

Quince,C. et a]. (2009) Accurate determination of microbial diversity from 454
pyrosequencing data. Nat. Met/toilx‘, 6, 639%41.

Quince,C. et a]. (2011) Removing noise from pyrosequenced amplicons. BMC
Bioinformatiax‘, 12, 38.

Ramirez—Gonzalez,R. et a]. (2013) PyroClean: denoising pyrosequences from pro—
tein—coding amplicons for the recovery of interspeciﬁc and intraspeciﬁc genetic
variation. PLoS One, 8, e57615.

Reeder,J. and Knight,R. (2010) Rapidly denoising pyrosequencing amplicon reads
by exploiting rank—abundance distributions. Nat. Met/toilx‘, 7, 668%69.

R0drigo,A.G. et a]. (1997) Quantitation of target molecules from polymerase chain
reaction—based limiting dilution assays. AIDS Rex. Hum. Retroviruses, 13,
7377742.

Rousseau,C. et a]. (2006) large—scale ampliﬁcation, cloning and sequencing of near
full—length HIV—1 subtype C genomes. J. Virol Met/toilx‘, 136, 1187125.

Salmela,L. and SchroderJ. (2011) Correcting errors in short reads by multiple
alignments. Bioinformatiex', 27, 145571461.

Schacker,T. et a]. (1996) Clinical and epidemiologic features of primary HIV infec—
tion. Ann. Intern. Meal, 125, 2577264.

Sha0,W. et a]. (2013) Analysis of 454 sequencing error rate, error sources, and
artifact recombination for detection of Low—frequency drug resistance muta—
tions in HIV—1 DNA. Retrovirology, 10, 18.

 

2408

ﬁre'spzumofpmJXO'sopnuuowrorq/ﬁdnq

Indel and Carryfonivard Correction

 

Simen,B.B. et a]. (2009) Low—abundance drug—resistant viral variants in chronically
HIV—infected, antiretroviral treatment—naive patients signiﬁcantly impact treat—
ment outcomes. J. Infect. Di.x‘., 199, 6937701.

Stekler,J.D. et a]. (2012) Are there beneﬁts to starting antiretroviral therapy during
primary HIV infection? Conclusions from the Seattle Primary Infection Cohort
vary by control group. Int. J. STD AIDS, 23, 2017206.

Tsibris,A.M. et a]. (2009) Quantitative deep sequencing reveals dynamic HIV—1
escape and large population shifts during CCR5 antagonist therapy in vivo.
PLoS One, 4, e5683.

Vandenbroucke,I. et a]. (2011) Minor variant detection in amplicons using 454
massive parallel pyrosequencing: experiences and considerations for successful
applications. Biotecliniquex, 51, 1677177.

Wang,C. et a]. (2007) Characterization of mutation spectra with ultra—deep
pyrosequencing: application to HIV—1 drug resistance. Genome Re.\'., 17,
119571201.

Zagordi,O. et a]. (2011) ShoRAH: estimating the genetic diversity of a mixed sample
from next—generation sequencing data. BMC Bioinformatic.\', 12, 119.

Zagordi,O. et al. (2010a) Deep sequencing of a genetically heterogeneous sample:
local haplotype reconstruction and read error correction. J. Comput. Biol, 17,
417428.

Zagordi,O. et al. (2010b) Error correction of next—generation sequencing
data and reliable estimation of HIV quasispecies. Nucleic Acids Rec, 38,
740(k7409.

 

2409

/810'slcum0prOJxo'sopBLuJOJurorq”:duq

