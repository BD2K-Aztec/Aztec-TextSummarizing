ORIGINAL PAPER

Vol. 26 no. 6 2010, pages 715-721
doi: 1 0. 1 093/bioinformatics/btq041

 

Genome analysis

Advance Access publication February 3 2010

Identifying biologically relevant differences between

metagenomic communities
Donovan H. Parks and Robert G. Beiko*

Faculty of Computer Science, Dalhousie University, 6050 University Avenue, Halifax, Nova Scotia, Canada BSH 1W5

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: Metagenomics is the study of genetic material
recovered directly from environmental samples. Taxonomic and
functional differences between metagenomic samples can highlight
the influence of ecological factors on patterns of microbial life
in a wide range of habitats. Statistical hypothesis tests can
help us distinguish ecological influences from sampling artifacts,
but knowledge of only the P-value from a statistical hypothesis
test is insufficient to make inferences about biological relevance.
Current reporting practices for pairwise comparative metagenomics
are inadequate, and better tools are needed for comparative
metagenomic analysis.

Results: We have developed a new software package, STAMP,
for comparative metagenomics that supports best practices in
analysis and reporting. Examination of a pair of iron mine
metagenomes demonstrates that deeper biological insights can be
gained using statistical techniques available in our software. An
analysis of the functional potential of ‘Candidatus Accumulibacter
phosphatis’ in two enhanced biological phosphorus removal
metagenomes identified several subsystems that differ between
the A.phosphatis stains in these related communities, including
phosphate metabolism, secretion and metal transport.

Availability: Python source code and binaries are freely available
from our website at http://kiwi.cs.dal.ca/Software/STAMP

Contact: beiko@cs.dal.ca

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 11, 2009; revised on January 14, 2010;
accepted on January 26, 2010

1 INTRODUCTION

With its focus on ecologically relevant assemblages of micro-
organisms, metagenomics—the assessment of randomly collected
DNA fragments from a microbial community—has revealed a new
world of microbial diversity and complexity. Metagenomic studies
can be motivated by several goals, including the discovery of novel
genes of interest (Bej a, et al. 2000; Yooseph et al., 2007), validation
of metabolic hypotheses (Garcia Martin et al., 2006; Hallam et al.,
2004; Mou et al., 2008), proﬁling of the relationship between
microbial community composition and variation in environmental

 

*To whom correspondence should be addressed.

or geographic parameters (Dinsdale et al., 2008a; Ley et al.,
2006) and assessment and comparison of the global metabolic
complement found in one or more habitats (Brulc et al., 2009;
Edwards et al., 2006; Tringe et al., 2005; Turnbaugh et al., 2009).
Detailed assessment of communities requires intensive sequencing
effort and careful experimental design to ensure that experimental
questions can be adequately addressed (Hamady and Knight, 2009).

A common outcome of a metagenome project is a set of functional
predictions for the collected and assembled DNA reads, assigned via
homology search and classiﬁed using a scheme such as the SEED
(Overbeek et al., 2005) or KEGG (Kanehisa et al., 2004). When
multiple samples are collected, functional classes can be organized
into contingency tables that allow the assessment of statistically
signiﬁcant differences in the relative abundance of these classes.
For example, Edwards et al. (2006) sampled communities from an
oxidized and anoxic environment within the Soudan iron mines and
found evidence that these two communities preferentially utilize
different respiratory pathways. Several dedicated bioinformatics
applications have been developed for the statistical analysis
of metagenome pairs, including XIPE-TOTEC (Rodriguez-Brito
et al., 2006), ShotgunFunctionalizeR (Kristiansson et al., 2009)
and MEGAN (Mitra et al., 2009). Packages focusing on the
complementary problems of assessing differences between groups
of metagenomes have also been developed (Gianoulis et al., 2009;
Lozupone and Knight, 2005; Schloss et al., 2009; White et al., 2009).

While such comparisons are informative, it is vital to distinguish
results that are biologically relevant (i.e. truly different in frequency
between two or more sites, due to some underlying taxonomic or
ecological phenomenon) from those that are merely statistically
signiﬁcant. Statistical signiﬁcance is neither a necessary nor a
sufﬁcient criterion for biological relevance (Nakagawa and Cuthill,
2007) but is typically used as a ﬁlter to remove uninteresting features
where the observed difference can reasonably be attributed to being
a sampling artifact. Reasoning about the biological relevance of a
feature requires consideration of effect sizes and their associated
conﬁdence intervals. Interpretation of statistical results can also
beneﬁt from transforming raw P-values to alternative measures with
possibly superior interpretations (Storey and Tibshirani, 2003) and
by allowing interactive ﬁltering that permits focusing on features
with speciﬁc statistical properties.

Here, we present a discussion of the key statistical concerns in
metagenomic data analysis and introduce a new application, STAMP
(STatistical Analysis of Metagenomic Proﬁles), which provides a
user-friendly graphical environment for performing the statistical
techniques discussed in this article.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 715

112 /3.Io's[sumoprOJXO'sorwuiJOJurorq”:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

D.H.Parks and R. G.Beiko

 

Table 1. Contingency table summarizing data for a feature of interest

 

 

Sample 1 Sample 2
Sequences in feature x1 x2 R1 2x1 +x2
Sequences in other features y 1 y; R; = y 1 +y2

Total assigned sequences C1 =x1+y1 C2 = xz +y2 N = C1+ C2

 

2 METHODS
2.1 Input data

The statistical methods and software discussed here can be applied to any
count data obtained from a pair of metagenomic samples. Typically. we are
interested in a collection of related features which deﬁne a proﬁle (e.g. a
functional proﬁle indicating the number of sequences assigned to different
biological subsystems or pathways). The statistical assessment of a particular
feature can be carried out using a contingency table as shown in Table l.
The table entries x1 and x2 are the number of sequences in the two samples
assigned to the feature of interest. while y 1 and y; are the numbers assigned
to other features. The total number of sequences in the proﬁle is given by the
column sums C1 and C2. For hierarchical classiﬁcation schemes. such as a
taxonomy or the SEED functional assignments (Overbeek et al.. 2005). we
can also investigate the number of sequences within a feature relative to the
total number of sequences assigned to a parental category in the hierarchy. In
this case. the column sums express the number of sequences assigned to the
parental category rather than the total number of sequences in the sample.

2.2 Statistical hypothesis tests

The P-Value produced by a statistical hypothesis test indicates the probability
of an observed difference occurring simply by chance. Features in a proﬁle
with P-Values below a nominally chosen threshold (e.g. 0.05) are termed
statistically signiﬁcant and can reasonably be assumed to be enriched in one
of the metagenomes due to ecological or taxonomic differences as opposed
to being the result of a sampling artifact. Rodriguez-Brito et al. (2006)
recently addressed the need to assess statistical signiﬁcance by introducing
a non-parametric. bootstrap test. XIPE-TOTEC. This test has been applied
in several recent studies (Brulc et al.. 2009; Dinsdale et al.. 2008b; Edwards
et al.. 2006; Mou et al.. 2008; Poretsky et al.. 2009; Qu et al.. 2008;
Turnbaugh et al.. 2006; Turnbaugh et al.. 2009; Urich et al.. 2008; Willner
et al.. 2009).

XIPE-TOTEC builds a null distribution for a given feature by drawing
sequences randomly with replacement from a set consisting of all sequences
from the two metagenomes. Two samples of M sequences are drawn from
this pooled set. and the difference in the number of sequences from the
feature of interest used as a test statistic. This process is repeated multiple
times in order to estimate the null distribution accurately. The difﬁculty with
this approach is that M is a free parameter. Increasing M reduces the width of
the null distribution which in turn increases the number of features identiﬁed
as being signiﬁcant (Supplementary Table S1). A similar approach with the
same requirement was recently proposed by Allen et al. (2009).

To assess the probability of any observed difference being a sampling
artifact. we must consider the number of sequences originally obtained from
each sample (i.e. C1 and C2). Several ‘classical’ tests meet this requirement
and can be classiﬁed according to whether they assume sampling with or
without replacement. Although these tests aim to produce the same results.
in practice there can be considerable variation in the P-Values they produce
(Supplementary Tables S2. S3 and S4).

2.2.] Sampling without replacement Monte Carlo permutation tests are a
widely used non-parametric technique for modeling the distribution of a test
statistic under a given null hypothesis [see Manly (2007) for a comprehensive
treatment]. The null distribution is approximated by calculating values of

the test statistic under a sufﬁciently large number of random permutations
of the sample labels. A P-Value can then be calculated as the proportion of
this approximate null distribution that is equal to or more extreme than the
observed data.

To exactly model the null distribution. all possible permutations must be
considered. A permutation of the sequences within a pair of metagenomic
samples can be Viewed as drawing sequences without replacement from a
ﬁnite population consisting of two types of sequences (i.e. those from the
current feature of interest and those from other features). This is the deﬁnition
of a hypergeometric distribution. Fisher”s exact test uses this distribution
to efﬁciently calculate the exact P-Value without having to exhaustively
enumerate all permutations (Agresti. 1990).

The chi-square test and G-test are well-known large sample
approximations to Fisher”s exact test (Agresti. 1990). Although these
approximations are accurate for equal sample sizes. for unequal sample
sizes they can produce P-Values substantially smaller than those given
by Fisher”s exact test (Supplementary Tables S27S4). Yates” continuity
correction is often recommended for these approximation methods and has
the beneﬁt of making them conservative at the expense of being less accurate
(Supplementary Tables S27S4). For contingency tables with ‘small” entries.
traditionally deﬁned as 5 or 10. these approximations are not recommended
(Supplementary Table S3; Cochran. 1952) and have been shown to produce
unsatisfactory results under a range of other conditions (Agresti. 1992 and
references within).

The execution time of Fisher”s exact test calculated under the commonly
used ‘minimum likelihood” methodology (Supplementary Table S5) is a
linear function of the number of sequences assigned to a feature in either
sample (i.e. R1). Our implementation of this approach takes ~l s to compute
when the number of sequences assigned to a feature is 10 000 (Supplementary
Fig. S1). As such. we recommend Fisher”s exact test be used instead of a
large sample approximation test because metagenomic proﬁles rarely contain
features with more than a few thousand sequences. typically of unequal size
and often have many features resulting in ‘small” table entries. Rivals et al.
(2007) also recommended the use of Fisher”s exact test after performing a
similar analysis of potential hypothesis tests for the enrichment or depletion
of gene ontology (GO) categories.

2.2.2 Sampling with replacement The most appropriate method for
calculating exact P-Values for 2 X 2 contingency tables has long been debated
(Barnard. 1947; Barnard. 1989; Haber. 1987; Ludbrook. 2008). Opponents of
Fisher”s exact test argue that the supposition of ﬁxed row and column totals
causes the test to be overly conservative (Agresti. 1990; Ludbrook. 2008;
Mehta and Senchaudhuri. 2003). From the perspective of metagenomics.
this amounts to assuming that if we resarnple our two communities. we
would obtain the same number of sequences from each community as in
our original dataset (i.e. C1 and C2 are ﬁxed) ana1 that the total number of
sequences assigned to a feature across the two samples would be unchanged
(i.e. R1 is ﬁxed).

We can relax ﬁxing the row totals by performing a bootstrap test. where
random samples are generated by sampling with replacement as in the method
proposed by Rodriguez-Brito et al. (2006). Under this model. we assume that
the number of sequences drawn for our two samples always remains the same.
but the number of sequences assigned to each feature is free to vary. Drawing
sequences with replacement from a ﬁnite population consisting of two types
of sequences gives rise to the binomial distribution. For large sample sizes.
we can approximate these binomial distributions as normal distributions. N1
and N2. The normal distribution that results from the difference between N1
and N2 forms the basis for the well-known ‘difference between proportions”
z-test. Despite the stark difference in their formulation. this test is equivalent
to the chi-square test (Rivals et al.. 2007) and shares its limitations.

To exactly model the null distribution. when sampling with replacement.
requires knowledge of the true proportion of sequences assigned to a feature.
p. within the two microbial populations being considered. The bootstrap
test estimates this population parameter as the proportion of sequences

 

716

112 /3.Io's[Bumo[p.IOJxosorwuiJOJurorq”:duq wort popeolumoq

9103 ‘{g isnﬁnv 110::

Biological differences between metagenomic communities

 

Table 2. Effect size statistics commonly applied to 2 X 2 contingency tables

 

 

Effect size statistic Equation
Difference between proportions DP=I71 —l72

Ratio of proportions RP: 171/172

OR OR =(X1/y1)/(X2/y2)

 

p1 =x1/C1,p2 =x2/C2; RP is often referred to as relative risk.

sampled from the feature of interest (i.e. phat = R 1/N ). Alternatively. an exact
test can be performed by setting phat to the value that maximizes our P-
value as suggested by Barnard (1947). Unfortunately. such an approach is
computationally prohibitive even for modest sample sizes despite efforts to
optimize the method (Mato and Andres. 1997). As the bootstrap test relies
on an estimate of p. it is not an exact test. and when this estimate is poor
can produce P-Values that are extremely liberal compared with Barnard”s or
Fisher”s exact test (Supplementary Table S6).

Given that Barnard”s test is computationally prohibitive for the majority
of features in a typical metagenomic proﬁle. we must decide between an
approximation to Barnard”s exact test (e. g. bootstrapping) and Fisher”s exact
test. Our recommendation is to use Fisher”s exact test as it is generally
conservative compared with Barnard”s exact test (Supplementary Table S6;
Mehta and Senchaudhuri. 2003). computationally tractable for metagenomic
proﬁles and familiar to the majority of researchers.

2.3 Effect size

To assess if a feature is of biological relevance. we must consider the
magnitude of the observed difference (i.e. an effect size statistic). An
arbitrarily small effect can be statistically signiﬁcant if the sample sizes are
sufﬁciently large (Supplementary Fig. S2). so biological signiﬁcance must
be supported by effect size statistics as well as P-Values.

Three common effect size statistics are given in Table 2 (Sistrom and
Garvan. 2004). The most intuitive statistic is the difference in proportions
(DPs) of sequences assigned to a given feature in the two samples.
Interpreting the ratio of proportions (RPs) is also natural and provides
complementary information to the DP. Consideration of multiple effect size
statistics is often essential while assessing biological relevance as features
can have a small (large) DP. but a large (small) RP. The odds ratio (OR)
is widely used and has many desirable mathematical properties (Bland and
Altman. 2000). However. it is often criticized as being difﬁcult to interpret
(Agrawal. 2005; Sackett et al.. 1996) and we recommend that the RP be
preferred to the OR while interpreting and reporting results.

2.4 Conﬁdence intervals

A conﬁdence interval (CI) indicates the range of effect size values that
have a speciﬁed probability of being compatible with the observed data.
For example. a 95% CI gives a lower and upper bound in which the true
effect size will be contained 19 times out of 20. Knowledge of these bounds
is often an important aid in assessing biological relevance. Despite this. we
are unaware of any comparative metagenomic studies that report effect size
CIs (Supplementary Table S7).

There is a close relationship between P-Values and CIs. A P-Value
indicates the probability of observing a given contingency table under the
assumption that samples come from identical microbial communities. CIs
make no such assumption. As such. a CI that encompasses the ‘identity”
effect size (e.g. DP=0 or RP=OR=1) will have a P-Value >1 minus the
coverage of the CI (i.e. a P-Value 30.05 for a 95% CI). If the ‘identity” effect
size is outside the CI. the P-Value will be <1 minus the coverage of the CI.
CIs are more informative than P-Values. and many proponents of CIs have
suggested they make P-Values unnecessary (Nakagawa and Cuthill, 2007).
Nonetheless. P-Values are a useful summary statistic and provide a natural
way to rank and ﬁlter results when multiple hypothesis tests are performed.

CIs can vary considerably with sample size (Supplementary Fig. S3;
features la and 2a). Critically. CIs provide us with a mean to infer the
biological relevance of a feature even when it is marginally statistically
signiﬁcant; features 1c and 2c demonstrate that the difference between a
statistically signiﬁcant and non-signiﬁcant feature can be minimal in terms
of effect size and CI bounds. The CI for example 2c indicates that an effect
size of O is just as likely as the ‘counter-null hypothesis” of a true difference
between proportions of ~8.5% (Rosenthal et al.. 2000). This cautions us
against making dichotomous decisions about biological relevance based
solely on how a P-Value compares with a nominal level of signiﬁcance (i.e.
0.05). Inferring biological relevance is best done in the context of all available
information. much of which does not lend itself to numerical analysis of a
univariate response. such as the P-Value.

2.5 Multiple test correction

A typical metagenomic proﬁle consists of several hundred features. When
performing multiple hypothesis tests. it is useful to modify the P-Values so
that they reﬂect a particular interpretation. For example. if a proﬁle contains
100 features. the number of features with a P-Value <0.05 due to chance
variation will in general be 5. If we wish to examine a list of features
where the probability of observing one or more false positive is less than a
speciﬁed probability. we can use a correction method that directly controls the
family-wise error rate (FWER). Commonly applied FWER methods include
Bonferroni. Holm-Bonferrnoi and Sidak (Abdi. 2007). Alternatively. during
exploratory analysis. we may be willing to accept a speciﬁc percentage
of false positives. This can be achieved using the BenjaminiiHochberg
false discovery rate (FDR) procedure (Benjamini and Hochberg. 1995) or
the Storey FDR approach (Storey and Tibshirani, 2003). These approaches
calculate a q-Value for each feature. indicating the expected proportion of
false positives within the set of features with a smaller q-Value.

These approaches complement each other while performing an
exploratory analysis. The list of signiﬁcant features obtained when no
multiple test correction method is applied gives us an initial global look at
those features which may be differentially abundant between our samples. An
FDR approach can be used to reﬁne this initial list and makes the number of
expected false positives explicit. Finally. an FWER technique can be applied
to focus our attention to only those features where the observed enrichment
or depletion is highly unlikely to be a sampling artifact.

3 IMPLEMENTATION

Here. we introduce our open source software package for performing
STatistical Analyses of Metagenomic Proﬁles (STAMP). Our software
provides a user-friendly graphical interface to allow for the easy adoption of
the statistical methods discussed in this article.

3.1 Implementation details

STAMP is implemented in Python (http://www.python.org) and can be
executed on all major platforms.

3.1.] Input data STAMP can read the functional and taxonomic proﬁles
produced by MG-RAST (Meyer et al.. 2008) and all of the ‘abundance
proﬁles” available at IMG/M (Markowitz et al.. 2008). Custom proﬁles can be
speciﬁed in an accessible tab-separated values ﬁle format. We are currently
developing other parsers for popular community resources such as the naive
Bayesian rRNA classiﬁer at RDP (Cole et al.. 2009).

3.1.2 Statistical hypothesis tests We provide an optimized
implementation of Fisher”s exact test. Although Fisher”s exact test is
preferred to asymptotic approximations. we have provided implementations
of the chi-square and G-test (with and without Yates” continuity correction)
for completeness. Based on the discussion in Section 2.2.2. some users
may favor using the non-parametric bootstrap test. We also provide an

 

717

112 /3.Io's[Bumo[pJOJXO'soiwuiJOJHrorqﬂ:duq 111011 pepeo1umoq

9103 ‘1gisn8nv 110::

D.H.Parks and R. G.Beiko

 

 

95% confidence intervals

< 1e-15 ._.

l—O-l 2.65e-9

2.00e—5

l-O'i 6.33ev4

l-O-l 0.012

l-Ol 0.013
i-O-i

i.

i—o—I

i
l
1
I
l
I

0.033
1 0.040
to 0.040

l l L l .I 1 l

q—value {corrected

 

NiFe hydmgenase maturation I—
Respiratoryr Complex I —|
Denitrification II
FOFl-type ATP synthase —|
Respiratory dehydrogenases l —I
Hydrogenases -
Terminal cytochrome C oxidases —|
Nat+iAtranslocating NADH-quino... I
Membrane—bound Ni; Fe—hydrogenase I
I. J
293 0 1'5
Sequences

-4 —3 -2 -1 0 1 2 3
Difference between proportions {96]

Fig. 1. Respiratory subsystems from the ‘red” and ‘black” iron mine metagenomes. Corrected P-Values were calculated using Storey”s FDR approach.

Subsystems overrepresented in the ‘red” (‘black”) community have a positive (negative) difference between proportions.

Sodium Hydrogen Antiporter
ABC transporter ferrichrpme IT...
ABC transporter heme (TC3.A.1....
CbiQO-type ABC transporter sys... _-
ABC transporter ribose (TC 1A... —
ABC transporter ferric enterob... I

ABC transporter maltose —
I I

 

95% confidence intervals

i—o—i ' 1.53e-4 3
i—o—i ' 3.?2e—4 ‘g
i—o—i i 1.34e—3 t

l—O—l i 0.012 g
i—o—i I 0.051 g
i-—o-—i 0.054 E

'i—o—i 0.092 a

| i | | | I a.

 

34 0 1?
Sequences

I I
—1.0 —0.8 —0.6 —0.4 —0.2 0.0 0.2 0.4

Difference between proportions 1%!

Fig. 2. Membrane transport subsystems from the ‘red” and ‘black” iron mine metagenomes. Corrected P-Values were calculated using Storey”s FDR approach.
Subsystems overrepresented in the ‘red” (‘black”) community have a positive (negative) difference between proportions.

implementation of Barnard”s test for researchers considering proﬁles
resulting in small tables (i.e. N < 20). Both one- and two-sided tests are
supported. although for metagenomic studies two-sided results should
generally be reported for the reasons given in Rivals et al. (2007).

3.1.3 Eﬁ‘ect size ana1 conﬁdence intervals All the effect size statistics
in Table 2 are available within STAMP. CIs for the DP statistic can be
constructed using either a standard asymptotic approach. an asymptotic
approach with continuity correction. or the NewcombeeWilson method
(Supplementary Table S8; Newcombe. 1998). Standard asymptotic CI
approaches are implemented for the RP and OR statistics as these perform
well even on tables with small entries (Supplementary Table S8; Agresti.
1999; Lawson. 2004). STAMP also provides a Monte Carlo simulation
framework for evaluating the accuracy of a CI method on a particular dataset.

3.1.4 Multiple hypothesis test correction The FWER and FDR methods
discussed in Section 2.5 are available within STAMP. Storey”s FDR approach
is based on the bootstrapping approach discussed in Storey et al. (2004).

3.1.5 Filtering of features Features can be ﬁltered based on the number
of sequences assigned to each sample or parental category. their observed
effect size and their associated P-Value. Speciﬁc subsets of features can be
selected (e.g. all subsystems involved in respiration) and ﬁltering optionally
applied to them.

3.1.6 Plots Numerous publication-quality plots can be produced using
STAMP. Bar and scatter plots. indicating the relative frequency of all
features. permit an initial exploratory analysis of metagenomic proﬁles (e. g.
Supplementary Figs S7 and S8). Extended error bar plots (e.g. Figs 173)
provide a single ﬁgure indicting the number of sequences assigned to a
feature along with the P-Value. effect size and CI. Several additional plots
are also available.

3.1.7 Extensible architecture STAMP uses a plug-in architecture in order
to allow new statistical hypothesis tests. effect size statistics. CI methods.

multiple comparison procedures or plots to be easily incorporated into the
software.

3.1.8 Command-line interface A command-line interface is provided to
facilitate batch processing or ‘application linking” as recommended by
Kumar and Dudley (2007).

3.1.9 Comparing multiple metagenomes Several recent studies have used
XIPE-TOTEC to compare multiple metagenomes by performing pairwise
tests between all possible pairs of metagenomes (Brulc et al.. 2009; Dinsdale
et al.. 2008b; Turnbaugh et al.. 2009; Willner et al.. 2009). Such analyses can
be performed using the STAMP command-line interface in a manner similar
to XIPE-TOTEC or interactively through STAMP”s graphical interface. We
are currently extending STAMP with additional plots and exploratory tools
speciﬁcally focused on multiple pairwise tests.

3.2 Comparison with available software

Here and in Supplementary Table S9. we summarize the differences
among STAMP. XIPE-TOTEC (Rodriguez-Brito et al.. 2006).
ShotgunFunctionalizeR (Kristiansson et al.. 2009). MEGAN (Mitra
et al.. 2009) and IMG/M (Markowitz et al.. 2008). XIPE-TOTEC reports
only statistically signiﬁcant features without indicating their calculated
P-Value. ShotgunFunctionalizeR runs within the R statistical computing
environment (http://www.r-project.org) and provides statistical tests for
comparing groups consisting of multiple metagenomes. MEGAN is a
cross-platform tool with a graphical interface that focuses primarily on
taxonomic proﬁles. The taxonomic hierarchy is displayed as a tree structure.
and statistical results are textually and graphically reported for each node
in the hierarchy. IMG/M is a web portal that provides a number of tools
for comparative metagenomics. including pairwise statistical hypothesis
testing. Notably. none of these software packages reports effect sizes or CIs.

 

718

112 /3.Io's[BrunoprOJXO'sorwuiJOJHrorq”:duq 111011 pepeo1umoq

9103 ‘1gisn8nv 110::

Biological differences between metagenomic communities

 

 

95% confidence Intervals

 

Generaljecretionjathway —II I l—O—i < 1e-15
Cobalt-zinc-cadmium_re5istance —— I i—O—l < 1e-15
Pespiratory_Comp|ex_l I_ |—.—| l < 13-15
Transport_of_Molybdenum I iO-i | 1.04e-10
CMP—N-acetyIneuraminate_Biosyn... I i-OI I 6.33e-9
CBSS-15903?.4.peg.2189 I I i.| 2.00e-1‘
Tn552 I DI 1.58e-ﬁ
AIkanesulfonate_assimilation I i-oi I 4.03e—6 E
Phosphate_metabolism —— | i—Q—i 1.63e-5 g
RNA_3'-terrninal_phosphate_cyclase I I lot 2.53ev4 E
CBSS-393123.3.peg.2355 I I. 6.61e—4 8
Alginate_metabolism I ' 2215-3 3
ABC;ransporter_branched~cnain... -— i—Q—i I 2.?1e-3 g
CBSS-213491.3.peg.42? —— | i—O—i 3.14e-3 E
Two—component_5ensor_regulator... I I. 1.6?ev3 c'l
NiFe_hydrogenase‘maturation I ill I 0.010
Copper_homeostasi5 —— 0.011
Nsenic_resistance I 'I 0.014
Pyoverdine_biosynthe5Is_new I l IQ-i 0.016
CBSS-243265.1.peg.193 I 1.11 0.023
Succinate_dehydrogenase I 1" 0,040
5555—290633.l.peg.1906 II 0.048
I I I I I I I I
536 0 191 —1.0 —0.5 0.0 0.5 1.0 1.5 2.0

Sequences

Difference between proportions 1%}

Fig. 3. Subsystems enriched or depleted within the A.phosphatis strains of the USA and Australia EBPR communities. Corrected P-Values were calculated
using the Bonferroni correction. Subsystems overrepresented in the USA (Australia) community have a positive (negative) difference between proportions

and are indicated by red (blue) coloring.

4 RESULTS

4.1 Soudan iron mine metagenomes

Two samples from distinct habitats within the Soudan Iron Mine in
Minnesota, USA, were sequenced and analyzed by Edwards et al.
(2006). The ‘black’ sample (pH 6.7, redox potential -142 mV) was
taken from water within a borehole, and the ‘red’ sample (pH 4.37,
redox potential -8 mV) was taken a few centimeters from the mouth
of a borehole where oxygen in the passageway has signiﬁcantly
reduced the pH and redox potential of the bore water. Functional
proﬁles for these samples were obtained by Edwards et al. (2006)
by comparing the unassembled reads obtained from pyrosequencing
against the SEED database (Supplementary Methods).

Here, we contrast the statistical results reported by Edwards et al.
(2006) using XIPE-TOTEC to those obtained using the statistical
techniques provided in STAMP. Fisher”s exact test identiﬁes ~11%
fewer statistically signiﬁcant subsystems than XIPE-TOTEC v2.4
with replicate sample sizes of M =5000 (Table 3). This replicate
sample size was used in Edwards et al. (2006), presumably as
a compromise between the size of the two proﬁles that contain
2319 and 13 221 sequences in the ‘black’ and ‘red’ communities,
respectively. Edwards et al. (2006) report only 69 statistically
signiﬁcant subsystems as it appears manual editing of subsystems
containing few assigned sequences was performed.

Using the ﬁlters provided in STAMP, we determined that 15% of
the statistically signiﬁcant subsystems identiﬁed by Fisher”s exact
test have fewer than ﬁve sequences assigned to them from each
sample (26% have 10 sequences or less). Performing additional
ﬁltering with liberal absolute (DPf 0.5%) and relative (RP 32)
effect size requirements gives a list of 71 subsystems with sufﬁcient
statistical support to warrant further consideration of their biological
relevance. Applying Storey”s FDR approach with a q-value threshold
of 0.05 reduces this list to 60 subsystems and makes it explicit that
we should expect three of these to be false positives. Supplementary
Figure S4 indicates the number of sequences in each of these

Table 3. Identifying biologically interesting subsystems

 

 

XIPE-TOTEC STAMP
Total subsystems 247
Statistically signiﬁcant“ 98 87
Manual ﬁltering 69 7
With 35 sequence in at NA 74
least one sample
With RP 3 2 or DP 30.5%, NA 71
and 35 sequences
As above with Storey”s NA 60
FDR approach

 

aTwo-sided test with a signiﬁcance level of a = 0.05.

60 subsystems along with their effect size, CI and q-value. Further
investigation into the biological relevance of these subsystems will
beneﬁt from considering this information.

The metabolic analysis performed in Edwards et al. (2006)
focused on the ‘respiratory’ and ‘iron uptake and utilization”
metabolic classes. Our analysis supports the hypothesis that the ‘red’
aerobic and ‘black’ anaerobic communities predominantly utilize
different respiratory pathways (Fig. 1 and Supplementary Fig. S5).
Edwards et al. (2006) also proposed that the ‘black’ community has
a greater abundance of genes involved in iron uptake and utilization
because ferric iron (Fe3+) is limited in this community compared
with the ‘red’ sample. Although this hypothesis is supported by
the number of different subsystems that are overrepresented in the
‘black’ community (Fig. 2 and Supplementary Fig. S6), caution is
warranted as the number of sequences assigned to these subsystems
is extremely small.

Contrasting Figures 1 (Supplementary Fig. S5) and 2
(Supplementary Fig. S6) illustrate the beneﬁt of reporting effect sizes
and CIs. We should have more conﬁdence in assigning biological

 

719

112 /3.Io's[BrunoprOJXO'sorwuiJOJHrorq”:duq 111011 pepeo1umoq

9103 ‘1gisn8nv 110::

D.H.Parks and R. G.Beiko

 

relevance to subsystems such as ‘NiFe hydrogenase maturation”,
which has a large DP and RP than to a subsystem such as ‘ABC
transporter ferrichrome” where the DP is small and the RP may be
relatively small as indicated by the CI for this feature. In broader
terms, the evidence for ecological differences causing preferential
utilization of alternate respiratory pathways in these communities is
far stronger than the evidence for differing concentrations of Fe3+
driving an overrepresentation of iron update and utilization genes.

4.2 Accumulibacter phosphatis strains in enhanced
biological phosphorus removal metagenomes

Enhanced biological phosphorus removal (EBPR) is a treatment
process in which micro-organisms are employed to remove
excessive inorganic phosphate from wastewater which, if left
untreated, would result in eutrophication of outfall ecosystems.
Although the economic and environmental beneﬁts of EBPR
have led to its global adoption in waste water treatment plants
(WWTP), the performance of these systems varies over time and
location for reasons that are still poorly understood due to an
incomplete understanding of EBPR microbiology. Here, we compare
the ﬁinctional proﬁles of A.phoshatis strains, the dominant EBPR
phosphate-accumulating organisms, from two lab-scale WWTP in
Australia and the US (Garcia Martin et al., 2006).

The A. phosphatis genes from these two communities were
assigned to 26 functional classes (Supplementary Fig. S7) that
contain a total of 491 SEED subsystems (Supplementary Fig. S8). Of
these, 142 (29%) were assigned fewer than 10 sequences from either
sample and were not considered ﬁirther. The number of statistically
signiﬁcant features (P-value f 0.05) identiﬁed using Fisher”s exact
test was 116 (33%) and varied between 107 and 120 for the
other statistical hypothesis tests considered (Supplementary Table
S10). Application of Storey”s FDR and the Bonferroni”s FWER
approaches reduces this to a list of 77 (22%) and 22 (6%) features,
respectively (Supplementary Table S10).

Those features identiﬁed as statistically signiﬁcant after applying
the Bonferroni correction are given in Figure 3. While ‘phosphate
metabolism” is signiﬁcantly overrepresented in the US community,
it is not clear that this overrepresentation is related to the key
polyphosphate metabolism processes in the EBPR community.
Within this group, apolipoprotein N -acyltransferases showed the
strongest overrepresentation in the US sample (P: 8.15 X 10‘4).
Other important systems include ‘general secretion pathway”,
which covers a wide range of putative functions including
exopolysaccharide biosynthesis and type II (including pilus
assembly) and III secretion systems. Several categories of transport
proteins related to metals were identiﬁed in each of the two
samples; metadata about metal ion concentrations in these systems
could reveal links between toxic metals and the systems needed to
detoxify or exclude them. Overrepresentation of mobile elements
(Tn552) and phage-associated proteins (CBSS-159087.4.peg.2189)
may indicate endemic strains of phage and mobile elements (Kunin
et al., 2008).

5 DISCUSSION

It is essential to consider potential sources of error and how they
can inﬂuence the results of statistical techniques when making
inferences about biological relevance. Comparative metagenomics

relies heavily on a ‘guilt by association” paradigm where the function
or taxonomic origin of reads is assigned according to similarity
with sequencing from a reference databases. This leads to four
notable sources of error in metagenomic proﬁles: (i) assuming
sequence similarity implies ﬁinctional similarity, (ii) database
bias favoring certain functional subsystems or taxonomic units,
(iii) misannotations resulting in reads being incorrectly associated
with a speciﬁc functional or taxonomic category and (iv) reads
with no reliable match in a database being effectively discarded.
Investigating the seriousness of these sources of errors is an active
area of research (Eisen, 1998; Friedberg, 2006; Schnoes et al.,
2009). Knowledge of effect size, CI width and number of sequences
assigned to a feature is essential when deciding if these sources
of error have the potential to explain the observed enrichment or
depletion of a statistically signiﬁcant subsystem or taxonomic unit.

For statistical techniques to aid biological inference, they must
be interpreted and reported correctly. STAMP provides a graphical
environment for performing statistical analyses and interactively
exploring results through publication quality plots with sufﬁcient
information to inferring biological relevance. These capabilities
make STAMP a valuable tool that will aid researchers in interpreting
and communicating the results of their statistical analyses.

ACKNOWLEDGEMENTS

We would like to thank Dennis Wong for insightful discussions and
providing us with the EBPR reads from Candidatus A.phosphatis,
and Michael Porter for help with the Macintosh version of STAMP.

Funding: Killam Trusts (to D.H.P.). R.G.B. acknowledges the
support of Genome Atlantic and the Canada Research Chairs
program.

Conﬂict of Interest: none declared.

REFERENCES

Abdi,H. (2007) Encyclopedia of Measurement and Statistics. Sage, Thousand Oaks, CA.

Agrawa1,D. (2005) Inappropriate interpretation of the odds ratio: oddly not that
uncommon. Pediatrics, 116, 161271613.

Agresti,A. (1990) Categorical Data Analysis. Wiley, New York.

Agresti,A. (1992) A survey of exact inference for contingency tables. Stat. Sci., 7,
1317153.

Agresti,A. (1999) On logit conﬁdence intervals for the odds ratio with small samples.
Biometrics, 55, 5977602.

Allen,M.A. et al. (2009) The genome sequence of the psychrophilic archaeon,
Methanococcoides burtonii: the role of genome evolution in cold adaptation.
ISMEJ., 3, 101271035.

Bamard,G.A. (1947) Signiﬁcance tests for 2 x 2 tables. Biometrika, 34, 1237138.

Bamard,G.A. (1989) On alleged gains in power from lower P-values. Stat. Med, 8,
146971477.

Bland,J.M. and Altman,D.G (2000) The odds ratio. BMJ, 320, 1468.

Béja,O. et al. (2000) Bacterial rhodopsin: evidence for a new type of phototrophy in
the sea. Science, 289, 190271906.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. Royal Stat. Soc. B, 57, 2897300.
Brulc,J. et al. (2009) Gene-centric metagenomics of the ﬁber-adherent bovine rumen
microbiome reveals forage speciﬁc glycoside hydrolases. Proc. NatlAcad. Sci. USA,

106, 194871953.

Cochran,W.G (1952) The chi-square test of goodness of ﬁt. Ann. Math. Stat., 23,
3157345.

Cole,J.R. et al. (2009) The Ribosomal Database Project: improved alignments and new
tools for rRNA analysis. Nucleic Acids Res, 37, D1417D145.

Dinsdale,E. et al. (2008a) Functional metagenomic proﬁling of nine biomes. Nature,
452, 6297632.

 

720

112 /3.Io's[sumoprOJXO'soiwuiJOJHrorq”:duq 111011 pepeo1umoq

9103 ‘1gisn8nv 110::

Biological differences between metagenomic communities

 

Dinsdale,E. et al. (2008b) Microbial ecology of four coral atolls in the Northern Line
Islands. PLoS ONE, 3, 61584.

Edwards,R. et al. (2006) Using pyrosequencing to shed light on deep mine microbial
ecology. BMC Genomics, 7, 57.

Eisen,J.A. (1998) Phylogenomics: improving functional predictions for uncharacterized
genes by evolutionary analysis. Genome Res, 8, 1637167.

Friedberg,I. (2006) Automated protein function predictionethe genomic challenge.
Brief Bioinform., 7, 2257242.

Garcia,M.H. et al. (2006) Metagenomic analysis of two enhanced biological phosphorus
removal (EBPR) sludge communities. Nat. Biotechnol., 24, 126371269.

Gianoulis,T.A. et al. (2009) Quantifying environmental adaptation of metabolic
pathways in metagenomics. Proc. Natl Acad. Sci. USA, 106, 137431379.

Haber,M.A. (1987) A comparison of some conditional and unconditional exact tests for
2 X 2 contingency tables. Commun. Stat. Simul., 16, 99971013.

Hallam,S.J. et al. (2004) Reverse methanogenesis: testing the hypothesis with
environmental genomics. Science, 305, 145771462.

Hamady,M. and Knight,R. (2009) Microbial community proﬁling for human
microbiome projects: tools, techniques, and challenges. Genome Res, 19,
114171152.

Kanehisa,M. et al. (2004) The KEGG resource for deciphering the genome. Nucleic
Acids Res, 32, D2777D280.

Kristiansson,E. et al. (2009) ShotgunFunctionalizeR: an R-package for functional
comparison of metagenomes. Bioinformatics, 25, 273772738.

Kumar,S. and Dudley,J. (2007) Bioinformatics software for biologists in the genomics
era. Bioinformatics, 23, 171371717.

Kunin,V. et al. (2008) A bacterial metapopulation adapts locally to phage predation
despite global dispersal. Genome Res, 18, 2937297.

Lawson,R. (2004) Small sample conﬁdence intervals for odds ratio. Commun. Stat.
Simul., 33, 109571113.

Ley,R.E. et al. (2006) Microbial ecology: human gut microbes associated with obesity.
Nature, 444, 102271023.

Lozupone,C. and Knight,R. (2005) UniFrac: a new phylogenetic method for comparing
microbial communities. Appl. Environ. Microbiol., 71, 822878235.

Ludbrook,J. (2008) Analysis of 2 x 2 tables of frequencies: matching test to experimental
design. Int. J. Epidemiol., 37, 143071435.

Manly,B.F.J. (2007) Manly: Randomization, bootstrap and Monte Carlo methods in
biology, 3rd edn. Chapman & Hall/CRC, Taylor & Francis Group 6000 Broken
Sound Parkway NW, Suite 3000 Boca Raton, FL, p. 455.

Markowitz,V.M. et al. (2008) IMG/M: a data management and analysis system for
metagenomes. Nucleic Acids Res, 36, D5347D538.

Mato,A.S. and Andres,A.M. (1997) Simplifying the calculation of the P-value for
Barnard”s test and its derivatives. Stat. Comput., 7, 1377143.

Mehta,C.R. and Senchaudhuri,P. (2003) Conditional versus unconditional exact tests
for comparing two binomials. http://www.cytel.com/papers/twobinomials.pdf.
Meyer,F. et al. (2008) The metagenomics RAST server 7 a public resource for
the automatic phylogenetic and functional analysis of metagenomes. BMC

Bioinformatics, 9, 386.

Mitra,S. et al. (2009) Visual and statistical comparison of metagenomes. Bioinformatics,

25, 184971855.

Mou,X. et al. (2008) Bacterial carbon processing by generalist species in the coastal
ocean. Nature, 451, 7087711.

Nakagawa,S. and Cuthill,I.C. (2007) Effect size, conﬁdence interval and statistical
signiﬁcance: a practical guide for biologists. Biol. Rev. Camb. Phil. Soc., 82,
5917605.

Newcombe,R.G. (1998) Interval estimation for the difference between independent
proportions: comparison of eleven methods. Stat. Med, 17, 8737890.

Overbeek,R. et al. (2005) The subsystems approach to genome annotation and its use
in the project to annotate 1000 genomes. Nucleic Acids Res, 33, 589175702.

Poretsky,R.S. et al. (2009) Comparative day/night metatranscriptomic analysis of
microbial communities in the North Paciﬁc subtropical gyre. Env. Microbiol., 11,
135871375.

Qu,A. et al. (2008) Comparative metagenomics reveals host speciﬁc metavirulomes and
horizontal gene transfer elements in the chicken cecum microbiome. PLoS ONE, 3,
62945.

Rivals,I. et al. (2007) Enrichment or depletion of a GO category within a class of genes:
which test? Bioinformatics, 23, 401407.

Rodriguez-Brito,B. et al. (2006) An application of statistics to comparative
metagenomics. BMC Bioinformatics, 7, 162.

Rosenthal,R. et al. (2000) Contrasts and Eﬂect Sizes in Behavioral Research: A
Correlational Approach. Cambridge University Press, Cambridge.

Sackett,D.L. et al. (1996) Down with odds ratios! Evidence-based Med., 1, 1647166.

Schloss,P.D. et al. (2009) Introducing mothur: open-source, platform-independent,
community-supported software for describing and comparing microbial
communities. Appl. Environ. Microbiol., 75, 753777541.

Schnoes,A.M. et al. (2009) Annotation error in public databases: misannotation of
molecular function in enzyme superfamiles. PLoS Comput. Biol., 5, 61000605.
Sistrom,C.L. and Garvan,C.W. (2004) Proportions, odds, and risk. Radiology, 230,

12719.

Storey,J.D. and Tibshirani,R. (2003) Statistical signiﬁcance for genomewide studies.
Proc. Natl Acad. Sci. USA, 100, 94409445.

Storey,J.D. et al. (2004) Strong control, conservative point estimation, and simultaneous
conservative consistency of false discovery rates: a uniﬁed approach. J. Royal Stat.
Soc. B, 66, 1877205.

Tringe,S.Gi et al. (2005) Comparative metagenomics of microbial communities.
Science, 308, 55L557.

Turnbaugh,P.J. et al. (2006) An obesity-associated gut microbiome with increased
capacity for energy harvest. Nature, 444, 102771031.

Turnbaugh,P.J. et al. (2009) A core gut microbiome in obese and lean twins. Nature,
457, 480—484.

Urich,T. et al. (2008) Simultaneous assessment of soil microbial community structure
and function through analysis of the meta-transcriptome. PLoS ONE, 3, 62527.
White,J. R. et al. (2009) Statistical methods for detecting differentially abundant features

in clinical metagenomic samples. PLoS Comput. Biol., 5, 61000352.

Willner,D. et al. (2009) Metagenomic analysis of respiratory tract DNA viral
communities in cystic ﬁbrosis and non-cystic ﬁbrosis individuals. PLoS ONE, 4,
67370.

Yoos6ph,S. et al. (2007) The Sorcerer II Global Ocean Sampling expedition: expanding
the universe of protein families. PLoS Biol., 5, 616.

 

721

112 /3.Io's[BumoprOJXO'soneuiJOJHrorq”:duq 111011 pepeo1umoq

9103 ‘1gisn8nv 110::

