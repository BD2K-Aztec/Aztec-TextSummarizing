Bioinformatics, 32116), 2016, 2419—2426

doi: 10.1093/bioinformatics/btw209

Advance Access Publication Date: 19 April 2016
Original Paper

 

Sequence analysis

Romulus: robust multi-state identification
of transcription factor binding sites from
DNase-seq data

1,2,1‘

Aleksander Jankowski '*, Jerzy 'I'Iuryn1 and Shyam Prabhakar2

1Faculty of Mathematics, Informatics and Mechanics, University of Warsaw, 02-097 Warszawa, Poland and
2Computational and Systems Biology, Genome Institute of Singapore, Singapore 138672, Singapore

*To whom correspondence should be addressed.
TPresent address: Genome Biology Unit, European Molecular Biology Laboratory, 69117 Heidelberg, Germany
Associate Editor: Alfonso Valencia

Received on September 18, 2015; revised on March 23,2016; accepted on April 12, 2016

Abstract

Motivation: Computational prediction of transcription factor (TF) binding sites in the genome re—
mains a challenging task. Here, we present Romulus, a novel computational method for identifying
individual TF binding sites from genome sequence information and cell—type—specific experimental
data, such as DNase—seq. It combines the strengths of previous approaches, and improves robust—
ness by reducing the number of free parameters in the model by an order of magnitude.

Results: We show that Romulus significantly outperforms existing methods across three sources
of DNase—seq data, by assessing the performance of these tools against ChlP—seq profiles. The dif—
ference was particularly significant when applied to binding site prediction for low—information—
content motifs. Our method is capable of inferring multiple binding modes for a single TF, which
differ in their DNase I cut profile. Finally, using the model learned by Romulus and ChlP—seq data,
we introduce Binding in Closed Chromatin (BCC) as a quantitative measure of TF pioneer factor ac—
tivity. Uniquely, our measure quantifies a defining feature of pioneer factors, namely their ability to
bind closed chromatin.

Availability and Implementation: Romulus is freely available as an R package at http://github.com/
ajank/Romulus.

Contact: ajank@mimuw.edu.pl

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Eukaryotic transcription is an extremely complex process, controlled
by transcription factor (TF) binding to regulatory elements in multiple
locations in the genome. The traditional method of analyzing individ-
ual active regulatory elements in the genome involves the digestion by
DNase I and subsequent identification of regions where TFs are bound
to the DNA fragment and protect the DNA from degradation by the
enzyme. These protected sites, or TF footprints, can be identified on a
large scale by a more recent protocol, DNase I digestion followed by
high-throughput sequencing (DNase-seq) (Crawford et (11., 2006).

(C7 The Author 2016. Published by Oxford University Press.

CENTIPEDE (Pique—Regi et (11., 2011) was the first algorithm
aimed at combining sequence information with chromatin state data
to identify the sites where a particular TF was bound in the genome.
This method relied on the presence of a DNA sequence motif at candi-
date binding sites. A logistic regression model allowed for multiple
types of prior information to be incorporated, e.g. Position Weight
Matrix (PWM) score, distance to the nearest Transcription Start Site
and sequence evolutionary conservation. The posterior component
consisted of a combination of negative binomial and multinomial pos-
itional models for each type of experimental data, such as DNase-seq
or histone modification ChIP-seq. Overall, the main strength of

2419

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

2420

A.Jankowski et al.

 

CENTIPEDE is the ability to identify binding sites for multiple TFs
from a single DNase—seq experiment.

MILLIPEDE (Luo and Hartemink, 2013), a method inspired by
CENTIPEDE, also aims at identifying TF binding sites, and also com—
bines DNase digestion data with TF binding specificity information,
but performs the analysis in a supervised manner. The supervised ap—
proach allows for the model to be explicitly trained to discriminate
bound and unbound sites, but requires to provide such a classification
as input. The method of MILLIPEDE is a simplification of the
CENTIPEDE approach. Instead of a comprehensive combination of
negative binomial and multinomial models to represent the positional
distribution of DNase I cuts, these cuts were grouped into several (e.g.
5 or 12) bins. The log—transformed DNase I cut counts within these
bins were incorporated in the logistic regression model, together with
all the prior information. Overall, the number of parameters in
MILLIPEDE is at least an order of magnitude smaller than in
CENTIPEDE. The authors showed that MILLIPEDE outperforms
CENTIPEDE marginally in human but dramatically in yeast. This
was attributed mostly to avoiding over—fitting of parameters by focus—
ing on a more coarse—grained set of features, capturing the large—scale
differences between the bound and unbound states. The selection of
optimal discriminative features is a hallmark of another similar
method, BinDNase (Kahara and Lahdesmaki, 2015), which also fol—
lows the supervised approach and outperforms MILLIPEDE.

Wellington (Piper et al., 2013) is another recent algorithm to pre—
dict occupied TF binding sites from DNase—seq data. This algorithm
is based on a completely different approach, and does not require a
DNA sequence motif to identify the prior set of candidate binding
sites. Instead, Wellington quantifies an imbalance in the DNA
strand—specific alignment information of DNase—seq data around
virtually every location in the genome. The authors argue that in a
‘double hit’ DNase—seq experiment, where each end of a DNA frag—
ment represents an in vivo DNase I cleavage site, most of the DNA
fragments captured for sequencing are in the order of 50—150 bp in
length, and they are expected to originate from within the DNase I
hypersensitive sites, as opposed to nucleosomal DNA.

Since the length of DNase I hypersensitive sites is usually 200—
250 bp, the captured fragments are likely to span the regions of DNA
protected by bound TFs. These captured fragments manifest them—
selves after sequencing as 5’ sequence tags, representing just one end
of these fragments. Hence, a typical DNase I hypersensitive site should
be enriched in forward strand tags upstream and in reverse strand tags
downstream of bound TFs. Wellington takes advantage of this strand
imbalance criterion to greatly increase the specificity by reducing the
number of false positives. For each basepair, Wellington tests the hy—
pothesis that there are significantly more reads aligning to the forward
strand in the upstream shoulder region with respect to the reads align—
ing to the forward strand in the footprint region. Moreover, a reverse
complement hypothesis is tested, i.e. that there are significantly more
reads aligning to the reverse strand in the downstream shoulder region
with respect to the reads aligning to the reverse strand in the footprint
region. The final Wellington P—value for a given genomic location is a
product of the two for the aforementioned hypotheses.

None of the existing methods mentioned above allows for direct
incorporation of knowledge about TF complexes which could be
formed by the TF of interest. The comprehensive knowledge of such
functional structures is essential to fully understand the mechanisms
of transcriptional regulation. Recently, several computational meth—
ods are focused on the identification of the putative structures of TF
complexes that bind cooperatively to DNA, using ChIP—seq
(Whitington et al., 201 1) or chromatin accessibility data (Jankowski
et al., 2014; Kazemian et al., 2013). Such a prior information on TF

complex structures should be incorporated by the methods aimed at
identification of individual TF binding sites.

Here, we propose Romulus, a novel computational method to ac—
curately identify TF footprints from genome sequence information and
cell—type—specific experimental data, such as DNase—seq data. Our ap—
proach combines the strengths of CENTIPEDE and Wellington, while
keeping the number of free parameters in the model relatively low. For
a given TF, we first identify candidate binding sites that have above—
background sequence affinity, using a Position Weight Matrix. Then,
following CENTIPEDE, we employ an Expectation—Maximization—
based approach to simultaneously learn the DNase I cut profiles and
classify the binding sites as bound or unbound by the TF.

Our method allows for multiple bound states for a single TF, dif—
fering in their cut profile and overall number of DNase I cuts. To
make the model robust, we employ a systematic approach to group
the DNase I cuts, according to their location and strand. Inspired by
Wellington, we take the forward strand DNase I cuts only upstream
and within the binding site, while the reverse strand DNase I cuts
only within the binding site and downstream. We model the total
number of cuts as a negative binomial component, while the cut dis—
tribution (regularized by binning outside the binding site) is mod—
elled as a multinomial component.

Overall, Romulus predictions agree well with experimental ChIP—
seq measurements of TF binding at candidate motif instances. We also
comprehensively compared the predictive performance of Romulus,
CENTIPEDE and Wellington, and show that Romulus significantly
outperformed CENTIPEDE and Wellington, especially when applied
to DNase—seq datasets with lower sequencing depth. Finally, we intro—
duce Binding in Closed Chromatin (BCC), a single statistic represent—
ing the chromatin state component of Romulus for ChIP—seq—inferred
binding sites, as a quantitative correlate of pioneer factor activity.

Romulus is available as an R package at http://github.com/ajank/
Romulus, along with documentation and examples, under the terms
of GNU GPL v3 open source software license.

2 Methods

2.1 DNase—seq data from multiple sources

The ENCODE Project (Bernstein et al., 2012) provides three
different tracks with human DNase—seq data. The track
ngncodeOpenChromDnase from Duke University (Duke) follows
the ‘single hit’ protocol (Boyle et al., 2008), while ngncoderDnase
and ngncoderDgf, both from University of Washington (UW), fol—
low the ‘double hit’ protocol (Sabo et al., 2006). The latter track,
termed Digital Genomic Footprinting (DGF) yields much higher num—
ber of sequencing reads (Supplementary Table 51). We used all tracks
in three cell types: A549, HepG2 and K5 62.

2.2 ChlP—seq data as a TF binding benchmark

We downloaded a collection of human ChIP—seq datasets (narrowPeak
files) from ENCODE and used them as a gold standard for benchmark—
ing TF binding predictions (Supplementary Table 52). This collection of
datasets was also used to assess the performance of Wellington in (Piper
et al., 2013). The corresponding DNA sequence motifs (Supplementary
Table S3) for these TFs were taken from the HOMER (Hypergeometric
Optimization of Motif EnRichment) suite (Heinz et al., 2010).

The motif instances in the human genome for these motifs were
downloaded from http://homer.salk.edu/homer/ (HOMER Known
Motifs track). We considered these motif instances as candidate
binding sites (test cases) in performance assessment of the three
methods. The reference classification of the candidate binding sites

ﬁlO'SWHmOIpJOJXO'SODBIIIJOJIIIOICV/Idnq

Rom ulus

2421

 

was obtained as follows: motif instances overlapping any ChIP—seq
peak were classified as bound, and all the remaining ones were clas—
sified as unbound.

2.3 Prior probabilities of TF binding

The prior component of the model captures the genomic sequence
and other prior (i.e. independent of cell type or conditions) charac—
teristics of the candidate binding site for a given TF. Let us denote
by i a particular genomic instance (motif match) of a motif of inter—
est. Typically, the prior characteristics assigned to motif instances
could be: the respective PWM score, average evolutionary conserva—
tion and so on.

To formalize the model, let us denote the value of the jth prior
characteristic for motif instance 1' by a real number xi”), where 1 g j
S ]. In the simplest case, where each motif instance can be either
‘bound’ or ‘unbound’, we apply a logistic approach to model the
ratio of the prior probabilities:

P(Zi : 1)/P(Zi : 0) : exp(ﬁo + Z,./3,in”).

Here, Z, : 1 indicates that the ith motif instance is bound,
whereas Z, : 0 indicates that it remains unbound. Such a model has
been used in CENTIPEDE (Pique-Regi et al., 2011).

We generalize the above—described model. Let us consider a TF
that manifests one or more cooperative binding modes, with well—
defined offsets and orientations within the underlying motif com—
plexes. The cooperative binding modes, and the corresponding
motif complexes, will be both denoted by k :2, . . ., K+ 1, where
K is the number of cooperative binding modes. Each of these com—
plexes imposes certain offset and orientation of the partner motif
with respect to the primary motif (Jankowski et al., 2013, 2014).
The genomic location of the motif instance 1' therefore implies the
corresponding locations for all partner motifs within all defined
motif complexes. The prior characteristics for these partner motif
instances are calculated no matter how unfavourable they may be
for binding, and are included in the sequence 99(7), where 1 3/ 3].
Note that in the homodimer case, some of these characteristic may
be derived from the same PWM, however scored at a different gen—
omic location.

Now let us focus on a particular cooperative binding mode k,
where 23 k g K+ 1. We introduce binary indicators VI“) 6 {0.1},
specifying whether the prior characteristic ximshould be taken into
account in a cooperative binding mode k. The values of these indica—
tors ensure that only the characteristics specific to the primary motif
instance and to the partner motif instances within kth motif complex
will be taken into account. The monomer binding mode, denoted by
k : 1, should be characterized only by the characteristics referring to
the primary motif instance. Hence, VI“) : 0 for all the characteris—
tics / referring to any of the partner motifs. To model the prior prob—
abilities, we apply a logistic model against the unbound ‘pivot’ case
of Z, : 0:

Hz. 2 k>/P<z,- 2 o) 2 exprﬁor) + Emrwraru.

where Z, : 0 indicates no binding, Z,: 1 refers to binding as mono—
mer, and Z,:2, . . ., K + 1 refer to the respective cooperative bind—
ing modes. This way, we have K + 1 outcomes separately regressed
against the pivot outcome Z, : 0 (see Supplementary Methods).

2.4 Chromatin state component
The chromatin state component of the model captures the cell—type—
specific and condition—specific experimental data around the

candidate binding sites. Typically, these experimental data will in—
clude DNase—seq or histone modification ChIP—seq profiles. In this
study, we use DNase—seq profiles around the candidate binding sites,
but other types of data might be used as well.

For each motif instance 1', we consider the numbers of DNase I
cuts at individual basepairs in the vicinity in a strand—specific man—
ner. The forward strand cuts are taken only upstream and within the
candidate binding site, while the reverse strand cuts only within the
candidate binding site and downstream. In this study, we consider a
200 bp margin. Assuming that L is the length of the motif, the ma—
trix DNase+,,, contains the numbers of forward strand DNase I cuts
(genomic positions [:1, ..., 200+L, relative to the position of
motif instance, starting 200 bp upstream of the motif, continuing
downstream), and the matrix DNase], contains the numbers of re—
verse strand cuts ([2 1, . . ., 200 +L, starting at the motif, continu—
ing downstream). We consider such matrices for all the chromatin
state data available to the model.

We also observed that all kinds of datasets based on short se—
quence reads, in particular all kinds of DNase—seq data, are prone to
artifactual spikes of reads (above 100 reads) mapped to a single lo—
cation and strand in the genome. These spikes may arise from the se—
quence fragments originating at repetitive regions with incomplete
representation in the reference genome. Hence, we applied clipping
to the number of reads mapped to a single location and strand,
choosing the threshold as the value of 99.9% quantile of all the
entries (for all i and j) of both matrices. The values above the thresh—
old were set to be equal to the threshold itself. We tried to use other
quantiles apart from the 99.9% quantile, namely 99% and 99.99%;
they all gave similar results (data not shown).

Let X, : ((DNase+i,,')/-. (DNase‘ i,,')/-....) denote all the chro—
matin state data available to the model for a given motif instance 1'.
As stated in the previous subsection, we introduce latent variables Z,
such that P(Zi : OlXi) is the probability of motif instance 1' to be
unbound, P(Zi : 1 )X,) is the probability of it being bound by
monomer, P(Z,~ : 2 )X,) is the probability of it being bound in the
first cooperative binding mode, and so on. Our primary interest is

K+1
p, 2 ZP(Z,~ 2 k)x,~) 2 1 — P(Z,~ 2 0)X,~),
12:1

i.e. the probability of the motif instance 1' to be bound in any binding
mode. It follows from the Bayes” theorem (see Supplementary
Methods) that

 

p, : K+1P(X,~)z,~ 2 k)P(Z,~ 2 k)
I —p,' 12:1:  Z 0)7

where P(Z,~ : k)/P(Z,~ : 0) is the prior component of the model dis—
cussed in the previous subsection.

The remaining conditional probabilities P(Xi)Zi:/€) for k :0,
. . ., K + 1 are modelled as follows. We assume that all the chromatin
state data included in the model are independent, given its binding
state Z,. Hence, the conditional probability is a product of the cor—
responding conditional probabilities for each type of chromatin state
data:

P(X,~lZ,~ 2 k) 2 P((DNase+,-,)l.lz,- 2 k) .P((DNase—,-,)l.1z,- 2 k)

Each of the conditional probabilities on the right side is mod—
elled separately, using a factorized model. For brevity, we discuss
the parametrization only for P((DNase+i,,')/-)Zi:k), i.e. forward
strand DNase I cuts; it is analogous for the other strand and for

ﬁm'sreumol‘pquo'sopcuuowtotq/ﬁdnq

2422

A.Jankowski et al.

 

other types of data. The first, negative binomial component cap—
tures the total number of reads mapped in the vicinity of the
motif instance 1' in binding mode k. The negative binomial distri—
bution is naturally parametrized by the success probability 17W“
6 (0.1) and the real—valued number of failures 7W9 > 0. The se—
cond, multinomial component quantifies the probability of a par—
ticular spatial distribution of the given total number of DNase I
cuts, using the multinomial distribution (see Supplementary
Methods for details).

As opposed to CENTIPEDE (Pique-Regi et al., 2011), we do not

keep a separate free parameter for each position (respective to the
motif location) and strand, but apply a more flexible approach. For
each binding mode k, we divide the positions / into one or more
bins. Let us denote by DNaseBian the bin number for position /'
in binding mode k. Note that binding modes may differ in the way
the positions are split into bins. In this study, we take 20 bp long
bins outside the motif site, and single—basepair bins within the motif
site. Moreover, for the unbound mode (k :0) we put all the pos—
itions in a single bin.
For a given binding mode k, we associate a free parameter lbw“
with each bin b : 1, . . ., BTW. However, for the multinomial distri—
bution we must provide a vector of probabilities covering every sin—
gle position in the vicinity of the motif instance. Hence, we calculate
the actual multinomial coefficients 1,102) by taking the values of 2,,
WE) for b:DNaseBin,+(k) and normalizing them so that
Ell/+02) : 1. By definition, the multinomial coefficients Zy+(0)for
the unbound state are equal, i.e. there is no positional preference for
DNase I cuts in the null model.

2.5 Expectation—Maximization approach

To estimate the model parameters (I) : ((l},(k))I-.k. (p+(k))k. (17—09%.
(7+(k))k7 (FWM (lbﬂkmkv (lb—(Uh;th we apply the EXPeCtation—
Maximization approach using a complete likelihood function. We
found no closed—form solution for (Iii-(IZIM.(#09),z and (1’09),z
that maximizes the likelihood function, hence we apply the
Broyden—Fletcher—Goldfarb—Shanno (BFGS) numerical optimiza—
tion procedure (see Supplementary Methods). To increase the ro—
bustness of the model, we employ a shrinkage estimator of the
parameters (lbﬂklhk and (lb—(klnk. For each b and k, we take
the regularized estimator 62;,W9 + (1 — 6))jbl/Zbljb), where (1),)
is the size of the bin b, and 5 is the mixing parameter, equal to 0.5
by default.

The Expectation—Maximization procedure was initialized by
assigning the prior probabilities as follows. In the monomer bind—
ing mode, we put P(Z,~ : 1)/P(Zi : 0) : 100 for the top 10% of
motif instances with highest total number of DNase—seq cuts. In a
dimer binding mode k, we put P(Zi :k)/P(Zi : 0) : 100 for the
motif instances satisfying both of the following criteria: being
within the top 10% of motif instances with highest total number of
DNase—seq cuts, and being within the top 10% of motif instances
with highest dimerization partner motif score. In the cases not
mentioned above for any bound mode k, we put
P(Z,~:k)/P(Z,~ : 0) : 0.01. This default initialization procedure
allows for robust convergence of the algorithm; other procedures
may perform similarly (Supplementary Fig. S9; see Supplementary
Methods).

We then estimate the values for (ﬁ,(k))yk, and for the first
Maximization step we take the prior probabilities as the posterior
ones. We iterate the Expectation—Maximization procedure, in each
iteration getting a revised vector of parameters, until the posterior

probabilities do not change by more than 0.001. In most of the cases
described here, the algorithm converged in fewer than 30 iterations.

3 Results

3.1 Romulus systematically outperforms existing
methods

We systematically benchmarked Romulus along with two above—
mentioned tools for TF binding site identification, CENTIPEDE
(Pique—Regi et al., 2011) and Wellington (Piper et al., 2013). As
described in the previous section, we applied all the methods in
an unsupervised manner to DNase—seq data from three ENCODE
sources: Duke DNase, University of Washington (UW) DNase
and UW Digital Genomic Footprinting (DGF). From each of the
DNase—seq data sources, sequence tag profiles were fetched for
three human cell types: A549 (lung adenocarcinoma epithelial
cell line), HepG2 (hepatocellular carcinoma cell line) and K562
(leukemia cell line). To validate the predictions, we used 39
ChIP—seq datasets from ENCODE to define genuine TF binding
sites (see Methods); note that no ChIP—seq data were used for
training.

Since both Romulus and CENTIPEDE learn a model for TF foot—
prints, we visualized these models by plotting their multinomial
components for representative cases (Fig. 1). Clearly, the DNase I
cut profiles fitted by CENTIPEDE capture much more noise than
their Romulus counterparts. Note that the curves for Romulus were
smoothed for the purpose of visualization by replacing the fixed—
value bins by a piecewise linear function. The multinomial models
for Romulus were based on a far smaller number of free parameters
than their CENTIPEDE counterparts (e.g. 48 versus 825 free param—
eters for 10 bp motif and 200 bp margin), hence they are less prone
to overfitting.

To systematically benchmark the three tools, we assessed their
predictive power for each combination of cell type and TF for
which we have reference ChIP—seq data (see Methods). The stand—
ard approach in assessing binary classifier performance is the
Receiver Operating Characteristic (ROC) curve, showing the rela—
tionship between false positive rate (i.e. 1 — specificity, x axis) and
true positive rate (i.e. sensitivity, 3! axis). However, albeit routinely
performed, application of ROC curves to assess the performance
of TF binding site prediction is not adequate. These classification
tasks are characterized by highly skewed datasets containing rela—
tively small number of true positives (motif instances actually
bound by the TF) and large number of true negatives (motif in—
stances that remain unbound). Hence, the shape of ROC curves
and area under them is mostly affected by the ability of a particu—
lar tool to correctly predict unbound motif instances (Piper et al.,
2013).

To address the above—mentioned problem, we plotted Precision—
Recall curves, showing the relationship between recall (i.e. sensitiv—
ity, x axis) and precision (y axis). These curves were found to give a
more informative picture of an algorithm’s performance when clas—
sifying highly skewed datasets (Davis and Goadrich, 2006 ).
Example Precision—Recall curves for several TFs in K562 cells (Fig.
2A) suggest that Romulus outperforms the existing methods in most
of the cases. This observation is also supported by the corresponding
ROC curves (Supplementary Fig. 1A).

Common single—dimensional measures in assessing classifier
performance are the area under ROC curve (AUC—ROC) and the
area under Precision—Recall curve (AUC—PR). We calculated these
statistics for all the combinations of cell types and TFs considered,

ﬁm'sreumol‘pquo'sopcuuowtotq/ﬁdnq

———
Duke DNase Duke DNase ATFa C M C CTCF JunD
bHLHE4O bHLHE4O h ’ ‘ p.
| ‘1
l

0.60 m 0.37 0.46
0,56 0.18 0.99 0.39

UW DNase UW DNase
bHLHE4O bHLHE4O a 1 .k V
\ 1R

\

I ".22
\ 2 \
/\ \
\_
\
0.60 0.32 ‘\ 0.87 0.60
0.62 ‘ 0.45 0.88 0.63

UW DGF UW DGF UW DGF UW DGF

UW DGF UW DGF
bHLHE4O bHLHE4O r—x ..
m | \
/\ \ 0.61 \ 0.30 S : 0.93 0.64
0.55 0.19 0.91 0.52
Duke DNase Duke DNase
ELF1 ELF1
UW DNase UW DNase
ELF1 ELF1
UW DGF UW DGF
ELF1 ELF1

 

/r\

 

Supplementary Figs

 

S2 and S3
Supplementary Fig. S4 0 o o 0
0 so 0 0° 0 o o
06> o o °<m o o o °g °
(bog o o 4&8 a o o
0 Q) o cg co 0 ° 0° 0 a
m° 0 @2049 m 60 <g
0 00° 0 W 60 0 Do
. o O 00
Fig. 2B 0 °
.9

Supplementary Fig.
S1

/810'spzumo_fp10}xo"satJBmJOJutotW/zdnq

Supplementary Table S1

Fig. 3
Supplementary
Fig. 55
Fig.
3
Jankowski er al., 2013
Supplementary Table
S4
Nelson et al., 1999
Wang et al., 2011
Jankowski er al., 2013 Starick er al.,
2015

Ng er al., 2012

Fig. 4
Supplementary Fig. S6

UW DNase UW DNase

H1—hESC H1—hESC
OCT4 SOX2
0.18 0.30
0.04 0.05
g 0128
Duke DNase Duke DNase Duke DNase
LNCaP + Andro LNCaP + Andro LNCaP + Andro

 

AR siCTRL AR siFOXA1 FOXA1 siCTRL

0.06 0.46 0.30
0.01 0.02 0.06
0.01 0.19 0.12

Duke DNase Duke DNase Duke DNase

LNCaP LNCaP LNCaP

AR siCTRL AR siFOXA1 FOXA1 siCTRL
0.01 0.01 0.24
0.00 0.00 0.04
0.00 0.00 0.11

Supplementary
Fig. S7 Supplementary Fig. S8

Fig. 5

/810'spzumo_fp10}xo"satJBmJOJutotW/zdnq

ATFS A549 ATFS HeGZ ATFS K562 bHLHE40 A549 CEBP A549

 

c-M c HeGZ c—M C K562 CTCF A549 CTCF HeGZ CTCF K562

ELF1 A549 ETS1 A549 FOXA1 HeG2 GABP A549 GATA K562

 

HNF4a HeGZ JunD HeG2 JunD K562 Max A549 Max HeG2

 

Blatti er al., 2015
Supplementary Fig. S 10 Supplementary Methods

    

USF1 A549 USF1 HeGZ USF1 K562 W1 A549 ZBTB33 A549

Fig. 6

 

 

Fig. 5

Lupien er al., 2008

Garber et al., 2012

Zaret and Carroll, 2011

Fig. 5

Budry er al.,
2012

/810'spzumo_fp10}xo"satJBmJOJutotW/zdnq

2426

A.Jankowski et al.

 

When allowing for more than one bound state in Romulus, we
found that the additional DNase I cut profiles can differ greatly.
However, the inclusion of these additional states for the known TF
dimers did not yield an increase in predictive power. We hypothesize
that three factors potentially contributed to this effect. Firstly, dimer
binding sites constitute only a small fraction of all binding sites, and
thus the overall improvement from considering dimer binding modes
is necessarily limited. Secondly, dimer binding may not induce
strong changes in the DNase I cut profile, relative to monomer bind—
ing. Rather, the profile shape could be influenced to a greater degree
by other parameters, such as the width of the hypersensitive region,
the location of the binding site in question with respect to the centre
of the region, and the spatial distribution of neighbouring binding
sites. If so, the shape of the DNase I cut profile would be only
weakly indicative of the binding mode. Finally, inclusion of add—
itional binding modes substantially increases the number of free par—
ameters in the model, which increases the likelihood of overfitting.

A recent computational method, protein interaction quantitation
(PIQ), used the correlation between TF binding and chromatin
openness to identify TFs that function as pioneer factors (Sherwood
et al., 2014). We have shown the value of a different approach that
prioritizes binding sites in closed chromatin. We propose that this
Binding in Closed Chromatin (BCC) score is a quantitative correlate
of pioneer factor activity. In other words, BCC values constitute a
measure of a TF’s ability to bind nucleosome—occluded DNA.
Indeed, multiple known pioneer factors were detected as having
high BCC scores. Notably, while PIQ requires data from two differ—
ent experimental conditions (before and after differentiation, for ex—
ample) to identify pioneer factors, the calculation of BCC requires
data from one condition only. Note that the BCC scores of some
TFs varied significantly across cell types. While some of this vari—
ability could be attributable to biological factors such as variation in
TF expression, technical factors may also play a role. For example,
closed—chromatin binding sites, which tend to be weaker, would be
detected in smaller numbers in the noisier ChIP—seq datasets.

Intriguingly, CT CF and NRSF (REST) were predicted both by
BCC and PIQ as pioneer factors, despite the use of divergent strategies
by the two algorithms. A unique feature shared by these two TFs is
that they have long, information—rich PWMs (both 20 bp; 32.7 and
34.9 bits of information, respectively) and bind DNA strongly using
multiple zinc—finger domains. They could therefore potentially bind
DNA ‘alone,’ without requiring co—binding by neighbouring factors
over 50—100 bp. In such a scenario, CT CF and NRSF could tightly
bind a 20—bp stretch of DNA closely flanked by nucleosomes, leaving
little room for DNA cleavage by DNase I. This would explain the
high BCC scores of these two TFs. On the other hand, given their
high DNA affinity, they would also be likely to bind motif instances
in promoter or enhancer regions characterized by highly open
chromatin. Thus, they would be predicted as pioneer TFs by both
methods, but for different reasons. Pioneer TFs with fewer DNA—
binding domains could adopt yet another configuration: they have
been shown to bind DNA that is wrapped around a histone octamer
(Iwafuchi—Doi and Zaret, 2014), Given the diversity of such possibil—
ities, we anticipate that TF—DNA binding predictions will eventu—
ally need to account for multiple binding ‘strategies,’ each defined by
the precise nature of the interplay between the TF and nucleosomes.

Funding

This work was supported by the National Science Centre, Poland [DEC-
2012/05/B/NZ2/00567 to ].T.], and the Agency for Science, Technology and
Research (A’r STAR), Singapore.

Conﬂict of Interest: none declared.

References

Blatti,C. et al. (2015) Integrating motif, DNA accessibility and gene expression
data to build regulatory maps in an organism. Nucleic Acids Res., 43,
3998—4012.

Bernstein,B.E. et al. (2012) An integrated encyclopedia of DNA elements in
the human genome. Nature, 489, 57—74.

Boyle,A.P. et al. (2008) F-Seq: a feature density estimator for high-throughput
sequence tags. Bioinformatics, 24, 2537—2538.

Budry,L. et al. (2012) The selector gene Pax7 dictates alternate pituitary cell fates
through its pioneer action on chromatin remodeling. Genes Dev., 26, 2299—2310.

Crawford,G.E. et al. (2006) Genome-Wide mapping of DNase hypersensitive
sites using massively parallel signature sequencing (MPSS). Genome Res.,
16, 123—131.

Davis,]. and Goadrich,M. (2006) The Relationship Between Precision-Recall
and ROC Curves. In: Proceedings oftlze 23rd International Conference on
Machine Learning, ICML ’06. ACM, New York, NY, USA, pp. 233—240.

Garber,M. et al. (2012) A high-throughput chromatin immunoprecipitation
approach reveals principles of dynamic gene regulation in mammals. Mol.
Cell, 47, 810—822.

Heinz,S. et al. (2010) Simple combinations of lineage-determining transcrip-
tion factors prime cis-regulatory elements required for macrophage and B
cell identities. Mol. Cell, 38, 576—589.

Iwafuchi-Doi,M. and Zaret,K.S. (2014) Pioneer transcription factors in cell
reprogramming. Genes Dev., 28, 2679—2692.

Jankowski,A. et al. (2013) Comprehensive prediction in 78 human cell lines
reveals rigidity and compactness of transcription factor dimers. Genome
Res., 23,1307—1318.

Jankowski,A. et al. (2014) TACO: a general-purpose tool for predicting cell—
type—speciﬁc transcription factor dimers. BMC Genomics, 15, 208.

Kahara,]. and Lahdesmaki,H. (2015) BinDNase: a discriminatory approach
for transcription factor binding prediction using DNase I hypersensitivity
data. Bioinformatics, 31, 2852—2859.

Kazemian,M. et al. (2013) Widespread evidence of cooperative DNA binding
by transcription factors in Drosophila development. Nucleic Acids Res., 41,
8237—8252.

Luo,K. and Hartemink,A.]. (2013) Using DNase digestion data to accurately iden-
tify transcription factor binding sites. Pac. Symp. Biocomput., 2013, 80—91.

Lupien,M. et al. (2008) FoxAl translates epigenetic signatures into enhancer—
driven lineage-speciﬁc transcription. Cell, 132, 958—970.

Nelson,C.C. et al. (1999) Determinants of DNA sequence speciﬁcity of
the androgen, progesterone, and glucocorticoid receptors: evidence for
differential steroid receptor response elements. Mol. Endocrinol., 13,
2090—2107.

Ng,C.K.L. et al. (2012) Deciphering the Sox—Oct partner code by quantitative
cooperativity measurements. Nucleic Acids Res., 40, 4933—4941.

Piper,]. et al. (2013) Wellington: a novel method for the accurate identiﬁcation of
digital genomic footprints from DNase-seq data. NucleicAcids Res., 41, e201.
Pique-Regi,R. et al. (2011) Accurate inference of transcription factor binding
from DNA sequence and chromatin accessibility data. Genome Res., 21,

447—455.

Sabo,P.J. et al. (2006) Genome-scale mapping of DNase I sensitivity in vivo
using tiling DNA microarrays. Nat. Methods, 3, 511—518.

Sherwood,R.I. et al. (2014) Discovery of directional and nondirectional pion-
eer transcription factors by modeling DNase proﬁle magnitude and shape.
Nat. Biotechnol, 32, 171—178.

Starick,S.R. et al. (2015) ChIP-exo signal associated with DNA-binding motifs
provides insight into the genomic binding of the glucocorticoid receptor and
cooperating transcription factors. Genome Res., 25, 825—835.

Wang,D. et al. (2011) Reprogramming transcription by distinct
classes of enhancers functionally deﬁned by eRNA. Nature, 474, 390—394.
Whitington,T. et al. (2011) Inferring transcription factor complexes from

ChIP-seq data. Nucleic Acids Res., 39, e98.

Zaret,K.S. and Carroll,].S. (2011) Pioneer transcription factors: establishing

competence for gene expression. Genes Dev., 25, 2227—2241.

ﬁm'srcumol‘pquo'sopeuuowtotq/ﬁdnq

