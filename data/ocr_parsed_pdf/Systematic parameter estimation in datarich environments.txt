ORIGINAL PAPER

Vol. 29 no. 8 2013, pages 1044—1051
doi:10. 1 093/bioinformatics/bt1083

 

Systems biology

Advance Access publication February 19, 2018

Systematic parameter estimation in data-rich environments

for cell signalling dynamics

Tri Hieu Nim‘, Le Luoz, Marie-Véronique Clementz, Jacob K. White“3 and

Lisa Tucker-Kellogg1 '4'5'*

1Computational Systems Biology Programme, Singapore-MIT Alliance, Singapore 1 17576, 2Department of Biochemistry,
Yong Loo Lin School of Medicine and the National University of Singapore Graduate School of Integrative Sciences and
Engineering, National University of Singapore, Singapore 119260, 3Department of Electrical Engineering and Computer
Science, MIT, Cambridge, MA 02139, USA, 4Mechanobiology Institute, National University of Singapore, Singapore
117411 and 5Department of Dermatology, State University of New York, Stony Brook, NY 11794, USA

Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: Computational models of biological signalling networks,
based on ordinary differential equations (ODEs), have generated many
insights into cellular dynamics, but the model-building process typic-
ally requires estimating rate parameters based on experimentally
observed concentrations. New proteomic methods can measure con-
centrations for all molecular species in a pathway; this creates a new
opportunity to decompose the optimization of rate parameters.
Results: In contrast with conventional parameter estimation methods
that minimize the disagreement between simulated and observed con-
centrations, the SPEDRE method fits spline curves through observed
concentration points, estimates derivatives and then matches the de-
rivatives to the production and consumption of each species. This
reformulation of the problem permits an extreme decomposition of
the high-dimensional optimization into a product of low-dimensional
factors, each factor enforcing the equality of one ODE at one time
slice. Coarsely discretized solutions to the factors can be computed
systematically. Then the discrete solutions are combined using loopy
belief propagation, and refined using local optimization. SPEDRE has
unique asymptotic behaviour with runtime polynomial in the number of
molecules and timepoints, but exponential in the degree of the bio-
chemical network. SPEDRE performance is comparatively evaluated
on a novel model of Akt activation dynamics including redox-mediated
inactivation of PTEN (phosphatase and tensin homologue).
Availability and implementation: Web service, software and supple-
mentary information are available at www.LtkLab.org/SPEDRE
Supplementary information: Supplementary data are available at
Bioinformatics online.

Contact: LisaTK@nus.edu.sg

Received on May 10, 2012; revised on November 29, 2012; accepted
on February 13, 2013

1 INTRODUCTION

Dynamic behaviours of biochemical networks can be captured
by ordinary differential equation (ODE) models that compute

 

*To whom correspondence should be addressed

the change of molecular concentrations with respect to
time (Fall et al., 2002; Palsson, 2006). For most biochemical
pathways with known topology, most reaction rate constants
(i.e. the coefﬁcients of the differential equations) are not
available from direct experiments. Rate parameters are typically
estimated by regression, in other words by ﬁtting the global
behaviour of the simulated model to the experimentally observed
concentrations. This is a difficult high-dimensional non-linear
problem, and search strategies often experience poor conver-
gence and local optima (Kleinstein et al., 2006). The rate param-
eter estimation problem can naturally be formulated as
minimizing a sum of squared errors (SSE), where each error is
a difference between simulated concentration and observed con-
centration, and the summation is over time points and/or experi-
mental treatments. Optimizing this type of SSE objective
function can be attacked using a variety of ‘traditional’ global
and local search methods: LM (LevenbergiMarquardt, local),
SD (steepest descent, local), SRES (stochastic ranking evolu-
tion strategy, global), PSO (particle swarm optimization,
global) and GA (genetic algorithm, global) (Fogel et al., 1991;
Kennedy and Eberhart, 1942; Levenberg, 1944; Marquardt,
1963; Michalewicz, 1994; Runarsson and Yao, 2000). Local
and global search methods both have drawbacks, and globali
local hybrid searches have also become popular (Ashyraliyev
et al., 2008; Fomekong—Nanfack et al., 2007; Rodriguez-
Fernandez et al., 2006).

Traditional search methods generate a full vector of rate par-
ameters, simulate the model with this full set of parameters and
then accept, reject or adjust the parameters based on how well
the simulation agrees with experimental measurements. For net-
works with few unknown parameters, these ‘simulate-and—match’
methods have been successful at ﬁnding good values, or multiple
good candidates. The search space for parameter vectors is ex-
ponential, and the inevitable trend with any type of exponential
growth is that there will eventually be a large enough number of
unknown parameters, such that reasonable sampling will not
explore very many of the ‘basins of convergence’, and the results
will deteriorate. Indeed many high-impact models of biological
pathways continue to be built without automating the parameter
estimation process (Albeck et al., 2008; Basak et al., 2007; PurVis
et al., 2008).

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0[p10}x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIII/IAOG

9103 ‘Og isnﬁnV uo ::

Data-rich estimation of reaction rate parameters

 

In contrast to standard ‘simulate-and—match’ methods of par-
ameter estimation, spline-based collocation methods have re-
cently been developed that use experimental observations of a
protein over time to interpolate the time derivative of the con-
centration, rather than computing the derivatives based on simu-
lating the ODEs. Traditional methods minimize the Violation of
experimental observations, subject to obeying the ODE trajec-
tories, while the spline-based collocation methods can be seen as
optimizing a dual-like objective function because they minimize
the Violation of the ODE trajectories, subject to obeying the ex-
perimental observations. Note that the spline-based collocation
methods require an extensive input dataset with observations for
many or all of the proteins. In the past, few large networks had
such comprehensive measurements available, but recent trends in
proteomic technology (Zhang and Neubert, 2009) suggest that
data-rich cases may be increasingly common in the future.

Several spline-based collocation methods have been published
recently for the context of biological networks. A spline-based
collocation scheme for parameter fitting problems using a mod-
iﬁed data-smoothing method and a generalization of proﬁled
estimation was proposed by Ramsay et a]. (2007). A similar
method for problems with high noise and short time-course
was introduced by Brewer et a]. (2008). Zhan and Yeung
(2011) used non-linear programming (NLP) to optimize the
dual objective. Several ‘decoupling’ strategies (Jia et al., 2011;
Vilela et al., 2009; Voit and Almeida, 2004) also use some
forms of ‘slope approximation’ from time-series data to avoid
doing multiple simulations. Estimating ODE parameters has
been studied in the mathematical literature for decades, and an
important class of data-rich methods called ‘multiple shooting’
(Bock, 1983; Bock and Schloder, 1986a, b) has recently been
applied to biological networks (Peifer and Timmer, 2007).

To the best of our knowledge, no data-rich parameter estima-
tion methods have implementations publicly available for prac-
tical problems with biological networks. The asymptotic runtime
of data-rich methods has also been neglected. Many data-rich
methods have been published with claims of good accuracy, but
to the best of our knowledge, efﬁciency and runtime have not yet
been compared with state-of-the-art, ‘simulate-and-match’ par-
ameter estimation methods.

Scalability with network size is a major remaining challenge in
the parameter estimation ﬁeld, regardless of the objective func-
tion or optimization approach. A common strategy for large
systems is to decompose the problem. However, the objective
functions of parameter estimation are not generally decompos-
able. Some decomposition approaches exploit speciﬁc situations,
such as having derivatives available at all timepoints (Chou et al.,
2006), or having small sub-networks connected by species with
observed concentrations (Koh et al., 2006). The dual-like object-
ive functions of spline-based collocation methods are not readily
decomposable, but they do exhibit the important property of
sparse interdependence (‘locality’) between the variables. This
locality can be a basis for conditional decomposition.

Belief propagation [see (Meltzer et al., 2009) review and (Pearl,
1988) textbook] is an inference method for probabilistic graph-
ical networks with sparse interdependence or locality. It can
compute the maximum a posteriori (MAP) values for variable
parameters in a factor graph, given joint probability distributions
that describe the dependencies between adjacent variables. For

acyclic graphs, belief propagation guarantees exact optima, and
for general graphs, a variant called ‘loopy belief propagation’
(LBP) has had empirical success at approximating the MAP
(McEliece et al., 1998; Murphy et al., 1999).

Our method of Systematic Parameter Estimation in Data-Rich
Environments (SPEDRE) optimizes the dual objective approxi-
mately, Via LBP. The innovation is conditional decomposition of
the problem into local terms, with pre—computed look-up tables
for the discretized solutions to the local terms of the dual object-
ive function. SPEDRE provides dramatic improvement in em-
pirical efﬁciency, and in effect brings the spline-based collocation
(dual objective) methods to the same level of efficiency as the
state-of-the-art (primal objective) methods. Asymptotic runtime
is polynomial with respect to the number of species, parameters
and timepoints in the biological networks, while it is exponential
only in the degree of the network.

Finally, we compare the scalability and robustness of
SPEDRE against state-of—the-art standalone and hybrid param-
eter estimation methods, using both a spectrum of artiﬁcial cases,
and also a novel model of Akt activation based on our previous
experimental studies of Akt (Lim and Clement, 2007). Aberrant
hyper-activation of the Akt pathway has been detected in up to
50% of all human tumours, and the Akt pathway is an attractive
target for anti-cancer drug discovery (Mitsiades et al., 2004). Our
model of Akt includes oxidative inactivation of the lipid phos-
phatase and tensin homologue on chromosome 10 (PTEN), as
well as the phosphatidylinositol 3-kinases (PI3K) activation, as
competing regulators of Akt in serum-stimulated ﬁbroblasts
(Kwon et al., 2004; Testa and Bellacosa, 2001). A more detailed
understanding of PTEN dynamics is important because many
cancers activate Akt through disruptions of PTEN.

2 PRELIMINARIES
2.1 Ordinary differential equations

The production and consumption of each species in a biochem-
ical system can thus be described using ODEs. For example,
consider a two-species artificial pathway AZB. Using k1 (and
k2) to denote the forward (and reverse) reaction rates, we can
model the system as follows:

$10.13) = —k1A(r,I€) + 1930,12)

d i i i (1)
E30, k) = k1A(t,k) — 1:230, k)

For the simplicity of later ﬁgures, our example uses mass
action, but more general equations are also permitted. Solving
these equations (1) provides the time evolution of the species,
dependent on rate parameter vector k. The inverse problem,
estimating the rate parameters from observed levels of the spe-
cies, is a deceptively difficult non-linear optimization problem
(Kleinstein et al., 2006). We deﬁne the degree of each ODE to
be the number of terms in its right hand side, analogous to the
node degree in a biochemical network diagram.

2.2 Rate constant estimation objective

To estimate the rate constants, the most standard (‘prima1’) ap-
proach is to use a non-linear least squares technique to minimize

 

1045

112 /310's112u1n0[p10}x0"soiwuiJOJuioiq/ﬁduq 11101} papeolumoq

91oz ‘Og isnﬁnV uo ::

T.H.Nim et al.

 

the weighted SSE objective function
N z

2
data
(x2.- 0»)
jeTimepoints

X Z (xii-'“ljl—xif'ﬂtjaéy

jeTimepoints

min

k eeExperimems ieSpecies

(2)

where N t is the number of observed timepoints per experiment,
xiﬁlaoj) is the observed concentration of species 1' in experiment e
and  (tj, k) is the simulated level of species 1' in experiment e as
a function of time and rate constants k. SSE is the most widely
used objective for evaluating the success of parameter estimation,
but SSE grows with the size of the network. Therefore, we also
use the species maximum relative error (MRE), and parameter
percentage error (PPE), discussed in Supplementary Text S1 and
deﬁned as follows:

- NI dal ‘ T 2
Spemes MRE = max —- x, “(t-) — x‘f‘"'(t-,k) - 100%
i,j Z (xlaala(tm))2 ( j j )

(3)

estimated nominal l
lki- — k,-

Median PPE = median< x 100%) (4)

nominal
kl

Maximum PPE = max ‘

stimated _ nominal
(M x 100%) (5)

knominal
Note that the PPE metric requires the knowledge of the nom-
inal parameter values, which is only feasible in simulated tests.

3 ALTERNATIVE OBJECTIVE FUNCTION

3.1 Error terms of dual objective function

The error terms of our dual objective function, sail], minimize the
disagreement between the right hand sides of the ODEs [which
we denote fjoDE, see Equation (1)] and the species derivatives
(computed using the species derivatives interpolated from the

observed data):
_, dA a a spline —»
82,0 = j/iODEU‘) T (E xi," ,—,,  (6)
7/

indexed over experiments e, species 1' and timepoints tj. x21?“ are
the time-series observations of species 1' in experiment e. The
interpolated derivative d/dt with splines is explained in
Supplementary Text S2. The sail,- terms are similar to the terms
of other spline-based collocation methods, but we remark that
each sail/- is deﬁned in terms of a small subset of the parameters k,
while each term of a ‘primal’ SSE objective uses all parameters

via simulation.

 

3.2 Product of functions

Among different schemes for combining error functions into an
objective (e.g. sum of squares), we chose multiplication.

min POF = min n n n 82,1,1' (7)

k k eeExperiments ieSpecies jeTimepoints

The product of functions (POF) objective will need to be eval-
uated in practical tests because it has numerical vulnerabilities,
such as going to zero if any single term goes to zero. The beneﬁt
of using the POF objective is that it is a decomposable expression
to facilitate belief propagation for probabilistic inference on a
factor graph (Section 4.1). By inspection, the POF is minimized
when individual error terms 8”},- are minimized. Assuming the
network is low-degree, each 86,-},- is a low-dimensional term invol-
ving a small subset of the rate parameters k. The 86,-},- error terms
cannot beﬁoptimized as independent problems because the sub-
sets of k are not mutually exclusive. However, the low
dimensionality of 86,-},- means we can pre-compute solutions for
each 86,-},- sub-problem systematically. We pre-compute a com-
plete look-up table Tail/- that gives the value of gm,- for each
possible (discretized) combination of the relevant k parameters.
To combine many low-dimensional systematic sail,- solutions into
an optimal high-dimensional parameter vector is a problem that
resembles belief propagation, except with a sparsely connected,
cyclic graph instead of an acyclic graph. We next describe in
Section 4 how to compute a global estimate of k as a graphical
inference problem using LBP.

4 LOOPY BELIEF PROPAGATION

We now express the POF optimization as an inference problem
on a factor graph, in preparation for using LBP to compute the
MAP values of the variable parameters, corresponding to the
values that minimize the POF objective (Pearl, 1988; Yedidia
et al., 2003).

4.1 Factor graph

A factor graph is a bipartite graph with factor nodes sail/- (for
each experiment e, ODE i and timepoint I!) and variable param-
eter nodes k,- (for the members of k). We connect a factor node
86,-},- to a parameter node k,- if and only if k,- appears in the equa-
tion for 86,-).

For each factor node, a factor graph has a joint table (or joint
probability distribution) to describe the probability of each com-
bination of values for the adjacent variable nodes. We compute a
constant look-up table Tail], based on the error term 86,-), for the
joint probability of each combination of the adjacent variable
parameters. (Section 4.2 describes how errors are converted into
probabilities.) Note that 86,-},- represents the discrepancy between
the right-hand side of the i-th ODE (computed using the variable
parameters) and the left-hand side of the ODE (computed from
spline-based interpolation of the data for experiment e, species 1'
and timepoint tj). Each factor node thus serves to enforce the
equality of one ODE at one timeslice and one experiment. An
example factor graph corresponding to the two-species AZB
system is shown in Figure 1, with variable nodes (rate param-
eters) represented by circles, and factor nodes (em-J) by
rectangles.

4.2 Discretization and joint probability tables

Each variable node k,- is associated with a one-dimensional dis-
crete probability distribution, which represents the current belief
about the likeliness of that value being in the optimal parameter
vector. In theory, variable parameters are real numbers, but to

 

112 /310'S[BHJHO[pJOJXO'SOlJ’BLUJOJIIlOlq”Idllq 11101} papeolumoq

9103 ‘Og isnﬁnV uo ::

Data-rich estimation of reaction rate parameters

 

 

A Spline

gnu E flan}: (E)_%x:¢;m

 

('9) Q
(I?) Q

Fig. 1. A partial factor graph of the example two-species system, shown
for one timepoint t, and one experiment e. The complete factor graph
would include factor nodes for every timepoint and every experimental
treatment, each connected to the k1 and k2 variable nodes

2:1,.

 

 

A spline

E fzona  _ ‘1 xdata

2.2,; E 2.2

 

 

 

1:0.

 

permit us to evaluate combinations ‘systematically’, we discretize
the domain of each parameter into a ﬁnite number of
sub-intervals, or bins, and we represent each bin by its midpoint.
Coarser intervals (larger bins) will yield faster runtime at the
expense of accuracy. At the start of the algorithm, the one-di-
mensional discrete probability distribution for each variable par-
ameter is uniform, representing lack of prior knowledge about
the value of that parameter. During the process of belief propa-
gation (Section 4.3), the discrete probability distributions will be
updated by a message passing algorithm, until convergence or
until an iteration limit.

If factor node 86,},- has degree d, then the joint table T6,},- is a
d—dimensional table, and each dimension is discretized with the
same binning as the variable parameters of the d adjacent vari-
able nodes (Fig. 2). To convert the error terms sail,- into prob-
abilities, we use a Boltzmann-like exponential weighting:
p(f) = C x exp(—se,,-,j). This empirical choice makes large viola-
tions exponentially unlikely, and C is a normalization constant to
make p(f) a valid probability distribution, i.e. all entries in the
discrete joint table sum up to 1. (Alternative methods of repre-
senting a systematic solution of 86,-},- would also have been
possible.)

Note that minimizing the error means maximizing the prob-
ability. These probability distributions do not change during the
course of belief propagation and can be pre-computed. The error
term sail,- must be computed for every possible discrete combin-
ation of the relevant parameters, using the midpoint of each
parameter bin, and the errors can then be converted to probabil-
ities to ﬁll in the joint probability table T6”. The optimal com-
bination of parameters for each sail,- sub-problem can be found
trivially by scanning the T6,},- table.

Owing to the discretization required by this method, the esti-
mated value of each parameter is a range rather than a single
value. Although discretization sacrifices some accuracy (analo-
gous to round-off error), we choose the variable parameters to be
discretized, sometimes quite coarsely, because the output of such
a method might be ideal input for a local search method, such as
LevenbergiMarquardt or Steepest Descent, to refine afterwards,
using a more precise simulation-based objective function.

4.3 Loopy belief propagation

Belief propagation can be described informally as two types
of message passing: variable nodes K pass messages (one-
dimensional probability distributions, 1119f) to adjacent factor
nodes f to communicate what the variable node believes to be
the value of its variable. Factor nodes f in turn pass a message

p(f )ik, :2,k,:3,k3:1

   
 

k3

 
 
   

3 2

 

1 1 2 3 k1

Fig. 2. Illustration of a joint probability table of three dimensions, cor-
responding to rate constants k1, k2 and k3. Each dimension of the look-up
table corresponds to one associated variable parameter (variable node in

the factor graph), binned into three possible values. The joint probability

computed for each cell of the table (e.g. 17031,“:2 k2:3 kFlc for the cell
with k1 2 2nd bin, k2 2 3rd bin, k3 = lst bin) is obtained by converting the
86],) error term into a probability, via exponential weighting and

normalization

(one-dimensional probability distribution, afaK) to adjacent
variable nodes K communicating what they believe the variable
values to be. Each message from a factor causes the variable
nodes to update their probability distributions, and that update
also alters the later messages sent out by the variable nodes. In
acyclic graphs, the message passing algorithm yields a provably
exact, optimal MAP solution for the variables, efﬁciently.
Murphy et al. (1999) describe the LBP algorithm, extending
the message passing framework to achieve good heuristic ap-
proximations for cyclic graphs. We use a variant of the LBP
message-passing algorithm detailed in Koh et al. (2007), sum-
marized in Boxl as ‘SPEDRE—base’.

In a discrete joint distribution g with dimensions K1,K2,..,Km,
we deﬁne the maximization over a dimension K,- as follows:

maﬂg (161,162,  ,km)}

  {elem 2’ ’ ill}
(8)

where ~K,— denotes the set of all dimensions in g except Ki.

Convergence in step B occurs when no normalized message in
the current iteration differs by more than a tolerance value from
the corresponding message in the previous iteration. As the LBP
algorithm is not guaranteed to converge, and in some cases might
oscillate (Murphy et al., 1999), we impose an additional criterion
to limit the total number of iterations.

From Box 1, the asymptotic runtime of the modiﬁed LBP
algorithm, including pre-computation of all the look-up joint
tables, can be expressed as:

O [#iterations x #experiments x #species x #timepoints
x (#rates x #bins + degree x #binsdeg"ee)]

See Supplementary Text S3 for a derivation of the asymptotic
runtime. The time complexity scales exponentially with the factor
graph degree, which is deﬁned as the maximum number of vari-
able nodes adjacent to any factor node, or the maximum number
of unknown rate parameters appearing in any ODE. For a factor
graph with bounded degree, the method scales polynomially with
respect to the number of species, timepoints and discrete bins.
This means the method scales well on biological pathways with a

 

1047

112 /310'S[BIIJDOIPJOJXO'SOIJBLUJOJIIIOlq/ﬂduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

T.H.Nim et al.

 

Box. 1. SPEDRE-base algorithm for computing the MAP estimates on a
factor graph. N(node) is the set of neighbours adjacent to node. Steps
B112 and B21 include a logarithm operation as a heuristic to avoid
rounding off small numbers to zero. Because normalizing the messages or
probability distributions does not affect the ﬁnal MAP results (Yedidia
et al., 2003), we also perform normalization after the computation of step
B112 and B21 so that the messages and beliefs are always valid prob-
ability distributions at every iteration. The messages history serves as a
buffer for incoming messages, and the algorithm makes implicit use of the
message history during steps B112 and B21.

 

A. Initialization:
A.1. Compute look-up joint tables, p(f), for each factor node
A.2. Set all variable nodes to uniform distribution
B. Propagation: repeat until convergence
B]. For each factor node f
B.1.1. For each variable node K e N(f)
B.1.1.1. Collect 11,99]: the message from variable node K,- e N(f)\
{K} to f, which is p(K,-), the current probability distribution of K,-

B.1.1.2. Compute 11an = m2;x{p(f)>210g(a,(ﬁf)}
B.1.1.3. Send 11an to the message history ofK
B.2. For each variable node K
B.2.1. Update the distribution of K to p(K) > Zlog(afﬁg), where
11,99] are stored in the message history of K i

C. Output: compute the MAP probability of each variable node
M AP(K) = arg maxiPUQ}

 

small bounded number of reactions per species. Our asymptotic
runtime compares favourably with conventional (‘prima1’) meth-
ods, because primal methods search for full-length parameter
vectors in a space that grows exponentially with the number of
parameters. Although primal methods with heuristic sampling
do not have to cover the entire parameter space, they must main-
tain some coverage of the major ‘valleys’ of the objective func-
tion. If the number of valleys and inﬂection points grows with
the size of the parameter space, then primal methods will per-
form poorly (accuracy versus runtime) on large networks.

5 RESULTS

Before testing the overall performance of the method on full
problems, we ﬁrst performed simplistic tests with partial prob-
lems, to isolate speciﬁc variables of interest such as #species and
#timepoints. We monitored performance as a function of net-
work size and timepoint spacing, to probe two sources of poten-
tial error in the SPEDRE-base method: spline accuracy and the
POF objective function. The simplistic tests used ring-shaped
networks (Fig. 3A), with nominal parameters randomly chosen
to be at exact mid-points of the parameter discretization bins.
Simulated data were generated with random initial concentra-
tions, using the nominal rate parameters. For each run of
SPEDRE-base, we monitored the objective

log(POF)

Normalized log(POF) = 

(9)
normalized with respect to the number of factors in the product
of Equation (9). The objective declined when the number of
timepoints increased (Fig. 3B), indicating as expected that

    
 

 

A B C
X1 0 o A
)I{ §-2000 §-1ooo A w
12 E4000 +Nomina| 135-2000 —105pecies
. . . _ —SPEDRE-base +50 species \
1 500011 Hill—300011111 H
X 1030507090 34567891011

Number ofspecies Number oftimepoints

Fig. 3. (A) Ring network diagram; (B) normalized log(POF) with respect
to the number of timepoints on different network sizes; (C) normalized
log(POF) of LBP-predicted rate constants, versus the normalized
log(POF) of nominal (‘correct’) rate constants on circular networks of
10 to 100 species with 11 timepoints. (Total simulation duration was 4 s,
with 0.4 s for each time step). Each rate constant was discretized into 10
equidistant bins from 0.05 to 1.05, with the nominal rate constants se-
lected from among the bin midpoints. Dataset appears in Supplementary
Source Files

SPEDRE gives better estimates of the parameters when time-
points are densely sampled.

Next we compared the normalized log(POF) value between the
results of SPEDRE-base, and the nominal (‘correct’) rate con-
stants, using 10 time steps (i.e. 11 timepoints) for each test.
Figure 3C shows that the POF scores of the exact nominal par-
ameters were higher than the POF scores of the parameters
found by SPEDRE-base, for all networks of signiﬁcant size.
Because SPEDRE-base found parameters with better scores
than the ‘correct’ parameters, we infer that the POF objective
is an imperfect score of parameter accuracy.

5.1 Scalability with artiﬁcial networks

The complete SPEDRE method consists of SPEDRE-base
(Sections 34) followed by LM to reﬁne the discretized results
from SPEDRE-base. The major task of SPEDRE-base is to find
good starting values for local optimization, and post-fitting is a
necessary part of the procedure. We compared the performance
of the complete SPEDRE method against a selection of popular
local, global and hybrid methods, on parameter estimation prob-
lems from low-degree networks. All tests were full problems with
parameters set randomly, without regard to bins or bin mid-
points. Random networks of increasing size (from 30 to 150
species) were constructed with low degree (two-thirds of the re-
actions involving three species, and one-third involving two spe-
cies), to generate parameter estimation problems with increasing
scale. We tested 14 parameter estimation methods including
SPEDRE-base, LM (local), SD (local), SRES (global), PSO
(global) and GA (global), plus hybrid globalilocal combinations
of these methods (e.g. SRES_LM denotes the global method
SRES plus the local method LM). Runtime and multiple error
scores were measured as a large-scale screen (see Supplementary
Text S5, Supplementary Figs S6 and S8 and Supplementary
Tables S7 and S9). The best-performing methods (asterisks in
Supplementary Fig. S6) are consistently SPEDRE and a subset
of hybrid stochastic-local methods. Highly similar scores can
occur when multiple methods converge to the same local opti-
mum. Accuracy tests showed the following trends: (i) for small
networks, local methods performed well; (ii) hybrid methods
(including SPEDRE) showed superior accuracy to standalone

 

1048

112 /310's112u1nofp101x0"soiJBuiJOJHioiq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Data-rich estimation of reaction rate parameters

 

local or global methods; (iii) SPEDRE accuracy was comparable
with the accuracy of other hybrid methods; (iv) the quality scores
of SPEDRE-base were significantly worse than SPEDRE, con-
ﬁrming that the LM post-processor is indeed important for refin-
ing discretized results. Supplementary Text S5 also clariﬁes the
trade-off between accuracy and speed. We conclude that
SPEDRE was ‘tied’ with other state-of—the-art methods, for the
spectrum of low-degree data-rich problems we constructed.

5.2 Performance on a novel model of Akt pathway
activation

To test SPEDRE on a realistic biological pathway, we built a
novel model of Akt activation (‘Akt model’), using our experi-
mental data from recent studies (Lim and Clement, 2007). Akt is
a kinase, frequently over-activated in cancers, that signals for
survival and proliferation. The signalling events in our model
of Akt activation are illustrated in Figure 4 and described
below. Akt is activated after stimulation by serum (growth fac-
tors), not only via the canonical activation of PI3Kinase (PI3K)
by serum, but also via reactive oxygen species (ROS) and
ROS-induced inactivation of the phosphatase PTEN. ROS are
produced by NADPH oxidase (NOX), and degraded by
anti-oxidants. The phosphorylation and activation of Akt is a
multi-step process, involving the translocation of Akt from the
cytosol to the cell membrane and its phosphorylation by the
kinase PDKl at Thr308. The translocation of Akt and PDKl
to the membrane is controlled by the level of phosphatidylinosi-
tol 3,4,5—trisphosphate (PIP3), which is determined by the bal-
ance between PIP3 production (by serum-activated PI3Kinase)
and PIP3 degradation (by the phosphatase PTEN).
Phosphorylated Akt returns to the cytosol and is subject to
dephosphorylation by PP2A.

The model was built manually based on dynamic measure-
ments of the Akt pathway, observed in serum-starved mouse
embryonic ﬁbroblasts stimulated by the addition of 10%
serum to the culture medium (Lim and Clement, 2007). Supple-
mentary Table S11 deﬁnes the full model.

Using simulation, we generated complete datasets with artiﬁ-
cial noise at levels of 0, 1 and 20%. Parameter estimation per-
formance was compared between SPEDRE and some popular
methods (Fig. 5, with complete results in Supplementary Table
S12).

According to Figure 5A7C, the prediction quality of SPEDRE
(leftmost bar, shaded black) is better than the other methods for
noise-free and 1%-noise datasets. With noise levels of 20%, all
methods perform unacceptably, providing worse than 100% spe-
cies MRE, as shown in Figure 5A. Similarly, on the 20%-noise
data set, all methods have unacceptably high median PPE and
weighted SSE, as shown in Figure 5BrC. In this parameter op-
timization test with Akt dynamics, SPEDRE out-performed
other methods, indicating that the parameter neighbourhoods
it gave to LM were better than the neighbourhoods from other
global methods, even though SPEDRE-base had equivalent per-
formance in non-biological tests.

Figure 5D also displays a counterintuitive phenomenon, in
which the local search method LM takes longer to run than
any hybrid method including LM as a post-processor. LM per-
forms many iterations if it starts with a random guess, but it

GF R
 GF_R 
inactNOXV “LOX P6135: inactPl3K
  Akt-cyto
, PIPZ PIPI3._$
E/ EFL,/ﬂ,
Environment‘7/ R95  pDKl-cyto  Akt.mem (.....pP2A
Antioxidant    ------ »—>
capacity PTENox. pTEN PDK1-mem Akt-p308

Fig. 4. Network diagram of the Akt model, including redox regulation of
PTEN. The preﬁx ‘inact’ denotes inactive species; the suffix ‘cyto’ (or
‘mem’) indicates cytosolic (or plasma membrane) localization. The
sufﬁx ‘p308’ indicates phosphorylation at residue Thr308

   

   

         
 
  
   
 

  

. . “,2 . . g
.A. 2 a we: a :13 E a a, Sam:
35102 :. - E ': I are; .33. , a E: gagged:
In in :o. o 7§ |“10 u, 41:5, _.:mu_.
z E - ‘" ' ' /§ 0. a : m /§
2 100 I I ¢% '-"-10" "‘ : /\
a . A s : s
.5 10 E 1  ﬁlo—2 I
53110:4 . : £0 £104 I

I Ema: i a
c I “J: I Em'ﬁ D : :
§ § Iawizieaaa : -
~ 01 E : aﬁ<a : Va A
1.1.1104 g -‘ . will . /\ 3
a m 7‘  w
3102 e a E
 on 7 a 
"g z A ==

 

HH
9
N

/\

      

o 1% 2%

0 1% 2

o
9‘?

Noise level

Fig. 5. Comparison of parameter estimation algorithms applied to the
Akt network, with noise levels 0, 1 and 20%, evaluated by (A) species
MRE, (B) median PPE, (C) weighted SSE and (D) runtime

converges quickly if it starts with the output of a global search
method. Adding more phases of search would be expected to
increase rather than decrease the total runtime, but in this case,
a phase of global search led to faster LM convergence, which
more than compensated for the time of running the global
search.

6 DISCUSSION

The key innovations of SPEDRE are the use of a probabilistic
graphical model to decompose the dual objective function, and
pre-computation of discrete solutions to each sub-problem. The
method has a well-defined asymptotic runtime and good scalabil-
ity, in exchange for approximate heuristic optimization.

The SPEDRE approach aims for asymptotic scalability at the
expense of accuracy. This philosophy appears in (i) the use of
splines to approximate the species derivative, (ii) the use of bin-
ning to discretize the parameter space and (iii) the use of LBP for
probabilistic inference. Each of these elements can introduce
error. We believed the dangers of compounded errors would
make the SPEDRE method less robust to noisy data than simu-
lation-based methods. The expected sensitivity of SPEDRE to
input noise has not yet been conﬁrmed in the tests shown (and in
other tests, such as Supplementary Table S12); rather we found
that all methods gave unacceptably poor answers with noisy

 

1049

112 /310's112u1nofp101x0"soiJBuiJOJHioiq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

T.H.Nim et al.

 

data. Future work must continue to characterize the numerical
stability, approximation error and noise tolerance of SPEDRE
and other parameter estimation methods. SPEDRE is in fact a
general algorithm for ODE parameter fitting, applicable to any
case in which the right-hand sides of the ODEs have few terms
(low degree), and where the data-ﬁtting problem provides dense
observations of all variables.

The accuracy and speed of SPEDRE were compared against
several methods of parameter estimation, in low-degree,
data-rich test cases. SPEDRE performance was competitive in
all tests, and SPEDRE was the best-performing method for the
Akt network test. We conclude that SPEDRE performs well
when tested in the speciﬁc niche of problems for which it was
designed. Naturally the SPEDRE performance would degrade
(perhaps exponentially) outside of its intended niche. SPEDRE
exhibits an abrupt trade-off between problem type and perform-
ance, but performance trade-offs are not new to parameter esti-
mation research. Major pathway simulation software packages
already maintain collections of multiple parameter estimation
methods, rather than expecting a single best method to cover
all problems.

A current hurdle for broader applicability of SPEDRE is the
inability to handle high-degree nodes. Many small networks are
low-degree, but large networks often have at least one hub. In
order for new spline-based collocation methods to be truly su-
perior to conventional (‘primal’ objective) parameter estimation
methods, they would have to handle high-degree networks and
extensive gaps in experimental observations, robustly. Future
innovations may be able to develop a new composition of par-
ameter estimation methods, so that low-degree sub-problems can
be solved by SPEDRE and high-degree hubs can be treated
separately.

A side-effect of our work is to provide performance compari-
sons for several hybrid and standalone parameter estimation
methods. Our tests reproduced the earlier observation that
hybrid methods generally perform better than standalone
global methods (Ashyraliyev et al., 2009; Rodriguez-Femandez
et al., 2006). One surprising phenomenon we observed was that
performing a global search prior to a local search sometimes
caused the total runtime to be faster than using the local
search alone (Fig. 5D). Future work may be able to exploit
this non-additive runtime effect, perhaps through deeper integra-
tion of global and local search methods, rather than applying
independent methods sequentially.

A distinguishing feature of SPEDRE is that it requires large
amounts of concentration measurement data, which would have
been prohibitive a decade ago. Traditional experimental methods
required an investment of labour and resources that was roughly
linear in the number of proteins studied. New proteomic meth-
ods can measure additional proteins at virtually no additional
cost, and proteomic datasets are starting to provide data-rich
environments with measurements of all proteins in a system.
SILAC technology has recently been used for time-series meas-
urements of 147 proteins (Tasaki et al., 2010) in NIH3T3-derived
cells, and again for time-series of 534 proteins in the cytosol and
626 proteins in the nucleus in glucocorticoid—exposed myogenic
cells (Reeves et al., 2009). Most proteomic studies have not been
performed with time-series repeats for studying dynamics, but
large-scale dynamic data will become increasingly available

with the explosive growth in the number of proteomic experi-
ments (Zhang et al., 2011). New studies of large networks will
give rise to huge parameter estimation problems, with rich data-
sets, but with too many unknown parameters for conventional
methods to solve.

We believe that proteomic technology both enables and re-
quires novel approaches to parameter estimation such as
SPEDRE. As models grow in size owing to technological ad-
vances, decomposition-based methods will probably dominate
nonwlecomposition—based search methods, which suffer from
the curse of dimensionality. The trade-offs exhibited by our
method may be increasingly desirable for future trends in par-
ameter estimation.

Funding: Lee Kuan Yew Postdoctoral Fellowship and grant
R-252-000-342—112 (to L.T.-K.); Singapore-MIT Alliance grant
C-382—641-004-09l (to L.T.-K. and J.K.VV); grant BMRC 09/1/
21/19/603 (to M.-V.C.)

Conﬂict of Interest: none declared.

REFERENCES

Albeck,J.G. et al. (2008) Quantitative analysis of pathways controlling extrinsic
apoptosis in single cells. Mol. Cell, 30, 11725.

Ashyraliyev,M. et al. (2008) Parameter estimation and determinability analysis
applied to Drosophila gap gene circuits. BMC Syst. Biol, 2, 83.

Ashyraliyev,M. et al. (2009) Systems biology: parameter estimation for biochemical
models. FEBS J., 276, 8867902.

Basak,S. et al. (2007) A fourth IkappaB protein within the NF—kappaB signaling
module. Cell, 128, 3697381.

Bock,H.G. (1983) Recent advances in parameter identiﬁcation techniques for
O.D.E. Prog. Sci. C0mput., 2, 957121.

Bock,H.G. and Schldder,J.P. (1986a) Fit, ﬁtter, the ﬁttest: methods for modelling
and validation of dynamical systems. In: M611er,D. (ed.) Systems Analysis.
Vieweg, Wiesbaden, Germany.

Bock,H.G. and Schldder,J.P. (1986b) Recent progress in the development of algo—
rithms and software for large scale parameter estimation problems in chemical
reaction systems. In: IFAC Conference Automatic Control in Petrol,
Petrochemical and Desalination Industries. Kuwait.

Brewer,D. et al. (2008) Fitting ordinary differential equations to short time course
data. Philos. Transact. A Math. Phys. Eng. Sci., 366, 5197544.

Chou,I.C. et al. (2006) Parameter estimation in biochemical systems models with
alternating regression. T heor. Biol. Med. Model, 3, 25.

Fall,C. et al. (2002) Computational Cell Biology. Springer, New York, USA.

Fogel,D.B. et al. (1991) Meta—evolutionary programming. In: Chen,R.R. (ed.)
Conference Record of the T wenty—th Asilomar Conference on Signals,
Systems and Computers. Vol. 1 and 2, IEEE Computer Society, Los Alamitos,
CA, USA, pp. 54%545, 1274.

Fomekong—Nanfack,Y. et al. (2007) Efﬁcient parameter estimation for
spatio—temporal models of pattern formation: case study of Drosophila mela—
nogaster. Bioinformatics, 23, 335673363.

Jia,G. et al. (2011) Parameter estimation of kinetic models from metabolic proﬁles:
two—phase dynamic decoupling method. Bioinformatics, 27, 19644970.

Kennedy,J. and Eberhart,R. (1942) Particle swarm optimization. In: Proceedings of
the Fourth IEEE International Conference on Neural Networks, Perth, Australia,
1942. Institute of Electrical and Electronics Engineers, New York City,
New York, USA, pp. 194271948.

Kleinstein,S.H. et al. (2006) Nonuniform sampling for global optimization of kinetic
rate constants in biological pathways. In: Proceedings of the 2006 Winter
Simulation Conference. Vol. 175, Institute of Electrical and Electronics
Engineers, New York City, New York, USA, pp. 161171616, 2307.

Koh,G. et al. (2006) A decompositional approach to parameter estimation in path—
way modeling: a case study of the Akt and MAPK pathways and their crosstalk.
Bioinformatics, 2, e271w280.

 

1050

112 /310's1eu1nofp.rq1xo'sopeuiJOJHioiq/ﬁduq 111011 papeo1umoq

9103 ‘0g1sn8nV uo ::

Data-rich estimation of reaction rate parameters

 

Koh,G. et al. (2007) Composing globally consistent pathway parameter estimates
through belief propagation. In: Algorithms in Bioinformatics, 7th International
Workshop. WABI 2007, Philadelphia, PA, USA.

Kwon,J. et al. (2004) Reversible oxidation and inactivation of the tumor suppressor
PTEN in cells stimulated with peptide growth factors. Proc. Natl Acad. Sci.
USA, 101, 16419716424.

Levenberg,K. (1944) A method for the solution of certain nonlinear problems in
least squares. Quart. Appl Math., 2, 164168.

Lim,S. and Clement,M.V. (2007) Phosphorylation of the survival kinase Akt by
superoxide is dependent on an ascorbate—reversible oxidation of PTEN. Free
Radic. Biol. Med, 42, ll7&ll92.

Marquardt,D. (1963) An algorithm for least—squares estimation of nonlinear par—
ameters. SIAM J. Appl Math., 11, 431.

McEliece,R.J. et al. (1998) Turbo decoding as an instance of Pearl’s ‘beliefpropaga—
tion’ algorithm. IEEE J. Sel Area Comm, l6, 14(F152.

Meltzer,T. et al. (2009) Convergent message passing algorithms—a unifying View. In:
Conference on Uncertainty in Artificial Intelligence (UAI '09). AUAI Press,
Arlington, Virginia, USA.

Michalewicz,Z. (1994) Genetic Algorithms +Data Structures: Evolution Programs.
Springer—Verlag, Berlin.

Mitsiades,C.S. et al. (2004) The Akt pathway: molecular targets for anti—cancer drug
development. Curr. Cancer Drug Targets, 4, 2357256.

Murphy,K. et al. (1999) Loopy belief propagation for approximate inference: an
empirical study. In: Proceedings of Uncertainty in AI, p. 467.

Palsson,B.O. (2006) Systems Biology: Properties of Reconstructed Networks.
Cambridge University Press, Cambridge, UK.

Pearl,J. (1988) Probabilistic Reasoning in Intelligent Systems: Networks of Plausible
Inference. 2nd edn. Morgan Kaufmann, San Francisco, CA.

Peifer,M. and Timmer,.l. (2007) Parameter estimation in ordinary differential equa—
tions for biochemical processes using the method of multiple shooting. IET Syst.
Biol, 1, 7&88.

Purvis,J.E. et al. (2008) A molecular signaling model of platelet phosphoinositide
and calcium regulation during homeostasis and P2Yl activation. Blood, 112,
40694079.

Ramsay,J.O. et al. (2007) Parameter estimation for differential equations a general—
ized smoothing approach. J. R. Stat. Soc. B Stat. Methodol, 69, 7417796.
Reeves,E.K. et al. (2009) Proteomic proﬁling of glucocorticoid—exposed myogenic
cells: time series assessment of protein translocation and transcription of inactive

mRNAs. Proteome Sci., 7, 26.

Rodriguez—Fernandez,M. et al. (2006) A hybrid approach for efﬁcient and robust
parameter estimation in biochemical pathways. Biosystems, 83, 2487265.
Runarsson,T. and Yao,X. (2000) Stochastic ranking for constrained evolutionary

optimization. IEEE Trans. Evol C0mput., 4, 2847294.

Tasaki,S. et al. (2010) Phosphoproteomics—based modeling deﬁnes the regulatory
mechanism underlying aberrant EGFR signaling. PLoS One, 5, el3926.

Testa,J.R. and Bellacosa,A. (2001) AKT plays a central role in tumorigenesis. Proc.
Natl Acad. Sci. USA, 98, 10983710985.

Vilela,M. et al. (2009) Identiﬁcation of neutral biochemical network models from
time series data. BMC Syst. Biol, 3, 47.

Voit,E.O. and Almeida,]. (2004) Decoupling dynamical systems for pathway iden—
tiﬁcation from metabolic proﬁles. Bioinformatics, 20, 167(Fl68l.

Yedidia,J. et al. (2003) Understanding belief propagation and its generalizations. In:
Lakemeyer,G. and Nebel,B. (eds) Exploring Artiﬁcial Intelligence in the New
Millennium. Morgan Kaufmann Publishers Inc., San Francisco, CA, USA,
pp. 2397269.

Zhan,C. and Yeung,L.F. (2011) Parameter estimation in systems biology models
using spline approximation. BMC Syst. Biol, 5, l4.

Zhang,G. and Neubert,T.A. (2009) Use of stable isotope labeling by amino acids in
cell culture (SILAC) for phosphotyrosine protein identiﬁcation and quantita—
tion. Methods M0]. Biol, 527, 79792.

Zhang,G.L. et al. (2011) Database resources for proteomics—based analysis of
cancer. Methods Mol. Biol, 723, 3497364.

 

1051

112 /310'S[BHJDOIPJOJXO'SOIJBLUJOJIIIOlq/ﬂduq 111011 papeo1umoq

9103 ‘0g1sn8nV uo ::

