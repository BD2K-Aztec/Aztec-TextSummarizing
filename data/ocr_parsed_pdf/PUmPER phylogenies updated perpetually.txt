BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

PUmPER

 

We call all subsequent iterations update iterations because they
extend the MSA and trees of the preceding iteration. An update
iteration carries out the following four steps: (i) MSA extension
with PHLAWD according to the initial conﬁguration file; (ii)
generation of distinct randomized stepwise addition order parsi—
mony starting trees with Parsimonator (unpublished; available
under GNU GPL at https://github.com/stamatak/Parsimonator—
1.0.2), extending the set of trees from the previous iteration by
the newly added taxa; (iii) ML optimization of the comprehen—
sive parsimony starting trees that now include all new taxa with
ExaML or RAxML—Light; and (iv) selection of a subset of these
ML trees (based on their likelihood scores) that will be used as
starting points for the next iteration.

Update iterations are either initiated manually via the com—
mand—line interface or triggered automatically. A tree update
iteration is initiated if (i) the alignment from the previous iter—
ation has been extended and (ii) the phylogenetic analyses of the
previous iteration have been completed.

Our framework also supports generating multigene alignments
with PHLAWD. For each gene region of interest, we execute
an independent PHLAWD instance to generate a single—gene
MSA. Each PHLAWD instance has its own configuration and
sequence—seed ﬁle. Thereafter, we concatenate all single—gene
MSAs into a multi—partitioned dataset and store the gene bound—
aries in a RAxML—formatted partition ﬁle.

3 IMPLEMENTATION

All components of the framework are open source. PUmPER is
based on Ruby modules that can be seamlessly used in Ruby
scripts. Each Ruby module encapsulates an independent function
or wrapper, that is, the user does not need to be aware of the
speciﬁc usage of the underlying basic tools. Configuration files
specify clade— and gene—speciﬁc settings. Although our main use
case is the automated update of phylogenetic trees, the frame—
work can easily be adapted to build custom phylogenetic pipe—
lines. For example, if alignments are already available, the
PHLAWD component is not required. The online repository
includes a detailed installation guide, as well as some basic
usage conﬁguration examples.

Under the default conﬁguration, PUmPER operates in stand—
alone mode on a single server. PHLAWD and ExaML are exe—
cuted locally on this server. The individual ExaML tree searches
are conducted one after the other. Although PUmPER deploys
ExaML by default, it can be configured to use the PThreads
version of RAxML—Light on multi—core servers. Thus, this
stand—alone version already allows for updating large trees with
thousands of taxa on a medium—sized lab server.

For huge trees with tens of thousands of taxa, the computa—
tional resources of a single server may be insufﬁcient because of
memory and/ or time constraints. Thus, PUmPER can ofﬂoad the
computationally intense ML calculations to a cluster system.
Thereby, the trees are updated in a timely manner while the pro—
cess is still being orchestrated by a local server. This requires the
perpetual tree framework to interface with remote systems using
standard communication tools (scp and ssh), batch schedulers (we
have successfully used the framework with SGE and SLURM)
and to also use optimized executables for the remote target
system (Parsimonator, ExaML, RAxML—Light and RAxML).

Table 1. Original run and two update iterations for rbcL alignments of
the Embryophyta clade

 

 

Iteration Taxa Sites Avg LH (30) Runtime (h)
2008 12 072 1437 —848794.80 46.55
2010 16962 1427 —1005824.25 68.36
2010 (scratch) 16 962 1427 —1005931.37 70.89
2012 21791 1424 —1108161.66 93.40

2012 (scratch) 21 791 1424 —1108243.29 97.42

 

Note: The Iteration numbers reﬂect the amount of data available in GenBank in
past years (200872012). The complete data are available in Supplementary Table Sl.

Although this adds some complexity, it is required to infer trees
whose size requires a large amount of computational resources.

4 RESULTS AND DISCUSSION

According to our first results (see Table 1 and Supplementary
Material for details), the iterative MSA and tree extension ap—
proach does not yield statistically signiﬁcantly better (or worse)
trees than the standard (inference from scratch) approach with
respect to the likelihood scores. The topological accuracy in our
simulations is comparable in both approaches. The runtimes of
the perpetual inferences are slightly, but consistently, lower than
for inferences from scratch. We view the main contribution, how—
ever, in saving man—hours; alignment construction, job setup,
ﬁltering and post—analyzing results are tedious tasks that con—
sume a signiﬁcant, and hard to quantify, amount of time.

We are currently operating an instance of our framework as
part of the iPlant collaborative (http://www.iplantcollaborative.
org/) to maintain and make available perpetually updated trees
for the Viridiplantae clade (using the rbcL, matK and L1th genes).
The details of our setup can be found in the Supplementary
Material.

ACKNOWLEDGEMENT

The authors acknowledge Texas Advanced Computing Center
(TACC) and Extreme Science and Engineering Discovery
Environment (XSEDE).

Funding: F.I.—C. was funded via DFG grants (STA 860/2 and
STA 860/3). S.A.S. was funded by NSF (1207915 and 0735191).
iPlant Collaborative (NSF Grant #DBI—0735191).

Conﬂict of Interest: none declared.

REFERENCES

Hibbett,D.S. et a]. (2005) Automated phylogenetic taxonomy: an example in the
homobasidiomycetes (mushroom—forming fungi). Syxt. Biol, 54, 660—668.

Smith,S.A. et a]. (2009) Mega—phylogeny approach for comparative biology: an
alternative to supertree and supermatrix approaches. BMC Evol Biol, 9, 37.

Stamatakis,A. and Aberer,A. (2013) Novel parallelization schemes for large—scale
likelihood—based phylogenetic inference. In: Parallel Dixtrilmted Proce.\'.\'ing
(IPDPS), 2013 IEEE 27th International Sympoxium on. pp. 119571204.

Stamatakis,A. et a]. (2012) Raxml—light: a tool for computing terabyte phylogenies.
Bioiiﬁ’ormaticx, 28, 206$2066.

Wu,D. et a]. (2008) An automated phylogenetic tree—based small subunit rRNA
taxonomy and alignment pipeline (STAP). PLoS One, 3, e2566.

 

1 477

ﬁm'spzumofpmﬂo'sopeuuowrorq/ﬁdnq

