ORIGINAL PAPER

Vol. 27 no. 8 2011, pages 1128-1134
doi:10. 1 093/bioinformatics/btr089

 

Systems biology

Advance Access publication February 23, 2011

Assigning spectrum-specific P-values to protein identifications by

mass spectrometry

Victor Spirinl, Alexander Shpunt1’2, Jan Seebachers, Marc Gentzel4,

Andrej Shevchenko4, Steven Giygi3 and Shamil Sunyaevlai‘

1Division of Genetics, Brigham and Women’s Hospital, Harvard Medical School, 77 Avenue Louis Pasteur, Boston,
MA 021 15, 2Department of Physics, Massachusetts Institute of Technology, 77 Massachusetts Avenue, Cambridge,
MA 02143, 3Department of Cell Biology, Harvard Medical School, 240 Longwood Avenue, Boston, MA 02115, USA
and 4MPl of Molecular Cell Biology and Genetics, Pfotenhauerstrasse 108, 01307 Dresden, Germany

Associate Editor: Burkhard Rost

 

ABSTRACT

Motivation: Although many methods and statistical approaches
have been developed for protein identification by mass spectrometry,
the problem of accurate assessment of statistical significance of
protein identifications remains an open question. The main issues
are as follows: (i) statistical significance of inferring peptide from
experimental mass spectra must be platform independent and
spectrum specific and (ii) individual spectrum matches at the peptide
level must be combined into a single statistical measure at the protein
level.

Results: We present a method and software to assign statistical
significance to protein identifications from search engines for mass
spectrometric data. The approach is based on asymptotic theory of
order statistics. The parameters of the asymptotic distributions of
identification scores are estimated for each spectrum individually.
The method relies on new unbiased estimators for parameters
of extreme value distribution. The estimated parameters are used
to assign a spectrum-specific P-value to each peptide-spectrum
match. The protein-level confidence measure combines P-values of
peptide-to-spectrum matches.

Conclusion: We extensively tested the method using triplicate
mouse and yeast high-throughput proteomic experiments. The
proposed statistical approach improves the sensitivity of protein
identifications without compromising specificity. While the method
was primarily designed to work with Mascot, it is platform-
independent and is applicable to any search engine which outputs a
single score for a peptide-spectrum match. We demonstrate this by
testing the method in conjunction with XlTandem.

Availability: The software is available for download at
ftp://genetics.bwh.harvard.edu/SSPV/.

Contact: ssunyaev@rics.bwh.harvard.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 2, 2010; revised on January 28, 2011;
accepted on February 15, 2011

 

*To whom correspondence should be addressed.

1 INTRODUCTION

Improvements in speciﬁcity, sensitivity and throughput of protein
identiﬁcations progress at unprecedented pace. However, the scope
of available mass spectrometric and informatics technologies
and divergence of their physicochemical and algorithmic bases
contributes to growing concern regarding the reproducibility,
transparency and statistical reliability of the proteome analysis.

In bottom-up proteomics, the identiﬁcation proceeds via matching
peptide MS/MS spectra to a database of sequences. The identity
of proteins present in the sample is then inferred from individual
peptide matches. While many peptide identiﬁcations are seemingly
undisputed within any statistical framework, a large fraction of hits
fall into ‘borderline’ signiﬁcance range. The ability to accurately
assess the statistical signiﬁcance of these identiﬁcations would
increase speciﬁcity and sensitivity of mass spectrometry analyses.
More importantly, at the protein level, a single estimate of statistical
signiﬁcance should combine evidence from all tandem mass spectra
matched to the same protein. Arbitrary conventions (Carr et al.,
2004) that are employed for maintaining protein identiﬁcation
consistency will be rendered unnecessary by such estimate.

At the peptide level, current identiﬁcation methods can be
classiﬁed into false discovery rate (FDR) approaches, P-value-based
approaches, and posterior probability-based approaches. FDRs are
typically estimated by searches against a decoy database (e.g. a
database of reversed and/or randomized protein sequences) (Elias
and Gygi, 2007; Kall et al., 2008; Park et al., 2008). A threshold
determining statistical signiﬁcance is selected speciﬁcally for a
given dataset and a given peptide-to-spectrum scoring metric.
More sophisticated statistical approaches involve simulations and
analytical approximations (Ramos-Femandez et al., 2008).

However, a single FDR threshold is applied to all spectra from the
dataset. Therefore, it is not informative about statistical signiﬁcance
of individual matches and the estimate of the FDR threshold usually
has a large variance.

Speciﬁcity and sensitivity of identiﬁcations can be increased
by stratifying peptide-spectrum matches (PSMs) using properties
of spectra (Anderson et (11., 2003; Kall et al., 2007) or peptide
length (Cox and Mann, 2008) in a statistical or machine learning
framework.

A number of recently developed methods report P-values
speciﬁc to individual spectra. These methods are primarily based

 

1128 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.to's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papBOIII/lAOG

91oz ‘Og anBnV uo ::

Spectrum-specific P-values for protein identifications

 

on ﬁtting the distribution of scores with a parametric model.
Klammer et (11. (2009) ﬁt the distribution of SEQUEST Xcorr
scores with Weibull distribution. Searle et (11. (2008) ﬁt the
distribution of Mascot scores with a double-exponential Gumbel
distribution. Fast SEQUEST (Eng et (11., 2008) employs a faster
algorithm which applies the Xcorr to every candidate peptide
from the sequence database being queried. Spectrum-speciﬁc E-
values are computed by approximating the distribution of Xcorr
scores with an exponential distribution. OMSSA (Geer et (11.,
2004) approximates the scores of every peptide-spectrum match
with Poisson distribution. Kim et (11. (2009) address the issue of
spectrum speciﬁcity by calculating a generating ﬁinction and infer
the probability of a correct spectrum identiﬁcation based on all
matching peptides. RAId_DbS (Alves et (11., 2007) uses a score in
the form of a weighted sum of logarithmic intensities and applies
an extension of the Central Limit Theorem to assign statistical
signiﬁcance to the matches.

However, the approach based on ﬁtting speciﬁc parametric models
cannot be generalized to other platforms. Also, the parametric model
with parameters estimated using the overall distribution of scores
may not be accurate at the extreme tail.

Further, a single protein level rather than peptide level P-value is
needed for practical applications.

The issue of statistical signiﬁcance of protein identiﬁcations is
addressed in ProteinProphet (Nesvizhskii et (11., 2003) (posterior
error probabilities), ComByne (Bern and Goldberg, 2008), Qscore
(Moore et (11., 2002), PROVALT (Weatherly et (11., 2005), MAYU
(Reiter et (11., 2009) (FDRs), PANORAMICS (Feng et (11., 2007)
(combining peptide probabilities derived from Mascot score into
protein probabilities) and XlTandem (Craig and Beavis, 2004)
(E-values). However, some of these methods are not based on
spectrum-speciﬁc identiﬁcations, while others are dependent on
particular assumptions regarding the platform or distribution of
false-positive matches.

ProteinProphet, PROVALT, ComByne, MAYU and Qscore
provide dataset-speciﬁc, rather than spectrum-speciﬁc,
identiﬁcations. PROVALT uses heuristic approach to assign
FDR for protein identiﬁcations from Mascot peptide scores. MAYU
utilizes a set PSM above a user-speciﬁed PSM FDR threshold. The
number of false-positive protein identiﬁcations and protein FDR
is then estimated under the assumption of uniform distribution
of false-positive PSMs over the target database. ProteinProphet
builds on PeptideProphet (Keller et (11., 2002). The latter combines
SEQUEST Xcorr score adjusted for peptide length, the difference
between the top score and the rest, logarithm of rank of Sp score
and mass accuracy, and then uses an empirical formula to obtain
Bayesian posterior probability for peptide identiﬁcations. These
peptide identiﬁcations are then combined into protein probabilities.

In this article, we developed and extensively tested a method that
(i) relies on the information content of individual spectra and is fully
independent of dataset properties, spectrum-to-sequence correlation
model, instrumentation platform, data acquisition and processing
settings; and
(ii) combines evidence from peptide identiﬁcations to assess
statistical signiﬁcance of protein identiﬁcations.

We report a single P-value for protein identiﬁcations combining
evidence from individual peptides. Statistical signiﬁcance of
individual peptide identiﬁcations is based on asymptotic distribution
of order statistics and is speciﬁc for each tandem mass spectrum.

This increases sensitivity and speciﬁcity of both peptide and protein
identiﬁcations.

We demonstrate how the software implementation of the method
works in conjunction with the popular database search algorithm
Mascot. However, our method is applicable to any database search
that assigns a single numeric score for each spectrum match. We
demonstrate this with an application of the same approach to peptide
and protein identiﬁcation using XlTandem platform. We describe
our statistical approach and tests of the method on real proteomic
samples. We start with the statistics of peptide identiﬁcations and
then proceed to the protein level.

2 METHODS
2.1 Datasets

Samples from two organismsimouse and yeastiwere used for obtaining
datasets of peptide mass spectra. The mouse datasets are a triplicate LC-
MS/MS analysis from the in-gel digest of the 49764 kDa molecular weight
region of mouse brain lysate. The yeast datasets are a triplicate LC-
MS/MS analysis of an in-gel trypsin digest of the 707150kDa molecular
weight region of a Saccharomyces cerevisiae whole-cell lysate. as previously
described by Bakalarski et a1. (2007). LC-MS/MS analyses for both the
yeast and the mouse samples were performed on a Thermo LTQ-FT mass
spectrometer in a data-dependent mode, with the FTlO method, as previously
described by Bakalarski et a1.

2.2 Statistical background

Peptide identiﬁcation in mass spectrometry, similarly to any other database
search, relies on the highest scoring hit. This simpliﬁes the statistical analysis
because the shape of the distribution of highest scores does not depend on
the distribution of all scores, which is generally unknown.

According to extreme value theory, the maximum of a sample
of independent identically distributed random variables after proper
renormalization converges to one of three possible distributions, depending
on the general properties of the distribution within the sample. In the case
when the distribution within the sample is unbounded and has a light tail,
which is the case for the Mascot search engine, the maxima of the sample
converge to a double-exponential distribution (Gumbel, 2004). Thus, the
probability P that the database search with spectrum 1 will result in a false
identiﬁcation with score s is given by:

P =1 —F(s)= 1— exp(-€¥iexp(-(S- 110/130) (1)

where F (s) is the cumulative extreme value distribution function. For
convenience, here we isolated dependence on the relative database size in
the parameter 01,». This relative database size is spectrum dependent, since it
represents not only the ratio of the database sizes but also the ratio of the
number of peptides with a given precursor mass. Parameters 11, and 13, are
speciﬁc to the spectrum and depend only weakly on the relative databases
size in the asymptotic regime. We note that we make no assumption about
parametric form of the distribution of all scores. The distribution parameters
only refer to the extreme value asymptotic form general for a large class of
distributions.

Therefore, to compute a P-value of a peptide identiﬁcation for an
individual spectrum, we have to estimate two parameters of the distribution
11, and 13, corresponding to this spectrum in any decoy database, and adjust for
the target database size using the scaling factor 01,». An extremely important
consideration is that 01, scales linearly with the effective size of the database.
The effective database size for a peptide with a given precursor mass is just
the total number of peptides with the same (within tolerance) precursor mass
in this database. This means that the decoy database used to estimate the
distribution parameters can be of any size, just large enough that asymptotic
extreme value distribution would hold. The parameter oz, for any given

 

1129

112 /3.to's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘Og anBnV uo ::

V.Spirin et al.

 

spectrum 1 can then be estimated as a ratio of the number of peptides with
the corresponding precursor mass in the target and decoy databases. Second,
extreme value distribution theorem is not limited to the maximal value of the
Mascot score, but can be extended to any number k of top hits that the Mascot
search returns for each spectrum. The joint probability density function of
the highest k scores in the database for spectrum 1 [Equation (2)] depends
on the same two parameters 11,» and 13,» (Arnold et (11., 1992):

f(S1 w - - - J1): exp(—011’ exp(—(Sic - 110/1321)
k

alpha»
xl‘l ﬂ, Rupees—mm» (2)
1
Equation (2) provides a way to estimate parameters 11,» and 13,» for
each spectrum from a search in a decoy database from a set of highest-
scoring database hits .11 , ...sk. We obtained maximum likelihood estimators
analytically (see Supplementary Material):

 

1:1

[8th = (s) —s1 (3)
IliML = Sk +1§iMLlnk (4)

Estimation by maximum likelihood does not guarantee that the estimators
are unbiased. However, the bias of the estimators given by Equation (4)
can be computed analytically, and unbiased estimators can be constructed as
follows.

We will ﬁrst consider the standardized Gumbel distribution,

F(s) = exp(— exp(—s)); f(s) = exp( — exp(—s) — s),

corresponding to 11 = 0 and 13 = 1. We will then write the explicit results for
general 11 and 13.
Starting with PDF of the i-th order statistic (Arnold et (11., 1992),

exp(—is»)
f<i)(Si) =  6XP(— exp(—30%
one can obtain moments by integration:
1 00
E{s,»} =  xexp(—exp(—x) — ix)dx
(1 - 1)! —00

i 11
1"wa

1:1]

where y: 0.577216... is the EuleriMascheroni constant.

 

1 00
2 _ 2 _ _ _’
E{si} _ (i_1)!£mx exp( exp( x) lx)(1x
i 1 2 i 1
JT _ 1 _ 1
=?+ V— ; _Zj_2
1:1 1:1

Consequently,
712 [—1 1
Var{s,»}= — —Z 3.
6 1:1 J

Joint pdfofsl,sz,...,sk,sl is; Z... Zsk is

k
f(sl , .12, . . . , sk) = exp <—exp(—sk)— 2.1,»)

i:l

Properly marginalizing the above distribution, we get, for i <j, the joint PDF
of i-th and j—th statistic:

exp( — exp( — sj))

ﬁi).(i)(sivsf)= (F1),

j_i_l (_1)j—i—l—m
X Z  exp(—.vj(m+1))exp(—.viU— 1—m))

111:0

Using the following two formulas:

00
1 s- ex —k»s-
fs,»exp(—k,»s,»)dsi = W,
00 00
fsjexp(—exp(—sj)—kjsj)dsj/siexp(—kisi)dsi
—00 Sf
(kiwi—1)!
2—2 X
ki
ki-l—kf—l k,~+k,—11 2 2 ki-l—kf—l 1
7r
V—Z;+ki V—Z; JFK—2,72
r121 r121 11:]
one obtains
. 2
1—1 1
Emmi}: y—Z—
11:] n
2 j—l i—l j—l j—l
7r 1 1 1 1
+z—Z;+ ‘ZgJFZ; V—Z;
r121 r121 r121 11:]
Therefore,
2 1'“
JT 1
Cov{s,»,sj}=?—;;.

We see that Cov{.vi,.vj} =Var{sj}.
With the basic formulas at hand, we are now in a position to compute the
moments of our estimates. Skipping elementary algebra, we get:

A k—l A k—
ElﬁMle Tv VZILBMLl= 7;

 

H1 k—l k“ 1
Eamon—Zr k Inkw VarmML}=Zn—,.
r121 11:]

With the explicit expressions for bias, we can form unbiased estimates of
the parameters 13 and 11:

 

A 1 k k

13m}? = —k_ gsi — —k_1sk (5)
A A A k“ 1 k—l

MM; = Sk +131ML111k —13mb (V—; Z + k 111k) (6)

2.3 The algorithm

This suggests the following strategy for estimating spectrum-speciﬁc P-
values. For every spectrum obtained in a proteomics experiment we run
a search, i.e. Mascot or XlTandem, against a decoy sequence database. The
computational efﬁciency can be greatly increased with only a limited sacriﬁce
of accuracy if these searches would be run against a small size decoy database
using a very large precursor mass tolerance. We estimate parameters 11,»
and 13,» for each spectrum using a number of top hits reported by Mascot.
Parameter (xi is then computed to adjust to the effective real database size
and mass tolerance (see Supplementary Materials). This approach assumes
weak dependence of 11,» and 13,» on database size in the asymptotic regime as
discussed above. Mascot search against the real protein sequence database is
then run and P-values for all individual peptide identiﬁcations are computed
according to Equation (1).

In practice, the currently available version of Mascot reports only 10
hits for each spectrum, which is insufﬁcient for reliable estimation of
the distribution parameters. To circumvent this problem, we used several
independent searches against small decoy databases and obtained maximum

 

1130

112 13.10's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 111011 papeolumoq

9103 ‘Og 1sn8nV uo ::

Spectrum-specific P-values for protein identifications

 

likelihood estimators numerically and unbiased estimators using analytically
derived correction (Supplementary Materials).

Each decoy database contains 10000 Bernoulli sequences. The protein
length distribution for these sequences is approximated by UniProtKB/Swiss-
Prot mouse proteome. The frequencies of all amino acids are simulated to
be the same as observed amino acid frequencies in the mouse proteome.

One can, just as well, use 100 databases and estimate parameters for each
spectrum using only one top hit in each database. Our simulations indicate
that the accuracy of parameter estimation is the same for both methods. But
using 10 top hits in each database and reducing the required number of decoy
databases to 10 signiﬁcantly speeds up parameter estimation.

On the basis of P-values corresponding to individual peptide
identiﬁcations, we compute P-values for protein identiﬁcations.

As a standard practice among Mascot users, for each spectrum we consider
only the best peptide hit, and discard all other peptides with lower matching
score.

P-values of individual peptides matching the same protein are combined
into cumulative protein P-value using Stouffer’s method (Whitlock, 2005).
For the peptide match with k-th lowest P-value among all peptides from the
same protein, we compute the probability that the k-th P-value would be
as low or even lower by pure chance, using Z-test. This test converts the
P-values, 17,», from each of the k individual independent tests into standard
normal deviates Z». The sum of these deviates, divided by the square root of
the number of tests, k,

2’: 2»
Z: = A (7)
#2

can be shown to follow the standard normal distribution and provide a
test for the common null hypothesis. The minimal value of this probability
over all k peptides (corrected for multiple testing using permutations) is the
P-value for the protein identiﬁcation. We further convert these protein level
P-values to E-values corresponding to the size of the sequence database.
Alternatively, one could combine P-values of all peptides matching a protein.
However, a common situation arises when, for example, two peptides are
true hits, while the rest are noise. If one combines P-values of all such hits,
the contribution from noise may render the overall P-value insigniﬁcant.
Choosing the minimal P-value corrected for multiple testing solves this

problem.

An important issue is clustering proteins identiﬁed by the same or
overlapping groups of peptides. Redundant protein database entries, as well
as homologous proteins and splicing variants may be identiﬁed by the same
set of PSM from the experimental sample. This is a complicating issue, since
a peptide belonging to more than one distinct protein in the database makes
determination of the true corresponding protein ambiguous. A comprehensive
review of possible scenarios and approaches is given in Nesvizhskii and
Aebersold (2005).

In our method, protein expectation values are computed based on unique
evidence for the group to which this protein belongs. This is similar to the
approach used in IDPicker (Zhang et (11., 2007) in that each of our clusters
represents a minimal set of proteins that explains all the peptides in this
cluster. However, we do not eliminate proteins that explain a subset of
peptides in a peptide cluster. We report such proteins in a different cluster
with its corresponding P-value.

2.4 Software

The software is written in Perl and runs on a Linux computer. A standalone
version is available at ftp://genetics.bwh.harvard.edu/SSPV/ The software
input is: an mgf ﬁle and fasta ﬁle with a protein sequence database. Separate
scripts make a combined forward/reverse sequence database and 10 random
Bernoulli databases. The combined forward/reverse database is created for
FDR plots. To increase the precision of the FDR plots, we use a reversed
target database rather than a Bernoulli database to make it as similar to
the target database as possible. After this, a shell script runs the 10 Mascot
searches in these Bernoulli databases, then the Mascot search in the combined
database, then starts the perl script which determines the parameters for each

 

 

 

 

 

 

1 I I I ’1
’r , i/ l”;
’1’ II // II
0.1— .1- l/ m- // l/ _
x/ x; // x;
a:  J a J
2 . 2
g 001— ‘ ,1 g 0.01— . ,1 —
a 7;, _-// EL ’ l/
- " I.
. .w’ ,’ Sam I )4 / - Sum
0001— X x - SotEl 0.001— , / - SotB —
r .'/ SetC , -. 7 - SstC
/’ / /
)l )l
n | | |
D'Dqﬂlmm 0.001 0.01 0.1 °'°‘l§l0001 0.001 0.01 0.1 1
False positives False positives

Fig. 1. Fraction of false positive peptide (left) and protein (right)
identiﬁcations as a function of speciﬁed P-value threshold. Three sets of
spectra obtained in triplicate LC-MS/MS data from the in-gel digest of
the 49764 kDa MW region of mouse brain lysate. Calculated P-values are
accurate to within a factor of 2 (dashed lines).

spectrum, and then processes the combined database search output and puts
the results into a user-speciﬁed directory. The output contains text ﬁles with
the list of identiﬁed peptides and proteins and their P-values. Processing a
typical input containing 500(L10 000 spectra against a typical-size sequence
database, which includes search in 10 random databases and parameter
estimation for every spectrum, usually takes <5 min.

3 RESULTS

We tested the method using two proteomic datasets obtained from
in-gel trypsin digestion of (i) yeast and (ii) mouse brain proteins,
analyzed with a Thermo LTQ-FT mass spectrometer (see Section 2).
The datasets represent highly complex peptide mixtures from the
two species. To conﬁrm that P-values accurately estimate fraction
of false positive identiﬁcations, we run searches in two sets of decoy
databases. P-values corresponding to individual peptide or protein
identiﬁcations determined in one decoy database set are plotted
against the corresponding fractions of identiﬁcations in the other
(qq-plot). By the deﬁnition of P-value, the fraction of false-positive
identiﬁcations (estimated by the fraction of identiﬁcations in the
decoy databases) at a given P-value should ideally be equal to this
P-value. The qq-plots are shown in Figure 1 and in Supplementary
Figures S1 and S2. As seen from the qq-plots, P-values provide
practically acceptable approximation of the rate of false-positive
identiﬁcations, i.e. predict fraction of decoy database hits below
a speciﬁed P-value threshold. For example, the fraction of false-
positive identiﬁcations at P-value threshold 0.01 in the three mouse
datasets is in the range of 0.0064—0.0119, and in the yeast datasets
of 0.0120—0.0126.

Next, P-values generally discriminate between searches in the
forward (real) and reverse (decoy) databases (Fig. 2) better
than peptide ion scores assigned by Mascot. At the 1% FDR
threshold as determined by the search against the decoy database,
selecting database hits by P-value rather than by score increases
the number of identiﬁcations in the forward (real) sequence
database. In addition, we tested the performance of spectrum-
speciﬁc P-values using one other measure recommended by
Matrix Science (www.matrixscience.com/pdf/2005WKSHP4.pdf).
Figure 2B, shows the ROC curve when Mascot Ion score minus
Identity score is used as a discriminant function, similar to Searle
et (11. (2008). We ﬁnd that ion minus identity score performs
approximately equally well to ion score in discriminating true

 

1131

112 13.10's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 111011 papeolumoq

9103 ‘Og 1sn8nV uo ::

V.Spirin et al.

 

:-

‘ 5mm FDR I: 1%, P-n'alue FDR It 1%
- Scare FDR 7 19ml, P-i'i : FDR < 1%

- 5Can FDR < 1%, P-I’I E FD > 1'“ | |
10 20 30 40 90
H

sun! Ian score

In
a

 

lumber cl specu-
N w a. u.
c a o a

H
D

 

 

 

 

 

 

 

 

 

B C

2500 - | I | I I I w I I I
g 2000 — - E 500 ~ -
8 B
E 2
“I3 1 500 — - “c: we — —

 | I I 11M 1 l u l I J J

10 20 30 40 M0 10 20 30 4D
Reverse DB hits Rmrse DB hits

Fig. 2. (A) number of identiﬁed spectra with a given Mascot score for
a speciﬁed FDR cutoff, as determined by identiﬁcations in forward and
reverse protein databases. While high-scoring peptide matches are equally
well identiﬁed by raw score and P-values (cyan bars), P-value approach
has a signiﬁcant advantage over Mascot-score approach for borderline-
scoring peptides (green bars). Details are provided in Supplementary
Tables S27S5. (B) identiﬁed peptide hits. Three sets of spectra obtained
in triplicate LC-MS/MS data from the in-gel digest of the 49$4kDa
MW region of mouse brain lysate. Set A is shown. Sets B and C are
provided in Supplementary Figure S3. Orange curves: identiﬁcations by
raw Mascot score; cyan: identiﬁcations by ion minus identity score; green:
identiﬁcations corresponding to spectra-speciﬁc P-values. (C) Same set
of spectra, identiﬁed protein hits. Blue: identiﬁcations by raw Mascot
score. Forward and reverse proteins are identiﬁed by MASCOT score of
the top peptide-spectrum match. Orange: forward versus reverse protein
identiﬁcations by best P-value of PSM. Green: identiﬁcations by a single
protein P-value that combines all PSMs from the same protein.

positive versus false positive hits. Spectrum-speciﬁc P-values
outperform either combination of ion and identity scores.

To test whether spectrum-speciﬁc P-values indeed allow peptide
identiﬁcations with borderline ion scores, we analyzed the
distribution of reverse database hits with respect to both ion score
and P-values. As seen from Table 1, upper part, the fraction of
reverse database hits for scores in the range 10—20 is approaching the
fraction of forward database hits, indicating that in this score range
any forward hit is as likely to be true as false. The fraction of reverse
database hits for scores in the range 20—30 compared with forward
identiﬁcations is much smaller. However, it is still of the order of
1%. Applying strict P-value threshold eliminates almost all reverse
database hits (Table 1, lower part and Supplementary Tables S3
and S4) while retaining signiﬁcant number of forward database hits.
Most of these forward hits were supported by at least two conﬁdent
peptide identiﬁcations from the same protein, conﬁrming that these
forward hits are likely correct.

Table 1. Number of PSM for each of the mouse datasets

 

Mouse datasets, regardless of P-value

 

 

Forward Reverse
Mascot score All hits Conﬁdent hits
Set 1 10 <S <20 1229 426 666
20 <S <30 1845 1688 11
Set 2 10 <S <20 1312 459 762
20<S<30 1996 1813 9
Set 3 10 <S <20 1298 486 697
20<S<3O 2113 1919 16
Mouse datasets, P< 0.01
S H 10<S<2O 170 154 5
e 20 <S <30 496 471 2
Set 2 10<S<2O 151 140 3
20 <S <30 538 507 1
10 <S <20 130 122 6
Set 3
20 <S <30 520 494 1

 

The search is performed in both forward and reverse sequence databases. The hits are
binned by Mascot score into two ranges: 10 <S<20 and 20< S<30. These ranges
correspond to the borderline signiﬁcance of peptide identiﬁcation. All matches are
included, regardless of P-value (Upper part). Only spectra with conservative P< 0.01
are included (Lower part). Conﬁdent hits: peptides supported by at least two other
peptide identiﬁcations from the same protein.

Table 2. Discrimination of spectra by spectrum-speciﬁc P-value versus by
raw Mascot ion score for the three mouse datasets

 

FDRp < 1% FDR, > 1% FDRp < 1% FDR, > 1%

 

 

Forward Reverse Forward Reverse
Set 1 161 7 57 7
Set 2 142 7 67 7
Set 3 293 9 52 9

 

Number of forward database hits versus reverse database hits at 1% FDR level. Peptides
with only P-values passing the FDR cutoff 1% versus peptides with only Mascot score
passing the FDR cutoff 1%. FDRP: P-value FDR, FDR]: ion-score FDR.

Table 2 and Supplementary Table S5 is another demonstration
that identiﬁcation by spectrum-speciﬁc P-values signiﬁcantly
outperforms identiﬁcation by Mascot ion score. We count the
fraction of reverse database hits at l% FDR level obtained using
Mascot ion score but not by the l% FDR threshold if sorted by
P-value. Conversely, we count the fraction of reverse database hits
at the l% FDR level obtained by sorting database hits by P-value but
not by Mascot ion score. Table 2 shows that the fraction of peptides
passing only FDR cutoff is signiﬁcantly higher than the fraction of
peptides passing only Mascot score cutoff.

In all datasets, results of the search according to P-values
leads to higher number of true positive hits (approximated by
hits in the database of real protein sequences) per false-positive
hit (approximated by hits in the database of reversed protein
sequences). Selecting peptide identiﬁcations by P-value rather than
score leads to increased sensitivity at any speciﬁcity threshold
(Fig. 2B, Supplementary Figs S3 and S4).

 

1132

112 13.10's[Bumo[pJOJXO'sotwu1101utotq/1:duq 111011 pep1201umoq

9103 ‘0g1sn8nv uo ::

Spectrum-specific P-values for protein identifications

 

 

 

 

 

1E z
: ,’
I // ’
- - SetA / z’
0.1.— - SetB /

E - SelC /
_ f

s / r

I; 001— //

a- _ /

o- /
If /
0.001.— .) /

E 7 /
./ /
_ . /
" /

 

 

4 ./.II..II| I I....II| I I..II..I I lllllll
o‘mlildoot 0.001 0.01 0.1 1
False positives

Fig. 3. Peptide qq-plots for the three mouse datasets; identiﬁcations with
XlTandem.

In addition to the performance comparison with raw Mascot
scores, we tested the FDRs obtained with our method against those
obtained using PeptideProphet. PeptideProphet source code TPP
v4.4 was downloaded from http://proteinprophet.sourceforge.net/.
For each of the three mouse and three yeast datasets, we ran
xinteract to identify PSMs in combined target plus reversed database.
Supplementary Figure S9 shows the comparison of FDRs for
peptides identiﬁed with PeptideProphet and using spectrum-speciﬁc
P-values. Spectrum-speciﬁc P-values outperform PeptideProphet by
5—10%, depending on the dataset.

At the protein level, the use of P-values combining evidence from
multiple peptides increases sensitivity over a conventional method
of protein identiﬁcation based on the score of the best scoring peptide
from the protein (Fig. 2C, Supplementary Figs S3—S4).

Importantly, the major increase in the number of true-
positive identiﬁcations per false-positive identiﬁcation (increase in
sensitivity at a given speciﬁcity level) is observed at strict thresholds
corresponding to low rate of false-positive identiﬁcations. This
means that spectrum-speciﬁc P-values conﬁdently validate medium-
scoring true positives while efﬁciently suppressing high scoring false
positives.

To exclude the possibility that these additional identiﬁcations
in the forward database are false identiﬁcations, we repeated the
analysis limiting it to conﬁdently identiﬁed proteins, i.e. proteins
with at least three matching peptides (Supplementary Fig. S5).
Spectrum-speciﬁc P-values increase the number of these conﬁdently
true positive identiﬁcations at any FDR cutoff.

To demonstrate generality and platform independence of our
approach, we applied spectrum-speciﬁc P-values to identiﬁcations
made by XlTandem platform (Supplementary Materials). We
computed peptide P-values using parameters estimated from top
hits according to X! Tandem hyperscore in searches against 50
decoy databases. These P-values are shown to provide accurate
rate of false-positive identiﬁcations, as seen from qq-plots (Fig. 3,
Supplementary Fig. S6). Discrimination between searches in
forward and reverse databases by P-values versus XlTandem
E-values is shown in Supplementary Figures S7 and S8.

4 DISCUSSION

P-values for peptide and protein identiﬁcations based on the analysis
of order statistics can be generally applied in conjunction with any

peptide-to-spectrum matching software, regardless of the matching
algorithm.

The speciﬁcity of spectrum P-values renders unnecessary
empirical conventions to infer signiﬁcance of peptide identiﬁcations.
Matrix Science, for example, provides two ion score thresholds
(www.matrixscience.com/pdf/2005WKSHP4.pdf). Ion identity
threshold is a value representing a ﬁxed probability of encountering
a false match. However, this value is conservative and may
not be achieved for some true matches, due to poor signal
or fragmentation gaps. Therefore, Mascot also provides a
second, less conservative, homology threshold. Our approach,
by providing a single P-value for every spectrum, solves the
problem of empirical conventions, based on these two thresholds,
automatically.

Existing methods to assign statistical signiﬁcance to peptide-
to-spectrum matches either use a single threshold for the dataset
as a whole (Elias and Gygi, 2007; Kall et (11., 2008; Park et (11.,
2008; Ramos-Fernandez et (11., 2008) or take into account spectrum
speciﬁcity by stratifying spectra or peptides (Anderson et (11.,
2003; Cox and Mann, 2008; Kall et (11., 2007). Other methods
assign spectrum-speciﬁc measures of statistical signiﬁcance by
ﬁtting parametric models to the distribution of peptide-to-spectrum
matches (Craig and Beavis, 2004; Klammer et (11., 2009; Searle
et (11., 2008). FAST SEQUEST (Eng et (11., 2008) and XlTandem
(Craig and Beavis, 2004) assume the exponential decay of the
score distribution. These methods use regression-based approaches
to estimate spectrum-speciﬁc E-values. The generality of the
assumption of the exponential tail is justiﬁed using the arguments
presented in this work (convergence to the Gumbel distribution).
The tail of the double exponential distribution is approximately
exponential. However, the regression-based estimator employed by
FAST SEQUEST and XlTandem has two disadvantages addressed
by our approach. First, it uses hundreds of points for the estimation.
This may lead to inaccuracies if convergence to the Gumbel
distribution is slow. Second, simulations of the true Gumbel
distribution (Supplementary Fig. S10) show that the regression-
based estimator is biased and inefﬁcient resulting in E-values that
are volatile and, on average, inﬂated.

Reliance on the asymptotic distribution of high order statistics
allows avoiding any speciﬁc parametric models of the distribution
of peptide-to-spectrum matches. Distribution of high order statistics,
given the convergence to the asymptotic behavior, depends on the
overall distribution of peptide-to-spectrum matches only through
parameter values. Unbiased estimates of these parameters help
approximating the far tail of the distribution and construct platform-
independent spectrum-speciﬁc P-values.

5 CONCLUSION

We propose a method and software to assign statistical signiﬁcance
to peptide and protein identiﬁcation by mass spectrometry. A single
probabilistic conﬁdence measure (P-value) is assigned to each
identiﬁcation. This P-value is spectrum-speciﬁc and independent
of instrumentation or software scoring method. The platform
independence is achieved because the method makes very few
assumptions about the distribution of the PSM scores. It is based
on the asymptotic extreme value distribution. The parameters of
the extreme value distribution are estimated using newly obtained
analytical unbiased estimates.

 

1133

112 13.10's[BumoIpJOJXO'sotwu1101utotq/1:duq 111011 pep1201umoq

9103 ‘0g1sn8nv uo ::

V.Spirin et al.

 

Therefore, our approach does not require introducing any
empirical cutoffs or data stratiﬁcations. It also avoids ﬁtting any
parametric distribution to the discriminant function provided by a
search engine. Such parametric models can be inaccurate at the
important far tail of the distribution.

Protein level P-values are constructed by combining peptide level
P-values using the Stouffer’s method, so a single P-value is reported
per protein identiﬁcation. Spectrum speciﬁcity allows improving
accuracy and FDR.

ACKNOWLEDGEMENT

We thank Dr Ivan Adzhubei for help with the software and Dr Ronald
Beavis for help with installing XlTandem.

Funding: National Institute of Health (Grants RLl DE019022 and
R01 GM070986).

Conﬂict of Interest: none declared.

REFERENCES

Anderson,D.C. et al. (2003) A new algorithm for the evaluation of shotgun peptide
sequencing in proteomics: support vector machine classiﬁcation of peptide MS/MS
spectra and SEQUEST scores. J. Proteome Res., 2, 1377146.

Alves,G. et al. (2007) RAId_DbS: peptide identiﬁcation using database searches with
realistic statistics. Biol. Direct, 2, 25.

Arnold,B.C. et al. (1992) A First Course in Order Statistics. Jihn Wiley, New York.

Bakalarski,C.E. et al. (2007) The effect of mass accuracy, data acquisition speed, and
search algorithm choice on peptide identiﬁcation rates in phosphoproteomics. Anal.
Bioanal. Chem, 389, 140971419.

Bern,M. and Goldberg,D. (2008) Improved ranking functions for protein and
modiﬁcation-site identiﬁcation. J. Compnt. Biol., 15, 7057719.

Carr,S. et al. (2004) The need for guidelines in publication of peptide and protein
identiﬁcation data: working group on publication guidelines for peptide and protein
identiﬁcation data. Mol. Cell. Proteomics, 3, 5317533.

Cox,J. and Mann,M. (2008) MaxQuant enables high peptide identiﬁcation
rates, individualized p.p.b.-range mass accuracies and proteome-wide protein
quantiﬁcation. Nat. Biotechonol., 26, 136771392.

Craig,R. and Beavis,R.C. (2004) TANDEM: matching proteins with tandem mass
spectra. Bioinformatics, 20, 146671467.

Elias,GE., and Gygi,S.P. (2007) Target-decoy search strategy for increased conﬁdence
in large-scale protein identiﬁcations by mass spectrometry. Nat. Methods, 4,
2077214.

Eng,J.K. et al. (2008) A Fast SEQUEST cross correlation algorithm. J. Proteome Res.,
7, 45984602.

Feng,J. et al. (2007) Probability model for assessing proteins assembled from
peptide sequences inferred from tandem mass spectrometry data. Anal. Chem, 79,
390173911.

Geer,L.Y. et al. (2004) Open mass spectrometry search algorithm. J. Proteome Res., 3,
9587964.

Gumbel,E.J. (2004) Statistics of Extremes. Dover Publications, Inc.

Kall,L. et al. (2007) Semi-supervised learning for peptide identiﬁcation from shotgun
proteomics datasets. Nat. Methods, 4, 9237925.

Kall,L. et al. (2008) Assigning signiﬁcance to peptides identiﬁed by tandem mass
spectrometry using decoy databases. J. Proteome Res., 7, 29734.

Keller,A. et al. (2002) Empirical statistical model to estimate the accuracy of peptide
identiﬁcations made by MS/MS and database search. Anal. Chem, 74, 538375392.

Kim,S. et al. (2009) Spectral probabilities and generating functions of tandem mass
spectra: a strike against decoy databases. J. Proteome Res., 7, 335473363.

Klammer,A.A. et al. (2009) Statistical calibration of the SEQUEST Xcorr funtion.
J. Proteome Res, 8, 210G218.

Moore,R.E. et al. (2002) Qscore: an algorithm for evaluating SEQUEST database search
results. J. Am. Soc. Mass. Spectrom, 13, 3787386.

Nesvizhskii,A.I. and Aebersold,R. (2005) Interpretation of shotgun proteomic data. The
protein inference problem. Mol. Cell. Proteomics, 4, 141971440.

Nesvizhskii,A.I. et al. (2003) A statistical model for identifying proteins by tandem
mass spectrometry. Anal. Chem, 75, 46464658.

Park,C.Y. et al. (2008) Rapid and accurate peptide identiﬁcation from tandem mass
spectra. J. Proteome Res., 7, 302273027.

Ramos-Femandez,A. et al. (2008) Generalized method for probability-based peptide
and protein identiﬁcation from tandem mass spectrometry data and sequence
database searching. Mol. Cell. Proteomics, 7, 174871754.

Reiter,L. et al.(2009) Protein identiﬁcation false discovery rates for very large
proteomics data sets generated by tandem mass spectrometry. Mol. Cell. Proteomics
8, 240572417.

Searle,B.C. et al. (2008) Improving sensitivity by probabilistically combining
results from multiple MS/MS search methodologies. J. Proteome Res., 7,
2457253.

Weatherly,D.B. et al. (2005) A euristic method for assigning a false-discovery rates for
protein identiﬁcations from Mascot database search results. Mol. Cell. Proteomics,
4 , 7627772.

Whitlock,M.C. (2005) Combining probability from independent tests: the weighted
Z-method is superior to Fisher’s approach. J. Evol. Biol., 18, 136871373.

Zhang,B. et al. (2007) Proteomic parsimony through bipartite graph analysis improves
accuracy and transparency. J. Proteome Res., 6, 354973557.

 

1134

112 13.10's[BumoIpJOJXO'sotwui101utotq/1:duq 111011 pepeo1umoq

9103 ‘0g1sn8nv uo ::

