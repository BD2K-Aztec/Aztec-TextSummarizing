Bioinformatics, 31 (22), 2015, 3593—3599

doi: 10.1093/bioinformatics/btv422

Advance Access Publication Date: 23 July 2015
Original Paper

 

 

Sequence analysis

TEtranscripts: a package for including
transposable elements in differential expression

analysis of RNA-seq datasets

Ying Jin, Oliver H. Tam, Eric Paniagua and Molly Hammel|*

Cold Spring Harbor Laboratory, Cold Spring Harbor, NY, 11724, USA

*To whom correspondence should be addressed.
Associate Editor: lvo Hofacker

Received on February 19, 2015; revised on June 22, 2015; accepted on July 14, 2015

Abstract

Motivation: Most RNA—seq data analysis software packages are not designed to handle the
complexities involved in properly apportioning short sequencing reads to highly repetitive regions
0fthe genome. These regions are often occupied by transposable elements (TEs), which make up
between 20 and 80% of eukaryotic genomes. They can contribute a substantial portion oftranscrip—
tomic and genomic sequence reads, but are typically ignored in most analyses.

Results: Here, we present a method and software package for including both gene— and TE—associated
ambiguously mapped reads in differential expression analysis. Our method shows improved recovery
of TE transcripts over other published expression analysis methods, in both synthetic data and qPCR/

NanoString—validated published datasets.

Availability and implementation: The source code, associated GTF files for TE annotation, and test—
ing data are freely available at http://hammelllab.labsitescshLedu/software.

Contact: mhammell@cshl.edu.

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Transposable elements are mobile DNA elements that constitute a
large fraction of most eukaryotic genomes. These parasitic genetic
elements propagate by multiplying within the genomes of host cells
and can be passed from generation to generation through the germline
lineage. Although the majority of TE copies are non-functional; a sub-
set has retained the ability to transcribe and mobilize (Beck et (11.,
2010; Bennett et (11., 2008; Hancks and Kazazian, 2012; Honma
et (11., 1993; Huang et (11., 2012; Kano et (11., 2009; Mills et (11., 2007).
Although retrotransposons require an RNA intermediate to transpose;
both DNA and RNA transposons are transcribed from the genome;
and they can accumulate in conditions such as cancer (Criscione
et (11., 2014; Lamprecht et (11., 2012; Lee et (11., 2012; Sciamanna et
(11., 2013; Sciamanna et (11., 2014; Shukla et (11., 2013; Tubio et (11.,
2014); neurodegenerative diseases (Bundo et (11., 2014; Li et (11., 2013;
Reilly et (11., 2013); as well as during embryogenesis (Fadloun et (11.,
2013; Macia et (11., 2011; Peaston et (11., 2004); neural development

(Coufal et (11., 2009; Coufal et (11., 2011; Faulkner et (11., 2009; Muotri
et (11., 2005; Perrat et (11., 2013; Thomas et (11., 2012) and aging
(De Cecco et (11., 2013; Li et (11., 2013; Sedivy et (11., 2013). However;
TE-associated reads are often discarded in sequencing data analyses
because of the uncertainty in attributing ambiguously mapped reads
to these regions; despite some previous attempts to integrate them in
downstream analyses (Chung et (11., 2011; Day et (11., 2010; Rosenfeld
et (11., 2009; Treangen and Salzberg, 2011; Tucker et (11., 2011; Wang
et (11., 2010). Here; we present a program called TEtr‘tlIzscr‘ipts that
allows users to analyze both gene- and TE-associated reads concur-
rently in one simplified workﬂow.

2 Input data

The input data for TEtr‘tlIzscr‘ipts consists of alignment files in either
the SAM or BAM format (Li et (11., 2009); and two annotation files in
the General Transfer Format (GTF) (http://mblab.wustl.edu/GTF22.

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3593

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Langmead cl (1]., 2009

Supplementary Adaterials Supplementary Fig. 51

Smit cl (1]., 1996

Karolchik cl (1]., 2003
Nussbaumer cl (1]., 2013

Figure 1

Alignmentﬁles Gene annotations TE annotations
(SAM/BAM) (GTF) (GTF)

Jurka cl (1]., 2005

/810'sreumofploqxo"sormuuoqurorqﬂ:duq

TEtranscripts

3595

 

estimation of relative abundance on multi—reads, p, of each TE tran—
script, t, is computed by Equation (1).

(1)

IT

.

5
5

-

5
o I.
T

Pt:
;

T is the set of all TE transcripts; F, is the set of multi—reads assigned
to t; 1: denotes the effective length of transcript t, 1: :1, — m + 1,
where m is the fragment length and l, is the length of transcript t.
The fragment length is calculated from the paired—end alignment in—
put file, or provided as a parameter by the user for single—end
samples.

The E—step computes the fraction of each multi—read allocated to
each TE transcript. Suppose that a multi—read 7' maps to a set of TE
transcripts T,. According to the initial assignment, the fraction of
f attributed to any TE transcript t in T,, 010(7'. t), is the relative abun—
dance of t over the sum of relative abundance of all TE transcripts in

0
Ti: “0(fvt) : Zpl 0'

NET, (or!

 

This allocation will then be used in the M—step

of the algorithm to compute the relative abundance of each TE tran—
script. As described in Equations (2) and (3), these two steps will
run alternatively for a specified number of iterations, k, until the
program converges or as set by the user.

(ls-1)

“120310 I % (2)
EM
NET,
2 Wm)
It
k Vf—tr

p’ Z We

va’ﬁs

SET IA}
After the EM procedure, the estimated relative abundance of
each TE transcript from the multi—reads is integrated with the
unique—read counts to compute the total relative abundance. The
element level abundances are then computed by summing up all in—

stances of each TE subfamily.

3.4 Differential analysis

Following the generation of a count table for gene and TE tran—
scripts, the differential expression analysis closely follows the DESeq
package (Anders and Huber, 2010) for modeling the counts data
with a negative binomial distribution and computing adjusted
P—values. In addition to the standard transcript abundance normal—
ization approach used by the DESeq package, TEtranscripts offers
two additional options, reads per mapped million (RPM) and
Quantile normalization. All other procedures exactly follow the
DESeq method. TEtranscripts runs the DESeq method with a default
set of general parameters. When there are no (or very few) repli—
cates, we use the blind method for variance estimation and fit-only
for SharingMode. Otherwise, we use pooled or per-condition meth—
ods and maximum SharingMode, as suggested by the DESeq pack—
age. In all scenarios, we use the parametric fitting model (fitType).
The R code used for differential expression analysis is generated as
part of the output to allow users to further customize the DESeq
parameters and re—calculate differential expression statistics.

3.5 Implementation
TEtranscripts is written in Python. The SQUAREM (Varadhan and
Roland, 2008) procedure is used during EM iterations to improve

the convergence speed. TEtranscripts is available as an open—source
program under a standard GPLv3 open source license and has been
developed and tested on Linux and Macintosh OSX. The software
package and associated TE GTF files can be found at http://ham—
melllab.labsites.cshl.edu/software. The TE GTF files currently in—
clude chimpanzee (panTro4), fly (dm3), maize (Zea mays RefGen
v2), mouse (mm9 and mm10), rat (rn5 and rn6) and human (hg18,
hg19/GRCh37, and hg38/GRCh38).

4 Results

To examine the accuracy and performance of TEtranscripts, we
compared it with HTSeq—count version 0.5.4p3 (Anders et al.,
2014), Cufﬂinks version v2.1.1 (Trapnell et al., 2010, 2012) and
RepEnrich (Criscione et al., 2014) on both synthetic and real data.
HTSeq—count was chosen as a standard method that counts only
uniquely mapped reads and is nearly identical to the uniq mode in
TEtranscripts. Cufflinks was chosen as a popular method for gene
abundance estimation that works from pre—mapped BAM files and
includes options to handle multi—reads, but is not specifically de—
signed for TEs. To the best of our knowledge, only one other pub—
lished method has been designed for TE expression analysis from
RNA—seq data, RepEnrich, but this method does not work with pre—
mapped BAM files. There is a recently published pipeline set piPipes
(Han et al., 2015) to study piRNAs and TE—derived RNAs. Because
it uses HTSeq—count and Cufflinks for quantification and Cuffdiff
for differential analysis, we did not include comparisons to piPipes
separately.

For all comparisons, TE abundance measurements were given at
the resolution of the element level (e.g. L1Ma'_A). For the synthetic
datasets, accuracy was quantified as the proportion of abundances
accurately recovered by each method for each TE element. For pub—
lished datasets, accuracy was determined by agreement between the
quantitative validation measurements (e.g. Q—PCR, NanoString) and
the expression estimations computed by each software package.

4.1 TE recovery in synthetic data

Simulated datasets were used to investigate the TE abundance recov—
ery rate by each approach, paying particular attention to the recov—
ery of TEs known to be active in the mouse genome, obtained from
a study by Molaro et al. (2014). FluxSimulator v1.2.1 (Griebel et
al., 2012) was used to generate multiple RNA—seq datasets from the
mouse genome (mm9), consisting of 76 bp single—end reads from
transcripts that include both annotated genes and TEs (see
Supplementary Table 51 for parameters used). Each dataset con—
sisted of 24 million reads in total, with 17% of all transcripts
derived from TEs of varying abundances. STAR (Dobin et al., 2012)
was used to map the simulated reads with maximum multiple
alignments of no more than 100, using the variables —
winAnc/aorMultimameax 100 and —outFilterMultimameax 100.
Based on these parameters, we found that 87% of the reads were
mapped onto the mouse genome, while TE reads had an average
mappability of 70%. Furthermore, roughly half of the TE reads gen—
erated were uniquely mappable, comparable to what is observed in
published transcriptome datasets. The simulated TE reads had a
smaller mappability rate than gene—associated reads largely due to
reads aligning to more than 100 genomic locations.

The aligned read files were then used as input for the four abun—
dance estimation approaches used in this study: HTSeq—count,
Cufﬂinks, RepEnrich, and TEtranscipts. HTSeq—count was run in
intersection-nonempty mode, and using a GTF file that contains

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

3596

Y.Jin et al.

 

both TE and gene annotations for abundance estimation. Because
HTSeq-count considers only uniquely mapped reads; any multi-
mapped TE reads will be discarded by this approach. Cufflinks was
run with the settings of rescue method for multi-reads (7L1), which
takes into account both unique-reads and multi-reads; and uni-
formly divide each multi-read to all the positions initially. When
multi-read correction is enabled; Cufflinks will reassign each multi-
mapped read probabilistically based on the initial abundance esti-
mations; with the uniquely mapping reads used to inform the likely
distribution of the multi-reads (Trapnell et al., 2010; 2012). To run
RepEnrich; we built the peseudogenome of TEs using the
RepeatMasker file on mm9 as described in the RepEnrich tutorial.
Unique-reads and multi-reads were derived based on the STAR out-
put. TEtraizscripts was run in multi mode with EM optimization
invoked. The accuracy of each method in estimating abundances of
TE expression was computed and displayed as the frequencies of the
rate of recovered abundances (Fig. 2; Supplementary Fig. S2).

In general; TEtransctripts outperforms HTSeq-count; Cufflinks
and RepEnrich in terms of abundance recovery rate; both for non-
functional and active TEs. The overall average recovery rate for
TEtranscripts was 88.84%; with 53.74% for HTSeq-count; 43.72%
for Cufflinks and 59.8% for RepEnrich. The fraction of TEs for
which the estimated abundance is within 15% of the true abundance
was: 41.7% for TEtranscripts; 14.4% for HTSeq-count; 9.3% for
RepEnrich and 16.8% for Cufflinks. In this dataset; 14.5% of the
detected TEs are active TEs; and all three approaches were able to
capture some of them. TEtranscripts was able to recover >80% of
the reads for 77% of the active TEs; HTSeq-count was not able to
recover >80% of the reads for any of the active elements; Cufflinks
recovered at least 80% of the reads for 8% of the active TEs;
RepEnrich recovered >80% of reads for 75% of the active TEs; but
over-counted 57.69% of the active TEs. The fraction of active TEs
for which the estimated abundance is within 15% of the true abun-
dance was: 61.5% for TEtranscripts; 0% for HTSeq-count; 23.1%
for RepEnrich; and 3.8% for Cufflinks. TEtranscripts and

0.4
I TEtranscripts
I HTseqicount
I Cufflinks
I RepEnrich
0.3
>
E
a 0.2
9
LL

<1 0%
10%4200/o
209043090
ao°oa4o°
40°0450°
50mm
eo°oa7o°
7o°oaeo°
gov/049090

eon/Hoon/o

>1oo=zo

Abundance Recovery Rate

Fig.2. Comparison of TE abundance recovery. Displayed are the distributions
0fthe rate of measured abundances versus true abundances by each method.
HTSeq-count abundance recovery rates shown in light blue, Cufflinks recov-
ery rates shown in blue, TEtranscripts with multi mode recovery rates shown
in green, and RepEnrich recovery rates shown in purple

RepEnrich over-counted some TEs; which is displayed as the 15%
of elements whose abundances were estimated to be >100% of their
actual values at the far right of Figure 2. Please refer to
Supplementary Figure S4 for recovery rates with and without the
EM optimization option in TEtranscripts.

Figure 3 shows the abundances of active TEs estimated by each
software package as compared with the ground truth (denoted with
red dots). In most cases; TEtranscripts (green dots) is within 90% of
the actual value; while the other two methods; HTSeq-count and
Cufflinks; frequently under-estimate the abundance of TE transcripts
for young; active TEs. RepEnrich (purple dots) shows more vari-
ations; nearly 30% under-estimation and 40% over-estimation.
HTSeq-count (light blue dots) was expected to underestimate the
counts; since the discarded multi-reads often constitute nearly 50% of
the TE-associated reads. Surprisingly; Cufﬂinks also under-estimates
the abundances for many active TEs; despite incorporating multi-
reads in its analysis. Both under- and over-estimating the TE tran-
script abundances will affect both the ability to accurately calculate
fold changes between samples and the power with which to calculate
P-values for any associated changes. Please refer to Supplementary
Figure S3 for the distribution of abundance recovery rates on active
TEs of four approaches. In the next section; we assess the ability of
these methods to return accurate fold changes and significant P-values
for TEs known to have altered expression in published datasets that
used a quantitative validation of their RNA-seq data.

4.2 TE recovery in published data

To determine the usefulness of our algorithm on experimentally gen-
erated results; we tested TEtranscripts on previously published
RNA-seq datasets of Drosophila and mouse transcriptomes. We
then compared TEtranscripts to other approaches; such as HTSeq-
count; Cufflinks and RepEnrich; each combined with DESeq. We
applied DESeq for differential expression analysis on the outputs of
the three approaches to directly compare the effects of quantifica-
tion on P-value estimation. Both HTSeq-count and RepEnrich out-
put raw counts that can be input to DESeq without transformation.
The output of Cufflinks has to be converted to raw counts before
running DESeq. To convert Cufflinks output; we first calculated
raw counts assigned to each isoform by multiplying the length over
1000 to the Fragments Per Kilobase of exon per Million reads

  

I True abundance o
3 0 TEtranscripts
$ 0 HTseqicounl
0 Cufflinks
0 RepEnrich
V
O
+
CD
g o
o
E
E “of
E w .
< .—
- i
I
N
O
+
CD
.
.— o
O
+
CD
0 10 20 30 40 50

Active TEs ranked by true abundance

Fig. 3. Active TE expression estimation. Reads associated with active TE
elements are more likely to be missed by algorithms that rely heavily on
unique reads

/3.IO'S[EIIm0[p.IOJXO'SOIJEIIIJOJIIIOIq/ﬂduq

Gnanakkan er al. (2013)

Brawand er al.; 2011

Supplementary Fig. S5

Smit er al.; 1996

Figure 4

 

Figure 5

()htanietiﬂ.(2013)

LietaL;2013
Rozhkov
etaL;2013

Fig. 6

III   

 

 

Ll _i.|

Figure4

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

 

Kelle) and Rinn, 2012 Lu (’1 al.,
2014 ()hnuki (’1 al., 2014 \thg (’1 al., 2014
Bundo (71 al., 2014 Lamprecht (71 al., 2012 Li (’1 al., 2013
Reill} (71 al., 2013 Sciarnanna (71 al., 2013 2014 Shukla (71 al.,
2013 Tucker (’1 al., 2011

/310'S[BHJnOl-pJOJXO'SOIJBLUJOJIIIOICI”K1111]

TEtranscripts

3599

 

Faulkner,G.]. et al. (2009) The regulated retrotransposon transcriptome of
mammalian cells. Nat. Genet., 41, 563—571.

Gnanakkan,V.P. et al. (2013) TE-array-a high throughput tool to study trans-
poson transcription. BMC Genomics, 14, 869.

Griebel,T. et al. (2012) Modelling and simulating generic RNA-seq experi-
ments with the flux simulator. Nucleic Acids Res., 40, 10073—10083.

Han,B.W. et al. (2015) piPipes: a set of pipelines for piRNA and transposon
analysis via small RNA-seq, RNA-seq, degradome- and CAGE-seq, ChIP-
seq and genomic DNA sequencing. Bioinformatics, 31, 593—5 95.

Hancks,D.C. and Kazazian,H.H., Jr. (2012) Active human retrotransposons:
variation and disease. Curr. Opin. Genet. Dev.,22, 191—203.

Honma,M.A. et al. (1993) High-frequency germinal transposition of DsALS
in Arabidopsis. Proc. Natl. Acad. Sci., 90, 6242—6246.

Huang,C.R. et al. (2012) Active transposition in genomes. Annu. Rev. Genet.,
46, 65 1—6 75 .

Jurka,]. et al. (2005) Repbase update, a database of eukaryotic repetitive elem-
ents. Cytogent. Genome Res., 110, 462—467.

Kano,H. et al. (2009) L1 retrotransposition occurs mainly in embryogenesis
and creates somatic mosaicism. Genes Dev., 23, 1303—1312.

Karolchik,D. et al. (2003) The UCSC genome browser database. Nucleic
Acids Res., 31, 51—54.

Kelley,D. and Rinn,]. (2012) Transposable elements reveal a stem cell-specific
class of long noncoding RNAs. Genome Biol., 13, R107.

Lamprecht,B. et al. (2012) Derepression of an endogenous long terminal re-
peat activates the CSF1R proto-oncogene in human lymphoma. Nat. Med.,
16, 5 71—5 79.

Langmead,B. et al. (2009) Ultrafast and memory-efﬁcient alignment of short
DNA sequences to the human genome. Genome Biol., 10, R25.

Lee,E. et al. (2012) Landscape of somatic retrotransposition in human cancers.
Science, 337, 967—971.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Li,W. et al. (2012) Transposable elements in TDP—43—mediated neurodegener-
ative disorders. PLoS One, 7, e44099.

Li,W. et al. (2013) Activation of transposable elements during aging and neur-
onal decline in drosophila. Nat. Neurosci., 16, 529—531.

Lu,X. et al. (2014) The retrovirus HERVH is a long noncoding RNA required
for human embryonic stem cell identity. Nat. Struct. Mol. Biol., 21, 423—425.

Macia,A. et al. (2011) Epigenetic control of retrotransposon expression in
human embryonic stem cells. Mol. Cell Biol., 31, 300—316.

Mills,R.E. et al. (2007) Which transposable elements are active in the human
genome?. Trends Genet., 23, 183—191.

Molaro,A. et al. (2014) Two waves of de novo metylation during mouse germ
cell development. Genes Dev., 28, 1544—1549.

Muotri,A.R. et al. (2005) Somatic mosaicism in neuronal precursor cells medi-
ated by L1 retrotransposition. Nature, 35, 903—910.

Nussbaumer,T. et al. (2013) MIPS PlantsDB: a database framework for com-
parative plant genome research. Nucleic Acids Res., 41, 1144—1 151.

Ohnuki,M. et al. (2014) Dynamic regulation of human endogenous retrovi-
ruses mediates factor-induced reprogramming and differentiation potential.
Proc. Natl. Acad. Sci., 111, 12426—12431.

Ohtani,H. et al. (2013) DmGTSF1 is necessary for Piwi-piRISC-mediated
transcriptional transposon silencing in the drosophila ovary. Genes Dev.,
27,1656—1661.

Peaston,A.E. et al. (2004) Retrotransposons regulate host genes in mouse 00-
cytes and preimplantation embryos. Dev. Cell, 7, 597—606.

Perrat,P.N. et al. (2013) Transposition-driven genomic heterogeneity in the
drosophila brain. Science, 340, 91—95.

Reilly,M.T. et al. (2013) The role of transposable elements in health and dis-
eases of the central nervous system. ]. Neurosci., 33, 17577—17586.

Rosenfeld,].A. et al. (2009) Investigating repetitively matching short
sequencing reads: the enigmatic nature of H3K9me3. Epigenetics, 4, 476—
486.

Rozhkov,N. et al. (2013) Multiple roles for Piwi in silencing drosophila trans-
posons. Genes Dev., 27, 400—412.

Sciamanna,I. et al. (2013) A tumor—promoting mechanism mediated by retro-
transposon-encoded reverse transcriptase is active in human transformed
cell lines. Oncotarget, 4, 2271—2287.

Sciamanna,I. et al. (2014) Regulatory roles of LINE-1-encoded reverse tran-
scriptase in cancer onset and progression. Oncotarget, 5, 8039—8051.

Sedivy,].M. et al. (2013) Death by transposition—the enemy within?
Bioessays, 35, 1035—1043.

Shukla,R. et al. (2013) Endogenous retrotransposition activates oncogenic
pathways in hepatocellular carcinoma. Cell, 153, 101—1 11.

Smit,A. et al. (1996—2010) Repeatmasker Open-3.0, <http://www.
repeatmasker.org>.

Thomas,C.A. et al. (2012) LINE-1 retotransposition in the nervous system.
Annu. Rev. Cell Dev. Biol.,28, 555—573.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNASeq
reveals unannotated transcripts and isoform switching during cell differenti-
ation. Nat. Biotech, 28, 511—515.

Trapnell,C. et al. (2012) Differential gene and transcript expression analysis
of RNA-seq experiments with TopHat and cufﬂinks. Nat. Protocols, 7,
5 62—5 78.

Treangen,T.]. and Salzberg,S.L. (2011) Repetitive DNA and next-generation
sequencing: computational challenges and solutions. Nat. Rev. Genet., 13,
36—46.

Tubio,].M. et al. (2014) Extensive transduction of nonrepetitive DNA
mediated by L1 retrotransposition in cancer genomes. Science, 345,
1251343.

Tucker,B.A. et al. (2011) Exome sequencing and analysis of induced pluri-
potent stem cells identify the cilia-related gene male germ cell-associated
kinase (MAK) as a cause of retinitis pigmentosa. Proc. Natl. Acad. Sci., 108,
E5 69—E5 76.

Varadhan,R. and Roland,C. (2008) Simple and globally convergent methods
for accelerating the convergence of any EM algorithm. Scand. ]. Stat., 35,
335—35 3.

Wang,]. et al. (2010) A Gibbs sampling strategy applied to the mapping of am-
biguous short-sequence tags. Bioinformatics, 26, 2501—2508.

Wang,]. et al. (2014) Primate-speciﬁc endogenous retrovirus-driven transcrip-
tion deﬁnes naive-like stem cells. Nature, 516, 405—409.

ﬁm'srcumol‘pquo'sopeuuopttotq/ﬁdnq

