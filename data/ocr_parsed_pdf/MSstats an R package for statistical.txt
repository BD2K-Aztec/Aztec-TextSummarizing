APPLICATIONS NOTE V°" 33.7%.légi‘iliéiféiiiifiﬁiig

 

Systems biology

Advance Access publication May 2, 2014

MSstats: an R package for statistical analysis of quantitative mass
spectrometry-based proteomic experiments
Meena Choi‘, Ching-Yun Chang‘, Timothy Clough‘, Daniel Broudyz, Trevor Killeenz,

Brendan MacLean2 and Olga Vitek1'3'*

1Department of Statistics, Purdue University, West Lafayette, IN, 2Department of Genome Sciences, University of
Washington, Seattle, WA 98195 and 3Department of Computer Science, Purdue University, West Lafayette,

IN 47907, USA
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: MSstats is an R package for statistical relative
quantification of proteins and peptides in mass spectrometry-based
proteomics. Version 2.0 of MSstats supports label-free and label-
based experimental workflows and data-dependent, targeted and
data-independent spectral acquisition. It takes as input identiﬁed
and quantified spectral peaks, and outputs a list of differentially abun-
dant peptides or proteins, or summaries of peptide or protein relative
abundance. MSstats relies on a flexible family of linear mixed models.
Availability and implementation: The code, the documentation and
example datasets are available open-source at www.msstats.org
under the Artistic-2.0 license. The package can be downloaded from
www.msstats.org or from Bioconductor www.bioconductor.org and
used in an R command line workflow. The package can also be
accessed as an external tool in Skyline (Broudy et al., 2014) and
used via graphical user interface.

Contact: ovitek@purdue.edu

Received on September 21, 2013; revised on March 29, 2014;
accepted on April 28, 2014

1 INTRODUCTION

Quantitative mass spectrometry-based proteomics is a technol-
ogy of growing importance in biological and clinical research.
Modern proteomic workﬂows are complex and diverse, and a
statistical approach is required to reduce bias and inefficiencies,
distinguish the systematic variation from random artifacts and
maximize the reproducibility of the results (Kall and Vitek,
2011). Although some of these goals can be achieved with stand-
ard statistical methods, or with methods developed for other
technologies such as gene expression microarrays, this is typically
insufﬁcient. Specialized methods and software are needed to
characterize the stochastic properties of the data in a way that
reﬂects the details of sample preparation and spectral acquisi-
tion, and to implement the statistical analysis workﬂows in a way
that is useful for both experimentalists and statisticians.
MSstats is an open-source R-based package that provides such
statistical functionalities for relative quantiﬁcation of proteins
and peptides using a ﬂexible family of linear mixed models.
For some special cases, the methods and the implementation

 

*To whom correspondence should be addressed.

were previously described (Chang et al., 2012; Clough et al.,
2012; Surinova et al., 2013). Here we present MSstats 2.0, a
package that integrates the methodology across several mass
spectrometric workﬂows and data acquisition strategies, contains
new functionalities for model-based analyses, provides example
datasets, enables interoperability with the existing popular com-
putational tools and facilitates their use by both statistical and
proteomic communities.

2 DESCRIPTION

2.1 Applicability

MSstats 2.0 is applicable to multiple types of sample prepar-
ation, including label-free workﬂows, workﬂows that use stable
isotope-labeled reference proteins and peptides and workﬂows
that use fractionation. It is applicable to liquid chromatography
coupled with mass spectrometry (LC-MS) in data-dependent
acquisition (DDA, or shotgun) mode, targeted selected reaction
monitoring (SRM) and data-independent acquisition (DIA, or
Sequential Windowed data independent Acquisition of the Total
High-resolution Mass Spectra (SWATH—MS)). It is applicable to
experiments that make arbitrary complex comparisons of experi-
mental conditions or times.

2.2 Statistical functionalities

MSstats 2.0 takes as input identified and quantiﬁed spectral
peaks from multiple mass spectrometry runs and performs
three analysis steps. The ﬁrst step, data processing and visualiza-
tion, transforms and normalizes the intensities of the peaks. It
then generates workﬂow—speciﬁc and customizable numeric sum-
maries and plots such as in Figure 1 for data Visualization and
quality control.

The second step, statistical modeling and inference, relies on the
1m and lmer functionalities in R but customizes the model to the
speciﬁc experiment and to each protein. The implementation
automatically detects the experimental design (e.g. group com-
parison or time course, presence of labeled reference peptides or
proteins) from the data. It then reﬂects the experimental design,
the type of spectral acquisition strategy and the scope of conclu-
sions (e. g. restricted to the subjects or expanded to the underlying
populations) and ﬁts an appropriate linear-mixed model.

 

2524 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sotwuiJOJutotq/ﬁduq 11101} papeorumoq

9103 ‘Og isnﬁnV 110 ::

MSstats

 

 

 

 

 

   

 

 

 

 

 

(a) F':'l-')QI9"I';:.-.3  Itele'ellu: E":l'JI_Je:'-r.'u3 (c) E‘ﬂ-J[_10"f::.-R
20 2D
3,} C1 92 ‘33 C4 C5 0‘5 12345678910 12345373910 Strep0% Strep-10%
..uo°ww°'°u-“o-“v°°='°o“w
E 25' E 15 m, E
.5  Myumm- -. o - 06900”. .5
0:.) 5 M" "3 a- ' — E
.3 2,. r: W‘s?" 3* E
I
a, 3. a,
10
3 3 3
15‘
10' 5 5
i 2 5 4'1 5 S i 2'3 9 1'01'1121‘31'41'51I51'71'8 3 E 31'21'5132'12'4273'0 j 6 éI'21'51'32'12'42'mb i 2 i 5

MS runs

MS runs

MS runs

Fig. 1. Visualization of one representative protein in a DDA, an SRM and a DIA experiment. Colors and shapes represent peptides, and multiple
line types of a same color and shape represent the fragments of the peptide. Vertical lines separate times or conditions. (31) Protein alcohol dehydrogenase-
yeast spiked into a complex background in six concentrations. (b) Protein ACHl, at 10 times points after a stress. (c) Protein FabG of Streptococcus,

with 0 and 10% human plasma added

As an example, Figure 1 shows representative proﬁle plots for
one protein in experiments from three spectral acquisition stra-
tegies. Spectral features in label-free DDA experiments are pep-
tides; they have a relatively large variation and many missing
values. Spectral features in label-based experiments are grouped
into endogenous and reference measurements. Spectral features
in SRM and DIA experiments are fragments, grouped into pep-
tides. SRM experiments often present few missing values. DIA
experiments have the largest number of spectral features, which
differ in quality and variation. MSstats 2.0 takes all these differ-
ences into account. The users have choices of Viewing the be-
tween-feature interferences as systematic deviations or a random
noise, specifying constant or feature-specific variation, and
imputing the missing values or filtering out poor quality features.
MSstats 2.0 contains tools for model-based diagnostics to help
specify the appropriate model.

The model is used to detect differentially abundant proteins or
peptides, or to summarize the protein or peptide abundance in a
single biological replicate or condition (that can be used, e.g. as
input to clustering or classiﬁcation). MSstats 2.0 automatically
calculates the necessary linear combinations of model terms, and
produces model-based summaries for each experimental work-
ﬂow (e.g. estimates of abundance in each subject or condition,
log-fold changes between the compared conditions, the asso-
ciated estimates of variation and the degrees of freedom).

The third step, statistical experimental design, Views the dataset
being analyzed as a pilot study, uses its variance components and
calculates the minimal number of replicates necessary to achieve
a pre-speciﬁed statistical power.

2.3 Interoperability with existing computational tools

MSstats 2.0 is designed as a link between researchers with and
without statistical background. Proteomic practitioners (the pri-
mary audience of the package) have a limited familiarity with R,
and in the past this has hindered a broad adoption of R-based
implementations. Now MSstats 2.0 is available as an external
tool within Skyline (Broudy et al., 2014), a popular Graphical
user interface (GUI) tool for quantitative proteomics with >1100

registered users. The external tool support within Skyline man-
ages MSstats installation, point-and-click execution, parameter
collection in Windows forms and output display. Skyline man-
ages the annotations of the experimental design and the process-
ing of raw data. It outputs a custom report that is fed as a single
stream input into MSstats. This design buffers proteomics users
from the details of the R implementation, while enabling rigor-
ous statistical modeling. MSstats 2.0 also benefits from inclusion
in Skyline community resources such as message boards, support
in tutorials and examples of publicly available datasets.

Alternatively, MSstats takes as input data in a tabular format,
produced by any spectral processing tool such as SuperHirn,
MaxQuant, Progenesis, MultiQuant, OpenMS or OpenSWATH.

For statistics experts, MSstats 2.0 satisﬁes the interoperability
requirements of Bioconductor and takes as input data in the
MSnSet format (Gatto and Lilley, 2012). The command line-
based workﬂow is partitioned into a series of independent
steps, which facilitate the development and testing of alternative
statistical approaches.

3 CONCLUSIONS

MSstats 2.0 enables both the generality and the ﬂexibility of the
statistical analysis of a number of quantitative proteomic work-
ﬂows. Its implementation as an external tool within Skyline
introduces rigorous statistical methodology to a broader prote-
omic community. Its Bioconductor implementation facilitates
the development of new statistical methodology, such as work
with additional novel data acquisition strategies and labeling

types.

Funding: The work was supported in part by the NSF CAREER
award 1054826 and the NSF SI2-SSE award 1047962 (to O.V).
The authors thank Hannes Rost from ETH Ziirich for
making available the S. Pyogenes dataset, supported by the
grant ETH-30 11-2.

Conflict of Interest: none declared.

 

2525

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} popcorn/neg

9103 ‘Og isnﬁnV 110 ::

NLChoietaL

 

REFERENCES

Broudy,D. et a]. (2014) A framework for installable external tools in Skyline.
Bioinformatics, 30, 252172523.

Chang,C. et a]. (2012) Protein signiﬁcance analysis in selected reaction monitoring
(SRM) measurements. Mol. Cell. Proteomics, ll, M111.014662.

Clough,T. et a]. (2012) Statistical protein quantiﬁcation and signiﬁcance analysis in
label—free LC—MS experiments with complex designs. BMC Bioinformatics, l3
(SuppL 16), S6.

Gatto,L. and Lilley,K.S. (2012) MSnBase—an R/Bioconductor package for isobaric
tagged mass spectrometry data visualization, processing and quantitation.
Bioinformatics, 28, 2887289.

Kall,L. and Vitek,O. (2011) Computational mass spectrometryibased proteomics.
PLoS Comput. Biol, 7, e1002277.

Surinova,S. et a]. (2013) Automated selected reaction monitoring data ana—
lysis workﬂow for large—scale targeted proteomic studies. Nat. Protoc., 8,
160271619.

 

2526

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”Zduq 111011 pap1201um0q

9103 ‘0g isnﬁnV uo ::

