Vol. 27 no. 15 2011, pages 2161-2162
APP N doi:10.1093/bioinformatics/btr343

 

Structural bioinformatics

Advance Access publication June 8, 2011

The LabelHash Server and Tools for substructure-based

functional annotation

Mark Mo||1’*, Drew H. Bryant1 and Lydia E. Kavraki1’2’3

1Department of Computer Science, Rice University, Houston, TX 77005, 2Graduate Program in Structural and
Computational Biology and Molecular Biophysics, Baylor College of Medicine, Houston, TX 77030 and 3Department

of Bioengineering, Rice University, Houston, TX 77005, USA

Associate Editor: Anna Tramontano

 

ABSTRACT

Summary: The LabelHash server and tools are designed for large-
scale substructure comparison. The main use is to predict the
function of unknown proteins. Given a set of (putative) functional
residues, LabelHash finds all occurrences of matching substructures
in the entire Protein Data Bank, along with a statistical significance
estimate and known functional annotations for each match. The
results can be downloaded for further analysis in any molecular
viewer. For Chimera, there is a plugin to facilitate this process.
Availability: The web site is free and open to all users with no login
requirements at http://labelhash.kavrakilab.org

Contact: mmoll@rice.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on March 1, 2011; revised on May 31, 2011; accepted on
June 1, 2011

1 INTRODUCTION

The function of many proteins is still poorly understood. For
proteins with low sequence identity to any other proteins, structural
comparison can be used to identify distant homologs. Both the
number and diversity of structures is rapidly increasing. This helps
make the results of a structural approach to functional annotation
more informative, but at the same time also computationally more
challenging. The function of a protein can often be characterized by a
structural motif : a representative substructure formed by functional
residues. The function of an unknown protein can therefore be
inferred from high similarity of a substructure in this protein to a
motif with known function. A variety of methods have been proposed
that compute matches to a motif in a collection of structures, some of
which are also accessible through a web server or as downloadable
program (Kinjo and Nakamura, 2007; Kleywegt, 1999; Konc and
Janezic, 2010; Laskowski et al., 2005; Ren et (11., 2010; Stark and
Russell, 2003). They differ signiﬁcantly in one or more of the
following aspects: representation of a motif, matching algorithm,
statistical model and the set of targets a motif can be matched
against. The underlying algorithm for the LabelHash web server
makes it possible to match motifs against the entire Protein Databank
with minimal restrictions and still obtain results within a matter of
minutes.

 

*To whom correspondence should be addressed.

2 METHODS

The LabelHash algorithm (Moll at al.. 2010) consists of two stages: a
preprocessing stage and a matching stage. During the preprocessing stage.
the algorithm builds up lookup tables for n-tuples of residues that occur in
a set of target structures. These n-tuples are indexed by their residue labels.
For a given n-tuple of residues. we can instantly ﬁnd all occurrences in all
targets. The n-tuples are subject to mild geometric constraints that guarantee
spatial coherence and proximity to the molecular surface. The preprocessing
stage needs to be executed only once for a given set of target structures.

During the matching stage. the algorithm ﬁrst looks for partial matches of
size n and incrementally expands these partial matches to complete matches
in a depth-ﬁrst fashion. The motif information required by LabelHash is
very simple. Motifs consist of the Ca positions of the functionally important
(possibly non-sequential) residues. labeled with the admissible residue types.
There is no need for importance ranking of motif residues. To determine the
statistical signiﬁcance of a match. we use a non-parametric model based
on the LRMSD’S of all matches that were found (Fofanov et al.. 2008).
This model corrects for systematic algorithmic bias. We have shown that
LabelHash can achieve extremely high speciﬁcity with high sensitivity on a
benchmark set of motifs for 20 different Enzyme Commission classes (M011
and Kavraki. 2008). On average. we obtained a sensitivity of 86% and a
speciﬁcity of 99.94% at a P-value of 0.001 for these motifs.

By default. the LabelHash algorithm returns only the best complete match
for each target. but it can optionally also compute partial matches (of a given
minimum size) and multiple matches per protein. With these features. the user
can ﬁlter and postprocess the matches in variety of ways. e. g. by employing
a different selection mechanism for the ‘best’ match per target.

3 THE LABELHASH WEB SERVER AND TOOLS

The LabelHash server provides an easy-to-use front-end to our
implementation of the LabelHash algorithm. The server uses a
LabelHash table that contains all the indexing information for the ﬁill
Protein Data Bank (PDB). Each PDB entry often has more than one
chain. Each chain is inserted as a separate target in the LabelHash
table. This results in more than 180 000 target structures. The user
can specify a motif by ﬁlling out a web form that asks for a PDB
ID, a chain ID and a number of residue sequence numbers. For each
residue, the user can specify allowed substitutions. It is also possible
to upload an arbitrary PDB ﬁle and use that to deﬁne a motif. The
motif can be matched against either the PDB, the non-redundant
PDB (at different sequence identity levels), or a single target. Upon
submission of the motif, a job will be submitted to a scheduler, and
the user is presented with a URL of the page where the match results
will appear, typically, after a few minutes. If a user ﬁlled out an email
address on the main page, an email will be sent when the results are
ready.

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2161

112 /3.Io's[Burno[pJOJXO'souBHJJOJutotqH:duq moi; papeolumoq

91oz ‘Og anﬁnv uo ::

M.MoII et al.

 

{a} I I O “cum-uh Suva!
a . + Twainmmumnkawaisiunun.-nqnm_mm.-.m~w 1:11“

Top 20 matches

 

Foroaul match)!” an cllclt onlhe '1DdD]' Ilnkmmnloaua PDBIIIe mm In Mmﬂﬂu chain mv‘w Mlhim marl. I

1‘. leA was}

lﬁMmeBGBﬁGD'ruis

ﬂ-ﬂla: ODN‘H‘IW‘IGGZZH

mtg WOVSI‘IISVNSBT 'I'FPEB? TYRSBQUSQQ
ASPSB?

EC clam "13.39

Gowns:

mun mm: enzyme hinting. Wain mafia“
activity.ng binding. malal inn binning. animus:
activity. Calmnmlin hinting. mu inn finding. nilnc-um
Wm Mlll‘ll‘f. NADP or MDPH mum. FAD niran rim
Dividing. FMN balding. eiacimri camracﬁwtv. cadmium im
Dunning. amino acid imam;

Eulugiml plums: aging. mgulalim ulhaarl nmbxlm.
warms. to heat. was in organ"; NEW". response In
mama cyclic substance. mamas io \‘ﬂEMII’I E. mamas in
estrogen stimulus. was to ethanol. rewrite regulation at
Hood museum. negative iegulau'nn of ham chi-aniun. positive
mglllbond uaodilalinllmngaliw mgulaﬁoﬂd insulin
sacmlm. WWW" oi sensory WICle oi Dan-i. m
inch-man. llill‘c urine Daemmetic D'Dceaa. arainirie catamllc
mesa. Waste hypoxia

candy mmpun-ic: nucleus. cytuﬂalnlm'llnchmdiial nun..-
mwbana.c)'lusd.mdiila.liuclsal membana. animal“
ENNIS. GBMMIC IDI'Ie. WNW. CU WOUND“. “WHEN,
um momma. mihacmmion. Wemma. Dominant
mgim www.mcm internment

 

2. mam

mum: 6201589077711
punt-I: 00001292523059

 

,. . . .. . _

Quumwaﬂmmmﬁgmma
: . I . 3E .

mu m! mhﬂl‘h-l EC Bum-Immin-
m mmmmmm

mia Moises“ Iismsamsat‘“saamsmmsnr‘3“ 1.141190an canard am
OMIHMI

m Momma inf-“anamaeewaermarlmnrs‘” mumsmnq m m
OWNED?”

my} 591023613 iwﬁaaa'mm""'3so'“'mmm“" LPNMM m cum:
anaemia:

man woman WstWmmma-Usaaw 1.11.13.9nmn am am
ammo!

Fig. 1. (a) The main results page showing each matching substructure (in
green) superimposed with a motif (in white). The rest of the matching
structure is shown in ribbon representation. For each match, we also include
known annotations. (b) The table View of results. The ﬁrst two columns
contain links to the PDBsum entry and the aligned structure in PDB format.
The Gene Ontology terms in the last three columns can be expanded
individually or all simultaneously per category.

The match results are made available in different formats so as
to accommodate several different workﬂows. The main results page
shows the top 20 matches rendered in alignment with the motif
in individual images. For each match, the corresponding Enzyme
Commission classiﬁcation and Gene Ontology terms are shown,
when they are available (Fig. la). On a second results page, a more
compact table view of the top 100 matches with known annotations is
shown (Fig. 1b). From both pages, the user can download individual
PDB ﬁles of the aligned structures or an archive with PDB ﬁles of
the top 100 aligned structures. This is intended for users who want
to ﬁirther analyze the results in any molecular viewer. Finally, the
user can also download an XML ﬁle with all matches. This ﬁle can
be viewed as plain text, but one can also open this ﬁle in Chimera,
a molecular modeling program, using a plugin we developed called
ViewMatch. This plugin allows the user to quickly scroll through the
matches, see their annotations and ﬁlter them by different attributes.

Although the LabelHash web server is very easy to use, it offers
very little ﬂexibility in how the matching is performed. For more
advanced users we have created a set of command line tools that
allow for more extensive experimentation. First, the user can create
LabelHash tables for arbitrary sets of PDB ﬁles. Second, all the
parameters to the algorithm can be set by the user. In particular, one
can choose to enable partial matches or multiple matches per protein.
The tools include a Python module. This, combined with a simple
XML input/output format, facilitates pre- and postprocessing.

The LabelHash algorithm enables applications that beneﬁt from
structural analysis and go beyond what was described in the
introduction. For example, we were able to identify subtle patterns of
substructural variation in large protein (super)farnilies that correlate
with, e.g. phylogenetic distance, conformational rearrangement
upon binding or homology (Bryant et al., 2010).

ACKNOWLEDGEMENTS

The authors thank Dr. Paul Finn for many suggestions to improve the
usability of the site. Molecular graphics images were produced using
the UCSF Chimera package from the Resource for Biocomputing,
Visualization, and Informatics at the University of California, San
Francisco supported by NIH (P41 RR-01081) (Pettersen et al.,
2004).

Funding: National Science Foundation (DBI-0960612, GRFP
DGE-0237081 to D.H.B.); John and Ann Doerr Fund for
Computational Biomedicine at Rice University; Texas Higher
Education Coordinating Board (NHARP 01907); Sloan Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Bryant,D.H. et al. (2010) Analysis of substructural variation in families of enzymatic
proteins with applications to protein function prediction. BMC Bioinformatics, 11,
242.

Fofanov,V.Y. et al. (2008) A statistical model to correct systematic bias introduced
by algorithmic thresholds in protein structural comparison algorithms. In IEEE
International Conference on Bioinformatics and Biomedicine Workshops (BIBM W),
IEEE, pp. 178.

Kinjo,A.R. and Nakamura,H. (2007) Similarity search for local protein structures at
atomic resolution by exploiting a database management system. Biophysics, 3,
75784.

Kleywegt,GJ. (1999) Recognition of spatial motifs in protein structures. J. Mol. Biol.,
285, 188771897.

Konc,J. and Janezic,D. (2010) ProBiS: a web server for detection of structurally similar
protein binding sites. Nucleic Acids Res., 38, W43&W440.

Laskowski,R.A. et al. (2005) ProFunc: a server for predicting protein function from
3D structure. Nucleic Acids Res., 33, W897W93.

Moll,M. and Kavraki,L.E. (2008) Matching of structural motifs using hashing on residue
labels and geometric ﬁltering for protein function prediction. In The Seventh Annual
International Conference on Computational Systems Bioinformatics (CSBZOO8),
World Scientiﬁc Publishing Co., pp. 1574168.

Moll,M. et al. (2010) The LabelHash algorithm for substructure matching. BMC
Bioinformatics, 11, 555.

Pettersen,E.F. et al. (2004) UCSF Chimeraia visualization system for exploratory
research and analysis. J. Comput. Chem, 25, 160541612.

Ren,J. et al. (2010) SMAP-WS: a parallel web service for structural proteome-wide
ligand-binding site comparison. Nucleic Acids Res., 38, W4414W444.

Stark,A. and Russell,R.B. (2003) Annotation in three dimensions. PINTS: patterns in
non-homologous tertiary structures. Nucleic Acids Res., 31, 334143344.

 

2162

112 /3.Io's[Burno[p.IOJxosoueurrowtotq”:duq wort popeolumoq

9103 ‘Og isnﬁnv uo ::

