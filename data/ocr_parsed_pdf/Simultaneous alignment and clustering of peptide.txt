ORIGINAL PAPER

Vol. 29 no. 1 2013, pages 8—14
doi: 10. 1 093/bioinformatics/bt5621

 

Sequence analysis

Advance Access publication October 24, 2012

Simultaneous alignment and clustering of peptide data

using a Gibbs sampling approach

Massimo Andreatta1 '*, Ole Lund1 and Morten Nielsen“2

1Center for Biological Sequence Analysis, Technical University of Denmark, DK-2800 Lyngby, Denmark and 2Instituto de
Investigaciones Biotecnolégicas, Universidad de San Martin, CP 1650 San Martin, Buenos Aires, Argentina

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: Proteins recognizing short peptide fragments play a cen-
tral role in cellular signaling. As a result of high-throughput technolo-
gies, peptide-binding protein specificities can be studied using large
peptide libraries at dramatically lower cost and time. Interpretation of
such large peptide datasets, however, is a complex task, especially
when the data contain multiple receptor binding motifs, and/or the
motifs are found at different locations within distinct peptides.
Results: The algorithm presented in this article, based on Gibbs sam-
pling, identifies multiple specificities in peptide data by performing two
essential tasks simultaneously: alignment and clustering of peptide
data. We apply the method to de-convolute binding motifs in a
panel of peptide datasets with different degrees of complexity span-
ning from the simplest case of pre—aligned fixed-length peptides to
cases of unaligned peptide datasets of variable length. Example ap-
plications described in this article include mixtures of binders to dif-
ferent MHC class I and class II alleles, distinct classes of ligands for
SH3 domains and sub-specificities of the HLA—A*02:01 molecule.
Availability: The Gibbs clustering method is available online as a web
sen/er at http://www.cbs.dtu.dk/services/GibbsCluster.

Contact: massimo@cbs.dtu.dk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 19, 2012; revised on October 5, 2012; accepted on
October 14, 2012

1 INTRODUCTION

Peptides are short amino acid sequences occurring ubiquitously
in biological processes, such as metabolism, signal transduction
and immune response. They are also extensively used in research
to mimic functional or (linear) structural aspects of proteins and
protein interactions. The advantage of using peptides lies in the
relative ease in generating large libraries of sequences, such as in
phage display technologies (Koivunen et al., 1999; Bratkovic,
2010). More recently, developments in high-throughput peptide
microarrays have allowed producing large-scale datasets of
peptide-ligand interactions and have been applied to various
problems including antibodyiantigen interactions, peptide-
MHC binding, kinase binding motifs and other receptor-ligand
interactions (Soen et al., 2003; Schutkowski, 2005;
Uttamchandani and Yao, 2008; Halperin et al., 2011).

 

*To whom correspondence should be addressed.

Identifying receptor-ligand binding motifs within peptide data-
sets is a highly challenging task for at least two major reasons,
which we term alignment and poly-specificity. The alignment
problem arises because most receptor motifs are weak and
short, making identiﬁcation of the binding register within the
ligands not trivial (Nielsen et al., 2004). The poly-speciﬁcity
problem arises because receptor-ligand datasets often contain
multiple motifs either owing to the experimental setup or to
the actual poly-speciﬁcity of the receptor (Gfeller, 2012).
Several bioinformatics methods have been developed attempting
to deal with these challenges and detect subtle sequence signals in
peptide datasets, including motif alignment (Bailey et al., 2006),
Gibbs sampling (Lawrence et al., 1993), Hidden Markov Models
(Noguchi et al., 2002) and artiﬁcial neural networks (Nielsen and
Lund, 2009). In particular, artiﬁcial neural networks have shown
a high performance on this kind of data (Wang et al., 2010;
Andreatta et al., 2011). Signiﬁcant correlations between residues
have been found in peptide interaction domains (Gfeller et al.,
2011). Although positional correlations can be accurately cap-
tured by artiﬁcial neural networks, the speciﬁcities of such do-
mains can, in many cases, more intuitively be represented by
multiple position-speciﬁc scoring matrices (PSSM) (Bailey and
Elkan, 1995; Gfeller et al., 2011; Kim et al., 2012). Multiple
PSSMs allow Visualizing poly-specificities as sequence logos of
the different binding modes.

Although the above methods attempt to deal with the chal-
lenges involved in motif identiﬁcation in peptide datasets, they all
suffer from the limitations of only dealing with single specificities
or requiring the input data to be pre-aligned to a common motif.
In this article, we describe a novel approach for effective align-
ment and clustering of peptide data going beyond these limita-
tions. In the Gibbs clustering method, alignment and speciﬁcity
clustering are performed simultaneously by sampling the space of
possible solutions using a Gibbs sampling strategy. Each cluster
is represented by a PSSM, and the method aims at maximizing
the information content of individual matrices while minimizing
the overlap between distinct clusters.

2 METHODS

The Gibbs clustering algorithm attempts to group the input peptide data
into a number of clusters and for each cluster identify the optimal local
sequence alignment based on the optimization of the ﬁtness of the system
in terms of KullbackiLeibler distance (KLD) sum of the alignments. The
KLD allows measuring the information gain of an observed amino acid
distribution compared with a background distribution (the frequency of

 

8 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sotJBuiJOJurotq/ﬁduq 11101} papaolumoq

91oz ‘Og isnﬁnv uo ::

Simultaneous alignment and clustering of peptide data

 

each amino acid in random protein sequences). A given alignment can be
represented by a log-odds (LO) weight matrix, which summarizes the
amino acid preferences for each column of the alignment. Throughout
the article, we graphically represent LO matrices using the sequence logo
visualization tool Seq2Logo (Thomsen and Nielsen, 2012).

2.1 Log-odds matrices

An LO weight matrix is calculated as log(pA',~/qA), where ij is the fre-
quency of amino acid A at position j, and (1A is the background frequency
of A. These frequencies are calculated as described in Nielsen et al., 2004,
including heuristic sequence weighting and pseudo-count correction. To
avoid the creation of small highly specialized clusters, we introduce an
additional term to the LO matrix calculation to account for the size of the
alignment. In our scheme, terms in the PSSM are calculated using:

 

log’ﬂ (1)

L0 -=
A” n+0 qA

where n is the number of peptides in the alignment, 0 is a weight on small
clusters, and [7:4,]. is the pseudo-count corrected frequency. The function
of a is to ﬂatten the LO matrix when the alignment is composed of few
sequences (n small), but its effect is minor when the matrix is constructed
on many data points (n large). Practically, it avoids the creation of small
and specialized alignments, favouring instead larger and more general
ones.

A peptide x can be scored simply by adding the LO values for the
amino acid found at each position in x:

S = Z Lo’AJ (2)
1'

where j is the index over the positions in the alignment core, and A is the
amino acid found at position j in x. However, when evaluating the ﬁtness
of a given sequence x in an alignment (where x is part of the alignment),
we must take the precaution of excluding x from the matrix calculation
before doing the evaluation. We call LO’A,j the LO matrix made without
sequence x.

2.2 Scoring function

In the general case, a Gibbs clustering solution is composed of g clusters,
each with a corresponding alignment and LO matrix. When evaluating a
clustering solution, we aim to maximize the intra-cluster ﬁtness of the
alignment while minimizing the similarity between different clusters. In
other words, the distance between points in the same cluster should be as
small as possible, whereas the distance between points in different groups
should be maximal. In the Gibbs clustering algorithm, we implement this
maximization using the relationship:
S? = S,- — A max(S,,,0) (3)
195g
n¢i

where S,- is the score of a given peptide to the LO matrix LO’A,j of cluster
1'. Note that, as discussed above, the LO matrix of group i is calculated
excluding the peptide to be scored. The max() part of the equation de-
termines the inter-cluster similarity, i.e. which cluster is the closest to
cluster 1'. If we imagine to have, besides the g clusters given by the
data, and additional cluster composed of the universe of natural peptides,
the amino acid frequencies [7:4,]. in this extra group would be equal to the
background frequencies (1,, for any amino acid A. Thus log(qA/qA) = 0 in
Equation 1, leading to a LOAJ matrix composed of zeros, which gives
scores S 36 = 0 for all sequences. This justiﬁes the zero in Equation 3, and
provides a generalization for the case where there is only one cluster, with
S? 2 S,.

The parameter A modulates the weight of inter-cluster similarity on the
ﬁnal sequence score. For A = 0 overlap between clusters is not penalized,
leading to tight but promiscuous clusters. Large A values put emphasis on

inter-cluster similarity, at the expense of consistency within the same
group.

Equation 3 defines the energy function of a single sequence in the
alignment. The overall score of the alignment/clustering is given by the
average score of all sequences in the dataset. The fitness of the system can
be thought of as the relative entropy or KLD from the background model
made on random peptides.

2.3 Moves of the algorithm

Initially, peptides are distributed randomly in g clusters. Then the algo-
rithm proceeds with a number of ‘moves’ to align and cluster the se-
quences and optimize the KLD of the alignment/clustering. The
probability of accepting a move is given by:

P = min [1, edE/T] (4)

where dE is the energy change as a result of the move, and T is a scalar
commonly known as the temperature of the system, lowered by discrete
steps during the iterations.

The algorithm consists of three different moves: (i) Single sequence
move: in this move, we attempt to transfer a peptide x from one group
G; to a destination group Gd chosen at random. The score 5; of x in its
original cluster is calculated using Equation 3, selecting the core register
that gives the highest score. In the same way, S: is obtained for the
destination group. The move is then accepted or rejected following
Equation 4, where dE: 5375:. (ii) Simple shift: this move attempts to
move a peptide x within a group, by applying a random shift to the
alignment core of x. The score of x is calculated before and after the
shift, and the dE between the two configurations determines whether the
move is accepted or rejected according to Equation 4. (iii) Phase shift: the
entire alignment of a group G, is shifted a random number of positions to
the left or to the right. This move may be important if the alignment
reaches a local minimum where the sequences are optimally aligned to
each other, but the core window is not centered on the most informative
motif. As in the other moves, the conﬁgurations before and after the
move are compared to calculate whether the move is favourable or un-
favourable, and accepted/rejected following Equation 4.

The ‘simple shift’ and ‘phase shift’ moves have been described before
for multiple sequence alignment (Lawrence et al., 1993; Nielsen et al.,
2004). The new feature of the Gibbs clustering method is the additional
‘single sequence’ move, which allows transferring sequences between dif-
ferent clusters. The three moves are generally performed with different
frequency. The simple shift move, with the lowest impact among the three
moves, is attempted at each iteration. Single sequence moves are per-
formed every F, iterations. Phase shifts, which affect at the same time
all peptides in a given clusters, would generally be the least frequent and
occur every E, iterations, with F,>F,> 1. Throughout the article, these
parameters are ﬁxed to F, = 10 and E, = 1000. The default cooling sched-
ule uses 20 linear temperature steps starting from an initial Tof 0.8 down
to 10’5.

2.4 Trash cluster to collect spurious sequences

The algorithm allows including an additional cluster, called trash cluster,
to collect the peptides that appear not to match any of the motifs being
identiﬁed. The behaviour of the trash-cluster is identical to any of the
other clusters, with the difference that the sequences in the trash cluster
do not contribute to the overall score of the system. The trash cluster can
be thought of as the universe of all natural peptides (i.e. the background
model), and peptides can be moved in and out from the trash cluster with
probability deﬁned by the Monte Carlo relationship (Equation 4), where
the score to the trash clusters is always equal to the background baseline
(zero by default, but can be set to different values to adjust the levels of
sensitivity and speciﬁcity).

 

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papeolumoq

91oz ‘Og isanV uo ::

M.Andreatta et al.

 

2.5 Measures of clustering quality

As a measure of clustering quality, we used the Adjusted Rand Index
(ARI). This measure is based on the well-known Rand index (Rand,
1971), but corrected for chance and class size. We implemented the
ARI corrected for chance as in Hubert and Arabie, 1985. As a term of
comparison, we also used a modiﬁed version of the Matthews correlation
coefﬁcient (MCC) extended to more than the conventional two classes
(positives and negatives). In the general case where A-mixed speciﬁcities
are grouped in C clusters, a MCC is initially calculated for each cluster.
The true positives for group C,- are given by the class A,- with highest
number of sequences in C,, the false positives by the number of sequences
in C,- not belonging to A,-, the false negatives by the number of sequences
labelled A,- not found in C,- and the true negatives are all the remaining
sequences. The MCC for the entire matrix is then calculated as the aver-
age MCC of each cluster. The notation for ARI and MCC calculation is
also illustrated in Supplementary Table S1.

2.6 Training from multiple initial seeds

Gibbs sampling is a heuristic rather than a rigorous optimization proced-
ure. Therefore, it cannot guarantee that the most optimal solution is
always reached from any starting conﬁguration. A common procedure
to boost performance is to repeat the sampling from a number of initial
random conﬁgurations and select the solution that appears to be optimal
in terms of the fitness function that governs the system. Clearly, this is a
sound procedure only if optimal ﬁtness (KLD) corresponds to optimal
clustering of the data. We investigated the correlation between ﬁtness and
quality of the clustering on Major Histooompatibility Complex (MHC)
class I datasets containing different number of speciﬁcities. Binders to
different alleles were combined to obtain mixtures of S to 8 alleles, and
then the Gibbs clustering algorithm was used to recover the distinct
motifs. For each allele combination, we ran the algorithm from 40
random initial conﬁgurations, measuring for each the ﬁtness in terms
of KLD and the clustering quality in terms of ARI.

In general, we observe that both KLD and ARI tend to decrease as the
number of alleles in the mixture increases (Supplementary Fig. S1). Yet,
in the case of MHC class I where motifs are very strong and distinct from
each other, it is possible to reconstruct with high accuracy even up to 8
different speciﬁcities. The same considerations can be made if we measure
clustering quality in terms of MCC instead of ARI, which correlates in
very similar fashion to KLD (Supplementary Fig. S2). These results show
that, only based on the KLD, it is possible to ﬁlter out sub-optimal
solutions. By running the algorithm from different starting conditions,
and selecting solutions with high KLD, the method achieves a higher
classiﬁcation performance. Multiple seeding and automatic selection of
the optimal solution are integrated in the Gibbs clustering algorithm.

3 RESULTS

The Gibbs clustering algorithm performs two essential tasks
simultaneously: alignment and clustering of peptide data. Here,
we use the method to de-convolute binding motifs in a panel of
different peptide datasets with different degrees of complexity
spanning from the simplest case of pre-aligned ﬁxed-length pep-
tides to cases of unaligned peptide datasets of variable length.
More details about the datasets are given as Supplementary
Material.

3.1 Pre-aligned data—Mixtures of binders to MHC
class I alleles

To benchmark the clustering aspect of the Gibbs algorithm,
we used a set of pre-aligned ﬁxed-length peptides with

 

 

 

 

 

 

 

   

 

 

 

Lambda = 0.0 Lambda = 0.3
s n | n B
7 mm 7
a --'_ -4 B
E r:  t E s
g 4 - E a
3 3
2 2
1 I 1
= | | | | = | | | | =
— (\i (‘7! V L1 3 h on ca (3 : LU
Optimal number of clusters
Lambda=o.5
s - n B
7 7
6 6
E 5 E 5
m (D
i '1 3 4
3 3
2 2
1 1
. | | | | I | | | | | | | | | | | |
u N N V L'} D I‘M ea 0! : N *e N (O V “T! (D l“- WI 0! C:

| |
E’ 9 3
Optimal number of clusters Optima: number or clusters

Fig. 1. Box-and-whisker plot showing the optimal number of clusters on
mixtures of different MHC class I alleles. The algorithm was run on 10
different random combinations of n alleles, where n = {1 . . .8}, starting
with c = {1 . . . 12} clusters for each combination. The optimal number of
clusters of each of the 10 combinations is the c with highest KLD of the
system. The four panels show the predicted number of clusters for four
different values of A for a ﬁxed value of a: 10. With A = 0.5, the correl-
ation between number of alleles in the dataset and predicted number of
clusters falls approximately on a straight line with slope = 1

experimentally conﬁrmed binding to representatives of the
12 MHC class I supertypes (see Supplementary Material).
These 12MHC molecules all have highly speciﬁc binding
motifs with limited mutual overlap (Lund et al., 2004). For
each number of alleles n={1,2,...,8}, 10 different combin-
ations of n alleles were constructed randomly from the pool of
the 12 MHC molecules. For each dataset, the algorithm was used
to cluster the peptides into c: {1,2, . . . , 12} groups, and the c
with optimal KLD score was recorded. Figure 1 shows the re-
sults of this calculation. For A=0.5, the number of predicted
motifs correlates well with the actual number of alleles in the
dataset. With smaller values of A, the method tends to
over-estimate the number of motifs, whereas for larger A clusters
with shared similarities, they are more heavily penalized and are
merged into fewer clusters. The predictions are most consistent
(lowest variations in the optimal number of clusters) on mixtures
of few alleles. This is a natural consequence of both the increased
complexity of the search space, as the number of alleles is
increased and the promiscuity of MHC binding peptides.
Although the 12 MHC class I molecules share very limited over-
lap in speciﬁcity, a larger collection of alleles increases inevitably
the chance of including cross-binding peptides the dataset.

3.2 Unaligned data—Mixtures of binders to MHC
class II alleles

To demonstrate the performance of the Gibbs clustering method
on datasets of unaligned peptides of variable length, we turned to
the MHC class II system. As opposed to MHC class I molecules,
which in the vast majority of cases interact only with peptides of
length between 8 and 10 amino acids, MHC class II molecules

 

10

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papBOIH/noq

91oz ‘Og isnﬁnv uo ::

Simultaneous alignment and clustering of peptide data

 

can bind peptides of highly variable length (Rammensee et al.,
1999). Binding of a peptide to a MHC class II molecule is pri-
marily determined by a core of 9 amino acids, but the location of
the 9-mer core within the peptide is not known a priori.
Therefore, MHC class II binding data are by nature unaligned
with respect to the binding core.

The Gibbs clustering algorithm was applied to identify motifs
in a set of binders to the MHC class II HLA-DRB1*03:01 and
HLA-DRB1*04:01 molecules. Compared with MHC class I,
class II alleles share a high degree of overlap in their binding
speciﬁcities. This promiscuity between different MHC class II
molecules complicates the performance evaluation of the cluster-
ing algorithm, as a peptide may match the motif of multiple
alleles, in which case it is not clear in what cluster the sequence
should be rightfully placed. To lower this potential degree of
cross-binding, the dataset was constructed to include experimen-
tally conﬁrmed binders with weak predicted cross-binding poten-
tial (for details refer to Supplementary Material). We maintained
the same parameters used for the MHC class I benchmark,
except for A, which was increased to 0.8 to avoid the creation
of excessively small and specialized clusters (running the algo-
rithm with A=0.5 resulted, in particular, in the DRB1*03:01
peptides being sub-divided into several small and highly specia-
lized clusters). Additionally, as HLA-DR molecules are known
to prefer hydrophobic amino acids at position P1, we imposed a
preference for this kind of amino acids in the Gibbs sampling
moves as proposed by Nielsen et al., 2004. The algorithm was
run multiple times to create 174 clusters, each started from ﬁve
different random configurations. For each cluster size, the solu-
tion with the highest KLD score was recorded. The optimal so-
lution indicated the presence of two clusters (Supplementary
Fig. S3), and the corresponding motifs are shown in Figure 2.
The main distinctive feature in the logos of Figure 2 is the acidic
(D) anchor at position P4 and a basic (K/R) anchor at position 6
of the first motif, which are absent in the second logo. These
preferences characterize the binding motif of HLA-DRB1*03:01.
The classiﬁcation of the peptides in the two groups (Fig. 2c)
demonstrates that most peptides are clustered correctly, with
an accuracy of 79% and MCC of 0.59.

(a) In. Inll 

DRE 1 ‘ 03 :01
DRE 1 " 04 D1

 

,4
-..|
D
U1
LU

 

 

 

 

 

   

Fig. 2. Reconstructed binding motifs from a mixture of binders to 2
MHC class II alleles. The dataset was composed of 202 and 201 binders
to the molecules HLA-DRB1*03:01 and HLA-DRB1*04:01, respectively.
In (a) and (b) are shown the logos of the two motifs identiﬁed by the
algorithm, with the ﬁrst cluster predominantly composed of DRB1*03:01
binders and the second of DRB1*04:01 binders. (c) confusion matrix for
the two classes of binders, the correlation coefﬁcient is MCC = 0.59

3.3 Gibbs clustering as a tool to remove noise from data

In the previous examples, we assumed that all sequences fit into
one cluster or another. However, experimental data often con-
tains some level of noise, and hence peptides that may not ﬁt in
any of the motifs. The Gibbs clustering algorithm allows, by the
inclusion of a trash cluster, a very simple yet highly effective
manner to detect such spurious peptides and remove them
from the motif identiﬁcation (see Section 2 for the
implementation).

In Supplementary Table S2 is shown the effect of the trash
cluster on mixtures of 1, 2, 3 and 4MHC class I alleles polluted
with 50 random peptides. We observed that the majority of the
random peptides were placed into the trash cluster, but an aver-
age of ~5 peptides were assigned to one of the clusters. This fits
the overall expectation as 175% of random natural peptides are
estimated to bind to a given MHC class I molecules (Rao et al.,
2009; Yewdell and Bennink, 1999). Furthermore, most of the
random peptides that were inserted into one of the clusters had
consistently lower scores than the actual binders (Supplementary
Fig. S4). The Gibbs clustering algorithm allows obtaining differ-
ent levels of sensitivity and speciﬁcity by varying the threshold to
assign a peptide to the trash cluster. Increasing this threshold
would remove more noise (peptides with low cluster score)
from the dataset, but at the same time would increase the
number of binders placed in the trash. In the experiments with
noisy data (Supplementary Table S2), a few sequences measured
to be binders to a given allele are assigned to the trash (2 for the 1
clusters case, 2 for 2 clusters, 2 for 3 clusters, 4 for 4 clusters).
Interestingly, none of these peptides appear to match the binding
motifs of the alleles they were measured to bind to. Using the
state-of—the—art MHC class I binding prediction method
NetMHCcons (Karosiene et al., 2012), these peptides all show
extremely low predicted binding afﬁnity to their respective HLA
restriction element (>10 000 nM, see Table 1). Furthermore, an
experimental re-examination of three of these peptides conﬁrmed
that they are indeed non-binders to their respective HLA mol-
ecule (J. Sidney, personal communication). The method was thus
able, while grouping distinct speciﬁcities into different clusters, to
also identify false positives that most likely correspond to erro-
neous measurements in the experimental assay. Introducing the
trash bin for the MHC class II benchmark also led to an im-
proved clustering performance, removing two outlier peptides,
maintaining the optimal solution to consist of two clusters and
enhancing the performance to MCC = 0.62 (data not shown).

3.4 SH3 domains

The Src Homology 3 domain (SH3 domain) is a small protein
interaction module abundantly found in eukaryotes. SH3 do-
mains consist of ~60 amino acids and have been shown to me-
diate proteiniprotein interactions by preferentially binding to
short proline-rich sequences H u et al., 1994). The minimal con-
sensus sequence for SH3 domain binding is composed of two
prolines located two amino acids apart (PxxP), but it is com-
monly recognized that there exist two main classes of binders:
class I ligands having a general consensus sequence +x¢Px¢P
and class II ligands with consensus sequence
¢Px¢Px+ (where+is a positively charged amino acid, usually
R, q) is a hydrophobic amino acid, and x any amino acid)

 

11

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papBOIH/noq

91oz ‘Og isnﬁnv uo ::

M.Andreatta et al.

 

Table 1. Measured, predicted and re-tested binding afﬁnities (in nM) for
peptides assigned to the trash cluster

 

 

Peptide HLA IEDBa Predictedb Validatedc
DHHFTPQII A*Ol :01 62 28 485 24822
SQTSYQYLI B*07:02 248 24 349 49 928
NAFGWENAY B*07:02 350 24 481 7
TVFKGFVNK B*27:05 235 13 723 7
ELPIVTPAL B*40:01 314 15 208 7
ADKNLIKCS B*40:01 316 33 324 76190

 

As a rule of thumb, generally afﬁnity< 50nM identiﬁes a strong binder,
50 nM < afﬁnity< 500 nM a weak binder, afﬁnity> 500 nM non—binders.

“Binding afﬁnity deposited in the Immune Epitope Database.

bPredicted binding afﬁnities using NetMHCcons.

CRe—tested binding afﬁnities after detection as outliers.

(Mayer, 2001). However, there are a few exceptions to these
predominant motifs, and a number of non-consensus ligands
have been identiﬁed (reviewed in Carducci et al., 2012; Saksela
and Permi, 2012).

The Gibbs clustering algorithm was run on a large dataset of
2457 peptides binding to the Src SH3 domain. The peptides are
12 amino acids long and unaligned with respect to the binding
motif(s) to the SH3 domain. As the dataset may contain
non-consensus ligands and noise, we performed the alignment/
clustering with the addition of a trash cluster, which collects
peptides that do not match any of the main motifs. To ensure
the removal of non-consensus sequences that may only partially
match the major motifs, the baseline for the trash cluster was set
to a relatively high value of 10. The sequence motifs identiﬁed by
the Gibbs clustering are shown in Figure 3. Aligning all se-
quences into a single cluster (Fig. 3a) showed the characteristic
PxxP pattern, in this case preceded by a leucine (L) and arginine/
proline (R/P) three positions back. Clustering the peptides into
two groups revealed the two sequence motifs shown in Figure 3b.
They correspond very well to the two known classes of SH3
domain ligand, one with the Px¢PxRN pattern (class II) and
the other with pattern Rx¢Px¢P (class I). Dividing the dataset
further and creating 3 clusters led to the emergence of a new
subset of speciﬁcity (panel c) besides the two described in the
2-clusters case. Although several exceptions to the two main
classes have been discovered (Saksela and Permi, 2012), this
RxRP¢P pattern has not, to the best of our knowledge, been
described before. Splitting the dataset further to more than 3
clusters does not show new speciﬁcities besides those described
here.

The two motifs displayed in Figure 3b agree strongly with the
results obtained in a previous study (Kim et al., 2012), where the
MUSI method was applied to the same phage display dataset.
The Gibbs clustering method, however, has the strong advantage
compared with MUSI, in that the data do not need to be aligned
before clustering. Instead, in the Gibbs clustering method, align-
ment and clustering are performed simultaneously. In the speciﬁc
case of SH3 domain binding, where both motifs share a strong
common PxxP pattern, a pre-alignment strategy to a common
motif, like the one implemented in MUSI, can be successful.
However, in the general case, the different motifs will be weak

(a) (b)

1 cluster

 

 

 

2 clusters

 

 

Fig. 3. Sequence motifs on SH3 domain binding data clustered in 1 to 3
clusters. (21) Sequence motif of the dataset aligned in one single cluster.
The cluster contains 2360 peptides, 97 peptides were discarded to the
trash cluster. (b) Sequence motifs for SH3 domain data split in two clus-
ters. The two groups are in strong agreement with the canonical class I
(right, 1892 peptides) and class 11 (left, 498 peptides) types of SH3 domain
ligands. Sixty-seven peptides were moved to the trash cluster.
(c) Sequence motifs when the data is split in 3 clusters. The clusters
have sizes of 1606, 490 and 305 peptides, respectively, with 56 peptides
discarded to the trash cluster

and will not share a common pattern. On such data, it becomes
difficult if not impossible to accurately identify the binding core
within the peptide dataset using alignment techniques (Nielsen
et al., 2004). For instance, by applying the MUSI method on the
MHC class II dataset from above, we found the solution with
two motifs being sub-optimal compared with a solution with a
single motif. Forcing MUSI to generate two clusters, the overall
performance was MCC: 0.21, which is signiﬁcantly lower than
what was obtained using the Gibbs clustering method (P<0.01,
bootstrap test).

3.5 Sub-speciﬁcities of MHC class I molecules

Peptide binding to MHC molecules is one of the most selective
steps in determining MHC class I-restricted CTL responses. The
strength of this interaction is commonly measured in terms of
binding afﬁnity between peptide and MHC complex. However,
not all peptides with high afﬁnity are immunogenic, indicating
the presence of other factors determining an effective response
(Assarsson et al., 2007). Some studies have suggested that the
stability of the MHC-peptide complex is a major player in deter-
mining immunogenicity (Busch and Pamer, 1998; Geironson
et al., 2012; Hamdahl et al., 2012).

By means of the Gibbs clustering algorithm, we investigated
whether there exist sub-speciﬁcities for MHC class I binding and
whether these sub-speciﬁcities correlated with different levels of
afﬁnity and/or stability. For this purpose, we used a dataset re-
cently published by Hamdahl et al., 2012 consisting of 650 pep-
tides binding with afﬁnity stronger than 500 nM to
HLA-A*02:01 for which also the peptide stability had been mea-
sured. We applied the Gibbs clustering algorithm to split the

 

12

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papaommoq

91oz ‘Og isnﬁnv uo ::

Simultaneous alignment and clustering of peptide data

 

(a) Granule”  Gm3u:

 

 

Fig. 4. Sub-motifs of HLA-A*02:01 binding speciﬁcity. The peptides in
the two clusters have similar afﬁnity but differ signiﬁcantly in stability.
The sequence logo in the left panel is composed mainly of stable peptides
(Th8 5.7 h), whereas peptides in the second group have lower stability
(Th % 2. 1 h)

dataset in two clusters using default parameters and investigated
the properties of the sequences in the two groups.

The sequence motifs for the resulting clusters are shown in
Figure 4. The ﬁrst cluster (G1), composed of 441 sequences,
was highly speciﬁc in terms of amino acid preference, with
[LIM] at P2 and [VLI] at P9. The contribution from other pos-
itions is secondary. The second cluster (G2) is more promiscuous
at both anchor positions P2 and P9, especially at P2 where sev-
eral amino acids other than L, I and M are allowed. The peptides
in the two groups had a median binding affinity of 6nM and
9 nM, for G1 and G2, respectively. This difference is not signiﬁ-
cant (P: 0.095, Wilcoxon rank-sum test). In contrast, we
observed that peptides in G1 have a signiﬁcantly higher stability
compared with G2 (P< 10‘6, Wilcoxon rank-sum test): the
median half-life of the MHC-peptide complex in G1 is
Th8 5.7 h, whereas in G2, it is only Th B 2.1 h.

From these results, we can conclude that the method identiﬁed
subtle differences between the binders to HLA-A*02:01 that
appear to differentiate stable binders from unstable binders. In
particular, as previously noted peptide-HLA-A*02:01 complexes
appear to be destabilized by a sub-optimal amino acid in just one
of the two anchor positions and in particular position P2
(Harndahl et al., 2012).

4 DISCUSSION

We proposed an efﬁcient algorithm to identify multiple speciﬁ-
cities in peptide datasets. The applications of the method are
numerous, ranging from the deconvolution of poly-speciﬁcities
contained in a dataset, to the analysis of sub-specificities within a
known binding motif. The algorithm aims at identifying the so-
lution (the set of clusters and corresponding alignments) that
optimally ﬁts the peptide dataset. The optimal solution is auto-
matically selected and the identified binding motifs are Visualized
as individual sequence logos. Using a panel of benchmark data-
sets, we have demonstrated the power of the Gibbs clustering
method in deconvoluting poly-speciﬁcities contained both in
pre-aligned and unaligned peptide datasets covering the MHC
class I, MHC class II and human SH3 domain systems.

Gibbs sampling is a powerful approach to explore large spaces
of possible solutions. In the case of amino acid sequences, there
are immense possible ways of aligning and clustering them as
soon as the number of sequences becomes bigger than a handful.
The probabilistic nature of Gibbs sampling allows efﬁcient sam-
pling of the search space and convergence towards a state of high
ﬁtness of the system. Compared with other motif identiﬁcation
methods, Gibbs clustering is unique in that it incorporates align-
ment and clustering in a set of alternative sampling moves, allow-
ing for simultaneous identiﬁcation of clusters and optimal
sequence alignment. This property makes the method capable
of identifying subtle and relatively weak binding motifs (as
demonstrated for the case of MHC class II binding motifs),
but it comes at the price of computational speed. Analysing
the 400 peptides in the MHC class II binding dataset takes a
little >5 min using Gibbs clustering. This running time is reduced
to 15 s using the MUSI algorithm (Kim et al., 2012) yet at the
cost of a dramatic and signiﬁcant drop in accuracy.

In a general situation, it is not known a priori how many
motifs are contained in a dataset. When presented with a set of
experimental data, the investigator ideally wants a definitive
answer to the question: ‘How many motifs are contained in my
data?’ Unfortunately, the answer is not unambiguous, not so
much for a fault of mathematical and computational methods,
rather for the ambiguity of the question. The answer depends on
the level of resolution that is expected for the particular problem
at hand. If the goal is a rough classiﬁcation of sequences based
on global differences, then the resulting number of clusters will
be small. Conversely, more partitions would be produced if we
were searching for subtler distinguishing sequence characteristics.
The ‘true’ number of clusters is therefore not an objective answer
but depends on the kind of biological question that is being
asked. In the Gibbs clustering algorithm, we introduce a param-
eter A that aims to modulate the degree of resolution required by
the user. High A penalizes overlap between clusters and tends to
create coarser clusters, whereas low A results in smaller and spe-
cialized clusters. For example, we showed that for a certain value
of A, we could accurately identify the number of MHC class I
molecules contained in a dataset of mixed speciﬁcities. In another
example, we split one of these very same specificities into
sub-motifs and looked for subtle differences in a rather homo-
genous population of peptides. These are not the extremes: one
could conceive partitioning the data further into more specialized
sub-populations, as well as obtaining a coarser picture of simila-
rities between alleles. The same data may have different levels of
resolution depending on the aim of the analysis, and the inves-
tigator should keep this in mind when using a classiﬁcation
method like the one presented here. The Gibbs clustering
method in its current form is limited to handle situations
where motifs are of uniform length. Likewise, the method can
only handle amino acid input data. The reason for this limitation
is that most of its unique features like pseudo-count estimates
from Blosum substitution matrices and sequence weighting of are
speciﬁc for amino acid data.

In conclusion, we believe the Gibbs clustering method to be
both a highly accurate and very user-friendly tool that will allow
researchers to interpret peptide datasets in terms of receptor
speciﬁcities in a highly intuitive manner. Therefore, we expect
it to become an important tool as large-scale peptide chip

 

13

112 /310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papaommoq

91oz ‘Og isnﬁnv uo ::

M.Andreatta et al.

 

technologies grow to be a cost-effective and accessible platform
for investigation of protein-ligand interactions. The method is
highly customizable and publicly available as an online
web-server at http://www.cbs.dtu.dk/serVices/GibbsCluster.

ACKNOWLEDGEMENTS

The authors thank John Sidney (La Jolla Institute for Allergy
and Immunology, California, USA) for the binding afﬁnity val-
idation of the predicted MHC class I outliers.

Funding: The research leading to these results received funding
from the European Union Seventh Framework Program FP7/
2007-2013 under grant agreement nO 222773).

Conﬂict of Interest: none declared.

REFERENCES

Andreatta,M. et al. (2011) NNAlign: a web—based prediction method allowing
non—expert end—user discovery of sequence motifs in quantitative peptide data.
PLoS One, 6, e26781.

Assarsson,E. et al. (2007) A quantitative analysis of the variables affecting the rep—
ertoire of T cell speciﬁcities recognized after vaccinia virus infection.
J. Immunol., 178, 789(P7901.

Bailey,T.L. and Elkan,C. (1995) Unsupervised learning of multiple motifs in bio—
polymers using expectation maximization. Mach. Learn., 21, 51780.

Bailey,T.L. et al. (2006) MEME: discovering and analyzing DNA and protein se—
quence motifs. Nucleic Acids Res., 34, W36$W373.

Bratkovic,T. (2010) Progress in phage display: evolution of the technique and its
applications. Cell. Mol. Life Sci., 67, 7497767.

Busch,D.H. and Pamer,E.G. (1998) MHC class I/peptide stability: implications for
immunodominance, in vitro proliferation, and diversity of responding CTL.
J. Immunol., 160, 444174448.

Carducci,M. et al. (2012) The protein interaction network mediated by human SH3
domains. Biotechnol. Adv., 30, 4715.

Geironson,L. et al. (2012) Stability of peptide—HLA—I complexes and tapasin folding
facilitation7tools to deﬁne immunogenic peptides. FEBS Lett., 586, 133(r1343.

Gfeller,D. (2012) Uncovering new aspects of protein interactions through analysis
of speciﬁcity landscapes in peptide recognition domains. FEBS Lett., 586,
276472772.

Gfeller,D. et al. (2011) The multiple—speciﬁcity landscape of molecular peptide rec—
ognition domains. Mo]. Syst. Biol., 7, 484.

Halperin,R.F. et al. (2011) Exploring antibody recognition of sequence space
through random—sequence peptide microarrays. Mol. Cell. Proteomics, 10,
M110.000786.

Harndahl,M. et al. (2012) Peptide—MHC class I stability is a better predictor than
peptide afﬁnity of CTL immunogenicity. Eur. J. Immunol., 42, 140571416.

Hubert,L. and Arabie,P. (1985) Comparing partitions. J. Classyf, 2, 1937218.

Karosiene,E. et al. (2012) NetMHCcons: a consensus method for the major histo—
compatibility complex class I predictions. Immunogenetics, 64, 1777186.

Kim,T. et al. (2012) MUSI: an integrated system for identifying multiple speciﬁcity
from large peptide or nucleic acid data sets. Nucleic Acids Res., 40, e47.

Koivunen,E. et al. (1999) Identiﬁcation of receptor ligands with phage display pep—
tide libraries. J. Nucl. Med., 40, 8837888.

Lawrence,C.E. et al. (1993) Detecting subtle sequence signals: a gibbs sampling
strategy for multiple alignment. Science, 262, 2087214.

Lund,O. et al. (2004) Deﬁnition of supertypes for HLA molecules using clustering
of speciﬁcity matrices. Immunogenetics, 55, 7977810.

Mayer,B.J. (2001) SH3 domains: complexity in moderation. J. Cell Sci., 114,
125371263.

Nielsen,M. and Lund,O. (2009) NN—align. An artiﬁcial neural network—based align—
ment algorithm for MHC class II peptide binding prediction.
BMC Bioinformatics, 10, 296.

Nielsen,M. et al. (2004) Improved prediction of MHC class I and class II epitopes
using a novel Gibbs sampling approach. Bioinformatics, 20, 138871397.

Noguchi,H. et al. (2002) Hidden Markov model—based prediction of antigenic pep—
tides that interact with MHC class II molecules. J. Biosci. Bioeng., 94, 2647270.

Rammensee,H. et al. (1999) SYFPEITHI: database for MHC ligands and peptide
motifs. Immunogenetics, 50, 2137219.

Rand,W.M. (1971) Objective criteria for the evaluation of clustering methods.
J. Am. Stat. Assoc., 66, 84(r850.

Rao,X. et al. (2009) A comparative study of HLA binding afﬁnity and ligand
diversity: implications for generating immunodominant CD8+ T cell responses.
J. Immunol., 182, 152(r1532.

Saksela,K. and Permi,P. (2012) SH3 domain ligand speciﬁcity: what’s the consensus
and where’s the speciﬁcity. FEBS Lett., 586, 260972614.

Schutkowski,M et al. (2005) Peptide arrays for kinase proﬁling. ChemBioChem, 6,
5137521.

Soen,Y. et al. (2003) Detection and characterization of cellular immune responses
using peptide—MHC microarrays. PLoS Biol., 1, e65.

Thomsen,M.C. and Nielsen,M. (2012) Seq2Logo: a method for construction and
visualization of amino acid binding motifs and sequence proﬁles including se—
quence weighting, pseudo counts and two—sided representation of amino acid
enrichment and depletion. Nucleic Acids Res., 40, 177.

Uttamchandani,M. and Yao,S.Q. (2008) Peptide microarrays: next generation bio—
chips for detection, diagnostics and high—throughput screening. Curr. Pharm.
Des., 14, 242872438.

Wang,P. et al. (2010) Peptide binding predictions for HLA DR, DP and DQ mol—
ecules. BMC Bioinformatics, 11, 568.

Yewdell,J.W. and Bennink,].R. (1999) Mechanisms of viral interference with MHC
class I antigen processing and presentation. Annu. Rev. Cell Dev. Biol., 15,
5797606.

Yu,H. et al. (1994) Structural basis for the binding of proline—rich peptides to SH3
domains. Cell, 76, 9337945.

 

14

112 /310'S[Buln0prOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} papaolumoq

91oz ‘Og isnﬁnv uo ::

