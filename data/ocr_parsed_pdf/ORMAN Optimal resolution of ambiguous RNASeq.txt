ORIGINAL PAPER

Vol. 30 no. 5 2014, pages 644—651
doi:10. 1 093/bioinformatics/btt591

 

Sequence analysis

Advance Access publication October 15, 2013

ORMAN: Optimal resolution of ambiguous RNA-Seq
multimappings in the presence of novel isoforms

Phuong Daol‘l, Ibrahim Numanagicl'l, Yen-Yi Linl'l, Faraz Hachl'l, Emre Karakocz,
Nilgun Donmez1 ‘3, Colin Collinss, Evan E. Eichler2 and S. Cenk Sahinalp1'4‘*
1School of Computing Science, Simon Fraser University, Burnaby, BC, Canada, 2Department of Genome Sciences,

University of Washington, Seattle, WA, USA, 3Vancouver Prostate Centre & Department of Urologic Sciences, University
of British Columbia, Vancouver, BC, Canada and 4Division of Computer Science, School of Informatics and Computing,

Indiana University, Bloomington, IN, USA
Associate Editor: Ivo Hofacker

 

ABSTRACT

Motivation: RNA-Seq technology is promising to uncover many novel
alternative splicing events, gene fusions and other variations in RNA
transcripts. For an accurate detection and quantiﬁcation of transcripts,
it is important to resolve the mapping ambiguity for those RNA-Seq
reads that can be mapped to multiple loci: >17% of the reads from
mouse RNA-Seq data and 50% of the reads from some plant RNA-
Seq data have multiple mapping loci.

In this study, we show how to resolve the mapping ambiguity in the
presence of novel transcriptomic events such as exon skipping and
novel indels towards accurate downstream analysis. We introduce
ORMAN (Optimal Resolution of Multimapping Ambiguity of RNA-
Seq Reads), which aims to compute the minimum number of potential
transcript products for each gene and to assign each multimapping
read to one of these transcripts based on the estimated distribution of
the region covering the read. ORMAN achieves this objective through
a combinatorial optimization formulation, which is solved through well-
known approximation algorithms, integer linear programs and
heuristics.

Results: On a simulated RNA-Seq dataset including a random
subset of transcripts from the UCSC database, the performance
of several state-of-the-art methods for identifying and quantifying
novel transcripts, such as Cufflinks, IsoLasso and CLIIQ, is signifi-
cantly improved through the use of ORMAN. Furthermore, in an
experiment using real RNA-Seq reads, we show that ORMAN is
able to resolve multimapping to produce coverage values that are
similar to the original distribution, even in genes with highly non-
uniform coverage.

Availability: ORMAN is available at http://orman.sf.net

Contact: cenk@cs.sfu.ca

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 2, 2013; revised on September 30, 2013;
accepted on October 10, 2013

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst four
authors should be regarded as joint First Authors.

1 INTRODUCTION

Massively parallel RNA sequencing (RNA-Seq) technologies are
replacing microarrays in determining the structure and dynamics
of the transcriptome. Analysis of RNA-Seq data helps to un-
cover many novel alternative splicing events, gene fusions and
other variations in RNA transcripts. Unfortunately, there are
many RNA-Seq reads that can be mapped to several loci equally
well, and it is of key importance to resolve their mapping ambi-
guity in order to perform a comprehensive and accurate analysis
of the whole RNA-Seq data.

There are several mappers that can align RNA-Seq reads to a
reference genome or previously known transcript sequences (Au
et al., 2010; Trapnell et al., 2009; Wang et al., 2010; Yorukoglu
et al., 2012). Owing to the presence of paralogs and homologous
regions within a gene, RNA-Seq mappers typically report a frac-
tion of multireads, i.e. reads that map to multiple loci on a refer-
ence genome. Based on TopHat mappings on the human reference
genome, ~10% of human RNA-Seq reads are multireads.
Similarly, ~17% of mouse and 50% of some plant RNA-Seq
reads are multireads (Li and Dewey, 201 1). The presence of multi-
reads complicates the downstream analysis such as determining
alternative splicing patterns, gene fusions and other variations.

The common practice for handling multireads is ignoring them
in the downstream analysis. This leads to inaccurate estimation
of the abundance of expressed transcripts (Li and Dewey, 2011;
Nicolae et al., 2011). A simple approach for determining the
exact genomic location of a multiread is ‘RESCUE’
(Mortazavi et al., 2008). Here, the initial gene expression
values are calculated based on the unique reads that map to
them. Each multiread is then assigned to the gene with the frac-
tion equal to the ratio between the gene’s initial expression value
and the total expression value of all genes that the multiread
maps to. A more complex approach based on expected
maximization (EM) (Pasaniuc et al., 2011) is designed to
handle mapping ambiguity of a read to two or more homologous
genesifor the purpose of determining the expression value of
each of these genes and not to determine or quantify isoforms.
Finally, RSEM (Li and Dewey, 2011), IsoEM (Nicolae et al.,
2011) and iReckon (Mezlini et al., 2013) are EM methods
based on statistical generative models for sequencing processes
to resolve mapping ambiguity.

 

644 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 ﬁle'smumofquixo"sotJBuiJOJutotq/ﬁduq 11101} papaolumoq

91oz ‘Og isnﬁnV uo ::

ORMAN

 

Many of the above approaches are designed specially for
estimating expression values of known/annotated isoforms.
Their performance is highly dependent on the completeness of
the isoform database in use. Furthermore, they cannot handle
alternative splicing events such as novel exon skipping, alterna-
tive 5’ donor and 3’ acceptor sites, intron retention and other
structural differences such as insertions or deletions. Some
recent computational approaches, in particular IsoLasso (Li
et al., 2011), CLIIQ (Lin et al., 2012) and Cufﬂinks (Trapnell
et al., 2010), can identify and quantify unknown isoforms
and certain types of transcriptomic variations. Unfortunately,
neither IsoLasso nor CLIIQ takes into account multireads, and
Cufﬂinks handles multireads through a simple RESCUE-based
approach.

In this article, we show how to resolve the multimapping am-
biguity in the presence of novel isoforms involving exon skip-
ping, intron retention and small indels towards accurate
downstream analysis. To be mathematically precise, we intro-
duce the notion of a partial transcriptia substring of a potential
transcript product of a gene, which satisﬁes certain conditions (a
formal deﬁnition is provided in the next section).

The objective of our multiread resolution approach, ORMAN
(Optimal Resolution of Multimapping Ambiguity of RNA-Seq
Reads), is (i) to compute the minimum number of partial tran-
scripts that cover all the multireads and (ii) to assign each multi-
read to one of these partial transcripts such that each partial
transcript is covered according to the estimated local distribu-
tion. We achieve the ﬁrst objective approximately through a re-
duction to the standard set cover problem. We achieve the
second objective through an integer linear programming formu-
lation, which we handle using available integer linear program
(ILP) solvers such as CPLEX, or through greedy heuristics we
describe in this article.

We evaluate ORMAN on both simulated and real human
RNA-Seq datasets. For the first experiment, we generate
paired-end RNA-Seq reads from a random subset of transcripts
from the University of California, Santa Cruz (UCSC) database
with the expression distribution modelled after a real human
dataset. On this simulated data, we show that the performance
of state-of—the-art methods for identifying and quantifying

transcripts such as CLIIQ, Cufﬂinks and IsoLasso is typically
improved through the use of our multiread resolution approach.
Notably, when combined with IsoLasso or CLIIQ, ORMAN
gives the most accurate and comprehensive novel isoform detec-
tion and quantiﬁcation pipeline available.

To evaluate ORMAN in a more ‘real world’ setting, we also
design an experiment using real RNA-Seq data from a cancer
patient (Lapuk et al., 2012). For this experiment, we implant
artiﬁcial genomic repeats into several genes and compare the
performance of ORMAN with that of RESCUE in resolving
the multireads mapping to these regions. We show that on this
dataset, the multiread assignment by ORMAN approximates the
original distributions quite well with a maximum relative error of
<03.

2 METHODS
Online databases such as the UCSC browser provide known transcripts
from speciﬁc gene regions. Let T 2 {T1, T2, . . . , T1,} be the set of known

transcripts from a gene region GR. Each transcript T,- is a string that can
be partitioned into ‘exonic segments’ E(T,-) = {E1,E2, ...,EjE(Tl.)j}. We
deﬁne the ‘gene model’ GM implied by the set of transcripts T as an
ordered set of alternating substrings of the gene region called canonical
exons and canonical introns. Each exonic segment is a maximal substring
of a canonical exon, which is either completely present in a transcript or
excluded by that transcript. We refer the readers to Figure 1 for an illus-
tration of a gene model derived from known transcripts.

Given a read R mapping to a gene region GR, the partial transcript
PT supported by R is the shortest substring of the gene model that
completely covers R, which starts and ends with an exonic segment (or
a canonical intron in the case of intron retention). If there is a small
insertion or deletion (our method limits the size of each indel to 15 nt)
between the read and the reference sequence, we introduce a modiﬁed
partial transcript with the corresponding indel. Figure 2 illustrates sev-
eral examples of partial transcripts derived from read mappings to a
gene model.

2.1 Combinatorial optimization formulation

The set of partial transcripts present in a sample can be derived from the
mappings of RNA-Seq reads to a reference genome with the supply of
transcript annotation or to a reference transcriptome. Depending on the
given mapping to the reference genome or transcriptome, our objective is

W Camnica' Ems V

 

 

 

 

 

 

 

 

Gene Model
_—‘ '—
Known
. -— .- -
Transcripts
“—
Novel Transcript I—I I—I
Novel Transcript

with Indels

Fig. 1. A gene model, known transcripts (KT) of the gene model, a novel transcript (NT) derived from known transcripts and a novel transcript with
indels (NTID). Note that the latter may also be derived from known transcripts

 

112 ﬁle'smumofqurxo"sotJBurJOJutotq/ﬁduq 11101} pQPBOIII/IAOG

91oz ‘Og isnﬁnV uo ::

P.Dao et al.

 

r1 r2 r3

e1 e2 e3 e4 e5 e6

r4 r5

V

e7 e8 99 e10 e11

 

Fig. 2. Example reads mapping to the gene model of Figure 1. The partial transcripts derived from these reads are as follows: r1:{e1,e2}; r2:{e2,e3,e4};
r3:{e5,e6,e7}; r4:{e8"”,e9} and r5:{e9,e11}. Above, e8”Y denotes exon 8 with the implied insertion

to assign each multiread to a single locus on the genome or a transcript.
We also need to determine the partial transcript that the multiread
should map to. This is done in two phases. In the ﬁrst phase, we are
interested in the minimum number of partial transcripts that could
cover all the (multi)reads. In the second phase, we try to distribute
the (multi)reads to the set of partial transcripts from the ﬁrst phase
such that the distribution of mappings for each partial transcript follows
the most likely distribution.

2.1.] First phase Let C = {PT1, PT2, ..,PT,,} be the collection of all
the partial transcripts derived from mapping results. We also denote by
PT,- (1 5 i 5 p) the set of all reads that support the same partial transcript
PT,-. In addition, each PT,- is assigned a positive weight that is propor-
tional to the number of splicing events, i.e. exon skipping and intron
retention events with respect to the known transcript it is associated
with. For the partial transcripts without any variations with respect to
their associated known transcripts, the weight is 1. Each variation adds a
user-deﬁned ﬁxed value to this weight. Our default weight contribution of
exon skipping is 100 and of indel is 10 000. Indel events have high weight
due to their signiﬁcantly low relative frequency (Karakoc et al., 2012).
Note that, in the case of paired-end reads, each end of a fragment may be
assigned to a different partial transcript. In that case, we assign such a
pair to the partial transcript formed by taking the union of the exons
from the partial transcripts on both ends. The weight of this new partial
transcript PT,- is assigned as the sum of the weights of the two partial
transcripts it is composed of . We aim to determine the minimum-
weighted set of partial transcripts that can cover all the reads. This prob-
lem can be deﬁned as an instance of the minimum-weighted set cover
problem, where sets are represented by the partial transcripts, and reads
represent set elements. Because the minimum-weighted set cover problem
is NP-hard, we use the standard greedy algorithm, which provides a
logarithmic factor approximation guarantee (Chvatal, 1979) to solve
this problem and obtain the set of partial transcripts used for the smooth-

ing step.

2.1.2 Second phase First, we give the formulation of the problem in
this phase in terms of an ILP below. We then show the computational
complexity of the problem. Finally, we show how to solve the problem in
practice.

Let C’ = {PT1,PT2, ..,PT1,/} be a set of partial transcripts returned
from the ﬁrst phase. For the partial transcript PT]- 6 C’, we aim to dis-
tribute multireads across the partial transcript such that the coverage
function of the reads in each partial transcript resembles the most
likely distribution. In the case of paired-end reads, we use both ends
for the coverage determination. For a read R, let SPT(R) be the set of
partial transcripts that R could map to.

Now let lenR be the read length and len(PTJ-) be the length of the
partial transcript  Let R,-/~ (1 5 i 5 |R| and 1 5 j 5 |SPT(R,-)|) be in-
dicator variables, where Ril- = 1 means that we assign R,- to the partial
transcript PT); otherwise Ril- = 0. We enforce that R,- can only be assigned
to one partial transcript:

R,- = 1 (1)
UIPT/ESPTKRM

Let NR/k (1 5 j 5 p’ and 1 5 k 5 len(PTJ-)) be the number of reads
that cover position k in PT). Let M ulti(PTJ-, k) be the set of the multireads

that cover the position k in PT). In similar manner, we deﬁne
Unique(PTJ-,k) to be the number of reads that are uniquely mapped
and cover the position k in PT). NR/k could be written as the summation
of the number of uniquely mapped reads and multireads that cover the
location k:

NRJ- = Unique(PTJ-, k) + Z R,—,- (2)
(ilR;EMulti(PT/-, k))

Let A  be the desired number of reads covering the position k in the
partial transcript PT). Because we do not know the original distribution
of the reads, we approximate Aij as follows. First, we ﬁnd the multi-
mapping region Mk of PT), which encompasses position k. Next, we
calculate the average coverage in the left and right neighbourhoods of
Mk (the size of each neighbourhood is set to h X [en]; base pairs, where h
is a user-deﬁned parameter). We use the calculated average values as
deﬁning points for a line I, which approximates the desired function
AV. Then, Aij is calculated as a value on the line I at the position k.
The rationale of this approach lies in the observation that coverage level
of a small region is often similar to the level of the immediately neigh-
bouring regions, even when the coverage varies signiﬁcantly along the
entire gene (see Fig. 3).

Let  3 0 denote the maximum difference between the desired number
of reads Aij per position of partial transcript PT) and the observed
number of reads NR/k at any position k. We enforce the following
constraints:

—clj:AV,- —NRJ-k:dj (3)

Our objective is to minimize the total difference:

2 d, (4)

151511“

The problem of smoothing of the distribution of reads along par-
tial transcripts, named SMOOTH, is provably hard. In addition, it is
unlikely to have a constant factor approximation algorithm for the
SMOOTH problem. The proofs are described in Supplementary
Materials.

2.1.3 Practical implementation The ILP formulation of ORMAN is
solved by IBM ILOG CPLEX. In practice, the running time of the
proposed ILP depends on the number of integer and non-integer vari-
ables and the number of constraints. The number of integer variables of
the provided ILP is proportional to the number of mappings of multi-
reads, which can be in the order of millions. Here we propose a strategy
to decompose the original problem into smaller subproblems such that
the solution of each smaller one is independent from each other. We
create a graph GPT = (VPT, EPT) among the partial transcripts returned
from the ﬁrst phase, i.e. VPT = C’. There is an edge between two partial
transcripts if there is a multiread r mapping to both of them. It is easy to
see that the solution of the ILP corresponding to each connected com-
ponent in GPT is independent from the solutions of other components.
Thus, we can obtain the solution for each component separately using
CPLEX. There may still exist some components that could not be solved
using CPLEX. In these cases, we propose a heuristic strategy as described
in the Supplementary Materials.

 

646

112 ﬁle'smumofqurxo"sotJBurJOJutotq/ﬁduq 11101} papBOIII/IAOG

91oz ‘Og isnﬁnV uo ::

ORMAN

 

 

 

 

Fig. 3. The read distribution of gene USPS taken from a real RNA-Seq dataset (see Section 3.2 for details). Although the overall sequence coverage
varies significantly along the gene, a small region often coincides well with its neighbourhood

3 EXPERIMENTAL RESULTS

We evaluate the performance of ORMAN on both simulated
and real datasets. On both types of data, we show that
ORMAN resolves mapping ambiguity of multireads accurately
and improves the performance of the leading transcript identiﬁ-
cation and quantiﬁcation tools.

3.1 Transcript identiﬁcation and expression quantiﬁcation
in simulated data

First, we focus on quantifying how much ORMAN improves
downstream analysis tools. We compare the performance of
the leading transcript identiﬁcation and quantification tools by
(i) first running each tool without any pre— or postprocessing
(ORIGINAL), and (ii) then running each tool after preprocess-
ing the mappings by ORMAN.

Because there are no real world benchmark datasets that pro-
vide comprehensive and accurate information on all transcripts
and their abundance levels validated by wetlab techniques, we
use simulation data for this evaluation. [Even though the MAQC
project (Shi et al., 2006) used RNA-Seq technologies to quantify
the expression of a limited number of genes, a significant number
of these genes have a single isoform and have unique sequence
composition (Li and Dewey, 2011)].

3.1.1 Simulation data We generated RNA-Seq reads of human
transcripts with expression distribution similar to one derived
from a real dataset from the GEO database (accession number
GSM759513). This dataset comprises paired-end 50-bp RNA-
Seq reads of a prostate tissue from Illumina Human BodyMap
2.0 project (Shen et al., 2012). The reference transcriptome has
76 969 transcripts based on the UCSC database. We used
TopHat version 2.0.77with the number of mismatches at most
2ito obtain the mappings of the RNA-Seq reads to the refer-
ence sequence (version hgl9). We ran IsoEM to quantify the
expression proﬁle of the UCSC reference transcriptome and
determined that 39 388 of them are highly expressed.

For the simulations, we assigned one random transcript out of
all 76 969 transcripts to each one of the expressed transcripts of
the prostate dataset. These randomly assigned transcripts repre-
sented the expression of 17 956 genes. We then set the expression
value of each random transcript to that of the prostate dataset
transcript it is associated with. We ﬁnally selected 10% of this
randomly selected set of the simulated transcripts for the pro-
duction of novel transcripts; for each such transcript, we ran-
domly skip an exon.

To ensure this transcript is novel, we check whether it is highly
similar to other known transcripts. We consider a novel

transcript to be highly similar to a known transcript if they
have the same number of exons and their percentage sequence
similarity is >90%. The novel transcript is then assigned the
same abundance level as the original transcript.

We generated 80 million paired-end RNA-Seq reads of 75-bp
length from the chosen transcripts. The fragment length is deter-
mined based on the normal distribution with a mean of 250 bp
and a standard deviation of 25 bp. Each transcript received a
number of reads proportional to its predetermined expression
level, and each read was picked uniformly at random over all
possible starting positions of the transcript. We then randomly
introduced sequencing errors in the generated reads according to
sequencing error model described in Dohm et al. (2008). This
model places the majority of mismatch errors towards the 3’-end
of the reads. The error percentage per base was set to be 1%. We
used TopHat with the above settings to map the generated reads
to the reference genome. Approximately 4% of the generated
reads had multiple mapping loci.

3.1.2 Performance evaluation Our performance evaluation is
based on three tools: Cufﬂinks (version 2.0.2), IsoLasso (version
2.6.0) and CLIIQ (version 0.1.0.2). Cufﬂinks uses a modiﬁed
rescue strategy to resolve multireads, whereas the latter two are
not capable of resolving multimappings. We run CLIIQ in both
its standard mode, where it selects the minimum possible number
of isoforms, which minimizes quantiﬁcation errors, and prefer-
ence mode, where it prefers known isoforms when there are mul-
tiple candidate solutions (abbreviated as CLIIQ_pref below). To
measure the relative performance of these tools, we provided the
complete UCSC gene annotations and disallowed any novel
splice sites while allowing novel exon skipping and intron reten-
tion events.

The expression values of transcripts are measured in fragments
per kilobase per million mapped reads. For each transcript, we
deﬁne the ‘relative quantiﬁcation error’ produced by a given tool
as follows. (i) If the known expression value of the transcript is e
and the expression value of the transcript reported by the tool is
e, then the relative quantification error is |e — él / e. (ii) If the tool
reports a transcript that is not among the simulated expressed
transcripts, the relative quantiﬁcation error is +00. (iii) If the
tool misses a known expressed transcript, the relative quantiﬁca-
tion error is 1. Following (Li and Dewey, 2011; Nicolae et al.,
2011), we first investigate the proportion of transcripts whose
relative quantiﬁcation error is above a threshold.

For each tool, we also compare how ORMAN affects its per-
formance on detecting novel isoforms. The novel isoforms in our
simulation generate reads that are incompatible to any known
gene annotations. For existing mapping ambiguity resolving

 

647

112 /310'S[BHJDOIPJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} papBOIII/IAOG

91oz ‘Og isnﬁnV uo ::

P.Dao et al.

 

tools that require the full list of known transcripts, these reads
might be discarded; hence, novel isoforms with multireads may
not be detected. On the other hand, ORMAN allows such reads
to be used in the solution. In our experiments, all three tools
detect more novel isoforms based on ORMAN mappings as
can be seen from Table 1.

In Figure 4, we see that ORMAN improves the performance
of IsoLasso and CLIIQ significantly in both modes, which, in
comparison with Cufﬂinks, return fewer incorrectly quantiﬁed
isoforms for smaller error thresholds. Overall, Figure 4 demon-
strates that the combination of ORMAN and CLIIQ_pref pro-
vides the best results.

We also report the performance of tools on genes that produce
a high proportion of multimapping reads separately. Here, we
focus on 3784 genes (expressing 7275 transcripts) to which
TopHat mapped reads have the top 20% highest mapping multi-
plicity (see later).

Figure 5 shows the proportion of transcripts whose relative
quantiﬁcation error is above a threshold on this subset. As
before, ORMAN improves the performance of IsoLasso and
CLIIQ significantly in both modes, which are better compared
with that of Cufﬂinks.

Next, we consider the performance of each tool in novel iso-
form detection for those genes that produce multimapping reads.
First, we sort all expressed genes according to their mapping
multiplicity (i.e. the proportion of the reads that can be
mapped to such a gene, which can also be mapped to other
genes). Then for genes ranked in the top 10, 20, 30, 40 and

Table 1. Number of novel isoforms correctly identiﬁed by each tool with
and without ORMAN

 

 

 

Cufﬂinks2 IsoLasso CLIIQ CLIIQ_pref
ORIGINAL 1043 1292 1513 1325
ORMAN 1055 1308 1533 1334
(a) Overall Comparison

50%, we examine how each tool performs in detecting novel
isoforms. Figure 5 demonstrates that, in the case of novel iso-
forms, all tools benefit from ORMAN mappings. In addition,
for those genes whose multiplicity is in top 10% in the sample,
ORMAN performs particularly well.

3.2 Multimapping resolution in real RNA-Seq data

It has been known that real RNA-Seq experiments often suffer
from various biases resulting in a rather non-uniform coverage
across a gene model (Roberts et al., 2011; Wu et al., 2011).
Unfortunately, modelling of such complex biases in simulations
would be cumbersome. To overcome this problem, we design a
controlled experiment with real RNA-Seq reads. For this experi-
ment, we use a previously published RNA-Seq dataset with
51-bp Illumina paired-end reads sampled from a human prostate
cancer patient (Lapuk et al., 2012). On this dataset, we introduce
artiﬁcial repeats in 10 genes based on sequences of other genes.
By modifying the sequences of the original reads mapping to the
artiﬁcial repeats, yet keeping everything else intact, we essentially
create a multimapping dataset for which the true coverage dis-
tribution is known. We then evaluate ORMAN’s performance in
resolving these multireads.

The following section explains the experimental setup in detail.
In the next section, we elaborate on the experiment results.

3.2.] Experimental setup First, we map the reads using TopHat
(version 1.3.2) to the reference sequence (hg19) and Ensembl
annotations (GRCh37.62). Next, we randomly select 10 ‘decoy’
genes according to the following rules:

(1) The gene is annotated to have a single transcript based on
the Ensembl annotations.

(2) The total gene length (i.e. the sum of all canonical exons) is
at least 2000 bp.

(3) The gene is sufﬁciently expressed in the sample, having an
average coverage >100.

(4) The gene is uniquely mappable (i.e. there are no multireads
mapping to the gene model).

Overall Comparison for Genes Containing Novel lsoforms

A
U'
v

 

0.85 -
0.0 -

0.75 -

0.7 —

     
 

 

0.65 —
IsoLasso
IsoLasso+ORMAN
Cufllinks
Cufllinks+ORMAN
CLI IQ

CLI |Q+QRMAN

CLI |Q5pref
CLII07pref+0RMAN

Fraction of lsoform over Error Threshold

 

Iéitliit

 

 

 

p
8
I

.0
m
I

p
a
I

     
 

F
a:

 

IsoLasso
|soLaseo+0RMAN
Cuminks
Cuminks+0RMAN
CLIIQ
CLI|Q+ORMAN
CLIIQJaref
CLIIQJMBHORMAN

0.75 —

Fraction of lsoform over Error Threshold

Iéitfifi

0.7 -

 

 

 

 

I I I I I I I I I
0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5

Relative Quantiﬁcation Error

.6
D-
o

 

I I I I I I I I I
0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5

Relative Quantification Error

P
O-
m

Fig. 4. Comparative performance of each tool and its enhanced version with ORMAN measured as the proportion of transcripts whose relative
quantiﬁcation error is above a threshold, as a function of the threshold. We show results of three tools (ORIGINAL) as well as their ORMAN
enhanced versions of (a) all 17956 expressed genes (left) and (b) 3148 genes containing novel transcripts (right)

 

112 /310'S[BHJHOIPJOJXO'SOIJ’BLUJOJIIIOICI”Idllq moi; papBOIII/IAOG

91oz ‘Og isnﬁnV uo ::

ORMAN

 

Similarly, we randomly select 10 ‘replacement’ genes according
to the rules 2, 3 and 4 above. Within each replacement gene, we
select a 400-bp region to serve as an artiﬁcial repeat. This 400-bp
sequence is then used to replace the sequence of a region of the
same length in the decoy gene. In other words, in each decoy
gene, we create an artiﬁcial repeat for which the sequence is
taken from a randomly chosen replacement gene. The selected
genes and the repeat regions are given in Table 2.

In the next step, we identify the reads mapping to the coord-
inates coinciding with the artiﬁcial repeat region in each decoy
gene. The sequences of these reads are changed according to the
new sequence of the decoy gene. All other reads are kept the
same. The entire set of reads is then mapped to the new
genome reference and the original Ensembl annotations using
TopHat with the same parameters.

3.2.2 Evaluation In this experiment, we compare ORMAN
with the modiﬁed version of RESCUE as used in Cufﬂinks
(Mortazavi et al., 2008; Trapnell et al., 2010). This modiﬁed

Overall Comparison for Genes with High-ratio of Multiple-loci Reads

A
9)
V

 

P

«I

m
I

     
 

 

IsoLasso
lsoLasso+ORMAN
Cufllinks
Cufﬂinks+0RMAN
CLI IQ

CLI |Q+ORMAN
CLIIQ prev

CLI |Q_pre1+0RMAN
I

Fraction of lsoform over Error Threshold

 

 

liltiiié

 

 

I I I I I I I I
0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5

.0
o_
m

Relative Quantiﬁcation Error

version calculates the initial gene/transcript abundances ﬁrst by
equally distributing the multireads to each gene they map to. In
the second phase, each multiread is distributed in proportion to
the relative abundance of each gene as computed in the first
phase.

Figure 6 shows the relative error of coverage in the artiﬁcial
repeat regions after resolution with ORMAN and RESCUE.
This measure is calculated as:

I Coriginal _ German I
— (5)
Ctophat

where corigiml, cmpha, and comm are the original coverage, raw
coverage after the second TopHat mappings and coverage after
multiread resolution with ORMAN, respectively. The relative
error for RESCUE is deﬁned similarly.

On genes APPBP2, CD164, PPMlH, RCORl, RYBP,
SERPINB6, SSR2, TXNDC16, UQCRC2 and ZBTB42, we
see that ORMAN produces lower error values than RESCUE,
whereas in the rest of the genes, it produces a higher relative

 Fraction of Novel lsoforms Detected for Genes with High Ratios of Multi-reads

 

0.35 —

0.25 -

 

 

’ . -e- IsoLasso
I — ‘ —A— IsoLasso+ORMAN

’x re» Cuminks

"-15 ' ,x —e— Cuminks+ORMAN
or -e- CLIIQ

+ CLIIQ+ORMAN

4)» CLIIQJ‘NBI'

+ CLIIQ_preHORMAN

I I I I I

rop_1o% lap_20% lop_30% Iowan/II top_50%

For genes of higher multi-mapping ratio

Fraction of novel isoforms detected

 

 

 

 

Fig. 5. Comparative performance of each tool and its enhanced version with ORMAN on selected genes that produce multireads, measured as the
proportion of transcripts whose relative quantiﬁcation error is above a threshold, as a function of the threshold. We show results of three tools
(ORIGINAL) as well as their ORMAN enhanced versions for 3784 genes containing high ratio of multi-loci reads (left). We also examine the
performance of novel isoform detections for gene whose multiread ratio ranked as top 1(P50% in the whole sample (right)

Table 2. The genes and the artiﬁcial repeat locations used in the experiments

 

 

 

 

Replacement Decoy
Gene Chromosome Strand Start End # of reads Gene Chromosome Strand Start End # of reads
ZBTB42 14 + 105269519 105269918 1026 PPMlH 12 — 63041681 63042080 1839
NFE2L1 17 + 46128078 46128477 3697 UBL3 13 — 30339161 30339560 1949
USPS 12 + 6975253 6975652 931 BCL2L2 14 + 23776979 23777378 708
CD164 6 — 109689719 1096901 18 9461 TXNDC16 14 — 52898046 52898445 2072
APPBP2 17 — 58522733 58523132 733 RCORl 14 + 103193777 103194176 902
SERPINB6 6 — 2948403 2948802 6203 UQCRC2 16 + 21994419 21994818 1196
SCAMP2 15 — 75136401 75136800 2386 USP43 17 + 9632438 9632837 838
UBE2K 4 + 39780509 39780908 1724 MULl 1 — 20827015 20827414 1108
SSR2 1 — 155978849 155979248 7319 RYBP 3 — 72426808 72427207 289
COPG 3 + 128996147 128996546 6110 STK38 6 — 36462615 36463014 935

 

Note: ‘# of reads’ denotes the initial number of reads mapping to the 400—bp region that is used to introduce the artiﬁcial repeats.

 

649

112 /310'S[BHJHOIPJOJXO'SOIJ’BLUJOJIIIOICI”Idllq uteri papaolumoq

91oz ‘Og isnﬁnV uo ::

P.Dao et al.

 

Relative error of coverage in the repeat regions

0.4
0.35
0.3
0.25
0.2
015
0.1

005
0 II II II I. II I. .I II

S

’1/ (9 N
’9’ '3’ 0‘1 0‘ WV
V 0 ‘c
é, (J (J Q g QQ®

IORMAN

I RESCUE

b

m \L
s» a e

0; w,
a c
52’

a,
\/ V
5‘" 06“

o

’5 ‘9

u <2

‘2 ‘7 Q:
08 0 ‘2'}

Fig. 6. The relative error of coverage in the repeat regions after multimapping resolution by ORMAN and RESCUE in the decoy and replacement genes

used in the experiments

Original

Original

Fig. 7. Coverage plots for two genes (left: ZBTB42, right: BCL2L2) before and after processing with ORMAN compared with the original mappings.
Top track (red) shows the mappings in the unaltered dataset; middle track (blue) shows the TopHat mappings after artiﬁcial repeats are introduced and
the bottom track (green) shows the mappings after multiread resolution with ORMAN. The boxes outlined with dashed orange lines depict the artiﬁcial

repeat region

error. On the other hand, the relative error of ORMAN never
exceeds 0.3. Furthermore, a closer look on some of the genes
suggests that ORMAN is still able to reproduce the look of the
original distribution quite well despite the fact that RESCUE has
a lower relative error. Figure 7 illustrates two such genes. Note
that although both genes have a high variation in coverage, the
coverage distribution in the repeat region is close to the original
distribution after processing with ORMAN.

4 DISCUSSION

In this article, we introduce a combinatorial optimization formu-
lation for resolving mapping ambiguity of RNA-Seq reads.
Using a simulated RNA-Seq dataset on humans, we have
shown that ORMAN improves the performance of popular com-
putational tools in transcript identiﬁcation and quantiﬁcation,
especially for genes with novel isoforms. Furthermore, our ex-
periments based on real RNA-Seq reads suggest that the loca-
lized approach of ORMAN is able to approximate the original
read distribution of the multimapping regions even in genes with
highly variable coverage. Although ORMAN’s performance was
similar to that of RESCUE in our small-scale experiment, we
suspect that datasets that suffer from elevated level of sequencing
biases such as severe RNA degradation could beneﬁt even more
from our approach.

Funding: This research was supported by NSERC Discovery and
Discovery Accelerate Grant to S.C.S., Canadian Cancer Society
Innovation Grant to CC. and S.C.S., Vanier Canada Graduate
Scholarship to IN. and Ebco/Epic Visiting Chairs and ICGC
Grant to N.D.

Conflict of Interest: none declared.

REFERENCES

Au,K.F. et al. (2010) Detection of splice junctions from paired—end RNA—seq data
by SpliceMap. Nucleic Acids Res, 38, 457041578.

Chvatal,V. (1979) A greedy heuristic for the set—covering problem. Math. Oper. Res,
4, 2337235.

Dohm,J.C. et al. (2008) Substantial biases in ultra—short read data sets from high—
throughput DNA sequencing. Nucleic Acids Res, 36, e105.

Karakoc,E. et al. (2012) Detection of structural variants and indels within exome
data. Nat. Methods, 9, 17(r178.

Lapuk,A.V. et al. (2012) From sequence to molecular pathology, and a mechanism
driving the neuroendocrine phenotype in prostate cancer. J. Pathol, 227,
283297.

Li,B. and Dewey,C.N. (2011) RSEM: accurate transcript quantiﬁcation from RNA—
Seq data with or without a reference genome. BMC Bioinformatics, 12, 323.

Li,W. et al. (2011) Isolasso: a lasso regression approach to RNA—seq based tran—
scriptome assembly. J. Comput. Biol, 18, 169371707.

Lin,Y.—Y. et al. (2012) CLIIQ: accurate comparative detection and quantiﬁcation of
expressed isoforms in a population. Algorithms Bioinformatics, 7534, 1787189.

Mezlini,A.M. et al. (2013) iReckon: simultaneous isoform discovery and abundance
estimation from RNA—seq data. Genome Res, 23, 5197529.

 

650

112 /310'S[BHJHOIPJOJXO'SOIJ’BLUJOJIIIOICI”K1111] uteri papeolumoq

91oz ‘Og isnﬁnV uo ::

ORMAN

 

Mortazavi,A. et al (2008) Mapping and quantifying mammalian transcriptomes by
RNA—Seq. Nat. Methods, 5, 621$28.

Nicolae,M. et al (2011) Estimation of alternative splicing isoform frequencies from
RNA—Seq data. Algorithms Mol Biol, 6, 9.

Pasaniuc,B. et al (2011) Accurate estimation of expression levels of homologous
genes in RNA—seq experiments. J. Comput. Biol, 18, 4594168.

Roberts,A. et al (2011) Improving RNA—seq expression estimates by correcting for
fragment bias. Genome Biol, 12, 1714.

Shen,Y. et al (2012) A map of the cis—regulatory sequences in the mouse genome.
Nature, 488, 11(r120.

Shi,L. et al (2006) The MicroArray Quath Control (MAQC) project shows inter—
and intraplatform reproducibility of gene expression measurements. Nat.
Biotechnol, 24, 115171161.

Trapnell,C. et al. (2009) TopHat: discovering splice junctions with RNA—Seq.
Bioinformatics, 25, 1 105711 1 l.

Trapnell,C. et al (2010) Transcript assembly and quantiﬁcation by RNA—Seq re—
veals unannotated transcripts and isoform switching during cell differentiation.
Nat. Biotechnol, 28, 5117515.

Wang,K. et al (2010) MapSplice: accurate mapping of RNA—seq reads for splice
junction discovery. Nucleic Acids Res, 38, e178.

Wu,Z. et al. (201 1) Using non—uniform read distribution models to improve isoform
expression inference in RNA—seq. Bioinformatics, 27, 5027508.

Yorukoglu,D. et al (2012) Dissect: detection and characterization of novel struc—
tural alterations in transcribed sequences. Bioinformatics, 28, i17%i187.

 

651

112 /310'S[BHJHOIPJOJXO'SOIJ’BLUJOJIIIOICI”K1111] uteri papeolumoq

9103 ‘Og isnﬁnV uo ::

