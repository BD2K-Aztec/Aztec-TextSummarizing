Bioinformatics Advance Access published July 21, 2016

Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw413

Advance Access Publication Date: 13 July 2016
Applications Note

 

 

Bioimage informatics

MorphoLibJ: integrated library and plugins for
mathematical morphology with ImageJ

2,4,5,6

David Legland1'2'3'*, Ignacio Arganda-Carreras and

Philippe Andreyz'7

1UF11268 Biopolymers, Interactions and Assemblies, INRA, Nantes, France, 2Institut Jean-Pierre Bourgin, INRA,
AgroParisTech, CNRS, Université Paris-Saclay, Versailles, Cedex, RD10, 78026, France, 3UMR782 Food Process
Engineering and Microbiology, INRA, AgroParisTech, ThivervaI-Grignon, France, 4Basque Foundation for Science,
Ikerbasque, Bilbao, 48013, Spain, 5Computer Science and Artificial Intelligence Department, Basque Country
University (UPV/EHU), Donostia-San Sebastian, 20018, Spain, 6Donostia International Physics Center (DIPC),
Donostia-San Sebastian, 20018, Spain and 7Sorbonne Universités, UPMC Univ Paris 06, UFR 927, Paris, France

*To whom correspondence should be addressed
Associate Editor: Robert Murphy

Received on February 12, 2016; revised on May 20, 2016; accepted on June 19, 2016

Abstract

Motivation: Mathematical morphology (MM) provides many powerful operators for processing
2D and 3D images. However, most MM plugins currently implemented for the popular ImageJ/Fiji
platform are limited to the processing of 2D images.

Results: The MorphoLibJ library proposes a large collection of generic tools based on MM to pro—
cess binary and grey—level 2D and 3D images, integrated into user—friendly plugins. We illustrate

how MorphoLibJ can facilitate the exploitation of3D images of plant tissues.
Availability and Implementation: MorphoLibJ is freely available at http://imagej.net/MorphoLibJ

Contact: david.legland@nantes.inra.fr

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The continuous development of microscopy imaging techniques re—
sults in increasingly better spatial resolution, signal quality and
throughput and allows 3D imaging of biological cells, tissues or or—
ganisms. Biological images present specific difficulties for automated
analysis, due to data dimensionality (space, time, channels, etc.), ac—
quisition artefacts, or low contrast. There is thus a recurrent need
for efficient image processing algorithms and for user—friendly soft—
ware that integrates them.

Mathematical morphology (MM) is a class of image processing
algorithms and methods with well—established theoretical founda—
tions that have proven useful for a large variety of problems (Soille,
2003). Typical applications comprise image filtering and enhance—
ment, segmentation and analysis. It extends naturally to the process—
ing of three dimensional images. Though it constitutes a
methodology of choice for the processing of biological images, it is
not widely used, possibly due to the lack of developer—friendly im—
plementations and user—friendly interfaces.

One of the most popular bioimage informatics tools is the
ImageJ/Fiji software, which offers a large spectrum of image pro—
cessing operators and allows addition of plugins developed by the
community (Schindelin et (11., 2012). Several plugins include mor—
phological filtering (Landini, 2008; Ollion et (11., 2013; Prodanov
et (11., 2006), or segmentation (Tsukahara 2008, available at http://
bigwww.epﬂ.ch/sage/soft/watershed) tools. However, none of them
implements a comprehensive and consistent set of MM operators,
supporting 2D as well as 3D images, and compatible with arbitrary
image types (8, 16 and 32 bits).

Understanding the cellular bases of complex phenomena such
as plant development and morphogenesis requires quantitative
approaches of cellular morphology and tissue architecture. Many
software have emerged for image analysis of plant tissues
(Barbier de Reuille et (11., 2015; Fernandez et (11., 2010; Pound
et (11., 2012; Schmidt et (11., 2014). However, such software are
specific to a particular application, and rarely interact with
Image].

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1

91oz ‘Og JSanV 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /3.10'spzu.m0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

D.Legland et al.

 

To meet the needs for generic implementations and Image] inter—
faces of MM operators, we developed the GPL—licensed MorphoLibJ
library. MorphoLibJ implements a large collection of MM algorithms
applicable to 2D and 3D grey level images and integrated into user—
friendly interfaces.

2 The MorphoLibJ library

The library provides different categories of functions, corresponding
to standard image processing workﬂows. The complete list of oper—
ators is given in the user manual (Supplementary File S1).

2.1 Image processing and filtering

A large collection of pre—processing operations (noise reduction,
edge detection, feature enhancement. . .) is available through tunable
morphological filters (closing, opening, top—hat, morphological gra—
dients. . .). Grayscale attribute opening allows efficient filtering of
images based on a size criterion. The library also contains a large
family of operators based on geodesic reconstruction (Soille, 2003),
such as hole filling or automated identification of extended minima
or maxima.

2.2 Segmentation

The watershed transform has proven efficiency for segmenting con—
trasted structures or plant tissues, but usually results in over—
segmentation (Vincent and Soille, 1991). Segmentation can be signifi—
cantly improved by pre—processing images to remove non significant
minima. This is classically achieved by combining the watershed with
the h—maxima and regional extrema operators. We developed a plugin
interface to allow end—users to easily run the corresponding pipeline
of operators. The plugin lets users tune a single tolerance parameter
defining significant minima and provides immediate visual feedback
(Fig. 1B).

2.3 Post—processing

Most segmentation algorithms require additional processing to re—
move or merge regions with inappropriate size or location (e.g.,
touching borders). Several MorphoLibJ utilities allow a posteriori

 

Fig. 1 (A) Original 3D image of a fixed A. thaliana embryo. (B) Graphical user
interface for segmentation of 3D images. (C) 3D cell segmentation by water-
shed, using random label colouring, after manual editing of labels. (D) Colour
rendering of the length ratio between the largest and the smallest cell axes.

manual correction of label and binary images, labelling of connected
components in 2D or 3D binary images, and the production of
meaningful representations from segmentation results.

2.4 Quantitative analysis

Object morphology and topology can be described by volume, sur—
face area (implemented as discretization of Crofton formula (Ohser
and Schladitz, 2009)) or Euler Number. Using geodesic reconstruc—
tion, MorphoLibJ also provides less common, yet powerful, features
such as the maximal enclosed ball and geodesic diameter. Spatial
organisations and neighbourhood relationships between labelled re—
gions can be quantified by region adjacency graphs.

2.5 Library re—usability

A key design concept was the modularity of the implementation.
The library is structured into three layers with different program—
ming abstraction. For final users, plugins provide graphical display
and intuitive tuning of parameters. For plugin developers, the library
provides collections of static methods, and most operators can be
called in a single line of code. For core developers, algorithms are
implementations of abstract interfaces, making it possible to choose
or develop the most appropriate one. This modularity permitted to
develop other plugins devoted to the analysis of nucleus images
(Poulet et al., 2015), grey level granulometries (Devaux and
Legland, 2014) or the description of binary microstructures (Silva
et al., 2015).

3 Sample application: quantitative analysis of
Arabidopsis thaliana early embryos

The automated analysis of 3D images of plant tissues is particularly
challenging. Using MorphoLibJ, we analysed cell morphologies and
division patterns in 3D confocal images of Arabidopsis thaliana em—
bryos at early development stage (Fig. 1A). The computation of ex—
tended minima by manually adjusting the “tolerance” parameter
identified large dark regions and allowed a coarse detection of cells.
Extended minima were used as markers of the 3D watershed algo—
rithm, resulting in the identification of homogeneous regions in the
image (Fig. 1B). The regions outside of the embryo were manually
removed after a visual inspection of the label image, to obtain an ac—
curate 3D cell segmentation (Fig. 1C). Visualizing the length ratio of
largest and smallest axes of the equivalent ellipsoid highlighted spe—
cific geometric differences between embryo domains (Fig. 1D).

4 Conclusion

The MorphoLibJ library provides a set of generic tools for image
processing and analysis of biological samples. We demonstrated its
applicability on 3D images of plant tissue. The cell—resolved data
provided by MorphoLibJ will be useful for the analysis of cell lin—
eage, and the modelling of plant growth and morphogenesis in 3D.

Acknowledgements

We thank Jean-Christophe Palauqui and Katia Belcram for providing sample
images and feedback on the Morphological Segmentation plugin.

Funding

I.A.C. was funded by the TEFOR Infrastructure under the Investments for the
Future program of the French National Research Agency (Grant #ANR-ll-

9103 ‘Og isnﬁnv uo sejeﬁuv soc] ‘Btulomizg JO AJtSJQAtuf] 112 /3.IO'S[BHJI’IO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 11101} papeolumoq

MorphoLibJ: mathematical morphology with lmageJ

 

INBS-0014). The IJPB beneﬁts from the support of the Labex Saclay Plant
Sciences-SP5 (#ANR—lO-LABX—OO40—SPS).

Conﬂict of Interest: none declared.

References

Barbier de Reuille,P. et al. (2015) MorphoGraphX: a platform for quantifying
morphogenesis in 4D. eLife, 4, e05 864.

Devaux,M.F. and Legland,D. (2014). Microscopy: advances in scientiﬁc re—
search and education, chapter Grey level granulometry for histological
image analysis of plant tissues, pages 681—688. Formatex Research Center.

Fernandez,R. et al. (2010) Imaging plant growth in 4D: robust tissue recon-
struction and lineaging at cell resolution. Nat. Methods, 7, 547—5 53.

Landini,G. (2008). Advanced shape analysis with Image]. In Proceedings of
the Second Image] User and Developer Conference, Luxembourg, 6-7
November, pages 116—121.

Ohser,]. and Schladitz,K. (2009). 3D Images of Materials Structures. Wiley—
VCH GmbH 86 Co. KGaA, Weinheim.

Ollion,]. et al. (2013) TANGO: a generic tool for high—throughput 3D
image analysis for studying nuclear organization. Bioinformatics, 29,
1840—1841.

Poulet,A. et al. (2015) Nucleus]: an Image] plugin for quantifying 3D images
of interphase nuclei. Bioinformatics, 3 1, 1144—1146.

Pound,M.P. et al. (2012) CellSeT: novel software to extract and analyze struc-
tured networks of plant cells from confocal images. Plant Cell, 24,
1353—1361.

Prodanov,D. et al. (2006) Automatic morphometry of synaptic boutons of cul—
tured cells using granulometric analysis of digital images. ]. Neurosci.
Methods, 151, 168—177.

Schindelin,]. et al. (2012) Fiji: an open—source platform for biological—image
analysis. Nat. Methods, 9, 676—682.

Schmidt,T. et al. (2014) The iRoCS toolbox—analysis of the plant root apical
meristem at cellular resolution. Plant ]., 77, 806—814.

Silva,].V. et al. (2015) Characterization of the microstructure of dairy systems
using automated image analysis. Food Hydrocolloid, 44, 360—371.

Soille,P. (2003). Morphological Image Analysis, 2nd edn. Springer, New
York.

Tsukahara,M. et al. (2008). Coupled tomography and distinct-element-
method approach to exploring the granular media microstructure in a jam-
ming hourglass. Physical Review E, 77, paper no. 061306.

Vincent,L. and Soille,P. (1991) Watersheds in digital spaces: an efﬁcient algo—
rithm based on immersion simulation. IEEE Trans. Pattern Anal. Mach.
Intell., 13, 583—598.

9103 ‘Og isnﬁnv uo sajeﬁuv soc] ‘Btulomcg JO AJtSJQAtuf] 112 /3.IO'S[BIIJI’IO[pJOJXO'SOIJ’BLUJOJIIIOICI”Zduq 11101} papeolumoq

