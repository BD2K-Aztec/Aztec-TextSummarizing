ORIGINAL PAPER

Vol. 29 no. 6 2013, pages 725—732
doi:1 0. 1093/bioinfonnatics/btt039

 

Genetics and population analysis

Advance Access publication January 30, 2013

Bayesian parentage analysis with systematic accountability
of genotyping error, missing data and false matching

Mark R. Christie*, Jacob A. Tennessen and Michael S. Blouin
Department of Zoology, Oregon State University, Corvallis, OR 97331-2914, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: The goal of any parentage analysis is to identify as many
parent—offspring relationships as possible, while minimizing incorrect
assignments. Existing methods can achieve these ends, but they
require additional information in the form of demographic data,
thousands of markers and/or estimates of genotyping error rates.
For many non-model systems, it is simply not practical, cost-effective
or logistically feasible to obtain this information. Here, we develop
a Bayesian parentage method that only requires the sampled
genotypes to account for genotyping error, missing data and false
matches.

Results: Extensive testing with microsatellite and SNP datasets
reveals that our Bayesian parentage method reliably controls for the
number of false assignments, irrespective of the genotyping error rate.
When the number of loci is limiting, our approach maximizes the
number of correct assignments by accounting for the frequencies of
shared alleles. Comparisons with exclusion and likelihood-based
methods on an empirical salmon dataset revealed that our Bayesian
method had the highest ratio of correct to incorrect assignments.
Availability: Our program SOLOMON is available as an R package
from the CRAN website. SOLOMON comes with a fully functional
graphical user interface, requiring no user knowledge about the R
programming environment. In addition to performing Bayesian parent-
age analysis, SOLOMON includes Mendelian exclusion and a priori
power analysis modules. Further information and user support can
be found at https://sites.google.com/site/parentagemethods/.
Contact: Christim@science.oregonstate.edu

Supplementary information: Supplementary data are available at
Bioinfonnatics online.

Received on September 8, 2012; revised on January 4, 2013;
accepted on January 22, 2013

1 INTRODUCTION

Accurate parentage assignment and pedigree reconstruction are
required to make correct inferences for a broad array of study
questions (Pemberton, 2008). Parentage methods span a vast
gamut of theoretical approaches from fractional to categorical
allocation and simple exclusion to sophisticated likelihood-based
approaches (Jones and Ardren, 2003; Jones et al., 2010). One
area of parentage analysis that has been largely overlooked is a
general Bayesian method for categorical allocation. This void is
unfortunate, as additional sampling or ﬁeld information can be
elegantly incorporated as priors into a Bayesian framework

 

*To whom correspondence should be addressed.

(Hadﬁeld et al., 2006). Furthermore, the information present
within the genotypic data itself can be used to calculate a prior
analogous to a false discovery rate, which can be useful for the
challenges associated with parentage analysis. As an illustrative
example, consider a typical kinship dataset consisting of seven
microsatellite loci and 750 individuals (Rieseberg et al., 2012). In
this dataset, a parent and an offspring would share at least one
allele across all loci following Mendelian inheritance. However,
the probability of two unrelated individuals sharing alleles by
chance at all loci is not trivial considering that hundreds of thou-
sands of pairwise comparisons are required. Thus, a primary
challenge of parentage analysis in natural populations is to cor-
rectly identify the true parentioffspring pairs within a dataset,
while simultaneously excluding any pairs that share alleles by
chance.

The challenge of parentage analysis is further exacerbated by
missing data and genotyping errors, which can erode the parenti
offspring ‘signal’ of sharing at least one allele at all loci
(Slate et al., 2000; Vandeputte et al., 2006). Because errors can
create an incorrect record of genotypes, true parentioffspring
pairs in an empirical dataset may not share an allele at all loci
despite that being the Mendelian expectation. Here, we address
the challenges associated with parentage analysis by ﬁrst calcu-
lating the prior probability of a dyad sharing an allele across all
numbers of mismatching loci. The calculation of this prior
(analogous to a false discovery rate) creates a systematic frame-
work for determining how many loci to let mismatch and does
not require any estimates of genotyping error. For each putative
pair, we next use Bayes’ theorem to calculate the posterior prob-
ability of a parentioffspring pair being false given the frequencies
of shared alleles. Because the probability of sharing common
rather than rare alleles is much greater for unrelated pairs, we
can compare the frequencies of observed shared alleles to a dis-
tribution of alleles shared by unrelated individuals. By combining
this information with Bayes’ theorem, we can maximize the iden-
tiﬁcation of true parents and offspring in a dataset, while mini-
mizing the number of false assignments. Here, we overhaul the
approach of Christie (2010) to (i) account for genotyping error
and missing data, (ii) reduce the computational time by up to
three orders of magnitude as measured in minutes and (iii) allow
for one known parent or for known parent pairs (i.e. known
matings), which can substantially increase assignment power.
We extensively test this methodology with data drawn from
three empirical studies and use an empirical salmon dataset to
make comparisons with commonly implemented exclusion and
likelihood-based methods.

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 725

112 /310's112u1n0[p10}x0"sotJBuiJOJutotq/ﬁduq 11101} papBOIII/lAOG

91oz ‘Og anﬁnV uo ::

M.R.Christie et al.

 

2 METHODS

We created test datasets of multilocus genotypes with allele
frequencies based on the site frequency spectra from three
empirical studies. We chose empirical studies featuring three
distinct taxonomic groups with two different marker types,
SNPs and microsatellites (Table 1). The test datasets were fully
characterized, such that we knew all true parents and offspring.
For drawing comparisons between methods, we used complete
genotype data from a summer-run steelhead (Oncorhynchus
mykiss) dataset (see details later in the text).

2.1 Bayesian parentage method

To identify true parentioffspring pairs, we used Bayes’ theorem
to determine the posterior probability of a putative parentioff-
spring pair being false given the frequencies of shared alleles. For
illustrative purposes, we first consider a scenario with no missing
data, genotyping error or known parents, although we expand
on each of these later in the text. In accordance with Mendelian
expectation, each parentioffspring pair will share at least one
allele across all loci. If a limited number of loci are used, then
pairs of individuals can share alleles by chance alone. In fact, the
rate of false matching increases exponentially with a linear
increase in sample size (Christie, 2010). We first calculate a
prior equal to the probability of any given putative pair sharing
alleles by chance:

Fpairs

Pr(¢) : Nputative

(1)
where Fpairs equals the expected number of false parentioff-
spring pairs, and Nputative equals the total number of putative
parentioffspring pairs. Here, we deﬁne a ‘false parentioffspring
pair’ to be a pair of unrelated individuals that share alleles by
chance. A ‘putative parentioffspring pair’ is any pair of individ-
uals that share alleles across all loci and contain all true and false

Table 1. Empirical datasets used to validate the Bayesian parentage
method

 

Symbol Species Marker NL NA Max

 

European Beech usat 13 11.08 0.66
(Fagus sylvatica)

Steelhead Trout usat 8 34.88 0.19
(O.mykiss)

Labrador Retriever SNP 21 115 2.00 0.98
(Cam's lupus (200)
ﬁlm iliarus)

 

 

NL refers to the total number of loci used in the study, NA equals the average
number of alleles per locus and Max equals the frequency of the most common
allele in the dataset. The retriever dataset had 21 115 SNPs of which 200 were
randomly selected. References are as follows: beech (Lander et (1]., 2011), steelhead
(Araki et (1]., 2007) and retriever (Akey et (1]., 2010).

parentioffspring pairs. Thus, if a dataset was expected to contain
10 pairs that shared alleles by chance, but was observed to
contain 100 pairs, then Pr(¢) would equal 0.1. Estimates for
Pr(¢) are constrained to range between 0 and 1. To calculate
the expected number of false pairs in a dataset, we deviate
from the approach presented in Christie (2010) and use simula-
tions rather than allele frequencies. We chose to use simulations
because they (i) facilitate the incorporation of genotyping error
into a Bayesian framework and (ii) substantially expedite the
calculation of the posterior probability.

To determine the expected number of false pairs, we ﬁrst cal-
culate allele frequencies across all loci. For each locus separately,
we calculate genotype frequencies in accordance with Hardyi
Weinberg equilibrium (HWE) and create a pool of genotypes
where the rarest genotype occurs at least 100 times. We next
create simulated genotypes by sampling from this pool a
number of individuals equal to the number genotyped in the
empirical dataset (randomly assigning individuals as adults and
juveniles). We then make all pairwise comparisons between
adults and juveniles and calculate the number of times each
allele is shared. If a shared allele is homozygous in an individual,
then that allele is only counted once. If an adult and a juvenile
are heterozygous for the same alleles, then only the rarer of the
two alleles is counted. The number of times that an allele is not
shared between an adult and a juvenile is also recorded. The user
may choose how many simulated datasets per locus that they
wish to use, although we recommend a minimum of 100 simula-
tions for SNPs and 1000 simulations for microsatellites to maxi-
mize precision for the posterior probability (Supplementary
Table S1). In the simulations, we examine each locus separately
to expedite the calculation and reduce the amount of memory
allocated by R (R Core Team, 2012).

We next create a user-deﬁned number of multilocus ‘geno-
types’ by using the output of the simulations (‘simulated geno-
types’). Assuming independence across loci, we sample alleles at
each locus by the average frequencies that they were observed to
be shared between two unrelated individuals. Included in the
sampling process is a dummy variable that represents the fre-
quency of dyads that did not share an allele. This process sim-
ultaneously creates a distribution of frequencies of alleles shared
among false parentioffspring pairs, while also creating a distri-
bution of the number of false pairs that share at least one allele at
0, 1, 2. . . L loci, where L equals the total number of genotyped
loci. We calculate the expected number of false pairs as

Fpairs = NLsim - n1 - n2 (2)

where NLsim equals the frequency of the simulated multilocus
genotypes that shared at least one allele at all loci and m and n2
equal the empirical sample sizes of the adults and juveniles. After
Fpairs is calculated, the number of observed putative pairs
(Nputative) is calculated using Mendelian incompatibility and
used to calculate the prior, Pr(¢).

Most, if not all, observed false pairs will share common alleles,
as the probability of sharing an allele by chance is approximately
proportional to the square of the allele frequency. In contrast,
the probability that a true parentioffspring pair will share a
particular allele is simply proportional to the allele frequency.
Therefore, pairs sharing rare alleles are much more likely to be

 

726

112 /3.IO'S[BIIJHO[pJOJXO'SOIIBLUJOJIIIOICI”K1111] 11101} papBOIH/noq

9103 ‘Og isanV uo ::

Bayesian parentage analysis

 

true parenteoffspring pairs. We exploit this principle by using
Bayes’ theorem to calculate the probability of a putative par-
enteoffspring pair being false given the frequencies of shared
alleles:

Pr(?~|¢) - Pr(¢)
Pr(?~|¢) - Pr(¢) + Pr(?~l¢c) - Pr(¢c)

where Pr(¢) is calculated as described earlier in the text, and
Pr(¢c) is the complement. Pr(A|¢) equals the probability of shar-
ing the observed alleles given that the putative pair in question is
false. We calculate this value for each putative pair using the
multilocus ‘genotypes’ where each locus contains values equal
to the frequencies of alleles shared by false pairs. To create a
distribution of frequencies of shared alleles among false parente
offspring pairs, we multiply these values across all loci (‘false-pair
products’). We similarly calculate the product of the shared allele
frequencies among all putative parenteoffspring pairs
(‘putative-pair products’). To calculate Pr(A|¢) for each putative
pair, we count the number of false-pair products that were less
than or equal to the observed putative-pair product and divide
by the total. Notice that when a putative pair shares the most
common alleles across all loci that Pr(A|¢) = 1, and consequently
Pr(¢|A) = Pr(¢). To calculate Pr(A|¢C), which is the probability
of sharing alleles given that a putative pair is true, we used the
same approach, but we use the observed allele frequencies rather
than the frequencies at which alleles were shared.

Pr(¢|)~) =

 

(3)

2.2 Genotyping error

Using the simulations, we calculate Pr(¢) for every number of
mismatching loci (0,1,..,L). When Pr(¢) equals unity, the ex-
pected number of false pairs equals the total number of putative
pairs within the dataset. Mathematically speaking, when the
prior Pr(¢) equals one, the posterior, Pr(¢|A), also equals 1.
Consequently, when Pr(¢) is equal to 1, there is insufﬁcient
power to distinguish between true and false parenteoffspring
pairs (Fig. 1). In high-power datasets, the expected number of
false parenteoffspring pairs will be low for the first several mis-
matching loci. SOLOMON calculates Pr(¢) for every number of
mismatching loci and calculates Pr(¢|A) for all putative pairs
where Pr(¢) is <1. Notice that the number of loci allowed to
mismatch depends on the genotyping error rate and the power
of the dataset. If a dataset has no genotyping error, then Pr(¢)
will equal 1 when allowing a single locus to mismatch because the
expected number of false pairs will equal the total number of
putative pairs (i.e. all true pairs will not mismatch at a locus, and,
consequently, all putative pairs will be false pairs for a positive
number of mismatching loci). Conversely, if the same dataset has
a high rate of genotyping error, then there will be more true pairs
mismatching at a single locus. When there are more true pairs,
the total number of putative pairs will increase, and Pr(¢) will be
<1 provided that the expected number of false pairs is low, and
the locus will be allowed to mismatch (Fig. 1). Thus, the number
of loci allowed to mismatch is dictated by the genotyping error
rate and the expected number of false pairs. In the aforemen-
tioned framework, missing data are simply treated as a mis-
match, as there is no way to know whether a putative pair
would have shared an allele where an individual is missing
data. Null alleles can be accounted for by loading in adjusted

 

No error error = 3%
10000. ’_.____ P--- -.§=_!
I . ’ .3
1000- I - . I _g
I ’ a
‘ _ 'o

100-

0'2

 

 

1.0 do

Pr(¢) (dashed line}

 

0'5 6.3

0'»

   

Number of Pairs [points]

 

 

110 do 6.2

015 6.3

 

 

 

 

 

on 6.2 (£4

 

éiiéxibiiééi

Number ofMismatching Loci Number of Mismatching Loci

Fig. 1. Number of observed putative (Nputative, green points) and ex-
pected false (Fpairs, brown points) parentwffspring pairs in the test
datasets derived from three empirical studies (Table 1). The left-hand
plots represent datasets with no genotyping error, and the right-hand
plots represent datasets with 3% genotyping error. Each panel represents
100 test datasets with 100 adults, 100 juveniles and 50 true parentmff-
spring pairs. The dashed line corresponds with the right-hand axis and
represents the prior probability of a putative parentwffspring pair occur-
ring by chance, Pr(¢), estimated as Fpairs/Nputative. The number of true
parentwffspring pairs is estimated as the difference between Nputative
and Fpairs. Thus, whenever Nputative is greater than Fpairs, Pr(¢) is <1,
and a nonzero proportion of true parentmffspring pairs may be inferred

estimates of allele frequencies from programs that specialize with
such data types (e. g. MICROCHECKER, van Oosterhout et al.,
2006). To our knowledge, this is the ﬁrst parentage method that
can account for genotyping errors without needing estimates of
the genotyping error rate.

2.3 Microsatellites versus SNPs

Using hundreds of thousands to millions of SNPs can allow for the
elucidation of first, second and third order relatives (Manichaikul
et al., 2010). Nevertheless, for most species, it is not yet cost effect-
ive to genotype hundreds or thousands of individuals at so many
markers. SOLOMON cannot expediently process millions of
SNPs, but it can accommodate large SNP datasets by performing
a priori power analyses to determine a minimum number of SNPs
for the given sample sizes to capture all true parenteoffspring
pairs. After a conservative number of SNPs are determined, the
appropriate number of loci can be selected.

 

727

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} papBOIH/noq

91oz ‘Og isanV uo ::

M.R.Christie et al.

 

The precision associated with the posterior probabilities is
increased by increasing the number of simulated datasets and
genotypes. Because of the greater number of alleles and lower
numbers of loci typically found in microsatellite studies, these
markers require more simulations than SNPs for comparable
levels of precision (Supplementary Table S1 for details and
guidelines).

2.4 Validation

We use hypothesis-testing nomenclature to deﬁne the null hy-
pothesis as no relationship between a putative parenteoffspring
pair (i.e. the pair is unrelated). In this framework, a type I error
occurs when a putative pair is unrelated, but are falsely identiﬁed
as a true pair for a given alpha. For example, a type I error
would occur if alpha was set to 0.05 and an unrelated adult
and juvenile were assigned a Pr(¢|A) value <0.05. Because
lower Pr(¢|A) values represent a reduced probability of sharing
alleles by chance, a lower posterior probability represents a
reduced probability of committing a type I error. For most meth-
ods, the type I error should be less than or equal to the chosen
alpha, else too many alternative hypotheses will be falsely ac-
cepted. A type II error occurs when a true parenteoffspring
pair is not identiﬁed for a given alpha (i.e. Pr(¢|A)>a for a
true parenteoffspring relationship). We determined the proper-
ties of our method by measuring the type I and type II errors
across a range of alpha levels.

To examine the relationship between alpha and type I and II
errors, we used the per locus allele frequencies from the empirical
studies (Table 1) to construct test datasets. For each of the three
empirical studies, we created 100 test datasets with 100 adults,
100 juveniles and 50 true parenteoffspring pairs. The adult and
juvenile genotypes were created in accordance with HWE. The
parents and offspring were created by randomly selecting 50
adults and 50 juveniles and, for each pair, randomly copying
one allele from the adult to the juvenile at each locus. For
each of the 100 test datasets, the posterior probabilities were
calculated, and type I and type II errors were identified.
Precision of the posterior probability was calculated by measur-
ing the range of posterior probabilities across identical pairs
from 100 replicate runs of a single test dataset from each of
three study species (Supplementary Table S1). We also created
test datasets with varied numbers of unrelated individuals and
offspring per parent (Supplementary Tables S2 and S3).

We examined the effects of genotyping error by introducing
errors into the test datasets. We deﬁned the genotyping error rate
as the proportion of all alleles that were called incorrectly (Bonin
et al., 2004; Pompanon et al., 2005). To add error to the test
datasets, we randomly sampled a single allelic position from the
multilocus dataset. We treated the dataset as a matrix with
m rows and n columns and randomly selected allele am". We
next replaced allele am” with a randomly selected allele from
the same locus. This process was repeated until the desired gen-
otyping error rate was obtained. Because alleles were randomly
selected, an allele chosen to contain an error could be replaced
with the same allele. We chose genotyping error rates of 0, 0.005,
0.01 and 0.03 because they encompass the average documented
error rates for SNPs and microsatellites (Pompanon et al., 2005;
Saunders et al., 2007).

2.5 Number of known parents

The approach presented earlier in the text is general in that no
information about the sample of adults is required. We expanded
the aforementioned approach to two speciﬁc parentage applica-
tions. First, we expanded the method to situations where one
parent is known and it is possible to genotype the known
parent and their offspring. For example, many young mammals
remain closely associated with their mothers. After genotyping
both the mother and their offspring, it is possible to exclude the
maternal alleles from the offspring. This reduces the number of
alleles to search for in putative fathers and can greatly increase
the power for assignment (Jamieson and Taylor, 1997). Second,
we expanded the approach to include known parent pairings,
where it is known which males mated with which females. For
example, captive breeding and livestock programmes often spe-
ciﬁcally cross certain males with females and keep detailed re-
cords of such pairings. Knowing which females and males are
paired can substantially increase assignment power because it (i)
reduces the number of pairwise comparisons and (ii) each allele
in the offspring must match one allele in each parent. To allow
researchers to take advantage of the increased power and
reduced type I error from such study designs, we appropriately
modiﬁed the simulation and posterior probability calculation al-
gorithms. We tested these modiﬁed approaches with 100 test
datasets created from the European beech study because it had
the lowest power of the three datasets (and thus the most to gain
from additional information). For validation purposes, we set
the genotyping error rate to 1% and created motherefather
pairs (100 mothers:100 fathers), each of which produced a
single offspring.

2.6 Siblings and other relatives

Although full-siblings differ from parents and offspring in the
way that alleles are shared by descent (Blouin 2003), they can
share alleles across large numbers of loci, particularly when
including alleles that are shared by chance. This is only a concern
if full-siblings occur in both the sampled adults and juveniles (e. g.
species with lengthy and overlapping generation times), and if
they occur at high frequency. To account for full-siblings, we
additionally calculate a modiﬁed Bayesian prior that
includes alleles that are both identical-by-state and identical-
by-descent. This modiﬁcation results in a more conservative
test that prevents full-siblings from being assigned as parenteoff-
spring pairs. We tested both the modiﬁed and unmodiﬁed ap-
proach on datasets as described earlier in the text, but where we
introduced pairs of full-siblings as 5, 15, 25 and 50% of the
sampled individuals. Additionally, we tested whether more
distant kinship pairs (e.g. aunts/uncles to nieces/nephews,
half-siblings) would be falsely identiﬁed as parenteoffspring
pa1rs.

2.7 Comparison with existing methods

We next analysed empirical data by examining paternity assign-
ments for 4 run-years of summer-run steelhead collected from
the Hood River, OR, USA. This is a new dataset that has not
been previously analysed. Tissue samples from all returning
anadromous steelhead were collected, as the fish were passed

 

728

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} papBOIH/noq

91oz ‘Og isanV uo ::

Bayesian parentage analysis

 

over the Powerdale dam en route to their spawning grounds. The
dam was a complete barrier to migrating fish. All 1702
summer-run steelhead were genotyped at the same eight poly-
morphic loci used in the winter-run steelhead examples
previously mentioned (Araki et al., 2007). This dataset presents
a rigorous test for two reasons. First, not all candidate fathers
were sampled because resident steelhead (i.e. rainbow trout) that
remained above the dam could also have sired offspring (Christie
et al., 2011). Second, any given offspring may have aunts and
uncles competing for parentage assignments (Olsen et al., 2001).

Direct and equitable comparisons between parentage methods
can be challenging because each method represents different
theoretical approaches. Furthermore, each method often makes
different assumptions and requires different input information.
We ﬁrst used Mendelian incompatibility (exclusion) to assign
offspring to putative fathers. We allowed one locus to mis-
match to account for genotyping error. We next employed the
most-frequently used parentage program, CERVUS 3.03
(Kalinowski et al., 2007; Marshall et al., 1998), to perform the
same assignments. CERVUS uses a simulation procedure to de-
termine the signiﬁcance of log-likelihood scores for candidate
parenteoffspring pairs. This program requires the estimates of
three parameters: (i) the number of candidate parents, (ii) the
proportion of candidate parents sampled and (iii) the genotyping
error rate. Because we did not have estimates of these parameters
(they require substantial observational data), we set the number
of candidate parents to the number of adults sampled in our
dataset and chose a small and large proportion of candidate
parents sampled (0.1 and 0.9, respectively). We set our genotyp-
ing error rate to 1%, which is the default setting, and included
assignments with 95% or higher conﬁdence. Finally, we used
SOLOMON to analyse the same sets of samples, using an
alpha of 0.05.

To verify our assignments with these three methods, we geno-
typed all individuals at five additional microsatellite loci (see
Supplementary Material for details). To determine which pairs
were definitively true, we performed exclusion at all 13 loci and
allowed for one locus to mismatch. For matches at both 12 and
13 loci, the average expected number of false pairs was <1. For
all three methods, we measured the total number of assignments
and the total number of correct assignments as determined by
comparison with the pairs identified with the additional loci.

3 RESULTS
3.1 Validation

For all three empirical studies used to generate test datasets, the
type I error rate was always equal to or less than the desired
alpha (Fig. 2). The beech datasets had the highest type II error
rate (lowest power) of the three studies. The steelhead datasets
had a lower type II error rate, despite having five fewer loci than
the beech study. Thus, in these two cases, increased marker poly-
morphism resulted in greater power for parentage analysis than
did additional loci. Finally, the retriever study with 200 SNPs
had the lowest type II error rate (highest power), further con-
ﬁrming that SNPs can be useful markers for parentage analysis
(Anderson and Garza, 2006). The inherent tradeoffs between
type I and II errors revealed that there is a marked decrease in

 

0.00 0.02 0.04 0.06 0.08 0.10 0.12

 

 

 

ﬂ 23.30% ,. —
3 .1.0% v— '5‘
E .0590 g
G g_.0.0% - 8
'U
2 a
U: -
1' \q_ g
E 0 2
[‘3 - u“;
a: t. E
a o e
l— ' I—

"ta

0 _

0.- -

CI

 

 

| I I l

0.00 0.02 0.04 0.06 0.08 0.10 0.12 0-00 0.02 0.04 0.06 0.08 0.10 0.12

 

 

 

 

Alpha

Fig. 2. The relationship between alpha and the type I and 11 error rate.
Genotyping error rates were varied from 0 to 3% (line order corresponds
to legend order). Each panel represents 100 test datasets with 100 adults,
100 juveniles and 50 true parentwffspring pairs. The maximum observed
type I error was plotted as a dashed grey line. Type I error is consistently
at or below or (solid line), indicating that our method is conservative and
does not produce an excess of false-positive parentmffspring pairs. For
the steelhead and Labrador retriever datasets, an increase in alpha
beyond 0.05 recovers few additional true parentwffspring pairs. The
lowest alpha value plotted is 0.001, and the 0.5% genotyping error was
omitted from the retriever dataset for visual clarity. See Supplementary
Figure S] to View these results on a logarithmic scale

 

729

112 /310's112u1n0fp10}x0"soiwurJOJuioiq/ﬁduq 11101} papBOIH/noq

91oz ‘Og isanV uo ::

M.R.Christie et al.

 

type II error (increase in power) by changing the alpha threshold
from 0.001 to 0.01. Further increases in alpha from 0.01 to 0.1
yielded marginal increases in power for the steelhead and re-
triever datasets, but it provided consistent increases in power
for the beech dataset. In general, a good tradeoff between type
I and II errors can be obtained by setting alpha at 0.05, but this
value should ultimately be decided by weighing the relative risks
of committing type I and II errors for a particular study (Sokal
and Rohlf, 1994). Not surprisingly, the likelihood of committing
type I errors increases with low-power datasets that have high
values for the prior. As such, we recommend reporting both the
prior and posterior probabilities.

In all three datasets, genotyping error increased the number of
type II errors. Because the retriever dataset could allow for the
greatest number of mismatching loci (Fig. 1), this dataset was the
least affected by genotyping error. In general, genotyping error
rates of 0.005 or 0.01 did not drastically increase the type II error
rate. A genotyping error rate of 3%, however, did result in sub-
stantial increases in type II error for all three datasets. We further
examined the tradeoff between genotyping error rates and power
in the retriever dataset. All datasets, regardless of the genotyping
error rate, identiﬁed all true parenteoffspring pairs with 250 loci
(Fig. 3). As expected, the number of loci required to identify all
true parenteoffspring pairs increased with an increase in the
genotyping error rate.

Additional samples of a single known-parent or information
about putative parent pairings greatly reduced the type I and II
error rates (Fig. 4). Both the type I and type II errors were
highest when no known parents were sampled. Having a
known sample of one of the parents or knowing the parent
pairs reduced the type II error by nearly 60% for the beech
study. Thus, when possible, we recommend collecting this add-
itional data to maximize power for parentage analysis.

 

 

 

 

 

 

E ca-

E .—

E .Noerror
w .0590
E nee 01.0%
,3: O 03.0%
U

E

I—

O ‘0._

U 0

V1

3:.

TU

0' e-

3 cs-

‘—

H

H—

o

g, 04..

m C

H

c

w

E o

(I) 0" .-
n- I I I I I I I

50 100 150 200 250 300 350
Number of SNPs

Fig. 3. Relationship between the number of used SNPs and the percent-
age of true parentwffspring pairs that were correctly identiﬁed in the
retriever datasets. Genotyping error rates were varied from 0 to 3%,
and all parentwffspring pairs were correctly identiﬁed with 250 SNPs
(line order corresponds to legend order). Notice that small amounts of
error do not substantially affect the assignment rate with intermediate
numbers of loci

In general, pairs of simulated full-siblings that were split be-
tween adult and juvenile ﬁles did not get assigned in large num-
bers until they represented >25% of the individuals in a dataset
(Supplementary Table S4). Adjusting the prior for alleles that
were identical-by-state as well as those that were identical-
by-descent resulted in fewer sibling pairs identiﬁed with a pos-
terior probability <0.05 (Supplementary Table S5). Accounting
for alleles that are identical-by-descent comes at the cost of as-
signing true parents, as it can be difﬁcult to distinguish between
full-siblings and parenteoffspring pairs with genotyping errors
with limited numbers of loci. As such, we recommend using
the modified sibling approach only when large numbers of sib-
lings are expected to be sampled. Other levels of relationship that
share fewer alleles than full-siblings (e. g. aunts/ uncles to nieces/
nephews) were not falsely identiﬁed using the unmodiﬁed
approach.

3.2 Empirical data

Across all 4 run-years of our summer-run steelhead dataset, we
found that using simple exclusion for seven of eight loci
(i.e. allowing one locus to mismatch) resulted in a high type I
error rate. Using exclusion, 349 offspring were assigned to a
father, of which 213 were later confirmed to be true assignments
with genotyping at the five additional loci (Table 2). Thus, ex-
clusion produced 136 false assignments, yielding a type I error
rate of 0.39. CERVUS had type I error rates of 0.22 and 0.49
when we set the estimates of the proportion of candidate parents
sampled to 0.1 and 0.9, respectively. In contrast, SOLOMON
had a type I error rate of 0.029 for an alpha set to 0.05.
Consistent with the results from the test datasets (Figs 2 and
4), varying the alpha in this empirical dataset resulted in an

 

1.0

- O No known parents
4:— . Parent—pairs known

0 One parent known

0.00 0.02 0.04 0.06 0.08 0.10 0.12

Type II Error (ﬁlled circles}
Type I Error {dashed lines}

 

 

 

 

Fig. 4. The relationship between alpha and the typeI and 11 error rate for
three parentage scenarios: no known parents (orange circles), known
parent pairs (blue circles) and one known parent (brown circles).
Notice that type I and II errors are reduced, as additional parentage
information is used. For each parentage scenario, 100 test datasets
were constructed with 100 adults, 100 juveniles and 100 true parentwff-
spring pairs

 

730

112 /310's112u1n0fp10}x0"soiwurJOJuioiq/ﬁduq 11101} papBOIH/noq

9103 ‘Og isanV uo ::

Bayesian parentage analysis

 

Table 2. Comparison of exclusion, CERVUS and SOLOMON on a
summer-run steelhead dataset

 

 

Run-year Adults/ Method Assigned Correct
juveniles

2001 20 1 / 227 Exclusion 79 3 8

2001 201/227 CERVUS 35 (98) 23 (37)

2001 201/227 SOLOMON 29 27

2002 343/285 Exclusion 141 90

2002 343/285 CERVUS 47 (151) 39 (78)

2002 343/285 SOLOMON 63 61

2003 144/216 Exclusion 73 49

2003 144/216 CERVUS 44 (83) 34 (49)

2003 144/216 SOLOMON 28 28

2004 90/ 196 Exclusion 56 36

2004 90/ 196 CERVUS 32 (65) 27 (35)

2004 90/ 196 SOLOMON 20 20

All years 778/924 Exclusion 349 213

All years 778/924 CERVUS 158 (397) 123 (199)

All years 778/924 SOLOMON 140 136

 

Adults/juveniles column represents the sample sizes of adults and their putative
offspring, respectively. Assigned refers to the total number of assignments.
Correct refers to the number of assignments that were correct after genotyping all
putative pairs at ﬁve additional loci. For CERVUS, we estimated the proportion of
candidate parents sampled to be 0.1 or 0.9, although we did not possess demo—
graphic estimates of this parameter (results for 0.9 are presented in parentheses).
Using more moderate values for the proportion of candidate parents sampled (e.g.
0.05) did not improve performance.

observed type I error less than or equal to alpha in all 4 years
(Supplementary Table S6). It is worth noting that in some years,
CERVUS had a higher number of false assignments than exclu-
sion because the program sometimes allowed for up to two loci
to mismatch.

Previous studies have shown that the performance of
CERVUS is robust, and we suspect that the possible presence
of aunts and uncles among the candidate parents coupled with
unknown numbers of sampled parents provided challenging con-
ditions. In general, SOLOMON performed favourably by mini-
mizing the number of false assignments while maximizing the
number of correct assignments (Table 2).

4 DISCUSSION

Accurate parentage assignments are necessary to appropriately
address a wide range of research questions (Jones and Ardren,
2003; Pemberton, 2008). Here, we provide a Bayesian method
that can account for genotyping error, missing data and false
matches without requiring estimates of any non-genetic param-
eters (i.e. all analyses simply use the provided genotypic data).
These methods can be applied to a broad array of datasets ran-
ging from samples of large wild populations with unknown num-
bers of sampled parents to carefully controlled crosses with
detailed pedigree records. To our knowledge, this is the ﬁrst
parentage program that does not require direct estimates of gen-
otyping error. This solution represents a signiﬁcant advance be-
cause choosing the appropriate method for estimating
genotyping error rates can be ambiguous and is further

obfuscated by the different types of genotyping errors that can
occur (Pompanon et al., 2005). Furthermore, the estimation of
error rates typically involves the genotyping of additional (or
duplicate) samples, which is costly from both a time and mon-
etary standpoint. Because this method was designed with a null
hypothesis of no relationship, it may not be ideally suited for
datasets with large numbers of related individuals (e. g. full-sibs).
Future improvements could include specifying different null
hypotheses of relationship and evaluating them in a
likelihood-based framework.

Our analyses revealed that, for a given dataset, the Bayesian
approach appropriately minimizes false assignments while max-
imizing the number of correct assignments. The number of true
parenteoffspring relationships correctly identiﬁed depends on the
sample sizes, the number of loci, the allele frequencies and the
genotyping error rate. For a given marker set, larger sample sizes
rapidly increase the number of pairs that share alleles by chance
(Christie 2010), and increases in genotyping error can diminish
power (Figs 2 and 3). Furthermore, the number and frequency
distribution of alleles at each locus contribute to the rate of false
matching. Uniform allele frequencies result in the greatest power
for parentage analysis, but they are rarely observed in genetic
markers. On the other hand, SNPs with a minor allele frequency
<1% will contribute little information to the elucidation of par-
enteoffspring pairs. Given the multitude of factors that contrib-
ute to false matching and reduced power, we suggest that
researchers conduct a priori power analyses before designing a
study that involves parentage analysis. Such power analyses can
dictate precisely how many loci would be required for given
sample sizes.

We provide a module for a priori power analysis as part of our
program SOLOMON, which is available as a freely distributable
R package (R Development Core Team, 2012) from the CRAN
website: http://cran.r-project.org/web/packages/. SOLOMON is
run with a graphical user interface written with the TCL/TK
package provided by R. SOLOMON performs the described
Bayesian parentage analysis for datasets with no known parents,
one known parent or known parent pairs. Using an Intel core
i7TM processor with 8 GB of random access memory, the average
run-time was 11 min for the beech datasets, 8 min for the steel-
head dataset and 13 min for the retriever dataset (with larger
sample sizes resulting in increased run times). Furthermore, the
program performs exclusion for the three types of parentage
analysis, and the exclusion interfaces allow for user-deﬁned num-
bers of loci to mismatch. In summary, the Bayesian approach
implemented in SOLOMON can be applied to a wide variety of
datasets, resulting in robust parentage assignment.

ACKNOWLEDGEMENTS

The authors acknowledge Zaid Abdo, Chris Sullivan and the
Center for Genome Research and Biocomputing at Oregon
State University for helpful contributions. They also thank the
reviewers for comments that greatly beneﬁted this manuscript.

Funding: Bonneville Power Administration (to M.S.B.).

Conﬂict of Interest: none declared.

 

731

112 /3.10's112u.m0fp.101x0"soiwurJOJHioiq/ﬁduq 111011 pap201umoq

9103 ‘0g1sn8nv uo ::

M.R.Christie et al.

 

REFERENCES

Akey,J.M. et al (2010) Tracking footprints of artiﬁcial selection in the dog genome.
Proc. Natl. Acad. Sci. USA, 107, 116(F1165.

Anderson,E.C. and Garza,J.C. (2006) The power of single—nucleotide polymorph—
isms for large—scale parentage inference. Genetics, 172, 25672582.

Araki,H. et al (2007) Reproductive success of captive—bred steelhead trout in the
wild: evaluation of three hatchery programs in the Hood river. Conserv. Biol,
21, 1817190.

Blouin,M.S. (2003) DNA—based methods for pedigree reconstruction and kinship
analysis in natural populations. Trends Ecol. Evol, 18, 5037511.

Bonin,A. et al (2004) How to track and assess genotyping errors in population
genetics studies. Mol Ecol, 13, 326173273.

Christie,M.R. (2010) Parentage in natural populations: novel methods to detect
parent—offspring pairs in large data sets. Mol Ecol. Resour., 10, 1157128.

Christie,M.R. et al (2011) Who are the missing parents? Grandparentage analysis
identiﬁes multiple sources of gene ﬂow into a wild population. Mol Ecol, 20,
126371276.

Hadfield,J.D. et al (2006) Towards unbiased parentage assignment: combining gen—
etic, behavioural and spatial data in a Bayesian framework. Mol Ecol, 15,
371573730.

Jamieson,A. and Taylor,S.S. (1997) Comparisons of three probability formulae for
parentage exclusion. Anim. Genet., 28, 3974100.

Jones,A.G. and Ardren,W.R. (2003) Methods of parentage analysis in natural
populations. Mol Ecol, 12, 251172523.

Jones,A.G. et al (2010) A practical guide to methods of parentage analysis. Mol
Ecol. Resour., 10, (r30.

Kalinowski,S.T. et al (2007) Revising how the computer program CERVUS
accommodates genotyping error increases success in paternity assignment.
Mol Ecol, 16, 109971106.

Lander,T.A. et al (2011) Reconstruction of a beech population bottleneck using
archival demographic information and Bayesian analysis of genetic data. Mol
Ecol, 20, 518275196.

Manichaiku1,A. et al (2010) Robust relationship inference in genome—wide associ—
ation studies. Bioinformatics, 26, 286772873.

Marshall,T.C. et al (1998) Statistical conﬁdence for likelihood—based paternity
inference in natural populations. Mol Ecol, 7, 639$55.

Olsen,J.B. et al (2001) The aunt and uncle effect: an empirical evaluation of the
confounding influence of full sibs of parents on pedigree reconstruction.
J. Hered., 92, 2437247.

Pemberton,].M. (2008) Wild pedigrees: the way forward. Proc. Biol. Sci., 275,
6137621.

Pompanon,F. et al (2005) Genotyping errors: causes, consequences and solutions.
Nat. Rev. Genet, 6, 8477859.

Rieseberg,L. et al (2012) Editorial 2012. Mol Ecol, 21, 1722.

Saunders,I.W. et al (2007) Estimating genotyping error rates from Mendelian
errors in SNP array genotypes and their impact on inference. Genomics, 90,
2917296.

Slate,J. et al (2000) A retrospective assessment of the accuracy of the paternity
inference program CERVUS. Mol Ecol, 9, 8017808.

Sokal,R.R. and Rohlf,F.J. (1994) Biometry, 3rd edn. W.H. Freeman, New York,
USA.

van Oosterhout,C. et al (2006) Estimation and adjustment of microsatellite null
alleles in nonequilibrium populations. Mol Ecol. Notes, 6, 2557256.

Vandeputte,M. et al (2006) An evaluation of allowing for mismatches as a way to
manage genotyping errors in parentage assignment by exclusion. Mol Ecol.
Notes, 6, 2657267.

 

732

112 /310's1eu1nofp101x0"serieurJOJHioiq/ﬁduq 111011 papeo1umoq

9103 ‘0g1sn8nv uo ::

