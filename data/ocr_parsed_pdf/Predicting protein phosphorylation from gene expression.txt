Vol. 31 no. 4 2015, pages 462—470
doi:10. 1093/bioinfonnatics/btu490

ORIGINAL PAPER

 

Systems biology

Advance Access publication July 23, 2014

Predicting protein phosphorylation from gene expression: top
methods from the IMPROVER Species Translation Challenge

Adel Dayarianl'l, Roberto Romeroz‘l, Zhiming Wang3'4'l, Michael Biehls, Erhan BilaIB,
Sahand Hormozl, Pablo MeyerB, Raquel NoreIB, Kahn thissorrakraia, Gyan Bhanot7'*,
Feng Luo4'* and Adi L. Tarca2'8'*

1Kavli Institute for Theoretical Physics, Kohn Hall, University of California, Santa Barbara, CA 93106, 2Perinatology
Research Branch, Eunice Kennedy Shriver National Institute of Child Health and Human Development, NIH, Bethesda,
MD, and Detroit, MI 48201, USA, 3College of Plant Protection and College of Science, Hunan Agricultural University,
Changsha, 410128, China, 4School of Computing, Clemson University, Clemson, SC 29634, USA, 5Johann Bernoulli
Institute for Mathematics and Computer Science, University of Groningen, 9700 AK Groningen, The Netherlands, 6IBM
T.J. Watson Research Center, Computational Biology Center, Yorktown Heights, NY 10003, 7Department of Molecular
Biology and Biochemistry, Department of Physics and BioMaPS Institute, Rutgers University, Piscataway, NJ 08854 and

8Department of Computer Science, Wayne State University, Detroit, MI 48202, USA

Associate Editor: Igor Jurisica

 

ABSTRACT

Motivation: Using gene expression to infer changes in protein phos-
phorylation levels induced in cells by various stimuli is an outstanding
problem. The intra-species protein phosphorylation challenge orga-
nized by the IMPROVER consortium provided the framework to iden-
tify the best approaches to address this issue.

Results: Rat lung epithelial cells were treated with 52 stimuli, and gene
expression and phosphorylation levels were measured. Competing
teams used gene expression data from 26 stimuli to develop protein
phosphorylation prediction models and were ranked based on prediction
performance for the remaining 26 stimuli. Three teams were tied in first
place in this challenge achieving a balanced accuracy of about 70%,
indicating that gene expression is only moderately predictive of protein
phosphorylation. In spite of the similar performance, the approaches
used by these three teams, described in detail in this article, were differ-
ent, with the average number of predictor genes per phosphoprotein
used by the teams ranging from 3 to 124. However, a significant overlap
of gene signatures between teams was observed for the majority of the
proteins considered, while Kyoto Encyclopedia of Genes and Genomes
(KEGG) pathways were enriched in the union of the predictor genes of the
three teams for multiple proteins.

Availability and implementation: Gene expression and protein phos-
phorylation data are available from ArrayExpress (E-MTAB-2091).
Software implementation of the approach of Teams 49 and 75 are
available at http://bioinformaticsprb.med.wayne.edu and http://
people.cs.clemson.edu/~Iuofeng/sbv.rar, respectively.

Contact: gyanbhanot@gmail.com or Iuofeng@clemson.edu or atarca
@med.wayne.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 6, 2014; revised on July 2, 2014; accepted on
July 15, 2014

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst three
authors should be regarded as Joint First Authors

1 INTRODUCTION

Inferring biological mechanisms and pathways from high
throughput in vitro and/or in vivo experimental data remains
an outstanding problem. To address this issue in detail, one
would need to measure messenger RNA and protein levels at
multiple time points and have information on the methylation
states of genes, knowledge of transcriptional regulation and his-
tone modiﬁcations, information on copy number variation and
mutational status of genes and regulatory regions. Given the
difficulty and prohibitive cost of performing such experiments,
such detailed knowledge and data are likely to remain unavail-
able for some time. The problem is further confounded by the
complexity of cellular responses to variations in their environ-
ment, regulatory feedback mechanisms and varieties of organ-
speciﬁc time scales and tolerances.

Consequently, bioinformatics studies need to develop methods
and stochastic (probabilistic/ Bayesian) approaches to understand
biological phenomena from insufﬁcient data and limited know-
ledge. One goal of such studies is to predict the likelihood that,
given the data, some particular sets of proteins or pathways are
activated. An even more difﬁcult problem in this context is to
assess the degree to which the results of such predictions in one
species are relevant to another species. This understanding is
critical if we are to accurately translate data from experiments
conducted on model species, such as mice and rats, to humans.

This article describes the methods and results of three teams
that were tied in ﬁrst place in the Systems Biology Veriﬁcation
IMPROVER Sub-challenge l (SCl): Mira-species protein phos-
phorylation prediction. SCl assessed the degree to which gene
expression data could be predictive of changes in protein phos-
phorylation in rat lung epithelial cells and hence provided a base-
line performance for the next challenge [Sub-challenge 2 (SC2)],
which dealt with protein phosphorylation translation from rat to
human for lung epithelial cells under a variety of stimuli
(thissorrakrai et al., 2015). Phosphorylation levels were mea-
sured at 5 and 25 min after cells were exposed to l of 52 stimuli,

 

462 Published by Oxford University Press 2014. This work is written by US Government employees and is in the public domain in the US.

112 /310's112u1n0fp10}x0"sothJJOJutotq/ﬁduq 11101} popcorn/hog

9103 ‘Og anﬁnV uo ::

SC1

 

and gene expression levels were measured 6h after such expos-
ure. Measurements in untreated cells were also available in each
experimental batch. Differences in gene expression levels between
treated and control cells were expected to be the result of up-
stream signaling events driven by active phosphorylation cas-
cades in treated cells. Hence, the SCl sought to determine
whether changes in gene expression levels were sufﬁciently in-
formative to infer the molecular modiﬁcations observed up-
stream, in particular the phosphorylation status of effector
proteins. It was expected by the organizers of the competition
that data derived from this challenge might be informative not
only for the remaining sub-challenges but also provide informa-
tion to understand (i) intra—species mechanisms operative when
lung epithelial cells are treated to a variety of stimuli, (ii) the
relationship between these two layers of signaling responses
and (iii) the degree of cross-platform translatability between
the two measurement technologies.

2 METHODS
2.1 Organization of the challenge

The overview of SC] is presented in Figure 1. A number of S2 stimuli
were chosen to maximize the number of protein phosphorylation events
linked to pathways perturbed upon stimulus exposure. The following
criteria were considered for the initial selection of potential candidates:
(i) stimuli that modulate the activity of transcription factors/regulators,
(ii) classic stimuli known to target speciﬁc pathways and (iii) stimuli with
heterogeneous downstream effects. Computational and manual curation
approaches were undertaken to achieve an appropriate selection. Protein
phosphorylation data were obtained with a Luminex xMAP bead-based
assay, using microspheres coated with antibodies designed to bind spe-
ciﬁcally to phosphorylated proteins in rat bronchial epithelial cells. This
platform does not allow to distinguish between the different phosphoryl-
ation sites. Signals from individual beads were measured by a ﬂow

RM

p
16 proteins '

GEx GEx
13,841 genes
Training set: Test set:

26 stimuli E o o H 26 stimuli

Fig. 1. Overview of SC]. Participants were provided with gene expression
(GEx; measured via microarrays) and protein phosphorylation (P; pro-
ﬁled with Luminex xMAP) data from Subset A of stimuli in rat for
training. Participants were asked to predict which proteins show changes
in their phosphorylation status for each stimulus in Subset B (test data) in
rat, using gene expression data measured later in time from cells treated
with the same stimuli. Blue indicates available data, while red indicates
hidden data

cytometry detection device as a distribution of ﬂuorescent intensity.
Loading biases in the intensity data were removed by ﬁtting a robust
linear regression where the explanatory variable was the protein
amount measured by a ‘naked’ bead (a bead with no antibodies attached
to it). The effect of the naked bead was then subtracted from the signal of
each phosphoprotein and divided by the root mean squared error
(RMSE) derived from the regression ﬁt. Because the resulting processed
signal represents multiples of the RMSE, a value of 3.0 would correspond
to a probability of 0.0027 to observe such a signal just by chance
(assuming a normal distribution). The phosphorylation measurements
were performed in triplicate at two time points, 5 and 25 min after the
cell culture growing conditions were modiﬁed by adding one of the S2
stimuli. The median signal over the triplicates was considered the
phosphoprotein level for each stimulus. The S and 25 min time points
were selected by trial and error to maximize the number of activated
phosphoproteins as well as the strength of the phosphoproteomics
signal in both human and rat cells. The use of two time points allowed
capturing both rapid and slow kinetics of protein phosphorylation. In 35
(8%) of the 416 combinations of proteins and stimuli, the protein phos-
phorylation levels were different between the two time points, and there-
fore, a protein was called phosphorylated if the phosphorylation level at
either time point was >30. On the other hand, the gene expression levels
were measured at 6 h to ensure that it reﬂects downstream events follow-
ing phosphorylation and activation (or not) of the corresponding path-
ways. Gene expression and phosphoproteomics experiments were run in
experimental batches by dividing the S2 stimuli in four parts. Each batch
included separate dimethyl ether (DME) control samples. After experi-
ments were completed, the stimuli were partitioned into training and test
set by considering four types of data: phosphorylation response, differ-
ential gene expression, gene set enrichment and the experimental batch.
Stimuli were clustered based on each of the four types of data, and a ﬁnal
clustering was obtained by equally weighting the results from each indi-
vidual clustering. Each resulting cluster was split in two parts, with half of
the stimuli being assigned to the training set and the other being assigned
to the test set to balance similarity of response and experimental batch
between the two sets. The protein phosphorylation data were provided as
phosphorylation status of 16 proteins for 52 different stimuli, 26 in the
training data (Subset A in Fig. 1) and 26 in the test data (Subset B in
Fig. 1). Separate data ﬁles were provided for S and 25 min time points
with DME controls being provided for the training data only. DME was
used as solvent for all stimuli. The gene expression (GEx) data were
obtained using the Affymetrix Rat Genome 230 2.0 microarray platform
that allowed measuring expression levels of 13 841 unique genes 6 h after
exposure to a given stimulus, with two or three replicates per stimulus and
two or three DME controls per batch.

Participating teams were asked to provide a conﬁdence level (ranging
from 0 to 1) that a given protein was phosphorylated when cells were
treated to one of the 26 stimuli used in the test set. Teams were ranked
based on three metrics: the area under the precision recall (AUPR) curve,
the Pearson correlation coefﬁcient (PCC) and balanced accuracy (BAC;
mean of sensitivity and speciﬁcity). The PCC metric was normalized to
range between 0 and 1. These metrics were computed by aggregating
predictions for all 16 proteins and 26 test stimuli. The sum of ranks
over the three metrics was used to determine the overall ranking of the
teams in this challenge. While AUPR and PCC were computed from the
vector of conﬁdence levels for 26 stimuli x 16 proteins (continuous vari-
able between 0 and 1) and the true activation status of the protein
(binary: 0 = non-activated, 1 = activated), the computation of BAC
metric required rounding the submitted conﬁdence levels to the nearest
integer (0 or 1). See (thissorrakrai et al., 2015) in the current issue for
more details on team ranking in SC].

The overarching theme of the three approaches described next was to
consider each training stimulus as a statistical sample (data point) char-
acterized by the stimulus-induced gene expression changes (relative to

 

463

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} popcorn/hog

9103 ‘Og isnﬁnV uo ::

A.Dayarian et al.

 

untreated cells, i.e. DME). For each of the 26 training samples (stimuli),
the phosphorylation status of a given protein is treated as a binary out-
come (phosphorylated or not), and hence, supervised machine learning
methods were used to train one model for each protein. For every protein,
there were between 0 and 10 stimuli in the training set that lead to the
phosphorylation of the protein. For the 13 proteins with two or more
activations in the training set, prediction models were ﬁt and then applied
to the expression changes determined for the stimuli in the test set to infer
the phosphorylation status of each protein. The fundamental assumption
on which these methods rely is that, irrespective of the stimulus that
caused the phosphorylation of a given protein, its targets will change in
the same direction when compared with untreated cells.

2.2 Method of Team 49 (A.L.T., R.R.)

The approach of Team 49 was based on the expectation that some of the
gene expression changes between stimuli-treated rat cells and control
(DME) should be informative/predictive of the phosphorylation status
of a given protein. Each of the 26 stimuli in the training set was con-
sidered as one observation (sample) for which the change in log expres-
sion of genes (features) between stimuli-treated cells and DME was
computed. The phosphorylation status of a given protein was considered
positive (class = 1) if the median phosphorylation level (over the 273
replicates) of the protein in the stimulus-treated cells was >3 at either
of the time points (5 or 25 min), and negative (class = 0) otherwise. A
machine learning-based approach (Tarca et al., 2007, 2013a and 2013b)
was used to build a classiﬁer for each of the 16 proteins. The overall
procedure used was as follows:

(1) The gene expression data (both training and test) was averaged
over replicates for each stimulus within each batch. To correct
for possible batch effects, the mean expression level of the DME
group in a given batch was subtracted from the mean expression of
all stimuli. This resulted in a data matrix with 26 rows (training
stimuli) and 13 841 columns (differential expression levels of rat
genes between treatment and DME control).

(2) If a given protein did not have a positive response for at least two
stimuli in the training data, the conﬁdence level that the protein
was phosphorylated (belongs to class = 1) was set to 0 for all test
stimuli.

(3) If the protein was phosphorylated for two or more stimuli, a linear
discriminant analysis (LDA) model was ﬁt to the training data
using the top [7 genes ranked by a moderated t-test P-value.
Genes with fold change less than fold change threshold (FCT;
see below) were discarded if there were at least NF = 6 genes
meeting the threshold, where NF (number of features) is the max-
imum number of features considered as inputs in the model. If not,
no threshold on the fold change was set. The LDA model was ﬁt
with prior probabilities being set to 0.5 for both classes unless the
protein was positive in less than six stimuli, in which case the prior
for Class 0 was set to 0.75 and the prior for Class 1 was set to 0.25.

The choice of the number of genes to use (value of p) was made by
maximizing the performance of the LDA model using [7 genes, where p
was an integer in [1,NF]. The performance for each [7 was evaluated as the
average of three metrics: area under the receiver operating characteristic
curve, belief confusion metric and correct class enrichment metric (Tarca
et al., 2013a). Performance characteristics were estimated using 3-fold
cross-validation on the training data repeated 20 times. The FCT was
optimized by searching for the value that provided best cross-validation
performance among the following options: 1.25, 1.5, 1.75, 2, 2.25, 2.5,
2.75, 3 and 4.0. The optimization of p and FCT was done separately for
each protein. In the one instance in which the protein was positive in only
two stimuli, NF was set to 2 and FCT to 2.5, and a 2-fold instead of 3-
fold cross-validation was used. The posterior probabilities for class 1

(positive) or class 0 (negative) were obtained by applying the trained
LDA model to the gene expression data for each stimulus in the test
set, rounded to the nearest integer 1 or 0. These probabilities were sub-
mitted as the conﬁdence level that the corresponding protein was phos-
phorylated when cells were treated with the stimuli included in the test set.
All analyses were performed using the R statistical environment (www.r-
project.org) using adapted functionality from the maPredictDS C package
available in Biooonductor (Gentleman et al., 2004). An R script imple-
menting the method of Team 49 is available in the software section of
http://bioinformaticsprb.med.wayne.edu.

2.3 Method of Team 50 (A.D., S.H., M.B., GB.)

The expression data were preprocessed using a novel method, which
generated a universal noise curve. This curve was used to linearize the
signal and remove outliers. The resulting processed gene expression
data (GEx) consisted of 52 vectors of 13841 linearized signals (see
Supplementary Information for details). The phosphorylation data
were binarized using a sharp threshold of 3.0 for either of the two time
points at 5 and 25 min. Subsequently, two approaches were used to pre-
dict activation for each of the 16 proteins. The first method was based on
mutual information (MI), and the second was a combination of principal
component analysis (PCA), followed by LDA. Both predictions were
evaluated individually based on leave-one-out (LOO) cross-validation
and then combined by weighting their predictions. The weight for each
method was proportional to its corresponding Matthews correlation co-
efﬁcient (MCC).

2.3.] Method of Team 50-A.‘ based on MI For each gene, a sharp
threshold on the P-value (P< 0.01) from a t-test was used to identify gene
with signiﬁcantly different expression levels in stimulus-treated cells com-
pared with controls. The gene expression data were then binarized (1 /0
representing on/off state of the gene). Given the binarized data, each
protein (gene) was assigned a probability P(c) (P(g)) to be ON/OFF
across the 26 treatment stimuli. We then computed the Shannon entropy
(Cover and Thomas, 2012; Shannon, 2001) of a given protein or gene
using the formulae

H(c)= — Z p(c)logp(c); H(g)= — Z p(g)logp(g). (1)

c=0,1 g=0,1

Similarly, we also constructed the joint distribution p(g, c) for each gene
protein pair and from it, their joint entropy:

H(g,c)= — Z Z p(g,c)logp(g,c) (2)

g=0,lL‘=0,l

Finally, the M1 for every gensprotein pair was computed from their
Shannon entropies and their joint entropy:

1(g, C) = 11(6) + H(g) - H(g, 6) (3)

A gensprotein pair with high MI has a signiﬁcant correlation between
gene expression level (relative to control) and protein phosphorylation
state. Figure 2 shows an example of one such pair: protein AKTl and
gene SYNPR, which had an M1 of 0.53 bits and a PCC of 70.67.

This scheme was used to identify the best set of predictive genes (be-
tween 30 and 70) for each protein. A gene was selected if its MI exceeded
half the highest M1 for the given protein and had a false-positive rate
<1/ 3 estimated by LOO cross-validation. To predict the phosphorylation
state, a voting procedure was used on the top genes for each protein.
Each gene contributed one vote if it was signiﬁcantly expressed under the
unknown stimulus. The voter conﬁdence level for phosphorylation of the
protein was the fraction of top genes signiﬁcantly expressed. A training
procedure was used to identify thresholds and a non-linear scale across
the 26 experiments to convert the voting conﬁdence level into a ﬁnal
conﬁdence level, using LOO with equal penalty for both false-positive
and false-negative ﬁndings.

 

464

112 /310's112u1n0[p101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

SC1

 

 

I = “.33. p: «.h'T

15
E
.3 El
2 a
a10 E m
i a —
m 5 IE1 '—
2 as.
a as 1
ﬂ 0 I‘ w as
K
4

-5

 

 

 

-6 -4 -2 0 2
SYNPR

Fig. 2. AKTl phosphorylation signal versus SYNPR gene expression
signal. Each point in the figure corresponds to one stimulus in the train-
ing set. The green squares are statistically signiﬁcant levels of phosphor-
ylation. The red circles are statistically signiﬁcant levels of deviation in
gene expression. When SYNPR is underexpressed (red circles), AKTl is
phosphorylated (green squares). The M1 was I = 0.53 bits and a PCC
p: — 0.67 between the two variables

2.3.2 Method of Team 50-B.‘ based on PCA and LDA All genes
with no variation over the 26 training samples were discarded, which
reduced the data to 6033 genes. A PCA analysis was performed on
these, and 22 leading PCs were retained. The gene expression data were
now a 52x22 matrix containing projections of 52 stimuli on the 22
leading PCs. The ﬁrst 26 rows of this matrix (corresponding to the train-
ing data), and the 26 x 16 phosphorylation data matrix (binarized using a
crisp threshold of 3.0) were used in the subsequent training procedure.
The core of the training was an LDA as implemented in the MATLAB
Statistics Toolbox, which generated probabilistic predictions of class
membership (phosphorylation status) for each protein.

A key parameter in the training was the number k of PCs used. We
used a LOO procedure to estimate the classiﬁcation quality as a function
of k for each protein separately, quantiﬁed by the MCC (MCC(k)), where
MCC = 1 indicates perfect, error-free prediction, and MCC = 0 repre-
sents random guesses (Hastie et al., 2009). In the test set data, for each
considered value of k, we computed the mean of the posterior probability
over the 26 L00 classiﬁers. Using these, the results for different k were
combined in a weighted sum with the normalized MCC(k) as weights,
yielding the ﬁnal certainties for phosphorylation for each protein in the
test set data.

2.3.3 Combining results from both methods For both methods
described above for Team 50, the MCC was calculated for each protein
separately using the false-positive, false-negative, true-positive and true-
negative ﬁndings of the two methods as applied to the training set (25
stimuli used to predict the 26th). The predictions of the two approaches
were combined using a weighted average of their MCC score:

mebined= (Q1 * MCC1+ Q2 * MCC2)/(MCC1+ MCCz), (4)

where Qs denote the prediction of the methods for a given protein, and
MCC values are the corresponding MCC of the protein from predicting
the training set. If the MCC was zero for both methods, the un-weighted
average of the two Q values was used.

2.4 Method of Team 75 (Z.W., F .L.)

The prediction of the protein phosphorylation levels of each of the 16
proteins was performed by a regression method across the expression of
13 841 genes for 26 training stimuli. For each protein, we constructed a
support vector regression (SVR) model (Basak et al., 2007; Cortes and
Vapnik, 1995; Vapnik, 2000), yielding 16 SVR models. The high

 

i6
. I .

Mean Squared Error

 

 

ﬂ 5'0 IDID 15:11) 200 2.50 3'03 350 ‘00
Number of features

Fig. 3. Plot of MSE against numbers of selected features for the SVR
model to predict the phosphorylation of AKTl. The MSE is lowest when
128 genes are used

dimensionality of gene expression data required a feature selection step
before constructing the models. The following procedure was used:

Ridge regression was performed between the protein phosphorylation
levels and all 13 841 genes. Next, genes were sorted in descending order by
the magnitude of their ridge regression weights. The choice of ridge re-
gression parameter is detailed in Supplementary Information. The feature
space for each protein was constructed by keeping the gene with highest
magnitude of regression weight one at a time. Next, SVR models were
built using the selected features. The mean squared errors (MSE) of the
SVR models were evaluated using LOO on the 27 measurements (con-
trol -l- 26 treatments). Genes were added until the MSE of the SVR
model became stable. For example, Figure 3 shows the MSE of the
SVR model used to predict the phosphorylation levels of AKTl against
the number of features added. The number of genes used for each protein
was the one which resulted in the lowest MSE on the training data. After
selecting the features (genes), SVR models were fit using the training data
and used to predict the phosphorylation level in the test data. The ﬁnal
phosphorylation status of 16 proteins under 26 stimuli were predicted
using a cutoff threshold of 3 on phosphorylation level. The radial basis
function (RBF) kernel (Chang and Lin, 2011) was used in all SVR
models. A software implementation of the approach of Team 75 is avail-
able at http://people.cs.clemson.edu/~luofeng/sbv.rar.

3 RESULTS
3.1 Prediction performance, modeling strategies and team
ranking

The phosphorylation activity for all 16 proteins and 52 stimuli
are shown in Supplementary Figure S1. The performance of the
teams that participated in the intra—species protein phosphoryl-
ation challenge is presented in Table 1. An average sensitivity
and speciﬁcity of 72% (BAC = 0.72) was the best performance
recorded among the 21 participating teams, pointing to a mod-
erate level of predictive information available in a one snapshot
of gene expression data to infer protein phosphorylation status.

Three teams (Teams 49, 50 and 75) were ranked ﬁrst because
their submissions could not be reliably differentiated based on
the ofﬁcial ranking procedure that involved three different met-
rics. We note that the methods used by these three teams were
very different. Team 49 used a few top genes ranked by moder-
ated t-test P—Values, ﬁltered them by the magnitude of expression
level change and combined these features in an LDA model,
achieving 4% better for AUPR than the other top two teams.
Team 75 ranked genes by ridge regression and then used the top

 

465

112 /310's112u1n0[p101x0"soticuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.Dayarian et al.

 

Table 1. Ranking of the teams in the IMPROVER intra-species protein
phosphorylation challenge

 

 

Rank AUPR Pearson BAC Team
1 0.42 0.71 0.68 49
1 0.38 0.72 0.68 50
1 0.38 0.71 0.72 75
4 0.37 0.7 0.61 93
5 0.35 0.64 0.67 111
6 0.35 0.68 0.6 61
6 0.31 0.65 0.65 89
8 0.29 0.63 0.66 112
9 0.27 0.62 0.59 116
10 0.23 0.59 0.58 64
11 0.24 0.59 0.56 90
12 0.23 0.6 0.56 100
13 0.28 0.56 0.55 78
14 0.15 0.55 0.58 72
15 0.19 0.56 0.53 105
16 0.14 0.54 0.55 82
17 0.13 0.53 0.55 106
18 0.14 0.49 0.45 71
19 0.13 0.49 0.46 52
20 0.1 0.48 0.49 84
21 0.07 0.43 0.5 99

 

Note: Performance metrics included AUPR curve, normalized PCC and BAC.
Expected values for a random prediction are AUPR : 0.11, PCC : 0.5,
BAC : 0.5.

 

 

10000
0
IOOOI
lot:
I
I:l:-

nucoo

 

Team Rank
6
|

 

 

 

 

 

-; — : 55 a 
._. .-_, 5 55 5 :01:
b- "3'5 55 a Loo
: —_ :: :: : ooec
' ' :: :: : oooc
e E 55 55 5 once
__:  .._....a.,
||II|| || || ||=||
InmomV-rmwmqoonow'nmmw—Nvox
hq-uamV—LDDUV—FLDmOr-nhOoaQr-ummm
EEEEEEEEEEEEEEEEEEEEE
$$$$m$8mm§$m8$5$m$$8$
I—I—I—i—gI—I—ggI—I—gi—I—gi—gI—I—I—I—

Fig. 4. Robustness analysis of the team’s ranks by bootstrap of the test
set 1000 times and re-scoring teams

ones in SVR models obtaining 4% higher BAC than the other
two teams. Team 50 computed predictions by weighting two self-
contained prediction approaches: (i) one based on ranking genes
by MI and using a few top ones in a voting scheme and (ii) a
second one based on LDA modeling that used principal compo-
nents analysis for dimensionality reduction. The results presented
in the Supplementary Information show that each of the two
methods combined by Team 50 had similarly good performance
and hence contributed equally to the success of their approach.

To evaluate whether the ranking of the teams was stable with
respect to the composition of the test dataset, the organizers of
the challenge performed a robustness analysis of the team ranks

by sampling the test stimuli with replacement (bootstrap) 1000
times for each protein, based on which team performance was
assessed. Each bootstrap sample had by design similar propor-
tions of positive and negative stimuli as observed in the complete
test dataset (thissorrakrai et al., 2015). For each bootstrap
sample, the performance metrics and team ranks were computed.
Their distributions are shown in Figure 4. This ﬁgure shows that
there was no signiﬁcant difference in performance among the
three teams. It also shows that there was a signiﬁcant perform-
ance difference between the top three teams and other teams. A
caveat of this analysis is that the team rank estimates are not
independent from one bootstrap sample to another, and hence,
the P—Values for the rank differences may be unreliable.

3.2 Evaluation of the overlap in gene signatures among the
top three teams

To determine whether certain genes were particularity predictive
for the phosphorylation status of each protein, we identiﬁed the
genes that were selected by more than one of the top teams.
Table 2 shows all genes selected by at least two of the three
top teams for each protein, whereas Supplementary Table S1
lists all genes used by any of the teams in their classiﬁers. The
P—Value shown in Table 2 for a given protein represents the like-
lihood that the observed number of genes selected by two or
more teams at the same time could have been a chance event.
To compute these P—Values, a simulation was performed by se-
lecting at random from all genes on the microarray three lists of
genes. The size of each list corresponded to the number of pre-
dictor genes used by each team for a given protein. The number
of genes in common among two or more teams was recorded,
and the procedure was repeated 100 000 times. A P—Value was
reported as the fraction of the simulation runs when the overlap
statistic was at least as extreme as the one observed and reported
in Table 2. All nominal P—Values reported in Table 2 would
remain significant at 5% after adjustment using the false discov-
ery rate method.

The mean number of genes used by Team 49, Team 50 and
Team 75 were 3.4:I:2.8, 45.3:I:47.1 and 124.8:I:58.9, respect-
ively. These results show a great diversity in the number and
type of genes selected by the teams with the approach of Team
49 being the most parsimonious. This suggests that the number
and identity of genes that are useful are strongly method depend-
ent and that there is no universal gene set predictive for any given
protein. The likely explanation for this phenomenon is that the
differences in the predictive ability of genes are small, as they are
highly correlated with each other. Consequently, using different
criteria for gene selection identiﬁes different genes useful for pre-
dictions. To study the extent of the correlation between different
predictor genes selected by different teams, we focused on Teams
49 and 50 because they used the smallest number of genes as
predictors.

For each protein where both teams had at least one common
feature selected, the Pearson correlation of expression values be-
tween all combinations of features selected by each team was
calculated across the samples for the 26 training stimuli, and
separately using the data from the test stimuli. An example of
the correlation matrix obtained on the training stimuli is shown
in Figure 5 for the protein AKTl, while the complete set of

 

466

112 /310's112u1n0[p101x0"soiicuiJOJHtoiq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

SC1

 

correlations maps for training and test stimuli are given in
Supplementary Figure S2. The color scale at the top left corner
of the ﬁgure shows the sign and magnitude of correlation versus
color. We can observe several clusters of genes selected by Team
50 being highly correlated with one or more different genes se-
lected only by Team 49. For instance, the cluster of 15 genes
selected by Team 50 (underlined in black) are negatively corre-
lated (mean correlation of 4161) with gene LRP6 and positively
correlated (mean correlation of 0.63) with gene CLEC2D se-
lected by Team 49. These correlations were persistent in the
test dataset also (4)4 and 0.51, respectively) and hence explain-
ing how fewer and different genes selected by Team 49 resulted in
similar performance as Team 50.

3.3 Experimental design factors affecting the prediction
performance

From the perspective of building and evaluating prediction
models for each protein from gene expression data, the ideal
situation would have been the situation where an equal
number of stimuli activate or not activate a given protein and
similarly, where the same number of proteins are activated or not
activated by a given stimulus. In reality, of course this was not
the case in the given data, both training and test. To assess the
effect of the imbalance in the number of active stimuli and active
proteins, the performance metrics of each team were calculated
as a function of the number of stimuli or proteins that were
active in the test set. The results are shown in Figure 6. In
Figure 6, the x—axis indicates the number of active stimuli for
each given protein (top) or the number of active proteins for a
given stimulus (bottom), and the y-axis is the score by team as
well as the aggregate average score across all three teams.
Surprisingly, the effects of varying these two quantities are rela-
tively mild for BAC and PCC metrics. However, a strong im-
provement in AUPR was observed with increasing number of
activations.

Because the split of the stimuli into a training and test set was
performed by the challenge organizers after observing the phos-
phorylation and gene expression patterns, we have tested
whether the particular split led to unusually low or high predic-
tion performance. The method of Team 49 was applied on 25
random splits of the stimuli into training and test sets. The mean
BAC over the 25 trials was 0.66 (SD = 0.06), whereas mean
Pearson correlation was 0.68 (SD = 0.05). These values are
very similar to those reported in Table 1, and hence, there was
no evidence that the split of the stimuli that was used in the
challenge was particularly favorable to the development of pre-
diction models, and hence, with other splits the performance re-
sults would have been similar. However, when the
phosphorylation status was set randomly to each stimulus in
the training set, the mean BAC over the 25 trials was 0.55
(SD = 0.04), whereas mean Pearson correlation was 0.56
(SD = 0.05).

We have also determined the persistence of the predictor genes
of Team 49’s method across the 25 trials in which training stimuli
were randomly selected among all 52 involved in the challenge.
The percentage of the trials in which a given predictor gene was
selected of all instances when a model could be built (the protein
was phosphorylated for three or more stimuli), are reported in

Table 2. List of predictor genes used by at least two of the three teams
ranked ﬁrst in the challenge

 

 

Protein Gene Selected Protein Gene Selected
P-Value by team P—Value by team
49/50/75 49/50/75
AKTl OSGEPLl 101 TF65 TNFRSFlB 110
0.005 CLEC2D 101 0 VIPR2 1 10
DAPKl 1 10 MICALL2 1 10
TSLP 011 SLC1A5 101
CREBl GUCY1A3 110 ECHl 011
0 ADHFEl 1 10 PLA2G4A 011
SMTNL2 110 FUBPl 011
SYNPR 011 FAM105A 011
CYB561 011 EBF3 011
CALMl 011 KS6B1 EPMZAIPl 110
METTL7A 011 0 CCRl 101
GSK3B GRB14 110 LOC100361467 011
0 PDE12 101 RASAl 011
PPP2R3A 101 SH2B3 011
ZRANB2 011 LOC257642 011
SPRY4 011 ETV4 011
LOC100361467 011 BB512 011
TNFRSFllB 011 GAP43 011
RASAl 011 PCDHl 011
SH2B3 011 MP2K6 D103 1 11
LOC257642 011 0 RSAD2 1 11
MK03 SMTN 110 ANGPTL4 011
0.0004 D103 110 RAMP3 011
CCNDl 011 SPRY4 011
ABHD2 011 LOC100361467 011
WNKl GLCCIl 110 RASAl 011
0.0001 RGD1565927 101 SH2B3 011
DUSPZ 101 LOC257642 011
FAKl RBKS 101 HMGC51 011
0 MT1A 011 MP2K1 SMTN 110
CTFl 011 0.001 D103 110
LOC100360017 011 CCNDl 011
1KBA RAB8B 011 PEA15A 011
0.29 NTNGl 011 MK09 GRB14 110

FAM46A 011 0.006 TNFRSFllB 011

 

Supplementary Table S2 for genes selected in >33% of the trials.
A number of 6 of these 17 more reliable gene predictors were also
found by two or more of the three teams during the challenge. As
an example, for protein MK03, genes WISPl and D103 were
selected in>50% of the trials, and both were among the pre-
dictors identiﬁed in the challenge by Team 49 (see
Supplementary Table S1) with DIO3 gene being also found by
Team 50, as shown in Table 2.

4 DISCUSSION

Animal models are often used in biomedical research for testing
the effect of various stimuli (e. g. drugs) before considering them
for testing in humans. The general assumption is that biological
processes in animals (e.g. mice or rats) are similar to biological
processes in humans under analogous conditions. However, few
studies have addressed the limitation on which biological events
observed in rodents can be translated to humans. For instance,

 

467

112 /310'S[BHJUOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.Dayarian et al.

 

gene expression level changes in murine and human models were
not at all correlated in peripheral blood as a response to inﬂam-
matory injuries, such as burns, blunt force trauma, as well as to
endotoxin in human patients and in mice (Seok et al., 2013). The
Species Translation Challenge, comprising four sub-challenges,
was developed to systematically assess translatability of protein
phosphorylation and pathway activation in response to a range
of stimuli. The aim of the ﬁrst sub-challenge, the ‘intra—species
protein phosphorylation prediction sub-challenge’, was to assess

 

AKT1
E a:
19 m
8 a E
W
.2
PH“
CLEC2D
DCBLDZ
mEPL1
H LRP6
_ I I DAPK1

Tsam50

Fig. 5. Clustered heatmap of gene expression correlations between genes
selected as predictors of AKTl protein phosphorylation by Teams 49
(rows) and 50 (columns). The gene highlighted in green was selected as
predictor by both teams. The cluster of 15 genes selected by Team 50
(underlined in black) are negatively correlated (mean correlation of 41.61)
with gene LRP6 and positively correlated (mean correlation of 0.63) with
gene CLEC2D selected by Team 49. These correlations were persistent in
the test dataset also (41.4 and 0.51, respectively); see Supplementary
Figure S2

 

whether downstream (in time) gene expression data are sufﬁ-
ciently informative to infer protein phosphorylation status of
some key signaling molecules, and provide a baseline perform-
ance expectation for the translation from rat to human.

Three teams ranked ﬁrst in this challenge, based on the fact
that their performance was not distinguishable by the prespeci-
fied ranking methodology (Table 1). The performance of these
three teams was also significantly better than any one of the
remaining teams, as determined using a rank stability analysis.
The prediction performance results of these top ranked teams
suggest that a snapshot of the transcriptomic activity in rat epi-
thelial cells contains a moderate level of information regarding
protein phosphorylation levels, with the average sensitivity and
speciﬁcity being about 70%. Improved performance might be
obtained if the gene expression data were collected at multiple
time points following treatment, to capture important time-de-
pendent effects, non—linearity and multi-node cooperation in
geneeprotein interactions.

In this article, we have described in detail the approaches of
the three teams tied for first place in this sub-challenge. Each
team used a different method to select predictor genes, namely,
ranking genes by moderated t-test P—Values between classes and
choosing a handful of the top ones (Team 49), using MI between
each gene and the outcome and performing dimensionality re-
duction Via PCA (Team 50) and performing gene ranking by
ridge regression (Team 75). A large variation in the number of
predictor genes was observed for each given protein from one
team to the next with the most parsimonious approach (Team
49) using on average less than four predictor genes. Moreover,
the types of models used to make predictions based on the se-
lected genes were also very different among teams. Team 49 used
an LDA model. Team 50 used a voting procedure, which com-
bined the predictions from a method based on MI with one
based on an LDA model trained on principal components.
Team 75 results were based on SVR with RBF kernels.
However, an important aspect of the model development was
common among the three teams, namely, that the optimal

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0. _ 0 ca _ CI _
w. _ z-FA 00. _ a _ 0°. _ a ﬁx
0 07/39” g o / ragga—a D I /°\§o<§
so ' no r": ‘K‘?’ ‘0. / \ "4 ° .
E e - 3‘ A? 8 cs   a o - /eixog§ 0’50
2 q: _ “I f a “I _0 m ‘5': “S
0 ° I.“ 0 o c c
- _ / lama - _ - _
g -'= Ream ?5t 2 g
_ [E a E . _ . _
o I I I 9I9 g I ‘3 I I I I I D I I I I I
2 4 6 8 ID 2 4 6 3 NJ 2 4 6 3 10
Activation Number Activation Number Activation Number
0_ q_ a.
'— ISSnmig '— ‘—
00 ' no .0 _ oq _ '0
a: 0' _ Egr‘ieigite d _ gégﬁiu-ffj—ig 0 gég‘x _____,==.g
m9- °\ UQ- /' or U‘Q- % O‘j‘gE—o
2 3  4:779 E 3 / a S e
o" /_ --/ .°// 6‘9 cs-
N. _ f! ° N. _ N. _
O O C
C’- —= 0. _ 0. _
D I I I I I I o I 1 I I I I O I I I I I I
‘I 2 3 4 5 6 ‘I 2 3 4 5 6 '1 2 3 4 5 6

Activation N u mber

Activation Number

Activation Number

Fig. 6. Team scores for the various metrics as a function of the number of stimuli for which a given protein is active (top) and the number of active

proteins for a given stimulus (bottom)

 

468

112 /310'S[BHJUOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

SC1

 

number of predictors used was automatically determined based
on cross-validated model performance, even though the speciﬁc
performance metrics used were different. This element was also
in common among the best and third best teams in the
IMPROVER Diagnostic Signature Challenge (T area et al.,
2013a). Despite the very different prediction approaches and
gene signatures, the performance results of these three teams
were very similar. The main reasons for this were (i) a redun-
dancy in the gene signatures of Teams 50 and 75 and (ii) strong
correlations between predictor genes selected by different teams
(as suggested by Figure 5). Although an analysis of the overlap
of predictor genes found more common genes than expected by
chance among the three teams, this analysis did not account for
extra overlap that could have occurred simply by modeling the
noise in the data, i.e. when the phosphorylation status of proteins
were randomly assigned to the different training stimuli.

Another common aspect among the approaches described
herein is the fact that they used only information from the train-
ing data to make inference on the phosphorylation status of the
16 proteins after treatment with stimuli in the test set. Alternative
approaches could have relied at least in part on prior knowledge
regarding the target genes of the 16 proteins under the study. The
top three teams considered that an unbiased approach, in which
all genes are treated as potential candidates for being informative
of the phosphorylation status of a given protein would have a
better chance to maximize prediction performance than relying
on the literature evidence of potential gene targets for each pro-
tein. Moreover, these data-driven methodologies can be applied
to proteins for which no potential targets are available.

A KEGG (Ogata et al., 1999) pathway enrichment analysis
(Falcon and Gentleman, 2007) on the union of predictor genes
from the three teams was done to determine whether biological
pathways are activated for each of the phosphorylation proteins.
We found that five proteins have at least one enriched pathway
(false discovery rate of 10%). The results are presented in the
Supplementary Table S3. This analysis found also that almost
half of the predictive genes associated with FAKl and PTNll
activity are related to metabolism pathways. This should not be
surprising because metabolism is a fundamental process that the
cell regulates in response to any stress. However, it suggests that
genes related to metabolism may be the best predictors of phos-
phorylation activity. For PTNll, we also found activation of
four gene sets, which are related to signaling in cancer
(Bentires-Alj et al., 2004). Similarly, for MK14K11, two can-
cer-related pathways show some evidence of enrichment, al-
though not signiﬁcant after adjustment for multiple testing.
This is consistent with the role of MK14K11 in cancer signaling
and, in particular, P53 activation. For IKBa, we found that
many enriched pathways are related either to metabolism or to
the function of IKBa as a key regulator of the immune response
nuclear factor kappa—light-chain—enhancer of activated B cells
(NFkB) pathway. A limitation of this analysis is that the pre-
dictor genes of the most two parsimonious approaches, Teams 50
and 49, have limited or no contribution, respectively, to the path-
way enrichment results, as the union of predictor genes for each
protein is dominated by genes selected by Team 75.

In summary: The ‘intra-species protein phosphorylation pre-
diction’ sub-challenge of the IMPROVER Species Translation
Challenge was designed to identify the extent to which it is

possible to predict upstream protein phosphorylation effects
from a snapshot of downstream transcription activity. This
crowdsourcing initiative identiﬁed three approaches, described
in detail herein, that were ranked best among 21 participating
teams. Two of these three approaches (Teams 50 and 49) were
also applied successfully in the ‘inter-species protein phosphor-
ylation prediction (SC2)’, and therefore, SC1 represented a case
study for the different teams to tune their approaches for SC2.
Moreover, comparing the performance of the same approach
(e.g. Team 49) between SCI and SC2, we could conclude that
when using only gene expression data to predict protein phos-
phorylation, the inter-species prediction problem (SC2) was only
slightly more difﬁcult than the intra—species prediction (SCl)
(BAC and Pearson were almost identical with AUPR being
0.09 units less in SC2 than in SCI for Team 49). In addition to
providing an estimate for the best performance to be expected in
such an experimental design (about 70% BAC that was signiﬁ-
cantly better than expected by chance; see performance break-
down per protein in Supplementary Table S4), the results
described here also provide informative gene signatures for the
phosphorylation activity of 16 proteins in rat lung epithelial cells
under various stimuli. The prediction performance did not
depend on the particular choice of training stimuli (of the 52
used in the challenge), yet only few predictor genes were stable
over different sets of training stimuli and gene selection methods.

ACKNOWLEDGEMENTS

AD. and SH. thank the Kavli Institute for Theoretical Physics
(KITP) at UCSB, and in particular Boris Shraiman, for support.
G.B. thanks the KITP for their support during the early stages of
this project, the Juelich Supercomputing Centre at the
Forschungszentrurn, J uelich for their support when this research
was being completed and Tata Institute of Fundamental
Research, Mumbai, India for support and hospitality during
the writing of the manuscript.

A.T. was also supported by the DSC best overall performer
grant from Philip Morris International. Z.W. and FL. were sup-
ported in part by Hunan Agricultural University and by the
Citrus Research and Development Foundation. P.M., K.R.
and RN. helped to edit the manuscript and generate tables
and ﬁgures. E.B., R.N., RM. and KR. helped to develop and
organize the challenge. The data and organization of challenge
was performed under a joint research collaboration between
IBM. and P.M.I., and was funded by P.M.I.

Funding: A.D., SH. and GB. were supported in part by the
National Science Foundation under Grant No. NSF PHYll-
25915. G.B. was also supported in part by grant 1066293 from
the Aspen Center for Physics, respectively. AT. and RR. were
supported, in part, by the Perinatology Research Branch,
Division of Intramural Research, Eunice Kennedy Shriver
National Institute of Child Health and Human Development,
National Institutes of Health, Department of Health and
Human Services (NICHD/NIH); and, in part, with Federal
funds from NICHD, NIH under Contract No.
HHSN275201300006C.

Conflict of Interest: none declared.

 

469

112 /310'S[BHJUOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

A.Dayarian et al.

 

REFERENCES

Basak,D. et a]. (2007) Support vector regression. Neural Inf. Process. Lett. Rev., 11,
2037224.

Bentires—Alj,M. et a]. (2004) Activating mutations of the noonan syndrome—asso—
ciated SHP2/PTPN11 gene in human solid tumors and adult acute myelogenous
leukemia. Cancer Res., 64, 881(r8820.

Chang,C.C. and Lin,C.J. (2011) LIBSVM: a library for support vector machines.
ACM Trans. Intel]. Syst. Technol, 2, 27.

Cortes,C. and Vapnik,V. (1995) Support—vector networks. Mach. Learn., 20, 2737297.

Cover,T.M. and Thomas,J.A. (2012) Elements of Information Theory. John Wiley &
Sons, Hoboken, New Jersey, USA.

Falcon,S. and Gentleman,R. (2007) Using GOstats to test gene lists for GO term
association. Bioinformatics, 23, 2577258.

Gentleman,R.C. et a]. (2004) Bioconductor: open software development for com—
putational biology and bioinformatics. Genome Biol., 5, R80.

Hastie,T. et a]. (2009) The Elements of Statistical Learning. Vol. 2, Springer, New
York, NY, USA.

Ogata,H. et a]. (1999) KEGG: kyoto encyclopedia of genes and genomes. Nucleic
Acids Res., 27, 29734.

thissorrakrai,K. et a]. (2015) Understanding the limits of animal models as pre—
dictors of human biology: lessons learned from the sbv IMPROVER Species
Translation Challenge. Bioinformatics, 31, 4714183.

Seok,J. et a]. (2013) Genomic responses in mouse models poorly mimic human
inﬂammatory diseases. Proc. Natl Acad. Sci. USA, 110, 350773512.

Shannon,C.E. (2001) A mathematical theory of communication. ACM
SIGMOBILE Mob. Comput. Commun. Rev., 5, 3755.

Tarca,A.L. et a]. (2007) Machine learning and its applications to biology. PLoS
Computat. Biol., 3, e116.

Tarca,A.L. et al. (2013a) Strengths and limitations of microarray—based phenotype
prediction: lessons learned from the improver diagnostic signature challenge.
Bioinformatics, 29, 289272899.

Tarca,A.L. et al. (2013b) Methodological approach from the best overall team in the
sbv improver diagnostic signature challenge. Syst. Biomed, 1, 24434.

Vapnik,V. (2000) The Nature of Statistical Learning Theory. Springer, Springer—
Verlag, New York.

 

470

112 /310's1au1nofp101x0'sopauiJOJHtoiq/ﬁduq 111011 papao1u/IA0C1

9103 ‘0g1sn8nv uo ::

