BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

ProbMetab

 

The main product of a probabilistic annotation is a list of
compound candidates ranked by their probabilities
(Supplementary Fig. S2). To easily navigate over ProbMetabs
results, we display tabular and dynamic network outputs along
with supporting information, which assists practitioners to ultim—
ately decide on most parsimonious annotations instead of forcing
them to simplistically rely on the top probability assignment. All
mass peaks are viewed as graph’s nodes. Edges between two
nodes are drawn if any candidate compound assigned to the
outgoing node can be metabolized to any candidate compound
assigned to the incoming node by means of a known biochemical
reaction (Supplementary Fig. S3). ProbMetab is capable of pro—
ducing reaction graphs and export them as standard Cytoscape
input ﬁles or broadcasting the necessary graph data and attri—
butes (colour, shapes, etc) directly to Cytoscape Desktop using
RCytoscape (Shannon et al., 2013). This information can be
easily overlaid with other widely used systems biology strategies
such as correlation or partial correlation networks. If a mass
spectra time—series or biological replicates are available,
ProbMetab uses third—party packages integrated downstream
to export correlation or partial correlation graphs, along with
their intersection/difference with the reaction graph.

Alternatively, a biologist can visualize ProbMetab’s results in
a simplified searchable web interface. Our package has a function
that is responsible to consume an online web—service, which
checks and renders the broadcast results as a web page. The
visualization approach was developed taking advantage of the
cytoscape.js library (Lopes et al., 2010) and its dependencies and
can be easily integrated or embedded into any htm15 web
application.

ProbMetab’s documentation brings two detailed case studies
in which all its features are explored. Moreover, to highlight
integration with downstream and upstream third—party R pack—
ages, data analysis examples mentioned are carried out from raw
data, following through preprocessing until it reaches
ProbMetab’s speciﬁc point of action. We used publicly available
data from T rypanosoma brucei, causative agent of sleeping sick—
ness, and an original dataset from Saccharum oﬂicinarum (sugar—
cane), an important biofuel source, to illustrate several points in
typical metabolomics analysis sections.

The T. brucei dataset, obtained from the szatch.R project
website, was chosen because it presents a set of metabolites iden—
tiﬁed with the aid of internal control standard compounds, being
specially suited for performance evaluation. With this validation
dataset, we compare the MetSamp (http://www.dcs.gla.ac.uk/in
ference/metsamp/) implementation from Rogers et a]. (2009)
with ProbMetab’s implementation and show that, the efficient
R/c++ integrated function (Eddelbuettel and Francois, 2011)
had a 3—fold running time improvement over the MATLAB im—
plementation. For both implementations, the higher probability
candidate was the true identity in up to 60% of the metabolites.
However, instead of reporting only the higher probability candi—
date identity as proposed by Rogers et a]. (2009), we show that
exporting the complete ranking in summarized visualizations, up
to 90% of metabolite identities are among the top three higher
probabilities. The full or filtered ranking allows the experimenter
to associate the candidates with additional information present
in this output and attribute the correct identity.

The sugarcane dataset was chosen to exemplify differential
expression of annotated metabolites in contrasting environmen—
tal perturbation. We successfully recovered changes in a known
stress response pathway (ﬂavone and ﬂavonol biosynthesis),
showing the importance of a network—centric visualization for
metabolite annotation to track metabolism changes. The bench—
mark dataset confirms, as preconceived by Rogers et a]. (2009),
that a probabilistic model using orthogonal data and metadata
yields better automatic mass peak annotation. The perturbation
dataset shows that probabilistic annotation can produce other—
wise impossible interpretation for differential network
connectivity.

We implemented a method to annotate compounds in a com—
putational framework that allows the introduction of prior
knowledge and additional spectral information. With the R
package ProbMetab, we provide ways to summarize the results
of series of analysis needed to extract information from complex
high—dimensional MS data, and help the experimenter to track
metabolism changes in the process of interest.

ACKNOWLEDGEMENTS

The authors thank Bruno M. Della Vecchia (USP), Dr Oscar
Yanes’s team (Rovira i Virgili University) and Paul Shannon
(Fred Hutchinson Cancer Research Center) for critical discus—
sions. They thank EBI/EMBO’s courses for catalyzing cooper—
ation among coauthors.

Funding: Microsoft Research and FAPESP (09/53161—6);
FAPESP Tematico grant (08/56100—5) and fellowships (10/
14926-4, 12/05392-1 and 10/15417-6); CAPES through Pos-
graduacao em Genetica FMRP—USP.

Conﬂict of Interest: none declared.

REFERENCES

Altman,T. et a]. (2013) A systematic comparison of the MetaCyc and KEGG path—
way databases. BMC Bioiiy’ormuticx, 14, 112.

Breitling,R. et a]. (2013) Modeling challenges in the synthetic biology of secondary
metabolism. ACS Syntlt. Biol, 2, 3737378.

Dunn,W.B. et a]. (2012) Mass appeal: metabolite identification in mass spectrom—
etry—focused untargeted metabolomics. Metabolomics, 9, 5447866.

Eddelbuettel,D. and Francois,R. (2011) chp: seamless R and c++ integration.
J. Stat. Softnt, 40, 1718.

Kuhl,C. et a]. (2011) CAMERA: an integrated strategy for compound spectra
extraction and annotation of LC/MS data sets. Anal. Chem, 84, 2837289.
Lopes,C.T. et a]. (2010) Cytoscape web: an interactive web—based network browser.

Bioinformutim‘, 26, 234772348.

Rogers,S. et a]. (2009) Probabilistic assignment of formulas to mass peaks in meta—
bolomics experiments. Bioinformutim‘, 25, 5127518.

Rogers,S. et a]. (2011) Bayesian approaches for mass spectrometry based metabo—
lomics. In: Stumpf,M.P.H., Balding,D.J. and Girolami,M. (eds) Handbook of
Stutixtiml Syxtemx‘ Biology, John Wiley & Sons Ltd, Chichester, UK,
pp. 467476.

Shannon,P.T. et a]. (2013) RCytoscape: tools for exploratory network analysis.
BMC Bioinﬁnmutim‘, 14, 217.

Smith,C.A. et a]. (2006) XCMS: processing mass spectrometry data for metabolite
proﬁling using nonlinear peak alignment, matching, and identiﬁcation. Anal.
Cliﬂ’lL, 78, 7797787.

 

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

