ORIGINAL PAPER

Vol. 30 no. 2 2014, pages 221-227
doi:1 0. 1093/bioinfonnatics/btt638

 

Systems biology

Advance Access publication December 2, 2013

Topological augmentation to infer hidden processes in

biological systems

Mikael Sunnaker1‘2‘*

, Elias Zamora-Sillerol'B'i, Adrian Ldpez Garcia de Lomanae'i,

Florian Rudrofi4'§, Uwe Sauer4, Joerg Stelling1 and Andreas Wagner3'5'*

1Department of Biosystems Science and Engineering/Swiss Institute of Bioinformatics, EI'H Zurich, 4058 Basel,
Switzerland, 2Competence Center for Systems Physiology and Metabolic Diseases, EI'H Zurich, 8093 Zurich,
Switzerland, 3Institute of Evolutionary Biology and Environmental Studies/Swiss Institute of Bioinformatics, University of
Zurich, 8057 Zurich, Switzerland, 4Institute for Molecular Systems Biology, 8093 Zurich, Switzerland and 5The Santa Fe

Institute, Santa Fe, 87501 New Mexico, USA
Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: A common problem in understanding a biochemical
system is to infer its correct structure or topology. This topology con-
sists of all relevant state variables—usually molecules and their inter-
actions. Here we present a method called topological augmentation to
infer this structure in a statistically rigorous and systematic way from
prior knowledge and experimental data.

Results: Topological augmentation starts from a simple model that is
unable to explain the experimental data and augments its topology by
adding new terms that capture the experimental behavior. This pro-
cess is guided by representing the uncertainty in the model topology
through stochastic differential equations whose trajectories contain
information about missing model parts. We first apply this semiauto-
matic procedure to a pharmacokinetic model. This example illustrates
that a global sampling of the parameter space is critical for inferring a
correct model structure. We also use our method to improve our
understanding of glutamine transport in yeast. This analysis shows
that transport dynamics is determined by glutamine permeases with
two different kinds of kinetics. Topological augmentation can not only
be applied to biochemical systems, but also to any system that can be
described by ordinary differential equations.

Availability and implementation: Matlab code and examples are
available at: http://www.csb.ethz.ch/‘tools/index.

Contact: mikael.sunnaker@bsse.ethz.ch; andreas.wagner@ieu.uzh.ch
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 31, 2013; revised on October 28, 2013; accepted on
October 31, 2013

1 INTRODUCTION

Cellular processes, for instance in metabolism, signaling or trans-
port, can often be modeled by sets of deterministic differential

 

*To whom correspondence should be addressed

7‘Present address: Institute for Systems Biology, Seattle, WA 98109-5234,
USA.

1:Present address: Research and Development Department, GET Capital
AG, 41061 Monchengladbach, Germany.

§Present address: Institute of Applied Synthetic Chemistry, 163-OC,
Vienna University of Technology, Vienna, Austria.

equations that describe concentration changes in the molecular
species of interest over time. However, the kind of molecular
interactions and the speciﬁc biochemical form they take in a
cellular process are frequently uncertain. Such topological or
structural uncertainty has been previously tackled by defining a
set of candidate models (e.g. see Kuepfer et al., 2007; Toni and
Stumpf, 2010; Xu et al., 2010) that reﬂects different mechanistic
hypotheses. Each of these candidates could in principle encapsu-
late the process, and empirical data can be used to discriminate
between them using available methods for statistical inference
(Akaike, 1973; Kass and Raftery, 1995).

A severe limitation of evaluating all candidate models is that
their number grows exponentially with the number of uncertain-
ties in the model topology. To preselect a subset of candidate
models that is small enough to be analyzed, one can incorporate
all hypotheses into a single master model, which is then reduced
by elimination of hypotheses (Floettmann et al., 2008; Sunnaker
et al., 2013b). However, the resulting subset of models may
not contain any model that satisfactorily explains the experimen-
tal data. Furthermore, the number of model parameters
increases with the number of hypothetical mechanisms, and
model reduction may become infeasible due to the ‘curse of
dimensionality’ (Sunnaker et al., 2013a). If no satisfactory
model emerges from model reduction, or if the number of hypo-
thetical mechanisms is too large, it may be best to start the
inference process from a smaller model that is successively
extended and improved. However, there are few computational
methods available to extend a model by systematically identify-
ing missing terms in a differential equation, or by improving the
existing terms.

Kristensen et a]. (2005) have suggested using stochastic differ-
ential equations (SDEs; kaendal, 2003) instead of ordinary dif-
ferential equations (ODEs) for model construction. In addition
to deterministic terms as in ODEs, SDEs comprise stochastic
terms that account for uncertainty in the realization of trajec-
tories, and the equations’ solution takes the form of a probability
distribution. The method by Kristensen et a]. (2005) exploits that
stochastic equation terms may fill the gap between the model
predictions and the experimental data, and point to the deter-
ministic part of a model’s equations that can be improved. This is
because the estimated level of uncertainty in the prediction of

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0[p1q1x0"sotJButJOJutotq/ﬁduq 11101} pQPBOIHAAOG

91oz ‘Og anﬁnv 110 ::

M.Sunna°ker et al.

 

state variables dictates the impact of each data point on the
estimated model response. Model improvements result in a re-
duction of the estimated magnitude of the stochastic terms, and
the remaining stochastic terms can then be used to pinpoint
model deficiencies. We note that the incorporation of non-
measured variables is commonly used in (linear and discrete-
time) dynamic Bayesian network models used to study genetic
regulatory networks (Beal et al., 2005; Perrin et al., 2003; Wu
et al., 2004). However, the aim of these methods is rather to
compensate for unknown regulators than to infer unmodeled
parts explicitly. Other approaches based on a combined space
of parameters and model structures are computationally expen-
sive due to a combinatorial explosion in model terms (Nachman
et al., 2004; Schmidt et al., 2011).

Here, we propose a novel computational method for model
inference. We call it topological augmentation. It is based on the
ideas by Kristensen et al. (2005) on how to separate uncertainty
in model predictions from measurement noise. In contrast to
previous approaches, it bases conclusions about the system on
characterization of and integration over the parameter space.
The conclusions are not biased by a single parameter point,
but they are valid over a biologically meaningful range of par-
ameter values. The approach also naturally connects to Bayesian
methods for model inference, where the probability of different
hypotheses is based on prior knowledge, and can be iteratively
updated with experimental observations.

2 METHODS

2.1 Topological augmentation

We consider deterministic models in the form of systems of ODEs, where
the state variables describe the concentrations of molecules. Such a
model, which we refer to as M(0), takes the form as follows:

leU), u(t), 0) = MI(X(t), u(t), 0) (1)
h(X(tk)) + 6k, ek ~ N(0, St)

dx(t)

M(()) = { m
Yk

 

with the state variables x(t) 6 ER" (i.e. there are n state variables; other
variable numbers are similarly deﬁned), the potentially time-varying
inputs u(t) e [R'” and the vector of model parameters 0 6 ER". The function
f() (where the dot abbreviates the function arguments) is, in general, a
non-linear vector ﬁeld that describes the dynamics of the state variables,
and may also be expressed as the stoichiometric matrix M e 2"” (integer
entries) times the reaction vector 1'() e R7. The model output yk e [R] at
time point tk, k = 1, . . . , K is generated by a non-linear function h(>) of the
system state variables x(t) and an additive contribution of measurement
noise ek e [R]. Furthermore, the measurement noise is normally distributed
with covariance matrix Sk 6 RM. The available experimental data are
denoted by y 2 [Y1, . . . , Y K], where the subscript denotes the observation
time point. Topological augmentation aims at inferring the form of f(),
given a (biological) system, from a set of experimental data. Note that f()
represents the form of the interactions (e.g. chemical reactions) between
the state variables. Correctly modeled interactions are characterized by a
small difference between model predictions and experimental data, and
this difference is reduced through successive improvements of f().
Models can contain two main sources of uncertainty, commonly
referred to as system noise and measurement noise. System noise can
be further decomposed into two parts, intrinsic noise and topological
uncertainty. Intrinsic noise stems from non-determinism (e.g. random
effects due to small numbers of particles). Topological uncertainty reﬂects
an incomplete understanding of system components and their inter-
actions, which leads to model components that are poorly speciﬁed or

missing. This uncertainty results in model predictions that conﬂict with
experimental observations, e.g. when an indispensable negative feedback
in an oscillating signaling pathway is unknown to the modeler. System
noise can then be incorporated into model predictions, to represent all
processes that are not explicitly described by the ODE model, by formu-
lation of an SDE model. Figure 1A illustrates the different noise sources
revealed by simulation of an SDE model. The ODE solution (smooth
trajectory), which describes the concentration of a hypothetical molecule,
may after incorporation of system noise take the form of the SDE solu-
tion (ﬂuctuating trajectory) for a particular realization. The asterisks in-
dicate the other major source of noise in the data, i.e. measurement noise,
which we added to the SDE model solution to generate in silico a re-
sponse corresponding to experimental measurements.

To infer system properties, it is important that we can separate the
signal (information) from noise, but to identify targets for model im-
provements the system noise must also be separable from measurement
noise. Assume that both types of noise are present at each measurement
time point. The optimal estimate of the molecule concentration in the
system then neither coincides with the average model predictions (due to
system noise) nor with the average experimental measurements (due to
measurement noise). To compute an accurate estimate, we therefore need
to balance the incorporation of information from the model predictions
to the information from the experimental data. If parts of the system are
unmodeled, the concentration of the molecule is better estimated by in-
corporation of system noise. The inﬂuence of each experimental data
point on the estimates is then stronger than without the system noise

 

A B Step 1:
Construction of initial ODE model

so
8 ‘
o

 

 

 

an . * Step 2:
Evaluation of the ODE model

 

 

 

 

Concentration
g

 

 

 

 

 

 

Step 3: _ Step 4:
Model reformulation with SDEs Exploration of the SDE model

 

 

 

 

 

Step 5:
Investigate the viable
parameter distribution \

Step 6 (optional):
Extend/modify the SDE model
Prediction of missing terms

I
V

 

 

 

 

 

 

 

Step 7:
Extend/modify the ODE model

Fig. 1. Flow chart for the computational method. (A) Simulation of a
linear ODE model with one compartment of the form: dx/dt = —0.2x
(smooth trajectory), as well as the corresponding SDE model:
dick 2 —0.2)Ekdt+ dek, dwk ~ N(0, ltk — tkzl |) (ﬂuctuating trajectory).
In both models the initial condition x0 = i0 = 100, the output
yk = )3, + ek and 6;, ~N(0,0.05)?,E) (time index: k = 0, ..., 10).
Artiﬁcial data yk are denoted by stars. (B) The method, and model in-
ference process, starts from a basic model with a minimal set of mech-
anisms. If the basic model is not sufﬁcient, the ODEs are reformulated as
SDEs, and the SDE model is explored. The distribution of viable param-
eter points and (optionally) an extended SDE model for detailed predic-
tions are used to guide improvements of the ODE model. The procedure
is repeated for each generated model until a sufﬁciently descriptive model
has been constructed

 

 

 

 

 

 

 

 

112 /310's112u1n0fp10}x0"sotwurJOJutotq/ﬁduq 11101} papeorumoq

9103 ‘Og isnﬁnv 110 ::

Topological augmentation

 

(see Supplementary Data, section 2). If the system noise does not stem
from intrinsic noise, we can infer that the ODE model is missing a part,
which leads to incorrect estimation of the molecule’s concentration.

Topological augmentation systematically quantiﬁes and reduces topo-
logical uncertainty by identifying correct deterministic system components
in an iterative fashion (Fig. 1B). In step 1, we construct an initial ODE
model based on well-known core components of the studied system; no
hypothetical mechanisms are included in the model at this stage. Typically,
elementary reactions derived from basic kinetic principles, such as mass
action kinetics, will be incorporated in such an initial ODE model.

In step 2, we evaluate the ODE model deﬁned previously by investi-
gating whether the model is compatible with the available experimental
data. We have previously deﬁned a formal viability criterion for param-
eter points in ODE models based on the expected log-likelihood for a
model with a parameterization that captures all regularities in the data:

E((), y, M,) 5 ln (eaﬂ‘laz'ref |S|> (2)

where parameter point 0 is viable in model M ,- if Equation (2) is satisﬁed,
or is the acceptable deviation in number of standard deviations for par-
ameter viability, ,8 = K x l is the number of data points and S e Rﬁxﬁ is a
diagonal covariance matrix for the measurement noise with the block
matrices Sk,k = 1, ...,K in the diagonal [see Sunnaker et al. (2013b)
and Supplementary Data, section 3]. Aspects of the model predictions
not captured by the viability criterion should also be checked, e.g. that the
model predictions do not systematically over- or underestimate the ob-
servations. We characterize the part of a model’s parameter space that is
compatible with experimental data instead of assessing model quality at a
single (optimal) parameter point. This is particularly important if the
model parameter values are not uniquely identiﬁable because different
parameter points may render different predictions of unobserved vari-
ables. If the model ﬁt is satisfactory, there is no reason to further improve
the model structure until new incompatible observations have been
obtained.

Step 3 involves reformulation of the ODE model from step 1 [Equation
(1)] as a system of SDEs:

dx(t) = f(x, u, 0)dt + ado) = Mr(x(t), u(t), 0)dt + ado) (3)

where o- 6 RM" quantiﬁes the uncertainty in the model predictions and
w 6 ER" is a Wiener process, a time-continuous stochastic process whose
variance increases linearly with time (mo 2 0 and am — w,“ ~
N(0, |tk — tk,1|I)). The SDEs are written in differential form, as dd—"t’
cannot be treated analytically (Overgaard et al., 2005). The model in
Equation (3) reduces to the form of the ODE models in Equation (1) if
a- vanishes. The additional term ado) represents the system noise, i.e. the
combined effect of inherent noise and topological uncertainty. The system
noise can only be completely eliminated through model improvements if
the inherent noise is assumed to be negligible (i.e. for a large number of
molecules). The system noise term of an SDE is commonly referred to as
the diffusion term, whereas the deterministic term f(>)dt is referred to as
the drift term. If the coefﬁcients of the Wiener process (0') cannot be
experimentally measured, they can instead be parameterized and esti-
mated from the experimental data.

Step 4 explores the parameter space of the SDE model. The SDEs in
Equation (3) comprise three types of tunable parameters: ODE model
parameters 0, elements of the matrix a- and elements of the set of meas-
urement covariance matrices S = {$1, . . . , SK}, and we denote the set of
all potential parameters by p = {0, a, S}. Parameter points of ODE
models are typically evaluated based on objective functions that rely on
the (least squares) distance between model predictions and experimental
data. However, the elements of o- and S cannot be estimated by compar-
ing model simulations to data, as the generated state trajectories are dif-
ferent for each simulation of the SDE model. Following Overgaard et al.
(2005), we surmount this issue with an extended Kalman ﬁlter modiﬁed

for SDEs (Kristensen et al., 2005) (see Supplementary Data, section 2).
Based on the entries of S and a, the Kalman ﬁlter assigns ‘weights of trust’
to the experimental data and to the simulations at the experimental time
points, separating noise from signal in the experimental data. For negli-
gible values of S (and non-negligible values of a), the Kalman ﬁlter pre-
dictions coincide with the experimental measurements. On the other hand,
for negligible values of o- (and non-negligible values of S) the Kalman
ﬁlter’s predictions equal the ODE model predictions. Therefore, we can
estimate S and o- by varying the corresponding parameters.

The quality of a model with a certain parameterization is measured by
a cost function E(p|y) [see Supplementary Data and Equation (5)]. The
evaluation of a given parameter point with the Kalman ﬁlter maps to a
unique value of the cost function (despite the use of SDEs). Each eval-
uated parameter point is classiﬁed as viable or non-viable, for a given cost
function cutoff value, and we refer to the union of the regions of viable
parameter points as the viable space. Because the viability criterion for
ODE models [Equation (2)] is not valid for SDE models, we instead
deﬁne a viability cutoff based on the distance to the optimal parameter
point (for details see Supplementary Data, section 3). We then use the
method by Zamora-Sillero et al., 2011 to sample the parameter space and
to characterize the viable space. In the ﬁrst part of this method, the par-
ameter space is sampled as broadly as possible with a variant of the
MetropolisiHastings Markov chain Monte Carlo method that is de-
signed for this purpose. The high-likelihood regions identiﬁed in the
ﬁrst step are then characterized in detail in the second step, with an
approach based on ellipsoid expansions [see Supplementary Data, section
4 and Zamora-Sillero et al., 2011 for details].

In step 5, we investigate the viable parameter distribution to identify
model parts with potential for improvements. Small entries of o- in the
viable region of parameter space indicate that f() correctly represents the
underlying system. In contrast, large entries of 0' indicate room for model
improvements. Because each entry of 0' corresponds to one speciﬁc SDE
in the model, one can pinpoint speciﬁc equations that are sensible can-
didates for modiﬁcations. We identify non-negligible entries of o- by visual
inspection, but heuristics may be used to automatize the process.

In step 6, we extend the SDE model based on the analysis in step 5 to
predict missing model parts in step 7. This step is optional, intended to
provide additional support for the decision process in step 7. The SDE
model extensions should be incorporated as additional state variables in
r(), or by extending r() with additional reactions for entries of a- that are
non-negligible. For the additional state variables, xA, we deﬁne the fol-
lowing SDEs:

dXA = UAde (4)

where the trajectories of the state variables xA are determined solely by
the diffusion terms. In models for which there are reasons to suspect that
a particular parameter is not constant, it may be useful to reformulate
that parameter into a state variable [together with an SDE in the form of
Equation (4)]. After exploring the parameter space of the extended SDE
model, the SDE’s behavior is simulated for viable parameter points to
infer the trajectories of the additional state variables xA. The Kalman
ﬁlter used for parameter space explorations can also be used to infer the
trajectories of xA in time because 0A and the drift term of the SDE model
from step 3 together determine how the state variables evolve. The add-
itional terms xA may improve the SDE model by compensating for miss-
ing model parts (despite the unknown mathematical form of the drift
term).

In step 7, we make an informed decision about reaction terms to be
added to the ODE model based on the information from step 5 (reactions
to which these terms should be added) and step 6 (form of the reaction
terms). In accordance with Occam’s razor, we add reaction terms that are

as simple as possible. For example, the term xAl where k1 and k2

_ le
_ k2+x’
are parameters, is reasonable if xAl becomes saturated over time (where
the increasing state variable xAl is a function of x).

 

223

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Zduq 11101} papeolumoq

9103 ‘Og isnﬁnv 110 ::

M.Sunna°ker et al.

 

After step 7, we return to step 2 to evaluate the extended ODE model.
If this model is satisfactory, the model construction process is complete, if
not, steps 377 are repeated. Once a satisfactory model has been con-
structed it can be useful to compare the performance of the ODE
models (and potentially SDE models) that were generated in the process.
To compare two models M,- and M], given experimental data y and
known measurement noise S, we compute the Bayes factor (Kass and
Raftery, 1995):

__ _p(y|M,-) _ [(9,170] l 0, M01709 l M0010
” _p(ylM,-) _ 0,1701% 1141);?(0lMJ-)d0

 

(5)

where O,- and @1- are the parameter spaces for models M,- and M ,, respect-
ively. Bayes factors estimate the relative plausibility of two models, and
they directly relate to the ratio of posterior model probabilities by:

[7(Mily) = __I7(Mi)

pth l y) "ptM,-)
For equal prior model probabilities, p(M,-) = p(]llj), the Bayes factor
equals the ratio of the posterior model probabilities.

 

(6)

2.2 Pharmacokinetic model

To illustrate the workﬂow of topological augmentation, we reinvestigate
a pharmacokinetic model for the absorption of an orally administered
drug into the bloodstream (Kristensen et al., 2005). The model has two
state variables that represent the availability of the drug in the gastro-
intestinal tract (Q, mg) and in the blood plasma (C, mg/l):

dQ _ VmaxQ
dt — KM + Q

 

dC 1VmaxQ 1
E-tKWQ—rCLC (7)

 

The model’s four parameters are Vmax (maximal transport rate from the
gastrointestinal tract to the blood plasma), KM (the concentration of Q
that gives a half-maximal reaction rate), CL (clearance rate of the drug in
the blood plasma) and V (volume of the blood plasma). We assume that
C can be measured at K discrete time points, and we use a proportional
measurement error model as Kristensen et al. (2005):

yk=Ck(1+6k),ek~N(0,S),k=1, ...,K (8)

to generate an in silico set of 20 data points (for details see Supplementary
Data, section 5).

Let us now assume that the absorption kinetics described by the
model’s non-linear term is unknown. A reasonable ﬁrst representation
of the drug kinetics is a linear uptake term modeled with mass action
kinetics, in combination with a linear term for the degradation of the drug
concentration in the blood plasma. However, this model cannot describe
the observational data well: it tends to systematically overestimate or
underestimate the synthetic data (see Fig. 2A).

The SDE model, in step 3, takes the form [Equation (3)] as follows:

(29% :lCl _°,)(:;)dt+...

( “1 °)("‘”i) 
— 301 02 also,2
where the two reactions in the linear model are as follows:

r1 = kAQ (10)
with parameter kA, and the internal drug degradation reaction:

r2 = C LC (11)

 

 

 

 

 

0 50 100 200 250 300 *4 *3

150 72 ‘
time (min) '09 a1

    

lo a 50 mo 250 m
g 1

time (min)
Fig. 2. Pharmacokinetic model. (A) Fit of the linear pharmacokinetic
model to the synthetic data (stars) for state variable C. To save compu-
tational time, the prediction was based on a randomly drawn subset
(10000 points) of all identiﬁed viable parameter points. (B) Projection
of the six-dimensional parameter space onto the plane formed by param-
eters 01 and 02 in the interval [—4, 0] (log-space), for the linear model
(yellow), ﬁnal MM model (blue) and the MM model with C L = 1 (red).
The scale bar shows the negative log-likelihood of p given y for the viable
parameter points (indicated by the color). (C) Projections of the viable
space into 01, 02 and 03 for the linear three state variables pharmacoki-
netic model (viability threshold: 731.5). (D) Predicted evolution of state
variable kA in the linear three state variables pharmacokinetic model. The
shaded regions correspond to the (likelihood) weighted model predictions
mean plus/minus one weighted standard error (Gatz and Smith et al.,
1995) of C (A) and kA (D), respectively

The initial linear ODE model corresponds to setting 01 = 0 and 02 = 0. If
the initial conditions and measurement noise S are known then ﬁve model
parameters are unknown (k A, C L, V, 01 and 02).

We explored the parameter space of the SDE model over a broad
range of values (eight orders of magnitude) for all ﬁve unknown param-
eters (step 4). The cost function Figure 2B (yellow region) shows the
projections of the viable parameter points to 01 and 02. The viable par-
ameter space is visualized in logarithmic space in all figures.

In step 5, we investigate the organization of the viable space. Its pro-
jection onto the axes 01 and 02 has roughly the shape of a boomerang
(Fig. 2B). Importantly, there is no viable parameter point for which the
values of both 01 and 02 are negligible simultaneously. Kristensen et al.
(2005), who analyzed the same model with a method based on a single
parameter set, concluded that 01 (but not 02) is necessary to explain the
observational data. Topological augmentation shows that this assertion is
correct only in some regions of the parameter space (the lower right part
of the boomerang-shaped region) but incorrect in other regions (the
upper left part). This illustrates the importance of characterizing a
model’s behavior for a large set of parameters.

The distribution of viable parameter points indicates that the ODE
model needs to be improved, but it is not immediately clear which of the
two reactions should be targeted because inclusion of either 01 or 02 is
sufﬁcient to explain the data, depending on the region of the parameter
space. Because only C is measured, 01 cannot be used to correct for
misspeciﬁcations in r2; this would introduce an error in r1 through the
ﬁrst SDE. However, 02, which only appears in the second SDE, can be
used to correct r1 without introducing additional structural errors. To
illustrate this idea, we ﬁxed CL = 1 (CL = 0.05 for the data). The viable
parameter points projected onto 01 and 02 in Figure 2B (red region)

 

224

112 /310's112u1n0fp101x0"sotwurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

Topological augmentation

 

indicate that 01, but not 02, can be eliminated. Hence, reaction r1, as
deﬁned in Equation (10), should be improved. However, this can not
be inferred directly from parameter optimizations, or explorations of
the viable parameter space.

We attempt to determine the correct form of reaction r1 by creating an
extended SDE model (step 6) where parameter kA in r1 is considered as a
state variable (Kristensen et al., 2005):

dkA 203603 

This reformulated SDE model defined by Equations (9) and (12) enables
us to evaluate whether and how reaction r1 can be improved. The pro-
jections of the viable parameter space (Fig. 2C) show that it is necessary
and sufﬁcient to include 03: there are viable parameters close to the axes
for 01 and 02, but not for 03. Hence, if we can ﬁnd the correct form of kA,
the corresponding ODE model will be compatible with the observational
data. To determine the form of kA, we use the extended Kalman ﬁlter to
predict the trajectory of state variable kA. Although kA increases to sat-
uration (Fig. 2D), the external drug concentration decreases until deple-
tion in the same time interval (Supplementary Fig. S1). Therefore, a
reasonable expression for kA is as follows:

_ Vmﬂx
KM + Q

where Vmax and KM are additional model parameters.
In step 7, we use this expression for kA to construct a new SDE model

on the form of Equation (9) but with r1 =  (r2 = C LC). The projec-
tion of the model’s viable parameter points onto 01 and 02 (Fig. 2B, blue
region) shows that now both parameters are negligible, as viable points
exist in the lower left corner of the parameter region. The posterior
probabilities [Equations (5) and (6)] for the eight models (Mng) that
can be constructed by eliminating combinations of 01 and 02 from the
linear SDE model and from the non-linear SDE model (see
Supplementary Table S3) indicate that the ﬁnal non-linear ODE model
M8 is >1015 times more probable to be correct than the initial linear
model M4. M8 has the form of Equation (7), which is also the model
we used to generate the in silico data.

kA

 

(13)

 

2.3 Glutamine transport in yeast

Environmental perturbations may provoke global changes in the regula-
tion of a cell’s metabolome and transcriptome (Moxley et al., 2009). In
particular, yeast (Saccharomyces cerevisiae) cells respond to the availabil-
ity of nitrogen sources in the environment with clear preferences.
Nitrogen-rich sources such as glutamine or ammonium directly activate
the so-called nitrogen catabolite repression (NCR) mechanism (via Gln3,
Gatl, Da180 and sz3), which is not activated for poor nitrogen sources
such as proline or urea (Hofman-Bang, 1999). However, nitrogen-limited
conditions trigger a response in the target-of-rapamycin pathway, which
concomitantly activates the NCR-repressed genes via the Gln3 transcrip-
tion factor (Georis et al., 2009).

Four glutamine permeases are known in S.cerevisiae: Gapl (Risinger
et al., 2006), anl (Zhu et al., 1996), Agpl (Schreve et al., 1998) and
DipS (Regenberg et al., 1998). Transport can occur against a glutamine
gradient due to an antiport mechanism that expels KJr ions. Regulation
and transport capabilities of the permeases are heterogeneous. Cells re-
press the expression of Gap] and Agpl under nitrogen-rich conditions,
but not of anl or DipS. Furthermore, permease afﬁnities for glutamine
are in the millimolar range for anl, Agpl and DipS, but in the micro-
molar range for Gapl. Such complexity is required for the homeostasis of
amino acids in the cell. The lack of regulation of the corresponding
permeases leads to inhibition of cell growth and lethal cytotoxic effects
due to amino acid imbalance (Risinger et al., 2006).

To infer the relevance and roles of individual glutamine permeases
during a metabolic shift, we grew a S. cerevisiae batch culture on a

medium with both glutamine and proline as nitrogen sources (see
Supplementary Data, section 6). During the initial steady state growth
the culture consumes the preferred nitrogen source glutamine exclusively,
and on glutamine depletion a metabolic shift to proline consumption
occurs. We studied this dynamic transition by recording 14 and 23 data
points for intracellular and extracellular glutamine concentrations, re-
spectively (Fig. 3A).

The permeases’ functional diversity complicates the search for a cor-
rect dynamic model of glutamine transport. Therefore, we applied topo-
logical augmentation to infer a model of the yeast glutamine uptake
process. In our starting simplistic transport model, all of the four per-
meases are functionally identical and the single glutamine uptake reaction
is described by MichaelisiMenten (MM) kinetics (see also Supplementary
Data, section 7.1):

u
49 — — r _ g
7 = “’1 = I” 0 (I) (14)
%  r1 — r2) 76 —1 r 2

where x = (Q C )T with Q and C the glutamine concentrations in the

medium and in an average cell, respectively, U represents the number of

cells at a given time (Supplementary Fig. S4) and V6 and Vf are the cellular
and the culture medium volumes, respectively. The single glutamine uptake

 

Tl
- l/ , . .
reactlon has the rate r1 = KT‘TXQ , where VTl IS the maxlmum rate of glu-

max
M +9

tamine transport and K15] is the concentration of external glutamine for
which the transport rate is half-maximal. The intracellular glutamine deg-
radation reaction has the form r2 2 DC, where D is the rate parameter for
the degradation of C (Supplementary Data, section 7.1).

Although viable parameter points exist for this model (Supplementary
Fig. S5), the dynamics of the intracellular glutamine concentration is sys-
tematically underestimated (Fig. 3A). Therefore, we reformulated the
ODE model into an SDE model (see Supplementary Data, section 7.1).

1’
W
m
3
\S

;

H1” is Z 1:

Concentration (mM)
to

 

-1
-am «on >2ou 0 2m) 3 5 -1o -5 n

:L
8

 

time (min) '09 c’1

C 15
TC
-— 10
E
‘l’
O
‘— 5
X
v

o

—600 —400 —290 o 200
trme(m|n)

Fig. 3. Yeast glutamine transport. (A) Experimentally determined intra-
cellular (red circles) and extracellular (blue circles) glutamine concentra-
tions and MM model trajectories (lines). The metabolic shift starts at time
point 0min. The weighted mean and the (small) weighted standard error
(Gatz and Smith et al., 1995) of the trajectories are shown. (B) Projection
of the viable space for the SDE version of the MM model into 01 and 02
(parameter points whose likelihood is within ﬁve orders of magnitude
from the most likely parameter point are considered viable). (C)
Weighted mean prediction of state variable kA (black curve) for the ex-
tended SDE version of the MM model, where the gray area is the
weighted standard error of the mean for the viable parameter points

 

225

112 /310's112u1n0fp101x0"sotwurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

M.Sunna°ker et al.

 

The organization of this SDE model’s viable space (Fig. 3B) reveals
that a non-negligible 01 improves the model, whereas 02 can be elimi-
nated. The distribution of viable values for 01 indicates an inconsistency
between reaction r1 and the corresponding reaction in the system. Hence,
the model may not yet capture the different functions of the permeases
well. Gapl is subject to tight dynamic regulation (Risinger et al., 2006),
which reinforces the idea of introducing an additional term in the MM
model. Quantitative experimental data by Risinger et al. (2006) showed
that the reversible activation of Gapl is due to amino acid depletion.
Therefore, we constructed an extended model version (step 6) with a
new state variable W:

dW: 03dw3 

where 03 is a parameter. Reaction r1 contains a new hypothetical term,
rhyp, in a modiﬁed form:

VigiQ VTng

rh =m—+KWQ (16)
YP 

r =
1 Kit + Q

Initially, the variable K20 and K2] whenever Q<ra, where
parameter 1,, is inferred from experimental data (Supplementary
Data, section 7.1). With this choice of K, we anticipated that the
extra reaction term becomes important for small external glutamine
concentrations. We then explored the viable parameter space for the
extended SDE model and simulated the trajectories for W (Fig. 3C;
see also Supplementary Fig. S6 illustrating that individual parameter
points may be less predictive). Strikingly, the model predicts that the
contribution of rhyp is negligible until W rapidly increases ~15H20 min
after the metabolic shift starts. It continues to increase gradually, but
more slowly for around 100 min, which resembles a previously
observed activation pattern for glutamine permeases under NCR con-
trol (Supplementary Fig. S7). Afterwards, W saturates and it remains
constant until the end of the experiment. However, the SDE model is
not the ﬁnal result but a step in the process to infer a proper ODE
model.

Next, we constructed an extended model of cellular glutamine uptake
(step 7). We used the predictions of the extended SDE model to con-
struct a regulated MM (rMM) model consisting of two MM terms that
account for two independent transport regimes, with and without NCR
control (see Supplementary Data, section 7.2). anl and DipS, which
are not subject to NCR regulation, have millimolar afﬁnities
(Regenberg et al., 1998; Zhu et al., 1996). Of the regulated terms only
Agpl has an afﬁnity in the millimolar range, but not Gapl, whose
afﬁnity is in the micromolar range. To discriminate between the roles
of Agpl and Gapl, we ﬁrst investigated both glutamine afﬁnity par-
ameters of the rMM model in the millimolar range. The descriptive
power of the rMM model is notably improved compared with the
MM model (Fig. 4A).

To investigate whether the rMM model (with afﬁnities in the millimo-
lar range) could be further improved or not, we reformulated the ODE
model as an SDE model. Its viable space, shown in Fig. 4C, suggests that
01 and 02 can be simultaneously eliminated, which means that the 0'
parameters cannot guide further modeling efforts. However, as yeast
cells harbor four different glutamine permeases, we also investigated
two extended ODE models that incorporate additional glutamine
uptake reactions. Model elrMM is based on the rMM model, but an
additional MM term accounts for the activity of a third permease (in the
millimolar range). This model accounts for the potentially different roles
of anl and DipS. Model e2rMM incorporates yet another regulated
MM term (in the micromolar range corresponding to Gapl) to allow for
different roles for all four permeases (see Supplementary Data, section 7.3
and Figs S9 and S10).

To compare the performance of all four candidate models, we com-
puted the posterior probabilities for the models (see Fig. 4D). This let us
conclude that the rMM model is the best model. It has two MM terms

Concentration (mM)
.

 

ea 0 ions «90 72w
time (min) log D

a stem ,
i210
’215

-220

Probability

>230

 

’235
0 MM rMM 81 MM e2rMM
(3) (e) (a) (1D)

 

Fig. 4. The rMM model results. (A) Experimental data for external (blue
dots) and intracellular (red dots) glutamine concentrations and model
simulations [weighted mean (solid lines) and weighted standard error
(Gatz and Smith et al., 1995) (shaded regions) of the predicted trajectories
constructed from the uniformly sampled viable space]. (B) The six-
dimensional viable space projected into three structural parameters. We
uniformly sampled the region that contains viable parameter points. The
cost function value associated with each parameter point, E(p|y)
[Supplementary Data, Equation (5)], is mapped onto a color scale. (C)
Projection of viable points (within ﬁve orders of magnitude from the most
likely parameter point) to 01 and 02 for the SDE version of the rMM
model. (D) Posterior probabilities for glutamine transport models
(number of parameters in parentheses; for convergences see
Supplementary Fig. S11)

that correspond to two transport regimes, both operating in the millimo-
lar range. They represent a constitutively active transport mechanism and
the action of a permease that is speciﬁcally regulated for low external
glutamine concentrations, respectively. A straightforward interpretation
of these results is that the second transport mechanism is dominated by
Agpl rather than Gapl under our experimental conditions. Additionally,
the rMM model predicts that the activity of the second transporter is
triggered by low levels of external glutamine, at ~4mM ((1,1) = 4.2 mM
in Supplementary Fig. S8A). Finally, we conclude that topological aug-
mentation helped us to infer these aspects of glutamine transport, and
therefore is likely to prove useful for inference of various other aspects of
biochemical systems.

3 DISCUSSION

Topological augmentation is a method designed to infer bio-
chemical models in the face of uncertainties about their structure.
It classiﬁes and quantifies topological uncertainties that emerge
from experimental observations. The method starts from an
(usually too simple) ODE model, which it reformulates with
SDEs, and relies on the distribution of Viable parameter points
obtained from random sampling to reveal the presence and the
form of missing or incomplete reactions. Motivated by current
gaps in the biological understanding of glutamine transport in
yeast, we developed a model for glutamine transport and gener-
ated experimental data for topological augmentation.
Interestingly, this analysis indicated a subsidiary role of Gapl

 

226

112 /310's112u1n0fp101x0"sotwurJOJHtotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv 110 ::

Topological augmentation

 

in the glutamine uptake process under the studied experimental
conditions. In contrast to most other methods for model infer-
ence, we use observational data to explicitly guide the attention
of the modeler to mechanisms for which there is room for im-
provements. Related, earlier SDE-based approaches evaluate an
SDE model at a single parameter point (Kristensen et al., 2005).
Predictions based on a single parameter point can be misleading,
as demonstrated by our pharmacokinetics application, even in
combination with a local sensitivity analysis. Our extended ap-
proach that incorporates a distribution of Viable parameter
points provides substantially more information about potential
model improvements. We showed that it can not only pinpoint
missing reaction terms but also help ﬁnding the mathematical
form of the missing terms.

We see ﬁve potential limitations of topological augmentation:
ﬁrst, sampling parameter spaces is computationally more costly
than identifying a single optimal parameter point; this limita-
tion could be overcome by future more efﬁcient methods to
characterize Viable parameter spaces. Second, each model has
to be evaluated individually, which limits the number of models
that can be evaluated. However, with the distribution of a-
guiding model identiﬁcation, topological augmentation can
reduce the number of candidate models. Third, characterizing
noise in complex biochemical systems with multiple variables
can be difﬁcult. The organization and geometry of Viable par-
ameter spaces may prevent identification of a single best model
improvement. In this case, one can iteratively evaluate add-
itional or modified reaction terms, based on biological know-
ledge and on information from the distribution of a- in a Viable
space. Fourth, topological augmentation may not be applicable
to systems with much inherent noise (e.g. involving molecules
with a low copy number). It is impossible to separate such noise
from topological uncertainty. Finally, two steps of topological
augmentation are currently not automatized and require some
degree of human expertise and judgment in the execution. In
step 5, we Visually inspect the parameter space to identify non-
negligible system noise terms (entries of 0'). However, this step
could be automatized with the topological ﬁltering method pro-
posed in Sunnaker et al. (2013b), which uses a parameter space
exploration in combination with investigations of the effect of
eliminated parameters. By identiﬁcation of essential system
noise parameters, it is possible to point to model parts with a
potential for improvements in an automated fashion. In (the
optional) step 6 of topological augmentation, additional terms
are added to the SDEs, and a (potentially non-unique) mapping
of the inferred temporal proﬁles of the unknown mechanisms
to new ODE model terms is applied. It is important to keep in
mind that the selected reaction terms must have a biological
interpretation, and one approach would therefore be to con-
struct a dictionary with biologically feasible reactions. Only
terms that are specified in the dictionary are then candidates
for incorporation into the model, e. g. based on symbolic regres-
sion (Schmidt et al., 2011).

These limitations notwithstanding, topological augmentation
can help to construct models systematically and rigorously in
biochemistry and systems biology, but not only in these fields.
It can be applied to infer the structure of any model based on
ODEs.

ACKNOWLEDGEMENTS

The authors thank Alberto Giovanni Busetto and Sotiris
Dimopoulos for comments and discussions. Elias Zamora-
Sillero and Adrian Lopez Garc1a de Lomana contributed equally
to this article.

Funding: Swiss Initiative for Systems Biology SystemsX.ch
evaluated by the Swiss National Science Foundation WeastX
project).

Conflict of Interest: none declared.

REFERENCES

Akaike,H. (1973) Information theory and an extension of the maximum likelihood
principle. In: 2nd International Symposium on Information Theory. pp. 2677281.

Beal,M. et al. (2005) A Bayesian approach to reconstructing genetic regulatory
networks with hidden factors. Bioinformatics, 21, 3497356.

Floettmann,J. et al. (2008) ModelMage: a tool for automatic model generation,
selection and management. Genome Inform, 20, 52$3.

Gatz,D. and Smith,L. (1995) The standard error of a weighted mean concentratione
I. bootstrapping vs other methods. Atmos. Environ, 29, 118571193.

Georis,A. et al. (2009) Nitrogen catabolite repression—sensitive transcription as a
readout of Tor pathway regulation: the genetic background, reporter gene and
GATA factor assayed determine the outcomes. Genetics, 181, 8617874.

Hofman—Bang,J. (1999) Nitrogen catabolite repression in Saccharomyces cerevisiae.
Mol Biotechnol, 12, 3273.

Kass,R.E. and Raftery,A.E. (1995) Bayes factors. J. Am. Stat. Assoc., 90, 7737795.

Kristensen,N.R. et al. (2005) Using stochastic differential equations for PK/PD
model development., J. Pharmacokinet. Pharmacodyn., 32, 1097141.

Kuepfer,L. et al. (2007) Ensemble modeling for analysis of cell signaling dynamics.
Nat. Biotechnol, 25, 100171006.

Moxley,J.F. et al. (2009) Linking high—resolution metabolic ﬂux phenotypes and
transcriptional regulation in yeast modulated by the global regulator Gcn4p.
Proc. Natl Acad. Sci. USA, 106, 6477$482.

Nachman,I. et al. (2004) Inferring quantitative models of regulatory networks from
expression data. Bioinformatics, 20 (SuppL l), i2487i256.

kaendal,B.K. (2003) Stochastic Dyferential Equations: An Introduction with
Applications. Springer—Verlag, New York.

Overgaard,R.V. et al. (2005) Non—linear mixed—effects models with stochastic
differential equations: implementation of an estimation algorithm.
J. Pharmacokinet. Pharmacodyn., 32, 82107.

Perrin,B—E. et al. (2003) Gene networks inference using dynamic Bayesian networks.
Bioinformatics, l9 (SuppL 2), iil387iil48.

Regenberg,B. et al. (1998) Dip5p mediates high—afﬁnity and high—capacity transport
of L—glutamate and L—aspartate in Saccharomyces cerevisiae. Curr. Genet., 33,
1717177.

Risinger,A.L. et al. (2006) Activity—dependent reversible inactivation of the general
amino acid permease. Mol Biol. Cell, 17, 441174419.

Schmidt,M.D. et al. (2011) Automated reﬁnement and inference of analytical
models for metabolic networks. Phys. Biol, 8, 055011.

Schreve,J.L. et al. (1998) The Saccharomyces cerevisiae YCCS (YCL025c) gene
encodes an amino acid permease, Agpl, which transports asparagine and
glutamine. J. Bacteriol, 180, 255G2559.

Sunnaker,M. et al. (2013a) Approximate bayesian computation. PLoS Comput.
Biol, 9, e1002803.

Sunnaker,M. et al. (2013b) Automatic generation of predictive dynamic models
reveals nuclear phosphorylation as the key Msn2 control mechanism. Sci.
Signal, 6, ra41.

Toni,T. and Stumpf,M.P. (2010) Simulation—based model selection for dynamical
systems in systems and population biology. Bioinformatics, 26, 104410.

Wu,I. et al. (2004) Modeling gene expression from microarray expression data with
state—space equations. Pac. Symp. Biocomput., 9, 5817592.

Xu,T—R. et al. (2010) Inferring signaling pathway topologies from multiple perturb—
ation measurements of speciﬁc biochemical species. Sci. Signal, 3, ra20.

Zamora—Sillero,E. et al. (2011) Efﬁcient characterization of high—dimensional par—
ameter spaces for systems biology. BMC Syst. Biol, 5, 142.

Zhu,X. et al. (1996) GNPl, the high—afﬁnity glutamine permease of S. cerevisiae.
Curr. Genet., 30, 1077114.

 

227

112 /310'S[BHJDOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papeo1um0q

9103 ‘0g1sn8nv 110 ::

