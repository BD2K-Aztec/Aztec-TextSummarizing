BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

S.Duchéne et al.

 

missing branch is assigned a length of 0. The BSDmin metric is based on
the branchiscore distance (Kuhner and Felsenstein, 1994). The branch-
score distance depends on the total tree length, so it is necessary to min-
imize its value. This can be accomplished by using a scaling factor (3) to
scale the branch lengths for one of the trees. Finding s such that the
branch-score distance is minimized is straightforward with linear opti-
mization algorithms (see Supplementary Figs S1 and S2).

Values of BSDmin are not comparable across different pairs of trees
because they depend on absolute branch lengths. To minimize this prob-
lem, the branch lengths need to be rescaled. For each pairwise compari-
son of trees, we have chosen to rescale the branch lengths such that their
average is 0.05 across the two trees. This is an arbitrary value to allow
comparison of the trees. The branch lengths of each tree are rescaled
jointly to preserve the pattern of among-lineage rate variation. BSDmin
is then recalculated using the rescaled branch lengths to give a scaled
BSDmin value, sBSDmin.

After estimating sl'BSDmin for all pairs of trees, ClockstaR finds the
optimal number of partitions, known as k. This step involves assigning
data subsets to partitions (known as ‘clusters’ in mathematical literature)
for 1 5 k 5 N — 1, where N is the number of data subsets. The implemen-
tation in ClockstaR uses the Partitioning Along Medoids (PAM) algo-
rithm described by Kaufman and Rousseeuw (2009). For every value of
k, the Gap statistic is calculated (Tibshirani et al., 2001). This is a good-
ness-of-clustering measure that compares the mean dispersion of the data
with that of bootstrap reference datasets, with higher values indicating
better fit. The default number of bootstrap replicates is 500, which ap-
pears to be sufficient for large datasets (Tibshirani et al., 2001), but this
can be changed by the user. The optimal number of partitions is deter-
mined as the lowest value of k that yields a peak in the Gap statistic. We
used the implementation of these algorithms in the cluster R package
(Maechler et al., 2012).

ClockstaR returns a folder with the results of the analysis. It includes a
text file with the partition assignments at the optimal value of k, tables
with the sl'BSDmin and tree scaling factors (3) and two pdf files containing
a dendrogram of sBSDmin, a plot of the Gap statistic and the partition
assignments for values of k from k=1 to k=N—1 (see Supplementary
Information).

3 RESULTS

We tested the performance of ClockstaR using datasets gener—
ated under known conditions. We considered two simulation
scenarios and conducted 20 replicates for each scenario.
Sequence evolution was simulated using the J ukesiCantor
model along phylogenetic trees with 20 tips to produce 10 align—
ments of 1000 nt. For the first simulation scenario, we simulated
all of the data according to a single relaxed clock. We used a tree
with branch lengths sampled from the absolute values of a
normal distribution with mean 0.01 and a standard deviation
of 0.01. In this scenario, we expected a single group of genes
(k: 1).

In the second simulation scenario, we simulated sequence evo—
lution according to one of three different relaxed clocks. This was
done by simulating along three trees, which had identical topol—
ogies but had branch lengths sampled independently from the
distribution described for the first simulation. We generated
three sequence alignments for each of the first two trees, and
four sequence alignments for the third tree. For the simulation
of each alignment, we included noise in the branch lengths of the
form N (0,10_4) to represent stochastic variation among align—
ments. In this scenario, we expected three groups of genes
(k = 3).

ClockstaR identiﬁed the correct partitioning scheme for the 20
datasets simulated under each scenario (Supplementary Figs S3A
and S4A for the first scenario, and Supplementary Figs S3B and
S4B for the second scenario). The analysis of the simulated data
with three different relaxed clocks took 8.35 min to run on a Mac
G5 with a 2.95—GHz Quad—Core Intel Xeon processor and 16 GB
of RAM. We have included an option to parallelize the steps for
substitution—model selection and the estimation of sBSDmin. The
parallelized version took 2. 10 min using four cores on the same
machine.

To illustrate the use of ClockstaR on empirical data, we
analyzed multigene datasets from pinnipeds (15 nuclear and 12
mitochondrial genes) and human papillomavirus type 16 (eight
genes) (Supplementary Information). For the pinniped data, we
found that the optimal partitioning strategy consisted of two
groups, one for the nuclear and one for the mitochondrial
genes. For the human papillomavirus data, the optimal partition—
ing scheme involved a single clock model for all genes
(Supplementary Figs S3 and S4).

By analyzing the relative rate variation among lineages,
ClockstaR provides a fast alternative to conducting extensive
comparisons using Bayesian and likelihood methods. The
method assumes that the data subsets share the same tree top—
ology. However, we do not consider this to be a limitation of the
method because data subsets with different topologies should not
be concatenated. Instead, they should be assigned separate tree
models, which would necessitate the use of separate clock
models. One important consideration is that the method deter—
mines the optimal partitioning strategy, but it does not test com—
peting molecular—clock models. This requires rigorous statistical
testing with other methods, such as Bayes factors (Baele et a].
2012). A potential alternative, although more computationally
intensive, is reversible—jump Markov chain Monte Carlo, which
has been implemented for substitution—model selection (Wu
et al., 2013) but not for molecular—clock models.

We believe that our method will be particularly useful for im—
proving molecular—clock analyses of phylogenomic data, which
are often hindered by their computational requirements.

ACKNOWLEDGEMENTS

The authors thank anonymous reviewers for useful comments on
earlier versions of our manuscript and ClockstaR.

Funding: This work was supported by the Australian Research
Council [DP110100383 to S.Y.W.H.].

Conﬂict of Interest: None declared.

REFERENCES

Baele,G. et a]. (2012) Improving the accuracy of demographic and molecular clock
model comparison while accommodating phylogenetic uncertainty. Mol. Biol.
Evol., 29, 215772167.

Drummond,A.J. et a]. (2006) Relaxed phylogenetics and dating with conﬁdence.
PLoS Biol, 4, e88.

Drummond,A.J. and Rambaut,A. (2007) BEAST: Bayesian evolutionary analysis
by sampling trees. BMC Evol. Biol, 7, 214.

Ho,S.Y.W. and Lanfear,R. (2010) Improved characterisation of among—lineage rate
variation in cetacean mitogenomes using codon—partitioned relaxed clocks.
Mitochondrial DNA, 21, 1387146.

 

1018

ﬁm'spzumol‘pmﬂo'sopeuuopuorq/ﬁdnq

ClockstaR

 

Kaufman,L. and Rousseeuw,P.J. (2009) Finding Groups in Data: An Introduction to
Cluster Analusis. 1st edn. Wiley—Interscience, Hoboken, NJ.

Kuhner,M.K. and Felsenstein,J. (1994) A simulation comparison of phylogeny al—
gorithms under equal and unequal evolutionary rates. Mol Biol. Evol, 11,
4597468.

Lanfear,R. et a]. (2012) PartitionFinder: combined selection of partitioning schemes
and substitution models for phylogenetic analyses. Mol Biol. Evol, 29,
169571701.

R Development Core Team (2011) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Maechler,M. et al. (2012) Cluster: Cluster Analysis Basics and Extensions. R
Statistics Package (CRAN).

Schliep,K.P. (2011) phangorn: phylogenetic analysis in R. Bioinﬁ)rmaties, 27,
5927593.

Schwarz,G. (1978) Estimating the dimension of a model. Ann. Statist., 6, 4614164.

Tibshirani,R. et a]. (2001) Estimating the number of clusters in a data set via the gap
smtistic. J. R. Stat. Soc. Ser. B, 63, 4114123.

Thorne,J.T. et a]. (1998) Estimating the rate of evolution of the rate of molecular
evolution. Mol Biol. Evol, 15, 164771657.

Wu,C.H. et a]. (2013) Bayesian selection of nucleotide substitution models and their
site assignments. Mol Biol. Evol, 30, 66%688.

Xie,W. et a]. (2011) Improving marginal likelihood estimation for Bayesian phylo—
genetic model selection. Syst. Biol, 60, 1507160.

Yang,Z. and Rannala,B. (2006) Bayesian estimation of species divergence times
under a molecular clock using multiple fossil calibrations with soft bounds.
Mol Biol. Evol, 23, 2127226.

Zuckerkandl,E. and Pauling,L. (1962) Molecular disease, evolution, and genetic
heterogeneity. In: Kasha,M. and Pullman,B. (eds) Horizons in Biochemistry.
Academic Press, New York, pp. 1897225.

 

1019

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOICI”Idllq

