Bioinformatics, 31 (22), 2015, 3712—371 4

doi: 10.1093/bioinformatics/btv416

Advance Access Publication Date: 17 July 2015
Applications Note

 

Systems biology

Ranim: a tool to compare biochemical

reactions

Varun Giri1, Tadi Venkata Sivakumar1, Kwang Myung Choz,

Tae Yong Kim2'* and Anirban Bhaduri1'*

1Bioinformatics Lab, Samsung Advanced Institute of Technology, Bangalore 560037, India and 2Biomaterials Lab,
Materials Center, Samsung Advanced Institute of Technology, Gyeonggi-do 443803, Korea

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on April 6, 2015; revised on July 13, 2015; accepted on July 13, 2015

Abstract

Summary: Quantitative assessment of chemical reaction similarity aids database searches, classifi—
cation of reactions and identification of candidate enzymes. Most methods evaluate reaction simi—
larity based on chemical transformation patterns. We describe a tool, Ranim, which computes re—
action similarity based on the molecular signatures of participating molecules. The tool is able to
compare reactions based on similarities of substrates and products in addition to their transform—
ation. It allows masking of user—defined chemical moieties for weighted similarity computations.
Availability and implementation: Ranim is implemented in R and is freely available from the
Comprehensive R Archive Network, CRAN (http://cran.r—project.org/web/packages/Ranim/).
Contact: anirban.b@samsung.com orty76.kim@samsung.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Reaction similarity is used to classify biochemical reactions
(Egelhofer et al., 2010), assess enzyme similarity (O’Boyle et al.,
2007), plan molecular syntheses (Gasteiger et al., 1992), search reac—
tion databases (Hu et al., 2011) and annotate new function to en—
zymes (Carbonell and Faulon, 2010). These methods were
developed analogous to molecular similarity (Johnson and
Maggiora, 1990; Willett et al., 1998) wherein presence of key mo—
lecular signatures is encoded as bits in a feature vector and com—
pared to compute similarity. For reaction similarity, signatures of
transformation pattern are encoded into a reaction fingerprint (or
feature vector) and used to compute similarity (de Groot et al.,
2009; Carbonell and Faulon, 2010; Rahman et al., 2014; Schneider
et al., 2015; Chem/1x071 Docs; Daylight Theory Manual).

Present approaches evaluate reaction similarity by comparing
transformation patterns. Comparison with respect to substrates re—
quires additional assessment. Ranim evaluates reaction similarity
by comparing molecular signatures of individual molecules involved
in the reactions. Molecular signatures implicitly encode transform—
ation patterns. Accuracy of such approaches is limited by presence

of large chemical moieties, such as ATP (de Groot et al., 2009;
Rahman et al., 2014). To overcome this, Ranim provides methods
to mask user—defined moieties for weighted similarity computations.

2 Methods

Ranim is designed to compute biochemical reaction similarity by
comparing molecular signatures of input reactions. Each reaction is
associated with a set of binary fingerprint vectors, denoted by F,
derived from signatures of constituent molecules. This set is con—
structed using three methods capturing molecular signatures at dif—
ferent levels of granularity. The first method extracts molecular
signatures at a level of individual molecules. The set of fingerprints,
FM, contains a fingerprint vector corresponding to each molecule in
the reaction. FM : {fm Va 6 S; fb,Vb E P}, fa represents fingerprint
of molecule a, S and P represent the substrate set and product set of
reaction, respectively. The second method constructs a set, F371), con—
taining two fingerprint vectors, one each for the substrate and prod—
uct side. Each fingerprint records molecular signatures obtained
from all molecules that are part of the substrate and product set,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3712

 

91oz ‘Og JSanV 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /3.10'speum0fp1q1x0"sotJBuiJOJutotq/ﬁduq 11101} popcolumoq

Ranim

3713

 

respectively. F371) : {meVa 6 S; Zfb,Vb E P}, where, 2 denotes
addition (binary OR) of fingerprint vectors. The third and most
granular set, FR, contains only one fingerprint capturing molecular
signatures from all the molecules in the reaction.
FR : {212, Va 6 S, P}. Ranim uses these sets of fingerprint vectors
to compute reaction similarity based on four algorithms, namely,
msim, msim_max, rsim and rsimZ. msim and msim_max infer reac—
tion similarity with respect to individual molecules and use FM for
similarity computations. rsim is based upon similarities of the sub—
strate and product sides while rsimZ considers the reaction as a
whole for similarity assessment. They use Fsﬁp and FR for similarity
computations, respectively.

msim pairs each substrate (product) in one reaction with a sub—
strate (products) in the other based on pair—wise molecular similarity
values (computed using similarity metric such as Jaccard coefficient)
using a greedy algorithm. Reaction similarity is computed by averag—
ing molecular similarity values of identified pairs while considering
a ‘0’ value for each unpaired molecule. A modified version of this al—
gorithm, msim_max, ignores unpaired molecules while computing
the reaction similarity. rsim computes reaction similarity as the aver—
age of the substrate and product side similarities. rsimZ directly uses
reaction fingerprints to compute the reaction similarity. For revers—
ible reactions, the substrate and product sides are also cross com—
pared and the maximum of the two similarity values is reported.

For brevity discussion in the text is limited to use of fingerprints.
The method may be extended to user defined feature—vectors.

3 Features and description

Ranim is implemented as an R package (R Core Team, 2015,
http://www.R—project.org/). It imports chemoinformatic functional—
ity from the rcdk and fingerprints packages (Cuba, 2007). Input re—
actions are accepted in the form of reaction SMILES (RSMI) or
MDL RXN files. The tool can compute similarity between a pair of
reactions or list(s) of reactions that are provided as input. It imple—
ments fingerprint caching to reduce computation time on large
datasets.

The tool provides four algorithms to compute reaction similar—
ity, viz., msim, msim_max, rsim and rsimZ. Performance of these al—
gorithms was measured based on their ability to identify similar
reactions (following method of Rahman et al., 2014). Reactions
sharing similar EC number at level 3 were considered similar. All—
by—all comparison of 4828 reactions (with EC number assigned)
drawn from the Rhea database (v.59, Morgat et al., 2015) was per—
formed. Distributions of reaction similarities (Fig. 1a) show a me—
dian score of ~0.2 for msim and rsim algorithms. msim shows a
prediction accuracy of more than 95% for a cut—off of 0.55 and the

 

 

 

 

 

(3)3. (b):—
“i. “P.
g D g C)
2
g 2 a:
E . g .
g 0 E 0
III _
ii 2 3 e
'33. Q.
o I I I I o I I I I I
msim rsim m2 0.0 0.2 0.4 M 0.3 LEI

Mane false positive tam

Fig. 1. Comparison of msim, rsim and rsim2 algorithms implemented in
Ranim. (a) Density plots of reaction similarity scores. (b) Receiver operator
characteristic (ROC) plot showing effectiveness of three algorithms (AUC
order msim>rsim>rsim2)

area under ROC curve (AUC) was found to be 0.90 (Fig. 1b). The
shape of the distribution and the accuracy for msim is comparable
to that of the ‘reaction center metric’ of EC—BLAST (Rahman et al.,
2014). AUCs for rsim and rsimZ were found to be 0.84 and 0.74, re—
spectively. rsim and rsimZ are more useful for analysis of datasets
that are known to have common features, such as, catalysis by same
enzyme or having same transformation.

The nature of assessment and data govern the choice of finger—
prints and similarity metrics (Todeschini et al., 2012; Riniker and
Landrum, 2013). Ranim allows various customizations for similar—
ity computations as described below. It also allows choice of finger—
prints and similarity metric. Within the tool, 12 fingerprints (10 bit
and 2 count feature vectors) and 20 similarity metrics are provided
(see Section S1 of supplementary materials).A detailed demonstra—
tion of the features is available through R’s demo utility (section S2)

3.1 Substructure masking and reaction similarity
Molecules involving large moieties that are inert to reaction process
(not participating in the reaction), may adversely inﬂuence the simi—
larity values (de Groot et al., 2009, Rahman et al., 2014). An ap—
proach to overcome this is to reduce their weightage towards
similarity computation. Ranim implements a method that masks
user—defined chemical substructures, provided as SMARTS or
SMILES, present in a molecule. Section S3 discusses the impact of
masking on similarity values, considering 50 molecules with
Coenzyme A (CoA) moiety.

As reaction similarity is based on molecular signatures of indi—
vidual molecules, this effect also percolates to reaction similarity
(see Section S4). The presence of large cofactor molecules such as
ATP, have similar effect on reaction similarity computations using
the rsim and rsimZ algorithms. Masking such molecules would have
a similar effect on reaction similarity computations as seen for the
molecular similarity (see Section S4).

3.2 Querying partial or unbalanced reactions

Enzyme identification for biochemical pathways often requires com—
paring partial or mass unbalanced reactions. Similarity computa—
tions based on the reaction transformation patterns usually require
mass balanced reaction and are of limited use. msim_max computes
reaction similarity based on the similarity of molecules in the input
and is particularly designed to address such scenarios (see Section
S5). rsim and rsimZ may also be used along with cofactor masking.

3.3 User—defined reaction database

Ranim can compare input reactions against a customized database
of biochemical reactions provided as a ﬂat—file. The search on this
database can also be restricted based on the EC number range. This
feature is helpful in assessing alternate enzymatic pathways. The
proposed tool provides a ﬂat—file containing biochemical reactions
extracted from the Rhea database (Morgat et al., 2015).

Acknowledgements

The authors acknowledge support provided by Samsung Advanced Institute
of Technology. The authors also thank the anonymous reviewers for their
feedback.

Conﬂict of Interest: none declared.

91oz ‘Og Isnﬁnv uo seleﬁuv soc] ‘BIHJOJIIBQ JO AJISJQAqu] 112 /310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq moi; popcolumoq

3714

V. Giri et al.

 

References

Carbonell,P. and Faulon,I.L. (2010) Molecular signatures—based prediction of
enzyme promiscuity. Bioinformatics, 26, 2012—2019.

de Groot,M.I. et al. (2009) Metabolite and reaction inference based on enzyme
speciﬁcities. Bioinformatics, 25, 2975—2982.

Egelhofer,V. et al. (2010) Automated assignment of EC numbers. PLoS
Comput. Biol., 6, e1000661.

Gasteiger,I. et al. (1992) Similarity concepts for the planning of organic reac-
tions and syntheses. I. Chem. Inf. Comput. Sci., 32, 700—712.

Guha,R. (2007) Chemical informatics functionality in R. I. Stat. Softm, 18, 1—16.

Hu,Q.N. et al. (2011) Raninder: biochemical reaction search engines using
molecular structures, molecular fragments and reaction similarity.
Bioinformatics, 27, 2465—2467.

Iohnson,A.M. and Maggiora,G.M. (1990) Concepts and Applications of
Molecular Similarity. Wiley, New York.

Morgat,A. et al. (2015) Updates in Rhea—a manually curated resource of bio—
chemical reactions. Nucl. Acids Res., 43, D45 9—D464.

O’Boyle,N. et al. (2007) Using reaction mechanism to measure enzyme simi-
larity.I. Mol. Biol., 368, 1484—1499.

Rahman,S.A. et al. (2014) EC-BLAST: a tool to automatically search and com—
pare enzyme reactions. Nat. Methods, 11, 171—174.

Riniker,S. and Landrum,G.A. (2013) Open—source platform to benchmark ﬁn—
gerprints for ligand-based virtual screening. I. Cheminform., 5, 26.

Schneider,N. et al. (2015) Development of a novel ﬁngerprint for chemical re—
actions and its application to large-scale reaction classiﬁcation and similar-
ity.I. Chem. Inﬁ Model., 55, 39—53.

Todeschini,R. et al. (2012) Similarity coefﬁcients for binary chemoinformatics
data: overview and extended comparison using simulated and real data sets.
I. Chem. Inf. Model, 52, 2884—2901.

Willett,P. et al. (1998) Chemical similarity searching. I. Chem. Inﬁ Sci., 38,
983—996.

9103 ‘Og Isnﬁnv uo seleﬁuv soc] ‘BIHJOJIIBQ JO AJISJQAqu] 112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”Idllq moi; pepcolumoq

