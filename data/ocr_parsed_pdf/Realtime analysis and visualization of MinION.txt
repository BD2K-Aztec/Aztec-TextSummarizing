Bioinformatics, 32(5), 2016, 764—766
doi: 10.1093/bioinformatics/btv658
Advance Access Publication Date: 10 November 2015

 

Applications Note

 

Genome analysis

Realtime analysis and visualization of MinION
sequencing data with npReader

Minh Duc Cao1'*, Devika Ganesamoorthy1, Matthew A. Cooper1 and
Lachlan J. M. Coin1'2'*

1Institute for Molecular Bioscience, The University of Queensland, Brisbane, OLD, Australia and 2Department of
Genomics of Common Disease, Imperial College London, London W12 DNN, UK

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on June 25, 2015; revised on August 5, 2015; accepted on November 4, 2015

Abstract

Motivation: The recently released Oxford Nanopore MinION sequencing platform presents many in—
novative features opening up potential for a range of applications not previously possible. Among
these features, the ability to sequence in real—time provides a unique opportunity for many time—crit—
ical applications. While many software packages have been developed to analyze its data, there is
still a lack of toolkits that support the streaming and real—time analysis of MinION sequencing data.
Results: We developed npReader, an open—source software package to facilitate real—time analysis
of MinION sequencing data. npReader can simultaneously extract sequence reads and stream
them to downstream analysis pipelines while the samples are being sequenced on the MinION
device. It provides a command line interface for easy integration into a bioinformatics work flow,
as well as a graphical user interface which concurrently displays the statistics of the run. It also
provides an application programming interface for development of streaming algorithms in order
to fully utilize the extent of nanopore sequencing potential.

Availability and implementation: npReader is written in Java and is freely available at https://
github.com/mdcao/npReader.

Contact: m.cao1@uq.edu.au or |.coin@imb.uq.edu.au

 

1 IntrOducuon diagnosis. While several excellent software packages (e.g. Loman and

The recent introduction of the Oxford Nanopore MinION sequenc—
ing platform has added a new dimension into genomics sequencing.
The platform can read ultra long DNA segments due to the ability
to directly sense DNA fragments with biological nanopores without
the need of amplification. Its portability also proves useful to many
studies under critical conditions such as disease outbreaks and field
work. A number of labs around the world have been evaluating the
platform through the MinION Access Programme (MAP), and have
also used the platform to develop numerous novel applications.

One of the most innovative features of the Oxford Nanopore
MinION platform is that it can output sequence reads in real—time, i.e.
the electrical current data and the base—called sequence of a DNA frag—
ment can be obtained as soon as it passed through the nanopore. This is
attractive for many time critical applications such as rapid infection

Quinlan 2014; Watson et al. 2015 were introduced as soon as the
MinION devices were released, there is still a lack of tools supporting
the extraction and analysis of MinION sequence data in real—time.

We developed npReader, an open—source software package to
facilitate real—time analysis of Oxford Nanopore MinION sequenc—
ing data. npReader is written in Java and hence can run seamlessly
on any platforms with minimal dependency. It provides a ﬂexible
and comprehensible command line interface, allowing it to be easily
incorporated into an analysis pipeline. In addition, it provides a
Graphical User Interface (GUI) for users to visually assess the statis—
tics of the run. The package also provides a Java Application
Programming Interface (API) allowing developers to extract both
based—called sequences and native electrical current data to further
develop algorithms for other analyses.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 764

9103 ‘Org JSanV uo salaﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} popcolumoq

Realtime analysis and visualization of MinION sequencing data

765

 

2 Methods

A MinION device can sequence an array of DNA fragments in parallel.
As the DNA fragment translocates through a pore and changes the elec—
trical charge of the pore, the electrical current is captured. The sequence
of electrical signal is then translated (base—called) to a possible DNA
sequence by the cloud—based Metrichor suite. The various types of data
for the fragment, including the native electrical events, event timings
and base—called sequence, are stored in a FAST5 format file.

As soon as a DNA fragment is sequenced by the MinION and base—
called by the Metrichor cloud, npReader opens the FAST5 file contain—
ing the sequence read, extracts the desired information for an initial
analysis, and streams the sequence read in FASTA or FASTQ format to
one or more real—time analysis pipelines such as that in (Cao et 41].,
2015). These pipelines can be run on the same computer or on comput—
ing clouds. This will extend the range of applications one can analyze in
real—time beyond what currently provided by the Metrichor service.

npReader provides a comprehensible and ﬂexible command line
interface, thus can be easily integrated into any existing bioinfor—
matics workﬂow. From the command line, users can specifically
select sequence reads that are suitable for the downstream analysis,
such as reads with a certain length and quality. The package also
contains tools for further binning reads based on their type, length
and quality. npReader can also run in GUI mode, enabling the use
of pointing devices. Under GUI mode, npReader can concurrently
gather and display useful statistics for the current run (See Fig. 1).
The plots of these statistics are highly customizable and can be
exported to an image format ready for publication.

npReader is developed in Java. The package includes all the
necessary libraries, such as that for statistical analysis and visualiza—
tion, hence requires minimal dependency. Apart from the Java
Runtime Environment, the only extra dependency is the HDF5
library which is the core for FAST5 format. As a Java application,
npReader can run seamlessly cross platforms including Linux,
Windows and OSX and hence allows users to run on the laptop

a o harm-are Pea-Jar

Input

Folder containing base-called reads

Read count

connecting to the MinION device or on high performance comput—
ing clusters and computing clouds.

Following the recent Oxford Nanopore announcements of their
upcoming sequencing platforms, PromethION and GridION, we
recognized the need for the development of streaming algorithms to
analyze large volumes of sequencing data in real—time. To support
this, npReader provides a Java application programming interface
to allow researchers to simultaneously retrieve base—called sequences
as well as the raw Nanopore event data. The following code snippet
demonstrates the extraction of the two dimensional sequence and
the event sequence from a FAST5 file within a Java program.

import j apsa . seq . nanopore . NanoporeReader;

NanoporeReader reader
: new NanoporeReader (fileName) ;
reader.readData () ;
reader.close();
//Get 2D read
Fasthequence read2D :reader . getSeq2D () ;
//Get the squiggle signals
DetectedEvents events : reader . getEvents () ;

3 Discussion

The npReader package provides a simple and yet powerful solution for
analysis of MinION sequencing data in real—time. It provides a GUI to
allow users to visually examine quality statistics of a run when a DNA
sample is being sequenced. Importantly, it can extract the desired infor—
mation from the run simultaneously and stream into multiple down—
stream analysis pipelines on high performance computing facilities or
on computing clouds, thereby facilitating real—time analysis of the DNA
sample. This will allow answering the biological questions at hand in a
timely manner, and as soon as sufficient data are obtained.

 

Read length histogram

 

-...n.-:- g'v' In II: .-I .Elr: .r...

Output

- . -.'|,'-I|I u. ...rr;..r rr- 1|:

Read numbe

r. ,-|:..J| :t. -:

.il ,. ,_,,. notes

in. Stream output to some sewers

Tatalfastsﬁles 733

Output famat Pass ﬁles 357
2" Pasta . fasta Fail files n23

4
Options 2” reads as

Template reads 650

_.,:.-..  -- :r-: I..r-- .:..r m .|.I :r. -- : |.-.r-i

 

. Complement reads 450
:.r. -:. “i ;- -- .: .m- .-r :r-  :- n .-...-

Min read length

--r .Jli Stop

 

 

I omplenrent I template

 

 

 

 

120
10':-
E so
3 _
U '30
JD
20
0
0 10.000 20.090 30.000 40.900 50.000
mm, length
I Read Length
Quality
0.3:-

 

 

\, k
a“; .
- 15 20

qualityI

— 2D complement — template

 

 

Fig. 1. A screen shot of npReader. User can specify options of data to be extracted and details of outputs in the left panel. The right panel displays statistics of

data, including read counts, read length histogram and read quality in real-time

9103 ‘Org JSanV uo salaﬁuv soc} ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /3.IO'S[BIImOfp.IOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} popcolumoq

766

M.D.Cao et al.

 

Acknowledgement

We would like to thank Oxford Nanopore Technologies Ltd employees and
MAP participants for providing feedback to our work.

Funding

The research is funded by the National Health and Medical Research Council
(NHMRC) Project Grant [GNT1052303]; LC is supported by an Australian
Research Council Future Fellowship [FT110100972].

Conﬂict of Interest: none declared.

References

Cao,M.D. et al. (2015 ) Real-time strain typing and analysis of antibiotic resist-
ance potential using Nanopore MinION sequencing. bioinu doi:10.1101/
019356.

Loman,N.J. and Quinlan,A.R. (2014) Poretools: a toolkit for analyzing nano—
pore sequence data. Bioinformatics, 30, 3399—3401.

Watson,M. et al. (2015) poRe: an R package for the visualization and analysis
of nanopore sequencing data. Bioinformatics, 31, 114—115.

9103 ‘Org isanV uo salaﬁuv soc} ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Zduq 11101} popcolumoq

