ORIGINAL PAPER

Vol. 26 no. 24 2010, pages 3090-3097
doi: 1 0. 1093/bioinformatics/btq592

 

Gene expression

Advance Access publication October 19, 2010

Model-free unsupervised gene set screening based on
information enrichment in expression profiles
Atushi Niida1’*, Seiya Imotol, Rui Yamaguchil, Masao Nagasakil, Andr Fujitaz,

Teppei Shimamura1 and Satoru Miyano1

1Human Genome Center, Institute of Medical Science, University of Tokyo, 4—6—1 Shirokanedai, Minato—ku, Tokyo
108—8639 and 2Computational Science Research Program, RIKEN, 2—1 Hirosawa, Wako, Saitama 351 —01 98, Japan

Associate Editor: Trey Ideker

 

ABSTRACT

Motivation: A number of unsupervised gene set screening methods
have recently been developed for search of putative functional
gene sets based on their expression profiles. Most of the methods
statistically evaluate whether the expression profiles of each gene
set are fit to assumed models: e.g. co-expression across all samples
or a subgroup of samples. However, it is possible that they fail to
capture informative gene sets whose expression profiles are not fit
to the assumed models.

Results: To overcome this limitation, we propose a model-
free unsupervised gene set screening method, Matrix Information
Enrichment Analysis (MIEA). Without assuming any specific models,
MIEA screens gene sets based on information richness of their
expression profiles. We extensively compared the performance of
MIEA to those of other unsupervised gene set screening methods,
using various types of simulated and real data. The benchmark tests
demonstrated that MIEA can detect singular expression profiles that
the other methods fail to find, and performs broadly well for various
types of input data. Taken together, this study introduces MIEA as
a broadly applicable gene set screening tool for mining regulatory
programs from transcriptome data.

Contact: aniida@ims.u-tokyo.ac.jp

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 16, 2010; revised on September 10, 2010;
accepted on October 15, 2010

1 INTRODUCTION

Recently, a number of gene set screening methods have been
introduced successfully to analyze regulatory programs hidden in
transcriptome data. While classical microarray analyses focus on
individual genes, gene set screening methods search a prescribed
gene set library for gene sets with informative expression proﬁles
in given transcriptome data. By treating a gene set as a unit, these
methods enhance statistical power as well as make results easier to
biologically interpret. For example, Gene Set Enrichment Analysis
(GSEA), which ﬁnds gene sets showing differential expression
between two sample groups (Subramanian et (11., 2005), has become
one of the pivotal tools for transcriptome analysis. A lot of other
methods employing similar supervised approach are used to search

 

*To whom correspondence should be addressed.

for gene sets associated with given sample labels (Huang et al.,
2009).

However, if we want to globally search for putatively functional
gene sets, irrespectively of association with sample labels, we need
another approach that does not rely on supervision of sample labels,
i.e. the unsupervised approach. For this purpose, Segal et al. (2004)
proposed a method to ﬁnd a set of genes whose expressions are
induced or repressed in any samples based on a hypergeometric
test. Although their pioneering method realizes an unsupervised
approach, this method can also be regarded as a kind of supervised
method in that it tests differential expression between a single sample
and the others. We recently proposed an unsupervised method,
Extraction of Expression Module (EEM) to search for gene sets that
have signiﬁcantly large subsets of genes coherently expressed in the
input transcriptome data (Niida et al., 2009a). Kim et al. (2007)
also proposed a method termed Gene Set Expression Coherence
Analysis (GSECA), which selects gene sets based on expression
coherence. GSECA is different from EEM in that GSECA measures
expression coherence, taking into account all the members in the
gene set rather than focusing on the coherent subset. Since EEM
assumes that a signiﬁcant gene set is co-expressed across all samples,
it is possible that EEM fails to capture gene sets that exhibit coherent
expression patterns across only a subset of samples. To overcome
this limitation, we also developed an extended version of EEM
termed Biclustering-based EEM (BEEM), which takes advantage
of a biclustering algorithm (Bergmann et (11., 2003) to identify gene
sets coherently expressed in a subgroup of samples (Niida et al.,
2010).

Compared with the supervised approach, few gene set screening
methods have so far employed the unsupervised approach, and also
there remain some problems to be solved in the existing methods. For
example, although EEM and BEEM evaluate expression coherence
of an input gene set based on speciﬁc models, i.e. co-expression
across all samples or a subgroup of samples, it is possible that
such a model-based method fails to capture informative expression
proﬁles that do not ﬁt to the assumed model. To address this
problem, we developed a novel model-free method termed MIEA
(Matrix Information Enrichment Analysis). Without assuming any
speciﬁc model, MIEA evaluates information in expression proﬁles;
therefore, it could be used to search for gene sets associated with
any types of informative expression proﬁles.

In order to reveal the properties of MIEA and other unsupervised
gene set screening methods, we extensively performed benchmark
tests to compare their performances using both simulated and

 

3090 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

Model-free unsupervised gene set screening

 

real data. These benchmark tests showed that MIEA can capture
signiﬁcant gene sets which the other methods miss, and is broadly
applicable to various types of transcriptome data and gene sets.
Together with the other unsupervised gene set screening methods,
MIEA would be a useﬁil gene set screening tool for mining
regulatory programs from transcriptome data.

2 METHODS
2.1 MIEA

Let E and M denote an ng X n, input expression matrix and a gene set of |M |
genes, respectively. The rows and columns of E index genes and samples, and
the elements of each row vector are normalized so that the mean is O and the
variance is 1. From E, we extract the row vectors corresponding to the genes
in M and obtain a |M | X n, sub-matrix EM. Generally, to evaluate informative
patterns in EM, unsupervised gene set screening methods employ statistics
based on their own speciﬁc models. For example, EEM uses the maximal-
sized coherent subset of M in EM as the test statistic. Namely, EEM assumes
a speciﬁc model for informative patterns in EM: informative patterns should
be coherent expression of a large subset of M. Note that it is possible that
model-based methods like EEM fail to detect informative patterns in EM if
the patterns do not ﬁt to the assumed model, or are too complex to explain
based on one simple model. To overcome this limitation, we proposed a
model-free method, MIEA. The MIEA statistic scores information richness
of EM without assuming any speciﬁc model, but taking advantage of singular
value decomposition (SVD).

Let X denote an n X in matrix and its rank is r. Note that, without loss of
generality, we assume an, and therefore r 5m holds. The SVD theorem
states (Press et al., 1992):

x = USVT.

where U is an n><m matrix whose columns are the left singular vectors
uk, and V is an m X in matrix whose column are the right singular vectors
vk. The left and right singular vectors form an orthonormal set, i.e. Vij =
uiTuj-zl for i=j and ViTijuiTuj=0 for [#j. An m><m diagonal matrix S
has diagonal elements s1 3 s2... 3 sm 3 0, which are called singular values.
Furthermore, sk > O for 15k 5 r, and sk :0 for r+l 5 k 5m.

One important result of the SVD of X is that

l
X“) = Zuksk VkT
k:l

is the matrix ofrank-l that minimizes the sum of the squares, Z U(Xij —X [5.1) )2.
This result can be used for data compression of X. If the singular values X]-
rapidly approach to zero for j 31+ 1, we can obtain a good approximation of
X by X“). In other words, if the singular values are uneven, we can assume X
has so much redundancy that can be compressed. When applying hierarchical
clustering to the matrix, this information can be Visualized as non-random
pattern in the heatmap. Therefore, by measuring unevenness of the singular
values, we can know how much information the gene expression matrix has.
To measure unevenness of the singular values, we deﬁne an entropy of the
matrix X by

Ill
d<X> = — Zn. logo»).
k:l
where pk =sk/lsl. Using d(X), we can compare information richness
between matrices of the same dimension; i.e. the less d(X) is, the more
information X should have. We can assume that d(X)=O corresponds to
the most information-rich case that can only be achieved when X=X(l),
while d(X)=log(m) corresponds to the most information-poor case where
all singular values are equal and X has no information to be compressed.
MIEA employs the entropy of EM, d(EM), as a test statistic, and its
statistical signiﬁcance is evaluated by an empirical approach. That is, an
empirical null distribution can be generated by repeatedly sampling random

gene sets whose sizes are equal to that of M , |M|. The P-Value of d(EM)
is obtained by the ratio of the null statistics which are smaller than d(EM).
Namely, the tested null hypothesis is that d(EM) is equal to entropies of equal-
sized random sub-matrices from E. However, relying only on this empirical
approach leads to intensive computational time. Fortunately, we found that,
when |M | is large enough, the empirical null distribution is well approximated
by the normal distribution. Based on this observation, we ﬁrst sample 1000
null statistics and apply the Shapiro test to validate their normality. If the
P-Value of the Shapiro test is greater than the cutoff of 0.01, we calculate the
MIEA P-Value by ﬁtting the normal distribution to the 1000 null statistics.
Otherwise, we continue resampling until obtaining 104 null statistics, and
empirically calculate the P-Value from them. Note that, even in the latter
case, computational time is not serious, because gene sets that reject the null
hypothesis of the Shapiro test have relatively small sizes and, for such small
gene sets, computation can be ﬁnished quickly.

2.2 Other methods compared with MIEA

In this study, we compare the performance of MIEA with those of other gene
set screening methods employing unsupervised approach: EEM, BEEM,
GSECA and SSA. Here, we give belief explanations of the competitive
methods.

2.2.] EEM From the input gene set, M , EEM ﬁnds the maximal-sized
subset of M that shows coherent expression across all samples under the
given radius parameter r (Niida et al., 2009a). A coherent subset of M is
represented as:

n.\‘
$34 = {ilieMZwij—cnz : r}.
1:1
where c=(cl,...,c,,_,)T is the vector of the center parameters. The EEM
algorithm is designed to ﬁnd Ezarg maxlSéwl, and the maximal-sized
(I

coherent subset is given as S94. EEM uses |S§4 l as a test statistic to evaluate
expression coherence of M. It is clear that the results of EEM depend on the
value of the radius parameter r. Assuming S2", the maximal-sized coherent
subset for all ng genes, r can be converted to the relative radius rR so that
rR= |Sgll|/ng. We tested relative radius parameters of 005,010 and 0.15,
chose the one which leads to the smallest P-Value, and corrected the P-Value
for multiple testing.

2.2.2 BEEM While EEM measures expression coherence across all
samples, BEEM measures expression coherence in a subset of samples
by employing a biclustering algorithm, ISA (Bergmann et al., 2003). We
assumed a bicluster as a subset of genes that exhibits higher or lower
expressions than a predeﬁned threshold across a subset of samples, and vice
versa. BEEM obtains a subset of M which is associated with a bicluster
in E, and statistically evaluates the size of the bicluster-associated subset.
ISA requires three parameters for specifying two thresholds controlling
the bicluster size and the targeted bicluster types (i.e. upregulated or
downregulated). We performed BEEM with 18 different parameter settings
and obtained multiple testing-corrected P-Values as described by Niida et al.
(2010).

2.2.3 GSECA GSECA is similar to EEM in that GSECA tests expression
coherence of EM. However, although EEM uses the size of the maximal-
sized coherent subset of M to evaluate expression coherence, GSECA uses
the mean of expression correlation values between every pair of genes in M
as the test statistic e (Kim et al., 2007):

2 "I
=— E~E-.
e |M|(|M|—1) Z Z ’i k’

i,keM,i¢kj:1

The P-Value for this statistic is calculated based on an empirical approach
described by Kim et al. (2007); an empirical null distribution was produced
by randomly sampling 105 gene sets whose sizes are equal to |M|.

 

3091

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq 11101} papeolumoq

9103 ‘{g anﬁnv 110::

A.Niida et al.

 

2.2.4 SSA Segal et al. (2004) proposed a method that screens gene sets
without sample label information, relying on over or underexpression in each
sample. However, their method does not explicitly assign P-Value to a single
gene set as the other method does. To make comparison easier, we used a
reformulated version of their method termed SSA, which assigns a single
P-Value to each gene set (Niida et al., 2010).

The j-th column vector of E, E =(E1j, . . . ,Engj)T scores how much each
gene is over or underexpressed in the j-th sample, compared with the average
across all samples. Based on  we obtain the top 5% of the upregulated
genes in the j-th sample, denoted as  SSA tests overlap between the input
gene set M and  based on the hypergeometric test, and a P-Value, p}, for
upregulation of M in the j-th sample is obtained. Similarly, a P-Value, p14 , is
also calculated for downregulation of M in the j-th sample. By calculating
p14 and p? for each sample, we obtain a P-Value vector of length 2><n5,
p=(le‘,p‘l’,...,pZ-V,pi)T. SSA ﬁnally combines p using Fisher’s method
(Fisher, 1932) to obtain a single P-Value to M; if this combined P-Value
is small, it means that M is over or underexpressed in any of the n, samples.

2.3 Generation of simulated data

We simulated expression matrices and gene set libraries for the input data.
Generally, the transcriptome contains sets of co-regulated genes called
expression modules. Genes that belong to the same expression module behave
together at the expression level. We simulated expression matrices of 4000
genes X 100 samples, each of which harbors different types of expression
modules. A simulated gene set library contains positive gene sets, which
have signiﬁcant overlaps with any of the expression modules, and negative
gene sets, which were randomly sampled from the 4000 genes. Unsupervised
gene set screening can be regarded as a process to search for gene sets that
are associated with expression modules; the positive gene sets should be
identiﬁed by unsupervised gene set screening, while the negative gene sets
should not.
To simulate expression matrices, we assumed three different models:

' Coherent model. We assumed that an expression matrix has non-
overlapping 20 modules, each of which consists of 200 module genes.
For each module, we ﬁrst chose one gene and generated its expression
values across samples by the standard Gaussian distribution. That is,
assuming that we chose gene k, we have Ekj ~ N(O, l) forj = l, . . ., 100.
The other module genes were generated so that they gather around
gene k. The expression value of gene i who is a member of the module
generated from gene k is

E0- = ScEkj +(l — semi]- ,

where m]- ~N(O, l) and so is a parameter specifying signal strength.

0 Bicluster model. We assumed that an expression matrix has 50
modules, each of which consists of 200 module genes, and is allowed to
overlap with each other. We randomly selected 200 genes from the 4000
genes to deﬁne module genes of each expression modules. We assumed
the 200 module gene constitute a bicluster, and randomly chose lOOrS
samples as samples that constitute the bicluster in the module. Here,
r, is a parameter specifying the ratio of the samples that constitute a
bicluster. Let Bi]- be an indicator variable, where Bi]- takes 1 if and only
if the expression value of gene i in sample j, EU, belongs to any of the
deﬁned bicluster, or 0 otherwise. We set

Eij =SbBij+Zij.

where {if ~N(O, l) and s}, is a parameter specifying signal strength.

' Sine-wave model. We assumed that an expression matrix has non-
overlapping 20 modules, each of which consists of 200 module genes.
For each module, we randomly shufﬂed indices of samples. The

expression value of the i-th module gene and the sample associated
with the shufﬂed sample index j was then deﬁned as follows:

I n . .
Eijzscsm{§(t+j)}+(l —.sc)eij,

where 6,»!- ~ N(O, l), and so is a parameter specifying signal strength.

We next generated gene set libraries that make pairs with each of the
expression matrices. Each gene set library includes 10 positive and 10
negative gene sets. A positive gene set includes 200rg genes sampled from
one expression module, and randomly sampled 200(1 — rg) genes. Here, rg is
a given parameter specifying the ratio of module genes in the positive gene
set. Ten negative gene sets were prepared by randomly sampling 200 genes.

We additionally simulated another type of gene set library for the
expression matrices of the coherent and bicluster models. For a given
parameter K , the alternative gene set library was prepared so that the 200rg
genes in a positive gene set consist of equal-sized K groups whose members
were sampled from different K modules; i.e. a positive gene set with a larger
K value has a more complex expression proﬁles. Hereafter, we refer to the
paired set of these alternative gene set libraries and the expression matrices
from the coherent and bicluster models as the composite coherent model and
the composite bicluster model, respectively. Note that the models with K = l
are identical to the normal coherent and bicluster models.

2.4 Preparation of real data

We also measured performance of each method using real data. The real
data used in this study include seven expression datasets and ﬁve gene set
libraries.

To prepare the expression datasets, we obtained seven datasets from public
resources. The information of the seven datasets is summarized in Table l.
The data preprocessing was done as described by Niida et al. (2009a). Brieﬂy,
they were scaled to the logarithmic scale, and normalized in each sample.
After the probe set IDs were converted to gene symbols, expression proﬁles
of 6000 or 8000 genes (depending on the original numbers of genes) with
the largest variance were extracted and normalized across samples.

The ﬁve gene set libraries have various types of sources as listed in Table 2.
The PWM gene set library was prepared by predicting downstream target
genes of cis-regulatory motifs, using the proximal promoter sequences and
position weight matrices (PWMS) obtained from the TRANSFAC database
(Matys et al., 2006; Niida et al., 2010). The locus gene set library was
prepared by collecting genes located next to each other on the chromosomes.
To collect such genes, we set a window containing 100 genes adjacent on
the genome, moved the window by 10 genes and kept genes covered by the
window at each position (Niida et al., 2009a). The miRtarget gene set library
was prepared from the MicroCosm Targets database (Grifﬁths-Jones et al.,
2008); genes in each gene set were predicted to have miRNA binding sites
in their 3’UTR with P < 10‘3. The curated and GO gene set libraries are
downloaded from MSing, a database used in GSEA (Subramanian et al.,
2005). Note that not all genes in each gene set were used for our analysis; the
intersection of each gene set and genes in each expression dataset was used
as an actual input gene set. In each gene set screening, we also discarded
gene sets for which the intersection is less than 10.

3 RESULTS
3.1 Simulated data test

We performed a simulation study to compare the performance of
MIEA with those of the four other unsupervised gene set screening
methods: EEM, BEEM, GSCEA and SSA. We simulated input
data based on the ﬁve models: the coherent, composite coherent,
bicluster, composite bicluster and sine-wave models (See examples
in Supplementary Figure S1). Each of which model has several
arbitrary parameters: i.e. rg and sC for the coherent and sine-
wave models; rg, sC and K for the composite coherent model;

 

3092

112 /3.Io's[Bumo[pioixosoueuiioiurorqﬂ:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

Model-free unsupervised gene set screening

 

A The coherent model

D The bicluster model

G The sine-wave model

 

r sc MIEA EEM BEEM GSEC SSA

 

 

 

 

r MIEA EEM BEEM

 

 

0.626

0.1 0.563 0.555 0.513

0.596 0.595 0.653 0.582

0.1 0.570 0.549 0.490 0.592 0.530

0.05 0.646 0.596 0.615 0.574
0.05 0.618 0.540 0.524 0.546
0.05 0.1 0.512 0.573 0.459 0.497 0.529

 

B The

coherent model =2
MIEA EEM BEEM

     
 

   

C The composite coherent model
(r., so) = (0.2, 0.4)

 

 

 

 

 

F The composite bicluster model
(r.. r., Sb) = (0.2, 0.3, 2.0

 

Fig. 1. The AUCs of MIEA, EEM, BEEM, GSECA and SSA when applied to data from the ﬁve simulation models. For each of the ﬁve simulation models,
data were generated using several different parameter settings. The AUCs computed by applying the ﬁve methods to them are presented.

rg, rs and SI, for the bicluster model; and rg, rs, s1, and K for
the composite bicluster model. We used various combinations of
parameter values for each model; therefore, in total, we assumed 53
types of data simulators employing different models and different
parameter settings. We generated 20 Monte Carlo datasets from each
data simulator, and applied each of the ﬁve methods to each of
the 20 datasets. From the results pooled across the 20 simulations,
we calculated speciﬁcity and sensitivity for each method over the
whole range of signiﬁcance cutoffs to depict receiver operating
characteristic (ROC) curves. Speciﬁcity was calculated as the
proportion of negative gene sets whose signiﬁcance is below the
cutoff, while sensitivity is calculated as the proportion of positive
gene sets whose signiﬁcance is above the cutoff. We then computed
the area under the curves (AUCs) as a measure of the performance
of each method, since the AUC assesses the overall discriminative
ability of the method at determining whether a given gene set is
associated with an expression module. The results are summarized
as follows:

° Coherent model. This model assumes that genes in the same
expression module are coherently expressed across all samples,
and a subset of a positive gene set overlaps with any single
expression module. This type of expression modules should
be efﬁciently captured by EEM. Expectedly, EEM performs
best among the ﬁve methods, while BEEM, GSECA and MIEA
follow EEM (Fig. 1A).

° Composite coherent model. This model also assumes coherent
expression modules, but differs in that a positive gene set
is assumed to harbor K subsets overlapping with different
expression modules. Also for the composite coherent model
with K = 2, EEM works best among the ﬁve methods; however,
the performance is attenuated compared with that for the
coherent model. For BEEM and GSECA, we also observed
similar trends; their performances are worse than those for the

 

BEEM
MIEA
GSECA
EEM

PWM
GO

curated
miRta rget

Li.
Z
(D

..
a)
a
._
m
..
D!
E
>.
m
..
L9
.4
«n
N
a:
._
.o

GNF
GNF
GNF

NC|60 miRtarget
StemCells

NCIGO
breastMiller miRtarget

breastGray —

breastGray

StemCells miRtarget
breastGrayCall

StemCells
breastMiller
StamCells
breastGray
breastGrayCell —
breastGray

breastMiller—

 

..
I)
m
a
W
..
p_:
E
E
o
>-
N
._
o
..
In
I“
d)
._
.0

breastGrayCell
breastGra Cell

Fig. 2. The performances of MIA, EEM, BEEM, GSECA and SSA when
applied to various types of real data. We applied the ﬁve methods to the
combinations of the seven microarray datasets and the ﬁve gene set libraries.
The ratios of signiﬁcant gene sets in all the 175 gene set screenings are
Visualized as a heatmap (high ratio: red, low ratio: blue).

coherent model. On the other hand, MIEA does not show any
distinct difference between the results for the two models, and
keeps relatively good performance (Fig. 1B). This observation
prompted us to inspect dependency of these method on the
value of parameter K. We found that the performance of MIEA
is the most robust to the changes of K, and MIEA performs
best for larger K (K :5, 10 and 20 in Fig. 1C).

° Bicluster model. In this model, module genes are assumed to
be overexpressed in a subset of samples. Since this type of
expression module is a target of BEEM, BEEM performs best
for this model. The other methods except SSA also show good
performance (Fig. 1D).

 

3093

112 /3.Io's[Bumo[pioixosoueuiioiurorqﬂ:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

A.Niida et al.

 

Table 1. Expression datasets

 

 

ID The number The number Description Reference

of genes of samples
breastGray 6000 118 Breast tumors Chin et al. (2006)
breastGrayCell 6000 54 Breast cancer cell lines Neve et al. (2006)
breastMiller 8000 251 Breast tumors Miller et al. (2005)
gliomaPhillips 8000 100 Glioma tumors Phillips et al. (2006)
NCI60 8000 60 Various cancer cell lines Shankavaram et al. (2007)
GNF 8000 79 Various tissues Su et al. (2004)
StemCells 6000 291 Various stem cells Muller et al. (2008)

 

Table 2. Gene set libraries

 

ID The number Description
of gene sets

Reference

 

PWM 200 Having common TF binding motifs
locus 1813 Adjacent on the genome

GO 1454 Associated with common GO terms
curated 1892 Curated from the literature

miRtarget 85 1

Matys et al. (2006), Niida et al. (2010)
Niida et al. (2009a)

Subramanian et al. (2005)
Subramanian et al. (2005)

Having common miRNA binding motifs Grifﬁths-J ones et al. (2008)

 

° Composite bicluster model. This model is based on the same
expression module model as the bicluster model, but assumes
that positive gene sets have two subsets associated with
different expression modules. As compared with the bicluster
model, the performance of BEEM is substantially impaired for
the composite bicluster model with K :2. On the other hand,
MIEA, EEM and GSECA remain good choices, although the
performance of EEM is slightly attenuated (Fig. 1E). We also
conﬁrmed that MIEA performs best for large K values in this
model (Fig. 1F).

° Sine-wave model. In this model, expression values of module
genes are deﬁned by the sine function whose phase depends
on the sum of gene and sample indices. A singular expression
module generated from this model seems a difﬁcult target
if the method is based on simple expression module model
like expression coherence and bicluster. A model-free method,
MIEA, successfully retrieves a gene set associated with this
singular expression module. EEM also performs comparably
well, suggesting that EEM is powerful enough to capture
coherent patterns hidden in singular expression modules. The
other three methods hardly work at all (Fig. 1G).

Taken together, MIEA demonstrates relatively good performance
for all the ﬁve models. Especially, it should be noted that MIEA
performs better than the other methods in complex expression
proﬁles generated from the sine-wave model or the composite
models with large K values. This observation suggests that MIEA
is broadly applicable for various types of input data, which is what
we would expect for a model-free method. EEM shows superior
performance for all the ﬁve models, especially for the coherent and
composite coherent models. GSECA is also a good choice except for
the sine-wave model. BEEM is effective for the bicluster model, as
expected. SSA shows the worst performance for all the ﬁve models.

3.2 Real data test

Next, we evaluated the practical performance of the above methods
using real data. The real data include seven microarray datasets and
ﬁve gene set libraries listed in Tables 1 and 2. We performed gene
set screenings by applying MIEA EEM, BEEM, GSCEA and SSA
to every combination of the expression datasets and the gene set
libraries: i.e. (5 methods) X (7 expression datasets) X (5 gene set
libraries) = (175 gene set screenings) were performed.

In each gene set screening, we considered gene sets whose
P-values are less than a cutoff of 10‘4 as signiﬁcant gene sets. To
evaluate the performance of each method, we calculated the ratio
of signiﬁcant gene sets in each gene set screening (Supplementary
Fig. S2). A heatmap of the performance proﬁles across input data
(Fig. 2) reveals that the performance of the four methods except
SSA has similar dependency on the input data while, on average,
GSECA has slightly better performance than others. The four
methods other than SSA show outstandingly high performance for
the combination of the breastGrayCell expression dataset and the
locus gene set library. This observation presumably reﬂects the fact
that in breast cancer cell lines there are some chromosomal regions
whose copy numbers are frequently altered, and the genes residing
on such regions behave together in the transcriptome. Note that
some methods take substantial ratios of the locus gene set library
for expression data from clinical tumor samples, i.e. breastGray
breastMiller and gliomaPhillips. However, it is reasonable that the
data from monoclonal cell lines have much higher signal strength
than those from the mixture of heterogeneous tumor tissues.

On average, the curated and GO gene set libraries tend to contain
more signiﬁcant gene sets across the seven expression datasets.
Although substantial ratios were observed for the PWM gene set
library with some expression datasets, the miRtarget gene set library
contains few signiﬁcant gene sets in most of the expression datasets.
This observation suggests that expression regulations by miRNAs

 

3094

112 /310'S[1211an[pJOJXO'SOIJBLUJOJIIIOIqﬂIdllq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

Model-free unsupervised gene set screening

 

EEM BEEM

      

he

Fig. 3. The 15 groups of expression-gene set pairs taken as signiﬁcant by
MEIA, EEM, BEEM and GSECA. A total of 7267 expression-gene set pairs
signiﬁcant in any of the four methods were divided into 15 groups based
on which method takes them as signiﬁcant, and Visualized using a Venn
diagram.

are hard to be detected at the transcriptome level, consistent with
the previous reports that miRNAs regulate their target genes at
both the transcriptional and post-transcriptional levels (Carthew and
Sontheimer, 2009). Among the ﬁve methods, SSA shows the worst
performance in most of the gene set screenings. Although it shows
high performance for PWM gene set library, this observation might
be only a statistical artifact caused by gene set-size dependency, as
described previously (Niida et al., 2010).

The breastMiller dataset whose matrix size is the largest
(8000 genes X 251 samples) is most associated with signiﬁcant
results. Based on this observation, we checked how much the matrix
size affects the performance of each method. For the breastMiller
and GNF datasets, we downsized expression matrices by randomly
sampling 50, 25 and 12.5% of genes or samples. We then applied
the ﬁve methods to the combination of the curated gene set library
and each of the downsized matrices, and compared the results
with those from the original matrices. This analysis demonstrated
that the performance of each method is relatively robust to the
sample-wise downsizing while the gene-wise downsizing decreases
the performance more severely, especially for SSA (Supplementary
Fig. S3). Among the ﬁve methods, EEM seems the most robust to
both types of the downsizing. Thus, the performance variance is
partially caused by the different sizes of input expression matrices,
and also would reﬂect data qualities and biological properties of
them.

Next, we tried to characterize performance difference by focusing
on each gene set. We omitted SSA from this analysis, because
it shows the worst performance in the above analyses. Since
each library includes hundreds to thousands of gene sets, all the
combinations of the seven expression datasets and ﬁve gene set
libraries yields 350 26 pairs of expression datasets and gene sets.
Hereafter, we refer to each of the pairs simply as an expression-gene
set pair. When we applied MIEA, EEM, BEEM and GSECA to the
35 026 expression-gene set pairs, 7267 pairs scored P-values less
than a cutoff of 10‘4 in any of the four methods. We divided the 7267
pairs into 15 groups based on in which methods they are signiﬁcant.
The Venn diagram visualizing the 15 groups demonstrates that
expression-gene set pairs targeted by the four methods are largely

overlapping, while each method, especially MIEA and GSECA,
has unique expression-gene set pairs which are retrieved by only
one method, but not others (Fig. 3). We also examined which
expression dataset and gene set library is associated with the 15
group of expression-gene set pairs. For each group, we calculated a
hypergeometric P-value for enrichment of the expression-gene set
pairs associated with each expression dataset or each gene set library.
Namely, the P-value for the enrichment was calculated as follows:

IFi'IGI—l N IFI IGI N
I”— Z (IGI—i  i l/lIGIl’
l=0

where G is the group of expression-gene set pairs, F is a set of
expression-gene set pairs associated with a particular expression
dataset or gene set library, and N is the total number of expression-
gene set pairs, i.e. 35 026. Figure 4 shows the association P-value
p in minus log scale. Negative associations (i.e. depletion of the
expression-gene set pairs associated with each expression dataset or
each gene set library) can be measured by l — p, which are shown in
Supplementary Figure S4. We found that the degree of association to
each expression dataset or each gene set library substantially varies
among the 15 groups. For example, expression proﬁles of gene
sets in the GNF expression dataset tend to be targeted uniquely by
BEEM. For the gliomaPhillips dataset, MIEA performs relatively
poor while EEM performs better. For the breastGray expression
datasets, MIEA performs well; it retrieves gene sets that the other
methods fail to ﬁnd. Taken together, these observations suggest that
the four methods have different characteristics to target different
types of expression proﬁles of gene sets.

4 DISCUSSION

In this study, we introduced a new unsupervised model-free gene set
screening method, MIEA, and extensively compared its performance
with those of the four existing unsupervised gene set screening
methods: SSA, EEM, BEEM and GSECA.

SSA is a reformulated version of the classical gene set screening
method proposed by Segal et al. (2004). SSA shows by far the worst
performance in all the benchmark tests. This result seems reasonable
when considering that SSA tests over or underexpression of a gene
set in each single sample individually, while the other methods
take into account expression proﬁles of a gene set across multiple
samples.

On the other hand, EEM, which tests expression coherence
across all samples, performs broadly well for various types of
input data. BEEM, which tests over or underexpression in a
subgroup of samples, works well for the GNF expression dataset,
conﬁrming our previous report (Niida et al., 2010). However, in
the other expression datasets, EEM outperforms BEEM; bicluster-
type expression modules targeted by BEEM are less common
than coherent expression modules targeted by EEM in most real
expression datasets. The feature of these methods is that they are
based on the rigid model assumptions. There are pros and cons
about this feature. A notable advantage of this feature is that it can be
utilized for not only gene set screening, but also expression module
discovery. If a gene set is taken as signiﬁcant by EEM and BEEM,
a subset of genes should be co-expressed across all samples or in
a subgroup of samples. EEM and BEEM can extract the subset as
an expression module. This expression module discovery approach

 

3095

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

A.Niida et al.

 

 

Fig. 4. The association of the 15 expression-gene set pair groups with the types of input data. We measured associations of each group of expression-gene

set pairs with the seven expression datasets or the ﬁve gene sets using hypergeometric tests. Each row of the table represents each group and colored cells
indicate which methods take it as signiﬁcant. P-Values from the association tests are presented in minus log scale.

brings us much biological knowledge, especially when combined
with additional analyses of the extracted module information (Niida
et al., 2009a, b, 2010). However, note that EEM and BEEM
potentially fail to capture expression proﬁles which do not ﬁt to
their expression module models.

Similarly to EEM, GSECA assumes expression coherence of
input gene sets as an indication of its functionality. However, while
EEM tests existence of a coherent subset in the input gene set,
GSECA evaluates overall coherence by calculating the sum of
correlations for all gene pairs in the gene set (Kim et al., 2007).
In the real data test, this approach retrieves the largest number
of gene sets as signiﬁcant, possibly by capturing loosely coherent
patterns that cannot be detected by EEM. An example of such an
expression proﬁle is given in Supplementary Figure S5A. However,
note that GSECA cannot capture a gene set containing subsets whose
expressions are anti-correlated, because the coherence signals cancel
each other out. Supplementary Figure S5B shows an example taken
as signiﬁcant by MIEA, EEM and BEEM, but not GSECA. This
case was also shown in the simulated data test using the sine-wave
model (Supplementary Fig. S1E and G) .

The newly introduced method, MIEA, is designed to detect
any informative expression proﬁles of the input gene sets without
assuming any speciﬁc models. This notable feature endows the
method with the broad applicability so that it can capture complex
expression proﬁles that the other model-based methods fail to detect.
Supplementary Figure 5C and D shows such complex expression
proﬁles, which are hard to be captured by any simple models.
However, note that this broad applicability comes at cost: in case
where a model-based method would be appropriate, the model-free
method has less power, demonstrated by the simulated data test using
the coherent and bicluster model. (Fig. 1A and D) .

Collectively, we conclude that MIEA is broadly applicable to
various types of gene sets and expression datasets, while EEM
and GSECA also have comparably broad applicability. Since
EEM and GSECA have biased preferences for their targets,
they might perform better than MIEA when applied to their
favorite target. Although each method alone seems to have enough
performance, combining these different methods would enable more
comprehensive screenings for ﬁinctional gene sets. This study not
only introduced MIEA but also revealed unique characteristics of

the novel and existing unsupervised gene set screening methods
by performing extensive benchmark tests. Taken together with our
previous studies (Niida et al., 2009a, b, 2010), this study provides
a foundation for unsupervised gene set screening analysis, a novel
paradigm in transcriptome data analysis.

ACKNOWLEDGEMENTS

Computation time was provided by the Super Computer System,
Human Genome Center, Institute of Medical Science, University of
Tokyo.

Funding: This work was supported by the Grant-in-Aid for the
Global COE Program ‘Center of Education and Research for
the Advanced Genome-Based Medicine’ from the Ministry of
Education, Culture, Sports, Science and Technology (MEXT) of
Japan.

Conﬂict of Interest: none declared.

REFERENCES

Bergmann,S. et al. (2003) Iterative signature algorithm for the analysis of large-scale
gene expression data. Phys. Rev. E Stat. Nonlin. Soft Matter Phys, 67, 031902.
Carthew,R. and Sontheimer, E. (2009) Origins and mechanisms of mirnas and sirnas.

Cell, 136, 642$55.

Chin,K. et al. (2006) Genomic and transcriptional aberrations linked to breast cancer
pathophysiologies. Cancer Cell, 10, 5297541.

Fisher,R. (1932) Statistical Methods for Research Workers. Oliver and Boyd, London.

Grifﬁths-Jones,S. et al. (2008) mirbase: tools for microrna genomics. Nucleic Acids
Res., 36, DISLD158.

Huang,D.W. et al. (2009) Bioinformatics enrichment tools: paths toward the
comprehensive functional analysis of large gene lists. NucleicAcids Res., 37, 1713.

Kim,T. et al. (2007) Inferring biological functions and associated transcriptional
regulators using gene set expression coherence analysis. BMC Bioinformatics, 8,
453.

Matys,V. et al. (2006) Transfac and its module transcompel: transcriptional gene
regulation in eukaryotes. Nucleic Acids Res., 34, D1087D110.

Miller,L. et al. (2005) An expression signature for p53 status in human breast cancer
predicts mutation status, transcriptional effects, and patient survival. Proc. Natl
Acad. Sci. USA, 102, 1355313555.

Muller,F. et al. (2008) Regulatory networks deﬁne phenotypic classes of human stem
cell lines. Nature, 455, 401405.

Neve,R. et al. (2006) Acollection of breast cancer cell lines for the study of functionally
distinct cancer subtypes. Cancer Cell, 10, 5157527.

 

3096

112 /3.Io's[BumoprOJxosoueuiJOJurorq”:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

Model-free unsupervised gene set screening

 

Niida,A. et al. (2009a) Gene set-based module discovery in the breast cancer
transcriptome. BMC Bioinformatics, 10, 71.

Niida,A. et al. (2009b) A novel meta-analysis approach of cancer transcriptomes
reveals prevailing transcriptional networks in cancer cells. Genome Informatics,
22, 1217131.

Niida,A. et al. (2010) Gene set-based module discovery decodes cis-regulatory codes
governing diverse gene expression across human multiple tissues. PLoS One, 5,
e10910.

Phillips,H. et al. (2006) Molecular subclasses of high-grade glioma predict prognosis,
delineate a pattern of disease progression, and resemble stages in neurogenesis.
Cancer Cell, 9, 1577173.

Press,W. et al. (1992) Numerical Recipes in c, 2nd edn. Cambridge University Press,
Cambridge.

Segal,E. et al. (2004) Amodule map showing conditional activity of expression modules
in cancer. Nat. Genet, 36, 109w1098.

Shankavaram,U. et al. (2007) Transcript and protein expression proﬁles of the nci-60
cancer cell panel: an integromic microarray study. Mol. Cancer Ther, 6, 82W832.

Su,A. et al. (2004) A gene atlas of the mouse and human protein-encoding
transcriptomes. Proc. NatlAcad. Sci. USA, 101, 606276067.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-based
approach for interpreting genome-wide expression proﬁles. Proc. Natl Acad. Sci.
USA, 102, 15278715279.

 

3097

112 /3.Io's[BumoprOJxosoueuiJOJurorq”:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

