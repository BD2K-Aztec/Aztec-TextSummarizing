Advance Access Publication Date: 2 December 2014

Bioinformatics, 3118), 2015, 1286—1289
doi: 10.1093/bioinformatics/btu771

Applications Note

 

 

Genome analysis

Population-based structural variation discovery

with Hydra-Multi

Michael R. Lindberg1, Ira M. Hall1'2'3'4'* and Aaron R. Quinlan1'2'5'*

1Department of Biochemistry and Molecular Genetics, 2Center for Public Health Genomics, University of Virginia,
Charlottesville, VA, USA, 3Department of Medicine, 4The Genome Institute, Washington University School of Medicine,
St. Louis MO, USA and 5Department of Public Health Sciences, University of Virginia, Charlottesville, VA, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on March 27,2014; revised on November3, 2014; accepted on November 16, 2014

Abstract

Summary: Current strategies for SNP and INDEL discovery incorporate sequence alignments from
multiple individuals to maximize sensitivity and specificity. It is widely accepted that this approach
also improves structural variant (SV) detection. However, multisample SV analysis has been sty—
mied by the fundamental difficulties of SV calling, e.g. library insert size variability, SV alignment
signal integration and detecting long—range genomic rearrangements involving disjoint loci. Extant
tools suffer from poor scalability, which limits the number of genomes that can be co—analyzed and
complicates analysis workflows. We have developed an approach that enables multisample SV
analysis in hundreds to thousands of human genomes using commodity hardware. Here, we de—
scribe Hydra—Multi and measure its accuracy, speed and scalability using publicly available data—
sets provided by The 1000 Genomes Project and by The Cancer Genome Atlas (TCGA).

Availability and implementation: Hydra—Multi is written in C++ and is freely available at https://github.

com/arqSX/Hyd ra.

Contact: aaronquinlan@gmail.c0m 0r ihall@gen0me.wustl.edu
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

We present an extension of Hydra (Quinlan et (11., 2010); our struc-
tural variant (SV) discovery software that; like many extant tools;
was designed to detect SV in a single genome using discordant
paired-end alignment signals. Hydra-Multi generalizes the Hydra al-
gorithm to multiple samples/libraries and extends its scalability to
incorporate information from many genomes simultaneously.
Variant discovery from multiple samples has been a staple of SNP
and INDEL discovery (Koboldt et (11., 2009; Larson et (11., 2011; Lee
et (11., 2010; McKenna et (11., 2010); and has been shown to provide
substantial improvement in accuracy over the single-genome strat-
egy. Therefore; it is logical to make use of all available data in SV de-
tection; especially due to the ever-increasing number of datasets
from large projects such as The Cancer Genome Atlas (TCGA) and
The 1000 Genomes Project (lKGP). We previously applied
multisample SV discovery in a study of genome instability in

(C7 The Author 2014. Published by Oxford University Press.

mouse-induced pluripotent stem cell lines (Quinlan et (11., 2011).
However; the algorithm employed for that study was limited to a
handful of samples. Hydra-Multi was therefore developed to call SVs
in a large number of ‘tumor-normal’ pairs (Malhotra et (11., 2013). In
previous studies; the standard cancer genome workflow consisted of
calling SVs in a tumor and a matched normal and subsequently com-
pared the calls in each sample to find putative somatic mutations. Such
‘tumor-normal’ comparisons are fraught with somatic misclassifica-
tions (i.e. predicting that a variant is somatic when it is actually in the
germline) where evidence of SV is found in the tumor but not the nor-
mal. This problem is exacerbated when shallow coverage is obtained
for normal samples; leading to a greater number of false somatic SV
predictions in the tumor sample. In contrast; directly integrating mul-
tiple datasets can prevent somatic misclassification in cases where the
supporting alignments do not exist in the matched normal but do exist
in the genomes of other normal samples.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

1286

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Ilandsakcr (7/ LIL, 2011 lltH‘IHUZdi‘Jl‘i (7/ LIL,
2011

Supplcrncntai‘) Fig. 51
Supplcrncntai‘) l\4atcrials

Supplementary Methods

0
o
o
o

5111L11(’[L’IL., 2009

DELLY 5 MADS (GT)
DELLY 8 MADS (GT)
DELLY 5 MADS (DV)
DELLY 8 MADS (DV)

+ GASVPro 5 MADS

o
o
o

GASVPro 8 MADS
HydrarMulti 5 MADs
HydrarMulti 8 MADs

 

Supplementary Methods

Rausch (7/ LIL, 2012

/310'S[BIIJHO[pJOJXO'SOTJBHIJOJHTth/ﬂduq

Mills (’l LIL, 2011

 

Supplcrncntar) Table 51 l\4alhot1‘a (7/ LIL, 2013

Supplcrncntai‘) Fig. S2
l\4alhotm (7/ LIL (2013)

l\4alhot1‘a (7/ LIL,

2013

/310'S[BIIJHO[pJOJXO'SOTJBHIJOJHTth/ﬂduq

Population—based structural variation discovery

1289

 

note that approximately half of the apparent false positives are small
deletion variants that are likely misclassified due to varied resolution
amongst samples caused by differing insert size distributions. Here,
we emphasize that the fact that at most 5.2% of the somatic re—
arrangement predictions are incorrect is the direct result of integrat—
ing data from all 129 tumor and normal genomes. In contrast, were
we to predict somatic SVs using the common practice of solely com—
paring each tumor to its matched normal, 89.1% of the predictions
would have been false using the somatic FDR estimation approach
described above (Malhotra et 41., 2013). Alternatively, were we to
utilize a post hoc somatic SV classification strategy based on
integrating results after performing single—sample variant calling sep—
arately on all 129 genomes, 21.9% of somatic SV calls would have
been incorrect (versus 5.2% for joint calling). These results further
underscore the superiority of joint variant calling for somatic SV de—
tection. Indeed, as illustrated in Figure 2, the somatic FDR decreases
dramatically as additional tumor—normal pairs are used for discov—
ery, arguing that large cancer genomics studies will greatly minimize
spurious somatic calls by adopting this multi—sample SV detection
strategy.

The main effect of joint variant calling appears to be increased
sensitivity, thus minimizing the misclassification of germline SVs as
somatic SVs due to false negatives. However, it may also be true
that some fraction of false positive SV calls arise systematically in
multiple samples and are classified as ‘germline’ variants, thus fur—
ther reducing the somatic FDR.

3.2 Speed and scalability

The main motivation for the development of Hydra-Multi was fast
runtime and scalable performance, and in these terms it greatly out—
performs the other tools. Under the same usage scenarios as pre—
sented in Figure 1, Hydra-Multi was 2—13>< (2.2, 2.3 and 12.5><)
faster than DELLY and 12—14>< (12.8 and 13.9><) faster than
GASVPro, and required merely 3.2 h to analyze the set of 65 5><
datasets (Table 1), whereas DELLY required 39.9 h. Hydra-Multi
achieved these fast runtimes while using substantially less memory
than the other tools: e.g. in the 65 dataset comparison (Table 1),
Hydra-Multi used merely 1.9 Gb of memory while DELLY used
41.3 Gb, which represents a 22—fold difference. Importantly, Hydra-
Multi’s performance allows for a much larger number of datasets to
be co—analyzed on a single machine, which improves variant
detection sensitivity and simplifies data processing workflows for
large—scale studies. A large 5 00—dataset scenario was simulated using
repeated inputs of the 5 X NA12878 dataset, revealing tractable
runtime (~30 h) and memory usage (6.9 Gb) for Hydra-Multi on a
single commodity server with 128 Gb of RAM. In contrast, it takes
DELLY more than 2 weeks and >70 Gb of RAM to analyze 500
NA12878 datasets (Table 1).

Hydra-Multi’s low memory usage is achieved primarily through
the use of a memory assisted, k—way merge sorting algorithm and its
speed is achieved largely through parallelization of both the discord—
ant extraction and assembly phases (Supplementary Fig. 51).
Extraction and assembly are coarsely parallelized, i.e. one processor

per dataset and chromosome/orientation set, respectively. Under rec—
ommended parameters, discordant read—pair extraction predomin—
ates algorithm runtime and scales linearly with the amount of input
data when supplied a single processor (Supplementary Fig. 53A).
Supporting this assertion, there is a direct relationship between the
number of discordant read—pairs and runtime (Supplementary Fig.
533). By parallelizing the work, the cost of examining additional
data is reduced. Both the disk—based sort and parallelization make
scalability a central strength of Hydra-Multi, thus enabling
incorporation of an extremely large number of datasets for SV
discovery.

Given the increasing number of large—scale genome sequencing
projects, the rapid accumulation of WGS data, and the clear benefits
of pooled multisample variant discovery, Hydra-Multi will enable
sensitive and accurate SV analysis to be conducted on extremely
large datasets using modest computational resources.

Funding

This work was supported by an NIH/NHGRI [1R01HG006693-01 to
A.R.Q.] and an NIH New Innovator Award [DP2OD006493-01] and a
Burroughs Wellcome Fund Career Award [to I.M.H.]

Conﬂict of interest: none declared.

References

Handsaker,R.E. et a1. (2011) Discovery and genotyping of genome structural
polymorphism by sequencing on a population scale. Nat. Genet., 43,
269—276.

Hormozdiari,F. et a1. (2011) Simultaneous structural variation discovery
among multiple paired-end sequenced genomes. Genome Res., 21,
2203—2212.

Koboldt,D.C. et al. (2009) VarScan: variant detection in massively parallel
sequencing of individual and pooled samples. Bioinformatics, 25,
2283—2285.

Larson,D. et a]. (2011) SomaticSniper: identiﬁcation of somatic point muta-
tions in whole genome sequencing data. Bioinformatics, 28, 311—317.

Lee,S. et a1. (2010) MOGUL: Detecting common insertions and deletions in a
population. Proc. RECOMB 2010, 6044, 357—368.

Malhotra,A. et a1. (2013) Breakpoint proﬁling of 64 cancer genomes reveals
numerous complex rearrangements spawned by homology—independent
mechanisms. Genome Res., 23, 762—776.

McKenna,A. et a1. (2010) The Genome Analysis Toolkit: a MapReduce frame-
work for analyzing next-generation DNA sequencing data. Genome Res.,
20,1297—1303.

Mills,R.E. et a]. (2011) Mapping copy number variation by population-scale
genome sequencing. Nature, 470, 59—65.

Quinlan,A.R. et a1. (2010) Genome-wide mapping and assembly of structural
variant breakpoints in the mouse genome. Genome Res., 20, 623—635.

Quinlan,A.R. et a]. (2011) Genome sequencing of mouse induced pluripotent
stem cells reveals retroelement stability and infrequent DNA rearrangement
during reprogramming. Cell Stem Cell, 9, 366—373.

Rausch,T. et a]. (2012) DELLY: structural variant discovery by integrated
paired-end and split—read analysis. Bioinformatics, 28, i333—i339.

Sindi,S. et a1. (2009) A geometric approach for classiﬁcation and comparison
of structural variants. Bioinformatics, 25, 222—230.

ﬁm'spzumol‘pmﬂo'sopeuuowtotq/ﬁdnq

