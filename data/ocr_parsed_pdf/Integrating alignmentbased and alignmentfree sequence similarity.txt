Bioinformatics, 3119), 2015, 1396—1404

doi: 10.1093/bioinformatics/btv006

Advance Access Publication Date: 7 January 2015
Original Paper

 

Sequence analysis

Integrating alignment-based and alignment-free
sequence similarity measures for biological
sequence classification

Ivan Borozan*, Stuart Watt and Vincent Ferretti

Department of Informatics and Bio-computing, Ontario Institute for Cancer Research, MaRS Centre, South Tower,
101 College Street, Suite 800, Toronto, Ontario, Canada

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on June 5, 2014; revised on January 4, 2015; accepted on January 5, 2015

Abstract

Motivation: Alignment—based sequence similarity searches, while accurate for some type of
sequences, can produce incorrect results when used on more divergent but functionally related
sequences that have undergone the sequence rearrangements observed in many bacterial and
viral genomes. Here, we propose a classification model that exploits the complementary nature of
alignment—based and alignment—free similarity measures with the aim to improve the accuracy
with which DNA and protein sequences are characterized.

Results: Our model classifies sequences using a combined sequence similarity score calculated
by adaptively weighting the contribution of different sequence similarity measures. Weights are
determined independently for each sequence in the test set and reflect the discriminatory ability of
individual similarity measures in the training set. Because the similarity between some sequences
is determined more accurately with one type of measure rather than another, our classifier allows
different sets of weights to be associated with different sequences. Using five different similarity
measures, we show that our model significantly improves the classification accuracy over the cur—
rent composition— and alignment—based models, when predicting the taxonomic lineage for both
short viral sequence fragments and complete viral sequences. We also show that our model can be
used effectively for the classification of reads from a real metagenome dataset as well as protein
sequences.

Availability and implementation: All the datasets and the code used in this study are freely
available at https://collaborators.oicr.on.ca/vferretti/borozanicsss/csss.html.

Contact: ivan.borozan@gmail.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

Sequence comparison of genetic material between known and
unknown organisms plays a crucial role in metagenomic and phylo-
genetic analysis. Sequence similarity search is a method of sequence
analysis that is extensively used for characterizing unannotated
sequences (Altschul et (11., 1997). It consists of aligning a query
sequence to a sequence database with the aim of determining those
sequences that have statistically significant matches to that of the

(C7 The Author 2015. Published by Oxford University Press.

query. In this way, for example, a known biological function or
taxonomic category of the closest match can be assigned to the
query for its characterization.

Alignment-based methods, however, can produce incorrect
results when applied to more divergent but functionally related
sequences that have undergone sequence rearrangements. Sequence
rearrangements such as genetic recombination and shuffling or hori-
zontal gene transfer are observed in a variety of organisms including

1396

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Integrating alignment—based and alignment—free sequence similarity measures 1397

 

viruses and bacteria (Delviks—Frankenberry et al., 2011; Domazet—
Loo and Haubold, 2011; Shackelton and Holmes, 2004). These
processes, which produce alternating blocks of sequence material,
are at odds with the alignment—based sequence comparison, which
assumes conservation of contiguity between homologous segments
(Vinga and Almeida, 2003). Another weakness of the alignment—
based approach is in the use of different methods for scoring pair—
wise protein sequence alignments, as reported in Vinga and Almeida
(2003).

In addition to sequence rearrangements, viral genomes exhibit
gene gain and loss, gene duplication and high sequence mutation
rates (Duffy et al., 2008; Shackelton and Holmes, 2004). The cumu—
lative effect of these changes make viral genomes among the most
variable in nature. Because of this high sequence divergence and the
often small number of genes, viral genomes present a greater chal—
lenge to phylogenetic classification and taxonomic analysis when
these are based on sequence comparison by alignment only.
Improving the results of such studies is important for better under—
standing viruses and their involvement in human diseases, including
cancer (zur Hausen, 2007).

Because of these shortcomings, active research has been con—
ducted into alignment—free measures to overcome the above limita—
tions. A number of alignment—free measures have been proposed in
recent years as reported in two comprehensive reviews (Vinga,
2014; Vinga and Almeida, 2003).

In this study, we propose a new classification model that
combines similarity scores obtained from alignment—free and align—
ment—based similarity measures with the aim to exploit the comple—
mentary nature of these measures to improve the classification
accuracy. In our model, the classification of sequences is performed
by using a combined sequence similarity score (CSSS) that is calcu—
lated based on the weighted contribution of similarity scores, where
weights reflect the discriminatory ability of individual measures in
the training set. One unique feature of our model is based on the ob—
servation that the similarity between some sequences is determined
more accurately with one type of similarity measure rather than an—
other, hence in our model, different sets of weights can be associated
with different sequences (i.e. sequences to be classified).
Furthermore, we provide a mathematical framework that can in—
clude any number of additional similarity measures and show that
our model (i) is applicable to both nucleotide and amino acid se—
quences (ii) improves the classification accuracy over a purely align—
ment—based sequence comparison approach and (iii) improves the
classification accuracy for metagenomic analysis of short reads
produced by next—generation sequencing technologies.

Recently, a number of methods for metagenomic analysis have
been proposed (Brady and Salzberg, 2009; Huson and Xie, 2014;
Huson et al., 2007; Nalbantoglu et al., 2011; Patil et al., 2011;
Rosen et al., 2011; Wood and Salzberg, 2014). Of these seven meth—
ods, PhymmBL (Brady and Salzberg, 2009) is the method closest in
approach to the method presented in this study, since it classifies
reads (or contigs) using an integrated score obtained by combining
the interpolated Markov models (IMM) score (an alignment—free/
composition—based similarity measure) with the BLAST (Altschul
et al., 1997) score. PhymmBL (Brady and Salzberg, 2009) has been
shown to outperform MEGAN (Huson et al., 2007) for longer con—
tigs, while for shorter ones, the results of comparison are misleading
at best since MEGAN produces results in a form that cannot be dir—
ectly compared to those of PhymmBL (Brady and Salzberg, 2009,
2011) and the model proposed in this study. We believe that improv—
ing the classification accuracy for shorter reads (100—1000 bp) is
critical, since such metagenomic analysis does not require the

assembly of raw sequenced reads prior to classification. For these
reasons and to address the objective (iii) in the previous paragraph,
we chose to compare the classification results obtained with the
model presented in this study to four primarily composition—based
models [PhymmBL (Brady and Salzberg, 2009), NBC (Rosen et al.,
2011), PhyloPythiaS (Patil et al., 2011) and RAIphy (Nalbantoglu et
al., 2011)] and the two most recently published methods for the clas—
sification of metagenomic sequences, Kraken (Wood and Salzberg,
2014) based on the exact alignment of k—mers and PAUDA (Huson
and Xie, 2014) an alignment—based method.

2 Materials and Methods

2.1 Sequence similarity measures

In this section, we describe the five sequence similarity measures
that we chose to use in our classification model. Three of them are
alignment—free sequence similarity measures and two of them are
alignment—based sequence similarity measures.

2.1.1 Alignment-free sequence similarity measures

The choice of the three alignment—free sequence similarity measures
(see below) is based on the notion of complementarity between
these measures and the two alignment—based similarity measures
that we chose to use in this study. Specifically, similarity measures
based on k—mer frequencies [the Euclidean Distance (ED) and
Jensen—Shannon divergence (JSD)] do not depend on any assump—
tion of the contiguity of conserved segments, as the alignment—based
measures do. They do, however, depend on the choice of the k—mer
size (Wu et al., 2005). In contrast, the compression—based (CB)
measure (Li et al., 2001) built upon the concept of Kolmogorov
complexity is both independent of the k—mer size (since it is not
based on k—mer counts) and the assumption of the contiguity of con—
served segments.

The ED and JSD measures both require the number of all
possible k—mers K : n,2 to be counted for any given sequence, where
n is the alphabet size (i.e. n : 4 for DNA sequences and n : 20 for
protein sequences) and k is the length of the k—mer sequence. To
count the number of k—mers in DNA sequences, we use the
JELLYFISH (Marais and Kingsford, 2011) algorithm and for
protein sequences, we use a Python script from Gupta et al. (2008).
The raw counts are used to form a vector Ck of all possible k—mers
of length k,

k k k k
C :<cl,cz,...,cK> (1)

raw counts in Equation (1) are then normalized to form a probabil—
ity distribution vector

K
szck/Zcf=<ff.f§.....f{§> (2)
i:1
giving the relative abundance of each k—mer.

1. The ED. The similarity score between two sequences X and Y is
the ED between their nk dimensional probability distribution vectors
F1); and F1; as defined in Equation (3)

 

dED : mart) — 2N<F§.F'o +N<F'§.F'§> <3)
N<X.Y> : L (4)
(X-X)(Y-Y)

where Equation (4) ensures that each vector is normalized and has
length 1 in the nk dimensional space. The choice for this metric is

/310‘s112umo[p10}xo‘sopcuHOJIItotq/ﬁdnq

1398

/.Borozan et al.

 

based on its simplicity, well defined mathematical properties and its
demonstrated effectiveness as an alternative to the alignment
method (Vinga and Almeida, 2003). The ED defined in Equation (3)
has values that range between 0 and 1, with lower values indicating
increasing similarity and higher values decreasing similarity.

2. The ]SD. This is an information theoretic non—symmetric diver—
gence measure of two probability distributions. The JSD between
two sequences X and Y is calculated between their nk dimensional
probability distribution vectors Fl§ and F1; as shown below

dJSD : JSD(F‘,‘(,F‘§) : 0.5 . KL(F1;(,M) + 0.5 - KL(F‘§,M) (5)

where M,: (f; + ﬁ)/2, i: 1, . . . ,K and KL is the Kullback—Leibler
divergence defined below

K
KL(F‘§.M) : Z 7’; -log( ,5 /M,-) (6)
i:1

Provided that the base 2 logarithm is used in Equation (6), JSD has
values that range between 0 and 1, with lower values indicating
increasing similarity and higher values decreasing similarity. The
choice for this similarity measure is based on its ability to success—
fully reconstruct phylogenies using whole—genome sequences as re—
ported in Sims et al. (2009).

3. The CB measure. This similarity measure is based on the concept
of Kolmogorov complexity. Conditional Kolmogorov complexity K
(X )Y) (or algorithmic entropy) of sequence X given sequence Y is
defined as the length of the shortest program computing X on input
Y. In this way, K(X)Y) measures the randomness of X given Y. The
Kolmogorov complexity K(X) of a sequence X is defined as K(X)e)
where e is an empty string. We note that Kolmogorov complexity
K(X) of a sequence X is non—computable and that in practice K(X) is
approximated by the length of the compressed sequence X, obtained
using compression algorithms such as Lempel—Ziv—Markov chain
algorithm (LZMA) or GenCompress (Chen et al., 1999). Our choice
for this measure is based on the following two properties (i) CB is
not affected by sequence rearrangements and (ii) since CB is not a
frequency—based measure, it is not affected by the choice of the k—
mer size. To calculate the CB distance between two sequences X and
Y, we chose to use the normalized compression distance (NCD)
(Cilibrasi and Vitanyi, 2005) as defined below:

deg : NCD(X, Y) (7)

where
C(XY) — min{C(X), C(Y)}

NCD(X) Y) = max{C(X). C(Y)}

(8)
where  denotes the length of a compressed sequence using a par—
ticular compression algorithm and where X Y denotes the concaten—
ation of sequence X with sequence Y. Note that the NCD in
Equation (8) is an empirical approximation of the normalized infor—
mation distance, which is defined as a metric in Cilibrasi and
Vitanyi (2005 ). The distance calculated using Equation (7) takes val—
ues between 0 and 1, with lower values indicating increasing se—
quence similarity and higher values decreasing sequence similarity.
The compression algorithm used in this study is plzip (http://www.
nongnu.org/lzip/plzip.html) a multi—threaded, lossless data compres—
sor based on the lzlib compression library that implements a simpli—
fied version of the LZMA algorithm. All sequences in this study
were compressed using plzip with the compression level parameter
set to 4, with matched length and dictionary size set to their default
values.

2.1.2 Alignment-based sequence similarity measures

4. The BLAST-based measure. For the classification of DNA se—
quences, the distance between the query sequence X and subject Y is
expressed in terms of the BLAST bit scores calculated using the
BLAST algorithm (Altschul et al., 1997) (blastall version 2.2.18,
blastall —p blastn), with default parameter value settings.

5. The Smith—Waterman (SW)-hasea' measure. For the classification
of protein sequences, similarity scores expressed in terms of P values
calculated using the SW algorithm were taken from Liao and Noble
(2003).

2.2 Classification model

As mentioned in Section 1, we propose to exploit the complemen—
tary properties of the five individual similarity measures described
above to improve the accuracy with which nucleotide or amino acid
sequences are characterized. Our aim is to propose a CSSS that will
improve upon the limitations of the individual sequence similarity
scores (as described in Section 1) and lead to an improved classifica—
tion performance.

The CSSS model rests on three assumptions (i) that similarity
measures are complementary in nature (as described in the previous
section), (ii) that some sequences are better characterized with one
type of similarity measure than another and (iii) that their individual
values are in the range between 0 and 1.

Among many machine learning algorithms that are available
today, the nearest neighbour (NN) algorithm is one of the simplest
and most intuitive classification algorithms. For this reason, the NN
algorithm is often used as the reference classifier in comparative
studies. The k—NN algorithm performs the classification by identify—
ing the k-NNs that are the closest in terms of a distance/similarity
measure to a query (or test sample). It then assigns to the query the
class that occurs the most often among the k-NNs. In the case where
k : 1, the query is assigned the class of the closest single NN.
Because of these properties, we find the 1—NN algorithm to be a nat—
ural choice for the classifier in our approach, as described below.

Let SiX : < $21, 522, . . . ,sﬂm > be an n dimensional vector of se—
quence similarities/distance scores 52,- between the sequence X in the
test set and the ith sequence in the training set, calculated using jth
sequence similarity measure.

For each sequence X in the test set, we can now define the n
dimensional S; vector of combined sequence similarity/distance
scores, to be the linear combination of SiX vectors across
j : {1, . . . ,1} similarity measures as shown below

1 ,
Z W/ ' S'x
/:1

s; z

“’1'

MN

1

l

where w, is the weight of the jth sequence similarity measure calcu—
lated as the ratio ofzthe between group variability (SB) tor the within
group variability (S W) (i.e. the F—test statistics) for each S'X vector as
shown in Equation (10).

2 1
w, : 3(8)?) (10)

A2
Sw(5'x)

Note that the combination of scores obtained using different

M>

 

similarity measures shown in Equation (9) is performed independ—
ently for each sequence X in the test set.

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

(14)

Figure 1

Figure 1

Figure 1

Equation (10)

Equation (10)

 

Equations (13)

Equation (10)

Equation (9)

LI)

Equations (3) (
Equation (15)

Figure 1

Equation

Akhter (71 Li]. (2013)
Equations (3)
(5) Equation (2)

/3.10'spzumofp10}xo"sotwuuoqutotqﬂ:dnq

1400

/.Borozan et al.

 

the k—mer size should be chosen in such a way to satisfy the inequal—
ity shown in Equation (15).

2.3 Datasets

We evaluate the ability of our model to classify different types of
biological sequences using three datasets, one containing viral nu—
cleotide sequences, a second consisting of longueur nucleotide reads
(with an average of 759 bp in length) from a real metagenome and a
third consisting of protein sequences.

2.3.1 Dataset I

Because of their considerable variability, viral genomes are expected
to pose a greater challenge to phylogenetic classification than gen—
omes from other organisms. In this regard, we evaluate the classifi—
cation performance of the CSSS model using a dataset composed of
1066 complete viral genomes downloaded from the NCBI RefSeq
database. The classification of viral genomes into genera was per—
formed in three steps:

° Step 1: the 1066 viral sequences across 147 different genera were
divided into training and test sets in such a way that for each
genus the test set consisted of viral genomes that were not repre—
sented in the training set. The relative sizes of the training and
test sets were respectively set to 3/4 and 1/4.

° Step 2: selection of similarity measures prior to the classiﬁcation
of test examples selected in step 1 was performed as described in
Section 2 (see Section 2.2.1) using the training set from step 1

° Step 3: Prediction of viral genera in the test set selected in step 1
is performed using the training set selected in step 1 and CSSSs
calculated using the formula shown in Equation (9) with similar—
ity measures selected in step 2. Note that the training set in this
step consists only of complete viral genomes.

The complete evaluation of the classification performance was
carried out using test samples generated in step 1 composed of com—
plete viral genomes and viral sequence fragments of 1000 bp, 500 bp
and 100 bp in length, viral fragments were sampled at random from
each complete viral genome in the test set obtained in step 1. Note
that for viral fragments the set B in step 2 (see also Section 2.2.1)
contains sequences that are of the same fragment length as those in
the test set of step 1. To evaluate the variability of results, training
and test sets were sampled randomly from the entire dataset (see
step 1), 10 times.

2.3.2 Dataset II

Next—generation sequencing promises to expand the scope of metage—
nomic projects by significantly increasing the number of organisms
that can be sequenced from any given sample. One challenge for
metagenomic analysis is the accuracy with which short reads are clas—
sified into groups representing the same or similar taxa. Improving
the classification accuracy in such studies should lead to more reliable
estimates of biological diversity in sequenced sample. For this reason,
we evaluate the ability of our model to classify reads using a real
Acid Mine Drainage metagenome (Tyson et al., 2004). This dataset
is known to contain three dominant populations; the archaeon
Ferroplasma acia'armanus and two groups of bacteria,
Leptospirillum sp. groups 11 and 111. Reads that aligned with high
confidence to draft genomes of these three micro—organisms were first
identified using the MUMmer algorithm (Delcher et al., 2003) (with
the minimum length of a match set to 70% of the full read length). A
total of 20 907 of these reads were found (with an average of 759 bp
in length), of these 18 579 aligned to Leptospirillum sp. groups 11

and III genomes and 2328 to the Ferroplasma acia'armanus genome.
The classification performance was evaluated at the phylum level
using a training set composed of complete bacterial and archaeal gen—
omes across 15 different phyla and 86 sequences downloaded from
the NCBI RefSeq database. The 15 phyla include both the
Euryarchaeota and Nitrospirae phyla to which Ferroplasma acia'ar-
manus and Leptospirillum sp. groups 11 and III belong to. The three
draft reference genomes were not used as part of the training set.
Selection of similarity measures prior to classification of the test ex—
amples was conducted as described in Section 2 (see Section 2.2.1).
Set A in this case consisted of complete bacterial and archaeal gen—
omes as described above, while set B consisted of sequences of 1000
bp in length that were sampled at random from complete bacterial
and archaeal genomes in the training set in such a way that for each
phylum, set B consisted of genomes that were not present in set A.

2.3.3 Dataset III

One of the objectives of protein sequence analysis is the inference of
structure or function of unannotated protein sequences encoded in
the genome. We test the ability of the CSSS model to correctly clas—
sify previously unseen protein families drawn from the Structural
Classification of Proteins database (Murzin et al., 1995). The protein
dataset consists of 4352 distinct protein sequences (ranging from 20
to 994 amino acids in length) grouped into 54 families and 23 super—
families (Liao and Noble, 2003). The protein sequences of the 54
families were divided into test and training sets in such a way that
proteins within the family are considered positive test examples while
proteins outside the family but within the same superfamily are con—
sidered as a positive training examples (Liao and Noble, 2003). We
note that the original dataset includes negative examples, which we
did not use in our evaluation. Selection of similarity measures prior
to classification of the test examples was conducted as described in
Section 2. In this case, the training set consisted of 1779 proteins be—
longing to the positive training examples, which were then split into
set A and set B as described in Section 2 (see Section 2.2.1 ).

3 Results

The evaluation of the classification performance on Datasets I and II
was carried out using the accuracy classification score defined in
Equation (16) shown below,

Vim—1

Accuracy(yi,y,) : 1/nts- Z 161,- : 31,-) (16)
i:0

where y, is the predicted value of the ith sample, 3!, is the correspond—
ing true value, nts is the total number of test samples and 1 (x) is the in—
dicator function having a value of 1 when 37,- : y,- and 0 when 37,- ;A 31,-.
As explained in Section 1, we decided to compare the results ob—
tained in this study on Datasets I and II to six other composition—
and alignment—based models that were developed for the classifica—
tion of metagenomic data with reads (or fragments) as short as
100 bp in length. Of these six models, PhymmBL (Brady and
Salzberg, 2009) is the method closest in approach to ours since it
combines scores from IMMs with those of BLAST resulting in a com—
bined score that achieves higher accuracy than BLAST scores alone.

3.1 Dataset I—Taxonomic classification of viral
sequences

We evaluate the classification performance of the CSSS model [see
Equation (9)] by predicting genera of viral DNA sequences in

ﬁm'sreumol‘pquo'sopeuuowtotq/ﬁdnq

Integrating alignment—based and alignment—free sequence similarity measures 1401

 

Dataset I (see Section 2). The training and test sets are generated as
described in Section 2—Dataset I. The classification of test examples
is then performed using the NN algorithm (1—NN) with the CSSSS
calculated as given in Equation (9). For this dataset, the combined
score in Equation (9) is calculated based on scores obtained with the
three alignment—free measures [see Section 2, Equations (3, 5 and
7)] and the normalized BLAST score [see Equation (13)]. The value
for the k—mer size is varied between 2 and 5, and the classification
performance of the individual similarity measures is determined for
each training and test sets as described in Dataset I, step 2 (see
Section 2). The optimum value for the k—mer size is then selected
based on the following two conditions (i) best classification per—
formance and (ii) k—mer size has to satisfy the inequality given in
Equation (15 ). Note that the optimum k—mer sizes were estimated
separately for complete viral genomes and for each of the three dif—
ferent viral fragment lengths (see Section 2.3.1).

In Table 1, we compare the classification performance of the
CSSS model to five other models, PAUDA (Huson and Xie, 2014),
NBC (Rosen et al., 2011), Kraken (Wood and Salzberg, 2014),
PhymmBL (Brady and Salzberg, 2009) and RAIphy (Nalbantoglu
et al., 2011). We note that for this dataset, we could not compare
the results obtained with the CSSS model to those of PhyloPythiaS
(Patil et al., 2011) for two reasons (i) PhyloPythiaS requires at—least
100 kb of sequence for each genus and (ii) our training set, com—
posed of 147 different genera, exceeds the file limit size of 10 MB
imposed by the PhyloPythiaS web server. We also note that
PhymmBL has been shown to perform better (see Brady and
Salzberg, 2011) for shorter read lengths (100—800 bp) than both
PhyloPythiaS and RAIphy. The results presented in Table 1 were ob—
tained using identical training and test sets.

Table 1 presents that the CSSS model and PhymmBL signifi—
cantly outperform other classification methods for short viral frag—
ments (5 00—1 000 bp) and complete viral genomes. Furthermore,
significant improvement in classification accuracy is obtained when
using the CSSS model over that of PhymmBL for 100—5 00 bp viral
fragments and complete viral genomes. We found no significant dif—
ference between the CSSS model and PhymmBL for 1000 bp frag—
ments (P value: 0.23, using the two sample t—test). Also no
significant difference was found between the CSSS model and NBC
(Rosen et al., 2011) for very short 100—bp viral fragments (P
value: 0.13, using the two sample t—test). We refer the reader to
Section 4 for the explanation of these two results. Because CSSS and
PhymmBL are both hybrid models that combine the alignment—

Table 1. The classification accuracy [see Equation (16)] for Datasetl
obtained with the C888 (1-NN classifier) and the five other models:
PhymmBL (Brady and Salzberg, 2009), NBC (Rosen et al., 2011),
Kraken (Wood and Salzberg, 2014), RAIphy (Nalbantoglu et al.,
2011) and PAUDA (Huson and Xie, 2014) when predicting 147 dif-
ferent viral genera across 266 viral DNA sequences as a function of
the viral fragment length

based and the alignment—free/composition—based approaches, in
Supplementary Table S4 in Supplementary Data we compare the
performance of the CSSS model to that of PhymmBL when BLAST
scores are used for classification alone. Both models achieve higher
accuracy than BLAST scores alone (except for the CSSS model with
short 100 bp fragments). From Supplementary Table S4 in
Supplementary Data, we also note that higher accuracy is achieved
when classification is performed using BLAST scores alone with
CSSS rather than PhymmBL, we explain the reason for this discrep—
ancy in Section 4.

3.2 Dataset ll—Classification of reads from a real
metagenome dataset

For this dataset, the k—mer size was set to 4 to satisfy the inequality
in Equation (15) with L: 1000 bp. The classification performance
of the CSSS model was evaluated using the training and test sets as
described in Dataset 11 (see Section 2). The combined score in
Equation (9) was calculated based on scores calculated with the
three alignment—free measures (see Section 2, Equations (3, 5 and
7)] and the normalized BLAST score [see Equation (9)]. In Table 2,
we compare the classification performance of the CSSS method to
that of six other models on Dataset 11 (see Section 2). Dataset II is
composed of 20 907 reads (with an average of 759 bp in read length)
that are known to align to three genomes as described in Section 2—
Dataset 11. Both CSSS and PhymmBL achieve higher level of accur—
acy than any other model, followed by PhyloPythiaS. PhymmBL
achieves a slightly higher accuracy than CSSS for reads that align to
Leptospirillum sp. groups 11 and III genomes (Nitrospirae phylum),
while the CSSS model performs better at classifying reads that align
to the Ferroplasma acia'armanus genome (Euryarchaeota phylum).
Again we show in Supplementary Table S5 in Supplementary Data
that the performance based solely on BLAST scores for the two best
models (CSSS and PhymmBL) is superior for the CSSS model than
PhymmBL.

3.3 Dataset III—Classification of protein sequences

Next, we evaluated the ability of the CSSS model to classify protein
sequences in Dataset 111 (see Section 2). Dataset III was originally
created to evaluate methods for detecting distant sequence similar—
ities among protein sequences as described in (Liao and Noble,
2003). The results obtained with the CSSS model are compared with
those presented in Kocsor et al. (2006), where the performance of

Table 2. The classification accuracy [see Equation (16)] for Dataset
11 obtained with the C888 (1-NN classifier) and the six other mod-
els: PhymmBL (Brady and Salzberg, 2009), PhyloPythiaS (Patil
et al., 2011), NBC (Rosen et al., 2011), Kraken (Wood and Salzberg,
2014), RAIphy (Nalbantoglu et al., 2011) and PAUDA (Huson and
Xie, 2014) when predicting the phyla for 20 907 reads belonging to
Leptospirillum sp. groups 11 and Ill genomes (18 579 reads) and
Ferroplasma acidarmanus genome (2328 reads)

 

 

Classifier Full-length Viral fragment 5 00-bp 100-bp
genomes length 1000-bp accuracy accuracy
accuracy (%) accuracy (%) (%) (%)

CSSS 91.43 i 0.99 70.02 i 2.01 63.02 i 1.49 35.94 i 3.31

PhymmBL 86.56 i 2.19 68.90 i 1.78 57.28 i 2.09 29.79 i 1.66

NBC 74.67 i 0.64 59.06 i 1.49 50.39 i 2.77 34.04 i 1.53

Kraken 48.47 i 1.85 26.66 i 1.94 23.07 i 2.19 16.26 i 1.40
RAIphy 42.03 i 1.56 30.72 i 1.66 23.97 i 1.66 14.06 i 1.17
PAUDA 0.10 i 0.15 6.73 i 1.40 21.22 i 1.32 31.89 i 2.42

 

Classifier Euryarchaeota
accuracy (%)

Nitrospirae
accuracy (% )

 

CSSS 87.03 96.66
PhymmBL 81.14 97.67
PhyloPythiaS 72.76 95.42
NBC 16.15 82.07
Kraken 0.26 77.14
RAIphy 1.03 66.99
PAUDA 4.38 8.41

 

 

/310‘s112umo[p10}xo‘soutzuHOJIItotq/ﬁdnq

1402

l.Borozan et al.

 

the combined similarity measure Lempel—Ziv—Welch (LZW)—BLAST
(obtained by combining CB LZW and BLAST scores) was compared
with that of the SW algorithm and two hidden Markov model—based
algorithms using two types of classifiers the NNs (1—NN) algorithm
and the support vector machine (SVM). Instead of calculating
BLAST scores, the evaluation of the CSSS model on this protein
dataset was performed using SW P values, taken from Liao and
Noble (2003). The k—mer size for this dataset was set to 1 since the
much larger alphabet size for protein sequences (11 : 20) requires se—
quences of length L 2 400 for the k—mer size of 2 [see Equation (15 )]
a value that is much larger then the length of many of the protein se—
quences in Dataset III. The combined score in Equation (9) is calcu—
lated based on scores obtained using the three alignment—free
measures [see Section 2, Equations (3, 5 and 7)] and normalized SW
P values [see Equation (14)]. For the purpose of comparison with re—
sults presented in Kocsor et al. (2006) the classification results of the
CSSS model are expressed as the integral of the AUC curve shown in
Supplementary Figure S2 in Supplementary Data (note that since
Dataset 111 contains 54 families the maximum value for this integral
is 54).

In Table 3, we present that the CSSS method achieves a slightly
better performance than the SW P value similarity/distance measure
(using either the SVN or the 1—NN classifier) as reported in Kocsor
et al. (2006) and performs much better than the combined LZW—
BLAST similarity measure with the 1—NN classifier also reported in
Kocsor et al. (2006).

4 Discussion

Sequence comparison is at the core of many bioinformatics applica—
tions such as metagenomic classification, protein sequence and func—
tion characterization and phylogenetic studies to name a few. In many
of these applications, the alignment—based sequence comparison is
widely used, but this does not come without some limitations. One
important limitation is that the alignment—based similarity measure
might give erroneous information when used with sequences that
have undergone some type of sequence rearrangement. Alignment—free
similarity measures offer an alternative to the alignment—based ones in
that they are unaffected by such genetic processes.

In this study, we propose a model that combines similarity scores
obtained with alignment—based and alignment—free sequence similar—
ity measures [see Equation (9)] to gain additional discriminatory in—
formation about sequences and to improve their characterization.

In Tables 1 and 2, we present that our approach performs better
than most of the other methods used in this study when predicting
genera of unknown viral sequences (i.e. sequences that are not part

Table 3. The classification performance on protein domain se-
quences for the CSSS model (1-NN classifier) with the k-mer
size=1 (see Section 3), expressed as the integral of the AUC curve
shown in Supplementary Figure 82 in Supplementary Data

 

Similarity/distance measure Classification method

 

SVM 1-NN
SW P value3 48.66 50.22
LZW-BLAST“ 49.0 37.18
CSSS NA 50.64

 

Since Dataset III contains 54 protein families, the maximum value for the
integral of the AUC curve is 54, which correspond to all 54 protein families
being classiﬁed Without error.

“Similarity/distance measures presented in Kocsor et al. (2006).

of the training set as described in Dataset I) or when predicting
phyla of metagenomic sequences. The main conceptual difference
between the CSSS model and the other classification methods used
in this study, at the exception of PhymmBL, is that the CSSS model
combines similarity scores obtained with both the alignment—based
and the alignment—free sequence similarity measures, while the other
models rely on either one of these two approaches. Thus, NBC
(Rosen et al., 2011), RAIphy (Nalbantoglu et al., 2011) and
PhyloPythiaS (Patil et al., 2011) rely on the alignment—free compos—
ition—based approaches (using k—mer frequencies or k—mer counts)
and PAUDA (Huson and Xie, 2014) relies on the alignment—based
approach and Kraken (Wood and Salzberg, 2014) on the exact
alignment of k—mers. Although in some respects, our approach is
similar to that of PhymmBL, since both methods combine scores cal—
culated using different types of similarity measures [PhymmBL uses
BLAST scores and IMMs scores (Salzberg et al., 1998)], there are
two main differences that can explain the results obtained with
Dataset I shown in Table 1.

First, the CSSS model uses four different similarity measures, so
that if sufficiently independent one from another, their combined
additive effect could confer a greater discriminatory power than the
two similarity scores combined by PhymmBL. In Supplementary
Table S6 in Supplementary Data, we show the classification accu—
racy of individual similarity measures used by CSSS and PhymmBL
models as a function of the viral fragment length.

Although the classification performance of the ED [see Equation
(3)] and JSD [see Equation (5)] measures are very similar, the classi—
fication performance of the CB [see Equation (7)] measure drops
rapidly below 10% as the length of viral fragments decreases. If,
however, we perform the classification on full length viral genomes
(see Section 2.3.1) we find that the CB measure improves the per—
formance by as much as 5.79% when combined with the other three
measures (ED, JSD and BLAST). This shows that the CB measure
contains significant additional information, only for sequences that
are similar in length to those in the training set, that is complemen—
tary to the information contained by the other three measures. This
drop in performance of the CB measure as a function of the frag—
ment length, relative to the length of the genomes in the training set,
explains also the smaller difference in performances observed be—
tween the CSSS and PhymmBL models when classifying longueur
reads in Dataset 11 (see Section 2) shown in Table 2.

Since the ED and JSD measures show similar classification per—
formances, we investigated the degree of independence of these two
measures by performing a principal components analysis (PCA) of
the similarity scores obtained using viral genomes from Dataset I.
We found that the first component (i.e. PCA1) is strongly associated
with the ED measure in test samples, while the second component
(i.e. PCA2) is strongly associated with the JSD measure, a result that
is independent of the viral fragment length as shown in
Supplementary Figure S3 in Supplementary Data. These results indi—
cate that these two measures can be considered as orthogonal and
thus not correlated, with the ED measure accounting for most of the
variation across viral genomes in test samples. To further determine
the effect of these two measures on the classification performance,
we removed each measure from the model one at the time and then
recalculated the accuracy scores. We found that for full viral gen—
omes, the effect of removing the ED measure reduced the classifica—
tion performance significantly by 5%, while removing the JSD
measure reduced it only slightly (0.25%). However, in the case of
shorter viral fragments, dropping either one of these two measures
from the model did not produce any significant change to the per—
formance, while removing both produced a significant drop in

/310‘s112umo[p10}xo‘soutzuHOJIItotq/ﬁdnq

Integrating alignment—based and alignment—free sequence similarity measures 1403

 

performance (up to 3% for 1000 bp reads). In the light of these re—
sults, we conclude that both of these measures contain complemen—
tary information that is useful for characterizing viral sequences.

The second important difference between our model and
PhymmBL is in the weighting scheme used. In the PhymmBL model,
the weights assigned to each similarity measure (i.e. combined
score:IMM + 1.2(4 — log(E)), where IMM is the score of the best
matching IMM and E the smallest E—value returned by BLAST) have
the same value for all test examples, in the CSSS model weights are
determined independently for each test example based on the dis—
criminatory ability of each measure using the training set [see
Equation (9)]. Having different sets of weights for different test,
samples (i.e. test sequences) should improve the classification per—
formance since some sequences will be better characterized with one
type of similarity measure than another. Another important differ—
ence between these two methods is in the classification performance
using BLAST results alone. As shown in Supplementary Tables
S4—S6 in Supplementary Data, we found that a significant improve—
ment in classification is obtained when the BLASTN algorithm is
used instead of mega—BLAST, the algorithm used by PhymmBL.
BLASTN is more sensitive than mega—BLAST because it uses a
shorter word size (default value of 11) that makes it better at
finding—related nucleotide sequences between more divergent bio—
logically sequences since the initial exact match can be shorter.

We found that for very short viral fragments (100 bp in length),
the CSSS model performs better than PhymmBL and achieves
slightly better accuracy (but not significant P value : 0.13, using the
two sample t—test) than the NBC model, as shown in Table 1. By
examining the individual performance of the sequence similarity
measures used by the CSSS model, we found that the composition—
based and CB similarity measures are more affected by the shorter
fragment size than the alignment based one, as shown in
Supplementary Table S6 in Supplementary Data. Despite this drop
in performance (of the composition—based and the CB similarity
measures) for short 100 bp viral fragments, by virtue of combining
different similarity measures the CSSS model still achieves better
performance than the alignment—based method PAUDA
(P value: 0.008, using the two sample t—test) or the hybrid
PhymmBL (Phymm + BLAST) (P value : 0.0001, using the two sam—
ple t—test) and performs equally well as the best composition—based
model used in this study, namely NBC.

In Section 3, we have shown that our approach can also be used
effectively for protein sequence classification. In Table 3, we show
that our model outperforms a similar but simpler LZW—BLAST 1—
NN model (Kocsor et al., 2006). The main differences between these
two approaches are the number of similarity measures used
[frequency—based measures such as those given in Equations (3) and
(5) were not used in Kocsor et al., 2006], a different method with
which similarity measures are combined and SW scores (P values)
instead of BLAST scores. Without using a weighting scheme, the
LZW—BLAST method uses a simple multiplication rule to combine
the LZW and BLAST scores (Kocsor et al., 2006). We found that
the multiplication rule used in Kocsor et al. (2006) performs signifi—
cantly better in combination with an SVM rather than a NN classi—
fier. The model proposed in this study performs better than the
SVM (LZW—BLAST) model reported in Kocsor et al., (2006) and
slightly better than the 1—NN (SW P value) as shown in Table 3. We
attribute this smaller gain in classification performance to the short
protein sequences in Dataset III, which pose a greater challenge to
the three alignment—free similarity measures examined in this study.

As shown in Equation (9), our model combines similarity scores
using a linear combination of vectors (equivalent to calculating a

weighed arithmetic mean of scores obtained with each individual
similarity measure). We did explore combining similarity scores
using a different multiplicative model which we found to signifi—
cantly under—perform (in combination with the NN classifier) when
used on datasets presented in this study.

Finally, our approach can be easily extended to any number of
additional similarity measures (such as the IMMs used by
PhymmBL) that might produce additional gain in discriminatory in—
formation about sequences and thus improve the overall classifica—
tion performance. Therefore, future work will include assessing the
performance of additional similarity measures that could be inte—
grated into our model.

Funding

This work was conducted with the support of the Ontario Institute for
Cancer Research through funding provided by the government of Ontario to
the authors.

Conﬂict of Interest: none declared.

References

Akhter,S. et al. (2013) Applying Shannon’s information theory to bacterial
and phage genomes and metagenomes. Sci. Rep, 3, 1033.

Altschul,S.F. et al. (1997) Gapped BLAST and PSI-BLAST: a new generation
of protein database search programs. Nucleic Acids Res., 25, 3389—3402.
Brady,A. and Salzberg,S.L. (2009) Phymm and PhymmBL: metagenomic
phylogenetic classiﬁcation with interpolated Markov models. Nat.

Methods, 6, 673—676.

Brady,A. and Salzberg,S. (2011) PhymmBL expanded: conﬁdence scores, cus-
tom databases, parallelization and more. Nat. Methods, 8, 367.

Chen,X. et al. (1999) A compression algorithm for DNA sequences and its ap-
plications in genome comparison. Genome Inform. Ser. Workshop Genome
Inform., 10, 51—61.

Cilibrasi,R. and Vitanyi,P.M. (2005) Clustering by compression. IEEE Trans.
Inﬁ Theory, 51, 1523—1545.

Delcher,A.L. et al. (2003) Using MUMmer to identify similar regions in large
sequence sets. Curr. Protoc. Bioinformatics, Chapter 10, Unit 10.3.

Delviks—Frankenberry,K. et al. (2011) Mechanisms and factors that inﬂuence
high frequency retroviral recombination. Viruses, 3, 1650—1680.

Domazet-L00,M. and Haubold,B. (2011) Alignment-free detection of hori-
zontal gene transfer between closely related bacterial genomes. Mob. Genet.
Elements, 1, 230—235.

Duffy,S. et al. (2008) Rates of evolutionary change in viruses: patterns and de-
terminants. Nat. Rev. Genet., 9, 267—276.

Gupta,S. et al. (2008) Predicting human nucleosome occupancy from primary
sequence. PLoS Compnt. Biol., 4, e1000134.

Huson,D.H. and Xie,C. (2014) A poor man’s blastX—high-throughput metage-
nomic protein database search using pauda. Bioinformatics, 30, 38—39.

Huson,D.H. et al. (2007) MEGAN analysis of metagenomic data. Genome
Res., 17, 377—386.

Kocsor,A. et al. (2006) Application of compression-based distance measures
to protein sequence classiﬁcation: a methodological study. Bioinformatics,
22, 407—412.

Li,M. et al. (2001) An information-based sequence distance and its application
to whole mitochondrial genome phylogeny. Bioinformatics, 17, 149—154.
Liao,L. and Noble,W.S. (2003) Combining pairwise sequence similarity and
support vector machines for detecting remote protein evolutionary and

structural relationships.]. Compnt. Biol., 10, 857—868.

Marais,G. and Kingsford,C. (2011) A fast, lock-free approach for efﬁcient par—
allel counting of occurrences of k-mers. Bioinformatics, 27, 764—770.

Murzin,A.G. et al. (1995) SCOP: a structural classiﬁcation of proteins data-
base for the investigation of sequences and structures. ]. Mol. Biol., 247,
5 36—540.

[BJO'SWHIHOIPJOJXO'SOplZIIJJOJLItOIQ/[idnq

1404

l.Borozan et al.

 

Nalbantoglu,O.U. et al. (2011) RAIphy: phylogenetic classiﬁcation of metage-
nomics samples using iterative reﬁnement of relative abundance index pro—
ﬁles. BMC Bioinformatics, 12, 41.

Patil,K.R. et al. (2011) Taxonomic metagenome sequence assignment with
structured output models. Nat. Methods, 8, 191—192.

Rosen,G.L. et al. (2011) Nbc: the naive Bayes classiﬁcation tool webserver for
taxonomic classiﬁcation of metagenomic reads. Bioinformatics, 27, 127—129.

Salzberg,S.L. et al. (1998) Microbial gene identiﬁcation using interpolated
Markov models. Nucleic Acids Res., 26, 544—548.

Shackelton,L.A. and Holmes,E.C. (2004) The evolution of large DNA viruses:
combining genomic information of Viruses and their hosts. Trends
Microbiol., 12, 458—465.

Sims,G.E. et al. (2009) Alignment-free genome comparison with feature fre-
quency proﬁles (FFP) and optimal resolutions. Proc. Natl Acad. Sci. U S A,
106, 2677—2682.

Tyson,G.W. et al. (2004) Community structure and metabolism through re-
construction of microbial genomes from the environment. Nature, 428,
37—43.

Vinga,S. (2014) Editorial: Alignment—free methods in computational biology.
BriefBioinform., 15, 341—342.

Vinga,S. and Almeida,]. (2003) Alignment—free sequence comparison-a re-
view. Bioinformatics, 19, 513—523.

Wood,D.E. and Salzberg,S.L. (2014) Kraken: ultrafast metagenomic sequence
classiﬁcation using exact alignments. Genome Biol., 15, R46.

Wu,T.J. et al. (2005) Optimal word sizes for dissimilarity measures and esti-
mation of the degree of dissimilarity between DNA sequences.
Bioinformatics, 21, 4125—4132.

zur Hausen,H. (2007) Infections Causing Human Cancer. Wiley-VCH Verlag
GmbH 86 Co. KGaA., Weinheim.

/810'sleumofp103xo"soueuuoqutotqﬂ:duq

