BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

CrossMap

 

(9, 10mm) are available from our project Web site. Chain files
for other species are available from the UCSC genome browser.

2.1 Processing BED files

A BED ﬁle is the standard file format used by UCSC to describe
genome regions or annotations. It consists of one line per feature,
with each line containing 3712 columns. CrossMap converts
BED files with <12 columns to a different assembly by updating
the chromosome and genome coordinates only; all other columns
remain unchanged. Regions from old assembly mapping to mul—
tiple locations to the new assembly will be split. For 12—column
BED ﬁles, all columns will be updated accordingly except the
fourth column (name of BED line), fifth column (score value)
and ninth column (RGB value describing the display color).
Twelve—column BED files usually define multiple blocks (e.g.
exons); if any of the exons fails to map to a new assembly, the
whole BED line is skipped and marked as ‘Failed’.

The input BED ﬁle can be plain text file, compressed ﬁle with
extension of .gz, .2, .z, .bz, .bz2 and .bzip2 or even a URL
pointing to a remote file (http://, https://and ftp://). The output
is in BED format with exactly the same number of columns as
the original one.

To evaluate the accuracy of CrossMap, we randomly gener—
ated 10 000 genome intervals from human reference genome hgl9
and converted them into hgl8 using both CrossMap and
liftOver. For genome intervals that were successfully converted
to hg18, the genome coordinates were exactly the same between
liftOver and CrossMap conversion (Supplementary Fig. S1).

2.2 Processing GTF/GFF ﬁles

GFF is another plain text file used to describe gene structure.
GTF is a reﬁned version of GFF with the ﬁrst eight flelds same
as GFF. Plain text, compressed plain text and URLs pointing to
remote ﬁles are all supported. Only chromosome and genome
coordinates are updated. Output ﬁle is either GFF or GTF,
depending on the input ﬁle format.

2.3 Processing BAM/SAM files

Sequence Alignment Map (SAM) format is a generic format for
storing sequencing alignments, and BAM is binary and com—
pressed version of SAM (Li et al., 2009). Most HTS alignments
are stored in SAM/BAM format and many HTS analysis tools
work with this format. CrossMap updates chromosomes,
genome coordinates and header sections to the target assembly.
In addition, all SAM ﬂags indicating mapping status (mapped or
not), strand and mapping quality are updated accordingly. For
pair—end sequencing, insert size is also recalculated. As records,
CrossMap program’s name and version, names of the original
BAM and the chain file were inserted into the header section.
The input BAM ﬁle should be sorted and indexed properly using
SAMTools (Li et al., 2009). BAM output will be sorted and
indexed automatically.

The time CrossMap took increased linearly with the size of
BAM flles (Supplementary Fig. S2) and kept the memory usage

constant (~32 Mb) regardless of the file size (Supplementary
Table S1).

2.4 Processing BigWig/WIG files

WIG format is useful for displaying continuous data such as GC
content and reads intensity of HTS data. BigWig is a self—indexed
binary—format WIG ﬁle, and has the advantage of supporting
random access so that only regions that need to be displayed
are retrieved by genome browser, and it dramatically reduces
the time needed for data transferring (Kent et al., 2010).
BigWig format also facilitates large—scale data mining in gen—
omics and epigenomics (e. g. genomic signal aggregation analysis
at base pair resolution using a large number of datasets over a
large number of genome regions).

WIG data can be in variableStep or ﬁxedStep. Regardless of
the input, the output will be always in bedGraph format.
bedGraph format is similar to WIG format and can be converted
into BigWig format using UCSC wigToBigWig tool. We export
ﬁles in bedGraph because it is usually much smaller than the ﬁle
in WIG format, and more importantly, CrossMap internally
transforms WIG into bedGraph to increase the running speed.

The output file will be in BigWig format if UCSC’s
‘wigToBigWig’ executable can be found; otherwise, the output
ﬁle will be in bedGraph format.

2.5 Convert VCF format files

VCF is a ﬂexible and extendable line—oriented text format de—
veloped by the 1000 Genome Project (http://www.1000genomes.
org/). It is useful for representing single nucleotide variants,
indels, copy number variants and structural variants. Chromo—
somes, coordinates and reference alleles are updated to a new
assembly, and all the other ﬁelds are not changed.

Funding: This work was funded by the Bioinformatics Program,
Center for Individualized Medicine of Mayo Clinic [C4331304 to
K.JP., W.L.]; NIH Cancer Center Support Grant (P30
CA016672), Bioinformatics Shared Resources [PP—SR22 to
W.J., Z.H.].

Conﬂict of Interest: none declared.

REFERENCES

Giardine,B. et a]. (2005) Galaxy: a platform for interactive large—scale genome ana—
lysis. Genome Re.\'., 15, 145171455.

Kent,W.J. et a]. (2010) BigWig and BigBed: enabling browsing of large distributed
datasets. Bioiiy’ormuticx, 26, 22042207.

Kuhn,R.M. et a]. (2013) The UCSC genome browser and associated tools. Brief.
Bioinform., 14, 1447161.

Lander,E.S. et a]. (2001) Initial sequencing and analysis of the human genome.
Nature, 409, 8607921.

Li,H. et a]. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinformatim‘, 25, 207872079.

Spudich,G.M. and Fernandez—Suarez,X.M. (2010) Touring Ensembl: a practical
guide to genome browsing. BMC Genomics, 11, 295.

 

1 007

ﬁm'spzumofpmﬂo'sopnuuopnorq/ﬁdnq

