APPLICATIONS NOTE

Vol. 30 no. 7 2014, pages 1025-1026
doi:1 0. 1093/bioinfonnatics/btt733

 

Gene expression

Advance Access publication December 19, 2013

SplicePlot: a utility for visualizing splicing quantitative trait loci

Eric Wu*, Tracy Nance and Stephen B. Montgomery*
Department of Pathology, Stanford University School of Medicine, Stanford, CA 94305-5324, USA

Associate Editor: Ziv Bar—Joseph

 

ABSTRACT

Summary: RNA sequencing has provided unprecedented resolution
of alternative splicing and splicing quantitative trait loci (sQTL).
However, there are few tools available for visualizing the genotype-
dependent effects of splicing at a population level. SplicePlot is a
simple command line utility that produces intuitive visualization of
sQTLs and their effects. SplicePlot takes mapped RNA sequencing
reads in BAM format and genotype data in VCF format as input and
outputs publication-quality Sashimi plots, hive plots and structure
plots, enabling better investigation and understanding of the role of
genetics on alternative splicing and transcript structure.

Availability and implementation: Source code and detailed docu-
mentation are available at http://montgomerylab.stanford.edu/splice
plotﬁndexhtml under Resources and at Github. SplicePlot is imple-
mented in Python and is supported on Linux and Mac OS.
A VirtualBox virtual machine running Ubuntu with SplicePlot already
installed is also available.

Contact: wu.eric.g@gmail.com or smontgom@stanford.edu

Received on August 9, 2013; revised on October 18, 2013; accepted
on December 9, 2013

1 INTRODUCTION

Alternative splicing is a post-transcriptional process in which
exonic regions of the pre—mRNA are spliced together and in-
tronic regions are removed. Because numerous combinations of
exons can be spliced together, splicing contributes signiﬁcantly to
the diversity of the transcriptome and the resultant proteome.
Further adding to this diversity, genetic variation in cis-acting
splice site regulators and trans-acting splicing factors can affect
patterns of splicing between individuals and potentially manifest
as phenotypic differences (Cooper et al., 2009). Here, the study of
splicing quantitative trait loci (sQTLs) through the statistical
testing of genetic association with changes in alternative splicing
proves useful in identifying functional effects that may contribute
to the etiology of various genetic diseases.

The invention of RNA sequencing (RNA-seq) provides high
resolution, single base characterization and quantiﬁcation of the
transcriptome, providing enhanced resolution of patterns of
alternative splicing. Speciﬁcally, using RNA-seq, the usage of
exons and splice junctions can be precisely quantiﬁed, enabling
the comparison of splicing between individuals in a population.
Indeed, several studies have reported on extensive diversity of
sQTL detectable from RNA-seq data (Montgomery et al.,
2010; Pickrell et al., 2010).

 

*To whom correspondence should be addressed.

However, currently there are few (if any) existing tools that
provide convenient and effective Visualizations of sQTL and their
effects in RNA-seq data. Existing tools, such as the Sashimi plot
provided within the M180 package (Katz et al., 2013), are cap-
able of showing differential splicing between individual samples,
but not between genotypes (a three-way comparison). Because
the study of sQTLs is, by nature, a study of individuals within a
population, effective sQTL Visualization requires tools that inte-
grate population—scale RNA-seq datasets and genotype informa-
tion to Visualize the effect of genetic variation on alternative
splicing.

Here, we present SplicePlot, a command-line utility for Visua-
lizing the effects of genetic variants on alternative splicing and
transcript structure. It produces hive plots (Krzywinski et al.,
2011) and structure plots, as novel ways of Visualizing and
comparing patterns of splicing as measured by splice junction-
spanning reads, by genotype. It also modiﬁes and extends the
Sashimi plot to support the comparison of splicing and transcript
structure between genotypic groups. Such Visualizations take
advantage of the high precision quantiﬁcation of RNA-seq and
enable a better understanding of the genetic effects behind alter-
native splicing in RNA-seq data.

2 USAGE AND IMPLEMENTATION

SplicePlot requires three main inputs: (i) mapped RNA-seq reads
in BAM format, created by a read mapper capable of mapping
junction-spanning reads; (ii) genotypes for each individual in
VCF format; and (iii) an annotation of known exons in GTF
format, which can be downloaded from online databases like
UCSC 0r Ensembl and processed using a provided script. The
user speciﬁes the variant position and splice junction at the com-
mand line. SplicePlot produces publication-quality images in
SVG format. These images are highly customizable, as plotting
parameters like colors, dimensions and font sizes can be specified
using a settings ﬁle.

Using the supplied annotation of known exons, SplicePlot
determines the genomic window of interest and then determines
the read depth and the number ofjunction-spanning reads in the
window for each individual. To produce hive plots and structure
plots, splicing ratios for each individual and junction are calcu-
lated using the following formula:

S R _ number of reads spanning junction
' ' _ number of reads containing 5/ splice site

 

Intuitively, the splicing ratio for a 5/ splice site represents the
proportion of junction-spanning reads containing the five splice
site that also contains a particular 3/ splice site. A similar formula

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0[p1q1x0"sotJBurJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

9103 ‘Og isnﬁnv uo ::

E.Wu et al.

 

(a)

I chrl
T9086256-79093591

   
 
    
 

chr1:79032772
I GG
I GA
I AA

ltl‘lrl
7908 6256—?9 03 6563

I chrlzTQDSEZEE-TDOQEEQL
I chr1:19036256-t9094636
I chrlzTQDBE255-T90365EI3

 

so GA
chr1:?9082??2

 

 

 

c .c 1300 55
I ) § 900 E 10.0 59” —1
a  223,o_———“'_-_A_'
5:; mm 192 o ‘1“
a E  _'__..»-Ti-
230.0
.5 1300 
g 900E __3.o_._.—-———10.0—————.:.___H‘___
l “"-'—-l—- 149.0—-|-—""r_ |
79035057 79037054 79091933 79094533
Genomic coordinate {chrIL "+" strand
_ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -
——v-~ ~~—-~ — ~——— ~— ~~—- ——-~
—-

 

Fig. 1. Example plots illustrating the same sQTL in 59 individuals. (a) A hive plot. (b) A structure plot. (c) A Sashimi plot

for 3/ splicing ratios can also be deﬁned. SplicePlot also calcu-
lates the average read depth and the average number of junction-
spanning reads for groups stratified by a genotype at a
user-speciﬁed locus, for use in drawing modiﬁed Sashimi plots.

SplicePlot is implemented in Python using the pysam module,
a wrapper for SAMtools (Li et al., 2009). Plotting is fast and
memory-efﬁcient, as retrievals from VCF and GTF ﬁles are done
with Tabix (Li et al., 2009).

3 RESULTS

3.1 Hive plots

A hive plot is a radial plot that enables the comparison of splicing
ratios between individuals and between genotype groups. Each of
the axes corresponds to a splice junction with a ﬁxed donor (or
acceptor) location. Individuals are represented by curved paths
that go around the plot. The paths are color-coded by the indi-
vidual’s genotype at the user-speciﬁed locus. The radial distances
of the points of intersection between the paths and the axes are
proportional to the splicing ratio for the corresponding splice
junction in the individual. The approximate strength of the
sQTL can be estimated by looking at the color patterns in the
plot. A sample hive plot is shown in Figure 1a.

3.2 Structure plots

Structure plots [named after popular Visualizations used by the
program STRUCTURE, (Hubisz et al., 2009)] provide another
way of Visualizing sQTLs in populations, while showing splicing
ratios at the individual level. In a structure plot, each set of
stacked bars represents the splicing ratios for each individual.
The bars are color-coded by junction, and the height of each
bar represents the magnitude of the splicing ratio. In addition,
the arrangement of stacked bars clearly shows that the sum of
the splicing ratios in each individual must total 1. Individuals are
grouped spatially by their genotype at the speciﬁed locus to
enable the Viewer to effectively compare the similarities and dif-
ferences in splice junction usage by genotype. A sample structure
plot is shown in Figure lb.

3.3 Modiﬁed Sashimi plots

SplicePlot modiﬁes the Sashimi plot from MISO to enable the
effective Visual comparison of alternative splicing and transcript
structure across genotypic categories within populations. The
plots allow the average read depth and the average number of
junction-spanning reads to be compared between genotype
groups, providing insight into the ways sQTL affects the quantity
and structure of isoforms. A sample Sashimi plot is shown in
Figure 10.

4 CONCLUSION

SplicePlot is an analytic tool for summarizing read data and
generating intuitive, publication-quality figures for Visualizing
sQTL. It draws hive plots, structure plots and Sashimi plots to
enable the effective comparison of alternative splicing and tran-
script structure. We have further provided an Ubuntu Virtual
machine containing the Montgomery et a]. (2010) dataset with
SplicePlot. This Virtual machine can be downloaded and installed
to allow users to investigate loci of interest, thereby providing
new opportunity for the research community to investigate the
impact of any genetic variant on splicing.

Funding: Edward Mallinckrodt Jr. Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Cooper,T. et a]. (2009) RNA and disease. Cell, 136, 7777793.

Hubisz,M.J. et a]. (2009) Inferring weak population structure with the assistance of
sample group information. M0]. Ecol. Resour., 9, 132271332.

Katz,Y. et a]. (2013) Sashimi plots: quantitative visualization of RNA sequencing
read alignments. arX iv, 1306.3466.

Krzywinski,M. et a]. (2011) Hive plotsirational approach to visualizing networks.
Brief. Bioinform., l3, 627$44.

Li,H. et a]. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 207872079.

Montgomery,S.B. et a]. (2010) Transcriptome genetics using second generation
sequencing in a Caucasian population. Nature, 464, 7737777.

Pickrell,J. et a]. (2010) Understanding mechanisms underlying human gene expres—
sion variation with RNA sequencing. Nature, 464, 7687772.

 

1026

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} papeolumoq

9103 ‘Og isanV uo ::

