BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Z.Iqbal et al.

 

   

I I
A - D
I 5 i,
*

g B (x)
* ./

(X) '/ Joint (de novo)

(if?) X Joint (ref. for coordinates only)

* 71‘: Joint (ref. for discovery and coordinates)

* Independent
( ) Filtered from VCF (no coordinate)

Fig. 1. Cartoon shows two samples (red and blue) and a diverged refer-
ence genome (black) in a de Bruijn graph; symbols indicate which work-
ﬂows call sites. Brackets indicate ﬂanking regions cannot be placed on
reference, so the call is ﬁltered from VCF. At SNP B, the independent
workﬂow would call the red and blue versions of H and would implicitly
find B. C is only called if the reference is excluded from discovery, as it
confounds the red allele. D is called by workﬂows that include the refer-
ence in discovery

Table 1. Time complexity of workﬂow stages

 

 

Step Complexity 1000 samples/ Parallelizable
100 CPUs

Build O(D) 45 min 1,]

Error clean O(G)+O(D) 3.3 min 1,]

Load all samples ac 40 min (1 CPU) no
Discovery O(G) 2 min I
Genotyping O(S)+O(cp.) 8 min (1 CPU) no

 

D = depth of coverage, c = number of colours/samples, G = genome size, S =
number of sites, [1. = mean allele length, a = time to load one sample graph (2.5 s for
S.aureus), I = independent, J = joint. Column 3 gives estimates for analysis of 1000
S.aureus samples with 100 CPUs and the Bubble Caller, based on Case Study 2 (8
min based on fact that genotyping of 72 samples in Case Study 2 took 35 s).

loaded into the graph for discovery/genotyping. Processing 1000
Staphylococcus aureus samples would require of the order of
106 Gb RAM (Supplementary Information, Section 5). Time
complexity of each step is shown in Table 1; note the non—
parallelizable steps scale linearly with number of samples.

4 A REPOSITORY OF VARIATION

Assembled graphs and callsets are a repository of known se—
quence and variation. If a new sample is obtained, pre—existing
binaries (both workflows) and callsets (independent) are reused;
the sample is compared with previous sequence (joint) or with the
reference (independent) and all samples are regenotyped at all
sites. Thus, Cortex allows new samples to be compared with the
entire pan—genome (see Supplementary Information Section 13
for further details).

5 CASE STUDIES
5.1 Rapid high-quality calls without manual curation

We show Cortex can generate results of comparable quality to
those from labour—intensive whole—genome assembly and align—
ment. In Mwangi et al. (2007), the authors Sanger—sequenced two
strains of S.aureus (depth 9x), did two whole—genome

assemblies, mapped reads to contigs, a three—way alignment be—
tween the assemblies and a reference, called variants, and
removed alignment errors, giving 32 validated SNP differences
on the chromosome. Post—publication, 8 further SNPs (one vali—
dated) were found when the assemblies were finished
(M. Mwangi, personal communication). Using the joint work—
flow (k: 31,61 and 160 MB RAM), it took 188 seconds to call 36
differences between the strains, including 29 (2) of the published
(post—publication) Mwangi callset, 30 of the 33 validated calls
and 33 confirmed by finished references (Supplementary
Information Section 11).

5.2 Comparable sensitivity to mapping

We here show Cortex attaining the same sensitivity as
mapping—cased calling for microbial genomes by reproducing
the results of (Young el al., 2012), who analysed 72 isolates
(100x each, 100 bp Illumina reads) of S.aureus. They used map—
ping (Stampy/samtools) to two references (MSSA476 and their
own assembly), plus variant assembly (early release of Cortex),
plus manual curation, to find 32 (2) SNPs/indels placeable on
MSSA476 (their reference). We reproduced their 32 calls (inde—
pendent workflow, kmer = 61, 10 GB RAM), in 5.5 h (one CPU).
The other two sites were also called (independent+their reference
or joint workflow) (Supplementary Information Section 12).

6 CONCLUSION

We have shown that the Cortex population assembler provides
a method for rapid, high—quality variant discovery in microbial
genomes and allows comparison of new samples with all
previously known strains. We believe it will prove valuable in
microbial population genomics.

ACKNOWLEDGEMENTS

We thank Michael Mwangi, Daniel Wilson and Bernadette Young
for assistance comparing callsets and Alex Dilthey for discussions.

Funding: The Wellcome Trust (WT086084/Z/08/Z to GM.)

Conﬂict of Interest: None declared.

REFERENCES

Degner,J.F. et a]. (2009) Effect of read—mapping biases on detecting allele—specific
expression from RNA—sequencing data. Bioinﬁnmatics, 25, 320773212.

den Bakker,H.C. et a]. (2011) Genome sequencing reveals diversification of viru—
lence factor content and possible host adaptation in distinct subpopulations of
Salmonella enteriea. BM C Genomics, 12, 425.

Iqbal,Z. et a]. (2012) De novo assembly and genotyping of variants using colored de
Bruijn graphs. Nat. Genet., 199, 1337154.

Li,H. et a]. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinﬂﬁnmtics, 25, 207872079.

McKenna,A. et a]. (2010) The Genome Analysis Toolkit: a MapReduce framework
for analyzing next—generation DNA sequencing data. Genome Rest, 20,
129771303.

Mwangi,M. et a]. (2007) Tracking the in vivo evolution of multidrug resistance in
Staphylococcus aureus by whole—genome sequencing. Proc. Natl Acuil. Sci. USA,
104, 94519456.

Young,B. et a]. (2012) Evolutionary dynamics of Stupizylococms aureus during pro—
gression from carriage to disease. Proc. Natl Acuil. Sci. USA, 109, 455(k4555.

 

276

ﬁio'sreumol‘piojxo'sopeuuqutotq/ﬁdnq

