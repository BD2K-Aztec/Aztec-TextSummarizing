APPLICATIONS NOTE

Vol. 28 no. 2 2012, pages 288-289
doi:10. 1 093/bioinformatics/btr645

 

Gene expression

Advance Access publication November 22, 2011

MSnbase-an R/Bioconductor package for isobaric tagged mass
spectrometry data visualization, processing and quantitation

Laurent Gatto* and Kathryn S. Lilley

Cambridge Centre for Proteomics, Cambridge Systems Biology Centre, Department of Biochemistry, University of

Cambridge, Tennis Court Road, CB2 10B, Cambridge, UK

Associate Editor: John Quackenbush

 

ABSTRACT

Summary: MSnbase is an R/Bioconductor package for the analysis
of quantitative proteomics experiments that use isobaric tagging.
It provides an exploratory data analysis framework for reproducible
research, allowing raw data import, quality control, visualization, data
processing and quantitation. MSnbase allows direct integration of
quantitative proteomics data with additional facilities for statistical
analysis provided by the Bioconductor project.

Availability: MSnbase is implemented in R (version 3213.0) and
available at the Bioconductor web site (http://www.bioconductor
.org/). Vignettes outlining typical workflows, input/output capabilities
and detailing underlying infrastructure are included in the package.

Contact: lg390@cam.ac.uk

Supplementary information: Supplementary data are available
from Bioinformatics online.

Received on June 8,2011; revised on September 29, 2011 ; accepted
on November 16, 2011

1 INTRODUCTION

Proteomics, the analysis of the entire protein complement expressed
by a genome, has recently beneﬁted from substantial technological
advances (Nilsson et (11., 2010). Among the numerous approaches
to interrogate proteomes, a popular technique is the quantitation
of samples using isobaric tags. Nevertheless, high-throughput
proteomics lags behind genomics, genetics or transcriptomics in
terms of reproducible data analysis and development of analytical
stategies. One of the challenges within proteomics is the availability
of open, extensible and efﬁcient data mining and statistical
assessment environments (Lilley et (11., 2011).

Here, we introduce the MSnbase package, part of the
Bioconductor project (Gentleman et (11., 2004). MSnbase extends
Bioconductor with tools and data structures to import raw tandem
mass spectrometry (MS2) data, perform exploratory data analysis
and quantiﬁcation of isobaric reporter tags. The infrastructure is
compatible with existing Bioconductor core packages, incorporating
available features and allowing direct utilization of additional
ﬁinctionality.

 

*To whom correspondence should be addressed.

2 AVAILABLE FUNCTIONALITY

2.1 Data structures

MSnbase provides computational data structures to allow
representation of mass spectrometry data types including, individual
mass spectra, full experiments, quantiﬁcation data and information
pertaining to isobaric tags. Data structures for commercially
available reagents like iTRAQ (Ross et (11., 2004) or TMT
(Thompson et (11., 2003) tags are included in the package, although
any arbitrary set of peaks can be deﬁned.

MSnbase also supports storage and direct access to the
description of individual features (mass spectra, peptides or
proteins), samples and analysis workﬂows as well as MIAPE (Taylor
et (11., 2007) compliant information. Metadata associated with an
experiment and the transformations it has undergone are accounted
for and inherited along the analysis pipeline.

2.2 Data processing and visualization

A typical workﬂow starts by loading proﬁle-mode or centroided
data in an open XML-based standard format or mgf peak lists.
Alternatively, quantitative data stored in spreadsheet ﬁles can also
be imported into the MSnbase framework for post-processing and
statistical analysis. Several methods geared towards quality control
are available within MSnbase. The availability of easily accessible
structured data combined with R data analysis and plotting facilities
allows extensive exploratory data analysis to obtain a precise
overview of the data and to perform experiment-speciﬁc quality
control.

MSnbase enables visualization of individual or sets of spectra
of particular interest, optionally highlighting the reporter ions (see
left panel on Fig. 1 for an example) to facilitate assessment
by proteomics scientists. Pre-processing of individual spectra,
including removal of low intensity peaks and experiment-wide
ﬁltering to remove low-quality spectra or extract speciﬁc spectra of
interest into new sub-experiments, is easily accomplished. Speciﬁc
spectra regions can be retrieved to focus on mass to charge (m/z)
regions, e.g. the reporter ions m/z range, while preserving both data
structure and metadata.

2.3 Quantitation

MSnbase focuses on MS2 level quantitation using isobaric repoter
tags. Whole experiments or individual spectra can be quantiﬁed
using the quantify method upon specifying the isobaric reporter
ion tags. Quantitation is performed, among others, by calculating

 

288 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bruno[pJOJXO'sorwuiJOJurorqﬂ:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

MSnbase

 

Raw iTRAQ 47p|ex reporter peaks

 

 

 

 

 

 

0.5— l_.
. l I
0.5— [N
I I I
a 0.5— lo:
'ﬁ 1 I I
I:
E
5 0.5— I»
I I I
0.5— 101
l l I
0.5—
I i I I”
114.1 115.1 116.1 117.1
M/Z

Quantified and quantile normalised M82 spectra

.0 .0
4> on
I I

Intensity
.0
(a)
I

0.2 —

 

I I I I
114.1 115.1 116.1 117.1
M/Z

Fig. 1. Illustration of some of MSnbase data processing and visualization capabilities. On the left, reporter ion peaks (re-scaled between 0 and 1) for 6 M82
spectra of different peptide ions derived from a spiked-in protein have been extracted from a large experiment. On the right, relative intensities distribution
of all spectra of the same protein are plotted. Point size is proportional to the sum of reporter intensities, and expected values are marked as diamonds.

the area under the curve (for proﬁle mode data) or the maximum
peak intensity (for centroided data).

2.4 Data post-processing

Due to isotopic contamination in tags, reporter ion peaks will
contribute to those of neighbouring reporter ions. Purity correction
of such overlap can be performed with the purityCorrect
method, providing relative reporter percentages available from the
tag manufacturers.

After quantitation, individual spectra can be amalgamated
using the combineFeatures method. Structures deﬁning which
features to combine (for example based on precursor m/z, peptides
or proteins) can be extracted directly from the feature metadata.
Lastly, a summarization ﬁinction that describes how to combine
feature intensities may be selected from a list of possible options
(mean, median, weighted mean, sum or median polish) or, a user
deﬁned alternative.

Normalization of expression data is performed using the
normalize method, and accommodates several well-known
normalization algorithms such as quantile normalization (Bolstad
et (11., 2003) (applied in the right panel of Fig. 1) or variance
stabilization normalization (Huber et (11., 2002; Karp et (11., 2010).

We illustrate the above ﬁinctionality on a real, publicly available
dataset as a Supplementary File. Data processing, from import to
post-processing took about 20 min on a stande laptop.

3 CONCLUSION

This note introduces the Bioconductor MSnbase package for
the analysis of quantitative proteomics experiments that use
isobaric tagging. The package provides the necessary environment
for convenient data manipulation, processing, visualization and
quantiﬁcation, from which users and programmers can build and
develop coherent and reproducible analysis pipelines. Compatibility
with pre-existing infrastructure takes advantage of available

normalization algorithms and facilitates application of statistical
analysis methods provided by other Bioconductor packages. In
future, MSnbase will be further developed to deﬁne standard data
processing pipelines, facilitate the inclusion of peptide identiﬁcation
data and allow label-free quantitation. Support is provided on the
Bioconductor help mailing list.

ACKNOWLEDGEMENTS

The authors thank Dr Matthew Trotter, University of Cambridge,
for helpful comments on previous versions of the manuscript.

Funding: BBSRC Tools and Resources Development Fund
(Award BB/GO24618/1); European Union 7th Framework Program
(PRIME-XS project, grant agreement number 262067).

Conﬂict of Interest: none declared.

REFERENCES

Bolstad,B.M. et al. (2003) A comparison of normalization methods for high density
oligonucleotide array data based on variance and bias. Bioinformaties, 19, 1857193.

Gentleman,R.C. et (11. (2004) Bioconductor: open software development for
computational biology and bioinforrnatics. Genome Biol, 5, R80.

Huber,W. et (11. (2002) Variance stabilization applied to microarray data calibration
and to the quantiﬁcation of differential expression. Bioinformaties, 18 (Suppl. 1),
S9&SIO4.

Karp,N.A. et al. (2010) Addressing accuracy and precision issues in itraq quantitation.
Mol. Cell Proteomies, 9, 188571897.

Lilley,K.S. et al. (2011) Challenges for proteomics core facilities. Proteomies, 11,
101771025.

Nilsson,T. et al. (2010) Mass spectrometry in high-throughput proteomics: ready for
the big time. Not. Methods, 7, 681$85.

Ross,P.L. et (11. (2004) Multiplexed protein quantitation in saccharomyces cerevisiae
using amine-reactive isobaric tagging reagents. Mol. Cell Proteomies, 3, 115441169.

Taylor,C.F. et (11. (2007) The minimum information about a proteomics experiment
(MIAPE). Nat. Biotechnol, 25, 8877893.

Thompson,A. et al. (2003) Tandem mass tags: a novel quantiﬁcation strategy for
comparative analysis of complex protein mixtures by MS/MS. Anal. Chem, 75,
189571904.

 

289

112 /3.Io's[BumoprOJxosoiwuiJOJurorq”:duq moi; papeolumoq

91oz ‘Og anﬁnv uo ::

