BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Md S.Bayzid and T. Wamow

 

about the relative performance of ILS—based methods, how they
compare with methods (such as concatenation) that do not take
ILS into account and what factors impact the absolute and rela—
tive performance of methods.

In this article, we report on a simulation study to evaluate a
collection of methods for estimating species trees and gene trees
in the presence of ILS. Our simulation study includes datasets
generated under three model conditions from prior studies
(Chung and Ane, 2011; Yu et al., 2011b). One model condition
has 17—taxon datasets that evolve under a strong molecular clock,
and the other two model conditions have 11—taxon datasets that
do not evolve under a clock. The amount of ILS varies between
the three model conditions, ranging from relatively low amounts
to high amounts. Finally, estimated gene trees on these datasets
have low average bootstrap support due to insufﬁcient phylogen—
etic signal, reﬂecting conditions often encountered when sam—
pling genes from throughout the genome. We study a wide
range of methods for estimating species trees from multiple mar—
kers, including *BEAST (Heled and Drummond, 2010), both the
population and concordance trees returned by BUCKy
(Ané et al., 2007; Larget et al., 2010), MP—EST (Liu et al.,
2010), Phylonet—MDC (Than et al., 2008; Yu et al., 2011a),
GC (also called the extended majority consensus), matrix repre—
sentation with parsimony (MRP) (Baum and Ragan, 2004) and
concatenation using maximum likelihood (CA—ML).

Our study revealed that many methods have poor accuracy
when the individual gene sequence alignments have low phylogen—
etic signal. This vulnerability to poor signal affects all methods,
but especially those that combine estimated gene trees; by com—
parison, *BEAST and CA—ML are relatively less impacted.

We developed an approach to address the vulnerability of spe—
cies tree methods to low phylogenetic signal. We randomly par—
titioned the genes into subsets (which we call ‘supergenes’),
estimated trees from these supergene alignments and then used
methods to estimate the species tree from the supergene trees.
This approach did not produce statistically signiﬁcant changes in
accuracy on the 17—taxon datasets, but improved the accuracy of
the trees estimated by combining estimated gene trees, often sub—
stantially, on the 11—taxon datasets. Running *BEAST on the
binned supergene alignments did not impact its accuracy, but
did improve its scalability. Furthermore, when used with bin—
ning, several methods came close to being as accurate as
*BEAST, while being orders of magnitude faster than
*BEAST. Thus, this study suggests that highly accurate large—
scale phylogenomic analyses may be achievable through a naive
binning technique.

2 MATERIALS AND METHODS

See the Supplementary Materials for details.

2.1 Datasets

We used simulated ll-taxon (Chung and Ané, 2011) and l7-taxon
(Yu et al., 2011a, b) multi-gene datasets. The ll-taxon datasets have
100 genes, and the l7-taxon datasets have 32 genes. The protocols used
in the two studies were fairly similar; however, the ll-taxon datasets
reﬂect more heterogeneity, and hence are less idealized than the
l7-taxon datasets. In each case, a model species tree was generated and
a set of gene trees within each species tree (with one haploid individual

sampled per species) produced under a coalescent process. This produces
gene trees that can differ topologically from their associated species tree
owing to ILS. DNA sequences were then simulated down each gene tree
under the Jukes-Cantor model. Hundred replicates were generated for
each model condition, and each replicate consisted of a set of true
sequence alignments (i.e. one alignment for each gene).

The ll-taxon and l7-taxon datasets differ in some regards. First, the
l7-taxon datasets evolved under a molecular clock, but the ll-taxon
datasets did not. Second, the ll-taxon datasets have short sequences
(only 500 nucleotides), but the l7-taxon datasets have long sequences
(2000 nucleotides). In the ll-taxon model conditions, there is substantial
rate variation between the gene trees and species tree, but this is not true
for the l7-taxon model conditions. Finally, the model conditions also
varied in the amount of ILS, as we now discuss.

We calculated two statistics to evaluate the level of ILS in each model
condition: the ‘average clade distance’ between the true species tree and
the true gene trees and the percentage of the true gene trees that have the
same topology as the true species tree. The clade distance between two
rooted trees (i.e. the rooted analog of the bipartition distance) is the total
number of unique non-trivial clades (in one tree but not in both) divided
by 2n — 4. Thus, if two rooted trees on seven leaves share exactly two
clades in common, the clade distance is 60%. Using this metric, the
l7-taxon datasets have the highest amount of ILS (average clade distance
25.7%). The ll-taxon datasets came in two forms, one with somewhat
lower (but still high) amounts of ILS (average clade distance 14.8%), and
one with low amounts of ILS (average clade distance 2.9%). We refer to
the two ll-taxon models as strongILS and weakILS, accordingly. The
percent of gene trees that match the species tree also ﬁts with this relative
ranking: 73.1% for the ll-taxon weakILS datasets, 21.3% for the
ll-taxon strongILS datasets and only 1.7% for the l7-taxon datasets.
Thus, the l7-taxon datasets have extremely high levels of ILS, but the
ll-taxon strongILS also have a high level of ILS.

2.1.1 Selecting subsets of genes For the l7-taxon datasets, we used
the provided 8-gene and 32-gene datasets; for the ll-taxon datasets, we
sampled from the 100 genes to produce subsets with the desired number
of genes.

2.2 Gene tree estimation

We compared *BEAST, RAxML v. 7.3.1 (Stamatakis, 2006) and
FastTree-2 (Price et al., 2010), as gene tree estimators. We used 20 runs
of RAxML on each of the alignments, and retained the tree with the best
ML score; for FastTree-2, we used it with only one run (because it is
deterministic, it is not improved by multiple runs). For *BEAST, we ran
it as described below. We used RAxML with 400 bootstrap replicates for
BUCKy and for Phylonet.

2.3 Species tree methods

We include *BEAST, MP-EST, BUCKy-pop, BUCKy-con, CA-ML, the
GC, Phylonet-MDC and MRP; see below for details. With the exception
of *BEAST and CA-ML, these methods estimate the species tree by
combining estimated gene trees; we refer to these as ‘summary methods’.
For MP-EST, MRP and GC, we use the binary gene trees as input [these
methods either require binary gene trees or have not been shown to im-
prove by contracting low support branches (Yang and Warnow, 2011)].

We used *BEAST v. 1.6.2 (Heled and Drummond, 2010) in its default
setting, and used the default point estimates for the gene trees and species
tree. For a given *BEAST analysis, we discarded the ﬁrst 10% of the trees
returned by the analysis, and then sampled one out of each 1000 of the
remaining trees. We ran *BEAST long enough to return ESS values that
were large enough to suggest possible convergence. Even after 150 h of
analysis, the ESS statistics for *BEAST on the ll-taxon lOO-gene

 

2278

ﬁm'spzumofpmﬂo'sopnuuopnorq/ﬁdnq

Naive binning

 

strongILS datasets were poor, suggesting that *BEAST had not
converged; therefore, we omit results of *BEAST for these datasets.

We used MP-EST (Liu et al., 2010) in its default setting, using
MAXROUND: 100000, and with RAxML gene trees rooted at the
provided outgroup.

We used BUCKy (Ané et al., 2007) with the default setting to compute
two species tree estimationsithe population tree (BUCKy-pop) and the
concordance tree (BUCKy-con). We computed gene tree distributions
using RAxML with bootstrapping and also using *BEAST as input to
BUCKy. On each model condition and number of genes, we ran BUCKy
using a sufﬁciently large number of MCMC iterations to reach sufﬁ-
ciently low standard deviations for the concordance factors to suggest
possible convergence.

We used Phylonet v. 2.4 (Than et al., 2008) for a version of the NP-
hard MDC problem that takes gene tree branch support values into
consideration. Although MDC is not statistically consistent (Than and
Rosenberg, 2011), Phylonet-MDC can produce highly accurate species
trees (Yang and Warnow, 2011) when applied to gene trees in which all
the low support branches are collapsed. Phylonet provides a technique to
solve this version of MDC exactly, even for unrooted gene trees (Bayzid
and Warnow, 2012; Yu et al., 201 la, b), which can be used on datasets
with a small enough number of taxa; we used this exact method for MDC
for the ll-taxon datasets, and Phylonet’s heuristic method (which re-
stricts the solution space to those trees all of whose bipartitions come
from the input set of trees) for the l7-taxon datasets. We used Phylonet
on the ML gene trees with all branches having bootstrap support <75%
collapsed.

We used PAUP* to estimate MRP, using the standard heuristic search,
and also to compute a GC (also called the ‘extended majority consensus’)
of the estimated gene trees. Both of these analyses are performed on
the binary gene trees estimated by maximum likelihood. We also studied
CA-ML, using RAxML to infer a species trees from the superalignment
(without partitioning), and using 10 independent runs (—N 10).

2.4 Criteria

We report tree error using the missing branch rate (also known as the FN
or ‘false negative’ rate), which is the proportion of internal branches in
the true tree deﬁning bipartitions that are missing in the estimated tree.
The use of FN rates rather than RobinsoniFoulds rates is owing to the
observation that some of the methods for estimating trees produce unre-
solved trees, and the RobinsoniFoulds rates would be biased in favor of
these methods (Rannala et al., 1998). We tested for statistical signiﬁcance
using the Wilcoxon signed rank test.

2.5 Experiments

The ﬁrst experiment compared the ‘fast’ methods (all methods except
*BEAST and BUCKy) on 100 replicates of the ll-taxon and l7-taxon
datasets, varying the number of genes, using RAxML to estimate gene
trees. The second experiment compared the full set of methods on 20
replicates of these model conditions, again using RAxML to estimate
gene trees. We explored the accuracy of gene trees estimated by
RAxML, FastTree and *BEAST in the third experiment. The fourth
experiment evaluated the accuracy of species trees computed for gene
trees estimated by *BEAST. The fifth experiment then examined the
impact of binning genes into supergenes, using a simple ‘naive’ binning
technique.

3 RESULTS

We show results evaluating computational aspects of the differ—
ent methods, and then results of the ﬁve basic experiments

exploring accuracy. See the Supplementary Materials for add—
itional details.

3.1 Computational issues

The phylogenomic pipelines we studied differed dramatically in
terms of their running times, making some methods infeasible to
use on some datasets within the limits of this study. Due to space
limitations, we present a brief discussion of the computational
requirements of the different methods, and direct the interested
reader to the Supplementary Materials for full results.

Pipelines that used *BEAST took the most time, with running
times of 8&150 h for the 50—gene datasets with 11 taxa; analyses
of the 100—gene datasets with 11 taxa did not converge, even in
150 h. The pipelines with BUCKy, when used with distributions
computed using RAxML bootstrapping, took up to 5 h, but were
able to be run on even the 100—gene 11—taxon datasets. Pipelines
with Phylonet when used with the RAxML bootstrap trees
(restricted to the high support edges) took up to 2h per dataset
(almost all of that for running RAxML). Pipelines with MRP,
GC and CA—ML took just a few minutes per dataset.

Because of these computational issues, we only ran BEAST on
unbinned datasets with at most 50 genes (and even these were
computationally intensive). We also did not run *BEAST or
unbinned BUCKy on more than 20 replicates for any model
condition. Therefore, in the remaining study, we show results
for the ‘fast’ methods (everything but *BEAST and BUCKy)
on 100 replicates of the model conditions, and we examine
*BEAST and BUCKy on only 20 replicates of the model condi—
tions. We do, however, show results using BUCKy with binning
on 100 replicates of some model conditions. In total, we estimate
that we used at least 5000 CPU h, just for the *BEAST runs.

3.1.] Experiment I The first experiment explored the accuracy
of the ‘fast’ methods for estimating species trees, i.e. CA—ML,
MP—EST, MRP, Phylonet and GC; Figures 173. CA—ML had the
best accuracy, with large improvements over other methods on
the 11—taxon datasets and small improvements on the 17—taxon
datasets. All the improvements are statistically signiﬁcant:
P<0.003 for the 11—taxon strongILS with up to 100 genes and
the 11—taxon weakILS with up to 25 genes, and P g 0.04 for the
17—taxon datasets.

3.1.2 Experiment 2 We then evaluated BUCKy—pop, MP—EST,
*BEAST, CA—ML and BUCKy—con. Because *BEAST is com—
putationally intensive, the analyses were limited to 20 replicates
per datapoint. See Figures #6.

Note that *BEAST and CA—ML are the two most accurate
methods on these data, with the greatest improvement over the
other methods on the 11—taxon weakILS datasets and the least
improvement on the 17—taxon datasets. The relative performance
between CA—ML and *BEAST varied, with CA—ML better in
some cases and worse in others, and often the difference was
small.

BUCKy—pop is in third place, and even matched the accuracy
of *BEAST on the 11—taxon strongILS datasets with 25 genes. A
comparison between BUCKy—pop and BUCKy—con shows that
they had close accuracy in most cases, but that BUCKy—pop was
sometimes more accurate than BUCKy—con (e. g. on the 11—taxon

 

2279

ﬁm'spzumofpmjxo'sopnuuopnorq/ﬁdnq

 

l MRP
l   Inns: h

C A—ML
MP—E ST

MRP
GC

 

I
El
El thlo—exnct
El
El

I CA—h’lL
1:1 NIPiEST
El thlo—hcu
El ’R

El

 

M P
GC

I CA—ML
El *BEAST

El BUCK-V'icon
El BUCKy—pop
1:1 MPiEST

 

 

I P EST
  I'll HI

I CA—ML
El *BEAST

El BUCKy—con
El BUCKvipop
1:1 NIP—EST

 

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

53x\Ewogmoizmnnw.oxmoagoﬁsiwbwﬁ

I Unbinned
El Binned (5 bins)

I Unbinned

 

El Binned (10 bins)

I Unbinned

 

El Binned (20 bins)

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

 

a II Iili'llili

I Unbinned
El Binned (20binsl

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

Md S.Bayzid and T. Wamow

 

that the critical issue is the number of genes, and that ILS—based
methods will have better accuracy than concatenation when the
number of genes is large enough. Clearly, further research is
needed to understand which conditions favor each type of
approach. See Section 4 in Supplementary Materials for more
discussion of these issues.

5 CONCLUSKHﬁSANDFUTURE\NORK

Under the conditions of our experiments (at least 11 taxa, at
most 100 genes and low signal per gene sequence alignment),
we observed relatively poor species tree estimations using stand—
ard summary methods, and more accurate results from concat—
enation or from *BEAST, a method that co—estimates gene trees
and species trees. However, the current co—estimation methods
(including *BEAST) are computationally intensive and may not
be feasible for use with more than 100 genes or more than 20
species. This study showed that a simple binning technique was
able to make dramatic improvements in scalability for *BEAST,
and generally improve the accuracy of summary methods, thus
making some of these methods nearly as accurate as *BEAST.

This study should not be interpreted as recommending the use
of naive binning, but instead as an indication of the potential for
binning techniques to improve species tree estimation. For ex—
ample, statistical techniques could be used to estimate whether a
set of genes is likely to have a common tree, so that bins would
only include genes expected to have a common history. Also,
while concatenation performed well in this study, we conjecture
that new techniques designed to handle markers with limited
phylogenetic signal, might outperform concatenation even
under these model conditions. Whether these new techniques
will use binning, or other ways of working with poorly estimated
gene trees, the potential for substantial advances in species tree
estimation could be great.

ACKNOWLEDGMENTS

The authors thank the anonymous reviewers, and C. Ane, J.
Degnan, B. Faircloth, M. Hahn, S. Mirarab and J. Pease for
their helpful comments. The authors also thank Y. Chung, C.
Ane, Y. Yu and L. Nakhleh for the use of their datasets.

Funding: National Science Foundation (DBI—1062335, DEB
0733029, and DBI—0735191); Fulbright Foundation
(International Fulbright Science and Technology PhD Award
to MSB). This material was performed in part while TW was
working at the National Science Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Ane,C. et al. (2007) Bayesian estimation of concordance among gene trees.
Mol. Biol. Evol., 24, 412426.

Baum,B. and Ragan,M.A. (2004) The MRP method. In: Bininda—Emonds,O.R.P.
(ed.) Phylogenetic Supertrees: Combining Information to Reveal The Tree Of
Life. Kluwer Academic, Dordrecht, the Netherlands, pp. 17734.

Bayzid,M.S. and Warnow,T. (2012) Estimating optimal species trees from incom—
plete gene trees under deep coalescence. J. Comput. Biol., 19, 591$05.

Chung,Y. and Ane,C. (2011) Comparing two Bayesian methods for gene tree/spe—
cies tree reconstruction: a simulation with incomplete lineage sorting and hori—
zontal gene transfer. Syst. Biol., 60, 2617275.

DeGiorgio,M. and Degnan,].H. (2010) Fast and consistent estimation of species
trees using supermatrix rooted triples. Mol. Biol. Evol., 27, 5527569.

Degnan,].H. et al. (2009) Properties of consensus methods for inferring species trees
from gene trees. Syst. Biol., 58, 35754.

Degnan,].H. and Rosenberg,N.A. (2009) Gene tree discordance, phylogenetic infer—
ence and the multispecies coalescent. Trends Ecol. Evol., 26, 3327340.

Edwards,S.V. (2009) Is a new and general theory of molecular systematics emer—
ging? Evolution, 63, 1719.

Edwards,S.V. et al. (2007) High—resolution species trees without concatenation.
Proc. Natl Acad. Sci. USA, 104, 593(r594l.

Heled,J. and Drummond,A.J. (2010) Bayesian inference of species trees from multi—
locus data. Mol. Biol. Evol., 27, 57(F580.

Huang,H. et al. (2010) Sources of error inherent in species—tree estimation: impact of
mutational and coalescent effects on accuracy and implications for choosing
among different methods. Syst. Biol., 59, 5737583.

Knowles,L.L. (2009) Estimating species trees: methods of phylogenetic analysis
when there is incongruence across genes. Syst. Biol., 58, 4637367.

Kubatko,L.S. and Degnan,].H. (2007) Inconsistency of phylogenetic estimates from
concatenated data under coalescence. Syst. Biol., 56, 17.

Larget,B. et al. (2010) BUCKy: gene tree/species tree reconciliation with the
Bayesian concordance analysis. Bioiiy’ormatics, 26, 291(k2911.

Leache,A.D. and Rannala,B. (2011) The accuracy of species tree estimation under
simulation: a comparison of methods. Syst. Biol., 60, 12(r137.

Liu,L. et al. (2010) A maximum pseudo—likelihood approach for estimating species
trees under the coalescent model. BMC Evol. Biol., 10, 302.

Maddison,W. (1997) Gene trees in species trees. Syst. Biol., 46, 5237536.

Meredith,R.W. et al. (2011) Impacts of the Cremceous terrestrial revolution and
KPg extinction on mammal diversiﬁcation. Science, 334, 5217524.

Price,M.N. et al. (2010) FastTree Ziapproximately maximum—likelihood trees for
large alignments. PLoS One, 5, e9490.

Rannala,B. et al. (1998) Taxon sampling and the accuracy of large phylogenies.
Syst. Biol., 47, 7027710.

Salichos,L. and Rokas,A. (2013) Inferring ancient divergences requires genes with
strong phylogenetic signals. Nature, 497, 3277331.

Song,S. et al. (2012) Resolving conﬂict in eutherian mammal phylogeny using phy—
logenomics and the multispecies coalescent model. Proc. Natl. Acad. Sci. USA,
109, 14942714947.

Stamatakis,A. (2006) RAxML—NI—HPC: maximum likelihood—based phylogenetic
analyses with thousands of taxa and mixed models. Bioinformatics, 22,
268872690.

Steel,M. (2010) Consistency of Bayesian inference of resolved phylogenetic trees.
ArXiv, 1001.2864.

Than,C.V. and Rosenberg,N.A. (2011) Consistency properties of species tree infer—
ence by minimizing deep coalescences. J. Comp. Biol., 18, 1715.

Than,C.V. et al. (2008) PhyloNet: a software package for analyzing and reconstruct—
ing reticulate evolutionary relationships. BM C Bioinformatics, 9, 322.

Wakeley,J. (2009) Coalescent Theory. Roberts, Greenwood Village, Colorado.

Yang]. and Warnow,T. (2011) Fast and accurate methods for phylogenomic ana—
lyses. BMC Bioinﬁ)rmatics, 12(Suppl 9), S4.

Yu,Y. et al. (2011a) Algorithms for MDC—based multi—locus phylogeny inference.
Proc. RECOMB 2011, 5317545.

Yu,Y. et al. (2011b) Algorithms for MDC—based multi—locus phylogeny inference:
beyond rooted binary gene trees on single alleles. J. Comp. Biol., 18, 154371559.

 

2284

ﬁre'spzumofpmJXO'sopnuuowrorq/ﬁdnq

