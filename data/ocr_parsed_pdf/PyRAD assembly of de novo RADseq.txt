BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

an?kgowsmomammowoxmoa‘ocgawbmﬁ

 

D.A.R. Eaton

 

 

 

ABCDEFGHIJKLX

Fig. 2. Species tree on which RADseq data were simulated under a co-
alescent model. Divergence times are in coalescent units. Mutations rela-
tive to the outgroup X were sampled at different frequencies to simulate
deletions in three different datasets and also to simulate disruption of the
restriction recognition site in one dataset

2.3 Simulations

Sequence data were simulated on a species tree with 12 ingroup samples
and one outgroup sample (Fig. 2) under a coalescent model within the
Python package Egglib (Mita and Siol, 2012). Effective population size
(50 000) and per base mutation rate (7 >< 1079) were constant across taxa,
with the deepest divergence at 16 coalescent units. I simulated 10K loci
for each of the 12 ingroup taxa at 20>< coverage, with two alleles sampled
from one diploid sample at 10>< depth each. Reads were trimmed to
100 bp and a 6bp barcode and 5bp restriction recognition site were at-
tached. Indels were introduced by sampling SNPs in the 12 ingroup taxa
relative to the outgroup taxon at a probability of 0.0, 0.02 or 0.05, con-
verting the derived allele into a deletion. This yielded three datasets that I
refer to as the noIndel, lowIndel and highIndel datasets.

A larger dataset was also simulated on the same species tree to dem-
onstrate the efﬁciency of the hierarchical clustering approach. In this case,
500K loci were generated with no indels but allowing locus dropout
through mutations that arise in a restriction recognition site relative to
the outgroup. For this, I used a large region as the recognition site to
create significant amounts of missing data between samples as expected in
a deeply divergent phylogenetic dataset. This led to a dataset where each
individual sample contained only ~150K loci, but for which the total
dataset comprised 500 K loci potentially shared across samples. Thus, the
within-sample clustering step is relatively fast, whereas the across-sample
clustering is much more computationally intensive, and benefits from the
use of the hierarchical clustering. I refer to this as the noIndel-m dataset.

All simulated datasets were compared using PyRAD v.1.621 and
Stacks v.1.08. To the extent possible I used analagous parameters settings
for both programs. For example, the clustering threshold of 85% in
PyRAD is equivalent to 15 base differences in Stacks (parameters -m6,
-M13, -N15, -n15) given read lengths of 100 bp. A minimum stack depth
of six was used in all analyses. Paralog filtering was not implemented on
simulated data. The large noIndel-m dataset was run with the same par-
ameter settings, but was additionally run in PyRAD using a two-step
hierarchical clustering approach. This first clustered loci within each of
the three large four-taxon clades then exluded any loci not shared across
all four taxa within the clade, before subsequently clustering loci across
clades.

2.4 Empirical data

A published RADseq dataset from Eaton and Ree (2013) was down-
loaded from the NCBI sequence read archive (SRA072507). It includes
data from 13 closely related taxa in the flowering plant genus Pedicularis
sequenced with Illumina GAIIx, yielding 69 bp single end reads with
barcodes and restriction sites removed. In contrast to the small simulated
datasets that exhibit locus dropout due to bioinformatic errors alone, the

empirical data have missing sequences owing to additional factors such as
disruption to restriction sites and variation in sequencing coverage. It also
contains low quality base calls and paralogs that must be filtered, making
a comparison of PyRAD versus Stacks more difficult for this analysis.

To control for differences in how the two programs apply such filters,
initial quality filtering was implemented only in PyRAD, with the
resulting sequences analyzed by both programs. Stacks has fewer explicit
filters to detect paralogs, but the closest approximations were used, and I
report the results with and without paralog filters applied. The default
parameters in PyRAD (maxHaplos = 2, maxH = 3, maxSharedH = 3)
were closely matched by using the following parameters, or
manual edits, in Stacks, respectively: allowing only two haplotypes in a
locus (imax_locus_stacks=2), removing loci from the final catalog if
they contain more than four heterozygous sites and removing stacks
from the catalog if more than three samples are heterozygous for the
same site. A clustering threshold of 85% was implemented in PyRAD,
equivalent to 10 base differences in Stacks (parameters -m2, -M8, -N10,
-n10) given the read lengths.

Detailed parameter settings and scripts to reproduce all simulated and
empirical analyses are available as an IPython Notebook in the
Supplementary Materials. Statistics measuring the distribution of taxon
coverage across each assembled dataset were measured from the results of
each analysis found in either the ‘.haplotypes.tsv’ output of Stacks or in
the ‘.stats’ output of PyRAD. Run times were also compared, where each
analysis was run separately on a Linux machine with 24 3.47GHz Intel
Xeon processors, using 12 parallel processes in PyRAD or 12 threads in
Stacks.

3 RESULTS

3.1 Simulation results

For the three small simulated datasets both Stacks and PyRAD
retained all reads through the de—multiplexing and initial ﬁltering
steps. Similarly, within—sample clustering accurately recovered all
10K stacks for each taxon when either program analyzed the
noIndels dataset. In the lowIndels and highIndels datasets,
PyRAD performed nearly identically, recovering an average of
10000.0 and 10000.2 consensus sequences per sample, respect—
ively, whereas Stacks recovered an average of 10 027.4 and
10087.4 consensus sequences per sample, a result of splitting
loci that are polymorphic for one or more indels within a sample.

The effect of indels is more pronounced when clustering across
samples, where RAD sequences are more likely to exhibit indel
variation. PyRAD recovered 10 001, 10 003 and 10 086 loci in the
three datasets with increasing proportions of indels, while Stacks
recovered 10000, 12226 and 16285, respectively. Because only
10 000 loci were simulated, those recovered beyond this number
represent the splitting of loci caused by a failure to identify hom—
ology. Levels of sequence divergence are equal across the three
datasets because indels were introduced by replacing muta—
tionsimeaning their phylogenetic distribution is identical to
that of other mutationsithus, the different results represent
the effect of indel variation alone.

PyRAD identifies homology almost equally across the three
datasets (Fig. 3), whereas Stacks performs worse when the data
contain more indels, to the point of splitting nearly half the loci
in the highIndels dataset into multiple loci shared by fewer taxa.
This led to lower average taxon coverage per locus in the
assembled Stacks datasets, as well as fewer loci with full coverage
across all taxa (Table 1). In all three small simulated datasets the

 

1846

ﬁm'spzumol‘pmﬂo'sopeuuopuoiq/ﬁdnq

PyRAD

 

N0 indels

 

Low indels

High indels

 

 

15000
I
15000
I

10000
10000

Number of loci recovered
5000
I
5000
I

0
I
0
I

 

 

 

 

5000 10000 15000
I I

0
I

 

 

 

 

 

|||||| I
24681012 2

Minimum taxon coverage

Minimum taxon coverage

llll ||||||
681012 24681012

Minimum taxon coverage

Fig. 3. Comparison of PyRAD (black circles) versus Stacks (gray circles) in assembling simulated RADseq datasets that differ in their amount of indel
variation. The two programs perform identically in the absence of indels (no indels), but in the presence of indels (low indels and high indels), Stacks
splits loci with indel variation into multiple loci with lower taxon coverage. Meaning a greater number of loci are shared across fewer taxa. PyRAD, in
contrast, is little affected by indels and recovers higher taxon coverage across all indel-containing datasets

Table 1. Comparison of PyRAD and Stacks in assembling simulated and
empirical RADseq datasets of different sizes (Ntaxa & Nloci) and with
different proportions of indels

 

 

Data Ntaxa Nloci Software Avg.cov %Full.cov Time
noIndel 12 10K PyRAD 12.0 100.0 0.31
noIndel 12 10 K Stacks 12.0 100.0 0.62
lowIndel 12 10K PyRAD 12.0 100.0 0.34
lowIndel 12 10 K Stacks 9.8 81.5 0.65
highIndel 12 10 K PyRAD 11.9 99.1 0.32
highIndel 12 10 K Stacks 7.4 56.3 0.70
noIndel-m 12 500 K PyRAD 4.5 0.1 10.47
noIndel-m 12 500 K PyRAD* 2.9 0.1 2.95
noIndel-m 12 500 K Stacks 4.5 0.1 25.70
empirical 13 178 K PyRAD 3.0 1.4 36.42
empirical 13 207 K Stacks 2.7 0.9 79.25
empirical-p 13 181 K PyRAD 2.9 1.1 36.42
empirical-p 13 214K Stacks 2.4 0.5 79.25

 

Note: Performance is measured as the average number of samples recovered per
locus (Avg.cov) and percentage of Nloci with data recovered from all samples in
Ntaxa (%Full.cov). The noIndel—m and empirical datasets experience locus dropout
from mutations to restriction sites, and the latter also from variable quality and
sequencing coverage. Run times (hours) are compared for assemblies using 12 pro—
cessors. When hierarchical clustering was implemented in PyRAD (*) with a min—
imum coverage of four, it greatly reduced run times while still retaining all full
coverage loci. Empirical results are shown with paralog ﬁlters applied (—p) and
without. The number of recovered loci (Nloci) was used to calculate %Full.cov.

PyRAD analysis finished in approximately half the time of
Stacks.

3.1.1 Large hierarchical clustering results Both programs re—
covered similar results for the large noIndel—m dataset in terms
of average taxon coverage and number of loci shared across all
taxa (Table 1). Stacks took >25h to run, while PyRAD finished
in about half that time. Hierarchical clustering in PyRAD

improved speed significantly, reducing the run time to less than
3 h, but at the cost of reducing the average taxon coverage across
the dataset by one—third. However, it had no effect on the per—
centage of loci recovered across all taxa, as the data that were
excluded during hierarchical clustering represent loci shared by
few samples. For large datasets that include many sampled indi—
viduals and large numbers of loci, the dramatic reduction in run
times achieved through this approach will be useful.

3.2 Empirical results

When assembled by PyRAD the empirical dataset recovered
181289 loci of which 56.4% were singletons, but for which
>43K had taxon coverage of four or more, and 2465 were re—
covered across all taxa. In comparison, Stacks recovered 213 742
loci with a greater proportion of singletons (59.4%) and only
1940 loci shared across all taxa (Table 1). This difference is
more striking after applying paralog filters to both analyses,
wherein PyRAD recovers 1989 loci across all taxa but stacks
recovers only 1123. Overall, PyRAD recovered more loci at
high taxon coverage and fewer loci at low coverage than
Stacks (Fig. 4). In contrast to the simulated datasets, these results
show clearly that locus dropout is a true feature of empirical data
regardless of the bioinformatic method used. We should not
expect to recover 100% of data across samples, especially
when they are highly divergent, but to the extent homology is
present among sequences in the dataset, I show here that PyRAD
has greater ability to detect it.

In the minimally phylogenetic informative dataset (taxon
covarage greater than three) from the paralog filtered empirical
PyRAD output, 32% of loci contained at least one indel, and of
the loci with full taxon coverage, 15% contained indels.
Comparing these values to the frequency of indels in the small
simulated datasets, where 21 and 48% of loci contained indels
(for the lowIndels and highIndels datasets, respectively) shows
that the simulated values represent realistic proportions of indel

 

1847

/3.IO'S[BIIm0[p.IOJXO'SOIJBIIIJOJIIIOIq/ﬂdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

PyRAD

 

or concatenated loci. Because the software does not need to be
compiled, PyRAD is easy to install on any desktop or computing
cluster. It does not require large memory usage, and an analysis
can be easily split into multiple shorter—length jobs through its
step—wise execution.

ACKNOWLEDGEMENT

Many thanks to R. Ree, B. Rubin, A. Hipp, M. Escudero and K.
Ramanauskas for motivating the development of PyRAD, help—
ing to identify bugs and for their many suggestions. Thanks also
to R. Edgar whose software underlies much of this program and
to two anonymous reviewers for improvements to the
manuscript.

Funding: This research was supported by a National Science
Foundation Dissertation Improvement Grant (DEB—1110598).

Conﬂict of Interest: none declared.

REFERENCES

Baird,N. et ul (2008) Rapid SNP discovery and genetic mapping using sequenced
RAD markers. PLoS One, 3, e3376.

Bergey,C. et ul (2013) A new method for genome—wide marker development and
genotyping holds great promise for molecular primatology. Int. J. Primutol, 34,
3037314.

Cariou,M. et ul (2013) Is RAD—seq suitable for phylogenetic inference? An in .x'ilico
assessment and optimization. Ecol. Evol, 3, 8464552.

Catchen,J. et ul (2013) Stacks: an analysis tool set for population genomics. Mol
Ecol, 22, 31243140.

Catchen,J.M. et ul (2011) Stacks: building and genotyping loci de novo from short—
read sequences. G3, 1, 1717182.

Chong,Z. et ul (2012) Rainbow: an integrated tool for efﬁcient clustering and
assembling RAD—seq reads. Bioiiy’ormuticx, 28, 273272737.

Durand,E.Y. et ul (2011) Testing for ancient admixture between closely related
populations. Mol Biol. Evol, 28, 223972252.

Eaton,D.A.R. and Ree,R.H. (2013) Inferring phylogeny and introgression using
RADseq data: an example from flowering plants (Pedicularis:
Orobanchaceae). Syn. Biol, 62, 6897706.

Edgar,R.C. (2004) MUSCLE: multiple sequence alignment with high accuracy and
high throughput. Nucleic Acids Rec, 32, 179271797.

Edgar,R.C. (2010) Search and clustering orders of magnitude faster than BLAST.
Bioiry’ormaticx, 26, 246(F246l.

Etter,P. et ul (2011) Local ale novo assembly of RAD paired—end contigs using short
sequencing reads. PLoS One, 6, e18561.

Jones,J.C. et ul (2013) The evolutionary history of xiphophorus fish and their
sexually selected sword: a genome—wide approach using restriction site—asso—
ciated dna sequencing. Mol Ecol, 22, 298(r3001.

Keller,I. et ul (2013) Population genomic signatures of divergent adaptation, gene
flow and hybrid speciation in the rapid radiation of lake victoria cichlid ﬁshes.
Mol Ecol, 22, 284872863.

Levinson,G. and Gutman,G.A. (1987) Slipped—strand mispairing: a major mechan—
ism for DNA sequence evolution. Mol Biol. Evol, 4, 2037221.

Lexer,C. et ul (2013) Next generation biogeography: towards understanding the
drivers of species diversiﬁcation and persistence. J. Biogeogr., 40, 101371022.

Li,H. et ul (2008) Mapping short DNA sequencing reads and calling variants using
mapping quality scores. Genome Rec, 18, 185171858.

Lynch,M. (2008) Estimation of nucleotide diversity, disequilibrium coefﬁcients, and
mutation rates from high—coverage genome—sequencing projects. Mol Biol.
Evol, 25, 240972419.

Mita,S.D. and Siol,M. (2012) EggLib: processing, analysis and simulation tools for
population genetics and genomics. BMC Genet., 13, 27.

Mullaney,J.M. et ul (2010) Small insertions and deletions (INDELs) in human
genomes. Hum. Mol Genet., 19, R1317R136.

Nadeau,N.J. et ul (2013) Genome—wide patterns of divergence and gene flow across
a butterfly radiation. Mol Ecol, 22, 81¢826.

Narum,S.R. et ul (2013) Genotyping—by—sequencing in ecological and conservation
genomics. Mol Ecol, 22, 284172847.

Peterson,B.K. et ul (2012) Double digest RADseq: an inexpensive method for de
novo SNP discovery and genotyping in model and non—model species. PLoS
One, 7, e37l35.

Rubin,B.E.R. et ul (2012) Inferring phylogenies from RAD sequence data. PLoS
One, 7, e33394.

Stolting,K.N. et ul (2013) Genomic scan for single nucleotide polymorphisms re—
veals patterns of divergence and gene flow between ecologically divergent spe—
cies. Mol. Ecol, 22, 8427855.

The Heliconius Genome Consortium. (2012) Butterfly genome reveals promiscuous
exchange of mimicry adaptations among species. Nature, 487, 94ﬁ98.

Wagner,C.E. et ul (2013) Genome—wide RAD sequence data provide unprecedented
resolution of species boundaries and relationships in the lake victoria cichlid
adaptive radiation. Mol Ecol, 22, 7877798.

Wang,X.Q. et ul (2013) Identiﬁcation of SNP markers for inferring phylogeny in
temperate bamboos (Poaceae: Bambusoideae) using RAD sequencing. Mol
Ecol. Resoun, 13, 9387945.

 

ﬁre'spzumol‘pmﬂo'sopeuuowrorq/ﬁdnq

