APPLICATIONS NOTE

doi:10. 1093/bioinformatics/bts584

 

Systems biology

Advance Access publication October 7, 2012

MesoRD 1.0: Stochastic reaction-diffusion simulations

in the microscopic limit

David Fange, Anel Mahmutovic and Johan Elf*

Department of Cell & Molecular Biology, Science for Life Laboratory, Uppsala University, BMC Box 596,

SE-751 24 Uppsala, Sweden
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: MesoRD is a tool for simulating stochastic reaction-
diffusion systems as modeled by the reaction diffusion master equa-
tion. The simulated systems are defined in the Systems Biology
Markup Language with additions to define compartment geometries.
MesoRD 1.0 supports scale-dependent reaction rate constants and
reactions between reactants in neighbouring subvolumes. These new
features make it possible to construct physically consistent models of
diffusion-controlled reactions also at fine spatial discretization.
Availability: MesoRD is written in C++ and licensed under the GNU
general public license (GPL). MesoRD can be downloaded at http://
mesord.sourceforge.net. The MesoRD homepage, http://mesord.
sourceforge.net, contains detailed documentation and news about
recently implemented features.

Contact: johan.elf@icm.uu.se

Received on July 17, 2012; revised on August 14, 2012; accepted on
September 21, 2012

1 INTRODUCTION

Physical modelling is increasingly important to gain insights
about how biochemical processes work in living cells. Different
processes do, however, need to be modeled at different levels of
detail. It may, for example, be important to consider that chem-
ical reactions are stochastic, spatially dependent or both. The
combined spatial stochastic models are, for example, needed
when there are slow local ﬂuctuations that inﬂuences the rates
of chemical reactions in a non-linear way or when associationi
dissociation events are interrupted by additional reaction before
the reactants have reached uncorrelated positions (Mahmutovic
et al., submitted for publication). In these cases, it is desirable to
have a tool that can evolve a biochemical process at different
levels of detail in a physically consistent manner.

At the ﬁnest level of detail, stochastic reaction diffusion kin-
etics can be consistently modeled using the spatially and tempor-
ally continuous framework developed by Smoluchowski
(von Smoluchowski, 1917) for reactive spheres and later
extended to finite association rates (Collins and Kimball, 1949)
and dissociation (Berg, 1978). It is, however, often neither neces-
sary nor practical to model reactions at this level of detail.
By discretizing space into subvolumes and keeping track of the
number of molecules of each species in each subvolume and

 

*To whom correspondence should be addressed.

when they react, the process is described as a continuous-time
discrete-state Markov process. The master equation that governs
this process is known as the Reaction Diffusion Master Equation
(RDME) (Gardiner, 2004; Kampen, 2007). The RDME has
recently been shown to diverge and give unphysical solutions
at high spatial resolution (Erban and Chapman, 2009;
Isaacson, 2008). The divergence problem was solved by introdu-
cing scale-dependent bi-molecular reaction rate constants where
the new mesoscopic rate constants are calculated from the micro-
scopic framework (Fange et al., 2010).

Here we describe recent developments of MesoRD (Hattne
et al., 2005), a tool for stochastic reaction-diffusion simulations
or more speciﬁcally a tool for simulating trajectories correspond-
ing to the RDME. How different tools (Ander et al., 2004;
Boulianne et al., 2008; Drawert et al., 2012; Kerr et al., 2008;
Plimpton and Slepoy, 2005; Sanford et al., 2006; van Zen and ten
Wolde, 2005; Wils and De Schutter, 2009) for stochastic reaction
diffusion modeling compares with each other in terms of cap-
abilities has been discussed elsewhere (Burrage et al., 2011). The
main enhancement compared with previous MesoRD versions
and other RDME-based simulators is the use of scale-dependent
mesoscopic reaction rate constants (Fange et al., 2010), which
allows for microscopically consistent simulations at ﬁne spatial
discretization. Scale-dependent rate constants also make it pos-
sible to simulate RDME models on planar 2D surfaces (mem-
branes), where the problems of diffusion-controlled reactions are
much more severe than in 3D because reactants do not lose
spatial correlations even at large distances (Berg, 1978). Since
our previous applications note (Hattne et al., 2005) we have
also added functionalities for deﬁning cellular compartment geo-
metries using triangle meshes in addition to the previously avail-
able method based on constructive solid geometries (CSG) and
also included the possibility of running mean-field simulations
within MesoRD.

2 IMPLEMENTATION

The core features of MesoRD are described in Hattne et a].
(2005). In essence, MesoRD implements the Next Subvolume
Method (Elf and Ehrenberg, 2004), an efﬁcient algorithm for
simulating the RDME. MesoRD reads model deﬁnitions in
the Systems Biology Markup Language (SBML) (Finney
and Hucka, 2003), which has earlier been extended to adhere
to the MesoRD-speciﬁc requirement of spatial geometries
(Hattne et al., 2005) and is now also extended to the requirement
of microscopic parameters.

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 3155

Vol. 28 no. 23 2012, pages 3155-315 7

112 /310's112u1n0fp10}x0"sotwurJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og anﬁnV uo ::

D.Fange et al.

 

 

   
 

     

 

 

 

 

A100
-_—‘l“‘n‘df|-"‘—‘K"‘F.
n»
so "
:2 I, "1"“"""‘“‘~-,--—""‘-
E .‘:’...-«‘-~-—~' "-.—.-““-.
260 ,-.
ill
01 scale indep. scale dcp. subvolume
g 40 rate const. rate const size
é "" [zopr
"" — impi'
20 ---- — 159]
0 20 40 60 30 100
Time

 

 

DEnP nmmne

 

 

Fig. 1. (A) MesoRD simulations of the MichaelisiMenten reaction scheme with diffusion-controlled association of substrate and enzyme. At spatially
ﬁne-grained simulations, using small subvolumes, simulations without scale-dependent reaction rate constants diverge. This is primarily due to the fact
that the diffusion part of the rate constant is modeled explicitly and should not be accounted for also in the rate constant. (Fange et al., 2010).
(B) Comparison of stochastic and mean-field MesoRD simulations of the Min-system. When there is a high local reactant density, the single RDME
trajectory is expected to show high resemblance to the corresponding mean-ﬁeld PDE. The PDE can be simulated in MesoRD using the same input file

as for the stochastic simulation

To use scale-dependent reaction rates, the user must supply
microscopic parameters, i.e. a reaction radii and a microscopic
association rate constant (Berg, 1978; van Zen and ten Wolde,
2005). These are readily added as an annotation to the
bi-molecular association reaction in the SBML ﬁle. MesoRD
automatically scales the association and dissociation rates
according to the subvolume size, as described in (Fange et al.,
2010). As the actual position of a molecule is not known
with better accuracy than half the spatial resolution (Shannon,
1948), there is also a signiﬁcant probability that bi-molecular
reactions occur over subvolume boundaries. As described in
Fange et a]. (2010), this is accounted for in MesoRD by allowing
for bi-molecular reactions also between reactants in neighbour-
ing subvolumes.

In addition to the previously available CSG primitives used to
construct compartment geometries, we have also included two
2D objects, rectangles and circles. These can be transformed
and combined by operations already supported by MesoRD,
such as rotations and unions. When using 2D geometries
microscopic parameters should always be used, as association
and dissociation rates will be scale dependent at all
discretizations.

MesoRD can also run simulations of 3D mean-ﬁeld models
using the same SBML input ﬁle of the corresponding stochastic
model. In the mean-field description, the average change per
subvolume, as deﬁned by RDME, is applied in each time-step.
This is equivalent to a numerical solution of the corresponding
partial differential equation (PDE) using a ﬁnite difference
scheme based on a 7-point stencil (Fange and Elf, 2006).

3 EXAMPLES

3.1 Michaelis-Menten reaction

The RDME divergence problem at fine spatial dicretisation is
illustrated using a MichaelisiMenten reaction scheme kept out of
equilibrium by constantly supplying substrates and removing
products. In Figure 1A, we show the misleading results one
would get without using the microscopic corrections now imple-
mented in MesoRD.

3.2 The Min system

Spatio-temporal oscillations of the MinCDE proteins are essen-
tial for localizing the E. coli cell-division apparatus at mid-cell. In
Figure 1B, we show that the Min-model in Fange and Elf (2006)
exhibits stable spatio-temporal oscillations also with a micro-
scopically consistent treatment of the strongly diffusion-
controlled binding of MinE to MinD. Furthermore, we also
use MesoRD to compare the stochastic simulation results to
the corresponding mean-field description.

4 CONCLUSIONS

The new capabilities in MesoRD 1.0, including the possibility to
handle diffusion-controlled reactions, 2D geometries and mean-
field (PDE) simulations, make it possible to make stochastic
simulations at high spatial resolution, which can be directly com-
pared with the corresponding mean-field description. This makes
MesoRD not only a readily available and user friendly, but also

 

3156

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Idllq 11101} papeolumoq

9103 ‘Og isnﬁnV uo ::

MesoRD 1.0

 

a versatile and physically consistent, tool for stochastic and
mean-ﬁeld simulations of reaction-diffusion processes.

ACKNOWLEDGEMENTS

We thank Johan Hattne for his work on earlier versions of
MesoRD.

Funding: This work was supported by the European Research
Council (ERC no. 203083), the Swedish Foundation for Strategic
Research, the Swedish Research Council (V R), Goran
Gustafsson Stiftelse and the Knut and Alice Wallenberg
Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Ander,M. et al. (2004) SmartCell, a framework to simulate cellular processes that
combines stochasticapproximation with diffusion and localisation: analysis of
simple networks. Syst. Biol., 1, 1297138.

Berg,O.G. (1978) Model for statistical ﬂuctuations of protein numbers in a micro—
bial population. J. Theor. Biol., 71, 5877603.

Boulianne,L. et al. (2008) GridCell: a stochastic particle—based biological system
simulator. BMC Syst Biol., 2, 66.

Burrage,K. et al. (2011) Stochastic simulation for spatial modelling of dynamic
processes in a living cell. In Koeppl,H. et al. (ed.) Design and Analysis of
Biomolecular Circuits: Engineering: Approaches [0 Systems and Synthetic
Biology. Springer, New York.

Collins,F.C. and Kimball,G.E. (1949) Diffusion—controlled reaction rates. J. Coll.
Sci., 4, 4257437.

Drawert,B. et al. (2012) URDME: a modular framework for stochastic simulation
of reaction—transport processes in complex geometries. BMC Syst Biol., 6, 76.

Elf,J. and Ehrenberg,M. (2004) Spontaneous separation of bi—stable biochemical
systems into spatial domains of opposite phases. Syst Biol., 1, 2307236.

Erban,R. and Chapman,S.J. (2009) Stochastic modelling of reaction—diffusion pro—
cesses: algorithms for bimolecular reactions. Phys. Biol., 6.

Fange,D. et al. (2010) Stochastic reaction—diffusion kinetics in the microscopic limit.
Proc. Natl Acad. Sci. USA, 107, 1982(P19825.

Fange,D. and Elf,J. (2006) Noise—induced Min phenotypes in E coli. Plos. Comput.
Biol., 2, 637$48.

Finney,A. and Hucka,M. (2003) Systems biology markup language: level 2 and
beyond. Biochem. Soc. T, 31, 147271473.

Gardiner,C.W. (2004) Handbook of Stochastic Methods for Physics, Chemistry, and
the Natural Sciences. Springer series in synergetics. Springer, Berlin/New York.

Hattne,J. et al. (2005) Stochastic reaction-diffusion simulation with MesoRD.
Bioinformatics, 21, 292372924.

Isaacson,S.A. (2008) Relationship between the reaction—diffusion master equation
and particle tracking models. J. Phys. A, 41, 065003.

Kampen,N.G.V. (2007) Stochastic Processes in Physics and Chemistry.
North—Holland personal library, Elsevier, Amsterdam/Boston.

Kerr,R.A. et al. (2008) Fast Monte Carlo simulation methods for biological
reaction—diffusion systems in solution and on surfaces. SIAM J. Sci. Comput,
30, 3126.

Plimpton,S.J. and Slepoy,A. (2005) Microbial cell modeling via reacting diffusive
particles. J. Phys. Conf. Ser., 16, 3057309.

Sanford,C. et al. (2006) Cell—inlisimulating biochemical pathways. Bioinformatics,
22, 291&2925.

Shannon,C.E. (1948) A mathematical theory of communication. At&T Tech, J, 27,
3794123.

van Zon,J.S. and ten Wolde,P.R. (2005) Green’s—function reaction dynamics: a
particle—based approach for simulating biochemical networks in time and
space. J. Chem. Phys., 123.

von Smoluchowski,M. (1917) Versuch einer mathematischen Theorie der
Koagulationskinetik kolloider Losungen. Z. Phys. Chem., 92, 1297168.

Wils,S. and De Schutter,E. (2009) STEPS: modeling and simulating complex
reaction—diffusion systems with python. Front. Neuroinform., 3, 15.

 

3157

112 /310'S[Buln0lpJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 popeo1umoq

9103 ‘0g1sn8nv uo ::

