Vol. 30 ECCB 2014, pages i617-i623
doi:1 0. 1093/bioinfonnatics/btu4 74

 

Fast randomization of large genomic datasets while preserving

alteration counts

Andrea Gobbi”, Francesco Iori02'3'1'*, Kevin J. Dawson's, David C. Wedges,
David Tamborero“, Ludmil B. Alexandrove, Nuria Lopez-Bigas4, Mathew J. Garnetts,

Giuseppe Jurman‘ and Julio Baez-Rodriguez2

1Fondazione Bruno Kessler, I-38100 Povo (Trento), Italy, 2European Molecular Biology Laboratory, European
Bioinformatics Institute, Cambridge CB10 18D, UK, 3Wellcome Trust Sanger Institute, Cambridge CB10 18D, UK and

4Universitat Pompeu Fabra, Barcelona 08003, Spain

 

ABSTRACT

Motivation: Studying combinatorial patterns in cancer genomic data-
sets has recently emerged as a tool for identifying novel cancer driver
networks. Approaches have been devised to quantify, for example, the
tendency of a set of genes to be mutated in a ‘mutually exclusive’
manner. The significance of the proposed metrics is usually evaluated
by computing P-values under appropriate null models. To this end, a
Monte Carlo method (the switching-algorithm) is used to sample simu-
lated datasets under a null model that preserves patient- and gene-
wise mutation rates. In this method, a genomic dataset is represented
as a bipartite network, to which Markov chain updates (switching-
steps) are applied. These steps modify the network topology, and a
minimal number of them must be executed to draw simulated datasets
independently under the null model. This number has previously been
deducted empirically to be a linear function of the total number of
variants, making this process computationally expensive.

Results: We present a novel approximate lower bound for the number
of switching-steps, derived analytically. Additionally, we have de-
veloped the R package BiRewire, including new efficient implementa-
tions of the switching-algorithm. We illustrate the performances of
BiRewire by applying it to large real cancer genomics datasets.
We report vast reductions in time requirement, with respect to existing
implementations/bounds and equivalent P-value computations. Thus,
we propose BiRewire to study statistical properties in genomic data-
sets, and other data that can be modeled as bipartite networks.
Availability and implementation: BiRewire is available on
BioConductor at http://www.bioconductor.org/packages/2.13/bioc/
htmI/BiRewire.htm|

Contact: iorio@ebi.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

In the past few years, next-generation sequencing (NGS) tech-
nologies have progressed swiftly, and currently hundreds of gen-
omes can be simultaneously sequenced in a matter of weeks, at
more affordable costs. This opens a wide range of new avenues in
biological and biomedical research. In particular, because of the
established impact of the genomic background on disease

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

progression and response to drug treatment, cancer research
has significantly beneﬁted from these advances. Comprehensive
catalogues of mutations in multiple cancer types have been
assembled and fruitfully used to identify new diagnostic, prog-
nostic and therapeutic targets (Barretina et al., 2012; Garnett
et al., 2012; ICGC et al., 2010; TCGA et al., 2008). Existing
large-scale projects, such as the Cancer Genome Atlas (TCGA;
TCGA et al., 2008), the International Cancer Genome
Consortium data portal (ICGC et al., 2010) and, recently, the
Genomics of Drug Sensitivity in Cancer (Garnett et al., 2012)
and the Cancer Cell Line Encyclopedia (Barretina et al., 2012),
provide invaluable opportunities to explore molecular alterations
that could potentially play a crucial role in a plethora of different
cancer types and their response to therapy (Stratton et al., 2009).

A key task in these projects is to distinguish between driver
mutations (i.e. those conferring selective clonal growth advan-
tage) and functionally neutral passenger mutations (which do
not contribute to tumour development) (Bignell et al., 2010;
Greenman et al., 2007). Once key driver mutated genes are iden-
tiﬁed, a fruitful analysis is to consider them in the context of the
pathways where they operate. This allows the identification of
cancer driver biological networks, whose altered functionality
results in the acquisition of a cancer hallmark (Hanahan and
Weinberg, 2011; Vogelstein et al., 2013). One of the ideas ex-
ploited to identify these networks is based on the assumption
that sets of mutations exhibiting statistically signiﬁcant levels
of mutual exclusivity (ME) are likely to alter genes involved in
a common biological process that drives cancer development. It
has been noted that driver mutations in cancer occur in a limited
number of pathways and driver lesions in the same pathway do
not tend to occur in the same patient Weang et al., 2008).
A possible biological explanation is that if a crucial node is
altered in an oncogenic pathway, a secondary mutation on the
same pathway is unlikely to provide further selective advantage
to the cancer cell, thus it does not tend to be selected during
somatic evolution. Hence, sets of mutations exhibiting statistic-
ally signiﬁcant levels of ME are likely to alter genes involved in a
common biological process that drives cancer development. On
the other hand, mutations of genes participating in different bio-
logical pathways may exert a synergistic effect in conferring
growth advantages to tumour cells. Therefore, investigations
have been devoted to searching for groups of genes that are
simultaneously mutated more often than expected by random
chance (Thomas et al., 2007; Uren et al., 2008).

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/Iicenses/by—nc/3.0/), which permits
non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re—use, please contact journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq won papaolumoq

9103 ‘Og isanV uo ::

A.Gobbi et al.

 

Based on these premises, the emergence of combinatorial
properties among patterns of genomic events has been investi-
gated in a number of recent studies, through the application of
novel statistical measures quantifying, for example, the ‘mutual
exclusivity’ or the ‘co-occurrence’ of different genomic lesions
(Ciriello et al., 2012; Cui, 2010; Gu et al., 2010; Miller et al.,
2011; Vandin et al., 2012; Yeang et al., 2008). Among these
studies, those aimed at identifying groups of genes whose muta-
tion patterns tend to ME are based on the same principle and are
conceptually similar (Ciriello et al., 2012; Miller et al., 2011;
Vandin et al., 2012), although they differ in two crucial meth-
odological aspects:

(i) The way sets of genes to be tested for ME are selected.
(ii) The way ME of a gene set is assessed and its statistical
signiﬁcance is quantiﬁed.

In (Ciriello et al., 2012), for example, the authors designed
MEMo, a computational framework in which gene sets to be
tested for ME are derived from cliques (i.e. groups of genes
with complete pair-wise connectivity) identiﬁed in functional net-
works, assembled from publicly available signalling and pathway
maps. For the statistical assessment of ME, a variety of strategies
have been followed. Vandin et a]. (2012) perform a signiﬁcance
test simulating a null model by independently permuting the mu-
tations of each gene across patients, thus preserving the mutation
frequency gene-wise (but not sample-wise). In (Miller et al.,
2011), authors make use of tools from coding theory, and the
ME significance for a set of genes is computed algorithmically. In
contrast to these two methods, MEMo quantiﬁes the sample
coverage (SC) of a set of genes in terms of the number of samples
in which at least one of them is mutated. Then the ME of the
gene set under consideration is computed as the divergence of its
SC from expectation. To evaluate the statistical significance of
this ME measure, P-values are computed under an appropriate
null model. This can be achieved by randomly permuting the
analysed dataset, while preserving the overall distribution of
observed alterations across both genes and samples. This is cru-
cial to preserve tumour speciﬁc alterations, heterogeneity in mu-
tation/copy-number alteration rates across patients and to let the
SC signiﬁcance be proportional to the gene set ME. To generate
this null model, the authors make use of a permutation strategy
based on a random network generation model referred to as the
switching-algorithm (Milo et al., 2003). First the relevant infor-
mation in the data is represented as a binary event matrix (BEM)
(Fig. 1A): a ‘(kl table’ in which the generic entry Wow is equal to
1 if in the i—th sample, the j—th gene is altered (by a non-synonym-
ous somatic mutation, a homozygous deletion or an ampliﬁca-
tion), and is equal to 0 otherwise.

The uniform distribution on the set of (L1 tables with ﬁxed
marginal totals (i.e. with prescribed row-wise and column-wise
sums) is used as a null model in various contexts (Besag and
Clifford, 1989; Ponocny, 2001; Rasch, 1993). In ecological re-
search (Pl tables, called ‘presenceiabsence’ matrices (PAMs)
(Miklés and Podani, 2004) are randomized to evaluate the devi-
ation of observed phenomena, such as the co-occurrence of dif-
ferent species in the same habitat, from random expectations
(Connor and Simberloff, 1979; Gotelli, 2000; Wilson, 1987).
Several algorithms exist to generate constrained and non-

(A) as incidence matrix {5)

 

E Genomic binary-event matrix I - Bipartite Network

     
  

 

 

 

 

 

D wild-type I altered

sam ple?

I
i h 63 b k i _________ sample1
 Egggg f? igene1 .:;:_:__ Hzgmmez
 germ igeneﬁ ' H-Hpsamplea

   
I 981194 I gene40// ﬁ'osamplea
i genes i , fr"! beampleﬁ

 gene5gi_-______

$—Irepeat
   

f

 

 

edge rewiring

I random edge selection

   

if (ad) and (0.1)) do not exist

they are added to the network
and (a,b) and (ed) removed

take incidence matrix

(Ell""""""'ﬁ§ﬁ&3h}i§é&' 
i Genomic binary-event matrix
i gwteee

.9

0)ch?

 

 

    
    
    
   

3
..,
an:
est?
00‘?”

89m

: gene1
gene2
gene3
gened
; gene5

D wild-type I altered

 

 

Fig. 1. BEM randomization through the switching-algorithm. A bipartite
graph (B) is derived from the initial BEM by considering it as a graph
incidence matrix (A). A sequence of switching-steps (C and D) is per-
formed. In each of these steps, two edges (a,b) and (c,d) are randomly
chosen (C) and, if the edges (a,d) and (c,b) do not exist yet, they are added
to the network, while (a,b) and (c,d) removed (D). A rewired version of
the BEM is derived by considering the incidence matrix of the resulting
network after a sufﬁciently long sequence of switching-steps (E)

constrained null models depending on which basic features of
the PAM are retained in the computations (Gotelli, 2000;
Gotelli and Entsminger, 2001). Nevertheless, the randomization
of moderately large matrices in a short space of time is still
challenging.

Ciriello et a]. took advantage of tools from graph theory by
considering a BEM as the incidence matrix of a bipartite graph
(Gross and Yellen, 2006) (Fig. 1B). Then, they adapted the
switching-algorithm for network randomization with node
degree preservation to the problem of randomizing a BEM

 

i618

112 /310'S[BHJDOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq wort papeolumoq

9103 ‘Og isanV uo ::

Genomic data randomization presen/ing alteration counts

 

while preserving its row- and column-wise sums (Milo et al.,
2003). If a BEM derived from a genomic dataset is considered
as the incidence matrix of a bipartite network G, then nodes in
the first set of G correspond to genes, and those in the second set
correspond to samples. Additionally, a node i in the first set is
connected to a node j in the second set if the gene mapped by node
i is altered in the sample mapped by node j (Fig. 1A and B).
Deﬁning the degree of a node as the number of its incident
links, row-wise sums of the BEM will correspond to degrees of
the nodes in the ﬁrst set, whereas column-wise sums of the BEM
will correspond to degrees of the nodes in the second set. The
problem of randomizing a BEM while preserving its row- and
column-wise sums can then be reduced to the problem of shufﬂing
the links in the corresponding network G while preserving its node
degrees, or ‘network rewiring’, with the additional constraint that
the shufﬂing should preserve bipartiteness (i.e. nodes in the
same subset should never be connected). Based on these premises,
in MEMo (Ciriello et al., 2012), randomized versions of a BEM
are generated by adapting the switching-algorithm to bipartite
networks. This method proceeds through a series of Monte
Carlo switching-steps to produce rewired networks, starting
from the original one, and preserving its degree distribution, as
summarized in Figure 1. For the Markov chain underlying this
algorithm to ‘forget’ the initial network (thus to minimize the
initial bias), a sufﬁciently large number of switching-steps
should be performed.

The presence of trends in the time series of network metrics
along the sample path of a Markov chain simulation is evidence
that the chain has not yet reached its stationary distribution (Ray
et al., 2012) (the required uniform distribution). If the Markov
chain has a slow mixing time (Stanton and Pinar, 2012), then the
number of iterations required to reach (approximate) stationarity
(the so-called burn-in time) may be very long. In (Milo et al.,
2003), the authors propose on empirical grounds that 100 times
the number of existing links (|E|) is an adequate burn-in time,
and this lower bound is generally used. In what follows, we will
refer to this bound as the ‘empirical bound’ (N’). The desired
number of random networks needed to compute empirical P-
values should then be multiplied by this number to obtain an
estimation of the total time requirements. When dealing with a
large number of tests (as are often required in the identification
of cancer network drivers, where the number of gene sets to test
is potentially very large), to achieve signiﬁcance after multiple
hypothesis test correction, the number of random networks to be
generated (hence of switching-algorithm runs) could be in the
order of hundreds of thousands. Consequently, the amount of
time required to accomplish this task could be very high. This
would make routine analyses practical only on server clusters.
Here we propose a novel, analytically derived, approximate
lower bound to the number of switching-steps required by the
switching-algorithm to generate randomized versions of a BEM,
preserving genomic event distributions both across samples and
genes. Finally, we have implemented BiRewire, an R package
(Ihaka and Gentleman, 1996) allowing users

(i) to study and visualize trends in metrics over different num-
bers of switching-steps for a given BEM;

(ii) to determine the minimum number of switching-steps
required to reach the approximate stationary distribution

(here the uniform distribution on the set of allowed
BEMs);

(iii) to generate randomized BEMs using the switching-
algorithm with the number of switching-steps set to
either this lower bound or a user-deﬁned one.

We illustrate the application of BiRewire with examples where
the BEMs are derived from real datasets from the TCGA
(TCGA et al., 2008) and other studies, after the applications of
state-of—the—art ﬁlters for the identiﬁcation of somatic mutations
affecting protein function and cancer-speciﬁc driver genes.
Finally, we compare the obtained execution times and P-value
computations with those obtained with different implementa-
tions of the switching-algorithm and different bounds.

2 METHODS

We analytically derived an approximate lower bound for the number of
switching-steps to be performed by the switching-algorithm, when applied
to a bipartite network G = (V, E) (where V is the set of vertices and E the
set of links, with V: {V,, VL.}). This bound is equal to

N: IEI
2(1—d)

where d is the edge density of the original network, deﬁned as the ratio
between |E| and the number of edges of a fully connected bipartite graph
with the same number of nodes in the two classes: d= |E|/(|V,| x |VL.|).
With respect to the empirical bound proposed in (Milo et al., 2003) (i.e.
N’ = 100|E|), our bound can be expressed as

= L In (1—_dW
200(1 — d) 100

 

ln (1 — d)|E| (1)

N (2)
at least for bipartite graphs.

In what follows, we will denote with Go‘) a rewired version of the bi-
partite network G obtained with the switching-algorithm through k switch-
ing-steps. We assume intuitively that GU‘) is a rewired version of G if

(1) The average similarity between G and its rewired version GU‘) tends
to remain constant when k is further increased (i.e. performing
additional switching-steps does not make GU‘) more different
from G, on average);

(2) The average similarity between G and Go‘) is sufﬁciently close
to the expected similarity between any pair of random bipartite
networks with the same size, edge density and node degrees of G
(i.e. between any pair of rewired versions of G).

The ﬁrst condition above is often used when monitoring convergence
of the sampler, where trends within chains are studied to quantify the
‘forgetting’ of the initial state (Brooks and Gelman, 1998). Taken to-
gether, the two conditions are necessary and sufﬁcient to claim that
after k switching-steps the initialization bias of the underlying Markov
chain reaches a minimum. When they are veriﬁed, performing additional
switching-steps does not make GU‘) any more different from G, on aver-
age. The second property guarantees that G and GU‘) are indistinguishable
from any pair of networks sampled independently from the null distribu-
tion. As a consequence, Ga‘) can be considered as an approximate obser-
vation drawn from the uniform distribution of all the possible bipartite
networks with the same number of nodes, links and degrees as G. By
running the switching-algorithm on bipartite networks of different sizes
and edge densities, we ﬁrst veriﬁed that after a speciﬁed number k of
switching-steps, which is much lower than N’, Conditions 1 and 2 are
met. Then, we went on to empirically verify that the fulﬁlment of our
convergence criteria provides a good estimation of the autocorrelation

 

i619

112 /310'S[BHJDOIPJOJXO"SOIJBHIJOJIIIOICI/ﬂdnq moi; pap1201umoq

9103 ‘0g isnﬁnv uo ::

A.Gobbi et al.

 

time (Stanton and Pinar, 2012): a standard tool for estimating the con-
vergence of a Markov chain to its stationary distribution (Sokal, 1989).
Finally, we present a novel approximate lower bound N (which was
derived analytically) for the number of switching-steps k at which our
two conditions hold. We show that after N switching steps the distribution
of the Jaccard index (.11; a measure of similarity) between Go‘) and G
reaches the same steady state as is reached at N’, at least on the tested
networks. These networks were chosen to have topological features
make their incidence matrix comparable with a BEM derived from a typ-
ical large-scale NGS dataset. These results were obtained using an efﬁcient
implementation of the switching-algorithm, detailed in the Supplementary
Materials, and the R package [graph (Csardi and Nepusz, 2006).

3 RESULTS

3.1 Randomness convergence across switching step

Based on the same premises of the output-based method pro-
posed in (Johnson, 1996), to show that after a speciﬁed number
of k switching-steps the average similarity between G and G0“)
converges (i.e. it tends to remain constant even if applying add-
itional switching-steps), we generated several random bipartite
networks containing a total number of 116 x n,.=20, 000 nodes
(with 116 = | Vcl and 11,. = | V,.|), a ﬁxed edge density equal to 15%
(3000 edges) and different levels of squareness (i.e. nc/nr ratio).
By adopting an experimental setting similar to that described in
(Stanton and Pinar, 2012), for a given level of squareness, each of
the corresponding networks G was then given as input to 50
different instances of the switching-algorithm, each performing
N’ = 100 x 3000= 3 x 105 switching-steps. The output of each of
these instances was then sampled every 100 switching-steps and
collected, at the j—th sample time, into a set of rewired networks
Rj={G(1°°/)J} with i=1, ... ,50 and j=1, ...,100. Finally, at
each sample time j, the average similarity between each rewired
network in R] and the original network was computed (to verify
Condition 1), as well as the average pair-wise similarity between
each pair of networks in R] (to verify Condition 2). To quantify
the extent of similarity between two networks, the J accard Index
(JI) (Jaccard, 1901) between their incidence matrices was com-
puted. If we denote with B the incidence matrix of the network G
and with 3" the incidence matrix of its rewired version G0“), then
it can be easily verified that the JI between G and G0“) is equal to

x<k>

JI(G, GOO) = —2l El _ x“, (3)

where |E| is the number of links contained in G (equal to that of
G“) and xa‘) =21. JB, JBffj, is the bitwise sum of the Hadamard
product between the two matrices (i.e. the number of ones in
common between them, hence the number of common links
across the two networks). Results of this simulation are depicted
in Supplementary Figure SlA. After an adequate number of
switching-steps (which is much lower than N), both the average
similarity between the rewired networks and the initial networks
(indicated by the blue curves) and the average pair-wise similarity
computed between each pair of rewired networks (red curves)
plateau at the same level (consistently with Conditions 1 and 2).
These results suggest that the true lower bound for the number of
switching-steps required by the switching-algorithm to rewire bi-
partite networks, providing them with the maximal level of ran-
domness, is much lower than N’. For reference, we include in
Supplementary Figure SlA the expected similarity between any

pair of random bipartite networks with the same number of nodes
and edges of G (green line in Supplementary Fig. SlA) but with
possibly different node degrees, derived as detailed in the
Supplementary Materials. This gives an indication of how much
the distribution of networks under the null model differs from the
distribution under the alternative model in which node degrees are
not preserved. Results from a similar simulation but starting from
bipartite networks containing | V,.| = 100 and | Vcl = 200 nodes and
different levels of edge densities are shown in Supplementary Fig.
SlB. Also in this case, after an adequate number of switching-
steps (which is again much lower than N’), the average similarity
between the rewired networks and the initial ones (indicated by
the blue curves) reaches a plateau level that is equal to the one
reached by the average pair-wise similarity computed between
pairs of rewired networks (consistently with Conditions 1 and
2). A ﬁnal empirical study showing that the fulﬁlment of our con-
vergence criteria provides a good estimation of the autocorrel—
ation time (Stanton and Pinar, 2012), hence of the mixing of the
underlying Markov chain, is detailed in the Supplementary
Materials and Supplementary Figure S2.

3.2 A novel lower bound to the number of switching-steps
required to rewire bipartite networks

In this section, we summarize the derivation of a lower bound N to
the number of switching-steps that the switching-algorithm should
perform to rewire a bipartite network, as a function of its number of
nodes and edges. The starting point of our proof is the deﬁnition of
similarity between a bipartite network G and its rewired version GU“)
(deﬁned in the previous section) based on the JI:

(k)
x
Sac) =

2|E| — N) (4)

In the ﬁrst part of our proof (provided as Supplementary Material),
we formulate the mean-ﬁeld equation (Barabasi et al., 1999) for
x0“r 1) (see Lemma 1 of the proof) and consequently for Equation
(4). Then from this mean-ﬁeld equation, we derive a ﬁxed point X
and a convergence time N, in terms of the number of switching-
steps k (Lemma 2). Finally, we show that the switching-algorithm
can be used to approximate null models for G through a minimum
number of N switching-steps (Lemma 3). The mean-ﬁeld equation
for x0“r 1) is equal to

5
x<k+1>=zp§k>fi<x<kb (5)

i=1

where the functions f(x(k)) represent ﬁve possible values of x0“r 1)
given xa‘), depending on the switching step performing successfully
or not, and pgk) are the probabilities associated with these values
(see Propositions 1, 2, 3 in the proof). Specifying these probabilities
allow the mean-ﬁeld Equation (5) to be written as a second-order
linear recursive sequence x0“r 1) = (|E| -I- 1)x(k) — |E|x(k’l) for
which a closed form is provided in (Brousseau, 1971). This yields

X(k)=mk(lEl _ 1  + 1 gm (6)
(t|E| —2t-I-2|E|)

, and
|E|t

where m and q can be expressed as m=

 

i620

112 /310'S[BHJDOIPJOJXO"SOIJBHIJOJIIIOICI/ﬂdnq moi; pap1201umoq

9103 ‘0g isnﬁnv uo ::

Genomic data randomization presen/ing alteration counts

 

_ (MEI — 2IEIZ)
(I — t—z
edges preserving bipartiteness.

For a fixed 8, where 0<s 5 1, we estimate N as the minimum
value such that

, with t=|V,.| x |Vc| the number of possible

|x(N) —Y|<s <—> N>1og mg(z,s) (7)
8t
t|E| — IEIZ’
in Equation (6).

As shown in our proof (Proposition 4), for the purpose of
ﬁnding a lower bound N (rather than the exact value of required
switching-steps), we can take X = |E|2/t as the unique ﬁxed point
of 6, (Proposition 5 in the proof).

Fixing s= 1, from the asymptotical equivalence ln (1 +x) ~
In x and Lemma 2 of the proof it follows that

N: |E|
2(1—d)

where |E| and d are deﬁned as in the previous sections.

With a similar procedure, a mean-ﬁeld equation can also be
estimated for the similarity between any pair of networks Ba“)
and Ca“) derived from the original network G through two dif-
ferent instances of the switching-algorithm, performing k switch-
ing-steps (Lemma 3 of the proof). Brieﬂy, we derived a recursive
sequence for ra‘) =s(B(k), C(19). As shown in the proof
(Proposition 6, 7) and similarly to Equation (6), this sequence
can be expressed as a second-order linear sequence:

(k): k _ q + q
r m(lEl 1—m) l—m (8)

with g(z, s) = and X is the fixed point of the recursion

ln (1 —d)|E|

(|E| — 4)t2 — (|E|2 — 8IEI)t — 4|E|2 a
|E|t2 — |E|2t
. Comparing the two mean-field

nd

 

but with parameters m =

(|E|t2 — 2t|E|2 + |E|3)
Wﬂ—ﬁ

Equations (6) and (8), it follows that rd“) 5 x(k). This implies

q=—4

that the average similarity between any two rewired versions of a
network G cannot be greater than the similarity between G and
each of the two individual rewired versions. As a conclusion, our
proof shows that our novel bound guarantees a maximal level of
edge mixing, and that the similarity between any pair of rewired
versions of a given network can not be greater than those between
them and the original one.

Finally, we conducted an empirical study to show that after N
switching steps, the initial bias of the Markov chain underlying
the switching-algorithm, quantiﬁed by the residual similarity to
the original network (i.e. x(k)), is minimized at least as much as it
is minimized after N = 100|E| switching steps [i.e. the empirical
bound proposed in aVIilo et al., 2003)]—details are provided in
the Supplementary Materials and Supplementary Figures S3 and
S4. Taken together with our formal proof, and empirical
study of equivalence between our convergence criteria and the
auto-correlation time estimation criteria (detailed in the
Supplementary Materials and Supplementary Fig. S2), these re-
sults suggest that N can be considered as a good ‘burn-in time’
(in terms of switching-steps) for the Markov chain underlying the
switching-algorithm. As a consequence, N switching-steps are

enough to simulate samples from the uniform distributions of
all the possible bipartite networks with prescribed node degree,
through individual consecutive executions of the switching-algo-
rithm, with an approximation power equal to the one attainable
when performing N/ switching-steps.

3.3 Time requirements and statistics comparison for
different bounds and implementations on real datasets

We compared the performances of the switching-algorithm when
applied to a real large cancer genomics dataset, in terms of exe-
cution time on a typical desktop computer, by using different
software implementations and two user-defined numbers of
required switching-steps: our novel lower bound N and the em-
pirical one suggested in (Milo et al., 2003), NC For the purpose of
this comparison, we used breast cancer samples and their respect-
ive mutations downloaded from the TCGA (TCGA et al., 2008)
data portal. A BEM (provided as Supplementary Dataset) was
constructed from the deleterious somatic mutations derived from
this dataset (as detailed in the Supplementary Materials), yielding
757 rows (i.e. samples), 9757 columns (i.e. genes), 19 758 non-null
entries (i.e. variants), corresponding to an edge density equal to
0.27% in the corresponding bipartite network. For this dataset,
the lower bound to the number of switching step computed with
our method corresponds to N = 97 951, whereas the empirical
one is N/ = 1975 800 (Supplementary Fig. S5). Results, in terms
of execution times required to generate 10 000 rewired versions of
the resulting BEM through our implementation of the switching-
algorithm, the rewire function of the igraph package (Csardi and
Nepusz, 2006), the commsimulator function of vegan package
(one of the most famous packages for ecology research)
(Dixon, 2003) and two different numbers of required switch-
ing-steps (respectively, N and N), are summarized in Table 1.
In Table 1, we report also the residual average Jaccard similarity
scores of the rewired networks with respect to the original one.
First columns of the table refer to our optimized implementation
of the switching-algorithm, while data in the second and the third
ones refer to the rewire function, provided in two different versions
of the igraph package (respectively, v0.6.1 and the latest v0.6.5)
(Csardi and Nepusz, 2006). In the fourth column, we report time
requirements of the commsimulator function contained in the
vegan package (Dixon, 2003) when used with the ‘swap’ method
parameter (i.e. the switching-algorithm). The rewire function con-
tained in igraph v0.6.1 does not implement the switching-algorithm
but proceeds through a series of rewiring steps (detailed in the
Supplementary Materials) through a strategy that systematically
biases the edge selection and requires, at each step, a local explor-
ation of the network that is generally slower than storing and
retrieving individual edges from an edge list (time complexity ana-
lysis provided in the Supplementary Materials). In the rewire func-
tion contained in the latest version of the igraph package (v0.6.5),
authors implemented the switching-algorithm. As a consequence,
for this version of the package, executing N switching-steps guar-
antees that the residual similarity reaches its plateau (as shown in
the third column of Table 1). However, computational time re-
quirements for this implementation (third column in Table 1) are
vastly higher than the previous one, making this function practic-
ally unusable on large genomics datasets. A detailed analysis of its
asymptotical time complexity (far from being trivial) has not been

 

i621

112 /310'S[BHJDOIPJOJXO"SOIJBHIJOJIIIOICI/ﬂdnq moi; pap1201umoq

9103 ‘0g isnﬁnv uo ::

A.Gobbi et al.

 

Table 1. Performance comparisons in terms of execution time and residual bias across different algorithms and bounds

 

B [Rew[re [graph v0.6.1

[graph v0.6.5

vegan swap vegan Pateﬁeld

 

(A) Execution time

N 53 min 20 s 5 h 58 s 43 days
6h 21 min
28 s

N’ 9 h 47 days
37min 305 7h 37min 555

(B) Residual average Jaccard similarity

N 0.006716 0.907788 0.006744
0.006723a

N’ 0.006744 0.299971

2 years 145 days
41 min 12sa

154 days 5h 21 min 295
21 h 36mina

8 years 114 days
22 h 53 min 20 sa

0.006762a 0.006921
0.006879a

 

Note: “Estimations.

included yet in the documentation of the package. In Table 1, the
performance scores marked with (a) have been estimated starting
from the execution time requirements and the average residual
similarities observed on limited number of samples of rewired ver-
sions of the original network. For reference, we also include in
Table 1 the performances (in terms of time requirements and re-
sidual similarity to the original network) of the r2dtable function,
included in the vegan package, to generate 10000 random (P1
tables with same marginal totals of our BEM. This function
makes use of Pateﬁelds algorithm (Pateﬁeld, 1981). Also in this
case, the time requirements were signiﬁcantly higher (~1.92 x 104
s versus ~3.2 x 103 s), and the residual similarity is comparable
with the one obtained with our implementation of the switching-
algorithm and our bound.

Finally, to investigate the consistency of ME signiﬁcance when
using null models generated with different number of switching
steps, we analysed ME patterns for the protein affecting muta-
tions of a colorectal cancer dataset assembled from the TCGA
(TCGA et al., 2008) and other studies, as described in the
Supplementary Material. This yielded a small BEM (provided
as Supplementary Dataset) composed by 206 rows (i.e. samples),
78 columns (i.e. genes), 793 non-null entries (i.e. variants), cor-
responding to an edge density equal to 5% in the corresponding
bipartite network. For this dataset, the lower bound to the
number of switching step computed with our method corres-
ponds to N = 2497, whereas the empirical one is N/ =79 300.
We tested the ME signiﬁcance (as described in the MEMo ap-
proach and in the previous sections) for all the possible 3003 gene
pairs by using two different null models, simulated by generating
10 000 randomized version of the BEM through N and N/ switch-
ing steps, respectively. We observed an overall concordance of
resulting coverage P—values across the two null models and a
perfect match between the corresponding two sets of gene pairs
with a signiﬁcant ME (P<0.05 and fdr<20% after Benjaminii
Hochberg correction of the P—values for multiple hypothesis test-
ing). Results for gene pair with coverage > 50% are provided as
Supplementary Data and Figure 2.

3.4 The BiRewire package

We have developed R package BiRewire (available on
Bioconductor; Gentleman et al., 2004), which provides high-

Pikam - TP53
I

2995

3.5—

:“!TIF‘ : Pr’.‘ ..

kRAs- NRAS
I

3-0 AKAPQ _ magma - MECOM
BRAF— KRAS

2.5 _ .0 ATM - TP53
O

2.0 — ° r.-.w 9.. 

1.5—

1.0

-logm p-value (N')

0.5—

£1.0—

 

 

oo 0.5 1:0 1:5 2:0 2.5 3.0 3.5
-logm p-vaiue (N)

Fig. 2. ME P-value comparisons. ME P-values for 237 gene pairs, whose
coverage is > 50% in the BEM derived from the colorectal cancer data-
set. Positions on the two axes indicate —log10 P-values computed by using
two different null models simulated by generating 10000 randomized
version of the original BEM, through the switching algorithm and differ-
ent numbers of switching steps: our novel lower bound and the empirical
one. An overall consistency of P-values can be observed and a set of 11
gene pairs has a signiﬁcant level of ME (at a false discovery rate < 20%)
on both the null models

performing routines for generating random bipartite graphs
with prescribed node degrees (using the switching-algorithm),
for the analysis of convergence diagnostics across switching-
steps, and the estimation of the minimal number of steps accord-
ing to the formula described in Equation (1). BiRewire is vastly
faster than other existing implementations, not only because it
uses our new lower bound but also because it implements an
optimal version of the switching-algorithm, as detailed in the
Supplementary Materials. Speciﬁcally, with BiRewire, users can
(i) create bipartite graphs starting from genomic binary event
matrices (or, generally, from any kind of PAMs), (ii) perform
an analysis, which consists of studying the sample path (time
series) of the JI across switching-steps (with user-deﬁned sam-
pling times), and estimating the lower bound to achieve

 

i622

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”Idllq moi; pap1201umoq

9103 ‘0g isnﬁnv uo ::

Genomic data randomization presen/ing alteration counts

 

convergence to the uniform distribution on the set of allowed
bipartite networks, (iii) generate rewired versions of a bipartite
graph with the analytically derived bound of switching-steps or a
user-deﬁned one and (iv) derive projections of the starting net-
work and its rewired version and perform different graph-theory
analysis on them. All the functions of the package are written in
C and R-wrapped.

4 CONCLUSIONS

We presented a novel approximate lower bound for the minimal
number of steps required by the switching-algorithm to simulate
genomic datasets from relevant null models. This new lower
bound was derived analytically, and it considerably reduces the
computational time for estimating the signiﬁcance of combina-
torial metrics such as mutation mutual exclusivity and co-occur-
rence under these null models. We showed that this novel bound
strongly reduces computational time requirements, when tested
on a real dataset and a typical desktop computer architecture
paired with the R package BiRewire (which we have developed).
Our methods can be readily adapted to the computation of P-
values under similar null models, which are appropriate for other
kinds of data that can be modelled as a presence-absence matrix
(hence, a bipartite network) preserving the ‘presence—distribu-
tions’ both across rows and columns. We believe that its applic-
ability range covers different ﬁelds of computational biology and
will grow in the future, as increasingly more data for which bi-
partite graphs provide a natural representation become available.

ACKNOWLEDGEMENT

We thank Ultan McDermott for a number of insightful discus-
sions on the ideas underlying our manuscript. We thank Chris
Greenman and Michael Schubert for their helpful comments and
Martina Rossi for her kind help in editing and formatting our
formal proof.

Funding: F.I. has been partially funded by the joint EMBL-EBI
and Wellcome Trust Sanger Institute post-doctoral (ESPOD)
programme.

Conﬂict of Interest: none declared.

REFERENCES

Barabasi,A.L. et al. (1999) Mean—ﬁeld theory for scale—free random networks.
Physica A, 272, 1737187.

Barretina,J. et al. (2012) The Cancer Cell Line Encyclopedia enables predictive
modelling of anticancer drug sensitivity. Nature, 483, 603$07.

Besag,J. and Clifford,P. (1989) Generalized montecarlo signiﬁcance tests.
Biometrika, 76, 633$42.

Bignell,G.R. et al. (2010) Signatures of mutation and selection in the cancer genome.
Nature, 463, 8937898.

Brooks,S.P. and Gelman,A. (1998) General methods for monitoring convergence of
iterative simulations. J. Comput. Graph. Stat., 7, 434—455.

Brousseau,A. (1971) Linear Recursion and Fibonacci Sequences. The Fibonacci as—
sociation, San Jose (CA) USA.

Cancer Genome Atlas Research Network. (2008) Comprehensive genomic charac—
terization deﬁnes human glioblastoma genes and core pathways. Nature, 455,
106171068.

Ciriello,G. et al. (2012) Mutual exclusivity analysis identiﬁes oncogenic network
modules. Genome Res., 22, 3984106.

Connor,E.F. and Simberloff,D. (1979) The assembly of species communities: chance
or competition? Ecology, 60, 113271140.

Csardi,G. and Nepusz,T. (2006) The igraph software package for complex network
research. Int. J. Complex Syst., 38, 1695.

Cui,Q. (2010) A network of cancer genes with co—occurring and anti—co—occurring
mutations. PLoS One, 5, e13180.

Dixon,P. (2003) VEGAN, a package of R functions for community ecology. J. Veg.
Sc[., 5, e13180.

Garnett,M.J. et al. (2012) Systematic identiﬁcation of genomic markers of drug
sensitivity in cancer cells. Nature, 483, 5707575.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com—
putational biology and bioinformatics. Genome Biol., 5, R80.

Gotelli,N.J. (2000) Null model analysis of species co—occurrence patterns. Ecology,
81, 260G2621.

Gotelli,N.J. and Entsminger,G.L. (2001) Swap and ﬁll algorithms in null model
analy—sis: rethinking the knight’s tour. 0ec0l0gia, 129, 2817291.

Greenman,C. et al. (2007) Patterns of somatic mutation in human cancer genomes.
Nature, 446, 1537158.

Gross,J.L. and Yellen,]. (2006) Graph Theory and Its Applications. Chapman and
HallCRC, Boca Raton (FL) USA.

Gu,Y. et al. (2010) Systematic interpretation of comutated genes in large—scale
cancer mutation proﬁles. Mol. Cancer Ther., 9, 218672195.

Hanahan,D. and Weinberg,R.A. (2011) Hallmarks of cancer: the next generation.
Cell, 144, 646$74.

Ihaka,R. and Gentleman,R. (1996) R: a language for data analysis and graphics.
J. Computat. Graph. Stat., 5, 29%314.

International Cancer Genome Consortium et al. (2010) International network of
cancer genome projects. Nature, 464, 9937998.

Jaccard,P. (1901) Etude comparative de la distribution ﬂorale dans une portion des
Alpcs ct du Jura. Bulletin de la Socit Vaudoise des Sciences Naturelles, 37, 142.

Johnson,V.E. (1996) Studying convergence of Markov chain Monte Carlo algo—
rithms using coupled sample paths. J. Am. Stat. Assoc., 91, 154466.

Miklés,I. and Podani,]. (2004) Randomization of presence—absence matrices: com—
ments and new algorithms. Ecology, 85, 8(r92.

Miller,C.A. et al. (2011) Discovering functional modules by identifying recurrent
and mutually exclusive mutational patterns in tumors. BM C Med. Genomics, 85,
8(r92.

Milo,R. et al. (2003) On the uniform generation of random graphs with prescribed
degree sequences. In: Arxiv preprint cond—mat. 0312028.

Pateﬁeld,W.M. (1981) Algorithm AS 159: an efﬁcient method of generating random
RxC tables with given row and column totals. J. R. Stat. Soc., 30, 91797.
Ponocny,I. (2001) Nonparametric goodness—of—ﬁt tests for the Rasch model.

Psychometrika, 66, 4377459.

Rasch,G. (1993) Probabilistic Models for Some Intelligence and Attainment Tests.
University of Chicago Press, Chicago (IL) USA.

Ray,J. et al. (2012) Are we there yet? When to stop a markov chain while generat—
ing random graphs. In: Bonato, A. and Janssen, J. (eds) Algorithms and Models
for the Web Graph. Lecture Notes in Computer Science. Vol. 7323, Springer,
Berlin Heidelberg, pp. 1537164.

Sokal,A.D. (1989) Monte Carlo methods in statistical mechanics: foundations and
new algorithms Functional Integration. NAT 0 ASI Series, 361, 1317192.

Stanton,I. and Pinar,A. (2012) Constructing and sampling graphs with a prescribed
joint degree distribution. J. Exp. Algorithmics, 17, 3.1.

Stratton,M.R. et al. (2009) The cancer genome. Nature, 458, 7197724.

Thomas,R.K. et al. (2007) High—throughput oncogene mutation proﬁling in human
cancer. Nat. Genetics., 39, 567.

Uren,A.G. et al. (2008) Large—scale mutagenesis in p19ARF—and p53—deﬁcient mice
identiﬁes cancer genes and yheir collaborative networks. Cell, 133, 7277741.
Vandin,F. et al. (2012) De novo discovery of mutated driver pathways in cancer.

Genome Res., 22, 3757385.

Vogelstein,B. et al. (2013) Cancer genome landscapes. Science, 339, 154G1558.

Wilson,J.B. (1987) Methods for detecting non—randomness in species co—
occurrences: a contribution. 0ec0l0gia, 73, 5797582.

Yeang,C.H. et al. (2008) Combinatorial patterns of somatic gene mutations in
cancer. FASEB J., 22, 260572622.

 

i623

112 /310'S[BHJHOIPJOJXO'SOIJBLUJOJIIIOICI”K1111] mm} papeo1umoq

9103 ‘0g1sn8nv uo ::

