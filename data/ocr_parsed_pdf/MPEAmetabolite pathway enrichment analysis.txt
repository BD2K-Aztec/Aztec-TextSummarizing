Vol. 27 no. 13 2011, pages 1878-1879
APP N doi:10.1093/bioinformatics/btr278

 

Systems biology

Advance Access publication May 5, 2011

MPEA—metabolite pathway enrichment analysis

Matti Kankainenla‘k, Peddinti Gopalacharyulul, Liisa Holm‘2 and Matej Ore ic1
1V'I'I' Technical Research Centre of Finland, Espoo and 2Institute of Biotechnology and Department of Biological

Sciences, University of Helsinki, Helsinki, Finland
Associate Editor: Joaquin Dopazo

 

ABSTRACT

Summary: We present metabolite pathway enrichment analysis
(MPEA) for the visualization and biological interpretation of
metabolite data at the system level. Our tool follows the concept of
gene set enrichment analysis (GSEA) and tests whether metabolites
involved in some predefined pathway occur towards the top (or
bottom) of a ranked query compound list. In particular, MPEA is
designed to handle many-to-many relationships that may occur
between the query compounds and metabolite annotations. For a
demonstration, we analysed metabolite profiles of 14 twin pairs with
differing body weights. MPEA found significant pathways from data
that had no significant individual query compounds, its results were
congruent with those discovered from transcriptomics data and it
detected more pathways than the competing metabolic pathway
method did.

Availability: The web server and source code of MPEA are available
at http://ekhidna.biocenter.helsinki.fi/poxo/mpea/.

Contact: matti.kankainen@helsinki.fi

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 23, 2010; revised on April 22, 201 1; accepted
on April 25,2011

1 INTRODUCTION

Metabolite proﬁling refers to a set of techniques by which a wide
range of metabolites can be detected and quantiﬁed from biological
extracts (Fernie et (11 ., 2004). Such experiments are often conducted
to discover biomarkers and data resulting from these studies are
analyzed using complex multivariate statistical methods (Cevallos-
Cevallosa et (11., 2009; Fernie et (11., 2004). Recently, tools for
analysing metabolite data in the context of predeﬁned biological
metabolite sets have, however, been reported (Aggio et (11., 2010;
Xia and Wishart, 2010). Instead of discovering speciﬁc metabolites
that discriminate sample groups, the aim of these methods is to
discover predeﬁned metabolic pathways or biological networks that
are co-ordinately altered in the experiment. Such changes are often
assessed by employing the gene set enrichment analysis (GSEA)
procedure (Subramanian et (11., 2005) to test whether the elements
of some predeﬁned biological group are enriched towards the top or
bottom of a ranked list.

Here, we describe the metabolite pathway enrichment analysis
(MPEA) for the visualization and ﬁinctional analysis of metabolite
data at the system level. MPEA tests whether metabolites in
predeﬁned pathways occur towards the top or bottom of a ranked

 

*To whom correspondence Should be addressed.

list. It can be applied either to pre-annotated compounds or gas
chromatography coupled with mass spectrometry (GC-MS) data
consisting of mass spectral tags (MSTs). If MSTS are provided, they
are characterized using GMD (Kopka et (11., 2005). This feature
was included to facilitate the analysis of data generated by GC-
MS—a popular analytical tool for metabolite proﬁling (Fernie et (11.,
2004). Furthermore, as it is unlikely that all query compounds
are unambiguously resolved, MPEA has been developed to handle
ambiguously identiﬁed compounds.

We tested MPEA on a study in which adipose tissue transcriptome
and metabolome were studied in 14 twin pairs discordant for body
weight (Pietilainen et (11., 2008). MPEA revealed more signiﬁcantly
altered pathways in acquired obesity based on metabolite data than
the competing method did and its results corresponded with the
pathways that GSEA found from transcriptomics data.

2 METHODS

The idea of MPEA is to identify coordinately changed Kyoto Encyclopedia
of Genes and Genomes (KEGG; Ogata at 611., 1999) and Small Molecule
Pathway Database (SMPDB; Frolkis 61611., 2010) pathways using metabolite
data. It requires a list of pre-annotated compounds or GC-MS-based MSTS
and haS two modes of enrichment analysis: Single set and iterative. Single
set mode is used for unranked lists whereas the iterative mode is for entries
ranked. for example. by performing t-teStS on estimated concentrations. User-
given annotations Should include KEGG-identiﬁerS (KIDS). If required. an
identiﬁer set with multiple KIDS can be created for a compound. The KIDS
within the identiﬁer set represent interchangeable and alternative mappings
for that compound. It iS also possible to aSSign multiple identiﬁer setS to
a compound that haS been identiﬁed ambiguously. Alternatively. MPEA
supports GC-MS-based MSTS consisting of maSS fragmentation pattern and
retention index (RI). MSTS are identiﬁed and annotated using GMD. Pathway
inconsistencies are resolved and the Statistical enrichment of metabolic
pathways iS estimated uSing the hypergeometric distribution coupled with
a permutation teSt.

Identiﬁcation of MSTS iS based on the Spectral comparison against
reference Spectra and iS achieved uSing the MS analySiS tool at GMD (Kopka
at 611., 2005). The relatedness of maSS-to-charge ratios iS measured with
several metrics and analyteS below a given Similarity threshold are discarded.
Spectral matching can be further restricted by setting a RI window for
matches or by naming MSTS. If the name iS detected among the matches.
only analyteS having that name are accepted. An identiﬁer set iS formed over
metabolites associated with a particular analyte and each matching analyte
generates a new identiﬁer set for the query.

To obtain reliable results. ambiguous identiﬁcations need to be resolved
and the number of KIDS aSSigned to the pathway requires to be established.
We tackle thiS problem using a novel approach (Fig. 1). For each
pathway. an entity relationship matrix iS created to resolve the many-to-
many relationships between the query compounds and KIDS aSSigned to
the pathway. The number of KIDS found for the pathway iS estimated

 

1878 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io'S[Bumo[pJOJXO'SorwurJOJurorqﬂ:duq wort pQPBOIII/lAOG

9103 ‘Og anﬁnv uo ::

MPEA

 

 

MSTm=
MST“:
MSTn=

 

 

 

H
m
o
o
o
U
1
0
0
0
1

o o H o I- C00159
6 H o o o C00267
H ° ° ° ° C00794

 

Fig. 1. An example of ﬁve MSTS associated with galactose metabolism.
(A) Listing shows KIDS assigned to compounds and identiﬁer sets (boxes).
KIDS not part of the pathway are shown in red. (B) The relationship matrix
is the Cartesian product of KID and compound groups for the pathway and
includes columns for the external mapping variables. KIDS by which the
compounds are describable are highlighted with ones. Selecting the KIDS
marked with orange circles and the KID marked with green. blue or red
circle would create a compoundiKID combination with 3. 3 or 4 distinct
KIDS. respectively. (C) The number of distinct KIDS is recorded giving the
minimum (1). median (3) or maximum (5) numbers.

by enumerating compound-KID combinations from the matrix. For each
combination. one of the alternative KIDS of the compound is chosen for the
compound. the selected KIDS are joined and the number of distinct KIDS is
recorded.

Alternatively. if a query compound has other identiﬁer sets that do not link
the compound to the pathway. external mapping variables are added for the
compound in the entity relationship matrix. AS the external mapping variable
is not part of the pathway. it creates a set of combinations in which the count
of distinct KIDS is not increased. This approach allows us to decrease the
probability that a compound with distinct identiﬁer sets is added to the current
pathway. The upper bound for the number of external mapping variables can
be set by the user.

The Statistical Signiﬁcance of pathways is tested using the hypergeometric
distribution. The minimum. median or maximum number of distinct KIDS
represents the number of successfully drawn elements from the input list
whereas the background distribution is calculated using the number of KIDS
associated with pathways in total and KIDS part of the tested pathway.
Alternatively. background distribution Speciﬁc to given organism(s) can be
constructed. User may also supply the list of metabolites for calculating the
background distributions. In the iterative mode. the statistic is calculated
repetitively increasing the size of the list by one. The list position yielding
the most Signiﬁcant result is recorded. Corrected P-values are calculated by
permuting the list and repeating the Statistical procedure many times. In the
Single set mode. the whole list is used to compute the enrichment statistic.

The MPEA web interface and source code are available at:
http://ekhidna.biocenter.helsinkiﬁ/poxo/mpeaf. See Supplementary Material
for illustrative analyses.

3 EXAMPLE ANALYSIS USING MPEA

For an evaluation, metabolomics and transcriptomics data obtained
from adipose tissue biopsies in 14 twin pairs discordant for body
weight was analysed. The transcriptomics data were previously
reported (Pietilainen et (11., 2008) and was here studied using GSEA.
Metabolomic analysis in the same tissue samples was performed

using 2D GC coupled to time-of-ﬂight MS, as described previously
(Mattila et (11., 2008). T-test was used to compare study groups
and for ranking MSTs. MPEA and MSEA were used to ﬁnd altered
pathways (see Supplementary Material).

In our test, MPEA assigned query compounds to 4—15 pathways.
Spearman’s (pg) correlations were calculated over the complete
observation pairs to compare the lists of signiﬁcant pathways derived
from GSEA and MPEA (Supplementary Material). The result shows
that the highest correlation values (,oS=0.94, ,oS=0.93 and pg:
0.90, n = 6 in each comparison) were obtained using median number
of distinct KIDs and a maximum of three, one and two external
mapping variables, respectively. Thus, the use of external mapping
variables to resolve many-to-many relationships makes the results
of MPEA more similar to that of GSEA. Of the listed parameter
settings, the one with one external mapping variable gave two
signiﬁcant pathways (P3005). Metabolites belonging to amino
sugar and nucleotide sugar, and ascorbate and aldarate metabolism
were all coordinately more abundant in lean twins. Neither of the
pathways was however detected by GSEA.

In comparison with MSEA, MPEA detected all but two of
the SMPDB pathways detected by MSEA. MPEA associated
more metabolites to most pathways and produced more signiﬁcant
P-values. For example, MPEA assigned four compounds to fatty
acid biosynthesis and galactose metabolism, whereas the MSEA was
at best able to assign a single metabolite to any pathway, illustrating
the advantage of GMD-based compound identiﬁcation and the better
sensitivity of an enrichment analysis done to ranked metabolite lists.

ACKNOWLEDGEMENTS
We thank QBIX group at VTT for helpful discussion.

Funding: European Union-funded project ETHERPATHS (FP7-
KBBE-222639, http://www.etherpaths.org/).

Conﬂict of Interest: none declared.

REFERENCES

Aggio,R.B. et al. (2010) Pathway Activity Proﬁling (PAPi): from the metabolite proﬁle
to the metabolic pathway activity. Bioinformdtics, 26, 296972976.

Cevallos-Cevallosa,J.M. et al. (2009) Metabolomic analysis in food science: a review.
Trends Food Sci. Technol, 20, 5577566.

Fernie,A.R. et al. (2004) Metabolite proﬁling: from diagnostics to systems biology. Nat.
Rev. Mol. Cell Biol., 5, 7637769.

Frolkis,A. et al. (2010) SMPDB: the small molecule pathway database. Nucleic Acids
Res, 38, D48&D487.

Kopka,J. et al. (2005) GMD@CSB.DB: the Golm Metabolome Database.
Bioinformdtics, 21, 635$38.

Mattila,I. et al. (2008) Application of lipidomics and metabolomics to the study of
adipose tissue. Methods Mol. Biol., 456, 1237130.

Ogata,H. et al. (1999) KEGG: Kyoto Encyclopedia of Genes and Genomes. Nucleic
Acids Res, 27, 29734.

Pietila'inen,K.I-I. et al. (2008) Global transcript proﬁles of fat in monozygotic twins
discordant for BMI: pathways behind acquired obesity. PLoS Med, 11, e51.

Subramanian,A. et al. (2010) Gene set enrichment analysis: a knowledge-based
approach for interpreting genome-wide expression proﬁles. Proc. Natl Acad. Sci.
USA, 102, 15545715550.

Xia,J. and Wishart,D.S. (2010) MSEA: a web-based tool to identify biologically
meaningful patterns in quantitative metabolomic data. Nucleic Acids Res, 38,
W717W77.

 

1879

112 /3.Io's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq wort papeolumoq

9103 ‘Og isanV uo ::

