APPLICATIONS won:-  252.7%.iéés‘iifaiﬁzifiaiiiziiﬂ

 

Genome analysis

Advance Access publication July 12, 2012

MALDIquant: a versatile R package for the analysis of mass

spectrometry data
Sebastian Gibb* and Korbinian Strimmer

Institute for Medical Informatics, Statistics and Epidemiology (IMISE), University of Leipzig, Hartelstr. 16-18, 04107

Leipzig, Germany
Associate Editor: Alex Bateman

 

ABSTRACT

Summary: MALDIquant: is an R package providing a complete and
modular analysis pipeline for quantitative analysis of mass spectro-
metry data. MALDIquant: is specifically designed with application in
clinical diagnostics in mind and implements sophisticated routines for
importing raw data, preprocessing, non-linear peak alignment and
calibration. It also handles technical replicates as well as spectra
with unequal resolution.

Availability: MALDIquant: and its associated R packages
readBrukerFlexData and reaszXmlData are freely available
from the R archive CRAN (http://cran.r-project.org). The software is
distributed under the GNU General Public License (version 3 or later)
and is accompanied by example files and data. Additional documen-
tation is available from http://strimmerlab.org/software/maldiquanv.
Contact: mail@sebastiangibb.de

Received on June 6, 2012; revised on July 5, 2012; accepted on
July 9, 2012

1 INTRODUCTION

Mass spectrometry proﬁling is increasingly becoming an import-
ant tool in clinical diagnostics, for example to identify bio-
markers for cancer (e.g. Fiedler et al., 2009). Similarly as with
other high-throughput technologies, sophisticated statistical al-
gorithms are essential in the analysis of spectrometry data
(Morris et al., 2010).

We have developed MALDIquant to provide a complete open-
source analysis pipeline on the R platform (R Development Core
Team, 2012) comprising all steps from importing of raw data,
preprocessing (e.g. baseline removal), peak detection and
non-linear peak alignment to calibration of mass spectra.
MALDIquant is written as a standalone package using S4
object-oriented programming to facilitate further extension.

MALDIquant was initially developed for clinical proteomics
using Matrix-Assisted Laser Desorption/Ionization (MALDI)
technology. However, the algorithms implemented in
MALDIquant are generic and may be equally applied to other
2D mass spectrometry data.

2 DISTINCTIVE FEATURES

In comparison with related R packages for mass spectrometry
analysis, MALDIquant features a number of unique capabilities.

 

*To whom correspondence should be addressed.

In particular, it implements a sophisticated non-linear peak
alignment algorithm (He et al., 2011; Wang et al., 2010) as
well as a calibration procedure for normalization of peak inten-
sities across spectra that are modeled on a related method for
sequence count data (Anders and Huber, 2010). In addition,
MALDIquant allows to analyze technical replicates and spectra
with unequal resolution, a crucial feature in clinical mass spec-
trometry where spectra from multiple sources need to be
compared.

3 DETAILS ON ALGORITHMS

An example workflow for mass spectrometry analysis using
MALDIquant is depicted in Fig. 1, starting with a raw unpro-
cessed MALDI spectrum (A), followed by smoothing, baseline
correction and peak detection (B), local alignment of peaks
across spectra by warping (CeE) and merging and Visualization
(F). In the following, we brieﬂy provide some background on the
respective algorithms.

3.1 Data import

MALDIquant is carefully designed to be independent of any
speciﬁc mass spectrometry hardware. Nonetheless, native input
of binary data files (as well as complete folder hierarchies) from
Bruker ﬂex series instruments and input of the szML data
format is supported through the associated R packages
readBrukerFlexData and reaszXmlData.

3.2 Data preprocessing

For preprocessing spectral data, MALDIquant offers a complete
set of routines for smoothing, variance stabilization, baseline
correction and peak detection. MALDIquant implements several
approaches to adjust the baseline and uses per default the SNIP
algorithm (Ryan et al., 1988) that returns a smooth baseline and
leads to positive corrected intensities (Fig. IE).

3.3 Peak alignment

For comparison of peaks across different spectra, it is essential to
conduct alignment. In order to match peaks belonging to the
same mass, MALDIquant uses a statistical regression-based ap-
proach combining the algorithms of He et a]. (2011) and Wang
et a]. (2010). Speciﬁcally, ﬁrst landmark peaks are identiﬁed that
occur in most spectra. Subsequently, a non-linear warping func-
tion is computed for each spectrum by ﬁtting a local regression

 

2270 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /3.IO'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pQPBOIIIAAOG

91oz ‘Og isnﬁnV uo ::

R package for the analysis of mass spectrometry data

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A " ' c
., _
N _
o _
‘l' _
. ()I _
I I I I I I I I I I I I I
2000 4000 6000 8000 10000 2000 4000 6000 8000 10000 2000 4000 6000 8000
I I I I I I I I I I I I I I I I I I I
4180 41 90 4200 4210 4220 4230 4240 4180 41 90 4200 4210 4220 4230 4240 2000 4000 6000 8000 10000

Fig. 1. Example of MALDIquant output: (A) raw spectrum; (B) variance-stabilized, smoothed and baseline-corrected spectrum with detected peaks; (C)
ﬁtted warping function for peak alignment; (D) four unaligned peaks; (E) four aligned peaks; and (F) merged spectrum with detected and labeled peaks.

to the matched reference peaks (Fig. lCeE). This also allows to
merge aligned spectra from technical replicates. An example of a
merged spectrum with identified and labeled peaks is shown in
Fig. 1F.

3.4 Calibration

Quantitative analysis of multiple spectra, e.g. to detect differen-
tially expressed peaks, requires calibration. In order to render
peak intensities comparable across spectra, a suitable scale
factor for each individual spectrum needs to be determined.
Experimentally, quantification of intensities is performed by ref-
erence to spike-in samples. In absence of spike-ins,
MALDIquant offers a way of calibrating relative intensities by
adapting an algorithm for calibrating next generation sequencing
data (Anders and Huber, 2010). In this procedure ﬁrst a refer-
ence spectrum is created using the median intensity of aligned
peaks from all spectra. Subsequently, a scale factor is computed
for each spectrum by using a robust estimator of the overall ratio
of the peak intensities of the uncalibrated spectrum versus the
reference spectrum. Additionally, calibration based on total ion
current is available.

3.5 Classiﬁcation and feature selection

Finally, the resulting calibrated peak intensity matrix may be
exported for further use in high-level statistical analysis, for in-
stance classiﬁcation and feature selection using shrinkage dis-
criminant analysis (Ahdesmaki and Strimmer, 2010).

4 CONCLUSION

MALDIquant is a versatile R package providing a ﬂexible ana-
lysis pipeline for MALDI-TOF and other mass spectrometry
data. It offers a number of distinctive features, in particular for
alignment by non-linear warping and simultaneous calibration of
peak intensities.

An overview of its capabilities is given by running the included
demo script

library ( ‘ ‘MALDIquant ’ ’ )

demo ( ‘ ‘MALDIquant ’ ’)

ACKNOWLEDGMENTS

We thank Alexander Leichtle for many valuable and helpful
suggestions and Fiedler et a]. (2009) for their kind permission
to use their data in MALDIquant.

Funding: S.G. received funding from the German National
Academic Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Ahdesmaki,M. and Strimmer,K. (2010) Feature selection in omics prediction prob—
lems using cat scores and false non—discovery rate control. Ann. App]. Statist., 4,
5037519.

Anders,S. and Huber,W. (2010) Differential expression for sequence count data.
Genome Biol., 11, R106.

Fiedler,G.M. et a]. (2009) Serum peptidome proﬁling revealed platelet factor 4 as a
potential discriminating peptide associated with pancreatic cancer. Clin. Cancer
Res., 15, 381273819.

He,Q.P. et a]. (2011) Self—calibrated warping for mass spectra alignment. Cancer
Inform., 10, 65782.

Morris,J.S. et a]. (2010) Statistical contributions to proteomic research. Methods
Mol. Biol., 641, 1437166.

R Development Core Team (2012) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing Vienna, Austria.

Ryan,C.G. et a]. (1988) SNIP, a statistics—sensitive background treatment for the
quantitative analysis of PIXE spectra in geoscience applications. Nucl.
Instrument. Meth. B, 34, 396—402.

Wang,B. et a]. (2010) DISCO: distance and spectrum correlation optimization align—
ment for two—dimensional gas chromatography time—of—ﬂight mass
spectrometry—based metabolomics. Anal. Chem, 82, 506975081.

 

2271

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOlq/ﬂduq 11101} popcorn/neg

91oz ‘Og isnﬁnV uo ::

