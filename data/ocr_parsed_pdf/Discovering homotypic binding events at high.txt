ORIGINAL PAPER

Vol. 26 no. 24 2010, pages 3028-3034
doi: 1 0. 1093/bioinformatics/btq590

 

Genome analysis

Advance Access published October 21, 2010

Discovering homotypic binding events at high spatial resolution

Yuchun Gu01’2, Georgios Papachristoudis‘, Robert C. Altshulerl, Georg K. Gerberlas,
Tommi S. Jaakkola‘, David K. Gifford134a* and Shaun Mahony1’*
1MIT Computer Science and Artificial Intelligence Laboratory, 32 Vassar Street, 2Computational and Systems Biology

Program, MIT, Cambridge, MA 02139, 3Department of Pathology, Brigham and Women’s Hospital, Harvard Medical
School, 75 Francis Street, Boston, MA 02115 and 4Whitehead Institute for Biomedical Research, Nine Cambridge

Center, Cambridge, MA 02142, USA
Associate Editor: Joaquin Dopazo

 

ABSTRACT

Motivation: Clusters of protein—DNA interaction events involving the
same transcription factor are known to act as key components of
invertebrate and mammalian promoters and enhancers. However,
detecting closely spaced homotypic events from ChlP-Seq data is
challenging because random variation in the ChlP fragmentation
process obscures event locations.

Results: The Genome Positioning System (GPS) can predict protein—
DNA interaction events at high spatial resolution from ChlP-Seq data,
while retaining the ability to resolve closely spaced events that appear
as a single cluster of reads. GPS models observed reads using a
complexity penalized mixture model and efficiently predicts event
locations with a segmented EM algorithm. An optional mode permits
GPS to align common events across distinct experiments. GPS
detects more joint events in synthetic and actual ChlP-Seq data and
has superior spatial resolution when compared with other methods.
In addition, the specificity and sensitivity of GPS are superior to or
comparable with other methods.

Availability: http://cgs.csail.mit.edu/gps

Contact: gifford@mit.edu; mahony@mit.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 4, 2010; revised on October 9, 2010; accepted on
October 11, 2010

1 INTRODUCTION

The precise physical description of where transcription factors,
histones, RNA polymerase II and other proteins interact with
the genome provides an invaluable mechanistic foundation for
understanding gene regulation. ChIP-Seq (Chromatin immunopre-
cipitation followed by high-throughput sequencing) has become
an indispensable tool for genome-wide proﬁling of protein-DNA
interactions (Barski et al., 2007; Johnson et (11., 2007; Robertson
et al., 2007).

Computational methods are necessary to predict the location
of protein—DNA interaction events from ChIP-Seq data because
random variation in the ChIP DNA fragmentation process obscures
the actual location of interaction events. Thus while ChIP-Seq DNA
sequence reads are mapped to precise bases in the genome, these
reads do not manifestly indicate the location of the protein—DNA

 

*To whom correspondence should be addressed.

interaction events that caused them. We deﬁne spatial resolution to
be the difference between the computationally predicted location of
a protein—DNA binding event and the midpoint of its actual location.
An ideal computational method for analyzing ChIP-Seq data would
accurately localize protein-DNA interaction events (high spatial
resolution), would include no false events (high speciﬁcity), would
include all true events (high sensitivity), and would be able to resolve
closely spaced DNA-protein interactions (joint event discovery).

Joint event discovery is important because it can capture
cooperative biological regulatory mechanisms in proximal genomic
locations (Pepke et al., 2009). Homotypic clusters of transcription
factor binding sites (TFBS) have been extensively studied in
Drosophila (Lifanov et (11., 2003). Such regulatory mechanisms
may be common in mammalian genomes as 40—60% of certain
ChIP-Seq deﬁned protein-DNA interaction regions contain more
than one motif within 200 bp (Jothi et al., 2008; Valouev et al.,
2008). Furthermore, homotypic clusters of TFBS occupy nearly 2%
of the human genome and may act as key components of almost
half of the human promoters and enhancers (Gotea et al., 2010).
Thus, homotypic event discovery is necessary to fully reveal the
transcription factor regulatory interactions present in ChIP-Seq data.

Existing ChIP-Seq computational methods (Park, 2009; Pepke
et al., 2009) do not simultaneously consider multiple events as the
cause for observed reads in the context of a probabilistic model
at mammalian genome scale. To detect binding events, PeakSeq
extends the length of mapped reads to create peaks (Rozowsky et al.,
2009), MACS shifts the mapped position of reads a ﬁxed distance
towards their 3’-ends (Zhang et al., 2008), FindPeaks aggregates
overlapping reads (Fejes et al., 2008), SISSRs identiﬁes positive to
negative strand transition points at read accumulations (Jothi et al.,
2008), cisGenome scans for the center of modes of the 5’ and 3’
peaks (Ji et al., 2008), and QuEST (Valouev et al., 2008) and spp
(Kharchenko et al., 2008) use kernel density estimation methods. All
of these methods use statistical detection criteria such as overlapping
read counts or read distribution strand symmetry to estimate the
location of a protein—DNA interaction event. A recent method
named CSDeconv deconvolves proximal binding events using a
computed spatial read distribution (Lun et al., 2009), although it is at
present computationally impractical on entire mammalian genomes.
In addition, recent evaluations showed that while all these methods
identiﬁed binding sites with a highly signiﬁcant overlap with the
corresponding sequence motif (Laajala et al., 2009), and exhibited
similar sensitivity and speciﬁcity, there are pronounced differences
in their spatial resolution (Wilbanks and Facciotti, 2010).

 

3028 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bruno[pJOJXO'sonBurJOJurorqﬂ:duq moi; papBOIII/IAOG

9103 ‘{g anﬁnv 110::

Homotypic binding events at high spatial resolution

 

We present the Genome Positioning System (GPS), a high-
resolution genome-wide ChIP-Seq analysis method that can
accurately detect closely spaced protein-DNA interaction events
(joint events). GPS detects more joint events in synthetic and actual
ChIP-Seq data and has superior spatial resolution when compared
with other methods. In addition, the speciﬁcity and sensitivity of
GPS are superior to or comparable with other methods.

2 METHODS

2.1 GPS model overview

GPS has three phases: spatial distribution discovery. event discovery and the
determination of event signiﬁcance. In its ﬁrst phase. GPS summarizes the
observed spatial distribution of reads from proteiniDNA interaction events in
the input ChIP-Seq data. The farther a mapped read is located from an event.
the less likely it is to be caused by the event (Fig. lb). We assume in GPS
that for a given ChIP-Seq experiment. every interaction event will produce
the same characteristic distribution of reads. While this assumption will not
always be true. we have found that it produces good results in practice. Note
that reads from joint events will spatially mix with one another along the
genome. presenting a challenge for precisely estimating the multiplicity and
exact positions of proximal proteiniDNA interaction events (Fig. la).

In its second phase. GPS employs a probabilistic mixture model to assign
an event probability to every base in the genome. Each potential event’s
contribution to generating the observed reads is modeled (Fig. 1c and d).
A sparse prior on event probabilities provides a complexity penalty that
biases events to have their probability mass at a single base position. Event
probabilities are selected to maximize the penalized likelihood of observed
reads using a multi-resolution EM algorithm that segments the genome into
efﬁciently solvable subproblems. GPS uses the number of reads assigned
to a base by the mixture model as a measure of the relative strength of a
predicted event at that base.

In its third and ﬁnal phase. GPS ﬁlters discovered events by comparing
the number of reads at the predicted events to the corresponding normalized

(b) CTCF event expected read density

(a) Mixture of reads from joint events
2

OJI

i
-—
—-——

—

  
   

 

Rmdnnmn,‘
‘  o :3.

-im -.'-.13 r.- m m

.um- an 'ﬁsruclin mung an:

(C) GPS mixture model

I.“

(d) Deconvolvecl protein-DNA interaction events

Possible
events

Observed
reads

 

Fig. 1. GPS probabilistically models ChIP-Seq read spatial distributions.
(3) Protein-DNA interaction events at positions 1 and 2 on the genome result
in DNA end sequence reads in the ChIP-Seq protocol. (b) The observed
spatial read density (blue: ‘+’ strand. red: ‘—’ strand) from ~4000 CTCF
events aligned with respect to the CTCF motif position at each event (c) GPS
models ChIP-Seq reads as being generated by a mixture of binding events
at every genomic base. with each event producing the characteristic spatial
read density. (d) A sparse prior on mixture components causes GPS to assign
events to as few bases as possible to explain the observed reads (green and
orange reads). In GPS. a given read can be explained by more than one event
(yellow reads).

number of reads in the control channel. We compute the statistical
signiﬁcance using the binomial distribution (Rozowsky at al.. 2009) and
correct for multiple hypothesis testing by applying a Benjarnini-Hochberg
correction (Benjarnini and Hochberg. 1995).

2.2 GPS mixture model

GPS is based on a generative mixture model that describes the likelihood of
an observed set of ChIP-Seq reads from a set of proteiniDNA interaction
events. Each event contributes a distribution of reads surrounding its genomic
position to the mixture of reads. We assume that reads are independent
conditioned on the locations of their underlying causal events.

GPS performs event discovery by ﬁnding the set of proteiniDNA
interaction events that maximizes the penalized likelihood of the observed
ChIP-Seq reads. We consider N ChIP-Seq reads that have been mapped to
genome locations R = {r1, ...,rN} and M possible proteiniDNA interaction
events at genome locations B ={b1, ...,bM}. We represent the latent
assignments of reads to the location of events that caused them as
Z: {zh ...,zN}. where z” =j whenj is the index of the event located at
position b]- that caused read n.

The conditional probability of read r” being generated from event j is

[7(rn erL   1)Sn(r’l _ 

where emp(d) is the empirical spatial distribution that models the probability
of a read occurring [1' bases away from its corresponding event position.
Strand sense is handled by snzO or snzl if read r” is mapped to the
forward strand or reverse strand. respectively. We assume that all the events
in one ChIP-Seq experiment have the same empirical spatial distribution. The
empirical spatial distribution is obtained from ChIP-Seq data (see below).

The probability of a read is a convex combination of possible binding
events

M
prrnin>=anprrnij>
1:1
where M is the number of possible events. 7: denotes the parameter vector of
mixing probabilities. and Tr]- is the probability of event j. with 171]- :1.
The overall likelihood of the observed set of reads is then.

N M
erin>= ﬁzzy-pram

rizljzl

Our assumption is that binding events are relatively sparse throughout
the genome. To model this assumption. we place a negative Dirichlet prior
distribution (Bicego at al.. 2007; Figueiredo and Jain. 2002) [7(1) on 7::

M 1
_’ 0
P(n)o<]1:j(nj)a 01>

where or is a tuning parameter to adjust the degree of sparseness. If for event j .
the value of Ir]- becomes zero (see component elimination below). the model
is restructured to eliminate it.

2.3 EM algorithm

We solve for the MAP (maximum a posteriori) solution for 7: using the
ExpectationiMaximization (EM) algorithm (Dempster at al.. 1977). The
complete data log penalized likelihood is

N M M
ln [7(R,Z,JT)=Z 21(zn =j)(ln J'rj+ln p(r,,[j)) —or ln :71]-

n2] 1:1 1:1

where 1(zn = j) is the indicator function.
We initialize mixing probabilities 7: with uniform probabilities. 7r]- : l/ M .
wherej=l,...,M.

 

3029

112 /3.Io's[Bruno[p.IOJxosorwuiJOJurorq”:duq moi; papeolumoq

9103 ‘{g isnﬁnv 110::

KGuo et al.

 

At the E step. we use the current parameter estimates 7: to evaluate the
expectation of Z given R.
. 71 1mm
_ _ J
7/(Zrt —J) — M
Z Nj/PWIJ’)
11:1

We can interpret y(z,, : j) as the fraction of read n that is assigned to event j.
This is referred to as a ‘soft assignment” because read n can be assigned
partially to multiple events.

At the M step. on iteration i we ﬁnd parameter ft“) to maximize the
expected complete-data log penalized likelihood.

N M M

f0®=argmax Z Zﬂzn :j) (1n J'rj+ln p(r,,[j)) —Ol ln :71]-
“I n21 j:l j:l

under the constraint 1 7r]- : 1. By simplifying. we ﬁnd
A (i) _ Ni — a

N
- ——.N-= yrz =j>
’ ﬂaw—a) ’ 21:1 ”

where  is the expected number of reads assigned to event j.

As we iteratively estimate fr. we use a component elimination method
(Figueiredo and Jain. 2002). IfNj got. we set 7r]- : 0 to eliminate eventj. Our
ﬁnal estimate of ft”) is

ﬁg) _ max(0,Nj —ot)

J 2971:] max(0, Nj/ — oz)
The sparseness parameter at can be interpreted as the minimum number of
reads that an event needs to survive the EM iterations. The EM algorithm
is deemed to have converged when the change in likelihood falls below a
speciﬁed threshold.

Our implementation of component elimination includes two special cases.
To avoid premature elimination of components during EM iterations. we
start with ot:0 for a number of iterations to allow nascent components
to gain support from the data. We then set at to our desired value. This is
because when the number of components M is large. no component may have
enough initial support to prevent 7: from being immediately forced to zero.
Furthermore. in a single iteration we do not eliminate all the components that
meet the criteria  got. Instead. we only eliminate the components with the
lowest value of at each iteration. This allows the data points that supported
the eliminated components to be re-distributed immediately to support the
other components.

At the convergence of the EM algorithm. the GPS mixture model produces
a list of non-zero-probability events 7r]- : 0. and the ‘soft’ read assignments to
these events y(z,, : j). We do not use the mixing probabilities 7: in subsequent
analysis because we segment the genome into regions for analysis. and 7:
values are dependent on the region analyzed.

We deﬁne event strength as the expected number of reads associated with
the event. Thus the event strength of event j is calculated as

N
Nj = Zyrzn :11.

n2]

2.4 Empirical spatial distribution of reads

GPS iteratively estimates the empirical spatial distribution of reads directly
from ChIP-Seq data. Given a set of events. we count all the reads at each
position relative to the corresponding event positions. Only the base positions
within 250 bp of the event are counted because typical ChIP-Seq protocols
performs a size selection in the range of ~1507300 bp (Park. 2009) and we
have empirically found that the probability of generating reads at positions
further than 250 bp is not signiﬁcant. The initial set of events for estimating
the empirical spatial distribution can be deﬁned by using known motifs or
by ﬁnding the center of the forward and reverse read proﬁles (Zhang et al..
2008). With the predicted event positions from GPS. we can re-estimate the
empirical spatial distribution and use it for more accurate prediction. This
process can be repeated until convergence (Supplementary Fig. 1).

2.5 Statistical signiﬁcance of predicted events

To evaluate the statistical signiﬁcance of predicted events when we have
a control dataset. we compare the number of reads of the IP event to the
number of reads in the corresponding region in the control sample.

For non-overlapping events. we count the number of control reads in the
range of the empirical spatial distribution (:l:250 bp). For joint events. we
need to assign control reads to the corresponding events. We run the EM
algorithm without the sparse prior (no component elimination. equivalent to
ot:0) on the control data. initializing the events j at the same positions as
predicted IP events. The M step of EM algorithm is modiﬁed as

ﬂu) _ Ni _ ﬂ

. M _
J Zj/:11Vf/ N

where  : 221:1 y(z,, :j).

To account for differences between IP and control dataset sizes. we
multiply the control reads by a scaling factor. We divide long non-speciﬁc-
binding regions (deﬁned by excluding the ‘enriched regions”) into short
segments (length 10 Kb) and perform least-squares linear regression using
all the read count pairs of IP and control segments that have at least one
mapped fragment. The slope of the regression is then the scaling factor.
F113 /5. between the read counts from the IP and control (Kharchenko at al..
2008; Rozowsky at al.. 2009).

Using a statistical testing method proposed by Rozowsky at al. (2009).
we calculate the P-Value from the cumulative distribution function for the
binomial distribution using the corresponding IP and scaled control read
counts.

to
F(k.n,P) = Z  Pl (1 — P)”"
[:0

where k is the scaled control read count. n is ceiling of total count of IP
and scaled control reads. P:0.5. which is the probability under the null
hypothesis that reads should occur with equal likelihood from the IP as from
the control data.

To correct for multiple hypothesis testing. we apply a
BenjaminiiHochberg correction to adjust the P-Value (Benjamini and
Hochberg. 1995). All the predicted events that are tested for signiﬁcance
are ranked by P-Value from most signiﬁcant to least signiﬁcant. For each
event. the Q-Value is given by

COM”!

Q-value :P-value ><
ank

 

where count is the total number of events tested. Signiﬁcant events are then
selected using a Q-Value threshold.

If control data is not available. we apply a statistical test proposed by
Zhang et al. (2008) that uses a dynamic Poisson distribution to account
for local biases. The dynamic parameter of a local Poisson model for the
candidate event is deﬁned as

Masai =max0nBans kvalO kb)

where the Agg. 15 kb. 110k}, are A estimated from corresponding chromosome
(background). 5 kb or 10 kb window centered at the event location. to capture
the background variability at both global and local scales. The P-Value is
calculated to be the upper tail of the Poisson distribution.

"event—1
P-Value :1— Z Poi.v(n;Alocal)
n20
where new,“ is the read count of the candidate event. To correct for multiple
hypothesis testing. we apply a BenjaminiiHochberg correction as above.

2.6 Artifact ﬁltering

GPS ﬁlters the predicted events by computing the KullbackiLeibler
divergence (Kullback and Leibler. 1951) from the empirical read distribution

 

3030

112 /3.Io's[Bumo[pJOJXO'sonBuiJOJHrorqﬂ:duq mot} papeoprmoq

9103 ‘1gisn8nv 110::

Homotypic binding events at high spatial resolution

 

 

 

 _I rem-m

('iiniliiiuii 3

Mi

{‘uiulirinii Si

[‘umlitinn 1

_l/



 

\.'. r'i.
.-\l| r'r-Iiililiirlir- \.

 

 

 

t'IJ'Ilipullt'lllh

00.00.000.00

1n ~.-.i  | :r \ .‘-. _' "- -' 17.1 -o.. .--
.\. Y. .\

 

 

 

 

 

 

 

 

 

 

 

 

00.00.000.00 000000000000 OOOO0.00D.()()

Fig. 2. Probabilistic model for GPS event alignment.

to the read distribution of each predicted event,

emPU)
event(i)

 

DKL(emp ||event ) : Zemp(i)log

l

where event() is the distribution of non-zero read count of the event computed
from the EM algorithm, and emp() is the empirical read distribution with the
corresponding positions of the non-zero reads, 1' is the index of the non-zero
read positions.

Events with a KullbackiLeibler divergence value higher than a user
deﬁned threshold are discarded.

2.7 Event alignment across independent experiments

To align events across experiments, we ﬁrst apply the GPS model to the
combined data from all experiments to discover a global set of events, and
then use this global set of events to condition a modiﬁed version of GPS
for experiment speciﬁc event discovery (Fig. 2). Events from the global set
represent a superset of potential events for each experiment. Thus, we allow
only the 7: components corresponding to these global events to be non-zero
for the discovery of experiment speciﬁc events. A uniform initial weighting
is assigned to these possible events. Since the global set of events is sparse,
we do not use a sparse prior on 7: for each condition. The complete alignment
algorithm is described in the Supplementary Notes.

2.8 GPS has an efﬁcient implementation

We have implemented GPS in J ava, and our software is available for
download from our website (http://cgs.csail.mit.edu/gps).

For computational efﬁciency GPS independently processes separable
genomic regions. We identify separable regions with a conservative method
that spatially segments the genome at read gaps that are larger than the width
of empirical spatial distribution (500 bp) and further excludes regions that
contain fewer than six reads. The segmented protein binding regions are
typically a few thousand base pairs long.

To further reduce memory requirements and run time, GPS estimates
events in two stages for each region. In the ﬁrst stage, events are spaced
at 5 bp intervals to make a rough estimate of event locations. In the second
stage, events are spaced at 1 bp near locations predicted in the ﬁrst stage.

For the CTCF ChIP-Seq experiment in this study (~4.2 million IP reads
and ~7.9 million control reads), GPS requires 750 MB of main memory, and
runs for 21 min on an AMD 64-bit 2.3 GHz computer.

3 RESULTS

3.1 GPS predictions have higher spatial resolution

We analyzed the performance of GPS on ChIP-seq data proﬁling
the insulator binding factor CTCF (CCCTC-binding factor) (Chen
et al., 2008), as the strong CTCF motif allows us to reliably measure
spatial resolution. We used GFP ChIP-Seq data (Chen et al., 2008)
in the third phase of GPS to control for non-speciﬁc binding.

We found that the spatial resolution of GPS on the CTCF data
is superior to the spatial resolution produced by seven published
ChIP-Seq analysis methods (Fig. 3a, Supplementary Fig. 2): MACS
(Zhang et al., 2008), SISSRs (Jothi et al., 2008), cisGenome
(Ji et al., 2008), QuEST (Valouev et (11., 2008), FindPeaks
(Fejes et al., 2008), spp-wtd and spp-mtc (Kharchenko et al.,
2008). Because different methods predict different sets of binding
events (Supplementary Table 1), we limit our comparison to a
matched set of events. From the 34019 top ranking predictions
by each method, 7653 events are predicted by all eight methods
and correspond to the same high-scoring CTCF binding motif.
Of these matched events, 86.5% of the predictions by GPS
are within 20 bp of the CTCF binding motif, while between
65.2% and 75.9% of predictions by other methods are within
20 bp. GPS has an average spatial resolution of 11.08:l: 10.27 bp,
compared to 14.50:l:12.61bp for SISSRs, 16.07:l:12.29bp for
MACS, 16.66:l:14.20bp for cisGenome, 17.52:l:13.59bp for
QuEST, 15.22 :I: 11.47 for FindPeaks, 16.46 :I: 12.95 for spp-wtd and
16.08:l: 14.88 for spp-mtc. SISSRs, MACS and two spp methods
were shown to have better spatial resolution than seven other
methods in a recent performance evaluation (Wilbanks and Facciotti,
2010), and thus our analysis of CTCF data shows that GPS has
superior spatial resolution to these seven methods.

By evaluating the fraction of identiﬁed binding sites that
contain a CTCF binding motif, we found that GPS, MACS
and FindPeaks achieve higher speciﬁcity overall than the other
methods and GPS performs better for the high-ranking predictions
(Supplementary Fig. 3). GPS also achieves marginally better
sensitivity in discovering binding events that are supported by CTCF
binding motifs (Supplementary Fig. 4).

3.2 GPS discovers more joint events

Using synthetic data we found that GPS is able to detect more
joint events than other methods. We generated synthetic events by
placing ChIP-seq binding events from actual CTCF data at pre-
deﬁned intervals (Supplementary Notes). GPS detects 99.7% of j oint
events that are 200 bp apart, while SISSRs only detects 54.5—78.0%
of joint events that are 200—750bp apart, respectively. MACS and
QuEST detect joint events only when they are more than 280bp
apart. MACS detects 97.9% and QuEST detects 88.4% of joint
events when they are separated by 750 bp (Fig. 3b).

GPS is also able to predict more joint events than the other
methods we tested on actual ChIP-Seq data. For example, GPS
uniquely detects two CTCF events in mouse ES cells over
proximal CTCF motifs that are 99bp apart on chromosome 8
(Fig. 30). However, the CTCF dataset does not contain a sufﬁcient
number of joint events to effectively evaluate the methods on
a whole genome scale (Supplementary Table 2). We selected
a human Growth Associated Binding Protein (GABP) ChIP-
Seq dataset for our evaluation because GABP ChIP-Seq data

 

3031

112 /3.Io's[Bumo[pJOJXO'sonBuiJOJHrorqﬂ:duq mot} papeoprmoq

9103 ‘1gisn8nv 110::

KGuo et al.

 

(a)

 

   

 

 

 

100

g 80

S

E — GPS

W

“i; 60 — SISSRS

% 4D — cisGenome -

g — QuEST

O 20 — FindPeaks
— Spp—Md
— spp—mtg

0 i i i
C- 20 40 60 80 100

Spatial resolution (distance from CTCF motif)

 

CTCF motif t
GPS |
SISSRS

MACS |
cisGenome I
QuEST I
FindPeaks |
spp-Md I
spp-mic [

(b)

 

 

   

 

   
   

 

 

 

 

 

 

 

E

3 100-

5

§

2 80-

2

C

g 60-

d.)

E

.3. 40

g 20_ —SISSRS _
'E MACS

§ —QuEST
CD 0 l ,

n- 0 200 400 500 800

Distance between binding events (bp)

((1)

 

 
      
   
   

  

600 -
- GPS

50.0 _ - SISSRS _
- MACS

400 _ - cisGenome _
- QuEST

 

300 '

Count

200

100

 

 

1 2 >2
Number of GABP events called

Fig. 3. GPS improves the effective spatial resolution and accuracy in resolving proximal binding events. (3) Fraction of predicted CTCF binding events with
a motif within the given distance with event discovery by GPS, SISSRS, MACS, cisGenome, QuEST, FindPeaks, spp-wtd and spp-mtc. Events shown were
predicted by all eight methods and had a CTCF motif within 100 bp. (b) Fraction of binary events recovered vs. the distance between the generated synthetic

events for GPS, SISSRS, MACS and QuEST. (c) Example of a predicted binary CTCF event that contains coordinately located CTCF motifs. (d) Number of

GABP events discovered by GPS, SISSRS, MACS, cisGenome, and QuEST in regions that contain clustered GABP motifs within 500 bp.

were previously reported to contain joint events (Lun et al.,
2009; Valouev et al., 2008). We identiﬁed 581 candidate sites
of joint events that all had at least one event detected by all
ﬁve methods and where each site contains two or more GABP
motifs separated by <500 bp. GPS identiﬁed joint events in 122
candidate sites, while SISSRs and QuEST detected joint events at
fewer than 83 of the candidate sites, and MACS and cisGenome
only identiﬁed 3 and 5 of the candidate sites as containing
joint events respectively (Fig. 3d). In addition, we compared
GPS with CSDeconv on a 2Mb region of GABP ChIP-Seq data
that CSDeconv could process (Lun et al., 2009). GPS found
four joint events with clustered GABP motifs while CSDeconv
found two joint events (Supplementary Table 3 and Supplementary
Fig. 5).

3.3 GPS aligns events across multiple experiments

Because transcription factors bind at sequence-speciﬁc sites, we
would expect them to bind at the same genome location in different

conditions. We have generalized the GPS model to optionally align
events across multiple experiments by considering the data from
independent experiments simultaneously. In alignment mode, a
global mixture component biases events to be aligned, and also
provides improved spatial resolution for events that are shared by a
collection of experiments (Supplementary Fig. 6). In addition, event
alignment across experimental conditions provides a straightforward
way to detect events that are lost and gained between experimental
conditions.

We performed GPS in multicondition alignment mode using
human CTCF ChIP-Seq data from two different cell types
(GM12878, HUVEC) produced by the ENCODE project (Bimey
et al., 2007) and determined the distribution of the distances between
all the events across conditions. We limit our evaluation to a distance
range of <500 bp because events outside of this window are likely to
involve independent sites. Within this window, GPS aligns 45.5%
of the events to be at the same genomic position (Fig. 4a). The
presence of closely spaced unaligned events (Fig. 4a) demonstrates
that GPS alignment does not force all the proximal events across

 

3032

112 /3.IO'SIBIIII’IOprOJXO'SOIJBLUJOJIIIOIq”Idllq mot} papeoprmoq

9103 ‘1gisn8nv 110::

Homotypic binding events at high spatial resolution

 

 

 

 

 

 

 

 

 

 

(a) 0.45

a, 0.1 '

E

(D

:-

CD

“6

c 0.05

.9

e

t 0 r—v—I—I_I_I_I_I_I_I_I_I -I_I—I_I_I_I_I_I—I—I_I_I—r-l_t—r-l_l
0 100 200 300 400 500
Distance between events across conditions

('3)

m 0.1-

E

(D

:- _

m _

“6

C 0.05

.9

S

9

LL 0
0 100 200 300 400 500

Distance between events across conditions

Fig. 4. GPS in alignment mode. (3) Histogram of distance between predicted
human CTCF events across two conditions shows that GPS in alignment
mode aligns proximal events while continuing to discover separated discrete
events. (b) Histogram of distance between predicted CTCF events across
two conditions when GPS is run independently on each condition.

conditions to be aligned. When GPS was performed on data from
both cell types independently, only 13.7% of events are within
10 bp, and about 30—40% of the event distances are in the range
of 10—100bp (Fig. 4b). This suggests that events occurring at the
same genomic position in two conditions are likely to be predicted
to occur at different locations with independent event discovery.
Thus the alignment mode of GPS provides a simple way to recognize
events that are gained and lost in a particular condition.

4 DISCUSSION

GPS is a novel computational method that uses a probabilistic
mixture model to predict the most likely positions of binding events
at single-base resolution based on a characteristic spatial distribution
of reads. Our analysis with synthetic and actual ChIP-Seq data
demonstrates the value of our approach in resolving closely spaced
joint events and improving event spatial resolution.

GPS’s ability to resolve homotypic events from ChIP-Seq data
will facilitate the genome-wide study of cooperative binding on gene
expression under speciﬁc biological conditions. Homotypic binding
sites have been shown to act as key components of invertebrate
and mammalian promoters and enhancers (Gotea et al., 2010;
Lifanov et al., 2003). In addition, modeling based approaches have
demonstrated that identifying homotypic binding is important for the
faithful reproduction of biological behaviors (Segal et al., 2008).

GPS also provides improved spatial resolution, speciﬁcity, and
sensitivity when compared with contemporary methods. The high
spatial resolution of GPS can be used to produce a position-
speciﬁc prior (Bailey et al., 2010; Narlikar et al., 2006) that

can be used by motif discovery methods to limit motif search
to tight genomic regions around events (Supplementary Notes,
Supplementary Fig. 8), or can exclude event locations for co-factor
motif discovery.

In addition, we expect that alternative empirical read distributions
can be used for different kinds of events, such as histone location, as
the GPS framework is inherently adaptable to other empirical read
distributions.

ACKNOWLEDGEMENTS
We thank A. Rolfe and C. C. Reeder for many helpful discussions.

Funding: National Institutes of Health (5R01HG002668, P01-
NS055923 and 1-UL1-RR024920 to D.K.G.).

Conﬂict of Interest: none declared.

REFERENCES

Bailey,T.L. et al. (2010) The value of position-speciﬁc priors in motif discovery using
MEME. BMC Bioinformatics, 11, 179.

Barski,A. et al. (2007) High-resolution proﬁling of histone methylations in the human
genome. Cell, 129, 8237837.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. Roy. Statist. Soc. Ser B, 57, 2897300.

Bicego,M. et al. (2007) Sparseness achievement in hidden Markov models. Proceedings
of the I 4th International Conference on Image Analysis and Processing (ICIAP
2007). IEEE Computer Society, Modena, pp. 67772.

Bimey,E. et al. (2007) Identiﬁcation and analysis of functional elements in 1% of the
human genome by the ENCODE pilot project. Nature, 447, 7997816.

Chen,X. et al. (2008) Integration of external signaling pathways with the core
transcriptional network in embryonic stem cells. Cell, 133, 110671117.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. Roy. Stat. Soc. Ser. B, 39, 1.

Fejes,A.P. et al. (2008) FindPeaks 3.1: a tool for identifying areas of enrichment
from massively parallel short-read sequencing technology. Bioinformatics, 24,
172971730.

Figueiredo,M.A.T. and Jain,A.K. (2002) Unsupervised learning of ﬁnite mixture
models. IEEE Trans. Pattern Anal. Mach. Intelligence, 24, 3817396.

Gotea,V. et al. (2010) Homotypic clusters of transcription factor binding sites are a key
component of human promoters and enhancers. Genome Res, 20, 5657577.

Ji,H. et al. (2008) An integrated software system for analyzing ChIP-chip and ChIP-seq
data. Nat. Biotechnol., 26, 129371300.

Johnson,D.S. et al. (2007) Genome-wide mapping of in vivo protein-DNA interactions.
Science, 316, 149771502.

Jothi,R. et al. (2008) Genome-wide identiﬁcation of in vivo protein-DNA binding sites
from ChIP-Seq data. Nucleic Acids Res., 36, 522175231.

Kharchenko,P.V. et al. (2008) Design and analysis of ChIP-seq experiments for DNA-
binding proteins. Nat. Biotechnol, 26, 135171359.

Kullback,S. and Leibler,R.A. (1951) On information and sufﬁciency. Ann. Math. Stat,
22, 79786.

Laajala,T.D. et al. (2009) A practical comparison of methods for detecting transcription
factor binding sites in ChIP-seq experiments. BMC Genomics, 10, 618.

Lifanov,A.P. et al. (2003) Homotypic regulatory clusters in Drosophila. Genome Res,
13, 5797588.

Lun,D.S. et al. (2009) A blind deconvolution approach to high-resolution mapping of
transcription factor binding sites from ChIP-seq data. Genome Biol., 10, R142.
Narlikar,L. et al. (2006) Informative priors based on transcription factor structural class

improve de novo motif discovery. Bioinformatics, 22, e38Le392.

Park,P.J. (2009) ChIP-seq: advantages and challenges of a maturing technology.
Nat. Rev. Genet, 10, 6697680.

Pepke,S., Wold,B. and Mortazavi,A. (2009) Computation for ChIP-seq and RNA-seq
studies. Nat. Methods, 6, 5227532.

Robertson,G et al. (2007) Genome-wide proﬁles of STATl DNA association using
chromatin immunoprecipitation and massively parallel sequencing. Nat. Methods,
4, 6517657.

Rozowsky,J. et al. (2009) PeakSeq enables systematic scoring of ChIP-seq experiments
relative to controls, Nat. Biotechnol, 27, 6&75.

 

3033

112 /3.Io's[BumoprOJXO'soneuiJOJHrorq”:duq mot} papeoprmoq

9103 ‘1gisn8nv 110::

KGuoetaL

 

Segal,E. et al. (2008) Predicting expression patterns from regulatory sequence in
Drosophila segmentation. Nature, 451, 5357540.

Valouev,A. et al. (2008) Genome-wide analysis of transcription factor binding sites
based on ChIP-Seq data. Nat. Methods, 5, 8297834.

Wilbanks,E.G. and Facciotti,M.T. (2010) Evaluation of algorithm performance in ChIP-
seq peak detection. PLoS One, 5, e11471.

Zhang,Y. et al. (2008) Model-based analysis of ChIP-Seq (MACS). Genome Biol., 9,
R137.

 

3034

112 /3.Io's[BumoprOJXO'soneuiJOJHrorq”:duq mot} papeoprmoq

9103 ‘1gisn8nv 110::

