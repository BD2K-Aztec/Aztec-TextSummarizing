Bioinformatics, 32(4), 2016, 632—634

doi: 10.1093/bioinformatics/btv617

Advance Access Publication Date: 27 October 2015
Applications Note

 

 

Systems biology

caRpools: an R package for exploratory data
analysis and documentation of pooled
CRISPR/CasQ screens

Jan Winter”, Marco Breinig”, Florian Heigwer1, Dirk Briigemann1,
Svenja Leible1, Oliver Pelz1, Tianzuo Zhan1'2 and Michael Boutros1'*

1German Cancer Research Center (DKFZ), Division Signaling and Functional Genomics and Heidelberg University,
Heidelberg, Germany and 2Department of Medicine II, University Hospital Mannheim, Medical Faculty Mannheim,
Heidelberg University, Mannheim, Germany

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
Associate Editor: Jonathan Wren

Received on August 19, 2015; revised on October 13, 2015; accepted on October 16, 2015

Abstract

Motivation: Genetic screens by CRISPR/CasQ—mediated genome engineering have become a
powerful tool for functional genomics. However, there is currently a lack of end—to—end software
pipelines to analyze CRISPR/Cas9 screens based on next generation sequencing.

Results: The CRISPR—AnalyzeR for pooled screens (caRpools) is an R package for exploratory data
analysis that provides a complete workflow to analyze CRISPR/Cas9 screens. To further support
the analysis of large—scale screens, caRpools integrates screening documentation and generation
of standardized analysis reports.

Availability and implementation: caRpools, manuals and an open virtual appliance are available at

http://github.com/boutroslab/caRpooIs.
Contact: m.boutros@dkfz.de

 

1 Introduction

CRISPR/Cas9—mediated genome engineering can be leveraged for
high—throughput functional genomic screens in vertebrate cells
(Koike—Yusa et (11., 2014; Shalem et (11., 2014; Wang et (11., 2014).
For such screens, Cas9—expressing cells are infected with lentiviral
short guide (sg) RNA libraries. After phenotypic selection, ngNA
sequences serve as barcodes to identify enriched or depleted mutant
clones by next generation sequencing (NGS). Inter—experimental
variations in sequencing quality and depth, variable ngNA cover—
age per gene, on—target efficiency and off—target effects represent
challenges for analysis and hit identification (Diaz et (11., 2015; Li
et (11., 2014). The software package CRISPR—AnalyzeR for Pooled
Screens (caRpools) performs exploratory data analysis of CRISPR/
Cas9 screens combined with detailed screening documentation to
enable reproducibility of analyses workflows (Boutros et (11., 2006;
Pelz et (11., 2010).

2 The caRpools package

The R package caRpools is available as Source code and an open vir—
tual appliance from a public Github repository at http://github.c0m/
boutroslab/caRpools, which provides a convenient way to analyze
screens without much prior R knowledge. Parameters relevant to
caRpools’ analysis options are adjusted via an Excel file. We provide
a manual to guide users through the installation and running steps.
To showcase caRpools’ functionalities, we supply example datasets
and reports for an unpublished CRISPR/Cas9 screen and caRpools re—
ports for two published screens (Shalem et (11., 2014; Wang et (11.,
2014) (see http://github.com/boutroslab/caRpools). caRpools is based
on an end—to—end workﬂow composed of four modules (Fig. 1).

2.1 Data handling and quality control
caRpools requires a FASTA file with ngNA identifiers and se—
quences, FASTQ or processed ngNA readcount files of samples,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 632

9103 ‘Og JSanV 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /3.10'speum0fp1q1x0"sotJBurJOJutotq/ﬁduq 11101} popcolumoq

CRISPR/CasQ screen analysis

633

 

MIACCS-Fiie. Rmd Templates, FASTQ r' Read-Count Files
7

SETUP QUALITY CONTROL

BETA HANDLIN DITA VISUALIZATIDN

HIT ANALYSIS REPORT

DATA VISUILIZATIDN DATE SUMMARY

 

V 7
Data Extratlion, Mapping Automatic Annotation Data Statistics, Reacicnunt Distribution,
Sequencing Depth, Replicate Quality
‘7

1

bowiiez mapping Tables. Bat Plots, Scatter Plots

I

 

T
C

_
Hill" “is”
E

 

biomaRt:

Hiene_lD 0 ENSEMBLID
i Gu-Ttarrn annotation
Hinltto ENSEMBL

Hink to Genetards

 

:\_I_'L:J‘_
-il l

 

 

Tables, Venn Diagrams. Scatter Plots. Bar Plots. it'iolin Plots

7 7
Different Hit Calling Methods, Analysis Comparison. HTML ngf max
{andiciate Visualization. ngNA Deconvolution

V V

Descriptions, Figures. Tables

 

 

I BM

can: , Bu.
'- ENSEMBLJDiIInl-smirlwmblj FNSﬁﬂEﬂmDNIHRN

' v k' ' HENC SI‘MDDLUInumGeneumm EM
GENE DESDEP'HON
' Etliissntlatied it protein

BOTERM

 

 

 

 

mandarin! ulapapmi: pmcﬂs

 

/
’/// 9'“ “HMS ENSEMBL racism in

/
a 0// Eusmnonoasru
- /
warm: parakeet contra-roe

/ /. DESaqz swaluu: LS‘BB‘BSTI-Za
07/ MMecK p—‘iralue! omms
/ /./

 

 

 

 

 

 

 

Fig. 1. caRpools workflow and functionalities. Schematic representation of main analysis steps for the analysis of CRISPR/CasQ screens using caRpools are

shown

template files for report generation, and a parameter and screen
description file.

caRpools retrieves analysis parameters from a configuration file,
which has been adapted from MIARE (http://miare.sourceforge.net/)
and supports documentation of screens and analysis steps. File paths
for datasets, and parameters required for ngNA target sequence re—
trieval from FASTQ files and hit calling must be entered. Further,
this file includes general information about screening protocols and
settings to e.g. adjust visualizations or to annotate genes with infor—
mation retrieved from biomaRt. Upon execution, caRpools provides
diagnostic plots to evaluate screening performance, including read—
count distribution and sequencing depth plots for each sample,
as well as ngNA coverage and evaluation of included control
ngNAs.

2.2 Hit calling and report generation

caRpools offers three methods to rank candidate genes based on the
phenotypic effect of all ngNAs per gene with orthogonal approaches
(see CaRpools—Manual.pdf). For the ‘Wilcox’ approach, read counts
are median normalized. The fold change of each population of
ngNAs for a gene is tested against the population of non—targeting
control ngNAs or randomly picked ngNAs, using a two—sided
Mann—Whitney test. For the ‘DESeq2’—approach, read counts of all
ngNAs for a given gene are aggregated to generate gene—level read
counts. DESeq2 analysis includes size—factor estimations, variance sta—
bilization using a parametric fit and a Wald—Test to determine the dif—
ference in log fold changes between the untreated and treated data,
essentially as described (Li et 41]., 2014; Love et 41]., 2014). For the
‘MAGeCK’—approach, a rank—based model is used to test for a change
in ngNA abundance after median normalization of the dataset (Li
et 41]., 2014). Users are asked to familiarize themselves with the speciﬁ—
cations and parameter settings of each method by consulting the
caRpools user manual and the original literature (Love et 41]., 2014;
Li et 51]., 2014).

Venn diagrams containing enriched or depleted genes are gener—
ated for direct comparison and can reveal differences between hit
calling methods. Potential pitfalls, e.g. no identified hits with a
defined threshold, or no overlap between methods are reported. Hits
are visualized with annotations as well as links to external

databases. Since ngNA efficiency can vary (Diaz et 41]., 2015; Li
et 41]., 2014; Shalem et 41]., 2014; Wang et 41]., 2014), caRpools visu—
alizes the performance of all ngNAs/gene and lists respective target
sequences for all candidates so that users can choose efficient
ngNAs. caRpools supports standardized report generation includ—
ing ready—to—use plots and tables in a single step.

2.3 Summary and outlook

caRpools is designed to be user—friendly for novice and expert
users: caRpools’ open virtual appliance allows analysis without prior
programming knowledge. For every hit, caRpools provides biological
information and links to external databases. Finally, caRpools incorp—
orates detailed screening documentation into the analysis process
and generates comprehensive reports. caRpools can be extended to
e.g. include novel hit calling algorithms or to export efficient ngNA
designs to external databases such as Protospacer Workbench
(MacPherson and Scherf, 2015). caRpools’ transparent analysis re—
ports support the establishment of repositories for CRISPR/Cas9
screens and will facilitate meta—analyses of datasets.

Acknowledgement
We thank F. Zhang and T. Wang for reagents and data.

Funding

This work was supported in part by an ERC Advanced Grant, an iMED grant
and a DKFZ Postdoc Fellowship to T.Z.

Conﬂict of Interest: none declared.

References

Boutros,M. et al. (2006) Analysis of cell—based RNAi screens. Genome Biol.,
7, R66.

Diaz,A.A. et al. (2015) HiTSelect: a comprehensive tool for high—complexity—
pooled screen analysis. Nucleic Acids Res, 43, e16.

Koike—Yusa,H. et al. (2014) Genome—wide recessive genetic screening in mam—
malian cells with a lentiviral CRISPR—guide RNA library. Nat. Biotechnol.,
32, 267—73.

910g ‘09 isanV 110 seteﬁuv $01 ‘etHJOJtIBQ JO [firms/tin f] 112 /310'S[BIIJHO[pJOJXO'SOTIBLUJOJIITOTCIHIdllq 11101} popcorn/neg

634

J. Winter et aI.

 

Li,W. et al. (2014) MAGeCK enables robust identiﬁcation of essential genes
from genome—scale CRISPR/Cas9 knockout screens. Genome Biol., 15, 554.

Love,M.I. et al. (2014) Moderated estimation of fold change and dispersion
for RNA—seq data with DESeq2. Genome Biol., 15, 550.

MacPherson,C.R. and Scherf,A. (2015) Flexible guide-RNA design for CRISPR
applications using Protospacer Workbench. Nat. Biotechnol., 33, 805—806.

Pelz,O. et al. (2010) web cellHTSZ: a web-application for the analysis of high—
throughput screening data. BMC Bioinformatics, 11, 185.

Shalem,O. et al. (2014) Genome-scale CRISPR-Cas9 knockout screening in
human cells. Science, 343, 84—87.

Wang,T. et al. (2014) Genetic screens in human cells using the CRISPR-Cas9
system. Science, 343, 80—84.

9103 ‘Org isanV 110 seteﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 /310'srcu1n0[p103x0"soticuiJOJutotq/ﬁduq 11101} popcorn/nag

