Bioinformatics, 32(9), 2016, 1405—1407

doi: 10.1093/bioinformatics/btv727

Advance Access Publication Date: 5 January 2016
Applications Note

 

Sequence analysis

VIRALpro: a tool to identify viral capsid and

tail sequences

Clovis Galiez"*, Christophe N. Magnanz, Francois Coste1 and

Pierre Baldi2'*

1INRIA, Campus De Beaulieu, Rennes Cedex, 35042, France and 2Department of Computer Science and Institute
for Genomics and Bioinformatics, University of California, Irvine, Irvine, CA 92697, USA

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on 11 August 2015; revised on 24 November 2015; accepted on 7 December 2015

Abstract

Motivation: Not only sequence data continue to outpace annotation information, but also the prob—
lem is further exacerbated when organisms are underrepresented in the annotation databases.
This is the case with non—human—pathogenic viruses which occur frequently in metagenomic pro—
jects. Thus, there is a need for tools capable of detecting and classifying viral sequences.

Results: We describe VIRALpro a new effective tool for identifying capsid and tail protein
sequences, which are the cornerstones toward viral sequence annotation and viral genome

classification.

Availability and implementation: The data, software and corresponding web server are available
from http://scratch.proteomics.ics.uci.edu as part of the SCRATCH suite.

Contact: clovis.ga|iez@inria.fr or pfbaldi@uci.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

As of April 2015, 77% of the protein sequences referenced in
UniProtKB/TrEMBL (Magrane and Consortium, 2011) are pre-
dicted protein sequences. For the non—predicted sequences, only 2%
have been confirmed through biological evidence while the remain—
ing 21% is inferred by homology and this imbalance will continue
to worsen in the foreseeable future. The situation is even worse for
specific classes of important organisms, in particular viruses the ma—
jority of which lack proper annotation. For instance, it is typical to
encounter only 10% of annotated sequences in marine viral samples
(Holmfeldt et (11., 2013; Hurwitz and Sullivan, 2013; Suttle, 2007),
although these viruses play key roles in the ecosystem. It is for in—
stance estimated that marine viruses kill up to 20% of the living bio—
mass in the oceans daily, and this organism turnover may play a
major role in the global carbon cycle (Lehahn et (11., 2014). In short,
new computational tools are needed to help identify and annotate
unknown viral sequences.

One criterion for virus classification is the genomic organization
and sequence of the genes coding for structural proteins—i.e. the
proteins that compose the virion, in particular capsid and tail pro—
teins. Capsid proteins in particular are present in all viral genomes
and, as suggested in Seguritan et al. (2012), the capsid genes may be
used as an equivalent of 16S rRNA for prokaryote identification in
genomes and metagenomes.

Previously, a tool called iVireons (Seguritan et (11., 2012) has been
introduced to detect structural proteins in phages—Le. viruses that in—
fect bacteria. The tool uses a single input—the average amino acid
composition of the query sequence—which is fed into three classifica—
tion neural networks: one for all structural proteins, one for tail pro—
teins and one for capsid proteins. As stated by the authors, the tool
performs well at detecting phage capsids, but its performance de—
grades when used to detect capsids in other viruses. The structural
protein predictor has a reasonable sensitivity to all capsids, but its spe—
cificity is too low. To address these problems we develop VIRALpro

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1405

 

91oz ‘Og JSanV uo salaﬁuv soq ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /3.10'speum0[p1q1x0"sothJJOJutotq/ﬁduq 11101} popcolumoq

1406

C. Galiez et aI.

 

using Support Vector Machines (SVM) and extended set of features to
identify capsid (CAPSIDpro) and tail (TAILpro) sequences.

2 Methods

Data

We built a dataset of, respectively, 2648 and 483 non—redundant
capsid and nucleocapsid sequences. The non—capsid sequences were
randomly chosen from the phage non—structural sequences
(Seguritan et (11., 2012) and from the NCBI protein database by
querying for non—phage, non—structural, proteins (see Supplementary
materials). When merging this set of sequences with the training set
of iVireons MCP1:1 denoted by chaPsid, we obtained 3888 positive
and 4071 negative sequences. We refer to the resulting dataset as
Cpromin, Using the same process, we built a dataset of 1719 posi—
tives tail sequences and when merged with the training set of
iVireons tail 1:1 ANN, we obtained 2574 positive and 4095 nega—
tive tail sequences. We refer to the resulting dataset as Tpromin, We
denote by inest the test set of phage protein sequences described in
Seguritan et al. (2012). We used 10—fold cross validation on the
training sets to assess performance. For each training set, one of the
folds is used as the validation set to produce the plots in Figure 1.

A _ B

new

   

N — GAPSIDpro a.
0' iVireons s1ructural
—A— Nlreuns MCPH

— TAILpro
+ IViraonsstmclural
—é-— iVireonsTail::1

«an

   

     

— CAPSIme
— CAFSIDpro . ,

 

 

 

g a  iVireons structural
'6 iVireons structural —é-— iVireons MCPH
a —é-— iVireons MCP111 a -El- BLAST
a: oz 04 on u .n no 02 . M u
mm hIQiI

Fig. 1. ROC curves on the validation sets of (A) CAPSIDpro; (B) TAILpro; (C)
CAPSIDpro when removing all non-phage sequences from the positive set;
and (D) CAPSIDpro when keeping only sequences that have no homology to
the training set

Table 1. Performance metrics for iVireons and CAPSIDpro

Features

To identify capsid or tail protein sequences, we use the average
amino acid composition (20 features) as well the average secondary
structure composition (three features), as predicted by SSpro
(Magnan and Baldi, 2014). In addition, we built 3380 Profile
Hidden Markov Models (HMMs) to locally probe the sequences.
These HMMs are built using HMMER (Eddy, 2009) from multiple
sequence alignment of contact fragments of capsid proteins—which
are essentially pairs of fragments that are close in the tertiary struc—
ture (see Supplementary materials) and whose structure has been
shown to be well conserved even for distantly related homologs
(Galiez and Coste, 2015). The e—values of the different HMMs are
linearly combined using coefficients that are obtained using the
RankBoost algorithm (Freund et (11., 2003). Finally, the HMMs yield
three features: the boosted linear combination of HMM e—values,
the e—value of the best HMM hit and the number of HMM hits
(e—value of 10 or better). Finally, we train an SVM (Chang and Lin,
2011) with these 26 features.

3 Results

Figure 1 shows the receiver operating characteristic (ROC) curves of
VIRALpro and iVireons on various validation sets. VIRALpro pro—
vides a significant detection improvement in all cases, even when re—
stricted to phage proteins only. The improvement is particularly
pronounced in the case of difficult sequences with no homology to
the training sets (e—value $0.001) where the performance of BLAST
or iVireons degrades to levels close to random—the area under the
curve (AUC) of the ROC curve is 54.9 and 61.5%, respectively.
These results are further confirmed using various performance met—
rics given in Table 1 for CAPSIDpro. Similar results are obtained for
TAILpro (see Supplementary materials).

Finally, we tested VIRALpro on the unannotated portion of
three metagenomic sequence datasets: (1) RNA viruses from coastal
seawater in British Columbia (Culley et (11., 2006; RnaCoastal); (2)
marine phages from Baltic seawater (Oresund); and (3) marine
phages sequenced by the Broad Institute under the Gordon and
Betty Moore Foundation’s ‘Marine Phage, Virus and Virome
Sequencing’ project (Moore) (see Supplementary materials).
RnaCoastal and Oresund—Struct have 0% of their sequences that
share any homology with our positive training set. Oresund—Hypo,
Oresund—NonStruct and Moore have, respectively, 0.2, 1.3 and
1.8% of their sequences that share some homology (e—value $0.001)
with our positive training set. Table 2 provides the recall obtained
using VIRALpro. Interestingly, TAILpro detects some sequences in
RnaCoastal, suggesting that these may be fiber proteins that may
confirm the presence of rotaviruses in the sample, as suggested in
Culley et al. (2006). In short, VIRALpro clearly outperforms

 

 

Test Measure iVireons MCP 1:1 iVireons Structural CAPSIDpro
iVmst Accur. 90% 80% 97.3% *
10—fold chapsid Accur. 91.3% — 963’“ i 2.5%
10—fold Cpromin AUC 73.9 i 2.4% 85.1 i 2.1% 95.9 1 0.8%
F—Meas. 51.1 i 2.6% 77.9 i 2.5% 89.5 i 1.5%
Validation Set AUC 76% 87.1 % 96.8%4r
F—Meas. 51.7% 79.5% 91.3%4r

 

Since the fold distribution for iVireons is not publicly available, a ‘* indicates that CAPSIDpro was trained with iVmpsgd to be as close as possible to the training
of iVireons MCPlzl. Tests on the validation set, where CAPSIDpro has been trained only on the remaining 90% of the training data, are indicated by a I. Best

results are shown in bold.

91oz ‘Og isnﬁnv uo salaﬁuv soq ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /3.10'speum0[p1q1x0"sothJJOJutotq/ﬁduq 11101} popcolumoq

Tool to identify viral capsid and tail sequences

1407

 

Table 2. Recall on the metagenomic sequences annotated as
unknown

 

 

Dataset Recall CAPSIDpro (%) Recall TAILpro (%)
RnaCoastal (86) 40.7 22.1
Oresund—Struct (85) 36.5 47.1
Oresund—Hypo (524) 22.0 10.1
Oresund—NonStruct (15 6) 1 2.8 8 .3
Moore (1172) 33.8 27.4

 

The total number of sequences is given in parentheses

existing tools for predicting capsid and tail proteins and can be used
as a screening tool in metagenomic and other projects.

Funding

The work of C.G. was completed at UCI and has been supported by travel
grants from Rennes Metropole and Inria Explorer. The work of C.M. and
RB. has been supported by grants NIH LM010235 and NSF-IIS—1321053 to
PE. We also thank Yuzo Kanomata for helping set up the VIRALpro server.

Conﬂict of interest: none declared.

References

Chang,C.C. and Lin,C.J. (2011) Libsvm: a library for support vector ma-
chines. ACM Trans. Intell. Syst. Technol., 2, 27:1—27:27.

Culley,A.I. et al. (2006) Metagenomic analysis of coastal RNA virus commun-
ities. Science, 3 12, 1795—1798.

Eddy,S.R. (2009) A new generation of homology search tools based on prob-
abilistic inference. In: Proceedings of the 20th International Conference on
Genome Informatics 2009, Imperial College Press, pp. 205—21 1.

Freund,Y. et al. (2003) An efﬁcient boosting algorithm for combining prefer-
ences. ]. Mach. Learn. Res., 4, 933—969.

Galiez,C. and Coste,F. (2015) Structural conservation of remote homologues:
better and further in contact fragments. In: ISMB/ECCB 2015 Satellite
Meeting—3DSIG: Structural Bioinformatics and Computational
Biophysics, Dublin, Ireland.

Holmfeldt,K. et al. (2013) Twelve previously unknown phage genera are ubi—
quitous in global oceans. Proc. Natl Acad. Sci., 110, 12798—12803.

Hurwitz,B.L. and Sullivan,M.B. (2013) The paciﬁc ocean Virome (pov): a mar-
ine viral metagenomic dataset and associated protein clusters for quantita—
tive viral ecology. PLoS One, 8, e5 7355 .

Lehahn,Y. et al. (2014) Decoupling physical from biological processes to
assess the impact of viruses on a mesoscale algal bloom. Curr. Biol., 24,
2041—2046.

Magnan,C.N. and Baldi,P. (2014) SSpro/ACCpro 5: almost perfect prediction
of protein secondary structure and relative solvent accessibility using
proﬁles, machine learning and structural similarity. Bioinformatics, 30,
25 92—25 97.

Magrane,M. and Consortium,U. (2011) Uniprot knowledgebase: a hub of
integrated protein data. Database, 2011, bar009.

Seguritan,V. et al. (2012) Artiﬁcial neural networks trained to detect viral and
phage structural proteins. PLoS Comput. Biol., 8, e100265 7.

Suttle,C.A. (2007) Marine viruses major players in the global ecosystem. Nat.
Rev. Microbiol, 5, 801—812.

9103 ‘Og isanV uo sajaﬁuv soq ‘Btulomcg JO AJtSJQAtuf] 112 /3.10'speum0[p1q1x0"sothJJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

