Bioinformatics, 32(14), 2016, 2216—2218

doi: 10.1093/bioinformatics/btw215

Advance Access Publication Date: 22 April 2016
Applications Note

 

Structural bioinformatics

CaFE: a tool for binding affinity prediction using
end-point free energy methods

Hui Liu and Tingjun Hou*

College of Pharmaceutical Sciences, Zhejiang University, Hangzhou, Zhejiang 310058, China

*To whom correspondence should be addressed.
Associate Editor: Burkhard Rost

Received on January 21, 2016; revised on March 23, 2016; accepted on April 14, 2016

Abstract

Summary: Accurate prediction of binding free energy is of particular importance to computational
biology and structure—based drug design. Among those methods for binding affinity predictions,
the end—point approaches, such as MM/PBSA and LIE, have been widely used because they can
achieve a good balance between prediction accuracy and computational cost. Here we present an
easy—to—use pipeline tool named glculation of free Energy (CaFE) to conduct MM/PBSA and LIE
calculations. Powered by the VMD and NAMD programs, CaFE is able to handle numerous static
coordinate and molecular dynamics trajectory file formats generated by different molecular simu—
lation packages and supports various force field parameters.

Availability and implementation: CaFE source code and documentation are freely available under
the GNU General Public License via GitHub at https://github.com/huiliucode/cafe_p|ugin. It is a
VMD plugin written in Tcl and the usage is platform—independent.

Contact: tingjunhou@zju.edu.cn

 

1 Introduction

Accurate estimation of binding affinity (alternatively, binding free
energy) is among the most attractive and challenging topics in both
computational biology and computer—aided drug design (CADD)
(Chipot, 2014). On one hand, noncovalent association is ubiquitous
and essential in the cell machinery. It is involved in the processes of
enzymatic catalysis, signal transduction, molecular recognition and
receptor activation. Knowledge of the thermodynamic basis of asso—
ciation at the molecular level provides insights into the underlying
mechanisms of various biological phenomena. On the other hand,
from a pharmaceutical point of view, the major goal of drug design
and discovery is to identify new chemical entities with high affinity
to a certain pharmaceutical target. Obviously, these research fields
would benefit from reliable methods for estimating binding affinity.
A number of computational methods have been proposed to pre—
dict binding free energy. There are some theoretically rigorous ones
based on statistical mechanics; however, these methods are time—
consuming and thus their applications in real—life CADD are limited.
Another kind of approaches frequently used is so—called scoring
functions. They are often embedded in molecular docking programs,

for which simplicity and speed are generally required; however, it
usually comes with the loss of accuracy. The third type of free en—
ergy prediction methods is referred to as end—point methods, which
sample conformations only with the free and bound states and get
binding free energy by taking a difference between these states.
These methods can reach a good balance between accuracy and effi—
ciency (Hou et 111., 20113, b).

2 Overview of CaFE

We developed a program named Calculation of Free Energy (CaFE)
to automatically conduct binding affinity prediction with end—point
methods. In CaFE, two most popular end—point methods are incor—
porated, namely, the molecular mechanics Poisson—Boltzmann sur—
face area (MM/PBSA) (Kollman et (11., 2000) and the linear
interaction energy (LIE) (Aqvist et (11., 1994) methods. Some tools
are already available for conducting these two types of calculations
(Case at 111., 2005; Homeyer and Gohlke, 2013; Kumari et (11., 2014;
Lill and Danielson, 2011; Miller et (11., 2012). However, most of
them are specifically designed for processing the topology and

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2216

 

9103 ‘Org rsnﬁnv 110 salaﬁuv soc] ‘BtHJOJtIBQ JO ArtsraAtuf] 112 /310'S[BIIJHO[pJOJXO'SODBLUJOJIHOICIHK1111] 11101} popcolumoq

CaFE

2217

 

trajectory files that are used by the AMBER or GROMACS pack—
ages and are focused on the usage of AMBER—related force field par—
ameters. To date, there are no freely available pipeline tools that can
be directly used to deal with the files (PSF and DCD file formats)
generated by the CHARMM/NAMD software as well as others
using the same file system. CaFE is designed to fill the gap.
Compared with them, CaFE is capable of handling a variety of co—
ordinate and trajectory files produced by different molecular simula—
tion programs. Although files produced by different programs can
be interconverted by using additional conversion tools, the CaFE
program provides a simple solution to facilitate the setup of end—
point free energy calculations by rendering such a file format conver—
sion unnecessary. All of the post—processing and calculations are
automated by a simple command without additional procedures,
from which users in the field of CADD who often have quite a few
samples to be evaluated would benefit a lot. Different types of force
field parameters can be used in CaFE. This is powered by NAMD
(Phillips et al., 2005), which is employed by CaFE as the back—end
molecular mechanical engine. In addition, some optimized atom ra—
dius sets (Banavali and Roux, 2002; Nina et al., 1997; Sitkoff et al.,
1994) are embedded for MM/PBSA calculations.

By using the Tcl/T k scripting interface of the versatile VMD
package (Humphrey et al., 1996), CaFE is implemented as a set of
Tcl scripts, aiming to shorten and automate the process of binding
affinity prediction while taking advantage of the powerful scripting
interface to VMD’s built—in functions. Several internal procedures of
CaFE are implemented as Tcl wrappers around external programs
for evaluating the single point gas—phase energy and solving the
Poisson—Boltzmann (PB) equation. CaFE features are accessible as
command—line procedures. By importing the cafe package in analysis
scripts, two procedures, namely, mmpbsa and lie, can be invoked
for the corresponding calculations. The internal work ﬂow is de—
picted in Figure 1A and B.

3 Application of CaFE

We performed the calculations of binding affinity between avidin
(Fig. 1C) and biotin as well as its analogues (Green, 1975) to exem—
plify the usage of CaFE. Avidin, found in egg white of oviparous ver—
tebrates, is a naturally occurring protein that specifically binds
biotin. The avidin—biotin system forms one of the strongest noncova—
lent association pair in nature and is widely used in immunological
and diagnostic assays. Also, it is frequently employed for assessing
the performance of theoretical methods for estimating binding affin—
ity (Hou et al., 2011a).

3.1 MM/PBSA

MM/PBSA is a method combining molecular mechanics and con—
tinuum solvents (Kollman et al., 2000). Hypothetically, a receptor—
ligand binding event is split into two stages: association in the gas
phase and solvation in the aqueous phase. While the single point
gas—phase energy is evaluated with a classical force field, the solv—
ation term is quantified by using implicit solvent models, which is
the core of this method.

Step 1: Conformational sampling. The end—point methods are ac—
tually post—processing methods. Therefore, prior to calculations, tra—
jectory files are usually generated by common molecular dynamics
(MD) simulation packages. For MM/PBSA ligand binding energy
calculations, one trajectory can be used for each complex. In this
case, parameters of CHARMM and its general force fields were
used for the sample calculations.

Generate the c
topology ﬁles

 

Conformational
sampling

 

    
     

Post-process the
trajectory ﬁle

      
    
   

Calculate the
gas-phase energy

Calculate the

PB allergy D mu-PBSA

 

Calculate the 
SASA term

I Generate the result 

  

 

AGmamm [kcallmc-I)

-20 x r, = 0.94:
r, = 0.95

 

 

 

‘20 -15 — I U —5
aGDinﬂcum (kcallmol)

E HE
C o ,I';
1 E r’
r 5—“- I,
I
: g 
. E .,
. a l I , I
E '1 o 97
(3 ’ rp= .
‘1 / r, = 0.93

 

 

-20 -1 5 -10 -5
AGNMIW (kcal! mol)

 

Fig. 1 (A) Work flow for the typical MM/PBSA and (B) LIE calculations.
Procedures with yellow background are automated by CaFE. (C) Structure of avi-
din monomer (PDB accession code: 1AVD). The correlations between the experi-
mental binding affinities and the predicted values by the (D) MM/PBSA and (E)
LIE methods (Color version of this figure is available at Bioinformatics online.)

Step 2: Post-processing of trajectory. For MM/PBSA, the complex,
receptor and ligand conformations of interest are extracted from the
produced MD trajectories, according to the one—trajectory protocol
(Kollman et al., 2000). Unlike some other tools, additional topology
files for neither the receptor nor the ligand is required. Instead, a
human—readable selection language, which is used by VMD, is given
by the users to select the subgroup of atoms involved in the complex,
receptor and ligand. In addition, the intrinsic implicit solvent radii
can be assigned without modification of the input file.

Step 3: Energy calculations and output. Three energetic compo—
nents are calculated in the MM/PBSA method. At first, the gas—phase
energy difference between the complex and the separated receptor
and ligand is obtained by calling NAMD. Then, the polar solvation
free energy is calculated by numerically solving the PB equation im—
plemented in APBS (Baker et al., 2001). Subsequently, the difference
of solvent—accessible surface area (SASA) is measured and the non—
polar solvation free energy is estimated by its approximate linear re—
lation with SASA. At last, the binding free energy is summed and
averaged throughout an ensemble of conformations as follows:

AGbind : AH — TAS : (ABE... + AGP°1“ + AG:§“P"1“ — TAS) (1)

sol

910g ‘09 isnﬁnv no sejeﬁuv s01 ‘Bttuomrzg JO KitsreAtu f] 112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Idllq 11101} papeoIH/noq

2218

H.Liu and T.Hou

 

It is worth noting that the entropic term is ignorable for a group
of structurally similar compounds as in this case. Due to high com—
putational cost and inaccuracy of current methods for entropy cal—
culations, we generally ignored the entropic term in CaFE.

3.2 LIE

LIE is based on the linear response approximation (Aqvist et al.,
1994). An external PB solver is not needed, and the preorganization
of the ligand is explicitly taken into account. However, it is more ex—
pensive in conformational sampling and predefined scaling factors
are required.

Step 1: Conformational sampling. Similar to MM/PBSA, trajec—
tories have to be generated before free energy calculations; however,
an additional trajectory for the solvated ligand is required for the
LIE method.

Step 2: Post-processing of trajectory. Water molecules are not
removed as in the MM/PBSA case. Nevertheless, trajectory or coord—
inate files are converted to the DCD file format which is used for
later energy evaluations.

Step 3: Energy calculations and output. For LIE, only two ener—
getic differences between the ligand and its surrounding environ—
ments, in both the bound and free aqueous states, are calculated.
They are the electrostatic and van der Waals interactions on behalf
of the polar and nonpolar binding free energy terms, respectively.
Then, the total binding free energy is obtained by

AGbind :  + Acggipolar
: Haifa“) —< 339) + “((33350 — (Elihl) + v (2)

where or, p’ and y are predefined coefficients and y is ignored for cog—
nate ligands.

3.3 Results

The results are shown in Figure 1D and E. Both methods show high
correlation coefficients with experimental values in the showcased
example, which is in line with our previous evaluations using differ—
ent force field parameters (Hou et al., 2011a).

4 Conclusion

To facilitate the prediction of binding affinity of protein—protein/lig—
and, we present an automated tool CaFE, which provides a user—
friendly choice for researchers who want to perform a post—MD en—
ergetic analysis using the end—point methods.

Funding

This work was funded by the National Science Foundation of China through
its grant 21575128.

Conﬂict of Interest: none declared.

References

Aqvist,I. et al. (1994) A new method for predicting binding afﬁnity in com-
puter—aided drug design. Protein Eng., 7, 385—391.

Baker,N.A. et al. (2001) Electrostatics of nanosystems: application to microtu-
bules and the ribosome. Proc. Natl. Acad. Sci. USA, 98, 10037—10041.

Banavali,N.K. and Roux,B. (2002) Atomic radii for continuum electrostatics
calculations on nucleic acids. I. Phys. Chem. B, 106, 11026—11035.

Case,D.A. et al. (2005) The amber biomolecular simulation programs.
I. Comput. Chem., 26, 1668—1688.

Chipot,C. (2014) Frontiers in free—energy calculations of biological systems.
WIREs. Comput. Mol. Sci., 4, 71—89.

Green,N.M. (1975) Avidin. Adv. Protein Chem., 29, 85—133.

Homeyer,N. and Gohlke,H. (2013) FEW: a workﬂow tool for free energy cal—
culations of ligand binding. I. Comput. Chem., 34, 965—973.

Hou,T. et al. (2011a) Assessing the performance of the MM/PBSA and
MM/GBSA methods. 1. The accuracy of binding free energy calcula—
tions based on molecular dynamics simulations. I. Chem. Inﬁ Model, 51,
69—82.

Hou,T. et al. (2011b) Assessing the performance of the molecular mechanics/
poisson boltzmann surface area and molecular mechanics/generalized born
surface area methods. 11. The accuracy of ranking poses generated from
docking. I. Comput. Chem, 32, 866—877.

Humphrey,W. et al. (1996) VMD: visual molecular dynamics. I. Mol. Graph,
14, 33—38.

Kollman,P.A. et al. (2000) Calculating structures and free energies of complex
molecules: combining molecular mechanics and continuum models. Acc.
Chem. Res., 33, 889—897.

Kumari,R. et al. (2014) G_mmpbsa—a GROMACS tool for high—throughput
MM-PBSA calculations. I. Chem. Inf. Model., 54, 1951—1962.

Lill,M.A. and Danielson,M.L. (2011) Computer—aided drug design platform
using pymol.I. Comput. Aided Mol. Des.,25, 13—19.

Miller,B.R. et al. (2012) MMPBSA.py: an efﬁcient program for end-state free
energy calculations. I. Chem. Theory Comput., 8, 3314—3321.

Nina,M. et al. (1997) Atomic radii for continuum electrostatics calculations
based on molecular dynamics free energy simulations. I. Phys. Chem. B,
101, 5239—5248.

Phillips,I.C. et al. (2005) Scalable molecular dynamics with NAMD.
I. Comput. Chem., 26, 1781—1802.

Sitkoff,D. et al. (1994) Accurate calculation of hydration free energies using
macroscopic solvent models. I. Phys. Chem., 98, 1978—1988.

9103 ‘Org isnﬁnv 110 salaﬁuv soc] ‘BtHJOJtIBQ JO AJISJQAIIIH 112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Idllq 11101} papeolumoq

