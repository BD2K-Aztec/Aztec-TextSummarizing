Bioinformatics, 2016, 1—3

doi: l0.1093/bioinformatics/btwl43

Advance Access Publication Date: 15 March 2016
Applications Note

 

 

Genetics and population analysis

EBglmnet: a comprehensive R package for
sparse generalized linear regression models

Anhui Huang* and Dianting Liu

Department of Electrical and Computer Engineering, University of Miami, Coral Gables, FL 33146, USA

*To whom correspondence should be addressed
Associate Editor: Oliver Stegle

Received on September 25, 2015; revised on February 6,2016; accepted on March 8,2016

Abstract

Summary: EBglmnet is an R package implementing empirical Bayesian method with both lasso
(EBIasso) and elastic net (EBEN) priors for generalized linear models. In our previous studies, both
EBlasso and EBEN outperformed other state—of—the—art methods such as lasso and elastic net in
inferring sparse genotype and phenotype associations, in which the number of covariates is typic—
ally much larger than the sample size. While high density genetic markers can be easily obtained
nowadays in genetics and population analysis thanks to the advancements in molecular high
throughput technologies, EBglmnet will be a very useful tool for statistical modeling in this area.

Availability and implementation: EBglmnet package is freely available from the R archive CRAN

(http://cran.r—project.org/).
Contact: a.huang1@umiami.edu

 

1 Introduction

In areas such as multiple quantitative trait locus (QTL) mapping
and pathway-based genome-wide association studies (GWAS), high
density gnomic markers can be obtained easily as technologies
advanced in molecular genotyping. Including all marker effects in a
single regression model leads to a large number of model variables,
typically much larger than the sample size. Traditional regression
methods failed when I) >> 11, where p is the number of model vari-
ables, and n is the sample size.

We recently developed an efficient empirical Bayesian method
with lasso (EBIasso) (Cai et (11., 2011; Huang, 2014; Huang et (11.,
2013) and elastic net (EBEN) priors (Huang et (11., 2015) for vari-
able selection and effect estimation. EBlasso has two sets of hier-
archical priors (EBIasso-NE: normal and exponential hierarchical
prior; EBlasso-NEG: normal, exponential and gamma hierarchical
prior) enforcing different levels of shrinkage to produce a sparse
model; and EBEN encourages a grouping effect while inferring a
sparse model, which is able to select a group of highly correlated
variables when EBlasso fails. Comprehensive simulation and real
data analysis in QTL mapping (Cai et (11., 2011; Huang et (11., 2013,
2014a,b, 2015) and pathway-based GWAS (Huang et (11., 2014a)
demonstrated that EBlasso and EBEN outperformed other state-of-
the-art algorithms such as lasso (Tibshirani, 1996) and elastic net

(Zou and Hastie, 2005) in term of power of detecting true effects
(PD), false discovery rate (FDR), as well as detecting a group of
highly correlated effects.

The aforementioned studies implemented those methods separ-
ately either in MATLAB or R, and were not available for different
generalized linear regression models (GLMs). In this paper, we de-
veloped a cross-platform software package EBgln/met, with imple-
mentation of both Gaussian and binomial models for all
methods. Core algorithms in the software are programmed in effi-
cient C/C ++ with user-friendly R interface. Comparing to the ori-
ginal implementation, computational speed via EBglmnet is very
fast thanks to the basic linear algebra subprograms (BLAS) and lin-
ear algebra package (LAPACK) (Anderson, 1999) utilized by the
package.

2 Methods
Let us consider using a GLM for variable selection,
I] : ,uI + XII. (l)

where X an n X p matrix containing p variables for 11 samples with p
being allowed to be > n, r] is an 11 XI linear predictor and is related
to an 11 XI outcome variable y through a link function

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

A.Huang and D.Liu

 

g: E(y|X) : g‘1(n) : g‘1(uI+X/3), and If is a 17 X1 vector captur—
ing the corresponding effects. Based on the model assumptions, the
distribution of y depends on the linear predictor HI + X13, and in
some cases, a dispersion parameter a. For example, in our previous
studies of multiple QTL mapping, where y is the quantitative traits,
(1) corresponds to the linear regression model:

y:,uI+le+£ (2)

and a can be modelled by an independent identical Gaussian distri—
bution with zero—mean and covariance 031; In the example of path—
way—based GWAS where y indicates the binary outcome of disease
status for the 11 samples, y is linked to (1) via a logit function:

logit(Pi)=loglPi/(1 - WI 2 '1,- = H + xiii. (3)

where p,- : Pr(y,~ : 1), and 11,- : u +xiﬂ is the linear predictor for
the ith sample. Based on the above GLMs, both EBIasso and EBEN
assign ‘peak zero and flat tails” prior distributions to If, which have a
large proportion of the probability mass around zero while still
allowing a small decay rate at the two tails (Park and Casella,
2008). For example, EBIasso—NE employs a two—level hierarchical
prior distribution: at the first level, [3,- follows an independent nor—
mal distribution with mean zero and unknown variance
01-2 : [3,- ~ N(0, 01-2), /: 1, ., 17. At the second level, 01-2 follows an inde—
pendent exponential distribution with a common parameter 2:
17071-2) : /lexp(—/la/-2), /: 1, ..., 17. Then the empirical Bayesian ap—
proach employs a coordinate ascent method to find 31-2
of 01-2, that maximizes the marginal likelihood function of 01-2. In the

, the estimate

iterative process, many 01-2, or equivalent [3,- are shrunk to exact zero,
and the posterior mean and covariance for the non—zero coefficients
T3 are obtained through maximizing the marginal posterior of [f with
the given 31-2, [:1, ..., p. In EBglmnet, 2 controls the degree of
decay rate at the two tails (degree of shrinkage) and is determined
via cross validation (CV). More details of the methods and prior set—
ups for EBgmnet can be found in the package documentation and
the references therein.

2.1 EBIasso—NEG method

We previously reported a powerful EBIasso method using normal,
exponential and gamma hierarchical prior (NEG) with both mul—
tiple linear regression model and logistic regression model, and dem—
onstrated that it outperformed other state—of—the—art algorithms in

term of PD and FDR, such as lasso (Tibshirani, 1996), HyperLasso
(Hoggart et al., 2008), BhGLM (Yi and Banerjee, 2009), EB method
(Xu, 2007), as well as the Relevant Vector Machine (RVM)
(Tipping and Faul, 2003). The NEG prior enforces a strong degree
of variable shrinkage, and is able to handle a model with millions of
effects as demonstrated in our whole—genome QTL mapping using
the linear regression model (Huang et al., 2014b) and pathway—
based GWAS with the logistic regression model (Huang et al.,
2014a). A unique feature for this prior is that when genetic inter—
actions are considered, a group EBIasso method is available to apply
a higher degree of shrinkage on the interaction effects. In EBglmnet,
a group parameter in the function is available to turn on this
feature.

2.2 EBIasso—NE and the EBEN method

Based on the NEG prior, a two level normal and exponential hier—
archical prior (NE) is also developed for the logistic regression
model in our previous study (Huang et al., 2013). With only first
two—level of the hierarchical NEG prior, EBIasso—NE typically se—
lects more non—zero effects, and results in a less sparse model.
Though the original algorithm was developed for logistic regression
model, we further implements the NE prior with multiple linear re—
gression model in EBglmnet.

While EBIasso typically selects one variable out of a group of
highly correlated variables, we recent derived a novel elastic net
prior that is able to encourage a strong grouping effect similar to
that of elastic net, but under the empirical Bayesian framework
(Huang et al., 2015). Similar as lasso and elastic net, EBIasso—NE be—
comes a special case of EBEN.

Note that the computational speed for EBglmnet is mainly deter—
mined by the number of non—zero effects selected by the model.
Without the third layer constraint, EBIasso—NE and EBEN select
more variables with small effects, and take longer time to finish the
computation (Table 1). Additionally, for a true effect that is highly
correlated with other group of effects, EBEN tends to select the
whole group, resulting in a smaller estimated effect size with larger
P—value on the true effect, and longer computational time.

2.3 Epistasis analysis in EBglmnet
All the aforementioned methods include a parameter ‘Epis’ to turn
on the feature of epistasis analysis. For 17 genetic variables, this will

Table 1. Performance comparison For EBglmnet and glmnet (lasso/elastic net) packages

 

 

Moder Methodb simI simII simIII
I’D/FDR Time(s) I’D/FDR Time(s) I’D/FDR Time(s)
Binomial NEG 068/007 0.94 015/000 2.52 099/004 404.25
group NEGC — — 0.45/0.10 23.74 099/005 381.81
NE 060/004 1.57 025/017 169.16 0.95/0.11 1962.66
EBEN 052/004 1.67 025/017 137.87 0.93/0.09 2013.21
lasso 0.98/0.40 0.10 — — — —
elastic net 0.99/0.50 0.10 — — — —
"/11, 300/481 300/115 921 1000/115 921
Epistasis (Epis) FALSE TRUE TRUE

 

“Performance metrics were calculated by the mean of 100 replicates of the simulation having optimal parameter pre-determined through CV. A t—test

P-value S 0.05 cutoff was used when determining PD and FDR for EBglmnet methods. Simulations were based on a simulated F2 population with [7 = 481 even

spaced (5 CM) markers having 20 true QTL effects (10 main and 10 epistatic effects in the case of Epis=TRUE; effect sizes were randomly generated from

unif[2,3]), and computation was performed on a computer cluster including computing nodes with 2.6 GHz Xeon CPU running Linux.

l’Lasso and elastic net were compared using glmnet package implemented with Fortran code. The package failed to analyze simII and simIII due to the separ-

ation problem in logistic regression.

CWhen Epis = TRUE, the scale hyperparameter for interaction terms is different with that of main effects by a factor of « /[7(17 7 1)/2.

ﬁle'spzumol‘pmﬂo'sopeuuowrorq/ﬁdnq

EBglmnet

 

analyze a total of p’:p(p + 1)/2 number of effects adding all pair—
wise interactions using memory efficient algorithmic techniques,
such that only main effect matrix is saved in memory and interaction
effect is generated dynamically when the particular effect is under
evaluation. As illustrated in (Huang et al., 2014b), p can include
both additive and dominance effects, and with appropriate genetic
coding, all main effects, additive >< additive, additive >< dominance,
dominance >< additive and dominance >< dominance interactions can
be included in the model with ‘Epis’ on. Generally, a larger sample
size is required in epistasis analysis given the p(p — 1)/2 more candi—
date effects. Such performance differences are illustrated in the simu—
lation example using a larger sample size in simIII comparing with
that of simII, which are both simulated with 10 main effects and 10
epistasis effects out of the total p’:p(p+ 1)/2:115 921 possible
effects.

3 Performance

EBglmnet not only incorporates powerful algorithms developed in
several of our papers, but also has novel algorithms first reported in
this Application Note that make the package completely functional.
The list of algorithms is provided in Table 1 using binomial model
as an example, and each method is implemented with a CV method
to decide the shrinkage parameter(s). Thanks to the C/C ++ imple—
mentation with the fast BLAS and LAPACK, the software is also
time efficient, considering the high complexity of the algorithms.

All three sets of simulation have p > 11. However, performance of
simII is worse than simI given the same sample size but more than
200 times more variables. The noise accumulation and spurious cor—
relation are alleviated with increased sample size in simIII. With the
same number of variables as simII, simIII also demonstrates that a
longer computational time is required given that more non—zero true
effects are selected into the model. Of note, severe spurious correl—
ation leads to complete separation in logistic regression model, and
glmnet was not able to handle the problem due to the correlation—
based discarding rules (Tibshirani et al., 2012).

4 Conclusions

EBglmnet is a powerful package for GLMs that performs variable
selection and effect estimation. The algorithms outperform other
state—of—the—art methods in terms of PD, FDR, as well as handling
high correlated effects. EBglmnet package can be very useful for re—
search studies such as multiple QTL mapping, pathway—based
GWAS, among other research areas (Huang et al., 2010; Liu et al.,
2007, 2013; Qiusha and Mei-Ling, 2015 ).

Conflict of Interest: none declared.

References

Anderson,E. (1999) LAPACK Users’ Guide. Society for Industrial and Applied
Mathematics, Philadelphia, PA, USA.

Cai,X. et al. (2011) Fast empirical Bayesian LASSO for multiple quantitative
trait locus mapping. BMC Bioinform., 12, 211.

Hoggart,C.]. et al. (2008) Simultaneous analysis of all SNPs in genome-wide
and re-sequencing association studies. PLoS Genet., 4, e1000130.

Huang,A. (2014) Sparse Model Learning for Inferring Genotype and
Phenotype Associations. University of Miami, Coral Gables, FL, USA.

Huang,A. et al. (2010) Characterization of arsenic-resistant bacteria from the
rhizosphere of arsenic hyperaccumulator Pteris vittata. Can. ]. Microbiol,
56, 236—246.

Huang,A. et al. (2013) Empirical Bayesian LASSO-logistic regression for mul-
tiple binary trait locus mapping. BMC Genet., 14, 5.

Huang,A. et al. (2014a) Detecting genetic interactions in pathway-based gen-
ome-wide association studies. Genet. Epidemiol., 38, 300—309.

Huang,A. et al. (2014b) Whole—genome quantitative trait locus mapping re-
veals major role of epistasis on yield of rice. PLoS ONE, 9, e87330.

Huang,A. et al. (2015) Empirical Bayesian elastic net for multiple quantitative
trait locus mapping. Heredity, 114, 107—115.

Liu,D. et al. (2007) Face Recognition Using Hierarchical Isomap. 2007 IEEE
Workshop on Automatic Identiﬁcation Advanced Technologies. IEEE, pp.
103—106.

Liu,D. et al. (2013) Spatial-temporal motion information integration for ac-
tion detection and recognition in non-static background. 2013 IEEE 14th
International Conference on Information Reuse and Integration (IRI).
IEEE, pp. 626—633.

Park,T. and Casella,G. (2008) The Bayesian lasso. ]. Am. Stat. Assoc., 103,
681—686.

Qiusha,Z. and Mei-Ling,S. (2015) Sparse linear integration of content and
context modalities for semantic concept retrieval. IEEE Trans. Emerg.
Topics Comput., 3, 152—160.

Tibshirani,R. (1996) Regression shrinkage and selection Via the lasso.  R.
Stat. Soc. Ser. B: Stat. Methodol., 58, 267—288.

Tibshirani,R. et al. (2012) Strong rules for discarding predictors in lasso-type
problems, ]. R. Stat. Soc. Ser. B: Stat. Methodol., 74, 245—266.

Tipping,M.E. and Faul,A.C. (2003) Fast marginal likelihood maximisation for
sparse Bayesian models. In: Bishop,C.M. and Frey,B.]. (Eds.) Proceedings of
the Ninth International Workshop on Artiﬁcial Intelligence and Statistics.
Key West, FL.

Xu,S. (2007) An empirical Bayes method for estimating epistatic effects of
quantitative trait loci. Biometrics, 63, 513—521.

Yi,N. and Banerjee,S. (2009) Hierachical generalized linear models for mul-
tiple quantitative trait locus mapping. Genetics, 181, 1101—1133.

Zou,H. and Hastie,T. (2005) Regularization and variable selection via the
elastic net.]. R. Stat. Soc. Ser. B: Stat. Methodol., 67, 301—320.

ﬁm'spzumol‘pmyo'sopeuuowrorq/pdnq

