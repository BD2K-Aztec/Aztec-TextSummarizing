BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Multiple alignment-free sequence comparison

 

distinguishing two sequences related by a common motif. We
refer to the ﬁrst statistic as star—type and to the second statistic
as Shepp—type; according to Shepp (1964), if the counts were
independent mean zero normal variables, then the self—standar—
dized statistic Dg would again be normally distributed.

To eliminate the effect of the length of the sequences, two
renormalized versions, C; and Cg, of D; and D;9 are introduced
in Liu et al. (2011) by applying the CauchyiSchwarz inequality;

am 3) 2 A
2 ’ /2 (WV /2 (£3052
weA" weA"
and, with
(i) Z  I
(my + (X4352)
for i = 1, 2,
C§(A B): D§(A’B)

/2 (3:37“)? /2 (fie);
we A" we A"

Both C; and C; range from —1 to 1, with a value close to 1 when
the sequences are closely related. For sequences that do not have
the same length, the total number of k—tuple words could have a
large influence on the value of D—type statistics, and hence for
such sequences, we use the C—type statistics to measure the simi—
larity. As CRM sequences vary by a few hundred base pairs in
length, we only use the C—type statistics in our applications.

Variants of our D—type statistics have been considered in the
literature; a main issue with them is that they may be dominated
by single—sequence noise. In Lippert et al. (2002), it has been
shown that the straightforward non—centred statistic
D2(A,B) = EMA/i XEPXEE) may be dominated either by noise
in the single sequences or by difference in sequence backgrounds.
Thus, it has weak power in detecting relationship between two
sequences; see also Kantorovitz et al. (2007); Reinert et al.
(2009); Wan et al. (2010). In Kantorovitz et al. (2007), a stan—
dardized statistics D22 2 D 12353) was proposed, where E(D2)
and sd(D2) are the mean and standard deviation of D2 under a
given model of the sequence. It was shown that D22 outperforms
D2. Yet, the noise in the single sequence may still dominate the
statistics D22 when the background sequence is not uniform
(Reinert et al., 2009). Standardizing the count vectors themselves,
as in D; and D59, resolves this issue.

In the work of Goke et al. (2012), the background sequence
model is generalized from i.i.d to a first—order Markov chain
model, showing that a first—order Markov chain model improves
the ability of detecting similarity between regulatory sequences
compared with the i.i.d model. Higher order Markov chain
models could be considered, but owing to the limited length of
CRM sequences, estimating the higher order Markov chain
model parameters leads to an overfltting problem and results
in poor performance (Goke et al., 2012). Goke et al. (2012)
also showed that including the reverse complement of a word
could increase the prediction accuracy.

Although the statistics C; and C; perform well for pairwise
alignment—free sequence comparison, in applications, the

 

similarity within a set of more than two sequences may be of
interest. There are two main types of problems to tackle. The
ﬁrst problem is an identification problem. Suppose that we have
already classiﬁed Z — 1 sequences according to whether they are
CRMs of a particular type, and we are presented with a new
sequence. How should we classify this sequence? The second
problem is how to assess the similarity within a set of sequences.
Both problems are motivated by the task of predicting sets of
related CRMs, given a set of co—regulated genes.

In Kantorovitz et al. (2007), the overall similarity within a set
of CRM sequences is addressed as follows. A set of CRMs,
known to regulate expression in the same tissue and/or develop—
ment stage, is taken as the so—called positive set. A set of equally
many randomly chosen sequences, with lengths matching the
CRMs, is taken as the so—called negative set. The positive set is
randomly partitioned into two disjoint subsets of equal size, and
each subset of sequences is concatenated to produce one long
sequence. The similarity between these sequences can then be
assessed using an alignment—free statistic for pairwise sequence
comparison; Kantorovitz et al. (2007) recommend D22. As this
method requires many repeats of the random partitioning, it is
time—intensive, and hence alternative methods are of interest.

Here, we extend the renormalized pairwise alignment—free se—
quence comparison statistics C; and C; to two families of mul—
tiple statistics, denoted by C; and Cf. We also introduce three
families of averagepairwise statistics for the identiﬁcation prob—
lem, called 7;, C; and Cg“, and their ver_si01%for measuring
similarity within a set of sequences, called W, C; and Cg“.

We evaluate these families of statistics by testing them on the
identiﬁcation problem described earlier in the text, both through
a simulation study and through analysing real data, by using
each of our statistics as a score; the higher the score, the more
similar the sequences should be. In the simulation study, we
follow the common motif model in Reinert et al. (2009) and
Wan et al. (2010) but under a ﬁrst—order Markov chain model
for the background sequence. Then, we apply our statistics to the
data from Blow et al. (2010) of tissue—speciﬁc enhancer CRMs
identiﬁed in vivo in mouse embryos. We also evaluate these
families for the task of assessing the similarity within sets of
sequences, again using both the simulated sequences as men—
tioned previously and the CRM data from Blow et al. (2010).

Our evaluation is based on 90% conﬁdence intervals (CI) for
the area under the receiver operational characteristic (ROC) curve
(A UC), which is implemented by the R package ROCR in Sing
et al. (2005). In Hardison and Taylor (2012), it is emphasized
that it is often the number of false positives that make CRM
prediction not very successful. Hence, we also assess the perform—
ance of our statistics through 90% CIs for the false—positive rate
at 20% sensitivity. We say that a statistic outperforms the other
if the 90% CIs of the former statistic is smaller than the lower
bound of the 90% CI of the latter statistic.

We find that although for real data all of our statistics show a
similar performance, on simulated data, the Shepp—type statistics
are in some instances outperformed by star—type statistics. The
multiple alignment—free statistics are more sensitive to contamin—
ation in the data than the pairwise average statistics.

The article is organized as follows. In Section 2, we introduce
two families of multiple alignment—free statistics, called C; and
Cf, for 1 >2. Moreover, three families of average pairwise

 

 

 

 

2691

ﬁre'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

J.Ren et al.

 

alignment—free statistics, called W, C; and Cg“, are introduced
with the identiﬁcati_on problem in mind, as well as their

 

generalizations @, C; and W for measuring similarity within
a set of sequences. Section 3 contains the evaluation and compari—
son of these statistics for the CRM identiﬁcation problem.
Section 4 addresses the problem of measuring the similarity
within a set of sequences. In Section 5, we assess the effect of
contamination in the data. We summarize our results in Section 6.

2 METHODS

2.1 Multiple alignment-free statistics

Let {A(1),A(2), . . . , Am} be a set of sequences, where A“) has length nk.
Assume that the sequences follow a ﬁrst order time-homogeneous irre-
ducible aperiodic Markov chain with transition matrix T and stationary
distribution 71. For a word w = w], w, ..., w, the probability of word
w in the ith sequence is then Pf? = 71(“(w1)]_[;‘f:2 713+”) We extend w to

include its reverse complement 17‘. Then in our deﬁnition,
it? = (A4? + X???) — (n) — k + 1)(P$:Z> + Pf?)

where  is the number of occurrence of word w in the sequence A“).

Our proposed statistics use the absolute centralized word count vari-
able |)?ff?|; we call these the absolute statistics. We deﬁne our absolute star-
type multiple alignment-free sequence comparison statistic by

l 2
Z HIWI
C7040), ___, A(l)) = WEA" 1:1 1 (2)
221:? I .
  <1 o }

Similarly, following Quine (1994), our absolute Shepp-type multiple
alignment-free sequence comparison statistic is deﬁned as

2 1i 
w ’11:]
Cf(A<1>, ...,Am) =  (3)
. 1
[£11 WEE/1k (
where Elf“) = M" 1 and
_ 2’
{2; (AT/)3}

"4 ~1 ~>1~'+1 ~
AYEAW-Mi 1X1: NM?-

For measuring the similarity within a set of sequences, we directly
apply these statistics to a set of sequences as a measurement of similarity.
Larger values indicate higher similarity among the sequences, and thus
higher conservation of regulatory patterns for these sequences. We also
use these multiple alignment-free statistics for the CRM identiﬁcation
problem, by measuring the similarity within a set of sequences containing
one candidate sequence and the known CRM sets. Higher values of the
statistics indicate higher similarity among the candidate sequence and
the known CRM sequences, and a higher likelihood that the candidate
sequence has a similar regulatory pattern as the given CRMs.

Although it would be tempting to use as extension of D; and D5, the
statistics based on the products of the centred counts 21?, these extensions
do not work well when the number of sequences is odd. Indeed, for
pairwise D2 type statistics, for closely related sequences, the centralized
counts should often have the same signs so that the product if???)
would often be positive. However, for the multiple alignment-free statis-
tics with an odd number of sequences, when all the centralized counts
have a negative sign, their product will give a negative contribution to
the similarity score. Therefore, instead of using )3” we use the absolute

u, a

centralized word count variable Dam; in the supplementary material, we

also report on the statistics corresponding to (2) and (3) using the original
centralized word count variables  and the squared centralized word
count variables I? = (X87)?

2.2 Average pairwise alignment-free statistics

2.2.1 Identification of CRMs Here, we consider what we call the
CRM identiﬁcation problem: Given a set of CRM sequences with similar
TFBSs regulatory pattern, how can we identify new CRMs in the genome
that belong to a similar regulatory pattern as the given CRMs? Suppose
that we have a set of identiﬁed CRM sequences SO 2 {s1,s2, . . . ,s;} with
a similar regulatory pattern, and we have a set 51 = {c1,cz, ..., ck} of
candidate sequences. We want to pick CRMs from the candidate set that
have a similar regulatory pattern as sequences in S0.

There are two possible approaches to this problem. On the one hand,
we can use C7+1(s1, ...,s1;c,») and CfH(s1, ...,s1;c,») as the similarity
score. On the other hand, we can measure the similarity by averaging
over the pairwise alignment-free statistics D; or D5, respectively; the
length-adjusted versions are

— 1 1
C301, ...,s); c,») = 7: 03(5), c,») and (4)
1:1
— 1 1
ego], ...,s); c,») = j: C50,, cl»). (5)
1:1
A closer look reveals that C;(s1, ...,s;; c,») is the inner product be-

tween the standardized and normalized k-tuple vector of sequence c,-
and the arithmetic mean of the standardized and normalized k-tuple
vector of sequence s1, . . . ,sl. By taking the geometric mean of the stan-
dardized and normalized k-tuple vectors of sequences s1, ...,s1 instead
of arithmetic mean, we create another length-adjusted statistic
C;“”(s1, ...,s;; c,») based on Wﬁml,

C5600], . . .,s1; cl») = Z

we» < Z (lﬁ:(u)l),—’.)T

IVE/4k

1X30» I

1 In“)

x: H. . 
weA‘ 1: (Z (lﬁ;(x))l))

(6)

IVE/4k
Instead of taking the geometric mean based on the absolute centralized
counts, we could have based it on the squared centralized counts. In
simulations, we ﬁnd that calculating the squared statistics requires
more computations than the absolute version without considerable gain
in precision, see Supplementary Materials 1.2.

2.2.2 Measuring similarity within sets of sequences Now, we
consider the task of assessing the similarity within sets of sequences. For
a set S: {s1,s2, ...,s;}, the multiple alignment-free statistics (2)43)
can be used to measure the similarity within a set of sequences, but the

average pairwise statistics need to be extended. Let 5,,» = {s}, ...,sH,
slur] , . . . , .s;}. We deﬁne three average pairwise alignment-free statistics
: 1 1 —
Cars) = 72 Case»; Si), (7)
[:1
= 1 1 —
C§(5) = 7: C§(S,,»; st»), and (8)
[:1
= 1 l —
cg“’(s) = 7: C§W(s,,»; st»). (9)
i=1

 

2692

ﬁre'spzumofpmJXO'sopeuuquioiq/ﬁdnq

Multiple alignment-free sequence comparison

 

2.3 A simple example

We illustrate the methods with a simple example of the following ﬁve
sequences, (i) ‘ATGCATAT’, (ii) ‘ATATATGC’, (iii) ‘ATGCATGT’,
(iv) ‘ATATGCAT’, (v) ‘CTCGGAGA’, where the second sequence is
the first one with the ﬁrst and second half transposed; the third sequence
is the ﬁrst one with the second-to-last position changed from ‘A’ to ‘G’;
the fourth sequence is the complement of the ﬁrst one; and the last one
has no 2-tuples in common with the other sequences. With k = 2, and all
letters equally likely and independent (so P”. = 1 / 16), the 5 by 5 matrices
calculated based on C; and C; are

1.00 0.93 0.84 1.00 —0.44
0.93 1.00 0.61 0.93 —0.41
C; = 0.84 0.61 1.00 0.84 —0.52
1.00 0.93 0.84 1.00 —0.44
—0.44 —0.41 —0.52 —0.44 1.00

and

1.00 0.89 0.76 1.00 —0.39
0.89 1.00 0.59 0.89 —0.30
C; = 0.76 0.59 1.00 0.76 —0.43
1.00 0.89 0.76 1.00 —0.39
—0.39 —0.30 —0.43 —0.39 1.00

As our statistics include the reverse complement, sequences 1 and 4
have a pairwise similarity of 1. Both of these pairwise statistics consider
transposition as closer to the original sequence than the change of one
letter; C; gives a higher score than C; for comparisons between the ﬁrst
four sequences, which are similar, and a lower score to comparison with
the last sequence, which is different from the other sequences.

We also calculate the multiple statistics for comparing all 10 combin-
ations of three sequences, see Table 1. Note that the valuﬁof the statistics
cannot be compared across methods, and C;, C? and C?” range between

 

0 and 1, whereas %; and C—§ and take values in the range between —1 and

+1. For pairs of triplets that only differ in whether sequence 1 or se-
quence 4 is included (such as {1,2, 3} and {2, 3,4}), the similarity scores
are the same; for such pairs, we only report the results when 1 is included.
The scores for triplets involving both sequence 1 and 4 differ from the
pairwise scores; adding the sequence 4 increases all scores except the C?
score for {1,2,4}.

We would expect that the statistics pick up that sequence 5 is dis-
similar to sequences 14. The pairwise similarity score between the
sequences 14 and sequence 5 are all negative, indicating the strong
dissimilarity between them. Similarly, the triplets including the sequence
5 have signiﬁcantly smaller values of the similarity score than the
others. C; and the three pairwise average statistics give the highest
score for {1,2,4}, whereas Cf gives its highest score for {1,3,4}, by
considering the transposition as a more severe change than the change

Table 1. The multiple statistics for comparing three sequences from
the ﬁve sequences, (i) ‘ATGCATAT’, (ii) ‘ATATATGC’,
(iii) ‘ATGCATGT’, (iv) ‘ATATGCAT’, (v) ‘CTCGGAGA’

 

 

Triplets C; C? ﬁ; C; 
{1,2, 3} 0.82 0.60 0.79 0.75 0.83
{1,2, 4} 0.95 0.80 0.95 0.93 0.94
{1,2, 5} 0.40 0.49 0.03 0.07 0.65
{1, 3, 4} 0.89 0.81 0.89 0.84 0.92
{1, 3, 5} 0.44 0.52 —0.04 —0.02 0.70
{1,4, 5} 0.42 0.62 0.04 0.07 0.70
{2,3,5} 0.38 0.38 —0.11 —0.05 0.61

 

of one letter. All ﬁve statistics give the lowest score to {2,3,5}. The

 

multiple statistics as well as @ assign the second-lowest scores
to {1,2,5}, whereas the averaging statistics C; and F; assign their
second-lowest scores to {1, 3, 5}.

When replacing sequence 3 to be ‘ATACATAT’, that is, we replace
the third letter ‘G’ by ‘A’ instead of replacing the second-to-last letter ‘A’
by ‘G’, then all ﬁve statistics assign the lowest score to {1,3,5} (data
not shown).

3 PERFORMANCE ON CRM IDENTIFICATION

First, we evaluate and compare the proposed statistics (2}(6) on
the CRM identification problem. Given a set of known
CRM sequences $0 = {s1,s2, ...,s,} that have a similar TFBS
regulatory pattern, and a set of candidate sequences
$1 = {c1,c2, ...,ck}, which contains both CRMs and back—
ground sequences, we group So with each candidate sequence
c,~ separately, where c,~ e 51. Then, we ﬁnd the similarity score
for each set of sequences {50; c,~} and predict that groups with
higher score have the higher similarity.

3.1 Simulation study

To simulate the data for the CRM identiﬁcation problem, we
generate two types of sequences: the ﬁrst type are to resemble
CRM sequences, with common binding motifs inserted, and the
second type are background sequences, without any motifs. For
simplicity, we refer to the ﬁrst type as CRM sequences in this
subsection. We generate the simulated sequences following the
‘common motif” model proposed in Reinert et al. (2009) but
under the first—order Markov chain sequence background
model instead of an i.i.d model.

Let A = {A,C, G, T} denote the nucleotide alphabet. For a
background sequence A1, . . . , A" of length n consisting of letters
from A, each letter Ak is generated sequentially under an irredu—
cible aperiodic first—order Markov chain model, parameterized
by a transition probability matrix T, where T ,3) = Prob(Ak+1 =
lek = i), i, j e A. Based on the transition matrix, we derive the
stationary distribution 71. Then, the letter A1 of the first position
is randomly chosen according to n, and subsequent letters AMI
are randomly generated depending on the previous letter Ak fol—
lowing the A2." row of the transition matrix T. Here, we use the
Markov transition matrix estimated from the real CRM
sequences in mouse forebrain.

To generate CRM sequences, we insert the motif word
m = AGCCA of length L = 5 randomly into the background
sequence at rate 1—).. That is, for a background sequence
A1,...,A,1 with length n, where Ak e A,k = 1, ...,n, we gener—
ate Bernoulli random variables Z1,Z2, ...,Zn,L+1 with
Prob(Zk = 1) = 1 — A. If for position k, Zk = 1, and no motif
has been inserted which overlaps position k, then we replace
AkAkH ...Ak+L,1 by the word m. Motif insertions are not
allowed to overlap.

This toy model is clearly overly simplistic; CRMs are often
deﬁned by their functional output rather than their motif con—
tent. Hence, the shared motif content of similar CRMs can be
rather complicated. Yet, the model picks up on one mechanism
that may relate CRMs, see Hardison and Taylor (2012), and it is
useful as a model to assess the performance of the ﬁve statistics.

 

2693

ﬁre'spzumofpmJXO'sopeuuquioiq/ﬁdnq

J.Ren et al.

 

Table 2. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for the CRM identiﬁcation problem on simulated
data over 100 repeats under a ﬁrst-order Markov chain, N = 1000, k = 5, |SO| = 10, |SCRM| = 100, |S,,,‘.g| = 100; 1 — A is the motif density

 

 

A C; C? C; C; C?”

(a) The 90% CI of AUC scores
0.95 [100,100] [0.650.83] [100,100] [100,100] [100,100]
0.97 [100,100] [0.570.75] [100,100] [100,100] [100,100]
0.99 [099,100] [0.480.63] [098,100] [093,098] [098,100]
0.991 [098,100] [046,062] [097,099] [091,097] [097,100]
0.993 [096,099] [046,062] [091,097] [0.82092] [092,098]
0.995 [0.88095] [0.450.59] [0.780.89] [0.690.82] [0.750.89]

(b) the 90% CI of the false positive rate at 20% sensitivity
0.95 [0.000.00] [0.000.06] [0.000.00] [0.000.00] [0.000.00]
0.97 [0.000.00] [0.010.12] [0.000.00] [0.000.00] [0.000.00]
0.99 [0.000.00] [0.070.24] [0.000.00] [0.000.00] [0.000.00]
0.991 [0.000.00] [0.070.26] [0.000.00] [0.000.01] [0.000.00]
0.993 [0.000.00] [0.080.25] [0.000.00] [0.000.02] [0.000.00]
0.995 [0.000.00] [0.100.27] [0.000.03] [0.000.08] [0.000.02]

 

Moreover, we can relate the results to previous studies such as
Reinert et al. (2009), which used the same toy model.

We set the length of sequences in both the positive and the
negative sets to N: 1000 base pairs. We consider A e {0.95,
0.97, 0.99,0.991,0.993,0.995}. For each value of A, we first gen—
erate 10 CRMs as the known CRM set So. Then, for the candi—
date set S 1, we generate 200 sequences in totalia set SCRM of
100 CRMs with the same motif word m and the same insertion
rate A as for So, and a set Sbkg of 100 background sequences. For
each of the following experiments, we simulate 100 repeats.

Table 2 shows (a) the 90% CI of AUC score and (b) the 90%
CI of false—positive rate at 20% sensitivity of the ﬁve similarity
measures (2}(6) over 100 repeats under the first—order Markov
chain sequence model, when N = 1000, k = 5, ISOI = 10,
ISCRMI = 100, lekgl = 100, A 6 {095,097, 0.99,0.991,0.993,
0.995}.

For the 90% CI of AUC scores, most of the statistics show a
good performance and, based on a 90% CI, are not statistically
signiﬁcantly different, with the exception of CS, which is outper—
formed by the other statistics. As Reinert et al. (2009) and Song
et al. (2013) ﬁnd that Shepp—type statistics are worse than star—
type statistics in their simulation studies, the poor perfomance of
Cf is not a surprise.

When A is larger than 0.995, the values of the AUC score for
our statistics become close to 0.5 (data not shown), which is the
AUC expected from random guesses. The reason behind this
deterioration is simply that the higher A is, the fewer motifs are
inserted in the generated CRM sequences. For example, when
A = 0.997, there are 30% of CRM sequences having at most one
instance of the motif inserted. When A = 0.999, then 65% of
CRM sequences have at most one instance of the motif inserted.
The 5% precision values give similar results, with much larger
standard deviations due to smaller numbers; they can be found in
the Supplementary Table S1.

The false—positive rates at 20% sensitivity are fairly low with
the exception of CS, which is outperformed by all other statistics
for large A.

3.2 Mouse tissue data

Although the results from the simulation study are encouraging,
we need to test the statistics on real data, and we use CRM data
as our test case. Tissue—speciﬁc enhancers in mouse embryos have
been identiﬁed in Blow et al. (2010) using ChIP—Seq technology
with the enhancer—associated protein p300. There are four tissues
under study, namely, forebrain, midbrain, limb and heart. We
take the four datasets one by one as our experimental data.

We ﬁlter out the CRM sequences that are too long or too
short because our statistics may not work well when there is
considerable heterogeneity in sequence length in conjunction
with a possible model mis—speciﬁcation. Therefore, we take se—
quences with length between 1000 and 1100 base pairs and
ensure a maximum of 30% of repetitive region, as our CRM
sequences. There are 106 of 2759 sequences meeting the criteria
in forebrain dataset, 142 of 2786 in midbrain, 102 of 3839 in limb
and 78 of 3597 in heart. Supplementary Table S4 of the supple—
mentary materials shows the results for the full dataset; they are
qualitatively similar.

As an indication of the strength of the regulatory patterns in
CRM, we use the QuEST Scores as provided in the supplemen—
tary table of Blow et al. (2010). We use the CRMs with the 15
highest QuEST scores as the candidate sequences for So and
denote them as 517000,; the set  of the remaining CRMs is
taken as set of candidate sequences for SCRM. For the set Sbkg,
we randomly select a set 5%? of sequences with the same length
as the sequences in $4 from the mouse genome.

We randomly choose 10 sequences from $300, to form the set
So, and 30 sequences from 512%! as well as 30 sequences from
522;, to form the candidate sequences set S 1. Assuming that the
sequences come from a first—order Markov chain model, we cal—
culate the ﬁve statistics (2)7(6) to score the similarity within each
set {50; c,~}, where c,~ e S 1, and evaluate their prediction accuracy
by the AUC. We repeat the experiment 30 times. Table 3 shows
(a) the 90% CI of AUC scores and (b) the 90% CI of false—
positive rate at 20% sensitivity of each of the ﬁve statistics in
mouse forebrain, midbrain, limb and heart tissue enhancers

 

2694

ﬁre'spzumofpmJXO'sopnuuquioiq/ﬁdnq

Multiple alignment-free sequence comparison

 

Table 3. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for the CRM identiﬁcation on four mouse tissue-
speciﬁc enhancer datasets, under a ﬁrst-order Markov chain; N = 1000 — 1100 bp, k = 5, |SO| = 10, |SCRM| = 30, ISMgl = 30

 

 

Tissue C; C? C; C; C?”

(a) The 90% CI of AUC scores
Forebrain [0520.69] [0670.85] [0.580.77] [0.550.74] [0.510.71]
Midbrain [0.510.71] [0.550.71] [0640.81] [0610.79] [0.530.74]
Limb [0.680.82] [0.580.83] [0690.86] [0640.81] [0620.83]
Heart [0.410.62] [0.520.77] [0.570.79] [0.580.78] [0.510.67]

(b) The 90% CI of the false-positive rate at 20% sensitivity
Forebrain [000019] [0.000.07] [0.000.14] [002019] [0.020.17]
Midbrain [0.070.25] [000020] [0.000.15] [0.000.15] [0.070.27]
Limb [0.000.08] [0.000.10] [0.000.05] [0.000.13] [0.000.12]
Heart [0.070.27] [0.000.17] [0.000.22] [0.030.17] [0.070.29]

 

datasets, under the ﬁrst—order Markov chain model and k = 5.
The average values are located fairly in the middle of the inter—
vals (data not shown).

For the AUC scores, all of the 90% CIs for each tissue type
overlap, indicating that the statistics perform similarly. It is not—
able that the 90% AUC CIs for the limb dataset are on average
higher than those in the other three datasets. This finding is
consistent with the fact that the sequences in limb dataset have
relatively high QuEST scores, indicating that the limb dataset has
a strong regulatory signal. Most of the 90% CIs for the false—
positive rate at 20% sensitivity contain 0, and they all overlap,
indicating again that the statistics perform similarly.

Summarizing our results from the simulation study and the
mouse tissue data, while all the statistics perform similarly on the
real data, in the simulation study the combined Shepp—type stat—
istic Cf is outperformed by the other statistics for large A.

4 PERFORMANCE ON MEASURING SIMILARITY

To assess whether a set of regulatory sequences such as the set of
CRMs are scored higher by our proposed statistics (2)7(3) and
(7}(9) than a set of unrelated sequences randomly chosen from
the genome, we construct the evaluation model as follows. We
make up two sets of sequences: the so—called positive set contain—
ing CRM sequences with a similar regulatory pattern and the so—
called negative set containing unrelated sequences randomly
chosen from the genome. The two sets are constructed to contain
the same number of sequences and have the same lengths. Each
triplet of three sequences from the positive set is measured for
their similarity by the proposed ﬁve statistics, and so is each
triplet in the negative set. We assess the statistics by ﬁrst ranking
all triplets from both positive and negative sets by their scores.
Triplets from the positive set are treated as ‘+’ and triplets from
the negative set are treated as ‘—’. For a given threshold, if the
value of a statistic for a triplet is above the threshold, the triplet is
predicted as ‘+’; otherwise the triplet is predicted as ‘—’.

4.1 Simulation study

Following the simulation methods detailed in Section 3.1, we
generate 50 CRM—like sequences for the positive set, and 50

background sequences for the negative set, all of length
N = 1000 base pairs. We carry out the experiment for motif in—
sertion rate A e {0.95, 0.97, 0.99, 0.991, 0.993, 0.995}. For each A,
we repeat the experiment 30 times and calculate the 90% CI of
AUCs together with that of the false—positive rate at 20% sensi—
tivity. Table 4 shows (a) the 90% CI of AUC score and (b) the
90% CI of false—positive rate at 20% sensitivity of the ﬁve simi—
larity measures on simulated data, under the first—order Markov
chain sequence model. 2

In this simulation study, the Shepp—type statistics Cf and C;

 

are outperformed by the other statistics when A is large, and W
is outperformed by the star—type statistics for A = 0.993. This
conclusion is consistent with the simulation results for the
CRM identification problem.

4.2 Mouse tissue data

In this section, we use the tissue—speciﬁc enhancers in mouse
embryos (Blow et al., 2010) again. Four tissues, forebrain, mid—
brain, limb and heart, are studied as separate datasets. Again,
we take the CRM sequences with 100071100 bp as our CRM
sequences pool. For the background sequences pool, we ran—
domly select sequences from the mouse genome, of the same
length as that of the CRM sequences.

For each tissue, we randomly choose 20 CRMs from the CRM
pool as the positive set, and we choose 20 background sequences
from the background sequences pool as the negative set. Then
we calculate statistics (2}(3) and (7)7(9) for the triplets from the
positive set and from the negative set, and we compute the AUC;
again we run 30 repetitions. Table 5 presents (a) the 90% CI of
AUC scores and (b) the 90% CI of false—positive rate at 20%
sensitivity for the five statistics on each of mouse four tissue—
speciﬁc enhancer datasets under the ﬁrst—order Markov chain
model, and k: 5; again the average AUC scores lie in the
middle of the intervals, and the 5% precision scores can be
found in the appendix.

For each tissue type, all of the 90% CIs overlap, showing that
the statistics perform similarly.

We repeated the experiment on the full dataset, without
restricting the sequence length, giving similar results, see

 

2695

ﬁm'spzumol‘pmyo'sopnuuquioiq/pdnq

J.Ren et al.

 

Table 4. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for measuring similarity within a set of sequences on
simulated data, under the ﬁrst-order Markov chain sequence model, N = 1000, k = 5, |positive set| = 50, |negative set| = 50; 1 — A is the motif density

 

 

A C; C? C; C; C?”

(a) The 90% CI of AUC scores
0.95 [100,100] [099,100] [100,100] [100,100] [100,100]
0.97 [100,100] [0.88095] [100,100] [100,100] [100,100]
0.99 [0.89099] [056,069] [095,099] [0.85091] [0.77091]
0.991 [0.83098] [0.510.70] [093,097] [0.820.88] [0.690.89]
0.993 [0670.88] [0.48065] [0.83091] [0.720.81] [0.570.78]
0.995 [0530.76] [0.480.70] [0.700.81] [0.630.73] [0.510.72]

(b) The 90% CI of false-positive rate at 20% sensitivity
0.95 [0.000.00] [0.000.00] [0.000.00] [0.000.00] [0.000.00]
0.97 [0.000.00] [0.000.00] [0.000.00] [0.000.00] [0.000.00]
0.99 [0.000.00] [0.050.14] [0.000.00] [0.000.01] [0.000.01]
0.991 [0.000.00] [0.040.19] [0.000.00] [0.010.01] [0.000.03]
0.993 [0000.01] [0.070.23] [0.000.01] [0.010.05] [0.010.12]
0.995 [0010.16] [0.050.23] [0.010.05] [004009] [0.030.21]

 

Table 5. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for measuring similarity within a set of sequences
based on four mouse tissue-speciﬁc enhancer datasets, under ﬁrst-order Markov chain background sequences, N = 1000 — 1100 bp, k = 5,

|positive set| = 20, |negative set| = 20

 

 

Tissues C; Cf C; c; 

(a) The 90% CI of AUC scores
Forebrain [0.62096] [0.600.87] [0.570.80] [0.510.79] [0.69097]
Midbrain [0.65093] [0.540.86] [0.580.83] [0.520.80] [0.68094]
Limb [0.75097] [0.510.83] [0.640.89] [0.550.83] [0.77099]
Heart [0.490.87] [0.470.74] [0.580.78] [0.500.72] [0.610.88]

(b) The 90% CI of the false-positive rate at 20% sensitivity
Forebrain [0.000.10] [0.000.13] [0.020.13] [0.030.22] [0.000.06]
Midbrain [0.000.11] [0.010.21] [0.010.14] [0.020.22] [0.000.10]
Limb [0.000.07] [0.010.16] [0.000.09] [0.010.15] [0.000.05]
Heart [0.010.16] [0.040.25] [0.020.12] [0.050.20] [0.000.12]

 

Supplementary Tables S11 and S12. Again the AUC scores have
relatively large deviations, and the differences between the AUC
scores of the different statistics are not statistically signiﬁcant.

5 THE EFFECT OF CONTAMINATION

To study the sensitivities of the statistics to the contamination of
So with random sequences, we carry out a simulation experi—
ment; we concentrate on the CRM identiﬁcation problem. For
the simulation with ISOI = 10, lSll = 100, |52| = 100, k = 5 and
N = 1000, we randomly replace 10, 20 and 30% of sequences in
So with background sequences, to model the contamination of
sequences in So. Figure 1 shows the results of this simulation.
We ﬁnd that both multiple alignment—free statistics C; and Cf
are relatively more sensitive to the contamination because
for A = 0.95, the AUC scores of Cf begins to drop at
10% random sequences mixed into So, and the AUC scores
of C; drops at the 20% contamination of So, whereas the

other three pairwise average statistics @, C; and W keep
their AUC scores to be 1. When A = 0.993, the statistics C;,
Cf and C;,?” have the Ewest lower bounds, whereas the
performance of C; and C; is relatively stable. As the AUC
scores of Cf have already been ~0.5 (near to random guess),
they do not decrease further.

The simulation study indicates that the multiple alignment—free
statistics perform well when the sequences in So have a strong
regulatory pattern, but the mixture of random sequences in So
could largely reduce the performance of the multiple alignment—
free statistics, compared with the pairwise average ones. In real
data, our results in Table 3 show the similar trend. Blow et al.
(2010) states that the forebrain CRM dataset is the most con—
served in the four datasets, indicating most of the forebrain
CRM sequences are real, and the fraction of random sequences
is low. In our results, Cf gives the best performance in forebrain
dataset at the average values. The fact is consistent with the
findings in Blow et al. (2010).

 

 

2696

ﬁm'spzumol‘pmyo'sopnuHOJmoiq/pdnq

Multiple alignment-free sequence comparison

 

 

 

a _ ox 10%20%3uw/. auto-220mm mlmzouwx omoxzomov.
4.
8
m
2 ° T
o is m"
U
m ° iTTT
o 3 mm“
D
< .. J—
3 o
2 E
o
°\° 2
8 N
c.
S
a
. . . . .
—- _s gee
CI CI CZ CZ C2
(b) — MEAT —
m 20% 2314233430,. _,_ BEET
cs 4. W 2w.
...,.TT ]_
.4 3w. 214m m.
% ° i
t
0 0'
III
0 w,
3 c.
< u, ...,...T...
~_ , m
0 ° J-J-_LJ.
(n V.
5 a
o\° 8
O
03 N,
c.
S
o
. . . . .
s —- _s gee
CI CI 02 c2 c2

Fig. 1. The 90% CI of AUC score (the bar) and average AUC scores (the
position of the number) of the ﬁve statistics for the CRM identiﬁcation
on 0, 10, 20 and 30% contaminated SO sequences, under a ﬁrst-order
Markov chain, N =1000,k = 5, |SO| = 10, ISCRMI = 100, ISMgl = 100;
1 — A is the motif density, and 0% refers to the results in Table 2, for
comparison with the case of no contamination of SO. The parameter
values are (a) A = 0.95 and (b) A = 0.993.

Further, to assess whether less contaminated data can improve
the performance of the multiple alignment—free statistics, we use
a more restricted criterion to construct So. In every experiment of
the 30 repeats, we randomly pick up ﬁve sequences from the
CRMs with the 10 highest QuEST scores to construct So, 30
sequences from the remaining CRMs with 50 highest scores to
construct SCRM and 30 sequences from the background se—
quences generated in the same way as before. In this setting
the average values of AUC score of the multiple alignment—free
statistics increase more than those of the pairwise average statis—
tics, although their CIs overlap.

6 DISCUSSION

The success of the alignment—free sequence comparison statistics
D; and D; as studied in Reinert et al. (2009) and Wan et al.
(2010) inspired us to deﬁne natural extensions for multiple
alignment—free sequence comparison. We propose two
families of multiple alignment—free statistics, C; and CS, which
involve products of more than two vectors, and we compare
these families to three families of average pairwise alignmen_t—
free statistics, C;, C—;9 and W, with generalizations @, C—;9
and 

Our statistics are tested on two problems, namely, the CRM
identification problem (given a set of CRMs, identify new CRMs
belonging to similar regulatory patterns as the given CRMs) and
measuring the similarity within a set of CRM sequences. We

 

evaluate the statistics both on simulated data and on mouse
tissue data.

For both the CRM identiﬁcation and measurement of the
similarity within a set of CRM sequences, in simulations, the
Shepp—type statistics are outperformed by other statistics when
A is large, whereas on real data, all of the 90% CIs overlap. The
false—positive rate at 20% sensitivity is encouragingly small not
only in simulations but also in real data. Contamination has a
stronger effect on the multiple statistics than on the pairwise
average statistics.

While Song et al. (2013) and Jiang et al. (2012) observed that
the Shepp—type statistics outperform the star—type statistics for
the comparison of whole—genome sequences and metagenomic
communities, respectively, based on NGS reads data, here our
data do not confirm this finding. Our data are consistent with the
simulation results in Reinert et al. (2009); Wan et al. (2010),
which show that for short sequences the star—type statistics per—
form better, whereas for long sequences, the Shepp—type statistics
perform better; the CRM sequences in this article are of length
of order 1000 bp and can hence be considered as short.

Our results on the real dataset when restricted to sequences
of length 100(L1100 bp do not differ significantly from those
on the full real dataset, indicating that our statistics control for
sequence length.

Although on the CRM data we use, there is no signiﬁcant
difference between all ﬁve statistics, we conjecture that on
high—quality data, the multiple statistics may outperform the
average pairwise statistics. With the impending arrival of more
high—quality data, our suite of statistics provides a toolbox ready
to be used.

Pairwise alignment—free statistics have been generalized to
allow for k—tuple word mismatches, see Burden et al. (2008)
and Goke et al. (2012). It would be straightforward to extend
our multiple alignment—free statistics to allow for word mis—
matches; the choice of mismatch weights is however not obvious,
see Goke et al. (2012).

ACKNOWLEDGEMENTS

The authors would like to thank the referees for very helpful
comments, which improved the article.

Funding: G.R. was supported in part by the Oxford Martin
School. F.S. is partially supported by US NIH R21HG006199;
and NSF DMS—1043075 and OCE 1136818. MD. is supported
by the National Natural Science Foundation of China
(31171262, 11021463), and the National Key Basic Research
Project of China (2009CB918503).

Conﬂict of Interest: none declared.

REFERENCES

Arunachalam,M. et a]. (2010) An alignment—free method to identify candidate
orthologous enhancers in multiple drosophila genomes. Bioinformutics, 26,
210972115.

Blaisdell,B. (1986) A measure of the similarity of sets of sequences not requiring
sequence alignment. Proc. Natl Acad. Sci. USA, 83, 515575159.

Blow,M. et a]. (2010) Chip—seq identiﬁcation of weakly conserved heart enhancers.
Nat. Genet, 42, 8064510.

 

2697

ﬁm'spzumol‘piqxo'sopnuHOJmoiq/pdnq

iRenetaL

 

Burden,C. et ul (2008) Approximate word matches between two random sequences.
Ann. App]. Probub., 18, 1721.

Davidson,E. (2006) The Regulatory Genome: Gene Regulatory Networks In
Development and Evolution. Elsevier, Burlington, MA.

Goke,J. et ul (2012) Estimation of pairwise sequence similarity of mammalian
enhancers with word neighbourhood counts. Bioinformutics, 28, 656—663.

Hardison,R.C. and Taylor,J. (2012) Genomic approaches towards ﬁnding cis—
regulatory modules in animals. Nat. Rev. Genet, 13, 469483.

Jiang,B. et ul (2012) Comparison of metagenomic samples using sequence signa—
tures. BMC Genomics, 13, 730.

Kantorovitz,M. et ul (2007) A statistical method for alignment—free comparison of
regulatory sequences. Bioinformutics, 23, i24$i255

Lippert,R. et ul (2002) Distributional regimes for the number of k—word
matches between two random sequences. Proc. Natl Acud. Sci. USA, 99,
13980713989.

Liu,X. et ul (2011) New powerful statistics for alignment—free sequence comparison
under a pattern transfer model. J. Theor. Biol, 284 (1), 10(r116.

Needleman,S. et ul (1970) A general method applicable to the search for similarities
in the amino acid sequence of two proteins. J. Mol Biol, 48, 443453.

Quine,M. (1994) A result of Shepp. Appl. Math. Lett., 7, 27732.

Reinert,G. et ul (2009) Alignment—free sequence comparison (i): smtistics and
power. J. Comput. Biol, 16, 161571634.

Shepp,L. (1964) Normal functions of normal random variables. SIAM Rev., 6,
459460.

Sing,T. et ul (2005) ROCR: visualizing classiﬁer performance in R. Bioinformutics,
21, 394G394].

Smith,T. and Waterman,M. (1981) Identiﬁcation of common molecular subse—
quences. J. Mol Biol, 147, 1957197.

Song,K. et ul (2013) Alignment—free sequence comparison based on next generation
sequencing reads. J. Comput. Biol, 20, 64479.

Wan,L. et ul (2010) Alignment—free sequence comparison (ii): theoretical power of
comparison statistics. J. Comput. Biol, 17 (11), 146771490.

Wolff,C. et ul (1999) Structure and evolution of a pair—rule interaction element: runt
regulatory sequences in D. melanogaster and D. virilis. Mech. Dev., 80, 87799.

 

2698

/810's112um0fp10}x0"soiJBuIJOJuioiqﬂ:duq

