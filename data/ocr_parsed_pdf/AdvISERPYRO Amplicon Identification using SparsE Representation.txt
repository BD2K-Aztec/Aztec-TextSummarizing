BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

m"

1.:-u l

l \



W

 

/3.10'S[Bum0[p10}x0'SOpBLUJOJuyqu”:duq

AdVISER-PYRO

 

distinct amplicons. For SAS signals, the AdvISER—PYRO per—
formance was compared with the percentage of correct identiﬁ—
cation obtained with the pyrosequencing data analysis software
(PSQTM 96 MA Software V.2.1.1, Biotage AB, Sweden) and re—
ﬂecting the pyrogramTM translation into a correct nucleotide
sequence.

2 METHODS

Signals were generated with a pyrosequencer PSQTM 96 MA (Biotage
AB, Sweden), following successive dispensation of 26 nucleotides. The
predeﬁned order of dispensation of these nucleotides was determined
according to the sequence tag corresponding to a hypervariable region
of the M ycobacterium genome. Accordingly, dispensed nucleotides pro-
duced distinct pyrogramTM peaks, each peak height being proportional to
the number of identical nucleotides consecutively incorporated. In this
study, a signal is deﬁned as the global pattern integrating the 26 succes-
sive peak heights.

All amplicons of the current M ycobacterium target sequence started
with the same single nucleotide. Accordingly, the ﬁrst peak height was
named ‘First Unitary Peak Height’ (FUPH) and was used as an indicator
of the global signal intensity. Pyrosequencing was performed as classically
described. In brief, the M ycobacterium target sequence was ﬁrst ampliﬁed
by PCR. The PCR ampliﬁcation was carried out using a couple of for-
ward and biotinylated reverse primers. The biotinylated amplicons were
immobilized on streptavidin-coated magnetic beads and denaturated.
After denaturation, the biotinylated single-stranded amplicon was iso-
lated and allowed to hybridize with a sequencing primer. Owing to the
close relatedness of some mycobacterial species (e.g. M.marinum and
M .ulcerans) on one hand, and the genetic heterogeneity within other spe-
cies (e.g. M .gordonae), a single amplicon can correspond to more than
one mycobacterial species and conversely, a mycobacterial species can be
associated with more than one speciﬁc amplicon (Table 1).

Pyrosequencing signals were generated from SAS (n = 220) and MAS
(n = 144). SAS were generated from single mycobacterial clinical isolates.
Three distinct types of MAS were analyzed in the current study. MAS-1
were generated by mixing in various proportion (SO/50%; 33/66%) the
ampliﬁcation products generated from two separate PCR performed on
two distinct mycobacterial clinical isolates (n = 84). MAS-2 were gener-
ated with a single PCR performed on a reconstructed sample where DNA
from two distinct mycobacterial clinical isolates were mixed in various

Table 1. Correspondence between amplicons and mycobacterial species

proportions (10/90%; 25/75%; 50/50%; 75/25%; 90/10%) (n=45).
MAS-3 were generated with a single PCR performed on natural clinical
samples from patients with a mycobacterial co-infection (n=15). In
MAS-2 and MAS-3, the final proportion of both amplicons after PCR
ampliﬁcation was unknown because of the amplicon-speciﬁc efﬁciency of
the PCR reaction likely altering the initial DNA proportions. The esti-
mated proportion of the minor amplicon could therefore vary widely
between 0.1% and 50.0%.

All SAS and MAS signals were divided into training (SAS, n=99),
validation (SAS, n: 103; MAS, n: 122) and test (SAS, n: 18; MAS,
n=22) datasets. A standardized learning dictionary was constructed
based on signals from the training dataset. AdvISER-PYRO hyperpara-
meters were tuned on the validation dataset while performance was as-
sessed on the test dataset. Given the small size of the test dataset, a
bootstrap method was also applied to provide a reliable evaluation of
AdvISER-PYRO performance.

In parallel, all PyrogramsTM from SAS were also analyzed with the
pyrosequencing data analysis software (PSQTM 96 MA Software V.2.1.1,
Biotage AB, Sweden) and translated into nucleotide sequences.

3 ALGORITHM

The ﬁrst step in developing the AdvISER—PYRO was to create a
standardized learning dictionary from the training dataset (SAS,
11:99) that included at least one signal (i.e. the global pattern
integrating the 26 successive peak heights) for each amplicon.
Standardization of the dictionary was performed by dividing
each signal (i.e. the 26 successive peak heights) by its correspond—
ing FUPH. After standardization, all signals in the learning
dictionary were therefore characterized by a FUPH equal to 1.

The second step was to build a penalized linear model with the
y testing signal as response variable and all signals from
the learning dictionary as predictor variables. In this model,
the sum of regression coefﬁcients corresponding to each ampli—
con was computed and recorded as the amplicon contribution to
the signal. As the number of observations (i.e. the length of the
signal which was 11:26) was smaller than the number of vari—
ables (i.e. the total number of atoms in the learning dictionary
which was P> 33), L1 — and L2—norm penalties were applied for
estimating the regression coefﬁcients. These penalties were the

 

 

Amplicon M ycobacterium Amplicon M ycobacterium Amplicon M ycobacterium
Ampliconl M .avium subsp. avium Amplicon12 M. inteijectum Amplicon24 M paraﬂimcum

M .a vium subsp. paratuberculosis Am plicon l 3 M. marseillense Amp lico n2 5 M .S cm fula ceum

M .a vium subsp. Silvaticum Amplicon l 4 M. intracellulare Amplicon2 6 M .Scrofulaceum
Amplicon2 M .bohemicum Amplicon15 M. kansasii Amplicon27 M .scrofulaceum
Amplicon3 M .celatum Amplicon16 M. lentiﬂa mm M paraﬂimcum
Amplicon4 M .celatum Amplicon17 M. lentiﬂa vum Amplicon28 M .simiae
AmpliconS M .chelonae Amplicon18 M .malmoense Amplicon29 M .simiae

M .abscessus Amplicon19 M .marinum Amplicon30 M .szulgai
Amplicon6 M . gmtri M. ulcerans Amplicon3 1 M .genavense
Amplicon7 M .gordonae Amplicon20 M .mm chromogenicum M .triplex
AmpliconS M .gordonae M. ratisbonense Amplicon32 M .tuberculosis
Amplicon9 M .gordonae Amplicon2l M. mm chromogenicum M170 vis
Amplicon l 0 M .hiberniae Amplicon22 M .mm chromogenicum M .africanum
Ampliconl 1 M .inteijectum Amplicon23 M . parafﬁn icum Amplicon3 3 M .Xenopi

 

 

1 965

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

J.Ambroise et al.

 

ﬁrst two hyperparameters of AdvISER—PYRO. As the signal
contribution from each atom should have a positive value, an
additional constraint imposing this prerequisite was imple—
mented. The intercept of the model was also set to 0. The pena—
lized regression models were built using the penalized function of
the corresponding R package (Goeman, 2008).

In the third step, amplicons that significantly contributed to
the signal were selected. A speciﬁc amplicon was considered sig—
niﬁcant when its contribution to the signal was higher than the
Signiﬁcant Contribution Threshold, which was the third hyper—
parameter of AdvISER—PYRO.

4 RESULTS
4.1 Hyperparameter optimization on the validation
dataset

All signals from the validation dataset (SAS, n: 103; MAS,
n: 122) were used to evaluate and optimize AdvISER—PYRO
hyperparameters. Accordingly, the percentage of correct identi—
ﬁcation of SAS and MAS signals were computed with various
values of the L1— and L2 —norm penalties and of the Signiﬁcant
Contribution Threshold. For SAS and MAS signals, a right iden—
tification was recorded when AdvISER—PYRO correctly identi—
ﬂed the unique amplicon (SAS) or the pair thereof (MAS). Any
incorrect signal identiﬁcation included the wrong prediction of
an additional (false—positive) amplicon. The percentages of cor—
rect SAS and MAS signal identiﬁcation using the validation
dataset are given in Table 2. It was impossible to compute the
percentage of correct identiﬁcation with zero L1 — and L2 —norm
penalties, as the number of dimensions (P299) exceeded the
number of observations (n = 26).

The effects of L1 — and Lz—norm penalties were very different,
as generally accepted in literature. Ll—norm penalty tends to
produce many regression coefficients shrunk exactly to zero
and a few other regression coefﬁcients with comparatively little
shrinkage. At the opposite, L2—norm penalty tends to result in
all small but nonzero regression coefﬁcients (Goeman et al.,
2012). In the current application, this second effect induced an
important decrease of the percentage of correct identiﬁcation.
The effect of the SCT hyperparameter on the percentage of cor—
rect identiﬁcation was different for SAS and MAS signals. With
SAS signals, higher value of SCT improved the results by
decreasing the number of false—positive results. With MAS sig—
nals, the optimal SCT value resulted from a compromise between
the minimisation of false—positive (less frequent with a high SCT
value) and false—negative (less frequent with a low SCT value)
results.

4.2 Percentage of correct identification on the test dataset

All SAS (n: 18) and MAS signals (n=22) of the test dataset
were analyzed with AdvISER—PYRO. The algorithm hyperpara—
meters were chosen according to the percentage of correct SAS—
and MAS—signal identification using the validation dataset. The
Significant Contribution Threshold was therefore set to 2 whereas
the L1— and Lz—norm penalties were set to 0.05 and 0, respect—
ively. These hyperparameter values produced indeed the best
compromise between the percentage of correct identiﬁcation
with SAS (94.2%) and MAS signals (77.9%).

Among the 18 SAS signals, all (100%) were correctly trans—
lated into their corresponding single sequence. Among the 22
MAS signals, 16 (72.7%) were translated into their correct se—
quence pair. The six remaining MAS signals (27.3%) were trans—
lated by AdvISER—PYRO into one correct sequence whereas

Table 2. Percentage of correct SAS- and MAS-signal identification with AdvISER-PYRO according to L1— and L2 —norm penalties and the Signiﬁcant

Contribution Threshold

 

 

 

 

Signiﬁcant contribution threshold L1 —norm SAS (n = 103) MAS (n = 122)
Lz—norm Lz—norm
0.00 0.01 0.05 0.10 0.50 0.00 0.01 0.05 0.10 0.50
1 0.00 / 90.3 84.5 82.5 68.9 / 62.3 58.2 52.5 29.5
0.01 89.3 89.3 84.5 82.5 68.9 65.6 62.3 59.0 52.5 29.5
0.05 89.3 90.3 84.5 82.5 68.9 67.2 62.3 59.0 52.5 29.5
0.10 89.3 90.3 84.5 82.5 68.9 66.4 61.5 59.0 52.5 29.5
0.50 89.3 90.3 84.5 82.5 68.9 65.6 63.1 59.0 51.6 29.5
2 0.00 / 94.2 93.2 91.3 83.5 / 77.0 75.4 73.0 59.0
0.01 94.2 94.2 93.2 91.3 83.5 77.9 77.0 74.6 73.0 59.0
0.05 94.2 94.2 93.2 91.3 83.5 77.9 77.0 73.8 73.0 59.0
0.10 94.2 94.2 93.2 91.3 83.5 77.9 77.0 74.6 73.0 59.0
0.50 94.2 94.2 93.2 91.3 83.5 77.0 77.9 75.4 71.3 59.0
3 0.00 / 95.1 95.1 94.2 90.3 / 66.4 66.4 65.6 59.0
0.01 95.1 95.1 95.1 94.2 90.3 66.4 66.4 65.6 65.6 59.0
0.05 95.1 95.1 95.1 94.2 90.3 66.4 66.4 66.4 65.6 59.0
0.10 95.1 95.1 95.1 94.2 90.3 66.4 66.4 66.4 65.6 59.0
0.50 95.1 95.1 95.1 94.2 90.3 67.2 65.6 65.6 64.8 58.2

 

 

1966

ﬁm'spzumofpmﬂo'sopnuuopnorq/ﬁdnq

AdvISER-PYRO

 

the other expected sequence from the pair was missing
(false—negative). Each false—negative sequence resulted from the
analysis of a MAS—2 signal where estimated contribution of the
corresponding minor amplicon was lower than the Significant
Contribution Threshold.

4.3 Bootstrap evaluation of the percentage of correct
identiﬁcation

Given the small size of the test dataset, a 100—fold bootstrap
approach was used to obtain a reliable evaluation of the percent—
age of correct identiﬁcation. The bootstrap was applied on all
SAS (n: 220) and MAS (n: 144) signals. At each iteration, the
SAS signals were randomly divided into a training (n: 101) and
a test dataset (n: 119). All MAS signals (n = 144) were included
in the test dataset. To limit the computation time, the AdvISER—
PYRO hyperparameters were not optimised for each iteration
(using an internal cross—validation loop) but were kept constant
across all iterations (Significant Contribution Threshold :2;
L1 —norm 2 0.05, L2—norm = 0).

A large majority (94.4%) of SAS signals were correctly trans—
lated into their corresponding single sequence. Only few (2.5%)
SAS signals were falsely translated into two or more distinct
sequences, and these always included the correct sequence and
another sequence being not present in the sample (i.e. false—posi—
tive). The remaining SAS signals (3.1%) were translated into a
single wrong sequence.

Most MAS signals (74.5%) were correctly translated into their
corresponding sequence pair. However, the percentages of cor—
rect identiﬁcation differed signiﬁcantly between the three distinct
types of MAS signals. For MAS—1, most signals (93.3%) were
correctly translated into the correct sequence pair. Few MAS—1
signals (2.6%) were translated by AdvISER—PYRO into one cor—
rect sequence whereas the other expected sequence from the pair
of amplicons was missing (i.e. false—negative) or wrong. Few
MAS—1 signals (4.1%) were predicted with a third additional
sequence (i.e. false—positive). The signal contributions of both
amplicons were generally well—balanced but not perfectly repre—
sentative of the amplicon proportion within the sample. The
relative signal contribution of the minor amplicon was
37.2:1: 10.2% for samples with 50/50% and 22.8:1: 1.1% for
samples with 33/66% of both amplicons. For MAS—2 and
MAS—3, some signals (53.9% for MAS—2 and 30.7% for
MAS—3) were correctly translated into the correct sequence
pair. Some MAS—2 and MAS—3 signals (46.1% for MAS—2 and
51.5% for MAS3) were translated by AdvISER—PYRO into one
correct sequence whereas the other expected sequence from the
pair of amplicons was missing (i.e. false—negative) or wrong.
Some MAS—3 signals (17.8%) were predicted with a third add—
itional sequence (i.e. false—positive).

4.4 Comparison with the PSQTM 96 MA Software
V.2.l.l.

A leave—one—out cross—validation was applied on AdvISER—
PYRO to produce a single and unique answer for each SAS
signal. Six amplicons were excluded from the comparison be—
tween both methods. These amplicons presented a single
pyrosequencing signal that was automatically included within

the dictionary and was consequently excluded from the test data—
set. The comparison was therefore performed on 114
PyrogramsTM .

Most SAS signals (208/214; 97.2%) were correctly translated
into a single correct sequence by AdvISER—PYRO. This percent—
age of correct identification was much higher than the percentage
obtained with the PSQTM 96 MA Software V.2.1.1. that trans—
lated 121/214 (56.5%) PyrogramsTM into correct nucleotide se—
quences. Compared with this software, the percentage of correct
identiﬁcation obtained with AdvISER—PYRO was particularly
high at low (FUPH < 5) signal intensities (Fig. 2).

4.5 Illustration of AdvISER-PYRO application

Figure 3 illustrates the results obtained with AdvISER—PYRO
when applied on four distinct pyrosequencing signals.

In Figure 3A, a signal with a low FUPH (2.49) was generated
from a SAS. Despite this low signal—to—noise ratio, the signal was
correctly converted in the corresponding single nucleotide
sequence (amplicon 32). The correlation coefficient (r) between
the predicted values of the penalized regression model and the 26
values of the signal was higher than 0.99, conﬁrming the identi—
ﬁcation reliability obtained with AdvISER—PYRO.

In Figure 3B, the signal was generated from a MAS—1 includ—
ing PCR product of amplicons 32 and 14 in equivalent propor—
tion (50/ 50%). Both amplicons were correctly identified by
AdvISER—PYRO and the signal contributions of both amplicons
were well—balanced but not perfectly equivalent (41 /59%). The
correlation coefﬁcient (r) between the predicted values of the
penalized regression model and the 26 values of the signal was
higher than 0.99, conﬁrming the identiﬁcation reliability ob—
tained with AdvISER-PYRO.

In Figure 3C, the signal was generated from an SAS including
a single amplicon, which was excluded from the dictionary. The
contributions of atoms corresponding to two distinct amplicons
(amplicons 07 and 08) are wrongly identiﬁed by AdvISER—
PYRO. However, this situation induces a low correlation coeffi—
cient (r:0.759) between the predicted values of the penalized
regression model and the 26 values of the signal, pointing out
the low reliability of the AdvISER—PYRO identiﬁcation and
allowing the operator to reject this result.

 

100
I

 

80
I

 
    

Rate of correct
signal interpretation
60
I

I AdvISEkiPY'RO
I mo“ 95 MA SoﬁwnreVlJJ

4o
.

20
I

 

 

 

0 § 1'0 1'5 2'0 2'5 3'0 3'5 4'0 4'5 5'0 5'5 6'0 0'5 7'0 7'5 2'0
First Unitary Peak Height

Fig. 2. Comparison of the percentage of correct identiﬁcation as a func-
tion of signal intensities (FUPH). The comparison was performed be-
tween AdvISER-PYRO and the PSQTM 96 MA Software V.2.1.1,
using Local Polynomial Regression Models on identiﬁcations obtained
with SAS signals. The symbols on the x-axis represent the distribution of
the FUPH in the SAS dataset

 

1 967

ﬁm'spzumofpmJXO'sopnuuopnorq/ﬁdnq

I Amplicon 18

l Amplicon 32

l Amplicon 32

l Amplicon 07

53x\EwogmoHannwbxmoHEoﬁsiwbHQ

AdvISER-PYRO

 

satisﬁes this second prerequisite (i.e. if it produces distinct ampli—
con—speciﬁc signals). However, choosing a selected dispensation
order can be advantageous to maximise the signal differences
inherent to pyrosequencing signals produced respectively by
each type of amplicon according to the genotyping application.
Maximising signal differences could also be achieved by increas—
ing the number of dispensed nucleotides with the deleterious
consequence that long reads are associated with higher
peak height variance. Consequently, the choice of an optimal
nucleotide dispensation order is based on a difﬁcult compromise
between the quantity and the quality of the acquired
information.

In the context of oncogene re—sequencing in heterogeneous
tumor cell samples, AdvISER—PYRO could be used as a tool
complementary to Pyromaker (Chen et al., 2012). The latter is
used to complete the representative learning dictionary by gen—
erating a theoretical pyrosequencing signal for each mutation
for which no biological sample is yet available; hence, experi—
mental signal is still lacking in the dictionary. If multiplex
pyrosequencing needs to be carried out, AdvISER—PYRO
could be applied to the analysis of complex signals obtained
with multiplex primers designed with the mPSQed software
(Dabrowski and Nitsche, 2012). In this study, AdvISER—
PYRO showed a high percentage of correct identification
with signals generated from samples containing two distinct
amplicons. Although this has not been yet tested and needs
to be validated, it should be pointed out that AdvISER—PYRO
can also be used on samples containing more than two distinct
amplicons.

In the present study, the optimisation of AdvISER—PYRO
hyperparameters was done on a validation dataset to obtain
the higher percentage of correct identification, irrespective of
the impact of a false—positive or —negative results. However,
such optimisation should ideally be performed for each genotyp—
ing application by considering the global clinical context. In
oncogene re—sequencing applications, the SCT could indeed be
defined in terms of relative contribution by estimating the Limit
of Blank (LoB) from a dilution series experiment. This LoB
could be modulated to limit the probability of either false—nega—
tive or —positive results by considering the clinical impact relative
to both types of error.

As illustrated here, AdvISER—PYRO is expected to substan—
tially help improve the reading and translation of the
pyrogramTM into a correct sequence or set of sequences in case
of SAS and MAS signals, respectively. Validation and optimiza—
tion of AdvISER—PYRO in clinical applications other than
mycobacterial genotyping are already under way.

ACKNOWLEDGEMENT

We would like to thank Michel Heusterspreute for his scientiﬁc
and technical support in the design and development of pyrose—
quencing assays.

Funding: This work was supported by the Defence Laboratories
Department of the Belgian Armed Forces.

Conflict of Interest: none declared.

REFERENCES

Amir,A. and Zuk,O. (2011) Bacterial community reconstruction using compressed
sensing. J. Comput. Biol, 18, 172371741.

Amoako,K. et a]. (2012) Rapid detection and antimicrobial resistance gene proﬁling
of yersinia pestis using pyrosequencing technology. J. Microbiol. Methods, 90,
228734.

Chen,G. et a]. (2012) A virtual pyrogram generator to resolve complex pyrosequen—
cing results. J. Mol. Diagn., 14, 1497159.

Covert,T. et a]. (1999) Occurrence of nontuberculous mycobacteria in environmen—
tal samples. Appl. Environ. Microbiol, 65, 249272496.

Dabrowski,P. and Nitsche,A. (2012) mPSQed: a software for the design of multiplex
pyrosequencing assays. PloS One, 7, e38140.

Dabrowski,P.W. et a]. (2013) MultiPSQ: a software solution for the analysis of
diagnostic n—plexed pyrosequencing reactions. PloS One, 8, e60055.

Deccache,Y. et a]. (2011) Development of a pyrosequencing assay for rapid assess—
ment of quinolone resistance in acinetobacter baumannii isolates. J. M icrobiol.
Methods, 86, 1157118.

Goeman,J. (2008) Penalized: L1 (lasso) and L2 (ridge) penalized estimation in
GLMs and in the cox model. R package version 09—21 2008, http://cran.
r—project.org/web/packages/penalized/ (3 July 2013, date last accessed).

Goeman,J. et a]. (2012) L1 and L2 penalized regression models. cran.r—project.or.

Gopinath,K. and Singh,S. (2009) Multiplex PCR assay for simultaneous detection
and differentiation of mycobacterium tuberculosis, mycobacterium avium com—
plexes and other mycobacterial species directly from clinical specimens. J. Appl.
Microbiol, 107, 4254135.

Huang,K. and Aviyente,S. (2007) Sparse representation for signal classiﬁcation.
Adv. Neural Inform. Proces. SVSI., 19, 609.

Ronaghi,M. (2001) Pyrosequencing sheds light on DNA sequencing. Genome Res.,
11, 3711.

Ronaghi,M. and Elahi,E. (2002) Pyrosequencing for microbial typing.
J. Chromatography B, 782, 67772.

Rosen,M. et a]. (2012) Denoising PCR—ampliﬁed metagenome data. BMC
Bioinformatics, 13, 283.

Shen,S. and Qin,D. (2012) Pyrosequencing data analysis software: a useful tool for
EGFR, KRAS and BRAF mutation analysis. Diagnostic Pathol., 7, 56.

Sundstrom,M. et a]. (2010) KRAS analysis in colorectal carcinoma: analytical as—
pects of pyrosequencing and allele—speciﬁc PCR in clinical practice. BMC
Cancer, 10, 660.

Tibshirani,R. (1996) Regression shrinkage and selection via the lasso. J. R. Stat.
Soc. B Methodol, 2677288.

Zheng,C. et a]. (2011) Metasample—based sparse representation for tumor classiﬁ—
cation. Comput. Biol. Bioinform., 8, 127371282.

Zou,H. and Hastie,T. (2005) Regularization and variable selection via the elastic
net. J. R. Stat. Soc. E Stat. Methodol, 67, 3017320.

 

1 969

ﬁre'spzumofpmJXO'sopnuuowrorq/ﬁdnq

