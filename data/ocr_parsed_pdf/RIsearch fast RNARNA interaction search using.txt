BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

RIsearch

 

It is furthermore of interest to use the homology information
from multiple structural alignments of ncRNA candidates for
interaction prediction. Recent computational approaches that
address this are PETcofold (Seemann et al., 2011) and ripalign
(Li et al., 2011). Other methods that work on pairs of single
sequences include PairFold (Andronescu et al., 2005), RNAup
(Muckstein et al., 2006) and inteRNA (Alkan et al., 2006).
However, such approaches which take both intra— and intermo—
lecular base pairings into account seem in general to be less suit—
able for genome—wide interaction screens.

It is therefore relevant to develop fast methods to search for
putative RNAiRNA interactions not only for existing ncRNA
candidates, but also to find novel RNAs which, for example,
hold the potential to be lineage speciﬁc or perform lineage—
speciﬁc functions (Bentwich et al., 2005; Ohhata et al., 2011).

The computational prediction of RNAiRNA interactions is a
rapidly growing research area. As discussed in Seemann et a].
(2011), several classes of algorithms with increasing complexity in
time and memory were developed. Here, we consider algorithms
that use a thermodynamic energy model for predicting intermo—
lecular interactions, while ignoring intramolecular structures. An
early method was RNAhybrid (Rehmsmeier et al., 2004) which
makes use of the full energy model, only excluding intramolecu—
lar base pairings and multiloops. This yields a complexity of
0(m-n) in memory and 0(Z2 - m-n) in time, with m and n
being the lengths of query and target, respectively, and I the
maximum loop length. Hodas and Aalberts (2004) explicitly
noted the analogy between SmithiWaterman sequence alignment
(Smith and Waterman, 1981) and intermolecular RNA pairing.
Their implementation in BINDIGO handles different loop types
with different states and dynamic programming (DP) matrices. A
recent and faster method is RNAplex (Tafer and Hofacker, 2008;
Tafer et al., 2011), which uses a simpler energy model in the ﬁrst
‘scanning phase’. It approximates larger loops with a linear
model, thereby discarding the length—dependent term and thus
the factor I2 in time complexity. It also reduces memory con—
sumption to a linear scaling. In a second step, the full energy
model can be used on sub—sequences to refine potential binding
sites. Even though RNAplex decreases time complexity while
maintaining a thermodynamic model, applying it to
genome—wide screens is still a computationally demanding task.

Here, we simplify the energy model even further, with the goal
of designing a screening method for RNAiRNA interactions
that can be used as a pre—fllter for computationally complex
methods in genome—wide screens. Consequently, our goal here
is to search for near—complementary regions. To our knowledge,
the fastest tool for such a task is RNAplex which recently was
extended to use the information from multiple sequence align—
ments as well as pre—computed accessibility proflles. However,
when searching for near—complementary regions, the energy
model of RNAplex can be simplified further. Here, we introduce
RIsearch, which implements a simpler state model that essen—
tially takes all stacked base pairs into account, but averages
costs over loop openings, internal loops and bulges. This is rea—
lized by an alignment—like algorithm that treats dinucleotides as
the elementary unit of a 36 x 36 scoring matrix. An additional
layer of heuristics can be used for genome—wide searches, which
reduces the search space by first identifying short stretches of
complementarity and extending those with RIsearch. It is

beyond the scope of this work to fully address this additional
step. One major consideration here is the GiU wobble, which
has been addressed earlier, e.g. in GUUGle (Gerlach and
Giegerich, 2006).

2 MATERIALS AND METHODS
2.1 The algorithm

The underlying algorithm of RIsearch can be seen as an extension of the
Smith7Waterman£otoh algorithm (Gotoh, 1982; Smith and Waterman,
1981) for local sequence alignment. To find putative interaction sites, we
look for complementarity rather than similarity/identity. A similar idea
has been used in the so-called ‘individual base pair model’ introduced by
TargetRNA (Tjaden et al., 2006; Tjaden, 2008). The crucial difference
is that our scoring scheme is based on dinucleotides instead of single
nucleotides. This allows us to reﬂect the main properties of the
nearest-neighbor free energy model, which is widely applied for RNA
folding (see below for details on the scoring scheme). It can also be con-
sidered as a scoring scheme taking di-residue substitutions into account
with gaps being an explicit part of the scoring scheme (Akbasli, 2008). An
alignment approach making use of di-residue substitutions, but with
other gap scoring was introduced as well (Crooks et al., 2005).

When neglecting intramolecular base pairing, the only structural elem-
ents that need to be considered are stacked pairs, bulges and interior
loops. Contributions from dangling ends and terminal mismatches are
excluded to keep the algorithm simple and fast. We use a three-state
model (Fig. 1), with an M-state for consecutive matches (stacked pairs)
and mismatches (interior loops) and Bq/Bt states for gaps (bulges) in
either sequence (query q or target I). All interactions come from the
I(nitiation)-state and terminate in E(nd). All scores S are deﬁned in one
scoring matrix, where S(q,»,1, qi; tj+1,tj) denotes the energy for stacking
the base pair (qi, tj) on (qi,1,tj+1). q,» refers to the ith nucleotide in the
query, If to the jth nucleotide in the target. Both are indexed in 5’- to 3’-
direction from 1 to m, respectively, n. As two RNA strands interact

9171 42
ti+1 ti

 

S???) 5611;)
Fig. 1. The ﬂow in the three-state model. This state model has been
(developed for and) proven useful before in the pairwise alignment of
amino acid sequences using doublets, hereby taking into account correl-
ation of neighboring residues (Akbasli, 2008). Here, the dashes indicate
bulges or asymmetric internal loops, but are equivalent to gaps when the
state model is applied to sequence alignments. States are represented by
circles, transitions by connecting arcs. The number of pairs in the circles
indicate the index increments to reach that state, e.g. for the Bq-state
(bulge in query) only the q(uery) index is incremented, thus ‘(+1,0)’,
while the M-state is reached by (mis)matching two residues, so both in-
dices are updated. In a DP matrix, this corresponds to moving diagonally
for transitioning into the M—state, and horizontally/vertically for the
B-states. Indices along the t(arget) sequence are decremented as the two
interacting RNA strands run in opposite directions. See recursion in the
text for further description

 

2739

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

A.Wenzel et al.

 

running in opposite directions (antiparallel), target indices are decre-
mented when query indices are incremented.

For each of the main states, we maintain one table (DP matrix) where
M l; 1- contains the maximum score of an interaction that ends ungapped at
position i of the query and j in the target. Accordingly, Bq and BI hold
maximum scores for sub-alignments ending in a gap.

To lower memory usage from 0(m - n), we split the algorithm in two
steps. In the ﬁrst step, RIsearch scans for possible interaction sites. By
approximating loop energies with a linear (afﬁne) model, only two rows
of each DP matrix need to be stored. All scores for the current row only
depend on the previous row, achieving a linear space requirement. During
this phase, we store for each row the maximum score and its position in
the query (EJ- and E}). This results in a space complexity of
0(6 - m + 2 - n) with m and n being the lengths of the query and target
sequence, respectively. This approach introduces an ambiguity, as each
position in the target can only be linked to one position in the query. If
there are multiple sites within the query that bind to the same region of
the target, the weaker interaction might be missed. In practice, however,
this does not cause problems when the query is a short sequence. In the
second step, all entries in E that exceed a given threshold are processed.
For this, a region of 40 nt (or a user-speciﬁed amount) downstream of the
identiﬁed positions is taken into account to compute the actual structure
and free energy of the duplexes. In this way, RIsearch needs only mar-
ginally more time to identify suboptimal interactions.

This approach is similar to RNAplex. We reach a further simpliﬁca-
tion by (i) not using an extra state for interior loops, and (ii) also ap-
proximate small interior loops with the afﬁne model instead of relying on
the look-up tables. (iii) RNAplex seems to incorporate dangling end con-
tributions even though this is not stated in their paper. Fewer states lead
to a less complex recursion and other differences are due to algorithmic
design (most notably our dinucleotide matrix). This also holds true for a
comparison with BINDIGO that distinguishes different types of bulges
and interior loops depending on their size and degree of asymmetry and
includes terminal stacks, thus leading to a more complex recursion.

The RIsearch recursion is given as

Mi71.j+1+ 5(4171541:lj+1,lj)

34171441 + 5(41’71541’: —, lj)
Mm = max Bti71.j+1+ S(—,Qi: 0+1, lj)

SEW —a ’1')

0

Mii' S if a [it"—
Bqu = max: 1.] + (q l q 1 )

BQHJ + 5(4171, 41*: —, —)

M1441 + 5(41, —: 0+1, lj)
BILJ' = max

Bli.j+1+ S(—, —: 0+1, lj)

E,- = mlax{Mi.j + 5011» -¥ ’1', ‘)i

Entries in the M—state (ungapped) can come from (i) the M—state by
extending the previous alignment with one residue on both strands, mean-
ing either a stacking of a new pair, or the symmetric extension of an
interior loop (or opening, closing an interior loop). The entries can (ii/
iii) come from a dash (gap) in either sequence, reﬂecting the closing of a
bulge or the closing or continuation of an asymmetric interior loop. (iv) A
new alignment can be started and (v) 0 is given if this pair should not be
part of the interaction. In the implementation, the latter two cases are
merged into one, implicitly handled by the scoring matrix. All scores
S(—,q,»; —,tj) where q,» and If do not form a Watson£rick or wobble
base pair, and therefore should not start an alignment, are set to zero.
Elements in Bq and BI can either come from the M—state by opening a
new ‘gap’ or from the same state by extending an existing ‘gap’. As
mentioned before, the row maximum is stored in a one-dimensional

array EJ- and the corresponding position 1' within the query in  One
possibility to allow a position in the target to be related to more than one
position in the query is to make these arrays two-dimensional, giving
room to store the second and third best interaction in E1]- and EU.

2.2 Scoring matrix

Values for the 36 X 36 scoring matrix (Supplementary Fig. S1) are derived
from the Nearest Neighbor Database (NNDB) (Turner and Mathews,
2010). The NNDB contains parameters, determined from optical melting
experiments, that allow prediction of free energy changes of the different
RNA structural elements (stacked pairs, loops) and are widely used in
software for RNA folding. It provides complete nearest-neighbor sets,
including rules and parameter values, along with tutorials. Considering
the current and previous position of the two sequences allows us to apply
stacking energies for the base pairs. Bulge and interior loop energies
usually contain a length-dependent term, but are here approximated by
an afﬁne model. Figure 2a shows that the afﬁne ‘gap’ model is exact for
bulge sizes 2%, and over-penalizes larger loops. A single-nucleotide bulge
in our model receives the bulge opening cost and possibly a penalty for
terminal AiU or GiU pairs. This is not the case for the full energy model,
in which the stacking energy of the enclosing base pair is awarded. The
look-up tables for interior loops of sizes 1 X 1, 1 X 2 and 2 X 2 cannot be
incorporated into our scoring scheme. Instead, all energies have to be
approximated by an afﬁne model with opening and extension penalties,
as depicted in Figure 2b. Interior loops with >14 nucleotides are
over-penalized.

We created two matrices, one based on the so-called Turner 1999
energy parameters (Mathews et al., 1999) and one based on the Turner
2004 set (Mathews et al., 2004). The latter is the default, but the user can
choose either. Energy contributions of stacking and bulges are largely
identical, the scoring differs for interior loops. Supplementary Table S1
shows the free energies of example duplexes as modeled by RIsearch and
other methods.

There are some ambiguous cases in the scoring matrix, for example in
S(—,—; C, G). We cannot tell whether it is the extension of a bulge
(0.4 kcal/mol) or the asymmetric extension of an already asymmetric in-
terior loop (0.6 in T04 and 0.48 in T99). For this case, we decided to just
assign the bulge loop extension penalty, as larger loops are already
over-penalized.

Bulges Interlor loops

A
v

 

l
8
4

3

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a) b
‘0 F
E E
> h
«i u
go— 3
>- >-
9 o 9 N -
I) n)
5 5
1n V ‘ l u: '— ‘
2 i g
c»  c» O '
.E .E
E N ‘ E .—
15“ 5 + Turner energy model 1% | ‘ + Turner energy model
g i + RIsearch model 2m; N _ + RIsearch model
1: o _ 'U '
1 :5 s '7 s 1'1 1'3 1'5 2 1'5 1'0 1'4 1'8 2'2 2'6 3'0
bulge size [nt] interior loop size [nt]

Fig. 2. Approximated loop energies. In red, energies as given by Turner
2004 parameters. In blue, the linear approximation used in RIsearch.
Values for small loops are given as box plots (RIsearch to the right).
(a) Bulge loops: the afﬁne gap model is exact for bulge sizes 276, and
over-penalizes larger loops. (b) Interior loops: here symmetric case only,
for asymmetric loops a penalty is added. Furthermore, parameters for
AU/GU closure and terminal mismatch are applied where required in
both schemes. Small symmetric internal loops (1 X 1 and 2 X 2) have
tabulated free energy changes, here shown as box plots. Next to that,
RIsearch approximations are plotted, including the aforementioned
parameters

 

2740

ﬁlO'SIIZIImOprOJXO'SODBILLIOJLIIOICV/idnq

RIsearch

 

To favor short stable interactions, the user can choose a per-nucleotide
penalty [like in Tafer and Hofacker (2008)], which is then directly inte-
grated in the scoring matrix.

2.3 Data and benchmarking

We benchmarked our method on several datasets containing simulated
data and two real-life datasets of bacterial sRNA and human miRNA
with their respective targets. Accuracy and runtime of RIsearch were
compared with previous methods. We mainly focused on a comparison
with RNAplex, because it belongs to the same class of algorithms and has
already been benchmarked against a variety of other tools.

2.3.] Simulated data This dataset consists of random sequences of
different lengths (2(P50 nt, in steps of 5nt) covering a variety of
GC-contents (~10, 30, 50, 70 and 90%). For each class, 1000 sequences
were generated. First, the perfect complement was derived. Then, this
hypothetical optimal binding partner was mutated stepwise as follows:
A random position in the sequence was chosen to be substituted with
75% probability, deleted with 17% or a nucleotide inserted (8%).
The number of repetitions is length dependent to ensure a wide range
of Levenshtein distances (LDs) between the optimal and the mutated
target, yielding 1000 - (length+6) duplexes for each combination of
length and GC-content.

For each of these duplexes, we calculate the minimum free
energy (MFE) with different tools, namely DuplexFold from the
RNAstructure package (Reuter and Mathews, 2010), which implements
the NNDB 2004 rule set, RNAplex (Tafer et al., 2011) and RNAcofold
(Bernhart et al., 2006b), which both use the Turner 1999 parameters and
RIsearch with the 2004 matrix.

2.3.2 Speed data To benchmark time (and also memory) consump-
tion, we use three different sets of sequences. Random data as well as
genomic sequences of various lengths and different number of query
sequences are contained in those. For details, see Section $21 in the
Supplementary Material.

2.3.3 sRNA data This dataset comprises a total of 17 sRNAi
mRNA interactions with experimentally verified binding site positions.
It has been used before as a benchmark set by Busch et a]. (2008), Chitsaz
et a]. (2009) and lately by Tafer et a]. (2011), from which sequences were
taken. Query and target sequences are on average 147 nt and 179 nt long.
The speciﬁc sRNAimRNA interactions appear in the table in Section 3.
Since RNAplex was previously benchmarked on a range of tools (Tafer
and Hofacker, 2008; Tafer et al., 2011), we only compare RIsearch (both
parameter sets) with RNAplex (with and without taking into account
accessibility). Accessibility proﬁles were computed by RNAplfold
(Bernhart et al., 2006a) with parameters as suggested by Tafer
(RNAplfold -W 240 -L 160 -u 40 -O.)

For this benchmark we do not consider suboptimal duplexes initially,
but only whether the ﬁrst reported hit corresponds to the experimentally
verified interaction site. We present the deviation between predicted and
experimentally verified duplex boundaries as was also done by Tafer et a].
(2011). To evaluate the performance, we additionally calculated the sen-
sitivity (SEN, also called true-positive rate) and the precision [also called
positive predictive value (PPV)] and the harmonic mean of both (also
known as F—measure) as was also done by Kato et a]. (2010) and Salari
et a]. (2010). The deﬁnitions are

TP TP
— PPV :7
TP+FN’ TP+FP’

We counted true positives (TPs), false positives (FPs) and false nega-
tives (FNs) by comparing the veriﬁed interacting base pairs with pre-
dicted ones. An alternative measure is the Matthews correlation
coefﬁcient (Matthews, 1975), which in this case [since the number of

_2-SEN-PPV

SEN Z _ SEN + PPV

true negatives (TNs) is orders of magnitudes higher than TP, FF and
FN] reduces to the geometric mean of the sensitivity and the PPV:
«/ SEN - PPV (Gorodkin et al., 2001). For cases where the ﬁrst prediction
did not overlap the experimentally veriﬁed location, we then also com-
puted suboptimal solutions.

2.3.4 miRNA data We examine a subset of human microRNAs
causing mRNA repression from TarBase (Papadopoulos et al., 2009).
This dataset of 27 interactions has been used before to benchmark
RNAplex (Tafer and Hofacker, 2008). The mature miRNA sequences
from miRBase 17 (Kozomara and Grifﬁths-Jones, 2011) are used as
query and the 3’-UTRs of the respective mRNAs from UCSC hgl9 (aver-
age length 2294 nt) are used as target. The experimentally conﬁrmed
binding sites were collected from the original papers and mapped to
the extracted sequences. For some miRNAimRNA pairs, there is more
than one veriﬁed interaction site. The majority have only one or two
binding sites (13 and 9), few have up to four, the interactions including
KRAS and NRAS forming the exception with eight and nine possible
binding sites, respectively (Johnson et al., 2005). The 27 miRNA/UTR
pairs were scanned with RNAhybrid, RNAplex and RIsearch, allowing
for suboptimal hits. For RIsearch, we used the 1999 energy parameters,
as the other two methods also use them. An interaction counts as ‘re-
covered’ when the predicted target region overlaps any of the annotated
binding sites. For interactions with more than one experimentally veriﬁed
binding site, we considered the one ranked highest (according to their
predicted free energy) for each method.

We used the same 27 interactions to test performance on large-scale
screens. Instead of only the 3’-UTR sequence, we used the whole
repeat-masked chromosome where the known target is located. We also
included GUUGle as well as TargetScanS (Garcia et al., 2011) and
miRanda (Enright et al., 2003), which both are speciﬁcally designed for
miRNA target prediction. In this screen, we excluded RNAhybrid, be-
cause it requires to ﬁll in the entire DP matrix several times to predict
suboptimal duplexes, which makes it too slow for scanning whole
chromosomes. For each of the ﬁve methods, we count the number of
hits which have the same or better score than the best hit that overlaps an
annotated target site. Two different measures were used to evaluate the
methods. For the ﬁrst measure, we ranked all methods individually for
each miRNAimRNA pair, where the method yielding the lowest hit
count ranks ﬁrst (using fractional ranking). Given k interactions, let
cg,» be the count and rgj the rank of method g in the ith interaction.
The rank product (Breitling et al., 2004) is given as the geometric mean:
RP(g) = (Hf:1 rgJ»)1/" . Because this is an ordinal measurement, we deﬁne
a second measure, the relative hit score, which takes account for the
degree of difference between the hit counts of the different methods.
We ﬁrst ﬁnd the maximum count N for each interaction:
N,» = maxg{cg_,»} and deﬁne RHS(g) = 2;] (Ni — egg/Ni.

To demonstrate the efﬁcacy of RIsearch as a ﬁlter, we ﬁrst use
RIsearch (with free energy threshold of —11 kcal/mol) and apply
TargetScanS and miRanda on the pre-ﬁltered data. We measure the re-
duction in candidate regions compared with the raw results of the two
miRNA target predictors. We compare this with the ﬁlter abilities of
GUUGle (requiring a seed match of at least seven nucleotides) and a
combination of the two.

3 RESULTS

3.1 General ranking of duplexes

To evaluate the accuracy of the scoring scheme, we created a set
of random sequences for different combinations of length and
GC—content as described above. We address not only score
(energy) computations, but also the ranking by the various
tools. In Figure 3a, we show how the different methods deviate

 

2741

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

 
 

RIsearch

 

Table 1. Predicted sRNA target sites

 

 

 

Pair Binding site literature Positions RNAplex-a Positions RNAplex-c 30 Positions RIsearch t99 Positions RIsearch t04
sRNA mRNA sRNA mRNA sRNA mRNA sRNA mRNA sRNA mRNA sRNA mRNA
chB gltI 66; 77 31; 43 65; 76 32; 43 34; 74 33; 69 64; 102 12; 44 35; 66 128; 153
chB argT 75; 91 89; 104 72; 90 90; 107 95; 125 168; 196 91; 124 169; 206 75; 91 89; 104
chB dppA 65; 83 133; 150 57; 92 121; 157 56; 93 120; 158 57; 92 121; 157 57; 92 121; 157
chB livJ 63; 87 59; 82 63; 87 59; 82 62; 88 58; 83 63; 87 59; 82 63; 87 59; 82
chB livK 68; 77 165; 177 65; 90 150; 177 117; 126 240; 249 65; 97 146; 177 118; 125 241; 248
chB oppA 65; 90 155; 179 65; 89 155; 178 64; 90 154; 179 65; 89 155; 178 65; 89 155; 178
chB STM4351 70; 79 44; 52 62; 87 33; 58 35; 72 91; 124 30; 65 97; 131 30; 65 97; 131
MicA lamB 8; 36 122; 148 5; 21 1; 16 57; 68 154; 165 8; 36 122; 148 8; 36 122; 148
MicA ompA 8; 24 113; 128 8; 24 113; 128 7; 25 112; 129 8; 24 113; 128 8; 24 113; 128
DsrA rpoS 8; 36 10; 38 21; 40 7; 25 9; 41 6; 37 10; 40 7; 36 10; 40 7; 36
RprA rpoS 33; 62 16; 39 40; 71 1; 32 32; 46 26; 40 33; 45 27; 39 33; 45 27; 39
IstR tisA 65; 87 57; 79 65; 87 57; 79 64; 93 50; 80 65; 92 51; 79 65; 92 51; 79
MicC ompC 1; 30 93; 119 1; 16 104; 119 40; 66 71; 93 41; 65 72; 92 41; 65 72; 92
MicF ompF 1; 33 100; 125 1; 28 105; 125 1; 34 99; 126 27; 32 68; 73 1; 33 100; 125
RyhB sth 9; 50 89; 128 19; 41 98; 118 8; 42 97; 129 7; 41 98; 127 7; 41 98; 127
RyhB sodB 38; 46 52; 60 38; 65 38; 60 37; 50 49; 61 38; 46 52; 60 38; 46 52; 60
SgrS ptsG 157; 187 76; 107 168; 187 76; 95 167; 188 75; 96 7; 19 38; 53 7; 19 38; 53

 

For each sRNAemRNA interaction, we report the binding site (begin and end positions in both sequences) as given in the literature and as predicted by the four methods.
All methods searched only for the single best—scoring interaction. RNAplex—a uses pre—computed accessibility proﬁles and only misses one interaction (in bold and gray text).
RIsearch (with 99 and 04 Turner parameters) and RNAplex—c do not take into account accessibility information and instead use a ﬁxed per—nucleotide penalty of 0.3 kcal/mol.

These three methods miss ﬁve interactions each, though different ones.

measurements, the 2004 Turner parameters lead to a higher pre—
diction accuracy than the 1999 parameters in RIsearch.

3.4 Locating miRNA target sites in genomic sequence

We also compared the recovery rates of RIsearch, RNAplex
and RNAhybrid for 27 human miRNAitarget UTR duplexes.
Predicted binding sites were ranked according to their free energy
and we report the highest ranking prediction that overlaps
an annotated binding site in Table 2, as it has been done by
Tafer and Hofacker (2008). For 23 of the interactions, the
three methods report the same binding site as the highest scoring
true—positive hit. For example, TarBase contains four possible
binding sites for the let—7e miRNA in the 3/—UTR of SMClA
mRNA. They constitute the top ranking candidates of all the
methods tested here, but in different order. The interaction
that has been experimentally veriﬁed (Kiriakidou et al., 2004)
is ranked first by RIsearch and second by the other methods.
In this benchmark, RNAhybrid performs best, known target
sites are ranked higher and predicted more accurately in position.
RNAplex is slightly better than RIsearch in ranking the real
interactions (on average 1.92 compared with 2.07), while
RIsearch predictions are generally closer to the veriﬁed binding
site. The frequent one—nucleotide deviation in position could be
an artifact of the different handling of dangling ends and ter—
minal mismatches.

When screening the whole chromosome, we observe very
different levels of speciﬁcity (Supplementary Table S6).
TargetScanS fails to ﬁnd 2 out of the 27 interactions, because
it requires a perfect seed match that is not present in those target

sites. With default parameters, miRanda misses three inter—
actions. We have not tried any other parameter setting.
GUUGle alone performs worst (in terms of RP and RHS), but
when combined with RIsearch or RNAplex, respectively, we get
an miRNA target predictor comparable to the specialized meth—
ods. In this combination, RIsearch scores best in RHS and
slightly behind the two specialized methods in RP.

When applying this combination as pre—ﬁlter for TargetScanS
and miRanda, we achieve on average a reduction of candi—
dates by around 37% for both tools. RIsearch without the
GUUGle—preﬁlter accounts for an average reduction of 27%
for miRanda candidates and 35% for TargetScanS, in some
cases of up to 70% (Supplementary Table S7). The degree of
reduction seems dependent on the GC—content of the miRNA
(see Supplementary Material, page 11).

The prediction of thousands of potential miRNA targets is in
agreement with a recent hypothesis of miRNA response elements
connecting mRNAs, transcribed pseudogenes and long ncRNAs
in large—scale regulatory networks (Salmena et al., 2011).

3.5 Filtering using RIsearch

Here, we illustrate how RIsearch can be used as filter for the
more complex algorithms, such as IntaRNA or RNAup. We
extracted the sequences from Escherichia coli and Salmonella
typhimurium according to the IntaRNA paper (Busch et al.,
2008). In Figure 4, we show a receiver—operating characteristic
curve of the recall against search space reduction given different
energy cutoffs, with an area under the curve of 0.817. It shows
that with a rather conservative cutoff of —10kcal/mol, we can

 

2743

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

A.Wenzel et al.

 

Table 2. Predicted miRNA target sites

 

 

mRNA miRNA RNAhybrid RNAplex RIsearch
(AG r 17) (AG r 17) (AG r p)

AGTRl miR-155 —20.90 1 11 —14.37 1 11 —14.06 1 9
BCL2 miR-16 —24.10 1 1 —18.90 2 1 —18.69 1 1
SLC7A1 miR-122 —29.00 1 2 —23.80 1 2 —23.04 1 4
TPPP3 miR-16 —26.00 2 0 —20.80 2 1 —19.95 1 1
CLOCK miR-141 —22.10 1 0 —16.40 1 0 —15.37 1 7
CXCL12 miR-23a —25.90 1 38 —19.80 2 37 —18.00 2 38
CYPlBl miR-27b —33.60 1 1 —28.20 1 1 —26.91 1 1
E2F3 miR-34a —25.10 210 —19.10 210 —18.31 21
EZH2 miR-lOl —22.40 1 1 —16.90 1 1 —15.65 1 1
PARP8 miR-145 —27.40 1 3 —21.80 1 3 —20.00 1 1
FSTLl miR-206 —23.20 3 0 —18.40 4 0 —15.87 6 2
GJAl miR-l —20.60 1 1 —14.30 2 1 —12.76 2 12
GJAl miR-206 —21.00 4 11 —15.03 6 11 —12.55 8 0
HAND2 miR-l —18.10 1 1 —12.20 1 1 —9.61 2 5
HOXAl miR-lOa —23.30 1 14 —15.93 4 12 —12.71 4 13
KIT miR-221 —23.40 3 0 —17.70 3 0 —15.18 2 2
KIT miR-222 —23.70 3 58 —18.60 4 56 —15.38 5 56
KRAS let-7a —21.30 5 2 —16.30 3 3 —15.03 3 3
LIN28A let-7b —33.50 1 1 —27.40 1 1 —25.20 1 5
MAPK14 miR-24 —32.20 1 1 —27.10 1 0 —25.98 1 1
MYCN miR-lOl —20.70 1 1 —13.85 216 —12.19 1 1
NRAS let-7a —21.60 4 6 —17.70 2 22 —13.96 4 8
PTEN miR-19a —23.20 1 1 —17.70 1 1 —16.74 1 1
ARHGAP32 miR-132 —25.10 1 3 —18.80 1 3 —18.55 1 1
SMClA let-7e —27.70 1 1 —22.20 1 1 —21.49 1 2
TMSB4X miR-l —21.90 1 1 —16.90 1 1 —16.76 1 1
TPMl miR-21 —20.00 1 13 —15.00 1 8 —13.44 1 7

Average rank and position 1.67/6.74 193/756 207/681

 

Column 1: HGNC [HUGO (Human Genome Organization) Gene Nomenclature
Committee] symbol, column 2: miRNA ID (all human), columns 375: Results
shown for each of the tools include the AG (kcal/mol) of the interaction, its
rank (r) within all predictions and the deviation [nt] of the predicted target position
pred from the reported one [it (p) with p: |begin(pred) — begin(lit)|+
|end(pred) — end(lit)|. Note, that for RNAhybrid the energies are usually lower,
because the initiation energy of 4.1 kcal/mol is not included. The last row contains
the average of the rank and the deviation in position.

 

 

 

 

—3.5 —19.5 —35.5 —51.5 —67.5 —aa.4
q _ . . . . . .
co. _

o

e s-

ﬁ

8 v, _

I O
o! _

o

g _ AUC=0.817
. . . . . .
0.0 0.2 0.4 0.6 0.3 1.0

True negative rate

Fig. 4. RIsearch as ﬁlter for bacterial sRNAimRNA interactions. The
color key refers to RIsearch energy cutoffs. TNR (or speciﬁcity) is syn-
onymous with the search space reduction we can achieve with different
cutoffs. Recall (or sensitivity, TPR) shows how many of the known inter-
actions we retain

already ﬁlter out 16.1% of the candidates. With —11.5kcal/mol,
we still retain all true targets, while reducing the search space by
27.5%. Considering that IntaRNA uses around 9 h 40 min
(and RNAup even 18 h 50 min) to compute all 47.726 duplexes,
while RIsearch takes <18 s, this shows how genome—wide
searches can be speeded up.

4 DISCUSSION

RIsearch is a fast method to search for near—complementary base
pairing in genomic sequence by using a simpliﬁed energy model.
In a runtime benchmark, we show that RIsearch is at a minimum
a factor of 2.4 faster than RNAplex, the currently fastest method
for predicting near—complementary duplexes and also has a lower
memory consumption. Remarkably, our simpliﬁed model gives
good energy estimates for complementary duplexes interspersed
with small bulges and interior loops. Even though RIsearch sys—
tematically computes an energy differing by a small factor com—
pared with the full Turner energy model, the reported energies
strongly correlate (r:0.99) with the energies computed by the
full model in DuplexFold. When ranking random duplexes by
their predicted energies, RIsearch shows on average an overlap
of 94% with DuplexFold and RNAplex within the highest
ranking duplexes.

In our evaluation of prediction accuracy on the sRNAi
mRNA and miRNAimRNA datasets, we show that RIsearch
achieves a similar or better sensitivity and precision for predicted
base pairs as other compared methods. However, considering the
accessibility of binding sites with RNAplex can increase the re—
covery rate of the veriﬁed sRNAimRNA interactions. Other
approaches, such as IntaRNA and RNAup, also account for
accessibility by computing intramolecular base pair probabilities
in both sequences. This, however, comes at the expense of
runtime. In contrast, the objective of RIsearch is the fast
search for potential RNAiRNA duplexes. One application
is pre—ﬁltering in genome—wide screens. When RIsearch is used
as a pre—ﬁlter for specialized miRNA target predictors, such as
miRanda and TargetScanS, the number of target site candidates
can be signiﬁcantly reduced, which in turn results in a better
precision of the miRNA target prediction.

Problems with developing methods that should be applied on a
genome—wide scale include reliable testing. We face a lack of
experimentally veriﬁed interactions. For many miRNAs for ex—
ample, target genes have been identiﬁed, but the actual binding
site positions within their 3/—UTR are unknown (Lindow and
Gorodkin, 2007). Even for known target sites, the extent of the
interactions is not clear, for examples of bacterial sRNA target
sites, see Sharma et al. (2007). Even though we could benchmark
on a limited dataset, benchmarking the accuracy of genome—wide
searches for RNAiRNA interactions is currently hard given the
limited amount of known interactions. In particular, it is not
possible to reliably calculate the false—discovery rate unless
follow—up experiments are carried out. Another factor is the es—
timation of P—values, which requires a background model for
RNAiRNA interaction to distinguish true positives from
random hits. This, however, depends on incorporating reliable
shufﬂing schemes, e.g. based on dinucleotide composition, simi—
lar to those for de novo prediction of ncRNA genes (Gorodkin
and Hofacker, 2011).

 

2744

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

RIsearch

 

RIsearch was developed as a tool, which can conduct a fast
initial screen in genomic sequence and aid in the overall goal of
mapping all potential RNAiRNA interactions in, e. g. the human
genome. However, it is beyond the scope of this work to set up
such a pipeline, which most likely involves additional methods,
taking the full energy model into account, as well as the devel—
opment of a framework for computing P—values. The estimation
of P—values by TargetRNA points to a direction for this. For
further future directions, prediction of RNAiRNA interactions
could be combined with high—throughput experimental data,
such as done for RNA structure prediction (Deigan et al.,
2009; Kertesz et al., 2010; Underwood et al., 2010).

The introduced simpliﬁcations will make a hardware imple—
mentation of the algorithm, e.g. with a field—programmable gate
array, more feasible. Hardware accelerated versions of the
SmithiWaterman algorithm have been shown to be magnitudes
faster than traditional software implementations (Li et al., 2007).

ACKNOWLEDGEMENTS

The authors thank Peter Sestoft, who was involved in the devel—
opment of the state model and the initial alignment version of
the algorithm. They further thank Larry Croft for critical
reading of this article, and the anonymous reviewers for their
valuable comments and suggestions.

Funding: Danish Council for Independent Research (Technology
and Production Sciences); The Danish Council for Strategic
Research (Programme Commission on Strategic Growth
Technologies) as well as the Danish Center for Scientiﬁc
Computing.

Conﬂict of Interest: none declared.

REFERENCES

Akbasli,E. (2008) Fast sequence alignment in a managed programming language.
MSc Thesis, IT University of Copenhagen.

Alkan,C. et al. (2006) RNAeRNA interaction prediction and antisense RNA target
search. J. Comput. Biol., 13, 2677282.

Amaral,P.P. et al. (2008) The eukaryotic genome as an RNA machine. Science, 319,
178771789.

Andronescu,M. et al. (2005) Secondary structure prediction of interacting RNA
molecules. J. Mol. Biol., 345, 98771001.

Barron,N. et al. (2011) MicroRNAs: tiny targets for engineering CHO cell pheno—
types? Biotechnol. Lett., 33, 11721.

Bentwich,I. et al. (2005) Identiﬁcation of hundreds of conserved and nonconserved
human microRNAs. Nat. Genet, 37, 76(r770.

Bernhart,S.H. et al. (2006a) Local RNA base pairing probabilities in large se—
quences. Bioinﬁ)rmatics, 22, 614%15.

Bernhart,S.H. et al. (2006b) Partition function and base pairing probabilities of
RNA heterodimers. Algorithms Mol. Biol., 1, 3.

Breitling,R. et al. (2004) Rank products: a simple, yet powerful, new method to
detect differentially regulated genes in replicated microarray experiments. F EBS
Lett., 573, 8%92.

Busch,A. et al. (2008) IntaRNA: efﬁcient prediction of bacterial sRNA targets
incorporating target site accessibility and seed regions. Bioinformatics, 24,
284972856.

Chen,S. et al. (2004) MicC, a second small—RNA regulator of Omp protein expres—
sion in Escherichia coli. J. Bacteriol, 186, 6689$697.

Chitsaz,H. et al. (2009) biRNA: Fast RNAeRNA binding sites prediction. In
Proceedings of the 9th Workshop on Algorithms in Bioinformatics ( WABI).
Vol. 5724, Lecture Notes in Computer Science, Springer—Verlag, Heidelberg,
Berlin, pp. 25736.

Crooks,G.E. et al. (2005) Pairwise alignment incorporating dipeptide covariation.
Bioinformatics, 21, 3704e3710.

D’Alia,D. et al. (2010) Noncoding RNA of glutamine synthetase i modulates
antibiotic production in Streptomyces coelicolor A3(2). J. Bacteriol, 192,
116(F1164.

Deigan,K.E. et al. (2009) Accurate SHAPE—directed RNA structure determination.
Proc. Natl Acad. Sci. USA, 106, 977102.

Enright,A.J. et al. (2003) MicroRNA targets in Drosophila. Genome Biol., 5, R1.

Galagan,J.E. et al. (2005) Sequencing of Aspergillus nidulans and comparative ana—
lysis with A.fumigatus and A. oryzae. Nature, 438, 110571115.

Garcia,D.M. et al. (2011) Weak seed—pairing stability and high target—site abun—
dance decrease the proﬁciency of lsy—6 and other microRNAs. Nat. Struct.
Mol. Biol., 18, 113971146.

Gerlach,W. and Giegerich,R. (2006) GUUGle: a utility for fast exact matching
under RNA complementary rules including GeU base pairing. Bioinformatics,
22, 7627764.

Gong,C. and Maquat,L.E. (2011) lncRNAs transactivate STAUl—mediated mRNA
decay by duplexing with 3/—UTRs via Alu elements. Nature, 470, 28¢288.
Gorodkin,]. and Hofacker,I.L. (2011) From structure prediction to genomic screens

for novel non—coding RNAs. PLoS Comput. Biol., 7, e1002100.

Gorodkin,]. et al. (2001) Discovering common stem—loop motifs in unaligned RNA
sequences. Nucleic Acids Res., 29, 213572144.

Gorodkin,]. et al. (2010) De novo prediction of structured RNAs from genomic
sequences. Trends Biotechnol, 28, 9719.

Gotoh,O. (1982) An improved algorithm for matching biological sequences. J. Mol.
Biol., 162, 7057708.

Hodas,N.O. and Aalberts,D.P. (2004) Efﬁcient computation of optimal oligo—RNA
binding. Nucleic Acids Res., 32, 663G6642.

Houseley,J. et al. (2008) A ncRNA modulates histone modiﬁcation and mRNA
induction in the yeast GAL gene cluster. Mol. Cell, 32, 685$95.

International Human Genome Sequencing Consortium. (2004) Finishing the eu—
chromatic sequence of the human genome. Nature, 431, 9317945.

Johnson,S.M. et al. (2005) RAS is regulated by the let—7 microRNA family. Cell,
120, 63y647.

Kato,Y. et al. (2010) RactIP: fast and accurate prediction of RNAeRNA inter—
action using integer programming. Bioinformatics, 26, i4607i466.

Kertesz,M. et al. (2010) Genome—wide measurement of RNA secondary structure in
yeast. Nature, 467, 1037107.

Kiriakidou,M. et al. (2004) A combined computationaleexperimental approach pre—
dicts human microRNA targets. Genes Dev., 18, 116571178.

Kozomara,A. and Grifﬁths—Jones,S. (2011) miRBase: integrating microRNA anno—
tation and deep—sequencing data. Nucleic Acids Res., 39 (Dambase issue),
D1527D157.

Li,A.X. et al. (2011) RNAeRNA interaction prediction based on multiple sequence
alignments. Bioinformatics, 27, 4564163.

Li,I.T.S. et al. (2007) 160—fold acceleration of the Smith7Waterman algorithm using
a ﬁeld programmable gate array (FPGA). BMC Bioinformatics, 8, 185.

Lindow,M. and Gorodkin,]. (2007) Principles and limitations of computational
microRNA gene and target ﬁnding. DNA Cell Biol., 26, 3397351.

Matthews,B.W. (1975) Comparison of the predicted and observed secondary struc—
ture of T4 phage lysozyme. Biochem. Biophys. Acta, 405, 4424151.

Mathews,D.H. et al. (1999) Expanded sequence dependence of thermodynamic par—
ameters improves prediction of RNA secondary structure. J. Mol. Biol., 288,
9117940.

Mathews,D.H. et al. (2004) Incorporating chemical modiﬁcation constraints into
a dynamic programming algorithm for prediction of RNA secondary structure.
Proc. Natl Acad. Sci. USA, 101, 728777292.

Miickstein,U. et al. (2006) Thermodynamics of RNAeRNA binding.
Bioinformatics, 22, 117771182.

Ohhata,T. et al. (2011) Lineage—speciﬁc function of the noncoding Tsix RNA for
Xist repression and Xi reactivation in mice. Genes Dev., 25, 170271715.

Papadopoulos,G.L. et al. (2009) The database of experimentally supported targets:
a functional update of TarBase. Nucleic Acids Res., 37 (Database issue),
D1557D158.

Pedersen,J.S. et al. (2006) Identiﬁcation and classiﬁcation of conserved RNA sec—
ondary structures in the human genome. PLoS Comput. Biol., 2, e33.

Rehmsmeier,M. et al. (2004) Fast and effective prediction of microRNA/target
duplexes. RNA, 10, 150771517.

Reuter,J.S. and Mathews,D.H. (2010) RNAstructure: software for RNA secondary
structure prediction and analysis. BMC Bioinformatics, 11, 129.

Salari,R. et al. (2010) Fast prediction of RNAeRNA interaction. Algorithms Mol.
Biol., 5, 5.

 

2745

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

A.Wenzel et al.

 

Salmena,L. et al. (2011) A ceRNA hypothesis: the Rosetta Stone of a hidden RNA
language? Cell, 146, 35%358.

Seemann,S.E. et al. (2011) PETcofold: predicting conserved interactions and
structures of two multiple alignments of RNA sequences. Bioinformatics, 27,
2117219.

Sharma,C.M. et al. (2007) A small RNA regulates multiple ABC transporter
mRNAs by targeting C/A—rich elements inside and upstream of ribosome—
binding sites. Genes Dev., 21, 280442817.

Smith,T.F. and Waterman,M.S. (1981) Identiﬁcation of common molecular subse—
quences. J. Mol. Biol., 147, 1957197.

Tafer,H. and Hofacker,I.L. (2008) RNAplex: a fast tool for RNAeRNA interaction
search. Bioinformatics, 24, 265772663.

Tafer,H. et al. (201 1) Fast accessibility—based prediction of RNAeRNA interactions.
Bioinformatics, 27, l934~l940.

The ENCODE Project Consortium. (2007) Identiﬁcation and analysis of functional
elements in 1% of the human genome by the ENCODE pilot project. Nature,
447, 7997816.

Tjaden,B. (2008) TargetRNA: a tool for predicting targets of small RNA action in
bacteria. Nucleic Acids Res., 36, W1097Wll3.

Tjaden,B. et al. (2006) Target prediction for small, noncoding RNAs in bacteria.
Nucleic Acids Res., 34, 279172802.

Torarinsson,E. et al. (2006) Thousands of corresponding human and mouse gen—
omic regions unalignable in primary sequence contain common RNA structure.
Genome Res., 16, 8857889. (Erratum in: Genome Res. 2006 16:1439.)

Torarinsson,E. et al. (2008) Comparative genomics beyond sequence based
alignments: RNA structures in the ENCODE regions. Genome Res., 18,
2427251.

Turner,D.H. and Mathews,D.H. (2010) NNDB: the nearest neighbor parameter
database for predicting stability of nucleic acid secondary structure. Nucleic
Acids Res., 38 (Database issue), D28(%D282.

Underwood,J.G. et al. (2010) FragSeq: transcriptome—wide RNA structure probing
using high—throughput sequencing. Nat. Methods, 7, 99571001.

Vogel,J. and Papenfort,K. (2006) Small non—coding RNAs and the bacterial outer
membrane. Curr. Opin. Microbiol, 9, 605411.

Washietl,S. et al. (2005) Genome—wide mapping of conserved RNA secondary struc—
ture structures predicts thousands of functional non—coding RNAs in human.
Nat. Biotechnol, 23, 138371390.

Waters,L.S. and Storz,G. (2009) Regulatory RNAs in bacteria. Cell, 136,
6157628.

Weinberg,Z. et al. (2007) Identiﬁcation of 22 candidate structured RNAs in bacteria
using the CMﬁnder comparative genomics pipeline. Nucleic Acids Res., 35,
48094819.

 

2746

ﬁre'spzumol‘pmﬂo'sopeuuowrorq/ﬁdnq

