Bioinformatics, 3215), 2016, 770—772

doi: 10.1093/bioinformatics/btv624

Advance Access Publication Date: 30 October 2015
Applications Note

 

Sequence analysis

MMR: a tool for read multi-mapper resolution

André Kahles*, Jonas Behr* and Gunnar Ratsch*

Memorial Sloan Kettering Cancer Center, Computational Biology Center, 1275 York Avenue, New York,
NYIOOBS, USA

*To whom correspondence should be addressed.
1Present address: ETH Z'Lirich, D-BSSE, Mattenstrasse 26, CH-4058 Basel, Switzerland
Associate Editor: Alfonso Valencia

Received on March 16, 2015; revised on September 10, 2015; accepted on October 14, 2015

Abstract

Motivation: Mapping high—throughput sequencing data to a reference genome is an essential step
for most analysis pipelines aiming at the computational analysis of genome and transcriptome
sequencing data. Breaking ties between equally well mapping locations poses a severe problem
not only during the alignment phase but also has significant impact on the results of downstream
analyses. We present the multi—mapper resolution (IV/MR) tool that infers optimal mapping loca—
tions from the coverage density of other mapped reads.

Results: Filtering alignments with MMR can significantly improve the performance of downstream
analyses like transcript quantitation and differential testing. We illustrate that the accuracy
(Spearman correlation) of transcript quantification increases by 15% when using reads of length
51. In addition, MMR decreases the alignment file sizes by more than 50%, and this leads to a
reduced running time ofthe quantification tool. Our efficient implementation ofthe MMR algorithm
is easily applicable as a post—processing step to existing alignment files in BAM format. Its com—
plexity scales linearly with the number of alignments and requires no further inputs.

Availability and implementation: Open source code and documentation are available for down—
load at http://github.com/ratschlab/mmr. Comprehensive testing results and further information

 

can be found at http://bioweb.me/mmr.

Contact: andre.kahles@ratschlab.org or gunnar.ratsch@ratschlab.org
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Addressing the increasing need for fast and accurate mapping of high-
throughput sequencing data to a reference sequence, many different soft-
ware tools have been developed over the past years, many of which are
frequently updated and improved (Dobin et (11., 2013; Jean et (11., 2010;
Kim et (11., 2013; Li and Durbin, 2009). While numerous challenges
have been addressed by the developers, e.g. the consideration of gaps
and mismatches or the spliced alignment of RNA-Sequencing data, the
problem of ambiguous read mapping still remains unresolved for many
of the most popular alignment tools. Depending on factors like read
length, alignment sensitivity and repetitiveness of the target genome, a
large fraction of reads aligns uniquely to the target and exactly one map-
ping location is reported. However, for the remaining, still significantly
large, fraction of reads (mo-20%, depending on alignment sensitivity),

(63 The Author 2015. Published by Oxford University Press.

several possible mapping locations exist. Currently, different strategies
are employed to deal with these reads in downstream analyses, most of
which have unfavorable side effects: Discarding reads with ambiguous
alignments from the alignment result leads to a systematic underestima-
tion of abundance in genomic regions with multi-mapper ambiguities,
whereas picking a random alignment or distributing weight across all
alignments uniformly does not have a proper biological justification. We
provide a brief review of related approaches (Hashimoto et (11., 2009; Li
et (11., 2010; Mortazavi et (11., 2008; Wang et (11., 2010; Zhang et (11.,
2013) in Supplementary Section A.5.

Here, we present a simple, yet powerful tool, called the multi-
mapper resolution (MMR) tool, that assigns each read to a unique
mapping location in a way that the overall read coverage across the
genome is as uniform as possible. MMR makes use of the critical

770

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘slcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

1\4aterial

Supplementary Fig. S9
Supplementary Section A

Supplementary Section A.4.1

Li cl (1]., 2009

Supplementary Fig. S2

Supplementary
Drechsel cl (1]., 2013 Ruhl cl (1]., 2012

(iriebel cl (1]., 2012

Kim el al. 2013 Jean
at a]. 2010
Supplementary Section
13.2
Trapnell cl (1].,
2010 Bohnert cl (1]., 2009

 

/310'S[BHmOprOJXO'SOpBLUJOJIItth/ﬂdnq

772

A.Kahles et al.

 

MMR—filtered alignments, the best alignments only (the alignment
ranked highest by the aligner) and on completely unfiltered align—
ments. For TopHatZ and PALMapper, the quantifications based on
the MMR—filtered alignments showed a consistently better correl—
ation to the ground truth than both the best—hit and unfiltered align—
ments sets. The shorter reads of length 351 nt (Fig. 1) showed larger
improvements compared to unfiltered (Cufﬂinks: 2.7%, rQuant:
15.0%) and best—hit set (Cufﬂinks: 5.6%, rQuant: 4.0%) than the
longer reads of length 276 nt, that showed consistent but smaller
improvements (Supplementary Figs 55—57).

4 Conclusion

We presented MMR, a post—processor for BAM files, resolving ambigu—
ous alignment locations. We showed its easy applicability to the output
of different alignment methods and illustrated that MMR can greatly
improve accuracy of downstream quantification methods. Although
the improvements seem moderate on a global scale, the effect on single
genes can be much larger. Given its lean implementation and the short
running time, MMR is very well suited for large—scale genome—, exome—
and RNA—sequencing efforts. Its good performance on short reads also
suggests an application to ribosome footprinting data (Ingolia et al.,
2012). MMR may also be useful for post—processing alignments in
meta—genome projects for improved selection of taxa.

Acknowledgement

The authors would like to thank Geraldine Jean for fruitful discussions and
helpful comments.

Funding

This work was supported by Max Planck Society (to G.R.), German Research
Foundation (to G.R.; RA1894/2-1), Memorial Sloan Kettering Cancer Center
(to G.R.) and the Lucille Castori Center for Microbes, Inﬂammation and
Cancer (to A.K.).

Conﬂict of Interest: none declared.

References

Bohnert,R. et al. (2009) Transcript quantiﬁcation with RNA-Seq data. BMC
Bioinformatics, 10(Suppl 13), P5.

Dobin,A. et al. (2013) STAR: ultrafast universal RNA-seq aligner.
Bioinformatics, 29, 15—21.

Drechsel,G. et al. (2013) Nonsense-mediated decay of alternative precursor
mRNA splicing variants is a major determinant of the Arabidopsis steady
state transcriptome. Plant Cell, 25, 3726—3742.

Griebel,T. et al. (2012) Modelling and simulating generic RNA-Seq experi-
ments with the flux simulator. Nucleic Acids Res., 40, 10073—10083.

Hashimoto,T. et al. (2009) Probabilistic resolution of multi-mapping reads in
massively parallel sequencing data using MuMRescueLite. Bioinformatics,
25, 2613—2614.

Ingolia,N.T. et al. (2012) The ribosome proﬁling strategy for monitoring
translation in vivo by deep sequencing of ribosome-protected mRNA frag-
ments. Nat. Protoc., 7, 1534—1550.

Jean,G. et al. (2010) RNA-Seq read alignments with PALMapper. Curr.
Protoc. Bioinfonn., Chapter 11, Unit 11.6.

Kim,D. et al. (2013) TopHat2: accurate alignment of transcriptomes in
the presence of insertions, deletions and gene fusions. Genome Biol, 14,
R36.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with
Burrows-Wheeler transform. Bioinformatics, 25, 1754—1760.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Li,B. et al. (2010) RNA-Seq gene expression estimation with read mapping un-
certainty. Bioinfonnatics, 26, 493—500.

Mortazavi,A. et al. (2008) Mapping and quantifying mammalian transcrip-
tomes by RNA—Seq. Nat. Methods, 5, 621—628.

Ruhl,C. et al. (2012) Polypyrimidine tract binding protein homologs from
Arabidopsis are key regulators of alternative splicing with implications in
fundamental developmental processes. Plant Cell, 24, 4360—4375.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti-
ation. Nat. Biotechnol, 28, 511—515.

Wang,]. et al. (2010) A Gibbs sampling strategy applied to the mapping of am-
biguous short-sequence tags. Bioinformatics, 26, 2501—2508.

Zhang,Z. et al. (2013) GeneScissors: a comprehensive approach to detecting
and correcting spurious transcriptome inference owing to RNA-seq reads
misalignment. Bioinformatics, 29, i291—i299.

ﬁm'srcumol‘pquo'sopeuuowtotq/ﬁdnq

