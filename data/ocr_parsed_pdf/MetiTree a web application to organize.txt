APPLICATIONS won:-  2522%.?Sé‘iLiiﬁéifiaiZS/Ziiﬁi

 

Databases and onto/ogies

Advance Access publication July 31, 2012

MetiTree: a web application to organize and process
high-resolution multi-stage mass spectrometry

metabolomics data
'1,2,*

Miguel Rojas-Cherto

Theo Reijmers1'2‘*

, Michael van Vliet1'3, Julio E. Peironcely1'2'4, Ronnie van Doorn‘,
Maarten KooymanS, Tim te BeekS, Marc A. van DrieIS, Thomas Hankemeier

1'2 and

1Netherlands Metabolomics Centre, Einsteinweg 55, 2333 CC Leiden and 2Division of Analytical Biosciences, Leiden/
Amsterdam Center for Drug Research, Leiden University, Einsteinweg 55, 2300 RA Leiden and 3Netherlands
Bioinformatics Centre, Geert Grooteplein 28, 6525 GA Nijmegen and 4TNO Research Group Quality and Safety, PO.

Box 360, NL—37OO AJ Zeist, The Netherlands
Associate Editor: Janet Kelso

 

ABSTRACT

Summary: Identification of metabolites using high-resolution
multi-stage mass spectrometry (MS") data is a significant challenge
demanding access to all sorts of computational infrastructures.
MetiTree is a user-friendly, web application dedicated to organize,
process, share, visualize and compare MS" data. It integrates several
features to export and visualize complex MS" data, facilitating the
exploration and interpretation of metabolomics experiments. A dedi-
cated spectral tree viewer allows the simultaneous presentation of
three related types of MS" data, namely, the spectral data, the frag-
mentation tree and the fragmentation reactions. MetiTree stores the
data in an internal database to enable searching for similar fragmen-
tation trees and matching against other MS" data. As such MetiTree
contains much functionality that will make the difficult task of identify-
ing unknown metabolites much easier.

Availability: MetiTree is accessible at http://www.MetiTree.nl. The
source code is available at https://github.com/NetherlandsMetabolo
micsCentre/metitree/wiki.

Contact: m.rojas@lacdr.leidenuniv.n| or t.reijmers@lacdr.leidenuniv.n|

Received on April 13, 2012; revised on July 3, 2012; accepted on
July 25, 2012

1 INTRODUCTION

Metabolite identiﬁcation is a challenging but essential step for
the interpretation and understanding of many biological pro-
cesses for an increasing number of applications such as bio-
marker discovery, drug discovery or nutritional studies. The
feasibility of using multi-stage mass spectrometry (MS”) for iden-
tiﬁcation of metabolites has been shown before (Sheldon et al.,
2009). The complexity of the data generated demands new com-
putational infrastructures to organize the data and to extract
relevant information. Recently, databases have been set up for
storing fragmentation spectra such as MS” data (e. g. MassBank;
Horai et al., 2010), and tools have been developed to process

 

*To whom correspondence should be addressed.

MS” data (e.g. the MEF tool; Rojas-Cherto et al., 2011), or to
compare MS” data (e. g. Mass Frontier; Thermo Fisher
Scientific). In this article we present a web application called
MetiTree with the novelty that it combines the processing of
high-resolution MS” data with a personal local library to organ-
ize the fragmentation data. Furthermore, it allows the compari-
son of MS” data to help the researcher with the identiﬁcation of
metabolites. MetiTree is available at http://www.MetiTree.nl to-
gether with some test MS” data.

2 METHODS

2.1 Web application

MetiTree (Metabolite Identiﬁcation Tree) is a web application intended
to aid in the metabolite identiﬁcation process. Currently, MetiTree offers
the possibility to organize, process, share, visualize and search for similar
high-resolution MS” data. MetiTree’s web interface is accessed through a
web browser and it was created using the Grails (http://grails.org)
frame-work.

2.2 Data processing and comparison

In order to process MS” data, MetiTree integrates the MEF tool (Rojas-
Cherté et al., 2011), which extracts chemical information from the frag-
ments assigning the elemental composition to the ions and neutral losses.
MetiTree also allows the comparison of newly acquired MS” data to data
that are already stored in an internal library (Rojas-Cherté et al., 2012).

2.3 Data Visualization

MetiTree incorporates a JavaScript spectral tree viewer developed to
visualize MS” data (https://trac.nbic.n1/brsp201017/), in order to facilitate
the exploration, interpretation and validation of the results. This viewer
interconnects three MS” items: the spectrum, which contains mass peaks,
the fragmentation tree, which contains fragment nodes/elemental com-
positions, and the fragmentation reactions, which contain structures.

3 USAGE EXAMPLE

MS” data previously published by our group (Rojas-Cherto
et al., 2011, 2012) are used to demonstrate how metabolites

 

© The Author 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 11101} pepnolumoq

91oz ‘Og isnﬁnV uo ::

M.Rojas-Chert6 et al.

 

can be identiﬁed using the MetiTree web application. These data
are freely accessible as test data in MetiTree.

3.1 Data processing

The required input to process MS” data is szML ﬁles and the
settings of the processing parameters. Processing parameters are
grouped into those to extract the mass spectrometry information
(m/z, intensity and retention time) and those to enrich the MS
data with chemical information (elements and number of atoms).
MetiTree allows individual ﬁle as well as batch processing.
Furthermore, the same szML file can be processed several
times with different sets of parameters. The results and param-
eters’ information are stored to allow for posterior revision.

3.2 Data Visualization

Once the data are processed, it can be displayed using the spec-
tral tree viewer (Fig. 1A). When the node (a fragment) is selected,
the corresponding spectrum is displayed together with the con-
catenated reactions that connect the parent ion with the selected
fragment. The structure of the fragment can only be displayed if
it has been previously assigned. The results generated by
MetiTree can be exported to different formats (CSV, CML;
Murray-Rust and Rzepa, 1999) and PDF) for further analysis
or for presenting results in reports and publications.

3.3 Library storage

MetiTree creates directories for grouping szML files, assisting
with the organization of the data according projects or topics.
Processed MS” data can be stored in one or multiple internal
databases (Fig. 1B). Because the users are organized in groups,
they can share files and libraries with other group members. All
MS” data can be labeled with an InChI identiﬁer of the

 

 

 

 

 

1 1 115 151
cmao: man: came: 1 2
2 3 I

 

 

 

 

 

 

 

 

 

 

 

A f \ a 2;.
IT “5 2"" 5w" w nu’g‘i’



’_ B
2....  My DB

Input  m |

159
mm
‘ Ho \/
A sure structure mm: m. job
0

Process

compound, which is automatically cross-referenced with
PubChem and ChemSpider databases.

3.4 Data search

MetiTree integrates the functionality to query for similar
MS" data (Rojas-Cherto et al., 2012) stored in the library. The
results are presented in a list showing the chemical structures
of the most similar MS” data and the corresponding similarity
values. A value near 100 indicates that MS” data are highly
similar, while a value close to 0 illustrates that they are very dif-
ferent. If a fragmentation tree of the same compound is present in
the library, complete identiﬁcation is possible (identity search). If
similar fragmentation data are found (similarity search), this sub-
structure information can be used to generate candidate struc-
tures of the unknown compound (partial identification).

3.5 Future

In the near future this new web application will also accept the
uploading of other types of MS” ﬁles (e.g. cml, szL) and
manual annotation of MS” data with chemical structural infor-
mation (assigning substructures to the nodes of the fragmenta-
tion trees) will also be possible.

4 CONCLUSION

The growing interest in metabolite identiﬁcation has increased
the need to create computational and visual tools for MS" ana-
lysis. MetiTree, which gathers several in-house developed tools,
is an easy-to-use web application that combines processing, shar-
ing, visualizing and querying MS” data to help researches to
identify metabolites of interest and decrease the time-consuming
task of identifying metabolites.

 

/ \

database selected : NMC-database
directory selaaed : proJeCt-ab
are selected : mememi

1: Select reference database
database: m

2: Select directory/ﬁle a on
direcotory: m “6
a

top similar structures "default"

 

rile_234534.cmi 2

 

OH
HO I
100 T
a o o
\0‘ E
No

 

 

 

 

126 n. 7 9 H“ + A Database
CEHEDH CEHSO CSHSOZ cmm came H H ﬁleil77732.cml 5
I \/ 25
6811703 H20 Ho 0
.5 ,1. Output
0 0H Cantu ﬁle_734577.cm| 3
"o / | 17 Ho
\ a + 150‘
0 I 0 on
I Compare ,0
cmm; co ﬁlejOGEAZLml 1
\ J \ 17 "i" /

 

 

Fig. 1. Overview of the MetiTree process ﬂow. After the user submits MS” spectra, MetiTree will process these according to a set of parameters.
Afterwards, the processed data can be stored in an internal library and labeled as a reference compound using the InChI identiﬁer. The results are
presented in different formats and viewers, which facilitates the exporting of text and ﬁgures for their use in reports and publications (A). Finally, MS”
data can be queried to ﬁnd similar MS” data in the library (B) and the query results are presented in a list

 

2708

112 /310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOICI”Idllq 11101} pepnolumoq

9103 ‘Og isnﬁnV uo ::

MetiTree

 

ACKNOWLEDGEMENTS

The authors are grateful to Prof. Dr N.M.M. Nibbering, Dr
A.C. Tas, P.T. Kasper, Dr R. Vreeken, J.J.J. van der Hooft
and M. Ries for their input.

Funding: The research programme of the Netherlands
Metabolomics Centre (NMC), which is a part of The
Netherlands Genomics Initiative/Netherlands Organization for
Scientiﬁc Research. This work was part of the BioAssist pro-
gramme of the Netherlands Bioinformatics Centre (NBIC),
which is supported by the Netherlands Genomics Initiative
(NGI).

Conﬂict of Interest: none declared.

REFERENCES

Horai,H. et a]. (2010) MassBank: a public repository for sharing mass spectral data
for life sciences. J. Mass Spectromet.: JMS, 45, 7037714.

Murray—Rust,P. and Rzepa,H.S. (1999) Chemical Markup, XML, and the
Worldwide Web. 1. Basic Principles. J. Chem. Inform. Model, 39, 9287942.
Rojas—Cherto,M. et a]. (2011) Elemental Composition determination based on

MSn. Bioinformatics, 27, 237(r2383.

Rojas—Cherto,M. et a]. (2012) Metabolite identiﬁcation using automated compari—
son of high resolution multistage mass spectral trees. Anal. Chem, 84,
5524e5534.

Sheldon,M.T. et a]. (2009) Determination of ion structures in structurally related
compounds using precursor ion ﬁngerprinting. J. Am. Soc. Mass Spectrom., 20,
37(k376.

 

2709

112 /310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] 11101} pepaolumoq

9103 ‘Og isnﬁnV uo ::

