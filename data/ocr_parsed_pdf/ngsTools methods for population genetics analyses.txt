BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

ngsTools

 

relying on called genotypes using the methods described in
Fumagalli et a]. (2013). It speciﬁcally calculates indices of the
per—site expected genetic variance between and within popula—
tions, which facilitates calculation of F ST in any desired genomic
window. Similarly, ngsCovar approximates the covariance ma—
trix among individuals by accounting for genotype uncertainty
from genotype posterior probabilities. Eigen—decomposition of
the resulting covariance matrix enables one to perform a princi—
pal component analysis. ngdeSFS implements several methods
to estimate the joint site frequency spectrum for two populations,
which is useful for demographic and selection inference or as a
prior in estimating genetic differentiation (Fumagalli et al.,
2013). Several scripts to manipulate and plot results are also
provided.

2.3 ngsF

ngsF provides a method to estimate individual inbreeding coef—
ficients from genotype likelihoods using an expectationi
maximization algorithm described in Vieira et a]. (2013).
Inbreeding coefflcients provide insights into a population’s
mating system and demographic history. More importantly,
incorporating inbreeding coeff1cients into the prior when calcu—
lating posterior probabilities of genotypes can lead to improved
genotype and single—nucleotide polymorphism calling. The
output of this program can be parsed by ANGSD and, conse—
quently, by all other programs mentioned here.

2.4 ngsSim and ngsUtils

ngsTools also offers many other useful tools for population gen—
etics analyses. ngsSim is a simple sequencing read simulator that
can generate data for multiple populations with variable levels of
depth, error rates, genetic variability and individual inbreeding.
ngsUtils includes tools to extract data and merge or manipulate
files generated by ANGSD.

3 EXAMPLE OF APPLICATION TO EMPIRICAL
DATA

To illustrate the use of these programs for analyzing empirical
data, we applied them to a publicly available dataset of wild rice
accessions (446 Oryza ruﬁpogon and 11 Oryza meridionalis) from
19 countries, at an effective sequencing coverage of 2x (Huang
et al., 2012). We analyzed all 11 0. meridionalis individuals and
150 randomly sampled 0. ruﬂpogon accessions.

We first used ngsF to compute individual inbreeding coeffi—
cients for all samples (rice is a partially self1ng plant), which were
then used to calculate genotype posterior probabilities in
ANGSD for each individual at all sites. Because inbreeding is
not expected to vary much across chromosomes, we estimated it
only on chromosome one. Using the genotypes and their asso—
ciated probabilities, we estimated a covariance matrix, and the
latter was decomposed to produce a principal component

analysis plot. We were able to clearly differentiate the two species
and highlight fine—scale genetic structure among different 0. rufi—
pogon ecotypes (Supplementary Fig. S1).

4 CONCLUSION

Although sequencing costs are decreasing, NGS of large samples
is still expensive causing many researchers to focus on low—depth
samples. This is particularly true for nonhuman nonmodel or—
ganisms for which research funding typically does not provide
for deep sequencing of many individuals. Analyses of data from
such species are particularly challenging because imputation—
based methods used in human genomics are not available and
because they may suffer from high levels of inbreeding. This
beckons for new and efﬁcient computational methods that
directly address the problem of genotyping uncertainty on
NGS data.

The methods provided by ngsTools are designed with this
problem in mind. ngsTools provides tools to accurately estimate
genetic variation in case of low—coverage sequencing data.
The individual methods have been previously tested providing
extensive documentation of their statistical and computational
properties.

We here report on the availability of an integrated open source
computer package facilitating access to the methods for the
broader research community. ngsTools is available on a public
repository for shared development so that additional methods
can be developed under this framework and integrated into the
software package.

ACKNOWLEDGEMENTS

The authors thank Thorflnn Korneliussen and Anders
Albrechtsen for helpful discussions and assistance using
ANGSD.

Funding: This work was supported by a NIH (3R01HG03229—07)
grant to R.N., an EMBO Long—term Fellowship ALTF 2011—229
to M.F. and an NIH Genomics Training Grant (T32HG000047—
13) to T.L.

Conﬂict of Interest: none declared.

REFERENCES

Fumagalli,M. et a]. (2013) Quantifying population genetic differentiation from next—
generation sequencing data. Genetics, 195, 9797992.

Huang,X. et a]. (2012) A map of rice genome variation reveals the origin of culti—
vated rice. Nature, 490, 4977501.

Nielsen,R. et a]. (2012) SNP calling, genotype calling, and sample allele frequency
estimation from new—generation sequencing data. PLoS One, 7, e37558.

Vieira,F.G. et a]. (2013) Estimating inbreeding coefficients from ngs data: impact on
genotype calling and allele frequency estimation. Genome Re.\'., 23, 185271861.

 

ﬁm'sIeumoI‘pJOJXO'sopeuuopnorq/ﬁdnq

