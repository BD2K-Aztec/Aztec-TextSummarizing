ORIGINAL PAPER

Vol. 29 no. 5 2013, pages 580—587
doi:10. 1 093/bioinformatics/btt005

 

Structural bioinformatics

Advance Access publication January 10, 2018

Predicting protein [i-sheet contacts using a maximum
entropy-based correlated mutation measure

Nikolas S. Burkoff, Csilla Vérnai and David L. Wild*
Systems Biology Centre, Senate House, University of Wan/Vick, Coventry, CV4 7AL, UK

Associate Editor: Anna Tramontano

 

ABSTRACT

Motivation: The problem of ab initio protein folding is one of the most
difficult in modern computational biology. The prediction of residue
contacts within a protein provides a more tractable immediate step.
Recently introduced maximum entropy-based correlated mutation
measures (CMMs), such as direct information, have been successful
in predicting residue contacts. However, most correlated mutation
studies focus on proteins that have large good-quality multiple
sequence alignments (MSA) because the power of correlated mutation
analysis falls as the size of the MSA decreases. However, even with
small autogenerated MSAs, maximum entropy-based CM Ms contain
information. To make use of this information, in this article, we focus
not on general residue contacts but contacts between residues in
,B-sheets. The strong constraints and prior knowledge associated
with ,B-contacts are ideally suited for prediction using a method that
incorporates an often noisy CMM.

Results: Using contrastive divergence, a statistical machine learning
technique, we have calculated a maximum entropy-based CMM. We
have integrated this measure with a new probabilistic model for
,B-contact prediction, which is used to predict both residue- and
strand-level contacts. Using our model on a standard non-redundant
dataset, we significantly outperform a 2D recurrent neural network
architecture, achieving a 5% improvement in true positives at the
5% false-positive rate at the residue level. At the strand level, our
approach is competitive with the state-of-the-art single methods
achieving precision of 61.0% and recall of 55.4%, while not requiring
residue solvent accessibility as an input.

Availability: http://www2.warwick.ac.uk/fac/sci/systemsbiology/
research/software/

Contact: D.L.Wild@warwick.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 27, 2012; revised on December 17, 2012;
accepted on January 2, 2013

1 INTRODUCTION

The problem of ab initio protein folding is one of the most
difﬁcult in modern computational biology. The prediction of
residue contacts within a protein provides a more tractable
immediate step, and these contacts can be used as a guide to
generate the tertiary structure of the protein.

Correlated mutation (CM) methods, ﬁrst pioneered by
Valencia and colleagues (Gobel et al., 1994), take a multiple

 

*To whom correspondence should be addressed.

sequence alignment (MSA) profile of evolutionarily related pro-
teins and attempt to predict residues that have co-evolved. If
residues have co-evolved, this may imply proximity in the
native structure. For example, if a small residue increases in
size by mutating, a proximal residue may have to reduce
in size to retain the Viability of the fold.

Many CM methods have been developed using Pearson cor-
relation coefﬁcients (Gobel et al., 1994), adaptions of Mutual
Information (Dunn et al., 2008; Lee and Kim, 2009), perturb-
ation methods (Dekker et al., 2004) and Dynamic Bayesian
networks (Burger and van Nimwegen, 2010).

A recently developed correlated mutation measure (CMM),
the direct information (Morcos et al., 2011; Weigt et al., 2008),
is a global measure that is derived from modelling the entire
MSA, speciﬁcally defining the probability of each sequence
being a member of the MSA. This distribution shares the same
low-order moments as the MSA, and the maximum entropy
principle (Jaynes, 2007) is used to fully specify the distribution.
Marks et a]. (2011), Sulkowska et a]. (2012) and Hopf et a].
(2012) have used this measure to successfully aid the folding of
a diverse range of proteins. However, like the majority of CM
studies, these authors focused on a small number of proteins for
which there is a large high-quality MSA because all CMMs
suffer as the size of the MSA decreases (Olmea and Valencia,
1997). A key distinction of this work is that we focus on a wide
selection of proteins that have a variety of sizes of MSAs. We
also automate the generation of MSAs and do not rely on a large
high-quality MSA being available.

In an attempt to improve the power of CM methods, the
Dynamic Bayesian network of Burger and van Nimwegen
(2010) incorporates primary-sequence distance into an inform-
ative prior for the model. The incorporation of this knowledge
substantially improves the results. Inspired by this, we have
chosen to predict the lateral pairs of residues in interacting
ﬂ-strands, ﬂ-contacts, using a CMM. ﬂ-contacts are associated
with strong constraints, for example, sequential pairs of residues
form ﬂ-contacts and residues can only be in ﬂ-contact with up to
two other residues. These constraints mean ﬂ-contacts are ideally
suited for prediction using a CMMithe noise associated with
the CMM is compensated for by incorporating the strong
ﬂ-contact constraints.

The prediction of ﬂ-contacts can be used to aid tertiary struc-
ture prediction (Podtelezhnikov and Wild, 2009; Ruczinski et al.,
2002), explore energy landscapes (Burkoff et al., 2012), in design-
ing proteins (Kortemme et al., 1998; Smith and Regan, 1995) and
understanding protein folding pathways (Mandel-Gutfreund
et al., 2001; Merkel and Regan, 2000).

 

580 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310'slvu1nofp103xo"sotJBurJOJutotq/ﬁduq wort papeolumoq

91oz ‘Og anﬁnv uo ::

Predicting protein [i-sheet contacts

 

We highlight BetaPro, the work of Cheng and Baldi (2005),
which uses a three-stage method to predict ﬂ-topologies and was
the first method to take into account the global nature of
ﬂ-topologies. Firstly, a 2D recurrent neural network is used to
generate a residue-level pairing map. Secondly, a dynamic pro-
gramming algorithm is applied to this map to derive strand-level
pseudo binding energies and finally, a graph matching algorithm
is used to predict strand contacts.

There are a variety of other existing methods for ﬂ-contact
prediction. They include the use of statistical potentials
(Hubbard and Park, 1994), information theoretic approaches
(Steward and Thornton, 2002), integer linear optimization
(Rajgaria et al., 2010), hybrid neural network-probabilistic
models (Aydin et al., 2011) and Markov logic networks
(MLNs; Lippi and Frasconi, 2009).

In this article, we have developed a global probabilistic model
for ﬂ-contact prediction, inspired by the secondary structure
models of Schmidler (2002), which can be used to predict both
residue- and strand-level interactions. We have integrated this
model with a CMM, similar in nature to direct information,
and using this model on a standard dataset, significantly outper-
form the recurrent neural network of BetaPro and are competi-
tive with the best single methods currently available. Unlike these
methods, our approach does not require additional information
such as residue solvent accessibility to be entered as an input to
the model. In common with other methods, we assume the native
secondary structure is known. However, our framework can be
easily extended to predict both secondary structure and
ﬂ-contacts simultaneously, and this is the focus of our current
work.

2 METHODS

2.1 Data set

In this work, we use the set of 916 proteins from Cheng and Baldi (2005)
(CB916). The proteins share no >lfe20% sequence identity, and the set
consists of 187516 residues, of which 48 996 are strand residues, which
are involved in 31 638 ,B-oontacts.

Most CM analysis procedures focus primarily on proteins for which
there is a large good-quality MSA, often a large PFAM alignment
(Sonnhammer et al., 1997). We wanted to develop a method that will
take advantage of this information where it exists, and yet is applicable
even if the CM analysis is not useful, or indeed there is no MSA, which
can be the case for newly sequenced proteins, such as those selected as
targets in the Critical Assessment of Techniques for Protein Structure
Prediction (CASP) community-wide experiment. Therefore, our method
of generating MSAs is extremely general.

We generate MSAs following a similar method to Saqi et a]. (1999).
For each sequence, we run PSI-Blast (Altschul et al., 1997) for two iter-
ations (Evalue = 0.005) against the Non-Redundant database, keeping all
sequences that share at least 30% identity to the proﬁle constructed after
the ﬁrst PSI-Blast iteration, similar to the procedure recommended in
Ashkenazy et a]. (2009). We then perform a globalilocal alignment
using GLsearch (Pearson, 2000) to trim the sequences PSI-Blast found.
We then use CD-Hit (Li et al., 2001; Li and Godzik, 2006) to cluster the
trimmed sequences at the 98% threshold and use Muscle (Edgar, 2004)
(maxiters=2) to generate MSAs. Finally, we removed columns of the
MSA that were gaps in our target sequence and any row that contained
>33% gaps. There is an enormous variation in the number of sequences
in the alignments: six proteins have no homologues, one-ﬁfth have <100
homologues and 7% have >2000 (see Fig. 1).

Proportion of datasel with MSA
consisting of fewer sequences

 

0 500 1000 1500 2000
Number of Sequences
Fig. 1. The number of sequences in the 916 MSAs varies enormously.
For example, 60% of the MSA have <500 sequences

2.2 Maximum entropy-based CM measure

CMMs based on maximum entropy modelling (also called Direct
Coupling Analysis) (Marks et al., 2011; Morcos et al., 2011; Weigt
et al., 2008) aim to distinguish between direct and indirect correlations.
Direct correlations arise owing to proximity in the native structure of the
protein and are of primary interest in contact prediction; indirect correl-
ations are caused by other reasons, such as the fact that correlations are
transitive, and are the cause of the poor performance of many CMMs.

The idea is to model the entire family of evolutionarily related proteins,
assigning probability mass over all possible (ﬁxed-length) sequences,
including those that have not been observed. From this global model,
measures can be developed to model the strength of the direct correl-
ations between pairs of residues. This idea is formalized below.

Given an MSA containing M sequences for a protein of length N, we
deﬁne f,(A ,-) as the observed frequency of residue A ,- occurring in position
i of the MSA and f,-j(A,-, Aj) as the observed frequency of both residue A,-
occurring in position i and residue / occurring in position j of the MSA.
Given any sequence A = A1, A2, . . . , A N, we model the probability of it
occurring in the MSA by a distribution P(A) = P(A1,A2, ...,AN)
However, there are qN possible different sequences (where q is the size
of the alphabet of amino acids) and only M << (1” sequences in the MSA.
The sparsity of the data and the number of sequences imply that it is
impractical for detailed use. However, we would like our model to match
the empirical low-order moments given by the MSA. Speciﬁcally we
would like

Pi(Ai) =fi(Ai) and P ij(Ai, Aj) =fij(Ai, Aj)

where P,—(.) is the marginal distribution for position i and P,-j(., .) is the
(joint) marginal distribution (We have not added pseudo-counts or
weighted sequences) marginal distribution of positions i and j (we have
not added pseudo-counts or weighted sequences).

Among the valid distributions P satisfying these constraints, using the
maximum entropy principle (J aynes, 2007), we favour ‘11, the distribution
that has maximum entropy, S:

m = argrnaxP[S(P)] E argmaxp { — Z P(A) log[P(A)]}
A

and solving this optimization problem using Lagrange multipliers leads to
the distribution

‘11(A1,...,AN)o<exp|:— Z e.,-(A,-.A,-)+ Z MAJ]
1sigsN lsisN

for some pair-interaction energies e,-j(A,-, A j) and local ﬁelds h,(A,-) (W eigt
et al., 2008). See the Supplementary Data for further details.

 

581

112 ﬁle'sleumofqurxo"sotJBurJOJutotq/ﬁduq wort papeolumoq

91oz ‘Og anﬁnv uo ::

N.S.Burkoff et al.

 

The maximum entropy distribution can be viewed as a Potts model on
an underlying complete graph, where the nodes represent the residue
positions, the ‘spins’ correspond to the amino acid types and the edges
describe the pairwise interactions, whose strengths are described by the
pairwise interaction energies e,-/~. A related model for protein families,
using Markov random ﬁelds (Balakrishnan et al., 2011), can also be
viewed as a Potts model. However, instead of the underlying graph
being complete, an optimal subgraph is chosen that aims to fully explain
the correlations and conditional independencies within the underlying
protein family.

To generate the maximum entropy distribution ‘11, we use a statistical
machine learning technique, contrastive divergence (Hinton, 2002). This
work represents the ﬁrst application of this approach to the modelling of
protein MSAs. For a given set of eg-(Ai, A j) and h,(A,-), we use contrastive
divergence to approximate the marginal distributions P,—(.) and P,-j(., .)
and use gradient descent to update e,-,~ and h,. We iterate this procedure
to convergence. For a protein of 75 residues, the procedure takes ~10 mi-
nutes on a single core of an Intel Core i7 processor, and for a protein of
350 residues, the procedure takes ~25 h. Further details are found in the
Supplementary Data.

Once we have calculated the distribution ‘11, we deﬁne our CMM, D.
For each pair of residues (i, J), we deﬁne D(i,j) as follows:

. . D 13501,. A.)
Do.»  in, (An/1,) log ﬂ Ai) ff ( A!)
where
mil-«Ah A1) 0<fi(Ai)fj(Aj) Expl—ezﬂAh AD]-

This is a modiﬁed version of the Direct Information previously used to
predict protein contacts (Marks et al., 2011; Weigt et al., 2008). The
Direct Information measure itself was tried but produced slightly
poorer results than Z). See the Supplementary Data for more details.

To show the power of D, for each protein in the dataset, we took the
top N/2 ranked D(i,j), where N is the length of the protein (we remove
those for which Ii —j| 5 4 from the analysis) and calculated the contact
ratio: the proportion of these pairs of residues whose CD, distance is 5 8A.
The contact ratio versus log(]ll) is shown in Figure 2 (Top). Figure 2
(Bottom) shows the average CD, distance of these N/2 predicted contacts.
These figures show that there is a lot of information contained within 1),
especially as M increases.

However, using randomly chosen contacts of known structures, it has
been shown that one needs around a quarter to two-ﬁfths of contacts to
be able to successfully regenerate the native structure (Duarte et al., 2010;
Sathyapriya et al., 2009; Vendruscolo et al., 1997). Marks et a]. (2011)
and Hopf et a]. (2012) have shown that if a protein has a large number of
sequences in its MSA, then maximum entropy-based CM analysis, to-
gether with predicted secondary structure is enough to successfully recon-
struct the tertiary structure of the protein. In these articles, the authors
take the highest-ranked correlated pairs of residues to be incorporated
into distance constraints used to generate initial all-atom conformations
of the protein. Simulated annealing, relaxing these distance constraints
throughout the simulation, is then used to generate ﬁnal
three-dimensional structures.

However, as shown by Figures 1 and 2, a large number of proteins
have only a small MSA and CMMs by themselves are unlikely to be able
to provide a large enough number of contacts to successfully fold the
protein. For example, Marks et a]. (2011) restrict their attention to
proteins whose MSA has at least 1000 sequences, and usually signiﬁcantly
more. Nevertheless, even an alignment with M = e6 w 400 sequences pro-
duces an average contact ratio of ~0.15, which still contains lots of
information (for an average protein, the contact ratio for randomly
chosen contacts is ~0.03). In contrast to these other studies, we investi-
gate whether one can make use of this evolutionary information. We
propose to use 1) to improve the prediction of ,B-contacts, for which

Contact Ratio

Average Distance

 

Log(number of sequences in MSA)

Fig. 2. Top: The proportion of the top N/2 ranked D(i,j) in contact
(contact ratio) versus the number of sequences in the MSA for each
protein in the CB916 dataset. A contact is deﬁned as the CD, distance
being 5 8A. Bottom: The average CD, distance of the top N/2 ranked
D(i,j). Two outliers [at (3.4, 37.9) and (4.5, 42.1)] are not shown

there is a large amount of structural knowledge, which can be incorpo-
rated as prior beliefs within a Bayesian statistical framework. The follow-
ing sections describe the new ,B-strand Bayesian model we have developed
and how we couple D(i,j) to it.

2.3 [i-Topology model

Given a primary sequence R = {R1, R2, . . . , RN} and its secondary struc-
ture S = {S 1 , S2, . . . , S N}, where S,- is the secondary structure of residue i,
residues R,- and R; are deﬁned to be a ,B-contact if they are a lateral pair
within two interacting ,B-strands. For example, in Figure 3, residues 6 and
53 are a parallel ,B-contact and residues 44 and 53 are an antiparallel
,B-contact. We deﬁne I to be the set of ,B-contacts. Speciﬁcally
(i, j, 1) e I if residues R,- and Rj are a parallel ,B-contact, (i, j, — 1) e I
if residues R,- and R; are an antiparallel ,B-contact and (i, j, 0) e I if either
residue R,- or Rj is an isolated ,B-bridge. We say (i,j) e I if (i,j, 1), (i,j, 0)
or (i,j, — 1) GI.

The general framework we are using (from Schmidler, 2002) allows
inference for S and I given R. Following the Bayesian method,
we require a prior [P(S,I) = P(IlS)[F°(S) and a likelihood P(RlS,I).
Using Bayes’ theorem, these yield the posterior of interest
[P(S,I|R) oc [P(RlS,I)[P(S,I).

In this work, we assume the secondary structure is ﬁxed. Speciﬁcally
[P(S) = 1, if S is the secondary structure assignment given by DSSP
(Kabsch and Sander, 1983)7we map residues labelled E and B to E,
strand residues, and all other labels to C, non-strand residues. For clarity
we suppress the dependency on S, i.e. P(IlS) = [P(I). A focus of our
current work is to extend the model to allow joint inference for S and I.

 

582

112 ﬁlo's[BumoprOJXO'sotwuiJOJutotq”:duq won papeolumoq

91oz ‘Og lsnﬁnv uo ::

Predicting protein [i-sheet contacts

 

Deﬁnitions: Viewing I as a collection of individual residue contacts
does not easily allow the incorporation of the structure of ,B-oontacts into
a model; therefore, we model I as a set of interacting strand segments,
following (Chu et al., 2006). The set of residue contacts in I can be
uniquely determined by specifying which strand segments interact and
for each pair of interacting strands specifying their direction, alignment
and position of any bulges. We formalize these terms below.

The strand residues of a protein can be represented as a set of distinct
strand segments (For some proteins, DSSP deﬁnes two separate strand
segments immediately adjacent in sequence. For example ‘EEEB’. For a
fair comparison with BetaPro we deﬁne a strand segment as a contiguous
block of strand residues. However, this is not necessary for our model).
For example, Figure 3 shows 4 strand segments (E1,E2,E3,E4). In this
protein, there is a single sheet, and in this simple case, the strand inter-
actions can be described by a permutation d) of the set of strand segments.
Speciﬁcally ¢(1,2, ...,m) = [¢(1),¢(2), ...,¢(m)] and implies segment
E¢(,) and E¢(,+1) interact for r = 1,2, ...,m — 1. In Figure 3,
¢(1,2, 3, 4) = (3,4,1,2). In more complicated cases, the sheet structure
cannot be described by a permutation. For example, if there is more than
one sheet, if strands are involved in more than two interactions or if there
is a cycle (for example in ,B-barrels, where every strand interacts with two
partners).

Following the terminology in (Ruczinski et al., 2002), we say there is a
jump between segments E, and EH if E, and EH are not interacting. In
Figure 3, there is a jump between segments E2 and E3 and no other
jumps. We deﬁne the jump pattern J as the set of r for which E, and
EH are not interacting; in Figure 3, the jump pattern J: {2}. See
Figure 4(a41) for further examples of d) and J.

We introduce d” to describe the direction of interaction, speciﬁcally
d,Y = 1 if interacting segments E, and EY are a parallel strand interaction
and d,Y = —1 if the segments are antiparallel. In Figure 3, d34 = d12 = —1
and d14 = 1. If either E, or EY is an isolated ,B-bridge, then d,Y = 0.

The variable an, is used to deﬁne the shift between strands. For parallel
interactions, am describes the shift between the ﬁnal residues of both

N
I ’I
2 19
ﬂ 3 13
46 51 4 17
45 52 5 16
44 53 6 15
43 54 7 14
42 55 8 13

 

Fig. 3. Left: The structure of protein G (lPGA). Right: The ,B-topology
for protein G. The numbers are the positions in the sequence of the strand
residues and the horizontal lines are ,B-oontacts. Residues 6 and 53 are a
parallel ,B-contact and residues 53 and 44 are an antiparallel ,B-contact.
Hence (6, 53, 1) and (44, 53, — 1) e I. The 4-strand segments E1,E2,E3,E4
are ordered from left to right in the sheet E3,E4,E1,E2, and hence the
permutation d), which permutes (1, 2, 3, 4) to (3, 4, 1, 2) describes the
set of interactions. There is a jump between segments E2 and E3.
Segments E1 and E2 are an antiparallel interaction and hence d12 = —1,
and segments E1 and E4 are parallel and so d14 = 1

strands. For example, in Figure 3, am 2 0 because (8,55) 6 I. If E1
was shifted up by one residue, so that (8, 54) e I, then an would equal
+1. Conversely, if E1 was shifted down by two residues, so that residue
(6, 55) e I, then an would equal —2. For antiparallel interactions, an,
describes the shift between the end of the strand earlier in the sequence
and the beginning of its interacting partner (i.e. between residues 8 and 13
for a12 in Fig. 3).

Restricting the number of bulges to at most one per ,B-strand inter-
action (which is the case in 98.6% of cases), we can deﬁne b,Y = 0 if there
is no bulge or b,Y = k if residue k is the ,B-bulge. There are no bulges in the
sheet shown in Figure 3. Figure 4 shows the values of {dm,am,brs} for
different interacting segments.

Prior for I, P(I There is a huge amount of structure in
,B-topologies and the challenge for a Bayesian statistician is to try and
capture this while being able to efﬁciently calculate posterior probabilities
and not overﬁtting the model. Rather than aim for the most probable
,B-topology, we calculate [P((i,j) e I |R), producing a probability contact
map, analogous to the output from BetaPro’s Neural Network. Unlike
other statistical models (Aydin et al., 2011), we do not take the output
from BetaPro’s Neural Network as an input to our model.

We take advantage of the framework of Bayesian inference, which
allows us to exercise our scientiﬁc judgement and experience concerning
parameters that we expect to be of particular importance, and by specify-
ing how these are plausibly related.

We model the interacting ,B-strands as a single sheet deﬁned by a per-
mutation d), as described above. Although our approach does not model
more than one sheet per protein, we can predict multiple sheets (see
Figure 8). More complicated models involving partitioning the segments
into different sheets were tried, but these did not improve the results. We
only allow a single bulge per strand interaction.

Our prior is deﬁned as

W) = W) 1‘1 Penman idm)t=>(bmiam. d”)

where the product is over all segments E, and EY that are interacting,
given permutation d), and we have suppressed the dependence of every-
thing on the secondary structure S. The set {(1), d”, a”, bm} gives a unique
set of residue contacts (i, j) e I, and if I cannot be described by a set
{(1), d”, a”, bm}, then [P(I) = 0. We define the distance 1,, as the number
of residues between segments E, and E,. For example, in Figure 3,
1:12 2 4, and we deﬁne I, as the number of residues in segment E,.

o [P(qb): The probability of a speciﬁc permutation depends on all the
distances 1,, and the lengths of all the strands 1,. However, incorpor-
ating all this information leads to an exponential number of param-
eters. In the dataset, 50% of interacting strands are adjacent in
sequence (and 42% of adjacent strands are interacting), so one of
the most important things we would like the distribution to capture is
whether adjacent strands are in contact. For these reasons, in our

(a) (b) (C) (d)
ETE2—E3_E4 ErEa—Es—Ez EIErEa—Ez 5354—51—53

(e) (7) t (9) (h) (i)

10 10 25 10 10 23 10

11 t 11 24 11 11 24 11

12 25 12 4 12 12 25 12

13 24 13 23 25 13 13 i 13 23

14 23 14 24 14 14 14 24

t t 23 i 15 15
16 16 25
i i i

Fig. 4. (a—d) Examples of different values of d): (a) d) = (1, 2, 3, 4),J = {};
(13) ¢ = (1,4, 3,211: {1}; (0) ¢ = (4, 1,12%]: {1,3}; ((1)
d) = (2, 4, 1, 3),J = {1, 2, 3}. (e—i) Examples of different {dm ambmli (e)
{-1,0,0};(f){-1, -1,12};(g){-1,1,0};(h){1, — 4,0}; (i) {1,0,15}

 

112 /310'sleu1nofp101xo'sopBHJJOJuyqu/ﬁduq won papeolumoq

91oz ‘Og JSanV uo ::

N.S.Burkoff et al.

 

model, all d) that share the same jump pattern J are equally likely,
and the probability [P(r e JI‘E,,+1, l,, l,+1) is independent for each r.
[P(r e J IT,,+1, l,,l,+1) is taken from the training set by counting oc-
currences. For small I and 1:, we take values directly from the training
set, and for larger l and ‘E, owing to sparsity of data, we collapse the
data into a small number of bins. We added a pseudo-count to
smooth the data from the training dataset.

o If either I, or ls: 1, then [P(dm = 0) = 1, otherwise [P(dm = lltm) is a
piecewise linear function of 1,1,, ﬁtted from the training set.

a P(amldm): There is an inherent asymmetry in our deﬁnition of am; in
the case of parallel strands, we are measuring the shift from a perfect
alignment of the ends of the segments, not the beginnings.
In proteins, it is found that the shift measured from a perfect
alignment of at least one end of the segments is small. Compare am
for Figures 4(h4i). Previous work has not taken this into account
(Chu et al., 2006), which leads to a drop in performance. Therefore,
we model [P(amldm) as a mixture (equally weighted) of the distribu-
tions [P’dn(a,,) and P4423”), where a” is the shift required from align-
ing the beginnings of the segments to get the same residue contacts as
a shift of am produces from aligning the ends of the strands. These
distributions are taken from the training set. An analogous proced-
ure is followed for the antiparallel case.

a [F"(b,,Y 7e Old”, a”) = [F"(b,,Y 7e 0) is taken from the training set, and if
there is a bulge, there is a uniform probability over all residues
involved in the interaction that they are a bulge (hence the depend-
ence on d,, and amito know which residues can be the bulge).

Likelihood: P(RlI)

P(RII) o< l1l(“‘E"” exp(—vl1l) 1‘1 [L(R.-, Rjidi)
(i,j,d,-,-)EI

where the joint likelihood |]_(R,-, led,-,-) is approximated from the limited
training set by the product of the conditionals, [P(RilR, d,-,-) and
[P(leRi, d,-,-), where [P(.|R-, d,-,-) is the distribution of amino acids in con-
tact with the residue type of R, in the direction of  |I| is the number of
contacts and |E| is the number of ,B-residues. The distributions [P(.|R-, d,-,-)
are taken from the training set, and u and v are constants to be
determined.

We have chosen this likelihood because of its simplicity. More com-
plicated dependencies, such as letting R,- depend on Rjil, were tried, but
did not noticeably improve the results. We include a gamma distribution
on the number of contacts into the likelihood because, without this term,
the likelihood is a product of 2|I| numbers smaller than one, and so
actively penalises against contacts. We include |E| so that the mean
and variance of the gamma distribution depend on the number of
,B-residues, which allows the model to control the total number of con-
tacts. This is important as |I| and |E| are strongly correlated. The
constants u and v were ﬁtted using an empirical Bayes approach, and
set to 18 and 12, respectively. See Supplementary Data for more details.

2.4 Integrating CM measure with the ﬁ-topology model

In this work, we perform inference on both the posterior distribution
731(I|R) oc [P(I)[F°(R|I) and, by adapting the concept of a ‘product of
experts’ (Hinton, 1999, 2002), on a distribution that couples D(i,j) to the
,B-topology model. A product of experts allows different probabilistic
models of the same data to be combined together by multiplying the
probabilities together and renormalizing. An advantage of this method
is that each model (‘expert’) can focus on different aspects of the under-
lying problem, and that regions of space with high probability mass must
satisfy each of the experts, owing to the multiplication of their
probabilities.

A product of experts has been successfully used for secondary
structure prediction (Chu et al., 2006), where there were separate experts
for segmental dependency and strand and helical capping signals.
In the present case, we have a distribution for inference of I given
strand pattern 731, and a distribution for inference of I given 1), a
distribution proportional to exp[w(D,I)], described below. Adapting
the idea of a product of experts distribution, we use a product of
distributions 732(I|R) oc 731(I|R) exp[w(D,I)]. When 732(I) is large, I
must satisfy both the strand pattern model of 731 and the CMM
exp[w(D,I)]. (Formally, 732(I|R)= 73(I|R,D)o<[P(I|R)[P(I|D) and
[P(IlD) =exp[w(D,I)]/ Ziexp [w(D,I,—)] where the sum is over the
(ﬁnite) set of possible I ,-.)

Correlated mutation measure, exp[a)(D,I)]: As previously
described, D(i,j) is a measure of how strongly residues in columns
i and j co-vary, and a large D(i,j) suggests residues in columns i and
j have co-evolved, and may imply a ,B-contact between R,- and R, This
information can be incorporated into the inference as a CMM
exp[w(D,I)]. The better I and D(i, ') ﬁt the larger the value of a). The
formal description of a) follows. We deﬁne

0,- : (j : R, is a residue in a different strand to residue R,-).

As a concrete example, Figure 5a shows a protein with three
strands, residues 345, 12414 and 23425, where, for example,
04 = {12, 13, 14, 23,24, 25} and 023 = {3,4,5,12,13, 14}.

In ,B-sheets, the side chains of residues j and j :l: 2 are near each other
in space, and so if D(i,j :l: 2) are large, this may also imply a
contact between R,- and R, For a particular set of contacts I and
residue R,-, we deﬁne the score x(i, I) as the mean of the set
{D(i,j) :j e I,-} where
0,- ifﬁj:(i,J)eI
1i = { U {j — 2,j,j+ 2} otherwise

ji(i,j)EI

As a concrete example, Figure 5b shows a speciﬁc instance of I, and in
this case I5 = 05,I4 = {12,14,16} and I13 2 {1,3,5,22, 24, 26}. The
larger x(i, I) the better 1) and I ﬁt for residue R,-. However, for different
residues R,-, the mean and variance of the set of values {D(i,j) : j e 0,}
differ wildly and so x(i, I) needs to be standardized before being used.
For this standardization we take the sample mean a,- and standard devi-
ation a,- of the set {D(i,J) : j e 0,}. So the standardized score, for residue
R,- and interaction set I is then deﬁned as

x031) - M,-

I

Z(i, z) 2

Deﬁning Imam,C as the crystal structure ,B-oontacts deﬁned by DSSP,
Figure 6 shows the empirical distribution of Z(i, I native) over all residues
involved in at least one ,B-contact from the dataset. A much larger mass
has positive score than a negative score, implying native contacts have, on
average, a larger value for Z.

We then deﬁne

ma), 1) = log M Z Z(i, z)
where the sum is over all i for which R,- are strands and M =number

of sequences in MSA; so that proteins with larger MSA attach more
importance to a).

3 RESULTS AND DISCUSSION

We performed 10-fold cross validation using the same folds as
Cheng and Baldi (2005). To estimate posterior probabilities, we
used importance sampling. We generated 1 million independent

 

584

112 /310'S[BIIJDO[pJOJXO"SO11BHIJOJH101q/ﬂdnt1 won papeolumoq

91oz ‘Og JSanV uo ::

Predicting protein [i-sheet contacts

 

(a)
---- -- 3 4 5  13 14-------23 24 25------

(b) 12 23
3 13 24
4 14 25
5

Fig. 5. (a) A protein with three strands, residues 345, 12414 and 23425.
(b) A speciﬁc set ofoontacts I = {(3, 13), (4, 14), (12, 23), (13, 24), (14, 25)}.
See the text for how the standardized score is calculated for this example

0.6 0.8 1.0

Density

0.4

0.2

 

0.0

 

I l l I l

—2 —1 o

Standardized Score

N

Fig. 6. The empirical distribution of the standardized score, Z(i,InatiVC)
(described in the main text), of all residues involved in at least one
,B-contact from the dataset

Using Correlated Mutation Measure
Not using Correlated Mutation Measure ----- »-

Sensitivity

 

0 0.02 0.04 0.06 0.03 0.1
1 - Specificity

Fig. 7. ROC curves for the posterior both unweighted (dashed) and
weighted (solid)

samples from the prior P(I), {I} and use these to generate a
probability contact map:

. N . P(RII)
P((z, ) e I|R) ~ g “[041 e 11W

where I] is the indicator function and P(RlI) is the likelihood
described above (in the case with the CMM we replace P(RlI)
by P(RlI ) exp[a)(D, I )1 See Supplementary Data for further de-
tails. We repeated this 50 times and took the mean of the 50
values to generate a single result.

We first quantify the effect of incorporating the CMM into
our model. We can take the output of our model and discretize
the results, taking as our ﬂ-contacts, all (i, j) such that
P((i,}) e I |R) is larger than a threshold value. Taking different
threshold values, Figure 7 shows the receiver operating charac-
teristic (ROC) curve for ﬂ-contacts using both the posterior with-
out the CMM 731 (dashed) and the model using the CMM 732
(solid). Using the CMM has signiﬁcantly improved the results.
For example, there is a 10% improvement in the number of true
positives at the 5% false-positive rate. Figure 7 clearly shows that
we have successfully used the evolutionary information, shown
to exist in Figures 2 and 6, to improve the prediction of
ﬂ-contacts.

We can also compare our model with existing ﬂ-contact pre-
diction methods. For example, Table 1 shows a comparison with
the Neural Network output of the first stage of BetaPro. The
results quoted are AUC (Area Under Curve), the true-positive
(TP) rate at 5% false positives (FP), TP at the break even point
(BEPiwhen the total number of predicted ﬂ-contacts is equal to
the true number of 13 contacts) and the correlation coefﬁcient
y: (TPxTN—FPxFN)/\/(TP+FN)(TP+FP)(TN+FN)(TN +F P)
at the BEP. This table shows that without the CMM, we produce
poorer results than BetaPro. This is to be expected as 731 is a
single sequence method, in contrast to BetaPro that inputs the
whole MSA into its neural network. The addition of our CMM
improves our method, producing better results than BetaPro.

Unlike some existing models, including BetaPro, our model is
completely probabilistic, which enables us to predict both resi-
due-level contacts and strand interactions simultaneously, rather
than the latter needing a post processing step. Given strands E,
and ES, they are deﬁned to be interacting if there exist any
ﬂ-contact between a residue in strand E, and a residue in
strand ES. Using our model, we find the following:

 

. . P(RII)
P(E,., E, 1nteract|R) B 2 ME, E, 1nteract)—
,1, gram)

Figure 8 shows the results for two proteins, the N—terminal
domain of the yeast HSP90 chaperone [1A4H (left)] and the
tetramerization domain of the Shal voltage-gated potassium
channel [1NN7 (right)]. For these proteins, our model correctly
predicted all strand level interactions and it is interesting to note
that for 1NN7, two separate ﬂ-sheets are correctly predicted
(strands {5,6}, {3,4,1,2} are distinct ﬂ-sheets), despite our
model not explicitly modelling multiple sheets.

By thresholding the strand interaction probabilities at different
values, we can generate a Precision [P=TP/(TP+FP)] versus
Recall [R=TP/(TP+ FN)] graph for strand interactions,
shown in Figure 9. This ﬁgure again shows the improvement
of the results when we use our CMM.

Table 2 shows a comparison of the strand interactions results
for our model, the ﬁnal output of BetaPro and a MLN (Lippi
and Frasconi, 2009). For the comparison, we have only included
independent methods and not those such as MLN-2S (Lippi and
Frasconi, 2009) or those found in Aydin et al. (2011), which are
hybrid approaches that combine results from more than one
method. The results quoted for our model use the specific prob-
ability threshold of 0.45; however, taking the threshold at any

 

585

112 /3.IO'S[BIIJI’101PJOJXO"SO11BHIJOJH101q/ﬂdnt1 won papeolumoq

91oz ‘Og JSanV uo ::

N.S.Burkoff et al.

 

   

Interaction
Probability

OWU'l-bUUNI—I

mNmU'l-hWNH

 

12345678

123456

Fig. 8. Contact maps for the strand level for proteins 1A4H (left)
and 1NN7 (right). Above the main diagonal, the native (true) strand
interactions are shown in yellow, and below the diagonal,
[P(E,,E, interacth) using 732 is shown. For protein 1NN7, it is interest-
ing to note that two separate ,B-sheets are correctly predicted, despite our
model not explicitly modelling multiple sheets

0.8

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

I Using CoIrelated Mut'ation Measure
v~ Not using Correlated Mutation Measure ----- --
\\ Beta Pro +
DJ _ MLN
I“‘~V.\
I“.
0.6 _‘
\\
.\~ .1

c 0.5 ‘
a
'ﬁ
'6
9
D. 0.4

0.3

0.2 .

0.1

0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

Recall

Fig. 9. Precision versus Recall graph for strand interactions. As a com-
parison, a naive algorithm always pairing adjacent strands yields P = 0.42
and R = 0.50. The results from the ﬁnal output of BetaPro and a Markov
Logic method (Lippi and Frasconi, 2009) are also displayed for
comparison

Table 1. Comparison of the model with the output of BetaPro’s Neural
Network

 

 

Method AUC TP at 5% TP at y at
FPR BEP BEP
731 (no CMM) 0.85 53% 36% 0.34
732 (with CMM) 0.89 63% 44% 0.43
BetaPro 0.86 58% 41% 0.4

 

See text for further details. FPR = false positive rate.

value between 0.25 and 0.63 produces an F1 2 2PR/(P+R)
statistic equal to or above the value found by BetaPro.

The results of our model are clearly better than BetaPro and
competitive with MLN. This is an impressive result, as unlike
these methods we do not require the additional information of
the solvent accessibility of the residues as an input. We also do
not require the secondary structure of the non-strand residues,
which is important to the MLN method. The only information
we use is the maximum entropy-based CMM D (731 is a single
sequence method). D is as useful as providing the entire MSA as

Table 2. Comparison of strand level statistics of our model (732), the ﬁnal
output of BetaPro and the MLN method of Lippi and Frasconi (2009)

 

 

Statistic 732 BetaPro MLN
P 61.0 53.1 59.8
R 55.4 59.7 55.5
F1 58.1 56.2 57.6
y 0.532 0.508 0.528
Chains with F1 3 70.0 35.0 31.7 33.7

 

Apart from y, statistics are shown as percentages.

a set of 20-dimensional vectors of probabilities as input to a
neural or MLN. This may be because providing the columns
of the MSA as independent input vectors captures the wrong
information; although certain residue pairs are more likely to
form ﬂ-contacts (for example, pairs of hydrophobic residues in
the core of a protein), the individual pairing preferences are not
especially strong, and proteins do not seem to have strong evo-
lutionary pressure to maintain favourable pairings between
strands (Mandel-Gutfreund et al., 2001).

Also, just considering the speciﬁc residue types, rather than
how they co-vary, suffers from the problem of transitivity: if E, is
paired with both E, and E,, then it is often the case E, and E,
themselves contain residues with favourable pairings, as they
both favourably interact with E,.

For our method to be useful for proteins with unknown struc-
ture, it is important to test our method with predicted secondary
structure. In the Supplementary Data, we have presented results
for the CASP 2010 set of proteins using both known and pre-
dicted strand structure, and in both cases our method compares
favourably with BetaPro.

4 CONCLUSION AND FURTHER WORK

In this article, we have used a statistical machine learning
approach known as contrastive divergence to efﬁciently calculate
a Maximum Entropy distribution that models the evolutionarily
related family of a protein and have used this to calculate a
CMM to predict residue contacts. We have coupled this measure
to a probabilistic model of ﬂ-strand interactions to produce a
state-of-the-art ﬂ-contact predictor that can be used even if a
poor quality or no MSA is available. The current focus of our
work is to allow joint inference of ﬂ-contacts and secondary
structure by incorporating a semi-segmental Markov model to
model the secondary structure of proteins (Chu et al., 2006;
Schmidler et al., 2000).

Unlike other recent CM studies, we have focused on proteins
that do not necessarily have large enough MSAs to enable full
tertiary structure determination using a CM approach. However,
our strand interaction prediction can be incorporated into a
tertiary structure prediction method. For example, our previ-
ously published work describes a coarse-grained protein model
that uses a physically meaningful energy function, biased by a
harmonic potential on ﬂ-contacts to enable the protein to
fold (Burkoff et al., 2012; Podtelezhnikov and Wild, 2008).
Using our strand prediction method to predict ﬂ-contacts enables
this model to be used for protein tertiary structure prediction.

 

586

112 /310'sicu1noip101xo"soiJBuiJOJuioiq/ﬁduq uteri papeoiumoq

91oz ‘Og 1sn8nV uo ::

Predicting protein [i-sheet contacts

 

Further details and speciﬁc examples are shown in the
Supplementary Data.

ACKNOWLEDGEMENT
We thank John Skilling for helpful discussions.

Funding: We acknowledge support from the Leverhulme Trust
(grant F/00 215/BL to N.S.B, CV. and D.L.W.).

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et al. (1997) Gapped BLAST and PSI—BLAST: a new generation of
protein database search proteins. Nucleic Acids Res., 25, 338973402.

Ashkenazy,H. et al. (2009) Optimal data collection for correlated mutation analysis.
Proteins, 74, 5457555.

Aydin,Z. et al. (2011) Bayesian models and algorithms for protein B—sheet predic—
tion. IEEE/ACM Trans. Comput. Biol. Bioinformatics, 8, 3957409.

Balakrishnan,S. et al. (2011) Learning generative models for protein fold families.
Proteins, 79, 106171078.

Burger,L. and van Nimwegen,E. (2010) Disentangling direct from indirect
co—evolution of residues in protein alignments. PLoS Comput. Biol, 6,
61000633751.

Burkoff,N.S. et al. (2012) Exploring the energy landscapes of protein folding simu—
lations with bayesian computation. Biophysical. J., 102, 8787886.

Cheng,J. and Baldi,P. (2005) Three—stage prediction of protein B—sheets by neural
networks, alignments and graph algorithms. Bioinformatics, 21, i757i84.

Chu,W. et al. (2006) Bayesian segmental models with multiple sequence alignment
proﬁles for protein secondary structure and contact map prediction.
IEEE/ACM Trans. Comput. Biol. Bioinformatics, 3, 987113.

Dekker,J.P. et al. (2004) A perturbation—based method for calculating explicit like—
lihood of evolutionary co—varianoe in multiple sequence alignments.
Bioinformatics, 20, 156571572.

Duarte,J.M. et al. (2010) Optimal contact deﬁnition for reconstruction of contact
maps. BMC Bioinformatics, 11, 283.

Dunn,S.D. et al. (2008) Mutual information without the inﬂuence of phylogeny or
entropy dramatically improves residue contact prediction. Bioinformatics, 24,
3337340.

Edgar,R.C. (2004) MUSCLE: multiple sequence alignment with high accuracy and
high throughput. Nucl. Acids Res., 32, 179271797.

Gobel,U. et al. (1994) Correlated mutations and residue contacts in proteins.
Proteins, 18, 3097317.

Hinton,G.E. (1999) Products of experts. In: Proceedings of the Ninth International
Conference on Artificial Neural Networks, Vol. 1. University of Edinburgh, UK,
pp. 1%.

Hinton,G.E. (2002) Training products of experts by minimizing contrastive diver—
gence. Neural Comput, 14, 177171800.

Hopf,T.A. et al. (2012) Three-dimensional structures of membrane proteins from
genomic sequencing. Cell, 149, 160771621.

Hubbard,T.J. and Park,J. (1994) Use of B—strand interaction pseudo potentials in
protein structure and modelling. In: Proceedings of the 27th Hawaii Int’l Conf.
System Sciences. Maui, HI, USA, pp. 33(r344.

Jaynes,E.T. (2007) Probability Theory: The Logic of Science. CUP, Cambridge, UK.

Kabsch,W. and Sander,C. (1983) Dictionary of protein secondary structure: pattern
recognition of hydrogen—bonded and geometrical features. Biopolymers, 22,
257772637.

Kortemme,T. et al. (1998) Design of a 20—amino acid, three—stranded B—sheet pro—
tein. Science, 281, 2537256.

Lee,B.—C. and Kim,D. (2009) A new method for revealing correlated mutations
under the structural and functional constraints in proteins. Bioinformatics, 25,
250(r2513.

Li,W. and Godzik,A. (2006) Cd—hit: a fast program for clustering and
comparing large sets of protein or nucleotide sequences. Bioinformatics, 22,
165871659.

Li,W. et al. (2001) Clustering of highly homologous sequences to reduce the size of
large protein database. Bioinformatics, 17, 2827283.

Lippi,M. and Frasconi,P. (2009) Prediction of protein B—residue contacts by
Markov logic networks with grounding—speciﬁc weights. Bioinformatics, 25,
232(r2333.

Mandel—Gutfreund,Y. et al. (2001) Contributions of residue pairing to beta—sheet
formation: conservation and covariation of amino acid residue pairs on anti—
parallel beta—strands. J. M0]. Biol, 305, 114571149.

Marks,D.S. et al. (2011) Protein 3D structure computed from evolutionary sequence
variation. PLoS One, 6, e28766.

Merkel,J.S. and Regan,L. (2000) Modulating protein folding rates in vivo and
in vitro by side chain interactions between the parallel beta strands of green
flluorescent protein. J. Biol. Chem., 275, 2920029206.

Morcos,F. et al (2011) Direct—coupling analysis of residue coevolution captures
native contacts across many protein families. Proc. Natl Acad. Sci. USA, 108,
E12937E1301.

Olmea,O. and Valencia,A. (1997) Improving contact prediction by the combination
of correlated mutations and other sources of sequence information. Fold. Des.,
2, 3257331.

Pearson,W.R. (2000) Flexible sequence similarity searching with the FASTA3 pro—
gram package. Methods Mol Biol, 132, 1857219.

Podtelezhnikov,A.A. and Wild,D.L. (2008) Crankite: a fast polypeptide backbone
conformation sampler. Source Code Biol. Med, 3, 12.

Podtelezhnikov,A.A. and Wild,D.L. (2009) Reconstruction and stability of second—
ary structure elements in the context of protein structure prediction. Biophys. J.,
96, 439%4408.

Rajgaria,R. et al. (2010) Contact prediction for beta and alpha—beta proteins using
integer linear optimization and its impact on the ﬁrst principles 3D structure
prediction method ASTRO—FOLD. Proteins, 78, 182571846.

Ruczinski,I. et al. (2002) Distribution of beta sheets in proteins with application to
structure prediction. Proteins, 48, 8&97.

Saqi,M.A.S. et al. (1999) Protein analystia distributed object environment for
protein sequence and structure analysis. Bioinformatics, 15, 5217522.

Sathyapriya,R. et al. (2009) Deﬁning an essence of structure determining residue
contacts in proteins. PLoS Comput. Biol, 5, e1000584.

Schmidler,S.C. (2002) Statistical models and monte carlo methods for protein struc—
ture prediction. In: PhD Thesis, Stanford University, Stanford, CA, USA.
Schmidler,S.C. et al. (2000) Bayesian segmentation of protein secondary structure.

J. Comput. Biol, 7, 2327248.

Smith,C.K. and Regan,L. (1995) Guidelines for protein design: the energetics of
)3 sheet side chain interactions. Science, 270, 9807982.

Sonnhammer,E.L.L. et al. (1997) Pfam: a comprehensive database of protein
families based on seed alignments. Proteins, 28, 4054120.

Steward,R.E. and Thornton,J.M. (2002) Prediction of strand pairing in antiparallel
and parallel beta—sheets using information theory. Proteins Struct. Funct. Genet,
48, 1787191.

Sulkowska,J. et al. (2012) Genomics—aided structure prediction. Proc. Natl Acad.
Sci. USA, 109, 1034010345.

Vendruscolo,M. et al. (1997) Recovery of protein structure from contact maps.
Fold Des., 2, 2957306.

Weigt,M. et al. (2008) Identiﬁcation of direct residue contacts in protein—protein
interaction by message passing. Proc. Natl Acad. Sci. USA, 106, 67772.

 

587

112 /310'siau1noip101xo"sonauuoiuioiq/ﬁduq uteri papaoiumoq

91oz ‘Og 1sn8nV uo ::

