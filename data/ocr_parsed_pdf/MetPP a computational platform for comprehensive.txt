BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

an?kgowsmomammowoxmoa‘ocgawbmﬁ

 

X.Wei et al.

 

where w=(x,y) is a vector of weight factors of intensity and m/z value,
respectively, a”, = (04F);1 and )8”. = 08;");1 are weighted intensities and

“iv = (011V ' (20y and ﬁg." 2 (gm . (my (6)

where at = (a,),:1.___.,, and )3 = ([3,),21W" are the intensities of the two
matching mass spectra, respectively, 2,» is the m/z value of the i-th intensity,
i: 1, 2, .. . , n, and X and y are weight factors with (X, y)=(053, 1.3).

To measure the matching quality between two peaks, a mixture
similarity score Cm is deﬁned as follows:

 

Cm(d,»,R,»|w) = w|:l — di ] +(l — w)R,» (7)
dmax
where d,- is the Euclidean distance of z-score transformed retention times
in the 2D chromatogram between the i-th two matched peaks, dmx is the
maximum value of the Euclidean distance between two matched peaks in
all samples, R,» is the spectral similarity between the matched peak pair
and w is a coefﬁcient (0 5 w 5 1).

To perform alignment, MetPP uses a two-step peak alignment
approach, full alignment and partial alignment. The full alignment rec-
ognizes all potential landmark peaks, i.e. peaks generated by the same
metabolite and presented in all samples. During the full alignment, a
reference peak list (P,) is ﬁrst randomly selected from the sample set S.
Each of the remaining peak lists is aligned to P,., respectively. Considering
two peak lists {P,, S,»}, the mass spectrum of each peak in P, is used to
ﬁrst ﬁnd all corresponding peaks in S,- with a mass spectral similarity
R206. It should be noted that 0.6 was empirically chosen based on
our experience and that this threshold can be decided by a user in
MetPP. The peak in S,- with the minimal Euclidian distance to the peak
in P, in the 2D chromatogram is then considered as a possible match
to the peak in P,.. All of these matched peak pairs are considered as
candidates of landmark peaks between {P,, S,»}, and further used to op-
timize the value of weight factor w for calculation of Cm by maximizing

arg max(zl:1 Cm(dia 311W) (8)

where L is the number of peak pairs and w is set as 0.05, 0.1, 0.2, 0.3, 0.4,
0.5, 0.6, 0.7, 08, 0.9 and 0.95, respectively. This process is operated on
all peak list pairs {P,, S,»|i = 1, . . . ,n — 1}, and the optimal weight
factor set {w}, ..., w,,,1} is obtained for {S,»|i = 1, ..., n — 1}. The outlier
values in {Cali 2 1, . . . , n — 1} are further detected at a conﬁdence
level of 95%. All landmark peak candidates are removed if their Cm
values are detected as outliers. The minimum mixture score C1,?“ of the
test peak lists is then used as the threshold value of Cm in the partial
alignment.

After full alignment, the retention time values of remaining peaks in S ,-
are corrected based on the retention time difference of the landmark
peaks between S,- and P,.. Local linear fitting is used to correct retention
time values of metabolites eluted between two adjacent landmark peaks
in the 2D retention time domain, respectively. To correct the ﬁrst dimen-
sional retention time of peaks that do not elute off the GC column
between two landmark peaks, i.e. peaks eluted before the ﬁrst landmark
peak and the peaks eluted later than the last landmark peak, an iterative
optimization method is applied to each of these two sections of peaks,
respectively. In each optimization process, 30% of landmark peaks are
randomly selected and a polynomial model ﬁtting is used to correct the
retention times of peaks in the section of interest. The polynomial ﬁtting
error is computed as follows:

_ "’ 1 o 1}
8 — 21:11 [211' _ 411' (9)

where ltgf j is the original z-score transformed ﬁrst dimensional retention
time of the j—th peak in the i-th sample S,-, ltl‘fj is the fitted retention time
of the j—th peak and k is the number of peaks in S,- at the section of
interest. This process is repeated 1000 times and the model with minimum

ﬁtting error is selected and used for retention time correction. The same
process is performed to correct the second dimensional retention time.

After the retention time correction in S,-, the partial alignment is
performed to align all the non-landmark peaks in S,- to the peaks in P,..
For each peak pair in {P,, S,»}, a mixture score Cm is calculated using
Equation (6). A peak pair is considered as a match if its mixture score
Cm : C321“. If one peak in the test sample is matched to multiple peaks
in P,, or vice versa, the peak pair with the maximum mixture score is kept
and the remaining matches are discarded. If a peak in S,- cannot be
matched to any peaks in P,., this peak is considered as a new peak to
P, and is added to P,.. The updated P, is then used to align peaks in the
next test peak list, and this process is repeated until all test peak lists are
aligned.

2.2.4 Quant mass conversion After peak alignment, an alignment
table is obtained, A = [P1,P2, ...,Pm]T, where P,» = {p,»,1,p,»,2, ...,p,»,,,}
represents all aligned peaks of the i-th compound in S, m is the number
of aligned metabolite peaks, 17,»,1- denotes the peak of the i-th compound
in the j—th sample and n is the number of samples. If the peak list is
generated by ChromaTOF, the peak area of each peak refers to the
peak area of a speciﬁc fragment ion entitled quant mass. The same com-
pound may have different quant mass in each sample. Therefore, it is
critical to ensure that the peak area of each aligned peak is consistent
across samples.

A reference spectrum-based peak area conversion method is developed
in MetPP to convert the values of peak area to be quant mass independ-
ent. For a group of aligned peaks P,», the quant mass with the highest
frequency across all samples is selected as the representative quant mass
q,. The CAS number of the peak P,» with the largest spectral similarity in
the peaks with the same q,- is then used to extract reference mass spectrum
s, from the NISTll mass spectral database. A linear regression process
is applied between s, and each spectrum of the aligned peaks in P,», re-

spectively, to obtain a set of regression coefﬁcients {a,»,1,a,»,2, ...,a,»,,,}.
Each peak area in P,» is then converted into a new value by
0111'
4, = all», (10)

where a,»,1 is the fitting coefﬁcient of the i-th peak in sample S 1, a” is the
ﬁtting coefﬁcient of the peak in S ,~ and I,»,,- is the original peak area of the
i-th compound in S,.

2.2.5 Normalization Six normalization methods are implemented in
MetPP, including quantile normalization, cyclic loess normalization
(Dudoit et al., 2002), contrast-based normalization (Astrand, 2001),
trimmed constant mean normalization, trimmed constant median nor-
malization and group-based quantile normalization (Wei et al., 2011).

Quantile normalization makes the peak area distribution in each
sample the same across all samples. Cyclic loess and contrast-based nor-
malizations are two extensions of the difference in log expression values
versus the average of the log expression values method. Trimmed con-
stant mean and trimmed constant median are two scaling-based normal-
ization methods. Group-based quantile normalization ﬁrst performs
quantile normalization for the samples that belong to the same sample
group, and then uses a trimmed constant mean method to normalize all
samples across the sample groups.

2.2.6 Statistical significance tests Multiple conventional statistical
signiﬁcance test methods are provided in MetPP, including two-tailed
t-test, two-sample Kolmogorov7$mirnov test, KruskaliWallis test and
Wilcoxon rank sum test. To increase the conﬁdence of the statistical
testing, sample permutation is also provided as an option for each
conventional statistical signiﬁcance test. Permutation test, also called
re-randomization test, is a nonparametric test. It ﬁrst randomly ex-
changes sample labels and then performs one of the above mentioned
conventional statistical test methods.

 

1 788

ﬁlO'SIIZIImOprOJXO'SODBILLIOJLIIOICV/idnq

an?kgogmomammowoio~&o:3m7.omm\

 

an?kgogmomammowoio~&o:3m7.omm\

o
4
G
s

V
w
G

 
 

MetPP for analysis of GCXGC-TOF MS data

 

groups. The levels of these free fatty acids are all increased in mice
fed a HFD. This observation agrees with the results of literature—
reported hepatic lipid level test (Tan et al., 2011).

4 DISCUSSION

MetPP uses the peak lists generated by peak deconvolution
software, such as commercial software ChromaTOF, as its
input. It is well known that the ChromaTOF software has
some shortcomings, including multiple peak table entries for
the same compound, limited accuracy in calculation of peak
areas, etc. To minimize these shortcomings of ChromaTOF soft—
ware, MetPP provides options for users to ﬁlter data from the
peak lists generated by ChromaTOF using the peak quality in—
formation (proﬁle purity, purity, concerns) provided by
ChromaTOF. The multiple peak entries of the same compound
are recognized based on user defined 2D retention time variation
windows. These peak entries are then merged and represented by
one representative peak entry. To handle peaks detected in blank
sample(s), MetPP has three options for the user to select from:
no action, deducting the peak area of blank sample(s) from the
biological samples and removing the metabolites. The user can
also remove metabolites using a user—provided exclusion list.
In this study, the default values for peak quality—based ﬁltering
and merging multiple peak entries were used. The analysis of
spike—in data demonstrates that the data preprocessing methods
implemented in MetPP is able to remove some of the shortcom—
ings of ChromaTOF software without affecting identiﬁcation
and quantiﬁcation of the spiked—in standards.

To reduce the rate of false—positive identiﬁcation, the current
version of MetPP provides an option for users to match the ﬁrst—
dimension retention index of each compound with the database
values. A large value of the mean absolute deviation between
the database value and experimental retention index of the
removed metabolites (308 :I:257 i.u. for the spike—in data,
318:I:267 i.u. for the biomarker discovery data) and a small
value of the corresponding values of the preserved metabolites
(28 :I: 12 i.u. for the spike—in data, 21 :I: 16 i.u. for the biomarker
discovery data) demonstrates the mass spectral matching—based
metabolite identiﬁcation can introduced a high rate of false
identification, and the retention index ﬁltering methods in
MetPP can detect and remove some of these false—identiﬁed
metabolites.

MetPP performs peak list alignment using a mixture score
function to simultaneously evaluate the deviation of the 2D
retention time and mass spectral similarity. Compared with the
progressive retention time map searching method implemented in
the distance and spectrum correlation optimization (DISCO)
algorithm (Wang et al., 2010), the mixture score approach is
able to align chromatographic peaks that may have a large vari—
ation in either retention time or mass spectral similarity, as long
as the overall quality of two peak are similar. Supplementary
Figure S7 depicts the alignment results of the spike—in experimen—
tal data by DISCO and MetPP. All 28 spiked—in metabolites were
fully aligned in all 30 samples by MetPP. However, 23 metabolite
standards were fully aligned by DISCO, while the rest of the
spiked—in metabolites were aligned in a portion of the 30 samples.
In terms of metabolite quantiﬁcation, the data analysis

algorithms implemented in MetPP are able to correctly identify
and quantify all spiked—in metabolite standards.

Analysis of biological samples using MetPP revealed that
15 metabolites have significant abundance changes between
two sample groups. The accuracy of clustering samples using
all metabolite data in each sample is 0.82, while the clustering
accuracy is improved to 0.91 when the abundance of the 15 me—
tabolites in each sample are used for clustering. The improve—
ment in sample clustering accuracy demonstrates that MetPP
correctly recognized the metabolites with signiﬁcant abundance
difference between sample groups LFD and HFD. The abun—
dance changes of the free fatty acids agree with the literature
results of hepatic lipid level test, a different analytical method.
These analysis results further demonstrate that the MetPP soft—
ware can be used to recognize the metabolites with signiﬁcant
abundance changes between sample groups.

The performance of MetPP in analysis the spike—in data
was also compared with the existing Guineu software (Castillo
et al., 2011) in terms of accuracy of alignment and relative quan—
tiﬁcation. Supplementary Figure S8 shows that only 9 of the
28 spiked—in metabolites were fully aligned by Guineu, while all
the 28 spiked—in metabolites were fully aligned by MetPP. For
relative quantiﬁcation, MetPP also signiﬁcantly outperforms
Guineu in all three statistical measures of TPR, PPV and their
harmonic mean F1 for analysis of all pairwise comparison
between the ﬁve sample groups (Supplementary Fig. S9).

Analysis of both the spike—in data and biomarker discovery
data demonstrates that the methods implemented in MetPP for
peak filtering and merging are effective in minimizing the short—
comings of ChromaTOF. However, compound 24 (nonanoic
acid) in Figure 2a still has a large variation in peak area after
the peak filtering and merging. For the future development,
accurate peak deconvolution algorithms are needed to improve
the quality of peak lists. A large variation in peak area intro—
duced during peak deconvolution can signiﬁcantly affect the
downstream statistical analysis. It is also important to develop
algorithms for analysis of time course data and construction of
metabolite correlation networks.

5 CONCLUSIONS

A computational platform for analysis of metabolomics data gen—
erated on GCXGC-TOF MS instrumentation was developed in
the form of MetPP using MATLAB. MetPP uses the peak lists
generated by a spectral deconvolution software such as commer—
cial software ChromaTOF as its input and then performs peak
merging and filtering, retention index matching, peak list align—
ment, normalization, statistical signiﬁcance tests and pattern rec—
ognition. Two sets of experimental data acquired on GCXGC—
TOF MS were used to validate the performance of MetPP. The
analysis results demonstrate that MetPP is able to recognize the
concentration difference of the spiked—in metabolite standards be—
tween sample groups. The analysis results of biological samples
agree with the hepatic lipid level test, further demonstrating that
MetPP is able to correctly process the data of complex samples.

ACKNOWLEDGEMENTS

The authors thank Mrs Marion McClain for review of this
manuscript. We thank Drs Mark Merrick, Wei Chen, Peter

 

1791

ﬁm'sIeumoI‘pJOJXO'sopeuuopuorq/ﬁdnq

X.Wei et al.

 

Willis and J ihong Wang at LECO Corporation for their help on
using ChromaTOF software. The authors also thank Dr Mark
Styczynski’s research group at Georgia Institute of Technology
for their suggestions of improving the software.

Funding: This work was supported by National Institute of Health
(NIH) grants lROlGM087735, R21ESO21311, P01AA017103,
R37AA010762 and 1RC2AA019385, and the VA.

Conﬂict of Interest: none declared.

REFERENCES

Almstetter,M.F. et al. (2009) Integrative normalization and comparative analysis
for metabolic ﬁngerprinting by comprehensive two—dimensional gas chromatog—
raphy—time—of—flight aass spectrometry. Anal]. Chem., 81, 573175739.

Astrand,M. (2001) Normalizing oligonucleotide arrays. http://www.stat.berkeley.
edu/~terry/zarray/Affy/GL_Workshop/Astrand_manuscript.pdf (7 October
2011, date last accessed).

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate—a
practical and powerful approach to multiple testing. J. Roy. Stat. Soc. B
Met, 57, 2897300.

Bezdek,J.C. (1981) Pattern Recognition with Fuzzy Objective Function Algorithms.
Plenum Press, New York.

Castillo,S. et al. (2011) Data analysis tool for comprehensive two—dimensional gas
chromatography/time—of—flight mass spectrometry. Anal. Chem., 83, 305873067.

Curran—Everett,D. (2000) Multiple comparisons: philosophies and illustrations.
Am. J. Physiol. Regul. Integr. Comp. Physiol., 279, R17R8.

Dudoit,S. et al. (2002) Statistical methods for identifying differentially expressed
genes in replicated cDNA microarray experiments. Stat. Sinica, 12, 29.

Fraga,C.G. et al. (2001) Objective data alignment and chemometric analysis of
comprehensive two—dimensional separations with run—to—run peak shifting on
both dimensions. Anal. Chem., 73, 583%5840.

Hoggard,J.C. et al. (2009) Toward automated peak resolution in complete GC x
GC—TOFMS chromatograms by PARAFAC. J. Chemometr., 23, 4214131.

Jolliffe,I.T. (2002) Principal Component Analvsis. Springer, New York.

Kim,S. et al. (2011) An optimal peak alignment for comprehensive two—dimensional
gas chromatography mass spectrometry using mixture similarity measure.
Bioinformatics, 27, 166(Fl666.

Kim,S. et al. (2012) A method of ﬁnding optimal weight factors for compound
identiﬁcation in gas chromatography—mass spectrometry. Bioiiy’ormatics, 28,
115871163.

K00,I. et al. (2011) Wavelet— and Fourier—transform—based spectrum similarity
approaches to compound identiﬁcation in gas chromatography/mass spectrom—
etry. Anal. Chem., 83, 563175638.

Kovats,E. (1958) Gas—chromatographische charakterisierung organischer verbin—
dungen. Teil 1: retentionsindices aliphatischer halogenide, alkohole, aldehyde
und ketone. Helv. Chim. Acta., 41, 191?32.

Pierce,K.M. et al. (2005) A comprehensive two—dimensional retention time
alignment algorithm to enhance chemometric analysis of comprehensive
two—dimensional separation data. Anal. Chem., 77, 773577743.

Reichenbach,S.E. et al. (2005) Computer language for identifying chemicals with
comprehensive two—dimensional gas chromatography and mass spectrometry.
J. Chromatogr. A, 1071, 2637269.

Reichenbach,S.E. et al. (2012) Features for non—targeted cross—sample analysis
with comprehensive two—dimensional chromatography. J. Chromatogr. A,
1226, 140148.

Rosipal,R.K.N. (2006) Overiew and recent advances in partial least squares. In:
Subspace, Latent Structure and Feature Selection: Statistical and Optimization
Perspectives Workshop (SLSFS 2005 ). Springer—Verlag, Berlin, Germany,
pp. 34ﬁ51.

Sinha,A.E. et al. (2004) Trilinear chemometric analysis of two—dimensional
comprehensive gas chromatography—time—of—flight mass spectrometry data.
J. Chromatogr. A, 1027, 2697277.

Storey,J.D. (2002) A direct approach to false discovery rates. J. R. Stat. Soc. Series
E Stat. Methodol, 64, 4794198.

Tan,M. et al. (2011) Chronic subhepatotoxic exposure to arsenic enhances hepatic
injury caused by high fat diet in mice. Toxicol Appl. Pharmacol., 257, 350364.

Troyanskaya,O. et al. (2001) Missing value estimation methods for DNA micro—
arrays. Bioiiy’ormatics, 17, 5207525.

van Mispelaar,V.G. et al. (2003) Quantitative analysis of target components by
comprehensive two—dimensional gas chromatography. J. Chromatogr. A, 1019,
15729.

Vivo—Truyols,G. (2012) Bayesian approach for peak detection in two—dimensional
chromatography. Anal. Chem., 84, 262272630.

Wang,B. et al. (2010) DISCO: distance and spectrum correlation optimization
alignment for two—dimensional gas chromatography time—of—flight mass
spectrometry—based metabolomics. Anal. Chem., 82, 506975081.

Wei,X. et al. (2011) MetSign: a computational platform for high—resolution mass
spectrometry—based metabolomics. Anal. Chem., 83, 766877675.

Zhang,D.B. et al. (2008) Two—dimensional correlation optimized warping algorithm
for aligning GCxGC—MS data. Anal. Chem., 80, 266472671.

Zhang,J. et al. (2011) iMatch: a retention index tool for analysis of gas chromatog—
raphy—mass spectrometry data. J. Chromatogr. A, 1218, 6522$530

 

1792

ﬁtospzumoﬁuqxo'sopeuuopuotq/pdnq

