Bioinformatics, 32(13), 2016, 2001—2007

doi: 10.1093/bioinformatics/btw072

Advance Access Publication Date: 28 February 2016
Original Paper

 

Systems biology

Direct calculation of minimal cut sets involving
a specific reaction knock-out

Luis Tobalina, Jon Fey and Francisco J. Planes*

CEIT and Tecnun, University of Navarra, San Sebastian 20018, Spain

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on September 23, 2015; revised on January 10, 2016; accepted on February 2,2016

Abstract

Motivation: The concept of Minimal Cut Sets (MCSs) is used in metabolic network modeling to de—
scribe minimal groups of reactions or genes whose simultaneous deletion eliminates the capability
of the network to perform a specific task. Previous work showed that MCSs where closely related
to Elementary Flux Modes (EFMs) in a particular dual problem, opening up the possibility to use
the tools developed for computing EFMs to compute MCSs. Until recently, however, there existed
no method to compute an EFM with some specific characteristic, meaning that, in the case
of MCSs, the only strategy to obtain them was to enumerate them using, for example, the standard
K—shortest EFMs algorithm.

Results: In this work, we adapt the recently developed theory to compute EFMs satisfying several
constraints to the calculation of MCSs involving a specific reaction knock—out. lmportantly, we em—
phasize that not all the EFMs in the dual problem correspond to real MCSs, and propose a new for—
mulation capable of correctly identifying the MCS wanted. Furthermore, this formulation brings
interesting insights about the relationship between the primal and the dual problem of the MCS
computation.

Availability and implementation: A Matlab—Cplex implementation of the proposed algorithm is
available as a supplementary material.

Contact: fplanes@ceit.es

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

The concept of Minimal Cut Sets was introduced in Klamt and
Gilles (2004) and refined in Klamt (2006). MCSs were defined as a
minimal set of reactions whose removal would render the function-
ing of a given objective reaction impossible. Their relationship
with Elementary Flux Modes and the dualization of the main prob-
lem was mentioned in Klamt (2006) and formally exploited
in Ballerstein et al. (2012). With this theoretical breakthrough; it be-
came possible to calculate MCSs using algorithms designed to calcu-
late EFMs. For example, the K-shortest EFM enumeration
algorithm (de Figueiredo et (11., 2009) was used to enumerate MCSs
in von Kamp and Klamt (2014).

Efficient calculation of EFMs has been an active area of research in
the last years (de Figueiredo et (11., 2009; Kaleta et (11., 2009; von

Kamp and Schuster, 2006; Machado et (11., 2012; Fey and Planes,
2014; Pey et (11., 2015; Rezola et (11., 2011; Quek and Nielsen, 2014;
Terzer and Stelling, 2008; Urbanczik and Wagner, 2005). Most of the
algorithms have focused the attention on calculating as many EFMs as
possible. However; one may only be interested in some EFMs that ful-
fill some constraints. While; in theory; a valid approach would be to
calculate all the EFMs and then filter them according to the desired
criteria; in practice it is currently impossible in large networks; as the
number of EFMs grows exponentially with network size. It is this
question that was addressed in a recent paper by Fey and Planes
(2014); where a Mixed Integer Linear Programming (MILP) formula-
tion was introduced to directly calculate EFMs satisfying a desired set
of constraints. For example; an EFM containing several reactions of
interest can be now directly calculated.

(6) The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journa|s.permissions@oup.com 2001

/310‘srcumo[p10}xo‘sopcuuoiutotq/ﬁdnq

2002

L. Tobalina et al.

 

For the metabolic modeling community, it will be very valuable
to directly calculate MCSs of certain characteristics. For instance, a
MCS involving a specific reaction knock—out can be used to deter—
mine if it is possible to couple growth with the synthesis of a specific
product (Klamt and Mahadevan, 2015). In fact, strain design for the
optimization of chemical production, such as biofuels (Erdrich
et al., 2014), is one of the main applications of MCSs. It is not neces—
sary to solve a MCS problem to know if the production of a chem—
ical is coupled to growth but, in case it is not, a MCS suggests the
modifications necessary to make the coupling a reality. Another pos—
sible application of MCSs in the field of human health involves find—
ing a complementary target to an already druggable reaction. Here,
MCSs would be viewed as synthetic lethals for treating cancer or
other diseases (Folger et al., 2011; Frezza et al., 2011; Kaelin, 2005;
Suthers et al., 2009).

In this work, we adapt the formulation in Pey and Planes (2014) to
achieve this goal. In the process, we stress that not all the EFMs in the
dual problem correspond to correct MCSs of the original network,
which implies that not all the algorithms designed for the calculation of
EFMs can be directly applied to the calculation of MCSs without care—
ful consideration. The modifications made to the algorithm in Pey and
Planes (2014) are mathematically justified and bring interesting insights
between the primal and the dual problem of the MCS computation.

2 Methods

A metabolic network of m metabolites and 11 reactions can be repre—
sented by an m X n stoichiometric matrix S, where each column rep—
resents a reaction with negative coefficients for the educts and
positive coefficients for the products. The activity of the reactions is
represented by the flux vector 1’. Under the steady—state assumption,
the sum of fluxes that produce a compound are equal to the sum of
fluxes that consume it (Eq. (1)). Irreversible reactions can only carry
positive fluxes (Eq. (2)), while reversible reactions can carry negative
and positive fluxes.

3-720 (1)

r, 2 0.Vi E Irrev (2)

We would like to be able to perform a given task, in our case, to
carry flux through a given reaction (usually, this reaction is the bio—
mass reaction).

-rZr* (3)

where t is a vector of all zeros except for a 1 in the position of the re—
action we want to carry flux through and r" is the minimum amount
of flux that such reaction should carry.

We are interested in a minimal group of reactions that, if blocked,
would render this task impossible. To find those, we define the possible
reaction knockout constraints we could impose (Eqs. (4) and (5)).

r, : 0.Vi 6 Rev (4)

r, S 0.Vi E Irrev (5)

Note that for the knock—out of irreversible reactions we only
limit their upper bound (Eq. (5)), as their lower bound is already
zero because of the irreversibility constraint (Eq. (2)).

As done in Ballerstein et al. (2012) and von Kamp and Klamt
(2014), we formulate the dual problem of the infeasible primal prob—
lem defined by the previous constraints (Eqs. (1)—(5)). Note here
that, as we modified the primal system with respect to Ballerstein

et al. (2012) and von Kamp and Klamt (2014), the arising dual sys—
tem presented below is slightly different (see Supplementary
Material 1).

u u
up up
N :[ST I —I —t] :0 (6)
on on
w w
—r*-w£—c (7)
up20.vn20.w20.c>0 (8)
uERm.UpER”.UnER”,wER (9)

This dual problem can be viewed as a new stoichiometric matrix
N with new flux variables 14, up, on and w, with their respective re—
versibility constraints. When these variables take values different
from zero, they indicate that their associated constraints in the pri—
mal problem are active. In particular, 14 variables are related to
steady—state constraints, up variables are related to constraints limit—
ing the upper bound of a reaction, U11 variables refer to constraints
limiting the lower bound of a reaction and to variable is linked
to Eq. (3). An MCS is an EFM in this dual problem that contains
w and has minimal support in up and U11, with the exception of U11
variables related to the irreversibility constraints (Eq. (2)), which do
not count for the minimal support (Ballerstein et al., 2012).

Constraint in Eq. (7) forces to to have a value different from
zero, meaning that its associated constraint (Eq. (3)) must take part
in the solution. This constraint is forcing ﬂux through w, as c is a
positive constant that rules out the trivial solution. If we want a
MCS involving a specific reaction knock—out, we must also force
ﬂux through its related variable.

Recently, Pey and Planes (2014) formulated an optimization
model to directly obtain EFMs fulfilling several biological con—
straints, such as carrying flux through a group of specific reactions.
The key insight was to acknowledge in the problem formulation
that an EFM has a single degree of freedom. When we have an EFM
and the flux through one of its reactions is set, the rest of the fluxes
of that EFM are automatically and univocally determined.

Certainly, if we add one reaction activation constraint to the
steady—state constraint in a network composed of only irreversible
reactions, the extreme points of the feasible region they define coin—
cide with EFMs. In an n—dimensional space, extreme points lie on n
linearly independent and binding constraints. They are mathematic—
ally represented as basic solutions, where variables are divided into
basic and non—basic variables. The value of non—basic variables is set
by their binding constraints (for example, a non—basic variable with
a non—negativity binding constraint will be set to zero). The value of
basic variables results from solving the system of linear equations
that is obtained once the value of non—basic variables has been fixed.

An EFM can always be described with the steady—state con—
straints and flux inactivation constraints for those reactions that are
not part of the EFM, collectively defining n — 1 linearly independent
and binding constraints. Once we add one flux activation constraint
to this system, all the fluxes are fully determined. Hence, if we want
to include a second flux activation constraint and obtain EFMs as
solutions, we need to ensure that the new constraint is redundant
with respect to the binding constraints that describe the EFM.
Redundancy is guaranteed by forcing that this second flux activation
constraint can be written as a linear combination of the rest of the
linearly independent and binding constraints. The tricky part here is

/310'S[EUm0prOJXO'SOIJEIIIJOJIIIOIq/ﬂduq

Direct calculation of minimal cut sets

2003

 

that we do not know a priori which reactions are active in the EFM
and which ones are not. In Pey and Planes (2014), mixed—integer lin—
ear programming was used to select active reactions in the EFM and
properly apply the linear combination requirement.

The direct application of the method described in Pey and Planes
(2014) to our MCS problem would involve considering N as the ini—
tial network, and w and our knock—out related variable up and U11
the reactions we want to activate. Thus, we would make all the vari—
ables irreversible, splitting the u variables into two other irreversible
variables and follow the implementation described in that work (see
Supplementary Material I for the full formulation of the optimiza—
tion problem obtained following this strategy). The solutions pro—
vided by this model constitute Elementary Flux Modes in the
network N. However, not all the EFMs in N correspond to MCSs in
the original network S (Ballerstein et al., 2012) and, more import—
antly, not all the EFMs that contain our two target variables corres—
pond to MCSs in the original network S (see Section 3 for a toy
example illustrating these events).

Following that approach, we obtain solutions that have minimal
support in u, up, U11 and w, but MCSs are defined as solutions with
minimal support in up and U11 variables related to knock—outs of re—
versible reactions, that include w. Hence, MCSs correspond to a
subset of all the possible EFMs. Interestingly, we realize that MCSs
are closer to the concept of Generating Flux Modes (GFMs) than
EFMs. GFMs are elements of a convex basis and have minimal sup—
port with respect to the set of irreversible reactions (Larhlimi and
Bockmayr, 2009; Rezola et al., 2011). In our case, irreversible reac—
tions are up, U11 and w; however, MCSs are minimal with respect to
w, up, and the subset of U11 variables related to knock—outs of revers—
ible reactions. This implies that not all the GFMs of the dual prob—
lem correspond to MCSs of the original network (see Section 3 for a
toy example illustrating this event).

In order to limit the solutions of the dual problem to proper
MCSs, we introduce two main modifications. The first one is to
force the linear combination constraint for all the columns related to
14 variables, regardless of their value being different to zero or not.
This means that we no longer need to split the 14 variables into two
irreversible variables. As a bonus, these variables no longer need
related binary z variables, which are now only associated with up,
U11 and to variables. The second modification consists in treating the
x variables, which represent the coefficients of the linear combin—
ation, as if they were the reaction flux variables of the original prob—
lem and constraining their reversibility accordingly. We present
below the full mathematical model:

minimize Zzpi + 2 Zn,‘ (10)
i iERer/
subjectto:
u u
U VP
N- ‘7 :lsT 1 _1 41. :0 (11)
1/11 on
w w
—r*-w£—c (12)
14
UP
(0 d, d, 0). 2b (13)
U11
to

Z17 VP Z17
51- zn g on gM- zn (14)
zw w zw
zpi+zni S 1,ViEReU (15)
S 0
0
I 0 0' +6 —5
x : p p p (16)
_1 0 dn+en —6n
0+Ew_6w
_tT 7*
1 —zp Ep+6p
M- 1—zn 2 en+6n (17)
1 _Zw 5112+an
UP 6p 5,,
1/11 20. en 20. 5,, 20 (18)
w 6w 6w
xi 2 0.Vi E Irrev (19)
Z17
zn E {0.1} (20)
zw
uERm.UpER".UnER",wER (21)
x e R“1 (22)
6p 6 R",en E R",EER (23)
6,, ER”,6,, ER”,6ER (24)
c > 0.b > 0 (25)

where or and M represent a sufficiently small and large constants, re—
spectively, and dp and d" are vectors of all zeros except for a single 1
in the position related to the knock—out constraint that we want to
activate. If the knock—out we want to enforce involves an irreversible
reaction we will only set a 1 in dp and leave d" as a vector of all
zeros. As in Pey and Planes (2014), variables 51,, en, 5",, 6p, 6,, and 6“,
allow the linear combination constraint (Eq. (16)) to be applied only
to active variables with the help of variables zp, zn and zw and their
linking constraints (Eqs. (14) and (17)). The optimal solution of this
optimization problem corresponds to a MCS that includes our
desired reaction knock—out.

The formulation of the problem can be simplified (see
Supplementary Material 1), but we have written it here in a way that
the similarities and differences with the formulation in Pey and
Planes (2014) are easier to spot, aiming to facilitate the understand—
ing of the model. To that end, we also provide in Supplementary
Material I the resulting mathematical model for a particular toy
example.

The reasons why these modifications work have a mathematical
underpinning that we proceed to explain in the following
paragraphs.

In contrast with Pey and Planes (2014), 14 variables are not split
into two irreversible steps and, therefore, the linear combination

/310'S[EUm0[pJOJXO'SOIJEIIIJOJIIIOIq”Zduq

2004

L. Tobalina et al.

 

(Eq. (16 )) must always apply to them. In particular, since the value 0
is not a bound for 14 variables and they can take any real value, they
should always be considered as basic variables and thus, they must
take part in the linear combination constraint. With this modifica—
tion alone, the algorithm goes from calculating EFMs to obtaining
GFMs satisfying several constraints (see Supplementary Material 1).
However, as noted above, this is not sufficient to obtain MCSs.

The justification for the second modification is somewhat more
difficult to grasp. It has its roots in duality theory and it involves the
correct manipulation of equality constraints in Eq. (11). Dual vari—
ables of equality constraints are always unrestricted sign variables,
but dual variables of inequality constraints are always either non—
negative or non—positive variables. In this context, and because we
do not care about their value in the optimal solution, U11 variables
related to the irreversibility constraints are actually explicit excess
variables in Eq. (11) and, in order to directly obtain MCSs, they can
be removed without altering the solution space, transforming the
equalities where they appear into greater than 01’ equal inequalities
(see Supplementary Material 1). This action has consequences in the
linear combination requirement introduced in Pey and Planes
(2014), here Eq. (16), as now the linear combination coefficient
variables x cannot be of unrestricted sign type by default and must
be non—negative in these inequalities (see Supplementary Material 1).
In fact, those x variables are dual variables of the corresponding
constraints and they must abide by duality theory. Eventually, we
have that the x variables must obey the same irreversibility con—
straints that the 1’ variables of the original problem do.

These modifications have a surprising consequence in the inter—
pretability of the problem. First, x variables can be treated as the
flux variables of the original problem and, second, we are forcing
S-x : 0, which resembles the steady—state constraint of the original
model. This means that the values of the x variables in a valid solu—
tion of our direct MCS problem formulation can be interpreted as a
valid flux distribution in the original network.

Finally, we can iteratively enumerate MCSs fulfilling our condi—
tions by introducing a new constraint that eliminates previously ob—
tained solutions (Figueiredo et al., 2009; von Kamp and Klamt, 2014).

Zzpf‘zpi+ Z znf ‘zmg (Zzpf+ Z  —1, k=1,...,K

iERei/ iEREI/
(26)

3 Results

In this section, we first introduce a toy example where it can be seen
that not every EFM in the dual network corresponds to a MCS in
the primal network (Ballerstein et al., 2012) and check that our
algorithm is capable of correctly identifying MCSs for each reaction.
Then, we apply our algorithm to two networks of different sizes,
namely the E.coli core metabolic network and the iAF1260 E.coli
model, comparing the behaviour of our algorithm with that of the
enumeration approach presented in von Kamp and Klamt (2014).
The model was implemented in Matlab, using CPLEX as the under—
lying optimization software, and can be found in Supplementary
Material 11. The computations were carried out on a 64 bit Intel
Xeon E5—1620 v2 at 2.70 GHz (4 cores) and 16 GB of RAM.

3.1 Toy example

Figure 1 shows a primal toy network and the dual network arising
from its corresponding MCS problem. This network has only one re—
versible reaction (1’2) and we will consider 1’8 as the target reaction.

The network includes an irreversible reaction, 1’9, that is not related
in any way to the target reaction 1’8, hence, there is no MCSs con—
taining 1’9 that blocks the activity of 1’8. However, there exists an
EFM containing the input reaction for node 1’9 in the dual network
(e.g. {11179, 1/175, U115, u3}), but that EFM does not contain our target
related variable w.

Now we draw the attention to 1’5. This reaction participates in a
MCS with 1’2 and 1’4. It is easy to see that the dual network contains
an EFM composed of the inputs to 1’2, 1’4 and 1’6 (147;, 1/174 and 1/175 re—
spectively), the arcs MC, MD and ME and the target w. However, there
is also another EFM that contains the input to node 1’5 (1475) together
with the input to node 1’1 (11171), the output to node 1’5 (U115), the arcs
MA, 14C, 14D and ME and the target w. This EFM would correspond to
a MCS composed of 1’1 and 1’5, which is incorrect because 1’1 is al—
ready a MCS on its own. It turns out that this second EFM involves
less knock—out related dual variables than the former (2 versus 3, be—
cause the output of node 1’5, U115, does not count), which implies that
the direct application of the formulation in Pey and Planes (2014)
to the dual network asking for the shortest EFM containing 111
and the input to 1’5 would obtain this EFM first. This invalidates
the direct use of their formulation for obtaining MCSs involving a
specific reaction knock—out.

However, the new model introduced in this work correctly cap—
tures the MCS, as the incorrect MCS solution is infeasible for it. In
particular, the values of the x variables (corresponding to the coeffi—
cients of the linear combination in Eq. (16)) in the case of the invalid
EFM are all non—negative except for x9, which has a negative value
that our new formulation forbids. We can interpret the values of the x
variables as a flux distribution in the primal network, resulting in reac—
tions 1’5, 1’3, 1’7 and 1’8 carrying ﬂux in the forward direction and reaction
1’9 carrying flux in the backward direction. Obviously, this ﬂux distri—
bution is not a valid one, because 1’9 is irreversible. Our new model
takes this into account and renders this solution infeasible.

Because of the way that MCSs are enumerated using k—shortest
in von Kamp and Klamt (2014), from smallest to largest and taking
into account only variables related to knock—out constraints, EFMs
in the dual network that are not MCSs in the primal network
are avoided. In the case of the network in Figure 1, the EFM corres—
ponding to the MCS that contains only 1’1 is obtained before the in—
valid EFM that contains 1’1 and 1’5. Hence, the solution enumeration
constraint avoids the calculation of the invalid EFM, as it contains
an already calculated MCS, 1’1.

3.2 Application to E.coli core metabolism
Here, we apply our algorithm to the E.coli core network available in
the COBRA Toolbox (Schellenberger et al., 2011). This network
contains 72 metabolites and 95 reactions. We conducted structural
analysis of the reported network, so we did not take into account
possible growth medium constraints (e.g. glucose and oxygen sup—
ply) or compound production requirements (e.g. ATP maintenance).
As with any other MILP, the time needed to find the optimal so—
lution may widely vary depending on the chosen reaction. This dis—
parity in problem difficulty can already be experienced in this simple
network. Taking the biomass reaction as our target for the MCSs,
we calculated one MCS for each reaction. We used the reduced for—
mulation, presented in Supplementary Material 1, which deals with
a lower number of variables than the one introduced in the Methods
section. The median time to obtain a solution was 0.27 s, and only 3
reactions required more than 15 s to reach the optimal solution (the
maximum was 380 5). Note here that, with other values for the
Cplex parameters, we were able to obtain all these MCSs in less

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

Primal Network

Dual Network

\on Kamp and Klamt (2014)

Feist cl al., 2007
Schcllcnbcrgcr cl al., 2010

 

\on Kamp and Klamt (2014)

Figure 2

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

(2014)

til. J
Number .

 

Ballcrstcin cl al., 2012

\ on Kamp and Klamt. 2014

PC} and Planes

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

Direct calculation of minimal cut sets

2007

 

Klamt,S. and Gilles,E.D. (2004) Minimal cut sets in biochemical reaction net-
works. Bioinformatics, 20, 226—234.

Klamt,S. and Mahadevan,R. (2015) On the feasibility of growth-coupled
product synthesis in microbial strains. Metab. Eng, 30, 166—178.

Larhlimi,A. and Bockmayr,A. (2009) A new constraint-based description of
the steady-state ﬂux cone of metabolic networks. Discrete Appl. Math,
157, 225 7—2266.

Machado,D. et al. (2012) Random sampling of elementary flux modes in
large-scale metabolic networks. Biomformatics, 28, i515—i521.

Pey,]. et al. (2015) TreeEFM: calculating elementary flux modes using linear
optimization in a tree-based algorithm. Biomformatics, 31, 897—904.

Pey,]. and Planes,F.]. (2014) Direct calculation of elementary ﬂux modes sat-
isfying several biological constraints in genome-scale metabolic networks.
Biomformatics, 30, 2197—2203.

Quek,L.E. and Nielsen,L.K. (2014) A depth-ﬁrst search algorithm to compute
elementary flux modes by linear programming. BMC Syst. 3101., 8, 94.

Rezola,A. et al. (2011) Exploring metabolic pathways in genome-scale net-
works Via generating flux modes. Biomformatics, 27, 534—540.

Schellenberger,]. et al. (2010) BiGG: a Biochemical Genetic and Genomic
knowledgebase of large scale metabolic reconstructions. BMC Bioinﬁ, 11,
213.

Schellenberger,]. et al. (2011) Quantitative prediction of cellular metabolism
with constraint-based models: the COBRA Toolbox V2.0. Nat. Protocols, 6,
1290—1307.

Suthers,P.F. et al. (2009) Genome-scale gene/reaction essentiality and syn—
thetic lethality analysis. Mol. Syst. 3101., 5, 301.

Terzer,M. and Stelling,]. (2008) Large-scale computation of elementary flux
modes with bit pattern trees. Biomformatics, 24, 2229—2235.

Urbanczik,R. and Wagner,C. (2005) An improved algorithm for stoichiomet-
ric network analysis: theory and applications. Biomformatics, 21,
1203—1210.

/310'S[BHmO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

