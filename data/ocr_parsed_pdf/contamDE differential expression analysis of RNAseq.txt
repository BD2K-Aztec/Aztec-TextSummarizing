Bioinformatics, 32(5), 2016, 705—712

doi: 10.1093/bioinformatics/btv657

Advance Access Publication Date: 9 November 2015
Original Paper

 

 

Gene expression

contamDE: differential expression analysis of
RNA-seq data for contaminated tumor samples

Oi Shen1, Jiyuan Hu1, Ning Jiang1, Xiaohua Hu1, Zewei Luo2
and Hong Zhang1'*

1State Key Laboratory of Genetic Engineering and Institute of Biostatistics, School of Life Sciences, Fudan
University, Shanghai 200433, People's Republic of China and 2School of Biosciences, University of Birmingham,
Birmingham 815 2TT, UK

*To whom correspondence should be addressed.
Associate Editor: lnanc Birol

Received on June 11, 2015; revised on September 20, 2015; accepted on November 3, 2015

Abstract

Motivation: Accurate detection of differentially expressed genes between tumor and normal sam—
ples is a primary approach of cancer—related biomarker identification. Due to the infiltration of
tumor surrounding normal cells, the expression data derived from tumor samples would always
be contaminated with normal cells. Ignoring such cellular contamination would deflate the power
of detecting DE genes and further confound the biological interpretation of the analysis results. For
the time being, there does not exists any differential expression analysis approach for RNA—seq
data in literature that can properly account for the contamination of tumor samples.

Results: Without appealing to any extra information, we develop a new method 'contamDE’ based
on a novel statistical model that associates RNA—seq expression levels with cell types. It is demon—
strated through simulation studies that contamDE could be much more powerful than the existing
methods that ignore the contamination. In the application to two cancer studies, contamDE
uniquely found several potential therapy and prognostic biomarkers of prostate cancer and non—
small cell lung cancer.

Availability and implementation: An R package contamDE is freely available at http://homepage.
fudan.edu.cn/zhangh/softwares/.

Contact: zhanghfd@fudan.edu.cn

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 IntrOducuon versus the cell proportion variation if the cellular contamination is

The primary goal of the ordinary differential expression (DE) analysis ignored (Kuhn et (11., 2011). Ignoring the cellular contamination could

methods is to distinguish biological variation between various condi— also greatly lower the power of DE analysis (Shen—Orr et (11., 2010;
tions from technical effects and random noises (Anders and Huber, Zhao and Simon, 2010). Several experimental methods aiming at dis—
2010; Robinson and Smyth, 2007; Robinson et (11., 2010; Zhou et (11., secting multiple distinct cell types have been developed to eliminate
2011). Since the clinical tumor samples obtained from patients are the effects caused by contamination, such as laser capture micro—
usually infiltrated with surrounding normal cells (de Ridder et (11., dissection and cell sorting. However, these methods are expensive,
2005; Liotta and Petricoin, 2000; Meyerson et (11., 2010; Palmer time consuming and may introduce new confounders (Okaty et (11.,
et (11., 2006), the traditional DE analysis cannot distinguish the expres— 2011). Computational approaches addressing the contamination issue
sion variability resulting from the shifts in cell specific expression could avoid such problems thus are much desired.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 705

9103 ‘Og JSanV 110 seleﬁuv soc] ‘BtHJOJtIBQ 30 AJtSJQAtuf] 112 ﬁle'smumofqutxo"sotJBuiJOJutotq/ﬁduq 11101} popcolumoq

706

QShen et aI.

 

The following linear equation is commonly used to model the
microarray expressions of contaminated tumor cells (Shen—Orr
et (11., 2010):

Tszc+(1—W)TN+E, (1)

where T, Tc and TN represent the expression profile of the contami—
nated tumor cells obtained by experiments and those of the underly—
ing tumor component and normal component, respectively, to is the
pure tumor cell proportion in each contaminated tumor sample
shared by all genes, while 6 is the random error.

RNA—seq data are inherently different from microarray data,
and there is very limited work in literature focusing on the contam—
ination issue for RNA—seq data, with a couple of exceptions (Gong
and Szustakowski, 2013; Li and Xie, 2013). Li and Xie (2013) used
an online expectation—maximization algorithm to quantify the ex—
pression levels of purified tumor transcripts in a probabilistic fash—
ion for better understanding the abundance of the tumor transcripts.
Gong and Szustakowski (2013) developed a quadratic programming
method to obtain sub—cell proportions by utilizing significantly dif—
ferentially expressed genes of homogeneous samples as a prior.

The above methods are subject to several limitations if they are
used in DE analysis. First, it is hard to account for the variability of
the purified expression profiles in the downstream DE analysis.
Second, requiring extra information in the above methods greatly
limits their applicability, since the extra information is expensive to
obtain in practice. Third, additional bias could be introduced if the
extra information is not accurate.

To our best knowledge, there is no statistical method in literature
that can properly account for the contamination of tumor samples in
DE analysis using RNA—seq data, and we aim to fill this gap. In this
article, we propose a new method ‘contamDE’, which is based on a
novel statistical model for associating gene expression profiles and
cell types. Based on this model, a rigorous and efficient statistical
method is developed for DE analysis using RNA—seq data from conta—
minated tumor samples and normal samples. In contamDE, the nor—
malized proportions of tumor cells in contaminated tumor samples
are estimated, and DE analysis can be consequently carried out.

The new method contamDE has several unique features. First,
contamDE does not require any extra information that might be ex—
pensive to obtain in practice; second, the developed algorithm is
computationally efficient; third, contamDE provides a unified pro—
cedure for DE analysis, which avoids the necessity of accounting for
the variability of purified expression profiles required in the existing
methods.

The rest of this article is organized as follows. The technical de—
tails of the new method contamDE are described in Section 2. Some
simulation studies and five real data applications are provided in
Section 3 and Section 4, respectively, to demonstrate the advantage
of contamDE over the existing methods. Some concluding remarks
and future research topics are presented in Section 5.

2 Methods

In this section, we describe the proposed method contamDE. We
begin with the situation with a single tumor cell type, then extend the
developed method to the situation with multiple tumor cell types.

2.1 Statistical models

First, we consider the situation where the normal samples and the
tumor samples are unmatched. Suppose the read counts of G genes
are obtained from Io normal cell samples and I tumor cell samples,

respectively. Let N,-,- be the number of the RNA—seq reads mapped to
the jth gene (/ : 1, . . . , G) for the ith normal cell sample
(1' : 1,2, . . . ,Io); C,,- the number of the RNA—seq reads mapped to
the jth (/ : 1, . . . , G) gene for the 1th (1' : 1,2, . . . ,1) pure tumor cell
sample. In order to distinguish the systematic expression difference
between various conditions by controlling the biological and tech—
nical variations, it is often advantageous to use the two—parameter
negative binomial distribution to model the read counts generated
from RNA—seq experiments (Anders and Huber, 2010; Cameron
and Trivedi, 2013; Robinson and Smyth, 2007; Robinson et (11.,
2010). We assume that N,,- and C,,- follow negative binomial distribu—
tions NB(K,-ul-, (1),.) and NB(K;u;-, (1),), respectively. Here NB(u, (1)) de—
notes the negative binomial distribution with mean u and dispersion
parameter (1), whose variance is u + old); K,- and  are size factors ac—
counting for library size effects, which can be estimated using any
existing methods, e.g. the median normalization (Anders and
Huber, 2010) and the quantile normalization (Bullard et (11., 2010).
We use the median normalization because it is quite robust to out—
liers and simple to implement. Let 5,- : u;- — u,- be the mean expres—
sion difference between tumors and normals. We are interested in
identifying those genes with DE profiles between tumor and normal
samples, i.e. those [’5 with 5,- : 0.

In practice, the obtained tumor samples usually consist of both
tumor cells and normal cells due to cellular contamination. Suppose
that the ith contaminated tumor cell sample consists of a proportion
of w,- tumor cells and a proportion of 1 — w,- normal cells. Let T,,- be
the number of reads mapped to the jth gene of the ith contaminated
tumor cell sample, which is equal to C2,- + N17, where C2,- and N),-
are the numbers of reads from pure cancer cells and pure normal
cells, respectively. It is reasonable to assume that C2,- and NE,- fol—
low negative binomial distributions NB(K;-(1 — wimi, (1),.) and
NB(K;-w,-(ui + 5,), (12,-), respectively, where w,- and 1 — w,- are used to
adjust the effects of cell proportions and  is a size factor, so that u,-
and u,- + 5,- are adjusted means. The expectation of T,,- is therefore
Ki-(ul- + 1016,"), but the distribution of Ti,- would be rather complicated
since N2,- and C2,- are correlated with each other. For the simplifica—
tion purpose, we assume the following model:

N17 ~ NB(Ki.“/v <l>,-) and T27 N NEW-(M,- + M507 <1>,-)- (2)

Here NB(K;-(ul- + wiéi),  is different from (1 — w,)NB(K;-uI-, ¢>i)+
wiNB(K;-(ui + 5,), (12,-). The later distribution could be used to model
the summation of two independent random variables. However, the
independence assumption is violated in the current situation. It is
unclear which of these two distributions fits Ti,- better, so we use the
former one because the corresponding estimation procedure is
simpler.

Next, we consider the situation where each tumor sample is
matched with a normal sample. The read counts Ni,- and T,,- are
matched if both tumor cell sample and normal cell sample are ob—
tained from the same cancer patient, and their correlation should be
accounted for. Actually, in a real prostate cancer study, we observed
an evident positive correlation between the read counts from tumor
sample and matched normal sample (Supplementary Material Fig.
S1). Therefore, we use a fix effect to characterize such correlation.
That is, we assume that N,,- and Ti,- follow the negative binomial dis—
tributions with a common dispersion parameter (1),- and means Kip,-
e‘x'i and  — new, + “Jim,- + 5,-)}e°"7, respectively:

Nil- ~ NB(K,-ul-e°“l,  and T,,- N NB(K;-(ul- + wﬁﬂea‘l,  (3)

The correlation between N,-,- and T,,- is characterized by the shared
fix effect mi,- as in McCarthy et al. (2012).

9103 ‘Og JSanV 110 sejeﬁuv soc] ‘Btulomcg 30 AJtSJQAtuf] 112 /310'slcu1n0fp103x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIII/lAOG

contamDE

707

 

In both unmatched—sample model (2) and matched—sample
model (3), the mean expression for a contaminated tumor cell sam—
ple follows a semi—additive pattern. In the absence of contamin—
ation (i.e. W1:"':w1), the two models reduce to the log—
additive models commonly used in literature (Anders et (11., 2013).
The semi—additive models (2) and (3) greatly facilitate the
estimation of the proportions L0,, as will be shown in the next
subsection.

Note that the proportions w,- are identifiable up to a scale param—
eter. We normalize the proportions such that their mean value is 1:

142%- : 1. (4)

Let the true proportions and mean expression differences be wig and
5,-0, respectively, then the values of w,- and 5,- satisfying constraint (4)
are equal to

I l
—ul’zo and 5,- : I‘1  “405/07 (5)

_ 1:1
I 12%
i:1

Wi:

respectively. As a result, for any 1 Si 3 G, the null hypothesis of
interest H,- : 5,-0 : 0 is equivalent to H,- : 5,- : 0. We have the follow—
ing proposition:

Proposition. Under constraint (4), the unknown parameters {#1, . . . ,
#051, . . . ,5G, (1)1, . . . , ¢>G,w1, . . . ,wl} are identifiable in model (2)

and{.ulv'“7MG7517---75G7¢17'--7¢G7w17-“7w17u117-H7MIG}are
identifiable in model(3).

The proposition immediately follows from the fact that two dis—
tributions are the same implies that they have the same first two
moments. The normal samples and the tumor samples have
non—negative mean expression profiles, so u,- and 5,- should satisfy
the following additional constraints:

uiZOandui+wir5i20foriz1,...,I. (6)

In the presence of contamination, the true proportions are smaller
than 1. Therefore, the normalized proportion w,- given in (5) would
be greater than wig, and some of them could be greater than 1.
Similarly, the absolute value of 5,- is smaller than that of 5,0.
Therefore, under constraint (4), the tumor—versus—normal fold
change defined by

FCI' : (Si/‘11]- + 1 

is shrunk toward 1, compared with the true fold change. This is a
tradeoff of not using extra information. The extent of shrinkage is
decreasing in the magnitude of wig. In particular, FC,- is equal to the
true fold change in the absence of contamination (i.e.
wioZH'Zwlozl).

Note that the likelihood ratio test we will use does not depend
on the form of linear constraint since the likelihood function is in—
variant to the linear constraint.

2.2 Normalized proportion estimation

In this subsection, based on models (2) and (3), we construct appro—
priate estimators of w,- subject to constraint (4) in the matched sam—
ple situation and the unmatched sample situation, respectively,
without appealing to extra information. In what follows, we pro—
pose an initial estimator of M, then update it in an iterative manner.
The initial estimator could be much closer to the true one compared

with the naive initial estimator (e.g. 1), which effectively save com—
putational time, as confirmed in our simulation studies.

First, we consider the matched sample situation. In what follows,
we construct an initial estimator of w,- and update the estimator
based on a likelihood method.

Under model (3), the means of Ki—lNii and (Kg—1%,- are Wear? and
(u,- + wiéi)e°“i, respectively. Therefore, we can use the following mo—
ment est1mat1ng equatlon:

Z  :WiZ m
['60] i ‘ ['69]
Here (21 is a set of DE genes (‘working gene set’ hereafter) used to
remove the impact of non—DE genes since they are not informative
in estimating w,- and can introduce a tremendous noise. We can in—
clude either up—regulated genes or down—regulated genes, but it is
not appropriate to include both types of genes as the information for
estimating w,- would be greatly obscured by doing so.

If 27-691 (SI-ea"? is free of i, then it will not appear in the normalized
w,- estimator derived from (8). This motivates an initial estimator of

w,- given by
12(37/“2 — Nii/Kz’)
£351) 2 11691 . (9)
Z Ear/K:- — Nii/Kz')
i:1 ['69]
Obviously, (L331), . . . jig”) satisfy constraint (4). In practice, we can

choose the working gene set 91 using any DE analysis tool such as
edgeR by ignoring the contamination of the tumor samples.
Specifically, we select those genes with DE analysis P—values smaller
than a small threshold value (say 10—3) and a negatively estimated
log—fold change. Such a gene set results in virtually sound proportion
estimators in both simulation studies and real data applications. We
will give more details for obtaining such P—values in the next section.
Now we update the proportion estimators. Fixing w,- at “95-1) for
i : 1, . . . ,I, we can obtain the pseudo—maximum likelihood estimators
([170), 57(1), 02%.), . . . ,  of (Mi, 5,, M1,, . . . , or”) using an algorithm
described in the next subsection. Using the P—values of DE analysis
based on the pseudo likelihood ratio tests described in the next subsec—
tion, an updated working gene set (22 can be obtained based on the
previous criterion (DE analysis P—value < 10—3 and log—fold
change < 0). More accurate estimators of w,- can be iteratively given by

ZITii/Kl — Nii/Ki}

 

I ~ ' . z '
will” 2 [wt Wlthw, = —lenkl (10)
A [:7 41H)
2w H::é%%
i’:1 i:1 1'er

for k : 2, 3, . . . The iteration can be stopped if maxiluAJE-Hl) — 131(k)) < e
for some small 6. Denote by dig”) the converged estimator of L0,.
Next, we consider the unmatched sample situation. Under model

(2), we have the estimating equation

T,- 1 ’0 N,-
Z(7—EZ;’> nth-25,- (11)

[691 i i:1 [691

for some working gene set 91. This motivates proportion estimators

lo
12(Tii/Kl — 10—1ZNii/Ki)
1

M : —i69k i: (12>
1 I 10
Z 2(Tii/Kl — 10—1ZNii/Ki)
i:1 jag, i:1

9103 ‘Og JSanV 110 sejeﬁuv soc] ‘Btulomcg 30 AJtSJQAtuf] 112 /310'slcu1n0fp103x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIII/lAOG

708

QShen et aI.

 

for k : 1, 2, . . . where (21,92, . . . can be constructed similarly to the
matched sample situation. Note that only the working gene set is
updated in 101(k) (k : 2,3,. ..) since 27-695,- is free of i.

2.3 DE analysis procedure

In this subsection, we give an outline for estimating unknown par—
ameters ((1),, 11,-, 5,) and mi 2: (011,-, . . . ,oqi), /' : 1, . . . , G, which is fol—
lowed by a DE gene detection procedure. Note that 011 needs to be
estimated only in the matched sample situation. The detailed algo—
rithm for estimating unknown parameters are given in
Supplementary Material Methods.

First, we estimate the dispersion parameters (1),- and select a
working gene set 91. Since (1),- are nuisance parameters, for simplicity
and other parsimonious reasons, we use an empirical Bayes strategy
(McCarthy et (11., 2012) to estimate the dispersion parameters (1),- by
ignoring the contamination of the tumor samples. Let (1),- denote the
resulting estimator of (1),. DE analysis is then carried out using the
likelihood ratio test, which results in a P—value for each gene. A
working gene set 91 can then be selected (P—value < 10—3 and log—
fold change < 0).

Next, we estimate 11,-, 5,- and 0:1 with (1),- fixed at (1),- and
w 2: (W1,...,w1) fixed at w(k):(1il(1k),...,ﬂl)k))for k 2 1,2,...,
by maximizing a log—pseudo likelihood function. Denote by

(12,“). SE“) and (12,“). S)”. ,1
matched sample situation and matched sample situation, respect—
ively. Denote by (117(k), 0) and (117(k),0,&I(-k)) the corresponding
pseudo—MLEs under the null hypothesis H,- : 5,- : 0.

The fold change (7) can be estimated by

(k)) the resulting pseudo—MLEs in the un—

A k
FC/U) : 5f. Vii/(k) + 1. (13)

The pseudo—likelihood ratio test statistics for testing null
hypotheses H,-:5,-:0 can be constructed immediately. The
asymptotic null distributions of the test statistics are the chi—
square distribution on 1 degree of freedom, so the P—values for
testing  : 5,- : 0 easily follow. The algorithm for estimating all
parameters is outlined in a ﬂowchart (Supplementary Material
Fig. S2).

2.4 Multiple tumor cell types

Some cancers have multiple tumor cell types. For example, some
cancers have multiple subtypes (e.g. the main primary types of lung
cancer include small—cell lung carcinoma and non—small—cell lung
carcinoma), and some cancers undergo several stages with various
tumor cell types. In Supplementary Material Methods, we describe a
model and an outline of estimation and testing procedure for mul—
tiple tumor cell types.

2.5 Existing methods

DeMix (Ahn et (11., 2013) and UNDO (Wang et (11., 2015) are two
methods designed for the deconvolution of array—based data without
using extra information. Our preliminary numerical study indicated
DeMix might not be applicable to RNA—seq data, so we only con—
sidered UNDO in the following numerical studies. We also con—
sidered a couple of benchmark DE analysis methods, which ignored
the contamination of tumor samples and had been implemented in
the R Bioconductor packages edgeR and DESeq2, respectively.
Refer to Supplementary Material Methods for the descriptions of
DeMix, UNDO, edgeR and DESeq2.

3 Simulation studies

We conducted simulations to evaluate the performance of
contamDE. The data generation procedure and the corresponding
simulation results in a two—condition situation (one tumor cell type
plus one normal cell type) are described in the next three subsec—
tions. Some simulation results for multi—condition situation (two
tumor cell types plus normal cell type) are reported in
Supplementary Material Results and Supplementary Material
Figures S3—S5.

3.1 Data generation

We generated genewise read counts (G : 10, 000) for six pure nor—
mal samples and six contaminated tumor samples. In the unmatched
sample situation, the read counts Ni,- and C,,- for pure normal and
tumor samples were generated from NB(K,-11,-, (1),.) and
NB(K;-(11i + 5,-)), respectively; in the matched sample situation, the
read counts Ni,- and C,,- for pure normal and tumor samples were
generated from NB(K,-u,-e°“i,¢>I-) and NB(K;-(u,- + 5,-)e“‘ir’,¢>I-), respect—
ively. In both situations, the read count T,,- for contaminated tumor
sample was Lia-Ci,- + (1 — w,)N,’-I-, where Nig- ~ NB(K,-11,-, (1),.) in the un—
matched sample situation and N,-,-’ N NB(K;-u,-e°“i , (1),) in the matched
sample situation, and N,,-, NE,- and C,,- were independent of each
other. To evaluate the performance of UNDO, we considered two

scenarios, one used (N T,,-) as in contamDE; the other used

117
(Ni-WE"). The proportions 10,- were either homogeneous (i.e.
W10 : - -- : W60 : 0.5) or heterogeneous (i.e. wig : i/6). The de—
scription of the other parameters are given in Supplementary
Material Methods. For each parameter combination, 100 datasets

were generated.

3.2 Proportion estimation results
A (1) “9(2) A goo)

We evaluated three 10,- estimators, namely 10,- , and 11/
described in the previous section. To obtain 1195-”), we used the con—
(k+1) _

i

pose, we rescaled the w,- estimators by 3.5/6 in the heterogeneous

vergence criterion maxilw 101(k)) < 10—4. For comparison pur—
proportion situation and 0.5 in the homogeneous proportion situ—
ation, respectively.

In the heterogeneous proportion situation (i.e. wig : i / 6 for
i : 1, . . . , 6), the boxplots of the proportion estimates for 100 simu—
lated datasets are depicted in Figure 1 and Supplementary Material
Figure S6. The initial estimator 1195-1) was much closer to the true one
than the naive initial estimator 1, so using 1195-1) could effectively save
computational time as claimed in Section 2.2. For example, in the
unmatched sample situation, the average number of iterations with
initial estimator 119(1) was around 2.7, and that with naive initial esti—
mator 1 was 3.9. As shown in Supplementary Material Figure S7,

the w,- estimation results did not depend on initial ‘working gene
(

set’. Furthermore, 119,2) and 1195-00) were very close to each other, and
their biases were much smaller than those of 1195-1). For example, in
the unmatched sample situation, the mean square error rates of
1195-1)’; 1199’s and 1195-”)3 were 1.0 X 10—3, 0.7 X 10—3 and

0.7 X 10—3, respectively. Therefore, we propose to use 1195-2)

instead
of 1195-00) for the sake of saving computational time. The saved num—
ber of iteration was particularly considerable in the matched sample
situation, with an average value being 7.4.

UNDO performed well only when the two samples used for de—
convolution were perfectly matched (i.e. N2,- and Ti,- were used),
while its proportion estimates were very close to 1 when N,,- and Ti,-
were used. Noted that the perfect matching scenario was very un—
realistic since N :7- cannot be obtained in practice.

9103 ‘01; JSanV 110 se1e§uv soc] ‘BIIIJOJIIBD 10 [(1151910qu 112 /310's112u1n0[p101x0'sopBHJJOJutotq/ﬁduq 11101} pep1201um0q

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

contamDE 709
A B
O to
—' . a .. m
. : -  I w E. _  _— .0.
- I T r T s ‘ m E § 1"?— .3..&..
‘° - + i ‘ iiav T 3 $2 . “a;; Es ea» 
° 1 i ‘ E ' __ __ —- —- 3 ‘-
3 5
3
(D S “I ’ '—  _
id ‘ -
i T T ,, Unmatahud Malthod Unmatched new
u + E}! 3
V: - ‘- J- ‘- Q’ .1. I“ .. I" .L Q’ '1.
° ' ..  .. r“ .- c  1‘
S 53*, féoeg 13‘ 1‘ «99% 4931353 9‘ Y «9‘3" Egg,  f)  \i" r
- UNDO1
g ' 39;; : 3,3113% gr Fig. 3. False positive rates (A) and true positive rates (B) for detecting DE
E F F ' genes in the simulation study with two conditions and heterogenous propor-
' viii“) tions (nominal level: 0.05)
. . . . . .
1 2 3 4 5 6

Sample ID

Fig. 1. Estimated proportions for contaminated tumor samples in the simula-
tion study with two conditions and heterogeneous proportions (unmatched
samples). UNDO1 used (Nij, T,-,-) and UND02 used (N’I-j, T,-,-)

 

 

 

 

 

 

 

A 3 — B
'9 _
u a o
E E
n:
.5 =' ' . 3
’3 ’ E
n. " _ -' a.
s " m
I: N — TRUE 3
1:: ‘ contamDE
edgeR
g _. - DEScuz

 

 

 

 

 

False Positive Rate

Fuse PDEIIWE Rala

Fig. 2. ROC curves for detecting DE genes in the simulation study with two
conditions and heterogenous proportions. (A) Unmatched samples; (B)
matched samples

In the homogeneous proportion situation (i.e. wig : 0.5),
contamDE was quite unbiased (Supplementary Material Fig. S8),
while UNDO produced similar results as above (results not shown).

3.3 DE analysis results

In contamDE, we used 1195-2) according to the previous simulation re—
sults. For comparison purpose, we also included a version of
contamDE using true proportions (TRUE). The ability of DE ana—
lysis of TRUE, contamDE, edgeR and DESeq2 were evaluated
through receive operating characteristic (ROC) curves, false positive
rates (FPRs), true positive rates (TPRs) and false discovery rates
(FDRs). We begin with the heterogeneous proportion situation.

For each of 100 simulated datasets, the DE analysis P—values of
the DE genes (either up—regulated or down—regulated) and equally
expressed genes were used to produce ROC curves. In the heterogen—
eity proportion situation, the average ROC curves based on 100
simulated datasets are displayed in Figure 2. Overall, TRUE and
contamDE performed quite comparably, and they distinctly outper—
formed edgeR and DESeq2.

Next, we present the FPRs and TPRs (nominal level: 0.05 ) in
Figure 3. Among the four methods, TRUE and contamDE had
slightly lower FPRs and they performed comparably with each
other. Also, TRUE and contamDE were more powerful than edgeR
and DESeq2, with power gains varying from 0.08 to 0.13. Overall,
TRUE and contamDE performed comparably, and they outper—
formed edgeR and DESeq2 in terms of ROC curves and TPRs. This
demonstrates that including extra accurate information on propor—
tions has little power improvement in DE analysis.

Finally, we compare the FDRs of the four methods. Among top
N (N : 200,400,. . . ,2000) genes with smallest DE analysis P—val—
ues, the average empirical FDRs for detecting DE genes based on
100 simulated datasets are reported in Supplementary Material
Figure S9. Evidently, TRUE and contamDE had much lower FDRs
than edgeR and DESeq2. For each dataset, using the R function
‘p.adjust’, we also calculated the FDR—adjusted P—values (Benjamini
and Hochberg, 1995), then obtained the empirical FDRs at various
nominal levels. The average empirical FDRs are again reported in
Supplementary Material Figure S9. TRUE and contamDE had much
better control of FDRs than edgeR and DESeq, i.e, the empirical
FDRs of TRUE and contamDE were much closer to the nominal
levels.

On the other hand, the four methods performed comparably in
the homogeneous proportion situation (Supplementary Material
Figs S10—S12).

4 Real data applications

Five publicly available datasets were used to evaluate the perform—
ance of contamDE. The first one had both RNA—seq data and
whole—exome sequence data. The second one had experimental mix—
tures and the third one had numerical mixtures. These three studies
were mainly used to verify the performance of proportion estima—
tion. The forth and fifth ones were used to evaluate the DE analysis
performance. In these studies, a gene was claimed to be differentially
expressed if the DE P—value after Bonferroni correction was smaller
than 0.05.

4.1 Proportion estimation performance

First, a non—small cell lung cancer (NSCLC) study (Ju et (11., 2012)
with both RNA—seq data and whole—exome sequence (WES) data
were used to validate the proportion estimation performance. In this
study, RNAs of tumor tissue from each of 165 NSCLC patients
were sequenced on an Illumina Hiseq 2000 platform. WES data for
the tumor tissues were available for two patients. We downloaded
the RNA—seq data and the corresponding WES data for these two
patients, and the RNA—seq data for three randomly selected normal
samples (NCBI website http://www.ncbi.nlm.nih.gov, accession IDs:
PRJEB3132). After some data processing, we obtained the RNA—seq
read counts of 12 382 genes for each of the five samples
(Supplementary Material Results). The DNA—seq reads from the
WES data were aligned to human reference genome hg19 (UCSC re—
lease) using Bowtie2 (Langmead and Salzberg, 2012), and a java
based SNP caller ‘Virmid’ (Kim et (11., 2013) designed for matched
samples was used to identify contamination levels for these two sam—
ples, which could serve as golden standards. By (5), the true

9103 ‘01; JSanV uo so1e§uv soc] ‘BIIIJOJIIBD JO [(1151910qu 112 /310's112u1n0[p101x0"sothJJOJutotq/ﬁduq 11101} pep1201umoq

710

QShen et al.

 

proportions wio’s can be estimated by contamDE with some add—
itional information (e.g. the average proportion). In detail, we esti—
mated the mean proportion (i.e. (W10 + wzo)/2) of the two samples
using Virmid, then rescaled the normalized proportions estimated
by contamDE to obtain the estimates of 100,-. As shown in Figure 4A,
the resultant estimates by Virmid and contamDE were quite close to
each other, which well verified the validity of contamDE. On
the other hand, the proportion estimates produced by UNDO were
close to 1, which coincided with UNDO1 for the simulation data
(Fig.1).

Next, we applied contamDE to experimental mixtures of two
lung adenocarcinoma cell lines (i.e. NCI—H1975 and HCC827) (Liu
et al., 2015). In this experimental mixture study, the sequence data
were obtained for three NCI—H1975 samples, three HCC827 sam—
ples, and three biological replications of mixtrue samples at three
mixture levels (NCI—H1975 versus HCC827 ratios were 1:3, 1:1 and
3:1, respectively). Therefore, the true proportions of NCI—H1975 in
the three mixture samples were 0.25, 0.5, 0.75, respectively. We
downloaded the summarized read count data for all the 15 samples
from http://www.ncbi.nlm.nih.gov/geo (accession ID:GSE64098).
The read counts for 23 669 genes were obtained. Using the pure
samples of NCI—H1975 and HCC827, the proportions estimated by
contamDE and UNDO were very both closed to 1 (Fig. 4B). We se—
lected 12 combinations, each combination consisted of three pure
samples and three matched mixture samples (Supplementary
Materials Table S1). Since the average proportion of the mixture
samples in each combination was 0.5, we rescaled the normalized
proportion estimates of contamDE by multiplying 0.5. The mean
square errors of the estimated proportions were 0.007 and 0.21 for
contamDE and UNDO, respectively (Fig. 4C), showing that
contamDE had a much higher precision than UNDO. Altogether,
contamDE identified 4797 DE genes, compared with 4767 and
4087 by edgeR and DESeq2, respectively (Supplementary Material
Fig. S13A). Since there was no ground truth, we treated the 3914
genes identified by all of the three methods as ‘true’ DE genes as sug—
gested by Zhang et al. (2014). Overall, contamDE obtained many

 

 

 

 

 

 

 

A B

‘- - O o o o o  —
In no. _ n ,,, ‘— — v .............. no .............. "v
I: o c
g V "E In. _
E g ‘ V V § 0
Q Z a g _
E ‘- — E
“‘ ° «I V. _
.E g 0
W N E
L” ' — u.I N

° I Virmid d —

o UNDO o UNDO
a _ v contamDE o _ v contamDE

 

 

 

I I I I I I I I
1 2 3 4 5 1 2 3

Sample ID Sample ID

 

 

n

I

I

U
2
I

 

Estimated proportions
0.25 0.50 0.75
I I I
+-_--
+-—-+
Estimated proportions
O 0 2 0 4 0 6 0 8 1
I I I I I
a
0
(D4

- - UNDO o UNDO

. contamDE _ v contamDE

I I I I I I
1 2 3 1 2 3

 

 

 

 

 

 

 

Sample ID Sample ID

Fig. 4. Estimated proportions for contaminated tumor samples in real data ap-
plications. (A) A NSCLC study with both DNA-seq and RNA-seq data; (B) a
study of lung adenocarcinoma cell lines (pure samples); (C) a study of lung
adenocarcinoma cell lines (experimental mixture samples); (D) a Drosophila
melanogasterstudy

more ‘true’ DE genes than edgeR and DESeq2 (Supplementary
Material Fig. S14).

Finally, we applied contamDE to a Drosophila melanogaster
study (Brooks et al., 2011). We downloaded the read count data
summarized by Anders et al. (2013). In this study, there were seven
RNA—seq samples of Drosophila melanogaster S2 cells, of which
three samples were treated with siRNA targeting the splicing factor
pasilla (CG1844) (referred to as cell type ‘A’) and four samples
were untreated (referred to as cell type ‘B’). The read counts for
7196 genes were obtained. As shown in Figure 4D, the estimated
wi’s of contamDE were very close to 1. Since the original type ‘A’
cell samples were pure, the true proportions should be 1. These
proportion estimates again demonstrated a pretty good perform—
ance of contamDE. The numbers of DE genes identified by
contamDE, edgeR and DESeq2 were 187, 188 and 265, respect—
ively (Supplementary Material Fig. S13B). The number of DE
genes identified by both contamDE and edgeR was 184, showing a
pretty high concordance between the results of contamDE and
edgeR. Again, we treated the 169 genes identified by all the three
methods as ‘true’ DE genes, and used artificial counts for contami—
nated tumor samples to validate the performance of the considered
methods through the identified ‘true’ DE genes (Supplementary
Material Results). With artificial count data, contamDE was found
to be more accurate than UNDO in estimating contamination pro—
portions, and contamDE identified many more ‘true’ DE
genes than edgeR and DESeq2 (Supplementary Material Figs S15
and S16).

4.2 DE analysis performance

The prostate cancer data were downloaded from the EMBL—EBI
website http://www.ebi.ac.uk/ (accession ID: E—MTAB—567). In this
study, a prostate cancer cell sample and adjacent normal cell sample
were provided by each of 14 patients from Shanghai Changhai
Hospital (Ren et al., 2012). After some data preprocessing, we ob—
tained read counts for 12 698 genes (Supplementary Material
Results).

Using contamDE, the maximal w,- estimate was 1.38 while the
minimal one was 0.54, revealing an impressive heterogeneity of pro—
portions across the contaminated tumor samples (Supplementary
Material Fig. S17A). To verify the proportion estimation accuracy
and the DE analysis power of contamDE, we adopted the same
strategy used in Drosophila melanogaster study to generate artificial
read counts for contaminated tumor samples, refer to
Supplementary Material Results for details. Again, the proportion
estimates were accurate enough and contamDE was more powerful
than edgeR and DESeq2 (Supplementary Material Fig. S1 8).

The proposed method contamDE identified most DE genes, with
a number of 1031, compared with 948 and 1022 by edgeR and
DESeq2, respectively. Altogether, 810 genes were commonly identi—
fied by all the three methods, while 85 uniquely by contamDE, 15
uniquely by edgeR and 129 uniquely by DESeq2. See Supplementary
Material Figure S17B for more details.

We further investigated the identified DE genes through database
mining and functional analysis. Several genes uniquely identified by
contamDE were found to be closely related to prostate cancers, i.e.
PDLIM4 and RASLI 1A were explored to be candidate biomarkers
for prostate cancers. The uniquely identified GO terms enriched by
contamDE were associated with gene functions of epithelial cell de—
velopment, membrane and cellular proliferation that played import—
ant roles in tumor progression. Refer to Supplementary Results for
more information.

9103 05 JSanV uo so1e§uv soc] ‘BIIIJOJIIBD JO [(1151910qu 112 /310's112u1n0[p101x0"sotJIzulJOJutotq/ﬁduq 11101} pepBo1u/IA0Q

contamDE

711

 

In our NSCLC study, six NSCLC patients from Shanghai
Changhai Hospital provided tumor samples and adjacent normal
samples. The RNA samples were extracted and sequenced using
Illumina Hiseq 2000 platform. Refer to Zhang et al. (2015) for de—
tails of this study. After the same data preprocessing as the prostate
cancer study, we obtained the read counts for 13 312 genes for each
of the 12 samples.

The normalized proportions w,- for tumor cell samples estimated
by contamDE (Supplementary Material Fig. S19A) ranged from
0.57 to 1.47, indicating a considerable heterogeneity of proportions.
As in the prostate cancer study, artificial read counts were generated
to examine the accuracy of proportion estimates and DE detection
power of contamDE, refer to Supplementary Material Results for
detailed description. Again, contamDE was shown to be more
powerful than edgeR and DESeq2 in detecting DE genes
(Supplementary Material Fig. S20).

The numbers of the DE genes detected by contamDE, edgeR
and DESeq2, respectively, are shown in Supplementary Material
Figure S19B. Again, contamDE identified most DE genes, with a
number of 477, compared with 454 and 405 by edgeR and
DESeq2, respectively. Altogether 307 genes were commonly identi—
fied by all the three methods, while 75 uniquely by contamDE, 23
uniquely by edgeR and 53 uniquely by DESeq2. In these 75 genes,
three were demonstrated in literature to be potential therapeutic
drug targets in vivo for NSCLC. Moreover, three GO terms
uniquely detected by contamDE were related to the gene functions
of cytoskeletal part, cell—substrate junction and cytoskeleton,
which had close relationship to tumor cell migration and invasion
in non—small cell lung carcinomas. Refer to Supplementary
Material Results for more information.

5 Discussion

In this article, we present a rigorous and efficient DE detection
method contamDE using RNA—seq data from contaminated tumor
samples, where the tumor samples could be either matched or un—
matched with normal samples. Unlike most existing methods,
contamDE does not require extra information. The normalized pro—
portions reﬂect relative contamination intensities of the contami—
nated tumor samples, and the true proportions can be estimated if
some pathology information or DNA sample is available. The pro—
posed normalized proportion estimator was evaluated through both
simulation studies and experimental/numerical mixture data.
Through both simulation studies and real data applications, UNDO
(an existing deconvolution algorithm originally designed for array—
based data without using additional information) performed well
only when the samples were pure (Fig. 4B and D) or the two samples
used for deconvolution were perfectly matched (UND02 in Fig. 1).
In more practical situations, UNDO either greatly overestimated the
proportions (UNDO1 in Figs 1 and 4A) or had a much larger vari—
ance than contamDE (Fig. 4C).

In the presence of contamination, contamDE were shown
through simulations to greatly outperformed the benchmarks edgeR
and DESeq2 that ignored the contamination in terms of both powers
and false discovery rates; in the absence of contamination,
contamDE performed comparably with edgeR and DESeq2. In the
application to a prostate cancer study and a lung cancer study,
contamDE returned more biologically meaningful DE genes that
were closely related to cancers, compared with edgeR and DESeq2.

An R package implementing contamDE can be downloaded
from http://homepage.fudan.edu.cn/zhangh/softwares/, which can
be used to estimate the normalized contamination proportions of

contaminated tumor samples, to conduct pseudo—likelihood ratio
tests for detecting DE genes between tumor samples and normal
samples, and to estimate fold changes. Using a desktop computer
with a 3.20 GHz CPU, it took contamDE no more than 10 minutes
to analyze all considered real datasets, revealing that the computa—
tional burden of contamDE was quite acceptable.

Acknowledgements

We are grateful to three anonymous reviewers for their insightful comments.

Funding

This work was supported by the State Key Development Program for Basic
Research of China (grant number 2012CB316505) and the National Natural
Science Foundation of China (grant number 11371101).

Conﬂict of Interest: none declared.

References

Ahn,J. et al. (2013) DeMix: deconvolution for mixed cancer transcriptomes
using raw measured data. Bioinformatics, 29, 1865—1871.

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence
count data. Genome Biol., 11, R106.

Anders,S. et al. (2013) Count—based differential expression analysis of RNA
sequencing data using r and bioconductor. Nat. Protoc., 8, 1765—1786.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. I. R. Stat. Soc. Ser. B,
5 7, 289—300.

Brooks,A.N. et al. (2011) Conservation of an RNA regulatory map between
drosophila and mammals. Genome Res., 21, 193—202.

Bullard,J.H. et al. (2010) Evaluation of statistical methods for normalization
and differential expression in mRNA-Seq experiments. BMC
Bioinformatics, 1 1, 94, doi:10.1186/1471-2105-11-94.

Cameron,A.C. and Trivedi,P. (2013) Regression Analysis of Count Data. Vol.
53. Cambridge University Press, New York.

de Ridder,D. et al. (2005) Purity for clarity: the need for puriﬁcation of tumor
cells in DNA microarray studies. Leukemia, 19, 618—627.

Gong,T. and Szustakowski,J.D. (2013) DeconRNASeq: a statistical frame-
work for deconvolution of heterogeneous tissue samples based on mRNA-
Seq data. Bioinformatics, 29, 1083—1085.

Ju,Y.S. et al. (2012) A transforming KIF5B and RET gene fusion in lung
adenocarcinoma revealed from whole—genome and transcriptome sequenc-
ing. Genome Res., 22, 436—445.

Kim,S. et al. (2013) Virmid: accurate detection of somatic mutations with sam-
ple impurity inference. Genome Biol., 14, R90.

Kuhn,A. et al. (2011) Population—speciﬁc expression analysis (PSEA) reveals
molecular changes in diseased brain. Nat. Methods, 8, 945—947.

Langmead,B. and Salzberg,S.L. (2012) Fast gapped—read alignment with
Bowtie 2. Nat. Methods, 9, 357—359.

Li,Y. and Xie,X. (2013) A mixture model for expression deconvolution from
RNA—seq in heterogeneous tissues. BMC Bioinformatics, 14, 511.

Liotta,L. and Petricoin,E. (2000) Molecular proﬁling of human cancer. Nat.
Rev. Genet., 1, 48—56.

Liu,R. et al. (2015) Why weight? Modelling sample and observational level
variability improves power in RNA—seq analyses. Nucleic Acids Res.,
gkv412.

McCarthy,D. et al. (2012) Differential expression analysis of multifactor
RNA—Seq experiments with respect to biological variation. Nucleic Acids
Res., 40, 4288—4297.

Meyerson,M. et al. (2010) Advances in understanding cancer genomes
through second-generation sequencing. Nat. Rev. Genet., 11, 685—6 96.

Okaty,B.W. et al. (2011) A quantitative comparison of cell-type—speciﬁc
microarray gene expression proﬁling methods in the mouse brain. PLoS
One, 6, e16493.

9103 05 JSanV uo se1e§uv soc] ‘BIIIJOJIIBD JO 10151911111 {1 112 /310's112u1n0[p101x0"sotJBuiJOJutotq/ﬁduq 11101} pepBo1u/IA0Q

712

QShen et al.

 

Palmer,C. et al. (2006) Cell-type speciﬁc gene expression proﬁles of leukocytes
in human peripheral blood. BMC Genomics, 7, 115.

Ren,S. et al. (2012) RNA—seq analysis of prostate cancer in the Chinese
population identiﬁes recurrent gene fusions, cancer—associated long
noncoding RNAs and aberrant alternative splicings. Cell Res., 22,
806—821.

Robinson,M.D. and Smyth,G.K. (2007) Moderated statistical tests for assess-
ing differences in tag abundance. Bioinformatics, 23, 2881—2887.

Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for differential
expression analysis of digital gene expression data. Bioinformatics, 26,
139—140.

Shen-Orr,S.S. et al. (2010) Cell type—speciﬁc gene expression differences in
complex tissues. Nat. Methods, 7, 287—289.

Wang,N. et al. (2015) UNDO: a Bioconductor R package for unsupervised de—
convolution of mixed gene expressions in tumor samples. Bioinformatics,
31, 137—139.

Zhang,H. et al. (2015) PLNseq: a multivariate poisson lognormal distribution
for high—throughput matched rna—sequencing read count data. Stat. Med.,
34,1577—1589.

Zhang,Z.H. et al. (2014) A Comparative Study of Techniques for Differential
Expression Analysis on RNA—Seq Data. PLoS ONE, 9: e103207.
doi:10.1371/journal.pone.0103207.

Zhao,Y. and Simon,R. (2010) Gene expression deconvolution in clinical sam-
ples. Genome Med., 2, 93—93.

Zhou,Y.-H. et al. (2011) A powerful and ﬂexible approach to the analysis of
RNA sequence count data. Bioinformatics, 27, 2672—2678.

9103 05 JSanV uo se1e§uv soc] ‘BIIIJOJIIBD JO 10151911111 {1 112 /310's112u1n0[p101x0"sotJBuiJOJutotq/ﬁduq 11101} pepBo1u/IA0Q

