ORIGINAL PAPER

Vol. 30 no. 5 2014, pages 606—613
doi:10. 1 093/bioinformatics/btt5 77

 

Genome analysis

Advance Access publication October 11, 2013

GllRA—RNA—Seq driven gene finding incorporating

ambiguous reads

Franziska Zickmann, Martin S. Lindner and Bernhard Y. Renard*
Research Group Bioinformatics (NG4), Robert Koch-Institute, Nordufer 20, 13353 Berlin, Germany

Associate Editor: John Hancock

 

ABSTRACT

Motivation: The reliable identification of genes is a major challenge
in genome research, as further analysis depends on the correctness
of this initial step. With high-throughput RNA-Seq data reflecting
currently expressed genes, a particularly meaningful source of infor-
mation has become commonly available for gene finding. However,
practical application in automated gene identiﬁcation is still not the
standard case. A particular challenge in including RNA-Seq data is
the difficult handling of ambiguously mapped reads.

Results: We present GIIRA (Gene Identification Incorporating RNA-
Seq data and Ambiguous reads), a novel prokaryotic and eukaryotic
gene finder that is exclusively based on a RNA-Seq mapping and
inherently includes ambiguously mapped reads. GIIRA extracts
candidate regions supported by a sufficient number of mappings
and reassigns ambiguous reads to their most likely origin using a
maximum-flow approach. This avoids the exclusion of genes that
are predominantly supported by ambiguous mappings. Evaluation
on simulated and real data and comparison with existing methods
incorporating RNA-Seq information highlight the accuracy of GIIRA
in identifying the expressed genes.

Availability and implementation: GIIRA is implemented in Java and
is available from https://sourceforge.net/projects/giiral.

Contact: renardB@rki.de

Supplementary Information: Supplementary data are available
at Bioinformatics online.

Received on July 8, 2013; revised on September 26, 2013; accepted
on September 27, 2013

1 INTRODUCTION

The reliable annotation of genes as the regions encoding the basis
for all processes in the cell is a key goal of genomic research.
Hence, numerous studies focus on revealing the structure of
genes and their controlling mechanisms to enhance the under-
standing of the functionality of proteins and their interactions
(Schrimpe-Rutledge et al., 2012; Wang et al., 2012; Wijaya et al.,
2013). Following the need for accurate gene prediction methods,
various gene ﬁnders have been developed identifying genes either
by genome sequence comparison, ab initio by using the genomic
sequence alone, evidence based by integrating different kinds of
additional external information (Goodswen et al., 2012).

Ab initio gene ﬁnders predict genes based on the presence
of open reading frames (ORFs) in the genome and in case of
eukaryotes identify intron-exon structures indicated by known

 

*To whom correspondence should be addressed.

splice sites (Delcher et al., 2007; Korf, 2004; Lukashin and
Borodovsky, 1998; Majoros et al., 2004). Typically, these
approaches are based on statistical or machine learning tech-
niques such as Hidden Markov Models, and they require train-
ing data to evaluate the probability for each gene and gene
structure (Goodswen et al., 2012).

In contrast to ab initio methods, evidence-based and compara-
tive gene finders make use of additional external information to
identify genes and their structures. Sources of information in-
clude EST libraries, messenger RNA or protein sequences. The
external evidence is compared with the genome of interest to
identify regions showing similarity to the given sequences
(Allen and Salzberg, 2005; Savidor et al., 2006; Wei and Brent,
2006). Hybrid approaches, such as AUGUSTUS (Stanke et al.,
2006), combine ab initio gene prediction with evidence from other
sources to verify the predicted genes. For an overview on gene
finding algorithms, the reader is referred to Goodswen et a].
(2012) or Guigo et al. (2006).

Despite all efforts, gene identiﬁcation still faces significant chal-
lenges handling complex gene structures, rare splice sites or mu-
tations in genes (Ederveen et al., 2013; Goodswen et al., 2012).
These problems can be approached by using the knowledge avail-
able from high-throughput RNA-Seq experiments (Wang et al.,
2009). The transcriptome reflects the genes expressed in the
current condition of the cell, which provides valuable information
to identify novel genes or to conﬁrm predicted genes. Although
RNA-Seq experiments were included in several annotation stu-
dies (Martin et al., 2010; Palmieri et al., 2012; Pickrell et al., 2012;
Sultan et al., 2008; Tu et al., 2012), so far only few gene finders
directly incorporate RNA-Seq in gene prediction.

Methods for gene expression analysis such as iReckon
(Mezlini et al., 2013), Cufﬁinks (Trapnell et al., 2010) and
Erange (Mortazavi et al., 2008) perform a transcript assembly
on RNA-Seq reads and thereby allow the identiﬁcation of exons
and splice sites, but they do not predict reading frames and start
and stop codon for genes. For an overview of transcriptome
annotation, the reader is referred to Garber et a]. (2011).
AUGUSTUS allows the integration of RNA-Seq experiments
as an additional external source for eukaryotic gene identifica-
tion (Stanke et al., 2008), whereas GeneMark (Besemer et al.,
2001; Martin et al., 2010) incorporates RNA-Seq evidence on
prokaryotic gene predictions to identify operons. The gene
finder G-Mo.R-Se (Denoeud et al., 2008) predicts gene models
based on RNA-Seq reads, but does not identify mono-exonic
genes and only incorporates non-ambiguous mappings.

Because for instance repetitive or highly similar regions,
or homologous genes lead to a substantial part of non-unique

 

606 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sotJButJOJutotq/ﬁduq 11101} papcolumoq

9103 ‘Og isanV uo ::

GIIRA

 

mappings, discarding ambiguously mapped reads from further
analysis may result in a signiﬁcant loss of prediction accuracy.

To use the complete information contained in RNA-Seq
experiments for gene identiﬁcation, we developed a RNA-Seq-
based de novo gene predictor called GIIRA (Gene Identiﬁcation
Incorporating RNA-Seq and Ambiguous reads) that works on a
reference genome and reads derived in a RNA-Seq experiment.
GIIRA is primarily focused on prokaryotic gene prediction and
in particular resolves genes within the continuously expressed
region of an operon. However, GIIRA can also be applied to
predict genes and alternative transcripts for eukaryotes, and it
leverages information from spliced reads for intron identiﬁca-
tion. Hence, it is also a useful addition to annotation pipelines,
such as MAKER (Holt and Yandell, 2011), or a good comple-
ment to other eukaryotic gene ﬁnders. The identiﬁed transcripts
are completed into gene models Via a search for start and stop
codons as well as reading frame and strand prediction. Based on
the observed mapping coverage, GIIRA identiﬁes candidate
genes that are reﬁned in further validating steps. Ambiguous
reads are reassigned to their most likely origins using a
maximum-ﬂow approach formulated as a linear program.

In contrast to other approaches to ambiguous read assign-
ment, such as the expectation maximization-based strategy intro-
duced in Chung et a]. (2011) or ContextMap (Bonfert et al.,
2012), our approach can integrate information on the likelihood
of a read alignment not only from a fixed context (interval
of speciﬁed length) or a context solely based on the mapping.
Instead, we directly incorporate the information gained in the
process of identifying gene candidates and further the linear
program ensures a convergence to an optimal solution.

In principle, the general idea of the maximum-ﬂow approach
can also be applied to other questions related to ambiguity
resolving.

We validate the accuracy of GIIRA in three simulations and
compare our approach with the widely used method Cufﬁinks as
well as the gene finders GeneMark, GLIMMER3 (Delcher et al.,
2007) and AUGUSTUS. Finally, we apply GIIRA to two real
datasets including ~11 million reads from an Escherichia coli
and ~6 million reads from a Saccharomyces cerevisiae RNA-
Seq experiment.

2 METHODS

As depicted in Figure 1, the proposed algorithm consists of four steps.
The input of GIIRA is a set of RNA-Seq reads that are aligned to a
reference genome using an external alignment method (Fig. 1A). Based
on the alignment, GIIRA identiﬁes regions on the genome that are likely
to be expressed genes, in the following called gene candidates (Fig. 1B).

The identiﬁcation regards the nucleotide coverage as well as splicing
events indicated by the RNA-Seq reads. For prokaryotes, these candi-
dates are regarded as expressed regions that might contain more than one
gene, hence they are reﬁned to determine the correct gene structure.
Finally, ambiguously mapped reads are reallocated to their most likely
origins using a maximum-ﬂow optimization approach (Fig. 1C). Based
on this reassignment, the candidate genes undergo a reﬁnement leading to
the erasing of candidate genes and isoforms without a sufficient number
of remaining supporting reads (Fig. 1D).

2.1 Alignment analysis

GIIRA is based on an alignment of reads from a RNA-Seq experiment to
the DNA sequence of interest. For eukaryotes it is advisableialthough
not strictly necessaryito use a split read mapper for this alignment to
obtain support for splicing events. GIIRA is preoonﬁgured to call either
TopHat2 (Kim et al., 2013) or BWA (Li and Durbin, 2009) for read
mapping, but can include the results of any read mapper with output
in SAM format (Li et al., 2009). GIIRA takes all mappings reported in
the resulting SAM ﬁle into account, which includes one mapping for
unique reads and several for ambiguous reads. For performance reasons,
we only store the start positions of reads and their differences to the
reference, as well as read quality and potential splice sites.

2.2 Candidate search

2.2.] Extraction As illustrated in Figure 1B, regions with sufﬁcient
support of mapped reads are extracted to serve as candidate genes.
The algorithm traverses all start positions of read alignments and tests
if the coverage at these positions exceeds a minimum coverage. If this
is the case, a new candidate gene is opened and all following reads are
assigned to the currently open region. This process is continued until the
coverage falls below the coverage threshold. Then the current candidate
gene is closed and we search for a new region exceeding the minimum
coverage. As the coverage threshold is a crucial parameter in the analysis,
it can either be estimated from the given data without any a priori know-
ledge or be deﬁned by the user.

In case of splicing events, this basic procedure is extended: A splice site
is only considered as a non-erroneous site if it has a sufficient support of
reads. By default the threshold for splice site acceptance is set equal to the
overall desired minimum coverage. In case reads overlap an accepted
splice site, they are assigned to their corresponding isoform, e.g. an
intron starting at this splice position or an ongoing exon. During this
ﬁrst candidate extraction all isoforms with sufﬁcient support by reads are
taken into account, the reﬁnement and exclusion of erroneous alternative
isoforms are performed in subsequent steps (see Section 2.4).

Details on the candidate search and the choice of coverage thresholds
are given in the Supplementary Material.

2.2.2 Prokaryotic gene structuring Prokaryotic candidates undergo
an additional extraction step, as prokaryotic operons contain a continu-
ously expressed region including one or more genes that have to be
identiﬁed respecting the present ORFs. To determine the most likely

 

 

 

   

Extraction

   

Maximum-Flow REfinement

 
 

 

 

 

Fig. 1. Workﬂow of GIIRA: given a genomic sequence and a set of RNA-Seq reads, reads are mapped to the reference (A) and the resulting alignment is
then analyzed by GIIRA. Candidate genes are extracted (B) and ambiguous reads are reassigned using a maximum-ﬂow optimization (C). Finally,

candidate genes are evaluated based on the reallocated reads (D)

 

607

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

F.Zickmann et al.

 

gene structure, ﬁrst all forward and reverse ORFs of the candidate
sequence are extracted. Second, the direction is selected that provides a
set of ORFs that covers a large number of bases in this operon while
restricting the overall number of ORFs. To achieve a trade-off between
these two goals, we adopt and alter a scoring metric from alignment
evaluations (Vingron and Waterman, 1994).

The set of all possible ORFs in a candidate sequence with length L is
denoted as 0. An ORF o,- e O contributes with its length l,- to the number
of covered bases; hence it is assigned a positive (‘match’) score m,- = 1,-. If
two or more ORFs o,- and of overlap, the overlapping region is assigned a
negative score ov,-,~ such that no region is counted twice. To avoid the
suboptimal solution of simply selecting all ORFs present in O, we enforce
sparsity by introducing an ORF open penalty [7,- for each ORF 0,:

I7: — [i [i ,

with [max denoting the length of the longest ORF included in O.
This penalty is smaller for longer ORFs, as these are preferable to
short ones because they cover more bases. Further, [7,- reﬂects whether
0,- is comparably short or long in relation with the ORFs present in O.
This can be combined in a linear program that maximizes the sum of

all scores:
max Z (mi +170 + Z ovij,
iEO i¢j

 

Details on the scoring metric and the linear program are given in the
Supplementary Material.

2.3 Maximum-F 10w optimization

In previous steps, all read mappings contributed equally to the extraction
of candidate regions, even if a read had multiple mappings with similar
quality.

However, as each read can only arise from one genomic locus, we aim
at reassigning ambiguously mapped reads to their most likely origin. To
do so, we use a maximum-ﬂow representation depending on the gathered
information of extracted gene candidates.

The rationale behind this approach is that if several genes compete for
the same read, their overall read coverage and the presence of support
from unique reads indicate the most likely origin of this read. Both
factors do not only enhance the probability for a candidate to be
chosen, but also decrease the chances of the competitors such that the
number and quality of the competitors directly affect the choice for
the best origin. Further, also the ambiguity of the read itself is taken
into account by weighting the inﬂuence of reads on candidate quality
by the number of their alignment positions. The more alignments a
read has, the less it supports each single gene it is mapped to.

The problem of assigning each read to exactly one gene candidate can
be formulated as a network problem as illustrated in Figure 2. We deﬁne
a network G = {N, E} with edge set E and node set N = R U CU s U t
with nodes r e R representing reads and nodes c e C representing gene
candidates, respectively. Source node s and target node t are deﬁned
for technical reasons. Further, all edges are directed and an edge
eij e E between two nodes represents that read r,- e R is assigned to
gene cf 6 C. Note that each edge has a capacity, which can be understood
as the maximal input that can pass through this edge. In contrast, nodes
have an unlimited throughput.

The aim of the maximum-ﬂow is to set all capacities (pil- (belonging to
edges e,-,~ connecting a read r,- to a candidate c,) in a way that the ﬂow
passing from source to target node is maximized:

max E (pij,

CUEE

 

 

Fig. 2. Simpliﬁed example for a maximum-ﬂow network representation
passing ﬂow from source node s to target node t. The source node is
connected to the nodes representing reads (r,-), which are connected with
all genes they were mapped to (c,). The edge labels indicate the capacity
for the throughput that is allowed to be passed from one node to the
other (representing the support of the read to the corresponding candi-
date gene)

Each edge originating from the source has an unlimited capacity. The
capacity (pil- of the edges connecting reads and their possible correspond-
ing genes is restricted by the following condition:

0 S (Pij S yij,
where yij e {0, 1} are the binary variables that denote whether the read r,-
is assigned to gene cf (11,-!- = 1) or not (yij = 0). In other words, ifa read is
assigned to a gene, the corresponding edge connecting both nodes has
a capacity with a maximal value of 1. If the read is not assigned, the
capacity is zero.

In addition, we require all multiple reads to be assigned to exactly one
candidate, as reﬂected in the constraint 2]. yij = 1. Each gene has a max-
imal number of reads that can be assigned, depending on the support of
reads for this gene and the support for its competitors. Because for each
node the input ﬂow has to equal the output ﬂow, this maximum is given
by the capacity cc) of the edges connecting gene nodes to the target node:

E (Pij S wj,

ileUEE
where wj is calculated as follows:

_ bj

_ Z ’71”: ’

L'kEP/

“’1'

Here, 1)) is the average base coverage of gene c) derived by all its mapping
reads, where in contrast by is the coverage derived only by reads that map
uniquely to the corresponding gene. The set P) contains all genes that
directly compete with cj for ambiguously mapped reads, or in other
words, that share reads with gene cj. For illustration, refer to Figure 2:
here P2 consists of Cl and C3, whereas P1 only includes cz because C] only
shares reads with Q.

Allowing genes to inﬂuence their competitors with the help of their
own likeliness ensures that genes with an overall high coverage are pre-
ferred over genes with less coverage. Otherwise genes with no or only few
unique reads could be preferred over genes with a high unique coverage,
as long as they have enough multiple hits.

The maximum-ﬂow problem is formulated as an integer linear pro-
gram including the constraints described earlier in the text. This program
is solved using the IBM CPLEX academic version V12.4 (CPLEX, 2011)
or, as a slower alternative, the open-source GLPK solver (GLPK, 2006).

2.4 Candidate reﬁnement and scoring

The maximum-ﬂow optimization identiﬁes a unique position for each
read such that the previously extracted gene candidates have to be reﬁned
according to the new assignment of reads. If a gene candidate or an
alternative isoform lost all of its supporting reads, it is regarded as an

 

608

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap201umoq

9103 ‘0g isanV uo ::

GIIRA

 

artifact of ambiguous read mappings and is thus erased. All remaining
genes are evaluated in a scoring process according to their exon length ~,
their read coverage and the quality of their assigned reads. It is also of
relevance whether the corresponding reads are mapped ambiguously, as
ambiguity implies more uncertainty for the gene and thus leads to a
smaller score. The ﬁnal gene score sj for gene c) is calculated as follows:
Y 1 1i ‘ (It

. j — — ‘ —,
If Hen-6E M i

where (1,- denotes the quality of read, r,-, 1,- its length and M,- its total
number of mappings. GIIRA reports the identiﬁed genes and transcripts
in GTF annotation format, including additional information on coverage
and ambiguous read support. This allows an easy post-processing to verify
genes for follow-up analyses (refer to the Supplementary Material for
details).

3 EXPERIMENTAL SETUP

To evaluate GIIRA with regard to prediction accuracy and to
compare it with existing methods given a known ground truth,
we use a variety of different datasets to avoid any design bias
toward a speciﬁc organism. We generated a prokaryotic simu-
lated dataset based on E.coli (NCBI-Accession: NC_000913.2)
and two eukaryotic simulations based on chromosome 15 of the
human genome (NC_000015.9) and chromosome 4 of
S.cerevisiae (NC_001136.10), respectively. Based on these data,
we compare GIIRA with Cufﬂinks, GLIMMER3 and
GeneMark in the prokaryotic simulation and to Cufﬂinks and
AUGUSTUS in the eukaryotic simulations.

As GeneMark is originally an ab initio gene predictor that
does not include RNA-Seq information, we used the framework
proposed in Martin et a]. (2010) that combines GeneMarkS
(Besemer et al., 2001) ab initio predictions with the program
ParseRnaSeq to include RNA-Seq evidence (refer to the
Supplementary Material for details on the applied pipeline).
Note that in this framework the resulting predictions cover
operons rather than structural genes.

Further, to demonstrate the inﬂuence of ambiguous mappings
on the prediction accuracy, we conﬁgured and compared a
second version of GIIRA that excludes ambiguous mappings
from further analysis.

The simulation setup uses the read simulator Mason
(Holtgrewe, 2010) applied to the NCBI reference annotation
for each organism of interest. In this annotation the coding
sequence of each known isoform appears as a consecutive
sequence; hence, the simulated reads show similar characteristics
as real RNA-Seq reads because they cover alternative isoforms,
span introns (if existing in the dataset) and show a coverage
proﬁle typical for gene expression. The simulated reads were
aligned to the reference genome using TopHat2 (Kim et al.,
2013), and the resulting alignment served as the starting point
for all compared methods.

To demonstrate the performance of GIIRA on a real prokary-
otic dataset, we applied GIIRA, Cufﬂinks, GLIMMER3 and
GeneMark to a mapping of 11 million reads (NCBI-Accession:
SRX180743) from E.coli. This dataset contains a large propor-
tion of ambiguous mappings as well as high coverages in the
areas coding for ribosomal RNA, posing a challenge to distin-
guish false from correct gene loci. As GIIRA is also applicable to
eukaryotic organisms, a proof of principle application to a real

S.cerevisiae dataset comprising 6 million reads (SRX187114) was
performed comparing GIIRA and Cufﬂinks. For detailed infor-
mation on the experimental setup and parameter settings the
reader is referred to the Supplementary Material.

To evaluate the compared methods following accepted stand-
ards, the resulting gene predictions reported by the different
methods were analyzed using the framework provided by
Cufflinks in the analysis tool Cuffcompare (Trapnell et al.,
2012) with the annotated coding sequences of NCBI as a refer-
ence transcript set. Here, the speciﬁcity and sensitivity for base
level, exon, transcript, locus and intron level are reported, fol-
lowing the guidelines presented in Burset and Guigo (1996).
Following this framework, we also report fuzzy measures of
these quantities, which report whether correct identiﬁcation
were found in proximity even though the precise location
might have been missed. These numbers complement the exact
numbers, for instance to give an impression of how many exons
have been predicted almost completely but without the exact
boundary. To ensure a fair comparison between methods, we
masked all direction information in the Cuffcompare analysis,
as Cufﬂinks does not report any frame information in case no
splicing events occur. In addition, we generated receiver operat-
ing characteristic (ROC) curves complemented by calculating the
F-measure (van Rijsbergen, 1979) for our measures of sensitivity
and speciﬁcity. For further details on the comparison framework
and the calculation of sensitivity and speciﬁcity refer to the
Supplementary Material.

Finally, for the two real datasets and the human simulation,
we performed an alternative evaluation study based on sampling
a ﬁxed number of predictions for all compared methods. This
way the measure of accuracy is independent of the overall
number of predictions of each tool. The results of this evaluation
are included in the Supplementary Material.

4 RESULTS

In our study, we intend to demonstrate the applicability of
GIIRA on different organism types and the effect of including
ambiguous mappings in the analysis. Thus, a crucial point is the
proportion of ambiguously mapped reads in the alignment. All
mappings showed ambiguity, although in varying levels: with
6.6% the simulated E.coli data had the lowest proportion of
ambiguous mappings, whereas the real E.c0[i experiment
showed the highest proportion with 97%. The human simulation
showed 22.8% and the yeast datasets 19% ambiguous hits,
respectively. Note that the large proportion on the real E.coli
data is due to a high level of ribosomal RNA contamination
within the sample (data not shown). Without contamination,
the ambiguity is ~5%, similar to the mapping proportion of
the simulated E.coli dataset that did not include contaminants.
Details for all mapping results and system requirements of
GIIRA are included in the Supplementary Material.

4.1 Prokaryotic datasets

Table 1 shows the Cuffcompare comparison between Cufﬂinks,
GIIRA, GeneMark and GLIMMER3 for the E.coli simulation
and the real E.coli dataset, respectively.

Because the reads were derived directly from the annotated
genes, the simulation reﬂects the ability of the compared

 

609

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap201umoq

9103 ‘0g isanV uo ::

F.Zickmann et al.

 

methods to identify expressed regions and to resolve overlaps.
Cufﬂinks, GLIMMER3 and GIIRA yield a high accuracy on the
base level, with GIIRA being more speciﬁc than Cufﬂinks and
GLIMMER3, whereas GLIMMER3 is slightly more sensitive
than GIIRA. Compared with GeneMark, all methods show a
sensitivity and speciﬁcity increased by more than 20%. Because
only GIIRA and GLIMMER3 focus on extracting structural
genes rather than operons or expressed areas, it is not surprising
that on exon and locus level both methods show clearly better
accuracy than the competing methods (refer to Table S4 and Fig.
S5 in the Supplementary Material). In the E.coli simulation,
GIIRA yields more accurate results than GLIMMER3 with sen-
sitivity and speciﬁcity increased by up to 6 and 11%, respectively,
on the locus level. It should be noted that for Cufﬂinks only the
fuzzy exon and locus level are of relevance, as Cufﬂinks does not
predict start and stop codons and thus regularly misses bases at
the start and end of genes. The fuzzy category covers these bases
because here not only a perfect match, but also a match in range
around the correct result is accepted. For GIIRA, the fuzzy Sn
and Sp are only slightly increased compared with the perfect
match Sn and Sp, indicating a high accuracy in predicting the
correct frame for an expressed region.

Table 1. Cuffcompare analysis for the simulated (1) and real (2) E.coli
dataset

 

 

 

Method (1) E.coli simulation (2) E.coli real
Sensitivity Speciﬁcity Sensitivity Speciﬁcity
GIIRA 96.5 97.7 61.4 93.3
Cufﬂinks 91.1 92.5 40.7 72.2
GeneMark 69.2 66.5 56.1 47.9
GLIMMER3 96.7 94.6 96.7 94.6

 

Note: The highlighted numbers indicate the best results on the base level for sensi—
tivity and speciﬁcity, respectively, for GIIRA, Cufﬂinks, GeneMark and
GLIMMER3. Note that for the real Ecoli dataset sensitivity and speciﬁcity
values are only relative measurements to compare the four methods, but cannot
be regarded as absolute numbers. As opposed to our simulation, where all anno—
tated genes are represented, not all of the genes in E.coli are necessarily expressed at
the same time. Thus, in particular the values for GLIMMER3, the only exclusively
ab initio method, do not reﬂect the genes actually expressed but arise from the
prediction of the complete set of genes.

I 2 00C 11.030 5 000 5.000 10 FUD 12 IDEW “1.030

It should be noted that for the real E.coli dataset Sn and
Sp values are only relative measurements to compare the four
methods, but cannot be regarded as absolute numbers because
not all of the genes in E.coli are necessarily expressed at the same
time. Thus, an additional analysis based on a subset of likely
expressed reference genes is included in the Supplementary
Material. For this dataset, it was not only important to identify
expressed regions and distinguish contaminants but to also cor-
rectly predict genes within the expressed areas. This is reﬂected
in the low sensitivity and speciﬁcity values for Cufﬂinks and
GeneMark, as both methods have a scope differing from iden-
tifying structural genes.

As shown in Table 1 and also in Table S4 and Figure S6 in the
Supplementary Material, GLIMMER3 appears to yield the best
prediction accuracy on all compared levels. However, the values
obtained for GLIMMER3 do not reﬂect the prediction of the
actually expressed genes because it is the only compared method
that exclusively predicts ab initio without including RNA-Seq
evidence. For the purpose of completeness, we included the
measures of sensitivity and speciﬁcity in the Cuffcompare ana-
lysis; however, in our comparison we focus on the three methods
capable of RNA-Seq integration.

GeneMark and GIIRA yield comparable results on the base
sensitivity level. However, GIIRA is more speciﬁc, as GeneMark
covers large parts of the E.coli genome with operons without
indicating the correct locus of the included genes. As illustrated
in Figure 3 and in Table S4 and Figure S6 in the Supplementary
Material, GIIRA performs better than Cufﬂinks and GeneMark
on exon and locus level. GIIRA achieves a good prediction
accuracy of the reference genes, whereas Cufﬂinks only predicts
the expressed regions without indicating the included genes.
GeneMark predicts operons, although these predicted regions
also cover not expressed areas and can also span more than
one operon (indicated by reference genes in different directions).

4.2 Eukaryotic datasets

Although GIIRA was primarily designed as a prokaryotic gene
predictor it is also applicable to eukaryotes as examined on a
simulated human and a simulated and real yeast dataset.
Eukaryotic data pose challenges different from prokaryotic
data; instead of distinguishing operons and determining gene
structures, here many genes have alternative splice sites and

15 I00“ 15.000 20 PO? 22.900 24.000 25.130“ 25.000 $0.125

 

)- m- - - -- - --.—>1. -- 1
b - - -

NCBlnef
- - - *-
GHRA I.
-—-—----m” «a D
Cufﬂinks I
_ M— In B

}-IO-’-- .- -- - --._P<. -- 4

C -
Gl'mmm ) -i .- -- .- -- - -- ._P 1. -- 4
I» - - C -

  

:g. .F nu L'in-lil'l

BeneMam M

Hing-.1" ‘.'.t :.-.-—.r::-l

Fig. 3. Exemplary excerpt of the gene predictions of GIIRA, Cufﬂinks, GLIMMER3 and GeneMark for the gene region starting at position 87 000,
illustrated in Geneious (Kearse et al., 2012). GIIRA (transcripts in red and genes in orange) achieves a good prediction accuracy of the gray reference
genes (which overlap when shown in different rows), whereas Cufﬁinks (blue) only predicts expressed regions without distinguishing genes. GLIMMER3
(yellow) achieves a good prediction accuracy for actually expressed genes, although it also predicts not expressed genes (e. g. on the right) because it does
not consider RNA-Seq information. GeneMark (green) predicts operons, although these predicted regions also cover non-expressed areas

 

610

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap201umoq

9103 ‘0g1sn8nv uo ::

GIIRA

 

Table 2. Cuffcompare analysis for the simulated human data

 

 

Method Base Exon Intron Intron- Transcript Locus
chain
Sensitivity
GIIRA 97.2 85.7 91 44.6 38.5 59.1
GIIRA_w/o 93.5 80.1 85.6 43.6 37.9 57.2
Cufﬂinks 93 71.6 86.7 48.8 0.6 56.2
AUGUSTUS 93.4 88.6 91.9 45.4 39.3 59.7
Speciﬁcity
GIIRA 98 89.1 96.7 43.3 34.9 43.9
GIIRA_w/o 98.4 88.4 98.4 44.3 34.1 39.8
Cufﬂinks 97.8 78.2 97.3 51.7 0.5 44
AUGUSTUS 82.3 81.4 85.3 49.1 38.1 44.8
Fuzzy sensitivity
GIIRA 89.8 91.7 58 44.9 63.5
GIIRA_w/o 84.2 86.1 53.7 43 60
Cufﬂinks 85.2 87.2 63.2 36 60.3
AUGUSTUS 89.4 92.3 70.2 40.6 74.3
Fuzzy speciﬁcity
GIIRA 93.4 97.4 56.3 40.6 47.1
GIIRA_w/o 92.9 99 54.5 38.7 41.7
Cufﬂinks 93 97.8 67 35.5 47.2
AUGUSTUS 82.1 85.7 75.9 39.4 54.9

 

Note: The highlighted numbers indicate the best results for each criterion for sen—
sitivity and speciﬁcity for GIIRA with ambiguous reads, GIIRA without ambigu—
ous reads (GIIRA_w/o), Cufﬂinks and AUGUSTUS. Note that in case of fuzzy
sensitivity and speciﬁcity not only a perfect match but also a match in a range
around the ground truth result is accepted.

various alternative isoforms are present. In this experiment, we
compared GIIRA with Cufﬂinks as well as AUGUSTUS as an
example of a hybrid gene prediction approach. AUGUSTUS can
incorporate information from RNA-Seq experiments, and here
the ﬁltered TopHat2 mapping was included according to the
instructions by the authors (refer to the Supplementary
Material for details). As shown in Table 2 and in Figure S7 in
the Supplementary Material, GIIRA yields the most accurate
predictions on the base level as well as on the fuzzy exon and
transcript level, whereas Cufﬂinks is more accurate in predicting
introns, especially exact intron-chains. Further, on the exact exon
and intron level GIIRA yields a sensitivity comparable with the
best values (obtained by AUGUSTUS), whereas it is clearly
more specific with an increase of more than 7 and 11%, respect-
ively. This is also reﬂected on the base level: here, AUGUSTUS
also yields the lowest prediction speciﬁcity due to a high number
of incorrectly predicted exons and their corresponding introns.
However, on the locus level the hybrid prediction method
AUGUSTUS outperforms GIIRA and Cufﬂinks by ~10% in
sensitivity and 7% in speciﬁcity.

In summary, when comparing the methods that are exclusively
based on RNA-Seq information, we see comparable results, with
GIIRA obtaining a better sensitivity and specificity on all levels
other than intron and intron-chain.

The direct comparison between GIIRA with and without
ambiguous reads shows that the prediction sensitivity is increased
for all levels when ambiguous mappings are included. The effect
is especially pronounced on the exon and intron level, where

 

 

— Cufflinks _}a%
— GllRA_wl_ambiguou5_reacls
— GllRA_wlo_ambiguous_reads

BO-

 

 

TO-

 

60'

50-

4o-

30-

20-

10

 

 

 

 

10* 10° 10L 102
incorrect exon bases (%)

Fig. 4. ROC comparing the proportion of correctly and incorrectly pre-
dicted exonic bases for Cuﬂlinks and GIIRA for yeast chromosome 1,
with GIIRA applied in two modes: including (‘GIIRA_w/_ambiguous_
reads’) and excluding ambiguous reads (‘GIIRA_w/o_ambiguous_
reads’). Including ambiguous reads increases the sensitivity by up to
8% at constant speciﬁcity. The corresponding F-measures are 75.8 for
Cufﬁinks, 78.9 for GIIRA with ambiguous reads and 75.3 for GIIRA
without ambiguous reads. Dashed lines indicate the number of bases
missed due to not identifying a reference exon. Note that the proportion
of false predictions is reported on a logarithmic scale

including ambiguous reads reduces the lack of sensitivity by
up to one third. Interestingly, the intron predictions become
more speciﬁc when ambiguous mappings are excluded, indicating
that a number of erroneous introns is due to ambiguous
split reads.

As illustrated in Figure 4 and in Table S7 in the
Supplementary Material, also for the S.cerevisiae dataset a loss
in identiﬁcations can be observed when ambiguously mapped
reads are disregarded, in particular the sensitivity in correctly
predicted exonic bases is reduced by 8%. Overall, with more
than 80% correctly predicted exonic bases GIIRA yields the
highest sensitivity, whereas both Cufﬂinks and GIIRA are com-
parable in speciﬁcity. Cufﬂinks is more conservative than GIIRA
and yields a higher number of exonic bases missed due to not
predicting a complete reference exon.

The results for the simulated yeast dataset are included in the
Supplementary Material. Here, the Cuffcompare analysis and
ROC curve show a superior prediction accuracy of GIIRA in
comparison with Cufﬂinks and to GIIRA excluding ambiguous
reads. Only the sensitivity of intron and intron-chain predictions
is slightly smaller for GIIRA than for Cufﬂinks.

5 DISCUSSION

We introduced GIIRA as a gene ﬁnder that identiﬁes potential
coding regions exclusively based on mapping of reads from
an RNA-Seq experiment. Unlike other gene predictors, GIIRA
also includes ambiguously mapped reads in the analysis, which im-
proves on the prediction accuracy as demonstrated for various
datasets with different levels of ambiguity. As shown in Section 4,

 

611

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq 111011 pap201umoq

9103 ‘0g1sn8nv uo ::

F.Zickmann et al.

 

already a comparably small number of ambiguous reads can sub-
stantially contribute to the ambiguity of a mapping. Disregarding
this information leads to a loss in sensitivity, e. g. for genes sharing
homologous regions or present in high copy numbers (refer
to Section 4.2, where including ambiguous reads enhanced the
sensitivity of exon predictions by up to one-third).

GIIRA accurately predicts the correct genes for prokaryotic
transcripts as demonstrated in Section 4.1. It identiﬁes the
most likely set of genes explaining the expressed region using
an alignment scoring adaptation coupled with a linear program
formulation. In comparison with existing approaches capable
of RNA-Seq integration, GIIRA has two major beneﬁts: (i) it
shows overall increased prediction accuracy and (ii) it predicts
structural genes themselves rather than focusing on operons such
as GeneMark or transcripts without indicating start and stop
codons such as Cufﬂinks.

Although GIIRA was primarily designed for prokaryotic gene
prediction, it can also be applied to eukaryotic gene prediction as
an addition to existing annotation pipelines or a complement
to other gene ﬁnders. For eukaryotic genomes, the complexity
of alternative splicing events poses a critical challenge because
GIIRA does not work with splice graphs to combine exons,
but evaluates each splice site independently from others. As illu-
strated in Section 4.2, compared with the other methods GIIRA
is sensitive in predicting exons and transcripts. It also yields a
high accuracy in predicting introns, but is less accurate in com-
bining them to the correct intron-chain. For instance, a challenge
arises for GIIRA if two alternative isoforms share an exon where
one isoform ends with this exon and the other isoform proceeds
with other exons. For GIIRA, both isoforms appear to be
continued with other exons and it assigns an incorrect intron-
chain. Because Cufﬂinks uses a graph theory approach to
evaluate splice sites, it is less affected by this phenomenon and
on the intron-chain level it, hence, yields higher prediction
accuracy than GIIRA. AUGUSTUS, as a hybrid gene predictor
using non-ambiguous RNA-Seq mappings as external evidence,
is less speciﬁc than the compared methods in regard to exon
prediction but is superior in locus prediction.

Because GIIRA is exclusively based on RNA-Seq informa-
tion, it can only predict genes currently expressed in the organism
of interest and thus does not necessarily provide a complete
annotation of all encoded genes.

GIIRA provides two frameworks to control the number of
false-positive predictions: (i) to ﬁlter contaminants and sequen-
cing artifacts and (ii) to verify the reported gene predictions.
It can identify regions with an extremely large coverage
compared with the average coverage to be sequencing artifacts
or other errors such as contaminants. In case of the real E.coli
dataset, this outlier identification ﬁltered out most of the riboso-
mal RNA contaminants. Further, GIIRA reports additional
information on coverage and ambiguous read support for each
prediction. This enables an easy post-processing of the output
allowing a trade-off of sensitivity and speciﬁcity adjusted to
the intended follow-up analysis. Note that although GIIRA is
independent from any a priori information, it is possible to use
such information (if present) to improve the prediction accuracy.
For instance, if a reference annotation is already available, dif-
ferent runs of GIIRA can be compared using the Cuffcompare
framework to identify an optimal parameter setting.

6 CONCLUSION

GIIRA is a gene prediction method that identiﬁes potential
coding regions exclusively based on the mapping of reads from
an RNA-Seq experiment. It was foremost designed for prokary-
otic gene prediction and can resolve genes within the expressed
region of an operon. However, it is also applicable to eukaryotes
and predicts exon intron structures as well as alternative isoforms.
Unlike other gene ﬁnders, GIIRA also incorporates ambiguously
mapped reads in the gene identiﬁcation, which improves the
sensitivity of predictions in particular for genes sharing homolo-
gous regions or present in more than one copy on the genome.
As shown for several datasets, GIIRA performs favorably in
comparison with existing approaches, in particular for prokary-
otes. Further, GIIRA allows an easy post-processing of the
predicted genes to choose the best trade-off between sensitivity
and speciﬁcity adjusted to the intended follow-up analysis.

ACKNOWLEDGEMENTS

The authors thank all members of the NG4 bioinformatics group
(Robert Koch-Institute) and Wojtek Dabrowski (ZBSl, Robert
Koch-Institute) for helpful and inspirational discussions and
Jochen Singer (FU Berlin) for critical reading of the manuscript.

Funding: Generous start-up support by the Robert Koch-
Institute (to B.Y.R.).

Conﬂict of Interest: none declared.

REFERENCES

Allen,J.E. and Salzberg,S.L. (2005) JIGSAW: integration of multiple sources of
evidence for gene prediction. Bioinformatics, 21, 359G3603.

Besemer,J. et a]. (2001) GeneMarkS: a self—training method for prediction of gene
starts in microbial genomes. Implications for ﬁnding sequence motifs in regula—
tory regions. Nucleic Acids Res., 29, 260772618.

Bonfert,T. et a]. (2012) A context—based approach to identify the most likely
mapping for RNA—seq experiments. BMC Bioinformatics, l3 (SuppL 6), $9.
Burset,M. and Guigo,R. (1996) Evaluation of gene structure prediction programs.

Genomics, 34, 3537367.

Chung,D. et a]. (2011) Discovering transcription factor binding sites in highly
repetitive regions of genomes with multi—read analysis of ChIP—Seq data.
PLoS Comput. Biol., 7, e1002111.

CPLEX. (2011) International Business Machines Corporation. v12.4: Users manual
for CPLEX. IBM ILOG CPLEX, IBM, Armonk, New York, United States.

Delcher,A.L. et a]. (2007) Identifying bacterial genes and endosyrnbiont DNA with
Glimmer. Bioinformatics, 23, 673$79.

Denoeud,F. et a]. (2008) Annotating genomes with massive—scale RNA sequencing.
Genome Biol., 9, R175.

Ederveen,T.H.A. et a]. (2013) Reduce manual curation by combining gene predic—
tions from multiple annotation engines, a case study of start codon prediction.
PLoS One, 8, e63523.

Garber,M. et a]. (2011) Computational methods for transcriptome annotation and
quantiﬁcation using RNA—seq. Nat. Methods, 8, 4694177.

GLPK. (2006) GNU Linear Programming Kit, v4.47. GLPK.

Goodswen,S_I. et a]. (2012) Evaluating high—throughput ab initio gene ﬁnders to
discover proteins encoded in eukaryotic pathogen genomes missed by laboratory
techniques. PLoS One, 7, e50609.

Guigé,R. et a]. (2006) EGASP: the human ENCODE genome annotation assess—
ment project. Genome Biol., 7 (SuppL l), 32.

Holt,C. and Yandell,M. (2011) MAKERZ: an annotation pipeline and genome—
database management tool for second—generation genome projects. BMC
Bioinformatics, 12, 491.

 

612

112 /310's112u1n0fp101x0"sotwuiJOJHtotq/ﬁduq 111011 papeo1umoq

9103 ‘0g1sn8nv uo ::

GIIRA

 

Holtgrewe,M. (2010) Mason — a read simulator for second generation sequencing
data. In: Technical report T R—B—10—06. Fachbereich fur Mathematik und
Informatik, Freie Universitat Berlin.

Kearse,M. et a]. (2012) Geneious Basic: an integrated and extendable desktop
software platform for the organization and analysis of sequence data.
Bioinformatics, 28, 164771649.

Kim,D. et a]. (2013) TopHat2: accurate alignment of transcriptomes in the presence
of insertions, deletions and gene fusions. Genome Biol., 14, R36.

Korf,I. (2004) Gene ﬁnding in novel genomes. BMC Bioinformatics, 5, 59.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with burrows—
wheeler transform. Bioinformatics, 25, 17544760.

Li,H. et a]. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 207872079.

Lukashin,A.V. and Borodovsky,M. (1998) GeneMark.hmm: New solutions for
gene ﬁnding. Nucleic Acids Res., 26, 110771115.

Majoros,W.H. et a]. (2004) TigrScan and GlimmerHMM: two open source ab initio
eukaryotic gene—ﬁnders. Bioinformatics, 20, 287872879.

Martin,J. et a]. (2010) Bacillus anthracis genome organization in light of whole
transcriptome sequencing. BM C Bioinformatics, ll (SuppL 3), $10.

Mezlini,A.M. et a]. (2013) iReckon: simultaneous isoform discovery and abundance
estimation from RNA—seq data. Genome Res., 23, 5197529.

Mortazavi,A. et a]. (2008) Mapping and quantifying mammalian transcriptomes by
RNA—Seq. Nat. Methods, 5, 621$28.

Palmieri,N. et a]. (2012) Evaluation of different reference based annotation
strategies using RNA—Seq — a case study in Drososphila pseudoobscura.
PLoS One, 7, e46415.

Pickrell,J.K. et a]. (2012) Understanding mechanisms underlying human gene
expression variation with RNA sequencing. Nature, 464, 7687772.

Savidor,A. et a]. (2006) Expressed peptide tags: an additional layer of data for
genome annotation. J. Proteome Res., 5, 304873058.

Schrimpe—Rutledge,A.C. et a]. (2012) Comparative omics—driven genome annotation
reﬁnement: application across Yersiniae. PLoS One, 7, e33903.

Stanke,M. et a]. (2006) Gene prediction in eukaryotes with a generalized
Hidden Markov Model that uses hints from external sources. BMC
Bioinformatics, 7, 62.

Stanke,M. et a]. (2008) Using native and syntenically mapped cDNA alignments
to improve de novo gene ﬁnding. Bioinformatics, 24, 637$44.

Sultan,M. et a]. (2008) A global View of gene activity and alternative splicing by
deep sequencing of the human transcriptome. Science, 321, 9567960.

Trapnell,C. et a]. (2010) Transcript assembly and quantiﬁcation by RNA—Seq
reveals unannotated transcripts and isoform switching during cell differenti—
ation. Nat. Biotechnol., 28, 5117515.

Trapnell,C. et a]. (2012) Differential gene and transcript expression analysis of
RNA—seq experiments with TopHat and Cufﬂinks. Nat. Protoc., 7, 5627578.

Tu,Q. et a]. (2012) Gene structure in the sea urchin Strongylocentrotus purpuratus
based on transcriptome analysis. Genome Res., 22, 207972087.

Vingron,M. and Waterman,M.S. (1994) Sequence alignment and penalty choice:
review of concepts, case studies and implications. J. Mol. Biol., 235, 1712.
Wang,Q. et a]. (2012) Theoretical prediction and experimental veriﬁcation of
protein-coding genes in plant pathogen genome Agrobacterium tumefaciens

strain C58. PLoS One, 7, e43176.

Wang,Z. et a]. (2009) RNA—Seq: a revolutionary tool for transcriptomics. Nat. Rev.
Genet., 10, 57763.

Wei,C. and Brent,M. (2006) Using ESTs to improve the accuracy of de novo gene
prediction. BMC Bioinformatics, 7, 327.

Wijaya,E. et a]. (2013) Finding protein—coding genes through human polymorph—
isms. PLoS One, 8, e54210.

van Rijsbergen,C.J. (1979) Information Retrieval. 2nd edn. Butterworths, London.

 

613

112 /310's112u1n0fp101x0"sotwuiJOJHtotq/ﬁduq 111011 papeo1umoq

9103 ‘0g1sn8nv uo ::

