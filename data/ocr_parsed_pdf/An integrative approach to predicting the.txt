Bioinformatics, 31110), 2015, 1536—1543

doi: 10.1093/bioinformatics/btv009

Advance Access Publication Date: 11 January 2015
Original Paper

 

Genome analysis

An integrative approach to predicting the
functional effects of non-coding and coding
sequence variation

Hashem A. Shihab1'2'*'1, Mark F. Rogers3'*'1, Julian Gough4,
Matthew Mort5, David N. Cooper5, Ian N. M. Dayz, Tom R. Gaunt”:r and
Colin Campbel|3'*"r

1MRC Integrative Epidemiology Unit (IEU), University of Bristol, Bristol BS8 2BN, UK, 2Bristol Centre for Systems
Biomedicine, University of Bristol, Bristol BS8 2BN, UK, 3Intelligent Systems Laboratory, University of Bristol,
Bristol BS8 1UB, UK, 4Department of Computer Science, University of Bristol, Bristol BS8 1UB, UK and 5Institute of
Medical Genetics, Cardiff University, Cardiff CF14 4XN, UK

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia
TThe authors wish it to be known that, in their opinion, the first two and last two authors should be regarded as joint Authors.

Received on September 3, 2014; revised on December 30, 2014; accepted on January 5,2015

Abstract

Motivation: Technological advances have enabled the identification of an increasingly large spec—
trum of single nucleotide variants within the human genome, many of which may be associated
with monogenic disease or complex traits. Here, we propose an integrative approach, named
FATHMM—MKL, to predict the functional consequences of both coding and non—coding sequence
variants. Our method utilizes various genomic annotations, which have recently become available,
and learns to weight the significance of each component annotation source.

Results: We show that our method outperforms current state—of—the—art algorithms, CADD and
GWAVA, when predicting the functional consequences of non—coding variants. In addition,
FATHMM—MKL is comparable to the best of these algorithms when predicting the impact of coding
variants. The method includes a confidence measure to rank order predictions.

Availability and implementation: The FATHMM—MKL webserver is available at: http://fathmm.
biocompute.org.uk

Contact: H.Shihab@bristol.ac.uk or Mark.Rogers@bristol.ac.uk or C.Campbell@bristol.ac.uk
Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Rapid technological advances and the falling costs of next-gener-
ation sequencing technologies have accelerated the identification of
single nucleotide variants (SNVs) in the human genome (The 1000
Genomes Project, 2010). Ascertaining which of these are functional,
against a background of neutral SNVs, promises to improve our
understanding of the molecular mechanisms underpinning disease
and complex traits. There is a plethora of computational algorithms
capable of predicting whether SNVs are deleterious (Thusberg et (11.,
2011). However, these algorithms are typically restricted to SNVs

(C7 The Author 2015. Published by Oxford University Press.

falling within protein-coding regions of the genome, with a particu-
lar focus on non-synonymous SNVs (nsSNVs). They are therefore
incapable of assessing the consequences of a significant proportion
of SNVs, given that the vast majority of SNV-trait associations fall
within intergenic or intronic regions of the genome (Hindorff et (11.,
2009). In this article, we propose a method for predicting the func-
tional impact of both coding and non-coding SNVs.

Existing protein-based prediction algorithms tend to exploit evolu-
tionary conservation when determining whether or not variants are
functional. However, other potential sources for functional annotation

1536

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

/310‘s112umo[p10}xo‘sopcuHOJIItotq/ﬁdnq

An integrative approach to predicting functional effects

1537

 

are also now available from the Encyclopaedia of DNA Elements
(ENCODE) consortium. Using several different technologies,
ENCODE aims to identify all functional elements within the human
genome, including transcribed non—coding RNAs, transcription factor
binding sites and chromatin structure (The ENCODE Project
Consortium, 2012). At the time of writing, ENCODE has produced
approximately 1640 datasets describing the analysis of 24 different
types of experiments in 147 cell lines, under various conditions (Qu
and Fang, 2013). One of the major challenges faced by researchers is
to successfully integrate the wealth of information contained within
ENCODE to predict the functional consequences of SNVs.

Following our previous work (Shihab et al., 2013b, a, 2014), we
describe a machine learning approach (called FATHMM—MKL) that
integrates functional annotations from ENCODE with nucleotide—
based sequence conservation measures. When assessing the func—
tional consequences of non—coding variants, we observe improved
performance when compared with two recently proposed variant
prediction algorithms: GWAVA (Ritchie et al., 2014) and CADD
(Kircher et al., 2014), which as far as we are aware, are the only
other proposed methods that can predict the functional conse—
quences of non—coding variants. Furthermore, our method achieves
comparable performance to CADD when predicting the functional
impact of nsSNVs. A web—based implementation of FATHMM—
MKL, including pre—computed predictions for the entire human
genome and downloadable software, is available at http://fathmm.
biocompute.org.uk.

2 Methods and materials

2.1 Datasets

We assembled two distinct datasets: our pathogenic dataset was
constructed using heritable germ—line mutations from the Human
Gene Mutation Database (Stenson et al., 2014) (release 2013.4, sub—
sequently denoted HGMD) and our control dataset was constructed
using SNVs from the 1000 Genomes Project (The 1000 Genomes
Project Consortium, 2012). This control dataset will contain many
variants that are unannotated, and therefore it will likely contain
some true positives. We will consider this issue in more detail in
Section 3.3. Similarly, among positively labelled datapoints from the
HGMD dataset, we could expect some true negatives: some neutral
variants can be inherited alongside pathogenic variants due to gen—
omic proximity, for example. Thus the positive class should be
viewed as disease—associated variants that are enriched for func—
tional impact as a set. The method we are to describe can be used
with datasets for both inherited single nucleotide polymorphisms
(SNPs) and somatic SNVs. The HGMD dataset is therefore an
example of the former category.

For our analysis, we restricted our control dataset to SNVs hav—
ing a global minor allele frequency 21% and further removed those
that were also present in our pathogenic dataset. In order to assess
the predictive utility of our method in both coding and non—coding
regions of the genome, we further split our pathogenic and control
datasets according to whether or not the variant introduces an
amino acid substitution. We used 10 feature groups, denoted [A—j],
which could be predictive of disease association and are therefore
used to annotate out datasets using a customized pipeline. These fea—
ture groups are more fully described in the Supplementary material,
but a short description is as follows:

A. 46-Way Sequence Conservation: based on multiple sequence
alignment scores, at the nucleotide level, of 46 vertebrate gen—
omes compared with the human genome.

B. Histone Modiﬁcations (ChlP-Seq): based on ChIP—Seq peak calls
for histone modiﬁcations.

C. Transcription Factor Binding Sites (TFBS PeakSeq): based on
PeakSeq peak calls for various transcription factors.

D. Open Chromatin (DNase-Seq): based on DNase—Seq peak
calls.

E. 100-Way Sequence Conservation: based on multiple sequence
alignment scores, at the nucleotide level, of 100 vertebrate gen—
omes compared with the human genome.

F. GC Content: based on a single measure for GC content calcu—
lated using a span of ﬁve nucleotide bases from the UCSC
Genome Browser.

G. Open Chromatin (FAIRE): based on formaldehyde—assisted iso—
lation of regulatory elements (FAIRE) peak calls.

H. Transcription Factor Binding Sites (TFBS SPP): based on SPP
peak calls for various transcription factors.

I. Genome Segmentation: based on genome—segmentation states
using a consensus merge of segmentations produced by the
ChromHMM and Segway software.

J. Footprints: based on annotations describing DNA footprints
across cell types from ENCODE.

2.2 Data integration

The resulting product of this data preparation is several large matri—
ces comprising data from different feature groups, each of which
can have different measurement scales. These feature groups can all
indicate whether an SNV is functional or not, and hence we use a
classifier based on multiple kernel learning (MKL). In MKL, differ—
ent types of input data are encoded into kernel matrices, which
quantify the similarity of data objects. A number of different meth—
ods have been proposed for deriving kernel matrices for different
types of data objects, including data with discrete and continuous
values, sequence data and graph data (Shawe-Taylor and
Cristianini, 2004). With MKL, each constituent type of data is
encoded into a corresponding base kernel Kr (where Z : 1, . . . ,p if
there are p feature groups), from which we can derive a composite
kernel matrix K : ELI HKr where ELI if : 1 and if 2 0. The if
are kernel weights. This composite kernel can then be used with a
kernel—based classifier, such as a support vector machine (SVM)
(Campbell and Ying, 2011), which was the classifier used here.
During the training phase, this approach requires determination
of the learning parameters for the SVM in addition to the
kernel weights. A variety of methods have been proposed for MKL
(Gonen and Alpaydin, 2011), and this approach has been success—
fully demonstrated with various classification problems in bioinfor—
matics, which use different types of input data (Ying et al., 2009).
By using all available data encoded into a set of kernels, MKL
classifiers most frequently outperform a single kernel classifier
constructed for one type of data. In addition, the kernel weights are
adjusted according to the relative informative—ness of the different
types of data: this enhances overall performance and interpretation
of the model.

As further explained in the Supplementary Material, we also
introduce a confidence measure associated with predicted class
label. An SVM for binary classification has a decision function
of the form sign(¢>) with the sign of d) determining the predicted
class. However, the magnitude ((1)) is also a measure of the confi—
dence in this class assignment. By fitting a sigmoid function, we
convert (1) into a confidence measure based on the posterior prob—
ability of a positive (pathogenic) outcome P(y: 11(1)) (Platt,
1999). Apart from indicating the reliability of a prediction, this

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

(7/ Li]. (2014)

Ritchie (7/ Lil. (2014)

Supplementar) data

Supplementar) data

(7/ LI/., 2014

Kircher (7/ LI/., 2014

Ritchie

Ritchie

52

Figs. 1

2

Supplementar) data

Supplementar) Figs. 51

Supplementar) data

Fig. 1

D: OpenChrom DNase-Seq (AU
B: Histone ChlP-Seq (AUC=0.61)
C: TFBS Peak-Seq (AUC=0.61)
A: 46-way cons. (AUC=0.88)

— FATHMM-MKL (AUC=0.91)

 

Supplementary data [AeDl

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

GWAVA (AUC=0.69)
CADD (AUC 0.87)
— FATHMM-MKL (A

 

Supplementary data [AeDl

 

Supplementary data [AeDl

Supplementar) Fig. 53

Fig. 1

Li, 2011

Figs. 3 4

Fig. 3

 

Supplementary data [AeDl

I: Segmentation (AUC=0.60)
G: OpenChrom FAIRE (AUC=0.63)
H: TFBS SPP (AUC=0.67)
B: Histone ChlP-Seq (AU 0 71)
C: TFBS Peak-Seq (AUC 0.76)
A: 46-way cons. (AUC 0.90)
E: loo-way eons. (AU .91)
— FATHMM-MKL (AU .93)

 

Supplementary [AeJl

Figs. 5 6

Supplementar) Figs. 54 55

Fig 2 Fig. 6

Supplementar) Figures 56

Figs. 3 4
S7

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

 

Supplementary [AeJl

Figures 7 8

 

 

Figure 7

Supplementar) Fig. SS

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

 

Landrum e! 111., 2013

e! 111., 2014

Fig.

 

Figure 9

Ritchie 01 111., 2014 Kircher

Fig. 10

10

FATHMM-MKL (AUC=0.93)
CADD (AUC=0.89)
— GWAVA (AUC 0.62)

GWAVA (AUC=0.56)
FATHMM-MKL (AUC=0.80)
FATHMM-MKL (full) (AUC=0.87)
CADD (AUC=0.88)

 

/310'S[BHJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

1542

H.A.Shihab et al.

 

consisting of 2205 novel positive examples from coding regions and
401 from non—coding regions. This gives us an objective test of recall
performance on unseen instances. Of these novel positive examples,
339 non—coding examples (85%) and 1955 coding examples (89%)
are correctly predicted by our classifier at the default threshold.
For some non—coding examples, we had no data in any of the feature
groups and hence FATHMM—MKL could not make a prediction.
When we consider only those examples where predictions can be
made, these proportions increase to 88%. We also found that 34 of
these novel positive examples were labeled negative in our training
data, illustrating the potential prevalence of noise in the data.
In summary, FATHHMM—MKL has distinct advantages over
CADD and GWAVA and the above observations indicate that it
provides reliable predictions with recall near 88%.

3.3.4 FATHMM-MKL website

The associated website allows users to query our prediction data—
base for novel deleterious mutations. In addition, we provide down—
loadable tables of ranked positive predictions (functional in disease)
for three values of the P—value cutoff: at 0.95, 0.90 and at 0.26
(the former are subsets of the latter). Finally, we provide software
for generating predictions given new data in at least one of our
feature groups.

4 Discussion

The method we have outlined outperformed both GWAVA and
CADD when predicting the functional consequences of non—coding
sequence variants (Fig. 2 and Supplementary Fig. 52). In this case,
better performance was achieved using a smaller number of feature
groups ([A—D] in Fig. 1), as opposed to a broader range of feature
groups ([A—J] in Supplementary Fig. 51). We also achieved good per—
formance when predicting the functional impact of nsSNVs (Fig. 6).
For coding sequence variants, better performance was achieved
using all the feature groups ([A—]] in Fig. 5) instead of a smaller
subset of feature groups (e.g. [A—D] in Supplementary Fig. 54). This
out—performance was achieved despite the fact that the 10 feature
group model used only 36% of the training examples available to
the four feature group model. This suggests that a broad range
of data sources are informative for classifying variants in coding re—
gions. For predicting the functional impact of variants in non—coding
regions, the opposite is suggested, with fewer types of data being
truly informative. In both cases, the most informative indicator
is Whether or not the variant falls within regions which are highly
conserved across species.

One advantage of our method is that it highlights the relative in—
formative—ness of the different sources of data (e.g. Supplementary
Fig. 53). Furthermore, the addition of a confidence measure also
allows for the isolation of a smaller set of variants that have a higher
confidence of correct functional impact assignment. This provides
an intuitive way to rank predictions for subsequent analysis when
discovering novel deleterious variants, as one may be able to survey
only a small set of the most compelling variants. However, as noted
in Section 3.3.2, incomplete data may restrict the feature groups we
can use to make a prediction. Currently, we rescale kernel weights
to accommodate these cases, but as our experiments with coding ex—
amples reveal, rescaling may not adequately compensate for missing
features. We anticipate that rapidly growing data resources will
mitigate this issue eventually, but immediate improvements in test
accuracy are possible. For example, provided the number of feature
groups remains small, we could learn sets of kernel weights specific

to all possible combinations of feature groups. Feature groups
had between 8 and 443 component features, with the strongest—
performing group having the fewest features (46—way and 100—way
conservation). It may be possible to improve performance using
feature selection within these groups. In addition, rather than inte—
grating component feature groups at the level of the data, via a com—
posite kernel, it would be possible to integrate classifiers (each
handling one feature group), via ensemble learning. Additional im—
provements are possible. For example, for non—coding regions, we
could further exploit the sequence context of a variant to identify a
possible functional element (e.g. a non—coding RNA site) and use
this information to improve predictive accuracy.

In future projects, we shall investigate these potential improve—
ments in addition to devising bespoke predictors for labelling vari—
ants in specific disease contexts, such as cancer. For prediction using
coding variants, there are further sources of data that could be rele—
vant to enhancing prediction performance. We will also experiment
with these to establish if the proposed MKL method could be
improved further, leading to out—performance over CADD.

Acknowledgement

M.M. and D.N.C. gratefully acknowledge the ﬁnancial support of BIOBASE
GmbH.

Funding

This work was supported by the Medical Research Council [MC_UU_12013/
8 and G1000427/1]. M.R. was supported by an Engineering and Physical
Sciences Research Council grant [EP/K008250/1]. ].G. was supported by the
Biotechnology and Biological Sciences Research Council (BBSRC) [BB/
G022771].

Conﬂict of Interest: none declared.

References

Campbe11,C. and Ying,Y. (2011) Learning with Support Vector Machines.
Morgan and Claypool, San Rafael, California, USA.

G6nen,M. and Alpaydin,E. (2011) Multiple kernel learning algorithms.
]. Mach. Learn. Res, 12, 2211—2268.

Hindorff,L.A. et al. (2009) Potential etiologic and functional implications
of genome-wide association loci for human diseases and traits. Proc. Natl
Acad. Sci., USA, 106, 9362—9367.

Kircher,M. et al. (2014) A general framework for estimating the relative
pathogenicity of human genetic variants. Nat. Genet, 46, 310—315.

Landrum,M.]. et al. (2013) Clinvar: public archive of relationships among
sequence variation and human phenotype. Nucleic Acids Res., gkt1113.

Li,H. (2011) Tabix: fast retrieval of sequence features from generic
tab-delimited ﬁles. Bioinformatics, 27, 718—719.

Platt,]. (1999) Probabilistic outputs for support vector machines and compari-
sons to regularized likelihood methods. In: Advances in Large Margin
Classiﬁers. MIT Press, Cambridge, Massachusetts, USA, pp. 61—74.

Qu,H. and Fang,X. (2013) A brief review on the human encyclopedia of DNA
elements (encode) project. Genom. Proteom. Bioinform., 11, 135—141.

Ritchie,G.R.S. et al. (2014) Functional annotation of noncoding sequence
variants. Nat. Methods, 11, 294—296.

Shawe-Taylor,]. and Cristianini,N. (2004) Kernel Methods for Pattern
Analysis. Cambridge University Press, Cambridge, United Kingdom.

Shihab,H.A. et al. (2013a) Predicting the functional consequences of cancer-
associated amino acid substitutions. Bioinformatics, btt182.

Shihab,H.A. et al. (2013b) Predicting the functional, molecular, and
phenotypic consequences of amino acid substitutions using hidden markov
models. Hum. Mntat., 34, 57—65.

ﬁm'srcumol‘piqxo'sopcuuoptrotq/ﬁdnq

An integrative approach to predicting functional effects

1543

 

Shihab,H.A. et al. (2014) Ranking non-synonymous single nucleotide
polymorphisms based on disease concepts. Hum. Genomics, 8, 11.

Stenson,P.D. et al. (2014) The human gene mutation database: building
a comprehensive mutation repository for clinical and molecular genetics,
diagnostic testing and personalized genomic medicine. Hum. Genet,
133, 1—9.

The 1000 Genomes Project. (2010) A map of human genome variation from
population-scale sequencing. Nature, 467, 1061—1073.

The 1000 Genomes Project Consortium. (2012) An integrated map of genetic
variation from 1,092 human genomes. Nature, 491, 56—65.

The ENCODE Project Consortium. (2012) An integrated encyclopedia of
DNA elements in the human genome. Nature, 489, 57—74.

Thusberg,]. et al. (2011) Performance of mutation pathogenicity prediction
methods on missense variants. Hum. Mutat., 32, 358—368.

Ying,Y. et al. (2009) Enhanced protein fold recognition through a novel data
integration approach. BMC Bioinformatics, 10, 267.

/810'slcumofp103xo"soueuuogutotqﬂ:duq

