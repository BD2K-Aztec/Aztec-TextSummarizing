Vol. 28 no. 7 2012, pages 1048-1049
APP N doi:10.1093/bioinformatics/bt3069

 

Systems biology

Advance Access publication February 4, 2012

IDEOM: an Excel interface for analysis of LC—MS-based

metabolomics data

Darren J. Creek1’2, Andris Jankevics3’4, Karl E. V. Burgessl, Rainer Breitling3’4 and

Michael P. Barrett1 ’*

1Institute of Infection, Immunity and Inflammation, Wellcome Trust Centre for Molecular Parasitology, College of
Medical, Veterinary and Life Sciences, University of Glasgow, Glasgow G12 8TA, UK, 2Department of Biochemistry
and Molecular Biology, University of Melbourne, Parkville, Victoria 3010, Australia, 3Institute of Molecular, Cell and
Systems Biology, College of Medical, Veterinary and Life Sciences, University of Glasgow, Glasgow, G12 800, UK
and 4Groningen Bioinformatics Centre, Groningen Biomolecular Sciences and Biotechnology Institute, University of

Groningen, 9700 CC Groningen, The Netherlands
Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: The application of emerging metabolomics technologies
to the comprehensive investigation of cellular biochemistry has been
limited by bottlenecks in data processing, particularly noise filtering
and metabolite identification. IDEOM provides a user-friendly data
processing application that automates filtering and identification of
metabolite peaks, paying particular attention to common sources of
noise and false identifications generated by liquid chromatography—
mass spectrometry (LC—MS) platforms. Building on advanced
processing tools such as szatch and XCMS, it allows users to run
a comprehensive pipeline for data analysis and visualization from a
graphical user interface within Microsoft Excel, a familiar program for
most biological scientists.

Availability and implementation: IDEOM is provided free of charge
at http://mzmatch.sourceforge.net/ideom.html, as a macro-enabled
spreadsheet (.xlsb). Implementation requires Microsoft Excel (2007
or later). R is also required for full functionality.

Contact: michael.barrett@glasgow.ac.uk

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on December 1, 2011; revised on January 9, 2012;
accepted on January 31, 2012

1 INTRODUCTION

Metabolomics aims to measure all small molecules (metabolites)
in a biological system. However, Challenges associated with data
analysis, in particular the accurate identiﬁcation of metabolites
(Moco et (11., 2007; Neumann and Booker, 2010) have restricted
progress.

Recent advances in high resolution mass spectrometry (MS)
provide accurate mass detection that signiﬁcantly improves
metabolite identiﬁcation from liquid Chromatography—MS (LC—MS)
(Breitling et (11., 2006; M000 et (11., 2007) although limitations still
abound (Kind and Fiehn, 2010; Neumann and Booker, 2010), and
noise or artifact peaks are often incorrectly identiﬁed as metabolites
(Scheltema et (11., 2009).

 

*To whom correspondence should be addressed.

Applications are freely available for detection, quantiﬁcation and
alignment of signals in LC—MS data (Blekherman et (11., 2011),
and numerous multivariate statistical methods have been proposed
to extract signiﬁcant features from these high-dimensional datasets
(Madsen et (11., 2010). However, many of the most powerﬁil tools
are implemented in statistical software, and while the graphical user
interface (GUI) in MZmine (Pluskal et (11., 2010) simpliﬁes data
pre-processing, recent advances in noise ﬁltering and identiﬁcation
algorithms (Brown et (11., 2011; Scheltema et (11., 2011) are difﬁcult
to use without special training.

IDEOM is a Microsoft Excel template with a collection of VBA
macros that enable automated data processing of high resolution LC—
MS data from untargeted metabolomics studies, with a particular
focus on removal of noise [which accounts for ~80% of peaks
in typical LC—MS metabolomics datasets (Jankevics et (11., 2012)],
metabolite identiﬁcation and data visualization. Its GUI allows users
to exploit the power of data-processing methods such as szatCh
(Scheltema et (11., 2011) and XCMS (Smith et (11., 2006) from
within Excel, and enables rapid and simple conversion of raw
or pre-processed LC—MS data into a ﬁltered, interpretable list of
putative metabolites, with associated conﬁdence levels and sample
intensities.

2 METHODS

Opening the IDEOM template in Excel provides a spreadsheet on which to
specify the parameters for data processing (default values are provided). All
IDEOM macros for data processing are then activated by buttons or in-cell
hyperlinks. and pop-up dialog boxes are used to specify important parameters
for individual processing steps.

Raw LCiMS data ﬁles (.szML) are processed by IDEOM using
the freely available XCMS (Smith et (11.. 2006) and mzmatchR tools
(http://mzmatch.sourceforgenet/index.php) (Scheltema et (11.. 2011). by
automatic generation and execution of scripts in the R environment
(www.r-project.0rg) (R. 2008) using readily adjustable parameters. Raw
peaks are extracted by XCMS. and mZMatch applies peak matching. noise
ﬁltering. gap-ﬁlling and annotation of related peaks. Pre-processed peak lists
from szatch 0r MZmine can be directly imported into IDEOM as text
or csv ﬁles. During data import. any number of samples can be assigned
to (up to 30) study groups (e.g. blanks. controls and QCs) to improve
data ﬁltering. analysis and Visualization. Sample consistency. according

 

1048 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq 11101} papBOIII/IAOG

9103 ‘Og anﬁnv uo ::

IDEOM

 

to average peak height and internal standards (optional). is automatically
checked and normalization can be applied.

Noise ﬁltering within IDEOM removes common sources of noise in high
resolution LCiMS data: chromatographic peak shoulders. irreproducible
peaks. background or contaminant signals. and fourier transform (FT)
and electrospray ionisation (ESI) artifacts including isotopes. adducts and
fragments (based on Brown et al.. 2011 and Scheltema et al.. 2011). as
described in the documentation (Supplementary Material).

Metabolite identiﬁcation is achieved by matching the accurate mass and
retention time of observed peaks to metabolites in the included database.
which incorporates all likely metabolites from a wide range of biological
databases. and can be updated by users for speciﬁc applications. Retention
times for authentic standards. and a retention time prediction model.
are included for ZIC-HILIC chromatography data (Creek et al.. 2011);
however. as retention times are instrument speciﬁc. users are encouraged
to upload standard retention times from their own platform with the macro
provided. Subsequent to initial metabolite identiﬁcation. a data-dependent
polynomial mass recalibration step can be applied to correct for mass-
dependent calibration errors. The ﬁnal lists of identiﬁed. and rejected. peaks
are annotated with conﬁdence scores regarding the identiﬁcation of each
metabolite. based on retention times. organism-speciﬁc (0r user-deﬁned)
databases and annotation as possible ‘related peaks” (Scheltema et al.. 2009).
Univariate statistics (mean. relative intensity. SD. t-test and Fisher ratio) are
calculated in Excel. Multivariate statistics are obtained by calls to the R
environment.

3 RESULTS

The automated pre-processing steps in IDEOM drastically reduce
the need for manual curation of LC—MS data by applying ﬁlters
to remove hundreds of false-identiﬁcations (Creek et (11., 2011).
The example tutorial dataset (Supplementary Material) demonstrates
putative identiﬁcation of 1314 metabolites and rejection of 1942
false-identiﬁcations from serum samples. The putatively identiﬁed
metabolites are displayed in an interactive table that includes
metabolite information, sample intensities, comparative statistics,
LC—MS data, and links to websites and graphs (Fig. l). Putative
identiﬁcations can be rapidly scrutinized by double-click access
to LC—MS metadata, or adjusted by selecting alternative isomers
from dropdown lists. Data visualization is enhanced by Excel’s
conditional formatting, ﬁltering and sorting, allowing users to view

 

Fig. 1. Screenshot of results Visualization showing the dropdown list
selection of isomers and some of the automatically generated hyperlinked
charts.

results according to sample intensities, signiﬁcance, pathways or
other properties.

Additional IDEOM tools include: merging dual-polarity data,
chemical formula determination for unidentiﬁed masses, stable
isotope tracking and targeted analysis. Full documentation, tutorials,
source code and the IDEOM template are freely available at
http://mzmatch.sourceforge.net/ideom.html.

IDEOM provides a user-friendly interface for analysis of complex
metabolomics datasets without the need for specialist bioinformatics
skills, allowing for the rapid production of meaningful, interactive
results for biological interpretation of untargeted metabolomics data
sets.

ACKNOWLEDGEMENTS

The authors thank Gavin Blackburn, Isabel Vincent and Anubhav
Srivastava for testing and feedback. Example datasets were provided
by the Scottish Metabolomics Facility, funded by the Scottish
Universities Life Sciences Alliance (SULSA).

F unding: Australian National Health and Medical Research Council
postdoctoral training fellowship. Funding for A] was provided by an
Netherlands Organisation for Scientiﬁc Research NWO-VIDI grant
to RB.

Conﬂict oflnterest: none declared.

REFERENCES

Blekherman,G. et al. (2011) Bioinforrnatics tools for cancer metabolomics.
Metabolomics, 7, 3297343.

Breitling,R. et al. (2006) Precision mapping of the metabolome. Trends Biotech, 24,
5437548.

Brown,M. et al. (2011) Automated workﬂows for accurate mass-based putative
metabolite identiﬁcation in LC/MS-derived metabolomic datasets. Bioinformaties,
27,110871112.

Creek,D.J. et al. (2011) Towards global metabolomics analysis with Liquid
Chromatography-Mass Spectrometry: improved metabolite identiﬁcation by
retention time prediction. Anal. Chem, 83, 870378710.

Jankevics,A. et al. (2012) Separating the wheat from the chaff: a prioritisation pipeline
for the analysis of metabolomics datasets. Metabolomies [Epub ahead of print,
doi:10.1007/s11306-011-0341-0, July 30,2011].

Kind,T. and Fiehn,O. (2010) Advances in structure elucidation of small molecules using
mass spectrometry. Bioanal. Rev., 2, 23$0.

Madsen,R. et al. (2010) Chemometrics in metabolomicsia review in human disease
diagnosis. Anal. Chim. Acta, 659, 23733.

Moco,S. et al. (2007) Metabolomics technologies and metabolite identiﬁcation. Trends
Analyt. Chem, 26, 8557866.

Neumann,S. and Bécker,S. (2010) Computational mass spectrometry for metabolomics:
identiﬁcation of metabolites and small molecules. Anal. Bioanal. Chem, 398,
27792788.

P1uska1,T. et al. (2010) MZmine 2: modular framework for processing, visualizing, and
analyzing mass spectrometry-based molecular proﬁle data. BMC Bioinf., 11, 395.

R Development Core Team. (2008) R: a language and environment for statistical
computing. In R Foundation for Statistical Computing. R Development Core Team,
Vienna, Austria. http://www.R-project.org.

Scheltema,R. et al. (2009) Simple data-reduction method for high-resolution LCMS
data in metabolomics. Bioanalysis, 1, 155171557.

Scheltema,R.A. et al. (2011) PeakML/szatch: a File Format, Java Library,
R Library, and Tool-Chain for mass spectrometry data analysis. Anal. Chem, 83,
278672793.

Smith,C. et al. (2006) XCMS: processing mass spectrometry data for metabolite
proﬁling using nonlinear peak alignment, matching, and identiﬁcation. Anal. Chem,
78, 7797787.

 

112 /3.Io's[Bumo[pJOJXO'sotwurJOJutotqﬂ:duq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

