Bioinformatics, 32114), 2016, 2208—2209

doi: 10.1093/bioinformatics/btw205

Advance Access Publication Date: 22 April 2016
Applications Note

 

 

Sequence analysis

SAMFIRE: multi-Iocus variant calling for

time-resolved sequence data

C. J. R. Illingworth

Department of Genetics, University of Cambridge, Cambridge CBZ 3A8, UK

Associate Editor: Alfonso Valencia

Received on December 14, 2015; revised on March 25,2016; accepted on April 10, 2016

Abstract

Summary: An increasingly common method for studying evolution is the collection of time—
resolved short—read sequence data. Such datasets allow for the direct observation of rapid
evolutionary processes, as might occur in natural microbial populations and in evolutionary experi—
ments. In many circumstances, evolutionary pressure acting upon single variants can cause gen—
omic changes at multiple nearby loci. SAMFIRE is an open—access software package for processing
and analyzing sequence reads from time—resolved data, calling important single— and multi—Iocus
variants over time, identifying alleles potentially affected by selection, calculating linkage disequi—
librium statistics, performing haplotype reconstruction and exploiting time—resolved information to

estimate the extent of uncertainty in reported genomic data.

Availability and Implementation: C ++ code may be found at https://github.com/cjri/samfire/.

Contact: chris.illingworth@gen.cam.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

Introduction

Time-resolved genome sequence data provides direct information
about evolutionary processes. At low recombination rates, popula-
tions evolve via clonal competition, whereby linkage effects span-
ning multiple loci determine the outcome of adaptation (Neher and
Shraiman, 2009). The Samfire software extracts and processes
multi-locus information from time-resolved genomic data, so as to
shed light on underlying patterns of evolution.

Samfire includes a sequence processing pipeline filter that per-
forms quality control on short read data in aligned SAM format.
Similar to a previous approach to variant calling (Watson et (11.,
2013), individual reads are filtered by median base quality, trim-
ming sequence in order to achieve this, subject to a minimum read
length. Individual nucleotides that fall below a given quality thresh-
old are then removed, being replaced by blank ‘-’ alleles, to indicate
a lack of available information. Duplicate reads may be removed,
before paired-end reads are joined, any interval between paired
reads being spanned by blank alleles. The pipeline slitraj then calls
single-locus polymorphisms, filtering by the minimum number of re-
ported variant alleles, minimum observed allele frequency and a
statistical measure, assessing the probability of a polymorphism aris-
ing through sequencing error. Noting that across time, variants can

arise or die out in a population through mutation and selection,
observed allele counts are reported for polymorphic loci across all
time-points, even if a polymorphism is found only in a single sample;
we refer to these collected observations as the trajectory of an allele.
Alternatively, observation in multiple samples may be specified as a
condition for calling a polymorphism.

Having identified polymorphisms, the pipeline slinoise utilizes
the temporal resolution of the data to estimate the extent of noise in-
herent in the variant frequencies. Excluding trajectories in which an
exceptional amount of allele frequency change is observed, changes
in allele frequencies in other trajectories are assumed, conserva-
tively, to arise from noise alone. Under this assumption, a Dirichlet
multinomial distribution is characterized, obtaining the optimal ex-
tent of variance required to account for the observed deviations of
each trajectory from constancy. While approximate Bayesian meth-
ods may be used to characterize evolutionary behaviour without
such fitting (Foll et (11., 2014), estimation of a likelihood function
allows for techniques such as model selection to be used in discrimi-
nating between potential evolutionary scenarios.

In an optional step within the code, the pipeline slineutrality
allows the identification of trajectories exhibiting potentially non-
neutral evolutionary behaviour, using a simple model of allele fre-
quency change to identify trajectories potentially under constant or

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2208

/310‘Sjcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

1] Day 0 [I Day 175
El Day 49 El Day 266
E] Day 84 D Day 357
D Day 119 D Day 420

38
O
I
I
I
I
I
d)
42

1 . AAAATACATTGAAG
2 . GAAATACATTGAAG
3 . AAAATACATTAAAG
4 . AAAATACATTGAAA
5 . AAAATACATTGGAG
6 . GAAATACATTGGAG
7 . GAAATACATTAAAG
8 . AGAATACATTGAAG
9 . AAAATACACCGAAG



. AAAATACATTGGAA

GAAATACACCGAAG
GAAATACATTGGAA

. AGAATACGTTAAAG
. AGAATACGTTGAAG
. AAAATACGTTGAAG
. AAAATACAAAAAAG
. AGAATACAAAGGAG
. AGAATACAAAAAAG

Multi-Iocus haplotypes

19.
20.
21.
22.
23.
24.
25.
26.
27.

AGAATACAC C GAAG
AAAATACGTTAAAG
AGAACACGTTGAAG
GAAATAAATTGGAA
AGAATGCATTGGAG
AGAATACGTTGGAG
AGAACACGTTAAAG
GAAATACGTTAAAG
AGAATACGTTGGAA

111111g\\’()1‘tll(’[LIL., 2014

Fischer (7/ LIL, 2014 Tiipfcr (7/ LIL, 2013

Illingworth,

Figure 1

Gall (7/ LIL, 2013

2015

. AGAATGCAAAGAAG
. AGAATAAATTGGAG
. AGAATAAATTGGAA
. AGAATGCATTAAAG
. AGAATACGTTAAAA

GAAATAAATTGGAG

. AGGGTACGTTAAAA
. AGGGTACGTTAAAG
. AGCCTACGTTAAAG

N
0'1

. AGCCTACAAAGGAA
. AGCCTAAATTGGAG
. AGCCTACAAAGGAG

. AGGGTACAAAGGAG
. AGCCTACGTTAAAA
. AGGGTACGTTGGAG

 

/310'SIBano[pJOJxo"SOIJBMJOJutotq//:duq

