BlOlNFORMA TICS

Vol. 29 ISMB/ECCB 2013, pages i300—i307
doi:10. 1 093/bioinformatics/btt226

 

The RNA Newton polytope and learnability of energy parameters

Elmirasadat Forouzmand and Hamidreza Chitsaz*
Department of Computer Science, Wayne State University, Detroit, MI 48202, USA

 

ABSTRACT

Motivation: Computational RNA structure prediction is a mature im-
portant problem that has received a new wave of attention with the
discovery of regulatory non-coding RNAs and the advent of high-
throughput transcriptome sequencing. Despite nearly two score
years of research on RNA secondary structure and RNA—RNA inter-
action prediction, the accuracy of the state-of-the-art algorithms are
still far from satisfactory. So far, researchers have proposed increas-
ingly complex energy models and improved parameter estimation
methods, experimental and/or computational, in anticipation of
endowing their methods with enough power to solve the problem.
The output has disappointingly been only modest improvements, not
matching the expectations. Even recent massively featured machine
learning approaches were not able to break the barrier. Why is that?
Approach: The first step toward high-accuracy structure prediction is
to pick an energy model that is inherently capable of predicting each
and every one of known structures to date. In this article, we introduce
the notion of learnability of the parameters of an energy model as a
measure of such an inherent capability. We say that the parameters of
an energy model are learnable iff there exists at least one set of such
parameters that renders every known RNA structure to date the min-
imum free energy structure. We derive a necessary condition for the
learnability and give a dynamic programming algorithm to assess it.
Our algorithm computes the convex hull of the feature vectors of all
feasible structures in the ensemble of a given input sequence.
Interestingly, that convex hull coincides with the Newton polytope of
the partition function as a polynomial in energy parameters. To the
best of our knowledge, this is the first approach toward computing the
RNA Newton polytope and a systematic assessment of the inherent
capabilities of an energy model. The worst case complexity of our
algorithm is exponential in the number of features. However, dimen-
sionality reduction techniques can provide approximate solutions to
avoid the curse of dimensionality.

Results: We demonstrated the application of our theory to a simple
energy model consisting of a weighted count of A—U, C-G and G-U
base pairs. Our results show that this simple energy model satisfies
the necessary condition for more than half of the input unpseudo-
knotted sequence—structure pairs (55%) chosen from the RNA
STRAND v2.0 database and severely violates the condition for
~13%, which provide a set of hard cases that require further investi-
gation. From 1350 RNA strands, the observed 3D feature vector for
749 strands is on the surface of the computed polytope. For 289 RNA
strands, the observed feature vector is not on the boundary of the
polytope but its distance from the boundary is not more than one.
A distance of one essentially means one base pair difference between
the observed structure and the closest point on the boundary of the
polytope, which need not be the feature vector of a structure. For

 

*To whom correspondence should be addressed.

171 sequences, this distance is larger than two, and for only 11
sequences, this distance is larger than five.

Availability: The source code is available on http://compbio.cs.wayne.
edu/software/rna-newton-polytope.

Contact: chitsaz@wayne.edu

1 INTRODUCTION

Computational RNA structure and RNAiRNA interaction
prediction have always been important problems, particularly
now that RNA has been shown to have key regulatory roles in
the cell (Bartel, 2004; Brantl, 2002; Gottesman, 2005; Hannon,
2002; Storz, 2002; Wagner and Flardh, 2002; Zamore and Haley,
2005). Furthermore, with the advent of synthetic biology at the
whole organism level (Gibson et al., 2010), high—throughput
accurate RNA engineering algorithms are required for both
in vivo and in vitro applications (Seeman, 2005; Seeman and
Lukeman, 2005; Simmel and Dittmer, 2005; Venkataraman
et (11., 2007; Yin et al., 2008). Since the dawn of RNA secondary
structure prediction nearly two score years ago (Tinoco et al.,
1973), the research community has proposed increasingly
complex models and algorithms, hoping that refined features
together with better methods to estimate their parameters
would solve the problem. Early approaches considered mere
base pair counting, followed by the Turner thermodynamics
model, which was a significant leap forward. Recently, massively
feature—rich models empowered by parameter estimation algo—
rithms have been proposed, but they provide only modest
improvements.

Despite signiﬁcant progress in the last three decades, made
possible by the work of Mathews et a]. (1999) on measuring
RNA thermodynamic energy parameters and the work of several
groups on novel algorithms (Bernhart et al., 2006; Chitsaz et al.,
2009a, b; Dirks and Pierce, 2003; McCaskill, 1990; Nussinov
et al., 1978; Rivas and Eddy, 1999; Waterman and Smith,
1978; Zuker and Stiegler, 1981) and machine learning
approaches (Andronescu et al., 2010; Do at al., 2006; Zakov
et al., 2011), the RNA structure prediction accuracy has not
reached a satisfactory level yet (Rivas et al., 2012). Why is it
so? Up to now, human intuition and computational convenience
have led the way. We believe that human intuition has to be
equipped with systematic methods to assess the suitability of a
given energy model. Surprisingly, there is not a single method to
assess whether the parameters of an energy model are learnable.
We say that the parameters of an energy model are learnable iff
there exists at least one set of such parameters that renders every
known RNA structure to date, determined through radiograph
or NMR, the minimum free energy structure. Equivalently, we
say that the parameters of an energy model are learnable iff
100% structure prediction accuracy can be achieved when
the training and test sets are identical. The ﬁrst step toward
high—accuracy structure prediction is to make sure that the

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

/810'sleum0prOJxo'sopBLuJOJutotq”:duq

RNA Newton polytope

 

energy model is inherently capable, i.e. its parameters are learn—
able. In this work, we provide a necessary condition for the
learnability and an algorithm to verify it. The problem of learn—
ability was previously studied for sequence alignment using simi—
lar methods (Dewey et al., 2006). To the best of our knowledge,
this is the ﬁrst approach toward a systematic assessment of the
suitability of an energy model for RNA structure prediction.
Note that a successful RNA folding algorithm needs to have
the generalization power to predict unseen structures as well.
However, if an energy model is inherently incapable of predicting
known structures correctly, then it does not matter if it has the
generalization power. We leave analysis of the generalization
power for future work.

2 BACKGROUND

2.1 RNA secondary structure models

An RNA secondary structure model is often a context—free gram—
mar together with a scoring function for either the rules, in the
case of stochastic context—free grammars (SCFGs) (Eddy and
Durbin, 1994), or the alphabet, in the case of thermodynamics
models (Mathews et al., 1999). Such scoring functions induce
scoring on the entire generated language. The word with optimal
score then yields a predicted structure for the given sequence.
For the sake of brevity, we focus on thermodynamics models
in this article, but it is obvious that our methods apply to
other models including SCFG as well. In our context, the scoring
function is the thermodynamics free energy. A secondary struc—
ture y of a nucleic acid is decomposed into loops, a free energy
is associated with every loop in y and the total free energy G for y
is the sum of loop free energies (Mathews et al., 1999). The same
loop decomposition principle applies to interacting nucleic acids
such that the total free energy G is still the sum of the free
energies of loops and interaction components (Chitsaz et al.,
2009b).

2.2 Estimation of energy parameters

Generally, RNA structure prediction algorithms are divided into
probabilistic and non—probabilistic categories. Besides machine
learning approaches for the probabilistic methods, e.g. SCFGs,
which are evaluated in (Rivas et al., 2012), existing machine
learning algorithms for parameter estimation in the non—prob—
abilistic RNA structure prediction can be grouped into two
categories:

0 Likelihood—based methods, where the maximum likelihood
or maximum conditional likelihood principle is used to
estimate the parameters of the model (e.g. Do et al., 2006);
and

o Large—margin methods, where the model parameters are
estimated to maximize the margin between the score of the
true structure and the second best structure. This has been
done using an online passive—aggressive training algorithm
(Zakov et al., 2011) and Iterative Constraint Generation
(Andronescu et al., 2007).

The likelihood—based techniques estimate the best Gibbs distri—
bution, which not only assists in predicting the best secondary

structure but also is used in determining the thermodynamic
parameters. Besides some probabilistic methods (Rivas et al.,
2012), one of the most successful methods for learning the
thermodynamics of RNA has been the MCL method, as in
CONTRAfold (Do et al., 2006), which maximizes the probability
of RNA structures y given RNA sequences x for the training set
D. That is, the conditional log likelihood of the training data
(using the Boltzmann distribution) is maximized to estimate the
best model parameters h* 6 IR":

h 2: argmlax L(D; h) = mlax (Val) logp(y|x, h) (l)

67 G(x, y, h) /RT
17(ylx, h) 2= — (2)
Q(x, h)
where k denotes the number of different motifs deﬁned in the
energy model, R is the gas constant, T is the absolute tempera—
ture, G(x, y, h) is the free energy and

Q(x, h) :2 Z eiG(x,S,h)/RT (3)

se £(x)

is the partition function (Chitsaz et al., 2009b; Dirks and Pierce,
2003; McCaskill, 1990) with 8(x) being the ensemble of possible
structures of x. The free energy

G(x, S, h) 2: <c(x,s), h) (4)

is a linear function of the parameters h where C(X, s) e Z" is the
features vector.

The best performing method for RNA STRAND v2.0 is
Contextfold (Zakov et al., 2011). However, Contextfold per—
forms worse than other methods in other datasets that are struc—
turally different from RNA STRAND v2.0 (Rivas et al., 2012).
Essentially, it seems that Contextfold suffers from overﬁtting
because it uses a myriad of features in its model. A systematic
evaluation of the learnability using our algorithm in this article
may help design a more concise set of features that is powerful
enough to achieve high accuracy but not too powerful to suffer
from overﬁtting.

3 LEARNABILITY

The question that we ask before parameter estimation is ‘does
there ever exist parameters hI such that for every (x, y) e D,
y = argmin3G(x,s,hI)?’ If the answer to this question is no,
then there is no hope that one can ever achieve 100% accuracy
using the given model. The answer reveals inherent limitations
of the model, which can be used to design improved models.
We provide a necessary condition for the existence of hI and
a dynamic programming algorithm to verify it through comput—
ing the Newton polytope for every x in D. We will deﬁne the
RNA Newton polytope below. Not only our algorithm provides
a binary answer, it also quantiﬁes the distance from the bound—
ary. For our 3D model, this distance roughly captures the dif—
ference between the number of base pairs in the observed
structure and the number of base pairs in the closest point on
the boundary of the polytope. Note that the closest point on the
boundary of the polytope need not be the feature vector of a
structure.

 

i301

ﬁlO'SIIZLImOprOJXO'SOplZILLIOJLIIOIQ/[idnq

E.Forouzmand and H.Chitsaz

 

4 METHODS

4.1 Necessary condition for learnability

Let (X, y) e D and hIL 6 IR". Assume y minimizes G(X,s, hI) as a function
of s. In that case

G(X, y, hI) 5 G(X, s, 111), Vs e £(x). (5)
Replacing equation (4) above,

(C(X, y), hI) 5 (C(X,s),h1), Vs e £(x) (6)

0 5 (C(X, s) — C(X, y), hI), Vs e £(x). (7)

Deﬁne the feature ensemble of sequence X by
J:(X) := {C(X, s) | s e £(x)} c z". (8)
In that case, equation (7) implies that
o 5 (m) — C(x,y),hI)- (9)
We call the convex hull of f (X) the Newton polytope of X,
N(x) := conv{]—‘(X)} c ER". (10)

We remind the reader that the convex hull of a set, denoted by ‘conv’
hereby, is the minimal convex set that fully contains the set. The reason
for naming this polytope the Newton polytope will be made clear below.
Inequality equation (9) implies that C(X, y) e 3N (X) is on the boundary of
the convex hull of the feature ensemble of X with a support hyperplane
normal to h . Therefore, we have the following theorem.

THEOREM 1. Let (X, y) e D and 0 7E hIL 6 IR" . Assume y minim-
izes G(X, s, h ) as a function Ofs. In that case, C(X, y) e 3N(X), i.e. the fea-
ture vector of (X, y) is on the boundary of the Newton polytope of X.

PROOF. To the contrary, suppose C(X, y) is in the interior of N (X).
Therefore, there is an Open ball of radius 8>0 centered at C(X, y) com-
pletely contained in N (X), i.e.

35(C(Xay)) C N(X)- (11)
Let

h
17 = C(X,y)—(5/2)—T.
IIh II
It is clear that p e Ba(c(X,y)) C N(X) since ||p — C(X,y)|| = 6/2<8.

Therefore, 17 can be written as a convex linear combination of the feature
vectors in .7:(X) 2 {V1, ..., vN}, i.e.

Elal,...aNZO:a1v1+---+€¥NVN=17 (12)
a1+---+otN=l. (13)

Note that
(p—crx,y>,hi) = -(5/2)llhIII<0- (14)

Therefore, there is 1 5 i 5 N, such that (v, — C(X, y), hI)<0 for Otherwise,

N
(p — cm), hi) = 2011in — cm), hi) 2 o (15)

[:1
which would be a contradiction with equation (14). It is now sufﬁcient
to note that v, e f (X) and v, — C(X, y), h <0, which is a contradiction
with equation (9). CI

COROLLARY 1. (Necessary Condition for the Learnability). For
(X, y) e D, a necessary but not sufﬁcient condition for the existence of
h such that y minimizes G(X, s, h ) as a function of s is that c(X,y) lies on
the boundary of N (X) the Newton polytope of x.

4.2 Relation to the Newton polytope

In addition to D, the set of experimentally determined structures, we
Often have a repository of thermodynamic measurements, e.g. melting
curves, which can help better estimate the energy parameters.
Currently, Optical melting measurements are analyzed using a two-state
model (Siegfried and Bevilacqua, 2009). However, a more accurate ana-
lysis of such melting experiments can be done through relating the meas-
urements to the energy parameters through equations involving the
partition function and its derivatives with respect to temperature
(Chitsaz et al., 2009b). We show that with a change of variables, the
partition function becomes a polynomial. Therefore, such equations
become a system of polynomial equations the solving of which algebra-
ically requires computation of the Newton polytope of each polynomial
(Emiris, 1994; Emiris and Canny, 1995). Recall the partition function
deﬁned in equation (3) and energy in equation (4), and conclude

Q(X,h) = Z 87(C(X.s).h)/RTI (16)
seS(X)
Let C(X, s) = (61(X, s), ..., c),(X,s)) and h =(h1, ...,h),.). Deﬁne new
variables

2, := (“r/RT, 15 i 5 k (17)
and replace them in equation (16). We Obtain the partition function

Q(X’Z) : Z ZL’(X..\‘) 

seS(X)

in the form of a polynomial in [R[Z] where
k
ZL'(X..\') ::  
[:1

is a monomial as 0 5 c,(X, s) e Z. The Newton polytope of Q is defined
to be the convex hull of the monomials power vectors, i.e.

Newton{Q(X, 2)} := conv({ C(X, s) | s e £(x)}) = N(x). (20)
That is why we call N (X) the Newton polytope of X.

4.3 RNA Newton polytope algorithm

We give a dynamic programming algorithm to compute the Newton
polytope for a given nucleic acid sequence X. Denote the length of X by
L and the I'm nucleotide in X by n,-. Denote the subsequence of X from the
I'm to the j”' nucleotide, inclusive of ends, by n, - - - nj. The following lemma
allows us to formulate a divide-and-conquer strategy for computing the
Newton polytope, which will in turn lead to our dynamic programming
algorithm.

LEMMA 1. Let f and g be two polynomials in [R[Z]. The Newton
polytope of the product of f and g is the Minkowski sum of individual
Newton polytopes, and the Newton polytope of the sum of f and g is the
convex hull of the union of individual Newton polytopes, i.e.

Newton (fg) 2 Newton (f) 69 Newton (g) (21)

Newton (f+ g) = conv{Newton (f) U Newton (g)} (22)

in which 69 represents the Minkowski sum of two polytopes (Emiris, 1994).
This lemma allows us to use the same divide-and-conquer strategy that
was used for calculating the partition function (Chitsaz et al., 2009b;
Dirks and Pierce, 2003; McCaskill, 1990). We can use the same recursions
(grammar) as in the partition function algorithm but with the Minkowski
sum 69 instead of multiplication, convex hull of union instead of summa-
tion and the corresponding feature vector 6 instead of e’("~")/RT.
Furthermore, because union is invariant with respect to repetition of
points, the dynamic programming is allowed to be redundant, or equiva-
lently the grammar is allowed to be ambiguous. Hence, any complete

 

i302

ﬁm'spzumol‘pmgxo'sopeuuogutotq/ﬁdnq

an?kgogmomammowoxmomtocgawbmﬁ

 

an?kgogmomammowoxmomtocgawbmﬁ

 

55,2kgogmoddmmowoio~&o:~=£¢o~m\

 

an?kgogmomammowoxmomtocgawbmﬁ

 

RNA Newton polytope

 

energy parameters. Our algorithm has a worst case exponential
complexity due to the computation of the convex hull. However,
we envision efﬁcient approximation of the Newton ploytope
through topology—preserving dimensionality reduction methods.
Applying our method to increasingly complex models as well
as design of energy models using our analysis method will be
pursued in the future. Sufficient conditions for the learnability,
and also assessing the generalization power of an energy model,
remain for future work.

Conﬂict of Interest: none declared.

REFERENCES

Andronescu,M. et al. (2007) Efﬁcient parameter estimation for RNA secondary
structure prediction. Bioiry’ormatics, 23, 19728.

Andronescu,M. et al. (2008) RNA STRAND: the RNA secondary structure and
statistical analysis database. BMC Bioinformatics, 9, 340.

Andronescu,M. et al. (2010) Computational approaches for RNA energy parameter
estimation. RNA, 16, 230$2318.

Barber,C.B. et al. (1996) The quickhull algorithm for convex hulls. ACM Trans.
Math. Softw., 22, 46%483.

Bartel,D.P. (2004) MicroRNAs: genomics, biogenesis, mechanism, and function.
Cell, 116, 2817297.

Bernhart,S. et al. (2006) Partition function and base pairing probabilities of RNA
heterodimers. Algorithms Mol. Biol, 1, 3.

Brantl,S. (2002) Antisense—RNA regulation and RNA interference. Biochim
Biophys. Acta, 1575, 1&25.

Burge,S.W. et al. (2013) Rfam 11.0: 10 years of RNA families. Nucleic Acids Res.,
41, D2267D232.

Chitsaz,H. et al. (2009a) biRNA: fast RNA—RNA binding sites prediction. In:
Works/mp on Algorithms in Bioinformatics ( WABI). Vol. 5724, LNBI,
Springer—Verlag, Berlin, Heidelberg.

Chitsaz,H. et al. (2009b) A partition function algorithm for interacting nucleic acid
strands. Bioinformatics, 25, i36¥i373.

Dewey,C.N. et al. (2006) Parametric alignment of Drosophila genomes.
PLoS Comput. Biol, 2, e73.

Dirks,R.M. and Pierce,N.A. (2003) A partition function algorithm for nucleic acid
secondary structure including pseudoknots. J. Comput. Chem, 24, 16644677.

D0,C.B. et al. (2006) CONTRAfOld: RNA secondary structure prediction without
physics—based models. Bioinformatics, 22, 9&98.

Eddy,S.R. and Durbin,R. (1994) RNA sequence analysis using covariance models.
Nucleic Acids Res., 22, 207972088.

Emiris,I. (1994) Sparse elimination and applications in kinematics. Ph.D. Thesis,
UC Berkeley, Berkeley, CA.

Emiris,I.Z. and Canny,J.F. (1995) Efﬁcient incremental algorithms for the sparse
resultant and the mixed volume. J. Symbolic Compat, 20, 14719.

Gibson,D.G. et al. (2010) Creation of a bacterial cell controlled by a chemically
synthesized genome. Science, 329, 52756.

Gottesman,S. (2005) Micros for microbes: non—coding regulatory RNAs in bacteria.
Trends Genet., 21, 3994104.

Hannon,G.J. (2002) RNA interference. Nature, 418, 24¢251.

Mathews,D. et al. (1999) Expanded sequence dependence of thermodynamic
parameters improves prediction of RNA secondary structure. J. Mol. Biol,
288, 9117940.

McCaskill,J. (1990) The equilibrium partition function and base pair binding
probabilities for RNA secondary structure. Biopolymers, 29, 110&1119.

Nussinov,R. et al. (1978) Algorithms for loop matchings. SIAM J. Appl. Mat/1., 35,
68782.

Rivas,E. and Eddy,S. (1999) A dynamic programming algorithm for RNA structure
prediction including pseudoknots. J. Mol. Biol, 285, 205372068.

Rivas,E. et al. (2012) A range of complex probabilistic models for RNA secondary
structure prediction that includes the nearest—neighbor model and more. RNA,
18, 1937212.

Seeman,N. (2005) From genes to machines: DNA nanomechanical devices. Trends
Biochem. Sci., 30, 1197125.

Seeman,N.C. and Lukeman,P.S. (2005) Nucleic acid nanostructures: bottom—up
control of geometry on the nanoscale. Rep. Prog. Phys, 68, 2377270.

Siegfried,N.A. and Bevilacqua,P.C. (2009) Thinking inside the box: designing,
implementing, and interpreting thermodynamic cycles to dissect cooperativity
in RNA and DNA folding. Methods Enzymol, 455, 3657393.

Simmel,F. and Dittmer,W. (2005) DNA nanodevices. Small, 1, 28¢299.

Storz,G. (2002) An expanding universe of noncoding RNAs. Science, 296,
126(k1263.

Tinoco,I. et al. (1973) Improved estimation of secondary structure in ribonucleic
acids. Nat. New Biol, 246, 4(F41.

Venkataraman,S. et al. (2007) An autonomous polymerization motor powered by
DNA hybridization. Nat. Nanotechnol, 2, 490—494.

Wagner,E. and Flardh,K. (2002) Antisense RNAs everywhere? Trends Genet, 18,
2237226.

Waterman,M.S. and Smith,T.F. (1978) RNA secondary structure: a complete
mathematical analysis. Math. Biosci., 42, 2577266.

Yin,P. et al. (2008) Programming DNA tube circumferences. Science, 321, 8244526.

Yoshpe,M. (2006) Distance from a point to a 2D polygon. http://www.mathworks.
com/matlabcentral/ﬁleexchange/ l 2744-distance—from—a—point—to—polygon (14 May
2013, date last accessed).

Zakov,S. et al. (2011) Rich parameterization improves RNA structure prediction.
In: Bafna,V. and Sahinalp,S. (eds.) Proceedings of the 15111 Annual International
Conference on Research in Computational Molecular Biology, Vol. 6577, Lecture
Notes in Computer Science. Springer, Berlin—Heidelberg, pp. 54(r562.

Zamore,P.D. and Haley,B. (2005) Ribo—gnome: the big world of small RNAs.
Science, 309, 151971524.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA sequences
using thermodynamics and auxiliary information. Nucleic Acids Res., 9,
1337148.

 

i307

ﬁle'spzumol‘progxo'sopeuuogurorq/pdnq

