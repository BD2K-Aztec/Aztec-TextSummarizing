ORIGINAL PAPER

Vol. 29 no. 23 2013, pages 3073-3079
doi:1 0. 1093/bioinfonnatics/btt540

 

Systems biology

Advance Access publication September 17, 2013

Shaping the interaction landscape of bioactive molecules

David Gfeller‘, Olivier Michielin1'2'3'* and Vincent Zoeie1 '*

1Swiss Institute of Bioinformatics (SIB), Quartier Sorge, Batiment Genopode, CH-1015 Lausanne, Switzerland, 2Ludwig
Institute for Cancer Research and 3 Pluridisciplinary Center for Clinical Oncology, Centre Hospitalier Universitaire Vaudois,

CH-1015 Lausanne, Switzerland
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Most bioactive molecules perform their action by inter-
acting with proteins or other macromolecules. However, for a signifi-
cant fraction of them, the primary target remains unknown. In addition,
the majority of bioactive molecules have more than one target, many
of which are poorly characterized. Computational predictions of bio-
active molecule targets based on similarity with known ligands are
powerful to narrow down the number of potential targets and to
rationalize side effects of known molecules.

Results: Using a reference set of 224412 molecules active on 1700
human proteins, we show that accurate target prediction can be
achieved by combining different measures of chemical similarity
based on both chemical structure and molecular shape. Our results
indicate that the combined approach is especially efficient when no
ligand with the same scaffold or from the same chemical series has yet
been discovered. We also observe that different combinations of simi-
larity measures are optimal for different molecular properties, such as
the number of heavy atoms. This further highlights the importance of
considering different classes of similarity measures between new
molecules and known ligands to accurately predict their targets.
Contact: olivier.michielin@uniI.ch or vincent.zoete@unil.ch
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 2, 2013; revised on September 4, 2013; accepted on
September 12, 2013

1 INTRODUCTION

A large number of small molecules ranging from metabolites to
signaling molecules to drugs display strong bioactivity in differ-
ent living systems. This activity is often mediated by physical
interactions with proteins or other macromolecules. Therefore,
information about the targets of bioactive molecules is crucial to
understand, predict and interfere with their activity. In particu-
lar, it can be used (i) to predict unfavorable side effects due to
off-target interactions and thus potentially decrease the attrition
rate in clinical trials due to toxicity (Kola and Landis, 2004;
Lounkine et al., 2012), or (ii) to predict a new target for an
approved drug and reposition it for another disease (Ashburn
and Thor, 2004; Keiser et al., 2009; Novac, 2013).
Experimental identiﬁcation of bioactive molecule targets has
received much attention (Ziegler et al., 2013). This has led to
technological developments of large facilities enabling re-
searchers to screen a given molecule against arrays of targets,

 

*To whom correspondence should be addressed.

such as kinases. Chemogenomic strategies have also been intro-
duced to identify the targets of bioactive molecules in model
organisms such as yeast or bacteria (Smith et al., 2010).
Several databases have been developed by various groups to pro-
vide access to these data, such as ChEMBL (Gaulton et al.,
2012), DrugBank (Knox et al., 2011), PubChem (Bolton et al.,
2008) or ZINC (Irwin et al., 2012). These databases contain un-
precedentedly large datasets of interactions between proteins and
small molecules. For instance, only for human protein ligands,
the ChEMBL database (Gaulton et al., 2012) contains close to
350 000 reported direct interactions (i.e. annotated as binding)
with activity <10 uM involving >200 000 small molecules.

However, a signiﬁcant fraction of bioactive molecules still do
not have any known target. This is especially true for compounds
tested uniquely in functional assays. For instance, 17.4% of the
compounds in ChEMBL with reported functional activity in
human cells do not have direct target information (see
Methods Section 2.1). Moreover, even for well-studied mol-
ecules, our knowledge of their targets is far from complete.
For instance, N,N—dimethyltryptamine was initially described
as a ligand of sigma-1 receptor (Fontanilla et al., 2009). Later
on, it was shown to also bind hydroxytryptamine receptors
(Keiser et al., 2009). More generally, one can expect that even
a signiﬁcant fraction of Food and Drug Administration (FDA)-
approved drugs have at least some unknown target.

Computational predictions of bioactive molecule targets are
helpful to narrow down the set of potential targets to be tested
and to predict off-target effects of known molecules or drugs
(Keiser et al., 2009; Kuhn et al., 2013; Lounkine et al., 2012).
A widely used strategy consists in identifying proteins with
known ligands similar to a query molecule (i.e. the so-called
‘ligand-based’ approach). Standard approaches use similarity
measures between molecules based on chemical ﬁngerprints
(Dunkel et al., 2008; Keiser et al., 2009; Wang et al., 2013).
Historically, ﬁngerprint similarity measures have been developed
to classify molecules into families. Thus, they are powerful to
identify molecules derived from the same chemical series.

More recently, other measures of similarity have been intro-
duced (Ballester and Richards, 2007; Perez-Nueno et al., 2012;
Rahman et al., 2009). For instance, it is known that the 3D shape
of molecules plays an important role when binding to a target.
Therefore, the ligands of a protein often display similarity in
their shape. This similarity can be quantiﬁed by methods based
on structural alignment (Gong et al., 2013; Liu et al., 2011;
Sastry et al., 2011) or shape recognition (Ballester and
Richards, 2007; Ballester et al., 2009; Wirth and Sauer, 2011),

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 3073

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} pQPBOIII/IAOG

9103 ‘Og isnﬁnV uo ::

D. Gfeller et al.

 

such as Ultrafast Shape Recognition. The latter technique was
recently expanded to consider partial charges distribution
(Armstrong et al., 2010) and atomic lipophilicity (Armstrong
et al., 2011). A very attractive feature of shape comparison is
the ability to detect similarities between molecules with different
chemical structures, a property often referred to as ‘scaffold
hopping’ (Renner and Schneider, 2006). Despite this advantage,
previous studies suggest that fingerprint similarity gives higher
performance, both in Virtual screening (Venkatraman et al.,
2010) and in target predictions (Nettles et al., 2006). Yet, it is
unclear whether this is due to limitations of shape comparison
(e.g. limited conformational sampling, shortcomings of shape
descriptors) or to biases in benchmarking datasets (e.g. over-
representation of ligands from the same chemical series).

Other approaches to predict targets of bioactive molecules
have been proposed based on higher-level features such as side
effects (Campillos et al., 2008), transcriptional responses (Iorio
et al., 2010; Iskar et al., 2013) and text-mining (Li et al., 2009).
Although these approaches are powerful to identify similarities
between molecules without chemical similarity, they require add-
itional experimental data and therefore are limited to molecules
for which such data are available. For proteins with known
structures, binding site similarity can be used to identify proteins
that could accommodate similar ligands (Haupt and Schroeder,
2011). Moreover, in this case, docking algorithms (Grosdidier
et al., 2011; Morris et al., 2009; Zoete et al., 2009) can help
predict whether a molecule can bind to a target (Li et al.,
2006; Wang et al., 2012).

Here, we develop an original method of bioactive molecule
target predictions that combines chemical and shape similarity
(see Fig. 1). We perform extensive validation of the method and
show that combining these two similarity measures leads to im-
proved performance. This is especially true when predicting the
targets of a molecule in the absence of other ligands originating
from the same chemical series. Thus, our results suggest that the
lower performance of shape similarity measures that was previ-
ously reported, is, at least partly, due to biases in available

[I] ChEMBL molecules+interacli0ns

lli) Data ﬁtteting +qua|itycheck

 

 

 

[lilJ ‘ Compute shape similarities l I Compute ﬁngerprints similarities ‘
llvl ‘ Target predictions l ‘ Target predictions l

 

         

Iv) Combine scores (legit tag.)

Target prediclions with combined scores

Fig. 1. General workﬂow. (i) Molecules interacting with human targets
are retrieved from ChEMBL. (ii) Filters are applied to remove large
molecules and ambiguous interactions. (iii) The different similarities are
computed for all pairs of molecules. (iv) Targets are predicted based on
the most similar ligands excluding comparison with the query molecule,
ligands with the same scaffold or tested in the same assays. (v) Regression
coefficients are learned on the training set. (vi) Targets are predicted for
molecules on the testing sets (10-fold cross-validation) and average AUC
values over these molecules are computed. Steps (v) and (vi) apply only
for the combined approach

lU‘foId
cross-

, validation
[vi]

benchmarks (Cleves and Jain, 2008). Nevertheless, ﬁngerprint-
based methods still perform well even after stringent removal of
all molecules that are trivially similar (e. g. with the same scaf-
fold). We also observe that different combinations of similarity
measures are optimal for different molecular properties.

2 METHODS

2.1 Datasets

Release 15 of the ChEMBL database (Gaulton et al., 2012) was used
throughout this work. Interactions were selected according to the follow-
ing criteria: they should (i) involve human proteins, (ii) be annotated as
direct binding (‘assay_type’ = ‘B’) with an activity (Ki, Kd, IC50 or ECSO)
<10 uM, (iii) involve molecules consisting of <80 heavy atoms and (iv)
involve targets that are single proteins or protein complexes (e.g. exclud-
ing targets corresponding to protein families and assays with a conﬁdence
level <4). We further discarded ambiguous interactions that had reported
activity values both below and above 10 uM in different assays. This was
done to address the observed uncertainty of many proteinismall molecule
interaction datasets (Kramer et al., 2012). This results in a set of 347 889
interactions involving 1700 human proteins (1627) or protein complexes
(73) and 224 412 molecules. As an additional benchmark, we also
retrieved all ChEMBL molecules interacting with human proteins only
with activities between 10 uM and 100 uM (i.e. none of them are part of
the previous set of molecules). This consists of 79 682 molecules involved
in 94 672 interactions (see Section 3.4). For all molecules, SMILES were
retrieved from ChEMBL using the parent form.

To compute the fraction of molecules with functional activity but
without direct target, we retrieved all molecules involved in assays with
assay_type= ‘F’ in human using the same threshold of 10 uM (340 256
molecules in total). In all, 59311 of them (17.4%) do not have direct
targets in ChEMBL based on the two criteria: (i) no binding data or
only binding activity >1000 uM, and (ii) target_type equal to
‘ORGANISM’, ‘CELL-LINE’, ‘TISSUE’ or ‘ADMET’.

When determining whether two molecules have been tested in the same
assay, all ChEMBL assays involving a human target were considered.

2.2 Ligand similarity measures

Shape similarity is deﬁned as in the study by Armstrong et a]. (2011).
Each atom of a molecule is mapped to a SD space, where the three ﬁrst
coordinates are determined by the 3D conformation of the molecule. The
two remaining dimensions encode the atomic partial charges and the
atomic lipophilicity (AlogP). Shape comparison is carried out by compar-
ing the three ﬁrst moments of the distribution of 5D-distances of every
atom of the molecule to six different centroid positions (Armstrong et al.,
2011). Gasteiger atomic partial charges and contributions to molecular
lipophilicity (AlogP) have been determined with the ChemAxon cxcalc
tool (version 5.3.1) and OpenBabel (version 2.2.0), respectively. All
other parameters correspond to the ones in the original publications
(Armstrong et al., 2010, 201 1). A maximum of 20 different conformations
have been generated for each molecule with ChemAxon cxcalc tool, after
converting the SMILES from ChEMBL in 3D using the Chemaxon mol-
convert tool, and protonating it at pH = 7.4, using OpenBabel. For this,
OpenBabel calculates which species (protonated or unprotonated) is pre-
ponderant at pH=7.4 with the HendersoniHasselbalch equation, and
adjusts the number of protons and the charge of the molecule accord-
ingly. Each conformation of a molecule was compared with each con-
formation of another one (resulting in 400 comparisons) and the highest
similarity value was chosen. To avoid storing all similarity values between
all pairs of molecules (>5 x 1010 numbers), similarity values <0.65 have
been set to 0.65 and are not stored explicitly. The ﬁngerprints similarity
measure used in this work is based on the FP2 ﬁngerprints implemented

 

3074

112 /310's112u.tn0[p10}x0"sotJButJOJutotq/ﬁduq uteri pQPBOIH/IAOG

9103 ‘Og isnﬁnV uo ::

Shaping the interaction landscape of bioactive molecules

 

CHEMBL45515

CHEMBIJSESD?
 it

. if c .
5131. 1.43:. j-w
VumgrgakﬂT-tw

. L a
{ex/3*m‘g (ytlindapandznl “'J}-'iw-\
“rs/x klnasel v  alpharlH subuni:

 

 

calcium (hannel

    

(Hmatizaorez ‘ \ CHEMBLIElWI (4
“ " ' . \
K .. a
IGSIYDBJ ‘  m I 
..r\, . W ,~ . ._,L_.‘
 cHEMlsmmsss y “‘j
cHEMtatimvas “1’
C CHEMELmiés? D CHEMEL226669 (Haj
D "' u
T

mm i'._';‘

I": 5‘ W L 57-. :i ..
9 E5) ’ I V p n \fiﬁ. g
, r , .

.1 / . 
‘ P” z “Wmn‘ﬂl‘bﬁn‘l'f .. '
K .i k x and «mm 2
‘- x \
r MA).

(HEMBL177I765 9:9: ‘ ‘

     
 
    

CH EMBLIB'I 2012

"x CHEMBL27245 CHEMMMH '

Fig. 2. Target predictions for four molecules with exactly one target in
ChEMBL. Query molecules are shown on the left. Actual target names
are displayed in black circles. Ligands displaying the highest similarity
according to their shape or their ﬁngerprints are displayed above (black
arrow) or below (red arrow), respectively. Bold numbers correspond to
the target rank using each similarity measure. Numbers in parenthesis
show the rank of the ligands when computing similarity with all other
molecules in ChEMBL. Green numbers show the target ranks obtained
with the combined approach. A: shape similarity performs best. B: ﬁn-
gerprint similarity performs best. C and D: combining the two similarity
values give the best predictions

in OpenBabel (version 2.2.0). Fingerprints are calculated directly from the
molecular SMILES. Similarity between two molecules is measured as the
Tanimoto coefﬁcient. Similarity values lower than a threshold (here 0.25)
have been set to 0.25 to allow us storing only a sparse version of the full
similarity matrix. Figure 2 shows examples of ligands with shape and
ﬁngerprint similarity.

2.3 Scaffold identiﬁcation

Molecular scaffolds were uniquely identiﬁed with the Strip-itTM software
(version 1.0.1) from Silicos-it. Here we used the OPREA-l deﬁnition of
molecular scaffolds (Pollock et al., 2008), where any cycle is represented
as an n-membered ring (n23, 4,. . .), linkers between cycles as single
bonds and all side chains are removed (Fig. 3). Based on visual inspec-
tion, this approach provided the most reasonable deﬁnition of scaffolds.
Nevertheless, some important limitations arise, e.g. if aromatic rings are
used as side chains within a series of molecules (Fig. 3).

2.4 Combining different similarity measures

To combine different similarity values, we used a multiple logistic regres-
sion, as implemented in R (bayesglm). The features used as inputs corres-
pond to the similarity values based on shape and ﬁngerprint similarities
with either the most similar molecule (K = 1) or the K most similar ligands
of each target (K: 5). For K: 1, the logistic regression is given by the
following equation: f(s1, s2) = (1+exp[-a0-a1s1-a2s2])’I, where S] stands for
the shape similarity, S2 for the ﬁngerprint similarity and a0, a1 and a2 are
parameters learned by the model. In particular, a,- (i = 1, 2) is proportional
to the slope of f(s1, S2) along the 1” axis at the inﬂexion point. To enable
comparison between coefﬁcients a] and a2, similarity values have been
normalized between 0 and 1. Neural networks as implemented in R
(nnet package, with one hidden layer consisting of two nodes) were also
tested when using similarity with the K = 5 most similar ligands as input.

For the cross-validation, molecules were split in 10 different groups.
Training of the model was done iteratively on nine groups and tested on
the remaining one. A well-known issue when training and benchmarking

 

Scaffolds

 

Hg “1% w H

 

 

 

 

 

 

CHEMBLZIIaet CHEMBL'MPSN . CHEMBLSSWST CHEMBLIWQDB? oizuaLiwa'm
‘ . . ..._...._  .  ._.   .. .

 

Morecules

F

 

 

 

CHEﬂeLZIszne wewmms

 

Fig. 3. Subset of neuropilin-l (CHEMBL5174) ligands. Blue boxes show
the molecules with the same scaffolds as deﬁned with OPREA-l (see
Methods). Scaffolds are displayed above the dashed line. Red boxes
show the molecules tested in the same assays. All other neuropilin-l
ligands would fall in the ﬁrst column

binary classiﬁers of interactions is to have reliable negative data. Here we
used negative data generated as follows. First, we retrieved all molecules
in ChEMBL with binding activity >500 uM on some target (1799 inter-
actions involving 1214 molecules). As these numbers are too low to train
a model, we then randomly selected non-interacting ligandiprotein pairs
so as to have 10 times more non-interacting pairs than interacting pairs.
In this selection, non-interacting pairs involving a protein with a paralog
(BLAST E-value <10’5) reported to interact with the query molecule
were excluded from the list of negatives, as they could result from incom-
pleteness in the ChEMBL database. Moreover, we further excluded all
interacting pairs that have activity values between 10 and 100 11M, or for
which a paralog of the protein has activity between 10 and 100 uM with
the query molecule.

The performance was measured with standard receiver operating char-
acteristic (ROC) curves and area under the ROC curve (AUC). AUC
values displayed in this work always correspond to the average of AUC
values over all molecules. As our dataset is large and the number of model
parameters small, we typically used a subset of molecules consisting of
molecules with annotated non-interactions (>500 uM, see earlier in the
text) to which 1000 randomly selected ligands were added. We observe
in Supplementary Figure S] that this approach is sufﬁcient to compare
different similarity measures. Similarly, when training models on different
sets of molecules (e.g. based on properties such as the number of heavy
atoms), all molecules with negative data were ﬁrst considered and up to
1000 randomly selected molecules with the desired properties were added.

3 RESULTS

Identifying proteins with ligands similar to bioactive molecules is
a strong indication of possible direct interactions that could pre-
dict or explain observed bioactivity. Here, we use the ChEMBL
database to collect known ligands of human proteins and we
explore different similarity measures, based on chemical structure
(Fingerprints) and molecular shape (Electroshape) (Armstrong
et al., 2011), as well as combinations of these (see Methods).
Target prediction is carried out following the workﬂow of
Fig. 1. A query molecule is compared with all other molecules
in ChEMBL to assign a score to each target corresponding to the
similarity value with the most similar ligand. When combining
different measures of similarity, we use logistic regressions to
combine the similarity values obtained with each similarity meas-
ure (see Methods).

To illustrate the different strategies investigated in this work,
in Figure 2, we show examples of ligands whose target is best
predicted by shape similarity (Fig. 2A), ﬁngerprint similarity

 

3075

112 /310's112u.tn0fp101x0"sotwutJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

D. Gfeller et al.

 

(Fig. 2B) as well as combination of both (Fig. 2C and D). In
(Fig. 2A), the query molecule (CHEMBL1240762) has only one
reported target (CDKl, IC50=2.5uM), and no other ligand
of this protein is a simple analog of this molecule. Therefore,
predictions based on fingerprint similarity rank this target at
position 168 among all 1700 possible targets. Shape similarity
instead identiﬁes a ligand of CDK1 that displays similar overall
shape and partial charges distribution, and based on the similar-
ity with this molecule, CDKl is ranked at the ﬁfth position
among all targets. Figure 2B shows a frequently encountered
case, in which a clear analog (CHEMBL1210985) of the query
molecule is present among the ligands of its target. In this case,
ﬁngerprint similarity is more appropriate. In particular, the miss-
ing hydroxyl groups in the most similar ligand detected by the
ﬁngerprint similarity (CHEMBL1210985) result in lower shape
similarity that prevents accurate predictions. This example high-
lights some of the possible weaknesses of shape comparison and
already suggests that combining different similarity measures is
useful to optimally harness the information present among the
ligands of a target. As examples of the combined strategy, we
show in Figure 2C and D, typical cases where combining the two
kinds of similarity results in better predictions. Here, both shape
and fingerprint similarity values give reasonable predictions, with
the cognate target being ranked between the 9th and 29th pos-
ition. However, combining the two kinds of similarities results in
signiﬁcantly better performance, indicating how the presence
of different ligands similar to the query molecule according to
both similarity measures gives even higher conﬁdence in the
predictions.

More generally, Table 1, ﬁrst row, shows the average cross-
Validation AUC values over all tested ligands. We can observe
that fingerprint similarity performs better than shape similarity
and the combined approach leads to the highest AUC, although
all three approaches give very high AUC values. However, as
discussed in the next section, these high AUC values mainly
result from the habitual design of chemically related molecules
to target the same protein. In particular, cases of close analogs
among the ligands of a target (see example in Fig. 2B) appear
very often in ChEMBL.

3.1 Addressing redundancy in benchmarking datasets

A major issue in benchmarking ligand-based target prediction
methods comes from the strong biases observed in sets of pro-
teiniligand interactions (Cleves and Jain, 2008; Rohrer and
Baumann, 2008; Yera et al., 2011). The standard strategy used
in drug design or medicinal chemistry projects is to start from a
lead compound and replace one by one the different fragments of
this compound (Cleves and Jain, 2008). Therefore, a set of lig-
ands targeting a protein consists often of highly similar molecules
belonging to the same series (see Fig. 3). As a result, ligand-based
approaches trained on such datasets tend to give over-optimistic
predictions. For practical applications, it is important not to be
restricted to this kind of direct similarity, as new bioactive mol-
ecules for which targets are to be predicted may typically not be
part of existing series. Similarly, when attempting to predict off-
target effects of existing drugs, it is unlikely that molecules from
the exact same series have already been tested on the new targets
W era et al., 2011). These biases have been identified in smaller

Table 1. AUC values for different similarity measures and different com-
parison schemes

 

 

Comparison Shape Fingerprints Combined
All comparison 0.985 0.993 0.994
Distinct scaffolds 0.943 0.971 0.979
Distinct scaffolds + distinct assays 0.894 0.921 0.932

 

datasets, for instance, by observing a higher chemical similarity
between molecules having the same primary targets compared
with those having the same secondary targets (Cleves and Jain,
2008).

To address these issues, we ﬁrst used information about the
scaffold of molecules, as molecules of the same series often dis-
play a conserved scaffold (Pollock et al., 2008; Schuffenhauer
et al., 2007). We reasoned that, when making predictions for a
given compound, molecules with the same scaffold may typically
not be present among the ligands of its targets. Therefore, we
prevented comparison between molecules with the same scaffolds
that are ligands of the actual targets in our cross-validation study
(see Methods). Table 1, second row, shows the obtained AUC
values. As expected, AUC values are lower than before. This
further confirms that the very high AUC values reported in the
first row of Table 1 are merely a consequence of the high level of
redundancy among ligands in our dataset, and are only relevant
if the query molecule is part of a well-known chemical series.

Although clustering molecules with respect to their scaffold
helps identifying those coming from the same series, we still ob-
serve several cases of highly similar molecules that clearly come
from the same series but have different perceived scaffolds (see
example in Fig. 3). This is a well-known limitation of using scaf-
folds to unveil chemical series. However, to the best of our know-
ledge, there is no uniﬁed computational method that can unravel
the chemical series among any set of molecules. Fortunately, in
our case, we can use historical information present in ChEMBL,
and especially assay numbers that can provide further clues
about chemical series. Thus, as a second ﬁlter, we also prevented
comparisons between molecules that had been tested in the same
assay (see Methods). While this approach cannot fully exclude
comparisons between molecules from the same series, Visual in-
spection of many speciﬁc targets indicates that it already ﬁlters
out many cases (see Fig. 3). The AUC values obtained when
preventing comparison between molecules with the same scaf-
folds or tested in the same assay are shown in Table 1, third
row. The same trend as before can be observed: the more we
prevent comparisons between molecules from the same series, the
lower the AUC. Importantly, we can observe that combining the
two methods leads to signiﬁcant improvements. This clearly sug-
gests that the two approaches are complementary and combining
them is useful to optimally capture the information present
among the ligands of a target.

3.2 Inﬂuence of ligand properties

Different similarity measures may show different performance
depending on the characteristics of the molecules. Here we

 

3076

112 /310's112u.tn0fp101x0"sotwutJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Shaping the interaction landscape of bioactive molecules

 

Di51inti. scaffolds

A All comparisons B Distinct scaffolds C

 

 

   

 

 

 

 

 

and assa
§ § § "
g 3 3.
Q o u
3. 3.
U s o a
:1 5 "‘ a?
4 E a
a a
a — Shape E — Shape 2 — shape
a — Fingerprints R — Fingerprinls R 7 Fingerprints
P — combined :5 — combined ci — (omb‘ined
a 2 2
E o' a
1D 20 30 an 50 60 ll] 20 30 40 50 6|] 10 20 in 1D 50 60

 

2
10
1C!

a
70' _a
7a; —G:

15
5
IS

Regression parameters C
5 10
5 IO
5 10

l

O
[I
D

 

 

 

 

 

 

 

102930105060 102010105060 102090405060
Number of heavy atoms Number of heavy atoms Number of heavy atoms

Fig. 4. AUC values for different molecule sizes. (A) The data obtained
with the full ChEMBL dataset, (B) when restricting comparison to mol-
ecules with different scaffolds and (C) when restricting comparison to
molecules with different scaffolds and not tested in the same assays.
Note the different y-axis scales. (D—F) regression coefﬁcients for the
combined approach

investigate how the number of heavy atoms, the absolute total
charge and the lipophilicity (logP) affect our predictions. We ﬁrst
cluster all 224 412 molecules investigated in this work according
to their number of heavy atoms and trained separate linear re-
gression models for each group. Figure 4A7C shows average
cross-validation AUC values as a function of the number of
heavy atoms for the three comparison schemes studied here.
We observe that predicting targets of smaller molecules is more
challenging. Moreover, our results indicate that combining dif-
ferent similarity measures is especially useful for molecules with
530 atoms, which corresponds approximately to half of the
bioactive molecules targeting human proteins in ChEMBL
(Fig. 5A), and to the majority of FDA-approved drugs
(Fig. 5B). To gain further insights into the inﬂuence of the
ligand size, we show in Figure 41}F, the evolution of the two
logistic regression coefﬁcients a; and a2 (see Methods). The
higher these coefﬁcients, the more discriminative the similarity
value is for the predictions. We can observe that the two coefﬁ-
cients take similar values for small molecules, but coefﬁcient a2
(associated with fingerprint similarity) increases, whereas coefﬁ-
cient a1 (associated with shape similarity) gently decreases with
molecule sizes, further suggesting that shape similarity mainly
helps discriminating interacting from non-interacting pairs
for smaller size molecules. In one case (number of heavy
atoms=42), the fingerprint similarity was enough to drive the
predictions, and a1 takes values close to 0 or negative.

We also analyzed the effect of the absolute total charge and
the lipophilicity (logP). Apart from being important properties of
many ligands, we note that Electroshape similarity was de-
veloped to include partial charges and lipophilicity in the shape
description (Armstrong et al., 2011). Therefore, one could expect,
for instance, that this similarity measure will perform better on
predicting targets of charged molecules for which the presence of
a charged group plays an important role. Overall, we do not
observe a clear inﬂuence of these two molecular properties on
our predictions. When grouping ligands according to the charge,
the performances are not markedly different and optimal

 

 

 

 

   

Aisooo i I .. . . 3100‘ . I. i I .
I _ l
I
BULL I 7
‘3 IDDUO
a aan
*3 i
3:, 401-
a 5000 1
20;—
D  ,i .
0 20 40 60 BO 0 20 40 60 80

Number of heavy atoms Number of heavy atoms

Fig. 5. (A) Distribution of the number of heavy atoms of ChEMBL
molecules and (B) FDA-approved drugs. Dashed bars indicate the
median

combinations of the two similarity measures are similar for dif-
ferent absolute charges (see Supplementary Fig. S2). When con-
sidering ligands with different lipophilicity, we can observe
different behaviors for different logP values (Supplementary
Fig. S3). However, these differences are largely explained by
the correlation (r2045) between the logP and the number of
heavy atoms for the molecules present in our dataset
(Supplementary Figs S4 and S5, and Supplementary Method
S1). This suggests that lipophilicity has only a minor impact on
our predictions. Overall, it appears that building separate models
(here logistic regressions) for different numbers of heavy atoms is
useful and informative, but not for different absolute total
charges or logP values.

3.3 Similarity with many ligands

So far, we have based our predictions on the ligand of each target
that displays the highest similarity with the query molecule, neg-
lecting information about other ligands. However, one could
imagine that being similar to several ligands could give higher
conﬁdence in the predictions. To explore this aspect, we trained a
regression model using as features the similarities with the K = 5
most similar ligands of each target. If less than K ligands are
known for a target, the minimal similarity value was used for all
missing values. Results in Figure 6A7C indicate that only very
little, if any, improvement is obtained. In this case, the number of
parameters is larger (5 for each kind of similarity and 10 when
combining them), suggesting that more elaborate machine learn-
ing models may prove beneficial. We also trained a neural net-
work (see Methods), but did not observe any improvement either
(see Supplementary Fig. S6).

3.4 Predicting lower afﬁnity targets

To complement the previous cross-validation studies, we ana-
lyzed the set of molecules in ChEMBL that only have reported
binding data between 10 and 100 uM. These molecules are not
part of the training set and can be used to independently test our
method. Figure 61}F shows the AUC values obtained for dif-
ferent numbers of heavy atoms, using the regression coefﬁcients
of Figure 4F for the combined approach. AUC values are lower
than in cross-validation studies as expected, as molecules with
lower afﬁnity display less similarity with other ligands of their
cognate target. Importantly, the general trend that combining
different kinds of similarity measures yields more accurate

 

3077

112 /310's112u.tn0fp101x0"sotwutJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

D. Gfeller et al.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A _ B _ _ c Distinct scaffolds
8 All comparisons a Distinct scaffolds 8 and 5521.5
—  ; .77"wa ; i
g “W W» a “1m 6 .
d d / WV"
3 E . 3 WW/ ' \p
u e m m 
a , — KS Slurp: g. 7 Kigvape g i 7 Hist-ape
g 7 K5 Flnqerpllnll c. I — Kirmgeiprinu c. — itsringeiprinu
I 7 K5 combinrd g — K5_(ol'llhned 3 — KS_Comhdld
g  Shape m  shape .5  Shape
6 l -- Fingerprints 'a ringeimnis E -- Fingerprints
a - combined 2 combined 2 combined
a ci’ a
[0 ZU 30 40 50 60 I0 10 30 all 50 60 'ID 20 W .0 50 60
3. 3. - 3. 5m
7 e 7 V _ 1 7 _ p!
g g 7 F7VM----—~. (KO/It‘dI g r Fingerprints
a a _ ,1. / \Vtw/ S — combined
0 3 :- .i c.
3 a g a
‘C a‘ ‘ i d
2 a , ' S
H 5" 7 Shape a
g 3 _ fingerprints g
a a — combined c.
5 i E r 3
'ID 20 30 40 II] 20 30 M] 10 20 30 40

Number of heavy atoms Number of heavy atoms Number DI heavy atoms

Fig. 6. (A7C) AUC values obtained when training the logistic regression
with the similarity values of the K = 5 most similar ligands. Dashed
curves correspond to AUC obtained with the most similar ligand
(K = 1). (D—F) AUC values for target predictions of molecules interacting
with human targets with activities between 10 MM and 100 MM. The same
comparison schemes as in Figure 4 are used. Note the different x-axis and
y-axis scales

predictions is confirmed, even in the absence of comparison re-
strictions between molecules with the same scaffold and/ or tested
in the same assays. These results suggest that our method is able
to unveil weak afﬁnity targets, which is useful for the detection of
secondary targets, and for the identiﬁcation of molecules that
could then be optimized to improve the activity and efﬁciency
once their targets are validated.

4 DISCUSSION

Accurate predictions of bioactive molecule targets are powerful
to unravel the mechanisms of action of new molecules, guide
experimental testing or predict off-target effects of known
drugs. Several ligand-based strategies have been recently de-
signed that use different kinds of similarity measures between
small molecules (Armstrong et al., 2011; Ballester and
Richards, 2007; Campillos et al., 2008; Keiser et al., 2007;
Wang et al., 2013). Here, to have the broadest possible coverage,
we focus on similarity measures that only use information from
the 2D and 3D structures of the small molecule (i.e. without
requiring data such as side effects or transcriptional response),
and we tested our approach on the ChEMBL dataset of human
protein ligands, which is one of the largest datasets of protein7
small molecule interactions.

Our results indicate in general that ﬁngerprint similarity per-
forms better than shape similarity. However, as it was also
observed in previous studies on smaller datasets (Cleves and
Jain, 2008; Nettles et al., 2006; Yera et al., 2011), we show that
this is partly due to the presence of structural analogs resulting
from biases toward chemically similar molecules when develop-
ing compounds targeting a given protein. The differences
between the two similarity measures become smaller when pre-
venting comparisons between molecules with the same scaffold
or tested in the same assays, and this trend is particularly strong
for molecules with <30 heavy atoms. In those cases, combining
the two methods gives signiﬁcantly better performance.

Considering that even our stringent approach to identify chem-
ical series may not fully cover all cases (e.g. if two teams have
developed molecules starting from the same lead compound, the
resulting similar molecules will often not appear in the same
assay), it clearly suggests that including molecular shape descrip-
tors into target prediction approaches is useful for achieving the
best accuracy.

Our work indicates that prediction accuracy changes with the
size of molecules. Different mechanisms can explain this obser-
vation. First, for large molecules, the number of distinct confor-
mers is typically high, and therefore, conformational sampling
used in shape comparison may be more difﬁcult. Second, a small
change (e. g. replacing a carbon by a nitrogen in an aromatic ring)
in a molecule with only a few heavy atoms will impact a large
fraction of the ﬁngerprints describing the molecule, whereas the
same change in a large molecule will only impact a small fraction
of the ﬁngerprints. Therefore, fingerprint comparison may be
slightly more sensitive to small changes for molecules with a
lower number of heavy atoms. As a consequence, models trained
for small molecules give almost equal weight to shape and ﬁn-
gerprint similarity, whereas models used for larger molecules rely
more on ﬁngerprint similarity values. We also stress that, while
the heavy atom distribution of molecules in ChEMBL is peaked
~30 (median at 29), 75% of FDA-approved drugs have <30
heavy atoms (median at 23, see Fig. 5). Therefore, our combined
approach is likely to be especially appropriate for target predic-
tions of drug-like molecules.

Our results also show that similarity with the most similar
ligand of a target is driving the predictions, and integrating simi-
larity with other (less similar) ligands does not improve the per-
formance in all our benchmarks. Although this came a bit as a
surprise (one could imagine that being similar to many ligands
would strengthen the conﬁdence in the predictions), it appears
that a similarity larger than a given value T with several ligands is
almost always accompanied by a similarity T’>T with at least
one ligand.

Overall, our comparison of the two kinds of similarity measures
suggests that chemical similarity is more appropriate if other mol-
ecules with similar scaffolds are present among the ligands of a
target. If not, and this might correspond to more realistic situ-
ations of new scaffolds being developed, combining shape com-
parison with chemical similarity gives the best performance. In
particular, it has the potential of identifying similarities between
molecules that do not display similar chemical structures, thereby
raising the possibility of scaffold hopping. On the more technical
side, our results indicate that one should ﬁrst carefully study the
biases in protein ligand datasets when comparing small molecule
target prediction approaches. In particular, preventing compari-
son between molecules with the same automatically determined
scaffold is often not sufﬁcient to remove biases due to the presence
of analogs. We also note that similarity measures tend to perform
differently on molecules of different sizes, suggesting that different
models should be applied depending on the nature of the query
molecules. Although the current method has been applied only on
molecules with activity in human, it could be expanded to different
organisms, such as other vertebrates, yeast, fungi or plants, where
large datasets of protein7small molecule interactions are also
available and active molecules have interesting pharmaceutical
or agricultural applications.

 

3078

112 /310'S[BUJHOIPJOJXO'SOIJ’BLUJOJIIIOICWIdllq 111011 pap1201umoq

9103 ‘0g isnﬁnV uo ::

Shaping the interaction landscape of bioactive molecules

 

ACKNOWLEDGEMENTS

The authors thank Matthias Wirth and Antoine Daina for useful
discussions. Computations were performed at the Vital-IT
Center for high-performance computing of the SIB.

Conﬂict of interest: none declared

REFERENCES

Armstrong,M.S. et al. (2011) Improving the accuracy of ultrafast ligand—based
screening: incorporating lipophilicity into ElectroShape as an extra dimension.
J. Comput. Aided Mol. Des, 25, 7857790.

Armstrong,M.S. et al. (2010) ElectroShape: fast molecular similarity calculations
incorporating shape, chirality and electrostatics. J. Comput. Aided Mol Des, 24,
7897801.

Ashbum,T.T. and Thor,K.B. (2004) Drug repositioning: identifying and developing
new uses for existing drugs. Nat. Rev. Drug Discov., 3, 6737683.

Ballester,P.J. et al. (2009) Ultrafast shape recognition: evaluating a new ligand—
based virtual screening technology. J. Mol Graph Model, 27, 83(r845.

Ballester,P.J. and Richards,W.G. (2007) Ultrafast shape recognition to search com—
pound databases for similar molecular shapes. J. Comput. Chem, 28,
171171723.

Bolton,E. et al. (2008) PubChem: integrated platform of small molecules and bio—
logical activities. In: Annual Reports in Computational Chemistry. American
Chemical Society, Washington, DC.

Campillos,M. et al. (2008) Drug target identiﬁcation using side—effect similarity.
Science, 321, 2637266.

Cleves,A.E. and Jain,A.N. (2008) Effects of inductive bias on computational evalu—
ations of ligand—based modeling and on drug discovery. J. Comput. Aided Mol
Des, 22, 1477159.

Dunkel,M. et al. (2008) SuperPred: drug classiﬁcation and target prediction. Nucleic
Acids Res, 36, W557W59.

Fontanilla,D. et al. (2009) The hallucinogen N,N—dimethyltryptamine (DMT) is an
endogenous sigma—1 receptor regulator. Science, 323, 9347937.

Gaulton,A. et al. (2012) ChEMBL: a large—scale bioactivity database for drug dis—
covery. Nucleic Acids Res, 40, D110(%D1107.

Gong,J. et al. (2013) ChemMapper: a versatile web server for exploring pharma—
cology and chemical structure association based on molecular 3D similarity
method. Bioinformatics, 29, 182771829.

Grosdidier,A. et al. (2011) SwissDock, a protein—small molecule docking web service
based on EADock DSS. Nucleic Acids Res, 39, W27(%W277.

Haupt,V.J. and Schroeder,M. (2011) Old friends in new guise: repositioning of
known drugs with structural bioinformatics. Brief Bioinform., 12, 3127326.
Iorio,F. et al. (2010) Discovery of drug mode of action and drug repositioning from

transcriptional responses. Proc. Natl Acad. Sci. USA, 107, 14621714626.

Irwin,J.J. et al. (2012) ZINC: a free tool to discover chemistry for biology. J. Chem
Inf. Model, 52, 175771768.

Iskar,M. et al. (2013) Characterization of drug—induced transcriptional modules:
towards drug repositioning and functional understanding. Mol Syst. Biol, 9,
662.

Keiser,M.J. et al. (2007) Relating protein pharmacology by ligand chemistry. Nat.
Biotechnol, 25, 1977206.

Keiser,M.J. et al. (2009) Predicting new molecular targets for known drugs. Nature,
462, 1757181.

Knox,C. et al. (2011) DrugBank 3.0: a comprehensive resource for ‘omics’ research
on drugs. Nucleic Acids Res, 39, D10357D104l.

Kola,I. and Landis,J. (2004) Can the pharmaceutical industry reduce attrition rates?
Nat. Rev. Drug Discov., 3, 7117715.

Kramer,C. et al. (2012) The experimental uncertainty of heterogeneous public
K(i) data. J. Med. Chem, 55, 516575173.

Kuhn,M. et al. (2013) Systematic identiﬁcation of proteins that elicit drug side
effects. Mol Syst. Biol, 9, 663.

Li,H. et al. (2006) TarFisDock: a web server for identifying drug targets with dock—
ing approach. Nucleic Acids Res, 34, W2197W224.

Li,J. et al. (2009) Building disease—speciﬁc drug—protein connectivity maps from
molecular interaction networks and PubMed abstracts. PLoS Comput. Biol,
5, e1000450.

Liu,X. et al. (2011) SHAFTS: a hybrid approach for 3D molecular similarity cal—
culation. 1. Method and assessment of virtual screening. J. Chem Inf. Model,
51, 237272385.

Lounkine,E. et al. (2012) Large-scale prediction and testing of drug activity on side—
effect targets. Nature, 486, 3617367.

Morris,G.M. et al. (2009) AutoDock4 and AutoDockTools4: automated docking
with selective receptor ﬂexibility. J. Comput. Chem, 30, 278572791.

Nettles,J.H. et al. (2006) Bridging chemical and biological space: “target ﬁshing”
using 2D and 3D molecular descriptors. J. Med. Chem, 49, 6802$810.

Novac,N. (2013) Challenges and opportunities of drug repositioning. Trends
Pharmacol. Sci., 34, 2677272.

Perez—Nueno,V.I. et al. (2012) Detecting drug promiscuity using Gaussian ensemble
screening. J. Chem Inf. Model, 52, 194871961.

Pollock,S.N. et al. (2008) Scaffold topologies. 1. Exhaustive enumeration up to eight
rings. J. Chem Inf. Model, 48, 130471310.

Rahman,S.A. et al. (2009) Small Molecule Subgraph Detector (SMSD) toolkit.
J. Cheminform., l, 12.

Renner,S. and Schneider,G. (2006) Scaffold—hopping potential of ligand—based simi—
larity concepts. ChemMedChem, 1, 1817185.

Rohrer,S.G. and Baumann,K. (2008) Impact of benchmark data set topology on
the validation of virtual screening methods: exploration and quantiﬁcation by
spatial statistics. J. Chem Inf Model, 48, 7047718.

Sastry,G.M. et al. (2011) Rapid shape—based ligand alignment and virtual screening
method based on atom/feature—pair similarities and volume overlap scoring.
J. Chem Inf. Model, 51, 245572466.

Schuffenhauer,A. et al. (2007) The scaffold tree7visualization of the scaffold uni—
verse by hierarchical scaffold classification. J. Chem Inf. Model, 47, 47758.
Smith,A.M. et al. (2010) A survey of yeast genomic assays for drug and target

discovery. Pharmacol T her., 127, 153164.

Venkatraman,V. et al. (2010) Comprehensive comparison of ligand—based virtual
screening tools against the DUD data set reveals limitations of current 3D
methods. J. Chem Inf. Model, 50, 207972093.

Wang,J.C. et al. (2012) idTarget: a web server for identifying protein targets of small
chemical molecules with robust scoring functions and a divide—and—conquer
docking approach. Nucleic Acids Res, 40, W3937W399.

Wang,L. et al. (2013) TargetHunter: an in silico target identiﬁcation tool for pre—
dicting therapeutic potential of small organic molecules based on chemogenomic
database. AAPS J,, 15, 3957106.

Wirth,M. and Sauer,W.H. (2011) Bioactive molecules: perfectly shaped for their
target. Mol Inform, 30, 6777688.

Yera,E.R. et al. (2011) Chemical structural novelty: on—targets and off—targets.
J. Med. Chem, 54, 677176785.

Ziegler,S. et al. (2013) Target identiﬁcation for small bioactive molecules: ﬁnding
the needle in the haystack. Angew. Chem Int. Ed. Engl, 52, 274472792.

Zoete,V. et al. (2009) Docking, virtual high throughput screening and in silico
fragment—based drug design. J. Cell Mol Med, 13, 2387248.

 

3079

112 /310's112u.tn0fp101x0"sotwutJOJHtotq/ﬁduq 111011 papao1umoq

9103 ‘0g1sn8nv uo ::

