BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

DAFS

 

using precomputed posterior probabilities of base pairs and/or
aligned columns (Do et al., 2008; Hofacker et (11., 2004; Holmes,
2005; Kiryu et al., 2007; Will et al., 2007). Sampling—based
approaches, instead of reducing the search space, have also
been developed (Lindgreen et al., 2007; Meyer and Miklos,
2007; Xu et (11., 2007). Ziv—Ukelson et a]. (2010) have proposed
a sparsiﬁcation technique for the Sankoff algorithm that speeds
up computation by a linear factor. Although various techniques
for reducing the computation time have been developed, the
Sankoff—style algorithms are still computationally expensive.
Alternatively, several heuristic—based algorithms that do not
strictly perform simultaneous aligning and folding of RNA
sequences have been proposed such as sequence alignment with
a structural scoring function (Dalli et al., 2006; Hamada et (11.,
2009a) and stem—based alignment (Perriquet et (11., 2003; Tabei
et al., 2008). LARA proposed by Bauer et a]. (2007) formulates
the problem of RNA structural alignment as a graph theoretical
model for sequence alignment with additional simple structure
information. Lagrangian relaxation is applied to relax the
constraints for the structure information, then the problem is
solved as sequence alignment with iterative updates of penalty
scores. Note that LARA was not designed to predict com—
mon secondary structures since no folding model is explicitly
considered.

In this article, we present a novel algorithm DAFS that per—
forms Dual decomposition for Aligning and Folding RNA
sequences Simultaneously. First, on the basis of the maximizing
expected accuracy (MEA) principle, we design an objective func—
tion for a pairwise structural alignment as the expectation of the
sum of the numbers of correctly predicted base pairs in a
common secondary structure and those of correctly aligned col—
umns in its pairwise alignment. Then, to maximize the objective
function under several constraints for consistent pairwise struc—
tural alignment, we use the dual decomposition technique, which
decomposes the pairwise structural alignment problem into two
independent secondary structure prediction problems and one
pairwise (non—structural) alignment problem. The algorithm
maintains the consistency of a pairwise structural alignment by
imposing penalties on inconsistent base pairs and alignment col—
umns, and updates them iteratively by performing the
Nussinov—style secondary structure prediction and the
NeedlemaniWunsch—style pairwise alignment with the penalized
scoring function. We easily extend the algorithm to perform mul—
tiple alignment by applying a standard progressive alignment
technique. Furthermore, we integrate the IPknot model (Sato
et al., 2011) instead of the Nussinov model so that DAFS can
simultaneously align and fold RNA sequences with pseudoknots.
Major advantages of DAFS are summarized as follows: (i) DAFS
is a fast and accurate implementation that simultaneously aligns
and folds RNA sequences. Compared with the other
Sankoff—style algorithms, DAFS achieves comparable accuracy,
and even more importantly, runs much faster. Compared with
the heuristic—based approaches such as sequence alignment with
structural scores, DAFS is more accurate, especially in terms of
common secondary structure prediction; (ii) DAFS is flexible and
extensible because of the dual decomposition, which enables us
to integrate state—of—the—art folding models such as the IPknot
model for pseudoknotted secondary structures.

 

 

 

 

 

me 1 1:. Ir)

 

 

 

 

 

 

 

 

 

m: l a. 17)

 

 

 

Fig. 1. An illustration of factorization of a probability distribution over a
space of RNA structural alignments

2 METHODS

We present a novel method DAFS for simultaneous aligning and folding
of RNA sequences by dual decomposition by which an integer program-
ing (IP) problem for this task is solved. DAFS calculates a pairwise struc-
tural alignment, that is, a pairwise alignment that considers RNA
secondary structures, by the following two steps when two unaligned
sequences are given: (i) compute two base-pairing probability matrices
and an alignment-matching probability matrix for the two sequences to
factorize a probability distribution of structural alignments (Section 2.2,
Fig. 1), and (ii) solve the IP problem (Section 2.3) of simultaneously
aligning and folding the given sequences by dual decomposition
(Section 2.4) to maximize the expected accuracy of the prediction.
Then, the pairwise alignment algorithm is extended to compute a multiple
alignment by a progressive alignment approach (Section 2.5).
Furthermore, we describe an extension of our algorithm to perform
RNA structural alignment that can consider pseudoknots (Section 2.6).

2.1 Preliminaries

Let E: {A,C,G,U} and 2* denote the set of all ﬁnite RNA sequences
consisting of bases in E. For a sequence a = 0102...!)n e 2*, let |a|
denote the number of symbols appearing in a, which is called the
length of 0. Given two RNA sequences a, b e 2*, let A(a,b) be a set of
all possible alignments of a and b, and 8(0) be a set of all possible sec-
ondary structures of a. An alignment 2 e A(a,b) is represented as a
|a| >< |b| binary-valued matrix 2 = (2%), where 2,). = 1 if and only if the
base a,- is aligned with bk. A secondary structure x 6 8(a) is represented
as a |a| >< |a| binary-valued triangular matrix x = (xi/)Kj, where X),- = 1 if
and only if bases 0,- and a,- form a base pair. Let 634(1), )7) be a set of all
possible structural alignments of a and b. We write 6 = (x, y, 2), which
means that a structural alignment 0 6 634(1), )7) consists of an alignment
2 e A(a, b), and two secondary structures x 6 8(0) and y e 8(b).

2.2 MBA-based scoring function

One of the most promising techniques to solve discrete high-dimensional
problems on sequences such as RNA secondary structure prediction and
RNA structural alignment is the MEA-based approach including cen-
troid estimation (Carvalho and Lawrence, 2008; Hamada ct 01., 2009b).

Given unaligned RNA sequences, the goal of RNA structural align-
ment is to produce a reliable alignment, as well as to predict a reliable
common secondary structure. To this end, we deﬁne a gain function of a
structural alignment é = (fcjj) with regard to the correct structural
alignment 6 = (x, y, 2) as the weighted sum of gain functions Gj(x,fc)
and G,\,(y, )7) of respective secondary structures and a gain function
Gt,(z,2) of the alignment as follows:

6(9, é) = a{G.(x, x) + Gleam} + 6.,(2, 2) (1)

where oz>0 is a parameter that controls the weight of the secondary
structures and the alignment. The gain function G,\,(x, J?) of the secondary
structure )? is deﬁned as follows:

G,\,(X, 3?) = (l — r) TPX(X, 3?) + r TNX(X, 3?)

 

3219

ﬁm'spzumofpmjxo'sopeuuopnorq/ﬁdnq

K.Sato et al.

 

where TPX(X,X) = 21. <1. I(X,»j = 1)I(X,»j = 1) is the number of true positive
predictions, TN ((X, X) = 214.1(le = 0)](Xij = 0) is the number of true
negative predictions and r e [0, 1] is a balancing parameter between true
positives and true negatives. Here, I(conditi0n) is the indicator function that
takes a value of 1 or 0 depending on whether the condition is true or false.
The gain function G,\.(X,X) can be regarded as a kind of ‘accuracy’ that
represents the weighted sum of the number of true predictions in X, which is
correlated to balanced accuracy measures such as Matthews correlation
coefﬁcient (MCC) and F-measure. Note that G,\.(X, X) is equivalent to the
gain function of the y-centroid estimator used in CentroidFold
(Hamada et al., 2009b) for r = 1/(1+ y). Similarly, the gain function
Gu(z, 2) of the alignment 2 is deﬁned as the number of true predictions
in 2 as follows:

Gu(z, 2) = (l — a) TPu(z, 2) + a TNu(z, 2)

where TPu(z, 2) = 21.. A, [(2)]. = 1)I(2,»)‘. = 1) is the number of true positive
predictions and TNu(z, 2) = 21.. kI(zik = 0)I(2l»)‘. = 0) is the number of
true negative predictions. Here, a 6 [0,1] is a balancing parameter
between true positives and true negatives.

In accordance with the MEA principle, we ﬁnd a structural alignment
é that maximizes the expectation of the gain function (1) under a
given probability distribution over the space 8A(a,b) of structural
alignments:

[E6]...,,[G(e, 9)] = Zed/Mb) P(6|a, b)G(6, é) (2)

where P(6|a, b) is a probability distribution of RNA structural
alignments.

Unfortunately, computation of Equation (2) requires 0(|a|3|b|3) time
and 0(|a|2|b|2) space even if we assume only pseudoknot-free secondary
structures. Therefore, we assume independence of structure and align-
ment, and factorize the probability distribution of the structural align-
ments as follows:

P(6|a, b) % P(X|a)P(y|b)P(z|a, b) (3)

where P(X|a) and P(y|b) are probability distributions of RNA secondary
structures over 8(a) and 8(b), respectively, and P(z|a, b) is a probability
distribution of alignments over A(a, b) (Fig. 1). We can then approximate
the expected gain function (2) by the following:

E61111G<aén ~ 2,), [12)?“ — up».

(a) A (b) A
+a<Zi<j|: if _ T:|Xij + Zk<l [pk] _ ijH) + C

(4)

where

125;” = Z P(X|a)I(X1,- = 1),

X6501)

121’? = Z P(y|b)1(m=1)

yeS(b)

are base-pairing posterior probability distributions,

17$!» 2 Z P(Z|a,b)1(zi1» = 1)
zeA(u.b)

is an alignment-matching posterior probability distribution and C is a
constant independent of é: (X, )2, 2) (see Section S1 in Supplementary
Material for the derivation). If we assume pseudoknot-free structures for
a and b, calculation of the posterior probabilities pg”, 21;) and 173:“
requires 0(|a|3),0(|b|3) and 0(|a||b|) in time and 0(|a|2),0(|b|2) and

0(|a||b|) in space, respectively.

2.3 IP formulation

Our objective is to ﬁnd an RNA structural alignment that maximizes the
approximate expected gain (4), satisfying the consistency of the RNA

structural alignment. This optimization problem can be formulated as
the following IP problem that maximizes:

S(x,y,z:a, b) = 2[ E1?“ — a]z.1

11k

(5)
+ ((2 [p50 — I] + 2 [p217 _ 4y“)

i<j k<l
subject to:
Zin+ 2ij 51 (15 W S 10]), (6)
j<i j>i
xij+xﬂﬂ 5 1 (1 5 Vi<Vi’<Vj<Vj’ 5 lal), (7)
Zn + Eye :1 (1 : Vk 5 1121), (8)
l<k l>k
yk1+yk,1, S l  S Vk<Vk’<Vl<Vl’ S  
2211» :1 (1 5 Vi: lal), (10)
A
22.1 :1 (1: Vic 5 lbl), (11)
211+ij 51 (l S Vi<Vj§ lal; 15 Vk<Vl§ lbl), (l2)
le = 2 WW (1 5 Vi<Vj 5 lal), (13)
k<l
y“ = 2W.) (1 5 Vk<Vl 5 |b|), (14)
i<j

211» 2 2 Wm. + 2 WW (1 :Vi: lal: 1 svk : lbl) (15)

j<i.l<k j>i.l>k

where Wle is a binary-valued variable such that WW 2 1 if and only if a
base pair (aha!) is aligned with a base pair (bbbl). The constraint (6)
means that each base a,» can be paired with at most one base (Fig. 2a), and
the constraint (7) allows no pseudoknots in the secondary structure
X e 8(a) (Fig. 2b). Similarly, the constraints (8) and (9) maintain the
consistency of the secondary structure y e 8(b). The constraints (10)
and (11) state that each base in a and b can be aligned with at most
one base (Fig. 2c and d), and the constraint (12) allows no crossing
match in the alignment 2 e A(a,b) (Fig. 2e). The constraints (13){15)
represent agreement between X, y and 2 that must be satisﬁed by the
common secondary structure 6 = (X, y, z) e 8A(a,b). If we can drop
the constraints (13H15), each component X, y and z of the structural
alignment can be solved separately and efﬁciently. This means that the
constraints (13){15) make the problem of RNA structural alignment
extremely complex.

Consider the condition for 1ng1: 1. Because of the constraints
(13){15), WW 2 1 implies Xy- = Md 2 2,»). = 2]] = 1. Therefore, to maxi-
mize the objective function (5), the contribution of 1ng1: 1 should be
positive:

[123?“ — a] + [121170 — a] + e([p§;> _ r] + [p]? — 1]) > 0 (16)

Furthermore, since the contribution of the base pair match, win [the
left-hand side of Equation (16)] should be larger than that of two loop
matches 217‘. and 21-), that is, b) — a] + b) — a], the following condi-
tion should be satisﬁed:

[125]?) — r] + [p]? — r]>0 (17)

 

3220

ﬁre'spzumofpmjxo'sopeuuopnorq/ﬁdnq

DAFS

 

 

Fig. 2. An illustration of the constraints of the IP formulation. The dia-
grams (a) and (b) correspond to the constraints (6) and (7), respectively.
Note that at most one variable shown by a broken curved line can take a
value 1. The diagrams (c), (d) and (e) correspond to the constraints (10),
(11) and (12), respectively

Therefore, it is no longer necessary to consider WW that does not satisfy
the conditions (16) and (17). We call this the threshold cut technique,
which accelerates our algorithm as we will describe in the next section.

2.4 Dual decomposition

Recall that the main difﬁculty of solving the IP problem of RNA struc-
tural alignment arises from the constraints (13){15). To circumvent this
difﬁculty, we deal with these constraints using Lagrangian relaxation
(Korte and Vygen, 2008). First, we deﬁne the Lagrangian dual by
moving the constraints (13){15) to the objective function (5):

L0», )1, v) = max
X e 8(a),y e 8(b),
2 E A(a,b), w

+ Z My  Wijkl — Xij) + Z Mkl<z W‘in — Jim) (18)

i<j k<l k<l i<j

+ Z V11.» (2111» — Z Wjilk — 2 Wm) }
1.1»

j<1’.l<k j>1’.l>k

]S(X,y, z; a, b)

where A = {Ag|i<j},11 = {owl/{<1} and v = {Viklvik Z 0} are Lagrangian
multipliers. We can then rewrite Equarion (18) as:

_ ( )
L01, 11, v) —§;§§)  [0107; - T) - I111]X11

+ max [0075.]? — T) — Mk1]yk1
yes“) k <1
(19)
+ max [pff‘m — a + 12142111»
ZEA(u.b) Lk
+ mfx Z [My + 111.1 — V11.» — 11,1] W‘in
1’ <j.k<l
meaning that we can calculate each term of Equation (19) independently
and efﬁciently by using the DP techniques: the Nussinov-style algorithm
(Nussinov et al., 1978) for the first and second terms and the Needlemani
Wunsch-style algorithm (Needleman and Wunsch, 1970) for the third
term; and by simply ﬁnding positive coefﬁcients for the last term. This
technique is called dual decomposition (Wainwright et al., 2005).

Since the dual objective function LO», )1, v) gives an upper bound of the
primal objective function (5), we aim to minimize Equation (19) with re-
spect to the multipliers to obtain a better upper bound. The Lagrangian
function L(}t,p,, v) is convex, but not differentiable (Korte and Vygen,
2008). Thus, to minimize the dual objective function (19), we can apply
the subgradient optimization in which the Lagrangian multipliers Al}, )1“
and 1217‘. are iteratively updated by using their subgradients
Zt<1ww— X11, Zi<jwij7f1 -m and 21» - Zj<1ll<k W111 - Zj>111>k Wilma
respectively. As a result, we can obtain an algorithm similar to the gradient
descent as shown in Figure 3, where 1]“) >0 is a step size at each update. It

1: Calculate the posterior probabilities pg), pig) and pgg’b).

2: Set A21.) 2 0, ME) = 0 and V5]? 2 0.
3: fort = ltono
t
4: as“) <— arg maxmesw) Ziq [04(1)]? _ T) _ Ag] mij

b
5: y“) <— argmaXyeso) 21K) [6103)? - T) - 1155)] yij
6: z“) <— arg maxz€A(a,b) EM [125?” — a + 1211?] Zik
7: to“) <— arg maxw Zi<j,k<l[)\§;) + p.12? — 11],? — u§])]wijkl
8: if (9“) 2 (ﬁt) , y“). 2(0) satisﬁes the constraints (13)—(15) then
9: return 6“) = ($(t),y(t)i z(t))
10: “(113) <0 (0 (t)
111 )‘ij ‘— )‘ij — 71“) (Zk<l wijkl _ 3%)

. 1+1 t t t
12- Niel > ‘— F‘iez) _ 77m (21¢ wijiu _ 31121))
13: V§£+U <— max {0, 112)]? — 770) 

(t) (t)
_ Zj<i,l<k wjz'lk _ Zj>i,l>k wijkl)}
14: end for
15: return 6(T) : (gc(T),y(T)a Z(T))

Fig. 3. The algorithm for predicting RNA structural alignments using
DD. T is the maximum number of iterations

has been proven that if limH00 n“) = 0 and 2:1 1]“) 2 00, the Lagrangian
dual LO», )1, v) always converges to the optimal value. The update is iter-
ated until the solution is found or the number of iterations reaches the
predeﬁned maximum number of iterations T, which is sufﬁciently large.

The Lagrange multipliers can be regarded as penalty scores against
inconsistency between alignments and secondary structures for the con-
straints (13%(15).

The computational complexity of the algorithm in Figure 3 is domi-
nated by that of the subproblems and the number of 1ng1, which is at
most |a| |b|(|a| + |b|)/2r by using the threshold cut technique described in
Section 2.3. If we approximate |a| % L and |b| % L, the time and space
complexities of the algorithm are 0(TL3/r) and 0(L3/r), respectively.
See Section S2 in Supplementary Material for details.

2.5 Extension to multiple alignment

We can easily extend pairwise alignment described in Section 2.4 to mul-
tiple alignment by the progressive approach (Feng and Doolittle, 1987)
with the average base-pairing probability matrix and the average
alignment-matching probability matrix.

Let A and B be two alignments of RNA sequences. We deﬁne the
(A) to be the average of 170‘) over all

average base-pairing probabilities pl]. 1.].

sequences a e A, remapped to the coordinates of the alignment A.

Similarly, we deﬁne the average alignment-matching probabilities 12$”)

to be the average of 173:“ over all pairs of sequences a e A and b e B,
remapped to the coordinates of the alignments A and B. We can predict
the optimal structural alignment of two alignments A and B by the dual

decomposition algorithm (Fig. 3) with 175;“, 1755) and 17],:1‘3) instead of

11121211 and 11.1

Given a set of unaligned sequences, we ﬁrst build a guide tree by clus-
tering the sequences with a UPGMA using the expected accuracy simi-
larity measure (Do et al., 2005). We then perform progressive alignment

by aligning alignments of the sequences according to the guide tree.

2.6 Extension to structural alignment with pseudoknots

As described in Section 2.4, our algorithm decomposes the master prob-
lem of RNA structural alignment into the three slave problems: two sec-
ondary structure prediction problems and one pairwise (non-structural)
alignment problem, each of which can be solved independently. This
allows us to easily take pseudoknots into account by replacing the
Nussinov-style DP algorithm with the IPknot model (Sato et al.,

 

3221

ﬁre'spzumot‘pmJXO'soptzuuopttorq/ﬁdnq

K.Sato et al.

 

2011) for predicting secondary structures with pseudoknots. To the au-
thors’ knowledge, this is the ﬁrst implementation that can simultaneously
align and fold RNA sequences considering pseudoknotted secondary
structures, except for SimulFold (Meyer and Miklos, 2007) and
RNASampler (Xu et al., 2007), which are based on a sampling algorithm.
See Section S3 in Supplementary Material for details.

3 RESULTS

3.1 Implementation

Our algorithm was implemented as a program called DAFS. To
calculate base—pairing probabilities, we used the McCaskill
model (McCaskill, 1990) in the Vienna RNA package
(Hofacker, 2003), using the free energy parameters estimated
by the Boltzmann likelihood—based method (Andronescu et al.,
2010). To calculate alignment—matching probabilities, we used
the ProbCons model (Do et al., 2005). We implemented DAFS
with two decoding algorithms for Lines 4 and 5 in Figure 3: the
Nussinov decoding and the IPknot decoding. DAFS with the
IPknot decoding can handle pseudoknotted secondary struc—
tures, whereas DAFS with the Nussinov decoding cannot.

Part of the IPknot decoding in DAFS was implemented using
the CPLEX IP solver (http://www—01.ibm.com/software/integra—
tion/optimization/cplex—optimizer/). In this study, we used em—
pirically determined parameters: 01 : 4.0, ‘L' : 0.2, a : 0.01 and
T: 600.

3.2 Datasets

For the benchmark, we created new datasets from Rfam 11.0
(Gardner et al., 2011). Only manually curated seed alignments
with consensus structures published in literature were used. We
produced 691 pseudoknot—free alignments (PKfree dataset) and
82 pseudoknotted alignments (PK dataset). Each alignment con—
tains 10 sequences from the Rfam families. Furthermore, to
avoid selective bias in evaluation, we also used four datasets of
RNA sequences that have been established in previous studies
(Gardner et al., 2005; Kiryu et al., 2007; Lindgreen et al., 2007;
Tabei et al., 2008). See Section S4 in Supplementary Material for
more details.

3.3 Evaluation metrics

We evaluated the accuracy of predicted structural alignments
through two measures for alignments and three measures for
common secondary structures. To evaluate produced alignments,
the following measures were used: (i) sum—of—pairs score (SPS)
(Thompson et al., 1999), which is defined as the proportion of
correctly aligned matches in the predicted alignment, and (ii)
structure conservation index (SCI) (Washietl et al., 2005),
which is deﬁned as SCI : E A /E, where E A is the consensus min—
imum free energy computed by RNAalifold (Bernhart et al.,
2008) and E is the average minimum free energy over all RNA
sequences in the predicted alignment. These measures can be
calculated directly from produced alignments.

To evaluate predicted common secondary structures, we first
mapped a predicted (reference, respectively) common secondary
structure to each sequence according to the predicted (reference)
alignment. Then, the predicted secondary structure mapped to
each sequence was evaluated by the following three measures:

(iii) sensitivity (SEN), which is defined as the proportion of cor—
rectly predicted base pairs in the reference secondary structure,
i.e. SEN : TP/(TP + FN), (iv) positive predictive value
(PPV), which is deﬁned as the proportion of the correctly pre—
dicted base pairs in the predicted secondary structure, i.e.
PPV : TP/(TP + FF), and (v) MCC, which is deﬁned as:

TP . TN — FN . FP
\/(TP + FN)(TN + FP)(TP + FP)(TN + FN)

 

 

where TP is the number of base pairs appearing in both the
reference and predicted structures, FF is the number of base
pairs that appear in the predicted structure but not in the refer—
ence, TN is the number of base pairs that appear in neither
structure and EN is the number of base pairs that appear in
the reference but not in the predicted structure. Note that there
exists a trade—off between SEN and PPV, and MCC is a balanced
evaluation measure between them.

3.4 Effectiveness of dual decomposition

We ﬁrst validated on the Murlet dataset (Kiryu et al., 2007) that
our algorithm can yield the optimal solution or a good approxi—
mation close to the optimal solution. Figure 4a shows the aver—
age number of constraints that are not satisﬁed at the maximum
number of the iteration, T in Figure 3, ranging from 1 to 1000,
indicating that satisﬁable solutions can be achieved at T 3 600.
Figure 4b and c show elapsed time to process all the sequences in
the dataset and accuracy, including SPS, SCI and MCC, at the
maximum number of the iteration, respectively, comparing the
results of the dual decomposition with the counterparts achieved
by the CPLEX IP solver. These results clearly indicate that SPS,
SCI and MCC sufﬁciently converged to the optimal at T 3 600
even though the dual decomposition with T: 600 performed
extremely faster than CPLEX. Therefore, we set T: 600 in sub—
sequent experiments.

3.5 Structural alignments without pseudoknots

We conducted several computational experiments of predicting
RNA structural alignments on the PKfree dataset, comparing
DAFS with the following state—of—art aligners for structural align—
ment: (i) CentroidAlign version 1.00 (Hamada et al., 2009a),
(ii) RAF version 1.0 (Do et al., 2008), (iii) LARA version 1.3.2a
(Bauer et al., 2007), and (iv) LocARNA version 1.6.1 (Will et al.,
2007). RAF and LocARNA, as well as DAFS, perform
simultaneous aligning and folding of RNA sequences.
CentroidAlign and LARA perform sequence alignment with
structural scores. We also used the following standard alignment
tool that does not consider any secondary structure as baselines
in the comparison: (v) ProbConsRNA version 1.1 (Do et al.,
2005).

Table 1 and Supplementary Tables S2<S6 in Supplementary
Material show the results on the datasets that do not contain
pseudoknotted reference structures. These results indicate that
DAFS achieved high accuracy in the measures for common sec—
ondary structures, especially in MCC that is a balanced measure
between SEN and PPV, and is much faster than RAF, one of the
most accurate competitors, although the accuracy of DAFS in the
measures for alignments is not remarkable. Since accurate

 

3222

ﬁlO'SIlZLIIﬂOprOJXO'SOplZILLIOJLIIOIQ/[idnq

DAFS

 

80 100 120
1500

1000

TIME (s)

:11 0i violated constraints
40 60

500

20

° jllllllllrunuh o

0 200 400 600 800 1000 0 200

T

0.8

 

W]

0.5

0.4

Time (DD)
Time (IP) 2

SP5 (DD) -e.— SC|(DD) —1— M00 (DD)
SPS(|P) ~ SC|(|P) ---- r- MCC(|P)

600 800 1000 0 200 400 600 800 1000

T T

Fig. 4. The behavior of the dual decomposition algorithm as the maximum number of the iteration Tis varied (DD : Dual Decomposition, IP : Integer
Programming). (21) The mean and the standard deviation of the number of violated constraints over all the predictions at T. (b) The total execution time
of DD and IP for all the alignments at T measured on a Linux workstation with Intel Xeon E5450 (3.0 GHz). (c) The accuracy of DD and IP at T

Table 1. The results on the PKfree dataset

Table 2. The results on the PK dataset

 

 

 

Aligner SPS SCI SEN PPV MCC TIME Aligner SPS SCI SEN PPV MCC TIME
DAFS 0.82 0.61 0.76 0.77 0.76 2275 DAFS

CentroidAl ign 0.84 0.61 0.68 0.82 0.73 1 010 IPknot decoding 0.80 0.57 0.61 0.70 0.64 4 580
RAF 0.82 0.58 0.73 0.79 0.75 11 693 Nussinov decoding 0.80 0.56 0.54 0.67 0.60 674
LARA 0.81 0.62 0.69 0.80 0.73 29 734 RNASampler 0.70 0.55 0.52 0.69 0.59 164206
LocARNA 0.79 0.69 0.70 0.79 0.73 63 935

ProbConsRNA 0.83 0.52 0.62 0.80 0.69 532 TIME means the total computation time in seconds measured on a Linux worksta—

 

TIME means the total computation time in seconds measured on a Linux worksta—
tion with Intel Xeon E5450 (3.0GHz). The bold values indicate the best score in
each evaluation measure. For all the methods except DAFS, SEN, PPV and MCC,
are calculated using common secondary structures predicted by
CentroidAlifold with default parameters from produced alignments. See
Section S4 in Supplementary Material for the results using RNAalifold and intrinsic
predictions.

prediction of RNA secondary structures is crucial for unraveling
potential functions of non—coding RNAs as mentioned in Section
1, fast and accurate structural alignments of DAFS shown in the
results are preferable.

3.6 Structural alignments with pseudoknots

We conducted the experiment of predicting RNA structural
alignments with pseudoknots on the PK dataset that contains
pseudoknots in the reference structures, comparing DAFS with
RNASampler version 1.3 (Xu et (11., 2007) with the option of ‘—X
1’ that allows us to consider simple pseudoknots. Note that there
is no existing practical structural aligner that can consider pseu—
doknots, except for RNASampler. Since RNASampler cannot
recover common secondary structures with pseudoknots, we
used IPknot with default parameters to predict common sec—
ondary structures from produced alignments. Table 2 clearly
shows the advantage of DAFS with the IPknot decoding that
can simultaneously align and fold RNA sequences with pseudo—
knots. Furthermore, the comparison between the Nussinov
decoding and the IPknot decoding indicates that IPknot is

tion with Intel Xeon E5450 (3.0 GHz). The bold values indicate the best score in
each evaluation measure. See Section S4 in Supplementary Material for the results
using IPknot: for DAFS with Nussinov decoding.

successfully integrated into DAFS, meaning that DAFS is flexible
and extensible because of the dual decomposition.

4 DISCUSSION

We developed a fast and accurate RNA structural aligner called
DAFS that simultaneously aligns and folds RNA sequences by
dual decomposition. Speciﬁcally, our method decomposes the
RNA structural alignment problem into three subproblems,
then respective problems are solved by simple and efficient algo—
rithms such as the Nussinov—style DP and the Needlemani
Wunsch—style DP. This means that DAFS can explicitly take
the folding model into account, whereas LARA that has also
used Lagrangian relaxation cannot. In fact, we showed that the
dual decomposition technique enables us to integrate
state—of—the—art folding models such as the IPknot model for
pseudoknotted structures. This flexibility to adapt the folding
models to our algorithm would lead us to further improvement
by using an extended secondary structure model such as
RNAwolf (zu Siederdissen et (11., 2011), where base—pairing prob—
abilities for extended secondary structures are used.

One of the other differences between DAFS and LARA is the
scoring system in the objective function. The scoring system of
DAFS is based on the MEA principle, which has been successfully
applied to various problems in bioinformatics (Do et (11., 2005,

 

3223

ﬁlO'SIlZLIIﬂOprOJXO'SOplZILLIOJLIIOIQ/[idnq

K.Sato et al.

 

2006; Hamada et al., 2009b; Hamada et al., 2011; Kato et al.,
2010; Sato et al., 2011). The MEA—based scoring function not
only improves accuracy in prediction but also makes DAFS run
fast by the threshold cut technique, which is derived from the IP
formulation based on the MEA—based scoring function described
in Section 2.3. The threshold cut technique has also been applied
to RactIP (Kato et al., 2010) and IPknot (Sato et al., 2011),
and has contributed to their accuracy and efficiency.

Prediction accuracy of DAFS depends mainly on its scoring
functions even though the method uses the approximate prob—
ability distribution for RNA structural alignments that assumes
independence of alignment and structure. In fact, experimental
results shown in Section S5 in Supplementary Material revealed
that when we adopted the exact posterior probabilities for RNA
structural alignments, a signiﬁcant improvement was conﬁrmed,
though much computation time was spent on the predictions.
Considering these results, there is room for further investigation
into reﬁnement of the scoring functions that make prediction
accuracy compatible with practical running time.

ACKNOWLEDGEMENTS

The authors thank Dr Michiaki Hamada and our colleagues
from the RNA Informatics Team at the Computational
Biology Research Center (CBRC) for fruitful discussions. The
super—computing resource was provided by Human Genome
Center, Institute of Medical Science, University of Tokyo.

Funding: Grant—in—Aid for Young Scientists (B) (KAKENHI)
from Japan Society for the Promotion of Science (22700305 to
KS. and 22700313 to Y.K.).

Conﬂict of Interest: none declared.

REFERENCES

Andronescu,M. et al. (2010) Computational approaches for RNA energy parameter
estimation. RNA, 16, 23042318.

Bauer,M. et al. (2007) Accurate multiple sequence—structure alignment of RNA
sequences using combinatorial optimization. BMC Bioinform., 8, 271.

Bernhart,S.H. et al. (2008) RNAalifold: improved consensus structure prediction
for RNA alignments. BMC Bioinform., 9, 474.

Carvalho,L.E. and Lawrence,C.E. (2008) Centroid estimation in discrete
high—dimensional spaces with applications in biology. Proc. Natl Acad. Sci.
USA, 105, 320973214.

Dalli,D. et al. (2006) STRAL: progressive alignment of non—coding RNA using base
pairing probability vectors in quadratic time. Bioinformatics, 22, 159371599.
D0,C.B. et al. (2005) ProbCons: probabilistic consistency—based multiple sequence

alignment. Genome Res., 15, 333340.

D0,C.B. et al. (2006) CONTRAfold: RNA secondary structure prediction without
physics—based models. Bioinformatics, 22, e90—e98.

D0,C.B. et al. (2008) A max—margin model for efﬁcient simultaneous alignment and
folding of RNA sequences. Bioinformatics, 24, 68776.

Eddy,S.R. and Durbin,R. (1994) RNA sequence analysis using covariance models.
Nucleic Acids Res., 22, 2079:2088.

Feng,D.F. and Doolittle,R.F. (1987) Progressive sequence alignment as a prerequis—
ite to correct phylogenetic trees. J. Mol Evol, 25, 3517360.

Gardner,P.P. et al. (2005) A benchmark of multiple sequence alignment programs
upon structural RNAs. Nmfl€llf Acids Res., 33, 243372439.

Gardner,P.P. et al. (2011) Rfam: Wikipedia, clans and the ‘decimal’ release. Nucleic
Acids Res., 39, D1417D145.

Gorodkin,J. et al. (1997) Finding the most signiﬁcant common sequence and struc—
ture motifs in a set of RNA sequences. Nucleic Acids Res., 25, 372473732.

Hamada,M. et al. (2009a) CentroidAlign: fast and accurate aligner for struc—
tured RNAs by maximizing expected sum—of—pairs score. Bioinﬁ)rmatics, 25,
323673243.

Hamada,M. et al. (2009b) Prediction of RNA secondary structure using generalized
centroid estimators. Bioinformatics, 25, 465473.

Hamada,M. et al. (2011) Improving the accuracy of predicting secondary structure
for aligned RNA sequences. Nucleic Acids Res., 39, 393402.

Hofacker,I.L. (2003) Vienna RNA secondary structure server. Nucleic Acids Res.,
31, 342973431.

Hofacker,I.L. et al. (2004) Alignment of RNA base pairing probability matrices.
Bioiiﬁ’ornmtics, 20, 2222:2227.

Holmes,I. (2005) Accelerated probabilistic inference of RNA structure evolution.
BMC Bioinform., 6, 73.

Kato,Y. et al. (2010) RactIP: fast and accurate prediction of RNA—RNA interaction
using integer programming. Bioinformatics, 26, i460466.

Kiryu,H. et al. (2007) Murlet: a practical multiple alignment tool for structural
RNA sequences. Bioinformatics, 23, 158871598.

Knudsen,B. and Hein,J. (2003) Pfold: RNA secondary structure prediction using
stochastic context—free grammars. Nucleic Acids Res., 31, 342%3428.

Korte,B. and Vygen,]. (2008) Combinatorial Optimization: Theory and Algorithms.
Springer Verlag, Berlin, Germany.

Lindgreen,S. et al. (2007) MASTR: multiple alignment and structure prediction of
non—coding RNAs using simulated annealing. Bioinformatics, 23, 3304<3311.

Mathews,D.H. and Turner,D.H. (2002) Dynal ign: an algorithm for ﬁnding the
secondary structure common to two RNA sequences. J. Mol Biol, 317,
1917203.

McCaskill,J.S. (1990) The equilibrium partition function and base pair binding
probabilities for RNA secondary structure. Biopolvmers, 29, 110571119.

Meyer,I.M. and Miklos,I. (2007) SimulFold: simultaneously inferring RNA struc—
tures including pseudoknots, alignments, and trees using a Bayesian MCMC
framework. PLoS Compat. Biol, 3, e149.

Needleman,S.B. and Wunsch,C.D. (1970) A general method applicable to the
search for similarities in the amino acid sequence of two proteins. J. Mol
Biol, 48, 443453.

Nussinov,R. et al. (1978) Algorithms for loop matching. SIAM J. Appl Mat/1., 35,
68782.

Perriquet,O. et al. (2003) Finding the common structure shared by two homologous
RNAS. Bioinformatics, 19, 1087116.

Rivas,E. et al. (2012) A range of complex probabilistic models for RNA secondary
structure prediction that includes the nearest—neighbor model and more. RNA,
18, 1937212.

Sakakibara,Y. et al. (1994) Stochastic context—free grammars for tRNA modeling.
Nucle‘u? Acids Res., 22, 5112:5120.

Sankoff,D. (1985) Simultaneous solution of the RNA folding, alignment and pro—
tosequence problems. SIAM J. Appl Mat/1., 45, 8104825.

Sato,K. et al. (2010) A non—parametric Bayesian approach for predicting RNA
secondary structures. J. Bioinform. Compat. Biol, 8, 7277742.

Sato,K. et al. (2011) IPknot: fast and accurate prediction of RNA secondary
structures with pseudoknots using integer programming. Bioinformatics, 27,
85793.

Seemann,S.E. et al. (2008) Unifying evolutionary and thermodynamic information
for RNA folding of multiple alignments. Nmfl€llf Acids Res., 36, 63554362.
Tabei,Y. et al. (2008) A fast structural multiple alignment method for long RNA

sequences. BMC Bioinform., 9, 33.

Thompson,J.D. et al. (1999) A comprehensive comparison of multiple sequence
alignment programs. Nucleic Acids Res., 27, 268272690.

Wainwright,M. et al. (2005) MAP estimation via agreement on trees: message—
passing and linear programming. IEEE Trans. Inf. Theory, 51, 369773717.
Washietl,S. et al. (2005) Fast and reliable prediction of noncoding RNAs.

Proc. Natl Acad. Sci. USA, 102, 2454:2459.

Will,S. et al. (2007) Inferring noncoding RNA families and classes by means of
genome—scale structure—based clustering. PLoS Compat. Biol, 3, e65.

Xu,X. et al. (2007) RNA Sampler: a new sampling based algoritth for common
RNA secondary structure prediction and structural alignment. Bioinformatics,
23, 188371891.

Ziv—Ukelson,M. et al. (2010) A faster algoritth for simultaneous alignment and
folding of RNA. J. Compat. Biol, 17, 1051:1065.

zu Siederdissen,C.H. et al. (2011) A folding algorithm for extended RNA secondary
structures. Bioinformatics, 27, i129<136.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA sequences
using thermodynamics and auxiliary information. Nucleic Acids Res., 9,
1337148.

 

3224

ﬁre'spzumol‘pmjxo'soptzuuopttorq/ﬁdnq

