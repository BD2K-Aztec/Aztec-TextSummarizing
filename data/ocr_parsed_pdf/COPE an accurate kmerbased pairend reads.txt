BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

LI1-u.:-.:.-.nnm:-1ul

Optimai overlap
GTAC TGACTGGC TATATATAGATCT Pro b_: D. 33

ATATATATATATTACTAC TGGGTA

GTAC TGACTGGC TATATATAGATCT

sub'ogrug'g‘aloofmlap ATATATATATATTACTACTGGGTA
L ‘ I .0

 

/3.10'S[Bum0[p10}x0'SOpBLUJOJuyqu”:duq

B.Liu et al.

 

read pairs that cannot be connected due to too short overlap can account
to over 15% in a typical PE100 library with a 180-bp insert distance.

Note that checking the frequency information of all spanning k-mers is
time-consuming. COPE uses a trick to speed up this stage by avoiding
examining all spanning k-mers. The idea is that a spurious overlap usually
has some k-mers with frequency as low as 1 and seldom exceeding 3.
Thus, once we have seen a few spanning k-mers with frequency
lower than the threshold of 3, we stop checking other spanning k-mers
and immediately conclude that the overlap is spurious. In addition,
since k-mers from repetitive sequences are with extremely high frequency
(say over two times the average), if there are more than three spanning
k-mers of extremely high frequency, the read pair will be put aside for
next stage.

Most of the dilemma reads will be resolved in this stage, but a small
portion still remains unconnected. This may be due to the fact that these
reads contain some polyrun, tandem repeats or low complexity sequence
near the 3’ ends that are longer than the k-mer length. Notably, increasing
the k-mer length would not necessarily improve the number of reads
connected, but will drastically increase the computational resources.
Thus, we need another way to tackle those reads.

2.3 Auxiliary reads and cross connection

In the final stage, COPE uses other reads to handle the read pairs uncon-
nected in previous stages. We call these reads auxiliary reads, which are
defined as follows.

First, one or more k-mers with normal frequency are extracted from
both reads in an unconnected read pair. Then all the reads containing
these k-mers are recalled. These reads are the auxiliary reads for validat-
ing a possible overlap of the read pair in concern. More specifically, we
require that all recalled reads to be concordant with the overlap, or the
read pair will remain unconnected. Mismatches between the ends of both
reads were solved as in the previous stage.

Lastly, for the overlapping region, we assign quality values to the bases
as follow. For a mismatch, we assign the base quality of the selected allele
to the nucleotide. For a match, we assign the smaller quality value to the
nucleotide.

3 RESULTS

We tested the efﬁcacy of COPE using both simulated and real
data and illustrated our advantages by comparing to FLASH
(Magoc and Salzberg, 2011), one of the most recently published
utility to join pair—end reads, for correctness and sensitivity. We
also demonstrated that COPE outperforms FLASH in terms of
both length and base accuracy using the dataset published with
FLASH.

3.1 Connection of simulated data

We simulated 30—fold 100 bp pair—end reads with an insert dis—
tance of 180 bp and a standard deviation of 9bp from
Arabidopsis thaliana. The imbalanced error distribution proﬁle
along the Illumina reads was derived by pIRS (Hu et al., 2012)
from a set of human genome reads (Wang et al., 2008) sequenced
by Illumina HiSeq 2000 (downloaded from http://yh.genomics.
org.cn). In the simulated data, 0.9% of pair—end reads had an
actual insert distance 3200 and were unable to be connected,
whereas 11% had a 3/ end overlapped with <10 bp. The simulated
data are available to the public together with the source code.
COPE was designed to fully utilize all sequenced pair—end
reads with an overlap, no matter whether the overlapped
region is only lbp or as long as a read. Thus, we do not need

Table 1. Results of COPE and FLASH on simulated reads

 

Program Error Connected Correctly Authentic
rate (%) (%) overlapped (%) connection (%)

 

FLASH 0.0 89.12 99.74 7
0.5 88.89 99.74 98.14
1.0 88.10 99.74 96.57
3.0 79.55 99.67 85.55
COPE 0.0 99.73 99.98 7
0.5 99.47 99.95 99.54
1.0 99.13 99.95 98.75
3.0 92.56 99.92 93.24

 

to set a minimum overlap length. In contrast, FLASH requires a
minimum overlap of 10 bp. Both COPE and FLASH were set to
allow at most 25% of bases in the overlapping region to be
mismatches. The results for COPE and FLASH for simulated
reads with error rates ranging from 0 to 3% are shown in
Table l. Notably, in the previous study, FLASH considered a
connection as correct as long as the overlap is correct, even if the
wrong base is selected as the consensus base at one of the over—
lapping positions (Magoc and Salzberg, 2011). We continue to
use this criterion as ‘Correctly Overlapped’ in Table 1. However,
due to the fact that a single base error will invalidate all k—mers
spanning the bases (as referred to in the ‘Introduction’ to this
article), and that this will in turn out down the effective data
depth and increase the computational resources consumed dras—
tically in assembly, we exploit a more stringent criterion called
‘Authentic Connection’ in Table l, which requires not only a
correct overlap but also that all bases in the overlapped region
should be selected correctly.

With the ability to connect pair—end reads with an overlap
<10bp, COPE outperforms FLASH with at least 10% more
reads connected when the error rate is <l%, which signiﬁes
the state—of—the—art sequencing quality. In connected reads, rate
of reads that are correctly overlapped is very high for both
COPE and FLASH, with COPE averaging 0.2% higher than
FLASH. When considering the correctness of bases in the over—
lapped region, COPE was better than FLASH with ~1.L2.2%
higher correctness on low error rates. Notably, with a relatively
higher error rate (3%), COPE can still maintain 93.2% correct—
ness of connected reads, which is ~8% higher than FLASH.

Further investigation into the error connected reads by COPE
shows that there are two possible situations where COPE cannot
reach the right answer: (1) where both reads from a read pair are
perfect polyrun or tandem repeats and (2) where both bases at a
position in an overlapped region are simultaneously wrong due
to a high error rate.

3.2 Connection of real data

To make a direct comparison with FLASH as to how authentic—
ally connected reads affect genome assembly, we used short—read
data from Staphylococcus aureus, a bacteria genome, which was
sequenced by the Broad Institute and used by FLASH for evalu—
ation. The data are available at http://gage.cbcb.umd.edu/data.
They comprise 45—fold 101 bp error corrected [using Quake

 

2872

ﬁm'spzumol‘pmﬂo'sopeuuopuorq/ﬁdnq

COPE

 

Table 2. Assembly result using reads of Saureus

 

Program Contig Genome Mismatch Mismatch Indel Indel
N50 covered (bp) rate (bp) rate

(bp) (%)

 

2.18 X 10"“ 50 1.74 X10705
1.29 X 10"“ 105 3.75 X 10"”
5.00 X 10’05 30 1.08 X 10"”

Original 809 96.3 628
FLASH 5171 95.8 361
COPE 11257 95.8 139

Table 3. With a 30-fold constant read depth, the k-mer depth under
different read lengths and k-mer lengths is shown

 

Read length k-Mer length

 

 

31 51 71 91
100 21 15 9 3
180 25 22 18 15

 

(Kelley et al., 2010)] paired—end reads with 180 bp insert distance
(SRA no.2 SRX07714) plus 45x 37 bp mate—pair reads with 3.5
kb insert distance (SRX007l l 1). Note that COPE is able to de—
termine the authentic base in an overlapped region using k—mer
frequency when encountering a sequencing error, error correc—
tion will not signiﬁcantly improve the connection quality of
COPE, but it would be essential to FLASH.

COPE successfully connected 79.2% of read pairs from the
180 bp insert distance library, which is over a quarter higher
than FLASH (52.6%). Unconnected reads were used as
normal pair—end reads with 180 bp insert distance for assembly.
Original reads, reads connected by FLASH and COPE were
assembled by SOAPdenovo, respectively, using the same param—
eters with k—mer length of 31 bp.

As shown in Table 2, using COPE—connected reads, the contig
N50 is over two times longer than FLASH and two orders of
magnitude longer than original reads. The number of mis—
matches and indels using COPE reads is lower than those of
FLASH and Original, this may be due to the reason that
FLASH has inauthentically connected some reads and in turn
introduced errors to the assembly.

To evaluate the mismatch rate of the assembly, we used LAST
(Kielbasa et al., 2011) to compare all contigs to the reference
genome. Noteworthily, with a much higher base accuracy at
overlapped regions, the mismatch rate of COPE is ~2.6 times
lower than FLASH. On the other hand, the mismatch rate of
FLASH is about twice that of using the original reads, this can
be explained by its arbitrary selection of discordinate bases in
overlapped regions.

3.3 Selecting larger k-mer for genome assembly

The quality of genome assembled by de Bruijn graph—based as—
semblers largely depends on the length of k—mer used. The longer
the k—mer used, the greater the number of repetitive sequences
that can be resolved. However, with a constant read length, using
a longer k—mer will drastically decrease the effective depth of k—
mer. The depth of k—mer is calculated using formula (2).

dkmer : dbase X  _   

Note: (I is depth, L and K is the length of read and k—mer,
respectively.

To obtain a reasonable genome assembly, higher k—mer depth
is recommended to avoid insufﬁcient transition between adjacent
k—mers (Li et al., 2012), a depth <20—fold may result in insufﬁ—
cient transition between adjacent k—mers, especially when the

Table 4. Assembling 30-fold error free reads of A.thaliana using different
read lengths and k-mer with SOAPdenovo

 

 

k-Mer Number of Contig N50 Contig N90
length contig (lower (larger the (larger the
the better) better) better)
Original 47 50 663 26 390 1647
COPE 47 46 230 29 441 2117
Original 63 48 307 29 153 1943
COPE 63 40 691 38 414 3038
Original 81 118 919 1782 484
COPE 81 32 242 56 193 4878

 

sequencing error is high. The relationship between k—mer
depth, k—mer length and read length is shown in Table 3.

As shown in Table 3, when using 9l—mer, 100 bp pair—end
reads, they only provide a 3—fold effective k—mer while 180 bp
connected reads can still provide lS—fold. To test the perform—
ance of different length of reads and k—mers, we assembled
30—fold error free pair—end reads from A.thaliana with a k—mer
length range from 47 to 81, using both original and overlapped
reads. The results are shown in Table 4.

COPE—connected reads show its potential to increase Contig
N50 and N90 with both short and long k—mer. When using
8l—mer, the Contig N50 using original reads signiﬁcantly
dropped to an unacceptable level due to the effective k—mer
depth being only 6—fold in this case. However, the improvement
is tremendous for overlapped reads when using 8l—mer, which is
almost twice the contig N50 length of 47—mer.

3.4 Time requirements

COPE runs in two steps. The ﬁrst step is building a k—mer fre—
quency table. This step is multi—threaded and requires 16 GB
memory constantly using k—mer size 17. The second step is con—
necting reads. This step can be parallelized in per lane granularity
without extra memory consumption. We ran both COPE and
FLASH with 30x 100 bp pair—end reads from A.thaliana on a
quad—core Intel i7 3.06GHz desktop computer with 24 GB of
memory. Run times are summarized in Table 5.

As shown in Table 5, the running time of COPE is about
double that of FLASH, but still acceptable. The longer running
time is due to the computation required to determine the con—
nection based on k—mer frequency information. The memory

 

2873

ﬁm'spzumol‘pmﬂo'sopauuopuorq/ﬁdnq

B.Liu et al.

 

Table 5. Time consumption on 30>< A.thaliana reads with FLASH
and COPE. To avoid expensive I/O operations, we make use of a SSD
with an average speed of 550 MB/s for read/ write operations to store
and access the ﬁles

 

Program (Quad-Core) Real time (s) Max memory (M)

 

FLASH 374 3.44
COPE align 237 3.44
COPE Freq.
Freq. loading 157 4109
Connect 426
COPE total 820 4109

 

consumption of COPE mainly depends on the k—mer frequency
table and is independent of the depth of sequencing. We set k to
17, so it requires ~4 GB memory and the memory consumption
is similar even if we increase the depth of sequencing.

The overall running time for COPE is linearly proportional to
the read length multiplied by the number of reads. Bad sequen—
cing quality may also increase the running time proportionally.

4 CONCLUSION AND DISCUSSION

In order to obtain a more comprehensive genome assembly, the
bioinformatics community is always willing to adopt longer
reads without increasing sequencing costs. Several attempts
have been made to make use of the new type of library to gen—
erate longer reads but older methods have failed to maintain
correctness and sensitivity simultaneously. To tackle the prob—
lem, we developed COPE, an accurate tool to make the max—
imum use of overlapped pair—end reads. As shown in our
experiments, highly accurate overlapped reads can drastically
improve the quality of genome assembly.

Besides assembly, overlapped reads can also be used for rese—
quencing. Longer reads will enable the discovery of larger indels
using the split—read method and also facilitate single—nucleotide
polymorphism discovery in mutation concentrated regions like
rearrangement hotspots. The use of longer overlapped reads in
RNA—seq experiments will allow more precise splicing junctions
and expression levels to be deﬁned.

Due to the limitation of read length, COPE may fail to deal
with read pairs from repetitive genome patterns longer than the
insert size if the overlapping region is ﬁlled with tandem repeats
or excessive amount of errors. In the future, we may incorporate

longer reads from other sequencing platform (for example,
Roche 454 FLX+) to facilitate the connection.

ACKNOWLEDGEMENTS

The authors thank the reviewers for their useful feedback and
constructive comments.

Funding: T.—W.L. and R.L.: partially supported by the Hong
Kong GRF grant HKU—7l3512E. The project was also sup—
ported by the State Key Development Program for Basic
Research of China—973 Program [2011CB809203]; National
High Technology Research and Development Program of
China—863 program [2012AA02A201]; the National Natural
Science Foundation of China [90612019]; the Shenzhen Key
Laboratory of Trans—omics Biotechnologies [CXB2011082500
96A]; and the Shenzhen Municipal Government of China
[JC201005260191A and CXB201108250096A].

Conﬂict of Interest: none declared.

REFERENCES

Glenn,T.C. (2011) Field guide to next—generation DNA sequencers. Mol. Ecol.
Resoun, 11, 7597769.

Gnerre,S. et ul. (2011) High-quality draft assemblies of mammalian genomes from
massively parallel sequence data. Proc. Nut] Acud. Sci. USA, 108, 151371518.

Hu,X. et ul. (2012) pIRS: proﬁle—based Illumina pair—end reads simulator.
Bioiiy’ommticx, 28, 153371535.

Kelley,D.R. et ul. (2010) Quake: quality—aware detection and correction of sequen—
cing errors. Genome Biol., 11, R116.

Kielbasa,S.M. et ul. (2011) Adaptive seeds tame genomic sequence comparison.
Genome Re.\'., 21, 4874193.

Li,R. et ul. (2010) De novo assembly of human genomes with massively parallel
short read sequencing. Genome Rec, 20, 2657272.

Li,Z. et ul. (2012) Comparison of the two major classes of assembly algorithms:
overlap—layout—consensus and de—bruijn—graph. Brief Funct. Genomics, 11,
25737.

Magoc,T. and Salzberg,S.L. (2011) FLASH: fast length adjustment of short reads to
improve genome assemblies. Bioiiy’ormuticx, 27, 295772963.

Martin,J.A. and Wang,Z. (2011) Next—generation transcriptome assembly. Nut.
Rev. Genet., 12, 67l$82.

Masella,A.P. et ul. (2012) PANDAseq: PAired—eND assembler for Illumina se—
quences. BMC Bioinformuticx, 13, 31.

Nakamura,K. et ul. (2011) Sequence—speciﬁc error proﬁle of Illumina sequencers.
Nucle‘w Acids Re.\'., 39, e90.

R0drigue,S. et ul. (2010) Unlocking short read sequencing for metagenomics. PLoS
One, 5, e11840.

Wang,J. et ul. (2008) The diploid genome sequence of an Asian individual. Nature,
456, 60—65.

 

2874

ﬁm'spzumol‘pmjxo'sopauuopuorq/ﬁdnq

