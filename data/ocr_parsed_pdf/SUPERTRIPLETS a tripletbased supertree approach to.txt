Vol. 26 ISMB 2010, pages i1 15-i123
doi: 1 0. 1 093/bioinformatics/btq196

 

SUPERTRIPLETS: a triplet-based supertree approach to

phylogenomics

Vincent Ranwezla2’*, Alexis Criscuolo3 and Emmanuel J.P. Douzeryl’:2

1Universit Montpellier 2, 00064, Place Eug ne Bataillon, 34 095 Montpellier Cedex 05, 2CNFtS, Institut des
Sciences de I’Evolution (UMR 5554), 00064, Place Eug ne Bataillon, 34 095 Montpellier and 3|nstitut Pasteur,
D partement de Microbiologie, Unit de Biologie Mol culaire du G ne chez les Extr mophiles, 25 rue du Dr Roux,

75 015 Paris, France

 

ABSTRACT

Motivation: Phylogenetic tree-building methods use molecular data
to represent the evolutionary history of genes and taxa. A recurrent
problem is to reconcile the various phylogenies built from different
genomic sequences into a single one. This task is generally
conducted by a two-step approach whereby a binary representation
of the initial trees is first inferred and then a maximum parsimony
(MP) analysis is performed on it. This binary representation uses a
decomposition of all source trees that is usually based on clades,
but that can also be based on triplets or quartets. The relative
performances of these representations have been discussed but are
difficult to assess since both are limited to relatively small datasets.
Results: This article focuses on the triplet-based representation
of source trees. We first recall how, using this representation, the
parsimony analysis is related to the median tree notion. We then
introduce SUPERTRIPLETS, a new algorithm that is specially designed
to optimize this alternative formulation of the MP criterion. The
method avoids several practical limitations of the triplet-based binary
matrix representation, making it useful to deal with large datasets.
When the correct resolution of every triplet appears more often
than the incorrect ones in source trees, SUPERTRIPLETS warrants to
reconstruct the correct phylogeny. Both simulations and a case
study on mammalian phylogenomics confirm the advantages of
this approach. In both cases, SUPERTRIPLETS tends to propose less
resolved but more reliable supertrees than those inferred using MATRIX
REPRESENTATION with PARSIMONY.

Availability: Online and JAVA standalone versions of SUPERTRIPLETS
are available at http://www.supertriplets.univ-montp2.fr/

Contact: vincent.ranwez@univ-montp2.fr

1 INTRODUCTION

Representing the evolutionary history of a set of taxa is usually
performed by using a phylogenetic tree. External nodes (leaves)
correspond to operational units, and the root corresponds to
its origin. The whole branching order from the root to each
leaf provides a representation of the evolutionary relationships
among the operational units studied. However, one could readily
observe variations among different trees inferred for a given
phylum, depending on stochastic errors due to site and taxon
sampling, systematic errors induced by model misspeciﬁcations
during probabilistic inferences, and biological errors due to hidden
paralogy, lateral gene transfer and incomplete lineage sorting of
ancestral polymorphism (see Swofford et al., 1996, for a discussion

 

*To whom correspondence should be addressed.

on the causes of incongruence). Summarizing various trees obtained
from independent inferences into a single tree is therefore a recurrent
issue in molecular systematics and phylogenomics. Having a single
tree at hand is not just a simpliﬁcation facilitating the management
of topological information; it is in most cases a necessity to enable
further analyses (see Jeffroy et al., 2006).

Pooling a collection of phylogenetic trees when all of them are
deﬁned on the same leaf set can be done with a consensus tree
(Adams, 1972), such as the widely used strict or majority one
(see Bryant, 2003, for an overview). Actually, the consensus tree
is a particular case of the more general problem of combining
trees deﬁned on partially overlapping leaf sets. The latter case
is known as the supertree problem (Gordon, 1986), whereby the
aim is to build a tree (the supertree) summarizing the topological
information induced by a collection of source (input) trees as well
as possible. It has long been proposed that the median tree, i.e. the
tree minimizing the sum of distances to the source trees, could be
considered as an adequate supertree candidate (Bryant, 1997; Cotton
and Wilkinson, 2007; Wilkinson et (11., 2001). Deﬁning the supertree
as a median turns out to be not only an intuitive deﬁnition but
also a guarantee of the consistency of so-deﬁned supertree methods
(Steel and Rodrigo, 2008). Even though this ensures the consistency
of any median supertree, these authors stressed the importance of
choosing appropriate metrics with regards to the biological setting
and expected computing times. The triplet distance, based on rooted,
binary, three-leaf topologies, has the advantage of being ﬁne-grained
and easy to compute in polynomial time (see Methods section for
more formal deﬁnitions). We thus worked on designing a supertree
method that seeks the triplet median supertree (TMS).

Among the numerous supertree techniques that have been
proposed over the past 20 years, MATRIX REPRESENTATION WITH
PARSIMONY (MRP; Baum, 1992; Ragan, 1992; see also Doyle,
1992) is the most widely used. In brief, MRP ﬁrst encodes the
whole topological signal induced by the source trees into a matrix
of binary pseudocharacters (i.e. the Matrix Representation of the
source trees, here noted MR), and secondly considers the optimal
supertree(s) as the most parsimonious (MP) tree(s) reconstructed
from the MR. If there is more than one MP tree, the standard
approach is to consider the supertree as the strict consensus of
these MP trees (e.g. Wilkinson et al., 2005a; see also Thorley, 2000
for some combinatorial properties). Although alternative consensus
methods are available to merge the topological information of
all optimal MP trees into a supertree (Wilkinson et al., 2007),
considering their strict consensus is a stande way for inferring a
non-ambiguous supertree from a collection of source trees. For these
reasons, all MRP-based supertrees considered in this manuscript

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

V.Ranwez et al.

 

 

 

r aacnnrcnaoot‘
EIABIC 1107????0
Dans|1311?0????0
Comla11??o???o

m|n1?10????o
BAC|E1?1?D???0
A  o

 

Fig. 1. Matrix representation based on triplets (t-MR). Topology T is
decomposed into its set of triplets. The closer phylogenetic afﬁnities of A
and B relative to C, or D or E are indicated by the ABlC, AB|D and AB|E
triplets. This correspondence is also indicated by black circles. Rooting is
ensured by an artiﬁcial all-zero taxon.

are strict consensus of MP trees. To build the MR, several binary
encodings have been proposed. In the stande encoding, denoted
here b-MR, each pseudocharacter represents one bipartition (b)
of the leaf set of the corresponding source tree (Baum, 1992;
Doyle, 1992; Farris et (11., 1970; Ragan, 1992). Alternatively, in
the triplet-based encoding (Nelson and Ladiges, 1994; Wilkinson
et (11., 2004; Williams and Humphries, 2003), denoted here t-MR,
each pseudocharacter represents a triplet (t) of the leaf set of the
corresponding source tree (Fig. 1).

In this article, we ﬁrst recall that, using t-MR, the MP tree(s)
could be viewed as a kind of triplet-based median of the source
trees. After describing some limits of the corresponding supertree
method, i.e. triplet-based MRP (t-MRP), we then propose a new,
simple and fast supertree method, named SUPERTRIPLETS, that
constructs an initial tree using a polynomial algorithm close to the
NEIGHBOR JOINING scheme (NJ; Saitou and Nei, 1987) followed by
iterative improvement based on nearest neighbor interchange (NNI)
moves. SUPERTRIPLETS is dedicated to triplets and explicitly searches
for a triplet-based median supertree. Unlike the TH(SPR/TBR)
triplet supertree heuristics recently proposed by Lin et (11. (2009),
SUPERTRIPLETS uses an asymmetric dissimilarity measure and is able
to propose supertrees that are not ﬁilly resolved. After describing the
SUPERTRIPLETS method, we compare its properties to those of b- and
t-MRP, and those of another triplet-based supertree method, named
TILI (Mosses, 2005), which is the triplet adaptation of the QILI
supertree algorithm (Piaggio-Talice et (11., 2004). Then, to compare
these methods, we present a simulation protocol close to those used
in previous supertree studies (Criscuolo et (11., 2006; Eulenstein
et (11., 2004). There are several other triplet-based supertree building
heuristics, such as MAXCUT (Moran et (11., 2005) and TH(SPR/TBR)
(Lin et (11., 2009), but since there is currently no publicly available
implementation of these approaches, we could not incorporate them
in our comparative analysis. The computer simulation protocol
based on larger taxon sets and larger collections of source trees
enables both comparison of the relative accuracy and running time
performances of SUPERTRIPLETS, t-MRP, b-MRP and TILI, and
validation of their previously discussed properties. In particular,
we show that SUPERTRIPLETS infers supertrees with much fewer
wrong triplets (triplets absent from the initial model tree), and thus
represents a pertinent alternative to the b- and t-MRP approaches.
Lastly, the utility of SUPERTRIPLETS is illustrated by a phylogenomics
inference on 33 mammalian taxa from ~13 000 source trees
collected in the OrthoMaM database (Ranwez et (11., 2007).

2 METHODS

A phylogenetic tree on a set L of leaves is a rooted tree whose leaves are
each bijectively labeled by an element of L (see Semple and Steel, 2003; for
simplicity sake, we use in the following the term tree without ambiguity).
Given a forest F (i.e. a collection of trees), L(F) denotes its set of leaves;
similarly L(T) denotes the leaf set of a tree T. In the following, k denotes the
number of tree(s) inside a forest F (i.e. k = |F|), and n is the total number
of leaves in F (i.e. n = |L(F)|). A clade within a phylogenetic tree is the set
of all leaves that descend from a given node. For example in Figure 1, the
clades of tree T are {A,B}, {A,B,C}, {DE}, and the trivial ones composed
by each of its leaves {A}, {B}, {C}, {D}, {E} and the root-clade L(T). A
triplet is a three-leaf tree. Given three leaves X, Y, Z, a triplet is denoted
XY|Z when its only non-trivial clade is {X,Y}. With these three leaves, the
only possible triplets are then XY|Z, XZ|Y, YZ|X, and the unresolved one,
denoted XYZ. Given a tree T, any subset L’ E L(T) induces another tree on
leaf set L’ denoted as T‘Lu Informally, this restriction of T is the subtree of
T that connects the taxa of L’. In particular, THX,Y,Z) is a triplet said to be
displayed by T (see Fig. 1). A tree T can be completely described by all of its
non-trivial clades. It can also be described by the set tr(T) of all the triplets it
induces (Bryant, 1997; Grunewald 61611., 2007). The triplet distance (13(T1 ,T2)
between two trees T1 and T2 having the same leaf set is the cardinality of
the symmetric difference between tr(T1) and tr(T2) (Critchlow at 611., 1996;
Dobson, 1975). This deﬁnition is similar to that of the bipartition distance
(Bourque, 1978; Robinson and Foulds, 1981), except that the respective sets
of triplets of T1 and T2 are considered instead of the sets of leaf bipartitions
induced by each of their internal branch. When two trees have the same leaf
set, the triplet distance is thus the number of resolved triplets present in only
one of these two trees. It directly follows from its deﬁnition that (13 is a
dissimilarity, but it is also a distance since it satisﬁes the triangle inequality
(Bansal at 611., 2008).

2.1 Triplet asymmetric median supertree

Several distances have been proposed to compare two trees with the same
leaf set (e.g. Bourque, 1978; Critchlow 21111., 1996; Dobson, 1975; Robinson
and Foulds, 1981; see also Steel and Penny, 1993). These distances cannot
be directly used to compare a supertree T with a source tree T, since both
do not necessarily have the same leaf set. The similarity between T, and T is
thus generally evaluated through the distance between T, and the supertree T
restricted to L(T)) (e.g. Cotton and Wilkinson, 2007; Creevey and McInerney,
2005). The resulting measure between T and Ti does not satisfy distance
axioms (e.g. trees on different leaf sets can have a distance of 0). Yet in what
follows we will, for simplicity sake, refer to this measure as the distance
between the supertree T and a source tree Ti. Since a supertree is supposed
to summarize a forest, a natural candidate is the median tree minimizing
the sum of distances to the source trees (Bryant, 1997; Wilkinson 21 611.,
2001; Creevey and McInerney, 2005). Several authors have underlined the
equivalence between the majority rule consensus and the median tree based
on bipartition metrics, and Cotton and Wilkinson (2007) generalize this
approach to the supertree setting. Deﬁning supertree as a median turns out
to be not only an intuitive deﬁnition but also a guarantee of fundamental
theoretical properties. Using a model of phylogenetic error, Steel and Rodrigo
(2008) consider supertree in a maximum likelihood (ML) framework, with
the so-deﬁned ML-supertree being simply a median tree (with respect to
tree metrics). This ML framework allows the authors to demonstrate the
statistical consistency of the median supertree approach (i.e. converging to
the true tree as more source trees are added). Even though this result ensures
the consistency of any median supertree deﬁnition, the authors stress the
importance of choosing appropriate metrics. The triplet distance has the
advantage of being easily computed (unlike the SPR distance; Bordewich
and Semple 2004; Hickey at 611., 2008; but see Lin at 611., 2009) and more
ﬁne-grained than the bipartition distance (e.g. Steel and Penny, 1993). As
stated by Williams (2004), it seems that ‘three item data are more sensitive
to how information accumulates to produce overall summary solutions”.

 

i116

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqﬂ:duq wort papeolumoq

9103 ‘{g isnﬁnv 110::

Triplet-based supertrees

 

Considering a source tree T, and the supertree T, the set of triplets over
L(T) can be partitioned into ﬁve sets (Page, 2002): S(T,», T) and D(T,», T),
the triplets resolved in T, and Tram that have same and different topologies,
respectively; R1(Ti, T), the triplets resolved in T, and not resolved in
Tran); R2(T'i, T), the triplets not resolved in T, and resolved in Tran);
X (T), T), the triplets unresolved in both T, and Tram. Using this notation,
a triplet distance between a source tree and a supertree can be formulated as
(L(T), T)=2|D(T,», T)| + |R1(Ti, T)| + |R2(T,», T)|. Minimizing this distance
is closely related to maximizing the similarity |S(T}, T)| as done by Lin
et a1. (2009). Our distance formulation has the advantage of describing the
way unresolved triplets are handled. Indeed, this distance is increased by the
presence of triplet(s) resolved in the supertree T but not in some source trees
Ti, i.e. the set R2(T}, T). Supertrees resolving triplets that are not resolved
in some source trees are thus penalized. The use of the (symmetric) distance
(1, results in considering irresolution in source trees as a signal to take into
account (hard polytomies; Maddison, 1989) rather than as an absence of
signal (soft polytomies; Bansal at 611., 2008). Since polytomies in source trees
are generally considered as soft ones, it seems more suitable to consider the
asymmetric triplet distance: (MT), T): 2 |D(T,», T)| + |R1(Ti, T)|. Note that 8,
is no longer a distance between T, and Tram (due to its asymmetry, 8, is quite
a divergence). The corresponding median supertree deﬁnition is therefore
no longer guaranteed to be consistent overall. However, the consistency still
holds in the special case where source trees are all fully resolved, since in this
case there is no difference between (1, and (3,. Using the asymmetric function
8, weakens the theoretical properties of the corresponding supertree approach
but seems to be more in line with the biological acceptation of polytomies.
Moreover, the advantages of an asymmetric approach have already been
pointed out and exploited in the consensus setting (Phillips and Warnow,
1996).

Given a forest F = {T1, T2 . . . Tk }, the two closely related computational
problems of ﬁnding a TMS (i.e. according to [1,) and ﬁnding a triplet
asymmetric median supertree (TAMS, i.e. according to (3,) can be stated
as ﬁnding a supertree T with L(T): U,»L(T,») that minimizes d,(F, T)=Zi
(L(T), T) and 8,(F, T): Z,» 6,(T,», T), respectively. As conjectured by Bansal
et a1. (2008), the TMS problem is NP-hard due to the NP-completeness of
the maximum triplet compatibility problem (Semple and Steel, 2003). Since
both TMS and TAMS problems are equivalent when source trees are fully
resolved, we conjecture that the TAMS problem is also NP-hard (nothing
indicates that instances of the TMS problem where source trees are fully
resolved are easier than others). The TAMS optimization problem can be
turned into a classical MP optimization problem by using a t-MR of the
source trees (Wilkinson 21 611., 2001, 2005a, 2007). As unresolved triplets
of sources trees are not encoded in the matrix, the MP optimization does,
indeed, tackle the TAMS problem and not the TMS problem. This approach
beneﬁts from long-term efforts to optimize MP local search programs (e.g.
Goloboff at 611., 2008) but is hampered by some limitations due mostly to
its inefﬁcient representation of triplet information. We therefore designed
SUPERTRIPLETS, a heuristic dedicated to the TAMS optimization problem.

2.2 Agglomerative construction of a TAMS

The ﬁrst step of SUPERTRIPLETS aims at converting in 0(kn3) the (rooted)
source trees into weighted triplets, where the weight of each triplet is
the number of source trees containing it. Then the agglomerative scheme
is used to construct an initial supertree. For our triplet-based strategy,
this algorithmic scheme is well adapted, since when an agglomeration is
performed, all resolved triplets that this agglomeration generates in the ﬁnal
supertree are completely determined (see Fig. 2).

Considering the agglomerative scheme as an iterative improvement of
the current supertree T, the aim is to select, during each iteration, the
best agglomeration with respect to the TAMS criterion to minimize. When
modifying a tree T into T’ by proposing a new clade resulting from the
joining of two existing clades CA and CB, SUPERTRIPLETS creates new triplets
ABlX for any set of three taxa {A,B,X} such that Ae CA, B 6C3 and
X ¢ CA U CB (Fig. 2). The difference between 8,(F, T) and 8,(F, T’) depends

T1 T._, T

 

 

 

 

—¢:
—E
\_./'

CAB = {AB}
Cc = {C}

hmoum
bmnom
barium

CE = {B}
CA = {A}

CE = {E}
Co = {D}

 

'DE|c AC|EI
A310 DE|B AC|D
.ABIC DE|A BC|E

my] BC|D

'ABIE'

 

Fig. 2. Detail of the agglomeration process. Each taxon agglomeration step
is denoted by an open circle, and creates some new triplets. Their union is
tr(T), the set of triplets of the ﬁnal binary tree.

only on such newly resolved triplets. Consequently, after agglomerating CA
and C3, the criterion value 8,(F, T’) can be expressed from 8,(F, T) as
8,(F, T’)=8,(F, T)—N+(CA, CB)+N_(CA, Cg). where N+(CA, C3) is
the number of times the new triplets ABlX appear in F , and N ‘(CA, C3)
the number of times an alternative resolution (i.e. AXlB or BXlA) appears in
F. Obviously, 8,(F, T’) < 8,(F, T) if N+(CA,CB) >N_(CA, CB). A natural
approach is then to agglomerate the two clades such that N +(CA, CB)—
N ‘(CA, C3) is maximal. Note, however, that all agglomerations do not
resolve the same number of triplets, and that the importance of a given triplet
is related to the number of times it appears in F , i.e. its weight. During this
agglomeration process, SUPERTRIPLETS thus does not fully take triplet weights
into account, but only uses weights to determine, for each group of three taxa,
the most frequent resolution in source trees (i.e. the triplet with the highest
weight). If a triplet ABlX is more frequent in source trees than its alternative
resolutions (i.e. AXlB and BXlA), it is called a most frequent triplet, denoted
mft. At each step, SUPERTRIPLETS selects the agglomeration leading to the
highest proportion of mft. This criterion ensures that SUPERTRIPLETS will
recover the correct phylogeny for every dataset such that, for any three-taxon
set {A,B,C}, the mft is the correct one. Indeed, in such cases, every creation
of a correct clade leads to 100% of mft, while this proportion is smaller
for incorrect clades. Moreover, the tree obtained during this agglomeration
step will contain every mft and is therefore the one minimizing the TAMS
criterion. More formally, the selected agglomeration is randomly chosen
among those maximizing N’"f’+(CA, Cg)/[N”'ﬁ+(CA, CB)+N”'ﬁ‘(CA, Cg)].
where N’”ﬁ+(CA, C3) is the number of newly resolved triplets that are mft,
and N’m—(CA, C3) the number that conﬂict with mft. It follows that to
evaluate the agglomeration of any pair CA and CB, SUPERTRIPLETS only
needs to have at hand the corresponding values for N’”ﬁ+(CA, CB) and
N’”f"(CA, CB).

During the ﬁrst iteration of the agglomerative process, clades are reduced
to a single taxon, so that for any of the 0(n2) pairs of such trivial connected
component CA and C3, the values N’”ﬁ+(CA, C3) and N’m—(CA, Cg)
correspond to the creation of new triplets ABlX, where A and B are ﬁxed
taxa and where X can take n—2 label values. All the N’”ﬁ+(CA, CB) and
NMﬁT (CA, CB) values are therefore initialized in 0(n3). When two clades
CA1 and CA2 are merged in a new clade CA, this does not change the value
of N’"ﬁ+(CX, CB) as long as both CX and CB differ from CA1, CA2 and
CA. Moreover, the new value N’”ﬁ+(CA, CB) can easily be obtained from
N’"f’+(CA1. C3) and Nmft_(CA2, Cg). Indeed, any triplet ABlX that will be
newly resolved by an agglomeration between CA and C3 is a triplet that
would have been newly resolved by agglomerating CA1 and C3, or CA2 and

 

i117

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqﬂ:duq wort papeolumoq

9103 ‘{g isnﬁnv 110::

V.Ranwez et al.

 

CB. This is simply due to the fact that ifA is inside CA, it was either in CA1
or in CA2. On the other hand, the triplets A1B|X that would have been newly
resolved by the agglomeration of CA1 and CB will also be newly resolved
by the agglomeration of CA and CB, except if X is within CA2. It follows
that N’"ﬁ+(CA, C3) is simply the sum of N’"f’+(CA1, C3) and N”'ﬁ+(CA2,
CB) minus a correction. This correction is equal to twice the number of mft
A1A2 |B (with A1 6 CA1, A; e CA2 and B 6 CB) since these triplets are counted
in both N’”ﬁ+(CA1, CB) and N’”ﬁ+(CA2, C3), and should not be counted in
N’"ﬁ+(CA, C3). The same remark is easily transposed to N”w_(CA,CB).

Once the initial supertree is obtained thanks to the above agglomerative
heuristics, SUPERTRIPLETS checks whether any of its neighbor trees is closer
to the set of source trees F. If so, this particular neighbor is used as the
new current supertree to recheck its tree neighbors. This is repeated until a
supertree is reached such that none of its neighbor trees is better ﬁtted than
itself. The neighborhood used is that deﬁned by the NNI, where a tree T’ is
a tree neighbor of T if T’ can be obtained from T by swapping two subtrees
of T, both of which are rooted on the two extremities of a given edge 2.
Each NNI is therefore related to a speciﬁc internal branch. This heuristics
is often used in fast phylogenetic reconstruction algorithms (e.g. PHYML;
Guindon and Gascuel, 2003). Given an NNI related to an edge e of T, the
resolution of a triplet AB|X will be changed after the NNI if and only if e is
the sole edge separating a clade containing A and B but not X from the ﬁrst
clade containing the three taxa. To evaluate the whole set of possible NNIs,
SUPERTRIPLETS therefore twice considers the occurrences of such triplets as
well as the occurrence of their alternative resolutions, so this can be done
in 0(n3). Note that this is already faster than consulting all triplets since
most of them are not considered at all during this process (no current NNI
can change their resolution). Furthermore, for each NNI around an edge 2,
one can store the value NNI(e) that represents the difference between the
actual criterion and the best value for the two trees that differs from T by
an NNI around 2. Storing those values makes NNI selection very fast, since
once an NNI is actually done around an edge e, the value NNI(e’) only
changes for a handful of edges 2’ close to 2. Since NNI exploration is really
fast, SUPERTRIPLETS uses this advantage to better explore the topology space
using random NNI modiﬁcations that are allowed to temporarily decrease
the quality of the current tree.

2.3 Reliability estimation of supertree edges

Collapsing an edge e transforms the supertree T into a less resolved supertree
T’. Indeed, a set of resolved triplets AB|X is dependent upon the presence
of the edge e and will become unresolved inside T’ . The difference between
8,(F, T) and 8,(F, T’) depends only upon such newly unresolved triplets.
Following the notation used to describe the agglomerative process, we have
8,(F, T’) = 8,(F, T) —N_ (e) +N+(e), where N+(e) represents the number of
times the triplets AB|X induced by 2 appear in F , and N T (e) the number of
appearances of their alternative resolutions (i.e. AX|B or BXlA). A measure
of the reliability of an edge e in a tree T can thus be obtained by considering
the modiﬁcation of T by collapsing e. SUPERTRJPLETS estimates the reliability
of e as N+(e)/[N+(e)+N_ (2)]. This criterion value ranges from O to 1, and
represents the percentage of triplets that supports the edge 2. Note that this
measure only takes a small subset of the triplets included in the current tree
into account. Indeed, some triplets require the collapse of several edges of T
to become unresolved. Using this measure, a supertree can contradict some
input triplets while having all its edges with maximal support. This can be
avoided by considering a global measure involving all triplets. Each edge
deﬁnes a clade that can be incompatible with some triplets present in the
source trees. A global measure can thus be obtained by considering triplets
of source trees that disagree (or agree) with this clade. From this standpoint, a
triplet AB|X of the source trees will inﬂuence the support of every branch of
the supertree that deﬁnes a clade containing A and B but not X (i.e. those that
should be collapsed to obtain an irresolution on A, B and X). The number of
such clades varies among triplets. In order to obtain a measure such that all
triplets have the same importance, the contribution of each triplet is equally
divided among these clades, as suggested by Wilkinson 21 al. (2005b). Hence,

all triplets have the same importance, but while some of them focus on a
single edge, others inﬂuence several edge supports. This provides a global
measure of agreement, i.e. N “(2), and contradiction, i.e. NgT (e), between
source trees and a given edge 2. These measures are then used to deﬁne a
global support of edge 2 deﬁned by N 3+ (e)/ [N g +(e)+N g _(e)]. Though each
triplet inﬂuences all the edges within a path in the supertree and not a single
one, the support of each edge can be estimated in 0(n3). SUPERTRIPLETS uses
these measures to detect edges that must be collapsed. The modiﬁcation of
the supertree, which involves collapsing edges with local support smaller
than 0.5, always reduces the value of 8,(F, T). Since these supports are
interdependent, SUPERTRIPLETS collapses all such edges simultaneously to
avoid arbitrary choice between edges. Then all remaining edges with global
support <O.5 are also simultaneously collapsed. Note that these edges may
have a local support >0.5, for instance if the taxon sampling in source trees
implies that this local support is estimated based on very little information.
Collapsing a single one of these branches will not reduce the divergence
8,(F, T) between the source trees and the supertree, but collapsing several
of them possibly will. Finally, the local supports of the remaining edges are
evaluated and displayed in the ﬁnal supertree as a reliability indication. Using
this conservative procedure, the supertree returned by SUPERTRIPLETS is more
reliable by displaying strongly supported clades, but is also less resolved as
the topological information contained in the source trees is ambiguous.

3 RESULTS

3.1 Simulation Results

Simulations were conducted to compare the behavior of
SUPERTRIPLETS to that of the well-known b-MRP and the alternative
t-MRP methods when analyzing collections of source trees of
varying size and taxon overlap. We also compare these three methods
with the more recently implemented TILI algorithm (Mosses, 2005),
which is the triplet variant of the quartet-based supertree algorithm
QILI (Piaggio-Talice et (11., 2004).

An ultrametric model topology TIIIOdCl with n = 100 ingroup taxa
was generated by the r8s software (Sanderson, 2003) according to a
Yule-Harding branching process (Harding, 1971; Yule, 1925). One
outgroup taxon was (1 posteriori added, with a root-to-tip branch
length of 1.1 substitution per site. To highlight the substitution rate
heterogeneity among taxa and genes, TmOdel was duplicated 50
times, and a global deformation of these identical clocklike trees
was achieved by individual branch length deviation followed by
50 independent total tree length rescaling according to Criscuolo
et (11. (2006). We thus obtained 50 rooted 101-taxon trees with
the same topology as TmOdel but with different branch lengths and
different induced global evolutionary rates. Each of these 50 non-
clocklike phylogenetic trees was used by Seq-Gen (Rambaut and
Grassly, 1997) to generate 50 nucleotide alignments of 101 taxa
under a Kimura (1980) model with transition/transversion ratio of
2.0. The number of aligned sites was uniformly drawn from 200 to
1000 bp. For each alignment, ingroup taxa were randomly deleted
with a probability (1 = 25, 50 and 75% following the procedure ﬁrst
suggested by Eulenstein et (11. (2004).

For each of the three taxon deletion rates ((1:25, 50, 75%),
50 ML trees were then inferred from the 50 partially deleted
alignments with PHYML (Guindon and Gascuel, 2003) under the
Kimura (1980) model with the transition/transversion ratio left
as free parameter. The whole procedure of topology generation,
phylogram deformation, sequence generation, taxon deletion with
three conditions and phylogeny reconstruction by PHYML was
repeated 100 times. Each tree returned by PHYML was then rooted

 

i118

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqﬂ:duq wort papeolumoq

9103 ‘{g isnﬁnv 110::

Triplet-based supertrees

 

by the outgroup taxon. One thus obtains 100 sets of 50 trees for each
of the three values of d.

For each taxon deletion rate d and each of the 100 corresponding
sets of trees, the collections of the ﬁrst k=10, 20, 30, 40, 50
source trees were submitted to SUPERTRIPLETS and TILI. The same
forests were analyzed with both b- and t-MRP. Hence, the b-MR
and the weighted site t-MR were ﬁrst built and, secondly, the
parsimony analyses were performed by the TNT software (Goloboff
et (11., 2008) using 10 random addition sequences and TBR branch
swapping. The ratchet option was used for b-MRP, but not for
t-MRP since this approach uses t-MRs of extremely large size
(e.g. currently more than 500 000 pseudocharacters with (1 =25%
and k=50, despite the site weighting procedure during the t-MR
computing step) which require huge running times to be analyzed
(e.g. at most 20 h, whereas several days are necessary for one
supertree inference with the ratchet option).

To evaluate the degree to which the inferred supertrees agree
with their corresponding model tree TmOdel, we used bipartition-
and triplet-based distances between trees. Given the ﬁve previously
described triplet partitions S, D, R1, R2, X (see Section 2.1), and
the ﬁve corresponding triplet rates s, (1, r1, r2, x, respectively, one
can deﬁne two error types. The proportion of triplets that are in
the supertree but not in the model tree is called the type I error
and corresponds to erroneous information displayed in the supertree
(sometimes called false positive). Reciprocally, the proportion of
triplets that are not in the supertree but in the model tree is called
the type II error, and corresponds to topological information that
is missing in the supertree (sometimes called false negative). The
type I error rate between TmOdel and its related supertree T is then
deﬁned as etI = (d+r2)/(d+s+r2); reciprocally, the type II error
rate is deﬁned as (at); = (d+r1)/(d+s+r1). It should be stressed
that the type II error rate is closely related to the triplet-ﬁt similarity
from Page (2002), which is deﬁned as l-etH.

Since b-MRP optimizes a bipartition-based criterion, not a triplet-
based criterion, both type I and II errors were also computed
at a bipartition level. The bipartition-based error rate etI (et11,
respectively) is deﬁned as the proportion of bipartitions of L(T)
induced by each of the internal branches of T62??? (of T,
respectively) that are not present in T (in T‘Iilg’gsl, respectively).

A low type I error rate means that the supertree T displays few leaf
bipartitions (or triplets) that are not present in TmOdel. Respectively,
a high type II error means that the supertree T does not represent
all the phylogenetic information in TmOdel. For each of the four
supertree methods studied (i.e. b- and t-MRP, SUPERTRIPLETS and
TILI), each taxon deletion rate (i.e. d = 25, 50, 75%) and each forest
size (i.e. k = 10—50), triplet- and bipartition-based et1 and eat” values
were computed and averaged over the 100 replicates. These results
are graphically represented in Figure 3 for the triplet-based errors
and in Figure 4 for the bipartition-based errors.

The simulation results can be alternatively represented by
focusing on the sensitivity (i.e. the true positive rate) and speciﬁcity
(i.e. the complementary of the false positive rate) of the methods.
This representation, unlike the previous one, takes the size of the
triplet (or bipartition) space into account. Using notations introduced
in Section 2.1, the number of false positive triplets is FP = |D| + lel,
the number of false negative triplets is FN= |D|+|R1|, and the
number of true positive triplets is TP= |S|. Finally, since the total
number of resolved triplets on n taxa is n(n—1)(n—2)/2, the number

of true negative triplets is TN = n(n—1)(n — 2)/2— (TP+ FP + FN).
Using these notations, the true positive and false negative rates are
deﬁned as TP/(TP+FN) and FP/(FP+ TN), respectively. Figure 5
depicts the plot of these two rates (i.e. the so-called ROC graph; e. g.
Fawcett, 2004) for the various methods and simulation conditions.

0.3 - o
- type I error I

 

 

_ type 11 error
0.0
0.0 0.1 0.2 0.3

Fig. 3. Type I error rate of supertree methods as a function of type 11 error
rate at the triplet level. Supertrees were inferred from forests by four methods
under three different simulation conditions. Points represent the average
over 100 replicates of the supertree error rates. Symbols correspond to the
methods: b-MRP (open squares), t-MRP (open triangles), SUPERTRJPLETS
(open diamonds) and TILI (open circles). For clarity, symbols corresponding
to each of the four methods are encircled. Colors correspond to the three taxon
deletion rates: (1 =25% (black), 50% (grey) and 75% (white). Arrows point
to the difﬁcult case (1 =75% and k = 10 (see Section 3.1 for more details).

      
 

0.7 - typelerror

0.5 -

0.4 -

SUPER

0.3 -
TRIPLETS

  

0.2 -

 

 

0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7

Fig. 4. Type I error rate as a function of type 11 error rate at the bipartition
level. Symbols and colors have the same meaning as in Figure 3. For clarity,
symbols that correspond to the same method are connected by a line. The
difﬁcult case (1 = 75% and k = 10 is not represented.

 

i119

112 /3.Io's[Bumo[p.IOJXO'sonuIJOJquIq”:duq wort papeolumoq

9103 ‘{g isnﬁnv 110::

V.Ranwez et al.

 

 

 

 

1.0 -
true positive rate
' [sensitivity]
09 -
SUPERTRIPLETS
9 (>0 0 O
o o o o 0
0.8 -
_ log false positive rate
[ log(1-specificity) ] \
0‘7 
>10 5 >9 0 >7 5 >60 »4 5 >3 0 >15

Fig. 5. ROC graph displaying true positive rates as a function of false
positive rates at the triplet level. Symbols, colors and arrows have the same
meaning as in Figure 3. Note that the x-axis is on a logarithmic scale.

1.0 --

     
 

SUPERTRIPLETS

0.9 '-
0.8 --
0.7 --

0.6 --

: true positive rate
- [ sensitivity ]
0.5 --

0.4 --
log false positive rate
_ [ log(l-speci_ficity) ]
0'3 . . . . . : . . . . . i . . . . . : . . . . . ‘
770.5 769.0 767.5 766.0 764.5

 

 

Fig. 6. ROC graph displaying true positive rates as a function of false
positive rates at the bipartition level. Symbols that correspond to the same
method are connected by a line. Symbols and colors have the same meaning
as in Figure 4. Note that the x-axis is on a logarithmic scale.

Based on the fact that the total number of non-trivial bipartition
on n taxa is 2"_1 —n—1, a similar approach can be used to obtain
the bipartition-based ROC graph displayed in Figure 6. It should
be stressed that in ROC graphs (Figs 5 and 6) the best results are
displayed close to top left corner (i.e. the method is both sensitive
and speciﬁc; Fawcett, 2005) whereas in the type I/type II plot (Figs 3
and 4) the best results are close to the bottom left corner (i.e. reduced
type I and II errors.)

SUPERTRIPLETS displays the lowest triplet-based type I errors
(Fig. 3) and false positive rates (Fig. 5) in all cases but the very
difﬁcult one (k = 10 and d = 75%, i.e. few source trees with low taxon
overlap). Indeed, its triplet-based type I errors and false positive
rates are often close to 0, and are signiﬁcantly lower than those
obtained for the three other methods (as assessed by a sign test; e.g.
Dixon and Mood, 1946). This shows that a supertree inferred by
SUPERTRIPLETS displays very few triplets that are not present in the
corresponding model tree (i.e. so-called false positive triplets). In
addition, SUPERTRIPLETS bipartition-based type I errors (Fig. 4) and
false positive rates (Fig. 6) are among the lowest. However, it should
be stressed that b-MRP supertrees show better minimization of
bipartition-based false positive rates for difﬁcult cases, i.e. when the
taxon overlap among source trees is minor (e.g. d = 50% and k f 20,
ord = 75%). This latter result is still expected since b-MRP optimizes
a bipartition-based encoding of the source topologies. Conversely,
SUPERTRIPLETS displays higher triplet-based type II errors and lower
true positive rates than both b- and t-MRP (Figs 3 and 5) whatever the
number of source trees (except for k: 10 and d = 75%). Note also
that, although based on triplet decomposition, TILI has the worst
type I and II errors even when considering triplet error rates (Fig. 3).
For this reason, we will not further discuss results obtained with the
TILI supertree method.

Overall, SUPERTRIPLETS has a much lower type I error whereas
b- and t-MRP have a much lower type II error. Our simulations
therefore suggest that SUPERTRIPLETS infers less-resolved but more
reliable conservative supertrees, whereas b- and t-MRP infers more
resolved but less reliable liberal ones. It is not clear, however,
whether or not both error types have the same importance. Suppose
that starting from a given supertree T, it is possible to modify
it into T’ to resolve 10 additional triplets—everything apart from
these 10 triplets would be the same in T and T’. Among these
10 triplets, suppose that four of them are wrong whereas the six
others are correct. It is thus hard to determine which of these two
supertrees is the most informative summary of the source trees.
This can be formulated as ‘how many true triplets do we require
to accept the introduction of (1 wrong one? ’. The answers certainly
vary depending upon the end-users and the analyses they plan to
conduct with the supertree. As described previously, b-MRP, t-MRP
and SUPERTRIPLETS answer this question in different ways.

3.2 Triplet-based supertree in a phylogenomics context

To stress the beneﬁts of SUPERTRIPLETS for inferring a species
tree, we collected the 12958 trees available in the ﬁfth release of
the OrthoMaM database (Ranwez et (11., 2007). These ML trees
have been inferred from alignments of orthologous gene coding
sequences, as identiﬁed by EnsEMBL v. 54. The alignment sizes
range from 0.1 to 42kb, and the number of taxa from 6 to 33
mammals. A supertree was obtained by using SUPERTRIPLETS on
these 12 958 equally-weighted trees after having rooted them via two
outgroup taxa, i.e. one marsupial (Monodelphis) and one monotreme
(Ornithorhynchus). The running time was very fast (30s on a
MacPro computer with 2.66 GHz dual-core Intel Xeon processor).
The topology inferred (see Fig. 7) is in line with current
knowledge about mammalian phylogenetics (e.g. Prasad et (11.,
2008). SUPERTRIPLETS branch support values range from high to
moderate for deﬁning several supra-ordinal clades: Cetartiodactyla
(0.92), Afrotheria (0.87), Paenungulata (0.82), Euarchontoglires

 

i120

112 /3.Io's[Bumo[p.IOJXO'sonuIJOJquIq”:duq wort papeolumoq

9103 ‘{g isnﬁnv 110::

Triplet-based supertrees

 

 

Ornithorhynchus
Monodeiphis

'— Dasypus
0.94 '— Choioepus
- Echinops

Procavia
0.87
(113': Loxodonta
I: Sorex
0,54 Eri'naceus
EQUUS
Myotis
0.74
ml: Pteropus
Canis
0'6
0  Fair's

Vicugna

_ 05$ Boa.
0154 0‘82 TurSIops
Tupaia

Ochotona
0‘94 I: Oryctolagus

Spermophiius
Cavia

0.76 0.7? Dipodomys
Rattus
DEL—E
Mus

Otoiemur
Microcebus
Tarsius
Macaca
Pongo
Gonna
Homo

Pan

 

 

 

 

 

0.93

 

 

 

 

 

 

 

 

 

 

 

0.81

      

0.90
0.68

Fig. 7. Phylogenomic case study: reconstruction by SUPERTRIPLETS of the
supertree of 33 mammals for which complete genome data are available. The
SUPERTRIPLETS supertree has been inferred from the 12 958 source trees of
OrthoMaM V. 5, i.e. ML trees estimated from DNA orthologous gene coding
sequences (CDS). SUPERTRIPLETS node supports are given.

(0.76), Laurasiatheria (0.74), Boreoeutheria (0.64), Glires (0.59) and
Scrotifera (0.56). This branch support hierarchy (showing the level
of congruence among source trees) is compatible with those reported
by Beck et (11. (2006). Several multifurcations in the supertree
correspond to areas of documented phylogenetic uncertainty:
placental tree root (Afrotheria+Xenarthra, versus either Afrotheria
or Xenarthra ﬁrst; Churakov et (11., 2009), relationships among
Laurasiatheria (Prasad et (11 ., 2008), Tupaia afﬁnities (J anecka et (11 .,
2007), and relationships among the three major Rodentia clades
(Blanga-Kanﬁ et (11., 2009). Rodents and primates are monophyletic
(respective supports: 0.74 and 0.81), and the following within-
order clades are supported: Dipodomys+R(1ttus+Mus (0.59),
Strepsirrhini (0.89) and Haplorrhini (0.59), Catarrhini (0.98) and
Hominoidea (0.85).

Given the huge number of independent multiple sequence
alignments that can be harvested from comparative genomics

projects, there is a need for efﬁcient tools to quickly summarize
the whole phylogenetic signal of the numerous trees inferred from
these various loci. In such phylogenomic cases, when using a
supermatrix approach (obtained by concatenating all alignments),
very large matrices must be dealt with that can exceed the memory
capacity of most today computers. There would also be many
missing data, which could interfere with the optimization process
(Criscuolo et (11 ., 2006). Supertree approaches offer a more tractable
alternative in this setting. SUPERTRIPLETS is especially well tailored
to applications under these conditions since the number of input trees
has little impact on the computer resources it uses. Here, for instance,
assembling the 12 958 CDSs into a supermatrix would have resulted
in a huge matrix made of ~27-million of sites containing 28%
missing character states (some taxa with low-coverage genomes
such as Myotis or Otolemur are not represented for many CDSs).
This matrix is so huge that its phylogenetic analysis would be
problematic due to memory limitations.

Supertree methods are also used for summarizing previously
published phylogenies into a single one that may contain hundreds
to thousands of taxa (e.g. Beck et (11., 2006; Bininda-Emonds
et (11., 2007). We thus compared the computation time of b-MRP,
t-MRP and SUPERTRIPLETS on the OrthoMaM CDS dataset, and
on the mammalian family-level dataset of Beck et (11. (2006) that
contains a total of 115 taxa and 725 weighted source trees (i.e.
6724 trees to account for the differential weighting of individual
source topologies). The computation times were measured on a
3-GHz Intel® CoreTM2 Duo PC with 1.9 Gb RAM. For t-MRP, the
compressed t-MR was obtained in few minutes using the homemade
MRtools software (available on the SUPERTRIPLETS webpage). Since
no substantial efforts were made to optimize this step, we did not
include it when measuring the overall computation time of b-MRP
and t-MRP methods. We thus slightly underestimate their running
times, especially for t-MRP, since the building of the t-MR is an
0(kn3) step. For the three methods, we used the same parameters
as those used for assessing their accuracy (e.g. ratchet for b-MRP
but not for t-MRP, see Section 3.1). On the OrthoMaM dataset,
b-MRP runs in ~18min while t-MRP and SUPERTRIPLETS run in
a couple of seconds. On the mammalian family dataset, b-MRP
runs in ~21 min, t-MRP in ~7 min, and SUPERTRIPLETS in ~10 s.
Moreover, the supertrees obtained by b-MRP and SUPERTRIPLETS are
in agreement with current knowledge on the mammalian phylogeny.
SUPERTRIPLETS thus seems to be a reliable and fast alternative to the
widespread b-MRP method.

4 DISCUSSION

Summarizing various trees obtained from different inferences into
a single one is a frequent task in phylogenetic analysis of multigene
datasets. Supertree methods are able to achieve this task even when
the source trees only have partially overlapping taxon sets. A natural
candidate supertree is the tree that is the closest to the source
trees in terms of a given dissimilarity measure. SUPERTRIPLETS is a
method specially designed to ﬁnd the asymmetric median supertree
according to triplet dissimilarity 6;, and that has several advantages
over the closely related t-MRP method.

In the ﬁrst step of the t-MRP approach, the t-MR of the source trees
depicts them as a set of binary sequences (one sequence per taxon,
plus an extra one consisting only of ‘0’ for an artiﬁcial outgroup
leaf corresponding to the root of all source trees). Given a fully

 

i121

112 /3.IO'S[1211,1110prOJXO'SOIJBLUJOJIIIOTq”Idllq 11101} papBo1u/noq

9103 ‘1gisn8nv 110::

V.Ranwez et al.

 

resolved tree T, the parsimony value for a site encoding XY|Z is one
if T entails this triplet resolution and two if T entails an alternative
resolution (i.e. XZ|Y or YZIX). It follows that the parsimony value of
a binary supertree T for the t-MR of a forest F is simply the number
of pseudocharacters (i.e. the total t-MR length) plus 6; (F, T)/2
(Moran et a1., 2005; Wilkinson, 1994). A t-MRP supertree T is
thus one of the binary trees that minimizes the triplet dissimilarity
6t(F, T) (Wilkinson et a1., 2001, 2005a, 2007). Nevertheless, there
are some practical problems that hamper stande MP analysis
performed to optimize this triplet-based criterion.

First, each pseudocharacter of the t-MR is one of the 0(n3) triplets
induced by one of the k source trees. For comparison, with the
b-MR, one have 0(n) pseudocharacters. The number of source trees
does not impact the number of pseudocharacters since it is common
practice to pre-process them in order to keep only one (weighted)
representative for the many identical pseudocharacters.

Second, for each pseudocharacter of the t-MR, there are only four
informative character states (Fig. 1). It follows that, for instance,
when inferring a supertree on 99 taxa, for each pseudocharacter
the t-MR uses 100 states (99 taxa+root), 96 of which are missing
character states. The t-MR is then made of 96% uninformative
character states and this proportion is constant regardless of whether
or not identical sites are compressed using a weighting procedure.
If the supertree is deﬁned on 999 taxa, the rate of uninformative
character states grows to 99.6%. Each of the 0(n3) triplets, i.e.
stored in 0(1) memory space by SUPERTRIPLETS, is stored in 0(n)
by the t-MR. It follows that, when dealing with t-MRP, both the MR
size and the proportion of missing character states rapidly grows.
Even with weighted pseudocharacters, the size of the t-MR remains
large and requires huge memory to compute the t-MRP supertree
(see Section 3.1). Moreover, a high proportion of missing character
states is known to often slow down any MP tree inference method,
since it may increase both the size and number of local parsimony
optima. By directly considering all weighted triplets (instead of a
t-MR) and by combining them through a polynomial time algorithm,
SUPERTRIPLETS is better suited for achieving this task than t-MRP.

Third, the parsimony criterion does not allow comparison of a
fully resolved tree T with a tree T’ obtained by collapsing edges of
T. Indeed, T’ will always have a parsimony value greater or equal
to that of T. By deﬁnition, the supertree returned by t-MRP is a
summary (using strict consensus) of all MP (ﬁilly) resolved trees.
This supertree is not the best according to the MP criterion; it is just a
practical summary of the MP trees. On the other hand, the criterion
optimized by SUPERTRIPLETS (i.e. asymmetric triplet dissimilarity
6;) naturally allows comparison of trees with different degrees of
resolution.

5 CONCLUSION

We propose SUPERTRIPLETS, a method that ﬁrst constructs a supertree
using a polynomial agglomerative scheme, and, secondly, performs
fast local search to ﬁnd the asymmetric median supertree according
to a triplet dissimilarity. We point out that, by using triplet
representation (i.e. t-MR), this median supertree is one of the MP
binary trees. Computer simulations and a biological case study
indicate that SUPERTRIPLETS tends to propose more reliable but less
resolved supertrees than MRP methods.

We think that this work provides new prospects for designing
supertree methods. On the one hand, SUPERTRIPLETS could certainly

be signiﬁcantly improved. Heuristics searching for the MP tree(s)
have strongly beneﬁted from more than 20 years of improvements,
and have a considerable advantage with respect to method tuning
and implementation tricks (e.g. Goloboff et a1., 2008) as compared
to recently proposed approaches. On the other hand, the conﬁdence
values displayed by SUPERTRIPLETS at the supertree edges are well-
founded, and having an indication of the supertree branch support
is an important feature. Several related conﬁdence values dedicated
to supertree-based comparative studies have already been proposed
(Bininda-Emonds, 2003; Burleigh et a1., 2006; Cotton et a1., 2006;
Moore et a1., 2006; Wilkinson et a1., 2005b). Comparing their
relevance and accuracy is far from easy, as pointed out by Cotton
et a1. (2006), who concluded: ‘Our example at least shows that there
is no single correct View of support for supertrees. ..’. This remark
is relevant for supertree approaches but also reﬂect the intrinsic
difﬁculty of comparing any clade support value in the supertree or
supermatrix context (Burleigh et a1., 2006; Douady et a1., 2003).

ACKNOWLEDGEMENTS

We thank the three referees for their suggestions on the manuscript.
We also thank Guillaume Dugas for the SUPERTRIPLETS webpage
and Khalid Belkhir for helpful advices.

Funding: This work was supported by the Research Networks
Program in Bioinformatics of the High Council for Scientiﬁc
and Technological Cooperation between France and Israel; the
bioinformatics cluster of ISE-M; and the French Agence Nationale
de la Recherche ‘Domaines Emergents’ [ANR-08-EMER-011
‘Phy1Ariane’]. This publication is contribution No. 2010-021 of the
Institut des Sciences de l’Evolution de Montpellier (UMR 5554 -
CNRS), France.

Conﬂict of Interest: none declared.

REFERENCES

Adams,E.N. (1972) Consensus techniques and the comparison of taxonomic trees.
Syst. 2001., 21, 3907397.

Bansal,M.S. et (11. (2008) Comparing and aggregating partially resolved trees.
Lect. Notes C0mput. $01., 4957, 72783.

Baum,B.R. (1992) Combining trees as a way of combining data sets for phylogenetic
inference, and the desirability of combining gene trees. Taxon, 41, 3710.

Beck,R.M.D. et (11. (2006) A higher-level MRP supertree of placental mammals.
BMC EV01. 3101., 6, 93.

Bininda-Emonds,O.R.P. (2003) Novel versus unsupported clades: assessing the
qualitative support for clades in MRP supertrees. Syst. 3101., 52, 8397848.

Bininda-Emonds,O.R.P. et (11. (2007) The delayed rise of present-day mammals. Nature,
446, 5074512.

Blanga-Kanﬂ,S. et (11. (2009) Rodent phylogeny revised: analysis of six nuclear genes
from all major rodent clades. BMC Evol. 3101., 9, 71.

Bordewich,M. and Semple,C. (2004) On the computational complexity of the rooted
subtree prune and regraft distance. Ann. Combinat, 8, 409423.

Bourque,M. (1978) Arbres de Steiner et réseaux dont varie l’emplagement de certains
sommets. PhD Thesis, University of Montreal, Montreal, Canada. (In French).
Bryant,D. (1997) Building trees, hunting for trees and comparing trees. PhD Thesis,

University of Canterbury, Canterbury, New Zealand.
Bryant,D. (2003) Aclassiﬂcation of consensus methods for phylogenies. In Janowitz,M.
et al. (eds), 310c0nsensus. DIMACS, AMS, Providence, RI, pp. 1637184.
Burleigh,J.G et (11. (2006) Supertree bootstrapping methods for assessing phylogenetic
variation among genes in genome scale data. Syst. 3101., 55, 426440.
Churakov,G. et (11. (2009) Mosaic retroposon insertion patterns in placental mammals.
Gen0me Res., 19, 8687875.
Cotton,J.A. and Wilkinson,M. (2007) Majority-rule supertrees. Syst. 3101., 56, 445452.

 

i122

112 /3.Io's17:2an0[p.IOJXO'sonuIJOJquIq”:duq 11101} pQPBOIIIAAOG

9103 ‘1gisn8nv 110::

Triplet-based supertrees

 

Cotton,J.A. et al. (2006) Discriminating supported and unsupported relationships in
supertrees using triplets. Syst. 3101., 55, 3457350.

Creevey,C.J. and McInerney,J.O. (2005) CLANN: investigating phylogenetic
information through supertree analyses. Bioinformatics, 21, 390392.

Criscuolo,A. et al. (2006) SDM: a fast distance-based approach for (super)tree building
in phylogenomics. Syst. 3101., 55, 7407755.

Critchlow,D.E. et al. (1996) The triples distance for rooted bifurcating phylogenetic
trees. Syst. 3101., 45, 3237334.

Dixon,W.J. and Mood,A.M. (1946) The statistical sign test. J. Am. Statist. Assoc., 41,
5577566.

Dobson,A.J. (1975) Comparing the shapes of trees. In Street,A.P. and Wallis,W.D. (eds)
Combinatorial Mathematics III, LNCS, vol. 452. Springer, New York, pp. 957100.

Douady,C.J. et al. (2003) Comparison of Bayesian and maximum likelihood bootstrap
measures of phylogenetic reliability. M01. Biol. Evol., 20, 2487254.

Doyle,J.J. (1992) Gene trees and species trees: molecular systematics as one-character
taxonomy. Syst. 30t., 17, 1447163.

Eulenstein,O. et al. (2004) Performance of ﬂip supertree construction with a heuristic
algorithm. Syst. 3101., 53, 2997308.

Farris,J.S. et al. (1970) A numerical approach to phylogenetic systematics. Syst. 2001.,
19, 1724191.

Fawcett,T. (2004) ROC graphs: notes and practical considerations for researchers.
Technical Report HPL-2003-4. HP Labs, Palo Alto, CA.

Fawcett,T. (2005) An introduction to ROC analysis. Pattern Recogn. Lett., 27, 83874.

Goloboff,P.A. et al. (2008) TNT, a free program for phylogenetic analysis. Cladistics,
24, 7744786.

Gordon,A.D. (1986) Consensus supertrees: the synthesis of rooted trees containing
overlapping sets of labeled leaves. J. Classif., 3, 3357348.

Grunewald,S. et al. (2007) Closure operations in phylogenetics. Math. 310sc1., 208,
5214537.

Guindon,S. and Gascuel,O. (2003) A simple, fast, and accurate algorithm to estimate
large phylogenies by maximum likelihood. Syst. 3101., 52, 693704.

Harding,E. (1971) The probabilities of rooted tree-shapes generated by random
bifurcation. Adv. Appl. Probab., 3, 44777.

Hickey,G. et al. (2008) SPR distance computation of unrooted trees. Evol. Bioinform.
Online, 4, 17727.

Janecka,J.E. et al. (2007) Molecular and genomic data identify the closest living relative
of primates. Science, 318, 7927794.

Jeffroy,O. et al. (2006) Phylogenomics: the beginning of incongruence? Trends Genet,
22, 2254231.

Kimura,M. (1980) A simple method for estimating evolutionary rate of base
substitutions through comparative studies of nucleotide sequences. J. Mol. Evol., 2,
87790.

Lin,H.T. et al. (2009) Triplet supertree heuristics for the tree of life. BMC
Bioinformatics, 10(Suppl. 1), S8.

Maddison,W.P. (1989) Reconstructing character evolution on polytomous cladograms.
Cladistics, 5, 3654377.

Moore,B.R. et al. (2006) Increasing data transparency and estimating phylogenetic
uncertainty in supertrees: approaches using nonparametric bootstrapping. Syst.
3101., 55, 6624676.

Moran,S. et al. (2005) Using semi-deﬁnite programming to enhance supertree
resolvability. In Istrail,S. et al. (eds) Algorithms in Bioinformatics, Proceedings
0fWA312005, Vol. 3692 of LNCS, Springer, Berlin, ALLEMAGNE, pp. 894103.

Mosses,C. (2005) Triplet supertrees. PhD Thesis, University of Aarhus, Aarhus,
Denmark.

Nelson,G and Ladiges,P.Y. (1994) Three-item consensus: empirical test of fractional
weighting. In Scotland,R.W. et al. (eds) Models in Phylogeny Reconstruction.
Clarendon, Oxford, pp. 1937209.

Page,R.D.M. (2002) Modiﬁed MinCut supertrees. In Guig6,R. and Gusﬁeld,D. (eds)
Vol. 2452 of LNCS, Springer, London, UK, pp. 537551.

Phillips,C. and Warnow,T.J. (1996) The asymmetric median treeea new model for
building consensus trees. Discr Appl. Math., 71, 3117355.

Piaggio-Talice,R. et al. (2004) Quartet supertrees. In Bininda-Emonds,O.R.P. (ed)
Phylogenetic Supertrees: Combining Information to Reveal the Tree of Life. Kluwer
Academic Publishers, Dordrecht, pp. 1737191.

Prasad,A.B. et al. (2008) Conﬁrming the phylogeny of mammals by use of large
comparative sequence data sets. M01. Biol. Evol., 25, 179571808.

Ragan,M.A. (1992) Phylogenetic inference based on matrix representation of trees.
M01. Phyl. Evol., 1, 53758.

Rambaut,A. and Grassly,N.C. (1997) Seq-Gen: an application for the Monte Carlo
simulation of DNA sequence evolution along phylogenetic trees. Comput. Appl.
310sc1., 13, 2357238.

Ranwez,V. et al. (2007) OrthoMaM: a database of orthologous genomic markers for
placental mammal phylogenetics. 3MC Evol. 3101., 7, 241.

Robinson,D.F. and Foulds,L.R. (1981) Comparison of phylogenetic trees. Math. 310sc1.,
53, 1314147.

Saitou,N. and Nei,M. (1987) The neighbor-joining method: a new method for
reconstructing phylogenetic trees. M01. Biol. Evol., 4, 406425.

Sanderson,M.J. (2003) r8s: inferring absolute rates of molecular evolution and
divergence times in the absence of a molecular clock. Bioinformatics, 19, 3017302.

Semple,C. and Steel,M. (2003) Phylogenetics. Oxford University Press, Oxford.

Steel,M.A. and Penny,D. (1993) Distribution of tree comparison metrices - some new
results. Syst. 3101., 42, 1267141.

Steel,M.A. and Rodrigo, A. (2008) Maximum likelihood supertree. Syst. 3101., 57,
2434250.

Swofford,D.L. et al. (1996) Phylogenetic inference. In Hillis, D.M. et al. (eds)
Molecular Systematics. Sinauer Associates, Massachussets, pp. 407514.

Thorley,].L. (2000) Cladistic information, leaf stability and supertree construction. PhD
Thesis. University of Bristol, Bristol, UK.

Wilkinson,M. (1994) Three-taxon statements: when is a parsimony analysis also a clique
analysis? Cladistics, 10, 2217223.

Wilkinson,M. et al. (2001) Towards a phylogenetic supertree for platyhelminthes?
In Littlewood,D.T. and Bray,R.A. (eds) Interrelationships of the Platyhelminthes.
Taylor and Francis, Chapman Hall, London, pp. 292301.

Wilkinson,M. et al. (2004) The information content of trees and their matrix
representations. Syst. 3101., 53, 98971001.

Wilkinson,M. et al. (2005a) The shape of supertrees to come: tree shape related
properties of fourteen supertree methods. Syst. 3101., 54, 419431.

Wilkinson,M. et al. (2005b) Measuring support and ﬁnding unsupported relationships
in supertrees. Syst. 3101., 54, 8237831.

Wilkinson,M. et al. (2007) Properties of supertree methods in the consensus setting.
Syst. 3101., 56, 3307337.

Williams,D.M. (2004) Supertrees, components and three-item data. In Bininda-
Emonds,O.R.P. (ed) Phylogenetic Supertrees: Combining Information to Reveal
the Tree of Life. Kluwer Academic Publishers, Dordrecht, pp. 389408.

Williams,D.M. and Humphries,C.J. (2003) Component coding, three-item coding, and
consensus methods. Syst. 3101., 52, 2557259.

Yule,GU. (1925) A mathematical theory of evolution, based on the conclusions of
Dr J.C. Willis. Philos. Trans. Roy. Soc. 3, 213, 21787.

 

i123

112 /3.Io's17:2an0prOJXO'sonuIJOJquIq”:duq 11101} papeo1umoq

9103 ‘1gisn8nv 110::

