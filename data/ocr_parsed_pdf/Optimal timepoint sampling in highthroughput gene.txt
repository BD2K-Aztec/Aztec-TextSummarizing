BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Percentage

n

d

:4 6

II.
8

‘IU 12141b18

 

Number of Timepoints in Da set

/3.10'S[Bum0[p10}x0'SOpBLUJOJuyqu”:duq

I pcrlmm I

O....C.OOO..

 

/3.10'S[Bum0[p10}x0'SOpBLUJOJuyqu”:duq

B.A.Rosa et al.

 

fashion). Consequently, unlike the existing approaches of sampling rate
design (which focus on the inference of values of differential gene expres-
sions; Chikina et al., 2009; Falin and Tyler, 2011; Gustafsson and
Hornquist, 2010), we project the differential gene expression data of
each cluster into threshold space, where the values for a given timepoint
are determined based on how many genes have differential gene expres-
sion values which are higher (or lower) than a series of differential regu-
lation thresholds (Fig. 3B; Algorithm 1, lines 6k10). This thresholding
process reduces noise in the comparison among datasets by ignoring
small ﬂuctuations in differential gene expression value patterns while
capturing the overall pattern of the larger gene expression changes at
various magnitudes.

To avoid the bias introduced by setting only one regulation threshold
value, multiple evenly spaced positive and negative differential regulation
threshold values are defined to determine the degree to which a cluster of
genes is differentially regulated at a given timepoint 1', according to
Equation (1). Given a user-defined threshold number H, we divide the
threshold space (3 SDs above and below the average differential gene
expression value) into two H sections. For example in Figure 3B, an
H-value of 6 has been used, and threshold values are shown.

Mathematically, to perform thresholding for a gene g with an expres-
sion value at timepoint i in dataset R], we compute its differential regula-
tion count (DRC) by counting how many thresholds it is higher (or
lower) than if it is up- (or down-) regulated. This represents the DRC
for timepoint i in dataset Rj (Dif; Equation (1)). Higher DRC numbers
indicate stronger differential regulation, regardless of whether the genes
are upregulated or downregulated. The use of multiple thresholds ensures
that changing patterns in experiments with different dynamic ranges are
captured. For example, in Figure 3C, one gene crosses the top upregula-
tion threshold (at 4.11), and three genes cross the next upregulation
threshold (at 3.29). These counts are made for each regulation threshold
and summed (Equation (1)). DRC curves for all the training and current
datasets for cluster 2 in this case study are shown in Figure 3D.

H
Dv=zz[eg—(My-l>)>o]+[eg_(WM

gch 17:1
(1)

where D'I/ is the DRC for timepoint i in one cluster in dataset R], H is the
user-defined threshold (H > 1), 83 is the differential expression measure-
ment for gene g (out of the set of genes in a cluster) and p, and a are the
average and the standard deviation values, respectively, for the differen-
tial gene expression values across all timepoints and all genes of interest G
in all the training datasets. Operator [X] returns 1 if X is true, otherwise it
returns 0. Similarly, DRC values for the current dataset (5’) are calcu-
lated for each timepoint i in each cluster.

2.4 Data normalization and scaling

To ensure that OTS allows for efficient computation and is capable of
integrating heterogeneous training data, DRC values are saved in a
cluster-time-experiment (CTE) table for each cluster. Table 1 shows the
layout of the CTE table, which includes DRC values (DD) for every time-
point i(l 5 i 5 n) in every training datasetj (l Sj 5 m) in one cluster.
An ‘estimate’ DRC dataset is generated for each cluster by combining
the training datasets from the CTE table, and the difference between the
current and estimate DRC datasets is measured at each timepoint, where
the largest difference is the optimal timepoint for each cluster. However,
combining the training DRC datasets into an estimate DRC dataset is a
difﬁcult problem because the training DRC datasets may not be similar
to each other or to the current DRC dataset (Fig. 3D). Although there
are numerous ways to normalize and scale the datasets (such as
least-squares estimation), the challenge is that the difference between
the estimate and current DRC datasets will not converge to 0 even if
numerous timepoints are added (because of differences among

Table 1. CTE table storing DRC values for one cluster

 

 

Timepoint Training datasets Current Estimate
— dataset
R1 R2 . . . Rm 5 E

:1 D11 D12  BM 151 151

:2 D21 D22 . . . DZ'" 52 DZ

. . . . . . . .. D” . . .

1,, D"1 D"2 . . . 0""? D" D"

 

Each row represents a timepoint available for sampling (TA), and there are columns
for the training (R1 .. .Rm), current (D) and estimate (D) datasets.

experimental conditions and among sampling rates), leading to biased
estimations of the differential gene expression patterns. To tackle this
problem, we have developed a novel two-step (global matching and
local fitting) normalization and scaling approach (Algorithm 1, line 11).

In the first step (global matching), we weight each training DRC data-
set’s contribution to the overall result based on their similarity to the
current DRC dataset in each cluster using NNLS regression (Chen
et al., 2010; Lawson and Hanson, 1995). Mathematically, given a
n X m matrix of DRC values derived from the training DRC datasets
(Di’), and an n X 1 vector of DRC values derived from the current
DRC dataset (D) a non-negative m X 1 weight vector w is calculated,
which minimizes the difference between weighted training and current
DRC datasets (i.e. w = argmin||Dw —D||2). This weight vector w is
then used to calculate a weighted-sum NNLS estimate DRC dataset
(Fig. 3E). By forcing all of the weight values to be non-negative, it
avoids a problem introduced by standard LSE regression, wherein nega-
tive weights can ‘ﬂip’ the patterns, changing peaks to valleys and provid-
ing false information in the estimation. This step also results in
normalization of experiments with different dynamic ranges.

In the second step (local fitting), in order to correct the NNLS estimate
fit, NNLS-weighted sum DRC values are shifted for each timepoint, such
that the final estimate DRC dataset values are equal to the current data-
set DRC values at every sampled timepoint TS (indicated by vertical
dashed grey lines in Fig. 3F). The rest of the timepoints in the
NNLS-weighted estimate DRC dataset are shifted by an amount sug-
gested by the sampled timepoints and modulated by their distance from
the sampled timepoints according to a sigmoid weight distributed (Chen
and Mangasarian, 1995; Marler et al., 2006).

In summary, the estimate value at timepoint t,» (D’) is defined as

Ai

D if ti 6 Ts

D = m H (aft/Du) . (2)
Z WjDIJ +  otherwise
1:] 1+61TAUT31

where

t = arg max
(ETS

 

A m
D'— E wJ-D'J
1'21

and t,» is a timepoint in the interpolated current dataset (TA U T5), 5, is
the DRC value for timepoint t in the current DRC dataset (D) D'I/ is the
DRC value for timepoint t,» in training DRC dataset (R1) and wj is the
weight assigned by NNLS for training data Rj. In the fraction component
of this equation, the numerator calculates the largest observed shift (i.e.
the largest amount of disagreement between the NNLS estimate and the
sampled timepoints in the current dataset), which occurs at timepoint t.
The denominator then reduces the amount of this shift for the given
timepoint t,», such that the shift will be smaller if there is more distance
between t,» and t.

 

 

2776

ﬁm'spzumol‘pmﬂo'sopeuuowrorq/ﬁdnq

 

/810'spzum0fp10}x0"sotJBuIJOJutotqﬂ:duq

Arabr'dopsr's iterative—online
(3 timepoints}



:1 Chanl

E
L‘.
t. .
I1}!
1:-
CL:-
L
0.

Legend

Error Level

AL. ive Learning

 

/810'spzum0fp10}x0"sotJBuIJOJutotqﬂ:duq

an?kgogmomammowoio~&o:3m7.omm\

 

B.A.Rosa et al.

 

added to the training datasets. Here, there was only a 2.0% de—
crease in performance for the first timepoint, but the later time—
points had a slightly >5% decrease in performance (Fig. 6C).

The results of an unsupervised gene selection method are
shown in Figure 6D. Rather than using the knowledge—based
gene ontology gene selection approach used in the other experi—
ments, the top 100 genes with the highest fold change values
across all four training datasets were selected. Here, three
genes were removed from the analysis due to zero—control
values in the current RNA—seq dataset (which result in undefined
fold change values), and 8 clusters were used instead of 10 due to
the smaller gene set size. This 97—gene set had little overlap (12
genes) with the knowledge—based gene selection set. Figure 6D
shows that the performance of the two different gene selection
strategies is similar, suggesting that an unsupervised gene selec—
tion approach could be used to fully automate OTS when
knowledge—based gene categorizations are not applicable.

In summary, these tests indicate that OTS is able to learn
sampling rates from suboptimal training data, its performance
is robust against using irrelevant training data and it is compat—
ible with automatic gene selection methods.

4 CONCLUSON

We have demonstrated that OTS can out—perform existing algo—
rithms at finding optimal timepoints for deﬁning true differential
gene expression patterns for large groups of target genes. We
have shown that this algorithm is robust to the use of sparsely
sampled, poorly matched and cross—platform data, as well as to
noise in the datasets. Because it utilizes existing data effectively,
OTS can be applied on datasets starting with as few as two
timepoints, in contrast to the active learning algorithm which
requires a minimum of five timepoints as input (Singh et al.,
2005).

As high—throughput gene expression measurement technolo—
gies continue to be developed, high—resolution sampling may
eventually become cost—effective. For example, ‘nanostrings’
are a recently developed medium—throughput gene expression
measurement technology capable of measuring up to 800 genes
at once at a relatively low cost (Brumbaugh et al., 2012).
However, using this technology, not all of the genes in the or—
ganism can currently be sampled, and the gene list needs to be
pre—defined. Since OTS simply uses gene differential expression
values as input, it would be possible and very advantageous to
use the results from nanostring or real—time PCR experiments as
training data for OTS, to select optimal timepoints. For
RNA—seq technology, highly multiplex sampling is becoming in—
creasingly accurate, allowing for denser timepoint sampling with
a moderate increase in cost (Islam et al., 2011). As more
time—series datasets are produced due to these advances in tech—
nology, more and better training datasets for OTS will be pro—
duced, and the demand for better knowledge—based timepoint
selection methods will increase.

In this article, OTS was tested only using differential gene
expression values, but it could also be extended to use other
types of data, including raw transcript number counts, relative
protein quantities or any type of measurement that can be
sampled in an online fashion. Overall, OTS can be used to sig—
nificantly improve the results from biological experiments by

allowing researchers to optimize the distribution of timepoints
when there is a limit on the number of samples that can be
measured across a time—series dataset.

The estimation power of extrapolation of time—series gene ex—
pression data is much less than for interpolation, particularly for
relatively simple linear extrapolation methods (Haye et al., 2012).
For this reason, OTS is currently limited to selecting timepoints
within the time range available in training datasets. Eventually,
more sophisticated extrapolation methods such as the non—linear
differential equation models outlined in Haye et al. (2012) may
be integrated to improve the predictive power of OTS.

Funding: This project has been funded by the US. Department
of Energy (Chemical Sciences, Geosciences and Biosciences
Division, grant no. DE—FGO2—91ER20021 to J.C. and Natural
Sciences and Engineering Research Council of Canada Research
Development Fund, Canada to W.Q.

Conﬂict of Interest: none declared.

REFERENCES

Aach,J. and Church,G.M. (2001) Aligning gene expression time series with time
warping algorithms. Bioinﬁ)rmatics, 17, 49y508.

Ashburner,M. et al. (2000) Gene ontology: tool for the unification of biology. The
Gene Ontology Consortium. Nat. Genet, 25, 25729.

Beer,M.A. and Tavazoie,S. (2004) Predicting gene expression from sequence. Cell,
117, 1857198.

Benesty,J. et al. (2004) Time—delay estimation via linear interpolation and cross
correlation. IEEE Trans. Speech Audio Process., 12, 5097519.

Brumbaugh,C.D. et al. (2011) NanoStriDE: normalization and differential expres—
sion analysis of NanoString nCounter data. BMC Bioinformatics, 12, 479.

Chen,C. and Mangasarian,O.L. (1995) Smoothing methods for convex inequalities
and linear complementarity problems. Math. Programming, 71, 51%9.

Chen,R.H. et al. (1999) The spindle checkpoint of budding yeast depends on a
tight complex between the Mad] and Mad2 proteins. Mol. Biol. Cell, 10,
260772618.

Chen,Z. et al. (2010) A study on the focusing power of dynamic photon painting. In
The 52nd Annual Meeting of Am. Assoc. Physicists in Med. AbstractID: 12676.

Chikina,M.D. et al. (2009) Global prediction of tissue—specific gene expression and
context—dependent gene networks in Caenorhabditis elegans. PLoS Comput.
Biol, 5, e1000417.

Cho,R.J. et al. (1998) A genome—wide transcriptional analysis of the mitotic cell
cycle. Mol. Cell, 2, 65773.

Chung,H.S. et al. (2008) Regulation and function of Arabidopsis JASMONATE
ZIM—domain genes in response to wounding and herbivory. Plant Physiol, 146,
9527964.

Coello,C.A. (1999) A comprehensive survey of evolutionary—based multi—objective
optimization techniques. Knowledge Inform. Syst., 1, 1297156.

Cooper,S. and Shedden,K. (2003) Microarray analysis of gene expression during the
cell cycle. Cell Chromosome, 2, l.

Dembl,D. and Kastner,P. (2003) Fuzzy C—means method for clustering microarray
data. Bioinformatics, 19, 9737980.

Edgar,R. et al. (2002) Gene Expression Omnibus: NCBI gene expression and hy—
bridization array data repository. Nucleic Acids Res., 30, 2077210.

Eisen,M.B. et al. (1998) Cluster analysis and display of genome—wide expression
patterns. Proc. Natl Acad. Sci. USA, 95, 14862714868.

Falin,L.J. and Tyler,B.M. (201 1) Using interpolation to estimate system uncertainty
in gene expression experiments. PLoS One, 6, e2207l.

Fernandez—Calvo,P. et al. (2011) The Arabidopsis bHLH transcription factors
MYC3 and MYC4 are targets of JAZ repressors and act additively with
MYC2 in the activation of jasmonate responses. Plant Cell, 23, 7017715.

Goodspeed,D. et al. (2012) Arabidopsis synchronizes jasmonate—mediated defense
with insect circadian behavior. Proc. Natl Acad. Sci. USA, 109, 4674—4677.

Gustafsson,M. and Hornquist,M. (2010) Gene expression prediction by soft inte—
gration and the elastic net—best performance of the DREAM3 gene expression
challenge. PLoS One, 5, e9l34.

 

2780

ﬁle'sreumol‘pmJXO'sopeuuowrorq/ﬁdnq

Optimal timepoint selection

 

Haye,A. et al. (2012) Robust non—linear differential equation models of gene ex—
pression evolution across Drosophila development, BMC Res. Notes, 5, 46.
Islam,S. et al. (2011) Characterization of the single—cell transcriptional landscape by

highly multiplex RNA—seq. Genome Res., 21, 116(kll67.

Kilian,J. et al. (2007) The AtGenExpress global stress expression data set: protocols,
evaluation and model data analysis of UV—B light, drought and cold stress
responses. Plant J., 50, 3477363.

Lawson,C.L. and Hanson,R.J. (1995) Solving Least Squares Problems. 1st edn.
SIAM, Phildelphia.

Marioni,J.C. et al. (2008) RNA—seq: an assessment of technical reproducibility
and comparison with gene expression arrays. Genome Res., 18, 150971517.
Marler,M.R. et al. (2006) The sigmoidally transformed cosine curve: a mathematical
model for circadian rhythms with symmetric non—sinusoidal shapes. Stat. Med.,

25, 389373904.

Martinez,J.S. et al. (2006) Acml is a negative regulator of the CDHl—dependent
anaphase—promoting complex/cyclosome in budding yeast. Mol. Cell Biol., 26,
916279176.

Massonnet,C. et al. (2010) Probing the reproducibility of leaf growth and molecular
phenotypes: a comparison of three Arabidopsis accessions cultivated in ten
laboratories. Plant Physiol., 152, 214272157.

Meijering,E. (2002) A chronology of interpolation: from ancient astronomy to
modern signal and image processing. In Proceedings of the IEEE. Vol. 90,
pp. 3197342. http://ieeexplore.ieee.org/xpl/RecentIssue.jsp?punumber: 5.

Pramila,T. et al. (2006) The Forkhead transcription factor Hcml regulates chromo—
some segregation genes and fills the S—phase gap in the transcriptional circuitry
of the cell cycle. Genes Dev., 20, 226G2278.

Rodriguez—Sanchez,L. et al. (2011) The fission yeast rDNA—binding protein Rebl
regulates G1 phase under nutritional stress. J. Cell. Sci., 124, 25734.

She,R. et al. (2009) genBlastA: enabling BLAST to identify homologous gene se—
quences. Genome Res., 19, 1437149.

Shinozaki,K. and Yamaguchi—Shinozaki,K. (2007) Gene networks involved in
drought stress response and tolerance. J. Exp. Bot., 58, 2217227.

Singh,R. et al. (2005) Active learning for sampling in time—series experiments with
application to gene expression analysis. In Proceedings of the 22nd International
Conference on Machine Learning. pp. 8327839.

Spellman,P.T. et al. (1998) Comprehensive identification of cell cycle—regulated
genes of the yeast Saccharomyces cerevisiae by microarray hybridization. Mol.
Biol. Cell, 9, 327373297.

Thilmony,R. et al. (2006) Genome—wide transcriptional analysis of the
Arabidopsis thaliana interaction with the plant pathogen Pseudomonas syringae
pv. tomato DC3000 and the human pathogen E. coli 0157:H7. Plant J., 46,
34453.

Wang,X. et al. (2008) Short time—series microarray analysis: methods and chal—
lenges. BMC Syst. Biol., 2, 58.

Wierstra,I. and Kloppstech,K. (2000) Differential effects of methyl jasmonate on
the expression of the early light—inducible proteins and other light—regulated
genes in barley. Plant Physiol, 124, 8337844.

Xie,D.X. et al. (1998) C011: an Arabidopsis gene required for jasmonate—regulated
defense and fertility. Science, 280, 109171094.

 

2781

ﬁle'sreumol‘pmJXO'sopeuuowrorq/ﬁdnq

