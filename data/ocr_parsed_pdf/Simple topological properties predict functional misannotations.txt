Vol. 29 ISMB/ECCB 2013, pages i154—i161
doi:10. 1 093/bioinformatics/btt236

 

Simple topological properties predict functional misannotations in

a metabolic network
Rodrigo Liberal and John W. Pinney*

Department of Life Sciences and Centre for Integrative Systems Biology and Bioinformatics, Imperial College London,

London, SW7 2AZ, UK

 

ABSTRACT

Motivation: Misannotation in sequence databases is an important
obstacle for automated tools for gene function annotation, which
rely extensively on comparison with sequences with known function.
To improve current annotations and prevent future propagation of
errors, sequence-independent tools are, therefore, needed to assist
in the identification of misannotated gene products. In the case of
enzymatic functions, each functional assignment implies the existence
of a reaction within the organism’s metabolic network; a first approxi-
mation to a genome-scale metabolic model can be obtained directly
from an automated genome annotation. Any obvious problems in the
network, such as dead end or disconnected reactions, can, therefore,
be strong indications of misannotation.

Results: We demonstrate that a machine-learning approach using
only network topological features can successfully predict the validity
of enzyme annotations. The predictions are tested at three different
levels. A random forest using topological features of the metabolic
network and trained on curated sets of correct and incorrect
enzyme assignments was found to have an accuracy of up to 86%
in 5-fold cross-validation experiments. Further cross-validation against
unseen enzyme superfamilies indicates that this classifier can suc-
cessfully extrapolate beyond the classes of enzyme present in the
training data. The random forest model was applied to several auto-
mated genome annotations, achieving an accuracy of ~60% in most
cases when validated against recent genome-scale metabolic models.
We also observe that when applied to draft metabolic networks for
multiple species, a clear negative correlation is observed between
predicted annotation quality and phylogenetic distance to the major
model organism for biochemistry (Escherichia coli for prokaryotes and
Homo sapiens for eukaryotes).

Contact: j.pinney@imperial.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

Misannotation in sequence databases has been a recognized prob-
lem for more than a decade. Early studies reported the emergence
of this issue (Brenner et al., 1999; Galperin et al., 1998) and esti-
mated that up to 30% of proteins were misannotated in public
databases (Devos and Valencia, 2001). More recent studies have
confirmed that this problem is still a reality (Jones et al., 2007) and
some even suggest that it has been getting worse over time
(Schnoes et al., 2009), identifying overprediction and error propa-
gation as the main sources of error. As experimental veriﬁcation

 

*To whom correspondence should be addressed.

of gene function is expected to remain a highly time-consuming
process, it is unlikely that it will be able to keep pace with the
increasing amount of genome sequence data being deposited in
public databases. More accurate computational methods for func-
tional annotation and assessment of conﬁdence in gene annota-
tions are, therefore, increasingly necessary.

In the area of automated functional annotation, several
approaches moving beyond basic sequence similarity are now
available (Jones et al., 2007). Some recent annotation software
will classify proteins based on locally conserved sequence patterns
that are normally related with function (Forslund and
Sonnhammer, 2008). Other approaches take into account the evo-
lutionary relationships between proteins by integrating evidence
across phylogenetic trees (Engelhardt et al., 2009) or use add-
itional information, such as proteiniprotein interaction data (Ta
and Holm, 2009) or genomic correlations (Hsiao et al., 2010).

However, functional annotation is still mainly based on se-
quence similarity. Given this fact, the accuracy of existing anno-
tations has a crucial impact on that of future annotations (Jones
et al., 2007). This dependency can lead to error propagation and
a consequent increase in the number of annotation errors (Gilks
et al., 2002). Moreover, as information on the origin of annota-
tion is often scarce, this error propagation does not have an easy
solution. The problem becomes even clearer when we note that
the proportion of manually annotated proteins is <5% and con-
tinues to decrease (Frishman, 2007).

Any evidence that is independent of sequence may, therefore,
be useful for discriminating between true and false functional
annotations. The concept of gene function implies interaction
with some part of the cell or the environment, and almost all
functions of interest are the result of interactions among several
components (Hartwell et al., 1999). Modelling these interactions
by means of networks and studying their topological properties
is, therefore, one way to understand the context of these molecu-
lar functions.

One easily accessible example of a well-deﬁned molecular net-
work derived from a set of gene annotations is a draft metabolic
network, such as those available in the KEGG database
(Kanehisa and Goto, 2000; Kanehisa et al., 2006, 2008). The
topological properties of these networks have been studied pre-
viously in the contexts of network evolution (Wagner and Fell,
2001) and drug target discovery W eh et al., 2004). For example,
the metabolic networks of parasitic species are known to be dis-
tinguishable from non-parasitic species on the basis of their top-
ology (Borenstein and Feldman 2009; Nerima et al., 2010).
Intuitively, any problems in such a network, for example, dead
ends or disconnected components, could be an indication of
misannotation (Poolman et al., 2006). However, each individual
type of evidence can be relatively weak (e. g. dead ends may also

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOTJ’BLUJOJIITOTCI”Zduq uIOJJ popcorn/nag

9103 ‘Og isnﬁnV uo ::

Predicting functional misannotations

 

be due to the uptake of nutrients from the environment) and
difficult to discern by manual inspection.

In this work, we propose a supervised machine-learning meth-
odology to assess the accuracy of assigned molecular functions,
based on simple topological properties of an organism’s draft
metabolic network. We show that our approach is able to sep-
arate correct annotations from incorrect ones with accuracy of
up to 86%. Being entirely independent of sequence properties, it
can be used to complement existing approaches and, hence, con-
tribute to the detection and correction of errors in functional
annotation.

2 METHODS
2.1 Metabolic networks

Bipartite (reaction and compound) graphs were used to represent meta-
bolic networks, generated using the KEGG LIGAND database
(Kanehisa et al., 2008). To reconstruct the metabolic network for each
species, all gene functions annotated for that species were collected. The
reactions mapped to each function were then retrieved. Finally, the com-
pounds attached to each reaction were added to produce a bipartite
metabolic network for each species. All reactions were considered as
being reversible. Network topological properties were calculated using
the NetworkX library in Python.

2.2 Training data

Schnoes et a]. (2009) previously examined the annotation errors in four
large public protein databases (KEGG, GenBank NR, UniprotKB/
TrEMBL and UniProtKB/SwissProt). From their correct and incorrect
annotation data, only the annotations with EC number were considered.
In total, there were 834 correct and 477 incorrect annotations from six
different superfamilies. For each annotation, the dataset presents the spe-
cies, KEGG KO group, EC number and the part of the protocol that the
annotation failed to pass. Each annotated function was mapped to a
reaction according to KEGG. Where an EC function was mapped to
more than one reaction, one of these was chosen at random. To evaluate
the topological properties of each of the annotations, KEGG species
networks were used.

2.3 Machine learning

The approach used to separate correct from incorrect annotations was
the random forest. A random forest is an ensemble of decision trees.
During the training process, to achieve a variety of different decision
trees, a random subset of parameters is selected for each node.
Afterwards, as in a standard decision tree, the parameter chosen at
each node is the one that most increases the entropy. To predict the
label of an entry, the entry is assessed by every tree of the ensemble.
The distribution of label votes returned is the random forest prediction.
In our case, the probability of an annotation being correct is taken as the
proportion of trees that labelled it as correct.

The random forest used was the one implemented in the
randomForest R package (Liaw and Wiener, 2002). The algorithm
implemented is as described in Breiman (2001). The parameters used in
both the randomForest and predict functions were the default ones.
For building the receiverwperator characteristic (ROC) curves, the
type = ‘prob’ option in the predict function was used.

2.3.] The 5-fold cross-validation The cross-validation process used
was to start with the original data (D) and divide it in five equal sets. Each
of the sets was used as an independent test set (0,63,). The random forest
algorithm considering all available features was applied to the remaining

four sets (Dmm). The random forest predictor built was then tested on
Dtest-

2.3.2 Inter-superfamin cross-validation The training data were
grouped by enzyme superfamily. Because of the paucity of data in
most superfamilies, only the four most populated superfamilies were
taken forwards to cross-validation. Each superfamin in turn was
removed from the balanced dataset SF to form the test set SE”. The
random forest algorithm was applied to the remainder (SF,,,,,-,,). The
model built was then tested on SE”.

2.3.3 Final classifier The random forest was trained on the whole of
the original data using all the features. The importance function from
the randomForest R package was used to assess each feature’s individual
performance after training the model with the full training set.

2.4 Comparison against curated models

To further validate the classiﬁer, it was applied to 24 KEGG metabolic
networks, and the results were compared with curated genome-scale
metabolic models for these species (Table 4). The species used were the
set with whole-genome models listed in Feist et a]. (2009) for which func-
tions were labelled with EC numbers. For each KEGG model considered,
each annotated function was mapped to a reaction according to KEGG.
Where an EC function was mapped to more than one reaction, one of
these was chosen at random. The classiﬁer was applied to these KEGG
data, and the results were compared with the curated models, verifying
the presence or absence in the curated models of the functions assigned in
the KEGG models.

2.5 Tree of life analysis

Ciccarelli et a]. (2006) have reconstructed a highly resolved tree of life.
Their species tree is built from a concatenation of 31 unambiguous ortho-
logues present in 191 species. This tree and the multiple alignments used
to build it were downloaded from iTOL (Letunic and Bork, 2007, 2011).
iTOL also provides other types of data related to these species, including
genome sizes, domains per genome and publication dates. The multiple
alignment was used to calculate the distances between the species using
pro tdist from PHYLIP (Felsenstein, 1993), a package of programs for
inferring phylogenies. The classiﬁer was applied to the metabolic net-
works present in KEGG for each species included in the iTOL phylogeny.

3 RESULTS AND DISCUSSION

In this study, metabolic networks are represented by bipartite
digraphs (with nodes for each reaction and compound). A net-
work was built for each organism in the study, based on a tem-
plate taken from the KEGG LIGAND database (Kanehisa
et al., 2008).

As with any supervised machine-learning task, it is necessary
to choose a machine-learning method and a set of features from
which to learn. The random forest (Breiman, 2001) was found to
be a suitable machine-learning approach for our aims. The ad-
vantages of using random forests in this work are their ability to
process both numerical and categorical data and the interpret-
ability of their output (a so-called ‘white box’ model). In contrast
to other machine-learning methods, such as neural networks or
support vector machines, random forests can provide insights
into the signals that are useful for classiﬁcation.

Training and testing data sets were taken from the work of
Schnoes et a]. (2009), which provide gold-standard sets of correct
and incorrect EC number assignments within 331 species in

 

i155

112 /310's112u1n0fp10}x0"soiJBMJOJuioiq//:d11q moi; popcorn/nag

9103 ‘Og isnﬁnV uo ::

R.Liberal and J.W.Pinney

 

KEGG, across six enzyme superfamilies. In addition to sequence
similarity approaches at the superfamin and family levels, the
authors used information on functionally important residues to
infer misannotations, making this one of the most reliable data
sources suitable for our purposes.

3.1 Features

In total, 22 different network topological features were
considered in training the classiﬁer. These features can be
placed into three broad groups: local, semi-local and global fea-
tures (Table 1).

Local topological features capture the properties of the imme-
diate neighbourhood of each reaction. Several of these features
are related to the compounds involved in the reaction, each of
which can be classiﬁed according to its connectivity (degree) as
an unpaired, chokepoint or ‘normal’ metabolite (Supplementary
Fig. S1). Based on this classiﬁcation, several integer attributes
were deﬁned for each reaction. We noticed that the connectivity
of compounds involved in a reaction tends to vary depending on
enzyme class; therefore, four additional features were deﬁned to
capture this variation. These features correspond to the ranked
connectivities of the reaction’s four least-connected compounds.

The semi-local topological features describe the position of
each reaction within the network. These features are based on
the graph theoretical concepts of betweenness centrality and
eccentricity. The betweenness of a node is the fraction of shortest
paths (geodesics) between all pairs of nodes in the network that
include that node, whereas the eccentricity of a node is the length
of the longest geodesic between the node and all other nodes in
the network. In both cases, these values were also calculated
including weights on the edges of the networks. Weighted meta-
bolic networks have previously proved useful in the automatic
identiﬁcation of biologically meaningful pathways within a meta-
bolic network (Croes et al., 2006). This is a simple way to exclude
spurious links via highly connected compounds, such as water or
adenosine triphosphate. Here, we place a weight on each com-
pound equal to its connectivity. To take variations in network
size into account, we also considered a variant of eccentricity that
is normalized by dividing by the diameter of the connected com-
ponent to which the reaction belongs.

In addition to these reaction-based features, some global topo-
logical features of the network may be relevant, for example, if
the amount of human curation varies between species. We use
the proportion of reactions that have a dead-end compound on
one or both sides as a proxy for the overall reliability of the
network.

Two non-topological features were also considered: taxonomic
domain (Archaea, Bacteria or Eukaryota) and whether the or-
ganism is implicated in a disease. The reason for including these
two features was to allow for potential topological differences
between different domains and between pathogens and non-
pathogens. It has previously been shown that metabolic network
topology can be affected by variations in the selection pressures
experienced during evolution (Borenstein and Feldman, 2009;
Kreimer et al., 2008; Parter et al., 2007).

To gain intuition of which features may have a bigger inﬂu-
ence on the results, the performance of each individual feature
was evaluated independently. Histograms of the correct and

Table 1. Classiﬁcation features

 

Group Feature Deﬁnition

 

1 m Number of compounds connected to >2 reactions.
u Number of unpaired compounds.
t Reaction type: liunpaired compounds on both sides

of the reaction, 2iunpaired compounds on only
one side, 3ino unpaired compounds.

h Number of chokepoint compounds.

c Number of compounds.

c<10 Number of compounds connected to >2 and <10
reactions.

c1040 Number of compounds connected to 1(PSO reactions

c>50 Number of compounds connected to >50 reactions.

R Number of other reactions sharing a compound with

this reaction.
Mean number of other reactions connected to each

‘I

compound.

r1 Number of connections of the least connected
compound.

r2 Number of connections of the second least connected
compound.

r3 Number of connections of the third least connected
compound.

r4 Number of connections of the fourth least connected
compound.

2 e Eccentricity using unweighted edges,

Normalized eccentricity using unweighted edges.

e,, Eccentricity using weighted edges

éw Normalized eccentricity using weighted edges

b Betweenness using unweighted edges

b,, Betweenness using weighted edges

N Number of reactions in the connected component.

[1 2 Fraction of reactions of type 1 or 2 in the network.

G Domain: liBacteria, 27Eukaryota, 37Archaea.

D lispecies is related to disease, Oispecies is not
related to disease.

 

Note: The features chosen were divided into four groups as shown: lilocal,
Zisemi—local, 34global and 4inon—topological.

incorrect annotation data provide a visual summary (Fig. 1
and Supplementary Fig. S2). A quantitative evaluation of each
feature’s performance was also obtained using the importance
function from the randomForest package (Liaw and Wiener,
2002). This function evaluates the accuracy decrease and the en-
tropy decrease when each feature is left out, with results shown in
Supplementary Figure S3.

All metrics show a similar ranking between the features, with
those based on the concepts of betweenness and eccentricity seen
to be the most highly predictive. It is possible that these semi-
local features are able to capture relevant differences in relative
network position (e. g. higher eccentricity indicates reactions that
lie towards the periphery of the network). The weighted network
factor seems to improve the performance of both eccentricity and
betweenness features, although it is more clearly seen in the case
of eccentricity.

The taxonomic domain is the least informative feature. This
may imply that the features already considered, such as the con-
nected component size, may already be capturing any differences

 

i156

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] moi; papBo1u/noq

9103 ‘0g isnﬁnV uo ::

Predicting functional misannotations

 

R

P—Value = 0.0037 2

0.025
12

    

Density
0.015 0.020

0.010

0.005

 

0.000

P-Value = 0.0066

A

ew _ m r,

0.0

P—Value < 2.2e-16

0.02 0.03 0.04

0.01

 

0.00

 

0 200 400 600 800 1000 0.4 0.5 0.6
Value

 

0.7 0.8 0.9 1.0 0 200 400 600 800

Value Value

Fig. 1. Feature histograms. Visualization of the potential value of each attribute in distinguishing the correct functional assignments from the incorrect
ones (rediincorrect annotations; bluegcorrect annotations). The Kolmogorovisrnirnov test shows that each of these attributes has a signiﬁcantly
different distribution for the correct and incorrect annotations. The corresponding P-values are shown on each histogram. Similar histograms for the

remaining features are shown in Supplementary Figure S2

Table 2. The 5-fold cross-validation results

Table 3. Superfamily cross-validation results

 

 

Mean (SD) Superfamily Accuracy Precision Recall AUC
Accuracy 0.86 (0.005) Enolase 0.60 0.57 0.97 0.60
Precision 0.91 (0.009) Vicinal oxygen chelate 0.52 0.86 0.51 0.59
Recall 0.88 (0.011) Haloacid dehalogenase 0.60 0.77 0.46 0.67
AUC 0.92 (0.007) Amidohydrolase 0.66 0.69 0.74 0.68

 

Note: The predictive model performance was assessed by a 5—fold cross—validation.
The table shows the accuracy, precision, recall and AUC of this analysis and their
standard deviations.

between species from different domains. The same might be
happening with the disease-related feature. For example, para-
sitic species may be expected to have a larger number of unpaired
compounds and smaller connected components, making this fea-
ture less informative. However, both features still show some
predictive power.

3.2 Cross-validation

The performance of the classiﬁer on unseen data was assessed
using two types of cross-validation. In 5-fold cross-validation
experiments (Table 2), the model obtained has an accuracy of
~86%. Supplementary Figure S4 shows the ROC curves
obtained for each of the cross-validation folds. The mean area
under the ROC curve (AUROC) was 0.92%. Another important
aspect of performance is how well the predictor would be
expected to perform on enzymes from unseen superfamilies. To
this end, a second cross-validation was performed using the four
most represented superfamilies present in the Schnoes et a]. data-
set: Enolase, Vicinal Oxygen Chelate, Haloacid Dehalogenase
and Amidohydrolase. The cross-validation used the enzymes
from three out of the four superfamilies as a training set and
tested on the enzymes from the fourth (Table 3). In this experi-
ment, with the exception of the Vicinal Oxygen Chelate super-
family, the accuracy of the predictor was consistently >60%.
Supplementary Figure S5 shows the ROC curves for each super-
family. The area under the curve varied between 0.59 and 0.68.

Note: To test performance on unseen enzyme classes, the classiﬁer was assessed in a
leave-one—out cross—validation at the superfamily level. The table shows the accur—
acy, precision, recall and the AUC of each analysis, where each superfanrily in turn
was used as the test dataset.

These results suggest that the functional classes covered in the
training data do have an effect on the rules obtained. For ex-
ample, enzyme classes may occupy topologically distinct pos-
itions in the network, and/or be subject to particular types of
misannotation. However, these results indicate that the classiﬁer
trained on the entire available data set should still be informative
when applied more generally.

3.3 Comparison to a manually curated network

To assess the performance of the model, the classiﬁer was applied
to the 24 KEGG genome annotations. These results were com-
pared with recent manually curated genome-scale metabolic
models as gold standards (Table 4 and Supplementary Fig.
S6). The species used were the whole-genome models listed in
Feist et a]. (2009) for which enzyme functions were labelled with
EC numbers. The AUC results were consistently >0.5, showing a
performance better than random. In fact, in almost half of the
species tested, the classiﬁer produced an AUC of 30.6. There
were only two cases where AUC was found to be <0.5. The worst
result was found with M ycoplasma genitalium, perhaps related to
the fact that this is the smallest prokaryote genome sequenced.

3.4 Case study: an atypical orthologue

An interesting example of the successful identiﬁcation of an
unexpected enzyme function is given by Dittrich et a]. (2008).

 

i157

112 /310's1rzu.mofp.ro;xo"soiwurJOJuioiq/ﬁduq moi; papBo1u/noq

9103 ‘0g isnﬁnV uo ::

R.Liberal and J.W.Pinney

 

Table 4. Genome-scale model validation results

 

KEGG ID Species name AUC Citation

 

ani Aspergillus nidulans 0.56 David et al., 2008
ath Arabidopsis thaliana 0.57 de Oliveira Dal’Molin
et al., 2010

bsu Bacillus subtilis 0.61 Oh et al., 2007

buc Buchnera aphidicola 0.68 Thomas et al., 2009

det Dehalococcoides 0.60 Islam et al., 2010
ethenogenes

eco E.coli K-12 0.55 Reed et al., 2003

hsl Halobacterium salinarum 0.60 Gonzalez et al., 2008

lpl Lactobacillus plantarum 0.64 Teusink et al., 2006

mge M .genitalium 0.43 Suthers et al., 2009

nrne Neisseria meningitidis 0.58 Baart et al., 2007

nph Natronomonas pharaonis 0.60 Gonzalez et al., 2010

pfa Pfalciparum 0.59 Plata et al., 2010

pgi Porphyromonas gingivalis 0.60 Mazumdar et al., 2009

pic Pichia stipitis 0.48 Caspeta et al., 2012

sau Staphylococcus aureus 0.52 Lee et al., 2009

sce S.cerevisiae 0.56 Herrgard et al., 2008

sce S.cerevisiae 0.53 F6rster et al., 2003

sco Streptomyces coelicolor 0.64 Borodina et al., 2005

sco S.coelicolor 0.63 Alarn et al., 2010

son Shewanella oneidensis 0.55 Pinchuk et al., 2010

syn Synechocystis PCC6803 0.57 Nogales et al., 2012

vvu Vibrio vulniﬁcus 0.52 Kim et al., 2011

yprn Yersinia pestis 0.55 Navid and Almaas, 2009

zmo Zymomonas mobilis 0.61 Widiastuti et al., 2011

 

Note: The ﬁnal classiﬁer was applied to KEGG metabolic models, and the results
were compared with curated genome—scale metabolic models for these species.

This work was based on the idea that an evolving enzyme has
more chance to acquire the function of structurally similar
enzymes. A bioinformatic protocol was followed to draw up a
shortlist of candidate functional analogues of a missing enzyme
(dihydroneopterin aldolase, DHNA) in the Plasmodium falcip—
arum folate biosynthesis pathway.

During the process, the authors found two candidates for
ﬁlling the role of the missing enzyme. Both enzymes already
had an assigned function in KEGG: PFF1360w is annotated
as a putative 6-pyruvoyl tetrahydropterin synthase (PTPS) and
PFL1155w as GTP cyclohydrolase I (GTPCH—I). Although
PFF1360w was subsequently experimentally validated as per-
forming the missing DHNA function, KEGG has not yet
updated this annotation. This enables us to apply the classiﬁer
to the KEGG Pfalciparum metabolic network to study this case.

Taking a closer look at the two annotated reactions in their
network context (Supplementary Fig. S14), it can be seen that the
PTPS reaction seems to be a dead end, indicating that this an-
notation is unlikely to be correct. In contrast, the GTPCH—I
enzyme not only has its reactants produced and its products
consumed, as seen in the ﬁgure, but is also assigned to four
chokepoint reactions.

Applying our classiﬁer to these two enzymatic functions, it
returned a probability of 0.94 for the GTPCH—I reaction, indi-
cating that this function seems to make biological sense within its
network context. On the other hand, the PTPS reaction scores

only a probability of 0.21 to be a correct annotation. This simple
case study shows that the classiﬁer has successfully captured the
same network topological features that provided evidence for an
incorrect annotation in the published manual analysis of this

enzyme.

3.5 Comparison of predicted annotation quality across
multiple species

To investigate how annotation quality varies between species, the
classiﬁer was applied to the KEGG metabolic networks of the
species present in the tree of life provided by iTOL (Letunic and
Bork, 2007, 2011). The proportion of enzymatic functions pre-
dicted to be correctly annotated in the network of each species
(i.e. the predicted precision of the set of enzymatic functions
reported by KEGG for that organism) was taken as a measure
of annotation quality. Figure 2 shows the prokaryote phylogen-
etic tree and quality scores for each of the species. The
Escherichia coli strains and the most closely related species pro-
duce the highest scores, indicating their higher levels of curation.
With the exception of Chlamydiae/ Verrucomicrobia and the
Cyanobacteria, all phyla show a wide variety of quality scores.

The number of eukaryotic species provided by iTOL is much
smaller than the number of prokaryotes. Supplementary Figure
S7 shows the eukaryote phylogenetic tree and the quality scores
of the KEGG metabolic networks for each of the species. The
vertebrates and plants produce higher scores than the other spe-
cies. An unexpected result is the relatively low scores reported for
Saccharomyces cerevisiae and Drosophila melanogaster (both
0.73), especially when compared with those achieved by the ver-
tebrates. However, this most probably reﬂects the massive
amount of study that human biochemistry has received relative
to any other eukaryote, including these two important model
organisms.

It is reasonable to expect that the quality of a draft metabolic
network should be better for species that are closely related to
organisms with well characterized biochemistry. Figure 3 shows
that this is indeed the case: there is a clear negative correlation
(R2 = 0.393) between the predicted annotation quality in pro-
karyotes and the phylogenetic distance to E.coli and an even
stronger negative correlation (R2 = 0.779) between the predicted
annotation quality in eukaryotes and the phylogenetic distance
to Homo sapiens.

To check for any dependency between annotation quality and
genome size, a similar scatter plot was drawn (Fig. 4). Although
a positive correlation is present, this may be partially explained
by other factors. In particular, the intracellular obligate species
(highlighted in green in Fig. 4) and the well-curated species (high-
lighted in orange), constituted by the E.coli strains and closely
related species (Salmonella and Yersinia), have distinctly low-
and high-quality scores, respectively. As intracellular obligate
species will tend to have lost many genes that are necessary for
free-living organisms (Ochman and Moran, 2001), their genomes
are smaller than average: intracellular obligates are almost exclu-
sively at the bottom left of the plot. The low-quality scores for
this group of species (Fig. 4) may indicate either an increased
difficulty in reconstructing their metabolic networks by auto-
matic methods or simply the known general topological differ-
ences between their metabolic networks and those of the other

 

i158

112 /310's1rzu.rnofp10}xo"soiwurioiuioiq/ﬁduq moi; papBo1u/noq

9103 ‘0g isnﬁnV uo ::

Predicting functional misannotations

 

 

 

n.57 Flrmlculea
0.54
o 74
0.7:
0.77
am
a.“
o 49
o
053
HS?
0 5a

0.53
as
n.5r
0.51
0.51

0.52
0.50 _
o 45
o as _ _
u 67 Bacteroldeteslchlorohl
use _
o 55
0.53
"T56 ChlamydlaelVerrucomlcrobla

o 59 Spirochaales

co:

an
an
“'5‘ Aminobaclerla

o 72
0.69

inn

Delnococcus—Thermue

0.4:: Cyanabaclerla

Deltaproheobacterla
Acidabacleria

o 49 Epsilonproteobacleria

o
T
l

we Alphaproleobacteria

0.57 Bataprotsobacteria

0,52 Gammaproteobaclerla

 

Fig. 2. Predicted quality of draft metabolic networks across a prokaryote phylogeny. The classiﬁer was applied to all prokaryote species present in the
iTOL phylogeny (Letunic and Bork, 2007, 2011). Coloured clades represent the different phyla present (only phyla with more than one species were
coloured). The names of the phyla are shown to the right. Predicted annotation quality values are represented by grey bars next to the species name

prokaryotes (Ochman and Moran, 2001). These two groups of
species tend to enhance the correlation between predicted anno-
tation quality and genome size. Without these species, the cor-
relation becomes slightly weaker (changing from R2 = 0.51 to
R2 = 0.48).

In addition to the intracellular obligates and well-studied bac-
teria, the box plots in Figure 5 show the predicted annotation
quality for two further sets of species: those with available manu-
ally curated genome-scale reconstructions (GENREs) (Price

et al., 2004) and those that are facultatively intracellular. We
can clearly see the low-quality scores in the obligate (although
not the facultative) intracellular species (P: 1.16e-08) and the
high accuracy scores in the well-studied species set (P:3.06e-
06). However, the extra curation possibly provided by the
existence of a GENRE is not seen to be reﬂected in the semi-
automated annotations within KEGG.

For prokaryotes, possible dependencies on other species attri-
butes were also considered: motility, phylum, pathogenicity,

 

i159

112 /310's1rzu.mofp.ro;xo"soiwurJOJuioiq/ﬁduq moi; papBo1u/noq

9103 ‘0g isnﬁnV uo ::

R.Liberal and J.W.Pinney

 

Eukaryote Prokaryote

Quality

   

Distance to H. sapiens Distance to E. coli

Fig. 3. Variation of predicted annotation quality with phylogenetic dis-
tance to model organism. Left: Scatter-plot showing predicted annotation
quality (precision of annotated reactions according to the classifier) for
eukaryotes against phylogenetic distance to H .sapiens. Right: Scatter plot
showing predicted annotation quality for prokaryotes against phylogen-
etic distance to E.coli (Ciccarelli et al., 2006). The shaded region shows
the 95% conﬁdence interval for the regression line

Eukaryote Prokaryote

   
 
    

x I Lag“,
_ Curated
Organisms .
. Imtaosiiuiat
ligath

Legend
. AnimaIs
. Fungi
. Others
. PIams
1 P100515

. Others

Quality

 

Genome Size Genome Size

Fig. 4. Variation of predicted annotation quality with genome size. Left:
Scatter plot showing predicted annotation quality against genome size in
eukaryotes: species are classiﬁed as animals, fungi, plants, protists and
others. Right: Scatter plot showing predicted annotation quality against
genome size in prokaryotes: orangeiwell-studied species (E.coli strains
and the closely related species Salmonella and Yersinia); greeniintracel-
lular obligate species. The shaded region shows the 95% conﬁdence inter-
val for the regression line

oxygen requirement and habitat (Supplementary Figs S8eS12).
The quality scores do not seem to depend on these attributes,
with the exception of habitat: the species living in specialized
habitats have lower accuracy scores compared with all other spe-
cies (P:4.33e-08). As stated earlier in the text, specialized en-
vironments may be responsible for differences in selective
pressures that could result in detectable differences in metabolic
network topologies.

The possible link between annotation quality and genome size
was also checked in eukaryotes. As show in Figure 4, a positive
correlation is present. However, closer inspection shows that
there are two well-deﬁned groups that contribute to this correl-
ation. Towards the bottom left (small genomes, low-annotation
quality) are the protists and the fungal species, and at the top
right are a group of animals (mostly vertebrates) and plants.
Taken together with the fact that the number of species present
is small, there does not seem to be strong evidence for a direct
link between genome size and annotation quality in eukaryotes.

a Type
* Curated Organisms

- * GENREs

- Intracellular Facultative
0 ‘5 ' * Intracellular Obligates

* Others

0 4—

Fig. 5. Variation of predicted annotation quality with organism type.
Box plot of the distribution of quality scores in different sets of prokary-
ote species: orangeiwell-studied species (E.coli strains and the closely
related species Salmonella and Yersinia); oliveispecies for which there is
a GENRE (Price et al., 2004) available; greenifacultative intracellular
species; blueiintracellular obligate species; magentaiall other species

For both eukaryotes and prokaryotes, other possible depen-
dencies were studied, including the number of publications found
in PubMed for each species and the year that the genomes con-
sidered were published. However, no significant correlations
were found between the quality of the model and these factors
(Supplementary Figs S1&S17).

4 CONCLUSION

Our results have demonstrated that simple topological features
can be used to predict incorrect functional annotations within
metabolic networks. The random forest classiﬁer has not only
achieved high overall cross-validation accuracy but has also been
shown to be informative when applied to enzymes belonging to
superfamilies that were not used in training. This approach is
entirely independent of sequence properties; hence, it could be
used to support automated metabolic reconstruction pipelines, as
well as helping to identify incorrectly annotated enzymes within
public databases. Subsequent improvements in the accuracy of
the genome-scale metabolic models obtained will be of benefit in
their downstream analysis, for example, using constraint-based
methods, such as ﬂux balance analysis (Oberhardt et al., 2009).

For both prokaryotes and eukaryotes, it seems that the quality
of automated metabolic reconstruction decreases with phylogen-
etic distance to the major model organism for biochemistry,
E.coli and human, respectively. However, differences in network
topology between free-living organisms and obligate intracellular
species may make the classiﬁer less accurate when applied to the
latter group of species. Given a larger amount of training data, it
should be possible to produce separate classiﬁers for each of
these two groups.

 

i160

112 /310'S[BaninJOJXO'SOIJBHIJOJIIIOIq/ﬂduq moi; papBo1u/noq

9103 ‘0g isnﬁnV uo ::

Predicting functional misannotations

 

Funding: R.L. is funded by a studentship from the Fundacao
para a Ciencia e a Tecnologia, Portugal. J.W.P. is funded by a
University Research Fellowship from the Royal Society.

Conﬂict of Interest: none declared.

REFERENCES

Alam,M. et a]. (2010) Metabolic modeling and analysis of the metabolic switch in
Streptomyces caelicalar. BM C Genomics, 11, 202.

Baart,G. et a]. (2007) Modeling Neisseria meningitidis metabolism: from genome to
metabolic ﬂuxes. Genome Biol, 8, R136.

Borenstein,E. and Feldman,M.W. (2009) Topological signatures of species inter—
actions in metabolic networks. J. Comput. Biol, 16, 1917200.

Borodina,I. et a]. (2005) Genome—scale analysis of Streptomyces caelicalar a3 (2)
metabolism. Genome Res., 15, 820829.

Breiman,L. (2001) Random forests. Mach. Learn., 45, 5732.

Brenner,S. et a]. (1999) Errors in genome annotation. Trends Genet., 15, 1327133.

Caspeta,L. et a]. (2012) Genome—scale metabolic reconstructions of Pichia stipitis
and Pichia pastoris and in silico evaluation of their potentials. BMC Syst. Biol,
6, 24.

Ciccarelli,F.D. et a]. (2006) Toward automatic reconstruction of a highly resolved
tree of life. Science, 311, 128371287.

Croes,D. et a]. (2006) Inferring meaningful pathways in weighted metabolic net—
works. J. Mal. Biol, 356, 2227236.

David,H. et a]. (2008) Analysis of Aspergillus nidulans metabolism at the genome—
scale. BMC Genomics, 9, 163.

de Oliveira Dal’Molin,C. et a]. (2010) Aragem, a genome—scale reconstruction of the
primary metabolic network in Arabidapsis. Plant Physiol, 152, 5797589.

Devos,D. and Valencia,A. (2001) Intrinsic errors in genome annotation. Trends
Genet., 17, 4297431.

Dittrich,S. et a]. (2008) An atypical orthologue of 6—pyruvoyltetrahydropterin syn—
thase can provide the missing link in the folate biosynthesis pathway of malaria
parasites. Mal. Microbial, 67, 609$18.

Engelhardt,B.E. et a]. (2009) Phylogenetic molecular function annotation. J. Phys,
180, 12024.

Feist,A.M. et a]. (2009) Reconstruction of biochemical networks in microorganisms.
Nat Rev. Microbial, 7, 1297143.

Felsenstein,J. (1993) PH YLIP — Phylogeny Inference Package (Version 3.5 ).
Distributed by the author. Department of Genetics, University of
Washington, Seattle.

Forslund,K. and Sonnhammer,E.L. (2008) Predicting protein function from
domain content. Biainfarmatics, 24, 168171687.

F6rster,J. et a]. (2003) Genome—scale reconstruction of the Saccharamyces cerevisiae
metabolic network. Genome Res., 13, 244e253.

Frishman,D. (2007) Protein annotation at genomic scale: the current status.
Chem. Rev., 107, 344873466.

Galperin,M. et a]. (1998) Sources of systematic error in functional annotation of
genomes: domain rearrangement, non-orthologous gene displacement and
operon disruption. In Silica Biol, 1, 55—67.

Gilks,W.R. et a]. (2002) Modeling the percolation of annotation errors in a database
of protein sequences. Biainfarmatics, 18, 164171649.

Gonzalez,O. et a]. (2008) Reconstruction, modeling & analysis of Halabacterium
salinarum r—l metabolism. Mal. BioSyst., 4, 1487159.

Gonzalez,O. et a]. (2010) Characterization of growth and metabolism of the
haloalkaliphile Natranamanas pharaonis. PLaS Camput. Biol, 6, e1000799.
Hartwell,L.H. et a]. (1999) From molecular to modular cell biology. Nature, 402

(Suppl. 6761), C477C52.

Herrgard,M. et a]. (2008) A consensus yeast metabolic network reconstruction ob—
tained from a community approach to systems biology. Nat. Biotechnol, 26,
115571160.

Hsiao,T.L. et a]. (2010) Automatic policing of biochemical annotations using gen—
onric correlations. Nat. Chem. Biol, 6, 34e40.

Islam,M. et a]. (2010) Characterizing the metabolism of Dehalacaccaides with a
constraint—based model. PLaS Camput. Biol, 6, e1000887.

Jones,C.E. et a]. (2007) Estimating the annotation error rate of curated go database
sequence annotations. BMC Biainfarm., 8, 170.

Kanehisa,M. et a]. (2006) From genonrics to chemical genonrics: new developments
in KEGG. Nucleic Acids Res., 34, D3547D357.

Kanehisa,M. et al. (2008) KEGG for linking genomes to life and the environment.
Nucleic Acids Res., 36, D48(¥D484.

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and gen—
omes. Nucleic Acids Res., 28, 27730.

Kim,H. et a]. (2011) Integrative genome—scale metabolic analysis of Vibria vulni icus
for drug targeting and discovery. Mal. Syst. Biol, 7, 460.

Kreimer,A. et a]. (2008) The evolution of modularity in bacterial metabolic net—
works. Prac. Natl Acad. Sci. USA, 105, 6976.

Lee,D. et a]. (2009) Comparative genome—scale metabolic reconstruction and ﬂux
balance analysis of multiple Staphylococcus aureus genomes identify novel anti—
microbial drug targets. J. Bacterial, 191, 401$4024.

Letunic,I. and Bork,P. (2007) Interactive tree of life (itol): an online tool for phylo—
genetic tree display and annotation. Biainfarmatics, 23, 1277128.

Letunic,I. and Bork,P. (2011) Interactive tree of life v2: online annotation and dis—
play of phylogenetic trees made easy. Nucleic Acids Res., 39, W4757W478.
Liaw,A. and Wiener,M. (2002) Classiﬁcation and regression by randomforest. R

News, 2, 1&22.

Mazumdar,V. et a]. (2009) Metabolic network model of a human oral pathogen.
J. Bacterial, 191, 74e90.

Navid,A. and Almaas,E. (2009) Genome—scale reconstruction of the metabolic net—
work in Yersinia pestis, strain 91001. Mal. BioSyst., 5, 3687375.

Nerima,B. et a]. (2010) Comparative genonrics of metabolic networks of free—living
and parasitic eukaryotes. BMC Genomics, 11, 217.

Nogales,J. et a]. (2012) Detailing the optimality of photosynthesis in Cyanobacteria
through systems biology analysis. Proc. Natl Acad. Sci. USA, 109, 267872683.

Oberhardt,M.A. et a]. (2009) Applications of genome—scale metabolic reconstruc—
tions. Mal. Syst. Biol, 5, 320.

Ochman,H. and Moran,N.A. (2001) Genes lost and genes found: evolution of bac—
terial pathogenesis and symbiosis. Science, 292, 10931099.

Oh,Y. et a]. (2007) Genome—scale reconstruction of metabolic network in Bacillus
subtilis based on high—throughput phenotyping and gene essentiality data.
J. Biol Chem., 282, 28791728799.

Parter,M. et a]. (2007) Environmental variability and modularity of bacterial meta—
bolic networks. BMC Eva]. Biol, 7, 169.

Pinchuk,G. et a]. (2010) Constraint—based model of Shewanella oneidensis mr—l
metabolism: a tool for data analysis and hypothesis generation. PLaS
Camput. Biol, 6, e1000822.

Plata,G. et a]. (2010) Reconstruction and ﬂux—balance analysis of the Plasmadium
falciparum metabolic network. Mal. Syst. Biol, 6, 408.

Poolman,M.G. et a]. (2006) Challenges to be faced in the reconstruction of meta—
bolic networks from public databases. Syst. Biol, 153, 3797384.

Price,N.D. et a]. (2004) Genome—scale models of microbial cells: evaluating the
consequences of constraints. Nat. Rev. Microbial, 2, 88(r897.

Reed,J. et a]. (2003) An expanded genome—scale model of Escherichia coli K—12
(ijr904 gsm/gpr). Genome Biol, 4, R54.

Schnoes,A.M. et a]. (2009) Annotation error in public databases: nrisannotation of
molecular function in enzyme superfanrilies. PLaS Camput. Biol, 5, e1000605.

Suthers,P. et a]. (2009) A genome—scale metabolic reconstruction of Mycaplasma
genitalium, ips189. PLaS Camput. Biol, 5, e1000285.

Ta,H.X. and Holm,L. (2009) Evaluation of different domain—based methods in
protein interaction prediction. Biochem. Biophys. Res. Commun., 390, 3577362.

Teusink,B. et a]. (2006) Analysis of growth of Lactobacillus plantarum WCFSI on a
complex medium using a genome—scale metabolic model. J. Biol Chem., 281,
40041410048.

Thomas,G. et a]. (2009) A fragile metabolic network adapted for cooperation in the
symbiotic bacterium Buchnera aphidicala. BMC Syst. Biol, 3, 24.

Wagner,A. and Fell,D.A. (2001) The small world inside large metabolic networks.
Prac. Biol Sci., 268, 180371810.

Widiastuti,H. et a]. (2011) Genome—scale modeling and in silico analysis of ethano—
logenic bacteria Zymamanas mabilis. Biatechnal. Biaeng., 108, 655$65.

Yeh,I. et a]. (2004) Computational analysis of Plasmadiumfalciparum metabolism:
organizing genomic information to facilitate drug discovery. Genome Res., 14,
9177924.

 

i161

112 /310'S[BaninJOJXO'SOIJBHIJOJIIIOIq/ﬂduq uror} papeo1umoq

9103 ‘0g1sn8nv uo ::

