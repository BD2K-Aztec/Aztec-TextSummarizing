BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

PleioGRiP: genetic risk

 

Bayes factor that do not pass a user—assigned significance thresh—
old (default threshold 2 e) are dropped. For each SNP that
passes this threshold and hence is associated with at least one
phenotype, the simultaneous association of the SNP with add—
itional phenotypes is scored by the Bayes factor and accepted if
the Bayes factor increases. SNPs are ranked by the Bayes factor
of the selected associations, and nested classiﬁers 21, . . . ,ER are
constructed such that 21 uses only the top ranked SNP, 22 uses
the top two SNPs and so forth.

2.2 Prediction

Once nested classiﬁers have been constructed, PleioGRiP can
carry out genetic risk prediction using a variety of different clas—
sification rules. If only one phenotype is being used, prediction is
carried out with either a single classiﬁer 2,, where the optimal
number r of SNPs is selected using cross—validation, or an en—
semble of the ﬁrst r classiﬁers. The single classiﬁer prediction
uses the posterior probability of the phenotype, given the genetic
proﬁle, that is computed using Bayes’ theorem as described for
example in Hartley et al., 2012; Sebastiani et al., 2012b. The
ensemble of classiﬁers predicts based on the average of posterior
probabilities of the phenotype computed from the classiﬁers
21,...,2,. The ensembles of classiﬁers prediction method has
been shown to provide improved classiﬁcation in certain situ—
ations. In particular, it appears to be robust to inclusion of
false positive associations (Hartley et al., 2012).

If PleioGRiP is assigned to search for pleiotropic associations
between SNPs and two or more phenotypes, then additional
prediction methods are available. The joint prediction of all the
phenotypes uses the joint posterior probability of the pheno—
types, given the genotype data that are computed by Bayes’ the—
orem, using the formula:

P(T1&T2|51, ---,5r) 0<P(T1&T2)P(51, ---,5r|T1&T2) =
p(T1&T2)]_[p(S/|T1) 1—1p(SkIT2) Hpmllrlgcm
./ k I

This formula leverages the conditional independences
embedded in NBCs to factorize the probability p(S 1, . . . ,S,
| ESL T 2) [See Hartley et a]. (2012) for details]. Conditional pre—
diction predicts the phenotype of interest for a given subject using
the conditional probability of the subject’s phenotype, given the
genotype and the other secondary phenotype(s). Marginal predic—
tion predicts an assigned phenotype of interest for a given subject
using the posterior probability of the phenotype, given only the
subject’s genotype data. Both conditional and marginal posterior
probabilities can be derived from the joint probability. Prediction
rules can be generated for these types of prediction based on
either single classiﬁers or ensembles of classiﬁers.

2.3 Cross-validation

Cross—validation can be used to: (i) determine the optimal number
of SNPs to use in the final classiﬁer; (ii) estimate various accuracy
metrics of the classiﬁers; and/or (iii) select alternative classiﬁca—
tion thresholds. Cross—validation can be carried out using any
user—deﬁned number of folds, up to and including leave—one—out
cross—validation. For each subject in the discovery set, the
cross—validation risks are calculated using each applicable

prediction method. Using these data, the cross—validation specifi—
city, sensitivity and area under the ROC curve (AUC) can be
calculated for each nested classiﬁer and each prediction rule.
The AUC can be used to estimate the number of SNPs to include
in the ﬁnal classiﬁer to maximize the efﬁcacy of prediction. In
addition, the cross—validation data can be used to determine the
prediction threshold that optimizes the Youdens J statistic for a
given classiﬁer and prediction method. In some cases, particularly
when the phenotypes are unbalanced, this can substantially im—
prove prediction. The utility is designed to be fast and can carry
out these cross—validation functions on 4000—subject, 500 000 SNP
datasets in minutes (for 10—fold cross—validation) on a PC with 64
bit Operating System, 8 GB RAM, Intel 5, 2 2.67 GHz.

2.4 Input and output ﬁles

PleioGRiP requires as input ﬁles a ped ﬁle with genotype data, a
map file with SNP location and a phenotype file with the pheno—
typic data. Both binary and text—based PLINK files are accepted
as format. The output is a set of tab—delimited text ﬁles, including
a model summary ﬁle and various prediction summary files. The
model summary ﬁle lists the top SNPs in descending order of
signiﬁcance, along with the log—Bayes factor, the selected
single—SNP model and mode of inheritance and the full contin—
gency table for that model. The prediction summary files include,
for each nested classiﬁer and each type of prediction: accuracy,
speciﬁcity and sensitivity estimates along with Fisher exact tests
of differential prediction, both with and without prediction
threshold selection AUC’s estimates and 95% conﬁdence inter—
vals. The utility also exports the raw classiﬁcation statistics for
each classiﬁer. R scripts included in the software package can
then perform classiﬁcation using any of these classiﬁers, and
using any user—supplied prediction threshold.

3 EXAMPLE
The program is distributed with an example dataset of 2000 sub—
jects, 7500 SNPs and 75 causal SNPs. To run the program:
java —me8g —jar PleioGRip.jar
—ped simData.bed —map simData.bim —fam simData.fam

—pheno simData.pheno —read plinkBed —model ﬁnd_add
SearchBC

—pleio_parentList ‘DISEASE_A7DISEASE_B’
—optimize runl0FoldCrossValidationOptimization
—mdlSubjListFile list_disc.txt —repSubjListFile list_rep.txt

—twoColSubj Lists
Classiﬁcation _plio

—logDir./logs/—classify replication

where .bed, .bim, .fam, .pheno are input ﬁles with genotypes and
phenotype lists. The software release includes documentation
with descriptions of all the options.

4 CONCLUSION

PleioGRiP is stable, computationally efficient and offers a ﬂex—
ible new tool to GWAS investigators interested in Bayesian gen—
etic risk prediction analyses, either with or without pleiotropy.

 

1087

ﬁm'spzumofpmjxo'sopeuuopuoiq/ﬁdnq

S.W.Hartley and P.8ebastiani

 

Funding: NIH/NHLBI R21HL114237 and NIH/NIA
U19AG023122.

Conﬂict of Interest: This article was prepared while Stephen
Hartley, Ph.D. was employed at Boston University. The opinions
expressed in this article are the author’s own and do not reﬂect
the views of the National Institutes of Health, or the United
States government.

REFERENCES

Hartley,S.W. et a]. (2012) Bayesian methods for multivariate modeling of pleio—
tropic SNP associations and genetic risk prediction. Front. Genet, 3, 176.

Okser,S. et a]. (2010) Genetic variants and their interactions in the prediction of
increased pre—clinical carotid atherosclerosis: the cardiovascular risk in young
ﬁnns study. PLoS Genet., 6, e1001146.

Scutari,M. (2010) Learning Bayesian networks with the bnlearn R package. J. Stat.
S0ftw., 35, 1722.

Sebastiani,P. et al. (2012a) Genetic signatures of exceptional longevity in humans.
PLoS One, 7, e29848.

Sebastiani,P. et al. (2012b) Nave Bayesian classiﬁer and genetic risk score for
genetic risk prediction of a categorical trait: Not so different after all! Front.
Genet., 3, 26.

Thomas,A. et a]. (1992) Bugs: a program to perform Bayesian inference using Gibbs
Sampling. In: Bernardo,J. et al. (ed.) Buye.\'imt Statistics 4. Oxford, UK, Oxford
University Press, pp. 8377842.

 

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

