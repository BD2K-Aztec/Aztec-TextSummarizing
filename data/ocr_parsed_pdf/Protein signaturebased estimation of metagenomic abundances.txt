BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

H.Klingenberg et al.

 

exhibit a typical codon usage or oligonucleotide profile. The only
model—based tool that explicitly includes viral reference data is
NBC (Rosen and Lim, 2012). However, as outlined by the au—
thors, the NBC tool should not be used with mixed reference
databases of, for example, viral and prokaryotic models because
of a preference of NBC estimates for longer genomes. Thus,
NBC virus models are not meant to supplement the microbial
models for full—range taxonomic proﬁling and should therefore
only be applied to pure virus data where no microbial contam—
ination is anticipated.

We here present the ‘Taxy—Pro’ method as the ﬁrst model—
based taxonomic proflling approach that uses protein signatures
instead of the commonly used oligonucleotide signatures. The
features of these protein signatures comprise the frequencies of
protein domain families according to the Pfam database (Finn
et al., 2010). Because it does not make sense to estimate the
protein signature of a single short sequence, we do not perform
a classiﬁcation of metagenomic reads by means of these protein
features. Instead we make use of a mixture model for taxonomic
profiling that has been introduced for oligonucleotide—based pro—
ﬁling of metagenomes (Meinicke et al., 2011). For mixture mod—
eling of protein signatures, we aim to reconstruct the overall
Pfam domain frequencies of a metagenome by a linear combin—
ation of genomic reference signatures. Pfam domain hits have
also been used as a basis for taxonomic profiling by the CARMA
(Krause et al., 2008) and TreePhyler (Schreiber et al., 2010) tools.
However, these tools do not analyze the overall domain frequen—
cies, but perform a computationally expensive phylogenetic clas—
sification of each sequence with a Pfam hit based on a multiple
alignment with the Pfam reference sequences.

In the evaluation of Taxy—Pro, we show that the protein—based
mixture model provides important advantages when compared
with the oligonucleotide—based model. We observed a higher
accuracy of Taxy—Pro in the quantiﬁcation of archaeal DNA,
where the narrow spectrum of available database genomes re—
quires a good generalization of the profiling method. In addition,
we demonstrate that protein—based models can be built from viral
metagenomes to obtain realistic estimates of the virus fraction.
Our results indicate a strikingly higher sensitivity of the extended
Taxy—Pro mixture model when compared with homology—based
classiﬁcation methods merely based on genomic reference data.
Using the domain frequencies as obtained from the CoMet web
server (Lingner et al., 2011), computation is about three orders of
magnitude faster than a speed—optimized BLAST analysis that
includes viral metagenome sequences as reference data.

Because of this computational efﬁciency, we were able to per—
form a large—scale analysis of sequence data from the Human
Microbiome Project (HMP, Peterson et al., 2009) without
using a computer cluster or special hardware. In agreement
with previous HMP studies (e.g. Huttenhower et al., 2012), we
found that archaea are not among the abundant organisms in
any of the samples. However, we observed a signiﬁcant eukary—
otic fraction in some samples, which has not been reported in the
original studies.

2 SYSTEM AND METHODS

Our novel taxonomic proflling approach ‘Taxy—Pro’ is based on
mixture modeling of the protein domain frequencies in a

metagenome as described in the following. We argue that the
use of functional reference proﬁles as mixture model components
provides a powerful framework to cope with the inherent under—
representation of certain biological entities in current genome
databases. This problem is especially evident in the case of
viruses, and, in fact, it seems not possible to accurately estimate
the fraction of viral DNA in metagenomes merely based on gen—
omic reference data. To overcome this limitation, we explored
the possibility of including metagenomic reference data to im—
prove the proflling accuracy. While the inclusion in Taxy—Pro is
straightforward, a classical BLAST—based pipeline suffers from
the computational burden of such an extension. We therefore
realized a speed—optimized ‘Combi—BLAST’ method to provide
a classical ‘baseline’ approach for comparison with Taxy—Pro (see
Supplementary Material).

2.1 Protein-based mixture modeling

Our new method for taxonomic profiling combines the detection
of protein domains with a mixture model reconstruction of
the resulting domain frequencies by means of taxonomically
labeled protein reference signatures. Thus, our Taxy—Pro
approach comprises two steps: first, we estimate the overall pro—
tein domain distribution of a metagenome by relative frequencies
of Pfam hits using the CoMet domain detection engine. The
resulting proflles comprise the relative frequencies of 12 621 pro—
tein domain families according to release 24 of the Pfam data—
base. Then we approximate the Pfam profile vector y of a
metagenome by linear combination of the precalculated protein
reference signatures x,~ with mixing weights wi according to

M
yzzyvi-xi. (1)
i=1

For estimation of the mixture weights, we use the Expectation—
Maximization (EM) algorithm (Dempster et al., 1977), whereby
2,411 w,~ = 1 and w,~>0. Summing up the mixture weights of all
viral reference signatures, we ﬁnally obtain an estimate of the
virus fraction in a given metagenome. The fraction of bacterial
and archaeal DNA as well as the composition on more speciﬁc
phylogenetic levels was estimated in the same way by summing
up the weights of the corresponding reference signatures.

The approximation error of the above mixture model, i.e. the
divergence between the original Pfam proflle vector y and its
approximation y, we refer to as the fraction of domain hits un—
explained (FDU). The FDU was calculated according to

1 N A
FDU = 5/; Iy/ - yjl (2)

which is half the Manhattan distance between the two proflle
vectors and therefore ranges between 0 and 1. In terms of the
used protein signatures, the FDU measures the fraction of Pfam
domain hits that could not be reconstructed by the model, i.e. the
fraction that is missing in the reconstructed proflle vector y of
predicted domain frequencies. Owing to symmetry, there is an
equally sized fraction of domain hits that are overpredicted by
the model, i.e. that are not present in the actual metagenome
proflle y. Together, these two fractions make up the complete
Manhattan distance according to the overall L1 approximation

 

974

ﬁm'spzumofpmﬂo'sopeuuopuorq/ﬁdnq

Protein signature-based estimation of metagenomic abundances

 

error. This error is an important indicator of the reliability of
the abundance estimates: the better the model fits the actual
distribution of Pfam hits, i.e. the lower the FDU value, the
more we can trust the taxonomic proﬁle that directly results
from the estimated mixture weights. Note that half the
Manhattan distance can also be used to measure the divergence
between two taxonomic proﬁles, whereby the y—values represent
different relative abundances of phyla. In this context, the dis—
tance measure corresponds to the Bray—Curtis dissimilarity,
which is widely used in ecology for comparison of two assem—
blages (Bray and Curtis, 1957).

2.2 Reference signatures from viral metagenomes

For the reference signature vector profiles x,~, we not only used
genomic Pfam proﬁles of several prokaryotes, eukaryotes and
viruses, but we also used a collection of metagenomes for com—
putation of reference vectors. Because the number of available
phage genomes, which have a sufﬁcient length for estimation of
Pfam profiles, is rather small and variation of viral signatures
is large, we use additional reference signatures obtained from
a collection of viral metagenomes. In total, Taxy—Pro includes
92 phage genomes and 102 viral metagenomes in addition to
1730 bacterial, 122 archaeal and 50 eukaryotic genomes to
obtain 2096 functional reference signatures. Because the estima—
tion of Pfam proﬁles requires a sufﬁcient amount of DNA
sequence, we only use phage genomes with a length >100 kbp
for computation of a reference signature.

Depending on the particular treatment, the viral metagenome
data in current databases contain a varying amount of microbial
contamination. For reasons of accuracy the mixture approach
should not be used with viral signatures that arise from sequence
data with only a small virus fraction. Therefore, we implemented
a selection criterion that requires the reference signatures from
viral metagenomes to be well distinguishable from microbial
metagenome signatures. Using the Pfam proﬁles of 260 metagen—
omes from the CAMERA website (http://camera.calit2.net/,
as of April 2010), we trained linear classiﬁers to discriminate
between viral and microbial metagenomes.

A step—wise elimination was applied to reduce the signatures:
regularized least squares classiﬁers on Pfam domain frequencies
(Lingner et al., 2010) were optimized by a 5—fold cross—validation
to minimize the classiﬁcation error. The optimization was per—
formed 10 times, each time with a different random partition for
the cross—validation. Therefore, each signature was used 10 times
as a test example and the one with the highest misclassiﬁcation
rate over the 10 runs was eliminated. The whole procedure was
repeated for the reduced set of signatures until no test error
occurred during the 10 cross—validation runs. In that way the
original number of 151 viral metagenomes was reduced to 102
viral reference signatures that were finally included in the mixture
model (see Supplementary Table S3).

In contrast to the oligonucleotide signatures in the original
Taxy approach, the Pfam signatures in Taxy—Pro depend on se—
quence length. To make genomic and metagenomic Pfam profiles
compatible, we fragmented the genomic sequences before per—
forming the CoMet domain detection. For that purpose, we
used half overlapping fragments with a 400 bp length.

3 IMPLEMENTATION

Taxy—Pro is implemented in the MATLAB programming lan—
guage as an extension of the platform—independent and freely
available Taxy toolbox for MATLAB/Octave (http://gobics.de/
TaxyPro). In addition, Taxy—Pro has been included in the CoMet
web server (http://comet.gobics.de/) to make the method access—
ible via an easy—to—use interface.

4 EXPERIMENTAL EVALUATION

Taxonomic profiling of metagenomes involves two dimensions of
resolution: the depth of the analysis indicates the specificity of
taxonomic categories along the phylogenetic tree and increases
from upper to lower levels. The breadth or range of the analysis
indicates the completeness of taxonomic categories on a particu—
lar level and increases with the number of branches that are
actually included in the estimate. While it may be possible in
particular cases, e.g. in metagenomic diagnostics, to measure
the taxon abundances on phylogenetically rather speciﬁc levels
down to genus or even species rank, this would be difﬁcult to
achieve for the general case. Without prior knowledge about
the true metagenome structure, it is therefore important to first
obtain a coarse but reliable high—level estimate that covers
the full range of biological entities. Ideally, this estimate includes
the fractions of all domains of life and viruses. In our experimen—
tal evaluation, we want to point out the difﬁculties of such
a full—range approach and we provide two comparative studies
to show the large divergence of results from different tools even
on the highest taxonomic level. Finally, we investigate the add—
itional possibility of Taxy—Pro to characterize the uncertainty
of a composition estimate by means of the model approximation
error.

4.1 Measuring archaeal DNA in metagenomes

Microbial genome projects have introduced a strong bias in
the databases toward certain kinds of terrestrial bacteria. As a
consequence, archaeal organisms are currently underrepresented
in genome databases, which complicates the detection of
archaeal DNA in metagenomes because taxonomic proﬁling
methods inherently depend on the available reference genomes.
To investigate how this underrepresentation affects the compos—
ition estimates, we compared method—speciﬁc predictions for
archaea and bacteria using real metagenomic data and simulated
sequencing reads.

The metagenomic dataset we used for comparison of different
profiling methods is derived from oil seep metagenome samples
as described in (Havelsrud et al., 2011). For the Oil Seep data, a
large proportion of archaeal DNA (see Supplementary Material)
has been reported in the original study.

To investigate whether this ﬁnding could be reproduced
with a broad range of methods, we analyzed the results of
11 different tools for taxonomic proﬁling (see Supplementary
Material). For comparison of the composition estimates, we
considered only assignments to the two superkingdom cate—
gories ‘Archaea’ and ‘Bacteria’ and required the two fractions
to yield unit sum. Figure 1 shows the results of our analysis,
which reveals that the estimated fraction for archaea varies
considerably across different methods. For instance, the

 

975

ﬁm'sIeumoI‘pJOJXO'sopeuuopnorq/ﬁdnq

 

|:|Ta><y |:| PhymmBL |:| MEGAN |:| SOrHTEMS :ITaXerro

 

/810'slnum0prOJxo'sopBLuJOJuioiq”:duq

an?kgogmomammowoio~&o:3m7.omm\

a
e
a
h
C
r
A
a
t
o

W
a
k
U
E

  

an?kgogmomammowoio~&o:3m7.omm\

 

Protein signature-based estimation of metagenomic abundances

 

of taxonomically unassigned reads is sometimes taken as an in—
direct indicator for a high virus fraction. In general, such kind of
negative evidence is not valid and can be completely misleading
in metagenomics. Taxy—Pro takes a different approach and per—
forms a taxonomic analysis of the protein signature, which arises
from all functionally assigned reads. The Pfam proﬁle may in
fact provide positive evidence for viral DNA according to a
high similarity with viral reference signatures. Like no other
approach, our Taxy—Pro mixture model allows the integration
of a large amount of viral reference data from metagenomes in
a highly efﬁcient manner. Nevertheless, the limited number and
the small range of environments covered by the current data can
be expected to introduce a strong bias into the estimation of the
viral DNA fraction. Here, our hope is that the rapidly increasing
number of sequencing projects will also provide us with a larger
number and a broader range of viral metagenomes in the
sequence databases.

Also, the quality of the data in terms of a possible contamin—
ation is an important aspect. In fact, many of the viral datasets
can be expected to contain a signiﬁcant fraction of microbial
DNA. To cope with the contamination problem, we have already
shown a possible ﬁrst solution in terms of a reference selection
criterion, which is useful to detect and exclude datasets that
cannot be well distinguished from microbial metagenomes on
the basis of protein domain signatures. Despite the possible con—
tamination, among all state—of—the—art methods, the Taxy—Pro ap—
proach showed by far the most sensitive estimation of viral DNA
abundances and therefore our method can signiﬁcantly contribute
to quality control in microbial and viral metagenomics.

We are aware of the fact that our Taxy—Pro approach relies on
the detection of protein domains and therefore is restricted to the
coding part of metagenomic DNA. Furthermore, the model
quality depends on a sufﬁcient number of Pfam hits, which is
difficult to achieve with small datasets or sequence data with
large error rates. For instance, a high density of undetermined
bases in sequencing reads can substantially decrease the Pfam
detection rate (see Section 4.3). Using the domain detection of
the CoMet web server, the computation of Taxy—Pro estimates is
fast (see Supplementary Table S1) but susceptible to sequencing
errors. Metagenomic gene prediction tools that can, in principle,
compensate for sequencing errors (Rho et al, 2010) could im—
prove the situation in this case. In addition, HMMER3 (Finn
et al, 2011) may be used instead of the faster but less sensitive
CoMet engine to further increase the number of Pfam domain
hits. We suppose that in principle also approaches based on
signature genes, like MetaPhlAn, could be used for abundance
estimation across the full taxonomic range. However, the extrac—
tion of clade—speciﬁc genes that provide a sufﬁcient coverage
might be challenging for viruses. In contrast, Taxy—Pro does
not require the preselection of specific signature genes but instead
considers all Pfam domain frequencies as part of an overall pro—
tein signature.

As a novel feature of our approach, Taxy—Pro provides two
complementary indices to assess the model quality. The fraction
of sequences without Pfam domain hits (FSU) and the FDU can
both be used to characterize the uncertainty of a composition
estimate. Our large—scale evaluation of datasets from the Human
Microbiome Project (HMP) indicates that especially the FDU
offers new possibilities for fault detection in metagenomics.

Our evaluation on HMP data also shows that Taxy—Pro does
not obviate the need for other sequence analysis tools. On the
contrary, as a fast pre—screening tool Taxy—Pro should be used in
combination with state—of—the—art sequence classiﬁcation tools to
extract a maximum of information from metagenomic data.

ACKNOWLEDGEMENTS

We would like to thank Renzo Kottmann and Melissa Beth
Duhaime for fruitful discussions and Todd Vision for comments
on the manuscript.

Funding: Grants from the Deutsche Forschungsgemeinschaft
(ME 3138, to PM. in part) and (LI 2050, to TL. in part).

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et ul (1990) Basic local alignment search tool. J. Mol Biol, 215,
4034110.

Berg Miller,M.E. et ul (2012) Phage—bacteria relationships and CRISPR elements
revealed by a metagenomic survey of the rumen microbiome. Environ.
Microbiol, 14, 2077227.

Brady,A. and Salzberg,S. (2011) PhymmBL expanded: conﬁdence scores, custom
databases, parallelization and more. Nut. Methods, 8, 367.

Brady,A. and Salzberg,S.L. (2009) Phymm and PhymmBL: metagenomic phylogen—
etic classiﬁcation with interpolated Markov models. Nut. Methods, 6, 673$76.

Bray,J.R. and Curtis,J.T. (1957) An ordination of the upland forest communities of
southern Wisconsin. Ecol. Monogr., 27, 3257349.

Dempster,A.P. et ul (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Slut. Soc. Series E Stat. Met/todol, 39, 1722.

Diaz,N.N. et ul (2009) TACOA: taxonomic classiﬁcation of environmental
genomic fragments using a kernelized nearest neighbor approach. BMC
Bioinformutics, 10, 56.

Duhaime,M.B. et ul (2012) Towards quantitative metagenomics of wild viruses and
other ultra—low concentration DNA samples: a rigorous assessment and opti—
mization of the linker ampliﬁcation method. Environ. M icrobiol, l4, 252(r2537.

Finn,R.D. et ul (2010) The Pfam protein families database. Ntwleic Acids Res., 38,
D2117D222.

Finn,R.D. et ul (2011) HMMER web server: interactive sequence similarity
searching. Nucleic Acids Res., 39, W297W37.

Havelsrud,O.E. et ul (2011) A metagenomic study of methanotrophic microorgan—
isms in Coal Oil Point seep sediments. BMC Microbiol, 11, 221.

Huson,D.H. et ul (2007) MEGAN analysis of metagenomic data. Genome Res., 17,
3777386.

Huttenhower,C. et ul (2012) Structure, function and diversity of the healthy human
microbiome. Nature, 486, 2077214.

Krause,L. et ul (2008) Phylogenetic classiﬁcation of short environmental DNA
fragments. Nucleic Acids Res., 36, 223(k2239.

Lingner,T. et ul (2010) Predicting phenotypic traits of prokaryotes from protein
domain frequencies. BMC Bioiry’ormutics, 11, 481.

Lingner,T. et ul (2011) CoMetia web server for comparative functional proﬁling of
metagenomes. Ntwleic Acids Res., 39, W518rW523.

Liu,B. et ul (2011) Accurate and fast estimation of taxonomic proﬁles from
metagenomic shotgun sequences. BMC Genomics, 12 (Suppl. 2), S4.

Meinicke,P. et ul (2011) Mixture models for analysis of the taxonomic composition
of metagenomes. Bioinﬁ)rmutics, 27, 161871624.

Meyer,F. et ul (2008) The metagenomics RAST server — a public resource for
the automatic phylogenetic and functional analysis of metagenomes. BMC
Bioinformutics, 9, 386.

Mokili,J.L. et ul (2012) Metagenomics and future perspectives in Virus discovery.
Curr. Opin. Virol, 2, 63777.

Monzoorul Haque,M. et ul (2009) SOrt—ITEMS: sequence orthology based
approach for improved taxonomic estimation of metagenomic sequences.
Bioinformutics, 25, 172271730.

Parks,D.H. et ul (2011) Classifying short genomic fragments from novel lineages
using composition and homology. BMC Bioinformutics, 12, 328.

 

979

ﬁm'spzumofpmjxo'sopeuuowrorq/ﬁdnq

H.Klingenberg et al.

 

Peterson,J. et ul (2009) The NIH human microbiome project. Genome Res., 19,
231772323.

Rho,M. et ul (2010) FragGeneScan: predicting genes in short and error—prone
reads. Ntwleic Acids Res., 38, e191.

Richter,D.C. et ul (2008) MetaSim: a sequencing simulator for genomics and meta—
genomics. PLoS ONE, 3, e3373.

Rosen,G.L. and Lim,T.Y. (2012) NBC update: the addition of viral and fungal
databases to the Na'i've Bayes classiﬁcation tool. BMC Res. Notes, 5, 81.

Rosen,G.L. et ul (2011) NBC: the Naive Bayes Classiﬁcation tool webserver for
taxonomic classiﬁcation of metagenomic reads. Bioinformutics, 27, 1277129.

Schreiber,F. et ul (2010) Treephyler: fast taxonomic proﬁling of metagenomes.
Bioiry’ornmtics, 2J6, 96(F96l.

Segata,N. et al. (2012a) Composition of the adult digestive tract bacterial micro—
biome based on seven mouth surfaces, tonsils, throat and stool samples. Genome
Biol, 13, R42.

Segata,N. et al. (2012b) Metagenomic microbial community proﬁling using unique
clade—speciﬁc marker genes. Nut. Methods, 9, 8117814.

Xu,J. et ul (2007) Dandruff—associated Malassezia genomes reveal convergent
and divergent virulence traits shared with plant and human fungal pathogens.
Proc. Natl Acud. Sci. U S A, 104, 1873(F18735.

 

980

/810'sleum0prOJxo'sopBLuJOJutotq”:duq

