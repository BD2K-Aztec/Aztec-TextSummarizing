ORIGINAL PAPER

Vol. 27 no. 17 2011, pages 2338-2345
doi:10. 1 093/bioinformatics/btr402

 

Genome analysis

Advance Access publication July 12, 2011

A novel signal processing approach for the detection of copy
number variations in the human genome

Catherine Stamoulisla2’3’4a* and Rebecca A. Betensky5

1Department of Radiology, 2Department of Neurology, 3Clinical Research Program, Children’s Hospital Boston,
4Harvard Medical School and 5Department of Biostatistics, Harvard School of Public Health, Boston, MA 02115, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: Human genomic variability occurs at different scales,
from single nucleotide polymorphisms (SNPs) to large DNA
segments. Copy number variations (CNVs) represent a significant
part of our genetic heterogeneity and have also been associated with
many diseases and disorders. Short, localized CNVs, which may play
an important role in human disease, may be undetectable in noisy
genomic data. Therefore, robust methodologies are needed for their
detection. Furthermore, for meaningful identification of pathological
CNVs, estimation of normal allelic aberrations is necessary.
Results: We developed a signal processing-based methodology
for sequence denoising followed by pattern matching, to increase
SNR in genomic data and improve CNV detection. We applied
this signal-decomposition-matched filtering (SDMF) methodology to
429 normal genomic sequences, and compared detected CNVs to
those in the Database of Genomic Variants. SDMF successfully
detected a significant number of previously identified CNVs with
frequencies of occurrence 310%, as well as unreported short CNVs.
Its performance was also compared to circular binary segmentation
(CBS). through simulations. SDMF had a significantly lower false
detection rate and was significantly faster than CBS, an important
advantage for handling large datasets generated with high-resolution
arrays. By focusing on improving SNR (instead of the robustness of
the detection algorithm), SDMF is a very promising methodology for
identifying CNVs at all genomic spatial scales.

Availability: The data are available at http://tcga-
data.nci.nih.gov/tcga/

The software and list of analyzed sequence IDs are available at
http://www.hsph.harvard.edu/~betensky/

A Matlab code for Empirical Mode Decomposition may be found at:
http://www.clear.rice.edu/elec301/ProjectsO2/empiricalMode/code
.html

Contact: caterina@mit.edu

Received on November 24, 2010; revised on May 2, 2011; accepted
on June 8,2011

1 INTRODUCTION

Genome-wide DNA aberrations (duplications, deletions and
rearrangements) are part of the normal human genetic variability.
Copy number variations (CNVs) occur at thousands of loci across

 

*To whom correspondence should be addressed.

the genome (Carter, 2007; Iafrate et (11., 2004; Redon et (11.,
2006). To date, over 66 000 DNA aberrations at ~16 000 loci have
been identiﬁed [Database for Genomic Variants (DGV)]. CNVs
may occur in >10—20% of the genome (Beckmann et (11., 2007;
Zhang et (11., 2009), and pairwise comparisons of human genomes
suggest that they may differ by at least 1%, a 10-fold higher
percentage than the previously estimated 0.1% based on single
nucleotide polymorphism (SNP) incidence (Beckmann et (11., 2007).
CNVs have also been associated with many diseases and disorders
(Kalliomeni et (11., 1992; Sebat et (11., 2007), and may speciﬁcally
play an important role in sporadic diseases (Lupski, 2007).

Array comparative genomic hybridization (aCGH) is a high-
resolution technology that enables simultaneous interrogation of the
entire genome. It involves hybridization of differentially ﬂuorescent
dye-labeled reference and test sequences on a microarray, and
estimation of relative allelic changes as the logZ-ratio of the two
ﬂuorescence intensities. CNV detection is often limited by the
resolution of the microarray and the data signal-to-noise ratio (SNR).
Current platforms with >1 million probes enable the detection of
shorter CNVs (10—25 kb), and consequently capture the ﬁner scale
of genomic variability (Lupski, 2007; Perry et (11., 2008). In practice,
detection of short CNVs is still limited by high noise levels in the
data. Consequently, methodologies that explicitly increase SNR to
improve CNV detection are needed.

Several detection methods have been proposed and applied to
genomic data with variable success (Barros et (11., 2007; Engler et (11.,
2006; Wineinger et (11., 2008). They include smoothing procedures
(Hupe et (11., 2004), Hidden Markov Models (HMM) (Fridlyand
et (11., 2004; Snijders et (11., 2001), Circular Binary Segmentation
(CB S) (Olshen et (11., 2004), a change-point method that segments a
chromosome into regions of constant copy number, and the Genome
Alteration Detection Algorithm (GADA) (Pique-Regi et (11., 2008),
based on Bayesian learning. These methods aim to improve the true
positive detection rate, not to increase SNR. Their performance also
depends on the selection of appropriate thresholds for calling CNVs.
The false discovery rate (Benjamini et (11., 1995) or the Genomic
Identiﬁcation of Signiﬁcant Targets in Cancer (GISTIC) approach
are often used to establish these thresholds (Beroukhim et (11., 2007).

Genomic and measurement noise, as well as impurities and
artifacts may contaminate aCGH data, decrease their SNR and
introduce spurious spatial correlations (Fridlyand et (11., 2004;
Marioni et (11., 2007). Dimensionality reduction methods, including
principal component analysis (PCA), independent component
analysis (ICA) and wavelet decomposition (Alter et (11., 2000;
Hsu et (11., 2005), have been applied for denoising and artifact

 

2338 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 ﬁlo's[Bumo[pJOJXO'sorwurJOJurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘Og anﬁnv uo ::

Signal processing approach for CNV detection

 

suppression in genomic data. The lack of physical interpretation of
some components, or lack of (1 priori knowledge of an appropriate
mother wavelet, are respective drawbacks of these methods.

Signal processing methods for locally increasing SNR are widely
used in the physical sciences and engineering, where measured
signals are often severely contaminated by different types of
noise. When a waveform of interest is known or can be robustly
estimated, it may be recovered from a noisy signal via pattern
matching methods, e.g. matched ﬁltering, which increases SNR
locally, in regions where the known signal (the template) matches
the observed signal, and reduces SNR elsewhere (Turin, 1960;
Willett et (11., 1991). The application of signal processing methods
to genomic data has been very limited, since these data are not
truly continuous (Lai et (11., 2005). However, such methods may be
very useﬁil for improving CNV detection. In this article, data-driven
signal decomposition (for denoising), followed by matched ﬁltering,
hereafter referred to as Sequence-Decomposition-Matched Filtering
(SDMF), is proposed to locally improve SNR, and consequently
restrict the genomic regions of interest and increase the speciﬁcity of
CNV detection. SDMF is applied in normal genomic sequences from
The Cancer Genome Atlas (TCGA). The performance of SDMF
is compared to CBS through simulations. Detected CNVs are also
compared to identiﬁed CNVs in the DGV.

2 APPROACH

Atwo-step methodology is proposed, summarized in Figure 1. Signal
decomposition is performed to increase the overall data SNR and
suppress artifacts, followed by matched ﬁltering where pairs of
genomic sequences are treated as both template and test signals
and pattern matched, to increase SNR locally. CNVs are ultimately
called based on their frequency of occurrence.

3 METHODS

3.1 Sequence decomposition for artifact elimination

3.1.1 Data ACGH sequences (logz intensity ratios) from 429 normal
samples were obtained from the Cancer Genome Atlas (TCGA). These
included all 322 normals matched to glioblastoma samples. from all available
data batches (14. 6710. 16. 20. 26). and all 107 normals matched to
ovarian cancer samples. from all available data batches (9. 11. 15). The
Agilent Human Genome CGH Microarray 244A was used for hybridization
in both sets. Cytoband information was obtained from Agilent and TCGA
(Gene list. http://chem.agilent.com). Detected CNVs were compared to those
catalogued in the DGV. All sequences were segmented into individual
chromosomes. which were then analyzed separately.

3.1.2 Mode estimation ana1 signal decomposition A wave-like genomic
artifact has been identiﬁed in array CGH. SNP arrays and whole-genome

 

 

 

 

 

 

 

Template
Array CGH » Mode—reduced
Sequences Sequence Matched—ﬁltering
V Decomposition sequences 8‘
NR Th h ld‘
Test sequence & S res 0 mg
Mode Elimination
for Denoising

 

 

 

 

Frequency of
Occurrence

CNVs

Fig. 1. Schematic representation of the SDMF method and CNV detection.

tiling arrays (Diskin et al.. 2008; Komura et a1.. 2006). and appears to be
highly correlated with the guaninewytosine (GC) content in DNA (Diskin
et a1.. 2008). This artifact introduces spurious spatial correlations in the
data. which makes the detection of CNV breakpoints difﬁcult. Previous
studies have applied different methods to suppress the artifact (Diskin et a1..
2008; Marioni et a1.. 2007; Van de Wiel et a1.. 2009). Each has advantages
and shortcomings. For example. smoothing methods may eliminate small
amplitude CNVs in addition to artifacts.

The structure of typically non-stationary genomic logz sequences may
be investigated using an appropriate decomposition method. There are very
few truly data-driven methods for non-stationary signals. that do not make
a priori assumptions on the shape of the unknown signal components
(referred to as modes). The most-widely used method is the Empirical Moa’e
Decomposition (EMD) (Huang et a1.. 1998). which recursively decomposes
a non-stationary signal into modes with signiﬁcant amplitude contributions.
These modes must satisfy two conditions: (i) they must have zero mean and
(ii) they must contain a single extremum between zero crossings. In addition.
they must be such that the signal reconstruction error between the original
signal x(k) and mode-based estimated signal it(k) [see Equation (2)]. deﬁned
as % 21:1 (x(k) —irM(k))2. is minimized. The algorithm ﬁrst identiﬁes one set
of maxima and one set of minima in a signal. and ﬁts respective cubic spline
functions through them to obtain the upper and lower signal envelopes. The
mean of the two envelopes m1,1 is then subtracted from the original signal. If
the mean of the residual 111,1 is zero. then 111,1 is the ﬁrst mode. In practice.
multiple iterations are necessary. at which new means are estimated and
removed from successive residual signals. This procedure continues until
convergence. i.e. until the ﬁrst (1 that satisﬁes:

21:01h1,q_1(k>—h1,q(k>12 <

e. (1)
Zfzohig—Nk)

which implicitly ensures that h1gq is zero mean. In Equation (1). k denotes
probe and K is the total number of probes in a chromosome sequence.
The ﬁrst mode is then deﬁned to be d1(-)=h1,q(-). and is subtracted
from x(-) to obtain the residual r1(-). which is then treated as the new
signal. The sifting process is repeated for r1(-),...,rM_1(-). to obtain
modes d2(-), . . .,a'M(-). The decomposition stops once the difference between
successive reconstruction errors. based on sets with progressively higher
number of modes. is negligible. Additional criteria have been used to stop
the mode estimation (Huang et a1.. 1998). e.g. (i) the root mean-squared

residual rM,,,,,S=,/ %Zf:0rf4(k) <<1. and/or (ii) a depletion of extrema
through which to ﬁt the envelopes. and/or (iii) a pre-deﬁned upper bound
on the number of modes is reached. Here we set an upper bound (Mmax =
30). which was. however. never reached. The signal reconstruction error was
typically minimized when M 5 15 modes were estimated. Thus. EMD is also
a dimensionality reduction approach. The reconstructed signal based on M
modes is given by:

M
£M(k>=Zdi(k> (2)
1:1
for k=1,...K. Some of these M modes may still correspond to high-
amplitude artifacts and/or noise. Thus. a subset M / 5 M is ultimately selected.
as described below.

Although a powerful method. there are sources of variability in the EMD
estimation. First. there are theoretically inﬁnite combinations of modes with
different amplitude distributions that can be estimated from a given signal
(Huang et a1.. 1998). There is currently no consensus on what constitutes
an optimal basis (these modes form an approximately orthogonal basis)
(Huang et a1.. 1998). and thus the requirement of basis uniqueness is
not satisﬁed. Second. the stoppage criteria for mode estimation are often
arbitrarily set. Thus. a criterion for the selection of an optimum set of
modes is desirable. Thresholding approaches. model selection criteria and
penalized least-squares approaches can all be used to estimate a subset of
modes (Donoho et a1.. 1994). since the stoppage criterion may not penalize

 

2339

112 ﬁlo's[BumoipJOJXO'sorwurJOJurorq”:duq uteri popeolumoq

91oz ‘Og anﬁnv uo ::

C.Stamoulis and R.A.Betensky

 

A Raw and reconstructed sequence based on 20 modes: Residual error = 0 000014

 

1:111 ratio

 

 

2000 4000 0000 0000 1 0000 1 2000 14000 1 6000 13000

B Raw and rec-answered sequence based on 15 mouse: Residual error= 0,0130

 

log2 ralin

 

 

2000 4000 6000 0000 1 0000 1 2000 14000 1 6000 10000

c Raw and reconstructed sequence based on 10 modes. Rasidual error: 0.0067

 

 

 

 

2000 4000 5000 0000 1 0000 1 2000 14000 1 0000 10000
Probe 3

Fig. 2. Original (black) and mode-reduced (red) sequences based on 20 (A).
15 (B) and 10 modes (C). Respective residual errors of the reconstructed
signals are 1.4e-5. 1.380-2. 6.70-3.

higher order (redundant) decompositions. However. these methods do not
directly provide a means for selecting an optimum mode subset. A different
upper bound may result in a different distribution of modes. and a higher
number of modes is not necessarily optimal. An example of a sequence
and reconstructed signals using upper bounds of 20. 15 and 10 modes.
respectively. are shown in Figure 2. The reconstruction error based on 15
modes is two orders of magnitude higher than the error corresponding to 10
modes.

To assess the effect of individual modes. signal x(k) may be decomposed
into a set of modes that are sequentially eliminated to obtain the m-mode
reduced irm(k). This is then compared to x(k):

x(k)=s(k)+e(k) (3)
201(k)=§m(k)+wm(k) (4)

where s(k) is the noiseless signal. s,,,(k) is the estimate of this signal and
8 ~N(0, (782) and Wm ~ N (0, 03,) with aim < 03 are the additive Gaussian noise
of the original and reconstructed signals. respectively. The requirement for
denoising may be expressed as a? 5082. i.e. the variance of the estimated
signal is less than the variance of the noise in the measured signal. When
additional modes are eliminated. the noise variance decreases further. i.e.
as > owm:l > owm:2 >  > owm:M. However. sequential mode reduction may
also eliminate signiﬁcant components. resulting in large signal reconstruction
errors. Thus. we need to bound the number of eliminated modes. We deﬁne
the risk function as:

2 (3:4)

1 K
Knows):Eerro—imrk» — (5)

k2]

1 K A
= E 230(k) —s,,,(k>+a(k> — w(k))2 =

k2]
1 K
= E 230(k) (k>>2+
k2]
+(8(k) — w(k)? +2(s(k>— sn<k>>rark> — w(k))

When 0 modes are eliminated from the original signal. 110(k) =x(k) and R0 =
0. When the reconstructed signal is the optimum estimate of the s(k). then

s,,,(k)%s(k) and Equation (5) becomes:

. 1 K
Rm,optim(sm v S) g E 203(k) _ Wm(k))2 = 
k2]
1 K 2 1 K 2 2 K
E g»: (k>+ E gram — E gamma =

2 2
= as + owm — 2COV(8, Wm)

It is assumed that s,,,(k) and w(k) are independent and thus o§=o§2+ofw
Then. if we set the variance of the mode-reduced signal it equal to the risk
function. we have [from Equation (6)]

012 + 03,, = a? + 03,, — 2Com. Wm) => a; = a3 — 2Cov(8, Wm) (7)

which ensures the desired a? 5 082 (assuming Wm and 8 are positively
correlated). with equality when 806) or w,,,(k) is zero. i.e. a noiseless
measurement x(k)=s(k) or noiseless estimate it(k)=s,,,(k) and asymptotic
equality when K —> 00.

There are several threshold estimation approaches for denoising. e.g.
wave-shrinkage (Donoho et al.. 1994). Although perhaps not optimal. our
proposed approach has the advantage of not requiring detailed estimation
of the threshold. Setting the variance of the mode-reduced signal equal to
the risk function ensures that mode reduction increases SNR. An example
is shown in Figure 3. using a subset of the data. Typically. the variance and
risk function intersected at mode 1 or 2. depending on the chromosome. and
thus 172 modes were eliminated.

We compared the proposed approach to 10055 curve ﬁtting (Marioni
et a1.. 2007). PCA and ICA. Corresponding changes in SNR (averaged
over all sequences) are shown in Figure 4. SNR was computed as the log
ratio at each probe divided by the SD of the signal. to be consistent with
the deﬁnition of SNR in Marioni et a1. (2007). Elimination of redundant
ICA/PCA components and 10055 ﬁtting yielded only modest changes in
SNR. In contrast. mode elimination resulted in substantial increases in SNR.
Similar results were obtained for all chromosomes.

3.2 Effect of normalization by a common reference

In addition to the wave-like artifact. a common reference for normalization
may also introduce spurious spatial correlations in genomic data. To explore
this. the normalization was reversed by adding the logz reference to each
observed sequence. to obtain non-normalized data:
10g2(ﬂ
xbatch(k)
where X,» is the non-normalized sequence and x1013S the batch-normalized
sequence. Each non-normalized sequence was decomposed. Contributions
of low-amplitude modes were compared in raw and normalized sequences.
The wave-like artifact was not suppressed in non-normalized data. which
implies that it is unrelated to the normalization. as also noted in Diskin et a1.
(2008).

We assessed the effect of renormalization (measured by the variance of
the sequence) by renormalizing each sequence by the mean of all others. as
shown is Figure 5 (for 20 sequences). The variance of renormalized raw and
moa’e-rea’ucea1 data were compared. The diagonal entries correspond to the
variance of the non-normalized sequence. The effect of normalization was in
some sequences signiﬁcantly higher (~O(1)) than in others. e.g. the variance
increase in sequence 1 was negligible when the sequence was normalized
by 24. 8714. 18720. but substantial when normalized by sequences 157
17. In contrast. renormalization of mode-reduced sequences resulted in
small variance changes. Thus. denoising Via mode elimination reduces the
uncertainty associated with normalization by different sequences.

ibatchUC»=10g2(xi,0bs)(k)+10g2(ibatch(k)) (8)

3.3 Matched ﬁltering

Matched ﬁltering is a waveform-matching method that is widely used in
pattern recognition. sonar and communications. to detect a desired waveform

 

2340

112 /3.10's[BumoprOJXO'sorwurJOJurorq//:duq 01011 popeolumoq

91oz ‘Og isnﬁnv uo ::

Signal processing approach for CNV detection

 

A

Variance and residual B Variance residual error
no? eFror, Ehr 2 “7 diﬁerant chmmasomgs
Chrl

llﬁ — I T £1.05

11.05

5.04

0.02

 

 

 

 

 

 

E 8
Mode

Fig. 3. Effects of sequential mode elimination on the risk function (black)
and variance (red) of the mode-reduced sequence. (A) The inter sequence
parameter variability for one chromosome (dashed lines). Mean parameter
values for several chromosomes (B).

c(k) in a measured signal xobSUc). The matched ﬁlter is a quasi-optimum
ﬁlter that locally maximizes the output SNR by decreasing SNR in regions
of mismatch between observed and desired (template) signals and increasing
SNR in matched regions. It improves SNR by reducing the noise spectral
bandwidth to that of the desired waveform (Turin. 1960). Theoretically.
the optimum ﬁlter that maximizes SNR is the time-reversed signal itself.
i.e. c(k)=x0bS(—k) under the assumption of Gaussian noise. and matched
ﬁltering is a convolution operation:

XMFUC) = Clemplate(k) ®xobs(k) (9)

Template signal: typically. the template c(k) is either precisely known or
robustly estimated. An observed signal is then matched-ﬁltered with this
template. However. in this study there was no unique or known template.
Every normal chromosome sequence was treated both as a template and
an observation. To identify CNVs. regions of signal mismatch rather than
regions of match were examined. Each of NS mode-reduced sequences was
segmented according to the ﬁlter length described below. and each of Q
segments was ﬁltered with N, — 1 corresponding segments (the templates). to
obtain NS — 1 matched-ﬁltered segments. The ratio of pre- over post-ﬁltering
SNR ASNR. was computed for each segment. and averaged over NS—l
SNRs. A matrix of ASNRS was ultimately obtained of size N, X Q. A segment
was further examined for potential CNVs if ASNR. averaged over N, was
less than an estimated threshold. described below.

Filter length: the choice of ﬁlter length is important for achieving
optimal SNR. We examined the change in SNR following matched
ﬁltering as a function of ﬁlter length. We used the typical deﬁnition of
SNR=20 logm  in dB. estimated the change in SNR as ASNR:

V(.)>mr.-

 

 

3D

 

SNH after PCA
a:
u

 

 

   

El 15 20 25 30 0 5

 

O 1 25 30
SNR before PCA
30 . 30 \ r; .-
D :
-. n
25 25 s ‘
5‘

N
1:

SNR after lees: ﬁt
51'
d

a
a
u
2

 

 

 

 

 

U W D
O 5 10 15 20 25 30 O 5 ‘10 ‘15 20 25 30
SNR belnre Incas ﬁl SNR before mode reduclion

Fig. 4. Comparison of artifact elimination Via PCA (A). ICA (B). 10055 curve
ﬁtting (C) and mode elimination (D). Each plot is for SNR before (Jr-axis)
versus SNR after application of the respective method (y-axis). averaged
over all normal sequences.

<XMF>rms _ _ r
20 log“) <X0bs>rms . where < >rms denotes root mean squared. F1gure 6

shows the average (over all sequences and chromosomes) SNR change
as a function of ﬁlter length. Since the ﬁrst change in slope of average
SNR change occurs at a length of ~500 probes. which was determined
empirically to be sufﬁciently long for matched ﬁltering. we selected this
as the segment/ﬁlter length. though it may not be optimal.

Threshola1 for estimating regions of mismatch: contrary to the traditional
application of matched ﬁltering. for CNV detection we are interested in
regions of mismatch rather than regions of maximum match. This is because
we presume that CNVs occur with relatively low frequency. Regions of
mismatch not only include both allelic variability between two sequences
but also potentially distinct noise and artifacts. Thus. the ﬁrst step of
mode decomposition for denoising is necessary. Furthermore. a threshold
or random mismatch due to noise rather than true waveform mismatch
must also be estimated. instead of assuming that any decrease in SNR.
i.e. ASNRS 0. following matched ﬁltering reﬂects waveform mismatch. We
simulated and matched-ﬁltered 500 pairs of identical. and thus theoretically
perfectly matched signals. but corrupted with distinct additive Gaussian noise
sequences. while maintaining high SNR. We estimated that noise-induced
mismatch resulted in a maximum decrease in SNR of 1.5 dB. Therefore.
regions where mean SNR in the ﬁltered sequence decreased by more than
—1.5 dB were identiﬁed as regions of potential true waveform mismatch.

CNV call: matched ﬁltering increases/decreases SNR according to
match/mismatch. and thus the resulting signal amplitude in the ﬁltered data
may be different from the logz ratios in the original (but denoised) data.
Thus. once potential segments of mismatch have been identiﬁed. we need to
examine the corresponding segments in the denoised data for determining the
actual type of aberration at the probe level. For simplicity. we set a detection
threshold of one loss or one gain. i.e. logz % for gain and logz % for loss. The

 

2341

112 /3.IO'S[1211an[pJOJXO'SOIJBLUJOJIIIOTqﬂK1111] 01011 popeolumoq

91oz ‘Og isnﬁnv uo ::

C.Stamoulis and R.A.Betensky

 

E'llccl of rcnolmaﬁzaliall on 13" sequence valiarlu:

0 2

0.13
0.13
0.14
0.12
0.1

0 03
0.05
0.04
0.02

2 4 6 B '10 '12 1d '15 '18 2D

    

:
E
u
E
M

Sequu'lc: 0
B Ellecl of unorrmﬁiulion on mode-reduced sequaloe variance

0.2

0.1!
0.15
0.14
0.12
0.1

0.03
0 06
0.04
0.02

2 A G B ‘10 12 '14 IE ‘10 20
Sequence 3

 

Fig. 5. Effect of renormalization on the variance (shown as color) of 20 raw
(A) and corresponding mode-reduced sequences (B).

Flat: ol SNR aﬂcl NF l0 SNR ccl‘crc MF

 

\1 , “+1
L\’__HI'/.a-r\_.__/ .

1 . 1 1 1 : . . . .
Wu 1001 151:0 709D Mn 3W“ Hhm 401:0 4500 1:000 3.11m 511m
Filbean window length m x D! Hither:

Fig. 6. Ratio of SNR of matched-ﬁltered data over raw data as a function of
the ﬁlter length. The solid line corresponds to mean SNR change. averaged
over all sequence SNRs. and superimposed is the variability of this ratio.

probability of a CNV at probe k was deﬁned as the union of the probabilities
of (mutually exclusive) gain and loss. This is practically equivalent to the
maximum of these probabilities since one of the probabilities is typically
negligible relative to the other:

21;. logzv‘Jc) : 101126) + 21;. 10112005101126)

P CNV =
KK k) N. N.

 

(10)

where N. is the total number of sequences. and logzq‘, k) corresponds to the
mode-reduced sequence j at probe k. A probability of 0.1 (10% frequency)
was chosen as the threshold for a CNV call. Although this choice is somewhat
arbitrary. low CNV frequencies 510% have been reported in the normal
genome (Ionita-Laza et al.. 2008; Jakobsson et al.. 2008).

4 RESULTS

4.1 CNV detection in the normal genome

We applied SDMF to 429 normal sequences from the TCGA
database, and compared them to CNVs in the DGV detected in
datasets with least 420 samples, irrespective of their frequency of
occurrence, as well as CNVs in two studies with 270 samples and
high frequency (340%) (McCarroll et (11., 2008; Pinto et (11., 2007).
For the Y chromosome, the maximum sample size in any study
was 270. For two CNVs to be comparable, we assumed a very
conservative 50% spatial overlap of the length of the detected CNV
with respect to the length of the CNV in the DGV. In cases where
the same CNV was reported by multiple studies, but with slightly
different lengths, the intersection of these regions was assumed as
the CNV length. Finally, when a detected aberrations was entirely
contained within the genomic coordinates of the corresponding CNV
in the DGV, it was called a separate CNV irrespective of its overlap
(this occurred in only very few instances). On average, ﬁltering
restricted the regions of mismatch for further examination to 19—
34% 0f the total number of segments, depending on the chromosome.
This is expected as these were all normal sequences, and thus with
high waveform similarities and low mismatch. Table 1 summarizes
the number of CNVs in DGV, in each chromosome, irrespective of
frequency (column 2); the overall sensitivity of SDMF with respect
to DGV, calculated as the ratio of the number of CNVs in the
intersection of the two sets over the total number of CNVs in DGV
(column 3); Cohen’s kappa statistic (Cohen, 1960), as a measure
of agreement between SDMF and DGV that accounts for overlap
between the two occurring by chance (column 4); CNVs detected by
SDMF with least 10% frequency (column 5); CNVs in DGV with at
least 10% frequency (column 6); sensitivity of SDMF with respect
to CNVs in DGV with frequencies at least 10% (column 7); and
the corresponding kappa (column 8). Note that the kappa statistic is
calculated at the probe level, by assuming that the maximum number
of CNVs is the number of probes in each chromosome. However,
CNVs in DGV have been detected with a wide range of arrays of
different resolution. To account for this, we obtained the genomic
coordinates for each identiﬁed CNV in the DGV and calculated the
corresponding number of probes in our data, so that the two sets are
comparable for the estimation of kappa.

A signiﬁcant number of detected CNVs have also been reported
in DGV with frequencies 310%. For this subset, the sensitivity of
SDMF with respect to DGV was 383%. The overall sensitivity of
SDMF was lower (17—60%). Furthermore, based on the accepted
interpretations of levels of kappa (Landis et (11., 1977), the agreement
between DGV and SDMF was slight (0 < K < 0.2) to moderate (0.4 <
K < 0.6), depending on the chromosome. This may be due due to: (i)
differences in the populations of DGV and TCGA normals; (ii) novel
CNVs detected by SDMF; and (iii) the use of distinct thresholds for
CNV calls in different studies. We can only assess the false positive
rate of SDMF through simulations.

4.2 Comparison of SDMF with CBS via simulation

SDMF may be applied to identify regions of mismatch, and thus to
detect CNVs occurring at low frequencies in a relatively large set
of genomes, or to identify regions of signiﬁcant waveform match
between sequences, and thus to detect common CNVs occurring
at high frequencies. We compared SDMF to CBS. Although other

 

2342

112 /3.10's1120.100[p101x0'so1112011010101q//:duq 01011 popeolumoq

91oz ‘Og JSanV 00 ::

Signal processing approach for CNV detection

 

Table 1. CNVs in DGV (column 2). sensitivity of SDMF with respect to
DGV (column 3). K statistic (column 4). CNVs in DGV and in this study. with
at least 10% frequency (columns 5 and 6). sensitivity of SDMF with respect
CNVs in DGV with at least 10% frequency (column 7) and the corresponding
K (column 8).

 

Chr DGV Sens. SDMF K SDMF DGV Sens. SDMF K10%

 

w.r.t. DGV 310% 310% w.r.t. DGV310%

1 1235 0.4-4 0.41 1178 115 0.92 0.15
2 833 0.46 0.46 586 83 0.89 0.21
3 726 0.42 0.5 456 82 0.96 0.29
4 727 0.34 0.38 478 108 0.91 0.32
5 652 0.31 0.32 495 80 0.95 0.26
6 586 0.43 0.4 550 100 0.9 0.27
7 642 0.48 0.56 423 75 0.94 0.27
8 638 0.4 0.4 530 76 0.92 0.22
9 585 0.49 0.54 428 37 0.94 0.14
10 568 0.46 0.47 488 55 0.95 0.18
11 607 0.23 0.28 313 73 0.91 0.33
12 577 0.41 0.42 473 74 0.94 0.25
13 347 0.37 0.4 256 12 0.92 0.08
14 382 0.28 0.33 225 31 0.94 0.2

15 441 0.4-4 0.54 253 37 0.95 0.23
16 411 0.39 0.42 296 45 0.91 0.23
17 365 0.51 0.57 269 52 0.91 0.28
18 213 0.17 0.25 65 12 0.83 0.26
19 446 0.28 0.32 241 36 0.89 0.22
20 255 0.54 0.58 203 24 0.88 0.18
21 159 0.57 0.67 106 15 0.93 0.22
22 287 0.23 0.35 72 17 1 0.38
X 309 0.59 0.62 267 22 0.91 0.14
Y 27 0.6 0.52 34 2 1 0.11

 

methods have been shown to be computationally faster, e.g. Pique-
Regi et (11. (2008), CBS is widely used for CNV detection (Olshen
et (11., 2004), by simulating both cases (match/mismatch). The
respective performance of the two methods was measured by the
true and false detection rates, as a ﬁinction of SNR and inter-CNV
distance. Sequences were corrupted with additive, multiplicative or
periodic (sine wave) Gaussian noise. SNR was measured in decibel.
We simulated 1000 sequences (100 per each of 10 noise levels).
In this set, CNV frequency was 100% and matched ﬁltering was
applied in the traditional sense, to identify regions of maximum
match between template and test sequences, which corresponded
to regions containing CNVs. To simulate low-frequency occurring
CNVs, all but 10—25% of sequences in this set were randomly
selected and replaced by pure Gaussian noise. An example of a
sequence containing 1 short CNV (300 markers long), contaminated
with progressively higher additive noise levels (decreasing SNR)
is shown in Figure 7. Note that SDMF was applied to simulated
data in the same way as in real data, using noise-contaminated
sequences as both the template and test signals. All sequences were
ﬁrst mode-decomposed for denoising.

The matched-ﬁltered sequences corresponding to Figure 7 are
shown in Figure 8. matched ﬁltering successfully suppressed noise
in regions of mismatch, even in very low SNR (—7 to —10 dB),
locally increased SNR in the neighborhood of the CNV by at
least 5dB and decreased SNR elsewhere by at least 3dB. This
example demonstrates the ability of SDMF to detect even short

 

 

 

 

 

d SNFI - 41.03 03 SNFI - -3 dB
.9 2
EN 0 W
3’
_ _2

.4 _

0 2000 4000 8000 80010 0 20100 4000 0000 8000
SNR - -4.3 dB SNR x -E.'l dB

 

Inga raIiD

l'voN

 

 

 

is

EMD 4000 6000 0000

 

   

 

 

 

 

0 2000 4000 anon 0000 0
SNR u-i‘dB 4 SNR-51803
a Z '
-e
9.. o
g» '.
- -z
. _ 1, .
0 2000 4000 6000 8000 o 2000 4000 soon 8000
SNR . -a.5 dB
4
a a .
'11:
'0 0
8' " '
- -2
4

 

0 2000 4000 60m 80m 0 END 4WD EMD 8000

Fig. 7. Simulated genomic sequences with one CNV and decreasing SNR
(0 to —9 dB. top left to bottom right plots). and superimposed original
(uncorrupted) sequence (red).

 

 

   

SNR . 41.03 dB sun . .3 dB
1, ..  . g _
u 2 2
e
E.. D 0
3*
- z -2
a a
0 2000 4000 0000 am 0 2000 4000 m m
SNFI - 14.5 dB SNR - -6.'| dB
4 4
a 2 2
a .
E” D 0
g, .
- z -z
«a -4
0 2000 4000 6000 8000 0 2000 4000 5000 8000
SNR - -F dB ‘ SNR - -r.a dB
2 .
0
.2 I
«s
0 2000 40m: own 0000 a 2000 4.000 0000 0000

SNR - -8.5 dB SNFI - -5 dB

100.. mlm
05. K: cu m b

   

Fig. 8. Individual raw (black) and match-ﬁltered sequences (green).

CNVs in very high noise levels. Note that when a template with
high SNR is precisely known, the ﬁrst step of signal denoising by
mode-reduction results only in modest additional increases in SNR
(<2 dB). However, when a robust template is not precisely known
and/or is noisy, mode decomposition is a necessary pre-processing
step.

 

2343

112 /3.10's1120.100[p101x0'so1112011010101q//:duq 01011 popeolumoq

91oz ‘Og JSanV 00 ::

C.Stamoulis and R.A.Betensky

 

 

 

SNR - -0.03 dB SNFI - -3 dB
_0 2
‘19
LN 0
3’
... _2
.4
0 2000 4000 5000 0000 0 2000 4000 6000 8000
SNFI x 41.8 dB SNR - -E.'t dB

 

|ng_ lalia

 

 

a .
0 2W0 4W0 5W0 END 0 20W 40W 00% 8000
SNR - -? dB SNR - 4.3 dB

 

lag? rahn

 

 

0 2000 4000 80100 0000 0 2000 4000 6000 0000
SNR x -B.5 dB

 

101,;F ratio

 

 

Fig. 9. Original (black) and CNV detections based on CBS (green).

In the examples shown in Figure 9, CBS performed very well
for SNR 3 —6dB, but detected spurious CNVs at lower SNRs. In
contrast, SDMF correctly identiﬁed one CNV in all sequences. In
cases of pure noise (no CNVs), neither SDMF nor CBS identiﬁed
any CNVs. Also, the additional simulations for mismatch did
not change the results of CBS, which processes each sequence
individually. True and false detection rates of SDMF and CBS as
a ﬁinction of SNR, noise type and distance between CNVs are
summarized in Table 2. SDMF correctly detected at least 70%
of CNVs irrespective of SNR and noise type, compared with at
least 15% detected by CBS. Multiplicative noise decreased the
true detection rate in both methods, but periodic noise did not
signiﬁcantly affect detections by SDMF, possibly due to the initial
denoising. With regard to inter-CNV distance, for fewer than 1000
markers, SDMF detected 84% of CNVs, versus 40% by CBS, at
low SNR. CBS sometimes detected closely spaced CNVs as a single
CNV. Also, the estimated mean gain/loss, which depended on the
accuracy of the CNV breakpoints, was more precisely estimated
by SDMF, particularly for SNR < —6 dB. Finally, false detection
rate, estimated as the ratio of falsely identiﬁed CNV probes over
the number of true non-CNV probes, increased signiﬁcantly for
multiplicative and periodic noise for CBS but not for SDMF. This
calculation was based on 8000 probes and a varying number of
CNVs of different lengths. In simulations for mismatch, the true
detection rate was higher for SDMF than CBS and the false detection
rate was lower. As expected, the false detection rate of SDMF in
these simulations was slightly higher than the corresponding rate in
simulations for waveform match, since it is calculated at the probe
level and random mismatch at low SNR may affect the estimated
CNV length. In general, although SDMF substantially outperformed
CBS at low SNR, CBS performed well for higher SNR. However,
the computational cost of CBS was signiﬁcantly higher (0(5) in
simulations and 0(8) in real data). Next-generation CGH arrays with

Table 2. True and false detection rates for SDMF (S) and CBS (C) as a
function of SNR. noise type and simulation type (match/mismatch). and %
difference between estimated and true mean log2 ratio

 

Parameter Method — 10 —8 —6 —4 —2

 

SNR/Additive noise: Match

True S 0.84 0.91 0.95 1 1

+ve rate C 0.42 0.75 0.82 0.95 1

False S 0.05 0 0 0 0

+ve rate C 0.42 0.11 0 0 0

Amean S 0.01 0 0 0 0

log2 ratio C 0.2 0.11 0 0 0
SNR/Multiplicative noise: Match

True S 0.73 0.85 0.9 0.96

+ve rate C 0.27 0.55 0.64 0.92

False S 0.19 0.15 0.05 0 0

+ve rate C 0.68 0.36 0.23 0.13 0.1

A mean S 0.04 0.02 0 0 0

log2 ratio C 0.3 0.26 0.1 0 0
SNR/Periodic noise: Match

True S 0.8 0.9 0.92 1 1

+ve rate C 0.17 0.46 0.6 0. 84 0.9

False S 0. 11 0.05 0 0 0

+ve rate C 0.67 0.52 0.45 0.23 0.1

Amean S 0.04 0.01 0 0 0

log2 ratio C 0.35 0.29 0.16 0.09 0
SNR/Additive noise: Mismatch

True S 0.83 0.9 0.95 1

+ve rate C 0.42 0.75 0.82 0.95

False S 0.14 0.06 0 0 0

+ve rate C 0.42 0.11 0 0 0

 

very high resolution will require computationally efﬁcient analysis
methods. SDMF can handle large genomic datasets, whereas CBS
is limited in that respect.

5 DISCUSSION

We have developed SDMF, a computationally efﬁcient methodology
that combines the signal processing tools of signal decomposition
and matched ﬁltering for CNV detection in array CGH data. The
latter are inherently noisy and robust CNV detection is difﬁcult at
low SNR. SDMF treats genomic sequences as spatially continuous,
non-stationary signals, which are denoised through elimination
of noise-related components. Spatially localized matched ﬁltering
is then applied to identify regions of pairwise match/mismatch.
Through these two processes, SDMF increases SNR and improves
the speciﬁcity of CNV detection. Note that SDMF requires
the selection of the matched-ﬁlter length and thresholds for
match/mismatch and loss/gain for CNV detection. These were not
explicitly optimized in this study. The choices of ﬁlter length and
match/mismatch thresholds are dataset dependent. The log2 ratio
threshold depends on the goal of the study, e.g. for detection of
pathological CNVs it may be based on the log2 ratios of normal
CNVs. SDMF was applied to 429 normal sequences from the

 

2344

112 /3.10's1120.100[p101x0'so1112011010101q//:duq 01011 popeolumoq

91oz ‘Og JSanV 00 ::

Signal processing approach for CNV detection

 

TCGA, and detected CNVs were compared to those in the DGV.
Very high sensitivity (383%) relative to the DGV for CNVs with
frequency 310% was estimated. In simulations, SDMF had a higher
true detection rate and signiﬁcantly lower false detection rate and
computational cost than the CBS method, an important advantage
when analyzing large datasets from very high-resolution arrays.

In summary, SDMF is a promising approach for CNV detection
even in very noisy genomic data. Microarray platforms are rapidly
improving and remain the most appropriate tool for interrogating
the entire genome at a reasonable cost. Although next-generation
sequencing technologies are very promising, their cost currently
prohibits the analysis of the entire genome, and may require
signiﬁcant amounts of DNA not always available. Furthermore,
there is much information to be gained from existing well-annotated
array-based studies through the application of highly sensitive and
computationally efﬁcient methods such as SDMF.

ACKNOWLEDGEMENT

We thank Dr Oliver Hoffmann for the aCGH probe mapping, and
Dr Yiping Shen for discussions on the future of microarrays. The
results published here are based upon data generated by The Cancer
Genome Atlas pilot project established by the NCI and NHGRI.
Information from the Database of Genomic Variants has been used
in this study.

Funding: National Institutes of Health (Grant R03 CA121884).

Conﬂict of interest: None declared.

REFERENCES

Alter,O. et al. (2000) Singular value decomposition for genome-wide expression data
processing. Proc. NatlAcad. Sci. USA, 97, 10101710106.

Barros,A. et al. (2007) Assessment of algorithms for high throughput detection
of genomic copy number variation in oligonucleotide microarry data. BMC
Bioinformatics, 8, 368.

Beckmann,J.S. et al. (2007) Copy number variants and genetic traits: closer to the
resolution of phenotypic to genotypic variability. Nat Rev. Genet, 8, 639444.
Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical

and powerful approach to multiple testing. J. R. Stat. Soc. B., 57, 2897300.

Beroukhim,R. et al. (2007) Assessing the signiﬁcance of chromosomal aberrations in
cancer. Proc. Natl Acad. Sci. USA, 104, 20007720012.

Carter,N.P. (2007) Methods and strategies for analyzing copy number variation using
DNA microarrays. Nat Genet, 39, S1GS21.

Cohen,J. (1960) A coefﬁcient for agreement for nominal scales. Educ. Psychol. Meas.,
20, 3746.

Diskin,S.J. et al. (2008) Adjustment of genomic waves in signal intensities for whole-
genome SNP genotyping platforms. Nucleic Acids Res., 36, e126, 1712.

Donoho,D. and Johnstone,I.M. (1994) Spatial adaptation by wavelet shrinkage.
Biometrika, 81, 425455.

Engler,D.A. et al. (2006) A pseudolikelihood approach for simultaneous analysis of
array comparative genomic hybridization. Biostatistics, 7, 399421.

Fridlyand,J. et al. (2004) Hidden Markov Models approach to the analysis of array
CGH data. J. Multivar Anal., 90, 1327153.

Huang,N.E. et al. (1998) Empirical Mode Decomposition and Hilbert spectrum for
non-linear, non-stationary time series analysis. Proc. R. Soc. Lond. A, 454, 9037995.

Hupe,P. et al. (2004) Analysis of array CGH data: from signal ratio to gain and loss of
DNA regions. Bioinformatics, 20, 341373422.

Hsu, L. et al. (2005) Denoising array-based comparative genomic hybridization data
using wavelets. Biostatistics, 6, 2117226.

Iafrate,A.J. et al. (2004) Detection of large-scale variation in the human genome. Nat
Genet, 39, 9497951.

Ionita-Laza,I. et al. (2008) On the frequency of copy number variants. Bioinformatics,
24, 235w2355.

Jakobsson,M. et al. (2008) Genotype, haplotype and copy-number variation in
worldwide human populations. Nature, 451, 99871003.

Kallioniemi,A. et al. (1992) Comparative genomic hybridization for molecular
cytogenetic analysis of solid tumors. Science, 258, 8187821.
Komura,D. et al. (2006) Genome-wide detection of human copy number variations
using high-density DNA oligonucleotide arrays. Genome Res., 16, 157571584.
Lai,W.R. etal. (2005) Comparative analysis of algorithms for identifying ampliﬁcations
and deletions in array CGH data. Bioinformatics, 21, 376373770.

Landis,J.R. and Koch,G.G (1977) The measurement of observed agreement for
categorical data. Biometrics, 33, 1597174.

Lupski,J.R. (2007) Genomic rearrangements and sporadic disease. Nat Genet, 39,
S437S47.

McCarroll,S.A. et al. (2008) Integrated detection and population-analysis of SNPs and
copy number variation. Nat Genet, 40, 116G1174.

Marioni,J.C. et al. (2007) Breaking the waves: improved detection of copy number
variation from microarray-based CGH. Genome Biol., 8, R228.

Olshen,A.B. et al. (2004) Circular binary segmentation for the analysis of array-based
DNA copy number data. Biostatistics, 5 ,5577572.

Perry,G.H. et al. (2008) The ﬁne-scale and complex architecture of human copy-number
variation. Am. J. Hum. Genet, 82, 685495.

Pinto,D. et al. (2007) Copy-number variation in control population cohorts. Hum. Mol.
Genet, Spec No. 2, R1687R173.

Redon,R. et al. (2006) Global variation in copy number in the human genome. Nature,
44, 444454.

Pique-Regi,R. et al. (2008) Sparse representation and Bayesian detection of genome
copy number alterations from microarray data. Bionformatics, 24, 3097318.

Sebat,J. et al. (2007) Strong association of de novo copy number mutations in autism.
Science, 316, 445449.

Snijders,A.M. et al. (2001) Assembly of microarrays for genome-wide measurement
of DNA copy number. Nat Genet, 29, 2637264.

Turin,G.L. (1960) An introduction to matched ﬁlters. IRE Trans. Inf Theory, 6, 3117329.

Van de Wiel,M.A. etal. (2009) Smoothing waves in array CGH proﬁles. Bioinformatics,
25, 109971104.

Willett,P.K. and Thomas,J.B. (1991) Robust signal selection for the matched ﬁlter. IEEE
Trans. Signal. Process., 39, 255972563.

Wineinger,N.E. et al. (2008) Statistical issues in the analysis of DNA copy number
variations. J. Comput Biol. Drug Des., 1, 3687395.

Zhang,F. et al. (2009) Copy number variation in human health, disease, and evolution.
Annu. Rev. Genomics Hum. Genet, 10, 451481.

 

2345

112 /3.Io's[Bumo[pJOJXO'soiJBMJOJuioiq//:duq moi; papeolumoq

91oz ‘Og isnﬁnv uo ::

