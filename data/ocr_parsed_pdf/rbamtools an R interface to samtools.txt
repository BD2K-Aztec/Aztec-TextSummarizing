Bioinformatics, 31(10), 2015, 1663—1664

doi: 10.1093/bioinformatics/btu846

Advance Access Publication Date: 5 January 2015
Applications Note

 

Genome analysis

rbamtools: an R interface to samtools enabling
fast accumulative tabulation of splicing events
over multiple RNA-seq samples

Wolfgang Kaisers1'*"‘, Heiner Schaal1'27r and Holger Schwender1'3

1Center for Bioinformatics and Biostatistics, BMFZ, Heinrich Heine University Diisseldorf, 2lnstitut fiir Virologie,
and 3Mathematical Institute, Heinrich Heine University Diisseldorf, 40225 Diisseldorf, Germany

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
Associate Editor: John Hancock

Received on July 31,2014; revised on December 18, 2014; accepted on December 19, 2014

Abstract

Summary: The open source environment R isf the most widely used software to statistically
explore biological data sets including sequence alignments. BAM is the de facto standard file
format for sequence alignment. With rbamtools, we provide now a full spectrum of accessibility to
BAM for R users such as reading, writing, extraction of subsets and plotting of alignment depth
where the script syntax closely follows the SAM/BAM format. Additionally, rbamtools enables fast

 

accumulative tabulation of splicing events over multiple BAM files.
Availability and implementation: rbamtools is available on CRAN and on R—Forge.

Contact: kaisers@med.u ni—duesseldorf.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The samtools format specifies various data slots for sequence align-
ments many of which are difficult to understand when sequencing
experiments are to be analyzed. For analysis of sequencing data, de-
tailed access to contents of BAM files is needed, especially when
technical problems arise. rbamtools allows R users to investigate
alignment results by reading the header section or retrieve and view
alignments from regions of interest using basic R structures.

rbamtools provides functions for creation and modification of
BAM file header or alignment section contents. rbamtools also fa-
cilitates writing of BAM files which is not possible in Bioconductor
(Gentleman et (11., 2004; Morgan et (11., 2010).

Additionally rbamtools contains a framework for sequential and
fast extraction of alignment gap positions (see Table 1) on RNA-seq
data which are candidate sites for true splicing events. rbamtools is
part of an analysis pipeline for analysis of splicing events in RNA-
seq data which consists of three R packages: rbamtools and
refGenome (Kaisers, 2013a) and spliceSites (Kaisers, 2013b).

The identification of splicing inaccuracies is a non trivial task on
BAM files, since the positions of alignment gaps must be accounted

on billions of reads. With rbmntools, processing data from, e.g. 6O
RNA-seq samples (containing 8.37 x 109 alignments) can be done
in l.75h on a standard workstation with minimal working memory
demand.

Current versions of the samtools C library contain misalignment
(bus) errors (http://en.wikipedia.org/wiki/Busierror), which may
cause program crashes on some architectures (e.g. SPARC).
In rbamtools, these misalignment errors are corrected (see
Supplementary Material).

2 Approach

2.1 Implementation
The package consists of three layers: the samtools C library, C based
containers for alignments and alignment gaps as well as an S4 class
library in R providing the user interface.

The samtools C library is a static copy of samtools (vl.4-r985).
In order to meet CRAN policies, numerous changes had to be
introduced into the source code (B.Ripley and K.Hornik, personal
communication).

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1663

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Figure l

 

 

 

 

 

Freund at (1]., 2003

 

 

 

 

 

Yeo and Burge, 2004

R Core Team, 2014

 

/810'sreumoprOJxo"sotJBuIJOJutotqﬂ:duq

