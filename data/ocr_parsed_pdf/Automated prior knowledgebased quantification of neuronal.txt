ORIGINAL PAPER

Vol. 30 no. 5 2014, pages 726—733
doi:10. 1 093/bioinformatics/btt600

 

Bioimage informatics

Advance Access publication October 17, 2013

Automated prior knowledge-based quantification of neuronal
patterns in the spinal cord of zebrafish

Johannes Stegmaier1'*'i, Maryam Shahidz'e'i, Masanari Takamiyaz, Lixin Yangz,
Sepand Rastegarz, Markus Reischl‘, Uwe Strahle2'3'i and Ralf Mikut“i
1Institute for Applied Computer Science (lAl), Karlsruhe Institute of Technology, Karlsruhe, Germany, 2Institute for

Toxicology and Genetics (ITG), Karlsruhe Institute of Technology, Karlsruhe, Germany and 3Faculty of Biosciences,
Ruprecht-Karls-University of Heidelberg, Heidelberg, Germany

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: To reliably assess the effects of unknown chemicals on
the development of fluorescently labeled sensory-, moto- and inter-
neuron populations in the spinal cord of zebrafish, automated data
analysis is essential.

Results: For the evaluation of a high-throughput screen of a large
chemical library, we developed a new method for the automated
extraction of quantitative information from green fluorescent protein
(eGFP) and red fluorescent protein (RFP) labeled spinal cord neurons
in double-transgenic zebrafish embryos. The methodology comprises
region of interest detection, intensity profiling with reference compari-
son and neuron distribution histograms. All methods were validated on
a manually evaluated pilot study using a Notch inhibitor dose-re-
sponse experiment. The automated evaluation showed superior per-
formance to manual investigation regarding time consumption,
information detail and reproducibility.

Availability and implementation: Being part of GNU General Public
Licence (GNU-GPL) licensed open-source MATLAB toolbox Gait-
CAD, an implementation of the presented methods is publicly avail-
able for download at http://sourceforge.net/projects/zebrafishimage/.
Contact: johannes.stegmaier@kit.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 26, 2013; revised on September 23, 2013; accepted
on October 15, 2013

1 INTRODUCTION

Research in the life sciences is producing an ever increasing
amount of experimental data in basically all areas. Particularly
the fields of toxicology, chemical genetics and classical genetics,
where possibly tens of thousands of treatments of embryos have
to be analyzed, beneﬁt from lately established high-throughput
acquisition techniques that enable large-scale experiments, which
have been inconceivable in the past (Gehrig et al., 2009). In
recent years, zebrafish embryos have emerged as attractive
models for the screening of small molecules with the aim to iden-
tify new entities with a speciﬁc effect on cellular and develop-
mental processes (Flinn et al., 2008). The zebraﬁsh provides

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst two and
last two authors should be regarded as Joint First Authors.

a complex cellular environment that cannot be mimicked in
conventional pharmacological screens with in vitro systems.
Furthermore, a multitude of properties such as fast reproduction
and ex utero development, easy husbandry and handling, avail-
ability of many stable transgenic lines and the transparency in
early developmental stages make the zebraﬁsh an ideal model
organism for high-throughput screening (Detrich et al., 2011).
In many cases, however, the facilitated and highly automated
possibilities on the experimentalists’ side unravel a variety of
new challenges and problems in subsequent data analysis steps.
As meaningful information contained in the large amount of
obtained data can hardly be extracted manually anymore, spe-
cialized software is needed to support or optimally take over the
whole data analysis in an automated pipeline (Eliceiri et al., 2012;
Liu et al., 2008b; Stegmaier et al., 2012).

Besides various articles describing manually/semiautomatically
evaluated experiments (Kanungo et al., 201 1; Yang et al., 2010b),
multiple approaches for the automated evaluation of zebrafish-
based screens have already been proposed in the literature.
A comprehensive survey can be found in Mikut et a]. (2013).
Methods for the automated analysis of gene expression based
on image co-localization and morphing of regional intensity
information to a reference embryo were described by Gehrig
et a]. (2009) and Ronneberger et a]. (2012). Various publications
tackled the problem of automated phenotype recognition (Cao
et al., 2009; Jeanray et al., 2012; Liu et al., 2012; Vogt et al.,
2009) by means of multi-resolution segmentation, randomized
sub-window- and descriptor-based classiﬁcation, respectively.
Moreover, to detect and quantify nuclei in images, several blob
detection methods exist, e.g. based on circular Hough transform,
diffused gradient vector field and Laplacian—of—Gaussian (LOG)
blob detection, as described by Al-Kofahi et a]. (2010) and Liu
et al. (2006), (2008a). Approaches for the automated region of
interest (ROI) detection Via template matching were presented by
Peravali et a]. (2011) or Chen et a]. (2011). The approaches
described by Chen et a]. (2011) and Liu et al. (2006, 2008a) are
most closely related to our analysis. However, it is not yet pos-
sible to quantify the diverse neuron distributions of the spinal
cord in zebraﬁsh.

The aim of this work was to derive an automated analysis
pipeline that could be used to analyze the effect of chemicals
on position, number and ﬂuorescence intensity of the three dif-
ferent neuronal cell types in the spinal cord of zebraﬁsh, namely

 

726 © The Author 2013. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0fp10}x0"sothJJOJutotq/ﬁduq 11101} pQPBOIII/lAOG

9103 ‘Og anﬁnV uo ::

Prior knowledge-based neuron quantification in zebrafish

 

RohoniBeard sensory neurons, interneurons and motoneurons
(Supplementary Fig. S1). Therefore, we performed a pilot study
using a double-transgenic zebraﬁsh with RohoniBeard cells and
motoneurons expressing RFP and interneurons expressing eGFP
in the spinal cord. The developed algorithms should reliably ex-
tract both quantitative and qualitative information and should
be applicable for high-throughput screening.

In Section 2, we brieﬂy present the experimental design of the
pilot study used for algorithmic development and introduce the
newly developed image analysis pipeline, which is comprised of
ROI extraction, intensity proﬁle analysis of different neuron
types as well as quantiﬁcation of sensory- and motoneurons.
The validation of the methods and biological conclusions
can be found in Section 3. Finally, in Section 4, we discuss the
beneﬁts and limitations of our methods.

2 METHODS

2.1 Experimental design

To establish a new automated analysis method for zebraﬁsh-related
screens, we exploited the ﬂuorescent properties of spinal cord neurons
of different sizes, location and signal intensity. We used a double-
transgenic zebraﬁsh line to tailor algorithms that are speciﬁcally suited
to extract information on number and position of neurons in the spinal
cord region of laterally oriented zebraﬁsh. The purpose of using this
particular transgenic combination is to enable the investigation of the
formation of the three key neuronal types of the spinal cord (sensory-,
inter- and motoneurons) in one embryo.

2.1.1 Fish maintenance and transgenic lines The hybrid two-color
transgenic line was generated by crossing a dbeb (developing brain
homeobox 1b) transgenic zebraﬁsh driving eGFP expression in dI6, V0
and V1 interneurons (Yang et al, unpublished) with a Neurog]
(Neurogenin 1) transgenic zebraﬁsh driving RFP expression in Rohoni
Beard cells and motoneurons (Blader et al., 2003 and Supplementary
Fig. Sl). Double homozygous parents were outcrossed with wild-type
AB zebraﬁsh. This resulted in inheritance of each of the transgenes by
100% offspring in a hemizygous state assuring equal intensity of trans-
gene expression in each individual. All zebraﬁsh husbandry and experi-
mental procedures were performed in accordance with the German
animal protection standards and were approved by the Government of
Baden-Wﬁrttemberg, Regierungsprasidium, Karlsruhe, Germany
(Aktenzeichen 35-9185.64). The zebraﬁsh line was maintained as
described by Westerﬁeld (2007). The ﬁsh were kept and raised at the
Institute of Toxicology and Genetics, Karlsruhe Institute of
Technology, Germany.

2.1.2 Chemicals The LY-411575 compound, a potent gamma-
secretase inhibitor that blocks Notch signaling through preventing the
release of the Notch intracellular domain from the plasma membrane,
was used to disturb normal neurogenesis (Fauq et al., 2007). In a previous
study, Shin et a]. (2007) demonstrated that the loss of Notch signaling
results in the formation of excess primary motoneurons and a deﬁcit of
Kolmer-Agfuhr primary cells (KA’ interneurons) as early as 20725 hours
post fertilization (hpf). However, according to our observation, at this
stage Notch inhibitor causes the trunk to bend severely. Therefore, the
used exposure time window between 24418 hpf in our experiment was
selected to affect the neurogenesis of late-born neuronal population, mini-
mizing this malformation that could interfere with the results. All the
working concentrations of LY-411575 were made in 0.003% l-phenyl
2-thiourea (PTU) in ﬁsh water. PTU inhibits pigment formation by
blocking tyrosinase-dependent steps in melanin synthesis so that

pigmentation does not interfere with the detection of the ﬂuorescent
signal (Karlsson et al, 2001).

2.1.3 Experimental Conditions Embryos were collected and washed
thoroughly with buffered egg water [reverse osmosis water containing sea
salt (pH 6.73): Ca 0.8mg/l; 60 ug/ml; Instant Ocean, Red Sea, Houston,
TX, USA, K 0.6mg/l; Mg 2mg/l; Na 16mg/l; S 2mg/l (Yang et al,
2010a)]. The embryos were manually dechorionated at 24 hpf. In one
96-well plate, three embryos per well were distributed with 150 pl of
0.003% PTU (prepared with egg water) as a medium. In a dose-response
experiment for LY-411575 (100 uM stock concentration in 0.003% PTU),
embryos were placed in 11 different concentrations between 0.5e10 uM.
Control embryos were incubated in embryo medium containing 0.04%
dimethyl sulfoxide. Three biological repeats were performed and each
embryo was imaged twice, yielding to at least six image sets per concen-
tration. Better focused images were manually selected to have three high-
quality images of three embryos per concentration and repeat, ending up
with images of 108 embryos.

2.1.4 Microscopy parameters To ensure an informative readout, a
speciﬁc set of microscopy parameters was necessary to visualize the three
types of neurons. Images were taken at 48 hpf using a Leica compound
microscope DM5000 at 10x magniﬁcation (HC PL FLUOTAR 10x NA
0.30 objective). RFP is expressed by both motoneurons and sensory neu-
rons, however, at different intensities. For technical reasons, it was not
possible to acquire images with different exposure parameters through
the same filter channel. Hence, we used two different ﬁlter systems (RFP,
CY3) with overlapping sensitivities to image sensory and motoneurons
(Supplementary Section S4). This allowed us to optimize exposure times
such that each neuron type was optimally visible in one of the channels
(RFP: 40, GFP: 200, CY3: 410ms). The remaining parameters, i.e.
gamma, saturation and gain, were identical for all channels and set to
0.99, 1.5 and 4, respectively. Images were acquired with an intensity range
of 8 bit at a resolution of 1392 x 1040 pixels (px) with a physical pixel size
of 1px é 0.64am.

2.1.5 Algorithmic parameters Owing to the linear shape observed in
all images of this pilot study, rotation correction was turned off and a
radius of r = 70 was used to extract the cropped images, i.e. the cropped
images had a resolution of 1392 x 141 px (Section 2.3). We used
am, 2 {2, 3}, om,1x = {3,4} and 05th = {1,1} for detection of the moto-
neurons (CY3) and sensory neurons (RFP), respectively (Section 2.6 and
Supplementary Fig. S2). Note that these parameters are directly depend-
ing on the physical pixel size and have to be adapted with respect to the
investigated image material.

2.1.6 Validation experiments Statistical values of extracted features
were calculated on all embryos with identical treatment (nine images per
concentration) for all 108 available images. To check for signiﬁcant dif-
ferences of extracted features to the control group, we used a two-sided
Wilcoxon rank sum test (or = 5%). The quality of extracted regression
curves of all images was manually assessed. Moreover, to validate the
seed detection method, RohoniBeard cells were independently counted
by two experts on a blinded subset of 36 randomly selected images with
three images per concentration. Manual counting was not performed for
motoneurons due to the high ambiguity in out of focus regions. This
subset was also used for qualitative assessment of the treatment effect
by the trained human into the categories no effect, slight effect and strong
effect. Using the manually identified hypothetical class associations, we
trained a Bayes classiﬁer with ANOVA-based (ANalysis Of VAriance)
selection of one feature. The classiﬁer performance was validated with
leave-one-out cross validation.

 

727

112 /310's112u1n0fp10}x0"sotJBHJJOJutotq//:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

J.Stegmaier et al.

 

2.2 Prior knowledge-driven algorithmic design

Available prior knowledge such as geometric properties of the specimen,
spatial localization of different objects of interest and the size of stained
nuclei can be used to design, ﬁne-tune and improve developed algorithms
for speciﬁc problems. In our pilot screen, we made use of three different
channels for imaging, which allowed us to enhance the ﬂuorescent signal
of speciﬁc objects of interest by adjusting the exposure times separately
for each channel. Automatic acquisition of an overlay image within a few
seconds preserved focus and guaranteed a perfect co-localization of the
images. The sensory- and motoneurons were visible in both the RFP and
the CY3 channel. Owing to the different expression levels, we used a
shorter exposure time for the RFP channel to achieve a good imaging
of the sensory neurons and a longer exposure time for capturing the CY3
signal to visualize the less prominent motoneuron response. In later ana-
lysis steps, the corresponding overexposed RohoniBeard cells in the CY3
channel were not considered and the motoneurons visible in the RFP
channel were only considered in the CY3 channel. The prior information
is given in Table 1.

Based on these properties, a new image analysis pipeline was developed
to identify alterations in spatial appearance of the different neuron types
and to possibly detect different numbers of present nuclei. The spinal
cord center, i.e. an imaginary line running through the center of the
interneuron band, was used as a spatial reference for all detected features.
The pipeline concept derived from the available prior knowledge is de-
picted in Figure 1, and the individual steps are introduced in the following
sections.

Table 1. Prior knowledge used for the algorithmic design

 

Type Channel Description

 

Interneurons GFP Thick band of cells between sensory-

(dI6, V0, V1) and motoneurons, individual cells
not detectable, cubic polynomial to
model the spinal cord
Sensory RFP, CY3 Mostly well-separated nuclei on dorsal
neurons side of the spinal cord, overexposed in

CY3, good signal in RFP channel,
diameter: 7 — 10am

Motoneurons RFP, CY3 Densely packed nuclei on the ventral side
of the spinal cord, weak signal in RFP
channel, good signal in CY3 channel,
diameter: 5 — 7am

 

Note: Individual channels were perfectly co—localized and exhibited the ﬂuorescent
signal of stained nuclei from three different neuron types with channel—speciﬁc
exposure times and parameters as described in Section 2.1.4.

   
 

 
 
 
  
 
 

Intensity Profile
Extraction
Spatial Distribution
Analysis

   
   
  

ROI Extraction

Image
Acq u isition

 

 
    

 

 

 

 

 

 

 

R f L_ I d Neuron Distribution
Pre— zzﬁgce > Rotation Ingfgge His‘ograms
processmg Fitting Correction Image
Global Statistics

 

 

Fig. 1. Schematic overview of the processing pipeline. Components
shaded in gray can be optionally enabled if required by the image
material

2.3 Region of interest extraction

Initially, a reproducible comparable image region had to be cropped from
the original images I with a resolution of Ix x 1).. Based on prior know-
ledge about the presence of a band of interneurons that appeared as a
dense stripe running along the spinal cord in the GFP images (Fig. 2A),
we tried to model the backbone of the investigated zebraﬁsh by a poly-
nomial regression approximation through this band. Therefore, we
applied an intensity adjustment that saturated the lower and the upper
1%-quantiles of the intensity values, followed by a Gaussian smoothing,
to preserve only the low frequency content of the images. For the image
material considered here, a standard deviation of a = 10 worked well in
practice.

Subsequently, a binarized image (Fig. 2B) of the smoothed GFP image
was created using Otsu’s method (Otsu, 1979). To further improve the
segmented regions and get a dense connected binary object, a morpho-
logical closing operation was performed. In the case of a reduced ﬂuor-
escent signal of interneurons, however, the auto-ﬂuorescent signal of the
yolk sac became more prominent than the desired band of interneurons.
To make the regression curve extraction more reliable in these cases, we
used prior knowledge about the expected position of the band of inter-
neurons in the laterally oriented embryos, to assign the connected com-
ponents in the binary image to the respective tissues. We averaged all
rows of pixels in the horizontal direction of the image as shown in
Equation (2) but for the whole uncropped image and identiﬁed intensity
peaks in this representation. If two dominant, sufﬁciently separated peaks
were detected, the minimum between the peaks was used as a cutoff point
and pixel values on the ventral side of this minimum, i.e. the pixels
associated with the yolk sac were set to zero. In the dichotomized
image we used the image space coordinates of foreground pixels to iden-
tify a regression model that minimized the sum of squared distances,
i.e. we solved:

3 = argmin Z (t, —f(t,., 49))2 (1)

96R" (rupee,

In Equation (1), f represents an arbitrary regression function with un-
known parameter vector 0, 0 is the minimizing parameter vector and 73;
is the set of foreground pixel coordinates that are used to perform the
regression. In the special case considered for this work, i.e. laterally
oriented zebraﬁsh embryos, a third order polynomial deﬁned as
f(x, 0) = 6? + 6% + 63 + 64, with parameter vector 0 = (61, 62, 63, 64)T,
sufficiently described the possible deformations of the spinal cord
region. Choosing an appropriate model for the regression was crucial
to attain comparable results. The individual processing steps for the
ROI extraction are depicted in Figure 2. A linearized version of the
images was achieved by extracting a cropped image region with respect
to the regression curve, i.e. a band of a predeﬁned size r that matched the
spinal cord region below and above the regression curve was used to form

 

Fig. 2. Steps to extract comparable regions of interest from the micros-
copy images. Cropped original image (A), thresholded image using Otsu’s
method (B), regression curve overlayed on the original image (C), linear-
ized crop image for RFP, GFP and CY3 channels (D). Scale bar
= 100am

 

728

112 /310's112u1n01p101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g1sn8nV uo ::

Prior knowledge-based neuron quantification in zebrafish

 

a new image. This yielded a linearized and cropped version of the spinal
cord region 1,. as shown in Figure 2D with size Ix x (2 + 1). In the case of
a strong curvature of the embryo, however, it made sense to optionally
use a rotation correction before extracting the band of interest along the
regression curve (Supplementary Section Sl).

2.4 Intensity proﬁle extraction

A main goal was to automatically extract information about the distri-
bution of different neuron types located in the spinal cord. One approach
to attain this information was the use of averaged intensity values along
each horizontal row of pixels in the cropped image:

It
[bib] 2  Iviixt if} (2)
X i\.:l

for all rows iy = 1, ...,2r +1 and all channels [6 {RFP,GFP,CY3}.
This vector p,, which we call intensity proﬁle, can be visualized in a
common 2D plot (Supplementary Fig. S3). Besides the individual visual-
ization, the vertical alignment of multiple intensity proﬁles provides an
instant overview of possible treatment effects (Fig. 6).

The intensity proﬁles were calculated individually for all three chan-
nels, yielding information about the different neuron types. The detection
of local extrema in the intensity proﬁles was used to identify local max-
imum intensity information as well as the spatial location where most
neurons of a certain type resided. We calculated the area under the curves
to get an impression about the overall presence of the ﬂuorescent signal
according to

in = Zpiiyl- (3)

Based on prior knowledge of the spatial location of different neurons, the
range for the summation was adjusted accordingly. The sensory neurons,
also known as RohoniBeard cells, were located on the dorsal side of the
spinal cord and were visible in the RFP channel ([1,r + 1]), the inter-
neurons expressed their ﬂuorescent signal mainly in the GFP channel and
were centered above the regression curve ([0,5r + l, 1.5r + 1]).As the
ﬂuorescent signal of the RFP expression was visible in the CY3 channel,
motoneurons could be observed on the ventral side of the spinal
cord ([r + 1,2r + 1]) in this channel using a prolonged exposure time
(Section 2.1.4).

2.5 Spatial distribution analysis

The intensity proﬁles of available control embryos were used to construct
a reference intensity proﬁle pl,ctrl that represented the average of the ori-
ginal intensity proﬁles of all control embryos with the associated standard
deviation series 01m as described by Wolf et a]. (2006) (Supplementary
Section S2). Using these series of statistical properties of the control em-
bryos, it was possible to draw conclusions about the difference between
treated embryos to the respective non-treated reference. Therefore, we
calculated arithmetic mean of the normalized distance nd,, i.e. the vari-
ance normalized mean deviation of an arbitrary intensity proﬁle p, from
the averaged control reference meI:

1 1y 1 1y  __ or 
and=Tanrityi=TZ—lp’[’i] mm“ (4)
J’i,:1

J’ 1,21 9'1, m1 [5"]

This feature directly reﬂects the degree of deviation from the control
reference by means of n-fold variance. If the mean value is below one,
for instance, on average all sample points of the investigated intensity
proﬁle lie within a band of one standard deviation around the respective
values of the reference curve. Zero indicates perfect agreement between
treatment and reference.

2.6 Neuron distribution histograms

To quantify the possible impact of investigated toxicants on the presence
of different neuron types, stained nuclei had to be counted automatically.
In this work, we made use of an automated blob detection algorithm
similar to the one described in Al-Kofahi et a]. (2010). Based on a LOG
ﬁltering of the images at various scales, spherical objects could be identi-
ﬁed in the image:

32G(x, o)

—ax2 , (5)

I

2
LoG(x, o) = 02 Z
i:1

with x = (x1,x2)T and G(x,o) being a Gaussian-ﬁltered image with
standard deviation 0. To be able to detect differently sized spherical
objects, we used a LOG scale-space maximum projection with a discrete
step size:

LoGMP(x, 0min, am“) 2  LoG(x, a) (6)
Owing to the fact that the neurons of the same type have similar
sizes, however, we skipped the automatic scale selection performed in
Al-Kofahi et a]. (2010) and only used a set of preselected scales.
A LOG-based blob detector recognizes circular objects with radius
r 2 J2 > a (Al-Kofahi et al., 2010). By manual inspection of a few rep-
resentative images, prior knowledge about the appropriate set of scales
could be gathered and was used to incline the algorithm to search only for
the desired object size (see Table 1). Using the LOG scale-space maximum
projection, points of interest were directly identiﬁed in the local eight
neighborhood of each investigated pixel in the maximum projection in-
stead of using a 3D proximity within neighboring scales as performed,
e.g. in Lowe (2004). The intermediate steps and the results of the auto-
mated seed detection applied on the RFP channel of one imaged embryo
are shown in Supplementary Figure S4. To visualize the distribution of
nuclei in the spinal cord region of the embryo, a histogram of nuclei was
calculated. Therefore, detected nuclei were binned according to their
deviation from the regression curve. Owing to the fact that sensory neu-
rons are only visible on the dorsal side of the regression curve and moto-
neurons are only observed ventrally, we omitted detected nuclei on the
respective other sides to reduce the amount of false positives. An exem-
plary histogram can be found in Supplementary Figure SS. By locating
the mode and maxima of the respective histogram, the spatial occurrence
and the quantity of different neuron populations could be estimated.

2.7 Extracted features

We extracted several features that sufﬁciently characterized the images.
The most straightforward features were global statistical properties of
the linearized cropped images, such as mean, variance, min, max and
median that were attained from the intensity values of each channel
(gt, gig, gimm, gimax, gimcd). Using information about the spatial appear-
ance of the three neuronal populations with respect to the regression
curve, the regions of interest could be further speciﬁed. The global
statistical values for these reduced image areas are equivalent to the
integrated intensity proﬁles (ip, ipa, ipmin, ipmax, ipmcd). Next to the
global intensity-based features, we extracted properties of the intensity
proﬁles as described in Section 2.4. The main characteristics of the inten-
sity proﬁles were deﬁned by the location and the shape of their peaks. By
again exploiting knowledge about the spatial distribution of the three
neuron types, peak locations, peak maxima and the peak width could
be estimated (plp, pvp, pwp). Besides the single features, the intensity
proﬁles could be used to monitor treatment effects. Using an averaged
intensity proﬁle of all control embryos with associated local variance
(pLCm, 01ml), it was possible to deﬁne a norm corridor that speciﬁed
an untreated embryo as shown in Section 2.5. Embryos whose intensity
proﬁles clearly lay outside of this norm corridor should deﬁnitely be
considered for further investigations (11d). In addition, the seed detection

 

729

112 /310's112u1n01p101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g1sn8nV uo ::

J.Stegmaier et al.

 

method described in Section 2.6 was used to calculate an approximation
to the number of nuclei for RohoniBeard cells and motoneurons (nn).
Determining the mode of the calculated nuclei histograms could addition-
ally specify locations with high nucleus density (mn). Depending on the
biological question to be answered, the list of extracted features could be
arbitrarily extended. For the validation of the presented methodology, we
used 11 reasonable features (Table 2).

2.8 Implementation details

All described algorithms were implemented in the MATLAB program-
ming language and are available to the public as an extension package for
the open-source MATLAB toolbox Gait-CAD (Stegmaier et al., 2012).
The results were calculated on a desktop PC equipped with an
Intel®CoreTMi7-2600 CPU at 3.4GHz with 32 GB of memory installed.
For the current amount of data, it was sufﬁcient to process all experi-
ments locally. However, for upcoming high-throughput screens the plat-
form-independent MATLAB implementation and the associated
algorithms should also be executable in a distributed computing environ-
ment and usage of large-scale storage systems.

3 RESULTS
3.1 Validation of the methods

Manual investigation of the acquired image material offers
limited reproducibility and is time consuming even for trained
experts. Initial tests unveiled intra-expert and inter-expert vari-
ations of the extracted values, leading to the conclusion that even
a trained evaluator is not able to satisfactorily reproduce results.
Two experienced human experts required ~4 min to extract the
speciﬁed features for only one image comprising RFP, GFP and
CY3 channel. For an exemplary experiment, consisting of 36
images in this case, already 2.5h of manual investigations were
necessary. In contrast to that the software-based evaluation was
perfectly reproducible and took <6 s per image on a single pro-
cessor of a common desktop computer. This corresponds to a
40-fold reduction of evaluation time, allowing to scale up experi-
ments in a high-throughput manner. The quality of identiﬁed
regression curves and consequently the linearization of the
cropped images was manually investigated for all images of the
pilot screen. The algorithm successfully extracted and linearized
the spinal cord regions in 98% of the images, which corres-
ponded to two misdetections in 108 images. To evaluate the per-
formance of the RohoniBeard cell detection method described in
Section 2.6, manual counting was performed on a subset of 36
images, i.e. three images per concentration, from the previously
described experiments. Using the seed detection method

Table 2. Summary of extracted features used for the analysis

 

 

Name Source Channels Range Description

nn 1,. RFP, CY3 [0, 00] Number of nucleia

pvp p, RFP, GFP, CY3 [0, 255] Proﬁle peak valuesa

ip p, RFP, GFP, CY3 [0, 255r] Integrated Fluorescence
nd nd, RFP, GFP, CY3 [0, oo] Norm deviation

described in Section 2.6, we detect 90.0 :l: 3.3% of the manually
counted RohoniBeard cells in 36 separately evaluated test
images. Furthermore, properties such as regional intensity, spa-
tial positioning of intensity peaks with respect to the spinal cord
center and regional properties of neuron populations were quali-
tatively assessed by a human expert to rate the automatically
provided results of the software and to perform a coarse classi-
fication into the classes no eﬁ’ect, slight eﬂect and strong eﬂect.
The manually performed qualitative assessment of the effects by
direct Visual comparison of the images unveiled strong decrease
interneuron intensity for concentrations >0.5uM of LY-411575
and a slightly increased number of motoneurons. On this basis, a
hypothetical classiﬁcation of the different treatment concentra-
tions was performed. Identiﬁed classes were no eﬁ’ect for control
embryos, slight effect for 0.5/1M of LY-411575 and a strong
eﬁ’ect for higher concentrations using the 36 test images. We
achieve 98% correct classiﬁcations for this task on 108 investi-
gated images using the leave-one-out cross validation with a
Bayes classiﬁer that was trained with one ANOVA selected fea-
ture and the hypothetical class associations. Using ANOVA for
feature selection, pvpGFP turned out to be the most discriminat-
ing value for the observed effect.

3.2 Biological results

The aim of the performed exposure experiment was to validate
the automated quantiﬁcation and characterization of the three
main neuron types in the spinal cord of zebraﬁsh embryos.
Table 3 summarizes a selection of features that were extracted
from 108 acquired images resulting from a 3-f old replicated dose-
response experiment (Supplementary Figs. S6 and S7). Using the
Wilcoxon rank sum test, significant differences of treatment and
control were identiﬁed (Supplementary Table S2). Based on
Visual inspection of the 36 test images, we suspected a constant
number of RohoniBeard cells and the corresponding RFP in-
tensity, decreased interneuron intensity in the GFP channel and a

Table 3. Identiﬁed values for a subset of the most prominent features,
averaged over all embryos per different concentrations of LY-411575.
GFP intensity is signiﬁcantly decreased for increased treatment
concentrations

 

 

Concentration (MM) ipGFP pvaFP l'ldGFp

Ctrl 49.8 :l: 2.2 112 :l: 7.3 0.75 :l: 0.4
0.5 42.2:l:1.8a 74.4:l:9.1a 1.53 :l:0.3a
1.0 32.0 :l:1.4a 49.0 :l: 3.321 2.36 :l: 0.421
2.0 27.7 :l:1.2a 38.1 :l: 3.021 2.93 :l: 0.221
3.0 27.9 :l: 0.721 38.5 :l:1.2a 2.85 :l: 0.321
4.0 27.9 :l: 1.521 37.9 :l: 2.721 3.00 :l: 0.321
5.0 25.5 :l: 0.721 32.7 :l:1.3a 3.27 :l: 0.221
6.0 25.2 :l:1.0a 31.0 :l: 2.221 3.29 :l: 0.321
7.0 25.4:l:0.9a 30.6:l:1.9a 3.16:l:0.2a
8.0 25.6:l:1.0a 31.3:l:1.3a 3.12:l:0.4a
9.0 25.0 :l: 0.821 30.2 :l:1.4a 3.29 :l: 0.221
10.0 25.3 :l:0.8a 30.7:l:1.6a 3.18:l:0.2a

 

“Indicates that the information extraction for these features is only reasonable on
one side of the regression curve.

2“Signiﬁcant differences to the control embryos were identiﬁed by the Wilcoxon rank
sum test.

 

730

112 /310's112u1n01p101x0"sotwuiJOJHtotq/ﬁduq 111011 pap1201umoq

9103 ‘0g1sn8nV uo ::

Prior knowledge-based neuron quantification in zebrafish

 

 

Fig. 3. Overlay of RFP and GFP images obtained for control embryos
(A) and embryos treated with LY-411575 at concentrations of 1.0nM (B),
0.5aM (C), 1.0aM (D) and 10.0aM (E). Scale bar = 100nm

 

5:100 :—
LL
9
Q 50
>
G.
D : I I I
o 0.1 1 10

Concentration [0M]

Fig. 4. The dose-response curve shows an exponential decrease of the
GFP peak intensity (prGFp) for increased LY-411575 concentration.
Similar behavior is observable in most intensity-based features of the
GFP channel

slightly increased number of motoneurons and increased inten-
sity for increasing concentrations. Figure 3 shows a selection of
linearized original images at various concentrations of
LY-411575.

A significant reduction of interneuron intensity compared with
the control embryos could be observed for all GFP-related
features (e.g. ipGFP, pvpGFP or ndGFp). As shown in Figure 4,
the GFP peak intensity value exponentially decreased for
increased treatment concentrations. Additionally, a tendency to
an increased number of motoneurons could be observed in the
CY3 channel for LY-411575 concentrations 3 4.0/1M (e.g.
prCY3, ndcy3). A more detailed View on the extracted informa-
tion was attained by an overlay plot of all intensity profiles
(Fig. 5 and Supplementary Fig. S10). The shaded area in
Figure 5 indicates the norm corridor, i.e. profiles that clearly
lie outside this area should be investigated in more detail. It
could clearly be observed that LY-411575 concentrations
higher than 0.5/1M caused decreased interneuron intensity. In
the CY3 channel, a rather subtle and unspecific alteration of
motoneuron appearance was detected. However, besides signiﬁ-
cant norm distance deviations of ndRFp for LY-411575 concen-
trations 3 0.5/1M, no signiﬁcant effect was observed for the
remaining features of the RFP channel (ipRFP, prRFP and
nnRFp). This corroborated the manual evaluation of the RFP
images that neither the number nor the intensity of sensory neu-
rons was affected by the treatment. The decreased GFP intensity
was caused by a decreased number of interneurons. As the count-
ing of interneurons was not possible using the considered image
material, this was confirmed using 3D image stacks (CTRL and

  
 
   

 

 

 

 

 

 

 

05 . . . . . . . . . . . . . . . . . . .
no effect (CM)
E (m . . . . . . . .. . . . . . . . . . . . .. slighteﬁedwlslm)
f: 0 3 strong effect (>o.5uM)
c .
E
2‘ 0.2
E
g 0.1
E
0 ,
~70 ~35 0 35 70
Position [pxi

Fig. 5. Overlay of 108 intensity proﬁles for the GFP channel. Curves are
colored according to the classiﬁcation. A signiﬁcant reduction of the
interneuron intensity can be observed. A slight effect can be seen for a
concentration 0.5aM and a strong effect for higher concentrations of
LY-411575. The norm corridor is foreshadowed by the gray surface

(127
0.23

E

.:|

g (119

a:

a

'E

3 0.15

E

D

U
0.1:)
one

 

Position [px]

Fig. 6. Image plot of 108 aligned color-coded intensity proﬁles for the
GFP channel. Curves are sorted by increasing LY-411575 concentration.
A ventrally oriented shift of the interneuron peak location can be
observed for a treatment of 0.5aM

1011M). The images were acquired using confocal microscopy
and were manually evaluated by two trained experts
(Supplementary Section S3).

Figure 6 displays a vertical alignment of all 108 intensity pro-
ﬁles of the GFP channel images. This Visualization provided a
convenient way to compare all intensity profiles in one compre-
hensive image. More clearly than in the previous depictions, a
ventrally oriented shift of the GFP peak location could be
observed for a concentration of 0.5/1M. An additional experi-
ment with LY-411575 concentrations from lnM to 1011M con-
ﬁrmed the dose-response estimation (Supplementary Figs. S7, S8
and S9). A comprehensive biological analysis of the observed
effects is up to prospective work, as the focus of this article is
put on the demonstration of the used methods.

4 DISCUSSION

Although diverse zebraﬁsh-related implementations already
exist, up to the best of our knowledge none of the available
methods and software packages was directly applicable to the
challenges observed in our experiment. To analyze the double-
transgenic zebraﬁsh line, information fusion of content found in
different ﬂuorescent channels was required to attain profound
insights into treatment effects on neural development. The most
similar methodology to ours with a focus on automated

 

731

112 ﬁlos1tzuino[piogxo'sontzuuogu1o1q//:dnu 111011 pap1201umoq

9103 ‘0g1sn8nV uo ::

J.Stegmaier et al.

 

quantiﬁcation of the spinal cord region of zebrafish was
described by Chen et al. (2011) and Liu et al. (2006, 2008b).
The embryo alignment method described by Chen et al., how-
ever, was only applicable if the spinal cord exhibited a clear
linear shape. We overcame the linear shape restriction by use
of third order polynomial regression to extract a linearized and
rotation-corrected crop image of the spinal cord region. In con-
trast to the blob detection described by Liu et al. which had a
high error rate for sensory neuron detection, our method uses a
LoG scale-space based blob detection method to identify ap-
proximate centroids of stained nuclei in different ﬂuorescence
channels (Al-Kofahi et al., 2010). Additionally, we present a
method to quantify intensity profiles that reﬂect distributions
of different neuron types present in the spinal cord region.
This method proved to be highly robust against misdetections
and provided an instant impression of phenotype alterations for
sensory neurons, interneurons and motoneurons on chemical ex-
posure. We exploited the potential of spatial distribution meth-
ods to analyze and compare these intensity proﬁles between
different embryos and treatments. The proposed methods were
validated on a manually assembled ground truth from a dose-
response experiment with a Notch receptor inhibitor.

The spinal cord detection robustly identiﬁed regression curves
in 98% of the 108 images that could successfully be used as a
reference for further processing. The erroneous regressions, how-
ever, were still usable as the spinal cord was matched for the
most part and only subtle deviations in border regions of the
images occurred. The problems were mostly caused by undesired
imaging effects such as dirt, dust or overexposed regions. In some
of these cases, the binarization of the images had difficulties in
extracting the correct spinal cord region. This issue might be
solved by an explicit shape model that describes the silhouette
of the desired region.

Although the described method reliably extracted sensory neu-
rons from the given images, it should be noted that it performed
sub-optimally for quantiﬁcation of motoneurons in the CY3
channel. Despite the inaccurate counts, however, the method
could still be useful to estimate qualitative tendencies of the
motoneuron distributions. To attain reliable information about
motoneuron appearance, the intensity proﬁle information
described in Section 2.4 is recommended. The limited capabilities
of the algorithm to differentiate between individual motoneurons
were mainly caused by insufﬁcient image resolution and could
vanish as soon as the magniﬁcation level is increased.
Additionally, more sophisticated nucleus detection methods
such as described by Liu et al. (2008a) or even a fusion of
nuclei detected by different algorithms could be performed.
Assuming a perfectly linearized crop image, intensity proﬁle-
based methods and values were both informative and robust
against misdetections. Using the norm corridor of control
embryo intensity proﬁles, a deviation of treated embryos from
the norm could be easily detected either by intensity proﬁle Visu-
alizations as depicted in Figures 5 and 6 or quantitatively by
using measures such as the norm deviation described in
Equation (4). The classiﬁcation results showed that the features
were well suited to distinguish between different treatment effects
observed in the considered experiment.

Owing to the high versatility of the extracted features, inves-
tigated embryos or rather the possible treatment effects could be

quantitatively characterized. Especially in experiments with a
high number of samples, the demonstrated automation methods
drastically facilitate and accelerate the evaluation of experiments.
Besides the decreased time spent for analysis, the results are
highly reproducible and offer quantitative assessment of features
of interest. Furthermore, the automated analysis enables the ex-
traction of image properties that are beyond the capabilities of
Visual inspection by humans, such as slight intensity variations or
pixel accurate feature localization. The described methods are
specialized for a distinct type of biological investigation.
However, because of the modular design of all algorithms imple-
mented in MATLAB, an adaption to similar problems and the
reuse of implemented methods should be straightforward. In up-
coming work, the developed tools will be used to automate the
analysis of large screens containing a variety of chemical com-
pounds with unknown effects on the neural development of
zebrafish.

Funding: EU IP ZF-Health; (FP7-HEALTH-2007-B2);
NeuroXsys; the Interreg network for synthetic biology in the
Upper Rhine valley (NSB-Upper Rhine); the BMBF funded net-
work EraSysBio; and the Helmholtz Association.

Conﬂict of Interest: none declared.

REFERENCES

Al—Kofahi,Y. et al. (2010) Improved automatic detection and segmentation of cell
nuclei in histopathology images. IEEE Trans. Biomed. Eng, 57, 8414852.

Blader,P. et al. (2003) Multiple regulatory elements with spatially and temporally
distinct activities control neurogeninl expression in primary neurons of the
zebraﬁsh embryo. Mech. Dev., 120, 2117218.

Cao,Y. et al. (2009) Chemical modiﬁer screen identiﬁes HDAC inhibitors as sup—
pressors of PKD models. Proc. Natl Acad. Sci. USA, 106, 21819721824.

Chen,S. et al. (2011) Automated analysis ofzebraﬁsh images for phenotypic changes
in drug discovery. J. Neurosci. Methods, 200, 2297236.

Detrich,H.W. et al. (201 1) The Zebraﬁsh: Disease Models and Chemical Screens. 3rd
edn. Academic Press, Waltham, MA, USA.

Eliceiri,K. et al. (2012) Biological imaging software tools. Nat. Methods, 9, 6977710.

Fauq,A.H. et al. (2007) A multigram chemical synthesis of the y—secretase inhibitor
ly411575 and its diastereoisomers. Bioorg. Med. Chem. Lett., 17, 63924395.

Flinn,L. et al. (2008) Zebraﬁsh as a new animal model for movement disorders.
J. Neurochem., 106, 199171997.

Gehrig,J. et al. (2009) Automated high throughput mapping of promoter—enhancer
interactions in zebraﬁsh embryos. Nat. Methods, 6, 9117916.

Jeanray,N. et al. (2012) Phenotype classiﬁcation of zebraﬁsh embryos by supervised
learning. Toxicol. Lett., 211, $152.

Kanungo,J. et al. (2011) Ketamine induces motor neuron toxicity and alters neuro—
genic and proneural gene expression in zebraﬁsh. J. Appl. T oxicol., 33, 41(P417.

Karlsson,J. et al. (2001) Generating transparent zebraﬁsh: a reﬁned method to im—
prove detection of gene expression during embryonic development. Mar.
Biotechnol, 3, 5227527.

Liu,R. et al. (2012) Automated phenotype recognition for zebraﬁsh embryo based
in vivo high throughput toxicity screening of engineered nano—materials. PLoS
One, 7, e35014.

Liu,T. et al. (2006) Computerized image analysis for quantitative neuronal pheno—
typing in zebraﬁsh. J. Neurosci. Methods, 153, 19(P202.

Liu,T. et al. (2008a) An automated method for cell detection in zebraﬁsh.
Neuroinformatics, 6, 5721.

Liu,T. et al. (2008b) Zﬁq: a software package for zebraﬁsh biology. Bioinformatics,
24, 438439.

Lowe,D.G. (2004) Distinctive image features from Scale—Invariant keypoints. Int. J.
Comp. Vision, 60, 917110.

Mikut,R. et al. (2013) Automated processing of zebraﬁsh imaging data — a survey.
Zebraﬁsh, 10, 401421.

 

732

112 /310'S[BIIJDOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papeo1umoq

9103 ‘0g1sn8nV uo ::

Prior knowledge-based neuron quantification in zebrafish

 

Otsu,N. (1979) A threshold selection method from gray—level histograms. IEEE
Trans. Syst. Man Cybern., 9, 6246.

Peravali,R. et al. (2011) Automated feature detection and imaging for high—
resolution screening of zebraﬁsh embryos. BioTechniques, 50, 3197324.

Ronneberger,0. et al. (2012) ViBE—Z: A framework for 3D virtual colocalization
analysis in zebraﬁsh larval brains. Nat. Methods, 9, 73$742.

Shin,J. et al. (2007) Notch signaling regulates neural precursor allocation and binary
neuronal fate decisions in zebraﬁsh. Development, 134, 191171920.

Stegmaier,J. et al. (2012) Information fusion of image analysis, video object track—
ing, and data mining of biological images using the open source MATLAB
toolbox Gait—CAD. Biomed. Eng, 57 (Suple), 458461.

Vogt,A. et al. (2009) Automated image—based phenotypic analysis in zebraﬁsh
embryos. Dev. Dyn., 238, 65(r663.
Westerﬁeld,M. (2007) The Zebrafish Book: A Guide for the Laboratory Use of
Zebraﬁsh (Danio rerio). 5th edn. University of Oregon Press, Eugene, OR.
Wolf,S. et al. (2006) Automated feature assessment in instrumented gait analysis.
Gait Posture, 23, 3317338.

Yang,L. et al. (2010a) Methyl mercury suppresses the formation of the tail primor—
dium in developing zebraﬁsh embryos. T oxicol. Sci., 115, 372390.

Yang,L. et al. (2010b) Regulatory interactions specifying kolmer—agduhr inter—
neurons. Dev, 137, 27137272.

 

733

112 /3.IO'S[BIIJDOIPJOJXO'SOIJBLUJOJIIIOIq/ﬂduq 111011 papao1umoq

9103 ‘0g1sn8nV uo ::

