Bioinformatics, 2016, 1—8

doi: 10.1093/bioinformatics/btw401

Advance Access Publication Date: 4 July 2016
Original Paper

 

 

Structural bioinformatics

SwiSpot: modeling riboswitches by spotting
out switching sequences

Marco Barsacchi,1 Eva Maria Novoa,2'3 Manolis Kellisz'3 and
Alessio Bechini1'*

1Department of Information Engineering, University of Pisa, Largo L. Lazzarino, Pisa, IT 56122, Italy, 2Computer
Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, 32 Vassar Street,
Cambridge, MA 02139, USA and 3The Broad Institute of MIT and Harvard, 415 Main Street, Cambridge, MA 02142
USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on December3, 2015; revised on May 30, 2016; accepted on June 20, 2016

Abstract

Motivation: Riboswitches are cis—regulatory elements in mRNA, mostly found in Bacteria, which
exhibit two main secondary structure conformations. Although one of them prevents the gene
from being expressed, the other conformation allows its expression, and this switching process is
typically driven by the presence of a specific ligand. Although there are a handful of known ribos—
witches, our knowledge in this field has been greatly limited due to our inability to identify their
alternate structures from their sequences. Indeed, current methods are not able to predict the pres—
ence of the two functionally distinct conformations just from the knowledge of the plain RNA nu—
cleotide sequence. Whether this would be possible, for which cases, and what prediction accuracy
can be achieved, are currently open questions.

Results: Here we show that the two alternate secondary structures of riboswitches can be accur—
ately predicted once the ’switching sequence’ of the riboswitch has been properly identified. The
proposed SwiSpot approach is capable of identifying the switching sequence inside a putative,
complete riboswitch sequence, on the basis of pairing behaviors, which are evaluated on proper
sets of configurations. Moreover, it is able to model the switching behavior of riboswitches whose
generated ensemble covers both alternate configurations. Beyond structural predictions, the ap—
proach can also be paired to homology—based riboswitch searches.

Availability and Implementation: SwiSpot software, along with the reference dataset files, is avail—
able at: http://www.iet.unipi.it/a.bechini/swispot/

Supplementary information: Supplementary data are available at Bioinformatics online.

Contact: a.bechini@ing.unipi.it

 

1 IntrOdUCtlon Riboswitches are RNA elements, mainly found in bacteria, that

Gene regulation is essential to achieve organism versatility, giving are embedded in 5’-t1ntranslated regions of mRNA (Garst et (11.,
cells control over structure and functions and being the basis for cellu- 2011), They are able to sense cellular metabolites with no involve-
lar differentiation, morphogenesis, and adaptability. Since the discov- ment of protein factors, and consequently modulate either mRNA
ery of ribozymes, it has become more and more evident that RNA transcription or translation by adopting one out of two possible
molecules are also actively involved in regulatory mechanisms, includ- structures (Serganov and Nudler, 2013), known as ‘ON’ and ‘OFF’

ing the regulation of gene expression (Waters and Storz, 2009). conformations. Riboswitches are usually built around an aptamer

(C7 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

/310‘srcumo[p10}xo‘sopcuHOJIIrorq/ﬁdnq

(iarst cl (1]., 2011

Breaker, 2012

Peselis and Serganov, 2014

W’ittmann
and Suess, 2012 L'unse
8101., 2014

(llote, 2015
Nawrocki cl (1]., 2009

Abreu-(ioodger and 1\4erino, 2005
2009

(hang at (11.,

Voss cl (1]., 2004
Janssen and (iiegerich, 2014 Fi‘eyhult
cl (1]., 2007
(llote 8101., 2012

Lorenz cl (1]., 201 1

Supplementary Table 51

Lorenz cl (1]., 2011
1\4athews cl (1]., 2004

Breaker, 2012

Nawrocki cl (1]., 2015

Ensemble Builder

Ensemble Analyzer

Constrained
Folding

 

(ireenleaf cl (1]., 2008

Figure 1

Classifier

/810'sreumo[plogxo"sormuuogurorqﬂ:duq

Modeling riboswitches by spotting out switching sequences

 

complete sequence and the missing details must be obtained through
a systematic review of studies on single riboswitches, whenever
available. The riboswitch records used as our reference dataset and
reported in Table 1 have been defined carrying out this reviewing
work and, to the best of our knowledge, they can be regarded as one
of the most comprehensive riboswitch dataset to date, at least in
terms of the complete sequence set (aptamer + expression platform).
It covers the main riboswitch families and the major regulatory
mechanisms.

Our complete reference dataset contains 40 records, divided in
three groups. The first two groups include 20 riboswitches from 16
families (Table 1). The first group encompasses twelve sequences
(some already used in previous studies (Quarta et al., 2012)) with
reliable SwSeq information (first part of Table 1). For each record in
the group, whenever not explicitly reported in the literature, the
switching sequences have been identified by comparing the two
known alternative secondary structures. The second group contains
eight riboswitches whose SwSeq has not been identified yet (second
part of Table 1); despite this lack of information, they can be used
to validate the overall method, but not the SwSeq Extractor. The
twenty elements in the last group (shown in Table 52) have been
used as negative controls; they are not riboswitches, and consist of
ncRNAs, in the same length range of the previous groups, selected
from the Rfam database (version 12.0, see http://rfam.xfam.org) to
be representative of heterogeneous secondary structures. Among
them, we have taken care to include RNAs that exhibit other types
of switching behaviors.

3 Algorithms

3.1 SwSeq extractor

A central question in the proposed approach is how to spot the
switching sequence out of an RNA sequence 1’, using no additional
information. This task is assigned to the SwSeq Extractor module.

Table 1. Riboswitches of the reference dataset

Scarceness of accurate structural data on riboswitches makes it im—
possible to follow a typical machine—learning approach. Moreover, re—
cent studies on entropy contents of riboswitch sequences
(Manzourolajdad and Arnold, 2015) do not focus on SwSeqs. Thus,
we propose to use an ensemble (a multiset) E, of conformations,
which will likely contain conformations close to the two alternative
structures. Once E, has been defined, base pairings across different
conformations in E, must be analyzed to identify the SwSeq. These
two tasks, named “Ensemble Builder” and “Ensemble Analyzer”, are
integral parts of the SwSeq Extractor module (Fig. 1).

The actual content of E, determines the effectiveness of the
whole SwSeq extraction procedure. An implicit choice for E, can be
taken by referring to the McCaskill algorithm (McCaskill, 1990) to
compute the frequency of all possible base pairings at equilibrium at
a given temperature, subsumed in the matrix P. In this case, the ideal
reference E, accounts for all the conformations and their specific sta—
bility. We shall derive results according to this choice first, and then
we shall compare them with results from a stochastic approach in
building E,.

The SwSeq is identified by the ‘Ensemble Analyzer”, which searches
for the subsequence in 1’ that most frequently shows alternative base-
pairing (upstream or downstream) across structures in E,. We propose
to capture this behavior by means of a proper scoring method; the pre—
dicted SwSeq would then be the one with the maximum score. The
corresponding pseudo—code is shown in Algorithm 51.

In defining the scoring method, we make use of the basic pro—
moting score 5!; > 0, and the basic penalty 5,, < 0. Let us consider
the subsequence rlj. . ./+ l] of length 1 starting at index /; its mean
frequency of upstream/downstream base-pairing, indicated respect—
ively by Fup(j.l) and Fdo(/'. I), can be calculated through the
McCaskill pairing probability matrix P (the probability for base pair
(x, y) is indicted here as Plx. 31]):

1j+l—1l;—1
  
h:;‘ i:0

 

 

 

IDa Riboswitch Class Gene—Organism Switching mechanism Boltzmann Cov.b
thiM_TPP Thiamine Pyrophosphate tlaiM — E. coli Translation YES
add_Adenine Adenine add - Vibrio uulniﬁcus Translation YES
folT_THF Tetrahydrofolate folT- Alkaliplailus metalliredigens Translation N.A.
Xpt_Guanine Guanine xpt - Bacillus subtilis Transcription NO
pbuE_Adenine Adenine pbuE (yd/7L) — B. subtilis Transcription NO
mth_Mg Magnesium mgtE — B. subtilis Transcription YES
yitJ_SAM S-adenosylmethionine yit] — B. subtilis Transcription YES
lysC_Lysine Lysine lysC — B. subtilis Transcription YES
tenA_TPP Thiamine Pyrophosphate tenA - B. subtilis Transcription YES
metH_SAH S-adenosylhomocisteine metH - Dec/aloromonas aromatica Transcription N.A.
VEGFA Het. nuclear ribonucleoprotein L VEGFA - Homo sapiens Alt. Splicing YES
thiC_TPP Thiamine Pyrophosphate tbiC - Arabidopsis thaliana Alt. Splicing N.A.
moaA_Moco Molybdenum Cofactor moaA — E. coli Translation

btuB_C0balamin Cobalamin btuB —E. coli Translation

alx_PH PH alx — E. coli Translation

GEMM_CDA Cyclic-di-Guanosine Monoph. Daud_1768 - Desulforudis audaxz/iator Transcription

cch_Flouride Flouride cch - Bacillus cereus Transcription

PreQ1 Pre-Queosine glyS - Fusobacterium nucleatum Transcription

ydaO_ATP ATP ydaO — B. subtilis Transcription

metA_SAH S-adenosylmethionine metA - Agrobacterium tumefaciens Transcription

 

aRiboswitches have been subdivided into those for which the SwSeq is known (upper panel) and not known (lower panel).

l’Boltzmann coverage has been evaluated with the extended sampling approach described in text. List of ncRNA used as negative controls are shown in

Supplementary Table 52. Full description of the reference dataset, including the annotated switching sequences, can be found in Supplementary Table 51.

ﬁm'sreumol‘pquo'sopeuuowtotq/ﬁdnq

Supplementar) l\4aterial

Supplementar) Figure S 1

Figure 2

Equation (4)

Ding and Laurence, 2003

Downstream
Upstream

Figure 3

Quarta cl LIL, 2012

3

Supplementar) Table 5.)

 

Supplementary Fig. 82

/3.Io's[BumoprOJxo"sotJBuiJOJutotqﬂ:duq

Modeling riboswitches by spotting out switching sequences

 

specifying via a mask string, where a base may be paired upstream
(‘<’), downstream (‘>’), or not constrained at all (‘.’).

The implementation of this module was tested on the first group
of our reference dataset, i.e. containing riboswitches with experi—
mentally validated SwSeqs. We have been able to closely predict the
two alternate configurations in ~80% of the cases, and reconstruct
the remaining ones with very minor errors (Supplementary Table
51). Notably, this was the result that pushed us to shape the whole
approach.

In a nutshell, we can conclude that the plain knowledge of the
switching sequence is generally sufficient to predict the two func—
tional structures of the riboswitch (Supplementary Fig. S3 for fur—
ther considerations on switching sequences).

3.3 Classifier

Our method derives two alternative structures for a target RNA se—
quence and it is up to the Classifier module to determine whether
they may be associated to a typical riboswitch behavior. The pro—
posed solution relies on the identification of secondary motifs
known to be related to specific gene regulation mechanisms in ribos—
witches. The extent to which such motifs are present in the input
conformations is quantified by means of specific indices, namely i513
for SD sequestering, and in- for transcription termination. Because
of its complexities and subtleties, alternative splicing has not been
directly addressed. In its current form, the Classifier can be sensibly
applied only to prokaryotic sequences.

To quantify translation inhibition, we first locate the SD pattern
in the sequence, and then count the fraction of unpaired bases nub in
the found SD sequence interval (Chen et al., 1994) in each of the
two alternate structures. The greater nub, the lower the sequestering
of the SD site. Our search consisted on the following consensus se—
quence: AGGAGG, followed by a start codon (AUG), separated by
5—10 bases from the SD site. If a given sequence does not possess a
terminator (see Equation 7 below), it is searched against one of the
patterns in the database of small SD, located within a small distance
from the end of the sequence. Once found the SD, we measure the
difference between the unpaired fraction of the found SD in the two
predicted structures. The index i513. 0 3 i513 S 1 can be defined as
the absolute difference of nub in the alternative conformations, over
the SD length.

Transcription termination is typically determined by a ‘termin—
ator hairpin” (Wilson and von Hippel, 1995), which can be detected
as a stem—loop—like motif, followed by a run of ‘U’s. In practice, this
can be performed by substituting dots in the dot—bracket notation
with the symbols of the corresponding bases, and then looking for
matches of one of the following patterns: The first, of the form
‘({3,}[ACGU]{3,8}){3,}U{3,}.{,20}$’ to identify long hairpins, and
the other, ‘){8,}U{3,}.{,20}$’, to catch terminators with a more
complex topology. Although unlikely, this pattern might introduce
false positives in the case of a stem loop within a multiloop that is
followed by a run of ’U’s and is close to the sequence end. We recall
that typically in regexes ‘(’ and ‘)’ are used as group delimiters; thus,
in practice parentheses symbols should be indicated by ‘\(’ and ‘\)’
instead. A termination—based riboswitch is correctly predicted if at
least one of the patterns is matched only in one of the alternative
structures. In this case, we set in- : 1; in : 0 otherwise.

It has been proposed that an RNA switch could be predicted by
analyzing its energy landscape (Clote, 2015). According to this hy—
pothesis, an RNA switch ideally shows two distinct clouds of points
in the conformational landscape. This feature, although not exclu—
sively held by riboswitches, could indeed be used to strengthen the

classification procedure. For this reason, to quantify how well two
separate clusters can be spotted in E,, we perform a 2—medoids cluster—
ing on the ensemble, based on pairwise bp—distances (other possible
metrics would derive similar results (Barsacchi et al., 2016)). We then
characterize the result with the silhouette index is“, i.e. by computing
the mean of the silhouette coefficients for all the elements in the set
(Rousseeuw, 1987). This is one of the most popular indexes to quan—
tify clustering quality, and it approaches 1 for increasing quality.

The overall classification outcome can be based on a global
index that comprises the previous ones:

Ir 2 iso(1 — i'r'r) + in + i511 (7)

A riboswitch behavior will be foreseen in all cases if I, is beyond
a given threshold value 1,.

3.4 Implementation

Algorithms have been initially implemented in Python, and the soft—
ware has been built upon a Python wrapper from ViennaRNA li—
brary, compiled from sources provided by TBI (http://www.tbi.
univie.ac.at/RNAl). A version in C language is available as well,
suitable for faster computations. Being based on RNAsubopt and
RNAfold, the current algorithm implementation does not support
pseudoknotted structures.

The runtime of the Ensemble Analyzer increases as
O(l, - wlenmx) % O(lr), where l, and wlenmx indicate the sequence
length and the maximum length of the SwSeq, respectively. The
complexity of the McCaskill algorithm is O(l,3), while the complex—
ity of the suboptimal Boltzmann sampling is O(n - l,3 + N2) (Ding
and Lawrence, 2003), with N as the ensemble cardinality. In prac—
tice, in the ordinary ranges for such parameters, the runtime shows a
linear dependence on input sequence length (Supplementary
Fig. S4), and it takes a few seconds per sequence, thus allowing this
method to be applied on large datasets in a genome—wide fashion.

4 Results

The method presented here is capable of predicting the presence of a
riboswitch—including its two alternate conformations—using as in—
put only its nucleotide sequence. The procedure consists in three
major steps, including: (i) prediction of the switching sequence
(SwSeq), (ii) prediction of the alternate secondary structure con—
formations and (iii) scoring, and consequent classification, of the se—
quence as a putative riboswitch (Fig. 1). The proposed approach has
been tested on the reference dataset, obtaining the results reported
in Supplementary Table S4; moreover, it has been used to investigate
a complete set of annotated putative riboswitches from the Rfam
database (Rfam 12.0). Our method is fully applicable to any pro—
karyotic organism at a genome—wide level, targeting single sequences
up to 300 nt each.

4.1 Application to the reference dataset

The ability to spot out the SwSeq depends both on the analysis pro—
cedure applied to the ensemble, and on the ensemble representative—
ness of the two functional conformations. Indeed, considering the
computational steps in the SwSeq Extractor and the formulation of
Equation (4), the sampling procedure itself, whenever used, affects
the reliability of the outcomes in this module (Fig. 3).

We first tested the SwSeq Extractor module on the first group of
our reference dataset, obtaining 10 exact SwSeq predictions out of
12 cases. We then predicted SwSeqs also for sequences in the second
group, obtaining the putative alternative structures for all sequences

ﬁm'sreumol‘pquo'sopeuuowtotq/ﬁdnq

@0999090
G
eoa°eage°g °ec°a

gas)

Figure 4

Figure 5

Supplementar) Table S4

Figure 6

 

Clote, 2015

o 0
ea“

00
eoaeeoeoe 999°:
$099960.)

60 0

039909

(a
O
o

and Standle}, 2013

(iruber cl LIL, 2010

BP prob Illty
Mean on ensemble

 

All sequences
Wlth Ensemble Cove ge

 

Katoh

/310'S[BHJHOFPJOJXO'SOIJ’BLUJOJIIIOlq/ﬂduq

 

SD nucleotides

/

Figure 7

 

Supplementar)
Table S6

Clote, 2015

Supplementar) Fig.

S5 Supplementar) Table S5

Figure 8
Fre}hult 0! ul., 2007

Clote, 2015

/310'S[BHJHOFPJOJXO'SOIJ’BLUJOJIIIOlq/ﬂduq

M. Barsacchi et al.

 

predictions of putative riboswitches. Importantly, from this experi—
ence we observe that the quality of results depends on the capability
of selecting the proper subsequence to analyze, around the aptamer,
down to the expression platform, and not beyond.

Lessons learned in using the proposed algorithms indicate pos—
sible future improvements, although apparently difficult to apply.
Neglecting the energy contribution of the ligand and kinetic/co—
transcriptional aspects of the folding process can likely lead to
biased samplings of the energy landscapes, where conformations
similar to both the alternative structures are not adequately repre—
sented. This issue could be addressed by introducing additional, di—
verse forms of sampling. Unfortunately, the lack of real structural
data prevents any solid assessment of this kind of improvement.
Furthermore, the limitation of excluding pseudoknots could be
removed, devising new algorithms for the SwSeq Extractor and the
Constrained Folder (Fig. 1).

Future work will investigate possible improvements within each
single module, as well as the provision of new functionalities in add—
itional modules.

Funding

The work was partially supported by individual institutional funds (for A.B.)
from the University of Pisa. E.M.N. is supported by a Human Frontier
Science Program (HFSP) Postdoctoral Fellowship (LT000307/2013-L).

Conﬂict of Interest: none declared.

References

Abreu-Goodger,C. and Merino,E. (2005) RibEx: a web server for locating
riboswitches and other conserved bacterial regulatory elements. Nucleic
Acids Res., 33 (Suppl 2), W690—W692.

Barsacchi,M. et al. (2016). Extensive assessment of metrics on RNA secondary
structures and relative ensembles. In: Proc. of31st ACM Symp. on Applied
Computing, pp, 44—47. ACM Press.

Breaker,R.R. (2012) Riboswitches and the RNA world. Cold Spring Harb.
Perspect. Biol., 4,

Chang,T.H. et al. (2009) Computational identiﬁcation of riboswitches based
on RNA conserved functional sequences and conformations. RNA, 15,
1426—1430.

Chen,H. et al. (1994) Determination of the optimal aligned spacing between
the Shine-Dalgarno sequence and the translation initiation codon of
Escherichia coli mRNAs. Nucleic Acids Res, 22, 4953—495 7.

Clote,P. (2015 ). Computational Methods for Understanding Riboswitches,
volume 553 of Methods in Enzymology. Elsevier.

Clote,P. et al. (2012) Maximum expected accuracy structural neighbors of an
RNA secondary structure. BMC Bioinformatics, 13, 1—18.

Ding,Y. and Lawrence,C.E. (2003) A statistical sampling algorithm for RNA
secondary structure prediction. Nucleic Acids Res., 31, 7280—7301.

Freyhult,E. et al. (2007) Boltzmann probability of RNA structural neighbors
and riboswitch detection. Bioinformatics, 23, 2054—2062.

Garst,A.D. et al. (2011) Riboswitches: structures and mechanisms. Cold
Spring Harb. Perspect. Biol., 3, doi: 10.1101/cshperspect.a003533

Greenleaf,W.J. et al. (2008) Direct observation of hierarchical folding in single
riboswitch aptamers. Science, 319, 630—633.

Gruber,A.R. et al. (2010). RNAZ2.0: Improved Noncoding RNA detection in
Proc. of Paciﬁc Symp. on Biocomputing, World Scientiﬁc press. 69—79.
doi:10.1142/9789814295291_0009.

Janssen,S. and Giegerich,R. (2014) The RNA shapes studio. Bioinformatics,
31, 423—425.

Katoh,K. and Standley,D.M. (2013) Mafft multiple sequence alignment soft-
ware version 7: Improvements in performance and usability. Mol. Biol.
Evol., 30, 772—780.

Lorenz,R. et al. (2011) ViennaRNA package 2.0. Algorithm Mol. Biol., 6, 26.

Lunse,C.E. et al. (2014) The promise of riboswitches as potential antibacterial
drug targets. Iimm, 304, 79—92.

Manzourolajdad,A. and Arnold,]. (2015) Secondary structural entropy in
RNA switch (riboswitch) identiﬁcation. BMC Bioinformatics, 16, 133.

Mathews,D.H. et al. (2004) Incorporating chemical modiﬁcation constraints
into a dynamic programming algorithm for prediction of RNA secondary
structure. Proc. Natl. Acad. Sci. USA, 101, 7287—7292.

McCaskill,].S. (1990) The equilibrium partition function and base pair
binding probabilities for RNA secondary structure. Biopolymers, 29,
1 105 —1 1 19.

Nawrocki,E.P. et al. (2009) Infernal 1.0: inference of RNA alignments.
Bioinformatics, 25, 1335—1337.

Nawrocki,E.P. et al. (2015) Rfam 12.0: updates to the RNA families database.
Nucleic Acids Res., 43, D130—D137.

Peselis,A. and Serganov,A. (2014) Themes and variations in riboswitch struc-
ture and function. Biochim. Biophys. Acta, 1839, 908—918.

Quarta,G. et al. (2012) Dynamic energy landscapes of riboswitches help inter-
pret conformational rearrangements and function. PloS Comput. Biol., 8,
e1002368.

R0usseeuw,P.J. (1987) Silhouettes: A graphical aid to the interpretation and
validation of cluster analysis.]. Comput. Appl. Math, 20, 53—65.

Serganov,A. and Nudler,E. (2013) A decade of riboswitches. Cell, 152, 17—24.

Voss,B. et al. (2004) Evaluating the predictability of conformational switching
in RNA. Bioinformatics, 20, 1573—1582.

Waters,L.S. and Storz,G. (2009) Regulatory RNAs in bacteria. Cell, 136,
615—628.

Wilson,K.S. and von Hippel,P.H. (1995) Transcription termination at intrinsic
terminators: the role of the RNA hairpin. Proc. Natl. Acad. Sci. USA, 92,
8793—8797.

Wittmann,A. and Suess,B. (2012) Engineered riboswitches: Expanding
researchers’ toolbox with synthetic RNA regulators. FEBS Letters, 586,
2076—2083. doi:10.1016/j.febs1et.2012.02.038

ﬁm'sreumol‘pquo'sopeuuomtotq/ﬁdnq

