BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

FisHiCaI: an R package for iterative FISH-based calibration of Hi-C data

 

the following function, usually termed stress in a multidimensional scaling
setting (Kruskal, 1964): 21. <1. wU-(SU — di‘j( Y)2, where wit) are the weights
we assign according to the reliability of 8,3). As we mostly rely on local
information, we can use here a local stress function (Chen and Buja,
2009), where missing 8,.) are replaced with a constant d,,,,» (d,,,,» >>
known 8,3,) and w” take the value of 1 /d,-,,,» for missing distances and 1
otherwise (for din)»: 1, weights of missing distances should be set to a
small constant <<l). As wit) define an irreducible matrix, the stress mini-
mization could be performed through Scaling by Majorizing a
Complicated Function (SMACOF) (De Leeuw, 1977), a well-established
strategy for this task, which guarantees convergence.

The calibrated Hi-C distances 8,) further deﬁne a weighted undirected
graph G{ V, E}, where V is the set of loci and E is the set of edges: {(vi,v/~)|
(Sit/>0, if: j} with weights 8,3,; Here we distinguish between immediate
neighbors from the same chromosome (cis) and from different chromo-
somes (trans) and detect a spatial inconsistency for a node v in G, if the
subgraph G’ of all (immediate) trans neighbors of v is not connected.
Further identifying the connected components in G’ can highlight the
cause of inconsistency and the underlying spatial division. An inconsist-
ency represents an event where several loci that are in an accessible range
from another locus (in trans), are not in an accessible range themselves,
which may occur, for example, owing to homology or noise.

The iterative calibration process starts with measuring the discrepan-
cies between Hi-C and FISH data, which could aid in reproducibility
assessment and point to functionally meaningful events (Supplementary
information, Section 5). The output of the calibration is then used for 3D
inference applications, as described above (and for other applications,
Section 4). Finally, studying the resulting spatial models, for example,
across chromosomes or different tissues, provides the input for the next
iteration to further reﬁne the calibration model.

3 SOFTWARE IMPLEMENTATION

FisI-IiCal v1.1 implements the methods described in Section 2.
Users can ﬁrst prepare and apply their calibration
(Supplementary Table S1: prepareData, prepareCalib, calibrate)
and use 3D inference methods (Supplementary Table S1: lsmacof,
and iInc functions) to spatially explore their data and further
reﬁne their calibration (Supplementary Table S1: updateCalib,
getInfoLevelForChr). To make it user—friendly and accessible,
FisHiCal further includes examples and comprehensive documen—
tation. Finally, scalability and feasible running times are achieved
through C++/R integration (Supplementary information,
Section 6).

4 USE CASE AND APPLICATIONS

Hi—C data from human IMR90 ﬁbroblasts (Dixon et al., 2012),
GM06990 lymphoblasts and K562 erythroleukemia (Lieberman—
Aiden et al., 2009) cell lines were pre—processed and corrected for
noise and bias, as described by Shavit and Lio’ (2014). The data
were then matched with FisHiCal::prepareData, at a resolution
of 1Mb, to FISH distances from human primary fibroblasts
(Mateos—Langerak et al., 2009). Supplementary Figure S1 pre—
sents these data and the calibration curves that were estimated
with FisHiCal::prepareCalib, conﬁrming our model across the
three cell lines. The best fit was achieved for FISH and Hi—C
data from the same cell type (ﬁbroblasts) with a consistent outlier
at 1.49 pm, mapped to a cis distance in chromosome 1. To
further explore the spatial basis of this outlier, we have recon—
structed the 3D structure of chromosome 1 from the calibrated

(ﬁbroblasts) Hi—C matrix with FisHiCal::1smacof. The predicted
structure (Supplementary Figure S2) conﬁrmed the known
partition into two chromatin compartments (Lieberman—Aiden
et al., 2009) and suggested a possible explanation for the outlier.
The corresponding two successive l—Mb bins (encircled in
Supplementary Figure S2b) formed part of a chromatin loop
in our model. While Hi—C captured all intra—loop frequencies
(leading to a relatively high value), FISH distances were likely
to be measured between the far ends of the loop, as the corres—
ponding probes were mapped to highly transcribed genes
(Mateos—Langerak et al., 2009). Further exploring the calibration
curves of silenced and activated regions could confirm whether
this example illustrates a new measure for looping events
(see also Supplementary information, Section 8). Additional
examination of the inconsistencies detected for loci in chromo—
some 1 with FisHiCal::searchInc, highlighted a long genomic
domain (18496 Mb), which was in contact with two loci in
chromosomes 7 and 16 that were not themselves connected
(Supplementary Figure S3). As previous ﬁndings position
chromosome 1 homologs at different locations in the nucleus
(Bolzer et al., 2005), this inconsistency suggests that the loci in
chromosome 16 and chromosome 7 are in contact with different
instances of the genomic domain in chromosome 1, correspond—
ingly. Additional experimental knowledge (e.g. from EM) could
be used to further explore this finding. The use case described
above illustrates an iterative FISH—based procedure for Hi—C
calibration. Further applications of calibration include quality as—
sessment and genome wide cytogenetic studies (Supplementary
Figures S4 and S5). With more FISH and Hi—C data becoming
available, building chromosomes maps with accurate scale and
carrying time—series calibration analysis will be made possible
with FisHiCal (Supplementary Figures S6 and S7).

5 CONCLUSION

Being the ﬁrst tool to integrate FISH and Hi—C data, FisHiCal
shows the importance of calibration for studying the nuclear
architecture with different techniques, with applications span—
ning cytogenetics, differentiation and spatio—temporal studies.

ACKNOWLEDGEMENTS

We thank Dr Sandra Goetze for kindly providing us with FISH
measurements. We thank Dr Sabrina Tosi and Dr Chris Town
for helpful discussion on technical and clinical aspects of FISH
analysis.

Funding: We thank FP7—Health—F5—2012, under grant agreement
no 305280 (MIMOmics).

Conﬂict of Interest: none declared.

REFERENCES

Bolzer,A. et a]. (2005) Three—dimensional maps of all chromosomes in human male
ﬁbroblast nuclei and prometaphase rosettes. PLoS Biol, 3, e157.

Chen,L. and Buja,A. (2009) Local multidimensional scaling for nonlinear dimension
reduction, graph drawing, and proximity analysis. J. Am. Stat. Assoc., 104,
2097219.

 

3121

ﬁm'spzumofpmﬂo'sopeuuopuotq/ﬁdnq

Y.Shavit et al.

 

De Leeuw,]. (1977) Applications of convex analysis to multidimensional scaling. In:
Barra,J.R. et al. (ed.) Recent Developments in Statistics. North—Holland,
Amsterdam, The Netherlands, pp. 1337145.

Dixon,J.R. et al. (2012) Topologoical domains in mammalian genomes identiﬁed by
analysis of chromatin interactions. Nature, 485, 3767380.

Duan,Z. et al. (2010) A three—dimensional model of the yeast genome. Nature, 465,
3637367.

Fraser,J. et al. (2009) Chromatin conformation signatures of cellular differentiation.
Genome Biol, 10, R37.

Kruskal,J.B. (1964) Nonmetric multidimensional scaling: a numerical method.
Psychometrika, 29, 1157129.

Lieberman—Aiden,E. et al. (2009) Comprehensive mapping of long—range inter—
actions reveals folding principles of the human genome. Science, 326, 28%293.

Mateos—Langerak,J. et al. (2009) Spatially conﬁned folding of chromatin in the
interphase nucleus. Proc. Natl Acad. Sci. USA, 106, 381273817.
Shavit,Y. and Lio’,P. (2014) Combining a wavelet change point and the Bayes factor
for analysing chromosomal interaction data. Mol BioSvst., 10, 157(r1585.
Tanizawa,H. et al. (2010) Mapping of long—range associations throughout the ﬁs—
sion yeast genome reveals global genome organization linked to transcriptional
regulation. Nucleic Acids Res., 38, 81648177.

Trieu,T. and Cheng,J. (2014) Dirge—scale reconstruction of 3D structures of human
chromosomes from chromosomal contact data. Nucleic Acids Res., 42, e52.

 

3122

/810'sleum0fp103x0"53112131031110qu:duq

