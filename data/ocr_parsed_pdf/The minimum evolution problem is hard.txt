Bioinformatics, 32(4), 2016, 518—522

doi: 10.1093/bioinformatics/btv623

Advance Access Publication Date: 24 October 2015
Original Paper

 

Phylogenetics

The minimum evolution problem is hard:
a link between tree inference and graph
clustering problems

Sarah Bastkowski1, Vincent Moultonz, Andreas Spillner3 and
Taoyang Wu2'*

1The Genome Analysis Centre, Norwich, UK, 2School of Computing Sciences, University of East Anglia, Norwich,
UK and 3Department of Mathematics and Computer Science, University of Greifswald, Greifswald, Germany

*To whom correspondence should be addressed.
Associate Editor: David Posada

Received on September 1, 2015; revised on October 19, 2015; accepted on October 20, 2015

Abstract

Motivation: Distance methods are well suited for constructing massive phylogenetic trees.
However, the computational complexity for thetsky and Nei’s minimum evolution (ME) approach,
one of the earliest methods for constructing a phylogenetic tree from a distance matrix, remains
open.

Results: We show that thetsky and Nei’s ME problem is NP—complete, and so probably computa—
tionally intractable. We do this by linking the ME problem to a graph clustering problem called the
quasi—clique decomposition problem, which has recently also been shown to be NP—complete. We
also discuss how this link could potentially open up some useful new connections between phylo—

 

genetics and graph clustering.
Contact: taoyang.wu@uea.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

One of the earliest distance-based approaches introduced to con-
struct a phylogenetic tree is the minimum evolution (ME) method.
It was first suggested by Kidd and Sgaramella—Zonta (1971) and
consists of two main steps: First branch lengths are assigned to
tree topologies based on a distance matrix, and then a topology is se-
lected which minimizes the sum of the branch lengths. There are sev-
eral variants of this approach which are reviewed in e.g. Catanzaro
(2009) and Desper and Gascuel (2005). Although model-based tree
construction methods, such as likelihood and Bayesian approaches,
are tending to supersede distance-based methods in the literature,
ME methods still remain popular. This is in part due to the fact that
large-scale sequencing applications such as metagenomics involve
constructing massive trees for which distance-based methods are
well suited (see e.g. Filipski et (11., 2015).

In this article, we are interested in the ME approach introduced by
thetsky and Nei (1993). This is based on ordinary least squares

(OLS) estimates of branch lengths, served as a motivation for the
neighbor-joining method (Saitou and Nei, 1987), and is implemented
by Desper and Gascuel (2002) in the popular FastME software. It is
commonly believed that, just as the optimization problems arising
from the parsimony (Day, 1987) and the likelihood (Addario—Berry
et (11., 2004) approaches, this version of the ME method also leads to
an NP-complete problem and, so, is probably computationally in-
tractable. However, even though this has been stated to be the case in
some of the literature (probably because tree construction based solely
on OLS for integer branch lengths is NP-complete—Day, 1987), to
our best knowledge this fact has not been formally proven. It should
also be noted, however, that the closely related and more recently
introduced balanced ME (BME) problem (Desper and Gascuel,
2002)—in which branch lengths are estimated by a special case of
weighted least squares (Desper and Gascuel, 2004) has been shown
to be NP-complete (Fiorini and Joret, 2012).

 

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 518

/310‘srcumo[p10}xo‘soucuHOJIItotq/ﬁdnq

ME problem is hard

519

 

Here, we shall show that the ME problem is NP—complete for trees
with integer branch lengths. In particular, to prove our main result, we
show that the ME problem is closely related to the so—called quasi-
clique decomposition problem, a special example of a graph clustering
problem (see, e.g. Pattillo et al., 2013) which has recently been shown
to be NP—complete by Kaya et al. (2013). We believe that the link that
we describe could open up some interesting and useful new connections
between the fields of phylogenetics and graph clustering (Schaeffer,
2007), a burgeoning area with several applications including pedigree
construction (Kirkpatrick et al., 2011) and community structure detec—
tion (Brunato et al., 2008).

The rest of the article is organized as follows. In the next section,
we show that certain OLS weightings for trees relative to a distance
matrix are related to clique properties in a graph that can be associ—
ated to the distance matrix. In the following section, we then show
that a rooted version of the ME problem is NP—complete, and ex—
plain how a technique used in Day (1987) can be used to show that
the ME problem is NP—complete (we provide the full proof for this
in the Supplementary appendix as it is quite technical in nature). In
the last section, we discuss a link between phylogenetics and graph
clustering which arises from our approach to the ME problem, and
some possible future directions.

2 Lz-weightings

In this section, we shall show that OLS tree weightings for a certain
distance matrix associated to a graph G can be related to a clique
property of G.

We first recall some definitions concerning trees. For a set X of
taxa, a rooted X-tree T : (V. E) is a graph—theoretical tree with (i)
leaf set X, (ii) no vertices of degree two and (iii) a specific vertex ,0
which is called the root of T and will not be regarded as part of the
leaf set. Given a rooted X—tree T : (V. E), we let S T be the partial
order on V induced by T, that is, u S Tu, or u is below u, if and only
if u is contained in the path from the root ,0 to u. If in addition, we
have u 9E u, we write u < Tu and say that u is strictly helow u. The
lowest common ancestor of two vertices u and u, denoted by
LCA(U. V), is defined as the lowest vertex in T such that both u and u
are below it. Moreover, for each vertex u in T,
C(u) : {x E X 2 x 3 Tu} denotes the set of leaves below u. Finally,
a rooted X—tree with a particularly simple structure is the star X-tree
8x whose vertex set consists of the root ,0 and leaf set X.

A weighting of a rooted X—tree T is a map a) that assigns every
edge of T a non—negative real number. Given such a weighting,
Dm(u.u) denotes the length of the shortest path in T between any
two vertices u and u. Moreover, such a weighting is called an inte-
ger equi-weighting on T if a) 2 E —> 220 2: {0.1.2.  .} and
DH (x. p) : D,,,(y. p) for all x.y E X. Given a distance matrix D on a
set of taxa X and a rooted X—tree T, an Lz-weighting a) for (T. D) is
an integer equi—weighting on T such that

A(T;Dm.D) ;: A(Dm.D) ;: ((1)., — Dug;
: Z lDfH(x7y)_D(x7y)l2

{MEX

is minimum over all integer equi—weightings on T. In this case, we
shall say that (T. w) is an Lz—representation of D.

Now, for a graph G : (X. E) with vertex set X, let DG be the
distance matrix on X such that for a pair of distinct elements x and
y in X, we have DG(x.y) : 2 if x, y are adjacent in G, and
DG(x.y) : 4 otherwise. The edge density of G, denoted by y(G), is

X
defined as  2 > and G is called a semi-clique if y(G) 2 1/2. In

the following we will also refer to subsets X’ E X as semi-cliques in
G if the subgraph of G induced by X’ is a semi—clique. We now pro—
vide a key relationship between the edge density of G and L2—
representations of DC.

LEMMA 2.1: Suppose that G is a graph with vertex set X, (X) 2 2,
and 8x is the star X—tree. Let co) (i : 1, 2) be the weighting that as—
signs to each edge of 8x weight i. Then the following assertions

hold:

i. Ify(G) > 1/2, then col is the unique Lz-weighting for (8x. DG).

ii. Ify(G) < 1/2, then a); is the unique Lz-weighting for (8x. Dc).

iii. If y(G) : 1/2, then the Lz-weightings for (8x. Dc) are (01
and an.

PROOF: For simplicity, put D 2: Dc; and let a); (i E 220) be a
weighting function that assigns weight / to each edge in 8x. Noting
that each leaf is incident to the root, we know that an Lz—weighting
for (8x. D) must equal a); for some i in 220 because an Lz—weight—
ing is necessarily an integer equi—weighting. Because D(x. y) E {2. 4}
for x 9E 31 in X, a straightforward calculation leads to

min{A(Dm1 . D). A(Dm,.D)} < A(Dm/.D)

for/ E 220 — {1. 2}. In other words, an Lz—weighting for (8x. D) is
either all or wz.

Let n and m be the number of vertices and edges in G, respect—
ively. Then we have

A(D,,,1.D) — A(D,,,,.D) : 2[n(n — 1) — 4m]. (1)

If y(G) > 1/2, then we have 2m/(n(n — 1)) > 1/2, and hence
4m > n(n — 1). Together with Equation (1), this implies
A(Dm,.D) < A(D,L.,.D), and hence all is the unique Lz—weighting
for (8x.D). This completes the proof of part (i); parts (ii) and (iii)
follow by similar arguments. El

For G as above, we now summarize how the property of being a
semi—clique is related to Lz—representations of DC.

LEMMA 2.2: Suppose that G is a graph with vertex set X, (X) 2 2,
and T is a rooted X—tree with root ,0. Let a) be an Lz—weighting
for (T.DG), then Dm(x.y) 2 2 for all x.y E X. x 9E 31. In addition, if
p : LCA(Y.z) for some y.z E X, then we have D,,,(x.p) £2 for all
x E X, where equality holds if G is not a semi—clique.

PROOF: For simplicity, put D 2: DC and for a vertex u 9E ,0, let
p(u) be the parent of u, that is, the vertex on the path from u to p in
T that is adjacent to u. Since a) is an Lz—weighting, we know that for
every pair of elements x.y E X, we have D,,,(u.x) : D,,,(u.y) for
every common ancestor u of x and y. In particular, we have
Dm(LCA(X.Y).X) : Dm(LCA(X. Y). Y) : D,,,(x.Y)/2. Moreover, there
exists some integer k 2 0 such that Dm(p. x) : k for all x E X.

Note that we have k 2 1 because otherwise we have Dm(x.y)
: 0 for all x.y E X, and hence A(T;D,L.1.D) < A(T;D,L..D), where
all is the integer equi—weighting on T that assigns to each pendant
edge of T weight 1, and 0 to all other edges.

First, we shall show that Dm (x. y) 2 2 for all x. y E X. If not, then
consider a pair x1.x2 E X with D,,,(x1.x2) < 2. Let u : LCA(X1.X2).
Then by noting that D,,,(u.x1) : Dm(x1.x2)/2 < 1 we have
Dm(u.x1) : 0 and hence Dm (u. p) : k. Let u be the common ancestor
of x1 and x2 such that Dm(u.p) : k and w({p(u).u}) > 0. Let of be
the weighting function obtained from w by setting of (e) : w(e) — 1 for

ﬁle'spzumol‘pmJXO'sopcuuopuotq/ﬁdnq

520

S. Bastkowski et al.

 

e : {p(u).u}. w’(e) : 1 for e : {p(x’).x’} with x’ E C(u), and w’(e)
: w(e) otherwise. Then of is an integer equi—weighting with

A<T;D..,D) — Mam/.D) = mm) — (Draw) — 2f > 0,
lX-y}§C(v)-x#y

contradicting that a) is an Lz—weighting for (T. D).

Now assume that p : LCA(X1.X2) for some x1.x2 E X. It remains
to show that k S 2, that is, Dm(x.p) S 2 for all x E X. If not,
then we have [623. Let {u1.  .u,} be the set of vertices in T
such that D.,,(p.p(ui)) : 0 and Dm(p.ui) > 0 for 1 gig t.
Then {C(ul). . . . .C(u,)} is a partition of X. Let of be the integer equi—
Weighting obtained from w by setting w’(e) : w(e) — 1 for e{p(u,~). u,-}
with 1 3 i3 t, and w’ (e) : w(e) otherwise.

Then for x E C(ui) and x’ E C(u,) with i : i, we have

D(x.x’) g 4 3 2k — 2 : Dm(x.x’) — 2 : Dm:(x.x’)
and hence

(Dm(x.x’) — D(x.x’))2 — (Bdrm) _ n(x.x«))2
I (Dmx’) + 2 — D<x.x’>>2 — (Bdrm) — D(x.x’))2
= 4(Dm(x7x’) - D(x.x’) + 1) 2 4.

Therefore, in view of t 2 2, we have

A(T;DmD) - A(T;DmD) 24 (C(14)) X (CW/)1 > 0.

15145:

contradicting that a) is an Lz—weighting for (T. D).

Finally, when G is not a semi—clique, a proof similar to that of
Lemma 2.1 shows [6:2, and hence completes the proof of the
lemma. D

3 ME is NP-complete

In the last section, we saw how Lz—weightings were related to semi—
cliques. We now use this information to relate semi—clique decompos—
itions of graphs to the ME problem, which will also allow us to show
that this latter problem is NP—complete.

We begin by presenting a problem that is closely related to the
ME—problem. Given a distance matrix D on X, a rooted X—tree T
and an Lz—weighting a) for (T. D), we let w(T) denote the sum of
the edge—weights of T.

Problem Ultra—metric ME (UME(D, m))

Instance: A distance matrix D on a ﬁnite set X and an integer m.

Question: Does there exist an Lz—representation (T. w) of D such
that w(T) g m?

Now, let G be a graph with vertex set X. We call a partition P of
X a semi-clique decomposition of G if every set in P is a semi—clique
in G. We now relate this concept to the problem of finding a solu—
tion to the UME problem.

Proposition 3.1: Let G be a graph with vertex set X and k 2 1 an
integer. Then there exists a semi—clique decomposition of G with
size at most k if and only if there exists an Lz—representation (T. c0)
of DO with w(T) g (X) + 16.

Proof: Put D 2: DC and n :  In addition, let a), (i E 220) be
the weighting function that assigns weight / to each edge in a rooted
X—tree. To simplify the proof it will be convenient to allow vertices
of degree two in a rooted X—tree.

“:>” Let {X1.X2. . . . .Xk} be a semi—clique decomposition of G
whose size is minimum over all semi—clique decompositions of G.
If k : 1, then consider the star tree 8x. Since G is a semi—clique, by
Lemma 2.1 we know that all is an Lz—weighting for (SX.D) and,
clearly, (01(8X) : n, as required.

S0, assume k > 1. Then G is not a semi—clique. For each 1 S i S k,
let Ti 2: 8;) be the X,—tree obtained from 8x, by adding a new node
adjacent to the root of 8x), and designating this new node as the
root of 832). Note that, if (X) : 1, then 8x, contains one edge while
832) contains two edges. Considering the X—tree T obtained by iden—
tifying the roots of all Ti as the root of T, each tree Ti can be re—
garded as a subtree of T. Moreover, since w1(T) : (X) + k, it
suffices to show that (01 is an Lz—weighting for (T. D). To this end,
consider an arbitrary Lz—weighting w for (T.D). Since G is not a
semi—clique and k > 1 implies that p is the lowest common ancestor
of a pair of elements of X, by Lemma 2.2 we have D.,,(p.x) : 2 for
all x E X, as well as Dm(x.y) 2 2 for x : 3!. Therefore, to establish
that all is an Lz—weighting for (T.D), it remains to show, for all i
with (X,-( 2 2, that w(e) : 1 for all edges e in T). Indeed, if this does
not hold for some i with (X,-( 2 2, then by D“. (x. p) : 2 and D“. (x. y)
2 2 for x : y in X, we must have w(e) : 2 for all pendant edges e in
Ti and w(e) : 0 for all other edges. Let of be the weighting function
on the edges of T defined as w’(e) : 1 for edges e in Ti and w’(e)
: w(e) otherwise. Since X, is a semi—clique in C, an argument simi—
lar to the one used in the proof of Lemma 2.1 either yields A(D.,, . D)
< A(Dm. D). contradicting that w is an Lz—weighting, or
A(D.,.:. D) : A(Dm. D), as required.

“:” Let k be the minimum positive number such that there
exists a rooted X—tree T : (V. E) and an Lz—weighting a) for (T. D)
with w(T) S (X) +k. Without loss of generality, we may assume
that k < (X) (as otherwise the conclusion clearly holds) and that the
root ,0 of T is the lowest common ancestor of two elements in X (as
the single edge incident to a root of degree one can always be con—
tracted without changing the distance Dm(x.y) for any x. y E X). In
addition, we may assume that w(e) > 0 for all edges e E E (indeed,
by Lemma 2.2 we can assume w(e) > 0 for all pendant edges e of T
and an interior edge with weight 0 can simply be contracted) and
may further assume that w : (01 (as an edge with weight m > 1 can
be replaced by m edges with weight 1).

Now, if k : 1 it follows immediately from the assumptions above
that T : 8x and, therefore, in view of Lemma 2.1 we can conclude
that G is a semi—clique, as required.

S0 assume 1 < k <  Then we can further assume that G is
not a semi—clique, as otherwise the result clearly holds. Therefore,
by Lemma 2.2, we have D.,,,(x.p) : 2 for some (and hence all)
x E X. This implies that, besides (X) pendant edges, T contains k
edges {e1. .. . .ek} that are adjacent to ,0.

For 1 S i S k, let X, be the set of elements x in X such that the
path between ,0 and x contains e, and let E, be the set of pendant
edges incident to e,. It remains to show that, for 1 3 i3 k, X, is a
semi—clique in G. Indeed, if this were not the case for some i,
then clearly (X) 2 2. Let of be the weighting function obtained from
(01 by setting w’(e) : 0 for e:e,, w’(e) : 2 for e E E), and w’(e)
: (01 (e) otherwise. Since X, is not a semi—clique, an argument simi—
lar to the proof of Lemma 2.1 leads to the contradiction
Amp. D) < A(Dm,.D). [1

By the main result of Kaya et al. (2013) it follows that the fol—
lowing problem is NP—complete.

Problem Semi—clique decomposition (SCD(G, k))
Instance: A graph G with ﬁnite vertex set X and an integer k.

ﬁle'spzumol‘pmJXO'sopcuuoptrorq/ﬁdnq

Day (1987)

Supplementary appendix

Joret, 2012

Fiorini and

Schrijver,

1986

Guo et al., 2011 Pattillo et al., 2013
Kaya et Ill. (2013)

Fig. 1

Day, 1987 Farach et al., 1995

Bansal et al., 2004

(En!

/310'S[BHm0prOJXO"SOIJBIIIJOJIIIOIqﬂZdnq

522

S. Bastkowski et al.

 

e : {u. u} of X that violate P, that is, either e is an edge of G but u and
u do not lie in the same cluster in P or e is not an edge of G but u and it
both lie in the same cluster of P. For the partition P : {C1. C2. C3} of
the graph G in Figure 1b, for example, this cluster scoring function
yields a score of 4. It is not hard to check that the LI—fit of the tree in
Figure 1a for the distance matrix DG derived from the graph G is 4
too. Note that minimizing the cluster scoring function corresponding
to the LI—fit is equivalent to computing the minimum number of edge
deletions and insertions that suffice to transform G into a disjoint
union of complete graphs. When adopting this latter view, correlation
clustering is usually referred to as cluster editing (see, e.g. Bécker et al.,
2011).

It would be interesting to explore which tree inference problems
are related in a similar way to other graph clustering problems, and
conversely. This could yield useful new insights into these inference
problems, and possibly new algorithms for their solution or
approximation.

Acknowledgements

We thank the three anonymous referees for their helpful and constructive

comments on a previous version of this article.

Conﬂict of Interest: none declared.

References

Addario-Berry,L. et al. (2004) Ancestral maximum likelihood of evolutionary
trees is hard.]. Bioinfo. Comput. Biol.,2, 257—271.

Bansal,N. et al. (2004) Correlation clustering. Mach. Learn., 56, 89—113.

BOcker,S. et al. (2011) Exact algorithms for cluster editing: evaluation and ex-
periments. Algorithmica, 60, 316—334.

Brunato,M. et al. (2008) On effectively ﬁnding maximal quasi-cliques in
graphs. Lect. Notes Comput. Sci., 5313, 41—55.

Catanzar0,D. (2009) The minimum evolution problem: overview and classiﬁ-
cation. Networlzs, 53, 112—125.

Day,W. (1987) Computational complexity of inferring phylogenies from dis-
similarity matrices. Bull. Math. Biol., 49, 461—467.

Desper,R. and Gascuel,O. (2002) Fast and accurate phylogeny reconstruction
algorithms based on the minimum-evolution principle. Comput. Biol., 19,
687—705.

Desper,R. and Gascuel,O. (2004) Theoretical foundation of the balanced min-
imum evolution method of phylogenetic inference and its relationship to
weighted least-squares tree ﬁttings. Mol. Biol. Evol, 21, 587—598.

Desper,R. and Gascuel,O. (2005) The minimum-evolution distance-based ap-
proach to phylogenetic inference. In: Gascuel, 0. (ed.) Mathematics of
Evolution and Phylogeney. Oxford University Press, Cambridge, MA, pp.
1—32.

Farach,M. et al. (1995) A robust model for ﬁnding optimal evolutionary trees.
Algorithmica, 13, 155—179.

Filipski,A. et al. (2015) Phylogenetic placement of metagenomic reads using
the minimum evolution principle. BMC Genomics, 16, $13.

Fiorini,S., and Joret,G. (2012) Approximating the balanced minimum evolu-
tion problem. Oper. Res. Lett., 40, 31—35.

Guo,]. et al. (2011) Editing graphs into disjoint unions of dense clusters.
Algorithmica, 61, 949—970.

Kaya,O. et al. (2013) On the minimum edge cover and vertex partition by
quasi-cliques problems. HAL Res. Rep, RR—8255.

Kidd,K., and Sgaramella-Zonta,L. (1971) Phylogenetic analysis: concepts and
methods. Am. ]. Genet., 23, 235—252.

Kirkpatrick,B. et al. (2011) Pedigree reconstruction using identity by descent.
]. Comput. Biol., 18,1481—1493.

Pattillo,]. et al. (2013) On the maximum quasi-clique problem. Disc. Appl.
Math., 161, 244—25 7.

thetsky,A., and Nei,M. (1993) Theoretical foundation of the minimum-evo-
lution method of phylogenetic inference. Mol. Biol. Evol, 10, 1073—1095.

Saitou,N., and Nei,M. (1987) The neighbor-joining method: a new method
for reconstructing phylogenetictrees. Mol. Biol. Evol, 4, 406—425.

Schaeffer,S. (2007) Survey: graph clustering. Comput. Sci. Rev., 1, 27—64.

Schrijver,A. (1986) Theory of Linear and Integer Programming. Wiley,
New York.

ﬁle'spzumol‘pmJXO'sopcuuopuorq/ﬁdnq

