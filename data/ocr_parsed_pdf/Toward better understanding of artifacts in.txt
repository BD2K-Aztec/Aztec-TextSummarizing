BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

H.Li

 

Table 1. Evaluated mappers and variant callers

 

 

Symbol Algorithm Version Command line

bt2 Bowtie2 2.1.0 bowtie2 -x reffa -1 read] fq -2 read2.fq -X 500

bwa BWA-backtrack 0.7.6 bwa aln -f read] Jai ref.fa read] fq; bwa sampe reffa read] .3ai read2.sai read] .fq read2.fq

mem BWA-MEM 0.7.6 bwa mem reffa read] fq read2fq

fb FreeBayes 0.9.9 freebayes -f ref.fa aln.bam

st SAMtools 0.1.19 samtools mpileup -Euf reffa aln.bam 7 bcftools view -v -

Ug UniﬁedGenotyper 2.7-4 java -jar GenomeAnalysisTK.jar -T UniﬁedGenotyper -R reffa -I aln.bam -stand_call_conf 30
-stand_emit_conf 10 -glm BOTH

hc HaplotypeCaller 2.7-4 java -jar GenomeAnalysisTK.jar -T HaplotypeCaller igenotyping_mode DISCOVERY -R ref. fa
-I aln.bam -stand_call_conf 30 -stand_emit_conf 10

pt Platypus 0.5.2 Platypus.py callVariants iﬁlterDuplicates = l ibamFiles = aln.bam irefFile = ref. fa

 

the same individual (Nickles et al., 2012), including cancer sam—
ples (Lower et al., 2012). Because we expect to see only tens to
hundreds of somatic mutations or Mendelian errors per genome
(Conrad et al., 2011), most other inconsistencies are likely to be
errors. However, this method is insensitive to systematic errors.
If at a locus, a caller ﬁnds erroneous heterozygotes in all samples,
the errors would not be identified.

After these efforts, we are still not clear about a basic question:
the error rate of SNP and INDEL calling. Although a few papers
give an estimate of one error per 10(L200 kb, it is either estimated
on easy sites (Bentley et al., 2008) or not sufﬁciently backed with
published data (Nickles et al., 2012). In addition, only a few
works (Kim and Speed, 2013; Larson et al., 2012; Roberts
et al., 2013) have attempted to identify the sources of errors.
Analyzing systematic errors is even rarer, as most existing evalu—
ation methods hide them.

In this article, we use an exceptional dataset, sequencing data
from a haploid human cell line, to evaluate the accuracy of vari—
ant calling. As the vast majority of heterozygous calls are sup—
posed to be errors, we almost know the ground truth unbiasedly
across the whole genome. We are able to pinpoint errors, inves—
tigate their characteristics, experiment ﬁlters and get a reasonable
estimate of the error rate, not limited to non—systematic errors.
In addition to the unique dataset, our study also differs from
many previous ones in the use of multiple read mappers, unpub—
lished but well developed variant callers and caller—oblivious
genotyping and filtering.

2 DATASETS AND DATA ANALYSIS
2.1 Datasets

In this study, we focused on deep Illumina sequencing data from
two cell lines, the CHMlhTERT cell line (Jacobs et al., 1980)
and the NA12878 cell line. A crucial and unusual feature of
CHMlhTERT, or brieﬂy CHMl, is that this cell line is haploid,
which suggests that any heterozygous variant calls are errors.
A calling method producing fewer heterozygotes is in theory
better. Meanwhile, to avoid overrating a variant calling
method with low sensitivity on heterozygotes, we also used
NA12878 as a positive control.

Both data sets are available from Sequence Read Archive
(SRA). The entire CHMl dataset (AC2SRP017546) gives over

100—fold coverage. We are only using six SRA runs with the
accessions ranging from SRR642636 to SRR642641. The six
runs are from the same library, yielding ~65—fold coverage
before the removal of potential duplicates caused by polymerase
chain reaction (PCR) during sample preparation.

We acquired the NA12878 dataset (AC:ERR194147) from the
Illumina Platinum Genomes project. The library was constructed
without PCR ampliﬁcation. We are only using paired—end data,
which yield about 55—fold coverage.

2.2 Alignment and post-alignment processing

We mapped the CHMl reads with Bowtie2 (Langmead and
Salzberg, 2012) and BWA—MEM (Li, 2013), and mapped the
NA12878 reads with BWA (Li and Durbin, 2009) in addition
to Bowtie2 and BWA—MEM. The detailed command lines can be
found in Table 1. Except in Section 3.6, we mapped the reads to
hs37d5, the reference genome used by the 1000 Genomes Project
in the final phase.

After the initial alignment, we run Picard’s MarkDuplicates
on both datasets. Picard identiﬁed 20% of CHMl reads as PCR
duplicates. For NA12878, Picard reported 1.5% of them
as PCR duplicates, which are false positives, as the library was
constructed without ampliﬁcation. We did not apply
MarkDuplicates for NA12878 in the subsequent analysis.

For the NA12878 BWA alignment, we also tried GATK’s
(Depristo et al., 2011) base quality score recalibration (BQSR)
and INDEL realignment around INDEL calls from the 1000
Genomes Project (1000 Genomes Project Consortium, 2012).
For both SAMtools (Li, 2011b) and GATK, the number of
calls only differs by 0.1%, much smaller than the difference
caused by other procedures. We thus did not apply these steps
to other alignments because of the additional computational
cost. It should be noted that although BQSR and INDEL re—
alignment have little effect on these two high—coverage datasets,
it may make difference on low—coverage data or when the base
quality is not well calibrated.

2.3 Calling SNPs and short INDELs

We called SNPs and short INDELs with FreeBayes (Garrison
and Marth, 2012), GATK UnifiedGenotyper, Platypus,
SAMtools and GATK HaplotypeCaller. The command lines
can be found in Table 1. Additional details are as follows.

 

2844

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

Artifacts in variant calling

 

2.3.] Resolving overlapping variants Platypus and SAMtools
may produce many overlapping variants. To avoid overcounting
variants, for two overlapping variants, we always keep the one
with the higher variant quality. We repeated this procedure until
no overlapping variants remained.

2.3.2 Recalling genotypes Given the same genotype likelihood,
different callers may produce different genotypes. For example,
SAMtools estimates genotypes assuming the prior of seeing a
heterozygote being 103, but GATK does not apply a prior.
GATK is more likely to call a heterozygote than SAMtools.
Genotype calling for a single sample is relatively simple. To
avoid the subtle difference in this simple step complicating the
ﬁnal results, we recall the genotypes from genotype likelihoods
provided by the callers. We multiplied 10’3 to the likelihood of
heterozygotes, and then called the genotype with the maximum
likelihood.

Platypus does not give genotype likelihoods for multi—allelic
variants. We kept the reported genotypes in the variant call
format (VCF).

2.3.3 Decomposing complex variants Both FreeBayes and
Platypus may report a variant composed of multiple SNPs
and/or INDELs. We decomposed such variants into individual
events such that the results are more comparable. FreeBayes uses
a concise idiosyncratic gapped alignment report notations
(CIGAR) string to describe how a complex variant is aligned
to the reference. We extracted SNPs and INDELs from the
CIGAR. Platypus does not report CIGAR. We assumed the
variant allele is always left aligned to the reference allele when
decomposing a complex variant.

2.4 Variant filtering

All the callers used in this study come with filtering programs or
a recommended set of ﬁlters. However, applying caller—speciﬁc
ﬁlters may complicate comparison and obscure artifacts. We
decided to choose several universal ﬁlters applicable to most
callers:

(1) Low—complexity (LC) ﬁlter: filtering variants overlapping
with low—complexity regions (LCRs) identiﬁed with the
mdust program (http://bit.ly/mdust—LC), which is a
stand—alone implementation of the DUST algorithm ﬁrst
used by BLAST. In GRCh37, 2.0% of A/C/G/T bases on
autosomes are identiﬁed to be LCRs.

(2) Maximum depth (MD) filter: filtering sites covered by
excessive number of reads. It should be noted that differ—
ent callers may define the depth differently. For example,
Platypus apparently only counts reads with unambiguous
realignment. The read depth reported in the Platypus VCF
is noticeably smaller in comparison with other callers.

(3) Allele balance (AB) filter: filtering sites where the fraction
of non—reference reads is too low.

(4) Double strand (DS) ﬁlter: ﬁltering variants if either the
number of non—reference reads on the forward strand or
on the reverse strand is below a certain threshold. This
ﬁlter is not applicable to GATK calls, as GATK does
not report these numbers. DS has been identiﬁed to be

an effective ﬁlter on cancer data (Kim and Speed, 2013;
Roberts et al., 2013).

(5) Fisher strand filter (FS): ﬁltering sites where the numbers
of reference/non—reference reads are highly correlated with
the strands of the reads. More precisely, we counted the
number of reference reads on the forward strand and on
the reverse strand, and the number of non—reference reads
on the forward and reverse strand. With these four num—
bers, we constructed a 2 x 2 contingency table and used
the P—value from a Fisher’s exact test to evaluate the
correlation.

(6) Quality ﬁlter (QU): filtering sites with the reported variant
quality below a threshold.

Among these filters, LC is a regional ﬁlter and is entirely in—
dependent of alignment and variant calling. Although MD is
computed from called variants, its effect is usually not greatly
dependent on the mapper and the caller, either. The remaining
ﬁlters may be dependent of the error models used by the callers.
For example, SAMtools effectively gives a higher weight to vari—
ants supported on both strand; FreeBayes seems to require a
variant to be supported by 20% of reads covering the site. The
optimal thresholds for the AB, DS and FS ﬁlters are caller
dependent.

2.5 Measuring accuracy

The CHMl and the NA12878 datasets share many properties.
They are both sequenced with 100 bp Illumina reads to a similar
coverage after the removal of PCR duplicates. The number of
called variants per haplotype is also close, usually within 1%
difference according to multiple call sets. Under this observation,
it is reasonable to assume the number of heterozygous errors in
NA12878 is also close to the number of heterozygous calls in
CHMl. As a result, we may take Nh/Nd as an estimate of the
false—positive rate (FPR) of heterozygotes, and Nd—Nh as a
proxy to sensitivity, where N), is the number of heterozygous
calls in CHMl and Nd the number in NA12878. This might be
the ﬁrst time that we can unbiasedly measure FPR in a whole
genome call set.

2.6 Manual review

To understand the major error modes, we have manually re—
viewed >200 heterozygous INDELs called by different callers
from CHMl. For these sites, we displayed the alignment with
SAMtools’ tview alignment viewer to get a sense of the alignment
quality, obvious positional biases and the complexity of the ref—
erence genome. We often extracted reads in regions around the
INDELs, extending to ﬂanking regions with high complexity to
eyes. We assembled the extracted reads with fermi (Li, 2012)
version 1.1 and mapped the assembled contigs back to the refer—
ence genome with BWA—MEM. Fermi tries to preserve hetero—
zygotes. If the INDELs are truly heterozygous, we will typically
see two contigs covering a site, one for each allele. We used the
local assembly as an orthogonal approach to validate heterozy—
gous calls.

 

2845

ﬁm'spzumol‘pmjxo'sopeuHOJmorq/ﬁdnq

55,2kgogmoddmmowoxwoa‘oﬁsambmﬁ

3N izla'ié'
_ heterozygous
NA1287a ‘ . LC SNPS

heterozygous i
nun-LC SNPs

NA12878
heterozygous
non-LC INDELs

NA12878
heterozygous
LC INDELS

 

/810'sleum0prOJxo'sopBLuJOJuioiq”:duq

ATTTGGGGGCTGGGACTGGGTCC GGACAGGGACTGGGGCCGGGA

ATTTGGGGGCTGGGACTGGGTCC GGACAGGGACTGGGGCCGGGACCGGGACC
CTGGGTCC GGACAGGGACTGGGGCCGGGACCGGGACC
TGGG CCGGGAC

ATTTGGGGGCTGGGACTGGGTCC GGACAGGGACTGGGGCCGGGA
CTGGGTCC GGACAGGGACTGGGGCCGGGA
TGGG CCGGGAC GGGACTGGGGCCGGGA

CCGGGACCGGGAC GGGACTGGGG CCGGGACCGGGACAGGGACCAGGAC
GGGAC

GGGACTGGGGCCGGGACCGGGAC GGGAC
GGGACTGGGGCCGGGACCGGGAC GGGAC 666 C 666 CCGGGACCGGGACAGGGACCAGGAC

CCGGGACCGGGAC
CCGGGACC GGGACTGGGG
CCGGGAC GGGAC 666 C 666

CCGGGACCGGGAC GGGAC
CCGGGACCGGGACAGGGACCAGGAC

/810'SIEumo_fp10jxo'soimmmjuioiq/ﬁduq

55,2kgogmoddmmowoxwoa‘oﬁsambmﬁ

 

7
3k
h2
C3
R1
G

H.Li

 

4 DISCUSSIONS AND CONCLUSIONS

A distinct feature of our work is the use of a haploid human
sample, CHMl, from which heterozygous calls are supposed to
be errors. This allows us to unbiasedly investigate the causal
artifacts and to experiment effective ﬁlters with the diploid
NA12878 dataset as a positive control.

When we called SNPs and INDELs from CHMl, we were
surprised to ﬁnd 10% of raw variant calls were heterozygotes.
Honestly, our immediate reaction was that CHMl was not truly
haploid. However, after carede analysis, we have convinced our—
selves that the heterozygosity of CHMl should be of an order of
magnitude lower than the raw error rate of variant calling. The
vast majority of heterozygotes are calling errors. In the raw call
set, we usually see an error per 1&15kb.

It was also to our surprise that the LC is the most effective
against false heterozygotes, especially short INDELs. Although
we knew that INDEL errors may be introduced by PCR during
sample preparation, we underestimated its substantial effect. We
were also unaware that realignment of INDELs in LCRs remains
a great challenge even after the many existing efforts in this dir—
ection (Albers et al., 2011; Homer and Nelson, 2010; Li, 2011a;
Narzisi et al., 2014). Without the suggestion from (P.Sudmant,
personal communication), we would not have tried this ﬁlter.

Before we understand and resolve the issues in variant calling
in LCRs, it might be better to ﬁlter out all variants overlapping
these regions. Although >50% of single—sample INDEL calls fall
in LCRs (Figs 1 and 3), only 1.25% of autosomal INDELs in the
ClinVar database (http://clinvar.com) overlap with LCRsvmost
INDELs in LCRs have unknown clinical functionality. For cer—
tain applications, it might be safe to drop or downweigh these
difﬁcult calls.

Outside LCRs, different call sets usually agree well with
each other if the same set of ﬁlters is applied (Fig. 3). Based
on Figure 1, we estimate that a caller usually makes a wrong
call per 10(L200 kb without signiﬁcant compromise on the sen—
sitivity, similar to the previous estimates (Bentley et al., 2008;
Nickles et al., 2012). Many of these errors are likely to be sys—
tematic. In the context of somatic or de novo mutation discovery
by sample contrast, systematic errors will appear in all samples.
They will not lead to false mutation calls, fortunately.

A simple method to improve the variant accuracy is to use two
distinct pipelines, take the intersection of the raw calls and then
apply caller—oblivious ﬁlters to derive the final call set. As callers
agree well on post—ﬁltered sites (Fig. 3) but badly on false posi—
tives (Fig. 2), we should be able to remove most errors without
much hit to the sensitivity. Such a consensus approach has been
applied to cancer data with limited success (Goode et al., 2013;
Lower et al., 2012). Without subclonal mutations, it should be
much more effective on the variant discovery from normal
samples.

Finally, the advances in sequencing technologies lead to the
development of algorithms. We are heavily relying on mapping—
based variant calling because with short reads or at low coverage,
the traditional assembly—and—mapping approach would not
work. With increased read lengths and decreased sequencing
cost, we might go back to de novo assembly. An assembly does
not only encode small variants but also retains large—scale struc—
tural variations and is free of the artifacts in the reference

genome. Another possible direction which we mentioned
4 years ago (Li et al., 2010) is to map sequence reads to the
ensemble of multiple genomes. Recently, there has been signiﬁ—
cant progress toward this goal (Paten et al., 2014; Sirén et al.,
2010), but a practical solution is yet to be concluded.

ACKNOWLEDGEMENTS

The authors are grateful to Richard Wilson and his team who
sequenced the CHMl cell line and granted us the permission
to use the data in this study. The authors also thank the 1000
Genomes Project analysis group for the helpful comments and
discussions, and Mike Lin and the anonymous reviewers whose
comments have helped us to improve the manuscript.

Funding: NHGRI U54HG003037; NIH GM100233.

Conﬂict of Interest: none declared.

REFERENCES

1000 Genomes Project Consortium. (2012) An integrated map of genetic variation
from 1,092 human genomes. Nature, 491, 56—65.

Albers,C.A. et a]. (2011) Dindel: accurate indel calls from short—read data. Genome
Res, 21, 9617973.

Bamshad,M.J. et a]. (2011) Exome sequencing as a tool for Mendelian disease gene
discovery. Nat. Rev. Genet, 12, 7457755.

Bentley,D.R. et a]. (2008) Accurate whole human genome sequencing using revers—
ible terminator chemistry. Nature, 456, 53759.

Boland,J.F. et a]. (2013) The new sequencer on the block: comparison of Life
Technology’s Proton sequencer to an Illumina HiSeq for whole—exome sequen—
cing. Hum. Genet, 132, 115371163.

Campbell,C.D. and Eichler,E.E. (2013) Properties and rates of germline mutations
in humans. Trends Genet, 29, 5757584.

Cheng,A.Y. et a]. (2014) Assessing single nucleotide variant detection and genotype
calling on whole—genome sequenced individuals. Bioinformatics, 30, 170771713.

C1ark,M.J. et a]. (2011) Performance comparison of exome DNA sequencing tech—
nologies. Nat. Biotechnol, 29, 9087914.

Conrad,D.F. et a]. (2011) Variation in genome—wide mutation rates within and
between human families. Nat. Genet, 43, 7127714.

Depristo,M.A. et a]. (2011) A framework for variation discovery and genotyping
using next—generation DNA sequencing data. Nat. Genet, 43, 4917498.

Garrison,E. and Marth,G. (2012) Haplotype—based variant detection from short—
read sequencing. arXiv:1207.3907.

G00de,D.L. et a]. (2013) A simple consensus approach improves somatic mutation
prediction accuracy. Genome Med, 5, 90.

Gymrek,M. et a]. (2012) lobSTR: a short tandem repeat proﬁler for personal gen—
omes. Genome Res, 22, 11544162.

Harismendy,O. et a]. (2009) Evaluation of next generation sequencing platforms for
population targeted sequencing studies. Genome Biol, 10, R32.

Homer,N. and Nelson,S.F. (2010) Improved variant discovery through local
re—alignment of short—read next—generation sequencing data using SRMA.
Genome Biol, 11, R99.

Jacobs,P.A. et a]. (1980) Mechanism of origin of complete hydatidiform moles.
Nature, 286, 7147716.

Kim,S.Y. and Speed,T.P. (2013) Comparing somatic mutation—callers: beyond Venn
diagrams. BMC Bioinformatics, 14, 189.

Lam,H.Y.K. et al. (2012a) Detecting and annotating genetic variations using the
HugeSeq pipeline. Nat. Biotechnol, 30, 2267229.

Lam,H.Y. et al. (2012b) Performance comparison of whole—genome sequencing
platforms. Nat. Biotechnol, 30, 78782.

Langmead,B. and Salzberg,S.L. (2012) Fast gapped—read alignment with Bowtie 2.
Nat. Methods, 9, 3577359.

Larson,D.E. et a]. (2012) SomaticSniper: identiﬁcation of somatic point mutations
in whole genome sequencing data. Bioiiy’ormatics, 28, 3117317.

Levy,S. et a]. (2007) The diploid genome sequence of an individual human. PLoS
Biol., 5, e254.

 

2850

ﬁm'spzumol‘pmjxo'sopeuuowrorq/ﬁdnq

Artifacts in variant calling

 

Li,H. (2011a) Improving SNP discovery by base alignment quality. Bioiiy’ormatics,
27, 115771158.

Li,H. (2011b) A statistical framework for SNP calling, mutation discovery, associ—
ation mapping and population genetical parameter estimation from sequencing
data. Bioinformaties, 27, 298772993.

Li,H. (2012) Exploring single—sample SNP and INDEL calling with whole—genome
de novo assembly. Bioiiy’ormatics, 28, 183871844.

Li,H. (2013) Aligning sequence reads, clone sequences and assembly contigs with
BWA-MEM. arXiv:1303.3997.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with burrows—
wheeler transform. Bioiiy’ormatics, 25, 17544760.

Li,H. and Durbin,R. (2011) Inference of human population history from individual
whole—genome sequences. Nature, 475, 4934196.

Li,H. et a]. (2008) Mapping short DNA sequencing reads and calling variants using
mapping quality scores. Genome Res, 18, 185171858.

Li,H. et a]. (2010) A survey of sequence alignment algorithms for next—generation
sequencing. Brief Bioinform., 11, 4734183.

Li,S. et a]. (2013) SOAPindel: efﬁcient identiﬁcation of indels from short paired
reads. Genome Res, 23, 1957200.

Liu,X. et a]. (2013) Variant callers for next—generation sequencing data: a compari—
son study. PLoS One, 8, e75619.

L6wer,M. et a]. (2012) Conﬁdence—based somatic mutation evaluation and priori—
tization. PLoS Comput. Biol., 8, e1002714.

Nakamura,K. et a]. (2011) Sequence—speciﬁc error proﬁle of illumina sequencers.
Nucleic Acids Res, 39, e90.

Narzisi,G. et a]. (2014) Accurate detection of de novo and transmitted indels within
exome—capture data using micro—assembly. lyioinv.

Nickles,D. et a]. (2012) In depth comparison of an individual’s DNA and its lym—
phoblastoid cell line using whole genome sequencing. BMC Genomics, 13, 477.

O’Rawe,J. et a]. (2013) Low concordance of multiple variant—calling pipelines:
practical implications for exome and genome sequencing. Genome Med, 5, 28.

Paten,B. et a]. (2014) Mapping to a reference genome structure. arXiv:1404.5010.

Robasky,K. et a]. (2014) The role of replicates for error mitigation in next—
generation sequencing. Nat. Rev. Genet, 15, 5&62.

Roberts,N.D. et a]. (2013) A comparative analysis of algorithms for somatic SNV
detection in cancer. Bioiiy’ormatics, 29, 222372230.

SirenJ. et a]. (2010) Indexing ﬁnite language representation of population geno—
types. CoRR, abs/10102656.

Talwalkar,A. et a]. (2013) SMaSH: a benchmarking toolkit for human genome
variant calling. arXiv:1310.8420.

Veltman,J.A. and Brunner,H.G. (2012) De novo mutations in human genetic dis—
ease. Nat. Rev. Genet, 13, 5657575.

Wang]. et a]. (2008) The diploid genome sequence of an Asian individual. Nature,
456, 60$5.

Watson,I.R. et a]. (2013) Emerging patterns of somatic mutations in cancer. Nat.
Rev. Genet, 14, 7037718.

Zerbino,D.R. and Birney,E. (2008) Velvet: algorithms for de novo short read
assembly using de Bruijn graphs. Genome Res, 18, 8217829.

Zook,J.M. et a]. (2014) Integrating human sequence data sets provides a resource of
benchmark snp and indel genotype calls. Nat. Biotechnol, 32, 24(r251.

 

2851

ﬁm'spzumol‘pmjxo'sopeuuowrorq/ﬁdnq

