Vol. 28 18MB 2012, pages i207-i214
doi:10. 1 093/bioinformatics/bts226

 

Towards 3D structure prediction of large RNA molecules: an
integer programming framework to insert local 3D motifs in RNA

secondary structure

Vladimir Reinharzl, Fran ois Major2 and J r me Waldisp hi1’*

1School of Computer Science & McGill Centre for Bioinformatics, McGill University HSA 0E9 and 2School of
Computer Science & IRIC, Universit de Montr al, Montr al, Canada HSC 2J7

 

ABSTRACT

Motivation: The prediction of RNA 3D structures from its sequence
only is a milestone to RNA function analysis and prediction. In
recent years, many methods addressed this challenge, ranging from
cycle decomposition and fragment assembly to molecular dynamics
simulations. However, their predictions remain fragile and limited to
small RNAs. To expand the range and accuracy of these techniques,
we need to develop algorithms that will enable to use all the structural
information available. In particular, the energetic contribution of
secondary structure interactions is now well documented, but
the quantification of non-canonical interactions—those shaping
the tertiary structure—is poorly understood. Nonetheless, even
if a complete RNA tertiary structure energy model is currently
unavailable, we now have catalogues of local 3D structural motifs
including non-canonical base pairings. A practical objective is thus
to develop techniques enabling us to use this knowledge for robust
RNA tertiary structure predictors.

Results: In this work, we introduce RNA—MOIP, a program that
benefits from the progresses made over the last 30 years in
the field of RNA secondary structure prediction and expands
these methods to incorporate the novel local motif information
available in databases. Using an integer programming framework,
our method refines predicted secondary structures (i.e. removes
incorrect canonical base pairs) to accommodate the insertion of RNA
3D motifs (i.e. hairpins, internal loops and k-way junctions). Then,
we use predictions as templates to generate complete 3D structures
with the MC—Sym program. We benchmarked RNA—MOIP on a set
of 9 RNAs with sizes varying from 53 to 128 nucleotides. We show
that our approach (i) improves the accuracy of canonical base pair
predictions; (ii) identifies the best secondary structures in a pool of
suboptimal structures; and (iii) predicts accurate 3D structures of
large RNA molecules.

Availability: RNA—MOIP is publicly available at: http://
csb.cs.mcgill.ca/RNAMoIP.

Contact: jeromew@cs.mcgill.ca

1 INTRODUCTION

Ribonucleic acids perform a broad range of functions in cells.
Ribozymes such as the RNase P or the group II introns catalyze
chemical reactions, whereas microRNAs hybridize to messenger
RNA to regulate gene expression. To achieve these functions,
many RNAs fold into speciﬁc 3D structures that are directly

 

*To whom correspondence should be addressed.

encoded in their nucleotide sequence. The structural information is
therefore useful to predict the function. Nonetheless, experimental
determination of RNA structures remains time-consuming and
technically challenging. It follows that we need to develop fast and
reliable computational tools to help to predict them.

During the last few years, several groups have developed fully
automated RNA 3D structure prediction programs. To date, the most
popular ones are FARNA (Das and Baker, 2007), the MC — Pipel ine
(Parisien and Major, 2008), iFoldRNA (Sharma et al., 2008) and
NAST (Jonikas et al., 2009). A recent review by Laing and Schlick
(2010) proposes a comprehensive overview of these strategies.
Conditional random ﬁelds techniques implemented in BARNACLE
(Frellsen et al., 2009) and TreeFolder (Wang and Xu, 2011) also
appear as a promising approach.

However, unlike classical secondary structure predictors such
as RNAstructure (Reuter and Mathews, 2010), RNAfold
(Hofacker, 2009), unafold (Markham and Zuker, 2008),
contrafold (Do et al., 2006) or contextfold (Zakov et al.,
2011), the range of application of the RNA 3D structure predictors
is limited. Currently, their time requirement and/or their accuracy
restrict their application range to sequences with <50 nucleotides.
By contrast, secondary structure predictors are fast and reliable on
sequences with >100 nucleotides. MC—Fold (Parisien and Major,
2008) and RNAwol f (zu Siederdissen et (11., 2011) expanded these
techniques to predict extended secondary structures (i.e. including
non-canonical interactions), but these algorithms remain limited
to predict nested secondary structures without k-way junctions,
thus, precisely lacking the structural motifs shaping the RNA
3D structure.

Thus, ab-initio 3D structure prediction of large RNA molecules
(i.e. >50 nucleotides in our context) is still an open question. To
overcome this barrier, new models are required. Indeed, due to the
paucity of structural data available, the design of a complete model
accounting for all the subtle 3D structural variations observed in
experimentally determined structures is unlikely.

The methods developed in this article are based on a recent
idea suggesting that RNA 3D structures share common structural
subunits. The decomposition of RNA structures in elementary
blocks was ﬁrst introduced by Lemieux and Major (2002) who
proposed a description of RNA secondary structures (including
non-canonical interactions) based on cycles. More recently, the
analysis of experimental 3D structures revealed that similar 3D
motifs can be found in multiple unrelated structures. Here, we
deﬁne a motif as a group of nucleotides that adopt a speciﬁc 3D
shape and interaction pattern (including non-canonical interactions).
Several groups have developed computational methods to extract

 

© The Author(s) 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'sorJBuJJOJuroqu:duq 11101} papeolumoq

91oz ‘Og anﬁnv uo ::

V.Reinharz et al.

 

and classify RNA 3D motifs. The most popular databases are
FR3D (Sarver et (11., 2008), RNAmoti f (Djelloul and Denise, 2008)
and RNAj unction (Bindewald et (11., 2008). Importantly, these
databases identify 3D motifs involving three or more segments of
the same molecule deﬁned as k-way junctions (when the motif is
the branching point of several helical segments). Such motifs are
important because they are precisely those shaping the 3D structure
of an RNA molecule.

Despite the knowledge accumulated in these databases, the
integration of this information into current models remains
complicated. First, the classiﬁcation of RNA motifs can be
ambiguous (i.e. a motif and its submotifs can match different
database entries). Next, the structural compatibility between two or
more motifs can be difﬁcult to resolve (i.e. how to concatenate two
motifs). It is worth noting that a method to predict the topological
family of a given 3-way junction has been recently introduced by
Lamiable et (11. (2012).

Interestingly, to complement the secondary structure programs,
Martinez et (11. (2008) and Jossinet et (11. (2010) implemented semi-
automated methods (resp. RNA2D3D and assemble) for building
3D models from known/predicted secondary structure information.
These programs provide intuitive interfaces enabling their users to
insert 3D motifs and modify backbone angles of a coarse grained
input structure.

From this standpoint, the hierarchical approaches (i.e. RNA2D3D
and assemble) appear well suited to the prediction of large
RNA structures. Their advantage resides in their capacity to
beneﬁt from the high accuracy of classical secondary structure
predictors (i.e. thermodynamic or comparative models) to build a
scaffold of the structure, and then to leave to the user the task of
decorating the model with the various structural motifs found in
databases. Although this strategy is ﬂexible, it is time-consuming and
requires human participation. Recently, Cruz and Westhof (2011)
developed RMDetect, a method to predict G-bulge loops, kink-
turns, C-loops and tandem-GA loops in RNA secondary structures.
But the prediction of more complex motifs such as the k-way
junctions and the construction of 3D RNA structures remain open
problems.

In this article, we introduce RNA—MOIP, an integer programming
(IP) framework for inserting RNA 3D motifs inside known (or
predicted) RNA secondary structures. We use our predictions as a
template to generate putative RNA 3D structures using the MC—Sym
software, and show that we are able to predict accurate 3D structures
of large RNA sequences. Integer programming techniques have
gained a lot of interest recently as they provided state-of—the-art
methods for predicting RNA secondary structures with pseudo-
knots (Poolsap et (11., 2009; Sato et (11., 2011). One of their strengths
resides in their ﬂexibility and capacity to incorporate heterogeneous
constraints, a valuable advantage when it comes to incorporate
k-way junctions.

The article is organized as follows. In Section 2 we formally deﬁne
the motifs, describe our motif database, and introduce our IP model
RNA—MOI P. In Section 3, we apply RNA—MOIP on a set ofnine RNA
used by Laing and Schlick (2010) to benchmark RNA 3D structure
prediction programs. Our results show that RNA—MOI P (i) improves
the accuracy of canonical base pair predictions; (ii) identiﬁes the best
secondary structures in a pool of suboptimal structures generated by
RNAs ubopt; and (iii) predicts accurate 3D structures for sequences
with sizes varying between 53 and 128 nucleotides—an insight that

cannot be reached by other programs. Finally, in Section 4, we
discuss our results and propose future research directions.

2 METHODS

Let a) be a RNA sequence. First, we use a classical secondary structure
predictor (e.g. RNAsubopt) to generate a list of sub-optimal secondary
structures. Second, for each structure from the list we use RNA—MOIP
to insert RNA 3D motifs in the structure using the sequence information
provided by a). RNA—MOIP works in two steps:

(1) Given a database of sequences of RNA 3D motifs (cf. Section 2.2),
the preprocessing step applies a classical pattern matching algorithm
to ﬁnd all occurrences of each motif in the input sequence a).

(2) Given this list of potential insertion sites and a secondary structure,
we solve an IP problem which minimize our objective function
(cf. Section 2.3). Importantly, under certain conditions, RNA—MOIP
allows base pair removals to insert the 3D motifs.

Finally, we use the best solutions as templates for MC—Sym (Parisien and
Major, 2008) and generate 3D structures. In particular, we constrain MC—Sym
to use the motifs inserted by RNA—MOIP at their predicted location. As we
will see later, these constraints enable us to produce 3D structures, when an
unconstrained run would simply never end.

2.1 Deﬁnitions

Motif: We represent a motif x as an ordered list of components (i.e.
sequences) where  is the i-th nucleotide of the j-th component (i.e
sequence). As presented in Figure 1, hairpins have one component, bulges
and internal loops have two and k-way junctions have k. Let r be the number
of components, we represent a motif as x:=[(xf,---,xlil),---,(xj,---,x1:r)]
and  e {A, U, G, C, *} where >i< represents a wildcard. We also write a motif
x as M)‘ :=x} not]: —x% - - org—31 —xf - - or]; , i.e. the concatenations of its letters
with the added character ‘—’ between the components. We deﬁne |MX| as
the number of nucleotides in x.

Match: Given a sequence a) e {A, U ,G, C }+, and a motif x with r
components, we say that (U) is the i-th character of a), and that a motif
x match the sequence a) at (171,---,p,) if V151<rzpi+ki+55pi+1and

((11,’:,’,:,)):  amp/.4421 where the pi’s indicate the ﬁrst positions of the i-th
component of motif x in a). The inequality ensures that each component is
separated by at least ﬁve nucleotides.

2.2 RNA motifs database

Here we describe how we build the motifs database. First, we retrieve
888 experimentally determined RNA 3D structures from the Protein Data
Bank [Berman et (11., 2000; www.pdb.org]. Then, we use the program
RNA3Dmotifs from (Djelloul and Denise, 2008) to extract all the motifs
from these structures. This results in a dataset of 35 724 motifs for which
we have a 3D pdb ﬁle and a description of the interactions.

We processed these data to create a non-redundant database of curated
motifs. To ensure the compactness and coherency of the motifs, we assume
that each component is at least ﬁve nucleotides farther than the previous one;
otherwise the nucleotides are merged in a single component and the missing
positions are replaced by a wildcard ‘>i<’ (See Section 2.1). We describe a
motifm returned by RNA3Dmotifs as m:={(m1,p1),--- ,(mn,pn)}, where
mk e {A, U,G,C} and pk <pk+1 EN is the position of nucleotide mk in the
sequence it was extracted from. We create x such that if we set  =mk and
15pk+1—pk=a <5 then V1<1/<1+(¥Zx;/=>I< and 14+“ =mk+1.1fpk+1—
pk 35 then XII-H =mk+1.

Some motifs may have small components composed of one or two
nucleotides. In our framework, the insertion of these components will be
less constrained by the secondary structure and thus less speciﬁc. To avoid
this case, we extend all small components in all possible combinations with

 

i208

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJuroiqﬂ:duq 11101} papeolumoq

9103 ‘0g1sn8nv uo ::

Towards 3D structure prediction of large RNA molecules

 

 

 

 

 

 

 

 

 

 

 

 

Fig. 1. This is an example of motifs extracted by Rna3Dmotif [Djelloul
and Denise, 2008] from a given RNA. When our framework receives these
as input it deﬁnes the following. The hairpins form the group with one
component and we write: A :2 [(GGAAAC)], B :2 [(CGAAAG)]]. Interior
loops, and Bulges, have two components (e.g. C :2 [(GA U), (AG AU GC)]).
The n-way junctions naturally have n components. In this case there is a 3-
way junction which can be written in our framework in two ways: D:=
[(CGAA),(UGU AAC),(GG*)] or D :2 [(CGAA),(UGU AAC),(*GG)].
since we want components to be of size at least 3. D can also be written as
M0 :2 CGAA — UGU AAC —GG* (resp. CGAA — UGU AAC— *GG) and
we can say that D match this sequence at (6,35,47) but also, (6,35,48) and
many other positions. A motif can be inserted multiple times

the character >i< until they reach a size of three (e.g. the last component of
motifD in Figure 1).

It is worth noting that all these constraints are empirical rules which aim to
remove discrepancies and unify the sequence constraints applied on motifs.
They should not be considered as a rigid framework but rather as a tentative
to clarify the RNA3Dmotifs output.

Finally, we cluster together all pairs of motifs x,y if MXEMy (i.e. the
sequences are identical) to obtain a non-sequence-redundant database of 4708
motifs.

It is important to note that in our database, the motifs with one single
component are all hairpins and do not include bulges. In this article, bulges
will be seen as a particular case of interior loops since for the motif to loop,
it needs to include the complementary strand.

Finally, we excluded from this database the structures used in the
benchmark (see Section 3.2).

2.3 IP model

Here, we describe the IP equations used to insert the motifs into a given
secondary structure. To insert a motif into the structure, our model allows
some base pairs to be removed.

2.3.] Input: We introduce the notations and sets that will be used to model
our input data. Let a) be a RNA sequence, and S a secondary structure of a)
without pseudo-knots. We denote by n: lwl the length of a), and by 8 the

maximum percentage of base pairs that is allowed to be removed. We call B

the set of base pairs found in the secondary structure S. We denote by Motj

the set of motifs with j components that match a):
Motf={x|X;=[(x},... 39:1)...-  ,x§,f)] and (1)

El a match ofx in to}

We store in Seq]; the positions where the i-th component of the motifs of
order j can be inserted:
Seqi={(x.pi.pi+ki—1>IxeMotf and (2)
El amatch (pl,~-,pi_1,pi,pi+1,---,pj) ofx in to}

We note that the criteria used to determine whether a motif can be inserted
is based on the sequence only. At this stage, the secondary structure S is not
used.

2.3.2 Variables: We now describe the two variables used in our model.
Our program will make two predictions: ﬁrst, it ﬁnds the location of the
insertion sites of the motifs, and second, it predicts which base pairs are
removed. We denote  as the boolean variable indicating the insertion of
the j-th component of the motif x between positions k and l in a). Similarly, we
use the boolean variable Du” to indicate if the base pair (11, v) EB is removed
or not (i.e. Dugv = 1 if (11,v) is removed from the secondary structure S and
0 otherwise).

2.3.3 Objective ﬁtnction: We describe here the optimization criteria that
will be used to predict the insertion of the RNA motifs. As mentioned earlier,
we do not have any estimate of the energy of the motifs retrieved with
RNA3Dmotifs. Instead, we will use a principle of minimum entropy. We
assume that a molecule folds in a conﬁguration that stabilizes its backbone
and side chains through various base pairings. In other words, we aim to
minimize the free variables of the molecule. In the absence of reliable
energy values, we assign to the motifs a weight equivalent to the square
of the number of nucleotides in its components. This objective function
aims to increase the coherency of the motif insertions as it maximizes
the nucleotide positions coverage and favours the insertion of large motifs
instead multiple small ones. It also ease the 3D reconstruction process with
MC—Sym. Although this objective function is purely heuristic, it performed
well in this work. We give a penalty of 10 for every base pair deleted (other
values have been tried with similar results, data not shown). Formally, we
aim to minimize the following function:

(IMXI)?

10* 2 DW— 2

(Mai/)63 )reMotf

Z 02:; <3)

i
(x,k,l)eSeql

2.3.4 Constraints: Here, we describe the constraints that we use to ensure
the correctness of the motif insertion and to control the coherency of the ﬁnal
structure. We detail these equations below.

Hairpins:

, x,l
V(x,k,i)e5eq} - CM 5 Z (1_Da,v)+
(a,v)eB

k—lSaSkAlSVSl-I—l

55,1 2,2
2 C11 + 2 C11
,1)eSeq (i,1},1)eSeq§
:k_1 1}:l+1

(4)

(1

_..o

N “m

We use Constraint (4) to insert the hairpins (i.e. x e Mot 1). A hairpin can
be inserted if and only if one of two following criteria holds: A base pair
(11, v) e B exists such that both extremities are stacked or overlap on the motif
x (Fig. 2a), or there is an inserted motif y with two components (i.e. y e Mot 2)
such thatx is nested inside y and stacked onto one of its components (Fig. 2b).

 

i209

112 jﬁio's[Bumo[pJOJXO'sorJBMJOJuroiqj/:duq 11101} papeolumoq

9103 ‘0g1sn8nv uo ::

V.Reinharz et al.

 

[a] lb}

 

Fig. 2. (23) shows how a hairpin can be inserted in our model, with both extremities stacked, or overlapping a canonical base pair. In (2b) we show the last

conﬁguration, where we require the hairpin to be between the components of a 2-way junction and to have at least one extremity stacked. In (2c) we show
another View of Figure 1 without the base pairs overlapping the 3-way junction. We can notice that we can go from any component of the 3-way junction to

any other without crossing the base pairs

Interior loops ana1 bulges:

V(u,v)eB, VxEMot2: —n-D,,, 5

,1 ,2
2 C2,! _ 2 C2,! Sn‘Dw (5)
(x,k,i)eSeqf (x,k,i)eSeq§
l<uvv<k l<uvv<k

V(x,k,l)eSeq%,V(x,lE,l)| 12>1x221+ Z 131—k+i—IE+1

(u.v)eB (u,v)eB
kSuSlAhSi/Sl ksusleeigsl

El

(6)

esquzcgj+c

Constraints (5) and (6) are used to insert bulges and interior loops.
Constraint (5) stipulates that for all base pairs (u,v)eB, every motif in
Mot2 must have as many ﬁrst component inserted before u or after v, as it
has second components, allowing to create an are between the components
of every motif without creating a pseudo-knot with the base pairs in the
secondary structure. Constraint (6) allows both components to be inserted
only if they ﬁll at least 2 unpaired positions. Indeed, such insertion would
most likely not produce valuable structural information.

k-way junctions:

2 C12; 5 1 (7)
1'23
(Lebesqu

VjZ3,V(u,v)eB: —n-DM,V 5

. x,l Xgi
0—1). 2 VCM—  Ckglgn-DW (8)
(x,k,i)eSeq’l “’57 ,
askslsv (X.k.l)€S€‘l;
MSkSlSV

Constraints (7) and (8) describe how k-way junctions are inserted.
Constraint (7) restricts the number of inserted motifs with three or more
components to one, which is a reasonable assumption given the size of
the RNAs. Combined with (8), it means that for every conserved base pair
(u,v)eB, a motif can be inserted if all or none of the components are
between u and v. This is equivalent, as we can see in Figure 20, to saying
that we can connect the components which are shown in red without creating
a pseudo-knot with the base pairs in the secondary structure.

Motifs completeness:

Vigi<j,V(x,k,i)eseq§:C,ij 2 C123“ (9)
(x,l},l)eSeq;+l
l+5<h
v1<igj,V(x,k,i)eseq§:C,ij 2 C21“ (10)
(x,l},l)eSeq;_l
l<k—5

Vj>1,VxeMotj,V1<i5j: 2 Cf,‘— Z C§§=0 (H)

(x,k,l)eSeq71 (x,l},l)eSeq;

Constraints (9) , (10) and (11) ensure that the insertions of the components
in a) respect their order given in the motif. Constraints (9) and (10) require
that if  is the j-th component of motif x and it is inserted at positions
k,l, then at least one Q‘— 1)-th component of the same motif should be
inserted ﬁve nucleotides above, and one (j +1)-th component after. The
last constraint restricts that, since a motif can be inserted many times, the
multiplicity of every component should be equal to the multiplicity of the
ﬁrst component.

Secondary structure constraints:

Vj>1,v1gigj,V(x,k,i)eseq§:ngg 81—03,) (12)

(u,v)eB
k—lsuskv
[Susi-Hy
k—lSVSkV

lSVSl-l—l

. 1 3 .
Vlgugn: Z C;:;+Z Z (1—Dk,,)+Zr 2 C351

(x,k,l)eSeq; {WEE (x,k,l)eSeq;
k<u<l k_uw_u k:uvl:u
(13)
Vl<u<n:(l— Z Dm—(i— Z DW)+
(E,I7)EB (1,093
uzu—lvf/zu—l ﬂzuvT/zu
(14)
(1— 2 szo
(1,093
uzu-I—lvT/zu-I—l
Z Dijer-IBI (15>

(i,j)eB
We conclude by describing the constraints regulating the secondary
structure properties. Constraint (12) use the secondary structure to guide the

 

i210

112 jﬁio's1euinoprOJXO'soueIJJJOJuroiqj/:duq 111011 papeo1umoq

9103 ‘0g1sn8nv uo ::

Towards 3D structure prediction of large RNA molecules

 

sites of the components by allowing insertions if and only if one extremity
overlaps or is stacked on top of a base pair. Constraint (13) forbids two
components from overlapping to each other, and prevents base pairs to
occur inside a component. Constraint (14) uses the formulation of (Poolsap
et al., 2009) to prevent lonely base pairs (i.e. every position in a base pair
must also have an adjacent position in a base pair). Constraint (15) limits
the number of canonical base pairs 8 of S that can be removed.

3 RESULTS

3.1 Implementation

To solve the IP problem, we use the Gurobi optimizer
v.4.5.1 (Houston, 201 1) API for Python. We ran our benchmark on a
Ubuntu-Server 10.04 on a Dell PE T610 2x Intel Quad core X5570
Xeon Processor, 2.93 GHz 8 M Cache, 64GB Memory (8 X 8 GB),
1333 MHz Dual Ranked RDIMMs for 15 Processors, Advanced
ECC.

3.2 Dataset

We validate our method on the dataset deﬁned by (Laing and Schlick,
2010) to benchmark the RNA 3D structure prediction programs.
In this work, we aim to predict the structure of large RNAs with
3-way and 4-way junctions. Small sequences (<50 nucleotides)
with simpler structures can be accurately predicted using existing
methods such as MC—Pipeline or NAST. Therefore, we removed
from the dataset sequences with <50 nucleotides. We also
removed RNAs with secondary structures that include pseudo-
knots. Indeed, our approach has been designed to use secondary
structures predicted by classical secondary structure predictors
such as RNAfold and RNAstructure, thus without pseudo-
knots. Moreover, our motif database and IP model have not been
designed to insert pseudo-knots. We redirect the reader interested in
application of IP techniques to the prediction of pseudo-knots to the
recent works of Poolsap et a1. (2009) and Sato et a1. (2011). Our ﬁnal
dataset includes 11 RNAs with sequences of lengths ranging from
53 to 128 nucleotides. We note that 2 of these 1 1 had no homologous
3-way junctions in our database. We present here the results on the
remaining nine RNAs. Eight of them have a 3-way junction and the
other a 4-way junction. Importantly, the motifs extracted from these
RNAs by RNA3Dmotifs (Djelloul and Denise, 2008) have been
removed from our motif database.

For the negative control test, we used a test set composed of the
24 RNAs from the dataset deﬁned by C.Laing and T.Schlick without
pseudo-knot, 3 or 4-way junction. Their sizes range from 16 to 77
nucleotides.

3.3 RNA—MoIP pipe-line

Our RNA tertiary structure prediction pipe-line works in three steps.
First, secondary structures are predicted using classical predictors
such as RNAfold, RNAstructure or una fold. In this work, we
generated the input secondary structures with RNAsubopt (Wuchty
et a1., 1999). We used the default parameters but discarded structures
with lonely pairs (i.e stems of length 1). This procedure generated
between 1 and 22 secondary structures for each RNA sequence.
Nonetheless, the quality of secondary structure predictions is too
low on the riboswitch 3D2G from Arabidopsis thaliana and the
tRNA 2DU 3 from Archaeoglobus fulgidus to accommodate k-
way junction motifs insertion. Therefore, we extended our list of

suboptimal structures and generated all secondary structures in the
range of 4.5 kcal/mol from the mfe. This operation resulted in a total
of 242 (resp. 58) secondary structures. We also note that extending
the list of suboptimal structures of other RNAs produces identical
results. Typically the secondary structure predictors generate lists of
suboptimal structures from which it is difﬁcult to extract the best
ones. We will see in Section 3.3.2 that our method is able to identify
the best candidates in these ensemble predictions.

We apply RNA—MOIP to insert RNA 3D motifs in these secondary
structures as described in Section 2.3. The solution with an optimal
score, under our objective ﬁinction (Section 2.3.3) is scripted
manually for MC—Sym with the motifs locked in. Due to various
MC—Sym features, it is currently difﬁcult to generate automatically
these scripts. Hence, the processing of very large sequence datasets
remains challenging. We recall that many 3D structures can have
the same motif, which is only determined by the sequence. Here
we provide all alternative conﬁgurations to MC—Sym. Time is a
major limitation of MC—Sym. Using our strategy, we show that
preprocessing the sequences with RNA—MOIP results in a dramatic
time improvement and at the same time improves the accuracy. We
set a time limit of 30 min. Then on every set of predicted structures
we apply a minimization of steepest-descent until [(G RMS <5
Kcal/mol/A) or (steps > 500)] (Parisien and Maj or, 2008). It is worth
noting that MC—Sym was not able to generate a structure in two
cases (3E5C and 2GDI), although RNA—MOIP predicted the 3-way
junctions at the correct positions.

3.3.] Negative control We verify that RNA—MOIP does not
predict wrong insertions (i.e. false positives). We use a negative
control dataset composed of the 24 RNAs extracted from the dataset
of C.Laing and T.Schlick that contain hairpins and interior loops
motifs but without pseudo-knots and k-way junctions. Then, we
apply the protocol described as in Section 3.3. Our results indicate
that no k-way junction have been inserted in the optimal solution
returned by RNA—MOIP.

3.3.2 Secondary structure The identiﬁcation of the best
secondary structures in a list of suboptimals is one major challenges
in RNA secondary structure ensemble prediction. As we can see in
Table 1, the average base pair accuracy of the secondary structure
prediction is ~63%. But when we look at the base pair accuracy of
the secondary structures selected by RNA—MOI P (78%) we observe a
major improvement of 15% which means that our approach is able
to identify the best secondary structures in a pool of candidates.
Interestingly, our program is able to extract candidates with a very
low rank. For instance, on 2DU3 RNA—MOIP extracts the 163-th
candidate with a base pair accuracy of 91% (versus 43% in average)
in a pool of 258 structures. Finally, to accommodate motif insertions
RNA—MOIP can remove base pairs. Once removed, the ratio of
well-predicted base pairs reaches 84%, thus increases by 6%. This
experiment demonstrates that the insertion of motifs can help to
identify incorrectly predicted base pairs.

3.3.3 Three-dimensional structure We evaluate the quality of
our 3D structure predictions using the RMSD and the RNA
Interaction Network Fidelity (Gendron et a1., 2001) tool, available
with the MC—Pipeline at major . iric . ca/MC—Pipeline/.
The latter computes the true positive (TP), false positive (FF)
and false negative (FN) tertiary structure interactions between the

 

i211

112 jﬁio's1euinoprOJXO'soueIJJJOJuroiqj/:duq 111011 papeo1umoq

9103 ‘0g1sn8nv uo ::

V.Reinharz et al.

 

 

 

 

 

Table 1.
Percentage of well-predicted base pairs Secondary structure
in the predicted secondary structures selected by RNA—MOIP
PDB Optimal solution Average over all Rank in Nb. of candidate
secondary structures RNAsubopt list secondary structures
Before After
3E5C 100 100 100 1 2
1DK1 88 92 82 1 7
1MMS 47 67 49 2 2
2DU3 79 100 44 52 58
3D2G 91 100 43 163 243
2H0] 68 68 61 13 20
2GDI 96 94 71 10 22
1LNG 100 100 82 1 7
1MFQ 29 31 3 1 1 4
Average 78 84 63

 

The ﬁrst column shows the PDB identiﬁer of the RNAs. The two following columns show the ratio of well-predicted base pairs in two structures. The former is the structure in the
optimal solution of the RNA and the latter is the same structure after RNAeMoIP was applied and removed some base pairs (we highlight in bold the improved scores). There is
an average increase of 6% and only one case where it decreased. The fourth column represents the average of well-predicted base pairs for each RNA over all secondary structures
considered by RNAeMoIP. The penultimate column shows the rank of the best secondary structure selected by RNAeMoIP in the ordered list of suboptimal secondary structures
generated with RNAsubopt, whereas the last column shows the total number of suboptimal secondary structures in that list.

 

 

 

 

 

 

 

 

 

(a) 1.0
I I 1DK1.|EI"I:57
°-9 0 o 1MMS. len: 58
03 I I 2DU3. len: 71
a o 3D26, len: W
30.7 I I 2H0]. len: 79
:3 06 o o 1LNG. len: 97
 o I 1MFQ.|en:128
g 05 A A MCSYM. len: 57
A a MCSYM, len: 58
0.4 a A MCSYM, len: 79
a A MCSYM, len: 97
“'3 a A MCSYM.Ien: 77
03.1 0.2 0.3 0.4 0.5 0.0 0.? 0.0 0.0 1.0

PPV

 

 

 

 

(b) with RNAMoIP motifs: -
30 onlyr secondary structure: -
25- I : T
20 — I I 5
Ct T I 1 * -
g 15- - E 1 4
m I T -L i
10 1L .1 T T _L
i — - | |
5.... + _ I I
— E I 4
0 5? 53 11 7? 1'9 9? 113‘“
Length

Fig. 3. (3a) shows the PPV and STY for all the 3D structures generated by our scripts on MC—Sym against the reference on the PDB (Berman et al., 2000).
(3b) Shows in green the distribution of the RMSD of the solutions obtained with MC—Sym when the structures of the motifs were given and in blue when
only the secondary structure was provided. N.B.: In the latter, the molecules are identiﬁed by their size

experimental structures deposited in the PDB (Berman et a1., 2000)
and our predictions, and returns the positive predictive value (PPV)
and sensitivity (STY) deﬁned as:
|TP| |TP|
PPV:=— STY:=—.
|TP| + |FP| |TP| + |FN|

We report our results in Figure 3. Figure 3b shows that RNA—MOIP
coupled with MC—Sym is able to predict most of the tertiary structure
interactions.

We show in green in Figure 3b the RMSDs of the solutions
obtained with MC—Sym as described in Section 3.3. We recall that
each script for MC—Sym is done manually with the positions inside
the predicted motifs directly mapped to the pool of corresponding

3D structures, obtained by RNA3Dmotifs from (Djelloul and
Denise, 2008). We also recall that (Laing and Schlick, 2010) report
that only the two smallest structures were resolved by MC—Fold
|MC—Sym when only the sequence was given. We thus decided to
input into the MC—Fold |MC—Sym pipeline the sequence with the
secondary structure selected by RNA—MOIP. Under this scenario,
MC—Sym was allowed to run for 48 h. Those results are shown in
blue. As we can see, having the secondary structures allowed to
solve ﬁve of the seven structures. We note that two of them only
produced seven solutions in the ﬁrst half-hour. The largest one
took more then 4h to produce the ﬁrst results, and had only two
solutions after the 48 h. Nonetheless the information given by the

 

i212

112 jﬁio's1euinoprOJXO'soueuJJOJurorq”:duq uroiJ papeo1umoq

9103 ‘0g1sn8nv uo ::

Towards 3D structure prediction of large RNA molecules

 

 

 

 

Table 2.
PDB NTs RNA—MOIP Nb. 3D MCC RMSD Structure

Sec. structs. Time (s) Max Avg SD Min Avg SD
3E5C 53 2 0.27 0 7 7 7 7 7 7 3-way (riboswitch)
1DK1 57 7 3.11 106 0.88 0.81 0.03 2.95 4.76 0.99 3-way
1MMS>i< 58 2 0.31 105 0.68 0.63 0.03 5.66 7.65 0.86 3-way
2DU3>i< 71 58 139.96 7 0.90 0.82 0.04 2.23 2.91 0.44 4-way (tRNA)
3D2G>i<# 77 243 1268.63 8 0.84 0.80 0.02 5.34 7.35 1.34 3-way (riboswitch)
2HOJ*# 79 20 27.44 155 0.84 0.80 0.01 3.19 7.29 2.31 3-way (riboswitch)
2GDI>I< 80 22 47.1 0 7 7 7 7 7 7 3-way (riboswitch)
1LNG>i< 97 7 110.96 146 0.88 0.84 0.02 2.73 6.30 1.91 3-way (SRP)
1MFQ>I< 128 4 46.06 14 0.77 0.72 0.03 9.07 14.34 5.01 3-way (SRP)

 

In the ﬁrst column RNA identiﬁers are followed by an ‘>i<’ or a ‘#’ to denote that MC7Sym (reps. NAST) failed to predict them, as reported by Laing and Schlick (2010). The second
column contains the length of each RNA. The third column contains the number of secondary structure predicted by RNAfold and used as input for RNA7MoIP. The fourth column
is the total time (preprocessing and solve) in seconds taken by RNA7MoIP to ﬁnd an optimal solution for all the secondary structures. The ﬁfth column contains the number of 3D
structures generated by MC7Sym with the script made with RNA7MoIP optimal solution. We then have the maximal, average and SD of the MCC. The following three columns
present the minimal, average and SD of the RMSD. Finally, the last column indicate the type of junction found in the native structure.

 

 

 
 
  
   

 

 

 

 

 

 

40 .
— MC—Sym
35 --- extrapolation
30 — IFoldRNA x,-
— Rosetta -
25 — RNA—MolP o'
B "
E20-
0:
15-
o
10-
5 a
o
00 20 40 60 30 100 120
Length

Fig. 4. Comparison of the RMSD obtained by RNA—MOIP,
MC—Pipeline, iFoldRNA and FARNA by Laing and Schlick
(2010). This ﬁgure is derived from the data computed by Laing and Schlick
(2010) on which we superposed the results obtained by RNA—MOIP and
MC—Sym. The dots are the average RMSD shown in Figure 3b. We also
show in dotted line the extrapolated RMSD for MC—Sym and in black the
best ﬁt for the average RMSD obtained with our pipeline

motifs allows to our method to predict signiﬁcantly more accurate
results.

Figure 4 shows that our program outperforms other software and
produces 3D structures with a RMSD signiﬁcantly lower than those
observed by Laing and Schlick (2010) for other programs. It also
shows that our method scales with the length of the RNA better than
other approaches.

We completed this analysis by computing the Matthews
correlation coefﬁcient (MCC), deﬁned as: MCC:=\/ PPV >< STY,
and the running time of our method. We show in Table 2 an overview
of the results obtained on each RNA. We note the fast execution time
of RNA—MOI P, even when a large number of secondary structures
are used. Also, despite a time limit of 30 min, MC—Sym generates
good candidates. Noticeably, our RMSD can be as low as 2.23A for

the tRNA 2DU3 and are considerably smaller than those reported
by (Laing and Schlick, 2010) (Fig. 4).

4 DISCUSSION

In this article we demonstrated that large RNA 3D structures can be
automatically predicted using a hierarchical approach. We beneﬁts of
the progresses accumulated over the last 30 years in the ﬁeld of RNA
secondary structure prediction and, using an IP framework, expands
these methods to incorporate the novel local motifs information
available in databases. We show that this approach enables us to
predict very quickly accurate 3D structures for large RNA sequences
(>50 nucleotides). By contrast, previous methods were either too
slow or too inaccurate on molecules with similar sizes.

We show that motif insertion enables us to identify the best
secondary structures in a pool of suboptimal structures. Nonetheless,
the choice of the size of the sample set that need to be generated
remains an open problem. As illustrated by the 3D2G and 2DU 3
experiments, some RNAs may require signiﬁcantly more suboptimal
than those generated by default by RNAsubopt. A simple strategy
to reduce the search space would be to cluster those samples and
pick representatives structures.

RNA—MOIP demonstrates that we can already beneﬁt from the
information accumulated in RNA local motif databases without
deriving a new model. This is important because the paucity
of the data currently available in these databases prevents us to
develop accurate statistical potentials for predicting tertiary structure
interactions in high-order motifs such as the k-way junctions.

Therefore, another important issue with RNA—MOIP is the
completeness of the motif database. For instance, we have seen that
there is no homologous 3-way junction in our database that can be
correctly inserted in 3EGZ (riboswitch in H. sapiens) and 2OIU
(synthetic ribozyme). To circumvent this limitation, an interesting
approach would be to generate highly probable new motifs from the
existing ones using isostericity matrices (Stombaugh et a1., 2009).

Some of the IP techniques developed here could be re-written
using a dynamic programming approach. However, we argue that
the IP approach is more ﬂexible and more suited to this problem.
Indeed, in our framework the rules of insertions can be easily

 

i213

112 jﬁio's1euinoprOJXO'soueuJJOJurorq”:duq uroiJ papeo1umoq

9103 ‘0g1sn8nv uo ::

V.Reinharz et al.

 

modiﬁed (i.e. adding, removing or changing an equation) whereas
a dynamic programming scheme would required a complete re-
implementation. This is particularly useﬁil in this case where some
motifs present in our databases have speciﬁc insertion constraints.
This situation is more likely to happen in the future with the
growth of RNA local motif databases. Moreover, we demonstrated
in this article that our implementation is fast enough for realistic
applications.

Finally, our methods are compatible with state-of—the-art IP
programs for pseudo-knot predictions (Poolsap et a1., 2009; Sato
et a1., 2011). In ﬁiture work, we could envision to merge the two
models and include new rules for inserting highly sophisticated
3D motifs with long-range interactions, coaxial stacking or base
triplets. Beside its inherent ﬂexibility, the development of IP models
for RNA structure prediction ﬁnds a justiﬁcation in recent results
showing the inapproximability of the prediction of RNA pseudo-
knotted secondary structures with a nearest neighbour model (Sheik
et a1., 2012).

ACKNOWLEDGEMENTS

The authors would like to thank Marc-Frederick Blanchet and Karine
Saint-Onge for their help with the MC — Sym program, as well as Yann
Ponty and Mohit Singh for their useﬁil comments and suggestions
when designing the IP framework.

Funding: FQRNT team grant 232983 (to V.R., FM. and J.W.);
NSERC Discovery grant 219671 (to J .W.)

Conﬂict of Interest: none declared.

REFERENCES

Berman,H.M. et al. (2000) The protein data bank. Nucleic Acids Res., 28, 2357242.

Bindewald,E. et al. (2008) RNAJunction: a database of RNA junctions and kissing
loops for three-dimensional structural analysis and nanodesign. Nucleic Acids Res,
36, D3927D397.

Cruz,J.A. and Westhof,E. (2011) Sequence-based identiﬁcation of 3D structural modules
in RNA with RMDetect. Nat. Meth., 8, 5137521.

Das,R. and Baker,D. (2007) Automated de novo prediction of native-like RNA tertiary
structures. Proc. Natl. Acad. Sci. USA, 104, 14664714669.

Djelloul,M. and Denise,A. (2008) Automated motif extraction and classiﬁcation in RNA
tertiary structures. RNA, 14, 248972497.

Do,C.B. et al. (2006) CONTRAfold: RNA secondary structure prediction without
physics-based models. Bioinformatics, 22, e907e98.

Frellsen,J. et al. (2009) A probabilistic model of RNA conformational space. PLoS
Comput. Biol., 5, 61000406.

Gendron,P. et al. (2001) Quantitative analysis of nucleic acid three-dimensional
structures. J. Mol. Biol., 308, 9197936.

Hofacker,I.L. (2009) RNA secondary structure analysis using the Vienna RNA package.
Curr Protoc. Bioinform, Chapter 12, Unit12.2.

Houston, Texas: Gurobi Optimization, 1. (2011) Gurobi optimizer version 4.5.1.
Software Program.

Jonikas,M.A. et al. (2009) Knowledge-based instantiation of full atomic detail into
coarse-grain RNA 3D structural models. Bioinformatics, 25, 325973266.

Jossinet,F. et al. (2010) Assemble: an interactive graphical tool to analyze and build
RNA architectures at the 2D and 3D levels. Bioinformatics, 26, 205772059.

Laing,C. and Schlick,T. (2010) Computational approaches to 3D modeling of RNA.
J. Phys. Condens. Matter, 22, 283101.

Lamiable,A. et al. (2012) Automated prediction of three-way junction topological
families in RNA secondary structures. Comput. Biol. and Chem, 37, 175.

Lemieux,S. and Major,F. (2002) RNA canonical and non-canonical base pairing
types: a recognition method and complete repertoire. Nucleic Acids Res., 30,
4250—4263.

Markham,N.R. and Zuker,M. (2008) UNAFold: software for nucleic acid folding and
hybridization. Methods Mol. Biol., 453, 3731.

Martinez,H.M. et al. (2008) RNA2D3D: a program for generating, viewing, and
comparing 3-dimensional models of RNA J. Biomol. Struct. Dyn., 25, 669$83.

Parisien,M. and Major,F. (2008) The MC-Fold and MC-Sym pipeline infers RNA
structure from sequence data. Nature, 452, 51755.

Poolsap,U. et al. (2009) Prediction of RNA secondary structure with pseudoknots using
integer programming. BMC Bioinformatics, 10(Suppl. 1), S38.

Reuter,J.S. and Mathews, DH. (2010) RNAstructure: software for RNA secondary
structure prediction and analysis. BMC Bioinformatics, 11, 129.

Sarver,M. et al. (2008) FR3D: ﬁnding local and composite recurrent structural motifs
in RNA 3D structures. J. Math. Biol., 56, 2157252.

Sato,K. et al. (2011) IPknot: fast and accurate prediction of RNA secondary structures
with pseudoknots using integer programming. Bioinformatics, 27, i857i93.

Sharma,S. et al. (2008) iFoldRNA: three-dimensional RNA structure prediction and
folding. Bioinformatics, 24, 195171952.

Sheik,S. et al. (2012) Impact of the energy model on the complexity of RNA folding
with pseudoknots. In Proceedings the 23rd Annual Symposium on Combinatorial
Pattern Matching (CPM 2012). Helsinki, Finland, July 375, 2012.

Stombaugh,J. et al. (2009) Frequency and isostericity of RNA base pairs. NucleicAcids
Res, 37, 229472312.

Wang,Z. and Xu,J. (2011) A conditional random ﬁelds method for RNA sequence-
structure relationship modeling and conformation sampling. Bioinformatics, 27,
i1027i110.

Wuchty,S. et al. (1999) Complete suboptimal folding of RNA and the stability of
secondary structures. Biopolymers, 49. 1457165.

Zakov,S. et al. (2011) Rich parameterization improves rna structure prediction. In
RECOMB, pp. 5467562.

zu Siederdissen,C.H. et al. (2011) A folding algorithm for extended RNA secondary
structures. Bioinformatics, 27, i1297i136.

 

i214

112 jﬁio's1euinoprOJXO'soueuJJOJurorq”:duq mos} papeo1umoq

9103 ‘0g1sn8nv uo ::

