ORIGINAL PAPER

Vol. 27 no. 12 2011, pages 1637-1644
doi:10. 1093/bioinformatics/btr1 18

 

Gene expression

Advance Access publication March 12, 2011

Identification and quantification of metabolites in 1H NMR spectra

by Bayesian model selection

Cheng Zhenglai‘, Shucha Zhang2, Susanne Ragg3, Daniel Raftery4 and Olga Vitek1’5a*

1Department of Statistics, Purdue University, West Lafayette, IN 47907, 2Fred Hutchinson Cancer Research Center,
Seattle, WA 98109, 3School of Medicine, Department of Pediatrics, Indiana University, Indianapolis, IN 46202,
4Department of Chemistry, Purdue University, West Lafayette, IN 47907 and 5Department of Computer Science,

Purdue University, West Lafayette, IN 47907, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Nuclear magnetic resonance (NMR) spectroscopy is
widely used for high-throughput characterization of metabolites in
complex biological mixtures. However, accurate interpretation of the
spectra in terms of identities and abundances of metabolites can be
challenging, in particular in crowded regions with heavy peak overlap.
Although a number of computational approaches for this task have
recently been proposed, they are not entirely satisfactory in either
accuracy or extent of automation.

Results: We introduce a probabilistic approach Bayesian
Quantification (BQuant), for fully automated database-based
identification and quantification of metabolites in local regions of 1H
NMR spectra. The approach represents the spectra as mixtures of
reference profiles from a database, and infers the identities and the
abundances of metabolites by Bayesian model selection. We show
using a simulated dataset, a spike-in experiment and a metabolomic
investigation of plasma samples that BQuant outperforms the
available automated alternatives in accuracy for both identification
and quantification.

Availability: The R package BQuant is available at:
http://www.stat.purdue.edu/~ovitek/BQuant-Web/.

Contact: ovitek@stat.purdue.edu; zhengc@purdue.edu
Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on December 6, 2010; revised on February 20, 2011;
accepted on February 25, 2011

1 INTRODUCTION

The ﬁeld of metabolomics studies small molecules such as amino
acids, nucleic acids, lipids and carbohydrates, called metabolites,
which are present in cells and extracellular ﬂuids of biological
organisms (Wishart et al., 2007). Metabolites are the end products
of a variety of cellular processes and their high-throughput
characterization and quantiﬁcation can provide important insights
into the functioning of living organisms. As a result, metabolomics
is increasingly applied to the areas of system biology, drug discovery,
pharmaceutical research, early disease detection, toxicology and
food science (Gowda et al., 2008).

 

*To whom correspondence should be addressed.

Developments in high-throughput metabolomics are driven by
advances in analytical methods (Chen et al., 2006), such as nuclear
magnetic resonance (NMR) spectroscopy and in mass spectrometry.
In particular, 1H NMR spectroscopy is non-destructive and
highly reproducible, and is widely used for the identiﬁcation and
quantiﬁcation of metabolites in bioﬂuids such as plasma and urine
(Nicholson et al., 1999). The 1H NMR signal is generated by the
motion of magnetic moments of protons or other nuclei in a magnetic
ﬁeld after their excitement with a high-frequency pulse (Silverstein
et al., 2005). Fourier transformation of this time-dependent signal
yields a chemical shiﬁ, a measure that expresses the dependence of
nuclear magnetic energy on the electronic and chemical environment
in the molecule. An 1H NMR spectrum displays chemical shifts
in parts per million (p.p.m., i.e. the difference in hertz between
a resonance frequency and that of a reference substance, over
frequency of magnet ﬁeld in megahertz), versus intensities of the
signals (Ernst et al., 1990).

Typically, a metabolite detectable by 1H NMR contains one
or more protons, and each of the protons produces one or more
peaks. The number of peaks generated by a metabolite, as well as
their location and ratio of heights, are reproducible and uniquely
determined by the chemical structure of the molecule. Figure 1
illustrates two 1H NMR spectra with a dominant signal from
metabolite taurine from the spike-in experiment in Section 4. All
three predominant peaks in the spectra correspond to one proton in
the taurine chemical structure. The expected ratio of heights of the
three peaks is known and ﬁxed to 122:1.

Extensive information regarding NMR-speciﬁc characteristics
of a variety of metabolites is currently available. Several public
databases, such as human metabolome database (HMDB) (Wishart
et al., 2007) and BioMagResBank (BMRB) (Ulrich et al., 2008),
as well as commercial databases such as the one in the Chenomx
NMR suite (Weljie et al., 2006), store reference NMR spectra
of metabolites. The reference spectra can contain observed peak
locations and ratios of heights of spectra from pure chemical
compounds, or their simulated counterparts. Therefore, in principle,
researchers can identify metabolites by matching the observed
spectra to the reference spectra in the database. The area of the
peaks from a metabolite is directly related to its abundance. As the
abundance changes, the heights of peaks belonging to the same
metabolite vary, as shown in the case of taurine in Figure 1. This
enables relative quantiﬁcation of metabolites across samples of

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1637

112 /3.Io's[Bruno[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papBOIII/IAOG

91oz ‘Og anﬁnv uo ::

C.Zheng et al.

 

 

10
|

Intensity

 

 

 

 

3.472 3.445 3.41 5 3.391 3.365

Chemical shift. ppm

Fig. 1. A region from two 1H NMR spectra from the spike-in experiment
in Section 4. Solid line: spectral region from a sample containing the spiked
metabolite taurine in the concentration of 3200 mols/l. Dashed line: spectral
region from a sample containing taurine in the concentration of 1600 mols/l.
The decrease in metabolite abundance results in a proportional decrease of
all three peaks.

various types, e.g. across samples from patients with various status
of a disease in biomarker discovery investigations.

However, inference of identity and abundance of metabolites
from 1H NMR spectra is fraught with difﬁculties. First, complex
biological mixtures contain hundreds of metabolites, which vary in
abundance substantially, and can produce highly overlapped peaks.
Second, the number of candidate metabolites in a database typically
exceeds the number of major sources of signals in the spectra,
and one has to explore a combinatorially large space of candidate
metabolites. Finally, due to numerous factors such as potential
of pH and ionic interactions, peaks generated by a metabolite
can deviate from their expected p.p.m. (Brelstaff et (11., 2009),
introducing ‘positional uncertainty’. The combination of these
factors makes the deconvolution and the interpretation of individual
metabolite-speciﬁc signals very challenging in practice. Automated
inferential approaches are needed in order to account for the noise
and ambiguity of spectral interpretations, and to derive objective,
accurate and reproducible identiﬁcations and quantiﬁcations of
metabolites.

This article develops a fully automated inferential approach, that
we call BQuant, for identiﬁcation and quantiﬁcation of metabolites
in regions of complex 1H NMR spectra. It takes as input a set
of NMR spectra, a range of ppm. of interest and a database of
reference spectra for candidate compounds. It is based on a family
of Bayesian hierarchical models for the spectra, where the models
with the highest posterior probabilities are selected using a stochastic
sampling technique. BQuant outputs a list of identiﬁed metabolites
associated with their inclusion probability, and their measures of
abundances in each spectrum on a continuous scale.

2 BACKGROUND

Once NMR spectra are acquired, their analysis involves baseline
correction, peak linewidth adjustment, normalization, spectral
alignment, identiﬁcation and quantiﬁcation of metabolites, and
univariate and multivariate statistical analysis. This manuscript
focuses on the identiﬁcation and quantiﬁcation of metabolites.
Methods for identiﬁcation and quantiﬁcation of metabolites can be
classiﬁed into three broad categories: binning, curve-ﬁtting without
a database and curve-ﬁtting with a database. For binning and curve-
ﬁtting without a database, feature quantiﬁcation is performed ﬁrst
and identiﬁcation of the features is conducted subsequently as a

separate step. For curve-ﬁtting with a database, identiﬁcation and
quantiﬁcation are performed simultaneously.

Binning: this (Meyer et (11., 2008) processes one spectrum at
a time, divides each spectrum into equally or variable-sized bins
and integrates the intensities in each bin for quantiﬁcation. The
method is easy to implement, however it often lacks accuracy, in
particular, in crowded regions of the spectra. Feature abundances
can be inaccurately estimated by overlooking tail areas of peaks, or
contaminated by signals from other sources.

The bins are manually annotated with metabolite identities using
a database; however, this requires a great degree of expertise. Since
multiple peaks of a metabolites are highly correlated, statistical total
correlation spectroscopy (STOCSY) (Cloarec et (11., 2005) can be
used to assist the identiﬁcation (Alves et (11., 2009).

Curve ﬁtting without (1 database: after phase and baseline
correction, many NMR spectra can be viewed as a combination of
multiple non-negative source signals from individual metabolites,
mixed linearly with non-negative but unknown proportions. Curve
ﬁtting attempts to recover these signals directly from the entire
collection of spectra and a database. The general task of curve
ﬁtting can be performed by a class of non-negative matrix
factorization (NMF) methods. One such algorithm, Bayesian
spectrum decomposition (Ochs et (11., 1999), sets speciﬁc forms of
prior distributions for both source signals and mixing coefﬁcients,
and has been successfully applied to deconvolution of NMR spectra
(Stoyanova et (11., 2004). Another NMF algorithm, alternating least
squares (Eads et (11., 2004), iteratively estimates source signals
and mixing coefﬁcients until convergence. Finally, ‘constrained
total-line-shape ﬁtting’ (Laatikainen et (11., 1996; Soininen et (11.,
2005) utilizes detected peak locations, and models the peaks by a
linear combination of Lorentzian and Gaussian lineshape functions.
Similar settings appear in Alsmeyer and Marquardt (2004) and
Anderson et (11. (2009).

As in the case of binning, identiﬁcation of signals derived
with curve-ﬁtting methods occurs in a subsequent separate step.
Unfortunately, the extracted curves are often not interpretable
directly, and this undermines the practical utility of these
methods.

Curve-ﬁtting with database: interpretation of 1H NMR spectra as
linear combinations of reference proﬁles from a database (Wishart,
2008) allows us to simultaneously identify and quantify metabolites.
Crockford et (11. (2005) utilize recorded pure compound spectra as
signal templates and describe a least-squares strategy for ﬁtting the
templates to spectra. Gipsona et (11. (2006) utilize the database while
imposing non-negativity constraints on the relative abundance of
metabolites, and show a promising constrained ﬁtting scheme called
least-squares deconvolution. However, the approaches have been
demonstrated in limited experimental situations.

Finally, the commercial Chenomx NMR suite provides a
comprehensive database of metabolites, and their signal curves
consisting of Lorentzian peaks, that can be used for manual
deconvolution. Figure 2 provides an example of Chenomx analysis
of an 1H NMR spectrum from human plasma samples in
Section 4. The raw spectrum (in black) is decomposed into multiple
components and their summation is depicted by another black curve
below the raw spectrum. The shaded area indicates four peaks, which
are generated by a metabolite valine according to the database in
Chenomx. Despite its manual nature, Chenomx suite is currently a
popular tool for the interpretation of NMR metabolomic spectra.

 

1 638

112 /3.ro's[sumo[p.IOJxosorwurJOJurorq”:duq wort papeolumoq

9103 ‘Og anﬁnv uo ::

1H NMR spectra

 

' 127175 LEIS' "325 " ‘1 [ID I]  ﬁr'EISS El 925 El.‘3".'|

Fig. 2. Interpretation of an 1H NMR spectrum from the the metabolomic
investigation of plasma samples in Section 4 using Chenomx. X -axis: p.p.m.;
y-axis: intensity; two black curves: raw spectrum and ﬁtted spectrum; shaded
area: four peaks generated by metabolite valine. according to a reference
database. The difference between the observed spectrum and the ﬁtted
spectrum is primarily due to signals from large molecules such as lipids.

In summary, simple methods such as binning oversimplify the
structure of the spectra and can produce inaccurate identiﬁcation
and quantiﬁcation. Curve ﬁtting without a database uses realistic
models, but often fails to capture the true signals. Database-based
approaches improve both the interpretability and the accuracy of
spectral interpretation; however, they lack automation.

This article proposes an automated probabilistic approach for
curve ﬁtting using a database of candidate metabolites. Similar to the
existing methods, we model the observed spectra as a combination
of reference signals in a database, mixed linearly with unknown
proportions. However, unlike the existing methods, we specify a
Bayesian probability model which jointly represents the ﬁill set of
replicate spectra and views metabolites in the database as candidate
variables. We then convert the problem of metabolite identiﬁcation
into a task of variable selection, and develop a stochastic variable
searching scheme that explores the model space and identiﬁes highly
likely metabolites. Results are delivered in a format similar to
Chenomx.

3 METHODS

3.1 Preprocessing

We apply the following processing steps to raw 1H NMR spectra: (i) a simple
linear baseline is estimated and subtracted from each spectrum (Craig et al..
2006); (ii) reference deconvolution is applied to adjust the linewidth of the
peaks (Metz et al.. 2000); (iii) the spectra are normalized by the total sum
normalization (Zhang et al.. 2009); (iv) the spectra are aligned by recursive
segment-wise peak alignment in (Veselkov et al.. 2009). All other approaches
for baseline correction. normalization. spectrum alignment and downstream
statistical analysis can be used in conjunction with BQuant.

3.2 Database of candidate metabolites

For experimental datasets. we use an in-house database of experimental
spectra from 290 pure compounds. The spectra were acquired using
a 600MHz spectrometer. NOESY—presaturation sequence with a mixing
time of 100 ms. prescan delay of 1.00 s. 45 acquisition time and sample
temperature 25°C. Samples were prepared in H20 (with 10% D20. at
pH :65). For each metabolite. the database speciﬁes a reference 1H NMR
spectrum. the number of protons. the number of peaks derived from each
proton and the information on locations. linewidths and relative heights of the
peaks. Other databases. in particular the database available from Chenomx
NMR suite. can be used directly with the proposed approach.

3.3 BQuant: estimation of peak shifts

Locations of peaks in the spectra can deviate from the expected ppm. in the
database. even after the spectra are well aligned. This ‘positional uncertainty”
is experiment speciﬁc. and reference spectra need to be adjusted anew for
each dataset. Patterns of ‘positional uncertainty” are deﬁned by the chemical
structures of the metabolites. and follow speciﬁc rules. For example. the ﬁrst
two valine peaks in Figure 2 are generated by the same proton and form a
doublet. and the last two valine peaks form another doublet. All peaks in
a multiplet can shift to the left or to the right simultaneously by the same
amount; however. the relative distances between multiplets vary.

We View shifts between the expected and the observed peak locations as
unknown parameters. and estimate them from the spectra separately for each
metabolite. We then employ a straightforward heuristic searching scheme
for estimating peak location shifts. which amounts to solving a series of
restricted least-squares optimization problems by quadratic programming. A
more formal description of the approach is provided in the Supplementary
Materials.

3.4 BQuant: reduction of the observed spectra

The raw experimental spectra contain a large number of data points. stored in
ﬁles of up to 32 000 points per spectrum. To reduce the computational burden.
we select a local region of interest. We exclude from consideration the region
surrounding 4.7 p.p.m.. where signals from water dominate all other signals
from metabolites. We then replace the full-resolution spectra with a list of
ﬁxed peak locations. derived using a peak picking approach such as in Zhang
et al. (2009). as well as with the list of local minima between peaks. deﬁned
as the positions of bin edges determined by the Adaptive Intelligent Binning
algorithm (Meyer et al.. 2008).

3.5 BQuant: probability model for the spectra

Bayesian hierarchical model: suppose that we have observed n 1H NMR
spectra from n biological samples. We assume that all n samples are selected
from the same homogeneous population. and do not contain systematic
differences in abundances of metabolites. e.g. due to disease or treatment
groups. When the study contains multiple groups. BQuant is applied
separately to each group.

Suppose that each spectrum records intensities at peak locations or bin
edges at J positions in total. Let vector yl- denote the intensities of spectrum
i at these J positions andy =(yl’, . . . ,yi’, . . . ,yn’)’ denote the vector of length
J X n for all the spectra intensities from n spectra combined. Also suppose
that we have a database with reference spectra of L metabolites. adjusted for
‘positional uncertainty”. Let vector x, denote the intensities of the reference
spectrum of metabolite l at the same J positions. Let X=(x1 , . . .,xl, . . .,xL)
be the J X L design matrix formed by all the reference spectra combined.

We model the spectra as a linear combination of signals from multiple
sources. First. large molecules such as lipids can produce broad NMR
peaks. which may be Viewed as parts of the baseline but overlooked by the
preprocessing steps. We model such non-speciﬁc signals using a penalized
cubic B-spline. We denote as K the number of basis functions and as S the
J ><K design matrix corresponding to the cubic B-spline basis (Eilers and
Marx. 1996) and set the knots of the B-splines at locations of bin edges.

The remaining signals are generated by the metabolites in a database. and
we distinguish signals of systematic and of stochastic nature. Each systematic
source of signals represents the average relative strength of signal from
a metabolite. as compared with the other metabolites in all samples. The
stochastic source of signals reﬂects the biological variation of the metabolite
abundance across samples and the measurement error. Therefore. the overall
spectral signal yl- from a sample i can be represented as a linear combination
of signals from these sources:

yi=S¢+Xyﬂy +Xyai,y+€i (1)
“is! ~N(0~ 20w)

 

1 639

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”Idllq wort papeolumoq

9103 ‘Og anﬁnv uo ::

C.Zheng et al.

 

iid 2
61=(€i1.€i2.---.€i1).andéyN NIOJT)

i=1,2,...,n.j=1,2,...,J.

where x~D indicates that the random variable x has the probability
distribution D. The mixing parameters are the K -Vector ¢ of coefﬁcients of
the spline. the L-Vector 13 of average relative abundances of the metabolites
across all the samples and the L-Vectors oz,- of deviations of abundances of
the metabolites in sample i from the overall average levels. Parameter 13 is
the same for all the samples. and 01,- are sample-speciﬁc random variables.
and can be referred to. respectively. as ﬁxed and random effects. In other
words. the overall signal in a spectrum is represented by a linear mixed
effects model. 01,- deﬁne a hierarchical structure of variation through their
own probability distribution and covariance 20,. Since we simultaneously
consider the relative strength of the signal between different metabolites in
all samples. and the relative abundance of a metabolite across samples. the
design matrix is the same for both ﬁxed and random effects.

Only a subset of the metabolites in the database is present in the
sample and can produce signals. Therefore. Equation (1) deﬁnes a family
of models. Different instances of the family can be obtained by means of
indicator variable y. which speciﬁes the inclusion of individual metabolites.
Speciﬁcally. y =(y1 , . . . , yl, . . . , 11) deﬁnes the design submatrix Xy . the ﬁxed
and random effects 13;, and a,” . and the variance-covariance of the random
effects 20,”. which correspond to a particular subset of metabolites in the
database. Therefore. in the Bayesian framework. identifying metabolites in
the experiment is equivalent to searching the space of candidate models
(i.e. the space of indicator variables y) and ﬁnding models which have high
posterior probabilities.

Prior distributions of model parameters: due to the necessary adjustments
for ‘positional uncertainty”. columns of the design matrix X tend to be
correlated. Consequently. the posterior distribution of the candidate models
can be relatively ﬂat. At the same time. we are not interested in all the
candidate modes. but only in a subset of sparse models which explain the
spectra with a minimal number of abundant metabolites. We reﬂect our
preference for sparsity by a second indicator variable 8 =(81,...,81,...,8L).
which determines the practically signiﬁcant presence of the metabolites. The
indicator controls the prior distributions of 13 and 01,». helps obtain a more
peaked posterior distribution of y and enables inference. The setting is
motivated by the stochastic search variable selection for linear regression
proposed by George and McCulloch (1993) and extended by O”Hara
and Sillanpaa (2009). Additional discussion on this setting is provided in
Supplementary Materials. The priors for y and 8 are

..d ..d
Wilson). 61180221). 1:1,.-.L.

where B(-) denotes a Bernoulli distribution. and both hyperpararneters p1,,
and [72,, are predeﬁned constants. p1,, reﬂects our prior knowledge on the
inclusion probability of metabolite l. and larger values of [71,, yield more
selected metabolites. p2,, reﬂects our prior View of the practical signiﬁcance
of the average abundance of metabolite 1. For reasons of computational
tractability. we specify conjugate prior distributions of ¢. components of
the vector 13. submatrices of 2,, and (72 as follows:

1 /
PM) (X N(0~T¢IK)‘CXP(— 5W P¢) (2)
17030345) (X N(0.vr)103120)1(51=1)1(J/i=1)+
N(0.vo)103120)1(51=0)1(J/i=1).

1: 1,...,L (3)
Smash/.5 N IW(MO;;/,8~20;y,5) (4)
(72 ~ Emma.) (5)

Here p(x) cxf(x) indicates that the density function for the probability
distribution of x is proportional to f(x). i.e. is speciﬁed up to a constant.
1K is the K X K identity matrix. I(-) is indicator function. IW(;10;%3, 203,15)
is the Inverse Wishart distribution with degree of freedom 110mg and scale

matrix 20;“; and Ig(aa,bg) is the Inverse Gamma distribution with shape
a0 and scale by.

The prior distribution of ¢ in Equation (2) follows the proposal by Wood
(2006). which Views the baseline as an extension of the original penalized
B-spline (Eilers and Marx. 1996). The exact form of matrix P is given in
Supplementary Materials. The hyperparameter A in this distribution controls
the smoothness of the baseline. We select A Via an Empirical Bayes estimation
step. where we ﬁt the model in Equation (1) to the constructed spectrum
with median intensities as the response. and estimate A automatically by
generalized cross-validation (GCV) (Golub et al.. 1979).

The prior for each element 131 is conditional on metabolite inclusion.
It is speciﬁed as a Truncated Normal distribution. reﬂecting the positivity
constraints on the average abundance of the metabolites. The priors for 13
and ¢ are a direct extension of the setting proposed by Thompson and Rosen
(2008) for variable selection in linear mixed models. All the components of
13 and ¢ are assumed to be independent a priori. Hyperparameters v0 and V]
are predeﬁned constants. as in George and McCulloch (1993).

Equation (4) speciﬁes separate prior distributions for the variance-
covariance matrices of the subset of metabolites in the database Sony’s.
conditional on metabolite inclusion. The prior for 211;“; is made non-
informative as in Kass and Natarajan (2006). by assigning 110mg 2 21:1(1/1 -
81). and the sample variance-covariance matrix to 20;“;

Finally. the prior of (72 in Equation (5) is made non-informative by
assigning a0 and by to small values such as 0.001. Choice of all the
parameters is discussed in more details in Supplementary Materials.

Metabolite identiﬁcation as a variable selection task: the problem of
metabolite identiﬁcation is similar to Bayesian variable selection in linear
regression (Chipman et al.. 2001; George and McCulloch. 1997). and is
complicated by the inclusion of subject-speciﬁc random effects. It is also
similar to variable selection developed for Bayesian linear mixed models
and generalized linear models (Cai and Dunson. 2006; Chen and Dunson.
2003; Kinney and Dunson. 2007). where we automatically identify subsets of
predictors having non-zero coefﬁcients of ﬁxed effects or non-zero variances
of random effects. However. such approaches are not directly applicable to
the model in (1)45). as they treat ﬁxed and random effects separately. and
do not allow a simultaneous selection of variables that are both ﬁxed and
random effects.

An alternative variable selection approach has been proposed for
automatic selection of knot locations for B-spline. where a linear mixed
model restricts ﬁxed and random effects to be the same set of variables
representing knot locations (Thompson and Rosen. 2008). Although this
approach addresses a similar variable selection task. the model in (1)45)
is more comprehensive. It contains extra ﬁxed effects for baseline. non-
negativity constraints on the parameter space and additional indicator
variables for practical signiﬁcance controlling both ﬁxed and random effects.
Therefore. we propose a Gibbs sampling scheme to explore the high-
dimensional variable space. to obtain joint posterior probabilities for sets
of parameters. as well as marginal posterior probabilities for the statistical
and practical signiﬁcance of individual metabolites.

3.6 BQuant: Bayesian inference

Gibbs sampling scheme: denote 01 = (011,012, . . . ,un) the matrix containing all
the random effects for all the samples. and 01;, =(u11y,u2’y,...,an’y) the
submatrix of 01 where rows correspond to non-zero elements in y. 01y"; is a
submatrix of 01 where rows with correspond to non-zero elements in both y
and 8. The joint posterior distribution for 9 =(y,8,¢,}3y ,uy , 20,”,02) is:

17(9 Iv)<x
powwow) mommy IN) Muhammad” 1M) 1M)

The Gibbs sampling scheme iteratively samples from the following
conditional distributions.

 

1640

112 /3.ro's172an0[p.IOJxosotwurJOJurorq”:duq 11101} popeo1umoq

9103 ‘0g15n8nv uo ::

1H NMR spectra

 

(1) Sample ﬁxed effects (ﬂy,¢) from their conditional distribution:
[7(ﬂy v¢l7v 2a;y.02.y)

“MIA/(Hwy ~M¢>~Xﬁy.¢) '1q<y> (ﬂy Elmo) (6)

where MILK/111,2) denotes multivariate normal distribution with
mean u and variance-covariance matrix 2 and Iq(y)(V1 3 V2)
denotes a component-wise indicator function. The expressions for
up}, , [14, and 21;}, ,¢ are given in Supplementary Materials. The joint
posterior distribution of (ﬂy,¢) is a Truncated Multivariate Normal
distribution. primarily due the non-negativity constraint on 1%,.
Sampling from this distribution requires a separate Gibbs sampling
scheme. such as the one in Kotecha and Djuric (1999). We follow this
by the sampling of ¢ drawn from a Multivariate Normal distribution
conditional on 1%,.

(2

V

Sample random effects 01;, by drawing instances of all a,”
from their conditional distributions p(ai’y|ﬂ,y,02,2a;y,y)=
MVN(ui,a;y,Vl-,a;y) where my,” and V3,,” are given in
Supplementary Materials.

(3 Sample the variance of measurement error (72 from
p(c72|o(y,ﬂy,¢,y)=IQ(ca,da) where c17 and d, are given in

Supplementary Materials.

V

(4

V

Sample the variance-covariance matrix for random effects 20mm;
p(2a;y,8 Iu.y)=IW(Mo;y.8 +4 20w +dy.s’dy.s)

where a“; is the submatrix of 01 where only the rows corresponding
to both )4 = 1 and 81 = 1 are retained.

(5

V

Sample y from B(p(y1=1|y(_l),8,r72,2a,y)) where y(_l) is equal to
y excluding the l-th component. p(y1= 1|y(_1),8,02, Smy) is given
in Supplementary Materials. Only one component of y is updated at
this step for the current iteration and a different component will be
updated in the next iteration until every component of y is updated
once. Then the entire vector of y will be sampled component-wise
the second time.

(6) Sample 8. from 8070312104:1,y(_l),o(y,}3y,r72,Sunny» The
details of this distribution are given in Supplementary Materials.

Posterior inference: Gibbs sampling is continued N1, +N. iterations with
a burn-in period of Nb. We focus on the posterior distributions of the
parameters which are directly related to the identiﬁcation and quantiﬁcation
of metabolites in (1). These parameters include y for indicating the subset
of the metabolites in the database that are present with high probability. [3,
for average abundance of metabolite l and 111,,»=ﬁl+011, i for representing
the abundance of metabolite l in sample i. The parameters can be estimated
using two approaches. The ﬁrst involves model averaging (Madigan and
Raftery. 1994). where the parameters are estimated by their posterior means
and approximated by averaging over all draws of Gibbs sampling after the
initial burn-in period:

1 Nix-FM 1 Nb‘l'Nr
9:; Z r“): 13:; Z 3“)
S s:N;,-I—l S .::N,,+1
NII‘l'Nr
“FF 2 (ﬁ§“)+a§;‘?) <7)
“x:N,,+1

Alternatively. we can estimate y by the vector with largest posterior
probability among all vectors Visited by the Gibbs sampler (Sha et al.. 2006)

9 = argmaxiary‘“ I Y) (8)
y(s)

where p(y(s)|Y) is the relative frequency of y“). Equation (7) will be
primarily used for assessing the performance of BQuant in both identiﬁcation
and quantiﬁcation. Models with high probability identiﬁed by Equation (8)
will also be reported as a summary of the results.

4 DATASETS

Acquisition of NMR spectra: the experimental 1H NMR spectra were
obtained using the NOESYPR pulse sequence at 500MHz on a Bruker
Avance NMR spectrometer and utilizing a z-gradient HCN triple resonance
cryoprobe. Extensive details are provided in Supplementary Materials.

Simulated spectra: we simulate n=20 spectra with J: 100 intensities
per spectrum. The simulation follows the model in Equation (1); however.
additional noise signals are introduced to test for robustness. The simulated
spectra are constructed from four out of a total of eight candidate metabolites.

Spike-in experiment: a urine sample was collected from a healthy
male individual. according to a protocol approved by the Institutional
Review Board at Purdue University. Five metabolites (taurine. hippuric
acid. nicotinic acid. malic acid and oxoglutaric acid) were added to the
urine sample in varying concentrations. according to a latin square design.
These metabolites were chosen as they are potentially observable in urine
with 1H NMR; however. no noticeable abundance of these metabolites was
detected in this speciﬁc urine sample. Therefore. the sample will have little
interference on total abundances of these metabolites in the spiked mixtures.
Three replicate 1H NMR spectra were acquired from each mixture. For each
of the ﬁve spiked metabolites. we manually select a local region containing
pronounced peaks of the metabolite. The regions are listed in Table 3. and
an example is shown in Figure 1.

Metabolomic investigation of plasma samples: we analyze plasma
samples from 46 healthy individuals. The Institutional Review Board at
Indiana University approved the study protocol. and written informed
consent was obtained from all subjects before enrollment. Since the true
identities and abundances of metabolites in these samples are unknown. we
compare the ability of various methods to identify and quantify metabolites
against a benchmark of manual identiﬁcations by NMR experts. Moreover.
independent laboratory quantiﬁcation of one metabolite in these samples
(creatinine) was obtained as part of routine clinical care. and are available
for all the 46 samples. Thus. we evaluate the performance of statistical
methods in terms of agreement between the enzymatic (i.e. laboratory) and
NMR-based quantiﬁcations of creatinine.

We select two regions to demonstrate the application of BQuant.
which include 0.885271.04p.p.m. and 3.9243 ppm. The ﬁrst region
contains a moderate degree of peak overlap and a non-zero baseline. Peak
deconvolution is. therefore. particularly important for identifying these
metabolites. The second region contains the best-resolved creatinine peak.
Although the shape of the peak is well preserved. its signal is convoluted
with other signals. in particular with a broad lipid peak. These two regions
represent examples of typical real-life challenges in spectral interpretation.

5 RESULTS

We compared the performance of BQuant to representative instances
of three classes of fully automated methods in Section 2. Binning is
represented by the adaptive intelligent binning (AI binning) (Meyer
et (11., 2008). An instance of curve ﬁtting without a database is
the multiplicative update algorithm implemented in the R package
‘Non-negative matrix factorization (nmf)” (Liu, 2009), which we
abbreviate as MU-NMF. Both AI binning and MU-NMF cannot
automatically identify the metabolites, and cannot be compared
to BQuant in terms of identiﬁcation. Therefore, we attempted to
identify the bins (or the components of the deconvoluted mixtures)
manually whenever possible, to compare the performance of these
methods in terms of quantiﬁcation.

Curve ﬁtting with a database is represented by least-squares
deconvolution (LD) (Gipsona et (11., 2006), and enables a
simultaneous identiﬁcation and quantiﬁcation of metabolites. Since
the original implementation of LD does not account for a baseline,
this can negatively affect the performance of the method. Hence

 

1641

112 /3.ro's172an0[p.IOJxosotwurJOJurorq”:duq 11101} popeo1umoq

9103 ‘0g15n8nv uo ::

C.Zheng et al.

 

Bayesian quantification

a. @an  I171 511‘
t 1 r l
1” I l

 

 

Imensny

n
.'1

~ 1.» “L  '

 

 

 

 

n | r
T n
II 1‘ k . II in
r 1 . I'r 1J8“ AM '-‘
n_ j U Muff”; ‘38 ~ I '””'”\ 1'” 'l. 

Intensuy

 

 

 

 

 

 

 

Intensity

 

 

 

 

 

5 f‘ .‘l ””| "

i _=_ 1 I  11 f\/

g  ' ,1 I VJ \cﬁk,
:: maxi-- U Nix/.-   9‘

Fig. 3. Results of deconvolution of the spectrum in Figure 2. Black solid
line: original spectrum; black dashed line: ﬁtted spectrum; ﬂat grey solid line:
ﬁtted baseline; dashed lines in different grey level: each curve corresponds
to one component (one metabolite). The peaks corresponding to the three
major metabolites are annotated in the ﬁrst plot.

we also implemented a modiﬁed version of LD which, similarly
to BQuant, incorporates a sample-speciﬁc baseline using penalized
B-spline. This is accomplished by adding a term including the same
design matrix S as speciﬁed in model (1), and a sample-speciﬁc
coefﬁcient ¢,~, to the original formulation of LD. We refer to this
modiﬁed version as LD with baseline (LDBL). We applied both
LD and LDBL to the individual spectra in ﬁill resolution. Since the
methods are only applicable to the individual spectra, we compared
them to BQuant according to the list of most frequently identiﬁed
metabolites.

To reduce the computational complexity of BQuant, we used
LDBL for reduction of the size of the database. We chose Lmax =
35, since local regions typically do not contain more than 35
signiﬁcantly abundant metabolites.

5.1 Evaluation on the simulated spectra

Identiﬁcation accuracy: our goal was to identify the four true
metabolites out of the total of eight candidate metabolites. For LD
and LDBL, the model was ﬁt to each spectrum individually and
we inspected the top four metabolites with the highest estimated
abundance. For BQuant, according to Equation (8), the model with

Table 1. Identiﬁcation accuracy on the simulated dataset

 

Number of samples LD LDBL BQuant

 

All correct identiﬁcations/total 0/20 14/20 20/20

 

Each column shows the number of samples (out of 20 total), in which the methods
correctly identify all 4 simulated metabolites.

Table 2. Quantiﬁcation accuracy on the simulated dataset

 

 

R2 AI Binning LD LDBL BQuant
M1 0915 0.609 0.961 0975
M2 0.971 0.993 0.993 0.987
M3 0995 0.987 0.983 0.998
M4 0.977 0.984 0.997 0.996

 

Each row corresponds to one metabolite. The four columns list the R2 values for a simple
linear regression with no intercept, where the true abundance is used as the predictor,
and the quantiﬁed abundance as the response variable. A higher value indicates better
performance.

the highest posterior probability was the true model with four out
of eight metabolites selected. Table 1 compares the accuracy of
automated metabolite identiﬁcation by LD, LDBL and BQuant and
shows that identiﬁcation by BQuant outperforms these methods in
terms of accuracy of identiﬁcation.

Quantiﬁcation accuracy: to evaluate the quantiﬁcation accuracy
of AI binning, we manually selected bins dominated by signals from
the true simulated standard spectra. Supplementary Materials show
an example of MU-NMF deconvolution of one simulated spectrum.
It illustrates that the identiﬁed components are not immediately
interpretable in terms of the metabolites in the database, and cannot
be used for quantiﬁcation.

Successful quantiﬁcations should be linearly associated to the
theoretical abundance of the metabolites, with a 45-degree slope and
no intercept. The R2 of this linear model, ﬁtted separately for each
method of metabolite quantiﬁcation, are summarized in Table 2.
Overall, BQuant showed the best performance. A closer case-by-
case inspection revealed that metabolites with fewer peaks and lower
relative abundance were more difﬁcult to identify and quantify by
all methods.

5.2 Evaluation on the spike-in dataset

Identiﬁcation accuracy: LD, LDBL and BQuant could all identify
the ﬁve spiked metabolites from the spectra.

Quantiﬁcation accuracy: as in the case of simulated dataset, we
manually identiﬁed the bins resulting from the AI binning; however,
no manual identiﬁcation could be obtained for the output of MU-
NMF. After ﬁtting a linear regression model with no intercept,
the true abundance as the predictor and the quantiﬁed abundance
as the response for each method, the R2s are summarized in
Table 3. Overall, BQuant outperformed the other three methods.
The suboptimal performance of AI Binning was primarily due
to the contributions of tail areas from neighboring peaks to
the abundance of the bins. Since LD decomposes the spectrum
individually, and does not synthesize the information across samples,
it underperformed BQuant in regions with heavy overlap.

 

1642

112 /3.ro's112an0[p.IOJxosotwurJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g15n8nv uo ::

1H NMR spectra

 

Table 3. Quantiﬁcation accuracy on the spike-in experiment

 

 

R2 Region AI Binning LD LDBL BQuant
Taurine 33773.47 0.861 0.994 0.986 0.987
Hippuric acid 7.577.88 0.728 0.769 0.778 0.794
Nicotinic acid 8.278.404 0.975 0.991 0.999 0.999
Malic acid 23472.43 0.754 0.829 0.919 0.983
Oxoglutaric acid 24273.02 0.824 0.638 0.925 0.970

 

Each row corresponds to one spike-in metabolite. The ﬁrst column shows the selected
regions of the spectra in p.p.m. The other four columns list the R2 values for a simple
linear regression with no intercept, where the true abundance is used as the predictor,
and the quantiﬁed abundance as the response variable. A higher value indicates better
performance.

5.3 Application to the investigation of plasma samples

Identiﬁcation accuracy: the goal of the investigation is to accurately
identify and quantify metabolites in regions of 1H NMR spectra
from plasma samples of 46 subjects. The ﬁrst region of interest
in this dataset is 0.8852—1.04 p.p.m. Manual identiﬁcation of
metabolites, aided by Chenomx, reveals three major metabolites
(leucine, isoleucine and valine), and a local baseline created by
the lipid signal. Figure 3 illustrates the deconvolution of one of
the spectra in the region by MU-NMF, LD, LDBL and BQuant.
As can be seen in the ﬁgure, the components extracted by MU-
NMF were not immediately interpretable. They also conﬂicted
with manual interpretations of the spectra. The results of LD
are severely hampered by the presence of the baseline, which
is not properly accounted for by the model. Although leucine
and valine were identiﬁed as the two most abundant metabolites
across all the samples, isoleucine was not among the top three
most abundant metabolites in any of the 46 cases. The results of
LDBL have a higher agreement with the manual identiﬁcation;
however, isoleucine remained excluded from the list of three most
abundant metabolites in 15 out of 46 samples. This is due to a
small peak near 0.98 p.p.m., which was falsely decomposed as a sum
of peaks from two separate metabolites (butanone and isoleucine),
instead of from isoleucine alone. As shown in Table 4, BQuant
contains leucine, isoleucine and valine as components in the most
probable a posteriori model, and assigns them the largest estimates
of abundance. It is worth mentioning that manual identiﬁcation of
metabolites such as 2-aminobuyrate is challenging, as they typically
have a weak signal in a region that is occupied by other metabolites.

Similarly, imprecise results were obtained in the second region
of 3.9243 p.p.m. with MU-NMF, LD and LDBL. Table 4 shows
that BQuant automatically identiﬁed the metabolites, which were
manually conﬁrmed by NMR experts.

Quantiﬁcation accuracy: as in the previous cases, we manually
identiﬁed the bins resulting from the AI binning, but could not
identify the signals from the output of MU-NMF, to evaluate their
accuracy of quantiﬁcation. Table 5 shows the coefﬁcients of multiple
determination of the abundance of creatinine obtained by enzymatic
methodology , and derived by AI binning, LD, LDBL and BQuant
from the NMR spectra. Since creatinine has two peaks, two bins are
listed separately for AI binning, and the ﬁrst bin contains signals
from additional overlapped peaks. As can be seen, BQuant yields
the best quantiﬁcation result among all the methods.

Table 4. Identiﬁcation and quantiﬁcation of metabolites by BQuant in the
metabolomic investigation of plasma samples

 

Region Metabolite Mean 95% CI y 8 Conﬁrm

 

0.88527104 Valine 49.61 46.85 52.57 1.00 0.99 Yes
0.88527104 Leucine 20.05 16.80 23.28 1.00 1.00 Yes
0.88527104 Isoleucine 9.39 5.46 11.07 1.00 0.99 Yes
0.8852404 2-arni* 3.52 2.27 4.42 1.00 0.92 No
088524.04 Cholate 0.96 0.00 3.69 0.57 0.21 NO

39243 Lactate 15.27 0.00 19.81 0.90 0.90 Yes
3.924.3 Creatinine 7.98 0.00 10.81 0.89 0.88 Yes
3.924.3 Serine 6.57 0.00 9.13 0.85 0.85 Yes
3.924.3 Cysteine 2.50 0.00 6.61 0.54 0.50 NO
39243 Threonine 2.27 0.00 3.71 0.77 0.65 Yes
3.924.3 3-hyd* 1.94 0.00 3.84 0.73 0.52 Yes

3.9243 Proline 1.73 0.00 4.88 0.72 0.42 Yes
3.9243 Cholate 1.51 0.00 5.66 0.42 0.34 No
3.9243 2’-de0* 0.65 0.00 3.92 0.66 0.13 No
3.9243 AMP 0.54 0.00 2.59 0.36 0.12 No

 

The table shows all the metabolites with the highest posterior probability, along with
their posterior mean and 95% credible interval. y and 8 are frequencies of y, = 1 and 8, =
1 after the bum-in period. In the second column, 2-ami* = 2-aminobutyrate; 3-hyd* = 3-
hydroxybutyrate; 2’-deo* =2’-deoxyguanosine. The last column indicates whether the
metabolite identiﬁcation is manually conﬁrmed by NMR experts.

Table 5. Quantiﬁcation accuracy of creatinine in the investigation of plasma
samples. in terms of coefﬁcient of multiple determination R2 between
enzymatic laboratory measurements and by NMR-based quantiﬁcations

 

Creatinine AI Binning 1 AI Binning; LD LDBL BQuant

 

R2 0.209 0.547 0.477 0.475 0.718

 

Higher values indicate better performance. AI Binning] corresponds to the integral
between bin edges 30012730196 p.p.m.; AI Binning; corresponds to the integral
between bin edges 4.0109 4.0329 p.p.m.

6 CONCLUSION

Database-based identiﬁcation and quantiﬁcation of metabolites from
1H NMR spectra attracts growing attention. However, there is
currently no fully automatic way of assisting this labor-intensive
procedure. We developed a probabilistic approach BQuant, which
combines linear mixed modeling and Bayesian model selection, and
automatically identiﬁes and quantiﬁes metabolites in local regions
of spectra. At the same time, the model used in BQuant is more
complex than the standard linear mixed models, as it accounts for
the specialized characteristics of NMR spectra. To the best of our
knowledge, BQuant is the ﬁrst application of linear mixed modeling
to the database-based 1H NMR spectra deconvolution.

BQuant outperformed the existing automated approaches in terms
of accuracy of both identiﬁcation and quantiﬁcation of metabolites.
The improved performance is achieved for two reasons. First, the
problems of identiﬁcation and quantiﬁcation of metabolites are
interrelated, in particular in regions with heavy peak overlap. Unlike
many other methods, which solve these problems sequentially,
BQuant identiﬁes and quantiﬁes the metabolites simultaneously
and iteratively, by means of Gibbs sampling. Therefore, accurate
identiﬁcation of peaks helps improve the accuracy of quantiﬁcation,
and well-quantiﬁed metabolites help identify the sources of the

 

1643

112 /3.ro's112an0IpJOJxosotwurJOJurorq”:duq 111011 popeo1umoq

9103 ‘0g anBnV uo ::

C.Zheng et al.

 

additional peaks. The second reason for the improved performance
of BQuant is that, unlike many other approaches, it simultaneously
models the entire collection of spectra. This allows us to incorporate
the maximal amount of information into parameter estimation and
inference. When the set of spectra is highly heterogeneous, BQuant
could potentially produce less accurate results. However, such a
case will be challenging for any automatic approach. Finally, the
implementation of BQuant is practical and useful, and can be easily
integrated with other automated data analysis pipelines.

Funding: National Institutes of Health (NIH) (grants
R01GM085291, 5K23RR019540 and ULlRR025761); Indiana
University Signature Center Initiative; Indiana 21st Century
Research & Technology Fund; Bisland Dissertation Fellowship
from Purdue University (to C.Z.).

Conﬂict of Interest: none declared.

REFERENCES

Alsmeyer,F. and Marquardt,W. (2004) Automatic generation of peak-shaped models.
Appl. Spectrosc., 58, 98&994.

Alves,A. et al. (2009) Analytic properties of statistical total correlation spectroscopy
based information recovery in 1H NMR metabolic data sets. Anal. Chem, 81,
207572084.

Anderson,P. et al. (2009) Characterization of 1H NMR spectroscopic data and the
generation of synthetic validation sets. Bioinformatics, 25, 299273000.

Brelstaff,G. et al. (2009) Bag of peaks: interpretation of NMR spectrometry.
Bioinformatics, 25, 2587264.

Cai,B. and Dunson,D. (2006) Bayesian covariance selection in generalized linear mixed
models. Biometrics, 62, 446457.

Chen,Z. and Dunson,D. (2003) Random effects selection in linear mixed models.
Biometrics, 59, 7627769.

Chen,H. etal. (2006) Combining desorption electrospray ionization mass spectrometry
and nuclear magnetic resonance for differential metabolomics without sample
preparation. Rapid Commun. Mass Spectrom, 20, 157771584.

Chipman,H. et al. (2001) The practical implementation of Bayesian model selection.
IMS Lect Notes Monogr Ser, 38, 677131.

Cloarec,O. et al. (2005) Statistical total correlation spectroscopy: an exploratory
approach for latent biomarker identiﬁcation from metabolic 1H NMR data sets.
Anal. Chem, 77, 128271289.

Craig,A. et al. (2006) Scaling and normalization effects in NMR spectroscopic
metabonomic data sets. Anal. Chem, 78, 226272267.

Crockford,D. et al. (2005) Curve-ﬁtting method for direct quantitation of compounds
in complex biological mixtures using 1H NMR: application in metabonomic
toxicology studies. Anal. Chem, 77, 45564562.

Eads,C. et al. (2004) Molecular factor analysis applied to collections of NMR spectra.
Anal. Chem, 76, 198271990.

Eilers,P. and Marx,B. (1996) Flexible smoothing with b-spline and penalties. Stat. Sci.,
11, 897102.

Emst,R. et al. (1990) Principles of Nuclear Magnetic Resonance in One and Two
Dimensions. Oxford University Press, USA.

George,E. and McCulloch,R. (1993) Variable selection via Gibbs sampling. J. Am. Stat.
Assoc., 88, 8817889.

George,E. and McCulloch,R. (1997) Approaches for Bayesian variable selection. Stat.
Sm, 7, 3397373.

Gipsona,G.T. et al. (2006) Weighted least-squares deconvolution method for discovery
of group differences between complex bioﬂuid 1H NMR spectra. J. Magn. Reson.,
183, 2697277.

Golub,G. et al. (1979) Generalized cross-validation as a method for choosing a good
ridge parameter. Technometrics, 21, 2157223.

Gowda,G. et al. (2008) Metabolomics-based methods for early disease diagnostics: a
review. Exp. Rev. Mol. Diagn., 8, 6177133.

Kass,R. and Natarajan,R. (2006) A default conjugate prior for variance components
in generalized linear mixed models (comment on article by browne and draper).
Bayesian Anal, 1, 5357542.

Kinney,S. and Dunson,D. (2007) Fixed and random effects selection in linear and
logistic models. Biometrics, 63, 6907698.

Kotecha,J. and Djuric,P. (1999) Gibbs sampling approach for generation of truncated
multivariate gaussian random variables. Proc. Acoust. Speech Signal Process, 3,
175771760.

Laatikainen,R. et al. (1996) A computational strategy for the deconvolution of NMR
spectra with multiplet structures and constraints: analysis of overlapping 136-211
multiplets of 13c enriched metabolites from cell suspensions incubated in deuterated
media. Magn. Reson. Med, 36, 3597365.

Liu,S. (2009) NM FN: Non-Negative Matrix Factorization. R package version 1.0. 2009-
11-24. Available at http://CRAN.R-project.org/package=NMFN

Madigan,D. and Raftery,A. (1994) Model selection and accounting for model
uncertainty in graphical models using occam”s window. J. Am. Stat. Assoc., 89,
153571546.

Metz,K. et al. (2000) Reference deconvolution: a simple and effective method for
resolution enhancement in nuclear magnetic resonance spectroscopy. Concepts
Magn. Reson., 12, 2142.

Meyer,T.D. et al. (2008) NMR-based characterization of metabolic alterations in
hypertension using an adaptive, intelligent binning algorithm. Anal. Chem, 80,
378373790.

Nicholson,J. et al. (1999) ‘metabonomics’: understanding the metabolic responses of
living systems to pathophysiological stimuli via multivariate statistical analysis of
biological NMR spectroscopic data. Xenobiotica, 29, 118171189.

Ochs,M. et al. (1999) A new method for spectral decomposition using a bilinear
Bayesian approach. J. Magn. Reson., 137, 1617176.

O”Hara,R. and Sillanpaa,M. (2009) A review of Bayesian variable selection methods:
what, how and which. Bayesian Anal, 4, 857118.

Sha,N. et al. (2006) Bayesian variable selection for the analysis of microarray data with
censored outcomes. Bioinformatics, 22, 226272268.

Silverstein,R. et al. (2005) Spectrometric Identiﬁcation of Organic Compounds, 7th
edn. Wiley, USA.

Soininen,P. et al. (2005) Strategies for organic impurity quantiﬁcation by 1H NMR
spectroscopy: constrained total-line-shape ﬁtting. Anal. Chim. Acta, 542, 1787185.

Stoyanova,R. et al. (2004) Sample classiﬁcation based on Bayesian spectral
decomposition of metabonomic NMR data sets. Anal. Chem, 76, 366&3674.

Thompson,W. and Rosen,O. (2008) A Bayesian model for sparse functional data.
Biometrics, 64, 5443.

Ulrich,E. et al. (2008). Biomagresbank. Nucleic Acids Res., 36, D4027D408.

Veselkov,K. et al. (2009) Recursive segment-wise peak alignment of biological 1H
NMR spectra for improved metabolic biomarker recovery. Anal. Chem, 81, 5&66.

Weljie,A. et al. (2006) Targeted proﬁling: quantitative analysis of lH-NMR
metabolomics data. Anal. Chem, 78, 4430—4442.

Wishart,D. (2008) Quantitative metabolomics using NMR. Xenobiotica, 29, 118171189.

Wishart,D. et al. (2007) HMDB: the human metabolome database. Nucleic Acids Res.,
35, D5217D526.

Wood,S. (2006) Generalized Additive Models: an Introduction with R. Chapman and
Hall, USA.

Zhang,S. et al. (2009) Interdependence of signal processing and analysis of urine 1H
NMR spectra for metabolic proﬁling. Anal. Chem, 81, 60804088.

 

112 /310's112111n0fp101x0'so1112111101u101q//:duq 111011 popeo1um0q

9103 ‘0g15n8nv uo ::

