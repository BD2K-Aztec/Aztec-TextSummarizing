BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Systematic comparison of RNA-Seq normalization methods

 

the expression level measurements generated by a normalization
method with the ‘true’ expression levels. The second aspect is
whether a normalization method would produce consistent
measurements when it is applied to RNA—Seq data of same bio—
logical condition generated from different experiments. In previ—
ous RNA—Seq studies, two major criteria are used for assessing a
normalization method following the schema proposed by
Irizarry et a]. (2005), which are referred to as the precision and
accuracy criteria. The precision of a method is defined to be the
correlation between measurements from replicated experimental
runs, and the accuracy is defined to be the correlation coefficient
of the expression level measurements generated by the method
with a gold standard. The expression measurements from a dif—
ferent platform are usually used as the gold standard.

These two criteria are intuitive and popularly used. The pre—
cision criterion can assess the consistency between repeated ex—
perimental runs. However, the validity of using the accuracy
criterion to evaluate the performance of a RNA—Seq normaliza—
tion method depends on how accurate the gold standard is.
Currently, in the reported comparison studies of RNA—Seq nor—
malization methods, polymerase chain reaction (PCR)—based
technology and Microarray are two common choices of the
gold standard. Microarray is known to suffer from various
types of bias and variation. Although many normalization meth—
ods have been proposed for Microarray data, variations and
biases in Microarray data cannot be completely eliminated.
PCR—based technology is well acknowledged to be of high ac—
curacy, but it is still subject to errors. It has been pointed out that
there exist a number of factors that contribute variations to PCR
data, including primer41imer accumulation, PCR product rean—
nealing and DNA polymerase binding to primers (Brownie et al.,
1997). It is known in statistics that when the gold standard is
subject to measurement errors (MEs), directly using the correl—
ation coefficient with the gold standard to evaluate a normaliza—
tion method can be inadequate. Unfortunately, a gold standard
free of MEs may never be available due to the complexity
involved in transcriptome study.

A statistically more appropriate approach to assessing differ—
ent normalization methods is to directly estimate the bias and
variance of the normalized RNA—Seq measurements using ME
models. A system of such ME models lately was used to calibrate
RNA—Seq and Microarray gene expression level measurements
with Real—time reverse transcription polymerase chain reaction
(qRTiPCR) for more accurate transcriptome profiling (Z.Sun
et al., unpublished manuscript). Through the system, the biases
and variances from qRTiPCR, Microarray and RNA—Seq can
be estimated. In this article, we further utilize the system to
facilitate the comparison of different RNA—Seq normalization
methods. We applied the developed approach to compare
five existing RNA—Seq normalization methods, which are
RPKM, GPseq, mseq, GCR and PMseq, using gene expression
data of two RNA samples from the MicroArray Quality
Control (MAQC) and Sequencing Quality Control (SEQC)
projects.

2 METHODS

We assume the expression levels of n genes are measured by different
laboratories using qRTiPCR, Microarray and RNA-Seq. Speciﬁcally,

k1 laboratories use qRTiPCR, k2 laboratories use Microarray and k3
laboratories use RNA-Seq. The laboratories are assumed to be independ-
ent with each other. We also assume each laboratory generates one ex-
pression measurement for each gene. When technical replicates are
available within one laboratory, the average value across replicates is
used as the expression measurement of a gene.

Raw data generated by qRTiPCR and Microarray are denoised using
standard platform-speciﬁc normalization methods such as the delta Ct
method (qRTiPCR) and the Robust Multichip Average method
(Microarray). We use X:  :j: 1, ...,n; k: 1, ...,k1} to denote
the normalized qRTiPCR gene expression measurement data, where Xjk
is the qRTiPCR measurement of gene j from the kth laboratory.
Similarly, Y: {YJ-A. :j = 1, ...,n; k = 1, ...,k2} denotes the normalized
Microarray gene expression measurement data.

Let L be the number of RNA-Seq normalization methods we want to
compare, and let I = 1, ...,L be the indices for these normalization
methods. The RNA-Seq raw data consist of the mapped short reads.
By applying the L normalization methods to the RNA-Seq raw data, L
sets of normalized RNA-Seq gene expression measurement data can be
generated. We use 2(1) 2 {21km :j: 1, ...,n; k = 1, ...,k3} to denote
the normalized RNA-Seq data by the 1th method.

At the end, L+2 sets of gene expression measurement data are gen-
erated, including the qRTiPCR data X from In laboratories, the
Microarray data Y from k2 laboratories and L sets of RNA-Seq data
2(1), ...,Zm from k; laboratories.

As discussed in Section 1, qRTiPCR, Microarray and RNA-Seq are
all subject to MEs. It is well known that MEs can become heteroscedastic,
that is the size or variance of an ME depends on the magnitude of the
targeted quantity. This is, in general, the case for the measurement data
X, Yand 2(1) for l = 1, . . . , L. One popularly used approach for handling
heteroscedasticity in practice is to apply Box£ox transformations. In
particular, base 2 logarithmic transformation (log-2) is often used to
transform original gene expression measurements in the literature on
gene expression data analysis, and in the resulting data, the heteroscedas-
ticity can be mitigated. In this article, we follow the convention to trans-
form X, Y and 2(1) using log-2 and use the transformed data in analysis.
For ease of representation and discussion, we still use X, Y and 2(1) to
refer to the log-2 transformed data in the rest of the article.

For each I, the combined data of X, Y and 2(1) can be characterized by
a system of ME models.

Xjk =Mj+K1j+711jk, (1a)
ij =02 +ﬁ2Mj+K2j+JT2jk, (“3)
21M!) = 011(1) + ,33.(l)l1«j + K3110) + 713,110)- (19)

In the aforementioned system, M denotes the underlying expression level
of gene j, which is treated as a ﬁxed but unknown quantity, a2 and [32 are
the intercept and slope in the linear relationship postulated between u]-
and the Microarray measurements, and 011(1) and [31(1) are the intercept
and slope in the linear relationship postulated between W and the normal-
ized RNA-Seq measurements by the 1th method.

The other terms in system (1) represent MEs attributed to various
sources. There exist two major types of MEs, which are errors due to
platforms and errors due to laboratories. In model (1a), K1 1- represents the
ME due to the qRTiPCR platform and 711 17‘. the ME due to laboratories
in Xjkr. We assume ijS are i.i.d. N(0, git?) and 711ij are i.i.d. N(0,  In
model (1b), sz represents the ME due to the Microarray platform and
71sz the ME due to laboratories in ijr. We assume szs are i.i.d. N (0, 1%)
and JszkS are i.i.d. N(0,  In model (1c), K3110) represents the ME due to
the RNA-Seq platform and 713jk_([) the ME due to laboratories in 2117.0).
We assume K3j_(])S are i.i.d. N(0, $30)) and JIMMS are i.i.d. N(0, gim).

In the system, ujs are referred to as incidental parameters, and the
other parameters are referred to as structural parameters. We further

 

2585

ﬁm'spzumofpmjxo'sopeuuopnoiq/ﬁdnq

Z.Sun and Y.Zhu

 

divide the structural parameters into two groups as follows. The
ﬁrst group consists of the parameters related to the normalized
RNA-Seq measurements, which are collected and denoted as
0(1) 2 [mum/33.0), 1kg“), gin] . The second group consists of the struc-
tural parameters related to qRTiPCR and Microarray measurements,
which are collected and denoted as w = [012, [32, M, glz, 1kg, §%]T.
Consistent estimates of the structural parameters can be found by treating
MS as i.i.d. normal random variables. The estimation method was
originally discussed in Barnett (1969), and the explicit formulas of the
estimates and their standard errors can be found in Z.Sun et a]. (unpub-
lished manuscript). The estimates of these two groups of structural par-
ameters based on the combined data of X, Y and 2(1) are denoted as 3(1)
and 6(1).

The vector 0(1) reﬂects the quality of the normalized RNA-Seq meas-
urements by the 1th method. As discussed in Section 1, the RNA-Seq raw
data are known to suffer from various types of variation and bias. The
purpose of normalization is to reduce variation and bias in the original
data and produce more accurate and consistent measurements. Thus 0(1)
represents the remaining variation and bias in the normalized RNA-Seq
measurements by the 1th method, and it can be used to characterize the
performance of the 1th normalization method. Furthermore, the L nor-
malization methods can be compared by comparing 0(1) for l = 1, . . . , L.
In general, the smaller the remaining bias and variation are, the better the
normalization method.

The total remaining variance of ijﬂ) is $30) + g3“), where $30) is
the remaining variability due to the RNA-Seq platform and g3“) is the
remaining variability due to the laboratories. The variation due to the
RNA-Seq platform can be attributed to a variety of factors, such as the
library preparation method, the base calling method and the mapping
method. $30) and g3“) together characterize the reproducibility of the
normalized RNA-Seq measurements by the 1th method. In the rest of the
article, we simply refer to $30) and gig) as the RNA-Seq variance and
the laboratory variance of the 1th method, respectively.

Under the system of ME models, the bias of 21M!) from W is
011(1) + ([310) — 1)uj, which is a linear function of m. When 011(1) 2 0
and [31(1) 2 1, the normalized RNA-Seq measurements by the 1th
method are unbiased; otherwise, they are biased with 011(1) and [31(1)
representing the location bias and the scale bias of the normalized
RNA-Seq measurements, respectively. The absolute value of 011(1) and
[31(1) — 1 can be used to characterize the biases of the 1th RNA-Seq nor-
malization method.

We can compare the performances of the L normalization methods
by applying pairwise comparison with the components of 3(1) for different
I. For example, to compare the scale biases of the ﬁrst and the second
normalization methods, we need to test the null hypothesis
H0: [31(1) ? [3342). The test statistic iS Z 2 [31(1) — [3342”
se(ﬁ3.(1) — ,33.(2)), where se denotes the standard error. 2 approximately
follows the standard normal distribution under H0.

To carry out the test, we need to resolve one more difﬁculty, which is
the dependence between 3(1) for different I. For instance, in the aforemen-
tioned example, [31(1) and [31(2) are correlated, but the estimate of their
covariance is not available. Thus se (31(1) — 31(2)) is not available. Here,
we propose to use a bootstrap procedure to overcome this difﬁculty. Let
B be the number of bootstrap samples; in this article, we set 13:500.
Each bootstrap sample is generated by sampling n genes with replacement
from the n genes. Let X(,,), Y(,,) and 201,) (l = 1, . . . , L) be the qRTiPCR,
Microarray and RNA-Seq measurements, respectively, of the bth boot-
strap sample. The corresponding estimates of [31(1) and [31(2) based on
the bth bootstrap sample are denoted by 33.01,) and 334”). Let

Sﬁz.l.2 = [‘Yﬁl‘a‘” ‘Yﬁ3‘(1‘2):| be the sample variance and covariance
7 5133.01) Sﬁ3~(2~2)

matrix of {33AM : b = 1, ...,B} and {Elam : b = 1, ...,B}. Then

se(/§3j(1) — 31(2)) iS estimated by

 

Sm.<1.1>+5m.<2.2> — 25193.01)-

Note that a) does not depend on I, therefore the L sets of estimates 6(1)
for l = 1, . . . , L are expected to be coherent with each other. If one set of
estimates is incoherent with the others, it indicates that the corresponding
normalization method may not be appropriate and needs further inves-
tigation. Therefore, it is always required to check the coherence between
6(1) before further analysis.

To sum up, the steps for systematically comparing the L RNA-Seq
normalization methods can be described as follows:

(1) Conduct qRTiPCR, Microarray and RNA-Seq experiments using
the same RNA sample to generate the raw expression data of n
genes.

(2) Apply the standard normalization methods to generate the normal-
ized qRTiPCR data X and the normalized Microarray data Y.
Apply the L RNA-Seq normalization methods to the RNA-Seq
raw data separately and generate L sets of normalized RNA-Seq
data 2(1) (1 = 1, ...,L). Apply the log-2 transformation to X, Y
and 2(1) (1 = 1, ...,L) and still denote the resulting data as X, Y
and 2(1) (1 = 1, . . . ,L) for simplicity of discussion.

(3) Apply the system of ME models to each combination of X,\Y and
2(1) and calculate the estimates of the structural parameters 0(1) and
(4) Check the coherency of 6(1) for different I.

(5) Compare the L RNA-Seq normalization methods by comparing
0(1) component-wise and draw conclusions.

2.1 Single versus multiple laboratories

In system (1), the presence of multiple laboratories for a platform enables
the separation of the ME due to the platform from the ME due to
laboratories. For the purpose of comparing different RNA-Seq normal-
ization methods, however, only RNA-Seq is required to have data gen-
erated from multiple laboratories. In the real dataset used later in this
article, both Microarray and RNA-Seq data are from multiple labora-
tories, and qRTiPCR only has data from one laboratory (k1 = 1). Such a
scenario is common in transctriptome studies since qRTiPCR is not a
massive parallel technology, and its cost is relatively high. When k1 = 1,
the ME due to qRTiPCR (K1 1) and the ME due to the laboratory (7111-1)
are not separable, and their variances cannot be estimated separately.
Instead, the combined variance r12 2 (it? + glz can be estimated, and a)
needs to be modiﬁed to w = [om/32, r12, ([12, §%]T; see Z.Sun et a]. (un-
published manuscript) for more details. This fortunately does not affect
the estimation of the other structural parameters, in particular, those in
0(1), which are related to the quality of the normalized RNA-Seq meas-
urements, and thus does not affect the comparison between different
RNA-Seq normalization methods.

2.2 Correlation coefficients

Next, we show that treating qRTiPCR or Microarray as the gold stand-
ard and using correlation coefﬁcient to assess the performance of a
RNA-Seq normalization method can be insensitive and non-informative.
Suppose qRTiPCR is used as the gold standard. Let A. be the grand
mean of all qRTiPCR measurements in the kth laboratory, and 214(1)
the grand mean of the RNA-Seq measurements in the k’th laboratory.
For convenience, in the following discussion, we use qRTiPCR data
from one laboratory and RNA-Seq data from one laboratory as an ex-
ample. Under the system of ME models, the correlation coefﬁcient of
qRTiPCR measurements and RNA-Seq measurements normalized by
the 1th method is

 

2586

ﬁre'spzumoipmjxo'sopeuuopnoiq/ﬁdnq

Systematic comparison of RNA-Seq normalization methods

 

Z (Zn/.0) — Z—i’.<l>)(Xjk - Xi»)

 

rsz = _ _ _
2(ij’.<l> — Z.A»’.<I>)ZZ(XJ-i — X02
A (2)

   
 

—>

      

Vim/#3541; 2 2
(A + 133.0; (A + w] + g1)

where A = W1 21.01,]- — ﬂ)2, which can be considered the variance of
Ms, and —> means convergence in probability as n —> 00. First, A exists
in both the denominator and the numerator of rm. 1. When A is dominant
in magnitude, rsz can be insensitive to the other terms. In the cases
where A is extremely large, rsz is close to 1, and the correlation coefﬁ-
cients fail to discriminate between different RNA-Seq normalization
methods. Second, since A, (it? and g12 do not depend on i, the differences
between rsz for different i are determined by 17 = lira“) + gin/[33(1),
which is a function of the variances and biases of the 1th normalization
method. Therefore, the correlation coefﬁcient-based approach for com-
paring different normalization methods does not provide detailed infor-
mation about the variances and biases of the compared methods, and
thus it is not as informative as the proposed approach.

3 DATASETS

To compare the performances of the ﬁve existing RNA—Seq nor—
malization methods mentioned in Section 1, we used the qRTi
PCR, RNA—Seq and Microarray expression data of two RNA
samples from the MAQC and SEQC projects. The two RNA
samples are the human brain reference RNA sample (Brain) and
the human universal reference RNA sample (UHR). Their qRTi
PCR, Microarray and RNA—Seq data were generated by
TaqMan® Gene Expression Assays, Affymetrix U133 Plus2.0
and Illumina Genome Analyzer, respectively.

3.1 Real-time reverse transcription polymerase chain
reaction

The TaqMan qRTiPCR data were generated by one laboratory.
It can be downloaded at Gene Expression Omnibus (GEO)
under series number GSE5350. In total, 1001 genes were mea—
sured in each of the UHR sample and Brain samples, and each
gene was measured in four replicates. The genes with multiple
entries in the original datasets were removed to avoid ambiguity.

3.2 RNA-Seq

The RNA—Seq data were produced from two different experi—
ments, which were conducted in two different laboratories.
Data from the first experiment (Bullard et al., 2010) can be
downloaded from National Center for Biotechnology
Information (NCBI) Sequence Read Archive (SRA) under acces—
sion number SRA010153, and data from the second experiment
can be downloaded under accession number SRA008403 from
the same website. In the following discussion, we use the acces—
sion numbers to refer to these two datasets. Short reads from
SRA010153 are 35 base—pair long, and reads from SRA008403
are 31 base—pair long. We aligned the short reads to UCSC hg19
reference genome using Bowtie 0.12.7 (Langmead et al., 2009).
We allowed up to two mismatches and only counted the uniquely
mapped reads. The mapped reads were then assigned to genes
using the Reference Sequence (RefSeq) database. The region of
each gene was deﬁned as the union of all its exon regions. To

avoid confusion, we only kept the non—overlapping genes. At the
end, for SRA010153, we obtained 274 million reads per lane, and
for SRA008403, we obtained 0.7418 million reads per lane. The
multiple lanes in the RNA—Seq experiments were treated as the
technical replicates. In SRA010153, both the UHR and Brain
samples have seven replicates; In SRA008403, the Brain sample
has seven replicates and the UHR sample has three replicates.
The numbers of replicates for the UHR sample were different in
the two laboratories. This unevenness will much complicate the
subsequent analysis. Therefore, we decided to use three lanes of
SRA010153 for the UHR sample. We tried different combin—
ations of three lanes and found the analysis results were similar.
Therefore, we only report the results based on the ﬁrst three
lanes of SRA010153 later on in the article. For each of the
UHR and Brain samples, we only kept those genes that receive
at least one read in each lane of the two RNA—Seq experiments.

RNA—Seq reads data were then processed using ﬁve normal—
ization methods, RPKM, GPseq, mseq, GCR and PMseq. We
use I = 1, 2, 3, 4 and 5 as the indices for these five methods and
Z“) to denote the normalized RNA—Seq data by the lth method.
The R package ‘GPseq’ (Srivastava and Chen, 2011) was used to
obtain 2(2). The R package ‘mseq’ (Li, 2011) was used to obtain
2(3). When using mseq, the top 100 single isoform non—
overlapping genes with highest RPKM expression levels were
used in training, and the neighborhood of a base—pair was
deﬁned to include 25 nucleotides to its left and 15 nucleotides
to its right, and model ﬁtting and prediction were performed in a
lane—by—lane fashion. We used the regression normalization
method in Risso et a1. (2011) to obtain 2(4), where the GC con—
tent of each gene was calculated using the RefSeq Genome data—
base. A R script provided by the authors of Wu et a]. (2012) was
used to obtain the PMseq normalized data 2(5).

3.3 Microarray

The Affymetrix Microarray data were generated by five different
laboratories. The probe level data were normalized by Probe
logarithmic Intensity Error (PLIER) method, and it can be
downloaded from GEO under series number GSE5350. Probes
were mapped to genes using their RefSeq IDs. The mean of the
expression levels of the probes mapped to gene j is used as the
expression level of gene j.

3.4 Standardization

For measurements from all three platforms, the log—2 transform—
ation was applied to generate the transformed data. We use genes
that overlap in all laboratories of all three platforms, and genes
with extremely low and extremely high expression level (i.e.
qRTiPCR expression measurements below 76 or above 4 in
log—2 scale) were excluded. At the end, the UHR sample included
477 genes, and the Brain sample included 409 genes. For each I,
the normalized RNA—Seq data Z“) by the lth method were fur—
ther standardized in a laboratory—by—laboratory manner as fol—
lOWS. Z}le = ij‘U) — Z.k‘(/)/SZk‘(/) SX + X, where  and SX
denote the sample mean and sample standard deviation of all
qRTiPCR measurements, ZULU) and SZW denote the sample
mean and sample standard deviation of the normalized
RNA—Seq measurements in the kth laboratory, and U) is
the standardized RNA—Seq measurement. The Microarray data

 

2587

ﬁle'spzumoipmjxo'sopeuuopnoiq/ﬁdnq

Z.Sun and Y.Zhu

 

from each laboratory were standardized in a same way. After the
standardization, all the resulting expression level measurements
were of the same scale.

4 RESULTS
We applied the system of ME models to analyze the ﬁve com—
binations of X, Y and Z“) for I = 1, . . . , 5 separately to compare

the five RNA—Seq normalization methods. Estimates of the
structural parameters were divided into two groups, denoted
by a“) and 6“), according to the discussion in Section 2. In
this section, we first report diagnostic results regarding the as—
sumptions imposed on the MEs. Second, we examine the coher—
ence of ads for different l’s. Third, we provide detailed
comparison of the ﬁve RNA—Seq normalization methods based
on a“). At the end of this section, we show that the comparison
between the ﬁve normalization methods based on correlation
coefﬁcients is insensitive and non—informative.

4.1 Diagnostics of model assumptions

The system of ME models assumes that the involved MEs are
normal random variables with homoscedastic variances, that is,
it imposes the normality and homoscedasticity assumptions on
the MEs. We use residuals and diagnostic tools to check these
two assumptions in the subsequent sections. After the system of
ME models is fitted, two types of residuals can be calculated,
which are the residuals corresponding to the MEs due to a plat—
form (platform residuals) and the residuals corresponding to
the MEs due to a laboratory (laboratory residuals). The plat—
form residuals for qRTiPCR, Microarray and RNA—Seq can
be calculated by em [j =  — [2),6K‘2j =  — 072 — 32/2} and
em, =  — (Q3 — 33/2], respectively. The laboratory residuals
in Microarray and RNA—Seq can be calculated by
6,12% = ij —  and em 31k = ij —  To check the normality
assumption, we generated the QQ plots for the residuals and did
not detect signiﬁcant violation of the assumption. To check the
homoscedasticity assumption, we generated residual plots and
constructed approximate 95% conﬁdence intervals for Boxi
Cox transformations. Because the diagnostic results are similar
for different normalization methods, we only present those for
the normalized RNA—Seq data of the Brain sample by RPKM
here as an example. The platform residual plots corresponding to
qRTiPCR, Microarray and RNA—Seq are presented in Figure 1
from left to right. The plots do not demonstrate strong hetero—
scedastic patterns, and their corresponding 95% conﬁdence
intervals for BoxiCox transformation all contain 1, indicating
that there does not exist signiﬁcant violation of the homoscedas—
ticity assumption on the platform MEs. Note that due to limited
space, the conﬁdence intervals are not reported here. The labora—
tory residual plots corresponding to Microarray and RNA—Seq
are presented in Figure 2 from left to right. Overall, these two
residual plots again do not demonstrate severe heteroscedastic
patterns. The approximate 95% confidence interval of BoxiCox
transformation for the laboratory residuals under RNA—Seq con—
tains 1, suggesting that the laboratory ME due to laboratory in
RNA—Seq does not violate the homoscedasticity assumption. The
approximate 95% conﬁdence interval of BoxiCox transform—
ation for the laboratory residuals under Microarray does not

 

 

(a) a (b)

ran

40 45 no 05

 

 

 

 

 

 

 

 

 

 

Fig. 1. Plots of platform residuals for qRTiPCR (a), Microarray (b) and
RNA-Seq (c) based on the RPKM measurements in the Brain sample

 

 

   
 
 
  

  

 

 

 

 

 

 

 

a 0 (9% o b
()g_, 00° 0 <)
 o. 5?
3° <'<
e E
a—mago 0
° :9
o
I I I I
—4 —2 O 2
II ii

Fig. 2. Plots of laboratory residuals for Microarray (a) and RNA-Seq
(b) based on the RPKM measurements in the Brain sample

include 1, though the low end of the interval is close to 1, indi—
cating that some heteroscedasticity may exist in the laboratory
ME under the Microarray platform.

Note that the system of ME models are postulated for the log—2
scale of the original expression measurements. As discussed in
Section 2, log—2 transformation in general can mitigate heterosce—
dasticity and further lead to homoscedastic errors. The diagnostic
results earlier in the text suggest that this was indeed the case for
most of the MEs except those due to laboratories under
Microarray. Comparing the size of the residuals due to labora—
tories under microarray and the sizes of other residuals, we found
the former is about one—fourth of the latter, indicating that the
MEs due to laboratories under Microarray are relatively small.
The purpose of this study is to compare the performances of
RNA—Seq normalization methods, and the homoscedasticity as—
sumption holds well for all MEs related to RNA—Seq. These two
facts lead us to believe that the minor violation of the homosce—
dasticity assumption does not affect the usefulness of the proposed
model and approach and alter the validity of conclusions we pre—
sent in the subsequent sections. More complicated models can be
considered, for example, models based on other power transform—
ations and models allowing heteroscedastic errors. We will inves—
tigate these extensions and report the results in the future.

4.2 Coherency between 6(1)

Each parameter in a) has ﬁve estimates obtained from the five
combined data. Table 1 lists a“) and their standard errors (in
parentheses) for I: 1,. . . ,5 for the Brain sample. For each par—
ameter, we applied pairwise comparison with the help of the
bootstrap procedure to check if its ﬁve estimates are coherent.
Components of 6)“) for different I were not found to be signiﬁ—
cantly different, indicating that the ﬁve systems are coherent for
the Brain sample. Similarly, we also found that elements of (BU) in
the ﬁve systems for the UHR sample were also coherent with
each other.

 

2588

ﬁle'spzumoipmjxo'sopeuuopnoiq/ﬁdnq

Systematic comparison of RNA-Seq normalization methods

 

Table 1. Estimates of structural parameters related to qRTiPCR and Microarray (60(1)) in the Brain sample

 

52
T1

15%

5%

 

512 52
RPKM 412693 (0.0838) 0.8183 (0.0280)
GPseq 02727 (0.0852) 0.8164 (0.0295)
Mseq 02755 (0.0940) 0.8147 (0.0373)
GCR 413135 (0.0853) 0.7927 (0.0299)
PMseq 02571 (0.0816) 0.8254 (0.0256)

0.6269 (0.1145)
0.6207 (0.1181)
0.6155 (0.1388)
0.5439 (0.1213)
0.6490 (0.1085)

1.4899 (0.1263)
1.4940 (0.1279)
1.4975 (0.1368)
1.5438 (0.1303)
1.4750 (0.1234)

0.0245 (0.0008)
0.0245 (0.0008)
0.0245 (0.0008)
0.0245 (0.0008)
0.0245 (0.0008)

 

Table 2. Estimates of structural parameters related to RNA-Seq (ém) in the Brain sample (best estimates are highlighted)

 

15%

5%

 

0.8926 (0.0338)
0.8755 (0.0343)
0.7237 (0.0336)
0.8562 (0.0346)

(23 i3}
RPKM 70.1645 (0.0824)
GPseq 70.1910 (0.0836)
Mseq 70.3597 (0.0819)
GCR 70.2222 (0.0835)
PMseq —0.1053 (0.0796)

0.9127 (0.0326)

0.8017 (0.1046)
0.8599 (0.1071)
0.8401 (0.1009)
0.9174 (0.1096)
0.6583 (0.0978)

0.1664 (0.0082)
0.1704 (0.0084)
0.4033 (0.0199)
0.1585 (0.0078)
0.1967 (0.0097)

 

Table 3. Estimates of structural parameters related to RNA-Seq (ém) in the UHR sample (best estimates are highlighted)

 

15%

5%

 

0.9707 (0.0172)
0.9545 (0.0176)
0.6771 (0.0195)
0.9273 (0.0177)

513 133
RPKM 70.0748 (0.0633)
GPseq 70.1013 (0.0652)
Mseq 70.4071 (0.0705)
GCR 70.1579 (0.0641)
PMseq —0.0214 (0.0603)

0.97363 (0.0163)

0.7331 (0.0838)
0.8273 (0.0887)
1.1220 (0.1110)
0.8681 (0.0889)
0.5689 (0.0748)

0.0632 (0.0029)
0.0738 (0.0034)
0.6712 (0.0307)
0.0513 (0.0023)
0.0911 (0.0042)

 

4.3 Comparison of normalization methods

Components in 0“) are related to the quality of RNA—Seq meas—
urements normalized by the lth method, therefore they can/be
used to compare different RNA—Seq normalization methods. 0“)
for l: 1, ...,5 in the Brain and UHR samples are listed in
Tables 2 and 3, respectively. The standard errors are also re—
ported in parentheses in the tables.

The platform variance  U) represents the remaining variation
due to the RNA—Seq platform in the normalized RNA—Seq meas—
urements by the lth method. In the Brain sample, in terms of the
platform variance, the order of the five normalization methods
from best to worst is PMseq, RPKM, mseq, GPseq and GCR. In
the UHR sample, the order is PMseq, RPKM, GPseq, GCR and
mseq. PMseq has the smallest platform variances, which are
more than 18% and 22% lower than the platform variances of
RPKM.

The laboratory variance g3“) represents the remaining vari—
ation due to laboratories in the normalized RNA—Seq measure—
ments by the lth method. In both the Brain and UHR samples, in
terms of the laboratory variance, the order of the five methods
from best to worst is GCR, RPKM, GPseq, PMseq and mseq.

In terms of total variance, the order of the five methods from
the best to the worst is the same in both the Brain and UHR
samples. PMseq has the lowest total variance, which are 0.8550
in the Brain sample and 0.6600 in the UHR sample; RPKM has
the second lowest total variances, which are 0.9681 in the Brain
sample and 0.7963 in the UHR sample; the third is GPseq, which
has a total variance of 1.0303 in the Brain sample and 0.9011 in
the UHR sample; GCR is ranked the fourth, with total variance
of 1.0759 in the Brain sample and 0.9194 in the UHR sample and
mseq has the largest total variance in both samples, which are
1.2434 and 1.7923 in the Brain and UHR samples, respectively.

The absolute value of 013w represents the magnitude of the
location bias in the normalized RNA—Seq measurements by the
lth method. The order of the ﬁve methods in terms of location
bias in both samples is PMseq, RPKM, GPseq, GCR and mseq.
In the Brain sample, one fails to reject the null hypothesis
H0 : 01w) 2 0 based on 073‘“) and its standard error for PMseq,
which implies the RNA—Seq measurements normalized by
PMseq are free of location bias in the Brain sample. In the
UHR sample, RNA—Seq measurements normalized by PMseq,
RPKM and GPseq are free of location biases.

 

2589

ﬁle'spzumol‘pmjxo'sopeuuopnoiq/ﬁdnq

Z.Sun and Y.Zhu

 

Table 4. Pearson correlation coefﬁcients between RNA-Seq and qRTi
PCR measurements

 

 

RPKM GPseq Mseq GCR PMseq
Brain 0.749 0.738 0.675 0.740 0.766
UHR 0.823 0.809 0.672 0.811 0.836

 

Table 5. Spearman correlation coefﬁcients between RNA-Seq and qRTi
PCR measurements

 

 

RPKM GPseq Mseq GCR PMseq
Brain 0.711 0.703 0.626 0.717 0.739
UHR 0.806 0.801 0.587 0.798 0.823

 

The absolute value of 03‘ U) — 1 represents the magnitude of the
scale bias in the normalized RNA—Seq measurements by the lth
method. In terms of the scale bias, the order of the five methods
in both the Brain and UHR samples are PMseq, RPKM, GPseq,
GCR and mseq. In the UHR sample, one fails to reject the null
hypothesis H0 : 03‘“) = 1 based on 33‘“) and its standard error
for PMseq and RPKM, which implies that the RNA—Seq meas—
urements normalized by these two methods are free of scale
biases in the UHR sample. In the brain sample, RNA—Seq meas—
urement normalized by all five methods suffers from scale biases.

According to the estimated location biases and scale biases of
the five methods, the PMseq is the best, followed by RPKM. The
third best method is GPseq. The fourth is GCR, and mseq meas—
urements suffer from the largest biases.

Based on the discussion earlier in the text, we can draw the
conclusion about the overall performances of the ﬁve methods.
PMseq has the best performance in this dataset because it is
ranked the ﬁrst both in terms of total variance and in terms of
bias. RPKM has the second best performance because it is
ranked the second both in terms of total variance and in terms
of bias. The third and fourth methods are GPseq and GCR. The
mseq method has the worst performance due to the fact that it is
ranked the last in terms of both total variance and bias.

4.4 ME models versus correlation coefficients

Next, we show that the conventional approach for comparing
different normalization methods can be less effective and less
informative than our proposed approach. We treated the qRTi
PCR as the gold standard and calculated two types of correlation
coefﬁcients (Pearson’s and Spearman’s) of the qRTiPCR meas—
urements with the normalized RNA—Seq measurements by the
ﬁve methods. The Pearson’s correlation coefficients are listed in
Table 4 and the Spearman’s correlation coefficients are listed in
Table 5.

The ranks of the correlation coefﬁcients are used to rank—order
the RNA—Seq normalization methods. According to the
Spearman’s correlation coefﬁcients, the order from best to
worst in the Brain sample is PMseq, GCR, RPKM, GPseq
and mseq. However, on the UHR sample, the order of GCR

and RPKM are switched. In each sample, the absolute values
of Spearman’s correlation coefﬁcients for these two methods
only have minor differences. This demonstrates the insensitivity
of the correlation coefficients when used for comparing the
RNA—Seq normalization methods.

According to the Pearson’s correlation coefﬁcients, in both the
Brain and UHR samples, the order from best to worst is PMseq,
RPKM, GCR, GPseq and mseq. However, the correlation coef—
ficients of GPseq and GCR only have minor differences.
Moreover, the two types of correlation coefﬁcients do not pro—
vide any further information about the strengths and weaknesses
of these normalization methods.

5 CONCLUSION

RNA—Seq raw data are subject to a variety of variations, biases
and uncertainties, and therefore, they need to be normalized for
subsequent gene expression analysis. The conventional approach
to comparing different normalization methods requires a gold
standard and uses the correlation coefﬁcients between the nor—
malized data and the gold standard. In this article, we show that
such an approach can be insensitive and non—informative. We
proposed to use ME models to characterize the normalized
RNA—Seq gene expression data and use the estimates of the
model parameters for systematic comparison of different nor—
malization methods. In the proposed approach, no single plat—
form is treated as the gold standard.

We applied the proposed approach to compare ﬁve existing
RNA—Seq normalization methods using the gene expression data
of the UHR and Brain samples from the MAQC and SEQC
projects and showed that much more information about the
pros and cons of the methods could be obtained than the con—
ventional approach. We believe that the proposed method not
only can help analysts in practice to choose between the existing
normalization methods but also help researchers improve these
methods or develop entirely new methods.

ACKNOWLEDGEMENTS

We thank the associate editor and three anonymous reviewers
for their constructive comments and suggestions.

Funding: NSF—DMS—1000443.

Conﬂict of Interest: none declared.

REFERENCES

Agarwal,A. ct a]. (2010) Comparison and calibration of transcriptome data from
RNA—Seq and tiling arrays. BMC Genomic)“, 11, 383.

Barnett,V.D. (1969) Simultaneous pairwise linear structural relationships.
Biometrics, 25, 12%142.

Brownie,J. ct a]. (1997) The elimination of primer—dimer accumulation in PCR.
Nucleic Acids Res., 25, 323?3241.

Bullard,J. et a]. (2010) Evaluation of statistical methods for normalization and dif—
ferential expression in mRNA—Seq experiments. BMC Bioinﬁnmuticx, ll, 94.

Cloonan,N. ct a]. (2008) Stem cell transcriptome proﬁling via massive—scale mRNA
sequencing. Nature Methods, 5, 613%19.

Degner,J.F. ct a]. (2009) Effect of read—mapping biases on detecting allele—speciﬁc
expression from RNA—Sequencing data. Bioiiy’ornmticx, 25, 320773212.

Hansen,K.D. et a]. (2010) Biases in Illumina transcriptome sequencing caused by
random hexamer priming. Nucleic Acids Res., 38, e131.

 

2590

ﬁle'spzumofpmjxo'sopnuuopnoiq/ﬁdnq

Systematic comparison of RNA-Seq normalization methods

 

Irizarry,R.A. et al. (2005) Multiple—laboratory comparison of microarray platforms.
Nature Metlwds, 2, 3457350.

Langmead,B. et al. (2009) Ultrafast and memory—efﬁcient alignment of short DNA
sequences to the human genome. Genome Biol, 10, R25.

L1,]. (2011) mseq: Modeling non—uniformity in short—read rates in RNA—Seq data.
R package version 1.2. http://CRAN.R—project.0rg/package:mseq.

Li,J. et al. (2010) Modeling non—uniformity in short—read rates in RNA—Seq data.
Genome Biol, 11, R50.

Marioni,J. et al. (2008) RNA—Seq: an assessment of technical reproducibility and
comparison with gene expression arrays. Genome Res., 18, 150971517.

Mormzavi,A. et al. (2008) Mapping and quantifying mammalian transcriptomes by
RNA—Seq. Nature Methods, 5, 621$28.

Nagalakshmi,U. et al. (2008) The transcriptional landscape of the yeast genome
deﬁned by RNA sequencing. Science, 320, 1344ﬁ1349.

Pan,Q. et al. (2008) Deep surveying of alternative splicing complexity in the human
transcriptome by high—throughput sequencing. Nat. Genet., 40, 141371415.
Riss0,D. et al. (2011) GC—content normalization for RNA—Seq data. BMC
Bioinformatics, 12, 480.

Srivastava,S. and Chen,L. (2010) A two—parameter generalized Poisson model to
improve the analysis of RNA—Seq data. Nucleic Acids Res., 38, e170.

Srivastava,S. and Chen,L. (201 l) GPseq: using the generalized Poisson distribution to
model sequence read counts from hiin throughput sequencing experiments.
R package version 0.5. http://CRAN.R—project.org/package:GPseq.

Wu,H. et al. (2012) Pm—seq: using ﬁnite poisson mixture models for rna—seq data
analysis and transcript expression level quantiﬁcation. Stat. Biosci. doi:10.1007/
s12561—012—9070—9.

 

2591

/810'sleum0prOJxo"SOIJBHIJOJuioqu:duq

