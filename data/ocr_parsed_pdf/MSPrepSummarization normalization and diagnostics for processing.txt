BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

G.Hughes et al.

 

algorithm estimates the missing value by a linear combination of principal
axis vectors, where the parameters of the model are identiﬁed by a
Bayesian estimation method and is not sensitive to the quantity of missing
data.

Normalization: There are ﬁve options for normalization: Median (Wang
et al., 2003), Quantile (Bolstad et al., 2003), Cross-Contribution
Compensating Multiple Standard Normalization (CRMN) (Redestig
et al., 2009), Surrogate Variable Analysis (SVA) (Leek et al., 2007) and
Removal of Unwanted Variation (RUV) (Gagnon-Bartsch et a]. 2012).
Median, quantile and CRMN all result in an adjusted (normalized) dataset.
RUV and SVA each estimate a matrix of unobserved factors of importance
using different methods of supervised factor analysis. The unnormalized,
median and quantile adjusted data are adjusted with ComBat (Johnson
et al., 2007), an empirical Bayes batch effect correction algorithm for the
removal of potential batch effects. For RUV and CRMN, users can either
specify compounds to use as controls or data driven controls will be esti-
mated if no negative controls exist (DeLivera et al., 2012).

Results will vary based on biological and technical differences in ex-
periments. Users are encouraged to try different processing steps and
MSPrep produces two documents to assist in comparing the methods.
Examples of these are available online in the Supplementary Materials.
The ﬁrst contains distributional histograms of raw and log transformed
abundances by all three imputation methods. The second can be used to
compare normalization methods and contains color-coded PCA plots for
a categorical phenotype or covariate and numbering for batches, box
plots by subject (or sample, cell type, etc), box plots by batch and box
plots by the phenotype or covariate. Examples of both output ﬁles are in
the Supplementary Material.

3 RESULTS

An operator difference dataset was generated by the Reisdorph
Mass Spectrometry laboratory at National Jewish Health. Three
technicians performed all steps of sample prep for profiling of a
base human plasma sample containing six spiked in control com—
pounds at concentrations of 1X, 2X and 4X and two negative
controls at 1X in all samples. Pre—processing was performed in
Agilent’s Mass Hunter software.

For summarization, the CV cutoff was set at 0.50. There were
23 compounds (0.1% of compounds) that were present in all
replicates but above this cutoff. Of these, all but one fit the pat—
tern of two consistent observations and one outlier. The data
were ﬁltered at 80% present in all subjects, which resulted in
891 compounds. The BPCA imputation was used to maintain
a Gaussian distribution and allows application and evaluation of
all normalization methods.

Owing to the design, we expect compounds to be consistently
measured between subjects with the only detected differences
occurring in the six compounds that were spiked into the

Table 1. Percentage of compounds found signiﬁcant by normalization
method and RSME for detection of 4>< spiked compounds

 

Method None Median Quant Quant SVA RUV CRMN
Combat

 

Spike 6.0% 7.4% 5.6% 22.4% 6.6% 12.1% 15.4%
Operator 8.0% 11.4% 10.8% 0.0% 3.7% 6.7% 5.8%
RSME 1.42 1.31 1.34 1.34 1.26 1.42 1.69

 

datasets. Thus, all other differences are due to the batch/ operator
effect. As shown in Table l, the SVA normalization method was
the most effective at controlling false—positive rate while reducing
the operator effect for this dataset, based on a linear model of the
log2 abundances. While the operator effect is still apparent in the
PCA plot of the SVA adjusted data in Supplementary Figure S2,
the lower percentages and RMSE in Table 1 represents an im—
provement over the other methods.

4 CONCLUSION

The MSPrep package is designed to help investigators prepare
their datasets for analysis, while reducing the amount of
manual processing of datasets and generating useful diagnostic
aids. Our package complements existing pre—processing methods
such as xMSAnalyzer (Uppal et a], 2013), and the output is in a
format ready for input to leading software such as
MetaboAnalyst (Xia et al., 2009) to perform clustering and
other downstream analyses. The SVA routine provided the best
performance when applied to the dataset presented, but it is im—
portant to note the strengths and weaknesses of each routine,
and, in our experience, no single method is best in all circum—
stances. We encourage users to examine the diagnostic plots gen—
erated by the package to compare different methods for their
datasets.

Funding: NIH/NHLBI P20 HL113445.

Conﬂict of Interest: none declared.

REFERENCES

Bolsmd,B.M. et a]. (2003) A comparison of normalization methods for high density
oligonucleotide array data based on variance and bias. Bioiiy’ormuticx, 19,
1857193.

DeLivera,A.M. et a]. (2012) Normalizing and integrating metabolomic data. Anal.
Chem, 84, 10768710776.

Gagnon—Bartsch,J.A. et a]. (2012) Using control genes to correct for unwanted
variation in microarray data. Bioxtutixtics, 13, 5397552.

Johnson,W.E. et a]. (2007) Adjusting batch effects in microarray expression data
using Empirical Bayes methods. Biostutixtics, 8, 1187127.

Leek,J.T. et a]. (2007) Capturing heterogeneity in gene expression studies by surro—
gate variable analysis. PLoS Genetics, 3, , e161.

Oba,S. et a]. (2003) A Bayesian missing value estimation for gene expression proﬁle
data. Bioinformuticx, 19, 208872096.

Pluskal,T. et a]. (2010) MZ Mine 2: Modular framework for processing, visualizing
and analyzing mass spectrometry based molecular proﬁle data. BMC
Bioinfommticx, 11, 395.

Redestig,H. et a]. (2009) Compensation for systematic cross—contribution improves
normalization of mass spectrometry based metabolomics data. Anal. Chem, 81,
797477980.

Smith,C. et a]. (2006) XCMS: processing mass spectrometry data for metabolite
proﬁling using nonlinear peak alignment, matching, and identiﬁcation. Anal.
Chem., 78, 7797787.

Stacklies,W. et a]. (2007) pcaMethodsia bioconductor package providing PCA
methods for incomplete data. Bioinformuticx, 23, 11644167.

Uppal,K. et a]. (2013) xMSanalyzer: automated pipeline for improved feature de—
tection and downstream analysis of large—scale, non—targeted metabolomics
data. BM C Bioinformutics, 14, 15.

Wang,W. et a]. (2003) Quantiﬁcation of proteins and metabolites by mass spec—
trometry without isotopic labeling or spiked standards. Anal. Chem, 75,
48184826.

Xia,J. et a]. (2009) MetaboAnalyst: a web server for metabolomic data analysis and
interpretation. Nucleic AcidS Res, 37, W6527W660.

 

134

ﬁm'spzumol‘pmjxo'sopauuopuoiq/ﬁdnq

