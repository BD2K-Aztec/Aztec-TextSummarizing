ORIGINAL PAPER

Vol. 29 no. 22 2013, pages 2900—2908
doi:10. 1 093/bioinformatics/btt493

 

Systems biology

Advance Access publication August 23, 2013

GIM3E: condition-specific models of cellular metabolism
developed from metabolomics and expression data
Brian J. Schmidt‘ Ali Ebrahim‘, Thomas o. Metzz, Joshua N. Adkinsz,

Bernhard Q. Palsson1 and Daniel R. Hyduke”

1Department of Bioengineering, University of California, San Diego, La Jolla, CA 92093-0412, USA and 2Biological
Sciences Division, Pacific Northwest National Laboratory, Bichland, WA 99352, USA

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Genome-scale metabolic models have been used exten-
sively to investigate alterations in cellular metabolism. The accuracy of
these models to represent cellular metabolism in speciﬁc conditions
has been improved by constraining the model with omics data
sources. However, few practical methods for integrating metabolo-
mics data with other omics data sources into genome-scale models
of metabolism have been developed.

Results: GIMSE (Gene Inactivation Moderated by Metabolism,
Metabolomics and Expression) is an algorithm that enables the devel-
opment of condition-specific models based on an objective function,
transcriptomics and cellular metabolomics data. GIMSE establishes
metabolite use requirements with metabolomics data, uses model-
paired transcriptomics data to find experimentally supported solutions
and provides calculations of the turnover (production/consumption)
flux of metabolites. GIMSE was used to investigate the effects of inte-
grating additional omics datasets to create increasingly constrained
solution spaces of Salmonella Typhimurium metabolism during growth
in both rich and virulence media. This integration proved to be inform-
ative and resulted in a requirement of additional active reactions (12 in
each case) or metabolites (26 or 29, respectively). The addition of
constraints from transcriptomics also impacted the allowed solution
space, and the cellular metabolites with turnover fluxes that were ne-
cessarily altered by the change in conditions increased from 118 to
271 of 1397.

Availability: GIMSE has been implemented in Python and requires a
COBRApy 0.2.x. The algorithm and sample data described here are
freely available at: http://opencobra.sourceforge.net/

Contacts: brianjamesschmidt@gmai|.com or hyduke@usu.edu
Supplementary information: Supplementary information is available
at Bioinformatics online.

Received on July 7, 2013; revised on August 10, 2013; accepted on
August 16, 2013

1 INTRODUCTION

The extraction and integration of biological knowledge from
large, omics datasets is an active area of research (Palsson and
Zengler, 2010). Genome-scale metabolic models (GEMs) provide
a ‘context for content’ for metabolic information and facilitate
interpreting large datasets in terms of the resulting functional

 

*To whom correspondence should be addressed.

state of the network (Feist and Palsson, 2008; Oberhardt et al.,
2009). As opposed to an inference-based analysis of omics data-
sets (Ansong et al., 2013a; Yoon et al., 2011), GEMs enable the
calculation of the ﬂux through network reactions (Hyduke et al.,
2012; Orth et al., 2010). However, sufﬁcient information to
uniquely determine all of the ﬂuxes for network reactions is gen-
erally not available (Orth et al., 2010; Reed, 2012).

Constraint-based modeling approaches are useful for calculat-
ing network states at the genome scale, establishing bounds of
allowed operation of the network from available information
(Orth et al., 2010; Reed, 2012). Omics datasets can be used to
better constrain the allowed operations of a metabolic network
model and improve the accuracy of flux predictions, especially
when the regulatory logic of the network is not fully known
(Hyduke et al., 2012; Reed, 2012). The value of model-guided
analysis of omics data is evident from its application in a variety
of contexts in systems biology research (Hyduke et al., 2012). For
example, constraint-based models have been used to assess the
impact of alternate conditions on growth rate, bioﬁlm formation
and other functions that pathogens require to effectively imple-
ment a Virulence program (Oberhardt et al., 2010; Kim et al.,
2013). In the context of mammalian metabolism, constraint-
based models have been used to study metabolic alterations in
diseases of interest to medical research (Bordbar and Palsson,
2012) and drug development (Schmidt et al., 2013).

Algorithms have been developed and used to automatically
constrain GEMs by using a variety of data types, especially
transcriptomics and proteomics (Blazier and Papin, 2012).
Metabolomics has also been used to develop model constraints
(Fleming et al., 2009; Henry et al., 2007; Kummel et al., 2006;
Yizhak et al., 2010) and infer altered reactions from GEMs
(Cakir et al., 2006). When isotopically labeled metabolic sub-
strates are used for cellular uptake, GEMs facilitate the calcula-
tion of metabolic ﬂuxes directly from metabolomics data (Sauer,
2006). In addition, GEMs can be used with transcriptomics data
to infer transcriptional control of cellular metabolites (Patil and
Nielsen, 2005).

Metabolomics data can also be used to develop model flux
constraints, but using measures of cellular metabolite concentra-
tions to develop model reaction ﬂux constraints requires add-
itional information (Reed, 2012). For example, reaction
directionality can be bound by the calculated Gibb’s free
energy change of a reaction from metabolite concentrations (or
more precisely, activity) (Reed, 2012). However, the free energy

 

2900 © The Author 2013. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com

112 /310'S[BIIJHO[pJOJXO'SOlJBLUJOJIIlOlq”Zduq uteri pQPBOIHAAOG

9103 ‘Og anﬁnV uo ::

GIM3E

 

change for all reactions in the model often is not available and
must be estimated from group contribution theory (Fleming
et al., 2009; Henry et al., 2007; Kummel et al., 2006). Also,
free energy varies as a function of cellular pH (Fleming et al.,
2009), which might be unknown. Furthermore, the concentration
of all reaction participants may not be known. Finally, available
metabolomics data may be qualitative or semi-quantitative and
may not give the absolute concentration of detected metabolites.

Here, we present an algorithm to enable the integrated func-
tional analysis of intracellular metabolomics data and gene
expression microarray data, guided by a GEM. The algorithm,
GIM3E (Gene Inactivation Moderated by Metabolism,
Metabolomics and Expression), uses metabolomics data to
ensure that the detected species are used in the calculated net-
work operating states. Transcriptomics data are used in GIM3E
to further constrain the model ﬂuxes. The models created with
the GIM3E algorithm report the modeled rate of creation or
consumption (turnover) of metabolites. GIM3E can also be im-
plemented with metabolomics data that report the identity of
detected metabolites and does not require their absolute
concentrations.

We developed and used GIM3E during an investigation of
alterations in S.Typhimurium metabolism in ‘rich’ and ‘Viru-
lence’ media speciﬁcally to combine the broad semi-quantitative
metabolomics dataset we developed for this infectious microbe
with transcriptomics data (Kim et al., 2013). Our purpose was to
better constrain the model and perform an investigation of alter-
ations in the network that was focused on metabolite turnover.
Unexpectedly, we discovered alterations in metabolites with pre-
viously postulated immunomodulatory roles (Bordbar et al.,
2012) and a preferential maintenance of cellular pathways impli-
cated in Virulence. However, we did not provide a detailed de-
scription of the steps in the algorithm or perform a holistic
investigation of the impact of transcriptomic and metabolomic
constraints on the conclusions drawn to better validate GIM3E.
Therefore, we expand on our previous analysis, detail GIM3E
and elucidate the impact of additional omics data sources on the
model-guided interpretation of metabolism.

2 METHODS
2.1 Steps in GIM3E

The steps in GIM3E proceed in distinct phases to implement constraints
based on the cellular objective as well as metabolomics and transcrip-
tomics data (Fig. 1). Models developed with GIM3 E also report the pro-
duction or consumption (turnover) of metabolites by adding turnover
metabolites to the model. Hence, any reaction that produces or consumes
metabolite ‘A’ also produces a corresponding ‘turnover’ metabolite, ‘AT.’
A sink reaction for the turnover metabolite, i.e. ‘RATS,’ therefore tracks
the ﬂux through the metabolite. The network can then be constrained to
use a detected metabolite by imposing a minimum ﬂux requirement for
the turnover.

As in the previously developed Gene Inactivation Moderated by
Metabolism and Expression (GIMME) algorithm (Becker and Palsson,
2008), penalty coefﬁcients are calculated for model reactions based on
transcriptomics data. The penalties minimize the degree to which the
network uses reactions that have weaker supporting evidence in the
data. Manipulations to the stoichiometric S matrix are also shown in
Figure 1B. The mathematical description of the steps in GIM3E follows.

1. Determination of objective function bound The GEM is optimized
for the selected objective with ﬂux balance analysis (Orth et al., 2010).
Maximize:

c >v (1)

Such that:
SV 2 0 (2)
a 5 v 5 b (3)

Here, c is a column vector of objective coefﬁcients, v is a column vector of
reaction ﬂux values, S is the stoichiometric matrix, a is a vector of lower
bounds for the ﬂuxes and b is a vector of upper bounds for the ﬂuxes.
Note that a and b include limits for nutrient uptake, and will vary based
on the media. Once the optimal value is determined, a constraint is added
to require that the objective maintains a value greater than or equal to
some fraction, f, of the optimum objective value, 00m.

2. Addition of turnover metabolites The model is ﬁrst converted to an
irreversible format that serves two purposes. First, breaking reversible
reactions into complementary irreversible pairs is required for the calcu-
lation of virtual metabolite turnover. Second, complementary irreversible
pairs will be mathematically necessary to calculate a penalty using com-
mercial linear program solvers. A turnover metabolite for each model
cellular metabolite is added to each reaction that produces or consumes
the corresponding model cellular metabolite. Next, a sink reaction for
each turnover metabolite is added. To ensure that detected metabolites
are used by the network in valid model solutions, the lower bound on ﬂux
through each turnover sink reaction corresponding to a detected metab-
olite is set to a small positive value limited by the solver’s numerical
tolerance (here, 1 x 1078). As described previously (Kim et al., 2013), it
was not possible to require 100% of optimal growth and also produce all
detected metabolites. Therefore, we set f to 0.99 to stay within 1% of the
maximum objective value, com.

3. Addition of penalty coeﬂicients Transcriptomics data are used to
develop penalties to reduce the use of reactions with lower evidence for
expression. Transcriptomics data are particularly useful, as these data
generally offer good coverage of the reactions in the genome-scale
model. Penalty coefﬁcients are calculated for each model-paired tran-
script on the basis of intensity by:

7g = Imax _ 1g 

Here, 1g indicates the transcript-associated penalty coefﬁcient for tran-
script g. Ig indicates the corrected logz intensity for transcript g. 1mm,
indicates the maximum corrected logz intensity for all model-paired tran-
scripts in the current media condition being considered. The transcript-
associated penalty coefﬁcients are then mapped to model reactions with
gensprotein reaction relationships from the reconstruction (Thiele et al.,
2011) (e.g. 1g values are mapped to the elements of pi", a column vector
of reaction penalty coefﬁcients).

4. Determination of penalty bound Optimization is performed to min-
imize the total penalty.

Minimize:
if" tvi" (5)
Such that:
sir’vi" = 0 (6)
am 5 vi” 5 bi” (7)
Ci" ‘ Vi" Z foopt 

Here, Si" is the stoichiometric matrix that has been converted to an irre-
versible format (Fig. 1B) with added turnover metabolites, v'" is the
vector of reaction ﬂuxes, a'" is a vector of lower bounds for the ﬂuxes,

 

2901

112 /310's112u1n0fp10}x0"sorwurJOJurorq/ﬁduq 11101} pQPBOIHAAOG

9103 ‘Og isnﬁnV uo ::

B.J.Schmidt et al.

 

 

A fumerurr reﬂux-raw
EC £3.54 ' V Mmmml _
Genome-scale model. "'"'"“'"""° ‘, //" . .
V imam- _ (a

medla, '  ' -' _.-.~c;.......1
objective function ,I . \

.\_, . t'rrct'r'nmt'a

_ ualquinaned': deiwdrozmaje
m EC t.3.5.1

 

 

 

Add turnover metabolites, turnover
metabolite sinks. penalty coefﬁcients

“Wm M. r.r
ﬂux 3 0 ﬂux 3 Mile

Rh...“ -yrm'
ﬂux 3 b' ﬂux 3 0

l

 Owe—5:1;

fidmartm! red

     
   
 
   

. Detected Metabolite ECMJJ

O Metabolite
O Turnover metabolite
Rcaclioﬂ Penalties—[inE—n—sﬁ; thieshold urzo)

Turnover metabolite Log: Penalty

 

 

sink Reaction l~|ux Intensity Coefﬁcient Penalty
12> Reaction with fwmmm 20 [8 2 40
_ r'adttr‘taa'e '
nonzero penalty ‘  {J
coefficient mama L ‘ 22 0 0

deb vdroge nose

 

B GlM‘l—I Step Alterations to S matrix

Reactions
-: I) ll H :u ItI II 
o -l -| .I ll ll 0 l ]
I I II n n I o rt 1

I. Find the maximum flux
through objective function.

In 7| II ll ll (run.

2. Add turnover metabolites
and sink reactions.
Establishboundl'or I _| U I) II _, II I n U ‘ G u n I 
turnover metabolitestnk r: -| -l -l n u .I | : I.
reactions. Establish ‘ L "I   'n‘    1 11 I n n 
objectivcfunction 7 a . : : :
minimum ﬂu" Add virtual TMS (rows) and
re‘il'lmmemi’ ‘hm “a” '3“ TM sink reactions (columns)
ITICI- [7| IJ ti n r: I] I tI I) l u n a 2 n .'

u .

I 1

|

Convert to irreversible by splitting
forward and reverse reactions

‘— Metabolites

 

lrlrltllllltlll..l||||.

i ci n \I i ll tI I I I n a n n .
.I u cI u u u u A; II ‘.
I

III IJI11|_|P

I)
I

 

. Calculate reaction penaltyr
coefﬁcients.

Add penalty coefficients in a
“CW I'OW

_ Minimize the total penaltyf “I _"I I1. H '1 H I H h I D "I I: : H n "
while maintaining the
constraints on objective
function and turnover
metabolite sink reactions.
Establish bounds for total
penalty. Convert penalty to
a metabolite and constrain
to near minimum.

.l r. n

 

Fig. 1. GIM3E modiﬁes a genome-scale model of metabolism to incorporate constraints based on metabolomics and transcriptomics data. (A) GIM3E
starts with a genome-scale model, allowed nutrient exchanges as deﬁned by the media and an objective function such as biomass production (growth).
Metabolomics data are mapped onto the model. Two reactions are shown in more detail to illustrate the manipulations to the model made during
execution of the GIM3 E algorithm. Turnover metabolites are added as products to each reaction, one turnover metabolite for each reaction substrate or
product. A turnover sink reaction is also added for each turnover metabolite. The minimum bound for the turnover sink ﬂux is set to a small positive
value if the metabolite was detected. Transcriptomics data were used by calculating penalties for reactions that do not meet a threshold criterion. The
inset table demonstrates a sample calculation of the penalty for each reaction assuming a given set of reaction ﬂux values. The total penalty that is subject
to minimization is calculated by summing the penalty values for all reactions. (B) Summary of the steps in GIM3 E and alterations to the S matrix

irr -

bi" is a vector of upper bounds for the ﬂuxes and c 1s the column vector
of objective coefﬁcients corresponding to the optimization in Step 1. Note
that am will include lower bounds for the turnover sink reactions, which
are taken to be 1.01 a, the solver tolerance. For clarity, a sample penalty
calculation is shown in the table in Figure 1A.

Once the best objective function value is determined, a constraint is
implemented to require that the penalty maintained a value within some
fraction, g, of the minimum value, (Pm-n. Because we took f to be 0.99 to
remain within 1% of maximum growth, we took g to be 1.01 to remain
within 1% of the minimum penalty. Network properties could then be
explored while maintaining consistency with the omics data sources and
the capacity to meet cellular objectives.

2.2 Conversion to mixed integer linear program

When calculating the turnover ﬂux of a metabolite participating in mul-
tiple reversible reactions, the ﬂux of one reaction of each reversible pair
should be constrained to 0. An example to illustrate the motivation for
this requirement is provided in Supplementary Figure Sl. To ensure only
one reaction of a reversible pair is used, integer (binary) variables can be
incorporated into the model to represent the choice of the forward or
reverse reaction for each pair. In this case, a mixed integer linear pro-
gramming (MILP) problem must be solved. Once we have already estab-
lished constraints on the penalty and objective function based on the best
values, the optimization problem for any linear objective function of
interest can be stated as:
Optimize (minimize/maximize):

mirr . vi" (9)

Such that:
site" = 0 (10)
ai" 5 vi" 5 birr (11)
cm .vi" 3 foo," (12)
vi" vi" 5 grim (13)

With additional constraints for each reversible reaction pair k (of 1, 2, . . . ,
K):

rk 6 {0,1} (14)

dk = [iforward(k), ireveme (15)
viz. : (1 — whit, (16)

 5 an), (17)

Here, m is the column vector of objective coefﬁcients, rk is a binary
variable that effectively enables just one reaction of forward and reverse
reaction pair k, d is a K x 2 matrix with rows that track the indices of the
forward and reverse pairs in vi" and irorward(k) and ireverse(k) are functions
to respectively map each of the K reaction pairs to the appropriate indices
in vi". As described in the Supplementary Data, a distinct formulation
was required to implement the MILP in COBRApy (Ebrahim et al.,
2013).

 

2902

112 /3.10's1eu.tnofp.tq1x0"sorteutJOJHtotq/ﬁdnq mot} papeo1umoq

9103 ‘0g isnﬁnV uo ::

GIM3E

 

2.3 Preparation and integration of omics data

The processed omics data used to inform the analysis are available with
the GIM3E algorithm (see opencobra.sourceforgenet). Transcriptomics
data from 25 microarrays for Salmonella Typhimurium were used (JCVI
S .Typhimurium 13k v8 two-channel spotted oligonucleotide microarrays,
see SysBEP.org for datalinks). The microarrays offered coverage of
>99% of annotated genes (Supplementary Table Sl) in our previously
published genome-scale model of S.Typhimurium metabolism (Thiele
et al., 2011). Intensities were extracted using the limma package for R
from Bioconductor on individual channels (Smyth, 2005a, b), back-
ground-corrected with the normexp method (Ritchie et al., 2007), nor-
malized using the print-tip LOESS method and adjusted by quantile
normalization between the channels and arrays. Median intensities were
used for transcripts with multiple probes for the calculation of penalties in
Equation (4).

We used published GCeMS metabolomics datasets for
S.Typhimurium in log-phase growth in two conditions (Kim et al.,
2013), which we have previously described as ‘rich’ (Luria Burtani
broth, LB) and ‘virulence’ (acidic minimal medium low in phosphate
and magnesium, LPM) media. Virulence medium has been designed for
the induction of genes critical for intracellular virulence, as observed
in vivo (Aranda et al., 1992; Deiwick et al., 1999; Figueroa-Bossi and
Bossi, 1999). We used Kyoto Encyclopedia of Genes and Genomes
(KEGG) identiﬁers assigned to the detected metabolites to speed the
matching with metabolites in our consensus reconstruction of
S.Typhimurium metabolism (Kanehisa and Goto, 2000; Kanehisa
et al., 2011). One challenge in interpreting metabolomics data is the con-
founding factor of subcellular compartment localization. Unlike more
complex eukaryotic organisms with greater compartmentalization, our
reconstruction of S.Typhimurium metabolism contains a cytoplasmic
and periplasmic space. Therefore, we preferentially paired our metabolo-
mics data with metabolites in the larger more biosynthetically relevant
cytoplasmic compartment. The cytoplasmic compartment is also poten-
tially less permeable to the loss of metabolites by diffusive transport
processes during sample washing and preparation. Future implementa-
tions of GIM3E to analyze more compartmentalized organisms could
alter the implementation of turnover metabolites to couple each metab-
olite across compartments and ensure ﬂux through the metabolite in at
least one compartment.

2.4 Effects of penalty and metabolite constraints

Imposition of model metabolite and penalty constraints each alters the
allowed solution space. Therefore, three methods were used to character-
ize the solution space: a characterization of reaction and metabolite ac-
cessibility, requirement and relative ﬂux range change. Accessibility was
evaluated by testing whether the maximal ﬂux for a given reaction (or
metabolite) exceeded the numerical tolerance. Required reactions (and
metabolites) were enumerated by constraining the ﬂux for the reaction
(or metabolite) of interest to zero and checking whether a solution, given
the constraints on the objective (growth), penalty and turnover metabolite
sink reactions, could still be found. We describe these reactions and me-
tabolites as ‘required’ as opposed to ‘essential’ to emphasize that not only
non-zero growth constraints but also a near optimal growth constraint
and constraints based on omics data must be met.

The relative ﬂux range change was previously deﬁned (Kim et al.,
2013):

. _ (cu — cu) 18
X] _ (I24 “Lil/2 ( )

Here, x indicates the relative ﬂux range change for reaction j, rm) indi-
cates the width of the ﬂux range for reaction j in condition m and ij
indicates the center of the ﬂux range for reaction j in condition m. Note
that rm) and ij are found by ﬂux variability analysis (Mahadevan and

Schilling, 2003). A logical cutoff to use when interpreting the relative ﬂux
range change is |le > 1.

We further characterized the importance of correct metabolite identi-
ﬁcation on the performance of the GIM3E algorithm by quantifying
the ability to identify the required metabolites implicated by metabolo-
mics-constrained models created in virulence medium with ‘noisy’ meta-
bolomics data. Noisy metabolomics datasets were created by randomly
selecting a subset of detected metabolites and replacing the selected me-
tabolites with random accessible cellular metabolites. Five alternate noisy
metabolomics datasets were created for each number of randomized me-
tabolites to determine the average effect of metabolite misidentiﬁcation.
Alternately constrained models were then created for S .Typhimurium in
virulence medium using constraints based on the objective and the noisy
metabolomics data. The required cellular metabolites were then tested for
each of the alternately constrained models. We then characterized which
of the required metabolites agreed with the required metabolites deter-
mined with the true metabolomics constraints (true positives) and
whether new requirements for metabolites with a non-zero ﬂux were
introduced (false positives). When scoring true and false positives, me-
tabolites implicated as required by the model without omics constraints
were ﬁltered from the comparison.

3 RESULTS AND DISCUSSION

Condition-matched transcriptomic, proteomic and metabolomic
data sources were available for S.Typhimurium. Multi-omics
data (available from SysBEP.org) gathered in two alternate
growth conditions, rich and virulence media (Kim et al., 2013),
therefore presented a good opportunity for algorithm validation.
The model coverage of these alternate omics datasets is described
in Supplementary Table S1. To elucidate the impact of additional
constraints derived from omics data on the solution space, we
performed a detailed analysis of four alternate models for each
condition, using alternate constraints in GIM3E to customize our
published genome-scale model of S.Typhimurium metabolism
(Thiele et al., 2011). The eight resulting models are described in
Table 1.

3.1 Constraints impact required reactions and metabolites

One method of characterizing the effects of the constraints on the
solution space is to enumerate reactions and metabolites that
must necessarily carry a nonzero ﬂux for the model to satisfy
the constraints. The concept is similar to an analysis of essential
genes, whereby an in silico knockout of a gene is evaluated for an
impact on the capability for non-zero growth (Joyce and Palsson,
2008). We investigated whether constraining a reaction or me-
tabolite to be inactive (zero ﬂux) resulted in the inability to find a
solution that satisﬁed imposed constraints based on the objective
(near optimal growth), as well as transcriptomics (penalty) and
metabolomics (turnover metabolite sink reactions) data. To test
the impact of the omics data on the required metabolites and
reactions, we used four models based on alternate omics con-
straints: a model with no omics constraints (growth constraints
only), a model with transcriptomics-based constraints, a model
with metabolomics-based constraints and a model with both
transcriptomics and metabolomics constraints. The number of
required reactions and metabolites for each model are summar-
ized in Table 1.

We further contrast the effect of the constraints introduced by
omics on the required reactions and metabolites in Figure 2.

 

2903

112 /310's1eu1n0fp101x0"sorteutJOJHtotq/ﬁdnq wort papeo1umoq

9103 ‘0g isnﬁnV uo ::

B.J.Schmidt et al.

 

Table 1. Required and accessible reactions and metabolites for alternate penalty implementations and metabolomics constraints

 

 

 

 

 

 

 

 

 

Medium Rich Virulence
Omics constraints None Transcriptomics Metabolomics Transcriptomics, None Transcriptomics Metabolomics Transcriptomics,
metabolomics metabolomics
Reactions considereda 2201
Accessible reactions 1517 1517 1517 1517 1483 1483 1483 1483
Required reactions 343 374 355 386 344 377 356 389
Metabolites consideredb 1461
Accessible metabolites 985 985 985 985 971 971 971 971
Required metabolites 420 429 447 456 427 443 456 472
aAll network (cellular, non-demand) reactions were included.
bAll model cellular metabolites were included.
Required Reactions Required Metabolites

A Rich, Required Reactions B Virulence, Required

Reactions

Transcriptomics Metabolomics Transcriptomics Metabolomics

       

Transcriptomics, Metabolomics Transcriptomics, Metabolomics

 

C Rich, Required
Metaboliteslmkﬂﬂ}
Transcriptomics Metabolomics

D Virulence, Required
Metabolitesme
Transcriptomics Metabolomics

       

Transcriptomics, Metabolomics Transcriptomics, Metabolomics

 

 

Fig. 2. Alternate omics constraints result in non-overlapping requirements for valid metabolic network operation. The effects of alternately imposing
metabolomics-based constraints (green circle), transcriptomics-based constraints (red circle) or both (blue circle) are contrasted for (A) required reactions
in rich medium, (B) required reactions in virulence medium, (C) required metabolites in rich medium and (D) required metabolites in virulence medium

Here, each panel contrasts the requirements for models con-
structed from the alternate omics constraints (metabolomics,
transcriptomics or both), but not solely due to constraints on
growth. For example, in Figure 2C, we show differences be-
tween the required metabolites for the three alternatively con-
strained models in rich media. If transcriptomics data are
additionally included to constrain the model, there are nine
additional required metabolites. If transcriptomics data are
used, there are 27 required metabolites. If both transcriptomics
and metabolomics data are used, there are 36 required metab-
olites. In Figure 2D, we show differences between the required
metabolites for the three alternatively constrained models in
virulence media. If metabolomics data are included to build
and constrain the model, 29 more metabolites are required to
be active, 20 of which were directly detected by metabolomics
(green and blue circles). Alternatively, if transcriptomics data
are included to constrain the model, 16 metabolites are required
to be active (red and blue circles). Inclusion of both metabolo-
mics and transcriptomics constraints results in the requirement
for all 45 to be active (bottom, blue circle). In general,

imposition of constraints based on metabolomics and transcrip-
tomics data results in additional non-redundant constraints on
the solution space.

Another feature of GIM3E is that the addition of metabolo-
mics-derived constraints effectively identiﬁes additional metabol-
ites required to provide ﬂux to produce/consume the detected
metabolites. For example, in virulence medium, both models
created with metabolomics constraints require 29 cellular metab-
olites be produced/consumed that were not required by the
model with transcriptomics but not metabolomics constraints
(Fig. 2D and Supplementary Fig. S3). However, only 20 of
these metabolites were detected by metabolomics. As described
in the Supplementary Data, we performed an enrichment ana-
lysis on model metabolites using pathways deﬁned by KEGG.
We ﬁrst performed an enrichment analysis on the required me-
tabolites identiﬁed only when using the metabolomics constraints
(Supplementary Fig. S4). The most highly enriched pathway
in rich medium was pantothenate and coenzyme A (CoA) me-
tabolism (P=0.0463) and in virulence medium was pyrimidine
metabolism (P=0.0533).

 

2904

112 /810's1eum0fp101x0"sotJBMJOJHtotq//:d11q mot} papeo1umoq

9IOZ ‘OE ISUEHV Ho ::

GIM3E

 

A Pyrimidine Metabolism, Virulence Media

 

 

 

 

 

 

 

W... “Va:
ulna ; n
Cyrus in den minds:
EC3J.4'.I
\
\
0 "he
=‘\.
‘.'\
u
t“ \
“‘9‘ \__\
c===lr}==’ =::_{
lit
\\
ilk
ylase \‘t‘
\\\ mrbﬂnmI-ﬂnq
'Wi}
/'7“-’ mm \\ a; a;
demuﬁdr'n: ._ _
/ genus .  .°.. _ _

 

 

 

B Pantothenate and CoA Biosynthesis, Rich Media

   
   

 

 

‘l'hymldtne

thymidine pkospharylase
EC 2.4.2.4

. zuanxyunbme manoeuvre»

 

Thymine

:ziDnm
Required Metabolites
by Omics Constraints
0 Not required
— 0 Required without omics

°__ . Required when adding
— metabolomics constraints

 

 

 

 

 

 

 

 

 

 

":7 o Detected by
‘ metabolomics

 

 

 

 

 

 

   

 

\

    

  

cum-03;; - 

"Oh 

“WI-mm-Igw "'5 " W “""‘"C“;‘”*"' m Required Reactions
mm“ - 4.. J' 2 E :mw  by Omics Constraints
u 5." .
w glimwmm ﬁg'g’wmﬁmu km“ :u I [D Not required
LC 1.1.4510 - - - mm  E Wm ...... «V g Required without Omics
“30.: ' ‘ I .

24W)
, scum

’ Required when adding
metabolomics constraints

’ Required when also
adding transcri ptomics

 

 

 

constraints

Fig. 3. Impact of omics datasets on the requirements in selected subsystem metabolism for S .Typhimurium. For clarity, the turnover metabolites added
by GIM3E are not shown. The inclusion of additional constraints derived from transcriptomics data did not result in additional requirements for
reactions and metabolites in the subsystems shown. (A) Requirements for pyrimidine metabolism in virulence medium. (B) Requirements for panto-

thenate and CoA biosynthesis in rich medium

Our results prompted us to explore the impact of omics data-
sets on the interpretation of pathway-level alterations in metab-
olism. In Figure 3, we examine the impact of additional omics
constraints on required reactions and metabolites, from no
omics, to metabolomics, to metabolomics plus transcriptomics.
Based on the pathways suggested by the enrichment analysis,
we examined pyrimidine metabolism in virulence conditions
(Fig. 3A). The general importance of pyrimidine metabolism
for S.Typhimurium virulence in vivo has been noted previously
(Chaudhuri et al., 2009). Addition of metabolomics to growth
constraints suggested an additional reaction, cytosine deaminase,
was necessarily active to facilitate the conversion of cytosine to
uracil (inset). It has been shown that cytidine and uracil repress
cytosine deaminase in S.Typhimurium (West and O’Donovan,
1982). However, the topology and directionality of the pyrimi-
dine synthesis and salvage pathways for uracil (West and

O’Donovan, 1982) suggest cytosine deaminase should be ex-
pressed for uracil production. Therefore, the inclusion of con-
straints based on metabolomics ensures pathways are maintained
in an active state that might not be suspected from known tran-
scriptional regulatory interactions. We also observed that al-
though only thymine was detected, ﬂux through thymidine also
became required with the imposition of metabolomics con-
straints (Fig. 3A). When available, exogenous thymine can be
directly incorporated for DNA synthesis during growth
(Friesen, 1968). However, given thymine and thymidine are not
available in virulence medium, the result suggests synthesized
thymidine is degraded to thymine by thymidine phosphorylase.
The metabolic versatility for thymine use may come with the cost
of metabolic efﬁciency in the synthesis of DNA precursors.
R-pantothenate (vitamin B5) is an important nutrient in CoA
synthesis, and S.Typhimurium strains deficient in pantothenate

 

2905

112 /310'sleuinofp103x0"sorJBMJOJurorq//zd11q 11101} papeolumoq

91oz ‘Og isanV uo ::

B.J.Schmidt et al.

 

synthetase are auxotrophic for pantothenate (Cronan et al.,
1982). In rich medium, on the imposition of metabolomics con-
straints, we observed an enrichment of required metabolites in
pantothenate biosynthesis (Supplementary Fig. S4). Constraints
on the objective (growth) alone required the conversion of R-
pantothenate to CoA (Fig. 3B). Cellular ﬂ-alanine was detected
by metabolomics, and the addition of metabolomics constraints
required the biosynthesis of R-pantothenate and the conversion
of L-asparate, 5-10-methylenetetrahydrofolate and 3-methyl-2—
oxobutanoate to R-pantothenate. The allowed solution space
developed with metabolomics constraints suggests the biosyn-
thetic pathway is active despite availability of pantothenate in
the medium.

The addition of transcriptomics constraints to the metabolo-
mics constraints resulted in no new additional metabolite
requirements for the pathways shown in Figure 3. Therefore,
we wished to further clarify the impact of transcriptomics con-
straints in addition to metabolomics. We performed the pathway
enrichment analysis for metabolites required by metabolomics
and transcriptomics constraints, but not required when omics
constraints are absent (e.g., all metabolites in the blue circles in
Figure 2C andD). Our results conﬁrmed the importance of omics
constraints in the interpretation of pantothenate biosynthesis in
rich medium (Supplementary Fig. S5). However, the result for
virulence conditions did not implicate pyrimidine metabolism
with a similar level of signiﬁcance.

The set of metabolites connected by biochemical conversions
implicated as required by metabolomics data in the pantothenate
biosynthesis pathway (Fig. 3A) prompted us to investigate the
connectivity of metabolites required by the omics datasets.
Therefore, we checked for metabolites required by inclusion of
metabolomics and also connected by reactions required by the
inclusion of metabolomics data. Sets with at least two connected
metabolites are shown in Supplementary Figure S6A and B. In
addition to the metabolites previously implicated in rich medium
in pantothenate and CoA biosynthesis, the analysis uncovered a
grouping of metabolites required for urocanate metabolism in
virulence medium.

We veriﬁed the effect of adding transcriptomics constraints in
addition to the metabolomics constraints. Additional sets of con-
nected metabolites were implicated (Supplementary Fig. S6C and
D), including intermediates in fatty acid synthesis. Effects of al-
terations in growth conditions such as temperature, growth
phase and medium on the fatty acid composition of bacterial
membranes and LPS are well documented (Marr and
Ingraham, 1962; Wollenweber et al., 1983). The result suggests
a change in requirements from hexadecanoyl to shorter dodeca—
noyl intermediates on the change from rich to virulence medium.
Furthermore, the addition of transcriptomics constraints impli-
cated an additional required reaction set spanning the conversion
of 3-phosphoglyceroyl-phosphate to 0—phospho—L-serine. Given
glycerol is the primary carbon source in virulence medium, the
result may indicate a change in metabolism to facilitate the effi-
cient synthesis of cysteine, which can be produced from serine
(Kredich and Tomkins, 1966). The result is noteworthy because
proteomics measurements have identiﬁed a protein s-thiolation
switch from glutathione to cysteine when changing from rich to
virulence medium (Ansong et al., 2013b).

The requirement that detected metabolites are used in valid
model solutions is a new development in GIM3E. Therefore, we
wanted to characterize the impact of metabolite misidentifica—
tion, or noise in the metabolite identiﬁcation process, on the
required metabolites enumerated from the models created with
GIM3E (Supplementary Fig. S7). Each identiﬁcation error
reduced the correct identification of true-positive required me-
tabolites by 0.45 (unadjusted R2 of 0.85 with all datapoints).
Each identiﬁcation error also increased the number falsely iden-
tiﬁed required metabolites by 1.72 (unadjusted R2 of 0.776 with
all datapoints).

3.2 Constraints impact reactions altered between rich and
virulence gene-inducing conditions

We also investigated the impact of alternate model constraints on
reactions that were increased or decreased with respect to the
relative ﬂux range change, as shown in Equation (18) and dis-
cussed further in the Supplementary Data, when comparing cel-
lular metabolism in virulence medium to rich medium.
Essentially, the relative flux range change reports alterations in
the allowed flux through a reaction between conditions. Models
with constraints on the objective only (no omics constraints) ex-
hibited the lowest number of reactions with an increased or
decreased flux range, 236 of 1587 in Table 2. Integration of
transcriptomics constraints shrank the solution space in each
condition such that more reactions were necessarily altered in
their ﬂux range when comparing between the two conditions,
386 of 1587 reactions. The models created with the GIM3E al-
gorithm can also be used to compute the turnover ﬂux of me-
tabolites, and the integration of transcriptomic constraints also
had effects on the calculated turnover flux. The number of me-
tabolites necessarily altered in their flux range increased, from
118 to 271 of 1397, when constraints calculated from transcrip-
tomics data were included. Although the integration of metabo-
lomics constraints had a demonstrated impact on the solution
space by increasing the required reactions and metabolites, meta-
bolomics constraints did not have a noticeable impact on the
number of reactions or metabolites with an altered flux range.

In the initial application of the GIM3E algorithm, the com-
bined omics data helped elucidate a new possible avenue of hosti
pathogen interaction by alterations in the ﬂux of metabolites
(Kim et al., 2013). To summarize those results here, metabolic
models of macrophages (Bordbar et al., 2012), the host cells of
S.Typhimurium, and experimental results have demonstrated
that individual metabolites can have predicted stimulatory or
inhibitory effects on antimicrobial functions such as nitric
oxide production. The analysis of S.Typhimurium suggested
that metabolites produced or consumed by this pathogen have
direct effects on macrophage function through metabolic flux.
These results highlight the importance of evaluating omics results
in an integrated manner as possible with the GIM3E algorithm.
Interestingly, another model-guided investigation of metabolism
elucidated the ability of S.Typhimurium to exploit parallel nu-
trient sources to enhance virulence (Steeb et al., 2013). An im-
portant next step to interpret metabolic feedback will be the
integrated model-guided analysis of omics datasets from both
the host and pathogen.

 

2906

112 /310'sleuinofp103x0'sopeuiJOJurorq/ﬁduq 11101} papeolumoq

91oz ‘Og isanV uo ::

GIM3E

 

Table 2. Effect of the penalty and metabolite constraints on relative ﬂux range

 

 

 

 

 

 

 

 

 

Omics constraints None Transcriptomics Metabolomics Transcriptomics,
metabolomics
Medium Rich Virulence Rich Virulence Rich Virulence Rich Virulence
Model genes with penalty 0 0 1258 1258 0 0 1258 1258
Model reactions with penalty 0 0 1996 1996 0 0 1996 1996
Reactions considereda 1587
Increased reactions (X> 1) 70 128 70 128
Decreased reactions (X< —1) 166 258 166 258
Remaining reactions (|X| < 1) 1351 1201 1351 1201
Metabolites consideredb 1397
Increased metabolites (X> 1) 28 74 28 74
Decreased metabolites (X< —1) 90 197 90 197
Remaining metabolites (|X| < 1) 1279 1126 1279 1126

 

“Model reactions that were not implicated in loops that could carry ﬂux greater than the solver tolerance in at least one condition were included.

bAll model cellular metabolites that were not implicated in loops were included.

4 CONCLUSION

The GIM3E algorithm uses metabolomics and transcriptomics
data to develop constraints for a GEM. GIM3E requires a cel-
lular objective and condition-matched omics datasets, preferably
transcriptomics data with good coverage of model genes and
metabolomics data that may be qualitative or semi-quantitative
in nature. In our previous investigation, we illustrated the utility
of GIM3E to develop biological insights into the cellular metab-
olism of S.Typhimurium in both rich and virulence media (Kim
et al., 2013). Here, we also demonstrate that omics data inte-
grated into the model with GIM3E also yields insight into me-
tabolites and reactions that must be active to be in agreement
with model constraints but that are not necessarily detected in
the metabolomics experiments. Metabolomics and transcrip-
tomics yielded distinct constraints on the solution space. The
calculation of metabolite turnover is an additional beneﬁt of
using the GIM3E algorithm, and omics-derived constraints im-
pacted the allowed metabolite turnover ﬂux ranges.

ACKNOWLEDGEMENTS

The authors thank Aarash Bordbar for discussion of GIMME
and Joshua Lerman for suggestions on MILP representation in
COBRApy. They thank Drs. Young-Mo Kim, Christopher
Overall, Marcus Jones, Afshan S. Kidwai and Fred Heffron
for omics data guidance and contributions to the sample tran-
scriptomics and metabolomics datasets.

Funding: This work was supported in part by the US National
Institute of Allergy and Infectious Diseases and the US
Department of Health and Human Services through interagency
agreement 0(1-AI-8401-01).

Conﬂict of Interest: none declared.

REFERENCES

Ansong,C. et al. (2013a) A multi—omic systems approach to elucidating Yersinia
virulence mechanisms. Mol. Biosyst., 9, 44454.

Ansong,C. et al. (2013b) Top—down proteomics reveals a unique protein S—thiolation
switch in Salmonella Typhimurium in response to infection—like conditions.
Proc. Natl Acad. Sci. USA, 110, 10153710158.

Aranda,C. et al. (1992) Salmonella—typhimurium activates virulence gene—transcrip—
tion within acidiﬁed macrophage phagosomes. Proc. Natl Acad. Sci. USA, 89,
10079710083.

Becker,S.A. and Palsson,B.Q. (2008) Context—speciﬁc metabolic networks are con—
sistent with experiments. PLoS Comput. Biol, 4, e1000082.

Blazier,A.S. and Papin,].A. (2012) Integration of expression data in genome—scale
metabolic network reconstructions. Front. Physiol, 3, 299.

Bordbar,A. and Palsson,B.Q. (2012) Using the reconstructed genome—scale human
metabolic network to study physiology and pathology. J. Intern. Mal, 271,
1317141.

Bordbar,A. et al. (2012) Model—driven multi-omic data analysis elucidates metabolic
immunomodulators of macrophage activation. Mol. Syst. Biol, 8, 558.

Cakir,T. et al. (2006) Integration of metabolome data with metabolic networks
reveals reporter reactions. Mol. Syst. Biol, 2, 50.

Chaudhuri,R.R. et al. (2009) Comprehensive identiﬁcation of Salmonella enterica
serovar typhimurium genes required for infection of BALB/c mice. PLoS
Pathog., 5, e1000529.

Cronan,J.E. et al. (1982) Genetic and biochemical analyses of pantothenate biosyn—
thesis in Escherichia coli and Salmonella typhimurium. J. Bacteriol, 149, 9167922.

Deiwick,J. et al. (1999) Environmental regulation of Salmonella pathogenicity
island 2 gene expression. Mol. Microbiol, 31, 175971773.

Ebrahim,A. et al. (2013) COBRApy: COnstraints—based reconstruction and analysis
for Python. BMC Syst. Biol, 7, 74.

Feist,A.M. and Palsson,B.Q. (2008) The growing scope of applications of genome—
scale metabolic reconstructions using Escherichia coli. Nat. Biotechnol, 26,
659$67.

Figueroa—Bossi,N. and Bossi,L. (1999) Inducible prophages contribute to
Salmonella virulence in mice. Mol. Microbiol, 33, 1677176.

Fleming,R.M. et al. (2009) Quantitative assignment of reaction directionality in
constraint—based models of metabolism: application to Escherichia coli.
Biophys. Chem., 145, 47756.

Friesen,J.D. (1968) Measurement of DNA synthesis in bacterial cells. In:
Grossman,L. and Moldave,K. (eds). Methods in enzymology. Academic Press,
New York, pp. 625$35.

Henry,C.S. et al. (2007) Thermodynamics—based metabolic ﬂux analysis. Biophys. J.,
92, 179271805.

 

2907

112 /310'sleuin0[p103x0'sopeuiJOJurorq/ﬁduq 11101} papeolumoq

91oz ‘Og isanV uo ::

B.J.Schmidt et al.

 

Hyduke,D.R. et al. (2012) Analysis of omics data with genome—scale models of
metabolism. Mal. Biosyst., 9, 1677174.

Joyce,A.R. and Palsson,B.Q. (2008) Predicting gene essentiality using genome—scale
in silico models. Methads Mal. Biol, 416, 433457.

Kanehisa,M. and Goto,S. (2000) KEGG: Kyoto encyclopedia of genes and gen—
omes. Nucleic Acids Res., 28, 27730.

Kanehisa,M. et al. (2011) KEGG for integration and interpretation of large—scale
molecular data sets. Nucleic Acids Res., 40, D1097D114.

Kim,Y.M. et al. (2013) Salmonella modulates metabolism during growth under
conditions that induce expression of virulence genes. Mal. Biosyst., 9,
152271534.

Kredich,N.M. and Tomkins,G.M. (1966) The enzyrnic synthesis of L—cysteine in
Escherichia cali and Salmonella typhimurium. J. Biol. Chem., 241, 49554965.

Kiimmel,A. et al. (2006) Putative regulatory sites unraveled by network—embedded
thermodynamic analysis of metabolome data. Mal. Syst. Biol, 2, 34.

Mahadevan,R. and Schilling,C.H. (2003) The effects of alternate optimal solu—
tions in constraint—based genome—scale metabolic models. Metab. Eng., 5,
2644276.

Marr,A.G. and Ingraham,].L. (1962) Effect of temperature on the composition of
fatty acids in escherichia coli. J. Bacterial, 84, 126(%1267.

Oberhardt,M.A. et al. (2009) Applications of genome—scale metabolic reconstruc—
tions. Mal. Syst. Biol, 5, 320.

Oberhardt,M.A. et al. (2010) Metabolic network analysis of Pseudomonas
aeruginasa during chronic cystic ﬁbrosis lung infection. J. Bacterial, 192,
553445548.

Orth,J.D. et al. (2010) What is ﬂux balance analysis? Nat. Biotechnol, 28, 2457248.

Palsson,B. and Zengler,K. (2010) The challenges of integrating multi—omic data sets.
Nat. Chem. Biol, 6, 7877789.

Patil,K.R. and Nielsen,J. (2005) Uncovering transcriptional regulation of metabol—
ism by using metabolic network topology. Prac. Natl Acad. Sci. USA, 102,
268572689.

Reed,J.L. (2012) Shrinking the metabolic solution space using experimental data—
sets. PLaS Camput. Biol, 8, e1002662.

Ritchie,M.E. et al. (2007) A comparison of background correction methods for two—
colour microarrays. Bioinformatics, 23, 270C2707.

Sauer,U. (2006) Metabolic networks in motion: 13C—based ﬂux analysis. Mal. Syst.
Biol, 2, 62.

Schmidt,B.J. et al. (2013) Mechanistic systems modeling to guide drug discovery and
development. Drug Discav. Today, 18, 11(r127.

Smyth,G.K. (2005a) Paper 116: Individual channel analysis of two—colour micro—
arrays. In: 55th Session af the International Statistics Institute, 5712 April 2005,
Sydney Convention & Exhibition Centre, Sydney, Australia ( CD ). International
Statistical Institute, Bruxelles.

Smyth,G.K. (2005b) limma: Linear Models for Microarray Data. In: Gentleman,R.
et al. (ed.) Bioinformatics and Computational Biology Solutions using R and
Biacanductar. Springer, New York, pp. 397420.

Steeb,B. et al. (2013) Parallel exploitation of diverse host nutrients enhances
Salmonella virulence. PLaS Pathag., 9, e1003301.

Thiele,I. et al. (2011) A community effort towards a knowledge—base and mathem—
atical model of the human pathogen Salmonella typhimurium LT2. BMC Syst.
Biol, 5, 8.

West,T.P. and O’Donovan,G.A. (1982) Repression of cytosine deaminase by pyr—
imidines in Salmonella typhimurium. J. Bacterial, 149, 117171174.

Wollenweber,H.W. et al. (1983) Fatty acid in lipopolysaccharides of Salmonella
species grown at low temperature. Identiﬁcation and position. Eur. J.
Biachem., 130, 1677171.

Yizhak,K. et al. (2010) Integrating quantitative proteomics and metabolomics with
a genome—scale metabolic network model. Bioinformatics, 26, i2557i260.

Yoon,H. et al. (2011) Systems analysis of multiple regulator perturbations allows
discovery of virulence factors in Salmonella. BMC Syst. Biol, 5, 100.

 

2908

112 /310'sleuin0[p103x0'sopeuiJOJurorq/ﬁduq 11101} papeolumoq

91oz ‘Og isanV uo ::

