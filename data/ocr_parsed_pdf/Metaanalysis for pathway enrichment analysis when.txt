ORIGINAL PAPER

Vol. 26 no. 10 2010, pages 1316-1323
doi: 1 0. 1093/bioinformatics/btq 148

 

Gene expression

Advance Access publication April 21, 2010

Meta-analysis for pathway enrichment analysis when combining

multiple genomic studies
Kui Shen1 and George C. TsenglaZa3a*

1Department of Computational Biology, University of Pittsburgh School of Medicine, Pittsburgh, PA 15213,
2Department of Biostatistics and 3Department of Human Genetics, University of Pittsburgh Graduate School of

Public Health, Pittsburgh, PA 15261, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Many pathway analysis (or gene set enrichment
analysis) methods have been developed to identify enriched
pathways under different biological states within a genomic study.
As more and more microarray datasets accumulate, meta-analysis
methods have also been developed to integrate information
among multiple studies. Currently, most meta-analysis methods
for combining genomic studies focus on biomarker detection and
meta-analysis for pathway analysis has not been systematically
pursued.

Results: We investigated two approaches of meta-analysis for
pathway enrichment (MAPE) by combining statistical significance
across studies at the gene level (MAPE_G) or at the pathway
level (MAPE_P). Simulation results showed increased statistical
power of meta-analysis approaches compared to a single study
analysis and showed complementary advantages of MAPE_G and
MAPE_P under different scenarios. We also developed an integrated
method (MAPE_I) that incorporates advantages of both approaches.
Comprehensive simulations and applications to real data on drug
response of breast cancer cell lines and lung cancer tissues were
evaluated to compare the performance of three MAPE variations.
MAPE_P has the advantage of not requiring gene matching
across studies. When MAPE_G and MAPE_P show complementary
advantages, the hybrid version of MAPE_I is generally recommended.
Availability: http://www.biostat.pitt.edu/bioinfo/

Contact: ctseng@pitt.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on 16 November 2009; revised on 13 March 2010;
accepted on 5 April 2010

1 INTRODUCTION

Microarray technology provides the ability to detect genome-wide
gene expression activities with thousands of probes printed on each
high-density chip. It has evolved rapidly in the past decade and
has gradually become a standard tool for many biomedical studies.
The high-throughput nature of the technology requires development
of suitable statistical and bioinformatic methods to analyze the data.
Pathway analysis (a.k.a gene set analysis) was developed to correlate
the identiﬁed gene list from microarray data with a priori deﬁned

 

*To whom correspondence should be addressed.

gene sets usually from biological pathway databases. As shown
in Figure 1A, pathway analysis usually has three main steps. The
ﬁrst step is to calculate the association of each gene’s expression
pattern with phenotype, which is often evaluated by t-statistics or
correlations. The second step is to map the genes into a predeﬁned
pathway database and compute the enrichment evidence score of
a pathway, which summarizes association scores of genes in the
pathway. Finally, the P-value and Q-value of each pathway are
calculated based on an appropriate permutation test. The ﬁrst naive
way for pathway analysis is to compare the number of differentially
expressed (DE) genes in and outside a pathway using Fisher’s exact
test (Hosack et (11., 2003). This method was improved by gene
set enrichment analysis (GSEA) (Subramanian et (11., 2005), an
innovative method that consider the gene order and is based on
association strength with phenotype instead of 0—1 indicator of being
a DE gene or not. Despite the popularity of GSEA, later studies
have reported its low statistical power. Tian (Tian et (11., 2005) and
Geoman (Goeman and Buhlmann, 2007) discussed the statistical
framework of pathway analysis and Tian proposed two powerful
procedures: one permuting genes and the other permuting samples.
Newton et (11. (2007) introduced a random set approach. Efron and
Tibshirani (Efron and Tibshirani, 2007) further improved GSEA
by introducing a max—mean procedure and a re-standardization
procedure.

The wide applications of microarray technology have led to an
explosion of gene expression proﬁling studies publicly available.
However, the noisy nature of microarray data, together with
the relatively small sample size in each study, often results in
inconsistent biological conclusions (Ein-Dor et (11., 2005; Tan et (11.,
2003). Therefore, methods for synthesizing multiple microarray
studies are in tremendous need. Meta-analysis, a set of statistical
techniques to combine results from several studies, has been
recently applied to microarray analysis to increase the reliability and
robustness of results from individual studies. In traditional statistics
literature, Fisher’s statistic (Mosteller and Fisher, 1948) (sum of
log-transformed P-values), minimum P-value statistic (Tippett,
1931) and maximum P-value statistic (Wilkinson, 1951) have been
proposed and compared. For combining microarray studies, current
‘meta-analysis’ in the biological literature contains a widespread
use of naive intersection/union operations or simple counting of
appearances in the DE gene lists obtained from individual studies
under certain criteria (e.g. false discovery rate=0.05) (Borovecki
et (11., 2005; Cardoso et (11., 2007; Pirooznia et (11., 2007; Segal et (11.,
2004) and many more. One can quickly note that intersections are

 

1316 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /3.Io's[Bruno[pJOJXO'sorwuiJOJurorqﬂ:duq 11101} popcolumoq

9103 ‘{g anﬁnv 110::

MAPE

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

   

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Study 1 Study K Study 1 Study K
Phenotype Phenotype Phenotype Phenotype Phenotype
m X Array II) X1 5 Array w Xk 5 Array In X1 5 Array :0 Xk 5 Array
3 «9936 data 3 1592C; data 8 1SggG data “:3 1592C; data g 9G data
8 {SS—SS matrix 8 15553 matrix 8 1 $555 matrix $ 15553 matrix Q) —5—5 matrix
Samples Samples Samples Samples Samples
I Pathway I Pathway I Pathway
database database database
3 t9 Pathway Study 1 Study K Pathway Study 1 Study K Pathway
c
cu
I: :0 w w m w
o g 3 29p 2 tgi - 2 tgk 3 29p 2 tg1 - “2’ tgk g ng
. c 1< <(; C" P : 1< (G 0’ 0’ c 1 c,
AssoCIate 8 --g-- o ,Sggc L9 ISESG $ "2.. c) ISgG (3 [Sggﬁ 8 . _
score with 13351) 13,9: 1,
phenmype Associate score with phenotype Associate score with phenotype
” J L H  || 
V Study 1 Study k
P ug
1gpSP “£6 Vp1 _ _ _ Vpk
1 SP3 1‘ leper
Paterlzvdaeﬁignsizrpeem Association with phenotype after
metaaanalysis at gene level Pathway enrichment eVIdence score
III III
vp Wp
1 :Epz-IP 13331)
Pathway enrichment Pathway enrichment
A; Pathway enrichment analysis evidence score using B MAPE G evidence score using C MAPE P
MAPE,G MAPEiP
: l
|
: $9 I
l 1SPSP l
l D MAPE I l
I

Fig. 1. Diagram for MAPE analysis. (A) Pathway enrichment analysis for an individual study; (B) MAPE_G; (C) MAPE_P; (D): MAPE_I.

often too conservative and unions are anticonservative, especially
when the number of studies increases. Rhode et (11. (2002) was the
ﬁrst to apply Fisher’s method to microarray data for a real sense of
meta-analysis. Many other approaches have been proposed since
then, including random effects model (Choi et (11., 2003), latent
variable approach (Choi et (11., 2007) and Bayesian approaches
(Shen et (11., 2004). Currently, meta-analysis methods for microarray
studies are mostly aimed at combining different studies to identify
DE genes, an analysis at the gene level. However, DE gene analysis
has two main shortcomings. First, the identiﬁed DE genes often
do not directly relate to the phenotype of interest. Second, a gene
set from an important pathway may act in concert with moderate
activities, which cannot be detected by DE gene analysis, while the
pathway may have important biological effects on the phenotype
of concern. Pathway analysis has an inherent advantage for work
with meta-analysis. It is well known that the lists of DE genes from
independent studies associated with the same phenotype often have
little overlap (Ein-Dor et (11., 2005; Tan et (11., 2003), while pathway
analysis often generates improved consistency (Manoli et (11., 2006).
This situation motivates us to develop systematic approaches of
meta-analysis for pathway enrichment (MAPE), which provides
a more robust and powerﬁil tool than standard gene set analysis.
In this article, we investigate two natural approaches of MAPE
by combining statistical signiﬁcance across studies at the gene
level (MAPE_G) before pathway analysis or at the pathway level
(MAPE_P) after pathway analysis (Fig. 1B and C). Simulation
results and applications to real datasets show their complementary
advantages under different scenarios. We, thus, introduce an
integrated method (MAPE_I) that incorporates the advantages of
both MAPE_G and MAPE_P. MAPE_G and MAPE_P have been
implicitly or explicitly used in a few publications (Setlur et (11.,

2007; Thomassen et (11., 2008) while a systematic methodology
and a rigorous evaluation have not been investigated. To our
knowledge, this is the ﬁrst article to systematically develop and
evaluate meta-analysis for pathway analysis in microarray studies.

2 METHODS
2.1 Framework of MAPE_G and MAPE_P

Figure 1 presents the general framework of pathway enrichment analysis
for single study (Fig. 1A) and three variations of MAPE methods proposed
in this article (Fig. 1B7D). MAPE_G combines P-Value information from
multiple studies at the gene level in Step II of Figure 1B. In contrast. MAPE_P
integrates P-Values at the pathway level in Step III of Figure 1C. Since
MAPE_G and MAPE_P have complementary advantages under different
scenarios that will be demonstrated by extensive simulations in a later
section. a hybrid form of MAPE_I is proposed in Figure 1D to incorporate
merits of both methods (Fig. 1D).

Mathematical notations and data structure of Figure 1 are described
below. Figure 1A describes framework for pathway analysis in a single
study. Suppose a data matrix {xgx} (1 5 g 5 G. 1 5 s 5 S) represents the gene
expression intensity of gene g and sample s. A binary phenotype label is
available for each sample: {y,,} (1 5 s 5 S) and y: E {0.1} (e.g. 0 represents
normal patients and 1 represents tumor patients). A pathway database
matrix {zgp} (1 5 g 5 G. 1 5 p 5 P) represents the pathway information of
P pathways where zg], = 1 when gene g belongs to pathway [7 and zg], = 0
otherwise. In Step I of Figure 1A. the association score with phenotype in
each gene g is ﬁrst calculated as lg (usually by t-statistics or a correlation
measure). In Step II. a pathway enrichment evidence score V1) is calculated
for each pathway [7 [e.g. KolmogoroviSmirnov (KS) statistics or mean
of t-statistics]. A gene-wise and/or sample-wise permutation test is then
performed to assess the statistical signiﬁcance of V1,. Normally Q-Values
[q(v],)] are evaluated and the false discovery rate is controlled at 5% (meaning
among detected pathways. on average 5% are false discoveries) or sometimes

 

1317

112 /3.Io's[Bruno[pJOJXO'soiwuiJOJurorqﬂ:duq 11101} papBOIII/lAOG

9103 ‘{g anﬁnv 110::

K.Shen and G.C.Tseng

 

at relaxed 10 or 15%. In ﬁnal conclusion. all pathways with a Q-Value <5%
are reported as enriched pathways [i.e. {p: q(v],) 5 5% }].

When combining multiple studies. we assume genes in multiple studies
are matched and no missing value exists. In Figure 1B and C. denote by
{xkgx} (1 5 k 5 K. 1 5g 5 G. 1 5 s 5 St) the expression intensity of gene
g and sample s in study k. {ka} (1 SkSK. lfsfSk) and ykxe{0.1}
represents the phenotype label for sample s in study k. Figure 1B shows the
procedure for the MAPE_G method. In Step I. the association scores with
phenotype are calculated in each study [i.e. {tgk }. 1 5 g 5 G, 1 5 k 5 K]. In
Step II. meta-analysis is performed for biomarker detection and produces
a new association score after meta-analysis at the gene level [i.e. {Mg}.
1 5 g 5 G]. In Step III. the pathway enrichment analysis is performed as
in Step II in Figure 1A. The evidence scores {V1,}, corresponding Q-Values
{q(v],)} and a list of enriched pathways are then generated. This method
can be Viewed as a natural combination of meta-analysis for biomarker
detection (Steps I and II) and pathway enrichment analysis (Step III) in
a sequential manner. Rhodes (Rhodes et al.. 2002) has implicitly performed
similar analysis by ﬁrst querying DE genes from meta-analysis and then
assess pathway enrichment using the KEGG database (Kanehisa and Goto.
2000). For MAPE_G proposed in this article. we replace the aa1 hoc two-stage
procedure with a uniﬁed evaluation by permutation test.

In Figure 1C. the framework for MAPE_P is shown. The Step I of
association scores for each study is identical to that in MAPE_G. In Step
11. instead of performing meta-analysis at the gene level. we performed
pathway enrichment analysis in each individual study to obtain the study-
wise pathway enrichment evidence scores: {ka} (1 5 k 5 K . 1 5 p 5 P). The
meta-analysis on the pathway level was then performed in Step III to derive
the combined evidence score WP. Finally. the corresponding Q-Values. q(w],).
are assessed by permutation test.

2.2 Example pathways showing complementary
advantages of MAPE_G versus MAPE_P

It is easily seen that MAPE_P has an important advantage in that the genes
across multiple studies need not be matched to perform meta-analysis as
needed in MAPE_G (Step II of Fig. 1B). Speciﬁcally. we can relax the data
setting in Figure 1C to {xkgx} (1 5 k 5K.15g 5 Gk. 15 s 5 Sk) and {tkg}
(1 5 g 5 Gk, 1 5 k 5 K) so that different studies may have a different number
of genes and the genes are not matched across studies. The gene matching
issue is particularly signiﬁcant when studies from different microarray
platforms are combined. Supplementary Table 3 shows summary statistics of
two lung cancer studies to be combined. The Bhat study used the Affymetrix
HG-U95A platform and the Beer study used Affymetrix HU6800. Only 5515
Entrez genes overlapped across the two studies and the MAPE_G method
had to drop information from 3490 out of 9005 genes that appear in Bhat but
not in Beer. When more studies of different array platforms are included. the
number of overlapping genes will decrease dramatically. Published studies
have also demonstrated weak consistency across studies at the gene level
but increased consistency at the pathway level (Ein-Dor et al.. 2005; Manoli
et al.. 2006; Tan et al.. 2003). From these points of View. MAPE_P seems
to be preferable to MAPE_G in general.

When we analyzed a combination of two lung cancer studies. however.
we identiﬁed some example pathways with better power by MAPE_P and
others with MAPE_G. Supplementary Figure 2 show scatter plots of Q-Values
obtained from MAPE_P and MAPE_G at minus log scale. The result shows
somewhat general agreement in two methods while presents many discordant
pathways detected by one method but not by the other. To gain a better
intuition of why and how this happens. Figure 2A and B shows two example
pathways of ALCALAY_AML_NPMC_UP (AANU; genes with increased
expression in acute myeloid leukemia bearing cytoplasmic nucleophosmin)
and HDACI_COLON_TSABUT_UP (HCTU; genes upregulated by both
butyrate and trichostatin A at any time point up to 48 h in SW260 colon
carcinoma cells). based on the C2 collection of MsigDB. a biology pathway
database for cancer provided by Broad institute (Subramanian et al.. 2005).
AANU was identiﬁed as an enriched pathway by MAPE_P but not by

MAPE_G (Fig. 2A and C). In contrast. HCTU was identiﬁed by MAPE_G
but not by MAPE_P (Fig. 2B and D). We performed DE gene analysis by
t-test adjusted by BenjaminieHochberg procedure in each study separately
[false discovery rate (FDR) =5%] and displayed only biomarkers detected
by either study in Figure 2A7D. In Figure 2A and C. we found that 13 genes
were identiﬁed as DE genes in both studies in the AANU pathway (gene set
I in Fig. 2A). Thirteen genes were DE in Beer but not in Bhat and 27 genes
were DE in Bhat but not in Beer (gene sets 11 and III in Fig. 2A). To explain
the ‘MAPE_P preferred pathway” in Figure 2A and ‘MAPE_G preferred
pathway” in Figure 2B. we deﬁned a simple concordance index (CI) as the
ratio of common DE genes in both studies versus DE genes in at least one
of the two studies. The AANU pathway was detected by MAPE_P but not
by MAPE_G because the CI is as low as 13/(13 +13 + 27) = 0.245. When we
pursued meta-analysis at the gene level. fewer genes were signiﬁcant in Step
II of Figure 1B although the meta-analysis at the pathway level in Step III
of Figure 1C is statistically signiﬁcant. On the other hand. the high CI in the
HCTU pathway [CI = 13/(13 + 1 + 9): 0.565] was intuitively associated with
the high statistical power of MAPE_G while MAPE_P did not detect this
pathway. Such high CI pathways detected only by MAPE_G are usually
important because the biomarkers are repeatedly identiﬁed in multiple
studies. From the two example pathways above. we conclude that although
intuitively MAPE_P has the convenience of not having to match genes across
studies. MAPE_G has an advantage in some other particular situations.
Based on this ﬁnding. we developed extensive simulations (shown in the
Section 3) to illustrate conditions when MAPE_G outperforms MAPE_P
and Vice versa.

2.3 Framework of MAPE_I

Since pathways detected by both MAPE_G and MAPE_P are of biological
interest. we proposed a simple integrative method. namely MAPE_I. to
incorporate the complementary advantages of both methods (Fig. 1D).
Speciﬁcally. we used a minP statistic that takes the minimum P-Value from
MAPE_G and MAPE_P for each pathway [i.e. sp =min(p(v],), p(w],))].
The statistical inference and control of FDR were similarly performed by
permutation analysis (see detailed algorithm in Fig. 3).

2.4 Detailed implementation

Numerous pathway analysis and meta-analysis methods for microarray data
have been described. Most of these methods have pros and cons under
different conditions and for different biological purposes. Under the general
framework shown in Figure 1 for MAPE_G. MAPE_P and MAPE_I. we
can Virtually apply and combine any pathway analysis and meta-analysis
method for implementation. There are four major considerations and choices
in practice.

2.4.1 Statistic selection for association evidence with phenotype For
simplicity. we considered t-statistics for a binary phenotype label in this
article. For multiclass. continuous or censored survival phenotype. different
test statistics. such as F -statistics. Pearson correlation measure or statistics
from Cox proportional hazard model. may be used. respectively.

2.4.2 Statistic selection for meta-analysis Various meta-analysis
statistics. including Fisher’s statistic. minimum P-Value statistic (minP)
and maximum P-Value statistic (maxP). have been discussed in the
Section 1. The best choice of meta-analysis statistics depends on the
particular biological goal of interest. Following the convention of Birnbaum
(Birnbaum. 1954). two different hypothesis settings may be considered:

HsA:{Hozelg=---=9Kg=0 versus HA:9kg7éO,V1 SkSK}
HSB:{H0:ng=---=6Kg=0 versus HA: at least one 9kg750}

where 6kg represents the effect size of gene g in study k. HSA corresponds
to the biological question: ‘which genes are consistently differentially
expressed in all studies?’. In contrast. HSB detects genes if they are DE

 

1318

112 /3.Io's[Bumo[pJOJXO'soiwuiJOJurorqﬂ:duq wort papeolumoq

9103 ‘{g anﬁnv uo ::

MAPE

 

C

     
 
    

Beer
Bhat

      
 

0. - 02 -0.5 01 r- 02 =0.75

 

I31 =0a =1

      
 
    

 

§   0.4
a E a "2

d C, a ‘3 0.0
§ § § 0.2
a! :9 :2 41"
ci 9' cs

0.4 0.5 0.6 0.? 0.8 0.9 1.0 0.4 0.5 0.6 0.? 0.0 0.9 1.0 0.4 0.5 0.6 0.7 0.8 0.9 1.0
01:02:15 0. =0, =2 01: 02 =4

04 05 0.8 0.7 0.8 0.9 1.0 0.4 0.5 0.6 0.? 0.8 0.9 1.0 0.4 0.5 0.8 90:? 0.8 0.9 1.0

' ' 1 9L

  
  
  
    

 

 

 

0.16 0.23 0.24 0.28

0.16 OZ] 0.24 0.28
mm

0.16 0.20 0.24 0.26

 

 

HI ' 92 '0-5

0.4 0.5 0.0 0.1 0.0 0.0 1.0 0.4 0.5 0.0 0.7 0.0 0.0 1.0 0.4 0.5 0.0 0.7 0.0 0.0 1.0 0.4 0.5 0.6 0.7 0.0 0.9 1.0
0.. =05. k=1....,4 0., '1. k-1.....4 9: =2. k=1....,4 0.. '4. k-1.....4

0.4 0.5 0.0 0.7 0.8 0.0 1.0 0.4 0.5 0.5 0.7 0.6 0.0 1.0 0.4 0.5 0.6 0.? 0.8 0.9 1.0 0.4 0.5 0.6 0.? 0.6 0.0 1.0
0.. '05. k-1.....10 (1,, -1, k-1.....10 0.. -2. k-1....,10 0., =4, k=1,...,10
5

01 =02-1

 

0.16 0.2] 024 0.28
0.16 0.20 0.24 0.26
0.16 0.30 024 0.20
0.16 0.20 0.24 11%

 

      
 

   
 

0.16 0.20 0.24 026

0.16 0.20 0.24 0.23

0.16 020 0.24 020
0.16 0.20 0.24 0.26

K=10

0.26

0.16 0.20 0.24 0.26
0.16 020 0.24 0.3

 

0.16 0.20 0.24 0.26

0.16 0.20 0.24

0.80 0.65 0.90 0.9 1.00 0.00 0.65 0.90 0.95 1.00 0.53 0.65 0.00 0.95 1.00 0.00 0.86 Oil-'0 0.95 1.00
A K

Fig. 2. (A and B) Heatmaps of genes in two example pathways identiﬁed by MAPE_P alone and by MAPE_G alone, respectively, in lung cancer studies.
AANU in 2A is detected by MAPE_P (q = 0.007) but not by MAPE_G (q = 0.073) whereas HCTU in 2B is detected by MAPE_G (q = 0.016) but not MAPE_P
((1: 0.071). The Q-Values of each individual gene (on the row) and study (on the column) are shown by gradient color in —log (base 10) scale. Gene set I
contains biomarkers with Q-Value <0.05 for both studies and gene sets H and III contain signiﬁcant biomarkers (q < 0.05) in one of the studies. (C and D)
Venn diagram of biomarkers detected by each individual study (Beer and Bhat) in AANU and HCTU. (E) Power difference between MAPE_P and MAPE_G
for Various or and A when 01 = 02 :05, 0.75, 1, 1.5, 2 and 4. Yellow/red color shows better power of MAPE_P over MAPE_G and blue color Vice versa.
Solid lines show contours of equal power between MAPE_P and MAPE_G. (F) The blue, green and red lines indicates the power of MAPE_P, MAPE_G and
MAPE I, respectively, when 6 = 4, or = 0.2. (G) Power difference between MAPE P and MAPE G for Various or and A when combining 2, 4 or 10 studies.

1319

10 /3.IO'S[BHmO[p.IOJXO'SOIJBIIIJOJIIIOIq”K1111.) 0101} papeoIH/uoq

910g ‘19 JSanV 110::

K.Shen and G.C.Tseng

 

 

Procedures of MAPE_G
I. For a given study k. compute P-Values of differential expression:

3. Estimate the P-Value of tgk as pg“ ) = 25:12:] 1(

 

II. Meta-analysis:

III. Enrichment analysis:

Procedures of MAPE_P
I. Pathway enrichment analysis:

3. Permute gene labels B times. and calculate the permuted statistics. v

120;?) = ZS..Z’,’..I<v‘,’?2 2 nib/(RP) .
II. Meta-analysis:

Procedures of MAPE_I

2. Estimate the P-Value as p(sp) = 25:1 23:1 1(s1pb.) S sp)/(B ~ P) .

 

1. Compute the t-statistic. tgk. of gene g in study k, where 1 S g S G, 1 S k SK.

2. Permute group labels in each study B times. and calculate the permuted statistics. t1”) where 1 S b S B.

ziléglzlzgkl)/(B.G) and P-Value of tgi) as 170;?)=25=123:1I(lt$2|ZItLZ)I)/(BrG)-

1. The maximum P-Value statistic (maxP) . I13 : max lngK p(tgk) . is applied for the meta analysis. Similarly. 113 = maxlSkSK p(tgk .

2. Estimate the P-Value of maxP statistics as Mug) = Efﬂzjﬂlmtgét S ug)/(B.G) .

1. Given a pathway p. compute v,,. the KS statistic for gene set enrichment based on p013).

2. Permute gene labels B times. and calculate the permuted statistics. v‘p’” . 1 5115B.
3. Estimate P-Value of pathwayp as p(vp) = 2112;1109 2 vp)/(B - P) and similarly calculate p(vy’)) = 25:21” Avg?" 2 vi,“ )/(BrP) .
4. Estimate Q-Value of pathway p as 61(1)”): 730 .Zfﬂziﬂ 10,1113) 3 VP),:1 10,”, g VI»), where 72",) is an estimate of the proportion of non-enriched

pathways. Following Storey (2002). we may estimate 730 = 2::11(p(vp)e A)/P~l(A) . where A=[0.5. 1] and l(A)=0.5. In practice. many reports
have indicated the intrinsic difficulty in estimating 2:0 and a poor estimate of no can greatly deteriorate the FDR estimation. A conservative suggestion
is to always set 710 = 1 and it is adopted throughout this paper. PMAPLG : {p : q(vp) S 0.05} is the enriched pathways obtained by MAPE_G.

1. For each study k. Calculate p(tgk) . the p-Value of gene g. by Student t-test. 15gSG.

2. Given a pathway p. compute the KS statistic vpk that compares the P-Values (p(tgk)) inside and outside the pathway.

(1;) 

pk’

4. Estimate the P-Value of KS statistic in pathway p and study k as p(vpk)=2,:lz:: 7:1 [(vlb)>vpk)/(B~ P) and similarly calculate

1. The maximum P-Value statistic (maxP) is applied for meta-analysis: wp : max 1ng K p(vpk) and WW = max 1ng K p(vpk .
2. Estimate P-Value opr as p(wp) = 25:12::1ng’.) S WP )/(B ~ P) . Similarly p(w;:’)) = 25:12::1Hwy’.“ S wX’U/(B ~ P) .

3. Estimate Q-Value as q(wp) = 25:12::1Hw2’?) S W], )/(B - 2:; [(WP. S W], )). PMAPEJ, : {p : q(wp) S 0.05} are enriched pathways from MAPE_P.

1. Let sp : min (p(vp), p(wp)) and s2” = min(p(v(p”)).p(w(p”))) from Procedures in MAPE_G and MAPE_P in Figure 3 and 4.

3. Estimate Q-Value as q(sp) = 2112;1st S sp)/(B - 21;,:11(sp. S sp)). PMAPEJ : {p : q(sp) S 0.05} are enriched pathways identified by MAPE_I.

gk’

(1)) (II)

p ':1

p.k _

(ll) (17)

 

 

Fig. 3. Detailed algorithms of MAPE_G. MAPE_P and MAPE_I.

in one or more studies. It can be seen that maxP corresponds to HSA. and
Fisher’s statistic and minP correspond to HSB. In this article. we focus
on the conservative maxP statistic to identify consistent biomarkers across
all microarray studies. Speciﬁcally. we will ﬁrst calculate the P-Values
of evidence scores at the gene level in Step II of Figure 1B or at the
pathway level in Step III of Figure 1C. The maxP statistic for meta-
analysis at the gene level is Mgzmﬂxlskst(lgk) and the pathway level
is w]; =maXI sk:KP(Vkp)-

2.4.3 Statistic selection for the pathway enrichment analysis method The
goal of pathway analysis is to test whether genes in a pathway are coherently
associated with the phenotype of interest. The ﬁrst widely used enrichment
evidence score was calculated by Fisher’s exact test to determine whether
the ratio of DE genes in a pathway is higher than the ratio outside the
pathway with statistical signiﬁcance. The shortcoming of Fisher’s exact
test is that it loses information by only counting the number of DE
genes instead of considering the gene order. which can be overcome by
using averaged t-statistics or KS statistics. In this article. we apply KS

statistics (described in Supplementary Material) for the pathway enrichment
analysis.

2.4.4 Control of false discovery and evaluation of Q-value The P-Values
and Q-Values of the pathway enrichment evidence score are usually computed
by permutation test. considering that the null distribution is difﬁcult to
obtain analytically. Two basic permutation procedures. gene permutation
and phenotype permutation. have been proposed based on two related but
not equivalent null hypotheses. Q1 and Q2. respectively. as follows:

Q1: the genes in a gene set have the same pattern associated with the
phenotype of interest as the genes outside of the gene set.

Q2: no genes in the gene set having expression patterns associated with
the phenotype.

Details about these two null hypotheses have been discussed by Tian
(Tian et al.. 2005) and Geoman (Goeman and Buhlmann, 2007). and
both approaches have their limitations. Brieﬂy. Q1 with gene permutation
takes the background information (the expression of genes outside of the
pathway) into consideration while destroys the gene correlation structure
in the data. Q2 with sample permutation preserves the gene correlation

 

1 320

112 /3.Io's112an0[p.IOJxosoiwuiJOJurorq”:duq 01011 papeo1umoq

9103 ‘1g1sn8nv uo ::

MAPE

 

structure while ignores the background information. How to explain and
integrate the different test results by Q1 and Q2 is still an open question. Tian
proposed a heuristic gene set ranking by the average rank from phenotype
permutation and gene permutation tests. The GSEA adopted a hybrid method
that generates null distribution under Q2 and used KS statistics to test Q1.
Efron (Efron and Tibshirani. 2007) proposed Gene Set Analysis (GSA)
analysis by using a max-mean statistics and re-standardization procedure.
A bootstrap method and new null were introduced by Barry et al. (2008) to
overcome the weakness of both gene and sample permutation. Conceptually.
any gene set analysis method described above can be adopted into our general
framework depicted in Figure 1. For simplicity and fast computation. we used
the KS statistic for Q1 (i.e. gene permutation) to illustrate our enrichment
procedure in this article. Detailed algorithms for MAPE_P. MAPE_G and
MAPE_I are given in Figure 3. respectively.

3 RESULTS

3.1 Simulation results

We applied a one-pathway simple simulation model to compare
the power of MAPE_G, MAPE_P and MAPE_I and to identify
conditions (parameter subspaces) in which one method outperforms
the other. We deﬁne the type of biologically relevant pathways
with statistical power of MAPE_G greater than that of MAPE_P
as ‘MAPE_G preferred pathways’ and deﬁne ‘MAPE_P preferred
pathways’ similarly. The simulation results below will gives us
insight into the unique advantages of MAPE_G and MAPE_P,
respectively, and argue the necessity of MAPE_I when both
MAPE_G preferred and MAPE_P preferred pathways exist in the
data and we are interested in detecting both types of biologically
relevant pathways.

Suppose G=500 genes are contained in the genome. The ﬁrst
100 genes belong to a pathway. Our pathway database has only one
pathway (p = 1): {181,},ng :1 when 1 f g f 100 and zgp :0 when
101 f g f 500. We generate a random binary vector D: {d1, ..., dc}
to indicate whether gene g is a DE gene or not. In the ﬁrst 100 genes,
a total of 100x01 genes are DE genes (i.e. 251,201 (18: 100-01). In
the next 400 genes, a total of 100x 010 genes are DE genes (i.e.
2220101 (18 = 400-010). We ﬁx (10 = 0.1 in our simulation. Intuitively,
there is no pathway enrichment if (1:01 and pathway enrichment
exists ifOl > 0.1.

Given the DE gene indicators, two independent array studies are
subsequently simulated for meta-analysis. We assume each study
contains S :40 samples. The ﬁrst 20 samples are controls and
the next 20 samples are cases (i.e. ys :0 if 1 f s§20 and ys :1
if 21 fsf40). When gene g is a DE gene (dg= 1) and for all
k, the expression intensities are simulated from xkgs ~N (6,1) if
13 s f 20 and xkgs ~N (0,1) if 21 f s 340. For a non-DE gene g
(dg = 0), the expression intensities are simulated from xkgs ~N (0,1)
Vs and k. We further assume that the two array studies adopt different
array platforms and each of them only covers a portion of genes in
the genome. We assume the chance of each gene to be covered
by study k is randomly generated with a sampling rate Ak. The
sampled indicator vectors for gene g in study k is denoted by hgk,
where hgk :1 if gene g appears in study k and hgk :0 otherwise.
In the following, we set A =Pr(hgk =1)=Ak (1 f g f G: 500 and
1 f k f K = 2). As aresult, study k contains Gk = Zgzl hgk genes in
the data matrix, which is a random variable and may be different in
each simulation. The overlapped gene set of the two studies contains
G’ = Zgzl hgl -hg2. In the implementation of MAPE_P, the original

data in both studies with G1 and G2 genes can be used. For MAPE_G,
the method requires only matched genes and the overlapped gene
set G’ in each study will be applied.

We perform at = {0.15, 0.2, 0.25, 0.3} and A = {0.4, 0.6, 0.8, 1} in
this article. A total of B = 200 independent simulations are performed
for each parameter setting. Intuitively, 6 represents the effect size
of the DE genes in the data, at represents the strength of pathway
enrichment and A represents the coverage of an array platform on the
genome. The power calculation of MAPE procedures is calculated
as the proportion of occurrences that the pathway is claimed as an
enriched pathway (details shown in the Supplementary Material).
Five simulation scenarios have been extensively explored below.

Scenario 1 (different degrees of effect sizes): 61 = 62 :05, 0.75,
1, 1.5, 2 and 4.

Scenario 2 (unequal effect size or equivalently unequal sample
size across studies): (61 :2, 62 = 3) and (61 =2, 62 =4).

Scenario 3 (increasing number of studies): 61 =  = 64 = 0.5, 1, 2
and 4; 61 = ...=610=0.5, 1, 2 and 4.

Scenario 4 (varying effect sizes across genes): 618 = 628 ~N (1.5,
0.5), N (2, 0.5) and N (4, 0.5).

Scenario 5 (inclusion of one weak signal study): (61 = 62 = 63 = 2,
64 :01) and (61 =62 = 63) ~ N (2, 0.05), 64 ~N (2, 0.2).

Results of Scenario 1 of varying effect sizes and Scenario 3
of varying number of studies are displayed in Figure 2E and G.
The power difference of MAPE_P and MAPE_G are displayed by
gradient colors under different at and A conditions. The smooth
contour plots are performed with a surface smoothing technique
using the R package ‘ﬁeld’ (Fields Development Team, 2006)
and the solid lines demonstrating equal statistical power between
MAPE_G and MAPE_P are shown in each plot. In the weak
signal situation in Figure 2E (61 = 62 = 0.5), MAPE_G outperforms
MAPE_P. For medium signal conditions (61 :62 =0.75, 1 and
1.5), MAPE_P generally outperforms MAPE_G. Finally, when
the effect sizes are large (61:62=2 and 4), MAPE_G is more
powerﬁll when the array coverage rate A (0.8 f A f 1) is high or
the pathway enrichment strength at is low (0.15 f A f 0.2). On the
other hand, for a low array coverage rate A (0.4 3A 30.7), the
advantage of MAPE_P of not requiring gene matching across studies
becomes evident and MAPE_P is more powerful than MAPE_G.
In Figure 2G, MAPE_P has increasingly better statistical power
than MAPE_G when the number of studies increases from 2 to 10.
The detailed results of statistical power of MAPE_G, MAPE_P and
the corresponding power difference are shown in Supplementary
Figures 3, 5.1 and 5.2.

Our simulation examines the power of a single pathway. In a
real application, hundreds to thousands of pathways are analyzed in
the pathway database. Both types of pathways for which MAPE_G
or MAPE_P have better power will co-exist in an analysis. This
motivates our development of an integrated method MAPE_I to
incorporate the advantages of the two methods. Figure 2F shows
the power curves of the three methods when 6:4, (1:02 and
varying A. MAPE_I clearly has more robust and better performance
over MAPE_G and MAPE_P on the two extremes of small and
large A. The power curves in Supplementary Figures 3B, 5.1B and
5.2B show that MAPE_I generally has the best or near the best
statistical power among the three MAPE variations.

Results of Scenario 2 (unequal effect size across studies),
Scenario 4 (varying effect sizes across genes) and Scenario 5
(inclusion of a weak signal study) are shown in Supplementary

 

1321

112 /3.Io's112an0[p.IOJxosoiwuiJOJurorq”:duq 01011 papeo1umoq

9103 ‘1g1sn8nv uo ::

K.Shen and G.C.Tseng

 

A B

Liedtke (25} Neue (21] MAPE P {60} MAPE_ G {36]

v-

MAF‘E H541 MAPE H54}
C 1')

Beer {29} Bhat [153} MAPE_P (1 37) MAPE_G (31}

o c

MAPE_I {114] MADE__I (114}

Fig. 4. Venn diagram comparing pathways detected by individual studies and
by the three MAPE methods. (A and B) Application in combining Liedtke
and Neve breast cancer drug response studies. (C and D) Application in
combining Beer and Bhat lung cancer studies.

Material (Supplementary Figs 4, 6 and 7). The conclusions did not
alter those from the basic simulation of Scenario 1. For Scenario 5,
inclusion of a weak signal study does not affect the conclusion,
showing robustness of meta-analysis when majority of studies
contain concordant information.

3.2 Two applications in breast cancer cell line’s drug
response studies and lung cancer studies

We applied the proposed methods to two applications: drug response
in breast cancer cell lines and lung cancer studies. The pathway
database used was the C2 collection of MsigDB described earlier.
There were 1892 pathways in total in the C2 collection. We only
tested pathways with pathway size (# of genes) larger than 15 and
less than 500 in the data. Under this criterion, 970 pathways are
tested in the lung example and 704 pathways in the breast cancer
example. In the ﬁrst application, microarray datasets from two
independent breast cancer cell line studies were downloaded from
public websites (details see Supplementary Material). The breast cell
lines’ sensitivity or resistance to paclitaxel was determined by 50%
growth inhibitory concentrations. We applied MAPE approaches
to identify enriched pathways that are related to drug response to
paclitaxel in breast cancer cells. Drug response-related pathways
provide important information for studying mechanisms of drug
resistance and will shed light to new pharmaceutical targets or
techniques to overcome resistance. Figure 4A shows a venn diagram
of pathways detected by each individual study and by MAPE_I
when Q-value cutoff was set to 0.15. Clearly, meta-analysis provides
better statistical power to identify more pathways that individual
analyses cannot discover (54 pathways identiﬁed by MAPE_I versus
28 and 21 pathways identiﬁed by each individual study). Among the
27 pathways detected by MAPE_I but not by either individual study
analysis (category IV in Fig. 4A), many are known drug response-
related pathways, including MYC- and EGF-related pathways. In
the 8 and 10 pathways identiﬁed by individual studies but not
by MAPE_I (category VI and VII in Fig. 4A), no known drug —
response-related pathway was found. In Figure 3B, 60, 36 and 54
pathways were identiﬁed by MAPE_P, MAPE_G and MAPE_I,
respectively. Among pathways detected by MAPE_P but not by

MAPE_G (see categories II and VI in Supplementary Table 2),
many are cell proliferation, gene regulation and estrogen-related
pathways. Similarly, pathways detected by MAPE_G but not by
MAPE_P (categories III and VII in Supplementary Table 2) also
include many cancer and drug response-related pathways. MAPE_I
identiﬁed top-ranked pathways detected by either methods with
the price of ignoring low-ranked pathways (categories V, VI and
VII) at (1:015. If we relax the Q-value cutoff of MAPE_I to
0.2, majority (10 out of 17) of pathways identiﬁed by MAPE_P
or MAPE_G but not by MAPE_I at cutoff 0.15 were identiﬁed
by MAPE_I, showing that MAPE_I is a good way to incorporate,
summarize and prioritize resulting pathways from MAPE_P and
MAPE_G. Details of all enriched pathway results are listed in
Supplementary Table 2. These pathways are predominantly related
to cell proliferation, oncogenic pathways and estrogen receptor-
associated pathways. In the literature, intersection or union methods
are commonly used due to their simplicity. From a statistical point
of view, the intersection method is clearly over conservative and the
union method is anticonservative by losing control of FDR. From
Figure 4A, intersection method identiﬁes only four pathways and is
too conservative. The union method identiﬁes 45 pathways, which
is fewer than 54 pathways identiﬁed by MAPE_I and loses FDR
control.

In the second example, we performed similar analysis to the
application of combining two lung cancer studies when comparing
normal versus adenocarcinoma tissues. Similar conclusions are
found in Figure 4C and D. The detailed results are shown in
Supplementary Table 4.

4 CONCLUSIONS AND DISCUSSIONS

In this article, we discussed framework and evaluation of two
meta-analysis approaches for pathway enrichment analysis, namely
MAPE_G and MAPE_P, which combine statistical signiﬁcance at
the gene level and at the pathway level respectively. In general,
MAPE_P has the advantage of not requiring gene matching across
studies and is often statistically more powerﬁil. MAPE_G is,
however, found more powerful when the majority of genes across
studies can be properly matched or when the effect sizes are
small. We proposed an integrated approach, namely MAPE_I, to
accommodate the advantages of MAPE_G and MAPE_P and to
capture pathways of potential biological interest from both methods.
Our simulation study characterized conditions of when and how
MAPE_G and MAPE_P outperform one another and veriﬁed the
robust performance of MAPE_I. Applications to breast cancer cell
line drug response and lung cancer demonstrated similar conclusions
and identiﬁed previously veriﬁed pathways related to drug response
and carcinogenesis. Meta-analysis identiﬁed more pathways than
individual studies. The MAPE_I procedure integrated results from
MAPE_P and MAPE_G and is generally recommended in practice.

To our knowledge, this is the ﬁrst article to systematically
investigate and develop meta-analysis approaches for pathway
enrichment analysis. This article provides an initial investigation of
a uniﬁed framework. Conceptually, any meta-analysis technique and
pathway enrichment method can be combined under the proposed
framework. This article has several limitations and future directions.
First of all, the conclusions are drawn in two class comparisons
using t-statistics. Our software package has allowed correlation,
F -statistics and Cox proportional hazard model to allow continuous,

 

1 322

112 /3.Io's112an0[p.IOJxosoiwuiJOJurorq”:duq 01011 papeo1umoq

9103 ‘1g1sn8nv uo ::

MAPE

 

multiclass and censored survival clinical variables while more
extensive evaluation is needed for such situations. Secondly, we
require no gene missingness across all studies for MAPE_G in this
article. This requirement could be relaxed by modifying MAPE_G
algorithm allowing gene missingness in the inference of null
distributions. Thirdly, our algorithm integrates information across
studies by taking maximum of P-values, requiring DE signal in
all studies. When many studies are combined, the maxP method
becomes too stringent and a robust r-th rank method (e.g. 70
percentile statistics across all studies) is more desirable. Finally, the
permutation test scheme in this article does not rigorously consider
gene dependency structure and potential hierarchical dependency
in pathway database (e.g. Gene Ontology). Although detailed
discussion is beyond the scope of this article, many recent methods
have been developed to answer or alleviate this problem (Benjamini
and Yekutieli, 2001; Farcomeni, 2006; Romano et (11., 2008; Tsai
et (11., 2003) and incorporation of these methods is a future direction.

As was discussed in text, many meta-analysis techniques and
pathway enrichment analysis methods have been developed in the
past few years. Another valuable future direction would involve
incorporating and evaluating the many available methods in both
areas and assess their performance to choose the best method. As
the next-generation sequencing technology is getting popular and
will become affordable for expression analysis in the near future,
the proposed methodology can be extended to such RNA-seq data.

ACKNOWLEDGEMENTS

The authors would like to thank the reviewers and the editor for
insightful suggestions and critiques.

Funding: National Institutes of Health (KL2 RR024154-04 to
G.C.T.); University of Pittsburgh (Central Research Development
Fund, CRDF; Competitive Medical Research Fund, CMRF).

Conﬂict of Interest: none declared.

REFERENCES

Barry,T. et al. (2008) A statistical framework for testing functional categories in
microarray data. Ann. Appl. Stat, 2, 2867315.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in multiple
testing under dependency. Ann. Stat, 29, 116571188.

Birnbaum,A. (1954) Combining independent tests of signiﬁcance. J. Am. Stat. Assoc,
49, 5597574.

Borovecki,F. et al. (2005) Genome-wide expression proﬁling of human blood reveals
biomarkers for Huntington’s disease. Proc. Natl Acad. Sci. USA, 102, 11023711028.

Cardoso,J. et al. (2007) Expression and genomic proﬁling of colorectal cancer. Biochim.
Biophy. Acta Rev Cancer, 1775, 1037137.

Choi,H. et al. (2007) A latent variable approach for meta-analysis of gene expression
data from multiple microarray experiments. BMC Bioinformatics, 8, 364.

Choi,J. et al. (2003) Combining multiple microarray studies and modeling interstudy
variation. Bioinformatics, 19, i847i90.

Efron,B. and Tibshirani,R. (2007) On testing the signiﬁcance of sets of genes. Ann. Appl.
Stat, 1, 1077129.

Ein-Dor,L. et al. (2005) Outcome signature genes in breast cancer: is there a unique
set? Bioinformatics, 21, 1717178.

Farcomeni,A. (2006) More powerful control of the false discovery rate under
dependence. Stat. Met/t. Appl., 15, 43773.

Fields Development Team (2006) Fields: Tools for Spatial Data. National Center for
Atmospheric Research, Boulder, CO.

Goeman,J.J. and Buhlmann,P. (2007) Analyzing gene expression data in terms of gene
sets: methodological issues. Bioinformatics, 23, 9807987.

Hosack,D. et al. (2003) Identifying biological themes within lists of genes with EASE.
Genome Biol, 4, R70.

Kanehisa,M. and Goto,S. (2000) KEGG: Kyoto Encyclopedia of Genes and Genomes.
Nucleic Acids Res., 28, 27730.

Manoli,T. et al. (2006) Group testing for pathway analysis improves comparability of
different microarray datasets. Bioinformatics, 22, 250072506.

Mosteller,F. and Fisher,R.A. (1948) Questions and answers. Am. Stat, 2, 30731.

Newton,M. etal. (2007) Random-set methods identify distinct aspects of the enrichment
signal in gene-set analysis. Ann. Appl. Stat, 1, 857106.

Pirooznia,M. et al. (2007) GeneVenn - a web application for comparing gene lists using
Venn diagrams. Bioinformation, 1, 420—422.

Rhodes,D.R. et al. (2002) Meta-analysis of microarrays: interstudy validation of gene
expression proﬁles reveals pathway dysregulation in prostate cancer. Cancer Res,
62, 44274433.

Romano,J.P. et al. (2008) Control of the false discovery rate under dependence using
the bootstrap and subsampling. Test, 17, 417442.

Segal,E. et al. (2004) Amodule map showing conditional activity of expression modules
in cancer. Nat Genet, 36, 109071098.

Setlur,S.R. et al. (2007) Integrative microarray analysis of pathways dysregulated in
metastatic prostate cancer. Cancer Res., 67, 1029G10303.

Shen,R. et al. (2004) Prognostic meta-signature of breast cancer developed by two-stage
mixture modeling of microarray data. BMC Genomics, S, 94.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-based
approach for interpreting genome-wide expression proﬁles. Proc. Natl Acad. Sci.
USA, 102, 15545715550.

Tan,P.K. et al. (2003) Evaluation of gene expression measurements from commercial
microarray platforms. Nucleic Acids Res., 31, 567675684.

Thomassen,M. et al. (2008) Gene expression meta-analysis identiﬁes metastatic
pathways and transcription factors in breast cancer. BMC Cancer, 8, 394.

Tian,L. et al. (2005) Discovering statistically signiﬁcant pathways in expression
proﬁling studies. Proc. Natl Acad. Sci. USA, 102, 13544713549.

Tippett,L.l-I.C. (1931) The Methods in Statistics. Williams and Norgate, Ltd, London.

Tsai,C. et al. (2003) Estimation of false discovery rates in multiple testing: application
to gene microarray data. Biometrics, 59, 107171081.

Wilkinson,B. (195 1) Astatistical consideration in psychological research. Psychol. Bull,
48, 1567158.

 

1 323

112 /3.Io's112an0prOJxosoneuiJOJurorq”:duq 01011 papeo1umoq

9103 ‘1g1sn8nv uo ::

