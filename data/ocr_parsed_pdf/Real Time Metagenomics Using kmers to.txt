BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Real Time Metagenomics

 

Table 1. Statistics of the k-mers and FIGfams

 

 

k-mer size Number Number Mean number Median number
of k-mers of families of k-mers of k-mers
per family per family
7 207362319 171606 1208.4 110
8 639234488 173 332 3687.9 325
9 812679 565 173513 4683.7 404
10 866382 763 173 561 4991.8 425
11 896943 566 173 587 5167.1 434
12 921081710 173 606 5305.6 441

 

The sensitivity and speciﬁcity of the k—mer approach was mea—
sured using synthetic metagenomes constructed using genomes
that were not included in the FIGfams build (Supplementary
Fig. 1). The sensitivity [TP/(TP+ FN)] measures whether genes
that are there (i.e. in the complete genome annotation) are found;
for very short DNA sequences, most genes that are there are
missed.

The k—mers are much more sensitive than blastx, finding
almost 1/5 of genes present when the fragment lengths are only
30 bp. When the fragment length exceeds 50 bp, blastx perform—
ance improves rapidly as the high scoring pairs exceed the thresh—
old for inclusion, and approaches that of the most sensitive
k—mer searches. All approaches reach a sensitivity plateau once
the sequence length exceeds 100 bp, and the best methods only
ﬁnd ~70% of the genes on the fragments. For the longest frag—
ment lengths (500 bp), the mean open reading frame length on
each fragment was only 340 bp as genes may start and end off the
fragment. In all cases, longer sequence reads resulted in more
sensitive assignment of annotations to the DNA sequences, as
seen before (Wommack et al., 2008).

The precision [TP/(TP + FP)] reports whether too many genes
are being called on a fragment. With very short fragments, both
short k—mers and blastx overcall genes. However, longer k—mers
result in more conﬁdent calls, regardless of fragment length.
BLAST precision is improved by only using the set of confidently
called proteinsithose that are in families and used to make the
k—mers. Accuracy measures whether the genes that are identiﬁed
are correctly annotated (Overbeek et al., 2005). This measure of
accuracy is testing whether the function assigned by the best
blastx hit or k—mer reﬂects of the ‘true’ function of the protein
as annotated in the genome.

k—mer searches were on average 860 times faster than blastx
because the k—mer approach neither extends the matches nor
calculates alignment statistics for the resulting matches. DNA
sequence annotations using k—mers are as sensitive, precise and
accurate as blastx searches, especially for shorter reads. The main
disadvantage of using unique k—mers is as the read—length in—
creases the blastx sensitivity exceeds that of k—mers.

As shown in Supplementary Figure l, the length of the k—mer
has a strong impact on the precision, sensitivity and accuracy of
the search. Based on these data and empirical observations, we
recommend that users require at least two k—mer matchers per

sequence (but generally no more than four k—mer matchers), and
eight— or nine—amino acid k—mers. These parameters provide rea—
sonable estimates of metagenome composition.

The k—mers represent a protein family, but not a specific or—
ganism from that family. However, most families only contain a
few proteins (the median size of the protein families is only six),
and thus most protein families only come from a handful of
species and very few genera. To assign taxonomic groups to se—
quences, we identify the last common ancestor of the organisms
whose proteins make up a family from their taxonomy. This is an
approximation that provides for a rapid assessment of the mem—
bers of the community.

The SEED annotation servers (http://servers.theseed.org/)
provide programmatic access to the k—mer annotation algorithm
via an API. These servers support the assignment of functions to
protein or DNA sequences. Detailed examples are provided at
that page and at http://edwards.sdsu.edu/RTMg. The Web inter—
face was built to provide rapid interpretation of a metagenome
sample. The samples are analysed in groups of sequences (cur—
rently the default is 10 000 sequences at a time), in a round—robin
fashion. Users see the results of their annotation as it is being
performed. At any time, all of the raw data can be downloaded
as raw text to import into any other analysis platform or pack—
age. In practice we use this system to assess the quality of the
metagenome and visualize similarities to the sample, leaving
more detailed and thorough analysis until more time—consuming
comparisons are complete. However, the results of the k—mer—
based analysis are generally recapitulated in downstream
analyses.

ACKNOWLEDGEMENTS

We thank Dr Elizabeth Dinsdale for helpful advice and discus—
sion about the RTMg website and Dr Bas Dutilh for critical
comments on the manuscript.

Funding: Division of Biological Infrastructure [National Science
Foundation (NSF) grants DBI: 0850356] and Division of
Environmental Biology [DEB: 1046413 to R.A.E.].

Conﬂict of Interest: none declared.

REFERENCES

Angly,F.E. et a]. (2012) Grinder: a versatile amplicon and shotgun sequence simu—
lator. Nucleic Acids Re.\'., 40, e94.

Dinsdale,E.A. et a]. (2008) Functional metagenomic proﬁling of nine biomes.
Nature, 452, 629$32.

Meyer,F. et a]. (2009) FIGfams: yet another set of protein families. Niwleic Aciiix'
Rein, 37, 6643$654

Meyer,F. et a]. (2008) The metagenomics RAST serveria public resource for the
automatic phylogenetic and functional analysis of metagenomes. BM C
Bioinformaticx, 9, 386.

Overbeek,R. et a]. (2005) The subsystems approach to genome annotation and its
use in the project to annotate 1000 genomes. Niwleic AcidS Re.\'., 33, 569175702.

Wilkening,J. et a]. (2009) Using clouds for metagenomics: a case study. In IEEE
International Conference on Clutter Computing and Workx‘lwps. pp. 176.

Wommack,K.E. et a]. (2008) Metagenomics: read length matters. Appl. Environ.
Micro/7iol., 74, l45¥l463.

 

3317

ﬁm'spzumol‘pmﬂo'sopeuuopuotq/ﬁdnq

