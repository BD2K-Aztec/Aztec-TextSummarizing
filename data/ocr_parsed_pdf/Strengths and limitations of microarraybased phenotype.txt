ORIGINAL PAPER

Vol. 29 no. 22 2013, pages 2892-2899
doi:10. 1 093/bioinformatics/btt492

 

Systems biology

Advance Access publication August 20, 2013

Strengths and limitations of microarray-based phenotype
prediction: lessons learned from the IMPROVER Diagnostic

Signature Challenge

Adi L. Tarcal'z, Mario Laurias, Michael Unger4, Erhan Bilals, Stephanie BoueB,

Kushal Kumar Dey4, Julia HoengB, Heinz Koeppl4, Florian Martina, Pablo Meyers,
Preetam Nandy4, Raquel Norel5, Manuel PeitschB, Jeremy J. Rice5, Roberto Romeroz,
Gustavo Stolovitzky5'*, Marja TalikkaB, Yang Xiang6, Christoph Zechner4 and IMPROVER

DSC Collaborators

1Department of Computer Science, Wayne State University, 2Perinatology Research Branch, NICHD/NIH, Detroit,

MI 48201, USA, 3The Microsoft Research - University of Trento Centre for Computational and Systems Biology,
Rovereto 38068, Italy, 4ElH Zurich, Zurich 8092, Switzerland, 5IBM Thomas J. Watson Research Center, Yorktown
Heights, NY 10598, USA and 6Philip Morris International, Research & Development, Neuchatel CH-2000, Switzerland

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: After more than a decade since microarrays were used to
predict phenotype of biological samples, real-life applications for dis-
ease screening and identification of patients who would best benefit
from treatment are still emerging. The interest of the scientiﬁc com-
munity in identifying best approaches to develop such prediction
models was reaffirmed in a competition style international collabor-
ation called IMPROVER Diagnostic Signature Challenge whose results
we describe herein.

Results: Fifty-four teams used public data to develop prediction
models in four disease areas including multiple sclerosis, lung
cancer, psoriasis and chronic obstructive pulmonary disease, and
made predictions on blinded new data that we generated. Teams
were scored using three metrics that captured various aspects of
the quality of predictions, and best performers were awarded. This
article presents the challenge results and introduces to the community
the approaches of the best overall three performers, as well as an
R package that implements the approach of the best overall team.
The analyses of model performance data submitted in the challenge
as well as additional simulations that we have performed revealed that
(i) the quality of predictions depends more on the disease endpoint
than on the particular approaches used in the challenge; (ii) the most
important modeling factor (e.g. data preprocessing, feature selection
and classiﬁer type) is problem dependent; and (iii) for optimal results
datasets and methods have to be carefully matched. Biomedical fac-
tors such as the disease severity and confidence in diagnostic were
found to be associated with the misclassification rates across the
different teams.

Availability: The lung cancer dataset is available from Gene Expression
Omnibus (accession, GSE43580). The maPredictDSC R package im-
plementing the approach of the best overall team is available at www.
bioconductororg or http://bioinformaticsprb.med.wayne.edu/.
Contact: gustavo@us.ibm.com

 

*To whom correspondence should be addressed.

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 8, 2013; revised on August 4, 2013; accepted on
August 16, 2013

1 INTRODUCTION

Microarrays were introduced in life science research as a practical
means to measure whole-genome expression levels (Schena et al.,
1995). Typical experiments involving microarray technologies
were designed to gain biological insights into various conditions
but also to discover new, and predict predeﬁned, disease pheno-
types. For instance, breast tumors were classiﬁed based on their
molecular proﬁles more than a decade ago (Bittner et al., 2000;
Gordon et al., 2002; Perou et al., 2000), and progress has been
steady and promising; yet, practical applications of microarrays
in patient care are only emerging. A recent comparison of three
microarray-based classiﬁers for breast cancer subtyping,
BluePrint, MammaPrint and TargetPrint, concluded that multi-
gene assays were more reliable than clinicopathological criteria
alone for the clinical management of breast cancer patients
(Nguyen et al., 2012). Pharmacogenetic (PGx) testing is an
essential part of personalized medicine, which aims to predict
an individual’s risk for adverse drug response or treatment out-
come. Recently, Hresko and Haga (2012) reviewed how PGx tests
are accepted in the US in terms of coverage by the largest health
insurance companies. Although there is no US Food and Drug
Administration (FDA)—approved test available for Oncotyper
[a 2l-gene assay that can predict 10-year distant breast cancer
recurrence (Kaklamani, 2006; Yamani et al., 2007a)], it is covered
by most major health insurances. AlloMap [a 20-gene test that
can assess the risk of cardiac allograft rejection following a heart
transplant (Mock et al., 2007; Yamani et al., 2007b)], similarly
lacks FDA approval, but it is considered beneﬁcial by a number
of health insurances. In contrast, although the MammaPrint test

 

2892 Published by Oxford University Press 2013. This work is written by US Government employees and is in the public domain in the US.

112 /310'speum0[p1q1x0"sotJButJOJutotq/ﬁduq mot} pQPBOIII/lAOG

9103 ‘Og anﬁnv uo ::

Strengths and limitations of microarray-based phenotype prediction

 

[70-gene proﬁle for prognostic and predictive tumor analysis
(Acharya et al., 2012)] is approved by FDA, it has rather limited
insurance coverage. Apparently, FDA approval is neither a pre-
requisite nor sufﬁcient for the acceptance of a given test; rather,
independent review by insurance companies and conﬁdence by
the clinicians (and patients) may be the main factors that inﬂu-
ence the uptake of a new PGx test. We postulate that better and
more standard methods to verify diagnostic PGx tests would fa-
cilitate acceptance by regulatory agencies and healthcare pro-
viders and hasten deployment to the public.

Recently, the Industrial Methodology for PROcess Eriﬁcation
in Research (IMPROVER) was designed as a methodology to
validate industrial research processes related to systems biology
(Meyer et al., 2011). As a ﬁrst initiative of the IMPROVER pro-
ject, the Diagnostic Signature Challenge (DSC) (Meyer et al.,
2012) was designed to determine to what extent transcriptomic
data can be used for phenotype prediction and to test which com-
putational approach works best for this end. Participants in the
challenge were asked to produce a prediction model (classiﬁer)
that can infer the phenotype of biological samples from gene ex-
pression data for ﬁve different endpoints. The teams were ranked
based on the prediction performance on test datasets generated by
the organizers (for details see the Methods section).

The purpose of this article is threefold: one, to describe the
IMPROVER DSC results including classiﬁcation performance
on each endpoint, scoring methodology and overall ranking of
the teams as well as ranking stability with respect to the com-
position of the test datasets; two, to introduce the methods of the
top three overall performers and discuss the performance of an
ensemble classiﬁer that aggregates the predictions from best
models submitted in the challenge; and three, to identify some
of the sources of variability in the classiﬁcation performance,
including biomedical factors, and point toward the best alterna-
tives at each step in the classiﬁcation pipeline. Performance data
from the models submitted to the IMPROVER DSC and from
post-challenge computational studies are used to support our
ﬁndings. We conclude this article with a summary of the main
observations and discuss their relevance.

 

2 METHODS
2.1 Organization of the challenge

A full description of the DSC is available at www.sbvimprover.com. Brieﬂy,
participants in the challenge were asked to produce a prediction model that
can infer the phenotype of biological samples from microarray data.
Although no constraints were placed on the type of approach to be used,
all participants used different ﬂavors of machine learning algorithms (Tarca
et al., 2007) trained on public microarray datasets. The training datasets for
each sub-challenge can be downloaded from the National Center for
Biotechnology Information (NCBI) Gene Expression Omnibus (GEO)
(http://www.ncbi.nlm.nih.gov/gds/?term=GEO) or from ArrayExpress at
European Bioinformatics Institute (EBI) (http://www.ebi.ac.uk/arrayex
press/). These datasets represent gene expression levels proﬁled using com-
mercial microarrays platforms including Affymetrix (Santa Clara, CA) and
Illumina (San Diego, CA) platforms. Details on each sub-challenge includ-
ing the nature and composition of the test datasets and the accession num-
bers of the suggested training datasets are given as Supplementary
Information. The phenotypes/endpoints considered in the challenge
included psoriasis, multiple sclerosis (MS) Diagnostic and MS Stage, lung
cancer (LC) and chronic obstructive pulmonary disease (COPD). Each

phenotype/endpoint was treated as a stand-alone sub-challenge. For a
number of reasons, the difficulty in predicting each of these endpoints
varied. For instance, the outcome should be easier to predict when the
microarray proﬁle was measured in the primary diseased tissue (e.g. skin
in psoriasis and tumor cells in LC) as opposed to in a surrogate tissue
(e.g. blood in MS). The challenge organizers provided a test dataset for
each of the sub-challenges that could be used only within the context of
the challenge. Each participating team in the DSC had to submit (i) the
results generated as part of the DSC consisting of one belief value per
sample and class in the range between 0 and 1, and (ii) a description of
the algorithm(s), methodology and/or software used in sufﬁcient detail
to allow external parties to understand the basic functionality of the
method.

2.2 Scoring procedures and metrics

Submissions were scored on the basis of their predictive ability with over-
sight by an independent scoring review panel of qualiﬁed experts (panel
members are listed at http://www.sbvimprovercom/scoring). The scoring
team was blind to the identity of the participating teams. The predictions
from each team were required to be in the form of a belief value per test
sample and group/class in each of the ﬁve sub-challenges. The belief values,
summing up to 1.0 for each sample, represent the degree of conﬁdence of the
modeler that the test sample belonged to a given phenotype. To score the
predictions from each team, the organizers chose a set of scoring metrics,
some of which were specially designed for this challenge. The metrics were
chosen to be non-redundant, applicable to multiclass problems, include both
threshold-based and threshold-free instantiations and make use of continu-
ous conﬁdence levels for each class. The three metrics chosen were Area
Under the Precision-Recall Curve (AUPR), Belief Confusion Metric
(BCM) and Correct Class Enrichment Metric (CCEM). For more details
of team scoring and ranking see Supplementary Information. The overall
ranking of teams was based on the sum of the ranks over the endpoints for
which at least one team did better than expected by chance, as determined by
transforming the Z-scores into P-values and adjusting them using the false
discovery rate method (Benjamini and Hochberg, 1995).

2.3 Resources availability

All test datasets used in the IMPROVER DSC were made available to
the challenge participants from the project Web site (www.sbvimprover.
com). The gold standard files giving the correct class labels of samples
were also made public after the challenge was completed. The LC dataset
is available from the National Center for Biotechnology Information
GEO (GEO accession number: GSE43580).

A Bioconductor (www.bioconductor.org) compliant R package called
maPredictDS C was created to implement the approach of the best overall
team with extra capabilities for testing additional 26 combinations of
methods described in the Results section, as well as aggregating the pre-
dictions from some or all the combinations explored. The three metrics
used in the DSC to score the teams were also implemented in this pack-
age, which is available from http://bioinformaticsprb.med.wayne.edu and
www.bioconductor.org.

3 RESULTS

3.1 Participation, scoring and team ranking in the
IMPROVER DSC

The IMPROVER DSC was open from March 5 to June 21,
2012. During this time, 54 teams from around the world
(Supplementary Fig. S1) participated in the competition; 34 of
them made a submission for all ﬁve endpoints. The fact that
many teams submitted to all sub-challenges allowed us to explore

 

2893

112 ﬁle'slvumolpiqrxo"sotJBuiJOJutotq/ﬁduq uteri pQPBOIII/lAOG

9103 ‘Og isnﬁnv uo ::

A.L.Tarca et al.

 

whether the same methodology performed similarly for different
endpoints. For a more detailed description of the challenge
organization and endpoints characterization see the Methods
section. Figure 1a shows the distribution of the three perform-
ance indices used in the challenge as a function of the endpoints.
For comparison purposes, the Matthews correlation coefﬁcient
(MCC) (Matthews, 1975) used previously (Baldi et al., 2000) to
assess the accuracy of prediction algorithms for classiﬁcation is
also included in this ﬁgure. The MCC was not used in the team
ranking as it cannot be applied to multiclass problems such as
the LC sub-challenge. Across the four binary endpoints and all
teams, the correlations between MCC and CCEM, BCM and
AUPR were 0.99, 0.97 and 0.96, respectively, suggesting that
MCC and CCEM are similar. Clearly, there were large differ-
ences in the quality of predictions between the endpoints, with
psoriasis being the easiest to predict, followed by LC, COPD and
MS Diagnostic (Fig. 1a). For the MS Stage sub-challenge, no
team’s performance was better than chance (after multiple testing
correction); therefore, to reduce the impact of random chance on
a team’s ranking, this sub-challenge was not used in the ﬁnal
rankings. In the four-way LC classiﬁcation, only the tumor
type segregation, adenocarcinoma (AC) versus squamous cell
carcinoma (SCC), was successfully achieved but not between
different cancer stages (AC1 versus AC2 or SCCl versus
SCC2, postfixes 1 and 2 indicate the cancer stages) (see
Supplementary Fig. S2). The data displayed in Figure 1a were
ﬁrst transformed into Z—scores (see Supplementary Information)
so that the performances of the classiﬁers on a two-class end-
point (e.g. psoriasis) and a four-class endpoint (i.e. LC) could be
compared. The likely biological interpretation of these results
can be that the predictions in the easiest sub-challenge, psoriasis,
were based on transcription levels measured in the primary dis-
eased tissue (skin), whereas predictions in the most difﬁcult two
sub-challenges, MS Stage and MS Diagnostic, were based on
transcription levels measured in a surrogate tissue, namely,
blood.

A schematic representation of the overall team ranking with
the best overall three teams highlighted is shown in Figure lb.
Supplementary Table S1 gives the identity and affiliations of the
members of the teams that attained best performances overall
and best in each of the sub-challenges of the IMPROVER DSC.
The overall team ranking is provided in Supplementary Table S2,
whereas ranking performance data on each individual sub-
challenge is available at http://www.sbvimprover.com/. The
sum of ranks over the different metrics and endpoints was
chosen to rank the teams in the IMPROVER competition
because it is robust to outlier values for a particular metric
and/or particular endpoint, yet this measure is insensitive to
how much better a team scored compared with another one (as
long as it scored better). On the other hand, the aggregated
(summed) Z—scores over the different metrics and endpoints
(see Fig. 10) is monotonically related to the performance on
any of the metrics and endpoints, but it can be skewed by outlier
values. The best and second best overall teams were the same
using both the sum of ranks and aggregated Z—scores.

To determine the stability of the team rankings with respect to
the composition of the test datasets, we performed a simulation
by taking one bootstrap sample from each test dataset and com-
puted the performance metrics and ranking again for all teams.

 

(at: (Mmmamma

t
.

 

 

Z—smre

 

 

 

—5
.

 

 

{i HIEIEEIIIIIIII ﬂ

 

El Hlﬂlllllllllll

 

. . . i .
com Lung Gunner MSD M33 Psoriasis

(cl

 

 
      

l Lung cancer
I Psorle

EU

 

 

 

Sum oI'Z—scums
40

20

 

147101418222630343642465054 1 3579“ 13151719

Ofﬁcial Team Rank Ofﬁcial Team Rank

Fig. 1. (a) Distribution of team performance (after Z-score conversion)
for all endpoints and metrics. (b) Ranks of the top three best overall
teams in each sub-challenge; (c) sum of BCM, CCEM and AUPR
(after Z—scores conversion) for each team. Teams are sorted in the official
team ranking order. Label C marks best team for COPD, P for psoriasis,
L for LC and M for MSD (MS Diagnostic). ((1) Distribution of bootstrap
ranks for each team sorted by official rank. Only data from the top 20
teams are shown. *Median values are signiﬁcantly worse (one-tailed
paired Wilcoxon test P< 0.05) compared with the team ranked one pos-
ition higher. MSD, MS Diagnostic, PSO, psoriasis

The distribution of the overall team ranks and the corresponding
aggregated Z—scores were determined over 1000 such simulations
and are shown in Figure 1d and Supplementary Figure S3, re-
spectively. The distribution of the bootstrap rank values sug-
gested that the team ranking was stable up to the fourth
ranked team, because the second, third and fourth ranked
teams each had a median rank worse than the team officially
ranked one position better (one-tailed paired Wilcoxon test P <
0.05). A stability analysis of the team ranking based on the
aggregated Z—scores showed also that the ranking of the ﬁrst
and second best overall teams was stable (Supplementary Fig.
S3). The performance of the top three best overall teams was
again evaluated in a post-challenge swap analysis in which the
training and test datasets were interchanged. The performance
values in the swap analysis were, on average, only slightly worse
than in the competition (see Supplementary Fig. S4).

3.2 Description of the classiﬁcation pipelines of the
three best overall teams

One of the main goals of the IMPROVER DSC was to ﬁnd the
best classiﬁcation pipeline for outcome prediction based on
microarray data. The approaches developed by the three best
overall teams (first team 221; second team 227; and third team
161) are summarized below:

3.2.] Team 22] Preprocess training and test datasets together
using Robust Multi-array Average (RMA) (Irizarry et al., 2003).
From the pool of all genes expressed above the background,
select a small number of differentially expressed genes using a

 

2894

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq uIOJJ pap1201um0q

9103 ‘0g isnﬁnv uo ::

Strengths and limitations of microarray-based phenotype prediction

 

moderated t—test, P—Value and fold change. Optimize the number
of features to be included in the model by maximizing the cross-
Validated performance (Area Under the Receiver Operating
Characteristic Curve statistic) of a linear discriminant analysis
(LDA). Fit the LDA model and make predictions assuming
equal priors of each class in the test set. Optimize the choice of
training datasets for some endpoints, as well as gene ranking
strategies and P—Value/fold change cut-offs by trial and error.
For more details see reference (Tarca et al., 2013).

3.2.2 Team 227 Preprocess training and test datasets either to-
gether or separately using RMA or the Affymetrix Microarray
Suite 5.0 (MAS5) algorithm. Preselect genes using a Wilcoxon
test between classes on a training dataset. Build a rank-based
signature for each sample in the test dataset by selecting the
top- and bottom-ranked genes among the preselected genes.
Determine distances between each pair of signatures using a
gene set enrichment analysis -based metric. Apply unsupervised
clustering of test samples using Cytoscape (Shannon et al., 2003).
Optimize signature size by maximizing cluster separation. Assign
a class label to each cluster using the direction of expression
changes for selected disease genes derived from the literature.
For more details see reference (Lauria, 2013).

3.2.3 Team 16] Preprocess training and test datasets together
using RMA. Select genes using a Wilcoxon test. Use the Least
Absolute Shrinkage and Selection Operator (LASSO) regularized
logistic regression model as the classiﬁer (Tibshirani, 1996).
Optimize the regularization parameter value by maximizing the
cross-validated performance of the model on the training dataset.
Choose training datasets for some of the endpoints by trial and
error. For more details see reference (Nandy et al., 2013).

3.3 Combining predictions from multiple
classiﬁcation pipelines

It has been shown previously (Marbach et al., 2012; Prill et al.,
2010) that by combining predictions from different classiﬁers, the
quality and robustness of predictions can be improved. The
models of the various teams were different because they were
often trained on different datasets using different preprocessing
methods, feature selection methods and classiﬁer types. To com-
bine the predictions from multiple models, the samples from each
endpoint test dataset were split randomly into two equal and
balanced parts. The ﬁrst half was used to rank the models/
teams. The second half was used to assess the quality of an
ensemble classiﬁer that combined the predictions from the best
n (n = 2,. . . , 34) models/teams. The Z—scores for a given metric
(e.g. BCM) were used to rank the teams, and then the belief
matrix of the ensemble classiﬁer was constructed by averaging
the individual belief matrices from the best n models. The entire
process was repeated 500 times and average performance values
that were obtained are shown in Figure 2. The BCM values
tended to be negatively impacted by prediction aggregation,
especially when the subsequent models were much worse than
the best model, which was the case for MS Diagnostic (Fig. 2). In
contrast, the AUPR values seemed to beneﬁt substantially from
prediction aggregation regardless of whether the subsequent
models were about the same or worse than the best model. Of
note, the AUPR of 1 (226.5) achieved for psoriasis did not

 

 

 

 

 

 

 

 

 

 

 

(3):} ()in _
ﬁrm-W
G
argue Tn-
e a
g
f an
N-—Psmiasis F =
iLungCnnocr
—' PD
chi—MSD D-
n 5 1t] 15 20 25 an as 6 8 1b 1'5 2'0 25 at) 3'5

Number of“ models Number of models

Fig. 2. Aggregation of the predictions from the best models. (a) AUPR
and (b) BCM Z-scores (average over 500 trials) as a function of the
number of best models used in the ensemble classiﬁer. In each trial,
half of the test data were used to rank the models and the remaining
half were used to estimate the performance of the ensemble model. The
averaged Z—scores for the top three individual models are shown as hori-
zontal line segments on the left side of the graphs. MSD, MS Diagnostic

change as more models were added into the ensemble. The
reason for this is that a perfect precision versus recall curve
was already achieved by the top 12 models, and the next 13
models had an AUPR>0.99. These findings highlight the differ-
ences between these two metrics and also show that the best
predictions (single best or ensemble classiﬁer) are metric— and
endpoint dependent. In all cases (with the exception of MS
Diagnostic measured by the BCM and CCEM metric, see
Supplementary Fig. S5 for CCEM), the aggregate prediction
performance was robust to the inclusion of poorly performing
methods. This finding is especially important, as the outcome of
the classiﬁcation is not known in advance; therefore, the aggre-
gation of predictions from several methods is a safe and robust
strategy, because which of the individual methods performs best
is not known.

3.4 Explaining the variability in classiﬁer performance

The ideal method of determining the contribution of each mod-
eling factor to the overall performance of the classiﬁcation pipe-
line would be a factorial experiment in which performance data
are determined for every combination of factors (e.g. classiﬁer
type or feature selection method) in the model. The performance
data obtained from the models submitted in the DSC were not
amenable for this type of analysis because the types of methods
that were used varied widely between teams and even the training
datasets varied from one team to another. In addition, the
descriptions of the methods used in the models (at the time of
submission each team was required to submit a write-up describ-
ing their method) were often not sufﬁcient to determine which
method was used in each of the steps of the classiﬁcation pipe-
line. Together these realities made it impossible to carry out a
multivariate analysis of variance (ANOVA) of the performance
data. Therefore, we applied a series of sub-analyses on the
performance data as follows:

A two-way ANOVA analysis was applied on the model
performance data (after Z—score transformation) using data
from the models of the 34 teams that made a complete submis-
sion. Two factors considered were the team and the endpoint.
The endpoint explained 60, 70 and 77% of the variance of
AUPR, BCM and CCEM, respectively (P<0.05), whereas the

 

2895

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq uIOJJ pap1201umoq

9103 ‘0g isnﬁnv uo ::

A.L.Tarca et al.

 

team factor only explained 9, 8 and 6% of the variance, respect-
ively (non-signiﬁcant). The between-endpoint differences in per-
formances were, therefore, much larger than the between-team
differences for the same endpoint as revealed in Figure 1a.

To further isolate the contribution of each modeling factor to
the variability of a model’s performance, we conducted a factor-
ial experiment based on the classiﬁcation pipeline and training
datasets used by the best overall team. In the factorial analysis,
we considered three preprocessing methods (MAS5, RMA and
GCRMA), three feature selection methods (t—test, moderated
t—test and Wilcoxon test) and three different classiﬁers (LDA,
k-Nearest Neighbor (kNN) and Support Vector Machines
(SVM)). These modeling factor levels were selected from the
options that were used most often in the challenge. We applied
the 27 different possible combinations of the modeling factor
levels to the four endpoints in the IMPROVER challenge, after
converting the four-class LC sub-challenge into a two-class sub-
challenge (i.e. AC versus SCC regardless of the stage) to make it
possible to use identical feature selection methods across all the
datasets. Performance results averaged over all four endpoints,
and the three metrics are shown in Figure 3. An ANOVA of
these data revealed that the endpoint was the dominant source
of variability, regardless of the performance metric that was used
(Supplementary Fig. S6). As an average over all three perform-
ance metrics, the endpoint explained 65% of the variability
(P< 0.05), the pre-processing method explained 1.6%, the clas-
sifier type explained 1.3% and the feature selection method ex-
plained 0.5% (the last three were non-signiﬁcant after
adjustment). These results are in agreement with the conclusions
based on the analysis of the data from all teams (see above).

3.5 Modeling practices that lead to best performance

We have conducted several univariate analyses using the model-
ing factors described in a structured post-challenge survey to
which 21 of the participating teams responded. One of the ques-
tions asked was whether the team had used cross-validation (on
the training dataset) to tune any of the parameters in their clas-
sification pipeline. Using a mixed-effect model in which the team
and endpoint were treated as random effects and considering the
use of cross-validation as a ﬁxed effect, revealed that, on average,
the teams that had used cross-validation had Z—scores that were
higher by 1.2 units for BCM (P: 0.026), higher by 1.9 units for

0.90

 

(BCM + CCEM - AUPR) . 3
0.80

nﬁo'll _

91W“: MS‘MSMSMSRMSRGGRRMSGHGMSRGMSRGGRRGGMS

c

 

 

 

Fsdeﬂkn. MWTMTMTWTTW'TTWTTWMWMWMMMMWW

Guilt: kaNkNLD 5 5 LDkNSkPIS LD'lNlD'lDS RN 5 LD 5 WWW NLDS 5

Fig. 3. Performance values for 27 combinations of preprocessing, feature
selection and classiﬁcation methods based on the classiﬁcation pipeline of
the best overall team. Values are average over the four endpoints and the
three metrics. Perfect classiﬁcation is 1.0, whereas 0.0 is perfect misclassi-
ﬁcation. The combination of methods used by the best overall team is
marked in red. T, regular t-test; M, moderated t-test; W, Wilcoxon rank
test; kN, kNN; LD, LDA; S, SVM; M5, MASS; R, RMA; G, GCRMA

AUPR (P:0.023), whereas for CCEM the scores were not
improved significantly. Notably, the partition of training dataset
into folds during cross-validation is typically done at random;
this can affect the structure of the model (e. g. input features) and
its predictions. Although the impact of these stochastic effects on
the model performance are typically small, for the psoriasis sub-
challenge (where the differences between the 1st and 12th ranked
teams were within 2% for all three metrics), the effect of these
stochastic effects on the team ranking was substantial (see the
Supplementary Note: Impact of random data partitioning in
cross-validation on classiﬁer performance).

The use of more than one microarray platform in a given
challenge did not affect significantly the prediction performance
of the classiﬁer. Typically, multiple platforms were used by the
teams to increase the number of training samples. Although a
larger training dataset is, in general, good for the performance of
the classiﬁer, detrimental biases in the process of merging the
different platforms can be introduced. These two contradictory
effects seem to cancel each other. Tests for the association of
other modeling factors with the classiﬁer performance were not
feasible, either because of missing data or because of too many
factor levels that lead to confounding between the modeling and
team factors.

The data generated from the factorial experiment described
above and plotted in Figure 3 were also used to identify the
modeling methods that seem to work best in general. An
ANOVA analysis of the classiﬁer performance metrics as a func-
tion of modeling factors for each endpoint separately revealed
that the importance of the modeling factors is problem and metric
dependent (see Supplementary Fig. S7). Moreover, the best
method at each step in the classiﬁcation pipeline is also problem
and metric dependent (see Supplementary Figs. S87S10).
Signiﬁcant interactions were also present between different
factor levels; therefore, using the methods that seem to work
best, in general, will not necessarily provide the best possible
combination of methods for every dataset. For example, the
classiﬁcation pipeline that maximized the average over all three
metrics in all four endpoints used MAS5 preprocessing, gene
ranking Via Wilcoxon test and an SVM classiﬁer (Fig. 3).
However, MAS5 preprocessing was only used twice in the top
10 combinations of methods shown in Figure 3; GCRMA, on
the other hand, appeared ﬁve times. Moreover, MAS5 was the
preprocessing method that appeared most frequently in the worst
10 combinations. So, although GCRMA worked better in com-
bination with most classiﬁer and feature selection methods that
were tested than MAS5 did, GCRMA was not part of the best
combination of methods. Similarly, the moderated t-test
appeared six times in the best 10 combinations of methods, yet
it was not part of the best single combination. The performances
of the LDA and SVM classiﬁers were similar, whereas kNN was
selected only twice in the top 10 combinations and appeared
most frequently among the worst 10 combinations. Notably,
the combination of methods that was used by the best overall
team (RMA, moderated t-test and LDA) was ranked fifth of the
27 combinations shown in Figure 3.

Because the training and test datasets were provided at the
beginning of the competition, several teams preprocessed the
multiple training datasets and the test dataset together using
RMA or GCRMA. These two preprocessing methods use

 

2896

112 /310's112u1n0lp1q1x0"sotJBuiJOJHtotq/ﬁduq uIOJJ pap1201umoq

9103 ‘0g isnﬁnv uo ::

Strengths and limitations of microarray-based phenotype prediction

 

quantile normalization to equalize the probe intensity distribu-
tions between arrays. Furthermore, these two preprocessing al-
gorithms use additional parameters that depend on which of the
arrays are preprocessed together. We found that, on average,
both BCM and AUPR were improved by 6 and 4%, respectively,
(Wilcoxon test P< 0.05) when all the training and test datasets
were preprocessed together as opposed to separately (see
Supplementary Fig. S11).

3.6 Biomedical factors affecting the quality of predictions

Many biomedical factors can contribute to variability in the clas-
sification performance of the models. First, health and disease
states, and especially stages of diseases, do not necessarily cor-
respond to well-deﬁned discrete states. This could lead to uncer-
tainties in establishing an exact diagnosis or to less stable
signatures of speciﬁc diseases/stages. Both the inability to pre-
cisely deﬁne disease states and inaccuracies in the assessment
could have produced artifacts in the phenotype labels of the
test samples that we treated as gold standard. Such artifacts
would be reﬂected in the inability of the teams to ‘correctly’
classify certain samples, as quantiﬁed by the misclassiﬁcation
rate across all the teams for those samples.

To identify systematic biases in the classiﬁcation performance
that could be caused by biomedical factors or a questionable
gold standard, we correlated the misclassiﬁcation rate across
all the teams with metadata that was not originally disclosed
to the participants. The metadata comprised disease character-
ization, demographic factors and, in the LC challenge, an inde-
pendent reevaluation of the histology of the tumors. In psoriasis,
disease onset is gradual, and hence the disease status of a patient
may be ill deﬁned at the earliest stages of the disease. Figure 4a
shows that the highest misclassiﬁcation rate for a psoriasis
sample was found for a patient with a Psoriasis Area and
Severity Index (PASI) score (Langley and Ellis, 2004) of 3.2
(low severity); samples with the highest PASI scores were
rarely misclassiﬁed. The Spearman rank correlation between
the misclassiﬁcation rate and PASI scores was —0.53
(P: 0.011). In the LC sub-challenge, samples with an inconclu-
sive or divergent second diagnosis had significantly higher aver-
age misclassiﬁcation rates (38 and 56%, respectively, P<0.01)
compared with the average misclassiﬁcation rate (19%) for
samples with concordant second diagnoses (Fig. 4b).

 

 

 

 

 

 

 

 

 

 

 

 

(a) (bl'l‘m 0M2!
5w: , EMU D . I! n
_ ﬂ Dchqunmaliun 104: ascm ‘g ”
.. we. IndumionttM) : 7W- oscc: " ‘
E FqlhcmaED-‘U PASI _ 9 I r!
E 3% [lead [0.61 mnfw" E _ 1° ‘ E
35“ Armsrom ' 3 50““ — a
5 2m . TrunHU-b: E a o
g Legs w-m 3 0' a
2 IM- IA}. :1. 259° "3 . B
o a o o I: 3 I 0
0°». E '
" '" 3’ 3" ‘0 Conﬁrmed rammed D11."ng 2nd Evaluatinn
FASl scare AC 50‘ diagnosis incmclustw

Fig. 4. (a) Misclassiﬁcation rate of psoriasis samples as a function of the
PASI score. (b) Misclassiﬁcation rates in the LC sub-challenge shown as a
function of the agreement between two independent pathological evalu-
ations (conﬁrmed, divergent and inconclusive diagnoses in the second
evaluation). AC, adenocarcinoma; SCC, squamous cell carcinoma; post-
ﬁxes ] and 2 indicate the cancer stages

3.7 Persistent genes in disease signatures across
multiple teams

Using the data from the post-challenge survey, we performed a
meta-analysis to identify the genes that were used by more than
one of the participating teams as inputs in their prediction models.
Out of submitted gene lists (five for MS Diagnostic, nine for psor-
iasis, six for COPD and seven for LC), we retained only the gene
lists of the teams whose models performed better than chance
(P< 0.05) for at least one of the three metrics (two for MS
Diagnostic, nine for psoriasis, ﬁve for COPD and seven for
LC). The number of times that any one gene occurred across
the teams (gene frequency) was determined, and the observed
average gene frequency was computed for each endpoint.
A simulation analysis was conducted to determine if the average
gene frequency was greater than expected by chance by randomly
generating lists of genes (the same number and size as the observed
list) from all the genes measured on the microarrays. For both LC
and psoriasis, the overlap of gene lists between the teams was
greater than expected by chance (P<0.0001). The number of
genes submitted by two or more of the teams was, none for MS
Diagnostic, 2 for COPD (namely CDKNlC and CDKN2A), 247
for LC and 216 for psoriasis. The most frequently occurring genes
in the signatures of the different teams for psoriasis and LC are
given in Supplementary Tables S3 and S4, respectively.

4 DISCUSSION

With 54 teams participating from around the world, the
IMPROVER DSC provided an important opportunity to test
the feasibility of crowdsourcing to answer computational biology
questions relevant to both industry and academia. We found that
most of the 54 different teams used a similar classiﬁcation pipe-
line for all the sub-challenges, with adjustments as required
by the specificity of each endpoint. The differences in the quality
of predictions between teams for any endpoint were mainly
the result of three factors: (i) the training datasets used, (ii) the
underlying classiﬁcation pipelines and (iii) the skill level of the
team in applying/tuning the pipeline to each endpoint. The effect
of the skill factor was highlighted previously by the MicroArray
Quality Control (MAQC)-II consortium (Shi et al., 2010), a large
scale initiative completed over a few years that also studied the
feasibility of microarray-based predictions and classiﬁer develop-
ment practices.

Although there were signiﬁcant differences in the performance
between teams, and the overall team ranking for the top teams was
stable, the differences in performance were not enough to allow us
to identify one classiﬁcation pipeline as the best practice in all
cases. For example, the best overall team was not the best per-
former in any of the individual sub-challenges. In fact, no single
team performed best in more than one sub-challenge/endpoint. The
likely main reason for this finding is that the best method to use at
each step in the classification pipeline is endpoint dependent, where-
as most teams used a more or less consistent pipeline for all sub-
challenges. In general, it is to be expected that a one-size-ﬁts-all
approach would not be superior to a more tailored approach on
all datasets. Even if each team had used the same training datasets
and searched for the best method at each step in the classiﬁcation
pipeline, it is still unlikely that the same classiﬁcation pipeline/

 

2897

112 /310's112u1n0fp101x0"sotJBuiJOJHtotq/ﬁduq uIOJJ pap1201umoq

9103 ‘0g isnﬁnv uo ::

A.L.Tarca et al.

 

team would have emerged at the top of the rankings in most or all
the four sub-challenges due to stochastic factors present in most
pipelines. For example, for Team 22], variations because of the
random way in which cross-validation partitions were generated
during the tuning of the classiﬁcation pipeline could have pro-
duced an increase of 11 rank units in the psoriasis sub-challenge,
assuming that everything else in the pipeline was kept the same
(see Supplementary Note: Impact of random data partitioning in
cross-validation on classiﬁer performance).

The classiﬁcation pipelines of the best overall three teams had
some common and some different elements. For example, the
ﬁrst and third teams preprocessed the training and test datasets
together using RMA, whereas the second and third teams pre-
selected features using a Wilcoxon test. Looking at the classiﬁ-
cation models used, the ﬁrst team used a classical discrimination
method (LDA), the third team used LASSO logistic regression
(an emerging approach to high-dimensional data classiﬁcation)
and the second team used an experimental clustering-based clas-
sifier. Both the first and third teams tuned the number of
features to be used in each particular problem using cross-valida-
tion, whereas the second team used trial and error to determine
the number of features. The number of features that the teams
used did not correlate with the ranking of the top three teams;
the ﬁrst team used only two genes in two of the four sub-
challenges and, at most, 25 genes in the other two, the second
team used hundreds of genes in all four sub-challenges, whereas
the third team used between 14 and 60 genes.

The observed variability in the performance of the models (as an
average over the three metrics) was mainly (70%) explained by the
endpoint, which is similar to the results reported by the MAQC-II
initiative (65%) using the MCC metric. The team/classiﬁcation
pipeline explained only about 8% of the variance. Similar results
were obtained from a factorial experiment designed to quantify the
contribution of the preprocessing method, feature selection method
and classiﬁer type in addition to the endpoint. The endpoint was
again found to be the only signiﬁcant contributor to the total vari-
ance in the performance data, explaining 65% of the variance.
When the variance in performance data was examined for each
endpoint separately (Supplementary Fig. S7), we concluded that
no single modeling factor (e.g. the classiﬁer type ) is always the
biggest contributor to the performance of the pipeline, and hence
optimization of the choice of method at each stage in the classification
pipeline is needed for optimal result. Such multifactorial optimiza-
tion is time-consuming and, for simplicity, most modelers prefer to
ﬁx some of the modeling factors to their method of choice while
trying to optimize others. To facilitate the development of micro-
array-based prediction models by the community at large, we made
available a software package called maPredictDSC that imple-
ments the combination of methods used by the best overall team
in the IMPROVER DSC. In addition, the package offers the pos-
sibility to automatically search among a large number of combin-
ations of methods for the one that maximizes the cross-validated
performance on the training data. An implementation of the ‘wis-
dom of crowds’ is offered by combining the predictions of the
resulting models. Our analyses of the DSC results suggest that
the best practices that could work best in general are as follows:

(1) GCRMA seemed to work better than MAS5 in most situ-
ations, yet the limitations of MAS5 could be mitigated, at

least in part, by using existing batch correction methods
that were not considered in this study but which have been
discussed previously (Luo et al., 2010).

(2) RMA or GCRMA preprocessing of all training and test
datasets together was better than preprocessing them sep-
arately. This type of preprocessing was used by the ﬁrst
and third best overall teams, and the results from a con-
trolled experiment supported this conclusion. Combined
preprocessing of the datasets was possible in the
IMPROVER DSC but not in MAQC—II, because the
test expression data were made available to the participat-
ing teams at the beginning of the DSC. Although it could
be argued that in a clinical setup, only one test sample gene
expression profile would be available, and hence a full test
dataset would not be available to preprocess with the
training datasets; the merit of preprocessing multiple train-
ing datasets together versus separate preprocessing (with
or without applying other batch correction methods)
should be investigated further.

(3) Typically, the ordinary t-test underperformed when com-
pared with a moderated t-test or Wilcoxon test for feature
ranking.

(4) The use of cross-validation in optimizing classiﬁcation
pipeline parameters was important. The ﬁrst and third
best overall teams used such an approach, and mixed-
effects modeling of the performance data from a popula-
tion of models also supported this conclusion.

(5) Although the LDA classiﬁer was used by the best overall
team in all the sub-challenges, the results from the factorial
experiment analysis on the same pipeline showed that a
similar performance could have been obtained with SVM
instead of LDA. The poorer performance observed for the
kNN classiﬁer can be explained, at least in part, by the fact
that the value of k: 3 in the kNN was chosen arbitrarily
and not optimized for each sub-challenge.

In addition to the conclusions that can be drawn from the
outcome of the DSC from a computational perspective, our ana-
lysis of the overall misclassiﬁcation rate for each test sample
across all teams highlighted the persistent challenges in transcrip-
tomics-based disease classiﬁcation. Binary classiﬁcation of clin-
ical samples, e. g. in the psoriasis sub-challenge, cannot take into
account the facts that disease progression is likely more continu-
ous than discrete, and that there may be no clear border between
disease classes from a clinical and a molecular perspective. In the
LC sub-challenge, the gold standard may have been imperfect
because established diagnosis techniques (e.g. medical examin-
ation and histology) are not 100% reliable. To investigate the
robustness of the gold standard, the histological images from the
LC specimens were reevaluated by a second pathologist, and we
have found that on average, for samples where the two exam-
iners did agree, the misclassiﬁcation rate was lower than for the
remaining instances.

The participation of many different teams in the IMPROVER
DSC allowed us to examine the methods and practices currently
in use in computational biology. Even though the teams worked
independently and competed for a prize ($50 000 to be used for
research purposes), they were also collaborating in testing the

 

2898

112 /310's112u1n0fp101x0'sopeuiJOJHtotq/ﬁduq uIOJJ pap1201umoq

9103 ‘0g isnﬁnv uo ::

Strengths and limitations of microarray-based phenotype prediction

 

prediction methods. Overall, the competition was transformed
into a collaboration that will beneﬁt the community at large.
Because the training datasets in the IMPROVER DSC were
composed of multiple heterogeneous public datasets totally
unrelated to the test datasets, except for studying the same
phenotype, this challenge was a stringent and unprecedented
test of the ability of models to predict outcomes from gene
expression data that better reﬂected their likely clinical
applications.

ACKNOWLEDGEMENTS

We thank Filipe Bonjour, Bruce O’Neel and Kaushik Sarkar for
the development and support of the DSC Web site; Claudia Frei,
Christian Haettenschwiler and Shweta Stadler for the organiza-
tion of communications with the DSC participants and of the
IMPROVER symposium 2012; Jean Binder, Elise Blaese,
Nathalie Chemineau, Stephanie Corthesy, Peter Curle Fraser,
Chaturika Jayadewa, Lionel Schilli, Joerg Sprengel and all the
team members, who are not among the authors, for their contri-
butions during discussion sessions and for the management of
the project.

A full list of IMPROVER DSC collaborators is included as
Supplementary Material

Funding: Intramural Research Program of the Eunice Kennedy
Shriver National Institute of Child Health and Human
Development, National Institutes of Health, US. Department
of Health and Human Services (N01-HD-2-3342) (AT. and
RR, in part). DSC best overall performer grant from Philip
Morris International (to AT.) Swiss National Science
Foundation (PPO0P2_128503) and from SystemsX.ch, the
Swiss Initiative for Systems Biology (to M.U., P.N., C.Z. and
H.K.).

Conﬂict of Interest: none declared.

REFERENCES

(2006) NSABP study conﬁrms oncotype DX predicts chemotherapy beneﬁt in
breast cancer patients. Oncology ( Williston Park ), 20, 7897790.

Acharya,C.R. et al. (2012) Retraction: Acharya CR, et al. Gene expression signa—
tures, clinicopathological features, and individualized therapy in breast cancer.
JAMA. 2008; 2992157441587. JAMA, 307, 453.

Baldi,P. et al. (2000) Assessing the accuracy of prediction algorithms for classiﬁca—
tion: an overview. Bioinformatics, 16, 412424.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac—
tical and powerful approach to multiple testing. J. Royal Stat. Soc. B, 57,
2897300.

Bittner,M. et al. (2000) Molecular classiﬁcation of cutaneous malignant melanoma
by gene expression proﬁling. Nature, 406, 53(r540.

Gordon,G.J. et al. (2002) Translation of microarray data into clinically relevant
cancer diagnostic tests using gene expression ratios in lung cancer and meso—
thelioma. Cancer Res., 62, 496374967.

Hresko,A. and Haga,S.B. (2012) Insurance Coverage Policies for Personalized
Medicine. J. Pers. Med, 2, 2017216.

Irizarry,R.A. et al. (2003) Exploration, normalization, and summaries of high dens—
ity oligonucleotide array probe level data. Biostatistics, 4, 2497264.

Kaklamani,V. (2006) A genetic signature can predict prognosis and response
to therapy in breast cancer: Oncotype DX. Expert. Rev. Mo]. Diagn, 6,
8037809.

Langley,R.G. and Ellis,C.N. (2004) Evaluating psoriasis with Psoriasis Area and
Severity Index, Psoriasis Global Assessment, and Lattice System Physician’s
Global Assessment. J. Am. Acad. Dermatol., 51, 56%569.

Lauria,M. (2013) Rank—based transcriptional signatures: a novel approach to diag—
nostic biomarker deﬁnition and analysis. Syst. Biomed, in press.

Luo,J. et al. (2010) A comparison of batch effect removal methods for enhancement
of prediction performance using MAQC—II microarray gene expression data.
Pharmacogenomics J., 10, 2787291.

Marbach,D. et al. (2012) Wisdom of crowds for robust gene network inference. Nat.
Methods, 9, 7967804.

Matthews,B.W. (1975) Comparison of the predicted and observed secondary
structure of T4 phage lysozyme. Biochim. Biophys. Acta, 405, 442451.

Meyer,P. et al. (2011) Veriﬁcation of systems biology research in the age of collab—
orative competition. Nat. Biotechnol., 29, 8117815.

Meyer,P. et al. (2012) Industrial methodology for process veriﬁcation in research
(IMPROVER): toward systems biology veriﬁcation. Bioinformatics, 28,
119371201.

Mook,S. et al. (2007) Individualization of therapy using MammaPrint:
from development to the MINDACT Trial. Cancer Genomics Proteomics, 4,
1477155.

Nandy,P. et al. (2013) Learning diagnostic signatures from microarray data using
Ll—regularized logistic regression. Syst. Biomed, in press.

Nguyen,B. et al. (2012) Comparison of molecular subtyping with BluePrint,
MammaPrint, and TargetPrint to local clinical subtyping in breast cancer
patients. Ann. Surg. Oncol., 19, 325773263.

Perou,C.M. et al. (2000) Molecular portraits of human breast tumours. Nature, 406,
7477752.

Prill,R.J. et al. (2010) Towards a rigorous assessment of systems biology models: the
DREAM3 challenges. PLoS One, 5, e9202.

Schena,M. et al. (1995) Quantitative monitoring of gene expression patterns with a
complementary DNA microarray. Science, 270, 467470.

Shannon,P. et al. (2003) Cytoscape: a software environment for integrated models
of biomolecular interaction networks. Genome Res., 13, 249872504.

Shi,L. et al. (2010) The MicroArray Quality Control (MAQC)—II study of common
practices for the development and validation of microarray—based predictive
models. Nat. Biotechnol., 28, 8277838.

Tarca,A.L. et al. (2007) Machine learning and its applications to biology. PLoS.
Comput. Biol., 3, e116.

Tarca,A.L., Than,N.G. and Romero,R. (2013) Methodological Approach from the
Best Overall Team in the IMPROVER Diagnostic Signature Challenge. Syst.
Biomed, in press.

Tibshirani,R. et al. (1996) Regression shrinkage and selection via the lasso. J. Royal.
Statist. Soc B., 58, 2677288.

Yamani,M.H. et al. (2007a) Post—transplant ischemic injury is associated with
up—regulated AlloMap gene expression. Clin. T ransplant., 21, 5237525.

Yamani,M.H. et al. (2007b) Transplant vasculopathy is associated with
increased AlloMap gene expression score. J. Heart Lung T ramplant., 26,
403406.

 

2899

112 /810's112u1n0fp101x0"sotwuiJOJHtotq/ﬁduq uror} papeo1umoq

9103 ‘0g1sn8nv uo ::

