Bioinformatics, 3216), 2016, 828—834

doi: 10.1093/bioinformatics/btv678

Advance Access Publication Date: 20 November 2015
Original Paper

 

Sequence analysis

CDSfold: an algorithm for designing a protein-
coding sequence with the most stable
secondary structure

Goro Terai1'2'* Satoshi Kamegai1'2 and Kiyoshi Asai1'3'*

1National Institute of Advanced Industrial Science and Technology (AIST), Koto-ku, Tokyo 135-0064, Japan, 2INTEC
lnc., Koto-ku, Tokyo 136-8637, Japan and 3Graduate School of Frontier Sciences, University of Tokyo, Kashiwa
277-8562, Japan

*To whom correspondence should be addressed
Associate Editor: lvo Hofacker

Received on April 23,2015; revised on November 3, 2015; accepted on November 12, 2015

Abstract

Motivation: An important problem in synthetic biology is to design a nucleotide sequence of an
mRNA that confers a desirable expression level of a target protein. The secondary structure of pro—
tein—coding sequences (CD83) is one potential factor that could have both positive and negative ef—
fects on protein production. To elucidate the role of secondary structure in CD83, algorithms for
manipulating secondary structure should be developed.

Results: We developed an algorithm for designing a CDS with the most stable secondary structure
among all possible ones translated into the same protein, and implemented it as the program
CDSfold. The algorithm runs the Zuker algorithm under the constraint of a given amino acid se—
quence. The time and space complexity is O(L3) and O(L2), respectively, where L is the length ofthe
CDS to be designed. Although our algorithm is slower than the original Zuker algorithm, it could
design a relatively long (2.7—kb) CDS in approximately 1 h.

Availability and implementation: The CDSfold program is freely available for non—commercial
users as stand—alone and web—based software from http://cdsfold.trahed.jp/cdsfold/.

Contacts: terai—goro@aist.go.jp or asai@k.u—tokyo.ac.jp

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

Protein expression levels are reportedly affected by various types of
mRNA features, such as codon usage (Sharp and Li, 1987), rare
codon clusters (Kane, 1995), secondary structures in untranslated
regions (Mignone et (11., 2002) and protein-coding sequences (CDSs;
see below), Kozak motif (Kozak, 1984) and Shine-Dalgarno se-
quence (Salis et (11., 2009). Among them, secondary structure is diffi-
cult to handle because of the need to consider base pair interactions
between distant nucleotides and complex energy parameters as-
signed to each part of the secondary structure. This may be one of
the reasons that some recent methods for designing CDSs do not
consider secondary structural features (Chin et (11., 2014; Chung and
Lee, 2012; Gaspar et (11., 2012; Raab et (11., 2010). The secondary

structure of CDSs, however, can have substantial effects on protein
production as described below, although the mechanisms by which
secondary structure affects protein production are not understood
fully, especially in eukaryotes.

Previous studies have found that secondary structures near the
start codon tend to be unstable in both prokaryotes and eukaryotes
(Gu et (11., 2010; Kertesz et (11., 2010; Robbins—Pianka et (11., 2010;
Wan et (11., 2014), suggesting that secondary structures have nega-
tive effects on protein expression levels. Indeed, in prokaryotes, it
was shown that a stable secondary structure around the start codon
reduced protein expression levels, possibly by blocking the access of
the ribosome to the ribosome binding site (Kudla et (11., 2009). Also,
in eukaryotes, a previous study demonstrated that the secondary

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 828

/310‘srcumo[p10}xo‘sopcuHOJIIrorq/ﬁdnq

CDSfold

829

 

structure around the start codon strongly reduced protein expression
levels (Vega Laso et al., 1993). This was confirmed by a recent study
based on the large—scale measurements of protein abundance for
over 2000 sequence variants in yeast (Dvir et al., 2013). Therefore,
it may be possible to decrease protein expression levels by artificially
inserting a stable secondary structure near the start codon in both
prokaryotes and eukaryotes.

Secondary structures far downstream of the start codon may also
have effects on protein production. It is commonly believed that the
secondary structures in CDSs impede translation elongation, result—
ing in a reduction of protein production. It has, however, been
pointed out that slow elongation may not result in decreased protein
production as long as there is sufficient space between elongating
ribosomes (Plotkin and Kudla, 2011). Moreover, it has been sug—
gested that slow elongation can assist in proper co—translational pro—
tein folding (Kramer et al., 2009). Therefore, slow elongation does
not necessarily decrease protein expression levels. Moreover, it can—
not be ruled out that the secondary structures in CDSs have positive,
rather than negative, effects on protein production by protecting
mRNAs from various types of negative factors such as RNase diges—
tion, down—regulation by microRNAs, and unintended interactions
with other mRNA molecules. Interestingly, recent studies based on
genome—wide measurements of RNA secondary structure in yeast
(Kertesz et al., 2010), found a high correlation between secondary
structure and protein expression levels (Park et al., 2013; Zur and
Tuller, 2012); mRNAs of strongly expressed genes tend to form a
more stable secondary structure. Although still arguable, these stud—
ies suggest a causal relationship between protein expression levels
and the stability of the secondary structures of CDSs. Therefore, it is
worth investigating whether (and to what degree) artificially stabi—
lized secondary structures in CDSs decrease or enhance protein ex—
pression levels.

To elucidate the effect of secondary structures in CDSs as well as
utilize the features of secondary structures to control protein expres—
sion levels, algorithms for handling the secondary structures of
CDSs should be developed. Currently, however, there are very few
tools for stabilizing the secondary structures of CDSs. Gaspar et al.
recently developed the mRNA optimiser (Gaspar et al., 2013),
which is based on a simulated annealing algorithm. Although the
method was intended to remove secondary structures from CDSs, it
can also be used to stabilize the secondary structures. Here, we de—
veloped a different approach that was based on a dynamic program—
ming algorithm. It designs the CDS with the most stable secondary
structure among all possible ones translated into the same protein.
In our algorithm, the Zuker algorithm (Zuker and Stiegler, 1981) is
executed under the constraint of a given amino acid sequence.
Although our algorithm uses larger DP matrices than the original
Zuker algorithm, the fundamental procedure of both algorithms is
the same. Therefore, as with the Zuker algorithm, the time and
space complexity of our algorithm is O(L3) and O(L2), respectively,
where L is the length of the CDS to be designed.

2 Methods

We start with a description of the simplified version of our algo—
rithm, which designs a CDS with the maximum number of base
pairs. The algorithm executes the Nussinov algorithm (Nussinov et
al., 1978) under the constraint of a given amino acid sequence. The
original Nussinov algorithm is as follows:

2.1 Nussinov algorithm

We are given a nucleotide sequence. Let L be the length of this se—
quence. Among the numerous secondary structures that can be
formed for the nucleotide sequence, the maximally base—paired
structure can be obtained by the following algorithm:

v(i+17/')
v(i7/- 1)
V(i+ 1,/— 1) + 5<i,/)
max [y(i, k) + VUQ + 1,/')]

i<k<j

“2031) I max

where y(i, /) is the maximum number of base pairs that can be formed
for a sub—sequence from position i to j, and 5(1'. /) takes 1 if the nucleo—
tides in positions 1' and f can form a base pair, or 0 otherwise.

The diagonal elements of the y matrix and their neighboring elem—
ents, y(i.i — 1), are initialized to be 0. Then, the Nussinov algorithm
recursively calculates y(i. /) until y(1. L) is obtained. The value of y(1.
L) is the number of base pairs in the maximally base—paired structure.

The positions of the base—paired nucleotides in the maximally
base—paired secondary structure can be obtained by tracing back the
y matrix, beginning from y(1, L) (see Durbin et al. (1998) for a con—
cise explanation).

2.2 Nussinov algorithm under amino acid constraints
We are given an amino acid sequence. Let L be the length of the CDS
to be designed. Let N, be the set of possible nucleotides at the i th pos—
ition of the CDS. Let n, be the realization of a nucleotide at position i.
The size of N, varies from 1 to 4 depending on the amino acid residue
and its codon position. Specifically, 1 or 2 nucleotides are allowed in
the first and second codon positions of all amino acid residues, whereas
2 or 4 nucleotides are allowed in the third position in most cases.

For some amino acid residues, there is a ‘dependency’ in their
codons. For example, serine is coded for by 6 codons: AGU, AGC,
UCU, UCC, UCA and UCG. If the first codon position of serine is A,
then the second position must be G. To cope with such dependen—
cies, let Niln be the set of allowable nucleotides at position 1' after
nucleotide 11. Similarly, let Ni /\ n be the set of allowable nucleotides
at position 1' before nucleotide 11.

For leucine and arginine, there are nucleotide dependencies between
the first and third codon positions. As described later in this section, we
can convert the non—adjacent nucleotide dependencies in leucine and
arginine into adjacent ones. Here, we temporarily assume that there
are no such nucleotide dependencies in leucine and arginine.

The algorithm for designing a CDS with the maximum number
of base pairs is as follows:

Algorithm 1: the Nussinov algorithm under amino acid con—
straints, fill stage

(137') =
max "“1‘"’ i-l-1,'
"MleNﬂllmlv ( 7)]
max "r"! 1 i, ' — 1
"I 16M Mb ( I )l (2)
max
max [31"“1’”1(i+1,j—1)+(5/(m,nj)]

nHIENH1|n,.n, IEN,1/\n,

him“ (i, k) + 7"“ 1"“ (k + 177)]

max
i<lZ<jJ1kENlek (IENMIMA

where 1/"“"/(i,/) retains the maximum number of base pairs among
the maximally base—paired secondary structures of the sub—sequences

ﬁrespzumol‘proyo'sopcuuowtotq/ﬁdnq

830

G. Terai et al.

 

in which the first and last nucleotide is 11, and 11,, respectively, and 5’
(11,-,11,~) takes 1 if 11, and 111 can form a base pair, or 0 otherwise.

Similar to the original Nussinov algorithm, the diagonal elem—
ents and their neighboring elements, yn‘ "‘"1 (i. i — 1), are initialized to
be 0 for all allowable 11, and 11i_1. In addition, pm” (i./') elements for
all unallowable 11, and 11, under amino acid constraints are initialized
and fixed to be —00.

Then, Algorithm 1 recursively calculates y”“"/(i./) until y”“”L(1.
L) is obtained for all possible 111 and 11L. The maximum value of
ym‘”L(1,L) over all possible 111 and 11L is the maximum number of
base pairs among the maximally base—paired secondary structures of
all possible CDSs translated into the given amino acid sequence.

Note that multiple y elements in each i, / position, which are
indexed by 11, and 11,, are not needed for the amino acid residues
other than serine, leucine and arginine. If a given amino acid se—
quence does not contain serine, leucine, or arginine (in other words,
all codon positions are independent), a single y element in each i, i is
sufficient to calculate the maximum number of base pairs over all
possible CDSs. The use of multiple y elements, however, is relevant
when we extend Algorithm 1 to energy minimization based on the
energy model obtained by the Turner group (Mathews et al., 1999),
in which various types of energetic contributions are determined ac—
cording to the adjacent nucleotides.

2.2.1 Obtaining the nucleotide sequence of a CDS by backtracking
In the original Nussinov algorithm, the maximally based—paired sec—
ondary structure can be obtained by tracing back the y matrix. In
the Nussinov algorithm under amino acid constraints, the nucleotide
sequence of a CDS with the maximum number of base pairs, as well
as its maximally based—paired secondary structure, can be obtained
by a similar backtracking algorithm. Let y“11”L(1,L) be the max—
imum value of ynl‘”L(1,L) for all possible 111 and 11L. The pseudo—
code of the backtracking algorithm is described as Algorithm 2.

 

Algorithm 2

 

1 Initialization:

2 Push(1, L, 111, 11L) onto stack.
3 cds(1) <— 111 [> Record 111 and 11Las the ﬁrst and
4 cds(L) <— 11L [> last nucleotide, respectively.
5: while stack is not empty do
6.

7

8

9

pop(i./,11,~,11,~)
if i 2 /' then
continue;
: for all 11,11 6 Ni+1l11i do

10: if y"“"r(i./) : ynltl‘m (i + 1,/) then
11: cds(i + 1) <— 11,11
12: push (i + 1./.11,~+1,11,-)
13: continue;
14: for all 11,--1 E N;_1 /\ 11; do
15: if 'y”“"/(i,/) : 'ynr‘”c1(i,/— 1) then
162 Cd5(f —  <— I’ll'_1
17: push (i,/' — 1,ni,11,-_1)
18: continue;
19: for all 11,11 6 Ni+1l11i and 11,4 6 N;_1A 11; do
20: if y"1‘"r(i./) :
21: 'yndlﬂc1 (i + 1,/' — 1) + 5’(11,-,11,~) then
22: cds(i + 1) <— 11,11
23: Cd5(f —  <— I’ll'_1
24: if 5’(11,-,11,~) : 1 then

25: Record i, i as base—paired position

26: push (i + 1./' — 1,ni+1,n,-_1)

27: continue;

28: for all k such that i< k </ do

29: for all 11,2 6 Nk and 11,211 E Nk+1l11k do
30: if y”11"/(i,/) :

31: 'y”“”k(i, k) + WNW/(k + 1,/') then
32: cds(k) <— 11;z

33: cds(k + 1) <— 11,211

34: push (i.k,11,~,11k)

35: push (k + 1./.11k+1,11,-)

36: continue;

 

Starting from WM“ (1,L) element, the algorithm finds 1 or 2
elements from which 1X11“ (1 . L) is derived. We use the word derived
when the equality in line 10, 15, 20, or 30 holds. For example, if the
equality in line 10 holds, y”“"/(i./) is derived from yn‘tl‘”/(i+ 1./').
Then, the algorithm recursively finds 1 or 2 elements from which
each of the newly found elements is derived. As 2 elements at most
are derived in each recursion (see line 30), the stack data structure is
used to store them.

The nucleotide sequence of a CDS is obtained by recording 1 or
2 nucleotides in each recursion. For example, in line 10, if «WW/(i, /)
is derived from y”‘+11”/(i+ 1./'), the algorithm records 11,11 as the
i+ 1th nucleotide in line 11. The position of a base pair in the max—
imally base—paired secondary structure is obtained by recording
base—paired positions in line 25 if 6’(11,~,11,~) : 1 and y”11”/(i,/) is
derived from yn‘tl‘m’l (i + 1,/' — 1) in line 20.

2.2.2 Introducing extended nucleotides

For leucine and arginine, there are nucleotide dependencies between
the first and third codon positions. For example, leucine is coded for
by 6 codons: UUA, UUG, CUU, CUC, CUA and CUG. If the first
position is U, the third position is restricted to A or G. Algorithms 1
and 2 can cope with the dependency between adjacent nucleotides,
but cannot consider the dependencies between the first and third
positions. Fortunately, by introducing extended nucleotides, we can
convert the non—adjacent nucleotide dependencies in leucine and ar—
ginine into adjacent ones. For leucine, we classified the nucleotide U
in the second codon position into 2 different Us based on the nucleo—
tide in the third position (Fig. 1). The second position is denoted by
UAG and UCU if the third position is G or A and C or U, respectively.
If the first position is C, then the second position can be both UAG
and UCU. The extended nucleotides we used here and their depend—
encies are summarized in Figure 1.

2.3 Zuker algorithm under amino acid constraints

In the Zuker algorithm (Zuker and Stiegler, 1981), the most stable
secondary structure in terms of the Turner energy model can be cal—
culated for a given nucleotide sequence. Although the Zuker algo—
rithm is more complex than the Nussinov algorithm, the

Leucine Arginine

c C
CU C CU
c U (U G <U
A AG A
U UAG<G A G (G

Fig. 1. Extended nucleotide representations for the second codon position of
leucine and arginine. Arrows indicate the dependencies of the adjacent nu-
cleotides. For example, UCU in leucine can be followed by C or U

ﬁm'sreumol‘prqxo'sopeuuowtotq/ﬁdnq

CDSfold

831

 

fundamental procedure of both algorithms is the same; namely, the
optimal secondary structure is obtained from that of shorter sub-se-
quences. We extended the Nussinov algorithm under amino acid
constraints so it can execute the Zuker algorithm under amino acid
constraints. It is the Zuker version of the algorithm that was imple-
mented in the CDSfold program.

Algorithm 3: the Zuker algorithm under amino acid constraints,

fill stage
F1101) :
min [F"’+‘="r(i+1,j)]
nr+lENr+llnr
' 11,-11,1 ' ',
"7431,5511,"le 7(171 1)] (3)
min

C1003!)

z<lz<), nkeNrjIIlnleHENHﬁn, [FM-ink (17  + FnLVIl-ynz  + 171)]
where F”“”/(i,/) retains the smallest minimum free energy (MFE)
over a set of sub-sequences in which the first and last nucleotide is 11,
and 11,, respectively. The recursion equations of Algorithm 3 are al-
most the same as those of Algorithm 1; the only difference is that
the third equation is replaced by C”“”/(i,/), which retains the small-
est MFE provided that 11, and 11, form a base pair.

When calculating C”“”/(i,/), we must consider the following 5
cases: nucleotides 11, and 11, form a base pair that

immediately follows another base pair,
encloses a hairpin loop,

encloses a bulge loop,

encloses internal loops,

H‘S’JP.“

5. encloses a multi-loop.

2.3.1 Case 1: Two consecutive base pairs

In the first case, C”“”/(i,/) is obtained by considering the energy of 2
consecutive base pairs; this energy is commonly called stacking e11-
ergy. For a particular base pair between 11, and 11,, we must consider
all possible base pairs between N,“ and N,_1. Therefore, the small-
est MFE when a base pair 11, and 11, immediately follows another
base pair is obtained as follows:

mm [Cn‘H‘n/Tl  +  _  + Estacking<nis 71): ni+1 ~, nf—1>j

"1+1 6 NI+1Inl
71,71 6 M71 /\ 71,

(4)

where Estacking is a function that calculates the stacking energy depending
on a base pair between 11, and 11, that immediately follows a base pair be-
tween 11,+1 and 11,-1. For example, a G:C base pair that follows C:G is
far more stable (—3.4 kcal/mol) than A:U following U:A (—0.9 kcal/
mol). The stacking energy is assumed to be +00 if a base pair cannot be
formed either between 11, and 11, or between 11,11 and 11,-1.

2.3.2 Case 2: Hairpin loop

In the second case, nucleotides 11, and 11, enclose a hairpin loop. An
example of a hairpin loop is shown in Figure 2a. In the Turner en-
ergy model, the energy of a hairpin loop depends on the nucleotides
in the 4 positions indicated in Figure 2a. The smallest MFE when 11,
and 11, enclose a hairpin loop is as follows:

' 17
mln [Ehairpin<nitnftni+1inf—111',  
711+1 6 Ni+1l7li
71,‘_1 E N,‘_1/\ 71,‘

where Ehairpin is a function that calculates the energy of a hairpin
loop depending on the 4 nucleotides and the length of the hairpin

(d)

   

Fig. 2. Nucleotides affecting the energy of 4 types of loop structures. (a)
Hairpin loop, (b) bulge loop, (0) internal loops and (d) multi-loop. A circle rep-
resents a nucleotide. A base pair is denoted by the 2 nucleotides connected
with a bold line. Filled circles are the nucleotides that affect the energy of the
loops. Letters associated with the circles indicate positions on a nucleotide
sequence

loop 11”(: j — i — 1). The energy of the hairpin loop is assumed to be
+00 if a base pair cannot be formed between 11, and 11,.

In the Turner energy model, there is a special table specifying the
energy parameters for small hairpin loops of sizes 5, 6 and 8-nt
(including a closing base-pair). For those hairpins, all nucleotides in
the hairpin loop inﬂuence the free energy. To take this into account,
we enumerate all possible 5, 6, 8-mers starting from each position of
a CDS before running the recursion, and check whether there can be
the special hairpin loops between position i and i when i — i + 1 : 5
. 6 or 8.

2.3.3 Case 3: Bulge loop

In the third case, 11, and 11, enclose a bulge loop. Figure 2b is an ex-
ample of a bulge loop that is located between position i and p. The
smallest MFE when 11, and 11, enclose a bulge loop is:

min ICn”‘”/"(P~,/ — 1) + Ebulge<nienpenf—1anfeyl>I
1+ 1 < p < j — 1
11,, E Np
71,‘_1 E N,‘_1/\ 71,‘

(6)

where Ebulge is a function that calculates the energy of a bulge loop
depending on the 4 nucleotides indicated in Figure 2b and the length
of the bulge loop 1/[(: p — i — 1). The energy of the bulge loop is
assumed to be +00 if a base pair cannot be formed either between 11,
and 11, or 11,, and 11,-1.

The smallest MFE when a bulge loop is located on the right side
of the stem can be calculated similarly (see Supplementary
Methods).

2.3.4 Case 4: Internal loops

In the fourth case, 11, and 11, enclose internal loops (Fig. 2c). In the
Turner energy model, the energy of the internal loops depends on
the 8 positions indicated in Figure 2c. The smallest MFE when a
base pair formed by 11, and 11, encloses internal loops is as follows:

min [Cnp‘m’  +Eintloop<lileyleyr>l (7)
1+ 1 < p < q < j — 1
nil E Nﬁenq 6 N4
[/l E \P(7li~.”ﬁ~.”q~.”i)

where ‘P(11,,11,,,11,,,11,) is a set of possible nucleotides in the 8 pos-
itions, provided that 11,, 11,, 11,, and 11,, are given. Eimlmp is a function
that calculates the energy of the internal loops depending on l//, as
well as 111 and 11’, which are the length of the left and right side of the
internal loops, respectively. The energy of the internal loops is
assumed to be +00 if a base pair cannot be formed either between 11,
and 11, or 11,, and 11,,.

/310'S[BHm0prOJXO"SOIJBIIIJOJIIIOIqﬂZdnq

832

G. Terai et al.

 

2.3.5 Case 5: Multi-loop
In the last case, 11, and 11, enclose a multi—loop. A multi—loop is a loop
structure enclosed by 3 or more base pairs. An example of a multi—
loop enclosed by 3 base pairs is shown in Figure 2d. The smallest
MFE when 11, and 11, enclose a multi—loop is as follows:

min IM"‘+1"‘/’1 (i + 1,/' — 1) + MLclosing(11,-, 11,-)1 (8)

"1+1 6 Ni+1lni
I’ll'_1 E Nl'_1/\ 11,

where M"I+1‘”H(i + 1,/' — 1) is the smallest MFE of sub—sequences
from 11,11 to 11,-1 that are a part of a multi—loop. MLCIOS,ng is the en—
ergetic penalty imposed when a base pair between 11, and 11, encloses
a multi—loop. The calculation of Mn‘tl‘m’1 is slightly complicated and
involves yet another DP matrix (for details, see Supplementary
Methods).

Once all values in the DP matrices are calculated, a traceback al—
gorithm similar to Algorithm 2 can be used to obtain the nucleotide
sequence of a CDS with the most stable secondary structure. For
conciseness, the traceback algorithm and the complete details of
Algorithm 3 are described in the Supplementary Methods.

In Algorithm 3, the energy of dangling ends is not taken into
account, because considering it makes our algorithm much more
complicated and slower. Therefore, the current version of CDSfold
does not consider dangling energy. However, we show the algo—
rithm that can consider dangling energy in the Supplementary
Methods.

2.4 Comparison with simulated annealing

As a baseline method for comparison, we consider a more straight—
forward approach based on the simulated annealing algorithm. It it—
eratively optimizes the secondary structure of a CDS by successive
mutations under amino acid constraints. The procedure is as
follows:

1. An initial CDS is generated randomly that is used as a template.
In addition, the number of iterations, denoted by i, is set to 0.

2. The MFE of the template is calculated in kcal/mol (denoted by
e).

3. A single nucleotide in the template is randomly mutated under
the amino acid constraints. i is increased by 1.

4. The MFE of the mutated CDS is calculated in kcal/mol (denoted
by e’).

5. If eZe’, the template is updated to the mutated CDS and e is also
updated to e’. Otherwise, the template and e are updated with
the following probability:

 

e — e’
Pupdate : 6XP< CT, > 

where T is a temperature parameter that takes 0 < T < 1. The T
value (T with exponent i) approaches 0 as the number of iterations i
increases, which means that Pupdate is also close to 0 as i increases.
Thus, the larger i becomes, the more unlikely the template is
updated. 6 is another parameter that is set to c : 1000 in this study
to make Pupdm close to 1 when i is small.

Processes 3—5 are repeated until a predefined criterion is satis—
fied. In this study, we terminated the algorithm if the MFE (e value)
is the same during 1000 successive iterations or the running time ex—
ceeds 100 h. For the calculation of MFE, we used the RNAfold pro—
gram in Vienna RNA Package version 2.1.1 (Lorenz et al., 2011).
We used RNAfold with the —d 0 option to use the ‘no—dangle model”.
The difference between our simulated annealing approach and

mRNA optimiser is an objective function to be optimized. The
mRNA optimiser uses a ‘pseudo—MFE’ as an objective function of
simulated annealing, which is proposed to have a good correlation
with the real MFE (Gaspar et al., 2013).

2.5 Computational environment

All computational experiments were performed on the Chimera
cluster system at AIST, which had 176 Intel Xeon E5550 CPUs
(2.53 GHz).

3 Results and discussion

3.1 Running time for real biological sequences

The running time of our algorithm is affected by the amino acid
composition of the input sequence, as well as the length of the CDS
to be designed. If an input sequence contains more residues coded
for by more codons, our algorithm spends more time assessing all
nucleotide combinations that affect the energy of the secondary
structure.

To estimate empirically the influence of different amino acid
compositions and evaluate the applicability of our method to real
biological data, we measured the running time of CDSfold using
proteins in the UniProt database (UniProt Consertium, 2015). We
obtained amino acid sequence segments of the same length from
the start codon of 100 randomly selected proteins. Here, we ob—
tained sequence segments with lengths of 100, 300, 500, 700, 900,
1100, 1300 and 1500 amino acids, separately. Figure 3 shows the
mean and standard deviation (SD) of the running time for each
length. On average, it takes less than 1 h to design a CDS of length
2.7 kbp. As more than 95% of the sequences in the UniProt data—
base are shorter than this length, our algorithm can design a CDS
within 1 h for the majority of proteins. The figure also shows the
SD of the running time is approximately 10—20% of the mean,
indicating that amino acid composition has a modest effect on run—
ning time.

 

Time (h)
2
I

T

I
I
Aﬁgéé‘ééi

| | | |
1000 2000 3000 4000

Length of CD8 (bp)

 

 

 

Fig. 3. Running time of CDSfold. Circles represent mean running times.
Triangles represent mean running times when W: 500 bp. The error bars
represent standard deviation

ﬁm'sreumol‘prqxo'sopeuuqutotq/ﬁdnq

Figure 3

UniProt Consertium, 2015

Fig. 4

Supplementar) Figure 51

1987

Supplementar) Fig. 52

II()lSthC(’[11/., 1998

Figure 5

noa_oxl

v
a
1
n
r.
c
g
a
.
c
n
a

£21.": ..

 

Sharp and Li,

Su pplementar} Figure S3

/3.10'spzumofp10}xo"sotwuuoqutotqﬂ:dnq

834

G. Terai et al.

 

3.4.3 Design of (partially) unstable structure

To evaluate the effect of secondary structure, it is important to de—
sign unstable secondary structures as well as stable ones. In this
study, we developed a fast heuristic approach for designing a CDS
with unstable structure, based on a pseudo—MFE similar to the one
developed by Gaspar et al. (2012) (see Supplementary Methods).
The web—application has radio buttons for switching between energy
minimization by the dynamic programing and energy maximization
by the heuristic approach.

The effect of the secondary structure may vary depending on the
position on a CDS. Therefore, we developed a two—step procedure
for designing a CDS with partially unstable secondary structure and
implemented it in CDSfold. In the first step, energy minimization by
the dynamic programing is performed under the assumption that nu—
cleotides in a given interval do not form base—pairs. Specifically, we
set C”“”r(i./) in Eq. 3 to be +00 when i and/or / is within the interval.
Note that a CDS designed under this assumption can have base—pairs
in the interval when this assumption is removed. Therefore, in the
second step, the heuristic pseudo—MFE maximization is performed
on the interval to remove secondary structure. Users can indicate an
interval where the secondary structure should be unstable.

4 Conclusion

We developed an algorithm for designing a CDS with the most sta—
ble secondary structure in terms of the Turner energy model. It was
shown that CDSfold can design CDSs of most genes within 1 h. It
was also shown that our algorithm can design CDSs with a more
stable secondary structure than the method based on simulated an—
nealing, especially when a CDS is long. The algorithm is useful for
investigating the effect of the secondary structure of a CDS as well
as utilizing features of the secondary structure to control protein ex—
pression levels. Note that, by changing the secondary structure of a
CDS, potential binding sites for other regulatory proteins or factors
might be also changed, which might be responsible for the change in
expression level. Therefore, the effect of the secondary structure
should be investigated using at least several different proteins.

Acknowledgements

We thank the members of the Computational Biology Research Center,
National Institute of Advanced Industrial Science and Technology for useful

discussions.

Fu ndi ng
This work was supported by the commission for the Development of Artiﬁcial

Gene Synthesis Technology for Creating Innovative Biomaterial from the
Ministry of Economy, Trade and Industry, Japan.

Conﬂict of Interest: none declared.

References

Chin,].X. et al. (2014) Codon Optimization OnLine (COOL): a web-based
multi-objective optimization platform for synthetic gene design.
Bioinformatics, 30, 2210—2212.

Chung,B.K. and Lee,D.Y. (2012) Computational codon optimization of syn-
thetic gene for protein expression. BMC Syst. Biol., 6, 134.

Durbin,R. et al. (1998) Biological sequence analysis: Probabilistic models of
proteins and nucleic acids, chapter RNA structure analysis. Cambridge
University Press, Cambridge, UK, pp. 260—298.

Dvir,S. et al. (2013) Deciphering the rules by which 5’-UTR sequences affect
protein expression in yeast. Proc. Natl. Acad. Sci. U. S. A., 110, E2792—
2801.

Gaspar,P. et al. (2012) EuGene: maximizing synthetic gene design for heterol-
ogous expression. Bioinformatics, 28, 2683—2684.

Gaspar,P. et al. (2013) mRNA secondary structure optimization using a corre-
lated stem-loop prediction. Nucleic Acids Res., 41, e73.

Gu,W. et al. (2010) A universal trend of reduced mRNA stability near the
translation-initiation site in prokaryotes and eukaryotes. PLOS Comput.
Biol., 6, e1000664.

Holstege,F.C. et al. (1998) Dissecting the regulatory circuitry of a eukaryotic
genome. Cell, 95, 717—728.

Kane,].F. (1995) Effects of rare codon clusters on high-level expression of
heterologous proteins in Escherichia coli. Curr. Opin. Biotechnol., 6, 494—
500.

Kertesz,M. et al. (2010) Genome-wide measurement of RNA secondary struc-
ture in yeast. Nature, 467, 103—107.

Kozak,M. (1984) Point mutations close to the AUG initiator codon affect
the efﬁciency of translation of rat preproinsulin in Vivo. Nature, 308,
241—246.

Kramer,G. et al. (2009) The ribosome as a platform for co-translational pro—
cessing, folding and targeting of newly synthesized proteins. Nat. Struct.
Mol. Biol., 16, 589—597.

Kudla,G. et al. (2009) Coding-sequence determinants of gene expression in
Escherichia coli. Science, 324, 255—25 8.

Lorenz,R. et al. (2011) ViennaRNA Package 2.0. Algorithms Mol. Biol., 6, 26.

Mathews,D.H. et al. (1999) Expanded sequence dependence of thermo-
dynamic parameters improves prediction of RNA secondary structure.
]. Mol. Biol., 288, 911—940.

Mignone,F. et al. (2002) Untranslated regions of mRNAs. Genome Biol., 3,
REVIEWS0004.

Nussinov,R. et al. (1978) Algorithms for loop matchings. SIAM Appl.
Math., 36, 68—82.

Park,C. et al. (2013) Differential requirements for mRNA folding partially ex-
plain why highly expressed proteins evolve slowly. Proc. Natl. Acad. Sci. U.
S. A., 110, E678—E686.

Plotkin,].B. and Kudla,G. (2011) Synonymous but not the same: the causes
and consequences of codon bias. Nat. Rev. Genet, 12, 32—42.

Raab,D. et al. (2010) The GeneOptimizer Algorithm: using a sliding window
approach to cope with the vast sequence space in multiparameter DNA se-
quence optimization. Syst. Synth. Biol., 4, 2015—2025.

Robbins-Pianka,A. et al. (2010) The mRNA landscape at yeast translation ini-
tiation sites. Bioinformatics, 26, 2651—2655.

Salis,H.M. et al. (2009) Automated design of synthetic ribosome binding sites
to control protein expression. Nat. Biotechnol., 27, 946—950.

Sharp,P.M. and Li,W.H. (1987) The codon adaptation Index—a measure of
directional synonymous codon usage bias, and its potential applications.
Nucleic Acids Res., 15, 1281—1295.

UniProt Consertium (2015) UniProt: a hub for protein information. Nucleic
Acids Res., 42, D204—D12.

Vega Laso,M.R. et al. (1993) Inhibition of translational initiation in the
yeast Saccharomyces cerevisiae as a function of the stability and pos-
ition of hairpin structures in the mRNA leader.  Biol. Chem., 268,
6453—6462.

Wan,Y. et al. (2014) Landscape and variation of RNA secondary structure
across the human transcriptome. Nature, 505, 706—709.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA se-
quences using thermodynamics and auxiliary information. Nucleic Acids
Res., 9,133—148.

Zur,H. and Tuller,T. (2012) Strong association between mRNA folding
strength and protein abundance in S. cerevisiae. EMBO Rep, 13, 272—277.

ﬁm'srcumol‘prqxo'sopeuuqutotq/ﬁdnq

