APPLICATIONS NOTE V°" 2305-13bi‘iSE/Zgﬁiz‘i’iiii‘ifgiéii

 

Systems biology

Advance Access publication September 9, 2013

A simulator for spatially extended kappa models

Oksana Sorokina”, Anatoly Sorokinl'z, J. Douglas Armstrong1 and Vincent Danos1
1School of Informatics, University of Edinburgh, Edinburgh, UK and 2Institute of Cell Biophysics, Russian Academy of

Sciences, Pushchino 142290, Russia
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: Spatial Kappa is a simulator of models written in a variant
of the rule-based stochastic modelling language Kappa, with spatial
extensions.

Availability: The spatial kappa simulator is an open-source project
licensed under the LGPLv3, with Java source, binaries and manual
available at http://github.com/lptolik/SpatialKappa.

Contact: oksana.sorokina@ed.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 8, 2013; revised on August 30, 2013; accepted on
September 2, 2013

The Kappa language is one of a family of rule-based modelling
techniques that support mathematical models in the form of a
collection of rules, where each rule represents only a salient
subset of information about interactions of model species and
modiﬁcations of their states. Thus, Kappa is well suited for
describing highly combinatorial networks [e.g. ErbB signalling
(Danos et al., 2008)]. Additional tools (Danos et al., 2009)
allow the construction of models from descriptions of generic
elements and rules (e. g. receptor and/ or ligand families and inter-
actions between them). Large and dynamic multimolecule pro-
tein complexes can be modelled in a precise and scalable manner
(Sorokina et ai, 2011).

Spatial Kappa (SK) is an extension of Kappa, which supports
spatial concepts in the form of voxel-based compartments, con-
nections between them (known as channels) and translocation
rules for species. This includes the motion of complex species
spanning multiple voxels and compartments. Using these exten-
sions, models can be constructed, which capture the importance
of location and movement of species.

To support diffusion and transport, SK adds ‘next—subvolume’
diffusion (Elf et al., 2003) to the Kappa framework. This
positions SK among other meso-scale modelling techniques,
e.g. MesoRD (Fange et al., 2010) and SmartCell (Ander et al.,
2004). Several existing approaches handle spatially constrained
models (Burrage et al., 2011), but none builds on a rule-based
approach, with the notable exception of cBNG which extends the
BNG rule-based language (Harris et al., 2009). However, unlike
cBNG, SK does not assume that the contents of an individual
compartment are well stirred; agents and complexes can be
distributed heterogeneously.

 

*To whom correspondence should be addressed.

We review the main language concepts (14) embodied in the
simulator (5).

1 COMPARTMENTS AND VOXELS

Compartments can be specified as single voxels (unit volumes) or
as regular lattices of voxels. Once deﬁned, compartments and
voxels within a compartment can be referenced by rules. Most
commonly used compartment shapes are predeﬁned in 2D and
3D with both solid and hollow (open) modes. Examples include
rectangles, circles, cuboids, spheres, cylinders, as well as custom
shapes, e.g. dendritic spines (Fig. 1A, lines 778). The result is a
lattice approximation of the speciﬁed shape ready for simulation.
For open compartment types, thickness (Fig. 1A, line 8) should
also be speciﬁed to constrain the reaction volume.

2 CHANNELS AND PATHS

Voxels within and across compartments can be linked to each
other Via channels. Channels describe both static links between
agents in neighbouring voxels and movement of agents along
predeﬁned routes during active or diffusive transport (Fig. 1A,
lines 11712). A channel deﬁnition, thus, connects a set of source
locations to a set of target locations. Multiple source voxels can
be assigned to the same channel simultaneously if needed. For
example, to represent the lateral movement of a transmembrane
protein complex along the surface of a membrane, the channel
would include coordinated displacement spanning two compart-
ments: cytosol and membrane.

Commonly used intra-compartment channel types are prede-
ﬁned. These include nearest neighbours in 2D lattices (both
Cartesian and hexagonal), nearest neighbours in 3D and directed
nearest neighbours for radial or lateral diffusion within a
compartment.

The predefined channel types can also be used for inter-
compartment movement, subject to them having compatible geo-
metries, free of overlapping voxel and gaps (Fig. 1A, line 12).

3 AGENT LOCATIONS, LINKS AND MOVEMENT

Species deﬁnitions from the original Kappa syntax can be partly
or completely located within a deﬁned geometry, at the onset of
the simulation. Depending on the requirements, species can also
be constrained to a single voxel or allowed to diffuse freely.
Agents can move along the defined channels. Translocation
rules can be deﬁned using species, locations or both. Diffusion of
complexes that span several voxels is also supported. Agents in
neighbouring voxels can be linked together Via channels (Fig. 1A,

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0fp10}x0"sotwuiJOJutotq/ﬁduq 11101} papaolumoq

91oz ‘Og isnﬁnV uo ::

O.Sorokina et al.

 

Imam
sag-n: P:n:amrJ(g,d)
'euauu PauamrJCCIdD
Simon: scurruiugwuum)

Inn-nanny.“
scum-nun: cflasa'l smegma: [:1] [111m
Raina-(nun umbmre wenSmne [:3][13][3][1]

II? IUIUIMIS

11 Miami: diffunun mutual."— imam, :Illlbrune , :(Musnl. :Ial'rm:
1: Ekhamlll. dawn» (Nae-bum- swam —. Emu-m) 4 \

i: (imam- :nhbrm: a urinal)

   

15 [~16 '
16 'mﬂunmJ-ugmur' E:r.=pturJI(q,dI1), F:::utor_:£dll:dwu\rl\ri ,c) 7>:d\fﬁﬁ|un \

17 Emma-(mu). mmouuwummnm .0 I M
is ‘reunlor_ae:ﬁa‘ldj\na' Pecanm—_.-.u).s:maiamziJ 7, x

19 Ferlpmr_:(:ll}. S:uﬁn1ﬂ(PnZ]ille.mal

:a ‘veeepior‘_xuffald_urblm' Pacepmntﬁtlli. Smrruinranziln 7, \

2:1 Eacrptritr). Scurnucvuzu I a.)

Fig. 1. A snippet of an SK model of lateral diffusion of AMPA receptors
on the postsynaptic membrane (A) Transmembrane receptors diffuse
from the spine neck and bind scaffold proteins in the post-synaptic dens-
ity, on the top of the cytosol compartment. Channels are used for cross-
compartmental linkage (lines 12, 16) and multicompartmental diffusion
(lines 11, 16). Snapshot taken after 2’ of simulation (B)

line 15 ‘domainLink’). These spatial links can be created or
broken dynamically like other Kappa links Via transition
rules. Species with cross-compartmental or cross-voxel links
can diffuse along channels with multiple sources (Fig. 1A, line
11). In addition, the rate of a rule may contain an agent descrip-
tion. This allows one, for instance, to modulate the rate of a
diffusion rule as a function of the size of the species being
diffused.

4 SIMULATOR

The simulator underpinning SK was developed to provide the
functionality described while maintaining compatibility with the
reference Kappa simulator KaSim V3 (Feret and KriVine, 2013).
Thanks to this, one can develop a space-less version of a model
(which is natural when exploiting some form of proteomic data),
and, in a second step, embed the model by building ad hoc geo-
metries, channels and translocation rules. The SK simulator uses
a variant of the next subvolume method (Ander et al., 2004; Elf
et al., 2003), modifying the standard Gillespie stochastic simula-
tion algorithm (Gibson and Bruck, 2000; Gillespie, 1977) to
handle both reaction and diffusion transitions (see Manual for
more details). The application outputs simulation results using a
ﬁle format similar to KaSim, and also provides a simple time-
series plot View updated during a running simulation. Running
the simple model in Figure 1 (see also https://github.com/lptolik/
SPKappaR/wiki/SuplementaryImages) can take from 30” to 10’
depending on the model parameters.

5 CONCLUSION

We have presented in this note SK, a language and simulator to
embed rule-based models in space. Although equivalent features
exist in other simulation tools, the complete feature set below is
currently unique:

— Kappa-like rule-based model definition.

— Rule-based simulation for models with combinatorial
complex constructions.

— Flexible compartment definitions support arbitrary dimen-
sions and connectivity between compartments.

— Use of channels to simplify model construction: defined
once, they can be used repeatedly within rules which
involve a spatial element.

— Complex composition-based diffusion rates that can vary
with size and composition of a complex to represent,
e.g. complexes diffusing more slowly as they grow larger.

— Multicompartment complexes allowing for large aggre-
gates or transmembrane arrangements.

— Diffusion of multicompartment complexes Via special
multisource channels.

— The tool for the 3D/4D Visualization of SK models
(see Fig. 1B) is available at https://github.com/lptolik/
SPKappaR.

The formal description of the SK language, examples and the
grammar can be found in the user manual distributed with the
source code.

ACKNOWLEDGMENTS

We acknowledge the valuable contribution of Demon Soft Ltd
(Edinburgh) for their help with programming and drafting the
user manual.

Funding: SynthSys (a Centre for Integrative Systems Biology
funded by the UK Biotechnology and Biological Sciences
Research Council and the UK Engineering and Physical
Sciences Research Council (reference BB/D019621/1); EU FP7
grants HEALTH-F2-2009-241498 (EUROSPIN) and
HEALTH-F4-2010-242167 (SynSys).

Conﬂict of Interest: none declared.

REFERENCES

Ander,M. et al. (2004) Smartcell, a framework to simulate cellular processes that
combines stochastic approximation with diffusion and localisation: analysis of
simple networks. Syst. Biol, 1, 1297138.

Burrage,K. et al. (2011) Stochastic simulation for spatial modelling of dynamic
processes in a living cell. In: Koeppl,H. et al. (eds) Design and Analysis of
Biomolecular Circuits: Engineering Approaches [0 Systems and Synthetic
Biology. Springer—Verlag, New York, pp. 43$2.

Danos,V. et al. (2008) Rule—based modelling, symmetries, reﬁnements. Form.
Methods Syst. Biol., 5054, 1037122.

Danos,V. et al. (2009) Rule—based modelling and model perturbation. Trans.
Comput. Syst. Biol., 5750, 1167137.

Elf,J. et al. (2003) Mesoscopic reaction—diffusion in intracellular signaling. In:
Society of Photo—Optical Instrumentation Engineers (SPIE) Conference Series.
Vol. 5110, pp. 1147124.

Fange,D. et al. (2010) Stochastic reaction—diffusion kinetics in the microscopic limit.
Proc. Natl Acad. Sci. USA, 107, 19820719825.

Feret,J. and Krivine,J. (2013) KaSim Manual. 2013.

Gibson,M.A. and Bruck,]. (2000) Efﬁcient exact stochastic simulation of chemical
systems with many species and many channels. J. Phys. Chem. A, 104,
187671889.

Gillespie,D. (1977) Exact stochastic simulation of coupled chemical reactions.
J. Phys. Chem., 81, 234(k2361.

Harris,L.A. et al. (2009) Compartmental rule—based modeling of biochemical sys—
tems. In: Proceedings of Winter Simulation Conference ( WSC). pp. 9087919.

Sorokina,O. et al. (2011) Towards a quantitative model of the post—synaptic prote—
ome. Mol. Biosyst., 7, 281372823.

 

3106

112 /3.10'spzum0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} papeolumoq

91oz ‘Og isanV uo ::

