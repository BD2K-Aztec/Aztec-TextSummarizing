Bioinformatics, 3217), 2016, 1100—1102

doi: 10.1093/bioinformatics/btv694

Advance Access Publication Date: 25 November 2015
Applications Note

 

Gene expression

RNA-Enrich: a cut-off free functional enrichment
testing method for RNA-seq with improved
detection power

Chee Lee1, Snehal Patil1 and Maureen A. Sartor1'2'*

1Department of Computational Medicine and Bioinformatics and 2Biostatistics Department, University of Michigan,
Ann Arbor, MI 48109, USA

*To whom correspondence should be addressed.
Associate Editor: lvo Hofacker

Received on August 12, 2015; revised on November 2, 2015; accepted on November 19, 2015

Abstract

Summary: Tests for differential gene expression with RNA—seq data have a tendency to identify certain
types of transcripts as significant, e.g. longer and highly—expressed transcripts. This tendency has been
shown to bias gene set enrichment (GSE) testing, which is used to find over— or under—represented biolo—
gical functions in the data. Yet, there remains a surprising lack of tools for GSE testing specific for RNA—
seq. We present a new GSE method for RNA—seq data, RNA—Enrich, that accounts for the above ten—
dency empirically by adjusting for average read count per gene. RNA—Enrich is a quick, flexible method
and web—based tool, with 16 available gene annotation databases. It does not require a P—value cut—off to
define differential expression, and works well even with small sample—sized experiments. We show that

 

adjusting for read counts per gene improves both the type I error rate and detection power of the test.
Availability and implementation: RNA—Enrich is available at http://Irpath.ncibi.org or from

supplemental material as R code.
Contact: sartorma@umich.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Functional enrichment testing is one of the most common downstream
analyses for transcriptomics experiments, facilitating a deeper inter-
pretation of results. Examples of gene set databases used for testing
are Gene Ontology (G0) which includes biological processes, cellular
components and molecular functions, and the Kyoto Encyclopedia of
Genes and Genomes which places genes in metabolic and other path-
ways. Most current gene set enrichment (GSE) methods, such as
DAVID (Huang da et (11., 2009), were developed for microarray
data. These methods often only make use of differential expression
(DE) P-values or ranks, or simply a list of significant genes. With
RNA-seq, which uses whole transcriptome sequencing to quantify
gene expression, tests for DE often exhibit a relationship between read
count and likelihood of detecting DE. For example, when power is
greater to detect longer and/or higher expressed genes, gene sets that
have long genes or that are highly expressed are more likely to be

detected as significant, violating common test assumptions. Thus, ac-
counting for read count per gene may improve standard GSE methods,
which may otherwise not be appropriate for RNA-seq data.

RNA-seq achieves a very high dynamic range, with gene read
counts often varying across six or more orders of magnitude. Read-
count-based methods such as those using a negative binomial model
(e.g. edgeR and DEseq2) can be more likely to identify longer and high-
ly expressed transcripts as significant. Methods that can account for
this bias in GSE testing are GOseq (Young et (11., 2010) which requires
a P-value cut-off, and GSAASeqSP (Xiong et (11., 2014) and SquSEA
(Wang and Cairns, 2014), which require permutations and moderate
to large sample sizes to obtain a sufficient number of unique permuta-
tions of phenotype labels. We have developed RNA-Enrich, a GSE
method that empirically adjusts for average read count per gene, and
does not require a cut-off to define differentially expressed genes
(DEGs), time-consuming permutations or regression models. Similar

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1100

/310‘sreumo[p10}xo‘sopeuHOJIItotq/ﬁdnq

Fig. 1
Kim (7/ LIL, 2012 Sai‘toi~ (7/ LIL, 2009

Supplerncntai‘) bdcthods

Newton (7/ LIL (2007)

Supplerncntai‘) bdcthods

Newton (7/ LIL, 2007

Fig. 1

Supplcrncntai‘) Fig. 51

Li Fig. 1
a .11., 2008
Fig. 1

RNA-Enrich RNA-Enrich

Observed data Observed data

Permuled data Permuled data

Random Sets Random Sets

   

/3.IO'S[BIImOfp.IOJXO'SOpBLUJOJIItth”Zduq

1102

C.Lee et al.

 

Table 1. Top ranked GO terms from RNA-Enrich for LNCaP cell line
treated with DHT

 

 

Rank GO term P FDR

1 Extracellular space 2.3 X 1078 1.6 X 1076
2 Vasculature development 4.6 X 1079 3.4 X 1076
7 Signaling receptor activity 3.9 X 1077 1.3 X 1074
9 Epithelial cell differentiation 2.3 X 1076 5.0 X 1074
10 Cellular biogenic amine metabolic process 2.4 X 10’6 5.0 X 10’4

12 Response to endoplasmic reticulum stress 8.9 X 1076 1.3 X 1073

 

Results shown are limited to the top unrelated GO terms.

exists (Supplementary Fig. 52). RNA—Enrich provides a diagnostic plot
for the user to determine if a relationship between read count and
—log10(P—value) exists in their data (Fig. 1a and d). If a relationship
does exist, we recommend using RNA—Enrich to provide more bio—
logically relevant results. RNA—Enrich also has favorable type I error
rate compared with GOseq and DAVID (Supplementary Figs. 52—54).
The performance of RNA—Enrich with P—values from DESeq2 instead
of edgeR resulted in the same conclusions (Supplementary Fig. SS).
Use of corrected fold change instead of P—values as input showed a dif—
ferent relationship exists, but similarly resulted in a benefit for RNA—
Enrich compared with random sets (Supplementary Methods and
Supplementary Fig. S6).

3.2 Method performance with experimental results
Using RNA—Enrich with the LNCaP cells treated with DHT we
found 192 enriched GO terms (q—valueg 0.05) (Table 1 and
Supplementary Table 51). In comparison, the random sets, GOseq
and DAVID methods identified 35, 8 and 30 enriched GO terms, re—
spectively. We tested a second dataset, mice embryonic fibroblasts
treated with tunicamycin (see Supplementary Methods), that also re—
vealed a relationship between read counts and significance levels,
and resulted in conclusions similar to the LNCaP dataset
(Supplementary Figs. 57—59). Again, RNA—Enrich detected more
GO terms than the alternatives (Supplementary Fig. S7).

In the A549 dataset, we did not expect an advantage to RNA—
Enrich over random sets, since there was no observed relationship
between read count and significance levels. RNA—Enrich found 367
enriched GO terms including negative regulation of transcription,
vasculature development and fat cell differentiation—all top ranked
enriched GO terms also found by random sets and GOseq. Random
sets and GOseq identified 347 and 363 GO terms, respectively.
Based on Figure 1e and f and our overall findings, RNA—Enrich has
the desirable property of reducing to the random sets method when
no relationship with read count exists.

Funding

National Institutes of Health Grants P30ES017885—01 and
R01CA158286—01.

Conflict of Interest: none declared.

References

Huang da,W. et al. (2009) Systematic and integrative analysis of large gene
lists using DAVID bioinformatics resources. Nat. Protoc. 4, 44—5 7.

Kim,].I—I. et al. (2012) LRpath analysis reveals common pathways dysregu-
lated Via DNA methylation across cancer types. BMC Genomics 13, 526.

Li,H. et al. (2008) Determination of tag density required for digital transcrip-
tome analysis: application to an androgen-sensitive prostate cancer model.
P706. Natl Acad. Sci. USA 105, 20179—20184.

Newton,M.A. et al. (2007) Random-set methods identify distinct aspects of
the enrichment signal in gene-set analysis. Ann. Appl. Stat. 1, 85—106.

Sartor,M.A. et al. (2009) LRpath: a logistic regression approach for identify-
ing enriched biological groups in gene expression data. Bioinformatics 25,
211—217.

Wang,X. and Cairns,M.]. (2014) SquSEA: a Bioconductor package for gene
set enrichment analysis of RNA-Seq data integrating differential expression
and splicing. Bioinformatics 30, 1777—1779.

Xiong,Q. et al. (2014) GSAASeqSP: a toolset for gene set association analysis
of RNA—Seq data. Sci. Rep. 4, 6347.

Young,M.D. et al. (2010) Gene ontology analysis for RNA-seq: accounting
for selection bias. Genome Biol. 11, R14.

/810's12um0_fp10}x0'satmuuogutotq/ﬁduq

