APPLICATIONS NOTE

Vol. 27 no. 2 2011, pages 270—271
doi: 1 0. 1093/bioinformatics/btq636

 

Genome analysis

Advance Access publication November 15, 2010

GimmeMotifs: a de novo motif prediction pipeline for

ChlP-sequencing experiments

Simon J. van Heeringen* and Gert Jan C. Veenstra
Department of Molecular Biology, Faculty of Science, Nijmegen Centre for Molecular Life Sciences, Radboud

University Nijmegen, 6500 HB Nijmegen, The Netherlands
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: Accurate prediction of transcription factor binding
motifs that are enriched in a collection of sequences remains a
computational challenge. Here we report on GimmeMotifs, a pipeline
that incorporates an ensemble of computational tools to predict
motifs de novo from ChlP-sequencing (ChlP-seq) data. Similar
redundant motifs are compared using the weighted information
content (WIC) similarity score and clustered using an iterative
procedure. A comprehensive output report is generated with several
different evaluation metrics to compare and evaluate the results.
Benchmarks show that the method performs well on human and
mouse ChlP-seq datasets. GimmeMotifs consists of a suite of
command-line scripts that can be easily implemented in a ChlP-seq
analysis pipeline.

Availability: GimmeMotifs is implemented in Python and runs
on Linux. The source code is freely available for download at
http://www.ncmls.eu/bioinfo/gimmemotifs/.

Contact: s.vanheeringen@ncmls.ru.nl

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on July 7, 2010; revised on October 22, 2010; accepted on
November 9, 2010

1 INTRODUCTION

The spectacular development of sequencing technology has enabled
rapid, cost-efﬁcient proﬁling of DNA binding proteins. Chromatin
immunoprecipitation followed by high-throughput deep sequencing
(ChIP-seq) delivers high-resolution binding proﬁles of transcription
factors (TFs) (Park, 2009). The elucidation of the binding
characteristics of these TFs is one of the obvious follow-up
questions. However, the de novo identiﬁcation of DNA sequence
motifs remains a challenging computational task. Although many
methods have been developed with varying degrees of success,
no single method consistently performs well on real biological
eukaryotic data (Tompa et al., 2005). The combination of different
algorithmic approaches, each with its own strengths and weaknesses,
has been shown to improve prediction accuracy and sensitivity over
single methods (Hu et al., 2005).

Here, we report on GimmeMotifs, a motif prediction pipeline
using a ensemble of existing computational tools (Supplementary
Fig. S1). This pipeline has been speciﬁcally developed to predict TF
motifs from ChIP-seq data. It uses the wealth of sequences (binding

 

*To whom correspondence should be addressed.

peaks) usually resulting from ChIP-seq experiments to both predict
motifs de novo, as well as validate these motifs in an independent
fraction of the dataset.

GimmeMotifs incorporates the weighted information content
(WIC) similarity metric in an iterative clustering procedure to
cluster similar motifs and reduce the redundancy which is the
result of combining the output of different tools (see Supplementary
Material). It produces an extensive graphical report with several
evaluation metrics to enable interpretion of the results (Fig. l).

2 METHODS

2.1 Overview

The input for GimmeMotifs is a ﬁle in BED format containing genomic
coordinates. e.g. peaks from a ChIP-seq experiment or a FASTA ﬁle. This
dataset is split: a prediction set contains randomly selected sequences from
the input dataset (20% of the sequences by default) and is used for motif
prediction with several different computational tools. Predicted motifs are
ﬁltered for signiﬁcance using all remaining sequences (the validation set).
clustered using the WIC score as described below. and a list of non-redundant
motifs is generated.

2.2 Motif similarity and clustering

The WIC similarity score is based on the information content (IC) and is
deﬁned for position i in motif X compared with position j of motif Y as:

WIC(X,,E):,/1C(Xi)-IC(lG)—c-DIC(Xi,l?) (l)

where c is 2.5. and DIC(X,, Yj) is the differential IC deﬁned in Equation (3).
The IC of a speciﬁc motif position is deﬁned as:

X
1C(X,)= ﬁn . 10g2  (2)

ne(A,C,G,T) fbg
where IC(X,) is the IC of position i of motif X . if” is the frequency of
nucleotide n at position i and fbg is the background frequency (0.25). The
differential IC (DIC) of position i in motif X and position j in motif Y is

deﬁned as:
.X )3?
9‘ .10 i — .y .10 i 3
fw g2 (flag) fm g2 (fbg) ()

The WIC score of all individual positions in the alignment is summed
to determine the total WIC score of two aligned motifs. To calculate the
maximum WIC score of two motifs. all possible scores of all alignments are
calculated. and the maximum scoring alignment is kept. Similar motifs are
clustered using an iterative pair-wise clustering procedure (Supplementary
Material).

DIC(X,, 17,-): Z

"EiA,C,G,Tl

 

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[sumoipJOJXO'sorwuiJOJurorq”:duq wort papeolumoq

9103 ‘{g anﬁnv 110::

GimmeMotifs: a motif prediction pipeline

 

GimmeMotifs_4
Motif and consensus

 

 

 

 

 

 

 

TP53
 _ ﬁg é a: 2.31 E-01
anAwannnrerTGyn JASPAR match
Signiﬁcance and enrichment Positional Preference Plot
1 0 4500
4000
0 a 3500
g 5 3000
.5 0-5 g 2500
w
5 M g 2000
to ~— 1500
0 2 1000
500
0 0
0 0.2 0.4 0.6 0.8 1.0 -200 -100 0 100 200
1 - Speciﬁcity Position
Genomic

enrichment 145.35
p-value 0.00
ROC_AUC 0.977
MCNP 9.246

Fig. 1. An example of the GimmeMotifs output for p63 (Kouwenhoven et al..
2010). Shown are the sequence logo of the predicted motif (Schneider and
Stephens. 1990). the best matching motif in the J ASPAR database (Sandelin
et al.. 2004). the ROC curve. the positional preference plot and several
statistics to evaluate the motif performance. See the Supplementary Material
for a complete example.

2.3 Evaluation

The motifs can be evaluated using several different statistics: the absolute
enrichment. the hypergeometric P-value. a receiver operator characteristic
(ROC) graph. the ROC area under the curve (AUC) and the mean normalized
conditional probability (MNCP) (Clarke and Granek. 2003). In addition to
these evaluation metrics. GimmeMotifs generates a histogram of the motif
position relative to the peak summit. the positional preference plot. Especially
in case of high-resolution ChIP-seq data. this gives valuable information on
the motif location.

2.4 Implementation
The GimmeMotifs package is implemented in Python. while the similarity
metrics are written as a C extension module for performance reasons. It is

freely available under the MIT license. Sequence logos are generated using
WebLogo (Schneider and Stephens. 1990).

3 BENCHMARK RESULTS

We performed a benchmark study of GimmeMotifs on 18 TF
ChIP-seq datasets. The ROC AUC and MNCP of the best performing
motif were calculated and compared with the best motif of two other
ensemble methods: SCOPE (Carlson et (11., 2007) and W-ChipMotifs
(Jin et al., 2009) (Supplementary Tables S1 and S2) . The results
show that GimmeMotifs consistently produces accurate results
(median ROC AUC 0.830). The method also signiﬁcantly improves

on the results of SCOPE (ROC AUC 0.613). The recently developed
W-ChIPmotifs shows comparable results to GimmeMotifs (ROC
AUC 0.824), although this tool does not cluster similar redundant
motifs. In addition, the focus of GimmeMotifs is different. While
the web interface of W-ChipMotifs is very useful for casual use,
the command-line tools of GimmeMotifs can be integrated in more
sophisticated analysis pipelines.

4 CONCLUSION

We present GimmeMotifs, a de nova motif prediction pipeline
ideally suited to predict transcription factor binding motifs from
ChIP-seq datasets. GimmeMotifs clusters the results of several
different tools and produces a comprehensive report to evaluate
the predicted motifs. We show that GimmeMotifs performs well
on biologically relevant datasets of different TFs and compares
favorably to other methods.

ACKNOWLEDGEMENTS

We thank all the authors of the computational tools for their publicly
available software. We are grateful to W. Akhtar, R.C. Akkers,
S.J. Bartels, A. Costessi, M. Koeppel, E.N. Kouwenhoven,
M. Lohrum, J.H. Martens, N.A.S. Rao, L. Smeenk and H. Zhou
for data, testing and feedback.

Funding: NWO-ALW (Netherlands Organization for Scientiﬁc
Research-Research Council for Earth and Life Sciences, grant
number 86403002); National Institutes of Health (grant number
R01HD054356) with grants to G.J.C.V.

Conﬂict of Interest: none declared.

REFERENCES

Carlson,J.M. et al. (2007) SCOPE: a web server for practical de novo motif discovery.
Nucleic Acids Res., 35(suppl. 2), W2597W264.

Clarke,N.D. and Granek,J.A. (2003) Rank order metrics for quantifying the association
of sequence features with gene regulation. Biainfarmdtics, 19, 2127218.

Hu,J. et al. (2005) Limitations and potentials of current motif discovery algorithms.
Nucleic Acids Res., 33, 48994913.

Jin,V.X. et al. (2009) W—ChIPMotifs: a web application tool for de novo motif discovery
from ChIP-based high-throughput data. Biainfarmdtics, 25, 319173193.

Kouwenhoven,E.N. et al. (2010) Genome-Wide proﬁling of p63 DNA-Binding sites
identiﬁes an element that regulates gene expression during limb development in the
7q21 SHFMl locus. PLaS Genet., 6, e1001065.

Park,P.J. (2009) ChIP-seq: advantages and challenges of a maturing technology. Nat.
Rev. Genet., 10, 669$80.

Sandelin,A. et al. (2004) JASPAR: an open-access database for eukaryotic transcription
factor binding proﬁles. Nucleic Acids Res, 32(suppl. 1), D917D94.

Schneider,T.D. and Stephens,R. (1990) Sequence logos: a new way to display consensus
sequences. Nucleic Acids Res, 18, 6097£100

Tompa,M. et al. (2005) Assessing computational tools for the discovery of transcription
factor binding sites. Nat. Biatech., 23, 1377144.

 

271

112 /3.Io's[BumoipJOJXO'sorwuiJOJurorq”:duq wort papeolumoq

9103 ‘{g anﬁnv 110::

