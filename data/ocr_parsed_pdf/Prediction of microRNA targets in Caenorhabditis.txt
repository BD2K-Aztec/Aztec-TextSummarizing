ORIGINAL PAPER

Vol. 27 no. 9 2011, pages 1247-1254
doi:10. 1 093/bioinformatics/btr144

 

Sequence analysis

Advance Access publication March 21, 2011

Prediction of microRNA targets in Caenorhabditis elegans using a

self-organizing map

Liisa Heikkinen1’2, Mikko Kolehmainen3 and Garry WonglaZr

1Department of Biosciences, 2Department of Neurobiology, A.|.Virtanen Institute for Molecular Sciences, Biocenter
Finland and 3Department of Environmental Science, University of Eastern Finland, Kuopio, Finland

Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: MicroRNAs (miRNAs) are small non-coding RNAs that
regulate transcriptional processes via binding to the target gene
mRNA. In animals, this binding is imperfect, which makes the
computational prediction of animal miRNA targets a challenging task.
The accuracy of miRNA target prediction can be improved with
the use of machine learning methods. Previous work has described
methods using supervised learning, but they suffer from the lack of
adequate training examples, a common problem in miRNA target
identification, which often leads to deficient generalization ability.
Results: In this work, we introduce mirSOM, a miRNA target
prediction tool based on clustering of short 3’-untranslated region
(3’-UTR) substrings with self-organizing map (SOM). As our method
uses unsupervised learning and a large set of verified Caenorhabditis
elegans 3’-UTRs, we did not need to resort to training using a known
set of targets. Our method outperforms seven other methods in
predicting the experimentally verified C.elegans true and false miRNA
targets.

Availability: mirSOM miRNA target predictions are available at
http://kokki.uku.fi/bioinformatics/mirsom.

Contact: liisa.heikkinen@uef.fi

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 25, 2010; revised on February 20, 2011;
accepted on March 12, 2011

1 INTRODUCTION

MicroRNAs (miRNAs) are an abundant class of small, non-
coding RNAs found in diverse organisms (Bartel, 2009; Lee
et al., 1993). miRNAs direct the post-transcriptional repression
and degradation of mRNAs by binding to their sequence with
partially complementary sites and thus impact a variety of
biological functions, including cell differentiation, organism growth,
development and tumor suppression (Kloosterman and Plasterk,
2006). While the amount of published miRNAs is increasing and a
large number of genes is predicted to be regulated by miRNAs, only
a small fraction of miRNA—target genes are experimentally veriﬁed.
For example, there are now 175 Caenorhabditis elegans miRNAs
annotated in miRBase database (Grifﬁths-Jones et al., 2008), but
only 15 entries for six of these miRNAs in the latest release of
TarBase (Papadopoulos et (11., 2009). As experimental identiﬁcation

 

*To whom correspondence should be addressed.

of miRNA targets is difﬁcult, the computational prediction of the
target genes is a valuable tool to investigate miRNA functions and
in guiding related wetlab experiments.

Occurrence of perfect seed matches (seed=the nucleotides 1—8
of the miRNA 5’-end) from the 3’-untranslated region (3’-UTR)
of the mRNA, evolutionary conservation of the miRNA—target
relationship and the free energy AG of the miRNAszNA duplex
are the most often used determinants in miRNA target recognition
(Brennecke et al., 2005; Enright et al., 2003; Krek et (11., 2005;
Lewis et (11., 2003). However, in animals, miRNA binding to the
mRNA is imperfect, and a perfect seed matching site is neither
necessary nor sufﬁcient for downregulation (Didiano and Hobert,
2006; Vella et al., 2004). Thus, the importance of miRNA 3’ base
pairing to compensate for weak seed pairing has become another
factor in identifying potential miRNA targets (Brennecke et al.,
2005). Also the sequence context of the miRNA target site and the
amount of sites in a 3’-UTR are suggested to have effect on the
miRNA binding efﬁcacy (Didiano and Hobert, 2008; Grimson et al.,
2007; Swtrom et al., 2007; Vella et al., 2004). In all, the predictions
given by different tools are diverse, and the amount of overlapping
miRNAztarget gene predictions is small (Bartel, 2009).

The use of machine learning methods can improve the accuracy
of miRNA target prediction (Kim et al., 2006; Wang and El Naqa,
2008; Yousef et al., 2007). However, the performance of these
methods is dependent on the quantity and quality of the dataset used
in the training. The number of experimentally validated miRNA
true and false targets is small, and while we have some knowledge
about miRNA binding to the target site, our knowledge regarding
false target sites is limited. This problem can be avoided by
using unsupervised learning. In this work, we show how the self-
organizing map (SOM) (Kohonen, 1995) can be used to identify
potential miRNA target sites from Celegans 3’-UTR sequences.
The SOM is a neural network algorithm widely used to categorize
large, high-dimensional datasets by mapping the data into a smaller
dimension, typically into a 2D lattice of interconnected neurons.
Each neuron of the SOM contains a reference model, which
represents a local domain in the input space. In bioinformatics,
SOM is applied to problems like gene expression data analysis
(Toronen et (11., 1999), study of codon usage (Kanaya et al., 2001),
clustering of protein sequences (Kohonen and Somervuo, 2002),
gene ﬁnding (Mahony et (11., 2004) and identiﬁcation of transcription
factor binding sites (Mahony et al., 2005). We trained the SOM
using short substrings of Celegans 3’-UTR sequences so that the
putative target sites for each miRNA were clustered in one or in
two adjacent neurons in the lattice. As the clustering is based on the

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1247

112 /3.IO'S[1211,1110prOJXO'SOIJBLUJOJIIIOIq”Idllq moi; papBOIII/lAOG

9103 ‘Og anﬁnv uo ::

L.Heikkinen et al.

 

 

All possible 22 nt substrings
from C. elegans 3’ UTRs

 

Cluster with SOM algorithm;
weight on the seed area

i:

Collect the 22 m‘ strings mapping
to miRNA clusters

    

 

Filter with total free energy
and/or site conservation

 

Fig. 1. Flow chart for the miRNA target prediction using mirSOM.

overall similarity of the training strings, the SOM captures not only
those veriﬁed miRNA target sites with perfect 7mer and 8mer seed
matches, but also those sites with more imperfect matches. The SOM
contains the whole repertoire of putative miRNA target sites ordered
according to similar seed complementarity, so it likely includes also
the target predictions for currently unknown miRNAs.

2 METHODS

Our goal was to ﬁnd putative miRNA target sites by clustering all the
substrings extracted from the regions of experimentally veriﬁed C.elegans
3’-UTRs. To do this. we constrained the target sites of all miRNAs to have the
same length. As the length of miRNA target site is close to the length of the
binding miRNA and 95% of C.elegans miRNAs are 20724 nt long. with an
average length of 22 nt. we chose 22 nt as the length of training sequences.
Although the length of the most miRNAs differ from 22 nt within a few
nucleotides. this has a minor effect on the result since the last nucleotides in
the 3’-end are not as important as the seed area in the miRNAitarget site
interaction. A process ﬂow chart describing the mirSOM method is given in
Figure 1.

Caenorhabditis elegans 3’-UTR sequence data usea1 for SOM training:
we downloaded all the experimentally veriﬁed C. elegans 3’-UTR sequences
contained in WormBase release WSl95 (Harris et al., 2010). If there
were several transcripts available for a gene. the transcript with longest
3’-UTR was selected. and those sequences that were <50 nt long were
discarded. The ﬁnal sequence set used for training the SPM contained 8980
veriﬁed 3’-UTR sequences. 5071912 nt in length. These sequences were then
segmented into every overlapping 22 nt substrings. resulting a training set
with 1 813 599 22 nt 3’-UTR substrings.

Numerical coding of the input sequences: in order to use SOM
algorithm to cluster short sequences. the nucleotides were coded as follows:
A=[1000]T.C=[010 0]T. G=[0 010]T and T=[O 0 01]T.so each
22 nt sequence was represented by a 4 X 22 matrix. for example substring
S =AGTCAATTTTTTTTAATTTTCT was represented by matrix:

1000110000000011000000
0001000000000000000010
0100000000000000000000
0010001111111100111101

S:

miRNA sequences: the sequences of C.elegans and C.briggsae mature
miRNAs and miRNA*s were downloaded from miRBase release 15
(Grifﬁths-Jones et al., 2008). This dataset includes 176 miRNA and 57
miRNA* sequences for C.elegans. and 121 miRNA and 10 miRNA*
sequences for C.briggsae. This set contains 92 orthologous miRNAs with a
conserved hairpin precursor.

SOM architecture: the structure of the SOM is a 32 X 32 lattice of
interconnected neurons. Each neuron contains a 4 X 22 model matrix. which
is initialized with a random sequence. but is through an unsupervised learning
process modiﬁed to represent the position-speciﬁc characteristics of a larger
set of repeated features in the training data. for example target sites of a
miRNA. As WatsoniCrick base-pairing of a target site to the miRNA seed
is crucial for targeting. the last 8 nucleotides (nucleotides 15722) in the
neuron model matrix representing the seed were weighted so that the input
sequence distance from the model matrix in nucleotides 15 and 22 was
multiplied by a factor of two and in nucleotides 1&21 with a factor of
ﬁve. while the distances in the rest of the nucleotides were not weighted.
Training of the SOM was carried out sequentially. so that after ﬁnding the
most similar neuron weight matrix for a randomly picked training sequence.
this ‘winner’ weight matrix and the weight matrices of its neighbor neurons
were immediately updated towards the training sequence. Thus. during
the training. the weight matrix in each neuron was adjusted to represent
a position-speciﬁc frequency matrix of 3’-UTR substrings clustered to it.
The SOM was trained with 20 epochs with the whole training dataset. In
the ordering phase (epoch 1). the neighborhood of the best matching unit
contained the whole net. but was then decreased linearly so that during the
last ﬁne-tuning phase (epoch 20). it contained only the closest neurons around
the winner node. The learning rate parameter was held constant in the ﬁrst
(lr: 0.9) and last epoch (lr = 0.0001). but was decreased linearly in between.
The size of the SOM and the seed weighting schema used in the ﬁnal network
were found to work best when all networks containing 16 X 16. 24 X 24 and
32 X 32 neurons with different emphasis in the seed area were trained and
their capability to separate the miRNA clusters was analyzed. The SOM
algorithm was implemented with Java 2 SE. the source code is available as
Supplementary Material.

miRNA clusters: for each miRNA. we searched all the 22nt sequences in
our training set that had perfect WatsoniCrick base-pairing in their section
of the last 8nts with a miRNA 7mer seed. Neurons that contained these
seed matching sequences for a miRNA were attached to the cluster of that
miRNA. and so each C. elegans miRNA cluster came to include 173 neurons.
For C.briggsae. the miRNA clusters were deﬁned similarly.

Initial set of miRNA target sites: a larger sequence set containing all the
veriﬁed 3’-UTRs for C.elegans coding transcripts in WS213 was extracted
from WormBase. Again. only the transcript with the longest veriﬁed 3’-UTR
for each gene was kept for analysis. leading to the set of 12 866 veriﬁed
3’-UTRs. All of the 22 nt substrings of these 3’-UTRs were then introduced
to the trained SOM and the substrings hitting the miRNA cluster neurons
were collected. yielding the sets of initial target site predictions for each
miRNA.

Orthologous 3’-UTR sequences ana1 the initial set of miRNA target
predictions for C.briggsae: the predicted C.briggsae WormBase orthologs
for all C.elegans protein coding genes were downloaded from WS215. This
set contained at least one predicted C. briggsae ortholog for 11 851 C.elegans
genes included in our miRNA target prediction gene set. The predicted 3’-
UTR sequences for these orthologs were constructed by extracting 1000 nt

 

1 248

112 /3.IO'S[1211,1110prOJXO'SOIJBLUJOJIIIOIq”Idllq wort papeolumoq

9103 ‘Og anﬁnv uo ::

mirSOM

 

3295 11405 3159 1510 2520-4992 2122 3352 1533 3322-2154 2252-3253

   
 
 

   
    
   
  
 
 
     

2139 3224 2454 2215 621 3265 1645 3033 1915 5531
1 105? 532 7 1530 381 193? 1530 2036 1456 1289 319 2214

   
  
  

      
 
  
 
      
  

    

   

     

3912 1900 995 1259 2052 1525 345 1022 1053 2531 1 3012
2094 1052 2093 5531 5550 2095 4 2932 552 1512 2439 2035 2232 1425 3330 - 2 2432 1945 1120 950 3132—2555 1153 1955
3304- 1322 2013 3932 1941 1301 432 1901 544 2352 2559 1002 2111 2339 994 293 2133 592 1353 1205 335
5195 1251 1414 5251 1505 4922 1499 2520 1510 1252 22 4531 1234 5 2952 1339 1323 1430
5355 1412 3519 1453 352 2505 1195 3504 3021 3420 2990 3512 553 4222 355 552
3 5944 2414 2324 1924 2002 2544 4112 1122 1304 2090 2550 530 241 2453 1545
10425 9352 1523 9414 1595 2259 1235 2452 2102 202 1023 2122 530- 531 1143 1543
3129 5592 1155 2549 5534 3530 1244 2559 522 1335 1331 551 2050 2323 2355 1322 2150 1332 2505 599
5594 5350 1929 1344 4132 3155 235 12 913 555 2594 25 3295 1595 1352 1255 955 559 1325 1355 592 1549 1225 1354
4315 5453 1254 2550 1359 553 1494 1455 2422 1559 1311 1592-2509 1599 2551 1553 1294 1441 2233 2115
2303 3295 1520 2302 2035 2339- 301 1343 999 1922 1354 1392 1520 1150 2141 592 3013 333 1222 1339 1444 3409 4214
3425 5552 2145 2905 439 2922 1012 1255 50 1249 55 2523 253- 354 1995-2320 3151 4123 1224
3055 433 2533 2554 1222 2503 51 2915 2152 1925 22 2524 955 2535 553 3292 390 2522 122 2552 1502 2252 255 3355 1551 2339 2252 1239 2422
2915- 2445 392 3232 1105 1113 2123 515 353 1292 250 1213 345 2 1550 1032 253 133 2202 2323 1111 2319-1212
3532 1439 1329- 2400 1535 2335 1524 1093

1593 2038 2122 1483 2925 2636 3795 1302 2624
2390 624 1092 1128 36
4883 1232 1090 2982 1260

1828 1425 1323 1105
1431 324 103? 2135

1748 325 2489 4283

2133 933 1312-2334 1245 2043 2015 1253 1094-1323 1251

4625 211?

 
    

1124 3476 2091 1661 1386 1262 1334 1699 3444
2183 338 2200 1469 1532 1392 453 1346 1115 2032 554 2689
1632 313 2432
1428 1356 2393

2229-2055 1422 3201 515 1120 224 1994 555
504 1422 340 1593 2434 545 2559 1220 2422 525 224 3252 2005 1533 2050 1413 3222 439
4452 1145 951 2205 1449 2023 1345 429 2493 3352 2295 3392 3524 429 503 1290 1314 559 1124 534 1905 2220 3524

1'

2100 1323 2092 1192 1325 1221 2302 120 2904 1513 2222 1343 4000 211 540
3053 303 513 545 1225 2212- 351 2535 1442

1429- 3023 1254 1390 2150 2359 1291-1499
3925 3120 1354 445 2535 2055 32 2520 1951 1243 295 3052
5312 951 302 2340 1249 1335 545 1955

4422 4252 1232

4632 54
1635 4165 2224 566 1605 359 1135 1613 2360 2310 2262 1954 3279
2019 4545 1193-1215 1 1055

298 1253 519 992 2988 946 2524 1835

1269
3282
2800 5266

 
 
 

2602 1941 4096

3845 1555 2312 2135 1281 1053
4153 3102 2451 2139 1132- 1154 933.2901 3521- 520 3031
2255 1909 2054 253 2153 2292 1552 1455 422 929 529 1215
5495 2915 4925 2554 2095 2320 2592 3105 2225 242 3025.3230 1222 2925

4996 1240 3941 2400 2624 1514 3654 2524 2211 2208 2134 4332-4123

2505 4422 422 3343 1022 3350 2521 1154 2554 1292 339 1923 2400 3540
1225 929 1201 1050 1505 -2035 1031 345 3505 1353 1452
5545 331 4935 3 1293 2030 220 2501 1392 2513 1559 2551 3194-

1019 1142 2555 213 2225-1023 2293 232 1330- 1201

4462 2193 2386 993 1153 2339 663 2581 216? 425 2930

3195 1401 1351
1923 2922-1351 2531 4294 2494

2534 430 1529 4022 3253 3330. 3242

     
 

54 1921 2150 321 250 489 168?

2038 2120 3015 1519 4931 4166 2612 330? 6521 805 6025

  

Fig. 2. The SOM trained with C.elegans 3’-UTR substrings. The yellow colored cells indicate the locations of C.elegans miRNA cluster neurons in the lattice.
The numbers display the amount of training sequences mapped to each neuron of the trained map. empty cells are neurons with no hits.

downstream from the end of the last exon of each C. briggsae gene included.
The initial C.briggsae miRNA target sites were obtained by collecting the
22 nt substrings whose most similar neuron in the SOM was a C.briggsae
miRNA cluster neuron.

Total free energy for miRNA binding: the total free energy was calculated
for each miRNAitarget site pair in the initial prediction set of the two worms.
First. a larger sequence containing the 22 nt target site and 70 nt upstream and
downstream from it was extracted from the 3’-UTR. This length of 70 nt was
chosen based on the fact that secondary structure base-pairing interaction
between nucleotides that are separated by >70 nt is unlikely (Kertesz et al.,
2007). If the ﬁrst nucleotide of the site was located closer than 70 nt from the
3’-UTR start. a part of the last exon was attached to get the 70 nt upstream.
If the last nucleotide of the site was closer than 70 nt from the 3’-UTR end.
the downstream part was truncated to this smaller size. To get the energy
needed to open the site area for miRNA binding. AGopen. we calculated
the free energy of the thermodynamic ensemble using RNAfold (Hofacker.
2003). ﬁrst for this 162 nt sequence as such. and then when the target site
in the middle of it was forced to be open. AGopen is the difference of these
energies. Next. we calculated the free energy of the thermodynamic ensemble
for the miRNAitarget site duplex with RNAcofold (Hofacker. 2003) and
obtained the total energy freed in miRNA binding to the site with equation
AAG = AGduplex + AGopen-

3 RESULTS

3.1 SOM trained with C.elegans 3’-UTR substrings

The SOM trained with 22 nt substrings of Celegans experimentally
veriﬁed 3’-UTRs is illustrated in Figure 2. Each short sequence in
the training data is assigned to one, most similar neuron in the
net. Sequences mapped to the same neuron are similar with each
other, and especially similar they are in the region of the last 8 nt

complementary to the miRNA 8mer seed area. In Figure 2, the
number of training sequences mapped to each neuron is shown, and
the yellow color indicates the locations of miRNA cluster neurons.
For Celegans, there are 160 cluster neurons in total, containing an
average of 2148 training data strings each.

In Figure 3, the miRNA names are attached to their clusters.
miRNAs that share the same 8mer seed sequence are always
clustered to the same neuron and their names are coupled together in
a single miRNA name ending with an ‘F’ representing ‘family’. To
save space, we used this abbreviation also in some cases where two
miRNAs with the same cluster share a 7mer seed. For example let-
7F stands for let-7, miR-241, miR-48, miR-795 and miR-84 sharing
the 8mer seed UGAGGUAG and also for miR-793 (UGAGGUAU)
and miR-794 (UGAGGUAA) which share a 7mer seed with the ﬁrst
ﬁve miRNAs. The abbreviations used in the Figure 3 are clariﬁed in
Supplementary Table S1. The seven let- 7F miRNAs and two other
miRNAs, miR-124 (UAAGGCAC) and miR-221 I (UCAGGUAG)
share the same, one and only cluster neuron of the SOM lattice.
Altogether, 211 of 233 miRNAs contain only one neuron in their
cluster and 117 neurons of these are clusters for only one miRNA.
Twenty-one miRNAs have two neurons in their clusters, while
the cluster for one miRNA star sequence, cel-lin-4* contains three
neurons. When there is more than one neuron in a miRNA cluster,
these neurons are adjacent in the map, except for mir—240 and
mir-63 * for which these neurons are more distant but still quite near
to each other. Note that only the upper right quarter of the SOM
is shown in Figure 3. For the whole network, see Supplementary
Figure S 1.

To visualize how the different miRNA 8mer seed complementary
sequences are distributed in the SOM lattice, we presented the

 

1 249

112 /3.IO'S[1211anprOJXO'SOIJBLUJOJIIIOIq”K1111] 01011 papeolumoq

9103 ‘ch JSanV uo ::

L.Heikkinen et al.

 

mlR-I 337 nil-155 MIR-El ' anZEu
min-is min-7e
miR 2203h‘
mlﬂ-ZHTF
""1453 manual:
NIH 1852b MIR IE? I'IIIR 253 lI'IIR 55'
_ nun-2221 . ,_
mIR-1829: mime” mm s;
min-265
IM'TF IR aa-
mil-124 MIR-1832 ER?“ g_
Nun-21H '
mlR 1521 MIR IEZl
mill-1330
mil-1333 ""“m
mi-zao' Ina-245 miR41' mil-550'
MIR 7&4
MIR-37'
.‘IIR mar . _
Hill-2205‘? MIR 12‘
MIR-24“
i - 4‘
m R 24 MIR-353'
mianzaL _
mm “325' '"'R “513 "1me mlR 22.12
MI“ bD‘ lI'IIR IQU

mun—Mr

“IF 2F mIR-J‘IF
I .

lin-liF
min-789

nil—243' min-11‘ min-Jar
a.
"" 25° miH-v
MIR-45 MIR-7707‘
"Ila-E? MIR-7M
will-1821 min-1322 mm 2”
ITIR 155 I'll“ 2215
man-259 Im-a-
II‘IN 25f
MIR—an- . _ "mun
MHZ: nun-1529.) Inn—I “mm mIn-zﬂtl
In!“
* Phil-771D
. . m. .mu
nun—2214 mlF-S? min-1517 mum. MIR-273 rum-2212
"NR-54F
_ min.:2oaa'
MIR mzsn MIR :3 “Himmler,”
min-242
NIH-45F
nun-3'32
MIR-7715
miR was rum-221:: mm 2m;
min-m5
mIR-JO MIR-236 min-SOr

Fig. 3. Caenorhabditis elegans miRNA cluster locations. The cluster of each miRNA is shown by the miRNA name. A name ending with ‘F’ indicates a
miRNA family, a couple of miRNAs with the same 8mer or 7mer seed with the same cluster neuron. Only the upper right quarter of the SOM is shown. The

entire network can be seen in Supplementary Figure S 1.

consensus sequences of the substrings mapped to each neuron,
including only the last 8nt (see Fig. 4 for the upper-right quarter
of the SOM and Supplementary Figure S2 for the entire SOM).
Consensus sequences that contain an abundance of nucleotide T
are located in the upper left corner of the net while sequences in
the opposite, right lower corner of the net are rich of Azs instead.
The clusters of about a third of all known C. elegans miRNAs are
located in the upper right quarter of the net. The consensus sequences
often contain an N in the ﬁrst and in the last place, for example
the consensus sequence of the let- 7F cluster is NTNCCTNN.
When there are fewer miRNAs attached to a neuron, the consensus
sequence often is more precise. For example, NTACAAAN for the
lsy-6 sole cluster neuron.

3.2 miRNA target prediction using mirSOM

All the 22 nt 3’-UTR substrings mapped to a miRNA cluster neuron
in the SOM were considered as the initial set of target sites for that
miRNA. The total free energy showing the accessibility of the site
for the miRNA binding was calculated for each site in the initial
prediction set. In order to optimize the predictions made by our
tool, its capability to correctly pick out the 20 experimentally veriﬁed

miRNA—target genes and discard the 13 well-characterized cel-lsy-6
false targets (for a list of genes see Supplementary Table S2) was
measured as the function of the total free energy cut-off used (Fig. 5).
The optimal threshold was —7.2kcal/mol, when 17 of 20 veriﬁed
true targets were found and 12 of l 3 false targets were rejected. Then,
for each miRNA in both nematode species, we left out those sites
in the initial prediction set whose total free energy value exceeded
this threshold. For the orthologous miRNAs, the conservation of
each miRNA—target gene relationship in C. elegans and C. briggsae
was studied: if also the ortholog gene 3’-UTR included a predicted
site for the miRNA located closer than 20 nt from the site in
the Celegans 3’-UTR, the miRNA—target gene relationship was
classiﬁed as conserved. As phylogenetic conservation is a very
strong indicator for a miRNA—target relationship, we restored to
the set of ﬁnal predictions target genes which included a perfect
7mer or 8mer seed match with too large total energy, but instead
a conserved predicted site in C.briggsae, thus resulting in the ﬁnal
set of mirSOM target predictions. The sensitivity and speciﬁcity
of mirSOM are 0.90 and 0.92, when calculated using the sets of
experimentally veriﬁed miRNA true and false target genes. It is
noteworthy that while the initial prediction set for all miRNAs with
the same cluster neuron were the same, this is not the case in the

 

1 250

112 /3.Io's[Bumo[pJOJXO'soiJBuiJOJuioiq//:duq uioii papeolumoq

91oz ‘Og isanV uo ::

mirSOM

 

mm - "mm

NANMANN NNNNZMN NNAACANN NWAACANN

    
  
 
  
 
 
  

NNCWCANN NTCACANN NTNiﬂCNNN N'I'NACNNN N'I'I'ACTNN

TTCML‘VNN

NTNACTNN NWTACTNN NNTASNNN

   
 
 
 
     
   
 
  
   

 

NTCCCﬂNN

   

NNCECTNN N NYMJI'N N NNTMCNN

NTNCCNNN NTCCCNNN NNCACINN NCEMITNN NIWCAENNN NNCMICNN NNCﬂSCNN NNCMGNNN NNCCGNNN NNCCGTTN

NCNCCNNN NCECCNNN NCCCCCCN NEECCCCN NCVEGMMN NNTCGilNN NNTDGATN

NTNCCNTN NYCCETNN

NTTCCINN

NNTCCINN NCNCCﬂNN NCCCCNNN NCCCCCNN NCY‘CMCNN NNTCRCJW WTI'CGMAN NI'ICGﬁNN NNWCGNKN

NnWCCNNN NMCEANN

NNTSCW'CN NMECNNN NAACCCNN Nnncmm NNﬂCﬂUN nuwcnan NTTCﬂTAN N'I'I'CAINN NNTERTNN NNTCRTTN NANCR‘ITI NMNGNTN NMTGNNN NNﬂ'lGTNN

N'I'I'SCNEN NN'IOCCCN NAYCECNN NANCMCNN-NNMnENN NMMIATIIN-N'I'I'CMNN NNTCATYN NNTCAT'I'I' NﬂnYA'I'IT NMTRTIN

NCNCMCAN-NNTCANM W'I'I'CGNAN NTICGTNN NNWCGTNN NNMGTNN NMEGNNN NMTGANN

NNMGANN NNAAGAAN NNNAIGMN NTKWGAAN I'I'I'I'GNIN WN'I'FGAAN WA'ITGANN NMTGNNN Nil'l'l'ISTNN

NNAASNNN NNMGNNN NNNAGMN NNGAIGMN NTGWGAAN ITKTGAAN [GAWN WNTTGATN WA‘I'I‘GNNN WATIGCNN

NNCMANN NTCACANN -NTWACNNN NTMCTNN NNMC'I'NN NNMGTNN NNNHGTNN NNGAGNNN— 'l'l'I'I'GATN 'I'I'I'I’GNTN

NNTAGNNN NNNAGNNN NNGAGNTN NNCAGNT‘N NTC‘I’GM'N NTNTGNTN NTN'I'GNTN

 
   
  
  
 
   
 
 
 
 
  
 
   
 
  

TNTI‘GCTN

NNCTGI'I'N NTCTG‘I'I'N NTGTG'I'I'N

NNCNGTTN NNCNGTIT NNNGGTTN NNS‘IGTNN

  

NNNGGW NNCKGMN

  
 

NNNCGNIN

 

N NRGGAAN NNATGMN NNnTGAAN

mum NNN

TTTSCCNN NTICCCCN NWTCCCCN MNCMVN NNNCMNN NNM’JIIGNN NNACATNN NNNEATNN NTWJMNN NI'ICAT‘IT NMBCJI‘ITI NMTA'I'I'T NMTnTTI' NimTATNN Muanm

 
 
 
   
 

TTTCCCIN TI'IECCYN 'I'I'I'CNCY’N

NTCCnRNN

NNECANNN NNCCATNN NNCCﬂTI'I' NTNCATTT NTNCATTI' NTATATIT -N.|UITATNN-

NNCCﬂTI'I' NNECA'ITI' NTCTA'ITI' NTNTATIT NTGTA'I'I'N NWGTATNN NMTAKNN NNATMENN

Fig. 4. The distribution of 8mer seed complementary sequences in the SOM. Yellow color indicates the clusters of Celegans miRNAs. Only the upper right

quarter of the SOM is shown. The entire network can be seen in Supplementary Figure S2.

 

0.2

0.1 -

 

n -1 -2 33 4i .5 .5 J -B -9 .10 .11 .12 -13 -14

sensitivity — speciﬁcity

Fig. 5. The sensitivity and speciﬁcity of the model as the function of the
total energy threshold used. The veriﬁed true (20 genes) and false (13 genes)
miRNAitarget relationships were used to optimize the output of the SOM
model. The optimal energy threshold is —7.2 kcal/mol. when 17 of 20 true
targets were accepted and 12 of 13 false targets rejected.

ﬁnal predictions. For example, if we consider miRNA let- 7, 56% of
its ﬁnal predicted targets are shared with the miRNAs with the same
seed and the same cluster neuron, and only 17% of its targets are
shared with all eight miRNAs with the same cluster neuron.

3.3 Comparison of mirSOM with other methods

We compared the miRSOM performance with seven other miRNA
target prediction tools available: NBmiRTar (Yousef et al. 2007);

PITA (Kertesz et al., 2007); rna22 (Miranda et al., 2006);
MicroCosm (Grifﬁths-Jones et al., 2008); TargetScanWorm (Ruby
et al., 2006); PicTar (Lall et al., 2006); and mirWIP (Hammell
et al., 2008). Of these, NBmiRTar uses supervised machine learning
by a naive Bayes classiﬁer applied to the output of miRanda
program (John et a1. 2004). NBmiRTar is a model generated from
sequence and miRNAszNA duplex information from validated
targets and artiﬁcially generated negative examples. Rna22 uses
short patterns extracted from mature miRNA sequences to ﬁnd
eligible places for miRNA targeting, and then pairs up these
islands with a miRNA. PITA ﬁrst identiﬁes the initial seeds for
each miRNA in the 3’-UTR, then calculates the site accessibility
and combines the sites for the same miRNA to get the total
interaction score. NBmiRTar, rna22 and PITA (version PITA All)
do not apply any cross-species sequence conservation ﬁlter to the
target predictions. MicroCosm (earlier known as miRBase Targets),
TargetScanWorm and PicTar are the three tools most commonly
used for miRNA target prediction in Celegans. While MicroCosm
searches for maximal local complementarity alignments between a
miRNA and a 3’-UTR and uses the conservation ﬁlter afterwards,
TargetScanWorm and PicTar predict conserved miRNA targets using
genome-wide alignments of the 3’/UTRs of Celegans, C. briggsae
and C. remanei. mirWIP is a recent tool based on contextual features
of miRNA binding sites enriched in a set of genes predicted by
immunoprecipitation to be targets of a set of conserved Celegans
miRNAs (Zhang et al., 2007). mirWIP differs from the other six
computational tools compared in that it is based on unique biological
experiments.

First, we compared the overlap of the miRNA target sites predicted
with these tools. NBmiRTar was excluded from this part of the

 

1251

112 /3.Io's[Bumo[pJOJXO'soiJBuiJOJuioiq//:duq uioii papeolumoq

91oz ‘Og isanV uo ::

L.Heikkinen et al.

 

A B

111irSUM ma

N

2 mirS OM

PITA M icansm

C

mirWIP mirSOM Ta rgetSca nWorm

2809

Pi c' 1 'ar

Fig. 6. The degree of overlap between the predictions of mirSOM compared with six other miRNA target prediction tools. The number of mirSOM predictions
included in each comparison depends on the scope. (A) All mirSOM predictions compared with rna22 and PITA. (B) mirSOM predictions for orthologous
miRNAs compared with mirWIP and MicroCosm and (C) mirSOM conserved predictions compared with TargetScanWorm and PicTar.

comparison, because there is no bulk download available for its
prediction data. As mirSOM has also the conserved site prediction
aspect, we made these comparisons separately for tools that do
not require conservation and for tools with a conservation ﬁlter.
The Venn diagram in Figure 6a shows the number of predicted sites
common to mirSOM, PITA and rna22. In comparison to the number
of predictions made in all, the size of target gene set predicted with all
the three tools is small. Approximately 28% of mirSOM predictions
are common with PITA, but PITA also contains the largest number
of predictions in all. The low number of common predictions with
rna22 may be due to the small number of predictions downloadable
for rna22 which contains sites from <3000 genes.

When we compared mirSOM with tools utilizing a conservation
ﬁlter, only the mirSOM predictions for the orthologous miRNAs
were taken into calculations. The number and intersections of
miRNA—target gene interactions predicted by mirSOM, mirWIP and
MicroCosm are shown in the Venn diagram in Figure 6b. About 30%
of mirSOM predictions are common with mirWIP and ~50% of the
mirSOM predictions are found with either of the tools. The results
of a similar comparison made between mirSOM, TargetScanWorm
and PicTar are shown in Figure 6c. As TargetScanWorm and PicTar
search for conserved targets, only the 10070 conserved miRNA—
target gene pairs contained in mirSOM predictions were taken along.
Forty percent of these mirSOM predictions are shared with either
PicTar or TargetScanWorm, and about one-third of the mirSOM
predictions are common to all of the three tools, thus underlining
the ability of them all to ﬁnd the perfect seed matching, conserved
miRNA target sites. Altogether, ~35% of the miRNA—target gene
interactions predicted by mirSOM are included in the prediction set
of at least one of the six other tools. Among the predictions made
only with mirSOM are the predicted targets for 57 star miRNAs and
23 miRNAs that are not included in any of the other tools. Also
the gene sets and 3’-UTR sequences incorporated in these tools are
unequal, which has an impact to the comparison results.

Secondly, we tested the ability of these tools to ﬁnd the
experimentally veriﬁed C. elegans miRNA—target genes and to reject
the lsy-6 false target genes (Supplementary Table S2). For seven of
the 33 genes studied, there was no veriﬁed 3’-UTR available; so
for them we extracted the 1000 nt sequence downstream from the
last exon to act as the predicted 3’-UTR. mirSOM found 18 of 20
true target genes in the list (Table 1). The two veriﬁed targets not

Table 1. The experimentally veriﬁed Celegans miRNAitarget genes found
by mirSOM. NBmiRTar. PITA. rna22. MicroCosm. TargetScan. PicTar and
mirWIP

 

miRNA Gene mir NBmiR PITA ma22 Micro Target PicTar mirWIP
name Som Tar Cosm Scan

 

 

let-7 C35E7.4 X X X — — — — —
let- 7 ceh-16 * X X — — — — — X
let-7 daf-IZ X X X X X X X X
let-7 die-I X X X — X — — —
let-7 hbl-I X X X X X X X X
let-7 let-60 — X — — — — — X
let-7 [in-41 — — — X — — X X
let-7 let-526 X X X — — — — —
let-7 nhr-23 X — — — — X
let-7 nhr-25 X X X — — — — X
let-7 nhr-4 X X X — — X X —
let-7 pha-4 X — — — — — — X
let-7 T14Bl.1 X X X X X X X X
let-7 uba-I X X X — — — — X
let-7 mic-129 X X X — X X X X
[in-4 [in-I4 * X X — — — X X X
[in-4 [in-28 X X X — X X X X
lsy-6 cog-I X — X — X X X X
mir-273 die-I X X X — — — — —
mir-61 vav-I X X X — — X X X
18 16 14 4 7 9 10 15
‘X’ = the gene is included; ‘-’ = the gene is not included in the predictions. Asterisks (*)

next to gene name refers to targets which did not have a veriﬁed 3’-UTR in WSZl3,
and the 1000 nt downstream sequence was used instead to test the mirSOM method.

found are let-7 target genes let-60 and [in-41. Interestingly, let-60
and [in-41 have a couple of sites in neurons adjacent to let-7 cluster.
Of these, the let-60 sites in positions 479—500 and 128—149 in its 3’-
UTR have also acceptable total free energy values, — 13.9 kcal/mol
and —9.1 kcal/mol, respectively. Thus, if we would include also the
adjacent neurons to let-7 cluster, mirSOM would correctly predict
all but one of the true targets. However, even with the 18 true targets
found, mirSOM outperforms all the other methods. Of the 13 well-
characterized lsy-6 false targets mirSOM rejects 12, together with
rna22. NBmiRTar is the only tool that rejects all the false targets,
when used with the default values of its parameters. The number of

 

1 252

112 /3.Io's[Bumo[pJOJXO'soiwuiJOJuioiqﬂ:duq uioii papeolumoq

91oz ‘Og isanV uo ::

mirSOM

 

Table 2. Veriﬁed Celegans lsy-6 non-target genes found by mirSOM.
NBmiRTar. PITA. rna22. MicroCosm. TargetScan. PicTar and mirWIP

 

miRNA Gene mir NBmiR PITA rna22 Micro Target PicTar mirWIP

name Som Tar Cosm Scan

 

 

lsy-6 C27H6.3 — — — — X X X —
lsy-6 ptp-I — — X — — — —
lsy-6 ﬂch-8 — — X — X X X X
lsy-6 nsy-I — — X — — — — —
lsy-6 gel-5 — — X — — X X —
lsy-6 aex-4 — — X — — X X —
lsy-6 T20G5.9 — — — — — X X —
lsy-6 glb-I — — — — X X —
lsy-6 hlh-8 * — — — — — X X —
lsy-6 F55G1.12* — — — — — X X —
lsy-6 T04C9.2* X — — — — X X
lsy-6 T05C12.8* — — — — — X X —
lsy-6 T23E1.1* — — — — — X —
5 3 10 1 1 2
‘X’ =the gene is included; ‘-’ =the gene is not included in the predictions. Asterisks (*)

next to gene name refers to targets which did not have a veriﬁed 3’-UTR in WSZl3,
and the 1000 nt downstream sequence was used instead to test the mirSOM method.

rejections made by the other ﬁve tools is between 3 and 11 (Table 2).
For mirWIP and PITA, the largest set of predictions available is used
in the comparison, which has an effect to the number of false target
predictions.

4 DISCUSSION

We have here introduced a new machine learning-based method,
mirSOM, for miRNA target ﬁnding. Our method is founded on
the basic knowledge about miRNA target sites: these sites have
imperfect complementarity with the miRNA sequence, where the
most crucial part is the miRNA seed, these sites are preferentially
located in the 3’-UTR of the transcript and they are accessible
to miRNA binding. This means that a chunk of short substrings
of the 3’-UTRs are miRNA target sites. We sought these sites by
clustering short 3’-UTR substrings with the SOM. The training
data consisted of all possible 22-nt long substrings extracted from
veriﬁed C.elegans 3’-UTRs, and the trained SOM contains, besides
the information about the target sites of miRNAs known today,
also a view of the mutual similarity of miRNA sequences. The
fact that 90% of the miRNA clusters reside in a single neuron of
the lattice implies that the SOM is well organized, and it is quite
probable that also the clusters for miRNAs yet to be found from
C.elegans are located in one or two nearby neurons of the map.
Once trained, the SOM can be applied, not only to ﬁnd putative
targets for new C. elegans miRNAs, but also to ﬁnd the targets for
the orthologous miRNAs in other worms thus enabling the study
of target conservation. As mirSOM uses only the ﬁltering by site
accessibility to post-process the initial target sites obtained from the
SOM, it opens up a simpliﬁcation to the miRNA target prediction,
but still works well in ﬁnding the veriﬁed miRNA target sites, while
keeping the number of predictions moderate.

A common problem in miRNA target ﬁnding is the small number
of experimentally veriﬁed miRNA—target genes, which has hindered
efforts to develop machine learning methods for target prediction
tasks. In particular, this makes it hard to build a supervised model

whose performance is highly dependent on the quantity and quality
of the positive and negative training datasets used. The unsupervised
learning algorithm used by mirSOM clusters the putative target sites
for each miRNA objectively, using no knowledge about the veriﬁed
true and false targets until the optimal total free energy threshold for
the site accessibility is deﬁned. When compared with meiRTar, a
method using supervised machine learning, mirSOM ﬁnds 18 of the
20 experimentally veriﬁed targets while NBmiRTar predicts 16 of
20. These are the two best results in the comparison (Tables 1 and 2).
Since both of these tools are also very speciﬁc in their predictions,
it suggests that miRNA target prediction truly can be improved by
the use of machine learning methods.

The standard SOM algorithm has some limitations, like the
non-adaptable ﬁxed architecture, which is relative to the expected
number and structure of the clusters. Instead of using an algorithm
that would adaptively determine the number of clusters (Mavroudi
et al., 2002; Hsu et al., 2003), we searched experimentally for
such size and weighting schema for the standard SOM that would
work best in this particular problem. As the solution does not
necessarily need a more sophisticated architecture, we decided to
keep the original SOM algorithm which is well known and easy to
understand.

mirSOM ﬁnds well those veriﬁed miRNA targets which include
a perfect 7mer or 8mer seed match, and also most of those target
genes with a shorter or otherwise imperfect miRNA seed match. It
also successﬁilly rejects the sites from known false target genes with
a perfect seed match by using the total energy ﬁlter to the initial
prediction set. The energy threshold used, which relies on just a
few veriﬁed miRNA—target gene interactions presently available,
should be adjusted as more miRNA—target genes in C.elegans are
veriﬁed. Also, the SOM used in the initial target site ﬁnding step
is trained with veriﬁed 3’-UTR data, so it may be not suitable
for ﬁnding miRNA target sites from other sequence data, for
example from 5’-UTRs and the coding region. This is because the
sequence characteristics, like nucleotide composition and functional
elements, of these regions of mRNA differ from the 3’-UTRs, and
the clustering result using these sequences would likely be different.
We demonstrate here that mirSOM can identify targets in nematodes
and it should be possible to construct SOMs for other species. Future
studies will be aimed at verifying targets in more complex organisms
such as human and mice.

ACKNOWLEDGEMENTS

Jussi Paananen, Mitja Kurki and Petri Toronen are acknowledged
for technical assistance, comments and discussion.

Funding: Saastamoinen Foundation; Finnish Cultural Foundation,
North Savo Regional fund; Finnish Cultural Foundation; Doctoral
Program in Molecular Medicine at the University of Eastern Finland.

Conﬂict oflnterest: none declared.

REFERENCES

Bartel,D.P. (2009) MicroRNAs: target recognition and regulatory functions. Cell, 136,
2157233.

Brennecke,J. et at. (2005) Principles of microRNA-target recognition. PL0S Biol., 3,
e85.

Didiano,D. and Hobert,O. (2006) Perfect seed pairing is not a generally reliable predictor
for miRNA-target interactions. Nat. Struct. Mol. Biol., 13, 8497851.

 

1 253

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq uroii papeolumoq

91oz ‘Og isanV uo ::

LHbmkMenetaL

 

Didiano,D. and Hobert,O. (2008) Molecular architecture of a miRNA-regulated 3’UTR.
RNA, 14, 129771317.

Enright,A.J. et al. (2003) microRNA targets in Drosopliild. Genome Biol, 5, R1.

Grifﬁths-Jones,S. et al. (2008) miRBase: tools for microRNA genomics. Nucleic Acids
Res., 36, D1547D158.

Grimson,A. et al. (2007) MicroRNA targeting speciﬁcity in mammals: determinants
beyond seed pairing. Mol. Cell, 27, 917105.

Hammell,M. et al. (2008) mirWIP: microRNA target prediction based on microRNA-
containing ribonucleoprotein-enriched transcripts. Nat. Methods, 5, 8137819.
Harris,T. et al. (2010) WormBase: a comprehensive resource for nematode research.

Nucleic Acids Res, 38, D4637D467.

Hofacker,l. (2003) Vienna RNA secondary structure server. Nucleic Acids Res, 31,
342973431.

Hsu,A. et al. (2003) An unsupervised hierarchical dynamic self-organizing approach
to cancer class discovery and marker gene identiﬁcation in microarray data.
Bioinformdtics, 19, 213172140.

John,B. et al. (2004) Human microRNA targets. PLoS Biol, 2, e363.

Kanaya,S. et al. (2001) Analysis of codon usage diversity of bacterial genes with a
self-organizing map (SOM): characterization of horizontally transferred genes with
emphasis on the E. coli 0157 genome. Gene, 276, 89799.

Kertesz,M. et al. (2007) The role of site accessibility in microRNA target recognition.
Nat. Genet., 39, 127871284.

Kim,S.K. et al. (2006) miTarget: microRNA target gene prediction using a support
vector machine. BMC Bioinformdtics, 7, 411.

Kloosterman,W.P. and Plasterk,R.H. (2006) The diverse functions of microRNAs in
animal development and disease. Dev. Cell, 11, 441450.

Kohonen,T. (1995) Self-Organizing Maps. Springer, Berlin.

Kohonen,T. and Somervuo,P. (2002) How to make large self-organizing maps for
nonvectorial data. Neural Netw., 15, 9457952.

Krek,A. et al. (2005) Combinatorial microRNA target predictions. Nat. Genet., 37,
4957500.

Lall,S. et al. (2006) A genome-wide map of conserved microRNA targets in C.elegdns.
Curr Biol, 16, 460471.

Lee,R.C. et al. (1993) The C. elegans heterochronic gene lin-4 encodes small RNAs
with antisense complementarity to [in-14. Cell, 75, 8437854.

Lewis,B.P. et al. (2003) Prediction of mammalian microRNA targets. Cell, 115,
7877798.

Mahony,S. et al. (2004) Gene prediction using the self-organizing map: automatic
generation of multiple gene models. BM C Bioinformdtics, 5, 23.

Mahony,S. et al. (2005) Transcription factor binding site identiﬁcation using the self-
organizing map. Bioinformdtics, 21, 180771814.

Mavroudi,S. et al. (2002) Gene expression analysis with a dynamically
extended self-organized map that exploits class information. Bioinformdtics, 18,
144G1453.

Miranda,K.C. et al. (2006) A pattern-based method for the identiﬁcation of
microRNA binding sites and their corresponding heteroduplexes. Cell, 126,
120371217.

Papadopoulos,G et al. (2009) The database of experimentally supported targets: a
functional update of TarBase. Nucleic Acids Res., 37, D1557D158.

Ruby,J.G. et al. (2006) Large-scale sequencing reveals 21U-RNAs and additional
microRNAs and endogenous siRNAs in Caenorhabditis elegans. Cell, 127,
119371207.

Saetrom,P. et al. (2007) Distance constraints between microRNA target sites dictate
efﬁcacy and cooperativity. Nucleic Acids Res., 35, 233372342.

Toronen,P. et al. (1999) Analysis of gene expression data using self-organizing maps.
FEBS Lett., 451, 1427146.

Vella,M. et al. (2004) The C. elegans microRNA let-7 binds to imperfect let-7
complementary sites from the [in-41 3’UTR. Genes Dev., 18, 1327137.

Wang,X. and El Naqa,I. (2008) Prediction of both conserved and nonconserved
microRNA targets in animals. Bioinformdtics, 24, 3257332.

Yousef,M. et al. (2007) Naive Bayes for microRNA target predictionsimachine learning
for microRNA targets. Bioinformdtics, 23, 298772992.

Zhang,L. et al. (2007) Systematic identiﬁcation of C. elegans miRISC proteins,
miRNAs, and mRNA targets by their interactions with GW182 proteins AIN-l
and AIN-Z. Mol Cell, 28, 5987613.

 

1 254

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq uroii papeolumoq

91oz ‘Og isanV uo ::

