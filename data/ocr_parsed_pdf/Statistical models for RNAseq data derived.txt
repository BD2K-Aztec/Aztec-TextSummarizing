Bioinformatics, 31 (22), 2015, 3625—3630

doi: 10.1093/bioinformatics/btv425

Advance Access Publication Date: 23 July 2015
Original Paper

 

 

Gene expression

Statistical models for RNA-seq data derived
from a two-condition 48-replicate experiment

Marek Gierlinski1'2'f, Christian Cole”, Pieta Schofield1'2'f,
Nicholas J. Schurch”, Alexander Sherstnev1, Vijender Singhz,
Nicola Wrobel3, Karim Gharbi3'4, Gordon Simpson‘r’,

Tom Owen-Hughesz, Mark Blaxter3'4 and Geoffrey J. Barton1'2'6'*

1Division of Computational Biology and 2Centre for Gene Regulation and Expression, College of Life Sciences,
University of Dundee, Dow Street Dundee, DD1 5EH, UK, 3Edinburgh Genomics and 4Institute of Evolutionary
Biology, Ashworth Laboratories, University of Edinburgh, Edinburgh, UK, 5Division of Plant Sciences and
6Biological Chemistry and Drug Discovery, College of Life Sciences, University of Dundee, Dow Street Dundee,
DD1 5EH, UK

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first four authors should be regarded as Joint First Authors.
Associate Editor: Ziv Bar-Joseph

Received on May 1, 2015; revised on July 8, 2015; accepted on July 19, 2015

Abstract

Motivation: High—throughput RNA sequencing (RNA—seq) is now the standard method to determine
differential gene expression. Identifying differentially expressed genes crucially depends on estimates
of read—count variability. These estimates are typically based on statistical models such as the negative
binomial distribution, which is employed by the tools edgeR, DESeq and cuffdiff. Until now, the validity
of these models has usually been tested on either low—replicate RNA—seq data or simulations.

Results: A 48—replicate RNA—seq experiment in yeast was performed and data tested against theor—
etical models. The observed gene read counts were consistent with both log—normal and negative
binomial distributions, while the mean—variance relation followed the line of constant dispersion
parameter of ~0.01. The high—replicate data also allowed for strict quality control and screening of
'bad’ replicates, which can drastically affect the gene read—count distribution.

Availability and implementation: RNA—seq data have been submitted to ENA archive with project
ID PRJ E85348.

Contact: g.j.barton@dundee.ac.uk

 

1 IntrOducuon variability, which introduces a level of uncertainty that has to be

High—throughput sequencing of RNA (RNA—seq, Nagalakshmi
et (11., 2010) estimates gene expression by counting the number of

taken into account when the expression values from two or more
conditions are compared. There are two major obstacles to identify—

112 /310'srcu1n0[p103x0"sotJBurJOJutotq/ﬁduq 11101} pQPBOIHAAOG

9103 ‘Og anﬁnv 110 ::

sequenced RNA fragments that map back to a given gene within a
reference genome or transcriptome (Mortazavi et (11., 2008).
Differential gene expression (DGE) experiments compare this rela—
tive measure of transcriptional activity across several biologically
interesting conditions to attempt to identify those genes that are fun—
damental to the difference between the conditions. This task is com—
plicated by expression noise resulting from biological and technical

©The Author 2015. Published by Oxford University Press.

ing whether the observed difference in the expression of a gene be—
tween the two conditions is statistically significant, or whether it is
consistent with arising through chance. First, the observed read
counts are a product of both the library size (total number of reads)
and the fractional expression of the gene. The gene expression values
thus need to be appropriately normalized before they can be mean—
ingfully compared across conditions. Second, due to cost, time and

3625

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.U/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

3626

M. Gierliriski et aI.

 

workload constraints RNA—seq experiments typically consist of only
a few replicates, making DGE genes particularly difficult to identify
due to a lack of statistical power in the experiment (Hansen et (11.,
2011). These obstacles have motivated the development of numer—
ous algorithms and computational tools to calculate DGE, each
with their own underlying assumptions and their own approaches to
data normalization and DGE detection. In particular, these tools
commonly make assumptions about the form of the underlying
read—count distribution.

If sequenced RNA—seq reads originate randomly from the tran—
scripts of expressed genes in a sample, the resulting read—count dis—
tribution would be multinomial, with parameters representing the
proportions of reads mapping to individual genes. The observed
read counts for an individual gene are then represented by a bino—
mial random variable which, for a large total number of reads with
only a small fraction of reads mapping to each gene, can be well
approximated by a Poisson distribution. A key property of the
Poisson distribution is that the variance is equal to the mean.

Although they have limited statistical power due to low numbers
of replicates (Marioni et (11., 2008, Robinson and Smyth, 2008,
Rapaport et (11., 2013), previous studies have shown that RNA—seq
read—count data shows significant excess variance above that ex—
pected based on the Poisson model. The excess variance observed in
the data originates from biological processes, sample preparation,
the sequencing protocol and/or the sequencing process itself. A nat—
ural over—dispersed alternative to the Poisson model is a negative bi—
nomial distribution, in which the variance is always greater than or
equal to the mean.

The underlying read—count distribution for a gene is a fundamen—
tal property of RNA—seq data but without a large number of meas—
urements it is not possible to identify the form of this distribution
unambiguously. The limited number of replicates considered in pre—
vious studies means the true distribution of read counts for an indi—
vidual gene is still unclear. Many DGE tools make assumptions
about the form of this underlying distribution, including Poisson,
negative—binomial and log—normal, which may impact on their abil—
ity to correctly identify significantly DE genes. In this study, the
form of the underlying read—count distribution is measured directly
with a high—replicate, carefully controlled, RNA—seq experiment de—
signed specifically for the purpose of testing the assumptions intrin—
sic to RNA—seq data. For the first time, these data allow various
statistical models of read—count distribution to be tested directly
against real RNA—seq data.

2 Methods

2.1 Experiment design and data workflow

A controlled, 48 biological replicate, RNA—seq experiment in the
model organism Saccharomyces cerevisiae was performed for wild
type (WT) and a san knock—out mutant cell line (Asan). Brieﬂy, the
extracted total RNA from each of the 96 replicates was enriched for
polyadenylated RNA, quality checked, and had an appropriate
amount of artificial External RNA Controls Consortium (ERCC)
spike—in transcripts added (Jiang et (11., 2011, Loven et (11., 2012) be—
fore undergoing the standard Illumina multiplexed TruSeq library
preparation. The libraries were pooled and sequenced on seven lanes
of a single ﬂow—cell on an Illumina HiSeq 2000 using a balanced
block design (Auer and Doerge, 2010), resulting in a total of ~1 bil—
lion 50—bp single—end reads across the 96 samples. These reads were
aligned to the Ensembl v68 (Flicek et (11., 2011) release of the S. cere-
visiae genome (modified to include the ERCC transcript sequences)
with TopHatZ (v2.0.5, Kim et (11., 2013) The aligned reads were

then aggregated with htseq-comzt (v0.5.3p9, Anders et (11., 2014)
using the Ensembl v6 8 S. cerevisiae genome annotation to give total
gene read counts for 7126 gene features. A full description of the ex—
periment is provided in Schurch et al. (2015).

2.2 Notation

The following notation is used from this point on: n, : 48 is the
total number of replicates in each condition, 71) : 7 is the total num—
ber of lanes on the ﬂowcell. The subscript g denotes an individual
annotated gene, 1' and / identify individual biological replicates
within a given experimental condition, (i,/' : 1, . . . , m) and l is an
individual lane on the ﬂow cell (1 : 1,  , m). xgil denotes the
number of read counts in gene g, replicate i and lane 1 and the read
count for each biological replicate summed over all lanes is given by
xg, : 1xgil. Condition indices are skipped for clarity and the
condition, for which the calculations are performed for, is specified
in the text.

2.3 Normalization

RNA—seq experiments do not measure absolute gene expression; in—
stead the number of sequenced reads mapped to a gene is propor—
tional to its expression level, the sequencing depth and (in the case
of short read sequencing) the length of the gene. Normalizing the
data to compensate for these factors is a critical step in analysing
RNA—seq expression data and it is essential that the normalization
chosen is appropriate to the biological question being addressed.
The simplest normalization scales the raw counts to the total num—
ber of sequenced reads in the replicate (total count normalization),
however, this is unlikely to be appropriate for a DGE experiment
where one might reasonably anticipate that a small number of highly
expressed genes are likely to change their expression level dramatic—
ally while the expression of the majority remains unchanged.
Applying the total count normalization may result in many genes
being identified as differentially expressed between conditions when
they are, in fact, unchanged. Anders and Huber (2010) described a
normalization strategy to address this based on the median expres—
sion across all genes, making it insensitive to highly expressed out—
liers. Other methods to tackle this problem are the trimmed mean of
M—values (Robinson and Oshlack, 2010) and quantile normalization
(Smyth, 2004). See Dillies et al. (2013) for a detailed review of these
relevant normalization methods.

These normalization approaches all result in counts that are no
longer integer and this can lead to unpredictable results when testing
them against discrete probability distributions (e.g. Poisson and
negative binomial models). Accordingly, an alternative approach to
normalization was applied, that while not suitable for DGE, is more
appropriate for testing the underlying distribution of RNA—seq read
counts for a gene. When examining the distribution of gene read
counts across the biological replicates within a condition, the repli—
cate with the smallest total read count was selected and then the
other replicates were randomly sub—sampled to the same total read
count. The same approach was applied to read counts across ﬂow
cell lanes within each biological replicate. The equal—count data are
then mapped to the reference genome obtaining normalized, but dis—
crete, mapped read counts.

The obvious disadvantage of this method is the loss of reads
(~16 and 35% for lane and biological replicate data, respectively)
and sensitivity. This approach is essentially a total count normaliza—
tion that preserves the discrete nature of the data and so is unlikely
to be any more appropriate for DGE analysis than standard total
count normalization. However, under the null hypothesis, the

112 /310'srcu1n0[p103x0"sotJBurJOJutotq/ﬁduq 11101} pQPBOIHAAOG

9103 ‘Og anﬁnv 110 ::

Statistical models for RNA—seq data

 

 

WT 1'15an

8 m

c"I
5‘ E

93 o _

E m a E
a ‘ t
a a a 8

E

3 0'

Cl

“2'

1o 20 so an 10 20 30 40 ‘3

Replicate Replicate

Fig. 1. Pearson's correlation coefficient between biological replicates in condi-
tion WT (left) and Asan (right). Dark bands show ‘bad' replicates that poorly
correlate with others

down—sampled replicates within a condition are realizations of inde—
pendent and identically distributed random variables, so it allows
goodness—of—fits tests to be performed on raw gene counts with no
need for any additional normalization. All the tests in this work are
done within one biological condition (or one biological replicate, for
lane data) and no DGE analysis is undertaken. The loss of reads is
not a concern for this work, which aims at studying distribution
over a wide range of read counts. The mean read count per gene ex—
tends from N 0.1 to ~ 105 in normalized data.

2.4 Quality control: identifying 'bad’ replicates
Occasionally errors occur in an experimental protocol and a sample
generates improper or ‘bad’ data. In this experiment, the availability
of 48 replicates allowed three different criteria to be applied indi—
vidually and in combination to identify potential ‘bad’ replicates in
addition to standard quality checks by FastQC.

2.4.1 Replicate correlation

The differences between each pair of replicates, i and j, is quantified
by Pearson’s correlation coefficient, 17,-, calculated across all genes
with a non—zero count in at least one replicate (Fig. 1). The repli—
cate’s similarity to other replicates is captured by its median correl—
ation, F,- : medianhr, n,- (Fig. 2a).

2.4.2 Outlier fraction

The poor correlations shown by some replicates are the result of a
small proportion of genes with atypical read counts. These outliers
can be identified by comparing each gene’s expression in an individ—
ual replicate with the trimmed mean across all replicates.
Specifically, the 71, largest and smallest values are trimmed from the
set of replicates for a gene before calculating the mean (EM) and
standard deviation (5173“). Genes are then identified as outliers if
lxg, —Egm,l > nssgm” where n, is a constant. Figure 2b shows the
fraction  of all genes identified as outliers for each replicate i, for n,
: 3 and n5 : 5. As expected, the anomalous replicates with high
outlier fraction in Figure 2b correspond well with the poorly corre—
lating replicates in Figure 2a. Increasing 71, and/or decreasing n5 en—
hances the outlier fraction in replicates already identified as
anomalous; for example, reducing the standard deviation limit to n,
: 3 boosts the outlier fraction in these replicates by a factor ~2—3.

2.4.3 Gene read depth profiles

The atypical total read counts of outlier genes are, in our case, the
result of an atypical, strongly non—uniform, read depth gene profile.
An example of the difference of the read depth profiles between
clean and ‘bad’ replicates is shown in Figure 3 for the gene

 

 

 

 

 

 

3627
5 WT asnfz
'50
55 F;-_...-..---..--.--_--. .. .. ._.,..._......_,.... -..... m... ..........._......... .............
gqjlal 2'2 3 35 2“ 35
8:; 232's
Edi _ 13
Ba: 21 _
Ed‘- ' 5
I 6
g 3'} lb) - 1.3
g  2_1 _
Ii 3": 2.523 '
g 3% ' 5.3, -
005 I '25. ..  I T I 25 I 3.5 I
3"”: It) 6
J: _
no: _
N.
E : 21 2528 1.3 2?
33'. 33‘ - 31135 - __  _,3_. 
a' . . . . . . . .
s i.
of {d} 2.1 25 - ' 1.3
gr”: . 2_8 _
8'.“ 2.2 3935 25 3_5
m_ _ . . , ﬂ _ _ '. I
Vina-’9‘: ..'_. _-T u a‘ .I'“ _ '.:- an. _..,_ -.,I._ "Io..:l'- .__,I'_.. _..I_-__._...
10 20 30 40 10 20 30 40
Replicate Replicate

Fig. 2. Identifying bad RNA-seq replicates in the WT (left) and Asan (right)
data. The top three panels (a—c) show individual criteria for identifying ‘bad'
replicates which are combined into a quality score (d) in order to identify
‘bad' replicates in each condition. The identified ‘bad' replicates are shown as
numbered points in each panel. The individual criteria are (a) median correl-
ation coefficient, 7;, for each replicate i against all other replicates, (b) outlier
fraction, f,-, calculated as a fraction of genes where the given replicate is more
than five-trimmed standard deviations from the trimmed mean and (0) me-
dian reduced 12 of pileup depth,  as a measure of the non-uniformity of
read distribution within genes (see also Fig. 3)

 

Read count

100 200 300
M
I-'

D

 

552000 552 500 553000 553500

Position along chromosome VIII
41 phoﬂ >—

Fig.3. Read depth profiles of YHR215W (PH012). The black line indicates the
mean read counts from all ‘clean' WT replicates for a given genomic position
in the gene YHR215W (the set of ‘clean' replicates is defined in Section 3.1).
The grey lines show the mean read depth plus/minus one standard deviation.

 

The red line illustrates the read depth profile from a single example ‘bad' rep-
licate (WT replicate 21). The block diagram at the bottom shows the simple
gene structure of YHR215W

YHR215W. The distribution of reads from the example ‘bad’ repli—
cate (WT replicate 21, red line) is much less uniform than the mean
read depth from the other ‘clean’ replicates (black line) with distinct
peaks in the distributions that are 50—bp long. These suspicious fea—
tures are found universally in all outlier genes in ‘bad’ replicates and
can be also seen in some (but not all) non—outlier genes in these repli—
cates. It is likely that the cause of this atypical read distribution is
uneven priming during the polymerase chain reaction (PCR) amplifi—
cation step of the library preparation, prior to the sequencing. The
level of gene non—uniformity in each replicate can be quantified with
a reduced  statistic for each gene in each replicate, defined as

I» _
1 23‘ (Cgip ‘Cgi)2
lg — 1

 

7 (1)

.2 7
Agi _ 7 I
p:1 68‘

where am represents read—count depth at base pair 17 within the
gene g in replicate 1', 1g is the length of gene g and Q,- : izpcgip.

112 /310's1cu1nofp1o1xo"sotwurJOJutotq/ﬁduq 11101} popco1umoq

9103 ‘0g anﬁnv uo ::

3628

M. Gierliriski et aI.

 

When reads are randomly and uniformly distributed along the gene,
x;- N 1 is expected, but strongly non—uniform distributions give
x;- > 1. The median )8 statistic calculated over all genes,  gives a
quantitative measure of the non—uniformity of a replicate and en—
ables replicates to be compared on this basis within the same condi—
tion (Fig. 2c).

2.4.4 Defining quality score

Interestingly, while there is similarity between the replicates identi—
fied as ‘bad’ from the gene expression—based quality measures (repli—
cate correlation and outlier fraction, shown in Fig. 2, panels a and
b) and those identified by examining the gene read depth profiles
(Fig. 2c), there is no strict one—to—one correspondence between these
three strongly related measures. Combining these metrics results in a
simple replicate quality score that amplifies the distinctions between
replicates considerably simplifying the identification of ‘bad’ repli—
cates. The score for each replicate is defined as:

5,:A log(1 —7,-)+B logfi+Clog(%f—1), (2)

where 7,- is the median Pearson’s correlation coefficient between the
gene expression in replicate i and the gene expression in all other repli—
cates,  is the fraction of genes identified as outliers in replicate i, and
Z- is the median reduced )8 statistic for the gene read depth profiles in
replicate i. For simplicity, the arbitrary weights of A : B : C : 1 are
set here, though other prescriptions are possible. This quality score is
shown in Figure 2d for replicates of both conditions. Based on this
score six WT replicates, and four Asan replicates, are identified as
‘bad’ (21, 22, 25, 28, 34, 36 and 6, 13, 25, 35, respectively). They
were subsequently removed from the downstream analysis unless
otherwise stated. In the following discussion, the remaining replicates
are referred to as ‘clean replicates’. This is an arbitrary and rather con—
servative selection. For example, one doesn’t expect Asan replicate
25 to make a huge impact. However, the most anomalous replicates
in this selection affect the measured read—count distribution dramatic—
ally (Section 3).

3 Results

3.1 Inter—Iane variance

The sample libraries were sequenced in seven of the eight lanes on
an Illumina HiSeq2000, to give seven sequencing (technical) repli—
cates for each biological replicate. This allowed the inter—lane var—
iance in the sequencing protocol to be examined. The RNA
fragments from each sample were expected to be distributed uni—
formly and randomly across the ﬂow cell lanes, which would result
in a Poisson distribution of sequenced read counts across lanes (see
Marioni et (11., 2008 for a similar experiment). Any additional vari—
ability will result in a broader distribution.

Under the null hypothesis the read counts across lanes (for a
given gene and biological replicate) are realizations of independent
random variables that follow a Poisson law with the same mean (i.e.
ugﬂ :  : ugim). The appropriate statistic for the overdispersion
test (Fisher, 1950) is  distributed. Applying this test to each gene
in each replicate (all replicates were used for this test) with non—zero
read counts in at least one lane resulted in a total of 630 850 tests,
only two of which reject the null hypothesis with Benjamini and
Hochberg (1995) corrected significance of P < 0.05. This confirms
that the inter—lane sequencing variance is in excellent agreement
with the expected uniform random distribution of sequenced RNA
fragments across the lanes on the ﬂow cell.

810

  
 
 
 
 
 
  
 

log va ri a nice
2 4 6

-20

 

2 4 0 2
log mean log mean

Fig. 4. Mean-variance relation for each condition. Each dot in the diagrams
corresponds to one gene, with mean and variance calculated across all clean
replicates in equal-count normalization. The red dashed line is the Poisson re-
lation, where variance: mean. The gold curves show lines of constant disper-
sion parameter, <1), calculated for the median dispersion in each condition:
(BM—22.35 ><10T2 and (BMW: 1.35 x104. Blue curves show the smoothed
data (in logarithmic space) using local polynomial regression fitting (R func-
tion ‘Ioess' with second degree polynomials and smoothing parameter
at: 0.75)

3.2 Inter—replicate variance

Forty—eight biological replicates in each of two conditions also allow
the quantification of reproducibility in expression data across the
replicates within a condition. Because the samples are independent,
a Poisson distribution arises naturally from counting the number of
reads mapping to each gene across replicates. Any additional vari—
ability, either from variability in the experimental protocol or biolo—
gical variability, will result in broader distribution. The variance—
mean relationship across all clean biological replicates (42 in WT
and 44 in Asan) is shown in Figure 4. The data follow the Poisson
law at lower mean count rates, but above ~10 counts per gene there
is a smooth departure from the Poisson relationship and the data be—
come over—dispersed. This can be represented by a relation
02 : u + (p112, where (p is a dispersion parameter, )1 is the mean, and
02 is the variance. The data approximately follow a constant disper—
sion, represented by the median dispersion parameter calculated
over all genes (gold line). Though individual genes depart signifi—
cantly from this line, the best—fitting Loess regression (blue line)
agrees well with the constant dispersion parameter. This means that
the relative width of the count distribution is the same across the full
range of expression. The relative width of a probability distribution
can be represented by its coefficient of variation, (7/11, and for large
values of the mean (p z (a/u)2. In these data, the measured median
dispersion coefficient is N 0.01, corresponding to a typical
a/u ~ 0.1.

3.3 Statistical models for read—count data

Many differential expression tools address the over—dispersion inher—
ent to short read RNA—seq data by assuming the form of the prob—
ability distribution underlying gene expression. Popular choices for
this distribution include, but are not limited to, a negative binomial
(NB, e.g. DESeq and edgeR) or log—normal (LN, e.g. limma) distri—
bution. Here, the gene read counts from clean data are tested against
log—normal, negative binomial and normal (NM) distributions.

The test of normality described by D’Agostino et al. (1990) was
applied to examine whether the data are consistent with a normal
distribution. It builds a statistic based on the skewness and kurtosis
of the data and is sensitive to departures from normality. The same
test was used to probe whether the gene expression data are consist—
ent with a log—normal distribution after log—transforming the data.
The disadvantage of this approach is that it cannot be applied to
data containing zeroes, ruling it out for the ~10% of genes in each

112 /310's1cu1nofp1o1xo"sotwurJOJutotq/ﬁduq 11101} popco1umoq

9103 ‘0g anBnV uo ::

Statistical models for RNA—seq data

3629

 

'n Li:.",'_-‘ [IL-{ii-

    
   
 

_{c) "I"! '-,'.- I _{ﬂ} :'i"\ -;-_ir.‘_.'_’

    

 

 

 

 

 

 

 

 

1131x6871}
e m -.'.-"I {Is-.1 ‘
of I u
m.
a .
m
2 g" ' 1
ﬂ .
. 455mm} ZB'JIDUS'
m 1|:  L L.”- tj] '1l_- e.g.-ifs c .:-.-u
0 rump-“A '
m- “ .. . . .—I-‘..‘—
Q .
m
_o $.- - - -
"I _
‘7' 3mm Lina}: 1?25.!L.87e EBbl.-'LSJ'-'I

0 2 4 6 0 2 4 6 0 2 4 6 0 2 4
log mean log mean log mean log mean

Fig. 5. Goodness-of-fit test results for normal (top panels), log-normal (middle
panels) and negative binomial (bottom panels) distributions. Each panel
shows the test P—value versus the mean count across replicates. Each dot rep-
resents equaI-count normalized data from one gene. Panels on the left (a, b,
e, f, i, i) show clean data with bad replicates rejected (42 and 44 replicates re-
maining in WT and Asan, respectively). Panels on the right (0, d, g, h, k, I)
show all available data (48 replicates in each condition). Dueto the number of
bootstraps performed, P—values for the negative-binomial test are limited to
~10’2. Due to numerical precision of the software library used, P—values from
the normal and log-normal tests are limited to ~10’16. Below these limits
data points are marked in orange (light gray in black and white) at the bottom
of each panel. Horizontal lines show the Benjamini—Hochberg limit corres-
ponding to the significance of 0.05 for the given dataset. The numbers in the
right bottom corner of each panel indicate the number of genes with P—values
below the significance limit and the total number of genes

condition that contains at least one zero (766 out of 6873 genes in
WT and 693 out of 6872 genes in Asan). The expression data for
all genes, including those with zeroes, was tested for consistency
with a negative binomial distribution using the goodness—of—fit test
proposed by Meintanis (2005). This test is based on the probability
generating function and the distribution of the test statistic is not
known in closed form so it requires a bootstrap to calculate P—
values. Hence, it is more computationally intensive than the normal—
ity test. 107 bootstraps were carried out and resulted in P—values
that are limited to be 210—7.

Figure 5 illustrates the result of applying all the tests to the read—
count data for all genes in both conditions. The null hypothesis is re—
jected using a Benjamini—Hochberg corrected critical P—value of
0.05. The data are largely consistent with both the log—normal and
negative binomial distributions; with ~7% and 5% of genes reject—
ing the log—normal hypothesis in WT and Asan dataset, respect—
ively. The negative binomial test rejects this distribution in only a
few genes (which might be partially due to its lower sensitivity). In
fact, a large fraction of data is also consistent with a normal distri—
bution, perhaps unsurprisingly given that both log—normal and nega—
tive binomial distributions approximate the normal distribution for
high counts. At very low counts (EgS1) data become increasingly
non—normal due to its discrete nature, but remain consistent with
the negative binomial distribution.

To assess the impact that ‘bad’ replicates have on the observed
distributions, the same calculations were also performed on the full
set 48 replicates in each condition. When the ‘bad’ replicates were
included, the read counts for a large fraction of genes became incon—
sistent with all three model distributions. This demonstrates that
bad replicates can have a profound distorting effect on read—count
distribution and, by extension, differential expression results. The
effect can be seen particularly clearly in the case of Asan, where the

fraction of genes inconsistent with a log—normal distribution
increased from 5 to 54%, in comparison with clean data.

4 Discussion and conclusions

The data presented here give us an unprecedented view of the vari—
ability inherent to RNA—seq experiments, albeit limited to an organ—
ism with gene expression largely unaffected by splicing and other
complex mechanisms observed in higher eukaryotes. Distinguishing
between variability introduced by experimental procedure and in—
trinsic biological variation is often tricky in RNA—seq experiments,
and is complicated by the opaque use of the terms ‘technical repli—
cate’ and ‘biological replicate’ in much of the literature. In the ex—
periment presented here, 48 S. cerevisiae cell cultures were grown
under the same experimental conditions for each of two biological
conditions; WT and a san mutant line (Asan). Each cell culture
represents a distinct biological replicate of the given condition.
However, each of the samples underwent a series of processing
steps: RNA extraction, polyA selection, fragmentation, priming,
cDNA synthesis, adapter ligation, PCR amplification and sequenc—
ing which can contribute to the overall variability. Accordingly, the
observed read—count variability is a combination of true biological
variability between individual samples, and the protocol variability
introduced during sample preparation and sequencing.

4.1 Read—count distribution

A key finding of this work is the demonstration that the read—count
distribution of the majority of genes is consistent with the negative
binomial model. Reassuringly, many of the most widely used RNA—
seq DGE tools [e.g. edgeR, DESeq, cuffdiff, (Trapnell et (11., 2010)
and baySeq, (Hardcastle and Kelly, 2010)] do assume a negative bi—
nomial distribution of gene—read count. Therefore, the majority of
the RNA—seq DGE studies in the literature are, at least, based on
tools that make appropriate assumptions. We recommend that fu—
ture analyses of RNA—seq DGE experiments use existing, or new,
tools that are based on a negative binomial distribution of gene read
count. The log—normal model is also consistent with a large propor—
tion of the genes in our data, however, its use becomes problematic
when one or more of the replicates contain zero counts.

4.2 Mean—variance relationship

In this work, the observed variance is tightly related to the mean and
follows a line of constant dispersion parameter. Modelling the
mean—variance relationship is essential in many DGE tools [e.g. in
edgeR (Robinson et (11., 2010) and DESeq (Anders and Huber,
2010)], when dealing with a small number of replicates. In such
cases, variance at individual gene level has to be controlled by bor—
rowing information from other genes. Our findings favour data
models based on a common dispersion calculated across all genes.

4.3 Inter—lane variability

The design of the experiment presented here also allows us to probe
the inter—lane sequencing variability in detail. This reﬂects how
reads from one biological sample are distributed between different
lanes of a ﬂow cell and arises from a limited number of steps in the
RNA—seq protocol, namely loading the samples into individual
lanes, cluster amplification and sequencing by synthesis. An even
loading and spatially uniform amplification and sequencing should
give rise to a Poisson distribution of counts from individual genes.
This is technical variability at a very low level. A x2 dispersion test
applied to inter—lane data confirms that they follow the Poisson law.

112 /310's1cu1nofp1o1xo"sotwuiJOJutotq/ﬁduq 11101} popco1umoq

9103 ‘0g anBnV uo ::

3630

M. Gierliriski et al.

 

This kind of test can be included in quality control to test for ﬂow
cell defects.

4.4 Impact of 'bad’ replicates

As shown in Figure 5, one of the key observations from this study is
the large impact that ‘bad’ replicates have on the underlying proper—
ties of RNA—seq data. Without additional quality controls at the rep—
licate level a large proportion of the data are inconsistent with all
the statistical models tested. Although the incidence of ‘bad’ repli—
cates can be reduced through improvements in sequencing tech—
niques such as paired—end and longer reads, it cannot be entirely
eradicated. In this study, 48 biological replicates were performed.
This is not practical or cost—effective for routine experiments, but it
is clear that increasing the number of biological replicates above the
2 or 3 typically performed in RNA—seq experiments will be benefi—
cial in mitigating the risk of ‘bad’ biological replicates skewing inter—
pretation of the data.

Acknowledgements

We acknowledge Tom Walsh for his efforts and support in managing the soft-
ware requirements for this project on our HPC platform. We also thank
Simos Meintanis and Melanie Febrer for useful discussions.

Funding

This work was supported by: The Wellcome Trust (92530/Z/10/Z and stra-
tegic awards WTO9230, WTO83481 and WTO97945), Biotechnology and
Biological Sciences Research Council (BB/110022860 and BB/JOO247X/1).

Conﬂict of Interest: none declared.

References

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence
count data. Genome Biol., 11, R106.

Anders,S. et al. (2014) HTSeq—a Python framework to work with high—
throughput sequencing data, Bioinformatics, 31, 166—169.

Auer,P.L. and Doerge,R.W. (2010) Statistical design and analysis of RNA
sequencing data. Genetics, 185, 405—416.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. I. R. Stat. Soc. Ser B
Methodol, 57, 289—300.

D’Agostino,R.B. et al. (1990) A suggestion for using powerful and informative
tests of normality. Am. Stat., 44, 316—321.

Dillies,M.A. et al. (2013) A comprehensive evaluation of normalization meth—
ods for Illumina high—throughput RNA sequencing data analysis. Brief
Bioinform, 14, 671—683.

Fisher,R.A. (1950) The signiﬁcance of deviations from expectation in a pois—
son series. Biometrics, 6, 17—24.

Flicek,P. et al. (2011) Ensembl 2011. Nucleic Acids Res., 39, D800—D806.

Hansen,K.D. et al. (2011) Sequencing technology does not eliminate biological
variability. Nat. Biotechnol, 29, 5 72—5 73.

Hardcastle,T.J. and Kelly,K.A. (2010) baySeq: empirical Bayesian methods for
identifying differential expression in sequence count data. BMC
Bioinformatics, 1 1, 422.

Jiang,L. et al. (2011) Synthetic spike—in standards for RNA—seq experiments.
Genome Res., 21,1543—1551.

Kim,D. et al. (2013) TopHat2: accurate alignment of transcriptomes in the
presence of insertions, deletions and gene fusions. Genome Biol., 14,
R36.

Loven,J. et al. (2012) Revisiting global gene expression analysis. Cell, 151,
476—482.

Marioni,J.C. et al. (2008) RNA-seq: an assessment of technical reproducibility
and comparison with gene expression arrays. Genome Res., 18, 1509—1517.

Meintanis,S. (2005) Transform methods for testing the negative binomial hy-
pothesis. Statistica, 65, 293—300.

Mortazavi,A. et al. (2008) Mapping and quantifying mammalian transcrip—
tomes by RNA—Seq. Nat. Methods, 5, 621—628.

Nagalakshmi,U. et al. (2010) RNA—Seq: a method for comprehensive tran—
scriptome analysis. Curr. Protoc. Mol. Biol. Chapter 4, Unit 4, 11, 11—13.
Rapaport,F. et al. (2013) Comprehensive evaluation of differential gene ex-

pression analysis methods for RNA—seq data. Genome Biol., 14, R95.

Robinson,M.D. and Oshlack,A. (2010) A scaling normalization method for
differential expression analysis of RNA—seq data. Genome Biol., 11, R25.

Robinson,M.D. and Smyth,G.K. (2008) Small-sample estimation of nega—
tive binomial dispersion, with applications to SAGE data. Biostatistics, 9,
321—332.

Robinson,M.D. et al. (2010) edgeR: a bioconductor package for differential
expression analysis of digital gene expression data. Bioinformatics, 26,
139—140.

Schurch,N.J. et al. (2015) Evaluation of differential gene expression tools on a
two-condition, 48 replicate RNA—seq experiment in preparation (preprint
arXiv:1505.02017).

Smyth,G.K. (2004) Linear models and empirical bayes methods for assessing
differential expression in microarray experiments. Stat. Appl. Genet. Mol.
Biol., 3, 1—25.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti—
ation. Nat. Biotechnol. , 28, 511—515.

112 /310's1cu1nofp1o1xo'soticuiJOJutotq/ﬁduq 11101} popco1umoq

9103 ‘0g isanV uo ::

