Bioinformatics, 32110), 2016, 1486—1492

doi: 10.1093/bioinformatics/btv753

Advance Access Publication Date: 18 January 2016
Original Paper

 

 

Genetics and population analysis

MultiGeMS: detection of SNVs from multiple
samples using model selection on high-
throughput sequencing data

Gabriel H. MuriIIOI, Na Youz, Xiaoquan Su3, Wei CuiI, Muredach P. Reilly4,
Mingvao Li5, Kang Ning6 and Xinping cui1,7,*

1Department of Statistics, University of California, Riverside, CA 92521, USA, 2Department of Statistical Science,
School of Mathematics and Computational Science, Sun Yat-Sen University, Guangzhou, Guangdong 510275,
China, 3Qingdao Institute of BioEnergy and Bioprocess Technology, Chinese Academy of Sciences, Qingdao,
Shandong 266101, China, 4Cardiovascular Institute, 5Department of Biostatistics and Epidemiology, University of
Pennsylvania Perelman School of Medicine, Philadelphia, PA 19104, USA, 6Key Laboratory of Molecular
Biophysics of the Ministry of Education, College of Life Science and Technology, Huazhong University of Science
and Technology, Wuhan, Hubei 430074, China and 7Center for Plant Cell Biology, Institute for Integrative Genome
Biology, University of California, Riverside, CA 92521, USA

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on 16 July 2015; revised on 19 December 2015; accepted on 21 December 2015

Abstract

Motivation: Single nucleotide variant (SNV) detection procedures are being utilized as never before
to analyze the recent abundance of high—throughput DNA sequencing data, both on single and mul—
tiple sample datasets. Building on previously published work with the single sample SNV caller
genotype model selection (GeMS), a multiple sample version of GeMS (MultiGeMS) is introduced.
Unlike other popular multiple sample SNV callers, the MultiGeMS statistical model accounts for en—
zymatic substitution sequencing errors. It also addresses the multiple testing problem endemic to
multiple sample SNV calling and utilizes high performance computing (HPC) techniques.

Results: A simulation study demonstrates that MultiGeMS ranks highest in precision among a se—
lection of popular multiple sample SNV callers, while showing exceptional recall in calling common
SNVs. Further, both simulation studies and real data analyses indicate that MultiGeMS is robust to
low—quality data. We also demonstrate that accounting for enzymatic substitution sequencing
errors not only improves SNV call precision at low mapping quality regions, but also improves re—
call at reference allele—dominated sites with high mapping quality.

Availability and implementation: The MultiGeMS package can be downloaded from https://github.
com/cui—Iab/multigems.

Contact: xinping.cui@ucr.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 IntrOducuon Project (Consortium, 2012) and the International HapMap Project

In recent years, a precipitous fall in the costs of DNA sequencing has (The International HapMap 3 Consortium, 2010) have done much to
led to a similarly precipitous rise in the amount of available DNA catalog human genetic variation. Such projects have put an emphasis
sequencing data. Using such data, projects such as the 1000 Genomes on sequencing multiple samples, as it has been demonstrated that

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1486

/310‘Sjcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

MultiGeMS: Multiple Sample HTS SN V Detection Using Model Selection 1487

 

given a fixed sequencing budget, the total number of population vari—
ants identified can often be increased by decreasing the coverage and
increasing the number of samples sequenced (Le and Durbin, 2011).
This is, in fact, a motivation for the 1000 Genomes Project low—cover—
age pilot project (1000 Genomes Project Consortium et al., 2010).

As single nucleotide variants (SNVs) are the most common type
of sequence variation, many data analysis tools have been created to
detect SNVs from DNA sequencing data. However, the prevalent
single sample SNV detection procedure has proved insufficient with
the availability of data from multiple samples.

There are generally two possibilities for SNV detection using sin—
gle sample SNV callers on multiple sample data. First, it is possible
to pool the multiple sample data, and run single sample SNV callers
on all the data as if it were one sample. This can, however, reduce
the number of legitimate SNV calls, as rare SNVs are often dis—
missed as errors. Also, pooled data genotype calls may not be indica—
tive of the true sample genotypes. For example, if half of the samples
are homozygous reference and the other half are homozygous vari—
ant, then the pooled genotype call will likely be heterozygous, even
when none of the samples are such.

Second, single sample SNV callers can be run on all the samples
independently and the output SNV call lists can be combined. This
procedure may be useful if the analysis objective is to find variants
unique to individual samples. However, for the most part, this pro—
cedure will greatly inflate the false positive rate.

A common solution to these issues is the development of multiple
sample SNV callers. These procedures utilize data from multiple
samples to identify both common and rare SNVs, as well as SNVs
which may have limited support across multiple samples. The
amount of SNVs called would generally be between that of the two
possibilities mentioned above. That is, the goal of multiple sample
SNV callers is to have a good balance of precision and recall with re—
spect to all the samples analyzed.

There are, however, concerns with currently available multiple
sample SNV callers. A primary concern is how to utilize all import—
ant and available information to accurately call SNVs from multiple
samples. Other concerns include the resulting multiple testing prob—
lem that arises, computational performance and robustness to low—
quality sequencing and alignment data.

All of these concerns are addressed with the multiple sample
genotype model selection (MultiGeMS) SNV caller, which will here
be introduced. MultiGeMS builds on the previously published single
sample SNV caller GeMS (You et al., 2012), and estimates sample
genotypes and genotype probabilities for possible SNV sites. Unlike
other popular multiple sample SNV callers, the MultiGeMS statis—
tical model accounts for enzymatic substitution sequencing errors.
Also, in consideration of the multiple testing problem associated
with SNV calling, SNVs are called using a local false discovery rate
(IFDR) estimator. Further, MultiGeMS utilizes high performance
computing (HPC) techniques for computational efficiency and is ro—
bust to low—quality sequencing and alignment data.

2 Methods

The MultiGeMS procedure is motivated by a consideration of the
sequencing by synthesis procedure used by the Illumina HTS plat—
form. Before the well—known stages of base—calling, alignment and
SNV calling, there are many steps leading up to sequencing by syn—
thesis. These steps begin with the acquisition and fragmentation of
the DNA samples to be sequenced, and then include various proced—
ures involving enzymatic binding of complimentary bases. These

Table 1. MultiGeMS notation

 

Notation Explanation

 

i E {1, . . . ,5}
{Xi} H; alleles consisting of reference alleles (R) and
‘most prevalent non-reference’ alleles (N); other

sample index

alleles discarded

{Gr} unobserved genotypes

g E {RRiRNiNNI1  =g) = pg
Y,~ unobserved ‘sequencing’ allele associated with Xi)
qi P(Y,-,- = kIGi = g, uRM/zNR) where k E {R,N}
,uRN, ,uNR ‘sequencing’ allele (Yii) mutation rates simultan-

eously estimated over (0,0.5] from all samples,
where ,uRN = P(Y,-,- = NIG, = RR) and
#NR = P(Yii = RIGi = NN)

wif ‘weight’ of Xi), based on base-calling and alignment
scores

Di; {X171 wii}

D; {D1, :je {1, ... ,m}}, the observed allele data

0 set of 5 parameters: {pg}, ,uRN, ,uNR

Big  = gIDi, 

 

Given the assumption that each site is independent, only one site is con-
sidered at a time, and hence a site index variable is not necessary.

procedures include fragment end repair, PCR amplification, bridge
amplification and the pre—base—calling sequencing by synthesis. Each
time bases are enzymatically bound together, a base substitution
error is possible. For example, the non—complimentary bases A and
G may bind. Likewise, C and T may bind in error. When this hap—
pens, a base sequenced by the sequencing by synthesis process may
be in conflict with the alleles of the underlying genotype, leading to
downstream problems in base—calling, alignment and SNV calling.
While recent advances in Illumina platform sequencing and variant
calling pipelines have mitigated many types of sequencing errors, the
MultiGeMS procedure, as a multiple sample SNV caller accounting
for such enzymatic substitution sequencing errors, represents a sub—
stantial contribution to variant calling (see Supplementary Materials
Section 1).

The MultiGeMS procedure requires a FASTA genome reference
file and corresponding Illumina HTS platform alignment data in the
form of PILEUP files for each sample. Hence, sites on the reference
file with a corresponding allele pileup are associated with their refer—
ence base R, observed alleles aligned to the site, and associated base—
calling and alignment quality scores. MultiGeMS assumes alignment
data from a diploid organism, and thus, in theory, a maximum of
only two alleles should be observed in the allele pileup at a site of
any sample. MultiGeMS further assumes that one of these alleles is
R, while the other is the site’s most prevalent non—reference allele N,
which is the observed non—reference allele mode taken after pooling
the site’s sample allele pileups (justification of this assumption and
commentary on triallelic sites is provided in Section 2 of the
Supplementary Materials). At each site, only R and N are con—
sidered. All other alleles in a pileup are discarded Table 1 summa—
rizes the notation used by MultiGeMS as expressed below.

Assuming 5 samples, let X,- E {R, N} denote the jth
(/ 6 {1,2, . . . ,ni}) observed allele from sample 1' at a particular site
on the reference genome. Given a sample 1', all the X,, obtained from
the aligned HTS reads at a given genomic site are independent. Each
site is also assumed to be independent and all the samples are
assumed to be independent. Further, let Yi; 6 {RN} be defined as
the unobserved ‘sequencing’ allele associated with X,,, that is, the
base that is sequenced in the sequencing by synthesis procedure.
Finally, let G, be the unobserved genotype associated with sample 1',

ﬁm'sreumol‘pquo'sopeuuowtotq/ﬁdnq

1 488

G. H. Murillo et al.

 

Table 2. qf, given for [(6 {R, N} and 96 {RR, RN, NN}, as ex-
pressed as a function of {WW pNR}

 

 

 

k=R k=N
g = RR 1 — #RN #RN
g=RN %(1—HRN)+%#NR %#RN+%(1—HNR)
g = NN #NR 1 — #NR

Unobserved Gt

Unobserved Yij

I w”
Observed X ij

Fig. 1. The relationship between G), Y,-,- and X,-,-. The genotype G,- associated
with sample iat a particular site is unobserved. As is probabilistically mod-
eled by qﬁ, the unobserved ‘sequencing' allele, Y,-,-, depends on 6;. Finally, the
observed allele, X,-,-, depends on Y,-,- and w,-,-

which, in the MultiGeMS framework, can be either RR, RN or NN.
P(Gi : g), the probability of genotype g, is notated by pg.

Revisiting the enzymatic base substitution errors described
above, let uRN be the probability that Yi; : N, assuming the geno—
type G, : RR. That is, because of enzymatic base substitution
errors, the ‘sequencing’ allele may not be representative of the geno—
type. Likewise, let uNR : P(Yi/ : RIG,- : NN). The MultiGeMS
procedure estimates these ‘sequencing’ allele mutation rates. The
probability expressions of Yilei are derived in Section 3 of the
Supplementary Materials and are listed in Table 2, where

(Ii :P(Yij:kIGi:gmuRNmuNR)' (1)

MultiGeMS also utilizes the Phred—scaled base—calling (3,7) and
alignment (M,,) quality values for each observed allele (X,,).
Specifically, the minimum of an aligned allele’s P(Correct Base—Call)
and P(Correct Alignment) is taken as the accuracy or weight of that
aligned allele. Given the Phred quality scoring scheme, this weight is
given as follows.

wi; : min{P(Correct Base—Call), P(CorrectAlignment)}
: 1 _ 10—0.1min{B,/.M,/} 

Collectively, the observed allele data, {X ,7, wij}, is notated D,,.

Given a correct base—call and alignment, we can assume that
X,, : Y,,. We, therefore, propose the following probability distribu—
tion for Xil'IYil'.

P(Xi/ : Yi/IYiz) 2 wii
P(Xil' 5A Yil'IYil') : 1 — wi; 

Figure 1 demonstrates the relationship between G,, Y,, and X,,.
The conditional likelihood of the data given the genotype is
given by the following, where I represents the indicator function.

P(DiIGi I g7 “RN: HNR)

n)
: HP(DijIGi I gmuRNmuNR)
;:1

I H IP(Xi/7Wi/IYi/‘ : k)IP(Yi/' I lQIQ I gmuRNmuNR)
j:1ke{ .N}
"‘ 1x,:k ,/ k
2 1w.) k1 — w)” t W; <4)
;:1 ke{R.N}

Further, assuming that the samples are independent, the com—
plete log—likelihood with parameter 0 : {pRR, pRN, pNN, HRN, HNR}
and unobserved G : (G1, . . . ,GS) is as follows.

[(BID, G)
: logP(DIG, 0)P(GIO)

: lOgH HIP<DiIGi = gm. “Name,- : gIPgHMFg)

i:1 g

: 2:103: g){IOgP(DiIGi I gmuRNmuNR) +10ng} (5)
i:1 g

The MultiGeMS procedure begins by identifying sites that could
possibly be a SNV. Then, using the above complete log—likelihood, it
runs an EM algorithm estimation procedure (see Supplementary
Materials Section 3) on said sites to accurately genotype both these
sites and the multiple samples at these sites. This multiple sample
genotyping process, or multi—sample genotype model selection, in—
volves calculating the probabilities for the genotypes RR, RN and
NN, and then selecting the genotype with the largest associated
probability. Further, using the local false discovery rate (lFDR) re—
sult in Muralidharan et al. (2012), MultiGeMS then addresses the
multiple testing problem endemic to SNV detection by calling SNVs
if IFDR g 0.1 (see Supplementary Materials Section 4). lFbR is
given below, where c, are the coverage weights, eLRR : P(Gi : RR)
Di, 0) and the asterisk (*) indicates final EM iteration values.

2 6i10g(e§iRR)
lFDR : exp ’ (6)

262'
i

IFDR is a coverage—weighted geometric mean of {el’iRR}, where
each eﬁRR is dependent on the estimated ‘sequencing’ allele mutation
rates (ﬂRN, itNR), the observed alleles ({Xi;}) and the quality weights
({wi;}). The effect of estimating the ‘sequencing’ allele mutation
rates is to increase SNV calling power at sites dominated by R alleles
(see Section 3.2). In particular, assuming high base—calling and map—
ping quality data, a non—zero estimate of uNR : P(Yi; : RIG, : NN)
allows for the possibility of an enzymatic base substitution error at
bases observed as R, increasing the likelihood of a SNV call determin—
ation. Alternatively at such sites, when uNR is estimated to be near 0,
MultiGeMS is more conservative in its SNV calling, determining only
those sites with extensive evidence of a variant.

3 Results

3.1 Simulation study

To validate the MultiGeMS procedure, we conducted a simulation
of 10 samples of HTS data from the roughly 2.5 Mbp
Thermoanaerobacter 517. X514 reference. Each sample was simu—
lated at an average of 5 OX coverage using DWGSIM (http://source
forge.net/projects/dnaa/). The data were simulated with three levels
of SNVs: ‘population’ (the set of simulated variants which are pre—
sent in the reads of all samples), ‘group’ (the set of simulated vari—
ants which are present in the reads of a certain subset of samples)
and ‘individual’ (the set of simulated variants which are present in

ﬁm'sreumol‘pquo'sopeuuowtotq/ﬁdnq

MultiGeMS: Multiple Sample HTS SN V Detection Using Model Selection 1489

 

the reads of only a single sample) SNVs. All samples were simulated
with the population SNVs at a rate of 0.625 per 1000 bp. The group
SNVs were simulated at a rate of 0.3125 per 1000 hp, with half the
samples simulated with group ‘A’ SNVs and the other half simulated
with group ‘B’ SNVs. Finally, each sample was simulated with indi—
vidual sample SNVs at a rate of 0.0625 per 1000 bp. Hence, the
overall SNV rate in every sample was 1 per 1000 bp and the total
number of simulated population, group and individual sample SNVs
were kept roughly the same: 1536, 1536 and 1541, respectively.
Also, it is noteworthy that the DWGSIM option —Q 3 O was utilized
to simulate a large standard deviation in the base—calling quality
scores, which can lead to downstream alignment and variant calling
difficulties. The full details of the simulation study are given in
Table 3 of the Supplementary Materials.

MultiGeMS and four popular multiple sample SNV detection
procedures were run on the BWA (Li and Durbin, 2009) aligned
simulation data: FreeBayes (Garrison and Marth, 2012), GATK
(DePristo et al., 2011; McKenna et al., 2010), SAMtools (Li et al.,
2009) and VarScan (Koboldt et al., 2012). For comparison, the two
methods of calling SNVs on multiple samples using a single sample
SNV caller, as described in Section 1, are demonstrated using single
sample GeMS (You et al., 2012). ‘GeMS’ represents the results from
running GeMS on each sample and then combining the resulting
SNV call lists. ‘GeMS—pooled’ represents the results from pooling all
the sample alignment files into one alignment file using BamTools
(Barnett et al., 2011), and then running GeMS on this file.
FreeBayes, GATK, SAMtools and VarScan are also capable of single
sample SNV detection, hence these SNV callers can also be imple—
mented with the aforementioned pooling methods. The overall re—
sults, presented with each SNV caller’s recall, precision and F—score
(the harmonic mean of precision and recall), are given in Table 3.
The ‘CPU Time (min)’ and ‘Max Memory (MB)’ columns of Table 3
will be discussed in Section 3.3. While FreeBayes, GATK, SAMtools
and VarScan are able to detect variants other than SNVs, for ex—
ample insertions and deletions, the release version of MultiGeMS as
described herein is limited to SNV detection. Hence only the SNV
call output of all the tested procedures were compared, without re—
gard to whether these procedures also, by default, detected other
types of variants (which may have impacted needed computational
resources and the SNV call results themselves). See Section 4 for fur—
ther details on the detection of indels and other variant types.

As shown in Table 3, the SNV callers were conservative in gen—
eral, other than GATK and GeMS. GATK was relatively aggressive,
favoring recall over precision and even calling over 900 more sites
than the total simulated SNV count. Likewise, the GeMS results
demonstrate the issues occuring when single sample SNV call lists
are combined. Despite having the greatest overall recall, GeMS has

Table 3. Simulation study results

the second lowest F-score because of its poor precision. Hence, be—
cause of the resulting inflated false positive rate, the GeMS method
is not recommended, unless perhaps, when searching for rare SNVs.

The best balance of precision and recall, as measured by the
F-score, can be seen in the performance of FreeBayes, with
MultiGeMS as a close second. Each of the other SNV calling results,
such as those from GATK or SAMtools, show a greater relative
weakness in either precision or recall, but not both. Thus, because of
the large standard deviation of the simulated base—calling quality
scores, we can see that FreeBayes and MultiGeMS are robust to
low—quality sequencing data. Of special note is the perfect precision
of MultiGeMS. The only other SNV caller with a precision of 1 is
VarScan, but it also has the lowest recall and F-score values.

The recall results, in Table 4, help us to understand more about
the temperament of each SNV caller with respect to the simulated
population, group and individual SNVs. For example, all the SNV
callers, other than SAMtools, demonstrate better recall for the popu—
lation SNVs compared to the individual SNVs. This behavior is ex—
pected as the population SNV sites would have a higher variant
signal than individual SNV sites. In general, a relatively large num—
ber of variant genotype samples would provide a higher variant sig—
nal, and hence, such a site is more likely to be called a SNV
(naturally, multiple sample SNV caller VCF output indicates the
genotype calls for each sample). Also as expected is the extremely
low individual SNV recall of GeMS—pooled. Since the alignment
data from the 10 samples were pooled into one file, any variant
simulated in just one of the samples would have very low variant sig—
nal. Hence, the GeMS—pooled method is not recommended for mul—
tiple sample data, unless perhaps, when searching for common
SNVs. In contrast to the GeMS—pooled results, the low group and in—
dividual SNV recall results of VarScan does not result from the data
being pooled, as the output VCF file contains columns for each of
the 10 samples.

Table 4. Simulation study recall results, by level of SNV

 

 

Count Population Group Individual
GeMS 7843 0.9818 0.9831 0.9676
GATK 5574 0.9792 0.9798 0.9676
FreeBayes 4476 0.9596 0.9661 0.9513
MultiGeMS 4141 0.9772 0.9805 0.7398
SAMtools 3619 0.4805 0.9785 0.8027
GeMS-pooled 3166 0.9818 0.9831 0.0019
VarScan 2013 0.9245 0.3730 0.0143

 

The results are sorted in descending order of the SNV count.

 

 

Count Recall Precision F-score CPU Time (min) Max Memory (MB)
FreeBayes 4476 0.9596 0.9877 0.9735 80.3 204
MultiGeMS 4141 0.8988 1.0000 0.9467 17.5 24
GATK 5574 0.9761 0.8068 0.8834 11.6 1211
SAMtools 3619 0.7541 0.9599 0.8446 29.5 39
GeMS-pooled 3166 0.6544 0.9523 0.7758 10.8 416
GeMS 7843 0.9774 0.5741 0.7234 16.7 417
VarScan 2013 0.4369 1.0000 0.6082 45.6 993

 

The results are sorted in descending order of F—score, which is the harmonic mean of the SNV caller precision and recall. Total CPU time in minutes and max-

imum procedure memory in megabytes (MB) utilized by the SNV callers running on a single thread for the simulation study analysis are provided in the two far

right columns, respectively.

ﬁm'sreumol‘prqxo'sopeuuowtotq/ﬁdnq

1490

G. H. Murillo et al.

 

Of note is the exceptional population and superior group recall
values of MultiGeMS compared to the other multiple sample SNV
callers. However, the reason for FreeBayes’ superior overall F—score
in Table 3, is the lower individual SNV recall of MultiGeMS. When
greater individual SNV recall is required, a larger lFDR threshold
can be used, though this is not generally recommended (see
Supplementary Materials Section 4). The results of various lFDR
threshold values can be seen in Table 5. Though it is notable that
the MultiGeMS F—score at the lFDR threshold of 0.4 is slightly
greater than that of FreeBayes, we acknowledge that the results of
any SNV caller can be filtered in various ways to suit the user’s ob—
jectives. Table 4 of the Supplementary Materials provides the
MultiGeMS simulation study recall results by lFDR threshold and
level of SNV. There we see that increasing the lFDR threshold
greatly increases the individual SNV recall results, without much af—
fecting the recall results of the population or group SNVs.

As we can see, MultiGeMS demonstrates perfect precision along
with robustness to low—quality sequencing data. It also boasts excep—
tional recall of simulated population and group SNVs. However,
care is needed when using MultiGeMS on multiple sample data
known to harbor individual or rare SNVs.

3.2 Human data analysis

In addition to simulated data, the MultiGeMS procedure was also
validated using data from 10 human samples. The 10 samples are
NA12878 and NA12877, and 8 of their offspring: NA12879,
NA12880, NA12882, NA12883, NA12885, NA12886, NA12888
and NA12893. These data were retrieved from ‘WGS sequencing
BAMs for the entire pedigree produced by Illumina as part of their
Platinum project’, additionally a ‘gold standard variant dataset’ is
available from the Genome in a Bottle Consortium (https://sites.stan
ford.edu/abms/content/availability—phase—consistent—gold—standard—
variant—set—na12878—and—rtgtools—software). As many SNV callers,
MultiGeMS treats all samples, such as the 10 samples from the
aforementioned family, independently. However, work has been
done to model family relationships in variant calling, for example,
see Li et al. (2012). The full details of this human data analysis are
given in Table 6 of the Supplementary Materials. Also, Section 5 of
the Supplementary Materials considers the addition of an unrelated
sample to this human data analysis.

The aforementioned SNV callers were run on the data isolated to
chromosomes 18—22. As shown in Table 6, MultiGeMS displays
good precision and recall, but is not top—ranked in terms of these
metrics or F—score. Also, as in Section 3.1, we see the superiority of
MultiGeMS to GeMS and GeMS—pooled.

As indicated in Section 2, an accounting of enzymatic substitu—
tion sequencing errors provided motivation for the MultiGeMS
SNV caller. It is evident that bases with such errors may be high in
base—calling quality, and the corresponding read mapping quality
will also be high if only a small number of mismatches occurs. For
samples at a given genomic site where R is the dominant allele, the

Table 5. MultiGeMS simulation study results

 

 

Count Recall Precision F—score
0.1 4141 0.8988 1.0000 0.9467
0.2 4308 0.9347 0.9995 0.9660
0.3 4438 0.9538 0.9901 0.9716
0.4 4510 0.9635 0.9843 0.9738
0.5 4638 0.9698 0.9633 0.9666

 

The results are sorted by the lFDR threshold values in the ﬁrst column.

estimated uNR is often larger than the estimated uRN, suggesting that
the R allele is more likely to be perceived as an enzymatic base sub—
stitution error than the N allele. This would increase the likelihood
for an RN or NN genotype call and therefore a SNV call. If HM] and
uNR are assumed to be zero, as is the case with many other SNV call—
ers, a SNV call will be most likely missed at such sites.

On the other hand, at a site where N is the dominant allele, the
estimated uNR is often smaller than the estimated uRN, suggesting
that the R allele is less likely to be perceived as an enzymatic base
substitution error than the N allele. This would increase the likeli—
hood for an RN genotype call and therefore lead to a SNV call. If
HM] and uNR are assumed to be zero, as is the case with many other
SNV callers, the likelihood of the NN genotype call will be high
which will still lead to a SNV call. Therefore, as shown in Table 7,
we see the increased SNV calls at R allele—dominated sites and only
a slight increase in SNV calls at N allele—dominated sites.

Sometimes bases with enzymatic substitution sequencing errors
may be high in base—calling quality but low in read mapping quality
if many mismatches occur. Although mapping—quality—based SNV
detection methods will most likely not make a SNV call if the map—
ping quality score is low, MultiGeMS takes extra caution in making
SNV calls in this situation. For the cases such as RR —> N —> N
(G,- —> Y” —> Xi], as in Fig. 1) with low mapping quality scores, if
uRN is not very close to 0, the low 111,, and high estimated uRN will
inhibit a MultiGeMS SNV call. This possibly explains the marginal
better performance of MultiGeMS in low—mapping quality regions
as shown below.

Consider the union of the sites called by the multiple sample
SNV callers and those sites validated as SNVs on chromosome 22
(the analyzed chromosome with the lowest average read mapping
quality).We can divide these sites by average mapping quality quar—
tiles and compute the F—score for each SNV caller. Let us call the set
of such sites with average mapping quality between the minimum
and the first quartile as ‘quarter 1’, the set of such sites with average
mapping quality between the first quartile and the median as ‘quar—
ter 2’, and so on. As shown in Table 8, MultiGeMS is the top—ranked
SNV caller, in terms of F—score, in quarter 1. That is, MultiGeMS
has the advantage at low mapping quality sites.

Table 6. Human chromosomes 18—22 data analysis results

 

 

Count Recall Precision F-score
SAMtools 522 597 0.9858 0.8544 0.9154
VarScan 519 860 0.9766 0.8509 0.9094
MultiGeMS 543 457 0.9874 0.8229 0.8977
FreeBayes 552 472 0.9690 0.7944 0.8730
GeMS-pooled 499 267 0.8390 0.7612 0.7982
GeMS 715 224 0.9858 0.6243 0.7645
GATK 799 770 0.9954 0.5637 0.7198

 

The results are sorted in descending order of F—score.

Table 7. SNV call counts for two versions of MultiGeMS, the regu-
lar version (second column) and the y E 0 version (third column),
by sites of various R allele proportion values

 

 

R Proportion Count Count ()1 E 0)
[075,1] 136 993 192
[0.5,0.75) 173 011 48758
[0.25, 0.5) 103 626 99466
[0, 0.25) 129 827 128688

 

ﬁm'sreumol‘prqxo'sopeuuowtotq/ﬁdnq

MultiGeMS: Multiple Sample HTS SN V Detection Using Model Selection

1491

 

Table 8. Human chromosome 22 data analysis F-score results divided by mapping quality quarters

 

Quarter 1

Quarter 2

Quarter 3

Quarter 4

 

MultiGeMS
SAMtools
VarScan
FreeBayes
GeMS-pooled
GeMS

GATK

0.5127 (9319)
0.4971 (9656)
0.4929 (9254)
0.4073 (13 284
0.3906 (12 046
0.2944 (22 607
I

)
)
)
0.2569 26 829)

0.7747 (10 137)
0.8099 (9163)

0.7912 (9426)

0.6614 (11 874
0.6766 (11 173
0.4803 (20 800
0.3872 (27 563

0.9550 (23 976)
0.9613 (23 610)
0.9589 (23 335)
0.9494 (23 141)
0.9230 (22 209)
0.9266 (25 490)
0.8830 (27 921)

0.9772 (27 753)
0.9784 (27 696)
0.9782 (27 390)
0.9777 (27 165)
0.9432 (25 856)
0.9764 (27 818)
0.9717 (28 111)

 

The F—score and SNV count (in parentheses) are provided for each SNV caller and mapping quality quarter. The results are sorted in descending order of the

‘Quarter 1’ F—score values.

In considering the performance of the SNV callers with rare
SNVs, HTS alignment and validated variant data from one unre—
lated human sample can be analyzed along with the 10 related
human samples as described above. The unrelated sample, identified
as 1245 (data available upon request), was sequenced as part of a
clinical trial and is not distinguished with any unusual genetic or
data characteristics. The results for chromosomes 18—22 are pro—
vided in Table 9. Compared with Table 6, we see that other than the
GeMS—pooled precision, the SNV caller performance metrics have
all decreased. This indicates that the unrelated sample data is noisy
relative to the data of the 10 related samples. It is of interest to note,
however, that the relative ranking of MultiGeMS, with respect to
the F—score, has increased from the third to the first position. See
Section 5 of the Supplementary Materials for more details.

3.3 Computational performance

Both the CPU time in minutes and the memory usage in megabytes
(MB) were recorded for the tested SNV callers for both the simula—
tion study in Section 3.1 and the human chromosome 22 analysis in
Section 3.2. The computational resources used during the data pre—
processing necessitated by GeMS, GeMS—pooled, MultiGeMS and
VarScan were also recorded.

For the simulation study analysis, the specifications of the com—
puter used are CPU: AMD OpteronTM Processor 6376 2.3 GHz and
RAM: 512 GB. Total CPU time and maximum procedure memory
utilized by the SNV callers running on a single thread are provided
in Table 3, whereas other computational performance details are
given in Table 5 of the Supplementary Materials. It is noteworthy
that the MultiGeMS procedure has the lowest memory requirement
of all the tested SNV callers. Also, MultiGeMS outpaces all the mul—
tiple sample SNV callers other than GATK. Though, while GATK
requires 5.9 fewer minutes than MultiGeMS, its memory require—
ment is roughly 50 times greater than MultiGeMS.

For the human chromosome 22 analysis, the specifications of the
computer used are CPU: AMD OpteronTM Processor 6136 2.4 GHz
and RAM: 16 GB. The single thread results are listed in Table 10.
Also, since MultiGeMS and GATK have multiple thread options,
the results of these SNV callers running on four threads are listed in
Table 7 of the Supplementary Materials.

A disparity can be seen in the RAM utilized in GATK and
VarScan compared to the other multiple sample SNV callers. Since
GATK and VarScan are based on the Java programming language,
they tend to utilize more of the available memory than the SNV call—
ers written in C (SAMtools) or C ++ (MultiGeMS, FreeBayes).

Given single thread processing, Table 10 identifies MultiGeMS
as the most memory efficient SNV caller. It is also the second fastest,
in terms of total CPU time. As seen in Table 7 of the Supplementary
Materials, running on multiple threads can further improve the

Table 9. Human chromosomes 18—22 data analysis results with an
additional unrelated sample

 

 

Count Recall Precision F-score
MultiGeMS 615 349 0.8628 0.7364 0.7946
VarScan 636 082 0.8608 0.7108 0.7787
SAMtools 654 780 0.8684 0.6966 0.7731
FreeBayes 666 385 0.8508 0.6706 0.7500
GeMS-pooled 410 884 0.5994 0.7662 0.6726
GATK 946 836 0.8802 0.4883 0.6282
GeMS 918 512 0.8818 0.5042 0.6416

 

The results are sorted in descending order of F—score.

MultiGeMS SNV calling time. This, however, comes at a cost of
using more memory. In particular, though GATK on 4 threads can
complete the SNV calling in about 3 h, 11 GB of RAM are utilized.
The performance of MultiGeMS on four threads seems more reason—
able, especially for computers with limited RAM, requiring less than
3.5 h and much less RAM.

Given these results, it is expected that modern high—performance
computers will have no difficulties in performing the SNV calling
procedures described in Section 3. For computers with limited re—
sources, multiple sample SNV callers based on C/C ++, especially
MultiGeMS and FreeBayes, will be especially efficient.

4 Discussion

Since each genomic site is considered independently in the
MultiGeMS likelihood, analysis of each site can be parallelized for
simultaneous computation. Therefore, we have utilized parallel
computing based on the multi—core CPU framework (OpenMP tech—
nology, GNU C/C ++) for increased procedure performance.

The MultiGeMS software package currently supports the input
of the SAMtools pileup alignment format (http://samtools.source
forge.net/pileup.shtml) and will soon support SAM/BAM alignment
files (Li et al., 2009). For more information on filtering SAM/BAM
files before converting to SAMtools pileup files, please see the PDF
document entitled ‘Filtering Alignment Files’ (https://github.com/
cui—lab/multigems).

The MultiGeMS algorithm can be expanded to call other types
of variants, such as insertions and deletions, by extending the usage
of the N variable in the existing framework. This area of investiga—
tion would need to consider the impact of utilizing the base—call
quality scores when calling indels or other variant types, as com—
pared to SNVs. For users currently desiring an indel calling analysis,
procedures such as FreeBayes, GATK, SAMtools, VarScan or
DINDEL (Albers et al., 2011) are available and can be added to an
analysis pipeline. Likewise, procedures are available for the detec—
tion of other types of variation, such as copy number variation.

ﬁm'sreumol‘prqxo'sopeuuowtotq/ﬁdnq

1492

G. H. Murillo et al.

 

Table 10. Computational resources used by SNV callers running on a single thread

 

 

FreeBayes MultiGeMS GeMS GeMS-pooled GATK VarScan SAMtools
Pre-processing CPU Time (min) NA 54 54 283 NA 631 NA
Procedure CPU Time (min) 464 508 572 380 792 650 1493
Total CPU Time (min) 464 562 626 663 792 1281 1493
Average Pre-processing Memory (MB) NA 50 50 564 NA 57 NA
Maximum Pre-processing Memory (MB) NA 5 1 5 1 1 1 00 NA 57 NA
Average Procedure Memory (MB) 73 22 2775 2709 8050 1852 90
Maximum Procedure Memory (MB) 91 27 5600 5700 9100 2000 91

 

These ﬁgures are from the human chromosome 22 analysis in Section 3.2. The results are sorted in ascending order of total CPU time in minutes.

Acknowledgements

The authors are grateful to the referees and associate editor. They also thank
the Institute for Integrative Genome Biology for providing the bioinformatics

cluster.

Funding

This work was supported by the National Science Foundation [ATD—
1222718 to G.M., W.C., X.C.], the University of California, Riverside [AES-
CE RSAP A01869 to G.M., W.C., X.C.]; R01HG113147 [to MP. R., M.L.];
the National Science Foundation of China [NSFC 11301554 to N.Y., NSFC
61103167, 31271410, 31401076], the Ministry of Science and Technology
[high-tech (863) grant 2012AA023107, 2014AA021502]; the Sine—German
Research Center [GZ878]; and the Huazhong University of Science and
Technology [start-up fund to X.S., K.N.].

Conﬂict of Interest: none declared.

References

1000 Genomes Project Consortium, Abecasis,G.R., Altshuler,D. et al. (2010).
A map of human genome variation from population-scale sequencing.
Nature, 467,1061—1073.

Albers,C.A. et al. (2011) Dindel: Accurate indel calls from short-read data.
Genome Res., 21, 961—973.

Barnett,D. et al. (2011) BamTooIs: a C ++ API and toolkit for analyzing and
managing BAM ﬁles. Bioinformatics, 27, btr174—bt1692.

Consortium,T.G.P. (2012) An integrated map of genetic variation from 1,092
human genomes. Nature, 491, 56—65.

DePristo,M.A. et al. (2011) A framework for variation discovery and
genotyping using next-generation DNA sequencing data. Nat. Genet., 43,
491—498.

Garrison,E. and Marth,G. (2012) Haplotype-based variant detection from
short-read sequencing. arXiU preprint arXiv:1207.3907 [q-bio.GN].

Koboldt,D.C. et al. (2012) VarScan 2: somatic mutation and copy number al-
teration discovery in cancer by exome sequencing. Genome Res., 22,
568—576.

Le,S.Q. and Durbin,R. (2011) SNP detection and genotyping from low-cover-
age sequencing data on multiple diploid samples. Genome Res., 21,
952—960.

Li,B. et al. (2012) A likelihood-based framework for variant calling and de
novo mutation detection in families. PLoS Genet., 8, e1002944 +.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with
Burrows—Wheeler transform. Bioinformatics, 25, 1754—1760.

Li,H. et al. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinformatics, 25, 2078—2079.

McKenna,A. et al. (2010) The genome analysis toolkit: a MapReduce frame-
work for analyzing next-generation DNA sequencing data. Genome Res.,
20,1297—1303.

Muralidharan,O. et al. (2012) A cross-sample statistical model for SNP detec-
tion in short-read sequencing data. Nucleic Acids Res., 40, e5.

The International HapMap 3 Consortium. (2010) Integrating common
and rare genetic variation in diverse human populations. Nature, 467,
52—58.

You,N. et al. (2012) SNP calling using genotype model selection on high-
throughput sequencing data. Bioinformatics, 28, 643—650.

ﬁm'sreumol‘prqxo'sopeuuowtotq/ﬁdnq

