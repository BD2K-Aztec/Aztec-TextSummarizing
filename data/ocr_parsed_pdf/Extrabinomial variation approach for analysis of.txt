BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Extra-binomial pooled sequence analysis

 

E
E

 

 

 

 

A CO A (’0
“<2 “9
f, N f, (\l
(D (D
O O
C C
.9 .— g ._
g g

C O

0 2000 6000 0.0 0.2 0.4

Mean Depth Minor Allele Frequency

Fig. 1. Variance analysis of the SNPs detected in Nejentsev et al.’s article.
(a) Variancemean depth comparison. Variance of depth increases with
mean depths. (b) Variance of depth can be extreme, particularly for low
minor allele frequency

this approach is obvious: meaningful parameters and a comput—
able likelihood which could be maximized by standard methods
to calculate the relating parameters. However, maximizing a
beta—binomial likelihood can be computationally difﬁcult.

An alternative is to use a model in which only the first two
moments are defined. We propose to use and extend such an
extra—binomial model originally described by Williams (1982).
The extra—binomial model still assumes the allele counts obey a
binomial distribution within pools and also takes the
between—pool variance into consideration. In this article, we
compare the performance of statistical tests assuming simple
binomial variation, Williams’ extra—binomial variation and our
modiﬁed extra—binomial model using quantileiquantile (QiQ)
plots. We also extend our study beyond the original minor
allele frequency (MAF) range used by Nejentsev et al. (173%)
to include all observed single—nucleotide variation.

2 METHODS

2.1 Experimental data pie-processing

The experimental data used for the following analysis were drawn from
the article by Nejentsev et a]. (2009). The sequencing data were processed
using existing software or R (R Development Core Team, 2010) as
described below. BWA-SW (Li and Durbin, 2010) was used to align
query 454 sequences to the NCBI36 human assembly, yielding sam files
which were processed by SAMtools (Li et al., 2009) to remove duplicate
reads. SNPs were identiﬁed and counted by VarScan (Koboldt et al.,
2009), ﬁltered by minimum base quality (:25) and minimum total read
depth (:8).

In the absence of a variant, errors should randomly distribute across
multiple pools while for a genuine rare variant excess reads of the alter-
native allele are expected to concentrate in one or several pools. Thus, to
distinguish the errors from the true SNPs, we ﬁrst excluded the common
variants with MAF>0.05 and then compared the observed pool read
distribution for each remaining rare SNP to that expected under a null
hypothesis of random errors only (Bansal, 2010). We assumed variants to
be true rare SNPs if (i) they were not consistent with a random error
model with a signiﬁcant P-value less than 10’4 (Bonferroni correction
with a prior significance level equal to 0.05) and (ii) there was at least one
pool with more than two reads for the minor alleles.

For the binomial model only, SNPs and pools were further ﬁltered by
chromosome coverage~only pools with more than 80% probability to
cover (include at least one read from) at least 80 out of 96 chromosomes
were used. This reduced the variation between different pools by dropping

pools with poor PCR or sequencing quality. SNPs were dropped if there
were no valid pools for one group (case or control) at a position.

2.2 Statistical models

Our aim is to identify the SNPs that are associated with TlD status. We
deﬁne an observation as a success if it corresponds to the major allele,
otherwise it is a failure. Let 6} and 6? denote the expected major allele
frequency for SNP i in control and case chromosomes, respectively. Then
our hypothesis is written as

H0: 9} :91.2 (1)

H“ : 9} 7A 9?. (2)

In the following models, we assume there is no systematic error in the
sequencing.

2.2.1 Binomial variation For signiﬁcance testing, Nejentsev et al.
(2009) assumed a simple binomial model within pools, estimated overall
allele frequencies by treating each pool equally and used these estimated
allele frequencies to estimate chromosome counts of each allele. Allele
counts were compared in case and control groups in a 2 X 2 table at
each SNP by Fisher’s exact test (see Section A of the Supplementary
Material).

2.2.2 Williams’ extra—binomial variation model (E81) We can
relax the assumptions above by considering an over-dispersed binomial
model. Here, we applied an extra-binomial model proposed by Williams
(1982) to our data. With the assumption that the variation within each
pool is binomial unchanged, we introduce a continuous variable Pi]- as the
allele frequency of SNP i in pool j to reﬂect the discrepancy between
different pools in allele frequency. Pi]- is independently distributed on
(0,1) and its ﬁrst two moments are deﬁned as

E(Pij) = 9i (3)

Var(P,»J-) =  — 9i), ¢i Z  

As shown below, the variance is over-dispersed when ¢i>0.
Conditionally, in pool j when Pg- :17”, the number of reads of the
major allele Ril- follow Bin(D,»J-,p,»j) where Di]- is the depth of the j—th
pool at the i-th SNP and pi]- is estimated by le/Dij. Unconditionally,
deriving from Equation (4), the variance of Rij/DU- can be written as

 

1 DZ“ — l
i]

1 ’j (5)
Z 91“— 61%; + $2)-
2]

Thus, the extra-binomial model allows for between-pool variation by
scaling the variance by a heterogeneity factor, 1 + ¢iD,»1-, which increases
with read depth. We could choose a speciﬁc distribution for Pi]- such as
the beta-distribution which could induce R]- to follow a beta-binomial
distribution (Zhou et al., 2011). Instead, we adopt a quasi-likelihood
approach and follow Williams’ method to yield an estimator of allele
frequency, 6A,», by ﬁrst ﬁtting it into a logistic linear model and then max-
imizing the quasi-likelihood by weighted least square iteration
(see Section B of the Supplementary Material). The weighted sum of
squares of residuals yields the goodness of ﬁt statistic

X%= z [wl(R.,-—D..é;)2/{Dlé;(l—é;)}]

je (control)

. z  all

jelcasc}

(6)

 

2899

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

X.Yang et al.

 

where the weight wil- = {1 + ¢i(D,»j — 1)}’1. To test the signiﬁcance of H0,
we tested the increase in X? when deleting the case-control factor as
suggested by Williams. This is distributed as a x2 variable with one
degree of freedom under the null hypothesis of no association.

2.2.3 Modified extra—binomial model (EB2) In Williams’ extra-
binomial model, the parameter Q» is speciﬁc to each SNP, which makes it
difﬁcult to estimate ¢i accurately given only 20 data points for each SNP.
In contrast, we have many SNPs. We adopted two universal parameters a
and I; here instead of Q» to scale the variance, such that
a b
Vanni/Di) = 9.0 — e.)(— +—), (7)
S 
where s is the number of distinct chromosomes sampled in one pool,
namely, 96 in this study. Ideally with no other over-dispersion, as
Di]- —> oo,Var(R,»j/D,»j) —> 6,»(1 — 6,») - l/s. However, sequencing errors
and additional variation described earlier mean a 7A 1. We write

[7 fl
0;]. =  + 13—) (8)

11
and by comparing Equation (7) with a standard binomial variance func-
tion, we see that Dl’.j may be interpreted as the adjusted depth of pool j for
SNP 1’.
Considering the quantities of this model,

1 RI“ A 2
 = n ﬂ <_J _ 91.) a 
n 4941—9.) Dz;-
where n is the number of pools, namely, 20 in this study, should have
expectation [see Equation (5) in the Supplementary Material]:

b
192205129 —, 1
('11) l, S +Dij ( 0)

 

We therefore estimate the parameters a and b by linear regression of on
1 /D,»j, yielding a/s as the intercept and l; as the slope.

Given the interpretation of Dl’j as an adjusted depth, the allele counts in
poolj were estimated as Ry-(Dl’j/Dij) and (Di!- — Rij)Dl’j/D,»j. These were
summed over case and control pools to form a 2 X 2 table on which a x2
test was performed to test the signiﬁcance of H0.

2.2.4 Accounting for sequencing error To examine the potential
inﬂuence of sequencing errors on the models, a base-speciﬁc error rate,

amt = P(called allele 2 a’ltrue allele 2 a), a, a’ e (A, T, C, G) allele
(11)

where allele a is the reference allele and allele a’ is the alternative allele
was estimated by summing allele counts over all positions in our target
sequence that were either not called as SNPs by VarScan or failed sub-
sequent filtering.

We used these estimated error rates which were of the order 1710
errors per 100 000 bases (see Supplementary Table S1) to adjust read
counts of the major allele and ﬁtted all models to the adjusted read counts

 =  _ 8a’.u)Rij _ 8a’.u(Dij _  

1 _ 841’.“ _ 841.41’

2.3 Simulation studies

To further evaluate the statistical performance of our models, a series of
simulation studies were carried out and both Type 1 error and power
under various situations were examined. The sample size was set as 500
cases and 500 controls divided into 20 pools of 50 people. The allele
counts of SNP i in pool j per person were assumed to follow a gamma
distribution with shape or = 6.3 and scale )3 = average coverage/oz (Sarin
et al., 2008), where the average coverage per person was set at 40><.

We simulated three sets of 700 SNPs in each dataset (i.e. 2100 in total).
The ﬁrst was a set of ‘null’ SNPs, with MAF = 0; the second was a set of
‘neutral’ SNPs, with MAF in controls ranging from very rare
(MAF=0.005) to common (MAF=0.5) and equal MAF in cases; the
third was a set of ‘disease’ SNPs, with MAF in controls again ranging
from 0.005 to 0.5 and in cases determined according to the control MAF
and assuming a multiplicative genetic with an allele relative risk (rr) set at
1.5. As we specify our model with rr, we do not need to deﬁne the
population disease rate. However, for a rare disease such as TlD, the
rr is approximately equal to the odds ratio. A range of symmetric error
rates (the chance of calling the alternative allele in error) from 0 to 5%
was considered and applied to simulated data assuming a binomial dis-
tribution. We blinded the analysis to which SNPs were truly ‘null’ and
applied the same analysis as described above for the 454 data to identify
false SNPs. From these we estimated the error rates and corrected the
read counts of the remaining SNPs according to Equation (12).

We performed a total of 1000 simulations in this manner, and Type 1
error rates and power were estimated from the results for the ‘neutral’ and
‘disease’ SNPs, respectively.

3 RESULTS

3.1 Simulation studies

The first two moments of our simulated data were examined,
resulting in a mean sequence depth of around 1950 reads per
pool and variance of 12026.

Figure 2 shows estimated Type 1 error rates and power from
our simulated data at a significance level a = 0.01. Overall, the
EB2 model maintains good control of Type 1 error, across allele
frequencies and error rates although tends to be conservative for
rare SNPs (MAF<0.02). On the other hand, under Fisher’s
exact test, nominal Type 1 error rates may be exceeded by a
factor of nine. Note that Fisher’s test is anti—conservative in
this situation, in contrast with the typical behaviour of
non—parametric tests. We found the expected conservative behav—
iour when we simulated under a simple binomial model (data not
shown), so the anti—conservative behaviour shown here appears
to result from the over—dispersion. We can also see that the Type
1 error rate for Fisher’s but not EB2 is affected by the sequencing
error rate. This is likely because our error correction method
does a good job of correcting the simple error on average, but
at the expense of increasing the noise, which is correctly dealt
with by EB2 but not Fisher’s test. Power appears slightly lower
for EB2 compared to Fisher’s, but not substantially so, given the
difference in Type 1 error rate control. Some differentiation in
power can be seen for our EB2 model with changes in sequencing
error rates, with higher error rates having slightly lower power.
However, the effect of sequencing error, once corrected, seems
minimal given the relatively high coverage depth simulated.

3.2 Experimental data

After initial ﬁltering, 473 SNPs were selected for analysis. Our
estimated error rates were of the order of one error per 100 000
bases (see Supplementary Table Sl), consistent with previous
observations (Huse et al., 2007), and had a negligible impact
on association results; only the results without error correction
are shown.

Although we expect many SNPs will be associated with TlD,
given their location in established TlD—associated regions, we

 

2900

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

Seq.
Error (°/o)
0
0.5
1
2
5

Test
- -- Fisher

Seq.
Error (°/o)
0
0.5
1
2
5

Test
 Fisher
— EB2

 

/310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOIq/ﬂduq

:39\Ewowsmoaﬁmowoxmoagoﬁsambwﬁ

Extra-binomial pooled sequence analysis

 

Table 1. Comparison of different approaches on the four SNPs identiﬁed in Nejentsev et al.’s article of which the ﬁrst two SNPs within IFIHI gene were

replicated in their follow-up genotyping experiment

 

 

 

SNP Location Chr. Alleles P-value

Nejentsev’s Fisher’s Our Fisher’s Our EBl Our EB2
rs35337543 IFIHI, intron 8 chr2 G > C 0.000044 0.0032 0.0029 0.016
rs35667974 IFIHI, exon 14 chr2 A>G 0.0049 0.076 0.017 0.011
ss107794688 CLEC16A, intron 23 chr16 C > T 0.016 0.045 0.0047 0.034
ss107794687 CLEC16A, intron 11 chr16 C > T 0.023 0.000046 0.00021 0.000005

 

Since different alignment software and ﬁlters were used, our Fisher’s exact results were slightly different from Nejentsev ct afs. Overall, all the four SNPs still showed

signiﬁcance in our preferred EB2 model (or = 0.05).

Table 2. The SNPs identiﬁed by EB2 model after initial ﬁltering

 

 

 

SNP Gene Alleles MAF P-value OR TlD SNP r2
Control Case Fisher’s EB2
rs3184504 SHZB3 T>C 0.53 0.41 4.74 X 10’7 5.98 X 10’9 0.62 rs3184504 1
rs72650660 CLEC16A C>T 0.043 0.011 4.57 X 10’5 5.01 X 10’6 0.25 7 7
rs8052325 CLEC16A A>G 0.13 0.082 2.2 X 10’3 5.02 X 10’5 0.60 rs12708716 0.26
rs2476601 PTPN22 G>A 0.093 0.15 3.5 X 10’4 1.9 X 10’4 1.72 rs2476601 1
rs3827734 PTPN22 A>T 0.0025 0.020 2.56 X 10’6 1.5 X 10’3 8.14 7 7
rs1800521 AIRE T>C 0.23 0.32 1.08 X 10’5 3.8 X 10’3 1.58 rs760426 0.04
rs11594656 0.0029
rs28360489 IL2RA C>T 0.11 0.084 0.039 8.7 X 10’3 0.74 rs2104286 0.10
rs12722495 0.62

 

OR is odds ratio of minor allele for TlD. r2 is the correlation coefﬁcient with the most associated independent TlD SNPs (marker SNPs that have been identiﬁed associated

with TlD before) in each region (http://www.tldbase.org/page/Regions).

examine the potential for our model to be applied to other tech—
nologies. Because our model only deals with increased variance,
and not systematic bias induced by base calling errors, we under—
take a separate error correction step which should correct the
error in expectation, but may itself increase variance. This can be
seen in the dependence of Type 1 error rate on the sequencing
error for Fisher’s exact test, whereas our model appears to have a
good control of Type 1 error rates across the range of sequencing
errors considered, despite both methods being applied to the
same, error—corrected, data. Note that any estimates of error
rates are likely to be uncertain. Our experience is that the
effect of correcting for a poorly estimated error rate in simulated
data depends on MAF, the magnitude of the true error and how
poorly it is estimated. In the case of our 454 data, we are lucky to
be dealing with low estimated error rates which are consistent
with previous estimates for this technology. Correction for these
estimated error rates made no substantial difference to our con—
clusions. However, if the estimated error rates in other applica—
tions were larger, it might be wise to conduct some sensitivity
analysis, varying the estimated error rate by factors of two or
more, to examine whether associations identiﬁed are robust to
misspecification of error rates.

A shortage of any model used here is the assumption of bino—
mial error within each pool, which allows a zero count for major

alleles. This is in contrast to our SNP detection principle which
requires at least two supporting reads at a position to call a SNP
(i.e. we should model R); ~ Bin(D)~/,p)~/|Rik 3 2; Rik <D,~k — l) for
some k, k e [1, 20]). When we removed our detection criteria and
instead examined all SNPs in dbSNPs version 128 (Sherry et al.,
2001) within our 144 target regions, the GO plot showed further
improvement (Fig. 5b). Additionally, a much smaller maximum
sample quantile was observed in dbSNP Q42 plot, indicating
there are still errors among the full set of 473 called SNPs.

Overall, extra—binomial models appear to have better proper—
ties than the naive binomial model. They could analyse a larger
range of variants with lower or more variant pool depths and our
new EB2 model is more appropriate and easier to apply com—
pared with the EBl model proposed by Williams (1982). Work
such as this is used as the basis for further conﬁrmatory experi—
ments and we intend to follow up the four new SNPs identiﬁed in
Table 2. More accurate results lead to better targeting of these
experiments and thus faster and more efﬁcient progress to iden—
tify the causal genes in TlD.

ACKNOWLEDGEMENTS

The data used in this work were generated by Sergey Nejentsev. I
would like to thank colleagues in the Juvenile Diabetes Research

 

2903

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

X.Yang et al.

 

Foundation/Wellcome Trust Diabetes and Inﬂammation
Laboratory (DIL) for helpful comments on the work and earlier
drafts.

Funding: X.Y. was supported by Human Molecular Genetics
Course in Imperial College London and the Juvenile Diabetes
Research Foundation/Wellcome Trust Diabetes and
Inﬂammation Laboratory (DIL). The DIL is funded by the
Juvenile Diabetes Research Foundation (9—2011—253), the
Wellcome Trust (091157/Z/10/Z) and the National Institute for
Health Cambridge Biomedical Research Centre. The Cambridge
Institute for Medical Research is in receipt of a Wellcome Trust
Strategic Award (079895). DC. is supported by a Wellcome
Trust Principal Research Fellowship (09l388/Z/10/Z) and
CW. is supported by a Wellcome Trust Research Career
Development Fellowship (089989/2/09/2).

Conﬂict of Interest: none declared.

REFERENCES

Bansal,V. (2010) A statistical method for the detection of variants from
next—generation resequencing of DNA pools. Bioiiy’ormatics, 26, i3187i324.
Barrett,J.C. et a]. (2009) Genome—wide association study and meta—analysis ﬁnd that
over 40 loci affect risk of type 1 diabetes. Nat Genet, 41, 7037707.

Cooper,J.D. et a]. (2008) Meta—analysis of genome—wide association study data
identiﬁes additional type 1 diabetes risk loci. Nat Genet, 40, 139971401.

Crowder,M.J. (1978) Beta—binomial ANOVA for proportions. J. Roy. Stat. Soc. C,
27, 34737.

Hunt,D.L. et a]. (2009) The beta—binomial distribution for estimating the number of
false rejections in microarray gene expression studies. Comput Stat. Data Anal,
53, 168871700.

Huse,S.M. et a]. (2007) Accuracy and quality of massively parallel DNA pyrose—
quencing. Genome Biol, 8, R143.

Kim,S.Y. et a]. (2010) Design of association studies with pooled or un—pooled
next—generation sequencing data. Genet. Epidemiol, 34, 4794191.

Koboldt,D.C. et a]. (2009) Varscan: variant detection in massively parallel sequen—
cing of individual and pooled samples. Bioiiy’ormatics, 25, 228372285.

Li,H. and Durbin,R. (2010) Fast and accurate long—read alignment with burrows—
wheeler transform. Bioiiy’ormatics, 26, 5897595.

Li,H. et a]. (2009) The sequence alignment/map format and samtools. Bioinfor—
matics, 25, 207872079.

Marioni,J.C. et a]. (2008) Rna—seq: an assessment of technical reproducibility and
comparison with gene expression arrays. Genome Res., 18, 150971517.

McCullagh,P. (1983) Quasi—likelihood functions. Ann. Stat, 11, 59767.

Nejentsev,S. et a]. (2009) Rare variants of IFIHI, a gene implicated in antiviral
responses, protect against type 1 diabetes. Science, 324, 3877389.

R Development Core Team. (2010). R: A Language and Enviroimient for Statistical
Computing. R Foundation for Smtistical Computing. Vienna, Austria.

Rivas,M.A. et a]. (2011) Deep resequencing of GWAS loci identiﬁes independent
rare variants associated with inﬂammatory bowel disease. Nat Genet, 43,
106671073.

Robinson,M.D. and Smyth,G.K. (2007) Moderated statistical tests for assessing
differences in tag abundance. Bioinformatics, 23, 288172887.

Sarin,S. et a]. (2008) Caenorhabditis elegans mutant allele identiﬁcation by
whole—genome sequencing. Nat Methods, 5, 8657867.

Sham,P. et a]. (2002) DNA pooling: a tool for large—scale association studies. Nat
Rev. Genet, 3, 8627871.

Sherry,S.T. et a]. (2001) dbSNP: the NCBI database of genetic variation. Nucleic
Acids Res., 29, 3087311.

Smyth,D.J. et a]. (2006) A genome—wide association study of nonsynonymous snps
identiﬁes a type 1 diabetes locus in the interferon—induced helicase (IFIHI)
region. Nat Genet, 38, 617%19.

Wang,T. et a]. (2010) Resequencing of pooled DNA for detecting disease associ—
ations with rare variants. Genet. Epidemiol, 34, 4927501.

Wellcome Trust Case Control Consortium. (2007). Genome—wide association study
of 14,000 cases of seven common diseases and 3,000 shared controls. Nature,
447, 661$78.

Williams,D. (1982) Extra—binomial variation in logistic linear models. J. Roy. Stat.
Soc. C (Appl. Stat), 31, 1447148.

Zhou,Y.—H. et a]. (2011) A powerful and ﬂexible approach to the analysis of RNA
sequence count data. Bioiiy’ormatics, 27, 267272678.

 

2904

ﬁm'spzumol‘pmjxo'sopeuuopnorq/ﬁdnq

