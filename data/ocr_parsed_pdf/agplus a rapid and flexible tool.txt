Bioinformatics, 31 (18), 2015, 3046—3047

doi: 10.1093/bioinformatics/btv322

Advance Access Publication Date: 20 May 2015
Applications Note

 

 

Genome analysis

agplus: a rapid and flexible tool for aggregation

plots

Kazumitsu Maehara and Yasuyuki Ohkawa*

Department of Advanced Medical Initiatives, JST—CREST, Faculty of Medicine, Kyushu University,

Fukuoka 812-8582, Japan

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on February 24,2015; revised on April 24,2015; accepted on May 17, 2015

Abstract

Summary: Aggregation plots are frequently used to evaluate signal distributions at user—interested
points in ChlP—Seq data analysis. agplus, a new and simple command—line tool, enables rapid and
flexible generation of text tables tailored for aggregation plots from which users can easily design
multiple groups based on user—definitions such as regulatory regions or transcription initiation

sites.

Availability and Implementation: This software is implemented in Ruby, supported on Linux and
Mac OSX, and freely available at http://github.com/kazumits/agplus

Contact: yohkawa@epigenetics.med.kyushu—u.ac.jp

 

1 Introduction

Aggregation plots are frequently used to convert genome-wide chroma-
tin immunoprecipitation-sequencing (ChIP-Seq) data into a simple curve
of averaged ChIP-Seq signal intensities at user-interested points (anchor
points); such as regulatory sequences (Maehara et (11., 2013).
Aggregation plots allow differences in the signal distribution among dif-
ferent ChIP-Seq data to be assessed intuitively. Many ChIP-Seq data
analysis toolkits include software for the creation of aggregation plots;
including HOMER, bwtools; CGAT; ngsplot and HTSeq (Anders et (11.,
2015; Heinz et (11., 2010; Pohl and Beato, 2014; Shen et (11., 2014; Sims
et (11., 2014). These software are designed to analyze transcription start
sites (TSSs); transcription factor binding sites (TFBSs); exon-intron
structures; etc. For example; ngsplot takes a configuration file of gene
sets with corresponding raw data to produce a visual of different ChIP-
Seq signal distributions at gene loci. More recently; ChIP-Seq applica-
tions have begun to offer diverse purposes for aggregation plots.
However; user definitions of the anchor points required for aggregation
plots are not trivial; e.g. comparisons of the signal distribution of tran-
scription start sites around different gene sets (gene ontology database
or a set defined by their gene expression profile data) or regulatory re-
gions (promoters; enhancers or other non-coding region). Therefore; a
simpler tool for loci definitions and grouping tasks is preferred. Here;
we introduce agplus; a ﬂexible tool designed for the creation of aggrega-
tion plots using various points of user interest.

2 Feature

agplus was implemented in Ruby to calculate the average signal in-
tensity (aggregated signal) around specific anchor points from
ChIPseq data. agplus calculates the average signal intensity of the
‘target’ signal at each ‘reference’ region group as defined by an ‘as-
signment’ table; therefore agplus script requires reference; target
and assignment files. The reference file defines the anchor points
of user interest; e.g. gene loci or regulatory regions. The file should
be in BED6 format (6 columns BED); since the names and strand
information are needed for the calculation. The target file should
be in wiggle or BED format with a scores field. The assignment
file is a simple tab-delimited; two-column text file. The first col-
umn holds the reference name defined in the reference file and the
second column holds an arbitral group name of the references. The
assignment file defines a group of anchor points; e.g. gene loci cor-
responding to gene ontology or gene expression levels against a
RefSeq gene list; which is used as a reference file. The assignment
file is therefore what gives the benefits of agplus. The output file is
a tab-delimited text table of averaged signal intensities in each
group per 1 base pair. The output file can be easily handled in sub-
sequent analysis using gnuplot; R; Matlab MS Excel; etc. The fast
processing time of agplus comes from bedtools (Quinlan and Hall,
2010); which agplus internally uses to calculate overlaps between
the target and reference files.

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3046

/310‘sleumo[p10}xo‘soueuHOJIItotq/ﬁdnq

zero
thc10th

q 1 OthOth
q20t030th
q30t040th
q40t050th
q50t060th

q60tc70th
q70t080th
q80t090th
q90to100th

 

Trapnell at £11., 2012

Figure 1

Li et 41., 2009
Kent at £11., 2010

Li et 41., 2009

Mortazavi at £11., 2008

Figure 1

/810'S[Eumo_fp10}xo'satJEuIJogutotq/ﬁduq

