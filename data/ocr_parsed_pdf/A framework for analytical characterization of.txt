ORIGINAL PAPER

Vol. 27 no. 19 2011, pages 2746-2753
doi:10. 1 093/bioinformatics/btr468

 

Data and text mining

Advance Access publication August 16, 2011

A framework for analytical characterization of monoclonal
antibodies based on reactivity profiles in different tissues
Elizabeth Bossinlaeal, Tsung—I Lin2’3’T, Hsiu J. H04, Steven J. Mentzer5

and Saumyadipta Pyne6a7a*

1Health Sciences and Technology, Harvard Medical School, Boston, MA 02115, USA, 2Department of Applied
Mathematics and Institute of Statistics, National Chung Hsing University, 3Department of Public Health, China
Medical University, 4Department of Statistics, Tunghai University, Taichung, Taiwan, 5Laboratory of Adaptive and
Regenerative Biology, Brigham and Women’s Hospital, Harvard Medical School, Boston, MA 02115, 6Broad Institute
of MIT and Harvard University, Cambridge, MA 02142 and 7Department of Medical Oncology, Dana—Farber Cancer

Institute, Harvard Medical School, Boston, MA 02115, USA

Associate Editor: Jonathan Wren

 

ABSTRACT
Motivation: Monoclonal antibodies (mAbs) are among the most
powerful and important tools in biology and medicine. MAb
development is of great significance to many research and clinical
applications. Therefore, objective mAb classification is essential for
categorizing and comparing mAb panels based on their reactivity
patterns in different cellular species. However, typical flow cytometric
mAb profiles present unique modeling challenges with their non-
Gaussian features and intersample variations. It makes accurate mAb
classification difficult to do with the currently used kernel-based or
hierarchical clustering techniques.
Results: To address these challenges, in the present study we
developed a formal two-step framework called mAbprofiler for
systematic, parametric characterization of mAb profiles. Further, we
measured the reactivity of hundreds of new antibodies in diverse
tissues using flow cytometry, which we successfully classified using
mAbprofiler.

First, mAbprofiler fits a mAb’s flow cytometric histogram with
a finite mixture model of skew t distributions that is robust
against non-Gaussian features, and constructs a precise, smooth
and mathematically rigorous profile. Then it performs novel curve
clustering of the fitted mAb profiles using a skew t mixture of non-
linear regression model that can handle intersample variation. Thus,
mAbprofiler provides a new framework for identifying robust mAb
classes, all well defined by distinct parametric templates, which
can be used for classifying new mAb samples. We validated our
classification results both computationally and empirically using mAb
profiles of known classification.
Availability and Implementation: A demonstration code in R
is available at the journal website. The R code implementing
the full framework is available from the author website —
http://amath.nchu.edu.tw/www/teacher/tilin/software
Contact: saumyadipta_pyne@dfci.harvard.edu
Supplementary Information: Supplementary data are available at
Bioinformatics online.

 

lThe authors wish it to be known that. in their opinion. the ﬁrst two authors
should be regarded as joint First Authors.
*To whom correspondence should be addressed.

Received on March 22, 2011; revised on July 21, 2011; accepted on
August 7, 2011

1 INTRODUCTION

Monoclonal antibodies (mAbs) are among the most powerful,
popular and important tools in a biomedical laboratory for probing
different cellular types, states and functions. Research in the past
decades has led to the development of large collections of mAb
for speciﬁc binding to cell surface antigens, which facilitated
puriﬁcation and functional Characterization of a variety of cell
populations. It also unlocked the great potential of using mAb for
therapy in many serious diseases such as cancer. Using platforms
such as ﬂow cytometry, one can measure quantitatively the binding
of a mAb, in single cell resolution, to the corresponding antigen
whose expression may serve as a marker of cellular Characteristics
for a given specimen, see Herzenberg et al. (2001). Therefore, it is
important to Characterize mAb reactivity patterns in different cell
types and tissues with analytical precision and rigor so that both
known and new mAb can be categorized and compared accurately
and objectively.

MAb Classiﬁcation is of great practical importance to many ﬁelds
in biomedicine such as immunology, hematology, pathology and
Clinical immunotherapy. Large-scale attempts at analyzing mAb to
identify new molecules were pioneered in the human leukocyte
differentiation antigens (HLDAs) workshops [see review in Zola
and Swart (2005)] where the reactivities of large panels of mAbs
were measured against widely available cell lines. The reactivity was
given a binary assignment compared with a negative control—either
the antibody bound to its antigen on a given cell or it did not—as
measured by ﬂuorescence intensity. The frequency with which this
occurred over a cell population was then recorded, and hierarchical
Clustering was employed to group similar reactivity— thus was born
the ‘Clusters of Differentiation’ (CD) Classes, widely used today to
identify various cell populations (Bernard and Boumsell, 1984).

In recent years, the workshop approach for identifying new
molecules to deﬁne cell types has become less applicable due
to the current capabilities of molecular identiﬁcation at gene
level (Zola and Swart, 2005). An alternative approach for mAb
Characterization involves the use of primary cell populations that

 

2746 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 ﬁlo's[BumoprOJXO'soiwuiJOJuioiq”:duq 11101} papBOIII/IAOG

91oz ‘0g1sn8nv uo ::

MAb classification

 

are derived systematically from different tissues in selected species
(e.g. Pratt et (11., 2009). Typically, mAb reactivity patterns, as
measured with cytometric density histograms, can present jagged
non-smooth curves with features in the form of peaks and
shapes that are difﬁcult to Characterize analytically. Intersample
variation in cytometric data makes the modeling problem even
more Challenging. Not only do these make accurate binary percent
positive/negative calls harder but also render ineffective the current
Clustering approaches that are poorly suited to model or Classify such
noisy curve proﬁles.

In general, analytical Characterization of mAb reactivity patterns
has received limited attention in statistics and computer science
(Gilks and Shaw, 1995; Kim et (11., 2002; Pratt et (11., 2009;
Salganik et (11., 2005; Spiegelhalter and Gilks, 1987; Zeng et (11.,
2002, 2007 and references therein). As shown in Pratt et (11.
(2009), mAb Classiﬁcation faces technical Challenges at multiple
levels. Single parameter ﬂow cytometric histograms used for
measuring mAb reactivity often have multiple peaks with non-
Gaussian features and irregular shapes. Few of the known algorithms
can model the underlying distributions and their key features
precisely and robustly. In addition, due to cytometric platform
noise, the measurements of peak features tend to vary in terms
of both signiﬁcance and location, making direct comparison of
samples Challenging. Moreover, standard Clustering approaches
meant for multivariate points, such as hierarchical Clustering, are
not well suited for grouping curves, which in this case represent
histogram proﬁles. Histogram proﬁles, when viewed as points, can
vary considerably with different Choices of binning parameters,
producing jagged patterns. Hence, a new Clustering approach is
necessary that can robustly detect the Characteristic features lying
within every mAb’s noisy curve proﬁle, which is not merely a
multivariate point. Simultaneously, the approach must also account
for the cytometric intersample variation among the curve features
across mAb proﬁles to achieve accurate Classiﬁcation.

To address these Challenges, in the present study we generated
(i) new data for a large collection of mAb; and (ii) developed
mAbproﬁler, a new general framework to Characterize and Cluster
mAb proﬁles systematically and rigorously. More than 1000
subcloned murine hybridomas, made against sheep cell membrane
antigens, were considered for analysis. A subset of mAbs were
selected for inclusion in this study based on their distinctive staining
proﬁle and surface expression in six diverse tissues (splenocytes,
lymph node cells, alveolar macrophages, efferent lymphocytes, fetal
thymus and thymocytes). Further, in mAbproﬁler, we present a two-
step framework based on new parametric modeling algorithms. In
the ﬁrst step, it proﬁles every mAb deﬁned by its ﬂow cytometric
histogram with a ﬁnite mixture model of skew t distributions that
is robust against both outliers and asymmetry, which are often
responsible for producing non-Gaussian features. An Expectation—
Maximization (EM) algorithm is used for ﬁtting every pattern
with a smooth and mathematically rigorous proﬁle that speciﬁes
all key features precisely, with the help of a probability density
function. In the second step, for each tissue, mAbproﬁler performs
curve Clustering of the ﬁtted mAb proﬁles with a novel of skew
t mixture of non-linear regression model that is robust against
intersample variation. We used an effective criterion, the Jump
Statistic, for model selection with the optimal number of Clusters
(or mAb Classes). In addition to these robust tissue-speciﬁc mAb
Classes, our framework uncovered new group structures among

proﬁles undetected by traditional approaches like hierarchical
Clustering. Importantly, mAbproﬁler also generates Class-speciﬁc
parametric signatures that can be used for (i) comparing and
categorizing mAb Classes and (ii) Classifying new mAb panels.
Finally, we validated our Classiﬁcation results for different tissues
both computationally and empirically using mAb proﬁles of
previously known Classiﬁcation.

2 MATERIALS AND METHODS

MAb production ana1 sample generation: we followed the system of mAb
cloning and harvesting using protocols developed in our lab and described
in Li et a1. (1995), Pratt et a1. (2009) and references therein. The panel of
antisheep mAbs were tested for reactivity against six different sheep tissues:
splenocytes, lymph node cells, alveolar macrophages, efferent lymphocytes,
fetal thymus cells and thymocytes. The cells were washed and ﬁxed before
they were analyzed with an Epics XL ﬂow cytometer (Beckman Coulter,
Miami, FL, USA). After quality control by human expert inspection, we
generated 561 mAb reactivity patterns categorized by tissue: spleen, lymph
node, lung lavage, bone marrow, fetal thymus and thymocytes. The ﬁtted
mAb proﬁles are available from the authors upon request.

Cytometric data preparation: each ﬂow cytometric sample was
represented as a three-column matrix, where columns contained forward-
scatter, side-scatter and the ﬂuorescence intensity for a particular ﬂuorophore
tagged antibody, and each row represented a single cell (or event). The data
were preprocessed to remove debris and dead cells. In all, 98% of the data
consisted of experiments where 10000 events were captured. After log10
transformation of the data, we performed multistep cleanup and ﬁltering:
ﬁrst, we removed points from samples whose maximum intensity value was
populated by >25% of cells. Such spikes are signs of poor calibration during
data acquisition. Second, we ﬁltered zero ﬂuorescent values which might
also represent possible calibration problems. Finally, we removed extreme
outliers in data (points more than 3 SDs away from the sample mean) that
are most likely due to platform noise. After ﬁltering, the median number of
events for each sample was ~9390.

Step 1 of mAbproﬁler (histogram proﬁling): after ﬁltering, the resulting
histogram of each antibody’s ﬂuorescence intensity was ﬁtted with a ﬁnite
mixture model of univariate skew t distributions using an EM algorithm
described in Supplementary Material. Since Bayesian Information Criterion
(BIC) is known to select restrictive models which may be inadequate for
feature detection in our non-smooth data, we instead used the well-known
Integrated Completed Likelihood (ICL) criterion for our model selection
(McLachlan and Krishnan, 2008). ICL scores for optimal models showed no
further improvement for most samples beyond 10 components, which was the
maximum number of components ﬁt by the mixture model. Figure 1 shows a
sample histogram and the ﬁtted proﬁle with a gray curve. Clearly the optimal
model produced a smooth and accurate proﬁle, and all the signiﬁcant features
and their locations are captured and speciﬁed by the model parameters. Since
the model is a univariate version of (Pyne et al., 2009) approach, we have
described it along with its EM algorithm in the Supplementary Material for
completeness.

Step 2 ofmAbproﬁler (proﬁle clustering): here we present a new and robust
model-based curve clustering approach using skew t mixture of non-linear
regression model. The model along with the EM algorithm for clustering of
the mAb proﬁles (which were ﬁtted in Step 1) are described below.

Following Azzalini and Dalla-Valle (1996), a random vector Z is said
to follow the multivariate skew normal (MSN) distribution, denoted by
Z~SNp(u, 2,1), if its density takes the form

f(z>=2¢p(ziu. >:><I>(AT>:“/2(z—u>>.

where ¢],(z|u,2) denotes the pdf of p-Variate normal distribution with
mean vector 2 and covariance matrix 2, <1>(-) represents the cdf (short
for cumulative distribution function) of the standard normal distribution

 

2747

112 ﬁlo's[BumoIpJOJXO'soiwuiJOJuioiq”:duq 11101} papeolumoq

91oz ‘0g1sn8nv uo ::

E.Rossin et al.

 

 

 

 

 

 

7x
“2
H
>:
’3 0.
g H
OJ
D
we
0
O m
o l l l l l
2.0 2.5 3.0 3.5 4.0

Log of ﬂuorescence intensity

Fig. 1. Proﬁling of a mAb reactivity against the surface of sheep cells: a
cytometric histogram measuring the reactivity of a particular mAb tested
against the surface of sheep efferent lymphocytes is shown as log of
ﬂuorescence intensity of surface expression. In Step 1 of mAbproﬁler, the
surface expression pattern is proﬁled with a skew t mixture model as depicted
by the smooth and precisely ﬁt gray curve. It captures non-Gaussian features
such as skewness and outliers common in cytometric distributions. For the
original non-smooth pattern, see Supplementary Figure S 1.

and 2‘1/2 is the square root matrix of 2‘1 satisfying 24/224”: 2“.
If X = 0, then the distribution of Z reduces to N],(u, 2).

For the ease of theoretical and computational developments, Arellano-
Valle et al. (2005) gave the following stochastic representation for the MSN
distribution:

z=it+>:‘/2[6IU0|+(I,,—66T>‘/2U1]. U0 1 U1. (1)

where 8=l/\/1+1Tl, U0~N(0,1), U1~Np(0,lp) and the symbol ‘J.’
indicates independence.

The multivariate skew t (MST) distribution was proposed by Azzalini and
Capitaino (2003), which is related to the MSN distribution as follows:

Y=u+r_l/2Z, lie, (2)

where Z~SNp(0, 2,1) and r~Gamma(v/2,v/2). It follows from (2) that
Y| r~SNp(u, 2/1’, 1). By Proposition 1 of Lin et al. (2007), integrating out
I from the joint density of (Y, 1') yields the marginal density of Y

+
f(Y)=21p(Y|m2:v)T(lT2_l/2(Y-M),/ L: Iv+p). (3)

where t],(-|u, 2,12) denotes the pdf of p-Variate t distribution with
location vector a, scale matrix 2 and degrees of freedom (df) we
(0,00); T(-|v) represents the cdf of Student’s t-distribution with df v and
A=(Y—u)T2‘l(Y—u). We shall denote Y~ST,,(,t,z,i,v) if Y has
density given in (3).

Suppose we have a set of m input proﬁles {yj 1 and each response vector
yj consists of nj- consecutive observations. We assume the response vector
yj e R” is generated from

 

yj=M(ﬂvxj)+5j; Oily-mm).

where )3 is a p X 1 vector of regression coefﬁcients related to design matrix
Xj = [in ---xjn,lT With Xjk =(Xjk1 v ---vxjkp)T; It} EMﬂwxj) is a VCCtOF'Valued
non-linear (differentiable) function of )3 governing within-proﬁle behavior,
and E]- is the resulting error vector equal to the discrepancy between yj and 111-.

A skew-t based non-linear regression model is deﬁned by assuming
5]- ~ Stn/(0, 21311312). Depending on the context, various assumptions should
be made on 2]- and l]- to reduce the number of parameters to be estimated.
Following De la Cruz (2008), we set 2]- : 021 "I. to reﬂect the assumption of
exchangeable errors among individuals and l]— :Alnf, where 1”]. is an nj X 1

unit vector for ensuring an identiﬁable model. In some circumstances, it is
quite common to assume a time series like dependence structure for D,
which is a function of a small number of free parameters and depends on j
only through its dimension nj. Note that the skew t can be reduced to the
following particular models that enhance the ease of implementation: the
skew normal (v—> 00), Student 's t (A—> 0) and the most common normal
(A —> 0:12 —> 00) models.
From (2), it can be veriﬁed that

AV}

.I’j IU/jvfj) N Nn<ﬂj+U+—Wlnfi

2
U
7tln+tzlt,1T>—‘).

n.
l
l

U2 2
yjirj ~ TN(0,—T_ (1+njx );(0,oo)),
]

v v
if N F65)- (4)
Applying Bayes” rule yields
02
J/j|(rj.y,-) ~ TN(A,-.—_;(0.oo>). (5)
T]

1/2 _
<1>(r]. o 1A,)

f(TjI)’j) = 

 

v+n- v+o_2A-
’  (6)

X r- ,
g( 1 l 2 2
where Aj=5;sj, Ajzkllsj and er]- =Aj[(v+nj+r)/(ozv+Aj)]l/2.
According to (5) and (6), it sufﬁces to compute the following conditional
expectations:
v+n-—2 -1/2
E - . = A- 
(nlyj) 1+0 v+o—2Aj
t(c_2,j|v+nj—2)
T(coj|v+nj)
v+nj T(czj|v+nj+2)
v+o—2Aj T(coj|v+nj)
E(Tj1/jlyj) = AjE(Tj ij)

v+nj 1/2 t(coj|v+nj)
+a(_,) —.
v+o— AJ- T(coj|v+nj)

E(1']'Iy]') =

Etrjyf 0,) = a2+A,-E(r,-y,-ir,-.y,->. (7)

where t(-|v) is the pdf of the Student’s t-distribution with df 12.

Finite mixture models are commonly used for model-based clustering
(Banﬁeld and Raftery, 1993; McLachlan and Basford, 1988). Let a curve
proﬁle be given by a sequence yj of observations at nj- (time) points x]-
and assumed to be generated by one and only one cluster (i.e. a mAb
class). Then our goal is to partition {yJ-}}":l into g homogeneous groups (or
classes). For notational convenience, let [1,]- =u(}3i,xj), eij =yj —u,»]-, AU- 2
Ailgeij, AU- :egeij and en»!- =Aij[(vi+nj +r)/(oi2vi+ Ail-HI” for i=1,...,g
andj=1,...,m. Deﬁne

1% (Vt Ixj~9i1 =21"; (yjlﬂijﬂflmvvilT(00ijIVi+njl~

the density of a cluster-speciﬁc skew-t non-linear regression model that
relates (yj,xj) to 9,»:(ﬂi,oi2,}ti,vi).
The mixture model for proﬁle clustering is written as:

g
y,- ~Zwm,ty,-Ixj.9i). (8)
1:]

where wi’s are mixing proportions which are constrained to be non-negative
g _ _
and Zi:lwi_1 and 0_(w1,...,wg_1,91,...,9g) represents all unknown

 

2748

112 ﬁlo's[BumoIpJOJXO'soiwuiJOJuioiq”:duq 11101} papeolumoq

91oz ‘0g1sn8nv uo ::

MAb classification

 

parameters. The observed data log-likelihood function of (9 is

N
mam: Ziegfojie) (9)
1:1
In general, there are no explicit analytical solutions for computing the ML
estimator of (9. The EM algorithm (Dempster et al., 1977) is considered as
a standard tool when applied for mixture models. In the EM framework for
supporting the interpretation of incomplete data, it is convenient to introduce
a set of allocation variables Zj=(Z1j,...,Zgj)T,j=1,...,m. The element Zil-
is taken to be one or zero to indicate if yj does or does not come from the i-th
component. This implies that Zj follows a multinomial distribution with 1
trial and cell probabilities w1,...,wg, denoted by Zj ~ M(1;w1, ...,wg).Then,
a hierarchical formulation of (8) obtained in conjunction with (4) is
Aij/jln.
-|( -.r-.Z~=1) ~ N 1(u»-+—’ ,
y] 71 J I] "i U (1+njki2)
2
‘7' 2 T —1
7:11,, +1,» 11,11) 
“i2 2
motel-=1) ~ TN(0.7(1+n,-t,):(0.oo)).
1

Vi Vi
 ~ reg)
Zj ~ M(1;w1,...,wg). (10)
LCU’=0’1v---~J’m)~}'=(V1~---~J/::z)» T=(Tlv---vrttt) and Z:(Zlv"'van)‘
It follows from (10) that the complete data log-likelihood function of (9
given (y,t,Z,y) is

 

EAGIZJHTJ’)
"l g
n-+1 1
= ZZZU:logwi— ’2 logUiz—E|:Tlij+'r2ij:|
1:1 1:1 1
Vi Vi Vi Vi
+(3110g(3)‘10gr(3)+(3)“0gt—Tf>~ “1)

where TW 2 ‘L'J-(yj —uij)T(yj — 110-) and T2,] = r]- [yj —}t,»l;; (yj — [LU-H2.

The EM algorithm proceeds by alternately repeating the E- and M-
steps where, at the k-th iteration, the E-step involves the calculation of the
Q-function, which is the expected value of the complete data log-likelihood

A k
(11) conditional on y and the current estimate (9( ) for (9, is given by

A k A k
Qteie‘ )>=E(ec(0iy,y,r,Z>Iy.0‘ )). (12)
To evaluate (12), the necessary conditional expectations include
A k A k
r;)=E(r,-i--->. K;)=E(logrji--->.
A k A k
yi,)=E(r,-y,-i--->. y§,,)=E(r,-y,?i~->. (13)

a

where the symbol ‘|--- stands for conditioning on Zijzl, YJ- =yj and

(9=(9(k) and they are directly obtainable through using identities (7) and
the law of iterative expectations. Moreover, we deﬁne
A(k) wk)
231>=Pr(z,j=1|y.é(k))=—W’ W’Oiljzﬂ’ ).
f (VJ-l9 )

which is the posterior probability that the j-th curve belongs to the i-th
component evaluated at the (k+1)-st iteration. Therefore, the Q-function
(12) can be written as

m g _
Q(0l(:)(k)) = 222;:>Ilogw.—("J;1)ege

1:1 i2]

(14)

 

_T;[Tl:?(13i)+T213(13i)]+(%)log(g)

l

—10gr<%>+<%>e>—ev}. 

k A k k A k
where T8039: Ej)(yj_uij)T(yj'_uij) and Téij)(ﬂi)=y2ij)_
A k A k
2A,»yf,}1,T/,(v,— — u,»,—)+x§r§j 11; (y,— — up]?
In summary, the implementation of the EM algorithm proceeds as follows:

A k A A A A A , .
E—step: given (9 = (9( ), compute rig-k), 16$), yfg), 1&3.) and zgc), for t: 1,...,g

andj: 1, . . .,n, by using Equations (13) and (14), respectively.
A k 1
M -step: calculating (9( + ) by optimizing (15) over (9, the updating formulae
are given by
k ) 1 Ill 
A< +1 A<
Wi = _ ZZZ} ’

m .
1:]

"l 
A<k+1) . Z" k k
131’ “guy”  £10,) [le?(ﬂi)+,r2ij)(ﬂi):| :7
. a
J

l

 

1:1
A(k)A(k) T A(k+l)
X<k+1> _ Zinzlzij V127 lam—“ii )
i _ A<k)A<k) T A<k+1) 2’
Zj'nzlzij Tij l1n,(Yj—Mij )]
A06) A (k) A (k)
Zj'nzlzij [T117 +T2ij]
A k
Z}’;iz§,)(nj+1>
A k A k k k
,xj) and TED.) and T20.) are Tiiﬁﬂi) and Téiﬁﬂi)
A k A
in (15) with )3,» replaced by  ). Consequently, we obtain v§k+l
the root of the following equation:

Ill
Vi Vi 1 we A<k> A<k>
l0g(3)+l—DG(3)+WE Zij (Kij —Tij )20-
ijlzij j:l

This can be easily done with the help of the R routine ‘uniroot’. The
E- and M- steps are alternately repeated until a suitable convergence rule
is satisﬁed, e.g. the Aitken acceleration-based stopping criterion Wk“)—

A k
Egg—I'm <6, where (“(+1) is the observed log-likelihood evaluated at 9( ),
(k+l)
goo

A2kl
Ui(+)_

A k-I—l A<k+l)
where ME]- )=uij(}3i

) by solving

is the asymptotic estimate of the log-likelihood at iteration k+1
(McLachlan and Krishnan 2008; Chapter 4.9) and e is the desired tolerance.

Model selection for Step 2: let X be a p-dimensional random sample
drawn from a mixture distribution of g components, each with homogeneous
covariance matrix I', and let c1,...,cg be a set of candidate cluster centers
with c, being the one closet to X. Sugar and James (2003) developed an
alternative simple approach to identify the optimal number of clusters based
on the ‘distortion function”, deﬁned as

dig:l min E(X—c,)Tr-1(X—c,), (16)
p c1,...,cg
which is a quantity that measures the average Mahalanobis distance between
X and its closest cluster center c,. The Jump function due to Sugar and James
(2003) is deﬁned as A A
J, =dgc —dg—f,,
where C is an appropriate positive constant that makes a sharp jump at
the true number of clusters and (1g is the minimum distortion obtained by
the clustering algorithms. They have proven that an appropriate number of
clusters can be identiﬁed at the peak of jump based on information-theoretic
ideas. Their simulation studies have also empirically shown that the Jump
plot has good performance in ﬁnding the true number of clusters.

We applied the Jump function approach to the problem of curve clustering
analysis. Each curve is assigned to the component with the largest posterior
probability obtained by ﬁtting model (8) for g=1,...,gmax, a pre-speciﬁed
maximum number of components. We chose gmax to be 12 for all tissues,
except for two (spleen and bone marrow) where the model did not converge
for g > 10. Let g, be the ﬁtted vector of yj if yj has been assigned outright
to i-th cluster, say yj EC). This gives

A Ail/11m
’1 J (1+njxl?)

 

yj'ZUZI’é)lo e
xii/:71”,

= it-+—..
” (1+njA?)

 

2749

112 /Bro's[Burno[prejxosoiwuirquioiqﬂ:duq uiorj papeolumoq

91oz ‘0g1sn8nv uo ::

E.Rossin et al.

 

where ?U=E(]/ijj,Zij=1,(9). Then, the mean squared error for yj EC, is
given by

A 1 A T A
40:;0’1' _yij) U’j -y,»,-)~
1

which is the scaling squared distance from yj to It follows from (16) that
the associated distortion function is empirically deﬁned as

A 1 m ‘ A A A
ng—Z m1n|:A1j,A2j,...,AgJ-:| .

m_
gjzl

Theoretically, the distortion curve, (1g versus g, is always monotone
decreasing. A simple way of choosing the optimal g is to look for the point at
which the magnitude of change in (ig’s becomes negligible, especially when
the subclasses are well separated. However, using the raw distortion curve
could fail in certain cases. As suggested by Sugar and James (2003), the Jump
plot method performs extremely well, provided that some suitable values
for C are chosen. The optimal number of clusters in data can be Visually
determined from the peak patterns on the Jump plot. Empirical studies show
that the point with largest or secondary largest jump is often the best choice.

Quality of curve clustering: to determine the quality of our clustering of
mAb proﬁles, modeled as probability density functions, we measured mean
intra- and intercluster distances using a symmetric form of KullbackiLeibler
distance, denoted by sKL(p,q), between a pair of proﬁles (p,q), deﬁned as
follows:

sKLmq>=(KL(p,q>+KL(q.p>>/2.
where KL(p, q): thtlogzﬁat/qt) at each observation point t.

To determine the quality of hierarchical clustering of mAb data, we used
the R functions hc lus t (with Euclidean distance metric) and asw (average
silhouette width). The R package ks is used for SiZer plot.

3 RESULTS

Following data preparation and preprocessing, in Step 1,
mAbproﬁler modeled cytometric histograms for 561 mAb samples
from six tissues using skew t mixture models. Figure 1 illustrates
how a proﬁle (shown as gray curve) constructed by mAbproﬁler
offers a smooth and precise representation of mAb density
histograms. This can be contrasted with the original cytometric
input in the form of highly non-smooth patterns as shown in
Supplementary Figure S1. To rigorously assess the precision of
modeling with our skew t mixture models (STMIX), we computed
log-likelihood maxima, BIC values, the distances Dn between the
data and the ﬁtted model (based on Kolmogorov—Smimov test) and
CPU times for STMIX as well as for two competing models of more
commonly used mixtures of Gaussian (NMIX) and t distributions
(TMIX), and compared them in Supplementary Table S1. Clearly,
as shown by BIC, mAbproﬁler gives the best ﬁt.

In Step 2, for each tissue, mAbproﬁler clustered the mAb proﬁles,
speciﬁed as density curves, with our new algorithm for non-linear
regression of skew t mixture models. It selected the model that
corresponded to the optimal tissue-speciﬁc group structure using
the maximal value of the Jump statistic over a range of clusters
(g: 1,2...,gmax). Table 1 summarizes the results of this clustering
step. The optimal choice of g over the values for which the EM
converged is marked in Figure 2 and Supplementary Figure S1 (right
panel). In Figure 3a—f, we show each of the six clusters of the spleen
proﬁles. Notably, the proﬁles were grouped by their signiﬁcant
features overcoming intersample variation. Thus, the clustering was
both accurate and robust. Further, Figure 3g shows the mean proﬁle
of every cluster in its own color, thereby contrasting the signature
templates for every class while summarizing the characteristic

Table 1. Clustering statistics for Step 2

 

 

Tissue type No. of No. of IIR CT gmax
samples classes
Spleen 59 6 0.078 27.09 10
Thymocyte 111 12 0.068 118.04 12
Lung lavage 123 11 0.017 95.06 12
Bone marrow 48 8 0.014 23.94 10
Fetal thymus 89 12 0.038 81.24 12
Lymph node 131 8 0.072 111.21 12

 

For each tissue-type, its count of mAb proﬁles, number of proﬁle clusters (i.e. mAb
classes), IIR (average intracluster distance to average intercluster distance ratio) and
computing time (CT, in minutes) of the EM algorithm for g=1,2...,gmax.

 

   

 

 

 

I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
l

6

Number of clusters (9)

Fig. 2. Model selection for curve clustering: maximum value of Jump for
spleen indicates that 6 is the optimal number of mAb classes in that tissue.

features within each of them. Similar joint plots for every tissue
are shown in Supplementary Figure S2, which also includes the
Jump statistics that help in the determination of the optimal group
structures.

We validated our mAb classiﬁcation both computationally and
empirically. Since every ﬁtted proﬁle is deﬁned by a probability
distribution, we computed a symmetric form of Kullback—Leibler
distance (sKL) between all pairs of proﬁles, and observed that
the average intracluster distances between proﬁles are considerably
lower than the average intercluster distances. The ratio (IIR) in every
tissue is shown in Table 1. For illustration, the distance matrix for
the six clusters for spleen is shown in Supplementary Figure S3.

For empirical validation, for four tissue types (spleen, thymocytes,
bone marrow and lymph node) and two classes of antibodies [class I
mAb T2/ 39 and anti-LFA-l mAb F10-150 as described in Pratt et (11 .
(2009)], we generated data for two pairs of mAb such that the mAb
within each pair were known to target molecules of the same class,
but across pairs, they targeted molecules from distinct classes. As
shown in Supplementary Figure S4, indeed all proﬁle pairs (black
thin curves) cluster together within each class (Class I in left panel
or anti-LFA-l in right panel), but separately across two distinct
classes, providing experimental evidence for precise and objective
classiﬁcation by our framework. As in Figure 3, the mean proﬁles are

 

2750

112 /Bro's[Burno[prejxosoiwuirquioiqﬂ:duq uiorj papeolumoq

91oz ‘Og anﬁnv uo ::

MAb classification

 

 

A
in
v

Cluster 1
16 samples

 

A
5'
v
N
o
I

Cluster 2
17 samples

 

A
O
v
N
o
I

Cluster 3
11 samples

 

 

A
a.
v
N
o
I

Cluster 4
6 samples

 

A
0
v
N
o
I

Cluster 5
5 samples

 

A
-.
v
N
o
I

Cluster 6
4 samples

 

 0'0 _ I I I I I

Mean proﬁle density

 

 

 

1 2 3
Log of ﬂuorescence Intensity

Fig. 3. Classiﬁcation of mAb proﬁles for spleen: in Step 2 of mAbproﬁler,
the proﬁles of all 59 mAb samples in spleen were clustered with non-linear
regression of skew t mixture models. The proﬁles belonging to each of the
six clusters (a)%f) are shown in distinct colors. The joint plot (g) of all
six mean proﬁles in cluster-speciﬁc colors allows Visual comparison of the
cluster templates.

shown in cluster-speciﬁc colors for distinguishing the two classes in
each tissue.

3.1 Comparative analysis with other methods

Besides internal validation, we also compared the performance
of mAbproﬁler with other established methods. We began with
hierarchical clustering, which is the most commonly used approach
for mAb classiﬁcation (Bernard and Boumsell, 1984). When we
used hierarchical clustering on our mAb proﬁles, then the method
clearly failed to capture the complex class structure and detected

few clusters. Based on Average Silhouette Width (ASW), a common
measure for determining the quality of hierarchical clustering,
we noted that the optimal number of mAb classes according to
hierarchical clustering of our data was typically restricted to four
or even fewer for all tissues other than thymocytes. Moreover,
little difference among the ASW scores for different number of
clusters indicated that the hierarchical clusters had low separation
(Supplementary Figure S5).

Thereafter, we adopted the established protocol of Pratt et (11.
(2009) in which mAb histograms were ﬁrst smoothed with SiZer,
and then hierarchical clustering was performed with those smoothed
proﬁles. We show the results of that approach on our data using
SiZer plots for the different tissues in Supplementary Figure S6a—f.
As depicted with the dendrograms, while the larger clustering
structures were detected with smoothing, the ﬁner structures were
often ignored, thus resulting in highly heterogeneous classes. This
can be seen clearly in the largest clusters in spleen, lung lavage and
bone marrow.

Finally, we also studied a combination of our approach with that of
Pratt et (11. (2009) in which we clustered the SiZer-smoothed proﬁles
(i.e. we replaced Step 1 of mAbproﬁler) using our NLRST algorithm
(i.e. we retained Step 2 of mAbproﬁler). We observed that while
NLRST could identify more classes in the same SiZer proﬁles for
some tissues, the overall gain was not signiﬁcant. In other words, the
fact that mAbproﬁler identiﬁed a much richer class structure could
be attributed to the dual contributions of both Steps 1 as well as 2 of
the new framework. While NLRST tackles the intersample variation
along x-direction (feature location), the skew t mixture pdf provides
a precise and continuous representation of the y-direction (feature
signiﬁcance). The resulting effectiveness of mAbproﬁler’s two-step
approach is illustrated, for example, in the eight class-templates for
the lymph node which are distinctive along both x- and y-directions
(Supplementary Figure S2, left panel bottom plot). In contrast, the
other methods failed to capture that dual complexity and identiﬁed
only few dominant clusters. The full comparison of classes detected
by all four methods is shown in Supplementary Table S2.

4 DISCUSSION

Monoclonal antibodies play an immensely important role in
molecular biology, biochemistry and medicine. Their utility for
probing, stimulating or inhibiting speciﬁc target molecules supports
numerous diagnostic and immunotherapeutic applications (Zola,
2006). Further, design and development of new mAbs are also of
great industrial signiﬁcance. Therefore, objective mAb classiﬁcation
is essential for categorizing and comparing the known as well as
the newly developed mAb panels. Besides biochemical methods
like immunoprecipitation, this is achieved by clustering ﬂow
cytometric reactivity patterns of mAb in different cell types.
Unlike traditional HLDA workshops which classiﬁed leukocyte
surface (CD) molecules (Zola and Swart, 2005) using cell lines,
Pratt et (11. (2009) recently described a system to facilitate
practical mAb characterization in animal tissues. This approach
is consistent with the new human cell differentiation molecules
(HCDM) focus on various non-hematopoeitic cell types (Zola,
2006). In the present study, we enhanced that approach further by
(i) generating a new, larger and more varied collection of mAb
patterns in six different tissues, and importantly, by (ii) constructing
a new analytical framework, mAbproﬁler, to formally address

 

2751

112 ﬁre's[Burno[prejxosoiwuirquioiqﬂ:duq uiorj papeolumoq

9103 ‘0g1sn8nv uo ::

E.Rossin et al.

 

the technical challenges of mAb characterization. Our two-step
framework provides precise proﬁling of cytometric histograms
(Step 1) followed by novel clustering of these curve proﬁles (Step 2).
In addition to characterizing mAb for the present study, mAbproﬁler
can also provide a general framework to allow users to search for
archived class signatures or to construct and classify new mAb
proﬁles in a systematic way.

Previous mAb classiﬁcation studies (e.g. Pratt et (11., 2009;
Salganik et (11., 2005) have used non-parametric kernel density
estimation techniques for detection of signiﬁcant features in
cytometric histograms, typically followed by hierarchical clustering
based on Euclidean distances between the features. While being
practical, such approaches may not always be precise or robust.
For instance, the accuracy of density estimates by kemel-based
methods are known to be strongly inﬂuenced by bandwidth selection
(Jones et (11., 1996). As observed in Supplementary Figure S1,
signiﬁcance of the peak features in a given sample, as detected
by the program SiZer, is clearly dependent on the choice of
bandwidth. This poses a key practical problem, especially since we
seek to do unsupervised classiﬁcation of new mAb proﬁles. While
recent advances in kemel-based techniques have addressed different
aspects of cytometric analysis (e.g. Duong et (11., 2009; Naumann
et (11., 2010), we followed the parametric approach developed by
Pyne et (11. (2009) and (Friihwirth-Schnatter and Pyne, 2010), which
uses ﬁnite mixtures of skewed t distributions, for our purposes.
Observations of non-Gaussian features in cytometric data made by
these and other recent studies (Ho et (11., 2011; Lo et (11., 2008;
Pyne et (11., 2011) led us to use this more general parametric family
of distributions, which also the includes Gaussian distribution as a
special case.

Finite mixture models have been extensively used in biology
and medicine (Friihwirth-Schnatter, 2006; McLachlan and Peel,
2000). In Step 1 of mAbproﬁler, we presented a univariate version
of the Pyne et (11.’s (2009) approach for proﬁling asymmetric
and noisy mAb patterns with ﬁnite mixture model of skew t
distributions ﬁt via our own EM algorithm (see Supplementary
Material). The EM algorithm converges fast in practice, and
supports multiple well-known model selection criteria such as AIC,
BIC and ICL. In the resulting smooth and precise proﬁles (see
illustrative sample in Fig. 1), every component is speciﬁed by
rigorous model parameters such as location, size, shape, variance
and degrees of freedom. Further, the parametric design enables
mAbproﬁler to specify the signiﬁcance of every mAb feature with
a smooth and continuous probability density function, which can
be represented as a curve that is well deﬁned at any resolution.
Importantly, in Step 2, mAbproﬁler’s non-linear regression of skew
t mixture models can cluster these curve proﬁles accurately for
every cell type. While Step 1 follows the approach of Pyne et (11.
(2009), Step 2 introduces novel methodology and the EM algorithm
implementing it.

A key challenge for cytometric data analysis is intersample
variation. Similar mAb proﬁles can vary considerably in both their
signiﬁcance and location, which must be addressed by any algorithm
designed for classifying cytometric data. While it is possible to
transform or shift and align the data (e.g. Hahne et (11., 2010; Lo
et (11., 2008), we want to cluster the mAb proﬁles precisely in terms
of the distinctive features that they present as curves with a robust
approach. To systematically model that intersample variation, in Step
2, mAbproﬁler presented a new non-linear regression algorithm. It is

also a solution for the more generic problem of curve clustering, an
important topic in the ﬁeld of pattern recognition which has not
received much attention in the past (e.g. Gaffney, 2004; Gaffney
et (11., 2007; Liu and Yang, 2009). Here we extended the work
of Gaffney (2004) and Jones and McLachlan (1992) to introduce
non-linear regression of skew t mixture models for robust curve
clustering with asymmetric variation among the curve features. In
our comparative analysis with other methods, we observed that
hierarchical clustering is not as well suited for such clustering
probably because it critically relies on precise pairwise distances
between points. Trying to reduce a curve proﬁle to a point—albeit
a multidimensional point—can lead to loss of information about
features due to binning of the data as speciﬁed by a cytometric
histogram. That leads to fewer and less well-separated hierarchical
clusters, as illustrated in Supplementary Figure S5.

The problem of using hierarchical clustering for mAb
classiﬁcation gets further compounded with the issue of bandwidth
selection in smoothing of cytometric histograms such as in the
protocol of Pratt et (11. (2009). For our data, the SiZer-smoothed
features for a predetermined bandwidth led to mAb classes with high
heterogeneity. While our NLRST (Step 2) clustering could improve
detection of the classes with the same SiZer proﬁles, the net gain was
not signiﬁcant. Therefore, the identiﬁcation of a much richer group
structure by mAbproﬁler, as shown in Supplementary Table S2 (and
the class templates in Fig. 3g and Supplementary Figure S2, left
panel) may be attributed to the dual advantage of both Steps 1 and
2 of the new framework. Hierarchical clustering fails to capture
the complexity of data when presented in the form of noisy curve
proﬁles in which the true signiﬁcance of features is not apparent. This
is even more difﬁcult if there are few signiﬁcant features, which,
in turn, might suffer from intersample variation. By addressing
these issues, mAbproﬁler produced robust mAb classes—speciﬁed
as curves of probability density functions—even in the presence
of non-Gaussian variation. It achieves this without any need for
transforming the proﬁles or reducing them to points as required for
hierarchical clustering.

The new framework has several additional advantages. Its use
of Jump statistic provides a suitable criterion for optimal model
selection in proﬁle clustering. Each step of mAbproﬁler can be
performed independently with its own EM algorithm, which offers
the ﬂexibility of pipelining the framework with external algorithms.
As output, not only does mAbproﬁler produce a smooth proﬁle for a
mAb histogram, it also generates a mean template for the ‘signature’
pattern of every mAb class, along with parametric description of
signiﬁcant features therein. As a result, class templates can be
archived, and later searched for information on overall or speciﬁc
characteristics of such known mAb classes. Thus, it facilitates
pattern matching with newly constructed mAb proﬁles, which can
be grouped with classes having the most similar templates. Our
computational and empirical validation of mAbproﬁler classiﬁcation
shows how this is achieved. Another feature of our approach is that
it does not require a clonal population. Expression can be analyzed
both on individual cells and within a complex cell population.
Moreover, our non-Gaussian model can be easily extended to
temporal mAb proﬁling (Pyne et (11., 2011), e.g. for measurements
over the course of dampening of an inﬂammation in a certain tissue.
The strength of mAbproﬁler lies in providing a much-needed robust
and objective framework for mAb characterization in different cell
types and tissues.

 

2752

112 ﬁre's[Burno[prejxosoiwuirquioiqﬂ:duq uiorj papeolumoq

9103 ‘0g1sn8nv uo ::

MAb classification

 

Funding: TL thanks the National Science Council of Taiwan
(NSC99-2118-M-005-001-MY2) for ﬁnancial support.

Conﬂict of Interest: none declared.

REFERENCES

Arellano-Valle,R.B. et al. (2005) Skew-normal linear mixed models. J. Data Sci., 3,
415438.

Azzalini,A. and Capitaino,A. (2003) Distributions generated by perturbation of
symmetry with emphasis on a multivariate skew t distribution. J. R. Stat. Soc.
Ser B, 65, 3677389.

Azzalini,A. and Dalla-Valle,A. (1996) The multivariate skew-normal distribution.
Biometrika, 83, 7157726.

Banﬁeld,J.D. and Raftery,A.E. (1993) Model-based Gaussian and non-Gaussian
clustering. Biometrics, 49, 8037821.

Bernard,A. and Boumsell,L. (1984) The clusters of differentiation (CD) deﬁned by
the ﬁrst international workshop on human leucocyte differentiation antigens. Hum.
Immunol., 11, 1710.

Dela Cruz,R. (2008) Bayesian non-linear regression models with skew-elliptical errors:
applications to the classiﬁcation of longitudinal proﬁles. Comput. Stat. Data Anal,
53, 436449.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm (with discussion). J. R. Stat. Soc. Ser B, 39, 1738.

Duong,T. et al. (2009) Highest density difference region estimation with application to
ﬂow cytometric data. Biom. J., 51, 5044521.

Friihwirth-Schnatter,S. (2006) Finite Mixture and Markov Switching Models. Springer,
New York.

Friihwirth-Schnatter,S. and Pyne,S. (2010) Bayesian inference for ﬁnite mixtures of
univariate and multivariate skew normal and Skew-t distributions. Biostatistics, 11,
3177336.

Gaffney,S. (2004) Probabilistic curve-aligned clustering and prediction with mixture
models. PhD Dissertation. Department of Computer Science, University of
California, Irvine.

Gaffney,S.]. et al. (2007) Probabilistic clustering of extratropical cyclones using
regression mixture models. Clim. Dynam., 29, 423440.

Gilks,W.R. and Shaw,S. (1995) Statistical analysis. In Schlossman,S. et al. (eds)
Leucocyte Typing V. Oxford University Press, Oxford, pp. 8713.

Hahne,F. et al. (2010) Per-channel basis normalization methods for ﬂow cytometry data.
Cytometry PartA, 77, 1217131.

Herzenberg,L.A. et al. (2000) Monoclonal antibodies and the FACS: complementary
tools for immunobiology and medicine. Immunol. Today, 21, 3837390.

H0,H.J. et al. (2011) Maximum likelihood inference for mixtures of skew Student-
t-normal distributions through practical EM-type algorithms. Stat. C0mput.; doi:
10.1007/s11222-010-9225-9.

Jones,P.N. and McLachlan,GJ. (1992) Fitting ﬁnite mixture models in a regression
context. Aust. J. Stat., 34, 2337240.

Jones,M.C. et al. (1996) A brief survey of bandwidth selection for density estimation.
J. Am. Stat. Assoc, 91, 401407.

Kim,E.Y. et al. (2002) Using a neural network with ﬂow cytometry histograms to
recognize cell surface protein binding patterns. Proc. AMIA Symp., 38w384.

Li,X. et al. (1995) Hybridoma screening using an ampliﬁed ﬂuorescence microassay to
quantify immunoglobulin concentration. Hybridoma, 14, 75778.

Lin,T.I. et al. (2007) Robust mixture modeling using the skew t distribution. Stat.
Comput., 17, 81792.

Liu,X. and Yang,M.C.K. (2009) Simultaneous curve registration and clustering for
functional data. Comput. Stat. Data Anal., 53, 136171376.

L0,K. et al. (2008) Automated gating of ﬂow cytometry data via robust model-based
clustering. Cytometry Part A, 73, 3217332.

McLachlan,GJ. and Basford,K.E. (1988) Mixture Models: Inference and Application
to Clustering. Marcel Dekker, New York.

McLachlan,GJ. and Krishnan,T. (2008) The EM Algorithm and Extensions, 2nd edn.
John Wiley & Sons, New York.

McLachlan,GJ. and Pee1,D. (2000) Finite Mixture Models. Wiley, New York.

Naumann,U. et al. (2010) The curvHDR method for gating ﬂow cytometry samples.
BMC Bioinformatics, 11, 44.

Pratt,J.P. etal. (2009) Hierarchical clustering of monoclonal antibody reactivity patterns
in nonhuman species. Cytometry. Part A, 75, 7347742.

Pyne,S. et al. (2009) Automated high-dimensional ﬂow cytometric data analysis. Proc.
NatlAcad. Sci. USA, 106, 851978524.

Pyne,S. et al. (2011) Parametric modeling of cellular state transitions as measured
with ﬂow cytometry. In Proceedings of IEEE Ist International Conference on
Computational Advances in Bio and Medical Sciences (ICCABS), Institute of
Electrical and Electronics Engineers (IEEE), pp. 1477152.

Salganik,M.P. et al. (2005) Classifying antibodies using ﬂow cytometry data: class
prediction and class discovery. Biomet. J., 91, 7857800.

Spiegelhalter,D.J. and Gilks,W.R. (1987) Statistical analysis. In McMichae1,A.J. et al.
(eds) Leucocyte Typing 1. Oxford University Press., Oxford, pp. 14724.

Sugar,C.A. and James,G.M. (2003) Finding the number of clusters in a dataset: an
information-theoretic approach. J. Am. Stat. Assoc., 98, 75w763.

Zeng,Q. et al. (2002) Matching of ﬂow-cytometry histograms using information theory
in feature space. In Proceedings of the AMIA Symposium, American Medical
Informatics Association (AMIA), pp. 929793.

Zeng,Q.T. et al. (2007) Feature-guided clustering of multi-dimensional ﬂow cytometry
datasets. J. Biomed. Informat., 40, 3257331.

Zola,H. (2006) Medical applications of leukocyte surface moleculesithe CD molecules.
Mol. Med., 12, 3127316.

Zola,H. and Swart,B. (2005) The human leucocyte differentiation antigens (HLDA)
workshops: the evolving role of antibodies in research, diagnosis and therapy.
Cell Res., 15, 691494.

 

2753

112 ﬁre's1Burno[prejxosoiwuirquioiqp:duq uiorj papeo1umoq

9103 ‘0g1sn8nv uo ::

