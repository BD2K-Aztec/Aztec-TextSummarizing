APPLICATIONS NOTE V°" 232%.lié‘iléﬁéﬁﬁfﬁiﬁili

 

Sequence analysis

Advance Access publication June 6, 2014

ABRA: improved coding indel detection via assembly-based

realignment

Lisle E. Mose”, Matthew D. Wilkersonl'z, D. Neil Hayesl's, Charles M. Peroul'2 and

Joel S. Parker1'2'*

1Lineberger Comprehensive Cancer Center, 2Department of Genetics, 3Division of Medical Oncology, Department of
Internal Medicine, Multidisciplinary Thoracic Oncology Program, University of North Carolina at Chapel Hill, Chapel Hill,

NC 27599, USA

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: Variant detection from next-generation sequencing (NGS)
data is an increasingly vital aspect of disease diagnosis, treatment and
research. Commonly used NGS-variant analysis tools generally rely on
accurately mapped short reads to identify somatic variants and germ-
line genotypes. Existing NGS read mappers have difficulty accurately
mapping short reads containing complex variation (i.e. more than a
single base change), thus making identification of such variants diffi-
cult or impossible. Insertions and deletions (indels) in particular have
been an area of great difficulty. Indels are frequent and can have
substantial impact on function, which makes their detection all the
more imperative.

Results: We present ABRA, an assembly-based realigner, which uses
an efficient and flexible localized de novo assembly followed by global
realignment to more accurately remap reads. This results in enhanced
performance for indel detection as well as improved accuracy in vari-
ant allele frequency estimation.

Availability and implementation: ABRA is implemented in a combin-
ation of Java and C/C-l— + and is freely available for download at
https://github.com/mozack/abra.

Contact: |mose@unc.edu; parkerjs@email.unc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on January 14, 2014; revised on May 27, 2014; accepted on
June 1, 2014

1 INTRODUCTION

A number of realignment or assembly methods have been pro-
posed to overcome the alignment errors and reference bias that
limit indel detection. Short read micro aligner locally realigns
reads to regionally assembled variant graphs (Homer and
Nelson, 2010). Pindel uses a pattern growth approach to detect
indels W e et al., 2009). Dindel realigns reads to candidate haplo-
types and uses a Bayesian method to call indels up to 50 bp in
length (Albers et al., 2011). The Genome Analysis Toolkit
(GATK)’s IndelRealigner seeks to minimize the number of mis-
matching bases Via local realignment (DePristo et al., 2011).
Whole-genome de novo assembly approaches include Fermi (Li,
2012) and Cortex Var (Iqbal et al., 2012). SOAPIndel performs

 

*To whom correspondence should be addressed.

localized assembly and calling on regions containing reads where
only one half of a paired read is mapped (Li et al., 2012).
Clipping REveals STructure (CREST) uses soft clipped reads
and localized assembly to identify somatic structural variants
(Wang et al., 2010). Targeted Iterative Graph Routing
Assembler (TIGRA) uses targeted assembly to produce contigs
from putative breakpoints (Chen et al., 2014). Additional pro-
prietary localized assembly methods have been developed by
Complete Genomics (Carnevali et al., 2012) and Foundation
Medicine (Frampton et al., 2013).

Our newly developed tool called ABRA accepts a Sequence
Alignment/Map (SAM/BAM) file as input and produces a re-
aligned BAM file as output, allowing ﬂexibility in selection of
variant calling algorithms and other downstream analysis.
Global realignment allows reads that are unaligned or improp-
erly mapped to be moved to a correct location. ABRA detects
variation that is not present in the original read alignments and
improves allele-frequency estimates for variation that is present.
ABRA can be used to enhance both germ-line and somatic vari-
ant detection and works with paired-end as well as single-end
data.

2 METHODS

The ABRA algorithm consists of localized region assembly, contig build-
ing, alignment of assembled contigs and read realignment.

Localized assembly of reads is done on small genomic regions of size
52 kb. For exome or targeted sequencing, these regions roughly corres-
pond to capture targets. For each region, a De Bruijn graph of k-mers is
assembled from the input reads (Pevzner et al., 2001). K-mers containing
low quality or ambiguous bases are ﬁltered and k-mers that do not
appear in at least two distinct reads are pruned from the graph, reducing
the impact of sequencing errors on the assembly process.

After initial pruning of the assembled graph, the graph is traversed to
build contigs longer than the original read length. There is no smoothing
of the graph to remove low-frequency variation, as we are interested in
detecting such variation. All non-cyclic paths through the graph are tra-
versed. In cases where a cycle in the graph is observed for a given region,
that region is iteratively reassembled using increasing k-mer sizes until the
cycle no longer exists or a conﬁgurable maximum k-mer size is reached.
As currently implemented, detection of local insertions is limited to less
than maximum k-mer size. Larger insertions of sequence from another
location in the genome are likely to be aligned elsewhere and not included
in local assembly, thus limiting detection of insertions as the size
approaches read length.

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq moi; popcorumoq

9103 ‘Og isnﬁnV u0 ::

L.E.Mose et al.

 

Assembled contigs for all regions are aligned to the reference genome.
We currently use BWA MEM (Li, 2013) for contig alignment.
Chimerically aligned contigs are combined when appropriate (in cases
of longer indels). Redundant sequence as well as sequence not varying
from the original reference is removed. The result is used as the basis for
an alternate reference.

The original reads are mapped to the alternate reference using a non-
gapped alignment. Reads that unambiguously align more closely to the
alternate than the original reference are modiﬁed to reﬂect the updated
alignment information in the context of the original reference.

Typical ABRA runtime for a human whole exome of depth lSOX on
a machine with eight cores is roughly 2h using <16 GB of RAM.

3 RESULTS

3.1 HapMap trio

ABRA was applied to exome target regions of a CEPH Hapmap
trio of three individuals sequenced to 50x as part of the Illumina
Platinum Genomes project and aligned using bwa mem. Variants
were called with and without ABRA using Freebayes (Garrison
and Marth, 2012) and UniﬁedGenotyper (DePristo et al., 2011).
The GATK’s HaplotypeCaller was used to call variants without
ABRA and the GATK’s IndelRealigner was applied to
UniﬁedGenotyper input. Coding indels with variant-allele fre-
quency of 320% are used in this germ-line evaluation. ABRA
enables an increase in the number of Mendelian consistent loci
(MCL) detected and a decrease in Mendelian conﬂict rate
(MCR) with either Freebayes or UnifiedGenotyper (Fig. l).
The Freebayes/ABRA combination yields a decrease in MCR
compared with HaplotypeCaller and remains competitive in
number of MCL detected. Pre-/post-ABRA concordance for
Mendelian consistent SNP loci is >99%. Although we anticipate
that ABRA will also provide improved performance in non-
coding regions, this has not yet been explored.

HapMap Trio Coding Indels

III Variant Depth >= 10
A Variant Depth 3: 5 O

O Variant Depth 3: 2
A o A

380

360

340
I

Mendelian Consistent Loci
O

O FreeBayes
n O FreeBayesMBRA [A O
O UnifiedGenotyper
O UnlfledGenolyperiABFiA
O UnifiedGenowpen'lndelFIealigner D
O HaplotypeCaller

0.03 0.04 0.05 0.06 0.0? 0.08

 

2&0

 

Mendelian Conflict Rate

Fig. 1. Mendelian consistent loci and Mendelian conﬂict rates for
Freebayes and UniﬁedGenotyper both pre- and post-ABRA.
UniﬁedGenotyper results with GATK Local Realignment around
Indels as well as HaplotypeCaller results are also shown for comparison.
Shapes in this ﬁgure represent variant depth, whereas color/shading rep-
resent caller and realignment method

3.2 TCGA tumor and normal data

We applied ABRA to 100 normal exomes from the Breast
Invasive Carcinoma (BRCA) cohort of The Cancer Genome
Atlas (TCGA) project (The Cancer Genome Atlas Network,
2012) using BWA (Li and Durbin, 2009) for the initial align-
ments. Germ-line variants were called both with and without
ABRA using FreeBayes. We also called germ-line variants
using HaplotypeCaller and Pindel for comparison purposes. To
evaluate these calls in the absence of ground truth, we assembled
predicted calls for all methods using TIGRA and aligned the
resulting contigs with the BLAST-like alignment tool (BLAT)
(Kent et al., 2002). ABRA increased concordance with the
TIGRA/BLAT results and maintained a low discordance rate
(Fig. 2). Further, ABRA generated estimated allele frequencies
closer to 50 and 100%, which is expected in a diploid individual
(see Supplementary Material). We next compared pre- and post-
ABRA somatic variant calls on 750 TCGA BRCA normal/
tumor exome pairs. Strelka (Saunders et al., 2012) and
UNCeqR (Wilkerson et al., 2012) were used for somatic calling.
Improved detection of somatic mutation was observed in the
post-ABRA calls (see Supplementary Material).

4 CONCLUSION

ABRA improves on next-generation sequencing read alignments,
providing enhanced performance in detection of indels as well as
greater accuracy in variant allele frequency estimation. ABRA
accepts BAM files as input and outputs realigned BAM files,

TCGA BFICA Coding Indel Concordance
DEL<30bp IN5¢30W

3020‘“ D Dzo‘oa't- D
8
iii?“ I'M

IWﬂO

22.
it

o
Concomanl Calls
91.303

gages
S
ates.

Conan-dam Calls

usno 120m: 125m 133m 135m Horn:
‘39-

io'no 15in: mu: 1200' "on who who
Discordam Calls Discordam Calls

DEL 3: so hp ms 3: so hp

r g a-
1

20m am son

1200

250

w a an
i = ' 7—,, x
E 3 3
§ r EE 0 — Fire-ABRA
5% 3 a _ — Post—AB Fm
N i, *6 Pindel
g . MM 9 — Haplotype Caller
m mlblscordaniuCalls 5° ‘Eiolscomaﬂ Calls m 250

Fig. 2. Concordance/discordance with TIGRA assembled contigs for
predicted calls from FreeBayes (pre- and post-ABRA), Pindel and
Haplotype Caller. Indels within the ranges enabled by ABRA are eval-
uated (deletions up to 2000 bp and insertions up to the read length). The
numbers in the ﬁgure represent a cutoff point for variant quality scores as
reported in the respective caller’s VCF output. A small number of pre-
ABRA deletions >30 bp and 0 pre-ABRA insertions >30 bp are called.
FreeBayes currently does not use reads partially overlapping an insert as
supporting evidence, which may impact post-ABRA sensitivity for longer
insertions

 

2814

112 /310'S[BHJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”Idllq moi; popcorumoq

910E ‘OE JSHBHV uo ::

ABRA

 

allowing ﬂexibility in downstream analysis. ABRA can be used
with a variety of variant callers for both germ-line and somatic
variant calling.

Funding: This work was supported in part by the National
Cancer Institute Breast SPORE program (P50-CA58223-09Al)
and The Cancer Genome Atlas (U24-CA143848—05).

Conﬂict of Interest: none declared.

REFERENCES

Albers,C.A. et a]. (2011) Dindel: accurate indel calls from short—read data. Genome
ReS., 21, 9617973.

Chen,K. et a]. (2014) TIGRA: a targeted iterative graph routing assembler for
breakpoint assembly. Genome Res., 24, 3107317.

Carnevali,P. et a]. (2012) Computational techniques for human genome resequen—
cing using mated gapped reads. J. Comput. Biol., 19, 2797292.

DePristo,M.A. et a]. (2011) A framework for variation discovery and genotyping
using next—generation DNA sequencing data. Nat. Genet., 43, 4914198.

Frampton,G.M. et a]. (2013) Development and validation of a clinical cancer gen—
omic profiling test based on massively parallel DNA sequencing. Nat.
Biotechnol., 31, 102371031.

Garrison,E. and Marth,G. (2012) Haplotype—based variant detection from short—
read sequencing. arXiv, 1207.3907v2.

Homer,N. and Nelson,S.F. (2010) Improved variant discovery through local re—
alignment of short—read next—generation sequencing data using SRMA.
Genome Biol., 11, R99.

Iqbal,Z. et a]. (2012) De novo assembly and genotyping of variants using colored de
bruijn graphs. Nat. Genet., 44, 22(r232.

Kent,W.J. (2002) BLATethe BLAST—like alignment tool. Genome Res., 12,
656—664.

Li,H. (2012) Exploring single—sample SNP and INDEL calling with whole—genome
de novo assembly. Bioinformatics, 28, 183&1844.

Li,H. (2013) Aligning sequence reads, clone sequences and assembly contigs with
BWA-MEM. arX iv, 1303.3997.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with burrows—
wheeler transform. Bioinformatics, 25, 175471760.

Li,S. et a]. (2013) SOAPindel: efficient identification of indels from short paired
reads. Genome Res., 23, 1957200.

Pevzner,P.A. et a]. (2001) An Eulerian path approach to DNA fragment assembly.
Proc. Natl Acad. Sci., 98, 974879753.

Saunders,C.T. et a]. (2012) Strelka: accurate somatic small—variant calling from
sequenced tumor—normal sample pairs. Bioinformatics, 28, 181171817.

The Cancer Genome Atlas Network. (2012) Comprehensive molecular portraits of
human breast tumours. Nature, 490, 61770.

Wilkerson,M.D. et a]. (2014) Integrated RNA and DNA sequencing improves
mutation detection in low purity tumors. Nucleic Acids Research, 42, e107.
Ye,K. et a]. (2009) Pindel: a pattern growth approach to detect break points of large
deletions and medium sized insertions from paired—end short reads.

Bioinformatics, 25, 286572871.

 

2815

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] uioii popcorn/mg

9103 ‘Og isnﬁnV uo ::

