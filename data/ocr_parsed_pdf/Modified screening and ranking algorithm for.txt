Bioinformatics, 31(9), 2015, 1341—1348

doi: 10.1093/bioinformatics/btu850

Advance Access Publication Date: 25 December 2014
Original Paper

 

Genome analysis

Modified screening and ranking algorithm for
copy number variation detection
Feifei Xiao, Xiaoyi Min and Heping Zhang*

Department of Biostatistics, Yale School of Public Health, New Haven, CT, USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on October 15, 2014; revised on December 17, 2014; accepted on December 19, 2014

Abstract

Motivation: Copy number variation (CNV) is a type of structural variation, usually defined as gen—
omic segments that are 1 kb or larger, which present variable copy numbers when compared with
a reference genome. The screening and ranking algorithm (SaRa) was recently proposed as an effi—
cient approach for multiple change—points detection, which can be applied to CNV detection.
However, some practical issues arise from application of SaRa to single nucleotide polymorphism
data.

Results: In this study, we propose a modified SaRa on CNV detection to address these issues. First,
we use the quantile normalization on the original intensities to guarantee that the normal mean
model—based SaRa is a robust method. Second, a novel normal mixture model coupled with a
modified Bayesian information criterion is proposed for candidate change—point selection and fur—
ther clustering the potential CNV segments to copy number states. Simulations revealed that the
modified SaRa became a robust method for identifying change—points and achieved better per—
formance than the circular binary segmentation (CBS) method. By applying the modified SaRa to
real data from the HapMap project, we illustrated its performance on detecting CNV segments. In
conclusion, our modified SaRa method improves SaRa theoretically and numerically, for identify—
ing CNVs with high—throughput genotyping data.

Availability and Implementation: The modSaRa package is implemented in R program and freely
available at http://chZ.yale.edu/software/modSaRa.

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Single nucleotide polymorphisms (SNPs), structural variations (such
as deletion, duplication or insertion of a chromosome segment) and
epigenetic reasons account for the tremendous variability of human
genomics. Copy number variation (CNV) is a type of structural vari-
ation, which is usually defined as genomic segments that are lkb or
larger, presenting variable copy numbers when compared with a ref-
erence genome (Freeman et (11., 2006). Duplication or deletion on
any of the two copies of genomic segments results in variation
of this region in human populations. CNVs are generated by recom-
bination-based or replication-based mechanisms, which can be in-
herited; their formation also occurs when do nor/o locus-specific
mutation happens (Zhang et (11., 2009). With the new technologies

developed in recent years, smaller copy number variants that are
even in SNP level are detectable (Conrad et (11., 2010).

Increasing evidence suggests that CNVs commonly exist and
have strong impact on disease risks. Through CNV mapping of
human genome from 270 individuals, researchers found that 12%
of human genome is subject to CNVs (Redon et (11., 2006).
Meanwhile, other research revealed that the average number of
CNVs per individual in the 112 HapMap individuals was 27 (Wang
et (11., 2007). Moreover, a large-scale CNV detection study in human
genome demonstrated that a large amount of the identified CNVs
overlapped with protein coding region (Sebat et (11., 2004).

Changes of copy number influence the expression levels of genes
included in the corresponding DNA segments, which makes

(63 The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1341

/310‘srcumo[p10}xo‘sopcuHOJHtotq/ﬁdnq

1342

F.Xiao et al.

 

transcription levels higher or lower than those that can be achieved
by control of transcripts of a single copy per haploid genome
(Hastings et al., 2009). Given this information, CNVs in human gen—
ome may significantly affect risks of not only Mendelian diseases
but also many common diseases. Great effort is being made to un—
cover a causal role of CNVs in pathogenesis of human common dis—
orders, such as pancreatic adenocarcinoma, autism, growth
retardation and HIV progression (Fanale et al., 2013; Poultney
et al., 2013; Shostakovich—Koretskaya et al., 2009; Zahnleiter et al.,
2013). Precisely identifying CNVs and studying their genetic func—
tions will greatly benefit the functional analysis of human genomics
and complement current GWASs, which measure genome—wide
genotype variations (Wang and Bucan, 2008).

Various techniques have been proposed for detecting DNA
CNVs in humans and mammalians. The advent of whole—genome
SNP genotyping array and the next generation sequencing which
assays hundreds of thousands of points in parallel permits kilobase—
resolution detection of CNVs. With the development of these high—
resolution techniques, many population—based statistical algorithms
have been developed for CNV studies including QuantiSNP (Colella
et al., 2007), CNVCALL(Cardin et al., 2011), CNVDetector (Chen
et al., 2008), CGHCall (van de Wiel et al., 2007), CNV—seq (Xie
and Tammi, 2009), CNVtools (Barnes et al., 2008), BirdSuite (Korn
et al., 2008) and CNVassoc (Subirana et al., 2011). PennCNV
(Wang and Bucan, 2008) is probably the most popular software for
CNV analysis, which implements hidden Markov model incorporat—
ing the Log R Ratio (LRR) values, B allele frequency (BAF) values
and also the distances between neighbouring SNPs.

Meanwhile, many change—point—based approaches have also
been developed and extensively applied to the detection of CNVs.
Existing change—point—based approaches use exhaustive searching,
such as binary segmentation method (Sen and Srivastava, 1975), cir—
cular binary segmentation (CBS; Olshen et al., 2004) and penalized
regression (Huang et al., 2005). These global searching approaches
present high computational complexity, given that the data points
are repeatedly used in the process of determining change—points
along the same sequence. As a result, finding multiple change—points
in massive SNP genotyping array data accurately and efficiently is
challenging.

The screening and ranking algorithm (SaRa) was recently
proposed as an alternative approach for multiple change—points
detection (Niu and Zhang, 2012). This algorithm hypothesizes that
determining whether a position at the DNA sequence is a change—
point or not does not depend on the information far away from this
position. The SaRa algorithm searches along the sequence in a series
of windows, and it finds the local maximizers for the scan statistic
as the most probable change—points locally. These local maximizers
are then ranked and chosen by a backward subset selection strategy
based on Bayesian information criterion (BIC), which yields final
change—points.

As discussed by Niu and Zhang (2012), it takes only O(n) oper—
ations to perform the screening and ranking steps. Therefore, SaRa
ensures low computational complexity down to O(n), which makes
it more efficient than the existing iterative searching algorithms with
complexity at least O(n2). This statistical property makes SaRa
more suitable for high throughput datasets.

However, some practical issues arise from the application of
SaRa to SNP data for identifying CNVs. First, the distribution of
intensities in high—throughput Affymetrix SNP array, for example,
always presents heavy tails when compared with normal distribu—
tions, which violates the assumption of SaRa. Second, the change—
points identified by SaRa are not clustered to make final calling of

copy number states. In this article, to address the above two issues,
we propose several strategies to implement SaRa on CNV detection.
First, we use the quantile normalization (QN) on the original inten—
sities to alleviate the requirement of normality. Second, we propose
to use a novel normal mixture model and apply the BIC criterion for
candidate change—point selection and further cluster the potential
CNV segments to copy number states. After our modification,
the SaRa algorithm is robust to the violations of the normal as—
sumption and yields high sensitivity and specificity for identifying
change—points. Through intensive simulation studies, we evaluated
the validity of the modified SaRa on identifying change—points for
CNVs. Our simulation results demonstrated that the modified
SaRa achieved higher power than CBS (Venkatraman and Olshen,
2007). By applying it to real data from the HapMap project, we
illustrated the performance of the modified SaRa on detecting CNV
segments.

2 Methods
2.1 SaRa algorithm

First, we start with a brief review of the SaRa method. Let
Y : (Y1, Y2, . . ., Y,,)T be a long linear sequence of random variables,
for example, LRR values of an individual at one chromosome from
genotyping array. 11 is the length of the sequence presented by num—
ber of SNP and CNV markers. In SaRa, a high dimensional normal
mean model is applied as follows,

Y,:y,~+e,~,e,~~N(0,az),1gign.

u : (p1, p2, . . ., pn)T is the piecewise constant vector denoting the
unknown underlying mean of each point. ai’s are the independent
and identically distributed errors with normal distribution. We then
define a change—point vector 1 : (11,12, . . .,r])T where 111/: 1, . . .,])
are the change—points in the model satisfying pm 9E III/+1. The total
number of change—points ] is assumed to be much smaller than the
total length 11. As mentioned in the introduction section, on average,
approximately 50 change—points corresponding to either end of the
CNV regions, are sparsely dispersed among the hundreds of thou—
sands of SNP array points for each individual. The major task be—
comes searching for the number of change—points ] and finding the
exact locations of 1’s.

First, a window with bandwidth 10 is used to scan the long linear
sequence which we call the screening step. At each point of interest x
(1 3x 3 n — 1), a simple diagnostic function D),(x) defined below is
used to reflect the probability of this position being a change—point.

h h
(Z Y... — Z 
t:1 t:1 .

DWC) : h

This is the average difference between the right—hand side and the
left—hand side local observations of the point of interest. Therefore,
the larger deviation from zero that D), (x) presents, the more likely
that x is a change—point. A positive value of D),(x) means an
increased mean, and a negative D),(x) is related to a decreased
mean. Local maximizers of )Dh(x)) are selected as the most probable
candidates of change—points. For these local maximizers, the
P—values corresponding to the test statistics are obtained by simula—
tion from a sequence with no change—point. Then, by choosing a sig—
nificance level, the local maximizers with the smallest P—values are
selected to obtain a list for further selection, which has a much
smaller size than the total length 11. After these screening and rank—
ing procedures, we find a pool of candidates that are most likely to

/310‘Sjcumo[p10}xo‘sopcuHOJHtotq/ﬁdnq

Niu and Zhang (2012)

Niu and Zhang (2012),

 

Supplementar) Text

Figure 1

Signal intensity calculation for
LRR values

Outlieix; removal by signal
smoothing

Quantile normalization (QN)

Local maximizes identiﬁcation
with multiple bandwidths

BIC criterion subset selection

biennial mixture model based
clustering

/310'S[Buln0prOJXO'SOIJ’BLUJOJIIIOlq/ﬂduq

Figure 2

Supplernentar) I\4ethods
The International Ilapbdap Consortium, 2003

Fig.2

CPI. ﬁles nf'im individuals
domtluadcd ﬁ'um HapMap project

 calling at clrrmnmoi‘ne I by
PennCNV. ,81? raw CNVS

2.99 individuals with 1,?88 CW3
missed the qualityr control step

Manually chum-e: a shared blank
region in 212 subjects

Formula lheLog R rulio vule
and add trend

Randomly choose ten chromosome
regions for CNV simulatiom

Scenarios 1 and 2: Scenario 3: mixed
deletion ofa single states of duplications
copy and double copies and deletions

 

Table l

Suppleinentar) Fig. 51

Supplernentar) Fig. S2
Supplernentar) I\4ethods

Figure 1

Chen (7/ al., 2013

/310'S[Buln0prOJXO'SOIJ’BLUJOJIIIOlq/ﬂduq

 

an?Eggnog—.5538.oio~&o:3m7.omm\

m
o
m
m
m.
.m
H

 

3
)

Fig. .

Table 3

Table 4

4

.C

Figui

Supplernentar) Table l

Supplernentar) Figure S2

Fig. 5

Supplernentar) Fig.

Figure

Histogram

egment lengths

 

/310'S[Buln0prOJXO'SOIJ’BLUJOJIIIOlq/ﬂduq

Modiﬁed SaRa for CN V detection

1347

 

To evaluate the performance of our proposed method versus existing
ones, we developed a novel method to generate DNA sequences that
mimic real data for the purpose of evaluating CNV detection.

Our simulations with noises from t—distributions highlight the
necessity of preprocessing by ON on SaRa which renders its robust—
ness to the normal assumption (Fig. 3). Moreover, we propose to
use multiple bandwidths in identifying change—point candidates to
optimize the sensitivity, then a normal mixture model—based cluster—
ing strategy following BIC criterion in deletion of false positives to
optimize its specificity. By applying the modified SaRa on a simu—
lated dataset mimicking a real dataset from the HapMap project, we
illustrated the great performance of the modified SaRa on detecting
change—points with SNP genotyping arrays. In all the scenarios we
simulated, the modified SaRa achieved better performance than CBS
(Tables 3, 4 and Supplementary Table 51). QN also affected the per—
formance of CBS to some extent. In addition, real data analyses indi—
cated that the modified SaRa outperformed CBS in both sensitivity
and specificity although they identified similar number of change—
points. Our improvements emphasize the preference to use the
modified SaRa in identification of CNVs. In conclusion, we propose
a modified SaRa method by optimizing its performance in both the—
oretical and applicable aspects for identifying CNVs with high—
throughput genotyping arrays.

The better performance of the modified SaRa on change—points
detection compared with CBS highlights the necessity and contribu—
tion of our modification. The combination of multiple bandwidths
and normal mixture model strategies allows optimized sensitivity
and specificity. On the one hand, using multiple bandwidths, the
modified SaRa achieves better power of the detection of change—
points. While, on the other hand, the implementation of the normal
mixture model—based clustering overcomes the over—sensitivity of
the original SaRa to small mean changes, which is undesirable for
CNV detection. Thus, the modified SaRa has more precise identifi—
cation of the change—points corresponding to true CNVs. Such ad—
vantages are exhibited in the real data analysis results, in which the
modified SaRa identified more realistic CNV segments than CBS.
One concern of our modification is that larger CNV segments may
be produced than the original version of SaRa. This is because we
cluster two adjacent CNV segments together at the clustering step,
when both have the same direction of change and similar jump sizes.
However, as noted in the real data analysis, the proportion of short
segments identified by SaRa was larger than CBS, which demon—
strated that our modification did not mistakenly group adjacent
change—points. We provide a reliable solution for the over—sensitivity
issue of the original SaRa method in this study.

To effectively filter false—positive change—points, our suggestion
is to apply normal mixture model—based clustering following subset
selection based on modified BIC. Other combinations of these two
strategies were also explored in the simulation studies: (i) selection
with modified BIC criterion only; (ii) normal mixture model—based
clustering only and (iii) selection with modified BIC criterion follow—
ing normal mixture model—based clustering were all applied to the
simulated datasets. However, our proposed combination exhibited
the best performance on subset selection of the candidate pool. The
underlying mechanism is of interest and will be further investigated
in our future study.

Investigating the association of CNVs with common quantitative
traits and human complex diseases is a challenging task in current
genetic community. Our implementation in the SaRa method
by optimizing its performance is of great value for CNV identifi—
cation, which ensures more accurate and valid CNV calls for
future association study. Compared with the originally developed

SaRa, the improvements are reflected in three aspects. First,
multiple bandwidths strategy assures better power. Second, the
backward deletion strategy incorporating BIC criterion and normal
mixture model allows better filtering of false positives and better
calling of CNV segments. Last, QN strategy in the preprocess step
makes the modified SaRa more robust for analyses of different data
types.

As we stated above, one of the disadvantages of the modified
SaRa is that it may incorrectly combine two neighbouring CNVs,
which have minor differences in jump sizes in reality. For example,
one segment presenting a large increase which may implicate dupli—
cation of double copies, and an adjacent one that has a smaller jump
which may indicate duplication of a single copy, may be grouped to
a single segment by our algorithm. This issue arises since we only
use three copy number states in the clustering step. One possible
solution is to introduce more states or clusters (e.g. five) in the clus—
tering step using a normal mixture model, but more issues may arise
such as the choices of initial parameters. Another solution is to in—
corporate the BAF values, which will further clarify the copy num—
ber states according to the distributions of BAF. This approach
warrants future research.

In this study, we focus mainly on the optimal segment identifica—
tion by local searching. Indeed, our proposed QN preprocessing pro—
cedure was initially motivated by evaluating the robustness of SaRa
to non—Gaussian distributions. Most change—point—based methods
assume normality for the noise intensities. In reality, the noise data
of the SNP array sequences are usually not normally distributed,
which makes the assumption of normal distribution invalid. In add—
ition to the CNV detection methods developed for SNP arrays, the
ON strategy can be extended to next generation sequencing data
whose intensities may present heavy tailed noises (Cheung et al.,
2011). Therefore, our study provides new insight on the CNV detec—
tion for next generation sequencing data. Moreover, it will be of
great interest to develop a population based approach using data
from multiple sequences or subjects for CNV identification, which
will potentially improve the power of CNV detection.

Acknowledgements

The authors acknowledge The International HapMap Consortium for provid-
ing a dataset for our study.

Funding

This work was supported by National Institutes of Health grant,
R01DA016750-10.

Conﬂict ofInteiest: none declared.

References

Barnes,C. et al. (2008) A robust statistical method for case-control association
testing with copy number variation. Nat. Genet, 40, 1245—1252.

Cardin,N. et al. (2011) Bayesian hierarchical mixture modeling to assign
copy number from a targeted CNV array. Genet. Epidemiol., 35,
5 36—548.

Chen,M. et al. (2013) SomatiCA: identifying, characterizing and quantifying
somatic copy number aberrations from cancer genome sequencing data.
PLOS One, 8, e78143.

Chen,P.A. et al. (2008) CNVDetector: locating copy number variations using
array CGH data. Bioinformatics, 24, 2773—2775.

Cheung,M.S. et al. (2011) Systematic bias in high-throughput sequencing data
and its correction by BEADS. Nucleic Acids Res., 39, e103.

ﬁlO'SIIZHmOprOJXO'SOplZIIJJOJLIIOIQ/[idnq

1348

F.Xiao et al.

 

Colella,S. et al. (2007) QuantiSNP: an Objective Bayes Hidden-Markov
Model to detect and accurately map copy number variation using SNP geno-
typing data. Nucleic Acids Res., 35, 2013—2025.

Conrad,D.F. et al. (2010) Origins and functional impact of copy number vari-
ation in the human genome. Nature, 464, 704—712.

Fanale,D. et al. (2013) Analysis of germline gene copy number variants of pa-
tients with sporadic pancreatic adenocarcinoma reveals speciﬁc variations.
Oncology, 85, 306—31 1.

Freeman,].L. et al. (2006) Copy number variation: new insights in genome di-
versity. Genome Res., 16, 949—961.

Hastings,P.]. et al. (2009) Mechanisms of change in gene copy number. Nat.
Rev. Genet., 10, 551—564.

Huang,T. et al. (2005) Detection of DNA copy number alter—
ations using penalized least squares regression. Bioinformatics, 21,
3811—3817.

The International HapMap Consortium (2003) The International HapMap
Project. Nature, 426, 789—796.

Korn,].M. et al. (2008) Integrated genotype calling and association analysis of
SNPs, common copy number polymorphisms and rare CNVs. Nat Genet.,
40,1253—1260.

Niu,Y.S. and Zhang,H. (2012) The screening and ranking algorithm to detect
DNA copy number variations. Ann. Appl. Stat, 6, 1306—1326.

Olshen,A.B. et al. (2004) Circular binary segmentation for the analysis of
array-based DNA copy number data. Biostatistics, 5, 557—572.

Poultney,C.S. et al. (2013) Identiﬁcation of small exonic CNV from whole-
exome sequence data and application to autism spectrum disorder. Am. ].
Hum. Genet., 93, 607—619.

Redon,R. et al. (2006) Global variation in copy number in the human genome.
Nature, 444, 444—454.

Sebat,]. et al. (2004) Large-scale copy number polymorphism in the human
genome. Science, 305, 525—528.

Sen,A. and Srivastava,M.S. (1975) Tests for detecting change in mean. Ann.
Stat, 3, 98—108.

Shostakovich-Koretskaya,L. et al. (2009) Combinatorial content of CCL3L
and CCL4L gene copy numbers inﬂuence HIV-AIDS susceptibility in
Ukrainian children. Aids, 23, 679—688.

Subirana,I. et al. (2011) CNVassoc: association analysis of CNV data using R.
BMC Med. Genom., 4, 47.

van de Wiel,M.A. et al. (2007) CGHcall: calling aberrations for array CGH
tumor proﬁles. Bioinformatics, 23, 892—894.

Venkatraman,E.S. and Olshen,A.B. (2007) A faster circular binary segmenta-
tion algorithm for the analysis of array CGH data. Bioinformatics, 23,
65 7—663.

Wang,K. and Bucan,M. (2008) Copy number variation detection Via high-
density SNP genotyping. CSH Protocols, 2008, pdb top46.

Wang,K. et al. (2007) PennCNV: an integrated hidden Markov model de—
signed for high-resolution copy number variation detection in whole-gen-
ome SNP genotyping data. Genome Res., 17, 1665—1674.

Xie,C. and Tammi,M.T. (2009) CNV-seq, a new method to detect copy num—
ber variation using high-throughput sequencing. BMC Bioinﬂ, 10, 80.

Zahnleiter,D. et al. (2013) Rare copy number variants are a common cause of
short stature. PLoS Genet., 9, e1003365.

Zhang,F. et al. (2009) Copy number variation in human health, disease, and
evolution. Annu. Rev. Genom. Hum. Genet., 10, 451—481.

ﬁlO'SIIZLImOprOJXO'SOplZILLIOJLIIOIQ/[idnq

