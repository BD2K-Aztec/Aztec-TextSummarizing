APPLICATIONS NOTE

Vol. 30 no. 6 2014, pages 891-892
doi:1 0. 1093/bioinfonnatics/btt649

 

Gene expression

Advance Access publication November 8, 2013

RNAsquiewer: visualization tool for RNA-Seq data

Xavier Roge1 and Xuegong Zhang1‘2‘*

1MOE Key Laboratory of Bioinformatics, Bioinformatics Division and Center for Synthetic and Systems Biology, TNLIST/
Department of Automation and 2School of Life Sciences, Tsinghua University, Beijing 100084, China

Associate Editor: lvo Hofacker

 

ABSTRACT

Summary: With the advances of RNA sequencing technologies, sci-
entists need new tools to analyze transcriptome data. We introduce
RNAsquiewer, a new visualization tool dedicated to RNA-Seq data.
The program offers innovative ways to represent transcriptome data
for single or multiple samples. It is a handy tool for scientists who use
RNA-Seq data to compare multiple transcriptomes, for example, to
compare gene expression and alternative splicing of cancer samples
or of different development stages.

Availability and implementation: RNAsquiewer is freely available
for academic use at http://bioinfo.au.tsinghua.edu.cn/software/
RNAsquiewer/

Contact: zhangxg@tsinghua.edu.cn

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 17, 2013; revised on October 16, 2013; accepted on
November 5, 2013

1 INTRODUCTION

The development of next-generation sequencing allows large-
scale transcriptome studies, using massively parallel sequencing
of complementary DNA reverse transcribed from RNA (RNA-
Seq) technologies (Mak, 2011; Wang et al., 2009). Scientists now
face the challenge of analyzing the unprecedented amount of
available sequencing data. In addition to the use of automated
tools, such analysis needs human review and interpretation of the
data to gain insight into them, verify consistency of programs’
results, understand intricate cases and structures and reveal
underlying patterns. As data files generated by automated tools
for RNA-Seq analysis are formatted for computational treat-
ments and can exceed gigabytes, they are improper for easy
direct human reading. This calls for effective Visualization
tools, capable of displaying big datasets in intuitive ways.

Genomic Visualization software can be divided into two cate-
gories: web-based genome browsers like those from UCSC and
Ensembl (Kent et al., 2002; Spudich et al., 2007; Wang et al.,
2013) and standalone software including the Integrative
Genomics Viewer and Savant (Fiume et al., 2010; Robinson
et al., 2011). Only the latter category is adapted to the Visualiza-
tion of the large locally stored datasets usually manipulated in
RNA-Seq analysis, as web upload is prohibitive. However, exist-
ing solutions are limited to a few tracks Visualized simultan-
eously, and it is not possible to compare the multiple samples
of medium or large RNA-Seq experiments.

 

*To whom correspondence should be addressed.

Here we introduce RNAsquiewer, a desktop program to Visu-
alize the data from the RNA-Seq analyzing process, for single or
multiple samples. By focusing on expression of genes and tran-
script isoforms, the program offers innovative ways to present the
transcriptome data in a quantitative and interactive manner.

2 IMPLEMENTATION

RNAsquiewer is a cross-platform program implemented in the
language Python (http://www.python.org/). It makes use of the
package PySide, a binding to the graphical library Qt (http://qt-
project.org/wiki/PySide), and the programs Samtools and Tabix
for reading Sequence Alignment/Map (SAM), BAM and gene
transfer format (GTF) ﬁles (Li, 2011; Li et al., 2009).

3 PROGRAM OVERVIEW

3.1 Supported data types

RNAsquiewer supports seven types of data widely used in RNA-
Seq analysis (see Table 1). The program can read the results of
RNA mappers like TopHat (Trapnell et al., 2009), namely, read
alignments in SAM/BAM format and splicing junction sites in
BED format. A third major type consists in transcriptomes,
assembled by programs like Cufﬂinks (Trapnell et al., 2010) in
GTF format. Reference sequence and genome annotations can be
loaded from ﬁles, respectively, in FASTA and RefFlat or GTF
format. The program also supports Wiggle format to Visualize
dense numeric data and BED format for any other type of tracks.

3.2 Graphs

We designed the graphs with three objectives in mind: (i) display
as much information as possible while keeping the resulting
graph simple, (ii) offer compact Views to allow dozens of

Table 1. Types of data and graphs supported by RNAsquiewer

 

Data type Format Views

 

Reads alignments SAM/BAM Mapped reads, read coverage,
heatmap-like View

Splicing junctions BED Junction lines, junction reads

Transcriptomes GTF Expanded View, collapsed View

Genome annotations RefFlat, GTF Expanded View, collapsed View

DNA sequence FASTA Sequence
Numeric data Wiggle Histogram
Other tracks BED Expanded View, collapsed View

 

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 891

112 /310's112u1n0fp10}x0"sotJBuiJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

9103 ‘Og isnﬁnV uo ::

X.Rogé and X.Zhang

 

tracks to be seen simultaneously and (iii) keep the Views intuitive
for biologists in regard to current Visualization standards.

Therefore RNAsquiewer offers different types of graphs for
each type of data (see Table 1 and Supplementary Figs S2 and S3).
They can be chosen by the users according to their needs and they
automatically adapt to the scale with a semantic zoom approach.

Many graphs use colors as a mean to display more data with-
out overloading the graph and in a compact way. Colors repre-
sent scores like read count or FPKM (Fragments per kilobase of
exon per million fragments mapped) in heatmap-like graphs, or
they are used to highlight signiﬁcant details like potential single
nucleotide polymorphisms. Additional data are displayed in tool
tips or in an optional frame.

For all graphs, intronic regions can optionally be hidden. This
is especially useful for genes with long introns and short exons.
In this mode, the exons of these genes can be Viewed on a single
screen without being shrunk, hence offering a better View of data
mapped to the exons.

3.3 User interface

Seamless browsing of the datasets is highly desirable to gain an
extensive insight into the data. To achieve this goal, RNAseq-
Viewer offers a dynamic user interface (see Supplementary Fig.
S1) and preloads data next to the current View so that they can be
displayed immediately when browsing around.

Users can either use the mouse or the keyboard to navigate
along the chromosomes in a Google Maps-like fashion. Panning
is achieved by dragging the tracks, and zooming is achieved by
scrolling with the mouse wheel. Alternatively users can use the
interface’s navigation buttons or the keyboard shortcuts. Search
for gene name and coordinates input allow direct access to spe-
ciﬁc locations.

3.4 Memory and speed performances

Special attention has been given to the memory management so
that gigabyte-sized datasets can be Visualized without exceeding
the memory limits or impacting speed performance.
RNAsquiewer only loads in memory the data that are imme-
diately necessary and those that are close to the current View.

A speciﬁc strategy is applied for file formats usually chosen for
big datasets. Before Visualizing files in BAM, GTF or FASTA
format, an index ﬁle is created using Samtools or Tabix. Thanks
to the index, data do not need to be fully loaded in memory, yet
they are remotely accessible in a short time.

4 USE EXAMPLE

Among other datasets, RNAsquiewer has been tested with the
data deposited in the Gene Expression Omnibus (http://www.ncbi.
nlm.nih.gov/geo/) under accession number GSE22260 (Kannan
et al., 2011). The dataset contains 36-nt pair-end reads sequenced
with Illumina GAII platform from 20 prostate cancer tumors and
10 matched normal tissues. We mapped the reads on the reference
human genome hg18 with TopHat and used the result for de novo
transcriptome assembly with Cufflinks. Figure 1 and
Supplementary Figure S3 show screenshots of the data loaded in
RNAsquiewer on a Linux system with a RAM of 1 GB.

Funding: This work is supported in part by the National Basic
Research Program of China (2012CB316504), the Hi-tech

RN-aseqv law-2r

: mam-154114391157 mt  lg  lg .\ a" '9

 

 

 

duo : upuinruﬁsraa} OK  LQ  lg) “ _.‘ E IBRDZ 
55

   _....i...._i__1:i iMIIL. 
I. I IIII_/\ III III

CUFFJIZQIJ CUFFJIPITA

curmzzsm
II- I I

 

 

I I |
curmzzan

Fig. 1. Screenshots of RNAsquiewer. The visualized dataset contains
36-nt pair-end reads from 20 prostate cancer tumors and 10 matched
normal tissues. The reads have been mapped to the reference human
genome hg18 with TopHat. (A) Heatmap-like View of gene expression
of the 20 tumor samples (top 20 lines) and 10 control samples (bottom 10
lines) for two isoforms of the gene HDAC2. Colors depend on the FPKM
of the sample represented by the line and the exon represented by the
column. Intronic regions are hidden. The graph was generated from the
30 BAM ﬁles resulting from reads mapping. (B) Gene expression of one
sample: read coverage, splicing junctions, with colors depending on the
junction reads count, and transcripts, with colors depending on FPKM.
The two ﬁrst graphs were generated from TopHat output (BAM and
BED ﬁle) and the latter from cufﬂinks output (GTF ﬁle)

Research and Development Program of China (2012AA020401)
and NSFC grant 91010016.

Conﬂict of Interest: none declared.

REFERENCES

Fiume,M. et a]. (2010) Savant: genome browser for high—throughput sequencing
data. Bioinformatics, 26, 193871944.

Kannan,K. et a]. (201 1) Recurrent chimeric RNAs enriched in human prostate cancer
identiﬁed by deep sequencing. Proc. Natl Acad. Sci. USA, 108, 917279177.

Kent,W.J. et a]. (2002) The Human Genome Browser at UCSC. Genome Res., 12,
99(r1006.

Li,H. (2011) Tabix: fast retrieval of sequence features from generic TAB—delimited
ﬁles. Bioinformatics, 27, 7187719.

Li,H. et a]. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinformatics, 25, 207872079.

Mak,H.C. (2011) Next—generation sequence analysis. Nat. Biotechnol., 29, 45419.

Robinson,J.T. et a]. (2011) Integrative genomics viewer. Nat. Biotechnol., 29, 24e26.

Spudich,G. et a]. (2007) Genome browsing with Ensembl: a practical overview.
Brief. Funct. Genomic Proteomic, 6, 2027219.

Trapnell,C. et a]. (2009) TopHat: discovering splice junctions with RNA—Seq.
Bioinformatics, 25, 110571111.

Trapnell,C. et a]. (2010) Transcript assembly and quantiﬁcation by RNA—Seq re—
veals unannotated transcripts and isoform switching during cell differentiation.
Nat. Biotechnol., 28, 5117515.

Wang]. et a]. (2013) A brief introduction to web—based genome browsers. Brief.
Bioinform., 14, 1317143.

Wang,Z. et a]. (2009) RNA—Seq: a revolutionary tool for transcriptomics. Nat. Rev.
Genet., 10, 57%}

 

892

112 /310'S[BHJDOIPJOJXO"SOIJBHIJOJIIIOIq/ﬂdnq 11101} papeolumoq

9103 ‘Og isnﬁnV uo ::

