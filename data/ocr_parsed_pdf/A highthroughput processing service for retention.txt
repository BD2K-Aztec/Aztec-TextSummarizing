Vol. 27 no. 8 2011, pages 1176-1178
APP N doi:10.1093/bioinformatics/btr094

 

Systems biology

Advance Access publication February 23, 2011

A high-throughput processing service for retention time
alignment of complex proteomics and metabolomics LC-MS data

Isthiaq Ahmad1’2’3al, Frank Suits“, Berend Hoekmanl, Morris A. Swert22’3’5,

Heorhiy Byela31’2’5, Martijn Dijkstra1’2’6, Rob Hooft2, Dmitry KatsuboZ,

Bas van Breukelen2’3’7, Rainer Bischofilaza3 and Peter Horvatovich1’2’3a*

1Analytical Biochemistry, Department of Pharmacy, University of Groningen, Groningen, 2Bioassist, Netherlands
Bioinformatics Centre, Nijmegen, 3Bioinformatics in Proteomics, Netherlands Proteomics Centre, Utrecht,

The Netherlands, 4Protein Science Group, IBM T.J. Watson Research Centre, Yorktown Heights, New York, USA,
5Genomics Coordination Center, Department of Genetics, University Medical Center Groningen, Groningen, 6Center
for Medical Biomics, University of Groningen Groningen and 7Biomolecular Mass Spectrometry and Proteomics

Group, Utrecht University, Utrecht, The Netherlands
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: Warp2D is a novel time alignment approach, which uses
the overlapping peak volume of the reference and sample peak
lists to correct misleading peak shifts. Here, we present an easy-
to-use web interface for high-throughput Warp2D batch processing
time alignment service using the Dutch Life Science Grid, reducing
processing time from days to hours. This service provides the
warping function, the sample chromatogram peak list with adjusted
retention times and normalized quality scores based on the sum
of overlapping peak volume of all peaks. Heat maps before and
after time alignment are created from the arithmetic mean of the
sum of overlapping peak area rearranged with hierarchical clustering,
allowing the quality control of the time alignment procedure. Taverna
workflow and command line tool are provided for remote processing
of local user data.

Availability: online data processing service is available at
http://www.nbpp.nl/warp2d.html. Taverna workflow is available
at myExperiment with title ‘2D Time Alignment—Webservice
and Workflow’ at http://www.myexperiment.org/workflows/.html.
Command line tool is available at http://www.nbpp.nl/Warp2D_
commandline.zip.

Contact: p.l.horvatovich@rug.nl

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 18, 2010; revised on January 12, 2011;
accepted on February 14, 2011

1 BACKGROUND

Retention time alignment to correct non-linear retention time shifts
(Podwojski et (11., 2009) between different chromatograms is a
crucial step in the processing of label-free liquid chromatography

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that. in their opinion, the ﬁrst two authors
should be regarded as joint First Authors.

coupled to mass spectrometry (LC-MS) data for proteomics and
metabolomics comparative proﬁling studies. A complex ‘omics’
chromatogram contains signals from thousands of compounds, and
small shifts may lead to improper matching of peaks that are
derived from the same compounds leading to inaccurate statistical
analysis and possibly to erroneous conclusions on the experimental
outcome (Christin et (11., 2008, 2010; Suits et (11., 2008). We have
recently published a novel time alignment algorithm, Warp2D (Suits
et (11., 2008), that is based on correlation optimized warping (COW)
(Christin et (11., 2008; Nielsen et (11., 1998; Tomasi et (11., 2004;
van Nederkassel et (11., 2006) to maximize the total peak volume
overlap between the reference and sample chromatograms using LC-
MS peak lists as input data. The peaks in these LC-MS peak lists
are considered as three-dimensional Gaussian peaks in the retention
time, mass to charge ratio and intensity space. Peak widths in the
retention time and mass to charge ratio are related to the mass and
chromatographic resolutions, and analytical formula can be derived
to calculate the individual peak volume and peak volume of the
overlap of multiple peaks. Overlap of multiple peaks is used in the
beneﬁt function of the COW procedure in Warp2D (Suits et (11.,
2008) to drive the retention time correction. By considering the
overlap of three dimensional Gaussian peaks, Warp2D takes account
for the separation of peak in mass dimensions beside the separation
of the peaks in the retention time dimension when correcting for non-
linear retention time shifts. The concept of Warp2D is fundamentally
new compared with other time alignment methods either using one-
dimensional mass traces (Eilers, 2004; van Nederkassel et (11., 2006)
in their beneﬁt function, peak lists of multiple chromatograms with
local regression techniques (Podwojski et (11., 2009), algorithms
using a two-dimensional beneﬁt function such as a Hidden Markov
Model combined with a Continuous Proﬁle Model (Listgarten et (11.,
2007) or the recently introduced COW-CODA (Christin et (11. , 2008),
PTW—CODA and DTW—CODA (Christin et (11., 2010) algorithms
combining COW, dynamic time warping (DTW) (Kassidas et (11.,
1998) and parametric time warping (PTW) (Eilers, 2004) with a
Component Detection Algorithm (CODA) (Christin et (11., 2008). We
previously showed that Warp2D can successfully align peak lists of
chromatograms obtained from complex serum and urine samples,

 

1176 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 ﬁlo's[sumo[pJOJXO'sotwuiJOJutotqﬂ:duq mot} papBOIII/lAOG

9103 ‘Og anﬁnv uo ::

Retention time alignment

 

A 24x24_Lab1_Lab2 unwarped

Lab2_MDlusDYS_Plos|aI:TRAMP_rlormal_RLS:
LabQ_MpuaCVS_Pm:IaIETRAMP_ILnl5r_Rl_3o
Lah!_M:lllsCY‘S_Br:alerrnoo9r_n _3:
Lm?_lr\:lLBCYS_B(:a§|Chomsr_rerror_Rl_3:
Lan2_rrplw3rs_l.urqEGFl~l_nmnal_nl_3:
LaD2_¥MS_Br&iSICMdom_ﬂmnal_ﬁl_3€
Lm2_mn$_areaslcmuosn_lm_m_ac

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
  
   
 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

L312 MARS LUI'IIEGFR normal E1 36

Law MARS Proalale‘l'RnMP rumor R1 36
Lm:_wrns_LungEom_lm_Rl_3:
Lab2_ms_Plu:lal:Tle=_nml_Rl_3:
Lan2_l-tluscvs_LungEGl=R_l _3:
Lam_NARS_Bruaslcrraauyl_nml-ul_m_§c
Lml_mns_LungEGr=R_nml_Rl_s:
Lml_MllRS_LungEGFR_ll.mnr_Rl_3:
Lwr_mu$jreaslcm¢osr._lmlor_m_ac
Lapl_mﬁs_l=wslala'lRAMl=_nmnal_nLac
Labi_MAﬁ5,PmalaleTﬁnMr‘_lmnﬁl_3c
Lem_wluacvs_areeslcmom_nmnal_nl_3c
LS11_WI|3CYS_BreaaICmaosr‘lm_ﬁI_3c
Lml_h\:lL5CY8_LungEGFR_norrnal_Rl_3c

Labl_Mnll.uCYS_LalngEGFR_lerror_Rl_3: Q1
LaDl_Mplu§CYS_Prlo§|mnmmp_nml_Rl_3:
Lam_Mpuscrs_l=mhalaluml—‘merjc D

so
Ill:
3:
3c

##1##

El
.1.
E
EI
a
a
s
ﬁl
g?
'51
3
:1
a

1:

LQM,MA.R5 Bmwﬂhmmh llulnor R1 36

lalﬁlﬁllﬁ 3 at at 8'3 #1 61

:R
R normal RI

Lm‘ MARS hmmIRAMP humor R

LGDIJHWUBCYS areaalcmoaan normal R

R mmur_R'

LSDIMWBCYS Bramrchodmh tumor

R norIrral R]

S DaulChodoelh tumor R

vs Prmurrwi mm RI 3:
vs Frmurm mm m a:

MousCYSJmﬁGF

Lane maﬁa Ll.n

pulsar

Lam_MpuscTrs_Lm3£GF
Lara: mltscvs ProstalzTRW norrrral R

Lab? MARS B'ualﬁhoaoelh norrrral R
WILSCY‘S Fraulsz norrrral R'

Lanl_MpuscTrs_LmuEGF

tmE_N!r:lus€
Lam

Lab! MRRS FroaulzTRJIMP normal R

Lam M

Lm‘
Lm1 Manse

B 24x24_Lab1_Lal:l2 warped

  

LaDQ_MwsCYsjvoalaleTRAMPﬁmaLRl 3c
Lab2_l\lp|.lsCr’S_Prlo5taloTRJ\MP_Ierror_RI 3:
I.m2_WlusCYS_Br:u:lCmﬂo9r_nmal_Rl 3: 0.9
Lm?_|lh|LBCYS_Erau:|CholJoslt_Ierru_RI 3:
Lah2_rl\:lmcvs_L-ngGr=R_nmal_nl 3: as
l:h)_MnRS_Brmslcrmugl_nwmal_Rl 3:
Laa2_Mr\RS_Bmaslcmol-.lm_ll.mnr_nl :5:
Lnn2_mlas_L.mEGFR_nwmal_lal . 0.7
l.an2_MmajmsralaramFJwHo-jl 3c
Lan2_mns_Luanc.Fn_luwar_m 3:: 0.5
LaMaRS_FwstaleTﬁMlll=_nunlal_nl 3c
LEKWIECYS_LunaEGFﬁ_ImIor_RI 3c 0 5
Labl_|l.nﬂ3_ﬁrees|cho¢o§l_nblmal_ﬁl 3c -
Lm1_mRS_LJmEGFRNﬂUma|_lec
Lem_MnR5_LungEGFﬁ_lunnr_nl_3c 0.4
LdJ!_MAR,S_Emu:|Chomsll_anlu_R1_3:
La:l_ms_9lu:lal:TRAMl=_nml_nl_3: 03
Lzbl_MARs_Pluml:Tﬂml=_lum_Rl_3:
Lahl_wlu S_Brna§lCmduvr_nulrrral_Rl_3c
La::_wlmcvs_aruslcmmm_lmnr_nL3: D.2
Labl_n\;lmcvs_L-ngaR_nmal_nl_3:
LaDlJ-blmﬂ“ 5_Ll.anGF R_ILI'IIU'_RI_3C 0.1
LaDl_MDU5CYS_FmstaIBIRAMl-'_nnlmal_liL3G
I.rrm_MpLl!CY3_FmatalnTRnMF_Ilmnr_RI_3r: o

 

R nonrral R

RhurrnrR

r an:_upuscv$_l.ng GFR_|urrror_R

lab] MARS Emancan normal

LabQ MARS Breaﬁllrroooah tumor R

R_n.lrrrar

s Bruntﬁhcdosrr norrrla|_

R:nor:rral
Inn was momma“; tumor

R normal R
Bremﬂrrodosh lurrror

gEGF

uh? nuns nusfamrmulp normal R

gEGF

La)? MARS Phoslme'lRJIMP tumor R

s_lulgml:

Laul_mns_LungEoF
Lahl ultras Brmﬂnmnah rum

LabQ M193 Lurl
lahl Han

Y5 mmrm mm:

wusCV'SJu'rﬁ or

Lab2 Mnﬁs Lu'l

piscv
Mangers

Lan-_uphsCVS_ngEI3FR_lumar

uhl_wuscvs_ngEoFrl_mnal
Lal_MplmCY$_Pm=l=la lRJlldLmrrrral

Lab!

lam mans MalamIRﬁMP normal
Lahl

Labe_wusCY$_Banndmh_lumar_R

Labl_MP-us

Lab2_Mpuscvs_araad:m-lmh_mmal_n
Lab] M

Fig. 1. Heat map showing the arithmetic mean of the overlapping peak volume calculated before (A) and after (B) time alignment using all possible alignment
pairs between 24 chromatograms (576 time alignments) obtained in an experimental design study of a shotgun proteomics analysis of mouse serum (higher is
better). Rearranging the order of the reference and sample peak lists using hierarchical clustering of the obtained quality scores after time alignment provides
an overview over clusters with peak lists of high similarity, for which time alignment was successful. In this example, chromatograms obtained within the
same laboratory form separate clusters, indicating that time alignment is only successful between ﬁles from the same laboratory using the applied parameters
(mzwidth 0.1; rtwidth 0.2; Window size 50; Slack 20; Max peaks/segment 50; No. of time points 2000; Cons. time shift 0).

even if compounds in these samples have large concentration
variability with maximum 3—5 min of retention time shifts.

Here, we report development of a high-throughput processing
service to perform time alignment and quality assessment based
on the Warp2D approach. This service is able to perform several
hundreds of time alignments per hour for a large number of users
by using the Dutch Life Science Grid (DLSG) through an easy-
to-use web interface available at the portal of the Netherlands
Bioinformatics for Proteomics Platform.

2 EASY-TO-USE WEB PAGE FEATURES

Warp2D uses space-delimited ASCII peak lists with three columns
containing the mass to charge ratio, retention time and peak quantity
(height, area or volume). We have chosen this simple format because
there is no accepted standard format to store LC-MS peak list.
European Bioinformatics Institute is preparing the szuantML
standard format for preprocessed LC-MS data such as peak lists
and aligned peak matrix (Orchard et (11., 2010) and currently the
APML format introduced in Corra (Brusniak et (11., 2008) LC-MS
data processing framework is the only available format to store this
type of data. We have, therefore, developed a tool that converts LC-
MS peak lists in APML format to our format and placed the converter
as java command line tool at http://www.nbpp.nl/warp2d.html. As
soon as the new ofﬁcial szuantML format will be available, we
will provide the possibility to use data in this format. The full
parameter list, input/output ﬁle formats with detailed explanations,
tutorial and example dataset used in this application note are
available at the web page of the Warp2D processing service
(http://www.nbpp.nl/warp2d.html).

Warp2D generates three output ﬁles: the warped sample
chromatogram peak lists with .wpks extension, the .tmap ﬁle
containing the segment endpoint pairs in the time unit of the
original peak list before and after time alignment and the quality ﬁle
with .qual extension containing all parameters and quality scores
reﬂecting the similarity of the reference and sample peak lists
before and after time alignment. Since the .tmap ﬁle contains the
retention time transformation of the sample chromatogram segment,
one can use it to calculate any retention time shift by linear
interpolation within the corresponding time segment. Details on the
quality score and the most important parameters are provided in the
Supplementary Material.

3 TAVERNA WORKFLOW AND COMMAND LINE
OPTION

The web user interface provides a convenient easy-to-use access
to the high-throughput Warp2D LC-MS time alignment service.
This application is build on a web service, and to facilitate the
reuse of this web service programmatically by bioinformaticians, we
developed a Taverna (Hull et (11., 2006) workﬂow and command line
java tool (supporting material and http://www.nbpp.nl/warp2d.html,
the web page contains a detailed description of these tools). These
tools enable simple remote processing of data located on a user’s
computer, automating the process of sending data to and from the
grid computational resource. These tools allow the incorporation of
the Warp2D LC-MS time alignment service into Taverna pipeline or
in any other program or script while having the beneﬁt of the vast
processing power of the DLSG.

 

1177

112 ﬁlo's[Bumo[pJOJXO'sotwulJOJutotqﬂ:duq uteri papeolumoq

9103 ‘Og anﬁnv uo ::

I.Ahmad et al.

 

4 CASESTUDYANDCONCLUSONS

Figure 1 presents two heat maps before and after time alignment
showing the arithmetic mean of the sum of overlapping peak volume
for 24 chromatograms obtained in an experimental design study to
measure proteins quantity in serum from different mouse cancer
models, treated with different depletion techniques, measured in
different laboratories with different Quadrupole Time Of Flight
mass spectrometers, from healthy mice or mice with cancer using
a shotgun proteomics approach. The order of ﬁles was rearranged
using hierarchical clustering of the arithmetic mean of the sum of
overlapping peak area in order to identify chromatogram clusters
with high similarity. The quality of the heat maps in Figure 1
indicates that chromatograms acquired within the same laboratory
can be successfully aligned. The quality matrix that served for the
heat maps can be used to select the best reference chromatograms
for the ﬁnal time alignment (e.g. the peak list having the highest
quality score after time alignment) for the two peak list clusters.
The user-friendly web interface destined for users with little
bioinformatics experience allows the use of the Warp2D approach
for alignment of large numbers of complex LC-MS chromatograms
and provides an overview on the ﬁle clusters which can be
successfully aligned within a given dataset. Execution time with
regular settings of one alignment using peak lists of 5 MB containing
200 000 non deisotoped and non-decharged peaks takes 8—12 min on
a regular PC (Intel® CoreTM Quad CPU Q9300 @ 2.5 GHz processor
and 8 GB of RAM), while 576 time alignments of 24 peak lists took
40—70 min using our web portal depending on the availability of the
DLSG computational resources. The same number of alignments on
a PC with single or four processing nodes would take 4 days or 1
day, respectively. The processing service includes free access to 10
GB of disk space to store the initial peak lists and processing results.

Funding: Bioassist program of the Netherlands Bioinformatics
Center (reference NBIC/KvH/ff/2007.049); NWO (Rubicon

Grant 825.09.008); Netherlands Proteomics Center II (reference
NPC II E4.2) for ﬁnancing this research and SARA for providing
access to DLSG.

Conﬂict oflnterest: none declared.

REFERENCES

Brusniak,M.Y. et al. (2008) Corra: computational framework and tools for LC-MS
discovery and targeted mass spectrometry-based proteomics. BMC Bioinformatics,
9, 542.

Christin,C. et al. (2008) Optimized time alignment algorithm for LC-MS data:
correlation optimized warping using component detection algorithm-selected mass
chromatograms. Anal. Chem, 80, 701277021.

Christin,C. et al. (2010) Time alignment algorithms based on selected mass traces for
complex LC-MS data. J. Proteome. Res., 9, 148371495.

Eilers,P.H. (2004) Parametric time warping. Anal. Chem, 76, 404—411.

Hull,D. et al. (2006) Taverna: a tool for building and running workﬂows of services.
Nucleic Acids Res., 34, 7297732.

Kassidas,A. et al. (1998) Synchronization of batch trajectories using dynamic time
warping. AIChE J., 44, 8647875.

Listgarten,J. et al. (2007) Difference detection in LC-MS data for protein biomarker
discovery. Bioinformatics, 23, e1987e204.

Nielsen,N.P.V. et al. (1998) Aligning of single and multiple wavelength
chromatographic proﬁles for chemometric data analysis using correlation optimised
warping. J. Chromatogn A, 805, 17735.

Orchard,S. et al. (2010) Tackling quantitation: a report on the annual Spring Workshop
of the HUPO-PSI 28-30 March 2010, Seoul, South Korea. Proteomics, 10,
306273066.

Podwojski,K. et al. (2009) Retention time alignment algorithms for LC/MS data must
consider non-linear shifts. Bioinformatics, 25, 7587764.

Suits,F. et al. (2008) Two-dimensional method for time aligning liquid chromatography-
mass spectrometry data. Anal. Chem, 80, 309573104.

Tomasi,G. et al. (2004) Correlation optimized warping and dynamic time warping
as preprocessing methods for chromatograpic data. J. Chemometrics, 18,
2317241.

van Nederkassel,A.M. et al. (2006) Acomparison of three algorithms for chromatograms
alignment. J. Chromatogn A, 1118, 1997210.

 

1178

112 ﬁlo's[Bruno[pJOJXO'sotwulJOJHtotqﬂ:duq uIOJJ papeo1umoq

9103 ‘0g15n8nv uo ::

