Bioinformatics, 32(4), 2016, 557—562

doi: 10.1093/bioinformatics/btv626

Advance Access Publication Date: 29 October 2015
Original Paper

 

 

Genetics and population analysis

SeqSIMLA2_exact: simulate multiple disease
sites in large pedigrees with given disease
status for diseases with low prevalence

Po-Ju Yao and Ren-Hua Chung*

Division of Biostatistics and Bioinformatics, Institute of Population Health Sciences, National Health Research

Institutes, Zhunan, Miaoli County, Taiwan

*To whom correspondence should be addressed.
Associate Editor: Janet Kelso

Received on April 17, 2015; revised on September 8, 2015; accepted on October 22, 2015

Abstract

Summary: It is difficult for current simulation tools to simulate sequence data in a pre—specified
pedigree structure and pre—specified affection status. Previously, we developed a flexible tool,
SeqSlMLAZ, for simulating sequence data in either unrelated case—control or family samples with
different disease and quantitative trait models. Here we extended the tool to efficiently simulate
sequences with multiple disease sites in large pedigrees with a given disease status for each
pedigree member, assuming that the disease prevalence is low.

Availability and implementation: SeqSlMLA27exact is implemented with C++ and is available at

http://seqsim la.sou rcefo rge. net.
Contact: rchung@nhri.0rg.tw

 

1 Introduction

Family studies based on next-generation sequencing (NGS) have
become important in complex disease studies because a sufficient
number of rare alleles that co-segregate with the disease can be
observed in pedigrees (Wijsman, 2012). To evaluate the statistical
power for family-based disease studies using NGS, it is necessary to
simulate sequencing data in a given family structure with disease
status. Moreover, as multiple variants can contribute to the disease,
it is crucial to simulate the joint effects of multiple variants on the
disease.

We searched the Genetic Simulation Resources website (Peng
et (11., 2013), which provides a comprehensive catalog of simulation
tools for genetics studies, and identified four tools, ForSIM
(Lambert et (11., 2008), Nemo (Guillaume and Rougemont, 2006),
simuPOP (Peng and Amos, 2008) and SeqSIMLAZ (Chung et (11.,
2015), that can simulate sequence data in families with affection
status. ForSIM, Nemo and simuPOP use forward-time algorithms,
which dynamically determine pedigree structures during the simula-
tion. Therefore, it may not be easy to obtain pre-specified pedigree
structures from the simulation results. SeqSIMLAZ uses a gene-
dropping algorithm to easily simulate pedigrees with pre-specified

structures. However, it is very time consuming for the gene-
dropping algorithm to simulate exactly the same affection status as
the pre-specified status for every family member, particularly in
large pedigrees and diseases with low prevalence. Another simula-
tion tool, SimRare (Li et (11., 2012), which shares some properties
with SeqSIMLAZ, can simulate multiple disease loci in sequence
data; however, SimRare only simulates unrelated case-control data.
In order to efficiently simulate genotypes conditional on the fam-
ily structure and disease status, a retrospective likelihood, which is
the probability of observing genotypes in each family member given
the disease status, needs to be calculated. However, calculating the
retrospective likelihood is typically based on computationally inten-
sive algorithms such as Elston—Stewart (Elston and Stewart, 1971)
and Markov Chain Monte Carlo (MCMC) algorithms. For example,
tools such as FastSLINK (Ott, 1989), SUP (Lemire, 2006),
SimWalkZ (Sobel and Lange, 1996) and MORGAN (Thompson,
2005) have implemented or extended one of the aforementioned
algorithms for simulating genotypes given the trait data. Due to the
computational complexity, these tools can simulate only one disease
locus. Moreover, although multiple markers not associated with the
disease locus can be simulated, SimWalkZ and MORGAN assume

(6) The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 557

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

558

P.—J. Yao and R.—H. Chung

 

that the markers are in linkage equilibrium, while FastSLINK and
SUP can simulate few markers that are in linkage disequilibrium
(LD). These tools may not be suitable to evaluate the joint effects
of multiple disease loci. Moreover, these tools are not suitable to
simulate NGS data, which involve millions of variants with complex
LD structures.

Here we extended SeqSIMLA2 to SeqSIMLA2_exact for simulat—
ing sequence data given the pedigree structures and disease status
for all family members. When the disease prevalence is low, we
show that the retrospective probability can be efficiently approxi—
mated without using computationally intensive algorithms.

2 Methods

For a pedigree with 11 members, assume x : (x1. ....xn) is a vector of
disease phenotypes and h : (101. .... Ian)is a vector of haplotype pairs
at the disease loci for the 11 individuals. Assume c : (c1. .... 6,) is a
vector of recombination rates at s recombination hotspots within
the haplotype region. Family members without parents are referred
to as founders, while family members with parents in the pedigree
structure are referred to as non—founders. Assume hf is a subset of h
that contains haplotype pairs of founders and hnf is the complement
of hf containing haplotype pairs of non—founders. The probability of
h can be calculated as

P(th7 C) : P(hf7 hnflxvc) : P(hflx7 C)P(hnflhfvxv C) 

First we calculate P(hf(x. c). Assume (101, . . . 10,4) is a subset of haplo—
types in hf that have been simulated. As shown in the Appendix A,
assuming no inbreeding and random mating, the probability for 19,
at founder i is calculated as

P(hiaxiac)P(xi+1amaxnlcahla---7]7i7x17---7xi)
P(xi7C)P(xi+17"'7xnlcvh17"'7hi—17x17---7xi)
(2)

P0911191, ---7]7i—17X7C) I

 

The denominator is the sum of the numerators over all possible
haplotypes of individual i. The probability P(la,~,x,~,c) is further
derived as P(xi ( hi.c)P(/ai.c), which can be easily calculated based
on the penetrance functions and disease haplotype frequencies.
Calculating the probability P(xi+1. ....xn(c. 191, ...,la,~,x1, ...,x,-) in Eq.
(2) requires the consideration of affection status for family members
who have not been simulated, given the haplotypes and affection
status for family members who have been simulated. This process
can be time consuming for a large pedigree. To efficiently calculate
the probability, we only consider the affection status for family
members in the same nuclear family as individual i. It is also com—
monly assumed that given a person’s haplotypes, the person’s affec—
tion status is independent of any other person’s haplotypes (Laird
and Lange, 2011). Moreover, conditional on parental haplotypes,
siblings” haplotypes are independent. Based on these assumptions,
the probability is written as

1309417 "'7xnlc7blv ---7/7i7x17 mixi) : 13061417---7xlle7/717---7/7i7x17---7xi)

I: I:
2 2 H Perl/one) H P(/7rl]717---7/7i)

r69 r:i+l r:i+l

(3)

where individuals 1' + 1 through k are in the same nuclear family as
individual i, and Q is a set of all possible haplotypes of individuals
1' + 1 through k given the haplotypes for family members that have
been simulated. Note that we assume that the haplotypes and

affection status for the family members who have been simulated
(i.e. individuals 1 to i) are independent of the affection status of
other family members who are not in the same nuclear families as in—
dividuals 1 to 1'. Our simulation results in the Results section suggest
that this assumption holds for diseases with low prevalence.

Next we calculate P(hnf(hf.x. c)in Eq. (1). If 19, is the haplotype
pair at non—founder/ and (lam, . . 10,4) is a subset of haplotypes in hnf
that have been simulated, the probability of haplotype pair 10, at
non—founder / can be calculated as

P(h/lhf7hm7 ---7hj—17X7 C)

1‘
: P(/a,~(/ap,laq,c)P(x/+1, ...x,,(hf, lam, ...,/a,-,x1, ...,x,-. c)HP(x,(Ia,.c)/D
r:1

(4)

where (lain/94) E hf are the parental haplotypes of la, and D is the
sum of the numerators over all possible haplotype pairs of a child
whose parental haplotypes are(/ap. [04). Detailed derivation of Eq. (4)
can be found in the Appendix A.

Based on Eqs. (2) and (4), we developed an efficient algorithm to
simulate disease haplotypes for large pedigrees:

1. Simulate hf based on Eq. (2).

2. Identify one of the top founders m and set one of m’s children
as k.

3. Simulate [0,5 for k using Eq. (3).

4. 4.1. If k has a spouse, set k’s spouse as k and go to step 3.
4.2. If k has at least one sibling, set one of k’s siblings as k and
go to step 3. Repeat Step 4.2 until all siblings of k have been
simulated.
4.3. If k has at least one child, set one of k’s children as k and go
to step 3. Repeat Step 4.3 until all children of k have been
simulated.

After the disease haplotypes have been simulated for all members,
the sequences for the members can also be efficiently simulated using
the original SeqSIMLA algorithm (Chung and Shih, 2013). To be
more specific, SeqSIMLA requires a population of sequences (i.e.
haplotypes) in an external file. As previously described in (Chung and
Shih, 2013), these sequences can be generated by several simulation
tools such as HAPGEN2 (Su et al., 2011) and COSI (Schaffner et al.,
2005). In general, a population of 10000 sequences is required for
SeqSIMLA. Each sequence then has an index, which ranges from 1 to
10000. After reading the external sequences, SeqSIMLA extracts
the haplotypes at the disease sites selected by the user. The haplotype
frequencies and haplotype pair frequencies are calculated based on
the external sequences. When a haplotype pair 10, in founder i is deter—
mined based on Eq. (2), two haplotypes in the external haplotypes
which are consistent with 10, are randomly selected. The indices for
the two randomly selected haplotypes are assigned to individual
1'. When a haplotype pair 10, in non—founder / is determined based on
Eq. (4), the inheritance vectors, including the crossover events, are
assigned to individual /. Finally, after all members in a pedigree have
been simulated, their sequences can subsequently be simulated rapidly
based on the founders” sequence indices, non—founders” inheritance
vectors and the external sequences.

We used simulation studies to evaluate the performance of the
algorithm. Different simulation scenarios with parameters of minor
allele frequencies (MAFs) and odds ratios for the disease sites,
disease prevalence and family structures were used. We selected
three common variants with MAFs of 0.03, 0.05 and 0.13 as the
disease sites. We also selected three rare variants with MAFs of

ﬁJO'SWHmOFPJOJXO'SOplZIIJJOJLIIOIQ/[idnq

 

Table 1

Table 1

Table 2

Figure 1

Dudbridge, 2008

Eq. (3)

/310'SIBan0[pJOJx0"sorJBuiJOJurorqﬂ:dnq

Table 5

Table 5

Table 3

Figure 2

Figure 2

Eqs. (3)

(4)

Table 4

Run time with different numbers of hotspots

a 5

Humbor of [Immiﬂlliﬂll M590“

 

/310'SIBan0[pJOJx0"sorJBuiJOJurorqﬂ:dnq

Simulating exact disease status in large pedigrees

561

 

At present, SeqSIMLA2_exact assumes that the affection statuses
for all family members are given. To account for missing pheno—
types, the probability in Eq. (1) can be extended to P(h.xu(x.c),
where xI1 is a vector of the affection statuses of individuals whose af—
fection statuses were not given. We hope to implement this function
in SeqSIMLA2_exact in the near future.

In conclusion, SeqSIMLA2_exact will be useful to simulate se—
quence data with multiple disease sites in large pedigrees when the
disease prevalence is low. SeqSIMLA2_exact is implemented in
SeqSIMLA2 with the —exact option, which is available from http://
seqsimla.sourceforge.net.

Funding
This study was supported by grants from the National Health Research

Institutes (PH-104-PP-10) and National Science Council (NSC 102-2221-E-
400-001-MY2) in Taiwan.

Conﬂict of Interest: Home declared.

References

Chung,R.H. and Shih,C.C. (2013) SeqSIMLA: a sequence and phenotype simu-
lation tool for complex disease studies. BMC Bioinformatics, 14, 199.

Chung,R.H., et al. (2015) SeqSIMLA2: simulating correlated quantitative
traits accounting for shared environmental effects in user-speciﬁed pedigree
structure. Genet. Epidemiol., 39, 20—24.

Dudbridge,F. (2008) Likelihood-based association analysis for nuclear
families and unrelated subjects with missing genotype data. Hum. Hered., 66,
87—98.

Elston,R.C. and Stewart,]. (1971) A general model for the genetic analysis of
pedigree data. Hum. Hered., 21, 523—542.

Appendix A

A1. For simulating haplotypes in founders
We calculate the probability of a haplotype pair la, at founder 1' given
the known information:

P(/717~q/717X7‘3)
P071, w,l”),,1, X, C)
7 P(l2,,x,,c)P(/71, w,la,,1,3c1,...,3c,,1|l2,,3c,,c)P(3c,+1,...,3c,,|c,171, w,la,,3c1,...,3c,)
T P(x,,c)P(l21,...,l2,,1,x1,...,x,,1|x,,c)P(x,+1,...,x,,|c,la1,...,b,,1,x1,...,x,)

P(la,|l21,...,la,,1,x,c):

 

(A1)

Assume no inbreeding and random mating so that all founder haplo—
types are independent. Therefore, la, is independent with h1,___,la,v_1.
Also assume that given a person u”s haplotypes la“, the person”s
affection status x“ is independent with any other persons” haplotypes
such as la, (Laird and Lange, 2011). Then the second term of the
numerator in Eq. (A1) can be written as

P(h17---7hi—17x17---7xi—1lhi7xivc)

: 13(1717 ---7hi—1lhiixi7C)P(x17 ---7xi—1lh17 ---7/7i—17/7i7xi7C) (A2)
: P0717---7hi—1lxi7C)P(x17---7xi—1l]717Hwhi—laxiac)

= P(/01.---Jai_1.x1.....xi_1lxi.c)
Given (A1) and (A2):

P(hi7xi7C)P(xi+17 “wxnlcvhlv “whivxlv mixi)

 

P 10‘ la  10'- :
( [I 17 7 I lixic) P(xi7C)P(xi+17wanlcahlv-“vhi—hxlvmaxi)

(A3)

Equation (A3) is Eq. (2) in the manuscript.

Guillaume,F. and Rougemont,]. (2006) Nemo: an evolutionary and
population genetics programming framework. Bioinformatics, 22,
2556—2557.

Laird,N.M. and Lange,C. (2011) The Fundamentals of Modern Statistical
Genetics. New York: Springer.

Lambert,B.W. et al. (2008) ForSim: a tool for exploring the genetic
architecture of complex traits with controlled truth. Bioinformatics, 24,
1821—1822.

Lemire,M. (2006) SUP: an extension to SLINK to allow a larger number of
marker loci to be simulated in pedigrees conditional on trait values. BMC
Genet., 7, 40.

Li,B. et al. (2012) SimRare: a program to generate and analyze sequence-based
data for association studies of quantitative and qualitative traits.
Bioinformatics, 28, 2703—2704.

Ott,]. (1989) Computer-simulation methods in human linkage analysis. P706.
Natl. Acad. Sci. USA, 86, 4175—4178.

Peng,B. and Amos,C.I. (2008) Forward-time simulations of non-random
mating populations using simuPOP. Bioinformatics, 24, 1408—1409.

Peng,B. et al. (2013) Genetic Simulation Resources: a website for the
registration and discovery of genetic data simulators. Bioinformatics, 29,
1101—1102.

Schaffner,S.F. et al. (2005) Calibrating a coalescent simulation of human
genome sequence variation. Genome Res., 15, 1576—1583.

Sobel,E. and Lange,K. (1996) Descent graphs in pedigree analysis: applica-
tions to haplotyping, location scores, and marker-sharing statistics. Am. ].
Hum. Genet., 58, 1323—1337.

Su,Z. et al. (2011) HAPGEN2: simulation of multiple disease SNPs.
Bioinformatics, 27, 2304—2305.

Thompson,E.A. (2005 ) MCMC in the analysis of genetic data on pedigrees.
Singapore: World Scientiﬁc Co Pte Ltd.

Wijsman,E.M. (2012) The role of large pedigrees in an era of high-throughput
sequencing. Hum. Genet., 131,1555—1563.

A2. For simulating haplotypes in non—founders

Prhf.hm.....h,-.x.c>

p(/a,(hf.lam.....hz—17X7C) :prhf lam  lax—1 X C)

 

iPrhmm.....Ia;.c>P(xlhf.Iam.....Ia,.c> (A4)
Zpalfvhmv ---7hf—17hkvxvc)
1291’

where ‘P is a set of all possible haplotype pairs of a
child whose parental haplotypes are the same as la,”s parental
haplotypes.

For the ﬁrst part of the numerator in Eq. (A4), conditional
on individual /”s parental haplotypes (i.e. lap and laq),
individual i”s haplotypes are independent from other members”
haplotypes. Because (lain/04) Ehf, the part of equation can be
written as

Prhmm. ....Ia,-.c> : Prams/am. ....Ia,--1.c>P<hf.Iam. ....Ia,-_1.c>
: P(hllh[77hqvc)P(hfvhmv ---7h/—17C)
(A5)

For the second part of the numerator in Eq. (A4):

P(x)hf,lam, ...,la,-.c)
I P(x1lhf7]7n17 ---7]7/'7C)P(x2lhf7hm7 ---7/9;7x170)---
P(lehf7]7n17Mala/7x17---7xj—17C)P(xi+17---xnlhf7]7m7---7]7j7x17---7xjvc)

(A6)

Again using the assumption that given a person u”s haplotypes la“,
the person”s affection status x“ is independent with any other

ﬁJO'SWIImOIPJOJXO'SOplZIIJJOJLIIOIQ/[idnq

562

P.—J. Yao and R.—H. Chung

 

persons” haplotypes such as la, (Laird and Lange, 2011), each term in
Eq. (A6) except the last term can be written as

P(x,~(hf,bm, ...,lJ,-,x1, ...,x,-,1,c)

i
HP(x,(/a,,c)
_ P(x1,...,xj(l)1,...,laj,c)P(lJ1,...,le,c) _ r:l

 

_ _ = p .19.
P061,...,xj,1)]’11,...,]’Jj,C)P(/’Jl,...,]’Jj,C) 7‘71 (xll WC)
HP(x,(lJ,,c)
r:l
Then Eq. (A6) can be written as
P(x(hf,lam, ...,la,~.c)
(A7)

P(xrl/ar.c)P(x,-+1. ---anhf.hm. nah/.961. ---.x;.c)

‘
(l \.
H:

Based on Eqs. (A5) and (A7), Eq. (A4) can be written as

P(hilhf7hrm "vb/717157 C)

l
P(hiIh/J7hq7C)P(xi+lv ~~~xnlhfvhm7~~~7hivxlvuvxivC)HP(erhnc)

_ 7:1

12
Z(Pokinnhaonxia.was»)...Mn-..n.x1.....x,.c>HP(x.rh..c>)

ke‘l’ 7:1

which is Eq. (4) in the manuscript. The probabilities
P(xj+17---xn)hf.lam,....la;.x1.....x;.c)can be efficiently calculated in
the same manner as the calculation in Eq. (3).

/310'S[BHm0FpJOJXO"SOIJBIIIJOJIIIOIqﬂZdnq

