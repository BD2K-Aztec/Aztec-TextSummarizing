Bioinformatics, 32112), 2016, 1891—1894

doi: 10.1093/bioinformatics/btw030

Advance Access Publication Date: 1 February 2016
Applications Note

 

Gene expression

GiANT: gene set uncertainty in
enrichment analysis

Florian SchmidI, Matthias Schmidz, Christoph Miisseﬂ, J. Eric Strang1,
Christian Buske3, Lars Bullinger4, Johann M. KrausVr and
Hans A. KestlerI"r"°°"r

1Institute of Medical Systems Biology, Ulm University, Ulm 89069, Germany, 2Institut fiir Medizinische Biometrie,
Informatik und Epidemiologie, Universita't Bonn, Bonn 53127, Germany, 3Institute of Experimental Cancer Research,
4Department of Internal Medicine Ill, Ulm University, Ulm 89069, Germany and 5Leibniz Institute on Ageing — Fritz
Lipmann Institute and FSU Jena, Jena 07745, Germany

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Last Authors.
Associate Editor: Jonathan Wren

Received on 14 August 2015; revised on 28 December 2015; accepted on 12 January 2016

Abstract

Summary: Over the past years growing knowledge about biological processes and pathways
revealed complex interaction networks involving many genes. In order to understand these net—
works, analysis of differential expression has continuously moved from single genes towards the
study of gene sets. Various approaches for the assessment of gene sets have been developed in
the context of gene set analysis (GSA). These approaches are bridging the gap between raw meas—
urements and semantically meaningful terms.

We present a novel approach for assessing uncertainty in the definition of gene sets. This is an
essential step when new gene sets are constructed from domain knowledge or given gene sets
are suspected to be affected by uncertainty. Quantification of uncertainty is implemented in the
R—package GiANT. We also included widely used GSA methods, embedded in a generic framework
that can readily be extended by custom methods. The package provides an easy to use front end
and allows for fast parallelization.

Availability and implementation: The package GiANT is available on CRAN.

Contacts: hans.kestler@leibniz—fli.de or hans.kestler@uni—ulm.de

 

 

1 Introduction

Differential expression analysis investigates the association of meas-
urements of single genes to a predefined phenotype (e.g. tumour ver-
sus inflammation). Frequently yielding thousands of differentially
expressed genes, such analyses are often hard to interpret in a biolo-
gical context (Zeeberg et (11., 2003). Gene set analyses aim at assign-
ing a meaning to differentially expressed genes by comparing them
to sets of genes whose relevance in processes or pathways is known.
Such gene sets can be derived, e.g. from Gene Ontology (Gene
Ontology Consortium, 2000), KEGG (Kanehisa and Goto, 2000),
AgeFactDb (Huhne et (11., 2014), Reactome (Joshi—Tope et (11.,

2005), WikiPathways (Pico et (11., 2008) or other collections of gene
sets (Glez—Peﬁa et (11., 2009; Huang et (11., 2007; Subramanian et (11.,
2005). Albeit frequently used, gene set analysis suffers from pitfalls
concerning the significance assessment (Goeman and Buhlmann,
2007; Maciejewski, 2013). Also the large variety of methods makes
the choice of which analysis to use often difficult. Beside that, issues
arise from the crafting of the gene sets. For example, rapidly chang-
ing knowledge may not only affect the members of sets, but also the
mapping of probe sets to gene identifiers (Bleazard et (11., 2015;
Retraction for Dixson et (11., 2014; Sedeﬁo—Cortés and Pavlidis,
2014) and the validity of included genes under a certain condition

(63 The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1891

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Strimmer (2009)

 

 

95°/o—quanti|e
50°/o—quanti|e
5°/o—quanti|e
t0.95

t*

Fig. l

Ackermann and

/3.IO'S[BIImOfp.IOJXO'SOIJELUJOJIITthﬂZduq

GiANT

1893

 

Expression levels of Rb pathway genes

 

 

I pssjogi sore
pssjogem
pssjoeissri

pssjoﬁrme
pssjoﬁrmz
pssjojsziers
DEM-442m

DEstzTi

DEstiTi

 

DENjGZTBt

DENjBlTZ

 

Fig.2. Heatmap ofthe 123 genes associated to the Rb pathway. Hierarchical clustering of samples (complete linkage) in the feature subspace ofthe Rb pathway
coincides with the known classes DEN and P53 (lower and upper labeling). Expression values have been mean centred and scaled within each gene

calculations, which allows for the analysis of gene set collections,
benchmark studies or approaches that combine the results of several
gene set analyses (Varemo et al., 2013). Furthermore, the package
also ensures that parallelized random number generation has no ef-
fect on outcome (L’Ecuyer et al., 2002).

2.2 Application
\We demonstrate the handling of the GiANT package using a dataset
of six p53-deficient liver tumor samples and seven samples of DEN-
induced liver tumors in mice. The dataset includes 30 278 genes and
no missing values. Following Katz et a]. (2012) we extracted the
gene expression values and performed a preprocessing of the dataset
using the standard workflow. For normalization, baseline and per-
centile (75”0) shifts were performed after logz transformation. Katz
et a]. (2012) showed a significant enrichment of a hand-crafted Rb
pathway gene set in this dataset. The set consists of 123 Lip-stream
genes, interaction partners and downstream targets related to the Rb
pathway. All genes were collected from literature using the PubMed
database. Expression levels of the Rb pathway genes in the data are
illustrated in Figure 2. In the following we evaluate the uncertainty
in the definition of this hand-crafted Rb pathway gene set. As a test
statistic the average absolute (Spearman) correlation to the class
label of all genes in the set is calculated. Statistical significance is of
the gene set is based on a computer intensive resampling test:
evaluateGeneSetUncertainty(

dat : dataset$data ,

labs : dataset$labs ,

geneSet : erathway,

analysis :gsaTools .averageCorrelation () ,

method: “spearman” ,

numSamplesUncertainty : l O O O ,

numSamples : 10 O O ,

k:seq(0.0l,O.99, by:0.0l))

A detailed step by step example is give in the vignette of the
GiANT package. Figure 1 visualizes the distributions with different
degrees of uncertainty: For each value of k the quantiles of the re-
sulting distribution are given. k :0 gives the null distribution with
the lower horizontal (green) line showing the corresponding 95"“-
quantile. The upper horizontal (red) line gives the value of the test
statistic for the Rb pathway t". The black vertical line indicates the
degree of uncertainty where the two distributions (null distribution
and distribution with a fixed degree of uncertainty) do not overlap.
As we can see, even for 15% of random genes, the perturbed gene
sets achieve higher scores than the 95 "u quantile of the null distribu-
tion and are thus statistically significant with respect to the null

distribution. This indicates that the Rb pathway gene set is robustly
enriched (k : 0.85) in the dataset.

3 Conclusion

Sets are the core of gene set enrichment analyses. Every analysis is
based on their correct definition. Motivated by critical articles like
Sedeﬁo-Cortés and Pavlidis (2014), Retraction for Dixson et al.
(2014) and Bleazard et a]. (2015), we developed a new robustness
analysis that assesses and quantifies the performed enrichment ana-
lyses using a partial resampling approach. These anylses are espe-
cially important for newly found pathways, but also well established
and curated databases suffer from errors and uncertainty in their
gene set definitions. Our method allows now a quantification of the
gene set uncertainty and therefore an assessment of the validity of
the enrichment analyses. The approach is implemented in the R
package GiANT, which also provides a comprehensive toolkit for
generic gene set analysis. Apart from standard methods like GSEA,
user-defined workflows can be constructed readily within the flex-
ible pipeline mechanism. This allows the user to build new high-level
analyses, adapted to the specific context of use.

Funding

The research leading to these results received funding from the European
Community’s Seventh Framework Programme (Fl’7/2007—2013) under grant
agreement no. 602783, the DFG (SFB 1074 project Z1), and the German
Federal iVlinistry of Education and Research (BRIEF, Gerontosys ll,
Forschungskern SyStaR, project 11) 0315894A) all to H.A.K.

Conflict oflm‘eresz‘: none declared.

References

Ackermann,i\1. and Strimmer,l(. (2009) A general modular framework for
gene set enrichment analysis BMC Bioinﬁ, 10, 47.

Bleazard,T. ez‘ al. (2015) Bias in microRNA functional enrichment analysis
Bioinformaz‘ics, 31, 1592—1598.

Glez-Peﬁa,D. ez‘ al. (2009) WhichGenes: a web-based tool for gathering, build-
ing, storing and exporting gene sets with application in gene set enrichment
analysis Nucleic Acids Res, 37, W329—W334.

GoemanJJ. and B'Lihlmann,l’. (2007) Analyzing gene expression data in terms
of gene sets: methodological issues Bioinforlmzz‘ics, 23, 980—987.

Huang,D.W. ez‘ al. (2007) DAVID bioinformatics resources: expanded annota-
tion database and novel algorithms to better extract biology from large gene
lists Nucleic Acids Res, 35, W169—W175.

H'Lihne,R. ez‘ all. (2014) AgeFactDB — the jenAge Ageing Factor Database — to-

wards data integration in ageing research. Nucleic Acids Res, 42, D892—D896.

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

1894

F.Schmid et al.

 

Joshi-Tope,G. et al. (2005) Reactome: a knowledgebase of biological path—
ways. Nucleic Acids Res, 33, D428—D432.

Kanehisa,M. and Goto,S. (2000) KEGG: Kyoto Encyclopedia of Genes and
Genomes. Nucleic Acids Res, 28, 27—30.

Katz,S. et al. (2012) Disruption of trp53 in livers of mice induces formation
of carcinomas with bilineal differentiation. Gastroenterology, 142,
1229—1239.e3.

L’Ecuyer,P. et al. (2002) An object—oriented random-number package With
many long streams and substreams. Open Res, 50, 1073—1075.

Maciejewski,H. (2013) Gene set analysis methods: statistical models and
methodological differences. Brieﬁngs Bioinﬁ, 15, 504—518.

Pico,A.R. et al. (2008) WikiPathways: pathway editing for the people. PLOS
Biol., 6, e184.

Retraction for Dixson et al. (2014) Identiﬁcation of gene ontologies linked to
prefrontalhippocampal functional coupling in the human brain. Proc. Natl.
Acad. Sci., 111,13582.

Sedeﬁo—Cortés,A.E. and Pavlidis,P. (2014) Pitfalls in the application of gene—
set analysis to genetics studies. Trends Genet., 30, 513—514.

Subramanian,A. et al. (2005) Gene set enrichment analysis: A knowledge-
based approach for interpreting genome-wide expression proﬁles. PNAS,
102,15545—15550.

The Gene Ontology Consortium (2000) Gene ontology: tool for the uniﬁca—
tion of biology. Nat. Genet., 25, 25—29.

Varemo,L. et al. (2013) Enriching the gene set analysis of genome-Wide data
by incorporating directionality of gene expression and combining statistical
hypotheses and methods. Nucleic Acids Res, 41, 4378—4391.

Zeeberg,B. et al. (2003) GoMiner: a resource for biological interpretation of
genomic and proteomic data. Genome Biol., 4, R28.

/810'sreumofp103xo'sopeuuoyltotq”:duq

