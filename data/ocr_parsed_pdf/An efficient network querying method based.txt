ORIGINAL PAPER

Vol. 27 no. 22 2011, pages 3173-3178
doi:10. 1 093/bioinformatics/btr524

 

Systems biology

Advance Access publication September 16, 2011

An efficient network querying method based on conditional

random fields

Qiang Huang, Ling-Yun Wu* and Xiang—Sun Zhang

National Center for Mathematics and Interdisciplinary Sciences, Academy of Mathematics and Systems Science,

Chinese Academy of Sciences, Beijing 100190, China
Associate Editor: Trey Ideker

 

ABSTRACT

Motivation: A large amount of biomolecular network data for
multiple species have been generated by high-throughput experi-
mental techniques, including undirected and directed networks such
as protein—protein interaction networks, gene regulatory networks
and metabolic networks. There are many conserved functionally
similar modules and pathways among multiple biomolecular
networks in different species; therefore, it is important to analyze
the similarity between the biomolecular networks. Network querying
approaches aim at efficiently discovering the similar subnetworks
among different species. However, many existing methods only
partially solve this problem.

Results: In this article, a novel approach for network querying
problem based on conditional random fields (CRFs) model is
presented, which can handle both undirected and directed networks,
acyclic and cyclic networks and any number of insertions/deletions.
The CRF method is fast and can query pathways in a large network
in seconds using a PC. To evaluate the CRF method, extensive
computational experiments are conducted on the simulated and
real data, and the results are compared with the existing network
querying methods. All results show that the CRF method is very
useful and efficient to find the conserved functionally similar modules
and pathways in multiple biomolecular networks.

Availability: Code and data are available at http://doc.aporc.org/
wiki/CNetQ

Contact: lywu@amt.ac.cn

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on June 14, 2011; revised on August 27, 2011; accepted
on September 12, 2011

1 INTRODUCTION

The high-throughput experimental techniques have been dramati-
cally improved in past decades and a large amount of biomolecular
network data have been produced. For example, protein—protein
interaction (PPI) networks are available in many databases such
as DIP (Xenarios et (11., 2000), which catalogs experimentally
determined protein interactions for many species including
Saccharomyces cerevisiae, Drosophila melanogaster: Escherichia
coli and Caenorhabditis elegans. Since the biomolecular networks
contain many conserved functionally similar modules and pathways,

 

*To whom correspondence should be addressed.

it is important to analyze the similarity among multiple biomolecular
networks to discover signaling pathways, ﬁnd conserved modules
and reveal new biological function subnetworks. Network querying
approaches attempt to address this problem via optimally mapping
the queried network into a subnetwork of the given biomolecular
network.

There already exist many methods for network querying in
literature. PathBLAST (Kelley et (11., 2004) is a network alignment
and search tool for comparing PPI networks, but it only could be
used to query a short protein path. Pinter et (11. (2005) devised
an algorithm called MetaPathwayHunter for querying metabolic
networks. MetaPathwayHunter could ﬁnd queries for more general
pathways, but it only could be applied to small networks without
cycles. QPath (Shlomi et (11., 2006) is a comprehensive framework
for querying a linear pathway in a network of interest, while QNet
(Dost et (11., 2008) extends the type of queried network from the
linear pathways to trees and networks of bounded tree width. Qian
et (11. (2009) proposed an efﬁcient framework for ﬁnding pathways
based on Hidden Markov Models (HMMs) and it only could deal
with the simple path.

The efﬁciency, accuracy and capability to handle general network
structures are three major criteria for devising network querying
approaches. Many previous methods are either limited by the size
of networks, the types of networks or the maximum allowable
number of insertions/deletions. For example, PathBLAST, QPath
and HMM method only consider the simple path (i.e. linear Chain),
while MetaPathwayHunter and QNet cannot query the network with
cycles.

Some recent approaches advanced the step to the network
querying problem with general network structure. SAGA (Tian et (11.,
2007) is an approximate graph matching technique that minimizes
a subgraph distance ﬁinction with a parameter A over all possible
matchings to get the similar subgraph. PathMatCh/GraphMatCh
(Yang and Sze, 2007) formally deﬁne the path matching and
graph matching problems and give algorithms for these problems,
respectively. They reduced the path matching problem to ﬁnd a
longest weighted path in a directed acyclic graph, and the graph
matching problem to ﬁnd the highest scoring subgraphs in a large
graph. MNAligner (Li et (11., 2007) is a network alignment method
based on the integer quadratic programming. It only works well
for the small network alignment problem since solving the large-
scale integer quadratic programming is time consuming. TORQUE
(Bruckner et (11., 2009) is a topology-free querying algorithm.
Given a query, TORQUE ﬁnds a matching set of proteins that
are sequence similar to the query and then span a connected

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 3173

112 ﬁlo's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq uteri papBOIII/lAOG

91oz ‘Og anﬁnv uo ::

Q.Huang et al.

 

region of the network to ﬁnd the matching subnetwork. PADAl
(Blin et (11., 2010) is an exact algorithm for querying networks
based on dynamic programming and color-coding technique, which
transforms a network with cycles to a tree by using a brute-force
method. However, due to the intrinsic contradiction between the
computational complexity and the capability of handling general
networks, developing an efﬁcient general network querying method
for analyzing large-scale biomolecular networks is still a Challenge.
In this article, we will present a conditional random ﬁeld (CRF)
model for the network querying problem by utilizing the similarity of
molecular nodes and the interaction topology. CRF is a probabilistic
framework which is ﬁrst used for labeling and segmenting sequential
data (Lafferty et (11., 2001). As an extension and generalization
of HMM and maximum entropy Markov models, CRF has many
advantages. It allows the strong independence assumptions of
HMM to be relaxed, as well as overcomes the label-bias problem
exhibited by maximum entropy Markov models. CRF has been
successﬁilly applied to labeling problem in many ﬁelds including
natural language processing (Lafferty et (11., 2001; Sha and Pereira,
2003) and bioinformatics (DeCaprio et (11., 2007; Wu et (11., 2009).
The rest of this article is organized as follows. In Section 2, we
will describe the network querying problem formally and introduce
a novel CRF model for network querying problem. To evaluate the
proposed method, we conduct computational experiments on several
simulated and real data including undirected and directed networks.
Compared with some popular network querying methods such as
PathMatCh/GraphMatCh (Yang and Sze, 2007), QNet (Dost et (11.,
2008), HMM (Qian et (11., 2009) and MNAligner (Li et (11., 2007),
the results show that the new method is accurate and efﬁcient. The
results of computational experiments will be reported in Section 3.
Finally, conclusion and discussion will be given in Section 4.

2 METHODS

Let G: (VG,EG) be a biomolecular network (e.g. PPIs networks, gene
regulatory networks), where each node v e VG denotes a protein/gene, and
each edge e = (v, , vi) 6 EG represents the interaction between nodes vi and v]:
Given a target network G and a query networkX, the task of network querying
is to ﬁnd the best matching subnetwork Y for X from the target network G.

2.1 Conditional random ﬁelds model

If we consider G as a label set, that is, each node v e VG as a label and each
edge e=(vi,v]-)EEG as the relation between labels vi and vi, the network
querying problem can be treated as a network labeling problem: given a label
set G and a query network X , ﬁnd the best matching labels Y for X from
the label set G. Therefore, in the rest of this article, the word ‘label’ denotes
the node in the target network G. Figure 1a illustrates the general process
of network querying and Figure 1b shows an example of transforming the
network querying problem into labeling problem.

In the CRF model for network querying problem, the conditional
probability of a set of labels Y=(Vy,Ey)§ G for a given query network
X=(VX,EX) is deﬁned as:
Pr(Y|X): L 1‘1 maxi) 1‘1 fE(yi.y,-.X.i.j>.

xieVX (11,1f)eEx

where Z(X)= ZY WN01,X, i)]_[fE(yi,yJ-,X, i,j) is the normalization factor,
yieVy is the corresponding label for the node xie VX, and two feature
functions ﬁx; and f5 are used to model the matching of nodes and edges,
respectively. The ﬁrst product is over all the nodes x, e VX, and the second
product is over all the edges (xi,xj) 6 Ex. The underlying assumption is that

    
 

lea lures  I
\

 

 

Query X Network G, Labels Y

Fig. 1. (a) An illustration of network querying process. Given the query
network (left) and target network (middle), the feature functions are
constructed based on the node similarity and the topology similarity between
two networks. Then the CRF model is applied to ﬁnd the best matching
subnetwork (right) in the target network. (b) An example of transforming
the network querying problem to labeling problem. The left is the query
network X (nodes ABCDEF), and the right is the target network G. The
matching result Y (nodes A’ B’ C’ D’ F ’ ) with an insertion and a deletion is
shown. The correspondences between the nodes of X and Y are shown by
dashed lines.

the probability of the labels only depends on the similarity of nodes as well
as edges.

Based on the above CRF model, the network querying problem is
solved by ﬁnding the optimal labels Y E G that maximizes the conditional
probability Pr(Y|X) for given query network X. The task to ﬁnd optimal
labels in CRF model is called decoding. There are already many decoding
algorithms in literature (Wainwright and J ordan, 2008). When the network X
is a tree (or forest), the decoding problem can be solved exactly by tree belief
propagation algorithm. If X is a chain, the simplest case, Viterbi algorithm
(Viterbi, 1967) is a faster exact algorithm. For the general networks, there
exist many approximate algorithms, in which we choose loopy belief
propagation algorithm in this study.

The proposed CRF model is a very general framework which is ﬂexible
to incorporate various information. In this article, the node feature function
is deﬁned directly by the similarity between the corresponding nodes of X
and Y as follows:

fNUivai)=S(xiv)/i)v

where S(x,»,y,») is the non-negative similarity score between nodes x, and yi.
The edge feature function is a little more complicated. One edge in X is
considered to be matched well only if its two end nodes are matched well by
two closely connected labels in G. Therefore, the following feature function
is used:

fEUi’yj’X’ id.) = $00 th):S(X] J71) WOW”),
where W(yi,yj) is the non-negative connectivity score between nodes
y, and yj. In the next section, we will discuss how to accommodate the
gaps in the CRF model by properly deﬁning the similarity score and the
connectivity score.

2.2 Modeling gaps

In the network querying problem, there are two kinds of gaps need to handle:
insertion and deletion. Insertion is the case that two neighboring nodes in
X are labeled by two non-neighboring nodes in G, that is, some additional
nodes are needed so that the matching subnetwork Y can have similar network
structure as the query X. Conversely, deletion is that some nodes in the query

 

3174

112 ﬁlo's[BumoIpJOJXO'sorwuiJOJurorq”:duq mot} papBOIII/lAOG

91oz ‘Og anﬁnv uo ::

An efficient network querying method

 

X do not have corresponding counterparts in the matching subnetwork Y. In
other words, the counterparts of these nodes are deleted in the network G.
Figure 1b shows an example of insertion and deletion.

The insertions are penalized by the length of the shortest path between
two non-neighboring nodes y, and yj. To model deletions, a dummy node vd
is added to the network G as the label for deletions.

Formally, the similarity score is deﬁned as follows:

Ad if y = vd,
SUN): 0 ifR(X~y)SAd,
R(x, y) otherwise.

where Ad (Ad > 0) is a penalty parameter for deletions. The smaller Ad is,
the heavier penalty for deletions. R(x, y) is the raw similarity score of nodes
x and y. For protein or gene networks, we set R(x,y)= 1 —E,,y, where E”.
is the BLAST E-Value of two proteins or genes x and y.

The connectivity score is deﬁned as follows:

Ac iin=Yj=vm
W013”): As lfyizvd erjzvd’
W otherwise.
.1, -

where A, (0< Ac: 1) is a penalty parameter for consecutive deletions,
Ag (0 < A, 5 1) is a penalty parameter for initial deletions, A, (A, 30) is a
penalty parameter for insertions. Smaller Ag and A, mean heavier penalty
for initial and consecutive deletions, respectively, while larger A, indicates
heavier penalty for insertions. L(yi,yj) is the length of the shortest path
between nodes y, and yj in the network G. If node yj is not reachable from
node yi, L(yi,yj) is set to inﬁnity.

2.3 Network simpliﬁcation

For large networks, the computation of CRF model can be greatly reduced
by simplifying the network as follows. Given a query network X and a
target network G. First, the similarity scores S(x, y) are calculated for all
pairs of nodes x in X and y in G, and the connectivity scores W(yi,yj) are
calculated for all pairs of nodes yi, yj in G. A node y in G is called redundant if
S (x, y) 5 Ad for all nodes x in X. All redundant nodes can be safely removed
from G since they will never appear in the optimal solutions of CRF model.

3 RESULTS

The proposed CRF method is implemented by using Matlab. The
Matlab toolbox UGM developed by Mark Schmidt (http://www.di.
ens.fr/~mschmidt/Software/UGM.html) is used to solve the CRF
model, and the lengths of shortest paths for all pairs of nodes in the
network G are calculated by the Matlab toolbox MatlabBGL (http://
www. stanford .edu/ ~d gl ei ch/ pro grams/ matlab_b gl/) .

Several simulated and real data are used to evaluate the CRF
method on both undirected and directed network querying problems.
In this study, we set Ad =10_10, AC=0.5, Ae=1 and A, = 1.

3.1 Querying undirected networks

First, the CRF method is applied to query known pathways in
PPI networks. Pathways and PPI networks are both undirected.
For the sake of comparison, the PPI networks data of S.cerevisiae
and D.me1an0gaster are obtained from Dost et a1. (2008). The
S. cerevisiae PPI network contains 15 147 interactions among 4738
proteins, while the D.me1an0gaster PPI network contains 26201
interactions among 7481 proteins.

3.1.1 Simulated data We randomly generate three types of query
networks: simple paths, trees and loopy subnetworks. For each type

of query networks, we extract 30 instances, with sizes ranging from 7
to 12, from the S. cerevisiae PPI network. Each extracted subnetwork
is perturbed with two node insertions and deletions. Meanwhile, we
simulate three levels of mutations to every protein sequence, that
is, randomly changing 50, 60 and 70% residues, respectively. More
detail of the simulation is provided in Supplementary Materials.

The simulated subnetworks are queried in the S.cerevisiae PPI
network. To evaluate the querying methods, we compute the
accuracy of nodes by comparing the querying results with the
original extracted subnetworks except the insertion and deletion
nodes. The results of CRF method are compared with HMM (Qian
et a1., 2009), QNet (Dost et a1., 2008), PathMatch/GraphMatch
(Yang and Sze, 2007), as shown in Figure 2. In these methods,
HMM and PathMatch only can query the simple path, while QNet
is designed for tree querying. As the extension of PathMatch,
GraphMatch can query the general subnetworks, but needs longer
computation time than CRF method. Specially, CRF method can
ﬁnd the exact solution for all instances with mutation level 360%
in seconds. The comparison of running time on the simulated paths
are shown in Supplementary Materials. In a word, CRF method
outperforms all other methods in terms of both the accuracy and the
applicable query network types.

In order to evaluate the inﬂuence of node similarity to the results,
we conduct additional experiments on the simulated data (The
procedure and results are provided in Supplementary Materials). The
results show that the CRF method well balances the node similarity
information and the topological information, compared with the
existing methods. The effects of parameters are also analyzed in
Supplementary Materials.

3.1.2 Real data Three real pathways of different types are
selected from KEGG database (Kanehisa and Goto, 2000) to
evaluate the CRF method: simple path, tree and loopy subnetwork.

The simple path instance is querying the human hedgehog
signaling pathway (KEGGzhsa04340) in the D.me1an0gaster PPI
network. The best matching result is shown in Figure 3b.
Compared with the D.me1an0gaster hedgehog signaling pathway
(KEGszme04340), the human Fu is mismatched with PKA
instead of Fu in D.me1an0gaster, although PKA is also in
the D.me1an0gaster hedgehog signaling pathway. We found the
reason is that the edge between Smo and Fu, which exists in
the D.me1an0gaster hedgehog signaling pathway in the KEGG
database, does not exist in the D.me1an0gaster PPI network used
in this study. If we add the edge between Smo and Fu, the best
matching result becomes the same as the D.me1an0gaster hedgehog
signaling pathway as shown in Figure 3c. The results of HMM (Qian
et a1., 2009) and QPath (Shlomi et a1., 2006) are extracted from
their papers, respectively, and shown in Supplementary Materials
for comparison.

The tree instance is shown in Figure 4. The query is a
Classical human MAPK pathway involved in cell proliferation
and differentiation (KEGGzhsa04010). In the best matching result
found in the D.me1an0gaster PPI network, the proteins EGFR,
Sev, Ras85D, Phl, Dsorl, Rolled are the members of the known
D.me1an0gaster MAPK pathway (KEGszme04013). The results of
HMM (Qian et a1., 2009) and QNet (Dost et a1., 2008) are extracted
from their papers, respectively, and shown in Supplementary
Materials for comparison.

 

3175

112 ﬁlo's[BumoipJOJXO'sorwuiJOJurorq”:duq mot} papBOIII/lAOG

91oz ‘Og anﬁnv uo ::

Q.Huang et al.

 

 

 

 

 

 

 

 

 

 

 

Query paths Query trees Query loopy subnetworks
(a) 1 /  1 (C) 1 .\
0.99 :  S e 0.93 \ 0.99
0.95 0.96 0.98
0 97 0.94 0.97
> 0.96 0.92 5‘ 0.96
E n 95 E 0 9 E o 95
= . = =
8 8 8
< < <
0.94 0.88 0.94
0.93 0.86 0.93
0.92 + CRF 0.84 0.92
—e— PathMatch —*— CRF
0.91 —I— QNe1 0.82 _9_ Emma”, 0.91 + cm:
0 —$— HMM 0 a —4— QNet o g —6— GraphMatch
I 0% 50% 60% 70% I 0% 50% 60% 70% I 0% 50% 60% 70%

 

 

 

 

Mutation rate

Mutation rate Mutation rate

Fig. 2. Comparison of the querying results on simulated data. The y-axis is the accuracy, i.e. the percentage of correctly matched nodes, and the x-axis is the

mutation level. (a) Paths; (b) trees; (c) loopy subnetworks.

 

 

 

 

 

 

 

 

 

 

 

(a)| Hh | (MI Hh | (on H“ l
IPItcl IPltcl IPltcl
ISrInol ISrlnol 131ml
I Flu I IPILAI I in I
| Slu | | Slu | | 3|“ I
1 cl: | I (In | | <|>i |

 

Fig. 3. (a) The human hedgehog signaling pathway and its best match in
D.melan0gaster; (b) without and (c) with artiﬁcial edge between Smo and Fu.

The loopy subnetwork instance is querying a part of the
D.me1an0gaster MAPK signaling pathway (KEGszme04013)
in the S.cerevisiae PPI network, as shown in Figure 5. The
proteins in the best matching result, SLT2, FUS3, STE11, STE7,
HOGl, KSSl are all in the S.cerevisiae MAPK signaling pathway
(KEGstce04011). The ABPl is an actin-binding protein and
associated with the cortical cytoskeleton of S.cerevisiae. Its SH3
region indicates that it might serve to bring together signal
transduction proteins and their targets or regulators, or both,
in the membrane cytoskeleton (Drubin et a1., 1990). Cdc25 is
a membrane-bound guanine nucleotide exchange factor. PTP3
is phosphotyrosine-speciﬁc protein phosphatase involved in the
inactivation of MAPK during osmolarity sensing. RAS1 is GTPase
involved in G-protein signaling in the adenylate cyclase activating
pathway and has similar ﬁinction with Ras85D and Ras.

Several additional experimental results on loopy subnetworks
are provided in Supplementary Materials. All these results show
that CRF method is very efﬁcient to ﬁnd the functionally similar
pathways of different structures in real PPI networks.

3.2 Querying directed networks

In the real world, there are many directed biomolecular networks
in which the interactions between biomolecules are directional,
for example, gene regulatory networks and metabolic networks.
However, only a few of existing network querying methods can
successﬁilly handle the directed networks. The proposed CRF
method can deal with the directed network querying problem without
modiﬁcation. In this section, several simulated and real instances

 

PDGFR (b1EGFR/Se EGFR/Sev EGFR/Se

 
 
    

 

Fig. 4. (a) Human MAPK signaling pathway and (b) its best match in
D.melan0gaster. Solid lines indicate there is no insertion/deletion between
the nodes, and dashed lines on the contrary. All gap nodes are omitted.

 

 

 

Fig. 5. (a) D.melan0gaster MAPK pathway and (b) its best match in
S.cerevisiae. Solid lines indicate there is no insertion and deletion between
the nodes while dashed lines on the contrary. All gap nodes are omitted.

are shown to evaluate the capability of CRF method for directed
networks.

3.2.1 Regulator—regulator interaction networks Figure 6 shows
a simulated querying example of directed networks. The query
is extracted from a regulator—regulator interaction network, which
contains 106 regulators (Lee et a1., 2002). For each node in the query,
ﬁve nodes are randomly selected as fake sources. The similarity
scores between the query node and its truth source as well as
ﬁve fake sources are set as l. The remaining similarity scores are

 

3176

112 /3.10's[BumoipJOJXO'sorwuiJOJurorq”:duq uteri pQPBOIIIAAOG

91oz ‘Og isnﬁnv uo ::

An efficient network querying method

 

 

Fig. 6. A directed subnetwork query in the regulatoriregulator interaction
network. The best matching result is the same as query.

random numbers in [0 1]. The best matching result of CRF method
is identical with the query network.

3.2.2 Metabolic networks Figure 7 shows an instance that a
tree-like network containing part of the ot-aminoadipic pathway in
Tthermophilus (Kobashi et a1., 1999) is queried in a combined E. coli
metabolic network of glycolysis, gluconeogenesis, the Citrate cycle
and the glyoxylate metabolism. The raw similarity scores are deﬁned
following Yang and Sze (2007) but with simple normalization to the
interval [0 1]. In detail, the raw similarity scores of enzymes are
provided by the information content values based on the proximity
of EC numbers, while the raw similarity scores of compounds are
calculated by using SIMCOMP package from Hattori et a1. (2003).
The best matching result of CRF method is the same as the top result
found by GraphMatch (Yang and Sze, 2007).

Another test of metabolic networks is following Pinter et a1.
(2005) and Li et a1. (2007). The data of 113 E.coli pathways
and 151 S.cerevisiae pathways are obtained from Pinter et a1.
(2005). In Pinter et a1. (2005) and Li et a1. (2007), they ran all-
against-all network alignments and gave the results through the
t-test and the statistical signiﬁcance P-value. We transform the
network alignment problem to the network querying problem as
follows. First, all the 151 S.cerevisiae pathways are combined
as a whole metabolic network in which the same enzymes in
different pathways are presented as different nodes, and the different
pathways are not connected. There are totally 862 nodes in the
constructed S. cerevisiae metabolic network. Second, each of the 113
E. coli pathways is queried in the constructed S. cerevisiae metabolic
network. The node similarity is computed following Pinter et a1.
(2005) and Li et a1. (2007). We ﬁlter the matching results which
contain at most one mismatch. There are 44 E.coli pathways with
at most one mismatch, in which 32 are completely matched. For
comparison, by using the same procedure, GraphMatch found 42
matching results with at most one mismatch, in which 25 are
completely matched and all included in the 32 completely matched
results of CRF method. All the matching results of two methods
can be found in Supplementary Materials. Figure 8 is an example
of matching the E.coli super pantothenate coenzymeA biosynthesis
pathway to S.cerevisiae pathway with a mismatch.

The running time of CRF method and GraphMatch on the
metabolic network data from Pinter et a1. (2005) are compared in
Figure 9. CRF method gets the matching results in <20s for all
instances, while GraphMatch does not ﬁnish within 1000 s for the
instances with query length >20. The variance of running time of
GraphMatch becomes very large when the size of network increases
since the computational complexity of GraphMatch depends on the
number of induced subgraphs. Additional comparison of the running
time are also provided in Supplementary Materials.

 

(a)|24‘ ! IAcetyI-CoAI (b)IOxaloac I IAcetyl-CoAI

 

 

 

| 2—0xoadipate | INADHI I2—Oxoglutaratel NADPH

 

Fig. 7. (a) A tree-like pathway containing part of the ot-aminoadipic pathway
in Tthermophilus and (b) its best match in Ecoli.

,

I
|2.1.2.11| |1.1.1 161/ | 6.3.2.1 | |2.7.1.33| | 6.3.2.5 | |4.1.1.36| | 2.7.7.3 | |2.7.1.24|
|2.1.2.11| |1.1.1.1sd | 6.3.2.1 | |2.7.1.33| | 6.3.2.5 | |4.1.1.36| | 2.7.7.3 | |2.7.1.24|

 

 

 

Fig. 8. A super pantothenate coenzymeA biosynthesis pathway in E.coli
and the best matching pantothenate coenzymeA biosynthesis pathway in
S.cerevisiae with one mismatch. The solid edges are the matching interactions
and the dashed edge is the mismatching edge.

The running time
60 . . i
—l— CRF -’

 

—9— CRF (without network simplification) .
50 ' > 'GraphMatch  -

 

 

Time (seconds)

 

 

 

 

1—5 6—10 11—15 16—20 >20
Length of query

Fig. 9. Comparison on the running time of CRF and GraphMatch on the
metabolic network data from Pinter et a1. (2005).

4 CONCLUSION AND DISCUSSION

This article presents a novel CRF method for network querying
problem. A number of simulated and real experiments show
that the CRF method is very efﬁcient and helpful to ﬁnd the
conserved functionally similar modules and pathways in both
undirected and directed biomolecular networks. Compared with
the existing network querying approaches, the CRF method has

 

3177

112 /3.10's[BumoipJOJXO'sorwuiJOJurorq”:duq uteri popeolumoq

91oz ‘Og isnﬁnv uo ::

Q.Huang et al.

 

several advantages. First, the CRF method allows unlimited
insertions/deletions. Some existing methods can only handle a
small number of insertions/deletions, because the computational
complexity of these methods depend on the maximum allowed
number of insertions/deletions. In other words, if the maximum
allowed number of insertions/deletions is too large, their models
may become intractable within reasonable time. Conversely, the
computation time of CRF method is independent of the maximum
number of insertions/deletions. Therefore, the CRF method can
discover better matching results.

Second, the CRF method can efﬁciently and accurately query
networks with cycles. The existing methods can successﬁilly deal
with simple network structure such as linear chain and tree.
However, most of them cannot be straightforwardly extended to
the networks with cycles. The CRF model can be exactly solved
for linear chain and tree cases. For general networks, there are
also many mature CRF algorithms in the literature. Although these
algorithms is not theoretically guaranteed optimal for the networks
with cycles, extensive computational experiments on simulated and
real data show that the CRF method is practically efﬁcient and
accurate.

Third, the CRF method addresses the directed network querying
problem and the undirected network querying problem with the
same model. Therefore, the results of directed networks are naturally
consistent with that of undirected networks.

Finally, the CRF method can easily incorporate additional
information as a result of the ﬂexibility the CRF model possesses.
New information can be integrated into the node and edge feature
ﬁinctions as well as new feature functions. For example, the BLAST
E-value used for calculating the node similarity of protein or gene
networks can be substituted by other measurement such as the
ﬁinctional similarity deﬁned by common Gene Ontology terms
(Ashbumer et a1., 2000). The edge feature function can be deﬁned
by using other network properties instead of the shortest path.
Additional feature ﬁinctions also can be introduced to emphasize
concrete biological implications, which will be one of the major
research directions in the future.

The network querying problem is Closely related to the graph
matching problem. CRF and the related methods such as Markov
random ﬁelds (MRFs) have been used extensively in the non-
bioinformatics graph matching literature (Bayati et a1., 2009; Caelli
and Caetano, 2005; Caetano et a1., 2004; Torresani et a1., 2008).
Banks et a1. (2008) addressed another kind of network querying
problem, in which a network schema (e.g. desired topology, types
of nodes and interactions) instead of a concrete network is queried
in the target networks. Some ideas in these works may be useﬁil to
improve the proposed method in this article, which will be another
major research work in the future.

Funding: National Natural Science Foundation of China (Grant
No. 60970091 and 60873205); Knowledge Innovation Program of
the Chinese Academy of Sciences (Grant No. kjcx-yw-s7).

Conﬂict of Interest: none declared.

REFERENCES

Ashbumer,M. et a1. (2000) Gene ontology: tool for the uniﬁcation of biology. the gene
ontology consortium. Nat. Genet, 25, 25729.

Banks,E. et a1. (2008) Netgrep: fast network schema searches in interactomes. Genome
Biol., 9, R138.

Bayati,M. et a1. (2009) Algorithms for large, sparse network alignment problems.
In Proceedings Ninth IEEE International Conference Data Mining I C DM ’09. IEEE,
pp. 7057710.

Blin,G et a1. (2010) Querying graphs in protein-protein interactions networks using
feedback vertex set. IEEE/ACM Trans. Comput. Biol. Bioinform., 7, 628$35.
Bruckner,S. et a1. (2009) TORQUE: topology-free querying of protein interaction

networks. Nucleic Acids Res., 37, WIOGWIOS.

Caelli,T. and Caetano,T. (2005) Graphical models for graph matching: approximate
models and optimal algorithms. Pattern Recognit. Lett., 26, 3397346.

Caetano,T.S. et a1. (2004) Graphical models for graph matching. In Proceedings of
the IEEE Computer Society Conference Computer Vision and Pattern Recognition
CVPR 2004. Vol. 2, IEEE.

DeCaprio,D. et a1. (2007) Conrad: gene prediction using conditional random ﬁelds.
Genome Res., 17, 138971398.

Dost,B. et a1. (2008) QNet: a tool for querying protein interaction networks. J. Comput.
Biol., 15, 9137925.

Drubin,D.G. et a1. (1990) Homology of a yeast actin-binding protein to signal
transduction proteins and myosin-i. Nature, 343, 2887290.

Hattori,M. et a1. (2003) Development of a chemical structure comparison method for
integrated analysis of chemical and genomic information in the metabolic pathways.
J. Am. Chem. Soc., 125, 11853711865.

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and genomes.
Nucleic Acids Res., 28, 27730.

Kelley,B.P. et a1. (2004) PathBLAST: a tool for alignment of protein interaction
networks. Nucleic Acids Res., 32, W837W88.

Kobashi,N. et a1. (1999) Aspartate kinase-independent lysine synthesis in an extremely
thermophilic bacterium, thermus therrnophilus: lysine is synthesized via alpha-
aminoadipic acid not via diaminopimelic acid. J. Bacteriol., 181, 171371718.

Lafferty,J. et a1. (2001) Conditional random ﬁelds: probabilistic models for segmenting
and labeling sequence data. In Proceedings of International Conference on Machine
Learning (ICML). Morgan Kaufmann, Waltham, MA, USA, pp. 2827289.

Lee,T.I. et a1. (2002) Transcriptional regulatory networks in Saccharomyces cerevisiae.
Science, 298, 7997804.

Li,Z. et a1. (2007) Alignment of molecular networks by integer quadratic programming.
Bioinformatics, 23, 163171639.

Pinter,R.Y. et a1. (2005) Alignment of metabolic pathways. Bioinformatics, 21,
340173408.

Qian,X. et a1. (2009) Querying pathways in protein interaction networks based on hidden
Markov models. J. Comput. Biol., 16, 1457157.

Sha,F. and Pereira,F. (2003) Shallow parsing with conditional random ﬁelds.
In Proceedings of Human language Technology/North American chapter of
the Association for Computational Linguistics annual meeting (HLT/NAACL).
Association for Computational Linguistics, Stroudsburg, PA, USA.

Shlomi,T. et a1. (2006) QPath: a method for querying pathways in a protein-protein
interaction network. BM C Bioinformatics, 7, 199.

Tian,Y. et a1. (2007) SAGA: a subgraph matching tool for biological graphs.
Bioinformatics, 23, 2327239.

Torresani,L. et a1. (2008) Feature correspondence via graph matching: Models and
global optimization. In Computer VisioniECCV 2008. Springer, pp. 59G609.
Viterbi,A. (1967) Error bounds for convolutional codes and an asymptotically optimum

decoding algorithm. IEEE Trans. Informat. Theory, 13, 26w269.

Wainwright,M.J. and Jordan,M.I. (2008) Graphical models, exponential families, and
variational inference. Found. Trends Mach. Learn., 1, 17305.

Wu,L.-Y. et a1. (2009) Conditional random pattern algorithm for LOH inference and
segmentation. Bioinformatics, 25, 61$7.

Xenarios,I. et a1. (2000) DIP: the database of interacting proteins. Nucleic Acids Res.,
28, 2897291.

Yang,Q. and Sze,S.-H. (2007) Path matching and graph matching in biological networks.
J. Comput. Biol., 14, 56767.

 

3178

112 /3.10's[BumoipJOJXO'sorwuiJOJurorq”:duq uteri papeolumoq

9103 ‘Og isnﬁnv uo ::

