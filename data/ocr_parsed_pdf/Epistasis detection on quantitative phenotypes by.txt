Vol. 2718MB 2011, pages i214-i221
doi:10. 1093/bioinformatics/btr218

 

Epistasis detection on quantitative phenotypes by exhaustive

enumeration using GPUs

Tony Kam-Thonglazi‘, Benno P tzl, Nazanin Karbalail, Bertram M Iler-Myhsok1 and

Karsten Borgwardt2

1Statistical Genetics, Max Planck Institute of Psychiatry, Munich and 2Machine Learning and Computational Biology
Research Group, Max—PIanck—Institutes, T bingen, Germany

 

ABSTRACT

Motivation: In recent years, numerous genome-wide association
studies have been conducted to identify genetic makeup that
explains phenotypic differences observed in human population.
Analytical tests on single loci are readily available and embedded in
common genome analysis software toolset. The search for significant
epistasis (gene—gene interactions) still poses as a computational
challenge for modern day computing systems, due to the large
number of hypotheses that have to be tested.

Results: In this article, we present an approach to epistasis detection
by exhaustive testing of all possible SNP pairs. The search strategy
based on the Hilbert—Schmidt Independence Criterion can help
delineate various forms of statistical dependence between the
genetic markers and the phenotype. The actual implementation of
this search is done on the highly parallelized architecture available
on graphics processing units rendering the completion of the full
search feasible within a day.

Availability: The program is available at http://www.mpipsykl.mpg
.de/epigpuhsic/.

Contact: tony@mpipsykl.mpg.de

1 INTRODUCTION

The ﬁeld of bioinformatics matures into a stage of development
where the common association search of signiﬁcant univariate
single-nucleotide polymorphism (SNP) to a particular phenotype
reveals few novel insights in the underlying biological mechanisms
involved. New endeavors must be undertaken to address potential
higher order interactions existing among genes in View of revealing
underlying common mechanisms in more complex diseases. A brute
force exhaustive approach currently poses as a computational
challenge. In human studies, the number of SNP can be in the order of
millions resulting in the number of possible SNP pair combinations
in the order of 1012—1014. The number of individuals can likely
be in the range of tens of thousands in large study cohorts. Both
dimensions will continue to grow as technological advancement
continues on its steady incline. Approaches based on search space
pruning and exhaustive search have been adopted for the study
on gene—gene interactions in genome-wide association studies.
Filtering by main effects to create a subset of SNPs on which all
possible interactions are tested for, fails to capture high signiﬁcance
pairs with low main effects. Zhang et al. (2008) and the more
generalized form demonstrated by Zhang et al. (2009), are based

 

*To whom correspondence should be addressed.

on space search reduction strategy but is limited to homozygous
SNPs and the noted speedup factor has not been substantial for
large sample size. The most compelling search space pruning method
developed by Zhang et al. (2010) has overcome these shortcomings
but is limited to tests based on contingency tables where classes on
the phenotype exist. As tools involved in collecting data improve,
the software and computational strategy employed for the analysis
should be reﬁned to accommodate for these changes and should not
limit the type of investigation that can be undertaken.

In Kam-Thong et al. (2010), a difference of Pearson’s correlation
coefﬁcients between binary phenotypes across all possible SNP pairs
has been developed. This approach of a difference in correlation
coefﬁcients is not only mathematically appealing for its simplicity
and from a practical standpoint for the comparative ease with which
it can be computed, but is also interesting and appealing from a
biological standpoint—it ties up the concepts of epistasis with the
evolutionary concept of co-selection of unlinked loci.

This search protocol was implemented on graphics processing
units (GPUs) using the available parallel computing capability to
reduce the search time by several orders of magnitude compared
to single-core CPU-based computation. However, this method is
strictly limited to binary phenotypes. When the recorded phenotypes
are of quantitative nature, differences of test measures cannot be
performed between classes/clusters of datasets as compared to
the binary or qualitative phenotype counterparts where classes of
subjects preexist. This article aims to present the steps that were
taken to overcome this severe limitation and extend this method to
quantitative phenotypes.

The proposed search strategy performs an exhaustive search for
interaction signiﬁcance across all SNP pairs against a quantitative
phenotype. The method is derived from the Hilbert—Schmidt
Independence Criterion (HSIC) developed by Gretton et al. (2005).
Furthermore, the implementation is done on commercially available
GPUs to reduce the ﬁnancial costs and search time. The actual
timing measure will depend largely on the marker coverage size and
computer resource utilized. However, the order of speedup factor is
consistently observed throughout.

This article is structured in the following order. It will ﬁrst
extend the correlation difference method developed for binary
phenotypes in Kam-Thong et al. (2010) to quantitative phenotypes
by demonstrating it as an instance of HSIC. The proposed method
is applied on a set of simulated data and a set of real data in the
results section. Improved efﬁciency is measured between the GPU
implementation and its CPU counterpart. Validation is determined
by a comparison to the signiﬁcance of the interaction term using
linear regression ﬁt.

 

© The Author(s) 2011. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/Iicenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'souBurJOJuroiqﬂ:duq 11101} popcorn/hog

9103 ‘0g1sn8nv uo ::

Epistasis detection on quantitative phenotypes

 

2 METHODS
2.1 Algorithm derivation

2.1.1 Setting We assume that we are given a set of n patients with
genotypes X and phenotypes Y. Patient i has genotype X, and phenotype yi.
Each genotype xi 6 IR’". where m is the number of SNPs. SNPA of patient i
is denoted by  e{0,1,2}.

We further assume that the phenotypes are binary, that is y,»e{0,1}. If
y, = 1, we refer to patient i as a case. if y, :0, we refer to this patient as a
control. We denote the number of cases by n1. the number of controls by no.
such that n:=n0 +n1.

2.1.2 Correlation coeﬁ‘icient diﬁ‘erence method on binary phenotype The
method developed in Kam-Thong et al. (2010) uses the correlation coefﬁcient
difference between cases and controls. Equation (1). as an approximation to
the signiﬁcance of the interaction term resulting from the logistic regression
on dichotomous phenotypes:

2
Ap(X(A’B),Y)= 2525—1 254‘}? . (1)

II no

"I ». ».
i.y,-:l i.y,-:0

Here  and if? represent the two SNPs A and B. which have been
centered by subtracting their mean and rescaled by dividing them by the
standard deviation for each subject class. cases (y, = 1) and controls (y, = 0).
respectively.

The reasoning in Kam-Thong et al. (2010) is that SNP pairs (A,B) with
the largest difference in correlation between cases and controls are most
likely to exhibit an epistatic interaction. The search for these SNP pairs with
maximum Ap(X(A’B), Y) is performed by exhaustive search by means of a
highly efﬁcient graphical processing unit (GPU) implementation. This GPU
implementation allows to conduct the search for epistatic interactions on
datasets with 100s of individuals and 100 000s of SNPs in less than a day.

However. the formulation in Kam-Thong et al. (2010) suffers from one
severe limitation. which is that it only applies to binary phenotypes. In the
following. we show how to overcome this problem via the HSIC.

2.1.3 HSIC The HSIC is a statistical measure of independence of two
random variables (Gretton et al., 2005). Intuitively. HSIC can be thought of
as a squared correlation coefﬁcient between two random variables x and y
computed in feature spaces J: and g.

In more detail. let x be a random variable from the domain X and y a
random variable from the domain 3}. Let T and g be feature spaces on
X and 3} with associated kernels kzX >< X—> R and 1:32 >< y—> R. If we
draw pairs of samples (x, y) and (x/ ,y’) from x and y according to a joint
probability distribution p00,), then the HSIC can be computed in terms of
kernel functions via:

HSIC(pa,».f.g>=Ex,./,y,y/[k(x,x’>l(y,y’)]
+Em/[k(x,x’)]Ey,y/U(y,y’>i (2)
—2Ex,y[Exr[k(x,x’)]Ey/[lam].

where E is the expectation operator. The empirical estimator of HSIC for a
ﬁnite sample of points X and Y from x and y was shown in (Gretton et al..
2005) to be

HSIC((X, Y), T, g) octr(KHLH), (3)

where tr is the trace of the products of the matrices, H is a centering matrix
Hij 28W) —% (where 80,1321 if i=j and 80,1320 otherwise) and K and L
are the kernel matrices of the two data sets of size n X n. n being the number
of observations/individuals of the study. The larger HSIC, the more likely it
is that X and Y are not independent from each other.

2.1.4 Diﬁ‘erence of correlation of coeﬁ‘icients as an instance of HSIC As
a ﬁrst step towards generalization to non-binary phenotypes, the difference
of correlation between cases and controls in Equation (1) can be expressed
as an instance of HSIC.

THEOREM 2.1. Given two spaces T with kernel k and g with kernel l. Let k
and l be deﬁned via

k(x,»,x,->=¢(xi>¢()q>=i?i?i;‘2f, (4)
102:») = 1000100)), (5)
where tir(y,») is deﬁned via:

% ifyz’ =1
W»): l (6)

—g lfyz’ =0

Then

AMX‘A’B),Y>o<HSICempirica<<Xnag) (7)

PROOF. The theorem is shown by the following derivation:

HSICempirical((Xv Y)v $7  (8)

(X Zk(xi,xj)l(yi,yj) (9)
111'

= new? 10001000 (10)

id

2
= (256?)??me (11>

_ 1 ~ ,8 1 ~ ,8
_ 11—1 lefx, —n—0 2 ﬁx, (12)

i:y,~: i:y,-:0
= Ap(X(A’B), Y). (13)

The transition from (8) to (9) follows from the fact that l gives rise to a
centered kernel matrix (LzHLH) and equation (3). (10) follows from (9)
due to the deﬁnition of k. and (12) from (11) due to the deﬁnition of l. I

2.1.5 Generalization of HSIC to quantitative phenotypes What we learn
from Theorem 2.1 is that the difference in correlation of two SNPsA and B on
cases and controls is an instance of HSIC for a speciﬁc choice of the kernel l.
In Kam-Thong et al. (2010). this kernel l is chosen for binary phenotypes,
as obvious by its deﬁnition in (Equation 6). To generalize the difference
in correlation to non-binary phenotypes, we have to choose a kernel for
non-binary phenotypes.

If the phenotypes are real numbers. that is y, ER we may choose
the centered linear kernel (that is, 11r(y,»):= 9,») as kernel on the centered
phenotypes 9,», giving rise to the following criterion for SNP pair interaction.

DEFINITION 2.2 (epiHSIC). We deﬁne l to be a centered linear kernel on
real-valued phenotypes i(y,,yj)=y,yj and k as a kernel on SNP pairs as in
equation (4). Then

epiHSICemPiricalﬂX, Y), T, g) (X
Zitifij‘gfwmwn (14)
ll]
is a statistical measure of interaction between the SNP pair (A,B) and the
real-valued phenotypes Y

 

i215

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqH:duq 11101} papeolumoq

9103 ‘0g1sn8nv uo ::

T.Kam-Thong et al.

 

The following lemma follows immediately from the proof of Theorem 2.1
and the deﬁnition of epiHSIC:

LEMMA 2.3. epiHSICempiricalﬂX,Y),]:,g) can be computed in a runtime
which is linear in n by rewriting it as

epiHSICempirical((X, Y), 1?, g) cx
2
cx (Zﬁifmn) (15)
2
= (236259,) (16)

Hence on n patients with m SNPs, an exhaustive computation of epiHSIC
statistics for all pairs of SNPs will require a runtime of 0(m2n) based on
the lemma above. epiHSIC is the instance of HSIC which we implement on
GPUs and use in our experiments in what follows.

2.2 Relationship between HSIC and linear regression

Before moving to the GPU implementation. we theoretically investigate why
the proposed HSIC can be used as an approximation to the linear regression
coefﬁcient estimates that are often used in statistical genetics to quantify
the impact of variables on the phenotype. For this purpose. we examine
the derivation of estimates using the least squares regression method and
compare it to HSIC.

Starting with the linear function of the simplest form.

¢U)=a+b¢(x)w (17)
where 1h:R—> R and ¢:R—> R. The residuals. R. of the estimated mapped
output my) and observed mapped output (My) can then be squared.

R2 = Zwryn— Wt)?

i

(18)
=Z(w(yi>—(a+b¢(xi>>>2

The minimal residual term can be solved by partial differentiations on
coefﬁcients a,b to yield optimal parametric estimates. Differentiating R2
by parameter a and setting it to zero.

3_R2 :0 (19a)
3a
Z¢0,)=na+b2¢(x,) (19b)
Similarly. for coefﬁcient 1
Bail: :0 (20a)
Emmy» =aZ¢m>+bZ¢m>2 (20b)

Combining the two equations in matrix form (sums are implied over i) and
solving for coefﬁcient b.

[a]_[ n Z¢(xi>]“[ 2w» ] (21)
b 2am Emit Emmi)

= Z¢(xi)ll’()/i) — n¢(x)1lf(y)

b _2 (22)
EMMY —”¢(X)
= COF(¢(X)~ 100))‘711/0) (23)
04506)
(X l/HSIC((X, Y),J-‘, g) m (24)

“4500 i
where the last line follows from the deﬁnition of HSIC if we assume d) and

(it to be the feature maps into space J: and g, respectively, and if both d) and
(it rescale the data x and y to zero mean and unit variance.

This shows that the mean estimated parameter b is proportional to HSIC
scaled by the ratio of the standard deviations of the output (phenotype
11r(y)) and the input (SNPisNP interaction ¢(x) =xAxB). The variance of the
phenotype for each pair tested can only vary on the basis of missing subjects
from one SNP pair to another due to incomplete genotyping. Moreover, the
variance of the input does not change signiﬁcantly from one pair to another
in practice. For example in the dosage encoding, the minor allele is counted
and the product of two SNPs can only take on discrete values from the ﬁnite
set 0.1.2.4. Consequently. high HSIC value should lead to an estimated
parametric coefﬁcient further away from null which also implicates lower
residuals in the ﬁt. Based on this relationship. the estimated parameters across
all SNP pairs should be correlated to HSIC if the standard deviations of the
phenotype and the SNP pairs are conﬁned within a certain range.

2.3 Implementation on GPU

The GPU provides a massively parallel computational environment in which
the exhaustive SNP pairs search can be conducted in a time efﬁcient
manner. Currently. there are several hundred of arithmetic logic units (ALUs)
on a single GPU, which is the most appealing aspect over conventional
CPU based computing. The Compute Uniﬁed Device Architecture (CUDA)
C programming language developed by NVIDIA is an extension to the
C language speciﬁcally designed to facilitate general-purpose GPU (GPGPU)
computing and harness the computational power of GPUs built with
NVIDIA’s CUDA Architecture. Communication latency related to memory
transfer poses as the main performance bottleneck in GPGPU computing. It
is important to supply the graphic device with ample amount of input data to
keep all its cores busy in View of achieving maximal performance. Accessing
memory within the GPU and waiting for all threads to synchronize before
carrying on subsequent calculations are also another source of slowdown.
As HSIC between each SNP pair and the phenotype can be tabulated
independently, this can take full advantage of GPU.

To perform HSIC between every possible SNP pair and the quantitative
phenotype. two genotype matrices (Xsz_Seu and XSNP_Se[2), matrices with
column vectors of subset number of SNPs, and the phenotype vector
yphenmype are passed on to the GPU. The reason the genotype data must be
partitioned is due to physical memory limitation on the device. The genotype
XSI\Il,_Se”XSTI\IP_selz matrix cross product guarantees that the product of all
possible pairs of SNPs across all individuals will be computed. At the heart
of GPU computing is the ability to keep computation on multiple threads
running in parallel. Threads are grouped in blocks and there is a limit of
the number threads that can be used per block, Nthreads. In order to perform
computation on vectors greater than Nlhreads, the use of a combination of
threads and blocks is necessary. There is an inherent trade-off between the
number of blocks versus the size of the blocks. The overall process consists
of the computation of multiplications and three sets of summations which
can take full advantage of the GPU environment. The ﬁrst sum is used to
tabulate the mean. second to ﬁnd the standard deviation and lastly, the HSIC
is computed using the mean and standard deviation stored in shared memory.
The speedup factor is accomplished by performing running sums in groups of
Nthreadg, termed warp. in the single instruction, multiple data (SIMD) format
in GPU before collapsing it back to a single scalar value using conventional
parallel reduction algorithm.

3 RESULTS

3.1 Experimental data

The method is ﬁrst tested on simulated data followed by real data
obtained from a depression study using Hamilton Depression Rating
Scale as the quantitative phenotype for each individual. Although the
dosage model was chosen for the experiments, the genotype data can
in fact also be coded using a dominant, recessive or heterozygous
model based coding.

 

i216

112 /3.Io's[Bumo[p.IOJXO'soueuIJOJurorq”:duq 11101} papeo1umoq

9103 ‘0g1sn8nv uo ::

Epistasis detection on quantitative phenotypes

 

 

Algorithm 1 GPU-HSIC Pseudocode

Acquire genotype matrices Xng_Setl ,Xng_Sea and
phenotype vector y
Vectorize matrices
Compute for each pair of blocks, Bx and By
for offset = 1 TO nsubjects STEP Nthreads d0
HSICtemp[1 "‘Nthrcads] (— HSICtemp[1 "‘Nthrcads] 1'
XSNP—setl [BX X nsubjects +0ﬁset] X
XSNP—set2 [By X nsubjects +0ffset] X y10ﬁset]
end for

 

Perform parallel reduction on the HSICtemp

 

3.2 Hardware and software setup

The hardware used in the experimental setup consists of two
pairs of commercially available NVIDIA GTX295 (Santa Clara,
CA, USA) CUDA-enabled NVIDIA graphic cards running on an
Intel Core i7 920 with 2.67GHz (Santa Clara, CA, USA) central
processing unit host (CPU) using 12GB of DDR3 RAM (Corsair
Inc., Fremont, CA, USA). The software program is implemented
in R (version 2.9.2; R Development Core Team, 2010) with the
gputools package beta version 0.1—4 installed (Buckner et al.,
2010, http://cran.r-project.org/web/packages/gputools), in which the
ﬁInction has been modiﬁed to be passed two genotype input matrices
and one phenotype output vector.

A R package, GenABEL version 1.6-4 (http://cran.r-
project.org/web/packages/GenABEL/), is used for data compression
when the genotype is read into R as a single ﬁle. Each element
is represented by two bits covering the dosage model encoding
0, 1, 2. When elements are recorded in ﬂoating-point numbers as
in genotypic probabilities, this step is bypassed by partitioning
into smaller size ﬁles where the local memory limitation would
not be of a constraint. At the writing out stage, when a P-value
threshold is chosen to ﬁlter the results that only show promises of
true multiple test wise signiﬁcance, it will unlikely surpass the disk
storage limitation. If it is desired to store results covering a greater
range, R permits for writing out in compressed formats.

3.3 Simulation data

3.3.1 Validation For the purpose of validating the method,
data are simulated using a normally distributed output phenotype
(mean=0 and stande deviation: 1) and genotype SNP value in
{0,1,2} encoding. The number of individuals is set to 10000
subjects and 50 SNPs, resulting in 1225 unique SNP pairs. These
SNPs are simulated in Hardy—Weinberg equilibrium (P =0.05).
Testing for the signiﬁcance of the interaction SNP pair with respect
to the quantitative phenotype, a standard linear regression on the
ﬁIll rank model including main effects is performed (1/1(y)=ot+
ﬂxA +yxB+6xAxB), where the signiﬁcance of the coefﬁcient 6 is
compared to the HSIC realization derived for quantitative phenotype
in Section 2.1. A total of 1225 pairs are compared; this is a
relatively small and unrealistic number of pairs but it serves only to
demonstrate the validity of the method. As illustrated in Figure 1, the
HSIC is compared against the —log10 of the P-value obtained from
the likelihood ratio test comparing the regression models without and
with the interaction term. The r2 is noted to be 0.9764, indicating

Simulation Data
Linear Regression p-values vs. HSIC

 

3.5

3.0
|

2.5
I

2.0

1.5

 

- Iogto(pvalue5Linear)

1.0

0.5
|

 

 

 

| I I I | | |
0.0000 0.0002 0.0004 0.0006 0.0008 0.0010 0.0012

HSIC

Fig. 1. —log10Linear regression P-values versus the HSIC for 50 SNPs
(1225 pairs) 4 r2 20.9764.

that the HSIC is strongly correlated with the signiﬁcance of the
interaction term sought after.

3.3.2 Time petformance In order to gain an insight on the
improved time performance, 10000 subjects genotyped over 4000
SNPs are artiﬁcially simulated. A time comparison is made on the
HSIC calculation between a single core CPU and GPU to reveal
the advantage of porting the implementation onto GPU. The CPU
performance is largely dependent on the technical speciﬁcations
(clock speed, number of cores and cache memory) and current
load on the system. Using a single core on the Intel Core i7 CPU,
on average, it can compute the HSIC between the quantitative
phenotype and ~800 SNP pairs per second in R. The GPU runtimes
with varying number of SNP pairs are plotted in Figure 2. It is
observed that GPU runtime varies linearly with the number of SNP
pairs tested. The speedup factor relative to a single CPU remains
consistent, in the range of ~80—92. The results are detailed in
Table 1.

3.4 Real data—Hamilton Rating Scale

3.4.1 Data The Hamilton Depression Rating Scale is the standard
questionnaire used to assess the severity of a patient’s depression.
The data is collected from a depression study. More details on the
phenotype can be found in Binder et al. (2004) and Ising et al.
(2009). There is also a large overlap between the individuals in these
two studies and this consideration, all originating from the MARS
study. The quantitative phenotype used in this article is the percent
change of the scale in week 2 relative to scale tallied in the baseline
week 0 for each patient. A total of 491 patients genotyped over
536750 SNPs is used in this study. The objective of the study is to
uncover gene—gene interactions which can help explain the variation
in rate of recovery among patients. The goal is to ultimately tailor the

 

i217

112 /3.Io's[Bumo[p.IOJXO'soueuIJOJurorq”:duq 11101} papeo1umoq

9103 ‘0g1sn8nv uo ::

T.Kam-Thong et al.

 

Simulation Data
GPU Runtime Performance vs. Number of SNP pairs

 

 

 

 

o

O

2 _

o

o _
a co
5
w
<15"
5 o _ °
C (O
3
DC
a /
(D o _ 0

Sr /

o
8 - /
/o
o
I I I I
2e+06 4e+06 6e+06 8e+06

Number of SNP pairs

Fig. 2. GPU Runtime versus the number of SNP pairs in Simulation Data.

Table 1. Results from the full HSIC model

 

 

SNPs Pairs Runtime Interactions Speedup factor
[S] [US] versus Single CPU
4000 7998000 111.79 71546.78 89.93
3500 6123 250 86.27 70 976.10 88.72
3000 4498 500 63.86 70444.26 88.06
2500 3 123 750 44.73 69 834.12 87.29
2000 2 000 000 27.16 73 600.88 92.00
1500 1 124 250 16.86 66 669.63 83.34
1000 499 500 7.87 63 476.93 79.35

 

treatment for patients having just suffered an episode of depression
based on their genetic makeup.

3.4.2 Validation Linear regression is run on 48 CPU cores to
compare against the EPIGPUHSIC method. This comparison is
made simply to reveal the current state of the art on GWAS
based exhaustive epistasis detection. In order to perform the
linear regression on this brute-force approach in a time efﬁcient
manner, the use of a newly released software tool, FASTEPISTASIS
(http://www.vital-it.ch/software/FastEpistasis), is required. This is
an extension of the PLINK (Purcell et al., 2007) epistasis module
capable of distributing the work in parallel on multiple CPU cores.
Running the proposed method on the GPU requires ~40h to
complete as compared to ~57 h for completion using FASTEPISTASIS
on 48 AMD Opteron 6172 2.1GHz CPU cores (Sunnyvale, CA,
USA) with ATLAS BLAS/LAPACK version 3.2.1 (Whaley and
Petitet, 2005). It is important here to note that only the ﬁrst and
second stages of FASTEPISTASIS were included, the time required
in the third stage for writing out the results given a P-value
threshold from the binary ﬁles has been neglected, although it can
be substantial.

Table 2. Hamilton Rating ScaleiData and performance summary

 

 

HSIC runtime FASTEPISTASIS runtime
GPU [min] 48 CPUs [min]
2408.92 3 440.30

(~40 h) (~57 h)

 

Checking 536 750 SNPs (1.44><10ll pairs) in 491 subjects. 1 137 450 interactions below
a threshold of P < 10‘5 are found.

Real Data-Hamilton Rating Scale
Linear Regression p-values vs. HSIC

 

 

 

 

g _
A m -
E
8
a °° ‘
>
%
6:
2 N —
I

w _

lo _

I I I I I
0.04 0.05 0.06 0.07 0.08
HSIC

Fig. 3. Overall ﬁt done on the top one million matching pairs. — log 10 Linear
regression interaction model versus HSIC.

A comparison of the time performance between the two tests
is summarized in Table 2. It is noted that EPIGPUHSIC on a
single graphic card outperforms FASTEPISTASIS on 48 CPU cores
by a factor of 1.4. By taking into account that 48 CPU cores are
used, this observation is comparable to the noted speedup factor in
Section 3.3.2.

In Figure 3, the HSIC values are plotted against the P-values of
the linear regression on the interaction term. Furthermore, it has been
shown that the distribution of HSIC is asymptotically approaching
normal (Gretton et al., 2005), which in turn allows for signiﬁcance
tests to be performed based on standard statistics. The P-values of
the HSIC terms are compared to the P-values of the linear regression
on the interaction term (Fig. 4).

Moreover, in order to verify that no signiﬁcant number of pairs are
left unmatched between the two methods, a percent match moving
across the ranked pairs is performed (Fig. 5). The noted behavior
further consolidates the fact that the approximation method does
hold, as it quickly approaches ~75% matched pairs in the ﬁrst 1000
ranked pairs between the two methods.

Furthermore, to investigate the univariate SNP effect in the
quality of the ﬁt between the proposed HSIC method and the
linear regression, the P-values of the univariate SNPs are color
coded in Figure 6. The P-values of the univariate SNP range

 

i218

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqH:duq 11101} papeo1umoq

9103 ‘0g1sn8nv uo ::

Epistasis detection on quantitative phenotypes

 

Real Data-Hamilton Rating Scale
Linear Regression p—values vs. HSIC p—values

 

o-
,_

fro,—
no

u)

.E

_.

ll)

8

_ co—
m

>

o.

v

.0.

a:

2 [\—
I

to-
m-

 

 

 

— I0910(PV31U35HSIC)

Fig. 4. Overall ﬁt done on the top one million matching pairs. —log10
Regression interaction model versus —log10HSIC P-values.

Real Data-Hamilton Rating Scale
Percent matched pairs in Top 1k ranked pairs

 

0.8

 

0.6

Percent Matched Pairs

0.2
I

 

 

 

| | | | | |
0 200 400 600 800 1000

Ranked Pair Index

Fig. 5. Matching pairs capture rate across the ﬁrst 1000 ranked pairs between
the standard linear regression ﬁt and the proposed HSIC method.

from 1 (insigniﬁcant) down to 6.2-10‘6. Univariate signiﬁcances
are classiﬁed as low (P> 0.1), medium (0.01 <P§0.1) and
high (P3001). Each pair is classiﬁed in one of the six
unique possible combinations of univariate signiﬁcances. The
quality of the ﬁt is investigated separately for each univariate
signiﬁcances combination class, see Table 3. As expected, there is
an overwhelming amount of low signiﬁcance univariate SNP. The
quality of the ﬁt between the HSIC method and linear regression

Real Data—Hamilton Rating Scale
Univariate Significance Heat Map

 

  

 

   

 

 

 

 

 

 

O
O _
a, _
Ti?
5
{ﬂ
0
2 no —
In
E
5‘
I p. _
. low—low
. low—medium
‘° ' . I law—high
I medium—medium
I medium~high
' 0 high-high
.n _
I I I I I I
5 6 'r' 3 9 10

‘ loginlmaluesHSIc)

Fig. 6. —log 10 Linear regression interaction P-values versus —log 10 HSIC
P-values (—log 10 univariate SNPl P-values of each pair is represented by
color scale ranging from insigniﬁcant to signiﬁcant from the red to blue
spectrum).

Table 3. Hamilton Rating Scale-data and performance summary

 

 

Univariate Number Correlation Coefﬁcient
xA —xB signiﬁcances of pairs HSIC versus Lin. Reg.

Lowilow 934 611 0.94

Lowimedium 176 099 0.83

Lowihigh 16 807 0.70

Mediumimedium 8239 0.74

Mediumihigh 1471 0.5 8

Highihigh 79 0.56

 

is tested when the datapoints are segregated into three separate
groups of univariate SNP signiﬁcance. It is noted that the quality
of the ﬁt varies inversely to the signiﬁcance of the univariate
SNP. A higher univariate signiﬁcance will lead to a poorer ﬁt
between the two methods. Therefore, the proposed HSIC method is
a better approximation to the linear regression when the univariate
signiﬁcance is lower. This observation makes intuitive sense but
points out a weakness in the method, as HSIC neglects univariate
effects in its assessment.

3.4.3 Top pairs and biological relevance Table 4 lists the results
for the ten SNP pairs showing the strongest interaction with respect
to the signiﬁcance test done on the linear regression. It is very
interesting to note that there is an apparent connection between the
top pairs as rs11580794, a member of the top pair is located nearby
PBXl, whereas rs12910772, a member of the runner-up is very
close to MEIS2. In general the PBX and MEIS genes apparently

 

i219

112 /3.Io's[Bumo[pJOJXO'sonuIJOJquIqH:duq 11101} papeo1umoq

9103 ‘0g1sn8nv uo ::

T.Kam-Thong et al.

 

Table 4. Top ten results from Hamilton-score.

 

 

 

SNPl SNP2 HSIC Linear regression
Value P-value SNPl P-value SNP2 P-value Interaction P-value

rs11580794 rs11812623 7.70-10-02 4.42-10-10 0.9601 0.03071 1.87-10‘ll
rs12910772 rs2338712 8.22-10‘02 1.35-10-10 0.3682 0.77860 244-10—ll
rs13028359 rs2888542 8.24-10‘02 73910-11 0.2710 0.83590 2.45 - 10-“
rs13401572 rs6130852 7.87-10‘02 3.58- 10-10 0.1360 040590 25410-11
rs2105126 r51885418 7.90-10-02 2.62- 10-10 0.2911 0.56040 2.71 - 10-ll
rs861256 r511864516 7.93.10-02 1.78- 10-10 0.4486 0.91110 2.90-10-‘1
rs6442323 rsl3186058 7.74.10-02 2.61- 10-10 0.2621 0.66000 3.29-10-‘1
rs6442323 rs4958287 7.74.10-02 2.61 . 10-10 0.2621 0.66000 3.29-10-‘1
rs6442323 rs4958505 7.80-10‘02 2.24-10-10 0.2621 0.58860 3.43 - 10-“
rs7797027 rs1031912 7.87-10‘02 2.7210-10 0.7797 0.85880 3.46-10‘“

 

Bold P-values indicate signiﬁcance at the 0.05 level.

interact in brain development. Furthermore, PBXl has a ﬁInction in
glucocoticoid signalling, which is an obvious candidate pathway in
depression and its treatment (Holsboer, 2008). In addition, we see
signiﬁcant (P = 0.0345) evidence for an interaction between the two
top pairs, augmenting the hypothesis that there may be a role for the
PBX/MEIS system in this phenotype. See Table 5 for all associated
genes (within :l: 100 kb).

4 CONCLUSION AND FUTURE WORK

The difference of correlation method for binary phenotypes
developed in Kam-Thong et al. (2010) has successfully been
extended for quantitative phenotypes. This is accomplished by
expressing the test as an instance of HSIC and by making the
necessary adjustment on the mapping ﬁInction applied. By making
such an association, we have overcome the strict limitation of
Kam-Thong et al. (2010) and unlocked the method to perform
various forms of statistical dependence tests between SNP pair
interaction and the phenotype. The proposed HSIC realization in
this article uses linear kernels since the validity of the results can
be easily cross-veriﬁed with the outcome of the linear regression
ﬁt on the interaction term. While these linear kernels result in
HSIC being proportional to Pearson’s correlation coefﬁcient, the
use of other forms of kernels will be investigated in the near
future. They will allow us to extend the framework described
here to quantitative phenotypes modelled as time series, images or
videos. Another avenue of ﬁIture research is to implement linear
and logistic regressions on GPUs, which is more involved than the
GPU implementation of EPIGPUHSIC but provides a direct way of
assessing the main effect of individual SNPs when scoring pairs of
SNPs for association.

To evaluate the effects of any potential confounding factors,
linkage disequilibrium and HSIC scores are tabulated across all
possible pairs from 2000 SNPs in chromosome 1 of HapMap phase
3 CEU subjects. A r2 of 3.19-10_5 is noted between the two
measures, thus, ruling out any confounding factor due to linkage
disequilibrium.

To investigate the potential pitfall of using space-pruning
techniques based on main effects, the ﬁrst 10000 most signiﬁcant
interaction pairs obtained from a mu exhaustive search and their

Table 5. Physical annotation of the top ten Hamilton-score results

 

 

 

SNP Position Gene Distance
Chr [kb] [kb]
rs11580794 1:163 120 PBXl +40
rs11812623 10:79 860 SNORA71 +60
rs12910772 15:34 960 MEISZ +10
rs2338712 22:47 210
rs13028359 2: 19 940 TTC32 +20
WDR35 +30
rs2888542 2:37 760 CDC42EP3 — 10
rs13401572 2:157 660
rs6130852 20:43 575 SPINT3 0
WFDC6 +20
SPINLWl +30
WFDC8 +40
WFDC2 +30
rs2105126 1:80980
rs1885418 14:95 150 TCL2 —40
rs861256 11:33 700
rs11864516 16:725 NARFL 0
HAGHL +5
CCDC78 — 10
C16orf24 +10
METRN +20
FBXL16 —30
MSLN —25
MPFL +30
RPUSDl +50
rs6442323 3:12 700 RAFl —20
rs13186058 5:151311 GLRAl —30
rs6442323 3:12 700 RAFl —20
rs4958287 5:151310 GLRAl —30
rs6442323 3:12 700 RAFl —20
rs4958505 5:151 325 GLRAl —40
rs7797027 7: 15 455 FLJl6327 0
rs1031912 15:92390
In the distance column ‘—’ indicates upstream of the gene, ‘+’ downstream of the gene,

a distance of 0 means in the gene.

 

i220

112 /3.Io's[Bumo[p.IOJXO'soueuIJOJurorq”:duq moi; papeo1umoq

9103 ‘0g1sn8nv uo ::

Epistasis detection on quantitative phenotypes

 

corresponding main effects P-values are analyzed. It shows minimal
correlation, r2 of 5.17- 10‘5 and 2.23- 10‘3 for the ﬁrst and second
SNP of the pairs, respectively. Furthermore, we have adopted the
space pruning solutions by retaining the top 10% most signiﬁcant
main effect SNPs and performed an exhaustive search with the
remaining 90% SNPs. When these results are compared to the full
exhaustive search results, only a small percentage of the ﬁndings
can be matched, leaving 87% of the pairs in the top 10 000 ranked
SNP pairs from the ﬁIll exhaustive search method unresolved. If
we are to ﬁIrther limit the exhaustive search of the top 10% most
signiﬁcant univariate SNPs within its own subset, the matching pairs
compared to the ranked signiﬁcant pairs obtained from the brute
force exhaustive drops down to a mere 0.8% for the ﬁrst 10000
ranked SNP pairs.

Low correlation between the randomness of any potential additive
noise on the output signal with the input signal ﬁIrther favors the
proposed HSIC approach. As the signal-to-noise ratio in the output
measurements approaches a critical threshold, this method should
be more robust as compared to the least squares ﬁtting since the
correlation term between the noise and the input will approach zero,
thus having no effect in the test. Further investigation needs to be
performed.

Furthermore, a multiplicative effect (AND) is assumed between the
SNPs in each pair. This can be further modiﬁed to accommodate for
other forms of interaction (multiplicative within and between loci
or interaction threshold effects) detailed in Marchini et al. (2005)
and applying other logical operators such as NOR, XOR, NAND. The
biological relevance of these models remains to be explored.

Testing millions and billions of epistatic interactions requires
correction for multiple hypothesis testing. As Bonferonni correction
often results in highly conservative signiﬁcance thresholds,
permutation-based statistical tests such as Zhang et al. (2010) have
been proposed in the literature. In ﬁIture work, we will work on
GPU implementations of permutation-based tests of signiﬁcance for
EPIGPUHSIC and related methods.

ACKNOWLEDGEMENT

The authors thank Oliver Stegle, Barbara Rakitsch and Chloe-
Agathe Azencott for fruitful discussions.

Funding: Max Planck Society (in part); German Ministry for
Education and Research (BMBF) through Germany’s National
Genome Research Network (Moods—01GS08145 to B.M.M.).

Conﬂict of Interest: none declared.

REFERENCES

Binder,E.B. et al. (2004) Polymorphisms in FKBPS are associated with increased
recurrence of depressive episodes and rapid response to antidepressant treatment.
Nat Genet, 36, 131941325.

Buckner,J. et al. (2010) The gputools package enables GPU computing in R.
Bioinformatics, 26, 1344135.

Gretton,A. et al. (2005) Measuring statistical dependence with Hilbert-Schmidt norms.
In Proceedings of the International Conference on Algorithmic Learning Theory,
Springer, Singapore, pp. 63477.

Holsboer,F. (2008) How can we realize the promise of personalized antidepressant
medicines? Nat Rev. Neurosci, 9, 638$46.

Ising,M. et al. (2009) A genomewide association study points to multiple loci that
predict antidepressant drug treatment outcome in depression. Arch. Gen. Psychiat,
66, 9664975.

Kam-Thong,T. et al. (2010) Epiblaster - fast exhaustive two-locus epistasis detection
strategy using graphical processing units. European J. Hum. Genet, 19, 465471.

Marchini,J. et al. (2005) Genome-wide strategies for detecting multiple loci that
inﬂuence complex diseases. Nat Genet, 37, 413417.

Purcell,S. et al. (2007) Plink: a toolset for whole-genome association and population-
based linkage analysis. Am. J. Hum. Genet, 81, 559575.

R Development Core Team (2010) R: A language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Whaley,R.C. and Petitet,A. (2005) Minimizing development and maintenance costs in
supporting persistently optimized BLAS. Software Pract. Exp, 35, 1014121.

Zhang,X. et al. (2008) Fastanova: an efﬁcient algorithm for genome-wide association
study. In Proceeding of the 14th ACM SIGKDD international conference
on Knowledge discovery and data mining, ACM, Las Vegas, Nevada, USA,
pp. 8214829.

Zhang,X. et al. (2009) COE: A general approach for efﬁcient genome-wide two-
locus epistasis test in disease association study. In Proceedings of RECOMB 2009,
Springer, Tuscon, Arizona, USA, pp. 2534269.

Zhang,X. et al. (2010) TEAM: efﬁcient two-locus epistasis tests in human genome-wide
association study. Bioinformatics, 26, i2174i227.

 

112 /3.Io's[Bumo[pJOJXO'sorieuIJOJurorqp:duq moi; papeo1umoq

9103 ‘0g1sn8nv uo ::

