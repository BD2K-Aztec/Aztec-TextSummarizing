ORIGINAL PAPER

Vol. 26 no. 8 2010, pages 1043-1049
doi: 1 0. 1 093/bioinformatics/btq097

 

Gene expression

Advance Access publication March 4, 2010

Statistical expression deconvolution from mixed tissue samples

Jennifer Clarke1’2’*, Pearl Seo1 and Bertrand Clarke”,3

1Department of Medicine, University of Miami, 1120 NW 14th St, Suite 611, Miami, FL 33136, 2Department of
Epidemiology and Public Health, University of Miami, 1120 NW 14th St, Suite 1005, Miami, FL 33136 and 3Center
for Computational Science, University of Miami, 1120 NW 14th St, Suite 619, Miami, FL 33136, USA

Associate Editor: John Quackenbush

 

ABSTRACT

Motivation: Global expression patterns within cells are used for
purposes ranging from the identification of disease biomarkers
to basic understanding of cellular processes. Unfortunately, tissue
samples used in cancer studies are usually composed of multiple
cell types and the non-cancerous portions can significantly affect
expression profiles. This severely limits the conclusions that can
be made about the specificity of gene expression in the cell-type
of interest. However, statistical analysis can be used to identify
differentially expressed genes that are related to the biological
question being studied.

Results: We propose a statistical approach to expression
deconvolution from mixed tissue samples in which the proportion
of each component cell type is unknown. Our method estimates the
proportion of each component in a mixed tissue sample; this estimate
can be used to provide estimates of gene expression from each
component. We demonstrate our technique on xenograft samples
from breast cancer research and publicly available experimental
datasets found in the National Center for Biotechnology Information
Gene Expression Omnibus repository.

Availability: R code (http://www.r-project.org/) for estimating sample
proportions is freely available to non-commercial users and available
at http://www.med.miami.edu/medicine/x2691.xml

Contact: jclarke@med.miami.edu

Received on January 13, 2010; revised on February 22, 2010;
accepted on February 25, 2010

1 INTRODUCTION

In the past decade, gene expression proﬁling has demonstrated an
amazing potential for identifying disease biomarkers and improving
our understanding of cellular processes (Pittman et (11., 2004; van’t
Veer et (11., 2002; Wheelan et (11., 2008). An issue not often discussed
is that many biological samples contain mixtures of cell or tissue
types (Wang et (11., 2006); for example, cancer cells may only
constitute part of a biopsy sample. The amount of each mRNA
detected in a microarray experiment is inﬂuenced by the composition
of the sample; observed changes in gene expression may simply
reﬂect a change in the distribution of the cell types in the sample
population (Causton et (11., 2003). In breast cancer Cleator et (11.
(2006) noticed that the proportion of benign tissue of biopsy
samples can signiﬁcantly affect expression proﬁles, and taking
into consideration this proportion can improve response prediction.

 

*To whom correspondence should be addressed.

Sample heterogeneity severely limits the conclusions that can be
made about speciﬁcity of gene expression and may explain in part
why the results of numerous gene expression experiments have
failed rigorous validation (Michiels et (11., 2005).

Given a heterogeneous sample there exist laboratory approaches
to separate cells of distinct types. Laser capture microdissection
(LCM; Fend and Raffeld, 2000) is a popular technique for isolating
regions of a biological sample that are separated by distances of
a few cell widths. However, the cell types of interest need to
be morphologically distinct. LCM, is very time-consuming and
specialized equipment, is required to obtain a sufﬁcient quantity
of biological material for proﬁling. If the sample of interest is in
suspension, cell-sorting methods can be used to isolate cells of
interest. This requires a suitable biomarker for the cell type of
interest. The main drawback of cell sorting with respect to proﬁling
is that the act of separation itself can alter gene expression (Gosink
et (11., 2007).

We present a method for deconvoluting expression from a
heterogeneous sample into components that reﬂect the contributions
to the observed expression attributable to each component cell or
tissue type. The key component of this method is the estimation,
from a mixed tissue sample, of the proportion of mRNA from a
single tissue type. Estimation is based on speciﬁc logarithmic data
transformations and theory from differential geometry regarding the
radius of curvature (Lipschutz, 1969). We demonstrate our method
on several datasets from breast cancer xenograft studies, from both
proprietary sources and the National Center for Biotechnology
Information (NCBI) Gene Expression Omnibus (GEO) repository
(http://www.ncbi.nlm.nih.gov/geo/; Barrett et (11., 2006).

2 APPROACH

Several approaches have been taken to the problem of expression
deconvolution and each approach depends on access to different
types of information, different statistical assumptions and different
objectives.

If there are genes known to be expressed exclusively in one
tissue type, then these genes can be used to estimate the proportion
of expression coming from that tissue. For example, the program
DECONVOLUTE (Lu et (11., 2003) uses simulated annealing and
genes expressed only during speciﬁc cell cycles to identify the
proportion of cells in each cycle from an asynchronous cellular
sample. These methods depend on known tissue- or cell-speciﬁc
genes, and technology that can detect their expression with little
or no cross-hybridization. If these conditions is not met, widely
varying estimates of pA can be obtained by selecting different subsets

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /3.Io's[Bumo[pJOJXO'sotwuiJOJutotqﬂ:duq 11101} papBOIII/lAOG

9103 ‘1g1sn8nv 110::

J. Clarke et al.

 

of tissue-speciﬁc genes. Note that low speciﬁcity of microarray
hybridizations has been suggested to be one of the prime measures
affecting discrepancies in gene-expression proﬁles between different
probes targeting the same region of a given transcript or between
different microarray platforms (Koltai and Weingarten-Baror, 2008).
We do not assume knowledge of cell- or tissue-speciﬁc genes in our
method, although such knowledge may be available, particularly
for samples from xenograft studies (where the tissues of interest are
from different species).

Similarly, several researchers have used expression data from
puriﬁed reference tissue types to determine the expression of each
tissue type in heterologous samples (Lahdesmaki et (11., 2005; Venet
et (11., 2001). For example, Wang et (11. (2006) use a method similar
to that of Lu et (11. (2003), mentioned above, to determine the
proportions of each cell type in a mixed sample. This method
generates estimates by obtaining solutions to linear equations via
simulated annealing. These approaches depend on having expression
data from a puriﬁed reference sample for each cell or tissue type,
which may not be available.

Another approach uses proportions of each sample or cell
type, assessed by pathologists, to establish either tissue-speciﬁc
expression or differential expression between mixed and control
samples. In Stuart et (11. (2004) linear regression models, regressing
expression on fractional content of tumor (or stroma), were used
to estimate the expected cell-type expression as the regression
coefﬁcient. A more sophisticated statistical approach was used by
Ghosh (2004) to determine differential expression in the presence of
mixed cell populations. In his approach, a pathologist’s assessments
of the proportions of each cell type were used in a hierarchical
mixture model to model the data. A combination of methods
of moments procedures and the expectation—minimization (EM)
algorithm provided estimates of the model parameters. Although
not shown in the publication, this method could be adapted to
provide expression estimates speciﬁc to each cell type, as opposed to
estimates of differential expression. Unfortunately, the assessment
of a pathologist only provides the proportion of each cell or tissue
type in the sample, and not an assessment of the amount of mRNA
or protein attributable to each. It is well known that the total amount
of mRNA generated by tumor cells, for example, is much higher
than the amount generated by normal cells. As a result estimates of
expression based on pathological assessments of tissue proportions
may not be accurate.

Finally, an approach exists to use expression data from a single cell
type to determine the proportion of each cell type in a heterogeneous
sample (Gosink et (11., 2007). This method depends on the estimation
of the minimum of a proportion, a minimum that provides a good
estimate in noiseless or simulated data. However, this minimum is
much more difﬁcult to estimate in noisy data, and microarray data is
inherently noisy. Our research builds upon this work by providing
a method for estimating this minimum that has reasonable accuracy
and can be applied in situations where one or multiple heterologous
samples are available.

3 METHODS

First. we will discuss the idea of estimating the proportion of a single cell
or tissue type in a two-type mixed sample. We will then describe the role
of data transformation in this estimation and the interest in ﬁnding the point

MDA231/Mouse Lung Titration

 

 

 

 

0.-
,_
°°._
o

w 0.-

.Q o

...

m

._

13

{‘2

O ‘1'._

‘0 o
c‘!_
o
O._
o

 

I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0

ratio ranking
Fig. 1. Rank-sorted ratios (R,) from ‘electronic’ data across values of [7A

of minimum radius of curvature. Finally. we will describe the use of the
bootstrap (Efron. 1979) for obtaining a standard error for our estimate.

3.1 Proportion of tumor as a minimum ratio

The idea of estimating the proportion of one type in a two-type mixed sample
comes from Gosink et a1. (2007). As they describe. letA be apuriﬁed sample
of one type and AB be a mixed sample. composed of tissue or cell typesA and
B. Let E,(AB)(E,(A)) be expression of gene 1' in SampleAB(A) for i = l, . . . ,m.
Let E(AB): {E 1 (AB), . . . ,E,,,(AB)}. We want to estimate [7A. the proportion
of expression in the mixed sample (Sample AB) due to tissue type A. For a
given gene 1' we can express E,(AB) as

Ei(AB)=I7AEi(A)+(1_I7A)Ei(B)+€-
Let R, =R,mix/pure =E,(AB)/E,(A). In the noiseless case.
Ri =pAEi(A)/Ei(A)+(1 —I7A)Ei(B)/Ei(A)-

Note that for a ﬁxed [7A this ratio is at its minimum when E,(B) = 0. since

expression is assumed to be non-negative. Hence. if E,(A)> 0.
EigégILORz —I7A +(1 —I7A)EI(B)/E1(A)—I7A-

Thus. under the assumption that E,(B)—>0 for some sequence of 1’s.
min,R, =pA. This can be seen in Figure l where rank-sorted ratios R,
have been plotted from ‘electronic’ simulated data at a range of proportion
values [7A. The ‘electronic data” was generated by computationally combining
expression values from puriﬁed samples of each composite type in these
speciﬁc proportions. e.g. for [7A 20.25 the electronic data is 0.25 >I<E(A)+
0.75 >I<E(B) where E(A) are expression values from a puriﬁed sample of
breast cancer cell mRNA and E(B) the expression values from a puriﬁed
sample of normal mouse lung mRNA. Note that the values of R, are sorted
from lowest to highest.

Unfortunately. the minimum ratio is an underestimate of the true
proportion value [7A for simulated noisy data and for observed data [as
Gosink et a1. (2007) establish]. For example. Figure 2 shows observed data
from a titration series (pA =0.25,0.5 and 0.75) of breast cancer cell mRNA
(MDA231) and normal mouse lung mRNA. By a titration series. we mean a
set of mixed samples (breast cancer and normal lung) in which each sample

 

1044

112 /3.Io's[Bruno[pJOJXO'sonBuiJOJutotqﬂ:duq 11101} papBOIIIAAOG

9103 ‘{g isnﬁnv 110::

Statistical expression deconvolution

 

MDA231/Mouse Lung Titration

 

 

 

 

 

0._
,_
°°._
o

w ‘0._

.Q o

...

S

1::

o

t

est

a: o'—
C\!_
o
0.-
o

 

| | | | | |
0.0 0.2 0.4 0.6 0.8 1.0

ratio ranking

Fig. 2. Rank-sorted ratios (R,) from ‘electronic’ titration data (dark) and
observed titration data (light) for proportion values [7A 20.25, 0.5 and 0.75.
Note the qualitatively different curves caused by noise in the observed data.

has a ﬁxed proportion of each tissue/cell type. What we observe is expression
data from each mixed sample in this series. so a total of three samples
with proportions of breast cancer mRNA to normal mouse lung mRNA of
{(0.25,0.75),(0.5,0.5) and (075,025)}. Hence for [7A 20.25 the observed
data is expression from a mixed sample (AB) composed as 0.25 >I<A + 0.75 >I<B.
The ‘electronic data’ is the same data as shown in Figure l. The values of
min,R, are very accurate estimates of [7A for the ‘electronic’ data but are
poor estimates of [7A for the observed data. Clearly. the ability of min,R, to
estimate [7A is greatly affected by the noise in the data; understanding and
incorporating the noise and its effect on min,R, in the estimation process is
the key to ﬁnding an accurate estimate of [7A.

3.2 Data transformation

The noise in the observed expression data from mixed samples causes
the minimum ratio to be an underestimate of the true proportion value.
A transformation that increases small ratio values while shrinking larger ratio
values may improve the accuracy of this estimate. To explore this proposition.
we considered transforming both E(AB) and E(A) with a transformation of
the form

tE,(AB) = log(l +otE,(AB))
tE,(A) = log(l +01E,(A))

for some 01 > 0 and for all i. The untransformed values of R, have a skewed
distribution with a long tail of large values (data not shown). As such the
mean of the R,s is larger than the median. The above transformation. by
decreasing large values and increasing small values. brings the mean and the
median closer together.

We discovered that across several datasets a value for 01 does exist
for which min, tR, = min, tE,(AB)/tE,(A) is an accurate estimate of [7A.
Unfortunately. this value for 01 varies with each dataset and with the value of
[7A . i.e. within each dataset and across datasets the value of 01 that provides an
accurate estimate of [7A is different for each value of [7A. For any given dataset
and value of [7A we could successfully model 01 as a function of [7A. using
a function of the form —log(9 *pﬁ + l)/(pA — l) for some 9, y> 0. However.
this function depends on [7A. the value we are trying to estimate.

 

 

 

 

 

 

 

 

 

 

:- c.
(a) 5- ' (b) — '
r a
3
g - o a _
o
n
r» u
a? §- - a a ..
> v- > q _
K E w
5 3 _ E
B 3 g
E E 3 _
E E —'
at § . s
E ci E
3
In _
3 _ _-
d
a m 0 mean
E _ medial 8 _ l medIan
d I I | | | ’ I I l I I I
u o I 0.2 u a 0.4 o 0.005 cm u 015 0.02 0.025
alpha alpha

Fig. 3. Values of tR(Ol) and md(tR(ot)) as functions of 01 for (a) MDA231/
mouse titration data at pA=0.5 and (b) MAQC human titration data at
[7A 20.75. The vertical line indicates the correct value of 01.

We acknowledge that the minimum value of tR, is sensitive to the noise in
the data. particularly in relation to the mean or the median. Hence we decided
to explore the possibility of using information from a summary statistic of
tR, (e.g. mean or median) as a function of 01 to determine the correct value
of oz. and hence the value of our estimate min tR,. The mean of tR,(tR(ot)) as
a function of 01 is deﬁned as

 

m

1 log(l +otE,(AB))
Zl—l

[Rm 2 Z log(l +otE,(A))

[’21
where m is the number of expression values (i.e. number of genes). The
median is analogously deﬁned. We decided to plot the mean and median
of tR, for a ﬁxed [7A across a range of values of 01. Example plots for two
different titration series [MDA23l/mouse lung at pA=0.5 and data from
MicroArray Quality Control (MAQC) project 2006 (GEO accession 5350)
at [7A 20.75] are shown in Figure 3. The value of 01 that provides the most
accurate estimate of [7A is marked by a vertical black line.

The value of 01 that provides the most accurate estimate of [7A. in these plots
and many others. is located at what one may refer to as the ‘knee’ or ‘elbow’
of the curve. This point may be familiar from principal components analysis
as the point on a scree plot that indicates the number of signiﬁcant principal
components (Jolliffe. 2002). To calculate this point. we need a mathematical
deﬁnition for the ‘elbow’ of a curve.

3.3 Minimum radius of curvature

We want to ﬁnd the value of 01 at the ‘elbow’ of the curve deﬁned by i
as a function of oz. The ‘elbow’ of a curve is the point at which the tradeoff
between pulling low values up and pulling high values down (values of R,(ot))
is optimal. Here. we formalize this by choosing that point at which the radius
of curvature is at its minimum. The radius of curvature p(s) is deﬁned as the
inverse of the vector norm of the second derivative of the curve. expressed
as a function of arc length s. i.e.

p(S)=1/l lC”(X(S))l l (1)

where C is the curve of interest originally pararneterized in terms of x
(Lipschutz, 1969). Thus. to ﬁnd the value of 01 of interest several steps are
required. First. we need to represent the function tR(Ol) as a curve in the
plane. Second. we must reparameterize this curve in terms of the arc length
s. Third. we use the repararneterized curve to determine the value of arc
length s" that minimizes the radius of curvature p(s). Finally. we determine
the value of 01 that corresponds to s".

 

3.3.1 Radius of curvature in terms of arc length Recall that a
pararneterized curve in the plane is of the form
X(€¥)=XI(€¥)€I+X2(€¥)€2, “GIG/wan] (2)

wherexl ,x2 are the coordinate functions. e, = (l , 0) and e; = (0, l) the natural
basis and 01 the parameter of the curve. To deﬁne the radius of curvature of
x(ot) at a point x. we ﬁrst reparameterize in terms of arc length s. The are

 

1045

112 /3.Io's[Bumo[pJOJXO'soneuiJOJutotqﬂ:duq wort pepeolumoq

9103 ‘{g isanV 110::

J. Clarke et al.

 

length parameterization is deﬁned to be the parameterization with unit speed

along the curve. This eliminates the possibility of an unnaturally high or low

radius of curvature simply due to the local speed of transversal of the curve.
The arc length s of a curve is deﬁned as

.v(a)=/a||dx/da||da (3)
do

where ||-|| is the Euclidean norm. Now consider a function f (01) and observe
that its graph (01,f(01)) is a geometric curve in the plane. Thus. as in Equation
(2). we can write

x(ot) = (01)e1 +f(ot)e2, 01 e [o/ , 01”].

Hence

dx/dot:l>I<e1+f’(ot)e2 and ||dx/dotll =,/ l+f’(ot)2.

So the arc length parameter [Equation (3)] is given in terms of 01 by

.v(a)=/a,/ l+f’(ot)2dot, ae[o/,ot”].
do

Since the parameterization is in terms of unit speed. it is invertible. so
we can write (1:010) as well. Thus. s’ =s(ot’) and s” =s(ot”). The radius
of curvature of a geometric curve C as stated in Equation (1) can now be
deﬁned as

pro = 1/ l erars>>>l l

for the curve C =(Ol, tR(ot)). We will argue that choosing 01 to minimize p(s)
leads to a good estimate of [7A over [01’ ,ot”].

3.3.2 Implementation Given the deﬁnitions in the last subsection. it
remains to obtain the arc length parameterization for the curve (ot,tR(ot))
and ﬁnd the value of 01 that corresponds to s“. Replacing f (01) with m we
have the following:

Partition the interval [01’ ,ot”] uniformly by setting

 

 

01’:ch <01] <  <01k=o1H and 01,—ot,_1 2

Then.
a, f _/
s(ot,)=/ ./ l +f’(ot)2a'01= 2‘1 1 +tR(o1,)2 >I< l/(ot, —Ol,_1)
“0 i2]

—/
where we approximate tR(ot,) as

 

tR or —tR 01;
[Raga/Z ( l) ( l I).
at —%*-1
This will yield a one-to-one relationship between 01 and s. hence a one-
to-one relationship between X and tR(Ol). Once we have this we can ﬁnd the
value of s that minimizes the radius of curvature p((¥(S)), i.e. maximizes

l lf”(x(ot(s)))l 1 over X e [.v’, s”].

3.3.3 Determining s" ana1 01 To ﬁnd the maximum of

lV”(x(a(s>>>l l = ,/ (erami’V = ltR(oz(s))Hl

we ﬁnd the value of s. s“. which maximizes the absolute value of the second
derivative with respect to s using centered difference approximations (Ames.
1977). Approximate tR(Ol(Sk))H by

1R(‘¥(Sk+l)) — zerarsk» + mom I Ms. —sk_1>2.

 

 

Using this approximation. we calculate tR(Ol(.Y))H over a range of values
[s’ ,s”] and determine the value s" that minimizes tR(ot(s))H.

Note that this method for ﬁnding s" (and subsequently 01) only works if
the two axes of the plot for  are similarly scaled. If the two scales are not
equal. they must be equalized prior to calculating s" by rescaling one axis to

be the same length as the other. For example. to rescale the axis for m we
would use values of the following in place of W

(max(ot) — min(ot)) >l< (m — mm?»
max(m) — mimm)

That is. the range of the function W is the same as the range of the
parameter at. This ‘scaling’. like the arc length parameterization. seems
necessary to prevent arbitrary choices from dominating the solution.

One key task is choosing k large enough so that the approximation of
the second derivative with respect to second differences is accurate over
the range [010,011]. We found that k of several thousand worked well in the
examples in Section 4.

3.4 Bootstrap estimates of standard error

We used a simple bootstrap resampling procedure (Efron. 1979) to generate
standard errors for our estimate of [7A. For a given dataset of n observations
and in genes. we draw T bootstrap samples; each sample contains expression
values of m’ genes drawn at random with replacement where m’ @0.6>I<m
(so a total of nm’ values). From each sample j, j = l, . . .,T. we calculate the
mean of tR,(tR(ot)) across values of 01 in a given range. We then determine
the value of 01 that corresponds to the minimum radius of curvature (s*) of
tR(Ol), plotted as a function of 01 (as described in Section 3.3). This value of 01
is used to generate tR, for the genes in sample j and determine its minimum.
i.e. our estimate of [7A. The result of our bootstrap procedure is T estimates of
[7A. {13A1,...,[3A}. one for each sample. The SD of these estimates is taken as
the standard error of our estimate of [7A. and a (l — r) conﬁdence interval for
our estimate is calculated as [[3A(,/2) ,ﬁA(1_(,/2))] where [Aug/2) and ﬁA(1_(,/2))
are the (r/2)th and (l —(r/2))th percentiles of our 100 estimates of [7A.
Stated as psuedo-code for clarity. our procedure is as follows:

 

 

(1) Generate T bootstrap samples where each sample contains nm’
expression values. i.e. expression values for m’ genes from each
sample. The m’ genes. m’ %O.6>I<m. are selected at random and with
replacement.

(2) For each sample. calculate the values of tR,. i: l, . . . ,m’. for a range
of values of oz.

(3) For each sample. calculate the values on the curve (on?) for a range
of values of 01. using the result of step 2.

(4) For each sample. use the curve calculated in Step 3 to determine the
value of 01 that corresponds to the minimum radius of curvature s"
(as described in Section 3.3). Label this value as 01, for each sample
j,j=1,...,T.

(5) For each sample j, use the values of tR, that correspond to 01, (as
calculated in Step 2) and determine its minimum. i.e. our estimate of
[7A. This yields {ﬁA,1,...,ﬁA,T}.

(6) Calculate the standard error of our estimate (as the SD
of {13A,1,...,[3A,T}) and a (l —r) conﬁdence interval (as
[13A(r/2)~I3A(I—(r/2))l Where [3A(I/2) and [Aug—(#2)) are the (T/2)th
and (l —(r/2))th percentiles of our 100 estimates opr).

As a sort of stability analysis. we chose a range of values for T in
our computations below to see whether there was any obvious relationship
between the size of T and the likelihood that a bootstrapped conﬁdence
interval contained the true value. The results in Table 2 suggest that the size
of T and the accuracy of the bootstrap intervals is slight at most.

4 RESULTS

We implemented our procedure for estimating pA in several gene
expression datasets, both proprietary and public, in which expression
data was generated from samples composed of two tissue/cell types.
Some of the samples consist of different cell types from the same

 

1046

112 /3.Io's[Bumo[pJOJXO'soneuiJOJutotqﬂ:duq wort pepeolumoq

9103 ‘{g isanV 110::

Statistical expression deconvolution

 

Table 1. Available datasets

 

 

Source Type Platform Proportion n Norm GEO
MDA231 None
UMiami Mouse lung ILM 0:100:25 3 cubic
qspline
MCF7 None
UMiami Mouse lung ILM 0:100:25 1 quantile
qspline
MAQC Site 3 gr human ILM 100/75/25/0 5 Cubic GSE5350
MAQC Site 1 gr human AFFX 100/75/25/0 5 MASS GSE5350
BIIB 500 MW” T 96115 AFFX 0:100:20 3 MASS GSE5130
Mouse B cells
BIIB 100 MW” T Cans AFFX 0:100:20 1 MASS GSE5130

Mouse B cells

 

Source, data source; type, tissue/cell types; platform, expression platform; proportion,
pA; 11: number of samples at each proportion; Norm, normalization; GEO, GEO
accession number. See text for further details.

organism, while other samples are a mix of cell types from different
organisms. The proportion of each component type is known, as the
data come from titration series; we use these values to assess the
accuracy of our estimates.

4.1 Data

Our data consists of six datasets obtained either from the University
of Miami School of Medicine (UMiami) or the NCBI GEO (Barrett
et (11., 2006). The UMiami datasets were created as a titration
series of RNA from breast cancer cells (either MDA231 or MCF7)
and normal mouse lung cells. The expression platform is Illumina
Human WG-6 version 2 (MCF7) or version 3 (MDA231) (Illumina
Inc., 2009); chips were processed at two different laboratories.
The data from GEO includes titration series of Universal Human
Reference RNA and Human Brain RNA from the MAQC study
(MAQC Consortium, 2006). We selected data processed at two
different laboratories and on two different platforms, either Human-
6 BeadChip 48K version 1 (Illumina Inc., 2009) or HG-Ul33 Plus
2.0 GeneChip (Affymetrix Inc., 2009). Two other datasets from GEO
were also included in our studies; these data include two titration
series of mouse T and B cells (Shearstone et (11., 2006). These sets
were processed on the Mouse 430A version 2 GeneChip platform
(Affymetrix Inc., 2009). The details of each dataset are presented in
Table l.

The method of normalization of gene expression data can
impact substantially which probes are identiﬁed as detected and
which probes are identiﬁed as differentially expressed between
conditions (Dunning et (11., 2008b; Johnstone et (11., 2008). For
this reason, we implemented several normalization methods on
our proprietary datasets, while using the available normalized data
for the publicly available datasets. The normalization methods
for the Illumina data include quantile normalization and qspline
normalization as implemented in the R package beadarray (Dunning
et (11., 2008a; R Development Core Team, 2009) and cubic
normalization as implemented in the Illumina BeadStudio software
(Illumina Inc., 2009). After normalization, only those genes with
a detection P-value <0.01 in all samples (Illumina Inc., 2009)
or considered present in all samples according to the Affymetrix
MAS5 algorithm (Affymetrix Inc., 2009) were included in further

(a) (b)
MDA231 0.75 I MCF7 0.75 I
MDA231 0.50 I MCF7 0.50 l
MDA231 0.25 l MCF7 0.25 l

 

nus Ins ass as us uss us Ins nus nus nus DIS I125 us an; ass ass D75 use us

Estimate 0' P Estimate of p

(c) (d)

MAQC 0.75 I MAQC 0.75 I
MAQC 0.25 I MAQC 0.25 I
I—v—v—v—I—I—I—I—I—I I—I—v—I—v—I—I—I—I—I
ms ms us use us as ass I175 nus us one M5 025 us us as ms 075 us use
Estimate of 9 Estimate of p
(e) (f)
BIIB 0.80 I BIIB 0.80 I
BIIB 0.60 I BIIB 0.60 I
EIIB 0.40 I BIIB 0.40 I
EIIB 0.20 I BIIB 0.20 I
I—l—l—l—l—l—l—l—I I—l—l—l—l—l—l—l—I
or n: u: no as us 0.7 an as m n: as nA as as a: u 0.5
Estimate of P Estimate at P

Fig. 4. Bootstrap estimates of [7A with 90% conﬁdence intervals. Boxes
indicate the point estimates of pA; light grey vertical lines indicate the true
values of [7A. (a) MDA231 qspline-normalized data; (b) MCF7 quantile-
normalized data; (c) MAQC ILM cubic spline-normalized data; (d) MAQC
Affymetrix MAS5 data; (e) BIIB 500 Affymetrix MAS5 data; and (f) BIIB
100 Affymetrix MAS5 data.

analyses (i.e. bootstrap estimation of pA by the procedure described
in Section 3.4).

4.2 Accuracy of estimation

Select results of our bootstrap estimation procedure for each dataset
are shown in Figure 4. For the UMiami datasets, we chose to display
results for only one normalization method for brevity.

In ~90% of cases, our point estimate is within 5% of the true
proportion; in ~80% of cases, the 90% bootstrap conﬁdence interval
for our estimate contains the true value of pA. We note that our
method found the BIIB 100 dataset to be the most challenging. This
is no surprise as this titration series was designed with very low
levels of mRNA, as a challenge to the procedure used for RNA
ampliﬁcation prior to running the expression assay (Shearstone et (11.,
2006). In other words, this data was generated from a very small
amount of biological material so the estimation of the proportion of
the biological components is very challenging.

There is evidence in Figure 4 of an interaction between the
normalization procedure and the accuracy of our estimation method.
For example, we tend to overestimate pA when the data is qspline
normalized, as with the UMiami MDA231 data, but we tend to
underestimate pA when the data is quantile normalized. We note that
this relationship could also be a consequence of other experimental
variables, such as the expression platform or the speciﬁc laboratory
in which the data were generated. Further, datasets and analysis are
required to determine which factors (e.g. normalization, platform
and laboratory) have signiﬁcant effects on the accuracy of our
procedure.

In addition, the stated conﬁdence level of the conﬁdence intervals
(90%) is predicated on the validity of the underlying model (Leeb,
2009; Shen et (11., 2004). Because our underlying model has some
level of uncertainty, the stated level of conﬁdence is an overestimate
of the actual level of conﬁdence. In other words, model uncertainty

 

1047

112 /3.IO'S[BIIanprOJXO'SOIJBLUJOJIIIOIq”K1111] 111011 pepeo1umoq

9103 ‘1g1sn8nv 110::

J. Clarke et al.

 

Table 2. Bootstrap estimates of [7A

 

Source Norm nb Prop Est SE 90% CI

 

39 0.75 0.788 0.023 (0.746. 0.819)

UM-MDA231 Qspline 37 0.50 0.529 0.065 (0.396. 0.604)
10 0.25 0.304 0.108 (0.180. 0.437)

0.75 0.722 0.086 (0.596. 0.863)

UM-MCF7 Quantile 100 0.50 0.448 0.057 (0.375. 0.553)
0.25 0.286 0.031 (0.265, 0.336)

40 0.75 0.776 0.041 (0.710. 0.842)
55 0.25 0.303 0.021 (0.275, 0.335)
14 0.75 0.763 0.040 (0.688. 0.805)
68 0.25 0.270 0.027 (0.232. 0.317)
0.80 0.761 0.031 (0.697. 0.800)
0.60 0.576 0.048 (0.508. 0.659)

MAQC-ILM Cubic

MAQC-AFFX MAS5

BIIBSOO MASS 100 0.40 0.493 0.053 (0.388. 0.567)
0.20 0.208 0.101 (0.092. 0.381)
0.80 0.752 0.021 (0.722, 0.789)
BIIB100 MAS 5 100 0.60 0.518 0.050 (0.437, 0.593)

0.40 0.4-43 0.050 (0.365. 0.527)
0.20 0.190 0.093 (0.067. 0.347)

 

Source, data source; Norm, normalization; nb, number of bootstrap samples; Prop, true
value of pA; Est, bootstrap point estimate, SE, bootstrap standard error; 90% CI , 90%
bootstrap conﬁdence interval. Bold values denotes cases where the true pA is not in the
interval.

tells us that a true 90% conﬁdence interval is larger than the stated
90% conﬁdence interval. In light of this the accuracy of our method
is most likely better than the results in Table 2 would suggest.

An accurate estimate of pA can be used to generate estimates of
expression speciﬁc to each tissue/cell type. Given expression from
a mixed sample AB and an estimate of pA we can estimate E (A) and
E (B) as

E/(K) =15}1E(AB) and E/(B)=(1—1§;1)E(AB).

As we observe E (A), we can compare E/(A) with the observed E/(A)
to assess the quality of our estimate. Whether the error in using E (A)
as an estimate of E (A) can be used to improve our estimate of pA is
a topic for ﬁiture research.

5 DISCUSSION AND CONCLUSIONS

We have demonstrated a statistical method for estimating the
proportions of each sample (Samples A and B) in a two-sample
mixture (AB). This method requires expression data generated
from the mixed sample AB and expression data generated from a
puriﬁed sample of one type A. Given this information, the method
approximates the proportion pA as the minimum of the ratios of
expression in the mixed and puriﬁed samples, where the minimum
is taken over genes. For this estimate to be accurate, it is required
that the data be transformed; the value of the parameter of the
transformation is determined by a geometric argument involving
the minimum radius of curvature of a function, parameterized as
a curve in the plane. Our results show that our method provides a
reasonably accurate estimate of pA on both proprietary and publicly
available datasets.

As demonstrated in Cleator et (11. (2006) a large value of pA (say,
over 0.5) can have a substantial effect on the results of tests for
differential expression and confound tumor classiﬁcation. However,

whether a large pA should be cause for concern depends on the
speciﬁc study. We would argue that pA should be assessed in all
samples, but the action of the investigator in response to a large
value of pA may vary from no action to discarding the sample from
further consideration. In the case where pA is )vgry large, our method
will still give a reasonable estimate of E (B)(E (B)) but the variability
in this estimate could be large. Whether a large pA necessitatgs\ a
renormalization of the data is unknown; we conjecture that if E (A)
and E(A) are comparable then renormalization is unnecessary.

The results presented are preliminary and as such further research
is required to optimize and validate our method. Our bootstrap point
estimates and conﬁdence intervals could be substantially improved
by increasing the number of bootstrap samples T and running
diagnostics to ensure that the number of samples and size of samples
are adequate for generating valid bootstrap quantities of interest
(Canty et (11., 2002). In addition, we would like to explore the
relationship between the method of normalization and our estimation
technique. By altering the noise distribution, normalization alters
the relationship between the noise and the values of R,, thereby
inﬂuencing the accuracy of minR, as an estimate of pA . The extent of
this inﬂuence is unknown, but further research may help determine
which normalization method yields the most accurate estimate of pA .
Finally, the calculation of the radius of curvature depends on the
estimation of the second derivative of the curve; we approximate
the second derivative by the second difference equation [Equation
(4)]. This approximation is accurate if the curve is smooth and is
well sampled, i.e. the distance between sk and sk+1 is small. Using a
well-sampled curve in our method can be computationally expensive
if the range of value of 01 (i.e. values of s) is large. We would like to
design a variation of our method which starts with a sparsely sampled
curve over a large range of values of 01 and iteratively narrows the
range of interest and increases the sampling density as information
about the probable location of s* is obtained. This should yield a
better estimate of pA at lower computational expense. We hope to
implement this variation and provide our approach to the statistics
community as an R package (R Development Core Team, 2009).

Our deﬁnition of the ‘elbow’ of a curve as the point of minimum
radius of curvature is applicable to other problems in statistics, such
as the choice of the number of principal components in a principal
components analysis (Jolliffe, 2002). One existing way to make
this choice is to identify the ‘elbow’ of the curve from a scree plot
and choose the number of components closest to the ‘elbow’. Our
procedure for ﬁnding the minimum radius of curvature, coupled with
a curve-ﬁtting method, may be directly applicable to this problem.
This would provide a formalization, in the spirit of Zhu and Ghodsi
(2006), of what is currently an ad hoc approach.

ACKNOWLEDGEMENTS

We would like to thank the Center for Computational Science and
the lab of Marc E. Lippman, MD, for their suggestions and input.

Funding: National Cancer Institute of the National Institutes of
Health (K25 CA111636 to J.C.).

Conﬂict of Interest: none declared.

REFERENCES

Affymetrix Inc. (2009) Aﬁfymetrix Expression Console Software Version 1.0 7 User
Guide. Santa Clara, CA.

 

1048

112 /3.IO'S[BIIanprOJXO'SOIJBLUJOJIIIOIq”K1111] 111011 pepeo1umoq

9103 ‘1g1sn8nv 110::

Statistical expression deconvolution

 

Ames,W. (1977) Numerical Methods for Partial Diﬂerential Equations. Academic
Press, New York.

Barrett,T. et al. (2006) NCBI GEO: mining tens of millions of expression proﬁlesi
database and tools. Nucleic Acids Res, 35, D76WD765.

Canty,A. et al. (2002) Bootstrap diagnostics and remedies. Can. J. Stat, 34, 5727.

Causton,I-I. et al. (2003) Microarray gene expression data analysis: A beginner’s guide.
Blackwell Science, Malden, MA.

Cleator,S. et al. (2006) The effect of the stromal component of breast tumours on
prediction of clinical outcome using gene expression microarray analysis. Breast
Cancer Res, 8, R32.

Dunning,M. et al. (2008a) beadarray: R classes and methods for illumina bead-based
data. Bioinformatics, 23, 218372184.

Dunning,M. et al. (2008b) Statistical issues in the analysis of illumina data. BMC
Bioinformatics, 9, 85.

Efron,B. (1979) Bootstrap methods: Another look at the jackknife. Ann. Stat, 7,
1726.

Fend,F. and Raffeld,M (2000) Laser capture microdissection in pathology. J. Clin.
Pat/101., 53, 6667672.

Ghosh,D. (2004) Mixture models for assessing differential expression in complex
tissues using microarray data. Bioinformatics, 20, 166371669.

Gosink,M. et al. (2007) Electronically subtracting expression patterns from a mixed
cell population. Bioinformatics, 23, 332873334.

Illumina Inc. (2009) BeadStudio Gene Expression Module v3.4 User Guide (11317265
Rev A). San Diego, CA.

Johnstone,D. et al. (2008) Effects of different normalisation and analysis procedures on
illumina gene expression microarray data. In Proceedings of the 19th International
Conference on Genome Informatics (GIW 2008), Poster.

Jolliffe,I. (2002) Principal components analysis, 2nd edn. Springer, Berlin.

Koltai,H. and Weingarten-Baror,C. (2008) Speciﬁcity of DNA microarray
hybridization: characterization, effectors, and approaches for data correction.
Nucleic Acids Res, 36, 239572405.

Lahdesmaki,H. et al. (2005) In silico microdissection of microarray data from
heterogeneous cell populations. BMC Bioinformatics, 6, 54.

Leeb,H. (2009) Conditional predictive inference post model selection. Ann. Stat, 37,
283872876.

Lipschutz,M. (1969) Schaum 's outline of theory and problems of diﬂerential geometry.
McGraw Hill, New York.

Lu,P. et al. (2003) Expression deconvolution: A reinterpretation of DNA microarray
data reveals dynamic changes in cell populations. Pmc. Nat Acad. Sci. USA, 100,
1037010375.

MAQC Consortium (2006) The microarray quality control (MAQC) project shows
inter- and intraplatform reproducibility of gene expression measurements. Nat
Biotechnol, 24, 115171161.

Michiels,S. et al. (2005) Prediction of cancer outcome with microarrays: a multiple
random validation strategy. Lancet, 365, 488492.

Pittman,J. et al. (2004) Clinico-genomic models for personalized prediction of disease
outcomes. Proc. Nat Acad. Sci. USA, 101, 843178436.

R Development Core Team (2009) R: A language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria. ISBN
3-900051-07-0.

Shearstone,J. et al. (2006) Accurate and precise transcriptional proﬁles from 50 pg of
total RNA or 100 ﬂow-sorted primary lymphocytes. Genomics, 88, 1117121.

Shen,X. etal. (2004) Inference after model selection. J. Am. Stat. Assoc, 99, 7517761.

Stuart,R. et al. (2004) In silico dissection of cell-type-associated patterns of gene
expression in prostate cancer. Proc. Nat Acad. Sci. USA, 101, 6157620.

van’t Veer,L. et al. (2002) Gene expression proﬁling predicts clinical outcome of breast
cancer. Nature, 415, 5307536.

Venet,D. et al. (2001) Separation of samples into their constituents using gene
expression data. Bioinformatics, 17, S2797S287.

Wang,M. et al. (2006) Computational expresssion deconvolution in a complex
mammalian organ. BMC Bioinformatics, 7, 328.

Wheelan,S. et al. (2008) The incredible shrinking world of DNA microarrays. Moi.
Biosyst, 4, 7267732.

Zhu,M. and Ghosdi,A. (2006) Automatic dimensionality selection from the scree plot
via the use of proﬁle likelihood. Comput. Stat. Data Anal, 51, 9187930.

 

112 /31o's1eu1no[p101x0's011ei11101utotqp:duq 111011 pepeo1umoq

9103 ‘1g1sn8nv 110::

