BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

M.N.McCalI et al.

 

Exon 96611882 (LAPTM5) Exon 96615750 (KCNA3)

 

2

Gene—Level Residuals
(IOQZ intensity)
0

—e —4 —2

 

 

(I092 Intensrly)

—a —4 —2 o

Exon—Level Residuals

— Probe!  PIobeS
-- Probez -—- ProbeA
IvaIIIIIIvaIIIIIiiIIvIIvIIvIIiIIiIIiIIvI

 

 

 

 

Arrays Grouped by Batch Arrays Grouped by Batch

Fig. 1. Residuals for probes targeting one of two exons are shown after
ﬁtting a standard RMA model to 100 arrays from 20 different batches
(unique experiment/tissue combinations) at both gene (upper panels) and
exon levels (lower panels). For both exons, Probe 1 (solid black line)
appears to have a strong batch effect (high between-batch residual vari-
ance) when assessing probes at the gene level. However, in the case of
Exon 96615750, the other three probes targeting this exon have nearly
the same pattern of residuals across batches. This suggests that the high
residual variance may be due to alternative splicing rather than a batch
effect. By assessing probes at the exon level (lower panels), one still ob-
serves the high between-batch residual variance seen for Probe 1 targeting
Exon 96 611 882 (left), but not for the probes targeting Exon 96 615 750
(right). By evaluating probe behavior at the exon level, we are able to
distinguish between batch effects and splice variants

outliers and probes that show a consistent susceptibility to batch
effects. These batchy probes are downweighted during summar—
ization to minimize their effect on expression estimates. HuEx
and HuGene arrays add an additional layer of complexityi
when summarizing at the gene level, a probe may show high
between—batch residual variance due to either batch effects or
alternative splicing (Fig. 1). The former should be down—
weighted, whereas the later may contain highly interesting bio—
logical information that could be captured by subsequent
analysis of residuals, such as those proposed in Robinson and
Speed (2009). For this reason, even when summarizing to the
gene level, we weight probes based on their exon—level
between—batch residual variance. Unfortunately, this is only feas—
ible for exons targeted by multiple probes. For single—probe
exons, it is impossible to assess residual variance at the exon
level and, therefore, impossible to distinguish between batch ef—
fects and splice variants. For these probes, one must rely on
robust summarization methods and post—preprocessing
batch—effect correction algorithms such as ComBat (Johnson
et al., 2007) or Surrogate Variable Analysis (Leek and Storey,
2007).

The two versions of the fRMA algorithm described earlier are
implemented in the frma package and take advantage of the raw
data structures implemented in the oligo package (Carvalho and

Irizarry, 2010), allowing greater control over the level of sum—
marization. Speciﬁcally, this is handled by the target argument
passed to the frma function. The frozen parameter vectors for
HuEx and HuGene arrays were created using 240 arrays from
48 batches and 1005 arrays from 201 batches, respectively.
Here, a batch is defined as a unique tissue type/experiment
combination. The frozen parameter vectors are stored in the
huex.1.0.st.v2frmavecs and hugene.1.0.st.v1frmavecs annotation
packages.

The frmaTools package (McCall and Irizarry, 2011), which
allows users to create their own frozen parameter vectors, has
also been updated to work with oligo GeneFeatureSet and
ExonFeatureSet objects. This allows users to create custom vec—
tors for the HuEx and HuGene platforms and to implement
fRMA on other Affymetrix Exon and Gene ST platforms that
are not currently supported.

ACKNOWLEDGEMENTS

The authors thank the maintainers of GEO and ArrayExpress
for making the data publicly available, Marvin Newhouse and
Jiong Yang for helping manage the data and the members of
the La Calestienne Meeting, especially Hinrich Gohlmann and
Willem Talloen, for their helpful discussions.

Funding: This work was funded by National Institutes of
Health (CA009363 to M.N.M.), National Institutes of Health
(GM083084, RR021967 and GM103552 to H.A.J.) and partially
funded by National Institutes of Health (GM083084, RR021967
and ULlRR025005 to R.A.I.).

Conﬂict of Interest: none declared.

REFERENCES

Carvalho,B. and Irizarry,R. (2010) A framework for oligonucleotide microarray
preprocessing. Bioinformutim‘, 26, 236372367.

Hochreiter,S. et a]. (2006) A new summarization method for affymetrix probe level
data. Bioinformuticx, 22, 9437949.

Irizarry,R. et a]. (2003) Exploration, normalization, and summaries of high density
oligonucleotide array probe level data. Biostutixtim‘, 4, 2497264.

Johnson,W. et a]. (2007) Adjusting batch effects in microarray expression data using
empirical Bayes methods. Biostutixtics, 8, 1187127.

Leek,J. and Storey,J. (2007) Capturing heterogeneity in gene expression studies
by surrogate variable analysis. PLoS Genet., 3, e161.

Li,C. and Wong,W. (2001) Model—based analysis of oligonucleotide arrays: expres—
sion index computation and outlier detection. Proc. Natl Aeud. Sci. USA, 98,
31736.

McCall,M. and Irizarry,R. (2011) Thawing frozen robust multi—array analysis
(fRMA). BM C Bioiry’ormutics, 12, 369.

McCall,M. et a]. (2010) Frozen robust multiarray analysis (fRMA). Biostutixtim‘, 11,
2427253.

Modrek,B. et a]. (2002) A genomic view of alternative splicing. Nat. Genet., 30,
13719.

Ramasamy,A. et a]. (2008) Key issues in conducting a meta—analysis of gene expres—
sion microarray datasets. PLoS Med., 5, e184.

Robinson,M. and Speed,T. (2009) Differential splicing using whole—transcript
microarrays. BMC Bioinfommtim‘, 10, 156.

 

3154

ﬁm'spzumol‘pmyo'sopeuuopuorq/ﬁdnq

