ORIGINAL PAPER

Vol. 28 no. 14 2012, pages 1911-1918
doi:10. 1 093/bioinformatics/bts285

 

Data and text mining

Advance Access publication May 10, 2012

iFad: an integrative factor analysis model for drug-pathway

association inference’r
Haisu Ma1 and Hongyu Zha02’*

1Program in Computational Biology and Bioinformatios, Yale University, New Haven, CT 0651 1 and 2Division of
Biostatistios, Yale School of Public Health, New Haven, CT 06520, USA

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: Pathway-based drug discovery considers the
therapeutic effects of compounds in the global physiological
environment. This approach has been gaining popularity in recent
years because the target pathways and mechanism of action for
many compounds are still unknown, and there are also some
unexpected off-target effects. Therefore, the inference of drug-
pathway associations is a crucial step to fully realize the potential of
system-based pharmacological research. Transcriptome data offer
valuable information on drug-pathway targets because the pathway
activities may be reflected through gene expression levels. Hence,
it is of great interest to jointly analyze the drug sensitivity and gene
expression data from the same set of samples to investigate the
gene-pathway—drug-pathway associations.

Results: We have developed iFad, a Bayesian sparse factor
analysis model to jointly analyze the paired gene expression and
drug sensitivity datasets measured across the same panel of
samples. The model enables direct incorporation of prior knowledge
regarding gene-pathway and/or drug-pathway associations to aid the
discovery of new association relationships. We use a collapsed Gibbs
sampling algorithm for inference. Satisfactory performance of the
proposed model was found for both simulated datasets and real data
collected on the NCl-60 cell lines. Our results suggest that iFad is a
promising approach for the identification of drug targets. This model
also provides a general statistical framework for pathway-based
integrative analysis of other types of -omics data.

Availability: The R package ‘iFad’ and real NCl-60 dataset used are
available at http://bioinformatics.med.yale.edu/group/.

Contact: hongyu.zhao@yale.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on February 15, 2012; revised on April 6, 2012; accepted
on May 5, 2012

1 INTRODUCTION

Identiﬁcation of drug targets, the gene products that bind to speciﬁc
therapeutic molecules, is essential for understanding drugs’ action
mechanism and possible side effects, and for maximizing treatment
efﬁcacy and minimizing drug toxicity. Traditional pharmaceutical
research and development process is deeply rooted in the ‘one

 

*To whom correspondence should be addressed.
lThe analysis in this article was performed in ‘Yale University Biomedical
High Performance Computing Center”.

target-one drug’ mindset, which tries to interfere the pathological
process through blocking an important molecular player (e.g. a
speciﬁc enzyme) using a compound. Unfortunately, most drug
candidates identiﬁed through high-throughput screening based on
this philosophy have failed due to either poor efﬁcacy or serious
side effects (Schadt et al., 2009).

High hope has been placed on using systems biology for drug
discovery through the application of novel computational methods
to high-throughput genomics and proteomics data. In contrast
to the traditional ‘one target-one drug’ perspective that ignores
the intricate interaction among genes/proteins, systems biology
approaches consider the drug effects in the global physiological
environment. They may be more effective in drug discoveries
because it has become apparent that most common diseases result
from system-level malfunctions rather than problems with individual
genes (Pujol et (11., 2010). In practice, drug combination or poly-
pharmacy is more commonly used in recent years to modulate
multiple drug targets.

Existing computational methods for drug-target identiﬁcation
can be generally categorized into three classes. The ﬁrst class of
methods uses the classical gene expression proﬁling strategies to
infer drug targets. For example, drug targets can be identiﬁed by
comparing the mRNA responses in human cell lines induced by
drugs with unknown mechanisms with a set of well understood
drugs. The connectivity map project (Lamb et al., 2006) used
a non-parametric rank-based pattern matching strategy based on
the Kolmogorov—Smirnov statistic, which requires extensive data
mining procedures. Another study (Kutalik et al., 2008) proposed a
bi-clustering method, named iterative signature algorithm (ISA), to
search for ‘co-modules’ representing gene—drug associations.

The second class of methods aims to integrate various types
of biological data, including knowledge about bioactive molecules
and their protein targets (e.g. sequences, structures and molecular
mechanisms) along with the phenotypic effects of drug treatment,
to deduce the probability of two proteins being bound by the same
ligand (Czodrowski et al., 2009; Ecker et al., 2008; Nigsch et al.,
2009). Drug docking studies have also been incorporated to measure
the binding probabilities based on 3D structural complementarities
(Boyce et al., 2009; Irwin et (11., 2009; Kolb et al., 2009; Zavodszky
and Kuhn, 2005). One disadvantage of these methods is that they
only evaluate the likelihood of presumed drug-target pairs and make
no inference of unknown drug targets. Campillos et al. (2008)
proposed a probabilistic network to calculate the probability of
two drugs sharing the same target by comparing their clinical side
effects. However, this method provides limited information on the
drug action mechanisms.

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1911

112 /3.Io's[BumoprOJXO'sotwuiJOJutotq”:duq 11101} pQPBOIHMOG

9103 ‘Og anﬁnv uo ::

Ma and Zhao

 

The third class of methods analyzes the global patterns of
drug—protein interactions (Kuhn et (11., 2008; Yeh et (11., 2006;
Yildirim et (11 ., 2007). It is known that established gene—drug binary
associations form a dense network that exhibits local clustering of
similar drug types. Such networks can enhance our understanding of
the physiological effects of various drugs in terms of the molecular
pathways and disease categories involved. However, these ‘guilt-
by-association’ methods are too coarse-grained to make quantitative
inference about the effect of drugs at the system level.

In this article, we develop a coherent statistical framework to
jointly analyze drug sensitivity and gene expression patterns from
the same set of cell lines to infer the target pathways of drugs. Much
information on these two types of data has been accumulated in the
literature (Bussey et (11., 2006; Ikediobi et (11., 2006; Shankavaram
et (11., 2007; Sharma et (11., 2010; Shoemaker, 2006), and if
appropriately analyzed, these data may be informative for inferring
drug targets. We adopt a latent factor analysis approach, where each
latent factor corresponds to the activity of a speciﬁc pathway. Note
that factor analysis models have been proposed for the reconstruction
of gene regulatory networks and the inference of transcription factor
activity proﬁles (Gharib et (11., 2006; Meng et (11., 2011; Yeh et (11.,
2009; Yu and Li, 2005). A previous review article (Poumara and
Wemisch, 2007) compared the performance of ﬁve different factor
analysis algorithms. However, these models were developed for
the analysis of a single data type, i.e. gene expression data. In
contrast, our proposed Bayesian sparse factor analysis model, iFad
(integrative factor analysis for drug-pathway association inference),
is the ﬁrst effort to bring together two distinct data types in a
uniﬁed framework to identify drug-target pathways. We propose
and implement a modiﬁed collapsed Gibbs sampling algorithm for
model inference. Our approach can also easily incorporate known
pathway information to infer the ‘many-to-many’ correspondence
between the two types of data. Some unique features of our model
are (1) joint analysis of distinct data types; (2) a Bayesian framework
to integrate prior pathway knowledge and (3) explicit consideration
of the sparse nature of the drug-target pathways. Both simulation
studies and applications to real NCI-60 datasets show that iFad is a
promising approach for drug-target inference.

The rest of the article is organized as follows. We detail
the modeling assumptions and statistical inferential procedure in
Section 2. Simulations and real data analysis are described in
Section 3. We conclude the article in Section 4.

2 METHODS
2.1 Model description

This section describes the statistical framework of our proposed Bayesian
sparse factor analysis model. iFad and statistical inference of the model
parameters. As discussed above. iFad aims to analyze paired gene expression
data and drug sensitivity data generated from the same set of samples. We
denote the gene expression dataset by matrix Y1. with dimension G1 by J .
where G1 is the number of genes and J is the sample size. The drug sensitivity
dataset is denoted by matrix Y2. with dimension G2 by J . where G2 is the
number of drugs. Drug sensitivity is usually quantiﬁed as the ‘G150’ values.
concentrations required to inhibit growth by 50% (Staunton at (11.. 2001).
Matrices Y1 and Y; are normalized (scaled to mean 0 and SD 1 for each
gene/drug) before analysis.

iFad links the two matrices through the activity levels of K biological
pathways (e.g. KEGG pathways). which are latent factors in our model.

The rationale here is that pathway activities inﬂuence both gene expression
levels and the sensitivity to drugs targeting these in these pathways. We
assume that there is some prior knowledge about the gene-pathway and
drug-pathway association relationships. represented by two binary matrices
L1 and L2. with dimensions G] by K and G2 by K. respectively. where
L1[g. k] = 1 (or L2[g. k] = 1) indicates that the gth gene (or drug) is known
to be associated with the kth pathway. This information can be retrieved
from various pathway databases with different degrees of sensitivity and
speciﬁcity (Bader at (11.. 2006; Kanehisa et (11.. 2010). iFad assumes that both
matrices Y1 and Y; are related to the common underlying pathway activity
matrix X (with dimension K by J) through the following linear models:

Y1=W1X+21,21~N(0,\Ill),\111=diag{r£;1}.
Y2=W2X+22,22~N(0,\112),\112=diag{r321 }.
XkJ-~Normal(0,l),

rgl ~Garnma(oz1,ﬁ1),g1 =1,2,...,G1,

‘L'g2 ~Garnma(a2,ﬁ2),g2=1,2,...,G2.

Matrices W1 and W2 are the factor loading matrices describing the
regulatory direction (positive or negative) and strength of the pathway
activities on the gene expression levels Y1 and drug sensitivity Y2. The latent
factor activity matrix X is shared between the two feature spaces. namely
gene expression data and drug sensitivity data. Each entry in matrix X is
assumed to follow a standard normal distribution. 21 and 22 represent the
noise term added to gene expression or drug sensitivity. with mean 0 and
diagonal covariance matrices \Ill and \112. The precision 1'31 (for the glth
gene) and ‘L'g2 (for the gzth drug) are modeled using a Gamma prior with
shape parameters 011. 012 and rate parameters 131. 132.

In order to use the prior knowledge on the gene-pathway and drug-
pathway associations (matrices L1 and L2). we use the spike-and-slab mixture
prior (West. 2003) for the factor loading matrices W1 and W2. Although there
exist other forms of sparsity-inducing priors (Pournara and Wernisch. 2007).
the spike-and-slab prior has the advantage of easy incorporation of prior
information on the connectivity structure of the loading matrix. For both W1
and W2. we put the following prior on each entry:

P(Wg,k> = (1 — ug,k>60(Wg,k>+ng,kNorma1(Wg,k l0, r19)
rw ~ Gammamw w 13w).

where (30 is the unit point mass at zero (the Dirac delta function) and 713k
denotes the prior probability that WgJC is non-zero. If WgJC is non-zero. it is
assumed to follow a normal distribution with mean 0 and precision rw. The
precision rw can be either set to a constant or assumed to follow a Gamma
prior with parameter ((1.... 13w). Usually. an auxiliary indicator variable Zggk
is used to enable the calculation of posterior probabilities (as Z1. W1. 711, L1
and Z2. W2. 71;. L2 have very similar formats except the subscript. we just
listed the general formula here):

7707 if Lgk = 0

P(Zg’k=1)=ng’k={1—Tii if Lgkzl.

In this way. prior link matrices L1 and L; are used to induce the sparsity
structure of the factor loading matrices W1 and W; in a ﬂexible way. with
the strength of guidance tuned conveniently by user-speciﬁed parameters no
and in. Under this setting. we can derive the prior probability of different
components of the model. as well as the complete joint posterior probability
(see Supplementary Materials for details).

It is worth noting that during the simulation studies in Section 3.1.
both matrices Z1 and Z; are unknown and are the target of inference. In
contrast. for real data analysis (the NCI-6O dataset) in Section 3.2. since
prior information about gene-pathway association structure is available and
fairly accurate. the major interest lies in the inference of matrix Z2. the
drug-pathway association relationships.

2.2 Inference algorithm

There are many parameters to estimate for iFad. Gibbs sampling is a
widely used technique to approximate the joint distribution through re-
sampling. However. standard Gibbs sampler may have poor mixing due to

 

1912

112 /3.Io's[BumoprOJXO'soiwuiJOJuioiq”:duq 11101} papeolumoq

9103 ‘Og isnﬁnv uo ::

Wad

 

Table 1. Model parameter settings considered in the simulations

 

 

Setting 01g ﬁg 01w 13w
1 0.7 0.3 0.7 0.3
2 0.7 0.3 aw=1
3 1 0.1 0.7 0.3
4 1 0.1 aw=1
5 1 0.01 0.7 0.3
6 1 0.01 aw=1
7 1 0.005 0.7 0.3
8 1 0.005 aw=1

 

01g and 13g are the shape and rate parameters of the Gamma prior put on the precision
of the noise term for both matrices Y1 and Y2; aw and 13w are Gamma parameters for
the precision of the non-zero elements of the factor loading matrices W1 and W2.

dependence between matrices W and Z makes. Therefore. we used a modiﬁed
collapsed Gibbs sampling algorithm for model inference as outlined below.
Detailed derivations of the posterior conditional distributions are provided
in Supplementary Materials. At the end of each sampling iteration. we add
a local permutation step (Sharp et a1. 2010 to address the problem of label-
switching. which is also described in Supplementary Materials. We have
implemented the above algorithm as the R package ‘iFad’. which is publicly
available on CRAN.

 

Collapsed Gibbs Sampling Algorithm for iFad

 

Data Input: 4 matrices 1'1. 1'3. a1. 1r:
Parameters: 01.. 51. a1. 53. r” (or raw. 3., )
Inltlalizatlon: randomly generate the following data
ZI --Bcnioul1i(a.). Z2 ~Bernoulli(xr3): .\'-Nonna1(0.l}: W1.W_1_ set to 0.
Ti " [WWII-3:- G:)- r: “' “13011-092- 61)
r“.1 = 11,2: aw-jﬁ'“. (if r“r is not set to a constant but has to be sampled as well)
Sampling:
Ill each iteration
(I) Sample r“ ~ PU,”|2.11111“.ﬂux”b -- Pu": |22_Ft7_,.ah..,8h.)
{2} Update matrix 2.. W, and 2:. W2 separater as follows:
For g = l to G
For 1.- #1 to A”. sample ZN - PtZg , |1'..Tt'.Zg__“In.rrrrglki
Sample W5 -- Pm" '1'..\‘.Z:.rg.r')
{3) Update matrix X
For}: l [0.1. sample X) “- PUG | ti-Wi-n,-Yg-WG-r,,)
1.1) sampk rEl -- PU!“ il’l.H'...\').rg: -- P‘U‘,2 |Y2.H"2._\')
(5} A permutation step to deal with label—switching of the latent factors

3 RESULTS

We ﬁrst tested the performance of iFad using simulated datasets, and
then applied the method to real NCI-60 datasets to infer unknown
drug-pathway associations.

3.1 Simulation study

In order to assess the performance of our proposed model, we ﬁrst
simulated a series of datasets to investigate the effects of different
model parameter settings, as well as the various dataset properties,
including sample size and noise level, among other factors.

3.1.1 Data simulation for model parameter selection We tested
eight different settings for the Gamma density parameters related to
the precision of the gene/drug noise term (1'81, 1:82) and the factor
loading matrix (Twl, 1%), as shown in Table 1.

Shape=0.7, Rate=0.3

Shape=1, Rate=0.1

5000
1 2000

 

O
a s a 8
o o 0: 9°
2 F) 2
3 3
t: t: 8
g 3
,9
O O
l—l—l—l—l—l l—l—l—l—l—l—I
0.5 1.0 1.5 2.0 2.5 3.0 0.0 0.5 1.0 1.5 2.0 2.5 3.0
so so
Shape=1, Rate=o.01 Shape=1, Rate=0.005
8
8
t')
>. o >. 8
E g 8 8
3 0 g "’
a “‘ 3
tr 8 E
0 8
9 O
2
O
l—l—l—l—l—l—l l—l—l—l—l—l—l
0.0 0.5 1.0 1.5 2.0 2.5 3.0 0.0 0.5 1.0 1.5 2.0 2.5 3.0
so so

Fig. 1. Histograms of the standard deviations sampled from the Gamma
densities with different parameter settings. Note that the Gamma prior is put
on the precision r and SD = 1/sqrt(r)

Different Gamma parameters represent different prior belief
regarding the distribution of the standard deviation for the noise
term/the factor loadings. Figure 1 shows the histogram of 10000
standard deviation values randomly generated from the Gamma
density with four parameter combinations tested (only the values
smaller than 3 are plotted here). We ﬁrst simulated two sets of data
to compare the eight combinations of parameter settings, with each
dataset consisting of four matrices Y1, Y2, 711 and 712, as shown in
Table 2. For both datasets, we used 018:1, 138:0.01 and (7w = 1.
For Gibbs sampling, we set the number of iteration to 30000, with
the ﬁrst half discarded as bum-in period (this was chosen based on
the MCMC (Markov chain Monte Carlo) trace plot). To reduce the
effect of auto-correlation between adjacent iterations and the data
storage burden, we only recorded the Gibbs sampling results every
other 10th iteration. We ran ﬁve independent chains for Set 1 and
three independent chains for Set 2, to check the consistency among
multiple independent runs.

We used the Area Under Curve (AUC) statistic [area under the
receiver-operating characteristic curve (ROC) curve] to assess the
inference performance of iFad. For the retained Gibbs samples after
the burn-in period, we calculate the mean of each entry of matrices
Z1 and Z2, and the ROC curve and AUC values by choosing different
cutoffs and comparing the results with the true matrices Z1 and Z2.
The ‘ROCR’ package was used for this analysis.

For general factor analysis models, there is a scale identiﬁability
problem associated with the loading matrix W and factor matrix X,
as after integrating out the latent factors, the complete density of the
observed data matrix Y is a normal distribution with covariance
matrix WEXW’ +‘I’ (Pournara and Wernisch, 2007). In order to
avoid this issue, for data simulation, we set matrix 2X to the identity
matrix. We then tested eight combinations of Gamma parameters
(Gig, ﬁg, aw, 13w; Table 1) on two simulated datasets (as described
in Table 2). We then asked how the result would be affected if 110
and 171 used for inference are different from that used in simulation.
Hence, we chose n0 =n1=0.2 for matrix L1, 170 =0.15, 171:0.05
for matrix L2 and tested the inference algorithm again on dataset 2,

 

1913

112 /3.io's[Bumo[p.IOJxosoimeOJuioiq”:duq mot} papBo1umoq

9103 ‘0g isnﬁnv uo ::

Ma and Zhao

 

Table 2. Data simulation for choosing model parameters

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Set K G1 G2 J no and n1 Density
711 712 L1 L2 21 Z2
1 18 50 50 20 0.2. 0.2 0.3. 0.1 0.316 0.167 0.394 0.38
2 15 100 50 20 0.2. 0.2 0.35. 0.05 0.05 0.0067 0.235 0.353
sen—mam,“ sen—mamm Table 3. Data simulations with different properties
 —_——@—  __r—E—
g 3: ._.E g 3: _1-;1 Set K G1 and G2 J no and n1 Density 01g. ﬁg
° ° L Z
a i i i i 5 t; i i a «I i i i is t; i ii Group I: the eﬁ‘eet of a'iﬁ‘erent no and n1
Pmm°‘”55“i"9 Mm'e’s‘tmw 1 20 100 15 0.2 0.1 0.25 1. 0.01
5°‘2—ma‘rh‘21 S'a—m'l'ixzz 2 20 100 15 0.4 0.1 0.41 1. 0.01
III ' g: 3 20 100 15 0.3 0.1 0.34 1. 0.01
g : —" _ — z — ——_ — 4 Same data as Set3. but used no and n1 20.2 for Gibbs sampling
g g _ _ — § ‘5: _ _—_' 5 Same data as Set3. but used no and n1 20.4 for Gibbs sampling
a _ — _ E ' Group 2: the eﬁ‘eet of density of matrices L and Z
. I I I I I I I I 5‘ I I I I I I I I 1 20 100 15 0.2 0.01 0.21 1.0.01
1 2 3 ‘ 5 5 7 B l 2 3 ‘ 5 3 7 3 2 20 100 15 0.2 0.1 0.25 1. 0.01
Pmma's's‘mi“ Pmm'ssm 3 20 100 15 0.2 0.3 0.38 1. 0.01
s““-'““"“‘“ 3°‘3-"‘"”‘" 4 20 100 50 0.2 0.5 0.51 1. 0.01
m _ a: 5 20 100 50 0.2 0.7 0.61 1. 0.01
g : — _ g — ; ‘ — — g — Group 3: the eﬁ‘eet of imbalanced datasets
§ 5. ""— § :3 __—— 1 20 100 15 0.2 0.1 0.25 1.0.01
° . "" S: 2 20 125. 75 15 0.2 0.1 0.26 1.0.01
5' . . . . . . . . 5 . . . . . . . . 3 20 150. 50 15 0.2 0.1 0.26 1. 0.01
1 2 a ‘ 5 6 7 B 1 2 3 4 5 5 7 8 Group 4: the eﬁ‘eet of SNR
Parameter Selling Parameter Setting S 
1 20 100 15 0.2 0.1 0.257 2.5
Fig. 2. AUC result of eight parameter settings for two simulated datasets. 2 20 100 15 0.2 0.1 0.260 5
Red line is the percentage of original matching between matrices L and Z 3 20 100 15 0.2 0.1 0.257 10
4 20 100 15 0.2 0.1 0.271 100
5 20 100 15 0.2 0.1 0.247 500
which is denoted as ‘Set 3’. The results are shown in Figure 2. The 6 20 100 15I 0‘2 0‘1 0247 1000
red lines are the proportion of entries in matrix Z that have the same froup  the eﬂea of sample fl“ 2 262 I I
value with matrix L, representing the accuracy of prior knowledge. 2 13  38   3251 1’ 
Comparing the AUC of eight parameter settings, it can be seen 3 10 50 50 0.25 0.05 0.247 1: 0.01
that (7w = 1 usually gives more consistent result among independent 4 10 50 70 0.25 0.05 0244 II 0.01

chains than putting a Gamma prior on Tw. Nevertheless, it is obvious
that Gig and ﬁg are the major factors here. Parameter setting 6 ((1g = 1,
ﬁg = 0.01 and (7w = 1) gives best result in this comparison and is used
for the remaining analysis in this article. For matrix L2 in Set 3,
n0=0.35 during simulation but 0.15 during the Gibbs sampling.
We checked the overlap of the inferred non-zero entries of matrix
L2 between Sets 2 and 3 (by using cutoff 0.5 to dichotomize the
posterior mean for each entry). For all the eight parameter settings,
the non-zero entries inferred using n0=0.15 are almost always a
subset of those inferred using no = 0.35 (as shown in Supplementary
Fig. S1).

3.1.2 Data simulation with various patterns for model performance
evaluation After determining the appropriate model parameters,
we explored how different dataset properties (e.g. sample size,
conﬁdence in the prior link matrix L, density of matrix L/Z
and noise level) may inﬂuence the performance and robustness
of the iFad model. Therefore, we simulated ﬁve other groups

 

of datasets to investigate the effects of no and n1, density of
the connectivity matrix, imbalanced dimension between the two
feature spaces (G1 #GZ), signal-to-noise ratio (SNR) and sample
size (Table 3). Regarding the simulation, matrices L1 and L2 are
randomly generated with speciﬁed density (proportion of non-zero
entries). Matrices Z1 and Z2 are simulated based on L1 and L2
with Bernoulli probability speciﬁed by no and n1. The density of Z
shown in Table 3 is the average value of Z1 and 22. For the SNR
(Group 4), the variance of each noise term (Tg_1) was calculated as

‘17; 1 = Var (WX[g,])/SNR = K/SNR. Three independent chains were
run for each dataset in Groups 1—4, with total iteration = 30 000 and
the ﬁrst half as burn-in. Gibbs samples were recorded every 10th
iteration. AUC results are shown in Figure 3. For Group 5, the chain
usually converges slower with sample size increasing, so we tried
total iteration = 10 000 (bum-in = 8000), 60 000 (burn-in = 40 000)
and 100 000 (bum-in = 70 000). The AUC is plotted in Figure 4.

 

1914

112 /3.10's112111110[p.101x0'501112m101u101qn:duq mot} papeo1umoq

9103 ‘0g isnﬁnv uo ::

Wad

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Grouanmrlxzt Group1_mltrlx22 Groumeatrlle GroumelIrleZ
m
m _ — _ _ _
d — é ‘ a: El ,,
a Z 0 ' g— a r ‘5 ‘ l?
U a _ 0 D — o E _ U 3 -
2 0 _ 2 g — a ._ a I
a _ c- a -
3 - £- 3 ' £ 3 -¥ 3 ‘ -—
° —l—i— I I I t t t t t t t t I I
1 2 a t 5 I 2 5 A 5 1 2 a 4 5 I 2 a t 5
Set Index SeI Index Set Index SeI Index
GrouaniIIrlxz1 Group8_mutrlx22 GrouanImrlle GroumeaIrlez
_ ¥ .5 — g —— ——
g _ E ' 2 ‘3 -
a
u — o m 0 w o m. _
—.— 8 _
3  - =| 2 e g ° a 2 ° %
° _ o '5 '5 -
:3 _ 31 -
3 % ° -- g -e- g _ e-g
—l—l—I— —I—I—l— t t t t t t t t t t I I
I 2 a 1 2 a I 2 a A 5 s 1 2 s 4 5 a
Set Index SeI Index Set Index SeI Index

Fig. 3. AUC result of simulated data. Groups 14

-— — — _—— — — —l1
3
| | .4

L1 21710000 21760000 217100000 L2 22710000 22760000 227100000

Fig. 4. AUC result of simulated data. Group 5

From these ﬁve groups of comparisons, it can be observed that

(1) When prior information about the connectivity structure
matrices Z1 and Z2 is fairly accurate, for example, when no
and n1 30.3, the AUC statistics are very good (Group 1, Sets 1
and 3), even if the no and n1 used for the Gibbs sampling
algorithm deviated from the true values (Group 1, Sets 4 and
5). However, when no and n1 are large (Group 1, Set 2), the
inference results are not satisfactory.

(2) iFad performs best when the density of matrices L and Z is
around 0.1—0.3 (Group 2, Sets 2 and 3); too sparse (Group 2,
Set 1) or too dense (Group 2, Sets 4 and 5) connectivity
structure can hamper the inference result.

(3) Imbalanced dimension of the two datasets does not inﬂuence
the inference result of iFad. All datasets in Group 3 achieved
very good AUC statistics.

(4) The SNR has an important effect. A large SNR is desired
for iFad to perform well (compare Group 4, Sets 1—3 with
Sets 4—6).

(5) When sample size J is smaller than the total number of latent
factors K, iFad cannot make accurate inference no matter how
long the chain is run (Group 5, Set 1). Nevertheless, J=30
seems to be adequate for datasets with K = 10 and G1 = G2 =
50 (Group 5, Set 2). Increasing sample size can improve the
performance of iFad (compare Sets 3 and 4 with Set 2) but
requires more iterations of the Gibbs sampling.

3.2 Application of iFad: analysis of NCI-60 datasets for
drug-pathway association discovery

We then applied iFad to the joint analysis of gene expression and
drug sensitivity proﬁles of the NCI-60 cell lines. The NCI-60 project
represents a comprehensive resource for various types of ‘Omics’
characterization of 60 human cancer cell lines with nine different
tissue types, including RNA expression, DNA ﬁngerprinting, DNA
methylation, sequence mutation, as well as treatment response to
> 100 000 compounds. The gene expression and drug sensitivity data
were downloaded from the CellMiner database (Shankavaram et al.,
2009), with URL http://discover.nci.nih.gov/cellminer. We used
‘RNA: Affy HG-U133 (A,B)’ (44 000 probeset 2-chip set, Guanine
Cytosine Robust Multi-Array Analysis (GCRMA) normalization)
and ‘Drug: A4463’ for analysis.

3.2.1 Gene data preprocessing We only used the HG-U133A
chip and converted probe expression to gene expression by taking the
average of the probes mapped to the same gene, resulting in a total
of 12 980 genes measured across 59 cell lines (expression data of the
cell line ‘LC:NCI_H23’ was unavailable). The expression data were
then standardized so that for each gene, mean = 0 and SD = 1 across
the 59 cell lines. As we are mainly interested in the analysis of drug
response-related genes, we only kept genes that are included in either
of the following two lists: ﬁrst, 766 cancer-related genes (Chen et al.,
2008); second, 8919 genes from the Integrated Druggable Genome
Database Project (Hopkins and Groom, 2002; Russ and Lampel,
2005), downloaded from http://www.sophicalliance.com/. After this
ﬁltering, 6958 genes were retained.

3.2.2 Drug data preprocessing The drug data are the -
log10(G150) values of Sulforhodamine assay for 4463 molecules
(also known as the standard agents) that have known 2D structure
and have been tested at-least two times. Higher values equate to
higher sensitivity of cell lines. The data are also scaled so that mean
= 0 and SD = 1 for each drug. Among these 4463 molecules, we
only kept the 101 drugs annotated in the CancerResource database
(Ahmed et al., 2011). Little information is available about the targets
or mechanisms of action for the other drugs.

3.2.3 Pathway association information Gene-pathway and drug-
pathway association data were retrieved from the KEGG MEDICUS
database (Kanehisa et a1 ., 2010). The link is http://www.genome.j p/
kegg/catalog/pathway7dd.html. We compiled a list of 58 pathways
that are either known to be related to cancer or have drug targets.
Among the 6958 genes selected in Section 3.2.1, 1863 genes are
covered by these 58 pathways and constitute the ﬁnal list of genes
in our real data analysis. Therefore, matrix L1 is a binary one with
dimension 1863 X 58, and the dimension of matrix L2 is 101 X 58.

Our research objective here is to infer unknown drug-pathway
associations to help better understand the mechanism of action of
less well-studied compounds. We treated the pathway activity levels
as latent factors in the iFad model, the gene expression data as
matrix Y1 and drug sensitivity as matrix Y2. We compiled a list
of 58 pathways (Supplementary Table S1), 1863 genes and 101
drugs for analysis, as described earlier. Gene expression data are
available for 59 cell lines, representing nine different cancer types
(Supplementary Table S2). Since there are only two cell lines from
prostate cancer, we excluded this panel, with eight cancer types
remaining for study. iFad was applied to each type, respectively,

 

1915

112 /3.10's112111110[p.101x0'501112m101u101qn:duq mot} pepeo1umoq

9103 ‘0g isnﬁnv uo ::

Ma and Zhao

 

nimgmn at inane: In em. pllhwly Hluugnm Mildrug: In em. pllhwly

mmw a1 plum-y;
Nun-rm at tummy;
20

l—ll—lI—I

 

 

50 too 150 200 0 1 2 s 1

Number 01 um: Number 0! drug:

Fig. 5. Histogram of the number of genes or drugs known to be associated
with the 58 KEGG pathways as a priori

Table 4. Number of newly inferred non-zero entries in matrix Z2 using
no 2 0.05 and various posterior probability cutoff values

 

 

Cutoff 0.2 0.25 0.3 0.35 0.4 0.45 0.5
BR 248 181 129 99 73 48 39
CNS 203 119 86 59 39 26 21
CO 276 209 167 148 121 98 81
LC 321 238 192 157 123 102 94
LE 200 122 86 66 53 41 33
ME 339 280 204 169 139 118 99
0V 261 191 154 118 96 78 63
RE 287 208 172 142 119 101 81

Union 1685 1282 1016 838 684 563 476

 

instead of using all 57 cell lines altogether, in order to avoid
potential problems arising from severe cell type heterogeneity (we
checked for several well-known gene—drug correlations and found
that the correlation coefﬁcient is usually much more signiﬁcant when
calculated using cell lines of the same type, rather than all the 57
cell lines).

For the NCI-60 analysis, the total iteration was set to 100 000
and burn-in = 70 000. For model parameters, we set no=n1=0
for matrix 711, because of high conﬁdence in the gene-pathway
association information from KEGG. For matrix 712, we set n1 :0
and tried no =0.05, 0.1, 0.15, 0.2, 0.25, in order to infer unknown
drug-pathway associations for various densities of matrix 22. Based
on prior knowledge from the KEGG database, matrix L1 has a
density of 3.95%, whereas L2 has a density of 0.51%. Figure 5
shows the distribution of the number of genes/drugs associated with
each pathway for matrix Ll/LZ.

We compared the distribution of the posterior means of the entries
of matrix 22, inferred using different values of no, as shown in
the histograms of Supplementary Figure S2 and the quantile plots
in Supplementary Figure S3. As expected, with no increasing, the
distribution of the posterior mean of Z; shifts to the right. For no =
0.05, the number of newly inferred non-zero entries in matrix Z2 is
shown in Table 4 based on various cutoffs.

We took a further look at the results obtained from cutoff = 0.3,
because the posterior means of non-zero entries of matrix Z2 can
reach around 0.5 (for more details, see Supplementary Table S3) at
this cutoff. Figure 6 shows the association pattern in the heatmap. It
can be seen that the drug-pathway interaction pattern exhibits strong
cell type speciﬁcity, demonstrating the importance of conducting

i: ' -— stun _ _ cns Colon " . Lung

 

Leukemia Melanoma . : __ 0""13" :"I. _ "9""

 

 ._I am“ __ ms -. colon tun:

 

leukemia ._ _ Melanoma

   

Fig. 6. Heatmaps showing the inferred drug-pathway association patterns.
The upper panel shows the posterior mean for each entry of matrix Z2. The
lower panel is the dichotomized value using cutoff = 0.3. Rows correspond
to drugs and columns correspond to pathways

the analysis by separating cell line groups rather than on the entire
NCI-60 panel. Supplementary Figure S4 shows the total number of
drug-pathway associations in barplots. Generally speaking, the cell
lines of ‘non-small cell lung cancer’ and ‘melanoma’ discovered
more novel drug-pathway associations, whereas ‘leukemia’, central
nervous system (‘CNS’) and ‘breast cancer’ cell lines inferred fewer
new associations. One possible explanation is the difference in
sample size: there are nine cell lines for ‘non-small cell lung cancer’
and ‘melanoma’, but only six cell lines for ‘leukemia’, ‘CNS’ and
‘breast cancer’.

We then checked whether the newly inferred drug-pathway
associations are supported by biological knowledge, based on
the CancerResource database (Ahmed et al., 2011) and PubMed.
We chose the CancerResource database as a reference because
of its comprehensiveness: it integrates drug-target information
from several well-known databases, including CTD (Davis et al.,
2009), PharmGKB (Hernandez-Boussard et al., 2008), TTD (Zhu
et al., 2011), DrugBank (Wishart et al., 2008), as well as its
own literature mining. It is worth noting that the current catalog
of drug-target information is still far from complete, and the
absence of speciﬁc drug-pathway associations in one database
does not exclude the possibility that the interaction actually exists.
Herein, we checked the inferred drug-pathway interactions using
cutoff = 0.9 (with the complete list provided in Supplementary
Table S4) and found that many of these associations can be validated
by the CancerResource database (Table 5). For the unconﬁrmed
associations, we checked the database CTD and found several
additional validations. For example, among the ‘colon cancer’
cell line panel, drug ‘daunorubicin’ is associated with pathway

 

1916

112 /3.10's112111110[p.101x0'501112m101u101qn:duq mot} pepeo1umoq

9103 ‘0g isnﬁnv uo ::

Wad

 

Table 5. Drug-pathway associations inferred using iFad which have been conﬁrmed by the CancerResource database

(cutoff = 0.9)

 

 

KEGG pathway Drug Posterior probability Cell line panel
Glutathione metabolism Vincristine 0.9987 LC
ErbB signaling pathway Mitoxantrone 0.9937 LC
Thyroid cancer Doxorubicin 0.991 RE
Glutathione metabolism 6-Mercaptopurine 0.9867 RE
Bladder cancer Tamoxifen 0.982 LC
VEGF signaling pathway Carmustine 0.9803 RE
Thyroid cancer Doxorubicin 0.9713 OV
ErbB signaling pathway Camptothecin 0.9583 LC
Bladder cancer Edelfosine 0.958 LC
Bladder cancer Chlorambucil 0.9473 RE
Melanoma Chlorambucil 0.947 ME
VEGF signaling pathway 6-Mercaptopurine 0.932 ME
Bladder cancer Geldanamycin 0.9273 CO
Thyroid cancer Dactinomycin 0.9263 OV
Apoptosis Thyniidine 0.923 CO
Cell cycle Tiazofurin 0.919 LC
Drug metabolismiother enzymes Daunorubicin 0.9157 LC
VEGF signaling pathway Lomustine 0.9103 RE
Focal adhesion Geldanamycin 0.91 BR
Endometrial cancer Doxorubicin 0.909 CO
VEGF signaling pathway Quinacrine 0.9023 RE
Base excision repair Decitabine 0.9017 LC

 

BR, breast; CNS, central nervous system; CO, colon; LC, non-small cell lung cancer; LE, leukemia; ME, melanoma; 0V, ovarian; RE, renal.

Posterior probability of ChlorambuciI-Melanoma association

 

BR CNS CO LC LE M E 0V R E

Fig. 7. Cell line speciﬁcity of the ‘chlorambucil’i‘melanoma pathway’
association

‘endometrial cancer’ with a posterior probability of 0.9547. This
association is not documented in the CancerResource database,
but can be conﬁrmed by CTD. Although some drug-pathway
associations are signiﬁcant in more than one cell line panels (e.g.
‘doxorubicin’ acts on the ‘thyroid cancer pathway’ in both renal and
ovarian cancer cell lines), most associations are still context-speciﬁc,
for instance, ‘chlorarnbucil’ is associated with ‘melanoma pathway’
mainly in melanoma cell lines, with a high posterior probability of
0.947. In contrast, this probability is much smaller in the other cell
line panels (Figure 7).

We further investigated the loading matrices W1 and W2 for the
‘melanoma pathway’. Since there may be sign-ﬂip during the Gibbs
sampling iterations, we calculated the posterior mean of the absolute
value for each entry of matrices W1 and W2 after the bum-in period.
Figure 8 shows the heatmap of the estimated loadings of factor
‘melanoma pathway’ on its associated 63 genes (the left part) and

g
1.

1%
1:.

 

Fig. 8. Posterior mean of the absolute Value of matrices W1 and W2 (only
showing the result corresponding to the ‘melanoma pathway’) for the NCI-60
data analysis, plotted by each cell line panel

on the 101 drugs (the right part). It can be clearly observed that
when the analysis is applied to the ME panel, the factor ‘melanoma
pathway’ has signiﬁcant loadings on several drugs; however, these
drug-pathway associations are much less evident when the analysis
was performed on the other cell line types.

4 DISCUSSION

Drug-target identiﬁcation is one important problem in translational
bioinformatics, as well as a crucial step in the early stage of drug
discovery and development. Although there exist many different
high-throughput technologies for molecular phenotype proﬁling,
how to perform lmowledge-based, informative data integration

 

1917

it: /3.IO'SIBIIJTIO[p.IOJXO'SOIJBIIIJOJIIIOIq”ZdJJLI mot} pepeo1umoq

9103 ‘09 isanV uo ::

Ma and Zhao

 

remains a major challenge. In this article, we have proposed a
Bayesian sparse factor analysis model, iFad, for the joint analysis
of gene expression and drug sensitivity proﬁles measured on the
same set of cell lines. The aim is to identify the target biological
pathways for drugs with unclear mechanism of action. This
model allows natural incorporation of prior knowledge about the
connectivity structure of biological pathways (e.g. KEGG pathway),
and simultaneously relates the underlying pathway activity to both
gene expression levels and drug response. Due to this sparsity
formulation, the sample size needed to achieve satisfactory inference
result can be much smaller than the number of features in either
dataset. We demonstrate the performance of iFad ﬁrst using
simulation and then on the NCI-60 datasets. Real data analysis
shows that our method is able to identify many cancer type-
speciﬁc drug-pathway associations. One direction of great interest
for future study is how to speed up the computation process,
since MCMC methods are usually time-consuming when applied
to high-dimensional inference.

Joint modeling of expression proﬁles and drug-related data
represent an increasingly important and popular trend in the future.
Besides the bi-clustering method ISA mentioned in Section 1
(Kutalik et al., 2008), another seminal work in this ﬁeld (Chang
et al., 2005) used Bayesian networks to model the gene—drug
dependency, also on the NCI-60 data. Due to computational
constraints of Bayesian network models, extensive feature selection
was performed before the network inference. A more recent work
(Chen et al., 2009) developed a linear regression model that
integrates genotype and gene expression data generated under
drug-free conditions of yeast segregants to predict the response
to various drugs. From a statistical point of view, joint analysis
of paired datasets can be achieved using a number of techniques,
such as canonical correlation, bipartite graph inference, model-based
clustering, etc. With the availability of more and more types of high-
throughput datasets from the same panel of samples, novel statistical
methods are in great need for knowledge-guided combined analysis.

Funding: National Institutes of Health (GM59507 to Hz.) and NIH
R2l-GM084008 to Ning Sun.

Conﬂict of Interest: None declared.

REFERENCES

Ahmed,J. et al. (2011) CancerResource: a comprehensive database of cancer-relevant
proteins and compound interactions supported by experimental knowledge. Nucleic
Acids Res, 39, D9607D967.

Bader,G.D. et al. (2006) Pathguide: a pathway resource list. Nucleic Acids Res, 34,
D50¥D506.

Boyce,S.E. et al. (2009) Predicting ligand binding afﬁnity with alchemical free energy
methods in a polar model binding site. J. Mol. Biol, 394, 7477763.

Bussey,K.J. et al. (2006) Integrating data on DNA copy number with gene expression
levels and drug sensitivities in the NCI-60 cell line panel. Mol. Cancer Ther, 5,
8537867.

Campillos,M. et al. (2008) Drug target identiﬁcation using side-effect similarity.
Science, 321, 2637266.

Chang,J.H. et al. (2005) Bayesian network learning with feature abstraction for gene-
drug dependency analysis. J. Bioinform. Comput. Biol, 3, 61777.

Chen,B.J. et al. (2009) Harnessing gene expression to identify the genetic basis of drug
resistance. Mol. Syst. Biol, 5, 310.

Chen,J. et al. (2008) Genomic proﬁling of 766 cancer-related genes in archived
esophageal normal and carcinoma tissues. Int. J. cancer, 122, 24972254.

Czodrowski,P. et al. (2009) Computational approaches to predict drug metabolism.
Expert Opin. Drug Metab. Toxicol., S, 15727.

Davis,A.P. et al. (2009) Comparative toxicogenomics database: a knowledgebase
and discovery tool for chemical-gene-disease networks. Nucleic Acids Res, 37,
D78&D792.

Ecker,G.F. et al. (2008) Computational models for prediction of interactions with
ABC-transporters. Drug Discov. Today, 13, 3117317.

Gharib,S.A. et al. (2006) Computational identiﬁcation of key biological modules and
transcription factors in acute lung injury. Am. J. Respir Crit. Care Med, 173,
653458.

Hernandez-Boussard,T. et al. (2008) The pharmacogenetics and pharmacogenomics
knowledge base: accentuating the knowledge. NucleicAcids Res, 36, D9137D918.

Hopkins,A.L. and Groom,C.R. (2002) The druggable genome. Nat. Rev Drug Discov.,
1, 7277730.

Ikediobi,O.N. et al. (2006) Mutation analysis of 24 known cancer genes in the NCI-60
cell line set. Mol. Cancer Then, S, 260&2612.

Irwin,J.J. et al. (2009) Automated docking screens: a feasibility study. J. Med. Chem.,
52, 571275720.

Kanehisa,M. et al. (2010) KEGG for representation and analysis of molecular networks
involving diseases and drugs. Nucleic Acids Res, 38, D3557D360.

Kolb,P. et al. (2009) Docking and chemoinforrnatic screens for new ligands and targets.
Curr Opin. Biotechnol., 20, 429436.

Kuhn,M. et al. (2008) STITCH: interaction networks of chemicals and proteins. Nucleic
Acids Res, 36, D68¥D688.

Kutalik,Z. et al. (2008) A modular approach for integrative analysis of large-scale
gene-expression and drug-response data. Nat. Biotechnol., 26, 5317539.

Lamb,J. etal. (2006) The connectivity map: using gene-expression signatures to connect
small molecules, genes, and disease. Science, 313, 192971935.

Meng,J. et al. (2011) Bayesian non-negative factor analysis for reconstructing
transcription factor mediated regulatory networks. Proteome Sci., 9 (Suppl 1), S9.

Nigsch,F. et al. (2009) Computational toxicology: an overview of the sources of data
and of modelling methods. Expert Opin. Drug Metab. Toxicol., S, 1714.

Pournara,I. and Wemisch,L. (2007) Factor analysis for gene regulatory networks and
transcription factor activity proﬁles. BMC Bioinformatics, 8, 61.

Pujol,A. et al. (2010) Unveiling the role of network and systems biology in drug
discovery. Trends Pharmacol. Sci., 31, 1157123.

Russ,A.P. and Lampel,S. (2005) The druggable genome: an update. Drug Discov. Today,
10, 160771610.

Schadt,E.E. et al. (2009) A network view of disease and compound screening. Nat. Rev
Drug Discov., 8, 28&Z95.

Shankavaram,U.T. et al. (2007) Transcript and protein expression proﬁles of the
NCI-60 cancer cell panel: an integromic microarray study. Mol. Cancer Ther, 6,
8207832.

Shankavaram,U.T. et al. (2009) CellMiner: a relational database and query tool for the
NCI-60 cancer cell lines. BM C Genomics, 10, 277.

Sharma,S.V. et al. (2010) Cell line-based platforms to evaluate the therapeutic efﬁcacy
of candidate anticancer agents. Nat. Rev Cancer, 10, 2417253.

Sharp,K. et al. (2010) A comparison of inference in sparse factor analysis. Submitted
to the J. Mach. Learn. Res, September.

Shoemaker,R.H. (2006) The NCI60 human tumour cell line anticancer drug screen. Nat.
Rev. Cancer, 6, 8137823.

Staunton,J.E. et al. (2001) Chemosensitivity prediction by transcriptional proﬁling.
Proc. Natl Acad. Sci. USA, 98, 10787710792.

West,M. (2003) Bayesian factor regression models in the “large p, small n” paradigm.
In Bernardo,J.M. et al. (eds) Bayesian Statistics, Oxford University Press, Oxford,
UK, Vol. 7, pp. 733742.

Wishart,D.S. et al. (2008) DrugBank: a knowledgebase for drugs, drug actions and drug
targets. Nucleic Acids Res, 36, D9017D906.

Yeh,H.Y. et al. (2009) Identifying signiﬁcant genetic regulatory networks in the prostate
cancer from microarray data based on transcription factor analysis and conditional
independency. BM C Med Genomics, 2, 70.

Yeh,P. et al. (2006) Functional classiﬁcation of drugs by properties of their pairwise
interactions. Nat. Genet, 38, 489494.

Yildirim,M.A. et al. (2007) Drug-target network. Nat. Biotechnol., 25, 111971126.

Yu,T. and Li,K.C. (2005) Inference of transcriptional regulatory network by two-stage
constrained space factor analysis. Bioinformatics, 21, 40334038.

Zavodszky,M.I. and Kuhn,L.A. (2005) Side-chain ﬂexibility in protein-ligand binding:
the minimal rotation hypothesis. Protein Sci., 14, 110471114.

Zhu,F. et al. (2011) Therapeutic target database update 2012: a resource for facilitating
target-oriented drug discovery. Nucleic Acids Res, 40, D11287D1136.

 

1918

112 /3.Io's[Bumo[pJOJXO'sorwuiJOJurorqﬂ:duq moi; papeolumoq

91oz ‘Og isnﬁnv uo ::

