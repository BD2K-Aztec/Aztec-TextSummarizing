ORIGINAL PAPER

Vol. 29 no. 15 2013, pages 1872-1878
doi:10. 1 093/bioinformatics/btt319

 

Systems biology

Advance Access publication June 7, 2013

Network2Canvas: network visualization on a canvas with

enrichment analysis

Christopher M. Tan, Edward Y. Chen, Ruth Dannenfelser, Neil R. Clark and Avi Ma’ayan*

Department of Pharmacology and Systems Therapeutics, Systems Biology Center New York, Icahn School of Medicine

at Mount Sinai, New York, NY 10029, USA
Associate Editor: Igor Jurisica

 

ABSTRACT

Motivation: Networks are vital to computational systems biology re-
search, but visualizing them is a challenge. For networks larger than
~100 nodes and ~200 links, ball-and-stick diagrams fail to convey
much information. To address this, we developed Network20anvas
(N2C), a web application that provides an alternative way to view net-
works. N2C visualizes networks by placing nodes on a square toroidal
canvas. The network nodes are clustered on the canvas using simu-
lated annealing to maximize local connections where a node’s bright-
ness is made proportional to its local fitness. The interactive canvas is
implemented in HyperText Markup Language (HTML)5 with the
JavaScript library Data-Driven Documents (D3). We applied N2C to
visualize 30 canvases made from human and mouse gene-set libraries
and 6 canvases made from the Food and Drug Administration (FDA)-
approved drug-set libraries. Given lists of genes or drugs, enriched
terms are highlighted on the canvases, and their degree of clustering is
computed. Because N2C produces visual patterns of enriched terms
on canvases, a trained eye can detect signatures instantly. In sum-
mary, N2C provides a new flexible method to visualize large networks
and can be used to perform and visualize gene-set and drug-set
enrichment analyses.

Availability: N2C is freely available at http://www.maayanlab.net/N2C
and is open source.

Contact: avi.maayan@mssm.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on February 24, 2013; revised on May 27, 2013; accepted
on May 28, 2013

1 INTRODUCTION

Since the late 1990s, networks have been popularized for helping
to increase our understanding of complex systems across various
scientiﬁc disciplines (Barabasi and Albert, 1999; Watts and
Strogatz, 1998), including systems biology and systems pharma-
cology. Commonly, networks are used to model complex systems
by representing the various types of entities as nodes and their
relationships as links. Network representation is useful for orga-
nizing the accumulating data about the system, which allows
identifying novel non-trivial relationships. For example, network
representation is useful for ﬁnding clusters in proteineprotein
interaction networks (Bader and Hogue, 2003) or for detecting
network motifs (Milo et al., 2002), such as feedforward and

 

*To whom correspondence should be addressed.

feedback loops. In addition, selected nodes with common prop-
erties, such as disease genes or differentially expressed genes, can
be projected onto networks to highlight specific regions in the
system, whereas forming a network can be a ﬁrst step toward
modeling the system’s dynamics. In the fields of systems biology
and systems pharmacology, networks are used to represent pro-
teineprotein interactions (Ito et al., 2001), cell signaling pathways
(Ma’ayan et al., 2005), gene regulatory networks (Salgado et al.,
2013), metabolic networks (Jeong et al., 2000), drug-target net-
works (Ma’ayan et al., 2007) and other types of networks where
nodes and links may represent different types of relationships
(Lee et al., 2004). Although network representation has been
proven to be useful, large networks are difﬁcult to Visualize.
The most popular approach to Visualize networks is ball-and-
stick diagrams. Many software tools are available to convert
networks saved in a tabular format into a graphic ball-and-
stick representation (Bastian et al., 2009; Batagelj and Mrvar,
1998; Breitkreutz et al., 2003; Dogrusoz et al., 2006; Ellson
et al., 2002; Hu et al., 2004; Shannon et al., 2003; Wiese et al.,
2004). However, when there are more than ~100 nodes and 200
links, a situation that is common in systems biology and systems
pharmacology, ball-and-stick diagrams fail to convey much
useful information. Alternative methods such as TreeMaps
(Shneiderman and Wattenberg, 2001), chord diagrams (Kassel
and TuraeV, 1995) or clustered adjacency matrix heatmaps can
also Visualize networks. These approaches have their own advan-
tages and disadvantages, but most of these alternative methods
have not been widely adopted. In the past, we have developed the
software tool grid analysis of time-series expression (GATE),
which is a tool to Visualize time series gene expression data on
a hexagonal grid movie (MacArthur et al., 2010). Neighboring
genes on the GATE hexagonal grid can be considered connected
in a network where links between genes are established based
on a geneegene time-series correlation. This gave us the idea
that any network can be Visualized on a hexagonal grid.

More recently, we developed an algorithm called
Sets2Networks to construct functional association geneegene
and drugwlrug networks based on their shared properties
(Clark et al., 2012). Given gene— or drug-set libraries, typically
used for gene-set enrichment analyses (Sherman and Lempicki,
2009; Subramanian et al., 2005), the algorithm converts these
gene— or drug-set libraries to functional association networks
(FANs) based on various measures of gene or drug co-occurrence.
In the FANs, genes are connected if they share many functional
terms, such as belonging to the same pathway or regulated by the
same transcription factor. Using the same approach, gene-set

 

1872 © The Author 2013. Published by Oxford University Press. All rights resen/ed. For Permissions, please e—mail: journals.permissions@oup.com

112 /310's112u1n0[p10}x0"sotJBurJOJutotq/ﬁduq 11101} popcorn/hog

9103 ‘Og anﬁnV uo ::

NetworkZCanvas: network visualization on a canvas with enrichment analysis

 

libraries can be transposedimaking the genes the terms, and the
terms the set members associated with each gene; for example, a
transposed gene-set library created from the Kyoto Encyclopedia
of Genes and Genomes (KEGG) signaling pathways database
(Ogata et al., 1999) can be created where a gene/protein is the
term, and members of each set are pathways that contain the
gene/protein. Applying the Sets2Networks algorithm on trans-
posed gene-set libraries results in termiterm FANs. Similar net-
works have been developed for the Cytoscape (Shannon et al.,
2003), plug-ins BiNGO (Maere et al., 2005) or EnrichmentMap
(Merico et al., 2010), which display ball-and-stick diagrams of
related gene ontology (GO) terms (Ashburner et al., 2000).
With the popular tools BiNGO and EnrichmentMap, enriched
terms are Visualized on the network by highlighting the enriched
nodes (GO terms) in different colors and size given input gene lists
entered by users.

Here we implemented a new approach to Visualize large net-
works. We project the network nodes onto a square grid canvas.
The method and tool are called Network2Canvas (N2C). N2C
arranges nodes on the canvas to maximize local connections
where a node’s brightness is made proportional to its local ﬁt-
ness. In addition, we use this network Visualizing approach to
perform gene-set enrichment analyses (Sherman and Lempicki,
2009; Subramanian et al., 2005). Conceptually, this approach
provides similar functionality as BiNGO and EnrichmentMap,
highlighting enriched terms on FANs. However, instead of Visua-
lizing termiterm networks using balls-and—sticks, we Visualize the
networks of terms on a canvas where each square on the canvas
represents a functional term, and terms are organized on the
canvas based on their gene-set content similarity. This provides
a condensed and appealing View of the results. Besides creating
canvases for the three GO ontologiesibiological process, cellu-
lar component and molecular functionias implemented for
BiNGO and EnrichmentMap, we created canvases for 27 add-
itional gene-set libraries. To make the plots interactive, web-
based, lightweight and publication ready, we implemented the
application using the JavaScript library Data-Driven
Documents (D3) (Bostock et al., 2011).

2 METHODS

Gene-set library canvases: N2C contains 30 canvases representing 30 gene-
set libraries belonging to six broad categories: transcription, pathways,
ontologies, drugs/ diseases, cell lines and miscellaneous. Although some of
the libraries are borrowed from other sources (Chen et al., 2012; Culhane
et al., 2010; Lachmann and Ma’ayan, 2009; Liberzon et al., 2011), includ-
ing some from our previous publications, new gene-set libraries were
added, including a gene-set library created from the Encyclopedia of
DNA Elements (ENCODE) project (Rosenbloom et al., 2012), the
Epigenomics Roadmap (Bernstein et al., 2010), the Cancer Cell Line
Encyclopedia (Barretina et al., 2012) and the human and mouse gene
atlases. Details about the construction of each gene-set library with ref-
erences can be found in the supporting text. To create canvases from such
gene-set libraries, we ﬁrst transposed the libraries where the genes are the
set labels and the terms are the set members. We then applied the
Sets2Networks algorithm (Clark et al., 2012) to the resultant term-set
libraries to create networks that connect terms from each library based
on termiterm gene-set content similarity.

Drug-set library canvases: N2C also contains six canvases represent-
ing drugidrug similarity networks and six canvases representing

drug-property/drug-property similarity networks. These 12 canvases are
made from the same six drug-set libraries linking drugs to their shared
properties or properties to their shared drugs. The drugs in the six drug-
set libraries are all approved by the Food and Drug Administration
(FDA). Two libraries are created from side effect sources: The ﬁrst side
effect drug-set library is created from the Side Effect Resource (SIDER)
side effect database (Kuhn et al., 2010), which has computational for-
matted information from drug insert labels. The second drug-set library is
created from the FDA adverse events reporting system (FAERS)
(Tatonetti et al., 2012). To create this library, we used 1 million recent
FAERS reports. We ﬁrst identiﬁed the top 40 most common severe side
effects and then assigned side effects to drugs if the side effect was dis-
proportionally associated with the side effect. We also created a drug-set
library based on the drug ﬁrst- and second-level Anatomical Therapeutic
Chemical classiﬁcation codes by processing information available from
the DrugBank (W ishart et al., 2006). In addition, we also created a drug-
set library based on the drug structure. Using the R library ChemmineR
(Cao et al., 2008), the simpliﬁed molecular-input line-entry system
(SMILES) strings of each FDA-approved drug were converted to a
binary string representing various structural elements of the drugs.
Then, to create a drug-set library, the structural elements were made
the terms, and the drugs that contain these structural elements are mem-
bers of the sets. The last two drug-set libraries are created from processing
the Connectivity Map database (CMAP) (Lamb et al., 2006). We ﬁrst
processed the ranked ﬁles from CMAP to identify the top 100 up-and
down-regulated genes for each experiment. Using these gene lists, we
performed gene-list enrichment analysis using the KEGG pathway
gene-set library (Ogata et al., 1999) or our own ChIP-seq enrichment
analysis (ChEA) database/gene-set library (Lachmann et al., 2010). If
the KEGG pathway or the ChEA transcription factor experiment was
found to be enriched (P<0.05 after BH correction), then the drug was
added to the pathwaywlrug-set library or the transcription factor drug-set
library, respectively. To create networks from such drug-set libraries, we
applied the Sets2Networks algorithm to the transposed and untransposed
drug-set libraries to create six networks that connect FDA-approved
drugs and six networks that connect terms that describe drug properties.
Converting networks to canvases: N2C creates canvases from any net-
work, including FANs inferred from drug- or gene-set libraries. N2C
contains two principal modules: the Annealer and the Visualizer. The
Annealer converts an adjacency matrix representation of a network
into a JavaScript Object Notation (JSON) ﬁle that contains the structure
of the canvas; the Visualizer colors the canvas for display using D3 and
outputs HTML and J avaScript ﬁles that can be viewed by modern brow-
sers that support scalable vector graphics (SVG). To maximize the global
ﬁtness of the canvas, a Boltzmann probability function is used for the
simulated annealing of the nodes on the canvas. Initially, nodes/terms are
placed on the canvas randomly, and then pairs of nodes/terms are
swapped repeatedly. As more time elapses, the probability of accepting
a poor swap decreases (see supporting text for additional details).
Enrichment analysis and assessing clustering on the canvas: Enrichment
analysis using N2C uses the standard method of the Fisher exact test
applied on the overlap proportions between the query input list and the
lists in the gene- or drug-set libraries. Resultant P-values are corrected
using two alternative methodsiBonferroni and BenjaminiiHochbergi
for multiple hypotheses testing. The enriched terms are highlighted on the
canvas and are also output in a table with their corrected and uncorrected
P-values. The enrichment analyses also produce Z-scores that show the
degree of clustering of the enriched terms on the canvas. Subsets of nodes
are considered signiﬁcantly clustered when the position of the highlighted
nodes on the canvas is signiﬁcantly more clustered than what is expected
for randomly placed nodes. To compute the degree of clustering, we ﬁrst
require a measure of average distance among the selected nodes: the mean
nearest neighbor distance (Skellam, 1952). Because a random subset of
nodes is distributed uniformly and randomly over the canvas, we also

 

1 873

112 /310's112u1n0fp10}x0"sotwurJOJutotq/ﬁduq 11101} popcorn/hog

9103 ‘Og isnﬁnV uo ::

C.M. Tan et al.

 

need a measure of clustering relative to this random unclustered distri-
bution (Clark and Evans, 1954). If we use the Manhattan distance, the
probability of exactly zero nodes within a Manhattan distance of r of any
given node is:

P(0, 2pr2) = e’zp'l (1)

where r is half the length of the squared canvas, and p is the number
of selected squares per unit area. Next, we turn to the second event,
which is that there is at least one node within the annulus deﬁned
by the radii r and r+8r. The area of this annulus is 4r8r, so according
to the Poisson distribution the probability of observing exactly zero
events in this area is:

P(0,p(4r8r + 2&2» = eep(4rar+2arl) (2)

Repeating the steps as above, the probability distribution for the nearest
Manhattan distance neighbors is:
pm = 4M“ (3)

This probability distribution can now be used to quantify the signiﬁcance
of any observed value of the mean nearest neighbor distance. For this, we
need to know the expectation and variance under the null hypothesis of
no clustering. This is calculated as follows:

Er: 4r2e’2p’ldr2 1 4
() Ofp 8p ()

°° 2
Var(r) = / 4pr(r —  e’zprzdr = 748— ” (5)
0 p 9

And the Manhattan distance z-score is given by:

It 8Np
z=(w— 87)) 4” (6)

 

Note that here we retain the assumption of continuity. However, in
our application the canvases are often not large enough and affected by
the discrete nature of the squares. Running simulations for various size
canvases, we noticed that power laws are a good approximation, so we
ﬁtted power laws to the expected distances between random nodes:

Mean 2 amp”"1 (7)
o = asn’“l w”*‘2 (8)

The ﬁtted values are listed in Table 1. In the web application, we used the
approximation and table to compute the level of clustering.

Network view and P-value view: N2C provides three views for each
canvas. The default View shows the nodes in various shades of brightness,
where node brightness is made proportional to its local ﬁtness: the
brighter a node is, the stronger its connections to its neighbors. The
second View is called the P-value View. Here, only the top 20 enriched

Table 1. Fitted parameters for computing the clustering level of enriched
terms

 

Variable Estimate Standard error t-Statistic P-value

 

a_m 0.62921 0.00571763 110.047 2.5 x 10*53
p_m —0.503301 0.00175724 —286.415 9.4 x 10*71
a_s 0.328498 0.00617916 53.1622 1.8 x 10*30
p_s1 —1.00728 0.00326769 —308.256 1.5 x 10*52
p_sZ 1.00939 0.004877 206.969 1.6 x 10*47

 

terms are highlighted where the brightness is based on the signiﬁcance of
the P-value. The third View is a network of enriched terms. Here, nodes
are connected if they are enriched and close to each other on the canvas.
All images generated by N2C are vector graphic SVG images that can be
downloaded and imported into software tools such as Adobe Illustrator.
The canvas View provides an interactive display of square labels, and
clicking on squares provides more information about the terms and the
set members.

3 RESULTS

3.1 Creating canvases from gene-set libraries and con-
verting networks to a canvas

The workﬂow of N2C starts with a gene- or drug-set library
coded as a gene matrix transposed (GMT) ﬁle or a network
coded as an adjacency matrix. If starting with a drug- or a
gene-set library, or other dataset that takes the form of a
GMT ﬁle, the Sets2Networks algorithm converts the GMT file
into an adjacency matrix. If starting with a network, the network
is converted into an adjacency matrix. Python scripts with
example data files and detailed explanations are provided
on the N2C website help section. Using the adjacency matrix
as input, the Annealer component of N2C organizes the nodes
on a canvas, and once it is done annealing, it generates a JSON
file that contains the information needed to display the canvas.
The Visualizer script then creates the HTML and J avaScript ﬁles
that are needed to display the interactive canvas in a browser

(Fig. 1).

3.2 The N2C web application

We created 30 canvases from 30 different gene-set libraries
(Fig. 2) and 12 canvases from 6 drug-set libraries (Fig. 3) and
combined them into a web-based application available at

 
  
 
    
  
 
  
       

 

inrer a network from a gene or drug

set library based on cu-uccurrence Functional Any other
or genes or drugs in sets. Association type of

Network (FAN) network

 
 

Mean Matrix

N2C Annealer

    

N2C Visualizer

Networks can be converted inm
Terms are placed onto a adjacency matrices which N2C
square roruidai canvas. uses an input.
The canvas is annealed
to output a maximum
global fitness.

    

The brishtnessofthe
color is dependanton
each node’s similarity to
its eight neighbors.

   
   
    
    
  
 

Enrichment Table

   

Term P-Valuo

        

Calculate of

  
 
 

 
 
   
 

SLILFAMETHOXAZOLE A"; Pair

Distance

   
    
 

Standard Dev. Z-Score

   

Canvas

Create a table urrnemp 20 1 I
terms highlighted

en riched terms with their zrscnres
associated prvalues. en riched terms.

  

Fig. 1. The N2C workﬂow. Taking a mean adjacency matrix derived
from a network as input, the Annealer places terms onto a square tor-
oidal grid and anneals them for a user-deﬁned duration, outputting a
JSON ﬁle. The Visualizer reads this ﬁle and colors the canvas.
Enrichment analysis highlights terms on the canvas, calculates the
degree of clustering and outputs a table of the top 20 enriched terms
and their P-values

 

1 874

112 /3.10's112u.1n0[p.101x0"sotieuuqutotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isanV uo ::

NetworkZCanvas: network visualization on a canvas with enrichment analysis

 

 
 
 

  
  

Blcca rta Nuclear lF-MS (mp4):

Heaclurne PPI- Hub Proteins

Histone Mndlﬁmtlnns JASPER +Trarisi‘al:

GeneDntology CC GeneDntology MF

OMlM Disease

 

KEA

\Mkipathways ChEA ENCODE TF5

 
  
 

 

minoRNAs UCSC GB PWMs GeneDnlology BF

 

MGI 7 MP

 

OMIM Expanded

ViruleN!

       

Genesl DB

 

Human Gene Arias Muuse Gene Atlas "CF60 Cancer Ceil Line HMDB Metabolites PFAM Interpro

Fig. 2. Canvases for the 30 gene-set libraries. Each canvas represents a
gene-set library. In each canvas, each node (square) represents a gene list
associated with a gene-set library term. The terms are arranged on the
canvas based on their gene-set content similarity. The brightness of each
node is determined by its similarity to its eight neighbors. Canvases are
color coded based on their category: pathways, cyan; transcription,
purple; ontologies, green; disease/drugs, yellow; cell types, red and
miscellaneous, blue

http://www.maayanlab.net/N2C (Fig. 4). From this interface,
users can perform gene- or drug-set enrichment analyses for
data exploration and generate figures for publications. Later,
we demonstrate how this can be accomplished in two case stu-
dies. In addition, Python scripts and a user manual are provided
to enable users to create their own canvases from their networks.

3.3 Application of N2C to analyze gene expression data
collected from embryonic stem cells

To demonstrate the usefulness of N2C, we performed enrichment
analysis on lists of genes that are up-regulated after RNAi
knockdown of various pluripotency transcription factors in
mouse embryonic stem cells (mESCs) (Ivanova et al., 2006).
We first extracted lists of differential expressed up-regulated
genes after knockdowns of the key well-studied factors in
mESCs: Nanog, Oct4, Sox2, Esrrb and Tbx3. All these factors
are critical for maintaining pluripotency because, when knocked
down with short hairpin RNAs, mESCs differentiate into
embryoid bodies after several days. Although it is known that
these factors autoregulate each other and often physically inter-
act (MacArthur et al., 2009), not much is known regarding the

          

AERS Drug ChEA Drug

  

KEGG Drugs MACCS Drugs
AERS Terms ATC Terms ChEA Terms
KEGG Terms MACCS Terms SIDER Terms

 

Fig. 3. Twelve canvases for the six drug-set libraries. Each canvas repre-
sents a drug-set library where each node (square) is an FDA-approved
drug (blue canvases) or an FDA-approved drug property, e.g. a side
effect or a structural element. Nodes are arranged based on their drug
property similarity (for the drug canvases) or based on drug content
similarity (for the drug property canvases). Nodes are colored based on
their similarity to their neighbors: the brighter the spot, the higher the
similarity. The six drug property set library canvases are the inverse of the
six drug-set library canvases, all made from the original six drug-set
library

 

as:

"mamas: Newark Visualization on a Canvas MEI Enrichment Analysls

311g Du; Sl'llhﬂlrr‘ :smsss Filnnlnnalnasaclallnnﬁnne (Imam: [Illuminating Elm:

 

   

 

 

 

 

 

Inch“! Cal-“0W3 lﬂ MIMI". Limo-I
KEGG Pathways '
(hm llil Etlllcllwlli Ill-Duh
in. Push-
MOW“: Maig- rrurs (neared
gram
us»
rrcnrz, r
assesses 2 mm
"Rim:
sci-mu
Fawn-Lip ‘ m”
Pﬁﬂ'llli iLI
OtLLICEj‘iE
_ CEMEII: Basieo
5m 1m mmcﬁin
:w
1L1! - o
:iuaii: Q‘AI’WDEI’I
:-_: Leak ‘ONH
Wm 45411:” s
115532 unlined;
“N” um; um ‘ "5"“
“1 I lﬂnViln' :imn Vow P-Vai-nli'in 9’
mil Clea Hal-1.720;
CIU Jam-Mirecmwvewmteddlma-mawmmlem «Raine WE
Em are r mac-4
EIuIIianng 15m" [an-'1'”
bgzlunimntimn! ammo.“ «New;
FI-ihr- nu» Elam 9‘” 9 main;
unsure.
(ha Inn'an uni-e Mn. 5m: 1 Sails ii: IJ.HELiC I m. 3
Dev. ulsszEnJN
:nees: Ie-Lm hr. Dimm- LDRl_$I(JI£E’iI
imgi- urn: 21::5 an}:
:uu 1497:46an
.. CELLjECE‘F ,5“ 3
7"“ . .. -.. r .- '  I1.“ .:- , TDRAILQNI '
can: i ' rl‘,_ﬂ¢lm'-'W
awn”:
Lemma; 1 Ease-3
JIM?”
l—sooqgw 6i.

 

 

Fig. 4. Screenshot from the N2C web application. The interactive user
interface of N2C provides users with the ability to select the desired
canvas (KEGG is selected a default), change the canvas colors, highlight
speciﬁc nodes on the canvas, perform enrichment analyses and explore
the content of each node. The enrichment results are displayed in a table
and can be exported

 

1 875

112 /3.10's112u.1n0[p.101x0"sotieuuqutotq/ﬁduq 111011 pap1201um0q

9103 ‘0g isnﬁnv uo ::

C.M. Tan et al.

 

 

 

   

 

 

 

   

NROBI POUSF‘I POUSFI POUSFI
POU5F1 SMAm NANOG
50X? NANOG 50x2 E2F1 NANOG TCFAPZC
HNF4A
EGR1 KLFA MVC PRDM” MVC NANOG PRDM14 EGR, KLF4
H3K27ME3 H3K27ME3 H3K27ME3
2:53:34 DUODENUM c034 DUODENUM Egg/TB H3K4M53
H3K27ME3 H3K27ME3
H3K27ME3 H3K27ME3 BRAIN MID H3K4ME1 H9 SMOOTH  EEK?"  SMOOTH BRAIN MID BRAIN GERMINAL H3K27AC
BRAIN GERMINAL IPSr1SB FRONTAL LOSE MUSCLE MUSCLE FRONTAL Lan MATRIx IFS DF6
MATRIX
Histone
Modiﬁcations
H3K27ME3
REcrAL SMOOTH HZBKZOAC H1 H3K27ME3 PERIPHERAL
MUSCLE H3K27ME3 SESmNgRESKIN H3K27M53 BLOODMONONUCLEAR H3K27ME3 Sigma H3K27ME3 $333538 H3K27ME3 H3K4ME3CD3
H3KZ7ME3 lPS-ZOB KERATINOCVTE "25.203 PRIMARYCELLS "’5'203 VHMEC PRIMARYCELIS RECTALSMOOTH PRIMARYCELLS
EEEBPRIMARY PRIMARYCELLS H3K27ME3CD3 MUSCLE
PRIMARYCELLS
ABNORMAL ABNORMAL ABNORMAL PREMATAL ABNORMAL ABNORMAL
ABNORMAL EVE BRAIN NOABNORMAL EMBRYONIC BRAIN LETHAerY BLOODVESSEL EXTRAEMBRVON'C
DEVELOPMENT MORPHOLOGv PHENOTYPE TISSUE MORPHOLOGY TISSUE
ABNORMAL
BLOODVESSEL
Mammalian
Phenotype
ABNORMAL
KIDNEY MP0005253
PHVS|0LOGV MAMMAL'AN PER'NATAL NORMAL MAMMAUAN ABNORMAL ABNORMAL EYE MP0003861 ABNORMAL MALE MAMMAL'AN ABNORMAL $332?“ ABNORMAL
PHENOTVPE LETHAL'TV pHENoTYpE PHENOTVPE NEURON PHYSIOLOGY ABNORMAL REPRODUCTIVE PHENOTYPE NEURON NEURON
MORPHOLOGY NERVOUS SYSTEM MORPHOLOGY CE”- MORPHOLOGY
EMBRYONIc INTESTINE EMBRYONIC
STEM LINEV26 BAF3 STEM LINEV26 CEREBELLUM HIPPOCAMPUS MAST CELLS STOMACH
2 P16 LARGE 2 P16 CEREBRAL CORTEX INTESTINE LARGE
EMBRYONIc
STEM LINE
BRUCE4 P13
Mouse
Gene Atlas
HEART
INTESTINE LARGE
INTESTINE BLADDER DORSAL KIDNEY SPINAL DORSAL INTESTINE
SMALL UMBILICALCORD ROOT PLACENTA
M AST CELLS ROOT CORD NEURozA SMALL
GANGLIA “LADDER GANGLIA

Fig. 5. Meta-signatures using various gene-set libraries applied to gene lists extracted from gene expression microarrays after knockdown of various
transcription factors in mESCs. Only enriched terms are highlighted on the canvas. Brighter nodes represent lower P-value enriched terms

subtle differences of the effects of these knockdowns on lineage
propensity. Using N2C, we generated enrichment analysis can-
vases resulting from ChEA, histone modiﬁcations, Mouse-
Genome-Informatics/Mammalian—Phenotype (MGI-MP) and
mouse cell atlas canvases. The results show that, overall, the
various transcription factors induce similar patterns, but some
differences are clearly visible (Fig. 5).

For example, Nanog, Esrrb and Tbx3 induce genes that are
targeted by EGRl, but EGRl is not enriched for Oct4 and Sox2
knockdowns. Esrrb is the only factor that does not induce the
expression of genes regulated by Myc. Tbx3 up-regulates genes
that are mostly regulated by the active histone marks H3K4me3,
whereas the rest of the factors up-regulated genes are enriched

for the repressive marks H3K27me3. Interestingly, Sox2 and
Oct4 have a strong neuronal signature based on both MGI—
MP and the mouse gene atlas, suggesting a propensity for dif-
ferentiation toward neuroectoderm. It was previously described
that Sox2 and Oct4 interact and regulate genes together (Chew
et al., 2005), whereas induction of Oct4 alone in neuronal pro-
genitor cells is sufﬁcient for induced pluripotency stem cell repro-
gramming (Kim et al., 2009). Nanog, Tbx3 and Esrrb show
suppression of kidney, intestine, bladder and endothelial cell
phenotype genes. This suggests that the knockdown of these
factors promotes the propensity toward mesoderm lineage
differentiation. The advantage of the N2C visualization is that
such similarities and differences can be seen immediately by the

 

1876

112 ﬁlos1tzu1no[pique'so11nuuo1u1o1q/ﬁdnt1 1110.11 pap1201u/IAOQ

9103 ‘0g isanV uo ::

NetworkZCanvas: network visualization on a canvas with enrichment analysis

 

Table 2. Two measures Of clustering Of enriched MACCS keys for severe
side effects from FAERS on the drug structural elements canvas or com-
puted from the drug structural elements adjacency matrix

 

 

Side effect z-Score Average distance P-value
(canvas) (direct) (direct)
Pancreatitis — 3.188 0.768 >0.0001
Coma —3.157 0.772 0.002
Cardiac arrest —3.0 1 8 0.676 0.0127
Neuropathy —3.002 0.567 0.0311
Anxiety —2.999 0.825 0.0003
Pneumonia —2.768 0.579 0.0197
Depression —2.648 0.893 0.0001
Bradycardia —2.5 1 3 0.606 0.0232
Weight gain —2.504 0.762 0.0036
Sleeplessness —2.432 1.000 0.0003
Bronchospasm —2.3 0.618 0.108
Hypoglycemia —2.279 0.621 0.0034
Leukopenia —2.279 0.632 0.0002

 

Note: The ﬁrst column provides the z—score computed on the canvas as described in
the method. The second column is the average distance between enriched terms on
the drug structural element adjacency matrix. The third column is a P—value that
examines the difference between the observed distance and the expected mean dis—
tance. The expected mean distance is computed as the average distance for the same
number of, but randomly selected, structural elements from the drug structural
element adjacency matrix.

human eye, condensing information into a colorful View of
intuitive signatures.

3.4 Application of N2C to identify and visualize
links between drug-induced side effects and
chemical structure

Using the drug-set libraries created from FAERS, we ran the
N2C enrichment analysis to identify the level of clustering of
drug lists linked to 48 severe side effects on the drug chemical
structure canvas. The hypothesis is that if drugs that are asso-
ciated with a speciﬁc side effect are clustered on the drug-struc-
ture canvas, there might be a connection between drug structure
and the side effect. Interestingly, for 18 of the 48 side effects, we
Observed signiﬁcant clustering (z score>2.0) (Tables 2 and
Supplementary Table S1, first column). This means that for
18 side effects there are common structural elements that are
predictive of potential side effects. For the top three side
effectsazardiac arrest, coma and pancreatitisiwe display the
drug canvas signatures (Fig. 6). The cardiac arrest and coma
canvases share some structural elements, whereas the pancreatitis
side effect canvas displays a completely different cluster of drugs
with similar structures. Because the canvas Visualization of the
drugwlrug association networks involves information loss due to
the two-dimensional constraint and annealing process, we also
examine the ability to associate side effects and structural elem-
ents directly from the adjacency matrices before the annealing.
This was done to compare the level of information loss and to see
whether the ranking of side effects is significantly altered. We
computed the average network distance between structural elem-
ents for enriched side effects (P<0.05 without correction) to

CH3AACH2A CHZQCHZ

QCH3 cmcic AMA» NCO N=A c=N NAAAN

7MRING AINSA (MUG

Pancreatitis NAN/

 

Cardiac Arrest CH3ACH2AQCH3 CHZQCHZ C-N Coma

Fig. 6. Canvas for the 128 structural elements, also called Molecular
ACCess System (MACCS) keys, using the P-value View in N2C show
enrichment for MACCS keys for drug lists associated with the side effects
Of cardiac arrest, coma and pancreatitis

Obtain a new ranked list of side effects that share related struc-
tural elements (Tables 2 and Supplementary Table S1, second
and third columns). Although the two methods produce slightly
different ranking of side effects, it is surprising that such a large
majority of severe side effects can be predicted based on common
structural elements by both methods. This may be important for
in silico toxicity surveillance and for future drug design.
Although quantitative structureeactivity relationship models
have been shown to mostly fail in the past in predicting most
severe side effects, these initial drug enrichment results indicate
that there may be useful information in approaching the problem
in a slightly different angle as was done here. On the other hand,
the methods used here to compute the relationship between
structural elements and side effects can be improved in many
ways, including better computation of expected distributions
and better consideration of weights of enriched terms on the
canvas.

4 DISCUSSION AND CONCLUSIONS

N2C provides an alternative method to Visualize large networks
and perform enrichment analyses. Although the approach is cap-
able Of condensing information, the projection of a high-dimen-
sional Object onto a two-dimensional canvas does cause
signiﬁcant information loss. This is compensated with the ability
to better detect clusters from the network data by eye. However,
it should be noted that the annealing approach may not reach
the best possible ﬁtness and may result in different layouts for
the same input networks. The application of N2C to gene-set
libraries currently only provides Visualization of termiterm
libraries, but future applications can use the same approach to
display all human or mouse genes. Seeing how groups of genes
become active /inactive or expressed/ silenced in different cell lines
and conditions directly on such canvases may be illuminating. In
addition, because each cell type has a unique expression signa-
ture and during development or disease there are transitions
between cell types and cell phenotypes, movies of either enriched
terms or clusters of genes can be created. The N2C approach and
web-based tool generate Visually appealing enrichment analysis
signatures from sets of differentially expressed genes. Such
signatures can be applied in high-throughput to datasets that
profiled many conditions or many patients to detect patterns
across large datasets (Duan et al., 2013). Instead of Visualizing
the enriched terms for one list, the canvas can be used to display

 

1 877

112 /3.10's112u.1n0[p.101x0"sotieulJOJHTOTq/ﬁduq 111011 pap1201u/IAOQ

9103 ‘0g isnﬁnv uo ::

C.M. Tan et al.

 

the accumulation of enriched terms for many lists as a two-
dimensional histogram.

The approach to link side effects to structural elements works
for some drugs and some side effects but not for most drugs and
side effects. A similar approach can be used to see if gene expres-
sion signatures induced by drugs can be predictive of side effects
or if structural elements can be predictive of beneficial indica-
tions for various diseases. If such connections can be made, new
drugs can be designed and tested by connecting structural elem-
ents to create novel drugs. The gene expression approach can be
used to detect potential side effects before these manifest in
patients.

Funding: This work is supported in part by NIH grants
R01 GM0983 16, R01DK088541, U54HG006097-02S1,
P50GM071558 and the Irma T. Hirschl Career Scientist Award.

Conflict of Interest: none declared.

REFERENCES

Ashburner,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology.
Nat. Genet., 25, 25.

Bader,G.D. and Hogue,C.W. (2003) An automated method for ﬁnding molecular
complexes in large protein interaction networks. BMC Bioinformatics, 4, 2.
Barabasi,A.L. and Albert,R. (1999) Emergence of scaling in random networks.

Science, 286, 50%512.

Barretina,J. et al. (2012) The cancer cell line encyclopedia enables predictive
modelling of anticancer drug sensitivity. Nature, 483, 6037607.

Bastian,M. et al. (2009) Gephi: an open source software for exploring and manip—
ulating networks. In: International AAAI conference on weblogs and social media.
Vol. 2, AAAI Press, Menlo Park, CA.

Batagelj,V. and Mrvar,A. (1998) Pajek—program for large network analysis.
Connections, 21, 47757.

Bernstein,B.E. et al. (2010) The NIH roadmap epigenomics mapping consortium.
Nat. Biotechnol, 28, 104571048.

Bostock,M. et al. (2011) D3: Data—driven documents. IEEE Trans. Vis. Comput.
Graph., 17, 230172309.

Breitkreutz,B.J. et al. (2003) Osprey: a network visualization system. Genome Biol.,
4, R22.

Cao,Y. et al. (2008) ChemmineR: a compound mining framework for R.
Bioinformatics, 24, 173371734.

Chen,E.Y. et al. (2012) Expression2Kinases: mRNA proﬁling linked to multiple
upstream regulatory layers. Bioinformatics, 28, 1057111.

Chew,J.L. et al. (2005) Reciprocal transcriptional regulation of Pou5f1 and Sox2
via the Oct4/Sox2 complex in embryonic stem cells. Mol. Cell. Biol., 25,
603176046.

Clark,N.R. et al. (2012) Sets2Networks: network inference from repeated observa—
tions of sets. BMC Syst. Biol., 6, 89.

Clark,P.J. and Evans,F.C. (1954) Distance to nearest neighbor as a measure of
spatial relationships in populations. Ecology, 35, 4454153.

Culhane,A.C. et al. (2010) GeneSigDB a curated database of gene expression
signatures. Nucleic Acids Res., 38, D71(rD725.

Dogrusoz,U. et al. (2006) PATIKAweb: a web interface for analyzing biological
pathways through advanced querying and visualization. Bioinformatics, 22,
37¢375.

Duan,Q. et al. (2013) Meta—signatures identify two major subtypes of breast cancer.
CPT Pharmacometrics Syst. Pharmacol, 2, e35.

Ellson,J. et al. (2002) Graphviz open source graph drawing tools. In: Graph
Drawing. Springer, Berlin Heidelberg, pp. 59¢597.

Hu,Z. et al. (2004) VisANT: an online visualization and analysis tool for biological
interaction data. BMC Bioinformatics, 5, 17.

International AAAI conference on weblogs and social media. Vol. 2. Menlo Park,
CA: AAAI Press, 2009.

Ito,T. et al. (2001) A comprehensive two—hybrid analysis to explore the yeast protein
interactome. Proc. Natl Acad. Sci. USA, 98, 456974574.

Ivanova,N. et al. (2006) Dissecting self—renewal in stem cells with RNA interference.
Nature, 442, 5337538.

Jeong,H. et al. (2000) The large—scale organization of metabolic networks. Nature,
407, 651$54.

Kassel,C. and Turaev,V. (1995) Chord diagram invariants of tangles and graphs.
Institut de Recherche Mathématique avancée, Université Louis Pasteur et
CNRS (URA 01).

Kim,J.B. et al. (2009) Direct reprogramming of human neural stem cells by OCT4.
Nature, 461, 649$53.

Kuhn,M. et al. (2010) A side effect resource to capture phenotypic effects of drugs.
Mol. Syst. Biol., 6, 343.

Lachmann,A. and Ma’ayan,A. (2009) KEA: kinase enrichment analysis.
Bioinformatics, 25, 684w686.

Lachmann,A. et al. (2010) ChEA: transcription factor regulation inferred from
integrating genome—wide ChIP—X experiments. Bioinformatics, 26, 243872444.

Lamb,J. et al. (2006) The Connectivity Map: using gene-expression signatures
to connect small molecules, genes, and disease. Science, 313, 192971935.

Lee,I. et al. (2004) A probabilistic functional network of yeast genes. Science, 306,
155571558.

Liberzon,A. et al. (2011) Molecular signatures database (MSigDB) 3.0.
Bioinformatics, 27, 173971740.

Ma’ayan,A. et al. (2005) Formation of regulatory patterns during signal propaga—
tion in a mammalian cellular network. Science, 309, 107871083.

Ma’ayan,A. et al. (2007) Network analysis of FDA approved drugs and their
targets. Mt. Sinai J. Med, 74, 27732.

MacArthur,B.D. et al. (2009) Systems biology of stem cell fate and cellular repro—
gramming. Nat. Rev. M0]. Cell Biol., 10, 6727681.

MacArthur,B.D. et al. (2010) GATE: software for the analysis and visualization of
high—dimensional time series expression data. Bioinformatics, 26, 1437144.

Maere,S. et al. (2005) BiNGO: a Cytoscape plugin to assess overrepresentation of
gene ontology categories in biological networks. Bioinformatics, 21, 344873449.

Merico,D. et al. (2010) Enrichment Map: a network—based method for gene—set
enrichment visualization and interpretation. PLoS One, 5, e13984.

Milo,R. et al. (2002) Network motifs: simple building blocks of complex networks.
Science, 298, 824w827.

Ogata,H. et al. (1999) KEGG: Kyoto encyclopedia of genes and genomes. Nucleic
Acids Res., 27, 29734.

Rosenbloom,K.R. et al. (2012) ENCODE whole—genome data in the UCSC
Genome Browser: update 2012. Nucleic Acids Res., 40, D9127D917.

Salgado,H. et al. (2013) RegulonDB v8.0: omics data sets, evolutionary conserva—
tion, regulatory phrases, cross—validated gold standards and more. Nucle‘u' Acids
Res., 41, D2037D213.

Shannon,P. et al. (2003) Cytoscape: a software environment for integrated models
of biomolecular interaction networks. Genome Res., 13, 249872504.

Sherman,B.T. and Lempicki,R.A. (2009) Bioinformatics enrichment tools: paths
toward the comprehensive functional analysis of large gene lists. Nucleic Acids
Res., 37, 1713.

Shneiderman,B. and Wattenberg,M. (2001) Ordered treemap layouts. In:
Proceedings of the IEEE Symposium on Information Visualization 2001.
(Vol. 73078).

Skellam,J. (1952) Studies in statistical ecology: 1. Spatial Pattern. Biometrika,
34(r362.

Subramanian,A. et al. (2005) Gene—set enrichment analysis: a knowledge—based
approach for interpreting genome—wide expression proﬁles. Proc. Natl Acad.
Sci. USA, 102, 15545715550.

Tatonetti,N.P. et al. (2012) A novel signal detection algorithm for identifying hidden
drug—drug interactions in adverse event reports. J. Am. Med. Inform. Assoc., 19,
79785.

Watts,D. and Strogatz,S. (1998) The small world problem, collective dynamics of
small—world networks. Nature, 393, 440—442.

Wiese,R., Eiglsperger,M. and Kaufmann,M. (2004) yﬁlesivisualization and auto—
matic layout of graphs. In: Graph Drawing Software. Springer, Berlin
Heidelberg, pp. 1737191.

Wishart,D.S. et al. (2006) DrugBank: a comprehensive resource for in silico drug
discovery and exploration. Nucleic Acids Res., 34, D6687D672.

 

1 878

112 /310'S[BIIJHO[pJOJXO'SOIJBLUJOJIIIOICI”K1111] uteri papeolumoq

91oz ‘Og isanV uo ::

