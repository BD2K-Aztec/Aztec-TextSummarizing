BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

K.Jeong et al.

 

algorithm, ADEPTS, for CID/ ETD spectral pairs. Given a CID/
ETD spectral pair, ADEPTS first ﬁnds 1000 candidate de novo
sequences from each spectrum, using PEAKS. The total 2000
candidate sequences are then rescored against the input spectral
pair, and the best—scoring peptide is reported.

While the above tools perform well for the spectra generated
from the fragmentation method(s) that each tool targeted, they
often generate inferior results for the spectra from other frag—
mentation methods. Moreover, if alternative proteases (e. g. LysC
or AspN) are used for protein digestion, these tools may produce
suboptimal results because different proteases often generate
peptides with different fragmentation characteristics (Kim
et al., 2010).

In case of the database search approach, Kim et a1. (2010)
recently introduced a universal algorithm MS—GFDB
that shows a signiﬁcantly better peptide identiﬁcation per—
formance than other existing database search tools such as
Mascot+Percolator (Kall et al., 2007; Perkins et al., 1999).
However, a universal de novo sequencing tool is still missing.

We present UniNovo, a universal de novo sequencing tool
that can be generalized for various types (i.e. the combinations
of the fragmentation method and the protease used to digest
sample proteins) of spectra. The scoring function of UniNovo
is easily trainable using a training dataset consisting of thou—
sands of annotated spectra. All information needed for de novo
sequencing are learned from the training dataset, and the run—
ning time for training is <5h in a typical desktop environ—
ment. Currently, UniNovo is trained for CID, HCD and ETD
spectra of trypsin, LysC or AspN digested peptides. We show
that the performance of UniNovo is better than or comparable
with PepNovo+, PEAKS and pNovo for various types of
spectra.

One of the biggest challenges in de novo sequencing is to esti—
mate the error rate of the resulting de novo reconstructions.
Unlike MS/MS database search tools that commonly uses the
target—decoy approach (Elias and Gygi, 2007; Nesvizhskii, 2010)
to estimate the statistical signiﬁcance of the peptide identiﬁca—
tions, de novo reconstructions have rarely been subjected to a
statistical signiﬁcance analysis in the past.

Several de novo sequencing tools report the error rate of amino
acid predictions (e.g. confidence scores in PEAKS), but this is
often not sufﬁcient because the overall quality of the sequence
cannot be easily determined by the error rates of individual
amino acid predictions. To our knowledge, only PepNovo+ re—
ports the empirical probability that the output peptide is correct.
PepNovo+ predicts the probabilities using logistic regression
with multiple features of the reconstructions such as length and
score, which are extracted from a training dataset consisting of
hundreds of thousands of annotated spectra (Frank, 2009).
However, PepNovo+ does not include an automated training
procedure (that would allow to easily extend PepNovo+ for
newly emerging mass spectrometry approaches) and is currently
trained only for CID [Extending PepNovo+ beyond CID spectra
requires training complex boosting—based re—ranking models for
predicting peak ranks and rescoring peptide candidates.
PepNovo+ training includes several manual steps and the avail—
ability of a very large corpus of training spectra (Ari Frank,
personal communication, October 5, 2012)]. Thus, in case of

non—CID fragmentation methods, it remains unclear how to
obtain accurate error rate estimation for de novo reconstructions.

UniNovo estimates the probability that each reported recon—
struction is correct, using simple statistics that are readily ob—
tained from a small training dataset. We demonstrate that the
estimation is accurate for all tested types of spectra (including
CID, HCD, ETD, CID/ETD and HCD/ ETD spectra of trypsin,
LysC or AspN digested peptides). This allows UniNovo to auto—
matically ﬁlter out low quality spectra.

2 METHODS

Similar to Kim et al. (2009a), we ﬁrst describe the algorithm on a
simpliﬁed model that assumes the following:

o the masses of amino acids are integers (e.g. the mass of Gly is 57).
o the m/z (mass to charge ratio) of peaks (in spectra) are integers.
o the intensity of all peaks is 1.

0 only N-terminal charge 1 ions are considered (e.g. b, c, or b — H20
ions, but not y-ion series).

o the parent mass (the mass of the precursor ion) of a spectrum equals
to the mass of the peptide that generated the spectrum.

While such a simpliﬁed model is impractical, we chose to introduce our
algorithm on this model for better understanding of the algorithm on a
more complex and realistic model. The algorithm on a more realistic
model is described in the Supplementary section S2.

2.1 Terminology and deﬁnitions

Let A be the set of amino acids with (integer) masses m(a) for a e A. A
peptide a1 a2 - - - at is a sequence of amino acids, and the mass of a peptide
is the total mass of amino acids in the peptide. We represent a peptide
alaz - --a,‘. with mass n by a Boolean vector P = (P1, ...,P,,), where

P,» = 1 if i = ia, for 0<j<k, and P,» = 0 otherwise. If P,» = 1, we call
(:1

a mass i a fragmentation site. For example, suppose there are two amino

acids A and B with masses 2 and 3, respectively. Then, the peptide ABBA

has the mass of 2 + 3 + 3 +2 2 10 and is represented by a Boolean

vector (0,1,0,0,1,0,0,1,0,0). The fragmentation sites of this peptide are,

thus, 2, 5 and 8.

A spectrum is a list of peaks, where each peak is speciﬁed by an m/z.
We represent a spectrum of parent mass n by a Boolean vector
S=(S1, ...,S,,), where S,» :1 if the peak of m/z i (or simply the
peak 1) is present and S,» = 0 otherwise (Representing peptides and spec-
tra as vectors allows us to represent the generation of spectra from pep-
tides by simple vector operations).

A peptide-spectrum match (PSM) is a pair (P, S) formed by a peptide
P and a spectrum S. Given an integer 8 called an ion type and a PSM
(P, S), we say a peak i is a 8-ion peak (with respect to P) if i— 8 is a
fragmentation site, that is, PH; 2 1. In this model, the ion type can be
any integer. In the connection to the experimental MS/MS spectra, ion
types can represent common singly charged N-terminal ions; for example,
the ion types 1 and —27 represent b and a ions, respectively.

Given an integer f called a feature and a spectrum S, we say that a peak
i satisfies f if another peak i + f is present in the spectrum, that is,
SH) 2 1. For instance, a peak 30 satisﬁes a feature f = —18, if
S3043 = 1. In experimental spectra, various ions are often observed
along with neutral losses (e.g. b-ion and b — HZO-ion) or with related
ions (e.g. b-ion and a-ion). A feature describes the relation (the shift of
m/z values in this simpliﬁed model) between two peaks that may corres-
pond to a neutral loss or a mass gain/loss between related ions. For
example, since we are dealing with only charge 1 ions, a water loss

 

1 954

ﬁm'spzumofpmﬂo'sopeuuopnorq/ﬁdnq

UniNovo

 

1' Ion type matrix
PT(St : ylPI‘ : 1)

  
 

Feature-ion type matrix
‘ Pr(SHf = ylPi = 135i = 1)

 

 

 Intensity _ _
v’ \\/—‘A/—‘A r' ‘x
1 f1 f2 f2 f1
0 mz
I | | I I I
I I I I I I
v v v t v v
f’PV:(  p0... p3...p2...p0  p0  p1 )

H | Pr(P,:1|S,: 1 and 3H, : 1 for f e H)*

 

4’ P0
f1 p1
f2 P2
flaf2 P3

*po-ps are obtained by (1)

Fig. 1. (a) The generation of a partial-spectrum s for P,-. One ion type 8 = 0 and one feature f are considered. The probability that s,» = 1 is given by or if
P,» = 1 or by B otherwise. When s,» = 1, the probability that s,»+f = 1 (i.e., the peak i satisﬁes f) is given by u if P,» = 1 or by v otherwise. The spectrum is
generated by taking elementwise OR operation for generated partial-spectra for all elements of P. (b) The calculation of the fragmentation probability
vector 7373)} from a spectrum S (without knowing the peptide P that generated S). We consider one ion type 8 = 0 and two features f1 and f2. The events
‘a peak satisﬁes f 1’ and ‘a peak satisﬁes fz’ are assumed to be independent. To derive 737312,», ﬁrst we examine which features the peak i satisﬁes in the
spectrum S. Denote the features the peak i satisﬁes by H. Second, given H, we calculate the probability that P,» = 1 [using the probabilities given in ion

type matrix and feature-ion type matrixisee the equation (1)]

(from any ions) is represented by the feature f = —18, and the mass gain
from a-ion to b-ion is represented by the feature f = +27. The possible
interpretations of selected features are found in Supplementary Tables
S57S37 in the Supplementary section S12.

2.2 Peptide-spectrum generative model

We model how a peptide P of mass n generates a spectrum S. Apart from
a l-step generative model in Bandeira et a]. (2008) or Kim et al. (2009a),
we introduce a more adequate 2-step probabilistic model in which the
dependency between different ions can be described.

Assume that we are given the set of ion types (the ion type set A) and
the set of features (the feature set F). For simplicity, we consider the case
where only one ion type 8 = 0 is in A and one feature f is in F. Given a
peptide P, a partial-spectrum s is generated per each element P,- of P as
follows: The probability that s,» = 1 is given by or if P,» = 1 or by B other-
wise (the ﬁrst generation step). This ﬁrst step can be characterized by a
2 X 2 matrix called the ion type matrix (Fig. 1). When s,» = 1, the prob-
ability that s,»+f = 1 (i.e. the peak i satisﬁesf) is given by u if P,» = 1 or v
otherwise (the second generation step). The second step is characterized
by the feature-ion type matrix (Fig. 1) (Given s,» = 0, the probability that
s,»+f = 1 is assumed to be 0.). The second step can describe the depend-
ency between different ions (or an ion and its neutral loss) from the same
fragmentation site. If multiple ion types and multiple features are con-
sidered, the ion type matrix should be deﬁned per ion type, and the
feature-ion type matrix per ion type and per feature. The spectrum S is
generated by taking elementwise OR operation for the generated partial-
spectra s.

2.3 Training UniNovo

Since the ion type matrices and feature-ion type matrices fully describe
the generation of a spectrum, in the training step, UniNovo learns these
matrices from the training dataset (a set of PSMs). To deﬁne these matri-
ces, the ion type set A and the feature set F should be formed. Using the
offset frequency function introduced in Dancik et a]. (1999), we collect
frequently observed ion types and form the ion type set A. To form the
feature set F, we deﬁne the feature frequency function with which one can
count how many times each possible feature is observed in the training
dataset (see the Supplementary section S1.2). Using the feature frequency
function, we collect frequently observed features and form the feature set

F. From here on, we only consider ion types in the ion type set A and
features in the feature set F.

Next UniNovo learns the ion type and feature-ion type matrices that
characterize the generative model of the PSMs in the training dataset. For
example, or = Pr(s,» 2 HP,» 2 1) can be empirically determined if partial-
spectra s are given. However, it is not clear how to decompose a spectrum
S into partial-spectra s (since partial spectra may share peaks in the
spectrum). As a compromise, we learn Pr(S,» 2 HP,» 2 1) for estimation
of or. Other probabilities are also empirically determined similarly by
substituting the partial-spectra by the spectrum.

We emphasize that all the above probabilities can be learned from a
small set of PSMs (e. g. 5000 PSMs per charge state are often sufﬁcient to
avoid overﬁtting; see the Supplementary section S15) even if there are
many ion types in A and features in F because each probability is asso-
ciated to an individual ion type or a combination of an ion type and a
feature, not a combination of multiple ion types and multiple features.

Lastly, we compute the probability that a random element of a peptide
vector is a fragmentation site, i.e., Pr(P,» = 1) [When masses of amino
acids are rounded to integers, Pr(P,» = 1) a  However, if we consider
more accurate amino acid masses (for the spectra of high resolution), this
probability should be learned from the training dataset]. This probability
is called the prior fragmentation probability and denoted by p. The de-
tailed description of UniNovo training is given in the Supplementary
section S1.

2.4 How to infer fragmentation sites from a spectrum

Given a spectrum S of parent mass n, our goal is to predict the frag-
mentation sites of the (unknown) peptide P that generated S. For
simplicity, assume that there exists a single ion type 8 = 0 is in the ion
type set A (but multiple features in the feature set F). Given a peak i,
deﬁne H as the set of features that the peak i satisﬁes. Then the fragmen-
tation sites are predicted by solving the following Bayesian inference
problem.

Fragmentation inference problem: Given the set of features H and P,-
such that Pr(P,» = 1) = p (the prior fragmentation probability), derive the
posterior probability Pr(P,» 2 HS,» 2 SH) 2 1 for f e H).

Since we assumed that there is only one ion type, we have only one ion
type matrix. On the other hand, per each feature we have a feature-
ion type matrix. Let u) and v) denote a and v associated to the fea-
ture f, respectively. If we can assume that all features are independent

 

1 955

ﬁre'spzumofpmﬂo'sopeuuopuorq/ﬁdnq

K.Jeong et al.

 

(i.e., the events ‘S,» 2 SH) 2 1 forf’ are independent for fe H), we
obtain

r H W
.teH

Pr‘(P,»=1|S,»= s, =1forfe H) =—.
H rl—[Mr+(1—r)l_lvr
.feH .teH

(1)

where y = Pr(P,» 2 HS,» 2 1) =  (see the Supplementary section
S3 for derivation). Denote the obtained probability in (1) as 71,». We deﬁne
a fragmentation probability vector (7373);) as a vector with n elements

such that

TI, 

fpvi = { 0 otherwise

(2)
for i: 1, ...,n — 1, and 7:73))" :21 (see Fig. 1b). 7:73)}, is an estimated
probability that P,» = 1 (see Supplementary Figs S3 and S4, blue bars).
We use 7373)} for the generation of de novo reconstructions.

The equation (1) is based on a simpliﬁed model in which a single one
ion type and multiple independent features are used. However, some
features are known to be strongly dependent on each other (e.g. a feature
describing a single water loss and a double water losses), and usually
multiple ion types are present in the ion type set. Thus, in practice, per
each peak, UniNovo automatically selects a small number of features
(<10 out of thousands of features in the feature set) that are weakly
correlated yet effective to determine the ion type of the peak. Assuming
that the selected features are mutually independent, 7:73)} is calculated
per ion type using the equation (1), and then the ﬁnal 7:73)} is given by a
weighted summation of the 7: 7312’s of different ion types. Note that there
are many possible combinations of features due to the large number of all
the features in the feature set (even if the number of the features to cal-
culate 7373)} per peak is <10). Since different combinations of features are
selected for different peaks, UniNovo is able to use more diverse relations
between different ions as compared with other tools that typically use
ﬁxed dependencies between ions (e.g. PepNovo). The detailed description
and an example of the feature selection method and the calculation of
7373)} are given in the Supplementary section S3.

2.5 Generating de novo reconstructions

To generate de novo reconstructions, we ﬁrst construct a spectrum graph
(Dancik et al., 1999). Given a spectrum S of parent mass n from an
unknown peptide P, the spectrum graph G( V, E) is deﬁned as a directed
acyclic graph whose vertex set V consists of 0 (the source), n (the sink)
and integers i such that fPV,>0. Two vertices i and j are connected by
an edge (i, j) if j 7 i equals to the mass of an amino acid or the total mass
of multiple amino acids (a mass gap). Any path from 0 (the source) to n
(the sink) in a spectrum graph corresponds to a peptide (possibly con-
taining mass gaps). We say that a vertex i is correct if P,» = 1 and an edge
(i, j) is correct if both vertices iand j are correct. We also say that a path r
is correct if all vertices in r are correct. The length of a reconstruction is
deﬁned by the total number of amino acids and mass gaps in the
reconstruction.

To score a de novo reconstruction, we use an additive (i.e., the score of
a path is the sum of scores of vertices of the path) log likelihood ratio
scoring [similar to Dancik et al. (1999)]. Given a vertex i, let 7373)}, = X.
The likelihoods of the following two hypothesis for the outcome
7373)}, = X are tested: (i) the vertex i is correct and (ii) the vertex i is
incorrect. Let Pr(P,» = 1|]:73V,» = X) = X. Then, we have

£(P,=llfPV,=X)_Pr‘(f73V,=X|P,=l)_ X l—p

_ _ .—. 3
£(P,=0|]-‘7>V,»=X) Pr‘(]-‘73V,»=X|P,»=0) 1—x p U

 

The score of the vertex i with 7373)}, = X is deﬁned by
Score(i) :=[log1+'X-1%p] where H denotes the rounding to the nearest
integer. Given a path r, the score of the path r is deﬁned by Z Score(i).

[er

Since an additive scoring is used, top scoring reconstructions can be
efﬁciently generated using a dynamic programming as in Dancik et al.
(1999). We did not exclude symmetric paths in the spectrum graph that
usually correspond to incorrect reconstructions. Considering only the
antisymmetric paths would further enhance the performance of
UniNovo (Chen et al., 2001).

After generating the reconstructions, a probability that each recon-
struction is correct (termed the accuracy of the reconstruction) is pre-
dicted, using Hunter’s bound (Hunter, 1976) (see the Supplementary
section S4 for the deﬁnition of the accuracy of reconstructions).
Hunter’s bound can be calculated from relatively simple statistics that
are readily learned from a small set of PSMs (about 5000 PSMs).
Supplementary Figures S2 and S3 (green bars) in the Supplementary
section S9 show that the accuracy of a reconstruction is a conservative
estimate of the empirical probability of the reconstruction being correct.

3 RESULTS

3.1 Datasets

To benchmark UniNovo, we used 13 different datasets with di—
verse fragmentation methods (CID/ETD/HCD), digested with
diverse proteases (trypsin, LysC and AspN), and having diverse
charge states (see Table 1). We re—analyzed the spectral datasets
(original datasets) from Albert Heck’s and Joshua Coon’s labora—
tories that were previously analyzed in Kim et al. (2010), Swaney
et al. (2010) and Frese et al. (2011). The CID and ETD spectra in
these original datasets were acquired in a hybrid linear ion trap/
Orbitrap mass spectrometers (high MS1 resolution and low MS2
resolution). The HCD spectra have high MS1 and MS2 reso—
lution. All spectra in the original datasets were identified by
MS-GFDB (ver. 01/06/2012) (Kim et al., 2010) at 1% peptide-
level FDR without allowing any modification except the carba—
midomethylation of Cys (C+ 57) as a ﬁxed modiﬁcation [In the
Supplementary section S13, we also re—analyzed the dataset
reported in Kim et al. (2009b) that contains doubly charged
CID spectra identified using Sequest (Eng et al., 1994) and
PeptideProphet (Keller et al., 2002).]. Out of all identiﬁed spec—
tra, we selected 1000 spectra (or pairs of spectra) from distinct
peptides randomly and formed the 13 datasets listed in Table 1.
The unselected identiﬁed spectra (about 5000 to 20 000 spectra
depending on the type of spectra) were used for the training of
UniNovo. The peptide contained in the training dataset were not
contained in the above 13 datasets. See the Supplementary sec—
tion S10 for the detailed description of these datasets.

3.2 Benchmarking UniNovo

We benchmarked UniNovo, PepNovo+ (ver. 3.1 beta) (Frank,
2009), PEAKS (ver. 5.3, online) (Ma et al., 2003) and pNovo
(ver. 1.1) (Chi et al., 2010) using the datasets in Table 1. For each
tool, we generated N de novo reconstructions per each spectrum
for N: 1, 5 and 20. We say that a spectrum is correctly
sequenced if at least one of N reconstructions generated from
the spectrum is correct. To evaluate the performance of each
tool, the number of correctly sequenced spectra and the average
length of correct reconstructions were measured for each tool
(Since mass gaps are allowed for reconstructions, often multiple
correct reconstructions were reported for a spectrum. To calcu—
late the average length of correct reconstructions, only the top
scoring correct reconstruction was counted per a spectrum.).

 

1956

ﬁre'spzumofpmﬂo'sopeuuopuorq/ﬁdnq

UniNovo

 

Table 1. Summary of the datasets used for benchmarking

 

 

Dataset CID2 CIDL2 CIDA2 ETD2 ETD3 ETDL3 ETDL4 ETDA3 ETDA4 HCD2 HCD3 CID /ETD2 CID/ETD3
Fragmentation CID CID CID ETD ETD ETD ETD ETD ETD HCD HCD CID /ETD CID/ ETD
Charge 2 2 2 2 3 3 4 3 4 2 3 2 3
Enzyme Tryp LysC AspN Tryp Tryp LysC LysC AspN AspN Tryp Tryp Tryp Tryp
Average pep. 12.6 11.4 12.3 12.5 16.4 12.5 18.7 12.8 18.9 10.5 14.5 12.3 17.1

length
UniNovo * * * * * * * * * * * *
PepNovo+ * * * N/A N/A N/A N/A N/A N/A * * N/A N/A
pNovo N/A N/A N/A N/A N/A N/A N/A N/A N/A * * N/A N/A

 

Note: Number of spectra (or spectral pairs) is 1000 for each dataset. While UniNovo is applicable to all datasets, other tools are only applicable to (or optimized for) datasets

marked by ‘*’. PEAKS was not tested for HCD datasets.

For UniNovo, the maximum number of mass gaps in a recon—
struction was set to 2. UniNovo was tested for all datasets. For
PepNovo+, also N top scoring reconstructions were generated
per spectrum. PepNovo+ was used for CID2, CIDL2, CIDA2,
HCD2 and HCD3 datasets. In case of PEAKS, we ﬁrst gener—
ated 500 top scoring reconstructions per each spectrum. Then,
for each reconstruction we converted amino acids with the local
conﬁdence <30% into mass gaps. Such conversion is adopted
because PEAKS generates reconstruction without mass gaps
while UniNovo and PepNovo+ generate reconstructions with
up to two mass gaps. In this procedure, multiple reconstructions
without mass gaps were often converted into the same recon—
struction with mass gaps. The score of a converted reconstruc—
tion is deﬁned as the highest score of the reconstructions before
conversion. Out of the converted reconstructions, N top high
scoring (distinct) ones were chosen and used for further analysis.
PEAKS was tested for all datasets except for HCD2 and HCD3
datasets. For pNovo, N top scoring reconstructions were gener—
ated per a spectrum (pNovo also generates reconstructions with—
out mass gaps. However, the conversion of reconstructions as in
PEAKS could not be applied to pNovo because pNovo does not
report any local score.). Only HCD2 and HCD3 datasets were
analyzed by pNovo. The parameters of each tool for each dataset
is provided in the Supplementary section S8.

We also indirectly compared UniNovo with MS—GFDB (Kim
et al., 2010), as both tools were developed to analyze diverse
types of spectra. We replaced the scoring function of UniNovo
with that of MS—GFDB and generated reconstructions using the
replaced scoring method. More precisely, the spectrum graph
was generated by MS—GFDB per each spectrum, and the recon—
structions were generated by UniNovo on that spectrum graph
(instead of the spectrum graph generated by UniNovo). This
generation method is speciﬁed by MS—GFDBScore. All experi—
mental parameters for MS—GFDBScore were the same as for
UniNovo.

Figure 2 shows the comparison results for different datasets.
UniNovo found the largest number of correctly sequenced
spectra among all the tested tools in most datasets. In particu—
lar, for ETD spectra, UniNovo reported signiﬁcantly more
correctly sequenced spectra than PEAKS. For example, in

case of ETD2 or ETDL4 dataset, the number of correctly
sequenced spectra was more than twice for UniNovo than
for PEAKS.

For CID spectra, UniNovo and PepNovo+ showed similar
results. When N: 1, UniNovo and PepNovo+ found about
the same number of correctly sequenced spectra in CID2 and
CIDL2 datasets, but UniNovo found about 35% more correctly
sequenced spectra than PepNovo+ in CIDA2 dataset.

While trypsin and LysC—digested peptides generate the spectra
of similar fragmentation characteristics, AspN—digested peptides
generate spectra with distinct fragmentation propensities.
UniNovo worked well with AspN—digested peptides, but
PepNovo+ showed suboptimal results for the spectra of
AspN—digested peptides [Training of the parameters for the
Bayesian network of PepNovo (Frank and Pevzner, 2005) for
the CID spectra of AspN— or LysC—digested peptides would lead
to better results; however, as mentioned above, the re—ranking
models of PepNovo+ (Frank, 2009), which are crucial for the
superior performance of PepNovo+ for CID tryptic spectra (see
the Supplementary section S14), cannot be readily trained.]. The
length of correct reconstructions for PepNovo+ was slightly
longer than for UniNovo.

The results on HCD spectra also demonstrate that UniNovo
ﬁnds the largest number of correctly sequenced spectra in gen—
eral. The reconstructions reported by pNovo were, however,
longer than those by UniNovo (and PepNovo+) by two to
three amino acids. This suggests that UniNovo still has room
for improvement for HCD spectra (e.g. introducing features
better reﬂecting the high mass resolution and information from
immonium or internal ions).

The results from UniNovo were superior to MS—GFDBScore
in both terms of the number of correctly sequenced spectra and
the average length of the correct reconstructions in all datasets.

For each dataset, we drew the Venn diagrams of the correctly
sequenced spectra (Fig. 3 and Supplementary Figs S&S12) to
see the overlaps of the spectra between different tools. For all
datasets, the overlaps between different tools increase as N
grows, as expected. Relatively small overlaps are observed for
ETD spectra (as compared with CID or HCD spectra). It indi—
cates that UniNovo may have been using some valuable features

 

1 957

ﬁre'spzumofpmﬂo'sopauuopuotq/ﬁdnq

UniNovo

PepNovo+
PEAKS

Nova
MS-GFDBSCcre

UniNovo

PepNovo+
PEAKS

pNovo
MS’GFDBScom

UniNovo
PepNovo+
PEAKS
pNovo
MS-GFDBSCore

UniNovo
PepNovo+
PEAKS

pNovo
MS’GFDBSCOP

UniNovo
PepNovo+
PEAKS

UniNovo
PepNovo+
PEAKS

pNovo
MS-GFDBScnre

 

/310's112u1n0fp10}x0"sotJButJOJutotqﬂ:duq

Ll mi N

._|PEAKS

leNmr
PEAKS

(i) HCD2 [[1:70]

HCD2 [i — l

UFINDVG

56

DPEAKS

EINovo

 

an?kgogmomammowoxmoagocgawbmﬁ

 

ll||||||| |||

CIN

EIN

 

/310's112u1n0fp10}x0"sotJButJOJutotqﬂ:duq

K.Jeong et al.

 

Breci,L.A. et al. (2003) Cleavage n—terminal to proline: analysis of a database of
peptide tandem mass spectra. Anal. Chem, 75, 196371971.

Chen,T. et al. (2001) A dynamic programming approach to de novo peptide sequen—
cing via tandem mass spectrometry. J. Comput. Biol, 8, 3257337.

Chi,H. et al. (2010) pNovo: de novo peptide sequencing and identiﬁcation using
HCD spectra. J. Proteome Res., 9, 271372724.

Dancik,V. et al. (1999) De novo peptide sequencing via tandem mass spectrometry.
J. Comput. Biol, 6, 3277342.

Datta,R. and Bern,M. (2009) Spectrum fusion: using multiple mass spectra for
de novo peptide sequencing. J. Comput. Biol, 16, 116971182.

Elias,J.E. and Gygi,S.P. (2007) Target—decoy search strategy for increased conﬁ—
dence in large—scale protein identiﬁcations by mass spectrometry. Nat.
Methods, 4, 207714.

Eng,J.K. et al. (1994) An approach to correlate tandem mass spectral data of pep—
tides with amino acid sequences in a protein database. J. Am. Soc. Mass
Spectrom., 5, 97(r989.

Frank,A. (2009) A ranking—based scoring function for peptide—spectrum matches.
J. Proteome Res., 8, 224172252.

Frank,A. and Pevzner,P. (2005) PepNovo: de novo peptide sequencing via probabil—
istic network modeling. Anal. Chem, 77, 96¢973.

Frese,C.K. et al. (2011) Improved peptide identiﬁcation by targeted fragmentation
using CID, HCD and ETD on an LTQ—Orbitrap velos. J. Proteome Res., 10,
237772388.

He,L. and Ma,B. (2010) ADEPTS: advanced peptide de novo sequencing with a pair
of tandem mass spectra. J. Bioinform. Comput. Biol, 8, 9817994.

Huang,Y. et al. (2005) Statistical characterization of the charge state and residue
dependence of low—energy CID peptide dissociation patterns. Anal. Chem, 77,
580(k5813.

Hunter,D. (1976) An upper bound for the probability of a union. J. Appl. Probab.,
13, 5977603.

Jeong,K. et al. (2011) Gapped spectral dictionaries and their applications for data—
base searches of tandem mass spectra. Mol Cell. Proteomics, 10, M110.002220.

Johnson,R.S. et al. (1987) Novel fragmentation process of peptides by collision—
induced decomposition in a tandem mass spectrometer: differentiation of leucine
and isoleucine. Anal. Chem, 59, 262172625.

Kall,L. et al. (2007) Semi—supervised learning for peptide identiﬁcation from shot—
gun proteomics datasets. Nat. Methods, 4, 9237925.

Keller,A. et al. (2002) Empirical statistical model to estimate the accuracy of peptide
identiﬁcations made by ms/ms and database search. Anal. Chem, 74, 5383792.

Kersey,P.J. et al. (2004) The international protein index: an integrated database for
proteomics experiments. Proteomics, 4, 198571988.

Kim,S. et al. (2009a) Spectral dictionaries. Mol Cell. Proteomics, 8, 5%69.

Kim,S. et al. (2009b) Spectral proﬁles, a novel representation of tandem mass
spectra and their applications for de novo peptide sequencing and identiﬁcation.
Mol. Cell. Proteomics, 8, 139171400.

Kim,S. et al. (2010) The generating function of CID, ETD, and CID/ ETD pairs of
tandem mass spectra: Applications to database search. Mol Cell. Proteomics, 9,
284072852.

Liu,X. et al. (2010) Better score function for peptide identiﬁcation with ETD
MS/MS spectra. BMC Bioinformatics, 11 (Suppl. 1), S4.

Ma,B. and Johnson,R. (2011) De novo sequencing and homology searching. Mol
Cell. Proteomics, 01 1 1.014902.

Ma,B. et al. (2003) PEAKS: powerful software for peptide de novo sequencing by
tandem mass spectrometry. Rapid Commun. Mass Spectrom., 17, 233772342.

Nesvizhskii,A.I. (2010) A survey of computational methods and error rate estima—
tion procedures for peptide and protein identiﬁcation in shotgun proteomics.
J. Proteomics, 73, 20927123.

Ng,J. et al. (2011) Blocked pattern matching problem and its applications in prote—
omics. RECOMB 2011. Vancouver, Canada, pp. 2987319.

Olsen,J.V. et al. (2007) Higher—energy c—trap dissociation for peptide modiﬁcation
analysis. Nat. Methods, 4, 7097712.

Perkins,D.N. et al. (1999) Probability—based protein identiﬁcation by searching
sequence databases using mass spectrometry data. Electrophoresis, 20,
355173567.

Savitski,M.M. et al. (2005) Proteomics—Grade de novo sequencing approach.
J. Proteome Res., 4, 234872354.

Swaney,D.L. et al. (2008) Decision tree—driven tandem mass spectrometry for shot—
gun proteomics. Nat. Methods, 5, 9597964.

Swaney,D.L. et al. (2010) Value of using multiple proteases for Large—Scale mass
Spectrometry—Based proteomics. J. Proteome Res., 9, 132371329.

Tabb,D.L. et al. (2004) Inﬂuence of basic residue content on fragment ion peak
intensities in Low—Energy Collision—Induced dissociation spectra of peptides.
Anal. Chem., 76, 124371248.

Wysocki,V.H. et al. (2000) Mobile and localized protons: a framework for under—
standing peptide dissociation. J. Mass Spectrom, 35, 139971406.

Zubarev,R.A. et al. (2008) Electron Capture/Transfer versus collisionally
Activated/Induced dissociations: Solo or duet? J. Am. Soc. Mass Spectrom.,
19, 7537761.

 

1962

ﬁre'spzumofpmﬂo'sopauuopuotq/pdnq

