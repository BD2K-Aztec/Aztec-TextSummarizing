Bioinformatics, 31(21), 2015, 3514—3521

doi: 10.1093/bioinformatics/btv397

Advance Access Publication Date: 2 July 2015
Original Paper

 

Genetics and population analysis

A multivariate Bernoulli model to predict
DNasel hypersensitivity status from
haplotype data

Huwenbo Shi1'*, Bogdan Pasaniuc1'2'3'* and Kenneth L. Lange1'3'4

1Bioinformatics Interdepartmental Program, University of California, Los Angeles, 2Department of Pathology and
Laboratory Medicine, 3Department of Human Genetics and 4Department of Biomathematics, David Geffen School
of Medicine, University of California, Los Angeles, Los Angeles, CA 90024, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on February 17, 2015; revised on May 18, 2015; accepted on June 24,2015

Abstract

Motivation: Haplotype models enjoy a wide range of applications in population inference and dis—
ease gene discovery. The hidden Markov models traditionally used for haplotypes are hindered by
the dubious assumption that dependencies occur only between consecutive pairs of variants. In this
article, we apply the multivariate Bernoulli (MVB) distribution to model haplotype data. The MVB
distribution relies on interactions among all sets of variants, thus allowing for the detection and ex—
ploitation of long—range and higher—order interactions. We discuss penalized estimation and present
an efficient algorithm for fitting sparse versions of the MVB distribution to haplotype data. Finally,
we showcase the benefits of the MVB model in predicting DNasel hypersensitivity (DH) status—an
epigenetic mark describing chromatin accessibility—from population—scale haplotype data.

Results: We fit the MVB model to real data from 59 individuals on whom both haplotypes and DH
status in lymphoblastoid cell lines are publicly available. The model allows prediction of DH status
from genetic data (prediction R2 : 0.12 in cross—validations). Comparisons of prediction under the
MVB model with prediction under linear regression (best linear unbiased prediction) and logistic
regression demonstrate that the MVB model achieves about 10% higher prediction R2 than the two
competing methods in empirical data.

Availability and implementation: Software implementing the method described can be down—
loaded at http://bogdan.bioinformatics.ucla.edu/software/.

Contact: shihuwenbo@ucla.edu or pasaniuc@ucla.edu

 

1 Introduction

 

Accidents of history and variable recombination rates have divided
the human genome into blocks of shared recent ancestry (1000
Genomes Project Consortium et (11., 2010; Daly et (11., 2001; Gibbs
et (11., 2003). Ancestry sharing manifests itself in complex haplotype
patterns and strong dependencies among variants. |Recall that a
haplotype summarizes the sequence of alleles displayed by the
sampled markers in a narrow genomic region of a particular chromo-
some (Kruglyak, 1999).| Therefore, modeling haplotype data is of
paramount importance for a wide range of problems in population

genetics and disease gene discovery (Chung et (11., 2013; Howie et (11.,
2012; 2009; Lawson et (11., 2012; Li et (11., 2010; Lohmueller et (11.,
2009; Marchini et (11., 2007; Morris, 2006; Pasaniuc et (11., 2009; Pool
et (11., 2010; Price et (11., 2009; Savage et (11., 2013; Templeton, 2005).
Haplotypes have been traditionally analyzed by hidden Markov
models (HMMs) (Li and Stephens, 2003; Yang et (11., 2014); with
emissions corresponding to observed genotypes and transitions to re-
combination events. Although HMMs for haplotypes undergird
many efficient and accurate algorithms for haplotype phasing (Scheet
and Stephens, 2006); genotype imputation (Browning and Browning,

(C7 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3514

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

Multivariate Bernoulli haplotype model

3515

 

2007; Howie et al., 2009; Li et al., 2010) and identity—by—descent de—
tection (Browning and Browning, 2011), they suffer from the draw—
back of modeling only dependencies between consecutive variants.
This assumption leads to the unrealistic conclusion that the previous
variant and the next variant are independent given the current vari—
ant. Ignoring dependencies among non—consecutive markers makes it
difficult to detect and exploit long range correlations and higher—
order interactions among variants. These complex dependencies def—
initely exist in the human genome and are important factors in gen—
etic studies (Price et al., 2008; Wall and Pritchard, 2003).

This article applies the multivariate Bernoulli (MVB) distribution
to haplotype data. The MVB distribution captures the entire spec—
trum of dependencies among the entries of random binary vectors of
length N (Dai et al., 2013). The observed haplotypes at N nearby sin—
gle—nucleotide polymorphisms (SNPs) can be thought of as realiza—
tions of such a process. Since there are 2N possible haplotypes for N
SNPs, the MVB distribution requires an unsustainable exponential
number of parameters. Vast amounts of training data or clever algo—
rithms cannot compensate for this combinatorial explosion. Here, we
investigate a Poisson re—parameterization of the MVB distribution
and impose an Zl—norm penalty to enforce sparsity in parameter esti—
mation. These steps allow us to devise an efficient coordinate ascent
algorithm for learning the MVB parameters from haplotype data
while restricting the number of parameters to a manageable level.

We showcase the utility of the MVB model by predicting an indi—
vidual’s DNaseI hypersensitivity (DH) status from haplotypes
observed near known DH sites. DH status is a mark of open chro—
matin and flags genomic regions where the DNA is accessible to the
DNaseI enzyme. These regions, such as transcription start sites, cor—
relate with active DNA regulation. DH status is usually assayed
through DNase—Seq, a genome—wide high—throughput technology
that sequences genomic regions sensitive to DNaseI (Madrigal and
Krajewski, 2012). Recent research (Degner et al., 2012) suggests
that genetic variants control this epigenetic mark. Since DH status
can be naturally encoded as a binary variable, the MVB model offers
a natural way to integrate DH status and local haplotype data. In
predicting DH status from haplotypes, the MVB model allows all al—
lelic sets to contribute regardless of the order of the participating
SNPs and the physical distances separating them.

Our analysis of data from the 1000 Genomes project
(1000 Genomes Project Consortium et al., 2010) demonstrates the
superiority of the sparse MVB distribution in model fitting. In prac—
tice, interactions beyond order three play little role in determining
haplotype frequencies in these data. Our new cyclic coordinate des—
cent algorithm for estimating the MVB interaction parameters con—
verges quickly and reliably. The MVB model also turns out to
be pertinent to predicting DH status from haplotype data at
known DH sites (de los Campos et 41., 2013). On a sample of just
59 subjects, cross—validation under the MVB yields a prediction R2
of 0.12 for dichotomized DH levels. As expected, the accuracy of
DH prediction decreases as extraneous predictors are added. Finally,
prediction under the MVB achieves about 10% better accuracy than
prediction by linear regression (best unbiased linear predictor or
BLUP) and logistic regression. Thus, the MVB model is recom—
mended for prediction of binary epigenetic status from local haplo—
type data.

2 Methods
2.1 The MVB distribution as a model for haplotype data

The MVB distribution extends the univariate Bernoulli distribution
to binary vectors of fixed length N (Dai et al., 2013). The density

Pr(Y : y) : pwlwyN) of such a discrete random vector Y depends
on 2N probabilities p(o.o.wo), p(o.o.w1),  ,pUle) specific to
the different realizations of Y. For example, the bivariate Bernoulli
distribution consists of four realizations (0, 0), (0, 1), (1, 0) and (1,
1) specified by four probabilities p(0.0),p(0.1),p(1.0) and 170.1). By
definition, the conditional distribution of a subvector, say
(Y1, Y2, .. . ,Yk), given the complementary subvector, say
(YkH, . . . , YN), is also MVB. In the bivariate case, conditioning on
either Y1 or Y2, produces a standard univariate Bernoulli distribu—
tion. There is an alternative parameterization that captures inter—
actions and is conducive to parsimony. This parameterization
substitutes subsets of {1, . . . ,N} for binary vectors. To the realiza—
tion y, we correspond the index set A : {i : y, : 1}. The natural
parameters fC of the MVB model are indexed by interaction subsets
C, and the density function Pr(Y : y) is written as the ratio

ml: f.)

Pr(A) : —C§A : —exp(SA) , (1)
X Zexp(SB)
2196 p<CXC:BfC> B

where we define SA : chA fc for notational simplicity. The de—
nominator EB exp(SB) is the appropriate normalizing constant.

The haplotypes spanning N bi—allelic SNPs can be represented
as binary vectors of length N. We adopt the convention that 31,: 0
indicates the major allele and 31,: 1 indicates the minor allele at
SNP 1'. One can obviously model the distribution of haplotypes in
a population as MVB. The major advantage of the MVB is its
ability to incorporate interactions in the recovery of haplotype
frequencies. The number of parameters in both the naive and inter—
action parameterizations grows exponentially fast in N. However,
the interaction parameterization organizes interactions by level
and suggests limiting model complexity by imposing an upper
bound on interaction level. The next section introduces a lasso pen—
alty that in combination with maximum likelihood estimation elim—
inates superfluous interactions and keeps the number of levels in
check.

2.2 Estimating MVB parameters from haplotype data
To estimate haplotype frequencies and ultimately infer missing
haplotypes, one can randomly sample a population and count the
number X A of haplotypes of each type A. For a fixed sample size M,
the X A jointly follow a multinomial distribution with M total counts
and the count probabilities Pr(A) displayed in Equation (1).
Alternatively, one can adopt a Poisson rather than a multinomial
sampling framework. The two share the assumption of independent
samples but differ in whether the total sample size is random
(Poisson) or fixed (multinomial). The law of small numbers justifies
the equivalence of the two frameworks. The Poisson setting invokes
a mean sample size M, which is estimated by the observed sample
size 2A XA. One can show (Lange, 2010) that the random variables
X A are independent and Poisson distributed with means
HA 2 HPr(A)~

In the Poisson framework, it is easier to work with the inter—
action parameters by setting uA : exp(SA) : exp(ZBcAfB) and
ignoring u and the normalizing constant ZB exp(SB). In effect, these
are absorbed into the empty set parameter f9). Independence of the
X A now yields the likelihood

XA
£<frx>:H(“,/;:, expr—un. (2)
A .

 

[310'sp2umofp105xo'sopeuHOJIItotq/ﬁdnq

3516

H.Shi et al.

 

where X : (XA) and f: (fA) are the vectors of haplotype counts
and interaction parameters, respectively. Taking logarithms pro—
duces the log likelihood

£(f1X) : Zn 2 X3 — Zexpm) — ZlogXAL (3)
A A

BQA A

It is natural to estimate the MVB parameter vector f : (ﬂy) by maxi—
mizing [(le).

Unless N is small and the sample size M is large, estimating all
2N MVB parameters is an exercise in over—fitting. To achieve parsi—
mony, we append an Z1—norm (lasso) penalty to the log likelihood.
Any reasonable model should include the low—order parameters fA
with )A) g 1, where )A) denotes the cardinality of the set A. Hence,
we maximize the penalized log likelihood

F(f):ZfAZXB—ZCXP(SA)_AZ lfAl- (4)
A

BQA A 1A122

Here, /1 is a tuning constant determining the strength of the pen—
alty. Increasing /1 increases the sparsity of the estimated parameter
vector. The analogy with lasso—guided regression is obvious. The
new objective function F(f) is concave and directionally differenti—
able. It has kinks introduced by the terms )fA  We recommend maxi—
mization by coordinate ascent.

2.3 Coordinate ascent algorithm

Coordinate ascent maximizes the objective function one parameter
at a time holding other parameters fixed. Cycling through the par—
ameters continues until the objective value converges or a maximum
number of iterations is reached. Algorithm 1 outlines the coordinate
ascent algorithm for estimating model parameters.

 

Algorithm 1 coordinate ascent algorithm for fitting the MVB

 

1: Let C be the collection of possible haplotypes of length N
2: Initialize fA to O for all A E C

3: while stop condition fails do

4: for A in C do

5: ﬁg = argmaxﬂaﬂf)

6: end for

7: end while

 

Line 5 of Algorithm 1 requires finding arg max/(AF To update
fA when )A) g 1, we set the partial derivative of F(f)

a Hf): ZXB—efAZechB.c¢Afc (5)

WA 32A 32A

with respect to fA equal to 0. This yields the update

ZXB

BQA

:ln—. (6)
A Z eZCQBc¢AfC
32A
When Mi 2 2, the supergradjent
3F“) I 2 X3 — efA Z eZCgB.C¢A fC
afA 32A 32A
1 1f fA > 0 (7)

—/1 [—1.1] if 73, z 0

—1 iffA<0

must contain 0 (Lange, 2013). Equating it to 0 yields the update

0 1613/1
ill—ZBQAXB—A c>/l
fA : ZBQAeZCQRCt/‘fc (8)
x A
1“ ZBQA B + c < —/l

ZBDAeZCQRCA/‘fc

for the criterion 6 : ZBQA XB — ZBQA eZC§B~C¢A fc.

In view of the summations over B 2 A in the denominators of
Equations (6) and (8), each coordinate ascent update takes nearly
O(2N) operations. This computational load restricts estimation to
MVB models with small N, say N S 15. Once parameters are esti—
mated, prediction under the MVB is relatively straightforward. The
normalizing constant in formula (1) must be calculated, but this can
be done once and the result stored.

2.4 Best linear unbiased predictor

Part of our evaluation of the MVB involves comparison of DH pre—
diction on simulated data. The simulated DH status 3!, of an individ—
ual i was constructed as a linear combination of individual is SNP
alleles and SNP pairwise interactions weighted by effect sizes I}, and
ﬁjk. In symbols

yr 2 Zﬁjhij + Z ﬁjkhijhik + 8i) (9)
/ {13k}

where 10,, is the SNP predictor (standardized version of 0 or 1) of in—
dividual i at SNP /, [ail-10,12 is the SNP interaction of individual i for
the pair of SNPs / and k and Si is an independent normally distrib—
uted error term. Simplified versions of the model ignore the pairwise
interactions and take all [ll-k : 0.

To make predictions under the linear model, we first estimate
the effect sizes I}, and ﬁjk from training dataset and then predict the
phenotype (DH status) of each individual in the test data, substitut—
ing estimated parameters for true parameters. For notational brev—
ity, let H : (HSNP.H1NT) be the block matrix of single SNP and
interaction SNP predictors across the training set; for each subject 1'
and SNPs / and k, the matrix Hsz has entries (19,7) and the matrix
HINT has entries (hi/hit). The effect sizes I}, and [lit are estimated by
the least squares formula

[3: (HTH)‘1HTy. (10)
Finally, the BLUP 51,- of DH status for an individual i is computed via

5% : Zﬁjk’ij‘l'Zﬁ/‘kk’ijk’ik- (11)
/ {11k}

2.5 Logistic regression (LOGIT)

We also compared the MVB model with logistic regression
(LOGIT); unlike linear regression, logistic regression directly models
binary outcomes. Under logistic regression, the probability of the
DH status 3!, of individual 1' given his/her SNP alleles (19,7) and pair—
wise interactions (laiylaik) is

es, y 1 1-y
Pr(iny)=<1+ec,> <—1+ec,> 7 (12)

where c,- : are + Z]- ocylaiy + 2W2} Mjkhil'hik. Here the 01’s are the re—
gression coefficients in logistic regression. As with linear regression,

 

one can simplify the model by ignoring pairwise interactions and

ﬁm'srcumol‘pquo'sopeuuowtotq/ﬁdnq

Figure 2

Equation (1)
Table 1

Li and Stephens, 2003

Table 2

Consortium el al., 2010

IIowie el al., 2009 2012 2011

Figure 1

 

Figure 3

1000 Genomes Project

SL1 el al.,

 

/310'S[BHmOprOJXO"SOIJBLUJOJIIIOIq/ﬂdnq

 

Equation (11)
Equation (14)

Equation (10)

A| g 2. /\ : 0.25
A| g3. A:0.25

Figure 4

LOGI’I‘ (SNP)

LOGI’I‘ (SNP &11\"1‘)

LOGI’I‘ (st av ADJ)

HMM

BLITP (SNP)

BLITP (SNP (x: INT)
«7 BLITP (SNPR:

Figure 5

Figure 6

Degner (7/ al.. 2012

/310'S[BHJHO[pJOJXO'SOIJ’BLUJOJIIIOIq/ﬂduq

—o— MVB (1.41: 2, ,\ : o.
MVB (A)
LOGI’I‘ (SNP)
LOGI’I' (SNP av INF)
LOGIT ( .
Ill\
BLITP (sup)
BLUP ‘r (x INT)
—«— BLITP

Figure 7

* MVB ((Ap
MVB (1A
LOGIT 1' VP)
LOGIT ( \‘r k in)
LOGI’I s.\P A: ADJ)
umr
BLL'I’ (SNP)
BLUP

747 BLUP rs. P a ADJ)

Fig. 7 Figure 7

 

Table 3

Bo) le (7/ al.. 2008

Degner (7/ al.. 2012

1000 Genomes Project Consortium (7/ al.. 2010

/310'S[BHJHO[pJOJXO'SOIJ’BLUJOJIIIOIq/ﬂduq

+ MVB ()4)
MVB (1A) 7 ,
I.( HT (SNP)
T (sz &~ INT)
LooIT (SNP &: ADJ)
BLUP (SNP)
BLUP (SNP & INT)
—<— BLUP (SNP A: .-\DJ)

1:) MVB ( A) g 0
1:1 3 [VB (1‘41
|:| LOGIT (SNP)

l:| LOGIT (SNP  INT)
l:| BLUP (SNP)
E BLUP (SNP a INT)

 

IIowie (7/ al.. 2012

+ MVB (1.4
MVB (1.4) I, ,
Ioorr (sNP)

BLUP .,NI" k‘ INT)
-<1- BLUP (SNP LK: ADJ)

 

|:IMVB(A| :0 A712
1:13 '13 (1‘41

|:| LOGIT (SNP)

l:| LOGIT (SNP 3: INT)
E BLUP (SNP)

|:| BLUP (SNP & IN’I")

 

 

/310'SIBanoprOJxo'soIJBuIJOJquIq”:dnq

Multivariate Bernoulli haplotype model

3521

 

Browning,B.L. and Browning,S.R. (2011) A fast, powerful method for detect-
ing identity by descent. Am. ]. Hum. Genet, 88, 173—182.

Browning,S.R. and Browning,B.L. (2007) Rapid and accurate haplotype phas-
ing and missing-data inference for whole-genome association studies by use
of localized haplotype clustering. Am. ]. Hum. Genet, 81, 1084—1097.

Chung,C.C. et al. (2013) Meta-analysis identiﬁes four new loci associated
with testicular germ cell tumor. Nat Genet, 45, 680—685.

Dai,B. et al. (2013) Multivariate Bernoulli distribution. Bernoulli, 19,
1465—1483.

Daly,M.]. et al. (2001) High-resolution haplotype structure in the human gen-
ome. Nat Genet, 29, 229—232.

de los Campos,G. et al. (2013) Prediction of complex human traits using the
genomic best linear unbiased predictor. PLoS Genet, 9, 61003608.

Degner,].F. et al. (2012) DNase I sensitivity QTLs are a major determinant of
human expression variation. Nature, 482, 390—394.

Gibbs,R.A. et al. (2003) The international hapmap project. Nature, 426, 78 9—796.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method
for the next generation of genome-wide association studies. PLoS Genet, 5,
61000529.

Howie,B. et al. (2012) Fast and accurate genotype imputation in genome-wide
association studies through pre-phasing. Nat Genet, 44, 955—959.

Kruglyak,L. (1999) Prospects for whole-genome linkage disequilibrium map-
ping of common disease genes. Nat Genet, 22, 139—144.

Lange,K. (2010) Applied Probability. Springer Texts in Statistics. Springer,
New York.

Lange,K. (2013) Optimization. Springer Texts in Statistics. Springer, New
York.

Lawson,D.]. et al. (2012) Inference of population structure using dense haplo-
type data. PLoS Genet, 8, e1002453.

Li,N. and Stephens,M. (2003) Modeling linkage disequilibrium and identify-
ing recombination hotspots using single-nucleotide polymorphism data.
Genetics, 165, 2213—2233.

Li,Y. et al. (2010) Mach: using sequence and genotype data to estimate haplo—
types and unobserved genotypes. Genet. Epidemiol., 34, 816—834.

Lohmueller,K.E. et al. (2009) Methods for human demographic inference
using haplotype patterns from genomewide single-nucleotide polymorphism
data. Genetics, 182, 217—231.

Madrigal,P. and Krajewski,P. (2012) Current bioinformatic approaches to
identify DNase I hypersensitive sites and genomic footprints from DNase-
seq data. Front. Genet, 3.

Marchini,]. et al. (2007) A new multipoint method for genome-wide associ-
ation studies by imputation of genotypes. Nat Genet, 39, 906—913.

Morris,A.P. (2006) A ﬂexible Bayesian framework for modeling haplotype as-
sociation with disease, allowing for dominance effects of the underlying
causative variants. Am. ]. Hum. Genet, 79, 679—694.

Pasaniuc,B. et al. (2009) Inference of locus-speciﬁc ancestry in closely related
populations. Bioinformatics, 25, i213—i221.

Pool,].E. et al. (2010) Population genetic inference from genomic sequence
variation. Genome Res., 20, 291—300.

Price,A.L. et al. (2008) Long-range ld can confound genome scans in admixed
populations. Am. Hum. Genet, 83, 132.

Price,A.L. et al. (2009) Sensitive detection of chromosomal segments of dis-
tinct ancestry in admixed populations. PLoS Genet, 5, e1000519.

Savage,S.A. et al. (2013) Genome-wide association study identiﬁes two suscep-
tibility loci for osteosarcoma. Nat Genet, 45, 799—803.

Scheet,P. and Stephens,M. (2006) A fast and ﬂexible statistical model for
large-scale population genotype data: applications to inferring missing
genotypes and haplotypic phase. Am. ]. Hum. Genet, 78, 629—644.

Su,Z., et al. (2011) Hapgen2: simulation of multiple disease SNPs.
Bioinformatics, 27, 2304—2305.

Templeton,A.R. (2005) Haplotype trees and modern human origins. Am. 
Phys. Anthropol., 128, 33—59.

Wall,].D. and Pritchard,].K. (2003) Haplotype blocks and linkage disequilib-
rium in the human genome. Nat Rev. Genet, 4, 587—597.

Yang,W.—Y. et al. (2014) A spatial-aware haplotype copying model with ap-
plications to genotype imputation. In: Sharan,R. (ed.), Research in
Computational Molecular Biology. Springer International Publishing,
Switzerland, pp. 371—384.

ﬁm'sIcumol‘pmJXO'sopcuuopIIoIq/ﬁdnq

