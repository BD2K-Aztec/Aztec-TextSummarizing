APPLICATIONS won:-  5:22;;sarisgasrzztsz:

 

Genetics and population analysis

Advance Access publication July 13, 2012

GAPIT: genome association and prediction integrated tool

Alexander E. Lipka‘, Feng Tian2, Qishan Wange, Jason Peiffer4, Meng Li2'5,

Peter J. Bradbury‘, Michael A. GoreB, Edward S. Buckler1 '2‘4 and Zhiwu Zhangz'*

1Computational Biologist with the United States Department of Agriculture - Agricultural Research Service (USDA-ARS),
Ithaca, NY 14853, USA, 2Institute for Genomic Diversity, Cornell University, Ithaca, NY 14853, USA, 3Department of
Animal Science, Shanghai Jiao Tong University, Shanghai 200240, China, 4Department of Plant Breeding and Genetics,
Cornell University, Ithaca, NY 14853, USA, 5Centre of Pear Engineering Technology Research, Nanjing Agricultural
University, Nanjing 210095, China and 6US Arid-Land Agricultural Research Center, United States Department of
Agriculture-Agricultural Research Service, Maricopa, AZ 85138, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Summary: Software programs that conduct genome-wide association
studies and genomic prediction and selection need to use methodol-
ogies that maximize statistical power, provide high prediction accur-
acy and run in a computationally efficient manner. We developed an R
package called Genome Association and Prediction Integrated Tool
(GAPIT) that implements advanced statistical methods including the
compressed mixed linear model (CMLM) and CMLM-based genomic
prediction and selection. The GAPIT package can handle large data-
sets in excess of 10 000 individuals and 1 million single-nucleotide
polymorphisms with minimal computational time, while providing
user-friendly access and concise tables and graphs to interpret
results.

Availability: http://wwwmaizegenetics.net/GAPIT.

Contact: zhiwu.zhang@cornell.edu

Supplementary Information: Supplementary data are available at
Bioinfonnatics online.

Received on April 11, 2012; revised on July 3, 2012; accepted on
July 8, 2012

1 INTRODUCTION

Advances in high-throughput single-nucleotide polymorphism
(SNP) genotyping are enabling powerful genome-wide associ-
ation studies (GWAS), thereby enhancing the ability to identify
causal mutations that underlie human diseases and agriculturally
important traits. The resulting SNPs are also valuable for gen-
omic prediction and selection (GS), which provides criteria for
disease risk management in humans and expedited selection in
animal and plant breeding (Heffner et al., 2009; Meuwissen et al.,
2001). Before the full potential of GWAS and GS are realized,
inﬂated false-positive rates, extensive computational require-
ments and suboptimal prediction accuracies need to be
addressed.

Newly developed GWAS statistical methods based on the
mixed linear model (MLM) hold great promise to overcome
these challenges. They are ﬂexible because they incorporate
ﬁxed and random effects. To address the spurious associ-
ations that arise from population structure, covariates from

 

*To whom correspondence should be addressed.

either STRUCTURE (Pritchard et al., 2000) or principal com-
ponents (PCs) can be included as fixed effects. The cryptic rela-
tionships between individuals are accounted for through
a kinship matrix in the uniﬁed MLM H u et al., 2006).
The more computationally efficient and powerful compressed
MLM (CMLM) (Zhang et al., 2010) uses a group kinship
matrix calculated from clustered individuals.

Because the typical number of genotypic data points is exceed-
ing hundreds of millions, solving MLMs using the traditional
restricted maximum likelihood approach is computationally
intensive. Therefore, the efﬁcient mixed model association
(EMMA) algorithm (Kang et al., 2008) was developed to
reduce this computational burden by reparameterizing the
MLM likelihood functions. EMMA eXpedited (EMMAX)
(Kang et al., 2010) and population parameters previously deter-
mined (P3D) (Zhang et al., 2010) were independently developed
to further reduce computing time by eliminating the need to
re-estimate variance components at each marker.

Most GS methods make predictions with the sum of the effects
from all available SNPs or Genomic Best Linear Unbiased
Prediction (gBLUP) based on a kinship matrix derived from
these SNPs. The former approach offers higher prediction
accuracies for simpler traits, while the latter approach is more
accurate for complex traits (Daetwyler et al., 2010). Our work
implements an improved gBLUP method that increases accur-
acy, especially for simple traits.

Most software packages were developed for a particular
GWAS or GS approach. For example, packages were written
exclusively for the EMMA and EMMAX algorithms. Other soft-
ware such as the Trait Analysis by aSSociation, Evolution and
Linkage (TASSEL) (Bradbury et al., 2007) and PLINK (Purcell
et al., 2007) make multiple GWAS approaches available in one
package. We continue these software development efforts
by creating Genome Association and Prediction Integrated
Tool (GAPIT), which integrates the most powerful, accurate
and computationally efﬁcient GWAS and GS methods into a
single R package.

2 IMPLEMENTATION

The GAPIT program accepts several combinations of genotypic
data, phenotypic data, externally obtained kinship matrices, and

 

Published by Oxford University Press 2012. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2397

112 /310'S[BHJHOIPJOJXO'SOlJBLUJOJIIlOlq”Zduq wort papBOIII/lAOG

9103 ‘Og isanV uo ::

A.E.Lipka et al.

 

 

 

 

 

 

 

 

 

 

{a}, _?’ Ibiﬁ- ‘1“ ,4
r .l I
e '— § ~  I
’ I
m E a. |
N g ’ '.
an o E i- I] J/.
“-’ ' x’ '- /\
c.  t- I .x ., ,r ‘\ M
7 _ I f" V \f
s -* 3 - '-_.../
40 60 40 m u' 19 an ‘00 do do 80
{c} a” PCl  _ rimmmm “a” a.
Law: 3
- |.EI29‘3 in

I Genalic variance

n
:I Residual variance I «515
. - 43299

  

 

  

 

 

Tile munum moressrm 45;.“
MN" 2059!
min" 25m
25.
1.011% . mm”
' dame
_. 11155
." _‘
--.._  - away
{9) 4654:
T Group Mill ID HUD DEV 
are
me 1 : 1 4.5343! 5.1mm J Hm
33—1: 2 I 2 rams-1 new: g g g g g a g g
we 3 I 3 4.06341 5.1% u 2 2 g = E 5: a;
#22 4 I I mm 4.6m” pEV
R188 5 l 5 3.34004 5.1%218?
«r 
g ..
c
g /
m .5 '
pa. -
Q. .-
5. ..
C
‘-
8‘ N
I ., -'
.. A
q. . I
:35
(I1) 1 2 3 4 5 s r s 9 10
SNP Lhnmom Mime Put: ml nabs Ewe.wilhmn.5NP IISanIMIIILW WIIJIIWM
23.035511 3 136313431 Mitt-05 ﬁlm-11%! 2M Dl-WSB‘I‘IBJ ﬂan-£16352 061191931
HINDI-15.1 1 1mm 0000052325 nulme 264 0137587332 0W?! USINTSSSS
9301515.! 3133869813 0.0005053! mm 25! mums: 0.5“2223? 0241015853

Fig. 1. Gallery of GAPIT output. (a) Plot of the ﬁrst two principal com-
ponents (PCI and PC2). (b) Plot of twice the negative log likelihood
(-2LL, smaller is better) at various number of groups. (c) Graph showing
the optimum cluster algorithm, method to calculate group kinship, group
number, -2LL, and the proportion of genetic variance (group heritability)
and residual variance. (d) Distribution of best linear unbiased predictors
(BLUPs) and their prediction error variance (PEV) (e) Genomic predic-
tion and selection output summary. The individual id (taxa), group,
Reflnf which indicates whether the individual is in the reference group
(1) or not (2), the group ID number, the BLUP and the PEV of the
BLUP. (1) Manhattan plot. —log P-values are plotted against physical
map position of SNPs. Chromosomes are altematingly colored.
(g) Quantile—quantile (QQ) plot determines how GWAS results compare
to the expected results under the null hypothesis of no association.
(h) Output table of GWAS results. The SNP id, chromosome, bp pos-
ition, P-value, minor allele frequency (mat), sample size (nobs), R2 of the
model without the SNP, R2 of the model with the SNP and adjusted
P-value following a false discovery rate-controlling procedure
(Benjamini and Hochberg, 1995).

covariates such as population structure and age. Multiple traits
can be stored in a single phenotypic dataset, which allows se-
quential analysis of each trait. The genotypic data may be stored
in HapMap or numerical formats. If genotypic data are absent,

then phenotypic data and a kinship matrix are required to
perform GS.

By default, GAPIT uses the CMLM approach with P3D/
EMMAX for GWAS. GS is performed using the same optimiza-
tion settings as GWAS (Supplementary Sections I and II and
Fig. S1). There is an option to perform GS only by specifying
‘SNP.test= FALSE’. Seven algorithms are available to cluster
individuals into groups. GAPIT can also perform the MLM
and GLM approaches by adjusting the ‘group.to’ and ‘group.-
from’ input parameters. When the kinship matrix is not pro-
vided, it will be calculated with the methods of VanRaden
(VanRaden, 2008), Loiselle (Loiselle et al., 1995) or EMMA
(Kang et al., 2008). GAPIT can also perform principal compo-
nent analysis of the genotypic data to control for population
structure (Zhao et al., 2007).

GAPIT has several strategies for analyzing large SNP datasets.
One is to import genotypic data stored in multiple smaller files.
If these files still exceed memory limits, the ‘ﬁle.fragment’ par-
ameter can be used to sequentially load fragments within each
file. If there is not enough memory to use all SNPs to calculate
the kinship matrix and PCs, then the ‘SNP.fraction’ input par-
ameter will select a random sample of the SNPs for these calcu-
lations H u et al., 2009).

The results from GAPIT are accessed as both objects within
the R workspace and as external ﬁles. The R objects, which
include GWAS and GS results, may be used for follow-up
analyses in R. The external files include publication-ready sum-
maries of GWAS and GS results. GWAS results are summarized
by Manhattan plots, quantilequantile plots and a table.
Similarly, GS results are presented in a heat map and a table.
Graphs of the heritability estimates and the likelihood func-
tion at various compression levels are included. A subset of
the graphs and tables produced by GAPIT are presented in
Figure l.

3 PERFORMANCE TESTS

EMMA and TASSEL were compared with GAPIT. These two
packages were selected because both use the EMMA algorithm,
while TASSEL also implements the CMLM approach with P3D.
When the same approach was used, identical results were ob-
tained (Supplementary Figs S2 and S3). The computing time of
all three packages increases linearly with the number of SNPs
(Supplementary Fig. S4). However, the average computing time
per SNP in GAPIT is 7-fold and l80—fold faster than TASSEL
and EMMA, respectively (Supplementary Fig. S4). It took 69.5 h
to analyze a dataset with 11 000 individuals and 500 000 SNPs,
which extrapolates to 7195 SNPs/CPU hours or less than 6 days
to analyze 1 million SNPs.

4 CONCLUSIONS

This R package uses state-of-the-art mixed model methods to
conduct GWAS and GS. GAPIT analyzes large datasets with
minimum computational time and produces comprehensive re-
sults including R objects and high-quality graphs.

 

2398

112 /310's112u1n0fp10}x0"sotwurJOJutotq/ﬁduq wort papBoIH/noq

9103 ‘Og isanV uo ::

Genome association and prediction integrated tool

 

ACKNOWLEDGEMENTS

J .C. Glaubitz is acknowledged for assistance with data analysis
in UNIX.

Funding: National Science Foundation (grants DBI-032l467,
DB10820619, and DBI-0922493); United States Department of
Agriculture - Agricultural Research Service.

Conﬂict of Interest: none declared.

REFERENCES

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac—
tical and powerful approach to mutliple testing. J. Roy Statis. Soc. B, 57,
2897300.

Bradbury,P.J. et a]. (2007) TASSEL: software for association mapping of complex
traits in diverse samples. Bioinformatics, 23, 263372635.

Daetwyler,H.D. et a]. (2010) The impact of genetic architecture on genome—wide
evaluation methods. Genetics, 185, 102171031.

Heffner,E.L. et a]. (2009) Genomic selection for crop improvement. Crop Sci., 49,
1712.

Kang,H.M. et a]. (2010) Variance component model to account for sample structure
in genome—wide association studies. Nat Genet, 42, 3487354.

Kang,H.M. et a]. (2008) Efﬁcient control of population structure in model organism
association mapping. Genetics, 178, 170971723.

Loiselle,B.A. et a]. (1995) Spatial genetic—structure of a tropical understory shrub,
Psychotria Ofﬁcinalis (Rubiaceae). Am. J. Bot, 82, 142(kl425.

Meuwissen,T.H. et a]. (2001) Prediction of total genetic value using genome—wide
dense marker maps. Genetics, 157, 181%1829.

Pritchard,J.K. et a]. (2000) Association mapping in structured populations. Am. J.
Hum. Genet, 67, 1707181.

Purcell,S. et a]. (2007) PLINK: a tool set for whole—genome association and
population—based linkage analyses. Am. J. Hum. Genet, 81, 5597575.

VanRaden,P.M. (2008) Efﬁcient methods to compute genomic predictions. J. Dairy
Sci., 91, 4414e4423.

Yu,J. et a]. (2009) Simulation appraisal of the adequacy of number of background
markers for relationship estimation in association mapping. Plant Genome, 2,
63777.

Yu,J.M. et a]. (2006) A uniﬁed mixed—model method for association mapping that
accounts for multiple levels of relatedness. Nat Genet, 38, 2037208.

Zhang,Z. et a]. (2010) Mixed linear model approach adapted for genome—wide
association studies. Nat Genet, 42, 3557360.

Zhao,K. et a]. (2007) An Arabidopsis example of association mapping in structured
samples. PLoS Genet, 3, e4.

 

2399

112 /310's1au1nofp101xo"sotwurJOJutotq/ﬁduq won papao1umoq

9103 ‘0g isanV uo ::

