BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

Y.Fong et al.

 

methods, where 62 is the estimated variance of the experimental noise.
The second component assumes that y is perfectly measured and the
variability comes from the variability of the curve estimate. For the
estimating equation-based methods, it can be estimated by

A A TA A A A A A
{ajggL (y; 0)) Mai} Var(0,-) {31‘5ng (y; 9,-)/30,- , where Var(0,-) is the esti-
mated variancmcovariance matrix of 6A,; For the Bayesian random effects

model-based methods, it can be estimated by the variance of the posterior
samples offs’llLQn 6,).

3 EXAMPLE SESSIONS

We illustrate the use of nCal through two examples (see
Supplementary Information for the complete R code and more
detailed explanation of the output). In the first example, we
simulate a dataset with one assay run and four samples of inter—
est. To perform non—linear calibration, we call

> res:ncal(log(fi) ~expected_conc, dat,
bcrm.fit=TRUE)

The Boolean argument bermﬁt controls whether to use berm,
which implements the Bayesian random effects model, or drm
from the (Ire package, which implements the estimating equation
methods for curve ﬁtting. res is a data frame, each row of which
corresponds to one sample of interest. ncal also creates a plot
with four panels (Supplementary Information nCal vignette
Supplementary Fig. S1 and S2), showing the curve ﬁt, the esti—
mated concentrations for the samples of interest and the preci—
sion proﬁles. From the two ﬁgures, we see that both curve ﬁtting
methods lead to similar calibration results for this example.

In the second example, we analyze a dataset containing four
assay runs, one of which is affected by multiple outliers.

> fit.bcrm=bcrm(log(fi) ~expected_conc, dat,
error.model=’ ’gh_t4 ’ ’ , informative .priorzT)
> for (i in 1:4) {
fit.drm=drm(log (fi) ~expected_conc, data:
dat, subset=assay_id==paste( ’ ’Run’ ’ , i) ,
fct=LL. 5 () , robustz’ ’median’ ’)
plot(fit.drm, type:’ ’all’ ’ , mainzp)
plot (get. single.fit (fit.bcrm,
paste( ’ ’Run’ ’, i) ) ,addzT)
}

Figure 1 shows that the two methods produce similar results
for Runs 1, 3 and 4, but differs signiﬁcantly for Run 2. Figure 1
also shows the curve ﬁts by Prism with the robust option. By
borrowing information across assay runs, berm appears more
successful at reducing the influence of multiple outlying observa—
tions than drm and Prism.

Run 1 Run 2

 

 

    
    

    
    

 

 

 

 

 

 

 

 

 

 

 

 

 

 

_8’ 6 ‘ 3 6 —
4 — — Prism, robust 4 - — Prism, robust
» - - drm, median - - - drm, median
— bcrm, t4 — bcrm, t4
2 - 2 —
I | | | I I I I I I
1 10 100 1000 10000 1 10 100 1000 10000
expected_conc expected_canc
Run 3 Run 4
1o — 1° ‘
8 - 8 -
% e — “‘3 s —
2 2
4 _ — Prism, robust 4 T — Prism, robust
- - - drm, median - - - drm, median
2 _ — bcrm,t4 2 _ — bcrm,l4
I I I I I I I I I I
1 10 100 1000 10000 1 10 100 1000 10000

expectediconc expectediconc

Fig. 1. Example II. Robust curve ﬁts from Prism, drm and berm

ACKNOWLEDGEMENTS

The authors thank members of the Lab Data Operations at
SCHARP for assay data quality control. They also thank the
members of the CRAN team for testing and distributing the
package. The authors are grateful to the editor, the associate
editor and the referees for their constructive comments.

Funding: This work was supported by the National Institute of
Allergy and Infectious Diseases (NIAID) [UMl—AI—0686l8] to
the HIV Vaccine Trials Network, the Bill and Melinda Gates
Foundation [OPPlO323l7] to the Collaboration for AIDS
Vaccine Discovery and the NIAID [AIlO4370—Ol] to Y.F.

Conﬂict of interest: none declared.

REFERENCES

Davidian,M. and Giltinan,D. (1995) Nonlinear models for repeated measurement
data. Vol. 62, Chapman & Hall/CRC, Boca Raton, FL, USA.

Fong,Y. et al. (2012) A robust Bayesian random effects model for nonlinear
calibration problems. Biometrics, 68, 110}1112.

Plummer,M. (2003) JAGS: a program for analysis of Bayesian graphical models
using Gibbs sampling. In: Proceedings of the 3rd International Works/top on
Distributed Statistical Computing. 2003, p. ZIPZZ. Vienna, Austria.

Ritz,C. and Streibig,J. (2005) Bioassay analysis using R. J. Stat. Software, 12, 1722.

 

2654

ﬁle'sreumol‘pmJXO'sopeuuowrorq/ﬁdnq

