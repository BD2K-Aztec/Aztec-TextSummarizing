ORIGINAL PAPER

Vol. 27 no. 21 2011, pages 2987-2993
doi:10. 1 093/bioinformatics/btr5 09

 

Sequence analysis

Advance Access publication September 8, 2011

A statistical framework for SNP calling, mutation discovery,
association mapping and population genetical parameter

estimation from sequencing data

Heng Li

Medical Population Genetics Program, Broad Institute, 7 Cambridge Center, Cambridge, MA 02142, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Most existing methods for DNA sequence analysis rely
on accurate sequences or genotypes. However, in applications of
the next-generation sequencing (NGS), accurate genotypes may
not be easily obtained (e.g. multi-sample low-coverage sequencing
or somatic mutation discovery). These applications press for the
development of new methods for analyzing sequence data with
uncertainty.

Results: We present a statistical framework for calling SNPs,
discovering somatic mutations, inferring population genetical
parameters and performing association tests directly based on
sequencing data without explicit genotyping or linkage-based
imputation. On real data, we demonstrate that our method achieves
comparable accuracy to alternative methods for estimating site allele
count, for inferring allele frequency spectrum and for association
mapping. We also highlight the necessity of using symmetric
datasets for finding somatic mutations and confirm that for
discovering rare events, mismapping is frequently the leading source
of errors.

Availability: http://samtools.sourceforge.net

Contact: hengli@broadinstitute.org

Received on July 20, 2011; revised on August 30, 2011; accepted
on September 1, 2011

1 INTRODUCTION

The 1000 Genomes Project (1000 Genomes Project Consortium,
2010) sets an excellent example on how to design a sequencing
project to get the maximum output pertinent to human populations.
An important lesson from this project is to sequence many human
samples at relatively low coverage instead of a few samples
at high coverage. We adopt this strategy because with higher
coverage, we will mostly reconﬁrm information from other reads,
but with more samples, we will be able to reduce the sampling
ﬂuctuations, gain power on variants present in multiple samples and
get access to many more rare variants. On the other hand, sequencing
errors counteract the power in variant calling, which necessitates a
minimum coverage. The optimal balancing point is broadly regarded
to be in the 2—6 fold range per sample (Le and Durbin, 2010; Li
et al., 201 1), depending on the sequencing error rate, level of linkage
disequilibrium (LD) and the purpose of the project.

A major concern with this design is that at 2—6 fold coverage
per sample, non-reference alleles may not always be covered by
sequence reads, especially at heterozygous loci. Calling variants

from each individual and then combining the calls usually yield poor
results. The preferred strategy is to enhance the power of variant
discovery by jointly considering all samples (Depristo et (11., 2011;
Le and Durbin, 2010; Li et al., 2011; Nielsen et al., 2011). This
strategy largely solves the variant discovery problem, but acquiring
accurate genotypes for each individual remains unsolved. Without
accurate genotypes, most of the previous methods [e.g. testing
Hardy—Weinberg equilibrium (HWE) and association mapping]
would not work.

To reuse the rich methods developed for genotyping data, the
1000 Genomes Project proposes to impute genotypes utilizing LD
across loci (Browning and Yu, 2009; Howie et al., 2009; Li et al.,
2009b, 2010a). Suppose at a site A, one sample has a low coverage.
If some samples at A have high coverage and there exists a site B
that is linked with A and has sufﬁcient sequence support, we can
transfer information across sites and between individuals, and thus
make a reliable inference for the low-coverage sample at A. The
overall genotype accuracy can be greatly improved.

However, imputation is not without potential concerns. First,
imputation cannot be used to infer the regional allele frequency
spectrum (AFS) because imputation as of now can only be applied
to candidate variant sites, while we need to consider non-variants
to infer AFS. Second, the effectiveness of imputation depends on
the pattern of LD, which may lead to potential bias in population
genetical inferences. Third, the current imputation algorithms are
slow. For a thousand samples, the fastest algorithm may be slower
than read mapping algorithms, which is frequently the bottleneck
of analyzing NGS data (H.M.Kang, personal communication).
Considering more samples and using more accurate algorithms will
make imputation even slower.

These potential concerns make us reconsider if imputation is
always preferred. We notice that we perform imputation mainly
to reuse the methods developed for genotyping data, but would it
be possible to derive new methods to solve Classical medical and
population genetical problems without precise genotypes?

Another application of NGS that requires genotype data is to
discover somatic mutations or germline mutations between a few
related samples (Conrad et al., 2011; Ley et (11., 2008; Mardis et al.,
2009; Pleasance et al., 2010a, b; Roach et al., 2010; Shah et al.,
2009). For such an application, samples are often sequenced to
high coverage. Although it is not hard to achieve an error rate
one per 100 000 bases (Bentley et al., 2008), mutations occur at
a much lower rate, typically of the order of 10_6 or even 10_7.
Naively calling genotypes and then comparing samples frequently
would not work well (Ajay et al., 2011), because subtle uncertainty

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2987

112 /3.Io's[BumoprOJXO'sorwurJOJurorq”:duq 11101} papeolumoq

9103 ‘Og anﬁnv uo ::

H.Li

 

in genotypes may lead to a bulk of errors. From another angle,
however, when discovering rare mutations, we only care about the
difference between samples. Genotypes are just a way of measuring
the difference. Is it really necessary to go through the genotype
calling step?

This article explores the answer to these questions. We will
show in the following how to compute various statistics directly from
sequencing data without knowing genotypes. We will also evaluate
our methods on real data.

2 METHODS

This section presents the precise equations on how to infer various statistics
such as the genotype frequency and AFS. and to perform various statistical
test such as testing HWE and associations. Some of these equations
have already been described in the existing literature, but for theoretical
completeness, we give the equations using our notations. The last subsection
reviews the existing methods and summarizes the differences between them,
as well as between ours and the existing formulation.

In this section, we suppose there are n individuals with the i-th individual
having mi ploidy. At a site, the sequence data for the i-th individual is
represented as d, and the genotype is g, which is an integer in [0,mi], equal
to the number of reference alleles in the individual. Table 1 gives notations
common across this section. The detailed derivation of the equations in this
article is presented in an online document (http://bit.ly/stmath).

2.1 Assumptions

2.1.] Site independency We assume data at different sites are
independent. This may not be true in real data, because sequencing and
mapping are context dependent; when there is an insertion or deletion
(INDEL) error or INDEL polymorphism, sites nearby are also correlated in
alignment. Nonetheless, most of the existing methods make this assumption
for simplicity. The effect of site dependency may also be reduced by post-
ﬁltering and properly modeling the mapping and alignment errors (Li et al.,
2008; Li, 2011).

2.1.2 Error independency ana1 sample independency We assume that at a
site the sequencing and mapping errors of different reads are independent.
As a result, the likelihood functions of different individuals are independent:

Heel—[me (1)

[:1
In real data, errors may be dependent of sequence context (Nakamura
et al., 2011). The independency assumption may not hold. It is possible to

model error dependency within an individual (Li et al., 2008), but the sample
independency assumption is essential to all the derivations below.

Table 1. Common notations

 

 

Symbol Description

n Number of samples

m, Ploidy of the i-th sample (1 5 i in)

M Total number of chromosomes in samples: M: Zimi

d, Sequencing data (bases and qualities) for the i-th sample

g, Genotype (the number of reference alleles) of the i-th sample
(0 E 81’ 5 mi)”

¢k Probability of observing k reference alleles (224:0 m = 1)

Pr{A} Probability of an event A

£i(6) Likelihood function for the i-th sample: £i(6) = Pr{a’i |9}

 

3In this article, we only consider biallelic variants.

2.1.3 Biallelic variants We assume all variants are biallelic. In the human
population, the fraction of triallelic SNPs is ~0.2% (Hodgkinson and Eyre-
Walker, 2010). The biallele assumption does not have a big impact to the
modeling of SNPs, though it may have a bigger impact to the modeling of
INDELs at microsatellites.

2.2 Computing genotype likelihoods

For one sample at a site, the sequencing data a1 is composed of an array
of bases on sequencing reads plus their base qualities. As we only consider
biallelic variants, we may focus on the two most evident types of nucleotides
and drop the less evident types if present. Thus, at any site we see at most two
types of nucleotides. This treatment is not optimal, but sufﬁcient in practice.

Suppose at a site there are k reads. Without losing generality, let the
ﬁrst i bases (1 5 k) be identical to the reference and the rest be different. The
error probability of the j-th read base is 6]: Assuming error independency,
we can derive that

l k
mg): %H[(m—g)€j+g(1 —e,->] H [(m—g>(1—e,->+ge,-] (2)
j:l j:l+l

where m is the ploidy.

2.3 Inferences from multiple samples

2.3.] Estimating the site allele frequency In this section, we estimate the
per-site reference allele frequency (it. For the i-th sample, let m, be the ploidy.
g, the genotype and d, the sequencing data. Assuming HWE, we can compute
the likelihood of (it:

cur):Z--[narcissism=Hzci(gr(g;mi.w> (3)
31 gm i i:lg:0

where £i(gi) is computed by Equation (2) and

 ¢g(1_w)m—g 

is the probability mass function of the binomial distribution Binom(m, (it).

Knowing the likelihood of (it, we may numerically ﬁnd the max-likelihood
estimate with, for example, Brent’s method (Brent, 1973). An alternative
approach is to infer using an expectationimaximization algorithm (EM),
regarding the sample genotypes as missing data. Given we know the estimate
firm at the t-th iteration, the estimate at the (t+ 1)-th iteration is

aniiw
M 2,, £i(g)f(g:mi.slr"))

i2]

(5)

where M: Zimi is the total number of chromosomes in samples.

When the signal from the data is strong, or equivalently for each i , one of
£i(g) is much larger than others, the EM algorithm converges faster than the
direct numerical solution using Brent’s method. However, when the signal
from the data is weak, numerical method may converge faster than EM (Kim
et al., 2011). In implementation, we apply 10 rounds of EM iterations. If the
estimate does not converge after 10 rounds, we switch to Brent’s method.

2.3.2 Estimating the genotype frequencies In this section, we assume all

samples have the same ploidy: m =m1 = - - - 2m” and aim to estimate $3, the
frequency of genotype g. The likelihood of {S0, . . . ,S,,,} is:
It Ill
Leo. . . . . S...) = Hzﬁxgng (6)
i2] g:0

with the constraint 2g Sg = 1. The EM iteration equation is
n (t)
Sig—1) = 1 Z giggly (7)
n i2] Zg/£i(g/)§:7t/)

An important application of genotype frequencies is to test HWE for
diploid samples (m=2). When genotypes are known, we can perform a

 

2988

112 /3.Io's[BurnoprOJXO'soueuiJOJurorq”:duq urorj papeolumoq

9103 ‘Og isnﬁnv uo ::

Inference using sequencing data

 

one-degree X2 test. This approach would not work for sequencing data as
it does not account for the uncertainty in genotypes, especially when the
average read depth of each individual is low. A proper solution is to perform
a likelihood-ratio test (LRT). The test statistic is
A A 2 A A2
D, = —210g —.mf') A = —210g —m1 _ 1”) 1216'”.— w)’ w ) (8)
£(§0~§11§2) “Soil wE2)

where

slr=arg$1ax£wr> (9)

is the max-likelihood estimate of the site allele frequency and similarly $0, $1
and $2 are the max-likelihood estimate of the genotype frequencies. Because
Emir) has one degree of freedom and £(é0 , SA] ,éz) has two degrees of freedom,
the De statistic approximately follows the one-degree X2 distribution. For
genotype data, De approaches the standard HWE test statistic computed
from a 3 X 2 contingency table.

2.3.3 Estimating haplotype frequencies between loci In this section, we
assume all samples are diploid. Given k loci, let h =(h1 , ...,hk) be a haplotype
where hj equals 1 if the allele at the j—th locus is identical to the reference,
and equals 0 otherwise. Let 7],; be the frequency of haplotype h satisfying
2,317,; :1, where

1 1 1
Zn]; 2 Z Z  Z nabs/1k)
1;

[1120/1220 hk:0

knowing the genotype likelihood at the j—th locus for the i-th individual
Ly)(g), we can compute the haplotype frequencies iteratively with:

(I) _ (I) k (1')
0+1) 77,; n 211/ 71,17 l_lj:1£i (hj‘l‘hj)
nh = n 2 (I) (I) (l) l H
i2] Zita/‘1“ 71,; 71,171 l_lj£i (hj+hj)

(10)

When sample genotypes are all certain, this EM iteration is reduced
to the standard EM for estimating haplotype frequencies using genotype
data (Excofﬁer and Slatkin, 1995).

The time complexity of computing Equation (10) is 0(n-4k) and thus it
is impractical to estimate the haplotype frequency for many loci jointly. A
typical use of Equation (10) is to measure LD between two loci.

2.3.4 Testing associations Suppose we divide samples into two groups of
size n1 and n—n 1, respectively, and want to test if Group 1 signiﬁcantly
differs from Group 2. One possible test statistic could be (Kim et al.,
2010, 2011)

mi)
£[11(12,[11)£[21(12,[21)
where 12! is the max-likelihood estimate of the site allele frequency of all
samples [Equation (9)], and 12d” and ﬁrm are the estimates of allele frequency
in Groups 1 and 2, respectively. Under the null hypothesis, D approximately
follows the one-degree X2 distribution.

A potential concern with the Dal statistic is that the computation of £(1lr)
assumes HWE. When HWE is violated, false positives may arise (Nielsen
et al., 2011). For diploid samples, a safer statistic is

ago 1 E1 1 $2)
£[”(él,”.El”.El”)£[21(é52].élzl.é£2])

D,l = —210g (11)

Da2=—2log (12)

which in principle follows the two-degree X2 distribution under the null
hypothesis. However, when both cases and controls are in HWE, the degree
of freedom is reduced and this statistic is underpowered.

We have not found a powerful test statistic robust to HWE Violation. For
practical applications, we propose to take the P-Value computed with Dt, 1,
while ﬁltering candidates having a low D”; to reduce false positives caused
by HWE Violation (see Section 3).

2.3.5 Estimating the number of non-reference alleles In this section, we
use the term site reference allele count to refer to the number of reference
alleles at one single site. Allele count is a discrete number while allele
frequency is contiguous.

For convenience, deﬁne random vector G=(G1, . . . , G”) to be a genotype
conﬁguration, and X: ZiGi to be the site reference allele count in all the
samples. Assuming HWE, we have

q ,1 (mi)
PrlG=§lX=k}=5k,sn(gv)H i

M
[:1 (k)
where s,(§)=zig, is the total number of reference alleles in a genotype

conﬁguration  and 8k, is the Kronecker delta function which equals 1 if
k=l and equals 0 otherwise. The likelihood of allele count is

a 1 ,
£(k)=Pr{d|X=k}= 7 Z---Zak,.,<§)1‘[ (m )Lxgi) (13)
(k) 81 En i g

i

where Zl:(a'1,...,a',,) represents all sequencing data. To compute this
probability efﬁciently, we deﬁne

m 1 "11 j

z), = Z  261.1911 (gyro) (14>
g,:0 i:l ’

31:0

for 0 5 l 5  1 mi and zﬂ = 0 otherwise. zﬂ can be calculated iteratively with

M)

m.
zit=sz_1,t_g,-< 04¢» (15)
81:0 g]

starting from Zoo 2 1. Comparing the deﬁnition of znk and Equation (15), we
know that

50:): % (16)

M
(k)
which computes the likelihood of the allele count.

Although the computation of the likelihood function £(k) is more complex
than of £(1lr), £(k) is discrete, which is more convenient to maximize or sum
over. This likelihood function establishes the foundation of the Bayesian
inference.

2.3.6 Numerical stability of the allele count estimation When computing
zﬂ with Equation (15), ﬂoating point underﬂow may occur given large j.
A numerically stable approach is to compute yﬂzzﬂ/ instead, where
M]- = 211:] mi. Thus

£(k)=ynk (17)

and by replacing zjk with yjk ) in Equation (15), we can derive:

mf—l k 1 mi
_ m.
yjk = H m Zyj_1,t_g, -< 04¢» (18)
1:0 1 g,:0 g]
Inf—l
H [Wj—l —k+l+1
k — l
lzgf
However, we note that yjl may decrease exponentially with increasing
j. Floating point underﬂow may still occur. An even better solution is to
rescale yjl for each j, similar to the treatment of the forward algorithm for
Hidden Markov Models (Durbin et al., 1998). In practical implementation,
we compute
it — y”
1 _ f
Hf: 1 ’1”
where tj is chosen such that 2,9), = 1.
As another implementation note, most yjl are close to zero and thus ynk
can be computed in a band rather than in a triangle. This may dramatically
speed up the computation of the likelihood.

 

(19)

 

2989

112 /3.Io's[BurnoprOJXO'soueuiJOJHrorq”:duq urorj popeo1umoq

9103 ‘0g isnﬁnv uo ::

H.Li

 

2.3.7 Calling variants In variant calling, we have a strong prior
knowledge that at most of the sites all samples are homozygous to the
reference. To utilize the prior knowledge, we may adopt a Bayesian inference
for variant calling. Let W, k=1,...,M, be the probability of seeing k
reference alleles among M chromosomes/haplotypes. For convenience,
deﬁne <I>={¢k}, which is in fact the sample AFS for M chromosomes.
Recall that X is the number of reference alleles in the samples. The posterior
of X is _1
Pr{szIM}: ¢kPridI§=k} 2 mac)

Zl¢lPr{a’|X=l} Zl¢lﬁ(l)
where £(k) is deﬁned by Equation (13) and computed by Equation (17). In
variant calling, we deﬁne variant quality as

(20)

Q,,, = —1010g10Pr{X=M|a', <1>}

and call the site as a variant if Qvar is large enough, because in deriving £(k),
we do not require the ploidy of each sample to be the same. The variant calling
method described here are in theory applicable to pooled resequencing with
unequal pool sizes.

2.3.8 Estimating the sample AF S For variant calling [Equation (20)], we
typically take the WrightiFisher AFS as the prior. We can also estimate the
sample AFS with the maximum-likelihood inference when the Wright-Fisher
prior deviates from the data.

Suppose we have L sites of interest and we want to estimate the frequency
spectrum across these sites. Let X”, a: 1, . . . ,L, be a random variable
representing the number of reference alleles at site a. We can use an EM
algorithm to ﬁnd (D that maximizes Pr{d|<1>}, the probability of data across
all samples and all sites conditional on AFS. The iteration equation is

1

l

a.” )=Z§ Pr{X.=k|d.<I><’>} (21)
(I

We call this method of estimating AFS as EM-AFS. Alternatively, we
may also acquire the max-likelihood estimate of the allele count at each site
using Equation (16). The normalized histogram of these counts gives the
AFS. We call this method as site-AF S . We will compare the two methods in
Section 3.

2.4 Discovering somatic and germline mutations

One of the key goals in cancer resequencing is to identify the somatic
mutations between a normal-tumor sample pair (Robison, 2010), which can
be achieved by computing a likelihood ratio. Given a pair of samples, the
following likelihood ratio is an informative score:

£[”(§)ﬁ[2](§)

£[11(§[11)£[21(g[21) (22)

D1) = —210g
where £['](g) is computed by Equation (2), g maximizes £[1](g)£[2](g), and
similarly gin and gm maximize £[1](g) and £[2](g), respectively.

Note that in most practical cases, g equals either gm or gm. When this
stands, we have:

£111(§)£[21(g)=max{£111(§[11)£[21(§[11)’£lll(§[21)£[21(§[21)}
and then we can prove:

‘ £[ll(g[ll) £[21(§[2l)
  {ml —£m<§m>’ Wm) i}

This equation has an intuitive interpretation: we are certain about a
candidate somatic mutation only if both genotypes in both samples are clearly
better than other possible genotypes.

A natural extension to discovering somatic mutations is to discover de novo
and somatic mutations in a family trio (Conrad et al., 2011). To identify
such mutations, we may compute the maximum likelihoods of genotype
conﬁgurations without the family constraint and with the constraint, and then

take the ratio between the two resulting likelihoods. The larger the ratio, the
more conﬁdent the mutation. More exactly, the likelihood ratio is:

max<gc,gf,gm)eg {£c(gc)£f(gf)£m (8111)}

D = —21
t 0g max£c(gc) ‘ max£f(gf) ' max£m(gm)

 

(23)

where £c(gc), £f(gf) and £,,,(g,,,) are the child, father and mother genotype
likelihoods, respectively, and g is the set of genotype conﬁgurations
satisfying the Mendelian inheritance.

Although most of the derivation in this article assumes that variants
are biallelic, we drop this assumption in the implementation for methods
described in this subsection. We have observed false somatic/germline
mutations caused by the mismodeling of triallelic variants (M.Depristo,
personal communication). The biallelic assumption may lead to false
positives.

2.5 Related works

During SNP calling, Thunder (Li et al., 2011) and glfMultiples
(http://bit.ly/glfmulti) compute the site allele frequency by numerically
maximizing the likelihood [Equation (2)]. Genome Analysis Toolkit (GATK;
Depristo et al., 2011) infers the frequency with EM [Equation (5)]. Kim
et al. (2011) infers the frequency with both the numerical and the EM
algorithms. Li et al. (2010b) derived an alternative method to estimate the
site allele frequency, which is not covered in this article. SquM (Martin
et al., 2010) estimates the genotype frequency using EM [Equation (7)] with
a different parameterization. Le and Durbin (2010) derived Equation (16).
The conclusion is correct, but the derivation is not rigorous: the binomial
coefﬁcient in Equation (13) was left out. Yi et al. (2010) came to a similar
set of equations to Equations (15) and (20), but the prior is taken from the
estimated site allele frequency. To the best of our knowledge, Kim et al.
(2010) is the ﬁrst to use genotype likelihood-based LRT to compute P-Value
of associations [Equation (11)] with more thorough evaluation in a recent
paper (Kim et al., 2011). Nielsen et al. (2011) further proposed to test
associations with a score test (Schaid et al., 2002). Except Kim et al. (2010),
all the previous works focus on diploid samples, while many equations in this
article can be in theory applied to multiploidy samples and pooled samples.

In this article, our contribution includes testing HWE, estimating
haplotype frequency, the proposal of two-degree association test, a simple but
effective model for discovering somatic mutations, the rigorous derivation
and numerically stable implementation of a discrete allele count estimator
and an EM algorithm for inferring AFS.

3 RESULTS

3.1 Implementation

Most of equations for diploid samples (m=2) have been
implemented in the SAMtools software package (Li et al., 2009a),
which is distributed under the MIT open source license, free to both
academic and commercial uses. The exact Equations (17)—( 19) have
also been implemented in GATK as the default SNP calling model.

The SAMtools package consists of two key components
samtools and bcftools. The former computes the genotype
likelihood £(g) using an improved version of Equation (2) that
considers error dependencies; the latter component calls variants
and infers various statistics described in this article. To clearly
separate the two steps, we designed a new Binary variant call
format (BCF), which is the binary representation of the variant
call format (VCF; Danecek et al., 2011) and is more compact and
much faster to process than VCF. On real data, computing genotype
likelihoods especially for INDELs is typically 10 times slower than
variant calling. The separation of genotype likelihood computation
and subsequent inferences enhances the ﬂexibility and improves the

 

2990

112 /3.Io's[BurnoprOJXO'soueuiJOJHrorq”:duq urorj popeo1umoq

9103 ‘0g isnﬁnv uo ::

Inference using sequencing data

 

Table 2. SAMtools speciﬁc VCF information

 

 

INFO” Equation” Description

AFl 3, 5 Non-reference site allele frequency

G3 7 Diploid genotype frequency

HWE 8 P-Value of Hardineinberg equilibrium

NEIR 10 Neighboring r2 linkage disequilibrium statistic

LRT 11 One-degree association test P-Value

LRT2 12 Two-degree association test P-Value

AC1 17, 18, 19 Non-reference site allele count

FQ 20 Probability of the site being polymorphic among
samples

CLR 22, 23 Log likelihood ratio score for de novo mutations

 

aTag at the VCF additional information ﬁeld (INFO).
bRelated, though not exact, equations for computing the values.

 

Beagle'impu'tatiori —x'—
ML estimate ----£I----

    

Root-mean-square deviation
4;

 

 

 

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
maximum imputed r-square to nearby SNPs

Fig. 1. Correlation of the site allele count accuracy with LD. The site allele
count is estimated with Beagle imputation (solid line) and with Equation (16)
(dashed line) at sites typed by the Omni genotyping chip. For each Omni
SNP, the maximum r2 LD statistic between the SNP and 20 nearby SNPs
called by SAMtools (10 upstream and 10 downstream) is computed from
imputed genotypes. Omni SNPs are then ordered by the maximum r2 and
approximately evenly divided into 15 bins. For each bin, the RMSD between
the Omni allele count and the estimated allele count is computed as a
measurement of the allele count accuracy.

efﬁciency for inferring AFS. Bc f tools also directly works with
VCF ﬁles, but is less efﬁcient than with BCF ﬁles.

Table 2 shows how VCF information tags generated by SAMtools
are related to the equations in this article. We refer to the
SAMtools manual page for detailed description.

3.2 Inferring the allele count

We downloaded the chromosome 20 alignments of 49 Pilot-1 CEU
samples sequenced by the 1000 Genomes Project using the Illumina
technology only. We called the SNPs with SAMtools and imputed
the genotypes with Beagle under the default settings. At 32522
sites genotyped using the Omni genotyping chip and polymorphic in
the 49 samples, the root-mean-square deviation (RMSD) between
the allele count acquired from Omni genotypes and the estimate
using Equation (16) equals 3.7, the same as the RMSD between the
Omni and the Beagle-imputed genotypes. Not surprisingly, imputed
genotypes are more accurate when there is a tightly linked SNP
nearby, while the imputation-free estimate is less affected (Fig. 1).

However, on the unreleased European data from the 1000
Genomes Project consisting of 670 samples, Beagle imputation

 

0.2 . . . . . .
‘i Complete Genomics —x—
 1000G pilot EM-AFS 
\ 1000G pilot site-AFS —----A—--
0.15 
‘5

Frequency

 

 

 

 

0 2 4 6 8 10 12 14 16 18
# derived alleles conditional on NA18507 hets

Fig. 2. The derived AFS conditional on heterozygotes discovered in the
NA18507 genome (Bentley et al., 2008; AC:SRA000271). Heterozygotes
were called with SAMtools on BWA (Li and Durbin, 2009) alignment.
The ancestral sequences were determined from the Ensembl EPO
alignment (Paten et al., 2008), with the requirement of the chimpanzee and
orangutan sequences being identical. The AFS at these heterozygotes were
computed in three ways: (i) from the nine independent Yoruba individuals
sequenced by Complete Genomics (Drmanac et al., 2010) and analyzed using
CGA Tools version 1.10.0; (ii) from nine random Pilot-1 Yoruba individuals
released by the 1000 Genomes Project using the EM-AFS method and
(iii) from the same 9 Pilot-1 individuals using site-AFS.

is better than our imputation-free method [RMSD(imput)= 12.7;
RMSD (imput-free)=15.0]. We conjure that this is because with
more samples, it is more frequent for two samples to share a long
haplotype. The LD plays a more important role in counteracting the
lack of coverage. Nonetheless, we should beware that sites selected
on the Omni genotyping chip may not be a good representative
of all SNPs. For example, for the sites on the Omni chip, only
8% of SNPs do not have a nearby SNP with r2 >0.05 in a 20-
SNP window (the ‘nearby SNPs’ include all SNPs discovered in
the 670 samples), but this percentage is increased to 30% for all
SNPs. The large fraction of unlinked SNPs might hurt the accuracy
of imputation-based methods.

We have also evaluated our method on an unpublished target
reqsequencing dataset consisting of ~2000 samples (Haiman,C.
and Henderson,B., personal communication). The imputation-based
method does not perform well [RMSD(imput) = 54.8; RMSD(imput-
free)=42.5], probably due to the lack of linked SNPs around
fragmented target regions.

3.3 Inferring the AFS

To evaluate the accuracy of the estimated AFS, we compared the
AFS obtained from the low-coverage data produced by the 1000
Genomes Project and from the high-coverage data released by
Complete Genomics (http://bit.ly/m7szF). Figure 2 reveals that
we can infer a fairly accurate AFS using the EM-AFS method
with 3-fold coverage per sample. On the other hand, the site-AFS
estimate is less stable, though the overall trend looks right. To
estimate properties across multiple sites, summing over the posterior
distribution using EM-AFS is more appropriate.

3.4 Performing association test

To evaluate the performance of the association test statistics Dal
[Equation (11)], we constructed a perfect negative control using
the 1000 Genomes data and derived the empirical distribution
of Dal. We expect to see no associations. Figure 3 shows that

 

2991

112 /3.Io's[BurnoprOJXO'soueuiJOJHrorq”:duq urorj popeo1umoq

9103 ‘0g isnﬁnv uo ::

H.Li

 

>

N (.0 J> 01 0') \I
r l r r
X‘

 

2-Idegre'e URI 5

Ilmp'utatio'n x
1-degree LRT :1

Observed -|og10(P-va|ue)

 

 

 

 

 

 

0 1 2 3 4 5 6 0 1 2 3 4 5 6
Expected -|og10(P-va|ue) Expected -|og10(P-va|ue)

Fig. 3. QQ-plot comparing the association test statistics to the one-degree
and the two-degree X2 distribution. The 49 CEU samples sequenced by
the 1000 Genomes Project using the Illumina technology were randomly
assigned to two groups of size 24 and 25, respectively. (A) two association
test statistics were computed on chromosome 20 between the two groups:
one by the one-degree likelihood ratio test [Equation (11)] and the other by
the canonical one-degree X2 test based on Beagle imputed genotypes; (B) the
two-degree likelihood rate test statistic [Equation (12)].

Dal largely follows the one-degree X2 distribution. However, this
method also produces one false positive SNP (P<10‘6). Closer
investigation reveals that the SNP signiﬁcantly violates HWE [P <
10_6, computed with Equation (8)], and thus violates the assumption
behind the derivation of Dal. In fact, if we test the association
with Daz which does not assume HWE, the false positive will be
suppressed (P>0.001). To test association using the one-degree
likelihood-ratio test statistic, it is important to control HWE.

3.5 Comparing sequencing data from the same
individual

3. 5.] Comparing datasets of similar characteristics We acquired
the NA12878 data used by Depristo et al. (2011). This sample
was sequenced with HiSeq2000 using two libraries with each put
on eight lanes and each sequenced to about 30-fold coverage. We
split the data in two by library and computed DI, [Equation (22)]
at each base on chromosome 20 to identify sites that are called
differently between the two libraries. With a stringent threshold
D1, 3 30 and without any ﬁltering, 32 differences are called between
the libraries and most from the centromere. Since the libraries were
made from the same DNA at almost the same time, we expect
to see no difference between the libraries. Seeing 32 differences
is very unlikely. To explore if this is due to mismapping, we
extracted reads around the 32 sites and remapped them with
BWA-SW (Li and Durbin, 2010). Four differences remain around
the centromere, implying that most of the differences between
libraries are caused by the variation in read mapping. We ﬁirther
mapped the reads around the four sites to a version of the human
reference genome used by the 1000 Genomes Project for phase-
2 mapping (http://bit.ly/GRCh37d). No differences are left. This
exercise reveals that when we come to very rare events, mapping
errors, instead of sequencing errors, lead to most of the artifacts.

3.5.2 Comparing datasets of diﬁ’erent characteristics We also
did a harder version of the exercise above: comparing this 60-
fold HiSeq data to the old Illumina data for the same individual
obtained >2 years ago by the 1000 Genomes Project. We note that
although DNAused in the two datasets was originated from the same

individual, somatic mutations in cell lines, which are of the order of
1000 per diploid genome (Conrad et al., 2011), may be present. If
the cell lines used in two studies have greatly diverged, we might
see up to a dozen somatic mutations on chromosome 20.

This time with a threshold D1, 3 30 and a maximum depth
ﬁlter 150, we identiﬁed 667 single-base differences between the
two datasets, far more than our expectation. Again we sought to
reduce mapping errors by remapping reads with BWA-SW to the
1000 Genomes Project phase-2 reference genome. The number of
differences between the HiSeq and the old Illumina data quickly
drops to 33. If we ﬁirther ﬁlter out clustered SNPs using a 100 bp
window, 13 potential differences are left, 2% of the initial candidates.
This exercise again proves that mismapping is the leading source of
errors.

To see if the simple likelihood ratio [Equation (22)] is
comparable to more sophisticated methods, we brieﬂy tried
SomaticSniper (Larson et al., in press) on our data. With a somatic
score cutoff 65, which is about 30 in the ‘2log’ scale as in D1,,
SomaticSniper identiﬁed 1826 differences. SAMtools called fewer,
because it limits the mapping quality of reads with excessive
mismatches and applies base alignment quality (Li, 2011) to ﬁx
alignment errors around INDELs. With the two features switched
off, SAMtools called 1696 differences, half of which overlap the
differences found by SomaticSniper. Calls unique to one method
tend to have a mutation score close to the threshold.

4 DISCUSSIONS

We have proposed a statistical framework for SNP calling as well
as analyzing sequencing data but without explicitly calling SNPs
or their genotypes. With this framework, we can discover somatic
and germline mutations with appropriate input data, efﬁciently
estimate site allele frequency, allele frequency spectrum and
linkage disequilibrium, and test Hardy—Weinberg equilibrium and
association. On real data, we have demonstrated that our method is
able to achieve comparable accuracy to the best alternative methods.
We have also extensively evaluated the performance of our method
on several unpublished datasets and got sensible results. Thus, we
conclude that useﬁil information can be obtained directly from
sequencing data without SNP calling or imputation.

Here we also want to emphasize a few ﬁndings in our evaluation of
the methods. First, we conﬁrmed that imputation is a viable method
for transferring our knowledges on genotyping data to low-coverage
sequencing data. It is likely to have higher accuracy than our
method given homogeneous whole-genome data consisting of many
samples. Nonetheless, we showed that the accuracy of imputation
depends on the LD nearby, which has long been speculated but
without direct evidence from real data until our work. Second, our
proposed EM-AFS method is able to accurately estimate AFS from
low-coverage sequencing data. It is more appropriate than estimating
the site frequency separately and then doing a histogram. Third,
we observed that violation of HWE may cause false positives in
association mapping with the one-degree likelihood ratio test (Kim
et al., 2011). A two-degree likelihood ratio test is a conservative
way to avoid such an artifact. At last, we highlighted the importance
of using data of similar characteristics in the discovery of somatic
mutations. We also want to put a particular emphasis on the
necessity of controlling mapping errors when looking for very rare
events such as somatic mutations, germline mutations and RNA

 

2992

112 /3.Io's[BurnoprOJXO'soueuiJOJHrorq”:duq uror} popeo1umoq

9103 ‘0g isnﬁnv uo ::

Inference using sequencing data

 

editing. It may be necessary to use two distinct mapping algorithms
to call variants and then take the intersection.

Frequently, we require to know the exact DNA sequences or
genotypes only to estimate parameters or compute statistics. In
these cases, the sequences and genotypes are just intermediate
results. When the sequence itself is uncertain, mostly due to the
uncertainty in sequencing and mapping, it may sometimes be
preferred to directly work with the uncertain sequence, which may
carry more information than an arbitrarily ascertained sequence.
We have showed that many population genetical parameters and
statistical tests can be adapted to work on uncertain sequences,
and believe more existing methods can be adapted in a similar
manner. Knowing the exact sequence is convenient, but not always
indispensable.

ACKNOWLEDGEMENTS

We are grateful to Christopher Haiman for providing the unpublished
dataset for assessing the performance, to Petr Danecek for evaluating
the methods in this article on large-scale datasets, to Rasmus Nielsen
for the observation on the occasional slow convergence of the EM
algorithm and to Si Quang Le and Richard Durbin for the help on
understanding the QCall model. We also thank the 1000 Genomes
Project analysis subgroup and the GSA team at Broad Institute for
various helpful discussions, and thank all the SAMtools users for
evaluating the software package.

Funding: National Institutes of Health (1U01HG005208-01).

Conﬂict of Interest: none declared.

REFERENCES

1000 Genomes Project Consortium (2010) A map of human genome variation from
population-scale sequencing. Nature, 467, 106171073.

Ajay,S.S. et al. (2011) Accurate and comprehensive sequencing of personal genomes.
Genome Res, 21, 149871505.

Bentley,D.R. et al. (2008) Accurate whole human genome sequencing using reversible
terminator chemistry. Nature, 456, 53759.

Brent,R.P. (1973) Algorithms for Minimization without Derivatives. Prentice-Hall,
Englewood Cliffs, New Jersey.

Browning,B.L. and Yu,Z. (2009) Simultaneous genotype calling and haplotype phasing
improves genotype accuracy and reduces false-positive associations for genome-
wide association studies. Am. J. Hum. Genet, 85, 8477861.

Conrad,D. et al. (2011) Variation in genome-wide mutation rates within and between
human families. Nat Genet, 43, 7127714.

Danecek,P. et al. (2011) The variant call format and vcftools. Bioinformatics, 27,
215672158.

Depristo,M.A. et al. (2011) A framework for variation discovery and genotyping using
next-generation DNA sequencing data. Nat Genet, 43, 491498.

Drmanac,R. et al. (2010) Human genome sequencing using unchained base reads on
self-assembling DNA nanoarrays. Science, 327, 78781.

Durbin,R. et al. (1998) Biological Sequence Analysis. Cambridge University Press,
Cambridge, UK.

Excofﬁer,L. and Slatkin,M. (1995) Maximum-likelihood estimation of molecular
haplotype frequencies in a diploid population. Mol. Biol. Evol., 12, 9217927.

Hodgkinson,A. and Eyre-Walker,A. (2010) Human triallelic sites: evidence for a new
mutational mechanism? Genetics, 184, 2337241.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method for the
next generation of genome-wide association studies. PLoS Genet, 5, e1000529.

Kim,S.Y. et al. (2010) Design of association studies with pooled or un-pooled next-
generation sequencing data. Genet. Epidemiol., 34, 479491.

Kim,S.Y. et al. (2011) Estimation of allele frequency and association mapping using
next-generation sequencing data. BM C Bioinformatics, 12, 231.

Le,S.Q. and Durbin,R. (2010) SNP detection and genotyping from low-coverage
sequencing data on multiple diploid samples. Genome Res, 21, 9527960.

Ley,T. J. et al. (2008) DNA sequencing of a cytogenetically normal acute myeloid
leukaemia genome. Nature, 456, 6372.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with burrows-
wheeler transform. Bioinformatics, 25, 175441760.

Li,H. and Durbin,R. (2010) Fast and accurate long-read alignment with burrows-wheeler
transform. Bioinformatics, 26, 5897595.

Li,H. et al. (2008) Mapping short DNA sequencing reads and calling variants using
mapping quality scores. Genome Res, 18, 185171858.

Li,H. et al. (2009a) The sequence alignment/map format and samtools. Bioinformatics,
25, 207872079.

Li,H. (2011) Improving SNP discovery by base alignment quality. Bioinformatics, 27,
115771158.

Li,Y. et al. (2009b) Genotype imputation. Annu. Rev. Genomics Hum. Genet, 10,
387406.

Li,Y. et al. (2010a) MaCH: using sequence and genotype data to estimate haplotypes
and unobserved genotypes. Genet. Epidemiol., 34, 813834.

Li,Y. et al. (2010b) Resequencing of 200 human exomes identiﬁes an excess of low-
frequency non-synonymous coding variants. Nat Genet, 42, 9697972.

Li,Y. et al. (2011) Low-coverage sequencing: Implications for design of complex trait
association studies. Genome Res, 21, 94e951.

Mardis,E.R. et al. (2009) Recurring mutations found by sequencing an acute myeloid
leukemia genome. N. Engl. J. Med., 361, 105871066.

Martin,E.R. et al. (2010) SquM: an adaptive genotype-calling approach for next-
generation sequencing studies. Bioinformatics, 26, 280372810.

Nakamura,K. et al. (2011) Sequence-speciﬁc error proﬁle of illumina sequencers.
Nucleic Acids Res, 39, 690.

Nielsen,R. et al. (2011) Genotype and SNP calling from next-generation sequencing
data. Nat. Rev. Genet, 12, 443451.

Paten,B. et al. (2008) Enredo and pecan: genome-wide mammalian consistency-based
multiple alignment with paralogs. Genome Res, 18, 181441828.

Pleasance,E.D. et al. (2010a) A comprehensive catalogue of somatic mutations from a
human cancer genome. Nature, 463, 1917196.

Pleasance,E.D. et al. (2010b) Asmall-cell lung cancer genome with complex signatures
of tobacco exposure. Nature, 463, 1847190.

Roach,J.C. et al. (2010) Analysis of genetic inheritance in a family quartet by whole-
genome sequencing. Science, 328, 633639.

Robison,K. (2010) Application of second-generation sequencing to cancer genomics.
Brief Bioinformatics, 11, 5244534.

Schaid,D.J. et al. (2002) Score tests for association between traits and haplotypes when
linkage phase is ambiguous. Am. J. Hum. Genet, 70, 425434.

Shah,S.P. et al. (2009) Mutational evolution in a lobular breast tumour proﬁled at single
nucleotide resolution. Nature, 461, 8097813.

Yi,X. et al. (2010) Sequencing of 50 human exomes reveals adaptation to high altitude.
Science, 329, 75778.

 

2993

112 /3.Io's[BurnoprOJXO'sorwuiJOJHrorq”:duq uror} popeo1umoq

9103 ‘0g isnﬁnv uo ::

