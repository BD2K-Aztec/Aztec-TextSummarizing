Biainfarmatics, 32(11), 2016, 1618—1624
doi: 10.1093/bioinformatics/btw287
Original Paper

 

 

Genome analysis

methylFlow: cell-specific methylation pattern
reconstruction from high-throughput
bisulfite-converted DNA sequencing

Faezeh Dorri1'2, Lee Mendelowitz1'3 and Héctor Corrada Bravo1'2'*
1Center for Bioinformatics and Computational Biology, 2Department of Computer Science and 3Applied
Mathematics, Statistics and Scientific Compoutation Program, University of Maryland, College Park, MD 20745,
USA

*To whom correspondence should be addressed.
Associate Editor: Gunnar Ratsch

Received on April 8, 2015; revised on January 8, 2016; accepted on April 17, 2016

Abstract

Motivation: DNA methylation aberrations are now known to, almost universally, accompany the ini—
tiation and progression of cancers. In particular, the colon cancer epigenome contains specific gen—
omic regions that, along with differences in methylation levels with respect to normal colon tissue,
also show increased epigenetic and gene expression heterogeneity at the population level, i.e. across
tumor samples, in comparison with other regions in the genome. Tumors are highly heterogeneous
at the clonal level as well, and the relationship between clonal and population heterogeneity is poorly
understood.

Results: We present an approach that uses sequencing reads from high—throughput sequencing of
bisulfite—converted DNA to reconstruct heterogeneous cell populations by assembling cell—specific
methylation patterns. Our methodology is based on the solution of a specific class of minimum
cost network flow problems. We use our methods to analyze the relationship between clonal het—
erogeneity and population heterogeneity in high—coverage data from multiple samples of colon
tumor and matched normal tissues.

Availability and implementation: http://github.com/hcorrada/methylFlow.

Contact: hcorrada@umiacs.umd.edu

Supplementary information: Supplementary information is available at Bioinformatics online.

 

1 Introduction

DNA methylation (DNAm) is a gene regulatory mechanism Where
silencing of gene expression is established by the chemical bond of
methyl groups to DNA at specific genomic regions (Holliday and
Pugh, 1975). It is the best understood heritable mechanism for gene
regulation that does not involve direct modification of DNA se—
quence itself. High—throughput sequencing of bisulfite—converted
DNA is used to measure DNAm modifications at base—pair level.
This approach has led to deeper understanding of the methylome’s
organization and its role in development (Lister et (11., 2009) and dis—
ease (Hansen et (11., 2011).

While single—cell methods to sequence bisulfite—converted DNA
are currently under development (Smallwood et (11., 2014), the most
reliable current method to measure DNAm at the base—pair level
across the entire methylome is to bisulfite—convert and sequence
DNA from a population of cells. A number of existing computa—
tional methods may then be used to calculate the percentage of
DNA fragments that harbor a DNAm modification at specific gen—
omic loci (Hansen et (11., 2012). In many normal human tissues, for
example, these percentages vary from the expected levels in a popu—
lation of diploid cells with identical DNAm modifications: 100%
(where all cells in the population are methylated at a specific locus),

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1518

9103 ‘Og JSanV uo seleﬁuv 50'] ‘BtHJOJtIBQ JO AJtSJQAtuf] 112 /3.10'speum0[p1q1x0"sothJJOJutotq/ﬁduq 11101} popcolumoq

Cell—specific methylation pattern reconstruction

1619

 

0% (where all cells in the population are unmethylated) or 50%
(where only one chromosome in all cells in the population are
methylated). For example, in the normal colon methylome, the
majority of the methylome is partially methylated at a level of
roughly 70—80% (Hansen et (11., 2011). Similar patterns are
observed in other human tissues (Timp et (11., 2014), and tissues in
other eukaryotes.

An obvious observation that follows from this is that cell popula—
tions in normal tissues are composed of epigenetically heterogenous
cells. Furthermore, when comparing DNAm across different tissues,
for example, colon normal tissue and colon tumor, Figure 1, or a
population of stem cells to a population of somatic cells, e.g. fibro—
blast (Lister et (11., 2009), differences in DNAm percentages at a spe—
cific locus is indicative of a shift in the epigenetic composition of
these cell populations.

Computational and statistical methods to study the epigenetic
composition of cell populations have been proposed based on the
analysis of DNAm modifications at multiple consecutive genomic
loci spanned by single sequencing reads (Landan et (11., 2012), where
they analyzed DNAm modifications at each group of four

(a) n: ITW{=" ‘I'Pw

 

        

Normal Tissue Tumor Tissue

commie-I communion

Fig. 1. Differences in DNAm percentage at a given locus are indicative of a
shift in the epigenetic composition of cell populations. (a) Base-pair-level
DNAm percentage estimate for three colon tumors and paired normal tissue
(Figure from Hansen et al., 2011). (b) Different shifts in the epigenetic com-
position of the cell population in a tissue lead to identical marginal differ-
ences of DNAm percentage at the base-pair level

Heterogeneous
Cell Composition

—I-

Aligned Reads

 

contiguous CpG dinucleotides using sequencing reads that span all
four Cst. They then calculate the proportion of reads compatible
with each of the 24 possible DNAm modifications over these four
positions. They summarize these 24 proportions to define the epipo-
lymorp/oism of each set of four contiguous Cst.

While these approaches have yielded great insight into how cell
populations differ epigenetically across different tissues, they only
provide a general summary of the epigenetic composition of these
cell populations. For instance, distinguishing between the two types
of cell population shifts illustrated in 1 is limited to those differences
observed over four contiguous Cst. To perform a comprehensive
analysis of these cell population shifts, the ability to reconstruct cell—
specific methylation patterns over longer genomic spans is required.

In this article, we present methylFlow, a novel computational
method to reconstruct cell—specific patterns using reads obtained
from sequencing bisulfite—converted DNA based on network ﬂow al—
gorithms. We report on a simulation study characterizing the behav—
ior of our method. We then present an application of this method
using ultra—high coverage targeted sequence in a colon cancer study
(Hansen et (11., 2011), and on whole genome sequencing of fully dif—
ferentiated B—cells and KSL and CLP progenitor cells (Kieffer—Kwon
et (11., 2013). We also perform a validation study using bisulfite—
converted DNA from single cells (Smallwood et (11., 2014). We be—
lieve that this method will allow for increased understanding of the
role of epigenetic heterogeneity at the cell population level in gene
regulation.

2 Methods

Our method uses sequencing reads from bisulfite—converted DNA to
reconstruct heterogeneous cell populations by assembling cell type—
specific methylation patterns spanning multiple Cst from read
overlaps (Fig. 2). It jointly reconstructs these methylation patterns
and quantifies their abundance in heterogenous cell populations.

2.1 Problem formulation
Our method assumes a set of aligned reads from a bisulfite—
converted DNA sequencing run sorted by genomic starting location.

Cell-Specific
Mcihylaiion Patterns

H—C—O—O—O—O—O—I—

 

 

H—O—O—O—H—O—O—

 

 

 

 

 

 r..'. t n tr- cr.

.V-Dth'ilalnj CDC: 0 I_Im—.o:h-,-am:i Cnc

Region Graph

 

Fig. 2. Overview of methylation pattern estimation: We assume that samples are obtained from cell populations (top left) that are epigenetically heterogeneous
as determined by distinct CpG methylation patterns along a genomic region (top right). Reconstruction is based on the overlap of bisulfite converted reads to a
reference genome (bottom left). Read overlaps and methylation calls are used to define a region graph (bottom right). Based on coverage (the number of reads
originating in each region), a minimum cost network flow problem to estimate the number and abundance of methylation patterns (paths in the graph)

9103 ‘Og isnﬁnv uo saiaﬁuv 50'] harmonica JO AJtSJQAtuf] 112 /310'S[BIIJHO[pJOJXO'SOlJBLUJOJIIlOlq”K1111] 11101} popcolumoq

1620

F. Dorri et aI.

 

For this article, we only analyze on cytosine methylation so that
each CpG overlapped by a given aligned read can be determined to
be methylated (M) or unmethylated (U). Each aligned read r is thus
associated with a starting genomic position 1 and a specific methyla—
tion pattern over the Cst it spans. The latter is defined by set
17, : {(offset,.m,-)} where offset,- specifies the location of the CpG
based on the read start position 1 and m,- E {M. U} specifies the
methylation status of the ith CpG covered by the read.

2.1.1 Overlap graph

Following existing methods from viral population reconstruction
(Eriksson et (11., 2008), we build a read overlap graph based on read
starting location and compatibility of methylation patterns. Read
overlap graph G0 : {V0, E0} contains a node for each aligned read
117, (as described above) originating from position 1 with methylation
pattern 17,. A directed edge (117,, mqs) between from source node 117,
to target node mqs is included in the graph if it satisfies the
following:

1. 1 < m: the starting position of the source is to the left of the start—
ing position of the target, and

2. methylation patterns 17, and q, are equal on overlapping cpgs (if
any), and

3. there is no path between 117, and mqs in the graph unless this
edge is present, so there are no paths between ancestors of the
target node.

We denote the number of reads originating at position 1 with
methylation pattern 17, as cm. This is the same construction as
Eriksson et (11., 2008 with methylation patterns taking the place of
variants in reads obtained from virus sequencing.

2.1.2 Coverage normalization

To build a statistical model, we first normalize the coverage in the
overlap graph to account for variability introduced by non—uniform
sequencing coverage and copy number variations. The number of
reads for node 117, is normalized as follows:

Let C) : Zp'cip, be the total number of reads originating in pos—
ition 1, and let 5 : medianici across a connected component of the
graph. The normalized number of reads for node 117, is defined as
3111,, : 6% X 5. After normalization, all positions 1 have total normal—

ized number of reads equal to 5.

2.1.3 Region graph

Building a statistical model over position—specific coverage is diffi—
cult owing to variability in low coverage experiments. To alleviate
this issue, we use the fact that DNAm modifications show high spa—
tial consistency (Holliday and Pugh, 1975) and convert the read
overlap graph G7 to a region graph G : {V. E} by collapsing non—
branching paths in the overlap graph G7 so that nodes now span
multiple genomic loci. The total, normalized, number of reads origi—
nating in region 11 E V is defined as y, : Ziggy)“. We define the
starting position 1,, of region 11 E V as min[{1p E v}, i.e. the smallest
position 1 over nodes of the overlap graph G7 contained in region 11.
We also merge read methylation patterns into region methylation
patterns (because by definition these are consistent), so that each re—
gion also defines a methylation pattern 17,, : Lathe/pr.

To complete the region graph, we add a source node 5 connected
to every region in the graph without an incoming edge, and a sink
node t connected to every region in the graph without an outgoing
node. Cell—specific methylation patterns 17 are defined by paths in

the region graph from start node 5 to end node t each with a specific
methylation pattern defined by the methylation patterns of the re—
gions in the path. We denote the abundance of cell—specific methyla—
tion pattern 17, equivalently path 17, as 01;.

Given this notation, the total abundance of methylation patterns
consistent with region 11 E V is given by the sum of the abundances
of paths that include 11: pravﬂp. Note that by construction the

following three sets are equal

{17217311}: U {17 2 27301.10} {1721730210}

2 U
{u:(1/,u)EE} {u’:(u’,1/)EE}
This just states that the set of paths going through node v E V
can be enumerated as the union of all paths going through all outgo—
ing edges {(11.14) E E}, or as the union of all paths going through all
incoming edges {(1/42) E  This implies

0p: Z Z 012: Z 012 (1)
{P117914 (“ii/WEE} HUGO/M} {u’I(“’«1/)EE} {17117901 «(0}

We will use relationship 1 in our estimation procedure.

2.1.4 Statistical model

We introduce a statistical model that motivates our reconstruction
algorithm based on fitting the normalized observed number of reads
3),, originating in region 12 E V of the region graph. This is similar to
statistical models used in viral population reconstruction methods
(Eriksson et (11., 2008), or RNA—seq (Bernard et (11., 2014).

Our goal is to estimate lEyv, the expected number of reads origi-
nating from region 11 as a function of the abundances 0,, of unob—
served methylation patterns 17. To do so, we need to define the
effective length of region 11 in pattern 17, which we denote 1,4,. As
every methylation pattern 17 corresponds to a path 17 through region
graph G, the effective length of region 11 E V within pattern 17 is
determined by outgoing edge (11.14) E 17. Specifically, the effective
length 2,4, : [W : 1,, — 1,, for every path 17 such that (11.14) E p and 1,,
and 1,, are the starting positions of regions 14 and 11, respectively. As
E31,, corresponds to the expected number reads originating in region
11, it is proportional to the effective length of the region.

Using this notation we model

112»: Z rwopz Z 2,, Z 0,.

{pa/6p} {u:(1/,u)EE} p:p3(1/,u)

Using a regularized method of moments, we estimate parameters
0,, corresponding to every possible path 17 through region graph G
by minimizing loss function

némZm— Z 2,, Z (gm/120,, (2)
P

P i/EV {u:(1/,u)EE} {p2p3(1/,u)}

where p ranges over all paths in the region graph and A is a regular—
ization term. This formulation is similar to the IsoLasso (Li et (11.,
2011) model defined for RNA—seq transcript assembly and quantifi—
cation. In our case, we use absolute loss to implement robust median
regression (instead of least squares regression).

2.2 Algorithmic solution

The regularized method of moment estimator yields a linear opti—
mization problem over a large number of unknowns, namely, the
number of possible paths through the region graph G : (V.  We
follow the idea behind the FlipFlop method (Bernard et (11., 2014)
developed for transcript assembly from RNA—seq data using regular—
ized loss functions. We do not explicitly solve over all possible paths
17, instead we introduce variables fun for each edge (11.14) E E defined

9103 ‘Og JSanV uo sajaﬁuv 50'] ‘Btulomcg JO AJtSJQAtuf] 112 /310'S[BHJnOprOJXO'SOIJBLUJOJIIIOIq/ﬂdnq 11101} papeolumoq

Cell—specific methylation pattern reconstruction

1621

 

as f1,“ : waamuﬂop and rewrlte the method of moments est1mat—

ing equation 2 as

mianiv— Z [Wﬁ/ul+l Z fut (3)

{u:(1/,u)EE} u:(u,t)EE

with regularization term 221,01, in Equation 2 rewritten using edge

variables fut where t is the sink node in G. Because all paths 17 end at
sink node twe have 2 0p : Z 2 0p : Z fut.
p {u:(u,t)EE} {pzp3(u,t)} {u:(u,t)EE}

To ensure variables f,,,, correspond to the sum of methylation
pattern abundances, equivalently paths, that include edge (u, n),
we add the following constraints, which follow directly from
Equation 1:

fi/u : Z fu’i/ 

{u:(1/,u)EE} {u’:(u’,1/)EE}

Because we are using absolute deviation as our method of mo—
ments estimating criterion we obtain a linear optimization program
with linear constraints. It corresponds to a network flow problem
where variable fun is the ﬂow assigned to edge nu and constraints in
Equation 4 correspond to standard network ﬂow balance
constraints.

2.3 Implementation

Our software takes as input a set of aligned bisulfite—converted
reads, which may be obtained using existing bisulfite—aware read
mappers (Hansen et a1., 2012; Krueger and Andrews, 2011). It as—
sumes the input is in SAM files as produced by the Bismark (Krueger
and Andrews, 2011) aligner. We solve the dual problem
(Luenberger, 1973) of the above linear optimization problem using
the GLPK (Makhorin, 2008) linear programming solver and the
LEMON (Dezso' et a1., 2011) C ++ library to represent and manipu—
late the read overlap and region graphs. Source code is freely avail—
able at http://github.com/hcorrada/methylFlow as C++ source
code, and includes a small R package for reading, visualizing and
manipulating resulting methylation patterns and their abundances.

3 Simulation

We performed a simulation study to evaluate the performance of
our algorithm based on how well it predicts the number of cell—
specific patterns, how many methylation calls are reconstructed cor—
rectly in each pattern and how well it predicts the abundance of
each pattern.

3.1 Simulation

Our simulation has two separate steps: first, we simulate n cell—spe—
cific methylation patterns over a genomic region and then simulate
the sequencing process to produce short reads using uniform sam—
ples across the simulated pattern. We call these simulated patterns
as true patterns.

3.1.1 Simulating true patterns
We use three different settings of increasing difficulty to simulate the
cell—specific true patterns:

' Simple: Number of true patterns is n : 2, one with 75% of
abundance and the other with 25% of abundance. The two pat—
terns share almost no Cst with the same methylation status.

' Moderate: Number of true patterns is n : 4, with 15%, 15%,
30% and 30% of abundances, respectively. Patterns share a
moderate number of Cst with the same methylation status.

' Hard: Number of true patterns is n : 10, all with 10% of abun—
dances and only a small number of Cst have distinct methyla—
tion status across patterns.

Further detail on the simulation process is included in
Supplementary Material.

3.2 Error metrics for simulation

Error metrics are based on first matching each simulated pattern
with one or more of the patterns estimated by our method, and then
determining error in abundance estimates or methylation calls for
the estimated patterns based on this matching. We note that these
error metrics are only applicable in simulation settings where true
patterns and abundances are known.

To match estimated patterns to simulated patterns, we build a bi—
partite graph ({S. T}. E): each node in S represents simulated pattern
with abundance 0,- while set T has a node for each estimated pattern
with abundance of. Each edge connecting node i E S to node j E T
has weight 10,-,- equal to the total number of methylation call differ—
ences between patterns i and j. 10,-,- equals the number of overlapping
Cst with different methylation status plus the number non—
overlapping Cst. 10,-,- is zero if patterni E S exactly matches pattern
/' E T in all their methylation calls and have no non—overlapping
CpG sites. We then solve a minimum weight matching problem on
the bipartite graph so that the matching node of simulated pattern i
is the estimated pattern / in set T, which has the smallest weight 10,-,-
among neighbors of node i. Below we use indicators xi,- equal to 1 if
i and j are matched and is equal 0 otherwise.

To better understand the behavior of error metrics, we report
errors for multiple thresholds based on weights 10,7. If the number of
methylation call errors between estimated and simulated patterns is
above the threshold, then the match is not used when calculating

error metrics below.

3.2. 1 Abundance error

Based on the resulting matches for each estimated pattern, we deter—
mine a score to evaluate how well our algorithm predicts the average
abundance of patterns as follows:

1 0- — 0- 2
Average abundance error : — E E 
" iES yjeT:x,,:1 1'

This error metric shows how well our algorithm predicts the
abundance of simulated patterns. Because the abundance of patterns
is different in different settings, we compare the abundance of true
patterns by their matched estimated patterns and scale them by the
abundance of true patterns. This gives us the relative error between
the abundance of true and estimated patterns.

3.2.2 Methylation call error

Our second error metric evaluates the prediction of methylation
calls for estimated patterns. We use the same bipartite graph and
same matching problem we did for calculating the average abun—
dance error. Hence, based on our bipartite graph and the matches
for every simulated pattern, we determine a score to evaluate how
well our algorithm predicts the methylation patterns as follows:

9103 05 isanV uo sapﬁuv 50'] ‘BIIIJOJIIBD JO AJtSJQAtuf] 112 /310'S[BHJHO[pJOJXO'SOiJ’BLUJOJIItOiq”K1111] 11101} papeo1um0q

1622

F. Dorri et aI.

 

. 1
Average methylatlon call error n  [Had 10,,

The average methylation call error shows how well the estimated
patterns are matched to true patterns. It is equal to the average num—
ber of methylation status errors between simulated and their
matched estimated patterns. Because we are using these weights to
discard matched patterns, we expect that the methylation call error
is less than the corresponding threshold.

3.2.3 Minimum cost network ﬂow error

Our third error metric evaluates performance based on both methy—
lation call error and pattern abundance estimates. In this metric
there is no threshold used to filter pattern matches between simu—
lated and estimated patterns. Instead, we run a minimum cost net—
work ﬂow problem that matches every true pattern to a set of
estimated patterns on the same bipartite graph. Further details are
included in Supplementary Material.

4 Results

4.1 Simulation study

To evaluate the performance of our algorithm, we need to consider
the average abundance error and average methylation call error sim—
ultaneously, as abundance errors may increase as more stringent
thresholds are placed on methylation call error. In Figure 3 (A—C),
average abundance error versus average methylation call error is
shown for the moderate simulation setting as we test the effect of
coverage, number of Cst and read length on the reconstruction al—
gorithm. We show the effect of using different methylation call error
thresholds on matched patterns and the error metrics.

We observed that abundance error decreases and methylation
call error increases as read length and coverage increases. Increasing
coverage and read length help to decrease the problem complexity
and have a more accurate reconstructed pattern. In particular, we
observed that while doubling coverage from 5 X to 10 X significantly
decreases error, doubling coverage from 10>< to 20>< has much less
pronounced effect. Increasing the number of Cst increases the
complexity of the problem and both average abundance and average
methylation call error increase. In this Figure 3D, CpG, read length
and coverage are fixed, while pattern complexity is varied.
Methylation call error and average abundance error increase as the
complexity of patterns increases.

Supplementary Figure 1 shows the minimum cost network ﬂow
error metric for our three simulation settings as a function of cover—
age, number of Cst and read length. By increasing coverage and
read length, as we expect, the complexity of reconstruction de—
creases and the error decreases consequently with error decreasing
sharply from 5 X to 10>< coverage, with slower decrease after that.
Because we are reading CpG positions from a real data set, increas—
ing the number of CpG sites are expanding the genomic region but
the density of CpG sites remains almost the same. Hence, we see a
slight increase in the error.

Our algorithm is less dependent on the number of Cst. The
performance of our algorithm slightly decreases by increasing num—
ber of Cst and that is mainly because of the extension in the length
of reconstructed region. Coverage has more significant effect on the
performance of our algorithm. We see more errors in low coverage
regions. Also our algorithm performs better if we could have longer
sequencing reads and less ambiguity between cell—specific patterns.

 

 

 

 

 

 

 

 

 

 

   

 

 

 

 

A Coverage B CpG
0. _ q _ .
V. . 5 _ ..
o w
3 . . 20 a _
E m. _ m g. -
8 ° 8 _
c . :
‘° v. 3 m
'g q _ . g o. _
3 o .D
< _ <1 -
V. _
V ’ a
o' — . . , I I | r r u u u u
0.0 0.2 0.4 0.6 0.0 °-°° 04° 0-20 0-30
Methleall Error Methy|Ca|| Error
Read Length
C a — -. D
D. _
'2' ' ._ '
._ a, _ e
g o m =3. _
u _ a)
c 0 0
(ﬂ . _
g g- — é o I I ,-
= _ c g .. .,
'0 = D- — i 
< V. _ g |
o N. _
I I I I I I I a I I I I I
0.00 0.10 0.20 0.30 0.0 0.1 0.2 0.3 0.4
Methleall Error Memleall Error

Fig. 3. Average abundance error versus average methylation call error in dif-
ferent setting of simulation and various thresholds in moderate complexity of
patterns. Points correspond to increasing threshold on methylation error be-
tween matched patterns. Panels show the effect of different (A) coverage, (B)
number of CpG sites and (C) short read length on error. (D) Average abun-
dance error versus average methylation call error in different simulated pat-
tern complexity with fixed coverage, number of CpG and short read length

 

 

in _ a _
— Hum _ mm

a + Moderate 5 + Madam
t a + simple : + Simplﬁ
u.| D- - . u.| -
3 /:7" E
u. g _ /.¢:/ .1
a ~/./ 0
o . o
o _ o
E .5
E ‘ 2

0 - O

 

 

 

 

 

r r r r .
10410" 10° 10‘ 102

Noise Lambda

Fig. 4. (Left) Sensitivity to the noise level in the input. Minimum cost flow
error for various noise levels, probability error in sequencing, of the input
data. (Right) Sensitivity to regularization parameter 2. Minimum cost flow
error for various values of the regularization parameter

We also evaluate sensitivity of our algorithm to error in sequenc—
ing CpG methylation status. Figure 4 shows that the minimum cost
ﬂow error increases by increasing the probability of noise. Note that
when the noise level is 50, i.e. p(error) : 0.5 in sequencing, then the
short reads are random, and thus the output will be random, i.e. the
minimum cost ﬂow error is around 0.5. The regularization param—
eter A indirectly controls the number of estimated patterns. As can
be seen in Figure 4, the methylFlow algorithm is not sensitive to
regularization parameter in a wide range of A. In particular,
methylFlow achieves consistently good performance with A varying
from 0 to 100 for different types of simulated data. This is an inter—
esting property because we do not need to tune the regularization
parameter precisely in the real data sets.

4.2 Single—cell sequencing data

We also evaluated our algorithm using a single—cell bisulfite sequenc—
ing (scBS—seq) dataset (Smallwood et a1., 2014). Smallwood et a1.
performed scBS—Seq on mouse embryonic stem cells (ESCs) cultured
either in 2i (2i ESCs) or serum (serum ESCs) conditions to determine
whether scBS—Seq can reveal DNAm heterogeneity at the single—cell
level. To evaluate the performance of our algorithm, we ran our al—
gorithm separately on 2i and serum single—cell datasets that were
aligned to GRCm38 mouse genome using Bismark in single—end
mode. We observed that our algorithm reconstructed a single pat—
tern for 93% of the regions covered and obtained two patterns for
6% of covered regions. We also ran methylFlow on a mixture of 2i
and Serum samples. For 79% of regions, methylFlow recovered

9103 05 isanV uo sapﬁuv 50'] ‘BIIIJOJIIBD JO [(1151910qu 112 /310'S[BHJHO[pJOJXO'SOIIBLUJOJIIIOICI”K1111] 11101} papeo1um0q

Cell—specific methylation pattern reconstruction

1623

 

exactly the same number of patterns as expected from the mixture.
For 17% of the regions, methylFlow recovered one fewer pattern
than expected from the mixture. This result suggests that
methylFlow is capable of identifying long—range methylation pat—
terns in an epigenetically heterogeneous cell population.
Unfortunately, coverage for single—cell sequencing data is too low to
reliably estimate our algorithm’s performance in estimating the
abundance of patterns in a heterogeneous cell population.

4.3 Ultra—high coverage—targeted sequencing

We applied our method to data from a targeted bisulfite sequencing
experiment on three colon tumors and matched normal tissue
(Hansen et a1., 2011). Read lengths in this dataset are either 73 or
80 bp, and we used the provided read alignments with a post—
processing script (available on request) to resolve strand—aware
methylation status as reported by the alignment tool before construct—
ing the read overlap graph. We were able to reconstruct cell—specific
methylation patterns with median length 110—200 bp (Fig. 5. Patterns
longer than 350 bp were reconstructed in each sample).

Because the true cell—type methylation patterns are not known,
the error metrics presented in Section 3.2 are not applicable. In real
datasets, we instead report performance by comparing marginal
methylation percentage of estimated patterns at CpG level to those
estimated from short reads directly. Because we are not using this in—
formation in reconstructing patterns, similar beta value (marginal
methylation percentage) could evaluate the performance of our
method. Figure 5, panels C and D, shows the marginal methylation
percentage from estimated patterns are highly correlated with mar—
ginal methylation estimates from short reads (correlation 0.89).

As illustration of the type of inference provided by our method,
we show in Figure 6 the patterns estimated for a differentially
methylated region. We obtained the most differentially methylated
region in chromosome 13 using bumphunter software (Jaffe et a1.,
2012). The Figure depicts the estimated patterns in every sample
along with their abundances in this hyper—methylated region. We
observed that populations in tumor are more heterogenous than in
normal (which itself is heterogenous to a small degree), and that
dominant patterns in the normal population are present in the tumor
population.

4.4 Whole genome sequencing
We also applied our method to a whole genome bisulfite sequencing
(WGBS) data on mouse wild—type activated B cells and mouse CLP
and KSL cells (Kieffer—Kwon et a1., 2013) aligned using bis—
mark_v0.11.1. The length of short reads is 50 bp, and all analyses
were done relative to the mm10/GRCm38 assembly of the mouse
genome. We were able to reconstruct cell—specific methylation pat—
terns with median length 200—750 bp (Supplementary Fig. S2).
Patterns longer than 750 bp were reconstructed in each sample.
Again, we report the performance of our method using the mar—
ginal methylation percentage of estimated patterns at Cst to those
obtained from short reads directly. Supplementary Figure 2, panels
C and D, shows the marginal methylation estimates from patterns to
those obtained from short reads (correlation 0.92 and 0.91).

5 Discussion and Conclusion

We have presented an algorithmic method to reconstruct cell—
specific methylation patterns using overlap and coverage of sequenc—
ing reads of bisulfite—treated DNA. Our method allows researchers
to probe intra—cellular epigenomic heterogeneity from a standard

monstruclld flagmlm Ii:- 3 numb-r u: =ng m rlculmmcwd angina.
III . . =- . __

; c

v».

3.

i—ELT:£ ?4~+=4;

. I . . I
it 15 la NI ND NE

i

r». 7|:
1mm“ .
1..

J

11 I: 1.5 mi N5 N17

c Tumor Sample D Malena! Normal Sample
{:1 I n. ._ .  _....
a.” u’ ' 
am am "
Fad Tad ' '
s 2
23- if:
T- 3
z _
_ —<r
23 go-
 3:.
C! . .. RC?
0 -I I o

   

 

.l . . . I I
0.0 0 2 U 11 0.5 fl 5 1.0
manor. methyl Pieceniage

. I I
0|: El? 0.4 Elﬁ 0.810
'enrcn manna Pretend”?

Fig. 5. Pattern estimation in targeted bisulfite sequencing of three colon
tumors and matched normal tissue in chromosome 13. (A) Length distribu-
tions of reconstructed cell-specific methylation patterns. (B) Distributions of
the number of Cst per reconstructed cell-specific methylation patterns. (C
and D) CpG methylation percentage estimated from reconstructed cell-spe-
cific methylation patterns (pattern methyl Percentage) versus observed CpG
methylation percentage (region methyl Percentage) for a single tumor sam-
ple and matched normal

 

 

 

 

 

 

 

 

 

 

 

r! it

5 :

 

 

 

 

m
'22:
1333
..,.
3555
:3: 4 . a.
a: i i
3:: a :
09‘ 0 I I 0
3 3 i

Fig. 6. Differentially methylated region between colon tumors and matched
normal pairs with corresponding patterns and their abundances across differ-
ent samples. The top panel shows the marginal methylation percentage and
the average curve of marginal methylation percentage as estimated by bump-
hunter. The bottom panel depicts the methylation patterns of samples. Blue
bars represent the abundance of corresponding patterns. The abundances
are normalized by sum of the abundances of all patterns in selected region

sequencing experiment of pooled cells. This work opens new av—
enues in the analysis of epigenomes as statistical extensions to our
work here can start addressing questions of differential presence of
cell—specific methylation patterns across phenotypes of interest, and
begin to understand specific changes in the epigenomic complexity
of cell communities.

Some cell—devoncolution methodologies like methylPurify
(Zheng et a1., 2014) use regions with bisulfite reads showing dis—
cordant methylation levels to infer tumor purity from tumor samples
alone. They do not assume any genomic variation information or
prior knowledge from other datasets. Some restrictions in their
method is that they infer the fraction of normal cells within tumor
samples by assuming that there are only two component of normal
and tumor cells. They also detect differentially methylated regions
from tumor and normal cell lines, under assumption of homoge—
neous tumor and normal cell lines. Because they only consider CpG
sites, they expect to see consistent methylation level within short

9103 05 isnﬁnv uo sapﬁuv 50'] ‘Btulonng JO [(1151910qu 112 /310's1eu1n0[p10}x0"sothJJOJutotq/ﬁduq 11101} papeo1um0q

1624

F. Dorri et aI.

 

intervals (300 bp). Houseman et a1. (2012) also present a statistical
method to infer the distribution of different cells in a subpopulation
and similarly, methylMix (Gevaert, 2015) developed a computa—
tional algorithm to identify differentially methylated genes that are
also predictive of transcription. The two latter methods used the
Illumina Infinium HumanMethylation 2712 or 45 012 BeadChip.

Our simulation study shows that our methodology is sensitive,
as other similar methods for sequencing data, to sequencing depth.
Figure 3 indicates that that our approach works well at depths of
210x. Our software outputs total coverage per connected compo—
nent in the region graph. In practice, regions that have <10>< aver—
age coverage should be removed for downstream analysis.

While we have not applied our method to Reduced
Representation Bisulfite Sequencing (RRBS) data (Meissner et al.,
2005), it should directly apply as presented in this manuscript, under
the same caveats regarding coverage discussed above. RRBS is de—
signed for high—density regions, and usually tends to yield higher
coverage than WGBS, which makes it suitable for our methodology.
Our method requires single—fragment methylation calls as input as
provided by sequencing assays, which makes it unsuitable for array—
based assays, tiling (Irizarry et al., 2008) or based on Bisulfite con—
version as signal in this case depends on the number of methylated
and unmethylated fragments in a pool of cells (Bibikova et al.,
2011). While we believe that our normalization method somewhat
alleviates coverage biases stemming from sequence or amplification
effects, a normalization model that incorporates relevant technical
covariates could significantly improve any instability in our estima—
tion method stemming from coverage biases.

As presented here, our method only performs reconstruction of
patterns for single samples (e.g. a single tumor sample). A consider—
ation for future work is to establish an algorithm that jointly esti—
mates cell—specific methylation patterns across samples. However,
our graph matching procedures described in Section 3.2 can be used
to associate estimated patterns across individual samples in subse—
quent analyses.

Acknowledgements

The authors thank Rafael A. Irizarry at the Dana Farber Cancer Institute and
Winston Timp at Johns Hopkins University for insightful discussion.

Funding

This work was partially supported by NIH grant ROl—HG005220 and fund—
ing provided by the University of Maryland/Mpowering the State through the
Center for Health-related Informatics and Bioimaging.

Conﬂict of Interest: none declared.

References

Bernard,E. et a1. (2014) Efﬁcient RNA isoform identiﬁcation and quantiﬁca-
tion from RNA-Seq data with network ﬂows. Bioinformatics (Oxford,
England), 30, 2447—2455.

Bibikova,M. et a1. (2011) High density DNA methylation array with single
CpG site resolution. Genomics, 98, 288—295.

Dezso’,B. et a1. (2011) Lemon—an open source C++ graph template library.
Electron. Notes Theor. Comput. Sci., 264, 23—45.

Eriksson,N. et a1. (2008) Viral population estimation using pyrosequencing.
PLOS Comput. Biol., 4, e1000074.

Gevaert,O. (2015) Methylmix: an R package for identifying DNA
methylation—driven genes. Bioinformatics, 31, 1839—1841.

Hansen,K.D. et al. (2011) Increased methylation variation in epigenetic do—
mains across cancer types. Nat. Genet., 43, 768—775.

Hansen,K.D. et a1. (2012) BSmooth: from whole genome bisulﬁte sequencing
reads to differentially methylated regions. Genome Biol., 13, R83.

Holliday,R. and Pugh,J.E. (1975) DNA modiﬁcation mechanisms and gene ac-
tivity during development. Science (New York, NY), 187, 226—232.

Houseman,E.A. et al. (2012) DNA methylation arrays as surrogate measures
of cell mixture distribution. BMC Bioinformatics, 13, 86.

Irizarry,R.A. et a1. (2008) Comprehensive high—throughput arrays for relative
methylation (CHARM). Genome Res., 18, 780—790.

Jaffe,A.E. et a1. (2012) Bump hunting to identify differentially methylated re—
gions in epigenetic epidemiology studies. Int. ]. Epidemiol, 41, 200—209.
Kieffer-Kwon,K.R. et a1. (2013) Interactome maps of mouse gene regulatory
domains reveal basic principles of transcriptional regulation. Cell, 15 5,

1507—15 20.

Krueger,F. and Andrews,S.R. (2011) Bismark: a ﬂexible aligner and methyla-
tion caller for Bisulﬁte-Seq applications. Bioinformatics (Oxford, England),
27,1571—1572.

Landan,G. et a1. (2012) Epigenetic polymorphism and the stochastic forma-
tion of differentially methylated regions in normal and cancerous tissues.
Nat. Genet., 44, 1207—1214.

Li,W. et al. (2011) Isolasso: a lasso regression approach to RNA-Seq based
transcriptome assembly. ]. Comput. Biol., 18, 1693—1707.

Lister,R. et a1. (2009) Human DNA methylomes at base resolution show wide-
spread epigenomic differences. Nature, 462, 315—322.

Luenberger,D.G. (1973) Introduction to Linear and Nonlinear Programming,
Vol. 28. Addison-Wesley, Reading, MA, USA.

Makhorin,A. (2008) GNU Linear Programming Kit, Version 4.47. http:/I
WWW.gnu.org/software/glpk/glpk.html.

Meissner,A. et a1. (2005) Reduced representation bisulﬁte sequencing for com—
parative high-resolution DNA methylation analysis. Nucleic Acids Res., 33,
5 86 8—5 877.

Smallwood,S.A. et a1. (2014) Single—cell genome-wide bisulﬁte sequencing for
assessing epigenetic heterogeneity. Nat. Methods, 11, 817—820.

Timp,W. et a1. (2014) Large hypomethylated blocks as a universal deﬁning
epigenetic alteration in human solid tumors. Genome Med., 6, 61.

Zheng,X. et a1. (2014) Methylpurify: tumor purity deconvolution and differ-
ential methylation detection from single tumor DNA methylomes. Genome
Biol., 15, 419.

9103 ‘01; isanV uo sepﬁuv 50'] ‘Btulonng JO [(1151910qu 112 )310'SIBHJnOprOJXO"SOIJ’BLUJOJIIIOICIHK1111] 11101} papeo1um0q

