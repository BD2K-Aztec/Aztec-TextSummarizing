APPLICATIONS NOTE

Vol. 31 no. 1 2015, pages 109—111
doi:1 0. 1093/bioinfonnatics/btu588

 

Genome analysis

Advance Access publication August 81, 2014

GenPlay Multi-Genome, a tool to compare and analyze multiple
human genomes in a graphical interface

Julien Lajugiel, Nicolas FourelT and Eric E. Bouhassira*
Department of Cell Biology, Albert Einstein College of Medicine, New York, NY 10461, USA

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: Parallel visualization of multiple individual human genomes
is a complex endeavor that is rapidly gaining importance with the
increasing number of personal, phased and cancer genomes that
are being generated. It requires the display of variants such as
SNPs, indels and structural variants that are unique to specific
genomes and the introduction of multiple overlapping gaps in the
reference sequence. Here, we describe GenPlay Multi-Genome, an
application specifically written to visualize and analyze multiple
human genomes in parallel. GenPlay Multi-Genome is ideally suited
for the comparison of allele-specific expression and functional gen-
omic data obtained from multiple phased genomes in a graphical
interface with access to multiple-track operation. It also allows the
analysis of data that have been aligned to custom genomes rather
than to a standard reference and can be used as a variant calling
format file browser and as a tool to compare different genome assem-
bly, such as hg19 and thS.

Availability and implementation: GenPlay is available under the GNU
public license (GPL—3) from http://genplay.einstein.yu.edu. The source
code is available at https://github.com/JulienLajugie/GenPlay
Contact: eric.bouhassira@einstein.yu.edu or julien.lajugie@gmail.com
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 25, 2014; revised and accepted on August 26, 2014

1 INTRODUCTION

Allele-speciﬁc analyses, which are much more powerful when
they are performed on phased genomes, can shed light onto
myriad questions related to genotype/phenotype correlations,
parental imprinting, X chromosome inactivation, DNA methy-
lation, DNA replication and chromatin structure. Most genomes
produced to date are unphased, but technology is now available
to reliably generate phased genomes (Browning and Browning,
2009; Kitzman et al., 2011; Lajugie and Bouhassira, 2011; Peters
et al., 2012; Roach et al., 2010; Yang et al., 2011). One current
difficulty in performing allele-specific analysis is the lack of
software to Visualize and compare expression, epigenetic and
other functional genomics data obtained from multiple phased
genomes. Visualization of such data is difﬁcult because of the
presence of large number of indels and structural variants in
humans. GenPlay Multi-Genome, a major update to GenPlay,

 

*To whom correspondence should be addressed.
7‘The authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

was developed to help resolve some of these problems. GenPlay
is a multi-platform active genome browser and analyzer written
in Java. As other browsers (Blankenberg et al., 2010; Challis
et al., 2012; Faith et al., 2007; Fernandez-Suarez and Schuster,
2010; Lukashin et al., 2011; Nicol et al., 2009; Sandve et al., 2010;
Stein et al., 2002), GenPlay can display RNA-seq, ChIP—seq,
Methyl-seq or TimEX-seq and a variety of DNA sequence and
annotation tracks. In addition, GenPlay is unique because it can
rapidly transform any loaded data using >100 pre—programmed
operations (Lajugie and Bouhassira, 2011).

2 METHODS

To keep track and visualize all the deletions and insertions between
genomes to be compared, GenPlay creates on the ﬂy a global system of
genomic coordinates that represents the sum of all the genomes to be
analyzed in parallel in a multi-genome session (Supplementary Fig. Sl).
We termed this global system of coordinate a meta-reference genome.
With this approach, two genomes (G1 and G2) mapped relative to
hg19 are represented in memory by all the offsets between hg19 and
the meta-reference-genome, G1 and the meta-reference-genome and G2
and the meta-reference genome. The meta-reference genome is created
using user-provided variant calling format (VCF) ﬁles, which are text ﬁles
containing the position, the sequence and genotype information for all
the variants in one or more individuals (Danecek et al., 2011). At least 20
genomes can be loaded concurrently in GenPlay on a standard worksta-
tion with at least 4 GB of RAM. The meta-reference genome created by
GenPlay is a simpliﬁed version of the threaded blockset concept that was
developed by Blanchette et a]. (2004) to generalize the classic notion of
multiple alignments. Although software such as TBA/MultiZ is ideal for
interspecies alignments, the meta-reference genome concept as imple-
mented in GenPlay is most useful for comparison of phased or unphased
human genomes and can also be used for interstrain or interspecies
analysis provided that all genome studied are closely related.

3 RESULTS

Once the meta-reference genome is computed, GenPlay can
display the genetic variants present in all of the loaded genomes.
Insertions that are present in only some of the genomes are
replaced by synchronization blocks (Fig. 1 and Supplementary
Fig. S2). Inversions are displayed as the sum of a deletion plus an
insertion. Filters are available to select variants according to any
of the ﬁelds present in the VCF file (genotype, phasing, allele
depth, quality value, genotype probability, etc.). Filters can be
combined to create complex ﬁlters. In multi-genome mode,
GenPlay becomes a powerful VCF ﬁle browser that can be
used to Visualize the structure of multiple genomes in a graphical
interface. GenPlay also allows users to Visualize, analyze and

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 109

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} papaolumoq

91oz ‘Og anﬁnV uo ::

J.Lajugie et al.

 

  
   
     
 

  

Genomn: :nnﬁ names
relative to haploid worn:

 

 

 

 

 

 

 

 

 

 

 

   

DMD-4W" mm select the
rdinate system in currentdispli

 

 

 

 

 

 

 

m‘ﬂi' mum --
I... A. .. . . I.
I cumin" mm mu: Lang“ Illa-L “1er
EH .2 :n.:..ma ' _
lulu-1.15m“ nun-y
mam 2 win Mam: ._
_mm1.3_m_:|.umu |
mu: s_:us_n mm: -:

Fig. 1. Screenshot of a multi-genome session illustrating the synchron-
ization blocks

transform expression and epigenetic data at the same time as the
genetic data. In practice, the genetic variants are displayed as
stripes, which can be superimposed to tracks containing expres-
sion, epigenetic data or annotations.

Data from VCFﬁles obtained from RNA-seq, Chip-seq,
Methyl-seq or any other experiments performed on phased
genomes can be converted to allele-speciﬁc data tracks based
on the phasing information present in the VCFﬁle. The con-
verted tracks can be intersected with gene tracks or any other
track to measure expression or any epigenetic mark in an allele-
speciﬁc manner. An example of an allele-speciﬁc analysis
performed in GenPlay can be found in a recent article exploring
the regulation of DNA replication (Mukhopadhyay et al., 2014).

GenPlay Multi-Genome can be used to analyze data aligned
on custom genomes. Currently, most expression and epigenetic
analyses rely on alignment to a reference genome. This has two
major drawbacks. First, blocks of polymorphic sequences are
lost to the analysis because not all sequences that are present
in humans exist in the reference genome. Second, genetic differ-
ences between the reference genomes and the sample being ana-
lyzed are a major cause of alignment errors that lead to
inaccurate expression and epigenetic results. These problems
can be eliminated by aligning RNA-seq, ChIP-seq or Methyl-
seq experiments to the phased autologous genome from which
the reads are derived, rather than to a reference genome. When
a phased autologous genome is not available, an intermediate
solution is to align the reads to the most closely related reference
genome available. Recently, Dewey et a]. have generated three
race-speciﬁc reference sequences and have shown that alignment
to a closely related genome decreases error rates (Dewey et al.,
2011).

Alignments to autologous genomes can easily be performed
using current aligners (Li and Durbin, 2009; Liu et al., 2012), but
the results can be difﬁcult to exploit because the resulting align-
ments are represented in genomic coordinate systems that are
speciﬁc to each genome. This complicates interindiVidual com-
parisons and the exploitation of annotations and other reference

data in public databases that are generally in the genomic coord-
inate system of the reference genome.

GenPlay Multi-Genome partly resolves these problems be-
cause data that are represented in any custom genomic coordin-
ate system can be loaded concurrently with data represented in
the reference genome coordinate system as long as a VCF ﬁle is
available to create a meta-reference genome. In practice, users
load a VCF ﬁle containing the genetic data speciﬁc to the indi-
viduals being studied and are then able to load expression and
epigenetic data that have been aligned to these custom genomes.
GenPlay can switch between genomic coordinates systems on the
ﬂy or search for variants or features represented in any of the
coordinate systems summarized in the meta-genome. Users can
also export their data into any of the coordinate systems that
makeup the meta-reference genome, allowing for easy cross-
referencing with other studies. A demo project that illustrates
some of the capabilities of GenPlay Multi-Genome can be ac-
cessed at http://genplay.einstein.yu.edu/wiki/index.php/Projects
#GenPlay_MultiGenome.2C_a_tool_to_compare_and_analyze_
multiple_human_genomes_in_a_graphical_interface.

A currently useful application of GenPlay Multi-Genome is
the Visualization of all the sequence differences between the hg19
and hg38 assemblies. In an hg19/hg38 multi-genome session,
annotation, expression or epigenetic data tracks in either the
hg19 or the hg38 coordinate system can be loaded without any
conversion. A tutorial describing this application can be accessed
at http: // genplay.einstein.yu.edu/wiki/index.php/GRCh37/hg19_
GRCh38/hg38_Multi-Genome_Tutorial.

Generation of a VCF file comparing two or more genomes is
not a trivial endeavor, but it can be accomplished using several
approaches.

The VCF ﬁle describing the differences between the hg19 and
hg38 assemblies was generated using the chain ﬁles used by
the liftover software. Chain ﬁles describing the differences be-
tween assemblies are available for several species at the UCSC
browser. We provide an application and a tutorial to convert
chain ﬁles into VCF ﬁles. The tutorial, a link to the application
and several links describing how to create chain ﬁles can be
found here: http://genplay.einstein.yu.edu/wiki/index.php/How_
to_Create_a_VCF_File_From_a_Chain_File

As discussed above, VCF files describing phased human gen-
omes can be generated by quartet sequencing and other
approaches. Once such a VCF file is created, it can be used to
create a GenPlay Multi-Genome session that can be used to
analyze functional genomic data aligned on any of the genome
of the individuals described in the VCF file.

VCF ﬁles can also be generated from two FASTA ﬁles
(created for instance with a de novo aligner) using genome
aligners such as Last (Kielbasa et al., 2011) followed by
Samtools (Li et al., 2009) to convert the *.maf fields into VCF
files.

In conclusion, GenPlay Multi-Genome is an application that is
useful for projects that require analysis and Visualization of data
expressed in multiple genomic coordinate systems.

Funding: J.L., N.F. and E.E.B. were supported by grants
C024405 and C024172 from NYSTEM.

Conﬂict of interest: none declared.

 

110

112 /310's112u1n0fp10}x0"sotJBurJOJutotq/ﬁduq 11101} pQPBOIIIAAOG

91oz ‘Og isanV uo ::

GenPlay Multi-Genome

 

REFERENCES

Blanchette,M. et a]. (2004) Aligning multiple genomic sequences with the threaded
blockset aligner. Genome Res., 14, 7087715.

Blankenberg,D. et a]. (2010) Galaxy: a web—based genome analysis tool for experi—
mentalists. Curr. Protoc. Mol. Biol., Chapter 19, Unit 19 10 11—21.

Browning,B.L. and Browning,S.R. (2009) A uniﬁed approach to genotype imput—
ation and haplotype—phase inference for large data sets of tries and unrelated
individuals. Am. J. Hum. Genet., 84, 2107223.

Challis,D. et a]. (2012) An integrative variant analysis suite for whole exome next—
generation sequencing data. BMC Bioinformatics, l3, 8.

Danecek,P. et a]. (2011) The variant call format and VCFtools. Bioinformatics, 27,
215672158.

Dewey,F.E. et a]. (201 1) Phased whole—genome genetic risk in a family quartet using
a major allele reference sequence. PLoS Genet., 7, e1002280.

Faith,J.J. et a]. (2007) Lightweight genome viewer: portable software for browsing
genomics data in its chromosomal context. BMC Bioinformatics, 8, 344.

Fernandez—Suarez,X.M. and Schuster,M.K. (2010) Using the ensembl genome
server to browse genomic sequence data. Curr. Protoc. Bioinform., Chapter 1,
Unit] 15.

Kielbasa,S.M. et a]. (2011) Adaptive seeds tame genomic sequence comparison.
Genome Res, 21, 4874193.

Kitzrnan,J.O. et a]. (2011) Haplotype—resolved genome sequencing of a Gujarati
Indian individual. Nat. Biotechnol., 29, 59$3.

Lajugie,J. and Bouhassira,E.E. (2011) GenPlay, a multipurpose genome analyzer
and browser. Bioinformatics, 27, 188%1893.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with Burrows—
Wheeler transform. Bioinformatics, 25, 17544760.

Li,H. et a]. (2009) The Sequence Alignment/Map format and SAMtools.
Bioinformatics, 25, 207872079.

Liu,C.M. et a]. (2012) SOAP3: ultra—fast GPU—based parallel alignment tool for
short reads. Bioinformatics, 28, 8787879.

Lukashin,I. et a]. (2011) VISTA Region Vieweria computational system for
prioritizing genomic intervals for biomedical studies. Bioinformatics, 27,
259572597.

Mukhopadhyay,R. et a]. (2014) Allele—speciﬁc genome—wide proﬁling in primary
erythroblasts reveal replication program organization. PLoS Genet., 10,
e1004319.

Nicol,J.W. et a]. (2009) The Integrated Genome Browser: free software for
distribution and exploration of genome—scale datasets. Bioinformatics, 25,
273G273].

Peters,B.A. et a]. (2012) Accurate whole—genome sequencing and haplotyping from
10 to 20 human cells. Nature, 487, 19(Pl95.

Roach,J.C. et a]. (2010) Analysis of genetic inheritance in a family quartet by whole—
genome sequencing. Science, 328, 636—639.

Sandve,G.K. et a]. (2010) The Genomic HyperBrowser: inferential genomics at the
sequence level. Genome Biol., 11, R121.

Stein,L.D. et a]. (2002) The generic genome browser: a building block for a model
organism system database. Genome Res., 12, 159%1610.

Yang,H. et a]. (2011) Completely phased genome sequencing through chromosome
sorting. Proc. Natl Acad. Sci. USA, 108, 12717.

 

111

112 /310'S[BIIJHO[pJOJXO'SOIJ’BLUJOJIIIOICI”K1111] 11101} papeolumoq

91oz ‘Og isnﬁnV uo ::

