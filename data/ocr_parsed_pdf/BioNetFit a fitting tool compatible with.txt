Bioinformatics, 32(5), 2016, 798—800
doi:10.1093/bioinformatics/btv655

Advance Access Publication Date: 9 November 2015
Applications Note

 

Systems biology

BioNetFit: a fitting tool compatible with
BioNetGen, NFsim and distributed computing
environments

Brandon R. Thomas1, Lily A. Chylek2'1, Joshua Colvin1,
Suman Sirimulla3, Andrew H.A. Clayton4, William s. Hlavacek5'* and
Richard G. Posner1'*

1Department of Biological Sciences, Northern Arizona University, Flagstaff, AZ, USA, 2Department of Chemistry
and Chemical Biology, Cornell University, Ithaca, NY, USA, 3Department of Basic Sciences, Saint Louis College of
Pharmacy, Saint Louis, MO, USA, 4Center for Microphotonics, Faculty of Science, Engineering and Technology,
Cell Biophysics Laboratory, Swinburne University of Technology, Hawthorn, VIC, Australia and 5Theoretical
Division, Los Alamos National Laboratory, Los Alamos, NM, USA

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on June 24,2015; revised on October 20, 2015; accepted on November 3, 2015

Abstract

Summary: Rule—based models are analyzed with specialized simulators, such as those provided by the
BioNetGen and NFsim open—source software packages. Here, we present BioNetFit, a general—purpose
fitting tool that is compatible with BioNetGen and NFsim. BioNetFit is designed to take advantage of
distributed computing resources. This feature facilitates fitting (i.e. optimization of parameter values
for consistency with data) when simulations are computationally expensive.

Availability and implementation: BioNetFit can be used on stand—alone Mac, Windows/Cygwin,
and Linux platforms and on Linux—based clusters running SLURM, Torque/PBS, or SGE. The

 

BioNetFit source code (Perl) is freely available (http://bionetfit.nau.edu).
Supplementary information: Supplementary data are available at Bioinformatics online.

Contact: bionetgen.help@gmail.com

 

1 Introduction

Biomolecular interactions can be represented by formalized rules
(Chylek et (11., 2014a; Stefan et (11., 2014). Collections of rules form
rule-based models, which provide concise representations of biomolec-
ular interaction networks and can be analyzed to obtain insights into
how system-level behavior emerges from biomolecular interactions
(Chylek et (11., 2014a; Stefan et (11., 2014). Rule-based models must
be analyzed with specialized algorithms and software tools (Chylek
et (11., 2014a; Stefan et (11., 2014), such as BioNetGen (Harris
et (11., 2015), which interprets models encoded in the BioNetGen lan-
guage (BNGL) and provides deterministic, stochastic and hybrid for-
ward simulation capabilities (Harris et (11., 2015). To date, other
critical methods of analysis, such as fitting (parameter estimation),

have typically been applied ad [70c (e.g. by writing problem-specific
programs), as in the study of Kozer et al. (2013) or Chylek et al.
(2014b), which leads to duplication of effort and hinders the ability to
reproduce results.

Although many algorithms and software implementations are
available for analysis of models specified in traditional forms (Press
et (11., 2007), such as that of ordinary differential equations (ODEs),
standard techniques are not easily applied to rule-based models except
for those rule-based models that can be recast into a traditional
model form. Translating a set of rules into a reaction network (i.e. a
list of reactions) or the corresponding ODEs for the mass-action kin-
etics of the network, a capability provided by BioNetGen, is expensive
and sometimes impracticable. In such cases, direct simulation methods

(63 The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 798

/310‘srcumo[p10}xo‘soncuHOJIItotq/ﬁdnq

BioNetFit

799

 

must be used (Chylek et al., 2014a). These methods have been called
network—free methods, because they do not involve processing a set of
rules to obtain a list of reactions. Rather, rules are used as reaction—
event generators within a particle—based kinetic Monte Carlo (KMC)
simulation. Network—free simulators, such as NFsim (Sneddon et al.,
2011), which is compatible with BNGL—specified models, expand the
range of biomolecular interaction networks that can be studied, be—
cause the cost of network—free simulation scales with the number of
rules in a model, not the number of reactions implied by the rules
(Danos et al., 2007). Software that provides a general—purpose fitting
capability and that interfaces with a network—free simulator has not
hitherto been available.

Here, we present BioNetFit, a general—purpose fitting program for
rule—based models that is compatible with BioNetGen and NFsim.
Because of the potentially high cost of network—free simulation (Chylek
et al., 2014a), BioNetFit has been designed to be used on clusters.
It can also be used on stand—alone computers. BioNetFit implements
a genetic algorithm (Whitley, 1994; Smith and Eiben, 2008). Below,
we provide an overview of BioNetFit and a demonstration of its
capabilities.

2 Methods

Source code and a user manual, which includes installation instruc—
tions, are available at the BioNetFit Web site (http://bionetfit.—
nau.edu). Dependencies are described in the user manual and in
Supplementary Methods. Collections of files needed to run example
fitting jobs are included in the BioNetFit distribution in the ‘ex—
amples’ directory and six subdirectories named ‘example1’ through
‘example6.’ Step—by—step instructions for running these fitting jobs
are included in the user manual. The fitting procedure implemented
in BioNetFit is described in Supplementary Methods.

Running BioNetFit requires several problem—specific plain—text
files: a BNGL model—specification (.bngl) file (i.e. a BioNetGen/
NFsim input file); one or more data (.exp) files, each with two or
more white space—separated columns; and a BioNetFit configuration
(.conf) file (see the ‘examples’ directory in the BioNetFit distribu—
tion). If NFsim is being used, a .rnf file may also be required. To run
BioNetFit, a user must identify the parameters that are free to vary
in fitting in the .conf file and include a simulation command in the
.bngl file for each .exp file. Each simulation command should gener—
ate outputs corresponding to the data in the associated .exp file. See
the BioNetFit user guide and Supplementary Methods for additional
information.

Demonstration results were obtained by running BioNetFit on the
Monsoon cluster at Northern Arizona University (http://nau.edu/hpc/).
The .bngl, .exp and .conf files required to repeat the demonstration re—
sults presented in the Results section are provided as Supplementary
Files 51—56. These files are also provided in the ‘example1’ and ‘exam—
ple2’ subdirectories of the ‘examples’ directory within the BioNetFit
distribution.

3 Results

To provide a demonstration of capabilities, we used BioNetFit to—
gether with BioNetGen, NFsim and experimental data of Kozer
et al. (2013) to estimate parameter values for a published (Kozer
et al., 2013) and an extended version of a model for activation of
the epidermal growth factor (EGF) receptor (EGFR). Each version
of the model accounts for EGF—induced oligomerization of EGFR.
The published model is defined in Supplementary File S1, which is a

.bngl file that directs BioNetGen’s ODE solver to produce simula—
tion results. The file is derived from the .bngl file used by Kozer
et al. (2013). This version of the model limits EGFR oligomers
to a maximum size of four receptors per oligomer. This limitation
was introduced by Kozer et al. (2013) to avoid the need to use com—
putationally expensive network—free simulation in fitting, which was
performed using problem—specific code. The extended model is
defined in Supplementary File 52, which is a .bngl file that directs
NFsim to produce simulation results. The file is derived from
the .bngl file used by Kozer et al. (2014). This version of the
model imposes no constraints on the size of linear oligomers. It is
otherwise identical to the published model of Kozer et al. (2013).
The steady—state dose—response and time—series data used in each of
the two fitting runs are provided in Supplementary Files S3 and S4,
which are .exp files. Supplementary Files SS and S6 are the
BioNetFit configuration (.conf) files for the two fitting runs. These
files complement Supplementary Files Sl and 52, respectively.

In the fitting procedure, BioNetFit evaluated the consistency of
simulation results with all available data (i.e. BioNetFit found a glo—
bal fit). The chi—square metric was used to determine goodness of fit.
Parameter estimates are summarized in Supplementary Table Sl.
The number of free parameters was nine, which included five phys—
ical parameters (e.g. rate constants) and four scaling factors (param—
eters of a measurement model), which define linear relationships
between measured quantities and model—predicted quantities. The
quality of the fit for the original and extended models is illustrated
in Figure 1. For best—fit parameter values, the extended model pre—
dicts that EGFR oligomers larger than tetramers do not form appre—
ciably (Supplementary Fig. Sl). This finding justifies the omission of
these oligomers in the analysis of Kozer et al. (2013).

BioNetFit’s ability to take advantage of simulation runs per—
formed in parallel on a cluster enabled consideration of the extended
model, which had to be simulated by calling NFsim. The KMC (sto—
chastic simulation) method implemented in NFsim tends to be com—
putationally expensive, because in such methods, system state is
advanced one reaction event at a time (Chylek et al., 2014a). Use of
NFsim was required because the extended model places no con—
straint on the size of (linear) EGFR oligomers, which form via poly—
merization—like reactions. Network—free simulation is typically
required to cope with polymerization—reactions (Chylek et al.,
2014a). As expected, we found that simulations performed by
NFsim (for the extended model) were significantly more expensive
than simulations performed by BioNetGen’s ODE solver (for the
original model). The cost difference depends on various factors,
including hardware, model parameter values and algorithmic par—
ameter settings. For a representative CPU in the cluster we used and
the parameter settings of Supplementary Files S1 and S2, an NFsim
simulation is ~5—fold more expensive than an ODE—based simula—
tion. It should be noted that the cost difference depends sensitively
on the value of one particular algorithmic parameter called 7' in
Supplementary File 52, which scales system size. In general, the cost
of a discrete—event stochastic simulation, the type of simulation per—
formed by NFsim, depends on the number of reaction events per
unit time, which in turn depends on system size (measured by the
number of reactive molecules in the system). In Supplementary File
52, we set f: 0.01, which corresponds to a system size of 1% of a
cell. This setting reduces the cost of individual simulation runs (and
memory requirements) at the expense of introducing noise (i.e. fluc—
tuations arising from probabilistic reaction events). The noisiness of
simulation results complicates the comparison of predicted and
measured (population averaged) quantities. Because of this issue, in
fitting, multiple NFsim simulations were performed for each

/310‘srcumo[p10}xo‘sopcuHOJIItotq/ﬁdnq

[33

a
.

ulE

IE

II‘dl‘l‘iS 6/ rr/., 2015

 

 

a a (g no mo]
[E F](nM)

Supplementary Files Sl S3785
Kozer
et al. (2013) Supplementary Files 82784
S6

Kozer et al. (2013)

Supplementary Table Sl

Supplcrncntai‘) Tables 52 53

Supplcrncntai‘) Figures 52 53

bdoninc 6/ rr/.,
2010

(th)le 6/ rr/., 2014b

IIucka 6/ rr/., 2003

/310'S[BHJHO[pJOJXO'SOIJ'BLUJOJIIIOIq/ﬂduq

