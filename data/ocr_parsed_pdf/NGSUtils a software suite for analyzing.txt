BIOINFORMA TICS

0'so;112u110}u101q//2duq

SIBumoprOJX

£10"

NGSUtils

 

performed in SNP aware manner, potentially limiting the effects
of mapping bias in post—processing. The stats command can be a
useful tool to help explore a dataset to see how reads might be
affected by different ﬁltering criteria.

Finally, the counts command is used to calculate the read
counts for genes, BED regions, repeatmasker (Smit et al.,
199&2010) deflned repetitive elements or genome bins of a
user—deﬁned size. If given a GTF gene model, read counts for
each exon or alternatively spliced fragment can be individually
tallied, which may help the analysis of alternative splicing.
Counts may be normalized to RPKM values (Mortazavi et al.,
2008) using a number of methods.

2.2 fastqutils

The FASTQ format is a common output format from NGSs,
consisting of read sequences and the quality of individual base—
calls. These then serve as the input for mapping programs to
translate raw reads into mapped positions. For high—quality
mapping results, it is important to pre—process the input
FASTQ files. The fastqutils module contains a variety of
commands for converting to and from many different input for—
mats, as well as performing initial quality control pre—processing.
The fastqutils split command is useful for efﬁcient parallel pro—
cessing, and it splits a FASTQ ﬁle into sub—flles in a paired—end
aware manner. The fastqutils trim command will scan each read
and remove user—def1ned 5/—and 3’—linker sequences using a
SmithiWaterman (SW) (Smith and Waterman, 1981) alignment
algorithm. For quality—control purposes, the fastqutils ﬁlter
command can remove or truncate reads based on a number of
user—deflned criteria. Supported criteria include the number of
wildcard calls (Ns), read length, trimming bases from the 3/—end
of a read based on read quality, truncating a read when the
average basecall quality of a sliding window falls below a thresh—
old and removing adaptor sequences (non—SW aligned).
Additionally, for paired—end datasets, there is a filter for
removing reads that after previous flltering may be missing
their partner read. Each of the ﬁltering criteria is processed in
a chain; therefore, the results of one fllter feed directly into the
next, allowing for efﬁcient filtering with multiple criteria in one
step.

2.3 bedutils

BED files contain coordinates for regions of a genome. In the
context of NGS experiments, these can correspond to binding
sites, as found in ChIP—seq or CLIP—seq, or regions targeted for
enrichment, such as in exome enrichment. There are two primary
commands for BED files: reduce and refcount. The reduce
command merges overlapping BED regions into one long
contiguous region. The refcount command takes one ‘reference’
BED ﬁle and one or more ‘input’ BED ﬁles. For each region in
the reference BED file, the input files are scanned for overlapping
regions. These are then tallied, and a count for each input ﬁle is
produced. One example where this might be useful is a ChIP—seq
experiment, where the data are a BED ﬁle for each sample con—
taining 100 bp regions that were detected. Using the reduce com—
mand, all of the samples could be merged together into one
reference set of found regions. This could then be used as the
reference BED file. Next, using each of the original sample BED

ﬁles as inputs, refcount could be used to ﬁnd regions that were
enriched in one group of samples versus the other.

2.4 gtfutils

A common format for genome annotation is the GTF format
(http://mblab.wustl.edu/GTF22.html). GTF annotations can be
easily obtained for most organisms from many sources, including
the UCSC Genome Browser (Kent et al., 2002). In the bamutils
module, GTF ﬁles are used for read counting and mapping stat—
istics. The gtfutils module includes commands for reading and
enhancing GTF gene model annotations. The gtfutils junctions
command takes a GTF annotation ﬁle and a genome FASTA
ﬁle and output all possible splice—junctions for all genes.
Potential splices from all exons within a gene are outputted,
including those from multiple isoforms, if isoform annotations
have been added to the GTF flle. One use for this potential
splice—junction ﬁle is mapping junction—spanning RNA—seq reads.
To facilitate RNA—seq read mapping, each sequence in the
junction library is named in such a way that flles mapped to the
junction library can be readily converted back to genomic refer—
ence coordinates, including gaps in alignments, if necessary.
This conversion is handled by the bamutils convertregion
command.

3 CONCLUSIONS

Individually, each of these programs performs a small job in the
analysis of NGS experiments. However, collectively, this suite of
tools acts as building blocks that can be combined into larger
pipelines for data exploration and analysis. With modules that
operate from FASTQ pre—processing through BAM post—
processing and RPKM calculations, NGSUtils compliments
existing tools and provides unique functionality that helps each
step of an NGS data analysis pipeline.

ACKNOWLEDGEMENT

The authors thank Howard J. Edenberg for valuable discussions
about the application of these tools.

Funding: National Institutes of Health (AA017941, CA113001,
GM088076); Indiana Biobank, whose operations are subsidized
by the Indiana Clinical and Translational Sciences Institute,
which is supported by an NCRR Clinical and Translational
Sciences Award (in part) (U54—RR025761. Anantha Shekhar,
PI) and an NCRR construction grant (C06—RR020128—01. R.S.
Fife, PI, K. Cornetta, Co—I).

Conﬂict of Interest: none declared.

REFERENCES

Cock,P.J.A. et ul. (2010) The Sanger FASTQ file format for sequences with quality
scores, and the Solexa/Illumina FASTQ variants. Ntwleic Acids Res, 38,
176771771.

Danecek,P. et ul. (2011) The variant call format and VCFtools. Bioinformutics, 27,
215(r2158.

Kent,W.J. et ul. (2002) The human genome browser at UCSC. Genome Res, 12,
99(r1006.

 

495

ﬁm'spzumofpmﬂo'sopeuuopuorq/ﬁdnq

M.R.Breese and Y.Liu

 

Li,H. et ul. (2009) The sequence alignment/map format and SAMtools.
Bioinformutics, 25, 207872079.

Mortazavi,A. et ul. (2008) Mapping and quantifying mammalian transcriptomes by
RNA—Seq. Nut. Methods, 5, 621$28.

Quinlan,A.R. and Hall,I.M. (2010) BEDTools: a ﬂexible suite of utilities for com—
paring genomic features. Bioinformutics, 26, 8417842.

Richter,B.G. and Sexton,D.P. (2009) Managing and analyzing next—generation se—
quence data. PLoS Comput. Biol., 5, e1000369.

Smit,A. et ul. RepeutMusker Open—3 .0. 199(r2010 <http://www.repeatmasker.org>.

Smith,T.F. and Waterman,M.S. (1981) Identification of common molecular subse—
quences. J. Mol. Biol., 147, 1957197.

 

496

/3.IO'S[BIImO[p.IOJXO'SOIJBLUJOJIIIOIq/ﬂduq

