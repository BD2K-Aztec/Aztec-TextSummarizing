ORIGINAL PAPER

Vol. 28 no. 18 2012, pages 2374—2381
doi: 10. 1093/bioinformatics/bt3364

 

Bioimage informatics

Advance Access publication June 27, 2012

A bioimage informatics approach to automatically extract

complex fungal networks

Boguslaw Obaral’z’k, Vicente Grau3’l and Mark D. Fricker4
leford e—Research Centre, ZOxford Centre for Integrative Systems Biology, 8Institute of Biomedical Engineering and

4Department of Plant Sciences, University of Oxford, UK
Associate Editor: Olga Troyanskaya

 

ABSTRACT

Motivation: Fungi form extensive interconnected mycelial networks
that scavenge efficiently for scarce resources in a heterogeneous en-
vironment. The architecture of the network is highly responsive to local
nutritional cues, damage or predation, and continuously adapts
through growth, branching, fusion or regression. These networks
also provide an example of an experimental planar network system
that can be subjected to both theoretical analysis and experimental
manipulation in multiple replicates. For high-throughput measure-
ments, with hundreds of thousands of branches on each image,
manual detection is not a realistic option, especially if extended time
series are captured. Furthermore, branches typically show consider-
able variation in contrast as the individual cords span several orders of
magnitude and the compressed soil substrate is not homogeneous in
texture making automated segmentation challenging.

Results: We have developed and evaluated a high-throughput
automated image analysis and processing approach using Phase
Congruency Tensors and watershed segmentation to characterize
complex fungal networks. The performance of the proposed approach
is evaluated using complex images of saprotrophic fungal networks
with 105—106 edges. The results obtained demonstrate that this ap-
proach provides a fast and robust solution for detection and
graph-based representation of complex curvilinear networks.
Availability and implementation: The Matlab toolbox is freely avail-
able through the Oxford e-Research Centre website: http://www.oerc
.ox.ac.uk/research/bioimage/software

Contacts: boguslaw.obara@oerc.ox.ac.uk

Received on February 16, 2012; revised on May 29, 2012; accepted
on June 21, 2012

1 INTRODUCTION

Rapid advances in imaging technologies have heralded a new era
of quantitative measurements that offer considerable potential to
improve our understanding of complex biological systems, par-
ticularly those that need to be considered as integrated functional
units (Swedlow et al., 2003; Carpenter, 2007; Kvilekval et al.,
2010). In particular, enhanced image processing techniques
have greatly facilitated characterization of interconnected trans-
port and communication networks in animal systems, including
vascular systems, milk ducts, respiratory pathways and neuronal
circuitry [e.g. (Chaudhuri et al., 1989; Frangi et al., 1998;
Meijering et al., 2004; Rodriguez et al., 2008)]. In contrast,

 

*To whom correspondence should be addressed.

there has been remarkably little progress to characterize
macroscopic microbial network development for an entire taxo-
nomic group of organisms, namely the fungi. Unlike other
biological networks, which exist within an organism, the entire
growth form of fungi is as an adaptive network. Foraging sapro-
trophic fungi play a central role in ecosystem biology as they are
the only organisms capable of complete degradation of wood in
temperate forests. These fungi form extensive interconnected
mycelial networks of multi-hyphal cords that forage for
scarce resources that are patchily distributed in time and space
(Fricker et al., 2007). The architecture of the network responds
to local nutritional cues, damage or predation and the local
structure is continuously remodeled through growth, branching,
fusion or regression of the hyphal cords. Despite the absence of
any centralized control system, these organisms exhibit complex
foraging and decision making behavior as a co-ordinated indi-
vidual. Unlike animal network models, microbial networks also
provide an example of an extremely tractable experimental
system that can be subjected to both theoretical analysis and
experimental manipulation in multiple replicates (Boddy et al.,
2009).

Early measures of macroscopic mycelial organisation focussed
on fractal dimension as a useful tool to capture aspects of the
network structure as a metric (Boddy and Donnelly, 2008).
However, a single summary statistic, such as the overall fractal
dimension provides little opportunity to characterize the network
structure and dynamics further or to explore the underlying
mechanism leading to network optimisation. There has been
some progress at the microscopic level to extract the physical
network structure using (semi)-automated image analysis
(Barry and Williams, 2011). However, to date, delineation of
the network architecture from the larger soil-based systems has
only been possibly manually (Fricker et al., 2007), as basic
intensity-based segmentation is not effective in this context
(M.D.Fricker, L.Boddy and D.P.Bebber, unpublished data).
As a result, the total number of macroscopic fungal networks
analysed so far is relatively low. Nevertheless, graph-theoretic
analysis of the digitised networks has provided evidence that
these indeterminate, de-centralized systems yield adaptive net-
works with both high-transport capacity and robustness to
damage, but at a relatively low cost, through a ‘Darwinian’ pro-
cess of selective reinforcement of key transport pathways and
recycling of redundant routes (Bebber et al., 2007). Furthermore,
fungal networks dynamically modify link strengths and local
connectivity when subject to experimental attack to readjust
the balance between transport capacity, robustness to damage

 

2374 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions.com.

112 /310's113umo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

Bioimage informatics approach to extract fungal networks

 

and resource allocation, resulting in increased resilience as the
environment becomes more challenging (Boddy et al., 2010).

Existing image processing approaches for semi-automated
fungal network extraction work best if the mycelium is grown
on a suitable substrate, such as cellophane (Ritz et al., 1996) or
nitrocellulose (Barry and Williams, 2011) to facilitate acquisition
of high-contrast images. The subsequent processing procedure
typically involves noise reduction, using median or band-pass
ﬁlters, intensity-based thresholding, with manual or automated
threshold selection, followed by morphological processing to
achieve an improved skeletonisation of the colony structure
e.g. Barry and Williams (2011).

However, these methods require rather speciﬁc culture condi-
tions and illumination regimes that cannot readily be adapted for
macroscopic networks grown on soil-based media, which is
essential to explore the natural behavioural capability of these
organisms and the range of their responses. In addition, the
branches (termed cords in these systems) are multi-hyphal aggre-
gates and show considerable variation in contrast as the individ-
ual cords span several orders of magnitude in diameter from ,um
to mm, within a single colony. Furthermore, the background
from the compressed soil substrate is not homogeneous in texture
or reﬂectivity. Under these conditions, automatic characteriza-
tion of the fungal network is challenging for conventional image
processing approaches and more advanced solutions are
required.

We have developed a high-throughput automated image ana-
lysis approach to detect and characterize large complex fungal
networks, grown under realistic conditions. We use watershed
segmentation to extract the network rapidly, with prior curvilin-
ear feature enhancement to highlight the network structure in
noisy or low contrast images. The proposed enhancement
method uses a novel brightness- and contrast-invariant approach
based on the concept of local phase, called the Phase Congruency
Tensor (PCT). The resulting skeleton is then pruned on the basis
of local cost functions that incorporate both intensity and tensor
direction information. A graph representation of the network is
constructed from the pruned skeleton to give the network top-
ology or a weighted network that includes edge lengths. To
obtain an estimate of the edge thickness, which is important in
predicting the physiological performance of the system, the skel-
eton is dilated to capture the approximate dimension at each
point, and this value is used to set a local sampling region to
estimate the reﬂected cord intensity for comparison with empir-
ically derived calibration curves. This approach ensures that even
sub-resolution branches can be analysed correctly. An addition
procedure is applied to extract the resource region which is then
used to redeﬁne a corresponding part of the graph. Although we
apply the method here to fungal networks, it has wide applic-
ability to planar networks in any domain.

2 EXTRACTION OF NETWORK-LIKE
STRUCTURES

Recent reviews of image processing methods for network-like
structure extraction can be found in Dehkordi et al. (2011).
According to this review, most image analysis approaches to
extract network-like structures are classiﬁed into pattern

recognition, model-based, tracking, artiﬁcial intelligence and
neural networks. To set the current work in context, we outline
the basic method and the limitations of each approach below.

2.1 Pattern recognition

Many of these methods apply thresholding and object connect-
ivity, followed by a thinning procedure and extraction based on
graph description (Kawata et al., 1995). Alternatively, the image
intensity is represented as a hypersurface and the curvilinear fea-
tures are extracted using curvature, with the crest points of the
hyper-surface correspond to the center lines of the structure
(Prinet et al., 1996). These centerlines can then be used as
seeds in a region growing procedure that segments the full curvi-
linear structure from the images (Higgins et al., 1989).

Direct segmentation of curvilinear structures can also be done
by multi-resolution segmentation approaches. After segmenting
salient structures at low resolution, less prominent network
branches can be extracted in the neighborhood of the previously
segmented regions at higher resolution (Chwialkowski et al.,
1996). Curvilinear structures can also be segmented by mathem-
atical morphology operators using specific structuring elements
(Zana and Klein, 1997).

2.2 Model based

Model-based approaches apply explicit curvilinear structure
models, or templates, to extract the network. In network extrac-
tion applications, the template is usually represented in the form
of a series of nodes connected in segments and deformed to fit
the image (Summers and Bhalerao, 1995). In curvilinear or tubu-
lar object segmentation, objects are commonly described as a set
of overlapping template ellipses (2D) or ellipsoids (3D) (Krissian
et al., 2000).

More general deformable model-based techniques find object
contours using parametric curves that deform under the inﬂu-
ence of internal and external forces (Klein et al., 1994).

2.3 Tracking

Tracking-based approaches apply local operators on a speciﬁc
point known to be in an object of interest and track it. Tracking
approaches, starting from an initial point, detect network cen-
terlines or boundaries by analyzing the pixels parallel and or-
thogonal to the tracking direction (Haris et al., 1997; Meijering
et al., 2004).

2.4 Artiﬁcial intelligence and neural network-based

Artiﬁcial Intelligence-based approaches use knowledge to guide
the segmentation process and to delineate network structures,
e.g. using a general curvilinear model (Smets et al., 1988). A
disadvantage of learning methods is that they depend on the
quality of the training dataset, which requires signiﬁcant work
and can be susceptible to problems like over-training (Nekovei
and Sun, 1995).

3 ENHANCEMENT OF CURVE-LIKE STRUCTURES

When the network structure is affected by variations of intensity
contrast within the image, image enhancement operators can

 

2375

112 /310's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

B. Obara et al.

 

highlight curvilinear features and reduce background effects.
Although other alternatives are available, here we concentrate
on methods based on tensors.

3.1 Intensity-based tensors

A tensor representation of an image can give information about
how much the image varies along and orthogonal to the domin-
ant orientations within a certain neighborhood (\Nestin et al.,
2001). In particular, the Hessian matrix (a second—order
tensor) has been proposed to describe local shape orientation
for elongated structures (Sato et al., 1998). Since curvilinear
structures observed in the image can appear in different sizes,
scale space representations have been extensively used. This is
commonly achieved through the use of a family of Gaussian
ﬁlters, or their derivatives, with multiple scales achieved by vary-
ing the value of the variance.

One of the most popular Hessian-based approaches to en-
hance curvi-linear structures is known as vesselness (Frangi
et al., 1998). For a given image I(p) and scale a, vesselness is
deﬁned as

A2

_ 0:1 AZ +12
2132)? _ (7,1 (7,2
V0r = e 0’2 l — e 2oz (l)

where p = [x, y]T is the spatial location, 20,1, 20,2 are the eigen-
values of Ha(p) (the Hessian matrix at scale a) satisfying
Mail 3 |)\.0J‘+1|, ,6 and c are thresholds that control the sensitivity
of the line measurement. Multi-scale vesselness, for a given set of
scales 2 = {a}, can be computed as the maximum of the vessel-
ness values calculated at different scales, and the eigenvectors at
the same scale can be used to deﬁne local orientation (Obara
et al., 2012).

 

An alternative measurement of piecewise linear segments that
is also based on the Hessian matrix, called neuriteness, has been
proposed in (Meijering et al., 2004).

4 MATERIALS AND METHODS
4.1 Input images

The proposed approach has been tested and validated on images of
fungal networks of Phanerochaete velutina or Phallus impudicus that
were grown for 39—50 days in the dark on compressed soil or sand micro-
cosms and photographed at intervals, as described previously, see ﬁgure
1a (Bebber et al., 2007; Boddy et al., 2010).

4.2 Phase congruency-based tensors

Herein, we introduce a novel phase concept for curvilinear feature en-
hancement called the PCT. In general, local tensor-based representations
can be produced by combining the outputs from polar separable quad-
rature ﬁlters, applied on several orientations (Knutsson, 1989). Although
tensor representations can be built on purely intensity-based ﬁlters (like
the Hessian), these have the downside of being sensitive to changes in
image contrast. Methods based on local phase have been proposed as a
contrast-independent alternative for feature detection. In particular,
phase congruency (Kovesi, 2000) is based on the concept that salient
features have similar values of local phase when observed at different
scales. We exploit the idea that phase congruency values are high in the
direction perpendicular to the structure, while they remain close to zero in

the direction parallel to the structure. More importantly, the values of
phase congruency are minimally affected by contrast changes. Thus, for a
given set of scales {5}, a set of orientations {0} and a given set of phase
congruency measures PC0(p) (for each orientation 0) (Kovesi, 2000), the
PCT takes the following form (Obara et al., 2012):

TPC = Z Pco<pxnon3 — an) (2)

where no is the normalized orientation vector in the direction 0,
or = 1/m — 1, with m being the dimensionality of the image and ﬂ is the
identity tensor. The local structure can then be described by eigenvectors
and eigenvalues of T PC.

4.2.] PCT vesselness and PCT neuriteness As described in
Section 3.2, piecewise curvilinear segments can be detected by analyzing
the relations between eigenvalues and eigenvectors of the locally calcu-
lated Hessian. In a similar way, the dominant orientation of the surface
representing a curvilinear structure is given by the dominant eigenvector
of T PC, i.e. the eigenvector corresponding to the eigenvalue of largest
magnitude. PCT-based vesselness and PCT-based neuriteness are calcu-
lated using the original vesselness and neuriteness equations, with the
eigenvalues of T PC substituting those of the Hessian.

4.3 General approach for network extraction

4.3.] Curvilinear feature enhancement Let us consider an image
of a curvilinear network structure I(p) of a size M X N pixels, where
p = [x, y]T represents pixel location. When the curvilinear network is
not affected by variations of intensity contrast within the image, then
the input image I(p) is directly used in the following procedures (see
ﬁg. 1a). Otherwise, one of the curvilinear feature enhancement methods,
discussed in (Section 4.2), is applied. An enhanced image IF(p) as well as
the corresponding vector ﬁeld IVF(p) are calculated. The size of image
IVF(p) is M X N X 2.

4.3 .2 Watershed The watershed transformation was introduced as
a tool for segmenting gray-scale images by (Beucher and Lantuejoul,
1979), and is now used as in many segmentation procedures using efﬁ-
cient algorithms (Meyer, 1994).

Lets us consider a gray-scale image I(p) (or IF(p)) as a topographic
surface: the gray level of a pixel becomes the elevation of a point, the
basins and valleys of the relief correspond to the dark areas, whereas the
peaks and crest lines correspond to the bright areas. The watershed line
may be intuitively introduced as the set of points where a drop of water
may ﬂow down towards several catchment basins of the relief.

The watershed algorithm can be used for segmentation by using the
calculated catchment basins as segmented regions. In our case, however,
we are interested in watershed lines themselves, which delineate ridges in
the image and thus correspond to network branches.

4.3.3 Branches and branching points extraction The skeleton
deﬁned by watershed lines is subsequently categorised into branches
[3 (p), branching points IBp(p) and end points IBE(p) using the topological
method proposed by Kong and Rosenfeld (1996). IB(p), IBp(p) and IBE(p)
are images containing unique labels for the pixels that make up a speciﬁc
object. The performance of this procedure is demonstrated in ﬁgure 1b.
The majority of the skeleton corresponds visually to the clearest struc-
tures of the network. However, the watershed transformation typically
produces an over-segmentation of the input image I(p) [or IF(p)] as ex-
tremely subtle variations in image intensity can still yield basins with
corresponding watershed boundaries. These extraneous segments can
be evaluated using local cost-functions and pruned if they fail to meet
the appropriate criteria.

 

2376

112 /310's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

Bioimage informatics approach to extract fungal networks

 

4.3.4 Pruning

 

Algorithm 1 Pruning procedure.

 

Input: IF(P), IVF(P), 13(1)), 1313(1)), IBE(P), 1’: 1
Output: 13(1)), 1313(1)), IBE(p)
NB <— maX(IB(P))
for i = 1 —> NB do
b «ﬁnd((IB(p) == 0)
C <— CUF, IVF, 1’, 1’)
if c<t then
IBE(be) <— 0
end if
end for
ISK(P) <— (1B(P) > 0) U (1313(1)) > 0) U (IBE(p) > 0)
[B (p) <— Branches(ISK(p))
IBp(p) <— BranchPoints(ISK(p))
IBE(p) <— BranchEna’s(ISK(p))

 

The pruning procedure used here is based on a cost function that includes
weighted contributions of both intensity information and the alignment
of the local vector ﬁeld, calculated for every branch of the skeleton. The
cost of the branch deﬁned by pixels b is computed using the following
formula:

C(IFa IVFa ba  : l/CI(IF3  +  _ V)CV(IVF3 b)a 

where C; is a normalized input or enhanced image intensity-based cost
deﬁned by

K
2 IF(bi)

C1(IVF,b) = 1 K (4)

 

and CV is a vector ﬁeld-based cost that is calculated as follows:

21(71 — II¢(blabl+1)II+ ¢1—|I¢(bi+1,b.-)II)
CV(IVF, b) = 1

 

 

K_1 (5)

¢(bia bi+l) : IIVF(bi) ' d(bia bi+l)I 

d(bia 17141) = (17141 — bi)/||bi+l — bill (7)

and K is a number of pixels in b. y e [0, 1] determines the relative weight
of the C1 and CV cost components. ll-ll is the Euclidean norm. The pur-
pose of the vector ﬁeld cost CVF is to determine branches aligned with the
direction of a vector ﬁeld given by IVF(p).

Finally, all branches with a cost value smaller than threshold t and
their corresponding branching and end points are removed (see ﬁg. 1c).
The procedure is given in Algorithm 1. NB denotes number of labeled
branches in image IB(p). Functions ‘BranchPoints’, ‘BranchEnds’ and
‘Branches’ return images containing labeled pixels representing every
branching points, ends and branches. Function ‘ﬁnd’ returns non-zero
pixel positions of an image.

4.3.5 Graph extraction In order to apply network analysis tools,
the morphological structure has to be translated into an appropriate

(8)

 

 

 

 

 

Input Image 

V

 

 

 

Enhancement —

 

 

 

 

(b) v

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Watershed
=
.2
E
E (C) v
E) — Pruning =
s
2
(B (d) l
Graph =

 

 

 

 

 

 

 

 

— Thickness

A
k)

 

 

 

 

 

 

 

(T)

 

 

Food

A
KJ

 

 

 

(9) v

—> FN Graph A ‘

 

 

 

 

 

 

Fungal Network Extraction

 

 

 

 

 

 

 

Fig. 1. Workﬂow: (a) Input image as deﬁned by the region of interest
outlined in red in Figure 2; (b) watershed-based segmentation: fungal
network skeleton (in red), branching points (in green) and endpoints
(in blue); (c) pruning (as pointed out by violet arrows); (d) graph built
form the extracted structure of the network; (e) pseudo-color coded rep-
resentation of cord thickness; (1) fungal food source detection (region of
interest outlined in green in Figure 2: the boundary is outlined in magenta
and (g) graph at the region of the source of food

network representation. We assume that the fungal network can be rep-
resented as a graph by classifying junctions (branch-points and anasto-
moses) as nodes and the hyphae or cords between nodes as links (Bebber
et al., 2007; Fricker et al., 2007). The graph representation of the network

 

2377

112 /810's112umo proJIxo'sot112u1101utotq//:d11q U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

B. Obara et al.

 

structure is constructed by matching every branch with its two corres-
ponding branching points or with its branching point and endpoint, see
ﬁgure 1d.

The input branches, branching and end points images, IB(p), IBp(p)
and IBE(p), respectively, are used to construct the graph G. For every
branch b in IB(p), a set of corresponding branching points {bp} is
extracted. When the branch has two branching points then the graph’s
edge G(i) is deﬁned by {bp(1), bp(2)}, otherwise, G(i) is represented by
branching point bp(1) and the end point be. The procedure is given in
Algorithm 2.

 

Algorithm 2 Graph extraction procedure.

 

Input: 13(1)), 1313(1)), IBE(p)
Output: G
NB <— max(IB(p))
for i = 1 —> NB do
b <—find((IB(p) == 1))
bp <—find((IBP(p) > 0) 0 (113(1)) == 1))
if a’irn(bp) = 2 then
6‘0) <— {bp(1), bp(2)}
else if dim(bp) = 1 then
be eﬁnd((IBE(p) > 0) 0 (13(1)) == 1))
GO) <— {bp(1), be}
end if
end for

 

4.3.6 Thickness A very important measure used to characterize
biological networks, is the cord thickness, as this has a signiﬁcant
impact on the physiological function of the network. The thickness
value for each branch is determined by iterative ﬁltering of the center
line image using morphological dilation 6 and reconstruction ,0 proced-
ures (Serra, 1982).

The input branches and branching points and ends images,
IB(p), IBp(p) and IBE(p), respectively, are used to construct the skeleton
images ISK(p). A copy of ISK(p), called Iw(p), is then dilated using a disk
structuring element S with 1 pixel radius. The difference between IW(p)
and the result of dilation is stored in the image [S(p) that contains the
surrounding boundaries of the skeleton. Then, for a given threshold value
k, thresholding of the image IF (p) masked by the image 15 (p) is performed
and the image IV(p) is obtained. In order to reconstruct all pixels in the
image IV(p) which are connected to the skeleton in the image Iw(p), the
morphological reconstruction of the image marker Iw(p) under the image
mask IM(p), a union of ISK(p) and IV(p), is performed producing IR(p).
The points in IR(p) are added onto Iw(p), and the procedure is repeated.
The procedure is repeated until no pixels remain to be reconstructed with
intensity IF(p) above k. The distance map IRD(p) is calculated as the
shortest distance from each of the skeleton points ISK(p) to the back-
ground in the reconstructed image IW(p). Finally, the thickness map
image ITK(p) is given by the distance map image IRD(p) weighted by
the mean intensity of IF(p) points deﬁned by the neighborhood of each
pixel of the skeleton image ISK(p).

The output of the procedure is presented in ﬁgure 1e and its workﬂow
is shown in Algorithm 3. In this Algorithm, function 65 (I(p)) denotes the
morphological dilation of an image I(p) by a structuring element S.
ps(I(p), J(p)) is a function that represents the morphological reconstruc-
tion of mask image I(p) from marker image J(p), J(p) g I(p). Function
dist computes the Euclidean distance transform of a binary image. >1<
denotes the convolution operation and S(r) is a disk structuring element
with r pixel radius.

 

Algorithm 3 Thickness procedure.

 

Input: IF(p), 113(1)), 1312(1)), k
Output: ITK(p)
ISK(P) <— (1B(P) > 0) U (1313(1)) > 0) U (IBE(p) > 0)
IW(P) <— [SK
n <— 1
While n > 0 do
ID(P) <— 5s(1W(P))
mmebm—mm
Iv(p) <— (IF(p) - Is(p)) > k
IM(p) <— Is1<(p) U Iv(p)
IR(P) <— IOS(ISK(p)a IM(P))
n <— dim(ﬁnd((IR(P) — Is1<(p))))
Iw(p) <— Iw(p) U IR(p)
end While
IRD(P) <— 2 * diSl(1W(P)) ' ISK(p)
r <— max(IRD)
Ic(p) <— (IF(p) * S(r))/Sum(S(r))
ITK(P) <— IRD(p) ' [C(P)

 

4.4 Application to extraction of fungal networks

In all the fungal network extraction experiments, the following param-
eters have been used: number of scales and orientations=6, weight
7/ = 0.5, branch cost threshold t=0.2 and thickness threshold k=0.4.
In all cases, the PCT-based vesselness approach (Equation 1) is used.
An analysis of the sensitivity to different parameters for the PCT calcu-
lation can be founded in (Obara et al., 2012).

In the particular case of the fungal networks, the graph representation
of the network has to be redeﬁned in the region corresponding to the
fungal source of food, as the structure of the network within the food
source is not visible, but can be approximated as a single node connected
to all cords arising from the boundary.

4.4.] Fungal food source detection In order to extract the fungal
food source, the image I(p) is segmented by a global threshold (Otsu,
1979). The segmented image is then ﬁltered using morphological opening
and closing using a disk structuring element S, to produce the binary
image IF00d(p). ﬁgure 1f shows the output of this procedure.

4.4.2 Graph for the fungal network The graph G representing the
fungal network is ﬁnally modiﬁed to account for the presence of food
resources. The graph is redeﬁned for the vertices that intersect with the
segmented resource IFOOd(p). such that they all connect to a single node in
the center of the source of food as the underlying network is not visible
within the wood block (ﬁg. 1 g).

5 RESULTS

Species such as P. impua’icus produce densely cross-linked net-
works, with relatively well-deﬁned thick cords. To summarise the
complete extraction process, images of this species collected at
high-resolution and high-contrast (ﬁg. la) were rapidly seg-
mented using the watershed method (ﬁg. lb), with no additional
requirement for curvi-linear feature enhancement. Oversegmen—
tation, generally considered as a downside of the watershed
transform, allows in this case a rapid delineation of high—density
networks. Pruning based on the average intensity of every branch
was then carried out, providing a mechanism to control the over-
all level of detail of the ﬁnal network (ﬁgure 1c). The graph

 

2378

112 /310's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

Bioimage informatics approach to extract fungal networks

 

representation of the network was then calculated by deﬁning the
branch or fusion points and end points throughout the network
as nodes, and then determining the edges that link them (ﬁg. 1d).
The Euclidean length of each edge was also calculated from the
segmented skeleton, and the cord thickness estimated from a
sequence of morphological dilations of the skeleton until the
threshold criterion was reached, combined with ﬁltered pixel
intensities to capture the difference in reﬂectivity for cords of
different dimensions (ﬁg. 1e). The ﬁnal step for the fungal net-
works was to identify the initial food resource (ﬁg. If) and then
redeﬁne the graph in this region to connect all cords emanating
from the resource with a central node (ﬁg. lg). The performance
of the proposed approach applied to the entire image is presented
in ﬁgure 2.

When no enhancement was applied, the watershed and prun-
ing method was less reliable for low-contrast, low-resolution
images, such as those obtained for Phanerochaete velutina,
which has thinner, more diffuse cords, particularly at the grow-
ing margin. With varying levels of threshold, the network was
initially over-segmented, but rapidly became dis-connected as the
threshold was raised, making the choice of threshold critical (ﬁg.
3a—e). In comparison, even these challenging networks were ef-
ﬁciently extracted following intensity-independent PCT enhance-
ment (see Section 4 for details) to give a very clean network over
a broad threshold range (ﬁg. 3f—j), that greatly facilitated subse-
quent pruning operations (ﬁg. 4).

To quantify the performance of our approach, ﬁve complex
regions of interest in the fungal images were selected. Manual
tracing of network centerlines was performed exhaustively by an
expert, to give a Gold Standard (GS) reference. In total, in all
regions of interest, 2256 network branches were annotated. The
GS and extracted network were compared using the network—
network distance measure 8d (Gelasca et al., 2009), deﬁned as the
average distance between each point on the GS network center-
line and the corresponding closest point on the extracted network
centerline, and vice versa. The standard deviation 08d of the
network-network distance measures was also calculated. The dis-
tance error evaluation for each ROI, where the network was
extracted using the proposed approach based on PCT vesselness,
is presented in Table 1. For all annotated regions, the average
distance error was 8d 2 0.7393[pixel]. The recommended setting
used to calculate the PCT-based vesselness, can be found in
(Obara et al., 2012). Supplementary ﬁgure S4 presents normal-
ized histograms of distance error values sat for all analyzed re-
gions of interest in fungal images. Additionally, traced lines were
identiﬁed as true/false Positives depending on whether a line was
found in the gold standard at a distance smaller than two pixels.
Precision and recall were calculated for a set of comparable
approaches, and are shown in Table 2. Finally, a comparison
of the network thickness estimated using optical microscope
and our approach, for 10 randomly selected measurement
points, is presented in Supplementary ﬁgures S5 and S6.

5.1 Runtime performance

The average runtime spent to extract the fungal networks from
the grayscale images of 1000 X 1000 pixels and ~60 K branches
(links) is 70s (without enhancement) and 200s (with PCT en-
hancement). This compares with manual segmentation of 3K

branches in about 2—3 days (Fricker et al., 2007). The runtime
performance of the implemented methods was tested on a PC
with Intel Core 2 Duo (T8300) system with 2GB memory, run-
ning Linux and MATLAB R2009b.

6 DISCUSSION

In this article, an image analysis and processing concept for gen-
eral curvilinear network detection has been introduced. The core
method is based on extraction of the network centerline from a
watershed segmentation, followed by a pruning procedure. This
approach can be directly applied to high-contrast images, but the
combination with a curvilinear feature enhancement based on
Phase Congruency Tensors provides a contrast invariant solution
for more challenging networks.

Using the watershed transform to calculate center lines pro-
vides several advantages over other more complex network-
analysis routines. First, it guarantees calculation of connected
networks. Second, it requires low computation times in compari-
son with other segmentation methods. By using a standard
morphological watershed transformation on raw or PCT-
enhanced images, we obtain an oversegmented skeleton image
which encompasses the entire biological network, but also a con-
tribution of false edges associated with subtle variations in back-
ground intensity that still yield basins in the watershed image.
These extraneous features can be removed post-segmentation by
judicious selection of cost-function weights or reduced by prior
network enhancement and noise-reduction using PCT or other
image enhancement techniques described in Section 4.

Visual inspection of the results (ﬁg. 2 and Supplementary Figs.
Sl—3) conﬁrm the robustness of the proposed approach to ex-
tract networks from complex and challenging biological speci-
mens. In particular, the PCT-based enhancement is effective at
dealing with highly variable intensity levels of the curvilinear
features and is capable of providing high detection responses
on low contrast edges against a noisy background (ﬁg. 3).
These properties are essential to detect structures in low contrast
regions of noisy images that are common in a large number of
biomedical images (Meijering et al., 2004).

The results demonstrate that the proposed approach provides
a fast and robust solution to detect and extract a graph repre-
sentation of complex curvilinear networks and overcomes a crit-
ical bottleneck in biological network analysis. This now permits
high-throughput measurements with improved resolution and
precision. The approach is generic and can be applied to a
wide range of biomedical images.

One of the major contributors to errors is optimal threshold
selection for the pruning procedure. Therefore, future work will
be focused on data-driven optimizing approaches to determine
optimal local or global threshold selections.

Once the network has been extracted, a wide range of network
parameters can be calculated (Fricker et al., 2007). As the data
are embedded in Euclidean space, a number of basic morpho-
logical measures can also be readily derived. These values either
have a straightforward biological meaning in their own right or
they provide a comparison with network structures in other do-
mains. In particular, the rich network structures extracted by this
approach provide a rapid means to examine network features,

 

2379

112 /310's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

B. Obara et al.

 

ﬁr

w

 

Fig. 2. Result of the proposed approach, using image intensity when applied to a high contrast image of a fungal network of P. impudicus. (a) Extracted
network and the source of food overlaid on the input image: center line (in red), branching points (in green), endpoints (in blue), and food source
boundary (in magenta). (b) Pseudo-color coded plot of natural log of the cord thickness. The red and green squares delimit the region of interest which
we have used to illustrate the performance of the method set out in Figure 1. The red and green squares delimit the region of interest which we have used
to illustrate the performance of the method set out in Figure 1. Scale bar corresponds to 2 cm

(0)

 

Fig. 3. Analysis of low contrast images of a fungal network of P. velutina for a range of threshold values I: [0.1 — 0.9]: (a—e) skeleton pruning
calculated using image intensity alone, (f—j) skeleton pruning calculated using PCT-based vesselness enhancement. Center line (in red), branching points
(in green), and endpoints (in blue)

 

Fig. 4. Result of the proposed approach, using PCT vesselness when applied to a low contrast image of a fungal network of of P. velutina. (a) Extracted
network and the source of food overlaid on the input image: center line (in red), branching points (in green), endpoints (in blue) and food source
boundary (in magenta). 0)) Pseudo-color coded plot of natural log of the cord thickness. Scale bar corresponds to 2 cm.

 

2380

112 /810's112umo proJIxo'sot112u1101utotq//:d11q U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

Bioimage informatics approach to extract fungal networks

 

Table 1. Distance error evaluation of the proposed method applied to
ﬁve regions of interest in fungal images

 

 

ROI No. No. of branches 8d [pixel] 08d [pixel]
1 396 0.8206 1.1174
2 423 0.7081 1.1803
3 493 0.7626 1.2233
4 129 0.9196 1.5307
5 815 0.6734 1.0411

 

Table 2. Precision and recall evaluation of the proposed method, based
on intensity, vesselness, neuriteness, PCT vesselness, and PCT neurite-
ness, applied to ﬁve regions of interest in fungal images

 

Intensity Vesselness Neuriteness PCT PCT
vesselness neuriteness

 

Precision 0.91 0.95 0.94 0.98 0.98
Recall 0.56 0.70 0.63 0.95 0.94

 

The assessment of the rate of false positive and false negative segments has been
performed within an error diameter of the gold standard segments equal to 2[pixels].

such as transport efﬁciency, resilience, cost and control
complexity.

ACKNOWLEDGEMENT

The authors thank to L. Boddy, D. A’Bear, J. Hynes and J.
Wood for some of the fungal images analyzed.

Funding: BBSRC, EPSRC and NERC, and an Academic
Fellowship from Research Councils UK.

Conﬂict of Interest: none declared.

REFERENCES

Barry,D. and Williams,G. (2011) Microscopic characterisation of ﬁlamentous mi-
crobes: towards fully automated morphological quantitation through image
analysis. J. Microscopy, 244, 1—8.

Bebber,D. et al. (2007) Biological solutions to transport network design. Proc. Roy.
Soc. B: Biol. Sci., 274, 2307—2315.

Beucher,S. and Lantuejoul,C. (1979) Use of watersheds in contour detection. In
International Workshop on Image Processing, Real-Time Edge and Motion
Detection/Estimation, Vol. 1. pp. 1—11.

Boddy,L. and Donnelly,D. (2008) Fractal geometry and microorganisms in the
environment. In Biophysical Chemistry of Fractal Structures and Processes in
Environmental Systems, Vol. 11. John Wiley & Sons, Chichester, UK,
pp. 239—272.

Boddy,L. et al. (2009) Saprotrophic cord systems: dispersal mechanisms in space
and time. M ycoscience, 50, 9—19.

Boddy,L. et al. (2010) Fungal network responses to grazing. Fungal Genetics and
Biology, 47, 522—530.

Carpenter,A. (2007) Software opens the door to quantitative imaging. Nat.
Methods, 4, 120—121.

Chaudhuri,S. et al. (1989) Detection of blood vessels in retinal images using two
dimensional matched ﬁlters. IEEE Trans. Med. Imag., 8, 263—269.

Chwialkowski,M. et al. (1996) A method for fully automated quantitative analysis
of arterial ﬂow using ﬂow-sensitized MR images. Comput. Med. Imag. Graph,
20, 365—378.

Dehkordi,M. et al. (2011) A review of coronary vessel segmentation algorithms.
J. Med. Signals Sens, 1, 57—62.

Frangi,A. et al. (1998) Multiscale vessel enhancement ﬁltering. In Medical Image
Computing and Computer-Assisted Interventation, Vol. 1496. pp. 130—137.

Fricker,M. et al. (2007) Network organisation of mycelial fungi. In Biology of the
Fungal Cell, Vol. 8 The Mycota. Springer, Berlin, Germany, pp. 309—330.

Gelasca,E. et al. (2009) A biosegrnentation benchmark for evaluation of bioimage
analysis methods. BM C Bioinformatics, 10.

Haris,K. et al. (1997) Automated coronary artery extraction using watersheds. In
IEEE International Conference on Computers in Cardiology. IEEE Press,
pp. 741—744.

Higgins,W. et al. (1989) Automatic extraction of the arterial tree from 3D angio-
grams. In IEEE International Conference on Engineering in Medicine and
Biology Society, Vol. 2. pp. 563—564.

Kawata,Y. et al. (1995) An approach for detecting blood vessel diseases from
cone-beam CT image. In IEEE International Conference on Image Processing.
IEEE Press, pp. 500—503.

Klein,A. et al. (1994) Identifying vascular features with orientation speciﬁc ﬁlters
and B-spline snakes. In IEEE International Conference on Computers in
Cardiology. IEEE Press, pp. 113—116.

Knutsson,H. (1989) Representing local structure using tensors. In Scandinavian
Conference on Image Analysis. Springer-Verlag, pp. 244—251.

Kong,T. and Rosenfeld,A. (1996) Topological Algorithms for Digital Image
Processing. Elsevier Publishing, New York, NJ, USA.

Kovesi,P. (2000) Phase congruency: a low-level image invariant. Psychol. Res, 64,
136—148.

Krissian,K. et al. (2000) Model-based detection of tubular structures in 3D images.
Comput. Vis. Image Und., 80, 130—171.

Kvilekval,K. et al. (2010) Bisque: a platform for bioimage analysis and manage-
ment. Bioinformatics, 26, 544—552.

Meijering,E. et al. (2004) Design and validation of a tool for neurite tracing
and analysis in ﬂuorescence microscopy images. Cytometry Part A, 58A,
167—176.

Meyer,F. (1994) Topographic distance and watershed lines. Sig. Process, 38,
1 13—125.

Nekovei,R. and Sun,Y. (1995) Back-propagation network and its conﬁguration
for blood vessel detection in angiograms. IEEE Trans. Neural Networks, 6,
64—72.

Obara,B. et al. (2012) Contrast-independent curvilinear structure detection in bio-
medical images. IEEE Trans. Image Proces, doi:10.1109/TIP.2012.2185938.
Otsu,N. (1979) A threshold selection method from gray-level histograms. Man

Cybernetics, 9, 62—69.

Prinet,V. et al. (1996) Thin network extraction in 3D images: application to medical
angiograms. In IEEE International Conference on Pattern Recognition.
pp. 386—390.

Ritz,K. et al. (1996) Detailed visualisation of hyphal distribution in fungal mycelia
growing in heterogeneous nutritional environments. J. M icrobiol. Methods, 25,
23—28.

Rodriguez,A. et al. (2008) Automated three-dimensional detection and shape clas-
siﬁcation of dendritic spines from ﬂuorescence microscopy images. PLoS One,
3, e1997.

Sato,Y. et al. (1998) 3D multi-scale line ﬁlter for segmentation and visualization of
curvilinear structures in medical images. Med. Image Anal., 2, 143—168.

Serra,J. (1982) Image Analysis and Mathematical Morphology. Academic Press,
New York, NJ, USA.

Smets,C. et al. (1988) A knowledge-based system for the delineation of blood vessels
on subtraction angiograms. Pattern Recog. Lett., 8, 113—121.

Summers,P. and Bhalerao,A. (1995) Derivation of pressure gradients from magnetic
resonance angiography using multi-resolution segmentation. In IEEE
International Conference on Image Processing. IEEE Press, pp. 404—408.

Swedlow,J. et al. (2003) Informatics and quantitative analysis in biological imaging.
Science, 300, 100—102.

Westin,C. et al. (2001) Three-dimensional adaptive ﬁltering in magnetic resonance
angiography. J. Mag. Resonance Imag., 14, 63—71.

Zana,F. and K1ein,J. (1997) Robust segmentation of vessels from retinal angiog-
raphy. In IEEE International Conference on Digital Signal Processing, Vol. 2.
pp. 1087—1090.

 

2381

112 /810's112umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(11111 U101} pop1201umoq

9IOZ ‘091sn8nv uo ::

