Vol. 26 ISMB 2010, pages i 1 75-i 182
doi: 10. 1093/bioinformatics/btq204

 

Estimating genome-wide IBD sharing from SNP data via an
efficient hidden Markov model of LD with application

to gene mapping

Sivan Bercovici1’*, Christopher Meek2, Ydo Wexler2 and Dan Geiger“2
1Technion—Israel Institute of Technology, Computer Science Department Haifa, 32000 Israel and 2Microsoft

Research, Redmond, WA 98052, USA

 

ABSTRACT

Motivation: Association analysis is the method of choice for
studying complex multifactorial diseases. The premise of this method
is that affected persons contain some common genomic regions with
similar SNP alleles and such areas will be found in this analysis. An
important disadvantage of GWA studies is that it does not distinguish
between genomic areas that are inherited from a common ancestor
[identical by descent (IBD)] and areas that are identical merely by
state [identical by state (IBS)]. Clearly, areas that can be marked with
higher probability as IBD and have the same correlation with the
disease status of identical areas that are more probably only IBS,
are better candidates to be causative, and yet this distinction is not
encoded in standard association analysis.

Results: We develop a factorial hidden Markov model-based
algorithm for computing genome-wide IBD sharing. The algorithm
accepts as input SNP data of measured individuals and estimates
the probability of IBD at each locus for every pair of individuals.
For two g-degree relatives, when g3 8, the computation yields a
precision of IBD tagging of over 50% higher than previous methods
for 95% recall. Our algorithm uses a first-order Markovian model
for the linkage disequilibrium process and employs a reduction of
the state space of the inheritance vector from being exponential in
g to quadratic. The higher accuracy along with the reduced time
complexity marks our method as a feasible means for IBD mapping
in practical scenarios.

Availability: A software implementation, called IBDMAP, is freely
available at http://bioinfo.cs.technion.ac.i|/|BDmap.

Contact: sberco@gmail.com

1 INTRODUCTION

Association analysis is the method of choice for studying complex
multifactorial diseases with low penetrance. The basic idea is to
compute a correlation between each measured SNP and the affection
status, and then further study areas that contain SNPs with high
scores. The premise of this method is that affected persons contain
some common genomic regions with similar SNP alleles and such
areas will be found in this analysis. The large number of tests
(2 500000) requires correction for multiple testing (Benjamini and
Yekutieli, 2005; Han et al., 2009; Peer et al., 2008). To capture
the fact that dense SNPS are not independent, one can use various
blocks of linked SNPs and ﬁnd correlation to the blocks rather
than to individual SNPs (Cardon and Abecasis, 2003; Greenspan

 

*To whom correspondence should be addressed.

and Geiger, 2004; Halperin et al., 2005). The main advantage of
association analysis is that it can potentially identify small suspect
areas provided that sufﬁciently many individuals are sampled.

An important disadvantage of this method is that it does not
distinguish between genomic areas that are inherited from a common
ancestor [identical by descent (IBD)] and areas that are identical
merely by state [identical by state (IBS)]. Clearly, areas that can be
marked with higher probability as IBD and have the same correlation
with the disease status of identical areas that are more probably only
IB S, are better candidates to be causative, and yet this distinction is
not encoded in standard association analysis.

The popular PLINK program for association analysis, among its
many functions, provides a method that challenges this common
practice (Purcell et al., 2007). PLINK accepts SNP data of affected
and healthy individuals, then infers the IBD areas for each pair and
consequently uses a score (Equation 6) to evaluate the extent to
which a SNP is suspected to predispose or cause a disease. The
input of this formula relies on inferring the IBD status of the SNP
for each pair of input individuals. The inference is done via an hidden
Markov model (HMM) with a small hidden state space that encodes
the IBD status at the current locus using three states. The power of
this mapping method highly depends on the precision of the IBD
inference.

Our work herein replaces the part of inferring IBD with an
improved method using a more accurate HMM model with a state
space that grows quadratically with the number of generations g
that distinguish two individuals. We develop a factorial HMM—based
algorithm for computing genome—wide IBD sharing. The algorithm
accepts as input SNP data of measured individuals and estimates the
probability of IBD at each locus for every pair of individuals. To
estimate performance, we measure precision, which is the number
of correctly identiﬁed IBD positions divided by the total number of
position inferred as IBD, and recall, which is the number of correctly
identiﬁed IBD positions divided by the number of IBD positions.
For two g—degree relatives, when g28, the computation yields a
precision of IBD tagging of over 50% higher than previous methods
for 95% recall.

Our algorithm uses a reduction of the state space of the inheritance
vector used in MERLIN from being exponential in g to quadratic
and combines it with a ﬁrst—order Markovian model for the linkage
disequilibrium (LD) process. In essence, we apply sophisticated
techniques from linkage analysis to genetic studies without pedigree
input. The application of our method to gene mapping shows a
noticeable improvement.

The rest of this article is organized as follows. Section 2 deﬁnes
HMMs and explains the inferences done with them. Section 3

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUTOTQ/ﬁdnq mm; pepeommoq

9IOZ ‘Ig1sn8nv I102:

S.Bercovici et aI.

 

provides background information regarding genetic analysis.
Section 4 develops a model for LD and an appropriate inference
procedure for it. Section 5 explicates the results for IBD inference
and for gene mapping. Finally, Section 6 discusses limitations of
current IBD inference procedures and future directions.

2 HMM AND FACTORIAL HMM

Consider a HMM (Rabiner and J uang, 1986) with hidden variables
Si and observed variables Xi, i=1,...,L, as described in Geiger
et al., 2008. The (hidden) state space is the set S of possible values
for Si. The state space is identical for every slot i. The likelihood of
data (x1, ...,xL) for L slots is speciﬁed via two main components.
The single slot likelihood of data P(x,-|s,-) at slot i given a state s,-
for Si and the transition probabilities P(S,- =si|Si_1 =sl-_1) from a
state at slot i —1 to slot i.

Puma): ZP(51)P(3C1151 =s1)

S1

ZP(S2=s2|S1=S1)P(x2152=sz)“‘ (1)

Sz

ZPCSL =SL|SL—1=SL—1)P(XL|SL =SL)-

SL

The time complexity of computing this sum grows quadratically
with the size of the state space [S | and linearly in the number of slots
L. The time complexity is 0(L|S|2—i—cL|S|) where c is an upper
bound for computing the single slot likelihood P(x,-|s,-). We note
that in many HMM applications, including IBD sharing and linkage
analysis, the goal is to also compute the marginal probabilities
P(S,-|x1,...,xL) for all i=1,...,L rather than to compute just the
likelihood of data. This task can be completed using the junction—
tree algorithm with only twice the computational cost (Lauritzen and
Spiegelhalter, 1988).

Factorial HMMs (Ghahramani and Jordan, 1997) are HMMs
in which the hidden variable is a vector Si=(Sl.1,...,Sll.‘) with
values drawn from some Cartesian product H1 ><  ka and
with a transition probability deﬁned component by component for
i=2,...,L via

P<Si=(s},...,sf-‘)iS.-_1=(s}_1,...,s§_1»

k . . (2)

and for the ﬁrst slot, P(S1=(s%,...,slf))=]_[f=1Pj(s€). In our

application, each  is called a selector, and the vector Si determines
the inheritance pattern in the pedigree. We model the recombination
probabilities as P(S§|S§_17ES£)=1—e_l, where l is the genetic
distance, in Morgans, between location i and i— 1.

Factorial HMMs offer computational beneﬁts when computing
the likelihood of data. Ghahramani and Jordan (1997) Section 3.2
show how specifying the probabilities P(S,-|S,-_1) via a product
as in Equation 2 reduces the time complexity to 0(L|S|10g|S|—l—
cL|S|). Their algorithm is a special case of bucket elimination
(Dechter, 1998). We note that computing the L marginal probabilities
P(S,-|x1,...,xL) in a factorial HMM can also be performed with
only twice the amount of computations using the junction—tree
algorithm (Lauritzen and Spiegelhalter, 1988).

In applications, where S is possibly very large such as for linkage
analysis where it grows exponentially in, roughly, the number of
persons in the pedigree, the dominating factor |S|log|S| can be
further reduced substantially if the state space S can be partitioned
into equivalence classes [s] for which the likelihood of data is
constant. This effectively changes the sum over the state space
at each slot to a sum over equivalence classes. The dominating
complexity will now depend on the number of equivalence classes
rather than on the number of states in S (Browning and Browning,
2002; Geiger et al., 2008; Markianos et al., 2001).

The likelihood is computed for one representative of each
equivalence class via

P(data)=ZP([SlDP(xlisl =[s11)
[Si]

Z[SZ]P(SZZ[521151=[S1])P(x2|S2:[52])... (3)
Z[SL]P(SL : [SL]|SL—l = ISL—1])POCL ISL = [SLD

where the prior for a class [s] is the sum over the priors of its
constituent states, namely, P([s])=ZSE[S]P(s). Note that [si] is
used to denote the class containing si, as in si€[si], and also a
representative from the class containing state si, as in S, 2 [Si].

The equivalence of Equations 1 and 3 stems from two general
conditions:

CONDITION I. The single slot likelihood given a hidden state s is equal
for all states in the equivalence class [s], namely, P(x,-|s)=
P(xl- ls’ ) for all s and s’ in the same equivalence class. Hence, we
can safely deﬁne the single slot likelihood given an equivalence
class via P(x,- | [s]) =P(x|s).

CONDITION II. Denote by P([s]|s’)=ZSE[S]P(s|s’) the transition
probability from state s’ to an equivalence class [s]. The
condition is that this transition probability does not distinguish
between two states in the same equivalence class, namely,
P([s]|s’)=P([s]|s”) for all s’ and s” in the same equivalence
class. Hence, we can safely deﬁne the transition probabilities
between equivalence classes via P([s] | [s’]) =P([s] ls’).

These two natural conditions are sufﬁcient to ensure that
Equations 1 and 3 are equivalent (Geiger et al., 2008).

3 GENETIC ANALYSIS

Genetic linkage and association analysis seek to locate genomic
regions that are likely to contain genes that increase the probability
of inheritable traits such as hereditary diseases. In the case of linkage
analysis, the input are pedigrees of families that segregate a disease,
genetic marker information such as SNP data and affection status of
some or all family members. The main idea is that genetic markers
that are found in the same vicinity on the chromosome are more
likely to stay together during meiosis. Thus, based on the topology of
the pedigree and the marker readings, it is possible to compute how
likely it is for a predisposing gene to be located on the chromosome
near each of the markers (Elston and Stewart, 1971; Lander and
Green, 1987; Lange, 1997; Ott, 1999). Genetic association analysis
shares the same goal of linkage analysis but uses a very different
approach. The input to the basic design of association analysis is
genetic marker data of affected individuals and of matched healthy
controls. The output is a correlation, or more generally some score,

 

i176

112 /§.IO'SIBUJHOprOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; pepeommoq

9IOZ ‘Ig lsnﬁnv (10::

Estimating genome-wide IBD sharing

 

relating marker data at speciﬁc genomic locations with the trait under
study (Carlson et al., 2004; Halperin and Stephan, 2009; Peer et al.,
2006; Wang et al., 2005).

There are pros and cons to these methods and both are used in
countless number of mapping projects ranging from single gene
rare Mendelian diseases to common complex diseases that are
caused by an array of genetic, behavioral, environmental and other
factors. Genetic linkage analysis is very successful in underpinning
Mendelian diseases with high penetrance; there are hundreds of
successfully veriﬁed discoveries using linkage. For such studies,
a sparse array of genetic markers is needed to reach a valid
conclusion—around 6000 SNP genome—wide at an average distance
of 0.5 M base pairs. With such distance, the alleles of the founders of
the pedigree can be considered to be independent, that is in linkage
equilibrium, and this assumption is used in the standard model of
linkage analysis. The strength of linkage analysis is the identiﬁcation
of stretches of SNPs that are more often passed from affected persons
to affected offspring than to non—affected offspring. Such stretches
have high likelihood of odds (LOD) to contain a predisposing or
causative gene.

There are several scoring methods commonly used for linkage
analysis. They differ in how the scoring function depends
on the probability of the possible inheritance patterns in the
pedigree. Examples of such functions are Sa11,SpairS and LOD
scores (Kruglyak et al., 1996). As the number of such inheritance
patterns grows exponentially in the number of markers and
roughly in the number of persons in the pedigree, computationally
sophisticated methods were proposed for this task. A common
structure shared by most exact scoring methods is a HMM (Rabiner
and Juang, 1986) backbone, which is in fact a Factorial HMM
with a state space deﬁned by a set of variables Si called selectors
that determine the inheritance pattern in the pedigree (Abecasis
et al., 2002; Gudbjartsson et al., 2005, 2000; Ingolfsdottir and
Gudbjartsson, 2005; Kruglyak and Lander, 1998; Kruglyak et al.,
1995, 1996; Lander and Green, 1987; Markianos et al., 2001).
Other techniques based, sometimes implicitly, on Bayesian networks
(Lauritzen, 1996; Pearl, 1988) focus on larger pedigrees with fewer
measurements (Cottingham et al., 1993; Elston and Stewart, 1971;
Fishelson and Geiger, 2002; O’Connell and Weeks, 1995; Silberstein
et al., 2006; Sobel and Lange, 1996; Thompson, 1994).

The main computer programs that analyze pedigrees with SNP
data are GENEHUNTER, ALLEGRO and MERLIN (Abecasis et al.,
2002; Gudbjartsson et al., 2000; Markianos et al., 2001). Due
to the increasing number of markers on standard SNP panels,
these programs basically use the same HMM model employing the
forward—backward algorithm as developed by Lander and Green
(1987) in their seminal work in this area. The differences lie in the
details of how transition matrices are represented and multiplied, and
how the emission probabilities are computed, both of which can
dramatically affect the time complexity of the forward—backward
algorithm.

In several works (Kruglyak and Lander, 1998; Kruglyak et al.,
1995, 1996) with increasingly better methods for multiplying a
vector by the specialized form of the transmission matrix P(Si |Si_1)
used in this application, of size N X N, complexity of multiplication
dropped to N logN and the effective size of N dropped to N ’
by considering symmetries in the transition matrix. For certain
pedigrees, this drop is exponential in the number of persons

decreasing N from 22” to 22”_f and for some pedigrees to 22”_f_c
where n is the number of non—founders in the pedigree, f is the
number of founders and c is the number of ﬁrst grandchildren
whose grandparents are all founders in the pedigree (Markianos
et al., 2001). Further exponential reductions of the state space for
special pedigrees such as pedigrees that contain long chains are also
available (Browning and Browning, 2002; Geiger et al., 2008).

Other works (Abecasis et al., 2002; Gudbjartsson et al.,
2005, 2000) improved the representation and computation of the
emission probabilities, namely, the probability of data at slot i given
the state at slot i. There are two factors that make this computation
demanding. First, to compute the probability P(x,-|s,-) for a speciﬁc
state sl- requires to sum over all possible assignments of alleles fl- to
the founders in the pedigree, namely,

P(xiisi)=ZP(xl-Isi,ﬁ>P<m. (4)
13-

A naive approach will be exponential in the number of founders in
the pedigree that are not genotyped, but Sobel and Lange (1996)
managed to use the conditional independence fact that once a state
sl- is given, only the alleles of a few founders determines P(x,- [st-fl).
Using what they termed descend trees, they compute P(x,-|s,-) in
polynomial time for every single state si. Still, to compute this
likelihood for every sl- requires repeating this operation 2ISI times,
which often grows too large. The modern software packages MERLIN
and ALLEGRO both decrease the magnitude of this problem by reusing
computations from one state to another and the fact that after a partial
vector of sl- is known, the remaining component of the state do
not change the computation of P(x,-|s,-). These improvements still
leave the worst case time complexity unchanged, but in practice
considerably reduce the run time. We refer to the resulting factorial
HMM that we just described (Equations 1 and 2) as the standard
model.

The standard model has some clear deviations from reality. First,
it assumes that the pedigree is known with certainty, which often
is not the case. Second, it assumes that the hidden states are
ﬁrst—order Markovian, which means in genetics language, that a

recombination event at slot i (encoded as  7555 +1) is independent

of a recombination event at the previous slot (encoded as sLl #sé),
which does not hold for close markers; the violation of this
assumption is termed chiasma interference. A third assumption
is that the two alleles for each founder are independent of each
other; this assumption is called the Hardy—Weinberg equilibrium.
A fourth and ﬁnal assumption of the standard HMM model for
linkage analysis is that the founder’s alleles at slot i do not depend
on the founder’s alleles at slot i— 1, hence P(x,- |si) can be written as
ZfPOci [st-J,- )P(f,-) at each slot where P(f,-) is the prior probability of
the founder alleles. This assumption, which does not hold for close
markers, is called linkage equilibrium.

The dependency between alleles of nearby markers is called LD
(Purcell et al., 2007). Our main contribution in this article is to model
LD within the HMM framework, improving accuracy of inference,
and still perform the forward—backward algorithm sufﬁciently fast
for some common pedigree structures. In the experimental section,
we show the improvement of accuracy as a result of modeling LD.

 

i177

112 /§IO'sieumoproJIXO'soneurioJIquIq/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv (10::

S.Bercovici et aI.

 

4 MODELING LD AND INFERRING IBD

When markers become closer, and therefore dependent, a stretch
of SNPs that was inferred to be inherited as a block by affected
individuals and thus have high LOD score can actually be only IBS
rather than IBD. In other words, the stretch of SNPs shared by some
affected individuals has not been inherited from a single source
by inheritance (IBD), but inherited from multiple sources which
happen to be the same (IBS). For example, a stretch of n independent
markers with allele A have a probability [9,4,1 ~pA,2 -  19,4,” while
due to LD it is possible that only a handful of the 2” possible allele
assignments is possible, say in the extreme case only AA...A and
BB...B are possible. In such case a LOD score that does not take
LD into account is inﬂated and increases type I error, weakening the
power to differentiate true signals from false ones. Consequently,
as denser maps of SNPs are used in genetic analysis, modeling the
effects of LD becomes increasingly important.

The availability of denser and denser SNP panels weakens the
validity of the assumption of linkage equilibrium; almost every
two nearby markers are dependent. MERLIN is an efﬁcient linkage
program that allows the modeling of LD. Furthermore, MERLIN’s
developers provide a clear example that indicates the beneﬁts of
some type of models for LD for genetic analysis, showing how two
loci are found related to a disease when ignoring LD, while only
one locus remains suspect when LD is taken into account (Abecasis
and Wigginton, 2005). MERLIN’s method consists of the following
steps: cluster nearby SNPs, yielding a single marker with more
than two alleles, specify the prior of each of the cluster’s alleles
using EM or some data set such as HapMap (Frazer et al., 2007),
and ﬁnally, use the new markers as input to the standard (HMM)
model. The assumptions underlying this solution are that there are
no recombinations within the selected clusters and that there is no
dependency between clusters. We now develop an alternative to this
approach that does not make these assumptions.

For the task of adding LD to the model, consider an HMM with
hidden variables Si and F ,- and observed variables Xi, i=1,...,L.
The state space is now the set S X F of possible values for S, X F i,
where F ,- are founder alleles at slot i. The state space is identical for
every slot i. The single slot likelihood of data P(x,-|s,-,f,-) at slot i is
given for every state (si,f,-) and the transition probabilities from a
state at slot i— 1 to slot i have the product form

P(SiafiISi—l aft—1)=P(SiI5i—1)‘P(fi Ifi—l)

Further factorization of the transition matrix is given by

k . .
P(ﬁ=(i§1,---,fik)lﬁ—1=(ﬂ11w-uﬁ111»:HEW/1174), (5)

j=1

and for the ﬁrst slot, P(fl =(fll,...,f1k))=]_[f=1Pj(fll). A similar
factorization is assumed also for P(s,- |si_1) as given by Equation 2.
We refer to the factorial HMM represented by Equations 2 and 5 as
the full model.

We note that if every fl- is independent offi_1, then the full model
reduces to the standard model described in the previous section by
setting P(x,-|s,-)= ZfP(x,-|si,fi)P(ﬁ-). In our genetics application, f,-
represents alleles of the founders at slot i, and f,- being independent
offi_1 means that there is linkage equilibrium between the markers
at slot i and i— 1. Hence, the full model generalizes the standard
model by encoding LD via P(f,- [fl-_1). These conditional probability

 

 

Location i Location f+1

 

 

 

 

 

Fig. 1. Two slots of the g—degree relatives pedigree, where each node
represents an individual at a speciﬁc location. The last generation is
genotyped (measured). The full model has in addition two LD terms between
the founder F ,- in one slot and F ,- in the next slot, for every founder in the
pedigree. For clarity, these links are not shown. The model drawn has one
LD term for each of the common founder B’s alleles, and one additional LD
term for each of the founders F g and F ;.

tables, which we call LD terms, are estimated directly from data sets
such as HapMap that provides sets of haplotypes.

We have experimented with an implementation of the model and
report the results in the experimental section. There is an increase
of precision in all experiments with respect to current software for
IBD sharing. However, the full model has a signiﬁcantly higher
computational complexity than the standard model that severely
limits the applicability to speciﬁc pedigree topologies. The source
of increased time complexity stems mainly from the increase of
the hidden state space from S to H =S X F. The magnitude of this
increment depends on the relative size of F versus S which depends
strongly on the pedigree topology. For example, a pedigree that
consists of two parents and c children has a state space size of
the order S =0(2C) while F is a constant of size 16. Hence for a
nuclear family with many children, the increase of the state space
can be acceptable. On the other hand, for g—degree relatives pedigree
the state space without LD is 0(223), while the state space with
LD grows to 0(263) because each founder F ,- and F ’ ,- adds two
LD terms to the standard model, one for each founder allele. See
Figure 1 for an illustration. Notably, the full model is still a factorial
HMM and therefore, the forward—backward algorithm has a matrix
multiplication complexity of 0(|H|log|H|) rather than 0(|H|2),
which means that it can run for small pedigrees such as nuclear
families or small three generation family pedigrees. Such families
are often used in genetics studies. Consequently, since the full model
exhibits some improvement in precision, it should be used whenever
possible.

The time complexity of the full model increases signiﬁcantly with
larger pedigrees, because the factorial HMM is augmented with

an LD term P(fl‘.] [fl‘l_1) for every allele for every founder in the
pedigrees. However, since this addition burdens the computations,
one can settle with modeling the LD only between a subset of
founders. Maj or reduction of the running time can be achieved using
this approximation. In this article we focus on the g—degree relatives

 

i178

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv 110::

Estimating genome-wide IBD sharing

 

model with two LD terms for the single common founder and a single
LD term for each of the two direct parents of the typed individuals.
We term this model the 4-track model, reﬂecting the fact that four
LD chains are retained from the full model. We further call the model
containing only two LD terms for the single common founder the
2-track model.

The size of the hidden state space for the 4—track model is
0(225’), which yields exponential time and space requirements. We
now describe a reduction of the state space to 0(g2) such that
the likelihood computed in the 4—track model is identical to the
likelihood computed when the state space is reduced. The ideas that
lead to this major reduction of time and space complexity are based
on Geiger et al. (2008), where we analyzed the g—degree relatives
models without modeling LD. The state space reductions are formed
by clustering the selectors Si and partitioning the states of each
cluster so that Conditions I and II, stated in Section 2, are satisﬁed.

We ﬁrst deﬁne a class of clusters that satisﬁes Condition II and
then make a speciﬁc choice within this class that also satisﬁes
Condition I. A selector S can have two complement states: ON and
OFF. For a cluster C with r such selectors, a state [i] of the reduced
state space of C is the equivalence class that contains all vectors
of size r that have j entries being ON and r— j being OFF. So, we
have c(j,r)=r!/j!(r—j)! vectors in state [i] forj=0,...,r. This set
of r—l—1 equivalent classes is called the counting partition.

For the counting partition, the transition probability P([i] |cj) for
switching from a state cf of C with j positions ON to any one state
with i positions ON is speciﬁed below. Let 6 be the probability of
switching from state ON to state OFF and of switching from state OFF
to state ON. The other two transitions have probability 1—6. The
probability of switching from a state cf, where j selectors are ON to
the state [i] in which some arbitrary i selectors are ON, is given by

P([iIICj)=

Zc(r,j)-c(i—r,r—j)(1—6)r—<itf—2t)eff—2t
t
where t is the number of selectors that are ON both in [i] and in state
cj, ranging from max(0,i—l— j —r) to min(i, j). With these transition
probabilities, the next theorem states that the reduced state space
satisﬁes Condition II.

THEOREM 1. Let S =(S1,...,Sk) be a vector of selectors and let
C={C1,...,Cm} beaset ofdisjoint clusters with r1,...,rm selectors,
respectively, in each cluster, where k=Zﬁ1rj. Then a factorial
HMM in which the hidden variable has values drawn from the
Cartesianproduct [C] = [C1] X  >< [Cm] X F, where F is someﬁxed
state space, [Cl] is the set of equivalence classes of cluster C;
generated by using the counting partition, satisﬁes Condition 11.

This theorem has been stated and proven in Geiger et al. (2008)
for the case F: @, namely, when no LD terms are included. Since
the model is a factorial HMM and F is part of the transition
probability that does not change in the reductions, the proof given
earlier for F :0 still holds verbatim, and Condition II holds for
counting partitions also when some or all the LD links are added
to the standard model. The theorem holds for models of arbitrary
pedigrees.

Satisfying also Condition I requires limiting the way we cluster
selectors. For the g—degree relatives pedigree, the 4—track model
includes a set of selectors along the chain of inheritance to one

individual, and a chain of selectors of the same length to the other
individual.

THEOREM 2. Consider the 4-track model for g-degree relatives. Let
Sa=(S3,...,S§) be a vector of selectors for the ﬁrst chain and
let Sb=(S0,...,S§) be a vector of selectors for the second chain

in this model. Let SS be a binary variable with a value ON if
Sé=ON for i=1,...,g, and a value OFF ifSé=OFF for at least
some i, lfifg. Let S; deﬁned similarly wrt. the second chain.
Then the likelihood of SNP data at each slot is determined by
SaC,S3,Sg,Sg,the founder allelesf1,f2,f3,f4 and the prior allele
distribution.

PROOF. The proof analyzes all possible assignments to the selectors
in the 4—track model and shows that all 0(225’ ) assignments map into
the 16 possibilities deﬁned by the four binary variables S5535;

and S2. The data consists of four alleles, two for each individual.
Each individual receives one allele from the parent not on the
chain to the common ancestor, namely f 3 and f4. In addition,
each individual receives the second allele either from the common
founder or from another founder off the chain of inheritance.

A state (si,f,-) is consistent with the data x,- if the inheritance
deﬁned by state sl- connects each measured allele to a founder
allele that equals to it, or to an allele of a founder who is off the
chain of inheritance. Out of the four measured alleles, N = 0, 1,2 are
inherited from the set {f 1 , f 2} — the common founder’s alleles. Let
p1 , . . . p4 be the marginal probabilities of the four measured allele.
The probability of data is 0 if the state is not consistent with the
data. Otherwise, the probability of the data is a function of these
four marginals. Since consistency and the number of shared alleles
N is determined by SS,S3,S§,Sg,f1,...,f4, so is the probability of
data. I

The next theorem summarizes the main claim.

THEOREM 3. The likelihood computed in the 4-track model with and
without the state space reduction are identical. The time complexity
is 0(g210gg).

PROOF. We have shown that the state space reductions for the 4—track
model satisfy Conditions I and II. Consequently, the likelihood
computed in the 4—track model is identical to the likelihood
computed with the reduced state space. The time complexity of
multiplication for factorial HMM is given by 0( [H | log [H |) where H
is the domain of the hidden state space. Here H = 24 x g x g, yielding
the claimed complexity. I

Similar results also hold for arbitrary pedigrees by adding any
subset of LD links to the standard model. The statement and proof
of the most general claim requires several deﬁnitions and a lengthy
derivation that are beyond the scope of this article. However, the
arguments follow closely the line of reasoning pursued in Geiger
et al. (2008). Using that paper’s terminology, the deﬁnition of a
chain needs a slight adjustment. Each chain must now be split to two
chains at each individual for which an LD term is added. That paper
explains how the state space reductions are formed and, using the
revised deﬁnition of a chain, the arguments for correctness change
only slightly. We refer the reader to Geiger et al. (2008) for details.

 

i179

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv 110::

S.Bercovici et al.

 

 

   

 

 

 

 

E
D
E
U
N
I—
a.
a -
'—'l—' Standard ‘a. ‘II-
—+—-|:-1=|:J..i.n [Ectuilihriumi 1; ,x'ﬁk
""lh'Me-tlin if}, It.
I-.' I‘
PIE-ink [Equilibrium] “M... ‘1,
. “1.. ‘~
"""" PLlnk H'- KN.
I | | I I I I “1519'-
3. 4 5 a i a Q m

Generations

Fig. 2. The 4—track model achieves a signiﬁcantly higher precision in
comparison to the other methods under most tested scenarios, increasing the
performance gap for g 2 8 with over 50% improvement. Results correspond
to over 95% recall for the 4—track model, and a lower recall for PLINK and
MERLIN.

5 EXPERIMENTAL RESULTS

We divide the experiments into two main components. First, we
demonstrate the improvements in the IBD inference precision using
simulated data. We compare our results to the standard programs
MERLIN and PLINK. Second, we apply the association mapping
technique offered by PLINK, which uses inferred IBD status to score
genome loci as suspect areas for predisposing genes. We show
that the increased IBD inference accuracy gained using our method
improves the performance in the task of gene mapping. The higher
precision of our method when inferring IBD status is well illustrated
in Figure 2. Each point is the average of 100 runs. The data was
simulated as follows. We used a pedigree representing a pair of g—
degree relatives and their ancestors (as depicted in Fig. 1). Haplotype
data of the founders were randomly sampled from HapMap’s CEPH
(Utah residents with ancestry from northern and western Europe)
set of phased individuals. We simulated the offspring along the
chain of inheritance using the corresponding pedigree topology and
recombination probabilities P(SilSl-_1). Both PLINK and MERLIN
were applied using default parameters and the original marker
set used in simulations. As both models assume that markers
are independent, we further evaluated the performance of these
two methods on a reduced marker set that accommodates this
linkage equilibrium assumption. The markers were selected by
applying PLINK’s VIF (Variance Inﬂation Factor) pruning, with the
recommended setting.

The precision values shown in Figure 2 are for recall of
approximately 95%. The results indicate that the 4—track model
is superior to previous methods in terms of precision, except for
MERLIN when g=7, while maintaining a higher recall rate in all
the examined cases. Namely, the recall of the 4—track model was
above 95% in all reported results, whereas previous models had
at most 95% recall and often lower. All methods deteriorate as a
function of g, but the 4—track model deteriorates slower than others.
As expected, pruning markers in linkage disequilibrium improves
the performance of both PLINK and MERLIN (denoted by Equilibrium
in the graph).

1 El gene-ratios

 

—1-t.noh
-----PL1r..I-.
Merlin

 

 

 

Ettore

 

 

Eiznre

 

 

 

E gene-ratios

Stare

 

 

 

Fig. 3. Finding a disease seeded at 22 cm (location indicated by the
horizontal line) using IBD predictions. Pairs of individuals were simulated
using g = 6,8,10, assuming a dominant disease with complete penetrance that
originated from a common founder.

As an extreme example, we consider data simulated with g: 30.
The ability to apply our program successfully to such data means
that one can hope to identify common genomic areas of individuals
that have a common ancestor ~700 years ago, around the population
bottleneck event caused by the black death that killed approximately
half of Europe’s population. When using the 2—track model, and
assuming g = 10 during the inference, IBDMAP achieves a precision
of 35% for a recall of 85% and a precision of 47% for a recall of
75%. This conﬁguration was used to expedite the results.

The second step of our experiments has been aimed at examining
the extent of improvement in gene mapping techniques as a result of
the increased precision in IBD inference. The program PLINK, among

 

i180

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv 110::

Estimating genome-wide IBD sharing

 

many other functions, accepts SNP data of affected individuals,
then infers the IBD areas for each pair and consequently uses the
following formula to score to what extent an SNP is suspected to
predispose or cause a disease:
Maa _Maa Mlaa _M!aa
l l

5,: N33 — Nlaa (6)

 

where N “a and N W represent the number of pairs of affected and
unaffected individuals, respectively, and Mia“ and M lid“ represent
the number of pairs with IBD at marker i that are both affected
or where at least one of the pair is unaffected, respectively
(Purcell et al., 2007). The terms Ma“ and MI33 are the averages
of M?“ and Mliaa. The input of this formula relies on the inferred
IBD status of an SNP for each pair of input individuals. Our test
replaces the IBD inference mechanism and plots the resulting score.
We simulated data from g—degree relatives using a dominant disease
model with complete penetrance, designating a speciﬁc founder’s
haplotype location as the disease origin. Founder haplotypes,
including those of the common ancestor, were randomly selected
from the HapMap CEPH data, using a separate set from the one
used for learning the LD. Figure 3 details the performance of the
different methods in the task of disease gene mapping. For g = 6, the
results show that all three models correctly identify the disease locus,
placed at 22 cm. However, for g = 8, the peak around the genuine
locus is made much more evident when using the 4—track model
than when using either PLINK or MERLIN, maintaining this relative
performance for g = 10. Repeating these experiments with different
randomly chosen SNPs to be the location of the disease yielded
similar results. We note that these experiments were done over a
50 cm region on Chromosome 1, using SNP density comparable to
the 500 k genome—wide panels.

6 DISCUSSION

Measurements of LD in recent years become more accurate as data
of haplotypes accumulate. Yet, even with current public data, the
knowledge of LD already upgrades the performance of various
methods for gene mapping such as linkage analysis, mapping
by admixture linkage disequilibrium (MALD), and association
studies (Abecasis and Wigginton, 2005; Bercovici and Geiger, 2009;
Eskin, 2008). In this article we incorporated a ﬁrst—order Markov
model of LD within models of family inheritance and showed
how this improves the analysis of shared IBD areas. The proposed
model becomes computationally efﬁcient because we have devised
a suitable partition of the state space, which satisﬁes Conditions I
and II, and as a result reduces an exponential complexity to a
quadratic one.

The fundamental difﬁculty in estimating IBD status is that
recombination events erase the trace of inheritance after a few
dozens of generations leaving small IBD areas that compete against
random areas that are equal only by state. The errors produced by
PLINK are mostly due to interpreting an IBS area as being IBD,
and our method that uses a novel ﬁrst—order HMM for modeling
LD reduces these mistakes. An important challenge remains to
incorporate better models of LD within better models of family
inheritance to obtain higher accuracy of IBD inference. The result of
more accurate models that are still computationally feasible will be
the ability to identify smaller regions of IBD whose origin is more
distant than what can be inferred with current models. In addition,

our model can be extended so as to take into account genotyping
errors via appropriate adjustment of Equation 4. Speciﬁcally, error
in genotyping can be expressed through the conditional probability
P(xi Isl 7fi

Our model assumes a pedigree structure of an equidistance single
ancestor, based on the observation that the closest common ancestor
contributes most to the IBD between two individuals. As such, the
model efﬁciently approximates more complex pedigrees for which
exact computation of IBD status is intractable. The performance
of our method with respect to an arbitrary given pedigree can be
evaluated via simulations. It further follows that a misestimation
of the number of generations since the common ancestor affects
our method’s performance. For example, in the case of 5—degree
relatives, a mis—speciﬁed g=3,4,6,7 during the inference will
reduce the precision from 89% to 82%, for a recall of 92%. One
possible approach for the estimation of the parameter g is by learning
from the SNP data of the two individuals, using adjusted maximum
likelihood (Schwarz, 1978).

The main contribution of this article is towards mapping
techniques that do no not use pedigrees as input, such as association
studies, IBD mapping and homozygosity mapping. We assume, as
with PLINK, that pairs of affected persons have a higher likelihood
for a common ancestor, and when such an ancestor is inferred,
the IBD areas can be detected with high probability. We modeled
the relationship between two input individuals using a g—degree
relatives pedigree, namely, a single common ancestor with a
separate path to each individual. The computational breakthrough
that allowed this computation to take place for large enough g
has been the clustering of selectors that represent meiosis events
along the two inheritance paths, into two variables, each with
g—l—1 states, and this reduced the complexity of the state—of—the—
art linkage program MERLIN from exponential to quadratic. A
software implementation, called IBDMAP, is freely available at
http://bioinfo.cs.technion.ac.il/IBDmap. The higher accuracy along
with the reduced time complexity marks our method as a feasible
means for IBD mapping in practical scenarios.

F unding: Israel Science Foundation; Azrieli Fellowship, Azrieli
Foundation (to SE.)

Conﬂict of Interest: none declared.

REFERENCES

Abecasis,G and Wigginton,]. (2005) Handling marker-marker linkage disequilibrium:
pedigree analysis with clustered markers. Am. J. Hum. Genet, 77, 754—767.

Abecasis,GR. et al. (2002) Merlin-rapid analysis of dense genetic maps using sparse
gene ﬂow trees. Nat Genet, 30, 97—101.

Benjamini,Y. and Yekutieli,D. (2005) Quantitative traits loci analysis using the false
discovery rate. Genetics, 171, 783—789.

Bercovici,S. and Geiger,D. (2009) Inferring ancestries efﬁciently in admixed
populations with linkage disequilibrium. J. Comput Biol, 16, 1141—1150.

Browning,S. and Browning,B. (2002) On reducing the statespace of hidden markov
models for the identity by descent process. Theor. Popul. Biol, 62, 1—8.

Cardon,L. and Abecasis,G (2003). Using haplotype blocks to map human complex trait
loci. Trends Genet, 19, 135—140.

Carlson,C. et al. (2004) Mapping complex disease loci in whole-genome association
studies. Nature, 429, 446—452.

Cottingham,R.W. et al. (1993) Faster sequential genetic linkage computations. Am. J.
Hum. Genet, 53, 252—263.

Dechter,R. (1998) Bucket elimination: a unifying framework for probabilistic inference.
Proceedings of the NATO Advanced Study Institute on Learning in graphical models,
Kluwer Academic Press, Erice, Italy, pp. 75—104.

 

i181

112 /§.IO'S[BU.ITIOIT).IOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv 110::

S.Bercovici et al.

 

Elston,R. and Stewart,J. ( 1971) A general model for the analysis of pedigree data. Hum.
Hered, 21, 523—542.

Eskin,E. (2008) Increasing power in association studies by using linkage disequilibrium
structure and molecular function as prior information. Genome Res., 18, 653—660.

Fishelson,M. and Geiger,D. (2002) Exact genetic linkage computations for general
pedigrees. Bioinformatics, 18(Suppl. 1), S189—S198.

Frazer,K. et al. (2007) A second generation human haplotype map of over 3.1 million
snps. Nature, 449, 851—861.

Geiger,D. et al. (2008) Speeding up HMM algorithms for genetic linkage analysis via
chain reductions of the state space. Bioinformatics, 25, i196—i203.

Ghahramani,Z. and J0rdan,M. (1997) Factorial hidden Markov models. Mach. Learn,
29, 245—273.

Greenspan,G and Geiger,D. (2004) High density linkage disequilibrium mapping using
models of haplotype block variation. Bioinformatics, 20(Suppl. 1), i137—i144.

Gudbjartsson,D. et al. (2005) Allegro version 2. Nat Genet, 37, 1015—1016.

Gudbj artsson,D. et al. (2000) Allegro, a new computer program for multipoint linkage
analysis. Nat Genet, 25, 12—13.

Halperin,E. and Stephan,D. (2009) Maximizing power in association studies. Nat
Biotecmol, 27, 255—256.

Halperin,E. et al. (2005) Tag SNP selection in genotype data for maximizing SNP
prediction accuracy. Bioinformatics, 21(Suppl. 1), i195—i203.

Han,B. et al. (2009) Rapid and accurate multiple testing correction and power estimation
for millions of correlated markers. PloS Genet, 5, 61000456.

Ingolfsdottir,A. and Gudbjartsson,D. (2005) Genetic linkage analysis, algorithms and
their implementation. Trans. Comput. Syst. Biol, 3737, 123—144.

Kruglyak,L. and Lander,E. (1998) Faster multipoint linkage analysis using Fourier
transform. J. Comput. Biol, 5, 1—7.
Kruglyak,L. et al. ( 1995) Rapid multipoint linkage analysis of recessive traits in nuclear
families including homozygosity mapping. Am. J. Hum. Genet, 56, 519—527.
Kruglyak,L. et al. (1996) Parametric and nonparametric linkage analysis: a uniﬁed
multipoint approach. Am. J. Hum. Genet, 58, 1347—1363.

Lander,E. and Green,P. ( 1987) Construction of multilocus genetic maps in humans.
Proc. Natl Acad. Sci, 84, 2363—2367.

Lange,K. (1997) Mathematical and Statistical Methods for Genetic Analysis. Springer-
Verlag, New York.

Lauritzen,S.L. (1996) Graphical Models. Oxford University Press, Oxford, UK.

Lauritzen,S.L. and Spiegelhalter,D.J. (1988) Local computations with probabilities
on graphical structures and their application to expert systems (with discussion).
J. Roy. Stat. Soc. Series B stat. Methodol, 50, 157—224.

Markianos,K. et al. (2001) Efﬁcient multipoint linkage analysis through reduction of
inheritance space. Am. J. Hum. Genet, 68, 963—977.

O’Connell,J. and Weeks,D. (1995) The VITESSE algorithm for rapid exact multilocus
linkage analysis via genotype set-recoding and fuzzy inheritance. Nat Genet, 11,
402—408.

Ott,J. (1999) Analysis of Human Genetic Linkage. Johns Hopkins University Press,
Baltimore, Maryland.

Pearl,J. (1988) Probabilistic Reasoning in Intelligent Systems. Morgan Kaufmann, San
Francisco, CA.

Peer,l. et al. (2006) Evaluating and improving power in whole genome association
studies using ﬁxed marker sets. Nat Genet, 38, 663—667.

Peer,l. et al. (2008) Estimation of the multiple testing burden for
genomewide association studies of nearly all common variants. Genet. Epidemiol,
32, 381—385.

Purcell,S. et al. (2007) Plink: a tool set for whole-genome association and population-
based linkage analyses. Am. J. Hum. Genet, 81, 559—575.

Rabiner,L.R. and Juang,B.H. (1986) An introduction to hidden Markov models. IEEE
Acoust. Speech sign. Process. Mag, pages 4—15.

Schwarz,G (1978) Estimating the dimension of a model. Ann. Stat, 6, 461—464.

Silberstein,M. et al. (2006) Online system for faster multipoint linkage analysis via
parallel execution on thousands of personal computers. Am. J. Hum. Genet, 78,
922—935.

S0bel,E. and Lange,K. (1996) Descent graphs in pedigree analysis: applications to
haplotyping, location scores, and marker sharing statistics. Am. J. Hum. Genet, 58,
1323—1337.

Thompson,E.A. (1994) Monte Carlo likelihood in genetic mapping. Stat. Set, 9,
355—366.

Wang,W. et al. (2005) Genome-wide association studies: theoretical and practical
concerns. Nat Rev. Genet, 6, 109—118.

 

i182

112 /§.IO'S[BU.ITIOIT).IOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pep1201umoq

9IOZ ‘Ig lsnﬁnv 110::

