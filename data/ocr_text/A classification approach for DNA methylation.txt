ORIGINAL PAPER

Vol. 30 no. 2 2014, pages 172—179
doi:10. 1093/bioinformatics/btt6 74

 

Genome analysis

Advance Access publication November 21, 2013

A classification approach for DNA methylation profiling with
bisulfite next-generation sequencing data

Longjie Cheng" and Yu Zhu

Department of Statistics, Purdue University, West Lafayette, IN 47906, USA

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: With the advent of high-throughput sequencing technol-
ogy, bisulfite—sequencing-based DNA methylation profiling methods
have emerged as the most promising approaches due to their
single-base resolution and genome-wide coverage. However, statis-
tical analysis methods for analyzing this type of methylation data are
not well developed. Although the most widely used proportion-based
estimation method is simple and intuitive, it is not statistically ad-
equate in dealing with the various sources of noise in bisulﬁte-sequen-
cing data. Furthermore, it is not biologically satisfactory in applications
that require binary methylation status calls.

Results: In this article, we use a mixture of binomial model to char-
acterize bisulfite-sequencing data, and based on the model, we pro-
pose to use a classification-based procedure, called the methylation
status calling (MSC) procedure, to make binary methylation status
calls. The MSC procedure is optimal in terms of maximizing the overall
correct allocation rate, and the false discovery rate (FDR) and false
non-discovery rate (FNDR) of MSC can be estimated. To control FDR
at any given level, we further develop an FDR-controlled MSC proced-
ure, which combines a local FDR-based adaptive procedure with the
MSC procedure. Both simulation study and real data application are
carried out to examine the performance of the proposed procedures. It
is shown in our simulation study that the estimates of FDR and FNDR
of the MSC procedure are appropriate. Simulation study also demon-
strates that the FDR-controlled MSC procedure is valid in controlling
FDR at a prespecified level and is more powerful than the individual
binomial testing procedure. In the real data application, the MSC pro-
cedure exhibits an estimated FDR of 0.1426 and an estimated FNDR
of 0.0067. The overall correct allocation rate is >0.97. These results
suggest the effectiveness of our proposed procedures.

Availability and implementation: The proposed procedures are im-
plemented in R and are available at http://www.stat.purdue.edu/~
cheng70/code.html.

Contact: cheng70@purdue.edu

Supplementary information: Supplementary data are is available at
Bioinformatics online.

Received on May 20, 2013; revised on October 17, 2013; accepted on
November 17, 2013

1 INTRODUCTION

DNA methylation is an epigenetic modiﬁcation to the genomic
DNAs by adding the methyl group to some C—5 positions of
DNA sequences. It plays a crucial role in a variety of biological

 

*To whom correspondence should be addressed.

processes including cell development, imprinting and X-chromo-
some inactivation. It is prevalent at CpG positions with 60—90%
of all Cst being methylated in mammals, whereas it is much
less frequent at non-CpG sites with only <3% of non-Cst
being found to be methylated. Unmethylated Cst tend to clus-
ter in small regions of DNA sequences called CpG islands, most
of which coincide with promoter regions of many genes. The
link between abnormal DNA methylation pattern and cancer
is 2—fold (Robertson, 2005). First, a global hypomethylation is
associated with genomic instability and is a common character-
istic of cancer cells. Second, hypermethylation of CpG islands
located at gene promoters results in suppression of gene expres-
sion and is conventionally observed in cancer cells. Therefore, it
is desirable to reveal both genome-wide and promoter-speciﬁc
DNA methylation patterns of a cell.

Various methods for genome-wide DNA methylation detection
have been developed in the past 20 years. They can be classiﬁed
into three categories, which are methylation-sensitive enzyme-
based methods, enrichment-based methods and bisulﬁte conver-
sion-based methods (Laird, 2010). In the past, array-based tech-
niques, such as microarray technology, were the leading platforms
to be combined with methods from all those three categories to
survey methylation status. Although the application of these plat-
forms enables comprehensive DNA methylation proﬁling at eco-
nomical cost, they can only interrogate C sites of given regions at
moderate resolution. Recently, next-generation sequencing
(NGS) technology has been incorporated into all three categories
of methods for genome-wide methylation proﬁling. Despite the
fact that NGS-equipped methods have relative advantages over
array-based methods, those methods from the ﬁrst two categories
are still subject to the same weaknesses they had when coupled
with array-based techniques. More speciﬁcally, methylation-sen-
sitive enzyme-based methods equipped with NGS technology
remain restricted to the recognition sites of the particular enzymes
used, and enrichment-based methods equipped with NGS tech-
nology do not overcome the disadvantage of moderate resolution.
On the other hand, bisulﬁte conversion-based methods coupled
with NGS technology, designated as bisulﬁte-sequencing meth-
ods, have emerged as the most promising methods, as they gen-
erate whole-genome DNA methylation proﬁles at single-base
resolution. Among all bisulﬁte-sequencing methods, Methle—
Seq and reduced representation bisulﬁte sequencing (RRBS) are
the two most popularly used methods.

In Methle—Seq, genomic DNAs are ﬁrst sonicated into smal-
ler fragments. After going through end-repair and adapter liga-
tion, these fragments are treated with bisulﬁte. The bisulﬁte
treatment converts unmethylated cytosines into uracils and

 

172 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 ﬁhO'smumo[pJOJXO'soi1BmJOJuioiw/2d11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Classiﬁcation approach for DNA methylation profiling

 

leaves methylated cytosines unchanged. Subsequent PCR ampli-
ﬁcation process further replaces uracils with thymines. These
PCR-ampliﬁed fragments are then subject to standard sequen-
cing technology to produce short sequencing reads, which are
mapped back to the reference genome. Thus the unmethylated
cytosines are distinguishable from methylated cytosines by exam-
ining sequencing reads (The workﬂow for Methle-Seq experi-
ment is given in Supplementary Material Section 1.) RRBS uses
the same mechanism as Methle-Seq. The major difference be-
tween RRBS and Methle-Seq occurs in the ﬁrst step, i.e. the
way genomic DNAs are fragmented. In RRBS, genomic DNAs
are digested with MspI, an enzyme which cuts all CCGG sites.
These two methods have their relative advantages and disadvan-
tages, which make them suitable for different research purposes.
By the way genomic DNAs are digested in RRBS, CpG regions
are substantially enriched in DNA fragments after size selection.
Thus RRBS is more preferable than Methle-Seq when the re-
search is targeting regions with high density of CpG sites, such as
CpG islands. On the other hand, because of its theoretical cap-
acity of capturing methylation information from each C position
in the whole genome, Methle-Seq has become the golden stand-
ard for genome-wide DNA methylation analysis. As reported in
Harris et al. (2010), when these two methods are applied to bio-
logical replicates of human embryonic stem cells, Methle-Seq
covers 95% of all Cst, whereas RRBS shows a genome-wide
CpG coverage of only 12%.

In the data generated by Methle-Seq or RRBS, ideally there
are only C reads or T reads for each covered C position of inter-
est, depending on the methylation status. In other words, if a C
position is methylated, then there should be only C reads at that
site in the data; whereas if a C position is unmethylated, then
there should be only T reads. However, owing to various sources
of noise, in the real data generated by these two methods, there
are both C reads and T reads for most of the target C sites. For
instance, the process of bisulﬁte conversion needs to be carried
out under speciﬁc experimental conditions (Smith et al., 2009).
Failure to meet any of those conditions would lead to incomplete
conversion, which further results in C reads at unmethylated C
positions. Moreover, as a typical and inevitable result of apply-
ing NGS technology, there will be sequencing errors in the data,
which means a small proportion of C reads will be miscalled to
be T reads and vice versa. Because there are both C reads and
T reads in the data, it is not straightforward to infer the true
methylation status. The aim is then to make methylation call for
each target C position based on the number of C reads and the
number of T reads it receives, which becomes an interesting stat-
istical problem.

In some studies concerning DNA methylation analysis, re-
searchers use the ratio of C count to the total number of reads
received at a site to quantify the methylation level at that site
(Bock et al., 2010; Gu et al., 2010; Harris et al., 2010). The total
number of reads received at a site is referred to as coverage or
sequencing depth. Although this quantiﬁcation approach has the
virtue of being simple and straightforward, it does not use proper
inference to deal with the noise in the data, and thus it is not
statistically satisfactory. In other studies, researchers aim to
make binary methylation calls for C positions of interest.
There exist a few such approaches in the literature. In Harris
et al. (2010), the proportion of C count at each CpG site was

calculated and binary methylation call was made for each site
with various choices of cutoff for the proportion. However, those
choices were not statistically justiﬁed. A more sophisticated
method was used in Lister et al. (2011), which applied a multiple
testing procedure to identify methylated cytosines. In the
Methle-Seq experiment conducted by Lister et al. (2011), an
unmethylated lambda DNA was spiked with the target genomic
DNAs before sonication and was used to estimate the error rate
at which a C count occurs at an unmethylated C position. As will
be shown in Section 3 and Supplementary Material Section 5, the
procedure used by Lister et al. (2011) is conservative in detecting
unmethylated cytosines due to the underestimation of error rate
and their choice of null hypothesis.

In this article, we propose to use a classiﬁcation procedure
based on a mixture of binomial model to make binary calls for
methylation status. As a by—product, the memberships generated
in this procedure can be used for quantifying the methylation
levels. The performance of the proposed procedure can be as-
sessed by correct allocation rates as well as false discovery rate
(FDR) and false non-discovery rate (FNDR). Motivated by the
concern of controlling FDR at any given level, we view our clas-
siﬁcation problem from a multiple testing perspective. Then a
component based on local false discovery rate (Lfdr) is incorpo-
rated into the proposed classiﬁcation procedure to provide an
approach that is capable of controlling FDR at any prespeciﬁed
level. On the basis of the Bayes rule, the proposed classiﬁcation
procedure is optimal in terms of maximizing the overall correct
allocation rate. Simulation results demonstrate that the proposed
classiﬁcation procedure outperforms the conventional individual
binomial testing procedure and is more accurate in detecting the
true methylation status. Simulation results also show the validity
of the proposed F DR—controlled procedure with various choices
of FDR level. Owing to the fact that most non-CpG sites are
unmethylated, when evaluating our method with real data, we
focus exclusively on CpG sites. However, it is worth pointing
out that our model can be applied to C positions of any context.
The real dataset we use is from Lister et al. (2011), which was
generated from a Methle-Seq experiment. However, our
method is not restricted to Methle-Seq data, and it can also
be applied to other bisulﬁte-sequencing data.

The rest of the article is organized as follows. Section 2 ﬁrst
gives the details of the mixture of binomial model and describes
the proposed classiﬁcation procedure, and then it presents sev-
eral performance assessment methods of the proposed proced-
ure. In the last part of Section 2, the FDR-controlled procedure
is introduced. Section 3 reports the simulation results as well as
the results from the real data application.

2 METHODS

2.1 Mixture of binomial model

As discussed in Section 1, Methle—Seq experiment can roughly cover
95% of all Cst. Those sites that do not receive any C read and T read
are referred to as uncovered sites and will be excluded from methylation
calling analysis. Suppose we consider M covered sites. These M sites can
be the collection of all covered sites from a speciﬁc DNA segment of
interest, a whole chromosome, or even the whole genome. For site i
among these M sites, let X ,~ denote the total number of reads including
both C and T reads and Y, denote the number of C reads alone. Note

 

173

112 ﬁhO'smumo[pJOJXO'soi1chOJuioiw/2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

L.Cheng and Y.Zhu

 

Y, 5 X ,. Let S, be the indicator of the unobserved methylation status of
site i, with S, = 0 indicating site i is methylated and S, = 1 indicating site i
is unmethylated. If there is no error in the experiment, then X, = Y, when
site i is methylated, and Y, = 0 when site i is unmethylated. In other
words, there are only C reads for methylated sites and no C read for
unmethylated sites. However, Methle—Seq experiments are subject to
both experimental errors and systematic errors. Thus, there are both C
reads and T reads for most sites, or equivalently, Y, < X, for most methy-
lated sites and Y, > 0 for most unmethylated sites.

There exist three main causes for experimental errors in Methle—Seq
experiments. First, incomplete conversion of unmethylated cytosine to
uracil during bisulﬁte treatment results in C reads at unmethylated sites.
In other words, the failure to convert unmethylated cytosine to uracil
causes Y, >0 for unmethylated sites. We assume this non-conversion
rate is e,,,, i.e. the probability that an unmethylated cytosine fails to convert
to thymine. Second, overtreatment with bisulﬁte can lead to conversion of
methylated cytosine to thymine (Laird, 2010). Suppose the miscoversion
rate, or equivalently, the probability that a methylated cytosine converts to
thymine is emc. Third, sequencing errors can potentially impact both
methylated sites and unmethylated sites. For methylated sites, cytosines
can be miscalled to be thymines and thus Y, < X ,, and for unmethylated
sites, bisulﬁte-converted thymines can be mistakenly read out as cytosines
and thus Y, > 0. Suppose the probability that a T read is miscalled to be a
C read is ex, and the probability that a C read is miscalled to be a T read is
ed. Experimental errors are unavoidable due to the random nature of
sequencing technology and have to be incorporated in the model. On
the other hand, systematic errors in bisulﬁte data can be identiﬁed and
thus eliminated by carefully conducted data processing procedures. For
Methle—Seq experiment, deamination of methylated cytosine to thymine
during cell development and those single nucleotide polymorphisms that a
cytosine in the reference genome varies to a thymine in the sample DNA
lead to systematic errors. Nevertheless, they can be detected by examining
the nucleotide on the opposite strand of the C sites and thus can be
eliminated from Methle—Seq data (Laird, 2010). When they are not
removed from the data, let em denote the systematic error rate. For a
more detailed review of potential sources of noise in bisulﬁte-sequencing
data, see Krueger et al. (2012).

Let I), stand for the overall error rate for obtaining C reads at
unmethylated sites caused by incomplete conversion, sequencing error
and systematic errors. Similarly, let 1 — [)0 denote the overall error rate
for obtaining T reads at methylated sites caused by misconversion,
sequencing error and systematic errors. It is clear that 1), depends on
e,,,, en, and esys, and [)0 depends on em, ec, and esys. The dependence of
po and p, on the various types of individual errors can be greatly simpli-
ﬁed if the following three assumptions are imposed. First, there are no
systematic errors in the data, i.e. em = 0. Second, the two types of
sequencing errors occur equally likely, which implies etc 2 ea. Third,
the sample is not overtreated with bisulﬁte, or equivalently, em, = 0.
Under these three assumptions, we postulate the relationship between
the overall error rates and individual ones to be 120 = 1 — etc 2 1 — ect
and p1 = e,,, + etc. Under the postulated relationship, if we can identify
the overall error rates 1 — p0 and 171, the individual error rates em, ec, and
e,,, can also be identiﬁed. When any of the three aforementioned assump-
tions fail to satisfy, further information is needed to identify the various
types of individual errors. Nevertheless, the overall error rates 1 — p0 and
p, can still be estimated and methylation calling can be made by the
procedure we will describe next. Owing to this reason, we shall use [)0
and p, in the rest of the article.

Based on the aforementioned discussion, we propose the following
Binomial models as the conditional distribution of the C count at site i
given the coverage X, and methylation status S,:

Y,|(X, = x, S, = 0) ~ Bin(x,po);

Yi|(Xi = X, S, =  N Bin(x,p1).

Here one important premise is that all the M sites of interest share the
same error rates 1 — p0 and 121. This assumption is commonly used in the
literature on methylation analysis (Lister et al., 2011 and Wu et al., 2011).

Furthermore, suppose the proportion of methylated sites among these
M sites is n, i.e. P(S, = 0) = Jr for any randomly selected site i. Then
conditional on the sequencing depth at one site, the corresponding C
count follows a mixture of two binomial distributions:

YiKXi = x) N NBin(x,po) + (1 - 70317106491)- (1)

Even though Methle—Seq data contain diverse types of errors, they
are still assumed to carry information regarding the underlying methyla-
tion status in the sense that most methylated sites are dominated by C
reads and most unmethylated sites are dominated by T reads. Therefore,
it is reasonable to assume that p, and p0 should satisfy p1<<po. This
assumption assures the identiﬁability of p, and p0 and guarantees the
validity of our procedure.

Suppose the coverages at the sites, i.e. X ,’s, are independent and iden-
tically distributed with the same probability mass function (pmf) ﬂx). For
convenience, denote the pmf of the conditional distribution of C count of
site i given X, = x deﬁned in (1) as g(y|x). For ﬁxed i, the pmf of the joint
distribution of (X ,, Y,), denoted as h(x, y), is given by h(x, y) = g(y|x)f(x).
Let ([5 = (170,121, 7r). Noticing that ﬁx) does not involve ([5, therefore we
only need to use g(y|x) for estimating ([5.

Let y = (yl, yz, ..., yM) be the observed C counts and
X = (x1, x2, ..., x M) the observed coverages. Then under the assumption
that y, is from a mixture of two binomial distributions given x,, the log-
likelihood function of ([5 can be written as follows.

M M
mmm=ZMwwn=Zmuwn—mw
i=1 i=1

where g,o and g,1 are the pmfs of Bin(x,,po) and Bin(x,,p1) for each i,
respectively. The maximum likelihood estimate (MLE) of ([5 can be ob-
tained by applying the well-established Expectation-maximization (EM)
algorithm. However, our goal here is beyond estimating ([5. What we want
to achieve is to classify each site i to be either methylated or unmethylated
on the basis of an adequate estimate of ([5. Recall that for each i, S, is an
indicator of the true methylation status of site iwith values equal to 0 or
1. Therefore, our goal is essentially to identify the value of S, for each i.

Let 0,0 and 0,1 denote the posterior probabilities that S, = 0 and
S, = 1, respectively, given X, y and ([5. The expressions of 0,0 and 0,1 are

ﬂgioO’i) ,
ﬂgioO’i) 1' (1 — 7T)gi1(yi) ’ (2)
01-1 :  : llyiaxi9¢) : 1 _0i0-

 

0,0 =  = Olyia-xi: 2

Here 0,0 and 0,1 indicate how likely site i is methylated (S, = 0) and
unmethylated (S, = 1), respectively, given the observed data and ([5.
Note that 0,,(r = 0, 1) will play a role in the EM algorithm for computing
the MLE of 45. In addition to facilitating the estimation of <15, 0,, also plays
a key role in the methylation status calling (MSC) procedure we will
develop later.

Then the EM algorithm for computing the MLE of ([5 can be developed
as follows. We start off with an initial estimate of <15 and then compute the
initial values of 0,, given the initial values of (15. After the initial step, (15 and
0,, are iteratively updated. Conditional on the current values of 0,,, we
update ([5 by

 

 

 

A M A M A
2 10%  ilyz 29,0
%=E,: E=Z. ;ﬁ=34- (a
Z ioxi 2011351

This new estimate of (15 is then substituted back into (2) to yield new
values of 0,,. These two steps are repeated until certain convergence cri-
terion is met. In our simulation study and real data application, the

 

174

112 ﬁhO'smumo[pJOJXO'soi1chOJuioiw/2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no 22

Classiﬁcation approach for DNA methylation profiling

 

convergence criterion is that the change of the log-likelihood function
between two consecutive steps is below some prespeciﬁed value.
A discussion of the convergence properties of EM algorithms can be
found in Wu (1983). The derivation of (3) is given in Supplementary
Material Section 3. Let ([3 be the MLE of ([5 obtained from the EM algo-
rithm and 9‘, the estimate of 9,, by plugging (,3 into (2). We shall call 9‘,
memberships hereafter.

2.2 Classiﬁcation-based MSC procedure

After the EM algorithm in the last subsection converges, we obtain the
estimates ([3 as well as the memberships 0,,. The memberships can be
further used to determine the methylation status of each site. We propose
to use the following rule to make MSC. For i = 1, 2, ..., M, site i is called
to be methylated if 0,0 > 0,1; otherwise, it is called to be unmethylated. We
shall refer to this classiﬁcation procedure as the MSC procedure. Based
on the Bayes rule, the MSC procedure is optimal in terms of maximizing
overall correct allocation rate (McLachlan and Peel, 2000).

As mentioned in Section 1, sometimes researchers are interested in
quantifying the methylation levels due to the heterogeneity of cell types
or contamination during cell preparation. When the experiment is con-
ducted on a mixture of different types of cells, it is valuable to directly use
the membership 0,0 to quantify the methylation level of each C position.
In this case, the interpretation of the overall error rates 1 — p0 and p, is
slightly different. More speciﬁcally, not only do they stand for the various
types of noises caused by the bisulﬁte-sequencing experiment, they also
represent the extent of cell type contamination. Because we are using a
Methle-Seq data of H9 human embryonic stem cells in our real data
application, we will focus on the binary MSC in our article.

2.3 Performance assessment of the MSC procedure

We use individual and overall correct allocation rates to assess the per-
formance of our proposed MSC procedure. Let Group 0 and Group 1
consist of all methylated sites and all unmethylated sites, respectively. Let
M0 and M, be the total number of methylated and unmethylated sites in
the sample, respectively. Let M ,j be the number of sites that are from
Group i and allocated to Group j by the MSC procedure, for i = 0, 1, and
j = 0, 1. Let the total number of sites that are classiﬁed to Group 0 be U
and let the total number of sites that are classiﬁed to Group 1 be V. The
four possible outcomes from the proposed MSC procedure are listed in
Table 1 with their corresponding frequencies.

The correct allocation rate for methylated sites (i.e. Group 0), denoted
as P0, is deﬁned as the proportion of sites that are methylated and cor-
rectly allocated to Group 0 among methylated sites; similarly, the correct
allocation rate for unmethylated sites (i.e. Group 1), denoted as P1, is
deﬁned as the proportion of sites that are unmethylated and correctly
allocated to Group 1 among unmethylated sites. The overall correct al-
location rate, denoted as P, is deﬁned as the proportion of correctly
classiﬁed sites for both groups. Given Table 1, the correct allocation

rates can be computed by P0 = all—‘30, P1 = M7111 and P =  The

Table 1. Possible outcomes from the MSC procedure and the FMSC
procedure

 

Classiﬁed as Total
unmethylated
(reject H0)

Group Classiﬁed as
methylated
(fails to reject H0)

 

Group 0 M00 M01 M0
Group 1 M10 M11 M1
Total U V M

 

quantities on the right side of these equations are unknown. Following
Basford and McLachlan (1985), they can be estimated by Mo = Mfr,
M1 = M(1— 7?), Moo = ém1(ém >ék1) and M11=ék11(ém S ékl),
where I(A) is an indicator of event A, such that I(A) equals 1 if A is
true and equals 0 otherwise. Thus P0, P1 and P can be estimated as
follows.

. 1 M . . .
P0 = M- Z {ekoI(6ko>6k1)};
k=1

 

A 1 M A A A
P1 = —. {allele 5 0a)};
M(1— 70k;1

M
13 = i {ékoKéko >ék1)+ éleékO S ék1)}-
M k=1

As stated in Basford and McLachlan (1985), P0 — P0, P1 — P1 and P — P
converge to 0 in probability when M goes to inﬁnity. Therefore, P, P0
and P1 can be used to assess the performance of the MSC procedure.
Basford and McLachlan (1985) also proposed two versions of bootstrap-
based methods to reduce the bias in estimating these correct allocation
rates with P, P0 and P1. However, we will not elaborate on the bias
correction methods here. The reason is that, based on the simulation
results reported in Supplementary Material Section S4, the bias of the
estimated correct allocation rates for our model is hardly noticeable; see
Supplementary Material Section S4 for more detail.

As mentioned in Section 1, Lister et al. (2011) used a multiple testing
procedure to make binary methylation status calls. In their experiment,
an unmethylated lambda DNA was spiked with the sample DNAs before
bisulﬁte treatment. Because lambda DNA is known to be unmethylated,
the proportion of resulting C reads at those C sites located within lambda
DNA can be used to estimate non-conversion rate plus the sequencing
error that T reads are miscalled to be C reads (p, in our case). We denote
the resulting estimate as 131”? . Then the following hypothesis was tested for
each C site in the whole genome simultaneously to detect methylated sites
with FDR level 0.01.

Hi0 1P 2131“ VS Hia 3P>131Lis-

Unlike the procedure used by Lister et al. (2011), our procedure does not
need to borrow information from the unmethylated lambda DNA, in-
stead, it can directly estimate 1), as well as [)0 from the data.

The classiﬁcation of two groups can also be viewed as a multiple
testing problem once one of the groups is speciﬁed as the null (Storey,
2003). For our proposed MSC procedure, if we designate one group (e.g.
methylated group) to be the null, then the FDR and FNDR can also be
deﬁned. Although the MSC procedure is optimal based on the Bayes rule,
it is not ascertained that it has control over FDR, which is the most
widely used criterion in multiple testing context. In the next subsection,
we will view our classiﬁcation approach from a multiple testing perspec-
tive. We will ﬁrst show how to estimate the resulting FDR and FNDR
for the MSC procedure. Then motivated by the concern that an FDR
level other than the estimated FDR may be needed, we will develop an
FDR-controlled MSC procedure.

2.4 MSC procedure with FDR control

We consider the following multiple testing problem after obtaining the
estimated parameter ([5 from Section 2.1:

Hi0 2p=ﬁo vs Hia 2p=131,
where i = 1,2, ..., M. Because 0,1 = 1 — 0,0 for any i, only 0,0 are used as
the test statistic and they are referred to as null memberships hereafter. It
is clear that the proposed classiﬁcation rule is equivalent to the testing
rule that rejects H,o if 0,0 5 0.5. The four possible outcomes from the

 

175

112 ﬁlm'spaumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

L.Cheng and Y.Zhu

 

MSC procedure given in Table 1 can be viewed as the four possible
outcomes from the multiple testing perspective. And the frequencies for
the outcomes from the aforementioned multiple testing rule are exactly
the same as those for the outcomes from the MSC procedure.

By the deﬁnitions of FDR and FNDR, we have FDR =  and

FNDR =  For the MSC procedure, U = #{0ko >0k1} and
V = #{0ko 5 01,1  Furthermore, based on the discussion in Section 2.3,
we have [12012 Mo — Moo 2 213:1 ékoKéko S ékl) and M10 2 M1—

M11 2 10k11(0k0>0k1). Therefore, FDR and FNDR for the MSC
procedure can be estimated as follows.

M A A A
A Z 0k01(9ko 5 91a)
k=1 ,

A M
FDR 2 —°1 = , (4)
V M A A
Z I(9k0 5 91a)
k=1
M A A A
A Z 9k11(9ko >9k1)
A M10 k=1
FNDR = _ = M—. (5)
Z I(9k0 >9k1)
k=1

Although FDR and FNDR can be estimated for the MSC procedure, this
procedure cannot control FDR at an arbitrary level. In practice, it can be
a concern, especially when the estimated FDR exceeds an acceptable
level. Therefore, it is desirable to incorporate a FDR-controlling compo-
nent into the MSC procedure. We shall investigate such a method next.

For the MSC procedure, the cutoff in the decision rule for rejecting the
null hypothesis is 0.5. One way to control FDR is to adjust this cutoff
according to the desirable FDR level. Suppose the prespeciﬁed FDR level
is a. Then the goal here is to ﬁnd a suitable cutoff c for null memberships
such that the decision rule that rejects H0 if

6,, 5 c, i=1,2,...,M. (6)
will have an FDR below a.

We follow an adaptive procedure developed by Sun and Cai (2007) to
achieve the goal. In their original paper, Sun and Cai aimed to ﬁnd a
multiple testing procedure that is more efﬁcient than the conventional
P-value-based procedures. They ﬁrst developed an Lfdr—based procedure
for marginal FDR control and showed it is optimal in the sense that it
controls marginal FDR at level a with the smallest marginal FNDR.
Then they proposed a data-dependent adaptive procedure based on esti-
mated Lfdr and proved that it asymptotically attains the performance
of the optimal procedure. It was also demonstrated with numerical
results that their adaptive procedure outperforms the conventional
P-value-based procedures when marginal FDR is controlled at the
same level. For our problem, recall that for site i, g,o and gi1 are the
pmfs of Bin(x,,po) and Bin(x,,p1), respectively. The Lfdr of site i is
given by

ﬂgioO’i)
ﬂgioO’i) 1' (1 — 7055100).

Therefore, the null membership 0,0 of site i is also an estimate of Lfdr.
With this estimated Lfdr of each site, the adaptive procedure proposed by
Sun and Cai (2007) can be incorporated into the MSC procedure.

Because Fdr(z) is the average of Lfdr(Z) for Z 5 z (Efron, 2007), the
FDR of the decision rule (6) can be estimated by

21:1 éiOKéiO S C),

Lfdr, = P(S, = olyi, xt,¢) =

 

 

FDR(c) = 2:1 [(610 S c) , (7)
M A A
FIVBMC) = 2,21 (1 — 910)](91'0 >6). (8)

21:1 I(éio > C)

When c = 0.5, which is the cutoff used by the MSC procedure, the re-
sulting FDR and FNDR can be estimated by FDR(0.5) =

211191010, 5 0.5) / 211110,, 5 0.5) and FJVBR(0.5) = 21:, (1 — 6,0)
I(0,o >0.5)/ 21:1 I(0,o >0.5). These two estimates are exactly the same

as F797? and FNDR given in (4) and (5) because 0,1 + 0,0 = 1. Therefore,
FDTKC) and FJVDRQ) given in (7) and (8) are extensions of FDR and

FNDR to the general decision rule (6). Simulation results given in
Supplementary Material Section 6 provide compelling evidence that the
estimators in (7) and (8) are accurate in estimating the true FDR and
FNDR.

Suppose the desirable FDR level is a. We apply the method developed
by Sun and Cai (2007) to choose the cutoff c so that the resulting clas-
siﬁcation procedure will have its FDR controlled at a. The procedure is
described as follows.

(1) Sort the null memberships in ascending order as 0,10, 0,20, . . . ,0,Mo.
(2) Find 1: maxU: 21,2, 91,0 /j 5 a}.
(3) Then let c = 0,0 and all H,jo with j 5 l are rejected.

(4) Site ijis called to be methylated if j 5 l; otherwise, it is called to be
unmethylated.

We shall refer to this procedure as the FDR-controlled MSC procedure
at level a, or in short, the FDR-controlled MSC (FMSC) procedure at
level a. Based on (7), the resulting FDR for the FMSC procedure can be
estimated by FDR = 21,21 0,ko/l.

As mentioned in Section 2.3, Lister et al. (2011) used H,o : p = 131 as
the null hypothesis, i.e. the null hypothesis assumes that site i is unmethy-
lated. In contrast, the null hypothesis we use here is H,o : p 2130, or
equivalently, it assumes that site i is methylated. Considering the fact
that methylation is more prevalent in the sense that >60% of all CpG
sites are expected to be methylated, it is more appropriate to assume the
site is methylated in the null hypothesis instead of the other way around.
Assuming the site is unmethylated in the null hypothesis leads to the
consequence that a signiﬁcantly higher proportion of the claimed
unmethylated sites are methylated. Therefore, in terms of detecting
unmethylated sites, our choice of null hypothesis produces more accurate
results than the choice by Lister et al. (2011). See Supplementary Material
Section S5 for more detail.

Sun and Cai (2007) showed that under several assumptions, the Lfdr—
based adaptive method asymptotically attains the performance of the
optimal method that controls marginal FDR at level a with the smallest
marginal FNDR. Despite the discreteness and heterogeneity of the tests
used for MSC, our simulation study in Section 3.1 shows the incorpor-
ation of this adaptive procedure into the MSC procedure leads to satis-
factory results. Therefore, we believe the FMSC procedure is adequate in
making methylation status calls when controlling FDR at a given level is
of interest. When the interest is to control FNDR at a given level, an
adaptive procedure similar to FMSC can be developed.

3 RESULTS
3.1 Simulation results

In this subsection, simulation results illustrating the behavior of
our proposed procedures are presented. To carry out simulation
study, we ﬁrst use Methle-Seq data of all CpG sites on
Chromosome 1 of H9 human embryonic stem cells from Lister

et al. (2011) to ﬁt a coverage distribution f (Supplementary
Material Section 2). Then we apply the mixture of binomial
model to the same data to obtain <13 2 (ﬁg, 131,7?)
(Supplementary Material Section 7). The total number of CpG

 

176

112 ﬁlm'spaumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

Classiﬁcation approach for DNA methylation profiling

 

sites in the simulation study is M: 1000. The general scheme of
our simulation study is described as follows. Step 1: draw a

random sample of M observations from f and use them as the
coverage for M CpG sites. Let the simulated coverage of these M
sites be Z = (21, 22, ..., 2M). For each of the M sites, generate its
methylation status independently from Bernoulli(ft). Simulate C
count for each site according to its methylation status and cover-
age. If the status for site i is methylated, the corresponding C
count is generated from Bin(z,,ﬁ0); otherwise, it is generated from
Bin(z,,ﬁ1). Denote the generated C counts as R = (r1, r2, ..., rM).
Step 2: apply the mixture of binomial model to R and Z, obtain

<13 2 (pl), ’71, ft), compute the memberships and make methylation
status call for each site using the MSC procedure. Step 3: for
i: 1,2, ...,M, compute the P-value, denoted as q,, for testing
H,0 2 p 2 ﬁg vs H,,, 2 p 2 p71 using exact binomial test, which

is, g,- = 2:0 (2i)(p~0)k(l — 130)Zi—k. After obtaining the

P-values, we apply the F DR-controlling procedure proposed
by Benjamini and Hochberg (1995) at level a = 0.1 to make
methylation status calls. We shall refer this procedure to as the
individual binomial testing (IBT) procedure. Step 4: use the
FMSC procedure described in Section 2.4 to control FDR at
three levels a = (0.1, 0.05, 0.01) separately. In the simulation
study, for each site, ﬁve methylation status calls are made
based on three different methods, which are the MSC procedure,
the IBT procedure at level 0.1 and the F MSC procedure with
three different choices of FDR level. By comparing these calls to
the true methylation status, performances of these three proced-
ures can be compared in terms of FDR and FNDR.

The comparison results based on n = 100 repeated simulations
are displayed in Figure 1. Several observations can be made from
the two plots in Figure 1. First, the median FDRs for MSC and
F MSC at level 0.1 is around 0.1, and the corresponding median
FNDRs are around 0.018 and 0.020, respectively. It shows that
the MSC procedure produces similar FDR and F NDR results as
the FMSC procedure at level 0.1. Second, the FDRs for the
F MSC procedures at all three levels are well controlled. Third,
the FNDR for the F MSC procedure at level 0.1 is notably smal-
ler than the FNDR for the IBT procedure at level 0.1. It is
caused by the fact that the IBT procedure at level 0.1 overcon-
trols FDR in the sense that the median FDR is only ~0.05. As a
result, the FNDR for IBT is compromised. It suggests that the

 

 

(a) o (b)  T

_._
I

3-5ér

: . 5 . .
. o- . .
.— . .
s_ _ _._ _._
o
I I
FMSC II 0.01

FDR

FNDR
mm um
I I
0 O

 

 

 

 

 

 

IB’Tum.‘ MSC FMSGItD1 FMSC (005 IBTmﬂJ MSC FMSC IIDI FMSC umﬂﬁ FMSCmﬂDI

Fig. 1. (a) The box plots display FDRs for IBT at level 0.1, the MSC
procedure and the FMSC procedure with FDR level 0.1, 0.05 and 0.01
from left to right. 0)) The box plots display FNDRs for these methods in
the same order

F MSC procedure is more powerful than the IBT procedure when
their F DRs are controlled at the same level.

In the simulation study, we also applied other F DR-control—
ling procedures to q,s. They include the q—value method (Storey
and Tibshirani, 2003) and procedures proposed by Storey (2002),
Gilbert (2005) and Heyse (2011). The results are insensitive to the
type of procedure used. Hence only the results from the F DR-
controlling procedure proposed by Benjamini and Hochberg
(1995) are shown here. Owing to the concern that the simulation
results rely on f and ([3, we also apply the proposed methods to a
real Methle-Seq data of H1 human embryonic stem cells from
Lister et al. (2009) and use the estimates from this dataset to
perform the simulation study. The relevant results are given in
Supplementary Material Section 11.

3.2 Real data application

The MSC and F MSC procedures are applied to a real Methle-
Seq data of H9 human embryonic stem cells from Lister et al.
(2011). Three FDR levels, 0.1, 0.05 and 0.01, are considered for
F MSC. We ﬁrst apply the procedures genome wide. The result-
ing estimate for q): (p0,p1,7t) is <13: (0.9102,0.1088,0.8920).
The MSC procedure is also applied to the same Methle-Seq
data chromosome wise. The results are given in Supplementary
Material Section 7. In the genome-wide evaluation with MSC,
42 987 496 of 48 795 269 CpG sites are called to be methylated.
For the chromosome-wise evaluation, a total of 43 097 321 CpG
sites are declared to be methylated. The difference is ~109 thou-
sands, which account for <0.3% of all covered CpG sites. The
detailed comparison results are given in Supplementary Material
Section 8. This high concordance suggests the consistency of the
MSC procedure.

Correct allocation rates, estimated FDR and estimated F NDR
for genome-wide analysis by MSC and FMSC at three FDR
levels are also calculated. The results are given in
Supplementary Table S5. For MSC, the correct allocation rates
for the overall population and the methylated group are 0.9771
and 0.9810, respectively, whereas the rate for the unmethylated
group is 0.9450. As for FDR and FNDR, the estimates for MSC
are 0.1426 and 0.0067, respectively. For F MSC, as the FDR level
decreases, the correct allocation rate for the overall population
decreases slightly and the rate for the methylated group increases
slightly, whereas the correct allocation rate for the unmethylated
group is inﬂuenced more dramatically. It decreases from 0.9450 to
0.6395 as the FDR level decreases from 0.1 to 0.01. For FMSC at
any of the three FDR levels, the resulting FDR is well controlled.
And as expected, the estimated F NDR increases as the FDR level
decreases. Based on these results, the performances of MSC and
F MSC are acceptable. As mentioned in Section 3.1, the MSC and
F MSC procedures are also applied to a real Methle-Seq data of
H1 human embryonic stem cells from Lister et al. (2009). The
results are given in Supplementary Material Sections S12—S15.

Next, the whole-genome results from the MSC procedure
are compared with those from the procedure used by
Lister et al. (2011). The comparison results are shown in
Table 2. Table 2 shows that these two procedures agree with
each other on the methylation status calls of 47 619954 CpG
sites, which account for >97% of all covered CpG sites. For
the sites that these two procedures make different methylation

 

177

112 /810's1eumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

L.Cheng and Y.Zhu

 

Table 2. Comparison of whole-genome results from the MSC procedure
and those from the procedure used by Lister et al. (2011) for all covered
CpG sites

 

 

 

Lister Our method
Methylated Unmethylated Total
sites sites
Methylated sites 42 987 456 1 1 75 275 44 162 731
Unmethylated sites 40 46 32 498 46 32 538
Total 429 87 496 58 07 773 48 795 269

 

status calls, they disagree in two directions. There are only 40
CpG sites that our MSC procedure declares to be methylated but
the procedure used by Lister et al. (2011) declares to be
unmethylated, and we refer to this type of disagreement as the
ﬁrst direction. There are roughly 1.17 million CpG sites that are
called to be unmethylated by the MSC procedure but called to be
methylated by the procedure used by Lister et al. (2011), and we
refer to this type of disagreement as the second direction.
Because there are only 40 CpG sites in the ﬁrst direction but
1.17 million sites in the second direction, we will focus on the
second direction in the subsequent analysis. A typical example in
the second direction is that for a site with coverage 60 and C
count 6, MSC declares it to be unmethylated, whereas the pro-
cedure used by Lister et al. (2011) declares it to be methylated.
Several other typical cases are shown in Supplementary Table S6.
As mentioned in the last paragraph, the null hypothesis for Lister
et al. (2011) is that the site is unmethylated; therefore, P-value

is computed as p — value = ZiZyi  )(ﬁlfisyca _ﬁ1Li.s)x,—k_

Because Lister et al. (2011) used an extremely small ﬁlms, which
is <0.01, the resulting P-value relies heavily on the C count in the
sense that it decays to zero exponentially with increasing C
count, regardless of coverage x, and ft. Therefore, the C count
threshold for declaring one site to be methylated based on the
multiple testing procedure used by Lister et al. (2011) is generally
low, even for sites with high coverage. However, for the MSC
procedure, the null membership primarily depends on the pro-
portion of C count at one site instead of C count alone. The
cutoff for the proportion is around a half for all sites, which is
intuitively more reasonable. Thus, the difference in the cutoff
values for these two procedures becomes more evident when
coverage increases. This difference is essentially caused by the
underestimation of p, in the procedure used by Lister et al.
(2011), and it demonstrates that the procedure used by Lister
et al. (2011) lacks power in terms of detecting unmethylated
sites, especially for sites with moderate to high coverage.
Therefore, we believe the MSC procedure makes more accurate
methylation status calls for this type of disagreement.

As a ﬁnal evaluation, the methylation calls for those sites that
MSC and the procedure used by Lister et al. (2011) disagree on are
compared with the results obtained from Inﬁnium Human
Methylation 450K BeadChip. The Human Methylation 450K
data used here are ﬁrst analyzed by Merling et al. (2013). For
those roughly 1.17 million sites that MSC and the procedure

Table 3. Third platform validation of the methylation calls for those sites
that MSC and the procedure used by Lister et al. (2011) disagree on

 

 

Procedure Number of sites Number of sites
that agree with the that disagree with the
third platform third platform

MSC 18 090 9547

Lister’s 9547 18 090

 

used by Lister et al. (2011) disagree on, 27 637 sites are covered
by Human Methylation 450K BeadChip. We use 0.5 as the cutoff
value to dichotomize the beta values in Human Methylation 450K
BeadChip data to make binary methylation calls, and compare the
calls to those obtained from MSC and the procedure used by
Lister et al. (2011). The comparison result is given in Table 3.
Table 3 shows that for nearly two-thirds of the 27 637 target
sites, the methylation calls made by MSC are consistent with the
calls made by Human Methylation 450K BeadChip. This suggests
the calls made by the MSC procedure are more likely to be correct
than those obtained by the procedure used by Lister et al. (2011).

4 CONCLUSION

In this article, we develop a classiﬁcation-based procedure and
an adaptive F DR-controlled procedure to make binary DNA
methylation status calls for bisulﬁte-based data. Based on our
simulation study and real data evaluation, we believe the pro-
posed classiﬁcation procedure is the procedure of choice if an
FDR level between 0.05 and 0.15 is satisfactory. Thus for analyz-
ing bisulﬁte-based data, it is recommended to apply the classiﬁ-
cation procedure and estimate the resulting FDR ﬁrst. If an
FDR level other than the estimated FDR is of concern, the
adaptive procedure at the desired FDR level can be used. Both
the classiﬁcation-based procedure and the adaptive FDR-
controlled procedure are implemented in R and are available
free online at http://www.stat.purdue.edu/~cheng70/code.html.

This work also points to several future research directions.
First, in this work, the proposed procedures are applied either
genome wide or chromosome wise. A more sophisticated choice
of regions needs to be further explored, as it is assumed that all
the CpG sites in the same region share the same error rates.
Second, for adjacent CpG sites, their methylation statuses can
be correlated. Hidden Markov models can be used to accommo-
date this type of correlation and may potentially lead to more
accurate methylation status calls (Choi et al., 2009; Qin et al.,
2010). Third, Bowtie was used to align the read sequences by
Lister et al. (2011). This may lead to a bias toward the reference
allele. How to correct this bias is worth exploring. Possible
solutions include the methods proposed by Wu et al. (2010)
and Yuan et al. (2013). Finally, the ultimate goal of methylation
analysis is to detect differentially methylated sites or regions.
How to accomplish this goal with our proposed model will be
investigated in the future.

Funding: NSF-DMS-1000443.

Conflict of Interest: none declared

 

178

112 /810's1eumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

Classiﬁcation approach for DNA methylation profiling

 

REFERENCES

Basford,K.E. and McLachlan,G.J. (1985) Estimation of allocation rates in a cluster
analysis context. J. Am. Stat. Assoc, 80, 286—293.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac-
tical and powerful approach to multiple testing. J. R. Stat. Soc. Series B Stat.
Methodol, 57, 289—300.

Bock,C. et al. (2010) Quantitative comparison of genome-wide DNA methylation
mapping technologies. Nat Biotechnol, 28, 1106—1114.

Choi,H. et al. (2009) Hierarchical Hidden Markov Model with application to joint
analysis of ChIP-chip and ChIP-seq data. Bioinformatics, 25, 1715—1721.

Efron,B. (2007) Size, power and false discovery rates. Ann. Stat, 35, 1351—1377.

Gilbert,P. (2005) A modiﬁed false discovery rate multiple-comparisons procedure
for discrete data, applied to human immunodeﬁciency virus genetics. Appl.
Stat, 54, 143—158.

Gu,H. et al. (2010) Genome-scale DNA methylation mapping of clinical samples at
single-nucleotide resolution. Nat Methods, 7, 133—136.

Harris,R.A. et al. (2010) Comparison of sequencing-based methods to proﬁle DNA
methylation and identiﬁcation of monoallelic epigenetic modiﬁcations. Nat.
Biotechnol, 28, 1097—1105.

Heyse,J. (2011) A false discovery rate procedure for categorical data. In: Recent
Advances in Biostatistics: False Discovery Rates, Survival Analysis, and Related
Topics. World Scientiﬁc Publishing Company, New Jersey, pp. 43—58.

Krueger,F. et al. (2012) DNA methylome analysis using short bisulﬁte sequencing
data. Nat. Methods, 9, 145—151.

Laird,P.W. (2010) Principles and challenges of genomewide DNA methylation ana-
lysis. Nat. Rev. Genet, 11, 191—203.

Lister,R. et al. (2009) Human DNA methylomes at base resolution show widespread
epigenomic differences. Nature, 462, 315—322.

Lister,R. et al. (2011) Hotspots of aberrant epigenomic reprogramming in human
induced pluripotent stem cells. Nature, 471, 68—73.

McLachlan,G.J. and Pee1,D. (2000) Finite Mixture Models. Wiley-Interscience, New
York.

Merling,R.K. et al. (2013) Transgene-free iPSCs generated from small volume per-
ipheral blood nonmobilized CD34+ cells. Blood, 121, 98—107.

Qin,Z.S. et al. (2010) HPeak: an HMM-based algorithm for deﬁning read-enriched
regions in ChIP-Seq data. BMC Bioinformatics, 11, 369.

Robertson,K.D. (2005) DNA methylation and human disease. Nat Rev. Genet, 6,
597—610.

Smith,Z.D. et al. (2009) High-throughput bisulﬁte sequencing in mammalian gen-
omes. Methods, 48, 226—232.

Storey,J.D. (2002) A direct approach to false discovery rates. J. R. Statist. Soc.
Series B Stat. Methodol, 64, 479—498.

Storey,J.D. (2003) The positive false discovery rate: a Bayesian interpretation and
the q-value. Ann. Stat, 31, 2013—2035.

Storey,J.D. and Tibshirani,R. (2003) Statistical signiﬁcance for genome-wide
studies. Proc. Natl Acad. Sci. USA, 100, 9440—9445.

Sun,W. and Cai,T.T. (2007) Oracle and adaptive compound decision rules for false
discovery rate control. J. Am. Stat. Assoc, 102, 901—912.

Wu,C.F.J. (1983) On the convergence properties of the EM algorithm. Ann. Stat,
11, 95—103.

Wu,G. et al. (2011) Statistical quantiﬁcation of methylation levels by next-
generation sequencing. PLoS One, 6, e21034.

Wu,T.D. et al. (2010) Fast and SNP-tolerant detection of complex variants and
splicing in short reads. Bioinformatics, 26, 873—881.

Yuan,S. et al. (2013) Read-mapping using personalized diploid reference genome for
RNA sequencing data reduced bias for detecting allele-speciﬁc expression. In:
BIBM W 2012 Workshop on Data-Mining of Next Generation Sequencing.
Philadelphia, PA.

 

179

112 /810's1eumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

