APPLICATIONS NOTE

Vol. 29 no. 1 2013, pages 143—145
doi: 10. 1093/bioinformatics/bt3646

 

Systems biology

Advance Access publication October 30, 2012

13CFLUX2—high-performance software suite for 13C-metabolic

flux analysis

Michael Weitzell’2, Katharina Noh1’2’*, Tolga Dalmanl’z, Sebastian Niedenfiihrl’z,

Birgit Stute1 ’2 and Wolfgang Wiechert1 ’2

1Institute of Bio— and Geosciences, lBG—1 : Biotechnology and 2JABA High Performance Computing, Forschungszentrum

Jillich GmbH, 52428 Jillich, Germany
Associate Editor: Martin Bishop

 

ABSTRACT

Summary: 13C-based metabolic flux analysis (13C-MFA) is the
state-of—the—art method to quantitatively determine in vivo metabolic
reaction rates in microorganisms. 13CFLUX2 contains all tools for
composing flexible computational 13C-MFA workflows to design
and evaluate carbon labeling experiments. A specially developed
XML language, FluxML, highly efficient data structures and simulation
algorithms achieve a maximum of performance and effectiveness.
Support of multicore CPUs, as well as compute clusters, enables
scalable investigations. 13CFLUX2 outperforms existing tools in
terms of universality, flexibility and built-in features. Therewith,
13CFLUX2 paves the way for next-generation high-resolution
13C-MFA applications on the large scale.

Availability and implementation: 13CFLUX2 is implemented in C++
(ISO/IEC 14882 standard) with Java and Python add-ons to run
under Linux/Unix. A demo version and binaries are available at
www.13cflux.net.

Contact: info@13cflux.net or k.noeh@fz—juelich.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 20, 2012; revised on October 4, 2012; accepted
on October 22, 2012

1 MOTIVATION

Metabolic ﬂux analysis with carbon labeling experiments
(BC-MFA) matured as the state-of-the—art technique to infer
directly immeasurable in vivo central metabolic reaction rates,
the ﬂuxome, by rigorous mathematical modeling (Sauer, 2006;
Wiechert, 2001). Progress in measurement techniques and
scaled-down experimentation has raised the experimental
throughput and coverage to which isotope-labeled tracers in
the metabolism are quantiﬁed (Fan and Lane, 2008). This has
encouraged the usage of 13C-MFA for cell-wide analyses of com-
plex cells such as eukaryotes, mammalian cells or fungi
(Zamboni, 2011). Such applications drastically increase the com-
putational burden and cannot be adequately treated with existing
all-purpose software.

Built on experiences made with its successful predecessor
13CFLUX, the high-performance software suite 13CFLUX2 is
designed to overcome computational and modeling limitations to

 

*To whom correspondence should be addressed.

increase the ﬂexibility and scope of 13C-MFA. Major unique
features of 13CFLUX2 are (i) tailor-made algorithms in combin-
ation with a novel code generation approach leading to highly
efﬁcient machine code, (ii) the XML-based document format
FluxML to specify ultimate universal models and all kind of
measurements, (iii) support of high-performance computing en-
vironments, and (iv) seamless setup of user-deﬁned processing
pipelines for serial evaluations. Moreover, the multi-platform
software Omix may be used for convenient modeling and Visu-
alization purposes (Droste et al., 2011). With respect to these
features, 13CFLUX2 exceeds the functionality of existing
13C-MFA software systems, namely, Metran and FiatFlux, as
well as the 13CFLUX clones OpenFlux, C13, FIA,
NMR2FLUX and inﬂux_s (CVijovic et al., 2010; Quek et al.,
2009; Sokol et al., 2012; Sriram et al., 2004; Srour et al., 2011;
Yoo et al., 2008; Zamboni et al., 2005).

2 METHODS AND IMPLEMENTATION

13CFLUX2 is implemented in C++ and consists of 130 000+
lines of strictly object-oriented, portable and validated ISO/
ANSI C++ code running on Linux/Unix platforms. The modu-
lar software suite comprises 21 modules, which make up the core
components of 13C-MFA research workﬂows (see Fig. 1).
13CFLUX2 is equipped with a comprehensive error handling
architecture, while built-in automatic debugging, logging, asser-
tions and stack traces do not affect the performance of the
production-level code. Several additional J ava/Perl/
Python-based programs ease parsing of analysis results or per-
forming post-processing tasks.

2.1 FluxML document format

For the speciﬁcation of metabolic and isotopic reaction net-
works, the XML—based document format FluxML has been de-
veloped. Semantically similar to SBML, F luxML contains
substantial extentions for representing 13C-MFA speciﬁc con-
cepts, i.e. the modeling of atom mappings (an example
F luxML ﬁle is available as Supplementary Material). Special
focus has been laid on the formulation of universal stoichiomet—
ric constraints, as well as ﬂux and labeling measurements that
both can be speciﬁed in a textual or Content-MathML notation
(www.w3.org/math). Besides build-in support for MS(/MS)- and
1H/13C-NMR-type measurements by convenient short notations,

 

© The Author 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits
unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [glO'SIBILInO[plOJXO'SODBIILIOJIIlOIQ/[i(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

M. Weitzel et al.

 

“o-MFA Womﬁow

  

M n -::;l E! l E: :. .l i l rl i :1 i2;-

,.~'"t, n a l '3; ti 1:: 

I '3 C'- - t it [.‘i  11 me I1:

Tasks FluxML syntax oheol-c ﬂux spaoe sampling simulation Monte Dario statistics data processing specify infomtation oniterion
nee-iron: proofreading ﬂux perturbation-i parameter estimation linearized statistics format conversion design optimal labeling mixture
simulator building {parallelized}

13EFLLIH fmllint seoanner setﬂuitesi'measu rements mobootstrap ooileotﬂtdate edsoanner

Programs bermhrnark ssampler {multiﬂwdsirn fwdsim -E Mdsimi‘osv adopt
ﬂhlEfml {multitp-arturb {multltﬂtﬂuxes fwdsimflt

EIWEPD” l'Idlt.’-toi::s'lir

Fig. 1. Overview scheme of typical steps within the 13C-MFA workﬂow and related 13CFLUX2 tools (for additional details see Supplementary

Material)

speciﬁcation of generic measurements is possible. More than
400 syntactical and semantical errors are detected and indicated
by expressive error/warning messages.

2.2 HPC algorithms for ultimate performance

Simulating the cells’ isotopic labeling state is the performance-
critical core procedure of 13C-MFA workﬂows. Cumomer- and
EMU-based approaches are numerically stable as they inhere a
(quasi-) linear model structure (Antoniewicz et al., 2007;
Wiechert et al., 1999). In 13CFLUX2, an interpreter-based net-
work generator assembles both, the Cumomer and EMU equa-
tions from the FluxML-based network speciﬁcation. New
algorithms for an on-the-ﬂy in-depth dependency analysis of
the emerging systems enable an optimal network reduction re-
sulting in systems of minimal size. Advanced graph decompos-
ition and path tracing algorithms exploit characteristic
connectivity properties of the Cumomer/EMU networks, like
immanent sparsity and isomorphism Weitzel et al., 2007). The
resulting reduced labeling systems are translated into a cascade
of symbolic equation systems, allowing for a highly efﬁcient nu-
merical solution, or alternatively, exact solutions based on arbi-
trary precision arithmetic. Optionally, the symbolic equation
systems can be compiled into efﬁcient machine code. Notably,
the generation of analytical solutions is possible for large-scale
network models with almost linear run time with respect to the
number of labeled species. Gradients for statistical analyses and
optimizers are derived with maximum numerical precision based
on symbolic differentiation. Sharing the same mathematical
structure with the original (reduced) systems, their numerical
solution, is likewise efﬁciently performed. Exact derivatives are
provided optionally.

Code performance is demonstrated with an Escherichia 0011'
network slightly adapted from Weitzel et al., 2007) containing
197 metabolites and 292 reactions. S—adenosyl-L-methionine
(15 carbons) contributes to almost 65% to the total 75549
labeled species. For a typical GC/MS-type measurement
setup, Cumomer-based simulation takes 10.8 ms, whereas for
the EMU variant, 2.73 ms are measured on a 2.93 GHz XEON
machine with 4 MB L2 cache running Linux 2.6. On average,
we found 13CFLUX2 to be 100 — 10 000 times faster compared
with 13CFLUX.

3 FLUX ANALYSIS WORKFLOW(S)
WITH 13CFLUX2

Figure 1 surveys the main tasks within 13C-MFA workﬂows. All
required ingredients including the metabolic and isotopic net-
work, the stoichiometric constraints, input species and the meas-
urement conﬁguration are formulated in the model’s F luxML
document. Subsequent to the proofreading step, the F luxML
document is validated (fmllint). A feasible basis of the stoichio-
metric null space is determined with regard to the modeler’s
selection. Constraint-compliant initial values for the free ﬂuxes
are generated by state-of-the-art samplers (sscanner, ssampler).
Sensitivity and identiﬁability analyses allow detecting non-
identiﬁable ﬂuxes to avoid ﬂawed parameter estimation artifacts
(fwdsim —S, multi—fwdsim). Calculation of ﬂux maps and
their statistical quality assessment (multi—fitﬂuxes, mcbootstrap)
relies on the powerful optimization libraries IPOPT (www.coin—
or.org/ipopt) and NAG C (www.nag.co.uk). On top of the work-
ﬂow, the experimental design programs edscanner and edopt de-
termine most informative input labeling species based on D—/A-/
E—/M-information measures (Atkinson and Donev, 1992).

All 13CFLUX2 modules support standardized stdin/stout op-
erations enabling seamless composition of tailor-made scalable
processing workﬂows, e.g. by using scripting languages or
web service wrappers. For data post-processing, simulation
results are exported to HDFS/CSV formats. Resulting ﬂux
maps can be readily visualized in the software Omix. To assist
rapid application development, the symbolic equation systems
can be exported as MathML documents (e. g. for computer alge-
bra systems) and as MATLABTM-based fully functional labeling
simulator.

4 CONCLUSIONS

13C-MFA reliably quantiﬁes in vivo activities of cellular carbon
redistribution. The next-generation software 13CFLUX2
addresses the challenges posed by upcoming large-scale and
high-throughput applications. Therewith, 13CFLUX2 shifts
paradigms of 13C-MFA toward semi-supervised large-scale
high-resolution applications. In combination with the graphical
tool Omix, 13CFLUX2 is a software suite for both computa-
tional scientists and researchers from life science.

 

144

112 [glO'SIBILInO[plOJXO'SODBIILIOJIItOIQ/[i(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

13CFLUX2

 

ACKNOWLEDGEMENTS

The authors thank all 13F LUX2 users and participants of the
Advanced Courses on 13C-based MFA for fruitful discussions
and Stephan Miebach for providing setmeasurements.

Funding: The German Research Foundation (PhD fellowship
of M.W., DFG grant WI 1705/12-1).

Conflict of Interest: none declared.

REFERENCES

Antoniewicz,M.R. et al. (2007) Elementary metabolite units (EMU): a novel frame-
work for modeling isotopic distributions. Metab. Eng., 9, 68—86.

Atkinson,A.C. and Donev,A.N. (1992) Optimum Experimental Designs. Oxford
University Press, Oxford.

CVijovic,M. et al. (2010) BioMet toolbox: genome-wide analysis of metabolism.
Nucleic Acids Res., 38, W144—Wl49.

Droste,P. et al. (2011) Visualizing multi-omics data in metabolic networks with the
software Omix: a case study. Biosystems, 105, 154—161.

Fan,T.W.M. and Lane,A.N. (2008) Structure-based proﬁling of metabolites and
isotopomers by NMR. Prog. Nucl. Magn. Reson. Spectrosc., 52, 69—117.

Quek,L.E. et al. (2009) OpenFLUX: efﬁcient modelling software for 13C-based
metabolic ﬂux analysis. Microb. Cell Fact., 8, 25.

Sauer,U. (2006) Metabolic networks in motion: 13C-based ﬂux analysis. Mol. Syst.
Biol., 2, 62.

Sokol,S. et al. (2012) inﬂux_s: increasing numerical stability and precision for meta-
bolic ﬂux analysis in isotope labelling experiments. Bioinformatics, 28, 687—693.

Sriram,G. et al. (2004) Quantiﬁcation of compartmented metabolic ﬂuxes in
developing soybean embryos by employing biosynthetically directed fractional
13C labeling, two-dimensional [13C,1H] nuclear magnetic resonance, and com-
prehensive isotopomer balancing. Plant Physiol, 136, 3043—3057.

Srour,O. et al. (2011) Fluxomers: a new approach for C-13 metabolic ﬂux analysis.
BMC Syst. Biol., 5, 129.

Yoo,H. et al. (2008) Quantifying reductive carboxylation ﬂux of glutamine to lipid
in a brown adipocyte cell line. J. Biol. Chem., 283, 20621—20627.

Wiechert,W. et al. (1999) Bidirectional reaction steps in metabolic networks: 111.
Explicit solution and analysis of isotopomer labeling systems. Biotechnol.
Bioeng., 66, 69—85.

Weitzel,M. et al. (2007) The topology of metabolic isotope labeling networks. BM C
Bioinformatics, 8, 315.

Wiechert,W. (2001) 13C metabolic ﬂux analysis. Metab. Eng., 3, 195—206.

Zamboni,N. (2011) 13C metabolic ﬂux analysis in complex systems. Curr. Opin.
Biotechnol., 22, 103—108.

Zamboni,N. et al. (2005) FiatFlux—a software for metabolic ﬂux analysis from
13C-glucose experiments. BM C Bioinformatics, 6, 209.

 

145

112 [3.10811211an[plOJXO'SODBIIIJOJIItOlQ/[idnq IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no 22

