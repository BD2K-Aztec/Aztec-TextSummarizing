APPLICA wows NOTE  aim.:zaiiigaziaiiiirizz

 

Genetics and population analysis

Advance Access publication July 13, 2012

GAPIT: genome association and prediction integrated tool

Alexander E. Lipkal, Feng Tian2, Qishan Wang3, Jason Peiffer4, Meng Li2’5,

Peter J. Bradburyl, Michael A. GoreG, Edward S. Buckler1 ’2’4 and Zhiwu Zhang2’*

1Computational Biologist with the United States Department of Agriculture — Agricultural Research Service (USDA—ARS),
Ithaca, NY 14853, USA, 2Institute for Genomic Diversity, Cornell University, Ithaca, NY 14853, USA, 8Department of
Animal Science, Shanghai Jiao Tong University, Shanghai 200240, China, 4Department of Plant Breeding and Genetics,
Cornell University, Ithaca, NY 14853, USA, 5Centre of Pear Engineering Technology Research, Nanjing Agricultural
University, Nanjing 210095, China and 6US Arid—Land Agricultural Research Center, United States Department of
Agriculture—Agricultural Research Service, Maricopa, AZ 85138, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Summary: Software programs that conduct genome-wide association
studies and genomic prediction and selection need to use methodol-
ogies that maximize statistical power, provide high prediction accur-
acy and run in a computationally efficient manner. We developed an R
package called Genome Association and Prediction Integrated Tool
(GAPIT) that implements advanced statistical methods including the
compressed mixed linear model (CMLM) and CMLM-based genomic
prediction and selection. The GAPIT package can handle large data-
sets in excess of 10 000 individuals and 1 million single-nucleotide
polymorphisms with minimal computational time, while providing
user-friendly access and concise tables and graphs to interpret
results.

Availability: http://www.maizegenetics.net/GAPIT.

Contact: zhiwu.zhang@cornell.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on April 11, 2012; revised on July 3, 2012; accepted on
July 8, 2012

1 INTRODUCTION

Advances in high-throughput single-nucleotide polymorphism
(SNP) genotyping are enabling powerful genome-wide associ-
ation studies (GWAS), thereby enhancing the ability to identify
causal mutations that underlie human diseases and agriculturally
important traits. The resulting SNPs are also valuable for gen-
omic prediction and selection (GS), which provides criteria for
disease risk management in humans and expedited selection in
animal and plant breeding (Heffner et al., 2009; Meuwissen et al.,
2001). Before the full potential of GWAS and GS are realized,
inﬂated false-positive rates, extensive computational require-
ments and suboptimal prediction accuracies need to be
addressed.

Newly developed GWAS statistical methods based on the
mixed linear model (MLM) hold great promise to overcome
these challenges. They are ﬂexible because they incorporate
ﬁxed and random effects. To address the spurious associ-
ations that arise from population structure, covariates from

 

*To whom correspondence should be addressed.

either STRUCTURE (Pritchard et al., 2000) or principal com-
ponents (PCs) can be included as ﬁxed effects. The cryptic rela-
tionships between individuals are accounted for through
a kinship matrix in the uniﬁed MLM (Yu et al., 2006).
The more computationally efﬁcient and powerful compressed
MLM (CMLM) (Zhang et al., 2010) uses a group kinship
matrix calculated from clustered individuals.

Because the typical number of genotypic data points is exceed-
ing hundreds of millions, solving MLMs using the traditional
restricted maximum likelihood approach is computationally
intensive. Therefore, the efﬁcient mixed model association
(EMMA) algorithm (Kang et al., 2008) was developed to
reduce this computational burden by reparameterizing the
MLM likelihood functions. EMMA eXpedited (EMMAX)
(Kang et al., 2010) and population parameters previously deter-
mined (P3D) (Zhang et al., 2010) were independently developed
to further reduce computing time by eliminating the need to
re-estimate variance components at each marker.

Most GS methods make predictions with the sum of the effects
from all available SNPs or Genomic Best Linear Unbiased
Prediction (gBLUP) based on a kinship matrix derived from
these SNPs. The former approach offers higher prediction
accuracies for simpler traits, while the latter approach is more
accurate for complex traits (Daetwyler et al., 2010). Our work
implements an improved gBLUP method that increases accur-
acy, especially for simple traits.

Most software packages were developed for a particular
GWAS or GS approach. For example, packages were written
exclusively for the EMMA and EMMAX algorithms. Other soft-
ware such as the Trait Analysis by aSSociation, Evolution and
Linkage (TASSEL) (Bradbury et al., 2007) and PLINK (Purcell
et al., 2007) make multiple GWAS approaches available in one
package. We continue these software development efforts
by creating Genome Association and Prediction Integrated
Tool (GAPIT), which integrates the most powerful, accurate
and computationally efﬁcient GWAS and GS methods into a
single R package.

2 IMPLEMENTATION

The GAPIT program accepts several combinations of genotypic
data, phenotypic data, externally obtained kinship matrices, and

 

Published by Oxford University Press 2012. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2397

112 /§JO'S{Bumo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq U101} prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

A.E.Lipka et al.

 

 

 

 

 

 

 

 

   

 

 

 

 

{B}, -' (his-
a-  El -
N . E _
Cll .
E -  g g -
D I x. g _
- D
2 . .3: ' _
4'10 -;'u:| -2I:| 4'0 ['1 1.: =4: 10::  ::I:- ran
 rlumrcl Erna}:
{E} m it!) m n.
H.449 3
. LE’R'SEI III
I Geneticvariame 3'51:
:I Residualwananm “3,515
- 0233
i'=-'.- '. .IIII'IJI I I.I.-‘I -_-'-.-ﬁ.:-.I'.-'. -j 5-4—1!
 ,.  _ cum
"",_.3' 1.1.13
._,-.,-, . , - - - man
.. .. ﬁlm”
. - -4 Han
 453:?
{E} .. __ _ _  -' am -5-14.a:
'56547
'ﬁ 1TEIT
Tau '5'de Retint IIJ Bau 3 DEV - -E 5-915
Era-:5 1 1 1 4.5mm 5.1mm 'i-‘m
33-2: 2 1 2 2mm 4.661943 g g g a E El E 3
am 3 :I 3 4mm: 5.14mi! .5 E E g z E T E
HE: A :I 4 z-HI-Ii‘ 4.151er 951;
“as :- :I :- -5.2at24 ELI-1.213?
v 
g .
i:
g /
n c -
F‘- -
EL .
‘I-I' - -. - -|. a I-.
E i" 1 ' 54::ch Illﬂl-IIDI
g} N r:_ '__ A. '
I 1 I... I. -_ I I I, g. i: . II -
I'  . I. "I- l I: II :I' i. I i : J-
. I. '5; :- '5":- I...‘ r..'l - 'lf-
'. " '4' I. I . a.
'— '.If 1'41": h“. It .. LI 7'1
' _ 1: 1- "“ -_ I '|- ' '
Ii‘h Itirﬂ-T a: I. ‘1"?
if ‘ ' ' '3
i' r {'11
'I 'l "I"! t.
{h} 1 2 3 4 5 a I" a 9 10
WP Emmmm 3.3mm I'm-1 rui nah: ﬁsmrr..-li:i1:ul.5lili' Flsqurrmnhjlli' FEIFI.adi.F.-.-alns
PEI-[13551.1 B 134313-111 l-iEE-ﬂﬁ Elli-1142424 2E»! WHERE! Eli-HiIﬁSSE '1'35'3‘91-3424
i'EIiDL‘IIBJ llﬂlﬁﬁi |].|}[|l2|-15-2'I‘25 015mm 2E»! DAME-FEE! MEI-59?? ﬂjilﬂﬂSE-S
PEEEISIEJ 3 19556653 EMS-BEBE! MILE-1545 255 lit-13153111.}! {LII-#22233 0341-3351533

Fig. 1. Gallery of GAPIT output. (a) Plot of the ﬁrst two principal com-
ponents (PCI and PC2). 0)) Plot of twice the negative log likelihood
(-2LL, smaller is better) at various number of groups. (c) Graph showing
the optimum cluster algorithm, method to calculate group kinship, group
number, -2LL, and the proportion of genetic variance (group heritability)
and residual variance. (d) Distribution of best linear unbiased predictors
(BLUPs) and their prediction error variance (PEV) (e) Genomic predic-
tion and selection output summary. The individual id (taxa), group,
Reﬂnf which indicates whether the individual is in the reference group
(1) or not (2), the group ID number, the BLUP and the PEV of the
BLUP. (f) Manhattan plot. —log P—values are plotted against physical
map position of SNPs. Chromosomes are alternatingly colored.
(g) Quantile—quantile (QQ) plot determines how GWAS results compare
to the expected results under the null hypothesis of no association.
(h) Output table of GWAS results. The SNP id, chromosome, bp pos-
ition, P-value, minor allele frequency (maf), sample size (nobs), R2 of the
model without the SNP, R2 of the model with the SNP and adjusted
P-value following a false discovery rate-controlling procedure
(Benjamini and Hochberg, 1995).

covariates such as population structure and age. Multiple traits
can be stored in a single phenotypic dataset, which allows se-
quential analysis of each trait. The genotypic data may be stored
in HapMap or numerical formats. If genotypic data are absent,

then phenotypic data and a kinship matrix are required to
perform GS.

By default, GAPIT uses the CMLM approach with P3D/
EMMAX for GWAS. GS is performed using the same optimiza-
tion settings as GWAS (Supplementary Sections 1 and II and
Fig. S1). There is an option to perform GS only by specifying
‘SNP.test=FALSE’. Seven algorithms are available to cluster
individuals into groups. GAPIT can also perform the MLM
and GLM approaches by adjusting the ‘group.to’ and ‘group.—
from’ input parameters. When the kinship matrix is not pro-
vided, it will be calculated with the methods of VanRaden
(VanRaden, 2008), Loiselle (Loiselle et al., 1995) or EMMA
(Kang et al., 2008). GAPIT can also perform principal compo-
nent analysis of the genotypic data to control for population
structure (Zhao et al., 2007).

GAPIT has several strategies for analyzing large SNP datasets.
One is to import genotypic data stored in multiple smaller ﬁles.
If these ﬁles still exceed memory limits, the ‘ﬁle.fragment’ par-
ameter can be used to sequentially load fragments within each
ﬁle. If there is not enough memory to use all SNPs to calculate
the kinship matrix and PCs, then the ‘SNP.fraction’ input par-
ameter will select a random sample of the SNPs for these calcu-
lations (Yu et al., 2009).

The results from GAPIT are accessed as both objects within
the R workspace and as external ﬁles. The R objects, which
include GWAS and GS results, may be used for follow-up
analyses in R. The external ﬁles include publication-ready sum-
maries of GWAS and GS results. GWAS results are summarized
by Manhattan plots, quantile—quantile plots and a table.
Similarly, GS results are presented in a heat map and a table.
Graphs of the heritability estimates and the likelihood func-
tion at various compression levels are included. A subset of
the graphs and tables produced by GAPIT are presented in
Figure l.

3 PERFORMANCE TESTS

EMMA and TASSEL were compared with GAPIT. These two
packages were selected because both use the EMMA algorithm,
while TASSEL also implements the CMLM approach with P3D.
When the same approach was used, identical results were ob-
tained (Supplementary Figs S2 and S3). The computing time of
all three packages increases linearly with the number of SNPs
(Supplementary Fig. S4). However, the average computing time
per SNP in GAPIT is 7-fold and 180-fold faster than TASSEL
and EMMA, respectively (Supplementary Fig. S4). It took 69.5 h
to analyze a dataset with 11 000 individuals and 500 000 SNPs,
which extrapolates to 7195 SNPs/CPU hours or less than 6 days
to analyze 1 million SNPs.

4 CONCLUSIONS

This R package uses state-of—the-art mixed model methods to
conduct GWAS and GS. GAPIT analyzes large datasets with
minimum computational time and produces comprehensive re-
sults including R objects and high-quality graphs.

 

2398

112 /810'S[12umo [p.IOJXO'SOTlBIIlJOJUTOTQ/ﬂdllq U101} prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

Genome association and prediction integrated tool

 

ACKNOWLEDGEMENTS

J .C. Glaubitz is acknowledged for assistance with data analysis
in UNIX.

Funding: National Science Foundation (grants DBI-0321467,
DB10820619, and DBI-0922493); United States Department of
Agriculture - Agricultural Research Service.

Conﬂict of Interest: none declared.

REFERENCES

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac-
tical and powerful approach to mutliple testing. J. Roy Statis. Soc. B, 57,
289—300.

Bradbury,P.J. et al. (2007) TASSEL: software for association mapping of complex
traits in diverse samples. Bioinformatics, 23, 2633—2635.

Daetwyler,H.D. et al. (2010) The impact of genetic architecture on genome-wide
evaluation methods. Genetics, 185, 1021—1031.

Heffner,E.L. et al. (2009) Genomic selection for crop improvement. Crop Sci, 49,
1—12.

Kang,H.M. et al. (2010) Variance component model to account for sample structure
in genome-wide association studies. Nat. Genet., 42, 348—354.

Kang,H.M. et al. (2008) Efﬁcient control of population structure in model organism
association mapping. Genetics, 178, 1709—1723.

Loiselle,B.A. et al. (1995) Spatial genetic-structure of a tropical understory shrub,
Psychotria Officinalis (Rubiaceae). Am. J. Bot, 82, 1420—1425.

Meuwissen,T.H. et al. (2001) Prediction of total genetic value using genome-wide
dense marker maps. Genetics, 157, 1819—1829.

Pritchard,J.K. et al. (2000) Association mapping in structured populations. Am. J.
Hum. Genet., 67, 170—181.

Purcell,S. et al. (2007) PLINK: a tool set for whole-genome association and
population-based linkage analyses. Am. J. Hum. Genet., 81, 559—575.

VanRaden,P.M. (2008) Efﬁcient methods to compute genomic predictions. J. Dairy
Sci, 91, 4414—4423.

Yu,J. et al. (2009) Simulation appraisal of the adequacy of number of background
markers for relationship estimation in association mapping. Plant Genome, 2,
63—77.

Yu,J.M. et al. (2006) A uniﬁed mixed-model method for association mapping that
accounts for multiple levels of relatedness. Nat. Genet., 38, 203—208.

Zhang,Z. et al. (2010) Mixed linear model approach adapted for genome-wide
association studies. Nat. Genet., 42, 355—360.

Zhao,K. et al. (2007) An Arabidopsis example of association mapping in structured
samples. PLoS Genet., 3, e4.

 

2399

112 /8JO'S{numo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] U101} prBOIIIAAOG

910Z ‘091sn8nv uo ::

