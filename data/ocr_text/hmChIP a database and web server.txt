Vol. 27 no. 10 2011, pages 1447-1448
APP S N O  doi: 10. 1093/bioinformatics/btr156

 

Databases and ontologies

Advance Access publication March 30, 2011

thhlP: a database and web server for exploring publicly
available human and mouse ChlP-seq and ChlP-chip data

Li Chen, George Wu and Hongkai Ji*

Department of Biosfafisfics, The Johns Hopkins University Bloomberg School of Public Health, 615 North Wolfe

Street, Baltimore, MD 21205, USA

Associate Editor: Joaquin Dopazo

 

ABSTRACT

Summary: thhlP is a database of genome-wide chromatin
immunoprecipitation (ChIP) data in human and mouse. Currently,
the database contains 2016 samples from 492 ChlP-seq and
ChlP-chip experiments, representing a total of 170 proteins and
11 069 914 protein—DNA interactions. A web server provides interface
for database query. Protein—DNA binding intensities can be retrieved
from individual samples for user-provided genomic regions. The
retrieved intensities can be used to cluster samples and genomic
regions to facilitate exploration of combinatorial patterns, cell-
type dependencies, and cross-sample variability of protein—DNA
interactions.

Availability: http://jilab.biostat.jhsph.edu/database/cgi-bin/thhlP
.pl

Contact: hji@jhsph.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on October 27, 2010; revised on March 3, 2011; accepted
on March 16, 2011

1 INTRODUCTION

Chromatin immunoprecipitation (ChIP) followed by genome tiling
array hybridization (ChIP—chip) (Ren et al., 2000) and ChIP coupled
with massively parallel sequencing (ChIP—seq) (Johnson et al.,
2007) are powerful technologies to study genome—wide protein—
DNA interactions. Large amounts of ChIP—chip and ChIP—seq data
have been made publicly available in the past few years. These
data contain rich information which can be synthesized to make
new discoveries or used to boost analysis of new datasets. For
example, in order to study the role of a transcription factor (TF)
Soxl7 in mouse embryonic stem cell (mESC) differentiation, Niakan
et al. (2010) determined Soxl7 binding sites in blastocyst—derived
extraembryonic stem cells (XEN) using ChIP—chip. A question of
interest is what other TFs can bind to the same cis—regulatory
elements and potentially interact with Soxl7. While it is difﬁcult for
a single lab to experimentally test binding of hundreds of mouse TFs
to Soxl7 binding sites, one can potentially answer the question by
analyzing ChIP data in public domains representing diverse proteins
and cell types. As another example, c—Myc has been extensively
studied by many labs. By analyzing c—Myc binding data from
different cellular contexts collected by different labs, one might be

 

*To whom correspondence should be addressed.

able to identify different classes of c—Myc binding sites based on
their cell—type dependencies.

A prerequisite for utilizing the public ChIP data is the ability to
freely query, retrieve, normalize and compare binding intensities
from arbitrary samples and genomic regions. Currently, this is a
daunting task for most researchers working on human and mouse.
Existing raw data repositories such as The NCBI Gene Expression
Omnibus (GEO) (Barrett et al., 2007) and Sequence Read Archive
(SRA) (Wheeler et al., 2008) do not provide tools for interactively
exploring the ChIP data. The UCSC genome browser (Kent at al.,
2002) provides functionalities for visualizing the data, but its ChIP
data collection is limited. Although the browser is good at exploring
one genomic region at a time, it is incapable of conveniently
retrieving, normalizing and comparing data from many genomic
regions. The recently developed ChIP—X database (Lachmann et al.,
2010) has collected TF target gene lists from published ChIP studies,
however it does not provide tools for retrieving and comparing
binding intensities across samples. thhIP is developed in this
context to meet the pressing need for exploring protein—DNA
binding intensities in publicly available ChIP data.

2 DATA COLLECTION, QUERY AND RETRIEVAL

At the time of writing, thhIP contains 2016 ChIP—chip and ChlP—
seq samples collected from GEO, SRA, and the ENCODE at UCSC
(Rosenbloom et al., 2010). The samples are grouped into 492
experiments which were analyzed using TileProbe (Judy and Ji,
2009) and CisGenome (Ji et al., 2008) to generate one peak list per
experiment. Each peak list contains DNA—binding locations of one
protein in one speciﬁc cellular context. In total, the database contains
11069 914 protein—DNA interactions for 170 proteins in a variety
of cell types (Supplementary Tables S1 and S2). For each individual
sample, a genome—wide protein—DNA binding intensity proﬁle was
generated and stored in the database. These proﬁles enable one to
examine variability across samples, such as variability of biological
or technical replicates. Details of data collection and processing can
be found in Methods 1—4 in Supplementary Material.

Data in thhIP can be queried and retrieved through a web
server (Fig. la). Users can search for available experiments by
providing protein names, cell types and/or a list of genomic regions
in BED or COD ﬁle format (see examples). If a genomic region
list is provided, the returned experiments will be rank ordered
based on the degree of overlap between the query region list and
the peak list of each experiment (Method 5 in Supplementary
Material). For each experiment, the query result will list samples
in the experiment and provide download links for the associated

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1447

112 /§.IO'SIBUJHOTPJOJXO'SOTlBIHJOJUTOTQ/ﬁdnq U101} pepeoprmoq

9IOZ ‘091sn8nv uo ::

L.Chen et al.

 

[51} rman

“1}
. EHIK'II IIIJII dlr IIII.II|-:MTIC 'HICII‘II'I'I'! 1III-Illiil i

l'h‘r “Ii-3?” IILIHIZIII? I ES'I'F'JIE l ‘IPZIi'l‘I

.: .IIIJI' EII‘SJIIRJI 1951265]? I J'BI'JIEIié 3209135

' :IIK 'I-i IIIIIIKH 'I'riII'I-ill I '.II'-.'-'IrI1 I II'I.'I|I|

l'h-‘E'I I'IIillIlia'II' IEIIIIIIIFISI I .: PUEIIIZ' £"|I'-!I'IB

5 .I-1.I luﬁBEuE-é- dub-EH35”: I iujL-S'i-‘I i:ﬂ1!L3

II:II1 I"I-.'.|”-'I f'lil 1'II'.:'I.I'.:'1I I I '1:LIII:I.I .I' 'IIICL'HII

' 'h'l-' THEI‘EIZIl'I -'Ii':.i'l.|.=IL" I E H-H'I'u' ..'!I.|IiI.'I'°I

B :n] LS-I'IIBIIEl-i' 15:55:93.3? I .‘I'III‘ZIEIIIE I 2231;") +
I- I

 

Fig. 1. Illustration of thhIP. (a) The web interface for data query and
retrieval. (b) Binding intensities are retrieved and returned as text ﬁles.
(c) A hierarchical clustering heat map will be returned as well. Three
detailed examples and colored screen shots in larger size are provided in
Supplementary Figures Sl—S3.

peak list, sample binding intensity proﬁles and a log fold—change
proﬁle of the experiment generated by comparing ChIP and control
binding intensities. For each sample, several quality measures are
provided, including percentage of the genome covered by peaks,
average signal—to—noise ratio and total read count in the sample if
the sample is ChIP—seq (Method 3 in Supplementary Material).

From the query results, users can select samples of interest,
provide a list of genomic regions and provide an email address.
By clicking a ‘Run’ button, binding intensities from the selected
samples will be retrieved for the genomic regions provided, saved
into a text ﬁle and returned to users through email (Fig. lb; Method
6 in Supplementary Material). If no email address is provided, the
results will be returned through a web page. To facilitate cross—
sample comparisons, intensity data from different samples will be
normalized, and the normalized data will be returned in a separate
text ﬁle. A heat map showing the hierarchical clustering of genomic
regions and samples based on the normalized intensities will be
returned as well (Fig. lc; Methods 6 and 7 in Supplementary
Material). For each genomic region and each peak list with samples
selected, thhIP will return a binary value to indicate the region’s
binding status in that peak list and a number measuring the log fold—
change between ChIP and control binding intensities in the region
(Method 6 in Supplementary Material). Data retrieved from thhIP
can be fed into other software tools to carry out further analyses,
such as customized clustering using dChip (Li and Wong, 2003), or
correlating binding intensities with gene expression data (Ouyang
et al., 2009).

3 EXAMPLES

Sox17 is involved in the differentiation of mESC. Oct4, Sox2
and Nanog are master regulators to maintain mESC’s pluripotency
and self—renewal ability. To explore whether Sox17 can interact
with these TFs, we queried thhIP and selected mouse ChIP—chip
samples for Sox17 in XEN cells, samples for Oct4, Sox2 and Nanog
in mESC and the corresponding control samples (Supplementary

Figure S1). We extracted binding intensities from these samples
in Sox17 binding regions. Interestingly, the clustering heat map
shows that a signiﬁcant subset of Sox17 binding regions was also
bound by Sox2 and Nanog. Next, we queried both ChIP—chip and
ChIP—seq data in thhIP using Sox17 binding regions as input.
Through this more unbiased search, we found a number of TFs
whose binding sites overlapped with Sox17 binding sites at levels
above random expectation, with Sox2 and Nanog ranked the highest
(Supplementary Figure S2). Our result suggests that Sox17 may
promote differentiation partly by competing with Sox2 and Nanog to
bind to the same DNA—binding sites. This analysis has led to follow—
up experiments which veriﬁed the competition between Sox17 and
Nanog in mESC differentiation (Niakan et al., 2010).

In another example, we studied c—Myc binding in multiple cancer
cell lines using public ChIP—seq data from different labs. The results
revealed different classes of c—Myc binding sites based on their cell
type dependencies, and clustered samples based on their cell types
rather than lab origins (Supplementary Figure S3).

4 DISCUSSION

thhIP removes a major hurdle for scientists to retrieve and utilize
ChIP data in public domains. In future, it will be gradually enhanced
to include more data and functionalities (e.g. tools for exploring
spatial binding patterns across multiple ChIP samples). Our ultimate
goal is to turn it into a toolbox for biologists to efﬁciently integrate
publicly available ChIP—chip and ChIP—seq data to study gene
regulation and make novel discoveries.

Funding: National Institute of Health (R01HG005220).

Conﬂict of Interest: none declared.

REFERENCES

Barrett,T. et al. (2007) NCBI GEO: mining tens of millions of expression proﬁles —
database and tools update. Nucleic Acids Res., 35, D760—D765.

Ji,H. et al. (2008) An integrated software system for analyzing ChIP-chip and ChIP-seq
data. Nat. Biotechnol, 26, 1293—1300.

J ohnson,D.S. et al. (2007) Genome-wide mapping of in vivo protein-DN A interactions.
Science, 316, 1497—1502.

J udy,J .T. and J i,H. (2009) TileProbe: modeling tiling array probe effects using publicly
available data. Bioinformatics, 25, 2369—2375.

Kent,W.J. et al. (2002) The human genome browser at UCSC. Genome Res., 12,
996—1006.

Lachmann,A. et al. (2010) ChEA: transcription factor regulation inferred from
integrating genome-wide ChIP-X experiments. Bioinformatics, 26, 2438—2444.
Li,C. and W0ng,W.H. (2003) DNA-Chip Analyzer (dChip). In Parmigiani,G. et al. (eds)
The analysis of gene expression data: methods and software. Springer, New York,

pp. 120—141.

N iakan,K.K. et al. (2010) S0x17 promotes differentiation in mouse embryonic stem cells
by directly regulating extraembryonic gene expression and indirectly antagonizing
self-renewal. Genes Dev., 24, 312—326.

Ouyang,Z. et al. (2009) ChIP-Seq of transcription factors predicts absolute and
differential gene expression in embryonic stem cells. Proc. Natl Acad. Sci. USA,
106, 21521—21526.

Ren,B. et al. (2000) Genome-wide location and function of DNA binding proteins.
Science, 290, 2306—2309.

R0senbloom,K.R. et al. (2010) ENCODE whole-genome data in the UCSC Genome
Browser. Nucleic Acids Res., 38, D620—D625.

Wheeler,D.L. et al. (2008) Database resources of the National Center for Biotechnology
Information. Nucleic Acids Res., 36, D13—D21.

 

1448

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; pepraoIUAAoq

9IOZ ‘09 lsnﬁnv uo ::

