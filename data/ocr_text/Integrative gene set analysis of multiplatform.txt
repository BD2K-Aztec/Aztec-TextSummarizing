ORIGINAL PAPER

Vol. 30 no. 11 2014, pages 1501—1507
doi: 10. 1 093/bioinformatics/btu060

 

Genome analysis

Advance Access publication January 30, 2014

Integrative gene set analysis of multi-platform data with sample

heterogeneity
Jun Hu1’2’* and Jung-Ying Tzeng

1,3,4,*

1Bioinformatics Research Center, North Carolina State University, Ricks Hall, 1 Lampe Dr., Raleigh, NC 27607, USA,
2Division of Bioinformatics, Omicsoft Inc., 200 Cascade Pointe Lane, Suite 101, Cary, NC 27513, USA, 3Department of
Statistics, North Carolina State University, Ricks Hall, 1 Lampe Dr., Raleigh, NC 27607, USA and 4Department of
Statistics, National Cheng—Kung University, No.1, University Road, Tainan 701, Taiwan

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: Gene set analysis is a popular method for large-scale
genomic studies. Because genes that have common biological fea-
tures are analyzed jointly, gene set analysis often achieves better
power and generates more biologically informative results. With the
advancement of technologies, genomic studies with multi-platform
data have become increasingly common. Several strategies have
been proposed that integrate genomic data from multiple platforms
to perform gene set analysis. To evaluate the performances of existing
integrative gene set methods under various scenarios, we conduct a
comparative simulation analysis based on The Cancer Genome Atlas
breast cancer dataset.

Results: We find that existing methods for gene set analysis are less
effective when sample heterogeneity exists. To address this issue, we
develop three methods for multi-platform genomic data with hetero-
geneity: two non-parametric methods, multi-platform Mann—Whitney
statistics and multi-platform outlier robust T-statistics, and a paramet-
ric method, multi-platform likelihood ratio statistics. Using simulations,
we show that the proposed multi-platform Mann—Whitney statistics
method has higher power for heterogeneous samples and comparable
performance for homogeneous samples when compared with the
existing methods. Our real data applications to two datasets of The
Cancer Genome Atlas also suggest that the proposed methods are
able to identify novel pathways that are missed by other strategies.
Availability and implementation: http://www4.stat.ncsu.edu/
~jytzeng/Software/Multiplatform_gene_set_analysis/

Contact: john.hu@omicsoft.com, jhu7@ncsu.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 25, 2013; revised on January 16, 2014;
accepted on January 27, 2014

1 INTRODUCTION

High-throughput genome-wide assays, such as microarray and
next-generation sequencing, have become more reliable and af-
fordable. With the ever-increasing throughput and the scale of
omics studies, more and more projects choose to measure mul-
tiple genomic features (e. g. gene expression, methylation, gene
mutation, copy number, promoter binding and protein expres-
sion) on the same samples. Evaluating multiple genome features

 

*To whom correspondence should be addressed.

can lead to a better examination of functional responses and
provide a comprehensive understanding of the underlying biolo-
gical mechanisms. In recent years, well-known large-scale pro-
jects, such as The Cancer Genome Atlas (TCGA) (2012), the
Cancer Cell Line Encyclopedia and the Encyclopedia of DNA
Elements, have generated genomic proﬁles across multiple plat-
forms. In addition, more and more recent projects in the Gene
Expression Omnibus contain multi-platform data. With diverse
data types from different platforms, it becomes challenging to
properly integrate, analyze and interpret the results to obtain
biological insights. Gene set analysis is a powerful strategy de-
veloped to analyze large-scale proﬁling data. Instead of studying
one gene at a time, gene set analysis focuses on a set of related
genes, such as genes in one Kyoto Encyclopedia of Genes and
Genomes pathway (Kanehisa and Goto, 2000) or those related
to the same Gene Ontology (Ashburner et al., 2000) term. Joint
analysis of genes in a set often improves power, especially when
the signals of individual genes are moderate. Because the set itself
often has biological meanings, gene set analysis also facilitates
the interpretation of experiment results and helps to identify im-
portant biological ﬁndings (Ramanan et al., 2012). Many meth-
ods have been developed to perform gene set analysis in a single
platform, for example, Gene Set Enrichment Analysis (GSEA)
(Subramanian et al., 2005), GSA (Efron and Tibshirani, 2007)
and Globaltest (Goeman et al., 2004). Several review articles
have been published that discuss the performances of different
gene set methods (Ackermann and Strimmer, 2009; Goeman and
Buhlmann, 2007; Hung et al., 2012; Maciejewski, 2013).

Gene set analysis on multi-platform genomic data is gaining
momentum. Approaches can be roughly classiﬁed into three dif-
ferent categories, characterized by how the multi-platform infor-
mation is integrated. The ﬁrst type performs a gene set analysis on
each platform and then combines the single platform information,
such as P—values (e.g. J ia et al., 2012). Such a strategy is commonly
used when the multi-platform data are from similar, but not iden-
tical, samples. The second strategy, such as that used in the SumZ
approach of Xiong et al. (2012), ﬁrst sums the gene-speciﬁc asso-
ciation score of each platform to compute a multi-platform score
for each gene and then uses the gene scores to perform gene set
analysis. The third strategy is similar to the second except that it
directly derives the multi-platform gene scores using data from all
platforms simultaneously. One representative approach is the in-
tegrative (INT) approach proposed by Tyekucheva et al. (2011),

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1501

112 ﬁle'slcumo[pJOJXO'sopquJOJutoiq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

J.Hu and J.-Y. Tzeng

 

which uses a logistic regression with all multi-platform values of a
gene as predictors and takes the model deviances as the gene
scores for downstream gene set analysis (Tyekucheva et al.,
2011). Bayesian methods have also been developed to analyze
multi-platform genomic data, e. g. iBAG WVang et al., 2013) and
PARADIGM Waske et al., 2010). Compared with traditional
gene set methods, Bayesian methods often use extensive know-
ledge of the biological relationships among different data plat-
forms and/or the interactions between studied genes.

Sample heterogeneity refers to molecular and cellular differ-
ences among biological samples. Such differences are commonly
encountered in complex diseases like cancer, where cases with
different genotypes, genomic copy numbers or expression pat-
terns often lead to different disease progressions and treatment
strategies (Fisher et al., 2013; Russnes et al., 2011). Several meth-
ods have been developed to address sample heterogeneity, e.g.
cancer outlier proﬁle analysis (MacDonald and Ghosh, 2006),
outlier sum (Tibshirani and Hastie, 2007), outlier robust t—statis-
tics (ORT) (Wu, 2007), cancer likelihood ratio statistics (LRS)
(Hu, 2008) and non-parametric change-point statistics WVang
et al., 2011). Although the superiority of these methods over
ordinary analysis has been demonstrated with heterogeneous
data in a single platform, to the best of our knowledge, there
are no corresponding gene set approaches for multi-platform
heterogeneous data. The impact of sample heterogeneity on
multi-platform analyses can be more substantial than on single
platform analyses. First, the level of heterogeneity can be differ-
ent from platform to platform, e.g. platforms such as somatic
mutations and DNA methylation have much higher diversity
(heterogeneity) among individuals and samples than DNA
copy number (Aryee et al., 2013; Chin et al., 2011). In addition,
the heterogeneous subsets can be different from one platform to
another, e.g. some samples might have changes on platform A
but no changes on platform B, whereas different subsets of sam-
ples have changes on platform B but not on platform A. Such a
scenario may lead to power loss due to the attenuation of signals
when the association is evaluated across platforms. In contrast, a
multi-platform method that can tackle platform-speciﬁc hetero-
geneous data would be able to identify the signals when integrat-
ing information across platforms.

In this study, we perform simulation studies to systematically
evaluate different integrative methods under a range of scenarios.
We observe that the true-positive rates (TPR) and the true-
negative rates of existing multi-platform gene set methods decrease
dramatically when heterogeneity exists. These results motivated us
to construct three methods to account for sample heterogeneity in
multi-platform gene set analysis: multi-platform Mann—Whitney
statistics (MPMWS), multi-platform outlier robust T-statistics
(MPORT) and multi-platform likelihood ratio statistics
(MPLRS). We use simulations and real data analyses to demon-
strate the utility of these methods under various conditions.

2 METHODS

2.1 TCGA datasets

We downloaded the TCGA breast cancer data from the National Cancer
Institute ftp site in January 2013. We focused on the level 3 gene summary
data from RNA sequencing (RNA-Seq), methylation and copy number

variation (CNV) and extracted 530 common samples (480 case samples
and 50 control samples) and 10 371 common genes shared among the
three platforms. For RNA- Seq data, the 10 g2 reads per kilo base per million
were used as gene expression values. Before the log2 transformation, a
minimal value (0.0001) was added to prevent inﬁnite values. For methyla-
tion, the mean beta values of all of the probes mapped to a gene were ﬁrst
computed and then converted into an M value for each gene GDu et al.,
2010). The CNV values were provided in log2 format. Within each plat-
form, the data were standardized to have mean 0 and standard deviation 1.
The TCGA breast cancer data were used to perform simulations and a real
data analysis. We also performed a data analysis on the TCGA Kidney
Renal Clear Cell Carcinoma (KIRC) dataset, for which we applied the same
procedures of data processing and obtained 486 common samples (463 case
samples and 23 control samples) and 11 182 common genes shared among
the three platforms of methylation, CNV and RNA-Seq data.

2.2 Simulations design

We generated simulated data based on the TCGA breast cancer dataset,
which contains 480 cancer samples and 50 control samples (i.e. the case
proportion 11 = 91%). First, we created 207 non-overlapping gene sets by
randomly drawing genes from the 10 371 genes without replacement. The
sizes of the 207 gene sets were randomly determined based on the size
distribution of the MSigDB canonical pathways (Subramanian et al.,
2005). The genomic data for cases and controls were simulated using
the scheme described in the Tyekucheva study (Tyekucheva et al.,
2011). In short, we ﬁrst shufﬂed the case—control labels to remove any
association that may exist in the original data. Then, we randomly se-
lected 10 gene sets as causal gene sets and ‘spiked in’ signals into the
causal gene sets as detailed below. We performed 300 replicates for each
simulation scenario.

(A) Simulation with homogenous samples. Given a causal gene set, we
randomly selected 05% (25, 50 or 75%) of the genes as causal genes. For
each causal gene, one platform was randomly selected as causal and Ak
was added to the genomic values of the causal platform for cases. The
value of Ak was derived such that the two-sample t-test between cases
and controls had power ,8 (0.2, 0.4, 0.6, 0.8 or 0.9).

(B) Simulation with heterogeneous samples. We considered two scen-
arios (referred to as Scenarios B1 and B2) to simulate datasets with
sample heterogeneity. In Scenario B1, we followed the simulation
scheme for Scenario A, except we randomly selected y% (20, 40, 60,
80, 90 or 100%) of the case samples as ‘true’ cases for each causal
gene. In other words, we only ‘spiked in’ Ak signals into the (randomly
selected) causal platform of the causal gene for the ‘true’ cases. Because
the causal platform of a causal gene was randomly selected, the causal
genes in a platform are different from each other (although there may be
some overlaps).

In Scenario B1, there is only a single causal platform for each causal
gene for the ‘true’ cases. In real biological situations, we often see genes
that have changes in multiple platforms. To account for these scenarios,
we considered Scenario B2, in which each causal gene is allowed to have
changes in more than one platform. Speciﬁcally, let w be the number of
causal platforms of a casual gene; then, the probability of w = (1, 2, 3) is
(4/ 8, 3 / 8, 1 / 8), respectively. That is, we ﬁrst determined the number of
causal platforms from binomial (3, 1/2) and then converted w = 0 to
w = 1. We then added Ak values to the genomic data of the causal
platform(s) of a causal gene for the ‘true’ cases.

2.3 Multi-platform methods for gene set analysis without
sample heterogeneity

The general steps of integrative gene set analysis start with computing gene-

speciﬁc association scores (gene scores in short) of multi-platform data and

then using these scores to perform gene set analysis. For the gene set ana-
lysis, we conducted the gene set tests using R function ‘geneSetTes t’

 

1502

112 [3.1081120an[plOJXO'SODBIIIJOJIIIOIQ/[i(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo :2

Integrative gene set analysis of multi-platform data with sample heterogeneity

 

from the R/Bioconductor package ‘lirnma’ (Smyth, 2005) and obtained
P-values for each gene set. The ranks of the gene scores were used instead
of the actual scores (Michaud et al., 2008). We selected different thresholds
of P-value cutoff and computed the TPR, i.e. the percentage of the causal
gene sets truly identiﬁed, and the false-positive rate, i.e. the percentage of
non-causal gene sets falsely identiﬁed as causal gene sets. We plotted the
receiver operating characteristic (ROC) curves to compare the perform-
ances of the different methods using R. Below; we describe how different
methods obtain the multi-platform gene scores considered in the simulation
study.

0 Integrative (INT) analysis (Tyekucheva et al., 2011):
For each gene, regress the disease status on the genomic variables
from all platforms using a logistic regression model. The multi—plat-
form gene scores are computed by taking the differences of the de-
viances between the null models (excluding genomic predictors) and
the full models (including all genomic predictors).

Hotelling’s T2 (HT2):

For each gene, perform the Hotelling’s T2 test to conduct a case—
control comparison using the genomic variables from all platforms
Oﬂong et al., 2002). The multi-platform gene scores are the
Hotelling’s T2 statistics.

0 SumZ Oﬂong et al., 2012):
For each gene at each platform, calculate the association score (1-
statistics). Next, use permutations to obtain the null distribution of
the t-statistics within each platform. Then, standardize the t-statistics
of each gene based on the null distributions. Finally, for each gene,
obtain the gene scores by taking the sum of the standardized values
across different platforms.

0 Deviance summarization:

For each gene at each platform, ﬁt the logistic regression under the
null model (i.e. excluding the genomic variable) and under the full
model (i.e. including the genomic variable). Next, obtain the devi-
ance difference between the two models. Finally, for each gene, take
the average of the deviance difference across platforms as the multi-
platform gene scores (referred to as AveD). The method of MaxD is
obtained in the same manner except that the maximum is used rather
than the average.

Single platform method (benchmark):

For each gene at each platform, perform the same analysis as
described in ‘deviance summarization’. Then, obtain the single-plat-
form gene scores by taking the deviance difference between the null
model and the full model. We applied this strategy on methylation,
CNV and RNA-Seq expression platforms and referred to the corres-
ponding methods as Methy, CNV and Exp, respectively.

2.4 Multi-platform methods for gene set analysis
accounting for sample heterogeneity

We constructed three multi-platform methods to address sample hetero-
geneity. Speciﬁcally, we extended two current methods designed for single
platform analysis to the multi-platform setting, i.e. MPORT [based on
ORT of Wu (2007)] and MPLRS [based on LRS of Hu (2008)]. We also
developed a non-parametric method, MPMWS, which obtains the gene
scores based on the Mann—Whitney statistics and does not assume sym-
metric distributions for the genomic variables.

The general procedure of multi-platform heterogeneous methods is as
follows. Assume that there are M genes and L platforms measured from
no control samples and n1 case samples (i.e. in total, n = no + n1 samples).
Let Ximg be the observed value of the genomic variable for gene m and
platform K of sample 1. For each gene, use the single platform method to
compute association statistic ng for platform Z. Next, similar to the
SumZ method, use permutations to obtain a null distribution of the

statistics for platform K. Finally, calculate the standardized gene statistics
within platform 6, denoted by T ,3“, using the mean and standard devi-
ation (denoted by  and Se, respectively) obtained from the permuted
null distribution, i.e.

Toe = (Tme — T—Jz)/S-e- + Cl (1)

As is done in the SumZ implementation, these scores are made positive by
adding a constant, C], that is the absolute value of the most negative score
across the platform. This translation makes all of the Tm) values positive
but does not change the shape of their distribution. Then, the sum of the
standardized gene statistics from each platform deﬁnes the multi-platform
gene scores:

L
Gm = Z T,§,,. (2)
i=1

The MPORT, MPLRS and MPMWS methods differ only in how T ml is
obtained. We show the formula for computing T me when detecting
‘upregulated’ genes. (Here, the term ‘upregulated’ indicates the increase
of numerical values rather than the biological ‘turning on’ of the gene.)
The approaches can be extended to detecting downregulated genes by
reversing the signs of the observed values.

0 MPORT: T mg is computed using the ORT method (Wu, 2007). For
each gene at each platform, calculate the mean absolute deviance
(MAD) by MAD = 1.4286 x median(z,-mg), where

(3)

Z_ : Iximg — mediancommlla'f i is a control sample)
we Iximg — mediancaseKif i is a case sample)

For upregulated genes, T mg is computed from the case samples using
the ORT method:

ZKximﬂ _ mediancase) X I(ximﬂ > 6175.”, + IQRcase)]

MAD ’ (4)

 

Tme = TORT =

where I(A) is an indicator function of event A, 9175ng is the 75th
percentile of xmg for the case samples and I QRcase is the interquartile
range of the case samples.

0 MPLRS: T mg is computed using the LRS method (Hu, 2008). For
upregulated genes, the genomic data are sorted from the smallest to
the largest under the constraint that all controls are ranked lower

than cases.
k
Sign“ = inmg,where no + 1 5 k<n and (5)
i=1
kS 1
mm _ S
Tme = TLRS = migX "—W (6)
k
k(1 — z)

o MPMWS: T mg is computed using the non-parametric Mann—
Whitney change point detection method implemented in R package
CPM (Ross, 2013; Ross et al., 2011). The genomic data are sorted
from the smallest to the largest under the constraint that all controls
are ranked lower than cases; the Mann—Whitney U statistic, Uhmg,
for each case sample is computed; and ng is selected as the largest
Uk,m£-

ng = TMWS = mlax(Uk,mg),where no + 1 5 k<n. (7)

2.5 Real data analysis

We performed real data analysis using the methods that have the best
performances in the simulation studies (i.e. MPMWS and INT). The 1452
pathways in MSigDB were tested using both the breast cancer and the

 

1503

112 [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

J.Hu and J.-Y. Tzeng

 

KIRC datasets, which comprised genomic data from methylation, CNV
and RNA-Seq platforms.

3 RESULTS

3.1 Multi-platform methods for gene set analysis with
homogenous samples (scenario A)

We evaluated the abilities of AveD, MaxD, INT, SumZ and
Hotelling’s T2 (HT2) to correctly identify causal gene sets
under various parameter settings. Single platform methods
Methy, CNV and Exp were used to benchmark the performances
of the multi-platform methods. Figure 1 shows the ROC plots
under different proportions of causal genes in a causal set, i.e.
at = 75, 50, and 25% for Figure lA—C, respectively, while ﬁxing
,6 (power) at 0.8 and I7 (percentage of case samples) at 0.91. The
corresponding areas under the curves (AUCs) are summarized in
Supplementary Table SlA. From Figure 1A, it is clear that
multi-platform methods outperformed single platform methods.
Among the multi-platform methods, Hotelling’s T2 and INT had
similar performances, and these methods had the best

 

>
I

 

 

 

 

 

 

 

 

 

Pinata-“7.3;?-
oq _ r)? ’ $5.25" '
0 §/ /;’_*:/"
«‘1’- — ’5‘" -‘- INT
g ,ﬁ/ ‘3" SumZ
a v- v :r' in.
I— O ‘ - ax
I, '0' AveD
— ‘9" Methy
0. _ '1" Exp
0 I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0
FPRate
B ‘ ...- -—-#—'- :24:
w  1‘ f/-*/L'%
O _  _*r/"'v
zf'
4% -  43"“ -°- INT
L! g ,:17’ ‘A' SumZ
D. V: _ or”, '+' HT2
'— O // '*' MaxD
l/I’ + 
_ if "V" Methy
9. _ '*' Exp
O I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0
FPRate
c _ /
oo gv"*(*u;$
d ‘  yogi"
a)  (5*?
a - a?»  :- T
m ’46 ﬂy _‘ _' SumZ
CL sl' _ '3" ,7" + HT2
I— o  —* '*- MaxD
g/' of -°- AveD
— /”‘ "V" Methy
0. _ ‘6 ‘*' Exp
0

 

 

I I
0.0 0.2 0.4 0.6 0.8 1.0
FPRate

Fig. 1. ROC plots for gene set methods at different or levels [(A) or = 75%;
(B) or = 50%; and (C): or = 25 %]. The simulated data were generated with
,8 = 0.8 and n = 0.91

performances among all methods. AveD and MaxD had slightly
lower TPRs than INT, and SumZ followed closely. In Figure 1B
and C, the relative performance among different methods stayed
the same as in Figure 1A, except that the TPRs decreased when 01
decreased. The same patterns were observed for ,8: 0.6
(Supplementary Fig. S1; Supplementary Table SlA).

Figure 2 shows the ROC plots under different ,6 levels, i.e.
,6 = (0.9, 0.8, 0.6, 0.4, and 0.2) when a:75% and I7 2091.
(The AUC values are shown in Supplementary Table SlA).
The patterns for the relative performances of different methods
were observed to be similar to those of Figure 1. As expected, all
methods performed better when the difference between case and
control became larger (i.e. larger ,6).

The case proportion, I7, is known to affect the power of
statistical methods (Evans and Purcell, 2012). We repeated
the studies for I7 = 0.5 (Supplementary Fig. S2) and 0.1
(Supplementary Fig. S3); similar results were observed under
these scenarios.

3.2 Multi-platform methods for gene set analysis with
heterogeneous samples (Scenarios B1 and B2)

To evaluate the performance under sample heterogeneity, we
simulated datasets by randomly selecting y% of case samples
to be ‘true’ cases. We focused our comparisons on the two rep-
resented approaches from Section 3.1 (i.e. INT and SumZ) and
the three proposed methods for sample heterogeneity, i.e.
MPLRS, MPORT and MPMWS. The results of Scenario B1
are shown in Figure 3, where a:75%, ,B=0.8 and I7:0.91,

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2» .g. ’%-—."‘
w - I /T/ w- - I ,$’/
0 43 o [gr/r
a: <0 0’" + INT a: <0 6'? + INT
:6 o ' If -A- SumZ *6 o' I," -A- SumZ
I I/ ..|.. I 7 ._|..
E ‘r *” -*- $0 IE " - ’1’ -*- ﬁn
° V + AveD ° V + AveD
N _ '" Methy N _ "‘- Methy
O O
o «I» Exp 0 -* Exp
0 - I I I I I I o - I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
FPRate FPRate
c 3 - ..—.— — D 3-
co 3.9‘6ZV’V‘ co Aﬁg‘ﬁ.:’::;
o' - x ,9?" o' ' 48” a"
I IV/ //£r/ ’31:!
.9 ‘9. I 85/ —0— INT ‘9 (Q _ {I IV _._ INT
g ° ,9: :1- SumZ g o ,o ,f/ :1- SumZ
IE 3- ,7 3*; ~be I5 E- I  ‘1‘; wD
:I/ '°' AveD ,j '9' AveD
a! _ *' Methy a! _ I * Methy
C) C)
o '*' Exp 0 '* Exp
6 - I I I I I I  - I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
FPRate FPRate
E O. _
\— V
w 
o' ' 94* A!"
A ,s’
0 <0. - i” r/ -- INT
g o / ’vr/ 'A' SumZ
n. 4 26 -+- HT2
.. o- - If "*' MaxD
’/ '°' AveD
N_ _ "' Methy
o ‘/
"'- Exp
0. _
O

 

 

 

I I
0.0 0.2 0.4 0.6 0.8 1.0
FPRate

Fig. 2. ROC plots for gene set methods at different ,8 levels [(A) ,8 = 0.9;
(B) ,8 = 0.8; (C) ,8 = 0.6; (D) ,8 = 0.4; and (E) ,8 = 0.2]. The simulated data
were generated with or = 75% and n = 0.91

 

1504

112 ﬁlm'spaumo[pJOJXO'SQTIBmJOJurorw/2dnq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

Integrative gene set analysis of multi-platform data with sample heterogeneity

 

and the percentage of ‘true’ cases among all cases varies, i.e.
y=(100, 90, 80, 60, 40 and 20%). The corresponding AUC
values are presented in Supplementary Table SlB. We see that
INT and SumZ, which are designed for multi-platform homoge-
neous data, quickly lost power as y decreased. In contrast,
MPLRS and MPMWS retained good power when y decreased.
However, the relative performance between MPLRS and
MPMWS depended on y. When y was low (e.g. 540%),
MPLRS performed the best; when y was 60%, MPLRS and
MPMWS had similar power. However, when y was high (e. g.
2 80%), MPLRS had less TPRs than MPMWS, sometimes even
less than INT. MPORT performed inferior to MPLRS and
MPMWS, and its power advantages over INT and SumZ did
not show until y became small, i.e. ~20—40%. Because y is un-
known in practice, MPMWS appears to be the most robust
choice; it yielded the highest or the second highest TPRs regard-
less of the y values. Although the method is designed to account
for sample heterogeneity, it had similar power to INT when
samples were homogeneous (y: 100%). This behavior is likely
attributable to the fact that the genomic variables of certain plat-
forms tended to deviate away from normal distributions, e.g.
methylation values, and the non-parametric MPMWS is robust
against non-normality. Finally, the improved TPR obtained
using MPLRS and MPMWS with heterogeneous samples was
observed when we repeated the analysis for at = 50% and I7 = 0.5
(Supplementary Fig. S4) and 0.1 (Supplementary Fig. S5).

By design, INT is good at identifying pathways with system-
atic changes, whereas MPMWS has robust power to detect path-
ways involving sample heterogeneity. In Table 1, we show the

 

number of signiﬁcant pathways and the number of true-positive
(TP) pathways identiﬁed by INT and MPMWS. We observe that
both methods identiﬁed many common signiﬁcant/TP pathways.
In addition, there was a high percentage of TPs among the
common signiﬁcant pathways, especially when the heterogeneity
level was not extremely high. The results also show that each
method identiﬁed some unique signiﬁcant/TP pathways that
were missed by the other method. For INT, the proportion of
TPs among the unique pathways became smaller as the hetero-
geneity increased. For MPMWS, the corresponding TP propor-
tion stayed roughly constant until severe heterogeneity (e. g.
y = 20 %).

The analyses above were performed under Scenario B1, where
each causal gene only had one causal platform. We repeated the
same analyses under Scenario B2, where each causal gene had at
least 1 causal platform. We obtained similar results as observed
in Scenario Bl (Supplementary Fig. S6).

3.3 Real data application

We ﬁrst considered the TCGA breast cancer dataset containing
methylation, CNV and RNA-Seq measurements. We performed
multi-platform gene set analyses on the 1452 MSigDB pathways
using MPMWS and INT (i.e. the top two methods from
Scenarios B1 and B2). Unlike the simulated gene sets, pathways
in MSigDB often share common genes and can have signiﬁcant
overlaps. Figure 4 shows the number of pathways identiﬁed by
each method and their overlaps at false discovery rate (FDR)
0.05 using the Benjamini and Hochberg’s FDR procedure

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A S T . ;§-=argétat-twi—‘ B 3 T .. agate-“OWDTT‘”. C S '   %5"*"'*"“
,.ar:r§: T +43:ng ’  T
, a. . '. ’0’ li- ,’
(n- - {/0/  - +' /£/’  — ,',O,//8
°  °  ° 
9 <0. _ ° 9 “3. _ i/ 9 “3. _ A17
53 ° +INT 52’ ° ° +INT g o / +INT
n. q- T SumZ n. q- T SumZ n. q- T T SumZ
I‘cS' +MP l—o" +MP S l—o" +MP S
*T MPLRS TXT MPLRS *- MPLRS
N T0- MPORT N T0- MPORT N T<>T MPORT
d _ 0' T o. _
O. _ Q _ Q _
o I | | I I I O | | | I I I O | I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
FPRate FPRate FPRate
o O, _ ,__ O. _ -
D F _ *lﬂ*.’*;*"t;t9‘ E F ¥.:2f_25¥. F F ‘11:;
co _ JIF- oﬁgg 0Q _ x/f-f-T: ' 6&3’: oo_ _ _, 
o 9" ojc o ’.+-- Q/IA/ o  /,0/
f” / x'." VA] x ‘- '0 l8
.03 g — ar g/ .9 g — ,5." /A/’ .9 g - x + .028”
a.“ 4 TT INT 2:“  /2/’ + INT 2: ’+  + M
n. a o TAT SumZ 9. ¢ +1 o/ T SumZ n. ¢ _/ / 3’ TAT SumZ
I— o - Al -+- Mp l— c; - A, + MP 3 l— c; - 3+ ,0/ + MP 3
-+<- MPLRS  *- MPLRS 230 2r *- MPLRS
N T0- MPORT N 0/ T0- MPORT N x:'/ ,/ T<>T MPORT
o ' o' ' A o' ' +/,'
O _ O. _ O. _
o I | | I I I o | | | I I I o | I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
FPRate FPRate FPRate

Fig. 3. ROC plots for gene set methods at different sample heterogeneity levels [(A) y = 100%; 03) y = 90%; (C) y = 80%; (D) y = 60%; (E) y = 40%;
and G‘) V = 20%)]. The simulated data were generated with or = 75%, ,8 = 0.8 and n = 0.91

 

112 ﬁlm'spaumo[pJOJXO'SQTIBmJOJurorw/2dnq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

J.Hu and J.-Y. Tzeng

 

Table 1. The average number of signiﬁcant gene sets identiﬁed by INT and MPMWS at different heterogeneity levels

 

 

 

 

 

Signiﬁcant gene set Both INT and MPMWS INT only MPMWS only

y values (%) Positive TP TP (%) Positive TP TP (%) Positive TP TP (%)
100 7.33 6.92 94.41 8.52 1.08 12.68 9.04 1.37 15.15
90 6.59 6.17 93.63 8.75 1.13 12.91 9.51 1.72 18.09
80 5.79 5.36 92.57 9.09 1.24 13.64 9.94 2.05 20.62
60 3.61 3.14 86.98 9.54 1.28 13.42 11.06 2.86 25.86
40 1.7 1.17 68.82 9.78 1.04 10.63 11.5 2.96 25.74
20 0.76 0.19 25.00 9.72 0.63 6.48 10.66 1.77 16.60

 

Ten of 207 gene sets were selected as causal, and the results were averaged over 300 repeats.

Fig. 4. Signiﬁcant pathways identiﬁed by MPMWS and INT. The num-
bers of signiﬁcant pathways are listed in parentheses

(Benjamini and Hochberg, 1995). The numbers of signiﬁcant
pathways identiﬁed by INT and MPMWS were 116 and 78, re-
spectively. Comparing the signiﬁcant ﬁndings from MPMWS
and INT, we found that a majority (58 and 74%) of the path-
ways were shared between the two methods (Supplementary
Table S2). This includes many well-known pathways related to
breast cancer, e.g. PKLl (King et al., 2012; Wierer et al., 2013)
and the cell cycle pathway (Caldon et al., 2006). As was observed
in the simulation study, there were quite a few overlaps between
MPMWS and INT. However, some signiﬁcant pathways that
were identiﬁed by one method had large P—values in the other
method. For example, the pathways of DNA replication and
DNA strand elongation are important for breast cancer
(Lomonosov et al., 2003; Thomassen et al., 2009); they were
identiﬁed by INT but missed by MPMWS (Supplementary
Table S3A). In contrast, the BRGl-associated factor complex
(Hargreaves and Crabtree, 2011; Kadoch et al., 2013), the well-
known tumor suppressors and the G1 pathway (Thomassen
et al., 2008), a known breast cancer-related pathway, were
found to be signiﬁcant by MPMWS but not by INT
(Supplementary Table S3B). These results agree with the obser-
vations in the simulation study: INT and MPMWS appear to
identify different types of signals and can be used together in real
practice.

We applied multi-platform gene set analyses on a second
TCGA dataset, i.e. the KIRC dataset. We observed similar

results as for the breast cancer data and reported the detailed
results in Supplementary Table S4.

4 DISCUSSION

In the presented work, we compared different multi-platform
methods for gene set analysis using extensive simulated studies.
First, when there is no sample heterogeneity, we found that INT
and Hotelling’s T2 method had the best performances compared
with other methods. INT might have wider applicability com-
pared with Hotelling’s T2 because it can accommodate covari-
ates. Second, to account for sample heterogeneity, we proposed
and tested three different strategies, MPMWS, MPORT and
MPLRS, for multi-platform gene set analysis. We found that
the non-parametric MPMWS method had satisfactory TPRs
and robust performance regardless of the degree of heterogen-
eity. Finally, based on the results of the simulations and the real
data applications, we recommend using both MPMWS and INT:
the signiﬁcant gene sets identiﬁed by both methods are more
likely to be true positives, while each approach is able to identify
orthogonal, yet relevant, biological gene sets. It might be worth
following up with these orthogonal ﬁndings combining with add-
itional biological information so to minimize the false positives.

We performed the tests assuming that genes are uncorrelated
within and across platforms. This assumption may not be valid
in real practice, especially for genes within the same gene sets.
Inter-gene correlation is known to inﬂate the FDR of single-
platform gene set analysis, and several methods have been pro-
posed to address this issue (Gatti et al., 2010; Wu and Smyth,
2012). In addition, the genomic variables of a gene from different
platforms can also be highly correlated with each other. For
example, copy number change can lead to a change of transcript
level, and a high methylation level of the gene promoter region
often leads to downregulation of transcription. It is worth future
studies to evaluate how inter-gene and inter-platform correl-
ations will affect multi-platform gene set analysis.

In our analysis, we ignored the issues of missing values by
focusing on genes with complete observations in all platforms.
In reality, missing data are commonly observed in large-scale
studies because of the experimental conditions, individual
sample differences or platform constraints. When a considerable
amount of data are missing, removing all the samples or genes
with missing data could lead to substantial loss of information.

 

1506

112 ﬂJO's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

Integrative gene set analysis of multi-platform data with sample heterogeneity

 

To address this issue, imputing can be used to ﬁll in the missing
values. Performing self-contained gene set analysis tests is an-
other strategy (Tyekucheva et al., 2011). Further research is
needed to characterize the patterns of missing data on different
platforms, understand their impact on the gene set analysis and
develop the proper statistical methods for missing data.

The R code for all of the methods and test datasets are avail-
able on the Web site: http://www4.stat.ncsu.edu/~jytzeng/
Software/Multiplatform_gene_set_analysis/

ACKNOWLEDGEMENTS

The authors thank Dr Kejun Liu at Omicsoft Inc. and Dr
Shannon Holloway at North Carolina State University for help-
ful discussion and invaluable suggestions.

Funding: This work is partially supported by NIH grants (R01
MH084022 and P01 CA142538).

Conflict of Interest: none declared.

REFERENCES

Ackerrnann,M. and Strirnmer,K. (2009) A general modular framework for gene set
enrichment analysis. BMC Bioinformatics, 10, 47.

Aryee,M.J . et al. (2013) DNA methylation alterations exhibit intraindividual stabil-
ity and interindividual heterogeneity in prostate cancer metastases. Sci. Trans].
Med, 5, 169ra110.

Ashburner,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology. The
Gene Ontology Consortium. Nat Genet, 25, 25—29.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac-
tical and powerful approach to multiple testing. J. R. Stat. Soc. Ser. B Method,
57, 289—300.

Caldon,C.E. et al. (2006) Cell cycle control in breast cancer cells. J. Cell Biochem.,
97, 261—274.

Chin,L. et al. (2011) Making sense of cancer genomic data. Genes Dev., 25, 534—555.

Du,P. et al. (2010) Comparison of Beta-value and M-value methods for quantifying
methylation levels by microarray analysis. BM C Bioinformatics, 11, 587.

Efron,B. and Tibshirani,R. (2007) On testing the signiﬁcance of sets of genes. Ann.
Appl. Stat, 1, 18.

Evans,D.M. and Purcell,S. (2012) Power calculations in genetic studies. Cold Spring
Harb. Protoc., 2012, pdb.top069559.

Fisher,R. et al. (2013) Cancer heterogeneity: implications for targeted therapeutics.
Br. J. Cancer, 108, 479—485.

Gatti,D.M. et al. (2010) Heading down the wrong pathway: on the inﬂuence of
correlation within gene sets. BMC Genomics, 11, 574.

Goeman,J.J. and Buhlmann,P. (2007) Analyzing gene expression data in terms of
gene sets: methodological issues. Bioinformatics, 23, 980—987.

Goeman,J.J. et al. (2004) A global test for groups of genes: testing association with a
clinical outcome. Bioinformatics, 20, 93—99.

Hargreaves,D.C. and Crabtree,G.R. (2011) ATP-dependent chromatin remodeling:
genetics, genomics and mechanisms. Cell Res., 21, 396—420.

Hu,J. (2008) Cancer outlier detection based on likelihood ratio test. Bioinformatics,
24, 2193—2199.

Hung,J.H. et al. (2012) Gene set enrichment analysis: performance evaluation and
usage guidelines. Brief. Bioinform, 13, 281—291.

Jia,P. et al. (2012) Integrative pathway analysis of genome-wide association studies
and gene expression data in prostate cancer. BM C Syst Biol, 6 (Suppl. 3), $13.

Kadoch,C. et al. (2013) Proteomic and bioinformatic analysis of mammalian SWI/
SNF complexes identiﬁes extensive roles in human malignancy. Nat Genet, 45,
592—601.

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and gen-
omes. Nucleic Acids Res., 28, 27—30.

King,S.I. et al. (2012) Immunohistochemical detection of Polo-like kinase-l (PLK1)
in primary breast cancer is associated with TP53 mutation and poor clinical
outcom. Breast Cancer Res., 14, R40.

Lomonosov,M. et al. (2003) Stabilization of stalled DNA replication forks by the
BRCA2 breast cancer susceptibility protein. Genes Dev., 17, 3017—3022.

MacDonald,J.W. and Ghosh,D. (2006) COPA—cancer outlier proﬁle analysis.
Bioinformatics, 22, 2950—2951.

Maciejewski,H. (2013) Gene set analysis methods: statistical models and methodo-
logical differences. Brief. Bioinform, [Epub ahead of print].

Michaud,J. et al. (2008) Integrative analysis of RUNXl downstream pathways and
target genes. BMC Genomics, 9, 363.

Ramanan,V.K. et al. (2012) Pathway analysis of genomic data: concepts, methods,
and prospects for future development. Trends Genet, 28, 323—332.

Ross,G.J. (2013) cpm: Sequential Parametric and Nonparametric Change
Detection. R package version 1.1. http://CRAN.R—project.org/package =cpm.

Ross,G.J. et al. (2011) Nonparametric monitoring of data streams for changes in
location and scale. Technometrics, 53, 379—389.

Russnes,H.G. et al. (2011) Insight into the heterogeneity of breast cancer through
next-generation sequencing. J. Clin. Invest., 121, 3810—3818.

Smyth,G.K. (2005) Limma: linear models for microarray data. In: Bioinformatics
and Computational Biology Solutions Using {R} and Bioconductor. Springer,
New York, pp. 397—420.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-based ap-
proach for interpreting genome-wide expression proﬁles. Proc. Natl Acad Sci.
USA, 102, 15545—15550.

The Cancer Genome Atlas Network. (2012) Comprehensive molecular portraits of
human breast tumours. Nature, 490, 61—70.

Thomassen,M. et al. (2008) Gene expression meta-analysis identiﬁes metastatic
pathways and transcription factors in breast cancer. BM C Cancer, 8, 394.
Thomassen,M. et al. (2009) Gene expression meta-analysis identiﬁes chromosomal
regions and candidate genes involved in breast cancer metastasis. Breast Cancer

Res. Treat, 113, 239—249.

Tibshirani,R. and Hastie,T. (2007) Outlier sums for differential gene expression
analysis. Biostatistics, 8, 2—8.

Tyekucheva,S. et al. (2011) Integrating diverse genomic data using gene sets.
Genome Biol., 12, R105.

Vaske,C.J. et al. (2010) Inference of patient-speciﬁc pathway activities from multi-
dimensional cancer genomics data using PARADIGM. Bioinformatics, 26,
i237—i245.

Wang,W. et al. (2013) iBAG: integrative Bayesian analysis of high-dimensional
multiplatforrn genomics data. Bioinformatics, 29, 149—159.

Wang,Y. et al. (2011) Non-parametric change-point method for differential gene
expression detection. PloS One, 6, 620060.

Wierer,M. et al. (2013) PLK1 signaling in breast cancer cells cooperates with estro-
gen receptor-dependent gene transcription. Cell Rep., 3, 2021—2032.

Wu,B. (2007) Cancer outlier differential gene expression detection. Biostatistics, 8,
566—575.

Wu,D. and Smyth,G.K. (2012) Camera: a competitive gene set test accounting for
inter-gene correlation. Nucleic Acids Res., 40, 6133.

Xiong,M. et al. (2002) Generalized T2 test for genome association studies. Am. J.
Hum. Genet, 70, 1257—1268.

Xiong,Q. et al. (2012) Integrating genetic and gene expression evidence into genome-
wide association analysis of gene sets. Genome Res., 22, 386—397.

 

112 [3.1081120anIplOJXO'SODBIIIJOJIIIOIQ/[I(11111 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

