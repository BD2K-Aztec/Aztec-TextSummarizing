ORIGINAL PAPER

Vol. 27 no. 5 2011, pages 707-712
doi: 1 0. 1 093/bioinformatics/btq686

 

Data and text mining

Advance Access publication December 12, 2010

A Bayesian approach for estimating calibration curves and
unknown concentrations in immunoassays

Feng Feng1’*, Ana Paula Sales1 and Thomas B. Kepler

1,2,3

1Center for Computational Immunology, Department of Biostatistics and Bioinformatics, Duke University Medical
Center, 2424 Erwin Road, Hock Plaza Suite 1102, 2Department of Immunology and 8Department of Statistical

Science, Duke University, Durham, NC 27705, USA

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: Immunoassays are primary diagnostic and research
tools throughout the medical and life sciences. The common
approach to the processing of immunoassay data involves estimation
of the calibration curve followed by inversion of the calibration
function to read off the concentration estimates. This approach,
however, does not lend itself easily to acceptable estimation of
confidence limits on the estimated concentrations. Such estimates
must account for uncertainty in the calibration curve as well as
uncertainty in the target measurement. Even point estimates can be
problematic: because of the non-linearity of calibration curves and
error heteroscedasticity, the neglect of components of measurement
error can produce significant bias.

Methods: We have developed a Bayesian approach for the
estimation of concentrations from immunoassay data that treats the
propagation of measurement error appropriately. The method uses
Markov Chain Monte Carlo (MCMC) to approximate the posterior
distribution of the target concentrations and numerically compute
the relevant summary statistics. Software implementing the method
is freely available for public use.

Results: The new method was tested on both simulated and
experimental datasets with different measurement error models. The
method outperformed the common inverse method on samples with
large measurement errors. Even in cases with extreme measurements
where the common inverse method failed, our approach always
generated reasonable estimates for the target concentrations.
Availability: Project name: Baecs; Project home page:
www.computationalimmunology.org/utilities/; Operating systems:
Linux, MacOS X and Windows; Programming language: C++;
License: Free for Academic Use.

Contact: feng.feng@duke.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 12, 2010; revised on December 6, 2010;
accepted on December 7, 2010

1 INTRODUCTION

Immunoassays are measurement techniques based on the interaction
between a selective antibody and its target antigen. The
basic principles of immunoassays were introduced in 1945

 

*To whom correspondence should be addressed.

(Landsteiner, 1990), and the ﬁrst application of immunologically
based technology (radioimmunoassay) was reported in the late
1950s (Yalow and Berson, 1959, 1960). Since then, immunoassays
have become a primary diagnostic and research tool within the
medicine and life sciences. Compared to other analytical methods,
immunoassays provide a rapid, simple, economic, highly speciﬁc
and sensitive analysis with high throughput and adaptability
to ﬁeld use [reviewed in (Harris et al., 1998; Hennion and
Barcelo, 1998; Oellerich, 1980)]. Immunoassays do, however, have
limitations. These include interference from matrix compounds
used to stabilize the samples, cross reactivity to structural analogs
and poor scalability for many multi—analyte applications. Several
different types of labels have been used in immunoassays, including
radiolabels, enzymes, ﬂuorescent, luminescent and phosphorescent
labels. The most common labels for clinical and research studies are
enzymes and colorimetric substrates.

The approach used most frequently for the analysis of
immunoassay data is performed in two steps on two sets of samples,
the standards and the target samples. In the ﬁrst step, standard
analyte samples are prepared at known concentrations, and used
to estimate a calibration curve, typically by non—linear least squares,
relating concentrations to measurements in the system. In the second
step, the unknown concentrations are determined by inverting the
calibration curve—ﬁnding the concentration on the standard curve
that produces the same response as that obtained from the unknown
sample (Dudley et al., 1985).

The calibration curve itself is only estimated with error: a limited
number of samples can be used in an assay, and the true curve must
be inferred from a limited number of noisy responses. This task
is accomplished by selecting a family of mathematical functions,
parameterized by a small number of parameters that is capable
of ﬁtting the variety of calibration curves encountered. Previous
work has shown that the ﬁve—parameter logistic family provides
a very good ﬁt under most practical conditions (Gottschalk and
Dunn, 2005). The parameters of the function are ﬁtted to assay data,
assuming some model for the variance of the measurement error,
using non—linear least squares. Contemporary computers handle such
computationally intensive algorithms very easily, although issues of
convergence to false minima and failure of convergence altogether
cannot be ignored. Most ﬁtting algorithms will fail with injudicious
initial guesses or in cases where the variance of the measurement
error is large or modeled improperly.

Upon reading off unknown concentrations by inverting
the calibration model, however, serious challenges can arise.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 707

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUTOTQ/ﬁdllq mm; pepBOIHAAoq

9IOZ ‘091sn8nv uo ::

F.Feng et aI.

 

Table 1. Example experimental data of interferon—B (IFN—B) concentration
measured using enzyme—linked immunosorbent assay (ELISA) and analyzed
by the common non—linear least squares approach implemented widely by
commercial software

 

Standards data Unknown sample data

 

 

 

 

Concentration (pg/ml) OD ID Dilution OD Estimated
concentration

1000.0 3.279 1 1 0.340 32.84

1000.0 3.024 1 0.337 32.31

500.0 2.128 1/10 0.160 ND*

500.0 2.279 1/10 0.172 2.58

250.0 1.319

250.0 1.364 2 1 0.279 22.09

125.0 0.775 1 0.279 22.09

125.0 0.797 1/10 0.148 ND*

62.5 0.506 1/10 0.146 ND*

62.5 0.506

31.25 0.345 3 1 0.159 ND*

31.25 0.334 1 0.171 2.31

0.00 0.130 1/5 0.138 ND*

0.00 0.152 1/5 0.133 ND*

The estimated ﬁve-parameter logistic function is OD450 = 0. 16 +
113—016 197, which is then used to read off unknown concentrations

<1+<§§§g YO“) '

of samples. The samples containing unknown concentration of IFN-B are measured
undiluted and 1:10 diluted, and the optical density values at 450 nm (OD) values are
obtained for estimation of concentrations of IFN-B. ‘ND*’ indicates that OD is below
the detection limits, and the concentration is non-detectable by common non-linear
least squares and inverse method done using the R software (R Development Core
Team, 2006).

The common methods widely implemented by many commercial
software products do not account for calibration uncertainty. This
neglect can lead to signiﬁcant underestimation of error in the
estimated target concentrations, and to bias in the point estimates,
particularly at concentrations at the ends of the calibration range.

Response data in immunoassays are generally heteroscedastic:
their variances are not constant across the range of concentrations
measured. It is common for the variances of standards at the
upper end of the response curve to be 3 or 4 order of magnitude
larger than those at the lower end. Heteroscedasticity is typically
incorporated into the statistical model by assuming that the variance
is proportional to some power of the mean response. Denoting the
variance by 02 and the mean by ,u., we have

(9:611? (1)

where 6 is a scale parameter and a function of magnitudes of the
response, the exponent 6 is usually a number between 1.0 and 2.0
(Finney and Phillips, 1977).

Variances in response measurements at the extreme ends of the
calibration curve can place sample measurements above or below
detection limits; these measurements are typically discarded. Table 1
(and Supplementary Fig. S1) illustrates some of the challenges
encountered when using the common inverse method for estimating
concentrations of unknown samples. It shows data on interferon B
(IFN—B) concentrations measured by enzyme—linked immunosorbent
assay (ELISA). The ﬁrst part is standards data, which were used
to ﬁt a ﬁve—parameter logistic calibration curve by the non—linear
least squares regression. Then the sample measurement data were

used to estimate unknown concentrations by inverting the calibration
function. The unknown sample data contain three samples of
unknown concentration of interferon—B (IFN—B). Each sample was
measured either undiluted or 1:10 diluted in duplicates. Undiluted
sample 1 and 2 contains about 32 and 22 pg/ml IFN—B, respectively.
The 10—time diluted sample 1 and 2 were recorded as ‘ND*’ (non—
detectable) and no estimation of concentration was given, even
though samples generated optical density (ODs) larger than the
lowest value in the system. In case of sample 3, one replicate of
the sample was measured to contain about 2pg/ml IFN—B, while
all other three measurements gave no estimation of concentrations,
even though OD values consistently showed decline from undiluted
samples to 1/ 10 diluted ones and were higher than the lowest
OD values in the system. As can be seen in our experimental
data, sample 3 is not an extreme case, but rather is typical of the
data for some cytokines, especially those of important functions
such as tumor necrosis factor—a (TNF—oc), interferon—y (IFN—y),
etc. This is also true for other types of analytes. For example, in
measurements of allergens or carcinogens, even low concentrations
can be important (Gelman et al., 2004). Furthermore, some of ‘the
low extreme cases’ are not biologically low, but rather low relative
to the machine or kit reagent detection limits. Moreover, the extreme
cases with high or low concentration of target analytes are usually
associated with abnormal states of the system, such as diseases or
activation/inactivation of cells, and are of great research interests.
For example, during a septic shock, the concentration of the pro—
inﬂammatory cytokine interleukin—6 (IL—6) can go up to more than
12000 pg/ml in the blood (Ng et al., 2003), but the Bio—Plex Pro
23—plex Assay [low photomultiplier tube (PMT) setting] (BioRad)
can only detect up to 2100 pm/ml of this cytokine, which is about
6—fold lower (Supplementary Fig. S1). Clearly, a better strategy is
necessary to gain more information from those extreme values of
samples.

In Bayesian statistical modeling, inference about unknown
parameters model is based on the fact that their uncertainty of
them is described by the posterior density conditional on observed
data. Before data collection, a prior distribution is used to describe
parameter uncertainty. After obtaining data, this prior information is
combined with information present in the data through the likelihood
function and Bayes’ rule to obtain the posterior distribution, from
which parameter estimate summary statistics are computed.

Bayesian methods have been widely used in many biomedical
applications and have proven useful for accounting for multiple
sources of uncertainties arising from experimental variation,
instrumental noise, etc. In addition, they do not require point
estimation or linearization of variations, either of which can
underestimate the uncertainties in non—linear models (Davidian
and Giltinan, 1995; Dellaportas and Stephens, 1995). They have
been employed successfully for data analysis in microarray studies,
PCR ampliﬁcation curves, serial dilution assays and ﬂuorescence
chemistry (Conlon et al., 2007; Frigessi et al., 2005; Gelman et al.,
2004b; Sivaganesan et al., 2008). In the case of immunoassay
data analysis, the likelihood function and posterior distribution
automatically incorporate suitable variations arising from the use of
multiple hybridization probes of different lengths and composition.
For serial dilution assays, the Bayesian approach has been shown
to generate reasonable estimates at very low and very high
concentrations of the calibration curve, without discarding extreme
data as being below or above the detection limits.

 

708

112 /B.IO'SIBUJHOprOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Bayesian approach for immunoassay data analysis

 

In thisarticle, we report the use of a Bayesian approach to
generate calibration curves and estimate unknown concentrations
in immunoassays such as ELISA and Luminex assays. The Markov
Chain Monte Carlo (MCMC) method is used to generate samples
from the posterior distribution for the parameters and unknown
concentrations jointly. Compared to the common approach, our
proposed approach allows (i) an acceptable estimation of uncertainty
in the concentration estimates via credible intervals; (ii) a better
use of data points with large variances (especially the very low and
very high concentrations) without discarding those as being ‘beyond
detection limits’. The proposed Bayesian approach is validated using
both simulated and experimental data. We have also implemented
the method in simple—to—use software, which is freely available to
the research community.

2 METHODS
2.1 The model

The model relating the expectation of measured values to the underlying
concentrations is the ﬁve—parameter logistic function family (Gottschalk and
Dunn, 2005; Higgins et 61]., 1998),

E(y|x;.8)=f(x,ﬂ)

,8=[A,B,C,D,E]

ﬁx, .8) =B+ A—BE (2)

(1 + (2)0)

where x denotes the unknown sample concentration, ,8 is the vector of
parameters with components A, B, C, D and E. This model has been shown
to improve performance on assays with asymmetric calibration curves, over
the simpler and widely used symmetric four—parameter logistic function
(Gottschalk and Dunn, 2005).

For the error model, we assume that the log transformation regularizes
the variance. This assumption is borne out by analysis of both Luminex and
ELISA data for 22 murine cytokines; a constant variance model provides
a good approximation with the transformed data. (Supplementary Fig. S2).
The error model, therefore, is

log(y,-j) ~N(log(f(x,-, 13)), 02),
i=1,2,....n; j=1,2,...k; (3)

where 32,; is the j—th observed measurement of the i—th sample, x,- is the i—th
concentration, ,8 is the parameter vector and f (xi, ,8) is the ﬁve—parameter
logistic function as in Equation (2), 02 is the constant random variance, n
is the number of calibration points and k is the number of replicates in each
calibration point.

The following diffuse prior distributions are used:

A, B, C~Log—N(O, 102),

— D ~ Log—N(0,10),

E~Log—N(0,10),

o~Log—N(0, 1), (4)

the log—normal distribution (Log—N) is used here to keep parameters A, B and
C positive. D is a negative number usually larger than — 1. When E is 1, the
ﬁve—parameter logistic function becomes the four—parameter function, which
is a good model for many symmetric calibration curves. The variances for the
log—normal are set so to make the prior distribution diffuse/non—informative.
Other diffuse distributions (such uniform or inverse gamma distribution) can
be used as well. Given the amount of standards data in a typical immunoassay,
the posterior distributions of these parameters can be well identiﬁed.

2.2 Estimation by MCMC

We use MCMC to draw samples approximating those drawn from the
true posterior distribution, and in particular use the Metropolis—Hastings
algorithm implemented as follows.

(1) Choose starting values ,80 = [A0, Bo, C0, D0, E0, 00] and x0.

Starting values are set by rough estimation from the standards data.
A0 is set to be the maximum observed measurement, B0 to be the
minimum one and C0 to be the mean concentration value from sample
data (Gottschalk and Dunn, 2005), D0 is a negative small number
(—1.0) and E0 and 00 are positive small numbers (1.0 and 0.1,
respectively). x0 is selected using crude estimates based on observed
measurements and standards data.

(2) Based on current parameters from previous steps, generate new

candidate parameters, ,8* = [A*, B*, C*, D*, E*, 0*] and x*, from
appropriate proposal distributions.
A simple random—walk algorithm is used to generate new candidate
parameters from the normal distribution centered on the current
value of 6 as the proposal distribution. To generate new candidate
parameters,

,8>i<=,8+A,8 and Aﬁ~N(0,s§)
x>1<=x+ Ax and Ax~N(0,s§) (5)

where 8%} and 8,2C are proposal variances. An important practical issue
in this step is the scaling of the random walk density. If the proposal
variance of the algorithm is too large, most steps will move into tails of
the distribution and will be rejected. On the other hand, if the variance
is too small, the autocorrelation in the sequence of accepted draws will
be high and convergence to the target distribution will be slow. So
in our implementation, small MCMC trials with different values of
8 are applied to search for an appropriate proposal variance until the
acceptance rate is approximately 15~50% (Roberts and Rosenthal,
2001).

Given the candidate parameters ,8* and x*, calculate the ratio of the
likelihoods of the proposed parameters and current ones.

06 =p(.8*,x* ly,Xs, Ys)/p(,8,xly,Xs, Ys)

(3

V

Y2 (10971710857192
_ s,y
p(ﬁvx|anSaYS)O<KO'_2n-HC€ 202

A A—B


(1+  >
i=1,2,...l’l+k. 

where X5 and Y5 are calibration data, y is the response measurement
whose concentration is to be estimated, K is a constant, n is the number
of calibration data points, k is the number of replicates for the response
measurement.

(4) If 06 > 1, accept ,8 * and x*; if 06 < 1, accept ,8* and x* with probability
05, else reject it.

(5) Return to step 2.

Following a sufﬁcient bum—in period, the chain approaches its stationary
distribution and samples from the MCMC closely approximate ones from the
posterior distribution of parameters and unknown concentrations. Finally, the
posterior means and independent 95% credible intervals from the posterior
marginal densities are computed.

2.3 Implementation

The software implementation of the proposed approach was developed
in C++ for linux and MacOS X and C# for Windows. The source code
and executables for Windows, Linux and MacOS X are available for free

 

709

112 /B.IO'S[BU.IHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

F.Feng et aI.

 

'ﬂﬂlﬂ: -hB.I.1IIInnJuppraL-lu In FIIII'I'III :lrtEallhrmlnnturu mden Emmrmlnm In lmm... 
H I'M?-

 

'“”' _ Irw Emmi-ammo: ﬂ-www
Emu-F" '21:me Mm:

 

‘EMJEI ELM rm: ﬂout-ml:
T-IFF'I' I"”'D"'-*‘ “MI—N 1 Marat-1 1mm 'Hﬂﬁf
um -:11 am. 1:2 1mm 3441:: mm
- swmﬂ am £11.93: 51.. 13 5:11:21 1311-5- 2:11.11
[Lb-II" -.'11-I.I1_I 5.1.. L? mm D 1mm 'Lﬂ’ﬂl
5"“! -'11-n-,.,I 1.11.1 LI." 1111-3 11 u"- “lg-,1;
""""“ m -:I1-:e.l nu? «12m 1202': '5 m:
'- E'I'FTWW cur-1112';- .. line "5."? '50::

I Fm 4|
1' l

 

 

E'HPF'I-“i Val-dim lune “II

 

PL" Flt-rm“- Lunch: Punch“

 

 

 

 

He. 'IL I-LIMH

Fig. 1. Screen Shot of Baesc software. (A) The input control. The input
data are taken in as tab—delimited text ﬁles. The calibration ﬁle contains
standards data and the target ﬁle contains sample measurement data used for
estimation of unknown concentrations. (B) The program log. The log shows
current activities of the program. (C) The output log. It shows the output
results of the curve ﬁtting and estimation of unknown concentrations. (D)
The data display table. It shows the input and output data in a data table
format. (E) The graph panel. It displays the calibration curve ﬁtted using
the Bayesian approach, the validation curve with 95% Bayesian conﬁdence
interval (BCI) and trace plot for the parameter (see more in Supplementary
Fig. S6).

distribution. The Windows version of the program has a simple and intuitive
graphical interface. Figure 1 shows a screenshot of the software, Baesc, and
illustrates its various components. The input of the program is through data
ﬁles. The ﬁtted calibration curve as well as the diagnostic trace plot and
validation plot are displayed on the interface. The results are written to ﬁles
with parameters and estimated concentrations. The Linux and Macintosh
version of the program are run in command line and generate output ﬁles
allowing further analysis such as MCMC diagnostics, hypothesis testing and
the ﬁtting of models for biological processes that regulate the concentration
of the assayed analytes.

3 RESULTS
3.1 Simulated data

In order to validate the approach and test the software
implementation, we ﬁrst ran tests on simulated data. Two types
of simulated data following either the equal variance or unequal
variance model were generated.

To simulate data with equal variance, we followed the model
below,

E(y')—B—I— A_B i 12 n‘

l — —E = 7 7'” 1

(we?)

logolj)~N(log(E(y.-»,az) j=1.2,...k. (7)

where a was a constant, [A, B, C, D, E] =[70000, 20, 1134598,
—1.79, 0.476], n = 8, and k =4. The parameters were chosen based
on experimental data of IL-IOL cytokine measured in a Luminex
assay in our lab (see Supplementary Table S1). Ten concentrations
were selected starting at 1.0 to represent levels typical for the assay

..--..
n
1-._.-r

E:
E E

.1.

z
IngtEst-mated walrus:
"I-

D-

11

3
“i.

 

 

 

 

U

— I

-|.
"-|_r"

E:
E
h-

E
I-

3?
wit

Ing{E Strm :19 Ill valuﬂ]
‘-

lug [E ﬁlm-aim mama:
'p-

 

 

El
'3

 

 

 

 

 

I

3'
"-—-"
El
’_'.
4....-

E
r

E
'1:-

E
l-

IIZIQI[E slim-Bled v alue}
4
‘-
IogtEslimated Value}
3 4
‘11
‘lir

 

 

 

 

 

¢

II:

1b

11
q'-

u

(I

 

 

 

5 ID 15 U

E 4 E El El
11191.11} IngtErme-Lbed value-:1

Z 4 E E
1ng[E:-q'.1£~1:ted ‘JaJu-e]

Fig. 2. Validation of the Bayesian approach and common inverse
approach on simulated data with equal variances. The simulated data
were generated following the ﬁve—parameter logistic model y=20+

70000—20 0.476 with equal variances. Eight concentrations starting
1+( x )il.79
113459

at 1.0 were used and four replicated measurements were simulated for
each concentration. Different variances (02) were used to compare the
performance of two approaches. (a), (b) and (C), 020.5; (d), (e) and (1'),
020.1; (g), (h) and (i), 020.01. (a), (d) and (g), the curve ﬁtting using
the Bayesian approach. The black dotted line is the real logistic function
used to simulate the data. The gray dashed lines are the ﬁtted calibration
curves by the implemented software using the Bayesian approach. The
calibration curves were ﬁtted 25 times and plotted on the same graph. The
open circles are the simulated standard data points used for the calibration
curve estimation. (b), (e) and (h), the validation of unknown concentration
estimation using the Bayesian approach. The graph is on a logarithmic scale,
and the dotted line displays the true concentrations. The circle points are
the estimated unknown concentrations with 95% error. (0), (f) and (i), the
validation of unknown concentration estimation using the common inverse
approach. The triangle points are the estimated unknown concentrations
by the common inverse approach. (‘NA’ means no estimation because
below/above detection limits). The Bayesian estimate were closer to the
line as the data variance went bigger and also gave reasonable estimates at
the extreme low measurements, with the common inverse method failing by
giving no estimate. (See Supplementary Fig. S3 for results on simulated data
with o of 0.95 and 0.001). The non—linear least squares regression was done
in R software (R Development Core Team, 2006).

data. For each concentration, there were four replicates of simulated
measurements. The constant variance 02 with different values was
used to test the robustness of the proposed algorithm.

As shown in Figure 2 and Supplementary Figure S3, different
values of variance 02 were used for simulation, and data were
used for analyses by our approach as well as the common inverse
approach for comparison purpose. The variances used for simulation
were 0.952, 0.52, 0.12, 0.012 and 0.0012 with the real variance
value at a level of 0.01(0.12) as determined from experimental data.
The results showed that with low measurement errors (small 02)

 

710

112 /B.IO'S[BU.IHOIP.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Bayesian approach for immunoassay data analysis

 

Table 2. The SSEs for calibration curve ﬁtting using the Bayesian approach
and common non—linear least squares regression on simulated data

 

Variance level (0) SSE

 

Non—linear least
squares regression

Bayesian approach

 

001 128x107 0174x107
01 3.42x108 5.75><108
0.2 4.83 X 107 6.85 X 108
03 SJOXIW 829fo
05 624X1W 154x160

 

The standards data were simulated with equal variance models based on a ﬁve-parameter
logistic function with different variance levels as in Figure 2. The Bayesian approach
and the non-linear least squares regression were used to estimate the ﬁve-parameter
calibration curve, and SSEs were calculated for comparison. The non-linear least squares
regression was done using the R software (R Development Core Team, 2006).

both approaches worked well on estimation of the calibration curve
and unknown concentrations. With a small variance, although the
common inverse method generated a more precise calibration curve
with smaller sum square errors (SSE; Table 2), it failed on estimation
of extreme measurements. When the variance became bigger, our
Bayesian approach had a better performance on estimation of
the calibration curve (smaller SSEs) and unknown concentrations
(closer to their true values and no ‘below/above detection limit’
values at ends of the curve with extreme concentrations).

The Bayesian approach was also applied to simulated data with an
unequal variance model. The model to generate data was similar to
Equation (7), but following an unequal variance function (Davidian
et al., 1988),

0.- =62E(y.-)9 (8)
where 6 is a scale factor, 6 is the power of the mean responses,
[A, B, C, D, E] =[30.5754, 1.9173, 1.7235, 0.9730], n: 12 and
k = 4.

The parameters were based on the experiment data of an ELISA
assay in Davidian et al. (1988). The simulated data contained 12
concentrations, each with 4 replicated measurements representing
levels typical for assay data. 6 is the average noise level. In the
simulation, it was set to be 0.1 [the actual 6 value in the example
data (Davidian et al., 1988)], 0.3 and 0.5. 6 usually is very nearly
1 for most immunoassays (Dudley et al., 1985). When 6:0, the
variance model [Equation (8)] reduces to an equal—variance model
as we tested in the above section; When 6: 1, the variance is
proportional to the response; When 6 = 2, the coefﬁcient of variation
of the response is constant (Dudley et al., 1985). In the simulation,
different values of 6 (1.0, 1.5, 2.0 and 4.0) were tested to compare
the proposed approach with the common inverse approach.

Figure 3 displays the results of the Bayesian analysis and the
common inverse approach on simulated data generated by the
unequal variance model. The two panels show results for data
generated using 6 of 0.3 and 0.5 (see Supplementary Fig. S4 for
6 = 0.1). For each 6, different 6’s were used to test the performance
of the two approaches. We found that the Bayesian procedure was
able to produce very good estimates for the unknown concentrations
even on the data with unequal variances, indicating that the equal—
variance approximation in this context was reasonable. Furthermore,
compared to the common inverse approach, it worked better

 

ﬂLEﬂJJ 11-1 .11 H “'1 5
3‘“ In} - '3“ lb] :1 3” {El 12’“ {d1
mm .' m “'1‘ ." gin P .- an an
EF {1 :F {a %F f :r E'
‘63 l' B 5’ .e‘ ‘63 .+' B 3‘ .1;
g .- 5 :1 E P E f“
e2 .1: e3 e 11.: I 11: ==
“1 HI- U" H
2:1 I. 2 =- Eﬁ I” 2 card

a D 1.- I—F

1; I:

 

 

 

 

 

IIIIJE'IEI '5 2D

 

 

   

 

 

 

 

 

 

El DUE “115211 Ill DE 1|: 15 ED Ell?! (IE: 1'3 15211
Ing[E:-:pecied valuIBJ lug[E:-cpe1:led 'v'alue]: Iungxpecled value] leIgLExpecbe-u lIl'allllle]
$Zﬂ a

3~£m we a~191 e~1m
in] ,."lI 7% in J” in 1r," a 1.111 5,45-
: I... i r 51- .. Er. :- ,.. ’r :p I... F..-
E: i E :1- “ a 31:1  E :I 1':

1 l i I' 1 i
E'— .- E" 117 EF 3'" E F .5“
e: I e: t e3 .’ e3 f
3:! a!" ED. .331: a?" 3n

= -‘- ‘5

 

I]

 

ELEI [I510 IS 2|) [ID I15 “115 2.3 ELEI I15 1.0 1.5 ED ELI]: 115 1.1] 15 2.11

 

 

 

 

 

 

 

 

 

 

 

IngtEaape-zneu value] In g[E1-cpeeted 1Jennie]: IngEEa-mecleu value] legﬁExpeebed 1venue]
1111 11:11.5 a=1.u =
3314 in} ‘_ §~ IbI ] EN {:1 i. §~
gr: . 2*: a» 1 e ,x - e e
a F 1:- ..E. E r =1
$3  $2 .a: t :1  e :3
_§_ 3* g a E I E
a: ,t e2 e a: r a:
31:. x 3:. 31:. f 3.:
1.- hr -\_r G-
EIIJ U510 15 ED I30 $5 1|] 15 2D 0D D5 'lﬂ 153G 0D DE 1D 152
Ing[E:-:pecbeu valued“ lugiEeretfed Value] lug{E:-cpe:1.el:l value] IugtEm-eefed 'v'alue]
=10
H 111-411
E“ {El 5"“ If} a '2?“ {9} . 3 ‘” {'1} 1.
En :- ﬁuv ," E n __* an n. ,-
; '- .i- } '- ‘Ian : '- r- : '- iﬁ
. 13 .1" a J!
ﬁ-n ,r" “Em {ha 5 w v’ $7: In. up
L3:- lia lgig-=- , ELI:
m tn In:
BEL/7" Bag 2 =1 .11" 2 WIFE
‘D

 

 

 

 

 

 

 

 

 

Ill] [IS ID 1.5 2|]
lungmetIe-d 'v'alue]

Illil 0510 1.5 20 Ill} [151.015 EJII Ill] I15 1.1115 ED

llama-media value] Ing{E1-q1e:1ed ’v'alue] lug{E1-cpetled value]

Fig. 3. Validation of the Bayesian approach and common inverse
approach on simulated data with unequal variances. The simulated data
were generated following the ﬁve—parameter logistic model y=1.91+
% with unequal variances. The variance follows 0282379.
(use) ‘ )
Twelve concentrations starting at 0.1025 were used, and four replicated
measurements were simulated for each concentration. Different values of
8 and 6 were used to compare the performance of two approaches, with
panel (i) 8 = 0.3 and panel (ii) 8 = 0.5 (see supplementary Fig. S4 for 8 = 0.1).
In each panel, (a) and (b) 6 21.0; (c) and (d) 6 = 1.5; (e) and (f) 6 22.0; (g)
and (h) 6 = 4.0. The dotted line in each graph is the true concentrations. The
ﬁlled circles are estimations with 95% error bars by the Bayesian approach,
and triangles are estimations by the common inverse method. The Bayesian
approach could generate reasonable estimates with the common inverse
method failing at the extreme measurements. ( ‘NA’, no estimate due to
below/above detection limit). The non—linear least squares regression was
done in R software (R Development Core Team, 2006).

for extreme measurements. On all simulated data we tested, the
common procedure gave no estimates (‘NA’ as below detection
limits) at either very high or very low responses, whereas the
Bayesian estimates were reasonable and provided appropriately
large uncertainties.

3.2 Experimental data

The Bayesian inference approach was also applied on experimental
data generated from ELISA and Luminex assays. Figure 4 shows
results for two cytokines, TNF—oc by Luminex and IFN—B by ELISA.
The results showed the curve ﬁtting of estimated parameters and
validation of estimated concentrations by the Bayesian approach.
From the graph, we can see that our approach worked very well
with ﬁtted calibration curves and good estimations of unknowns.
We also compared the Bayesian inference with the common inverse
approach on 20 other cytokines measured by ELISA or Luminex
assays (Supplementary Fig. S5). These results consistently indicated
that the Bayesian estimates were more reliable than those of the

 

711

112 /B.IO'S[BU.IHOIP.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

F.Feng et al.

 

IFN-heia validatinn

 

 

 

 

 

 

 

    

C!
C"!
q E
N E 1:11
:1 M
13‘
 1
T E:
m u—
'5':
L11 E
D
1:;
1:!
I] 2 4 EU] LEI 2.0 3.0
IngiCunc] lugflrue value]
1 TNF-a curve fittin TNF-a validation
Cl a Ln
D I
E v—\-
1.1:! g ‘El'
1:; E
E- g m
E ‘3‘ 3
1: a“
El 11:
a EL
I'J- D

 

 

 

 

 

 

4 E B i 2 3 1'-I
Immune] logitrue value]

Fig. 4. Validation of the Bayesian approach on experimental data from
ELISA and Luminex assays. The IFN—B data were from an ELISA assay,
and TNF—OL data were from a Luminex assays. The standards data contained
eight concentrations with two replicated measurements, and data were then
used to estimate the calibration curve by the software implementing the
Bayesian approach. Lines in the curve ﬁtting graphs (left ﬁgures) are the
estimated calibration curve by our approach, and open circle points are
standards data points. Lines in the validation graphs (right ﬁgures) are true
concentrations and points are estimated concentrations with 95% error bar.
(Please see Supplementary Fig. SS for validation of the Bayesian approach
and the common approach on data for other 20 cytokines.)

common inverse approach (Supplementary Fig. S5), especially for
samples with very high and very low concentrations.

In summary, our Bayesian method produced better results than
the common inverse approach on both equal and unequal variance
simulated data and biological experimental data. The Bayesian
method was especially good at processing noisy data. This is
signiﬁcant considering the proliﬁc use of immunoassays and the
fact that even realistic experimental concentrations can carry high
variances. The experimentally relevant variance values for the
logarithmic transformed data are 0.01 (a2 20.12) based on our
observations as well as others (Bienvenu et al., 1998; Fichorova
et al., 2008). This level of variance is equivalent to the coefﬁcient of
variation (CV) of 10% for the non—transformed data. The commonly
accepted reliability criteria for immunoassays is set as an intraassay
CV <20% (Bienvenu et al., 1998; Fichorova et al., 2008). A dataset
with this CV value has a variance of about 0.22 (a2 20.22) after the
natural logarithmic transformation. As shown in Table 2, at the level
of 02 20.22 and above, our approach outperforms the non—linear
least squares with a smaller SSE. Furthermore, depending on the
type of assays and the manufacturer of kit reagents, the proportion
of measurements with an intraassay CV >20% can go up to 25%
(Fichorova et al., 2008). Clearly methods such as our Bayesian
approach are necessary to those data with high variances, where
the normal approach could fail.

Furthermore, the proposed Bayesian approach can be easily
extended for a wide range of applications. For example, the proposed

model by the Bayesian approach with its estimated uncertainty
in calibration curves and target measurements can be used as a
lower level in the hierarchical Bayesian models (Gelman et al.,
2004) that integrate a sampling likelihood to compare cytokine
concentrations across treatment groups, measurements on different
experiment days or even with different assays. Such a model would
correctly incorporate the calibration uncertainties and beneﬁt the
following inference. Another possible application is the Bayesian
non—parametrics (such as mixtures of Polya trees) (Christensen et al.,
2008) to further relax assumptions on the prior distributions of
parameters of the model.

REFERENCES

Bienvenu,J.A. et al. ( 1998) Cytokine assays in human sera and tissues. Toxicology, 129,
55—61.

Christensen,R. et al. (2008) Parametric nonparameteric statistics. Am. Stat, 62, 296—306.

Conlon,E.M. et al. (2007) Bayesian meta-analysis models for microarray data: a
comparative study. BMC Bioinformatics, 8, 80.

Davidian,M. and Giltinan,D.M. (1995) Nonlinear Models for Repeated Measurement
Data. Chapman and Hall, London.

Davidian,M. et al. ( 1988) Variance functions and the minimum detectable concentration
in assays. Biometrika, 75, 549—556.

Dellaportas,P. and Stephens,D.A. (1995) Bayesian analysis of errors-in-variables
regression models. Biometrics, 51, 1085—1095.

Dudley,R.A. et al. (1985) Guidelines for immunoassay data processing. Clin. Chem,
31, 1264—1271.

Fichorova,R.N. et al. (2008) Biological and technical variables affecting immunoassay
recovery of cytokines from human serum and simulated vaginal ﬂuid: a multicenter
study. Anal. Chem, 80, 4741—4751.

Finney,D.J. and Phillips,P. (1977) The form and estimation of a variance function, with
particular reference to radioimmunoassay. Appl. Stat, 26, 312—320.

Frigessi,A. et al. (2005) Genome-wide estimation of transcript concentrations from
spotted cDNA microarray data. Nucleic Acids Res., 33, e143.

Gelman, A. et al. (2004a) Bayesian Data Analysis. Chapman&Hall/CRC, Boca Raton,
FL, USA.

Gelman,A. et al. (2004b) Bayesian analysis of serial dilution assays. Biometrics, 60,
407—417.

Gottschalk,P.G and Dunn,J.R. (2005) The ﬁve-parameter logistic: a characterization
and comparison with the four-parameter logistic. Anal. Biochem., 343, 54—65.
Harris,A.S. et al. (1998) Development and application of immunoassys for biological
and environmental monitoring. In Cech, J.J. Jr et al. (eds) Multiple Impacts on

Ecosystems. Lewis Chelsea, MI, USA, pp. P135—P153.

Hennion,M.-C. and Barcelo,D. (1998) Strengths and limitations of immunoassays for
effective and efﬁcient use for pesticide analysis in water samples: a review. Anal.
Chim. Acta, 362, 3—34.

Higgins,K.M. et al. (1998) The effect of serial dilution error on calibration inference in
immunoassay. Biometrics, 54, 19—32.

Landsteiner,K. (1990) The Specificity of Serological Reactions. Harvard University
Press, Cambridge, MA, USA.

N g,P.C. et al. (2003) Proinﬂammatory and anti-inﬂammatory cytokine responses in
preterm infants with systemic infections. Arch. Dis. Child Fetal Neonatal Ed., 88,
F209—F213.

Oellerich,M. (1980) Enzyme immunoassays in clinical chemistry: present status and
trends. J. Clin. Chem. Clin. Biochem., 18, 197—208.

R Development Core Team (2006) R: A Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Roberts,GO. and Rosenthal,].S. (2001) Optimal scaling for various Metropolis-
Hastings algorithms. Stat. Sci., 16, 351—367.

Sivaganesan,M. et al. (2008) A Bayesian method for calculating real-time
quantitative PCR calibration curves using absolute plasmid DNA standards. BMC
Bioinformatics, 9, 120.

Yalow,R.S. and Berson,S.A. (1959) Assay of plasma insulin in human subjects by
immunological methods. Nature, 184 (Suppl. 21), 1648—1649.

Yalow,R.S. and Berson,S.A. ( 1960) Immunoassay of endogenous plasma insulin in man.
J. Clin. Invest, 39, 1157—1175.

 

712

112 /B.IO'S[BU.IHOIP.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

