Bioinformatics, 31 (21 ), 2015, 3514—3521

doi: 10.1093/bioinformatics/btv397

Advance Access Publication Date: 2 July 2015
Original Paper

 

Genetics and population analysis

A multivariate Bernoulli model to predict
DNasel hypersensitivity status from
haplotype data

1 ,2,3

Huwenbo Shi1'*, Bogdan Pasaniuc '* and Kenneth L. Lange1'3'4

1Bioinformatics Interdepartmental Program, University of California, Los Angeles, 2Department of Pathology and
Laboratory Medicine, 3Department of Human Genetics and 4Department of Biomathematics, David Geffen School
of Medicine, University of California, Los Angeles, Los Angeles, CA 90024, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on February 17, 2015; revised on May 18, 2015; accepted on June 24, 2015

Abstract

Motivation: Haplotype models enjoy a wide range of applications in population inference and dis-
ease gene discovery. The hidden Markov models traditionally used for haplotypes are hindered by
the dubious assumption that dependencies occur only between consecutive pairs of variants. In this
article, we apply the multivariate Bernoulli (MVB) distribution to model haplotype data. The MVB
distribution relies on interactions among all sets of variants, thus allowing for the detection and ex-
ploitation of long-range and higher-order interactions. We discuss penalized estimation and present
an efficient algorithm for fitting sparse versions of the MVB distribution to haplotype data. Finally,
we showcase the benefits of the MVB model in predicting DNasel hypersensitivity (DH) status—an
epigenetic mark describing chromatin accessibility—from population-scale haplotype data.

Results: We fit the MVB model to real data from 59 individuals on whom both haplotypes and DH
status in lymphoblastoid cell lines are publicly available. The model allows prediction of DH status
from genetic data (prediction R2 = 0.12 in cross-validations). Comparisons of prediction under the
MVB model with prediction under linear regression (best linear unbiased prediction) and logistic
regression demonstrate that the MVB model achieves about 10% higher prediction R2 than the two
competing methods in empirical data.

Availability and implementation: Software implementing the method described can be down-
loaded at http://bogdan.bioinformatics.ucla.edu/softwarel.

Contact: shihuwenbo@ucla.edu or pasaniuc@ucla.edu

 

1 Introduction

 

Accidents of history and variable recombination rates have divided
the human genome into blocks of shared recent ancestry (1000
Genomes Project Consortium et al., 2010; Daly et al., 2001; Gibbs
et al., 2003). Ancestry sharing manifests itself in complex haplotype
patterns and strong dependencies among variants. [Recall that a
haplotype summarizes the sequence of alleles displayed by the
sampled markers in a narrow genomic region of a particular chromo-
some (Kruglyak, 1999).] Therefore, modeling haplotype data is of
paramount importance for a wide range of problems in population

genetics and disease gene discovery (Chung et al., 2013; Howie et al.,
2012, 2009; Lawson et al., 2012; Li et al., 2010; Lohmueller et al.,
2009; Marchini et al., 2007; Morris, 2006; Pasaniuc et al., 2009; Pool
et al., 2010; Price et al., 2009; Savage et al., 2013; Templeton, 2005).
Haplotypes have been traditionally analyzed by hidden Markov
models (HMMs) (Li and Stephens, 2003; Yang et al., 2014), with
emissions corresponding to observed genotypes and transitions to re-
combination events. Although HMMs for haplotypes undergird
many efficient and accurate algorithms for haplotype phasing (Scheet
and Stephens, 2006), genotype imputation (Browning and Browning,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3514

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq IIIOJJ pepeolumoq

Multivariate Bernoulli haplotype model

3515

 

2007; Howie et al., 2009; Li et al., 2010) and identity-by-descent de-
tection (Browning and Browning, 2011), they suffer from the draw-
back of modeling only dependencies between consecutive variants.
This assumption leads to the unrealistic conclusion that the previous
variant and the next variant are independent given the current vari-
ant. Ignoring dependencies among non—consecutive markers makes it
difficult to detect and exploit long range correlations and higher-
order interactions among variants. These complex dependencies def-
initely exist in the human genome and are important factors in gen-
etic studies (Price et al., 2008; Wall and Pritchard, 2003).

This article applies the multivariate Bernoulli (MVB) distribution
to haplotype data. The MVB distribution captures the entire spec-
trum of dependencies among the entries of random binary vectors of
length N (Dai et al., 2013). The observed haplotypes at N nearby sin-
gle-nucleotide polymorphisms (SNPs) can be thought of as realiza-
tions of such a process. Since there are 2N possible haplotypes for N
SNPs, the MVB distribution requires an unsustainable exponential
number of parameters. Vast amounts of training data or clever algo-
rithms cannot compensate for this combinatorial explosion. Here, we
investigate a Poisson re-parameterization of the MVB distribution
and impose an £1-norm penalty to enforce sparsity in parameter esti-
mation. These steps allow us to devise an efficient coordinate ascent
algorithm for learning the MVB parameters from haplotype data
while restricting the number of parameters to a manageable level.

We showcase the utility of the MVB model by predicting an indi-
vidual’s DNaseI hypersensitivity (DH) status from haplotypes
observed near known DH sites. DH status is a mark of open chro-
matin and ﬂags genomic regions where the DNA is accessible to the
DNaseI enzyme. These regions, such as transcription start sites, cor-
relate with active DNA regulation. DH status is usually assayed
through DNase-Seq, a genome-wide high-throughput technology
that sequences genomic regions sensitive to DNaseI (Madrigal and
Krajewski, 2012). Recent research (Degner et al., 2012) suggests
that genetic variants control this epigenetic mark. Since DH status
can be naturally encoded as a binary variable, the MVB model offers
a natural way to integrate DH status and local haplotype data. In
predicting DH status from haplotypes, the MVB model allows all al-
lelic sets to contribute regardless of the order of the participating
SNPs and the physical distances separating them.

Our analysis of data from the 1000 Genomes project
(1000 Genomes Project Consortium et al., 2010) demonstrates the
superiority of the sparse MVB distribution in model fitting. In prac-
tice, interactions beyond order three play little role in determining
haplotype frequencies in these data. Our new cyclic coordinate des-
cent algorithm for estimating the MVB interaction parameters con-
verges quickly and reliably. The MVB model also turns out to
be pertinent to predicting DH status from haplotype data at
known DH sites (de los Campos et al., 2013). On a sample of just
59 subjects, cross-validation under the MVB yields a prediction R2
of 0.12 for dichotomized DH levels. As expected, the accuracy of
DH prediction decreases as extraneous predictors are added. Finally,
prediction under the MVB achieves about 10% better accuracy than
prediction by linear regression (best unbiased linear predictor or
BLUP) and logistic regression. Thus, the MVB model is recom-
mended for prediction of binary epigenetic status from local haplo-
type data.

2 Methods
2.1 The MVB distribution as a model for haplotype data

The MVB distribution extends the univariate Bernoulli distribution
to binary vectors of fixed length N (Dai et al., 2013). The density

Pr(Y = y) = p(yl,___,yN) of such a discrete random vector Y depends
on 2N probabilities p(0,0,___,0), p(0,0,___,1),  , p(1,1___,1) specific to
the different realizations of Y. For example, the bivariate Bernoulli
distribution consists of four realizations (0, 0), (0, 1), (1, 0) and (1,
1) specified by four probabilities p(0,0),p(0,1),p(1,0) and p04). By
definition, the conditional distribution of a subvector, say
(Y1, Y2,  ,Yk), given the complementary subvector, say
(Yk+1, . . . , YN), is also MVB. In the bivariate case, conditioning on
either Y1 or Y2, produces a standard univariate Bernoulli distribu-
tion. There is an alternative parameterization that captures inter-
actions and is conducive to parsimony. This parameterization
substitutes subsets of {1, . . . ,N} for binary vectors. To the realiza-
tion y, we correspond the index set A = {i : y,- = 1}. The natural
parameters fc of the MVB model are indexed by interaction subsets
C, and the density function Pr(Y = y) is written as the ratio

exp < Z fc)

CgA eXP(SA)

ex : Zexp(SB)’
ZR: P<CZg33fC) B

where we define SA 2 ZCQA fc for notational simplicity. The de-

 

Pr(A) =

nominator EB exp(SB) is the appropriate normalizing constant.

The haplotypes spanning N bi-allelic SNPs can be represented
as binary vectors of length N. We adopt the convention that 31,-: 0
indicates the major allele and 31,-: 1 indicates the minor allele at
SNP 2'. One can obviously model the distribution of haplotypes in
a population as MVB. The major advantage of the MVB is its
ability to incorporate interactions in the recovery of haplotype
frequencies. The number of parameters in both the naive and inter-
action parameterizations grows exponentially fast in N. However,
the interaction parameterization organizes interactions by level
and suggests limiting model complexity by imposing an upper
bound on interaction level. The next section introduces a lasso pen-
alty that in combination with maximum likelihood estimation elim-
inates superfluous interactions and keeps the number of levels in

check.

2.2 Estimating MVB parameters from haplotype data

To estimate haplotype frequencies and ultimately infer missing
haplotypes, one can randomly sample a population and count the
number X A of haplotypes of each type A. For a fixed sample size M,
the X A jointly follow a multinomial distribution with M total counts
and the count probabilities Pr(A) displayed in Equation (1).
Alternatively, one can adopt a Poisson rather than a multinomial
sampling framework. The two share the assumption of independent
samples but differ in whether the total sample size is random
(Poisson) or fixed (multinomial). The law of small numbers justifies
the equivalence of the two frameworks. The Poisson setting invokes
a mean sample size M, which is estimated by the observed sample
size EA X A. One can show (Lange, 2010) that the random variables
X A are independent and Poisson distributed with means
MA = #131114)-

In the Poisson framework, it is easier to work with the inter-
action parameters by setting MA = exp(SA) = exp(ZBgA f3) and
ignoring u and the normalizing constant EB exp(SB). In effect, these
are absorbed into the empty set parameter qu. Independence of the
X A now yields the likelihood

 

£(fIX) —H(“A)XA <— > <2)
_ A  exp au’A’

9mg ‘09 isnﬁnV uo sejeﬁuV soq ‘erulomeg JO AirSJQAru [1 112 [3.10811211an[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 IIIOJJ pepeolumoq

3516

H.Shi et al.

 

where X = (XA) and f = (fA) are the vectors of haplotype counts
and interaction parameters, respectively. Taking logarithms pro-
duces the log likelihood

£(f|X) = Z fA 2 X3 — Z exp(SA) — ZlogXAl. (3)
A A

BQA A

It is natural to estimate the MVB parameter vector f = (fA) by maxi-
mizing E(f|X) .

Unless N is small and the sample size M is large, estimating all
2N MVB parameters is an exercise in over-fitting. To achieve parsi-
mony, we append an El-norm (lasso) penalty to the log likelihood.
Any reasonable model should include the low-order parameters fA
with |A| S 1, where |A| denotes the cardinality of the set A. Hence,
we maximize the penalized log likelihood

F(f) = ZfA 2 X3 — ZCXP(SA) — ll 2 lfAl- (4)
A

BQA A |A|22

Here, 2 is a tuning constant determining the strength of the pen-
alty. Increasing 2 increases the sparsity of the estimated parameter
vector. The analogy with lasso-guided regression is obvious. The
new objective function F(f) is concave and directionally differenti-
able. It has kinks introduced by the terms |fA|. We recommend maxi-
mization by coordinate ascent.

2.3 Coordinate ascent algorithm

Coordinate ascent maximizes the objective function one parameter
at a time holding other parameters fixed. Cycling through the par-
ameters continues until the objective value converges or a maximum
number of iterations is reached. Algorithm 1 outlines the coordinate
ascent algorithm for estimating model parameters.

 

Algorithm 1 coordinate ascent algorithm for fitting the MVB

 

1: Let C be the collection of possible haplotypes of length N
2: Initialize fA to 0 for all A E C

3: While stop condition fails do

4: for A in C do

5: fA : arg mafoF(f)

6: end for

7: end While

 

Line 5 of Algorithm 1 requires finding arg mafoF To update
fA when |A| S 1, we set the partial derivative of F(f)

iF<f> = 2 X3 _ efA Z eZCgB,C7éAfC (5)

WA BQA BQA

with respect to fA equal to 0. This yields the update

ZXB

=m——3%L———a 6
fA Z eECgB,C7éAfC ( )
BQA
When |A| 2 2, the supergradient
‘9 E f
_F(f) 2 X3 _ efA e CgB,C7éA C
an  
1 'f
1 fA > 0 (7)

—,1 [—1,1] if fA = 0

—1 iffA<0

must contain 0 (Lange, 2013). Equating it to 0 yields the update

 

0 |c|§2
ln ZBQAXB—l c>2
fA : ZBQAeZCQB,C#AfC 
X xi
ln 232A 3+ c< —2

 

233A eZCQB,C#A (C

for the criterion c = ZBQAXB — 232A eZCQBaczéA fC.

In view of the summations over B 2 A in the denominators of
Equations (6) and (8), each coordinate ascent update takes nearly
O(2N) operations. This computational load restricts estimation to
MVB models with small N, say N S 15. Once parameters are esti-
mated, prediction under the MVB is relatively straightforward. The
normalizing constant in formula (1) must be calculated, but this can
be done once and the result stored.

2.4 Best linear unbiased predictor

Part of our evaluation of the MVB involves comparison of DH pre-
diction on simulated data. The simulated DH status y,- of an individ-
ual i was constructed as a linear combination of individual i’s SNP
alleles and SNP pairwise interactions weighted by effect sizes [3,- and
[fl-k. In symbols

3);" = 2 [Why + Z ﬁjkhi/hik + 8i, (9)
i flak}

where hi,- is the SNP predictor (standardized version of 0 or 1) of in-
dividual i at SNP j, hiihik is the SNP interaction of individual i for
the pair of SNPs j and k and a,- is an independent normally distrib-
uted error term. Simplified versions of the model ignore the pairwise
interactions and take all [fl-k = 0.

To make predictions under the linear model, we first estimate
the effect sizes ﬂ,- and [fl-k from training dataset and then predict the
phenotype (DH status) of each individual in the test data, substitut-
ing estimated parameters for true parameters. For notational brev-
ity, let H = (HSNp,H1NT) be the block matrix of single SNP and
interaction SNP predictors across the training set; for each subject 2'
and SNPs j and k, the matrix HSNP has entries (kg) and the matrix
HINT has entries (hiihik). The effect sizes [3,- and ﬁik are estimated by
the least squares formula

[2 = (HTH)_1HTy. (10)
Finally, the BLUP )7,- of DH status for an individual i is computed via

371' = Zﬁjhii + Zﬁjkhiihik- (11)
i flak}

2.5 Logistic regression (LOGIT)

We also compared the MVB model with logistic regression
(LOGIT); unlike linear regression, logistic regression directly models
binary outcomes. Under logistic regression, the probability of the
DH status y,- of individual 2' given his/her SNP alleles (hi) and pair-
wise interactions (hil-hik) is

es,- y 1 1—y
Pr(Yz‘ = 3’) = (1 +661.)  y (12)

where c,- = a0 + Zia/hi,- + 2W2} ocI-khil-hik. Here the oc’s are the re-
gression coefficients in logistic regression. As with linear regression,

 

one can simplify the model by ignoring pairwise interactions and

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q 111011 pepeolumoq

Multivariate Bernoulli haplotype model

3517

 

taking all Otik = 0. To estimate the parameters of the model, one
maximizes the likelihood

66‘ H 1 
{ion-=1}1 + eci{i=yi=0}1 + 6“
over the entire sample. Prediction of the DH status of individual i
relies on the predicted probability

eai
_ 1 +651”

A

yi (14)
of 31,-: 1, where 8,- is the same as c,- except for substitution of esti-
mated regression coefficients for true coefficients.

2.6 HMM for haplotypes

An HMM views a haplotype h of length N as a mosaic of haplotypes
from a set H of R reference haplotypes (Li and Stephens, 2003). The
N X R HMM states (2', 7') capture the particular reference haplotype j
occurring at SNP i. A transition matrix K models recombination
events and controls how switches occur between haplotypes in mei-
osis. The entries K[(z'j), (121)] of the transition matrix are 0 unless
k = i+ 1. For neighboring SNPs, the entries depend on the distance
between the SNPs. Thus, the larger the distance, the larger the tran-
sition probability for j 75 l. The emission probabilities Pr(h,|(ij))
allow for mistyping and occasional mutation events. Inferences
based on HMM are achieved efficiently through the forward, back-
ward and Viterbi algorithms, all of which have complexity O(NR2).
We adopt the latest IMPUTE2 (Howie et al., 2009, 2012) imple-
mentation of HMM for comparison purposes.

3 Results
3.1 Assessment of MVB on 1000 genome haplotypes

In an initial set of experiments, we used the 1000 Genomes EUR
(European) haplotypes (505 individuals) to investigate the perform-
ance of the MVB model and our coordinate descent algorithm for
fitting it to data. We randomly selected 50 regions on chromosome
1, each containing 15 SNPs and fit the MVB under various settings.
The first setting imposed no constraint on the maximum order
(max |A|) of the interaction sets A. Thus, in effect, we estimated all
215 = 32 768 parameters. Figure 1 shows that the regularization
constant 2 has a significant effect on the magnitude of parameters,

 

 

 

 

 

 

120

'6

2

o 100-

L0

E

o 80'

a +1=o.o
g 60- +7c=0.5
a +1=1 .o
E“

“5

E

:5

(D

   

w:

‘9
\

_ _‘ M

' 1: r g [_
8 9101112131415

 

1 2 3 4 5 6
order of interaction (|A|)

Fig. 1. Sum of |1§4|’s averaged over 50 regions as a function of |A|

especially for fA’s where |A| 24. For example, as 2 increases from
0.0 to 0.5, the sum ZIAI=4 |fA| of estimated parameters decreases
from 87.5 to 30 for interaction sets with |A| = 4. Furthermore,
Figure 2 indicates that the average value of |fA| converges to 0 as |A|
tends to N =15. Thus, we conclude that the lower-order inter-
actions fA predominate in determining haplotype frequencies.

Next we investigated how well the MVB fits the selected 1000
Genomes haplotypes using just lower-order interactions. To meas-
ure goodness of fit, we computed the Euclidean distance between
the haplotype frequencies recovered by the MVB model as given in
Equation (1) and the haplotype frequencies observed in the data.
Table 1 demonstrates that the MVB model requires only the lower-
order interactions terms to accurately fit typical data. Because 2
= 0.25 attains the best fit across interaction level bounds (|A| S b),
we set 2 to 0.25 in all future experiments.

We also recorded the number of iterations until convergence of
the coordinate descent algorithm. The algorithm invariably con-
verges within 20—30 iterations. See Figure 3 for typical results.
Finally, Table 2 lists that the bulk of computational time is taken in
estimating MVB parameters; once model parameters are estimated,
applying the model to making predictions is relatively trivial.

3.2 Prediction of DH status in simulations

To simulate binary DH data, we took the 1010 EUR (European)
haplotypes of the 1000 Genome project (1000 Genomes Project
Consortium et al., 2010) and simulated 20 000 haploid individuals
at 200 randomly selected 20 kb regions on chromosome 1 (Su et al.,
201 1). From each region, we selected 15 SNPs with minor allele fre-
quency above 1%. From the 15 chosen SNPs, we randomly selected

 

 

 

 

 

mean of |fA| averaged over 50 loci

 

 

 

12 3 4 5 6 7 8 9101112131415
order of interaction (|A|)

Fig.2. Mean of |fA|’s averaged over 50 loci as a function of |A|
Table 1. Euclidean distance between haplotype frequencies re-

covered by the MVB model and haplotype frequencies observed in
data for different values of max |A| and ,1

 

Max |A| No. param. 2

 

0.0 0.25 0.5 0.75 1.0

 

1 16 0.348 0.348 0.348 0.348 0.348
2 121 0.137 0.072 0.073 0.074 0.075
3 576 0.120 0.054 0.055 0.056 0.056
4 1941 0.120 0.055 0.056 0.057 0.058

 

Bold values indicates the column attaining the best ﬁt for the MVB model.

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[p101x0'831112u1101utotq/ﬁd11q 111011 pepeolumoq

 

 

 

 

 

 

 

 

 

 

 

 

 
 
 
 
  
 
 
    
   

 

 

 

 

 

 

 

3513 H.Shi et al.
4500 hit=0.1, training sample size = 100
0.18 .
4000 —o— MVB (|A| g 2, ,\ = 0.25)
o16_-e—MVB(|A|§3,A=0.25) i
' —x— LOGIT (SNP)
3500 — + — LOGIT (SNP & INT)
g (R 0'14 ' -—u— - LOGIT (SNP & ADJ) I
T; 3000 C HMM
a) +|A| < 2, A = 0.25 .2 0-12' —°—BLUP (2111086 ) -
.2 _ _ .2 — + —BLUP NP INT
E 2500— VHS?” )‘TO'25 E 01_ -—<—-BLUP(SNP&ADJ) _
'3 3
° 2
2000- _ E 0.08 _
«>1:
0.06 -
1500- -
0.04 _
1000 ' ' ' '
0 10 20 30 40 50 I
iteration 0-020 0'1 0'2 0'3 0'4
h2

Fig. 3. Objective value averaged over 50 loci at each iteration of the coordin-
ate ascent algorithm for different values of max |A|

Table 2. Learning time (second per iteration) and prediction time
(second per prediction), averaged over 50 loci

 

 

Max |A| Learning (sec/iter) Prediction (sec/pred)
1 0.2 <0.01
2 1.1 <0.01
3 4.4 0.01
4 13.7 0.02

 

m causal SNPs and 11 pairs of interaction SNPs and simulated con-
tinuous DH values according to the linear model sketched in Section
2.4. Prior to simulation, we standardized the SNP predictors hi,- and
hiihik to have mean 0 and variance 1. The regression coefficients for
the causal SNPs and SNP pairs were sampled as [1,- ~ N(0,h2
and [fl-k N N (0, hiznt / n) and the noise for each DH variable as
e,- N N(0, 1 — (h2 + hilt», where (72 and hiznt denote the variance of
DH values explained by single variants and interactions, respect-
ively. Finally, we converted the continuous DH values to binary DH
values by imposing a threshold chosen so that 20% of the binary
DH values were elevated (status 1 rather than status 0).

For testing under the MVB model, we constructed binary vectors
of length 16 by concatenating each 15-SNP haplotype and a corres-
ponding simulated binary DH status. Given the tuning constant
2 = 0.25, this allows us to estimate the fA parameters. To predict
DH status given observed SNP haplotypes, one simply computes a
conditional probability under the MVB model. In one set of MVB
trials, we limited the interaction level to |A| S 2, for a total of 137
parameters. In a second set of trials, we limited the interaction level
|A| S 3, for a total of 697 parameters. One can compare MVB pre-
diction to BLUP and LOGIT prediction based on the same SNP
haplotypes and interaction model. For BLUP and LOGIT, we also
tested a model involving SNPs and interactions between adjacent
SNPs.

In linear regression, Equation (10) supplies effect sizes, and
Equation (11) supplies predicted values. In logistic regression,
Equation (14) supplies predicted values. For estimation and predic-
tion under HMM, we concatenated DH status as a pseudo SNP at
the end of each 15-SNP haplotype to avoid changing the SNP inter-
actions in the original haplotype. We also set the physical distance
between the pseudo SNP and the last SNP to be the average distance
between consecutive pairs of SNPs in the original 15 -SNP haplotype.

Fig. 4. Prediction R2 across 100 validation individuals averaged over 200
regions for MVB, BLUP, LOGIT and HMM as a function of h2 when hi2nt is
fixed at 0.1

We employed half of the simulated individuals as reference panel
and ran HMM with IMPUTE2 default settings on the other half to
obtain predicted DH status. All 200 simulations summarized below
involve two causal SNPs (m =2) and two causal SNP interactions
(11 = 2) for 200 randomly sampled individuals. Of these 200 people,
100 served as training individuals and 100 as validation individuals.

We first investigated performance of MVB, BLUP, LOGIT and
of 0.1.
Figure 4 shows that prediction R2 achieved by all models increases

HMM prediction for varying (72 for a fixed interaction hiznt
as (72 increases. However, the MVB model consistently achieves
higher prediction R2 than BLUP, LOGIT and HMM under both
settings, suggesting that the MVB model is capable of yielding more
accurate estimates of effect sizes for prediction. Notably as (72 in-
creases, the improvement in prediction R2 also increases. In other
words, as the effect of a single SNP increases, the comparative ad-
vantage of the MVB model over BLUP, LOGIT and HMM
increases.

Next we investigated the accuracy of these approaches at varying
hiznt values. Figure 5 demonstrates that for all pairs of (72 and hiznt, the
MVB model also achieves higher prediction R2 than BLUP, LOGIT
and HMM.

Finally, we investigated the number of samples required for ac-
curate prediction. Figure 6 shows that although the MVB model re-
quires more parameters than BLUP, LOGIT and HMM, it is able to
outperform these models even if the training sample size is small.
This suggests that the MVB model is less sensitive to noise. Notably,
HMM under-performs both MVB and LOGIT in most simulation
settings, suggesting that HMM is less capable of detecting long
range interactions for reasonable sample sizes. Across all simulated
datasets, we observe no major difference in prediction R2 between
the two MVB settings. This is to be expected since only pairwise
interactions are simulated.

3.3 Predicting DH status in empirical data

We now turn to real data on DH status and reach similar conclu-
sions. The dataset in question (Degner et al., 2012) contains normal-
ized DH scores for 70 YRI (Yorubas in Ibadan, Nigeria) individuals
at 1.5 million 100-bp genomic windows. These windows cover the

910z ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[p101x0'831112u1101utotq/ﬁd11q 111011 pepeolumoq

Multivariate Bernoulli haplotype model

3519

 

h2=0.1, training sample size = 100

 

  
 
  
  
 
    
   

 

 

 

 

 

 

 

 

_ —‘— MVB (|A| S 2, A = 0.25)
014 - e - MVB (|A| s 3, /\ = 0.25)
—x— LOGIT (SNP)
o_12 - — + — LOGIT (SNP & INT)
-—u— - LOGIT (SNP & ADJ)
6'55 HMM
E 0.1 — —°—BLUP (SNP)
1.3 — + — BLUP (SNP & INT)
3 -—<— - BLUP (SNP & ADJ)
o. 0.08 _
0.)
C»
E
g 0.06 _
0.04 _
i
I
0.02 - I I I _
0 0.1 022 0.3 o_4
h.

Int

Fig. 5. Prediction R2 across 100 validation individuals averaged over 200 re-
gions for MVB, BLUP, LOGIT and HMM as a function of hi2nt when h2 is fixed
at 0.1

h2=0.3, h.2 =o.3
Int

 

 

    
 

 

 

 

 

 

 

0.24
r
0.23 -
0.22 -
“d:
c 0.21 -
.9
§ 0.2 - . 1
a —.— MVB (|A| g 2, A = 0.25) _
3%,0-19‘ — e — MVB (|A| g 3, ,\ = 0.25)
a —x— LOGIT (SNP)
E 0'18' — + — LOGIT (SNP & INT)
-—n— - LOGIT (SNP & ADJ)
0.17 - HMM
1 —o— BLUP (SNP)
0.16- — + — BLUP (SNP & INT) '
-—4— - BLUP (SNP & ADJ)
0.15 ' '

 

50 100 150 200 250 300 350 400 450 500
training sample size

Fig. 6. Prediction R2 across validation individuals averaged over 200 regions
for the MVB, BLUP, LOGIT and HMM as a function of training sample sizes
when h2 and h? are both fixed at 0.3

Int

5% of the human genome with the highest DNaseI sensitivity.
About half of the windows are expected to be truly sensitive to
DNaseI (Boyle et al., 2008); 8902 windows have associated dsQTLs
[SNPs showing significant correlations with DH scores across indi-
viduals (Degner et al., 2012)]. We dichotomized DH scores by plac-
ing scores above the threshold of 0.0 in one category and scores
below the threshold of 0.0 in the complementary category. Among
the 70 YRI individuals in the sample, 59 are also in the 1000
Genome project (1000 Genomes Project Consortium et al., 2010)
and have fully phased haplotypes. We accordingly used the haplo-
types and the binary DH status of these 59 individuals to evaluate
the MVB model. For computational reasons, we selected one haplo-
type for each individual and restricted our analysis to 250 random
DH sites and the 377 DH sites with associated dsQTLs on chromo-
some 22.

In genomic windows with associated dsQTLs, the dsQTLs are
on average about 8000 base pairs (10 SNPs) away from their win-
dows. This action at a distance renders it difficult for HMMs to ac-
curately capture interactions between dsQTLs and their genomic

windows. Because sequence order is an important factor for HMMs,
the question also arises of where to place binary DH status (a
pseudo SNP) in the haplotype. For this reason, we excluded HMM
from comparisons on real data.

To avoid over-fitting, we assessed prediction accuracy by leave-
one-out cross-validation. Thus, we estimated parameters using data
from 58 (all but one) training individuals and predicted DH status
for the remaining validation individual. Repeating this process
across all 59 individuals allowed us to compare predicted and true
DH status. The results can be summarized in a squared Pearson cor-
relation (prediction RZ). Prior to parameter estimation in each of the
59 folds, we selected a small number of relevant SNP predictors by
linear regression and forward selection. Our selection procedure
excluded SNPs with minor allele frequency below 1% or at a dis-
tance of 1 Mb or greater from the center of the window. Each suc-
cessive SNP entering the candidate list provided the greatest
reduction of the current residual sum of squares.

Given a candidate set of SNP predictors P in the MVB model,
we created binary haplotype vectors of length |P| + 1 from the
SNPs and the binary DH status. We considered at most second-
order interactions and set the penalty constant A to 0.25. For BLUP
and LOGIT, we considered three models, one limited to single
SNPs, one involving both single SNPs and two-way interactions and
one involving single SNPs and only interactions between adjacent
SNPs.

Figure 7a shows the prediction R2 obtained through leave-one-
out cross-validation averaged over the 250 randomly selected win-
dows. Because of overfitting and our small sample size, the average
prediction R2 decreases for all methods as the number of predictors |
P| increases. The MVB model achieves higher prediction R2 than
BLUP and LOGIT over both settings. We repeated the same experi-
ment on the 377 windows with associated dsQTLs. Again the MVB
model consistently achieves higher prediction R2 than BLUP and
LOGIT (Fig. 7b). Figure 7c and d depict the distribution of predic-
tion Rz’s under each model. It is clear that the MVB models achieve
more high prediction Rz’s (greater than 0.2) than BLUP and LOGIT.
One can legitimately conclude that the MVB model predicts DH sta-
tus better than BLUP and LOGIT. Table 3 summarizes the average
and standard error of prediction R2 for some representative
experiments.

4 Discussion

This article presents the MVB distribution as a vehicle for modeling
haplotype data. Because the number of distinct haplotypes observed
in a narrow genomic region tends to be small, the MVB model is
typically wildly over-parameterized. To achieve parsimony, we pro-
pose a lasso penalty within a Poisson sampling framework. The
penalized MVB model encourages the detection and exploitation of
higher-order interactions among the underlying SNPs. In contrast to
Markovian models, interactions extend beyond nearest neighbor
and pairwise interactions. The interaction parameterization adopted
here is more natural than the naive MVB parameterization implicitly
seen in BLUP and LOGIT. Empirically, the interaction parameter-
ization extracts more haplotype information and predicts with bet-
ter accuracy.

Our application of the MVB model to predict DH status from
observed haplotypes supports the utility of the model. We show that
the MVB model achieves better accuracy than BLUP and LOGIT in
predicting simulated DH status. The overall prediction R2 achieved
by MVB, BLUP and LOGIT on real DH status suggests substantial
heritability of this epigenetic signal.

910z ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 [(1181911qu1 112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOTQ/[Z(11111 111011 pepeolumoq

 

 

 

 
  
  
 
   

 

 

 

 

 

 

 

 

 
   
 
   

 

 

 

 

 

 

3520 H.Shi et al.
0.12 - - - - 0.14 . . . .
—*—MVB (|A| g 2, A=o.25) —*—MVB (|A| g2, A=o.25)
0.11‘- —e—MVB(|A|§3,A=0.25) - 0-13' —e—MVB(|A|g3,A=o.25) '
—x— LOGIT (SNP) o 12; —x— LOGIT (SNP) _
ck o_1 - — + — LOGIT (SNP & INT) _ (Er ' < — + — LOGIT (SNP & INT)
C < A—n—ALOGIT (SNP & ADJ) : 0.11 - --E'- - LOGTT (SNP & ADJ) -
.3 (mg _ —e— BLUP (SNP) _ .g —e— BLUP (SNP)
% — + — BLUP (SNP & INT)  0-1 ' — + — BLUP (SNP & INT) '
d) ._ _. ._ _.
5 cm; _ a BLUP (SNP & ADJ) g 009 _ <1 BLUP (SNP & ADJ)
8 8
E 0.07 - E 0.08 -
(D 0)
3 , a 0.07-
0.06 - >
: i  ' E
\ _._, ,
0.05- *~~: 0.05- k 'l
0.04 I I I I I I I I  I I I I I I I I T T

1 2 3 4 5 6 7 8 9 10
number of predictors (|P|)

(3) Prediction R2 averaged over 250 randomly selected windows

140

 

 

-MVB (|A| g 2, A = 0.25)
120 -MVB  S 3, A = 0.25)
- LOGIT (SNP)

|:| LOGIT (SNP & INT)
- BLUP (SNP)

- BLUP (SNP & INT)

100

 

 

80

 

count

 

 

 

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
prediction R2

(c) Distribution of prediction R2 for 250 randomly selected windows

1 2 3 4 5 6 7 8 9 10
number of predictors (|P|)

(b) Prediction R2 averaged over 377 windows with dsQTLs

250

 

 

-MVB (|A| g 2, A = 0.25)
-MVB (|AI g 3, A = 0.25)
200 - LOGIT (SNP)

|:| LOGIT (SNP & INT)
- BLUP (SNP)

15o - BLUP (SNP & INT)

 

 

 

count

100

50

 

 

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
prediction R2

((1) Distribution of prediction R2 for 377 windows with dsQTLs

Fig. 7. Prediction R2 for MVB, BLUP and LOGIT. Here ’SNP’ refers to the experiment involving only single SNPs, ’SNP & INT’ refers to the experiment involving
both SNPs and all two-way interactions and ’SNP & ADJ’ refers to the experiment involving both SNPs and only interactions between adjacent SNPs. (a and b)
The average prediction R2 over different windows as a function of the number oftrue predictors |P|. (c and d) The distribution of prediction R2 for the highest aver-
age prediction FI2 overall |P|. For |P| = 2, the experiments ’SNP & INT’ and ’SNP &ADJ’ are identical

Table 3. Average prediction R2 and standard error for |P| 32 over
250 randomly selected windows (RANDOM) and 377 windows with
dsQTLs (dsQTL)

 

 

|P| MVB(|A| g 2) LOGIT BLUP
RANDOM 1 0.112 : 0.015 0.093 : 0.013 0.097 : 0.013

2 0.109 : 0.015 0.106 : 0.015 0.100 : 0.014
dsQTL 1 0.120 : 0.015 0.108 : 0.015 0.114 : 0.015

2 0.102 : 0.014 0.100 : 0.015 0.096 : 0.014

 

In likelihood evaluation and parameter estimation, the computa-
tional complexity of the MVB models scales like 2N for N SNPs.
This harsh reality limits the applicability of the model to a small
number of variants. Fortunately, even for small N, the MVB model
offers valuable insights into genomic data. The MVB model may
well be critical in predicting binary gene expression when a small
number of causal variants localize within a gene. In particular, MVB
profiles in cases and controls may help in fine mapping traits in gen-
ome-wide association studies. Overcoming the computational limits
of the MVB model limit is high on our research agenda. Once this
task is accomplished, it will be possible to apply the MVB model to
pre-phasing, a technique for improving genotype imputation by first
imputing haplotypes (Howie et al., 2012). We conjecture that

Monte Carlo methods will play a decisive role in extending the
range of the model to larger N. Finding an efficient sampling scheme
to approximate the normalization constant EB exp(SB) is of para-
mount importance and doubtless the place to start in accelerating al-
gorithm performance.

Acknowledgements

We thank Nicholas Mancuso and Gleb Kichaev for helpful discussions that
improved the quality of our manuscript. We also thank the reviewers for their
helpful comments and suggestions.

Funding

This research was supported by NIH (United States Public Health Service)
grants GM53275 and HG006139.

Conﬂict of Interest: none declared.

References

1000 Genomes Project Consortium et al. (2010) A map of human genome
variation from population-scale sequencing. Nature, 467, 1061—1073.

Boyle,A.P. et al. (2008) High-resolution mapping and characterization of open
chromatin across the genome. Cell, 132, 311—322.

910z ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 [(1181911qu1 112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOTQ/[Z(11111 111011 pepeolumoq

Multivariate Bernoulli haplotype model

3521

 

Browning,B.L. and Browning,S.R. (2011) A fast, powerful method for detect-
ing identity by descent. Am. ]. Hum. Genet., 88, 173—182.

Browning,S.R. and Browning,B.L. (2007) Rapid and accurate haplotype phas-
ing and missing-data inference for whole-genome association studies by use
of localized haplotype clustering. Am. ]. Hum. Genet., 81, 1084—1097.

Chung,C.C. et al. (2013) Meta-analysis identiﬁes four new loci associated
with testicular germ cell tumor. Nat. Genet., 45, 6 80—6 85 .

Dai,B. et al. (2013) Multivariate Bernoulli distribution. Bernoulli, 19,
1465—14 83.

Daly,M.J. et al. (2001) High-resolution haplotype structure in the human gen-
ome. Nat. Genet., 29, 229—232.

de los Campos,G. et al. (2013) Prediction of complex human traits using the
genomic best linear unbiased predictor. PLoS Genet., 9, e1003608.

Degner,].F. et al. (2012) DNase I sensitivity QTLs are a major determinant of
human expression variation. Nature, 482, 390—394.

Gibbs,R.A. et al. (2003) The international hapmap project. Nature, 426, 789—796.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method
for the next generation of genome-wide association studies. PLoS Genet., 5,
e1000529.

Howie,B. et al. (2012) Fast and accurate genotype imputation in genome-wide
association studies through pre-phasing. Nat. Genet., 44, 95 5—95 9.

Kruglyak,L. (1999) Prospects for whole-genome linkage disequilibrium map-
ping of common disease genes. Nat. Genet., 22, 139—144.

Lange,K. (2010) Applied Probability. Springer Texts in Statistics. Springer,
New York.

Lange,K. (2013) Optimization. Springer Texts in Statistics. Springer, New
York.

Lawson,D.J. et al. (2012) Inference of population structure using dense haplo-
type data. PLoS Genet., 8, e100245 3.

Li,N. and Stephens,M. (2003) Modeling linkage disequilibrium and identify-
ing recombination hotspots using single-nucleotide polymorphism data.
Genetics, 165, 2213—2233.

Li,Y. et al. (2010) Mach: using sequence and genotype data to estimate haplo-
types and unobserved genotypes. Genet. Epidemiol., 34, 816—834.

Lohmueller,K.E. et al. (2009) Methods for human demographic inference
using haplotype patterns from genomewide single-nucleotide polymorphism
data. Genetics, 182, 217—231.

Madrigal,P. and Krajewski,P. (2012) Current bioinformatic approaches to
identify DNase I hypersensitive sites and genomic footprints from DNase-
seq data. Front. Genet., 3.

Marchini,]. et al. (2007) A new multipoint method for genome-wide associ-
ation studies by imputation of genotypes. Nat. Genet., 39, 906—913.

Morris,A.P. (2006) A ﬂexible Bayesian framework for modeling haplotype as-
sociation with disease, allowing for dominance effects of the underlying
causative variants. Am. ]. Hum. Genet., 79, 679—694.

Pasaniuc,B. et al. (2009) Inference of locus-speciﬁc ancestry in closely related
populations. Bioinformatics, 25, i213—i221.

Pool,J.E. et al. (2010) Population genetic inference from genomic sequence
variation. Genome Res., 20, 291—300.

Price,A.L. et al. (2008) Long-range 1d can confound genome scans in admixed
populations. Am. ]. Hum. Genet., 83, 132.

Price,A.L. et al. (2009) Sensitive detection of chromosomal segments of dis-
tinct ancestry in admixed populations. PLoS Genet., 5, e1000519.

Savage,S.A. et al. (2013) Genome-wide association study identiﬁes two suscep-
tibility loci for osteosarcoma. Nat. Genet., 45 , 799—803.

Scheet,P. and Stephens,M. (2006) A fast and ﬂexible statistical model for
large-scale population genotype data: applications to inferring missing
genotypes and haplotypic phase. Am. ]. Hum. Genet., 78, 629—644.

Su,Z., et al. (2011) Hapgen2: simulation of multiple disease SNPs.
Bioinformatics, 27, 2304—2305.

Templeton,A.R. (2005) Haplotype trees and modern human origins. Am. ].
Phys. Anthropol, 128, 33—59.

Wall,J.D. and Pritchard,].K. (2003) Haplotype blocks and linkage disequilib-
rium in the human genome. Nat. Rev. Genet., 4, 5 87—5 97.

Yang,W.-Y. et al. (2014) A spatial-aware haplotype copying model with ap-
plications to genotype imputation. In: Sharan,R. (ed.), Research in
Computational Molecular Biology. Springer International Publishing,
Switzerland, pp. 371—384.

910z ‘09 1sn8nV uo sejeﬁuV sorl ‘121u10111123 10 [(1181911qu1 112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOTQ/[Z(11111 111011 pepeolumoq

