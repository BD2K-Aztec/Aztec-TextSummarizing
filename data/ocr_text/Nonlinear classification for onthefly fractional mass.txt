ORIGINAL PAPER

Vol. 26 no. 6 2010, pages 791-797
doi: 1 0. 1 093/bioinformatics/btq036

 

Gene expression

Advance Access publication February 4, 2010

Non-linear classification for on-the-fly fractional mass filtering
and targeted precursor fragmentation in mass spectrometry

experiments

Marc Kirchner1’2, Wiebke Timm1’2, Peying Fong3, Philine Wangemann3

and Hanno Steen1’2’*

1Proteomics Center, Children’s Hospital Boston, 2Department of Pathology, Harvard Medical School and Children’s
Hospital Boston, Boston, MA and 8Department of Anatomy and Physiology, College of Veterinary Medicine, Kansas

State University, Manhattan, KS, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Mass spectrometry (MS) has become the method of
choice for protein/peptide sequence and modification analysis. The
technology employs a two-step approach: ionized peptide precursor
masses are detected, selected for fragmentation, and the fragment
mass spectra are collected for computational analysis. Current
precursor selection schemes are based on data- or information-
dependent acquisition (DDA/IDA), where fragmentation mass
candidates are selected by intensity and are subsequently included
in a dynamic exclusion list to avoid constant refragmentation of
highly abundant species. DDA/IDA methods do not exploit valuable
information that is contained in the fractional mass of high-accuracy
precursor mass measurements delivered by current instrumentation.
Results: We extend previous contributions that suggest that
fractional mass information allows targeted fragmentation of analytes
of interest. We introduce a non-linear Random Forest classification
and a discrete mapping approach, which can be trained to
discriminate among arbitrary fractional mass patterns for an arbitrary
number of classes of analytes. These methods can be used to
increase fragmentation efficiency for specific subsets of analytes or
to select suitable fragmentation technologies on-the-fly. We show
that theoretical generalization error estimates transfer into practical
application, and that their quality depends on the accuracy of prior
distribution estimate of the analyte classes. The methods are applied
to two real-world proteomics datasets.

Availability: All software used in this study is available from
http://software.steenlab.org/fmf

Contact: hanno.steen@childrens.harvard.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 27, 2009; revised on January 22, 2010;
accepted on January 25, 2010

1 INTRODUCTION

Current mass spectrometry (MS) technologies provide unpreceded
mass accuracy and resolution, yielding detailed qualitative and

 

*To whom correspondence should be addressed.

quantitative insight into a sample under investigation. In ﬁelds
including, but not limited to, proteomics, glycomics, lipidomics and
metabolomics, MS is now an established workhorse methodology
and high—resolution MS data acquisition have become the norm.

The accurate observed mass of a chemical compound carries
more information than the mere molecular weight. It can be used
to distinguish between peptides and non—peptides (Dodds et al.,
2006), cysteine—rich and/or highly acidic peptides, glycopeptides
and non—polar peptides (Lehmann et al., 2000); between peptide—
oligonucleotide cross—links and DNA fragments (Pourshahian and
Limbach, 2008; Steen et al., 2001); between unmodiﬁed and post—
translationally modiﬁed peptides (Bruce et al., 2006); and between
target precursors and interference peptides (Bateman et. al., 2007;
Steen and Mann, 2002; Tiller et al., 2008; Zhang et al., 2008),
and it can pinpoint mass—defect calibrants in quantitative MS (Hall
et al., 2003). Accurate mass measurements enable on—the—ﬂy analysis
decisions that formerly required time—intensive off—line analytical
procedures (Sweet et al., 2006).

Mass defect, mass excess and fractional mass: the driving
principle behind accurate mass—based decisions is the concept of
nuclear mass defect, deﬁned as the difference between the sum
of the masses of the constituent nucleons and the measured exact
mass of an atom (Inczedy, 1998). This difference is an instance of
Einstein’s special theory of relativity stating that mass and energy are
interchangeable (Einstein, 1905): the nuclear mass defect accounts
for the nuclear binding energy and is always non—negative. The
concept of mass excess is a direct consequence of the nuclear mass
defect: it is deﬁned as the difference d = mobS — mnom between the
observed mass mobS and the nominal mass mnom of an element or
compound. In particular, the mass excess of 12C is deﬁned as zero
and mass excesses of other elements can either be positive (e.g.
1H: 1.00783 and 14N: 14.00307) or negative (e.g. 16o: 15.99491,
328: 3197207, 31F: 30.97376 and 1271: 12690447). However,
in practical experiments there is generally no prior knowledge
about the chemical composition of an observed mass, and as a
consequence, the nominal mass cannot directly be observed. Instead,
high—resolution MS instruments provide the fractional mass ¢(m) =
m — Lmj, i.e. the fraction of mass after the decimal point of a mass
measurement m. The fractional mass is conﬁned to the interval
¢(m) E [0, 1) and, for mass excess larger than one, it wraps around
to zero (Fig. 1).

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 791

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq mos; popeoIHAAoq

9IOZ ‘Ig1sn8nv I102:

M.Kirchner et aI.

 

I'm-abanal I'I‘IHES

 

 

 

I I I | I I I
SUI} 'IDIIIU 151m Eﬂﬂﬂ 25E“) HEIDI} BEEN] SUI} 'IDDCI 1500 200'] 25E“? HEIDI] 35m]

neural Irma-er mass neutral imegar mas-a

Fig. 1. Mass excess plots for the human protein phosphorylation (left) and
the Sas scrofa protein iodination (right) sequence database training datasets
with theoretical modiﬁcations. The plots show fractional mass over neutral
integer mass for a subset of 10000 randomly sampled peptides for each
class. For phosphorylation the diagonal bands from left to right correspond
to unphosphorylated, singly, doubly and tn'ply phosphorylated peptides.
For iodination the bands correspond to unmodiﬁed, iodinated, diiodinated,
T2 (a particular di—iodination), T3 (tri—iodination) and T4 (tetra—iodination)
peptides. Because phosphorylation has a smaller negative mass excess than
iodination, inter—class overlap for the phosphorylation data is signiﬁcantly
more pronounced than for the iodination data.

Mass excess in peptide analysis: the mass excess of a single
hydrogen atom is ~0.0078 u and is the single major contributor to
the average increase in peptide mass excess per atomic mass unit of
0.000488997. In conjunction with the well—deﬁned, distinct (with the
exception of leucine/isoleucine) stoichiometries of the 20 naturally
occurring amino acids, the expected masses and mass excesses
deﬁne a deterministic grid on which peptide/protein observations
can be expected (Frahm et al., 2006; Mann, 1995). Measurements
that deviate from this grid stem either from non—peptide compounds
or indicate peptide modiﬁcations. For example, (i) phosphorylation
(+HPO3) of S, T or Y residues causes a mass shift of 79.966331 u
and bears a mass excess of —0.033669 u; (ii) oxidation (+0) of
methionine (M) residues entails a mass shift of 15.994914 u at a mass
excess of —0.005196 u; (iii) Palmitoylation (+H30C16O) of C, K, S
and T residues or N—terminals causes a mass shift of 238.229666 u
at a mass excess of 0.229666 u; and (iv) for different iodination
modiﬁcation types of histidine (H) or tyrosine (Y) residues, mass
shifts and mass excesses range from 125.8966u to 595.6128 u and
from —0.1033546 u to —0.3872059 u, respectively.

Fractional mass/mass excess ﬁltering: using fractional mass
information as an input for a ﬁlter can be desirable in a number
of different contexts: ﬁrst, mass spectra are prone to noise effects
and despite elaborate chemical protocols, incomplete separation and
sample contamination with interfering compounds is a common
problem in complex samples. Here, fractional mass ﬁltering provides
a straightforward approach to separating the peptide signal from
the background and yields improved signal—to—noise ratios. This
has been used to gain increased conﬁdence in peptide mass
ﬁngerprinting results (Dodds et al., 2006) and, known as forbidden
region ﬁltering or quantized peptide mass distribution ﬁltering
(Du and Angeletti, 2006), is a post—processing procedure in MS
and liquid chromatography/mass spectrometry (LC/MS) feature
extraction packages (Jaitly et al., 2009; Renard et al., 2008).

Second, following a similar rationale, mass excess ﬁltering can
be used for intelligent pre—ﬁltering of high—resolution and high—
accuracy tandem mass spectra in order to remove non—peptide

fragments (Wolski et al., 2006), to increase identiﬁcation scores and
to reduce database search times.

Third, common tandem MS acquisition schemes are based on
data— or information—dependent acquisition (DDA/IDA), where
fragmentation candidate masses are selected by intensity and are
subsequently included in a dynamic exclusion list to avoid constant
refragmentation of highly abundant species. With fractional mass
ﬁltering/classiﬁcation, it is possible to bias the fragmentation process
towards a set of analytes of interest (Bateman et. al., 2007; Bruce
et al., 2006; LeBlanc et al., 2009; Pourshahian and Limbach,
2008; Tiller et al., 2008; Zhang et al., 2008) and to automatically
select suitable fragmentation techniques on—the—ﬂy (Sweet et al.,
2006). Automated mass excess discrimination routines, thus,
yield tailored preferential fragmentation of speciﬁcally modiﬁed
peptides. Depending on the magnitude of the mass excess and
the discrimination ability of the procedure, such an approach can
greatly increase the fragmentation efﬁciency for a speciﬁc subset of
molecules of interest.

Previous work: existing fractional mass ﬁltering/classiﬁcation
methods are characterized by the following properties: (i) the input
space directly corresponds to the 2D representation used in mass
excess diagrams (Fig. 1). Measurements are described by nominal
and fractional mass (Bruce et al., 2006; Dodds et al., 2006); (ii) to
overcome the problem that the fractional mass is not a bijective
measurement over m /z (the fractional mass returns to zero each
time the mass excess switches to the next integer), the problem
is linearized. Therefore, the integer mass difference for a speciﬁc
class of compounds is estimated and used as an additive constant
for all fractional masses above an optimized threshold (Bruce
et al., 2006); (iii) the accurate mass ﬁltering/classiﬁcation problem
is formulated in terms of a linear discrimination problem (Bruce
et al., 2006; Dodds et al., 2006; Pourshahian and Limbach, 2008;
Zhang et al., 2008). Depending on the analysis setup, classiﬁcation
thresholds are determined for lines parallel to the mass excess
mean trend or symmetrically around it with widening boundaries
for increasing masses; (iv) given the discrimination boundaries,
crisp and/or probabilistic class assignments are reported; and (v) the
theoretical classiﬁcation performance is evaluated (Bruce et al.,
2006).

Shortcomings of existing approaches: The drawbacks associated
with such a workﬂow are: (i) The linearization of the fractional
mass plot is prone to error. There exist a considerable number
of compounds that deviate from the mass excess mean trend
(Bruce et al., 2006) and, depending on the amount of deviation,
the respective mass excess reconstructions may be erroneous.
(ii) Linear discrimination approaches can only deliver limited
partitioning of the mass domain and may fail to distinguish different
overlapping classes of compounds (Pourshahian and Limbach,
2008). Mass excess mean trend—parallel classiﬁcation boundaries
(Bruce et al., 2006) fail to account for the heteroscedastic character
of the underlying data. (iii) For proteomics applications, previous
publications provide training error estimates (Bruce et al., 2006)
derived from protein sequence databases. The proposed procedures
lack cross—validation (CV) and consequently underestimate their true
generalization error. It is therefore not clear how well the calculated
theoretical errors transfer into practical application. Also, theoretical
error estimates cannot provide insight into how variation in chemical
enrichment protocols affects the performance of a fractional mass
ﬁltering routine.

 

792

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv (10::

Fractional mass filtering

 

This contribution introduces a 1D classiﬁcation approach that can
be trained to discriminate between arbitrarily distributed molecular
classes of interest based on the information encoded in their
accurate mass. The method makes use of a non—linear classiﬁer
and delivers class—wise posterior probabilities. In addition, we
introduce a discrete derivate of the classiﬁer that is amenable to
fast on—the—ﬂy ﬁltering of precursor masses, which is of particular
interest for hardware implementations. The viability of the proposed
procedures is illustrated on real—world experimental datasets and
classiﬁcation performance is assessed using cross—validated quality
measures and real—world peptide identiﬁcation and modiﬁcation
information. We show that the theoretical classiﬁcation errors hold
in practical application but that transferability is dependent on prior
knowledge about the modiﬁcation state distribution. We discuss the
practical consequences of this limitation and suggest a potential
remedy. Additionally, we brieﬂy investigate the potential of the
procedure for multi—class fractional mass classiﬁcation and provide
the corresponding results. Although the presentation focuses on
proteomics applications, the transfer of the underlying principles
to other ﬁelds of research is straightforward.

The remainder of this contribution is organized as follows:
we present the underlying methodology and statistical learning
approach in Section 2 and describe the theoretical and experimental
datasets and the experimental setup in Section 3. In sections 4 and 5
we list the results and discuss implications, respectively. Section 6
offers conclusions and an outlook.

2 METHODS

Mass excess-based classiﬁcation is a ID problem: the 2D representation
shown in the mass excess plots in Figure 1 is suitable for human perception,
every observation is characterized by its estimated nominal (Bruce et al.,
2006) or observed integer mass (Dodds et al., 2006) on the x—axis and
its fractional mass on the y—axis. This way, each measurement is split
into its integer and real part, illustrating that the 2D display is merely a
folded up representation of the 1D mass domain. Consequently, we may
restate the mass excess/fractional mass ﬁltering problem the following
way: given a continuous mass range M, we would like to ﬁnd a function
f : M —> S that maps an observed mass m e M to an element of the simplex
S = {0%, ...,fc.;)T|ngg = 1}; here, G corresponds to the number of classes
in the classiﬁcation problem, f (m)=0“1 (m), ..., fc;(m))T is a probabilistic
assignment to these classes, and a crisp classiﬁcation for a mass m is given
by argmaxg{f:g(m)}. This reduces the problem to ﬁnding the function f. See
Supplementary Figure 1 for an illustration of f (m) in a two—class classiﬁcation
scenario.

Random Forest training: we make use of a statistical learning approach
to obtain the function f: (i) using protein sequence database information
(see data section), we construct a representative set of ground truth data
consisting of mass/label pairs x,- 2 (mi, l,)T, with l,- e {1, ..., G}; and (ii) based
on this ground truth, we train a suitable classiﬁcation method to deliver
probabilistic predictions for new observations. The second step implicitly
constructs f. Among an abundance of classiﬁers that could be used to obtain
f, we choose the Random Forest (Breiman, 2001) due to its favorable
training properties and the availability of a robust implementation in the form
of the randomForest package (Liaw and Wiener, 2002) for the statistical
programming language R (R Development Core Team, 2008). We predict
posterior class probabilities; this allows the straightforward generation
of receiver operating characteristic (ROC) plots. See the Supplementary
Information for detailed parameters.

Discrete mapping classiﬁer training: for online application of
classiﬁcation procedures, the evaluation time necessary to characterize a
set of parent masses is crucial. With a trained classiﬁer (i.e. an implicit

construction of f) available, an obvious procedure to increase speed is the
discretization of the mass domain and pre—calculation of the corresponding
predictions. Because the resolution of any MS analyzer is ﬁnite we observe
M distinct masses, and given a mass binning scheme b 2 (b1, ..., 19114), the
class posteriors can be represented in an M x G matrix P with pjg =fg(bj).
For prediction of an observed precursor mass m, the procedure determines the
index} = argminj{|bj — ml} of the mass bin center closest to the observation
and returns the corresponding class posteriors f (19;). If b equals the instrument
binning, then lbj — ml 2 0,Vj. For each observed mass, class prediction then
has 0(logM) time complexity if the implementation uses a lookup technique
or 0(1) if e.g. a hash table is used.

Neutral mass analyses are suﬁ‘icient for high-resolution MS: current M81
experiments generally exhibit sufﬁcient resolution to distinguish between
isotopes of a compound and to determine its charge state zu. With charge
state information available for each observed monoisotopic mass mu, the
neutral mass m, of a compound is given by m, = zu(mu —mH+), where mH+
corresponds to the mass of a proton (mH+ = 1.007276 u). This enables us
to train the prediction function f in the neutral mass domain and allows
common treatment of singly and multiply charged ions by transformation
into their neutral mass representation.

Training set generation: to ensure that the training and test sets include
a representative subset of the complete mass domain, a stratiﬁed sampling
strategy was employed: we split the mass domain into R disjunct regions and
for each region r e {1, . .., R} and each class g e {1, , G} we determine the set
R, of masses that falls into that region. For balanced training of the Random
Forest classiﬁer, the maximum number N, of K —fold cross—validation samples
that can be drawn from R, is then given by the size N, of the smallest class in
72,. We uniformly draw K sets of samples S,k without replacement from the
72,, each of size LN, /KJ. The (ZfZlN,) x K cross—validation data matrix C
is then given by stacking the stratiﬁed sets of masses 8k 2 Ur8,k as column
vectors. The respective region—wise label vectors 1, hold LN, /Kj—blocks of
labels that are identical over all cross—validation folds and that can be stacked
to form a (ZfZlN,) x 1 label vector 1. See Supplementary Table 4 for all
combinations of K, N and R.

ROC and area under the ROC curve: to report classiﬁer performance, we
show ROC plots for the trained classiﬁer in each of the application cases (see
Section 4). The ROC plots visualize detailed tradeoffs between two different
statistical quality features and allow comparison between experiments. In
particular, we show ROC plots of the true positive rate (TPR) versus false
positive rate (FPR) and compare results for the different classiﬁers using the
area under the ROC curve (AUC).

We provide two displays for each dataset: (i) the cross—validated (K = 10)
training ROC/AUC (shown as solid lines in Fig. 2). These results are purely
based on computational procedures; and (ii) the ROC for the application of
the trained classiﬁer to the corresponding iodination and phosphorylation
datasets (dashed lines in Fig. 2). These curves show true classiﬁcation
performance on the experimental data. These ROCs/AUCs can only be
calculated if peptides undergo identiﬁcation. In contrast to a common
application setup, we acquired this information for the datasets used in this
study to allow for validation. ROC curves were generated using the ROCR
package (Sing et al., 2007).

3 DATA

3.1 Human protein phosphorylation dataset

3.1.] Experimental data The phosphorylation dataset was taken from an
ongoing SILAC—based quantitative phosphoproteomic study investigating
the effect of a particular kinase inhibitor on HeLa S3 cells. Phosphopeptides
were enriched with Ti02 columns and the samples were analyzed by LC/MS
on an LTQ Orbitrap (Thermo Scientiﬁc, San Jose, CA, USA) equipped with
a micro—autosampler and a nanoﬂow HPLC system (both: Eksigent, Dublin,
CA, USA). MS2 spectra were acquired in a DDA mode. The 200 most intense
fragment ions of each product spectrum were searched against a concatenated
target and reverse decoy International Protein Index (IPI) human protein

 

793

112 /810's112u1nofp101x0's31112u1101u101q//:d11q 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv (10::

M.Kirchner et aI.

 

 

 

 

 

 

 

 

Fhuspherylatlun
{a} s —
'13. _
III
III
E LIE! _
'— III
E
E
3
 a -
N. _
CI
-— emss—sslidstiun
1:! _ "n M5 experlment
: I.
| | | | I |
0.0 0.2 0.4 0.0 0.0 1.0
false [:10 sitive rele
IﬂdIl‘IiIlIﬂl'l
{a} =- _
'3! _
E
III
E “C! _
'— III
11‘-
3
s
s s —
a.
N. _
III
~— Cress-salidstiun
g _ ---- M5 experlment
I I I I I I
0.0 0.2 0.4 0.0 0.0 1.0

false pasItIss Isle

 

 

 

 

 

 

 

 

{hi 3 —
I! _
III
I]. III
.2
E
3 Fr
 e -
N. -
E
I“ -— emss—vslidstien
g _ ---- M5 espenment
I I I I I I
0.0 0.2 0.4 0.0 0.0 1.0
false peslliue rate
{d} =1 _ ______ --
I! _
CI
2
m “1! _
'— D
a:
.2:
a I?
s e -
N. _
III
— tress-validation
: _ ---- M5 WEFIH‘IEI‘II
I l | | | |
0.0 0.2 0.4 0.0 0.0 1.0

false pa sltnvs rats

Fig. 2. ROC plots illustrating the performance of the discrete mapping classiﬁer on theoretical and real—world data with correct (left column) and incorrect
(right column) modiﬁcation state prior distributions. Theoretical, cross—validation—based ROCs are shown as solid, validated real—world ROCs as dashed lines
(N = 128 000, K = 10). Panels a and 0 illustrate that the theoretical ROC provides an accurate estimate of the real—world performance if the modiﬁcation state
prior distribution is known. In panels b and d, the modiﬁcation state prior distributions have not been adjusted to the distributions present in the data. Thus, the
theoretical classiﬁcation performance may misestimate the true error. The magnitude of this effect depends on the complexity of the underlying classiﬁcation

problem.

database (v3.36) using the Mascot search engine (Matrix Science, v2.2.04).
One missed tryptic cleavage was allowed. See Supplementary Table 2
for detailed search parameters. Peptide identiﬁcations were accepted at a
1% global false discovery rate (FDR) (Choi et al., 2008), corresponding
to a Mascot peptide score cutoff of 30.5. The associated modiﬁcation
information was extracted. The resulting two label groups (unmodiﬁed and
phosphorylated) served as a ground truth for determining the generalization
ability of fractional mass classiﬁers derived from theoretical IPI digests
(Experiments 1 and 2).

3.1.2 Computational data To obtain theoretical ground truth data,
we extracted 69013 protein sequences from the IPI human database
(version 3.36). Tryptic in silico digestion (allowing one missed cleavage
site) and exclusion of peptides with unknown or ambiguous residues yielded
2 164 634 unique peptide sequences. For mass calculations, cysteine residues
were assumed to be carbamidomethylated. Peptides were allowed to be
variably phosphorylated at one, two or three phosphorylation sites (serine,
threonine, and tyrosine residues). We then generated four sets of peptide
masses: (i) masses of all unmodiﬁed peptides; (ii) masses of all peptides
with one occupied phosphorylation site; (iii) masses of all peptides with two

occupied phosphorylation sites; and (iv) masses of all peptides with three
occupied phosphorylation sites. Two training sets 791 and 732 (N 2128 000
each) were constructed by: (i) drawing according to the modiﬁcation ratios
found in the MS2 search results (2731:1779:17:2); and (ii) by drawing
according to the modiﬁcation distribution present in the peptide data
(5.8:4.7:3.2:2) derived from the IPI database. Training set 791 serves as
ground truth for Experiments 1 and 2, 792 for Experiment 2.

3.2 Sus Scrofa thyroglobulin iodination dataset

3.2.] Experimental data Thyroglobulin protein samples were acquired
from Sus scrofa thyroid glands. Cells were homogenized, centrifuged and
the supernatant was collected for downstream analysis. The protein was
denatured before gel separation and staining. The 600 kDa band was isolated
for MS analysis. See the Supplementary Material for a detailed description of
the sample preparation protocol. After tryptic digestion, peptide samples were
analyzed by online C18 nanoﬂow reversed—phase HPLC (Eksigent nanoLC
2D) hyphenated to an LTQ Orbitrap mass spectrometer (Thermo Scientiﬁc).
MS2 spectra were acquired in DDA mode and searched with Mascot against
a concatenated target and reverse decoy NCBI RefSeq Sus scrofa database

 

794

112 /810's112u1nofp101x0's31112u1101u101q//:d11q 111011 pop120111m0q

9IOZ ‘Ig lsnﬁnv 110::

Fractional mass filtering

 

(Pruitt et al., 2007, April 2009). Search parameters were tailored to iodination
state detection (see Supplementary Table 3 for details). Peptide identiﬁcations
were accepted at an FDR of 1%, corresponding to a Mascot score cutoff of
32.01. Extracted sequences, modiﬁcation information and MS/MS precursor
mass and charge were used as real—world ground truth in Experiments 1 and 2.

3.2.2 Computational data Sus scrofa protein sequence information was
extracted from the NCBInr database, yielding 21364 distinct proteins.
Tryptic in silico digestion (1 missed cleavage) and exclusion of peptides
with unknown residues resulted in 573 544 peptides. For sequence mass
calculations, cysteine residues were assumed to be carbamidomethylated,
histidine and tyrosine residues were subject to variable single and
double iodination and tyrosines were additionally considered in their
3,3/—T2, T3 and T4 forms (cf. Supplementary Table 1). Hence, the set of
theoretical masses consisted of peptides that had no or exactly one of the
variable iodination modiﬁcations. From this we generated two different
collections of theoretical masses: (i) all iodinated masses were merged into a
single collection for two—class classiﬁcation (iodination versus unmodiﬁed);
and (ii) diiodinated and 3,3—T2—iodinated peptide masses (both carrying two
iodines) were pooled, yielding a collection of masses representing a ﬁve—class
problem (cf. Supplementary Table 1). From these collections, we generated
three training sets I1, I2 and I3 (N 2128 000 each): (i) a two—class training
set sampled according to the modiﬁcation state distribution in the MS2 search
results (818:41:37:1:1:1); (ii) a two—class classiﬁcation training set sampled
according to the modiﬁcation state distribution in the protein sequence
database (4.0:1.9:1.8:1.1:1:1); and (iii) a ﬁve—class training set sampled
according to the modiﬁcation state distribution in the protein sequence
database. For the last set, the mass range was cropped to 1000—3500 m/z
to ensure applicability of the stratiﬁed sampling scheme. Training set I1 was
used as ground truth in Experiments 1 and 2, I2 in Experiment 2 and I3
forms the basis of Experiment 3.

4 EXPERIMENTS AND RESULTS

Experiment I: determining the practical value of theoretical
generalization error estimates: we trained Random Forest and
discrete mapping classiﬁers for the phosphorylation and iodination
experiments. In order to derive results independent of modiﬁcation
state prior distribution inﬂuences (see Experiment 2), we trained
on the sets 731 and I1 whose modiﬁcation state distributions
were derived from the MS2 search results. Subsequent 10—fold
cross—validation delivered a direct estimate of the theoretical
generalization error. We then applied the trained classiﬁers to the
experimental data sets and determined the real—world generalization
error for comparison.

The results for Experiment 1 are shown in the rows of the EB
group in Table 1. For the discrete mapping approach the theoretical
and practical error estimates are very similar: the observed real—
world performances are within two SDs of the theoretical values.
This is also illustrated in Figure 2a and c. These bounds also hold
for the Random Forest applied to the Sus scrofa phosphorylation
dataset; for the iodination dataset the estimated generalization error
is conservative and underestimates the true performance attained on
the experimental data (see Supplementary Fig. 2).

Experiment 2: judging the inﬂuence of the modiﬁcation state prior
distribution: we investigated the inﬂuence of the modiﬁcation state
prior distribution on the performance of the classiﬁers. Therefore,
Random Forest and discrete mapping classiﬁers were trained on
the 732 and I2 datasets that follow the distribution of modiﬁcation
states inherent to the peptide sequences given in the protein database
digest. Again, cross—validated and real—world performance measures
were obtained.

Table 1. Performance summary of the areas under curve (AUC) for all
datasets and the Random Forest and the derived discrete mapping

 

Random Forest Discrete mapping

 

Data 10—fold CV real 10—fold CV real

 

EB phos. 0.697:l:0.005 0.694 0.696:l:0.004 0.689

10d. 0.894:l:0.007 0.940 0.900:l:0.006 0.908
9 phos. 0.830:l:0.003 0.696 0.827:l:0.005 0.713
iOd. 0.973 :l:0.001 0.987 0.973:l:0.001 0.979

 

AUCs in the in silico columns illustrate mean and empirical SD over 10 cross-
validation runs. AUCs in the real columns were obtained by comparison against
peptide identiﬁcation results. Observations have been acquired with (69) and without
(9) adjusting the modiﬁcation state prior distribution in the training phase. The
major observations are: (i) classiﬁer performance is worse for the highly overlapping
phosphorylation problem (see Figure 1); (ii) the accuracy of the predicted classiﬁcation
performance is highly dependent on the modiﬁcation state prior distribution and problem
complexity; and (iii) in silico performances of Random Forest and the faster discrete
mapping are virtually identical.

For the protein phosphorylation dataset (Table l, 9 group, top
row and Fig. 2b), the discrete mapping as well as the Random
Forest grossly overestimate the classiﬁcation performance if the
modiﬁcation prior distribution, which was used during training,
suggests a simpler classiﬁcation task. Compared to the AUC
acquired on the real—world data, we observe a misestimation of
13.4% for the Random Forest and of 11.4% for the discrete mapping
classiﬁer. On the protein iodination dataset (Table l, 9 group,
bottom row and Fig. 2d), the real—world AUC is well approximated
despite the imperfect modiﬁcation state prior distribution used in
the training phase: both classiﬁers provide a conservative theoretical
estimate of the true AUC.

Experiment 3: feasibility of multi-class fractional mass ﬁltering:
inspired by multi—class discrimination problems (Pourshahian and
Limbach, 2008), we investigated if multi—class discrimination
in fractional mass—dependent analyses is feasible. After training
Random Forest and discrete mapping classiﬁers on the ﬁve—
class I3 dataset, we calculated a cross—validated confusion matrix
and estimated Cohen’s K and multi—class classiﬁcation accuracy.
Table 2 shows the Random Forest confusion matrix for the ﬁve—
class Sus scrofa dataset. For equal class prevalences, a perfect
classiﬁer would yield (0.2,0.2,0.2,0.2,0.2)T on the diagonal. Off—
diagonal elements are present for overlapping adjacent classes. The
unmodiﬁed and T4 classes are adjacent due to the [0,1) domain
constraint of the fractional mass. Cohen’s K yields K = 0.691 and the
overall classiﬁcation accuracy is 75.56%. The full set of summary
statistics is available in Supplementary Table 5.

5 DISCUSSION

Theoretical fractional mass ﬁltering performance measures hold in
practical application: the results from Experiment 1 (cf. Fig. 2a
and c) show that theoretical and practical performance estimates are
close if the training and real—world modiﬁcation state distributions
are equal. In this case, the theoretical error estimates obtained
for fractional mass classiﬁers trained on in silico datasets can be
transferred to practical application and are valid estimates for the
unknown and unobservable experimental errors. The required degree
of modiﬁcation state distribution similarity depends on the difﬁculty

 

795

112 /810's112u1nofp101x0's31112u1101u101q//:d11q 111011 pop120111m0q

9IOZ ‘Ig lsnﬁnv 110::

M.Kirchner et aI.

 

Table 2. Confusion matrix for the ﬁve—class iodination state classiﬁcation
problem

 

Predicted iodination state

 

 

® mi di/T2 T3 T4
Q 0.16 0.03 0.00 0.00 0.01
(20282) (4020) (289) (46) (738)
mi 0.03 0.14 0.03 0.00 0.00
(4141) (17713) (3635) (196) (47)
0)
g di/T2 0.00 0.03 0.14 0.02 0.00
8' (264) (3634) (18286) (3056) (174)
.H T3 0.00 0.00 0.02 0.15 0.03
(48) (188) (3218) (18810) (3394)
T4 0.01 0.00 0.00 0.03 0.17
(865) (45) (172) (3492) (21247)

 

Di-iodination and 3,3-T2 both incorporate two iodine atoms and have been merged into
a single class. The 10-fold cross-validated classiﬁcation accuracy on the N = 128 000
training dataset is 75.56%, Cohen’s K = 0.691.

of the classiﬁcation problem (see detailed discussion below) and
scales with the mass excess and the associated discrimination
abilities of the targeted modiﬁcation of interest.

Fractional mass classiﬁcation is ejfective for targeted
fragmentation: in Figure 2a and c as well as in Table 1 all real—world
AUCs are larger than 0.68 and 0.90 for the phosphorylation and
iodination problem, respectively. A random assignment to the
associated classes according to the class priors would correspond to
an AUC of 0.5, illustrating that fractional mass—based classiﬁcation
yields effective precursor selection. Consequently, there is a beneﬁt
in the combination of: (i) learning discrimination functions based
on theoretical ground truth; and (ii) applying the resulting classiﬁers
to characterize observations in practical MS experiments. More
detailed efﬁciency analyses depend on the experiment at hand.
For the phosphorylation data, we also calculated the positive and
negative predictive values (PPV and NPV, see Supplementary
Fig. 3). In the context of targeted fragmentation, the PPV can be
understood as a measure of efﬁciency (the ratio of true positives
among those reported as fragmentation candidates) and l—NPV
describes the miss rate (the ratio of false negatives among those
reported as non—candidates). For the modiﬁcation distribution—
adjusted phosphorylation experiments, optimal values of PPV and
NPV are between 60% and 70%, providing further evidence that the
fractional mass classiﬁcation is beneﬁcial although the underlying
classiﬁcation problem is non—trivial.

On-the-ﬂy classiﬁcation is feasible and equally accurate: the
numbers in Table 1 indicate that the impact of discretizing the
neutral mass domain is marginal. For the two datasets used in
this study, theoretical AUC values for the Random Forest and the
discrete mapping classiﬁer are within a single SD of each other. This
observation also holds for all real—world classiﬁcation experiments
with the exception of the modiﬁcation state distribution—adjusted
Sus scrofa thyroglobin classiﬁcation. Here, the Random Forest
outperforms the discrete mapping approach quite signiﬁcantly.
Evidence from other thyroglobulin iodination datasets (data not
shown) suggests that this is related to the comparatively small
number of iodinated peptides present in the real—world dataset,

which causes signiﬁcant changes in the AUC with only very few
contradicting classiﬁcations between the methods.

Classiﬁcation performance depends on modiﬁcation state prior
distribution accuracy: real—world classiﬁcation performance is
inﬂuenced by two factors: (i) the complexity/difﬁculty of the
underlying classiﬁcation problem; and (ii) the discrepancy between
the modiﬁcation state prior distributions used for training and present
in the real—world dataset. The former can easily be illustrated by
comparing the theoretical ROCs and AUCs for the phosphorylation
and iodination problems shown in Figure 2. Because the fractional
mass shift for phosphorylation is smaller than for iodination, the
classes representing the different phosphorylation states exhibit
a larger overlap (cf. Fig. 1). Consequently, their discrimination
is more difﬁcult and the area under the theoretical ROC curve
for the phosphorylation problem (Fig. 2a) is smaller than for
the iodination problem (Fig. 2c). If the correct modiﬁcation state
distribution is used in the training step, the theoretical and real—
world ROCs and AUCs are very similar (Fig. 2a and c), if not, the
cross—validated performance estimate reported for the theoretical
data may overestimate the true error rates attained in real—world
application (Fig. 2b). It is important to realize that this is an
observation that focuses on the theoretical error estimate with
respect to its validity in real—world application: although more
detailed sampling of masses of less prevalent modiﬁcation states
may yield improved performance (Fig. 2d), there is no guarantee
that the error estimates are sufﬁciently conservative under such
circumstances. In the phosphorylation dataset, the inﬂuence of
imperfect prior distributions of the modiﬁcation states had a huge
inﬂuence on the accuracy of the theoretical AUC estimates but only
little impact on the classiﬁcation performance on real—world data
(Supplementary Fig. 4). In cases where the classiﬁcation problem
is comparatively simple due to clear—cut, large mass defects, the
performance predictions are relatively stable with respect to the
class prior distributions, i.e. ROC curves and AUCs change only
marginally for different prevalence settings. This is illustrated by
the iodination ROCs in panels c and d in Figure 2. The reason for
this behavior is that false positives and false negatives are costly
in terms of MS2 sampling efﬁciency and it is necessary to jointly
optimize true positives and true negatives. For the optimization of
the joint criterion, the (unknown) ratio between true positives and
true negatives needs to be considered, causing a dependency on the
modiﬁcation state prior distribution (Hastie et al., 2001).

However, in many proteomics experiments the peptide
modiﬁcation state prior distribution is unknown or in itself a subject
of ongoing investigation. In such cases, available MS2 datasets
can be used to estimate a lower bound of PTM rates, but the
applicability of such ground truth is heavily inﬂuenced by the
bias introduced through sample preparation, the speciﬁc chemical
enrichment protocols used, and DDA. Manually curated PTM
databases (Bruce et al., 2006) suffer from the same drawbacks and
are not available for all organisms of interest. A potential approach
to circumventing this problem is to include a data—dependent
retraining scheme, where modiﬁcations identiﬁed by Mascot search
as well as protein sequence databases serve as ground truth and
the classiﬁer undergoes constant, iterative re—training. Consequently,
with a growing knowledge base, the classiﬁer performance can
iteratively adapt to the true modiﬁcation prevalence and converge
towards optimality. Such a procedure is computationally expensive
and should thus only be applied to standardized, stable protocols.

 

796

112 /810's112u1nofp101x0's31112u1101u101q//:d11q 111011 pop120111m0q

9IOZ ‘Ig lsnﬁnv 110::

Fractional mass filtering

 

M ulti-class, 0n-the-ﬂy fractional mass ﬁltering is feasible: Table 2
indicates that the proposed procedure is amenable to multi—class
discrimination problems. For the ﬁve—class iodination problem,
classifying the iodination state by mere chance would yield an
accuracy of 20% and making use of the fractional mass ﬁltering
approach thus yields a substantial improvement of >55%. Obviously,
multi—class tasks are subject to the aforementioned constraints as
well: depending on the difﬁculty of the discrimination problem,
the applicability and usefulness of multi—class approaches can vary
greatly. Nonetheless, given suitable sample preparation protocols,
classiﬁcation provides convenient multiplexing possibilities for the
selection of precursors and precursor fragmentation technologies.

6 CONCLUSION

Based on the results presented in the previous sections we conclude
that the theoretical fractional mass ﬁltering/classiﬁcation concept
is applicable in practice. The proposed 1D representation and its
combination with a non—linear classiﬁcation approach provides a
generic approach to obtain a discrete (and potentially multi—class)
partitioning of the neutral mass domain. With a discrete mapping
derived from the original Random Forest classiﬁer, the method is
sufﬁciently fast for real—time application. This allows on—the—ﬂy
fractional mass ﬁltering for arbitrary mass excess structures.

ACKNOWLEDGEMENTS

We are indebted to Dominic Winter, Nurhan Ozlu and Judith Steen
for the acquisition of the Sus scrofa thyroglobulin iodination and
human protein phosphorylation mass spectrometry datasets.

Funding: Alexander von Humboldt Foundation (3.1—DEU/1134241,
to M.K.).

Conﬂict of Interest: none declared.

REFERENCES

Bateman,K.P. et al. (2007) MSE with mass defect ﬁltering for in vitro and in vivo
metabolite identiﬁcation. Rapid Commun. Mass Spectrom, 21, 1485—1496.

Breiman,L. (2001) Random forests. Mach. Learn., 45, 5—32.

Bruce,C. et al. (2006) Probabilistic enrichment of phosphopeptides by their mass defect.
Anal. Chem, 78, 4374—4382.

Choi,H. et al. (2008) Statistical validation of peptide identiﬁcations in large- scale
proteomics using the target-decoy database search strategy and ﬂexible mixture
modeling. J. Proteome Res, 7, 286—292.

D0dds,E.D. et al. (2006) Enhanced peptide mass ﬁngerprinting through high mass
accuracy: exclusion of non-peptide signals based on residual mass. J. Proteome
Res, 5, 1195—1203.

Du,P. and Angeletti,R.H. (2006) Automatic deconvolution of isotope-resolved mass
spectra using variable selection and quantized peptide mass distribution. Anal.
Chem, 78, 3385—3392.

Einstein,A. (1905) Does the inertia of a body depend upon its energy content?
Ann. Phys, 18, 639—641.

Frahm,J.L. et al. (2006) Accessible proteomics space and its implications for peak
capacity for zero-, one- and two-dimensional separations coupled with FT-ICR and
TOF mass spectrometry. J. Mass Spectrom, 41, 281—288.

Hall,M.P. et al. (2003) Mass defect tags for biomolecular mass spectrometry. J. Mass
Spectrom, 38, 809—816.

Hastie,T. et al. (2001) The Elements of Statistical Learning; Data Mining, Inference,
and Prediction, Vol. 22, Springer, New York.

Inczedy,J. (1998) Compendium of Analytical Nomenclature: Deﬁnitive Rules 1997
(IUPAC Chemical Nomenclature). Blackwell Science.

Jaitly,N. et al. (2009) Decon2LS: an open-source software package for automated
processing and visualization of high resolution mass spectrometry data. BMC
Bioinform, 10, 87.

LeBlanc,A. et al. (2009) Improved detection of reactive drug metabolites with bromine-
containing glutathione analog using mass defect and isotope pattern matching.
In American Society for Mass Spectrometry, Annual Conference. Philadelphia, PY.

Lehmann,W.D. et al. (2000) The information encrypted in accurate peptide masses-
improved protein identiﬁcation and assistance in glycopeptide identiﬁcation and
characterization. J. Mass Spectrom, 35, 1335—1341.

Liaw,A. and Wiener,M. (2002) Classiﬁcation and regression by randomforest. R News,
2, 18—22.

Mann,M. (1995) Useful tables of possible and probable peptide masses. In 43rd
Conference on Mass Spectrometry and Allied Topics.

P0urshahian,S. and Limbach,P.A. (2008) Application of fractional mass for the
identiﬁcation of peptide-oligonucleotide cross-links by mass spectrometry. J. Mass
Spectrom, 43, 1081—1088.

Pruitt,K.D. et al. (2007) N CB1 reference sequences (RefSeq): a curated non-redundant
sequence database of genomes, transcripts and proteins. Nucleic Acids Res, 35,
D6l—D65.

R Development Core Team (2008) R: Language and Environment for Statistical
Computing. R Foundation for Statistical Computing, Vienna, Austria.

Renard,B. et al. (2008) N ITPICK: peak identifcation for mass spectrometry data. BMC
Bioinform, 9, 355.

Sing,T. et al. (2007) ROCR: visualizing the performance of scoring classiﬁers.
R package version 1.0-2. Available at http://rocr.bioinf.mpi-sb.mpg.de/

Steen,H. and Mann,M. (2002) Analysis of bromotryptophan and hydroxyproline
modiﬁcations by high-resolution, high-accuracy precursor ion scanning utilizing
fragment ions with mass-deﬁcient mass tags. Anal. Chem, 74, 6230—6236.

Steen,H. et al. (2001) Mass spectrometric analysis of a UV-cross-linked protein-DNA
complex: tryptophans 54 and 88 of E. coli SSB cross-link to DNA Protein Sci., 10,
1989—2001.

Sweet,S.M.M. et al. (2006) Strategy for the identiﬁcation of sites of phosphorylation
in proteins: neutral loss triggered electron capture dissociation. Anal. Chem, 78,
7563—7569.

Tiller,P.R. et al. (2008) Fractional mass ﬁltering as a means to assess circulating
metabolites in early human clinical studies. Rapid Commun. Mass Spectrom, 22,
3510—3516.

Wolski,W.E. et al. (2006) Analytical model of peptide mass cluster centres with
applications. Proteome Sci., 4, l8.

Zhang,H. et al. (2008) Mass defect proﬁles of biological matrices and the general
applicability of mass defect ﬁltering for metabolite detection. Rapid Commun. Mass
Spectrom, 22, 2082—2088.

 

797

112 /810's112u1nofp101x0's31112u1101u101q//:d11q 111011 pop120111m0q

9IOZ ‘Ig lsnﬁnv 110::

