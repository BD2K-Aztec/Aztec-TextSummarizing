ORIGINAL PAPER

Vol. 28 no. 23 2012, pages 3089—3096
doi: 10. 1093/bioinformatics/bts5 85

 

Systems biology

Advance Access publication October 9, 2012

Optimal design of stimulus experiments for robust
discrimination of biochemical reaction networks

R. J. Flassig” and K. Sundmacher1 ’2

1Otto—von—Guericke University, Process Systems Engineering, Universitatsplatz 2, 2Max Planck Institute for Dynamics of
Complex Technical Systems, Process Systems Engineering Sandtorstr. 1, D—39106 Magdeburg, Germany

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: Biochemical reaction networks in the form of coupled
ordinary differential equations (ODEs) provide a powerful modeling
tool for understanding the dynamics of biochemical processes.
During the early phase of modeling, scientists have to deal with a
large pool of competing nonlinear models. At this point, discrimination
experiments can be designed and conducted to obtain optimal data
for selecting the most plausible model. Since biological ODE models
have widely distributed parameters due to, e.g. biologic variability or
experimental variations, model responses become distributed.
Therefore, a robust optimal experimental design (OED) for model dis-
crimination can be used to discriminate models based on their re-
sponse probability distribution functions (PDFs).

Results: In this work, we present an optimal control-based method-
ology for designing optimal stimulus experiments aimed at robust
model discrimination. For estimating the time-varying model response
PDF, which results from the nonlinear propagation of the parameter
PDF under the ODE dynamics, we suggest using the sigma-point ap-
proach. Using the model overlap (expected likelihood) as a robust
discrimination criterion to measure dissimilarities between expected
model response PDFs, we benchmark the proposed nonlinear design
approach against linearization with respect to prediction accuracy and
design quality for two nonlinear biological reaction networks. As
shown, the sigma-point outperforms the linearization approach in
the case of widely distributed parameter sets and/or existing multiple
steady states. Since the sigma-point approach scales linearly with the
number of model parameter, it can be applied to large systems for
robust experimental planning.

Availability: An implementation of the method in MATLAB/AMPL is
available at http://www.uni-magdeburg.de/ivt/svt/person/rf/roed.html.
Contact: flassig@mpi-magdeburg.mpg.de

Supplementary information: Supplementary data are are available at
Bioinformatics online.

Received on January 19, 2012; revised on September 4, 2012;
accepted on September 21, 2012

1 INTRODUCTION

Mathematical models of complex biological processes provide
the basis for systems understanding. They are of vital importance
for generating predictions of systems behavior based on hypothe-
sized mechanisms. In the case of limited experimental access to
biological systems, models can help to ﬁnd missing links and

 

*To whom correspondence should be addressed.

provide a tool to aggregate existing knowledge and data. In
this work, we focus on mathematical models in the form of
coupled ordinary differential equations (ODEs), which are
being used to describe dynamics of biochemical reaction net-
works, e.g. signal transduction, metabolic or genetic regulation,
on a deterministic, (semi-)mechanistic basis. Here, scientists are
often facing limited or even contradicting knowledge about the
underlying mechanisms, conﬁned experimental possibilities,
large biological variability as well as measurement noise. This
leads to largely distributed model parameter sets, which in com-
bination with several plausible alternative model structures ren-
ders model-based prediction highly uncertain. Therefore,
model-based experimental design (e. g. optimal stimulus or add-
itional experimental readout selection) is used to generate experi-
ments that yield optimal experimental data to (i) reduce the
spread in the model parameters (=optimal parameter identiﬁca-
tion) and/or (ii) reduce the pool of plausible models (=optimal
model discrimination).

Much work on optimal experimental stimulus design (OESD)
for biological systems focuses on information maximization with
respect to parameter identification (Balsa-Canto et al., 2008;
Bandara et al., 2009; Heine et al., 2008; Raue et al., 2010;
Schenkendorf et al., 2009a). Here, for a given pool of plausible
ODE models, OESD is used to find experimental conditions that
reduce the parameter uncertainties and thus model response vari-
abilities. The methods used to quantify parameter uncertainties
and model response variabilities include linearization,
sigma-points (Julier et al., 2000), proﬁle likelihood (Raue et al.,
2009) and Markov chain Monte Carlo (MCMC, Geyer, 1992;
Vanlier et al., 2012). An OESD aiming at model discrimination
for biological systems has been addressed by few authors (Apgar
et al., 2008; Melykuti et al., 2010; Skanda and Lebiedz, 2010).
Although measurement noise has been included, a rigorous con-
sideration of model response variabilities due to distributed par-
ameters has been missing so far. For chemical reaction kinetics
and biotechnology, there exists some work on designing dynamic
stimuli for the purpose of model discrimination (Asprey and
Macchietto, 2002; Box and Hill, 1967; Kremling et al., 2004).
As has been illustrated, the consideration of model response
variabilities strongly improves the designed experiments and ex-
perimental data quality (Chen and Asprey, 2003; Donckels,
2012; Michalik et al., 2010). Therefore, linearization of the sys-
tem’s parameter mapping has been used. However, by using the
so-called Sigma-Point method (Julier et al., 2000), (Heine et al.,
2008), (Schenkendorf et al., 2009a) showed that the performance

 

© The Author 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬁhO'slcumo[pJOJXO'sopchOJuroiq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

R.J.Flassig and K.Sundmacher

 

of a linear OED for best parameter estimation is rather poor for
nonlinear systems having widely distributed parameters.

An experimental design aimed at model discrimination is typ-
ically generated at a point where existing data do not provide
further discriminative information for a pool of competing, vali-
dated and identiﬁable models. With these models, robust experi-
mental designs can be generated, which presumably yield data
with optimal discrimination information. Since predictions with
ODE models depend on the model parameters, identiﬁability is
important as it ensures the existence of a unique solution to the
parameter estimation problem and, consequently, unique model
predictions (Raue et al., 2009). A non-identiﬁable model would
yield non-unique model predictions under altered experimental
design conditions, as there exists a set of several solutions to the
parameter estimation problem. Robustness of the experimental
design is achieved by considering (i) pure uncertainty about the
model itself, (ii) distributed model predictions that arise from
distributed model parameters and (iii) design variabilities (e. g.
variations of the applied stimulus) during the conduction of
the experiment.

In this work, part (ii) of design robustiﬁcation for nonlinear
models is considered, focusing on computational efﬁcient and
accurate estimation of the nonlinear propagated parameter prob-
ability distribution function (PDF) in an optimal control frame-
work. We suggest using the sigma-point method as an alternative
to the classical linearization approach. Therefore, both
approaches are presented, applied and compared in the light of
OESD for robust model discrimination, assuming perfect experi-
mental conduction. In the following section, we describe the es-
sential parts of our design approach, including (i) ODE modeling
of biological reaction networks with and extended interpretation
of distributed determinism, (ii) the model overlap as a PDF-
based discrimination criterion, (iii) linearization and sigma-point
methods and (iv) two numerical approaches to solve optimal
control problems. Then, using two numerical examples, we for-
mulate the optimization problem and benchmark the lineariza-
tion approach against the sigma-point approach (Section 3).

2 METHODS

2.1 Dynamic modeling of biochemical reaction systems

ODEs provide the modeling basis to describe the dynamics of biochem-
ical reaction networks. The dynamics of the internal states
x(t,u(t),0x) e AX C R”", e.g. protein concentrations, is determined by
the solution of an initial value problem of the form

$.41) = axe), no). 0,.) (1)

with initial system states x(to) = x0 and right-hand side function
f(x(t), u(t), 0X) describing biologic interaction mechanisms, which depends
on the system states x(t), (multiple) inputs u(t) (=stimulus) and kinetic
parameter set 0X. Assuming f to be Lipschitz in x(t), u(t) and continuous
in t, the readout variables are determined by

ysimaa  = g(x(ta 0X): 03’): 

where the function g—assumed to be sufﬁciently smooth—relates
the internal system states to the readouts of the experiment with corres-
ponding readout parameters 0y, which together with dynamic parameters
and initial conditions are merged into the model parameter vector
0 = [0X, 0y]T, with redeﬁned dynamic parameter vector 0 E [0X,xo]T.

The dynamic model deﬁned by Equations (1) and (2) can be understood
as a time-dependent mapping from the model parameter space
Alex x Agy = A0 C R“ to the model output space Ay C IR“,

hlexAg—mﬂly (3)

(t9 0)'_>h(t9  = ysim(t9  

2.2 Distributed determinism

Although biological systems might follow deterministic rules, repeated
measurements, even though with very accurate measurement techniques,
will yield different results. The reasons for that are manyfold.
Additionally to unavoidable measurement errors, biologic variability,
i.e. systems with intrinsically distributed parameters, can induce a large
spread in the transient dynamics and stationary behavior. In the case of
the existence of multiple steady states, this spreading effect might even be
more pronounced. Varying parameters during the measuring procedure
and local parameter perturbations by non-stationary noise also contrib-
ute to a distributed measurement signal (Lorenz et al., 2007). Complex,
nonlinear models of biological systems might also behave chaotic, further
contributing to distributed response measurements. Thus, the conven-
tional sharp, deterministic system representation needs to be extended
by the notion of distributed determinism, i.e. although the system
might completely be deterministic, its perceived signals are distributed
realizations of the underlying deterministic mechanisms. This can be
done by considering the parameters, and hence, the model responses as
random variables 6) and Y, respectively, each characterized by a PDF.
We point out that, within this interpretation, the system and hence the
model is assumed to naturally possess distributed parameters.
Consequently, a distributed response is not solely explained by additive
measurement noise but also by other sources of variations, which may be
represented as distributed parameter sets.

Let the model parameters be distributed according to some well-
deﬁned PDF p®(0), with 0 6 Ag being a realization of G). The PDF of
the random model response Y at time t can be derived from the normal-
ized integral over all possible parameter and corresponding response real-
izations, weighted with the parameter PDF, i.e.

(My, t)
9 t = — 9 5
My ) Hem, 0111 ( )
with
my. r) = [A 1y[h(r.o)1p®(0)d0. (6)
0
where 1y[h(t, 0)] represents the indicator function
_ 1, if y = h(t,0)
1y[h(t, 0)] — {0, else. (7)

The normalization employs the L1 -norm with respect to y e Ay. Note
that y represents an arbitrary possible realization of Y in Ay, whereas
h(t, 0) describes the model response at time t for a ﬁxed stimulus time
course u(to —> t) given parameter realization 0. Consequently, for every
single point in time, the shape of Equation (5) is determined by the par-
ameter PDF, the choice of model [Equations (1) and (2)] and stimulus
time course (=experimental design). Consequently, the discrimination
process can be robustiﬁed by discriminating competing models based
on their model response PDFs [Equation (5)], accounting for variabilities
in the parameters and model-speciﬁc mapping to the response space.

2.3 Robust design criteria for model discrimination

Here, we present the model overlap as a robust discrimination criterion,
measuring dissimilarities of model response PDFs used to rate the dis-
criminative power of a design during optimization. We deﬁne the general

 

3090

112 ﬁhO'slcumoprOJXO'sopchOJuroiq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Optimal discriminative stimulus design

 

model overlap as the probability product kernel used in vector machine
learning to measure statistical distances for the sake of discriminative
learning (Jebara et al., 2004). Following Jebara et al., (2004), the prob-
ability product kernel of two multivariate PDFs paw p§|B e L2(Ay) is
deﬁned as the scalar product

«Dena» = [A may. wow/may. wordy (8)

with the densities being raised to some power 1) e IR+\{0}. It provides a
bounded, positive-deﬁnite measure (Jebara et al., 2004) of similarity be-
tween distributions on the set Ay, whereas the parameter 1) controls the
weighting of regions with small versus large densities.

From this, the average overlap of the time course is

ea)». = "if; <I>(rk.u(rk)). (9)
t k=1

where D 6 ID = 'H' x [U x Y represents the experimental design within the
feasible design region ID, encompassing for instance selection of discrete
measurement time points tk e 'II, stimulus design u(t) e [U and readout
design g e V. Using the model response PDFs pylm(y, t, u(t)) from
Equation (5) for two competing models, m e {A, B} in Equation (9) pro-
vides us with a measure of average model dissimilarities. For 1) = 1, the
overlap is the expected model response probability of model A under
model B and vice versa [Equation (8)]. In this case, assuming one of
the models to be true, the overlap yields the expected likelihood of the
other model depending on the experimental design D. Consequently, an
optimal model discrimination design D minimizes Equation (9).
Singh (1998) proposed to use Equation (8) with p=1/2—known as
Bhattacharyya’s afﬁnity between distributions—for discriminating non-
linear regression models. It is closely related to Hellinger’s distance, which
represents a symmetrized approximation to the Kullback—Leibler diver-
gence (Topsoe, 2000). In this work, we use the overlap as deﬁned in
Equation (9) with p: 1, which we refer to as model overlap, as this dir-
ectly represent the time-averaged, expected likelihood of one model under
the other. In this form, it has been applied by Lorenz et al., (2007) to
discriminate dynamic models based on the distributional ﬁt performance.
In Schenkendorf et al., (2009b), it is used to optimize an initial condition
for a substrate uptake model to discriminate two competing kinetic
approaches.

2.4 Estimation of nonlinear PDF mapping

If the solution h(t, 0) can be obtained in closed form, it is straightforward
to derive the model response PDF for a given parameter PDF using
Equation (5). However, in most of the cases, the model response h(t, 0)
for a speciﬁc parameter realization is obtained by numerical integration.
Here, besides random sampling techniques based on Monte-Carlo
simulations, the approximate model response PDF may also be obtained
by deterministic sampling, e.g. by simple enumeration, optimized Latin
hypercubes of the parameter space and application of Equation (5).
For an inﬁnite number of samples, the true model response PDF
can be constructed from these samples, which can be used for a
subsequent evaluation of Equation (9) to judge the quality of a given
design. Such procedures become computational inefﬁcient for
increasing number of model parameters and cannot be used in an opti-
mization framework. Therefore, an approximation has to be made.
From initial data, one may obtain accurate estimates for the true
parameter PDF, e.g. by MCMC sampling, which can be approxim-
ated by unimodal normal PDFs p®(0) 2 N(,a®, 29), possibly
multivariate. The model response PDF can also be approximated by
pylm(y, t,u(t)) 2 N(,uylm(t,u(t)), 2Y|m(t,u(t))). Then, the integration in
Equation (8) can be performed to yield the approximate overlap

—1/2
qDA/‘(t’ “(0) : (IEYIA I IEYIBIIZEIIAB eIY|A+IY|B) , (10)

 

where

T —1 T —1 _1
IYIm 2 “arm EYlqu’Ylm _ Mam EYlm 2:YIABEmml‘YIm:

—1
EYlAB = [EQIIA + EQIIB] ; IEYImI = (2”)nYdet(2Ylm)/2-

Here, m = {A, B} represents the model index, ,uylm E ,uYIm(t, u(t)) the fly-
dimensional true mean and Eylm E 2Y|m(t, u(t)) the true variance-
covariance matrix of the corresponding model response PDFs, which
both depend on the model structure m, measurement time point t, stimu-
lus u(t) and readout selection. For details about the derivation, see for
instance, J ebara et al. (2004). For n, discrete measurement time points tk,
the approximate mean overlap is then

"t

(cpl/(1)». = "12 wok. not». (11)

tk=1

This approximation dramatically reduces the computational costs as
only the two ﬁrst statistical moments (i.e. expectation and variance-
covariance) need to be estimated. The task of solving Equation (5) to
obtain model-response PDFs and subsequent integration of Equation
(11) to evaluate the discriminative power of a given design in an opti-
mization framework is then reduced to estimate the time course of mean
vector ,aylm(t,u(t)) and variance—covariance matrix 2Y|m(t,u(t)) of two
model response PDFs for given parameter expectation ,LLle and vari-
ance—covariance 29'”, (Fig. 1). As true mean and variance—covariance of
the parameters are unknown, these are replaced by their estimates, i.e.
Me, —> E[®] and 23 —> C[®], which we will do in the following. Note
that for skewed PDFs one should apply a transformation, e.g. Box—Cox
or inverse hyperbolic sine transformation to achieve normality of the
PDF (Box, 1964; Johnson, 1949). In this way, our presented robust
OESD method is not restricted to normal PDFs only.

Estimates of response expectation and variance—covariance can be ob-
tained by linearizing the system at additional computational costs that
scale linear with the number of parameters using forward-sensitivity ana-
lysis. But this approach can become suboptimal or yield even misleading
designs (Section 3.2). On the additional expense of (9013,) estimates may
be improved by a quadratic approximation of the system, which may
become infeasible for larger systems, as do Monte Carlo-based
approaches. Worst-case approaches yielding a minirnax design have
also been proposed to take model response variabilities into account
(Walter and Pronzato, 1997; Skanda and Lebiedz, 2012). However,
these are in general NP-hard (Du and Pardalos, 1995). The sigma-point
method has an additional computational expense of 0(n0), which com-
pares to linearization.

2.4 .1 Estimation based on linearization The classical approach to
estimate model response variabilities is linearization of the nonlinear
model mapping h(t, 0) with respect to the parameters. The linearization
of the model response is given by applying the chain rule to Equation (2)

th:  = 11(1)  + SO: y)T[0:E[®](0 _  

ah(t, 0)

30 and state-

with response sensitivity matrix S(t, y) = WSXU, x) +

sensitivity matrix Sx(t, x) = %, which can be obtained by solving
d 8f 8f
—Sx(t, x) = —Sx(t, x) +— (13)
d1 0=E[®] 3" 0=E[®] 36' 0=E[e]

 

 

with initial condition SX(to, x0) along the systems dynamics, which is
known as the forward-sensitivity matrix equation. The additional com-
putational effort is of order 0010,), as only ngx additional ODEs have to
be solved in Equation (13), since % = 0”x “9r. One may also formulate an
adjoint system to derive the state sensitivities in a backward manner or
use numerical differentiation.

 

3091

112 /810's1eumoprOJXO'sopemJOJuroiq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no 22

R.J.Flassig and K.Sundmacher

 

 

 

 

Exec Ma In
peﬂlﬂlf’) I "P g * might???) #90191):
IE _ _ I IE [3
        —}     

Parameter Space

Response Space

Criterion Space

 

Fig. 1. Approximation of nonlinear PDF mapping

Having determined the parameter sensitivities of the system, the linear
estimates of expectation and variance—covariances of the model response
PDF can be calculated to yield

EfIY] = h(t, E191) (14)

can = so. y) C[®] so. y)T. (15)

For nonlinear models, the estimate of the expectation is typically
biased, i.e. Bi: EﬂY] — ,ay 75 0, and errors are introduced at second
and higher orders. The quality of the predicted variance—covariance
cannot readily be judged as the errors are of fourth and higher order,
whereas the contributions depend on the system. Notice that the linear
design approach yields a local estimate in the parameter space, i.e. par-
ameter-dependent coexisting stable states will be missed, resulting in sig-
niﬁcant estimation errors in both moments (Section 3.2). The estimators
are exact for linear systems, as higher-order terms vanish.

2.4.2 Estimation based on sigma-points Julier et al. (2000) intro-
duced the sigma-point method for advanced Kalman ﬁltering and state
estimation. It is based on the idea that with a ﬁxed set of parameters
(sigma-points), it is easier to approximate a nonlinearly transformed PDF
by a Gaussian distribution than the nonlinear transformation itself. J ulier
et al. (2000) show that expectation and variance—covariance of a random
variable Y, given by a transformation Y = h(t, 9), possibly nonlinear, of
a random variable 6) with expectation E[0] and variance—covariance C[0]
can be estimated according to the following procedure:

(1) Select 2n0 + 1 sigma-points in the original domain according to

0(0) 2 E[®]; 003 = 0(0) a: ,m, + New”),

where «/C[®]w is the ith column of the square root of the vari-
ance—covariance matrix.

(2) Propagate these points through the model
y? = h(t, 0(0).

(3) Estimated expectation and variance—covariance of the transformed
variable based on the sigma-points are given by the linearly
weighted sums

no
EfIY1= Z wwyl” (16)

i=—n9

0? [Y1 = (1 — a2 + n(y§°) — Em) (y?) — Etm)T+ (17)

+  w"’(y§” — Em) (y?) — EtiYI)T

i=—n9

 

A W(:I:l)

with weights w(°) 2 "0+, , I = m and A = a2(no + K) — no.

According to J ulier et al. (2000), the errors of the expectation estimate
is of fourth and higher order, whereas the variance—covariance estimates
have an error of fourth and higher order. This, however, only holds for
scalars, i.e. no 2 1, as pointed out by Gustafsson and Hendeby (2008).
For no >1, the sigma-point parameters (a, ,8, K) can be used to tune the
estimated moments by including a priori knowledge about the PDFs, i.e.
,8 and 1c allow to account for higher-order moments of the parameter
PDF and should be set to ,8 = 2 for an initial Gaussian, whereas for
n0>3 one should choose K = 0. Further, or controls the sigma-point
spread and should lie within 0<a 5 1 (Julier et al., 2000). The
sigma-point has several advantages:

0 no need to calculate derivative information (neither J acobian nor
Hessian have to be available or need to exist), which makes this
method numerically robust and applicable to a wide range of
system classes,

0 use of curvature information of the system,

0 deterministic sampling method with computational effort that scales
linearly with the number of distributed variables, i.e. 0(n0),

0 since each sigma-point is independently propagated, parallelization
can easily be applied to speed up estimate calculation of the trans-
formed expectation and variance—covariance.

2.5 Robust optimal stimulus design

The problem of ﬁnding an optimal stimulus design can be stated as an
optimal control problem. Given a nonlinear dynamic system of the form
Equations (1) and(2) and corresponding parameter set (expectation and
variance—covariance), an optimal stimulus is an admissible control
deﬁned over an interval [to, tf], say experimental time window, at which
a cost function assumes its inﬁmum (or supremum) with the set of all
admissible controls. Robustness of such a control with respect to distrib-
uted model responses can be achieved by incorporating expectation and
variance—covariance into a robust design criterion (e. g. model overlap).
Within the sigma-point approach, variabilities in the stimulus conduc-
tions can also be accounted by interpreting a design u(t) as a time-de-
pendent mean of a distributed variable U. Then, for a design u(t), the
spread in the model response PDF is determined by the propagation of
sigma-points given by mean and variance—covariances of (i) model par-
ameters and (ii) stimulus. The problem of ﬁnding an optimal control may
be solved by (i) Hamilton-Jacobi—Bellman, (ii) variational or (iii) NLP-
based approaches G\Ievistic nonlinear programming, 1997). We use the
following two direct NLP-based approaches (Biegler, 2007), which can
easily be combined with the methods discussed in Sections 2.4 and 2.4.1
for mapping distributed parameters onto the design criterion:

0 Direct sequential approach: A control vector parameterization in
combination with numerical integration of the model equations.
This approach is suited for design problems without nonlinear

 

3092

112 /810's1eumoprOJXO'sopemJOJutotq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no 22

Optimal discriminative stimulus design

 

path constraints and stable behavior with respect to variations in the
control and parameters.

Direct simultaneous: A full discretization of the problem, e. g. control
vector and state/response vector parameterization, is based on or-
thogonal collocation on ﬁnite elements. If the design problem in-
cludes nonlinear path constraints, this solution approach can be
beneﬁcial, because feasibility of the solution is ensured at the collo-
cation points of each ﬁnite element.

Both NLP approaches are typically non-convex, i.e. there exist several
local and possibly one global optimal design solution. Therefore, resulting
solutions to the NLP problem are local optima. Global optimality of the
design can be achieved—but is not ensured—by (i) performing local op-
timizations from different initial starting points and/or (ii) deterministic/
stochastic/heuristic global optimizers (Floudas and Gounaris, 2009;
Horst et al., 2000; Zabinsky, 2003). We point out that optimal design
solutions need not necessarily be global in real-life applications. Local
optimal solutions can be very close to the global solution with respect to
the design criterion. Therefore, non-convexity allows to account for fur-
ther experimental constraints—restricting the degrees of freedom in the
design space—without losing, e.g. discriminative power. In the applica-
tions, we use global stochastic and multistart optimizations to avoid a
biased comparison between linearization and sigma-point approach.

3 APPLICATION
3.1 Application 1: signaling cascade

The highly conserved mitogen-activated protein kinase signaling
cascade (Pearson et al., 2001) with two different hypothesized
negative feedbacks is used as a nonlinear test system for bench-
marking the two design approaches with respect to estimation
accuracy and design quality. Multistep signaling cascades are
enrolled in many signal-transduction processes of cells to sense
and react to external signals. Upon an external stimulus, e. g.
growth factor, hormones or stress signals, cascades transduce
the signal from the cell membrane to the nucleus to start different
cell programs. The respective ODE systems—adapted from
Behar et al. (2007)70f two model candidates m e {A,B} that
describe the change in protein concentration of the phosphory—
lated forms are

 

 

 

d * krmu(t)x1m(t) vzmx’l‘mU)
— I = — _ m
dtxlm< ) Klm + leU) K2?” + xIm r1
d * k3mx’fm(t)x2m(t) V4mx§m(t)
— I = — _ m
dt x2m( ) K3m ‘I' x2m(t) K4m + 953,110) r2
1 36* (t) = k5mX§m(t)x3m(t) _ V6mX§m(t)
(It 3m KSm “I” x3m(t) K6m + Xgma)

with model A:

rlA = kgAXZ(I)XTA(t) ; I"2A = kIOAx;A(t)x2A(t)

 

3x... (0 = k7AX§A(t)X4A(t) _ V8AxZA(t)
dt 4A K7A + X3A(t) K8A + XZAU)
and model B:
= k93x33(t)xIB(t) . = k103x33(t)x23(t)
K93 + X130) ’ K103 + x330)

no x43(t), x230).
For both models, we assume

x2220) = xima) + x220)

X3100) = 0

with the total concentration of each species  as an additional
model parameter and i e {1, 2, 3, (4) B}.

The measurement response signals are deﬁned as
y1m(t) = Xgma) ‘I' 06 and y2m(t) = X§m(t) ‘I' 06) 

where 196 represents additive measurement noise, which we
assume to be normally distributed with zero mean and variance
0?. We assume that the response signals can be measured at n,
speciﬁc time points. Based on an initial stimulus design, we
adjust the model parameters so that both model responses
match up to a small error, which does not allow to prefer one
over the other model, to mimic the starting point of an OESD for
model discrimination. Identiﬁability of the models has been
checked with the software tool DAISY in combination with
global sensitivity analysis (see Supplementary Material, Bellu
et al., 2007; Sobol’, 1993). Because biological systems often
follow a log-normal distribution, we apply a log-normal trans-
formation to the response to improve the normal approximation
used in the estimation approaches for the response PDF
(Sections 2.4 and 2.4.1). Therefore, we redeﬁne the response
signal Equation (18) used for the overlap calculation as

37m“) = logo/MU) + A), (19)

with i = 1, 2, A >0. For each model, we assume that all dynamic
parameters are log-normally distributed, with nominal value
being the expectation E10g[®]=0 and diagonal covariance
matrix 1/C10g[®] = diag(nELog[®]), with scaling parameter n.
The measurement noise is typically independent on the stimulus
design and thus held constant at 06 = 0.01. The sigma-points for
the log-normal parameter PDF are obtained in the following
way: In the parameter space, we derive the normal equivalents
of log-normal expectation and covariance to calculate the normal
sigma-points, which we then exponentiate (see Supplementary
Material). The log-normal sigma-points are propagated through
the model, including Equation (19), to obtain the normal esti-
mates via Equations (16) and (17). In the following, we drop the
tilde from the redeﬁned response signal in Equation (19).

Following the direct sequential approach, the stimulus (single
input) is parameterized as

u(U, t) = uk for tk S t S tk+1,

with [U], = (uk,dtk)T,k e {0,  whereas dtm, E 0. Here,
uk represents the amount of stimulus between the time point tk
and tk+1 = dtk + 21:0 tj. If for the last time point, we have
tnu <tf, we put u(U, tnu <t 5 tf) = unu. On the other hand, if
tnu > tf, the design is given a penalty. Depending on the estima-
tion method 8 e {5, 8}, the resulting optimization problem for
discriminating between models A and B is formulated as an NLP
problem (see Supplementary Material for details), i.e.

U; = argUrerbigDO‘g (U) E (M (EZIB[Y], ciwm, U))l (20)

 

3093

112 /810's1eumoprOJXO'sopemJOJutotq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no 22

R.J.Flassig and K.Sundmacher

 

subject to systems dynamic, additional constraints and method
to estimate E‘; IE [Y] and CZIB [Y].

The number of optimization parameters is nutot = 39, which
allows 20 stimulations uk with 19 stimulus durations dtk.
Because the problem is non-convex, we use a hybrid optimization
strategy, consisting of the evolutionary-based CMA-ES algo-
rithm (Covariance Matrix Adaptation Evolution Strategy
Hansen and Ostermeier, 2001), in combination with a subsequent
gradient-based optimizer. Because of the stochastic nature, the
hybrid optimization is performed 40 times for each parameter
variance level, which we derive from the scaling parameter n. The
benchmark is based on a Monte Carlo veriﬁcation of the result-
ing optimal stimulus designs. For each optimal design, the over-
lap, including expectation and variance—covariance of the model
responses, is calculated based on sampling the parameter space
104 times for each model and corresponding optimal stimulus
design (see Supplementary Material for details). The relative
mean-squared error (MSE) of the moment estimates are given by

1 "y "t M8_MM 2
(6M)5 ZTtnymgBZZ: (— MM )

with M‘9 being the moment estimates of the best designs (expect-
ation EZIB[Y,-], variance—covariance split into variance
VAR‘ZIB [Y1] and covariance terms COVZIB[Y1]). The Monte
Carlo reference is represented by MM.

In Table 1, we see that for all parameter variance levels, both
methods have negligible relative MSE in the mean response es-
timates (maximal MSE: (eE)£ <10‘7; (eE)5 <10‘9). In contrast,
the relative MSEs for linearization increases with parameter
variance levels up to 0.03 for the variance and 0.18 for the co-
variance estimates. Here, the sigma-point approach performs
better with maximal relative MSE of the variance 0.007 and co-
variance 0.096. In this application, both approaches estimate
mean responses of the models very well, although the maximal
MSE of the sigma-points is still two orders of magnitudes smaller
than the maximal MSE for linearization. For the (co)variance
estimates, the sigma-point approach consistently outperforms
linearization approach for increasing parameter variance level.

In the lower part of Table 1, we compare the discriminative
power of the resulting designs for different parameter variance
levels. Comparing the Monte Carlo veriﬁcations, we see that,
for small variances, both methods yield designs that have
the same discriminative power (OLM E 0’” (Uﬁ) versus
05M E 0M (U£)). However, for widely distributed parameters
(starting at n = 0.3) sigma-point based designs perform up to

1.3 times better than linearization-based designs and their esti-
mates coincide with the MC validation, which is not the case for
linearization. For both methods, optimization time for one
design is 1.3 :I: 0.1h on a standard desktop computer (4 GB
RAM, 3 GHz quad core processor) and mainly determined by
the optimizer itself, whereas the validation time (104 MC sam-
ples) of a single optimal design is 0.4 :I: 0.1h.

In Figure 2, we show the best designs based on the estimates
for two levels of parameter variances and the ﬁrst response com-
ponent. For small parameter variances, both designs yield the
same discriminative power. For widely distributed parameters,
we see that both methods tend to minimize the amount of stimu-
lation, as this results into little response variances at maximal
distances between expected model responses. Although the linear
design is characterized by a strong stimulation right at the be-
ginning, with a subsequent plateau of little stimulation, the
sigma-point design starts with an even stronger initial pulse, fol-
lowed by two small pulses.

3.2 Application II: Schliigl model

In this section, we compare the performance of the nonlinear
design based on the sigma-point approach to the linear design
in the presence of multiple steady states. The Schlégl model is a
canonical example of a biochemical reaction system exhibiting
bistability (Schlégl, 1972). It describes an autocatalytic,

 

 

 

 

 

 

 

 

 

 

 

{a Emle fur 'ufit} {b1 Hyman for mite}

E E

 a

E“ E.

h 11 11. 1 1.3 II 11-1 _ 1 1.5 H

lime [1:1 um:th

[C] Eﬂl [yl] fer “1113(1) {if} Efl'dm [111] for uflzt}

E 1 I E.

ELL] 11.15 1'15 E

£1115. 11.5 1,115. g

a ‘ 11.2 ':

E11.115 0.115 E-
11 #

 

 

 

 

 

 

[1'1 1 110 1
Iimcll'll t'IrrH:I|'II

Fig. 2. Expected responses of models A (crossed square), B (crossed circle)
on log-scale for optimized stimuli u5 (t) (crossed triangle) and corresponding
, /VAR,|m[Y1] bands [ﬁrst component only, (a)/(b) n = 0.01, (c)/(d) n = 0.4]

Table 1. Relative MSEs of moment estimates and overlap (scaled 105) of the best designs based on linearization/sigma—point estimation and corres-

ponding Monte Carlo veriﬁcation

 

 

n = a,/E[0,-] 0.01 0.1 0.2 0.3 0.4

(eE)£ (eE)S 0 0 0 0 0 0 0 0 0 0
(WARE (WARP 0 0 0.002 0 0.001 0 0.01 0.007 0.03 0.007
(ecov)£ (ecov)5 0 0 0.02 0.002 0.059 0.015 0.106 0.046 0.181 0.096
05 08 0.2 0.2 2 2 2 2 2 3 3 3
ogM 0§M 0.2 0.2 2 2 2 2 3 3 4 3

 

 

3094

112 /810's1eumoprOJXO'sopemJOJutotq/ﬁd11q 11101; pepeolumoq

910K ‘09 lsnﬁnV no 22

Optimal discriminative stimulus design

 

[3} Optimized stimulus tifﬁj

 

“3} Linear estimate: DRUF] = 0.0114

[c] Monte Carlo estimate: OM{U5[:) = 0.1?

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

E
:r :I =
.15 .ﬁ '
E 2 W a I
U 1 . . .
IJITIE'. ll] time [I] t1me[]]
{d} Optimized stimulus tifu} {a} Sigma—Point estimate: D‘S[Uf] = I104 {i} Monte Carlo estimate: UquUf] = 11.03
E ii
 4  4 
a :I :I
.15 Li 4:1
a 2 [—1 a 2 a
LI 1 _ 2 [l _ 1
time [I] time [ l] Hm: [I]

Fig. 3. Upper part: (a) Optimal stimulus u5 (t) (bold line) and corresponding , /VARt|m [Y] bands based on linearization and corresponding linear (b) and
MC (c) estimates of expected responses 0 models A (crossed square) and B (crossed circle) for n = 0.35. Lower part (d)-(f): sigma-point based results

trimolecular reaction that, for instance, occurs in post-
translational modiﬁcations of signaling proteins. Two model
alternatives for the rate of concentration change of species x
are given by

$3810) 2 k1 “Sm(“(‘))xr2n(t) — [(296310) — k4xm(t) + k3b,

mum) =u0) or sew» =§<u<0+u20>>

where we assume the four kinetic parameters k1 — k4 as well as
the system parameters a and b to be distributed (9 oc N(E[®],
diag(nE[®])2), the initial condition as X0 oc N(E[X0], (nE[X0])2).
The mean parameter values are taken from Vellela and Qian
(2009), which also discuss the consequences of bi—(multi)stability
for biological modeling in the light of non-equilibrium thermo-
and stochastic dynamics. The model alternatives simply differ in
the input layer sm(u(t)). Parameters a and b represent the con-
centration of two reaction partners a and b of species x, which
both are in constant exchange with a material reservoir. For an
initial, suboptimal experiment with stimulus u(t) = 1, models A
and B cannot be distinguished, given ym(t) = xm(t) + 196 to be the
response signal, where 196 represents additive measurement noise
with zero mean and of. The stimulus is thought to control the
concentration in the reservoir of species a to ﬁnd an optimal
discriminative stimulus, whereas subsequent stimulations can
only be applied after a minimal time period has passed to ac-
count for possible control limitations (see Supplementary
Material for details). Such nonlinear constraint optimization
can efﬁciently be solved within the direct simultaneous approach,
which we apply using orthogonal collocation on 100 ﬁnite elem-
ents (each with three collocation points) to discretize control and
system states. The objective of the resulting non-convex NLP
problem is the same as in Equation (20), however, subjected to
different constraints, i.e. system dynamics in form of a nonlinear
algebraic equation system and additional constraints (details see
Supplementary Material). For the linear design strategy, we im-
plement the sensitivity Equation (13) and corresponding con-
straints. For the sigma-point design, the constraints have to

simultaneously hold for all (2m; + 1) sigma—points. The solver
AMPL in combination with the optimizer CONOPT is used to
solve the aforementioned NLP problem (Drud, 1994). For a
given optimization setup (n and estimation method), the solution
takes about 2 min on a standard desktop computer. Because
CONOPT yields local solutions, the optimization is performed
for 1000 different randomized initial designs for a given opti-
mization setup, from which the best solution is selected.

In Figure 3, we show the resulting stimuli designs for n = 0.35
based on linearization and sigma-point estimation.
Reexamination of the optimized linear design with MC simula-
tions reveals a large underestimation of the estimated overlap:
O£(U£) = 0.004 versus oM(U£) = 0.17, i.e. misleading discrim-
inative power by two orders ofIL magnitude. The local estimation
property of the linear approach yields a highly biased expectation
and underestimation of the variance with relative MSE of 0.44
for the expected response and 6.66 for the variance [see Fig. 3,
estimated response of model B, (b) versus (0)]. The sigma-point
based design ((1) in Figure 3 has a relative MSE of 0.15 for the
expected response and 0.38 for the variance. The overlap esti-
mate of the sigma-point design closely matches the MC valid-
ation [05(U5) = 0.04 versus oM(U5) = 0.03]. Further, the
sigma-point esign performs 5.7 better than the linear design
(OM(US) = 0.03 versus OM(U£) = 0.17). As can be seen in
Figure 3 (e,f), the non-local propagation property of the
sigma-points enables the optimizer to ﬁnd a stimulus that
mostly drives model B to the upper steady state.

4 CONCLUSION

Biological variability in combination with experimental measure-
ment noise results into widely distributed response signals, which
is one of the main challenges when modeling biological system
deterministically with nonlinear ODEs. The parameter set needs
to be extended to a parameter distribution. In this way, natural
variability in the dynamic parameters as well as measurement
noise can be readily accounted for. However, an exact quantiﬁ-
cation is computationally expensive and infeasible in an

 

3095

112 /810's1eumoprOJXO'sot1emJOJutotw/2d11q 11101; pepeolumoq

9IOZ ‘09 lsnﬁnV no 22

R.J.Flassig and K.Sundmacher

 

optimization framework for large systems. Therefore, approxi-
mate descriptions of the PDFs and nonlinear mapping process
between parameter and model response space have to be used.
Here, we have presented a nonlinear design approach based on
the sigma-points within the application of model-based OESD
aimed at model discrimination. We illustrate the application and
performance in combination with two numerical approaches
from optimal control for two nonlinear model examples. Using
the overlap as a robust design criterion based on the model re-
sponse PDFs, we show that in the case of nonlinear models with
widely distributed parameter PDFs, the sigma-point predictions
and designs consistently outperform a linear design approach. In
the case of bi-(multi)stability, we further illustrate the beneﬁt of
the nonlocal propagation property. Finally, the sigma-points
come with several numerical advantages, including linear scaling
of the numerical costs with respect to distributed parameters and
derivative free estimation of nonlinearly mapped expectation and
variance—covariance. The latter property allows applying a
robust OESD to dynamic models that have non-smooth
right-hand side functions, e. g. cybernetic models of cellular me-
tabolism (Ramkrishna, 1982).

ACKNOWLEDGEMENTS

The authors gratefully thank R. Schenkendorf for useful discus-
sions and comments on the manuscript.

Funding: This work was supported by the German Federal
Ministry of Education and Research (BMBF) under grant
0 315 505A.

Conflict of Interest: none declared.

REFERENCES

Apgar,J.F. et al. (2008) Stimulus design for model selection and validation in cell
signaling. PLoS Comput. Biol, 4, e30.

Asprey,S.P. and Macchietto,S. (2002) Designing robust optimal dynamic experi-
ments. J. Process Control, 12, 545—556.

Balsa-Canto,E. et al. (2008) Computational procedures for optimal experimental
design in biological systems. IET Syst. Biol, 2, 163—172.

Bandara,S. et al. (2009) Optimal experimental design for parameter estimation of a
cell signaling model. PLoS Comput. Biol, 5, e1000558.

Behar,M. et al. (2007) Mathematical and computational analysis of adaptation via
feedback inhibition in signal transduction pathways. Biophys. J., 93, 806—821.

Bellu,G. et al. (2007) DAISY: a new software tool to test global identiﬁability of
biological and physiological Systems. Comput. Methods Programs Biomed, 88,
52—61.

Biegler,L.T. (2007) An overview of simultaneous strategies for dynamic optimiza-
tion. Chem. Eng. Process, 46, 1043—1053.

Box,G.E.P. and Cox,D.R. (1964) An analysis of transformations. J. Roy. Stat. Soc.
B, 26, 211—252.

Box,G.E.P. and Hill,W.J. (1967) Discrimination among mechanistic models.
T echnometrics, 9, 57—71.

Chen,H. and Asprey,S.P. (2003) On the design of optimally informative dynamic
experiments for model discrimination in multiresponse nonlinear situations. Ind.
Eng. Chem. Res, 42, 1379—1390.

Donckels,B.M.R. et al. (2012) Performance assessment of the anticipatory approach
to optimal experimental design for model discrimination. Chemometr. Intell.
Lab., 110, 20—31.

Drud,A.S. (1994) CONOPT—a large-scale grg code. INFORMS J. Comput., 6,
207—216.

Du,D.-Z. and Pardalos,P.M. (1995) Minin and Applications (Nonconvex
Optimization and Its Applications). Kluwer Academic Publishers, The
Netherlands.

Floudas,C.A. and Gounaris,C.E. (2009) A review of recent advances in global op-
timization. J. Global Optim, 45, 3—38.

Geyer,C.J. (1992) Practical Markov chain Monte Carlo. Stat. Sci., 7, 473—483.

Gustafsson,F. and Hendeby,G. (2008) On nonlinear transformations of stochastic
variables and its application to nonlinear ﬁltering. In IEEE International
Conference on Acoustics, Speech and Signal Processing. Las Vegas, NV,
March 31—April 4.

Hansen,N. and Ostermeier,A. (2001) Completely derandomized self-adaptation in
evolution strategies. Evol. Comput., 9, 159—195.

Heine,Th. et al. (2008) Derivative-free optimal experimental design. Chem. Eng.
Sci., 63, 4873—4880.

Horst,R. et al. (2000) Introduction to Global Optimization. Nonconvex Optimization
and its Applications. Kluwer Academic Publishers, The Netherlands.

J ebara,T. et al. (2004) Probability product kernels. J. Mach. Learn. Res, 5, 819—844.

Johnson,N.L. (1949) Systems of frequency curves generated by methods of trans-
lation. Biometrika, 36, 149—176.

Julier,S. et al. (2000) A new method for the nonlinear transformation of means and
covariances in ﬁlters and estimators. IEEE Trans. Automat. Contr., 45, 477—482.

Kremling,A. et al. (2004) A benchmark for methods in reverse engineering and
model discrimination: problem formulation and solutions. Genome Res, 14,
1773—1785.

Lorenz,S. et al. (2007) Discrimination of dynamical system models for biological
and chemical processes. J. Comput. Chem, 28, 1384—1399.

Melykuti,B. et al. (2010) Discriminating between rival biochemical network models:
three approaches to optimal experiment design. BM C Syst. Biol, 4, 38.

Michalik,C. et al. (2010) Optimal experimental design for discriminating numerous
model candidates: the AWDC criterion. Ind. Eng. Chem. Res, 49, 913—919.

Nevistic,V. (1997) Constrained control of nonlinear systems. PhD Thesis, ETH No.
12042, ETH Zurich, Switzerland.

Pearson,G. et al. (2001) Mitogen-activated protein (MAP) kinase pathways: regu-
lation and physiological functions. Endocr. Rev., 22, 153—183.

Ramkrishna,D. (1982) A cybernetic perspective of microbial growth. In
Blanch,H.W., Papoutsakis,E.T. and Stephanopoulos,G.N. (eds) Foundations
of Biochemical Engineering: Kinetics and Thermodynamics in Biological
Systems. American Chemical Society, Washington, DC, pp. 161—178.

Raue,A. et al. (2009) Structural and practical identiﬁability analysis of partially
observed dynamical models by exploiting the proﬁle likelihood.
Bioinformatics, 25, 1923—1929.

Raue,A. et al. (2010) Identiﬁability and observability analysis for experimental
design in nonlinear dynamical models. Chaos, 20, 045105.

Schenkendorf,R. et al. (2009a) Optimal experimental design with the sigma point
method. IET Syst. Biol, 3, 10—23.

Schenkendorf,R. et al. (2009b) Optimal experimental design and model selection by
a sigma point approach. In Proceedings MATHMOD, Vienna, Austria.
February 11—13.

Sch16g1,F. (1972) Chemical reaction models for non-equilibrium phase transitions.
Z.f.Physik, 253, 147—161.

Singh,S. (1998) On establishing the credibility of a model for a system. Chem. Eng.
Res. Des, 76, 657—668.

Skanda,D. and Lebiedz,D. (2010) An optimal experimental design approach to
model discrimination in dynamic biochemical systems. Bioinformatics, 26,
939—945.

Skanda,D. and Lebiedz,D. (2012) A robust optimization approach to experimental
design for model discrimination of dynamical systems. Math. Program,
doi:10.1007/s10107-012-0532-0.

Sobol’,I.M. (1993) Sensitivity analysis for nonlinear mathematical models. Math.
Mod. Com. Exp., 1, 407—414.

Topsoe,F. (2000) Some inequalities for information divergence and related measures
of discrimination. IEEE Trans. Inform. Theory, 46, 1602—1609.

Vellela,M. and Qian,H. (2009) Stochastic dynamics and non-equilibrium thermo-
dynamics of a bistable chemical system: the Schlégl model revisited. J. R. Soc.
Interface, 6, 925—940.

Vanlier,J. et al. (2012) A Bayesian approach to targeted experiment design.
Bioinformatics, 28, 1136—1142.

Walter,E. and Pronzato,L. (1997) Identification of Parametric Models from
Experimental Data. Communications and Control Engineering. Springer, Berlin.

Zabinsky,Z.B. (2003) Stochastic Adaptive Search for Global Optimization.
Nonconvex Optimization and Its Applications. Kluwer Academic Publishers.

 

3096

112 /810's1eumoprOJXO'sot1emJOJutotw/2d11q 11101; pepeolumoq

9IOZ ‘09 lsnﬁnV no 22

