ORIGINAL PAPER

Vol. 28 no. 23 2012, pages 3058—3065
doi: 10. 1093/bioinformatics/bts5 75

 

Structural bioinformatics

Advance Access publication October 8, 2012

Predicting pseudoknotted structures across two RNA sequences

Jana Sperschneider1’*, Amitava Datta1 and Michael J. Wise1 ’2
1School of Computer Science and Software Engineering and 2School of Chemistry and Biochemistry, University of

Western Australia, Perth, Australia
Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: Laboratory RNA structure determination is demanding
and costly and thus, computational structure prediction is an import-
ant task. Single sequence methods for RNA secondary structure pre-
diction are limited by the accuracy of the underlying folding model, if a
structure is supported by a family of evolutionarily related sequences,
one can be more confident that the prediction is accurate. RNA pseu-
doknots are functional elements, which have highly conserved struc-
tures. However, few comparative structure prediction methods can
handle pseudoknots due to the computational complexity.

Results: A comparative pseudoknot prediction method called
DotKnot—Pw is introduced based on structural comparison of sec-
ondary structure elements and H-type pseudoknot candidates.
DotKnot—Pw outperforms other methods from the literature on a
hand-curated test set of RNA structures with experimental support.
Availability: DotKnot—PW and the RNA structure test set are available
at the web site http://dotknot.csse.uwa.edu.au/pw.

Contact: janaspe@csse.uwa.edu.au

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 2, 2012; revised on August 1, 2012; accepted on
September 18, 2012

1 INTRODUCTION

Macromolecules such as DNA, RNA and proteins have the ability
to form diverse tertiary structures, which enable functionality and
thus, life. For many decades, proteins were deemed the global
players in the cell until RNA entered the spotlight. For example,
RNA structures have been found to be catalytically active, which
was assumed to be the privilege of proteins. Furthermore, small
RNAs are known to regulate gene expression and RNA viruses
employ a plethora of structure elements to invade the host cell.
To gain insight into macromolecule function, one must inves-
tigate the structure. The ﬁrst step in RNA folding is stable base
pairing that leads to a secondary structure. As RNA structure
formation is of hierarchical nature, secondary structure is the
basis for the tertiary fold that produces the functional structure.
Especially for RNAs, structure determination by experimental
means is an intricate and expensive task. Computational RNA
structure prediction is therefore an invaluable tool for biologists.
Comparative structure prediction is considered the most reliable
approach for computational RNA structure prediction. Single
sequence structure prediction is always limited by the accuracy

 

*To whom correspondence should be addressed.

of the underlying folding model. Three main streams have been
identiﬁed for comparative RNA secondary structure prediction:
(i) predict a structure from a pre-computed sequence alignment;
(ii) simultaneously compute an alignment and a structure and
(iii) alignment-free methods (Gardner and Giegerich, 2004).

Tools for multiple sequence alignments such as Clustalw
(Thompson et al., 1994) are readily available and thus, structure
prediction from an alignment is a tempting approach [e. g.
RNAali fold (Hofacker et al., 2002)]. Such methods heavily
depend on the sequence conservation and quality of the under-
lying alignment. However, ncRNAs are conserved rather on the
structure level than on the sequence level. The gold standard of
RNA comparative structure prediction is the Sankoff approach
as it does not rely on a high-quality sequence alignment and
captures the structural conservation of ncRNAs. Sankoff
(1985) introduced a theoretical dynamic programming algorithm
for simultaneous folding and aligning for a set of N sequences
that takes 001”) time and 001”) space. Practical variants have
been derived which more or less retain the Sankoff principle
by sacrificing optimality. Alignment-free methods aim to avoid
the pragmatic restrictions made in a practical Sankoff approach
as well as the reliance on a high-quality alignment [e. g. CARNAC
(Perriquet et al., 2003)]. Note that all of these comparative struc-
ture prediction methods exclude the prediction of RNA
pseudoknots.

RNA pseudoknots are crossing structure elements with diverse
functions. The principle of pseudoknot formation is that bases
within a loop region pair with complementary unpaired bases
outside the loop. From an algorithmic point of view, even the
simplest type of pseudoknot adds considerable computational
demands due to crossing base pairs. In fact, the majority of com-
parative RNA structure prediction methods exclude pseudo-
knots. Biologists have delivered a wealth of studies, which
show that pseudoknots have an astonishing number of diverse
functions and occur in most classes of RNA (Staple and Butcher,
2005). RNA viruses use pseudoknots for hijacking the replication
apparatus of the host (Brierley et al., 2007).

A limited number of RNA comparative structure prediction
methods can handle pseudoknots due to the computational com-
plexity. Several of these methods take a sequence alignment as an
input. ILM is an algorithm that takes as an input either individ-
ual sequences or a sequence alignment (Ruan et al., 2004). A base
pair score matrix is prepared initially and helices are added to the
structure in an iterative fashion. In the approach hxmatch, a
maximum weighted matching algorithm with combined thermo-
dynamic and covariance scores is used Witwer et al., 2004). This
program gives the option to be combined with RNAalif old.

 

© The Author 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬁle'slcumo[pJOJXO'sopchOJutotq/ﬁd11q IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no :2

Predicting pseudoknotted structures

 

KNetFold is a machine learning method, which takes a se-
quence alignment as an input and outputs a consensus structure
allowing pseudoknots (Bindewald and Shapiro, 2006).
Simul f old takes an alignment as an input and simultaneously
calculates a structure including pseudoknots, a multiple-sequence
alignment and an evolutionary tree by sampling from the joint
posterior distributions (Meyer and Miklos, 2007). Tf old com-
bines stem stability, covariation and conservation to search for
compatible stems and subsequently for pseudoknots for a set of
aligned homologous sequences (Engelen and Tahi, 2010). Several
comparative structure prediction methods including pseudoknots
do not rely on an initial sequence alignment. The
graph-theoretical approach comRNA computes stem similarity
scores and uses a maximum clique ﬁnding algorithm to ﬁnd
pseudoknotted structures (J i et al., 2004). SCARNA performs
pairwise structural alignment of stem fragments with ﬁxed
lengths derived from the probability dot plot (Tabei et al., 2008).

In the following, a novel comparative approach for predicting
structures including H-type pseudoknots called Do tKnot — PW will
be introduced. The input consists of two unaligned, evolutionarily
related RNA sequences. Similarity scores between structure elem-
ents will be calculated. Statistically signiﬁcant pairs will be used
to ﬁnd the set of conserved structure elements common to two
sequences, which maximize a combined thermodynamic and simi-
larity score. Using a hand-curated test set of pseudoknotted struc-
tures with experimental support, the prediction accuracy of
Do tKno t— PW will be compared with methods from the literature.

2 APPROACH

Pseudoknots are functional elements in RNA structures and
therefore, the most promising approach for comparative predic-
tion is a structure comparison with less focus on exact sequence
matching. In fact, perfect conservation on the sequence level can
be more of a curse than a blessing. Especially ncRNAs are
known to evolve quickly and so-called consistent and compen-
satory base pairs in both sequences will give much more conﬁ-
dence for structure conservation than a sequence alignment.
One strong point of the DotKnot method for single sequence
pseudoknot prediction (Sperschneider and Datta, 2010;
Sperschneider et al., 2011) is that the set of possible H—type
pseudoknot candidates (and secondary structure elements) is
explicitly computed and thus readily available for further inves-
tigation. The main steps in the pairwise pseudoknot prediction
approach DotKnot—PW are as follows (Fig. 1):

(1) Run DotKnot for two unaligned sequences Seqx and
Seqy. This returns secondary structure element and H-
type pseudoknot candidate dictionaries.

(2) Calculate pairwise base pair similarity scores for secondary
structure elements and H—type pseudoknot candidates.
Keep signiﬁcant pairs that have a low estimated P-value.

(3) Use signiﬁcant pairs to calculate the set of conserved struc-
ture elements and pseudoknots for the two sequences that
maximizes a combined free energy and similarity score.

The key point of the DotKnot—PW approach is how to score
the similarity of stems, secondary structure elements and H—type

 
 
  

 
    
     

Similarity scores

ammmmm» Rain”
sim(Ds(z), D5 (11))

, Bulge/Internal loops DL(y)
317MB: (9”), Ds (11)) 5

simwéexnm» M
smmymﬁym) MMMEEI“
sim(Dp (93): Draw»

Pseudoknot dictionary DP (1])

Stems D, (2:)
Bulge/Internal loops Df(z)
Multiloops Di” (2)

     
 

      
 
   
  

Calculate set of conserved structure elements

Fig. 1. For two unaligned RNA sequences Seqx and Seqy, DotKnot—PW
produces structure element dictionaries derived from the probability dot plot.
Similarity scores and P—values are computed to detect conserved elements

pseudoknot candidates derived from sequences Seqx and Seqy.
Related work has been done for stem ﬁnding in unaligned se-
quences, where stem candidates are assigned a matching score
across unaligned sequences, e.g. in SCARNA. Another point is
how to assess the signiﬁcance of a similarity score using P-
values. These points will be explained in detail in the following
section.

3 MATERIALS AND METHODS

For two unaligned RNA sequences Seqx and Seqy, the single sequence
prediction method DotKnot (Sperschneider and Datta, 2010;
Sperschneider et al., 2011) returns two stem dictionaries Ds(x) and
Ds(y) derived from the probability dot plot. It also returns secondary
structure element dictionaries DSL(x), DSL(y) and Di” (x),quM (y) and
H-type pseudoknot candidate dictionaries Dp(x) and Dp(y) (Fig. 1). To
detect conserved structure elements for the two sequences, a pairwise
structural comparison is performed. Instead of a full structure-to-
structure alignment, which takes 001“) time and 0013) space, pairwise
base pair similarity scores are calculated using the RIBOSUM85-60
matrix for base pair substitutions (Klein and Eddy, 2003).

3.1 Base pair similarity scores of stems

For two given stems s,(x) and $102) with ﬁxed lengths in sequences Seqx
and Seqy, respectively, the base pair similarity score sim[s,(x), 530)] is
calculated using an ungapped local structure alignment of the base
pairs with the RIBOSUM85-60 matrix. As an example, consider the fol-
lowing optimal ungapped local structure alignment of the two stems with
base pair similarity score of sim[s1(x), s2(y)] = 22.04 using the
RIBOSUM85-60 matrix.

5105)
UCUCUAUC . . . . . . . GAUAGAGA
(((((((( . . . . ...))))))))
S10”)
— —UUGUAC . . . . . . . GUACAA——

--(((((( . . . . ...))))))--

To evaluate the signiﬁcance of base pair similarity scores instead of the
raw score, one has to ﬁnd out what the underlying probability distribu-
tion is. Similar to the case of ungapped local sequence alignments (Karlin
and Altschul, 1990), it is assumed here that the base pair similarity scores
follow an extreme value distribution. However, the main difference is that
a comparison between ﬁxed-length stem fragments is made. It is import-
ant to remember that parameters A and K describe the extreme value
distribution of optimal local alignment scores in the asymptotic limit of
long sequences (Altschul et al., 2001). Here, the parameters for the gen-
eralized extreme value distribution are pre-calculated using maximum

 

3059

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂ(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

J.Sperschneider et al.

 

likelihood ﬁtting of a distribution to the histogram of a large sample of
random base pair similarity scores. The maximum likelihood ﬁtting was
performed using the ismev package of the R statistical language for a
range of stem lengths (see Supplementary Material). The P-value is
deﬁned as the probability to obtain a score greater than or equal to the
observed score strictly by chance. A stem s,(x) in sequence Seqx and a
stem s](x) in sequence Seqy are a signiﬁcant pair if the score sim[s,-(x), s](y)]
has an estimated P-value less than 0:. Stem pairs with a P-value larger
than or are not considered in the following.

3.2 Base pair similarity scores of interrupted stems

For two interrupted stems, the base pair similarity score is calculated by
deleting bulges and internal loops and scoring stems as consecutive base
pairs. Base pair similarity scores for regular and interrupted stems are
also calculated if the difference in number of base pairs is less than 5.
For example, a stem with one bulge might be a conserved match with a
regular stem. A stem s,(x) in sequence Seqx and a stem 530) in sequence
Seqy are a signiﬁcant pair if the score sim[s,-(x), 530)] has an estimated
P—value less than or.

3.3 Base pair similarity scores of multiloops

Calculating the base pair similarity score for two multiloop structures
is complex due to the variety of inner loop elements, which may be regu-
lar or interrupted stems. A multiloop S?! (x) can be decomposed into an
outer stem sf(x) and a set of inner structure elements S,(x) = [s1(x),. . .,
sk(x)], where k 2 2. The base pair similarity score sim[s;? (x), sj‘?(y)] for the
outer stems of two multi-loops can be easily obtained from the previously
calculated base pair similarity scores. If the outer stem is a conserved
match, a local alignment on the set of inner structure elements is used
to ﬁnd the base pair similarity score. Here, gaps are allowed in the local
alignment of inner structure elements; however, no gap penalty is used.
Let two sets of inner structure elements S,(x) = [s1(x),. . ., sn(x)] and
131(12): [s1(y),. . ., sm(y)] be given. Let H(i, j) be the maximum similarity
score between a sufﬁx of S,(x) and a sufﬁx of S](y). The optimal local
alignment is calculated as follows:

H(i,0)=0,05i5n
H(0,j)=0,05j5m

0
 _ 
H(i — 1,j — 1) + SimlSi(X)aSj(y)l
 _ 

H(i,j) = max

A multiloop S?! (x) in sequence Seqx and a multiloop s}! (y) in sequence
Seqy are a signiﬁcant pair if the similarity score sim[sf”(x),s}4(y)] has
an estimated P-value less than or.

3.4 Base pair similarity scores of H-type pseudoknots

A H-type pseudoknot has two pseudoknot stems S1 and S2. The pre-
requisite for a conserved pseudoknot pair is that both core H-type pseu-
doknot stem pairs [S1(x), S1(y)] and [S2(x), S2(y)] are signiﬁcant. The base
pair similarity score for two H-type pseudoknots p,(x) and p](y) in
sequences Seqx and Seqy, respectively, is the sum of base pair similarity
scores for the core pseudoknot stems as well as the base pair similarity
score from a gapped local alignment of the recursive secondary structure
elements in the loops (as described for multiloops). A pseudoknot p,(x)
in sequence Seqx and a pseudoknot p](y) in sequence Seqy are a signiﬁcant
pseudoknot pair if the similarity score sim[p,-(x), p](y)] has an estimated
P—value less than or.

3.5 Dissimilarity and weight of signiﬁcant structure
elements pairs

The base pair similarity score calculated in the previous sections might
not be powerful enough to distinguish true positive conserved structure
element pairs from false-positive structure element pairs due to the ﬁnite
lengths of stems and exclusion of loop sequences in the alignment.
Therefore, a dissimilarity score is also used to conﬁrm whether a pair
is signiﬁcant. The dissimilarity for two given structure elements s,(x) and
s](y) in sequences Seqx and Seqy is deﬁned as:

dissim[s,-(x),sj(y)] = Z diSSimkISi(x):Sj(y)]
2

k=1, ...,

where dissiml is the difference in the stem lengths and dissimz is the
difference in the number of loop lengths. As an example, consider the
pseudoknot pair p1(x) and p1(y) in sequences Seqx and Seqy, respectively,
with stems S1, S2 and loops L1, L2, L3. The pseudoknot pair has dissimi-
larity of 6.

P105)
UCUCUAUCAGAAUGGAUGUCUUGCUGCUAUAAUAGAUAGAGAAGGUUAUAGCAG
(((((((( . . . . . . . . . . . . . ..[[[[[[[[[[.)))))))).]]]]]]]]]]

1910’)
UUGUACAGAAUGGUAAGCCAAGUGUCAAUAGGAGGUACAAGCAACCUAUUGCAU
(((((( . . . . . . . . . . . . . ..[[[.[[[[[[[.))))))....]]]]]]]]]]

A weight is assigned to a signiﬁcant pair, which is a combination of
the free energy, covariation and dissimilarity. The overall weight .9 of
a signiﬁcant structure element pair [s,(x), $102)] in sequences Seqx and
Seqy is a combination of the free energy weights w[s,(x)] and w[s](y)],
base pair similarity score Sim[si(x), s](y)] and dissimilarity dissim[s,~(x),

530)]:
SlSiOC): Sj(y)] = 06 X sim[Sz-(x), Sj(y)] - i3 X {WISi(x)] + WISj(y)]}
—y x dissim[s,-(x), sj(y)]

Only structure element pairs with positive score .9 are allowed in the
following dynamic programming algorithm. Here, or and y are set to
0.5 and ,8 is set to 1.

3.6 Finding best set of signiﬁcant structure elements

Let pf, . . . ,pj,‘ be the number of structure elements in the ﬁrst sequence
Seqx and py, ..., 17%, be the number of structure elements in the second
sequence Seqy. Each structure element has a left and right endpoint in the
sequence and is a stem, interrupted stem, multiloop or H-type pseudo-
knot. Structure elements can also be represented as nodes in a graph.
In each sequence, the structure elements are ordered by their right end-
points. An edge is drawn between two structure elements in the ﬁrst and
the second sequence if their base pair similarity score has a P—value less
than 05. Given the set of edges between nodes pf, .. . ,pj,‘ and py, . . . , 17%,,
the goal is to ﬁnd the set of edges with maximum weight that are
non-crossing. This relates to ﬁnding the set of non-overlapping structure
elements in the two sequences that maximize the score under the require-
ment that the interval ordering is preserved. A set of structure elements in
the ﬁrst and second sequence, which preserves the interval ordering is
called a feasible structure element alignment and must satisfy the follow-
ing two requirements. Each structure element can be aligned with at most
one other structure element in the other sequence. The order of structure
elements must be preserved with respect to the alignment. That is, if
structure elements pi“ and pf in the ﬁrst sequence are aligned with 12%
and pi in the second sequence, respectively, the pairs may never overlap:
p? <19}? A1935 <19? (Fig. 2).

Given nodes pf . . . , pf,“ in the ﬁrst sequence Seqx and py, ... , 17%, in the
second sequence Seqy, let ﬂi, a) be the maximum sum of edge weights for
nodes between 1 and i in the ﬁrst sequence and 1 and a in the second
sequence such that the edges are non-crossing (i 5 n and a 5 m). The
nodes that maximize the sum of edge weights are called an optimal

 

3060

112 /810'S112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pep1201umoq

910K ‘09 lsnﬁnV no 22

Predicting pseudoknotted structures

 

Sequence 1 48 P2 78 138 P4 196 200 P5 245 248 P7 299

 

 

Sequence 2 49 78 85 100 136 193 200 255

 

 

 

P3 P5

Fig. 2. A set of edges with positive scores is given between nodes 171,. . .,p7
in the ﬁrst sequence and p1,. . .,p6 in the second sequence. The goal is to
ﬁnd the best set of non-overlapping structure elements in the two se-
quences such that the interval ordering is preserved. The optimal struc-
ture element alignment, which preserves the interval ordering includes
structure elements 171, 174, 177 in the ﬁrst sequence and 171, 174, [)6 in the
second sequence

structure element alignment for the two sequences. The optimal structure
element alignment is calculated using dynamic programming. For a given
structure element 1), with start point a, and end point bi, let pre(i) be the
non-overlapping predecessor. For each structure element, its predecessor
is pre-computed using the sorted list of structure elements. The recursion
for calculating the optimal structure element alignment is as follows:

f (0, a) = 0

f (i, 0) = 0
f (i — 1, a)

f (i, a) = max s(i, a) + f [pre(i), pre(a)]
f(i, a — 1)

Furthermore, nested structures are taken into account for signiﬁcant
outer stem pairs, which have estimated P—value less than or. For each
signiﬁcant outer hairpin loop pair, the optimal structure element align-
ment of inner elements is computed.

3.7 Time requirements

For two unaligned RNA sequences Seqx and Seqy, the single sequence
prediction method DotKnot returns structure element dictionaries
derived from the probability dot plot. Let n and m be the number of
structure elements in sequences Seqx and Seqy, respectively. Calculating
the similarity scores and the optimal structure element alignment takes
0(nm) time. Furthermore, nested structures are taken into account
for signiﬁcant outer stem pairs, which have estimated P—value less
than 05. Let a be the number of signiﬁcant stem pairs, where both
stems are hairpin loops. For each signiﬁcant outer hairpin loop pair,
the optimal structure alignment of inner elements is computed. In the
worst case, this increases time requirements to 0(a x nm). The number of
structure elements depends on the base composition of the sequence.
Empirically, n and m can be observed to grow linearly with the length
of the sequence for uniform base distribution (see Supplementary
Material). In practice, DotKnot—PW can be expected to run in the
order of minutes for sequences shorter than 500 nt.

4 RESULTS

Many pseudoknot prediction programs have been evaluated
using all the entries in the PseudoBase database (van
Batenburg et al., 2000). There are several caveats in this
approach. First, the sequences given in PseudoBase are those
which exactly harbor the pseudoknot. However, in practice
structure prediction algorithms will be applied to longer

sequences without prior knowledge of the pseudoknot location.
Second, long-range pseudoknot entries appear in a truncated
version in the database. Third, some classes of pseudoknots
have a large number of entries (such as short H-type pseudo-
knots in the 3’-untranslated regions of plant viruses), whereas
more complex types of pseudoknots only have one representative
(such as long-range rRNA pseudoknots). Therefore, a
hand-curated dataset of pseudoknot structures will be used here.

When it comes to pseudoknots, many structures have been
published based on a secondary structure predicted by free
energy minimization. These predicted secondary structures are
used as a working model and reﬁned using experimental tech-
niques such as chemical and enzymatic probing. However, the
native structure remains unsolved unless tertiary structure deter-
mination methods such as X-ray crystallography are used.
Testing structures that are based on computer predictions with
no experimental support creates a bias in the benchmark and will
be avoided in this evaluation.

A total of 16 pseudoknotted reference structures from differ-
ent RNA types were collected, which have strong experimental
support. For each reference structure, a supporting set of 10
evolutionarily related sequences was obtained from the RFAM
database (Gardner et al., 2010). Note that for the vast majority
of supporting sequences, no experimentally determined struc-
tures are available. The average pairwise sequence identities
vary from 55% to 99%. Given a reference structure, the per-
formance of prediction algorithms is evaluated in terms of sen-
sitivity (S), i.e. the percentage of base pairs in the reference
structure, which are predicted correctly, as well as positive pre-
dictive value (PPW, i.e. the percentage of predicted pairs, which
are in the reference structure. The Matthews correlation coefﬁ-
cient (MCC) is also reported and is in the range from —1 to 1,
where 1 corresponds to a perfect prediction and —1 to a predic-
tion that is in total disagreement with the reference structure.
The performance of each method for predicting the reference
structure was evaluated as described in Gardner and Giegerich
(2004).

DotKnot—PW was compared with methods that are freely
available and use standard input and output formats. The com-
parative methods are CARNAC, Tf old and hxmatch (with the -
A option using RNAali fold). All of these methods return
structure predictions for only the reference structure with regards
to the support set of evolutionarily related sequences. Tf old and
hxmatch take a sequence alignment as the input. Clustalw
with the default parameters was used to produce the initial
sequence alignment. Do tKnot—PW and CARNAC take a set of un-
aligned sequences as the input. Furthermore, prediction results
for the reference sequence (not the supporting sequences) were
obtained from the single sequence methods DotKnot
(Sperschneider and Datta, 2010; Sperschneider et al., 2011),
ProbKnot (Bellaousov and Mathews, 2010), IPknot (Sato
et al., 2011) and RNAfold (Hofacker et al., 1994). Note that
all methods except CARNAC and RNAf old allow pseudoknot
prediction.

The results are shown in Table 1. DotKnot—PW has the high-
est average MCC of 0.75 for the test sequences. For each
reference structure with the 10 support sequences from the
corresponding RFAM family, 10 predictions are returned ordered
by the combined free energy and similarity score. If only the

 

3061

112 /810'S112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pep1201umoq

910K ‘09 lsnﬁnV no 22

J.Sperschneider et al.

 

Uoéaomdom W63 38“\EmoEmoNBmQOm.oxmoN&9:55.on N: n 0: Emma” mo. N03

 

 

 

9255:08

3 $6 w; mod N... Ed Se 34.8 to 002 SS Mm _
a: is new we New 3 EN 2.3 3. Em a NNN 3 SN
36 NS 9P N.Ne is Se 24 ass am a. SNSmm 02 .mm sSN ..e s 55833; E8
N3 is Se 3 $3 3... mod 96.8 86 82 xi 2E N
N: SK NS 30 a; 3a 2: at $0 Em a we a 42
«NB mg 2K 2K 9: 3a 5% came owe a. wmgcmm 5-x GSN ..s s sawémv 2mm mmmm
m; we mm... as Re Ed SS 698 mm... 82 xi Mm _

mm 2: 2: Em SN 2: NE 9.3 2: Em E NE a 3
Se Se 2» E. Se 3m New 33 a? m. NESmm 5-x GSN seem as owes:on 36%
as Ed m2 Ed Ed .. Ed 3.8 m 002 $3 Mm _
a: 2: em 2: o2 .. 2: 82V 2: Em a a. a em
em em em em emm .. 9% eat 2: m. NNmSmm mzz SEN ..s a 58;: 52m 6:582
Rd Se ed NS 3 Se Rd @e S... 82 SNN Mm _
was go 9% E 3% 0% gm 55 N: Em a SS a a:
m8 2» was EN 3m m8 is 2.5 e; m. mNcSmm mm GSN .8me as 52325 23-23 aeoaose
Se 36 do 93 as as 43 $9 mm... 8: saw Mm _
Ea EN EN 2w ma 2: 2: $8 3a Em a N: a S:
EN em 3% 2w EN Nsm e: 68 3a a aaeccmm oz ANSN ..e s :3an Sum:
mac mac 8... ed Rd .. o awe Ed 82 SS Mm _
as. :0 NS 24 e3 .. o @Ns 4% Em a m: a e:
2:. 8 3e 2:. cm .. o 33 mam m. caNSmm 02 .mm ASSN ..s a :3 >23

ed as ed as as- Ed is Gas m 002 as: Mm _
$0 2: $0 a; o 3a 2: pea Sm Em a me a 8 Same
emm Ea em 2: e 2e 9% 6.3V 2: a SSE 02 .mm 3% ..s s 2:955 >om assesses
Nee R... S; Rd Nod 33 was ﬁne as 002 £3 2E N
3e 3 at Em mg was mg 9.48 Se Em a as a E
NS NS E 5% as. maN SN :3 3m a 225mm 5-x :SN ..s a wig mas/2-0m
m; w; a; med a2 Se as $9 mm... 002 SR 2E N
er Em an 2e 3 new as. 8N3 m3 Em a w: a E
Re SN» 4.3 98 e.g. mom 3 SE to» a 488mm oz .8 GSN .oaa<bésm as 52% amass»
a3 3 mac 3... Na «Ne 23 A38 3... 82 as: Mm _
as. 3 Se 2: Em gm 2: 2.5 2: Em a 8 a a
2m Ne 92. mg nNm EN EN 9.3 mg a. 488mm 5-x 932 ..s a seaﬂnsaomv Em: BEBE
as as as m was as o 8 m 002 saw Mm _
NE. NE. NE. 2: 2% S e 8c: 2: Em a R a we

8 S cm 2: as. S o 8c: 2: m. Swamm mzz QSN ..e s Eamv >35
m; e; S 3... :3 m3 a2 3.8 3... co: SNS Mm _
EN NE Nb 2: 3% mg 35 8a 2: Em a Nw a Nw
EN EN Nae Na 3% Em 3m ANNE mNa m. Bmccmm mzz GSN ..s a Esmv >oo-mm<m easaem
E8 Aowmmoiao Emmi

<72 soimm 853on Samson 636E Bee o<zm<o .Bmmoqvuoc
commompomm 8303mm ooqomomom 83033 :0588 .mo commompomm bmﬁmm 85 GM ohmth

 

momma? <ZM “:80me .mo How 38. a wee: 8.38m nonomoomm A 05er

 

3062

Predicting pseudoknotted structures

 

Table 1. Continued

 

Reference structure prediction

Prediction of common structure

Family

Info

ID

Type

 

RNA

IPknot
fold

ProbKnot

CARNAC Tfold hxmatch DotKnot

DotKnot-PW,

First (Average)

 

52.9 41.2 100 58.8 58.8 58.8

52.9

100 (81.8)

S

RF00114
112 nt
77%

SP, MG

74 nt

515 (Philippe et al., 1995)

mRNA

40.9 46.7 100 47.6 52.6 52.6

52.9

100 (83.4)
1 (0.82)

PPV

0.55
57 1

0 55
66.7

0.52
71.4 57 1

0.43
83 3

0.46
31

0.52
9

73.8 (71.4)
86.1 (80.2)

0.8 (0.76)
37.5 (50)

MCC
S

RF01087
149 nt
90%

1 PK
SP, MG
149 nt

1 PK

repZ (Asano and Mizobuchi, 1998)

64.9
0.6

85.7 70.6 82.4

85.4

61.9

44.4

PPV

0.74
66.3

0.63
56.7

0.78
75

0.84

27.9

0.43
34.6

0.2

MCC
S

50

6.7

NMR, SC RF00023

363 nt

Ec-tmRNA Wameki et al., 1999)

tmRNA

47.7

79.6 60.8 76.7

61.7

100 67.9

45.9 (58.4)
0.41 (0.54)
77.7 (70.5)
85.1 (80.9)

MCC 0.81 (0.75)

PPV
MCC
S

377 nt
57%

0.49
59.5

0.71
67

0.59
64.5
68

0.77
74

0.41
49.7

0.48
50.4

26

0.
31

4 PKs

Average

64.6

78.9

78.8

71.2

74.2
0.6

73.9

PPV

Average

0.61

0.76 0.66 0.72

0.59

0.45

Average

 

Note: Each reference structure is given by its ID (see Supplementary Material for dot-bracket notation). The following colurrm gives the method of experimental support (NMR, NMR spectroscopy; X-ray, X-ray
crystallography; SC, sequence comparison; MG, mutagenesis; SP, structure probing), length of the sequence and number of pseudoknots. For each reference structure, the corresponding RFAM family ID, average sequence
length and average pairwise sequence identity is shown. The * symbol means that the method failed to run. The ‘ﬁrst’ prediction for DotKnot—PW is the pairwise prediction with highest combined free energy and similarity

SCOI'C .

pairwise prediction with highest combined free energy and simi-
larity score is taken, DotKnot—PW has an improved average
MCC of 0.81. Tfold and hxmatch have average MCC of 0.6
and 0.59, respectively. CARNAC has average MCC of 0.45 with
much higher average speciﬁcity than sensitivity.

The prediction results for single sequence structure prediction
for each of the reference sequences with experimentally deter-
mined structures are also shown in Table 1. Note that this
does not include the prediction for the support sequences from
RFAM, as no experimentally determined structures are available.
All single sequence pseudoknot prediction methods show im-
proved results over using RNAfold. DotKnot has the highest
average MCC of 0.76, followed by IPKnot and ProbKnot.

As an example, consider the S15 mRNA pseudoknot that
binds to speciﬁc proteins in the autoregulation mechanism of
ribosomal protein S15 synthesis (Philippe et al., 1995). For the
reference sequence S15 and 10 support sequences from the cor-
responding RFAM family, DotKnot—PW returns pairwise predic-
tions ordered by the combined free energy and similarity score.
The top two pairwise predictions with the highest scores are
shown in Figure 3.

5 DISCUSSION

We presented DotKnot—PW for prediction of structures
common to two RNA sequences, including H-type pseudoknots.
Both DotKnot and DotKnot—PW have been designed as dedi-
cated pseudoknot prediction tools. In the following, important
aspects of pseudoknot prediction will be discussed.

5.1 The underlying folding model

Single sequence prediction methods are always limited by the
underlying RNA folding model. This may be the set of free
energy parameters used by free energy minimization methods
or the underlying methodological framework such as maximum
expected accuracy methods. DotKnot—PW shows excellent re-
sults on H-type pseudoknots with short interhelix loops.
For this type of pseudoknots, DotKnot—PW uses free energy
pseudoknot parameters by Cao and Chen (2006, 2009) based
on polymer statistical mechanics. Improvements of the accuracy
of free energy parameters, both for secondary structures and
pseudoknots, will lead to more accurate prediction methods.
However, one has to keep in mind that the algorithms themselves
must be designed in such a fashion that novel parameters can be
efﬁciently incorporated. The heuristic framework of DotKno t-
PW has been designed such that it can incorporate sophisticated
free energy parameters for pseudoknots, secondary structures
and coaxial stacking. In the future, DotKnot—PW could also
use contributions from basic tertiary structure elements such
as base triples around the pseudoknot junction or stem-loop
interactions.

5.2 The type of pseudoknot

Pseudoknot prediction algorithms come in two ﬂavors: either
they can predict a certain, restricted class of pseudoknots or
they do not have a restriction on the type of pseudoknot that
can be predicted. For methods using free energy parameters, the
inclusion of general types of pseudoknots might be more of a

 

3063

112 /810'S112umo[pJOJXO'sot112u1101u101q//2d11q 111011 pep1201umoq

910K ‘09 lsnﬁnV no 22

J.Sperschneider et al.

 

>815

CUGGGAUCGCUGAAUUAGAGAUCGGCGUCCUUUCAUUCUAUAUACUUUGGAGUUUUAAAAUGUCUCUAAGUACU

..((((.(((((..[[[[[[[.))))))))) . . . . . . . . . . . . . . . . . . . . . . . . . ..
..((((.((((( . . . . . . . . ..))))))))) . . . . . . . . . ..(((((.(((( . . . . ..

>815

....]]]]]]].....
.....)))))))))..

CUGGGAUCGCUGAAUUAGAGAUCGGCGUCCUUUCAUUCUAUAUACUUUGGAGUUUUAAAAUGUCUCUAAGUACU

..((((.((((((.[[[[[[[))))))))))...(((((( . . . . . ..)))))).....

>E.coli.7 J02638.1/90-204

....]]1]]]].....

I’If‘f‘r' AIII‘I‘FTTI‘ A "1"” " ‘ "' (‘f‘f‘Fl’If‘l‘TI‘ITIIf‘AITIT!‘I’IA‘ITA"A(‘""""" " "'"TIITTA A A ATTf‘TTt‘Uf‘TIA Af‘ITAI‘II!‘ A AI‘f‘A AI‘AI‘I‘TTA A A AI’IFK‘IITTI’H ‘ 1 I’If‘Af‘f‘f‘A

.((((.((((((.[[[[[[[))))))))))...(((((( . . . . . ..)))))) . . . . ..

104.065

>815

...]]]]]]] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..

CUGGGAUCGCUGAAUUAGAGAUCGGCGUCCUUUCAUUCUAUAUACUUUGGAGUUUUAAAAUGUCUCUAAGUACU

..((((.((((((.....[[[)))))))))).....]]]...(((((.(((( . . . . ..

>S.enterica.1 AF399929.1/155-270

.....)))))))))..

UGGGAUCGCUGAAUUAGAGAUCGGCGUCCUCUCAUUCUUAAAUACUUUGGAGUUUUAAAAUGUCUCUAAGUACUGAAGCUACAGCUAAAAUCGUUUCUGAGUUCGGUCGUGACGCA

.((((.((((((....[[[[)))))))))).....]]]]...(((((.(((( . . . . ..

97.835

.....))))))))) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..

Fig. 3. Pairwise prediction results for the S15 mRNA pseudoknot (RFAM family RF00114) with the top two combined free energy and similarity scores.
The reference structure is shown at the top and folds into two conformations in dynamic equilibrium: a H-type pseudoknot or a series of hairpins.
For the pairwise prediction with highest score, the pseudoknot structure is returned. For the second-best pairwise prediction, the alternative hairpin loop

structure is returned

curse than a blessing, as no reliable free energy parameters for
complex pseudoknots are available. DotKnot—PW has restric-
tions on the type of pseudoknot that can be predicted.
However, this does not always lead to poor prediction results
in practice. For example, DotKnot—PW shows the best result
for the HDV ribozyme, which is a complex double nested
pseudoknot.

5.3 The trouble with benchmarking

The results from the benchmark for structure prediction in
Table 1 must be interpreted with care. First, the tested methods
can be run with different parameters, possibly producing better
results. However, as a typical user has no prior knowledge about
the structure, the default parameters for each method are used.
Of course, a comprehensive benchmark should include a larger
number of structures to obtain a more reliable evaluation.
However, in this study, the focus has been on a test set where
the structures are supported experimentally. Many structures
have been published, which were determined using computa-
tional tools and this will inevitably create a bias in a benchmark,
and thus they were excluded here.

5.4 Gaining conﬁdence with multiple sequences

Here, an extension of the single sequence prediction method
DotKnot was presented based on the pairwise comparison of
structure elements. This approach called DotKnot—PW is
designed as an algorithm for ﬁnding the structure including
H-type pseudoknots common to two sequences. As shown in
Table 1, Do tKnot—PW can greatly improve structure predictions
for RNA families when compared with the single sequence pre-
diction using DotKnot. In some cases, a comparative approach
might have lower sensitivity than a single sequence prediction;
however, this should not generally be judged as ‘inferior’. For
example, ncRNAs might preserve some integral base pairs
throughout evolution and only these will be detected by a com-
parative approach, which returns the set of base pairs common
to a set of evolutionarily related sequences. DotKnot—PW uses
a set of unaligned sequences as the input; therefore, no expert
user intervention is required. In the future, DotKnot—PW will
be extended to include intramolecular kissing hairpins.
Furthermore, constrained folding will be implemented to predict

a structure subject to constraints, e. g. enforce certain base pairs
or regions, which must remain unpaired.

6 CONCLUSION

Do tKnot—PW has been designed as a dedicated pseudoknot pre-
diction tool and should be applied to RNA sequences where
pseudoknotted interactions are suspected in the structures.
Prediction accuracy will inevitably decrease for sequences,
which are longer than say 400 nt for any single sequence struc-
ture prediction method (Reeder et al., 2006). To achieve reliable
results, short sequences should be folded using DotKnot and
predictions should be compared with results from other methods
from the literature. To gain conﬁdence in predictions, subsequent
comparative prediction using DotKnot—PW and other compara-
tive methods is highly recommended. Ideally, experimental veri-
ﬁcation of computationally predicted pseudoknots should be
sought.

ACKNOWLEDGEMENTS

We thank the reviewers for their time and thoughtful comments
that helped to considerably improve the quality of the
manuscript.

Funding: International Postgraduate Research Scholarship
(IPRS) from the Australian Government (to J .S.).

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et al. (2001) The estimation of statistical parameters for local align-
ment score distributions. Nucleic Acids Res., 29, 351—361.

Asano,K. and Mizobuchi,K. (1998) An RNA pseudoknot as the molecular switch
for translation of the repZ gene encoding the replication initiator of IncI alpha
plasmid ColIb-P9. J. Biol. Chem, 273, 11815—11825.

Bellaousov,S. and Mathews,D.H. (2010) ProbKnot: fast prediction of RNA sec-
ondary structure including pseudoknots. RNA, 16, 1870—1880.

Bindewald,E. and Shapiro,B.A. (2006) RNA secondary structure prediction from
sequence alignments using a network of k-nearest neighbor classiﬁers. RNA, 12,
342—352.

Brierley,I. et al. (2007) Viral RNA pseudoknots: versatile motifs in gene expression
and replication. Nat. Rev. Microbiol., 5, 598—610.

Cao,S. and Chen,S.J. (2006) Predicting RNA pseudoknot folding thermodynamics.
Nucleic Acids Res., 34, 2634—2652.

 

3064

112 /810'S112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

Predicting pseudoknotted structures

 

Cao,S. and Chen,S.J. (2009) Predicting structures and stabilities for H-type
pseudoknots with interhelix loops. RNA, 15, 696—706.

Engelen,S. and Tahi,F. (2010) Tfold: efﬁcient in silico prediction of non-coding
RNA secondary structures. Nucleic Acids Res., 38, 2453—2466.

Ferre-D’Amare,A.R. et al. (1998) Crystal structure of a hepatitis delta virus
ribozyme. Nature, 395, 567—574.

Gardner,P.P. and Giegerich,R. (2004) A comprehensive comparison of comparative
RNA structure prediction approaches. BM C Bioinformatics, 5, 140.

Gardner,P.P. et al. (2010) Rfam: Wikipedia, clans and the “decimal” release.
Nucleic Acids Res., 39 (Database issue), D141—D145.

Harris,J.K. et al. (2001) New insight into RNase P RNA structure from compara-
tive analysis of the archaeal RNA. RNA, 7, 220—232.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary struc-
tures. Monatsh. Chem, 125, 167—188.

Hofacker,I.L. et al. (2002) Secondary structure prediction for aligned RNA
sequences. J. Mol. Biol., 319, 1059—1066.

Ji,Y. et al. (2004) A graph theoretical approach for predicting common RNA
secondary structure motifs including pseudoknots in unaligned sequences.
Bioinformatics, 20, 1591—1602.

Karlin,S. and Altschul,S.F. (1990) Methods for assessing the statistical signiﬁcance
of molecular sequence features by using general scoring schemes. Proc. Natl.
Acad. Sci. U S A., 87, 2264—2268.

Klein,D.J. and Ferre-D’Amare,A.R. (2006) Structural basis of glmS ribozyrne
activation by glucosamine-6-phosphate. Science, 313, 1752—1756.

K1ein,R.J. and Eddy,S.R. (2003) RSEARCH: ﬁnding homologs of single structured
RNA sequences. BM C Bioinformatics, 4, 44.

Kolupaeva,V.G. et al. (2000) Ribosomal binding to the internal ribosomal entry
site of classical swine fever virus. RNA, 6, 1791—1807.

Lin,J.W. et al. (2007) Chloroplast phosphoglycerate kinase, a gluconeogenetic
enzyme, is required for efﬁcient accumulation of Bamboo mosaic virus.
Nucleic Acids Res., 35, 424—432.

Meyer,I.M. and Miklos,I. (2007) SirnulFold: simultaneously inferring RNA struc-
tures including pseudoknots, alignments, and trees using a Bayesian MCMC
framework. PLoS Comput. Biol., 3, e149.

Montange,R.K. and Batey,R.T. (2006) Structure of the S—adenosylmethionine
riboswitch regulatory mRNA element. Nature, 441, 1172—1175.

Nameki,N. et al. (1999) An NMR and mutational analysis of an RNA pseudoknot
of Escherichia coli tmRNA involved in trans-translation. Nucleic Acids Res., 27,
3667—3675.

Nateri,A.S. et al. (2002) Terminal RNA replication elements in human parechovirus
1. J. Virol., 76, 13116—13122.

Pennell,S. et al. (2008) The stimulatory RNA of the Visna-Maedi retrovirus ribo-
somal frameshifting signal is an unusual pseudoknot with an interstem element.
RNA, 14, 1366—1377.

Perriquet,0. et al. (2003) Finding the common structure shared by two homologous
RNAs. Bioinformatics, 19, 108—116.

Pﬁngsten,J.S. et al. (2006) Structural basis for ribosome recruitment and manipu-
lation by a viral IRES RNA. Science, 314, 1450—1454.

Philippe,C. et al. (1995) Molecular dissection of the pseudoknot governing the
translational regulation of Escherichia coli ribosomal-protein SIS. Nucleic
Acids Res., 23, 18—28.

Plant,E.P. et al. (2005) A three-stemmed mRNA pseudoknot in the SARS corona-
virus frameshift signal. PLoS Biol., 3, e172.

Reeder,J. et al. (2006) Beyond Mfold: recent advances in RNA bioinformatics.
J. Biotechnol, 124, 41—55.

Rieder,U. et al. (2010) Folding of a transcriptionally acting prte riboswitch. Proc.
Natl. Acad. Sci. U S A., 107, 10804—10809.

Ruan,J . et al. (2004) An iterated loop matching approach to the prediction of RNA
secondary structures with pseudoknots. Bioinformatics, 20, 58—66.

Sankoff,D. (1985) Simultaneous solution of the RNA folding, alignment and pro-
tosequence problems. SIAM J. Appl. Math., 45, 810—825.

Sato,K. et al. (2011) IPknot: fast and accurate prediction of RNA secondary
structures with pseudoknots using integer programming. Bioinformatics, 27,
185—193.

Sperschneider,J. and Datta,A. (2010) DotKnot: pseudoknot prediction using
the probability dot plot under a reﬁned energy model. Nucleic Acids Res., 38,
e103.

Sperschneider,J. et al. (2011) Heuristic RNA pseudoknot prediction including intra-
molecular kissing hairpins. RNA, 17, 27—38.

Staple,D.W. and Butcher,S.E. (2005) Pseudoknots: RNA structures with diverse
functions. PLoS Biol., 3, e213.

Tabei,Y. et al. (2008) A fast structural multiple alignment method for long RNA
sequences. BM C Bioinformatics, 9, 33.

Theirner,C.A. and Feigon,J. (2006) Structure and function of telomerase RNA.
Curr. Opin. Struct. Biol., 16, 307—318.

Thompson,J.D. et al. (1994) CLUSTAL W: improving the sensitivity of progres-
sive multiple sequence alignment through sequence weighting, position-
speciﬁc gap penalties and weight matrix choice. Nucleic Acids Res., 22,
4673—4680.

van Batenburg,F.H.D. et al. (2000) PseudoBase: a database with RNA pseudo-
knots. Nucleic Acids Res., 28, 201—204.

Williams,G.D. et al. (1999) A phylogenetically conserved hairpin-type 3’ untrans-
lated region pseudoknot functions in coronavirus RNA replication. J. Virol., 73,
8349—8355.

Witwer,C. et al. (2004) Prediction of consensus RNA secondary structures including
pseudoknots. IEEE/ACM Trans. Comput. Biol. Bioinform, 1, 66—77.

 

3065

112 /810'S112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

