ORIGINAL PAPER

Vol. 30 no. 2 2014, pages 214-220
doi:10. 1093/bioinformatics/btt633

 

Systems biology

Advance Access publication November 6, 2013

Testing multiple biological mediators simultaneously
Simina M. Boca, Rashmi Sinha, Amanda J. Cross, Steven C. Moore and

Joshua N. Sampson"

Division of Cancer Epidemiology and Genetics, National Cancer Institute, Rockville, MD, USA

Associate Editor: Dr. Igor Jurisica

 

ABSTRACT

Motivation: Modern biomedical and epidemiological studies often
measure hundreds or thousands of biomarkers, such as gene expres-
sion or metabolite levels. Although there is an extensive statistical
literature on adjusting for ‘multiple comparisons’ when testing whether
these biomarkers are directly associated with a disease, testing
whether they are biological mediators between a known risk factor
and a disease requires a more complex null hypothesis, thus offering
additional methodological challenges.

Results: We propose a permutation approach that tests multiple
putative mediators and controls the family wise error rate. We dem-
onstrate that, unlike when testing direct associations, replacing the
Bonferroni correction with a permutation approach that focuses on
the maximum of the test statistics can significantly improve the
power to detect mediators even when all biomarkers are independent.
Through simulations, we show the power of our method is 2—5x larger
than the power achieved by Bonferroni correction. Finally, we apply
our permutation test to a case-control study of dietary risk factors and
colorectal adenoma to show that, of 149 test metabolites, docosahex-
aenoate is a possible mediator between fish consumption and
decreased colorectal adenoma risk.

Availability and implementation: R-package included in online
Supplementary Material.

Contact: joshua.sampson@nih.gov

Supplementary information: Supplementary materials are available
at Bioinformatics online.

Received on April 8, 2013; revised on August 10, 2013; accepted on
October 29, 2013

1 INTRODUCTION

Mediation analysis or causal inference offers numerous methods
for testing if a single variable mediates the relationship between a
known exposure and an outcome (Baron and Kenny, 1986;
Biesanz et al., 2010; MacKinnon, 2008; MacKinnon et al.,
2002; Taylor and MacKinnon, 2012). These methods assume
that a known exposure, E, affects an outcome, Y, and aim to
test whether this effect is at least partially transmitted through a
mediator, M. For example, in biology, these methods have
suggested that the negative impact of lead exposure on cognition
is mediated by a decrease in the volumes of speciﬁc brain regions
(Caffo et al., 2008), and that the association between certain

 

*To whom correspondence should be addressed.

variants in the F TO gene and increased body weight is mediated
by a lowered response to satiety cues (Wardle et al., 2008).

With new technologies, such as microarrays (Brown, 1995),
next-generation sequencing (Shendure and Ji, 2008) and high-
throughput metabolomics (Dettmer et al., 2006), it is possible
to simultaneously test whether 100 or 1000s of biomarkers me-
diate a known relationship. In our motivating study, investiga-
tors aim to identify metabolites that mediate the association
between increased ﬁsh consumption and a reduced risk of colo-
rectal adenoma (Sinha et al., 1999). Our current objective is to
deﬁne a testing procedure that accounts for ‘multiple compari-
sons’ and maintains a desired family wise error rate (FWER).
Guided by the methods developed for testing direct associations,
we develop a permutation approach for testing multiple medi-
ators. Speciﬁcally, we design a permutation method that tests
whether any biomarker meets a common deﬁnition of a mediator
(MacKinnon et al., 2002). We say that M is a mediator if it is
both associated with the exposure, E, and, conditional on E,
associated with the outcome, Y.

Our ﬁrst step is to deﬁne a permutation method for testing a
single mediator. Our deﬁned method uses the Freedman and
Lane (1983) approach for testing the conditional association
between M and Y, in contrast to previous methods (Taylor
and MacKinnon, 2012) that use the Manly (1997) approach,
and will therefore be more robust to outliers (Anderson and
Robinson, 2001). Unfortunately, as has already been noted
(Anderson and Robinson, 2001), there can be no exact permu-
tation method for testing a conditional association. In addition
to having its own value, our presentation of the single mediator
test aims to illustrate the inherent difﬁculty in designing a per-
mutation test for a composite null hypothesis. When testing me-
diation, the null hypothesis allows for either an association
between E and M or a conditional association between M and
Y. Approaches designed for testing direct associations, which
permute only the exposure or outcome, cannot simulate such a
composite null hypothesis.

This article is structured so that methods for testing mediators
can be described by comparing and contrasting them with meth-
ods for testing associations. We begin by describing permutation
tests for a single association and the extensions needed for testing
multiple associations. Then, we introduce permutation methods
for testing a single mediator and the extensions for testing mul-
tiple mediators. The following simulations demonstrate that the
potential increase in power from replacing the Bonferroni correc-
tion with a joint correction is greater when testing for mediation
than when testing for direct association. Finally, we apply our
method to our motivating example and offer a brief discussion.

 

214 Published by Oxford University Press 2013. This work is written by US Government employees and is in the public domain in the US.

112 [glO'SIBILInO[plOJXO'SODBIILIOJHlOlQ/[ldllq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

Testing multiple mediators

 

2 METHODS

2.1 Testing a single association

For testing a single association, we assume that there are two normally
distributed variables, X and Y, related by Equation (1)

Y=Ko+bX+€ (l)

where 6 ~ N(0, 02). The null hypothesis can be stated as either Ho : b = 0
or Ho I 10);, Y = 0, where pX, Y is the correlation between X and Y.
Although less common, the latter framework facilitates comparisons
with testing mediators. The null hypothesis can be tested by:

Test 0:. We declare X to be signiﬁcantly associated with Y if pb 5 0.05
(or If)(X, Y)| 2 t1),

where 16(X, Y), is the sample correlation coefﬁcient, pb is the P-value and
fl is the 95th percentile for the null distribution of |p(X, Y)|. Both [)5 and
t1 can be calculated by asymptotic theory or permutation. For the latter,
we can permute values of Y to obtain 7t(Y), where 7t(-) indicates a per-
mutation of an original variable, and calculate |16(X,7t(Y))| for each
permuted dataset. Then, [)5 is the proportion of permuted values greater
than or equal to the observed value and fl is the 95th percentile of the
permuted values. The tests discussed in this article are summarized in
Table 1.

2.2 Testing multiple associations

When we test the association between Y and multiple variables,
X1, ...,XK, we calculate | 16(Xi, Y)| and its corresponding P-values, 121,,
for ie {1, ...,K}. To maintain a FWER of 0.05, we have two options.
First, we can estimate the threshold by Bonferroni correction, where I; is
the 100 x (1 — 0.05/10th percentile of the null distribution estimated for
|p(X,-, Y)| and consider the test:

Test 0B: We declare X ,- to be signiﬁcantly associated with Y if
Pb,- s 0.05/K (or If)(X,-, Y)| 2 tag).

For the permutation estimates of I; to converge to their true quantiles,
we depend on the inherent assumption in Equation (1), that the full joint
distribution of X is determined by the marginal distributions, or that the
joint distribution of X is constant for all Y under the null hypothesis
Oiuang et al., 2006). Similar assumptions are required for tests described
here and elsewhere.

The second option, which uses the max correction Mestfall and
Young, 1993), is to estimate the 95th percentile of the distribution
of pm E maxi(|)6(X,-, 7t( Y))|) by permuting Y. Here, we use the
term ‘joint correction’ because the distribution of the maximal test stat-
istic depends on the joint distribution of the multiple variables. We let t]

Table 1. Tests discussed in the article

 

 

 

Type Association Mediation
a, ,8 a x ,8
Single Test 0 Test 1 Test 2
Multiple
Bonf Test 0B Test 1B Test 2B
joint Test OJ Test 1] Test 2]

 

Note: The rows indicate whether single or multiple testing is performed and the type
of adjustment for multiple testing, Bonferroni (Bonf) or joint. The colunms indicate
whether the test evaluates associations or mediations, and among mediation meth-
ods, whether a and ,6 are each evaluated separately (at, ,8) or as a product (a x ,8).

be the 95th percentile of this permutation distribution and consider
the test:

Test 0J2. We declare X ,- to be signiﬁcantly associated with Y if
If)(X,-, Y)| z t].

Note that we only permute Y once for each dataset, as opposed to once
for each X ,~ for Test OJ.

2.3 Testing a single mediator

For testing a single mediator, we start by assuming that the exposure,
putative mediator and outcome are normally distributed and related by
Equations (2) and (3). The directed acyclic graph (DAG) in Figure 1
illustrates this relationship.

M=KM+OlE+€M, (2)

Y=KY+yE+l3M+Ey, (3)

where E ~ N(0, 0%), 6M ~ N(0, 0,2”) and EY ~ N(0, 0%). Therefore, Ycan
also be described by

Y2K;+y*E+e*Y (4)

where 6’; ~ N(0, 0%, + 132012” + (y + 05,8)209. We can describe two general
approaches for testing if M is a mediator (MacKinnon et al., 2002; Sobel,
1982). We can either evaluate whether both a 75 0 and ,8 75 0 or whether
their product 05,8 75 0. For interpretation, we note that 05,8 E y* — y, which
is the difference between the total and direct effect of E. To facilitate
comparison across metabolites, with concentrations that vary by orders
by magnitude, we prefer normalized versions of a and ,8. Therefore, we
replace a and ,8 by pEM and pMYIE, respectively, where pEM is the correl-
ation between E and M and p MYI E is the conditional correlation between
M and Y. The sample correlation coefﬁcients, 16(E, M) and 16(er E, rYIE),
offer estimates of these parameters. Here, rYIE and r M E, are the residuals
from regressing Y on E and M on E, respectively.
The ﬁrst test we consider is as follows:

Test 1:. We declare M to be signiﬁcant if 1),, 5 0.05 and 12,5 5 0.05 (or
|l6(E:]W)| 2 11(0) and |l5(rMIEarYIE)| 2 I103»,

where 1),, is the corresponding P-value and t1(a) is the 95th percentile for
the null distribution of |p(E, [M)|. 17,3 and t1(,8) are deﬁned similarly for
| 16(er E, rYIE)|. All values can be calculated by asymptotic theory or per-
mutation. An overall P-value for Test 1 can be deﬁned as max(po,, 12,5).
The exact steps are presented in Algorithms 1 (for a) and 2 (for ,8).
Freedman and Lane (Freedman and Lane, 1983) offer the rationale for
Algorithm 2, even though, like all permutation tests for a conditional
association, it is not exact (Anderson and Robinson, 2001).

 

Algorithm 1: Permutation Algorithm for 1),, and t1(a).
(1) Permute E to obtain 7t(E).
(2) Calculate 16(7t(E), M).
(3) Repeat steps 1 and 2 to obtain a distribution of |;6(7t(E), M)|. 1),, is

the proportion of |p(7t(E),ll4)| exceeding |p(E,ll4)| and t1(a) is
95th percentile of the distribution.

E Y

 

 

 

Fig. 1. A scenario with a single possible mediator between exposure and
outcome

 

215

112 /810's112umo[pJOJXO'soi1chOJuioiw/2d11q IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

S.M.Boca et al.

 

 

Algorithm 2: Permutation Algorithm for [7,3 and t1 (,8).

(1) Permute rYIE to obtain 7t(rY|E).

 

(2) Regress 7t(rY|E) on E to obtain a new set of residuals, WIT/IE.
 Calculate C(V Ml E, r’f/I

(4) Repeat steps 1, 2 and 3 to obtain a distribution of 16(rMIE,r7f/IE).
Calculate P-value and threshold as usual.

 

The second test uses the statistic S = | 16(E, M);6(rM|E, rYIE)|:
Test 2:. We declare M to be signiﬁcant if 125 5 0.05 (or S 2 t1(S)),

where [)5 and t1 (S) have their usual meaning. The exact steps are pre-
sented in Algorithm 3, which is described so that it can be adapted for
testing multiple mediators. Otherwise, we would have performed two sets
of permutations and let t1(S) be the maximum of two thresholds, the 95th
percentile for the distribution of | 16(7t(E), M5014 E, rMI E)| and the 95th
percentile for |p(E, M),6(rMIE, WIT/M)|. In this format, Tests 1 and 2 would
be equivalent. To obtain t1 (S), we could perform Algorithms 1 and 2 and
then let 11(3) = 11(ﬁ)l5(Ea 1”) if |l5(Ea MI 2 |l5("M|E, rY|E)| and
11(3) = 11 ((1)/50mm rYIE) if |l5(Ea MI < IﬁO'MIE, rY|E)|- HOWCVCI‘, W6
choose to formally describe the steps for Test 2 by Algorithm 3. In this
form, the algorithm can be easily adapted for multiple mediators. When
considering non-normally distributed variables, Test 2 could, at least in
theory, produce inﬂated type I errors. The test and algorithm described in
Supplementary Section S5 offers a more conservative alternative.

 

Algorithm 3: Permutation Algorithm for p S and t1 (S).
   Iﬁ(rM|E,rY|E)I, then calculate  as in
Algorithm 1 and S” = |l5(7T(E)91W)l5(r YIE, erE)|-

(2) If |l5(E,1W)| Z |l5("M|E,rY|E)|, 0310111346 5(VM|E,T‘7f/|E) as in
Algorithm 2 and S” = | p(E, 1%)“er E, r’lﬁlE)|.

(3) Repeat steps 1 and 2 to obtain a distribution of S”. Calculate
P-value and threshold as usual.

 

 

2.4 Testing multiple mediators

For testing multiple mediators, we start by assuming that the exposure,
putative mediators and outcome are normally distributed and related by
Equations (5) and (6). The DAG in Figure 2 illustrates this relationship:

MiZICMi-j-OtiE-I-EMi, 

K
Y=KY+VE+ZIBiMi+€Ya (6)
i=1

where E ~ N(0,o%), 6M, ~ N(0, 012m) and EY ~ N(0,o§/). Therefore, Y
can also be described by

Y = K; + y*E+ 6;, (7)

K K
where 6’; ~ N(0, 0%, + 2 [3,2012% + (y + Z 05,-,8i)2c7%)
i=1 i=1

When we test multiple mediators, M1, ...,MK, we calculate
,6(E, Mi), 15(I‘M,|E, rylg) and S,- for each metabolite individually. We can
maintain a FWER across all tests by using Bonferroni corrected
thresholds:

(0r |l5(E, M i)| 2 119(0) and |l5(rM.-IEJYIE)| Z 11903))-

Test 2B2. We declare M ,- to be signiﬁcant if 125,. 5 0.05/K (or S,- > t§(S)).

Test 1B2. We declare M ,- to be signiﬁcant if 120,, < 0.05 /K and 12,5, < 0.05/K

Here, tﬂa), $03) and t§9(S) are the 100 x (1 — 0.05/10th percentiles of
the appropriate null distribution. Again, the quality of the permuted

M1

M2
1

2

\

’7

51

S 52

a“ . 51H
1 5K

 

MK_

MK

Fig. 2. A scenario with K possible mediators between exposure and
outcome

estimates of t§(a), $03) and t§;(S) depends strongly on our assumption
that the joint distribution of Y and M, conditioned on E, is uniquely
determined by the marginal distributions deﬁned in Equations (5) and
(6) O(u and Hsu, 2007).

We can also maintain a FWER by using a joint correction through
taking the maximal test statistics. First, letting 1613le = maxi(| ,6(E, M ,-)|)
and 1631431; 2 maxi(|;6(rMilE, rYIE)|), we deﬁne test 1]:

Test 1J2. We declare M,- to be signiﬁcant if pg?" 5 0.05 and pg?" 5 0.05
[or If)(E,Mz-)I 2 ma) and Vim-IE, rYlE)I 2 mm].

where t 1(a) and tJ(,B) are the 95th percentiles of the null distributions of
)6?le and 163143;, respectively, and p3?" and 12%?" compare the values of the
observed statistics for mediator i to these null distributions. Tests 1] and
1B will be nearly identical for independent mediators. The more interest-

ing option is the extension of Test 2, where we deﬁne a single statistic
Sjoint = maXi(Si)3

Test 2J2. We declare M,- to be signiﬁcant if 1) J, 5 0.05 (or S,- 2 tJ(S)).

To deﬁne the permutation algorithm for in and tJ(S), we consider the
following partition of the possible mediators:

A = {i1 |l5(E,Mi)| < 15(7‘M,|E, VY|E)|}
B = {i1 15(E9Mi)l Z |l5("M,-|E,VY|E)|}

We then go through the steps in Algorithm 4.

 

Algorithm 4: Permutation algorithm for p Ji and tJ(S).
(1) For i e A, calculate 16(7t(E), M,-) and S? = | 16(7t(E),
Mi)l5(rY|E, rM,|E)|-
(2) For i e B, calculate 16(rMiIE, r717“) and S? = |,6(E, M ,-),6(rMi| E, rglE)|.
(3) Calculate S133)th = max,(S§’).
(4) Repeat steps 1, 2 and 3 to obtain a distribution of SF . Calculate

jomt °

the P-value, 17],, for each mediator as the proportion of S133)th

exceeding S,- and the threshold tJ(S) as the 95th percentile of this
distribution.

 

 

2.5 Beyond normality

Our framework only needs to be slightly modiﬁed for the scenario where
the outcome is not normally distributed. For example, mediation for
binary outcomes can be tested using the same algorithms. We continue
to let rYIE be the residuals after ﬁtting a linear regression with Y as the
dependent variable and let 16(rMiIE, rYIE) be the sample correlation

 

216

112 /810's112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 p9p1201umoq

910K ‘09 lsnﬁnV no :2

Testing multiple mediators

 

coefﬁcients. Then, we will still assume that the DAG in Figure 2 is true,
but we will replace Equation (6) with:

K
KY'H’E'l-Z ﬂiMi
3 i=1

Pr(Y:1|E,M1,...,MK): (8)

KY+yE+XK:l5iMi
1 + e i=1

However, we will need to slightly modify the algorithms in case/ control
studies, where the data are collected retrospectively. Thus, for p(E, M) to
consistently estimate the correlation between E and M in the overall
population, it is necessary to weight each case by v/ q and each control
by (1 — v) / (1 — q), where 1) represents the prevalence of the outcome in
the overall population and q represents the proportion of cases in the
sample, as in VanderWeele and Vansteelandt (2010). We note that for this
analysis to be performed, one must have prior knowledge of v, as this
cannot be estimated from the data.

The distribution of E is taken to be normal only cut of convenience,
and the same analysis can be performed for other distributions. In the
case where E is discrete and each possible value is represented multiple
times in the dataset, an exact permutation test exists for testing the con-
ditional associations between the mediators and the outcome, instead of
the Freedman—Lane approximation. (Brown and Maritz, 1982).

2.6 Simulations

We simulate studies where all the variables are normally distributed and
follow Equations (3) and (4) (Fig. 1) for the single mediator case and
Equations (5) and (6) (Fig. 2) for the multiple mediator case. The mar-
ginal variance of all variables was ﬁxed to be 1. We also simulate case-
control studies with a binary outcome Y following Equation (8) and a
population prevalence v : 0.2. The sample size, n, for each study was
either 100 or 1000 individuals. For studies with a binary outcome, n was
equally divided among cases and controls. For each simulated study,
20 000 permutations were performed to obtain the permutation distribu-
tions. All methods were implemented in the R programming language
(R Core Team, 2012).

2.6.] Single mediator We ﬁrst consider the scenario where E, M and
Y are normally distributed. To estimate the type I error rates, we set (or, ,8)
to be either (0, 0), (es, 0) or (0, es), where es is the sample size dependent
effect size. As with all simulated studies, we take y : 0. Supplementary
Material shows that letting y 75 0 does not qualitatively affect the results.
We then simulate 10 000 studies and deﬁne the observed type I error rate
to be the fraction of studies where M is declared to be statistically sig-
niﬁcant. To estimate power, we set (a, ,8) to (es,es), (0.5es,1.5es) or (1.5es,
0.5es). We then simulate 1000 studies and deﬁne power to be the fraction
of studies where M is signiﬁcant. So that all marginal variances equal 1,
we let 0% : 1, oil :1—052 and 0%:1—ﬁzoil — (048+ y)2. We con-
sider es: 0.2 for n : 100, and es: 0.08 for n : 1000.

Next, we consider the scenario where Yis binary. The general design is
similar, but for type I error, we set (or, ,8) to either (0, 0), (esl, 0) or (0, esz),
where ,8 now refers to ,81 in Equation (8), and for power we set (or, ,8) to
(esl, esz), (0.5es1, 1.5es2) and (1.5es1, 0.5es2). We consider esl : 0.2,
esz : 0.5 when n : 100 and esl : 0.08, esz : 0.2 when n : 1000. The com-
binations of n, a and ,8 we consider are listed in Table 2 (for normally
distributed outcome) and Supplementary Table S1 (for case-control
study, in Supplementary Materials).

2.6.2 Multiple mediators The simulations are similar to the single
mediator scenario. However, here we must not only deﬁne effects sizes
but also the proportion of mediators with each effect size. Again, we ﬁrst
consider the scenario with normally distributed variables. To obtain the
FWER, we consider either K: 10 or K: 100 null mediators. We set
K1, K2 and K3 mediators to have (a, ,8) : (0,0), (0,es), and (es, 0), re-
spectively. Here, we consider (K1,K2,K3):(10, 0, 0), (7, 3, 0), (7, 0, 3)

Table 2. Single mediator, normally distributed outcome: Type I error and
power are estimated by simulation

 

 

 

 

n or ,8 Type I error: Test 1 Type I error: Test 2
100 0.00 0.00 0.004 0.004

100 0.20 0.00 0.023 0.023

100 0.00 0.20 0.026 0.026

1000 0.00 0.00 0.001 0.001

1000 0.08 0.00 0.034 0.034

1000 0.00 0.08 0.035 0.035

n or ,8 Power: Test 1 Power: Test 2
100 0.20 0.20 0.242 0.242

100 0.10 0.30 0.131 0.131

100 0.30 0.10 0.122 0.122
1000 0.08 0.08 0.510 0.510
1000 0.04 0.12 0.217 0.217
1000 0.12 0.04 0.229 0.229

 

and (6, 2, 2) for K: 10 and (K1,K2,K3) : (100, 0, 0), (70, 30, 0), (70, 0,
30) and (60, 20, 20) for K: 100. We then simulate 10000 studies and
deﬁne the observed FWER to be the proportion of the studies where at
least one mediator is declared to be statistically signiﬁcant. To obtain the
power, we also add a single mediator with (a, ,8) : (es, es). We discuss
the scenario of multiple mediators in Supplementary Section S3 of the
Supplementary Material. We then simulate 1000 studies and deﬁne power
to be the proportion of studies where this true mediator is declared sig-
niﬁcant. When K: 10 or 11 mediators, we consider 100 subjects and
es:0.3. When K: 100 or 101, we consider 1000 subjects and es:0.1.
So that all marginal variances equal 1, we let 0% : 1, aﬁli : 1 — all? and
K K
a; : 1 — 2 13,203,, — (2 05,13,- + y)2. In the Supplementary Material, we
i=1 i:
also consider simulations with more than one true mediator, including
scenarios where one is ‘screening’ mediators.

The DAG in Figure 2 implies that the putative mediators are independ-
ent conditional on exposure. We also want to explore the beneﬁt of Test 2]
when the mediators are conditionally dependent. Speciﬁcally, we consider
the scenario with one true mediator (es : 0.1) and 100 null mediators
(n : 1000), each with or,- : ,8,- : 0 and divided into ﬁve correlated blocks
of equal size. Two mediators in the same block have a correlation of p,
which varies from 0 to 1, whereas any mediators in two different blocks are
independent. We calculate the power based on 10 000 simulated studies.

Next, we consider the scenario where Yis binary. The design is similar,
but we now set (05,-, ,8,-) to either (0, 0), (esl, 0), (0, esz) or (esl, esz), where
,8,- now refers to Equation (8). When K : 10 or 11, we consider n : 100,
es1:0.3 and es2:0.6, whereas for K: 100 or 101, we take n: 1000,
esl : 0.1 and esz : 0.2. The combinations of K1, K2, K3 and K4 we con-
sider are listed in Tables 3 and 4, with K4 being the number of true
mediators (and therefore, just 0 or 1.).

2.7 Navy Colorectal Adenoma study

The original Navy Colorectal Adenoma case-control study (Sinha et al.,
1999) was a study of colorectal adenoma risk factors. A follow-up study
was conducted to investigate circulating metabolites in relation to self-
reported diet and colorectal adenoma in 129 cases and 129 controls.
Serum metabolites were measured by Metabolon Inc., whose methods
have been previously described (Sreekumar et al., 2009; Suhre et al.,
2011). For this analysis, the exposures of interest were the daily intake of

 

217

112 /810's112umo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 papeolumoq

910K ‘09 isnﬁnV uo ::

S.M.Boca et al.

 

Table 3. Multiple mediators, normally distributed outcome: FWER and
power are estimated by simulation

 

 

 

 

 

 

Number of mediators of each type FWER

K K1 K2 K3 K4 Test  Test 
10 10 0 0 0 <0.001 0.013
10 7 3 0 0 0.009 0.048
10 7 0 3 0 0.007 0.050
10 6 2 2 0 0.012 0.048
100 100 0 0 0 <0.001 0.022
100 70 30 0 0 0.005 0.051
100 70 0 30 0 0.006 0.051
100 60 20 20 0 0.007 0.052
Number of mediators of each type Power

K K1 K2 K3 K4 Test  Test 
11 10 0 0 1 0.291 0.666
11 7 3 0 1 0.291 0.447
11 7 0 3 1 0.287 0.452
11 6 2 2 1 0.298 0.403
101 100 0 0 1 0.133 0.657
101 70 30 0 1 0.133 0.268
101 70 0 30 1 0.140 0.277
101 60 20 20 1 0.139 0.243

 

Note: Different effect sizes are considered: K1 mediators have (a, ,6) : (0,0), K2 have
(a, ,8) : (es,0), K3 have (a, ,6) : (0, es) and K4 have (a, ,8) : (es, es).

red meat and the daily intake of ﬁsh (g/day), inferred from dietary ques-
tionnaires and the outcome of interest was the presence of colorectal
adenoma. The prevalence of colorectal adenoma within this age group at
the time of the original study was assumed to be 0.228 (Dr Brooks Cash,
personal communication). Of the 446 known metabolites measured, we
considered only the 149 metabolites present in all study participants. The
metabolite values were batch normalized and log transformed. We normal-
ized the exposure, mediators and outcome by using the residuals from
regression analyses that included gender, age, current smoking status and
body mass index.

3 RESULTS

3.1 Simulations: single mediator

The type I error rates for Test 1 and Test 2 depend on the values
of oz and ,6. When both at : 0 and ,6 : 0, both tests are extremely
conservative, with type I error rates close to 0.0025 : 0.052.
When either (0: >> 0 and ,6 : 0) or (oz : 0 and ,6 >> 0), type I
error rates are closer to 0.05 (Table 2 and Supplementary
Table S1). Note three features. First, similar trends are observed
for normal and binomial outcomes. Second, although permuta-
tion methods for testing conditional associations are not exact,
the type I error rates are below or close to 0.05 (data not shown).
Third, Test 1 and Test 2 produce essentially identical results for
both type I error and power.

When running simulations under the alternative hypothesis,
we found that the threshold for signiﬁcance for Test 2, t1 (S),

Table 4. Multiple mediators, case-control study: FWER and power are
estimated by simulation

 

 

 

 

 

 

Number of mediators of each type FWER

K K1 K2 K3 K4 Test  Test 
10 10 0 0 0 0.001 0.016
10 7 3 0 0 0.009 0.052
10 7 0 3 0 0.007 0.046
10 6 2 2 0 0.013 0.048
100 100 0 0 0 <0.001 0.021
100 70 30 0 0 0.004 0.051
100 70 0 30 0 0.007 0.048
100 60 20 20 0 0.009 0.051
Number of mediators of each type Power

K K1 K2 K3 K4 Test  Test 
11 10 0 0 1 0.197 0.546
11 7 3 0 1 0.197 0.380
11 7 0 3 1 0.163 0.340
11 6 2 2 1 0.173 0.287
101 100 0 0 1 0.102 0.534
101 70 30 0 1 0.102 0.239
101 70 0 30 1 0.053 0.161
101 60 20 20 1 0.074 0.137

 

Note: Different effect sizes are considered: K1 mediators have (a, ,8) : (0, 0), K2 have
(a, ,8) : (esl,0), K3 have (a, ,8) : (0, esz) and K4 have (a, ,6) : (esl,esz).

increased with effect size. Therefore, when at : ,6 was set to be
0.1, 0.2, 0.3, 0.4 and 0.5, we found the corresponding thresh-
olds to be 0.032, 0.050, 0.068, 0.086 and 0.103. Because we are
testing a composite null hypothesis, each permuted statistic still
uses the observed 0? or ,8 and therefore increases with the
observed values.

3.2 Simulations: multiple mediators

The FW ER depends on the values of oz,- and ,8,. When all the
mediators have 0:,- : ,6,- : 0, all four tests are extremely conser-
vative (Tables 3 and 4). In these simulations, where all mediators
were conditionally uncorrelated, we found that power for Test 2J
was larger than the power for Tests 1B, U or 2B. In general, all
three tests (1B, H, 2B) performed nearly identically, so we only
report test 2B here and in Tables 3 and 4. The results from tests
1B and U are provided as part of Supplementary Tables S2 and
S3. For example, with 1000 subjects, 100 null mediators and
at : ,6 : 0.1 for the true mediator, we found the power for de-
tecting an association by Test 2J to be 0.657, 0.268, 0.277 and
0.243 when (K1,K2,K3):(100, 0, 0), (70, 30, 0), (70, 0, 30) and
(60, 20, 20). In contrast, we found the power from Tests 1B, U or
2B, which again are essentially equivalent, to be between 0.13
and 0.14. Importantly, note that the power is greatly improved
by the joint test here, whereas if we generated independent vari-
ables when testing associations, the joint test could offer no
improvement (data not shown). Similar improvements were

 

218

112 /810's112umo[p101x0'sot112u1101u101qﬂ2d11q 111011 p9p1201umoq

910K ‘09 isnﬁnV no 22

Testing multiple mediators

 

observed when considering the scenario with multiple true medi-
ators (Supplementary Table S4).

Tables 3 and 4 show that as K1 decreases, the power for Test
2J decreases, whereas its FWER increases. Both trends can be
explained by the fact that the expected value of Si? is higher when
the null variable has one association, with either E or Y.
For example, assume that M,- is associated with E. The re-
sult is that variable i will likely be included in group B and
the expected value of (Si-T)2 will be approximately
[p(E, Mi)]2xvar(,6(rY|E, rMiIE)). Now, consider Mf, associated
with neither E nor Y. (Si-f. )2 should only be slightly larger than
var(,5(rY|E, rMﬂE» x var(,6(E, MD), a comparatively small
number. Because S? increases with K2 and K3, the threshold
for signiﬁcance increases which, in turn, leads to a decrease in
statistical power. Furthermore, note that when ,0(E, M ,-) 75 0,
|,o(E, M,-)| is more than likely to be comparatively large, and S,-
only requires a single chance event, namely, for | ,6(ry|E, rMiIE)| to
be large, to be statistically signiﬁcant. Hence, lowering K1
increases the FW ER toward 0.05.

The improvement by the joint Test 2J, as compared with 2B, is
a result of the fundamental difference between the Bonferroni
and joint corrections. The Bonferroni correction ﬁxes a percent-
ile, 100 x (1 — 0.05/K), and therefore lets t1? vary across medi-
ators. The joint correction ﬁxes t J and lets the corresponding
percentile, 100 x P(S,- Z t J) vary across all mediators. When test-
ing associations, t3? is effectively independent of the underlying
truth and t; w t J when all variables are independent. In stark
contrast, as we observed in our previous simulations, when test-
ing mediators, t3? is strongly dependent on the true values of oz
and ,6. Moreover, t1? will tend to be larger for true mediators,
when both oz 75 0 and ,6 75 0, resulting in the Bonferroni correc-
tion being especially tough on the true mediators. The improve-
ment by Test 2J, as compared with IE or U, results from the fact
that the thresholds for signiﬁcance for each association are likely
driven by two different metabolites.

As with testing associations, the Bonferroni correction is
increasingly conservative as the correlation between variables in-
creases. Figure 3 shows that, as the correlation within the ﬁve
sets of null mediators increases, the power for the joint correction
increases from 0.670 for p : 0 to 0.768 for p : 1, an increase of
15.9%. However, the power for Test 2B stays approximately
constant. In particular, as p increases, the power of the joint
correction gets closer to the power of the ‘limiting scenario’
(0.760), where there are six independent mediators, one of
which is true; this does not hold for the Bonferroni correction.

3.3 Navy Colorectal Adenoma study

In the Navy Colorectal Adenoma Study, red meat consumption
was associated with an increased risk of colorectal adenoma
(P : 0.010), whereas ﬁsh consumption was associated with a
decreased risk (P : 0.075), adjusting for gender, age, current
smoking status and body mass index. Although no metabolite
could be identiﬁed as a potential mediator for the association
with red meat, Test 2J suggested that increased docosahexaeno-
ate (DHA, ﬁsh oil) may link ﬁsh consumption with a decreased
risk of colorectal adenoma (p J : 0.062, Table 5). DHA was posi-
tively associated with ﬁsh consumption (P<0.001) and nega-
tively associated with adenoma (P : 0.013). This result agrees

0.9-
0.8-
0'7- Method

0.6- -0- Test 21

 

0-5_ TestZB

Powe r

04- — Test 21 (limiting case)
Test ZB (limiting case)
0.3-
0.2-
0.1 -

0.0-

 

 

0:0 0:1 0:2 0:3 0:4 0:5 0:6 0:7 0:8 0:9 1:0
P

Fig. 3. The solid lines illustrate the power for Test 2B (light) and Test 2]
(dark) as a function of p (within block correlation) when there are 100
null mediators and 1 true mediator. Mediators in different blocks are
uncorrelated. The dashed lines show the limiting power, when the 100
null mediators are replaced with 5 independent null mediators

with previous research (Chapkin et al., 2007; Cheng et al., 2003)
and supports ongoing studies like the seaAFOod Polyp
Prevention Trial (http://www.seafood—trial.co.uk/). DHA also
had the smallest P-value by Test 2B (0.006), but this evidence
would not have appeared convincing after adjusting for 149 tests.

4 DISCUSSION

We developed permutation methods for testing multiple putative
mediators. Although such methods can be applied in a variety of
settings, we considered the speciﬁc application of a modern epi-
demiological study that measures 100 or 1000s of similar bio-
markers (e. g. gene expression, protein or metabolite levels). We
show, via simulations, that testing putative mediators by using
the joint correction has substantially higher power over
Bonferroni correction even when all biomarkers are condition-
ally independent. We apply our approach to the Navy Colorectal
Adenoma study and ﬁnd evidence suggesting that DHA may
mediate the protective effect of ﬁsh consumption on adenoma
risk, which would not have been found using Bonferroni.

We ﬁrst deﬁned a permutation method for testing a single
mediator. This method was used to lay the groundwork for
describing our tests of multiple mediators, but is also novel in
the single mediator literature. Whereas prior permutation meth-
ods (Taylor and MacKinnon, 2012) used the Manly (1997) ap-
proach for testing the conditional association between M and Y,
we used the Freedman and Lane (1983) approach which, in gen-
eral, appears to be a more robust approach (Anderson and
Robinson, 2001). We then extended this method to testing mul-
tiple mediators, using either the Bonferroni correction or a joint
correction. The key component of our methods, required to
handle the composite null hypothesis in both the single and mul-
tiple mediator scenarios, is to use two sets of permutations.

A simpler, but incorrect, alternative to our approach would be
to repeatedly permute Y to obtain one null distribution of Sjoint.
Then, repeatedly permute E to obtain another null distribution,
and let pS be the maximum of the two P-values. However, if a

 

219

112 /810's112umo[p101x0'sot112u1101u101qﬂ2d11q 111011 p9p1201umoq

910K ‘09 isnﬁnV no 22

S.M.Boca et al.

 

Table 5. Results for the Navy Colorectal Adenoma study

 

Dietary item Test 2B Test 2]

 

 

Metabolite P-value Metabolite FWER

 

Red meat l-SGPA 0.069 glycerol 0.577
Fish DHA 0.006 DHA 0.062

 

Note: For each dietary intake of interest, we list the most likely mediator, as sug-
gested by Tests 2B and 2J. For the top mediator, we report p; for Test 2B
(i.e. compare with 0.05 divided by 149 tests) and p J for Test 2] (i.e. compare directly
with 0.05). l-SGPA (l-stearoylyglycerophosphoethanolamine) and DHA
(docosahexaenoate).

subset of metabolites was associated with the exposure and a
different subset was associated with the outcome, then the
observed Sjoint would appear extreme as measured by either
simple null distribution.

As with any approach for testing mediation, our method pre-
sumes that the causal paths considered in Figures 1 and 2 are
correct. Thus, we assumed that the only causal paths that may
exist are from the exposure to the biomarkers, from the bio-
markers to the outcome and from the exposure directly to the
outcome. Unmeasured confounders might also lead to incorrect
inferences. Such a confounder might, for example, induce a re-
lationship between M and Y, causing ,6 to appear to be non-zero.
If this same metabolite were associated with E, the result would
be a false positive. Despite this limitation, causal analysis still
offers one of the best methods for testing putative mediators.
Given the popularity of high-throughput technologies, investiga-
tors will soon require methods for testing multiple putative me-
diators. This manuscript is one of the ﬁrst to introduce possible
options.

Funding: Support was from the Intramural Research Program of
the Division of Cancer Epidemiology and Genetics, National
Cancer Institute, National Institutes of Health (NIH).
Computation was performed using the Biowulf Linux cluster
at the National Institutes of Health, Bethesda, Maryland
(http: //biowulf.nih. gov).

Conflict of Interest: None declared.

REFERENCES

Anderson,M.J. and Robinson,J. (2001) Permutation tests for linear models. Aust. N.
Z. J. Stat, 43, 75—88.

Baron,R.M. and Kenny,D.A. (1986) The moderator—mediator variable distinction
in social psychological research: conceptual, strategic, and statistical consider-
ations. J. Pers. Soc. Psychol., 51, 1173—1182.

Biesanz,J.C. et al. (2010) Assessing mediational models: testing and interval estima-
tion for indirect effects. Multivariate Behav. Res., 45, 661—701.

Brown,O.P. (199 5) Quantitative monitoring of gene expression patterns with a com-
plementary DNA microarray. Science, 270, 467—470.

Brown,B.M. and Maritz,J.S. (1982) Distribution-free methods in regression. Aust. J.
Stat, 24, 318—331.

Caffo,B. et al. (2008) Are brain volumes based on magnetic resonance imaging
mediators of the associations of cumulative lead dose with cognitive function?
Am. J. Epidemiol., 167, 429—437.

Chapkin,R.S. et al. (2007) Colon cancer, fatty acids and anti-inﬂammatory com-
pounds. Curr. Opin. Gastroenterol., 23, 48—54.

Cheng]. et al. (2003) Increased intake of n-3 polyunsaturated fatty acids elevates
the level of apoptosis in the normal sigmoid colon of patients polypectomized
for adenomas/tumors. Cancer Lett., 193, 17—24.

Dettmer,K. et al. (2006) Mass spectrometry-based metabolomics. Mass Spectrom.
Rev., 26, 51—78.

Freedman,D. and Lane,D. (1983) A nonstochastic interpretation of reported sig-
niﬁcance levels. J. Bus. Econ. Stat, 1, 292—298.

Huang,Y. et al. (2006) To permute or not to permute. Bioinformatics, 22,
2244—2248.

MacKinnon,D.P. (2008) Introduction to Statistical Mediation Analysis. Erlbaum
Psych Press, New York.

MacKinnon,D.P. et al. (2002) A comparison of methods to test mediation and other
intervening variable effects. Psycho]. Methods, 7, 83.

Manly,B.F.J. (1997) Randomization, Bootstrap and Monte Carlo Methods in Biology.
2nd edn. Chapman & Hall, London.

R Core Team. (2012) R: A Language and Environment for Statistical Computing.
R Foundation for Statistical Computing, Vienna, Austria.

Shendure,J. and Ji,H. (2008) Next-generation DNA sequencing. Nat. Biotechnol,
26, 1135—1145.

Sinha,R. et al. (1999) Well-done, grilled red meat increases the risk of colorectal
adenomas. Cancer Res., 59, 4320—4324.

Sobel,M.E. (1982) Asymptotic conﬁdence intervals for indirect effects in structural
equation models. In: Leinhart,S. (ed.) Sociological Methodology. Vol. 13,
American Sociological Association, Washington, DC, pp. 290—312.

Sreekumar,A. et al. (2009) Metabolomic proﬁles delineate potential role for sarco-
sine in prostate cancer progression. Nature, 457, 910—914.

Suhre,K. et al. (2011) Human metabolic individuality in biomedical and pharma-
ceutical research. Nature, 477, 54—60.

Taylor,A.B. and MacKinnon,D.P. (2012) Four applications of permutation meth-
ods to testing a single-mediator model. Behav. Res. Methods, 44, 1—39.

VanderWeele,T.J. and Vansteelandt,S. (2010) Odds ratios for mediation analysis for
a dichotomous outcome. Am. J. Epidemiol, 172, 1339—1348.

Wardle,J . et al. (2008) Obesity associated genetic variation in FTO is associated with
diminished satiety. J. Clin. Endocrinol. Metab., 93, 3640—3643.

Westfall,P.H. and Young,S.S. (1993) Resampling-based Multiple Testing: Examples
and Methods for p- Value Adjustment. Vol. 279, Wiley-Interscience, New York.

Xu,H. and Hsu,J.C. (2007) Applying the generalized partitioning principle to con-
trol the generalized familywise error rate. Biom. J., 49, 52—67.

 

220

112 /810's112umo[p101x0'sot112u1101u101q/pd11q 111011 p9p1201umoq

910K ‘09 isnﬁnV no 22

