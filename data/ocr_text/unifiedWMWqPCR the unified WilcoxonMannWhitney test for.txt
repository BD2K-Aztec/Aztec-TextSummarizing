APPLICA TIONS NOTE V°"33.3%.159§3Z§315§3€22533Z5§3§

 

Genome analysis

Advance Access publication May 2, 2014

unifiedWMWqPCR: the unified Wilcoxon—Mann—Whitney test for

analyzing RT-qPCR data in R

Jan De Neve1 ’*, Joris Meysl, Jean—Pierre Ottoy‘, Lieven Clement2 and Olivier Thas1 ’3

1Department of Mathematical Modelling, Statistics and Bioinformatics, 2Department of Applied Mathematics,
Computer Science and Statistics, Ghent University, B—9000 Gent, Belgium and 3National Institute for Applied Statistics
Research Australia (NIASRA), School of Mathematics and Applied Statistics, University of Wollongong, NSW 2522,

Australia
Associate Editor: John Hancock

 

ABSTRACT

Motivation: Recently, De Neve et al. proposed a modification of the
Wilcoxon—Mann—Whitney (WMW) test for assessing differential ex-
pression based on RT—q PCR data. Their test, referred to as the unified
WMW (uWMW) test, incorporates a robust and intuitive normalization
and quantiﬁes the probability that the expression from one treatment
group exceeds the expression from another treatment group.
However, no software package for this test was available yet.
Results: We have developed a Bioconductor package for analyzing
RT—qPCR data with the uWMW test. The package also provides
graphical tools for visualizing the effect sizes.

Availability and implementation: The uniﬁedWMWqPCR package
and its user documentation can be obtained through Bioconductor.
Contact: JanR.DeNeve@UGent.be

Received on March 12, 2014; revised on April 24, 2014; accepted on
April 28, 2014

1 INTRODUCTION

Conventional approaches for analyzing RT-qPCR data ﬁrst
adopt a separate normalization step, e.g. using the
Bioconductor package SLqPCR (Kohl, 2007), before assessing
differential expression. This preprocessing step can obscure the
interpretation of the statistical test. Furthermore, the type I error
can be inﬂated, as the additional uncertainty associated with
normalization is typically ignored. If C611 denotes a quantiﬁcation
cycle associated with treatment group 1 and C31 a quantiﬁcation
cycle associated with group 2 for a particular feature (typically a
gene or a microRNA), then the uniﬁed Wilcoxon—Mann—
Whitney (uWMW) test considers the null hypothesis

H0 : MC; < C§)=A, (1)

where the probability P(x < y) := P(x < y) + 0.5P(x = y) allows
for tied quantiﬁcation cycles. If there is no need for normaliza-
tion, under the null hypothesis of no-treatment effect, A = 0.5
and the ordinary Wilcoxon—Mann—Whitney WVMVW test can be
used. However, because of errors in the ﬂuorescence quantiﬁca-
tion or differences in the amount of starting material and enzym-
atic efﬁciencies, among other reasons, A 75 0.5 even in the absence

 

*To whom correspondence should be addressed.

of a treatment effect, and hence, normalization is required. The
uWMW test consists of the following steps: (i) estimate A based
on housekeeping features or on all features when housekeeping
features are not available. The latter approach assumes up- and
downregulation to be balanced; (ii) perform an adjusted WMW
test to test H0 (1) while accounting for the additional uncertainty
caused by estimating A from the data; and (iii) provide standard
errors and P—values.

H0 (1) can be equivalently expressed in terms of odds and odds
ratio’s (ORs) as follows

H0 : oddsw; < 03) = A’ <=> H0 : log 011w; < 03) = 0, (2)

where odds(A) = P(A)/[1 — P(A)], A’ = A/(l — A), and
0R(C; < 03) = odds(C; < C§)/A’.

2 SOFTWARE FEATURES

The uniﬁedWMWqPCR package is developed for R (R Core
Team, 2013) and is a part of the Bioconductor environment
(Gentleman et al., 2004); both are freely available. The package
includes a user’s tutorial and can be installed on all major
platforms.

2.1 Usage

The main function uWM W typically requires two inputs: (i)
a data matrix where the rows indicate the features, the col-
umns indicate the samples and each cell gives the raw (i.e. non-
normalized) Cq values and (ii) a binary vector with length equal
to the number of columns of the data matrix indicating the two
treatment groups. However, other input formats such as data
frames or qPCRset objects from the Bioconductor package
H T qPCR (Dvinge and Bertone, 2009) are also allowed.
A vector with the names of housekeeping features for estimating
A can be given as an optional argument. In the absence of house-
keeping features, all features are used for the estimation of A; see
De Neve et al. (2013) for more details. For more information on
the other optional arguments, we refer to the R help ﬁles.

2.2 Example

We consider the neuroblastoma NB dataset of Mestdagh et al.
(2009) to illustrate the basic functionality of the package.
The data consist of 323 miRNA features measured in 22 and

 

2494 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 [3.10811211an[plOJXO'SODBIIIJOJIITOTQ/[i(11111 IIIOJJ p9p1201umoq

910K ‘09 lsnﬁnV no :2

unifiedWMWqPCR

 

 

 

 

hsa—mir—181b n—I—- 0.59 [ 0.44 , 0.73 ]
hsa—mir—181a -—I—« 0.70 [ 0.55 , 0.81 ]
hsa—mir—92 -—u—: 0.78 [ 0.62 , 0.88 ]
hsa—mir—20a I—I—I 0.64 [ 0.49 , 0.77 ]
hsa—mir—19b -—I—« 0.59 [ 0.44 , 0.72]
hsa—mir—19a I—I—I 0.66 [ 0.51 , 0.78 ]
hsa—mir—18a# -—I—- 0.64 [ 0.49 , 0.77 ]
hsa—mir—18a -—l— 0.61 [ 0.46 , 0.74 ]
hsa—mir—17—5p I—I—I 0.57 [ 0.42 , 0.70]
hsa—mir—17—3p -—a—- 0.41 [ 0.28 , 0.56 ]
Reference p 0 0.37 [0.36 , 0.38 ]
| | | |

 

H

0.16 0.37 0.58 0.79

Observed Outcome: p

Fig. 1. Forest plot of the microRNAs associated with the miR—17—92
and miR—181 cluster

39 samples for the MYCN ampliﬁed (MNA) and MYCN single
copy (MNSC) group, respectively. We refer to the
uniﬁedWMWqPCR vignette for more information. Following
De Neve et al. (2013), we assess null hypothesis (2) using all
features for estimating A as follows:
> library(’unifiedWMWqPCR’)
> data(NBmat)
> dim(NBmat)
[1] 323 61
> table(NBgroups)
NBgroups
MNA MNSC
22 39
> uWMW.out <— uWMW(NBmat, groups = NBgroups)
> uWMW.out
unified Wilcoxon—Mann—Whitney test
with overall normalization
number of features: 323
Fitted probabilities: P(MNA < MNSC) + 0.5 P(MNA = MNSC)

Estimated log odds ratio’s (logor), corresponding standard
errors (se), odds ratio’s (or), test statistics and P—values can be
extracted as follows:

> uWMW.out[names(uWMW.out)]

logor se or z.value p.value
hsa—let—7a 0.7824254 0.3086131 2.186770 2.535296 0.011235249
hsa—let—7b 0.9308019 0.3219984 2.536542 2.890703 0.003843808

The estimated log OR(CMNA < CMNSC) for hsa—let—7a is
given by 0.78, and it is signiﬁcantly different from 0 at the 5%
level of signiﬁcance. The p.adjust function (R, 2013) can be used
to adjust the P—values for multiple testing.

For visualization, the function forestplot can be used to draw
a forest plot of a selection of microRNAs; see Figure 1. The
estimated probabilities in (1) as well as their (unadjusted) 95%
conﬁdence intervals are plotted. The diamond on the bottom
gives the estimate and conﬁdence interval of A with which the
probabilities should be compared with.
> selection.miRNA <— c("hsa—mir—17—3p", "hsa—mir—17—5p", "hsa—mir-18a",

+ "hsa—mir—18a#","hsa—mir—l9a", "hsa-mir-l9b",
+ "hsa—mir—ZOa","hsa—mir—92", "hsa—mir—18la", "hsa—mir—181b")

selection.id <— match(se1ection.miRNA, names(uWMW.out))
forestplot(uWMW.out, estimate = "p", order = selection.id)

As the uWMW test is in essence obtained by ﬁtting a prob-
abilistic index model (Thas et al., 2012), the estimated coefﬁcients
of the model and the estimated variance—covariance matrix can
also be extracted.
> coef(uWMW.out)[1:2]

intercept hsa—let—7a
-O.5340704 0.7824254
> vcov(uWMW.out)[1:2,1:2]
intercept hsa—let—7a
intercept 3.179214e—04 —2.220762e—05
hsa—let—7a —2.220762e—05 9.524204e—02

For more details on the package and its available plots, we

refer to the uniﬁedWMWqPCR vignette and help-ﬁles.

2.3 Performance

As the uWMW test implies ﬁtting a regression model to a dataset
with n1n2N rows and N columns (where N is the total number of
features and n,- the number of samples in group i), its efﬁcient
implementation is an important property of the package.
Analyzing a small dataset of 20 features with 10 replicates for
each treatment group takes <0.2 s, whereas a large dataset of
1000 features with 100 replicates for each treatment group
takes <30 s on an Intel 2.5GHz CPU with 4 GB RAM.

3 CONCLUSION

This article presents the Bioconductor uniﬁedWMWqPCR pack-
age. It provides an extension of the WMW test so that a separate
normalization preprocessing step is no longer required before as-
sessing differential expression. In addition to P—values, the pack-
age also provides informative plots to visualize treatment effects.

Funding: The authors acknowledge the Multidisciplinary
Research Partnership Bioinformatics: From Nucleotides to
Networks Project (01MR0310VW of Ghent University, and the
IAP research network P7 /06 of the Belgian Government (Belgian
Science Policy).

Conﬂict of Interest: none declared.

REFERENCES

De Neve,J. et al. (2013) An extension of the Wilcoxon-Mann—Whitney test for
analyzing RT-qPCR data. Stat. Appl. Genet. Mol. Biol., 12, 333—346.

Dvinge,H. and Bertone,P. (2009) HTqPCR: high-throughput analysis and visual-
ization of quantitative real-time PCR data in R. Bioinformatics, 25, 3325—3326.

Gentleman,R. et al. (2004) Bioconductor: open software development for compu-
tational biology and bioinformatics. Genome Biol., 5, R80.

Kohl,M. (2007) SLqPCR: Functions For Analysis of Real-Time Quantitative PCR
Data at SIRS-Lab GmbH. R package, Jena, Germany.

Mestdagh,P. et al. (2009) A novel and universal method for microRNA RT-qPCR
data normalization. Genome Biol., 10, R64.

R Core Team. (2013) R: A Language and Environment for Statistical Computing.
R Foundation for Statistical Computing, Vienna, Austria.

Thas,O. et al. (2012) Probabilistic index models. J. Roy. Stat. Soc. B Methdol., 74,
623—671.

 

2495

112 /810'S{12umo[pJOJXO'sor1chOJurorw/2d11q IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

