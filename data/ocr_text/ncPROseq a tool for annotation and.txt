APPLICATIONS NOTE V°" 250,-?$5.33ﬁliaiﬁgiifaili/Zliéii

 

Sequence analysis

Advance Access publication October 7, 2012

ncPRO-seq: a tool for annotation and profiling of ncRNAs in

sRNA-seq data

Chong—Jian Chen1’2’3’4’5’*’i, Nicolas Servant1’4’5’*’l, Joern Toedling

1,2,3,4,5,6
’

Alexis Sarazin7, Antonin Marchais8, Evelyne Duvernois—Berthet7, Valerie Cognatg,
Vincent Colot7, Olivier Voinnet8, Edith Heard1’2’3’1, Constance Ciaudo1 2’38“ and

Emmanuel Barillot1’4’5’:

linstitut Curie, 2CNRs UMR3215, 3INSERM ug34, 4|NSERM ugoo, F—75248 Paris, France, 5Mines ParisTech, F—77300
Fontainebleau, France, 6Institute of Molecular Biology gGmbH, G—55128 Mainz, Germany, 7Institut de Biologie de l’Ecole
Normale Supérieure, CNRS UMR8197, and INSERM U1024, F—75248 Paris, France, 8Department of Biology, Swiss
Federal Institute of Technology, Department of Biology, S—8092 Zurich, Switzerland and 9Institut de Biologie Moléculaire
des Plantes, CNRS UPR2357, Université de Strasbourg, F—67084 Strasbourg, France

Associate Editor: lvo Hofacker

 

ABSTRACT

Summary: Non-coding RNA (ncRNA) PROfiling in small RNA (sRNA)-
seq (ncPRO-seq) is a stand-alone, comprehensive and flexible ncRNA
analysis pipeline. It can interrogate and perform detailed profiling ana-
lysis on sRNAs derived from annotated non-coding regions in
miRBase, Rfam and RepeatMasker, as well as specific regions
defined by users. The ncPRO-seq pipeline performs both gene-based
and family-based analyses of sRNAs. It also has a module to identify
regions significantly enriched with short reads, which cannot be clas-
sified under known ncRNA families, thus enabling the discovery of
previously unknown ncRNA— or small interfering RNA (siRNA)—produ-
cing regions. The ncPRO-seq pipeline supports input read sequences
in fastq, fasta and color space format, as well as alignment results in
BAM format, meaning that sRNA raw data from the three current major
platforms (Roche-454, Illumina-Solexa and Life technologies-SOLiD)
can be analyzed with this pipeline. The ncPRO-seq pipeline can be
used to analyze read and alignment data, based on any sequenced
genome, including mammals and plants.

Availability: Source code, annotation files, manual and online version
are available at http://ncpro.curie.fr/.

Contact: bioinfo.ncproseq@curie.fr or cciaudo@ethz.ch
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 24, 2012; revised on September 20, 2012; accepted
on September 21, 2012

1 INTRODUCTION

Research on small non-coding RNAs (ncRNAs) has advanced
tremendously over recent years as a consequence of the wide-
spread adoption of small RNA (sRNA)-seq, which has helped to

 

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as joint First Authors.

3:The authors wish it to be known that, in their opinion, the last two
authors should be regarded as joint Last Authors.

characterize members of known sRNA families, such as
microRNAs (miRNAs), small interfering RNAs (siRNAs) and
piwi-interacting RNA (piRNA) (Brodersen and Voinnet, 2006;
Ghildiyal and Zamore, 2009). In addition, analysis of sRNA-seq
data has led to the identiﬁcation of several novel small ncRNA
families, including heterochromatic sRNA (Rajagopalan et al.,
2006), small nucleolar RNA (snoRNA)-derived RNAs
(stNAs) (Taft et al., 2009), transfer RNA (tRNA)-derived
RNA fragments (tRFs) (Cole et al., 2009; Pederson, 2010), tran-
scription initiation RNAs (tiRNAs), splice-site RNAs
(spliRNAs) (Taft et al., 2010) and enhancer RNAs (eRNAs)
(Kim et al., 2010). Given that most of the genome is transcribed
(Clark et al., 2011), further small ncRNA families are still prob-
ably hidden in unannoated regions, awaiting detailed explor-
ation. Despite this, most of the existing sRNA-seq analysis
tools only focus on miRNAs (Hackenberg et al., 2011; Ronen
et al., 2010), whereas some other tools are applicable to the pre-
diction of special or general siRNA loci (Hardcastle et al., 2012;
MacLean et al., 2010; Stocks et al., 2012). As far as we are aware,
only two approaches—Sequuster (Pantano et al., 2011) and
DARIO (F asold et al., 2011)7are currently available for anno-
tating and classifying whole sRNA-seq data in an unbiased way.
Sequuster not only carefully groups non-miRNA reads into
units but also provides classiﬁcation and annotation of
unit-sRNAs. DARIO web server contains both sRNA annota-
tion and prediction engines, but cannot be used to process
repeat-associated sRNAs, owing to the size limitation of data
submission. Furthermore, these tools perform mostly gene-based
analyses, providing information about read mapping in each
ncRNA gene/region. However, to systematically investigate
small ncRNA species in a given annotation family (i.e.
miRNA, other sRNAs families or repeats families), proﬁling
analyses, which refers to detailed descriptions of diverse features
of read distribution in annotation families, are necessary. The
ncRNA PROﬁling in sRNA-seq (ncPRO-seq) pipeline circum-
vents these limitations by providing detailed information on all
types of small ncRNAs and identifying unannotated regions that
are signiﬁcantly enriched in matching sRNAs.

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3147

112 ﬂJO'srcumo[pJOJXO'sonchogurorq/ﬁd11q mm; popcorn/hog

910K ‘09 lsnﬁnV no :2

C.-J. Chen et al.

 

2 METHODS

The workﬂow of the ncPRO-seq pipeline is composed of ﬁve main steps:
input pre-processing, read mapping, read annotation, annotation ana-
lyses and enrichment analyses (Supplementary Fig. S1). The pipeline is
able to handle sequence ﬁles generated by Solexa, SOLiD and 454
sequencing technologies and alignment ﬁles in BAM format as inputs.
For sequence ﬁle inputs, the pipeline provides several ways to access the
basic properties of sequencing reads, such as distribution of read length,
positional base, mean positional quality score and GC content. An op-
tional step can be introduced, for both sequence and alignment inputs, by
merging reads with identical sequence into non-redundant read groups,
which dramatically improves the performance of the pipeline. Bowtie
(Langmead et al., 2009) is used to align reads to the reference genome.
The mapping statistics and length distribution of mapped reads are com-
puted to summarize mapping information. All reads, including those
matching multiple genomic locations (up to a user-deﬁned threshold),
are kept for subsequent analyses and weighted by the number of mapping
sites. To ﬁnd overlaps between read alignments and genomic annotations,
i.e. to match reads to ncRNA families according to genomic coordinates,
BEDTools (Quinlan and Hall, 2010) is used. Annotation ﬁles for 15
species (including metazoans and plants), based on miRBase
(Kozomara and Grifﬁths-Jones, 2011), Rfam (Gardner et al., 2011),
RepeatMasker, splice site and tRNAs (Dreszer et al., 2012), are pre-
computed and now available for download in the ncPRO-seq web site.
Custom annotation ﬁles in gff3 format are also acceptable, which will be
considered as user-deﬁned ncRNA families and be processed in the same
way as known ncRNA families. Four types of operations are provided to
help users focus on subregions or regions ﬂanking given annotations
(Supplementary Fig. S2). Analyses are then performed for reads that
have 100% overlap with annotations. Reads annotated as major anno-
tation families, as well as each family of Rfam and repeats, are counted
and plotted to provide a systematic view of read annotations. For each
annotation family, the table containing the expression of reads in each
single member and the track ﬁle for visualization are created. To obtain
detailed family-based information, read proﬁling and read logos for each
family are computed. Read proﬁling is represented by the distribution of
read coverage along the consensus sequence and by the distribution of
read length (Supplementary Fig. S3). Read logos describe the positional
base bias in all reads mapped in the family. For reads that cannot be
annotated as known features, a sliding-window process coupled with
model ﬁtting is performed to identify regions that are signiﬁcantly en-
riched with such reads (Toedling et al., 2010).

3 IMPLEMENTATION

The ncPRO-seq pipeline can be used in a Linux/Unix-like oper-
ating system, where several required softwares have been
pre-installed. Two different ways of running the pipeline are
provided, a stand-alone command line version and a local web
interface. Both versions require a conﬁguration ﬁle to set up the
analysis parameters. After editing the conﬁguration ﬁle, the user
can easily run the complete analysis workﬂow with a simple
command line. The pipeline is modular and sequential, which
allows the user to focus on a speciﬁc part of the pipeline without
running the complete workﬂow. The pipeline also provides a
local web interface (Supplementary Fig. S4), which offers the
possibility to set up the parameters of the conﬁguration ﬁles in
a user-friendly way, to run the pipeline. Finally, an online version
for small datasets and tests is also available at http://ncpro.curie
.fr/online.html.

4 OUTPUT

After running ncPRO—seq, an html report is generated, facilitat-
ing the visualization of the results that are organized under dif-
ferent web tabs. Besides essential tabs containing information
about pipeline performance, tables and ﬁgures of read quality
controls, mapping and annotations, each annotation family spe-
ciﬁed by the user has an independent tab displaying the results of
detailed proﬁling analyses. All images and tables generated by
the pipeline can be visualized at high resolution or downloaded
for further analysis. An example of a report from a test library is
available at http://ncpro.curie.fr/results.html.

5 CONCLUSION

The ncPRO—seq pipeline provides a comprehensive approach for
the annotation and prediction of small ncRNAs in sRNA-seq
data. The pipeline can analyse different annotation families
rather than just focusing on miRNAs. Various sequence and
alignment inputs from different metazoan and plant genomes
are supported. The great advantage of the pipeline over others
is the capacity to perform proﬁling analyses of annotation
families, which is critically important to investigate known
small ncRNA families and to deﬁne novel small ncRNA families.
The signiﬁcant regions predicted in the pipeline can be further
interpreted to identify novel miRNA loci and siRNA clusters.

Funding: This research was funded by Institut Curie, INCa
‘Gepig’, and by grants from ANR (RNA ES, E.H., O.V.),
ANR (EPIMOBILE, V.C.), ERC (‘Frontiers of RNAi’, no.
210890, O.V.), ERC (no. 250367, E.H.) and SYBOSS (no.
242129, E.H.). E.H. and V.C. are members of the European
Network of Excellence ‘EpiGenesys’. This work was supported
by a post-doctoral fellowship of Federation of European
Biochemical Societies (FEBS) to CO The funding bodies had
no role in the study design, data collection and analysis, decision
to publish or preparation of the manuscript.

Conflict of Interest: none declared.

REFERENCES

Brodersen,P. and Voinnet,0. (2006) The diversity of RNA silencing pathways in
plants. Trends Genet., 22, 268—280.

Clark,M.B. et al. (2011) The reality of pervasive transcription. PLoS Biol, 9,
e1000625; discussion e1001102.

Cole,C. et al. (2009) Filtering of deep sequencing data reveals the existence of
abundant dicer-dependent small RNAs derived from tRNAs. RNA, 15,
2147—2160.

Dreszer,T.R. et al. (2012) The UCSC Genome Browser database: extensions and
updates 2011. Nucleic Acids Res, 40, D918—D923.

Fasold,M. et al. (2011) DARIO: a ncRNA detection and analysis tool for
next-generation sequencing experiments. Nucleic Acids Res, 39, W112—W117.

Gardner,P.P. et al. (2011) Rfam: Wikipedia, clans and the ‘decimal’ release. Nucleic
Acids Res, 39, D141—D145.

Ghildiyal,M. and Zamore,P. (2009) Small silencing RNAs: an expanding universe.
Nat. Rev. Genet., 10, 94—108.

Hackenberg,M. et al. (2011) miRanalyzer: an update on the detection and analysis
of microRNAs in high-throughput sequencing experiments. Nucleic Acids Res,
39, W132—Wl38.

Hardcastle,T. et al. (2012) Identifying small interfering RNA loci from
high-throughput sequencing data. Bioinformatics, 28, 457—463.

Kim,T.K. et al. (2010) Widespread transcription at neuronal activity-regulated en-
hancers. Nature, 465, 182—187.

 

3148

112 /810'S{12umo[pJOJXO'sor1emJOJurorw/2d11q IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

nePRCLseq

 

Kozomara,A. and Grifﬁths-Jones,S. (2011) miRBase: integrating microRNA anno-
tation and deep-sequencing data. Nucleic Acids Res, 39, D152—D157.

Langmead,B. et al. (2009) Ultrafast and memory-efﬁcient alignment of short DNA
sequences to the human genome. Genome Biol, 10, R25.

MacLean,D. et al. (2010) Finding sRNA generative locales from high-throughput
sequencing data with NiBLS. BMC Bioinformatics, 11, 93.

Pantano,L. et al. (2011) A non-biased framework for the annotation and classiﬁca-
tion of the non-miRNA small RNA transcriptome. Bioinformatics, 27,
3202—3203.

Pederson,T. (2010) Regulatory RNAs derived from transfer RNA? RNA, 16,
1865—1869.

Quinlan,A.R. and Hall,I.M. (2010) BEDTools: a ﬂexible suite of utilities for com-
paring genomic features. Bioinformatics, 26, 841—842.

Rajagopalan,R. et al. (2006) A diverse and evolutionarily ﬂuid set of microRNAs in
Arabidopsis thaliana. Genes Dev., 20, 3407—3425.

Ronen,R. et al. (2010) miRNAkey: a software for microRNA deep sequencing
analysis. Bioinformatics, 26, 2615—2616.

Stocks,M. et al. (2012) The UEA sRNA workbench: a suite of tools for analysing
and visualizing next generation sequencing microRNA and small RNA datasets.
Bioinformatics, 28, 2059—2061.

Taft,R.J. et al. (2009) Small RNAs derived from snoRNAs. RNA, 15, 1233—1240.

Taft,R.J. et al. (2010) Nuclear-localized tiny RNAs are associated with transcription
initiation and splice sites in metazoans. Nat. Struct. Mol Biol, 17, 1030—1034.

Toedling,J. et al. (2010) Girafe—an R/Bioconductor package for functional explor-
ation of aligned next-generation sequencing reads. Bioinformatics, 26,
2902—2903.

 

3149

112 /810'S{12umo[pJOJXO'sor112u1101urorq//2d11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

