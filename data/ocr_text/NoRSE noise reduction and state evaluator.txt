APPLICATIONS NOTE

Vol. 28 no. 2 2012, pages 296-297
doi: 1 0. 1 093/bioinformatics/btr632

 

Data and text mining

Advance Access publication November 15, 2011

NoRSE: noise reduction and state evaluator for high-frequency

single event traces

Nigel F. Reuel‘, Peter Bojo‘, Jingqing Zhang‘, Ardemis A. Boghossian‘, Jin-Ho Ahn‘,

Jong-Ho Kim2 and Michael S. Stranol’*

1Department of Chemical Engineering, Massachusetts Institute of Technology, Cambridge, MA 02139, USA and
2Department of Chemical Engineering, Hanyang University, Ansan 426—791, Republic of Korea

Associate Editor: John Quackenbush

 

ABSTRACT

Summary: NoRSE was developed to analyze high-frequency
datasets collected from multistate, dynamic experiments, such as
molecular adsorption and desorption onto carbon nanotubes. As
technology improves sampling frequency, these stochastic datasets
become increasingly large with faster dynamic events. More efficient
algorithms are needed to accurately locate the unique states in each
time trace. NoRSE adapts and optimizes a previously published noise
reduction algorithm and uses a custom peak flagging routine to
rapidly identify unique event states. The algorithm is explained using
experimental data from our lab and its fitting accuracy and efficiency
are then shown with a generalized model of stochastic datasets. The
algorithm is compared to another recently published state finding
algorithm and is found to be 27 times faster and more accurate over
55% of the generalized experimental space. NoRSE is written as an
M-file for Matlab.

Availability: http://web.mit.edu/stranogroup/NoRSE.txt

Contact: strano@mit.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on September 13, 2011; revised on November 7, 2011;
accepted on November 9, 2011

1 INTRODUCTION

As stochastic biological studies are preformed at increasingly
smaller length and time scales, the analysis of large, noisy datasets is
becoming an increasingly common problem. In our laboratory, these
sets consist of time traces gathered from monitoring the ﬂuorescence
of single—walled carbon nanotube (SWNT)—based sensors. As target
molecules bind to a single sensor, the ﬂuorescence is quenched
in a stepwise manner (Cognet et al., 2007), resulting in unique
ﬂuorescent states that correspond to the number of bound sites along
the length of the nanotube (J in et al., 2008). Although NoRSE was
created with our ﬂuorescence datasets in mind, the algorithm can
be readily applied to other, analogous biological experiments that
contain event states. This is demonstrated by an error analysis of
generalized stochastic traces as shown below.

 

*To whom correspondence should be addressed.

2 ALGORITHM EXPLANATION

In this note, data from our SWNT—based, protein—protein sensors
are analyzed. Excited SWNT ﬂuoresce due to their unique band
gap structure (Bachilo et al., 2002) and can be quenched by speciﬁc
molecules or chelating groups (J in et al., 2008). At a single—molecule
level, the quenching is exhibited in a stepwise manner as each of
the limited, exciton excursion distances of the SWNT are occupied
(Cognet et al., 2007). Our 900 nm sensor exhibits a maximum of 10
binding events or 10 step levels. The ﬂuorescence of each SWNT is
monitored for 3000 time steps and NoRSE efﬁciently resolves the
bound states. NoRSE imports the data traces X1(t), X2(t), ...Xn(t)
and normalizes them by the maximum intensity such that {Xi :0 <
X ,- < 1} (Fig. 1A—top trace is a control and the bottom trace exhibits
binding events).

Xi(t) is then noise reduced (Fig. 1B) by the Chung and Kennedy
algorithm (Chung et al., 1991). Their forward—backward, non—linear
ﬁltering technique was designed to preserve high—frequency step
events surrounded by background noise. In brief, the algorithm
searches forward and backwards from each data point using a
bank of window sizes to weigh the probability of a sharp step
occurring. Their algorithm contains three parameters (p— which sets
the sharpness of state transitions, N — which speciﬁes a set of forward
and backward windows and M — which sets how much data the N
windows are run against), which were optimized in the original work
for patch—clamp experiments (Chung et al., 1991) and subsequently
for protein folding experiments (Haran, 2004). We used Monte Carlo
simulations of generic, noisy, high—frequency event traces to further
explore this parameter optimization (Supplementary Material A).
Generally, we found that an increasing value of p and N and a
decreasing value of M improved the noise reduction algorithm’s
ability to reconstruct the original trace, but the improvement was
marginal. Thus, the program is set to run with p, N and M values of
40, [4 8 16 32], and 10, respectively, for all types of experimental
traces.

After noise reduction of Xi(t), all point histograms with 200
bins are generated for Xi(t) (Fig. 1C). The distinct groups of
histogram peaks represent event states but vary in height and
width depending on their frequency and uniqueness, respectively.
A detailed explanation of this peak ﬂagging routine is given in the
Supplementary Material, but brieﬂy all potential peaks are ﬂagged
and then logic is used to determine which peaks are unique and
which should be combined with neighboring peaks. The result is
a vector of signiﬁcant peak bin numbers, which are then translated
back to the corresponding signal levels of Xi(t). These are the unique

 

296 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

NoRSE

 

I"

Hutu
Ruducﬁun
Algnﬁthm

{churn It
all

 

Mrr'IaIIze :l Resp nr‘ 55-

 

 

 

_ r:
E:- -

 

Frequent:
I'H.‘
ﬂ

   

 

 

I.
C1 Eli I]

III E '-
Hnrrnr-Illren Response HurIr'IaIIzEd Hespanse

 

 

 

 

 

 

 

 

 

 

'I
"I; "I" I
I:' _=.I"JI'I_'|I . | .. I L m1._ai__III_I-." ..-I.ru-J
g '1'? .e T If I
I1: III
E
t!
a - .
IE -__|
F .114 .
5 .  . II .
:I‘. —-— _I_
I'. m: Innu I an

ﬂ

Ingu'II- 9 Eu ml '- Ir'eii-csigr al Sam:an Time];

ID

Il'llI:-'1'III|F'II'I‘I'1TI'IF'IWRIIJIIJISull‘lllll‘lu TIrIrJ|
II

 

 

3E0 E'_5 .- '11:-
Ili- 7 a '35 t a 3 HI“:
“I, :32
'I- [IE-J 31.;
DE! 5
25— [:3 D“ ‘—
r: [:35 WEE-—
.r:
2' {'55 0‘5 [HR [-1 '
" -‘- III-1F!
I  II I I I - n1 {13
-? -'|E U: I] :l- '1 '15 2

 

- _ :I
IVES-Em; EIIEEI SEE-:I'L-h'q HEIIE 2::

I __ I I
I“ naﬂﬁai‘gﬁr L
315 113‘.-
DEE

_E- 2.31 ..
:15- n45G-1- :12
.=- '3'5 D25 -
45- ‘3 I355 '3'-'- :05 ..
Udall-1 :1
his
I255

 

_-
_'h

w
J

L.

 

 

{15535 “5 _
- ; ﬁn ﬁx @naﬁ
['25 J1
___ DEE I33 $1.5:
-f:ue.5 I” “51 15  E
:E— H 3535 “5 5,1";
t '3' ’ :1 '5 D 5 Encssﬁ
c— -' F :- :‘I
I Jun... I‘  h I Iain—"I'M. I A. I .—
.3 .1-3 .1 --_'I-' I.- ” I 1'5 2

:r.j-;..; Slap ice I- .; Hie '

Fig. 1. Explanation and evaluation of NoRSE. (A) Control (blue) and signal (green) traces are normalized and (B) noise reduced by Chung et al. algorithm.
(C) All point histogram peaks of each trace are identiﬁed as unique event states to which the trace is ﬁt (D). (E) Corresponding SFA ﬁt of these traces. (F) The
ﬁt error percentage of NoRSE over a general experimental space (green star 2 general region for patch clamp experiments, red =FRET protein folding and
orange 2 SWNT protein—protein sensors). (G) Error percentage of SFA algorithm. Shaded area is the experimental space in which NoRSE outperforms SFA.

state levels for the trace. Finally, each time point of the noise reduced
trace of Xi(t) is compared with the possible state levels and the one
that ﬁts closest is assigned. Qualitatively, the ﬁt looks good for our
experimental data (Fig. 1D), but we were interested in a quantitative
method of determining the error as well as ﬁnding its applicability
to other types of data that contain step events. This analysis is done
in the following generalized model.

3 ERROR ANALYSIS OF GENERALIZED MODEL

Stochastic traces that contain unique event states can be generalized
with three basic parameters: A: (tendency upwards movement /
tendency downwards movement), B = (average event time / signal
sampling time) and C = (average event transition size / average noise
level). Further discussion on the meanings of these parameters is
provided in the Supplementary Material, but many types of single—
event experiments can be cast on this generalized experimental space
(Fig. 1E). As the parameter A has less of an effect on the ﬁtting—
ﬁdelity, it was held at the equilibrium level of 1, while the other
parameters B and C were varied over the ranges of 5—500 and
0.1—10, respectively. For each parameter combination, 100 traces
were generated at 1000 time steps each. The noisy trace was sent to
NoRSE and the resulting ﬁt was compared with the known generated
trace. Each time step was analyzed to see if it was within 2% of the
real value, if not, it was marked as an error. Finally, the average
error percent for each B—C combination was reported (Fig. 1F). The
contour plot maps the speciﬁc regions where the NoRSE algorithm
is most accurate; it begins to have errors >10% at B values <20
and C values <2.7.

To compare NoRSE’s computational efﬁciency and accuracy, an
identical error analysis was performed on a popular ‘State—Fitting

Algorithm’ (SFA) used for similar noisy, dynamic traces
(Kerssemakers et al., 2006). SFA uses a series of chi—squared best
ﬁt analyses as the number of steps (S) is iteratively increased and
compared to corresponding ‘anti—ﬁts’. The resulting error contour
map (Fig. 1G) indicates regions in which NoRSE outperforms SFA
(>55% of the modeled space—shaded region in Fig. 1G). The
physical run time of NoRSE on the 39 000+ model traces was 27
times faster. By scaling the algorithms and taking the approximate
ratio of SFA to NoRSE (Supplementary Material D), we ﬁnd that
NoRSE is on the order of [S2 / (K (N —l—3))] more efﬁcient than SFA,
where S is the number of SFA ﬁt steps and K and N are parameters of
the noise reduction algorithm. The two algorithms were performed
on the protein—protein traces and the average run time was 25 times
faster for NoRSE (32 predicted from approximate scaling).

Funding: NSF Graduate Fellowship to N.F.R.

Conﬂict of Interest: none declared.

REFERENCES

Bachilo,S.M. et al. (2002) Structure-assigned optical spectra of single-walled carbon
nanotubes. Science, 298, 2361—2366.

Chung,S.H. and Kennedy,R.A. (1991) Forward-backward non-linear ﬁltering technique
for extracting small biological signals from noise. J. Neurosci. Meth, 40, 71—86.

Cognet,L. et al. (2007) Stepwise quenching of exciton ﬂuorescence in carbon nanotubes
by single-molecule reactions. Science, 316, 1465—1468.

Haran,G. (2004) Noise reduction in single-molecule ﬂuorescence trajectories of folding
proteins. Chem. Phys, 307, 137—145.

Jin,H. et al. (2008) Stochastic analysis of stepwise ﬂuorescence quenching reactions on
single-walled carbon nanotubes: single molecule sensors. Nano Lett, 8, 429941304.

Kerssemakers,J.W.J. et al. (2006) Assembly dynamics of microtubules at molecular
resolution. Nature, 442, 709—712.

 

297

112 /3.IO'SIBUJHOIPJOJXO'SOIlBHlJOJUIOIQ/ﬂdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

