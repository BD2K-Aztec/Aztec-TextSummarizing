Bioinformatics Advance Access published July 13, 2016

Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw391

Advance Access Publication Date: 4 July 2016
Applications Note

 

Genetics and population analysis

TwoPhaselnd: an R package for estimating
gene—treatment interactions and discovering
predictive markers in randomized clinical trials

Xiaoyu Wang1 and James V. Dai1'2'*
1Public Health Sciences Division, Fred Hutchinson Cancer Research Center, Seattle, WA, USA and 2Department of
Biostatistics, University of Washington, Seattle, WA, USA

*To whom correspondence should be addressed.
Associate Editor: Oliver Stegle

Received on March 17, 2016; revised on May 24, 2016; accepted on June 16, 2016

Abstract

Summary: In randomized clinical trials, identifying baseline genetic or genomic markers for
predicting subgroup treatment effects is of rising interest. Outcome-dependent sampling is often
employed for measuring markers. The R package TwoPhaselnd implements a number of efficient
statistical methods we developed for estimating subgroup treatment effects and gene—treatment
interactions, exploiting the gene—treatment independence dictated by randomization, including the
case-only estimator, the maximum estimated likelihood estimator and the semiparametric max-
imum likelihood estimator for parameters in a logistic model. For rare failure events subject to cen-
soring, we have proposed efficient augmented case-only designs, a variation of the case—cohort
design, to estimate genetic associations and subgroup treatment effects in a Cox regression model.
The R package is computationally scalable to genome-wide studies, as illustrated by an example
from Women’s Health Initiative.

Availability and Implementation: The R package TwoPhaselnd is available from http://cran.r-pro

 

ject.org/web/packages.
Contact: jdai@fredhutch.org

 

1 Introduction

Depending on genetic background and clinical characteristics, in-
dividuals respond differently to treatment or prevention. In
randomized clinical trials, there is a rising interest in identifying
baseline biomarkers that predict subgroup or individual treatment
effects, for example pharmacogenenetics or pharmacogenomics
studies, that may lead to personalized or precision medicine. A
common design of such studies is to measure predictive biomarkers
of treatment efficacy from achieved specimens after trial comple-
tion (Simon et al., 2009). The genetic or genomic markers are often
expensive to measure, particularly for genome-wide high-through-
put assays such as Whole-genome sequencing. The outcome-
dependent sampling, such as case—control or case—cohort sampling
are Widely used for cost efficiency in this type of retrospective
studies.

Efficient statistical methods have been developed for estimating
gene—treatment interaction and subgroup treatment effects for a
range of outcome-dependent sampling schemes, exploiting the gene—
treatment independence dictated by randomization (Dai et al., 2009,
2012, 2014, 2016). The efficiency gain can be as much as 50%
when compared to approaches not using the gene—treatment inde-
pendence. For rare events often studied in prevention trials, the case-
only estimator has been advocated: biomarkers are measured only in
the cases, yet subgroup treatment effects and gene—treatment inter-
actions are estimated with the same efficiency as the full cohort ap-
proach Where all participants are measured. For not-so-rare
dichotomized trial endpoints (for example cancer therapeutic trials)
and case—control sampling for biomarkers (Dai et al., 2012, 2014),
semiparametric maximum likelihood estimators and maximum esti-
mated likelihood estimators have been developed with efficient algo-
rithms (Dai et al., 2009). We recently proposed augmented case—

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1

9mg ‘09 isnﬁnV uo salaﬁuV soq ‘eiuiomeg JO AiiSJQAiu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuoguioiq/ﬁdnq wort papeolumoq

X. Wang and J.Y.Dai

 

only designs for trials with rare events subject to censoring, in which
genetic/biomarker main effects are also of interest (Dai et al., 2016).

The R package TwoPhaseInd assembles a number of functions to
compute the estimates and provide standard error and P-values for
subgroup treatment effects and gene—treatment interactions in vari-
ous aforementioned study settings. The ‘TwoPhase’ part in the name
of the package refers to the retrospective sampling for biomarker
measurement after the completion of the prospective trial, and the
‘Ind’ part refers to the unifying theme in implemented methods that
we exploit gene—treatment independence to improve the estimation
efficiency. Data examples are included in the package and presented
in an R package vignette.

2 Methods

Consider an ancillary biomarker study for a two-arm randomized
clinical trials with treatment assignment Z (Z = 1 if investigational
treatment, Z = 0 if control treatment), disease endpoint Y and base-
line biomarker G. For ease of exposition, additional covariates are
omitted. Suppose an outcome-dependent design was employed for
measuring G in archived samples. The R package TwoPhaseInd pro-
vides functions for each of the designs below:

2.1 Case-only estimator

The case-only design can be used to estimate the gene—treatment
interaction and subgroup treatment effects in trials when the disease
endpoint is rare (for example the prevalence of the event 3 0.05).
The following logistic regression model is fitted to biomarker data
in cases only by the function caseonly: Logit{IE(Z|G,Y = 1)} =
log{ﬁ} + [30 + 01G, where 1: is the randomization fraction to the
investigational treatment arm. The resulting estimates for [30 and [31
are the subgroup effect when G = 0 and the gene—treatment inter-
action, respectively.

2.2 Estimators for case—control sampling

For case—control studies to assess the effect modification of baseline
biomarkers, where the event rate is not necessarily rare, semipara-
metric models can be used to estimate subgroup treatment effects
and gene—treatment interactions (Dai et al., 2009). The data struc-
ture has essentially a two-phase sampling form: the first-phase data
contain the treatment assignment and the disease outcome known
for every subject; the second-phase data contain the biomarker
measured for a case—control subsample, and possibly a collection of
adjusting covariates (for example eigen vectors from principal com-
ponent analysis of genome-wide genetic data). We denote X to be
the collection of covariates measured in the case—control samples,
including the biomarker G. The semiparametric likelihoods using
the independence XJ_Z can be written as LHB, G) =

Hievfﬁ(yilxi,zi)gx.H,-ev (Emergefsoilxbea), where fpb’li) is
the parametric regression model with parameters [3, which often
takes the form of a generalized linear model; g(x) is the density func-
tion for x irrespective of z. We assume sampling takes place so that
only a subset of subjects have X measured in phase two, and X de-
notes the set of observed X regardless of Z. Because of the orthogon-
ality of Z and X, the density function of X does not have to
condition on Z, thereby improving efficiency. Two functions are
available to estimate the B parameter of the regression model. The
first function spmle applies a profile likelihood based on the
Newton—Raphson algorithm to compute semi-parametric maximum
likelihood estimate, and the second one mele computes maximal

estimated likelihood estimator. The details can be found in Dai et al.
(2009)

2.3 Estimators for case—cohort sampling

For usual failure time endpoints subject to censoring, the case-only
estimator still applies when the event is rare. However the genetic
main effect (as a prognostic marker) cannot be assessed by case-
only design. We proposed augmented case-only designs to supple-
ment controls to achieve estimation for all parameters in a Cox
model (Dai et al., 2016). The R package TwoPhaseInd has a
function acoarm to implement a multi-step method that employs
classical case—cohort estimation methods, but incorporating the
case-only estimators. Specifically, consider a proportional hazards
model with gene—treatment interaction Mt; Z, G, V) =
k0(t)exp(BlG + BZCOZ + 0360 GZ + [34 V), where k0(t) is a baseline
hazard function, t denotes time, G denotes the baseline biomarker of
interest, V denotes a set of pre-treatment variables to be adjusted in
risk association, 0260 and 0360 are case-only estimators. The controls
sampled in augmented case—cohort designs are used to obtain esti-
mates of [31 and B4, as well as the baseline hazard functions. It con-
siders two scenarios of adding controls to the case-only design:
classical case—cohort design with controls drawn from both the treat-
ment arm and the placebo arm, and augmented case-only design with
controls draw from one of the two arms (Dai et al., 2016).

3 Data example and illustration

The TwoPhaseInd package can be used in genome-wide studies for
gene—treatment interactions. The current version of the package can
be used to interrogate gene—treatment interaction for genotypes one
at a time. As an example, we illustrated the usages of case-only esti-
mator, the semiparametric maximum likelihood estimator (SPMLE)
and the maximum estimated likelihood estimator (MELE) in
Women’s Health Initiative (WHI) hormone trial. The goal is to esti-
mate the interaction between biomarkers (SNPs) and hormone ther-
apy (estrogen plus progestin) on type II diabetes. A case—control
study was conducted to measure genome-wide SNPs. The dataset
we illustrated below consists of 1020 diabetes cases and 2127
matched controls, all of which have genome-wide SNPs measured.
Figure 1 shows the case-only, the SPMLE and MELE results for
interactions of the hormone treatment and 78081 SNPs on chromo-
some 1. The quantile-quantile plots in the upper panels (Fig. 1A—C)
compare the distribution of observed p-values with that of a
uniform-distributed p-values. Although there is no significant

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A D-Q PM i-IDSImLDI] B U-Cl Plot [- hﬁwipli c U-Cl Phil-109mb]!
In: - m m _
.9 * -:-- .. .:i- ' 15 - - -
E
E M VJ E I'TI
" In
5' a — “j w _ E N
5 Lu m
R 5 g
13 El ' D
0 I Z 3 4 5- U | 2 3 4 5 U | 2 3 4 5
SPMLE amnesia-cl MELE rope-31M Gasser-Ir.- some-clad
D “Fl-'9' E 'II'II'IIM F Vii-no.
? he” 15 °
*2 - w 
'- ' a
c.’ I. in c: :- I.
E  ' ' E g E F D ,u'
n:- -
3 ' ; |:i
5. _ C! a
D I I I I I I I I a - I - I
(In 112 CH 13.5 ELB LD 1.2 I10 I12 DA I113 BLE- 1.|ZI 1‘2 M 112 I111 113 {L5- 1.IZI 1.2
SPMLE I.n|:I-1 MELE Ind-1 SPMLE Ird-T

Fig. 1. The results of the three estimators in the WHI study

9mg ‘09 isnﬁnV uo salaﬁuV soq ‘eiuiomeg JO AiiSJQAiu [1 112 ﬂJO'smumo[pJOJXO'sopeuuoguioiq/ﬁdnq wort papeolumoq

TwoPhaselnd

 

P-value, the q—q line is right in the diagonal direction, suggesting the
algorithm works well in estimation for all three methods. The first
two graphics in the lower panels of Figure 1D,E shows the estimated
variances of SNP-treatment interaction, using or without the inde-
pendence between treatment and the SNP, suggesting that using in-
dependence yields a much more precise estimates of interaction. The
last graph in the lower panel (Fig. 1F) shows the comparison of the
case-only estimator and the SPMLE estimator, suggesting the two
agrees well in efficiency of estimation since type II diabetes is rela-
tive rare in the WHI hormone trial.

Acknowledgements

The authors thank the members of CRAN team for testing and distributing
the package. The authors thank the WHI investigators and staff for their dedi-
cation, and the study participants for making the program possible.

Funding

The WHI program is funded by the National Heart, Lung and Blood
Institute, National Institutes of Health, US Department of Health and

Human Services through contracts HHSN268201100046C, HHSN26 820160
0003C, HHSN268201600002C, HHSN268201600004C, HHSN268201600
001C and HHSN271201100004C. This work is supported by the NIH grants
P01 CA53996, R01 HL114901.

Conﬂict of Interest: none declared.

References

Dai,J.Y. et al. (2009) Semiparametric estimation exploiting covariate inde-
pendence in two-phase randomized trials. Biometrics, 65, 178—1 87.
Dai,J.Y. et al. (2012) Two-stage testing procedures with independent ﬁltering
for genome-wide gene-environment interaction. Biometrika, 99, 929—944.
Dai,J.Y. et al. (2014) Case-only methods for competing risks models with ap-
plication to assessing differential vaccine efﬁcacy by viral and host genetics.
Biostatistics, 15, 196—203.

Dai,J.Y. et al. (2016) Augmented case-only designs for randomized clinical tri-
als with failure time endpoints. Biometrics, 72, 30—3 8.

Simon,R.M. et al. (2009) Use of archived specimens in evaluation of prognos-
tic and predictive biomarkers. ]. Natl. Cancer Inst., 101, 1446—1452.

9mg ‘09 1sn8nV uo salaﬁuV soq ‘121u101n123 10 [QISJQAIII [1 112 [3.10811211an[p.IOJXO'SODBIIHOJIIIOIQ/ﬂ(11111 111011 papeolumoq

