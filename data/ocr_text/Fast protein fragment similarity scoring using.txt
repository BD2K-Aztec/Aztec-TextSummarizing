ORIGINAL PAPER

Vol. 30 no. 6 2014, pages 784-791
doi: 1 0. 1093/bioinformatics/btt618

 

Structural bioinformatics

Advance Access publication October 27, 2013

Fast protein fragment similarity scoring using a Binet—Cauchy

kernel
Frederic Guyon” and Pierre Tuffery1 ’2’3

1Univ Paris Diderot, Sorbonne Paris Cite, Molecules Therapeutiques in Silico, UMP 973, F—75205 Paris, France,
2INSEFlM, U973, F—75205 Paris, France and 8Univ Paris Diderot, Ressources Parisiennes de Bioinformatique Structurale,

F—75205 Paris, France

Associate Editor: Anna Tramontano

 

ABSTRACT

Motivation: Meaningful scores to assess protein structure similarity
are essential to decipher protein structure and sequence evolution.
The mining of the increasing number of protein structures requires
fast and accurate similarity measures with statistical significance.
Whereas numerous approaches have been proposed for protein
domains as a whole, the focus is progressively moving to a more
local level of structure analysis for which similarity measurement still
remains without any satisfactory answer.

Results: We introduce a new score based on Binet—Cauchy kernel. It
is normalized and bounded between 1—maximal similarity that implies
exactly the same conformations for protein fragments—and —1—
mirror image conformations, the unrelated conformations having a
null mean score. This allows for the search of both similar and mirror
conformations. In addition, such score addresses two major issue of
the widely used root mean square deviation (RMSD). First, it achieves
length independent statistics even for short fragments. Second, it
shows better performance in the discrimination of medium range
RMSD values. Being simpler and faster to compute than the RMSD,
it also provides the means for large-scale mining of protein structures.
Availability and implementation: The computer software imple-
menting the score is available at http://bioserv.rpbs.univ-paris-
diderot.fr/BCscore/

Contact: frederic.guyon@univ-paris-diderot.fr

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on May 17, 2013; revised on October 18, 2013; accepted on
October 22, 2013

1 INTRODUCTION

When analyzing biological processes, similarity measures and
statistical signiﬁcance are one of the major means we have to
establish relationships and infer models underlying observations.
In the ﬁeld of protein structure, the matter of quantifying simi-
larity between two structures is a long standing objective, as it is
an essential key to decipher protein sequence—structure—function
relationships and further to classify them.

Protein similarity search can be performed at a global and a
local level. Whole structure comparisons provide general infor-
mation about protein classiﬁcation and protein functions. At a

 

*To whom correspondence should be addressed.

more local level, fragment comparison and identiﬁcation has
become a key step for protein structure analysis, annotation
and modeling. Fragment similarities reveal functionally import-
ant residues (Tendulkar et al., 2010), similar structural motifs
may indicate function preservation in remote homologs
(Manikandan et al., 2008), and more generally, recurring frag-
ments may be used as building blocks to the construction of de
novo models of protein structures (Bystroff et al., 1996; Friedberg
and Godzik, 2005; Samson and Levitt, 2009; Unger et al., 1989).

Scores used to quantify the 3D similarity are essential compo-
nents at both global and local levels. A considerable amount of
approaches has been developed for complete protein compari-
sons such as SSAP (Orengo and Taylor, 1996), DALI (Holm and
Sander, 1995), CE (Shindyalov and Bourne, 1998),
MAMMOTH (Ortiz et al., 2002) or TM-align (Zhang and
Skolnick, 2005) to cite some. However, progress in modeling
and in the analysis of the signiﬁcance of local differences in hom-
ologous proteins stresses the necessity to focus on smaller struc-
ture sizes. Yet none of the above scores used for structural
alignment seems well adapted to the large-scale comparison of
short protein fragments (Guyon and Tuffery, 2010). First, speed
is of the essence for large-scale structure mining, and structural
alignment may require heavy computations. Second, a crucial
and difﬁcult question remains that of the statistical signiﬁcance
of the scores applied to short fragments.

The root mean square deviation (RMSD) (Coutsias et al., 2004;
Kabsch, 1976, 1978) has been one of the ﬁrst measures intro-
duced. This long used criterion also has well-known ﬁaws,
among which, RMSD dependence on the alignment length, pos-
sibly large values between homologous proteins, and above all, a
poor classiﬁcation performance for medium range RMSD values:
small RMSD values imply correct similarity, but large RMSD
values can hardly be related or not to the absence of similarity.
Numerous studies have attempted to overcome these limitations
such as Betancourt and Skolnick (2001), Carugo and Pongor
(2001), Chew et al. (1999), Kedem et a]. (1999), Maiorov and
Crippen (1995) and many others since. Among these, the unit-
Vector RMS distance (URMS) (Chew et al., 1999; Kedem et al.,
1999) has been reported to be rather length independent and in-
sensitive to local structural dissimilarities for sufﬁciently long
structures. The TM-score (Zhang and Skolnick, 2004) has been
designed to be rather insensitive to small structural deviations. It
is also normalized to be length insensitive, but its design was
clearly focusing on sufﬁciently large proteins (>80 amino acids).

 

784 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /§.IO'SIBU.IT10[p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Fast protein fragment similarity scoring

 

Here, we introduce a new, fast and accurate scoring scheme
for fragment mining. Contrarily to the RMSD, fragment super-
imposition is not required. This new measure is based on a
Binet—Cauchy kernel (BC score). This kernel has already been
applied in unrelated context, in particular to the difﬁcult problem
of clustering Video sequences and to the discrimination of an
individual or a group of individuals in a Video sequence (\Nolf
and Shashua, 2003; Vishwanathan and Smola, 2004).

In the context of protein structure comparison, the BC score
can be seen as a shape similarity score corresponding to a correl-
ation score between fragment shapes. Hence it is normalized and
its values range from —1 measuring perfect shape anti-similarity
(one fragment is the mirror image of the second one) to l indicat-
ing perfect similarity (up to a linear deformation). The BC score
has several interesting properties. In particular, it is independent
to any rotation of the structures and consequently its computa-
tion does not involve a prior superimposition of the structures.
It is also fast and simple to compute—the score only requires
the computation of 3 x 3 matrix determinants. Therefore, it is
especially well adapted to perform large-scale protein mining
and is designed to compare short protein fragments.

In this article, we simply assess a new gapless approach of
structure similarity and we do not study the optimal structural
alignment based on the BC score. After introducing the principle
of the BC kernel, we review some of its important mathematical
properties. We then present a statistical analysis of the scores and
we ﬁnally assess the sensitivity and speciﬁcity in the context of
large-scale fragment mining with a comparison with the RMSD.
We also apply the BC score to symmetry detection in proteins.

2 METHODS
2.1 RMSD calculation and Kabsch formula

To introduce mathematical notations, we brieﬂy recall well-known facts
about RMSD calculation. Given two sets of aligned atoms, their super-
imposition consists in computing the optimal rigid body translation and
rotation, which moves one set of atoms onto the second one minimizing
the sum of squared Euclidean distances between them.

The two sets of atom coordinates are represented by two N X 3 matri-
ces X and Y, with X ,1- (respectively, Yij) denoting the jth coordinate of the
ith atom. The coordinate deviation is 1 2le (X i]- — Yij)2 or using the
Frobenius norm of matrices ||X — Y||2. The ﬁrst step of the superimpos-
ition consists in centering the two structures. After this translation,
we have: 2]. Xi]- = Z]. Yij = 0 for all 1,1 5 is 3. In the following, all
coordinate matrices are centered. Next step is to ﬁnd the rotation
matrix that minimizes

min ||XR — Y||2 (1)
R rotation matrix
Mathematically, a rotation matrix is characterized by RTR = Id and
det(R) = 1, and then the RMSD is given by

1
RMSD(X, Y) = ,lNIIXR — Yll2

Many algorithms have been proposed in the past to solve this problem.
The solution of Kabsch (1976) and Kabsch (1978) can be formulated
as follows:

1
RMSD2(X, Y) = NGIXllz + II Yllz — 2(S01+ 02 + 03)) (2)

where a, are the three singular values of the 3 x 3 matrix XTY with
0 5 01 5 02 5 03 and S is the sign of the determinant of XT Y.

Interestingly enough, we show in this article that beside the sign of the
determinant, its value itself is meaningful. We prove in the following that
the det-function is a kernel function and can be used as a fast and
accurate score to compare protein structures.

2.2 The Cauchy—Binet scores
We call a multi—index a m—tuple of m elements from {1, ...,N}. Multi-
indices are ordered in lexicographic order: S = (i1, i2, ..., im) with
15 i1<i2<  <im g N.

The Binet—Cauchy identity states that for two matrices X, Y 6 Wm",
with m 5 n, we have

det(XTY) = Z det(XS) det(YS) (3)

S/|S|=m

where the sum is over all multi-indices of m elements. X S is the submatrix
of X constructed by choosing columns of indices in S.

Suppose matrices X and Y are represented by the vector of ( )
components indexed by S called the Grassman vector:

(1)005 = d€t(Xs)

With such a representation, the Binet—Cauchy theorem prove that
the determinant in (3) can be expressed as a inner product between

we and ¢(Y)-
det(XT Y) = ¢<X)T¢(Y) (4)

Otherwise stated, this proves that the measure det(XTY) is a positive
semideﬁnite kernel denoted K(X, Y). The function <1) maps X to a high
dimensional vector space named feature space such that BC is the usual

Euclidean scalar product in this space of dimension 
As X refers to protein structures, space dimension is m=3. Hence,
Grassman vector ¢(X) has  = W components. Each com-

ponent of ¢(X) indexed by S is the signed volume of the parallelepiped
formed/deﬁned by the triplet S of atoms and point (0,0,0). This volume is
six times the volume of tetrahedron formed by the same four vertices
(Fig. 1). The size of the Grassman vector increases rapidly with the length

of the fragment it represents (for N220, we have  = 1140 and

(630) = 34220. The BC kernel permits to compute a scalar product

 

46
3
built from C-oz of residues number 2, 9, 22 and center of all C-oz 0. Its

Fig. 1. One of the > = 15180 tetrahedrons of the domain d1a62a1

(signed) volume is given by %det(X) where X is a 3 X 3 matrix containing
the x,y,z coordinates of the three C-oz

 

785

112 /810'S[12umo [pJOJXO'SOIJBIHJO}LIIOIQ//Idllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

F.Guyon and P. Tufféry

 

between such big vectors with a small amount of basic operations as it
reduces to the calculation of a 3 X 3 matrix determinant.

2.3 Structural BC score derived from BC kernel

We only consider the coordinates of the a-carbon atoms of the protein
fragments. The coordinates of the N residue fragments to be compared
are stored in N X 3 matrices X and Y. The coordinate matrices are
centered at the origin. We propose a structural score derived from the
Binet—Cauchy kernel. This score, we named Binet—Cauchy score is
the cosine between the Grassman vectors of X and Y

det(XT Y)
./ det(XTX) det( YT Y)

The calculation is possible only if the numerator is not equal to 0. This
occurs when one of two matrices X or Yis not full rank, which is equiva-
lent to state that one of the two fragments is absolutely ﬂat. This never
occurs in practice with protein fragments.

A second normalization of the BC kernel can also be considered:

2 det(XT Y)
det(XTX) + det( YT Y)

BC(X, Y) = (5)

 

BC2 (X 9 Y) = (6)

As the geometric mean is always less than the arithmetic mean, we always
have BC (X, Y) 5 BC2 (X, Y). In the following, we focus on the ﬁrst form
of the BC score.

2.4 Mathematical properties of the Binet—Cauchy kernel

Here, we list some simple but important properties of the BC kernels.
2.4.] The BC score is rotation independent For a rotation matrix
R, we have det(R) = 1. From the deﬁnition, it is clear that

BC(X, YR): BC(X, Y)

It means that it is not necessary to compute a rotation matrix to optimally
superimpose the two structures and compute the score.

2.4.2 The BC score is a correlation coejﬁcient
¢<X)T¢(Y)
||¢(X)||-||¢(Y)||

The BC score is a cosine or a Pearson’s correlation between the Grassman
representation of X and Y. Therefore, we have

—1§BC(X,Y)§1 (8)

BC (X, Y) = (7)

2.4.3 The BC score is a ﬂexible score The BC scores are maximum
for identical structures.

RMSD (X, Y) = 0 => BC (X, Y) :1 (9)

If X and Y can be exactly superimposed, then it exists a rotation matrix
such that Y: X R. Because det(R) = 1, we have BC (X, Y) = 1. However,
the reciprocal statement is not true. It is possible that BC (X, Y) = 1 for
two different fragment conformations with RMSD (X, Y)>0. The BC
score is independent to any linear transformation with a positive
determinant.

BC(X, YA) = BC (X, Y) (10)

In particular, BC (X, XA) 2 BC (X,X) = 1 where A is a 3 X 3 matrix A
with det(A) > 0.

Nonetheless, in large mining experiments, the BC score shows weak
sensitivity to protein fragment deformations. Therefore, it can be efﬁ-
ciently used to search for fragments in structure databases with a certain
amount of ﬂexibility. In next paragraph, we describe a mean to control

that amount of ﬂexiblity (See mathematical details in Supplementary
Materials).

2.5 Tuning ﬂexibility with distance constraints

We denote X ,- (respectively, Y,-) the coordinates of the ith (respectively, jth)
C0, of the fragment X (respectively, Y) of length N. The rate of
deformation between the two structures is
H/Yill — HYill
defR“ Y) _ insi’l‘vimii + llYill
The rate of deformation compares the maximum variation of intra-
distances between two residues distant of l residue.
It is also possible to reinforce the control over the opening of the
fragment with

 

defI{/(Xv9 1]) :maX{defR(X’ Y),  —  

IIXN—X1||+||YN— Yill

It can be veriﬁed that if BC (X, Y) = 1 and defR (X, Y) = 0 then X can be
exactly superimposed on Y and RMSD (X, Y) = 0.

The rate of deformation is used to control the admissible deformation
between X and Y for a given value of BC.

2.6 BC distribution and Pareto distribution approximation

The distribution of the BC scores between two random fragments is
equivalent to the distribution of the determinant of a random matrix.
Except in special cases (distribution of a normal random matrices), it is
difﬁcult to derive a closed form of this distribution. Nevertheless, an
accurate approximation of the tail of the distribution function is provided
by the Pickands—Balkema—de Haan theorem (Balkema and de Haan,
1974; Pickands, 1975). The distribution of largest values of similarity
scores, for example alignment scores, is widely used to assess the score
signiﬁcance for protein sequence or structure mining. The usual approach
is based on extreme value distributions given by the Fisher—Tippett—
Gnedenko theorem. Here, we are more interested in all the values
above a given threshold and not only on the maximal value of the
score. The reason is that considering only the best score, we lose a lot
of information given by all the good scores. A second theorem in extreme
value theory, named Pickands—Balkema—de Haan theorem gives the dis-
tribution of values above a given threshold called the exceedances. This
theorem says that for a large class of score distribution, for a sufﬁciently
high threshold, the distribution of the exceedances approximately follows
with a good approximation a generalized Pareto distribution. To deter-
mine theoretical statistical properties of the BC scores, we generated
random structures. In Shibuya (2010), a freely jointed chain model is
used to assess complexity of fast RMSD searches of proteins structures.
This model is random walk model where each step between two succes-
sive atoms has a ﬁxed length and is a random vector independent from all
other steps. This simple model is used to model polymers (De Gennes,
1979). To have a more realistic representation of structural fragments, we
generated each random fragments from a real fragment by randomly
perrnuting its inter C0, intervals and reconstructing the fragment as a
random walk. Hence, the inter Co, distances and angle distribution cor-
responds to real fragment structures. Depending on the selected struc-
tures and on the fragment lengths, the number of comparisons could
exceed 107 per fragment length. For each length, 105 fragment compari-
sons have been randomly sampled and their distribution parameters have
been estimated. Parameter averages and standard deviations over 103
samplings have been computed and appear stable relatively to the
sampling process (not shown). The distribution function depends on
two parameters: the scale a and shape k. The ﬁt of a generalized
Pareto model to the observed BC scores has been obtained with the
R package evir using a maximum likelihood method (Pfaff and
McNeil, 2012).

 

786

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Fast protein fragment similarity scoring

 

2.7 Data
All computations have been performed on protein domains provided by
Astral-1.75 database with <70% sequence identity (release June 2009).

To derive statistics about the BC score distribution, a representative-
selected subset of 64 Astral-1.75 domains have been randomly sampled
consisting of 16 structures per main SCOP classes (alpha, beta, alpha/beta
and alpha+beta proteins). An all-against-all fragment comparison has
been performed for fragment of 20, 30, 40, 50 and 60 residues, and the
BC deformation scores and RMSD have been computed for each
fragment pair.

Finally, CASPlO target domains and models were downloaded from
http://www.predictioncenter.org/casp10/. We used target/model pairs
for 36 domains for which the experimental model has no missing residue,
13 free modeling and 23 template-based modeling (TBM and TMB-hard)
domains. Only the models generated by servers were considered. We
calculated the corresponding GDT_TS and TM-scores using the
TMscore program (Zhang and Skolnick, 2004).

3 RESULTS
3.1 Comparison of RMSD and BC scores

Figure 2 represents the RMSD values versus the BC scores
obtained from the comparisons of a fragment d3hxva_ (residues
5—25) against a representative subset of 1158 domains of Astral-
l.75. This subset consists in three structures per SCOP family.
Only family from classes a, b, c and d (alpha, beta, alpha/beta
and alpha+beta proteins) are considered.

BC scores and RMSD are not well correlated with a Pearson
correlation ,0 equals to —0.l46. The correlation is, however,
stronger for low RMSDs. For instance, for RMSD g 3,
p: —0.7 and all pairs with RMSD <2A show a BC score
over 0.6. However, the reverse is not true. Pairs of fragments
with high BC scores present a large range of RMSDs from low
to relatively high RMSDs (>4 A). Remember the BC score is
invariant under linear transformation, and thus a measure of
the amount of fragment ﬂexibility induced by linear or nearly
linear transformations [or distorsion score - see Equation (10)] is
necessary. Using a maximum deformation score of 0.4—black
dots of Figure 2—one observes a shift of the distribution toward
low RMSDs, mostly for BC scores in the medium range of
values. However, this bracketing of the deformation still corres-
ponds to rather large RMSD, even for BC scores of 0.8.

Strong BC scores indicate that the global fragment shapes are
conserved but can be locally distorted (case B compared with A).
For instance, looking at fragments B and C, B presents a much
higher BC score for an approximately equivalent RMSD. The
reason is that its shape is better correlated to the query as both
fragment ends can be perfectly aligned with the query terminus.

Lower absolute values of the BC score imply medium to high
RMSDs. They indicate a lack of shape similarity (case F) even for
low RMSD values (case E). Finally, negative scores, close to —1,
occur for mirror similarities, when one fragment is close to the
mirror image of the second one (case G). The fragments corres-
ponding (case G) have been superimposed by RMSD minimiza-
tion and yet do not properly render the mirror symmetry. In that
example, the helix part is shifted by a half helix turn relatively to
the other one. When the two helix parts are superimposed, the
fragments are then rotated by 90 degrees and the symmetry be-
comes clear (Fig. 2G). Interestingly, the occurrences for largely

negative values are much less than for positive values, indicating
the mirror conformations are much less observed in protein
structures.

Also, the examples D, E, F and G illustrate that medium-
range RMSDs do not imply signiﬁcant conformation similarity.
On the contrary, the BC score more precisely characterizes global
shape similarity and combined with distortion rate allows for
discriminating between spurious and true fragment 3D similarity.

3.2 Comparison of DALI and distance deviation scores
versus BC scores

We also performed large-scale comparison based on the DALI
elastic similarity score (Holm and Sander, 1995), which is a well
known and used score based on distance matrices of the frag-
ments. As shown in Figure 2, relatively to the BC score, the
DALI score and the RMSD tend to behave in a similar way:
they are insensitive to local deformations and mostly sensitive
to global one (see points A, B, G). Internal distances are

 

 

 

 

 

i
_ . E .
p.
g g. 9 c.
H H E
:- — . -E
l3 l5
2 a I I I? 1 w u an n- N 40 m
amt: mm
A  .5 B C ..
i l? .
.I' r
." J .I' __."_"-_.-
1. 11L n' II
1 'I
:~. I ..J
./ H— ' “.'--,_
II J "" - .
I
I. 'J -
16-"— ‘HIIIII I Hana-uh M

 

a
"51

Fig. 2. Representation of 145 000 fragment comparisons of d3hxva_
Astral entry residues 5—25 against the 64 protein representative set. Top
plots represent BC score versus the RMSD and the EDALI score.
Query:d3hxva_ from 5 to 25; (A) d1wr8a_ from 21 to 41, rmsd=0.79,
BC: 0.92, defR: 0.057; (B) dlovmal from 15 to 35, rmsd= 2.52, BC:
0.91, defR=0.50; (C) d100xa_ from 38 to 58, rmsd= 1.85, BC=0.49,
defR=0.33; (D) d1s3sg_ from 63 to 83, rmsd= 3.98, BC=0.49, defR:
0.50; (E,E’) dlzzkal from 20 to 40, rrnsd = 2.91, BC 2 0.0024, defR = 0.50;
(F) d2o8la1 from 93 to 113, rmsd=5.61, BC=0.015, defR=0.72; (G,G’)
d16pka_ from 316 to 336, rmsd=4.092, BC: —0.80, defR: 0.7

 

 

787

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

F.Guyon and P. Tufféry

 

insensitive to mirror conﬁgurations as distances between residues
are preserved in reﬂected images. Therefore, by construction the
DALI score is blind to mirror transformations. Such local mirror
transformations can be observed at a local level where they indi-
cate opposed side-chain orientations, which may imply important
changes for protein function. Similar results—not shown—could
be observed for the rate of deformation defR that is also a meas-
ure based on intra-distance distortions. On the contrary, the BC is
sensitive to small deviations causing local mirror conﬁgurations
as they change determinant signs in the BC formulation. The BC
score is not changed by linear transformations. Even if real pro-
tein fragment distortions are not linear, it is less sensitive to large
deviations implied by fragment stretching and bending.

3.3 BC scoring of CASP10 models

To further illustrate BC scoring properties, we have also investi-
gated its behavior for comparing CASP10 models with the
experimental conformations. Figure 3A and B show average

 

 

Ac! . fa". B CI! ____.-*
1- fifr' 1- . rip-
ff xxx
“1 . a H1! _ xx '. .
G {If G ’34-".
a: a” m x"; -
*- ﬁ’ ‘- ,3"
ES  g3 30"”  -
E f E r"
if
m. m.
G G '
I I
C! a.
' 0.0 02 04 0.0 0:12 1:0 ' 0:0 0:2 0:4 013 0.3 10
Manure GUT scare
‘3 o
.,_
+
4"+
u} _ + +
C)
E
3 '4
D
“:5 '
III
Ln
D T
|
1_ _
|

 

 

0.0 0.2 014 016 0.8 1.0
TMscore

Fig. 3. (A and B): Correlation of BC score with TM-score (A) and
GDT_TS (B). Plots show mean scores of the submitted models for each
CASP10 targets. (C) Plot of scores for the models of 10 TBM targets. Dark
points correspond to hits with RMSD <5 A. 1: T0664d1/PconsM_TS4,
rmsd = 2.549, BC 2 0.978, 0.9424, Len = 498; 2: T0756d1/UGACSBL_
TS1, rmsd = 3.72, BC 2 0.81, TM 2 0.71, Len = 91; 3: T0756d1/Phyre2_
A_TS3, rmsd = 5.32, BC 2 0.56, TM 2 0.70, Len = 91; 4: T0756d1/
AOBA-server_TS2, rmsd = 9.39, BC 2 0.14, TM 2 0.72, Len = 91; 5:
T0743d1/BAKER-ROSETTASERVER_TS5, rmsd = 4.51, BC 2 0.69,
TM 2 0.73, Len = 114; 6: T0743d1/Zhang-Server_TS2, rmsd = 5.99,
BC 2 0.70, TM 2 0.46, Len = 114

scores between all the predicted models submitted for CASP10
and their corresponding target. Overall, the BC score is well cor-
related with the TM-score and GDT_TS with a Pearson
correlation score of 0.93 and 0.86. Figure 3 depicts more in
detail the relationship between the BC—score and the TM-score.
For sake of clarity, the data is only plotted for all the models of 10
TBM domains. It is clear that high BC scores correlate perfectly
with high TM scores (Fig. 3A). Differences in scoring arise for
medium range values. As examples, three models (Fig. 3 labels 2,
3, 4) of target T0756dl have a good identical TM-score
(TM 2 0.71) but present a decreasing BC score from high
(BC 2 0.812) to non-signiﬁcant (BC 2 0.143). Here, the BC score
is in agreement with an increasing RMSD from 3 .72 to 9.40  The
reason is that the TM-score is not penalized by locally discordant
regions which in that case deteriorate the global shape of the
model. In that case, poor modeling of the extremities of the two
models B and C explained the higher RMSD and lower BC score.
The same conclusions stand for the comparison of the GDT_TS
and BC score. The BC score is a measure of global shape similar-
ity. Localized structural discrepancies may deteriorate the scoring
of a good model presenting a strong accuracy in important region
of the protein. This shows that the BC score applied on complete
models is not sufﬁcient to assess the quality of a protein structural
model, but its adaptation for model comparison is out of the scope
of the present study. On the contrary, models with a correct global
shape but with local structure mismatches can have a signiﬁcant
BC score with lower TM scores or GDT_TS as BC is insensitive to
local deformations. Cases depicted with labels 5, 6 in Figure 3
presents such a situation where the two models with an identical
BC score (0.70) have a high and a medium (TM 2 0.74 and
TM 2 0.46) TM-score. The two models present local differences
revealed by the TM-score (illustrated in Supplementary Material
Fig. S1).

3.4 Distribution of simulated fragments for different
lengths

We now turn to the distribution of BC scores. Figure 4 and
Supplementary Table S1 report the distributions obtained for
random fragments obtained by a chain model, and for real frag-
ments with no rearrangements. For random fragments (Fig. 4A),
BC score densities are almost exactly identical and independent
of the fragment lengths. Considering real fragments with no re-
arrangements (Fig. 4B) one observes density shapes vary accord-
ing to fragment length. However, the average and standard
deviations remain remarkably independent on fragment length
and the density tails and the exceedance probability distributions
modeled by a generalized Pareto distribution also converge rap-
idly to a limit distribution with parameters almost independent
of the fragment length (Supplementary Material Table S2).
Such length independent behavior can be compared with
that of the RMSD. On the exact same set, RMSD distribution
(Fig. 4C) is clearly varying depending on fragment length.
Another structural distance—URMS—considering ‘difference’
vectors between successive a-carbon instead of the position
vectors of atoms has been proposed by Chew et al. (1999) and
Kedem et al. (1999). It shows a better length invariance property
compared with RMSD. For sufﬁciently long structures, the
URMS is length independent and rather insensitive to local

 

788

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Fast protein fragment similarity scoring

 

A BE nrubafﬂlt'rdmsﬂfus Ian ulrnul-ntvld tuna-H1 B BE mm prob-all":- “rallies
. O
T 04:20 am m; ha=2LI aa
01-30 am 5', NrCiI'I an
Phi-4|] :13 E: In _ iii-4|] :13
m 01-50 aa :' 'i N liq-5|] as
' _ . ' i __ .
N—EILI aa  5- G lH—bU aa
r -_ ' '
5a“ .5  r“ I
E m -   Em- - '
'1' r' '2 '3"- '1.
E I; ‘2 ﬂ I'-I
_.- '- D. . 0.
. 1. I .
1— ' ‘lll. 
.I’ "-.. m
.h'  .
D . . . . 1:: . . . . . .
—D.E 13.13 13.5 —l.|'.'l —CI 5 DAD 0.5 1.0
Ell: score Eli: score
0 URHE :ILnranohnhlllhdiI-dlth D HMS-Horn prob-Hill; dh‘mII-il
N-20 .‘Ju : ;
hill-3U aa 1. :
N=4U aa 2 ;
ED - N—sn :Ia
N-EIJ :13
3-1
7‘:
U) 'lT-l' I
I:
II
a
m .
a I . ...- ._._ -
DE 13.8 1.1} 1.2 1.4 - -.
URMS m

Fig. 4. Probability densities of BC score, RMSD and URMS for
different fragment lengths (from 20 aa to 60 aa). These densities are
computed over random fragments following the chain model (A) and
over all real fragments of the representative set of 64 protein domains
from Astral-1.75 databank (B—D)

structural dissimilarities. However, probability density conver-
gence appears in practice for structure length >80 residues,
which is sufﬁcient for comparing whole protein models but
not for short fragments, for which the BC score appears much
more stable.

3.5 Test cases

We further illustrate the behavior of the BC score in two
different contexts.

3.5 .1 Chitin binding domains We ﬁrst illustrate the behavior of
the BC score by mining a chitin binding motif, which is a func-
tional motif found across plants, insects and animals. Suetake
et al. (2000) have highlighted a structural similarity between
motifs in tachycitin, an invertebrate chitin binding protein
(PDB:1dqc, residues 40—60) and hevein, a protein of the
rubber-tree (PDB lhev, residues 12—32). Using the HHsuite
sequence alignment facility (Remmert et al., 2012), no similarity
can be detected between the sequences of tachycitin and hevein.

The RMSD and the BC score between the two fragments are
of 3.05A and 0.63, respectively. The value of 0.63 is associated
with a P—value of 210—3, i.e. a low signiﬁcance. We have per-
formed a search for similar fragments mining the Astral-1.75
subset at 70% sequence identity, not including ldqc nor lhev.
The search using lhev as seed happens to be an easy case, best
hits having an RMSD <1A and BC scores >0.97. Searching
fragments similar to ldqc is more challenging and Figure 5 illus-
trates how the BC and defR scores can perform compared with
the RMSD. We discuss only the matches having a BC score
value >0.63 or a RMSD <3.05 A. In all, 126 matches have an
RMSD <3.05 A from the ldqc: 40—60 fragment. Their BC scores

UH

HEscure

 

 

 

 

Fig. 5. Search for fragments similar to the tachycitin chitin binding motif
(PDB:1dqc, residues 40—60). (A) Matches having RMSD <3.05 A or BC
score >0.63 are detailed. Dots, dark crosses, light crosses: matches having
defR values <0.3, between 0.3 and 0.4, >0.4, respectively. Green and cyan
dots: structures depicted in (B, C and E), respectively. Magenta crosses:
structures depicted in (D). Red dots: structures annotated with the chitin
key word in Uniprot. B—E: The query structure PDB 1dqc:40—60 is
depicted in dark gray. (B) Structures having both low RMSD (<3.05)
and large BC score (>0.63). (C) Structures having both large RMSD
(>3.05) and BC score values. (D) Structures having large BC scores
and large defR values (>0.4, magenta crosses in A). (E) Structures
having both low RMSD and low BC score values

range from 0.3 to over 0.8. Figure 5B depicts three matches
having both a low RMSD and a high BC score and Figure 5E
two matches having a low RMSD and a lower BC score between
0.3 and 0.4. These matches mostly differ in their beta hairin
conformation, which the BC score is able to discriminate.
Conversely, 110 matches have a BC score of > 0.63. They include
conformations having RMSD values up to 5A, and the add-
itional use of the defR can be used to prune these matches.
Figure 5B depicts two matches having a beta hairpin conform-
ation similar to the one of ldqc, but stretched. These two
matches have an RMSD >3.05A (3.3 and 4A), a BC score
>0.63 and a defR <0.3—i.e. a low deformation rate, which
highlights the ﬂexibility of the BC score. Figure 5D shows two

 

789

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

F.Guyon and P. Tufféry

 

conformations of both large BC score and low RMSD values,
for which the defR value is > 0.4. They have a beta hairpin
conformation similar to that of the query, but differ in their
extremities. Overall, such example illustrates that the combin-
ation BC score-defR allows a ﬁne tuning of the conformational
search. Interestingly, selecting the matches having a BC>0.63
and a defR <0.3 reduces the matches to only 17, among
which 6—red dots, 2 are overlapping —have a chitin binding
annotation in the Uniprot database (TheUniProtConsortium,
2012), and none of the matches rejected by the defR has such
annotation.

We have also considered using the TM-score, which depends
on several parameters that are tuned to assess longer structural
alignments. Not surprisingly, as is, the use of TM-score for frag-
ment mining is inadequate and results in a lack of precision. For
instance, the TM-score between the two queries ldqc and lhev is
0.1982. Mining of the Astral-1.75 using TM-score with this value
as threshold, 837 329 fragments has been retrieved.

3.5.2 Mirror conformations A second example illustrates the
possibility to search for mirror conformations. Novotny and
Kleywegt (2005) have shown that even though left-handed heli-
ces are rare, they occur in protein structures and are important
for the stability of the protein, for ligand binding, or as part
of the active site. When they do occur, they are structurally or
functionally signiﬁcant. We have performed the search for such
left-handed helices over the collection of structures presented
by Novotny and Kleywegt (2005), using as seed a right-handed
helix fragment of Astral entry dlor4a at position 125. The left-
handed helices identiﬁed by Novotny and Kleywegt (2005) have
an average BC score of —0.96, with one outlier value of 0.81
for 1h21 chain A for which the left helix had a shorter shape.
Interestingly, we also ﬁnd that for one protein (PDB 1bnl
chain A) another region had a propensity for left-handed helix
with score on the same order, although not as helical. This

 

 1 _ JAVA
- ...,:- .0
Fig. 6. Mirror similarities. (A) Left-handed fragments identiﬁed using a
right-handed helical fragment as seed (green). (B) 1an entry. Red: left-
handed helix identiﬁed in Novotny and Kleywegt (2005). Yellow: identi-
ﬁed fragment with a largely negative BC score of —0.96. (C) Left-handed

helices identiﬁed in the human notchl protein (PDB:3eto). (D) WW
motifs with a twist opposite to that of the 2zaj 17—40 fragment

 

region, although far in the sequence, is close to that displaying
the left-handed helix previously identiﬁed (Fig. 6). Extending the
search to larger collections, we could identify 269 and 368 struc-
tures displaying such left-handed propensities in the Astral 70
and PDB 70 collections, respectively. Some of them, such as
notchl and 2 had up to three left-handed helices.

Interestingly as well, the search for mirror conformations
can also be performed for any shape. Figure 6D shows for
instance the BC kernel can identify negative BC scoring frag-
ments using as seed the three-stranded beta sheet of PDB 2zaj
fragment l7—40. Note the scores of the three matches depicted
(dldyka2z4l-64, d2b79alz36-59, dluaia_:ll4—l37) are, however,
on the order of —0.65 to —0.70, i.e. much less signiﬁcant than
those of left-handed helices.

These two examples highlight that the BC score can be used to
quickly mine collections of structure to search for mirror con-
formations, such possibility has to our knowledge no equivalent
so far.

4 COMPUTATIONAL COST

Finally, we have compared the execution times for mining frag-
ments of length 10 using RMSD and BC score. The BC mining
is >50 times faster than the same search using RMSD. To mine
the complete Astral 1.75 subset at 70% sequence identity, typical
execution times are on the order of 7 s on an Intel Xeon(R) CPU
E5506 at 2.13GHz using four cores.

5 DISCUSSION AND CONCLUSIONS

In the present study, we have introduced the BC score, a new,
fast and efﬁcient scoring approach of protein fragment similarity.
We have shown that its inherent geometric properties make it
possible to control the ﬁne tuning of the level of similarity, with
the limit that being invariant on linear transformation, a control
over the accepted deformation rate is required. Our tests show,
however, that a typical maximal value of 0.3 for the deformation
rate can be used as default. Accepting it, the BC score comes
with two interesting features compared with the RMSD and its
derivatives. First, its size independence property has so far only
been addressed for long fragments. Our results show that the BC
score reaches size independence even for short size (10—50 amino
acids). This independence property allows for a simple estimation
of a P—value based on exceedance value distribution. Second, we
have also illustrated for remote homologs that the BC score
makes it possible to identify fragments globally distorted, being
not too sensitive to local structural changes. This results in the
identiﬁcation of relevant hits at larger RMSD. The generality of
this behavior is, however, difﬁcult to assess, although large-scale
fragment comparisons such as that of Figure 2 clearly shows the
BC score is able to assign high scores to fragments with large
RMSD. Finally, the BC score also deﬁnes a meaning for the
lower bound limit that corresponds to mirror conformations.
As illustrated for left-handed helices, this makes simple the
search for particular such conformations.

A major limit of the application presented here is its gapless
property. In our experience, this can lead to sliding matches
along a protein when performing systematic searches. Gap intro-
duction, however, could be performed in the context of dynamics

 

790

112 /810'S[12umo proJIxo'soi112u1101uioiq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Fast protein fragment similarity scoring

 

programming even if the objective function derived from the BC
score is not additive. These promising applications are the subject
of further work. It remains that the BC score performs particu-
larly well for gapless similarity search, and it is particularly
fast compared with previously proposed scores because it does
not require any superimposition, relying only on the calculation
of 3 X 3 determinants. The weak computational cost of the BC
score clearly opens the door to systematic large-scale analyses.

Funding: INSERM UMR—S973 recurrent funding and the
BIP:BIP project ,“Investissement d’Avenir” ANR grant.

Conﬂict of Interest: none declared

REFERENCES

Balkema,A. and de Haan,L. (1974) Residual life time at great age. Ann. Probab, 2,
792—804.

Betancourt,M.R. and Skolnick,J. (2001) Universal similarity measure for comparing
protein structures. Biopolymers, 59, 305—309.

Bystroff,C. et al. (1996) Local sequence-structure correlations in proteins.
Curr. Opin. Biotechnol, 7, 417—421.
Carugo,O. and Pongor,S. (2001) A normalized root-mean—square distance for
comparing protein three-dimensional structures. Protein Sci, 10, 1470—1473.
Chew,L. et al. (1999) Fast detection of common geometric substructure in proteins.
J. Comput. Biol., 6, 313—325.

Coutsias,E. et al. (2004) Using quaternions to calculate RMSD. J. Comput. Chem.,
25, 1849—1857.

De Gennes,P.G. (1979) Scaling Concepts in Polymer Physics. Cornell University
Press, Ithaca, NY.

Friedberg,I. and Godzik,A. (2005) Connecting the protein structure universe by
using sparse recurring fragments. Structure, 13, 1213—1224.

Guyon,F. and Tuffery,P. (2010) Assessing 3D scores for protein structure fragment
mining. Open Access Bioinformatics, 2, 67—77.

Holm,L. and Sander,C. (1995) Dali: a network tool for protein structure compari-
son. Trends Biochem. Sci., 20, 478—480.

Kabsch,W. (1976) A solution for the best rotation to relate two sets of vectors.
Acta Crystallogr. A, 32, 922—923.

Kabsch,W. (1978) A discussion of the solution for the best rotation to relate two
sets of vectors. Acta Crystall. A, 34, 827—828.

Kedem,K. et al. (1999) Unit-vector RMS (URMS) as a tool to analyze molecular
dynamics trajectories. Proteins, 37, 554—564.

Maiorov,V.N. and Crippen,G.M. (1995) Size-independent comparison of protein
three-dimensional structures. Proteins, 22, 273—283.

Manikandan,K. et al. (2008) Functionally important segments in proteins dissected
using Gene Ontology and geometric clustering of peptide fragments. Genome
Biol., 9, R52.

Novotny,M. and Kleywegt,G.J. (2005) A survey of left-handed helices in protein
structures. J. Mol. Biol., 347, 231—241.

Orengo,C.A. and Taylor,W.R. (1996) SSAP: sequential structure alignment
program for protein structure comparison. Methods Enzymol., 266, 617—635.

Ortiz,A.R. et al. (2002) MAMMOTH (matching molecular models obtained
from theory): an automated method for model comparison. Protein Sci, 11,
2606—2621.

Pfaff,B. and McNeil,A. (2012) evir: Extreme Values in R. R package version 1.7-3.
http://CRAN.R-project.org/package=evir (14 November 2013, date last
accessed).

Pickands,J. (1975) Statistical inference using extreme order statistics. Ann. Stat, 3,
1 19—131.

Remmert,M. et al. (2012) HHblits: lightning-fast iterative protein sequence
searching by HMM-HMM alignment. Nat. Methods, 9, 173—175.

Samson,A.O. and Levitt,M. (2009) Protein segment ﬁnder: an online search engine
for segment motifs in the PDB. Nucleic Acids Res., 37, D224—D228.

Shibuya,T. (2010) Searching protein three-dimensional structures in faster than
linear time. J. Comput. Biol., 17, 593—602.

Shindyalov,I.N. and Bourne,P.E. (1998) Protein structure alignment by
incremental combinatorial extension of the optimum path. Protein Eng, 11,
739—747.

Suetake,T. et al. (2000) Chitin-binding proteins in invertebrates and plants
comprise a common chitin-binding structural motif. J. Biol. Chem., 275,
17929—17932.

Tendulkar,A.V. et al. (2010) FragKB: structural and literature annotation resource
of conserved peptide fragments and residues. PLoS One, 5, 69679.

TheUniProtConsortium. (2012) Reorganizing the protein space at the universal
protein resource (uniprot). Nucleic Acids Res., 40, D7l—D75.

Unger,R. et al. (1989) A 3D building blocks approach to analyzing and predicting
structure of proteins. Proteins, 5, 355—373.

Vishwanathan,S.V.N. and Smola,A.J. (2004) Binet—Cauchy kernels. In: Proceedings
of Neural Information Processing Systems NIPS ’04. Vancouver, Canada.

Wolf,L. and Shashua,A. (2003) Learning over sets using kernel principal angles.
J. Mach. Learn. Res., 4, 913—931.

Zhang,Y. and Skolnick,J. (2004) Scoring function for automated assessment of
protein structure template quality. Proteins, 57, 702—710.

Zhang,Y. and Skolnick,J. (2005) TM-align: a protein structure alignment algorithm
based on the TM-score. Nucleic Acids Res., 33, 2302—2309.

 

791

112 /§JO'S{12umo [pJOJXO'SOIlBIIIJOJUIOIQ/ﬂdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

