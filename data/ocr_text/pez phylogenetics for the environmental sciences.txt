Bioinformatics, 31 (17), 2015, 2888—2890

doi: 10.1093/bioinformatics/btv277

Advance Access Publication Date: 5 May 2015
Applications Note

 

Phylogenetics

pez: phylogenetics for the environmental
sciences

William D. Pearse1'2'3'*, Marc W. Cadotte‘, Jeannine Cavender—Bares‘,

Anthony R. lvess, Caroline M. Tucker6, Steve C. Walker7 and
Matthew R. Helmuss

1Department of Ecology, Evolution, and Behavior, University of Minnesota, Saint Paul, MN, USA, 2Department of
Biology, McGill University, Montréal, QC, Canada, 3Département des Sciences Biologiques, Université du Ouébec
a Montréal, Succursale Centre-ville, Montréal, QC, Canada, 4Department of Biological Sciences, University of
Toronto Scarborough, Scarborough, ON, Canada, 5Department of Zoology, University of Wisconsin, Madison, WI,
USA, 6Department of Ecology and Evolutionary Biology, University of Colorado, Boulder, CO, USA, 7Department of
Mathematics and Statistics, McMaster University, Hamilton, ON, Canada, and 8Department of Animal Ecology,
Vrije Universiteit, Amsterdam, The Netherlands

*To whom correspondence should be addressed
Associate Editor: David Posada

Received on February 13, 2015; revised on April 7, 2015; accepted on April 25, 2015

Abstract

Summary: pez is an R package that permits measurement, modelling and simulation of phylogen-
etic structure in ecological data. pez contains the first implementation of many methods in R, and
aggregates existing data structures and methods into a single, coherent package.

Availability and implementation: pez is released under the GPL v3 open-source license, available
on the Internet from CRAN (http://cran.r-project.org). The package is under active development,

 

and the authors welcome contributions (see http://github.com/willpearse/pez).

Contact: will.pearse@gmail.com

 

1 Introduction

Community phylogenetics (or eco—phylogenetics) combines ecology
and evolutionary biology, linking ecological phenomena with the evo-
lutionary processes that generate species and their traits (see Webb
et al., 2002). This growing field has produced a number of statistical
tools and software code to implement them (e.g. Kembel et al., 2010),
but this code is disparate and handles data differently, making routine
data analyses challenging. In many cases, published methods are not
formally implemented in a software package and are available only as
supplementary materials to papers. Without active (public) mainten-
ance, these valuable techniques are effectively lost to the scientific
community.

Here, we present the pez R (R Core Team, 2015) package which
provides an intuitive framework that merges existing tools and sup-
ports the development of the next generation of eco-phylogenetic
methods. It is based around an R class (comparative.comm) that

links phylogenetic, community, environmental and trait data in a
single object. With a comparative.comm object, one can presently
calculate over 30 phylogenetic and trait diversity metrics (described
in the documentation for pez.metrics), including more than 10 that
were previously unavailable in R. pez additionally implements statis-
tical models (Cavender—Bares et al., 2004; Ives and Helmus, 2011;
Rafferty and Ives, 2013) to infer the processes that underlie patterns
in community phylogenetic and trait data. Users can also perform
simulations under various community assembly and evolutionary
processes, to help test hypotheses about the structure of biodiversity.

2 Description

2.1 Data manipulation and storage
pez provides a unified class to contain eco-phylogenetic data, and
provides wrapper functions to manipulate the species and site

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2888

9mg ‘09 isnﬁnv uo sereﬁuV socl ‘eruiomeg JO AirSJeAru [1 112 ﬂJO'sreumo[pJOJXO'sopeuJJOJurorq/ﬁdnq moi; popcorn/hog

pez

2889

 

composition of community, trait, environmental and phylogenetic
data. Using the phy.huild family of functions, users can generate
phylogenies for their dataset (making use of methods previously im-
plemented in phyloGenerator; Pearse and Purvis, 2013). pez inte-
grates and makes use of much existing R code (Bortolussi et al.,
2013; Genz et al., 2013; Koenker, 2015; Labierte et al., 2014;
Oksanen et al., 2015; Paradis et al., 2004), and its compara-
tive.comm class is directly compatible with all caper (Orme et al.,
2013) code, easing comparative analysis of species trait data.

2.2 Metrics

Following the classification of Pearse et al. (2014), pez simplifies the
calculation and comparison of over 30 metrics by grouping them
into four categories: shape, evenness, dispersion, and dissimilarity.
Shape metrics measure the structure of a community phylogeny,
while evenness metrics additionally incorporate species abundances.
Dispersion metrics are used to examine whether phylogenetic bio-
diversity in an assemblage differs from the expectation of random
assembly from a given set of species—a species pool. Finally, dis-
similarity metrics measure the pairwise difference in phylogenetic
biodiversity between assemblages. This classification links directly
onto the kind of data the investigator has at hand: assemblage occu-
pancy (shape), assemblage abundance (evenness), source pool
(dispersion) and assemblage comparisons (dissimilarity).

Other packages (notably picante; Kembel et al., 2010) allow
for the calculation of some of the metrics contained within pez. pez
unifies these metrics with other metrics not previously imple-
mented under a common interface that can be extended to trait
and transformed phylogenetic matrices (sensu Letten and
Cornwell, 2015). For example, pez provides the first implementa-
tion of the traitgram framework (Ackerly, 2009; Cadotte et al.,
2010), allowing direct comparison of the extent of phylogenetic
and functional trait community structure. pez also contains a flex-
ible metric estimation and null-model generation suite (the gen-
eric.metric family), that can be used to easily compare different
metrics and perhaps generate new dispersion metrics. New null
models based around species’ trait values (using trait.asm), and ex-
pected mean pairwise phylogenetic and trait distances (using
ConDivSim) can also be simulated. The speed and ease by which
pez allows for the user to compare many metrics is important be-
cause different metrics reveal separate aspects of eco-phylogenetic
structure (Cadotte et al., 2010).

2.3 Statistical models

pez implements the Cavender-Bares et al. (2004) regression frame-
work (fingerprint.regression), and extends it to include more metrics
of trait evolution. While community phylogenetics has been
criticised for relying on the assumption of niche conservatism to ex-
plain ecological assembly (e.g. Mayfield and Levine, 2010), this
early (yet previously unavailable) approach does not rely on niche
conservatism. Instead, it regresses the correlation between species’
trait similarity and observed degree of co-occurrence against sum-
mary statistics of the evolution of those traits. The approach goes
beyond simply describing the phylogenetic or ecological structure of
an assemblage, and instead draws links between how traits have
evolved and how they play-out in their present-day ecological
context.

The pglmm family of functions permit regression modelling of
community (Ives and Helmus, 2011) and interaction network data
(Rafferty and Ives, 2013) using the Phylogenetic Generalised Linear
Mixed Model (PGLMM) framework. PGLMMs permit tests of the

mechanisms that underlie ecological and evolutionary structure in
multiple communities. By fitting random effect terms that account
for phylogenetic and trait co-variance, the user can statistically esti-
mate how likely similar and dissimilar species are to (co-)occur as a
function of their traits, environmental conditions, and the presence
of interacting species.

2.4 Simulations

Hypothesis testing and the development of new eco-phylogenetic
methods require simulation of data under known conditions, and
pez contains functions to facilitate this. The scape family of func-
tions (following Helmus and Ives, 2012) simulate species’ distribu-
tions across environmental gradients. Species’ environmental
tolerances, range size and negative species interactions can be simu-
lated to contain phylogenetic signal and generate patterns of phylo-
genetic structure at different spatial scales. The sim.meta.phy. comm
family of functions simulate phylogeny, trait evolution and assem-
blage structure simultaneously across a landscape. Species’ abun-
dances across the landscape are proportional to the fit of each
species’ trait value to the conditions in each assemblage, and individ-
uals migrate at random across the landscape. The sim.meta.phy.comm
functions do not require the user to specify a phylogeny, and com-
bined with the phy.sim family, provide a toolkit for the development
of new simulation scenarios.

Acknowledgements

F. Boivin, E. Lind, B. Waring, two anonymous reviewers, and M. Pennell pro-

vided useful feedback.

Funding
This work was supported by NSF grant EF-1339441.

Conﬂict of Interest: none declared.

References

Ackerly,D. (2009) Conservatism and diversiﬁcation of plant functional traits:
evolutionary rates versus phylogenetic signal Proc. Natl. Acad. Sci., 106,
19699—19706.

Bortolussi,N. et al. (2013) The ecology of differences: assessing community as-
sembly with trait and evolutionary distances. Ecol. Lett., 16, 1234—1244.
Cadotte,M.W. et al. (2010) Phylogenetic diversity metrics for ecological com-
munities: integrating species richness, abundance and evolutionary history.

Ecol. Lett., 13, 96—105.

Cavender-Bares,]. et al. (2004) Phylogenetic overdispersion in Floridian oak
communities. Am. Nat., 163, 823—843.

Dray,S. and Dufour,A.B. (2007) The ade4 package: implementing the duality
diagram for ecologists. ]. Stat. Softw., 22, 1—20.

Genz,A. et al. (2013) mvtnorm: Multivariate Normal and t Distributions. R
package version 1.0-2.

Helmus,M.R. and Ives,A.R. (2012) Phylogenetic diversity-area curves.
Ecology, 93, 531—543.

Ives,A.R. and Helmus,M.R. (2011) Generalized linear mixed models for
phylogenetic analyses of community structure. Ecol. Monogr., 81, 511—525.

Kembel,S.W. et al. (2010) Picante: R tools for integrating phylogenies and
ecology. Bioinformatics, 26, 1463—1464.

Koenker,R. (2015 ) quantreg: Quantile Regression. R package version 5.1 1.

Labierté,E. et al. (2014) FD: measuring functional diversity from multiple
traits, and other tools for functional ecology. R package version 1.0-12.

Letten,A.D. and Cornwell,W.K. (2015) Trees, branches and (square) roots:
why evolutionary relatedness is not linearly related to functional distance.
Methods in Ecology 6’ Evolution, 6, 439—444.

9mg ‘09 isnﬁnV uo sereﬁuV socl ‘eruiomeg JO AirSJeAru [1 112 ﬂJO'sreumo[pJOJXO'soneuuogurorq/ﬁdnq moi; popcorn/hog

2890

W.D.Pearse et al.

 

Mayﬁeld,M.M. and Levine,].M. (2010) Opposing effects of competitive exclu-
sion on the phylogenetic structure of communities. Ecol. Lett., 13,
1085—1093.

Oksanen,]. et al. (2015) vegan: Community Ecology Package. R package ver-
sion 2.2-1.

Orme,D. et al. (2013) caper: comparative analyses of phylogenetics and evolu-
tion in R. R package version 0.5.2.

Paradis,E. et al. (2004) APE: analyses of phylogenetics and evolution in R lan-
guage. Bioinformatics, 20, 289—290.

Pearse,W.D. and Purvis,A. (2013) phyloGenerator: an automated phylogeny
generation tool for ecologists. Methods Ecol. Evol., 7, 692—698.

Pearse,W.D. et al. (2014) Metrics and models of community phylogenetics.
Modern Phylogenetic Comparative Methods and their Application in
Evolutionary Biology—Concepts and Practice (ed. Garamszegi L.Z.),
Springer-Verlag, Berlin.

R Core Team (2015 ) R: A language and environment for statistical computing.
R Foundation for Statistical Computing, Vienna, Austria.

Rafferty,N.E. and Ives,A.R. (2013) Phylogenetic trait-based analyses of ecolo-
gical networks. Ecology, 94, 2321—2333.

Webb,C.O. et al. (2002) Phylogenies and community ecology. Annu. Rev.
Ecol. Syst., 33, 475—505.

9mg ‘09 1sn8nV uo sereﬁuV socl ‘121u10111123 10 A1rSJeAruf1 112 /810'S{12umo[p101x0'831112u1101urorq/ﬁd11q 111011 popcorn/hog

