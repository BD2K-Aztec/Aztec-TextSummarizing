APPLICATIONS NOTE

Vol. 30 no. 1 2014, pages 38—39
doi:10. 1093/bioinformatics/btt254

 

Sequence analysis

Advance Access publication May 7, 2013

A poor man’s BLASTX—high-throughput metagenomic protein

database search using PAUDA

Daniel H. Huson1’2’* and Chao Xie1’3’*

1Singapore Centre on Environmental Life Sciences Engineering, School of Biological Sciences, Nanyang Technological
University, Singapore 637551, 2Center for Bioinformatics, University of Tiibingen, 72076 Tiibingen, Germany and 3Life
Sciences Institute, National University of Singapore, Singapore 117456

Associate Editor: Michael Brudno

 

ABSTRACT

Summary: In the context of metagenomics, we introduce a new ap-
proach to protein database search called PAUDA, which runs ~10 000
times faster than BLASTX, while achieving about one-third of the as-
signment rate of reads to KEGG orthology groups, and producing
gene and taxon abundance profiles that are highly correlated to
those obtained with BLASTX. PAUDA requires <80 CPU hours to ana-
lyze a dataset of 246 million Illumina DNA reads from permafrost soil
for which a previous BLASTX analysis (on a subset of 176 million
reads) reportedly required 800000 CPU hours, leading to the same
clustering of samples by functional profiles.

Availability: PAUDA is freely available from: http://ab.inf.uni-tuebin-
gen.de/software/pauda. Also supplementary method details are avail-
able from this website.

Contact: daniel.huson@uni-tuebingen.de or xiechao@bic.nus.edu.sg

Received on March 6, 2013; revised on April 20, 2013; accepted on
April 30, 2013

In metagenomics studies, millions of DNA or cDNA reads are
sequenced from environmental samples, and these are then ana-
lyzed in an attempt to determine the functional or taxonomic
content of the samples (Handelsman et al., 1998). An important
computational step is to determine the genes or coding sequences
present, which is usually done by aligning the sequences against a
reference database of protein sequences. In most projects,
BLASTX (Altschul et al., 1990) has been the method of
choice, despite the fact that running BLASTX requires thou-
sands of CPU hours per million reads.

In the related area of read mapping, numerous methods have
been developed to solve the problem of aligning sequencing reads
against DNA reference sequences in a high-throughput manner
(for example, Langmead and Salzberg, 2012). Using read map-
ping tools directly for analyzing complex metagenomes is prob-
lematic because environmental reads usually do not match
existing genome reference sequences. Moreover, the underlying
algorithms cannot easily be extended to protein sequences.

In this article, we present a new paradigm for the alignment of
environmental sequencing reads called PAUDA, an acronym for
‘protein alignment using a DNA aligner’. It allows one to harness
the high efﬁciency of DNA read aligners to compute BLASTX-
like alignments.

 

*To whom correspondence should be addressed.

The key idea is to convert all protein sequences into ‘pseudo
DNA’, or ‘pDNA’ for short, by mapping the amino acid alpha-
bet onto a four-lettered alphabet that reﬂects which amino acids
are likely to replace each other in signiﬁcant BLASTX align-
ments. A high-throughput sequencing read aligner, such as
Bowtie2, is then used to compare pDNA reads with a pDNA
database. For any match found, the participating pDNA se-
quences are translated back into protein sequences, and the cor-
responding protein alignment is calculated so as to determine
statistical signiﬁcance. The ﬁnal output is a ﬁle of statically sig-
niﬁcant protein alignments in BLASTX format.

We have implemented this approach in a new software pack-
age called PAUDA. The package provides two scripts, pauda—
build and pauda—run. The ﬁrst script is run on the protein
reference database and builds an appropriate index. The second
script is run on a ﬁle of DNA reads and produces a BLASTX ﬁle
as output. The two scripts use the Bowtie2 suite and a number of
new Java programs that we have written. Bowtie2 can easily be
replaced by some other method, if desired. An overview of the
package is given in Figure 1.

Using Bowtie2 as the comparison engine, PAUDA runs
~10 000 times faster than BLASTX, while assigning about
one-third as many reads to KO groups. Because of the huge
computational burden of running BLASTX on a large dataset,
BLASTX is rarely run to completion; therefore, the key question
is how many reads can be assigned per hour. PAUDA assigns
~3000 as many reads as BLASTX does, per hour.

Mackelprang et al. (2011) present a taxonomic and functional
analysis of 12 permafrost datasets. Reanalysis of their data, a
comparison of 246 million Illumina reads with the KEGG data-
base (Kanehisa and Goto, 2000), takes ~2h on a single work-
station (64 cores, 512GB of main memory) using PAUDA,
reproducing the main result of the article.

In addition, we applied an early version of PAUDA to an
unpublished dataset consisting of all 2.9 billion reads of a
whole HiSeq2000 run on a waste-waster sample, requiring ~2
days on 150 cores, whereas RAPSearch2 (Zhao et al., 2012)
required 115 days.

We produced a benchmark dataset for comparing the per-
formance of PAUDA, BLASTX and RAPSearch2 by taking
the ﬁrst 600 000 good quality reads from each of the 12 samples
published in Mackelprang et al. (2011). We then ran all three
programs on each of the 12 samples benchmark samples, com-
paring with the KEGG database. Running all samples in parallel
on a single workstation using 48 cores, the runtime ranged from

 

© The Author(s) 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

A poor man’s BLAS1X?

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

pauda-build
Protein pDNA
reference proteinzpna reference Index pDNA ELASTX
sequences sequences bui'de" index a 'gnments
pauda-run I
DNA pDNA DNA pDNA
reads dnaZPna reads sequence alignments pnaZblaStx
aﬁgner
protein reference sequence
YGRMCPIETPE —> ACGTTCTGCCG —|->
mmme ACGTTCTGCCG RMCP
align |||| —>||||
DNA read —|—>  expand 
CGCCTTTGCACC —) RLCT —> GTTC

translate reduce

Fig. 1. An overview of the PAUDA approach

Table 1. Alignment of 12 x 600 000 Illumina reads from permafrost data
against the KEGG database

 

Methoda Timeb Speed-upc Reads assignedd KOse True KOsf

 

PAUDA 7 ~5 000 155 824 33% 4182 78% 1717 99.0%
RAPSearch2 510 ~60 449 144 96% 5237 98% 1712 98.7%
BLASTX 30 240 ~l 465 588 100% 5363 100% 1735 100%

 

aThe method used.

bThe number of wall-clock minutes required on 48 cores to process all 12 datasets.
cThe speed-up over BLASTX.

dThe number and percentage of reads that obtain a KO assignment.

6The number and percentage of different KO groups identiﬁed.

fThe number of ‘true’ KO groups identiﬁed, deﬁned as those that account for 99%
of all reads with BLASTX hits. Percentages are in comparison with the results
obtained by BLASTX. Note that half of the runtime reported here for PAUDA
is start up overhead and on larger datasets the speed-up is ~10 000.

7min (PAUDA) to 7 days (BLASTX), Table 1. We used the
metagenome analysis program MEGAN (Huson et al., 2011)
to assign reads to KEGG orthology (KO) groups based on
their alignments.

Using PAUDA, the rate of assignment is 33% of that of
BLASTX. In more detail, for alignments with a protein identity
of 60, 70, 80, 90 and 100% the sensitivity is 35.1, 48.4, 61.6 and
78.5%, respectively. For alignments with identity <50%, the
sensitivity is <8.1%.

For those reads for which both BLASTX and PAUDA are
able to assign a KO group, the assignment differs in ~2% of all
cases. Assuming a false-positive error rate of 1% for the assign-
ment of reads to KO groups, BLASTX identiﬁes 1735 ‘true’ KO
groups for this dataset that account for 99% of all reads with
BLASTX hits. PAUDA identiﬁes 99% of these. The number of
reads assigned to individual KO groups by PAUDA and
BLASTX is highly correlated, as shown in Figure 2. The
Pearson correlation is 0.977 for linear read counts and 0.949
for log-transformed counts.

Using the LCA assignment algorithm as implemented in
MEGAN, we also performed a taxonomic analysis of these data-
sets at a number of different taxonomic ranks. The results based

 

 

6000 - ° "

1000 -

4000 -

 

§
5 '.' 5’
20m- pz n- 10-
to
o-  r=0.977 :° ° r=0.949

 

 

 

 

 

 

 

I I I I I I I
0 5000 1 0000 15000 20000 100 1 0000
B

10'00
LASTX BLASTX (log10)

Fig. 2. KEGG comparison of PAUDA and BLASTX. Left: Each true
KO group is represented by a dot with coordinates that correspond to the
number of reads assigned to the KO group by BLASTX (on the x-axis)
and PAUDA (on the y-axis). Right: To show the low abundance KO
groups more clearly, here, we plot the same data on a logarithmic scale

on PAUDA and BLASTX are highly correlated, with a
Pearson’s correlation coefﬁcient r that ranges from 0.993 for
the taxonomic rank of class to 0.953 for species. The correspond-
ing range for log-transformed counts is 0982—0914.

To further illustrate the accuracy of PAUDA, we applied the
program to all 12 permafrost samples in their entirety, in total
comparing 246 million reads with the KEGG database.

A key result of (Mackelprang et al., 2011) is that, on the one
hand, two different frozen samples taken from the active layer of
the permafrost have similar functional proﬁles, and that these
change only little after thawing for 2 or 7 days. Although, on the
other hand, two frozen samples obtained from the permafrost
layer initially exhibit distinctive proﬁles that gradually become
more similar during thawing. A PCoA analysis of Bray—Curtis
distances (Mitra et al., 2010) based on a PAUDA comparison of
the data with the KEGG database delivers the same result in a
small fraction of the computational time.

Funding: National Research Foundation and Ministry of
Education Singapore under its Research Centre of Excellence
Programme.

Conﬂict of Interest: none declared.

REFERENCES

Altschul,S.F. et a]. (1990) Basic local alignment search tool. J. Mol. Biol., 215,
403—410.

Handelsman,J. et al. (1998) Molecular biological access to the chemistry of
unknown soil microbes: a new frontier for natural products. Chem. Biol., 5,
245—249.

Huson,D.H. et a]. (2011) Integrative analysis of environmental sequences using
MEGAN4. Genome Res., 21, 1552—1560.

Kanehisa,M. and Goto,S. (2000) KEGG: Kyoto encyclopedia of genes and
genomes. Nucleic Acids Res., 28, 27—30.

Langmead,B. and Salzberg,S. (2012) Fast gapped-read alignment with Bowtie2.
Nat. Methods, 9, 357—359.

Mackelprang,R. et a]. (2011) Metagenomic analysis of a permafrost microbial
community reveals a rapid response to thaw. Nature, 480, 368—371.

Mitra,S. et al. (2010) Comparison of multiple metagenomes using phylogenetic
networks based on ecological indices. ISME J., 4, 1236—1242.

Zhao,Y. et a]. (2012) RAPSearch2: a fast and memory-efﬁcient protein
similarity search tool for next-generation sequencing data. Bioinformatics, 28,
125—126.

 

39

112 ﬁle'sleumo[pJOJXO'sopeuuogutoIq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV uo ::

