APPLICA TIONS NOTE V0" 2.52,?fafié‘iéfs[532323532252

 

Genome analysis

Advance Access publication October 7, 2012

KGBassembler: a karyotype-based genome assembler for

Brassicaceae species

Chuang Ma, Hao Chen, Mingming Xin, Ruolin Yang and Xiangfeng Wang*
School of Plant Sciences, University of Arizona, Tucson, AZ 85721, USA

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: The Brassicaceae family includes the most important
plant model Arabidopsis thaliana and many cruciferous vegetable
crops. A number of close relatives of Arabidopsis and economically
important Brassica species are being sequenced with whole-genome
shotgun sequencing technologies. However, de novo assembly of full
chromosomes is difficult, since many non-model Brassicaceae spe-
cies are lacking genetic and/or physical maps. As a unique feature for
Brassicaceae, the genome of each member is composed of 24 con-
served chromosomal blocks, and the arrangement of the 24 blocks
can be obtained from karyotype analysis via comparative chromo-
some painting experiments. Taking this advantage, we developed
a bioinformatic tool named KGBassembler to automatically finalize
assembly of full chromosomes from contigs and/or scaffolds based
on available karyotypes of Brassicaceae species.

Availability: KGBassembler was implemented in C++ with a graph-
ical user interface. It is freely available to academic users at http://
www.cmbb.arizona.edu/KGBassembler/.

Contact: xwang1@ca|s.arizona.edu

Received on April 30, 2012; revised on August 20, 2012; accepted on
September 23, 2012

1 INTRODUCTION

The Brassicaceae family contains about 3700 species, including
the most well-known model plant Arabidopsis thaliana
(Arabidopsis), and many agronomically important vegetable
crops (e.g. Brassica rapa, B. oleracea) and numerous species
with promising use for biodiesel production (e.g. B. napus,
B. juncea). Several projects have been launched to sequence the
genomes of a selection of Brassicaceae species, for instance, the
Brassicales Map Alignment Project (http://www.brassica.info).
However, because of lacking genetic and/or physical maps for
many of these non-model plants, the sequence reads from
whole-genome shotgun sequencing can be only assembled to
contigs or scaffolds.

An alternative strategy to achieve the assembly of chromo-
somes from contigs or scaffolds is utilizing the genome synteny
from the completed genomes of model organisms. This is espe-
cially feasible for Brassicaceae, because it was postulated that the
genome of species in this family is composed of 24 conserved
chromosomal blocks, whose arrangement can be obtained
from comparative chromosome painting (CCP) analyses (e.g.
Mandakova and Lysak, 2008; Schranz et al., 2006). Numerous

 

*To whom correspondence should be addressed.

karyotypes in different lineages of Brassicaceae have been pro-
filed with CCP experiments, such as A. thaliana (n = 5), Eutrema
salsugineum (n27), A. lyrata (n: 8), B rapa (n: 10) and so on
(Lysak and Koch, 2011; Mandakova and Lysak, 2008; Schranz
et al., 2006). Thus, these existing and forthcoming karyotype
maps of Brassicaceae can be used to ﬁnalize the assembly
of chromosomes. The feasibility of karyotype-based assembly
has been shown in the assembly of T hellungiella (Schrenkiella)
parvula genome independent of genetic and/or physical maps
(Dassanayake et al., 2011).

Taking this advantage, we developed the KGBassembler, a
tool to assemble full chromosomes from scaffolds if a karyotype
is provided. The KGBassembler is featured with a user-friendly
graphical user interface (GUI), allowing users to use automatic
assembling of chromosomes based on CCP-based karyotypes
and/or to manually edit the layouts of contigs according to
in silico generated karyotypes.

2 IMPLEMENTATION

2.1 Architecture

KGBassembler was implemented in C++ with a GUI built with
the open-source QT toolbox. The information of 24 blocks,
including letter-labels (A—X), color-codes and the orthologous
genes in Arabidopsis, was integrated into KGBassembler
(Schranz et al., 2006). KGBassembler requires three input files:
the contig (or scaffold) sequences from de novo assembly in
FASTA format; the alignment result of Arabidopsis genes (pro-
tein sequences) against the contigs by BLAT (Kent, 2002) and
the karyotype file in plain text. Four outputs will be generated,
including the assembly of chromosomes, an in silico karyotype,
chromosome-scale synteny maps between assembled species and
Arabidopsis, and a report containing the predicted layouts of
contigs on chromosomes.

2.2 Algorithms and workﬂow

KGBassembler runs in three steps (Phases I—III). Phase I
(C0ntigs2Blocks) is to identify the 24 blocks in contigs via ana-
lyzing BLAT alignments using two algorithms: local and global
search (Fig. la). Speciﬁcally, according to the BLAT alignments,
KGBassembler first assigns the strings of block-labels (A—X)
associated with Arabidopsis genes to the mapped positions on
contigs. Then, the local search is performed to identify the con-
served genomic blocks in contigs using a sliding window with
size of L adjacent block labels and step of one block label.
In each window, KGBassembler finds the block label

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 3141

112 /310's113umo [p.IOJXO'SOllBIIIJOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

C.Ma et aI.

 

 

 

 

 

 

 

(a)
convert aligned g g g g g . _ ~ _ H g g g g 9
genes to block + 1 2 3 4 5 n-4 n—3 n-2 n-1 n
letter-labels
Local DDHDN ---- "TX XFX
use sliding window \—\/—’
SearCh approach to 0-85
- . \—\/_/
Identify genome 0 90 ;
blocks ’ '
D D D D N ' ' ' ' " X X X X X
G|oba| convert block
letter-labels to 1 1 1 1 2 . . . . .. 1 1 1 1 1
sea rCh chromosome IDs
1 1 1 1 2 ' ' ' ' " 3 3 3 3 3
(b) (C)

- rm..- .—-..—~—-.I...- "-1.11"...- - I .u._-1-...:.u-a;.+ uauﬂmg; an.me ' '-' i-l-IIIJ'
1 '1'rI-'-"I iI-rg r 141-15—131th I "I I — . __ - — -
'rlru'aul. :I-' 'I-I-r-IZ-u-uu 'I 1;._ ._|. 11:. ._Ir 3. .1
a-hﬂaulraurr-qﬂhhnl unis-rung. Ul'n' u: :1: I r. I
.errnI—wr'm'ull-n—I _' ‘-I"1l-'I-I I'rl- I-n. ::: 11-: .l- 1": 1': I1.
:‘rrm'vm-n';m; unau- m.nn1|- r“ IT" (I. ':I H
:qu.-.F‘R 14-. undid-mun- .-I I'“' h- h' I“ "I - I}-

L'I'l -:l.- d- rJ:-  _-
- ----h-I-.I'L IL-"hﬂh .'-II'I H! .II'. . -'_' II . J .
-rln'nrh.lh“. _: u: -- 'I'rldulr'r'a-I- _: I I
I1- Ihu: .-IM
  ulna-amtmlhﬁhiiwm MITI— '_"ﬂﬁ_-
I I I I I I I I I I I

I II- -

— i L H.-

—III 'I- m

I_-‘I
IIIII IJ.II III--—I
Fir-h“ "-1-—

 

 

Fig. 1. Algorithms of inferring syntenic blocks in contigs and screenshots
of KGBassembler. (a) The algorithms of local and global search to infer
the 24 syntenic blocks in contigs based on BLAT alignments. The num-
bers represent the highest proportion of all probable blocks in the ana-
lyzed windows. (b) Control panel to set up parameters for running Phase
I analysis. (c) A report panel displaying the layout of contigs on
assembled chromosomes and allowing users to perform manual adjust-
ment of layouts at Phase II. (d) Visualization of the assembled in Silica
karyotype

(i, i e [A, B, - - - , A1) with the highest number (n) and predicts the
corresponding region of this window belonging to blocks i if
n/LZ(l-FTR). Thus, a lower fault-tolerant ratio (FTR) indi-
cates that a strict rule is applied to determine the genome
blocks in contigs and yields the assembled chromosomes with
higher quality. A less-stringent FTR (e. g. 0.30) is recommended
for the ﬁrst-time run so that more contigs with block information
can be retained to estimate the quality and coverage of the
genome assembly. Third, the global search is initiated to merge
regions with discontinuous strings of block labels with the fol-
lowing steps: (i) convert the block labels of predicted regions to
chromosome IDs with the block order information obtained
from karyotype ﬁle; (ii) ﬁnd the chromosome ID with the highest
proportion (pr) and predict the contig belonging to this chromo-
some if pr: l-‘Chromosome FTR’. Similar to FTR,
‘Chromosome FTR’ is also a user-adjustable parameter that
can be used to control the quality of genome assembly; (iii)
mask the blocks that are inconsistent with the majority of

predicted chromosome IDs and (iv) merge the adjacent regions
as whole chromosomal blocks with the same block labels.

To ensure the accuracy of assigning blocks to contigs, it should
be better for users to eliminate chimeric contigs before BLAT
mapping. KGBassembler allows users to remove low-quality
BLAT alignments by a minimal identity and coverage cutoff
and to ignore short contigs (e.g. 310 kb and/or 35 genes), if
the information is not sufﬁcient to assign the blocks to contigs.
KGBassembler provides a control panel for users to set up
the parameters to optimize the results generated from Phase I
(Fig. lb).

Phase II (Blacks2Chramasames) allows users to manually
adjust the layout of contigs to form chromosomes based on
the comparison of in silica and experimental karyotypes. The
predicted assignments of blocks to contigs information from
Phase I are organized in a table for manual inspection. The
order and orientation of a contig can be further edited to
make necessary adjustments to build a high-quality genome as-
sembly (Fig. 10).

Phase III (AssemblyFinishing) connects the contig sequences
to generate chromosome sequences based on the manually
inspected and edited layouts (i.e. order and orientation) of the
contigs assigned to each chromosome. KGBassembler also pro-
duces a pseudo-chromosome named ‘ChrUd’, with contigs
whose chromosomes are not clearly determined in Phases I and
II. Because of the difﬁculty of estimating the gap size,
KGBassembler directly links the sequences of adjacent contigs
together to form the assembled chromosomes. The sequence of
contigs with ‘—’ orientation were reverse complemented before
the generation of chromosome sequences. Simultaneously, an in
silica karyotype of the assembled genome is generated in the
scalable vector graphics format (Fig. 1d). At last, a series of
chromosome-scale synteny maps between assembled species
and Arabidopsis are produced.

3 RESULTS

We ran KGBassembler to assemble the seven chromosomes from
the 1496 gap-free contigs (~137Mb) of T. parvula, sequenced by
454 and Illumina technology (Dassanayake et al., 2011). Based
on the T hellungiella {Eutrema) karyotype (Mandakova and
Lysak, 2008), 40 large contigs were unambiguously connected
as seven chromosomes, covering 114.39 Mb (83.44%) of the
total sequences. The order of these contigs in the assembled
genome was consistent with that in the reported assembly
(Dassanayake et al., 2011) (Fig. 1d). KGBassembler can be run
on Windows and Linux. Except the time spent on the manual
inspection of the contig layouts, KGBassembler can ﬁnish
assembling the T. parvula chromosomes with the input of 1496
contigs and ~400 000 BLAT alignments on a laptop in several
minutes. Because the KGBassembler assembles the chromo-
somes primarily based on gene synteny information, the short
contigs, repeat-rich contigs and contigs without sufﬁcient
amount of genes were usually ignored. In addition, the perform-
ance of KGBassembler depends on the quality of contigs and/or
scaffolds preassembled by de nava assemblers to achieve the
high-quality chromosome assemblies.

 

3142

112 /810's113umo [p.IOJXO'S311BIIIJOJUTOTQ/ﬁ(11111 11101; prBOIIIAAOG

9IOZ ‘091sn8nv uo ::

K GBassembIer

 

Conﬂict of Interest: none declared.

REFERENCES

Dassanayake,M. et al. (2011) The genome of the extremophile crucifer T hellungiella
parvula. Nat. Genet, 43, 913—918.

Kent,W.J. (2002) BLATithe BLAST-like alignment tool. Genome Res., 12,
656—664.

Lysak,M.A. and Koch,M.A. (2011) Phylogeny, genome, and karyotype evolution
of crucifers (Brassicaceae). In Schmidt,R. and Bancroft,I. (eds) Genetics and
Genomics 0f the Brassicaceae. Springer, New York, pp. 1—31.

Mandakova,T. and Lysak,M.A. (2008) Chromosomal phylogeny and
karyotype evolution in x=7 crucifer species (Brassicaceae). Plant Cell, 20,
2559—2570.

Schranz,M.E. et al. (2006) The ABC’s of comparative genomics in the Brassicaceae:
building blocks of crucifer genomes. T rends Plant Sci, 11, 535—542.

 

3143

112 /810's113umo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁ(11111 11101; prBOIIIAAOG

9IOZ ‘091sn8nv uo ::

