Bioinformatics, 32(15), 2016, 2248—2255

doi: 10.1093/bioinformatics/btw138

Advance Access Publication Date: 11 March 2016
Original Paper

 

Genome analysis

D3M: detection of differential distributions of
methylation levels

Yusuke Matsui1'*, Masahiro Mizutaz, Satoshi Ito3, Satoru Miyano3 and
Teppei Shimamura1'*

1Nagoya University Graduate School of Medicine, Nagoya 466-8550, Japan, 2Information Initiative Center,
Hokkaido University, Sapporo 060-0811, Japan and 3Institute of Medical Science, The University of Tokyo,
Tokyo 108-8639, Japan

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on June 22, 2015; revised on February 19, 2016; accepted on March 8, 2016

Abstract

Motivation: DNA methylation is an important epigenetic modification related to a variety of dis—
eases including cancers. We focus on the methylation data from lllumina’s lnfinium
HumanMethylation450 BeadChip. One of the key issues of methylation analysis is to detect the dif—
ferential methylation sites between case and control groups. Previous approaches describe data
with simple summary statistics or kernel function, and then use statistical tests to determine the dif—
ference. However, a summary statistics—based approach cannot capture complicated underlying
structure, and a kernel function—based approach lacks interpretability of results.

Results: We propose a novel method D3M, for detection of differential distribution of methylation,
based on distribution—valued data. Our method can detect the differences in high—order moments,
such as shapes of underlying distributions in methylation profiles, based on the Wasserstein met—
ric. We test the significance of the difference between case and control groups and provide an in—
terpretable summary of the results. The simulation results show that the proposed method
achieves promising accuracy and shows favorable results compared with previous methods.
Glioblastoma multiforme and lower grade glioma data from The Cancer Genome Atlas show that
our method supports recent biological advances and suggests new insights.

Availability and Implementation: R implemented code is freely available from https://github.com/
ymatts/D3Ml.

Contact: ymatsui@med.nagoya—u.ac.jp or shimamura@med.nagoya—u.ac.jp

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

DNA methylation is an epigenetic chemical alternation in which a
methyl group is attached to a 5—carbon of a cytosine (C) base. It is
closely related to gene expression, silencing and genomic imprinting,
including oncogenesis. Typically, methylation is explained as occur—
ring in cytosine—phosphate—guanine (CpG) sites in mammals. The
methylation of promoter regions, in particular, silences cancer sup—
pressor genes (Baylin, 2005 ; Kulis and Esteller, 2010).

We focus on the methylation data from Illumina’s Infinium
HumanMethylation450 BeadChip. One of the key issues for

methylation analysis is to detect differentially methylated sites, i.e. a
significant difference in methylation levels between the case and the
control groups at a site. When comparing groups, we often summarize
(or aggregate) data in summary statistics, such as mean and variance,
and then investigate the difference between the groups. For example,
IMA (Wang et 61]., 2012) detects the differentially methylated sites by
T—test, Empirical Bayes (EB) method or by Mann—Whitney—Wilcox
(MW) test. DiffVar (Phipson and Oshlack, 2014) detects the sites
by testing significant difference of variance. Other nonparametric
approaches exist, such as the Kolmogorov—Smirnov test (KS) or

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2248

9mg ‘09 1sn3nv uo sopﬁuv $01 ‘etulomeg aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

Detection of differential distributions

2249

 

kernel—based approaches, such as maximum mean discrepancy
(MMD) (Gretton et 61]., 2012). In particular, since KS and MMD con—
sider the underlying distribution structure, they are better suited for
use with complicated distributions than methods based on summary
statistics.

These approaches are insufficient from some perspectives; under—
lying distributions are complicated by being skewed, heavy—tailed
and multimodal. In particular, since cancer cells include heterogene—
ities, measurements of the methylation levels potentially include
complex distribution shapes. This observation indicates that we
need to consider the underlying structure. The disadvantage of KS
and MMD is infeasible interpretability of results because they meas—
ure the maximum and kernel distances of distributions, respectively,
which are difficult to interpret corresponding to the actual difference
of underlying distributions.

We develop a method to detect differential methylation sites
with distribution—valued data (Irpino and Verde, 2014).
Distribution—valued data are an example of symbolic data analysis
(Diday, 1989). This framework can treat complex data such as func—
tional (Ramsey and Silverman 2005), tree (Wang and Marron,
2007), set, interval and histogram values (Bock and Diday, 2000).
The proposed method describes case and control groups using distri—
bution values. We measure the differences between distributions
using the Wasserstein metric. We detect the differential methylation
sites using a statistical test of significant differences of distribution

functions.

2 Methods

Our method is aimed at a distribution—based comparison of methy—
lation levels in two groups at a single cytosine level. We construct
distribution functions representing the two groups at each site.
Next, we compare the groups using a dissimilarity measure and test
statistical significance by resampling approach at a site. We adopt
an LZ—Wasserstein metric (Rueshendorff, 2011) as a dissimilarity
measure, a distribution function—based measure of statistical dis—
tance. The advantage of this distance is the interpretability of results
because the distance can be decomposed into three components, i.e.
mean, variance distribution shape. This fact leads to visualization of
results using a Q—Q plot to interpret the detected distribution differ—
ence including hypo— or hyper—methylation status. Methylation level
can be represented by a beta value that is the ratio between the
methylated probe intensity and the overall intensity (Du et 61].,
2010). The definition of 1th site beta value in Illumina methylation
assay is as follows:

maX(zi,methya  + 0‘
maX(zi,unmethya  + maX(zi,methya  + 0‘

 

Beta, : (1)
where zamethy and z,7unmethy are the intensity measured by 1th methy—
lated and unmethylated probes, respectively and 0t is constant. [3 val—
ues have biologically direct interpretation (Du et 61]., 2010), as
opposed to M value (i.e. logit transformation of [3 value). IMA and
DiffVar use [3 value and M value, respectively. In the following, we
use [3 value as the input of D3M.

2.1 Construction of objects
X(5,) and Y(5,) (i = 1,2, . . . ,5) represent the beta values in a case
group (e.g. cancer subjects) and a control group (e.g. normal

subjects) at a CpG site 5,. We represent the data as distribution val—
ues by

 : Pr{X(5,) g x};x E [0,1].

(2)
G10”) = Pr{Y(Si) S 30W E [0,1]-

In practice, let the beta value observations be x,(5,); j = 1, 2, . . . ,
n and y,(5,);j : 1,2, . . . , m following  and G,(y), respectively,
where n and m are the respective numbers of observations at 5,.
From the data, we construct the empirical distribution functions;

131- 6) == %2 1<xi<sz> : x)
i=1
(so) == $2 10,-(51) : y)
i=1

where

1 if agb
1(a<b)—{ <4)

0 otherwise.

2.2 Dissimilarity measure for distributions
The Wasserstein metric is defined by the following:

1
elm-,6» ==[ |F51(u)— 6:10»qu <5)
0

where 1 s q s 2 and Ff1(x) and Gi—1(y) indicate quantile
functions.

In particular, in the case of q = 2, the metric can be decomposed
into three components that describe the distribution characteristics,
i.e. mean, variance shape (Irpino and Verde, 2014):

1
dZF,,G, = F71 —G.—1 2d
< > [01, (u) ,<u>| u (6)

2 (p1. — M)2 + (a, — 0/02 + 2070211 — pi,i’)

where u, and 01-2 (respectively, p:- and of) are mean and variance of
 (respectively, G,(y)), and p, is the correlation index of the
points in the Q—Q plot of F, and G,.

The empirical estimator of the Wasserstein metric is given by

A A 1 A_1 A—1
dq(F,-,G,>=[ IF,- <u>—G,- (unqdu. <7)
0

Technically, we use quantiles to compute the approximation of
the (7) for reducing computational costs. Let (Q1,1,Qi,2,. ..,Q,7K)
and (Q[71,Q[72, . . . ,  be k—quantiles of and G,(y). We cal—
culate d2(f7,,  % 2:1 (Qkal — Qlkal)2 in the case of q :2, instead
of evaluating the integral in (7). Here, we simply write

611:: d(ﬁ,‘, 

2.3 Detection of differential methylation sites
We use the metric to investigate whether two distributions are sig—
nificantly different. We pose statistical hypotheses as follows.

Null hypothesis : F, = G, (8)

Alternative hypothesis : F, 7E G,
We use resampling to construct a null distribution. From the null
hypothesis (8), we jointly permute the observations (x1 (5,), x2(5,), . . . ,
xn(5,)) and (y1(5,),y2(5,), . . . ,ym(5,)) to obtain the new distribution

91% ‘09 1sn3nv uo sojoﬁuv 501 ‘ETUJOJHBQ aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

2250 Y.Matsui et al.

 

Table 1. Simulation models of eight cases [1,, 0,, and siindicate mean, variance, and shape (unimodal or bimodal) of the distributions in the
case (i=1) and control (i=2) groups, respectively

 

 

 

 

Pi = F2 F1 7’é F2

Case 1 Case 2 Case 3 Case 4 Case 5 Case 6 Case 7 Case 8
pl : uz T T T F T F F F
61 = 62 T T F T F T F F
51 Z 52 T F T T F F T F

 

functions  and  Next, we obtain the new distance d? = d2
  according to (7).
Let D: = ( :1, dZZ, . . . , dZBaH) be all possible distances for the

permutation process. Then P—value is

Ball

Z 1(de 2 d,)

Panda =  <9)

~>i<

Approximation of (9) uses the subset of D2“, 3:1,d:2,...,d,-73
whereB 3 Ball:

B
2 1(62; 2 
Page!» = Hf. (10)

In the simulation of Section 3 and data analysis in Section 4, we
set B = 10, 000.

The number of permutations B is closely related to the accuracy
of the P—value. However, resolution of Psub is limited to 1 / B, if we
need the very small P—values. One solution is to perform a large
number of permutations, but it is computationally expensive. A
semi—parametric estimation of P—value is proposed by Knijnenburg
et al. (2009) to obtain more accurate P—values.

We use an exponential distribution to estimate the distribution
tail as follows,

:%§:1oﬁb2¢e) ﬁn d,<d§mm
P(d,-) = ’21 <11)

ewet@—¢mm brazﬁmo

where k, is a scale parameter and djmm) is a threshold that we set to
99th percentile of null distributions. We estimate 2», using data above
the threshold. Technically, we perform the semi—parametric estima—

tion only if Psub(d,) reaches to zero.

2.4 Graphical representation of results

The graphical interpretation of the statistical test result is important.
One approach is to plot all the distribution (density) functions of candi—
date sites, but this is infeasible for hundreds of sites. We use a Q—Q plot
with two distributions. It enables us to visualize many pairs of distribu—
tions at a time, with the directions being easy to interpret. In the actual
example shown in Section 4, we plotted 1000 pairs of differentially
methylated distributions (Fig. 3B). We can see the hyper—methylation
with the most significant 1000 sites (blue lines in Fig. 3B).

3 Simulation

3.1 Simulation setting
We evaluated the proposed method with simulated datasets with
focus on single cytosine level in the case and control group. Our

simulation is intended for the detection of differential methylation
sites when there is cancer heterogeneity. Here, the cancer heterogen—
eity is described by the multiple modes of distributions. We conduct
a statistical test for H0 : F, = G, <—> H1 : F, 7E G, under significance
levels 5%, and we compare the results to those of the other methods,
i.e. DiffVar, MMD, KS, MW and EB. We used several packages;
missMethyl (Phipson and Oshlack, 2014), limma (Ritchie et al.,
2015) written in R and mmd (Gretton et al., 2006) (http://www.
kyb.tuebingen.mpg.de/bs/people/arthur/code/mmd.zip) written in
MATLAB. The setting of missMethyl is default and mmd with op—
tions alpha : 0.5 and MMD_METHOD : ’approxmoments’.

We describe the outline of the simulation as follows. The details
are described in Supplementary file 81 and R codes are described in
Supplementary file S2. The data are generated by using two types of
distributions. The control and case groups are represented by nor—
mal and normal mixture distributions, respectively. In each case
(case 1—case 8 in Table 1), there are 80 samples; 40 samples for case
and control groups, respectively (Fig. 1). We performed the statis—
tical test with each method for 50 times in every case (i.e. cases 1—8)
and evaluate averages of a type I error and power. Besides we repeat
this process for 100 times to assess the variances of the averages.

3.2 Simulation results

The results are shown in Table 2. In the first case, it is shown that
error rates of D3M, MMD, DiffVar, KS, EB and MWW are close to
the significance levels, which indicates that they effectively control
type I errors.

Furthermore, we investigate the power for cases 2—8. The KS test
and MMD show relatively good performance in case 2 where only
the shape parameters of the distributions differ. However, they can—
not capture the feature of case 8 where the majority of the two
groups are overlapped with each other although 15% of minority of
distribution exists. Besides, KS testing fails to detect case 6 where
15% of minority distribution is hyper—methylated and MMD fails to
detect case 4 where only mean is different. DiffVar shows high
power for cases where explicit hypothesis is tested, however, it
might capture the other distribution features for the cases with equal
variances (case 6), leading to uninterpretable results. EB can appro—
priately distinguish only the mean difference that is the explicit hy—
pothesis. MWW can detect case 4 and 7, but cannot detect cases in
which the means differ under non—normality. The proposed D3M
provides preferable results over the eight cases.

On one hand, from this simulation, the differential distributions
in each case can be detected with D3M with the sufficient power,
which indicates that it works well for the given situations and it can
be applied to various cases ﬂexibly. On the other hand, a small sam-
ple situation should also be examined. We conduct the simulations
in Supplementary file 81 considering several situations such as; small
sample size (25 samples) with the same setting of Table 2
(Supplementary Tables 8.3 and 8.6), sample sizes are extremely dif—
ferent between the case and control groups (Supplementary Table

91% ‘09 1sn3nv uo sojoﬁuv 501 ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.ITIO[p.IOJXO'SOTmIHJOJUTOTQﬂIdllq 11101; pop1201umoq

Detection of differential distributions

2251

 

 

 

 

 

 

 

 

 

 

 

 

 

ill—rt- ill—“L:
f”- HM“ [—I-l —5 G1 —1_I'_ 
=  — S — 5'. "I- 5; I
 .r/ \n. E-
5 ,2 an a r.-_f-- —-~ 
t — e H“ W '- tw-
..;- m =
J!- fJ'J
"I. m
ﬂ- u
ﬂ CI D E 0.4 D E El 3 'l D ELI] 0.2 114 DE: [1.5 1.1}
|.L1 p1,: ' [LL- -- |.L;.-
.w n, .r n. n. 1.13
a II. "- E- S_= E f_.--'" "HR 5| 5:
'E i i E f
e _ x "k r e - / \2.
55- vi
'4'? LI'J
1": n:
L} L:
[LEI 0.2 Eli-1i ELE I113 1.0 ELI] 112 114 DE 0.5 1.0
“- H; 111 " .U-E
_ n.- : 11.3 In. G
E III S: a:  E 51-f- 
E II I'. E .—
c .- . 1:1 _ r ' a._a— _
If 1") ‘ .1 E ' ‘11.!-
e; r11
W LI'J
1": n:
1.: 1::
DD DE Eli-f [15 [IS 10 CH] DE Ell-4 DE DB 10
,Lt-. :- ti, ' ll. #11; '
I N." [51 -|' '55 _ HI 1 G:
a I '~. 5' 5: E 1' II 5:- i' 3: =
'E  Iii-\- E II ||
D I: I
if -—-—... " - E  'H
1:: 111
{.I'? ILI'J
-.-: n21
L? U
[1.0 0.2 0.4 DE (1.3 1.0 11.0 {1.2 {-1.4 0.13 0.3 1.0

Fig. 1. The beanplot of eight cases

S.5). In general, the power of D3M is decreasing as well as the other
methods.

4 Actual example

4.1 Datasets

We apply our method to methylation data of glioblastoma multi—
forme (GBM) and lower grade glioma (LGG) from The Cancer
Genome Atlas (TCGA). GBM is the primary brain tumor that pro-
gresses with malignant invasion destroying normal brain tissues
(TCGA, 2008). In this analysis, we compare the methylation levels
in the LGG and GBM groups, and then specify the differential
methylation sites. We focus on mean, variance and shape differences
using EB, DiffVar, KS and D3 M and compare the results.

Here, we briefly describe the datasets and preprocessing as fol—
lows. All the samples are hybridized to Illuminas Infinium
HumanMethylation450K arrays, including 485 577 CpG sites,
which is downloadable from TCGA portal sites. Each CpG site con—
tains 145 samples and 530 samples in GBM and LGG, respectively.
We remove CpG sites on the X and Y chromosomes and SNP con—
trol probes(rs1—rs65). We also use HumanMethylation450 v1.2
SNP Update Table to remove SNP related probes by minor allele fre-
quency g 1%. As a result, we get 351 932 probes. Missing values
in both groups are inferred using R package pcaMethods (Stacklies,
2007) with pca functions since DiffVar does not accept missing

values and the number of the probes including missing values cannot
be ignored. We remove the batch effect using the ComBat function
in SVA package (Leek et al., 2012) with default settings. We use
batches having more than 2 samples. The details are described in R
codes in S3. We finally obtain 141 GBM and 530 LGG samples.

4.2 Analysis results

Significant differential methylation sites were identified as those
having false discovery rate (q—value) (Benjamini and Hochberg,
1995) less than 1%. The Venn diagram (Fig. 2A) shows the number
of detected probes from the perspective of mean, variance and shape
difference of distributions using EB, DiffVar, KS and D3M, and
279 008, 191 050, 297 493 and 255 317 sites are totally detected,
respectively. From Figure 2A, most of detected sites with the shape
difference are overlapped with the sites by the mean and the vari—
ance differences, respectively. However, when focusing on top 1000
significant sites (Fig. 2B), the overlaps between them become very
small. This suggests that the ‘signal’ of differentially methylated sites
in terms of q—value is quite different from each other. The ‘signal’ is
important for the further analysis, such as the pathway analysis
since we often use the filtered gene set, e.g. using top 1000 signifi—
cant sites. We also calculate the Spearman’s rank correlation be—
tween the four methods (D3M, EB, KS and DiffVar) resulting from
q—values (Supplementary Table S7).

Among the detected sites with D3M, we investigated sites with
the smallest 1000 q—value. Heat map and Q—Q plots of the top 1000
sites are shown in Figure 3A and B. Comparing heat maps and Q—Q
plots, the methylation levels are easy to interpret in the latter. From
the Q—Q plot, we could see that the top 1000 sites tend to be hyper—
methylated in LGG (with the reverse in GBM).

Among the top significant 1000 pairs of distributions of GBM
and LGG, we can observe that there are mainly two patterns in
terms of the Q—Q plot. Then, we cluster the 1000 curves in Q—Q
plot into two classes; we consider input data as Z, : (Q,71, Q,72, . . . ,

Q,7K, an1, anz, . . . ,  : 1,2,.. .,1000) and define the dissimi—

larity as (Z, — Z,)2 (1' 7E j) where Q“, and ngk (la : 1,2, . . .,K) is
lath quantile in LGG and GBM group, respectively. Then we apply
the standard hierarchical clustering (Clusters 1 and 2 in Fig. 3A).
Typical distribution examples in each cluster are shown in
Figure 3C. Clusters 1 and 2 contain 715 and 209 sites, respectively.

Next, we perform enrichment analysis on gene sets in clusters 1
and 2. We used ingenuity pathway analysis (IPA) for 444 and 209
genes in clusters 1 and 2, respectively, and significantly enriched
pathways in each cluster using Fisher’s exact test. Table 3 shows five
pathways and related genes with q—values g 10_3 in each cluster.
Other pathways are described in Supplementary files S4 (cluster 1)
and S5 (cluster 2).

The pathways in clusters 1 and 2 include significant pathways in
GBM, which have been previously reported even though we do not
include any information on GBM. The axonal guidance signaling
pathway in cluster 1 has been suggested as prompting the cell inva—
sion of GBM (Hoelzinger et al., 2007) and ERK/MAPK Signaling is
reported to be up—regulated in GBM (Liu et al., 2013). The enrich-
ments of Caveolar—mediated Endocytosis Signaling and Calcium
Signaling are studied in (Dong et al., 2010; Polisetty et al., 2012).
The remaining pathways might be explained elsewhere. Our predic—
tion using D3M provides a hypothesis that DNA methylation in
these pathways might cause the phenotypical difference between
GBM and LGG.

9mg ‘09 1sn3nv uo sojoﬁuv 501 ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IT10[p.IOJXO'SOTmIHJOJUTOTQﬂIdllq 11101; pop1201umoq

2252

Y.Matsui et al.

 

Table 2. Hypothesis testing in each case (hypotheses are described under the method names)

 

 

Type I Power

Case 1 Case 2 Case 3 Case 4 Case 5 Case 6 Case 7 Case 8
D3M Mean 5.12 94.32 95.42 84.52 98.60 84.88 99.12 100.00
H0 : F1 : F2 H1 : F1 7E F2 sd 0.03 0.04 0.03 0.48 0.03 0.05 0.01 0.00
DiffVar Mean 1.80 4.92 93.86 1.30 97.86 11.84 68.26 86.32
H0 : V(F1) : V(F2) H1 : V(F1) 7E V(F2) sd 0.02 0.03 0.04 0.02 0.04 0.04 0.06 0.15
MMD Mean 4.96 100.00 90.58 67.16 98.30 81.24 95.98 82.54
H0 :F1 : F2 H1 : F1 7E F2 sd 0.07 0.00 0.10 0.10 0.14 0.08 0.11 0.17
KS Mean 2.56 99.94 32.06 67.06 76.40 60.22 89.62 75.74
H0 : F1 : F2 H1 : F1 7E F2 sd 0.02 0.00 0.07 0.213 0.07 0.04 0.04 0.23
EB Mean 4.94 0.76 5.18 87.92 0.08 78.50 87.36 96.98
H0 : E(F1) : E(F2) H1 : E(F1) 7E E(F2) sd 0.03 0.01 0.03 0.04 0.00 0.05 0.04 0.05
MWW Mean 4.68 12.00 5.76 84.96 55.42 55.50 83.94 72.76
H0 : M(F1) : M(F2) H1 : M(F1) 7E M(F2) sd 0.03 0.06 0.03 0.05 0.14 0.07 0.05 0.17

 

We focus on a probe and generate beta values, 40 samples each in a case and a control group respectively. We apply six methods to this data and evaluate the

P-value at the signiﬁcance level, i.e. 5%. This process is repeated 50 times and returns the averages of type I error (%) and power (%). We represent the power in

italics within top three. Furthermore, we also evaluate the standard deviations of the averages; we repeated the process of the evaluating average of type I error

and power a 100 times and then obtained the standard deviations of the averages.

A EB KS

 

   

Top 1000 signiﬁcant probes

Fig. 2. Venn diagram of detected sites at the significance level 1% (A) and of top significant 1000 sites (B)

We further focus on Wnt in Human Embryonic Stem Cell
Pluripotency pathway, and then compare the ranking based on P-
value by D3M with those by other methods. The activation of Wnt
family is closely related to cell differentiation of GBM (Rampazzo
et al., 2013). In our analysis, there are 18 Wnt genes on the probes.
Among them, six Wnt genes (Wnt2, Wnt2b, Wnt3, Wnt4, Wnt7a
and Wnt 9a) are included in top 1000 significantly differentially
methylated probes using D3M.

We investigate the enrichment of the six Wnt genes in top 1000
significant probes using Fisher’s exact test and we confirm the en-
richment of the genes (the details are described in Section S-3-3 in
Supplementary file S1). The six Wnt genes are included in both the
clusters 1 and 2, and the majority of the distribution is hypo-
methylated and the minority is hyper-methylated in GBM, vice
versa in LGG. This suggests that demethylation of Wnt might trig-
ger the activation of Wnt family and prompt cell differentiation.

91oz ‘Qg 1sn8nv uo sejeﬁuv s01 ‘etmomeg go Ange/1111f} 112 /3JO'S[BUJHOprOJXO'SODBIlLIOJUTOTQ/ﬂ(1111.1 111011 papeoIUAAoq

 

 

 

 

 

 

 

 

 

 

 

 

  

 

 

Detection of differential distributions 2253
A B
Cluster 2 Cluster 1 a
g a I _ ..
g .
a: [u no on E"
Q) :-
L9
_|
i) z
0' - Mu — Top significanl moo sites
E g - .=-  "d"! Top inslgn-I'icant 1000 sites
8 III-U E'E' Pi- lﬂ- ii- 10
8 GBM
_|
Cluster 2
2
Q.
g (9 <3
(,3 (D (D
_1 PH (farm; .1
E + _ I '3 \N_l_ + .
E5 EE
0 m on
L9 L9

 

Probe

 

 

 

 

 

 

Fig. 3. Distributions of the top 1000 significant probes. (A) The heat map of beta values with 141 LGG and 530 GBM samples at each probe respectively. We jointly
clustered quantiles of LGG and GBM probes into the two clusters based on the Wasserstein metric (i.e. we clustered curves in 0-0 plots of the top significant
probes into two clusters). (B) 0—0 plots of beta values between the LGG and GBM probes (blue lines). D3M detects the probes with hyper-methylated LGG probes
compared with GBM probes. Green lines are the top 1000 insignificant probes (as negative controls). (C) The instances of distributions with Clusters 1 and 2
shown in (A-1) and (A-2), respectively. The distributions appear to be highly heterogeneous especially in LGG probes. D3M recognizes strongly heterogeneous

distributions and detects such probes as top significant probes

The ranking of Wnt genes in D3M, EB, KS and DiffVar is shown in
Table 4.

5 Discussion

Here, we summarize the advantages and disadvantages of D3M,
DiffVar as well as MMD. These methods are designed for detecting
differential methylation levels focusing on cancer heterogeneity,
which is caused by epigenetic instability and diversity. Cancer het—
erogeneity can often be confused with outliers. For example,
DiffVar fails to detect simulation case 6 as differential methylation,
even though we set the variance, but not the mean and the shapes,
to be the same for the two groups. This is because DiffVar deals
with minority distributions as outliers and evaluates only those in
the majority.

In general, the significance of an outlier depends on the context
of analysis (Aggarwal, 2013). When an outlier arises from measure—
ment error not relevant to signals of interest, we must remove them
prior to analysis. In contrast, when an outlier arises from an unusual
event including new findings that we seek, we use them for further
analysis. In this case, cancer heterogeneity could be regarded as an
abnormal event compared with normal cases, and thus must be
included in the analysis.

MMD was originally developed as a distribution—free two sam—
ple test based on a kernel. Both the Wasserstein metric and MMD
are family of integral probability metrics (Muller, 1997) designed to
capture not only such basic difference as those between the means
but also such higher—order differences as those between the distribu—
tion shapes of the groups. From the simulation in Section 3.1, we see
that MMD shows good detection performance in cases except cases
4 and 8. D3M shows good performance over all eight 8 cases.
Specifically, D3M shows excellent performance in cases 7 and 8.

In the study of sample size effect in Section S—2—1, using the same
simulation model as in Section 3.1, the result indicates that the su—
periority of D3M to other methods are reduced compared to large
sample case, although all the methods decrease in power
(Supplementary Table S3). On the contrary, MMD retains its
power in cases 2 and 6, and so does D3M in cases 7 and 8.

We also investigate the power of D3M with other simulation
models using beta distributions considering small sample size in
Section S—2—2 and S—2—3 in Supplementary file S1. The result indi-
cates that MMD detects differences well in the small samples
(11:28) and so do D3M and KS in the moderate sample sizes
(11: 36). In case of unbalanced sample sizes between the case and
control groups, D3 M shows preferable results (Supplementary
Table S5).

91% ‘09 1sn8nv uo sojoﬁuv 501 1111110111123 310 Amie/xtqu 112 /§.IO'SIBLLIHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁ(11111 11101; pop1201umoq

2254

Y.Matsui et al.

 

Table 3. Pathways detected with the proposed method

 

 

Cluster Pathway —log (P—value) Genes
Cluster 1 Axonal guidance signaling 5.85 SLIT3, ITGB1, SEMA3G, MYL10, WNT3, FES, NRP2, BMP8A, UNC5B
WNTZB, PIK3R5, GNAI1, ITGA5, KEL, WNT7A, MAG, ADAM12
NTRKl, PRKAGZ, WNT4, BMP7, NTN3, PRKCB
ERK/MAPK signaling 4.09 ITGB1, DUSP9, PLA2G4B, PRKAGZ, ITGA5, PIK3R5, RAPGEF4, ESR1
PPP2R5 A, KSR1, JMJD7—PLA2G4B, PRKCB
Caveolar—mediated— 3.72 ITGB1, INS, CD48, ITGA5, ITGB8, JMJD7—PLA2G4B, PRKCB

Endocytosis signaling

Human embryonic stem— 3.35
Cell pluripotency

Cluster 2 TREM1 signaling 3.55
Calcium signaling 3.28

WNT7A, WNT3, BMP8A, SMAD3, NTRK1,WNT2B, PIK3R5, WNT4
BMP7

STATSA, MPO, CASPl, NOD1, CCL3, ITGAX

GRINZA, TNNT3, ITPRZ, CHRNBl, NFATC4, CAMKKZ, PPP3 CA
CAMKKZ, PPP3CA, MEFZB

 

Table 4. The ranking of the six Wnt gene probes in 351 932 probes

 

 

Wnt2 Wnt2b Wnt3 Wnt4 Wnt7a Wnt9a
D3M 342 549 591 829 641 887
(0.10) (0.16) (0.17) (0.24) (0.18) (0.25)
EB 22 541 12 914 3246 1811 135 20 747
(6.40) (3.67) (0.92) (0.51) (0.04) (5.90)
KS 4754 91 240 50 174 41 589 41 066 84 248
(1.35) (25.93) (14.26) (11.82) (11.67) (23.94)
DiffVar 56 950 155 621 147 817 146 033 138 928 242 648
(16.18) (44.22) (42.00) (41.49) (39.48) (68.95)

 

For each method, the upper values are the absolute ranking among 351 932 of the genes, and lower are their percentages.

D3M can be flexibly applied to differential methylation prob—
lems. Simulation results indicate that D3M can detect not only shape
differences but also summary statistics differences as effectively as
EB and DiffVar, i.e. natural results from the decomposition (6). This
suggests that if we cannot obtain sufficient power using a simple
summary statistics approach, we have other options to add shape in—
formation. If we would like to simultaneously check the results of
variance and shape differences, we remove the mean from the data
using X — E[X[ in each group at a site before applying D3M. This
option is provided with R package D3M; in the function
D3M::d3m, the logical parameters of rm.mean and rm.var exists. If
we would like to see the variance and shape differences at the same
time, we just set the rm.mean : T and rm.var : F.

The statistical test of D3M relies on resampling and requires
computational time to calculate P—values. However, we could re—
duce the resampling time using a semi—parametric approach
(Knijnenburg et al., 2009).

A current limitation of D3M is that it deals with univariate distri—
butions. In a case of the study of large sample sizes, we can deal
with covariates, such as age and gender, but our method currently
does not incorporate them into the model, and the user needs to re—
move the effects of covariates, for example, using residuals with re—
gression analysis, prior to the analysis. The extension of D3M to
multivariate distribution relies on the estimation of the Wasserstein
metric between the empirical multivariate distributions. The
approximation of the Wasserstein metric between the multivariate
distributions has been studied recently in (Applegate et al., 2011),
and we could derive the null distributions based on that
approximation.

D3M does not support a spatial correlation of methylation levels
within the CpG island in the current form (Eckhardt et al., 2006;
Hansen et al., 2012; Irizarry et al., 2008). The spatial information

will enhance the power of detection for differential methylated sites.
This could be accomplished by spatially weighted average of
Wasserstein distance over a fixed range of locus. These extensions of
D3 M will be covered in a future study.

6 Conclusion

In this study, we proposed a novel method, D3M, for detecting dif—
ferential methylation sites based on distribution—valued data. We
showed that distribution shape includes interesting information
other than that found using mean— and variance—based methods. A
simulation study indicated that D3M is capable to detect various
situations.

In the application to the GBM and LGG dataset in the TCGA co—
hort, we identified 1000 sites with the smallest q—values. Most of the
sites detected by D3M show strong heterogeneity and tend to be
hyper- and hypo—methylated in LGG and GBM, respectively, as
found in previous studies.

Since the GBM and LGG dataset contains a large number of sig—
nificantly different sites, including 279 008, 191 05 0, 297 493 and
255 317 sites for EB, DiffVar, KS, and D3M respectively; at the
FDR g 1%, it is difficult to understand the methylation levels at
these sites. In the future, it would be of interest to develop a method
that describes the diversity of methylation levels.

Acknowledgements

I am grateful to the reviewers. They suggested many useful comments to

improve the manuscript.

Conﬂict of Interest: none declared.

9mg ‘09 1sn8nv uo sojoﬁuv 80’] 1111110111123 310 411819111qu 112 /§.IO'SIBU.IHO[p.IOJXO'SODBIHJOJUTOTCWZdllq 11101; pop1201umoq

Detection of differential distributions

2255

 

References

Aggarwal,C.C. (2013) Outlier Analysis. Springer, New York.

Applegate,D. et al. (2011) Unsupervised Clustering of Multidimensional
Distributions Using Earth Mover Distance. In: Proceedings of the 17th
ACM SI GKDD International Conference on Knowledge Discovery and
Data Mining, pp. 636—644. ACM.

Baylin,S.B. (2005) DNA methylation and gene silencing in cancer. Nat. Rev.
Clin. Oncol., 2, S4—81 1.

Benjamini,Y. and Hochberg,Y. (1995 ) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. B, 57,
289—300.

B0ck,H.H. and Diday,E. (2000) Analysis of Symbolic Data. Springer, Berlin,
Heidelberg.

Diday,E. (1989) Introduction a l’analyse des donnees symboliques. RR-1074,
inria-00075485.

D0ng,H. et al. (2010) Integrated analysis of mutations, miRNA and mRNA
expression in glioblastoma. BMC Syst. Biol., 4, 163.

Du,P. et al. (2010) Comparison of beta-value and M-Value methods for
quantifying methylation levels by microarray analysis. BMC
Bioinformatics, 11, 587.

Eckhardt,F. et al. (2006) DNA methylation proﬁling of human chromosomes
6, 20 and 22. Nat. Genet., 38, 1378—13 85.

Gretton,A. et al. (2012) A Kernel two-sample test. ]. Mach. Learn. Res., 13,
723—773.

Gretton,A. et al. (2006 ) A Kernel Method for the Two-Sample-Problem. NIPS
2006.

Hansen,K.D. et al. (2012) BSmooth: from Whole genome bisulﬁte sequencing
reads to differentially methylated regions. Genome Biol., 13, R83.

Hoelzinger,D.B. et al. (2007) Autocrine factors that sustain glioma invasion
and paracrine biology in the brain microenvironment. ]. Natl. Cancer. Inst.,
99, 1583—1593.

Irizarry,R.A. et al. (2008) Comprehensive high-throughput arrays for relative
methylation (CHARM). Genome Res., 18, 780—790.

Irpino,A. and Verde,R. (2014) Basic statistics for distributional symbolic vari-
ables: a new metric-based approach. Adv. Data Anal. Classiﬁ, 9, 143—175.
Knijnenburg,T.A. et al. (2009) Fewer permutations, more accurate P-Values.

Bioinformatics, 25, i161—i168. ISMB (2009).

Kulis,M. and Esteller,M. (2010) DNA methylation and cancer. Adv. Genet.,
70, 27—5 6.

Leek,].T. et al. (2012) The sva package for removing batch effects and other
unwanted variation in high-throughput experiments. Bioinformatics, 28,
882—883.

Liu,T. et al. (2013) Transcriptional signaling pathways inversely regulated in
Alzheimer’s disease and glioblastoma multiform. Sci. Rep., 3, doi:10.1038/
srep03467.

Muller,A. (1997) Integral probability metrics and their generating classes of
functions. Adv. Appl. Prob, 29, 429—443.

Phipson,B. and Oshlack,A. (2014) DiffVar: a new method for detecting differ-
ential variability with application to methylation in cancer and aging.
Genome Biol., 15, 465.

Polisetty,R.V. et al. (2012) LC-MS/MS analysis of differentially expressed
glioblastoma membrane proteome reveals altered calcium signalling and
other protein groups of regulatory functions. Mol. Cell Proteomics, 11,
M111.013565.

Rampazzo,E. et al. (2013) Wnt activation promotes neuronal differentiation
of Glioblastoma. Cell Death Dis., 4, 500e.

Ramsay,].O. and Silverman,B.W. (2005 ) Functional Data Analysis. 2nd ed.
Springer-Verlag, New York.

Ritch,P.A. et al. (2003) Neuregulin-l enhances motility and migration of
human astrocytic glioma cells. ]. Biol. Chem., 278, 20971—20978.

Ritchie,M.E. et al. (2015) limma powers differential expression analyses for
RNA-sequencing and microarray studies. Nucleic Acids Res., 43, e47.

Rueshendorff,L. (2011) Wasserstein metric. Encyclopedia of Mathematics.
http://WWW.encyclopediaofmath.org/index.phpPtitle:About&oldid=20414.

Stacklies,W. et al. (2007) pcaMethods — a Bioconductor package
providing PCA methods for incomplete data. Bioinformatics, 23,
1164—1167.

The Cancer Genome Atlas Research Network. (2008) Comprehensive gen-
omic characterization deﬁnes human glioblastoma genes and core path-
ways. Nature, 455, 1061—1068.

Wang,H. and Marron,].S. (2007) Object oriented data analysis: sets of trees.
Ann. Stat., 35, 1849—1873.

Wang,D. et al. (2012) IMA: an R package for high-throughput analysis
of Illumina’s 450K Inﬁnium methylation data. Bioinformatics, 28,
729—730.

91% ‘09 1sn8nv uo sojoﬁuv SO’] ‘121u10111123 aIo 411819111qu 112 /§.IO'SIBU.IHO[p.IOJXO'SODBIHJOJUTOTCWZdllq 11101; pop1201umoq

