Bioinformatics, 31 (17), 2015, 2761—2769

doi: 10.1093/bioinformatics/btv293

Advance Access Publication Date: 7 May 2015
Original Paper

 

Genome analysis

Using combined evidence from replicates to
evaluate ChlP-seq peaks

Vahid Jalili‘, Matteo Matteucci‘, Marco Masseroli1 and
Marco J. Morelli2'*

1Dipartimento di Elettronica, lnformazione e Bioingegneria, Politecnico di Milano, 20133, Milan, Italy and 2Center
for Genomic Science of IIT@SEMM, lstituto ltaliano di Tecnologia (IIT), 20139 Milan, Italy

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on August 6, 2014; revised on April 24, 2015; accepted on May 4, 2015

Abstract

Motivation: Chromatin lmmunoprecipitation followed by sequencing (ChlP-seq) detects genome-
wide DNA—protein interactions and chromatin modifications, returning enriched regions (ERs), usu-
ally associated with a significance score. Moderately significant interactions can correspond to true,
weak interactions, or to false positives; replicates of a ChlP—seq experiment can provide co-localised
evidence to decide between the two cases. We designed a general methodological framework to
rigorously combine the evidence of ERs in ChlP—seq replicates, with the option to set a significance
threshold on the repeated evidence and a minimum number of samples bearing this evidence.
Results: We applied our method to Myc transcription factor ChlP-seq datasets in K562 cells avail-
able in the ENCODE project. Using replicates, we could extend up to 3 times the ER number with re-
spect to single-sample analysis with equivalent significance threshold. We validated the ’rescued’
ERs by checking for the overlap with open chromatin regions and for the enrichment of the motif
that Myc binds with strongest affinity; we compared our results with alternative methods (IDR and
jMOSAiCS), obtaining more validated peaks than the former and less peaks than latter, but with a
better validation.

Availability and implementation: An implementation of the proposed method and its source code
under GPLv3 license are freely available at http://www.bioinformatics.deib.polimi.it/MSPC/ and
http://mspc.codeplex.com/, respectively.

Contact: marco.morelli@iit.it

Supplementary information: Supplementary Material are available at Bioinformatics online.

 

1 Introduction

 

Chromatin immunoprecipitation followed by next-generation
sequencing (ChIP-seq) is the most commonly used method to study
genome-wide chromatin modifications or protein—DNA interactions.
Computational tools like MACS (Zhang et al., 2008) or ZINBA
(Rashid et al., 2011) are applied on aligned ChIP-seq reads to detect
enriched regions (ERs) over the genome (often called ‘peaks’), where
the local accumulation of sequencing fragments exceeds that of a
background distribution, typically estimated from randomly frag-
mented chromatin or by performing the ChIP-seq protocol with a

control antibody (Bailey et al., 2013). As the protocol is subjected to
multiple sources of noise (Chen et al., 2012), some low-intensity accu-
mulation of reads is possible even in absence of a true interaction with
the target. These low-intensity peaks, which are usually present in
large amounts, contain therefore a mixture of false positives and true,
although weak, interactions; they are typically discarded when strin-
gent thresholds on the peak call are used. This approach leads to the
discovery of the strongest interactions only, and might distort the gen-
ome-wide picture of the genomic locations of the transcription factor
binding sites or histone modifications of interest.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2751

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘eiulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuoguroiq/ﬁdnq mog pepeolumoq

2762

V.Jalili et al.

 

Given the intrinsic noise of the ChIP-seq protocol, it is good prac-
tice to repeat every experiment at least twice, as the guidelines of the
ENCODE project indicate (Landt et al., 2012). The information con-
tained in replicates can then be used to assess the validity of the peaks
obtained from a single sample, especially of those with low-intensity.

In this paper, we propose a novel method to rigorously combine
the results of peak calls in ChIP-seq replicates and to obtain new, sam-
ple-specific, peak lists taking into account their combined evidence.
Our method takes as input, for each replicate, a list of enriched gen-
omic regions and a measure of their individual significance in terms of
a P-value. Starting from a permissive call, we divide the initial ERs in
‘stringent’ (highly significant) and ‘weak’ (moderately significant), and
we assess the presence of overlapping enriched regions across multiple
replicates. Non-overlapping regions can be penalised or discarded ac-
cording to specific needs. The significance of the overlapping regions
is rigorously combined with the Fisher’s method to obtain a global
score. Finally, this score is assessed against an adjustable threshold on
the combined evidence, and peaks in each replicate are either con-
firmed or discarded (a schematic view of our method is given in Fig. 1
and a visualisation of the results of the method on data from the
ENCODE project is shown in Fig. 2). In other words, we are able to
‘rescue’ weak peaks, which would probably be discarded in a single-
sample analysis, when their combined evidence across multiple sam-
ples is sufficiently strong.

We applied our method to ENCODE datasets from ChIP-seq ex-
periments of the Myc transcription factor in KS 62 human cells, for
which multiple samples with replicates are available. As Myc prefer-
entially binds to a well-defined motif, the choice of this TF allowed
us to validate our results through motif analysis and DNase-seq
data; finally, we compared our findings with other state-of—art meth-
ods. The strong aspects of our method, besides the validity and rele-
vance of the results that it provides, are its simplicity and flexibility,
together with its efficiency (few minutes for 2—3 replicates with a
few tens of thousands of peaks each).

2 Methods

Here, a brief description of the method and datasets used is given.
For more details, see the Extended Methods section in the
Supplementary Material.

2.1 Data collection and peak calling

ChIP-seq enriched regions are read from data files in standard
Browser Extensible Data (BED) format; besides standard ER format
specifications (columns ‘chromosome’, ‘start’, ‘end’, ‘ID’), we re-
quire a P-value quantifying the significance of each ER, which is
usually computed by the peak caller used to identify the ER.

Binary Alignment/Map (BAM) files for the transcription factor
Myc in human K562 cells (myelogenous leukaemia) were taken
from the ENCODE project repository, for a total of 15 samples ob-
tained in 7 different experiments as summarised in Table 1. Each
experiment contained 2 or 3 biological replicates of the same ChIP-
seq. Technical replicates were artificially created to test our method,
as they were not directly available in the ENCODE repository.
Technical replicates were obtained by merging the ENCODE align-
ment files relative to biological replicates for each of the seven con-
ditions considered above, and then by randomly splitting their reads
in two new alignment files. Details about technical replicates, and
the process used to generate them, are collected in the
Supplementary Table S1.

 

I
IMIIII' IﬁﬁlﬁI IHFHI'II I395“! IEHIPI'II
H3c3_1
In "1 ' I I IIIMImd I ml In MI“ II III I“ IIIHIHI
ﬂyc3_1_5tringant_ﬁ'anks
m3_1_ﬂeak_canﬂ madj'eakl

"393.2
II II IIII I IIII II'III IIIII ntII IIIII I II IIIII

ch3_1_ﬁtringent_Ee-akn
Case 1 Case 1
quJ_;_ﬂilk_Eunfiruuﬂ_?itks

nunue-Bnq

-2L_.._..LII..- ..n...l

Fig. 2. Genome browser view of a result of the proposed method. Tracks for
two ChIP-seq replicates are shown along with the position of the stringent
peaks, the weak peaks confirmed by our method and the open chromatin re-
gions (measured as DNase-seq enriched regions). Case 1 refers to a weak
peak rescued by a stringent peak, while Case 2 refers to two weak peaks vali-
dating each other

 

 

 

 

 

 

 

 

 

Single Multiple
Sample Samples
St‘
ﬁngent Conﬁnned
Peaks
Peaks
--..
VUeak _
Peaks Dlscarded
Peaks

 

 

 

 

 

 

 

Fig. 1. Pictorial schematic view of the proposed method. First, with a permissive call, we divide peaks of a single individual sample in stringent and weak. Then,
combining the evidence of multiple replicates, the peaks in each replicate are confirmed or discarded

9mg ‘09 isnﬁnV uo sejeﬁuV socl ‘eiulomeg JO AirSJeAru [1 112 [3.10811211an[plOJXO'SODBIILIOJIIfOfQ/ﬂ(11111 mog pepeolumoq

Combining replicate ChIP-seqs

2763

 

Table 1. ENCODE alignment files used and their quantitative
features

 

Sample name Short Aligned R5 R‘”
name reads

 

ngncodeOpenChromChip Myc1_1 10 719 209 19 171 287 651

K5 62CmycAlnRep1

ngncodeOpenChromChip Myc1_2 8 763 362 32 850 311 409
K5 62CmycAlnRep2

ngncodeOpenChromChip Myc1_3 9 649 688 13 623 104 911
K5 62CmycAlnRep3

ngncodeSythfbs Myc2_1 17 507 194 42 456 64 016
K5 62CmychgrabAlnRep1

ngncodeSythfbs Myc2_2 22 256 240 33 015 54 773
K5 62CmychgrabAlnRep2

ngncodeSythfbs Myc3_1 6 077 198 5473 22 965
K5 62CmycStdAlnRep1

ngncodeSythfbs Myc3_2 5 897 211 12 832 18 753
K5 62CmycStdAlnRep2

ngncodeSythfbs Ifna30_1 10 115 596 1901 13 654
K5 62CmycIfna3 OStdAlnRep1

ngncodeSythfbs Ifna30_2 18 600 414 2527 97 620
K5 62CmycIfna3 OStdAlnRep2

ngncodeSythfbs Ifna6h_1 9 377 798 5852 12 087
K5 62CmycIfna6hStdAlnRep1

ngncodeSythfbs Ifna6h_2 19 334 518 4547 102 168
K5 62CmycIfna6hStdAlnRep2

ngncodeSythfbs Ifng30_1 11 602 299 8227 13 190
K5 62CmycIfng3 OStdAlnRep1

ngncodeSythfbs Ifng30_2 16 666 560 30 524 25 484
K5 62CmycIfng3 OStdAlnRep2

ngncodeSythfbs Ifng6h_1 14 019 564 2485 13 376
K5 62CmycIfng6hStdAlnRep1

ngncodeSythfbs Ifng6h_2 19 666 823 27 728 25 118

K5 62CmycIfng6hStdAlnRep2

 

Peaks were called with the software package MACSZ. R‘: stringent ER set
(ERs with P-value <T’). R’”: weak ER set (ERs with TSP-value<T”).
7‘: 10-8, W: 10—4.

Peak calling was performed with the software package MACSZ
(Zhang et al., 2008) with the following parameters: ‘—auto-bimodal
-p 0.0001 -g hs’ (thus setting a p-value threshold of 104‘), using
alignment files available in the ENCODE repository, together with
the corresponding background (standard input for all samples ex-
cept for Myc2, for which the input signal from rabbit IgG ChIP-seq
was used). In each sample-input pair, the total number of reads was
made equal by randomly down-sampling the largest alignment file.
The performed call determined between ~15 k and N345 k peaks
across the different samples (see Table 1).

2.2 Definitions

Given a set of ] replicates, each sample 7' is associated with a set R,- of
I enriched regions 17,-: Rf: {171, 172, . . ., 17,-, . . ., 171}. Each region r],- is
defined by (chromosomeﬁ, startﬁ, endﬁ, ID,-,-, pﬁ), where pi,- denotes a
measure of the significance of r],- (i.e. its P-value). Ts is a stringent
threshold on P-values, defining a set Rf of stringent (highly en-
riched) ERs; Rf: 17,- E Rf  pi,- < Ts. Similarly, we define a set R,” of
weak (moderately enriched) ERs, containing all regions whose P-
value is between TS and a weak threshold T”, with T” > T’, i.e. Rf”:
r],- E R,”  ngpﬁ< T”. Clearly, R,” D Rf: Q and, if T” is the
maximum P-value allowed for an ER to be associated with sample 7',
R/UU R; = R,

For each region 2' of each sample 7', let 17,-};a denote the region of
sample k overlapping with 17,-, if any. If sample k has multiple re-
gions overlapping with 17,-, we choose the most significant one, i.e.
the one with the lowest p-value. Let Rf,- be the collection of 17,-};a for
k E { 1, . . ., f}, including 17,- itself. Let K = |R,-,-,*| be the cardinality of
Riv, the set of the ERs intersecting with 17,-, with 1 3K3] by
definition.

We distinguish between technical and biological replicates of an
experiment. Technical replicates aim at controlling the variability of
the experimental procedure used to obtain the data and should yield
exactly the same results in absence of experimental noise. In a ChIP-
seq experiment, this corresponds to performing multiple times the
same ChIP protocol on the same biological sample, followed by in-
dependent sequencing on the same platform; we expect to observe a
significant overlap between ER lists in these samples. Conversely,
biological replicates are obtained by applying the same protocol on
biologically equivalent samples, what could give rise to different
binding profiles of a transcription factor, as in the case of tumor
samples; here, the variability in the data can also stem from the
‘true’ biological variation of the phenomenon of interest.
Consequently, the lack of overlap between ERs in biological repli-
cates does not necessarily correspond to a false positive result, as it
could reflect a true biological interaction occurring only in some
samples. With our method, the user is able to control for the
required level of overlap and combined significance, according to
the specificities of the dataset.

2.3 Algorithm: overall procedure

The main idea behind our method is that repeated evidence across
replicates can compensate for a lower significance in a single sample,
which is implemented through the Fisher’s method. The Fisher’s
method combines the P-values of each test in a global test statistics
that follows a chi-squared distribution with 2 k degrees of freedom
(where k is the number of tests combined); therefore, it can be used
to falsify the statement ‘all null hypotheses are true’, i.e. ‘all overlap-
ping ERs are due to background noise’. Comparing intersecting ERs
from a set of ] replicates is equivalent to test the same genomic re-
gion in independent experiments against the same null hypothesis
H0, i.e. ‘the number of reads in the region under study is sampled
from the background distribution’, and obtaining independent prob-
abilities of rejecting H0 (i.e. independent P-values). Here, we brieﬂy
outline the structure and motivation of our algorithm, following the
ﬂowchart given in Figure 3, while we discuss its details in the
Extended Methods (data structures, search algorithms and combin-
ing test statistics sections).

We assign every ER 1'],- in a given sample 7' to either Rf or R,” ac-
cording to its significance. For a given ER, we then determine Rﬁg
as the set of ERs in the replicates that overlap with 17,-, including 17,- it-
self (see Definitions subsection). The cardinality K of R1,; * represents
a measure of the reproducibility of the signal in the region spanned
by 17,-, while the significance of 17,-};a E R1,; is a measure of the inten-
sity of the signal in a specific replicate k, given the background. We
rigorously combine the significance of the overlapping ERs in Riv
with the Fisher’s method, as described in the Extended Methods,
and define a new score for their combined evidence pjfom". Then,
we compare this new score with an adjustable threshold )2: if the
desired stringency is obtained, we assign r],- to the set Rf of con-
firmed peaks for sample 7'; if the condition is not met, i.e. the com-
bined evidence is not strong enough, we assign r],- to the set R,” of
discarded peaks for sample 7'. All the ERs in R1,; are assigned to the
corresponding confirmed Rk” or discarded R k” set, respectively.

9mg ‘09 isnﬁnV uo sejeﬁuV socl ‘eiulomeg JO AirSJeAru [1 112 /810'S{12umo[pJOJXO'sopeuuoguroiq/ﬁdnq mog pepeolumoq

2764

V.Jalili et al.

 

START

|J=.L‘|

un _
up I

_-_.,—m  <5

 

 

I
111

 ._...._._

i=i+i  II"=-5'HIIH:-vr} I
I Find li',-,-_.
| I

l Ell-=RJEIII-[Rn'rnﬁlu] l l r." EI'IIT "a Q
‘ no
TEE :

Fig. 3. Flowchart of the proposed method. For the definition of the symbols,
see the Definitions subsection ofthe Methods

 

 

We leave the possibility to distrust a region rﬁ, regardless of its
significance, when it is not backed up by the presence of overlapping
ERs in a minimum number of samples C. C is an adjustable param-
eter ranging between 1 and ], with different default values for biolo-
gical and technical replicates. In summary, for a given sample 7',
Ric: {Tji I PﬁcombSV /\ (K2 CH and Rid: {Tji I (sz‘comb > 1’) V
(K < C) }. We repeat this procedure for each sample.

We note that an ER can participate in different sets of overlap-
ping regions, as we discuss in detail in the Extended Methods. As a
consequence, it is possible that an ER is assigned to both the con-
firmed and discarded sets as a result of different tests. These peaks
are assigned to the confirmed set if replicates are biological and to
the discarded set if replicates are technical. In other words, as tech-
nical replicates are supposed to be very similar, for an ER it is
enough to fail the test once to be removed from the confirmed set,
while for biological replicates this condition is relaxed and it is
enough to pass the test at least once for an ER to be confirmed.

After applying the proposed method, each peak has two proper-
ties: its initial significance, which can be either stringent (s) or weak
(w), and the result of the multiple replicate comparison, which can
be either confirmed (c) or discarded (d). Then, for each sample we
define four mutually exclusive sets on the basis of these property val-
ues: RS’C, Ru“, Rad, R“, with Rcst" U RW and Rdst’d U
R‘”“‘. The final output set Rio of each sample 7' is obtained by apply-
ing the Benjamini—Hochberg correction procedure to Rf, independ-
ently from the choice of the other parameters, in order to account
for multiple testing (Benjamini and Hochberg, 1995), and keeping
only the ERs with false discovery rate smaller than an adjustable

threshold or.

2.4 Validation

In order to validate the peaks obtained after combining replicates,
we first checked whether the peaks we rescued fell within open chro-
matin by intersecting their genomic coordinates with enriched

regions in DNase-seq data obtained from ENCODE (see Extended
Methods). Then, we looked for enriched motifs in the nucleotide se-
quences spanned by the sets of ERs that we obtained. To perform
motif analysis, we used the software package DREME (Bailey,
2011) with parameters ‘-e 0.00001 -m 10’. Results were scored
against the JASPAR database (Mathelier et al., 2014) using the soft-
ware package TOMTOM (Gupta et al., 2007). Myc strongly binds
to one specific motif, called the canonical Enhancer-box or E-box,
corresponding to the Position Weight Matrices (PWMs) MA0058
(MAX), MA0059 (MYszMAX), MA0093 (USF1), MA0104
(Mycn) and MAO 147 (Myc) in the Jaspar Core Vertebrata database
(the corresponding sequence logos are shown in the Supplementary
Fig. S1); thus, an ER set is validated when at least one of these
PWMs is found significantly enriched in the ER set. We note that
Myc has a weaker affinity for other versions of the E-box, but we
chose to exclude these other motifs from the validation to achieve
maximum stringency.

2.5 Comparison with other methods
Irreproducibility Discovery Rate (IDR) (Li et al., 2011). It is a met-
ric quantifying the reproducibility of a peak across two ChIP-seq
replicates by comparing the two lists of ERs, ranked according to
their significance. In essence, after calling the peaks, the IDR pipe-
line uses a bivariate rank distribution to separate the signal (repro-
ducible peaks) from noise (irreproducible peaks) in an experiment
(or pairwise comparison). Each peak is associated with an IDR
value, which quantifies the probability that the peak belongs to the
irreproducible set. IDR was computed for our validation with the
scripts provided by Anshul Kundaje at the URL https://sites.google.
com/site/anshulkundaje/projects/idr

jMOSAiCS (Zeng et al., 2013). It is a generic tool for joint ana-
lysis of multiple ChIP-seq samples, which can be also used to find
common patterns of enrichment between ChIP-seq replicates. First,
the MOSAiCS peak caller pre-processes replicates and correspond-
ing control samples by binning the mapped read counts on the gen-
ome (default width of 200 bp), and applies the MOSAiCS model fit
to each replicate-control pair individually. Afterwards, the
jMOSAiCS model is applied to the data fitted with MOSAiCS: re-
gion-specific enrichment patterns are determined by posterior prob-
abilities assigned to the internal variables, and a binary variable
denotes the potential enrichment of a region based on dependencies
among samples. jMOSAiCS was executed with default parameter
values as described at http://www.bioconductor.org/packages/re
lease/bioc/vignettes/jmosaics/inst/doc/jmosaics.R. The complete
script is included in the Extended Methods.

3 Results

In this section, we report the results obtained by applying our
method on either technical or biological ChIP-seq replicates. The
method takes as input the genomic coordinates and a measure of sig-
nificance (i.e. the P-value) of each of the ERs for each replicate con-
sidered. For each input sample 7', it outputs the lists of confirmed
(RI-O) and discarded (RI-d) ERs, as well as the lists of stringent con-
firmed (RS’C), weak confirmed (Rw’c), stringent discarded (Rs’d) and
weak discarded (Rw’d) ERs.

Adjustable parameters of the method are: T5 (maximum P-value
to consider a peak as ‘stringent’), T” (maximum P-value to consider
a peak as ‘weak’), C (minimum number of samples with intersecting
peaks needed to apply the combined evidence evaluation), )2 (max-
imum combined significance to confirm a peak), or (maximum false

9mg ‘09 isnﬁnV uo sejeﬁuV socl ‘eiulomeg JO AirSJeAru [1 112 /810'S{12umo[pJOJXO'sopeuuoguroiq/ﬁdnq mog pepeolumoq

Combining replicate ChIP-seqs

2765

 

discovery rate after the Benjamini-Hochberg correction), together
with the choice of ‘technical replicate’ versus ‘biological replicate’
mode. For our evaluations we used: T5 2 10‘8, T” 2 104‘, y 2 10‘8,
(x = 0.05 for all comparisons, C = 1 for biological replicates and
C = ] for technical replicates. Required time was a few minutes for 2
samples with 100 000 peaks each on a standard desktop computer.

3.1 Technical replicates

Technical replicates are used to evaluate and remove the noise intro-
duced in the experimental procedure. In the case of ChIP-seq experi-
ments, they are usually generated by performing the same ChIP
protocol on the same biological sample, and then performing the
sequencing independently. As the ENCODE datasets include only
biological replicates, we tested our method on artificial technical
replicates, simulated as described in the Methods section. Details
about these samples can be found in the Supplementary Table S1.
An alternative to our strategy to generate technical replicates would
be to randomly split the reads in each original alignment file in repli-
cates rather than merging biological replicates in ENCODE first.
However, this procedure gives rise to a much poorer signal, prevent-
ing the identification of most ERs. The statistics of these alternative
technical replicates are described in the Supplementary Table 52.

Results for T5 2 10‘8, T” 2 104‘, y = T’, a = 0.05 and C: 2 are
shown in Figure 4. For each replicate sample (panels A—G), we show
two bars: the left bar (SS) represents the peaks called in a single-
sample analysis (RS in light gray and R” in dark grey), while the
right bar (MS) classifies the same peaks, according to the output of
our algorithm, in the four sets described above: RS" (light gray), Rw’”
(medium-light grey), Rs’d (medium-dark grey) and Rw’d (dark grey).

As expected, the number of RS stringent and Rw weak peaks
called in the same technical replicates is always very similar, even if
the absolute numbers differ significantly across the different condi-
tions considered. Each output set has a consistent fraction of Ru“
weak confirmed ERs, which ranges from 20% to 98% (mean 46%,
standard deviation 30%) of the starting number of stringent peaks
(Rw’c / RS, panel H); thus by combining evidence in replicates, our
method ‘rescues’ (i.e. confirms) a large amount of weak co-localised
peaks that would otherwise be discarded through a usual single sam-
ple evaluation. The percentage of stringent discarded peaks (Rs’d /
RS, panel H) is very low and varies from 0% in Myc2 to 12% in
Myc3 (mean 5.6%, standard deviation 3.8%). The output set R0
corresponds to the set of confirmed peaks Rcst’” U Rw’”, where
the significance of each peak has been adjusted for multiple testing;
combining the evidence present in replicates increases the number of
obtained peaks up to almost the double of what obtained with a sin-
gle sample at the same stringency (RO/ RS, panel H).

For technical replicates, we expect the output of each replicate to
be similar, and therefore the parameter C was set to C = ] = 2 for all
technical replicate comparisons. Setting C = 1 would be instead
equivalent to trust even isolated peaks, which are not present in the
other replicate. With the latter choice, and y 2 TS, no stringent peaks
would be discarded.

As a preliminary evaluation of the results obtained, we con-
sidered the overlap of the peaks with the enriched regions in
DNase-seq data. On average, 95.4% of the peaks in R", 95.4%
of peaks in RS and 94.6% of peaks in R‘”" were in open chroma-
tin regions, while this fraction was only 89.4% for R“ and
93.0% for Rw’d (Supplementary Table S3). The overlap with
open chromatin, however, is not yet a validation of a specific
binding event. We performed then motif analysis on the nucleo-
tide sequences corresponding to the ERs in the four sets: R5, R0,

Ru“ and Rs’d. Myc is known to bind a large number of sites on
the DNA, particularly with high affinity to those with the 6-nu-
cleotide motif called Enhancer-box or E-box. This protein-bind-
ing region has the generic consensus nucleotide sequence
CANNTG (with N representing any nucleotide; Murre et al.,
1989). In particular, Myc binds with maximum strength to the
CACGTG motif (also called the ‘canonical’ Myc E-box [Walhout
et al., 1997]). Therefore, we consider the enrichment of the E-
box in a set of peaks a sufficient condition to consider the set as
containing ‘true’ binding sites. Panel I in Figure 4 shows that the
E-box is always enriched in the RS stringent and R0 output sets,
as well as in the Rw’” weak confirmed set. This result confirms
that in the large majority of cases the weak peaks overlapping in
replicates identify real binding sites, which are missed by a strin-
gent single-sample call. In 4 out of 14 cases, the Rs’d stringent
discarded set is enriched for the E-box, although at much lower
significance (Supplementary Table S5), while in the remaining
cases the number of peaks in the Rs’d set is low. This analysis sug-
gests that the default value C 2] used for our artificial technical
replicates may be too conservative and still discards a small frac-
tion of real binding sites.

3.2 Biological replicates

The ENCODE data repository always includes one or more biolo-
gical replicates for each ChIP-seq experiment. For the transcription
factor Myc, multiple data sources are available, either obtained in
independent experiments, or scored against different backgrounds
(in Myc2, the input was derived from immune-precipitating normal
rabbit IgG, while in all the other samples the standard input for the
K5 62 cell line was used). We applied our method to biological repli-
cates obtained from each of the ENCODE experiments considered,
and we also combined replicates from 2 experiments (Myc2 and
Myc3). Parameters for the method were the same as for the technical
replicate evaluation reported in the previous section (i.e. TS 2 10‘8,
T”: 104‘, y = T’, or: 0.05); for the additional parameter C, in the
case of biological replicates we adopted the permissive choice of
C: 1 (default for the analysis of biological replicates). With these
values (i.e. y 2 TS and C = 1), our method never discards a stringent
peak (we consider that a single strong evidence is enough for biolo-
gical replicate evaluation). Results are shown in Figure 5.

The number of peaks in biological replicates of the same experi-
ment can be very different (panels A-H), reflecting the different effi-
ciency of the ChIP-seq protocol, and the number of weak peaks (Rw)
is usually much larger than the number of stringent peaks (RS). In
the considered cases, the number of confirmed weak peaks (Rw’c) is
often much bigger (up to N4 times) than the number of stringent
peaks (RS) (column Rw’clRS in panel I), confirming that the evidence
in a ‘good’ replicate allows the rescue of many peaks in a ‘bad’ repli-
cate. We observe a similar situation when we combine samples ob-
tained with different inputs. For example, by combining together
the four replicates of the Myc2 and Myc3 cases (panel D), we in-
crease massively the number of peaks in the output set for the sam-
ples with lower peak counts (Myc3) by confirming a number of their
weak peaks much larger than in the evaluation performed without
Myc2. Therefore, the presence of high-quality replicates can be of
great help in improving the call on many low-quality replicates. The
average overlap with open chromatin regions of the Ru“ weak con-
firmed sets is 91.0% (compared with the 51.6% for the weak dis-
carded peaks), and motif analysis confirms that in all the samples
the ERs contain the canonical Myc binding site (panel J and
Supplementary Tables S6 and S8).

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 JO A1iSJeAiuf1 112 [BJO'SIBILIHO[p.IOJXO'SODBIIHOJIIIOIQ/ﬂ(11111 111011 pepeolumoq

V.Jalili et al.

 

 

 

 

 

 

 

 

 

 

 

 

 

     

 

 

 

 

 

2766
A Myc1 B Myc2
_ _ 83 MS 53 MB
In D a: a
e  as MS as MS a: S —
3 E 3
E - "E -
'15 I: '5 c:
D 3 - ﬂ 8 -
E a E a
z _ 2 _
CI - I: -
Flep1 Flep‘l Repﬂ Rape Hep1 Flep1 Rape Rep2
D Ifnaaﬂ E lfnaﬁh
g _ E 5": E "    
ca - “1,1: In -
"3'3 “3' _ I e,d "é ‘9 _
E — “E a
E 3 _ as MS as as E 3 _
E E
THHHigg
_ Rep1 Rep'l Rep2 FiepE I: _ Rep1 Rep1 FtepE Rep?
F Ifngaﬂ G IIngsh
1:! CI
3 - as MS as MS 8 -
3 8
3‘2 - E -
g D E I:
113- 11%- as MS as MS
“:5 a “a
e a e g
S a E .8:
D _ Rep1 Rep'l Rep2 Hep? D _ Rep1 Rep1 FtepE Rep?

 

c Myc3

e“—

a?

“E _

mi:

eg-

5' _ as MS as MS
iDDED

Rept Hepi FlepE FIepE

 

55: Single Sample

MS: Multiple Sample

s.c: stringent conﬁrmed peaks
w.c: weak confirmed peaks
s,I:|: stringent discarded peaks
and: weak discarded peaks

 

 

 

H I

  

£1.43 £1.02

I124 ODD

{12? D. 12
a

Ifnaﬂﬂ b . £1.31 Ill]?
a

I: . 1196 BLUE
3

1.13 {12!} BLUE
a
1.16 {123 Dan?

 

Fig. 4. Technical replicates. For each of the 7 experiments considered, two technical replicates were obtained by pooling reads from the biological replicates of
the conditions and then randomly splitting the resulting alignment files in two equal parts. A-G: ER sets for the technical replicates considered. 88, single sample
analysis; MS, multiple sample analysis. In each panel, the SS stacked bars represent Rs (light gray) and RW (dark grey) in the two replicates, while the MS
bars show the same peaks, confirmed or discarded according to the output of our method: I?” (light gray), RW'C (medium-light gray), Rs'd (medium-dark gray) and
R""'” (dark grey). H, general statistics on the cardinality of the ER sets; I, validation of the sets with the Myc binding motif (Myc canonical E-box); 'Y’, presence of
the E-box; '-', set too small to find any enriched motif. See Supplementary Table 85 for E-box enrichment P—values

We applied our method also using C = 2 on all biological repli-
cates considered: most of the times that the Rs’d stringent discarded
peak set had a substantial size, the E-box motif was present, al-
though the average overlap with open chromatin was only 75.9%
(Supplementary Fig. S2 and Tables S9 and S11). This further con-
firms that, in biological replicates, a lack of overlapping with peaks
in other replicates does not necessarily correspond to an artifactual
interaction.

3.3 Comparison with alternative strategies

3.3.1 Alignment read merging

An intuitive way to combine evidence in replicates is to merge the
alignment reads, and use a peak caller on the combined data. As the
combined dataset corresponds to the sum of the two signals, weak,
co-occurring peaks should increase their significance. We have
merged alignment files from replicates for each considered experi-
ment, using merged backgrounds when available (Myc3 only), and
considered only peaks with P-value smaller than Ts: 10‘8. In al-
most all the cases, the number of peaks called from the merged repli-
cates was substantially lower than the number of peaks obtained by

our algorithm (Table 2, third and fourth columns). Moreover, a
large fraction of the peaks detected in the merged samples over-
lapped with at least one of the peaks obtained by our method
(Table 2, fifth column). The only cases when this fraction was below
70% were those where the replicates exhibited a very large differ-
ence in the number of called peaks (Myc3, Ifng30, Ifng6h). In these
cases, the output set of the replicate with the higher number of peaks
always showed a very high overlap with the merged sample peaks.
Merging the alignment files therefore ‘averages’ replicates with dif-
ferent sets of peaks, whereas our method ‘rescues’ a sample with few
ERs with the help of a sample with many ERs. Besides, the merging
strategy has no user-defined parameter to tune the results, whereas
our method provides a rigorous way to weight co-occurrence and
significance of ERs.

3.3.2 Irreproducibility discovery rate

The IDR (Li et al., 2011) is a measure of the consistency of ERs
identified in replicates, which has been systematically assessed in the
ENCODE project. We computed the IDR for the ERs in our samples
and used an IDR threshold of 0.05. The results are shown in the

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 JO A1rs19Aru [1 112 [BJO'SIBILIHO[p.IOJXO'SODBIIHOJIIIOIQ/ﬂ(11111 111011 pepeolumoq

Combining replicate ChIP-seqs

2767

 

A

481-135

SS MS

FIE-'4 Film

Number of peaks
E‘s-Hilﬁ- Bel-105

1e-I-IJE-

 

oa-I-oo

sumo Iooooo 140000

Number of peaks

 

_ as us
- 55 M5 
.-ii

Myo1

$511415

ii 55 M5

ammeaapamw

ffnaau

 

Flepd Flep‘l nape Rape

Humberoipeaks
canon come some some

 

EI- Rap1 Flop'l Fiepz Flop-2

Inoooo 14-IJODIJ

Number of peaks
eoooo

20000

 

BS MS
- 33 M3 

lfnaEh
F

 

Fhep1 Fl'ap‘l Hep2 Hep-2

 

MS:
s,c:
w,c:
s,d:
w,d:

 

Single Sample

Multiple Sample

stringent conﬁrmed peaks
weak conﬁrmed peaks
stringent discarded peaks
weal: discarded peaks

 

 

 

Hum-er od peaks

EﬂDODd-DMUEDD-MBDOD-ﬂ

Numb-er of peaks

coooo

°' can Hoot nape Hep?— B “W1 “at” Fm F'E'F" IfnaEIh
""939 H lfngeEh
a
H
E.
e
as Ms E; as MS
E
3
2

12011015

10011315

 

 

G

 

 

Ftep1 Hapf FloptE Flep2

BS MB

5.1: as us
“7.1:
so -
and
as us ' as MS as us

 

Myc3 D MyeE-I-S I

12012100

SSMS

 

IIIEI

 

 

 

Number of peaks.

EWWUWW

 

200W

 

 

55 M5

Rep] Rep]

El

nape HepE

4
lfnaSD 1
II‘rIa3EI 2

I I

 

Fig. 5. Biological replicates. A—H: ER sets in the biological replicates considered. 88, single sample analysis; MS, multiple sample analysis. In each panel, the SS
stacked bars represent Rs (light gray) and RW (dark grey) in the replicates, while the MS bars show the same peaks, confirmed or discarded according to the out-
put of our method: I?“ (light gray), RW'C (medium-light gray), Rs'd (medium-dark gray) and Rw'd (dark grey). I, general statistics on the cardinality of the ER sets; J,

validation of the sets with the Myc binding motif (Myc canonical E-box); ’Y’, presence of the E-box. See Supplementary Table S8 for E-box enrichment P—values

Table 2. Comparison with merged alignment files and IDR

 

 

Sample Rs R" Merged R" D Merged IDR < 0.05 R" n IDR < 0.05
Myc1_1 19 171 42 663 27 958 20 359 (73%) 3097 3097 (100%)
Myc1_2 32 850 54 420 27958 22 265 (80%) 4618 4618 (100%)
Myc1_3 13 623 34 858 27 958 20 112 (72%) 4966 4964 (99%)
Myc2_1 42 456 56 989 39 805 38 958 (98%) 24 066 23 767 (99%)
Myc2_2 33 015 54 889 39 805 37 765 (95%) 24 066 23 767 (99%)
Myc3_1 5473 14 411 15 404 9252 (60%) 2356 2237 (95%)
Myc3_2 12 832 16 401 15 404 12 483 (81%) 2356 2237 (95%)
Ifna30_1 1901 4839 3650 2918 (80%) 1171 811 (69%)
Ifna30_2 2527 5605 3650 2914 (80%) 1171 823 (70%)
Ifna6h_1 5852 9570 6633 5913 (89%) 2274 2078 (91%)
Ifna6h_2 4547 10 547 6633 5671 (85%) 2274 2078 (91%)
Ifng30_1 8227 18 112 32 363 15 828 (49%) 5586 5586 (100%)
Ifng30_2 30524 33 203 32363 30 307 (94%) 5586 5586 (100%)
Ifng6h_1 2485 12 052 21 145 8506 (40%) 5181 4352 (84%)
Ifng6h_2 27 728 28 564 21 145 20 187 (96%) 5181 5079 (98%)

 

Comparison of the output set R" (3 rd column) with ERs obtained by merging replicates (4th column) and with ERs having Irreproducibility Discovery Rate

(IDR) < 0.05 (6th column). The number of overlapping peaks between R0 and the two other methods (5th and 7th columns, respectively) is shown, together with

the fraction of the other method peaks overlapping with peaks in R". In general, R" is larger and comprises the majority of the peaks obtained by the other

methods.

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 JO A11s19A1u [1 112 /810'S{12umo[p101x0'831112u1101u101q//2d11q 111011 pepeolumoq

 

 

 

2768 V.Jalili et al.
Table 3. Comparison with jMOSAiCS

Sample R5 R0 jMOSAiCS R°\jMOSAiCS E-box jMOS AiCS\RO E-box
Myc1_1 19 171 42 663 50 539 7649 Y 31 750 N
Myc1_3 13 623 34 858 33 867 4156 Y 17249 N
Myc2_1 42 456 56 989 91 252 1346 Y 46 979 N
Myc2_2 33 015 54 889 92 423 799 Y 50 428 Y
Myc3_1 5473 14 411 18 244 2801 Y 9061 N
Myc3_2 12 832 16401 27116 1390 Y 13 181 Y
Ifna30_1 1901 4839 32 711 111 - 28 752 Y
Ifna30_2 2527 5605 30 695 527 - 26 616 Y
Ifna6h_1 5 852 95 70 38 517 114 Y 29 703 N
Ifna6h_2 4547 10 547 36 258 408 Y 28 028 Y
Ifng30_1 8227 18 112 49 843 257 Y 33 763 N
Ifng30_2 30 524 33 203 69 128 150 - 39 996 N
Ifng6h_1 2485 12 052 31 160 483 Y 22 678 Y
Ifng6h_2 27 728 28 5 64 70 888 98 - 45 601 Y

 

Comparison of the output set R" (3rd column) with ERs obtained by jMOSAiCS (4th column). The 5th and 6th columns show the number of peaks that are
present in R" but not in the jMOSAiCS output, and the enrichment of the Myc canonical E-box in this last set, respectively. Vice versa, the 7th and 8th columns

show the number of peaks present in the jMOSAiCS output but not in R", and the corresponding enrichment of the E-box, respectively. For Myc1, the comparison

was done only with replicates 1 and 3. jMOSAiCS outputs a large number of ERs, including most of the peaks identiﬁed by our method, but only a fraction of the

jMOSAiCS-speciﬁc peaks contains the Myc binding motif. Each E-box column refers to the set described in the previous column and is marked as follows: ‘Y’:

presence of the E-box; ‘N’: absence of the E-box; ‘-’: set too small to ﬁnd any enriched motif.

sixth and seventh columns of Table 2. First of all, the IDR-validated
peaks are few and often entirely contained in our output sets.
This highlights that the IDR method is rather stringent and generates
only a small set of validated (reproducible) peaks. We repeated our
analysis for the Myc2 sample for a lower T” threshold and
found similar results (see Supplementary Material). Our method
does not score the reproducibility of a peak, but it rather combines
evidence in replicates, and has the option to accept very stringent
peaks even if they are not found in other replicates. We conclude
that our method confirms weak peaks that are considered ‘irrepro-
ducible’ by IDR (with a 0.05 threshold), and are validated by
motif analysis (Figs 4 and 5, Supplementary Tables S3—S11).
Finally, differently from our method, which accepts any number of
replicates, the IDR can be directly computed only for pairs of
replicates.

3.3.3 jMOSAiCS

We compared our results also with those obtained with jMOSAiCS
(Zeng et al., 2013), a tool designed to detect combinatorial patterns
of enrichment in multiple ChIP-seq samples. Even if jMOSAiCS is
conceived to integrate different ChIP-seq datasets that profile dis-
tinct features on the same biological sample, it can also be applied to
replicates of the same ChIP-seq. Applying jMOSAiCS to our biolo-
gical replicates (Table 3) resulted in a very large amount of ERs in
each experiment, which were on average around 5 times larger than
our peaks (ER average size data are not shown). These sets of peaks
contained by far the majority of the ERs identified by our method.
We checked for the enrichment of the Myc E-box in the peaks iden-
tified by our method, but not by jMOSAiCS and vice versa (peaks
identified by jMOSAiCS, but not by our method). While in the for-
mer case the Myc binding motif was enriched in all the sets with an
enough number of peaks to detect any enriched motif, the latter case
showed the presence of the Myc canonical E-box only in half of the
samples. Moreover, the running times of jMOSAiCS for two repli-
cates were in the order of 3 hours, with about 40 GB of memory
consumption, on a server with two Intel Xeon E5-2650 processors
and 64 GB of RAM, as this tool starts from alignment files and finds
ERs independently. On the same platform, our method ran in a few

minutes; the preliminary peak calling step needed to obtain the sets
of enriched regions required about 40 min for each of the replicates
with MACSZ (Zhang et al., 2008). We conclude that jMOSAiCS,
when applied to replicates of the same ChIP-seq experiment, has the
tendency of introducing a large amount of extra peaks, which are
not always validated by motif analysis, and it requires significant
computational resources. On the other hand our method is much
faster, as it allows to start from pre-determined ER lists, and at least
equally specific.

4 Discussion

We introduced a novel and rigorous method to combine evidence in
ChIP-seq replicates and we applied it to several ENCODE datasets
for the transcription factor Myc in the K5 62 cell line. Our results
confirmed that a considerable number of ERs, which display a weak
significance in single-sample analysis, can be ‘rescued’ by the help of
co-localised evidence in multiple replicates. We proved that the nu-
cleotide sequences spanned by these weak peaks are almost always
found in open chromatin regions and enriched for the Myc canon-
ical E-box motif, for which the Myc protein has the highest affinity.
Surprisingly, even in the case of technical replicates, where reprodu-
cibility should be high, we found that discarding ERs only on the
base of the lack of overlap often results in the dismissal of true bind-
ing sites. This can be due to the fact that our technical replicates
were simulated using a computational procedure starting from the
biological replicates available; nonetheless, we recommend to be
careful in setting the overlapping parameter to high stringency (i.e.
C = f).

We stress that our method works as a post-processing of a per-
missive peak call and it does not question the reliability of the output
of the peak caller (any peak caller providing a P-value score can be
used; we recommend using the same peak caller with the same par-
ameters on all the replicates). The method has three main strengths:
(i) rigour: single-sample evidence from each replicate is combined
through the Fisher’s method; (ii) versatility: with the choice of a few
parameters, it can be decided to weight co-localisation (C) and com-
bined significance ()2) differently; (iii) efficiency: typically, the

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 JO A11s19A1u [1 112 /810'S{12umo[p101x0'831112u1101u101q//2d11q 111011 pepeolumoq

Combining replicate ChIP-seqs

2769

 

required time is in the order of few minutes on a standard desktop
computer and does not require special hardware.

Comparing our method with two other common approaches
(replicate merging and IDR) confirmed the stable identification of a
core of stringent, reproducible peaks. Besides this, our tests demon-
strated that less stringent evidence consistently present across repli-
cates can be combined, leading to the ‘rescue’ of sets of ERs
corresponding to real binding sites, e.g. of the transcription factor
(TF) Myc. In particular, our results are compatible with those found
with IDR, a method widely used in ENCODE to assess the consist-
ency of each detected peak: IDR works by comparing peak rankings
and inferring the proportion of reproducible and irreproducible sig-
nal in the replicates, while our algorithm provides complementary
information by computing the combined significance of a number of
overlapping peaks. Despite comparable running times, we differ
from IDR as we do not automatically discard non-overlapping peaks
and we can directly apply our method to more than two replicates
without relying on multiple pairwise comparisons. We stress that
our method should not be considered an alternative to IDR, but ra-
ther complementary to it.

A further comparison with a tool designed for more complex
analysis (identifying combinatorial patterns of enrichment across
different ChIP-seq experiments performed over the same biological
sample), jMOSAiCS, revealed that, in the specific task of comparing
replicates of ChIP-seq experiments performed against the same tar-
get, this last tool confirms more peaks, which however do not al-
ways enrich for the E-box.

Recently, JAMM (Ibrahim et al., 2015), a tool based on local
multivariate Gaussian mixture models for directly finding ERs on
ChIP-seq replicates, has been introduced. JAMM confirms that
pooling replicates can blur the specific spatial resolution of single-
sample peaks and lead to less accurate calls in terms of peak width
and intensity.

In summary, our strategy represents a promising trade-off be-
tween stringent techniques (IDR) and permissive techniques
(jMOSAiCS).

Acknowledgements

We thank Mattia Pelizzola and Stefano de Pretis for useful discussions.

Funding

This work was supported by the Fondazione lstituto Italiano di Tecnologia
and by AIRC [grant no. IG_13182], and it is part of and supported by the
‘Data-Driven Genomic Computing (GenData 2020)’ PRIN project (2013—
2015), funded by the Italian Ministry of the University and Research (MIUR).

Conﬂict of Interest: none declared.

References

Bailey,T.L. (2011) DREME: motif discovery in transcription factor ChIP-seq
data. Bioinformatics, 27, 1653—1659.

Bailey,T. et al. (2013) Practical guidelines for the comprehensive analysis of
ChIP-seq data. PLoS Comput. Biol., 9, e1003326.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. Series B,
289—300.

Chen,Y. et al. (2012) Systematic evaluation of factors inﬂuencing ChIP-seq ﬁ-
delity. Nat. Methods, 9, 609—614.

Gupta,S. et al. (2007) Quantifying similarity between motifs. Genome Biol.,
8, R24.

Ibrahim,M.M. et al. (2015) JAMM: a peak ﬁnder for joint analysis of NGS
replicates. Bioinformatics, 31, 48—5 5 .

Landt,S.G. et al. (2012) ChIP-seq guidelines and practices of the ENCODE
and modENCODE consortia. Genome Res., 22, 1 813—1831.

Li,Q. et al. (201 1) Measuring reproducibility of high-throughput experiments.
Ann. App]. Stat, 5, 1752—1779.

Mathelier,A. et al. (2014) JASPAR 2014: an extensively expanded and
updated open-access database of transcription factor binding proﬁles.
Nucleic Acids Res., 42, D142—D147.

Murre,C. et al. (1989) A new DNA binding and dimerization motif in im-
munoglobulin enhancer binding, daughterless, MyoD, and myc proteins.
Cell, 56, 777—783.

Rashid,N.U. et al. (2011) ZINBA integrates local covariates with DNA-seq
data to identify broad and narrow regions of enrichment, even within ampli-
ﬁed genomic regions. Genome Biol., 12, R67.

Walhout,A.]. et al. (1997) c-Myc/Max heterodimers bind cooperatively to the
E-box sequences located in the ﬁrst intron of the rat ornithine decarboxylase
(ODC) gene. Nucleic Acids Res., 25, 1493—15 01.

Zeng,X. et al. (2013) jMOSAiCS: joint analysis of multiple ChIP-seq datasets.
Genome Biol., 14, R38.

Zhang,Y. et al. (2008) Model-based analysis of ChIP-Seq (MACS). Genome
Biol., 9, R137.

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 JO A11s19A1u [1 112 /810'S{12umo[p101x0'831112u1101u101q//2d11q 111011 pepeolumoq

