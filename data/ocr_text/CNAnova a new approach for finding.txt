ORIGINAL PAPER

Vol. 26 no. 11 2010, pages 1395-1402
doi: 10. 1093/bioinformatics/btq 145

 

Genome analysis

Advance Access publication April 18, 2010

CNAnova: a new approach for finding recurrent copy number
abnormalities in cancer SNP microarray data

Sergii Ivakhno* and Simon Tavar

Cancer Research UK Cambridge Research Institute, Li Ka Shing Centre,

Robinson Way, Cambridge CBZ ORE, UK

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: The current generation of single nucleotide
polymorphism (SNP) arrays allows measurement of copy number
aberrations (CNAs) in cancer at more than one million locations in the
genome in hundreds of tumour samples. Most research has focused
on single-sample CNA discovery, the so-called segmentation
problem. The availability of high-density, large sample-size SNP
array datasets makes the identification of recurrent copy number
changes in cancer, an important issue that can be addressed using
the cross-sample information.

Results: We present a novel approach for finding regions of recurrent
copy number aberrations, called CNAnova, from Affymetrix SNP 6.0
array data. The method derives its statistical properties from a control
dataset composed of normal samples and, in contrast to previous
methods, does not require segmentation and permutation steps.
For rigorous testing of the algorithm and comparison to existing
methods, we developed a simulation scheme that uses the noise
distribution present in Affymetrix arrays. Application of the method
to 128 acute lymphoblastic leukaemia samples shows that CNAnova
achieves lower error rate than a popular alternative approach. We
also describe an extension of the CNAnova framework to identify
recurrent CNA regions with intra-tumour heterogeneity, present in
either primary or relapsed samples from the same patients.
Availability: The CNAnova package and synthetic datasets are
available at http://www.compbio.group.cam.ac.uk/software.html
Contact: sergii.ivakhno@cancer.org.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 9, 2009; revised on February 24, 2010;
accepted on April 1, 2010

1 INTRODUCTION

Different genetic and epigenetic alterations can lead to the
development of cancer by activating oncogenes or inactivating
tumour suppressor genes. Copy number changes are one example
of such alterations, where ampliﬁcations or deletions of genes
implicated in cancer progression can cause abnormal cell growth
and proliferation (Chin and Gray, 2008). In the past decade, single
nucleotide polymorphism (SNP) arrays have become a de facto
standard for detecting copy number alterations (CNAs) in cancer

 

*To whom correspondence should be addressed.

genomes. The latest versions of SNP arrays, manufactured by
Affymetrix and Illumina, have more than a million polymorphic and
non—polymorphic (NP) probes. For instance, the Affymetrix SNP 6.0
array has >1.8 million probes with roughly equal proportions of SNP
and NP probes.

The high density of SNP arrays and the availability of NP probes
has made SNP arrays the technology of choice for identifying CNAs
in some recently published large—scale oncogenomic studies (Chin
et al., 2008; Weir et al., 2007). In addition to high—density arrays
these studies include a large number of samples. Both the number
of probes and samples create novel data analysis challenges. The
most common problem is the transformation of normalized log—
ratio values into accurate copy number calls at the highest possible
resolution. This so—called single sample segmentation problem has
received much attention, with numerous methods developed for this
task (Colella et al., 2009; Greenman et al., 2009; Nilsson et al.,
2009; Wang et al., 2007). A discussion of segmentation algorithms
for SNP array platforms is available in the Supplementary Material.

Cancer cells usually harbour two types of chromosomal
abnormalities: large scale alterations such as gains and losses
of whole chromosome arms, and more focal ampliﬁcations and
deletions. Given the high rate of genomic instability found in
cancer cells, large—scale copy number changes usually represent
passenger mutations and due to their large size do not facilitate
discovery of functional driver events that lead to malignancy (Pinkel
and Albertson, 2005). On the other hand, due to their smaller
size and recurrence, detection of focal CNAs could lead to the
identiﬁcation of new genes implicated in cancer progression. This
can be facilitated by the availability of high—density/large sample—
size SNP array datasets, where cross—sample frequency information
can be used to identify driver CNAs and distinguish them from
random mutations and probe intensity artefacts.

Several methods for ﬁnding regions of recurrent CNAs using
aCGH and SNP microarray data have been described in the literature.
A review and qualitative comparison of different methods can be
found in Shah (2008). A common theme in these methods is that they
require a preliminary segmentation step to ﬁnd regions of interest
for each sample. For example, signiﬁcance testing for aberrant
copy number (STAC) starts by creating a binary matrix from the
normalized log—ratios, with zeros designating no change and ones
designating losses and gains (Diskin et al., 2006). It then utilizes
two complementary statistics, footprint and frequency, to deﬁne
recurrent CNA regions based on their length and the number of
samples they occur in. A potential problem with this approach is the

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1395

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUlOlCI/ﬁdnq U101} pepBOIUAAOG

9IOZ ‘Ig1sn8nv I102:

S.Ivakhno and S. Tavar

 

difﬁculty in selecting the cut—off for deﬁning CNA—spanning probes
from segmented data.

Genomic Identiﬁcation of Signiﬁcant Targets in Cancer (GISTIC)
(Beroukhim et al., 2007) is another approach that uses segmentation
information. In contrast to STAC, log—ratios in GISTIC are not
discretized; rather those log—ratios below a threshold are set to zero.
This allows GISTIC to better discriminate between CNA regions of
different copy number. However, it still suffers from ambiguities that
arise from specifying a threshold for log—ratios. To detect signiﬁcant
CNAs, both GISTIC and STAC use a permutation approach. In this
case, the signiﬁcance cut—off is strongly dependent on the number
of copy number changes present in the dataset and, depending on
the extent of genomic instability, can increase the number of false
positive (FP) or negative hits. The noise level also inﬂuences the
computation of thresholds.

Here, we present a novel approach, CNAnova, for ﬁnding
recurrent CNAs, those that appear in multiple samples. The
boundaries of such a CNA are determined by the magnitude of probe
log—ratios across all samples that contain the CNA. CNAnova uses
properties of a control dataset composed of the normal samples to
assess statistical signiﬁcance of identiﬁed CNAs and, in contrast
to previous methods, does not require the data segmentation and
permutation steps. By using the distribution of probe intensities
in normal samples, CNAnova can better assess background probe
variation present in the dataset. We also describe an extension
of the CNAnova framework for identifying recurrent CNAs with
intra—sample heterogeneity. Properties of the method are extensively
tested and compared using both simulated and real data.

2 APPROACH

The CNAnova procedure is composed of several distinct steps
designed to preprocess the data (such as removing probes spanning
germline CNV regions), transform them into a suitable format for
statistical analysis, estimate F — and t—statistics from the ANOVA
model, identify boundaries of the recurrent CNA regions using
the gradient kernel density estimation and ﬁnd signiﬁcant regions
through control of the false discovery rate (FDR). The schematic
representation of the method is outlined in Figure 1.

In the following subsections, the implementation of the CNAnova
model is described and characteristic features of the method are
discussed. The strategy for using reference normal samples to
distinguish between somatic copy number changes in cancer, copy
number variation in normal individuals and non—biological probe
effects such as wave artefacts is described.

3 METHODS
3.1 Pseudo-replication and creation of reference
dataset

CNAnova is based on local decomposition of the variance and takes
advantage of the dataset— speciﬁc structure generated during the preproces sing
step of the method. First, we discuss the general data representation
framework and then give examples of its extension. We assume that the
dataset is divided into a reference set M of samples representing normal
individuals, which serve as a reference for the single—channel array data, and a
set JVC of cancer samples. The normal samples can include matched controls,
where tumour and normal tissues are collected from the same individual, or
they can be derived from a pooled sample or a subset of individuals. In fact,

Pre—process raw SNP array data and form matrix summary

 

 

 

 

Cancer Normal control
n m
Split data
Cancer Normals Reference

n m-k 7»
Match cancer and normal
samples to reference set

Cancer I Normals

reference reference

K r1 9» (m-k) 9» x

Remove CNV regions
identified in the normal dataset ‘
from cancer samples

 

 

Apply ANOVA statistical model

to the normal dataset using moving
probe window along the chromosome
¢ obtain F-statistics and flag potential I

CNV regions ¢

Obtain F- and t-statistics for
the normal dataset,derive the null
I distribution for F— and t—statistics

Apply ANOVA model to cancer dataset
using moving probe window along the
chromosome, obtain F- and t—statistics

Use mean—shift procedure to define
boundaries of recurrent CNAs

St I

Using the null distribution derived from
the normal dataset find F—and t—statistic
threshold for controling FDR.

Define significant regions of frequent
copy number changes

Fig. 1. Diagram showing the workﬂow of the CNAnova procedure. The size
of each dataset is shown below its name. Further details are provided in the
text.

the algorithm does not impose speciﬁc requirements on having a matched
reference.

The derivation of log—ratio values from single channel normal and cancer
array samples involves pseudo—replication, performed as follows. Each
cancer sample in ./\/C is associated with the same subset M CM, of size
A, of normal samples. The subset M is chosen from samples with the most
robust quality metric, as discussed in the Supplementary Material. The values
in M are used to calculate log—ratio values, and this make each cancer sample
pseudo—replicated A times. These samples will have the same distribution of
CNAs as the original cancer sample, but will differ in the background probe
variation arising from differences between original normal samples.

A control dataset is then created following a similar procedure that uses
the samples in M. The normal samples not in N; are associated with M,
thereby insuring that each normal and tumour sample is matched to the same
reference samples. These two procedures create pseudo—replicated sets of
cancer and normal samples.

Finally, after replication we choose a single normal sample from M /M
to make an ANOVA reference sample of size A using M that is used to
produce treatment contrasts in the analysis of variance below.

3.2 CNAnova statistical model

The CNAnova model can be thought of as a one—way analysis of variance.
The algorithm ﬁrst ﬁnds the regions of recurrent CNAs in the whole dataset

 

1 396

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; popaommoq

9IOZ ‘19 lsnﬁnv uo ::

CNAnova

 

and then detects samples with copy number changes. Speciﬁcally, ANOVA is
used to compare the means of probe log—ratios between the pseudo—replicated
cancer samples and the reference normal sample, using a sliding widow
along each chromosome. The frequency of copy number changes for speciﬁc
chromosomal regions across the dataset is captured by the magnitude of the
F —statistics. The algorithm can be decomposed into the following steps:

( 1) Let ,0 be the shift parameter that deﬁnes successive locations at which
a window is placed. For a chromosome containing 1 probes, we apply
ANOVA to each of the t / ,0 windows.

(2 For each window j, with 1 probes, we ﬁt the model

V

YikZM-l-‘Ci-I-Sik, i=0,I,2,...,I’l; k=1,...,l)\.. (I)

where
0 n is the number of cancer samples;

0 i =0 corresponds to the ANOVA reference sample and i: 1, ...,n
to cancer samples;

0 Yik is the probe log—ratio of the k—th of the set of 1)» probes in the
cancer samples;

0 11 is the mean of the probes for the normal reference sample in
window j, and to =0;
0 For i: 1, 6,- is the ﬁxed effect for a particular cancer sample i;

0 aik are the random error terms such that aik are independent random
variables with E(8,-k) = 0 and V(8,-k) = 02.

(3) Derive overall F — and t—statistics for each regression coefﬁcient in the
formula.

(4) Apply the same approach to the normal control samples for assessment
of statistical signiﬁcance (Section 3.4).

It is important to ensure robustness of the ANOVA model against outliers
and local shifts in the probe distribution, such as those arising from the
wave artefact that is prominent in SNP array data (Diskin et 611., 2008;
Marioni et 611., 2007). One possible solution is to use robust ANOVA
methods. However, these methods may remove a signiﬁcant proportion of
probes, which may decrease the number of identiﬁable CNAs and they
add computational overhead. We adopt an alternative two—stage solution
to the problem. First, we preprocess the data by removing outliers using
modiﬁcation of the k—nearest neighbour smoothing approach described in
Olshen et 611. (2004). Next, we centre the log—ratio distribution on each
chromosome using the mean of all log—ratios in the interquartile range. This
helps to ensure that in the case of no signiﬁcant copy number changes, the
log—ratios are centred around a zero baseline. In addition to robustness against
outliers it is necessary to verify that autocorrelation and heteroscedasticity
of the variance do not increase the error rate of the method. In the
Supplementary Material, we show that such violation in the distribution of
variances is offset by concomitant changes in means, thereby only marginally
inﬂuencing the performance of CNAnova.

A large proportion of probes tested will be altered in at least one sample,
usually as a result of large—scale, single—copy gains or losses arising from
genomic instability. This can lead to large and signiﬁcant F —statistics for all
the segments spanning the changed regions (even though in most cases they
do not reside within regions of recurrent CNAs). To detect truly frequent
focal CNA regions, we ﬂag low—level copy number gains and losses in the
dataset using smoothing spline normalization. The smoothing parameter is
empirically selected to ensure that the transformation preserves focal CNAs;
this choice depends on the largest detectable recurrent segment and the
number of probes on the chromosome. Although broad regions do not guide
the detection of focal recurrent CNAs, they are incorporated into recurrent
CNAs when they span the regions of recurrence (Supplementary Fig. $1 and
Supplementary section ‘Relevance of spline—correction for identiﬁcation of
recurrent CNAs’).

Having both spline—corrected and unsmoothed datasets, the estimation of
F —statistics and P—values using CNAnova is carried out as follows. The model
in (1) is ﬁrst applied to the spline—corrected dataset to derive an F —statistic

 

O
9
O
8
,_— O
O
C
o
O
8 5 g
..
9
"" O
a 0— °
,_
7) o 8
£2 95
I 6
LL E

 

 

 

 

| | | | | |
O 500 1 000 1 500 2000 2500 3000

segments

Fig. 2. Application of mean— shift procedure to the distribution of F —statistics
along the chromosome. Solid grey lines indicate the location of mean—shift
minima and dotted line shows the threshold for calling signiﬁcant F —test
scores. The mean—shift algorithm allows smoothing of the non—signiﬁcant
spikes and detection of signiﬁcant changes in the F —statistics.

and to ﬁnd regions that harbour recurrent CNAs. This is done with the aid of
the mean—shift procedure described in the next section, which delimits CNA
boundaries across all samples. The method then uses coordinates of CNA
segments with the original unsmoothed dataset and re—applies the model.
This time P—values for the regression coefﬁcients 6,- are used to identify
samples that have copy number changes. Consequently, the two successive
applications of the ANOVA model provide a set of F —statistics of size t/ ,0
and a P—value matrix with dimensions 1 / ,0 and n, which help to identify both
the boundaries and sample content of recurrent CNAs.

3.3 Finding boundaries of recurrent CNA segments

The distribution of F —statistics alone is difﬁcult to use to determine the
precise boundaries of CNA regions, due to local discontinuities which might
either split a single region into several or lead to FPs due to local outliers
among the F —statistics. F —statistics, therefore, need to be smoothed to remove
such aberrant values. The problem with local smoothing methods such as
loess is that local least square estimation of means at each point leads to
smooth transition between F —statistics corresponding to CNA and non—CNA
regions, which reduces the precision of correct CNA boundary placement.
An alternative local smoothing approach based on modes can provide
discontinuous demarcation of boundaries for CNA and non—CNA F —statistic
regions. This is in part achieved by the mean—shift procedure (cf. Comaniciu
et 611., 2001; Wang et 611., 2009), which performs discontinuity—preserving
smoothing of the F —statistic, thereby removing the noise in homogeneous
regions of the chromosome and preserving discontinuities at the same time.
We extend the mean—shift procedure to ﬁnd boundaries of recurrent CNA
regions by assigning probes with the same mode of the F —statistic to separate
regions on the chromosome (Fig. 2).

Finding boundaries of recurrent CNAs across samples using the mean—
shift procedure requires selection of the appropriate kernel K and bandwidth
parameter 11 that controls the degree of smoothness. We take K to be an
univariate Gaussian kernel and use SDs of log—ratios to determine h for each
chromosome, as follows:

(1) Using non—overlapping windows of the size 10000 probes, estimate
the SD of log—ratios, and let S be the set of all such SDs;

 

1 397

112 /§.IO'SIBUJHOIPJOJXO'SOTlBIHJOJUIOICI/ﬁdnq 11101; popaommoq

9IOZ ‘19 lsnﬁnv uo ::

S.Ivakhno and S. Tavar

 

(2) Generate b uniformly distributed parameters oi,i=1,...,b taking
values between the minimum value in S and the ﬁrst quartile of S;

(3) Apply the mean—shift procedure 19 times using the Gaussian kernel
with h=oi,i=1,...,b;

(4) Estimate the maximal log—likelihood for each model using
Gaussian mixtures approximation and their corresponding Bayesian
Information Criterion (BIC) values;

(5) Select the model with a that gives the largest BIC value. Use the mean—
shift modes identiﬁed with this model with bandwidth 11 =0 to ﬁnd
distinct peaks in the distribution of the F —statistics. Those exceeding
the F —statistic threshold are identiﬁed as regions of recurrent copy
number change.

3.4 Deﬁning statistically signiﬁcant CNA regions

The ﬁnal step in the process of ﬁnding recurrent CNAs includes correction for
multiple testing and assignment of statistical signiﬁcance to the F —statistics.
For this purpose, CNAnova uses the false discovery rate (Benjamini and
Hochberg, 1995) estimated using the distribution of probes in the normal
samples matched to the common reference set as described in Section 3.1.
Successful estimation of FDR depends on knowledge of the number of
FPs in our rejection regions. For the purpose of identifying signiﬁcant
F — statistics, we can utilize the distribution of F —statistics in the normal dataset
to estimate FP on the premise that most of the extreme values of the statistic
arising from normal—to—normal comparison will represent local variation in
probe intensities (similar arguments for ﬁnding signiﬁcant P—values of the
t—statistics are discussed below) (Supplementary Fig. S7).

Such an approach is based on the assumption that the normal dataset does
not have germline CNVs, and therefore any occurrences of large F —statistics
will be attributed to non—biological variability in probe log—ratio values. To
circumvent this problem, all probes with median absolute log—ratios >0.5
are not included in the estimation of the F —statistics. The selection of this
threshold comes from the fact that median values higher than 0.5 or lower
than —0.5 could be considered as an indication of potential single copy gains
and losses in the region (see Supplementary Material for further discussion
of threshold selection). After such adjustment, the following maxF procedure
corrects for multiple testing and estimates the threshold for the F —statistics:

(1) Let (Dr be the set of F —statistics in the reference dataset and CDC
in the corresponding cancer dataset. For each window, remove that
F —statistic from (Dr if the maximal value of the median log—ratios
across all samples in that window is more than the threshold 6 (here
set to 0.5);

(2) Sort the remaining F —statistics in (Dr, and in (DC, in decreasing order;

(3) For a chosen FDR cut—off r} e (0, 1), select the smallest value 11 such
that |{ve CIDr:v>11}|/|{we Cl>c:w>11}| > 1}. Use 11 as the threshold for
calling signiﬁcant F —statistics.

The maxF procedure essentially estimates the proportion of F —statistics
derived from the subset of normal samples that are below the selected
F —statistic threshold 11. Since in most cases they represent FP hits, the
threshold for controlling FDR can be calculated using the FDR formulation.
Given a list of signiﬁcant regions, CNAnova next ﬁnds signiﬁcant P—values
in order to determine which samples have CNAs. For this, we use the same
steps as in the maxF procedure, but utilize P—values of log—ratios for probes
that fall within CNA boundaries across all normal samples, leading to the
minP procedure.

3.5 Identifying CNAs with intra-patient variability

The CNAnova algorithm can be extended to address additional questions
that arise from the analysis of SNP array datasets. One important task in
cancer research is ﬁnding recurrent CNAs that exhibit patterns of intra—patient
heterogeneity. For example, researchers might be interested in identifying
CNAs that are found in metastasis but not in primary cancer, or CNAs

found only in metastasis to speciﬁc tissues such as lung. Here, we introduce
an extension of the CNAnova framework based on the ﬁxed—factor nested
ANOVA model for identiﬁcation of such recurrent CNAs with intra—patient
variability.

The extension is a two—step process. First, samples from the same patient
are grouped together and one—way ANOVA is run to identify recurrent
regions. To insure that any possible decrease in the values of the nested
F —statistics due to enlarged and inhomogeneous cancer samples are recreated
in the normal samples, a similar transformation of merging normal samples
into groups having the same size as the cancer samples is performed. The F—
statistics from the one—way ANOVA allow us to identify regions of recurrent
CNAs. Next, we apply a nested ANOVA model to each window in the regions
previously identiﬁed as recurrent using the following model:

 =  i=071727-N7nC7
11=l,2,...,nC,-; k=l,...,1)1, (2)

where

- Yiuk is the k—th probe log—ratio from the set of 1)» probes of 11—th cancer
sample from individual i;

0 nc is the number of cancer individuals;

0 ad is the number of samples for individual i;

0 i =0 corresponds to the ANOVA—reference sample and i> 0 to cancer
individuals;

0 11 is the mean of the probe log—ratios for the normal reference sample
in the window, and to =0;

0 6,- is the non—random between—sample effect for cancer individual i;

0 6,0,) is the non—random within—sample effect for cancer individual i. In
our nested CNAnova implementation the reference sample represents
a primary non—metastatic tumour;

° aiuk are the random error terms such that aiuk are independent random
variables with E(8,-uk) = 0 and V(8,-uk) = 02.

We derive overall F —statistics and P—values of t—statistics for each
regression coefﬁcient in the formula, using the procedures already described
for one—way ANOVA. The focus on only recurrent CNA regions is primarily
guided by the longer running time required for ﬁtting complex linear models.
The P—values for the intra—patient t—statistics derived from the nested model
can then be used to determine the extent of intra—patient variability for
each of the identiﬁed recurrent CNAs. The reference group for intra—patient
comparisons can be deﬁned by ordering samples within each group; for
example, we give below the reference group includes primary tumours at
diagnosis that are compared to relapsed samples.

4 RESULTS

4.1 Simulation data

4.1.] Simulation strategy Due to the absence of an exhaustively
validated dataset for benchmarking algorithms, simulated datasets
are important. However, when trying to generate a simulated dataset
for which the underlying copy number states are known, particular
attention should be paid in preserving the noise distribution of
the real data (Willenbrock and Fridlyand, 2005). This is usually
the hardest part in the simulation process, as the distribution is
composed of many components. These include high—afﬁnity probes
giving rise to extreme outliers, GC content of the genome producing
wave patterns and sample puriﬁcation steps such as whole genome
ampliﬁcation giving rise to additional probe intensity artefacts. The
higher density of SNP arrays and the decrease in the number of
probes in the probesets for the latest generation of Affymetrix
arrays further complicate this problem. Our approach used normal

 

1 398

112 /810's112u1nol‘p101x0'sor112u1101urorq//zd11q 111011 pop1201umoq

910Z ‘1918n8nv uo ::

CNAnova

 

 

 

 

 

C? — o o
‘— GISTIC 1.5 GISTIC 1 GISIIC 0.5
o
CNAnova
oo
03 _
c5
C
.9
.9
O
9
Q. 8 _ 0
c5 GISTIC 0.25
<r
Q _ o
O GISTIC 0.1
I I I I
0.4 0.6 0.8 1.0
sensitivity

Fig. 3. Sensitivity versus precision curve comparing CNAnova and GISTIC
in ability to ﬁnd recurrent copy number alterations in the simulated data.

samples and simulated copy number changes in them. We selected
270 HapMap samples hybridized to Affymetrix SNP 6.0 arrays
(McCarroll et a1., 2008) to derive test data with which we could
compare different methods.

The simulation of copy number changes recreates different
possibilities for cross—sample occurrence of CNAs. We started with
the following simulation scenario. First, the frequency of CNAs and
their amplitude were deﬁned by creating CNAs that occur in l—75%
of data and include from 10 to 300 probes (approximately 3—100 kb).
The positional effect of CNAs, such as occurrence of deletions in
different exons of a gene, was simulated by shifting CNAs around the
middle position in some samples and segments. The procedure was
applied multiple times to chromosome 17 of the HapMap data and
30 regions of recurrent copy number changes of different magnitude
and frequency were simulated (details of the simulation scheme are
listed in the Supplementary Material).

4.1.2 Algorithm comparison We used CNAnova with a default
FDR 0.05 and GISTIC with threshold parameters 0.1 (program
default), 0.25, 0.5, l and 1.5 to ﬁnd recurrent CNAs in the simulated
dataset. Since all simulated CNAs in our dataset have absolute
log—ratio values >0.5, we expect GISTIC with a 0.5 threshold to
have the lowest error rate. Before applying GISTIC, circular binary
segmentation (CBS) (Olshen et a1., 2004) was used to segment log—
ratios. We veriﬁed that CBS found all simulated CNAs, thereby
ensuring that segmentation errors did not propagate though GISTIC
(Supplementary Fig. S8). True positive rate (TPR; or sensitivity)
and positive predictive value (PPV; or precision) were used to assess
performance of the algorithms.

Results for the overall dataset (Fig. 3) suggest that although
CNAnova and GISTIC share similar precision, CNAnova produces
the best results when both precision and sensitivity are taken into
account. In addition, we found that GISTIC tended to split single
CNA regions into multiple regions, as was observed 1, 3 and 5
times for GISTIC run with threshold parameters 0.5, l and 1.5,
respectively. In addition to altering the biological signiﬁcance of
results after such an artiﬁcial splitting (i.e. by missing some genes
or distorting co—occurrence metrics), this may underestimate the
actual frequency of CNAs. In contrast, CNAnova detected all
simulated CNAs without splitting any regions. Both algorithms
have the maximal possible precision of 1 when only CNA regions

Percentage of samples with copy number change
3 5 1o 12 14 16 18 20 22 25 27 2933 35 3739424446485052 545961 63 65 67 6971
| | | | | l l | | | | | | | l l | | | | | | | l l | | | | |

 

3— ....002000000
o
...0000
0"...
o \/
O . .
O o
°°._
O
‘o._
O
>
.1:
.2
.4:
V1
C
OJ
V1
“C_
O
(‘1_
O
.CNAnova
oGlSTlC
C
d—...

 

 

 

1.71.2 0.6 —1.6 -1.2 -0.6 1.71.2 0.6 —1.6 -1.2 -0.6 1.71.2 0.6 -1.6 -1.2 -O.6 1.7 1.2 0.6 -1.6 —1.2 -0.61.71.2 0.6 -1.6 —1.2 -0.6

segment means

Fig. 4. Sensitivity of CNAnova and GISTIC, run with 0.5 threshold, in
identifying recurrent copy number changes of different frequency and
magnitude. Top x—axis label gives the percentage of samples containing a
given recurrent CNA; bottom x—axis label gives the mean log—ratio value
used in simulation.

with >49% of changed samples are taken into account. However,
with decreasing CNA frequency CNAnova starts to show higher
sensitivity. In particular, GISTIC with the optimal 0.5 threshold
cannot detect any samples altered in 5—10% of samples, while
CNAnova detects many such samples (Fig. 4).

To conﬁrm this observation using a larger sample size, we
created an additional benchmarking dataset where only rare low—
frequency CNAs (one copy gain and loss) were simulated. CNAnova
outperformed GISTIC with a 0.5 threshold, this time in both
sensitivity (0.86 versus 0.98) and precision (0.94 versus 0.99).
This trend was observed for rare recurrent CNAs with different
mean values and frequency (Fig. 5). The decrease in the size of
segments with the lowest simulated mean values after applying
the default GISTIC threshold may partly explain GISTIC’s fall
in sensitivity and precision. This underscores the thresholding
limitation of segmentation—based methods and contributes to the
jumpy nature of sensitivity plots. The difference in sensitivity and
speciﬁcity between GISTIC and CNAnova becomes less prominent
once the copy number change of rare CNA is increased to include
two copy gains and deletions (Supplementary Fig. Sll). However,
GISTIC had a much higher error rate when assessed on simulated
non—signiﬁcant changes with means (:l:)0.2/0.3 (29% versus 17% for
CNAnova), suggesting that the method is less robust against outliers
occurring within recurrent CNA regions. In the Supplementary
Material, we compare the performance of CNAnova and GISTIC
using a hypothesis testing framework.

4.2 Acute lymphoblastic leukaemia (ALL) Affymetrix
SNP 6.0 data
To test the performance of CNAnova and GISTIC on real data,

we used a recently published study comprising 94 samples of ALL
and 36 matched normal samples analysed using Affymetrix SNP

 

1 399

112 /810's12u1nofp101x0'soi112u1101uioiq//zd11q 111011 pop1201umoq

910Z ‘1918n8nv uo ::

S.Ivakhno and S. Tavar

 

A Percentage of samples with copy number change

3 5 8101213141516171819202122232425262728293031323334353637
||||||||||||||||||||||||||||||

 

 

2— [000000030
0.000"".. .
o.
.o" \/
C
no 

‘39.

o O

‘o._

o O
a? o
:5
W
é o

5"._

O

C
O
N._
o
OCNAnova
.GISTIC
C
d— O

 

precision

 

 

0.7 0.65 0.6 -0.7 -0.65 -0.6 0.7 0.65 0.6 -0.7 -0.65 -0.6 0.7 0.65 0.6 -0.7 -0.65 -0.6 0.7 0.65 0.6 -0.7 -0.65 -0.6 0.7 0.65 0.6 -0.7 -0.65 -0.6

segment means

B Percentage of samples with copy number change

3 5 8101213141516171819202122232425262728293031323334353637
||||||||||||||||||||||||||||||

 

S— O. OOOOOOOOOOOOOOOOOOO O \

.0. ...O .0
. .00 '0 \/0\// \.
00. \/ o 0 .\/
g_ .7 \o/\/ . o
o
o.

°Q_

O

'\._

O

‘Q_

C

u'!_

C

5t_

O
.CNAnova
“GISTIC

m._

0

 

 

 

0.7 0.65 0.6 —0.7 -0.65 —06 0.7 0.65 0.6 -0.7 -0.65 —0.6 0.7 065 0.6 —0.7 -0.65 —06 0.7 0.65 0.6 —0.7 —0.65 -0.6 0.7 065 0.6 —0.7 -0.65 -0.6

segment means

Fig. 5. Sensitivity (A) and precision (B) of CNAnova and GISTIC, run with the thresholds of 0.5 on log—ratio values, in identifying rare recurrent low—level
copy number gains and losses (colour version of the ﬁgure is available in Supplementary Material). Top x—axis label gives the percentage of samples containing
a given recurrent CNA; bottom x—axis label gives the mean log—ratio value used in simulation (colour version of the ﬁgure is available in Supplementary

Material) .

6.0 arrays (Mullighan et a1., 2008). The 94 samples were derived
from 47 patients and were grouped into diagnosis—relapse pairs.
The choice of this particular study was guided by the fact that the
authors experimentally conﬁrmed many previously described and
newly identiﬁed copy number changes with quantitative genomic
PCR. We used raw .CEL ﬁles and carried out all normalization
and summarization steps using aromaaﬁcymetrix (Bengtsson et a1.,
2008). The normalized raw probe intensity values were then fed into
the CNAnova pipeline. The data put into GISTIC were derived from
the same pre—processing steps, except that no pseudo—replication
was done. For instance, the same CNV probes were ﬂagged in
the GISTIC data. The segmentation was carried out using CBS
and GISTIC was run with threshold parameters of 0.1, 0.25, 0.5,
1 and 1.5.

The problem of algorithm comparison using real data usually
arises from the fact that many hits are unvalidated. The ALL
dataset has two advantages when compared to other similar
datasets. First is the fact that many copy number changes were
experimentally conﬁrmed. Second, due to the rearrangements of the
immunoglobulin genes in the B—cell lineage, the location of deletions
can be predicted a priori with high accuracy and this can serve as
a positive control to assess the error rate of CNAnova and GISTIC.
These two sets gave us a reference list of CNA regions for computing
sensitivity and precision of the algorithms.

For the segments not overlapping these regions, we used the
following strategy to assess the possibility of a segment being a
FP. We began by looking at the number of probes that were covered
by each segment. Very small segments have a higher chance of
being a FP. This chance further increases if segments do not span
the known annotated genes. Finally, we looked at the log—ratios.

Table 1. Sensitivity and precision for CNAnova and GISTIC on the ALL
dataset reference genes list

 

GISTICO.5 GISTICO.5 GISTICl GISTICl CNAnova CNAnova

 

PPV TPR PPV TPR PPV TPR
IGK@ 0.93 0.95 0.94 0.95 0.96 0.93
IGH@ 0.93 0.96 0.91 0.96 0.95 0.92
IGL@ 0.94 0.92 0.91 0.92 0.92 0.93
CDKN2A 0.94 0.96 0.94 0.95 0.95 0.92
CDKN2B 0.93 0.96 0.94 0.95 0.96 0.93
IKZFl 0.93 0.94 0.93 0.96 0.95 0.93
ETV6 0.66 0.83 0.75 0.70 0.83 0.75
PAX5 0.71 0.76 0.77 0.71 0.80 0.76

 

The segments satisfying the two previous conditions and with
values <0.5 (more than —0.5 for losses) were deemed as false
negative. The rates of sensitivity and precision for CNAnova and
GISTIC on the reference list of genes are shown in Table 1.

Both methods performed well in identifying highly recurrent
rearrangements of immunoglobulin genes in the B—cell lineage.
However, overall GISTIC identiﬁed a larger number of gains and
losses even at the ‘biological’ threshold of 0.5 than CNAnova
(Supplementary Fig. S 12). Many of these CNAs represent very small
focal copy number changes. For GISTIC with the threshold of 1,
>80% of CNAs encompassed <15 probes and a quarter of all changes
were <4 probes (roughly 2kb in size, based on the median probe
spacing for Affymetrix SNP 6.0 arrays) (Supplementary Fig. 813).
Most genes residing in these CNA regions have biological functions

 

1 400

112 /810's12u1nofp101x0'soi112u1101uioiq//zd11q 111011 pop1201umoq

910Z ‘1918n8nv uo ::

CNAnova

 

Diagnosis

 

 “f "*“l 'I'Il "111 'l I ‘ "’11 "ll 11 ll ""1 ' I" l l' '1" "1" l

 

 

 

I IIIII IIIIIIII |l IlII "III III I I III III III. IIII IIIIIIIIIIII I “II” III II ||lIIIIIlIII|| I
11.7 11.7 11.7 11.7 11.7 11.7 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.9

genome coordinates (Mb)

Relapse

 

 

 

 “ll” 111111 II'I|I  "I ' ""111I‘ll‘IlIllII

I IIII I IIIIIIII |l IIII "III III I I III III IIII IIII |||I|II|||lI I “II” III II ||lI|IIII||I|| I
11.7 11.7 11.7 11.7 11.7 11.7 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.8 11.9

 

genome coordinates (Mb)

Fig. 6. Example of copy number plots showing the loss of ETV6 in the
relapsed ALL samples identiﬁed with ﬁxed—factor nested—design CNAnova.

that do not suggest involvement in ALL progression (i.e. SIRPBl,
PCMTD2 and RBLl on chromosome 20 and APOBEC3B, VPREBl
and RBLl on chromosome 22). CNAnova identiﬁed 60 recurrent
CNAs (Supplementary Table 1). A large number of recurrent CNAs
were identiﬁed chromosome 9, containing amplicons around the
PAX5 and CDKN2A/B genes among others, which conﬁrms the
previous observations about high recurrence of CNAs on this
chromosome (Mullighan et a1., 2008).

Compared with simulated data, GISTIC seems to have a higher FP
rate on the real dataset, leading to lower precision at a comparatively
uniform sensitivity rate. Furthermore, at low thresholds GISTIC
splits single continuous regions into several smaller CNAs. For
instance, the number of recurrent CNAs reported by GISTIC with a
0.5 threshold was 177 for the ALL dataset, which is much larger than
the average number of CNAs reported in similar studies using the
same or similar array platforms (Chin et a1., 2008; Weir et a1., 2007).
These observations allow us to conclude that CNAnova applied to
the noisy Affymetrix SNP 6.0 array data produces a much smaller
number of FPs and does not require the time—consuming process
of selecting an optimal threshold and an appropriate segmentation
method. Having been developed and tested on the Affymetrix
SNP 250K arrays that have only 250K probes and a more robust
probe design, it seems that the noisier and denser Affymetrix SNP
6.0 arrays increase the error rate for GISTIC. This could also
explain why in the analysis of the lung cancer data generated using
Affymetrix SNP 250K arrays, GISTIC was used with a threshold of
0.1 (Weir et a1., 2007), while an Affymetrix SNP 6.0 study of human
glioblastoma used GISTIC with a threshold of 1 (Chin et a1., 2008).

4.2.] Identiﬁcation of recurrent CNAs with intra-patient
heterogeneity We applied the generalized CNAnova approach
to the ALL dataset to ﬁnd recurrent copy number changes that
were present at diagnosis but not relapse or vice-versa. The model
was developed and tested for its ability to detect recurrent CNAs
with intra—patient heterogeneity. We identiﬁed 24 recurrent CNAs
that exhibit patterns of intra—patient heterogeneity (Supplementary
Table 2). These included the CDKN2—cluster, IFNK, ETV6 and

IKZFl, which have been previously reported to have recurrence
at relapse, and sometimes diagnosis (Mullighan et a1., 2008), as
well as new genes such as ATF7IP (Fig. 6) on chromosome 12.
Deletions of ETV6, which contains ATF7IP, have been reported
previously (Montpetit et a1., 2004); however, we ﬁnd cases that
have an independent focal deletion of ATF7IP.

5 DISCUSSION

We have presented a novel framework, CNAnova, for using
unsegmented SNP microarray data to identify recurrent copy number
aberrations in cancer. It uses pseudo—replication to increase statistical
power and, in contrast to segmentation—based methods, does not
require permutations to estimate the null distribution of test statistics.
Instead, this distribution is approximated using samples from a
control set representing normal samples.

CNAnova circumvents the need to specify a threshold on
segmented log—ratios for calling probes with copy number changes.
This threshold could be sample, region, dataset and platform
dependent, which makes it hard to determine an optimal value and
can increase the error rate of segmentation—based methods. This is
especially true for the current generation of the SNP arrays, such
as Affymetrix SNP 6.0, that often exhibit wave patterns and other
artefacts.

Another advantage of CNAnova stems from decoupling the
process of identifying cross—sample boundaries of the regions of
recurrent CNAs and pinpointing the actual samples with copy
number changes. This insures that copy number changes with
extreme probe intensity values do not inﬂuence CNA detectability
in other samples. High probe intensity values fed into permutation—
based methods such as GISTIC may increase the false negative rate
by increasing the G—score (for GISTIC) in the permuted dataset,
and therefore the overall threshold for calling signiﬁcant CNAs.
In its later implementation, GISTIC has introduced capping of
segmented log—ratios with extreme probe intensities (Chin et a1.,
2008). The comparison with GISTIC suggests that it tends to have
higher error rate than CNAnova when using Affymetrix SNP 6.0
arrays. In addition to the dataset—dependent thresholds derived from
the permutation—based estimation of the null distribution, the higher
error rate could be explained by the fact that GISTIC was originally
adapted for use with lower density arrays and a more robust probe—set
design.

At the same time, dependence on the control dataset requires noise
in the cancer and normal samples to follow approximately identical
distributions. In addition, the number of normal samples should be
sufﬁcient to capture different probe intensity artefacts and patterns of
noise in the (often larger) cancer dataset. Further simulations showed
(Supplementary section ‘Results’) that the algorithm is typically
robust against sample size and noise properties of the control dataset.
Only in cases of extremely low control sample sizes (< 10% of the
size of the cancer dataset) the impact on the error rate becomes
signiﬁcant.

Some conceptual ideas relating to different steps of the CNAnova
framework have been discussed in the literature. Hautaniemi et a1.
(2005) derived a parametric mathematical model for protein—based
assays, which was then used to simulate additional data points to
better capture dependencies between variables within the decision
tree. Such an approach resembles our pseudo—replication strategy.
The use of normal control samples to control FDR was proposed

 

1401

112 /810's12u1nofp101x0'soi112u1101uioiq//zd11q 111011 pop1201umoq

910Z ‘1918n8nv uo ::

S.Ivakhno and S. Tavar

 

by Rozowsky et a1. (2009) to correct the FP signals in ChIP—seq
data arising from the open chromatin conformation at pol—II sites.
Decomposition of the variance has been recently proposed in the
context of aCGH data analysis by Kim et a1. (2009), where CNAs
were associated with cancer tissue types.

The statistical framework of CNAnova can be extended by
incorporating more complex models, as we exempliﬁed with a
two—factor nested AN OVA design for identifying CNAs with intra—
patient heterogeneity. A useful extension could be developed to
identify recurrent CNAs prevalent in a particular tumour subtype
or progression stage. In contrast to clustering, such an approach
can provide an association of individual CNAs with a speciﬁc
tumour phenotype. Focus on individual regions rather than clusters
could facilitate the discovery and testing of new candidate genes.
Similarly, additional data and biological annotation, such as gene
expression data or pathway—centred gene sets, could be used to
discover functionally related sets of recurrent CNAs.

ACKNOWLEDGEMENTS

We thank Oscar Rueda, Andy Lynch, Christina Curtis at the Cancer
Research UK Cambridge Research Institute and Rameen Beroukhim
at the Dana Farber Cancer Institute for helpful discussions. We also
acknowledge the assistance of Dr. Charles Mullighan of St. Jude
Children’s Research Hospital, Memphis in providing the raw ALL
data and comments on the predictions from CNAnova.

Funding: The authors acknowledge the support of The University of
Cambridge, Cancer Research UK and Hutchison Whampoa Limited.

Conﬂict of Interest: none declared.

REFERENCES

Bengtsson,H. et al. (2008) Estimation and assessment of raw copy numbers at the single
locus level. Bioinformatics, 24, 759—767.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. R. Stat. Soc. B, 57, 289—300.

Beroukhim,R. et al. (2007) Assessing the signiﬁcance of chromosomal aberrations in
cancer: methodology and application to glioma. Proc. Natl Acad. Sci. USA, 104,
20007—20012.

Chin,L. and Gray,J.W. (2008) Translating insights from the cancer genome into clinical
practice. Nature, 7187, 553—563.

Chin,L. et al. (2008) Comprehensive genomic characterization deﬁnes human
glioblastoma genes and core pathways. Nature, 7216, 1061—1068.

Colella,S. et al. (2009) QuantiSNP: an objective Bayes hidden-Markov model to
detect and accurately map copy number variation using SNP genotyping data.
Nucleic Acids Res., 35, 2013—2025.

Comaniciu,D. et al. (2001) Mean shift: a robust approach toward feature space analysis.
IEEE Trans. Pattern Anal. Mach. Intel, 123, 343—351.

Diskin,S. et al. (2006) STAC: a method for testing the signiﬁcance of DNA copy number
aberrations across multiple array-CGH experiments. Genome Res., 16, 1149—1158.

Diskin,S. et al. (2008) Adjustment of genomic waves in signal intensities from whole-
genome SNP genotyping platforms. Nucleic Acids Res., 36, 1—12.

Greenman,C. et al. (2009) PICNIC: an algorithm to predict absolute allelic copy number
variation with microarray cancer data. Biostatistics, 11, 164—175.

Hautaniemi,S. et al. (2005) Modeling of signal-response cascades using decision tree
analysis. Bioinformatics, 21, 2027—2035.

Kim,K. et al. (2009) Identiﬁcation of signiﬁcant regional genetic
variations using continuous CNV values in aCGH data. Genomics,
[doi:10.1016/j.ygeno.2009.08.006].

Marioni,J. et al. (2007) Breaking the waves: improved detection of copy number
variation from microarray-based comparative genomic hybridization. Genome Biol.,
8, R228.

McCarroll,S. et al. (2008) A comparison study: applying segmentation to array CGH
data for downstream analyses. Nat. Genet, 40, 1166—1174.

Montpetit,A. et al. (2004) Mutational and expression analysis of the chromosome 12p
candidate tumor suppressor genes in pre-B acute lymphoblastic leukemia. Leukemia,
18, 1499—1504.

Mullighan,C. et al. (2008) Genomic analysis of the clonal origins of relapsed acute
lymphoblastic leukemia. Science, 5906, 1377—1380.

Nilsson,B. et al. (2009) Ultrasome: efﬁcient aberration caller for copy number studies
of ultra-high resolution. Bioinformatics, 25, 1078—1079.

Olshen,A. et al. (2004) Circular binary segmentation for the analysis of array-based
DNA copy number data. Biostatistics, 5, 557—572.

Pawitan,Y. et al. (2005) Bias in the estimation of false discovery rate in microarray
studies. Bioinformatics, 21, 3865—3872.

Pinkel,D. and Albertson,D. (2005) Array comparative genomic hybridization and its
applications in cancer. Nat. Genet, 37(Suppl.1), 11—17.

Rozowsky,J. et al. (2009) PeakSeq enables systematic scoring of ChIP-seq experiments
relative to controls. Nat. Biotechnol, 27, 66—75.

Shah,S. (2008) Computational methods for identiﬁcation of recurrent copy number
alteration patterns by array CGH, Cytogenet. Genome Res., 25, 603—619.

Wang,C. et al. (2007) PennCNV: An integrated hidden Markov model designed for
high-resolution copy number variation detection in whole- genome SN P genotyping
data. Genome Res., 17, 1665—1674.

Wang,L. et al. (2009) MSB: A mean-shift-based approach for the analysis of structural
variation in the genome. Genome Res., 19, 106—117.

Weir,B. et al. (2007) Characterizing the cancer genome in lung adenocarcinoma. Nature,
7171, 893—899.

Willenbrock,H. and Fridlyand,]. (2005) A comparison study: applying segmentation to
array CGH data for downstream analyses. Bioinformatics, 21, 408441091.

 

1 402

112 /810's12u1nofp101x0'soi112u1101uioiq//zd11q 111011 pop1201umoq

910Z ‘1918n8nv uo ::

