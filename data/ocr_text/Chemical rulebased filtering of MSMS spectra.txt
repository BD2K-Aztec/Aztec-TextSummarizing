ORIGINAL PAPER

Vol. 29 no. 7 2013, pages 925-932
doi:10. 1093/bioinformatics/btt061

 

Data and text mining

Advance Access publication February 15, 2013

Chemical rule-based filtering of MS/MS spectra

Beata Beizl’2’3, Attila Kertesz-Farkasl, Sandor Pongorl’4 and Michael P. Myersl’5’*

1Protein Structure and Bioinformatics Group, International Centre for Genetic Engineering and Biotechnology, 34149
Trieste, Italy, 2Laboratory of Bioinformatics, Biological Research Centre, Hungarian Academy of Sciences, H—6726
Szeged, Hungary, 8Institute of Informatics, University of Szeged, H—6720 Szeged, 4Faculty of Information Technology,
Pazmany Peter Catholic University, 1083 Budapest, Hungary and 5Protein Networks Group, International Centre for

Genetic Engineering and Biotechnology, 34149 Trieste, Italy

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: Identification of proteins by mass spectrometry—based
proteomics requires automated interpretation of peptide tandem
mass spectrometry spectra. The effectiveness of peptide identification
can be greatly improved by filtering out extraneous noise peaks before
the subsequent database searching steps.

Results: Here we present a novel chemical rule-based filtering algo-
rithm, termed CRF, which makes use of the predictable patterns (rules)
of collision-induced peptide fragmentation. The algorithm selects peak
pairs that obey the common fragmentation rules within plausible limits
of mass tolerance as well as peak intensity and produces spectra that
can be subsequently submitted to any search engine. CRF increases
the positive predictive value and decreases the number of random
matches and thus improves performance by 15—20% in terms of pep-
tide annotation using search engines, such as XITandem. Importantly,
the algorithm also achieves data compression rates of ~75%.
Availability: The MATLAB source code and a web server are available
at http://hydrax.icgeb.trieste.it/CRFilter/

Contact: myers@icgeb.org

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on September 17, 2012; revised on December 23, 2012;
accepted on February 3, 2013

1 INTRODUCTION

Identifying proteins from the mass spectra of their proteolytic
peptides has become a standard method for analyzing complex
biological samples (Aebersold and Mann, 2003). In a typical ex-
periment, mass spectra obtained via liquid chromatography
coupled to tandem mass spectrometry (MS/MS) are compared
with theoretical spectra derived from a sequence database (Yates
et al., 1995) [for reviews, see Becker and Bern (2011), Deutsch
et al. (2008), Jacob (2010), Johnson et al. (2005), MacCoss
(2005), McDonald et al. (2004), Menschaert et al. (2010),
Nesvizhskii (2010), Nesvizhskii and Aebersold (2004),
Neumann and Bocker (2010), Noble and MacCoss (2012) and
Webb-Robertson and Cannon (2007)]. The analysis of a single
sample may require the evaluation of hundreds of thousands of
experimental spectra. Commonly these are laden with extraneous
peaks, which make peptide identiﬁcation particularly difﬁcult.

 

*To whom correspondence should be addressed.

In this work, we address the ﬁltering of preprocessed spectra
[for reviews, see Jacob (2010), Johnson et al. (2005), Mujezinovic
et al. (2006), Reiz et al. (2012) and Salmi et al. (2009)], which
consist of a series of monoisotopic peaks that are characterized
by their fragmentation mass (m/z ratio) and their intensity. The
goal of filtering is to increase the quality of the data while redu-
cing the size of the dataset under analysis. Because the analysis
capacity of instruments is constantly increasing, there is a grow-
ing need for fast and efﬁcient ﬁltering strategies. Brieﬂy, filtering
methods fall into two large categories: spectrum ﬁltering
approaches and peak ﬁltering approaches.

Spectrum ﬁltering approaches seek to identify low-quality
spectra based on their peculiar intensity or m/z distributions,
and subsequently exclude these spectra from further analysis.
One general strategy is to use peptide fragmentation rules to
identify high-quality spectra (Bern et al., 2007; Flikka et al.,
2006; Geer et al., 2004; Hoopmann et al., 2007; Nesvizhskii
et al., 2006; Renard et al., 2009). There are many ways to incorp-
orate peptide fragmentation rules into spectrum annotation, and
in a broad sense, all de novo algorithms and sequence tagging
algorithms use fragmentation rules.

Peak ﬁltering approaches, meanwhile, seek to discard un-
wanted peaks from the spectra of a particular experiment. Such
unwanted peaks are identiﬁed by their low intensities and/or by
the fact that they do not obey the fragmentation rules of a given
experiment. Although technically incorrect, any peak that is
deemed superﬂuous for a particular data processing workﬂow
can be discarded from the spectrum as ‘noise’. For instance, we
can simply retain only the top 50 most intense peaks, or discard
peaks with intensities <5% of the maximum intensity. A number
of laboratories have reported on the use of such classical
signal-to-noise ﬁlters that also reduce the number of peaks in a
spectrum (Geer et al., 2004; Renard et al., 2009; Xu and Freitas,
2010). The advantage of noise ﬁltering methods is that they can
produce cleaner spectra. These can then be further analyzed with
any search engine. However, the signal-to-noise ﬁlters are typic-
ally equally destructive to all low-intensity peaks, regardless of
whether or not they follow the expected fragmentation rules.

To address this problem, we developed a set of spectral pro-
cessing ﬁlters designed to reduce the number of uninformative
peaks in peptide fragmentation spectra. The motivation is to use
the chemical rules of gas-phase peptide fragmentation (Barlow
and O’Hair, 2008; Biemann, 1990) to produce ﬁltered spectra,
which can then be further analyzed by any search engine of

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 925

112 /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; popeommoq

9IOZ ‘091sn3nv uo ::

B. Reiz et al.

 

choice. Importantly, the ﬁlters presented here remove peaks that
do not form b—y (a—x, c—z) pairs or are not separated by the mass
of an amino acid. In contrast to spectrum ﬁltering methods that
use related principles for controlling spectrum quality (Bern
et al., 2004; Flikka et al., 2006; Nesvizhskii et al., 2006), our
strategy only discards peaks deemed to be uninformative,
rather than discarding entire spectra. This peak-by-peak strategy
has negligible computational costs, results in data compression
rates of ~75% and a substantial improvement in the number of
the annotated spectra at the same false discovery rate (FDR)
level as compared with unﬁltered data.

The article is structured as follows: Section 2 describes the data
and the general computational methods, Section 3 describes the
results (i.e. the principle, the algorithm and the tests conducted
on the method) and Section 4 contains the discussion and
conclusions.

2 METHODS

Datasets. The Jurkat dataset is an experimentally acquired set of tryptic
peptide spectra obtained from a human cell extract, collected on a
Thermo LTQ Orbitrap instrument (Kil et al., 2011). The dataset contains
5853 MS/MS spectra (charges from +2 to +6) and were downloaded
from Proteome Commons (https://proteomecommons.org/). UPS, a
second experimental dataset, was created from a tryptic digest of the
Universal Proteomics Standard I (Sigma) using an Applied Biosystems
4800 MALDI-TOF/TOF instrument as previously described (Bish et al.,
2008). The UPS I standard contains 50 human proteins, and our UPS
dataset contains 3368 peptide spectra. HSPP2A dataset (Glatter et al.,
2009), the largest, contains 29 583 spectra (20 773 doubly, 8706 triply, 474
quadruply, 26 quintuply and 4 hexuply charged spectra) obtained with
LTQ mass spectrometer on trypsin-digested human protein phosphatise
2A system and was acquired from www.peptideatlas.org/repository/pub—
lications/Glatter2008.

Top N intensity ﬁlter. We have implemented Top N ﬁlters for a com-
parison as well, which retains the N most intense peaks (Chalkley et al.,
2005; Hansen et al., 2003). N 240—100 gives good results for many
datasets. In our experiments, N was set to 50.

Spectrum identiﬁcation. The raw and the ﬁltered experimental spectrum
datasets have been annotated with Xltandem (version 2010.12.01.1),
Mascot program (version 2.2), MassMatrix (Xu and Freitas, 2010) and
InsPecT version 2012 (Tanner et al., 2005). For all search engines, the
parent and fragment ion mass tolerance were set to 0.1 and 0.3 Da, re-
spectively, for the UPS dataset; 0.03 and 0.3 Da, respectively, for the J urkat
dataset and 0.1 and 0.3 Da, respectively, for the HSPP2A dataset. The IPI
human sequence database (version 3.71) (Kersey et al., 2004) was used as a
reference with XITandem, InsPecT and MassMatrix. We included reversed
sequences as the decoy dataset. The ‘total peaks’ parameter in the
Xltandem program was set to 5000. Default values were used for the rest
of the parameters. Mascot was used with above parameters using the
SwissProt human database (version 2012.03).

Performance evaluation methods. The positive predictive value (PPW is
the ratio of the matching peaks in the experimental spectra over the total
peaks [see Altman and Bland (1994)], formally

#matches

PPV = .
#peaks

Filtering performance was also evaluated by the receiver operator
curve (ROC) technique as follows: a dataset (raw or ﬁltered) was sub-
mitted to a search engine, and the identiﬁed peptides were listed in the
order of decreasing signiﬁcance (increasing E—value). In this list, peptides
of the human proteome were considered positive hits and the peptides of

the decoy dataset were considered negative hits. The number of positive
hits was then plotted as a function of the number of negative (decoy) hits
by varying the decision threshold (Sonego et al., 2008). This plot yields a
monotonously increasing curve, the ROC curve, and higher running
ROC curves indicate better performance. The FDR (Storey and
Tibshirani, 2003) was calculated as the ratio of the number of the
decoy hits over the number of the positive hits at a certain threshold
t by the following formula:

#decoy(t)

FDR“) = #target(t)°

The ROC plot was used to compare methods at the level of the same
FDR value. For instance, FDR = 0.2% is a straight line in the ROC plot,
and its intersections with the ROC curves indicate the number of target
and decoy peaks found at the same level of FDR. FDR: 100% would
coincide with the diagonal x = )2 line.

All calculations and chemical rule-based ﬁltering (CRF) algorithm
were implemented in MATLAB (version R2010b). The source code
and a web server are available at http://hydrax.icgeb.trieste.it/CRFilter/.

3 RESULTS
3.1 Principle of CRF

Given an experimental MS/MS spectrum, CRF seeks to retain
(i) high-intensity peaks that are trusted without further condi-
tions, and (ii) low-intensity peaks that are related to one of the
high-intensity peaks according to any of the following three rules:

0 Mass complementation rule: the sum of the masses of a pair
of the high- and low-intensity peaks that add up to the pre-
cursor mass MH+ + l (e.g. b—y pairs);

0 Amino acid mass distance rule: the mass difference of two
peaks equals to one of the known—native or modiﬁed—
amino acid masses (‘amino acid neighbors’); and

0 Amino acid mass complementation rule: the sum of two
peaks and the precursor mass MH+ differs by one amino
acid mass (e.g. a b-ion and the amino acid neighbor of its

y-pair).

Certain types of instruments may not produce equally intense
b—y (a—x or c—z) peak pairs, for instance, triple quadrupole or
quadrupole-time-of—ﬁight instruments tend to produce only
either b- or y-ions, thus only one member of the ion pair is vis-
ible. In this case, CRF keeps such peaks if they are either intense
enough to be considered high-intensity peaks or are separated by
a mass of an amino acid from high-intensity peaks and hence
pass the amino acid mass distance rule.

Furthermore, when amino acids lose NH3 or H20 on
collision-induced dissociation (CID) fragmentation under certain
circumstances, or when some amino acids carry post-
translational modiﬁcations, CRF keeps these peaks if they are
intense enough or they have a high-intensity amino acid neighbor
and thus pass the ﬁrst or the second rule. Peaks that do not have
amino acid neighbors, such as internal fragment ions, might be
retained if they are high-intensity peaks.

The high- and low-intensity peaks are deﬁned via user-
speciﬁed thresholds (an example is shown in Fig. 1). As an
approximation, the high- and the low-intensity peaks are deﬁned
as the percentage of the estimated maximum peak number
(EMP). Assuming that under the conditions of CID, seven

 

926

112 /310's113umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘091sn3nv uo ::

Chemical rule-based filtering of MS/MS spectra

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

x 104
b'series H P K F E E I L T R
16 — 138.05 235.10 363.19 510.25 639.29 768.33 881.41 994.49 1095.53 1251.63
R T L I E E F K P H
14 Y'ser'es 175.10 276.14 389.22 502.30 631.34 760.38 907.44 1035.53 1132.58 1269.63
Example peak pairings:
12 T Mass Complementation rule: b4 - y4, y5 - b5
Amino Acid Mass Distance rule: y5 - y4, (y1-NH3) - (y2-NH3)
1o _ ‘13. Amino Acid Mass Complementation rule: b3 - y4
p?
(I)
C (\l
“QC-'9 8 — .o
‘2
6‘ g a “A F
Z >
' co
4 — a I; on I
O to l\ to 00 5E '0 Z'
S 03 9. z
2 — a': N I 0']
mg _ x_§,, ALL“ v _ - _ > _
mwxwx HLJ¢—+——rm———
o I ll III IIIIIIII TIII. II l'l III I | l I I | —]—I
200 400 800 1000 1200
M/z

Fig. 1. An illustration of ﬁltering rules [spectrum 953 from the UPS dataset (precursor mass = 1269.69), matching peptide from the human proteome:
HPKFEEILTR]. The high-intensity peaks, marked by red, were obtained using T H: 50. These peaks pass the ﬁltering without further tests. The
low-intensity peaks, marked by blue and obtained using T L = 110. A blue peak is kept if it passes any of the chemical rules (i)—(iii) when paired with a red
peak. For instance, blue peak 175 6 LOW (at 639.39 m/z) and read peak ys 6 HIGH (at 631.44 m/z) satisfy chemical rule (i) their masses add up to 1270.83,
which equals the precursor mass +1 within 0.4 Da tolerance, so 175 will pass. Similarly, blue peak 124 6 LOW (at 760.49 m/z) and red peak ys 6 HIGH
(at 631.44 m/z) satisfy chemical rule (ii) because their masses differ by 129.06 Da, the mass of the Glutamic acid, within 0.4 Da tolerance, so 124 will pass.
Blue peak 124 (at 760.49 m/z) and red peak 173 6 HIGH (at 363.34 m/z) satisfy chemical rule (iii) because their masses add up to 1123.83 Da, which is 146.86
Da apart from the precursor mass +1, and this difference is almost exactly the mass of phenylalanine (146.91 Da). The blue peaks that do not pass any
ﬁlter (marked by a black x) are discarded. The very low-intensity peaks that are not selected to the LOW set are also discarded

ions can be produced for every peptide bond (Roepstorff and
Fohlman, 1984). The number of peptide bonds can thus be
roughly calculated by dividing the precursor mass by the average
mass of amino acids, so EMP can be calculated as
7 - MHJr

AAM ’
where AAM denotes the average amino acid mass, which is
calculated from a table of amino acid masses, plus the masses
of any modiﬁcations that are speciﬁed. For instance, by specify-
ing 30% as the upper threshold and 70% as the lower threshold,
we select 30% of the EMP as ‘high-intensity’ peaks and the next
30—70% as ‘low-intensity’ ones. Peaks in the 71—100% interval
are discarded. EMP is a rough estimate because it does not con-
tain irregular fragmentation events. However, we found it useful
because it does not penalize either small or large peptides.

EMF 2

3.2 Formal description of the CRF algorithm
Let S = [(p,-, ij)]]’7:1 denote a singly charged spectrum of n peaks,

where the pair (pj,iJ-) denotes the mass (m/z) pj and the intensity i]-

of the jth peak, and without the loss of generality, let us assume
the peaks are ordered by the intensity in descending order, i.e.
i1 2 i2 2  Z in. Let TH and TL (TH< TL) be two user-deﬁned
thresholds expressed in percentage of the EMP.

CRF uses T H and T L threshold parameters to calculate two
sets, the HIGH(TH) and LOW(TH, T L) that contain high- and
low-intensity peaks, by

HIGH(TH) = {(p,, 1,.) | 1 g j g 1% . EMF}

LOW(TH, TL) = HIGH(TL)\HIGH(TH) =

{(pj,lj)|1—00-EMP<] 5 l—OO-EMP}

CRF marks every peak in HIGH as accepted, and peaks (p,i) 6
LOW are marked only if there is a peak (q,j) 6 HIGH for which
any of the following rules are satisﬁed:

(i) Mass complementation rule: p + q = MH+ + 1,
(ii) Amino acid mass distance rule: I p — ql 6 AM,
(iii) Amino acid mass complementation rule:
IMH— lp—ql + 1| 6 AM,

where AM denotes the set of the amino acid masses. Finally,
CRF removes the unmarked peaks from the spectrum.

CRF is made tolerant to experimental error by considering
the equations fulﬁlled within user-deﬁned tolerance limits
deﬁned in Daltons. Two such tolerance values are used: AF is
the fragment ion mass (m/z) tolerance and AP is the precursor
ion mass (m/z) tolerance. The values of AF and AP depend on the
accuracy of the mass spectrometer and should be set to approxi-
mately the same values as those used by the search engine.
However, CRF is not indifferent to the tolerance parameters.
In extreme cases of tolerance parameters, the effect of the
three chemical rules becomes insigniﬁcant, and the ﬁltering will
be dominated by the intensity thresholds, which determine the
sets HIGH and LOW. This happens because CRF lets all
peaks pass that are in the sets HIGH or LOW if the tolerance
parameters are too loose. Conversely, if tolerance parameters are
too tight then only peaks in set HIGH will pass and peaks in
LOW will be discarded. These examples illustrate that CRF will
still keep the most intense peaks even under bad parameter
settings.

When a spectrum has a multiply charged precursor ion, all
possible charge states for fragmentation peaks are taken into
consideration, and if such a peak obeys any of the three rules,
the original peak is kept.

 

927

112 /310's112u1no [progxo'sor112u1101urorq//:d11q 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

B. Reiz et al.

 

3.3 Testing the algorithm

To verify that the CRF improves the spectrum identiﬁcation, we
used the Jurkat and the UPS raw spectrum datasets. UPS is a
standardized mixture of proteins, and the dataset was collected
on a MALDI-TOF/TOF instrument. The Jurkat dataset was
collected with an Orbitrap instrument, which is one of the
most commonly used instruments for proteomics. We used
XITandem or the MassMatrix search engines (using decoy se-
quences as described in Section 2). The ﬁltering parameters were
as follows: TH: 50%, TL: 110% for the Jurkat dataset;
TH=70%, TL=120% for the UPS dataset and TH: 120%,
TL = 160% for the HSPP2A dataset (see Section 3.4).

The main hypothesis behind CRF is that selecting peak pairs
based on appropriate chemical rules will decrease the number of
random hits in a ﬁltered spectrum as compared with a raw spec-
trum. For the ﬁrst ‘proof of principle’ test, we produced a histo-
gram of the number of matching peaks between the experimental
and the theoretical spectra obtained from database searching
using XITandem with the UPS dataset (Fig. 2). In general, it is
convenient to divide such a histogram into a left and a right side
roughly corresponding to high and low scores. In the low-scoring
region, the distribution of experimental (target) and randomly
simulated (decoy) datasets coincides. This is a consequence of the
fact that a low number of matches frequently occurs at random
when comparing a spectrum either with target (i.e. real) or with
decoy spectra. On the other hand, in the high-scoring region, the
frequency of the target hits is higher than those of decoy hits.
Figure 2 shows that CRF ﬁltering dramatically decreases
random hits while leaving the true hits essentially intact. This
is shown by the fact that the right-hand tail of the raw and ﬁl-
tered datasets are essentially identical (shown by solid red and
green lines). It is also apparent that the histogram of the decoy
dataset is shifted more by CRF ﬁltering than the histogram of
the target dataset (compare solid green with dashed green lines).
Because signiﬁcance (P-value) is usually expressed as a distance
between target and decoy data, CRF ﬁltering will naturally in-
crease the signiﬁcance of peptide identiﬁcations. This ﬁnding
thus conﬁrms that CRF removes the uninformative peaks in
the spectrum dataset and decreases the inﬂuence of random
matches.

Another way to show the efﬁciency of the ﬁltering is to directly
compare PPVs (Section 2, performance measures) obtained on

 

 

'— CRF - Target

 
 
 
  

 

 

 

-1 ----- CRF - Decoy
1o ' — Raw - Target '
_2 ----- Raw - Decoy
1O - -
>
8 .3
g 10 -
8
LT. 104-

 

 

 

o 5 10 15 30  3o ‘35 40 45 50
#matches

Fig. 2. Histogram of the number of matched peaks obtained during the

database search on the UPS dataset. The data are normalized to fre-

quency values (sum: 1.00)

ﬁltered and raw spectra. We used the XITandem search engine
for spectrum annotation and calculated the number of the the-
oretical peaks that match a peak in an experimental spectrum.
The calculated PPVs were plotted as a function of the precursor
mass (Fig. 3). This ﬁgure shows a large improvement in PPV for
the CRF-ﬁltered spectra. We think that this improvement is due
to the elimination of the uninformative peaks, which improves
the ratio of the matching (informative) peaks in a spectrum.

The ﬁltering also improves the E—values of the XITandem
search results. Figure 4 compares XITandem E—values of raw
and CRF-ﬁltered data on the peptide as well as on the protein
level. In this representation, each spectrum is represented by a
dot of E—value pairs (y-axis corresponds to CRF-ﬁltered E—value
and x—axis to raw E—value). The oblique line corresponds to the
diagonal, yzx, so dots above the line represent spectra where
CRF ﬁltering improves the E—values, while dots below the line
are spectra where CRF ﬁltering had a negative effect (Fig. 4 Left).
It is apparent that the large majority of the annotated spectra
are improved at the peptide level. Protein identiﬁcation data
show a similar trend (B), and here nearly all protein E—values
are improved on CRF ﬁltering. These data are consistent with
the results shown in Figure 4 and indicate that CRF ﬁltering
improves the signiﬁcance of peptide and protein identiﬁcations.

The efﬁciency of CRF and Top50 intensity ﬁltering was com-
pared using ROC analysis (Fig. 5). The raw and ﬁltered datasets
were submitted to the XITandem, MassMatrix, InsPect and
Mascot search engines (using decoy sequences as described in
Section 2), and the lists of identiﬁed peptides were analyzed by
the ROC technique. The ROC curves in Figure 5 indicate that
CRF generally identiﬁed more targets than the two other
approaches.

The intersection points of the ROC curve and the straight line
of FDR=0.2% show, at the same FDR level, that CRF allows
for the annotation of more spectra. Improvements in numbers
are shown in Table 1, obtained with XITandem at the same FDR
level. On the Jurkat dataset, XITandem with CRF ﬁltering iden-
tiﬁes 8.7 and 25.5% more spectra and 8.1 and 21.7% more
unique peptide sequences compared with Top50 and raw, re-
spectively. On the UPS dataset, the improvements achieved
with CRF are 0.5 and 18% for spectra and l and 14% for
unique peptide sequences compared with Top50 ﬁltering and
raw, respectively. When the Jurkat dataset is analyzed with
XITandem, CRF identiﬁes 8% more unique peptides than
Top50, and 22% more than in the raw dataset. On the UPS
dataset, the respective improvements are 1% as compared with
Top50 and 14% as compared with the raw dataset. Table 1
shows the actual number of spectra and unique peptides identi-
ﬁed with the two ﬁlters, respectively. Roughly speaking, CRF
increased both the number of spectra and the number of the
unique peptide sequences by 15—25% as compared with unﬁl-
tered data and by 1—5% compared with Top50 ﬁltered data.

3.4 Parameter selection

CRF has two adjustable threshold parameters: T H is used for
deﬁning the high-intensity peaks that are accepted without con-
dition and T L is used for deﬁning low-intensity peaks that are
accepted only if they form a pair with other high-intensity peaks.
We examined how the thresholds T H and T L affect the spectrum

 

928

112 /310's112u1no [progxo'sor112u1101urorq//:d11q 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

Chemical rule-based filtering of MS/MS spectra

 

NTM'IIGI'I'I'I “LIE - “P5 HIE-ﬂ

h Ru-
I:I1.-I- ' “I'm

II:II
3:
I

memlu III-u

 

 

Wham-l:

I
Elil 1001] I50] 211)] 25015- 31110 3501] m

#ITmImu-mldiw

a.
I“

in:

15 D.

Elli

E.

El:-

nﬂ"

0|

1|
111111 1:11:11 1531:» who

 

 

Fig. 3. PPV values versus precursor mass. CRF ﬁltering improves generally the ratio of the informative peaks among all peaks

IlTa-ndum mnlls- Jurknl dmul

 

 

Midi:an E-n'nlun
Fla-1' mulch}:

IETandarI mum: - Jun-Int dataset

 

 

m.
m—
3111;:-
5;.
?'-1
w
ESE-“1"-
g“.
a:
102m:-
1[II:I- ‘-
.. F"
“IL. _|_ _|._ _|_ _|_ I
103 :IJIJ m EDI] 5:0

11]}
Fruit!" hi] E-mlu-u
I'hllﬂm

Fig. 4. Comparison of CRF-ﬁltered and raw UPS datasets evaluated with XITandem search engine. The diagram on the left side represents peptide
identiﬁcations, while the diagram on the right side shows protein identiﬁcations

UPS dataset with )GTandem

1 200 2000

1 800
1 000
1 600
1 4

800 0°

1 200

 

 

Jurkat dataset with )QTandem

 

 

Jurkat dataset with MassMatrix
2000

/
1800
1600
1400

1200

 

 

“‘5’. 3 ‘5
‘16 600 a 1000 a 1000
I— I— I—
=ﬂ= 4:: a:
800 800
400
600 600
CRF 400 CRF 400 CRF
200 — TOP50 TOP50 TOP50
Raw 200 Raw 200 Raw
— - FDR 0.2% — - FDR 0.2% — - FDR 0.2%
0 o 0
0 1 2 3 4 5 0 1 3 4 5 0 2 4 6 8
# Decoy # Decoy # Decoy
Jurkat dataset with Mascot HSPP2A dataset with )QTandem HSPP2A dataset with Inspect
2000 7000 3500 I
1800
6000 3000
1600
1400 5000 2500
1200
.. ... 4000 .3 2000
3 3. 3
if: 1000 :3 a
I— I— I—
1: :1: :1:
800 3000 1500
600 2000 1000
400 CRF — CRF — CRF
TOP50 1000 TOP50 500 TOP50
200 Raw Raw Raw
— - FDR 0.2% — - FDR 0.2% — - FDR 0.2%
0 0 0
0 2 4 6 8 0 5 10 15 20 25 30 0 5 10 15 20 25

# Decoy

it Decoy

# Decoy

Fig. 5. ROC analysis of the spectrum annotation results of the raw data and the CRF and Top50 ﬁltered J urkat, HSPP2A and the UPS datasets,
obtained with XITandem, Mascot, InsPecT and MassMatrix. These plots show independent improvements by the CRF ﬁlter on various search engines

identiﬁcation results. The number of the identiﬁed peptides at
FDR=0.2% are plotted in Figure 6A as a function of the
threshold parameters. We found a large plateau where the spec-
trum identiﬁcation reaches its maximum. The greatest spectrum
identiﬁcation was seen when T H = 40—90% and T L = 60—160%.
The large plateau illustrates the robustness of CRF because even
with a wide variety of settings, the ﬁlters are highly efﬁcient at

retaining the informative peaks. We also plotted the percentage
of kept peaks (data compression) for various values of T H and
T L (Fig. 6B). These results indicate that CRF is relatively refrac-
tory to the values for T H and T L, except for extremely low (too
stringent) and high (too permissive) values. Therefore, we expect
that only a minimal sample-to-sample tuning will be necessary
for the use of CRF. Importantly, a substantial decrease in

 

929

112 /810's112u1no [pJOJXO'SOIlBUlJOJUIOIQ//IC1111] 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

B. Reiz et al.

 

Table 1. Search results using XITandem with CRF, Top50 ﬁltered and raw datasets

 

 

 

 

Dataset CRF versus Top50 CRF versus raw
CRF only Common Top50 only CRF only Common Raw only

Spectra

Jurkat 182 1604 38 380 1406 28

UPS 57 800 52 148 709 19
Unique peptides

Jurkat 153 1316 43 306 1163 44

UPS 55 599 47 113 541 34

 

The numbers represent the number of the identiﬁed spectra or the number of the identiﬁed unique peptide sequences, as indicated at
FDR = 0.2 %.

   

on (O

# spectrum identification
‘1

01

h 0)
Massage

compression ratio

 

Fig. 6. CRF performance at various (T H, T L) parameter pairs on the
UPS dataset using XITandem using parameters described in Section 2.
(A) The number of annotated spectra, calculated at FDR=0.2%.
(B) Data compression ratio (% of peaks kept)

dataset size accompanies the improvement. Based on these
results, we chose T H: 50 and T L: 120% as the default values.

CRF has two tolerance parameters: AF is the fragment ion
mass (m/z) tolerance and AP is the precursor ion mass (m/z)
tolerance; their role is brieﬂy discussed above (end of Section
3.2). The values of AF and AP depend on the accuracy of the
mass measurements and are to be set by the experimenter. In our
case, we used AF = 0.3 Da and AP = 0.3 Da for the UPS dataset
and AF=0.3 Da and AP=0.03 Da for the Jurkat dataset.

3.5 Post-translational and chemical modiﬁcations

Identiﬁcation of post-translational and chemical modiﬁcations is
becoming an increasingly important part of the analysis of

proteomics data and accounting for modiﬁcations plays a fun-
damental role in MS data (Tanner et al., 2005). To handle mod-
iﬁed peaks, CRF uses an amino acid table that is adjustable for
both complete and partial modiﬁcations. We studied this prob-
lem on the UPS dataset in which the modiﬁcations were ac-
counted for during database searching: carbamidomethylation
(57.02 Da on Cys) as a ﬁxed modiﬁcation, deamidation (0.98
Da on Asn and Gln) and oxidation (15.99 Da on Met) both as
partial modiﬁcations. In the raw dataset, XITandem annotated
735 spectra at FDR: 0.2%. When CRF was used without spe-
cifying modiﬁcations, 864 spectra were identiﬁed; when the
above modiﬁcations were applied during ﬁltering, the number
of annotated spectra increased to 866. In other words, the in-
crease with respect to the raw data is substantial regardless of
whether the modiﬁed amino acids are correctly speciﬁed during
ﬁltering. We checked the shifted peaks in the spectra (details not
shown) and found that the marginal increase in the number of
identiﬁed spectra (866 versus 864) was due only to a few shifted
peaks. This may appear somewhat counterintuitive; however, we
note that amino acid modiﬁcations do not change most of the
inter-peak distances on which CRF is based. So CRF will detect
spectra of peptides containing modiﬁed residues well even if the
modiﬁcations are not, or incorrectly, speciﬁed (also see
Supplementary Materials).

4 DISCUSSION

We have developed a spectrum ﬁltering method based on the
gas-phase chemistry of peptide fragmentation and we therefore
refer to this strategy as CRF. The main goal of this ﬁltering
strategy is to enrich for peaks that most search engines recognize
as coming from fragmented peptides. We have used a series of
rules: one based on ﬁnding b—y complementary pairs, one based
on ﬁnding peaks separated by the mass of an amino acid residue
(amino acid neighbors) and a third one that is a combination of
the ﬁrst two. We found that CRF ﬁltering improves peptide an-
notation by 15—25%, at the same FDR level, and provides an
~75% compression of the data.

We have tested the CRF on data collected with MALDI-TOF/
TOF, ion trap and Orbitrap ion trap hybrid instruments. We
have found that the CRF approach also improves the search
engine performance with respect to these data. However, data
compression and search engine performance gains with ion trap

 

930

112 /310's112u1no [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

Chemical rule-based filtering of MS/MS spectra

 

data were not as great as those achieved with datasets coming
from high-resolution instruments. The principle weaknesses with
ion trap data are the high mass errors, which requires the mass
tolerance to be >1 Da and ambiguities in the charge states. Both
these issues cause ﬁlters to keep more extraneous peaks in the
output. However, even with ion trap data, CRF yielded ~50%
data compression and a 10% increase in terms of spectrum
annotations.

CRF is most similar to sequence tagging algorithms. However,
CRF produces peak list that can be analyzed using standard
spectral matching algorithms. A number of groups have pub-
lished similar algorithms designed to perform quality control
checks on each spectra (Flikka et al., 2006; Hoopmann et al.,
2007; Nesvizhskii et al., 2006). Spectra that do not have enough
amino acid neighbors, or b—y pairs, are typically excluded from
the search, while those that pass the quality control check are
searched in total. In essence, the rule-based ﬁlters are performing
a similar quality control check. However, this control is per-
formed at the level of individual peaks, rather than complete
spectra. This removes ~75% of all the peaks in the dataset
and results in 15—25% more annotated spectra at the same
FDR level.

The BYONIC search engine uses a similar strategy, where
lookup peaks are extracted from spectra and then searched
using a custom algorithm (Bern et al., 2007). Not only does
our strategy differ in the rules that are used to select peaks,
but we output the selected (and in a separate ﬁle, the discarded)
peaks in the MASCOT Generic Format (mgf). Searching with
the discarded peaks resulted in no legitimate peptide identiﬁca-
tions, which indicates the rule-based ﬁlters are efﬁcient at retain-
ing the informative peaks and removing noise peaks.

Geer et al. (2004) and Renard et al. (2009) come close to using
CRF, in that they apply their Top N ﬁlter within a set window
surrounding the most intensive peaks. The rational for this ﬁl-
tering is that a true peak should have no more than one true
neighbor within 57 Da (the mass of the smallest amino acid),
which in the case of a b-ion would be a y-ion (Geer et al., 2004).
We have purposefully omitted this type of strategy because the
small neutral losses of water and ammonia are often helpful in
interpreting spectra and the a-type ion is particularly useful in
identifying the b-ion series (Bern and Goldberg, 2006).

The MASCOT search engine uses a different approach to
spectral ﬁltering. MASCOT initially searches with a restricted
set of high-intensity fragment ions and then iteratively repeats
the search using the less intense peaks, until it is clear that the
results are no longer being improved. This is incredibly effective
at ﬁnding the best set of peaks in a spectrum, but it is not com-
putationally efﬁcient and does not allow for data compression.

Unfortunately, the current batch of de novo and sequence tag-
ging search algorithms do not allow the output of the peaks they
select to be analyzed. Many of these programs use sophisticated
peak picking algorithms and they are likely to produce similar, or
even greater, improvements than seen with the chemical
rule-based ﬁlters (Bern et al., 2007; Tanner et al., 2005).
However, one advantage of using a simpler algorithm is that it
is relatively fast. For example, it takes only 2.8 s to ﬁlter 1000
spectra (347 821 peaks) on a PC [with a 3 GHz Intel Core2 pro-
cessor (Q6850, 3.00GHz, 8 GB RAM) running under Fedora

release 8 Linux operating system]. The time estimate does not
include input/output operations.

Because CRF efﬁciently extracts the peaks coming from pep-
tide fragmentations, PPV and the expectation value of the spec-
tra are increased (Figs 3 and 4, respectively), while the number of
random matches is reduced (Fig. 2). Interestingly, the best scor-
ing matches from the unﬁltered data typically do not improve as
much as more marginal spectra. We think this is largely owing to
the fact that the best scoring matches may leave little room for
further improvement. The use of the chemical rule-based ﬁlters
greatly improved the performance of the tested search algorithms
as has been shown by ROC analysis (Fig. 5).

CRF is easy to use and its performance compares favorably
with the ﬁlters based solely on signal-to-noise or raw intensity
measures. We hope this approach will be useful for the analysis
of large-scale proteomics data.

ACKNOWLEDGEMENTS

The authors thank Dr Somdutta Dhir (ICGEB) for her help and
advice.

Funding: The work at ICGEB, Trieste, was supported by the
ICGEB PhD program in Molecular Biology (B.R.). The work
at BRC, Szeged, was supported by the Informatics PhD Program
of the University of Szeged, Hungary (BR), and by grant no.
TAMOP-4.2.2-08/1/2008-008 from the Hungarian National
Ofﬁce for Research and Technology (NKTH). The work at
Pazmany University was partially supported by NKTH grants
TET_10-1-2011-0058, TAMOP-4.2.1.B_11/2/KMR-2011-0002
and TAMOP-4.2.2/B-10/1-2010-0014.

Conflict of Interest: none declared.

REFERENCES

Aebersold,R. and Mann,M. (2003) Mass spectrometry-based proteomics. Nature,
422, 198—207.

Altman,D.G. and Bland,J.M. (1994) Diagnostic tests 2: Predictive values. BMJ,
309, 102.

Barlow,C.K. and O’Hair,R.A. (2008) Gas-phase peptide fragmentation: how under-
standing the fundamentals provides a springboard to developing new chemistry
and novel proteomic tools. J. Mass Spectrom, 43, 1301—1319.

Becker,C.H. and Bern,M. (2011) Recent developments in quantitative proteomics.
Mutat. Res., 722, 171—182.

Bern,M. and Goldberg,D. (2006) De novo analysis of peptide tandem mass spectra
by spectral graph partitioning. J. Comput. Biol, 13, 364—378.

Bern,M. et al. (2004) Automatic quality assessment of peptide tandem mass spectra.
Bioinformatics, 20 (Suppl. 1), i49—i54.

Bern,M. et al. (2007) Lookup peaks: a hybrid of de novo sequencing and database
search for protein identiﬁcation by tandem mass spectrometry. Anal. Chem, 79,
1393—1400.

Biemann,K. (1990) Sequencing of peptides by tandem mass spectrometry and
high-energy collision-induced dissociation. Methods Enzymol., 193, 455—479.
Bish,R.A. et al. (2008) Conjugation of complex polyubiquitin chains to WRNIPl.

J. Proteome Res., 7, 3481—3489.

Chalkley,R.J. et al. (2005) Bioinformatic methods to exploit mass spectrometric
data for proteomic applications. Methods Enzymol., 402, 289—312.

Deutsch,E.W. et al. (2008) Data analysis and bioinformatics tools for tandem mass
spectrometry in proteomics. Physiol. Genomics, 33, 18—25.

Flikka,K. et al. (2006) Improving the reliability and throughput of mass spectro-
metry-based proteomics by spectrum quality ﬁltering. Proteomics, 6, 2086—2094.

Geer,L.Y. et al. (2004) Open mass spectrometry search algorithm. J. Proteome Res.,
3, 958—964.

 

931

112 /310's112u1no [progxo'sor1eu1101urorq//:d11q 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

B. Reiz et al.

 

G1atter,T. et al. (2009) An integrated workﬂow for charting the human interaction
proteome: insights into the PP2A system. Mol Syst. Biol, 5, 237.

Hansen,K.C. et al. (2003) Mass spectrometric analysis of protein mixtures at low
levels using cleavable l3C—isotope-coded afﬁnity tag and multidimensional chro-
matography. Mol Cell. Proteomics, 2, 299—314.

Hoopmann,M.R. et al. (2007) High-speed data reduction, feature detection, and
MS/MS spectrum quality assessment of shotgun proteomics data sets using
high-resolution mass spectrometry. Anal. Chem, 79, 5620—5632.

J acob,R.J . (2010) Bioinformatics for LC-MS/MS-based proteomics. Methods Mol
Biol, 658, 61—91.

J ohnson,R.S. et al. (2005) Informatics for protein identiﬁcation by mass spectrom-
etry. Methods, 35, 223—236.

Kersey,P.J. et al. (2004) The International Protein Index: an integrated database for
proteomics experiments. Proteomics, 4, 1985—1988.

Kil,Y.J. et al. (2011) Preview: a program for surveying shotgun proteomics tandem
mass spectrometry data. Anal. Chem, 83, 5259—5267.

MacCoss,M.J. (2005) Computational analysis of shotgun proteomics data. Curr.
Opin. Chem. Biol, 9, 88—94.

McDonald,W.H. et al. (2004) MSl, MS2, and SQT-three uniﬁed, compact, and
easily parsed ﬁle formats for the storage of shotgun proteomic spectra and
identiﬁcations. Rapid Commun. Mass Spectrom, 18, 2162—2168.

Menschaert,G. et al. (2010) Peptidomics coming of age: a review of contributions
from a bioinformatics angle. J. Proteome Res., 9, 2051—2061.

Mujezinovic,N. et al. (2006) Cleaning of raw peptide MS/MS spectra: improved
protein identiﬁcation following deconvolution of multiply charged peaks, iso-
tope clusters, and removal of background noise. Proteomics, 6, 5117—5131.

Nesvizhskii,A.I. (2010) A survey of computational methods and error rate estima-
tion procedures for peptide and protein identiﬁcation in shotgun proteomics.
J. Proteomics, 73, 2092—2123.

Nesvizhskii,A.I. and Aebersold,R. (2004) Analysis, statistical validation and dissem-
ination of large-scale proteomics datasets generated by tandem MS. Drug
Discov. Today, 9, 173—181.

Nesvizhskii,A.I. et al. (2006) Dynamic spectrum quality assessment and iterative
computational analysis of shotgun proteomic data: toward more efﬁcient iden-
tiﬁcation of post-translational modiﬁcations, sequence polymorphisms, and
novel peptides. Mol Cell. Proteomics, 5, 652—670.

Neumann,S. and Bocker,S. (2010) Computational mass spectrometry for metabo-
lomics: identiﬁcation of metabolites and small molecules. Anal. Bioanal. Chem,
398, 2779—2788.

Noble,W.S. and MacCoss,M.J. (2012) Computational and statistical analysis of
protein mass spectrometry data. PLoS Comput. Biol, 8, 61002296.

Reiz,B. et al. (2012) Data preprocessing and ﬁltering in mass spectrometry based
proteomics. Curr. Bioinformatics, 7, 212—220.

Renard,B.Y. et al. (2009) When less can yield more%omputational preprocessing
of MS/MS spectra for peptide identification. Proteomics, 9, 4978—4984.

Roepstorff,P. and Fohlman,J. (1984) Proposal for a common nomencla-
ture for sequence ions in mass spectra of peptides. Biomed. Mass Spectrom,
11, 601.

Salmi,J. et al. (2009) Filtering strategies for improving protein identiﬁcation in
high-throughput MS/MS studies. Proteomics, 9, 848—860.

Sonego,P. et al. (2008) ROC analysis: applications to the classiﬁcation of biological
sequences and 3D structures. Brief Bioinformatics, 9, 198—209.

Storey,J.D. and Tibshirani,R. (2003) Statistical signiﬁcance for genomewide studies.
Proc. Natl. Acad. Sci. USA, 100, 9440—9445.

Tanner,S. et al. (2005) InsPecT: identiﬁcation of posttranslationally modiﬁed
peptides from tandem mass spectra. Anal. Chem, 77, 4626—4639.

Webb-Robertson,B.J. and Cannon,W.R. (2007) Current trends in computational
inference from mass spectrometry-based proteomics. Brief Bioinformatics, 8,
304—317.

Xu,H. and Freitas,M.A. (2010) A dynamic noise level algorithm for spectral screen-
ing of peptide MS/MS spectra. BM C Bioinformatics, 11, 436.

Yates,J.R., 3rd et al. (1995) Method to correlate tandem mass spectra of modiﬁed
peptides to amino acid sequences in the protein database. Anal. Chem, 67,
1426—1436.

 

932

112 /810's112u1no [progxo'sor1eu1101urorq//:d11q 111011 p3p1201umoq

9IOZ ‘091sn8nv uo ::

