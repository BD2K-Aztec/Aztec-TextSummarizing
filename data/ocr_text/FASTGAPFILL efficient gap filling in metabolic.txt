APPLICATIONS NOTE V°" 33.5%.lggi‘ili‘aiﬁéiiiﬁffﬁgil

 

Systems biology

Advance Access publication May 7, 2014

FASTGAPFILL: efficient gap filling in metabolic networks

Ines Thiele", Nikos Vlassis and Ronan M. T. Fleming
Luxembourg Centre for Systems Biomedicine, University of Luxembourg, Luxembourg, L—4362

Associate Editor: Igor Jurisica

 

ABSTRACT

Motivation: Genome-scale metabolic reconstructions summarize
current knowledge about a target organism in a structured manner
and as such highlight missing information. Such gaps can be filled
algorithmically. Scalability limitations of available algorithms for gap
filling hinder their application to compartmentalized reconstructions.
Results: We present FASTGAPFILL, a computationally efficient tractable
extension to the COBRA toolbox that permits the identification of
candidate missing knowledge from a universal biochemical reaction
database (e.g. Kyoto Encyclopedia of Genes and Genomes) for a
given (compartmentalized) metabolic reconstruction. The stoichiomet-
ric consistency of the universal reaction database and of the metabolic
reconstruction can be tested for permitting the computation of
biologically more relevant solutions. We demonstrate the efficiency
and scalability of FASTGAPFILL on a range of metabolic reconstructions.
Availability and implementation: FASTGAPFILL is freely available from
http://thielelab.eu.

Contact: ines.thiele@uni.lu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 21, 2013; revised on April 29, 2014; accepted on
April 30, 2014

1 INTRODUCTION

A biomolecular network reconstruction summarizes biochemical,
physiological and genomic knowledge in a mathematically struc-
tured electronic format (Palsson, 2006). It can be converted into
a computational model, and predictions have been used to ac-
celerate biotechnological and biomedical discoveries (Oberhardt
et al., 2010). The predictive capacity and accuracy of a model
depend on the comprehensiveness and biochemical ﬁdelity of the
reconstruction, with respect to the underlying biochemistry.
The comprehensiveness of a genome-scale metabolic reconstruc-
tion can be improved by using the model to detect and ﬁll
network gaps (Rolfsson et al., 2011). Similarly, reconstruction
ﬁdelity can be improved by using the model to detect reconstruc-
tion stoichiometry inconsistent with biochemistry (Gevorgyan
et al., 2008) or reactions inconsistent with steady state ﬂux
Wlassis et al., 2014).

Existing gap-ﬁlling algorithms, reviewed by Orth and Palsson
(2010), become intractable in high dimensions.
Decompartmentalization of genome-scale compartmentalized
metabolic networks reduces their dimension, rendering gap
ﬁlling tractable (Rolfsson et al., 2011). However, this approach
underestimates the amount of missing information because it

 

*To whom correspondence should be addressed.

connects reactions that would normally not co-occur in the
same cellular compartment.

We present FASTGAPF ILL, the ﬁrst scalable algorithm
capable of efﬁciently detecting and ﬁlling network gaps in com-
partmentalized genome-scale models. FASTGAPFILL draws on,
and extends, fastcore Wlassis et al., 2014), an algorithm to ap-
proximate the cardinality function to identify a compact
ﬂux consist ent model, in which all reactions carry a non-zero
ﬂux in at least one ﬂux distribution. FASTGAPFILL allows inte-
grating all three notions of model consistency, namely, gap-ﬁll-
ing, ﬂux consistency and stoichiometric consistency in a single
tool.

2 METHODS

Formulation of the gap-filling problem. In the metabolic gap-ﬁlling prob-
lem (Reed et al., 2006), one starts with a computational metabolic model,
M, that contains at least one blocked reaction, which, though desired,
does not admit a non-zero steady state ﬂux. From a universal database,
e.g. the Kyoto Encyclopedia of Genes and Genomes (KEGG) (Kanehisa
and Goto, 2000), a search is made for at least one reaction that needs to
be added to ﬁll at least one gap in the model, such that at least one
formerly blocked reaction can carry ﬂux. Among other criteria, it may
also be desirable to compute a compact ﬂux consistent model, where the
number of added universal reactions is minimal. A speciﬁc instance of
this problem occurs in metabolic modeling, although our algorithm is
applicable for any biochemical network model with gaps.

Computing a compact flux consistent model. We repurposed the recently
developed FASTCORE algorithm Wlassis et al., 2014) to compute a near-
minimal set of reactions that need to be added to an input metabolic
model M to render it ﬂux consistent. FASTCORE takes inputs M and a core
set of reactions C C M. Then, it greedin expands C by computing a set of
modes of M whose overall support contains the whole of C and a minimal
set from M \C. This is achieved by a series of Ll-norm regularized linear
programs that optimize a relaxed version of an (intractable) integer
program under cardinality constrains Wlassis et al., 2014). Our
implementation efﬁciently identiﬁes blocked reactions.

Preprocessing to generate a global model. A cellularly compartmenta-
lized metabolic model (S) without blocked reactions (B), where
S U B E M, is expanded by a universal metabolic database U (6. g.
KEGG), such that a copy of U is placed in each cellular compartment
of S (including the extracellular space), to generate S U. For each metab-
olite occurring in a non-cytosolic compartment, a reversible intercom-
partmental transport reaction is added. For each extracellular
metabolite, an exchange reaction is added. The sum of the latter two
reaction sets (X) is added to SU to generate a global model, which is
extended with solvable blocked reactions (BS C B), that is, reactions that
were previously ﬂux inconsistent but become flux consistent when added
to the global model. In the extended global model (S UX), all reactions are
ﬂux consistent. Note that not all blocked reactions B may be solvable,
and thus, they will not be present in SUX. All reactions of S and BS
represent the core set.

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by—nc/3.0/), which
permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals. permissions@ou p.com

112 ﬂJO'spaumo[pJOJXO'sopchogurorq/ﬁd11q IIIOJJ popcorn/hog

910K ‘09 lsnﬁnV no :2

l.Thiele et al.

 

Table 1. Gap ﬁlling of metabolic reconstructions on a standard desktop computer (Dell, Intel Core i5, 16 GB RAM, 64 bit)

 

Thermotoga maritima Escherichia coli
(Zhang et al., 2009)

Model name

(Feist et al., 2007)

Synechocystis sp. sIEC Recon 2
Nogales et al., 2012) (Sahoo and Thiele, 2013) (Thiele et al., 2013)

 

S“1 418 x 535 1501 x 2232
SUXa 14020x 31566 21 614x49 355
Compb 2 3

B 1 16 196

B, 84 1 59

Number of gap-ﬁlling reactions 87 138

Z‘preprocessing (S)c  

Z‘fastGapFill (S)  

632 x 731 834 x 1260 3187 x 5837

28 174 x 62 866 48 970 x 109 522 58 672 x 132 622
4 7 8

132 22 1603

100 17 490

172 14 400

344 1003 5552

435 194 1826

 

aThe dimensions are given as metabolites X reactions.
bComp, compartments.

cPreprocessing includes computing the ﬂux consistent metabolic model, merging of UX for all compartments of S and adding solvable blocked reactions BS.
Note: Equal weighting of all reactions was used. See Supplementary Table SI for candidate gap-ﬁlling solutions.

Computing a compact flux consistent subnetwork of a global model.
FASTGAPFILL computes a subnetwork of S UX , consisting of all core
reactions, plus a minimal number of reactions from UX, such that all
reactions in the resulting compact subnetwork are flux consistent. This is
achieved by using a slightly modiﬁed version of FASTCORE, in which a
vector of linear weightings prioritizes the addition of reactions within
UX. For instance, one may prioritize the addition of metabolic reactions
from U over transport reactions from X, or, by varying the weightings on
non-core reactions, alternate compact sets of gap-ﬁlling reactions may be
identiﬁed.

Optional analysis of gap-ﬁlling reactions. We provide the option to
compute a ﬂux vector that maximizes the flux through each blocked
reaction in turn, while minimizing the Euclidean norm of ﬂux through
the subnetwork of S UX computed by one call to FASTGAPFILL. Note that
flux through more than one solvable blocked reaction may be necessary
to ﬁll a gap, and that the computed flux vector may not be of minimum
cardinality.

Computing stoichiometric consistency. Many reaction databases con-
tain stoichiometric inconsistencies (Gevorgyan et al., 2008), where the
stoichiometry for at least two reactions is inconsistent with conservation
of mass. For instance, the reactions A x=‘ B and A \=‘ B+ C are stoichio-
metrically inconsistent, as no positive molecular mass can be assigned to
A, B and C, such that the mass on both sides of both reactions is equal.
FASTGAPFILL allows to identify stoichiometrically inconsistent reactions
from ﬁlling gaps, by using the scalable approach for approximate cardin-
ality maximization used within FASTCORE, to compute a maximal set of
metabolites in U that are involved in reactions that conserve mass.

3 IMPLEMENTATION

An open source, MATLAB (Mathworks, Inc.), implementation
of FASTGAPFILL is available as a cross-platform desktop com-
puter extension to the openCOBRA toolbox (Schellenberger
et al., 2011).

4 DISCUSSION

We applied FASTGAPFILL to ﬁve metabolic models (Table 1),
demonstrating its broad applicability and scalability for various
sizes of the gap-ﬁlling problem. Alternate gap-ﬁlling solutions
can be computed by changing weightings on non-core reactions
in the preprocessed problem. Note that all candidate metabolic

and transport reactions are hypotheses requiring experimental
validation (Rolfsson et al., 2011). Our implementation provides
an openCOBRA (Schellenberger et al., 2011) compatible version
of the KEGG reaction database; however, any other universal
reaction database could be used with FASTGAPF ILL, so long as the
same input format is maintained and care is taken to correctly
identify identical metabolites. FASTGAPFILL is the ﬁrst scalable
approach to identify candidate missing knowledge in compart-
mentalized metabolic reconstructions, and the approach is
applicable to any form of biochemical network gap-ﬁlling
problem.

Funding: IT. was supported by an ATTRACT program grant
(FNR/A12/01) from the Luxembourg National Research Fund
(FNR). R.F. was supported by the Interagency Modeling and
Analysis Group, Multi-scale Modeling Consortium U01 awards
from the National Institute of General Medical Sciences, award
GM102098-01, and US. Department of Energy, Ofﬁce of
Science, Biological and Environmental Research Program,
award ER65524.

Conflict of Interest: none declared.

REFERENCES

Feist,A.M. et al. (2007) A genome—scale metabolic reconstruction for Escherichia
coli K—12 MG1655 that accounts for 1260 ORFs and thermodynamic informa-
tion. Mol. Syst. Biol, 3, 121.

Gevorgyan,A. et al. (2008) Detection of stoichiometric inconsistencies in biomole-
cular models. Bioinformatics, 24, 2245—2251.

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and
genomes. Nucleic Acids Res., 28, 27—30.

Nogales,J. et al. (2012) Detailing the optimality of photosynthesis in cyanobacteria
through systems biology analysis. Proc. Natl Acad. Sci. USA, 109, 2678—2683.

Oberhardt,M.A. et al. (2010) Metabolic network analysis of Pseudomonas aerugi-
nosa during chronic cystic ﬁbrosis lung infection. J. Bacteriol, 192, 5534—5548.

Orth,J. and Palsson,B.0. (2010) Systematizing the generation of missing metabolic
knowledge. Biotechnol. Bioeng, 107, 403—412.

Palsson,B.0. (2006) Systems Biology: Properties of Reconstructed Networks.
Cambridge Univ Press, New York.

Reed,J.L. et al. (2006) Systems approach to reﬁning genome annotation. Proc. Natl
Acad. Sci. USA, 103, 17480—17484.

 

2530

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ popcorn/hog

910K ‘09 lsnﬁnV no :2

FAerAPFILL

 

Rolfsson,0. et al. (2011) The human metabolic reconstruction Recon 1 directs
hypotheses of novel human metabolic functions. BM C Syst. Biol, 5, 155.
Sahoo,S. and Thiele,I. (2013) Predicting the impact of diet and
enzymopathies on human small intestinal epithelial cells. Hum. Mol Genet,
22, 2705—2722.

Schellenberger,J. et al. (2011) Quantitative prediction of cellular metabolism with
constraint—based models: the COBRA Toolbox V2.0. Nat. Protoc., 6,
1290—1307.

Thiele,I. et al. (2013) A community-driven global reconstruction of human metab-
olism. Nat. Biotechnol, 31, 419—425.

V1assis,N. et al. (2014) Fast reconstruction of compact context-speciﬁc metabolic
network models. PLoS Comp. Biol, 10, e1003424.

Zhang,Y. et al. (2009) Three—dimensional structural View of the central metabolic
network of T hermotoga maritima. Science, 325, 1544—1549.

 

2531

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ popcorn/hog

910K ‘09 lsnﬁnV no :2

