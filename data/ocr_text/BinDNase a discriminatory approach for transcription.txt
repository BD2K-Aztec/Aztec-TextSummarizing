Bioinformatics, 31 (17), 2015, 2852—2859

doi: 10.1093/bioinformatics/btv294

Advance Access Publication Date: 7 May 2015
Original Paper

 

Systems biology

BinDNase: a discriminatory approach for
transcription factor binding prediction using
DNase I hypersensitivity data

Juhani Kahara* and Harri Lahdesmaki

Department of Information and Computer Science, Aalto University School of Science, Fl-00076 Aalto, Finland

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on October 10, 2014; revised on April 15, 2015; accepted on May 4, 2015

Abstract

Motivation: Transcription factors (TFs) are a class of DNA—binding proteins that have a central role
in regulating gene expression. To reveal mechanisms of transcriptional regulation, a number of
computational tools have been proposed for predicting TF—DNA interaction sites. Recent studies
have shown that genome—wide sequencing data on open chromatin sites from a DNase I
hypersensitivity experiments (DNase—seq) has a great potential to map putative binding sites of all
transcription factors in a single experiment. Thus, computational methods for analysing DNase—
seq to accurately map TF—DNA interaction sites are highly needed.

Results: Here, we introduce a novel discriminative algorithm, BinDNase, for predicting TF—DNA
interaction sites using DNase—seq data. BinDNase implements an efficient method for selecting
and extracting informative features from DNase 1 signal for each TF, either at single nucleotide
resolution or for larger regions. The method is applied to 57 transcription factors in cell line K562
and 31 transcription factors in cell line HepG2 using data from the ENCODE project. First, we show
that BinDNase compares favourably to other supervised and unsupervised methods developed for
TF—DNA interaction prediction using DNase—seq data. We demonstrate the importance to model
each TF with a separate prediction model, reflecting TF—specific DNA accessibility around the TF—
DNA interaction site. We also show that a highly standardised DNase—seq data (pre)processing is a
requisite for accurate TF binding predictions and that sequencing depth has on average only a
moderate effect on prediction accuracy. Finally, BinDNase’s binding predictions generalise to other
cell types, thus making BinDNase a versatile tool for accurate TF binding prediction.

Availability and implementation: R implementation of the algorithm is available in: http://research.
ics.aalto.fi/csb/software/bindnasel.

Contact: juhani.kahara@aalto.fi

Supplementary information: Supplemental data are available at Bioinformatics online.

 

1 Introduction

 

Transcriptional regulation is largely controlled by transcription fac—
tors (TFs) that bind short DNA sequence motifs in gene promoters,
enhancers and other regulatory sites. Many TFs bind DNA in a se—
quence specific manner and understanding TF binding is integral to
understanding gene regulatory networks. Moreover, changes in the
genomic DNA, such as SNPs, at TF—DNA interaction sites can affect

TF binding and can contribute to phenotypic differences, including
gene expression (Kasowski et 61]., 2010), but can also contribute to
various diseases (Matsuda et 61]., 1992; Wittwer et 61]., 2006).
Determining the locations of TF-binding sites is therefore of high
importance.

Commonly used computational strategies for predicting TF-
binding include DNA motif based prediction of TF binding sites

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2852

9mg ‘09 1sn3nv uo sepﬁuv s01 ‘erulomeg aIo Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pepeommoq

BinDNase

 

(Weirauch et 61]., 2013) and simultaneous analysis of DNA motifs
and histone modification data (e.g. (Ramsey et 61]., 2010)) or DNase
I hypersensitivity experiments followed by sequencing (DNase—seq)
(Boyle et 61]., 2008). The current state—of—art method for genome—
wide profiling of TF-binding is chromatin immunoprecipitation fol-
lowed by sequencing (ChIP—seq). ChIP—seq can however map the
positions of only one TF per experiment and requires a specific,
ChIP—grade antibody for the protein of interest. On the contrary,
DNase—seq detects signal at open chromatin sites genome—wide.
Consequently, DNase—seq is increasingly used to complement ChIP-
seq experiments because a single DNase—seq experiment can provide
valuable information about putative TF—DNA interaction sites for
all TFs. Genome—wide maps of putative regulatory sites in selected
cell types detected using DNase—seq data have already been created
e.g. in the ENCODE project (Neph et 61]., 2012).

Currently the exact locations of TF—binding events are pin—
pointed by finding stereotypic DNase I footprints. These footprints
are short genomic locations of low DNase I cleavage activity imme—
diately ﬂanked by high DNase activity. An illustration of such regu—
latory site is shown in Figure 1a where the ATF1 motif locations
within ChIP—seq peaks are characterised with low DNase activity
and the ﬂanking regions exhibit high DNase activity. Finding stereo—
typic DNase I footprints does not require any information about the
DNase I signal at the true binding sites, and therefore many methods
using this definition of a TF footprint are unsupervised methods. It
should also be acknowledged that these algorithms are transcription
factor agnostic as they can only predict whether any TF is bound to
a given site.

It has however been reported in (Neph et 61]., 2012), that for
some proteins nucleotides in the middle of TF—DNA interface are
exposed to DNase I cleavage. Therefore, treating all the nucleotides
as protected in the TF—DNA interface might not be adequate. The
exposed nucleotides differ between TFs and this high resolution in-
formation might be useful for making more accurate predictions and
distinguishing which TFs actually occupy the sites. Most of the cur—
rently used methods developed for identifying footprints use the ca—
nonical definition of DNase footprints of low DNase activity
ﬂanked by high activity. These methods can be supervised
(MILLIPEDE) (Luo and Hartemink, 2013), in which the predictions
are made using models trained on training data, or unsupervised
(Neph et 61]., 2012; Piper et 61]., 2013), which rely on giving TFs
binding scores according to a model devised without training data.
Some unsupervised methods, such as CENTIPEDE and PIQ, include
nucleotide resolution information (Pique—Regi et 61]., 2011;
Sherwood et 61]., 2014).

On the other hand, a recent paper shows that the nucleotide
resolution DNase I cleavage pattern is partly caused by the intrinsic
sequence bias of the DNase molecule (He et 61]., 2014) suggesting
that the nucleotide resolution DNase—seq signal at the TF-DNA
interaction site does not necessarily provide predictive power to dis—
tinguish real binding sites. Moreover, DNase I footprint signal at in—
dividual genomic locations are noisy as illustrated in Figure 1b. It is
therefore difficult to tell which signals in the DNase—seq data are in—
formative about TF binding and which signals are either noise or
caused by the intrinsic sequence bias. Consequently, carefully de—
signed computational methods are needed for DNase—seq data
processing.

Having the aforementioned characteristics of DNase—seq data in
mind, here we study the use of high resolution DNase—seq data for
predicting TF binding sites. We chose to treat the TF binding predic—
tion problem as a supervised classification task, because this ap—
proach lets us utilize the true differences in the DNase signal

 

 

 

 

2853
{a} 6 {hi ,
a} I. '- -" 'IIII'I I. a 50 l  |
a ' u I a I l l
u u 30 II | I I I 
— | I — . |
E 2 l.__ .l I E 20  I:  III. I I III 1
Z I ll. I'|-"-_- Z L II. I l I ||..
E “-.w.' llll I'II I,‘ D 1 I] II"- I. I I: If F
a ll |lI| '.| f  .II: 1 III h I II A L I I
D I I - U - ' r 'r" ' ‘- ca-"L-ﬂ r’ "-' I" .__p
*E'U' a-ID U 10 20 —20 +10 U ID 20

Elisha FICE to motif center Distance to motif center

Fig. 1. (a) The average DNase I cleavage around ATF1 binding sites resembles
the canonical definition of DNase I footprint. The average DNase-seq signal at
nucleotide resolution centered at ATF1 motif overlapping ATF1 ChlP-seq
peaks is shown. (b) DNase-seq signal at nucleotide resolution around a single
AFT1 binding site located between nucleotides 96 929 096—96 929 148 in
chromosome 9. Although individual footprints are noisy, the canonical shape
of the footprint is still visible in the data

between the bound and unbound sites in the model training. We de—
velop a method, BinDNase, which for each TF automatically ex—
tracts features from the DNase—seq data which maximally
discriminate bound and unbound genomic locations. By comparing
BinDNase with state—of—the—art TF binding prediction methods we
show that BinDNase provides more accurate predictions than other
methods. Although this study focuses on making predictions with
DNase—seq data, the method is readily applicable to other data
types such as FAIRE—seq (Giresi et 61]., 2006) or ATAC—seq
(Buenrostro et 61]., 2013).

2 Materials and methods

2.1 The data

This work utilizes the publicly available data from the ENCODE
project (The ENCODE Project Consortium, 2012). The digital gen-
omic footprinting datasets (track name Ungf) were obtained from
the ENCODE website. The datasets include raw reads, DNase I sig—
nal and DNase I hotspots. The DNase I signal is a genome wide map
that lists the number of reads starting from each nucleotide position.
Note that the 5’ end of each aligned read and the previous nucleotide
to 5’ direction define the DNase I cleavage sites. The hotspots are
genomic regions of high DNase I activity as identified by the hot—
spot—algorithm (John et 61]., 2011).

Candidate binding sites were found for each TF by scanning
human genome (version hg19) with the position specific frequency
matrix (PSFM) models from the ENCODE publication (Wang et 61].,
2012). The motif matches were detected with p—value of 10_5 using
the motif scanning software FIMO. The motif matches were divided
into three categories:

° Motif within a ChIP—seq peak :Truly bound sequence (positive
set)

° Motif not within a ChIP—seq peak : Unbound sequence (negative
set 1)

° Motif not within a ChIP—seq peak but within a hotspot
region : Unbound sequence (negative set 2)

The ChIP—seq peaks and hotspot regions were downloaded from
the ENCODE website. The list of the ENCODE files that were
used can be found in the supplemental material. We use a combin—
ation of positive and negative set (either 1 or 2) to train our dis—
criminative model, BinDNase. At the beginning all data sets are
split into two parts: 200 positive sites and 1000 negative sites are

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘ETUJOJHBQ aIo Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pepeommoq

2854

J. Kaha'réi and H.Léihdesméiki

 

chosen randomly to the test data sets, rest of the data (but at max—
imum 3000 positive or negative sites) is used in the training data
sets. The number of sites in the test set is relatively low because
we wanted to have a comparable number of sites for each TF. The
number of sites does not however alter the results considerably
(Supplemental Information 6). The final prediction accuracy
evaluation of the models is conducted using the test data which is
not used to train the model.

2.2 Logistic regression
In this work the candidate binding sites found with PSFM model—
ing are scored according to the DNA cleavage data from DNase—
seq experiments. DNase I signal is modelled using the standard lo—
gistic regression where the log—transformed counts of DNase I
induced cuts are the input variables. We use the DNase—seq data
D at multiple resolutions: At single nucleotide resolution the in—
put variable value D, represents the log—transformed number of
DNase I induced cuts at that particular nucleotide. For lower
resolutions the values of the input variables correspond to the
log—transformed aggregate number of reads falling into bins of
varying size E > 1 (i.e. E consecutive nucleotides). In the follow—
ing, we use nucleotide and lower resolution data interchangeably
and call them as bins.

More specifically, the probability for binding for each candidate
binding site is modelled as follows

log 2 ﬁg +  ﬂiDi + ﬂPSFMSPSFMa (1)

where p is the probability of binding, D,- is the log-transformed num-
ber of reads (i.e. DNase I induced cuts) in the bin 1', SPSFM is the nega—
tive log p—value from FIMO motif scanning and ﬂs are the
coefficients in the model. The coefficients are found with the itera—
tively reweighed least squares (IRLS) algorithm (MATLAB function
glmfit). Similar logistic regression model for DNase—seq data has
been used in (Luo and Hartemink, 2013)—the main difference is the
way the features (i.e. the bins) are chosen for the model, which we
describe next.

2.3 Selecting discriminatory features from

DNase—seq data

In this work a greedy backward search type machine learning
method is implemented to find (and extract) optimal features from
the DNase I data for each TF. In the beginning of the search the nu-
cleotides within the candidate binding site and the flanking 10 bp re-
gions are treated in one nucleotide resolution, and the more distal
nucleotides are initially in ten nucleotide wide bins. These initial
bins are then merged in the search to get more predictive power. In
each iteration step two adjacent bins are merged. A schematic pres—
entation with two iterations is presented in Figure 2.

In each iteration the algorithm performs the particular bin merg-
ing operation that leads to the best prediction performance. The pre—
diction performance is evaluated using cross—validation by dividing
the training data (both positive and negative sets) in two sets. The
model is trained using one of the sets and the model performance is
evaluated using the other set by making predictions and calculating
the area under the curve (AUC) metric. This cross—validation step is
conducted 30 times for each bin merging operation to reduce vari—
ation caused by random division of the training data into training
and test sets within the cross validation in the model training.

3 Results

3.1 Standardized DNase—seq data preprocessing is
prerequisite for single nucleotide level analysis

As in all modelling the data should be preprocessed in a standar—
dized way. Previous articles have proposed slightly different process—
ing steps for DNase—seq data (see e.g. Piper et 61]., 2013; Neph et 61].,
2012). In the DNase I data special attention should be paid on the
following processing steps:

° Reverse strand reads should be shifted 1 bp to 5’ direction (or al—
ternatively forward strand reads should be shifted 1 bp to 5’ dir—
ection). This shifting acknowledges the fact that DNase I cleaves
the DNA between two consecutive nucleotides. With a single
base pair shift on either of the strands the DNA cut sites are con—
tributed consistently to a single nucleotide.

° Orientation of TF binding motifs should be taken into account.

Discrepancies in these steps lead to differences in the data and there—
fore affect any downstream analysis. For example, some of the digi—
tal DNase I data sets which are available on the ENCODE project
page have preprocessing differences between cell types.
Supplementary Figure 49 shows the average DNase I cleavage pro—
files for protein JUN in four ENCODE cell types: NHDF—Ad,
SKMC, K5 62 and HepG2. We noticed that reverse strand reads are
not consistently shifted between these four cell types (compare
Supplementary Figs 49a—b with c—d). While the pattern of DNase
hotspot remains practically unaffected in K5 62 and HepG2 the nu—
cleotide resolution cleavage patterns in the JUN interaction site is
clearly distorted due to non—standardized data preprocessing.
Consequently, if these discrepancies are not properly corrected, TF
binding prediction methods which use high resolution DNase—seq
data, such as BinDNase, fail to generalize between cell types.
Starting from the raw reads and reprocessing the data carefully using
a unified preprocessing pipeline makes differences between cell types
disappear (Supplementary Fig. 49 e—f). We observe a similar effect
for many TFs (another example is Supplementary Fig. 50 (SRF)).
We conclude that careful and highly standardized data preprocess—
ing is essential for detailed analysis of DNase—seq data.

3.2 DNA binding should be modelled separately for
each TF

We observed that the selected features as well as the actual predic—
tion models differ greatly between TFs. Two of the models are
visualised in Figure 3. First, for some TFs, such as ATF1 (Fig. 3) and
SP1 (Supplementary Fig. 23), the canonical definition of DNase I
footprint is adequate as the feature selection algorithm finds a model
in which the reads falling in the central bins decrease the binding
score and the reads falling in the flanking nucleotides increase the
binding score.

We also observed that not all strong single nucleotide cleavage
patterns present in data are important for discriminating true TF
binding sites from random unbound motif locations. For example,
NRF1 protein has three evident single nucleotide resolution cleavage
sites but only the two peaks flanking the actual binding site are asso—
ciated with a high positive regression weight by the feature selection
algorithm (see Fig. 3b). Note that reads falling to the ﬂanking region
on right are weighted more than the single—nucleotide resolution pat—
terns. Thus, some of the intricate patterns in DNase—seq data seem
unimportant for discriminating between real TF binding and noise
and may represent non—idealities and biases in the data, such as the
DNase sequence biases. Thus, efficient feature selection is needed to

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘1211110111123 310 Amie/nun 112 /§.IO'SIBU.IHO[p.IOJXO'SOIlBIIIJOJUIOICI/ﬁdllq 11101; pep1201umoq

BinDNase

2855

 

— I I ll Ihp

 

Candidate

hmdmg .5le + IIItlhp

 

Injtiulbinnjng — — —_ — —— — _IIIIIIIIIII_ — —_ — — — — —

 

 

 

Step] ______—_IIIIIIIIIII_________

 

5-[12112 ______—_IIIIIIIiII—________

 

Final binning

 

 

 

Fig. 2. A schematic presentation of how the optimal features from DNase-seq data are selected. In the initial stage the candidate binding site and 10 bp flanking re-
gions are modeled using 1bp resolution. The flanking regions 11—100 bp up and downstream from the candidate binding motif are modeled using 10 bp bins. In
each step two adjacent bins are merged. In this figure the first step of the algorithm merges two 10 bp bins upstream of the binding site. In the second step one
1bp wide bin is combined with one 10 bp bin. The final binning in this illustration includes wide bins at the flanking regions and narrower bins at the binding site

 

 

 

 

 

 

 

ATF'I
{a} E 0.52
I
gt I ||"-.l ” .
g 4 (mullhlIIl'rl'I'l-llllﬁil‘l ill I! “mlﬂilHulllllld (III
E WI ') I1 II III, III I 41.41
E 2 “LI’I’HII'P‘II I ' IUII’IIl
E Hf  'l'u
WW
0 r 1
[:-:l . .|
—1nn —50 o 50 mo

 

 

 

 

 

h] N FIFI
20 0.14
117'
g 15 '
E
E 10 _ I I _ 
{D
R _ . . | |
Z 5 I_IIII_II._,,-..- ' 3‘" “1,111 1U.” ML 4M
D .9? WW  I MT,me
my!“
‘3 W
—‘i O —50 O 51] 1 00

Fig. 3. The upper panels show the average DNase I cleavage centered at the TF binding motifs. The coloured bars indicate the optimised feature selection and
their coefficients in the logistic regression model. Red (resp. blue) colour indicates positive (resp. negative) coefficient. (a) ATF1, (b) NRF1

identify the relevant DNase I cleavage patterns. On the other hand,
some of the single nucleotide resolution patterns are highly inform-
ative. For example, the DNase I signal for protein CTCF (Fig. 10d)
contains a highly stereotypical peak on the right hand side of the
binding site. In the optimised feature selection this nucleotide is
treated as a single nucleotide and the coefficient in the logistic re-
gression model is high. Moreover, the cleavage pattern in this exact
position relative to CTCF motif has previously been reported to dif—
fer from the intrinsic sequence bias of the DNase I molecule (He et
61]., 2014). Models for other TFs, such as ELF1, RAD21, SMC3,
SPIl, ETSl also include a high regression weight coinciding high-
resolution DNase pattern (Supplementary Figs 7, 12, 20, 37 and
40). Taken together, these results emphasize that, instead of using a
single TF footprint definition, the prediction models for each TF
should be constructed separately.

3.3 High resolution DNase—seq analysis improves TF
binding predictions

DNase I hypersensitivity at a lower resolution (i.e. for larger gen-
omic regions) has previously been used to detect TF binding sites
(see e.g. He et 61]., 2014; Yardimci et 61]., 2014). The binding score of
each candidate site is then simply the aggregate count of DNase I
cuts in that larger window. Reportedly this simple approach per—
forms equally or better than more sophisticated predictors
(Yardimci et 61]., 2014). We evaluated the predictive power of such a
lower resolution DNase I activity method using a 50 bp window

around the candidate binding site and compared that with
BinDNase.

In Figure 4a the TF binding prediction performance is evaluated
using candidate sites from random genomic locations (negative set
1) and in Figure 4b using only candidate sites from the hotspot re—
gions (negative set 2). For the less challenging task of discriminating
real binding sites from non-binding sites which are not in hotspot re—
gions, we observe that for many TFs it is sufficient to just quantify
general DNase I activity near the binding site without using any
sophisticated modeling (Fig. 4a).

However, there are TFs for which BinDNase improves the bind—
ing prediction accuracy already in this scenario, including e.g.
MAFK and ZNF274. The prediction models for MAFK and
ZNF274 are shown in Supplementary Figures 16 and 21, which sug—
gest that the relatively poor performance of the simple DNase I ac—
tivity predictor can be explained by low average DNase I signal at
these motifs. BinDNase, in turn, can identify discriminatory features
from DNase—seq data and increase the AUC score for MAFK and
ZNF274. There are also other TFs that bind to lower DNase activity
sites and for which BinDNase improves the prediction results. In
general, the amount of improvement in BinDNase’s predictions is in-
versely correlated with the accessibility (i.e. the total cut count) of
the region (Supplementary Fig. 1).

Typically TF binding sites are primarily searched for in DNase I
hotspot regions and, thus, performance evaluation using the nega—
tive set 2 is in practice more relevant. Results in Figure 4b show that
while the DNase I activity predictor still works for some TFs surpris—
ingly well it also fails completely for some TFs. The most notable

9mg ‘09 1sn3nv uo sejeﬁuv s01 ‘1211110111123 310 AlISJQAIUn 112 /§.IO'SIBU.IHO[p.IOJXO'SOIlBIIIJOJUIOICI/ﬁdllq 11101; pep1201umoq

 

 

 

 

 

 

 

 

 

 

 

 

2856 J.Kéiha'ra' and H.La'hdesméiki
- Ne attee eet 2 a h
{a} Negative set 1 {b} 1 g 3} Meg atiee set 1 [J Negative eel 2
1  BI  e 1 - - g 1
:1 _ D
t . -'. - 1113  E - E
.3; ‘15  r- E if: :11 ee  e 0.9 
a 115 MAFK % - .:.: ' - 1' E {II-E E DIS  I.
m 4 g CI 4 I— E g ."._._- -:". ' I*
z .
1:1 0-4 If D __.,.-.-:.' g e? .f g 11.? a I
g 3111:2174 g I] 2 MAFK - - g .2: E, TAF
rt 0-2 er ' amen—1 13 ee “H23? 15 de 1.; t
t] U 1.1 NF‘rEt T131:
“a D 5 1 11 11.5 1 2 3 0-5
_- AUC BinDNase [1.1.1 [1.3 1 {1.6 ee 1
AUG BinDNaSB AUC BinDNase AUC BinDNase

Fig. 4. High resolution DNase-seq analysis improves TF binding predictions
when compared with traditional methods. The DNase 1 activity predictor
using a 50 bp window is compared with BinDNase using (a) negative set 1
and (b) negative set 2. The AUC score is computed for all 57 TFs using both
methods. Selected TFs are highlighted in the figure

examples include again MAFK and ZNF274 proteins for which the
prediction accuracy is well below the random coin flipping. The
worse than random performance can be explained by below—average
DNase I activity in the MAFK and ZNF274 binding sites, as the
learned BinDNase models consist of mostly wide bins with negative
coefficients (Supplementary Figs 16 and 21). As with negative set 1,
BinDNase can identify discriminatory features from DNase—seq data
and improves AUC scores for majority of the 57 TFs, including
MAFK and ZNF274. Interestingly, the prediction models for both
MAFK and ZNF274 include also high resolution features, such as a
strongly positively weighted single nucleotide features at the middle
of the ZNF274 binding site.

3.4 Feature selection improves TF binding predictions
To test if feature selection implemented in BinDNase improves TF
binding predictions we also evaluated the prediction performance of
logistic regression models which use DNase—seq data only at single
nucleotide resolution without implementing any feature selection
methods. Results in Figure 5 show that BinDNase’s feature selection
improves prediction accuracy results for the majority of TFs. The
most notable improvement of AUC score is achieved for proteins
such as NFYB, TBP and TAF using negative set 2. The models for
these TFs consist mostly of wider bins which might indicate that the
single—nucleotide model overfits the logistic regression to features
that are not useful in discrimination. Without feature selection,
some of the nucleotides at the ﬂanking sequences obtain an unneces—
sarily large weight and hence decrease the prediction accuracy of the
nucleotide resolution model. These results suggest that for some nu—
cleotide locations the DNase I signal does not provide single nucleo—
tide resolution information about TF—DNA interaction and those
regions should be modelled using larger bins chosen based on a fea—
ture selection method. This is expected because the DNase—seq signal
at individual candidate binding sites are often noisy and part of the
signal originates from the inherent DNase I sequence bias (He et 61].,
2014). Nevertheless, our results demonstrate that feature selection
can identify discriminatory information from DNase—seq data.

We next compared BinDNase with the state—of—the—art methods
MILLIPEDE (Luo and Hartemink, 2013) (Fig. 6) and PIQ
(Sherwood et 61]., 2014) (Fig. 7). MILLIPEDE represents the super—
vised approach for TF binding predictions whereas the PIQ—method
is an unsupervised method. The supervised Millipede has been previ—
ously shown to outperform the widely used unsupervised
CENTIPEDE algorithm (Pique-Regi et 61]., 2011) for predicting TF
binding (Luo and Hartemink, 2013).

Fig. 5. Feature selection improves TF binding predictions. The AUC scores for
BinDNase and a single nucleotide resolution logistic regression model with-
out feature selection for (a) negative set 1 and (b) negative set 2

BinDNase performs nearly identically with MILLIPEDE for
those proteins which are already predicted well by MILLIPEDE.
One such protein is ATF1 for which BinDNase finds a prediction
model which is close to the canonical footprint model also used in
MILLIPEDE (Fig. 3a). However, BinDNase achieves a notable im—
provement for many of those proteins which MILLIPEDE does not
predict well, including e.g. NFYB. Although BinDNase models the
ﬂanking regions around the NFYB motif using large size bins simi-
larly with MILLIPEDE, the region close to the NFYB motif center is
modeled using very high resolution features with high logistic regres—
sion coefficients (Supplementary Fig. 44). BinDNase improves also
e.g. CTCF insulator protein whose prediction model is shown in
Figure 3d. Previous studies have already indicated a high resolution
DNase I cleavage signal on 3’ end of the CTCF motif (He et 61].,
2014). Here we demonstrate that these high resolution features can
be used to improve binding predictions.

Comparison between MILLIPEDE and BinDNase gives expected
results because BinDNase can be viewed as a more general version
of the MILLIPEDE algorithm: instead of assigning bins similarly for
each transcription factor our method finds optimal features for each
TF. In the worst case, BinDNase should find similar features and,
thereby, similar prediction performance as MILLIPEDE if those in-
deed happen to be optimal. For other proteins, BinDNase can im-
prove the prediction accuracy as shown in Figure 6b.

Comparison between BinDNase and PIQ methods (Fig. 7) shows
that the prediction performance of BinDNase is higher for most TFs.
This is also an expected result as the unsupervised PIQ is not de—
signed for the supervised setup, where there is knowledge about the
DNase I signal within the true binding sites. This suggests that
supervised approaches should be preferred for making accurate
binding predictions for TFs for which both ChIP—seq (or other bind—
ing information) and DNase—seq data are available for some cell
type. Unsupervised methods are required in the absence of accurate
ChIP—seq data that is needed in model training or if the ChIP-seq ex-
periment is conducted in a condition where no deeply sequenced
DNase—seq data is available.

3.5 Exploring variants of BinDNase algorithm

To further explore the problem of predicting TF binding from
DNase—seq data, we devised different versions of the BinDNase for
comparison purposes. Motivated by the findings of (Piper et 61].,
2013), we tried including strand information into BinDNase by
counting the DNase induced cuts separately for both strands. The
results shown in Supplementary Figure 48 show that the prediction
accuracy remains practically the same for negative set 1, whereas
the use of the strand information increases the prediction accuracy
slightly for selected TFs in the negative set 2. Our analysis shows

91% ‘09 1sn3nv uo sejeﬁuv s01 1111110111123 310 AlISJQAIUn 112 /§.IO'SIBU.IHO[p.IOJXO'SOIlBIIIJOJUIOICI/ﬁdllq 11101; pep1201umoq

BinDNase

 

 

   

 

 

 

 

{a} Negative eel 1 {h} Negative set 2
1 1

L11 in
E 11.9 E be
5 e
E 11.3 E Iii-3
_I _I
—I :1
E 1].? E EL? I
E 11.11 E tie 
a: 11::

[15 11.. -  

[LE lliEl ‘I 115 ELEI ‘E

AUG BinDNase AUC BinDNase

Fig. 6. BinDNase outperforms MILLIPEDE in negative set 2. The AUC scores
for BinDNase and MILLIPEDE (Luo and Hartemink, 2013) are presented for (a)
negative set 1 and (b) negative set 2

 

 

 

 

 

{a} Negative set 1 {[3} Negative set 2
1 - g 1 5
0.8  1' 1:1.ei 
G .r I ' -' -._' C] é’giilﬁ ..
E 0.5 - -' E 115! I;__._-__I~“-. I
e ” e 
[1.2 ' I12:
131 ' 1]5
CI [1.5 'I O 0.5 1
AUG BinDNase AUC. BinDNase

Fig. 7. The prediction performance of supervised BinDNase is higher than the
performance of the unsupervised method PIQ for both negative set 1 (a)
and 2 (b)

that strand—specific DNase—seq data may contain some additional in—
formation but we consider that the slight improvement does not jus—
tify the use of the more complex model.

Following the work in (He et 61]., 2014; Yardimci et 61]., 2014),
we tested including an explicit sequence bias correction into
BinDNase. We chose to model the DNase bias using the 4—mer
model from (Sung et 61]., 2014). The bias signal is further normalized
relative to the actual DNase—seq signal in the same region so that the
total signal strengths are the same. The estimated bias signal is then
subtracted from the original DNase—seq signal and the corrected sig—
nal is given as an input to BinDNase algorithm. Surprisingly, our re-
sults in Supplementary Figure 47 show that the bias correction
performs poorly. A more sophisticated bias correction might work
better but that is out of the scope of this work, especially because
the current version of BinDNase already outperforms other
methods.

We also tested the contribution of the PSFM score in our final
predictions by comparing the BinDNase method against a version of
BinDNase that does not utilize the motif score. The obtained predic—
tion accuracies in Supplemental Figure 46 show that BinDNase’s
prediction accuracy decreases only a little in the absence of the motif
score. This suggests that DNase signal alone is indeed highly inform-
ative of TF binding, although the motif score should be used to
achieve the best possible prediction accuracy. Note that the methods
used in the comparisons (MILLIPEDE and PIQ) also utilize the
motif score.

3.6 BinDNase generalizes between different cell types

To test whether the models generalize between different cell types
we used K5 62 for training the model and made the predictions for
cell type HepG2, and vice versa. The models’ prediction perform-
ances are very similar between cell types for all except a handful of

 

 

2857

{a} g I Negative 5612 {111 g Negative set 2

3 | TAFIH . -'-‘ 1% 1

E - I  g 119- USF2 

e .- :- e -  -

 as. E I  .

E I}?  .-.i:.Tt:F E “'5'   1..

N '15- JUN “i

(D- ID x

In DE-

: DIE) JUNE __1..._._ if? f

3 DE iii-3 I (33 0'5 11.5 13.3

 

AUG K552 {trained with K5521 11111: HepG2 [trained with 115132}

Fig. 8. The models generalize well to different cell types. The model trained
on another cell type works almost equally as well as the one trained with the
same cell type that the predictions are made to

TFs as shown in Figure 8. Naturally, whenever there is a difference
in the model performance the predictions made to the same cell type
that the model was built with are more accurate.

Some of the proteins that behave similarly and differently be-
tween cell types are highlighted in Figure 10. Proteins that do not
generalize well belong to e.g. helix-loop-helix (HLH) (BHLHE40)
and leucine zipper families (JUND) and USF2 contains both HLH
and leucine zipper domains. BinDNase may generalize differently
for different structural families. It is interesting to look at the
BinDNase models learned from two different cell types in detail. For
example, the two models for USF2 (Fig. 10a and c) and JUND
(Supplementary Fig. 1a and c) are clearly different as expected due
to the weak generalization. The two models for CTCF (Fig. 10b and
d) and TAF1 (Supplementary Fig. 28), in turn, have very similar
characteristics and, thereby, achieve similar AUC scores. For TAF1,
the two models are typical canonical footprint models, whereas for
CTCF the models contain both high and low resolution signals, con—
sistent for both cell types.

Overall, despite of small differences in feature extraction (i.e.
binning) and regression coefficients for some TFs, it should be noted
that BinDNase predictions themselves are not sensitive to small
changes in these parameters as the prediction performance of the
BinDNase models are still higher than those of competing models.
Finally, we wanted to evaluate that how well our supervised
BinDNase method performs compared to unsupervised methods
when BinDNase is trained on one cell type and applied to another
cell type. Results for this comparison in Figure 9 show that
BinDNase still outperforms PIQ even though the BinDNase model is
learned from a different cell type. Overall, our results demonstrate
that BinDNase is both accurate and generalizes to other cell types,
thus making it a powerful and versatile tool.

3.7 Prediction accuracy saturates at a modest
sequencing depth

The effect of sequencing depth on prediction accuracy was investi—
gated by making predictions on the candidate binding sites using
only subsamples of all reads (Fig. 11). For about half of the TFs for
which the predictions are easy to make (i.e. AUC < 0.8) the required
sequencing depth is much lower than the depth in the ENCODE
DNase—seq data sets. Prediction accuracy saturates already at
sequencing depth of about 30M—60 M, even though the original
sequencing depth is as high as 270 M DNase—seq reads/samples. For
TFs which are more difficult to predict (AUC 0.8 or below) suffi—
cient saturation is achieved between 100M and 150M reads per
sample. For a few TFs, such as EGR1 and RFXS, it seems that
deeper sequencing could further improve the prediction results.

91% ‘09 1sn3nv uo sejeﬁuv s01 1111110111123 310 AlISJQAIUn 112 /§.IO'SIBU.IHO[p.IOJXO'SOIlBIIIJOJUIOICI/ﬁdllq 11101; pep1201umoq

2858

J. Kéha'ra' and H.La'hdesméiki

 

4 Discussion

Although transcription factor binding prediction using various high-
throughput sequencing data has made significant progress recently,
there is still an urgent demand to develop novel computational
methods for analysing different kinds of sequencing data sets. This
work sheds light on many questions considering computational ana—
lysis of deeply sequenced DNase I hypersensitivity data. Foremost,
despite the fact that most previous methods have used traditional,
low resolution canonical DNase I hotspot or footprint models, we
demonstrate that for some TFs DNase—seq data contain high reso—
lution information about TF—DNA interactions which can be used to
improve discrimination between bound and unbound motif
locations.

Negative set 2

 

1
{1.9

3"" -
{1.8 a -  
'  
“II, .

a? _.  “_i_

AUC PIC.I

0.6

 

 

 

“'5  _ .
1.1.5 [1.3 1
AUG K552 {trained with HepG2}

Fig. 9. The BinDNAse model trained on another cell type outperforms the un-
supervised PIQ

.n-II-i.
m
H—r

USF2

 

1D

DNase I cleavage

ii i...- "
 WW

artqu

 

 

 

 

—1|Jﬂ —5['i [1' 5i] ‘lﬂﬂ

:F-IH.
n
"in—pf

USF2

 

U1

.5:

l

i
I willful 9“le '
W” A

Mil-CI

DNase I cleavage

—t-
.

 

 

 

 

—1ﬂ[} -SD 13 Si] 100

 

 

The use of single nucleotide resolution DNase—seq data is
hindered by the inherent sequence bias of the DNase molecule (He
et al., 2014) and therefore not all signals in the data discriminate
bound and unbound sites. That is, it is not known a priori which
part of the DNase—seq signal contain discriminative information.
Thus, efficient feature selection methods, such as the one used in
this work, are needed to construct accurate TF binding prediction

 

 

 

 

 

 

    
 

 

 

 

models.
1r
fix—‘— —ENF2?4
[21.95E __ —TAF1
Gami
ATF1
CTCF
NFtEEE
H ' ' ‘ ' ' ' ' T ' ‘ ' _ _ ﬂ - - - -JUN
M; -.. —-' ———W1
g If! __ u- - - -SHF
a:  ,. " .r MEFEA
“5 ,’ __F..-~-' ———ueFi
'2 .. - -' ' FiFit'ﬁ
{I d .I'
M”: Pa’ __.___.."---EGH1
use , ’ , .- e
1‘ 1'
I} if'
ﬂ_55.ff.fr
2"
13.55

 

30' EU 9t] 1211 1511 130 21D 24D

Numb-er nf reads (in millienei
Fig. 11. Effect of sequencing depth on TF binding prediction accuracy. The
AUC scores are computed for a representative collection of TFs using sub-

sampled versions of the original DNase-seq data. The original sequencing
depth is 270M reads

 

 

 

 

 

 

 

 

 

 

 

(b) CTCF
4 0.22
11'!
a 3—
E
ﬁ 2 m _ area
3 M l b»
El
2 . i in _
ﬂ 1 Wﬂwip llH’qu J W whim”
ill‘
ljlﬂ:-]:l:-:-
4cm -5::i a 50 100
(d) CTCF
5 0.21
e 3_ . 4
§ 41.22
a 2-
. “i l/
W val-IN
a
— III—
—100 —50 a an 100

Fig. 10. The upper panels show the average DNase I cleavage centered at the TF binding motifs. The coloured bars indicate the optimised feature selection and
their coefficients in the logistic regression model. Red (resp. blue) colour indicates positive (resp. negative) coefficient. The models trained with different cell
types can be different (USF2) or highly similar (CTCF). (a) USF2 (HepG2), (bl CTCF (HepG2), (cl USF2 (K562) and (d) CTCF (K562)

9mg ‘09 1sn3nv uo sepﬁuv s01 ‘etulomeg aIo Amie/xtqu 112 /3JO'S[BUJT10prOJXO'SOTlBIIlJOJUTOTQ/ﬂdllq 11101; pepeommoq

BinDNase

2859

 

This work also provides insight into which type of machine learn-
ing algorithms are suited for accurate TF binding predictions using
DNase—seq data. According to our simulations supervised methods
such as MILLIPEDE and BinDNase perform better than the
commonly used unsupervised methods such as CENTIPEDE or PIQ.
This is not an unexpected result because the supervised learning pro—
cess contains an inbuilt mechanism for finding discriminative features
as the class labels are known in the model training step. On the other
hand, the unsupervised approach tries to find structure in the data
without having any knowledge whether this structure truly contains
discriminative power. The use of supervised model training explains at
least partially why the algorithm performs well without any bias
correction.

Although the supervised approach leads to a better prediction ac—
curacy, estimating the models requires information about the true TF
binding. Predictions can therefore be made only for transcription
factors whose binding is measured with ChIP—seq or other techniques.
The binding models however generalise to other cell types and the
generalization implies the possibility of transferring ChIP-seq
binding information to other cell types via the high resolution footprint
models.

Our results do not imply superiority of the supervised methods for all
prediction tasks. In some cases the accuracy of the unsupervised methods
or even the simple DNase activity predictor is sufficient. The unsupervised
methods are also useful when only a broad general view of the TF binding
landscape is needed. The need for binding information for model building
can be viewed as a disadvantage of the supervised models.

In this work we developed a novel method, BinDNase, for TF
binding prediction using DNase—seq data. Via comprehensive simula—
tions we show that BinDNase performs better than existing methods.
We show that BinDNase’s prediction accuracy is generally well-
saturated at sequencing depths of the currently available DNase—seq
data sets and that the method also generalises between cell types. We
believe that BinDNase will be a useful tool in practise and help reveal—
ing the mechanisms of transcriptional regulation in numerous
applications.

Acknowledgement

The authors also thank Tatsunori Hashimoto for his help with PIQ analysis.

Funding

This work was supported by the Academy of Finland Center of Excellence in
Systems Immunology and Physiology and the Academy of Finland grant no.
255878.

Conﬂict of Interest: none declared.

References

Boyle,A.P. et al. (2008) High-resolution mapping and characterization of open
chromatin across the genome. Cell, 132, 31 1—322.

Buenrostro,].D. et al. (2013) Transposition of native chromatin for fast and
sensitive epigenomic proﬁling of open chromatin, dna-binding proteins and
nucleosome position. Nat. Methods, 10, 1213—1218.

Giresi,P.G. et al. (2006) Faire (formaldehyde-assisted isolation of regulatory
elements) isolates active regulatory elements from human chromatin.
Genome Res., 17, 877—8 85.

He,H.H. et al. (2014) Reﬁned dnase-seq protocol and data analysis reveals in-
trinsic bias in transcription factor footprint identiﬁcation. Nat. Methods,
11, 73—78.

John,S. et al. (2011) Chromatin accessibility pre-determines glucocorticoid re-
ceptor binding patterns. Nat. Genet., 43, 264—26 8.

Kasowski,M. et al. (2010) Variation in transcription factor binding among
humans. Science, 328, 232—235.

Luo,K. and Hartemink,A.]. (2013) using dnase digestion data to accuractely
identify transcription factor binding sites. Paciﬁc Symposium on
Biocomputing, 80—91.

Matsuda,M. et al. (1992) 6-thalassemia caused by disruption of the site for an
erythroid-speciﬁc transcription factor, GATA-1, in the 6-globin gene pro-
moter. Blood, 80, 1347—1351.

Neph,S. et al. (2012) An expansive human regulatory lexicon encoded in tran-
scription factor footprints. Nature, 489, 8390.

Piper,]. et al. (2013) Wellington: a novel method for the accurate identiﬁcation
of digital genomic footprints from dnase-seq data. Nucleic Acids Res., 41,
e201.

Pique-Regi,R. et al. (2011) Accurate inference of transcription factor binding
from dna sequence and chromatin accessibility data. Genome Res., 21,
447—455.

Ramsey,S.A. et al. (2010) Genome-wide histone acetylation data improve pre-
diction of mammalian transcription factor binding sites. Bioinformatics, 26,
2071—2075.

Sherwood,R.I. et al. (2014) Discovery of directional and nondirectional pion-
eer transcription factors by modeling dnase proﬁle magnitude and shape.
Nat. Biotechnol, 32, 171—178.

Sung,M.-H. et al. (2014) Dnase footprint signatures are dictated by factor dy-
namics and dna sequence. Mol. Cell, 56, 275—285.

The ENCODE Project Consortium. (2012) An integrated encyclopedia of
DNA elements in the human genome. Nature, 489, 5 7—74.

Wang,]. et al. (2012) Sequence features and chromatin structure around the
genomic regions bound by 119 human transcription factors. Genome Res.,
22, 1798—1812.

Weirauch,M.T. et al. (2013) Evaluation of methods for modeling transcription
factor sequence speciﬁcity. Nat. Biotechnol, 31, 126—134.

Wittwer,]. et al. (2006) Functional polymorphism in ALOX15 results in
increased allele-spesiﬁc transcription in macrophages through binding of the
transcription factor SPIl. Hum. Mutat., 27, 78—8 7.

Yardimci et al. (2014) Explicit DNAse sequence bias modeling enables high-
resolution transcription factor footprint detection. Nucleic Acids Res., 42,
11865—11878.

91% ‘09 1sn3nv uo sepﬁuv s01 ‘etulomeg aIo AltSJQATUn 112 /§.IO'S[BU.IHO[p.IOJXO'SOUBIHJOJUTOTQ/ﬁ(1111] 11101; pepeommoq

