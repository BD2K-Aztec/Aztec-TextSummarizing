ORIGINAL PAPER

Vol. 29 no. 24 2013, pages 3121-3127
doi:10. 1093/bioinformatics/btt550

 

Genome analysis

Advance Access publication September 23, 2013

An alignment-free test for recombination

Bernhard Haubold”, Linda Krause1 ’2, Thomas Horn3 and Peter Pfaffelhuber3

1Department of Evolutionary Genetics, Max—Planck—lnstitute for Evolutionary Biology, 24306 Plon, 2Institute for Neuro—
and Bioinformatics, Liibeck University, 23562 Liibeck and 3Mathematical Stochastics, Mathematical Institute, Freiburg

University, 79104 Freiburg, Germany

Associate Editor: John Hancock

 

ABSTRACT

Motivation: Why recombination? is one of the central questions in
biology. This has led to a host of methods for quantifying recombin-
ation from sequence data. These methods are usually based on
aligned DNA sequences. Here, we propose an efficient alignment-
free alternative.

Results: Our method is based on the distribution of match lengths,
which we look up using enhanced suffix arrays. By eliminating the
alignment step, the test becomes fast enough for application to
whole bacterial genomes. Using simulations we show that our test
has similar power as established tests when applied to long pairs of
sequences. When applied to 58 genomes of Escherichia coli, we pick
up the strongest recombination signal from a 125 kb horizontal gene
transfer engineered 20 years ago.

Availability and implementation: We have implemented our method
in the command-line program rush. Its C sources and documentation
are available under the GNU General Public License from http://guan
ine.evolbio.mpg.de/rush/.

Contact: haubold@evolbio.mpg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 14, 2013; revised on August 25, 2013; accepted on
September 17, 2013

1 INTRODUCTION

It is surprisingly difﬁcult to account for the prevalence of sex and
recombination in nature (Otto and Lenormand, 2002). Classical
explanations for the evolution of sex are based on the realization
that it can speedup adaptation (Fisher, 1930/1999, ch. 6). In
addition, it removes deleterious mutations from the population
(Muller, 1932, 1964). However, recombination also leads to the
breakup of coadapted genes, which begs the question as to
whether recombination has an evolutionary cause, or is a mere
consequence of molecular mechanisms such as DNA repair
(Felsenstein, 1974). Perhaps both views are correct, as the con-
temporary consensus is that sex and recombination would only
be maintained in multicellular organisms with high mutation
rates and largely negative ﬁtness interactions between genes
(Otto, 2007). Irrespective of this uncertainty about the function
of recombination in unicellular organisms, horizontal gene trans-
fer in bacteria has attracted particular attention, as it often
underlies the emergence of virulent pathogens (Baquero, 2004).

 

*To whom correspondence should be addressed.

The enigma of recombination, combined with its prevalence
and clinical importance, has inspired the development of numer-
ous methods for assessing genetic exchange (Posada, 2002).
These fall into two broad categories: methods for detecting the
presence of recombination, and methods for estimating its rate.
We concentrate here on the simpler detection problem. In the
past, this has been solved in two ways: by looking for clustering
of mutations or by identifying multiple mutations to the same
nucleotide in distinct lineages. Such recurrent mutations are
called homoplasies. Methods based on the detection of clustered
polymorphisms include the widely used Max-x2 method
(Maynard Smith, 1992) and the runs method implemented in
the popular GENECONV program (Sawyer, 1989). Both are
based on the realization that the time to the most recent
common ancestor varies along a recombining sequence
(Fig. 1). Because the number of mutations that affect a genomic
region is proportional to the time to the most recent common
ancestor of the sampled sequences, the number of mutations
varies along the sequence; as a result, the mutations are clustered.

Classical homoplasy—based methods rest on the assumption
that any nucleotide mutates at most once, thus generating
three haplotypes between a pair of polymorphisms, say 10, 01
and 00. The missing fourth possible haplotype, 11 in our ex-
ample, can only be generated through recombination. The detec-
tion of such haplotype quartets is used to determine the
minimum number of recombination events in an aligned
sample of homologous sequences (Hudson, 1985). More recently,
this diagnosis of either presence or absence of a recombination
event between a pair of polymorphisms was generalized to infer-
ring possibly more than one recombination in samples of more
than four sequences. This has been formalized as the CIDW statistic
and implemented in Phi, a fast tool for detecting recombination
(Bruen et al., 2006). Like all homoplasy—based tests, CIDW tends to
have greater power than its rivals based on polymorphism clus-
tering (Wiuf et al., 2001).

The detection of recombination among a sample of homolo-
gous sequences is thus a well-understood problem, as long as an
alignment of the sequences is available. However, aligning gen-
omes remains challenging despite great advances in this ﬁeld
(Bray and Pachter, 2004; Darling et al., 2004). At the same
time, there is interest in analyzing recombination at the scale of
bacterial genomes, if not greater (Didelot et al., 2010).
Fortunately, the nucleotide-wise assignment of homology that
deﬁnes alignments is not necessary to test for recombination.
We show this by developing a fast alignment-free test for
recombination. Like Max-x2 (Maynard Smith, 1992) and

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3121

112 [glO'SIBILInO[plOJXO'SODBIIIJOJHIOIQ/[ldllq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

B.Haubold et al.

 

2.5

 

1.5 -

 

TMRCA

 

 

0.5 - J

0 _|l|llJlLLLl_LlLL|_L.|_l|||llllJ|Ll|||Jll|_|.|J_lll|J|||| |.llll|ll|||||||
0 20 40 60 80 100

Position (X 104)

 

 

 

 

Fig. 1. Simulated time to the most recent common ancestor (TMRCA)
and mutations (vertical lines) along a recombining stretch of DNA
sequence. TMRCA is proportional to the population size

GENECONV (Sawyer, 1989), our test is based on the detection
of polymorphism clustering. But instead of scoring single nucleo-
tide polymorphisms (SNPs), we record the lengths of exact
matches between pairs of sequences. To a ﬁrst approximation
this corresponds to the distances between SNPs. Recombination
leads to an increase in the ﬂuctuation of match lengths when
compared with no recombination. Because match lengths can
be looked up efﬁciently using modern string algorithms (Puglisi
et al., 2007), our test scans a pair of Escherichia coli genomes
totaling 10 Mb in only 8 s on a contemporary laptop.

In the following, we derive our test and demonstrate its sensi-
tivity and speciﬁcity through simulation. We also use simulations
to compare it with two published tests, Max-X2 and CIDW. Finally,
we apply our test to 58 E.coli genomes to search for horizontal
gene transfer.

2 METHODS

2.1 Derivation

Consider the query q = ATATC and the subject .9 = ACGTG. At every
position i in q we look for the shortest substring q[i..j] that is absent from
s. We call this SHortest Unique subSTRING ‘shustring’ maubold et al.,
2005) at position i and denote its length by X ,~. For example, AT is the
shustring starting at the ﬁrst position in q, hence X1 = 2. Our approach is
built on the assumption that in pairs of homologous DNA sequences the
shustrings correspond to homologous matches and hence their lengths
represent distances to the next SNP. This assumption is reasonable for
closely related sequences such as those sampled from populations or
recently diverged species.

Conceptually, we identify shustrings using a sufﬁx tree of q and s
(Gusﬁeld, 1997). We say ‘conceptually’ because our actual implementa-
tion is based on an abstract version of a sufﬁx tree called ‘enhanced sufﬁx
array’ (Abouelhoda et al., 2002). Figure 2 shows the sufﬁx tree of q and s.
Each sufﬁx is represented by a path from the root to a leaf. For example,
q[1] is the leaf that corresponds to the sufﬁx starting at position 1 in q,
ATATC. Moreover, repeated preﬁxes are collapsed into single paths. For
example, the sufﬁxes q[5..5] = C and s[2..5] = CGTG share the preﬁx C,

 

|||1|2|3|4|5|6|
q ATATC$
s ACGTG$

 

 

 

 

 

 

 

 

 

 

 

 

 

‘5 VI 0 G T
Q
3121 1,339 ’3 “as “3?: $53 “11
s11] $9, «1151 s12] 45] sis] «112] «1141 s14]
~01
qill «1131

Fig. 2. Sufﬁx tree of our example query and subject sequences .9 and q

which appears only once in the tree. The sentinel character $ at the end of
q and s differs from every character in q and s, even from itself. Its
addition ensures that a sufﬁx such as q[5..5] = C, which is a preﬁx of
the sufﬁx s[2..5] = CGTG, is also represented by a leaf in the tree.

To identify the shustring starting at, say, q[1], we visit leaf q[1], and
climb toward the root until we ﬁnd a node, n, with a subject leaf in the
subtree rooted on n. In our example, we carry out two climbing steps.
Then we extend the path label from the root to the node we have reached
by one character toward the starting leaf, to ﬁnd our ﬁrst shustring, AT.
In this way, we calculate the shustrings at every position in q.

Our test statistic is based on the lengths of shustrings, X ,-. Without
recombination, and if sequences differ at a fraction Jr of their sites,
every site i has probability 71' of differing between q and s, independently
of other sites. Using this model based on the inﬁnite sites model from
population genetics, we obtain for the average shustring length
- 1 L - 1
X1: 712:1“, EIX] = ElXi] = 

Hence, it can be estimated from unaligned sequences as the inverse of
the average shustring length (Haubold et al., 2011). Recall that recom-
bination leads to ﬂuctuations in the coalescence times along a sequence
and therefore to clustering of polymorphisms (Fig. 1). As a result, the
mean shustring length increases, which might be used as an indicator of
recombination maubold and Pfaffelhuber, 2012). Unfortunately, we
found that it was impossible to infer the expected average shustring
length without estimating Jr to a precision attainable only with align-
ments. However, the empirical variance of shustring lengths is a more
promising statistic. Its expectation without recombination is

1 l _ 1 _
s2 = 7;)(X. — I02. Eis21~ ; 2 E1112,

where we can estimate 71' from the average shustring length maubold and
Pfaffelhuber, 2012). E[s2] is then compared with the observed variance, 52,
to test the null hypothesis Ho : E[s2] = E[X]2. For this, we derived

24
v 2 w — 1
ar(s ) m, ( )
and assumed that s2 is normally distributed with expectation 1172
(Supplementary Material). This means that can we use a one-sided test
for the normalized difference between 52 and X 2
2 _ A72
Dr = —S _ , (2)
«24 - X5/l
which is approximately normally distributed with mean 0 and standard
deviation 1. We also deﬁne the ratio

2
S
97

as a rough measure of recombination.

 

3122

112 /810's112umo[pJOJXO'soi1cm10juioiw/2d11q 11101; pepcolumoq

910K ‘09 lsnﬁnV no :2

Test for recombination

 

2.2 Implementation

We implemented our test in the program rush, which stands
for ‘Recombination detection Using SHustrings’. The program rush
takes as input a query and a subject DNA sequence in FASTA format and
computes Q, Dr, and the corresponding P-value. Its sufﬁx tree construc-
tion is based on the deep-shallow algorithm and implementation by
Manzini and Ferragina (2002), which is one of the most efﬁcient string
indexing methods available (Puglisi et al., 2007).

2.3 Data

We downloaded complete genome sequences from GenBank for the 58
E.coli strains listed in Supplementary Table S1. Because rush is
restricted to the analysis of sequences consisting solely of the nucleotide
designations {A, C, G, T}, all other characters were removed prior to the
analysis.

2.4 Simulations and computer programs

We generated samples of homologous DNA sequences using the coales-
cent simulation program ms (Hudson, 2002) in conjunction with msZ dna
available from http://guanine.evolbio.mpg.de/bioBox/

These simulations were conditioned on the population mutation
rate, 0, and the population recombination rate, 0. 0 = 2Ne,u, where N6
is the effective population size and ,u is the mutation probability
per generation. Under the inﬁnite sites model, 0 is equal to the
expected number of pairwise mismatches, 7r. Similarly, p = 2Nec, where
c is the probability of recombination per generation. For more back-
ground on coalescent theory see the excellent introduction by Wakeley
(2009).

Max-)(2 and dDW-values were computed using the program
Phi (Bruen et al., 2006). The distances between the E.coli genomes
were computed using kr (Domazet-Loso and Haubold, 2009) and
the tree based on these distances was computed and drawn with
Phyl ip (Felsenstein, 2005) using neighbor joining and mindpoint
rooting.

3 RESULTS

3.1 Simulations

We explored the accuracy of the newly derived Equation (1)
through simulations. In Figure 3A, we varied sequence length.
The simulated values of Var(sz) were always smaller than
Equation (1), but the two curves are close. Similarly, when vary-
ing 71’111 Figure 3B, we found that Equation (1) is greater than the
simulated value, though not much. Notice also that as expected
from Equation (1), a 10-fold change in sequence length corres-
ponds to a 10-fold change in Var(sz) (Fig. 3A), whereas a 10-fold
change in It corresponds to an enormous 105-fold change in
Var(sz) (Fig. 3B).

This comparison between simulated and computed Var(sz)
values suggests that our test is conservative. Accordingly,
we found that for the low rate of recombination of
,0/bp = 10—7 the null hypothesis of no recombination is rejected
at 01 = 0.05 with a frequency of only 0.032 rather than the
expected 0.05 (Fig. 4). However, with increasing recombination
the rejection rate grows to >0.99 until ,0 W It. When ,0 exceeds It,
the rejection rate declines again, as our test statistic Dr is max-
imal if at w ,0. We also compared the rejection rate with Dr to
that with the homoplasy—based test statistic CIDW, which is
computed from four or more aligned sequences (Bruen et al.,

A
2><106

 

Computed Var(s2 )I _|;
Simulated Var(s2) -——..x.____

2x106-
>I

1x106-

5x105-

 

 

 

 

0 x 100
1
Sequence Length (X 105)

1016 _

 

Computeld Var(32) —|—
Simulated Var(s2) -——-.)<._.__

1014 -

1012 _

1010 -

108 -

106 -

 

 

 

104 - I i“
10-4 10-3 10-2
71'

 

Fig. 3. Comparing the observed variance of the variance in shustring
length, Var(s2), simulated without recombination to Var(s2) calculated
according to Equation (1) along the two dimensions of Var(s2), sequence
length (A) and genetic diversity, n (B). Number of replicates: 104; in A
n = 10—2; in B sequence length 105

2006). Figure 4 shows that CIDW has a similar rejection curve as
Dr, with slightly less sensitivity at the simulated parameter
combination.

However, the sensitivity of Dr and CIDW depends on the number
of mismatches sampled. Figure 5 shows the rejection rate as a
function of sequence length at at = 10—3 and a length-invariant
expected number of recombination events of 100. When sequence
length is 105, Dr and CIDW have little power, whereas 10 times
longer sequences yield rejection in Z 97% of cases, with CIDW mar-
ginally outperforming Dr.

It is reassuring that Dr is highly sensitive in the limit of long
sequences. This is equivalent to saying that Dr is sensitive when
applied to polymorphic sequences as long as It is small. This
proviso follows from the assumption that shustrings are hom-
ologous. The greater at, the more shustrings occur that are
generated by random non-homologous matches between query
and subject.

 

3123

112 /810's112umo[pJOJXO'soi1em10juioiw/2d11q 11101; pepeolumoq

910K ‘09 lsnﬁnV HO 2:

B.Haubold et al.

 

 

 

 

 

 

 

 

Drl—l—
0.,
1 xxx
LO
Q
CII> 0.8-
d
a
g 0.6-
8
P
g 0.4-
‘8'
a
0.2
0x" I I I I I
10-7 10-6 10-5 10-4 10-3 10-2 10-1

p/bp

Fig. 4. Dr has similar sensitivity as the alignment-based dDW (Bruen et al.,
2006). The graph shows the fraction of hypothesis tests rejected
with signiﬁcance P 5 0.05 as a function of the rate of recombination,
0. Horizontal line: 0.05; Sequence length = 106, 71' = 10—3,
replicates = 104; sample size for dDW: 4

Traditional methods for detecting recombination such as Max-
XZ were designed for sequences no longer than a few kilobase. To
compare Dr with Max-x2, we used the simulation scheme by
Bruen et al. (2006): for CIDW and Max-x2, we simulated samples
of 10 sequences with 0/bp = 0.01 and ,0 = 16. For 1kb sequences,
CIDW was more sensitive than Max-x2, in agreement with Bruen
et al. (2006) (Fig. 6). For Dr, we simulated pairs of sequences
with the same 0, and a ,0 value that resulted in the same expected
number of recombination events as in the sample of 10; that is, we
used ,0 = 16 x 2,921 1/i = 45.3 (Hudson and Kaplan, 1985). For
kilobase length sequences, Dr has little power (Fig. 6). However,
the power of all methods to detect recombination increases with
sequence length (Wiuf et al., 2001). For sequences of 100 kb or
more Dr is sensitive. Incidentally, this is the sequence length where
we stopped the Max-x2 simulations as they became too slow.

The CIDW statistic was developed as a fast alternative to methods
such as Max-x2. We, therefore, simulated sequence quartets of
lengths 104—107bp and timed Phi given an alignment. The slope
of the resulting run time curve was 2.2, that is, doubling the
sequence length increases the run time 22'2 = 4.6-fold. We com-
pared this with rush when applied to sequence pairs of the same
lengths. The slope of its run time curve is 1.2. This is still a bit
steeper than the optimal slope of 1, but means that with double
the input data rush takes 2.3 times longer. As a consequence,
Phi is eventually outperformed by rush for sequences longer
than 100 kb (Fig. 7).

Because Phi requires aligned sequences as input, we also
timed aligning sequence quartets with Mavid (Bray and
Pachter, 2004). Mavid is fast and the slope of its run time
curve is only 1.1, making it virtually optimal. Still, rush is
roughly 100 times faster than alignment-based Phi.

In our ﬁnal set of simulations, we investigated the potentially
confounding effects of codon data and changes in GC content,
and found that the rejection rate was unaffected by either
(Supplementary Figs. S1 and S2).

 

 

Fraction rejected at 04 = 0.05

 

 

 

 

1 2 :3. 21 5 6 '7 2'3 0 10
Sequence Length (x105)
Fig. 5. Rejection rate as a function of sequence length for Dr compared

with (1),, (Bruen et al., 2006); n=10‘3, p: 100 for entire region,
replicates = 104

1

 

0.9 — I
0.8 — 
0.7 
0.6): 
0.5 
0.435
0.3 —

Fraction rejected at oz 2 0.05

0.2 -
0.1 '-

 

 

 

 

0 1 I 1
103 104 105 106 107
Sequence Length (bp)
Fig. 6. Comparing rejection frequencies between dDW, Max-)(2 and Dr as a

function of the length of the input sequences. The simulation parameters
are described in the text

3.2 Horizontal gene transfer in E.coli

Having established the accuracy and robustness of rush
through simulations, we applied it to the 58 fully
sequenced E.coli genomes available from GenBank at the
time of writing (Supplementary Table S1). Figure 8 shows a
cluster diagram of the strains computed from their complete
genomes.

The 58 x 57 = 3306 pairwise recombination tests between the
58 E.coli strains took rush 15 h, 9 min and 15 s on an Intel Xeon
2.40 GHz CPU, an average of 16.5 s per test. In all, 97% of these
tests were rejected with signiﬁcance P 5 0.05, indicating that the
model assumption of uniformly distributed mutations is usually
violated across whole bacterial genomes. Figure 9 shows the dis-
tribution of the 3306 values of our recombination measure Q;

 

3124

112 /810's112umo[p101x0's01112u1101u101q/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV HO 2:

Test for recombination

 

 

I
Mavid + Phi —I—

1000 -

100 -

10-

Time (s)

 

 

 

0.01 E/ ' ' '
104 105 106 107
Sequence Length (bp)

 

Fig. 7. Comparing the run times of Phi and rush as a function of
sequence length. O/bp = 0.01, p = 1000

its median is 2.951 with a huge range of 0.587—40.939. We
focused on the two strains with the largest Q, K011 versus
K12_MG1655, which are marked by arrows in the cluster dia-
gram (Fig. 8).

To search for evidence of horizontal gene transfer, we looked
for regions in the K011 genome that were more closely related to
K12_MG1655 than to its closest relative. The cluster diagram
(Fig. 8) indicates that the closest relative of K011 is KOllFL.
However, this is an artifact of the clutering algorithm, which
guarantees ﬁnding the correct tree only for distances that actu-
ally ﬁt a tree. Empirical distances are often not strictly tree-like,
especially in the presence of recombination. When we look up the
raw pairwise distances, we ﬁnd that the distance between K011
and KOllFL is 2.1 x 10‘5, whereas that between K011 and
W1 or W2 is below the sensitivity of kr, the program we used for
estimating the substitution rates between genomes (Domazet-
Loso and Haubold, 2009). Hence, we took W1 as the closest
relative of K011. Figure 10 shows that at position 4.4 Mb,
K011 contains large fragments more similar to K12_MG1655
than to W1. The longest of these spans 102 kb and is located at
4385 866—4 487 685. When blasting this region against W1, the
best hit is 46.9 kb long and contains 367 mismatches and 13 gaps.
In contrast, the best hit in K12_MG1655 is 78.6 kb long with just
8 mismatches and 1 gap. The next best hit in K12_MG1655 is
23.5 kb long with 4 mismatches and 0 gaps. This is strong evi-
dence for horizontal gene transfer. It looks as if it affected a
common ancestor of K011 and KOllF L because in KOllFL
the 102 kb query generates two top hits, one 68.2 kb long, the
other 33.5 kb with just 2 mismatches and 0 gaps.

4 DISCUSSION

To make the most of genomic sequences, we would ideally use
software that allows us to query them interactively. Our fast
alignment-free test of recombination is intended as a step
toward this goal. The program rush achieves its speed by
using similar string-indexing techniques as applied in the
genome-aligner MUMmer (Kurtz et al., 2004). The central feature

CFT073
ABU 83972
clone D i2
clone D i1

LF82

 

 

 

 

 

083 H1 NRG
536
EDla
UT189
UM146
_ [11153034
APEC 01
$88
—0127 H6 E2
SE15
—INA1 14
SMS-3 5
ﬂ
07 K1 CElO
UMN026
—lI

 

 

 

HS
EATCC 8739

BL21 DE3 8

B REL606

BL21 DE3 9
BL21-Gold

—ETEC H1040
—P12b

K12 W3110

K12 DH10B
BW2952

DHl 017625

DHl 017638

K12 MG1655 <—

 

 

 

 

 

 

0157 H7 ED
0157 H7 Sa
0157 H7 EC
0157 H7 TW

Xuzhou21

055 H7 CB9
055 H7 RMl

Fig. 8. Midpoint-rooted neighbor joining tree of 58 E.coli strains. The

two genomes with the highest recombination measure Q, K12_MG1655
and K011, are indicated by arrows

of this approach to sequence analysis is that it is ‘optimal’ in the
sense that in theory it runs in time linear in the length of the
sequences analyzed. In practice, programs based on modern
string-indexing techniques are fast and memory efﬁcient
(Puglisi et al., 2007). We have been interested for some time
now in bringing the power of these algorithms to biology by
combining them with modeling the distribution of shortest
unique substrings (shustrings), which we take as proxy for the
distribution of the distances to the next polymorphism
(Domazet-Loso and Haubold, 2009, 2011; Haubold et al.,
2005, 2009;). In particular, in our previous derivation of an align-
ment-free estimator of genetic diversity we noted that the mean
shustring length is sensitive to recombination (Haubold and
Pfaffelhuber, 2012).

Here, we have used the test statistic Dr deﬁned in Equation (2),
which is based on the variance of the shustring length.
Speciﬁcally, we compared its observed value, .92, with its expect-
ation, A72. We tested the null hypothesis that Dr 2 0 by deriving
Var(sz) and constructing a parametric hypothesis test. This con-
trasts with the approach taken by the authors of Phi, our main
point of reference: They test the null hypothesis of no recombin-
ation using a permutation test (Bruen et al., 2006). This was not
an option for us because generating the null distribution of

 

3125

112 /810's112umo[p101x0's01112u1101u101q/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV HO 2:

B.Haubold et al.

 

0.6

 

0.5- -

0.4 -

0.3 -

Frequency

0.2 -

0.1 -

0 HT _ITI-I_I'l'|-—— : __1 _1_ I I I
0 5 10 15 20 25 30 35 40 45
Q

Fig. 9. Histogram of all 3306 measures of recombination, Q, computed in
pairwise comparisons between the 58 E.coli strains shown in Figure 8

 

 

 

 

 

 

shustring lengths by shufﬂing polymorphisms requires an align-
ment. Moreover, a parametric approach is faster, albeit some-
times less accurate, than its Monte Carlo equivalent. In our case,
Var(sz) is always slightly larger than its simulated counterpart
(Fig. 3). Our test is thus conservative when applied to simulated
data. This is illustrated by Figure 4, where no recombination
leads to 3% rejections with 01 = 5%. However, a 3% rejection
rate is reasonably close to the expected 5%, giving us additional
conﬁdence that the test statistic Dr behaves as desired.

We compared Max-x2 with Dr using one of the parameter
combinations of Bruen et al. (2006). Our 1kb results in
Figure 6 were compatible with theirs; our results also document
that Dr is not a replacement of established methods, but rather
complements them for megabase-length sequences. Application
to sequences of this length is possible because rush runs ~100
times faster than Phi plus alignment (Fig. 7).

Given that our test is conservative (Fig. 4), it might come as a
surprise that 97% of the pairs of E. coli genomes tested had a
signiﬁcant Dr (Fig. 9). This points to a weakness our method
shares with all methods for detecting recombination that are
based on the identiﬁcation of clustered polymorphisms. These
methods are sensitive to variations in the rate of mutation.
This is the reason for the superiority of homoplasy—based meth-
ods including CIDW over cluster-based methods (Bruen et al., 2006).

In the present study, we compared in particular the alignment-
based test statistic CIDW with our alignment-free test statistic Dr.
An important difference between them is that CIDW is applied to at
least four aligned sequences, whereas Dr compares unaligned
pairs of query and subject sequences. In our example application
the subject was always a single genome, but it could also consist
of several concatenated sequences.

Statistical tests exist independently of their implementations.
However, to analyze simulated and experimental data, we rely on
the tests’ implementations, which may or may not be the best
possible. With this proviso in mind, we computed CIDW using the
published program Phi (Bruen et al., 2006), and Dr using our
new program rush. The program rush is always faster than the
alignment step necessary for applying Phi. However, for

0 0.4 0.8 1.2 1.6 2.0 2.4 2.8 3.2 3.6 4.0 4.4 4.8

Fig. 10. Comparison between E. coli strain K011 as query and the two
strains K-12_MG165 and W1 as subject using the program a1 fy
(Domazet—Loso and Haubold, 2011). Regions where K011 is most clo-
sely related to W1 are shown in light gray, regions closer to K-12_MG165
in black; query regions with no close homolo g in the subject sequences are
shown in white. The x—axis gives positions in megabase

sequences longer than 105 rush is even faster than Phi given
an alignment (Fig. 7). Its ability to work without alignment
makes rush not only fast, it also facilitates its application to
genomes that are available only as sets of contigs. This is useful
because genomes are increasingly published in this form rather
than as fully assembled chromosomes. In our study, not aligning
enabled us to efﬁciently search for the genome pair with the
largest value of Q 2 52/1172, which was K011 as query and
K12_MG1655 as subject. The closest relative of K011 is strain
W. Together with strains K12, B and C this belongs to the select
group of four E.coli strains classiﬁed as Risk Group 1 organisms;
these are safe to use in the laboratory. It turns out that K011
was engineered in 1991 from W to produce ethanol (Ohta et al.,
1991; Turner et al., 2012). In the process, two chunks of DNA
were transferred into what became K011: three genes for ethanol
production from Zymonas mobilis and 125 kb of the laboratory
work horse E.coli K12_MG1655. These 125 kb comprise the
uvrA—mutL region of the K12_MG1655 chromosome. The
102 kb fragment we investigated starts inside the uvrA locus. In
other words, we have picked up a region that was acquired from
K12_MG1655 20 years ago. During these 20 years K011 was
serially transferred and evolved into KOllFL. We found that
K01 1FL had diverged more from its ancestor K011 than from
their common ancestor W. This was also reported by the team
that sequenced KOllF L (Turner et al., 2012).

5 CONCLUSION

Our fast method for detecting recombination from unaligned
genomes is accurate when applied to simulated data. Applied
to bacterial genomes, it diagnoses recombination too frequently,
due to variation in mutation rate across long sequences. This is a
weakness Dr shares with other methods to detect recombination
based on identifying polymorphism clustering (Bruen et al.,
2006). Nevertheless, using the recombination measure Q, we dis-
covered the strongest signal for the pair of E.coli genomes that
had undergone an engineered 125 kb horizontal gene transfer 20
years ago.

ACKNOWLEDGEMENT

The authors are grateful to Paul Rainey for helpful comments.

Funding: Deutsche F orschungsgemeinschaft through grant
(Pf672/3-1) (to RP).

 

3126

112 /810's112umo[p101x0's01112u1101u101q/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV HO 2:

Test for recombination

 

Conflict of Interest: none declared.

REFERENCES

Abouelhoda,M. et al. (2002) The enhanced sufﬁx array and its applications to
genome analysis. In: Proceedings of the Second Workshop on Algorithms in
Bioinformatics. Lecture Notes in Computer Science 2452, Springer-Verlag,
pp. 449—463.

Baquero,F. (2004) From pieces to patterns: evolutionary engineering in bacterial
pathogens. Nat. Revi. Microbiol, 2, 510—518.

Bray,N. and Pachter,L. (2004) MAVID: constrained ancestral alignment of multiple
sequences. Genome Res, 14, 693—699.

Bruen,T.C. et al. (2006) A simple and robust statistical test for detecting the pres-
ence of recombination. Genetics, 172, 2665—2681.

Darling,A.C.E. et al. (2004) Mauve: multiple alignment of conserved genomic
sequence with rearrangement. Genome Res, 14, 1394—1403.

Didelot,X. et al. (2010) Inference of homologous recombination in bacteria using
whole genome sequences. Genetics, 186, 1435—1449.

Domazet-Lo§o,M. and Haubold,B. (2009) Efﬁcient estimation of pairwise distances
between genomes. Bioinformatics, 25, 3221—3227.

Domazet—Lo§o,M. and Haubold,B. (2011) Alignment-free detection of local simi-
larity among viral and bacterial genomes. Bioinformatics, 27, 1466—1472.

Felsenstein,J. (1974) The evolutionary advantage of recombination. Genetics, 78,
737—756.

Felsenstein,J. (2005) PHYLIP (phylogeny interference package) version 3.6.

Fisher,R.A. (1930/1999) The Genetical Theory of Natural Selection. Variorum edn.
Oxford University Press, Oxford.

Gusﬁeld,D. (1997) Algorithms on Strings, Trees, and Sequences: Computer Science
and Computational Biology. Cambridge University Press, Cambridge.

Haubold,B. and Pfaffelhuber,P. (2012) Alignment-free population genomics: an
efﬁcient estimator of sequence diversity. Genes Genomes Genet, 2, 883—889.

Haubold,B. et al. (2009) Estimating mutation distances from unaligned genomes.
J. Comput. Biol., 16, 1487—1500.

Haubold,B. et al. (2005) Genome comparison without alignment using shortest
unique substrings. BM C Bioinformatics, 6, 123.

Haubold,B. et al. (2011) Alignment-free estimation of nucleotide diversity.
Bioinformatics, 27, 449—455.

Hudson,R.R. (1985) The sampling distribution of linkage disequilibrium under an
inﬁnite allele model without selection. Genetics, 109, 611—631.

Hudson,R.R. (2002) Generating samples under a Wright-Fisher neutral model of
genetic variation. Bioinformatics, 18, 337—338.

Hudson,R.R. and Kaplan,N.L. (1985) Statistical properties of the number of
recombination events in the history of a sample of DNA sequences. Genetics,
111, 147—164.

Kurtz,S. et al. (2004) Versatile and open software for comparing large genomes.
Genome Biol., 5, R12.

Manzini,G. and Ferragina,P. (2002) Engineering a lightweight sufﬁx array
construction algorithm. In: ESA ’02: Proceedings of the 10th Annual European
Symposium on Algorithms. Springer-Verlag, London, pp. 698—710.

Maynard Smith,J. (1992) Analysing the mosaic structure of genes. J. M ol. Evol., 34,
126—129.

Muller,H.J. (1932) Some genetic aspects of sex. Am. Nat., 66, 118—138.

Muller,H.J. (1964) The relation of recombination to mutational advance. Mutat.
Res, 1, 2—9.

Ohta,K. et al. (1991) Genetic improvement of Escherichia coli for ethanol produc-
tion: chromosomal integration of zymomonas mobilis genes encoding pyruvate
decarboxylase and alcohol dehydrogenase II. Appl. Environ. Microbiol, 57,
893—900.

Otto,S.P. (2007) Unravelling the evolutionary advantage of sex: a
commentary on ‘Mutation-selection balance and the evolutionary advantage
of sex and recombination’ by Brian Charlesworth. Genet. Res. Camb., 89,
447—449.

Otto,S.P. and Lenormand,T. (2002) Resolving the paradox of sex and recombin-
ation. Nat. Rev. Genet, 3, 252—261.

Posada,D. (2002) Evaluation of methods for detecting recombination from DNA
sequences: empirical data. Mol. Biol. Evol., 19, 708—717.

Puglisi,S.J. et al. (2007) A taxonomy of sufﬁx array construction algorithms. ACM
Comput. Surv., 39, 4.

Sawyer,S.A. (1989) Statistical tests for detecting gene conversion. M ol. Biol. Evol., 6,
526—538.

Tumer,P.C. et al. (2012) Optical mapping and sequencing of the Escherichia coli
K011 genome reveal extensive chromosomal rearrangements, and multiple
tandem copies of the Zymomonas mobilis pdc and ath genes. J. Ind.
Microbiol. Biotechnol, 39, 629—639.

Wakeley,J. (2009) Coalescent Theory: An Introduction. Roberts & Company,
Colorado.

Wiuf,C. et al. (2001) A simulation study of the reliability of recombinaiton detection
methods. Mol. Biol. Evol., 18, 1929—1939.

 

3127

112 /810's112umo[p101x0'sor112u1101u101q/ﬁd11q 111011 pepcolumoq

9IOZ ‘09 lsnﬁnV HO 2:

