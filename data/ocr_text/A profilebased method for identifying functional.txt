Bioinformatics Advance Access published August 8, 2016

 

Sequence analysis

A profile-based method for identifying func-
tional divergence of orthologous genes in bac-
terial genomes

Nicole E. Wheelerl’zi", Lars Barquist3'"*, Robert A. Kingsley”, Paul P. Gardnerl’z’6

1School of Biological Sciences, University of Canterbury, Christchurch, New Zealand, 2Biomolecular Interac-
tion Centre, University of Canterbury, Christchurch, New Zealand, 3Institute for Molecular Infection Biology,
University of Wuerzburg, Wuerzburg, Germany, 4Institute of Food Research, Norwich Research Park, Norwich,
UK, 5Wellcome Trust Sanger Institute, Hinxton, UK, 6Bio-protection Research Centre, University of Canter-
bury, Christchurch, New Zealand.

‘1 These authors contributed equally to this work.

*To whom correspondence should be addressed.
Associate Editor: Dr. Inanc Birol

Abstract

Motivation: Next generation sequencing technologies have provided us with a wealth of information
on genetic variation, but predicting the functional significance of this variation is a difficult task. While
many comparative genomics studies have focused on gene flux and large scale changes, relatively
little attention has been paid to quantifying the effects of single nucleotide polymorphisms and indels
on protein function, particularly in bacterial genomics.

Results: We present a hidden Markov model based approach we call delta-bitscore (DBS) for identi-
fying orthologous proteins that have diverged at the amino acid sequence level in a way that is likely
to impact biological function. We benchmark this approach with several widely used datasets and
apply it to a proof-of-concept study of orthologous proteomes in an investigation of host adaptation in
Salmonella enterica. We highlight the value of the method in identifying functional divergence of
genes, and suggest that this tool may be a better approach than the commonly used dN/dS metric for
identifying functionally significant genetic changes occurring in recently diverged organisms.
Availability: A program implementing DBS for pairwise genome comparisons is freely available at:
https://github.com/UCanCompBio/deltaBS.

Contact: nicole.wheeler@pg.canterbury.ac.nz, lars.barquist@uni-wuerzburg.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Genome sequencing technologies allow us to explore the wealth of ge-
netic variation between and within species, and as these technologies
advance this data is becoming progressively cheaper, faster, and easier to
produce (Loman et al., 2012; Koren and Phillippy, 2015; Loman and
Pallen, 2015). However, analysis of the functional impact of genetic
variation has lagged behind, and has largely focused on the presence or
absence of macroscopic features such as particular genes, genomic is-

© The Author(s) 2016. Published by Oxford University Press.

lands, or plasmids. Comparative sequence analyses have become com-
mon, and exploration of genetic variation between closely-related organ-
isms has provided key insights into bacterial evolution (Croucher and
Didelot, 2014; Bryant et al., 2012; Barquist and Vogel, 2015). In particu-
lar, the analysis of single nucleotide polymorphisms (SNPs) has been a
tremendous boon to the study of bacterial populations, allong for the
construction of phylogenetic trees which provide information on disease
transmission and adaptation at scales ranging from global pandemics
(Mutreja et al., 2011) to outbreaks within single hospital wards (Harris et
al., 2013). Still, the functional analysis of these SNPs, insertions, and

This is an Open Access article distributed under the terms of the Creative Commons Attribution License
(http://creativecommons.orgllicenses/by/4.0/ ), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the

original work is properly cited.

112 [310'8112(Ian[plOJXO'SODBIIIJOJHIOIQ/[Zdinq moi; pepeolumoq

910K ‘09 isnﬁnV no :2

 

deletions within protein sequences remains difﬁcult, and often relies on
inappropriate tools such as dN/dS.

How then can the signiﬁcance of fme-scale genetic variation be quanti-
ﬁed and prioritized for investigation? Recent studies have shown that
even single SNPs can have dramatic effects on major phenotypes such as
host tropism (Viana et al., 2015; Yue et al., 2015; Singletary et al.,
2016). Studies of pathogen adaptation, for example the adaptation of
Pseudomonas aeruginosa to the cystic ﬁbrosis lung (Marvig et al., 2015;
Jorth et al., 2015) or of Salmonella enterica to immunocompromised
populations (F easey et al., 2012; Okoro et al., 2012, 2015), often result in
ﬁndings of hundreds to thousands of SNPs and small indels in coding
regions. Genome-wide association studies provide one method
(Chewapreecha et al., 2014) for interpreting this variation, however the
clonal nature of many pathogens can make such study designs difﬁcult if
not impossible to pursue and require large sample sizes to be effective.
The development of fast and accurate ways to assess the ﬁinctional im-
pact of variation between strains and prioritize coding variants for fol-
low-up work is an important step in extracting meaning from compara-
tive analyses.

Our strategy uses a proﬁle HMM-based approach. Proﬁle HMMs are
probabilistic models of multiple sequence alignments. For each column
in the alignment they capture information on the expected frequency of
occurrence of different amino acids, insertions, and deletions. We can
then use this information to compute a score, which we call delta-
bitscore (DBS) for reasons explained below, that quantiﬁes the diver-
gence of two protein sequences with respect to the conservation patterns
captured by the proﬁle HMM. Our key assumption in this is that varia-
tion in positions conserved across a protein family are more likely to
affect protein function than variation in less conserved positions. Similar
assumptions have had success in a number of applications such as the
prediction of tRNA pseudogenes (Lowe and Eddy, 1997) and protein
folds (Marks et al., 2012). Our approach is unique in both the simplicity
of the measure used, and its ﬂexibility, making it well suited to compara-
tive genomic applications.

We demonstrate that our method is effective using several commonly
used protein mutagenesis datasets, particularly when used with automati-
cally constructed protein alignments. We provide an example of a com-
parative genomic analysis, by applying our approach to a whole proteo-
me analysis of a well-studied case of host adaptation in Salmonella en-
terica serovars Enteritidis and Gallinarum, using a purpose built collec-
tion of HMMs. We additionally show these results generalize to other
host-adapted salmonellae. Finally, we compare our method to a popular
estimate of selection, dN/dS, and ﬁnd that the two measures are only
weakly correlated. This adds to the evidence that dN/dS is not an appro-
priate measure for inferring selection for gene function within bacterial
populations.

2 Methods

3.1 Benchmarking

In order to test the ability of proﬁle HMMs to identify loss-of-function
mutations we used three independent datasets from protein mutagenesis
studies on HIV-1 protease (336 sequences) (Loeb et al., 1989), E. coli
Lac I (4041 sequences) (Markiewicz et al., 1994), and phage lysozyme
(2015 sequences) (Rennell et al., 1991). In these experiments, residues in

the protein were systematically mutated and the impact of these muta-
tions on protein function was quantiﬁed. The data were downloaded
from the SIFT website (http://siﬁ.bii.a-star.edu.sg/) (Kumar et al., 2009).
For binary classiﬁcation of mutants, proteins with a classiﬁcation of “+”
were termed functional mutants and “+-”, “-+”, and “-” were termed loss
of function mutants. We tested two different reference HMM sets: curat-
ed HMMs from the Pfam database (Punta et al., 2012), and automatically
constructed HMMs built using a range of residue identity cutoff values.
We also compared these results to predictions made by the PROVEAN,
SIFT and Mutation Assessor methods. PROVEAN results were down-
loaded pre-computed from their website. Otherwise, all methods were
tested using their default settings. Exclusion of positions in the protein
with low coverage in the SIFT database have only a marginal effect on
SIFT performance (0.7 to 0.71 AUC in lysozyme dataset), and results in
loss of data, so we use all sequence variants in our analysis. In order to
evaluate the accuracy of each method we computed the ‘Area Above the
Curve’ (AAC) for a series of Relative Cost Curve (RCC) plots
(Montvida and Klawonn, 2014). These values range between one and
zero with an AAC equal to one indicating a perfect prediction tool across
the range of relative costs tested. The Biocomb package (www.cran.r-
project.org/package=Biocomb) was used with default relative costs
unless otherwise speciﬁed to calculate AAC scores, and the ROCR
package (Sing et al., 2005) was used to calculate other performance
metrics, which can be found in Supplementary Table 1.

For the construction of custom HMMs, query sequences were searched
against the Uniref90 database (Suzek et al., 2015) using a single iteration
of jackhmmer. Pairwise sequence identity was calculated as the number
of matches between sequence pairs, divided by total length of the align-
ment after the removal of gap-gap columns. HMMs were built using
hmmbuild, and DBS was calculated using hmmsearch, subtracting the
bitscore value for the variant sequence from the bitscore value for the
wild type sequence. jackhmmer, hmmbuild and hmmsearch are part of
the HMMER3 package (version 3.1b2). Protein HMMs were built using
a range of sequence identity cutoffs in order to determine the optimal
range for performance.

3.2 Proteome analysis

We have designed this approach with whole proteome analyses in mind,
so as a proof-of-concept, we applied the approach to the study of host
adaptation in Salmonella enterica, using S. Enteritidis and S. Gallinarum
as a speciﬁc example. For a summary of the workﬂow of this portion of
the analysis, see Supplementary Figure 1. Genomes for Salmonella En-
teritidis str. P125109 (AM933172.1) and Salmonella Gallinarum str.
287/91 (AM933173.1) were retrieved. Custom gene models were con-
structed by searching each S. Enteritidis protein coding gene against the
Uniref90 database. Proﬁles were built using sequences showing 40% or
greater sequence identity to the original query protein.

In order to assess whether models built ﬁom a small number of sequenc-
es performed well, we tested the performance of models using proteins
from the humsavar database (http://www.uniprot.org/docs/humsavar),
which catalogs human polymorphisms and disease variants for a wide
range of proteins which have different levels of representation in Uni-
prot90, and therefore result in proﬁle models built ﬁom varying numbers
of sequences. We built custom models for each protein in the database,
then separated the models into classes based on both number of sequenc-
es and effective sequence number. We then computed AUC values for
predictions made on variant data from each class. Results from this test

112 [310'8112(Ian[plOJXO'SODBIIIJOJHIOIQ/[Zdinq moi; pepeolumoq

910K ‘09 isnﬁnV no :2

can be found in Supplementary Table 2. We saw no classes where cus-
tom models performed worse than Pfam models, so we did not ﬁlter
models built from few sequences. We did, however, use Pfam models for
those proteins with no homologs in Uniref90 rather than build a model
from the query sequence, as we felt this could bias results towards the
reference species.

To assess the quality of our analysis, we wished to compare our results to
those of Nuccio and Baumler (2014), so we used the ortholog calls pro-
vided in their supplementary material. Genes represented by a custom
model were scored using the appropriate model (n=3154), all others were
scored using Pfam domain models. hmmsearch was used for scoring. If
hits to multiple Pfam models occurred, any overlapping hits were com-
peted based on E-value. Orthologs with incompatible Pfam domain
architectures (n=32) were excluded ﬁom scoring, but counted as hypo-
thetically attenuated coding sequences (HACs) in Figure 2A if they
involved a loss of domain in one serovar. We anticipate that the variance
of delta-bitscores will increase with evolutionary distance, so rather than
establish a ﬁxed scoring cutoff for HACs, we identify loss-of-function
mutations using an empirical distribution. We set a score threshold at
which 2.5% of genes on the least dispersed side of the distribution would
be called as HACs. If the two bacteria show an equal rate of protein
function loss, this would result in 5% of orthologous proteins being
called as HACs, however if one proteome shows a greater degree of
functional degradation, this will result in a greater proportion of
orthologs being classiﬁed as HACs.

Functional classiﬁcation was performed using pathways from the KEGG
database (Kanehisa et al., 2016). We grouped genes into four categories:
those present in a pathway but with no ortholog in the other serovar;
genes identiﬁed as hypothetically disrupted coding sequences (HDCs) by
Nuccio and Baumler (2014); genes identiﬁed by our DBS method as
HACs, but not as HDCs; and ﬁnally genes not identiﬁed as non-
functional by either method. dN/dS values were calculated using PAML
(Yang, 1997), and for the comparison of DES and dN/dS, genes were
ﬁltered for those with dN>0 and dS>0.0001. Correlations between
measures were computed using a Spearman’s rho statistic (R package
cor).

In our investigation of multiple S. enterica isolates, for all orthologous
groups with a gene present in S. Enteritidis, scores were collated, and if
individual scores were signiﬁcantly different to the median score for all
isolates, we identiﬁed these proteins as HACs. Signiﬁcant difference was
calculated in a similar way to the pairwise comparisons, with the score
corresponding to the most extreme 2.5% of delta-bitscores on the least
dispersed side of an empirical distribution being used as the cutoff.

3 Results

3.3 The delta-bitscore measure

Alignment of a protein sequence to a proﬁle HMM produces a bitscore
value, which is the log odds ratio for this sequence under the proﬁle
HMM compared to a random null model, and serves as an indication of
protein family membership. In subtracting the bitscore of one protein or
domain ﬁom that of another, we produce a measure of the divergence

between the two proteins, taking into consideration conservation patterns
captured by the protein family model.

We deﬁne delta-bitscore using the following equation:

 = xref' xvar
Where DBS is delta-bitscore and, x,efand xv“, are bitscores for reference
and variant sequences derived from alignments to the same proﬁle
HMM.

Highly conserved positions in a model alignment contribute more to
bitscores than poorly conserved positions, meaning that unexpected
mutations or indels in conserved sites are given a greater penalty than
mutations in variable sites. In addition, the replacement of residues with
chemically and structurally similar residues is generally scored more
favourably than mutation to dissimilar residues. Multiple functionally
neutral changes are likely to result in individual contributions to the
bitscore that are small in magnitude and that cancel out over the length
of the protein, while functionally signiﬁcant change in a protein will
likely produce one or more position-speciﬁc values of high magnitude
that have a greater impact on overall DBS for the sequence. We ﬁrst
introduced this measure as part of studies of Salmonella adaptation to an
wild avian host (Kingsley et al., 2013), and during within-host evolution
of a hypermutator strain of Salmonella Enteritidis in an immunocom-
promised patient (Klemm et al., 2016), and elaborate upon it here. The
Supplementary Text contains further discussion of this measure and
comparisons with related measures derived ﬁom proﬁle HMMs (Clifford
et al., 2004; Shihab et al., 2013; Liu et al., 2015).

3.4 DBS is predictive of protein functional status

Evaluating the performance of different methods for the quantiﬁcation of
the effects of sequence variation is challenging. For the case of human
variation, some datasets exist, however given the limited amount of data
available on functional protein variants care must be taken to avoid cir-
cularity in training and testing (Boulesteix, 2010; Grimm et al., 2015).
While we have not comprehensively benchmarked DBS on human data
sets given our focus on prokaryotic variation, we found it is competitive
with other untrained methods (Supplementary Figures 3,4), despite its
simplicity. In the case of bacterial variation we are not aware of well-
characterized collections of protein variants. Rather, to test our method
we compared its performance to a selection of methods on three large
scale protein mutagenesis datasets (Kumar et al., 2009) (Figure 1A,
Supplementary Figure 2 shows AUC values for the same analysis).

A number of methods have been designed for predicting the impact of
sequence variation on the function of non-human proteins, and we com-
pare our measure to three competitive methods here (Grimm et al.,
2015). These include: PROVEAN, which uses a BLAST-based approach
to score sequence variants using closely related sequences (Choi et al.,
2012); the SIFT algorithm which uses position-speciﬁc scoring matrices
based on sequence homology and known patterns of common amino acid
substitutions to predict the ﬁinctional consequences of non-synonymous
single nucleotide polymorphisms (nsSNPs) (Kumar et al., 2009); and
MutationAssessor which computes both the conservation and speciﬁcity
of residues within protein subfamilies to assess the impact of a mutation
(Reva et al., 2011).

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

 

 

 

 

 

 

 

 

 

C3
C0. _
O
_ 0 o
8 _ o
(a? 0' . . Dataset
T O l Pha el 2 me
< 9 Y30 Y
3 _ ’ I Lacl
O . . l HIV protease
‘ o
O
o _
C). l | | | | i | l | | I | 1 I | |
0 10 20 30 40 50 60 70 80 90 100 8 8 E L; 8
D D LLI m U)
. . E E 5 39
Percent Identity .9 ,9 n: 33
(Custom—builtHMMs) “L 3’ EL ,5
“1'6
‘5'
E

B Distribution of scores for E. coli Lacl protein
Pfam models

 

_ l Functional
I Loss of function

0.6

 

 

Density

 

 

 

 

Delta—bitscore

C Distribution of scores for E. coli Lacl protein

Custom models

 

Density
0.20 0.30
| |

0.10
l

 

 

 

0.00
I

—4 —20 2 4 6 810

Delta—bitscore

Fig. 1. (A) Area above the relative cost curve (AAC) values for different analysis methods using three mutagenesis benchmarking datasets: phage lysozyme, LacI and HIV protease. The
performance for each model across a range of sequence identity cutoffs is shown, as well as AAC values for the individual methods. AAC of 1.0 indicates perfect performance; (B)
Distribution of delta-bitscores for E. coli LacI using custom model analysis; (C) Distribution of delta-bitscores for E. coli LacI using Pfam model analysis.

As a comparison, we used DBS in two distinct ways. In the ﬁrst, we
calculated DBS scores based on alignments to curated Pfam domains
(Punta et al., 2012). In the second, we constructed proﬁle-HMMs con-
taining sequences of varying minimal sequence identity. These two
approaches to model construction capture distinct forms of information:
Pfam domains are designed to capture maximal sequence diversity, and
focus on deeply conserved domains within protein sequences. Addition-
ally, many families are manually curated, and the alignment of known
functional regions, such as active sites, may have been improved in some
cases. Our custom proﬁles capture full length protein sequences. This
means that the functions of sequences captured by custom models may
be narrower than those captured by Pfam, and additionally will capture
linker regions between conserved domains, which may nevertheless be
functionally important.

Our benchmark showed that custom HMMs built at 40% identity outper-
formed other methods in terms of area above the relative cost curve
(AAC) and maximum Matthew’s correlation coefﬁcient, with the excep-
tion of the superior performance of SIFT and PROVEAN on the HIV
protease data (Figure 1A, and Supplementary Table 1). DBS using Pfam
models had the best speciﬁcity across all datasets tested, but at the ex-

pense of sensitivity (see Figure 1B, Supplementary Table 1). This sug-
gests that Pfam models are indeed capturing ancient features of protein
families, and may be useful in cases where a low false-positive rate is
desired at the expense of potentially missing variants. Our custom mod-
els meanwhile appeared to perform optimally with a 40% identity cutoff
(Figure 1A, C). Interestingly, 40% sequence identity has previously been
proposed as a rule of thumb identity cutoff for the transfer of enzyme
annotations (Addou et al., 2009; Tian and Skolnick, 2003), indicating
that this cutoff may reﬂect a common point of functional divergence in
protein families.

3.5 DBS identiﬁes pathways associated with host range re-
striction in Salmonella Gallinarum

We have established that DBS can detect functionally relevant muta-
tions. To explore the utility of this approach in a comparative genomics
context, we developed a tool that takes whole proteome ﬁles as input,
builds custom HMMs where applicable and uses Pfam HMMs to score
the remaining genes, in order to identify functionally signiﬁcant varia-
tion between two proteomes. Using this tool, we compared the proteo-
mes of two closely related Salmonella enterica serovars that have expe-

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

rienced contrasting selective pressures leading to host-restriction for one
of them.

Host-restriction is a common phenomenon in highly adapted invasive
pathogens, often characterized by genomic features such as the prolifera-
tion of transposable elements and the degradation of substantial fractions
of coding sequences (Moran and Plague, 2004; Goodhead and Darby,
2015). Within Salmonella enterica such restriction events have occurred
independently multiple times in various hosts from broad host-range
ancestors. Salmonella enterica serovar Enteritidis is a broad host- range
pathogen, capable of infecting humans, cattle, rodents and a variety of
birds, while the closely related serovar Gallinarum is restricted to infect-
ing galliforme birds (Rabsch et al., 2002). S Gallinarum and S. Enter-
itidis have recently evolved from a common ancestor, however the S.
Gallinarum genome has undergone extensive degradation since diver-
gence (Thomson et al., 2008; Langridge et al., 2015). In addition to
being restricted to a narrow host range, S. Gallinarum has lost motility

A Enteritidis

Carbohydrate metabolism
Energy metabolism

Lipid metabolism
Nucleotide metabolism
Amino acid metabolism
Other amino acids
Cotactors and vitamins
Xenobiotics

Membrane transport
Signal transduction
Chemotaxis

Total assigned to a pathway

Gallinarum

and causes a systemic, typhoid-like infection in birds, unlike Enteritidis
which usually causes a self-limiting gastroenteritis (Thomson et al.,
2008). A recent analysis of pseudogenes within this and other invasive
Salmonella lineages identiﬁed signatures of host-restriction, character-
ized particularly by the loss of metabolic genes required for survival in
the intestine (Langridge et al., 2015; Nuccio and Baumler, 2014). Both
of these analyses involved the manual comparison of coding sequences
to identify mutations that would result in frameshifts or truncated pro-
teins. We expect DBS to add an additional layer of information to such
an analysis, identifying genes which have shifted in or lost function due
to non-synonymous mutations or small indels occurring since the re-
striction event, but have not yet succumbed to obvious disruption events
such as large truncations, frameshifts, or complete deletions.

As shown in Figure 2A, our loss-of-function predictions included many
genes not identiﬁed as hypothetically disrupted coding sequences
(HDCs) by manual inspection muccio and Baumler, 2014).

 

Classification of genes

Absent in Enteritidis
Enteritidis HDC
Enteritidis HAC
Gallinarum HAC
Gallinarum HDC
Absent in Gallinarum

 

 

 

 

—25-
0—
5—

C

 

 

 

 

0.0 1 " ' I H—
| | l l I
—10 —5 0 5 10

Delta—bitscore

 

1 000-

IDBSI

g .l:

TN

100-
125-
150-

Number of genes

 

 

 

 

100— o
o
o
o
0' 0 Q.
'V§:oo
. .’
’... Q
0 o .‘o .
t'.' o
o
e
o o
| | I
10 1.5 20

 

ledS

Fig. 2. The results of a DBS comparison of the proteomes of S. Enteritidis (a generalist infectious agent) and S. Gallinarum (a host-restricted infectious agent). (A) The functional changes
in orthologous protein-coding genes of S. Enteritidis and S. Gallinarum have been grouped into functional categories using the KEGG pathways database. Genes included in the pathway
that have no ortholog in the other serovar are indicated in the darkest colour, followed by genes previously identiﬁed as hypothetically disrupted coding sequences O-IDCs), then genes
with signiﬁcant DBS values that had not already been identiﬁed as HDCs. We refer to these as hypothetically attenuated coding sequences a-IACs); (B) The distribution of delta-bitscores
for orthologous genes showing non-synonymous changes in S. Enteritidis and S. Gallinarum. A symmetrical empirical distribution of scores generated by mirroring the least dispersed side
is shown in red, the cutoff values we use to establish signiﬁcance are shown as dashed lines. A skewed distribution implies excess functional changes in one lineage; (C) A plot of the
dN/dS score and corresponding DBS is shown for each orthologous S. Enteritidis and S. Gallinarum gene.

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

We examined the concurrence between our loss of function calls and
those made by Nuccio and Baumler. Of 252 HDCs identiﬁed in S. Galli-
narum but not in S. Enteritidis from the previous study, 148 of these
were also classiﬁed as HACs by DES, and a further 6 as HACs due to a
loss of a domain in the S. Gallinarum copy of the gene (61% total
agreement). Of the 104 disagreements, 28 genes had a DBS score below
the threshold, and 70 were excluded ﬁom scoring analysis for having
incompatible domain architectures (n=14) or no hits for either protein
sequence to the Pfam database or any of our custom models (n=56). Of
these 56, over half were fewer than 150 amino acids long, often due to
extreme truncations or early frameshifts (see Supplementary Table 3). Of
the 28 low scoring variants, many involved short truncations, alternate
starts or indels of <10 amino acids. The remainder involved S. Gallinar-
um pseudogenes that had no hits to custom models or Pfam domains in
the truncated region. In many cases our models showed low sequence
conservation and gaps in the regions affected by mutation.

As expected, the distribution of DBS values centers around zero (Figure
2B), showing that most orthologous gene pairs differ ﬁom the modeled
sequence constraints to a similar degree. The distribution of DBS values
shows an enrichment for positive DBS (exact binomial test, P = 2.18 e-
35), indicating greater divergence from the proﬁle models for protein
coding genes ﬁom S. Gallinarum when compared to S. Enteritidis. While
some of these positive DBS values may indicate functional divergence
rather than pseudogenization, extreme DBS values predominantly corre-
spond to truncations, indels and mutations in highly conserved sites, so
we assume that in these cases the ancestral function has been lost. To
look at these hypothetically attenuated coding sequences (HACs) in a
functional context, we grouped genes into functional categories based on
their annotation in the KEGG database. Not only does S. Gallinarum
have fewer genes than S. Enteritidis for most of the functional categories
we considered (data not shown), but it also has a greater number of
HACs across these groupings (Figure 2A). Previous work that found the
presence of non-ancestral pseudogenes in S. Enteritidis was limited while
S. Gallinarum had accumulated a large number of pseudogenes since
divergence is consistent with our results (Langridge et al., 2015).

In our analysis we found a number of results which are in agreement
with previously published ﬁndings. Degradation of genes involved in
chemotaxis is consistent with a loss of motility in this strain, and previ-
ously identiﬁed degradation of chemotaxis genes in other host adapted
strains (Kingsley et al., 2013; McClelland et al., 2004). Fimbriae are also
thought to be important for host colonisation by Salmonella, and we
found high DBS values for bcfA, bch and sth. Pseudogenization of
other genes in these operons have already been identiﬁed in S. Gallinar-
um (Foley et al., 2013). We found a number of HACs in genes involved
in the utilization of nutrients derived ﬁom the inﬂamed host gut envi-
ronment colonized by gastrointestinal serovars of Salmonella (Nuccio
and Baumler, 2014) (Supplementary Table 5). This is consistent with the
recent adaptation of S. Gallinarum from an ancestral gastrointestinal
pathogen to an extra-intestinal environment. Among the most highly
ranked genes were representatives of the cbi, pdu, and eut operons, pre-
viously identiﬁed as central pathways subject to gene decay in S. Galli-
narum (Langridge et al., 2015; Nuccio and Baumler, 2014). A complete
table of DBS values for orthologous genes can be found in Supplemen-
tary Table 6.

These ﬁndings demonstrate that DBS provides an additional layer of
information about gene function in addition to gene deletion when inves-
tigating serovars that have recently diverged. As time since divergence

increases we expect that non-functional genes will be deleted and the
ratio of non-functional and deleted genes will change. We anticipate that
our method will be most useful in comparisons of organisms which have
recently diverged, as it offers an opportunity to identify loss-of-ﬁinction
mutations that occur as an immediate response to a new environment and
restricted population size, before deletion of entire genes occurs (Kuo
and Ochman, 2010).

3.6 DBS does not correlate strongly with dN/dS

In comparing genome sequences, we have focused on identifying func-
tionally signiﬁcant variation, whereas a common approach is to classify
genes from an evolutionary point of view, i.e. to identify genes are under
negative selection, positive selection or that are evolving neutrally. A
commonly used measure of selection is dN/dS (co), which compares the
rate of nonsynonymous changes in protein-coding sequences to the rate
of synonymous changes to classify genes as either negative selection (co
< 1), positive selection (co > 1) or neutrally evolving (co z 1) (Yang and
Bielawski, 2000). While dN/dS is an inappropriate metric to use in com-
paring bacteria at the strain level (Rocha et al., 2006), the metric is nev-
ertheless used in similar situations (Roumagnac et al., 2006; Fleisch-
mann et al., 2002; Holden et al., 2004), so we compared the results of the
commonly used PAML program and DBS. In comparing the results ﬁom
the two approaches, one of the most striking results is that there is little
correlation between DES and both dN/dS (R z0.17) and dN (R $0.18).
Of the genes with high DES and low dN/dS, most of these can be at-
tributed to insertions and deletions, which are ignored by dN/dS but can
have signiﬁcant impacts on the functioning of a protein. Genes with low
DES and high dN/dS tend to carry a small number of nonsynonymous
changes, most of which are between chemically similar residues, and a
smaller number of synonymous mutations.

3.7 DBS reveals trends of gene degradation across host-

 

 

 

 

 

 

 

 

 

 

 

 

adapted Salmonella

E

It!

>

9 120—

3

to 100-

(D

O

a 80-

(U

U)

0 60—

<1:

I 40—

“5

a 20— I

E

o 0-

O E 9 g < E E
g B :2 IE 9: a
3 E 'h D- I— (U
E 'c .9 3‘ g
._ ._ c (U _
o. I a o
,2

Fig. 3. Counts of hypothetically attenuated coding sequences a-IACs) for each serovar,
identiﬁed as the most extreme deviations from the median bitscore across strains for each
gene. The generalist serovars are coloured in dark grey, host-restricted serovars are

coloured in light grey.

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

To test whether a positively skewed DBS distribution was a common
feature of host adaptation in Salmonella, we performed DBS analysis on
three broad host range and three host-adapted Salmonella serovars. Ra-
ther than performing many pairwise comparisons to call HACs, for this
analysis we compared bitscores for each gene to the median gene
bitscore of the six strains. We found that host-restricted serovars showed
a greater number of HACs than generalist serovars across all strains
tested (Figure 3A). We previously observed a similar phenomenon in
host-restricted strains of S Typhimurium (Kingsley et al., 2013). We
observed a striking similarity in the score distributions of generalist
strains, and in host-adapted strains (Supplementary Figure 6), with the
generalist scores being lower overall than the host restricted scores. It is
interesting to note that most of the separation in scores occurs at DBS
values below our cutoff value for HAC classiﬁcation (DBS = 8.2, Sup-
plementary Figure 6, top panel). Based on our benchmarking, if these
proteins were tested in vitro many of them would show differences in
function, but whether these differences relate to differences in intracellu-
lar and environmental conditions shaping the sequence requirements for
these proteins or whether they relate to true declines in function is difﬁ-
cult to assess without experimental validation.

4 Discussion

We have described a surprisingly simple method for identifying func-
tional divergence in orthologous proteins, including analysis of both
point mutations and indel events. Despite the simplicity of the DBS
measure, its accuracy is similar to state-of-the-art methods for predicting
the ﬁinctional impact of sequence variants. While curated Pfam models
were less sensitive, they have a high speciﬁcity at conservative scoring
thresholds (see Supplementary Table 1, Supplementary Figure 5). The
workﬂow for using such models is simpler (see Supplementary Figure
l), and may be more appropriate for investigations where a low false-
positive rate is more important than detection of all loss-of-ﬁinction
mutations. In addition, while construction of custom models can be time-
consuming to run on a desktop computer, Pfam annotation can be per-
formed rapidly. Because other methods for estimating the impact of
sequence variation, such as SIFT, PROVEAN and MutationAssessor,
require the user to specify mutations individually, broad scale compara-
tive proteome analysis such as this is difﬁcult and time-intensive to
perform, and not all methods are able to score indels or more than one
mutation in the same sequence. Both DBS approaches scale to whole
proteome analysis with minimal user involvement (see Github page for
pipelines), and were able to detect additional loss of function mutations
that were missed by previous studies focused on protein truncations and
ﬁameshifts.

3.8 DB5 for the study of bacterial adaptation

Large scale genomic studies of bacterial pathogens have revealed strik-
ing similarities in evolutionary patterns in diverse pathogenic and sym-
biotic lineages. While adaptation to a new environment may involve the
acquisition of new ﬁtness determinants and rare, beneﬁcial mutations,
niche adaptation is also frequently accompanied by widespread loss-of-
function mutations, particularly in pathogenic and symbiotic lineages.
These loss-of-function mutations are likely generated through a number
of distinct processes (Moran, 2002), including neutral or slightly delete-
rious stochastic loss due to reductions in effective population size, neu-
tral loss of genes no longer required in the new environment, and adap-
tive loss (Hottes et al., 2013). DBS presents an opportunity to mine the

genomes of bacteria adapting to new environments for these loss of
function mutations, which may tell us as much about bacteria’s adapta-
tion to new environments as the acquisition of new genes. Comparative
approaches based on pseudogene analysis have identiﬁed consistent
signatures of adaptation in a number of bacterial pathogens, including
Yersinia (Reuter et al., 2014; McNally et al., 2016), E. coli and Shigella
(Monk et al., 2013; Feng et al., 2011), and Salmonella (Langridge et al.,
2015; Nuccio and Baumler, 2014). Our analysis of Salmonella genomes
has shown that DBS is consistent with these previous studies, while
providing additional sensitivity to detect non-functional or functionally
divergent protein variants that may have been missed by pseudogene
analyses (Kingsley et al., 2013).

3.9 DBS as a more appropriate alternative to dN/dS for
studying evolution across short time scales

While dN/dS can be a powerful approach to identifying genes under
positive selection across long time scales, on shorter timescales it has
been shown to be inaccurate, due to the lag in the removal of slightly
deleterious mutations This leads to high dN/dS ratios being common-
place in comparisons of closely related strains, suggesting positive or
relaxed selection where there is none (Rocha et al., 2006). Other studies
have shown that dN/dS can provide inaccurate, even contradictory, re-
sults depending on the structure of the population being sampled (Krya-
zhimskiy and Plotkin, 2008). In spite of this, dN/dS is still commonly
used in comparisons of closely related bacteria. Due to the unreliability
of dN/dS measures at short evolutionary timescales and the inability of
dN/dS based methods to score indels, we propose that DBS is a more
suitable analysis tool for the study of ﬁinctional divergence in recently
diverged strains. In contrast, we would advise caution in the use of DBS
on more divergent organisms, with careful consideration of the effects of
sequence divergence on bitscore. Over time each lineage could accumu-
late mutations that affect protein function in different ways, but have the
same degree of impact on bitscore, leading to a net DBS near zero. This
does not necessarily indicate preservation of function and may instead
indicate equal divergence from ancestral ﬁinction. We have not exam-
ined the performance of DBS on deeply diverged lineages, partly for lack
of data. Our observation that DBS performs optimally when reference
alignments are in the 40 percentidentity range suggests sequences more
divergent than this may be outside the range where can DBS provide
meaningful information, but this will require additional investigation to
establish.

3.10 Concluding remark

We anticipate that this approach will be a useﬁil addition to traditional
comparative genomics workﬂows. It provides an effective method for
scoring the functional potential of the overwhelming numbers of non-
synonymous variants that can distinguish closely related bacteria, allow-
ing better prioritisation for further experimental investigation.

Acknowledgements

We would like to thank Fatemeh Ashari Ghomi for her contributions, and Sean
Eddy for his clariﬁcation of some technical aspects of the HMMER3 software.

Funding

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

 

This work was supported in part by the Wellcome Trust, grant number
WT098051. NEW is supported by a PhD scholarship from the University of Can-
terbury. LB was supported by a Research Fellowship from the Alexander von
Humboldt Stiltung/Foundation. PPG and NEW are supported by a Rutherford
Discovery Fellowship administered by the Royal Society of New Zealand.

Conﬂict of Interest: none declared.

References

Addou,S. et a]. (2009) Domain-based and famﬂy-speciﬁc sequence identity thresh-
olds increase the levels of reliable protein ﬁinction transfer. J. Mal. Biol,
387, 416—430.

Barquist,L. et a]. (2013) Approaches to querying bacterial genomes with transpos-
on—insertion sequencing. RNA Biol, 10, 1161—1169.

Barquist,L. and Vogel,]. (2015) Accelerating Discovery and Functional Analysis of
Small RNAs with New Technologies. Annu. Rev. Genet, 49, 367—3 94.

Boulesteix,A.-L. (2010) Over-optimism in bioinformatics research. Bioinformatics,
26, 43 7—43 9.

Bryant,J. et a]. (2012) Developing insights into the mechanisms of evolution of
bacterial pathogens from whole-genome sequences. Future Micrabial, 7,
1283—1296.

Chewapreecha,C. et a]. (2014) Comprehensive identiﬁcation of single nucleotide
polymorphisms associated with beta-lactam resistance within pneumococ-
cal mosaic genes. PLaS Genet, 10, e1004547.

Choi,Y. et a]. (2012) Predicting the ﬁinctional effect of amino acid substitutions
and indels. PLaS One, 7, e46688.

Clifford,R.J. et a]. (2004) Large-scale analysis of non-synonymous coding region
single nucleotide polymorphisms. Bioinformatics, 20, 1006—1014.
Croucher,N.J. and Didelot,X. (2014) The application of genomics to tracing bacte-

rial pathogen transmission. Curr. Opin. Micrabial, 23C, 62—67.

Eddy,S.R. (2011) Accelerated Proﬁle HMM Searches. PLaS Camput. Biol, 7,
e1002195.

Feasey,N.A. et a]. (2012) Invasive non-typhoidal salmonella disease: an emerging
and neglected tropical disease in Africa. Lancet, 379, 2489—2499.

Feng,Y. et a]. (2011) Gene decay in Shigella as an incipient stage of host-
adaptation. PLaS One, 6, e27754.

Fleischmann,R.D. et a]. (2002) Whole-Genome Comparison of Mycobacterium
tuberculosis Clinical and Laboratory Strains. J. Bacterial, 184, 5479—5490.

Foley,S.L. et a]. (2013) Salmonella pathogenicity and host adaptation in chicken-
associated serovars. Microbial. Mal. Biol Rev., 77, 582—607.

Goodhead,I. and Darby,A.C. (2015) Taking the pseudo out of pseudogenes. Curr.
Opin. Micrabial, 23C, 102—109.

Grimm,D.G. et a]. (2015) The evaluation of tools used to predict the impact of
missense variants is hindered by two types of circularity. Hum. Mutat, 36,
5 1 3—5 23 .

Harris,S.R. et a]. (2013) Whole-genome sequencing for analysis of an outbreak of
meticﬂlin—resistant Staphylococcus aureus: a descriptive study. Lancet In-
fect. Dis., 13, 130—136.

Holden,M.T.G. et a]. (2004) Complete genomes of two clinical Staphylococcus
aureus strains: evidence for the rapid evolution of Virulence and drug re-
sistance. Prac. Natl. Acad Sci. U. S. A., 101, 9786—9791.

Hottes,A.K. et a]. (2013) Bacterial adaptation through loss of ﬁinction. PLaS
Genet, 9, e1003617.

Jorth,P. et a]. (2015) Regional Isolation Drives Bacterial Diversiﬁcation within
Cystic Fibrosis Lungs. Cell Hast Micrabe, 18, 307—319.

Kanehisa,M. et a]. (2016) KEGG as a reference resource for gene and protein
annotation. Nucleic Acids Res., 44, D45 7—62.

Kingsley,R.A. et a]. (2013) Genome and transcriptome adaptation accompanying
emergence of the deﬁnitive type 2 host-restricted Salmonella enterica
serovar Typhimurium pathovar. MBia, 4, e005 65—13.

Klemm,E.J. et a]. (2016) Emergence of host-adapted Salmonella Enteritidis
through rapid evolution in an immunocompromised host. Nature Micrabi-
alagy, 1, 15023.

Koren,S. and Phillippy,A.M. (2015) One chromosome, one contig: complete mi-
crobial genomes from long-read sequencing and assembly. Curr. Opin. Mi-
crabial, 23C, 110—120.

Kryazhimskiy,S. and Plotkin,].B. (2008) The population genetics of dN/dS. PLaS
Genet.

Kumar,P. et a]. (2009) Predicting the effects of coding non-synonymous variants
on protein ﬁinction using the SIFT algorithm. Nat. Pratac., 4, 1073—1081.

Kuo,C.-H. and Ochman,H. (2010) The extinction dynamics of bacterial
pseudogenes. PLaS Genet, 6.

Langridge,G.C. et a]. (2015) Patterns of genome evolution that have accompanied
host adaptation in Salmonella. Prac. Natl. Acad Sci. U. S. A., 112, 863—
868.

Liu,M. et a]. (2015) HMMvar-ﬁinc: a new method for predicting the ﬁinctional
outcome of genetic variants. BMC Bioinformatics, 16, 351.

Loeb,D.D. et a]. (1989) Complete mutagenesis of the PHV-l protease. Nature, 340,
397—400.

Loman,N.J. et a]. (2012) High-throughput bacterial genome sequencing: an embar-
rassment of choice, a world of opportunity. Nat. Rev. Micrabial, 10, 5 99—
606.

Loman,N.J. and Pallen,M.J. (2015) Twenty years of bacterial genome sequencing.
Nat Rev. Micrabial, 13, 787—794.

Lowe,T.M. and Eddy,S.R. (1997) tRNAscan-SE: a program for improved detection
of transfer RNA genes in genomic sequence. Nucleic Acids Res., 25, 95 5—
964.

Markiewicz,P. et a]. (1994) Genetic studies of the lac repressor. XIV. Analysis of
4000 altered Escherichia coli lac repressors reveals essential and non-
essential residues, as well as‘ spacers’ which do not require a speciﬁc se-
quence. J. Mal. Biol, 240, 421—433.

Marks,D.S. et a]. (2012) Protein structure prediction from sequence variation. Nat
Biatechnal, 30, 1072—1080.

Marvig,R.L. et a]. (2015) Convergent evolution and adaptation of Pseudomonas
aeruginosa within patients with cystic ﬁbrosis. Nat. Genet, 47, 5 7—64.

McClelland,M. et a]. (2004) Comparison of genome degradation in Paratyphi A
and Typhi, human-restricted serovars of Salmonella enterica that cause ty-
phoid. Nat Genet, 36, 1268—1274.

McNally,A. et a]. (2016) ‘Add, stir and reduce’: Yersinia spp. as model bacteria for
pathogen evolution. Nat Rev. Micrabial, 14, 177—190.

Monk,J.M. et a]. (2013) Genome-scale metabolic reconstructions of multiple
Escherichia coli strains highlight strain-speciﬁc adaptations to nutritional
environments. Prac. Natl. Acad Sci. U. S. A., 110, 20338—20343.

Montvida, O and Klawonn, K. (2014) Relative cost curves: An alternative to AUC
and an extension to 3-class problems. Kybernetika, 50, 647-660.

Moran,N.A. (2002) Microbial minimalism: genome reduction in bacterial patho-
gens. Cell, 108, 583—586.

Moran,N.A. and Plague,G.R. (2004) Genomic changes following host restriction in
bacteria. Curr. Opin. Genet. Dev., 14, 627—633.

Mutrej a,A. et a]. (2011) Evidence for several waves of global transmission in the
seventh cholera pandemic. Nature, 477, 462—465.

Nozawa,M. et a]. (2009) Reliabilities of identifying positive selection by the
branch-site and the site-prediction methods. Prac. Natl. Acad Sci. U. S. A.,
106, 6700—6705.

Nuccio,S-P. and Baumler,A.J. (2014) Comparative analysis of Salmonella ge-
nomes identiﬁes a metabolic network for escalating growth in the inﬂamed
gut. MBia, 5, e00929—14.

Okoro,C.K. et a]. (2012) Intracontinental spread of human invasive Salmonella
Typhimurium pathovariants in sub-Saharan Africa. Nat. Genet, 44, 1215—
122 1 .

Okoro,C.K. et a]. (2015) Signatures of adaptation in human invasive Salmonella
Typhimurium ST313 populations from sub-Saharan Africa. PLaS Neg].
Trap. Dis., 9, e0003611.

Punta,M. et a]. (2012) The Pfam protein families database. Nucleic Acids Res., 40,
D290—301.

Rabsch,W. et a]. (2002) Salmonella enterica serotype Typhimurium and its host-
adapted variants. Infect. Immun., 70, 2249—2255.

Rennell,D. et a]. (1991) Systematic mutation of bacteriophage T4 lysozyme. J.
Mal. Biol, 222, 67—88.

Reuter,S. et a]. (2014) Parallel independent evolution of pathogenicity within the
genus Yersinia. Prac. Natl. Acad Sci. U. S. A., 111, 6768—6773.

Reva,B. et a]. (2011) Predicting the ﬁinctional impact of protein mutations: appli-
cation to cancer genomics. Nucleic Acids Res., 39, e118.

Rivera-Chavez,F. et a]. (2013) Salmonella uses energy taxis to beneﬁt from intesti-
nal inﬂammation. PLaS Pathag., 9, e1003267.

Rocha,E.P.C. et a]. (2006) Comparisons of dN/dS are time dependent for closely
related bacterial genomes. J. Theor. Biol, 239, 226—235.

Roumagnac,P. et a]. (2006) Evolutionary history of Salmonella typhi. Science, 314,
1301—1304.

Shihab,H.A. et a]. (2013) Predicting the ﬁinctional, molecular, and phenotypic
consequences of amino acid substitutions using hidden Markov models.
Hum. Mutat, 34, 57—65.

Singletary,L.A. et a]. (2016) Loss of Multicellular Behavior in Epidemic African
Nontyphoidal Salmonella enterica Serovar Typhimurium ST313 Strain
D23580. MBia, 7.

Sing,T. et a]. (2005) ROCR: Visualizing classiﬁer performance in R. Bioinformat-
ics, 21, 3940—3941.

Suzek,B.E. et a]. (2015) UniRef clusters: a comprehensive and scalable alternative
for improving sequence similarity searches. Bioinformatics, 31, 926—932.

Thomson,N.R. et a]. (2008) Comparative genome analysis of Salmonella Enter-
itidis PT4 and Salmonella Gallinarum 287/91 provides insights into evolu-
tionary and host adaptation pathways. Genome Res., 18, 1624—163 7.

Tian,W. and Skolnick,]. (2003) How well is enzyme ﬁinction conserved as a ﬁlm-
tion of pairwise sequence identity? J. Mal. Biol, 333, 863—882.

Viana,D. et a]. (2015) A single natural nucleotide mutation alters bacterial patho-
gen host tropism. Nat. Genet.

Yang and Bielawski (2000) Statistical methods for detecting molecular adaptation.
Trends Ecal Eval, 15, 496—503.

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

Yang,H. et a]. (2014) Genome-Scale Metabolic Network Validation of Shewanella
oneidensis Using Transposon Insertion Frequency Analysis. PLaS Camput.
Biol, 10, e1003848.

Yang,Z. (1997) PAML: a program package for phylogenetic analysis by maximum
likelihood. Camput. Appl Biasci., 13, 555—556.

Yue,M. et a]. (2015) Allelic variation contributes to bacterial host speciﬁcity. Nat
Cammun., 6, 8754.

112 /810's112umo[p101x0'sor112u1101urorq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 2:

