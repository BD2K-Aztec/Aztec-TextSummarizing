Bioinformatics Advance Access published August 27, 2016

Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw527

Advance Access Publication Date: 13 August 2016
Applications Note

 

 

Genome analysis

oxBS-MLE: an efficient method to estimate
5-methylcytosine and 5-hydroxymethylcytosine
in paired bisulfite and oxidative bisulfite

treated DNA

Zongli Xu1, Jack A. Taylor1'2, Yuet-Kin Leung3, Shuk-Mei Ho3 and

Liang Niu3'*

‘Epidemiology Branch, 2Epigenetic and Stem Cell Biology Laboratory, National Institute of Environmental Health
Sciences, NIH, Research Triangle Park, NC 27709, USA and 3Department of Environmental Health, College of

Medicine, University of Cincinnati, Cincinnati, OH 45267, USA

*To whom correspondence should be addressed
Associate Editor: Inanc Birol

Received on June 27, 2016; revised on August 4, 2016; accepted on August 8, 2016

Abstract

Motivation: 5-Methylcytosine (5mC) and 5-hydroxymethylcytosine (5th) are important epigen-
etic regulators of gene expression. 5mC and 5th levels can be computationally inferred at single
base resolution using sequencing or array data from paired DNA samples that have undergone
bisulfite and oxidative bisulfite conversion. Current estimation methods have been shown to pro-
duce irregular estimates of 5th level or are extremely computation intensive.

Results: We developed an efficient method oxBS-MLE based on binomial modeling of paired bisul-
fite and oxidative bisulfite data from sequencing or array analysis. Evaluation in several datasets

showed that it outperformed alternative methods in estimate accuracy and computation speed.
Availability and Implementation: oxBS-MLE is implemented in Bioconductor package ENmix.

Contact: niulg@ucmail.uc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

5-Methylcytosine (5mC) is an essential epigenetic mark that regu-
lates cell differentiation and gene expression. 5mC can be oxidized
to 5-hydroxymethylcytosine (5th) by activity of the ten-eleven
translocation (TET) enzyme (Ito et al., 2010; Tahiliani et al., 2009).
5th can function differently from 5mC in transcriptional control
and is prevalent in embryonic stems cells (Pastor et al., 2011; Song
et al., 2011). Thus, it is desirable to separately quantify 5mC and
5th levels at single base resolution.

Traditional bisulfite (BS) treatment commonly used in genome-
wide methylation studies cannot distinguish 5mC from 5th: both
are protected from conversion while unmodified cytosines are con-
verted to uracil (U). Selective oxidation of 5th to 5-formylcytosine
(5fC) can be achieved by treatment with potassium perruthenate

(KRuO4), and 5fC converts to U following bisulfite treatment (Booth
et al., 2012). 5th level can be estimated using paired experiments
on a DNA sample: bisulfite converted DNA can be used to estimate
the proportion of 5mC+5th and oxidative bisulfite (oxBS) con-
verted DNA can be used to estimate the proportion of 5mC.
Measurement can be done in a genome-wide manner using sequenc-
ing techniques, e.g. oxBS-seq (Booth et al., 2013); or for specific loci
using array techniques, e.g. oxBS-450K (Stewart et al., 2015) and
OxBS-array (Field et al., 2015).

5th level at each CpG site can be estimated by taking the dif-
ference between measurements made following BS and oxBS treat-
ments (Booth et al., 2013; Field et al., 2015; Stewart et al., 2015).
However, this na'1've approach frequently leads to negative estimates
of 5th due to measurement error, while true levels must always

Published by Oxford University Press 2016. This work is written by US Government employees and is in the public domain in the US. 1

9mg ‘09 isnﬁnV uo salaﬁuV sorl ‘eiulomeg JO AiiSJQAiu [1 112 ﬂJO'sleumo[pJOJXO'soneuuoguioiq/ﬁdnq moi; papeolumoq

Z.Xu et al.

 

be non-negative. To overcome the limitation, a statistical approach,
OxyBS (Houseman et al., 2016) was proposed to estimate 5th
and 5mC levels by assuming beta distributions for the two measure-
ments. A limitation of this approach is that it is too computationally
intensive for large studies.

Here we propose a computationally efficient method oxBS-MLE
(MLE stands for maximum likelihood estimate) to jointly estimate
5mC and 5th levels from the paired experimental data.
Evaluations in real datasets show that it outperforms OxyBS and the
naive method. oxBS-MLE has been implemented in the
Bioconductor package ENmix (Xu et al., 2016).

2 Methods

For each CpG site following either BS or oxBS treatment, the result-
ing measurements are proportions. If the measurement is obtained
by a sequencing technique, then the measurement is M/N, where M
is the number of reads with unconverted (i.e. methylated) cytosine
and N is the total number of reads containing the locus of interest. If
the measurement is obtained by an array technique, e.g. Illumina
Infinium HumanMethylation450 BeadChip or Infinium
MethylationEPIC BeadChip, then the measurement is called ‘beta
value’, and is calculated as M/(M+U+c), where M is the methy-
lated intensity, U is the unmethylated intensity and c (usually 2 100)
is a constant offset to prevent denominator from being zero. Notice
that the measurements obtained by array techniques will have the
same form as those obtained by sequencing techniques if we let
N = M + U+c.

Let Mk be the methylated signal and Nk be the total signal at a
DNA locus, where k 6 {BS, oxBS}. oxBS-MLE assumes that Mk fol-
lows a binomial distribution, i.e.,

MBS N B(NBs, 7r5mC + 7tslamc)

MoxBS N B(NoxBS: TCSmC)

Here 7t5mc (5mc level) and 73th (5th level) are between 0 and
1 and 7t5mc + 715th S 1. It can be proved that the MLE of (7t5mc,
73me) is (see Supplementary Material):

(MoxBS MBS _ MoxBS)_ 1. M33 > MoxBS
(A A ) NoxBS ’NBS NoxBS ’ NBS _ NoxBS
“5771C, 7.55th =
M + M .
(M, ); otherwzse
NoxBS + NBS

oxBS-MLE is implemented in ENmix as a function oxBS.MLE. It
takes four matrices as input: a matrix of BS measurements
(MES/NBS), a matrix of oxBS measurements (Most/Noxgs), a ma-
trix of BS total signal (N33) and a matrix of oxBS total signal
(Noxgs). In each matrix, the rows are corresponding to CpG loci
and the columns are corresponding to samples. oxBS.MLE outputs
the (ﬁ5mc,’7f5hmc) defined as above.

3 Results

To evaluate oxBS-MLE and compare it with alternative methods,
we applied the oxBS-MLE, OxyBS and the naive subtraction method
to the methylation 450k array data (GEO accession number
GSE63179) from (Field et al., 2015 ), which have undergone the cor-
rection for Infinium I and II probe design bias using Subset-quantile
With Array Normalization (SWAN) by Field et al. (2015 ). The data
consist of eight arrays for four replicates of a single cerebellum

sample (two arrays, BS or oxBS treated, for each replicate). The
qPCR measurements of 5th level for 27 CpG sites on the array
were also available (Field et al., 2015 ) and thus can be used as gold
standard to evaluate the accuracy of the 5th estimates from array
data with different methods.

Evaluations showed that methods oxBS-MLE and OxyBS pro-
vided almost identical 5th estimates with maximum absolute dif-
ference of 0.005 across all CpG sites and all four replicates, while
the naive method produced a significant portion of negative 5th
estimates (12—38.4% in each replicate). To evaluate the accuracy of
5th estimates, we first averaged the four replicate estimates with
each method at the 27 CpG sites and then calculated the absolute
difference between the averages and the corresponding qPCR meas-
urements. The results showed that oxBS-MLE and OxyBS estimates
are almost identical and both outperformed the naive method
(Student paired t-test P < 0.025 for either comparisons).

Method oxBS-MLE and OxyBS also produced similar estimates
of 5mC at majority of the CpG sites with only 0.039% of the esti-
mates having absolute difference greater than 0.01 between the two
methods. However, when the beta value from BS experiment is
smaller than that from the corresponding oxBS experiment, oxBS-
MLE and OxyBS tend to produce different 5mC estimates with
maximum difference of 0.28 in the evaluation. Especially when BS
measurement is very small, OxyBS method can result in irrational
estimates of 0 no matter what the oxBS measurement is
(Supplementary Table S1). We observed the similar phenomenon in
other datasets (data not shown). We also noticed that for most CpG
sites (71.4%, 286 752 out of 401 866) the oxBS-MLE estimates of
5mC are closer to the measurements from oxBS experiment (oxida-
tive bisulfite experiments aim to measure 5mC level) than the
OxyBS estimates; the percentage of such CpG sites in Infinium I
probes (69.9%) is similar to that in Infinium II probes (72.0%).

We note that oxBS-MLE is ~5000 times faster than OxyBS
when both methods were applied to the above GEO data (0.7 second
versus 62 minutes for eight arrays on a machine with 2.6GHz CPU).
This is because that OxyBS uses an iterative method to find MLE
while oxBS-MLE calculates MLE using an explicit analytical form.
The computation in the method OxyBS is done sample by sample,
and thus the computing time will increase linearly with sample size.
The computing time for 1000 samples (2000 arrays) is expected to
be ~25 7 h for OxyBS while oxBS-MLE takes only <3 minutes. It is
easy to see that the oxBS-MLE method assumption is even more
suitable for sequencing data. However, we were not able to find
oxBS sequencing data with additional qPCR/pyrosequencing valid-
ation. In summary, oxBS-MLE is an efficient and accurate method
to jointly estimate 5mC and 5th levels in paired BS- and oxBS-
treated experiments.

Funding

This research was supported by the Center for Environmental Genetics grant
(NIEHS award P30ESOO606), NIEHS grant (E5022071), and Intramural
Research Program of the NIH (NIEHS ZOl ESO49033 and 201 ESO49032).

Conﬂict of Interest: none declared.

References

Booth,M.J. et al. (2012) Quantitative sequencing of 5-methylcytosine and
5 -hydroxymethylcytosine at single-base resolution. Science, 336, 934—937.
Booth,M.J. et al. (2013) Oxidative bisulﬁte sequencing of 5-methylcytosine

and 5-hydroxymethylcytosine. Nat. Protoc., 8, 1841—1851.

9mg ‘09 isnﬁnV uo salaﬁuV soq ‘eiulomeg JO AiiSJQAiu [1 112 /810'S{12umo[pJOJXO'soiiemJOJuioiw/zdnq moi; papeolumoq

oxBS-MLE

 

Field,S.F. et al. (2015) Accurate measurement of 5 -methylcytosine and
5 -hydroxymethylcytosine in human cerebellum DNA by oxidative bisulﬁte
on an array (OxBS-array). PLoS One, 10, e0118202.

Houseman,E.A. et al. (2016) OxyBS: estimation of 5 -methylcytosine and
5 -hydroxymethylcytosine from tandem-treated oxidative bisulﬁte and bisul-
ﬁte DNA. Bioinformatics, 32, 2505—2507.

Ito,S. et al. (2010) Role of Tet proteins in 5mC to 5th conversion, ES-cell
self-renewal and inner cell mass speciﬁcation. Nature, 466, 1129—1 133.

Pastor,W.A. et al. (2011) Genome-wide mapping of 5 -hydroxymethylcytosine
in embryonic stem cells. Nature, 473, 394—397.

Song,C.X. et al. (2011) Selective chemical labeling reveals the genome-wide
distribution of 5 -hydroxymethylcytosine. Nat. Biotechnol., 29, 6 8—72.

Stewart,S.K. et al. (2015 ) oxBS-450K: a method for analysing hydroxymethy-
lation using 450K BeadChips. Methods, 72, 9—15.

Tahiliani,M. et al. (2009) Conversion of 5-methylcytosine to 5-hydroxyme-
thylcytosine in mammalian DNA by MLL partner TET1. Science, 324,
930—935.

Xu,Z. et al. (2016) ENmix: a novel background correction method
for Illumina HumanMethylation450 BeadChip. Nucleic Acids Res.,
44, e20.

9mg ‘09 1sn8nV uo salaﬁuV soq ‘121u101n123 10 A1is19Aiu [1 112 /810'S{12umo[pJOJXO'soneIIJJOJHioiq/ﬁd11q 111011 papeolumoq

