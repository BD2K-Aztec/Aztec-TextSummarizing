Bioinformatics Advance Access published August 24, 2016

 

Sequence Analysis

Assembly-based inference of B-cell receptor reper-
toires from short read RNA sequencing data with

V'DJer

Lisle E. Mosel, Sara R. Selitskyl, Lisa M. Bibel’z, David L. Marronl, Michael D.

Iglesia3, Jonathan S. Serody1’2’4, Charles M. Peroul’s, Benjamin G. Vincent1’2’*’#,

Joel S. Parker1’6’*’#

1Lineberger Comprehensive Cancer Center, 2Division of Hematology/Oncology, Department of Internal Medi-
cine, 3Curriculum in Genetics and Molecular Biology, 4Department of Microbiology/Immunology,
5Departments of Genetics and Pathology and Laboratory Medicine, 6Departments of Genetics, University of
North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA

*To whom correspondence should be addressed.

#These authors contributed equally to this manuscript.

Associate Editor: Prof. Bonnie Berger

Abstract

Motivation: B-cell receptor repertoire profiling is an important tool for understanding the biology of
diverse immunologic processes. Current methods for analyzing adaptive immune receptor reper-
toires depend upon PCR amplification of VDJ rearrangements followed by long read amplicon se-
quencing spanning the VDJ junctions. While this approach has proven to be effective, it is frequently
not feasible clue to cost or limited sample material. Additionally, there are many existing datasets
where short-read RNA sequencing data are available but PCR amplified BCR data are not.

Results: We present here V'DJer, an assembly-based method that reconstructs adaptive immune
receptor repertoires from short-read RNA sequencing data. This method captures expressed B-cell
receptor loci from a standard RNA-seq assay. We applied this method to 473 Melanoma samples
from The Cancer Genome Atlas and demonstrate V'DJer's ability to accurately reconstruct B—cell re-
ceptor repertoires from short read mRNA—seq data.

Availability: V'DJer is implemented in C/C++, freely available for academic use and can be down-
loaded from Github: https://github.com/mozack/vdjer

Contact: @rkeris@email.unc.edu, beniamin vincent@med.unc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

T-cells and B-cells compose the adaptive immune system and bear
highly speciﬁc cell surface receptors that allow them to recognize anti-
genic targets. Massive diversity at the adaptive immune receptor loci is
generated by the process of V-J and V-D-J recombination during cell
development, with a theoretical number of unique receptors for each
class estimated at greater than 1015 and lower bounds for circulating
lymphocytes measured at greater than 106 (Arstila et al.,1999; Warren et

© The Author(s) 2016. Published by Oxford University Press.

al., 2011; Boyd et al., 2009). This extraordinary diversity is achieved
through recombination of V, D and J segments, insertions and deletions
at junction points, as well as somatic hypermutation in the case of B-cell
receptors (BCR) (Supplemental Figure 1). This diversity of targeting
receptors is crucial for immune defense against infectious pathogens and
has implications for understanding autoimmunity, immunodeﬁciency
syndromes, and the anti-tumor immune response to malignant diseases.
Adaptive immune receptor repertoire analysis was initially performed
by evaluating differences in sequence length of the primary antigen
binding region, a process known as spectratyping (Pannetier et al., 1995),

This is an Open Access article distributed under the terms of the Creative Commons Attribution License
(hgpzllcreativecommonscrgzlicenses/by/4.0/ ), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the

original work is properly cited.

112 /810'spaumo[pJOJXO'soneuJJOJurorq//:d11q IIIOJJ popcorn/hog

910K ‘09 isnﬁnV uo :2

 

3) Variable region sequence for
heavy (IgH) and light (IgKllgL)
chains are assembled

\.  __

Light chain

Heavy chain

  

b) A portion of the heavy /

chain constant region is
captu red, allowing for
isotype identiﬁcation.

 

c) Clonal abundance
is measured using
reads mapped to
assembled clones.

 

 

d) Clonal reconstruction at nucleotide resolution allows for analysis
of somatic hypermutation

Germline: . . .ATCAAGCACACTATTGCACGACGA. . .
V'DJer clone: . . .ATCATCCACACTATGGCTCGACGA. . .

Fig. 1. V’DJer features. (a) BCR light and heavy chains can be assembled from a single
assay. (b) The isotype of an assembled heavy chain can be identiﬁed using the assembled
constant region sequence. (c) Relative clone abundance can be accurately measured using
reads mapped to assembled clones. ((1) Nucleotide resolution assembly provides the
ability to perform mutation speciﬁc analyses including somatic hypermutation assessment
and clonal diversity of the sample.

where the presence of a skewed length distribution would be interpreted
as evidence of clonal restriction (i.e. low repertoire diversity). Following
this, techniques were developed for single-cell sorting, PCR ampliﬁca-
tion, and Sanger sequencing of B-cell receptor loci (Hunsucker et al.,
2015; Tiller et al., 2009). Next-generation sequencing has allowed for
analysis of bulk repertoires also by sequencing PCR amplicons (Arstila
et al.,1999; Warren et al., 2011; Boyd et al., 2009; Vincent et al., 2016).
For each of these techniques, amplicons and resultant sequence reads
span full V-D-J rearrangements with presumed one read to one sequence
mapping. Constraints of this general approach include high costs, the
possibility of primer annealing and ampliﬁcation bias, and the inability
to analyze multiple loci in parallel should sample nucleic acid template
amounts be limiting.

Our group and others have shown that B-cell lineage gene expression
signatures are strongly prognostic in multiple solid tumor types (Iglesia
et al., 2014; Gentles et al., 2015). In order to proﬁle all B-cell receptor
loci in a single experiment, as well as to analyze adaptive immune recep-
tor repertoires ﬁom large publicly-available RNA sequencing datasets
such as those generated by The Cancer Genome Atlas (TCGA), we have
developed V'DJer (ve-jur), an assembly-based approach to reconstruc-
tion and relative quantitation of immunoglobulin heavy-chain (IgH),
kappa light-chain (IgK), and lambda light-chain (IgL) sequences from
short read mRNA-Seq data with read lengths of 48bp or longer. V’DJ er
allows for full inference of repertoire characteristics including variable
and joining gene segment usage, population diversity, sequence sharing
between populations, antigen binding region amino acid properties and
motifs, clonal structure, and somatic hypermutation in B-cell receptor
repertoires (Figure 1).

_’4._

WDIJ kmer

non IG genomic locations

unmapped reads —>'| '4— _]:|_

 

Read Extraction

 

 

 

 

Graph Construction
aware

("I 3T fry: C rs. ‘3 Graph Traversal

s - g -
- o . . g e - n — . o.

 

 

 

 

 

 

 

V Anchor Cys Trp J Anchor 5--
lr

ATCACAGCC .I‘x'I‘TC :‘LCGCACTGCGAMCACTCTGG E‘ﬂTC  ."~.(T..-‘~.CATTCBC

 

Contig Evaluation
 Else   

 

 

 

Missing J Anchor _|:L

 

ﬂ b

ﬂ
ATCACAG C'L'fx 37‘ C EC CCRCTGCGmCACTcTGG 1' :3 '1‘C.3.‘C:,"-.G.:it_'ﬁmnc

Read Mapping

JZL

Contigs

Fig. 2. V’DJer workﬂow. V'DJer accepts a mapped mRNA-seq BAM ﬁle as input.
Reads mapping to or having homology with lg chain speciﬁc loci or sequence are extract-
ed along with all unmapped reads and are used to construct a deBruijn graph. The graph
is traversed producing putative contigs which are ﬁltered based upon the presence of
sequence having homology with anchors arising from germline V and J segments as well
as conserved amino acids and read coverage. The ﬁnal set of assembled contigs spanning
most of the V(D)J region and a portion of the constant region is output along with a SAM
ﬁle of reads mapped to the assembled contigs.

 

 

 

 

 

 

 

2 Method

V’DJer accepts a BAM ﬁle of mapped mRNA-seq short reads as input.
V’Djer then performs:

(1) Read extraction to isolate reads that may have arisen from a
BCR.

(2) de Brujin graph construction ﬁom candidate reads.
(3) Graph traversal using BCR speciﬁc heuristics.

(4) Mapping of reads to and evaluation of candidate BCR sequenc-
es.

V’DJer outputs a fasta ﬁle containing BCR contigs and a SAM ﬁle con-
taining reads mapped to those contigs (Figure 2). This output is suitable
for use with downstream quantiﬁcation tools such as RSEM (Li et al.,
201 1).

2.1 Read Extraction

V'DJ er extracts reads from a STAR aligned BAM (Supplemental Note 1)
as follows:

(1) Reads mapping to any functional locus speciﬁc to the IG chain
of interest are extracted

112 [310'8112(Ian[plOJXO'SODBIILIOJHlOlQ/[ldlflq IIIOJJ pepeorumoq

910K ‘09 isnﬁnV uo :2

a Sensitivity b Abundance Estimation

 

 

 

   

 

 

 

 

 

   

 

 

 

 

 

 

g r
g ,_ ‘ —
" - 8 3.41.995 "—
a 3  ‘” ‘
Cl
IE 8 ‘5 8 ' 4—
._ D
E a as
w s ,2; § -
D
a N — ii
— $
‘3 ° r l l 1 1
25 50 100 250 500 25 50 100 250 500
Simulated Depth Simulated Depth
0 Cl
Specificity Trinity Comparison
|D
a! _ a =
° e1 MiSeq Validated .. — 5 Trinity
9 I Not Validated El V'DJer
0! — 8 _
.2 ° .5 "
'3 *2 - 5 8 -
E 5 :3
.._ _ O _
3 o 3 ‘°
In F. - .5
§ ° :2 w
a: u, g _.
3 ‘ a -
8 - o — —'
0
Sample 1 Sample 2 Sample 3

V‘DJer BCR Contig

Fig. 3. Performance Characteristics. (a) Evaluation of ability to detect simulated IgH
sequences by depth of sequencing. (b) Quantification results from simulated data show
that relative abundance measured by RSEM for clones of varying depths closely matches
expectation. (c) Assembled contigs validated by MiSeq sequencing sorted by relative
abundance. All contigs comprising at least 1% of the IgH repertoire for a given sample
are shown. ((1) Assembled IgH contigs validated by MiSeq sequencing for Trinity and
V'DJ er.

(2) Mapped reads containing a 15-mer in common with the IG
chain’s functional germline V, D or J segments are extracted.

(3) All unmapped reads are extracted.

In all cases, a read is always extracted along with its paired read.

2.2 Graph Construction

V'DJer constructs a deBruijn graph (Pevzner et al., 2001) from the ex-
tracted reads using a modiﬁed version of the assembler developed for
ABRA (Mose et a1. 2014). A preliminary version of the graph is con-
structed utilizing reads and base quality scores. Each vertex in the graph
represents a kmer along with the sum of base qualities for each base in
that kmer. Vertices containing kmers that do not reach a minimum con-
ﬁgurable number of observations in the reads are removed from the
graph. Those vertices that do not reach a conﬁgurable minimum base
quality sum threshold at any position within the kmer are also removed.
Additionally, vertices not supported by more than one distinct read are
pruned. Linear paths through the graph (vertices containing a single
incoming and outgoing edge) are then condensed into a single vertex.

2.3 Graph Traversal

Vertices containing 0 incoming edges are identiﬁed as candidate source
vertices. These vertices are assigned a homology score with the IG
chain’s variable germline segments using an initial hash table lookup and
subsequent scoring via dynamic programming. Those vertices meeting a
minimum homology score are used as source vertices for graph traversal.
During traversal of the graph, a path score is calculated for each path
through the graph as the product of all edge ratios thus far traversed.
The edge ratio is the frequency for a given outgoing edge divided by the
frequency of all outgoing edges for the same vertex (an edge ratio for a

single outgoing edge is one). Traversal of a path through the graph
continues until one of three conditions is met:

(1) A vertex with no outgoing edges is reached.
(2) A conﬁgurable maximum contig length is exceeded.

(3) The path score drops below a conﬁgurable threshold.

Candidate contigs are generated ﬁom paths reaching an appropriate
length. The Samtools API (Li et al., 2009) is used to extract reads from
the input BAM.

2.4 Contig Evaluation

Contigs are initially ﬁltered by searching for evidence of CDR3 se-
quence. Sixteen base long anchors are extracted from near the 3’ end of
germline V segments and 5’ end of J segments. Candidate contigs are
searched for sequence showing homology to at least one V and one J
anchor (maximum of 4 mismatches). If the V and J anchors are within a
reasonable distance of one another, the contig is searched for amino
acids known to be highly conserved in CDR3. Cysteine is required to
appear on the 5’ end of the CDR3 region while Tryptophan (IgH) or
Phenylalanine (IgK/IgL) must appear on the 3’ end. These amino acids
must be in frame and within expected CDR3 length distance ﬁom one
another. If a contig passes these initial CDR3 identiﬁcation criteria, the
originally extracted reads are mapped to the contig using a hashing ap-
proach. All reads are stored in a hash table and the contig is examined
ﬁom beginning to end looking for perfect read matches. If both mem-
bers of a read pair map to a contig in the correct orientation and within a
reasonable insert length, they are considered mapped. While computa-
tionally efﬁcient, this approach does not currently allow for sequencing
errors. The relatively exhaustive graph traversal that V’DJer employs
would ordinarily result in a potentially high number of false positive
paths through the graph. To resolve this, candidate contigs are required
to have sufﬁcient read depth and complexity of coverage to pass the
evaluation step. Those contigs that do pass are output along with read
alignments to those contigs.

2.5 Post Processing

The V'DJer output is a fasta ﬁle containing assembled contigs spanning
most of the V(D)J region as well as a portion of the constant region
(default total contig length is 360 bases). Additionally, a SAM ﬁle con-
taining reads aligned to the assembled contigs is output. We use RSEM
to quantify the assembled transcripts. VQuest is used to gather addition-
al information about the assembled contigs including V and J segment
identiﬁcation as well as V region identity which we use as a proxy for
mutational load. BCR isotypes are identiﬁed by mapping the trailing 48
bases of each contig (constant region sequence) to hg38 using STAR and
identifying the constant region segment using the resultant coordinates.
Contigs sharing an identical CDR3 (amino acids), V gene segment, J
gene segment and isotype are clustered for downstream analysis.

3 Results

3.1 Simulation Results

We initially tested V’DJer’s ability to accurately assemble BCR V(D)J
sequences by analyzing simulated repertoires of IgH clonotypes (unique

112 /810'$112umo[p101x0'sor112u1101u101q/ﬁd11q 111011 popcorn/hog

910K ‘09 isnﬁnV uo 2:

 

a IgH Abundance by Sample [3

 

Heavy/Light Chain Abundance c

Estimated Clones per Sample

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

g _
a u, _ In — A0349
"' o
3 g a
g .. _ a .. _
1: 3
5 g a E
O .
h c on. -1' a: g “
g o $0 0
S m ‘- g ('3 "i a a
5 3 § 3‘ °
0 I B, y
1- ° °o-6 0.90 0 ca _
013 N
or — N _ 0’ o
I o
O
a _
| l I l i l l l l l I l l l
40 45 50 55 60 6.5 70 25 so 35 4.0 45 5.0 55 1-4 5-20 21-50 51—100 100+
IgH Constant Read Counts - logio Light Chain Counts (IgK+IgL] - logic it Clones
d e f
CDR3 Lengths (Nucleotides) lsotype by Estimated Clones Heavy Chain Mutational Load by lsotype
1' - q- .—
l IgH
I ng
I IgL
6‘! - 99 a...
E S
S 3
2 “' 2 “"
a I I  a
It at:
.. - l I ll ll .. - [-
SEEBSEBSQE’SEESESBEBEEEEEBS lg! no me IgM 0 5 1o 15 20
CDR3 Lengths lsotype V Region Mutational Load (‘13)

Fig. 4. TCGA Melanoma Results. (a) Total V'DJer abundance measured against reads mapped to IgH constant regions. (b) V'DJ er heavy chain abundance is associated with V'Djer
light chain abundance. (c) Number of assembled clones per sample. ((1) CDR3 length distributions for all assembled contigs (inclusive of conserved Cys and Trp/Phe). (e) Relative

abundance of isotype assignments. (t) lsotype speciﬁc mutational loads.

sequence arising ﬁom VDJ recombination and somatic hypermutation)
from which short paired reads were generated at average depths varying
from 25x to 500x. When run in standard mode, V'DJer achieved greater
than 90% sensitivity at an average clonotype depth of 50x or greater with
zero false positives (Figure 3a). Running V'DJer with more sensitive
settings resulted in sensitivity approaching 90% at average clonotype
depth of 25x or greater at the expense of increased computational costs
(50-1200% increase in runtimes and 0-1000% increase in RAM depend-
ing upon clonotype homology, diversity, and abundance) . More sensi-
tive detection is achieved by utilizing a smaller k-mer size, more exhaus-
tive graph traversal, and less aggressive graph pruning and contig ﬁlter-
ing (Supplemental Note 2). The relative abundance of V'DJer called
BCR sequences was then estimated by RSEM (Li et al., 2011). The
resulting count estimates were in high agreement with the simulated
clonotype depths (r2=.995) (Figure 3b). Finally, we simulated all IgH
V/J combinations at average depth of 50x to test for bias in assembling
across V and J gene segment usage. 10 clonotypes were simulated for
each V/J combination. We found minimal differences in BCR assembly
sensitivity dependent on V and J usage pairing (Supplemental ﬁgure 2).
For the majority of combinations (1015 of 1410), 100% of simulated
clonotypes were detected, and for all combinations at least 70% of simu-
lated clonotypes were detected (Supplemental table 1).

3.2 Long Read Validation

We further assessed V'DJer’s performance by comparing to targeted IgH
amplicon sequencing of breast cancer derived RNA samples. MiSeq
2x250 paired end sequencing was used for this comparison with primers
originating ﬁom framework region 2 of various IgH variable (V) gene

segments as well as a joining (J) gene segment used in the IgH repertoire
ampliﬁcations (Suplemental Note 3). In parallel with IgH amplicon
sequencing, V’Djer was run on 2x50 paired-end bulk mRNA sequencing
data ﬁom the same samples. For this evaluation, assembled contigs
encompassing at least 1 merged MiSeq read were considered validated.
Of those V'DJer assembled contigs comprising at least 1% of the IgH
repertoire as computed by RSEM, 85.5% were validated by the MiSeq
sequencing (Figure 30). When allowing up to 2 mismatches against the
MiSeq contigs, the validation rate increased to 91.3%. The 15 most
abundant contigs across all 3 samples were all validated as well as 31 of
the 32 most abundant contigs. The possibility should be noted that pri-
mer bias may cause the MiSeq protocol to not sample transcripts that do
not contain sequence matching the primer annealing sites, which sug-
gests that some portion of the unvalidated contigs may not necessarily be
false positives. We expect the MiSeq protocol to be more sensitive than
V'DJ er for those sequences that do match the primer annealing sites due
to depth of sequencing as well as the need for a minimum read depth and
complexity in the V'DJ er assembly approach. However, due to possible
issues in primer bias as well as issues with accuracy of abundance in the
MiSeq protocol due to PCR ampliﬁcation, an unbiased comparison of
sensitivity between the two methods is not feasible. V'DJer's detection
ability is limited to the more abundant portions of the BCR repertoire.

3.3 Trinity Comparison

The Trinity assembler (Grabherr et al., 2011) has been previously used to
infer the BCR sequence of an expected single dominant clonotype. For
example, Blachly et al. used Trinity to reconstruct dominant IgH clono-
type sequences in chronic lymphocytic leukemia (Blachly et al., 2015).

112 /810'$112umo[p101x0'sor112u1101u101q/ﬁd11q 111011 popcorumoq

910K ‘09 isnﬁnV uo 2:

a Low Evannass Example

.-.
-:.-' 
_ I, E"? "g ‘
r. ‘to o
- F. .l'la
J“; , '.
O I. P .9 . .
. ‘. e ..
.
a r
1

High Evennass Example

 

 

 

 

 

 

 

 

 

 

  
    

 

 

 

 

 

b TCGA Melanoma Patient Survival by BCR Abundance and Diversity
3 n — High Count, Low Evenness
— High Count, High Evenness
— Law Count
0)
o. _
cq _ p-0.0004838
O
P:
E r-
2 o' ‘
2
[L
“>’ <0. _
E o
3
co
m _
:5
V
o. _
('0
o. _
i 1 l 1 'l
0 2 4 6 8 10

Time (years)

Fig. 5. Impact of BCR Abundance and Diversity on Survival. (a) Examples of low
evenness and high evenness in clone abundance. Larger nodes indicate higher clone
abundance. Edges were drawn if Hamming distance is <30% between two sequences. (b)
Kaplan-Meier survival curves for the TCGA SKCM cohort stratiﬁed by BCR abundance
(high: count > 1,000, low: count <=1,000) and clone evenness (high: >0.8, low: <=0.8)
into three groups: low abundance, high abundance / high evenness, and high abundance /
low evenness.

To compare the performance of V’Djer with Trinity, we applied Trinity
to the same 3 short read mRNA-Seq datasets that were used for MiSeq
validation. Across the 3 samples, V’DJer assembled roughly an order of
magnitude more MiSeq validated IgH contigs than Trinity (Figure 3d).
Further, peak RAM usage for Trinity exceeded 200GB across all 3 sam-
ples, while peak RAM usage for V’DJ er was less than 60GB.

3.4 TCGA Melanoma Results

We applied V’DJ er to 473 Melanoma samples ﬁom The Cancer Genome
Atlas (TCGA) (Cancer Genome Atlas Network, 2015), followed by
RSEM for clonotype quantiﬁcation and VQuest (Giudicelli et a1. 2004)
for identiﬁcation of variable (V), diverse (D), and joining (J) gene usage.
Predictions were made in 73.2%, 73.6% and 70.0% of IgH, IgK and IgL
samples respectively with ability to predict generally driven by BCR
abundance. Constant regions are joined to the variable (VDJ) region to
produce valid BCRs, thus relative abundance of the IgH constant region
serves as a control for the BCR sequence abundances output by V’DJ er.
Quantiﬁed V’DJ er IgH fragment counts calculated by RSEM were
strongly associated with IgH constant region counts (r2=0.851) (Figure
4a). This result provides evidence for the breadth of the repertoire that is
captured by V’Djer. Heavy and light chain fragment counts were also
highly associated (r2=0.949) (Figure 4b). For those samples with predic-
tions, an average of 35 clonotypes were identiﬁed (Figure 4c). CDR3
lengths (Figure 4d) were in line with previously observed distributions
(IgH CDR3 length predominantly 27 — 87 nucleotides, IgK CDR3 length
24 — 33 nucleotides, IgL CDR3 length 27 — 39 nucleotides) (Larimore et
a1. 2012; Meffre et al., 2001). When analyzing isotypes, we observed an

order of magnitude more IgG clonotypes than any other isotype (Figure
4e), with IgA and IgM the next most frequent. A very small number of
IgD clonotypes were identiﬁed and no IgE clonotypes were assembled.
As expected, we observed increased incidence of somatic hypermutation
in IgG and IgA clonotypes compared to IgM (P=1.07 x 10-53) (Figure
4f). No individual V gene / J gene pairing among dominant clonotypes
is enriched beyond expectation given individual V gene and J gene
counts (Fisher’s Exact p=0.253). (Supplemental Figure 3).
Measurements of diversity can include assessments of richness (the
number of distinct members of the repertoire) and evenness (variance of
abundance of clonotypes within the repertoire). Here, we use Pielou's
evenness index as a measure of BCR repertoire diversity within each
sample calculated as the Shannon entropy divided by the log of the num-
ber of clonotypes.

 

E venness =
log(clonotypes)

This measure of diversity serves as an indicator of possible clonal se-
lection and expansion. A sample with a single or small number of clono-
types expressed at levels much higher than other clonotypes in the sam-
ple would be considered to have low evenness, while a sample with
clones of similar abundance would have high evenness (Figure 5a). We
assessed the impact of BCR abundance and repertoire diversity on mela-
noma patient survival. We stratiﬁed samples into groups of low abun-
dance and high abundance with the high abundance group further strati-
ﬁed by low evenness and high evenness. While increased abundance
had a positive impact on outcomes, the group with high abundance and
low evenness showed the best survival. The 5 year survival rates were
50.4%, 66.7% and 80.8% for the low abundance, high abundance / high
evenness and high abundance / low evenness groups respectively (Figure
5b). This ﬁnding is consistent with the hypothesis that a selected antigen
driven B-cell response against the tumor is present in the tumor immune
microenvironment. By comparison, BCR diversity in TCGA Bladder
samples was not shown to be a prognostic indicator of patient survival
(Kardos et a1. 2016).

Mean V'DJ er run time for the 473 sample TCGA Melanoma cohort on
the IgH chain was < 3 hours running on 8 core servers while mean peak
RAM usage was < 12GB. Samples containing high BCR abundance and
diversity used considerably more compute time and RAM, in some cases
more than a day of processing and > 32GB of RAM.

4 Discussion

We present here the V'DJer, software for inference of B-cell receptor
repertoires using short-read RNA sequencing data. A major advantage
of this approach is the capacity to capture expressed B-cell receptor loci
in a standard RNA-seq assay. This is especially important in application
to clinical samples where nucleic acid template may be limiting. In
contrast to assays that depend on PCR ampliﬁcation, V'DJer is not lim-
ited to evaluating only those sequences that can be successfully primed.
V'DJ er does not require FACS sorting of B-cells prior to analysis; rather
it performs well when analyzing complex RNA template mixtures de-
rived from the bulk tumor immune microenvironment.

Application of V'DJ er is primarily limited by read coverage of the
clones of interest. In the setting of high coverage, assembly sensitivity
and speciﬁcity are high as well, however in areas of low coverage sensi-
tivity lessens. Thus in the context of a tumor immune inﬁltrate, V'DJer
is best suited for reconstruction of dominant and subdominant clones.
The algorithm allows for wide latitude in choosing parameters for opti-

‘Edonotypeproportion*109(Clon0typeproportion) (1)

112 /810'sp2umo[p101x0'soi112u1101uioiq/ﬁd11q 111011 popcorumoq

9IOZ ‘09 isnﬁnV uo 2:

 

mal performance given the expected coverage in the sample, however
there is a lower bound on coverage for recovering a given clonotype in
the assembly. Functional B-cell receptors are protein multimers, com-
prising heavy chain and kappa or lambda light chain pairing. Recently
multiple methods have been developed to capture paired heavy/light
chain information (or paired alpha/beta chains in the context of T-cell
receptor repertoires) (Howie et al., 2015; DeKosky et al., 2014). V'DJ er
does not attempt this pairing.

Other assembly-based methods have been used to analyze adaptive
immune receptor repertoires. The ﬁrst of these was iSSAKE developed,
which assembled short read mRNA-seq data derived from sequencing 5’
RACE products to reconstruct TCRB repertoires (Warren et a1. 2009).
This method has not to our knowledge been applied to B-cell receptor
loci. A second method used the Trinity assembly algorithm to recon-
struct dominant IgH sequences and analyze somatic hypermutation of
their variable regions in chronic lymphocytic leukemia samples (Blachly
et al., 2015). V'DJ er showed superior performance to this method in the
context of bulk RNA-seq data including reads from a diverse underlying
BCR repertoire. Additionally, other tools have been developed to per-
form a selective local assembly based upon k-mer or read extraction.
For example, a method used for CRISPR detection in bacteria and ar-
chaea identiﬁes and clusters frequently occurring k-mers for assembly
(Ben-Bassat and Chor, 2016).

Adaptive immune receptor repertoire proﬁling in general is an im-
portant analytical tool for translational cancer biology. Our group and
others have shown that B-cell lineage gene expression signatures are
strongly prognostic in multiple solid tumor types (Gentles et al., 2014).
B-cell receptor variable region mutation rate is prognostic in chronic
lymphocytic leukemia (Hamblin et al., 1999), and adaptive immune
receptor repertoire proﬁling provides the most sensitive method of de-
tecting minimal residual disease in B-cell leukemias (Logan et al., 2014).
Applied to a large melanoma mRNA-seq dataset, V’DJer allowed dis-
covery of prognostic information in tumor-inﬁltrating BCR repertoire
diversity over and above BCR expression alone. Given the huge clinical
interest in this immunotherapy approach and limited material of many
pre-treatment tumor biopsy samples, V'DJ er will be critical for adaptive
immune receptor analysis for understanding response to immunotherapy
and developing biomarkers to guide treatment decisions.

Funding

This study was supported by ﬁnds from the following sources: U24-CA143848-06
(TCGA), NCI Breast SPORE program (P5 0-CA58223-09A1), ROI-CA195740-01,
the Breast Cancer Research Foundation, UNC University Cancer Research Fund,
the UNC Oncology Clinical Translational Research Training Program
(5K12CA120780), and the William Guy Forbeck Research Foundation Collabora-
tive Research Grant. The ﬁlIldCI'S had no role in study design, data collection and

analysis, decision to publish, or preparation of the manuscript

Conﬂict of Interest: none declared.

References

Arstila T.P. et a1. (1999) A direct estimate of the human alphabeta T cell receptor
diversity. Science 286, 958-961.

Ben-Bassat I. & Chor B. (2016) CRISPR Detection From Short Reads Using Par-
tial Overlap Graphs. Journal of Comp. Bio. 23, 461-471.

Blachly J .S. et a1. (2015) Immunoglobulin transcript sequence and somatic hyper-
mutation computation from unselected RNA-seq reads in chronic lymphocytic
leukemia. Proc. Natl. Acad. Sci. USA 112, 4322-4327.

Boyd S.D. et a1. (2009) Measurement and clinical monitoring of human lympho-
cyte clonality by massively parallel VDJ pyrosequencing. Sci. Trans]. Med. 1,
12ra23.

Brochet X., Lefranc M. P. & Giudicelli V. (2008) IMGT/V-QUEST: the highly
customized and integrated system for IG and TR standardized V-J and V-D-J
sequence analysis. Nucleic Acids Res. 36, W503—W508.

Cancer Genome Atlas Network. (2015) Genomic Classiﬁcation of Cutaneous
Melanoma. Cell 161, 1681—1696.

D'Angelo S. et a1. (2014) The antibody mining toolbox: an open source tool for the
rapid analysis of antibody repertoires. MAbs 6, 160-172.

DeKosky B.J. et a1. (2014) In-depth determination and analysis of the human paired
heavy- and light-chain antibody repertoire. Nat. Med. 21, 86-91.

Gentles A.J. et a1. (2015) The prognostic landscape of genes and inﬁltrating im-
mune cells across human cancers. Nat. Med. 21, 940—947.

Giudicelli V., Chaume D. & Lefranc MP. (2004) IMGT/V-QUEST, an integrated
software program for immunoglobulin and T cell receptor V-J and V-D-J rear-
rangement analysis. Nucleic Acids Res 32, W435 -440.

Grabherr M.G. et a1. (2011) Full-length transcriptome assembly from RNA-Seq
data without a reference genome. Nat. Biotechnol. 29, 644-65 2.

Hamblin T.J., Davis 2., Gardiner A., Oscier D.G. & Stevenson F.K. (1999) Unmu-
tated Ig V(H) genes are associated with a more aggressive form of chronic
lymphocytic leukemia. Blood 94, 1848-1854.

Howie B. et a1. (2015) High-throughput pairing of T cell receptor 01 and B sequenc-
es. Sci. Transl. Med. 7,301ra131.

Hunsucker S.A. et a1. (2015) Peptide/MHC tetramer-based sorting of CD8+ T cells
to a leukemia antigen yields clonotypes drawn nonspeciﬁcally from an underly-
ing restricted repertoire. Cancer Immunol. Res. 3, 228-235.

Iglesia MD. et a1. (2014) Prognostic B-cell signatures using mRNA-seq in patients
with subtype-speciﬁc breast and ovarian cancer. Clin Cancer Res. 20, 3818-
3829.

Kardos et a1. (2016) Claudin-low bladder tumors are immune inﬁltrated and active-
ly immune suppressed. J CI Insight 1(3), e85902.

Larimore K., McCormick M.W., Robins H.S. & Greenberg PD. (2012) Shaping of
human germline IgH repertoires revealed by deep sequencing. J Immunol. 189,
3221-3230.

Li et a1. (2009) The Sequence Alignment/Map format and SAMtools. Bioinformat-
ics 25, 2078-2079.

Li B. & Dewey C. N. (2011) RSEM: accurate transcript quantiﬁcation from RNA-
Seq data with or without a reference genome. BMC Bioinformatics 12, 323.
Logan A.C. et a1. (2014) Immunoglobulin and T cell receptor gene high-throughput
sequencing quantiﬁes minimal residual disease in acute lymphoblastic leuke-
mia and predicts post-transplantation relapse and survival. Biol. Blood Marrow

Transplant 20, 1307-1313.

Meffre E. et a1. (2001) Immunoglobulin heavy chain expression shapes the B cell
receptor repertoire in human B cell development. J Clin Ivest. 108, 879-886.
Mose L.E. et a1. (2014) ABRA: improved coding indel detection via assembly-

based realignment. Bioinformatics 30, 2813-2815.

Pannetier C., Even J. & Kourilsky P. (1995) T-cell repertoire diversity and clonal
expansions in normal and clinical samples. Immunol. Today 16, 176—181.

Pevzner P.A., Tang H. & Waterman MS. (2001) An Eulerian path approach to
DNA fragment assembly. Proc. Natl. Acad. Sci. USA 98, 9748—975 3.

Tiller T., Busse C. E. & Wardemann H. J. (2009) Cloning and expression of murine
Ig genes from single B cells. Immunol. Methods 350, 183—193.

van Dongen J .J. et a1. (2003) Design and standardization of PCR primers and
protocols for detection of clonal immunoglobulin and T-cell receptor gene re-
combinations in suspect lymphoproliferations: report of the BIOMED-2 Con-
certed Action BMH4-CT98-3 936. Leukemia 17, 225 7-23 1 7.

Vincent B. et a1. (2016) iWAS--A novel approach to analyzing Next Generation
Sequence data for immunology. Cell Immunol. 299, 6-13.

Warren R.L., Nelson B. & Holt R. (2009) Proﬁling model T-cell metagenomes
with short reads. Bioinformatics 25, 45 8-464.

Warren R.L. et a1. (2011) Exhaustive T-cell repertoire sequencing of human pe-
ripheral blood samples reveals signatures of antigen selection and a directly
measured repertoire size of at least 1 million clonotypes. Genome Res. 21, 790-
797.

Yourstone S.M., Lundberg D.S., Dangl J.L. & Jones CD. (2014) MT-Toolbox:
improved amplicon sequencing using molecule tags. BMC Bioinformatics 14,
284.

112 /810'sp2umo[p101x0'soi112u1101uioiq/ﬁd11q 111011 popcorumoq

9IOZ ‘09 isnﬁnV uo 2:

