ORIGINAL PAPER

Vol. 29 no. 24 2013, pages 3174—3180
doi:10. 1093/bioinformatics/btt541

 

Systems biology

Advance Access publication September 20, 2013

Design and analysis of large-scale biological rhythm studies: a
comparison of algorithms for detecting periodic signals in

biological data

Anastasia Deckard1’2’*, Ron C. Anafi3, John B. Hogenesch“, Steven B. Haase5 and

John Harer2

1Program in Computational Biology and Bioinformatics, 2Department of Mathematics, Duke University, Durham, NC
27708, USA, 3Department of Medicine, 4Department of Pharmacology, Institute for Translational Medicine and
Therapeutics, University of Pennsylvania School of Medicine, Philadelphia, PA 19104, USA and 5Department of Biology,

Duke University, Durham, NC 27708, USA

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: To discover and study periodic processes in biological
systems, we sought to identify periodic patterns in their gene expres-
sion data. We surveyed a large number of available methods for
identifying periodicity in time series data and chose representatives
of different mathematical perspectives that performed well on both
synthetic data and biological data. Synthetic data were used to evalu-
ate how each algorithm responds to different curve shapes, periods,
phase shifts, noise levels and sampling rates. The biological datasets
we tested represent a variety of periodic processes from different
organisms, including the cell cycle and metabolic cycle in
Saccharomyces cerevisiae, circadian rhythms in Mus musculus and
the root clock in Arabidopsis thaliana.

Results: From these results, we discovered that each algorithm had
different strengths. Based on our findings, we make recommendations
for selecting and applying these methods depending on the nature of
the data and the periodic patterns of interest. Additionally, these
results can also be used to inform the design of large-scale biological
rhythm experiments so that the resulting data can be used with these
algorithms to detect periodic signals more effectively.

Contact: anastasia.deckard@duke.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 16, 2013; revised on September 11, 2013;
accepted on September 16, 2013

1 INTRODUCTION

Many methods for detecting periodicity or patterns in biological
time series data exist, and these methods often come from scien-
tiﬁc ﬁelds outside of biology. Although these methods may
perform well for their original area of intended use, it is
often unclear how well they will perform on a given biological
dataset. In this study, we investigate the utility of four algo-
rithms. Ours is not the first effort to tackle this question of al-
gorithm selection:

 

*To whom correspondence should be addressed.

In de Lichtenberg et al. (2005a), they compared the perform-
ance of their new method with ﬁve existing methods (visual
inspection, Fourier and correlation scores, partial least squares
regression, single-pulse model, cubic spline model and Bayesian
model) on three cell cycle datasets from Saccharomyces cerevisiae
by Spellman et al. (1998). They demonstrated that their new
method outperformed these other methods at identifying genes
from benchmark gene sets, which was attributed to including a
measure of amplitude in their scoring. As in many such studies,
they found that no single method performed the best across all
their benchmark sets.

Dequéant et al. (2008) analyzed the performance of ﬁve
algorithms [phase consistency, address reduction, cyclohedron
test, stable persistence and Lomb—Scargle (LS)] on the outputs
of the segmentation clock in Mus musculus. They compared
the top results of the algorithms with benchmark sets of
known cyclic genes. They then looked at the algorithm’s top
genes that were not in the benchmark sets to see if they had a
biological connection to known cyclic behaviors. Some methods
performed better in the ﬁrst task, others performed better in the
second.

Zhao et al. (2008) analyzed the performance of three closely
related spectral analysis schemes (LS, Capon and missing-data
amplitude and phase estimation (MAPES)) on a cell cycle
dataset in S.cerevisiae. For their benchmarks, they used the list
of genes involved in the cell cycle from Spellman et al. (1998) and
the list of genes not involved in the cell cycle from de Lichtenberg
et al. (2005b). Their results showed that LS outperformed the
other methods.

Each of these studies measured the performance of algorithms
by how well they can identify known sets of genes for a given
periodic process (cell cycle, somitogenesis, etc.). To avoid the
potential biases and challenges in this approach, we augmented
our study of biological data (Section 2.2) with a study on syn-
thetic datasets (Section 2.1) so that we could quantify an algo-
rithm’s performance against known ground truth. We used
synthetic data to characterize algorithm performance for differ-
ent signal shapes, noise levels and sampling rates that are present
in different organisms and technologies. Synthetic data were also

 

3174 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 ﬂJO'slcumo[pJOJXO'sopchogutotq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Large-scale biological rhythm studies

 

used to investigate the algorithm’s ability to recover period,
phase and amplitude.

Previous studies generally focused on one type of periodic
signal or one type of organism. Our goal is to study how
algorithms perform across a variety of organisms and periodic
processes. We used algorithms to analyze experimental data from
several systems: the cell cycle (Orlando et al., 2008) and meta-
bolic cycle (Tu et al., 2005) in S.cerevisiae, circadian rhythm
(Hughes et al., 2009) in M musculus and the root clock
(Moreno-Risueno et al., 2010) in Arabidopsis thaliana. We
focused on microarray datasets and designed the synthetic data
to capture the characteristics of these data types.

After evaluating a large collection of algorithms, de
Lichtenberg (DL) (de Lichtenberg et al., 2005a), LS (Lomb,
1976; Scargle, 1982), JTK_CYCLE (JTK) (Hughes et al., 2010)
and persistent homology (PH) (Cohen-Steiner et al., 2010) were
selected for comparison. Several other algorithms were evaluated
but not included in further analysis because of similarity to tested
algorithms, being too general, using pre-processing algorithms,
lesser performance or no available implementation. These in-
cluded, but were not limited to, COSOPT (Straume, 2004),
ARSER Wang and Su, 2010), LSPR Wang and Zhang, 2011)
and address reduction (Ahnert et al., 2006).

The four algorithms were chosen because they derive from
four different mathematical methods for identifying periodicity.
They were also selected for their ability to work on datasets with
limited numbers of periods, as the microarray datasets we exam-
ine contain 2—3 periods. Each deﬁnes periodicity differently,
weights aspects of rhythmicity differently (e. g. amplitude, proﬁle
shape) and responds differently to noise, irregular intervals and
missing data. Periodic signals are often described using the prop-
erties of cosine curves: period, amplitude and phase shift. Period
is the length of one cycle or, alternatively, the distance before a
pattern repeats. Amplitude is one half the peak-to-trough height.
Phase shift is the distance that the signal has been shifted in time.
Each of these algorithms returns a list of P-values or scores for
each of the time series evaluated based on some combination of
periodicity and/or amplitude.

The LS method was developed in the ﬁeld of astrophysics
(Lomb, 1976; Scargle, 1982) as a Fourier style method, but
was designed to deal with data that exhibit irregular sampling,
which is typical of observational data in astronomy. It measures
the correspondence to sinusoidal curves and determines their
statistical signiﬁcance (Glynn et al., 2006).

J TK has its origins in statistics but was adapted for biological
data in Hughes et al. (2010). It correlates pairs of points and then
computes the signiﬁcance of the correlation to that of a reference
curve.

The algorithm described by de Lichtenberg (DL) (de
Lichtenberg et al., 2005b) was constructed speciﬁcally for the
yeast cell cycle and thus comes directly from biology. It measures
the periodicity of a signal, but also takes into account a measure
of the amplitude. It uses permutations to generate a background
distribution for measuring signiﬁcance.

PH comes from the ﬁeld of computational topology, an area
that lies at the intersection of mathematics and computer science
(Cohen-Steiner et al., 2010). PH examines persistence pairings
of minima and maxima along the curve. A single minima and
maxima is considered to be the ideal perfect oscillation;

additional smaller oscillations create more minima and maxima
that are interpreted as a less perfect curve.

2 RESULTS
2.1 Synthetic data

To quantify algorithm performance and to make valid compari-
sons between each algorithm’s results, we developed several sets
of synthetic data to test the algorithms (Supplementary Tables S1
and S2). Four types of analysis were performed using synthetic
data.

The synthetic dataset included non-periodic cases: ﬂat and
linear; and periodic cases: cosine, two cosines with different per-
iods and amplitudes, cosine damped, cosine peaked, cosine with
a linear trend and cosine with an exponential trend (Fig. 1). The
start time was 0 and the end time was 200, with period lengths of
100 (two cycles in a proﬁle), the amplitude at 50 (for peak to
trough of 100), and the phase shifts were chosen on a uniform
distribution of 0 to the selected period length. Gaussian noise
was applied to the proﬁles with standard deviation 2 {0, 25, 50}.
These data were sampled evenly with three different numbers of
samples 2 {50, 25, 17}. This dataset was evaluated by each of the
algorithms, which were run to search for a large range of periods,
with period lengths between approximately 40 and 160 (except
DL, which was set to the target period because it only searches
for one period). Note that DL uses permutations on the entire
dataset to compute periodicity scores, so its results can vary
based on the proﬁles included in the dataset and the number
of permutations.

In the ﬁrst analysis, we tested each algorithm’s performance
on separating periodic from non-periodic signals with different
signal shapes, noise levels and sampling rates. For each case,
1000 proﬁles were generated. We examined the ability of the
algorithms to classify periodic versus non-periodic proﬁles
using receiver operator characteristic (ROC) plots (Fig. 2 and
Supplementary Figs S1—S3). ROC plots of algorithms visualize
the sensitivity and speciﬁcity on discriminating between positive
(periodic) cases and negative (non-periodic) cases as the P-value
or score cutoff is varied. These plots can inform the selection of
score or P-value cutoffs by looking at the trade-offs between

 

 

 

 

 

 

 

 

 

 

Trend
Exp

Trend
Linear

150- 100'

 

 

 

 

A 100- 100- _
’5 50- Cosine 50- Gosme
a, Two
I: o-. . . 0-. - -

P 100- _ 100- _
g 50_\/\/ Cosme 50_ Cosme
g Damp Peak
35 0-. . . o-.

:: 300- 200-

.C

.9

G.)

I 

B

100- 100-
50 Flat 50'

 

Linear

 

 

 

 

\i

 

 

10b 20b

o_|
O

_ 100 200
Time

Fig. 1. Test proﬁles for the synthetic datasets. The synthetic datasets
include (A) periodic proﬁles and (B) non-periodic proﬁles

 

3175

112 [glO'SIBILInO[plOJXO'SODBIILIOJHIOIQ/[ldllq IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

A.Deckard et al.

 

A JTK

.0

01 _L
.U
I

GS

True Positive Rate
0 8 A

O

 

 

 

WWW
\uu
WW:

 

 

 

 

 

 

 

 

 

 

 

 

 

 

l\)
01
1 (D
U
0.5 ||
01
0 | | | | | | | | | | | | o
0 0.5 1 0 0.5 1 0 0.5 1 0 0.5 1
False Positive Rate
B JTK LS PH DL
1 01
o
0.5 (D
.9 3
a 9 _ N
.“2’ m
17‘, 0.5 CD
a 3
a.) 0 '
E 1 — _.
'—  \l
0.5 (D
3
'0
0 | | | | | | | | | | | | I
0 0.5 1 0 .5 1 0 0.5 1 0 0.5 1
False Positive Rate
— Cos — Damp — Trend Exp
— Cos 2 — Peak — Trend Lin

Fig. 2. ROC plots showing algorithm performance on identifying peri-
odic signals for different shapes, noise levels and sampling rates.
(A) Performance for increasing Gaussian noise with SD: {0, 25, 50}
and number of samples: 50. 03) Performance for decreasing sampling
rates with number of samples : {50, 25, 17} and noise SD : 25. Used -ln
(P-value or score)

maximizing the true-positive rate (sensitivity) and minimizing the
false-positive rate (1—speciﬁcity). We examined degradation in
classiﬁcation performance due to noise by looking at increasing
noise levels for a ﬁxed number of samples (Fig. 2A). As expected,
performance degraded as noise increased; however, the perform-
ance on cosine two, damped and peaked proﬁles degraded much
more rapidly than for the other curves. We then examined the
degradation in classiﬁcation performance due to sampling rate
by looking at decreasing numbers of samples for a ﬁxed noise
level (Fig. 2B). Again, performance degraded as sampling rate
decreased. The performance on non-standard cosine curves (all
but cosine) degraded much more rapidly than the performance
on cosine curves. Both LS and JTK return P-values, which
change based on number of samples (see Supplementary Table
S3).

The second analysis examined whether the algorithms exhibit
a bias (for or against) any speciﬁc signal shapes. Each algorithm
has its own deﬁnition of what it considers to be a periodic signal,

 

 

 

   

 

 

 

 

 

 

1000— r:
500— J x
o — ,—,_
—112.99 |n(p—value), bin width=4.50 —4.94
1500— -
1000— I.
500— I (D
E 0 _—
é —2o.49 |n(p—value), bin width=0.69 —3.93
1000—
.u
500— I :I:
0 - .
0 |n(score), bin width=0.01 0.24
4000—
2000- ,9
o — , _

 

 

6.15 |n(score), bin width=1.60 44:51

I Cos I Damp ITrend Exp
I Cos 2 I Peak ITrend Lin

Fig. 3. Algorithm biases for curve shapes. Histograms display scores
returned for each different curve shape, for number of samples : 50
and no noise (Gaussian noise SD: 0). The x-axis shows the natural
log of the scores, ranging from the lowest (best score) to the highest
(worst score) returned by the algorithm. The y—axis shows the number
of proﬁles receiving the score

which can be detected in how each algorithm scores different
shapes (Fig. 3). To understand these preferences, the distribu-
tions of scores for each shape were plotted with no noise. This
analysis demonstrated that with no noise, JTK, LS and PH all
give cosine curves the highest scores. J TK’s next preference is for
peaked proﬁles, whereas LS’s next preference is for damped pro-
ﬁles and cosine two. DL gave the best scores to some of the
trended exponential (which had scores ranging from best to
worst), followed closely by trended linear, and then similar
scores for cosine, peaked, damped and cosine two. As noise in-
creases, and to some extent as the number of samples decreases,
the biases by shape become less distinct or shift as the scores of
different shapes begin to overlap (Supplementary Fig. S4).
However, LS does maintain more bias for cosine, especially com-
pared with peaked shapes.

In the fourth analysis, we explored each algorithm’s ability to
recover the period length of the periodic signals. The ability to
accurately recover period will help in selecting proﬁles that
belong to a given periodic process. We constructed more syn-
thetic datasets using the previous speciﬁcations, but with varying
periods. We again applied increasing Gaussian noise with stand-
ard deviation:{0, 25, 50}. For each case, 100 proﬁles were
generated. We examined the differences between the algorithms’
estimates and the actual parameters used (Fig. 4). The algorithms
LS, JTK and PH all do well with no noise (SD : 0) for cosine
and cosine damped. Estimates for peaked are slightly less accur-
ate, and the trended curves are least accurate. As the noise in-
creases, the accuracy of the period estimation for the damped
and peaked curves degrades more rapidly than for the cosine
curves. PH shows the most rapid degradation in period

 

3176

112 [glO'SIBILInO[plOJXO'SODBIILIOJHIOIQ/[ldllq 111011 pep1201umoq

910K ‘09 lsnﬁnV no 22

Large-scale biological rhythm studies

 

=50

 

 

Estimated Period

 

 

 

 

 

 

 

 

50 100 15050 100 15050 100 150
True Period

II Cos o Damp XTrend Exp
-I- Cos 2 A Peak OTrend Lin

Fig. 4. Period estimates for different proﬁle shapes and noise levels.
Estimates for all proﬁles are shown. The number of samples: 50 for
times 0—200 and Gaussian noise with SD: {0, 25, 50}. The black line
indicates estimate : true. Plots of the true period versus estimated period.
The period lengths were 50—150

estimation under increasing noise levels. Period estimates for all
curves are plotted, regardless of their periodicity score. In JTK,
proﬁles with the worst P-value (:1) are assigned one period,
creating a band across the plot. In LS and PH, many curves with
poor periodicity scores have estimated periods that are lower
than the actual periods. DL was not tested here as it only tests
one target period. For analysis of phase shift, see Supplementary
Figure S5.

2.2 Biological data

For the biological data, we analyzed each algorithm’s ability to
detect transcripts of a given periodic process. Experimental data
from several systems were studied: the cell cycle (Orlando et al.,
2008) and metabolic cycle (Tu et al., 2005) in S.cerevisiae, circa-
dian rhythm (Hughes et al., 2009) in M musculus and the root
clock (Moreno-Risueno et al., 2010) in A.thaliana. Each dataset
was run through the LS, JTK, DL and PH algorithms
(Supplementary Table S4).

We use these results to illustrate what preferences the algo-
rithms display for the four datasets. In Figure 5, the top ﬁve
scoring proﬁles from each algorithm on each dataset are
shown (Supplementary Figs S6—S9 for the top 20). All of the
probes were rank ordered on P-value (LS, JTK) or score (DL,
PH). In cases where several probes received the same score, we
selected curves of interest (number of probes with the same top
score: cell cycle PH: 253, metabolic cycle DL: 42, root DL: 530,
circadian DL: 52). The results show how different the datasets
are from one another (see Section 2 for more information). The
yeast cell cycle data are less densely sampled than the other

datasets (samples/cycles in the data: yeast cell cycle 13/2, yeast
metabolic 36/3, root clock 39/2, mammal circadian 48/2). The
plant root clock and mammal circadian data appear to be noisier
than the yeast datasets.

Shapes similar to cosine curves appear in the top scores from
LS; but we can see curves that look equally periodic, although
less similar to cosine shapes, in the other algorithms’ top scores.
The DL algorithm prefers higher amplitude proﬁles, as measured
by standard deviation, which works well for the yeast cell cycle
data: two of the top ﬁve scores shown are cell cycle genes
(NRMl and CLBl). In the plant root clock, however, DL’s
top scoring expression proﬁles appear to be noisier than JTK
or LS’s top proﬁles. There are also many proﬁles that are more
peaked, which both J TK and DL score well from the yeast meta-
bolic cycle data. PH detects extremely peaked proﬁles, which
works well in the yeast metabolic data, but returns results that
do not appear to be periodic in the mammal circadian and the
plant root clock. For example, the genes Adamlb in the mouse
circadian and AT1G28400 in the root clock datasets appear to be
singular peaks not associated with periodic expression. However,
in the case of the yeast metabolic data, many of the top results
show steep peaks (e.g. AAHl); these appear to be truly periodic
proﬁles as they are regularly spaced and match the expected
period.

In some cases, the rankings between algorithms are similar,
whereas in other cases they can be dramatically different. One
of LS’s top ﬁve for the yeast cell cycle, ACF4, was ranked in
the best 5% by all algorithms. However, YDR239C was ranked
in the best 5% by J TK and PH but was ranked in the worst 10%
by DL.

To compare the algorithms that return signiﬁcance measures,
J TK and LS, we counted the number of genes at several cutoffs
for P-values and q—values (Table 1). The q—values were calculated
using Benjamini—Hochberg false discovery rate (FDR)
(Benjamini and Hochberg, 1995). We used previously published
information about the number of periodic genes associated with
each of these processes for comparison. The number of genes
considered to be periodically expressed can vary by the type of
algorithm(s) applied, score/P—value cutoffs used, and any add-
itional ﬁltering on other characteristics of the expression proﬁles.
For the yeast cell cycle data, 1271 genes were identiﬁed as having
periodic transcription using the de Lichtenberg method (Orlando
et al., 2008); 800 were identiﬁed using a Fourier algorithm with a
correlation measurement on a different yeast cell cycle dataset
(Spellman et al., 1998). For the yeast metabolic cycle, 3552 genes
were called periodic using a combination of the LS periodogram
and autocorrelation function (P< 0.05) (Tu et al., 2005). For the
root clock data, the authors identiﬁed 3493 periodic genes using
the intersection of LS (P<0.015) and address reduction with
ﬁltering by fold change and expression value (Moreno-Risueno
et al., 2010). For comparison, from our run of LS without ﬁlter-
ing or other methods, there are 10 509 proﬁles that have P< 0.01.
For the mouse liver circadian data, 3667 periodic genes were
identiﬁed by the intersection of the Fisher’s G and COSOPT
methods (q<0.05) (Hughes et al., 2009); 5425 using JTK (BH
Q<0.05) (Hughes et al., 2010).

When attempting to compare the results of several algorithms,
selecting sets of periodic genes by P-value or score poses an inter-
esting problem. Selecting one signiﬁcance level can return genes

 

3177

112 [glO'SIBILInO[plOJXO'SODBIILIOJHIOIQ/[ldllq 111011 popcolumoq

910K ‘09 lsnﬁnV no 22

A.Deckard et al.

 

 

 

 

 

LS JTK DL PH

ACF4 /\/‘ SRP1 W HTA2 /\/- MET18 W
.6 i SKI7 \/\/ RRN10 /\/‘ NRM1 /\/~ RAD51 /\/:
g CF: TP03 \J\/ SKI7 \/\/ CLB1 /\/— N|P100 \,\,
o Y|L001W W ECM32 W S|M1 /\/‘- RAD50 W
YDR2390 V\r\/ PLB1 ’\/\, SRL1 /\"' POP2 W
Elovl3 m Elovl3 m Tubb2a 4% Stsgal5 N
E g Tars W Bnip3 N Avpr1a M Nampt N
g g Gys2 N Stsgal5 N Elovl3 m Stsgal5 N
E '5 Clpx /’\/\\,, Stsgal5 N Arntl m Adam1b 1 1
8002 M Nampt M NH d2 M Bnip3 N
AT3G52930 W AT1G03820 M RNS2 W PBC1 W

E :6 FAR7 M CRR28 M AT5G12470 W AT1G28400 ,1
E 2 AT1G03820 M PAP21 M PKT3 W DER1 W

n—“j O AT4G15940 W 263507_s_at le UNE5 W AT1G63310 1
AT5G11310 Mk. 244917_at M KCR1 W AT3G03960 W
9 SSA3 MA sw15 W sw15 MN GUT1 W
,6 g. S|P18 W BUD4 \MJ PRY2 . 1k I\ r EFT1 EFT2 M
E g MRPL35 \JUU ACE2 MAJ YCL048W-A AAA ADE17 M
*5 GRE2 W sum ’\j\/\/ SRL1 \AJU AAH1 1 1 1
E GND2 AM CHS2 \AA, HBT1 MA GLY1 W

 

Fig. 5. The top ﬁve scoring gene expression proﬁles from each algorithm for each dataset. Algorithms are shown in columns and the datasets are in rows.
All the expression proﬁles are normalized minimum to maximum for their amplitude

Table 1. The number of genes considered periodic at various cutoffs on
P—values and q-values

 

 

Dataset Algorithm P<0.05 P<0.01 q<0.05 q<0.01
Yeast cell cycle LS 4 0 0 0
J TK 800 208 0 0
Yeast metabolic cycle LS 3744 2660 291 8 1819
J TK 4626 3828 4237 3396
Root clock LS 12 518 10 509 11 677 9322
JTK 13364 11990 12894 11491
Mammal circadian LS 6570 3849 2845 1577

J TK 9991 6204 5607 3935

 

sets with large differences in the number of genes considered peri-
odic. For example, in the yeast cell cycle data, using P < 0.05 gives
800 genes from JTK but only four genes from LS. Additionally,
the algorithms PH and DL do not return P-values. Therefore, it is
difﬁcult to directly compare P-values or scores returned by these
algorithms. See Supplementary Figures S10—S13 for the distribu-
tions of P-values or scores.

2.3 Recommendations

From these results and literature on the algorithms, we have
created a decision tree to recommend algorithms based on
their ability to distinguish periodic from non-periodic proﬁles

in synthetic data (Fig. 6). Sampling at least one full period is
recommended, and sampling across two periods is strongly pre-
ferred, as periodicity means that values are repeated at regular
intervals, which can only be veriﬁed with two full periods. LS can
handle data with one or less periods, but J TK and PH require at
minimum of one full period.

Considering the interactions of noise, sampling rate and shape
is complicated (See Supplementary Figs S1—S3 for ROC plots
with area under curve (AUC)). In an ideal situation with no
noise and high sampling rate, J TK, LS and PH performed well at
distinguishing periodic from non-periodic signals. At low noise
levels, PH worked well and its ignorance of shape can be used to
ﬁnd peaked proﬁles. However, PH’s performance degrades more
rapidly than LS and JTK under increasing noise and decreasing
sampling rate. As noise increases or sampling rate decreases, the
ability to detect damped and peaked proﬁles degraded most rap-
idly for all the algorithms. Where the data are noisy (e. g.
Gaussian noise SD : 50 with a peak-to-trough amplitude of
100) and low sampling rate (e. g. 17 samples across two periods),
the algorithms perform most poorly in distinguishing damped,
peaked and cosine two signals from non-periodic signals, but
performed better on cosine and trended signals. In this case, it
would be advisable to repeat the experiment with a higher sam-
pling rate and/or lower noise levels. It would also be possible to
apply algorithms to correct for other signals in the data, such as
trending, damping or noise; however, we did not test these types
of preprocessing on the performance of periodicity detection al-
gorithms. Where high noise or low sampling rate (but not both)

 

3178

112 [glO'SIBILInO[plOJXO'SODBIILIOJHIOIQ/[ldllq 111011 popcolumoq

910K ‘09 lsnﬁnV no 22

Large-scale biological rhythm studies

 

      
 
    

high

low

 
 

 

/' -
DL
/ <

cos, trend pH

‘ cos, trend, peak " ‘
’4 LS

prefer peak

 

 

damp, peak 7 kPre-Process OR New Exp]

 

Fig. 6. Recommendations for selecting an algorithm based on the dataset’s noise, sampling rate and expected curve shapes. Start on the left to select the

type of noise, then sampling rate and then shape

exists, J TK and LS are able to differentiate between periodic and
non-periodic proﬁles for cosine. These algorithms also per-
formed reasonably well for trended data, but their performance
on damped or peaked data was much lower.

These algorithms also provide different features. Both LS and
J TK return measures of signiﬁcance, whereas DL and PH return
scores. JTK is ignorant of amplitude, so it can be used to pick
out proﬁles of low or high amplitude without bias (as much as
those signals can stand out from noise). DL preferred high amp-
litude proﬁles, as measured by the standard deviation of the
proﬁles. However, this can also lead to a preference for proﬁles
with higher noise. Some algorithms can handle time series with
missing time points, such as JTK, and/or unevenly spaced time
points, such as LS. See Supplement for more information on
their features (Section 1) and information on the execution
times of their implementations (Section 2).

3 DISCUSSION

Our ﬁndings suggest that curve shape has the largest impact on
the scoring of biological signals by these periodicity detection
algorithms, especially under conditions of higher noise or lower
sampling rate. Algorithms such as LS, DL and JTK rely on
comparing data with reference curves (LS and DL assume a si-
nusoidal curve, JTK can use a user-speciﬁed curve); therefore,
they will perform most accurately when the data match the
assumptions speciﬁed by the reference curves. Additionally, as
noise increases or sampling rate decreases, the ability of these
algorithms to classify non-standard curve shapes degrades much
more rapidly than for true cosine shapes. This is helpful when a
speciﬁc type of shape is being sought and any other types should
be ﬁltered out, but is limited in a more exploratory setting when
it is unknown what curve shapes a periodic process might
produce.

This also brings up the question of preprocessing the data to
remove factors external to the expression levels (noise, systematic
error, population averaging effects, etc). To perform preprocess-
ing, the type of external factor must be identiﬁed and quantita-
tively characterized in way that an algorithm can correct for it.
Additionally, computationally ﬁtting and resampling data at a
higher rate can make a dataset more amenable to computational
approaches, but in the case of LS and JTK, would alter the
resulting P-values. Although these could increase performance
of periodicity detection algorithms, caution should be exercised
to avoid altering the underlying signal.

The applicability of the recommendations will vary depending
on how well the characteristics in the data are known and how
well the assumptions of these tests match these characteristics.
In cases where the characteristics of noise, the number of cycles
or shape are not known in the dataset, these recommendations
should be relaxed and we suggest using several algorithms.
Additionally, if the characteristics of the data are not similar to
the synthetic signals (e. g. proﬁles are more similar to a square
wave), then the recommendations may not perform as desired.

Given their different underlying ideas of periodicity, these
algorithms could be used together to recover a more comprehen-
sive set of periodic signals within a dataset. This is especially
useful when the signal attributes are not known beforehand.
Additionally, these algorithms also contain components for mea-
suring phase shift and amplitude that could be used separately,
and supplemented with other methods. Amplitude could be a
useful measure of regulation, and phase shift is an important
measure of timing. Being able to accurately estimate phase
shifts between transcripts can allow us to reconstruct timing
and suggest regulatory relationships.

Another issue is how to interpret and compare the P-values or
scores that are returned by these methods. The work of Kallio
et al. (2011) and Futschik and Herzel (2008) suggests that the
signiﬁcance of the results is generally overestimated in statistical
methods where the null model may have more randomness than
exists in the data. This causes the signiﬁcance values to be exces-
sively optimistic and overestimates the number of periodic genes.
Additionally, LS and JTK return P-values, and these P-values
change if the sampling density changes. Therefore, the periodicity
of two identical proﬁles, one with twice as many time points as
the other, is not directly comparable using the ﬁnal P-values
from these algorithms.

As we have seen in this study, there are several algorithms that
could be run against biological datasets that will return results of
interest. To improve these results, there must be an understand-
ing of what information is available in the data, what answers are
being sought in the data and which algorithms will be best able
to bridge the gap between these two points.

4 MATERIALS AND METHODS

Lomb—Scargle (Lomb, 1976; Scargle, 1982): Sinusoidal curves of different
periods are compared with the time series to generate a measure of
correspondence. The signiﬁcance of each of these is calculated, and the
period of the most signiﬁcant ﬁt is returned. The implementation was in
R and was from Glynn et al. (2006).

 

3179

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJHIOIQ/ﬂdllq 111011 popcolumoq

910K ‘09 lsnﬁnV no 22

A.Deckard et al.

 

J TK_CYCLE mughes et al., 2010): A set of reference curves (sinus-
oidal, but can be deﬁned) is generated to varying periods and phase shifts.
A pair-wise comparison of all points in a curve calculates whether they
are increasing or decreasing in relation to one another. The increasing/
decreasing pattern of the time series is then compared with the increasing/
decreasing pattern of each reference curve to determine the statistical
signiﬁcance of the correlation. The period and phase shift for the refer-
ence curve with the most signiﬁcant correlation is returned. The authors
of JTK (Hughes et al., 2010) provided an implementation in R.

de Lichtenberg (de Lichtenberg et al., 2005b): To measure the signiﬁ-
cance of periodicity, a background distribution is generated by creating a
set of random proﬁles by permuting the proﬁle’s expression values. The
P—value is the proportion of permuted proﬁles with Fourier score at least
as large as the original proﬁles observed Fourier score. For the signiﬁ-
cance of regulation, the gene expression proﬁle is compared with a set of
random proﬁles generated by selecting a value from a randomly selected
gene proﬁle at each time point. The P—value for regulation (amplitude)
is measured as the proportion of permuted proﬁles with standard devi-
ation at least as large as a time series’ observed standard deviation. The
implementation in R from Orlando et al. (2008) was used (see
Acknowledgements).

Persistent Homology (Cohen-Steiner et al., 2010): PH normalizes the
data from 0 to 1, and then pairs (in a subtle way) minima and maxima of
a time series. A measure is obtained by summing the differences (persist-
ence) between the maximum and the minimum of each pair. If there is
only one minimum and maximum pair, the measure is one, indicating a
perfect oscillation. Additional oscillations in the time series will create
more pairs, which will increase the score, indicating a less perfect curve.
Sliding windows with widths equal to the range of periods are used; the
period with the lowest score is returned. The last author of Cohen-Steiner
et al. (2010) provided a C++ implementation of the PH algorithm (see
Acknowledgements). See Supplement for additional details.

In the yeast cell cycle data (GSE8799) (Orlando et al., 2008), there is a
stress response during the recovery period; we, therefore, ignored the ﬁrst
two time points and looked only at the last 13 time points. There were
two replicates, for our analysis we used only the ﬁrst replicate. The data
were provided by the authors. For the yeast metabolic data (GSE3431)
(Tu et al., 2005), we evened the sample times in the data by making the
sampling at every 24 minutes. Any blanks in the data were ﬁlled with
zeros. The data were downloaded from Gene Expression Omnibus. In the
plant root clock data (GSE21611) (Moreno-Risueno et al., 2010), we
applied evenly spaced time points to approximate the inferred timing.
The data were provided by the authors. For the mammalian circadian
rhythm data (GSE11923) mughes et al., 2009), the data were provided by
the authors. See Supplement for additional details.

ACKNOWLEDGEMENTS

The authors would like to thank Dave Orlando for his imple-
mentation of the DL method and Yuriy Mileyko for his imple-
mentation of the PH method. For the informative discussions
and critical reading of the manuscript, we would like to thank
Sara Bristow, Adam Leman and Christina Kelliher. They would

also like to thank the four anonymous reviewers for their
suggestions.

Funding: Defense Advanced Research Projects Agency
(D12AP00001).

Conflict of Interest: none declared.

REFERENCES

Ahnert,S. et al. (2006) Unbiased pattern detection in microarray data series.
Bioinformatics, 22, 1471—1476.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac-
tical and powerful approach to multiple testing. J. R. Stat. Soc. Series B
Methodol., 57, 289—300.

Cohen-Steiner,D. et al. (2010) Lipschitz functions have L p -stable persistence.
Found. Comput. Math., 10, 127—139.

de Lichtenberg,U. et al. (2005a) Comparison of computational methods for the
identiﬁcation of cell cycle-regulated genes. Bioinformatics, 21, 1164—1 171.

de Lichtenberg,U. et al. (2005b) New weakly expressed cell cycle-regulated genes in
yeast. Yeast, 22, 1191—1201.

Dequéant,M. et al. (2008) Comparison of pattern detection methods in microarray
time series of the segmentation clock. PLoS One, 3, e2856.

Futschik,M.E. and Herzel,H. (2008) Are we overestimating the number of cell-
cycling genes? The impact of background models on time-series analysis.
Bioinformatics, 24, 1063—1069.

Glynn,E.F. et al. (2006) Detecting periodic patterns in unevenly spaced gene expres-
sion time series using Lomb—Scargle periodograms. Bioinformatics, 22, 310—316.

Hughes,M.E. et al. (2009) Harmonics of circadian gene transcription in mammals.
PLoS Genet, 5, e1000442.

Hughes,M.E. et al. (2010) JTK_CYCLE: an efﬁcient nonparametric algorithm for
detecting rhythmic components in genome-scale data sets. J. Biol. Rhythms, 25,
372—380.

Kallio,A. et al. (2011) Randomization techniques for assessing the signiﬁcance of
gene periodicity results. BM C Bioinformatics, 12, 330.

Lomb,N. (1976) Least-squares frequency analysis of unequally spaced data.
Astrophys. Space Sci, 39, 447—462.

Moreno-Risueno,M.A. et al. (2010) Oscillating gene expression determines compe-
tence for periodic Arabidopsis root branching. Science, 329, 1306—1311.

Orlando,D. et al. (2008) Global control of cell-cycle transcription by coupled CDK
and network oscillators. Nature, 453, 944—947.

Scargle,]. (1982) Studies in astronomical time series analysis. II-Statistical aspects of
spectral analysis of unevenly spaced data. Astrophys. J., 263, 835—853.

Spellman,P.T.P. et al. (1998) Comprehensive identiﬁcation of cell cycle-regulated
genes of the yeast Saccharomyces cerevisiae by microarray hybridization. Mol.
Biol. Cell, 9, 3273—3297.

Straume,M. (2004) DNA microarray time series analysis: Automated statistical
assessment of circadian rhythms in gene expression patterning. In: Brand,L.
and J ohnson,M.L. (eds) Methods in Enzymology. Vol. 383, Elsevier Academic
Press, San Diego, pp. 149—166.

Tu,B. et al. (2005) Logic of the yeast metabolic cycle: temporal compartrnentaliza-
tion of cellular processes. Science, 310, 1152—1158.

Yang,R. and Su,Z. (2010) Analyzing circadian expression data by harmonic regres-
sion based on autoregressive spectral estimation. Bioinformatics, 26, i168—i174.

Yang,R. and Zhang,C. (2011) LSPR: an integrated periodicity detection algorithm
for unevenly sampled temporal microarray data. Bioinformatics, 27, 1023—1025.

Zhao,W. et al. (2008) Detecting periodic genes from irregularly sampled gene ex-
pressions: a comparison study. EURASIP J. Bioinform. Syst. Biol, 2008,
769293.

 

3180

112 /810's112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

