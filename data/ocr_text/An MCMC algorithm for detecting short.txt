ORIGINAL PAPER

Vol. 27 no. 13 2011, pages 1772-1779
doi: 10. 1093/bioinformatics/btr28 7

 

Sequence analysis

Advance Access publication May 6, 2011

An MCMC algorithm for detecting short adjacent repeats shared

by multiple sequences

inei Li‘, Xiaodan Fan“, Tong Liang2 and Shuo-Yen R. Li2

1Department of Statistics and 2Department of Information Engineering, The Chinese University of Hong Kong, Sha

Tin, New Territories, Hong Kong
Associate Editor: John Quackenbush

 

ABSTRACT

Motivation: Repeats detection problems are traditionally formulated
as string matching or signal processing problems. They cannot
readily handle gaps between repeat units and are incapable of
detecting repeat patterns shared by multiple sequences. This study
detects short adjacent repeats with interunit insertions from multiple
sequences. For biological sequences, such studies can shed light on
molecular structure, biological function and evolution.

Results: The task of detecting short adjacent repeats is formulated
as a statistical inference problem by using a probabilistic generative
model. An Markov chain Monte Carlo algorithm is proposed to infer
the parameters in a de novo fashion. Its applications on synthetic
and real biological data show that the new method not only has a
competitive edge over existing methods, but also can provide a way
to study the structure and the evolution of repeat-containing genes.
Availability: The related C++ source code and datasets are available
at http://ihome.cuhk.edu.hk/%7Eb118998/share/BASARD.zip.
Contact: xfan@sta.cuhk.edu.hk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on February 10, 2011; revised on April 14, 2011; accepted
on May 2, 2011

1 INTRODUCTION

In the past decades, the identiﬁcation of repetitive patterns in
biological sequences, especially approximate tandem repeats in
DNA sequences, has attracted researchers from many ﬁelds. Yet,
it still remains as a challenging problem. A tandem repeat in
DNA is a sequence segment containing two or more contiguous,
approximate copies of a pattern of nucleotides (Benson, 1999).
In this article, we expand our views by relaxing the constraint of
consecutiveness and allowing of short gaps, i.e. interunit insertions,
between neighboring units because gaps have been frequently
observed in natural repeats. We name this type of repeats with short
gaps as short adjacent repeats. An example of short adjacent repeat

AA A A
would be ---ATATgCGATCCGtATCCGccATCCcTC---, where a
gap composed of one background nucleotide t is inserted between
the second repeat unit and the third repeat unit, and another gap
composed of two background nucleotides cc is inserted between the
third repeat unit and the fourth repeat unit. The consensus of its
sequence pattern ATCCG has a width of 5 bp and the copy number

 

*To whom correspondence should be addressed.

of this repeat equals to 4. The lower case highlights the variations
from the consensus.

The detection of short adjacent repeats is of considerable
signiﬁcance. Taking tandem repeats as an instance, in recent decades,
more and more researches have suggested that tandem repeats play
an important role in genetic mapping (Butler et al., 1997; Weber
and May, 1989), gene regulation (Du et al., 1997; Lu et al., 1993)
and human diseases (Sinden, 1999; Siyanova and Mirkin, 2001;
Sutherland and Richards, 1995).

Almost all repeats detection methods formulated it as either a
string matching problem or a signal processing problem. To avoid
excessive running time, most of the string matching algorithms are
composed of two steps (Benson, 1999; Krishnan and Tang, 2004;
Sagot and Myers, 1998; Sokol et al., 2007). They ﬁrst ﬁlter out
obvious non—repetitive regions of the sequence using some statistical
properties or ﬁnd out repetitive regions using some heuristical
methods, and then search locally for a match between a pattern and
a subsequence in those candidate repetitive regions. Recently, more
and more signal—processing—based methods have been proposed
(Buchner and Janjarasjitt, 2003; Gupta et al., 2007; Sharma et al.,
2004; Zhou et al., 2009). Signal—processing techniques, such as
discrete Fourier transform, short—time periodicity transform, exact
periodic subspace decomposition and autoregressive modelling, are
used for spectral analysis.

The above formulations often suffer from two constraints: (i) as
they largely rely on the periodicity of a short segment, they cannot
readily handle gaps between repeat units; (ii) they could be used to
detect tandem repeats in one sequence only, in other words, they are
blind to the enriched repetitive pattern shared by multiple sequences
where the polymorphic nature might contribute to specialization
and generation of diversity in biological functions (Larsen et al.,
2005). This article attempts to tackle both issues. Speciﬁcally, we
not only generalize the repeat model by introducing gaps between
neighboring repeat units, but also expand the scope of identifying
short adjacent repeats to multiple sequences. This is especially
helpful in the case where interunit insertions appear to be common
and where the sequence pattern shared by multiple sequences from
some particular loci shed light on molecular structure, biological
function and evolution.

Our full probabilistic model for repeats detection was inspired
by Lawrence et al. (1993) and Liu et al. (1995), which used the
sequence motif model to detect the enriched dispersed pattern
in multiple sequences. In the scenario of repeats detection, the
same pattern is also enriched in a local neighborhood within each
sequence. Our model is built to make use of the two levels of

 

1772 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /§JO'smumofpmjm'ssr1eu110jurorq//zd11q mm; pepeoIHAAoq

9IOZ ‘091sn8nv uo ::

Detecting short adjacent repeats

 

signal enrichment. We implement a full Bayesian approach to infer
globally the parameters of the model. After the Markov chain
converges, the sampled parameter values give us a whole picture of
their joint posterior distribution. The maximum a posteriori (MAP)
estimate (Gelman et al., 2004) is used as the point estimate of the
interested parameters. Moreover, we use a collapsing technique (Liu
et al., 1995) to improve computing efﬁciency and we design well—
organized Markov chain Monte Carlo (MCMC) moves to accelerate
the convergence rate.

This article is an extended version of our preliminary work
appearing in a conference (Li et al., 2010), where a generative model
with a binary vector structure was introduced for identifying short
adjacent repeats using primitive Bayesian algorithms. A parallel
implementation of that preliminary work using evolutionary Monte
Carlo algorithm was also presented in a conference (Xu et al., 2010).
In this article, we modify the original generative model with a new
repeat segment structure and give a full account of the strategy
of designing the Bayesian Approach for Short Adjacent Repeat
Detection (BASARD) for the ﬁrst time, together with a discussion
of the statistical power of BASARD under different repeat signal
strength. This article also provides a new case study on a real
biological dataset that can provide a way to study the structure and
the evolution of repeat—containing genes and proteins. Last but not
the least, our current method can also be applicable for data analysis
such as recognizing repetitive pattern in speeches, texts or images.

The rest of this article is arranged as follows. In Section 2, we
formulate the probabilistic generative model, explore the parameters
structure and deduce the posterior distribution. In Section 3, we
present the schematic procedure and demonstrate the MCMC
algorithm, BASARD, step by step. In Section 4, we evaluate
BASARD via both synthetic and real data. The last section concludes
the article and proposes some potential future work.

2 PROBABILISTIC MODEL

2.1 Generative model

In this subsection, we introduce a parametric model for the input data
R and the four kinds of parameters, namely A, S, (9, and CI). Note that
some of parameter deﬁnitions and notations are inherited from Liu
et al. (1995). Supplementary Table Sl lists the key notations used in
this article. Although the model is applicable to any 1D sequences
of ﬁnite alphabet, we will use DNA case to present the model and
the algorithm from now on.

2.1.1 Input data R The input data is composed of N sequences
denoted by Rn,15n5N, where Rn={rn,1,rn,2,...,rn,Ln}. Each
residue rm 1 is sampled from a ﬁnite alphabet X (X: {A, T, C, G} for
DNA sequences). Ln, 1 5 n 5N, is the length of the n—th sequence.
In this model, we assume that the input sequences are mutually
independent. Therefore, the full likelihood function can be written
as P(RlA,S, e, <1>)=1‘[1,,V=1P(R,,|a,,,s,,, (9, cp).

2.1.2 Parameters A: Locations of repeat segments A set of
repeat segment starting positions, denoted by A, can be written
as A=[a1 a2  aN ]T, where T denotes matrix transpose and
1 5 an 5L”. Here, we assume that there is only one repeat segment
per sequence. The case of multiple repeat segments per sequence is
discussed in Section 5.

For the prior distribution of an, we use a uniform distribution,
which means all positions in each sequence is priorly equally likely
to start a repeat segment. We further assume the independence
among all elements in A, i.e. P(A)=]_[],¥=1P(an)o< 1.

2.1.3 Parameters S: structures of repeat segments A set of
repeat segment structures, denoted by S, can be written as S:

[SIT s;  5%,]? Here sn,15n5N, is a base—(0+1) numerical

vector of the format

(52 — 1) elements in total

5 = w ,
n [gnu gn,2  gn,§2,,—1 —1  4]

 

where 52”, 52,, Z 1, is the copy number of the n—th repeat segment,
and the variable gn,w,15w5Qn—1, is the gap length between
the w—th repeat unit and the (w—l— 1)—th repeat unit within S”. G is
the maximum allowed gap length and therefore 05 gm.) 5 G. It is
required that each 5,, should be the same dimension by ﬁlling with
the trivial value —1 from the Qn—th to the (£2 — 1)—th element of each
S”, where 52 is the maximum allowed copy number. If there is only
one repeat unit, all elements of this vector 5,, will be —1.
Let

ﬁsz

1
z = 1
""0 {(w—1)J+Z;0=llgn,K—l—1 if25w5Qn—1. 0

It indicates that the w—th repeat unit in the n—th sequence starts
at the position an—l—zmo—l of the sequence Rn. Based on the
assumption that each repeat segment is composed of multiple repeat
units separated by gaps of random length, we are now able to deal
with the case of interunit insertions, using the base— (G—l— 1) numeral
vector.

Since longer gaps are usually less likely to occur in nature
compared with shorter gaps, we might assume P(sn) decays
exponentially with both the copy number and the total length

Qnil
of gaps, e.g. P(sn)o<8§2n 822...:1 g...

81 and 82 are in the range of (0,1]. We also assume that all

, where both of the constants

S” are mutually independent. Thus, we have P(S)=]_[1,¥=1P(sn)o<

N N 9,,41
812:"=1§2n82:"=12w=1 g”. This prior distribution choice avoids
the transdimensional problem while updating the copy number
parameters by implicitly requiring P(gmw = —1)=1 for 52,, 5a) 5
$2 — 1.

2.1.4 Parameters (9: motif matrix The motif matrix is denoted
by (9. For DNA sequences, it can be written as a 4 X J motif matrix
as @=[0102  0]], where 0j=[9A,j QTJ' QCJ' 9G,j]T,1§j§
J, is the relative frequencies of ﬁnding each letter k,k€ x, at the
position j among all repeat units. Note that 2k 61"]- : 1,Vj and 61"]- Z
0,Vk, j.

It is assumed that all repeat units are independent and identical
samples from this motif matrix (9. (9 is the parameter of a Product
Multinomial (PM) distribution (Liu et al., 1995). We assume
(9 follows a Product Dirichlet (PD) prior distribution with the
parameter B (Liu et al., 1995) as B=[,Bl ,82  ,BJ], where ,sz

[,BAJ- ,BTJ- ,8ij ,BG,j]T,15j5J. Each 01- is an independent 4D
Dirichlet random vector following the distribution Dirichlet (01-).

 

1 773

112 /B.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Q.Li et al.

 

Without any prior knowledge, we set all elements in B equal to 1.
As a result, we have P ((9) oc 1.

2.1.5 Parameters CID: Background distribution The background
distribution is a multinomial distribution parameterized by CD. For

the DNA sequence case, (I) can be written as CD = [qu ng qu qu ]T,
where qbk,k E X is the probabilities of ﬁnding each letter k at a non—
unit position. Note that 2k gbk =1 and qbk Z 0,Vk.

We assume that all nucleotides at non—unit positions are
independent and identical samples from the background distribution.
Similar to (9, we assume (I) follows a Dirichlet priors with parameter

a, where at 2 [05,4 aT ac aG ]T. Analogously, we set all elements
in at equal to 1 . As a result, we have P ((1)) oc 1.

For ease of presentation, Supplementary Figure Sl displays an
example of schematic diagram of our model.

2.2 Parameter structure

Our scheme maintains two evolving parameter groups. The ﬁrst
group containing A and S indicates the locations of all repeat units.
The second group that comprises (9 and CD describes the motif pattern
and the background distribution, respectively.

Before investigating the relationship between the two parameter
groups, we introduce the following function and notation. For a
given set of categorical data, e.g. Y: {yl , ...,yl, . . . ,yL}, where each
y; takes values from the ﬁnite alphabet X, we deﬁne the counting
function h (Liu et al., 1995) such that h(Y)=[mA mT mg mg ]T,
where mk,k€ X is the total number of letter k observed in Y. Let
‘1’: {(n, l) : n: 1, ...,N;l= 1, . . . ,Ln} denote the collection ofindices
in R. For any set W g ‘11, we deﬁne RW = {rnJ : (n, l) E W}. We also
deﬁne WC 2 ‘II\W as the set of all elements which are members of
‘II but not members of W.

Given A and S, the observation of all repeat units’ indices
can be denoted as set U: {(n,an -l—zn,w — 1 +j— 1)}, where
n:1,...,N,w=1,...,52n_1,j=1,...J, and zmw is described by
Equation (1). We also write the set of the residues occupied in the j—th
positions of all repeat units as RUG), and the corresponding set of

indices is U(j)= {(n,an—l—zn,w— 1—l—j— 1)}, where n: 1, ...,N,w=
1, . . . , 52n_1. As U gives the indices of all repeat units, the
observations of all nucleotides at non—unit positions can be denoted
as RUc.

We can get the sufﬁcient statistics by applying the counting
function h on each RUG) and RUc. We denote the results as a 4 X J

matrix h(RU)=[h(RU(1)) h(RU(2))  h(RU(J))], where
h(RU(j))=[mA,j mT,j mCJ- mG,j]Tanda4><1vectorh(RUc)=

[WA WT WC wG ]T, respectively. Note that the summation of all
elements in h (RUm) equals to the total number of the observed

repeat units, i.e. 227:1 £2”, for all j and the summation of all elements
in h (RUc) equals to the total number of nucleotides within the
background area, i.e. 227:1 Ln —J 227:1 52,1. As the same as in Liu
et al. (1995), h (RU) follows a PM distribution with parameters
(9, and each h(RU(,-)) follows the multinomial distribution,
i.e. h(RU(I-) )~Multinomial (227:1 $2,501) In addition, h(RUc)
follows a multinomial distribution with parameters CID, i.e.
h (RUC )~Multinomial (25:12, 425:1 on; <1> ).

For the Bayesian inference of (9 and CD, we use conjugate
priors, which are the PD distribution and the Dirichlet
distribution, respectively. Therefore, the posterior distribution of
(9 is PD (B—l—h(RU)) and the posterior distribution of CD is
Dirichlet (a + h (RUC )).

2.3 Posterior distribution

In this subsection, we ﬁrst deduce the full posterior distribution.
Then, a collapsing technique is used to make the proposed algorithm
introduced in the next section more efﬁcient.

2.3.1 The full posterior distribution Given all the parameters A,
S, (9 and CD, the likelihood of observing the given data R can be
written as
J
P(RlA,S,(9, c1>)=<1>h(RUC) “0111mm, (2)
j=1

where we deﬁne the vector power of a vector as the
product of all elements after taking corresponding power,
i.e. 0;](RUW)     and (Dh(RUc) Z¢XA $3? $12? ¢VGVG .
With mutually independent priors, the joint posterior distribution
of A, S, (9 and CD can be written as P(A,S,(9,<I>|R)o<
P(RlA,S,(9,<1>)P(A)P(S)P((9)P(<I>). According to the complete—
data likelihood given by Equation (2) and the prior distributions
of each kind of parameters described previously, we can obtain the
full posterior distribution as

P(A,S,(9,<I>|R)o<

N N n, J
Zn=l Q" Zn=1zg=11gmw   

81 82
1:1

2.3.2 The collapsed posterior distribution The algorithm based
on the above joint posterior distribution can be inefﬁcient because
of the high dimensionality of the parameter space. One solution
is to integrate out the nuisance parameters. As A and S are mainly
concerned, (9 and CD are thus not parameters of interest, or at least, it
is not difﬁcult to estimate approximate (9 and CD conditional on A and
S. Using the collapsing technique (Liu et al., 1995), we can actually
integrate out (9 and CD in order to make the proposed algorithm more
efﬁcient in terms of computing.

Note that P(A,S|R)=ffP(A,S, (9, <1>|R)d(9d<l>, our choices of
the Dirichlet priors for (9 and (I) enable us to integrate out both (9 and
CD. The resulting collapsed posterior distribution can be written as

Qni

N N 1
P(A,  OC 812:"=1§2"82::n=12w=1 gm)

I‘(|oc|)l‘(h(RUc)+oc) 111 F(Iﬁjl)r(h(RUg,)+/sj) (4)
P(a/r(|h(RUc)|+|a|) _=1P(ﬁj>r(lh(RUm)l+|/3jl>,

J

 

where we deﬁne the absolute value of a vector as the summation of
all elements within the vector.

3 COMPUTING METHODS

At the beginning of this section, we present the basic and the improved
schematic procedures, respectively. Then, we describe BASARD based on
the improved schematic procedure step by step.

 

1774

112 /§JO's12u1nofp101x0'sor112u1101urorq//zd11q 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting short adjacent repeats

 

3.1 Schematic procedure

Given a set of N sequences R, our objective is to identify the location and
the structure of the most probable repeat segment within each sequence.
These N repeat segments are obtained by locating A and adjusting S that
maximize the posterior probability. The MCMC algorithm makes a full tour
of the target distribution P(A, S, (9, CI>|R) or P(A, SlR). When it converges,
we output the MAP of A and S.

We can use Metropolis—in—Gibbs scheme (Gelman et al., 2004) on
Equation (3) to iteratively sample one set of parameters given all the other
sets of parameters as well as the observed data: (i) sample and update A
conditional on S, (9, CI) and R; (ii) sample and update S conditional on A,
(9, CI) and R; (iii) sample and update (9 and CI) conditional on A, S and
R. However, this standard Metropolis—in—Gibbs scheme based on the full
posterior distribution is often too time consuming. To improve the computing
efﬁciency, we work on the collapsed posterior distribution described in
Equation (4). The improved schematic procedure of the MCMC algorithm,
namely BASARD is described as follows.

BASARD proceeds through iterations after initialization, each of which
updates an and sn one sequence after another from 1 to N. When
stochastically updating an and sn for one sequence, we pretend that the repeat
segments of the remaining (N — 1) sequences have been known. Speciﬁcally,
when the n—th sequence R, is selected, we use the given information, A[_,,]
and S[_,,], to estimate the ‘motif matrix’ (9,, and ‘background distribution’
CID” so as to determine new an and s,, sequentially. Here, A[_,,] and S[_,,]
denote the set of locations and structures, respectively, of all repeat segments
excluding the n—th sequence. Intuitively, the more accurate the estimated (9,,
and CI)” constructed in the predictive update step, the more accurate the
determination of an and sn in the following sampling steps, and vice versa.

3.2 Initialization and predictive update step

The ﬁrst step is to initialize A and S. As each s,, is a 1X 52 base—(G+1)
numeral vector, we ﬁrst choose a possible copy number in the range of
[1, $2], and then we assign a random gap number g in the range of [0,G]
for each pair of adjacent repeat units. A is a N ><1 vector and the initial
value of each an is randomly chosen from its possible values in the range of

[1,Ln 452,, — 23:11 gw +1].
Suppose that we are proceeding through the i—th iteration. Let 61 denote

. . A ‘ . A (') .
the j-th column vector 1n (9,51), then each estlmated 0”;- 1s calculated as,

- h R i4 .

90L '8’+ ( (11,111))
"’1 _ N ('—1)’

1ﬁj1+ZK=LK7€nQKl

where U[_,,] denotes all repeat units indices excluding those repeat units
within Rn. Also, the estimated 61),, is calculated as,

“+11 R C(iil)
A ('> UH]
(Dn’ =

._1 ,
IaI+Zl=1,K.2.LK—mfé )

 

(5)

(6)

 

where U[C_n] denotes all background nucleotides indices excluding those
nucleotides within Rn.

3.3 Gibbs sampling step for an

Conditional on the repeat segment structure s,,, we consider every possible
repeat segment X in Rn. Using the results obtained in the predictive update
step and according to Equation (3), we can calculate the probability of
generating those matching repeat units within X according to the current
‘motif matrix’ (9,?) and the probability of generating all letters within X
according to the ‘background distribution’ A51”, respectively. The ratio of
these two probabilities is assigned as the sampling weight to each X, of which

(til)

starting position is from 1 to Ln — Sly—1)] — 2502;] _1g,,,a, +1. To sum up,

we use Gibbs sampling to update new an“) 2a;1 as follows:

1 stewaw

Ina; +Zn,a) +141 ’1

 H ,\(i)—. 
jZl 60:1 rnﬂéﬁanJoJrj’l

3.4 Metropolis—Hastings sampling step for Sn
The base—(G+1) numeral vector s,,, of which dimension is $2— 1, allows
1+Zf§j (G+1)w states, which is usually a very large number. Thus, it is
difﬁcult to compute the normalization constant of P(snlan, (9n, CI>,,,R). We
will use the Metropolis—Hastings sampling to update s,(,i/ . In our case, the
Hastings ratio can be written as

_ P(sglaéi).®l’).ci>,§”.R)P(sf—“s;)

_ Pet—Wat”. an“). éé’).R)P (slat—15’

 

(8)

where P ($13,514)) is the proposal density, which speciﬁes the probability
of proposing a move to s; given the previous state sf—U and P (sf—1’3; )
is the ﬂipped case. The move is accepted, sna)=s;,, with the probability
min (1,2 ); otherwise, the move is rejected, séi)=s,§i_1).

In order to make the Markov chain ergodic and fast convergent, we design
ﬁve types of moves: rear insertion, rear deletion, partial shift, front insertion
and front deletion as shown in the Supplementary Figure 810. We denote
QC, 1 5 IC 5 5, as the probability to propose the corresponding type of move on
each MCMC step. For ease of presentation, the ﬁrst two types are clustered
into a group named rear indel and the last two types are clustered into a

group named front indel.

3.4.1 Rear indel moves The ﬁrst category of moves is to insert a repeat
unit from one of the (G+ 1) possible positions behind the last repeat unit
with proposing probability Q1 or to delete the last repeat unit with proposing
probability Q2. According to Equation (1), anm+zn 9(i71)_1+J—2 is the
ending position of the last repeat unit within Rn. Hencne, for the attempt of
rear insertion in the current iteration, we ﬁrst choose a possible position v in
nagginw—Laéiﬂz 1)+J—1+G], and then

calculate the Hastings ratio as follows:

the range of [anm+z n 90-,

J 2(1’)
/ anIanerjilsj Q2

J A(‘) ’
111.211)! 1Q1/(G+1)

rm,”er

 

(9)

_ g
)._8182

where g’=v— (Chin-rad g2(1'41)-I-.1—1).

For the rear deletion case, the last repeat unit within sn is located at
vzano ) +zn g2 (1'71) — 1, therefore the Hastings ratio is

 

J 2(‘)
A_ 1 magma Ql/(GH) (10)
— gnQUTlLi n1 é“) Q2 .
8182’ " i=1 ram-4131'

3.4.2 Partial shift moves This type of moves is to make a selected
subsegment, i.e. from the b—th repeat unit (b e [2, 52A) to the last repeat unit,
shifted left or right by up to a possible number with proposing probability
Q3. We randomly choose the order b in the range of [2, 52”], and then we
randomly choose the shift number it among all its possible values in the range
of [_ (Z1531) _Zn(,lb—_11) _J),G_ (Z1531) _Zn(,ll:_11) —J)], where the negative
number indicates left shifts and the positive number means right shift. The
Hastings ratio in this case is
A (i) _
J stew—1 "tatwﬁtigwwwi
1_Ij=1 I—Iwzb—l 
 HMO +jil+ll . (11)
9 .
J ali’ILI rmali’ﬁlfglhjel”
I—Ij211—Iw2b—1 aha) (i) (H)
man +Zn,w +jil

 

 

1 775

112 /§JO's12u1nofp101x0'sor112u1101urorq//zd11q 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Q.Li et al.

 

3.4.3 Front indel moves Similar to the rear indel moves, we design the
insertion moves, with proposing probability Q4, as adding a repeat unit from

a possible position v in the range of [anm —G—J,a,,(i) —J] in front of the

(/

ﬁrst repeat unit. If the move is accepted, we renew anl with v at the same
time. Also, we design the deletion move, with proposing probability Q5,
as removing the ﬁrst repeat unit within sn while renewing an“) with aéi)+
zéi;1)—1 if A Z 1. The corresponding Hastings ratios for the insertion case

and the deletion case are

J 2(1’)
/ anIanerjilsj Q5

 

 

8
128182 maggﬁi, Q4/(G+1)’ (12’
and J AU)
AZ: g1. TL=1fuiyujl Q4/a:+1), (,3)
8182mm 1) 1111:1951)“, _ ,j Q5
n,a,, +141

respectively, where g’ = v — (61,97 — G—J
For ease of presentation, Supplementary Figure S2 shows an example of
full state transition diagram for all s,,, 1 5 n 5 N.

3.5 Phase shifts

Although the collapsed sampler seems to work well in the MCMC algorithm,
it may face the phase problems (Lawrence et al., 1993), which gets BASARD
stuck in a local optimum. The solution is to compare the current A with
sets shifted left and right (Lawrence et al., 1993). We randomly choose a
reasonable number it and denote a 1 x N vector u with all elements equal to
it. Then, the Hastings ratio can be written as

 

_P(A+ulR,S) P(R|A+u.s)

pamg pmkg (m

We relocate the starting position of each repeat segment to position an + u
if the move is accepted.

4 RESULTS AND DISCUSSION

We design two experiments to evaluate our algorithm. The ﬁrst
experiment on synthetic data explores the convergence property
and the statistical performance of BASARD. This experiment also
answers the following question numerically: (i) how does the repeat
signal strength, in terms of the degeneracy degree of motif model and
the copy number of repeat segments, affect the power of BASARD
and other methods? (ii) how does the choice of prior distribution
affect the estimation accuracy of BASARD? (iii) how to choose the
pattern width within a range of plausible ones?

The other experiment on real data demonstrates the superiority
of BASARD over the existing methods to identify a short adjacent
repeat in exon III of the dopamine receptor D4 (DRD4) gene from
different mammalian species. All experiments are conducted on a
PC with 2.40G CPU and 4.00G memory.

4.1 Evaluation with synthetic data

4.1.1 Generating synthetic datasets We use synthetic data to
carry out the experiment so that we can use the known ground
truth to evaluate our algorithm. The synthetic DNA sequence set
R are sampled according to the generative model. It contains N
sequences of the same length L, each of which contains only one
repeat segment. The parameter values of S and A are independently

drawn from the following prior distributions: P(Qn) oc a?" , 52min 5

an samax; P(gn,w)o<s§"r.0:gn,w :G; and P(an)o<1.1:an 5

L—JSZn — Zilllgnw—l— 1. Here, we ﬁx 81 20.5, 82 20.5 and G:
2. All repeat units are generated using one of the six experimental
motif models listed in the Supplementary Table S2. The six motif
models are selected from JASPAR CORE Vertebrata database
(Bryne et al., 2008) such that they represent motifs of different
pattern width and degeneracy as measured by average entropy.
The average entropy is deﬁned as the average information content
(Schneider and Stephens, 1990) across all positions. Each motif
model is assigned one of the six abbreviations: 6L, 6M, 6H, 12L,
12M and 12H, where the preﬁx number indicates its pattern width
and the sufﬁx signs L, M and H denote low, medium and high
degeneracy degree, respectively. The background nucleotides are

mmmeo=mﬁoﬁoﬁoﬁf.

4.1.2 Convergence diagnosis We used the synthetic data to check
the convergence of our algorithm. Multiple independent chains
starting from randomly sampled parameter values were run. The
joint posterior probability was evaluated at each iteration. The joint
posterior probability evaluated at the true parameter values was
used as a reference. Details of this convergence diagnosis are given
in the Supplementary Material. It shows that all chains converged
fast to the reference value, which indicates that our algorithm has
satisfactory convergence property.

4.1.3 Statistical performance To assess the accuracy of
BASARD under different repeat signal strength, 12 categories
of datasets, where N :6 and L=2000, were synthesized. For
convenience, we denote L as the copy number ranges in [10,15]
and S as the copy number ranges in [5,10]. Combined with the
previous deﬁned abbreviation of motif model, the 12 naturally
combined categories can be represented as 12L—L, 12M—L, 12H—L,
12L—S, 12M—S, 12H—S, 6L—L, 6M—L, 6H—L, 6L—S, 6M—S and 6H—S.
Taking 12M—L as an example, the preﬁx sign 12M indicates that all
repeat units are generated by the motif model with abbreviation 12M
and the sufﬁx sign L means that the copy number 52,, E [10, 15] ,Vn,
in the dataset.

To quantify the accuracy of BASARD, we use the performance
metric F —score as it considers both the precision and the recall.
Precision is deﬁned as the number of actual repeat units that are
correctly estimated, divided by the number of all estimated repeat
units. Recall is deﬁned as the number of actual repeat units that
are correctly estimated, divided by the number of all actual repeat
units. F —score, which takes values between 0 and 1, is deﬁned as
2>1<precision>1<recall/ (precision—l—recall). The larger it is, the more
accurate the result is.

To demonstrate the superiority of BASARD, we compared it with
Tandem Repeats Finder [TRF, Benson (1999)] and Gibbs Motif
Sampler [GMS, Thompson et al. (2003)]. TRF is one of efﬁcient
and popular tools for detecting tandem repeats (Du et al., 2007) and
GMS is a classic motif discovery software. To compare them fairly,
we evaluated the results from all three methods at the nucleotide
level where each nucleotide was labelled as either an element of
repeat units or an element of background area.

For each of the 12 categories, we independently generated 100
datasets. For each of the 100 datasets, we ran all the three methods
and computed their individual precision, recall and F —score. The
detailed settings and results of BASARD, TRF and GMS are

 

1776

112 /810's12u1nofp101x0'sor112u1101urorq//zd11q 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting short adjacent repeats

 

 

 _ . . . . . . . . . . .

 _ . . . . . . . . . . . . . . . . . . . . . . . . . .

F—score

 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

 

0‘2 ' —e— BASARD

+ TRF
—€— GMS

0 I I I I I I I I I I \l
12L—L12M—Il2H—Ll2L—SIZM—SlZH—S 6L—L 6M—L 6H—L 6L—S 6M—S 6H—S

  

 

 

 

 

 

 

Fig. 1. The average F —score achieved by BASARD, TRF and GMS under
different repeat signal strength.

summarized in the Supplementary Tables S4 and S5 The average
F —score under different repeat signal strength are displayed in
Figure 1. It shows that the performance of BASARD generally
outperforms TRF and GMS in terms of estimation accuracy. When
the repeat signal strength is powerful enough like 12L—L, 12M—L and
12H—L, the statistical performance insigniﬁcantly differ from each
other. Weakening repeat signal strength leads to greater disparity
between BASARD and the other methods. It also shows that both
TRF and GMS are more sensitive to the degeneracy degree of motif
model than BASARD.

With the result from this experiment, we conclude as follows: (i)
BASARD performs better than TRF because TRF uses a window—
based method to search local enriched pattern for each sequence
without making use of the fact that the enriched pattern is also shared
by multiple sequences. (ii) BASARD consistently outperforms GMS
because BASARD considers that repeat units cluster round a local
neighborhood within each DNA sequence. This is mainly because
GMS is not designed for repeats detection, while BASARD is a
generalization of GMS to detect repeats. Neglect of local clustering
information results in lower efﬁciency and higher false positive rate,
e. g. GMS usually reports a remote pseudo motif instance.

In summary, in the scenario of short adjacent repeats detection,
we not only use the sequence motif model to detect the enriched
pattern in multiple sequences, but also consider such pattern is also
enriched in a local neighborhood within each sequence. It is the use
of the two levels of signal enrichment that makes BASARD perform
the best.

4.1.4 Sensitivity to priors and pattern width selection We again
used simulation on synthetic datasets to check the sensitivity of
BASARD to different prior distributions and discuss on the pattern
width selection problem. The details are given in the Supplementary
Material. The results show that the statistical power of BASARD is
reasonably insensitive to key prior choices. The experiments also
suggest that the information per parameter (Lawrence et al., 1993)
can be used to select the pattern width.

4.2 Experiment on real data

4.2.1 Introduction to the real data Schoots and To] (2003)
suggested functional implications in the size variation of the tandem

repeat in exon III in the human DRD4 gene. One explanation is that
the length of the tandem repeat modulates the level of expression of
DRD4, which is associated with cognitive function (Previc, 1999).

Larsen et al. (2005) and Mogensen et al. (2006) used TRF to
identify a tandem repeat composed of 18 bp basic units in exon III
of DRD4 from different mammals. However, TRF is not perfect
for such multiple sequence case because the information that all
input sequences share the same motif pattern cannot be utilized.
In addition, the output results have to be manually amended so as
to keep the consensus pattern and period size consistent with each
other.

We used BASARD to detect short adjacent repeats in exon III of
the DRD4 genes from different mammalian species. We retrieved
24 public available DNA sequences and their corresponding amino
acid sequences of the DRD4 exon III from GenBank. The detailed
information is given in the Supplementary Material.

4.2.2 Results Supplementary Table S6 summarizes the settings
of BASARD and TRF that were implemented in this experiment.
Important characteristics of those repeats detected by BASARD and
TRF are summarized in Table 1.

Both methods found that a repeat with pattern width 18 bp was
shared by all sequences. However, we have to use cyclic alignment
on the consensus patterns reported by TRF in order to really see their
similarity. Both BASARD and TRF pointed that the copy number
varied from about 3 in the bear family to about 20 in the horse
species. Different copy number variants were also detected even
in the same species such as sperm whale, minke whale, domestic
horse, donkey and onager. The average entropy of the motif model
is 1.0958, reﬂecting signiﬁcant sequence degeneracy across repeat
units. As the same as Larsen et al. (2005) and Mogensen et al. (2006)
observed, we also found the sequence motif is GC rich. For the cases
where TRF reported more copy numbers than BASARD did, it is
mainly due to the deletion inside those repeat units. Such deletion
case is not yet modelled by our current method.

One interesting discovery from this case study is that the short
adjacent repeat identiﬁed by BASARD could be classiﬁed to two
types of repeat segment structure, namely Type I and Type II. Asiatic
black bear, polar bear and domestic cat are of Type I where there is no
gap in repeat segments. All the other species shared structure Type
II where these are an extra repeat unit in the end of tandem repeat
segment. This observation probably implies the closer evolutionary
relationship between species who shared the same repeat segment
structure. As a matter of fact, the clade IV of the phylogenetic
tree shown in Murphy et al. (2001) veriﬁes this conjecture. Ursus
(e.g. bear) and Felis (e.g. cat) that belong to carnivora lineage had
repeat segment structure of Type I while Ceratotherium (e. g. whale,
dolphin and porpoise) and Equus (e.g. horse, donkey and zebra)
that belong to perissodactyla lineage had repeat segment structure
of Type II. It might indicate that this shared extra repeat unit was
gained or lost before the specialization of the studied species had
differentiated into these two different lineages.

We also ran BASARD on the corresponding amino acid sequence
set to detect the protein repeat motif. Supplementary Tables S6
and S7 summarize the settings of BASARD and the important
characteristics of the detected amino acid repeats. As a comparison,
Larsen et al. (2005) mentioned that they were unable to detect repeat
motifs in the deduced amino acid sequences from the two types of
bear and otter. However, BASARD reported 1 repeat unit for each of

 

1777

112 /810's12u1nofp101x0'sor112u1101urorq//zd11q 11101; pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Q.Li et al.

 

Table 1. The comparison of the repeats detected by BASARD and TRF

 

 

 

Species GenB ank accession BASARD TRF
number
Motif model Location Copy number Structure Consensus pattern Location Copy number

Asiatic black bear AB069664 134 — 187 3 Type I CGCCCCCCGAGGCCGTTG 131 — 197 3.7
Polar bear AY611807 89 — 142 3 Type I CGCCCCCCGAGGCCGTTG 86 — 152 3 .7
Gray seal DQ07 1548 u a “15 H 105 — 217 6 Type II CCGACCCCCGAGGCCATC 101 — 193 5 .2
Common raccoon AB069663 1 134 — 246 6 Type II CCCCGAGGCCGTCGCGAC 120 — 216 5 .6
European otter DQ029098 2.0 116 — 192 4 Type II CCCCCGAGGCCATCCAGA 116 — 167 2.8
Domestic cat AB069665  134 — 187 3 Type I CGCCCCCCGACGCCGTCG 131 — 183 2.9
Sperm whale AY615863 .n 97 — 209 6 Type II CCGCCCCCCGACGCCATC 93 — 188 5 .3
Sperm whale AY615864 5. o 74 — 204 7 Type II GCCCCCCGACGCCACCCC 40 — 183 8.2
Sperm whale AY615865 ﬂ 3. 88 — 236 8 Type II CCGCCCCCCGACGCCATC 84 — 215 7 .3
Minke whale AY615866 T 11:. 56 — 258 11 Type II CCGGCCCCCGACGGCAGC 52 — 237 10.3
Minke whale AY615867 a  56 — 348 16 Type II CCGGCCCCCGACGCCATC 52 — 327 15 .3
Domestic cow AB069666 9. 134 — 264 7 Type II CGGCCCCGCCCCCGACGC 93 — 228 7 .8
White beaked dolphin AB069666 m. n 56 — 276 12 Type II CCGGCCCCCGACGCCATC 52 — 255 11.3
Harbor porpoise AY615862 .1 J10 56 — 294 13 Type II CCGGCCCCCGACGCCATC 52 — 273 12.3
Domestic horse AB080626 .1 3::- 161 — 489 18 Type II CCGCCCCCCGACGCCACC 91 — 468 21.3
Domestic horse AB080627 .3 (H 161 — 471 17 Type II CCGCCCCCCGACGCCACC 91 — 450 20.3
Wild horse AB080628 ... 161 — 489 18 Type II CCGCCCCCCGACGCCACC 91 — 468 21.3
Donkey AB080629 HIS) 161 — 47 1 17 Type II CCGCCCCCCGACGCCACC 91 — 450 20.3
Donkey AB080630 “to 161 — 381 12 Type II CCGCCCCCCGACGCCATC 91 — 360 15 .3
Onager AB080631 n; 161 — 47 1 17 Type II CCGCCCCCCGACGCCACC 91 — 450 20.3
Onager AB080632 .3. n 161 — 435 15 Type II CCGCCCCCCGACGCCATC 91 — 414 18.3
Plains zebra AB080633 '-' 161 — 399 13 Type II CCGCCCCCCGACGCCATC 91 — 378 16.3
Gravys zebra AB080634 161 — 489 18 Type II CCGCCCCCCGACGCCACC 91 — 468 21.3
Mountain zebra AB080635 161 — 489 18 Type II CCGCCCCCCGACGCCACC 91 — 468 21.3

 

the bear sequence and 3 repeat units for otter. We also found the copy
number of amino acid sequences was usually one less than the copy
number of DNA sequences, especially for those which had repeat
segment structure Type II in the corresponding nucleotide sequence.
The reason is that the shared extra repeat unit had a 5 bp gap, not a
number divisible by length of codons 3. It was not surprising that the
copy number of two sperm whale, AY615863 and AY615865, was
only 1 after examining their nucleotide and amino acid sequences,
because there is an open reading frame shift occurring during the
translation process.

5 CONCLUSION

In this article, we expand the views of tandem repeats by introducing
short adjacent repeats. In order to handle gaps between neighboring
repeat units, we design a base— (G—l— 1) numeral vector data structure.
Also, we expand the scope of identifying short adjacent repeats
to multiple DNA sequences, by relaxing the implicit assumption
of a single DNA sequence in existing methods. This is helpful
for analyzing the relationship among input sequences, e. g. DNA
sequences of different species in the course of evolution.

To detect short adjacent repeats, we introduce a full probabilistic
generative model to model repeats in multiple sequences. In this
article, we only considered the case where each sequence contains
only one repeat segment. If there are indeed more than one repeat
segment in one sequence, BASARD is likely to report the most
probable one. It is also possible that no repeat segment exists in
some sequence. In this case, BASARD might report a repeat segment
made up of only one repeat unit and its starting position might

vary randomly. In order to help exclude this kind of false positive,
BASARD also reports the signiﬁcance level of each estimated repeat
unit, i.e. the P—value of such repeat unit under the background
distribution. If the P—value is larger than a prespeciﬁed threshold, it is
recommended to deny the corresponding estimated repeat units and
conclude that the corresponding sequence actually does not contain
the repeat pattern. Similar to the motif discovery problem in Liu
et al. (1995), our algorithm can be extended to allow multiple repeat
segments per sequence by introducing an indicator vector for each
sequence, 8,, = [5&1 5,1,2 ... é“an ], 1 5 n 5N. The binary variable
5,1,; = 1 indicates that a repeat segment occurs from position I within
the n—th sequence; otherwise 51,120.

We introduce a Bayesian approach to detect short adjacent repeats
in a de novo fashion. To improve computing efﬁciency, we use a
collapsing technique to reduce the dimension of the parameter space.
After the MCMC chain converges, the sampled parameter values
give us a whole picture of their joint posterior distribution. In the end,
we demonstrate the effectiveness of BASARD through experiments
on both synthetic data and real data.

The Bayesian model and its Metropolis—in—Gibbs sampling
strategy for identifying short adjacent repeats in multiple sequences
can ﬁnd many applications, not only in areas of biology, but also in
other ﬁelds. Our work takes the initial step to enable this repeat
identiﬁcation across multiple sequences and serves as a call for
participation. Many interesting and important directions are worth
exploring. For example, our work is limited by not allowing intraunit
insertions and deletions. We might refer to motif discovery work by
Gupta and Liu (2003) to deal with this kind of variations. Same
as most existing purely likelihood—based methods, the length—bias

 

1778

112 /810's12u1nofp101x0's31112u1101urorq//:d11q 11101; pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting short adjacent repeats

 

phenomenon (Hoh et al., 2002) may affect BASARD’s results. This
problem is less serious for evolutionary study because the sequences
are usually of similar length, but further studies may be needed
when sequence lengths are substantially different from each other.
Another question is how to further improve the convergence rate and
to escape from local optima. Xu et al. (2010) used parallel computing
techniques, such as evolutionary Monte Carlo method, to deal with
this computing problem and achieved some encouraging results.

Funding: Research Grants Council of the Hong Kong SAR (Project
no. CUHK 400709); CUHK direct grant (Project no. CUHK
2060362).

Conﬂict of Interest: none declared.

REFERENCES

Benson,G. ( 1999) Tandem repeats ﬁnder: a program to analyze DNA sequences. Nucleic
Acids Res., 27, 573—580.

Bryne,J.C. et al. (2008) JASPAR, the open access database of transcription factor-
binding proﬁles: new content and tools in the 2008 update. Nucleic Acids Res., 36,
D102—D106.

Buchner,M. and J anj arasjitt,S. (2003) Detection and visualization of tandem repeats in
DNA sequences. IEEE Trans. Signal Process, 51, 2280—2287.

Butler,J.M. et al. (1997) STRBase: a short tandem repeat DNA internet-accessible
database. In Proceeding of the 8th International Symposium on Human
Identiﬁcation. Promega, Scottsdale, Arizona, USA, pp. 38—47.

Du,J. et al. (1997) Analysis of immunoglobulin Sgamma3 recombination breakpoints
by PCR: implications for the mechanism of isotype switching. Nucleic Acids Res.,
25, 3066—3073.

Du,L. et al. (2007) OMWSA: detection of DNA repeats using moving window spectral
analysis. Bioinformatics, 23, 631—633.

Gelman,A. et al. (2004) Bayesian Data Analysis. Chapman & Hall/CRC, New York,
USA.

Gupta,M. and Liu,J.S. (2003) Discovery of conserved sequence patterns using a
stochastic dictionary model. J. Am. Stat. Assoc., 98, 55—66.

Gupta,R. et al. (2007) A novel signal processing measure to identify exact and inexact
tandem repeat patterns in DNA sequences. EURASIP J. Bioinformat. Syst. Biol.,
p. Article ID 43596.

Hoh,J. et al. (2002) The p53MH algorithm and its application in detecting p53-
responsive genes. Proc. Natl Acad. Sci, 99, 8467—8472.

Krishnan,A. and Tang,F. (2004) Exhaustive whole-genome tandem repeats search.
Bioinformatics, 20, 2702—2710.

Larsen,S.A. et al. (2005) Identiﬁcation and characterization of tandem repeats in exon
III of dopamine receptor D4 (DRD4) genes from different mammalian species. DNA
Cell Biol, 24, 795—804.

Lawrence,C.E. et al. (1993) Detecting subtle sequence signals: a Gibbs sampling
strategy for multiple alignment. Science, 262, 208—214.

Li,Q. et al. (2010) Bayesian approach for identifying short adjacent repeats in
multiple DNA sequences. In Proceedings of the 2010 International Conference
on Bioinformatics and Computational Biology (BIOCOMP ’10), Vol. 1, Las Vegas,
Nevada, USA, pp. 255—261.

Liu,J.S. et al. (1995) Bayesian models for multiple local sequence alignment and Gibbs
sampling strategies. J. Am. Stat. Assoc, 90, 1156—1170.

Lu,Q. et al. (1993) (CT)n (GA)n repeats and heat shock elements have distinct roles
in chromatin structure and transcriptional activation of the Drosophila hsp26 gene.
Mol. Cell. Biol., 13, 2802—2814.

Mogensen,L. et al. (2006) Identiﬁcation and characterization of a tandem repeat in
exon III of the dopamine receptor D4 (DRD4) gene in cetaceans. J. Heredity, 97,
279—284.

Murphy,W.J. et al. (2001) Molecular phylogenetics and the origins of placental
mammals. Nature, 409, 614—618.

Previc,F.H. (1999) Dopamine and the origins of human intelligence. Brain Cognit, 41,
299—350.

Sagot,M.F. and Myers,E.W. (1998) Identifying satellites and periodic repetitions in
biological sequences. J. Comput. Biol., 5, 539—553.

Schneider,T.D. and Stephens,R. (1990) Sequence logos: a new way to display consensus
sequences. Nucleic Acids Res., 18, 6097—6100.

Schoots,O. and Tol,H.H.M.V. (2003) The human dopamine D4 receptor repeat
sequences modulate expression. Pharmacogenomics J., 3, 343—348.

Sharma,D. et al. (2004) Spectral Repeat Finder (SRF): identiﬁcation of repetitive
sequences using fourier transformation. Bioinformatics, 20, 1405—1412.

Sinden,R.R. (1999) Biological implications of the DNA structures associated with
disease-causing triplet repeats. Am. J. Hum. Genet, 64, 346—353.

Siyanova,E.Y. and Mirkin,S.M. (2001)Expansion of trinucleotide repeats. Mol. Biol.,
35, 168—182.

Sokol,D. et al. (2007) Tandem repeats over the edit distance. Bioinformatics, 23,
e30—e35.

Sutherland,G.R. and Richards,R.I. (1995) Simple tandem DNA repeats and human
genetic disease. Proc. Natl Acad. Sci, 92, 3636—3641.

Thompson,W. et al. (2003) Gibbs recursive sampler: ﬁnding transcription factor binding
sites. Nucleic Acids Res., 31, 3580—3585.

Weber,J.L. and May,P.E. (1989) Abundant class of human DNA polymorphisms which
can be typed using the polymerase chain reaction. Am. J. Hum. Genet, 44, 388—396.

Xu,J. et al. (2010) An evolutionary Monte Carlo algorithm for identifying short adjacent
repeats in multiple sequences. In Proceeding of the 2010 International Conference
on Bioinformatics and Biomedicine (BIBM’IO). Hong Kong, pp. 643—648.

Zhou,H. et al. (2009) Detection of tandem repeats in DNA sequences based on
parametric spectral estimation. IEEE Trans. Informat. Technol. Biomed, 13,
747—755.

 

1 779

112 /810's12u1nofp101x0's31112u1101urorq//:d11q 11101; pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

