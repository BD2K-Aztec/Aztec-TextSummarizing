Bioinformatics, 31 (20), 2015, 3290—3298

doi: 10.1093/bioinformatics/btv379

Advance Access Publication Date: 25 June 2015
Original Paper

 

Gene expression

biRte: Bayesian inference of context-specific
regulator activities and transcriptional networks

Holger Frohlich

University of Bonn, Institute for Computer Science, Romerstr. 164, 53117 Bonn, Germany

Associate Editor: Igor Jurisica

Received on February 3, 2015; revised on May 13, 2015; accepted on June 15, 2015

Abstract

In the last years there has been an increasing effort to computationally model and predict the influ—
ence of regulators (transcription factors, miRNAs) on gene expression. Here we introduce biRte as
a computationally attractive approach combining Bayesian inference of regulator activities with
network reverse engineering. biRte integrates target gene predictions with different omics data
entities (e.g. miRNA and mRNA data) into a joint probabilistic framework. The utility of our method
is tested in extensive simulation studies and demonstrated with applications from prostate cancer
and Escherichia coli growth control. The resulting regulatory networks generally show a good

 

OXFORD

agreement with the biological literature.

Availability and implementation: biRte is available on Bioconductor (http://bioconductor.org).

Contact: frohlich@bit.uni—bonn.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Gene regulation is one of the most important biological processes in
the living cell. Its malfunctioning is directly associated with many
human diseases. Transcription factors (TFs) are one of the most rele—
vant drivers of mRNA expression. In addition, miRNAs can degrade
or inhibit translation of target mRNAs on the post—transcriptional
level. Thus both, TFs and miRNAs, inﬂuence mRNA concentration
jointly together in complex networks.

Based on existing TF and miRNA target gene prediction methods
during the last years there has been an increasing effort to computa—
tionally model regulatory networks and draw conclusions about
context specific regulator activities (Engelmann and Spang, 2012;
Geeven et 61]., 2012; Lim et 61]., 2009; Setty et 61]., 2012). Geeven et
al. (2012) also considered statistical interactions between regulators,
which they depicted as networks. In our earlier publication we
devised BIRTA as a method, which combines miRNA and mRNA
expression data into a joint probabilistic model to infer condition
specific activities of TFs and miRNAs (Zacher et al., 2012). BIRTA
is formulated in a Bayesian regression framework and uses a
so—called spike and slab prior (George and McCulloch, 1997) to
infer probabilities of activation for transcription factors and

miRNAs in a sparse manner. BIRTA does not support statistical
interactions between regulators.

Independent of the question to predict context specific regulator
activities, structure learning of gene regulatory networks directly from
expression data has been widely studied (Friedman et 61]., 2000;
Huynh—Thu et 61]., 2010; Margolin et 61]., 2006; Sachs et 61]., 2005).

In this article, we introduce biRte as a combined approach to
estimate context specific regulator activities and networks between
these regulators. biRte first uses a significant improvement of
BIRTA to infer activities of regulators and their statistical inter—
actions from expression data and target gene predictions. A key dif—
ference to BIRTA is a computationally efficient analytical
marginalization of regression coefficients, which yields far better
prediction performance and 10—15 fold less computation time. After
estimation of active regulators, biRte employs Nested Effects Model
(NEM) (Markowetz et 61]., 2005) structure learning to infer the asso—
ciated transcriptional network. A key difference to many existing
methods at this point is that our approach does not rely on direct
mRNA measurements of regulators, but employs information of dif-
ferential expression of downstream target genes.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3290

9mg ‘09 1sn3nv uo sopﬁuv soq ‘BIUJOJIIBD aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; popeommoq

biRte

3291

 

2 Overview about biRte

The minimum input to biRte consists of (differential) gene expres—
sion data together with a genome—wide regulator—target gene net—
work. Based on that biRte addresses two goals (Fig. 1):

1. Estimation, which regulators (miRNAs, TFs and possibly other
factors) exhibit a signiﬁcant inﬂuence on the expression of their
target genes in a speciﬁc biological context. We call a regulator
active, if such a signiﬁcant inﬂuence is present and inactive
otherwise. biRte also supports the inference of statistical two—
way interactions between regulators.

2. Estimation of the network between active regulators based on
observed nested subsets of differentially expressed target genes.

Besides gene expression data biRte can make use of direct regulator
measurements (e.g. miRNA expression), if available. Gene expres—
sion data of transcription factors is treated specially: differential
expression of these factors may indicate positive evidence that the
respective regulator has a different activity in one compared to an—
other experimental condition. This positive evidence can be
exploited in the integrated likelihood model of biRte.

3 BiRte step I: estimation of active regulators

3.1 Likelihood model for data integration

In order to estimate the active influence of regulators on gene
expression a sufficient likelihood model is required. The basic intu—
ition behind our likelihood model is two—fold:

° If the set of active regulators is already known, then mRNA
expression can be predicted from regulator activities via a sparse
linear model.

° We do not assume a direct correlation between the expression level
of regulators and mRNA. However, we suppose that in case a regu—
lator is active in one and inactive in another condition, then there
should be an observable shift of the expression level of the regulator
itself. In other words, differential regulator expression increases the
likelihood to obtain differential activity between two conditions.

Let nmRNA be the set of all measured mRNAs. With biRte we assume

that these mRNAs have been measured in C conditions (in our
required optional

° Regulator measurements
0% (e.g. miRNA, TF expression)

° Regulator-regulator

 

mRNA data

G
differentially

Re ulator - -
expressed genes ngtw rky InteraC‘L'lonS
e O _ ° prior beliefs on regulator
(genome-Wide) activities

 

ll

Bayesian inference of regulator activities
° condition speciﬁc
- explanation of log fold changes

Jr

I Active regulators I

Network reverse
engineering

Fig. 1. Overview about biRte features and the associated workflow

 

 

 

 

 

 

software C32) with RmRNA replicates. Let 0 be the set of all resulting
mRNA expression levels (after appropriate normalization and trans—
formation of data). Let A denote the set of all miRNA expression lev—
els with RmiRNA being the respective number of replicates per
condition. Possibly further available TF expression data is denoted by
T and other data (e.g. CNVs) by Z. The notation for the number of
measured molecular entities and replicates is done in consistency with
the previously introduced notation for mRNAs and miRNAs.

In our model we distinguish between hidden regulator states
(active vs. inactive) and observable measurements. We denote the
set of all available experimental data as D here. Given the set of
active regulators R = {R1, R2, ..., RC} in each experimental condi-
tion (6 : 1, 2, ..., C) (which is equivalent to knowing the hidden vari—
ables) together with further model parameters ® we decompose the
likelihood of D as:

LD,®(R)=p(DIR.®)= H Ammo) <1)
De{o,A,T,Z}

‘ 13
nD R,

C
: H  

De{o,A,T,Z} c=1 i=1 r=1

where 15,-,5 is the ith feature and the rth replicate measured under
condition 6 in data type 

This formulation is slightly more general than the one used in
Zacher et al. (2012). It allows for including further data types (Z)
and captures the situation that relative expression (log fold changes)
are measured. In this case C = R? = 1. Using relative expression
data allows to apply biRte to arbitrary complex statistical designs.

Let T(A) denote the target genes of regulator A. Two—way inter—
actions between regulators A, B can be formally introduced as add—
itional regulators A : B that only target genes lying within
T(A) ﬂ T(B). Since the number of potential two—way interactions
scales quadratically with the number of regulators, in practice we
only consider A : B, if W lies within a defined range (default:
0.1 to 0.8).

Next we specify, how the data specific (marginal) likelihoods
[)(DWUZC, @) are computed.

3.2 Marginal likelihood for mRNA expression
In agreement with our previous paper each observed mRNA meas—
urement is assumed to be determined by the set of active regulators:

M%WMfFMm+Z%M) m
qERci

were RC,- denotes the set of active regulators of gene 1'. The equation
can be interpreted as a linear regression with coefficients (0,16 and
intercept woe. The formulation assumes a constant noise variance for
all genes, which can be achieved after appropriate scaling of the data.

In contrast to our previous paper (Zacher et 61]., 2012) regression
coefficients in biRte are not sampled, but marginalized out analytic—
ally: Let p :2 |RC| and we 2: [(005, (01C, ..., cop]. Let 0 be the vector of
expression values for a particular replicate r under condition 6. Then
E[0|Xp,a)5] = Xpwc, where Xp is a nMRNA x (p —I— 1) design matrix
(the first column is constantly 1 for the intercept). Using conjugate
priors V N IG(ao, b0) and tech/2 N N (0, V2271) the marginal distri-
bution p(o|RC) : p(o|Xp) (also called model evidence) can be writ—
ten down in closed form (Gelman et 61]., 2004):

1 detUtI) b30F(a,,)
(ZnymRNA/Z det(XgXp + M) bZ"F(a0)

 

P(0|Xp) = (4)

91% ‘09 1sn3nv uo sojoﬁuv soq ‘BIUJOJIIBD aIo Amie/xtqu 112 /B.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

H. Frb'hlich

 

 

3292
mRNA
a, = a0 + " 2 <5)
1 T T T
b, = b0+i<o o—un(xpxp+11)p,,) (6)
11,, = (xgxp + 21)_1X;o (7)

Let 5:: det(X;Xp +21). Then the log marginal likelihood is
given as:

logp(o|Xp) o< —%log 5 + aolog b0 — anlog 19,, + log Han) — log F(a0)
(8)

We thus have to efficiently compute the determinant f and the ma—
trix inverse of Cp 2: (XgXp —l— M) in order to make the approach
practically feasible. Here we address this problem via a Cholesky
decomposition Cp : RTR, where R is an upper triangular matrix:

Since logf :ZZilog|R,-,-| Cholesky factorization allows to effi—

ciently calculate the log determinant. Moreover, C171 : R_1(R_1)T.
Note that inversion of the triangular matrix R can be done quickly
via back—fitting.

3.3 Marginal likelihood for miRNA expression and other
experimental data

Let us assume C = 2, where—without loss of generalization—c : 1
denotes a reference condition. We distinguish two situations: In one
miRNA i has switched its activity between c: 1 and c :2. In that
case we use two Gaussian distributions to model expression levels.
In the other case miRNA i has not switched, and we use only one
Gaussian distribution. The resulting one—way ANOVA model is thus

N(Vi0 + V17 0'12) C = 2A

[)(AWUZC, 01-2) : ihas switched . (9)

N (yio , 01-2) otherwise

where yio and y,- are parameters, which describe the mean expression
and log fold change of miRNA 1', respectively. The equation should
be interpreted in a probabilistic sense: If a miRNA is differentially
expressed, then the chance increases that it also exhibits a measur—
able influence on its target genes. Vice versa non—differential expres—
sion lowers that chance.

If we assume 0,2 N IG(oc, B), the marginal likelihood p(A,-,C|RC)
: p(AAirC|Xp) can be calculated in analytical form:

F(a-+%) 1 1

P(Airc|Xp) : F i a %
(0C) (Zﬂﬂ) <1 +21ﬁ(‘uic _Airc)2> +

(10)

 

where  is the gamma function and ,uic : yio —l— 12,-, if the first con-
dition in Equation (9) holds and yio, otherwise. Although this mar—
ginal likelihood has been already derived in Zacher et al. (2012) it is
not used in BIRTA.

The same strategy as described here for miRNAs can be applied
to experimental data of other regulatory factors, if available. More
specifically, one may use mRNA data of differentially expressed TFs
to support evidence for their conditions specific activity on protein
level. The idea is that differential gene expression of a TF increases
the chance that there is a measurable difference in the inﬂuence on
target genes, while the opposite can generally not assumed to be

true. Accordingly, for TFs we define a model following Equation
(10) for differentially expressed TFs only.

3.4 Bayesian variable selection

In order to allow for variable selection we need to make our model
sparse. There exists a large amount of literature on Bayesian variable
selection methods. One possibility that we also followed in our pre—
vious BIRTA model is the spike and slab prior (George and
McCulloch, 1997):

wcplncpwz ~ (1 — “c1050 + ncmewZA—l) (11)

where 50 denotes a point mass at 0, nap N Bernoulli(pcp)(p : 1, ..., N)
and f1 is large. N is the total number of possibly active regulators.
One advantage of the spike and slab prior compared to a lasso type
prior is a selective shrinkage of model coefficients. That means
model coefficients for selected variables are only mildly pushed
towards zero and thus estimates are less biased compared to a lasso
prior (Hernandez—Lobato et 61]., 2010). Another advantage of the
spike and slab prior is that sparsity can be controlled in a variable
dependent manner via parameters pap. Here prior knowledge can be
integrated: For each regulator we can encode the prior belief that it
is active.

3.5 Model fitting via MCMC

3.5.1 General idea

In Section 3.2 we showed that regression coefficients can be effect—
ively marginalized out while estimating model evidence. In biRte we
are thus left with estimating the condition specific hidden state vari—
ables TEC :2 (ncp)p:1mN. For that purpose we use a stochastic sam—
pling scheme based on Markov Chain Monte Carlo (MCMC). More
specifically, we define two possible move types:

° switch: a regulator switches from active to inactive state within
randomly picked condition 6

° swap: an inactive regulator and an active regulator exchange
their activity states within randomly picked condition 6.

In practice we restrict swap operations to regulators showing a sig—
nificant overlap of regulated targets.
We formally accept an MCMC move with probability

_ . P(DIX,22601903606102“WSW)
h ‘ mm (1’ Mix. n21d>p<n21d>q<eewln21d> (12)

 

new old
6 and no

correspond to the old and new miRNA and TF
state configurations, respectively, and X is the full nMRNA x (N —l— 1)

where TE

design matrix. Please note that inclusion of the proposal distribution

q is necessary, because the swap operation induces non identical

new

6 and vice versa.

probabilities to reach ngld from TE
In conclusion the MCMC algorithm allows for estimating for
each regulator and condition the posterior probability to inﬂuence

the expression of its target genes.

3.5.2 Efficient update of marginal likelihood

One of the major differences of biRte vs. BIRTA is the analytical
marginalization of regression coefficients in Equation (3). This in
turn requires updates of the design matrix X and the determinant 5
after each MCMC move. To make these updates computationally
feasible we can exploit the fact that only the design matrix Xp re-
stricted to active regulators needs to be updated. When a switch or
swap operation is performed a column in Xp is added, removed or

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u103up23 310 [(1319111qu 112 /B.IO'S[BU.IHO[p.IOJXO'SOUBIHJOJUIOIQ/ﬁ(1111] 11101; pop1201umoq

biRte

3293

 

exchanged. Let X; denote our updated design matrix, then the dif-
ference in the marginal log likelihood for mRNA data is given by:

) 1
103P(0|Xp) —103P(0|Xp) = §(10g5—10g5')+ 6111003 bn — 108 19:1)
(13)
Based on Section 3.2 it is sufficient to update the Cholesky factor R
of Cp : XgXp +21 in order to compute this formula efficiently:

Suppose we add a column V to Xp, i.e. X; : Xp+1 : [Xp, V]. We are
interested in the updated Cholesky factor R’. Note that

C, xTv RTR xTv
C, = < p > = < p (14)
VTXp VTV —l— 2 VTXp VTV —l— 2
According to the Schur complement and block—wise matrix inver-
sion lemmas we can decompose (X/TX’ —1— 2I)_1 as:

—1

RTR XEV I —R-1(RT)—1x;v
VTXp VTV —l— 2 0 I
R-1(RT)—1 o I 0

0 1/5 VTXp(R_1)TR—1 1

R-1 —R-1(RT)—1x;v/(/5

o 1/1/5
(R—1)T o

—vTXp(R-1)TR-W5 1N5

1(RI—1)T

: R"
where (3 :2 VTV —l— 2 — VTXPR_1(RT)_1X;V : VTV —l— 2 — VTUUTV.
Hence, R/_1 can be updated efficiently according to the block—wise
matrix decomposition indicated in the third line, and R’ is computed
from RT1 via back-fitting. If the last column is deleted in Xp, the
whole procedure has just to be done in reverse order. However, if an
arbitrary column 132 < p is removed, one would have to re—tri—
angulate R’, e.g. via Householder reﬂections. This is, however, com—
putationally not beneficial compared to just re—calculating the
Cholesky decomposition of matrix C; after removal of column E
and row E.

3.6 Posterior inference

Inference about active regulators based on MCMC samples can be
done in different ways. One method is to return the configuration
with highest posterior probability among all sampled ones. Another
possibility is to look at the marginal selection frequencies during
sampling and filter those above a defined cutoff t. The arising ques—
tion is, how such a cutoff could be chosen. We here implemented a
method that we recently proposed in the context of Bayesian
Network learning (Frohlich and Klau, 2013). Briefly the idea is to fit
a beta mixture model to the observed regulator frequency profile.
Based on this mixture model it is possible to select ‘5 such that the
expected false positive detection rate is below a defined cutoff
(e.g. 0.1%).

3.7 Hyperparameter settings

Our model contains a few hyper—parameters that need to be speci—
fied. These include parameters for the variance priors (or, ﬂ,ao, [90),
which biRte estimates in an empirical Bayes sense via maximum
likelihood from the global distribution of empirical variances

(separately for each data type). The method is taken from Venables
and Ripley (2002) and implemented in the R—package MASS.

Following (Hernandez—Lobato et 61]., 2010) we set 2: 1 in
the spike and slab prior. Moreover, yio is set to the average expres—
sion level in the reference condition, and y,- to the median log fold
change of differentially expressed regulators (separately for each
regulator type and for up— and down—regulation). This procedure
was chosen in order to reduce false positive predictions of regulator
activities.

4 BiRte step ll: network inference

After having determined active regulators one may ask, in which
way these regulators influence each other. Established methods,
such as Bayesian Networks, would usually require direct measure—
ments of regulators, which are at least difficult to obtain for TFs.
Moreover, the typically small sample size imposes a principal limita-
tion. In biRte we thus restrict ourselves to subset relationships be—
tween differentially expressed target genes. These subset
relationships can express biologically interesting properties: Suppose
regulator A to act upstream of regulator B. There is a certain subset
set of target genes E A, which is only affected by A. However, be—
cause A is upstream of B, A also inﬂuences target genes EB of B (Fig.
2). This might happen, because A activates or deactivates B on pro—
tein level and only B itself influences EB. Another possible mechan—
ism is that A and B together modulate expression of EB in a
combinatorial fashion. Both mechanisms are not distinguishable
without further experiments and thus the schema in Figure 2 com-
prises both of these situations. Our task is to infer the correct wiring
of the network from observable differential expression of target
genes as well as target gene predictions for individual regulators.

The whole idea has striking similarities to Nested Effects Models
(NEMs) (e.g. Frohlich et 61]., 2011; Markowetz et 61]., 2005), which
have been introduced for causal network inference from perturb-
ation data. Although in our case we do not have targeted perturb—
ations of individual regulators, probabilistic inference of subset
relationships between differentially expressed targets of regulator
pairs can be done effectively via existing NEM structure learning al-
gorithms. For the sake of simplicity we here explain the idea of the
pairwise NEM inference algorithm discussed in Markowetz et al.
(2007): Let n = |EA| + |EB| and E e {0,1}"X2. We set E121, if
gene 1' is differentially expressed and a predicted target of regulator
[2, otherwise Eik : 0. Let us further assume we know certain type I
and type II error rates 01, B that occur while declaring differential
gene expression. Let H be one of the four possible hypotheses
{A —> B,A <— B,A <—> B,A..B}, where A..B means no edge / subset
relationship. In order to score H we are interested in the marginal
likelihood of our observations E:

I I
I I
I I
v V
EA EB
Fig. 2. Idea behind regulatory network inference: Regulator A influences

genes EA and EB, whereas Bonly targets E3. The model thus represents a sub-
set relationship between target genes of A and B

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 310 [(1319111qu 112 /B.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁ(1111] 11101; pop1201umoq

3294

H. Frb'hlich

 

ﬂ

P(EIH) = P(E.-).IH.6.- =0p<e =1) (15)

iE{A,B,null} i=1 k€{A,B,null}

where 0,- is a parameter that indicates whether E,- is attached to regu—
lator j. In Equation (15) we marginalize over all possible attachment
positions, possibly weighted by a prior (which is set uniform in the
default case). While doing so we consider an additional dummy
node null which is unconnected to A, B. This trick allows for effect—
ive removal of target genes that react unspecifically (Tresch and
Markowetz, 2008).
The local likelihoods P(E,—k|H, 0,- : j) are defined as:

1 — B if edge/e —> j exists
P(Eik:1|H)0i:I): { . (16)
or otherw1se
and P(E,—k = 0|H, e,- = j) = 1 — P(E,—k = 1|H, e,- = j).

The algorithm selects for each regulator pair A, B the one with
maximum marginal likelihood. Afterwards the transitive closure of
the resulting graph is returned. We refer the reader e.g. to Frohlich
et al. (2009) for a detailed overview and empirical study of different
NEM structure learning approaches. In the biRte software package
the user has full access to all methods implemented in R—package
nem (Frohlich et 61]., 2008).

5 Software

biRte is available as a Bioconductor R—package. To ease the analysis
of relative expression levels the software offers appropriate interface
functions to limma (Smyth, 2004) and thus allows to be applied for
arbitrary complex statistical designs. Since biRte relies on the
assumption of multivariate normally distributed data we recom—
mend the limma-voom mechanism for RNA—seq data (Law at 61].,
2014)

Notably biRte optionally allows for grouping regulators with
highly similar target gene sets (being unlikely to be distinguishable)
into clusters in a pre—processing step (see details in Supplements). In
the subsequent network analysis clusters are automatically decom—
posed into individual regulators.

6 Simulation results

6.1 Active regulators and regulator interactions

In order to gain insights into the principal behavior of our model we
conducted several simulations. In a first simulation study we com—
pared biRte to our previous BIRTA method (Zacher et 61]., 2012), to
GEMULA (Geeven et 61]., 2012) as well as to a hypergeometric
test (Lim et 61]., 2009) with multiple testing correction via the
method by Benjamini and Yekutieli (2001). This was done on the
basis of a human regulatory sub—network and accordingly simulated
expression data of 900 target genes (details in Supplements). In
order to have a fair comparison we here applied GEMULA, biRte
and the hypergeometric test such that they used the same set of
potentially relevant two—way interaction terms (see Supplements).
BIRTA does not support inference of regulator—regulator
interactions.

Supplementary Figures S1—810 depict the quality of regulator
activity predictions for different fractions of false positive and false
negative target gene predictions, i.e. erroneous edges in our regula—
tory network. Results are shown for 20 simulation repeats in terms
of partial area under ROC curve (for a specificity cutoff of 90%)
and Brier scores (i.e. average squared differences between probabil—
istic predictions and indicators of true regulator activities).

Overall the results indicate a significant improvement of biRte com—
pared to all competing methods. For miRNAs pAUCs are typically
close to 1 and Brier scores close to 0, even for the highest levels of
false positives and negatives. TF predictions react more sensitive, be—
cause TFs typically have fewer target genes than miRNAs in our net-
work. As expected, prediction of regulator—regulator interactions is
most challenging for all compared methods. We observed 10—15
fold speed—up of biRte compared to BIRTA and GEMULA
(Supplementary Fig. S1 1).

6.2 Network inference

In a second round of simulations we compared the network recon—
struction used in our biRte approach to Bayesian Networks (BN)
(Friedman et 61]., 2000), ARACNE (Margolin et 61]., 2006), GENIE3
(Huynh—Thu et 61]., 2010) and GeneNet (Opgen—Rhein and
Strimmer, 2007) on 10 randomly selected regulatory sub—networks
of Escherichia coli and 20 correspondingly simulated datasets per
network (details in Supplements). For BN structure learning a
greedy hill climber using the BGe score was employed. For BN as
well as for ARACNE we investigated additionally the effect of a
data discretization into three 3 bins using the information theoretic
approach by Hartemink (2001). Accordingly, for BN the BDe was
used to score candidate networks for discretized data. For biRte the
assumed type I and type II error rates for differential expression
detection were fixed to 0.05 and 0.1, respectively. GENIE3 returns
an edge weight matrix. We transformed these edge weights into
z—scores and then selected all edges with P < 0.1. For GeneNet we
returned all edges (ignoring directions) with FDR < 10%.
Accordingly, GeneNet here only detects the existence of an edge,
regardless of direction. This was appropriately taken into account
while counting false positive predictions, when comparing the
inferred network against the true one. Likewise, for BNs the
CPDAG and for biRte the transitive closure of the original network
was considered as reference. That means a predicted edge was only
counted as false positive, if it was not contained into the respective
equivalence class of the true network.

We conducted our comparison for different fractions of false
positive and false negative target genes (Supplementary Figs S13—
S16), number of replicates r (Supplementary Figs 813 and 517—519),
total number of downstream targets m (Supplementary Figs S13,
S20 and S21) as well as number of network nodes 11 (Supplementary
Figs 813 and 822—824). For n > 15 nodes ARACNE and BN on dis—
cretized data became infeasible slow, so they had to be omitted.

The boxplots in all cases show a clear advantage of biRte’s net—
work reconstruction, which uses subset relationships between differ—
entially expressed target genes. The computation time varied
between less than 1 second (15 nodes, Supplementary Fig. S24) and
30 seconds (60 nodes, Supplementary Fig. S27), which makes the
approach practically highly feasible. biRte showed a highly robust
behavior against false positive and false negative target gene predic—
tions, given a sufficient amount of target genes. Sensitivities and spe—
cificities stayed in all cases close to 1. As expected, increasing the
number of replicates from 5 to 10, 20 and 30 yielded a small
improvement of all competing methods, because they directly use
expression data of regulators. Decreasing the number m of total tar—
get genes from 450 to 150 on average led to a decrease of sensitivity
to around 80% for biRte, but in single cases (e.g. network 4) the
effect was stronger. Increasing the number n of network nodes from
15 to 30, 40 and 60 lead to a decrease of sensitivity for all methods.
However, even for n = 60 biRte with 5 replicates still achieved a sen—
sitivity of around 60% at a specificity close to 1.

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 aIo Amie/xtqu 112 /B.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pop1201umoq

biRte

3295

 

7 E.coli growth conditions

We investigated a microarray dataset by Covert et al. (2004) together
with a filtered TF—target graph (Castelo and Roverato, 2009). The
gene expression data comprises three replicates from E.coli during
aerobic growth and four replicates during anaerobic growth. The TF-
target graph contains annotations for 160 transcription factors. The
data are also contained in the vignette of the biRte R package.
Potential two—way interaction terms between regulators were selected
such that the overlap of target genes was between 10 and 80%.

Limma analysis yielded 224 differentially expressed genes
(FDR<5%, |log FC|> 1). Moreover, 9 TFs showed differential ex-
pression on mRNA level. For these 9 TFs we set a prior activation
probability of 50%, whereas for the others a uniform prior was used.
We conducted a biRte analysis with a burn—in and sampling phase of
20 000 iterations. The calculation took around 2min on a 2.5 GHz
AMD Opteron 6380 machine. Convergence can be checked according
to the trace plot of the marginal log—likelihood (Supplementary Fig.
S28). Active regulators were selected according to their marginal selec—
tion probability (cutoff: expected FPR < 0.001).

Application of biRte’s network inference to all active regulators
resulted in a network of 28 unique regulators (Fig. 3), which have
all at least one differentially expressed target gene. The network
consists of one connected component with 25 regulators and three
singletons. The master regulator of the connected network compo—
nent, fumarate and nitrate reductase (fnr), is well known to be
essential for the switch from aerobic to anaerobic metabolism
(Unden and Schirawski, 1997). Fnr regulates arcA in anaerobic
conditions (Compan and Touati, 1994) and has an effect on the

57 <— —fnr

ﬂmpR betl marA narL soxS

v v v I v v

1 1 3  31
V tA

 IS

12 +--narP V fruR
3

\l/ 24<fur
1/ N
9 4—3131}Y
)  1. 4
EV
iscR p:th gadX
v v v

7 8 4

 

9 ENE nrdR

narX/narL system (Lamberg and Kiley, 2000), as also reﬂected by
our network. Furthermore, arcA represses betI under anaerobic
growth conditions (Lamark et 61]., 1996). The activity of gadE, gadX,
gadW, appY, fhlA and marA under anaerobic growth conditions have
also been described previously (Barbosa and Levy, 2002; Oshima
et 61]., 2002; Takahata et 61]., 2008; Zhou et 61]., 2011). Likewise,
ompR, iscR, soxS, iclR and dnaA activities have been associated to
aerobic growth and oxidative stress (Chodavarapu et 61]., 2008;
Demple, 1996; Giel et 61]., 2006; Lin et 61]., 2005; Matsubara et 61].,
2000). The TF crp (cAMP receptor protein) regulates several TFs in
our inferred network. It is known to regulate more than 100 genes
involved in energy metabolism (Bott, 1997). The singleton argP is an
arginine and lysine responsive transcriptional regulator. It competes
with dnaA for iteron binding (Rudd, 2000).

When comparing the estimated against the original, literature
based TF—target gene network, direct TF—TF interactions could ex—
plain the edges fnr —> arcA, gadE —> gadX, crp —> galS, crp —> fur,
arcA —> bed as well as fnr —> soxS, fnr —> pal/9R, fnr —> narL,
fnr —> gadX, fnr —> gadW, fnr —> fhlA, crp —> pal/9R, crp —> gadX,
crp —> gadE, arcA —> gadX, arcA —> gadE. Several of these edges
are contained in the equivalence class of our estimated network
(which is transitively closed), but removed for better visualization
purposes in Figure 3.

8 Prostate cancer

We downloaded a dataset comprising gene expression from 48 nor-
mal and 47 prostate cancer tissue samples (GSE29079, Affymetrix

argP glnG torR

(I) '
all.

54 <---ar0A QCUA"’

14/7!!! 

V V
2 1
2
_ crp—> 52 ""“':>mng--> 16
H

     

+\\(\

gals iclR dnaA— oadW fhlA
V V V V V

2 2 2 2 15

Fig. 3. E.coli: Network of active regulators inferred by biRte using pairwise NEM structure learning. Edges indicate subset relationships between differentially ex-
pressed target gene sets. Depicted is the transitive reduction of the estimated networks, i.e. all indirect edges (including validated ones) have been removed for
better visualization. From the remaining edges validated ones are drawn thicker. Numbers indicate differential targets of each regulator

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 aIo Amie/xtqu 112 /B.IO'SIBU.IHO[p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; pop1201umoq

3296

H. Frb'hlich

 

/ HrTF \

51 NKX6-2 122

   
  

'_ _ *
xmlr71
4

TBX5> 7o

    
 

mig-186 GATA4 miriS48a-3p NR3C1> 37

E2F1:TEAD1:PAX8 - * 254

I

mir-149* ' * 3
mir-616* - r 9
mir-324-3p’ 1
mir-106a*—> 1

6 7 4 mir-361-3p > 1
mir-450b-5g 2
ATF4:HESl—> 73
¢ mir-654-5p ’ 2
mir-23b — y 1
STATl EP300 - * 25

Io 

FOXC1
V

10

TALl
V

6

Fig. 4. Prostate cancer: Network of active regulators inferred by biRte using pairwise NEM structure learning. Edges indicate subset relationships between differ-
entially expressed target gene sets. Node names with ‘:' (e.g. ATF4:HES1) indicate indistinguishable effect profiles of the respective regulators. Numbers indicate

differential targets of regulators. Thick edges are confirmed by direct TF—TF interactions in BioGRID

Human Exon 1.0 ST). Accompanying qPCR—based array data
(2 plates) from 464 human miRNAs is available for 48 normal and
51 cancer samples (GSE54516). MiRNAs in each individual sample
were normalized to plate median signals. Gene expression data was
normalized via RMA (Irizarry et 61]., 2003). For the following ana—
lysis we restricted ourselves to the set of 44 normal and 47 cancer
samples that were matching between mRNA and miRNA data.
These data were mapped to a human regulatory network
(see Supplements). Only regulators targeting more than 5 probesets
were considered. Potential two—way interaction terms between regu—
lators were selected such that the overlap of target probesets was
between 25 and 50%. This was done in order to ensure significant
effects that were clearly distinguishable from main effects of
regulators.

Limma analysis yielded 262 differentially expressed probesets
and 134 differentially expressed, network map-able miRNAs (FDR
< 5%, |log FC|> 1). Moreover, on mRNA level there were four dif—
ferentially expressed, network map-able TFs. Differentially
expressed miRNAs were given a prior activation probability of
80%, and for differentially expressed TFs we set this number to
50%, TF expression is expected to be less indicative of TF protein
activity. All other regulators were given a uniform prior probability
per respective regulator class (TF, miRNA, interactions).

We ran biRte with 1 000 000 iterations with an additional burn—
in phase of 1 000 000 iterations. The whole calculation took around
16.2 hours. Convergence can be checked according to the trace plot
of the marginal log-likelihood (Supplementary Fig. S29). Active

regulators were selected according to their marginal selection prob—
ability (cutoff: FDR < 0.001).

We applied biRte’s network inference to all active regulators,
resulting in a hierarchical network structure (Fig. 4). All 26 regula—
tors in this network have all at least one differentially expressed tar—
get gene. Several are known to be involved in cancer and prostate
cancer specifically: For example, HLTF encodes a member of the
SWI/SNF family. Members of this family have helicase and ATPase
activities and are thought to regulate transcription of certain genes
by altering the chromatin structure around those genes. They have
been associated to cancer progression (Debauve et 61]., 2008). EP300
encodes the adenovirus E1A—associated cellular p300 transcriptional
co—activator protein. It functions as histone acetyltransferase that
regulates transcription via chromatin remodeling and is important
in the processes of cell proliferation and differentiation. Several
studies suggest EP300 to play a role in the development of prostate
cancer (Zhong et 61]., 2014). ATF4 is a member of the activating
TF family and discussed as a cancer drug target (Singleton and
Harris, 2012). E2F1 is a member of the E2F family and plays a cru—
cial role in the control of cell cycle and action of tumor suppressor
proteins. It has been associated to prostate cancer (Ma et 61]., 2014).
FOXC1 belongs to the forkhead box TF family. These TFs play im-
portant roles in the regulation of tissue— and cell type—specific gene
transcription and have been associated to prostate cancer (Long
et al., 2012).

Comparison of the network against the BioGRID database (Chatr—
Aryamontri et 61]., 2013) could verify the edges EP300 —> TAL1, ATF4

9mg ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 aIo Amie/xtqu 112 /B.IO'SIBU.IHO[p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; pop1201umoq

biRte

3297

 

—> EP300, NR3C1 —> EP300, E2F1 —> STAT1 and TBF5 —> GATA
4 by direct TF-TF interactions.

9 Conclusion

biRte combines inference of regulator activities with network
reverse engineering. For inference of regulator activities we rely on
an extension of our previous BIRTA method (Zacher et al., 2012).
The most significant difference is the analytical and computationally
efficient marginalization of regression coefficients, which results in
10—15 fold faster computation time. Furthermore, our simulations
indicate that biRte not only outperforms BIRTA, but also a hyper—
geometric test (Lim et al., 2009) and the lasso based GEMULA
(Geeven et al., 2012) with respect to prediction of active regulators
and regulator—regulator interactions. biRte performs post—hoc infer—
ence of networks between active regulators via NEM structure
learning, which infers subset relationships of differentially expressed
target genes. According to our simulations the approach yields far
more reliable network reconstructions than typical methods that use
observational expression data of regulators.

Application of biRte to a gene expression data measuring
response to different growth conditions in E.coli as well as to a com—
bined mRNA and miRNA dataset from prostate cancer patients
demonstrated the principal agreement with the biological literature.
We thus think that biRte could be a useful contribution to decipher
biological context specific regulatory networks.

Conﬂict of Interest: none declared.

References

Barbosa,T.M. and Levy,S.B. (2002) Activation of the Escherichia coli nfnb
gene by mara through a highly divergent marbox in a class ii promoter. Mol.
Microbiol, 45, 191—202.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Stat., 29, 1 165—1 188.

Bott,M. (1997) Anaerobic citrate metabolism and its regulation in enterobac-
teria. Arch. Microbiol, 167, 78—88.

Castelo,R. and Roverato,A. (2009) Reverse engineering molecular regula-
tory networks from microarray data with qp-graphs. ]. Comput. Biol., 16,
213—227.

Chatr-Aryamontri,A. et al. (2013) The biogrid interaction database: 2013
update. Nucleic Acids Res., 41, D816—D823.

Chodavarapu,S. et al. (2008) Escherichia coli dps interacts with dnaa protein
to impede initiation: a model of adaptive mutation. Mol. Microbiol, 67,
1331—1346.

Compan,I. and Touati,D. (1994) Anaerobic activation of arca transcription in
Escherichia coli: roles of fnr and arca. Mol. Microbiol, 11, 955—964.

Covert,M.W. et al. (2004) Integrating high-throughput and computational
data elucidates bacterial networks. Nature, 429, 92—96.

Debauve,G. et al. (2008) The helicase-like transcription factor and its implica-
tion in cancer progression. Cell Mol. Life Sci., 65, 591—604.

Demple,B. (1996) Redox signaling and gene control in the Escherichia coli
soxrs oxidative stress regulon—a review. Gene, 179, 5 3—5 7.

Engelmann,].C. and Spang,R. (2012) A least angle regression model for the
prediction of canonical and non-canonical mirna—mrna interactions. PLoS
One, 7, e40634.

Friedman,N. et al. (2000) Using Bayesian networks to analyze expression
data.]. Comput. Biol., 7, 601—620.

Frohlich,H. et al. (2008) Analyzing gene perturbation screens with nested
effects models in R and bioconductor. Bioinformatics, 24, 2549—25 5 0.

Frohlich,H. and Klau,G. (2013) Reconstructing Consensus Bayesian Network
Structures with Application to Learning Molecular Interaction Networks.
In: Beissbarth,T. et al (eds), Proceedings of the German Conference on
Bioinformatics, pp. 46—55.

Frohlich,H. et al. (2011) Fast and efﬁcient dynamic nested effects models.
Bioinformatics, 27, 23 8—244.

Frohlich,H. et al. (2009) Nested effects models for learning signaling networks
from perturbation data. Biom. ]., 51, 304—323.

Geeven,G. et al. (2012) Identiﬁcation of context-speciﬁc gene regulatory net-
works With gemula—gene expression modeling using lasso. Bioinformatics,
28, 214—221.

Gelman,A. et al. (2004) Bayesian Data Analysis. Chapman 85 Hall/CRC, Boca
Raton, FL.

George,E.I. and McCulloch,R.E. (1997) Approaches for Bayesian variable se-
lection. Statist. Sinica, 7, 339—373.

Giel,].L. et al. (2006) Iscr-dependent gene expression links iron-sulphur cluster
assembly to the control of OZ-regulated genes in Escherichia coli. Mol.
Microbiol, 60, 1058—1075.

Hartemink,A. (2001) Principled Computational Methods for the Validation
and Discovery of Genetic Regulatory Networks. PhD thesis, School of
Electrical Engineering and Computer Science, Massachusetts Institute of
Technology.

Hernandez-Lobato,D. et al. (2010) Expectation propagation for microarray
data classiﬁcation. Pattern Recogn. Lett., 31, 1618—1626.

Huynh-Thu,V.A. et al. (2010) Inferring regulatory networks from expression
data using tree-based methods. PLoS One, 5, e12776.

Irizarry,R. et al. (2003) Summaries of affymetrix genechip probe level data.
Nucleic Acids Res., 31, e15.

Lamark,T. et al. (1996) The complex bet promoters of Escherichia coli: regu-
lation by oxygen (arca), choline (beti), and osmotic stress. ]. Bacteriol, 178,
1655—1662.

Lamberg,K.E. and Kiley,P.]. (2000) Fnr-dependent activation of the class ii
dmsa and narg promoters of Escherichia coli requires fnr-activating regions
1 and 3. Mol. Microbiol, 38, 817—827.

Law,C.W. et al. (2014) voom: precision weights unlock linear model analysis
tools for rna-seq read counts. Genome Biol., 15, R29.

Lim,W. et al. (2009) Master regulators used as breast cancer metastasis classi-
ﬁer. In: Paciﬁc Symposium on Biocomputing, p. 504. NIH Public Access.

Lin,H. et al. (2005) Genetic reconstruction of the aerobic central metabolism
in Escherichia coli for the absolute aerobic production of succinate.
Biotechnol. Bioeng., 89, 148—156.

Long,Q.-Z. et al. (2012) Replication and ﬁne mapping for association of the
c20rf43, foxp4, gprc6a and rfx6 genes with prostate cancer in the Chinese
population. PLoS One, 7, e37866.

Ma,Y. et al. (2014) dep3 was expressed in coordination with e2f1 to inhibit
e2f1-mediated apoptosis in prostate cancer. Gene, 5 37, 253—259.

Margolin,A.A. et al. (2006) Aracne: an algorithm for the reconstruction of
gene regulatory networks in a mammalian cellular context. BMC
Bioinformatics, 7, S7.

Markowetz,F. et al. (2005 ) Non-transcriptional pathway features recon-
structed from secondary effects of RNA interference. Bioinformatics
(Oxford, England), 21, 4026—4032.

Markowetz,F. et al. (2007) Nested effects models for high-dimensional pheno-
typing screens. B ioinformatics, 23, i305—i312.

Matsubara,M. et al. (2000) Tuning of the porin expression under anaerobic
growth conditions by his-to-asp cross-phosphorelay through both the env-
z-osmosensor and arcb-anaerosensor in Escherichia coli. Genes Cells, 5,
555—5 69.

Opgen-Rhein,R. and Strimmer,K. (2007) From correlation to causation net-
works: a simple approximate learning algorithm and its application to high-
dimensional plant gene expression data. BMC Syst. Biol., 1, 37.

Oshima,T. et al. (2002) Transcriptome analysis of all two-component
regulatory system mutants of Escherichia coli k-12. Mol. Microbiol, 46,
281—291.

Rudd,K.E. (2000) Ecogene: a genome sequence database for Escherichia coli
k-12. Nucleic Acids Res., 28, 60—64.

Sachs,K. et al. (2005 ) Causal protein-signaling networks derived from multi-
parameter single-cell data. Science, 208, 523—529.

Setty,M. et al. (2012) Inferring transcriptional and microrna-mediated regula-
tory programs in glioblastoma. Mol. Syst. Biol., 8, 605.

Singleton,D.C. and Harris,A.L. (2012) Targeting the atf4 pathway in cancer
therapy. Expert Opin. Ther. Targets, 16, 1189—1202.

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 10 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pop1201umoq

3298

H. Frb'hlich

 

Smyth,G. (2004) Linear models and empirical Bayes methods for assessing dif-
ferential expression in microarray experiments. Stat. Appl. Genet. Mol.
Biol., 3.

Takahata,M. et al. (2008) Selenite assimilation into formate dehydrogenase h
depends on thioredoxin reductase in Escherichia coli. ]. Biochem., 143,
467—473.

Tresch,A. and Markowetz,F. (2008) Structure Learning in Nested Effects
Models. Stat. Appl. Genet. Mol. Biol., 7, Article 9.

Unden,G. and Schirawski,]. (1997) The oxygen-responsive transcriptional
regulator fnr of Escherichia coli: the search for signals and reactions. Mol.
Microbiol, 25, 205—210.

Venables,W.N. and Ripley,B.D. (2002) Modern Applied Statistics with S. 4th
edn. Springer, New York.

Zacher,B. et al. (2012) Joint Bayesian inference of condition-speciﬁc mirna
and transcription factor activities from combined gene and microrna expres-
sion data. Bioinformatics, 28, 1714—1720.

Zhong,]. et al. (2014) p300 acetyltransferase regulates androgen receptor
degradation and pten-deﬁcient prostate tumorigenesis. Cancer Res., 74,
1870—1880.

Zhou,Z. et al. (2011) Genome-wide transcriptome and proteome analysis of
Escherichia coli expressing irre, a global regulator of deinococcus radiodur-
ans. Mol. Biosyst., 7, 1613—1620.

91% ‘09 1sn3nv uo sojoﬁuv soq ‘121u10111123 10 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pop1201umoq

