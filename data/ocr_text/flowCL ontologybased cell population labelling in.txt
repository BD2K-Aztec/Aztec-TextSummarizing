Bioinformatics, 31(8), 2015, 1337—1339

doi: 10.1093/bioinformatics/btu807

Advance Access Publication Date: 6 December 2014
Applications Note

 

 

Databases and ontologies

flowCL: ontology-based cell population labelling
in flow cytometry

Mélanie Courtot”, Justin MeskasZ'T, Alexander D. Diehl3,

Radina Droumevaz, Raphael Gottardo4, Adrin Jalaliz,

Mohammad Jafar Taghiyarz, Holden T. Maecker5, J. Philip McCoy6'7,
Alan Ruttenbergs, Richard H. Scheuermanng'10 and

Ryan R. Brinkman2'*

1Molecular Biology and Biochemistry Department, Simon Fraser University, Burnaby, BC V5A 186, Canada, 2Terry
Fox Laboratory, British Columbia Cancer Agency, Vancouver, BC V52 1L3, Canada, 3Department of Neurology,
University at Buffalo School of Medicine and Biomedical Sciences, Buffalo, NY 14203, USA, 4Fred Hutchinson
Cancer Research Center, Seattle, WA 98109, USA, 5Institute for Immunity, Transplantation and Infection, Stanford
University School of Medicine, Stanford, CA 94305, USA, 6National Heart, Lung and Blood Institute, National
Institutes of Health, Bethesda, MD 20892, USA, 7Center for Human Immunology, Autoimmunity and Inflammation,
National Institutes of Health, Bethesda, MD 20892, USA, 8School of Dental Medicine, University at Buffalo, NY
14214-8006, USA, 9J. Craig Venter Institute, La Jolla, CA 92037, USA, 10Department of Pathology, University of
California, San Diego, CA 92093, USA.

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
Associate Editor: Jonathan Wren

Received on August 29, 2014; revised on November 3, 2014; accepted on December 2, 2014

Abstract

Motivation: Finding one or more cell populations of interest, such as those correlating to a specific
disease, is critical when analysing flow cytometry data. However, labelling of cell populations is
not well defined, making it difficult to integrate the output of algorithms to external knowledge
sources.

Results: We developed flowCL, a software package that performs semantic labelling of cell popula—
tions based on their surface markers and applied it to labelling of the Federation of Clinical
Immunology Societies Human Immunology Project Consortium Iyoplate populations as a use case.
Conclusion: By providing automated labelling of cell populations based on their immunopheno—
type, flowCL allows for unambiguous and reproducible identification of standardized cell types.
Availability and implementation: Code, R script and documentation are available under the Artistic
2.0 license through Bioconductor (http://wvmvbioconductor.org/packages/devel/bioc/htmI/flowCL.html).
Contact: rbrinkman@bccrc.ca

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 IntrOducuon particular combinations of markers, or immunophenotype. Despite

Both ﬂow cytometry (FCM) and mass cytometry are used to identify progress made towards standardization of FCM assays (Maecker
one or more cell populations of interest, such as those correlating et 61]., 2012), the lack of a standard labelling strategy hampers data
With a disease phenotype. Cell types can be grouped by their integration When trying to match gating data resulting from various

©The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1337

112 /§JO'S{eumo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

1338

M. Co urtot et al.

 

manual or automated tools and heterogeneous sources. The cell
ontology (CL) was developed to represent cell types relevant to
biology. A recent revision (Diehl et al., 2011) specifically focused on
extending coverage of the CL by improving the representation of
haematopoeitic cell types, asserting those cell types in a single-inher-
itance hierarchy and adding logical restrictions to describe their
immunophenotypes. However, multiple issues arose when we at—
tempted to use the CL for labelling of cell types derived from FCM
data. The definition of ‘mature T cell’ (obo:CL_0002419; “oboz” is
an abbreviation for http://purl.obolibrary.org/0bo/) mentions that it
has plasma membrane part some ‘T cell receptor complex’
(obo:GO_0042101), which itself has part the CD3 marker
(obo:PR_000001018), requiring complex reasoning to infer that
‘mature T cell’ has part some CD3. Additionally, when trying to
identify CD3+ cells, FCM experimenters are in fact targeting CD3—
epsilon (obo:PR_000001020), which is itself a subunit of the CD3
molecule described in the CL. As a consequence, while the CL
encompasses information about surface markers, its manual exploit—
ation can be challenging and may require multiple inferences along
multiple axes, which is neither optimal nor sustainable with the in—
crease in size of datasets. To address these challenges, we developed
ﬂowCL, a software package that enables researchers to unambigu—
ously label their cell populations based on their immunophenotype
using the CL. We also improved CL to enhance its utility for auto—
mated labelling of cell populations.

2 Approach

The core module of flowCL is an ontology labeller that attempts to
provide a semantic identifier to a cell population based on its marker
expression profile (i.e., the immunophenotype). The immunopheno-
type can be identified using either manual or automated methods
(Malek et al., 2014; Finak et al., 2014; O’Neill et al., 2014; Qian
et al., 2010). ﬂowCL decomposes a query such as ‘CD4+CD8—’ (as
provided in the conventional format used by immunologists) into its
individual markers (CD4, CD8) and translates their relative abun—
dance into a relation used in the CL, such as + for has plasma mem-
brane part. The steps flowCL takes are as follows: (1) A SPARQL
(http://www.w3.org/TIUrdf—sparql—queryl) query against the CL
fetches the labels and IDs corresponding to the input markers by
text matching to the label or synonyms fields in the CL; (2) The
marker labels are used to retrieve a list of cell types that contain (or
lack) the marker labels; (3) The set of markers that make up each
cell type is then retrieved; (4) A final query retrieves all parents up to
the root of the CL for each cell type to build a tree diagram of the
results.

3 Results and discussion

ﬂowCL was successfully applied to label the cell populations from
the Human Immunology Project Consortium (HIPC; Maecker et al.,
2012). Figure 1 shows a density dot plot of CD45RA versus CCR7,
created by a combination of manual analysis and ﬂowDensity
(Malek et al., 2014). Using ﬂowCL and the immunophenotype
‘CD3+CD4+CD8—CCR7—CD45RA+’, an exact match (all markers
of the input immunophenotype, along with their specific abundance,
correspond to all of the markers that make up the cell type’s defin—
ition in CL) was returned and the population was labelled ‘effector
CD4—positive, alpha—beta T cell’ (Fig. 1, top left quadrant). The top
right quadrant of Figure 1 shows where three possible labels are re—
turned when the same specific combination of markers are queried.

Density Dot Plot of CD45RA vs OCR?

 

 

  
  

 

  

.q _ 0.6% .    - 43.9%
 1 naive thymus—derived
q i  C Fl:posilive_,alpha-b-ata
"3 ' " 2'73};Tealuobo:cr._ooljijeesl[ﬂ.5sel
I I.  Elusivere-gulatoryToell
E — effector ED4+positive.' H _I  (obo:GL_DDDEE??j[D.555]
aIpha-eetareen _ _ _ _ .-.;. _  jsg'jnla'TIy'IE ccn4-pgeii_ne._pegqrarury
a; c, {ma:CL_pooio4=I}[1lo]-'-;'_'__..-' -_~':{ohmcgiiuntﬂeiﬁnoeam
E N 14.4% ' '  '  '  41.1%
D In: _ I j- I
D. r . 
1— _I a;  {51:
u eﬁeclor.,metmtr .'_,:_;- ,.  
LC: _ cmepoei'rilré.Rename-5;.   '
‘3 Tee-II{obofCILDIDDDB'DBjED23ing I.  
EITmIIimIarheIperceII- ' _ - "5;.l-rigienliral'fnerriory'ﬂD4—positive.
E - (obo:GLjDUEDS-BIIUEEE] ' alpha-betaToeIIIcLh'oﬂLJoooeMHt-s]

 

 

 

 

I I I I I I I I
DD {1.5 ‘IJD 1.5 2D 2.5 3.1] 3.5

CC RT

Fig. 1. Density dot plot of CD45RA versus CCR7 created using flowDensity
and using data from Cambridge Institute for Medical Research, after pre-gat-
ing to identify live cells, lymphocytes, CD3+, CD4+ and CD8—. Each quadrant
has the cell labels that were returned by flowCL for each respective cell popu-
lation, followed by the CL identifier in parentheses and ranking score in
square brackets

In this case, flowCL returns all possible matches and computes
a ranking score to indicate relevance to the original query. More
detail on the flowCL algorithm and results is available in the
Supplementary Material.

During the development of flowCL, we made several changes to
the CL to add synonyms of markers, as well as new restrictions on
existing cell types to account for the way they are identified. The
current version of ﬂowCL relies on the CL as the ontology source as
this is, to the best of our knowledge, the only resource describing
cell markers logically for haematopoeitic cell lines. Our code could
however be adapted to use another resource; the SPARQL queries
are stored in a separate function file from the main code, and only
require the URL of a SPARQL endpoint (http://cell.ctde.net:8080/
openrdf—sesame/repositories/CL is used for flowCL) as a parameter.

4 Conclusion

Decoupling the knowledge representation and the software code
allows for greater flexibility for extension and updates. As the CL
development proceeds, ﬂowCL automatically remains up—to—date
with the latest scientific knowledge. Additionally, the information
added to the CL is immediately available for the scientific commu-
nity, independently of the flowCL development or the HIPC project.
By providing automated labelling of cell populations based on their
immunophenotype, flowCL allows researchers to report results
using cell type labels. Future work includes validation on other data—
sets and extending the CL with an assay—based representation of cell

types.

Funding

This work was supported by National Institutes of Health (NIH)/Nati0nal
Institute of Biomedical Imaging and Bioengineering (NIBIB) [R01 EB008400],

112 /B.IO'SIBLLIHO[p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

flowCL

1339

 

Human Immunology Project Consortium (HIPC) [U19 A1089986], Natural
Sciences and Engineering Research Council of Canada, National Institute of
General Medical Sciences (NIGMS) 2R01GM080646-06 (Protein Ontology)
and HHSN272201200028C (ImmPort).

Conﬂict of Interest: None declared.

References

Diehl,A.D. et al. (2011). Hematopoietic cell types: prototype for a revised cell
ontology. ]. Biomed. Inﬁ, 44, 75—79.

Finak, G. et al. (2014). OpenCyto: an open source infrastructure for scalable,
robust, reproducible, and automated, end-to-end ﬂow cytometry data ana-
lysis. PLOS Comput. Biol., 10, e1003806.

Maecker,H.T., McCoy,].P. and Nussenblatt,R. (2012). Standardizing immu-
nophenotyping for the human immunology project. Nat. Rev. Immunol.,
12, 191—200.

Malek,M. et al. (2014). ﬂowDensity: reproducing manual gating of ﬂow
cytometry data by automated density-based cell population identiﬁcation.
Biomformatics: btu677.

O’Neill,K. et al. (2014). Enhanced ﬂowType/Rchyoptimyx: a bioconductor
pipeline for discovery in high-dimensional cytometry data. Biomformatics,
30, 1329—1330.

Qian,Y. et al. (2010). Elucidation of seventeen human peripheral blood
b-cell subsets and quantiﬁcation of the tetanus response using a dens-
ity-based method for the automated identiﬁcation of cell populations
in multidimensional ﬂow cytometry data. Cytometry Part B, 78,
869—882.

112 /B.IO'SIBLLIHO[p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

