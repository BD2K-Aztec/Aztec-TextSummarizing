Bioinformatics, 31 (19), 2015, 3234—3236

doi: 10.1093/bioinformatics/btv346

Advance Access Publication Date: 3 June 2015
Applications Note

 

Systems biology

TiQuant: software for tissue analysis,
quantification and surface reconstruction

Adrian Friebel‘, Johannes Neitsch‘, Tim Johann‘, Seddik Hammad2'3,
Jan G. Hengstlerz, Dirk Drasdo1'4'T and Stefan Hoehme1'4'*'T

1Interdisciplinary Centre for Bioinformatics (1231), University of Leipzig, Germany, 2Leibniz Research Centre for
Working Environment and Human Factors (lfADo), Dortmund, Germany, 3Department of Forensic Medicine and
Veterinary Toxicology, Faculty of Veterinary Medicine, South Valley University, Oena, Egypt and 4Institut National
de Recherche en lnformatique et en Automatique (lNRlA) Unit Rocquencourt, Le Chesnay Cedex, France

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Senior Authors.
Associate Editor: Robert Murphy

Received on June 18, 2014; revised on May 21, 2015; accepted on May 31, 2015

Abstract

Motivation: TiQuant is a modular software tool for efficient quantification of biological tissues
based on volume data obtained by biomedical image modalities. It includes a number of versatile
image and volume processing chains tailored to the analysis of different tissue types which have
been experimentally verified. TiQuant implements a novel method for the reconstruction of three—
dimensional surfaces of biological systems, data that often cannot be obtained experimentally but

 

which is of utmost importance for tissue modelling in systems biology.
Availability and implementation: TiQuant is freely available for non—commercial use at
msysbio.com/tiquant. Windows, OSX and Linux are supported.

Contact: hoehme@uni—leipzig.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

During the last decades, sophisticated techniques for imaging of cells
and tissues have been established. However, the translation of this
information into new knowledge is hampered by the difficulty to
form consistent hypotheses on the complex interplay between com—
ponents of biological systems resulting either in physiological func-
tion or a diseased state. In recent years, mathematical models
became increasingly important addressing this question by formaliz-
ing the relations between and the interplay of these components in
well—controlled model scenarios (Schliess et 61]., 2014). The construc—
tion and parameterization of informative models, however, crucially
depends on our ability to quantify structure and dynamic behavior
of tissues by image processing and analysis techniques. Moreover,
modeling often requires information that cannot be obtained by
available imaging methods either because the structure of interest
cannot be accessed experimentally or due to technical limitations.
For example, while in most cases the two—dimensional (2D)

structure of surfaces in tissues can relatively easily be obtained, the
reconstruction of the full three—dimensional (3D) picture usually is
much more complicated. Cell margins, e.g. can easily be obtained in
2D using a beta—catenin or phalloidin staining, but in most available
3D microscopy software an automated segmentation and quantifica—
tion of the corresponding individual cells is not possible. Existing
methods for the reconstruction of cell surfaces (Klauschen et 61].,
2009) typically rely on a proper segmentation of cells.
Quantification of individual cell surfaces is required in many situ—
ations. For example, in liver physiology cell shapes determine cell—
cell contact areas that in turn impact metabolic transmembrane
ﬂuxes and thus liver function (Hoehme et 61]., 2010).

Moreover, surfaces often represent a conceptual or functional
boundary rather than an actual biological structure that can be expli—
citly stained and imaged. For example, liver is subdivided in many small
functional units called lobules. Only in few species such as pig the sur—
face of these lobules is represented explicitly by an anatomical mem-
brane—like structure, while in most other species including human no

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3234

9mg ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

TiQuant: software for tissue analysis

3235

 

such structure exists. This makes the borders between the functional
and anatomical units experimentally very hard to determine. However,
detailed knowledge of the full 3D shape of liver lobules is essential to
quantify the anatomy of key vascular systems in liver as the sinusoidal
or bile networks which is of utmost importance to understand the inter—
play of components. In this article, we present comprehensive software
for the analysis and quantification of tissue that implements inter alia a
novel method for the reconstruction of 3D surfaces. The technique is
applicable to well—established and widely used imaging techniques even
if staining of some cellular structures is incomplete.

2 Software

The presented software TiQuant is implemented in portable object—
oriented ANSI C—l——l—. The GUI is based on QT and supports real—time
visualization using OpenGL. TiQuant is embedded in the tissue mod—
elling framework CellSys and thus is tightly linked with TiSim, a ver-
satile and efficient simulation environment for tissue models (Hoehme
and Drasdo, 2010, wherein TiSim was preliminarily called CellSys).
TiQuant provides an interface to the popular volume visualization
tool VolView and further complements its functionality by linking to
the open—source libraries ITK and VTK (itk/vtk.org) that implement a
wide variety of thoroughly tested state—of—the—art image processing
and visualization methods. The image/volume processing chains cur—
rently implemented in TiQuant for example include techniques to seg—
ment central and portal veins, sinusoidal and bile canaliculi networks
as well as hepatic and non—hepatic nuclei from 3D confocal micro-
graphs of liver tissue based on the Adaptive Otsu Thresholding
method and a number of morphological operators as described in de—
tail in (Hammad et 61]., 2014) and the supplemented user guide.

3 Surface reconstruction method

Recently, a novel method for the reconstruction of 3D surfaces was
added to TiQuant. First, two classes of objects are identified: one
preferentially located in the interior (class CI ) of objects and another
located on their sought 3D surface (class CS). Naturally, the struc—
tures in class CS do not need to cover the entire 3D surface. We as—
sume both CI and CS to be available as binary masks for example
obtained by TiQuant’s segmentation methods indicated above
(see also user guide). Next, we apply a Signed Maurer Distance
Transformation (Maurer et 61]., 2003) to obtain the Euclidean
distance dCLCSQ) to the nearest voxel of CI (CS) for each point x
: (x, y, z) in order to compute the gradient function g(§)using Eq.1:

go) = ﬂdCI(£)/<ﬂdCI(£) + (1 — ﬂ)dcs(£)> <1)

The parameter ﬂ (03/331) allows balancing the inﬂuence of the
two classes on the resulting gradient magnitude profile; lower values
of ﬂ reduce the influence of class CI . Supplementary Figure S1 in the
supplement illustrates the behavior of g(§) for different ﬂ.

In a final step, we apply a variant of the Beucher—Watershed al—
gorithm termed Morphological Watershed (Beare and Lehman,
2006) to g(§) that aggregates points whose gradient descent leads to
the same local minimum. The resulting space partitioning yields
sought surfaces in 3D.

In liver, the described method has successfully been used to ob—
tain (i) individual cell shapes (Fig. 1A—C) and (ii) the surfaces of liver
lobules (Fig. 1F). For the reconstruction of cell shapes, cell nuclei
were used for class CI as they are typically located in the interior of
cells while sinusoids and bile canaliculi which are always located at
the cell surface were used for class CS (Fig. 1A).

'I
I
T
E-
‘5-
4.
i
1‘
1
U

 

Fig. 1. (A) Confocal dataset: Nuclei (blue, DAPI), bile canaliculi (green, DPPIV),
sinusoids (yellow, DPPIV, DMs). Resulting cell surface reconstruction in (B)
2D and (C) 3D. Marked cells are randomly selected. Numbers in (B) denote
row (1st digit) and column (2nd digit) in (C). (D) Volume quantification of cells
1—9 (complete plot in Supplementary Fig. 84) (E) Single cell in tissue context
(yellow: cell, green: bile, red: sinusoids). (F) Reconstruction of lobule surfaces
in liver. See Supplementary Figure S3 for reconstruction in 2D

Since hepatocytes can have more than one nucleus and nuclei do
not have to reside in the center of the cell, the inﬂuence of CI has been
decreased to ﬂ = 0.1. The result of the surface reconstruction method
is shown in Figure 1B—D. We compared the result of our method to a
reconstruction based on beta catenin which allowed for precise cell
membrane segmentation that we considered a reference cell shape re—
construction. The volume deviation of our method is less than 10%
for half the cells and maximally 30% which represents a reasonably
accurate reconstruction (see Supplementary Fig. S2).

In case of liver lobule surface reconstruction, central veins were
used for class CI as they are per definition located in the center of
lobules, while portal veins which are typically located at the border
of lobules were used for class CS. In this example, both vascular
structures were based on uCT images. Since the geometry of central
and portal veins equally defines the shape of the lobules, we choose
ﬂ = 0.5 (Fig. 1F). On a modern system (Intel i7 Quadcore), a com—
plete run of the implementation of the cell surface reconstruction
method in TiQuant completes in less than 30 minutes for a dataset
of size 1024 x 1024 x 100 (N100 m voxels). The RAM requirement
for processing datasets of this size is 16 GB.

4 Summary

TiQuant provides a robust and efficient way to reconstruct, visualize
and analyze different types of tissue. Additionally, the software im—
plements a novel, widely applicable technique for the reconstruction
of surfaces of biological structures based on incomplete information
without using explicit staining. Open—source release of extended ver—
sions of TiQuant is planned.

Funding

Virtual Liver Network (BMBF), Notox (EU), Lebersimulator
(BMBF) and iFLOW (ANR).

9mg ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

3236

A.Friebel et al.

 

Conﬂict of Interest: none declared.

References

Beare,R. and Lehmann,G. (2006) The watershed transform in ITK discussion
and new developments. The Insight].

Hammad, S. et al. (2014) Protocols for staining of bile canalicular and sinus-
oidal networks of human, mouse and pig livers, three-dimensional recon-
struction and quantiﬁcation of tissue microarchitecture by image processing
and analysis. Arc/7 Toxicol, 88, 1 161—183.

Hoehme,S. and Drasdo,D. (2010) A cell-based simulation software for multi-
cellular systems. B ioinformatics, 26, 2641—2642.

Hoehme,S. et al (2010) Prediction and validation of cell alignment
along microvessels as order principle to restore tissue architec-
ture in liver regeneration. Proc. Natl. Acad. Sci. USA, 107, 10371—
10376.

Klauschen,F. et al (2009) Computational reconstruction of cell and tissue sur-
faces for modeling and data analysis. Nat. Protocols, 4, 1006—10012.

Maurer,C.R. et al. (2003) A linear time algorithm for computing exact eucli-
dean distance transforms of binary images in arbitrary dimensions. IEEE
Trans. Pattern Anal. Mac/7. Intell., 25, 265—270.

Schliess,F. et al. (2014) Integrated metabolic spatial-temporal model for the
prediction of ammonia detoxiﬁcation during liver damage and regeneration.
Hepatology, 60, 2040—205 1.

91% ‘09 1sn3nv uo sopﬁuv soq ‘etulomeg aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

