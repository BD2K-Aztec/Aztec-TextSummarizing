ORIGINAL PAPER

Vol. 29 no. 13 2013, pages 1607—1613
doi: 1 0. 1093/bioinformatics/btt1 88

 

Sequence analysis

Advance Access publication April 24, 2013

Structural RNA alignment by multi-objective optimization

Thomas Schnattingerl’z, Uwe Schoning1 and Hans A. Kestler2’*

1Institute of Theoretical Computer Science, Ulm University, 89069 Ulm, Germany and 2Research Group Bioinformatics
and Systems Biology, Institute of Neural Information Processing, Ulm University, 89069 Ulm, Germany

Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: The calculation of reliable alignments for structured RNA
is still considered as an open problem. One approach is the incorpor-
ation of secondary structure information into the optimization criteria
by using a weighted sum of sequence and structure components as
an objective function. As it is not clear how to choose the weighting
parameters, we use multi-objective optimization to calculate a set of
Pareto-optimal RNA sequence-structure alignments. The solutions in
this set then represent all possible trade-offs between the different
objectives, independent of any previous weighting.

Results: We present a practical multi-objective dynamic programming
algorithm, which is a new method for the calculation of the set of
Pareto-optimal solutions to the pairwise RNA sequence-structure
alignment problem. In selected examples, we show the usefulness
of this approach, and its advantages over state-of—the—art single-
objective algorithms.

Availability and implementation: The source code of our software
(ISO C++11) is freely available at http://sysbio.uni-ulm.de/?Software
and is licensed under the GNU GPLv3.

Contact: hans.kestler@uni-ulm.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 24,2012; revised on April 15, 2013; accepted on
April 17, 2013

1 INTRODUCTION

The central role of RNA is that of being a messenger between
transcription and protein translation. However, it is known that
non-coding RNA molecules have a wide range of functions in the
cell, like catalysis of chemical processes or in gene regulation, and
it is assumed that RNA played a central role in the early stages of
life (Doudna and Cech, 2002; Latchman, 2005). As the function-
ality of RNA molecules is not only deﬁned by their primary
sequences but also the interaction of their base pairs, their sec-
ondary structure is well conserved during evolution (Zuker and
Sankoff, 1984). Based on this observation, RNA can be orga-
nized into families with similar sequences and secondary struc-
tures. The Rfam database (Gardner et al., 2011) is a collection of
RNA sequences, arranged in currently 1973 different families,
each represented by a multiple alignment of its members.
When the sequence similarity is too low, the construction of re-
liable sequence alignments is impossible (Gardner et al., 2005). In
this case, structural information can be used as another criterium
to improve these alignments. Although much work has already

 

*To whom correspondence should be addressed.

been put into the development of sequence alignment methods,
especially those for multiple sequences (Larkin et al., 2007),
RNA sequence-structure alignment can still be considered as
an open problem (Gardner et al., 2005).

RNA secondary structure consists of base pairs (ik,jk), ik <jk
(positions from 5’ to 3’) between nucleotides of an RNA se-
quence. Through stacking effects, these base pairs tend to form
helices and various kinds of loops (see Fig. l for an example).
For complexity reasons, we will restrict ourselves to non-crossing
structures that forbid so-called pseudo-knots. This means that if
we have two base pairs (i1,j1) and (i2,j2) with i1<i2, it follows
that either i1<j1<i2<j2 or i1<i2 <j2 <j1. There are various
methods that predict a secondary structure from a single RNA
sequence by free-energy minimization, like the dynamic pro-
gramming algorithm of Zuker and Stiegler (1981). However, it
is known that the prediction of the structure of related RNA
sequences can be improved by comparative methods WVesthof
et al., 1996). Most structure prediction tools only calculate non-
crossing structures, but there are algorithms that predict struc-
tures with pseudo-knots. Therefore, they follow a hierarchical
approach of predicting the secondary structure first and the
pseudo-knots subsequently (Tinoco and Bustamante, 1999),
even if recent works show that tertiary interactions emerge
early in the RNA folding process and suppress incorrect struc-
tures (Behrouzi et al., 2012).

One RNA molecule can have the ability to fold into different
‘suboptimal’ structures, which differ from each other in their
stability. McCaskill (1990) gives an efﬁcient algorithm that cal-
culates all secondary structures, together with their occurrence
probability in a thermodynamic equilibrium. The result is a
matrix of probabilities P, where an entry at position (i,]') reﬂects

 
    

stacked pairs
("stem")

Fig. 1. Example of a RNA molecule. The primary sequence is the se-
quence of nucleotides (encircled), whereas the base pairings (in light grey)
between nucleotides make up the secondary structure

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1607

112 ﬁle'slcumo[pJOJXO'sopchoguioiq/ﬁdnq IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

T.Schnattinger et al.

 

the probability of the bases at positions i and j to form a base
pair. More precisely, Pi]- is the sum of probabilities of all second-
ary structures that have a base pair between the nucleotides at
positions i and j.

To our knowledge, Sankoffs algorithm (Sankoff, 1985) was
the ﬁrst to solve the alignment and folding of RNA simultan-
eously. In its pairwise version, it has a time and space complexity
of 0(n6) and 0(n4), respectively, and as a consequence, it is often
considered too expensive for a practical application. A simpliﬁed
and more efﬁcient variant of the Sankoff algorithm is F Oldalign
(Gorodkin et al., 1997; Havgaard et al., 2007), which uses a re-
stricted energy model to reduce the time and space complexity,
where Dynalign (Mathews, 2005; Mathews and Turner, 2002)
features the full energy model, but it reduces the number of rea-
sonable alignments by limiting the range of positions of matching
nucleotides. Recently, Backofen et al. (2011) even presented an
exact and efﬁcient algorithm that uses sparsiﬁcation to signiﬁ-
cantly enhance the runtime behaviour. Another popular imple-
mentation is LocARNA WVill et al., 2007), which is based on the
work of Hofacker et al. (2004), and it incorporates structural
information into the alignment process in the form of pre-calcu—
lated base pair probabilities. It ﬁnds an optimal sequence-struc-
ture alignment that maximizes an objective function, which is a
weighted sum of a sequence alignment score and the sum of base
pair probabilities of a consensus secondary structure. All these
alignment methods depend on ﬁxed weighting parameters for
their sequence and their structure objectives, which have to be
estimated or optimized. Depending on the type of RNA or the
degree of structure conservation, a ﬁxed weighting can lead to
undesirable sequence-structure alignments. A change of these
parameters can have a great inﬂuence on which consensus struc-
ture is considered as optimal.

We treat the sequence alignment and the consensus structure
calculation as separate objectives, and we solve both problems
simultaneously with a new multi-Objective dynamic program-
ming algorithm (Deb, 2001; Laux, 2005; Pareto, 1971). The
result is not one single solution that is optimal in some sense,
but a set of Pareto-optimal solutions. This technique has been
applied successfully in different ﬁelds like the multi-objective
routing problem (Sniedovich, 1988) or the knapsack problem
with multiple criteria (Henig, 1983; Klamroth and Wiecek,
2000). In the bioinformatics area, Roytberg et al. (1999) con-
struct a set of Pareto-Optimal alignments of biological sequences
by treating the number of gaps and the scores for (mis)matches
as separate objectives. Taneda (2010) gives an evolutionary algo-
rithm for pairwise RNA sequence alignment that incorporates
RNA structure information to approximate a set of Pareto-
Optimal solutions. Although it also uses the theory of dominating
vectors, it only calculates a rough approximation of the set of
Pareto-Optimal alignments. Apart from that, it depends on many
parameters that inﬂuence the quality of approximation, as well
as the runtime behaviour. We now present an algorithm that
calculates the exact set of Pareto-Optimal solutions.

2 METHODS

When the weighting between two conﬂicting objectives is not known, the
weighting parameters have to be estimated or optimized in some way.

After that the weighting parameters represent one ﬁxed trade-Off between
the objectives, which also biases all subsequent solutions.

2.1 Multi-objective optimization

If more than one objective is to be optimized, the scoring can be treated
as a vector-valued function, where the dimension is the number Of Ob-
jectives. Two different objectives can be conﬂicting, and in general, there
is no solution that maximizes all objective functions. As there is no ‘op-
tirnal solution’ in a vector-valued context, the deﬁnition of optimality
needs to be generalized.

DEFINITION 1 (Dominating vector). Let x = (x1, . . . ,xd) 6 Rd and
y=(yl,...,yd) 6 Rd. We say x dominatesy iin Zyifor all 1 5 i5 a'
and xj> yj for at least one 1 5 j 5 d.

DEFINITION 2 (Pareto-Optimality). Let M C Rd, x E M. x is Pareto-
optimal in M if there is no other element y e M that dominates x.

Now the problem of multi-Objective optimization is the calculation of
the largest subset of all possible solutions where every element is Pareto-
Optimal. This subset can contain multiple elements and is also known as
the non-dominated set or the ﬁrst Pareto-front (Laux, 2005). The task of
ﬁnding the Pareto-Optimal elements of a given ﬁnite set is called the
maximal vector problem and has several solutions that are efﬁcient in
practice. As a special case, the computation of the Pareto-front of a set of
2D vectors takes linear time (Godfrey et al., 2007).

First, we show that every solution, which can be found by a mono-
Objective optimization, which maximizes a weighted sum of the Object-
ives, is also Pareto-Optimal.

THEOREM 1. Let M C Rd be some solution set, and let f, be a family of
objective functions. A solution m E M that maximizes

Z wiﬂ-(m) "a max (1)

for any given weights (oi >0 is also Pareto-Optimal.

PROOF. Let m e M be Optimal in respect of (1). Assume m is not
Pareto-Optimal; therefore, there must exist an y e M that dominates m,
i.e. Vi : fi(y) Z fi(m) and Elj : fJ-(y) >fJ-(m). Without loss of generality be
f1 (y) >f1 (m). It follows that Z wifi(y) > Z wiﬂ-(m), which contradicts the

l l

fact that m maximizes (1).

This result implies that our method is a generalization of any mono-
Objective method (compare Ehrgott, 2000). The set of supported solutions
(i.e. there exist weighting parameters a),- for which the solution is Optimal)
lies on the convex hull of the Pareto set. Restriction on these solutions
may lead to non-favourable decisions (Klamroth and Wiecek, 2000). On
the other hand, the elements from the Pareto-front represent every pos-
sible trade-Off between the different Objectives: one cannot get better in
one without getting worse in another Objective.

2.2 A multi-objective dynamic programming algorithm

The secondary structure of functional RNAs is often more conserved
than their sequence; therefore, it makes sense to use the secondary struc-
ture as another criterion to obtain good alignments. A sequence-structure
alignment of two RNA sequences A and B consists of a sequence align-
ment R and a compatible consensus secondary structure S, which means
that both sequences can fold into the same structure S. More precisely,
(i, l) e R means that the nucleotides Aj and B, are matched together.
(i, j; k,l) e S means (i, k) e R and 0,1) 6 R are matched nucleotides,
and additionally, A,- is base paired with A], and Bk is base paired with
B]. We formulate two separate Objectives that assign a score to a se-
quence-structure alignment. The ﬁrst one in Equation (2) is the well-
known Objective function for sequence alignment algorithms: the sum

 

1608

112 /810's112umoprOjXO'sopeuIIOquOIq/ﬁdnq IIIOIJ pepeommoq

910K ‘09 isnﬁnV no :2

Structural RNA alignment by multi-objective optimization

 

of penalties for the gaps in the alignment and of scores for (mis-)matched
unpaired nucleotides.

fseq(Ra S) = V ' Ngap + Z (7(Aia Bk) (2)

(i, k)eR

unpaired
The gap penalty y should be negative, where the scoring function a for
aligned nucleotides should satisfy o(a, a) Z 0 and 0(a, b) 5 0 for a 75 b.
Note that Equation (2) is a weighted sum itself. To be completely inde-
pendent Of weighting parameters, we could introduce a third Objective
function, but this would again result in a higher runtime complexity. The
second Objective function in Equation (3) is the sum of base pair scores

for all aligned base pairs in the consensus secondary structure S.

was): 2 wgwif, (3)

(ij;kl)eS

The score III; for the base pair (A,,Aj) is deﬁned analogously to
Hofacker et al. (2004), and it is proportional to the logarithm of the
respective entry in the base pair probability matrix P};- (McCaskill, 1990).

log(P4/p -) if P4 >1; .
 = 1] mm 9 y _ I mm 4
’1 { 0, otherw1se. ( )

In the ﬁrst version of our algorithm (Schnattinger et al., 2012), we used
the recursive deﬁnition of Hofacker et al. (2004) for the prototypical
implementation. In a more sophisticated algorithm by Will et al.
(2007), the runtime and memory requirements were greatly improved.
Therefore, we adapt this new formulation to ﬁt the multi-Objective prob-
lem deﬁnition. Let now SL131“; be the set of Pareto-Optimal scoring vectors
of alignments of the two subsequences A[i + 1..j] and B[k + 1..l].

Sid-9,, l = Pareto-max of :
[S + )7 I S E Si,j_1;k,[JU

S+ )7 I S E Si,j;k,[_1 U

{S + 3(Aj, 31) 3 S E Si,j—l;k,l—1}U (5)
s + d:
U S E Si,h—1;k,q—1,
h’q d E Dal-“Ll
Did-,1“, = {s + lI151]- + $113,, : s E Si,j_1;k,i—1} (6)
with the initializations

Si,i;k,l = {170— k)}, for l>k (7)
Si,j;k,k = {170 — 1)}: for j>i (8)
Si,i;k,k = {0}- (9)

Equation (5) takes the Pareto-optimal solutions from all candidate
solutions, which originate from the union of four major sets. Each one
results from reducing the problem of ﬁnding Pareto-Optimal sequence-
structure alignments of two sequences to smaller subproblems. The ﬁrst
one takes all elements of Si, j_1; k, l and adds a gap penalty 17 to them. This
stands for the insertion of a gap into the sequence B directly after position
I, which is matched with A]. Analogously, the second set describes the
scoring vectors of all alignments that have B, matched to a gap in A after
position j. As Si,j_1;k,l_1 is the set of alignments of the subsequences
A[i + 1..j — 1] and B[k + 1..l — 1], the third set of Equation (5) contains
all Pareto-Optimal solutions to the alignment of A[i + 1..j] and B[k + 1..l],
which have Aj matched (or mismatched) to B1. The scoring of aligning
these two nucleotides is done by the function 3. The fourth part is the
union of all candidate solutions, which have a base pair (h j) in A and (q,l)
in B. As a result, a solution vector is the sum of the solution vectors of
two partial problems: the alignment of the subsequences A[i + 1..h — 1]
and B[k + 1..q — 1], and of the subsequences A[h..j] and B[q..l] with the
base pair (h, j; q, l) as an additional condition. Therefore, Equation (6)

deﬁnes Dwng to be the set of Pareto-Optimal solution vectors of the
alignments of the subsequences A[i..j] and B[k..l] with the condition
that A,- is matched to Bk, Aj is matched to B1, and these enclosing nu-
cleotides are base paired. Obviously, it is required that both RNAs can
have base pairs at these positions; hence, P; > 0 and Pf, > 0. Note that we
do not need the Pareto-max Operator here, as Si, j_1; k, [_1 does not contain
dominated solutions. Finally, Equations (7—9) specify the trivial base
cases of the recursion.

We want to compute both scoring functions for every solution; hence,
each element in the matrices S and D is a vector with two components:
the sequence score and the structure score of this solution. Therefore, we
implement a 2D scoring function with the ﬁrst component containing the
sequence score fseq and the second component containing the structure
score fm. Thus, 17 and 17(1) are the vector-valued gap penalties for the
insertion of a gap of length 1 and l, which in our case is deﬁned by
17(l) 2: (y - l, 0). The insertion of a gap into an existing intermediate so-
lution should increase its sequence score by y and leave the structure
score untouched, which means that 17 can simply be added to the scoring
vector of the intermediate solution. Analogously, the scoring function for
two aligned nucleotides a and b is 3(a, b) 2: (o(a,b),0). On the other
hand, the vector-valued structure score is III; 2: (0, \Pg), leaving the
sequence score unchanged when added to the scoring vector of an inter-
mediate solution.

The number Of Pareto-Optimal solutions to the sequence-structure
alignment problem can be large. To maintain practicability, it is crucial
to Optimize the runtime and memory requirements of this algorithm. For
example, S does not have to be calculated for every combination of i and
k, as only those parts of the matrix are needed with either (i, k) = (0, 0) or
A,- and Bk are positions where a base pair can start. The set of Pareto-
Optimal scoring vectors of global alignments of A and B is So, who, '3'. The
dynamic programming matrix contains the Pareto-Optimal scoring vec-
tors for the solutions but not the sequence-structure alignments them-
selves. TO get the desired alignments, a backtracing procedure is used in a
second phase of the algorithm, which works as follows. For every scoring
vector a, Equations (5) and (6) are used to ﬁgure out how this solution
was calculated by simulating all steps that may have led to a. This is
repeated recursively until one of the base cases from Equations (7—9) is
encountered.

2.3 Proof

The recursive formulation of the dynamic programming algorithm is
similar to the typical mono-Objective formulation, except for the elements
being vectors instead of numbers. To show the correctness of a
dynamic programming algorithm, the problem must satisfy Bellman’s
principle Of Optimality (Bellman, 1957). Henig (1985) showed that the
principle Of optimality holds for multi-criteria decision problems if the
monotonicity criterion is fulﬁlled. This means that if a, b e SL131“; are
solutions to the same subproblem and a dominates b, and the same
‘decision’ ﬂa) and ﬂb) is applied to them, their dominance
property must be preserved; hence, ﬂa) must also dominate ﬂb). We
will show the correctness of our algorithm by showing that (i) for each
subproblem (i, j, k, I), all Pareto-Optimal solutions are generated and
(ii) Bellman’s principle Of Optimality holds; hence, no Pareto-Optimal
solution is lost by applying the Pareto-max Operator during the
algorithm.

THEOREM 2. Equations ( 5 ) and ( 6 ), together with the initializations of
Equations (7—9) compute the set of Pareto-optimal sequence-structure
alignments.

PROOF. Suppose that all smaller subproblems have already been cal-
culated. Without the Pareto-max Operator, Equations (5—9) produce the
set of all possible sequence-structure alignments of A and B. The Pareto-
set thereof is the desired result. We will now show that the removal of
dominated solutions from the sets during the algorithm does not prevent

 

1609

112 /810's112umoprOjXO'soI112u1101uIOIq//2d11q 111011 p9p1201umoq

9IOZ ‘09 isnﬁnV no 22

T.Schnattinger et al.

 

any Pareto-Optimal solution to be computed in a future step. Therefore,
we ﬁrst show that a dominated intermediate solution can not be part of a
Pareto-Optimal solution. This argument covers the ﬁrst three cases of
Equation (5). Without loss of generality, we consider the ﬁrst case,
cases two and three follow analogously.

First case. Let x, y e S,-, j_1;k, , be two scoring vectors of the form
x = (x1, . . . ,xd) and y = (yl, . . . ,yd), with x dominating y, that is
x,- Zyi for 15 i5 d and xj>yj for at least one 15j5 d.
Furthermore, let )7 = (y1,.. . , yd) be the d—dimensional gap
penalty score. Let now be )2 = x + 17 = (x1 + V1, . . . , xd + yd)
and y=y+)7=(yl+y1,...,yd+yd). It is clear
that £i=xi+yizyi+yi=j>i for ISiSd and
921- 2 xj + yj>yj + yj : y,- for at least one 1 5 j 5 d, which immediately
implies that )2 dominates y; hence, the monotonicity criterion holds. As a
consequence, no Pareto-Optimal solution is lost in the computation of
S,,j;k,l, if dominated scoring vectors are eliminated in their partial solu-
tions in the ﬁrst three cases.

Last case. For any ﬁxed h and q be v, w e Si,h_1;k,q_1, v 2 (v1, . . . , Va)
and w = (w1,.. . , war) with v dominating w, and
x,y e Dal-“1,1, x = (x1, . . . ,xd) and y = (yl, . . . ,yd) with x dominating

y. Then the scoring vectors (v+ x), (v+ y), (w+x) and (w+ y) are
among the generated solutions for Sid-9,, [. From the fact that v dominates
w, it follows that (v + x) dominates (w + x), and (v + y) dominates
(w + y), as shown earlier in the text. Also x dominates y; thus, (v + x)
dominates (v + y) and (w + x) dominates (w + y). After the application
of the Pareto-max Operator, from these four produced solutions, only
(v + x) E SL131“; survives in the set, and v and x were the non-dominated
vectors. Therefore like aforementioned, by removing dominated solutions
from intermediate results, no Pareto-Optimal solutions are lost.

2.4 Implementation

The runtime and space requirements depend not only on the length of the
input RNA sequences A and B, as it would be the case in the mono-
Objective algorithm, but also on the number K of Pareto-Optimal solu-
tions. This number depends on the sequence and structure conservation
Of the RNAs. If, for example, A (or B) does not have any secondary
structure (i.e. PA = 0), then the fourth case of Equation (5) always evalu-
ates tO the empty set. This means that for every (i, j, k, I), there will be no
solution with a positive structure score. As a result, the number of Pareto-
Optimal solutions will be K: 1. In the other extreme, A and B have many
suboptimal secondary structures; therefore, PA and PB have many non-
zero entries. This will result in many sequence-structure alignments with
different structure scores, and most likely in many non-dominated, hence,
Pareto-Optimal solutions.

We want to determine this number K (as a function of the sequence
length) experimentally for the given 2D Objective function. Therefore, we
randomly chose 11000 pairs of RNAs up to length 350 from the Rfam
database (Gardner et al., 2011), with each pair being from the same RNA
family and differing no more in length than 10nt. For each pair, we ran
our algorithm and computed the size of the largest set of Pareto-Optimal
solutions among all intermediate solutions Sid-9,, [. The experiment
showed that the average quotient of the number of Pareto-Optimal solu-
tions and the mean sequence length of the input sequences is 1, and we
conclude that K must be in 0(n). See Fig. 2 for a graphical result of this
experiment.

The algorithm consists of two major parts. First, the set of Pareto-
Optimal scoring vectors So,|A|;o,|BI is calculated using the recursion of
Equations (5—9). The runtime complexity Of a dynamic programming
algorithm is the size of the table, which in our case is 0(n4), times
the runtime it takes to compute one entry. We saw earlier that the
Pareto-max Operator for 2D data has a runtime proportional to the
number of candidate elements. Assuming that the largest set SL131“, has

K elements, it becomes clear that the ﬁrst three cases of Equation (5)
produce at most three K elements. Will et al. (2007) showed that, on
average, the number of combinations (ha) in the fourth case is constant.
The elements in this fourth set are the sums of each combination of
Pareto-optimal solutions of two smaller subproblems; hence, its size is
in the order of K2 in the worst case. This gives an overall runtime of
0(n4 - K2). In practice, the runtime can be strongly improved by restrict-
ing the alignments in the following way. If we demand from each aligned
pair (Ai, Bk) that the two nucleotides must be at most M positions apart,
i.e. |i — k| 5 M, and furthermore that for matched base pairs (i, j; k, l) the
span of the two involved base pairs |(]' — i) — (l — k)| S M differs by no
more than M, then the runtime can be reduced by another factor n2 to
0(n2 -K2) for ﬁxed M (Hofacker et al., 2004). Notice, however, that
M has to be at least the length difference of A and B.

For ﬁxed i and k, the calculation of Si, 131d depends only on entries of
the form Smk, [I and on entries from D. Therefore, after every iteration of
i and k, the matrix S can be discarded, and only D has to be stored. This
reduces the space complexity signiﬁcantly from 0(n4) to 0(n2) in the
mono-Objective case Will et al., 2007). Therefore, in phase one of the
multi-Objective algorithm, we need 0(n2 - K) space to store S and D and
another 0(K2) for the calculation of the current matrix entry.

In the second phase of the algorithm, for every solution s 6 S0, IA“), '3',
a backtracing procedure is executed that recovers the actual alignment
and the consensus secondary structure from its solution vector s and the
dynamic programming matrices S and D. In the mono-Objective algo-
rithms, the backtracing walks once n steps through the matrix towards
the Optimal solution, and every step takes constant time. Even though
some entries of the matrix have to be recalculated, the time and space
consumption for this phase is negligible. In our case, we have to be more
careful because larger parts of the matrix may have to be recalculated. As
we expect a larger number of Pareto-Optimal solutions, some maybe
similar to each other, many entries will have to be recalculated multiple
times. For this reason, we implemented the following hybrid approach.
As described, we discard the intermediate solutions in the ﬁrst part of the
algorithm after every iteration of i and k. In the backtracing step, how-
ever, we memoize all recalculated entries and thus avoid redundant
calculations.

This gives us a good time-space trade-Off in practice, as we can see in
Figure 3 showing the memory consumption of the three approaches, as
well as their runtime by an example of two kaK leader RNA

 

O
o—
[x
O
o—
QLD
.N
U)
H _
G)
U)
98
900
(U
O.
O
o—
‘_
o—

 

 

 

 

50 100 150 200 250 300 350
sequence length

Fig. 2. The size of the set of Pareto-optimal solutions as a function of the
mean sequence length. Each of the 11 000 grey dots is the size of
the largest set of Pareto-Optimal solutions of all subproblems SL131“; of
one experiment. The black line is an interpolation using the locally
weighted regression and smoothing scatter plots (lowess) method of
(Cleveland, 1979)

 

1610

112 /810's112umoprOjXO'soI112u1101uIOIq//2d11q 111011 p9p1201umoq

9IOZ ‘09 isnﬁnV no 22

Structural RNA alignment by multi-objective optimization

 

2500

100

2000 '_'

E 30 g

g 1500 3
a. 60 39, Imemory
g 1000 40 '6' Elruntime

“5’ 500 20 g

C

3

o d: o h

naive space saving memo ization

Fig. 3. Comparison of runtime and space requirement for the alignment
of two kaK leader RNA sequences of length 172 and 177, which results
in a set of 157 Pareto-optimal solutions. Version 1 (‘na'ive’) completes
after 14.9 s, but it requires 2.3 GB memory. Version 2 (‘space saving’)
needs only 12 MB memory, but it has a runtime of 106 s. With memoiza-
tion, version 3 needs 260 MB and completes after 16.7 s. Experiments
were conducted on an AMD Opteron(tm) 2431 processor with 2.4GHz
and 32 GB random access memory

sequences. The naive approach that stores the whole DP matrix (‘na'ive’)
is the fastest, but it requires the most memory, as analysed earlier in the
text. By discarding the intermediate solutions after each iteration of i
and k (‘space saving’), only a fraction of the space of the naive ap-
proach is needed, but the recalculation of the missing entries in phase
two leads to a poor runtime behaviour. In the hybrid approach (‘mem-
oization’), phase one only needs as little space as version 1. However, in
phase two, the memoization of recalculated missing entries increases the
memory consumption, but it leads to a much better runtime.

3 RESULTS

3.1 Alignment of two tRNAs

We align two RNA sequences using the well-established tool
LocARNA (Will et al., 2007) and compare the results to our
multi-Objective algorithm. Sequence A is tRNA-Pro from
Arabidopsis thaliana chromosome 2 (6810—6881) and sequence B
is tRNA-Lys from Marchantia polymorpha mitochondrion
(166035—166107), both taken from the Rfam database (Gardner
et al., 2011).

LocARNA calculates, according to its mono-objective func-
tion, the following sequence-structure alignment, correctly sug-
gesting the acceptor-, D- and T-arm of the expected typical
tRNA Cloverleaf structure (Fig. 4, Solution 1):

GGGCAUUUGGUCUAG-UGGUAUGAUUCUCGCUUAGGGUGCGAGAGGUCCCGAGUUCAAUUCUCGGAAUGCCCC
GGGUGUAUAGCUCAGUUGGUAGAGCAAUAGGCUUUUAACUUAAAGGUCGCAGGUUCAAGUCCUGCUAUACCCA

(((((((..(((..........))).......................(((((.......)))))))))))).

If we recalculate the minimum free energy of these two RNA
structures, which is a measure of stability, using RNAeval
(Hofacker et al., 1994), we get —15.4’;%’l’ for A and —18.6’;%’;
for B. Our algorithm, in contrast, calculates a set of 37 Pareto-
Optimal sequence-structure alignments regarding the Objective
functions from Equations (2) and (3). Among them is the solu-
tion aforementioned, but another one is the following (Fig. 4,
Solution 2):

GGGCAUUUGGUCUAG-UGGUAUGAU—-UCUCGCUUAGGGUGCGAGAGGUCCCGAGUUCAAUUCUCGGAAUGCCCC
GGGUGUAUAGCUCAGUUGGUAGAGCAAUAGGCUUUUAACUUAAAGGUC—-GCAGGUUCAAGUCCUGCUAUACCCA

(((((((..(((..........)))....((((((.......))))))....(((((.......)))))))))))).

The additional stabilizing stem—loop structure of the anti-

codon arm leads to minimum free energies of —24.0’;%l’ for A

and —20.1’;%l’ for B. Obviously, the mono-Objective tool scores

 

 

 

 

In _
H‘ I I § i g
— eeiuiien 2 ?
_ i
3 it
#1 c} __ x x I
E: #0
e I if 1‘?
g a _ eeulien !
m i
_ i
a i
I
33 _ x
I
I l I I I I
—5IJ 4U -GD -2£I -10
sequence eeere

Fig. 4. 2D scatter plot of the Pareto-Optimal alignments of two tRNA
sequences, with the sequence score fseq on the horizontal and the structure
score fm on the vertical axis

the gap penalty higher than the gain for the additional loop, and
thus decides against the gaps, where our method leaves this ﬁnal
decision to the user. Figure 4 shows a plot of the Pareto-Optimal
scoring vectors. Here, each point represents one alignment
including its structure information. The horizontal axis shows
the sequence score, i.e. the sum of gap penalties and base
match scores. The vertical axis represents the structure score,
that is the sum \1131 + \Ilfl of all matched base pairs (Ai, Aj) and

(Bk,B1). The two solutions that belong to the aforementioned
sequence-structure alignments are highlighted. The different con-
sensus secondary structures suggested by these two solutions can
be Observed in Figure 5.

3.2 Benchmark

As a benchmark, we use the dataset 2 of the BRA liBase II bench-
mark (Gardner et al., 2005), which consists of 117 pairwise ref-
erence alignments of tRNA sequences, as well as a dataset of 324
pairwise alignments of per cent identity balanced tRNA and
5S rRNA sequences published by Dowell and Eddy (2006)
(Supplementary Material). We compare the results of the
mono-objective structural alignment tools LocARNA Mill
et al., 2007) and PMcomp (Hofacker et al., 2004), on which the
ﬁrst version of our algorithm was based, the multi-Objective evo-
lutionary algorithm CofolgaZmo (Taneda, 2010), and the state-
Of-the-art sequence alignment program Clustal Omega (Sievers
et al., 2011) to our new multi-Objective dynamic programming
algorithm (M ODP). The latter is implemented in an extended
version supporting afﬁne gap costs. To allow for a comparison
and as the multi-Objective algorithms CofolgaZmo and M ODP
return a set rather than one Optimal alignment, we evaluated the
performance measures for each solution individually and used
their maximum.

We want to measure the ability of the tools to reconstruct the
reference sequence alignment, as well as the reference consensus
structure. The quality of a solution is evaluated using the sum-Of-
pairs score (Thompson et al., 1999). It is deﬁned as the number
of character pairs that are aligned both in the predicted and in
the reference alignment divided by the number of aligned char-
acter pairs in the reference. To compare the predicted secondary

 

1611

112 /810's112umoprOjXO'soI112u1101uIOIq//2d11q 111011 p9p1201umoq

9IOZ ‘09 isnﬁnV no 22

T.Schnattinger et al.

 

structures of the sequence-structure alignments to the reference,
we use the Matthews correlation coefﬁcient (MCC) for structures
(Havgaard et al., 2007; Matthews, 1975).
P N — P N
MCC = ‘ ‘ f f (10)
WEHWEHWW+WWWM)

 

 

Here, P, is the number of predicted base pairs that are also
annotated in the reference alignment, Pfis the number of falsely

sequence A sequence B

 

structure of solution 1

 

structure of solution 2

 

 

 

Fig. 5. Secondary structures for the two highlighted solutions of Figure 4.
The ﬁrst row contains the two RNA sequences folded into the structure
suggested by Solution 1. The second row contains the more stable struc-
ture featuring a fourth stem at the cost of more gaps, as suggested by
Solution 2

 

 

 

 

 

 

 

 

o
 1‘- — ____..—-”'33'?~'.‘-:Fd-—.i=;n:1;.
zarf _—:=:r-=~‘ M f --
I I / Al//_ , - ll I . . . _ . .
I I g T T ’0'] I, . .
A  _ - — i T ’l I,
(0,3 0 .l(' . o I]
a) .. ' I
.5, -’ I
(I) I '
e  _ . l
.g 'I I
.I_ .’ r'
‘i ,l 1’
g g _ 'l ,' — - MODP
"’ o / ,’ --~- LocARNA
,' ,’ -- -- PMcomp
' ,’ - — - Cofolga2mo
,’ - - - Clustal Omega
N _ I
o ,’
| I | |
20 40 60 80

sequence identity

predicted base pairs, Nf is the number of annotated base pairs
that are not predicted and N, is the number of positions that are
unpaired in the prediction and the reference alignment. An MCC
value of —1 means that the predicted and the reference secondary
structure have no base pair in common, where an MCC value of
1 indicates a perfectly accurate prediction. For the sequence
alignment tools Clustal Omega and CofolgaZmo, a direct compu-
tation of the MCC is not possible, as they do not calculate sec-
ondary structures. We used RNAalifold to calculate a consensus
secondary structure for their solutions.

In Figure 6a, we Observe that the sequence alignment tool
Clustal Omega aligns similar sequences pretty well, but it fails
when the sequence identity is <50%. The decreased performance
of PMcomp surprises and could be explained by the fact that the
weighting parameters in the Objective function are not Optimal
for the dataset used here. LocARNA, which has a more sophis-
ticated scoring for the sequence alignment part, shows an
increased performance. Both multi-objective algorithms
CofolgaZmo and M ODP perform comparably well when the se-
quence similarity is >40%, but our method achieves good results
for dissimilar sequences. As for the MCC score in Figure 6b,
which shows the ability of the different methods to predict the
reference secondary structure, we see again the expected
decreased performance of the purely sequence-based Clustal
Omega for RNAs with low sequence similarity. The MCC
score of LocARNA and PMcomp both decline as the sequence
similarity grows, which could be a consequence of having ﬁxed
weighting parameters: if a solution has a high sequence score, the
structure score becomes less relevant. Although both multi-
Objective methods outperform the mono-Objective methods,
CofolgaZmo seems to behave slightly better for sequence pairs
with similarity from 30 to 70%. On the borders, however, our
approach achieves the higher MCC scores. The evolutionary al-
gorithm CofolgaZmo does not explore the solution space com-
pletely and possibly misses good solutions, whereas we are able
to compute all Pareto-Optimal solutions.

 

 

 

 

 

 

 

 

(b) ° —
,.——-x
A " —-— ‘ 0’--.
8 -——‘7‘.‘-'—-’:-- \\ ’4’5" \
t _ _ _ . _ . _ a -- \I\ o/
g I  I, ‘\.\
4—- a/ _.--,l\ p""-‘ \ \\____
c / _ ' - \ z, . \ \
.9 m ' . . , . - ' ‘ ' . .. \ I, I \ x \
.9 _ ‘. I ‘-\ ‘\ e
:5 O / ~.__‘__\,_..—
I \
s I 
c ’I. \\
o I
1.: I
(U I
F) /
t ,’
o o ,
o o' — f,»
g ’—_,-- —- MODP
g ,2” ~--- LocARNA
g r”  PMcomp
E - — - Cofolga2mo
- - - Clustal Omega
LO
0" _
I | I |
20 40 60 80

sequence identity

Fig. 6. Sum-Of-pairs score (a) and Matthews correlation coefﬁcient at) as functions of the sequence identity for dataset 2 of the BRAliBase II benchmark
for RNA alignment tools (interpolated using local weighted regression). We compare our method with the tools LocARNA and PMcomp for RNA
sequence-structure alignment and the sequence alignment programs Cofolga2mo and Clustal Omega, as described in the text

 

1612

112 /810's112umoprOjXO'soI112u1101uIOIq//2d11q 111011 p9p1201umoq

9IOZ ‘09 isnﬁnV no 22

Structural RNA alignment by multi-objective optimization

 

4 DISCUSSION

We introduced a novel method for the construction of pairwise
RNA sequence-structure alignments that is inspired by the
Sankoff algorithm. To overcome the dependence on ﬁxed
weighting parameters for the sequence and structure components
in our Objective function, we use separate scoring functions for
sequence and structure and search for solutions that optimize
both objectives. The result is a set of Pareto-Optimal solutions
from which the human expert is able to choose. This is clearly an
advantage to single-Objective methods that compute one single
solution that is Optimal in some sense on which the user has no
inﬂuence. With the BRAliBase II benchmark dataset, we show
the effectiveness of our new method compared with well-
established tools. Although a hypothetical method that generates
all possible solutions would win all benchmarks, albeit being
computationally infeasible, all used methods compute in reason-
able time. Compared with the evolutionary algorithm of
Cofolga2mo, our approach has two major features. First, al-
though an evolutionary algorithm is a heuristic method for
which statements about the quality of its solutions and the cover-
age Of the solution space are difﬁcult, multi-objective dynamic
programming is guaranteed to ﬁnd all Pareto-Optimal solutions
to a given problem. Second, we do not only have the ability to
produce good sequence alignments but also give all Pareto-opti-
mal solutions to the consensus folding problem of the two RNA
sequences. On a practical side, the number of solutions can be
limited by clipping the objectives or by using Harrington’s (1965)
desirability functions, while being able to guarantee ﬁnding all
solutions in this range. As comparative folding can outperform
single-sequence—based methods WVesthof et al., 1996), this might
be a useful tool for the analysis of novel RNA families. It may
even help ﬁnding new alternative stable secondary structures for
some families of RNA.

Allin all, we are able to give a new perspective on the interplay
between primary sequence and secondary structure of RNA mol-
ecules. These results will also trigger investigations on the poten-
tial of multi-Objective Optimization for the automatic learning of
weighting parameters for the established single-objective tools on
the basis of published sequence-structure alignments.

ACKNOWLEDGEMENT

The authors thank the anonymous reviewers for their very help-
ful comments that led to signiﬁcant improvement of this article.

Funding: German Research Foundation (DF G, Scho 302/8-2 to
US); Federal Ministry of Education and Research (BMBF,
Gerontosys II, Forschungskern SyStaR, project ID 0315894A
to H.A.K.).

Conﬂict of Interest: None declared.

REFERENCES

Backofen,R. et al. (2011) Sparse RNA folding: time and space efﬁcient algorithms.
J. Discrete Algorithms, 9, 12—31.

Behrouzi,R. et al. (2012) Cooperative tertiary interaction network guides RNA
folding. Cell, 149, 348—357.

Bellman,R.E. (1957) Dynamic Programming. Princeton University Press, New York.

Cleveland,W.S. (1979) Robust locally weighted regression and smoothing scatter-
plots. J. Am. Stat. Assoc, 74, 829—836.

Deb,K. (2001) Multi-Objective Optimization Using Evolutionary Algorithms. John
Wiley & Sons, Inc, New York, NY.

Doudna,J.A. and Cech,T.R. (2002) The chemical repertoire of natural ribozymes.
Nature, 418, 222—228.

Dowell,R. and Eddy,S. (2006) Efﬁcient pairwise RNA structure prediction and
alignment using sequence alignment constraints. BM C Bioinformatics, 7, 400.

Ehrgott,M. (2000) Multicriteria optimization. Lecture Notes in Economics and
Mathematical Systems. Vol. 491, Springer-Verlag, Berlin.

Gardner,P.P. et al. (2005) A benchmark of multiple sequence alignment programs
upon structural RNAs. Nucleic Acids Res., 33, 2433—2439.

Gardner,P.P. et al. (2011) Rfam: Wikipedia, clans and the ‘decimal’ release. Nucleic
Acids Res., 39, D141—D145.

Godfrey,P. et al. (2007) Algorithms and analyses for maximal vector computation.
VLDB J., 16, 5—28.

Gorodkin,J. et al. (1997) Finding the most signiﬁcant common sequence and struc-
ture motifs in a set of RNA sequences. Nucleic Acids Res., 25, 3724—3732.

Harrington,J. (1965) The desirability function. Ind. Qual. Control, 21, 494—498.

Havgaard,J .H. et al. (2007) Fast pairwise structural RNA alignments by pruning of
the dynamical programming matrix. PLoS Comput. Biol., 3, e193.

Henig,M.I. (1983) Vector-valued dynamic programming. SIAM J. Control Optimiz.,
21, 490—499.

Henig,M.I. (1985) The principle of optimality in dynamic programming with returns
in partially ordered sets. Math. Oper. Res., 10, 462—470.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary struc-
tures. Monatsh. Chem, 125, 167—188.

Hofacker,I.L. et al. (2004) Alignment of RNA base pairing probability matrices.
Bioinformatics, 20, 2222—2227.

K1amroth,K. and Wiecek,M.M. (2000) Dynamic programming approaches to the
multiple criteria knapsack problem. Naval Res. Logist., 47, 57—76.

Larkin,M.A. et al. (2007) Clustal W and Clustal X version 2.0. Bioinformatics, 23,
2947—2948.

Latchman,D. (2005) Gene Regulation: A Eukaryotic Perspective. Taylor & Francis,
NewYork.

Laux,H. (2005) Entscheidungstheorie. 6th edn. Springer-Verlag, Berlin, Germany.

Mathews,D.H. (2005) Predicting a set of minimal free energy RNA secondary
structures common to two sequences. Bioinformatics, 21, 2246—2253.

Mathews,D.H. and Tumer,D.H. (2002) Dynalign: an algorithm for ﬁnding the
secondary structure common to two RNA sequences. J. Mol. Biol., 317,
191—203.

Matthews,B. (1975) Comparison of the predicted and observed secondary structure
of t4 phage lysozyme. Biochim. Biophys. Acta, 405, 442—451.

McCaskill,J.S. (1990) The equilibrium partition function and base pair binding
probabilities for RNA secondary structure. Biopolymers, 29, 1105—1119.

Pareto,V. (1971) Manual of Political Economy. Kelley Publishers, New York, USA.

Roytberg,M. et al. (1999) Pareto-optimal alignment of biological sequences.
Biophysics, 44, 565—577.

Sankoff,D. (1985) Simultaneous solution of the RNA folding, alignment and pro-
tosequence problems. SIAM J. Appl. Math., 45, 810—825.

Schnattinger,T. et al. (2012) Pareto-optimal RNA sequence-structure alignments. In
9th International Workshop on Computational Systems Biology 2012 ( WCSB
2012 ), Ulm, Germany, pp 83—86.

Sievers,F. et al. (2011) Fast, scalable generation of high-quality protein multiple
sequence alignments using Clustal omega. Mol. Syst. Biol., 7, 539.

Sniedovich,M. (1988) A multi-objective routing problem revisited. Eng. Optimiz.,
13, 99—108.

Taneda,A. (2010) Multi-objective pairwise RNA sequence alignment.
Bioinformatics, 26, 2383—2390.

Thompson,J.D. et al. (1999) A comprehensive comparison of multiple sequence
alignment programs. Nucleic Acids Res., 27, 2682—2690.

Tinoco,I. and Bustamante,C. (1999) How RNA folds. J. Mol. Biol., 293, 271—281.

Westhof,E. et al. (1996) DNA and RNA structure prediction. In: Bishop,M. and
Rawlings,C. (eds) DNA—Protein Sequence Analysis. IRL Press, Oxford,
pp. 255—278.

Wi11,S. et al. (2007) Inferring noncoding RNA families and classes by means of
genome-scale structure-based clustering. PLoS Comput. Biol., 3, e65.

Zuker,M. and Sankoff,D. (1984) RNA secondary structures and their prediction.
Bull. Math. Biol., 46, 591—621.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA sequences
using thermodynamics and auxiliary information. Nucleic Acids Res., 9,
133—148.

 

1613

112 /810's112umoprOjXO'soI112u1101uIOIq//2d11q 111011 papeolumoq

9IOZ ‘09 isnﬁnV no 22

