APPLICATIONS NOTE

Vol. 31 no. 3 2015, pages 413—415
doi: 10. 1 093/bioinformatics/btu636

 

Genome analysis

Advance Access publication October 1, 2014

WhopGenome: high-speed access to whole-genome variation and

sequence data in R

Ulrich Wittelsburgerl, Bastian Pfeifer1 and Martin J. Lercher1’2’*
1Institute for Computer Science, Heinrich Heine University, D—40255 Diisseldorf, Germany and 2Cluster of Excellence on

Plant Sciences CEPLAS, D—40255 Dusseldorf, Germany

Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: The statistical programming language R has become a de
facto standard for the analysis of many types of biological data, and is
well suited for the rapid development of new algorithms. However,
variant call data from population-scale resequencing projects are
typically too large to be read and processed efficiently with R’s
built-in I/O capabilities. WhopGenome can efficiently read whole-
genome variation data stored in the widely used variant call format
(VCF) file format into several R data types. VCF files can be accessed
either on local hard drives or on remote servers. WhopGenome can
associate variants with annotations such as those available from the
UCSC genome browser, and can accelerate the reading process by
filtering loci according to user-defined criteria. WhopGenome can also
read other Tabix-indexed files and create indices to allow fast select-
ive access to FASTA-formatted sequence files.

Availability and implementation: The WhopGenome R package is
available on CRAN at http://cran.r—project.org/web/packages/
WhopGenome/. A Bioconductor package has been submitted.
Contact: lercher@cs.uni-duesseldorf.de

Received on May 13, 2014; revised on August 29, 2014; accepted on
September 18, 2014

1 INTRODUCTION

Population-scale whole-genome sequencing projects produce in-
formation on single-nucleotide polymorphisms (SNPs), InDels
and structural variations across thousands of individuals.
These projects commonly use the variant call format (VCF)
(1000 Genomes Project Analysis Group, 2011) text ﬁles for
data storage. The resulting ﬁles often contain millions of variant
sites and may ﬁll tens of gigabytes. The environment for statis-
tical computing R (R Core Team, 2013) has established itself as a
de facto standard for general statistics and for the analysis of
different types of sequencing data, and has efﬁcient functions
to process large vectorized data. However, routinely reading
gigabyte-sized VCF ﬁles into R is not realistic with R’s built-in
I/O capabilities.

VCF ﬁles are typically compressed and then indexed with
Tabix (Li, 2011). Tabix produces an index ﬁle for appropriately
formatted data ﬁles; the index can be used to quickly locate,
decompress and extract selected portions of the data. Although
several R packages are capable of reading VCF ﬁles
[VariantAnnotation (Obenchain et al., 2014), seqminer (http://

 

*To whom correspondence should be addressed.

cran.r-project.org/web/packages/seqminer/), Rplinkseq (https://
atgu.mgh.harvard.edu/plinkseq/)], these lack the desirable
speed, ease of use or completeness of support for Tabix ﬁles.
Further, these implementations post-process the text returned
by Tabix in R, which incurs a sizeable overhead especially for
repeated and large-scale processing.

Here, we present WhopGenome, an R package for fast,
straightforward and ﬂexible processing of genomic variation
data in VCF format. WhopGenome is also capable of compress-
ing ﬁles with BGZF and indexing any suitably formatted ﬁle
with Tabix, allowing efﬁcient selective access. Indexing is
possible on any data organized and sorted into entries uniquely
identiﬁable by index pairs: a group name (e.g. a chromosome)
and a number (e.g. a chromosomal position). With
WhopGenome’s generic Tabix interface, users can process, for
example, GF F or BED ﬁles to access them efﬁciently from
within R.

The same selective access functionality exists also for FASTA
ﬁles through WhopGenome’s interface to F aIdx (the indexing
solution included in samtools) (1000 Genome Project Data
Processing Subgroup, 2009). Using this interface to preprocess
FASTA ﬁles facilitates quick selective retrieval of DNA or
amino acid sequence regions. WhopGenome can thus efﬁciently
integrate information from associated sequence, genome annota-
tion and population-scale variation ﬁles for a given chromo-
somal region for joint processing.

2 FEATURES AND IMPLEMENTATION

All indexed data ﬁles can reside either on local hard disks or on
remote HTTP or FTP servers. Thus, WhopGenome can, for
example, selectively read data from the 1000 Genomes Project
directly from the NCBI servers (ftp: //ftp-trace.ncbi.nih.gov/
l000genomes/ftp/release).

WhopGenome provides functionality to relate genomic loci to
annotation data. A wide range of different annotation data types
is accessible through the UCSC Genome Browser (Kent at al.,
2002), the AmiGO Gene Ontology database (Carbon et al., 2009)
and through BioConductor’s (Gentleman et al., 2004)
org.XX.eg.db annotation packages. WhopGenome includes
user-friendly interfaces to the UCSC Genome Browser and the
AmiGO servers, vastly simplifying the construction of the neces-
sary SQL queries and the communication with the remote
servers. WhopGenome also provides a comfortable way to
select and download the BioConductor annotation packages.

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 413

112 /810'S112umo[pJOJXO'soi1emJOJuroiw/2d11q IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no :2

U. Wittelsbiirger et al.

 

Table 1. Comparison overview

 

 

WhopGenome Seinner VariantAnnotation

Average timea

100 000 single SNPs 0 min 32 s 15 min 34 s 1 h 56 min 12 s

Matrix of 1000 0min 6 s 0min 29 s 1 min 27 s
Average lines/seconda

100 000 single SNPs 3126.66 107.02 14.34

Matrix of 1000 16 677.23 3460.28 1144.00
Estimated time for entire ﬁleb

Reading single SNPs 15 min 47 s 7 h 48 min 18 s 57 h 21 min 53 s

Matrix of 1000 2min 58 s 14min 16 s 43 min 9 s
Pre-ﬁltering Y N N
Result formatsc R,V,M,L Y,Y,Y,N Y,N,N,Y N,N,Y,Y
Read via HTTP/FTP Y N Y
Create indices Y Yd Ne

 

Timings ran on an Intel Core-i7 3.5GHz, 16GB RAM, Linux kernel 3.11 using R 3.0.1.
A minimal stand-alone C + + program takes 54.9 s to read the entire reference ﬁle, indicating an average rate of 53 952 lines / s as

the performance baseline.
All timings rounded to nearest full second.
aAverage over ﬁve runs.

bEstimate using factor of 29.62 182 = 2962 182 total lines in ﬁle / 100 000 in measurement.

cSupported result formats: Raw string, Vector, SNP Matrix, List.

dSeinner can create indices only on compressed ﬁles; WhopGenome can compress, too.

6Not speciﬁcally for VCF ﬁles.

To link genomic variation to pedigree data, WhopGenome
includes support for .PED ﬁles (a simple text-based table
format used, e.g. by PLINK). Users can load these data into a
matrix, modify it, save it back and locate individuals with certain
family relationships. This is mainly useful for selecting samples
or correlating them with phenotypes, populations or other
information.

When reading from VCF ﬁles with WhopGenome, a typical
workﬂow would be as follows. The function VCF_open() creates
a handle to the VCF ﬁle. This handle is required to select samples
(individuals), genomic regions and ﬁltering steps, as well as for
reading data.

Users can choose to get their results in a variety of R data
types. Besides reading each data ﬁeld independently, it is also
possible to read only information on single-nucleotide poly-
morphisms (SNPs) and store the data ﬁelds for each SNP in a
vector. Especially useful for sliding window analyses are the
matrix variants, which can return SNP genotypes in four differ-
ent representations, either numeric or textual. To maximize speed
gains, we wrote a dedicated read function for each result format.
If speciﬁc areas of research would beneﬁt from additional data
representations in R, we will implement these in future versions
of WhopGenome.

After setting a region by specifying a chromosome (or contig)
and start and end positions, the next read call will return data for
the ﬁrst variant within that region. Active preﬁlters exclude lines
depending on a list of user-deﬁned rules. Rules are speciﬁed with
simple function calls in R, but are run in compiled C++.

Each rule tests a speciﬁc property, either the value of a column
(e.g. QUAL column’s phred score) or the value of a key-value
pair in a column (e. g. INFO column’s allele frequency key). The
tests can compare numerical values to reference values or against

ranges, or test for the presence of a key (e.g. H2 in INFO
indicates that a variation is found in HapMap2).

The .PED ﬁle support for pedigrees, Gene Ontology queries,
UCSC Genome Browser database queries and Bioconductor
genome annotation is implemented in R. All time-critical code
is written in C/C+ +. To avoid losing time by allocating
memory, many read functions expect an R variable as a param-
eter in which to store the results. This improves speed dramatic-
ally especially if the data are read into matrices.

3 EVALUATION

We compared WhopGenome in terms of speed, features and ease
of use with two other R packages that make use of Tabix:
Seinner and VariantAnnotation (Table 1). We did not make
a comparison with Rplinkseq, as Rplinkseq could not be
compiled without manual code changes and because using
Rplinkseq requires extensive manual interaction with the exter-
nal PLINK software (Purcell et al., 2007).

As reference ﬁle, we chose the 1000 Genomes Project’s
chromosome 1 consensus VCF ﬁle, describing >2.9 million
variants in 1094 individuals, stored in 49 GB of text, compressed
down to 1.4 GB. Seinner requires additional annotation in the
VCF ﬁles, which is not present in the 1000 Genomes Project ﬁles.
We thus ran all benchmarks on the same, preprocessed ﬁle for
better comparability (to preprocess the input ﬁle for Seinner,
we needed to uncompress the original ﬁle and install additional
software).

Although all three packages rely on the Tabix library, their
usage and feature sets differ substantially. For both benchmark
types, VariantAnnotation was slowest, whereas WhopGenome
was the fastest. All programs provide matrix representations of

 

414

112 /810'S112umo[pJOJXO'soi1chOJuroiw/2d11q IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no :2

WhopGenome

 

genotypes, but only WhopGenome offers four alternative geno-
type codings in matrix form. Also, its preﬁltering capabilities
have no direct equivalent in the other packages. With regards
to the learning curve, we consider our solution to be easier to
understand than VariantAnnotation, while Seinner’s limited
feature set makes its usage somewhat simpler, but also much
less powerful.

The VCF functionality of WhopGenome has been successfully
used by the population genomics software PopGenome (Pfeifer
et al., 2014), which implements a broad range of population
genetics analyses for individual loci, sliding windows and
genomic feature sets such as exons.

Besides its ability to efﬁciently read VCF and other
Tabix-indexed ﬁles, WhopGenome can also index and access
FASTA-formatted sequence ﬁles efﬁciently. With its auxiliary
feature set covering pedigree, genome annotation and fast preﬁl-
tering, we expect WhopGenome to substantially accelerate the
development and application of genomic and population
genomic analyses in R.

ACKNOWLEDGEMENTS

WhopGenome makes use of Tabix and F aIdx by Heng Li, of
BGZF written by Bob Handsaker and modiﬁed by Heng Li and
of zlib by J ean-loup Gailly and Mark Adler.

Funding: This work was supported by the German Research
Foundation [DF G grants EXC 1028 and CRC 680 to M.J.L.].

Conﬂict of interest: none declared.

REFERENCES

1000 Genome Project Data Processing Subgroup. (2009) The sequence alignment/
map format and samtools. Bioinformatics, 25, 2078—2079.

1000 Genomes Project Analysis Group. (2011) The variant call format and vcftools.
Bioinformatics, 27, 2156—2158.

Carbon,S. et al. (2009) Amigo: online access to ontology and annotation data.
Bioinformatics, 25, 288—289.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com-
putational biology and bioinformatics. Genome Biol., 5, R80.

Kent,W.J. et al. (2002) The human genome browser at UCSC. Genome Res., 12,
996—1006.

Li,H. (2011) Tabix: fast retrieval of sequence features from generic tab-delimited
ﬁles. Bioinformatics, 27, 718—7 19.

Obenchain,V. et al. (2014) Variantannotation: a bioconductor package
for exploration and annotation of genetic variants. Bioinformatics, 30,
2076—2078.

Pfeifer,B. et al. (2014) Popgenome: an efﬁcient swiss army knife for population
genomic analyses in R. Mol. Biol. Evol., 31, 1929—1936.

Purcell,S. et al. (2007) Plink: a tool set for whole-genome association and popula-
tion-based linkage analyses. Am. J. Hum. Genet, 81, 559—575.

R Core Team. (2013) R: A Language and Environment for Statistical Computing.
R Foundation for Statistical Computing, Vienna, Austria.

 

415

112 /810'S112umo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

