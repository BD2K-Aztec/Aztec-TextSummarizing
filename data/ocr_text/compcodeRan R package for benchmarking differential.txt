APPLICA TIONS NOTE V°"312,713.légi‘iéi’giﬁéiiiifJ/Ziﬁéi

 

Gene expression

Advance Access publication May 9, 2014

compcodeR—an R package for benchmarking differential
expression methods for RNA-seq data

Charlotte Soneson

Bioinformatics Core Facility, SIB Swiss Institute of Bioinformatics, Quartier Sorge, CH—1015 Lausanne, Switzerland

Associate Editor: lvo Hofacker

 

ABSTRACT

Summary: compcodeR is an R package for benchmarking of differ-
ential expression analysis methods, in particular, methods developed
for analyzing RNA-seq data. The package provides functionality for
simulating realistic RNA-seq count datasets, an interface to several
of the most commonly used differential expression analysis methods
and extensive functionality for evaluating and comparing different
approaches on real and simulated data.

Availability and implementation: compcodeR is available from
http://www.bioconductor.org/packages/release/bioc/html
/compcodeR.html

Contact: Charlotte.Soneson@isb-sib.ch or charlottesoneson@gmail.
com

Received on December 4, 2013; revised on April 3, 2014; accepted on
May 2, 2014

1 INTRODUCTION

Transcriptome proﬁling studies using RNA-seq with the goal of
ﬁnding genes that are differentially expressed (DE) between con-
ditions are abundant in the current scientiﬁc literature and can be
expected to become even more so, as next-generation sequencing
technology becomes cheaper and more accessible. RNA-seq
experiments generate millions of short reads, which are aligned
to a reference sequence to yield a quantitative measure of the ex-
pression levels of a collection of genes or other features. Typically,
the processed data are represented as a count matrix, which
constitutes the input for many differential expression methods.
In the past few years, many novel differential expression meth-
ods applicable to count matrices obtained from RNA-seq experi-
ments have been presented (for example, Anders and Huber,
2010; Hardcastle and Kelly, 2010; Robinson et al., 2010;
Tarazona et al., 2011). At this point, both users and developers
of such methods would thus greatly beneﬁt from objective and
standardized benchmarking and characterization of new and
existing approaches. A few comparison studies have been pub-
lished (e.g.Robles et al., 2012; Soneson and Delorenzi, 2013).
However, the fast pace at which new and updated methods are
being presented and the varying objectives of the users create a
need for a tool that makes it easy to evaluate and compare a
collection of methods from many different aspects in a standar-
dized way. In this applications note, we present such a tool.
compcodeR (COMParison of COunt—based Differential
Expression analysis methods with R) is a benchmarking R pack-
age that, in a few steps, lets the user evaluate and compare
differential expression methods using an approach similar to

the one used by Soneson and Delorenzi (2013). Accompanying
the package is a large collection of simulated and real-world
benchmarking datasets, together with differential expression
results obtained by >20 different approaches (available from
http://bcf.isb-sib.ch/data/compcodeR). The exact R code used
to run each differential expression analysis is included and can
be rerun to reproduce the results. Taken together, the package
provides users with a pedagogical interface to understand and
compare differential expression methods, and gives developers an
accessible tool for standardized benchmarking of newly
developed approaches.

2 EXAMPLE

This section outlines the three major functionalities of
compcodeR. First, the package contains a function for generat-
ing synthetic RNA-seq count matrices, using the approach
described by Robles et a]. (2012) and Soneson and Delorenzi
(2013). The user deﬁnes the properties of the dataset, such as
the number of genes and samples, the fraction of truly DE genes
and their effect size distribution, several parameters governing
the inclusion of outlier counts and ﬁlter thresholds. The follow-
ing code simulates a dataset consisting of Negative Binomially
distributed data for ﬁve samples from each of two conditions and
12,500 genes, 10% of which are truly DE.

> library(compcodeR)

> dat <— generateSyntheticData(dataset = "mydata",
n.vars = 12500, samples.per.cond = 5,
n.diffexp = 1250, fraction.upregu1ated = 0.5,
rep1.id = 1, output.fi1e = "mydata_58pc.rds")

The code generates an object of the class compData, which is
saved to a ﬁle named mydata_5 spc.rds. By rerunning the
data simulation with repl . id set to different values, it is
possible to generate multiple replicate datasets for a given simu-
lation setting, which can make method comparisons more robust
and informative.

Second, the package provides an interface to several of the
most commonly used methods for differential expression analysis
of RNA-seq data. The intention is not to cover all available
methods or exploit all of their possibilities, and new methods
can easily be included by the user. The code below applies the
differential expression test implemented in edgeR (Robinson
et al., 2010) to the data simulated above, and saves a new
compDa ta object containing also the test results. A list of the dif-
ferential expression methods to which compcodeR provides an
interface can be obtained using the function listcreateRmd.

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 2517

112 /310's113umo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

C.Soneson

 

( Replicate 1 , 5 samples/condition 

1.0 -
1000 -
0.8 -
/
' /
(I, 0.6 7
I' 0.4 -
1 _
' 0.2 -
— edgeR.3.2.4.exact.TMM.movingave.tagwise
tlest.TMM
— voom.3.16.7.limma.TMM
_ , 0.0 -
l

vst.1.12.1.limma.local.blind

edgeR.3.2.4.exact.TMM.movingave.tagwise

I I I
1 2 3
=3004 n=43 n=36

6 560 1600 1st n = 8002 n
Number of selected genes Total number of outliers

 

 

01
o
o

o
o

01
0
Score

Number of false discoveries
O

u-

    

 

 

 

 

 

 

 

 edgeR,3,2.4,exac1lTMM mnvinnam: unwise  “BIN-3:2 4- “I‘LMIWM III“!

1.00' " ' I
0.75' } ,
4

 

O

8
,_-._- .
1 .

Lug hid change

 

 

 

 

 

 

.I'Iiueraguaxer-LDH I

 

 

 

 

 

 

(e) 3 samples per condition
vst.1.12.1.limma.local.blind -
voom.3.16.7.limma.TMM - '
ttest.TMM - {° .
edgeR.3.2.4.exact.TMM.movingave.tagwise - -—'.-a
5 samples per condition
vst.1.12.1.Iimma.local.blind- ‘~—E|}—‘
vacm.3.16.7.limma.TMM - - +
ttest.TMM - . W
edgeR.3.2.4.exact.TMM.movingave.tagwise - I
o.bo o 02

 

o.b1
Fraction significant

Fig. 1. Excerpts from ﬁve example ﬁgures generated by compcodeR in a
characterization of and comparison among four differential expression
methods. The comparison is based on results from the four methods
applied to 10 replicates of a synthetic dataset for two sample sizes
(three and ﬁve samples per condition). (a) False discovery curves,
depicting the number of false positives encountered when stepping
through the list of genes ranked by signiﬁcance. (b) The distribution of
the gene-wise scores (in this case, deﬁned as 1 minus the nominal P—value)
assigned by one of the evaluated methods, as a function of the number of
outlier counts introduced in the simulation. (c) Observed false discovery
rates as a function of the binned average expression level. (d) An MA
plot, depicting the log-fold change against the average expression level,
with signiﬁcantly DE genes marked in color. (e) The fraction of genes
called signiﬁcantly DE by each of the methods. Each boxplot summarizes
the results from all 10 dataset replicates

The runDiff Exp function automatically includes the executed
code as well as the output from the R console in the result object.
The code can be written to an HTML ﬁle by the
generateCodeHTMLs function.

> runDiffExp(data.file = "mydata_55pc.rds",
result.extent = "edgeR.exact",
Rmdfunction = "edgeR.exact.createRmd",
output.directory = ".",
norm.method = "TMM", disp.type = "tagwise",
trend.method = "movingave")

The third pillar of the package is the large number of metrics
for comparison of differential expression results obtained by dif-
ferent methods. Many of the metrics are general and can also be
applied to test results from other types of data, such as micro-
arrays. Some, such as the overlap between the sets of DE genes
found by different methods, are independent of knowledge about
the true differential expression status of the genes and can thus
be applied to any dataset. Others, such as comparisons of the
observed false discovery rates for the different methods, are only
applicable when the true differential expression status for each
gene is known. The 15 comparison metrics are described in more
detail in the package vignette. The code below launches the com-
parison.

> runComparisonGUI(input.directories = ".",
output.directory = ".", recursive = FALSE)

The function runComparisonGUI scans the provided input
directories for result objects and opens a graphical user interface
(GUI) where the user can select the dataset on which to base the
comparison, which methods to compare and which comparison
metrics to use. To facilitate inclusion in an automated analysis
pipeline, the GUI can be circumvented, and the comparison can
be directly performed using the function runComparison. The
results of the comparison are written to an HTML report that is
saved in the designated output directory. Figure 1 shows excerpts
from ﬁve example plots from such a report.

ACKNOWLEDGEMENT

The author would like to thank Mauro Delorenzi, Sarah
Gerster, Edoardo Missiaglia and Giovanni d’Ario for valuable
input.

Conﬂict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol., 11, R106.

Hardcastle,T.J. and Kelly,K.A. (2010) baySeq: empirical Bayesian methods for
identifying differential expression in sequence count data. BM C
Bioinformatics, 11, 422.

Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for
differential expression analysis of digital gene expression data. Bioinformatics,
26, 139—140.

Robles,J.A. et al. (2012) Efﬁcient experimental design and analysis strategies for the
detection of differential expression using RNA-sequencing. BM C Genomics, 13,
484.

Soneson,C. and Delorenzi,M. (2013) A comparison of methods for differential
expression analysis of RNA-seq data. BM C Bioinformatics, 14, 91.

Tarazona,S. et al. (2011) Differential expression in RNA-seq: a matter of depth.
Genonw.Res,21,22l3—2223

 

2518

112 /310's113umo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

