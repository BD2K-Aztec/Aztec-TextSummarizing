Bioinformatics, 31 (21 ), 2015, 3558—3560

doi: 10.1093/bioinformatics/btv405

Advance Access Publication Date: 3 July 2015
Applications Note

 

Systems biology

Data2Dynamics: a modeling environment
tailored to parameter estimation in dynamical
systems

A. Raue1'*, B. Steiertz, M. Schelker3, C. Kreutzz, T. Maiwaldz, H. Hassz,
J. Vanlierz, C. Tonsingz, L. Adlung“, R. Engesserz, W. Maderz,

T. Heinemann5'6, J. Hasenauer7'8, M. Schilling“, T. Héfer5'6, E. Klipp3,
F. Theis7'8, U. Klingmiiller“, B. Schéberl1 and J. Timmer2'9

1Merrimack Pharmaceuticals Inc., Discovery Devision, Cambridge, MA 02139, USA, 2University of Freiburg,
Institute for Physics, 79104 Freiburg, Germany, 3Humboldt-Universitéit zu Berlin, Theoretical Biophysics, 10115
Berlin, Germany, 4Systems Biology of Signal Transduction and 5Divison of Theoretical Systems Biology, German
Cancer Research Center, 69120 Heidelberg, Germany, 6Biofluant, University of Heidelberg, 69120 Heidelberg,
Germany, 7Helmholtz Center Munich, Institute of Computational Biology, 85764 Neuherberg, Germany, 8Technische
Universitat Miinchen, Department of Mathematics, 85748 Garching, Germany and 9BIDSS Centre for Biological
Signalling Studies, University of Freiburg, 79104 Freiburg, Germany

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on March 12, 2015; revised on May 22, 2015; accepted on June 28, 2015

Abstract

Summary: Modeling of dynamical systems using ordinary differential equations is a popular
approach in the field of systems biology. Two of the most critical steps in this approach are to
construct dynamical models of biochemical reaction networks for large datasets and complex
experimental conditions and to perform efficient and reliable parameter estimation for model
fitting. We present a modeling environment for MATLAB that pioneers these challenges. The
numerically expensive parts of the calculations such as the solving of the differential equations and
of the associated sensitivity system are parallelized and automatically compiled into efficient C
code. A variety of parameter estimation algorithms as well as frequentist and Bayesian methods
for uncertainty analysis have been implemented and used on a range of applications that lead to
publications.

Availability and implementation: The Data2Dynamics modeling environment is MATLAB based,
open source and freely available at http://www.data2dynamics.org.

Contact: andreas.raue@fdm.uni-freiburg.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

For the construction of computational models that are used to ana-
lyze signal transduction pathways, gene regulation and cellular deci-
sions, datasets generated under a wide range of experimental
conditions have to be analyzed comprehensively. The
Data2Dynamics software environment is designed for computation-
ally efficient and user-friendly integration of complex experimental

data into models consisting of coupled non-linear ordinary differen-
tial equations (ODE).

Our software allows to specify the right hand side of the ODE
manually or to automatically generate it by providing the reaction
scheme with the respective rate law such as Mass Action, Michaelis—
Menten or a custom rate equation. The resulting ODE system as

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3558

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘etulomeg JO [QTSJQATII [1 112 [3.10811211an[plOJXO'SODBIILIOJIITOTQ/ﬂ(11111 wort pepeolumoq

DataZDynamics

3559

 

well as its Jacobian matrix that is calculated automatically by sym-
bolic differentiation are translated to C code and complied together
with the ODE solver into a MATLAB mex-function. The code
makes efficient use of precalculated reaction fluxes. Time-varying
inputs to the ODE systems can be represented by custom or prede-
fined input functions such as steps, pulses and splines that can
depend on unknown parameters (Schelker et al., 2012). The initial
concentrations can be considered as functions of unknown parame-
ters as well. The software allows considering multiple different mod-
els that can share common parameters and fitting them
simultaneously to all available data.

The software is able to automatically create model variants that
represent different experimental conditions. The conditions can be
defined directly in the data sheets that contain the measurements
and are parsed and grouped. For instance, a data sheet containing
four different experimental conditions automatically creates four
different variants of the ODE system that are linked to the respective
data. The model simulations will be plotted in the same grouping as
well, see trajectories in different color in Figure 1. For dose—response
experiments, the software automatically generates all required
model variants and displays the simulation results in a dose—
response plot. For computational efficiency, experimental condi-
tions, and thus model variants, that are shared between different
experiments are calculated only once. The C code can automatically
parallelize the calculation of the ODE solutions since all model var-
iants can be solved independently. The mapping between experi-
mental data and the simulated model can contain additional
parameters that can, for instance, account for unknown offsets or
scaling factors. A unique feature of the Data2Dynamics software is
its ability to estimate the magnitude of experimental errors together
with the model dynamics, see Figure 1. To this end, a full likelihood
function is automatically generated.

A critical task in modeling of dynamical systems is the efficient
and reliable estimation of unknown model parameters, also called

IL13 on Cell Surface

Cell Surface Receptor

   

 

 

 

 

 

   

 

H 1.6
5 ~ 10
g 1.4 i
5 o'
c O
o O
o 1
o
0 50 100 0 50 100
pSTAT5 socss mRNA
0 '- 1500
m 100 H
5 E1000
0' o'
c 50 c
8 8 500
o o

 

 

 

 

 

0 50 100 0 50 100
time [min] time [min]
— lL-13 = 0 ng/ml
— lL-13 = 4 ng/ml
— lL-13 = 20 ng/ml
— lL-13 = 80 ng/ml

 

 

 

Fig. 1. Raia et al. (2011) model fitted to experimental data (dots) representing
four different doses of lL-13. The solid lines are the fitted model trajectories
and the shades the estimated experimental error of the data

model fitting. We implemented a variety of different parameter esti-
mation algorithms (Raue et al., 2013b). The most efficient and reli-
able algorithm for parameter estimation in our hands is a
deterministic trust region approach combined with a multistart
strategy to map out local minima. A variety of global optimization
algorithms is implemented as well (Kronfeld et al., 2010).
Parameters can and should be estimated on a log-scale. Prior knowl-
edge about the parameters can be considered by prior distributions.
The respective penalization of the likelihood leads to maximum a
posteriori estimation. If steady-state assumptions for the model
dynamics are required and the functional relationship to parameters
is unknown, steady-state constraints can be added to the objective
function. A quality control, as proposed in Raue et al. (2013b), can
be performed to validate robustness of the estimation results. The
software implements a sophisticated method to calculate model sen-
sitivities, i.e. the derivatives of the dynamics with respect to model
parameters. The sensitivity equations are derived automatically by
symbolic differentiation, translated to C code and compiled together
with the original ODE system and solver. We showed previously
(Raue et al., 2013b) that this approach, which is not implemented in
any other software packages, is not only about 10 times faster but
also more precise than the default approach using finite differences.
A reliable calculation of these derivatives is a key to successful
parameter estimation. Goodness of fit analysis, likelihood-ratio test,
QQ plots and auto-correlation of the residuals are available.

In addition to finding the best model fit to a given collection of
data, the Data2Dynamics software implements a wide range of algo-
rithms that are able to determine uncertainties in the estimated
parameter as well as in the predicted model dynamics. In particular,
the frequentist profile likelihood approach for identifiability analysis
(Raue et al., 2009), the prediction profile likelihood approach for
observability analysis (Kreutz et al., 2012). A variety of Markov-
chain Monte Carlo approaches are implemented to perform
Bayesian inference (Hug et al., 2013; Raue et al., 2013a). Based on
the results of such uncertainty analyses, the software allows to
design additional experiments (Steiert et al., 2012) that can resolve
non-identifiability and non-observability (Raue et al., 2010) and
improve prediction accuracy (Kreutz et al., 2013).

The software is developed in a community effort using a web-based
code hosting service and a revision control system. A variety of pub-
lished applications are provided as benchmark examples for further
methods development and as guideline for novel applications. For these
examples, not only the models but also all datasets, their link to the
models as well as all original information used in the parameter estima-
tion and uncertainty analysis are provided. The software was awarded
twice as best performer in the Dialogue for Reverse Engineering
Assessments and Methods (DREAM, 201 1 and 2012).

Acknowledgement

The authors thank all academic and industrial collaborators that use the soft-
ware and have helped to develop it.

Funding

This work was supported by the German Ministry of Education and Research
(LungSysZ 0316042G/0316042A, Virtual Liver Network 0315766/0315745,
ViroSign 0316180A, SBEpo 0316182B).

Conﬂict of Interest: none declared.

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘BTIIJOJHBQ JO KitSJQAtu [1 112 [3.10811211an[plOJXO'SODBIILIOJIITOTQ/ﬂ(11111 wort pepeolumoq

3560

A.Raue et al.

 

References

Hug,S. et al. (2013) High-dimensional Bayesian parameter estimation:
case study for a model of JAK2/STAT5 signaling. Math. Biosci., 246,
293—304.

Kreutz,C. et al. (2012) Likelihood based observability analysis and conﬁdence
intervals for predictions of dynamic models. BMC Syst. Biol., 6, 120.

Kreutz,C. et al. (2013) Proﬁle likelihood in systems biology. FEBS ]., 280,
2564—25 71.

Kronfeld,M. et al. (2010) The EvA2 optimization framework. In: Learning
and Intelligent Optimization, Lecture Notes in Computer Science, Springer
Berlin Heidelberg, Vol. 6073, pp. 247—250.

Raia,V. et al. (201 1) Dynamic mathematical modeling of IL13-induced signal-
ing in Hodgkin and primary mediastinal B-cell lymphoma allows prediction
of therapeutic targets. Cancer Res., 71, 693—704.

Raue,A. et al. (2009) Structural and practical identiﬁability analysis of par-
tially observed dynamical models by exploiting the proﬁle likelihood.
Bioinformatics, 25, 1923—1929.

Raue,A. et al. (2010) Identiﬁability and observability analysis for experimental
design in non-linear dynamical models. Chaos, 20, 045105.

Raue,A. et al. (2013a) Joining forces of Bayesian and frequentist methodology:
a study for inference in the presence of non-identiﬁability. Philos. Trans. A
Math. Phys. Eng. Sci., 371, 20110544.

Raue,A. et al. (2013b) Lessons learned from quantitative dynamical modeling
in systems biology. PLoS One, 8, e74335.

Schelker,M. et al. (2012) Comprehensive estimation of input signals and dy-
namical parameters in biochemical reaction networks. Bioinformatics, 28,
i522—i528.

Steiert,B. et al. (2012) Experimental design for parameter estimation of gene
regulatory networks. PLoS One, 7, e40052.

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘BTIIJOJHBQ JO Ansrcmtu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogutoiq/ﬁdnq wort pepeolumoq

