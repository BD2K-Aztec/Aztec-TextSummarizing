Bioinformatics Advance Access published July 17, 2016

Bioinformatics, 2016, 1—3

doi: l0.1093/bioinformatics/btw368

Advance Access Publication Date: 17 June 2016
Applications note

 

 

Genome analysis

TADtool: visual parameter identification for

TAD-calling algorithms

Kai Kruse1'T'*, Clemens B. Hug”, Benjamin Hernandez-Rodriguez1 and

Juan M. Vaquerizas1'*

1Max Planck Institute for Molecular Biomedicine, Miinster 48149, Germany

TThe authors wish it to be known that in their opinion, the first two authors should be regarded as Joint First Authors.

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on April 1,2016; revised on May 27,2016; accepted on June 6,2016

Abstract

Summary: Eukaryotic genomes are hierarchically organized into topologically associating domains
(TADS). The computational identification of these domains and their associated properties critically
depends on the choice of suitable parameters of TAD—calling algorithms. To reduce the element of
trial—and—error in parameter selection, we have developed TADtool: an interactive plot to find
robust TAD—calling parameters with immediate visual feedback. TADtooI allows the direct export of
TADS called with a chosen set of parameters for two of the most common TAD calling algorithms:
directionality and insulation index. It can be used as an intuitive, standalone application or as a

Python package for maximum flexibility.

Availability and implementation: TADtooI is available as a Python package from GitHub (https://
github.com/vaquerizaslab/tadtool) or can be installed directly via PyPl, the Python package index

(tadtool).

Contact: kai.kruse@mpi—muenster.mpg.de, jmv@mpi—muenster.mpg.de
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Chromosome conformation capture (3C) studies (Dekker et 61].,
2002), specifically their high—throughput derivative Hi—C
(Lieberman—Aiden et 61]., 2009), have revealed the hierarchical fold—
ing of eukaryotic genomes. Chromatin has been found to be typic—
ally organized into genomic regions With a strong enrichment of
intra—chromosomal contacts (Dixon et 61]., 2012; Nora et 61]., 2012;
Sexton et 61]., 2012; Hou et 61]., 2012). These regions, termed self— or
topologically—associating domains (TADs), can range in size from
hundreds to thousands of kilobases With smaller domains often
being nested Within larger ones (Fraser et 61]., 2015).

A number of algorithms to identify TADs computationally have
been developed. Among the most popular and intuitive are the direc—
tionality index (Dixon et al., 2012) and insulation index (Crane
et 61]., 2015). The former calculates upstream and downstream
contact biases for each locus along the genome — TAD boundaries
are then generally demarcated by strongly directionally biased loci.

©The Author 2016. Published by Oxford University Press.

The latter uses a rectangular sliding Window approach to sum up
contacts Within a given region surrounding each locus — as TADs are
regions of increased contacts, they can easily be identified via con—
tact count cutoffs.

The properties of identified domains critically depend on the
parameter choice of the applied TAD-calling algorithms. For the dir-
ectionality index, the Window size around a locus for Which biases
are computed primarily determines the size of the identifiable TADs.
The cutoff used for biases strongly inﬂuences the sensitivity and spe—
cificity of TAD identification. Changing the Window size and con—
tact cutoff in the insulation index algorithm has similar effects.
Finding suitable, robust parameters for the data set of interest is
often a multistep, iterative process of testing and recalculation. To
reduce the element of trial—and—error and to facilitate the meaningful
identification of self—associating domains, we have developed
TADtool: an interactive plot that assists in choosing relevant TAD—
calling parameters With immediate visual feedback.

1

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /310's113u1no [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

 

 

 

 

 

 

 

 

 

 

 

 

    

 

 

 

2 K.Kruse et al.
A II; I E
B WE: 0.13105 cutoff: 3.9):10'4
——
c E 4x10'3' '
E ‘ '
1: 3x1ﬂ'3- m -
'3 ' W5: 1.21XlCIP cutoff: 43(10"
E 2X10 3 - -
j .
E F
D 10: 
w _ — — —
3
Cl IDS
‘3 W5: 0123:1135 cutoff: Elli-til}2
104 : I
chr12:31UDUkb 315Clﬂlr<b 3ZUUDkb JZEUDkb 33000kb W5: 2.0):105 cutoff: 1.11:“?1

Fig. 1. (A—D) TADtool window. (A) Hi-C plot, (B) TADs (black bars) called with current window size (WS: 2.5 x 105) and cutoff (2.7 x 103), (C) insulation index plot
for current window size, (D) heatmap of insulation index for all window sizes. (E) Modifying TAD-calling parameters changes the identified TADs. (F) TADs called
from Dixon et al. (2012) data with window size used in the original publication (bottom) and modified (top)

2 Usage

TADtool is launched from the command line and requires two input
files: a square normalized Hi—C matrix and a list of genomic regions
that correspond to matrix bins. The user selects a genomic region of
interest and can choose between the insulation and directionality
index. After automatically calculating the values for the chosen
TAD-calling algorithm with a wide range of window sizes, an inter—
active figure will be opened that shows: a Hi—C plot (Fig. 1A) ,
TADs as called with the current set of parameters (Fig. 1B), a line
plot showing the respective index values for the current window size
(Fig. 1C), and a heatmap summarizing index values for all calcu—
lated window sizes (Fig. 1D).

The figure supports synchronized zooming and panning, and the
colour intensity of both heatmaps can be adjusted using sliders. By
clicking the line plot and heatmap the user can interactively select
the TAD—calling cutoff and window size, respectively — TAD regions
will be updated automatically. Thus, with only a few clicks, a mean-
ingful set of parameters for the chosen TAD-calling algorithm can
be selected. TADs as called with the current parameters and other
plot data can be directly saved to file using the provided buttons.

3 Discussion and conclusion

The usefulness of TADtool can easily be demonstrated on real—
world data sets. Fig. 1A shows a 2Mb region on mouse chromosome
12 with TADs of varying sizes, some of them nested (lymphoblas—
toid Hi—C data at 10kb resolution from Rao et al., 2014). TADs nat-
urally vary in size and intensity. By modifying parameters in
TADtool (Fig. 1E), especially the window size, it is possible to delib—
erately call smaller (top) or larger (bottom) TADs.

Fig. 1F shows the same region in a lower—resolution embryonic
stem cell Hi—C map (40 kb, Dixon et al., 2012), alongside direction—
ality index plots for two different sets of parameters. In the original
publication a window size of 2Mb was used (Fig. 1F, bottom).
Similarly to the insulation index, by adjusting the window size of
the directionality index we show that it is very easy to alternatively
identify smaller, nested TADs (Fig. 1F, top).

Fraser et al. (2015) have used a similar approach to derive hier—
archical TAD trees. With TADtool, the process of finding suitable

window sizes and cutoffs matched to the nested TAD sizes is greatly
simplified.

The chosen examples also illustrate that TAD calls can be very
sensitive to parameter changes in certain ranges. TADtool is de—
signed to find parameters that match the visual perception of how
TADs should be called and, importantly, that produce stable TADs
across a range of values. While this process is greatly simplified with
this tool, it remains the user’s responsibility to verify TAD calls in
their data using a range of parameter combinations and other, inde—
pendent statistical means.

In summary, this tool speeds up and improves the process of
finding meaningful parameters for two of the most popular TAD—
calling algorithms. As such, TADtool is of great practical value for
the genome organization community.

Acknowledgements

The authors thank all members of the Vaquerizas lab for useful input and
feedback during the implementation of this project.

Funding

This work was supported by EpiGeneSys NOE, ZENCODE-ITN, Deutsche
Forschungsgemeinschaft Cells-in-Motion Cluster of Excellence (EXC 1003—
CiM), University of Munster and the Max Planck Society. C.B.H. was sup-
ported by a fellowship from the graduate school International Max Planck
Research School—Molecular Biomedicine, Munster, Germany. B.H.-R.
received support from the European Union’s Horizon 2020 research and in-
novation programme under the Marie Sklodowska-Curie grant agreement No
643062 — ZENCODE-ITN.

Conﬂict of Interest: none declared.

References

Crane, E. et al. (2015) Condensin-driven remodelling of X chromosome top-
ology during dosage compensation. Nature, 523, 240—244.

Dekker, J. et al. (2002) Capturing chromosome conformation. Science, 295,
1 306—13 1 1.

Dixon, ].R. et al. (2012) Topological domains in mammalian genomes identi-
ﬁed by analysis of chromatin interactions. Nature, 485, 376—380.

112 /810'S[eu1no prOJXO'SOTlBIIlJOJUTOTQ/ﬂClllq 11101; pepBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

TADtool: visual parameter identification for TAD-calling algorithms

 

Fraser, J. et al. (2015 ) Hierarchical folding and reorganization of chromo-
somes are linked to transcriptional changes in cellular differentiation. Mol.
Syst. Biol., 11, 14.

Hou, C. et al. (2012) Gene density, transcription, and insulators contribute to
the partition of the drosophila genome into physical domains. Mol. Cell, 48,
471—484.

Lieberman-Aiden, E. et al. (2009) Comprehensive mapping of long-range
interactions reveals folding principles of the human genome. Science, 326,
289—293.

Nora, E.P. et al. (2012) Spatial partitioning of the regulatory landscape of the
X-inactivation centre. Nature, 485 , 381—385.

Rao, S.S.P. et al. (2014) A 3D map of the human genome at kilobase resolution
reveals principles of chromatin looping. Cell, 159, 1665—1680.

Sexton, T. et al. (2012) Three-dimensional folding and functional organization
principles of the Drosophila genome. Cell, 148, 45 8—472.

112 /310's112u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

