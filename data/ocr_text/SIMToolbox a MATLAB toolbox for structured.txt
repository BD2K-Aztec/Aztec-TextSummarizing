Bioinformatics, 32(2), 2016, 318—320

doi: 10.1093/bioinformatics/btv576

Advance Access Publication Date: 6 October 2015
Applications Note

 

 

Bioimage informatics

SlMToolbox: a MATLAB toolbox for structured
illumination fluorescence microscopy

Pavel Kriiek‘, Tomas Lukesz'3, Martin Ovesny1, Karel Fliegelz

and Guy M. Hagen4'*

1First Faculty of Medicine, Charles University in Prague, Prague 12800, Czech Republic, 2Department of Radioelectronics,
Faculty of Electrical Engineering, Czech Technical University in Prague, Prague 16627, Czech Republic, 3Laboratoire
d'Optique Biomédicale, Ecole Polytechnique Fédérale de Lausanne, Lausanne CH-1015, Switzerland and 4UCCS center
for the BioFrontiers Institute, University of Colorado at Colorado Springs, Colorado Springs, CO 80918, USA

* To whom correspondence should be addressed.
Associate Editor: Robert Murphy

Received on July 22, 2015; revised on September 28, 2015; accepted on September 30, 2015

Abstract

Summary: SlMToolbox is an open—source, modular set of functions for MATLAB equipped with a
user—friendly graphical interface and designed for processing two—dimensional and three—dimen—
sional data acquired by structured illumination microscopy (SIM). Both optical sectioning and
super—resolution applications are supported. The software is also capable of maximum a posteriori
probability image estimation (MAP—SIM), an alternative method for reconstruction of structured il—
lumination images. MAP—SIM can potentially reduce reconstruction artifacts, which commonly
occur due to refractive index mismatch within the sample and to imperfections in the illumination.

Availability and implementation: SlMToolbox, example data and the online documentation are

freely accessible at http://mmtg.fel.cvut.cz/SIMToolbox.
Contact: ghagen@uccs.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

In structured illumination microscopy (SIM), a sequence of images
is acquired, each taken with a different position of an illumination
pattern in a fluorescence microscope but without a mask in the de—
tection path (Heintzmann, 2006). Subsequent processing of the raw
data is required to reconstruct the final image. Current SIM methods
include optical sectioning microscopy (OS—SIM) (Kriiek et 61]., 2012;
Neil et 61]., 1997; Wilson, 2011) and super—resolution SIM (SR—SIM)
(Gustafsson, 2000; Gustafsson et 61]., 2008; Heintzmann and
Cremer, 1998).

Several different algorithms can be used to process SIM data
(Heintzmann, 2006). SIMToolbox offers a set of MATLAB func—
tions for processing both OS—SIM and SR—SIM data according to a
variety of methods. SIMToolbox can also apply an alternative
method for processing the data, maximum a posteriori probability
estimation (MAP—SIM) (Lukes et 61]., 2014). The tools can be ac—
cessed from a user—friendly graphical user interface.

Our goal is to offer a collection of processing methods, which
were developed based on extensive testing with real data. The soft—
ware can be used to process data acquired by commercial SIM sys—
tems; however, some of the tools and documentation provided are
meant for researchers developing their own systems. In addition to
the software, we provide example data, a user’s guide and a detailed
description of the implemented methods and algorithms. Please refer
to the Supplementary Note for further details.

2 Features and methods

2.1 OS-SIIVI

SIMToolbox can process OS—SIM data using homodyne detection
(Kfiiek et 61]., 2012; Neil et 61]., 1997), maximum—minimum projection
(Heintzmann, 2006) or several forms of scaled subtraction
(Heintzmann, 2006; Kfiiek et 61]., 2012). When using scaled subtraction,
it is necessary to have knowledge of the illumination pattern positions

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 318

91% ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

SlMToolbox

319

 

in the camera image. We accomplish this by spatial calibration using an
alignment pattern ( Vizek et 61]., 2012). Residual stripes are corrected
using a method introduced by Cole et a1. (2001).

2.2 SR-SIIVI

SIMToolbox can process SR—SIM data using the Heintzmann—
Gustafsson method (Gustafsson, 2000; Gustafsson et al., 2008;
Heintzmann and Cremer, 1998). Brieﬂy, the image processing steps are
as follows:

1. Forward fast Fourier transformation (FFT) of the raw data.
2. Identiﬁcation of peaks in the frequency spectrum. The software
can accomplish this with high accuracy using spatial calibration

 

Fig. 1. Widefield (WF) image and OS-SIM, SR-SIM and MAP-SIM reconstruc-
tions of images of a HEP-G2 cell in which the actin cytoskeleton has been
labeled with Att0565-phalloidin. (a) WF. (b) FFT of WF. (c) OS-SIM, homodyne
method. (d) FFT of OS-SIM image. (e) SR-SIM processing. (f) FFT of SR-SIM.
(g) MAP-SIM. (h) FFT of MAP-SIM. Images are maximum intensity projections
of 31 axial sections and have been individually brightness adjusted for
presentation

methods (Kriiek et 61]., 2012) or using spot detection methods
(Ovesny et al., 2014).

3. Shifting of spectral components in frequency space.

4. Apodizing the frequency spectrum according to one of several
possible functions. SIMToolbox offers several apodizing func-
tions including a standard incoherent model, cosine bell,
Butterworth, triangle and application of the Lukosz bound
(Righolt et al., 2013).

5. Inverse FFT with an adjustable inverse ﬁlter parameter to re—
cover an image with resolution beyond the conventional limit.

2.3 MAP-SIM

An alternative method for processing SR—SIM data is the MAP—SIM
method introduced by our group (Lukes et al., 2014a, b). Here,
image details beyond the diffraction limit are estimated by max—
imum a posteriori restoration methods, and optically sectioned, con—
ventional resolution image information is processed by homodyne
detection. The two components are then combined by spectral merg—
ing in the frequency domain. The result is then apodized, and an in—
verse FFT is performed to recover the final image.

Our experience has been that MAP—SIM can, in some cases, pro—
duce super—resolution images with fewer artifacts than the
Heintzmann—Gustafsson method. Such artifacts seem to be primar—
ily caused by problems with the sample, especially refractive index
mismatch between the mounting medium and immersion ﬂuid.
Reconstruction artifacts can also be caused by high noise levels, by
poor SIM pattern contrast or other imperfections in the illumination
or by the use of inappropriate parameters in the reconstruction pro—
cess. For example, we have found that the choice of apodizing and
inverse filter parameters (SR—SIM steps 4 and 5 above) have a large
impact on the results.

Figure 1 shows a comparison of some of the various methods
supported by SIMToolbox, acquired using the methods introduced
by our group (Krizek et al., 2012). Please see the Supplementary
Note for more details about this SIM experiment.

3 Summary

SIMToolbox is open—source software for processing SIM data. This
allows researchers building their own systems to process their data
using a unique set of tools and concepts. The software also offers
features not currently present in commercially available software,
making it a useful choice for reconstructing super—resolution images
acquired with commercial equipment.

Funding

This work was supported by the UCCS center for the BioFrontiers Institute
and by the CTU (SGSl4/ 148/OHK3/2T/ 13). TL. acknowledges a SCIEX fel-
lowship (project code 13.183).

Conﬂict of Interest: none declared.

References

Cole,M.]. et al. (2001) Time-domain whole-ﬁeld ﬂuorescence lifetime imaging
with optical sectioning. ]. Mimosa, 203, 246—25 7.

Gustafsson,M.G.L. (2000) Surpassing the lateral resolution limit by a factor of
two using structured illumination microscopy. ]. Microsc., 198, 82—87.

Gustafsson,M.G.L. et a]. (2008) Three-dimensional resolution doubling in
Wideﬁeld ﬂuorescence microscopy by structured illumination. Biophys. ].,
94, 4957—4970.

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘BIUJOJIIBD aIo Amie/xtqu 112 /3JO'S[BUJHOIpJOJXO'SOIlBIIlJOJUIOIQ/ﬂdllq 11101; popeommoq

320

P. Kfl'z"ek et al.

 

Heintzmann,R. (2006) Structured illumination methods. In: Pawley,].B. (ed.)
Handbook of Biological Confocal Microscopy. Springer, New York, pp.
265—279.

Heintzmann,R. and Cremer,C. (1998) Laterally modulated excitation microscopy:
improvement of resolution by using a diffraction grating. Proc. SPIE, 3568,
185—196.

Kfiiek,P. et al. (2012) Flexible structured illumination microscope with a pro-
grammable illumination array. Opt. Express, 20, 24585—245 99.

Lukes,T. et al. (2014a) Comparison of image reconstruction methods
for structured illumination microscopy. In: Popp,]. et al. (eds.) SPIE
Pkotonics Europe. International Society for Optics and Photonics,
Bellingham, WA, p. 91293].

Lukes,T. et al. (2014b) Three-dimensional super-resolution structured illumin-
ation microscopy with maximum a posteriori probability image estimation.
Opt. Express, 22, 29805—29817.

Neil,M.A.A. et al. (1997) Method of obtaining optical sectioning by using
structured light in a conventional microscope. Opt. Lett., 22, 1905—1907.
Ovesny,M. et al. (2014) ThunderSTORM: a comprehensive Image] plug-in
for PALM and STORM data analysis and super-resolution imaging.

Bioinformatics, 30, 23 89—2390.

Righolt,C.H. et al. (2013) Image ﬁltering in structured illumination micros-
copy using the Lukosz bound. Opt. Express, 21, 24431—2445 1.

Wilson,T. (2011) Optical sectioning in ﬂuorescence microscopy. ]. Microsc.,
242, 111—116.

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IT10prOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pop1201umoq

