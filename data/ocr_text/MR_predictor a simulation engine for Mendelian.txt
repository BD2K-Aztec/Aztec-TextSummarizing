APPLICA TIONS NOTE W 352,-? ? 5.539233213i5éi’2232‘3/1132ﬁ

 

Genetics and population analysis

Advance Access publication August 26, 2014

MR_predictor: a simulation engine for Mendelian Randomization

studies
Benjamin F. Voigh

12*
t!!

1Department of Pharmacology and 2Department of Genetics, University of Pennsylvania — Perelman School of Medicine,

Philadelphia, PA 19143, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Summary: I present MR_predictor, a simulation engine designed to
guide the development and interpretation of statistical tests of caus-
ality between phenotypes using genetic instruments. MR_predictor
provides a framework to model either individual traits or complex
scenarios where multiple phenotypes are correlated or dependent
on each other. Crucially, MR_predictor can incorporate the effects of
multiple biallelic loci (linked or unlinked) contributing genotypic vari-
ability to one or more simulated phenotypes. The software has a range
of options for sample generation, and output files generated by
MR_predictor port into commonly used analysis tools (e.g. PLINK,
R), facilitating analyses germane for Mendelian Randomization
studies. Benchmarks for speed and power calculations for summary
statistic-based Mendelian Randomization analyses are presented and
compared with analytical expectation.

Availability and implementation: The simulation engine is imple-
mented in PERL, and the associated scripts can be downloaded
from github.com, and online documentation, tutorial and example
datasets are available at http://coruscant.itmat.upenn.edu/mr_
predictor.

Contact: bvoight@upenn.edu

Supplementary information: Supplementary derivations are available
at Bioinformatics online.

Received on May 20, 2014; revised on August 12, 2014; accepted on
August 16, 2014

1 INTRODUCTION

The discovery of genetic polymorphisms contributing to a wide
range of human phenotypes has made causal inference between
traits or disease endpoints feasible, by using these polymorph-
isms as instrumental variables (Smith and Ebrahim, 2003). The
approach, dubbed Mendelian Randomization, can be conceptua-
lized as a natural version of a randomized control trial, as alleles
that elevate or lower a biomarker of interest assort randomly at
meiosis. One popular application ﬁnds a researcher having
selected multiple, unlinked polymorphic sites reproducibly
associated to a biomarker of interest, which are then assayed
for relationship to a disease endpoint Woight et al., 2012).
Causal inference can be assessed using either individual geno-
types or the equivalent estimated effects summarized from
large-scale association studies; both approaches to inference are

 

*To whom correspondence should be addressed.

statistically valid if assumptions are satisﬁed (Burgess and
Thompson, 2013).

As additional phenotypes and genetic associations continue to
be cataloged, Monte Carlo approaches that efﬁciently model
complex phenotypic and genotypic relationships will be useful
for continued analytical and methodological progress (Brion
et al., 2013; Harbord et al., 2013) and addressing more complex
models WanderWeele et al., 2014). Unfortunately, existing
software is optimized for genomics/genetic architecture applica-
tions, which is careful to incorporate linkage between sites as
well as other population genetic features at computational ex-
pense, and does not easily handle complex relationships between
multiple traits and genetic variants, simultaneously (Gunther
et al., 2011; Li and Li, 2008; Peng and Amos, 2010). Thus, I
report a Monte Carlo approach designed to generate samples
of unrelated individuals presenting multiple phenotypes
that also segregate genetic polymorphisms that contribute to
them.

2 METHODS

Users begin by specifying the list of phenotypes along with associated
trait parameters and covariates, pairwise correlation between intermedi-
ate traits and the impact each intermediate trait has to the outcome trait
and, ﬁnally, the list of genetic variants, alleles, population frequencies and
effects of each site for a given trait. This basic framework allows users to
generate data from a number of models relevant for Mendelian
Randomization (MR) studies.

The program initializes the variance genetic component for each trait,
0%,, by generating values from the genotype—phenotype relationship based
on the user speciﬁcation. From this, the non-genetic component, 02E, for
the mean, variance and covariance for all intermediate traits is deter-
mined. Values are selected such that each intermediate trait is distributed
in the population with zero mean, unit variance (02E + 0G = 1) and covari-
ance matching the user speciﬁcation. Here, I have implemented a model
without interactions between genetic components, non-genetic compo-
nents, or among different phenotypes/traits.

After initialization, individuals are simulated with associated genotypes
and phenotypes from the model by

(1) simulating the contribution from 0% for all intermediate traits from
a multivariate normal distribution;

(2) simulating genetic data based on speciﬁed frequencies, assuming
Hardy—Weinberg Equilibrium;

(3) incorporating the genetic effect on the phenotypes for the individ-
ual based on the simulated genotypes; an additive effect is added or

 

3432 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 [3.10811211an[plOJXO'SODBIILIOJIIlOlQ/ﬂ(11111 won popcolumoq

910K ‘09 lsnﬁnV no :2

MR _predictor

 

subtracted from the phenotype for homozygotes, and dominance
term added to the heteozygote class.

(4) simulating additional covariates, if necessary;

(5) assigning an endpoint state to the individual using contributing
variables;

(6) if the number of cases and controls has been speciﬁed and has not
been met, accept the individual. Otherwise, reject and repeat until
the total numbers have been ascertained.

A binary endpoint is assigned to an individual using an approach
analogous to the logit model described by Wu et al. (2011), where
trait or covariates contributes log-additively to the probability of the
endpoint, with user-speciﬁed background rate (etc) for the population
prevalence. Users can also control how genetic variants relate to the
endpoint, i.e. through an intermediate trait or directly on the endpoint.
Simulated data are returned as pedigree, map and covariate ﬁles that are
compatible with the genetic analysis package, PLINK (Purcell et al.,
2007).

3 RESULTS

3.1 Benchmarking

I simulated 10000 individuals for three biomarker traits—high
and low density lipoprotein cholesterol levels and triglyercides
(HDL-C, LDL—C and TG, respectively)—with between-trait cor-
relation determined from epidemiological observation (Emerging
Risk Factors Collaboration et al., 2009), using 139 variants with
175 variant to trait relationships (Global Lipids Genetics
Consortium et al., 2013). On an Intel Xeon E7-4870 Core
(2.40 GHz), it took 64 s, with time scaling linearly by total
sample size (e. g. 20 000 samples took 131 s on average) and vari-
ants (n = 70 variants took 31 s). Ascertainment generating 2000
affected individuals (10% population prevalence), with estimates
for LDL-C and TG to the endpoint from Voight et al. (2012),
took 97 s.

3.2 Example: power calculations

In MR studies, one goal is to estimate the effect of the change
in a biomarker of interest to risk of a disease endpoint. Deﬁne ,6
as the causal effect of the biomarker on endpoint, and the null
hypothesis that ,6 = 0. By selecting a genetic instrument that has
a strong, direct, and exclusive effect on the biomarker, ,6 can be
estimated via instrumental variable regression or score-based
MR, generating a test statistic to evaluate if ,6 is signiﬁcantly
different from zero. A signiﬁcant test provides support for the
hypothesis that the biomarker is causally related to the endpoint
of interest (based on the genetic instrument that changes the
biomarker trait), and addresses issues of confounding and
reverse causality owing to random assortment of alleles at
meiosis. The mean of this statistic directly relates to the power
to discover a causal effect between a biomarker and the
endpoint.

Analytic power determined for a single marker on a binary
outcome has been described by Burgess (2014), by which the
simulation engine can be compared with. From there, equations
that incorporate multiple genetic instrumental variables with
differences in variance explained and in samples sizes at each
variant can be written (see Supplementary Note). Across L
total variants, for nf‘ cases and  controls and the variance of

the biomarker explained by the i-th genetic instrument (0%), the
log-odds causal effect of the biomarker on disease endpoint (,6)
and the total variance of the biomarker explained by the genetic
instrument across all loci (02), the given test statistic under the
alternative is distributed with unit variance and a mean of :

:3 L  2
M=—. -O". 
./02 gvnfmy ‘

Results presented in Table 1 demonstrate that simulation closely
matches analytical expectations (Equation 1) for a single genetic
instrument, for multiple genetic instrumental variables assembled
into a single score-based MR analysis (Johnson, 2012) and, ﬁ-
nally, when the effect of the instrument and/ or sample sizes also
vary. In all cases, the median estimates for the true, causal effect
(,6) matched closely to that which was simulated (data not
shown).

 

3.3 Example: unweighted score statistics

I next compared the mean of the score-based MR test statistic,
without weighting on the biomarker effect. If the biomarker
effect is equal for all single nucleotide polymorphisms (SNPs)
contributing to the score, the mean of the weighted and un-
weighted test is equal and matches analytical expectation
(Equation 1). If the biomarker effects are unequal, the un-
weighted test has slightly lower mean (Table 1, row 8 versus
10), consistent with previous observations (Burgess and
Thompson, 2013). If selected variants were subject to winner’s
curse, selected weights, in some cases, may be upwardly biased.

Table 1. Comparison of the mean of the MR test statistic estimated from
simulation (ft) to analytical expectation (,u) for a one or more genetic
instruments

 

 

nA nU Number of IVs 02 ,8 ,u [t (95% SEM)

10 000 10 000 1 0.02 0.2 2.00 2.02 (2.00—2.04)
10 000 10 000 1 0.02 0.3 3.00 2.99 (2.97—3.01)
10 000 10 000 1 0.03 0.3 3.67 3.66 (3.64—3.68)
10 000 20 000 1 0.03 0.3 4.24 4.26 (4.24—4.28)
10 000 10 000 5 0.006 0.3 3.67 3.68 (3.66—3.70)
10 000 10 000 50 0.0006 0.3 3.67 3.66 (3.64—3.68)
5, 10k 5, 10k 2 0.03 0.3 4.50 4.49 (4.47—4.51)
10 000 10 000 10 0.055a 0.3 4.98 4.95 (4.93—4.97)
5, 10kb 5, 10k 10 0.055*‘ 0.3 3.92 3.95 (3.93—3.97)
10 000 10 000 10 0.055a 0.3 c 4.74 (4.72—4.76)

10000 10000 50 0.0006 0.3 d 3.50 (3.48—3.52)

 

Note. IVs, number of instrumental variables (SNPs) in the score; 02, the variance
contributed to the biomarker per variant site; ,8, the assumed effect of biomarker on
the endpoint, SEM, standard error on the mean; k, thousand; nA, number of cases;
nU, number of controls.

aTotal variance explained is listed; individual loci range from 0.001, 0.002, . . ., 0.01.
bThe strongest five genetic variants were evaluated in 5000 cases and controls; the
weakest ﬁve in 10000 cases and controls.

cResult based on an unweighted score statistic.

dResult where biomarker weights for 20% of IVs are biased upward (winner’s
curse).

 

3433

112 [3.10811211an[p.IOJXO'SODBIIHOJIIIOIQ/ﬂ(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

B.F. Voight

 

In this case, the unweighted statistic has slightly better perform-
ance (3.67 if unweighted vs. 3.51 if weighted). Thus, weighting
can improve the power of the test if modeled appropriately, while
tests without such weighting in some case provides a degree of
model robustness.

Funding: The author is indebted to the Alfred P. Sloan
Foundation (BR2012-087), the American Heart Association
(13SDG14330006), and the W.W. Smith Charitable Trust
(H1201) who provided support for the work.

Conflict of interest: none declared.

REFERENCES

Brion,M.J. et al. (2013) Calculating statistical power in mendelian randomization
studies. Int. J. Epidemiol, 42, 1497—1 501.

Burgess,S. (2014) Sample size and power calculations in mendelian randomization
with a single instrumental variable and a binary outcome. Int J. Epidemiol, 43,
922—929.

Burgess,S. et al. (2013) Use of allele scores as instrumental variables for mendelian
randomization. Int. J. Epidemiol, 42, 1134—1144.

Emerging Risk Factors Collaboration et al. (2009) Major lipids, apolipoproteins,
and risk of vascular disease. JAMA, 302, 1993—2000.

Global Lipids Genetics Consortium et al. (2013) Discovery and reﬁnement of loci
associated with lipid levels. Nat Genet, 45, 1274—1283.

Gﬁnther,T. et al. (2011) Phenosim—a software to simulate phenotypes for testing in
genome-wide association studies. BM C Bioinformatics, 12, 265.

Harbord,R.M. et al. (2013) Severity of bias of a simple estimator of the
causal odds ratio in mendelian randomization studies. Stat. Med, 32,
1246—1258.

J ohnson,T. (2012) Efﬁcient calculation for multi-snp genetic risk scores. Presented
at the American Society of Human Genetics Annual Meeting, San Francisco,
November 6-10. Abstract Number 1400W. Poster available at: http://cran.
r-project.org/web/packages/gtx/vignettes/ashg20l2.pdf.

Li,C. and Li,M. (2008) Gwasimulator: a rapid whole-genome simulation program.
Bioinformatics, 24, 140—142.

Peng,B. et al. (2010) Forward-time simulation of realistic samples for genome-wide
association studies. BMC Bioinformatics, 11, 442—442.

Purcell,S. et al. (2007) Plink: a tool set for whole-genome association and popula-
tion-based linkage analyses. Am. J. Hum. Genet, 81, 559—575.

Smith,G.D. and Ebrahim,S. (2003) ‘Mendelian randomization’: can genetic epi-
demiology contribute to understanding environmental determinants of disease?
Int. J. Epidemiol, 32, 1—22.

VanderWeele,T.J. et al. (2014) Methodological challenges in mendelian randomiza-
tion. Epidemiology, 25, 427—435.

Voight,B.F. et al. (2012) Plasma HDL cholesterol and risk of myocardial infarction:
a mendelian randomisation study. Lancet, 380, 572—580.

Wu,M.C. et al. (2011) Rare-variant association testing for sequencing data with the
sequence kernel association test. Am. J. Hum. Genet, 89, 82—93.

 

3434

112 ﬁlm'spaumo[pJOJXO'sot1chOJutotw/2d11q IIIOJJ papeolumoq

910K ‘09 lsnﬁnV uo 22

