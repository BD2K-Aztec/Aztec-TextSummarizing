ORIGINAL PAPER

Vol. 27 no. 19 2011, pages 2633-2640
doi: 1 0. 1 093/bioinformatics/btr458

 

Sequence analysis

Advance Access publication August 8, 2011

FDM: a graph-based statistical method to detect differential

transcription using RNA-seq data

Darshan Singhl’*, Christian F. Orellanal, Yin Hu2, Corbin D. Jones3, Yufeng Liu4,

Derek Y. Chiang5, Jinze Liu2 and Jan F. Prins1

1Department of Computer Science, University of North Carolina at Chapel Hill, Chapel Hill, NC,
2Department of Computer Science, University of Kentucky, Lexington, KY, 8Department of Biology,
4Department of Statistics and Operations Research and 5Department of Genetics, University of North Carolina at

Chapel Hill, Chapel Hill, NC, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: In eukaryotic cells, alternative splicing expands the
diversity of RNA transcripts and plays an important role in tissue-
specific differentiation, and can be misregulated in disease. To
understand these processes, there is a great need for methods to
detect differential transcription between samples. Our focus is on
samples observed using short-read RNA sequencing (RNA-seq).
Methods: We characterize differential transcription between two
samples as the difference in the relative abundance of the transcript
isoforms present in the samples. The magnitude of differential
transcription of a gene between two samples can be measured by
the square root of the Jensen Shannon Divergence (JSD*) between
the gene’s transcript abundance vectors in each sample. We define a
weighted splice-graph representation of RNA-seq data, summarizing
in compact form the alignment of RNA-seq reads to a reference
genome. The flow difference metric (FDM) identifies regions of
differential RNA transcript expression between pairs of splice graphs,
without need for an underlying gene model or catalog of transcripts.
We present a novel non-parametric statistical test between splice
graphs to assess the significance of differential transcription, and
extend it to group-wise comparison incorporating sample replicates.
Results: Using simulated RNA-seq data consisting of four technical
replicates of two samples with varying transcription between genes,
we show that (i) the FDM is highly correlated with JSD* (r:0.82)
when average RNA-seq coverage of the transcripts is sufficiently
deep; and (ii) the FDM is able to identify 90% of genes with
differential transcription when JSD* >028 and coverage >7. This
represents higher sensitivity than Cufflinks (without annotations)
and rDiff (MMD), which respectively identified 69 and 49% of the
genes in this region as differential transcribed. Using annotations
identifying the transcripts, Cufflinks was able to identify 86% of the
genes in this region as differentially transcribed. Using experimental
data consisting of four replicates each for two cancer cell lines
(MCF7 and SUM102), FDM identified 1425 genes as significantly
different in transcription. Subsequent study of the samples using
quantitative real time polymerase chain reaction (qRT-PCR) of several
differential transcription sites identified by FDM, confirmed significant
differences at these sites.

Availability: http://csbio-Iinux001.cs.unc.edu/nextgen/software/FDM
Contact: darshan@email.unc.edu

 

*To whom correspondence should be addressed.

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 6, 2011; revised on July 12, 2011; accepted on
August 1, 2011

1 INTRODUCTION

The transcriptome is a key vantage point for a molecular biologist’s
study of phenotypic differences between cells that result from
environmental factors, cell specialization or disease. Classically,
this study has been conducted largely by observing differential
gene expression levels using microarrays or high—throughput
RNA sequencing technologies. However, detailed analysis of the
transcriptome has shown that signiﬁcant variation is also encoded
in the diversity and relative abundance of a gene’s constituent
transcripts (Kwan et al., 2008; Sultan et al., 2008; Wang et al., 2008).
Consequently, beyond measuring differences in overall expression
of genes between samples, there is a need to measure differences in
expression at the transcript level.

We deﬁne diﬁ‘erential transcription of a gene between samples
as a difference in the relative abundance of the gene’s transcript
isoforms in the samples. In this manner, differential transcription is
independent of the overall gene expression in the samples.

Short—read RNA sequencing technologies (RNA—seq) have
evolved rapidly to sample the transcriptome at increasing depth and
accuracy (Wang et al., 2009). Using RNA—seq datasets obtained
from samples, the locus and depth of coverage by reads aligned to
a reference genome provide the starting point for the detection of
differential transcription (Pan et al., 2008).

Recently, two approaches have emerged to detect differential
transcription between samples. The ﬁrst approach is based on
transcript inference and abundance estimation of the transcripts, as
performed by tools like Cufﬂinks (Trapnell et al., 2010), rQuant
(Bohnert and R'atsch, 2010), Trans—Abyss (Robertson et al., 2010)
and Scripture (Guttman et al., 2010). Applying these methods to
each of two samples, differential transcription can be determined
directly for each gene using the estimated relative abundances of the
gene’s transcripts in the two samples. However, transcript inference
algorithms rely on heuristics to resolve the transcript structure,
because the inference problem is, in general, underdetermined. As
a result, some transcripts may be missed or inferred incorrectly.
Abundance estimation, in turn, is not able to correctly explicate

 

© The Author(s) 2011. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/Iicenses/
by—nc/3.0), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§.IO'SIBUJHOprOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq U101} popnommoq

9IOZ ‘091sn8nv uo ::

D.Singh et aI.

 

the observed distribution of read alignments when starting from
an incomplete or incorrect transcript model. Thus, differential
transcription measured in this fashion may be inaccurate.

The second approach to detect differential transcription is based
on observing loci in the reference genome at which reads from the
two datasets align with different depth of coverage (after appropriate
normalization for differing gene expression). The idea is that
differential transcription should be revealed by different utilization
of some exons. Stegle et al. (2010) describe two methods along these
lines. The ﬁrst is based on a priori analysis of annotated transcripts
to identify regions that could reveal differential transcription. In
each region, a Poisson statistical test is applied. The second method
is without dependence on known transcript structure, and uses a
non—parametric kernel—based statistical test called maximum mean
discrepancy. Using synthetic data, both methods are shown by Stegle
et al. (2010) to give accurate detection of differential transcription.

In this article, we introduce an approach that does not depend
on annotations and instead leverages the splicing structure of a
gene uncovered by spliced read alignments using tools like TopHat
(Trapnell et al., 2009), MapSplice (Wang et al., 2010) or PALMapper
(Jean et al., 2010). Using the read alignments from these tools, a
splice graph is constructed with edges corresponding to transcribed
intervals or splices, weighted by read coverage. We introduce the
ﬂow diﬁ‘erence metric (FDM) to measure the difference between
two graphs in the relative utilization of edges at splicing points.
Using synthetic samples, for which we know the transcripts and
their relative abundances, we show the FDM between two samples
is highly correlated with the J SD*, provided coverage of the edges
is sufﬁcient. Hence, the FDM can serve as a metric of differential
transcription, without need to infer the underlying transcripts or need
for any annotation.

To interpret the signiﬁcance of the FDM, we deﬁne a permutation
test that can be efﬁciently implemented on the splice graph
representation of the RNA—seq data. Since pairwise comparison of
two samples is often insufﬁcient to draw robust conclusions about
differential transcription between two biological conditions, we
extend the statistical test to incorporate replicates in each condition,
when they are available. The test identiﬁes differential transcription
that is signiﬁcant between conditions more often than it is signiﬁcant
within replicates.

2 METHODS

2.1 J ensen—Shannon divergence as a measure of
differential transcription

Let G be a gene with n different transcripts. In a given sample, the transcript
abundance vector for G gives the relative abundance of each transcript
isoform, i.e. the fraction of each isoform among all isoforms of G. One
measure of differential transcription between two samples A and B, with
transcript abundance vectors VA and VB, is the J ensen—Shannon Divergence

VA +VB) _ H(VA)+H(VB)
2 2

where H ( V) is the Shannon entropy. The J SD itself is not a metric, but J SD*
= x/JS—D does satisfy the properties of a metric.

We adopt J SD* to measure differential transcription in this article, because
it deﬁnes an objective measure of difference in transcript populations that is
independent of the computational methods we examine. It has also been used
to report differential transcription in other methods, e. g. CuffDiff (Trapnell
et al., 2010).

 

JSD(VA,VB)=H(

2.2 Aligned cumulative transcript graph

The alignment of RNA—seq reads to a reference genome provides (i)
the genomic coordinates of transcribed bases and (ii) the start and end
coordinates of splices. As a consequence of alternative splicing, transcribed
bases and splices may be part of multiple RNA transcripts and hence their
coverage by aligned reads reﬂects their total utilization by all transcripts.

In the literature, transcripts have been mostly represented as paths
in an acyclic directed graph with exons as nodes and splices as
edges, e.g. Heber et al. (2002) and Sammeth’s Flux Capacitor
(http://ﬂux.sammeth.net/capacitor.html). Analyzing the read coverage
information with this data structure has limitations. First, this representation
can only be used if all exons are known beforehand, which is usually not
the case. Second, if two or more exons overlap in a region (e. g. in the case
of alternative 5/ donor sites or 3/ acceptor sites), the read coverage needs to
be determined separately for each of those exons. Our graph representation
addresses these limitations.

The Aligned Cumulative Transcript Graph (ACT—Graph) is a weighted
directed acyclic multigraph in which nodes correspond to genomic
coordinates of splice start or end sites or to transcription start or end sites.
Edges correspond to transcribed intervals (exonic edge) or to spliced—out
intervals (splice edge). The weight of an exonic edge is its average coverage
over the genomic interval it spans, and the weight of a splice edge is the
number of reads that include the splice. The direction of the edges is the
direction of transcription. Each exonic edge is transcribed as whole, i.e. it is
included in its entirety in a transcript or not at all.

In principle, an ACT—Graph is the sum of weighted paths (ﬂows), each of
which is a transcript with some speciﬁc abundance. Therefore, we named the
graph the ACT—Graph. Figure 1 shows an example of ACT—Graph. In practice,
since reads are sampled non—uniformly from transcripts due to various biases,
we use average coverage as an approximation of the total abundance.

2.2.1 ACT -Graph construction The following describes the step—by—step
construction of an ACT—Graph from RNA—seq data:

(1) Spliced Alignment: RNA—seq reads are aligned to the reference
genome using a gapped aligner such as MapSplice (Wang et al., 2010).

(2) ACT—Graph nodes: the ACT—Graph nodes are created using one of the
following—(i) Splices: genomic coordinates of splice start and end
locations are obtained from spliced alignments; (ii) interpreting start
and end sites of transcripts: we can use inference or annotations to
identify these sites. We can infer the start of a transcript based on the
observation that the ﬁrst (15 — 1) bases following the start coordinate,
where 15 is the RNA—seq read length, show a characteristic ramp of
increasing coverage as there are increasingly many ways for a read to
sample bases further away from the start of a transcript. A transcription
end site is inferred similarly. Alternatively transcript start and end
coordinates can be taken from gene annotations, if available. Nodes
introduced in this fashion are not harmful if the transcripts happen
not to be expressed.

(3) ACT—Graph edges and weights: (i) a splice edge is inferred from a
spliced alignment. The weight of the splice edge is the number of
reads that support the splice. The direction of the edge is inferred
from the orientation of the ﬂanking bases in the intron for canonical
splices or it can be inferred from the direction of other splices in
the gene. (ii) An exonic edge connects two adjacent nodes (from the
sorted list of nodes) if the genomic interval is fully covered or nearly
fully covered and has an average coverage above threshold. We use a
threshold of 1. The weight of an exonic edge is the average coverage
of that genomic region. Averaging over the genomic region gives a
better estimate of the number of transcripts that use that genomic
region.

(4) ACT—Graph genes and transcribed regions: a transcribed region is a
connected component in the ACT—Graph when edges are considered
as undirected, and typically would correspond to genes. If gene

 

2634

112 /§JO'S[BUJHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; popeoprmoq

9IOZ ‘09 lsnﬁnv uo ::

FDM: differential transcription analysis

 

82031576

    
   

MutuaHy
I ExduQve
Exons

Retained
Intron

Spred
Exon

 

Akernaﬁve
5'end

82049434

Fig. 1. ACT—Graph: the nodes are genome coordinates. A solid (blue) edge
represents an exon or part of an exon labeled with the average depth of
read coverage along the interval. A dashed (green) edge is a splice edge
and is labeled by the number of reads that include the splice. Alternative
splicing features such as mutually exclusive exons, a retained intron and a
skipped exon are illustrated. Nodes drawn as boxes, circles and hexagons,
respectively, represent annotated—only positions, novel—only splice positions
and both annotated and novel positions.

annotations are available, the regions can be restricted to known
genes. The coverage of a gene is deﬁned as average base coverage
over all the bases of the exonic regions in the gene.

2.2.2 AC T—Graph compressed representation The ACT—Graph is stored in
the standard GFF format. The ﬁeld TYPE tells if the line describes a node,
a splice edge or an exonic edge. The ﬁeld SCORE is used for weight of
the edges. The ACT—Graph format is a concise summary of alignments, and
is powerful representation for quantitative analysis of alternative splicing.
Figure 2 shows the compression achieved by the ACT—Graph representation
as a function of the number of reads. The ACT—Graph is typically two to three
orders of magnitude smaller than the SAM ﬁle or the raw reads, depending
on the number of reads in the dataset and can be used for a number of
downstream analyses, such as differential transcription.

 

 

 

 

 

$ze(MB)

 

 

 

106 10 10
# ofreads

Fig. 2. ACT—Graph Compression (Section 2.2.2): plot of ﬁle sizes of ACT—
Graph (ACTG), FastQ ﬁle (FASTQ) and the alignment ﬁle (SAM). As the
number of reads increases, the storage used by ACT—Graph increases orders
of magnitude more slowly than other representations.

2.2.3 Alternative splicing features in ACT-Graph The ACT—Graph can
be used to identify various alternative splicing features in a gene. Each
alternative splicing feature can be represented by a subgraph which can
be searched in the ACT—Graph. Figure 1 shows examples of various such
features in a gene.

2J3 IHDRI

In this section, we describe the FDM, which uses the ACT—Graph to
ﬁnd genes with differential transcription. As stated earlier, the ACT—Graph
can be viewed as the sum of weighted paths or ﬂows, each of which
corresponds to a transcript with some abundance. ACT—Graph nodes that
have m > 1 incoming or outgoing edges indicate that at least m transcripts
use that node. These nodes are called divergence nodes. Divergence nodes
imply alternative splicing. The m incoming/outgoing edges are called the
divergence edges. The weights of divergence edges signify the relative
abundances of alternative transcripts passing through the divergence node.
The normalized weights of all the divergence edges of a node are grouped
together in a vector called the ﬂow vector for the node. The difference
between ﬂow vectors in ACT—Graphs constructed from different samples
indicates the magnitude of differential transcription between the two
samples.

We measure the difference in ﬂow vectors using a metric called the
FDM which is deﬁned as follows. Assume an ACT—Graph has n divergence
nodes. The ﬂow vector for divergence node i of sample A is deﬁned as
Vf‘=[e(a,i)1,...,e(a,i)m] where m is the number of edges at node i and
e(a, i)j is the normalized coverage at edge j, such that  e(a, i)j = 1. The
ﬂow difference between samples A and B at divergence node i is

I:I)iC4,lg)==:E::le(avi)i__e(b’i)l
j=1

The FDM is computed as
1 n
FDM(A,B) = Z ;(FDI(A,B))
1::

as illustrated in Figure 3.

It is important that ACT—Graphs of both samples have identical nodes and
edges. If a node or edge is present in only one ACT—Graph, it is added to
the other one with weight zero. The weights of exonic edges split by added
nodes are recomputed using the alignments.

 

2635

112 /§JO'S[BUJHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; popeoprmoq

9IOZ ‘09 lsnﬁnv uo ::

D.Singh et aI.

 

20 80 100
Illiill Illiill Illizll
‘~\ ‘780 ~780‘\

Transcript 1
20

Transcript 2
O

ACT-G ra ph

00

:10 :10,/
n
10 50
III
Transcript 1 Transcript 2 ACT.(; ra ph
40 10

Fig. 3. FDM and J SD illustration: an example for a gene in two samples A and B is shown. The gene has two transcripts with expression ratio of 1:4 and 4:1
in the two samples, respectively. The FDM is computed using the two ACT—Graphs. The ACT—Graphs have two divergence nodes: node n2 has outdegree 2
and node n5 has indegree 2. FDM(A.B) = 21—” (FDn2(A,B)-I-FDn5 (A3» =  ((|0.8 —0.2| + |0.2 —0.8|) +(|0.8 —0.2| + |0.2 —0.8|)) 20.6. The JSD is computed

using the ground truth knowledge of the transcript abundance vectors. VA = [02,08] and VB = [08,02]. JSD(VA, VB)=H (“Lg/B) — w = 0.28.
Thus, J SD*= 0.53 is the magnitude of differential transcription representing ground truth.

2.3.1 FDM properties
Lemma: the FDM is between 0 and 1
Lemma: FDM is a metric

(1) FDM(A,B) : 0

(2) FDM(A,B) = 0 if and only if A = B

(3) FDM(A,B) = FDM(B,A)

(4) FDM(A,B) 5 FDM(A,C) + FDM(B,C)

The proofs of both lemmas are provided in the Supplementary Materials.

2.3.2 FDM usage FDM may be applied between ACT—Graphs without
need for normalization by the number of reads or read length, because
the FDM is based on ratios of coverage, and these factors scale coverages
linearly. Using synthetic data, we show that FDM has a high correlation
with JSD*. The details of this are in Section 3.1. Since we do not know
the transcripts or their relative abundance, we use the FDM as a metric for
differential transcription.

2.4 Statistical tests for differential transcription

2.4.] Statistical test to ﬁnd genes with signiﬁcant diﬁerential transcription.
We use the FDM as a test statistic to ﬁnd genes with signiﬁcant differential
transcription between two samples. The ACT—Graph of each gene is different,
so the range of FDM values differs from one gene to another. Thus, the
FDM value for a gene is in itself not sufﬁcient to tell if the differential
transcription is signiﬁcant. Instead, we devised a non—parametric test to
determine whether differential transcription is signiﬁcant. We create the
null distribution of FDM for a gene, and test if the FDM value for the two
samples has a signiﬁcant P—value. The null hypothesis is that the gene has no
differential transcription in two samples. The process of creating the FDM
null distribution is illustrated in Figure 6 in the Supplementary Materials.
Assume that there are N aligned reads in both the sample datasets. Create
ACT—Graphs for the two samples such that nodes and edges are identical.
The reads are partitioned into p equal—sized groups in both samples, and an
ACT—Graph is created from the alignments of each group of N / p reads. Thus,

for each sample we have p ACT—Graphs. The 2p ACT—Graphs are randomly
shufﬂed into two groups of p partitions each and a composite ACT—Graph
for each group is created by simply adding the edge weights of the p ACT—
Graphs in the group. Now the FDM is computed between ACT—Graphs of
these two groups. This gives a value of the random variable which follows
the null FDM distribution. By shufﬂing partitions a sufﬁcient number of
times, we get a null distribution of the FDM. In this fashion, the FDM null
distribution is created for each gene, and the P—value for the speciﬁc partition
that corresponds to the reads of the two samples can be computed. Section 1.5
in the Supplementary Materials provides details on sensitivity to the choice
of p and the number of permutations.

2.4.2 Statistical test for multiple replicates A single pairwise comparison
is often insufﬁcient to draw robust conclusions about differential
transcription. Due to several uncontrolled factors, RNA—seq replicates may
vary considerably more than predicted from sampling error alone. Thus,
pairwise comparison between replicates may yield false positives. If we
have multiple replicates of the two samples, we can apply one more level of
permutation test to further ﬁlter the false positives. Let us assume that there
are r replicates for each of the two samples. Replicates from ﬁrst sample are
called Group 1, and replicates from other sample are called Group 2. The
FDM pairwise statistical test can be applied to all  pairs. Out of those, r2
pairs are between replicates in different groups, and the rest are between
replicates in the same group. Now, if a gene has signiﬁcant differential
transcription between groups more often than within groups, it is likely to
be true positive. The difference between groups and within groups is used as
the test statistic. By pennuting the group label of the replicates, we get the
null distribution of the test statistic. The P—value of the statistic is computed
for the original labeling and tested for signiﬁcance.

3 RESULTS

3.1 Experiments with simulated data

In biological data, we typically do not know the exact set of transcripts and
their relative abundance in a sample, using which we could calculate the

 

2636

112 /810's12u1nofp101x0'sor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

FDM: differential transcription analysis

 

Coverage = (0,5)

 

Coverage = (10,15)

Coverage = (20, )
Correlation: 0.819

 

 

 

 

 

 

 

 

 

 

 

 

 

A 1 Correlation: 0.535 1 Correlation: 0.726 1 A
I
I I. T a.
0.8-  . 08 '. 0.8- ".°°_
O .. a. ' .::- I.'.:'l
. ..O . . . .- : 0;. g :.D
, . ..- . , , , o 6 . \ -
0.6- - o. .. ' , 0.5 . g. o . , o-
n n o ' ' . I . 3
E u ' ' ' o .1 o 2 . u ' E
D '.. -  '. .- .’ . -- E -° -- .° . _°. 0
LL   M  .. «,2,- ;.. LL
0.4 1 :° ‘.-.-'-‘ 2 . . l ' .4 H "2': 0.4- '- .  . ',' m... 0.4
o.. .o... o (0 o-'0._'h".: ° =' '.-. ''''' "u ' '
.I. .(u :3“: ‘5' .u- "0': _‘o 5‘ .2" 'o' " . -~'- 0. ... 'M. I" .
: \. roar:- -_.-- 0. ﬂuff. :- _ . " :.~ _ .. u a. o :d ' 9 .
- mew-.1. In  u. 22- : y- .. ..  ~1-  4-‘3- 'J'
0 2 . '- Que-t". ' " : ° ‘5 f. 4' 0 2 :- ". :-°. 37"3'3-3 ~‘ 'llﬁ "I". ' o 2
, a '.- '.'.'° w! 11 ' 'I'. ’2'? : £3" . ° . 1
away}. , '_.".a~,‘F,' . ~° '
E. $15. ff: -.O l : :ubi‘” £.Q.r’v:.lo. o '
u ' I ' u - . 0‘- ° °
n .. o .I l I I n '-£. '.0.  o .- I I I n
0'00 o 2 0.4 0.6 0.8 1.0 0'00 0.2 0.4 0.6 0.8 1.0 0'00 1.0
SORT JSD SQRT JSD
B Coverage = (0,5) Coverage = (10,15)
1 u . . . 1.0 . .

.0

True Positive Rate

True Positive Rate

 

 

 

 

 

 

P

.0

 

True Positive Rate

 

 

 

 

_,. . . o,
o 0.0 0.2 0.8 1.0 15.0

0:4 0:6
False Positive Rate

0:4 0:6
False Positive Rate

 

0.8 1.0 046

.0 0.2 0.8 1.0

014 06
False Positive Rate

Fig. 4. Sensitivity and speciﬁcity of the FDM as a function of read coverage (Section 3.1.1 & 3.1.2) : Synthetic data of three sample pairs of 1500 genes each
is analyzed. The ﬁrst sample pairs have low gene coverage ( coverage 2 [0,5]), the second sample pairs have medium gene coverage (coverage 2 [10,15]), and
the third sample pairs have high gene coverage (coverage of 20 or higher). (A) J SD* — FDM Correlation: The points in the scatter plots correspond to (J SD*,
FDM) values for a gene, where J SD* is ground truth and FDM is computed from ACT—Graphs. When the average gene coverage is high, the correlation
between J SD* and FDM is high. For average coverage higher than 20, the correlation is 0.819. (B) FDM as a classiﬁer for J SD*: a gene is marked positive for
differential transcription if J SD* is more than 0.22 and negative otherwise. FDM is used to classify genes as positive or negative. Thus for each value of FDM,
we get some true positives and some false positives. By varying FDM, the complete curve is plotted. The FDM values of (0.01,0.02,0.04,0.08,0.16,0.32.0.64)
are marked on the curve. With coverage of 20 or higher, 90% of true positives can be identiﬁed with ~ 10% false positives.

J SD*. Hence ,we use synthetic data, for which we know the exact transcript
expression vectors for each gene, to determine (i) the correlation of the FDM
and the JSD* metrics; (ii) the power of the FDM method when used as a
classiﬁer for a particular value of J SD* under various levels of read coverage;
and (iii) the advantage of the groupwise signiﬁcance test.

The RNA—seq dataset is simulated as follows. We use the annotated
transcripts for human genome as a reference. Genes which have at least
two transcripts are selected. Each of the genes is assigned an expression
level sampled from an empirical distribution of observed expression levels
in human genes. The individual transcripts of the genes are each assigned a
relative abundance so that their sum is 1. The vector of relative abundances
is called the transcript expression vector. For example, a gene with two
transcripts T1 and T 2 and a transcript expression vector of [p1, p2] indicates
that p1 % of transcripts are T1 and p2% are T 2. Aread of size 15 from a transcript
is a random segment of size 15 taken from the transcript sequence generated
using the reference DNA. The number of reads generated from a transcript
is proportional to the product of gene coverage, transcript expression and the
length of the transcript. The alignment for every read is known, and hence the
input SAM datasets consist of reads that are uniquely and perfectly aligned.
Additional details on the datasets created can be found in the Supplementary
Materials.

3.1.] FDM correlation with JSD* We create three pairs of simulated
RNA—seq datasets each with different gene coverages. The three pairs of
datasets have 1500 genes each. They are generated by varying gene coverages
over three ranges [0,5] , [10—15] and 20 or higher. The J SD* for the genes
is varied over the range 0.0—1.0.

The ACT—Graph is created for all the genes for both the samples in the
pair. The FDM is computed for each gene in the pair. From the transcript

expression vectors of the genes, the J SD*, which represents the ground truth
of differential transcription, is computed.

In Figure 4, we see that the correlation of FDM and J SD* increases as read
coverage of the gene increases. This is as expected; when gene coverage is
lower, the ACT—Graph edges will have lower weights. Since ratios are used,
a small change in edge weight caused by random effects would affect the
FDM considerably.

3.1.2 FDM as a classiﬁer for JSD* We tested if FDM can classify genes
as high JSD* genes and low JSD* genes. We call a gene positive for
high JSD* if the JSD* is >0.22 and negative otherwise. This threshold is
arbitrary; we obtained similar results for other values. For each gene, we
create ACT—Graphs for two samples and compute the FDM. For a constant
c, if FDM > c, we classify the gene as positive. Some of the positives are
true positives (using J SD deﬁnition) and some false positives. For each c,
we get true positives and false positives. By varying c from 0.01 to 0.99 over
a step of 0.01, we get the complete receiver operating characteristic curve
(ROC). Figure 4 shows that with high coverage, 90% of true positives can
be identiﬁed with ~10% of false positives.

3.1.3 FDM method over synthetic replicates We created two synthetic
tissues over 2100 genes with at least two transcripts. The J SD* between genes
in the two tissues varies randomly over the range 0.01—1.00. The distribution
of J SD* and log(Coverage) are given in Figure 1e and f, respectively, in
Supplementary Materials. Four replicates were created for each of the tissues
resulting in eight samples. FDM method was applied over all the  pairs of
which 16 pairs were between group and 12 were within group comparisons.
We used P 20.05 as signiﬁcant. For creating FDM null distribution, the
number of partitions we used was 30 and the number of permutations was

 

2637

112 /810's12u1nofp101x0'sor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

D.Singh et al.

 

 

(a) 3.0 . .

2.5-

Iog Coverage
: a

I“
o
.

 

 

 

 

 

 

 

 

0.5'
r C
u o
08.0 1.0
c 3.0 . .
< > ,
o
o
2.5'
o
a) 20_ ' .0 0%
m . o . '0. 0 .
2 ~- -" '2
. .0.
a) - ' . '- ‘ ° -.° '
l . Q. o .
g 1 5 . .5. ~ ', c“ :3 ho. ... .a-‘sz',’ I '
' “ o ,0 ° Q3; 0 Q2". . ’9‘»? 0
U o g. 5 . o 0- J wg
a .P.‘ “,»~ ‘. .0:3 r%%‘ on) .
. . .
8 o L. -.: ‘1 ‘3'." «P. * f‘9. J~ W "."
_ l ‘ h. f,  .;',’ 0.x“.ﬂ (‘3 VI J y r o
6" :ﬂ'. 0 ‘ . {3",- 12.4'o'l' .. o . o
1 1 ‘r'uf. ‘ o r . . ~ :1 in
z } I. .~:.o " ..:.VI. .6“. .x .0. .
0.5- . : a} vi. 3 :l to" u o o '... ‘n‘ ' o
. . k h, 9 g «F! 1,).1‘. 0.: .
. . I A 1‘ a. 3
‘ . t . - ‘ .3 ‘ f .
‘ of J t o
0 LI ' ' I ‘ a" .‘I ‘ g! g . 1
'80 0.2 0.4 0.6 0.8 1.0
JSD*

 

 

 

 

 

 

(b) 3.0 . .
. o
o . . .
2.5-
o
. 0 ° 0
g" 2.0- . ".3 '. I .
8 .‘.~* - 3 : h
a) . o . a . . 0' .. .0... o . a
0 . * o .
g 1 5 . .. .L‘. ‘2', . . :10 30‘ .ﬁ.'? .o.::'..~.‘;:oo. .
U .5 .0 ' '. 01': ‘; o0..‘wé:.'.t4:;: ;~ rzz :' .
.r .0 V
O .1 .'.. .:FO‘..'0-(J’:.O . h .3. '0 .
O 1 O 9 t '11, ’5“ %.:§‘~  3|. '
was»:  @1333“: «2 .- - .
1 u '3‘ If." ' ‘0' ‘”e 1- . .
In 0 : ‘.~ “3‘7 '... ‘r- -.-.
' I " f. .0... .l ’ r V i .
05— -~'.."d"""§”." "'1'" T 0"W ‘ °° .
1 Q I . 0v
...‘ as.  1.0.0  (  r 3"...l‘: . .
u 7" f‘rt‘ . " 50' (J. g.~:«’o o
. . .
o .21J%SA%W&,%-hs:.
8.0 0.2 0.4 0.6 0.8 1.0
JSD*
(d) 3.0 . .
. o
C . . .
2.5-
o
c” 2.0- , ' .°"" . '
O u ’.o '. I 0 .
E o o . ‘ ’ o .
a) . I o .: 1.... to. e .
o
g 15 ‘ .0. . .0 . '4. '.o::..:'.(. ’ .
U o (3 t. I: ‘0 {I
. .(’. ‘ﬁ . ‘4'.   V.V\FE‘ :0 .. .' a
O} _ . ‘W . “0"” ' ‘J¥;t§n' '
2 10 ,  “‘1‘ 2t . ;~v¢.':fr;‘q‘l ’. I...
r  t " J '.‘ zJolL,"7>.T~ro~ ' ’9" o. . o
.4 ‘ p ~ ..‘-' tr . L O
1 o 5.0. . 3.0-: . a" o
0'5— I '. J T, J :0 .0 ...' p) I‘J?’V ' . . .
g ( L c Q 31, 0v 0.
. 0 Cry 0; ' J 1 ’4 o
s r I o ‘( ' o
,1 s I, . j ' . ~"..u .°
1 e o
0 ,.J"’\,o I_ L»... ‘3. u c
8.0 0.2 0.4 0.6 0 8 l 0

 

 

Fig. 5. Detection of differential transcription by different methods. The circles in scatterplots (a—d) represent 2100 genes in two samples with varying
differential transcription (measured by J SD*) and varying depth of RNA—seq sampling (measured by the average coverage per transcribed nucleotide). Filled
circles correspond to genes with signiﬁcant differential transcription according to each of the methods. (a) FDM consistently identiﬁes differential transcription
when coverage is high or J SD* is high. For example, for genes with J SD* >0.28 and log(coverage) >0.85 (coverage >7), FDM was able to identify 90% of
the genes as differentially transcribed. Two other methods not using annotations, (c) Cuffdiff (Trapnell et al. (2010) without annotations) and (d) rDiff (MMD)
Stegle et al. (2010), had lower sensitivity, identifying differential transcription in 68 and 49% of the genes in this region, respectively. (b) For comparison,
we also ran Cuffdiff with gene annotations, which identiﬁed differential transcription in 86% of the genes in this region.

1000. Section 1.5 in the Supplementary Materials shows that increasing the
number of partitions and permutations has little effect on the results. The
method ﬁnds 90% of the genes which have J SD* >0.28 and coverage >7
as signiﬁcant.

3.1.4 Comparison with other methods In Figure 5, the results of FDM
are compared against other methods not using annotations, namely Cuffdiff
(without annotations) and rDiff (MMD), using synthetic RNA—seq datasets
deﬁned in the previous section. We ran Cuffdiff as included in release 1.0.3
of the Cufﬂinks software. Since the data are synthetic and without sampling
bias, we deactivated the bias correction module. We used the upper quartile
normalization option in order to improve the accuracy of the abundance
estimation. All genes with P 50.05 were marked as signiﬁcant. We ran
rDiff.web as provided in http://galaxy.tuebingen.mpg.de/. The only option
available for the software is which method to use: we used the ‘MMD—
based’ method. All the genes with P 5 0.05 were marked as signiﬁcant. The
scatter plots in 5 show the results. For genes with J SD* >0.28 and coverage
>7, FDM was able to identify 90% of the genes as differentially transcribed.
This represents higher sensitivity than Cuffdiff (without annotation) and rDiff
(MMD), which identiﬁed differential transcription between 68% and 49% of
the genes in this region, respectively. For comparison, we also ran Cuffdiff
with gene annotations, which identiﬁed differential transcription in 86% of
the genes in this region.

3.2 Experiments with biological data

We used RNA—seq data for four replicates each of the cancer cell lines MCF7
and SUM102. Each dataset has ~80 million single—ended reads of length
100 nt.

We used the FDM method to ﬁnd genes with differential transcription
between SUM102 and MCF7. We used MapSplice to align the RNA—seq
datasets. Using these alignments, we created ACT—Graphs for all the known
genes. We applied the FDM statistical test to all the  pairs of replicates.
Out of these 28 pairs, 6 pairs were of MCF7—MCF7, another 6 for SUM102—
SUM102 and 16 were MCF7—SUM102. The number of signiﬁcantly different
genes in single pair comparison are as follows:

- MCF7—MCF7 : 1949 (average over six pairs).
0 SUM102—SUM102: 1966 (average over six pairs).
- MCF7—SUM102: 2727 (average over 16 pairs).

Next we applied the statistical test for replicates to get the most signiﬁcant
genes. After applying the replicates statistical test, 1425 genes were judged
to have signiﬁcant differential transcription between MCF7 and SUM102.
CD46 is one of the genes found to be signiﬁcantly different. The UCSC
browser bedgraph tracks for gene CD46 (Fig. 6) shows that the middle exon
has a different skipping ratio in MCF7 and SUM102. Additional examples
can be found in the Supplementary Materials.

 

2638

112 /810's12u1nofp101x0'sor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

FDM: differential transcription analysis

 

Scale 2kb|—|
chrt: I 207960000| 207961000| 207962000| 207963000I 207964oool 207965000| 207966000| 207967000|
400 MCF7 11 HS Coverage

MCF77117HS Coverage

01 LENA

i 7 7 bl; if
400 MCF7 5 HS Coverage

MCF7757HS Coverage

47 7 4
400 MCF7 SM4 HS Coverage

MCF77$M47HS Cover;

_ _ _ _.___ _
400 MCF778M67HS Coverage

MCF7 8M6 HS Covere [
0 _

L I
500, SUM1027107HS Coverage

SUM102 10 HS Cover:

500: — — — —— — — :Uhﬁiﬁj—ECoverage—
SUM102 12 HS Cover: I

0

 

500 : 53115278116318 Coverage

SUM102 SM6 HS Covi I I“
o _ __ L

500 : SUM1027SM77HS Coverage

SUM10278M77HS CovI

 

RefSeq Genes

O
U
4
III... Ill-ll.-

Fig. 6. UCSC browser: Gene CD46 in MCF7 and SUM102 (Section 3.2).
The ﬁrst four samples are from MCF7 and next four samples are from
SUM102. This gene was identiﬁed as a gene with differential expression
using FDM methodology. Note that the middle exon is skipped in different
ratios in MCF7 and SUM102. This result was verifed by qRT—PCR.
Additional ﬁgures are provided in Supplementary Material.

We performed quantitative real time polymerase chain reaction (qRT—
PCR) on three genes to validate the FDM results. Details for the method
can be found in Section 1.4 of the Supplementary Materials. For CD46, the
skipped exon (chr1:207963598—207963690) was found to be expressed >2—
fold higher in SUM102 than in MCF7 as measured by qRT—PCR. Working
from the ACT—Graphs, average skipping ratios in the MCF7 samples were
0.16 and in the SUM102 samples were 0.5 predicting an average 3.1—fold
change. For NPC2 (shown in the Supplementary Materials), the retained
intron (chr14:74946991—74947405) was expressed at least 10—fold more in
MCF7 than in SUM102 as measured by qRT—PCR. Working from the ACT—
Graphs, an average fold change of 25 was predicted. Both experimental
results were in congruence with the FDM results. Using Cuffdiff with
annotations on our dataset, NPC2 was judged to have signiﬁcant differential
transcription, but the test for CD46 failed and thus was inconclusive.

A third gene ZNF408 (shown in the Supplementary Materials) gave a
different result in the biological experiment than predicted by the FDM
method. We directly resequenced cDNA derived from the mRNA from both
cell lines and genomic DNA from both cell lines. The region of interest
(chr11:46724721—46724734) has a high number of mutations in MCF7
compared with the reference genome, a common observation for cancer cell
lines and cell lines that have been propagated extensively. This caused reads
from a region of MCF7 to not align to the reference genome, and present a
difference in the ACT—Graphs. Thus, the incorrect result is due to alignment
limitations, rather than to FDM.

4 DISCUSSION

4.1 FDM - JSD* correlation

Although Figure 4 shows a high correlation between FDM and J SD*,
there still are genes with high FDM and low J SD*. These genes are
artifacts of low coverage at some divergence nodes and could be

ﬁltered out. Since FDM uses ratios, a variance in small edge weights
can cause high variance in the ﬂow difference.

There are also some genes with high J SD”< but low FDM. These
can be due to complex gene models with many transcripts giving
rise to many divergence nodes. When most transcripts have low
abundance and are unchanged between samples and just a few
similar transcripts have larger abundance changes, then J SD”< can be
large, yet only a few divergence nodes observe large ﬂow changes,
and these are attenuated by the remaining unchanged nodes to create
an FDM value that is not exceptional under permutation testing.
Focusing on divergence nodes with ﬂow differences could improve
detection of these cases.

4.2 FDM and sequencing bias

Sample preparation protocols can introduce signiﬁcant deviations
from the assumption of uniform sampling of reads along transcript
isoforms, in ways which are not fully understood. It is useful to
consider how such sampling bias would affect FDM. (Roberts et al.,
2011) cite two types of sampling bias.

Sequence—speciﬁc bias (Hansen et al., 2010) is related to the
underlying sequence of nucleotides in a transcript, resulting in
preferential locations for read starts. Sequence—speciﬁc bias affects
the count of reads whose alignment starts within an exonic edge in
the ACT—Graph the same way for all transcripts utilizing the exonic
edge. Associating average coverage with such an edge both smooths
local variation due to sequence—speciﬁc bias, and is independent of
the underlying transcripts involved. In effect, sequence—speciﬁc bias
is minimized in this fashion.

Position—speciﬁc bias (Bohnert and R'atsch, 2010) is related to
position in the transcript, and results in increased sampling at
transcript starts and ends. Position—speciﬁc bias affects both exonic
and spliced edge coverage according to the speciﬁc transcript
utilizing the edge, and this will change as the relative abundance
of transcripts changes, which will alter the magnitude of the ﬂow
difference in a divergence node. However, we have indicated that
the magnitude of a gene’s FDM signal varies by gene, and for this
reason a non—parametric test is used to determine signiﬁcance. Thus,
we believe the effect of position—speciﬁc bias will not substantially
affect the determination of signiﬁcance. In summary, while further
investigation and validation is needed, we expect FDM to be largely
insensitive to sequence—speciﬁc and position—speciﬁc sampling bias.

4.3 FDM and read length

The FDM method is speciﬁcally designed to detect differential
transcription with short reads (35—100 nt), for which transcript
reconstruction can be unreliable and, we would argue, is not needed.
As we increase read length, read alignments become more accurate
and the coverage on ACT—Graph edges increases, both of which
improve the accuracy of the method. At the same time, if increased
read length comes at the expense of deep sampling (under a ﬁxed
throughput assumption), then sensitivity would be expected to
decrease.

Paired—end reads can improve FDM accuracy depending on
the operation of the underlying RNA—seq aligner. At the least,
paired—end reads yield higher quality alignments, because of the
extra constraints on mate pair distance and alignment orientation.
MapSplice aligns paired—end reads using these constraints and also
incorporates a maximum likelihood method operating on the splice

 

2639

112 /810'sreumofploarxosor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

D.Singh et al.

 

graph to infer the alignment of the complete insert, including
the unsequenced fragment, given the distribution of insert lengths
(Hu et al., 2010). This results in an effective increase in read length
and coverage and hence can improve the accuracy of FDM.

5 CONCLUSION

While splice graphs were introduced nearly a decade ago (Heber
et al., 2002), our deﬁnition is intended to record RNA—seq read
coverage in such a graph (this is also the approach taken in the
Flux Capacitor). To make such graphs efﬁcient to analyze, we
choose a speciﬁc representation that differs from classic splice
graphs. Nodes are labeled with genomic coordinates which are
unique and help address the ambiguities caused by overlapping
exons and unannotated genomic regions. The node labels are also
well suited for computing the union of graphs from which the edge
set for comparison of coverages is easy to determine. The ACT—
Graph representation can dramatically decrease the data storage
requirement for RNA—seq data. It is not a lossless compression
as the underlying reads cannot be recovered from the ACT—Graph,
but it does sufﬁce for the analysis of differential expression and
transcription.

The FSM captures the signal of differential transcription directly
from a pair of ACT—Graphs, without knowledge or inference of
the underlying transcripts or need for normalization. The FDM has
high correlation with J SD*, which is an independent measure of
differential transcription. We showed that FDM can be used as
classiﬁer for differential transcription. We presented a statistical
method using a permutation test on ACT—Graphs to ﬁnd genes with
signiﬁcant differential transcription between pairs of samples or
between groups of replicates.

ACKNOWLEDGEMENTS

We thank the referees for their insightful questions and comments,
and thank Charles Perou for RNA samples from the MCF—7 and
SUM—102 cell lines and Anais Monroy for qRT—PCR validation.

Funding: National Science Foundation (ABI/EF grant number
0850237 to J.L. and J.F.P.); National Institutes of Health: NCI

TCGA (grant number CA143848 to Charles Perou); NCRR Idea
(INBRE Grant P20RR016481 to N. Cooper); NCI GI SPORE
Developmental Project Award (P50CA106991 to D.Y.C.); Alfred
P. Sloan Foundation fellowship (to D.Y.C.).

Conﬂict of Interest: none declared.

REFERENCES

Bohnert,R. and R'atsch,G. (2010) rQuant.web: a tool for RNA-Seq-based transcript
quantitation. Nucleic Acids Res., 38 (Suppl. 2), W348—W351.

Guttman,M. et al. (2010) Ab initio reconstruction of cell type-speciﬁc transcriptomes in
mouse reveals the conserved multi-exonic structure of lincRNAs. Nat Biotechnol,
28, 503—5 10.

Hansen,K.D. et al. (2010) Biases in Illumina transcriptome sequencing caused by
random hexamer priming. Nucleic Acids Res., 38, e131.

Heber,S. et al. (2002) Splicing graphs and EST assembly problem. Bioinformatics, 18
(Suppl. 1), S181—S188.

Hu,Y. et al. (2010) A probabilistic framework for aligning paired-end RNA-seq data.
Bioinformatics, 26, 1950—1957.

Jean,G. et al. (2010) RNA-Seq Read Alignments with PALMapper. Current
Protocols in Bioinformatics. Available at http://www.hpa.org.uk./infections/
topics_az/antimicrobial_resistance/amr.pdf, pp. 32: 1161—3221 1.6.37.

Kwan,T. et al. (2008) Genome-wide analysis of transcript isoform variation in humans.
Nat Genet, 40, 225—231.

Pan,Q. et al. (2008) Deep surveying of alternative splicing complexity in the human
transcriptome by high-throughput sequencing. Nat Genet, 40, 1413—1415.

Robertson,G. et al. (2010) De novo assembly and analysis of RNA-seq data. Nat
Methods, 7, 909—912.

Roberts,A. et al. (2011) Improving rna-seq expression estimates by correcting for
fragment bias. Genome Biol, 12, R22.

Stegle,O. et al. (2010) Statistical tests for detecting differential rna-transcript expression
from read counts. Nat Preced. [Epub ahead of print, doi:10.1038/npre.2010.4437.1,
May 11,2010].

Sultan,M. et al. (2008) A global view of gene activity and alternative splicing by deep
sequencing of the human transcriptome. Science, 321, 956—960.

Trapnell,C. et al. (2009) TopHat: discovering splice junctions with RNA-Seq.
Bioinformatics, 25, 1105—1111.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq reveals
unannotated transcripts and isoform switching during cell differentiation. Nat
Biotechnol, 28, 511—515.

Wang,E.T. et al. (2008) Alternative isoform regulation in human tissue transcriptomes.
Nature, 456, 470—476.

Wang,Z. et al. (2009) RNA-Seq: a revolutionary tool for transcriptomics. Nat Rev.
Genet, 10, 57—63.

Wang,K. et al. (2010) MapSplice: accurate mapping of RNA-seq reads for splice
junction discovery. Nucleic Acids Res., 38, e178.

 

2640

112 /810'sreumofpioarxosor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

