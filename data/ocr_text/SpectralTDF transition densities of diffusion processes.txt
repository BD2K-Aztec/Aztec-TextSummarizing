Bioinformatics, 32(5), 2016, 795—797

doi: 10.1093/bioinformatics/btv627

Advance Access Publication Date: 9 November 2015
Applications Note

 

Genetics and population analysis

SpectralTDF: transition densities of diffusion
processes with time-varying selection
parameters, mutation rates and effective
population sizes

Matthias Steinrucken”, Ethan M. JewettZ'T and Yun S. Songz'3'4'5'6'*

1Department of Biostatistics and Epidemiology, University of Massachusetts, Amherst, MA 01003, USA,
2Department of Statistics, 3Department of EECS, 4Department of Integrative Biology, University of California,
Berkeley, CA 94720, USA, 5Department of Mathematics and 6Department of Biology, University of Pennsylvania,
Philadelphia, PA 19104, USA

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.
Associate Editor: Janet Kelso

Received on April 30, 2015; revised on October 5, 2015; accepted on October 22, 2015

Abstract

Motivation: In the Wright—Fisher diffusion, the transition density function describes the time evolution
of the population—wide frequency of an allele. This function has several practical applications in popula—
tion genetics and computing it for biologically realistic scenarios with selection and demography is an
important problem.

Results: We develop an efficient method for finding a spectral representation of the transition density
function for a general model where the effective population size, selection coefficients and mutation
parameters vary over time in a piecewise constant manner.

Availability and implementation: The method, called SpectralTDF, is available at https://source

 

forge. net/projects/spectra Itdf/.
Contact: yss@berkeley.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The transition density function (TDF) of the Wright—Fisher diffusion
describes the time evolution of the frequency of an allele (Ewens,
2004). The TDF is useful for understanding the effects of demography,
mutation and selection on genetic variation, and it is a key component
of a number of methods for inferring selection coefficients (Bollback
et 61]., 2008; Steinrijcken et 61]., 2014; Williamson et 61]., 2004), predict—
ing allele fixation times (Waxman, 2011) and computing population
genetic statistics such as the site frequency spectrum (Zivkovic et 61].,
2015

Most existing approaches for computing the TDF assume either
restrictive models of dominance (Kimura, 1955, 1957) or selective
neutrality (Griffiths, 1979; Shimakura, 1977; Vogl, 2014) or are

computationally slow for selection strengths commonly observed in
biological data (Barbour et 61]., 2000). However, Song and
Steinriicken (2012) and Steinrucken et al. (2013) recently developed
a numerically stable and computationally efficient method for find-
ing a spectral representation of the TDF for a general selection
model in the case of constant parameters (population size, mutation
rates and selection coefficients). Despite the utility of this new ap—
proach, assuming that model parameters remain constant over time
is often too restrictive for biological applications (Siepielski et 61].,
2009).

Zivkovic et a]. (2015) have extended the spectral method of
Song and Steinrucken (2012) to handle piecewise—constant popula—
tion size functions. However, their approach requires a restricted

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 795

91% ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

796

M. Steian'icken et al.

 

model of selection in which the fitness of a homozygote is twice that
of a heterozygote (i.e. additive or genic selection). Furthermore, se—
lection parameters are assumed to remain constant over time, and
the model does not allow for recurrent mutations.

Here, we present the first method for computing the TDF under
arbitrary models of dominance and recurrent mutation while allow—
ing selection parameters, mutation rates and effective population
sizes to change over time in a piecewise constant manner.

2 Approach

We consider a biallelic locus with two alleles, A0 and A1, evolving in
a single panmictic population. In the corresponding Wright—Fisher
diffusion, X, denotes the frequency of allele A1 at time t, measured
continuously in units of generations. We assume that either X0 is
given or the distribution of X0 is specified. The effective population
size, mutation rates and selection parameters are assumed to be con—
stant within each of K disjoint epochs. As illustrated in Figure 1, the
lath epoch has effective size Nk (diploid individuals) and duration Tk.

Epoch boundaries are denoted by t0, t1, . . . , W, with tk : 2:1 I).

Within the lath epoch, the per—generation probability that a copy
of allele A0 mutates to allele A1 is ak, and the per—generation prob—
ability that a copy of allele A1 mutates to allele A0 is bk. In addition,
selection acts in such a way that the relative fitness of an individual
carrying 1' copies of allele A1 is 1 —I— 5k,- (i : 1, 2).

The TDF pk(t; x, y) in epoch k is defined by
pk(t;x, y)dy : |P(ngtk_1+t < y —I— dy|th_1 : x), where tk_1 —I— t < tk.
The TDF pk(t; x, 3)) satisfies the partial differential equation
8pk(t;x,y)/8t : Lkpk(t;x,y)/2Nk, where Lk is the diffusion gener-
ator given by
a}. =1x(1 —x>8—2+1iak — (aw/3 >243

2 8x2 2 k 8x (1)
+2x(1 — x)[ak1(1 — 2x) —I— akzx] 

See Song and Steinrijcken (2012) for discussion on the appropriate
boundary conditions. In Equation (1), the parameters ark : 4N kak, ﬂk
: 4Nkbk, 07d : Nkskl and 0kg : Nkskz are the population—scaled
versions of the mutation and selection parameters.

Within each epoch, k, a spectral representation of the TDF
pk(t;x, y) can be obtained by employing the framework of Song and
Steinriicken (2012), who developed an efficient algorithm for finding

1200 -

Effective population size — Copies of allele A,
1000 -

 

soo " T g

 

600
400

200

 

 

0 I I I I 100 I I I I 200 I I I I 300 I I I I 400 I I I I 500
to 151 t2 t3
Time (generations)

Fig. 1. Diagram of the model. A population has constant size in each of K
epochs (N1 = 1000, N2 = 600, N3 = 900). An allele, A1, at a locus of interest
evolves over time, subject to pressures of mutation and selection that are
constant within each epoch

the eigenvalues and the eigenfunctions of the diffusion generator Lk.
The challenge in computing the TDF for the full model with K epochs
lies in knitting together the expressions for the densities pk(t;x,y)
across the different epochs. The method we implement involves an effi-
cient and numerically stable algorithm for carrying out this knitting
procedure using a polynomial interpolation method, which is detailed
in Supplementary Methods.

3 Implementation

Our algorithm has been implemented in JAVA. The inputs to the pro—
gram are the effective population sizes (number of diploid individuals)
N : (N1,  ,NK); epoch durations 17 = (t1, 
mutation rates a = (a1, . . .

,TK); per—generation
,aK) and b : (b1,  ,bK); selection par-
ameters s1 : (s11,  ,sK1) and $2 : (s12,  ,us); initial allele fre-
quency X0 and the time t E [0, T] at which the TDF will be evaluated.
A plot of the TDF evaluated at each epoch boundary point
(t = 11,11 —I— '52 and T) in Figure 1 is shown in Figure 2. The full com-
mand options are detailed in the user manual distributed with the
software.

4 Discussion

Our implementation provides a fast and numerically stable method
for computing the TDF for a general model with piecewise—constant
population sizes and a broad range of time—varying mutation and se—
lection parameters. It also allows for a variety of initial conditions,
including a specified initial frequency and stationary distributions
under mutation—selection balance or mutation—drift balance.

The JAVA implementation is designed to be used either as a
stand—alone application or in combination with other methods.
For example, the code can be easily incorporated into the method
of Steinrucken et al. (2014), allowing the inference of selection par—
ameters from time series data sampled from populations with time—
varying demographic and selection parameters. In general, the
method we present provides a ﬂexible and efficient tool for studying
the evolution of allele frequencies over time under complex evolu—
tionary scenarios.

 

 

 

 

 

 

 

 

 

3
2.5- I I I t:  I... '-
—— t — 1"] -I- ’1‘: i '_
— t = T .I .
2 - I. .
1". III- -i- - I.
I \-
_ I I-
1.5 I . 1"
if "' K "
I in N...
I N.
1 f l
d" l IN
I l I x
0.5- ’ .' _ x
I. II 1
r .a‘ I 1
i. f 'l '1.
E ....-.-l . . u
D 0.2 0.4 [1.5 [1.8 1

Freq uencyr (I)

Fig. 2. Plot of the TDF for the model shown in Figure 1 with the parameters
specified in the example in Section 3, evaluated at the times t1, t2 and T

91% ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo AlTSJQATUn 112 /§.IO'S[BLLIHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; popeommoq

Transition density function

797

 

Acknowledgement

We thank Daniel Zivkovié and Anand Bhaskar for helpful discussions and
collaboration on earlier related work.

Funding

This research was supported, in part, by NIH grants R01-GM094402 (MS
and Y.S.S.) and R01-GM109454 (E.M.J.), and by a Packard Fellowship for
Science and Engineering (Y.S.S.).

Conﬂict of Interest: none declared.

References

Barbour,A. et al. (2000) A transition function expansion for a diffusion model
with selection. Ann. Appl. Probability, 10, 123—162.

Bollback,]. et al. (2008) Estimation of 2Nes from temporal allele frequency
data. Genetics, 179, 497—502.

Ewens,W. (2004) Mathematical Population Genetics: I, 2nd edn. Springer-
Verlag, New York.

Grifﬁths,R. (1979) A transition density expansion for a multi-allele diffusion
model. Adv. Appl. Probability, 11, 310—325.

Kimura,M. (1955) Stochastic processes and distribution of gene frequencies
under natural selection. In: Warren,K.B. (ed), Cold Spring Harbor Symposia
on Quantitative Biology, Vol. 20. Cold Spring Harbor Laboratory Press,
Baltimore, MD, pp. 33—53.

Kimura,M. (1957) Some problems of stochastic processes in genetics. Ann.
Mat/7. Stat., 28, 882—901.

Shimakura,N. (1977) Equations différentielles provenant de la génétique des
populations. Toboleu Mat/7. ]. Second Ser., 29, 287—318.

Siepielski,A. et al. (2009) Its about time: the temporal dynamics of phenotypic
selection in the wild. Ecol. Lett., 12, 1261—1276.

Song,Y.S. and Steinriicken,M. (2012) A simple method for ﬁnding explicit
analytic transition densities of diffusion processes with general diploid selec-
tion. Genetics, 190, 1117—1129.

Steinriicken,M. et al. (2013) An explicit transition density expansion for a
multi-allelic Wright-Fisher diffusion with general diploid selection. Tbeor.
Popul. Biol., 83, 1—14.

Steinriicken,M. et al. (2014) A novel spectral method for inferring gen-
eral diploid selection from time series genetic data. Ann. Appl. Stat., 8,
2203—2222.

Vogl,C. (2014) Biallelic mutation-drift diffusion in the limit of small scaled
mutation rates. arXiU, 1409.2299.

Waxman,D. (2011) A uniﬁed treatment of the probability of ﬁxation when
population size and the strength of selection change over time. Genetics,
188, 907—913.

Williamson,S. et al. (2004) Simultaneous inference of selection and population
growth from patterns of variation in the human genome. Proc. Natl.
Acad. Sci. USA, 102, 7882—7887.

Zivkovié,D. et al. (2015) Transition densities and sample frequency spectra
of diffusion processes with selection and variable population size.
Genetics, 200, 601—617.

91% ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; popeommoq

