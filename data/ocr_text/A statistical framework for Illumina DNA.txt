ORIGINAL PAPER

Vol. 26 no. 22 2010, pages 2849-2855
doi: 10. 1093/bioinformatics/btq553

 

Gene expression

Advance Access publication September 29, 2010

A statistical framework for Illumina DNA methylation arrays

Pei Fen Kuan1’2’*, Sijian Wang3, Xin Zhou1 and Haitao Chu4

1Department of Biostatistics, 2Lineberger Comprehensive Cancer Center, University of North Carolina, Chapel Hill,
NC 27599, 3Department of Biostatistics and Medical Informatics, University of Wisconsin, Madison, WI 53792 and
4Division of Biostatistics, University of Minnesota, Minneapolis, MN 55455, USA

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: The Illumina BeadArray is a popular platform for
profiling DNA methylation, an important epigenetic event associated
with gene silencing and chromosomal instability. However, current
approaches rely on an arbitrary detection P-value cutoff for excluding
probes and samples from subsequent analysis as a quality control
step, which results in missing observations and information loss. It
is desirable to have an approach that incorporates the whole data,
but accounts for the different quality of individual observations.
Results: We first investigate and propose a statistical framework
for removing the source of biases in Illumina Methylation BeadArray
based on several positive control samples. We then introduce a
weighted model-based clustering called LumiWCluster for Illumina
BeadArray that weights each observation according to the detection
P-values systematically and avoids discarding subsets of the data.
LumiWCluster allows for discovery of distinct methylation patterns
and automatic selection of informative CpG loci. We demonstrate
the advantages of LumiWCluster on two publicly available Illumina
GoldenGate Methylation datasets (ovarian cancer and hepatocellular
carcinoma).

Availability: R package LumiWCluster can be downloaded from
http://www.unc.edu/~pfkuan/LumiWC|uster

Contact: pfkuan@bios.unc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on June 18, 2010; revised on September 9, 2010; accepted
on September 23, 2010

1 INTRODUCTION

DNA methylation is an important epigenetic modiﬁcation and
plays critical roles in transcriptional regulation, chromosomal
stability, genomic imprinting and X—inactivation (Rakyan et al.,
2008). Numerous literatures have established the inﬂuence of
DNA methylation in transcriptional aberrations in human diseases
including various types of cancer (Esteller, 2007; Irizarry et al.,
2009; Koga et al., 2009). DNA methylation occurs in cytosines
of CpG dinucleotides in human in a non—random fashion across
the genome. In particular, CpG—rich regions (known as CpG
islands) are usually hypomethylated, whereas repetitive genomic
sequences are hypermethylated in normal cells. Over the past
decade, there has been vast research in studying alterations of

 

*To whom correspondence should be addressed.

DNA methylation in cancer. A general observed trend of perturbed
DNA methylation includes hypomethylation of oncogenes and
hypermethylation of tumor suppressor genes, leading to genomic
instability and tumorigenesis (Esteller, 2007; Irizarry et al., 2009).

Several platforms are available for DNA methylation proﬁling
that includes high—throughput arrays and more recently, the next—
generation sequencing instruments. The experimental approaches
in high—throughput array—based methylation include bisulﬁte
conversion—based methods, restriction enzyme—based methods and
immunoprecipitation—based methods (Down et al., 2008). A popular
robust methylation proﬁling platform via bisulﬁte conversion is the
Illumina GoldenGate and Inﬁnium Methylation Assays based on the
BeadArray technology. This technology utilizes 3 pm silica beads
which are replicated ~30 times on the array and has emerged as
an attractive platform for genotyping, expression and methylation
analysis (Dunning et al., 2008b; Lynch et al., 2009; Xie et al.,
2009). This technology requires less sample input but produces
high—quality data (Dunning et al., 2008b; Xie et al., 2009), thereby
reducing the cost of array experiments. The increasing popularity
of Illumina BeadArray technology is apparent given the numerous
scientiﬁc publications since 2008. However, there is only a handful
of statistical framework for analyzing Illumina BeadArray gene
expression (Dunning et al., 2008b; Wong et al., 2008), and limited
work is available for methylation array counterpart (Lynch et al.,
2009). Existing work for gene expression BeadArray falls into
the categories of data preprocessing and differential expression
detection. This includes background correction methods (Dunning
et al., 2008b; Xie et al., 2009), variance—stabilizing techniques
(Dunning et al., 2008a) and modiﬁed test statistics for differential
gene expression in Illumina BeadArray (Wong et al., 2008).

Most of the framework for gene expression analysis is based on
the assumption that the majority of the genes are not differentially
expressed. In contrast, many sites are expected to be methylated
(Irizarry et al., 2008), and therefore the assumptions in gene
expression are not applicable to methylation experiments. The
goal of our article is to provide a statistical framework for array—
based methylation proﬁling on Illumina BeadArray technology, by
studying the source of biases and the data— generating mechanism of
Illumina methylation assays. Speciﬁcally, we propose a model for
correcting the source of biases in Illumina Methylation BeadArray
and introduce a weighted model—based approach for clustering the
methylation proﬁles. The framework of our weighted model—based
clustering can also be directly applied to other Illumina BeadArray
platforms, e.g. gene expression BeadChip, because it does not rely
on the assumption that most beads are from the null distribution
of no differential expression. In the next section, we describe the

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2849

112 /§JO'SIBUJn0[pJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIIIAAOG

9IOZ ‘Ig lsnﬁnv uo ::

REKuan et al.

 

methylation data structure and introduce our proposed statistical
framework.

2 NNDTTMATKDN

Methylation levels in Illumina methylation assays are quantiﬁed by
the beta value using the ratio of intensities between methylated (M)
and unmethylated (U) alleles. Speciﬁcally,
max(M, 0)
max(M,0)—l—max(U,0)—l— 100

 

beta =

where M and U are the red and green dyes, respectively, for the
GoldenGate and VeraCode Methylation assays, whereas for Inﬁnium
assay, M and U are signals A and B (produced by two different bead
types and reported in the same color), respectively. The constant
100 is to regularize beta when both M and U values are small
(Bibikova et al., 2006). The beta values are continuous and range
from 0 (unmethylated) to 1 (completely methylated). Each locus
reports an average beta value obtained from the average of M’s and
U ’s across approximately 30 bead replicates, and individual bead—
level measurements are not readily available (Dunning et al., 2008b;
Wong et al., 2008). A standard summary output from BeadStudio
(Illumina software to process raw intensities) includes four columns
for each sample, i.e. (1) average beta, (2) average M, (3) average U
and (4) detection P—values, for each locus. Therefore, our proposed
framework will be based on the average beta values for convenience.

The detection P—value reported by BeadStudio can be used as
a quality control measure of probe performance. The detection
P—value is deﬁned as 1—P—value computed from the background
model characterizing the chance that the signal was distinguishable
from negative controls (Supplementary Materials). Standard
protocol by Illumina recommends excluding probes that have a
detection P—value greater than an arbitrary cutoff of 0.05. On the
other hand, Marsit et al. (2009) excluded samples that consist of
225% observations with detection P—values Z 1 X 10—5, as well as
probes (CpG loci) with median detection P—values >0.05, whereas
Hernandez—Vargas et al. (2010) excluded probes with detection
P—values >0.01 in >10% of the samples. In Section 3.2, we will
introduce a modeling framework that avoids arbitrary choice of
detection P—value threshold.

We will now explore and illustrate the source of biases
present in Illumina Methylation BeadArray based on the data
generated by the Thomas—Conway Lab at UNC—Chapel Hill. The
methylation experiment is performed on the GoldenGate Cancer
Panel I methylation panel, which interrogates 1505 CpG loci/probes
associated with 803 cancer—related genes (tumor suppressor genes,
oncogenes, genes involved in DNA repair, cell—cycle control,
differentiation, apoptosis, X—linked and imprinted genes) where
28.6% contain one CpG site per gene, 57.3% contain two CpG sites
and 14.1% have three or more sites (Illumina, 2006). The probe
length varies between 41 bp and 59 bp with median 50 bp, whereas
the number of CG dinucleotides for each probe varies between
1 and 7. A pair of allele—speciﬁc oligonucleotide (ASO) and locus—
speciﬁc oligonucleotide (LSO) measures the methylation level of
a speciﬁc CG dinucleotide for a probe under the assumption that
ﬂanking CG dinucleotides within the same probe exhibit similar
methylation status. In other words, the observed methylation level
for the measured CG dinucleotide should not be affected by the
number of ﬂanking CG dinucleotides. To investigate the potential

Before normalization

0.0 0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8
I I I I I I I I I I I I I I

 

Pos 1 0.98 0.91 0.90 0.92 0.91

I I I I I
0.0 0.4 0.8

 

 

Pos 2 0.89 0.88 0.91 0.90

0.0 0.4 0.8

 

 

Pos 3 0.95 0.94 0.88 : d

/ Pos 4 0.95 0.89
/ / / P05 5 0-91 2g

 

 

0.2 0.6 1.0

 

 

 

 

0 2 0.6
I_I_I_I

Pos 6

 

 

 

 

 

 

 

 

 

 

 

 

 

I I I I I I I I I I I I I I
0.0 0.2 0.4 0.6 0.6 1.0 0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8

Fig. 1. Pair plots of the six positive controls before normalization. Upper
panel prints the pairwise correlation coefﬁcient.

After normalization

0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8 1.0
I I I I I I I I I I I I

 

Pos 1 0.98 0.91 0.91 0.93 0.94

I I I I
0.2 0.5 1.0

 

 

Pos 2 0.90 0.89 0.92 0.93

 

 

Pos 3 0.95 0.95 0.90

I I I I
0.2 0.5 1.0

 

 

Pos 4 0.94 0.90

 

 

I I I I
0.2 0.5 1.0

 

 

 

 

 

 

 

 

 

 

 

 

 

 

\\\\
\\\

/ Pos 5 0.92
/ / P08 6

I I I I I I I I
0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8 1.0 0.2 0.4 0.6 0.8 1.0

 

Fig. 2. Pair plots of the six positive controls after quantile normalization.
Upper panel prints the pairwise correlation coefﬁcient.

source of biases in Illumina Methylation assays, we utilize six
positive control samples from our dataset, in which all the cytosines
in CG dinucleotides are expected to be methylated and any deviation
from methylated status indicates the presence of technical biases. We
apply quantile normalization to these six positive control samples.
Figures 1 and 2 compare the pairwise correlations among these
positive controls before and after normalization, respectively. Both
plots show the high correlations among the positive controls, with
improvement after normalization.

In addition, array—based technology are known to be affected
by the sequence and thermodynamic properties, e. g. melting
temperature and GC content in protein—DNA binding and gene
expression experiments (Dunning et al., 2008b; Wei et al., 2008).
In Figure 3, we plot the quantile normalized average beta values
pooled from all positive controls against probe length, number
of CG dinucleotides within each probe, melting temperature and
GC content. Individual plots for each positive control sample are
given in Supplementary Materials. Melting temperature is computed
according to Wei et al. (2008), whereas GC content is the percentage
of C and G nucleotides for a given probe. As evident from Figure 3,

 

2850

112 /§.IO'SIBUJnOprOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv uo ::

Model for DNA methylation array

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Sequence length B CG dinucleotide

0. c.

’ 1.717777777T7*’.§.’* ; T T T * T * T

3‘ '= uﬂuuﬂmﬂﬁwﬁ 0‘ EDD: ' -

«a- HHHDHH UUUIIH' <0- -  

r:_;umumtttiiaiaiiri   :PPUI

: iiiiiissi§=i‘3§e :1 iii °

cs- ; 4111115311: '9 o- g; i 13
4'1'43'4'5'4'7'45'51'5'3'53'57'59 1' i 5 21 1'; is 1

Sequence length CG dinucleotide

C Melting temperature D GC content

o_ o

F eaiﬁﬁﬁfiiiiiiiiﬁhT ﬁeeaeriiittr

3- :meﬂﬁﬂﬂﬂnnngﬂm g PPLﬁaunU-

,3 3- :iEEEEDUUDUUUUHHU 93 f E E :L—lLlLlnlj

as -:*:::-:I: . 0 "l':.

m3“ :giIBEssiiiaaiuUH m3" 'ElliiaasE

 '  
7I1I I7I5I I7I8I I8I1I I8I4I I3I7I I9IoI I oI3 I 0I4 I 0I5 I oIe I oI7 I oIs I

Melting temperature GC content

Fig. 3. The effects of (A) sequence length, (B) number of CG dinucleotides,
(C) melting temperature and (D) GC content bias. Gray line is the lowess
approximation.

the observed methylation level is inﬂuenced by the sequence and
thermodynamics properties of the probes. Sequence length bias in
methylation array is also observed in Lynch et al. (2009). Since
melting temperature is a function of GC content and sequence
length, and GC content is highly correlated with the number of CG
dinucleotides, our modeling framework will incorporate sequence
length and GC content. In gene expression and protein—DNA binding
arrays, GC content exhibits increasing trend with intensities due to
the three hydrogen bonds compared with two hydrogen bonds in AT
pairs. However, the decreasing trend observed in methylation arrays
can be attributed to the loss of efﬁciency in binding for a probe
with more CG dinucleotides, because the CG dinucleotides within
a probe are expected to have similar methylation status. Although
CG dinucleotides yield a more straightforward interpretation, we
choose GC content which has more distinct values for better function
approximation.

3 METHODS
3.1 Estimating Lj and GCJ- biases

For notational brevity, we denote the average beta value and detection
P—value for each locus j, j=1,...,p and sample 1', i=1,...,n as by- and
pl‘j, respectively. Let Lj and GCj denote the probe length and GC content
for locus j, respectively. Since 5,]- e (0, 1), beta distribution arises as a natural
distribution for modeling the observed ﬁij (Houseman et al., 2008; Siegmund
et al., 2004). However, maximum likelihood estimation of the unknown
parameters (a, b) in a beta distribution does not have a closed form and
relies on numerical methods (J i et al., 2005). In this article, we consider an
alternative for modeling 5,]- via a logit transformation,

yl-j = log(—1ﬁIIj )ER

_ 1].
To avoid a logit tranfonnation of 5 =0, we add an e: 10—4 to b as

max(M, e)
max(M, e)+max(U, e)+ 100

 

where M and U are the average M and U values across ~30 replicates as
mentioned in Section 2. We model

yij = Sij +h1(Lj)+h2(GCj)

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Sequence length B CG dinucleotide
:— mamamanaﬁmmnae g- = mmmﬁﬁa
. :- EWWDDUUUDUUWUWE ,, g- . uuuum :
£..__ :5;:EEEEE§5EE5§5§§ 8.._i i i g : '+
g— :‘é'ﬁiéiiiigés :- 111+ «3 4 3
q 0° 3 i Q a B o
o 41I4I3I4I5I4I7I4I9I5I1I50I55I57I59 o I 2 (I3 AI. :Is (I5 1
Sequence length CG dinucleotide
C Melting temperature D GC content
: agamnmnnnmmnnnmmtn 2 eaémmmmmm:
. 2 T Wu” UUUULIWLHUT .. 2 f DLJPJ. .LJPPLI-
s._ -.::i§555§5§555§5:H. a._ giggaaaggi
N_ L,Jig:i"iggj *1 N_ 
: “3‘15: ‘ 2 111113 f
o 7I1I I7I5I I7IsI I8I1I I8I4I I8I7I I9IoI I o oI3 I 0I4 I 0I5 I oIe I oI7 I 0I8 I
Melting temperature GC content

Fig. 4. The effects of (A) sequence length, (B) number of CG dinucleotides,
(C) melting temperature and (D) GC content bias after correction. Gray line
is the lowess approximation.

where sij is the true methylation level and h1, h2 characterize the bias arising
from sequence length and GC content. We estimate h1, 712 from the positive
control sample instead of treatment sample itself. This is to safeguard against
removing actual methylation signals due to the potential confounding effect
with GC content, i.e. hypomethylation in CpG islands (CG—rich regions) of
normal cells (Esteller, 2007; Irizarry et al., 2008). Let

h1(Lj) = a11(Lj < 44)+a2LjI(44 SLj < 57)
+053] (Lj Z 57)
h2(GCj) = y11(GCj < 0.4) + yzGCJ-I(0.4 5 GCj < 0.8)

+y3I(GCj 3 0.8)
under the constraints (1) al 244052, (2)013 = 57012, (3) 7/1 20.47/2 and (4) 7/3 =
0.8)/2 for continuity at the knots. That is, we model In and 712 as piecewise
constant + linear + constant. The knots are chosen so that the number of
observations in {Lj <44} and {Lj :57} are comparable with the number of
observations in {Lj =n} for n=44, ...,56 as well as to avoid over (under)—

estimation for large (small) Lj, and vice versa for GCj.
In Figure 4, we plot the corrected  against the attributes, where

 _ exp(yg—il1(Lj)—02(ch))
, _ . .
I 1+exp(y,-j—h1(Lj)—h2(GCj))

 

for the positive control. As evident from this ﬁgure, the bias of these four
attributes are reduced substantially.

3.2 A weighted model-based approach

One of the most common applications of DNA methylation is in
identifying subgroups with distinct methylation patterns (Christensen et al.,
2009; Houseman et al., 2008; Marsit et al., 2009; Shen et al., 2009;
Siegmund et al., 2004) via unsupervised clustering techniques. Numerous
clustering methods have been developed, including non—parametric (e.g.
agglomerative hierarchical clustering) and model—based approaches. Model—
based clustering assumes that the data is generated from a ﬁnite mixture
model, in which each mixture component corresponds to a cluster. It has
emerged as a popular technique and allows for statistical inference (e.g.
selecting number of clusters and estimating membership probability) to
be carried out (Fraley and Raftery, 2002; Siegmund et al., 2004). We let
y,- =(yl-1, . . . , yip)T to be a vector of logit—transformed beta values for sample i.
We assume that y,- is generated from a mixture of K multivariate normal

 

2851

112 /§JO'S{BUJn0prOJXO'SOTlBIHJOJUTOTQ/ﬁdnq 1110.1} pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

REKuan et al.

 

distributions. Speciﬁcally,

K K
yi “2771(ka Zﬁk =1,
k=1 k=1

fk ~N(Mk+h1(L)+h2(GC)a Ek), k€{1,---,K}
where h1, 722 are pre—estimated from positive control samples as
shown in Section 3.1. Deﬁne 9,,- =y,-,- —in(L,-)—in(GC,-)~ 2521an =
25:1 ark/VOW, 2k). Let 0k =01ka 2k) be the unknown parameters. The
mixture model log—likelihood function for the whole data is given by

n K
L = Zlogznkfkamk)

i=1 k=1
As pointed out in Section 2, standard preprocessing steps for Illumina
methylation assays include a quality control of probe measurements by
excluding probes that have detection P—values (pl-j) larger than an arbitrary
cutoff. This step results in missing observations and information loss by
discarding a subset of probes. To avoid using a hard threshold for quality
assessment, we would like to assign a weight for each sample which reﬂects
its quality rather than discarding a sample completely from the analysis. We
introduce an alternative model—based clustering on a weighted likelihood—
based approach. The objective of a weighted likelihood function is to assign
a different weight to each sample, in which samples with higher weights have
more inﬂuence in estimating the mixture parameters for cluster structure
inference. The weighted mixture model log —likelihood function is given by

n K
CW = ZWiIOgZWkJCkWI-ﬂk)
i=1 k=1
where w,- is the weight of sample i. Without loss of generality, we assume
227:1 w,- = 1. The detection P—values arise as a natural weight function, since
samples with large detection P—values are less reliable. A possible choice of
weight function is w,- =medianj(logpij)/Z?:1mediani(logp,j) e (0, 1). Note
that the criteria in Marsit et al. (2009) which excluded samples that consist
of 325% observations with detection P—values Z 1 x 10—5 is a special case
by deﬁning w,=I[Q3,-(p,-j)<1 >< 10-51/27211[Q3j(p,-j)<1 x 10-5], where
Q3 is the third quartile.

Weighted model—based clustering has been shown to outperform the
non—weighted method in both simulations and real datasets from remote
sensing images in geology (Richards et al., 2009). In addition, Sec et al.
(2004) showed that detection P—values weighting in computing Pearson’s
correlation coefﬁcient improved the performance of expression proﬁling in
Affymetrix microarrays. The mixture modeling framework can be recast in
an expectation—maximization (EM) framework for estimating the unknown
parameters 0k. We introduce zik to be the unobserved indicator latent variable
taking value 1 if sample i belongs to cluster k and 0 otherwise. The complete
weighted log—likelihood function is

n K
Lew = zzwmknognmogmi;0km
i=1 k=1

In clustering DNA methylation proﬁles for identifying subgroups among
the n samples, we are faced with the well—known ‘large p, small n’ problem.
One strategy is to apply dimension reduction, e.g. principal component
analysis (PCA) to the p loci, followed by clustering on the reduced space.
However, treating dimension reduction and clustering as two separate steps
may destroy the cluster structure in the data (Raftery, 2003; Wang and Zhu,
2008). Moreover, each PCA is a linear combination of all CpG loci, and does
not allow for automatic selection of important CpG loci. Therefore, our goal
is to incorporate a variable selection in model—based clustering approach,
which identiﬁes important CpG loci (variable selection) and subgroups
among the n samples (clustering) simultaneously based on a penalized
criterion (Pan and Shen, 2007; Wang and Zhu, 2008). We consider a penalized
complete weighted log—likelihood to achieve the goal:

n K
anew =ZZw1zikilogm.How/peek)»—J(s2) (1)

i=1 k=l

where Sl={y.kj,k=1,...,K;j=1,...,p} and J(SZ) is a penalty function.
Several choices of penalty functions are available, e.g. Pan and Shen
(2007) proposed an L1 —norm penalty function which takes the form J (52) 2
25:1 237:1 lakjl. As pointed out by Wang and Zhu (2008), however, there
is a natural group structure among akj’s, i.e. for each j, we can treat akj,
k: 1, ...,K as a group since they are associated with the same CpG locus.
The L1 —norm penalty function ignores this group structure and treats mg-
individually. As a result, it tends to keep many unimportant loci in the model.

To circumvent this problem, Wang and Zhu (2008) proposed a penalty
function that incorporates group information and shrinks akj’s more
effectively. In addition, some loci have large detection P—values across all
samples and are unreliable. Therefore, we would like to impose heavier
penalty on these loci. We achieve this by introducing gj to be weight of locus
j, where larger gj values indicate more reliable probes. One possible choice
is gjzmedianl-(logpl-J-V Z§21mediani(logp,j)e(0, 1) (here we take median
across samples, cf. wi: median across loci). We generalize the proposed
penalty function by Wang and Zhu (2008) by including the detection P—values
as follows:

 

_ p y,- K p l6ij
J(Q)—Z—+AZZ

. ”’ .05 ”’ .05
1.21 gjmanU/ijl ) [(211.21 lﬂkjl

where akj = 156k], ﬂkj’s are the unpenalized estimates of cluster means and
a is a non—negative tuning parameter. Under this penalty function, loci with
large detection P—values will be as signed a higher penalty, and are more likely
to be excluded in the variable selection. A is a tuning parameter that controls
the sparsity, i.e. small (large) A results in the selection of more (fewer)
CpG loci. Additional details on the proposed penalty function are given in
Supplementary Materials. We further assume that 23k = E = diag(of, ...,02)
as in Wang and Zhu (2008). That is, the covariance matrices are the same
across different clusters and are diagonal, a common assumption for a high
dimension and small sample size problem. Further theoretical justiﬁcations
for adopting the diagonal structure of the covariance matrix are provided by
Bickel and Levina (2004).
At the t iteration of the EM algorithm, the E—step computes

 

A(t—1)~(t—1) ~ . A(I-1)
20) _ 77k fk (yika )
ik _ .. A _
K A t—l t—l ~ (t 1)
ZC=17T£ )fc( )(Vﬁak )

fori=1,...,nandk=1,...,K.

The M—step involves maximizing Equation (1) with respect to (ark,
“kl-bf). Following the derivations in Wang and Zhu (2008) with
modiﬁcations to incorporate the weights wi, gj and that Zilwi = 1,

n

.0) A(t—1)

77k = Zwizik 7
i=1

K n
A2t A  "’  2
a” = ZZWz-Zik Vat-Me) a
k=l i=1

The estimates for )/j and ij are not trivial, since the penalty function is
singular at the origin point. However, similar to the derivation in Wang and
Zhu (2008), we can update estimates of )/j and ij iteratively by the following
explicit formula, which makes our method easy to implement in practice:

771' = [ewe-#0)

(i sing, 6,2 )
+

 

A K _ ~ K
k219kak=15k gjman(|/ij|“)zk=1€k

ij = I(y->0)Sign(M2-) —I — +
I I Vj lejlo‘i/j2 27:1 WiZik +
where 5k 22?:1wi21k0gj and [12].:  The E—step and M —step are

iterated till convergence.

 

2852

112 /§JO'S{BUJn0prOJXO'SOTlBIHJOJUTOTQ/ﬁdnq 1110.1} pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

Model for DNA methylation array

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Sequence length B CG dinucleotide
' TTTTTTTTTTnaamaaan ' TﬁﬁﬂT T T
3- Dnﬂunﬁﬂﬂﬂnwu: H: a- Elma
,, - EL] [IULJIJUIEIDEEEUVT ,, - sHJLHLIULJ,
T5 .-"::'ii§.,Ii 5 ::;:.§:
“3*.— ' I: 1... m‘t— _I_ : - I I I -
° E:::§iio: :o:° 8° ° :1: : : :7—
—_ 151511°§§§:: . - s g ‘f -i E f
8_IITI§+I§§I§IIIIIIIT g_ ‘I’ § 3 g —I— I I
4143 45 47 49 5153 55 57 59 1 2 3 4 5 6 7
Sequence length CG dinucleotide
C Melting temperature D GC content
__=I.If|l:||ﬂﬁ|fhi'II'TTTTTT _—|:li|ﬁ|:|TTTTTT
m omenﬂmﬂ ~ e- UUDUPD
° Hie” liﬂuuﬁﬁmﬂﬂ; ° -. . ewumﬁﬂn
s ' 1° §L§I::'1.HUDH a ' +3; I.D
av °°o.TT:aas::: are- H.525.
°'I*g::::: 4 O I I : :
_ o .ee;lill _ 3. Ti; :
I°I*‘IIII 383 I I
g IIIIIIIIII§§??TTTITII g_ I I I I I II, 
71 75 78 81 84 87 90 0.3 0.4 0.5 0.6 07 0.8
Melting temperature GC content

Fig. 5. The effects of (A) sequence length, (B) number of CG dinucleotides,
(C) melting temperature and (D) GC content bias on positive control of
Houshdaran et al. (2009). Gray line is the lowess approximation.

As in Pan and Shen (2007) and Wang and Zhu (2008), we choose the
tuning parameter A and the number of clusters K by minimizing the Bayesian
information criterion (BIC). To account for the weights w,- in the likelihood
functions in which 217:1 w,- = 1, we deﬁne a modiﬁed BIC as follows:

71 K
BIC = —2nZw,-log (Zﬁkfkﬁi;0k)) +Plogn
i=1 k=1
where P is the total number of non—zero estimates in [1k], 61.2 and in. The ﬁrst
term is the right—hand side is exactly the regular —2 217:1 loglik when w,- =
l/n, Vi. We name our method LumiWCluster (IlLitmina Weighted model—
based Clustering).

4 RESULTS

4.1 DNA methylation studies in ovarian cancer

We illustrate our proposed method on the ovarian epithelial
carcinoma tumors and cell lines methylation dataset from
Houshdaran et al. (2009). In Figure 5, we show the presence of
sequence bias on the positive control sample in this dataset. The
observed pattern in consistent with our six positive control samples
(Fig. 3). Using the estimated hl and fig from our six positive controls,
we adjust for the observed bias in the ovarian methylation dataset.
Although hl and hz are estimated from an independent source of
data, we show that the effect of sequence bias is reduced signiﬁcantly
for the ovarian methylation dataset (Fig. 6).

This ovarian cancer dataset consists of 27 primary tumors (15
serous, 9 endometrioid and 3 clear cell) and 15 cell lines. By applying
our proposed weighted clustering approach (LumiWCluster) to this
dataset, the optimal number of clusters chosen is K :4. Details
are provided in Supplementary Materials. We also compare the
clustering results from Gaussian mixture model without penalty
and weights, i.e. J(SZ)=0, wizl/n Vi, gj=1/p Vj. The optimal
number of clusters chosen is K :3. We refer to this model as
GMM—nopenalty. This model is a special case of Mclust by Fraley
and Raftery (2002). Mclust is a non—penalized standard model—
based clustering which allows for different functional forms of
the covariance matrices, where all CpG loci are retained in the
resulting clustering. We also include the clustering results from

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A Sequence length B CG dinucleotide

_ TTTTTTTTTT T T T T TTDT ' 

°°-- Dhﬂnnnmnunnnnn B ,,__

° Enﬂguuuuuguuuuuw, ° mummwi
s ' ::.EEE::EE::: ‘= :2 ‘E E E i : IT
85 :E:i::i§:::§ii21 8;”: : : .'

o ..:I: :11... 4 *‘if
__ $1470: Eig°g° _ g +5 I _I_ 6
.I.o °°°°° 8 o 5 ° 6

0.- .°.:§ :.°s° . 0.- . 9 § I t

O IIIIIIIIIIIIIIIIIII o I I I I I I I

41434547495153555759 12 3 4 5 6 7
Sequence length CG dinucleotide
C Melting temperature D GC content
evmnnnnnnnnnnnnnn ' Ennﬁﬁai T T T T

__ 1 FL 00 DEC“:

° .wameuuuwuuuw ° uuDUUUUu U
.19 :I:I:E::EE::EI4 a ' 5::55555
4;- .Tiiiiiiigiiiii 8;- :ss:§:s:ia

i°° +.I:eo:1*° 47*: Till:

_ sum: 8: _ eggisi:

8°  A : e 8 g o o I

g_IIIIIII‘I’I‘I’?§§IIIIITII  IIIIIT?? ‘I-I-I

71 75 7s 81 84 87 90 0.3 0.4 0.5 0.6 07 0.8
Melting temperature GC content

Fig. 6. The effects of (A) sequence length, (B) number of CG dinucleotides,
(C) melting temperature and (D) GC content bias after correction on positive
control of Houshdaran et al. (2009). Gray line is the lowess approximation.

Table 1. Clustering result for the ovarian cancer data

 

 

Cluster LumiWCluster GMM—nopenalty Mclust

1 15CL 15CL 15CL

2 1CC, 2E, 98 1CC, 2E, 98 1CC, 2E, 98
3 2CC, 5E, 38 2CC, 7E, 68 2CC, 5E, 38
4 2E, 38 — 2E, 38
Cluster k—means PAM

1 15CL, 1CC, 2E 98 13CL, 1CC, 2E, 98

2 2CC, 7E, 68 2CL, 2CC, 7E, 68

 

CC, clear cell; CL, cell lines; E, endometrioid; S, serous.

Mclust, k—means and PAM (partitioning around medoids, a more
robust version of k—means) (Kaufman and Rousseeuw, 1990)
which identify K :4, 2 and 2 as the optimal number of clusters,
respectively. The optimal number of clusters chosen by k—means
and PAM is based on the ‘silhouette’ criterion (Rousseeuwl, 1987).
As shown in Table 1, k—means and PAM are unable to separate
cell lines from primary tumors; whereas LumiWCluster, GMM—
nopenalty and Mclust yield comparable cluster membership, where
cell lines are separated from primary tumors, but there are some
mixing among the three tumor subtypes. However, an advantage
of LumiWCluster is that it automatically shrinks 554 CpG loci to
0, which implies that these loci do not contribute to the clustering.
This reﬁnes the set of CpG loci which are important in the resulting
cluster structure. These 554 CpG loci include the eight sites which
have median detection P > 0.05 and are excluded using the ﬁltering
criterion in Marsit et al. (2009). We also demonstrate that the
ability of LumiWCluster in selecting important Cst yields tighter
clusters in Supplementary Materials. In addition, LumiWCluster
results in smaller BIC compared with GMM—nopenalty and Mclust,
indicating a better model ﬁt. We provide additional information
on the advantages of incorporating the detection P—values in our
proposed clustering approach in Supplementary Materials.

 

2853

112 /§.IO'S[BU.IHOIIp.IOJXO'SOTlBIHJOJUTOTQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

REKuan et al.

 

Table 2. Clustering result for the HCC—cirrhosis data

 

Cluster LumiWCluster GMM—nopenalty Mclust

 

1 20C 17C 17C

2 20N UN 1 1N

3 — 3C, 9N 3C, 9N

Cluster k—means PAM GMM—nopenalty

(with subset of Cst

selected by LumiWCluster)

1 17C 17C 20C
11N 11N 20N
3 3C, 9N 3C, 9N —

 

C, HCC with cirrhosis samples; N, normal liver tissues.

4.2 DNA methylation studies in HCV-cirrhosis

Our next example is on a data set measuring DNA methylation
of hepatocellular carcinoma (HCC) (Archer et al., 2010) from
Illumina GoldenGate Methylation BeadArray. This data set consists
of 20 samples from HCC with cirrhosis and 20 normal liver
tissues. Similar to Section 4.1, we compare the clustering results
from LumiWCluster, GMM—nopenalty, Mclust, k—means and PAM
on the normalized data (corrected for sequence length and GC
content biases). LumiWCluster selects K :2, whereas the rest
of the methods select K :3 as the optimal number of clusters.
LumiWCluster automatically shrinks 639 CpG to zero and results
in perfect separation between the C and N samples. However, the
other methods contain misclassiﬁcation of these samples (Table 2).
In Supplementary Materials, we also provide the clustering results
for the other methods by ﬁxing K = 2. Unlike LumiWCluster, these
methods still misclassify the two different types of samples.

Next, we run GMM—nopenalty on the subset of CpG loci selected
by LumiWCluster [referred to as ‘GMM—nopenalty (with subset
of Cst selected by LumiWCluster)’ in Table 2]. Interestingly,
the optimal number of clusters is chosen to be 2 and results in
perfect classiﬁcation. This highlights that LumiWCluster is able to
select informative CpG loci that differentiate cirrhosis from normal
tissues.

To further illustrate the advantage of LumiWCluster in selecting
important CpG loci, we carry out the non—parametric Wilcoxon rank—
sum test for comparing cirrhosis and normal group samples on each
of these 1505 CpG loci. The P—values are adjusted using the false
discovery rate (FDR) control (Benjamini and Hochberg, 1995). At
FDR of 0.05, 597 loci are signiﬁcant, of which 578 overlap with the
866 loci selected by LumiWCluster. This shows that LumiWCluster
is able to retain statistically signiﬁcant loci. As a comparison, 19
CpG loci have median detection P > 0.05 and will be excluded
using the ﬁltering criterion in Marsit et al. (2009). Among these 19
loci, 15 of them were shrunk to 0 by LumiWCluster. Figure 7A and
B shows the distribution of the ,8 values for two CpG loci that were
not shrunk to 0, which appear to be informative in differentiating
HCC with cirrhosis from normal liver tissues. We also include two
CpG loci that have median detection P >0.05 and were shrunk to
0 by LumiWCluster (Fig. 7C and D). This again demonstrates the
ability of LumiWCluster in selecting informative Cst which can
differentiate the two groups despite being completely unsupervised.

 

 

A APOC2_P377_F(2.3e-05) B DKFZP56400823_P386_F(3.69-07)

—l—

0.9
I

_I_
I


E4

I I I I
Cirrhosis Normal Cirrhosis Normal

0.7
I

Beta
Beta
0.50 0.60 0.70 0.80
I I I I I I I I

0.5
I

 

 

 

 

0.3
I

 

 

 

C AGTR1_P154_F mu=0 (0.12) D CSF1_P217_F mu=0 (0.68)

 

 

_'_

Q a Q Em

I I I I
Cirrhosis Normal Cirrhosis Normal

Beta

Beta
0.05 0.10 0.15 0.20
l l I l
0.05 0.10 0.15 0.20
I I I I

 

 

 

 

 

 

 

Fig. 7. (A, B) Distribution of 6 values for three Cst which are omitted by
the criterion in Marsit et al. (2009), but are not shrunk to zero in our weighted
model—based clustering. (C, D) Example of Cst which are omitted by the
criterion in Marsit et al. (2009) and are shrunk to zero in our weighted model—
based clustering. The numbers printed in the parenthesis are the adjusted
P—values.

5 DISCUSSION

The delineation of DNA methylation patterns is important in
understanding how these epigenetic changes might lead to aberrant
expression patterns and disease (Laird, 2010). Advancements in
biotechnology have enabled high—throughput proﬁling of DNA
methylation, including the Illumina GoldenGate and Inﬁnium
BeadArray via bisulphite conversion. These platforms are robust,
highly reproducible and require less starting materials. In the ﬁrst
part of this study, we illustrated the source of biases present in
Illumina Methylation arrays and proposed a model for correcting
these biases.

A common approach in analyzing Illumina Methylation data
includes omitting CpG loci and samples that exhibit detection
P—values larger than an arbitrary cutoff. This hard thresholding
step often results in missing observations and information loss by
discarding a subset of probes. We proposed a weighted model—based
approach called LumiWCluster that weights each CpG locus/ sample
by its detection P—values for clustering DNA methylation proﬁles.
In this article, we set the weights as the median detection P—values
across samples (or CpG loci) which appears to perform well in the
two case studies. Optimal selection of weight functions is beyond
the scope of this article and will be an interesting future research
direction.

ACKNOWLEDGEMENTS

We thank Drs Nancy Thomas, Kathleen Conway and Sharon
Edmiston for providing the control samples and the reviewers for
valuable comments.

F anding: NCI (grants 5—P30—CA16086—34 and 1R21CA134368—
01A1 to PK. and HG, in parts); Susan G Komen Foundation (grant
KG081397 to PK. and HG, in parts).

Conﬂict of Interest: none declared.

 

2854

112 /§.IO'S[BU.IHOIIp.IOJXO'SOTlBIHJOJUTOTQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

IWodeIkwlNMArneﬂhﬂaﬁananew

 

REFERENCES

Archer,K. et al. (2010) High-throughput assessment of CpG site methylation
for distinguishing between HCV-cirrhosis and HCV-associated hepatocellular
carcinoma. Mol. Genet. Genomics, 283, 341—349.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. R. Stat. Soc. Ser. B, 57, 289—300.
Bibikova,M. et al. (2006) High-throughput DNA methylation proﬁling using universal

bead arrays. Genome Res., 16, 383—393.

Bickel,P. and Levina,E. (2004) Some theory for Fisher’s linear discriminant function,
“naive Bayes", and some alternatives when there are many more variables than
observations. Bernoulli, 10, 989—1010.

Christensen,B. et al. (2009) Aging and environmental exposures alter tissue-speciﬁc
DNA methylation dependent upon CpG island context. PLoS Genet, 5, e1000602.

Down,T. et al. (2008) A Bayesian deconvolution strategy for immunoprecipitation based
DNA methylome analysis. Nat Biotechnol, 26.

Dunning,M. et al. (2008a) Spike-in validation of an Illumina-speciﬁc variance-
stabilizing transformation. BMC Res. Notes, 1, 18.

Dunning,M. et al. (2008b) Statistical issues in the analysis of Illumina data. BMC
Bioinformatics, 9, 85.

Esteller,M. (2007) Cancer epigenomics: DNA methylomes and histone-modiﬁcations
maps. Nat Rev. Genet, 8, 286—298.

Fraley,C. and Raftery,A. (2002) Model-based clustering, discriminant analysis, and
density estimation. J. Am. Stat. Assoc, 97, 611—631.

Hernandez-Vargas,H. et al. (2010) Hepatocellular carcinoma displays distinct DNA
methylation signatures with potential as clinical predictors. PLoS One, 5, e9749.

Houseman,A. et al. (2008) Model-based clustering of DNA methylation array data: a
recursive-partitioning algorithm for high-dimensional data arising as a mixture of
beta distribution. BMC Bioinformatics, 9, 365.

Houshdaran,S. et al. (2009) DNA methylation proﬁles of ovarian epithelial carcinoma
tumors and cell lines. PloS ONE, 5, e9359.

Illumina (2006) GoldenGate methylation cancer panel 1. Available at http://www
.illumina.com/technology/goldengate_methylation_assay.ilmn.

Irizarry,R. et al. (2008) Comprehensive high-throughput arrays for relative methylation
(CHARM). Genome Res., 18, 780—790.

Irizarry,R. et al. (2009) The human colon cancer methylome shows similar hypo- and
hypermethylation at conserved tissue-speciﬁc CpG island shores. Nat Genet, 41,
178—186.

Ji,Y. et al. (2005) Applications of beta-mixture models in bioinformatics.
Bioinformatics, 21, 2118—2122.

Kaufman,L. and Rousseeuw,P. (1990) Finding Groups in Data: An Introduction to
Cluster Analysis . Wiley-Interscience.

Koga,Y. et al. (2009) Genome -wide screen of promoter methylation identiﬁes novel
markers in melanoma. Genome Res., 19, 1462—1470.

Laird,P. (2010) Principles and challenges of genome-wide DNA methylation analysis.
Nat Rev. Genet, 11, 191—203.

Lynch,A. et al. (2009) Considerations for processing and analysis of Goldengate-based
two-colour illumina platforms. Stat. Methods Med. Res., 18, 4374152.

Marsit,C. et al. (2009) Epigenetic proﬁling reveals etiologically distinct patterns of
DNA methylation in head and neck squamous cell carcinoma. Carcinogenesis, 30,
416—422.

Pan,W. and Shen,X. (2007) Penalized model-based clustering with application to
variable selection. J. Mach. Learn. Res., 80, 1145—1164.

Raftery,A. (2003) Discussion of “Bayesian clustering with variable selection and
transformation selection" by liu et al. Bayesian Stat, 7, 266—271.

Rakyan,V. et al. (2008) An integrated resource for genome-wide identiﬁcation and
analysis of human tissue-speciﬁc differential methylated regions (tDMRs). Genome
Res., 18, 1518—1529.

Richards,J. et al. (2009) Weighted model-based clustering for remote sensing image
analysis. Comput Geosci., 14, 125—136.

Rousseeuwl,P. ( 1987) Silhouettes: a graphical aid to the interpretation and validation
of cluster analysis. J. Comput Appl. Math, 20, 53—65.

Seo,J. et al. (2004) Interactively optimizing signal-to-noise ratios in expression
proﬁling, project-speciﬁc algorithm selection and detection p-value weighting in
Affymetrix microarrays. Bioinfomatics, 20, 2534—2544.

Shen,R. et al. (2009) Integrative clustering of multiple genomic data types using a joint
latent variable model with application to breast and lung cancer subtype analysis.
Bioinformatics, 25, 2906—2912.

Siegmund,K. et al. (2004) A comparison of cluster analysis methods using DNA
methylation data. Bioinformatics, 20, 1896—1904.

Wang,S. and Zhu,]. (2008) Variable selection for model-based high dimensional
clustering and its application to microarray data. Biometrics, 64, 440—448.

Wei,H. et al. (2008) A study of the relationships between oligonucleotide properties
and hybridization signal intensities from NimbleGen microarray datasets. Nucleic
Acids Res., 36, 2926—2938.

Wong,W. et al. (2008) On the necessity of different statistical treatment for Illumina
BeadChip and Affymetrix GeneChip data and its signiﬁcance for biological
interpretation. Biol. Direct, 3.

Xie,Y. et al. (2009) Statistical methods of background correction for Illumina BeadArray
data. Bioinformatics, 25, 751—757.

 

2855

112 /§.IO'S[BU.IHOIIp.IOJXO'SOTlBIHJOJUTOTQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

