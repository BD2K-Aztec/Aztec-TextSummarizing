Bioinformatics Advance Access published July 24, 2016

Bioinformatics, 2016, 1—3

doi: l0.1093/bioinformatics/btw411

Advance Access Publication Date: 4 July 2016
Applications Note

 

 

Systems biology

AMIG02, a toolbox for dynamic modeling,
optimization and control in systems biology

Eva Balsa-Canto*, David Henriques, Attila Gabor and Julio R. Banga

Bioprocess Engineering Group, IIM-CSIC, 36208 Vigo, Spain

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on May 11,2016; revised on June 16, 2016; accepted on June 22,2016

Abstract

Motivation: Many problems of interest in dynamic modeling and control of biological systems can
be posed as non—linear optimization problems subject to algebraic and dynamic constraints. In the
context of modeling, this is the case of, e.g. parameter estimation, optimal experimental design
and dynamic flux balance analysis. In the context of control, model—based metabolic engineering
or drug dose optimization problems can be formulated as (multi—objective) optimal control prob—
lems. Finding a solution to those problems is a very challenging task which requires advanced nu—

merical methods.

Results: This work presents the AMIG02 toolbox: the first multiplatform software tool that automa—
tizes the solution of all those problems, offering a suite of state—of—the—art (multi—objective) global

optimizers and advanced simulation approaches.

Availability and Implementation: The toolbox and its documentation are available at: sites.google.

com/site/amigoZtooIbox.
Contact: ebalsa@iim.csic.es

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Optimization is at the core of many problems related to the model—
ing and design of biological systems (Banga, 2008). For example,
model parametric identification involves two types of optimization
problems (Balsa—Canto et 61]., 2010): parameter estimation, to com—
pute unknown parameters by data fitting and optimal experimental
design, to design the best experimental dynamic scheme for model
identification.

The organization and behavior of biological systems can also be
described based on optimality principles. This is the case in, e.g. (dy—
namic) flux balance analysis (Kauffman et 61]., 2003) or in the ana—
lysis of activation of metabolic pathways (Klipp et 61]., 2002). In this
context, model-based dynamic optimization aims the computation
of time-varying ﬂuxes or enzyme concentrations and expression
rates that minimize (or maximize) a given objective function (bio—
mass production) or the best trade—off between various objectives
(de Hijas—Liste et 61]., 2014).

©The Author 2016. Published by Oxford University Press.

Models can be used to confirm hypotheses, to draw predic—
tions and to find those (time varying) stimulation conditions
that result in a particular desired behavior via (multi-objective)
optimal control. This is the case in, e.g. model-based metabolic
engineering (Villaverde et 61]., 2016), pattern formation (Vilas
et 61]., 2012) or drug dose optimization (Jayachandran et 61].,
2015

All these problems can be stated as—or transformed to—(multi—
objective) non—linear programming problems with algebraic and dy—
namic constraints. Their solution requires the combination of the
control vector parameterization approach, a simulation method and
a global optimizer.

AMIG02 is the first multi-platform (MATLAB-based) environ-
ment that automatizes the solution of all these problems (see Fig. 1
and Supplementary Tables 81 and S2). It fully covers the iterative
identification of dynamic models, it allows using optimality prin-
ciples for predicting biological behavior and it deals with the

1

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /310's113u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popcorn/hog

9IOZ ‘09 lsnﬁnv uo ::

E. Balsa-Canto et al.

 

' Model calibration
Parameter estimation
noise Regularization, constraints
Post- analysis
_fPE, REG_PE ‘t‘
I?" PEPostAnalysis‘K

Biological system
Experimental data/

   

Network display rsensitivity
ShowNetwor‘k analysis
 Local & Global

Rank of parameters I;
II" ' ' ' _ I MK "x
A, LRank K .

If GRank \ \‘xk

f

 

._\

Model simulation
Black-box model
Pseudo-data generation

Fig. 1. AMIG02 features and tasks

optimal control of biological systems using constrained multi—
objective dynamic optimization.

2 Summary of features
2.1 Models

The tool supports general non—linear deterministic dynamic models
and black—box simulators, dealing with ordinary, partial or delay
differential equations. Biological networks can be visualized linking
to Cytoscape (Shannon et al., 2003).

2.2 Experimental scheme and data
Users can define multi—experiment schemes with maximum flexibil-
ity and several types of Gaussian experimental noise with known or
unknown observable dependent variance.

2.3 Parameter estimation with regularization

It is possible to estimate parameters and initial conditions which
may depend on the experiment using weighted least squares or log—
likelihood functions. Ill—conditioned problems can be handled using
Tikhonov regularization. Users may fix the regularization parameter
or let the tool to automatically compute the most appropriate using
the L—shaped Pareto curve (Gabor and Banga, 2015).

2.4 Identifiability and best fit post—analysis

The tool offers various methods to analyze model identifiability: (i)
local and global parametric sensitivities; (ii) the Fisher Information
Matrix for an asymptotic analysis; (iii) cost contour plots and (iv) a
robust Monte—Carlo sampling approach. Results can be used to de—
fine and solve optimal experimental design problems aimed at im—
proving identifiability. Besides, the validity of models along with the
significance and determinability of their parameters are assessed
using the 12 goodness of fit and Pearsons 12 tests, the autocorrel—
ation of residuals, and the Akaike and Bayesian information criteria.

2.5 Optimal experimental design

To improve identifiability, users may automatically design simultan—
eous or sequential experiments optimizing observables, initial and
stimulation conditions, number and location of sampling times and
experiment durations. The tool allows for different design objectives

and experimental error descriptions.

,_ r f'PET RIden’c“,
\. /  Contour‘P '
f

 

Identiﬁability analysis
Conﬁdence on parameters
and predictions

: Correlation

(MO) Optimization
based modeling
DFBA, Enzyme activation

Optimal

experiments

What, when and
\ how to measure

I} ___ —

f.
  OED ‘3

DO

  

(MO) Optimal control
Metabolic engineering,
Stimulation design,
Drug dosage design, etc.

2.6 (Multi—objective) Optimal control

AMIG02 solves optimal control problems with ﬂexibility in the ob-
jective functional, stimuli interpolation, and path and point con—
straints. The aim is to find time varying stimulation conditions to
maximize or minimize a given objective related to cell performance
or to a desired behavior. The control vector parameterization
method with mesh refining allow the efficient solution for smooth
control profiles. Pareto fronts with best trade—offs for multi—
objective cases can be obtained with the weighted sum method, the
e—constraint approach or the multi—objective genetic algorithm
NSGA-II (Deb et al., 2002).

2.7 C based enhancements

The tool generates C code to offer the following modes of operation:
(i) C based simulation, compatible with all tasks; (ii) C based cost
function and (iii) stand—alone C code for parameter estimation.

2.8 Numerical methods

AMIG02 incorporates the MATLAB—based initial value problem
solvers as well as CVODES (Hindmarsh et al., 2005) to cover stiff,
non—stiff and sparse dynamic systems. Parametric sensitivities can be
computed by either direct methods or various finite differences
schemes. Also, exact Jacobians can be obtained using symbolic ma—
nipulation. Regarding the optimizers, AMIG02 interfaces to a suite
of state—of—the—art solvers to cover constrained convex and non—
convex, multi—objective non—linear optimization problems. Users can
also test their optimizers within the toolbox.

2.9 Documentation

Descriptions of tool underlying theory, numerical methods, and usage
are provided on the web page. Users can access HTML documenta—
tion from the MATLAB Help menu. Step by step examples illustrate
the usage of the tool and serve as templates for new problems.

Acknowledgements

The authors acknowledge the different beta-testers and M. Perez-Rodriguez
for the AMIG02 logo design.

Funding

EU FP7 project NICHE [ITN grant number 289384], Spanish MINECO/
FEDER projects IMPROWINE [grant number AGL2015-67504-C3-2-R] and
SYNBIOFACTORY [DP12014-55276-C5-2-R].

112 /810's113u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

AMIGOZ

 

Conﬂict of Interest: none declared.

References

Balsa-Canto,E. et al. (2010) An iterative identiﬁcation procedure for dynamic
modeling of biochemical networks. BMC Syst. B £01., 4, 1 1.

Banga,]. (2008) Optimization in computational systems biology. BMC Syst.
Biol., 2, 47—53.

de Hijas-Liste,G. et al. (2014) Global dynamic optimization approach to pre-
dict activation in metabolic pathways. BMC Syst. Biol., 8, 1—15.

Deb,K. et al. (2002) A fast and elitist multiobjective genetic algorithm: NSGA-
11. IEEE Trans. Evol. Comp, 6, 182—197.

Gabor,A. and Banga,].R. (2015) Robust and efﬁcient parameter estimation in
dynamic models of biological systems. BMC Syst. Biol., 9, 1—25.

Hindmarsh,A.C. et al. (2005) Sundials: suite of nonlinear and differential/alge-
braic equation solvers. ACM Trans. Mat/7. Softw., 31, 363—396.

Jayachandran,D. et al. (2015 ) Model-based individualized treatment of che-
motherapeutics: Bayesian population modeling and dose optimization.
PLOS One, 10, e013324

Kauffman,K. et al. (2003) Advances in ﬂux balance analysis. Curr. Opin.
Biotechnol., 14, 491—496.

Klipp,E. et al. (2002) Prediction of temporal gene expression. metabolic opti-
mization by re-distribution of enzyme activities. Eur. ]. Biochem., 269,
5406—5413.

Shannon,P. et al. (2003) Cytoscape: a software environment for integrated
models of biomolecular interaction networks. Genome Res., 13,
2498—2504.

Vilas,C. et al. (2012) Dynamic optimization of distributed biological sys-
tems using robust and efﬁcient numerical techniques. BMC Syst. Biol., 6,
79.

Villaverde,A. et al. (2016) Metabolic engineering with multi-objective opti-

mization of kinetic models. ]. Biotechnol., 222, 1—8.

112 /810'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

