Advance Access Publication Date: 24 February 2015

Bioinformatics, 31 (13), 2015, 2225—2227
doi: 10.1093/bioinformatics/btv122

Applications Note

 

 

Gene expression

Normalization and noise reduction for single

cell RNA-seq experiments

Bo Ding”, Lina Zheng”, Yun Zhu1, Nan Li‘, Haiyang Jia1'2, Rizi Ai‘,

Andre Wildberg‘, Wei Wang1,3,*

1Department of Chemistry and Biochemistry, University of California, La Jolla, CA 92093, USA, 2College of
Computer Science and Technology, Jilin University, Changchun 130012, China and 3Department of Cellular and

Molecular Medicine, University of California, La Jolla, CA 92093, USA

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors

Associate Editor: Ziv Bar-Joseph

Received on December 15, 2014; revised on February 1, 2015; accepted on February 19, 2015

Abstract

A major roadblock towards accurate interpretation of single cell RNA—seq data is large technical
noise resulted from small amount of input materials. The existing methods mainly aim to find dif—
ferentially expressed genes rather than directly de—noise the single cell data. We present here a
powerful but simple method to remove technical noise and explicitly compute the true gene ex—

pression levels based on spike—in ERCC molecules.

Availability and implementation: The software is implemented by R and the download version is

available at http://wanglab.ucsd.edu/star/GRM.
Contact: wei—wang@ucsd.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Single-cell RNA-seq is a promising technology with broad applica—
tions and discerning biological noise from technical noise is critical
for correctly interpreting the data (Jaitin et 61]., 2014). Recently, stat—
istical methods are developed to model the technical noise from
spike—in ERCC molecules, whose concentrations are presumably
same across the samples, and then identify differentially expressed
genes, whose variations across samples are significantly larger than
technical noise (Brennecke et 61]., 2013). A limit for such an ap—
proach is that the true gene expression level is not explicitly calcu—
lated, which is needed for many analyses based on quantification of
transcriptions.

Here we propose a novel strategy to normalize and de—noise sin—
gle cell RNA—seq data. This method calculates RNA concentrations
from the sequencing reads, which is opposite to the other published
methods that model sequencing reads from RNA concentrations; it
is much simpler than the existing methods but importantly it allows
to remove technical noise and explicitly compute gene expression.
Specifically, we fit a gamma regression model (GRM) between the

sequencing reads (RPKM, FPKM or TPM) and the concentration
of spike-in ERCC molecules. The trained model is then used to
estimate the de—noised molecular concentration of the genes from
the reads. GRM shows great power of reducing technical noise and
superior performance compared to several popular normalization
methods such as FPKM (Tu et 61]., 2012), TMM (Robinson and
Oshlack, 2010) and FQ (Bullard et al., 2010) in analyzing single cell
RNA—seq data.

2 Results

2.1 Fit a GRM from read counts to RNA concentrations

Spike—in ERCCs can be added equally to each sample during
the library preparation to calibrate measurements of single cell
RNA—seq. A natural approach is to train a model to compute read
counts such as FPKM from the concentrations of ERCC
(FPKM:function(concentration)). This model is then used to
calculate the expression level or molecular concentration of
each gene from its FPKM using the reversed relationship

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2225

112 /§JO'S{eumo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

2226

B. Ding et al.

 

(concentration:function(FPKM)). However, substantial technical
noise in single cell RNA—seq makes it non—trivial to construct such a
model(Grun et al., 2014). In addition, it can be challenging to
analytically or numerically solve the reverse model. We therefore
propose to fit the “reverse” model directly (concentration:
function(FPKM)) using ERCCs. This way, gene expression levels
can be directly computed from FPKM. Such a strategy is novel
and much simpler than the published methods that model noise
distribution without explicitly computing the de—noised gene expres—
sion levels.

We choose to use gamma distribution to model the distribution
of molecular concentrations because of its ﬂexibility to fit diverse
shapes. As the values of molecular concentration (10_2—104) and
FPKM (always 0—104_5) vary in a large range, we first perform log
transformation of these data, x = log (FPKM) (log—R) and
y : log(concentration) (log—C). Instead of fitting a GRM between x
and 3/ directly, we model the non—linearity of single cell signals using
a polynomial function u(x) : Zfzoﬂixi. The model is the
following:

y N Gamma(y; We), 90)

with the probability density function:

_ 1 ﬁrm _ﬂ
f(y)_yF(<0)(M(x)) p( MW)

The parameters are determined using maximum likelihood esti-
mation. The optimal value of n is determined by an empirical search:
we train multiple models with n = 1 to n = 4 and select n with small—
est average technical noise of ERCCs.

Using the regression model trained from spike-in ERCCs in one
single cell sample, we compute the true expression levels of genes
from their FPKMs by calculating the expectation of a given FPKM,

ygene : E(ygene) : ﬂ(xgene) : Zfzoﬁixgene‘

2.2 Successful de—noise of single cell RNA—seq data

To demonstrate the effectiveness of our strategy, we need a dataset
that has a gold standard of cataloguing single cells and such a data—
set is still rare. Treutlein et al. (2014) performed single cell experi-
ments at four different developmental stages (GEO GSE52583).
This dataset includes 198 individual mouse lung cells derived from
four different developmental stages: E14.5 (45 samples), E16.5 (27
samples), E18.5 (80 samples) and adult (46 samples).

We first perform gamma regression on all the spike—in ERCCs.
Our model achieves an average Pearson correlation between the pre—
dicted and true concentrations of 0.866 over all the 198 samples
(Fig. 1a), significantly higher than a value of 0.119 if using a linear
regression model fit between log—R and log—C. We measure the noise
for the spike—in ERCCs across all the samples using CV2, which is
defined as the variance divided by the square of mean(Brennecke
et al., 2013; Fig. 1b, Supplementary Table S1). After de—noise, on
average the CV2 value is reduced 70%, from 1.301 to 0.408, with
the largest reduction of 90% (from 0.584 to 0.056). These results
suggest that our strategy can drastically reduce technical noise.

We next apply the model fit in each single cell to remove tech—
nical noise of the genes in the same single cell. Treutlein et al. se—
lected 124 Sftpc—positive cells to monitor the mature process of
alveolar type 2 (AT2) cells at the four developmental stages (Sftpc is
the marker of AT2 cells). Four distinct groups of cells are expected
to be found corresponding to the four developmental stages.
Treutlein et al. selected 10946 genes that were observed in more
than two samples and had a variance of transcript level

 

 

 

 

 

 

 

 

 

 

 

12: fall 3.5—0” I before tie-noise
13 Average I 3 D_ ' - after def-noise
g 10- Pearson correlatlnn=ﬂﬁﬁﬁ I J... ' ‘ '
E B- ' 2r» _ . '
I: _
3 '9 2o - -
1: ﬁ c.) I I | -
3 ' '3'1s'--:- .--
E 4- E ‘ I - - I :' .I
E ' 1.D:-!‘.|I I I II... I
E 2' ‘15— l . :':II El 1" II n."
D 1
— n n D_ I III '* '- I- ii I
r 2 4 e 5 1o 12 1 2 I: ' a in
Ingmﬂal Cmmnhum: legrﬁeal Conmnlralion]
- E14.5
[c] {d} GRM .3”
“IE; - E1115-
“d I Hutu an Eli‘s “HEHHHEE I Adull
progenTtnr _ '
ll'I
embw stimulation [15.5
I E“:-
hl- mutlrll nltar
—"—-m—-- [13.5 a
adult -
Adults g

-—r the direction for dwelopmem

' #ﬂmmﬁurrm‘ﬂ

Fig. 1. (a) The correlation between the true and predicted molecular concen-
trations for the spike-in ERCCs in one sample. (b) Noise represented by CV2
before and after de-noise using GRM. (c) The dendrogram of the hierarchical
clustering of de-noised data correctly correspond to the four developmental
stages. (d) Hierarchical clustering on 124 Sftpe+ single cells after de-noise

(log2(FPKM)) across all the sample larger than 0.5. If all the cells
are clustered using these genes by hierarchical clustering, single cells
from different stages are mixed (Supplementary Fig. S1(a)). After
de—noise, distinct clusters corresponding to the four developmental
stages are observed (Fig. 1d). Furthermore, the dendrogram of the
hierarchical clustering correctly represent the developmental dis—
tance between the single cells. Namely, the adult cells are most dis—
tant from embryonic ones of E14.5, E16.5 and E18.5. E14.5 and
E16.5 are most similar to each other and form the early progenitor
branch, which is connected to E18.5. This hierarchy is consistent
with the development of AT2 cells (Fig. 1c). Similarly, when PCA is
applied to all the data, the de—noised data clearly show significantly
better separation between the single cells derived from different de-
velopmental stages (Supplementary Fig. S2(a)—(e)).

Taken together, the significant lower noise in ERCCs and
achievement of more biologically meaningful clusters in the AT2 cell
development indicate that our de—noise strategy can successfully re—
move technical noise in single cell RNA—seq.

3 Conclusion

We present here a simple but powerful method for removing tech—
nical noise of single cell RNA—seq data. This method is distinct from
the existing approaches as it derives the relationship between RNA
concentrations and sequencing read counts from ERCC molecules
and then applies this relationship to calculate gene expression from
read counts. We demonstrated the success of normalization and
noise reduction of single cell RNA—seq data by showing significantly
improved clustering of single cells after denoise. Furthermore, this
method is general and also applicable to bulk RNA—seq data with
spike-in ERCCs.

Funding
This study was supported by NIH (U01 MH098977).

Conﬂict of Interest: none declared.

112 /810'spaumo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Single cell RNA-seq normalization

2227

 

References

Brennecke,P. et al. (2013) Accounting for technical noise in single-cell
RNA-seq experiments. Nat. Methods, 10, 1093—1095.

Bullard,].H. et al. (2010) Evaluation of statistical methods for normalization
and differential expression in mRNA-Seq experiments. BMC
Bioinformatics, 11, 94.

Jaitin,D.A. et al. (2014) Massively parallel single-cell RNA-seq for marker-
free decomposition of tissues into cell types. Science, 343, 776—779.

Robinson,M.D. and Oshlack,A. (2010) A scaling normalization method
for differential expression analysis of RNA-seq data. Genome Biol., 11,
R25.

Treutlein,B. et al. (2014) Reconstructing lineage hierarchies of the
distal lung epithelium using single-cell RNA-seq. Nature, 509,
371—375.

Tu,Q. et al. (2012) Gene structure in the sea urchin Strongylocentrotus
purpuratus based on transcriptome analysis. Genome Res., 22,
2079—2020.

112 /§JO'S{eumo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 popeorumoq

9IOZ ‘09 lsnﬁnv uo ::

