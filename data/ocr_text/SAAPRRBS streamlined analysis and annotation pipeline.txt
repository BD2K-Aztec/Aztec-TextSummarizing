  Vol. 28 no. 16 2012, pages 2180—2181

doi: 10. 1093/bioinformatics/bts33 7

 

Sequence analysis

Advance Access publication June 10, 2012

SAAP-RRBS: streamlined analysis and annotation pipeline for
reduced representation bisulfite sequencing

Zhifu Suni, Saurabh Bahetil, Sumit Middhal, Rahul Kahwar2, Yuji Zhahgl, Xihg Lil,
Andreas S. Beutler2, Eric Kleel, Yan W. Asmahhl, E. Aubrey Thompson3 and

Jean-Pierre A. Kocher1’*

1Division of Biomedical Statistics and Informatics, Department of Health Sciences Research, 2Department of Medical
Oncology, Mayo Clinic College of Medicine, Rochester, MN 55905, USA and 3Department of Cancer Biology, Mayo
Clinic Comprehensive Cancer Center, Jacksonville, FL 32224, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Summary: Reduced representation bisulfite sequencing (RRBS)
is a cost-effective approach for genome-wide methylation pattern
profiling. Analyzing RRBS sequencing data is challenging and
specialized alignment/mapping programs are needed. Although
such programs have been developed, a comprehensive solution
that provides researchers with good quality and analyzable data
is still lacking. To address this need, we have developed a
Streamlined Analysis and Annotation Pipeline for RRBS data (SAAP-
RRBS) that integrates read quality assessment/clean-up, alignment,
methylation data extraction, annotation, reporting and visualization.
This package facilitates a rapid transition from sequencing reads to
a fully annotated CpG methylation report to biological interpretation.
Availability and implementation: SAAP-RRBS is freely available to
non-commercial users at the web site http://ndc.mayo.edu/mayo/
research/biostat/stand-alone—packages.cfm.

Contact: baheti.saurabh@mayo.edu or sun.zhifu@mayo.edu
Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on February 26, 2012; revised on May 27, 2012; accepted
on June 6, 2012

1 INTRODUCTION

DNA methylation is one of the major epigenetic control mechanisms
for gene regulation, cellular differentiation, embryogenesis, X
chromosome inactivation, genomic imprinting and tumorigenesis
(Laird, 2003). Reduced representation bisulﬁte sequencing (RRBS)
has been demonstrated to be a cost-effective approach to
analyze DNA methylation pattern in CpG dense regions of the
genome (Bock et al., 2010; Harris et al., 2010; Wang et al.,
2012). RRBS data analysis is challenging due to the bisulﬁte-
mediated C to T conversion. Several speciﬁc RRBS sequence
read alignment programs have been developed, which include
BSMAP/RRBSMAP (Xi and Li, 2009; Xi et al., 2012), BISMARK
(Krueger and Andrews, 2011), BSSEEKER (Chen et al., 2010) and
Illumina’s bisulﬁte sequencing software (http://www.illumina.com/
applications/epigenetics.ilmn). Each aligner uses a different strategy
for bisulﬁte-converted read mapping. BISMARK and BSSEEKER

 

*To whom correspondence should be addressed.

convert reference genome (C to T for + and G to A for — strand)
and reads (C to T) for alignment. Illumina’s pipeline does not align
to the whole genome; rather, digitally digested MspI fragments
are generated as multi-fasta ﬁles, which then undergo C/T and
G/A conversion. BSMAP/RRBSMAP does not need the reference
genome preparation step but everything is handled internally using
bitwise masking. In addition to alignment, other steps are equally
important to get high-quality and analyzable data for downstream
analyses. The MspI digestion, bisulﬁte treatment and subsequent size
selection tend to generate a higher portion of low-quality or adapter-
contaminated reads; accurate extraction of CpG methylation status
from alignment is not implemented in alignment programs or with
limited function and more importantly, CpG methylation is highly
context speciﬁc in the genome and it would be impossible to interpret
the data without annotation. Herein, we present a comprehensive
workﬁow that combines all these steps into a single application
that can be run on a high-performance computing cluster or on an
individual workstation. The workﬁow accommodates aligned BAM
ﬁles from different aligners or conduct annotation alone. Moreover,
the workﬁow can be easily extended to analyze whole genome
bisulﬁte sequencing.

2 METHODS

2.1 Architecture and implementation

The SAAP-RRBS consists of four main modules: (1) sequence read
assessment and clean-up; (2) alignment to reference genome; (3) methylation
status extraction and (4) CpG reporting and annotation (Supplementary
Fig. 81). These modules use a suite of public and in-house developed tools
using Perl, Python, Java and C.

2.2 Sequence read quality assessment and trimming

SAAP-RRBS ﬁrst removes low-quality bases and adapter sequences from
either end of a read (Martin, 2011). Resulting reads that are shorter than a
speciﬁed length are discarded to reduce non-unique mapping. The FastQC
tool is incorporated to report summarized metrics on the quality of the reads.

2.3 Alignment to reference genome

BSMAP version 2.43 is integrated into the pipeline as the default aligner. For
RRBS, -D C-CGG option is turned on for RRB SMAP alignment mode. Note
that RRB SMAP was integrated into BSMAP since version 2.0. Early versions
of BSMAP are very slow although alignment accuracy is comparable to

 

© The Author(s) 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/ by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [3.10'8112(1an[plOJXO'SODBIIIJOJIIlOlQ/[Z(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV uo ::

SAAP-RRBS

 

other tools (Chatterjee et al., 2012; Chen et al., 2010; Krueger et al., 2012).
The introduction of RRBSMAP has signiﬁcantly increased performance
as the program restricts alignment to genomic locations with MspI cut
sites (CCGG) (Xi et al., 2012). We have compared RRBSMAP with three
other alignment programs using simulated and real data, and the results are
presented in Supplementary Tables S1 and S2 and Figure S2. RRBSMAP
shows the highest mapping rate and accuracy, with the similar speed as
BSSEEKER. The estimated methylation ratio from RRBSMAP is highly
correlated with that from other aligners (R2 >099). In addition, RRBSMAP
does not need to prepare reference genome and can be used with both single-
and pair-end sequencing data.

2.4 Methylation status extraction

The BAM ﬁle is parsed to extract methylation status of C in CpG context.
For reads mapped to the forward strand, the total numbers of C and T at the
C position of a CpG in the reference are counted and a methylation ratio
at that position is calculated by dividing the total number of C by the total
number of C plus T (Cs/(Cs + Ts)). For reads mapped to the reverse strand,
the numbers of G and A at the G position (complementary C at the reverse
strand) of the CpG are counted to obtain the complementary methylation
ratio (Gs/(Gs + As)).

2.5 CpG annotation

The annotation module provides each CpG with rich genomic contextual
information, including whether it is in exons, within a gene, in a CpG
island and distance to transcription start site (TSS). The annotation module
also searches the dbSNP database and marks the C position with known
single nucleotide polymorphism (SNP) and alternative allele. To speed up
the process, annotations for all Cst in the genome are pre-computed in the
initial setup.

2.6 Final report and data visualization

The pipeline generates two main reports for end users: (1) a summary report
for all samples in a run, including QC metrics, summary statistics for each
sample and links to more detailed reports and (2) a methylation data report
with annotations for each sample. This report contains methylation data for
Cst with coverage 2 10x and base quality score 220. Each reported CpG
site is dynamically linked to a local instance of the Integrative Genomics
Viewer (IGV) for read- and base-level data visualization.

3 RESULTS AND CONCLUSIONS

3.1 Performance and benchmark measurements

SAAP—RRBS is most suitable for a cluster environment where
multiple samples can be run in parallel. It takes ~4—6 h to complete
the pipeline for a sample (MCF7 breast cancer cell line) with
~50 millions of reads in a Linux platform with CPU at 2.67 GHz,
8 cores and >100 GB RAM. The resulting methylation ratio is
highly correlated with the results from BISMARK, BSSEEKER
and the Illumina pipeline (R2 >0.99) as well as from Illumina
methylation27k microarray (R2 >0.9; Supplementary Fig. S2).
Some well-known methylation patterns in the cell line are also
observed from the data such as promoter hypermethylation of WT] ,
HOXA5, IRXI and PAX7 (Supplementary Fig. S3).

3.2 Summary report

The summary report contains a link to the FastQC report and
summary statistics such as total reads passing ﬁlters, mapped reads,
mapping rate, bisulﬁte conversion rate, captured Cs in CpG context,

Cs with strand-speciﬁc coverage 3 10x and base quality 220 and
Cst that overlap with dbSNP, Cst within CpG islands and Cst
with genes (Supplementary Fig. S4).

3.3 Annotated report

The ﬁnal report contains strand-speciﬁc CpG methylation and
detailed annotations for each C position. The number of methylated
Cs, total number of Cs and methylation ratio are reported, along
with information of the CpG relative to genomic features such as
nearby gene, distance to TSS, overlapping SNP, alternative allele
and a CpG island. In the report, users can click a hyperlink for a
CpG site to open IGV and view the aligned reads and base level
information (Supplementary Fig. SS).

RRBS has become a popular and efﬁcient way to proﬁle genome-
wide methylation patterns for novel discoveries in biomedical
research. However, the high-throughput and complex data need a
fast and convenient bioinforrnatics tool to process the data into
interpretable formats. We have developed a comprehensive pipeline
that integrates necessary analyses into a single package. The pipeline
is modular, which allows users to use their own alignment tool. Users
can also provide pre—computed methylation data with chromosome
coordinates and run the workﬁow in an annotation-only module. The
pipeline is highly automated and can be run in a single machine or
within a cluster environment where many samples can be processed
in parallel for increased performance.

ACKNOWLEDGEMENT

We are very grateful to Dr Yuanxin Xi at Baylor College of Medicine
for his assistance to BSMAP/RRBSMAP.

Funding: Center for Individualized Medicine at Mayo Clinic
Rochester, MN, and the 26.2 with Donna Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Bock,C. et al. (2010) Quantitative comparison of genome-wide DNA methylation
mapping technologies. Nat. Biotechnol., 28, 1106—1114.

Chatterjee,A. et al. (2012) Comparison of alignment software for genome-wide
bisulphite sequence data. Nucleic acids Res.

Chen,P.Y. et al. (2010) BS Seeker: precise mapping for bisulﬁte sequencing. BMC
Bioinformatics, 11, 203.

Harris,R.A. et al. (2010) Comparison of sequencing-based methods to proﬁle DNA
methylation and identiﬁcation of monoallelic epigenetic modiﬁcations. Nat.
Biotechnol., 28, 1097—1105.

Krueger,F. and Andrews,S.R. (2011) Bismark: a ﬂexible aligner and methylation caller
for Bisulﬁte-Seq applications. Bioinformatics, 27, 1571—1572.

Krueger,F. et al. (2012) DNA methylome analysis using short bisulﬁte sequencing data.
Nat. Methods, 9, 145—151.

Laird,P.W. (2003) The power and the promise of DNA methylation markers. Nat. Rev.
Cancer, 3, 253—266.

Martin,M. (2011) Cutadapt removes adapter sequences from high-throughput
sequencing reads. EMBnet J., 17, 3.

Wang,L. et al. (2012) Systematic assessment of reduced representation bisulﬁte
sequencing to human blood samples: a promising method for large-sample-scale
epigenomic studies. J. Biotechnol., 157, 1—6.

Xi,Y. and Li,W. (2009) BSMAP: whole genome bisulﬁte sequence MAPping program.
BMC Bioinformatics, 10, 232.

Xi,Y. et al. (2012) RRBSMAP: a fast, accurate and user-friendly alignment tool for
reduced representation bisulﬁte sequencing. Bioinformatics, 28, 430—432.

 

2181

112 [3.10'8112(1an[plOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ pepeolumoq

9IOZ ‘09 lsnﬁnV uo ::

