APPLICA TIONS NOTE V°"313.1%.139%‘32735322133221332

 

Gene expression

Advance Access publication January 21, 2014

CAFE: an R package for the detection of gross chromosomal
abnormalities from gene expression microarray data
Sander Bollen1’2’*, Mathias Leddin3, Miguel A. Andrade-Navarro1 and Nancy Mah”

1Computational Biology and Data Mining Group, Max Delbruck Center for Molecular Medicine, 18125 Berlin, Germany,
2Graduate School of Life Sciences, Utrecht University, Universiteitsweg 98, 8584 CG, Utrecht, the Netherlands and

8Roche Diagnostics GmbH, 82877 Penzberg, Germany

Associate Editor: Janet Kelso

 

ABSTRACT

Summary: The current methods available to detect chromosomal
abnormalities from DNA microarray expression data are cumbersome
and inflexible. CAFE has been developed to alleviate these issues. It is
implemented as an R package that analyzes Affymetrix *.CEL files and
comes with flexible plotting functions, easing visualization of chromo-
somal abnormalities.

Availability and implementation: CAFE is available from https://bit
bucket.org/cob87icW6z/cafe/ as both source and compiled packages
for Linux and Windows. It is released under the GPL version 3 license.
CAFE will also be freely available from Bioconductor.

Contact: sander.h.bollen@gmail.com or nancy.mah@mdc-berlin.de
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 8, 2013; revised on January 10, 2014; accepted
on January 14, 2014

1 INTRODUCTION

Gross chromosomal abnormalities are a hallmark of cancers
(Hanahan and Weinberg, 2011) and are frequently acquired by
cultured cells as an adaptation to cell culture conditions (Baker
et al., 2007). Recently, it has been recognized that induced pluri-
potent stem cells often feature gross chromosomal duplications
or deletions (Laurent et al., 2011).

Various methods exist to detect chromosomal gains or losses.
Traditional karyotyping relies on careful examination of
Giemsa—stained metaphase chromosomes. Newer techniques
like spectral karyotyping have increased ease of analysis but
nevertheless feature low resolution. For high-throughput and
high resolution analysis of gross chromosomal abnormalities,
array-based Comparative Genomic Hybridization (a-CGH) is
often used. This a-CGH approach is based on the detection of
a quantitative difference of DNA content. Whole-genome and
SNP-based sequencing approaches have also been developed.

Although not initially developed for this purpose, it is possible
to use gene expression microarray data for the detection of copy
number abnormalities. This approach is not based on the meas-
urements of DNA content but rather on mRNA expression
levels. A protocol to use expression microarrays to ‘karyotype’
samples was recently published by Benvenisty and coworkers but

 

*To whom correspondence should be addressed.

requires the manual use of different tools (Ben-David et al.,
2013).

Here, we present CAFE—Chromosomal Aberration Finder in
Expression data—as an R package for the detection of gross
chromosomal gains and losses from expression microarrays,
with a resolution up to cytoband level. CAFE follows the expres-
sion-based karyotyping workﬁow (e-karyotyping) and greatly
simpliﬁes and speeds up the detection analysis of chromosomal
aberrations from expression DNA microarrays.

2 FEATURES AND METHODS

The starting point of a CAFE analysis is a set of gene expression micro-
arrays from samples whose e—karyotype will be computed and another
(larger) set of microarrays representing controls. The controls deﬁne a
normal e—karyotype against which the altered e-karyotype will be deﬁned.
We recommend choosing a dataset of at least 10 controls for 2—3 test
samples. More controls may be required depending on the particular
case. CAFE is implemented as an R package and relies on several
Bioconductor packages. It runs on version 2.10 or newer of R. The ana-
lyses are performed using Affymetrix *.CEL ﬁles as input. Using the
ProcessCels () function, a list object is created from these *.CEL
ﬁles and returned to the user. This object contains normalized and relative
expression levels, along with several mappings of probesets to chromo-
somes, chromosomal arms, cytobands and chromosomal locations. The
output can be further ﬁltered so as to exclude multiple probesets that map
to the same gene or to the same location. CAFE can then be used to
perform several enrichment tests for the detection of duplications or dele-
tions of chromosomes, chromosomal arms and cytobands. Furthermore,
several plot functions are available to visualize any detected aberrations.

2.1 Enrichment testing

CAFE contains three statistical functions that determine enrichment or
depletion of a given chromosome/chromosomal region. One function
exists for each of the three resolutions: chromosomeStats ( ) ,
armStats ( ) and bands tats ( ) , corresponding to chromosomes,
arms and cytobands, respectively. The ability of CAFE to detect aberra-
tions within chromosome, arm or cytoband is dependent on the density of
the microarray probesets within these areas. Areas that are gene-poor are
not likely to be detected, as expression microarrays are designed to detect
transcribed genes. The user deﬁnes two thresholds as a ratio of median
expression values, ‘over’ and “under”, for which probesets are called over-
and under-expressed. The threshold for genomic DNA hybridized onto a
comparative genomic hybridization array would be :l:log2(2) ratio to
detect a chromosome gain or loss, respectively. Because CAFE uses
mRNA expression as a surrogate for DNA copy number and because
the levels of mRNA expression are variable and do not strictly reﬂect

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

112 /310's113u1no [pJOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘09 lsnﬁnv uo ::

Detection of gross chromosomal abnormalities

 

A IIIIIII I-II-III B IIIIIII III-III

H.25- —

D F‘

b- M
.7

J'

H.

um'

43.25

Log! relative enpressmn
1':- n':
2:- lo

Logz I'Elitl'U'E' anprassmn

43.50

Chromosome 11[Mh} “'0 n Chromosome 11le}

151]

Fig. 1. Samples GSM652238 (orange) and GSM652239 (blue) from GEO
dataset GSE26526 were plotted. GSM652238 is known to have a deletion
in Chromosome llq. (A) The output of slidPlot ( ) . (B) The output of
discontPlot()

DNA copy number, a less restrictive default threshold is recommended as
a starting point for analysis: :l:log2(l.5) ratio. Using these thresholds,
enrichment of under- and over-expressed probes in chromosomes or
chromosomal regions is computed using a Fisher’s exact test or a x2
test. P—values are Bonferroni-corrected by default.

2.2 Graphics

For graphics, CAFE uses the ggplot2 plotting system (Wickham, 2009).
There are four different plotting functions available: (i) rawPlot ( ) : the
‘raw’ log-transformed relative expression values are plotted along the
chromosome of interest; (ii) slidPlot ( ): a moving average smoother
is applied to the log-transformed relative expression values before plotting
the values along the chromosome of interest; (iii) discontPlot ( ): a
discontinuous smoother is applied to the log-transformed relative expres-
sion values and the values are plotted along the chromosome of interest;
(iv) facetPlot ( ): all chromosomes are plotted in one horizontally
aligned graph, with relative expression values along each chromosome.
This function can be used in conjunction with a moving average smoother.

For all plot functions except facetPlot (), it is possible to add a
chromosome idiogram over the chromosome plot. This allows easy visu-
alization of chromosomal abnormalities. See Figure l for example plots.
All plots are printed to the ﬁle system and returned as ggplot2 objects.
Plot parameters, such as labels and scales, can be modiﬁed to the user’s
liking by altering the ggplot2 object.

2.3 Comparison with other tools

To the best of our knowledge, there are currently no other Bioconductor
packages that are designed to identify chromosomal copy number
abnormalities from mRNA expression microarray data. However, there
are other packages that perform similar functions, such as processing
comparative genomic hybridization arrays (aCGH, snapCGH) or iden-
tifying differentially regulated regions on a chromosome from expression
microarrays (MACAT). The initial choice of datasets for analysis is crit-
ical and must be completed by hand, regardless of the package used. Once
this is done, CAFE is able to normalize and preprocess the *.CEL ﬁles in
one step. Although aCGH and snapCGH were designed to analyze CGH
arrays, one can use CAFE to preprocess the *.CEL ﬁles and then subse-
quently reformat the preprocessed data for input into these packages.
Both aCGH and snapCGH use hidden Markov models to predict state
changes (i.e. changes in chromosomal copy number). Plotting functions
then show the course of state changes over the chromosome. MACAT
uses a modiﬁed t-statistic and permutation to score regions of the
chromosome that are differentially regulated. The scores for a selected
chromosome are shown as a static html page. To compare the perform-
ance, CAFE and the other three packages were used to analyze two test
datasets with known chromosomal aberrations (see Supplementary
Data). CAFE was able to detect copy number abnormalities just as
well as or better than the other packages.

3 DISCUSSION

Karyotyping by expression microarrays, as described by Ben-
David et al. (2013), extends the utility of expression microarray
data by providing some limited information on the status of
chromosomal aberrations in a sample. However, the original
e-karyotyping method is a tedious process, using four different
programs and requiring an estimated 15 h to analyze only 15
samples. At the time of writing, there are no Bioconductor pack-
ages to speciﬁcally carry out e-karyotyping from raw microarray
data. The CAFE package simpliﬁes the e-karyotyping protocol.
Starting from the *.CEL ﬁles, CAFE can do the same analysis in
minutes and requires no more than basic R knowledge.
Bioconductor packages for CGH analysis can be used to perform
an e-karyotyping analysis, but the data preprocessing steps
must be carried out manually and the resulting graphs are
static and not user-conﬁgurable. In contrast, CAFE processes
the expression data from *.CEL ﬁles and all plotting functions
return a ggplot2 object that can be modiﬁed by the end-user to
his or her speciﬁc needs. CAFE will become a Bioconductor
package, to be freely available for anyone to use, distribute,
modify and easily integrate into an R-workﬁow for automatic
analysis.

Currently, only Affymetrix *.CEL ﬁles from 3’IVT arrays can
be seamlessly preprocessed in CAFE; functions for processing
raw microarray data from other platforms may be added in
the future if there is demand for this feature. Data import
from other platforms is still possible, as CAFE data are
represented by a simple R list structure. CAFE analysis currently
works with three different resolutions: whole chromosome,
chromosomal arm and cytoband. Therefore, it is not suited
for smaller deletions or duplications. In addition, it is not
readily possible to detect insertions or translocations using
this technique, as the probesets will be mapped to the ori-
ginal chromosome or location. Therefore, CAFE is most suited
for the detection of numerical abnormalities, rather than
structural abnormalities. CAFE has not been designed to
replace existing karyotyping techniques but rather to gain infor-
mation when data from more speciﬁc approaches is not yet
available.

Funding: German Research Foundation Priority Programme
1463 (Project No. AN 735/2—1) (to N.M.).

Conﬂict of Interest: none declared.

REFERENCES

Baker,D.E. et al. (2007) Adaptation to culture of human embryonic stem cells and
oncogenesis in viva. Nat. Biotechnol., 25, 207—215.

Ben-David,U. et al. (2013) Virtual karyotyping of pluripotent stem cells on the basis
of their global gene expression proﬁles. Nat. Protoc., 8, 989—997.

Hanahan,D. and Weinberg,R.A. (2011) Hallmarks of cancer: the next generation.
Cell, 144, 646—674.

Laurent,L.C. et al. (2011) Dynamic changes in the copy number of pluripotency and
cell proliferation genes in human ESCs and iPSCs during reprogramming and
time in culture. Cell Stem Cell, 8, 106—118.

Wickham,H. (2009) ggplot2: Elegant Graphics for Data Analysis. Springer Science +
Business Media, New York, USA.

 

112 /310's113u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘09 lsnﬁnv uo ::

