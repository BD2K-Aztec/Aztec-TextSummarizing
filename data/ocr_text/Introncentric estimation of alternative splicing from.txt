APPLICATIONS NOTE V31;[iiiﬂ‘égi/iiéiiﬁiiici/Zii32‘

 

Gene expression

Advance Access publication November 21, 2012

lntron-centric estimation of alternative splicing from

RNA-seq data

Dmitri D. Pervouchine1’2’3’*

, David G. Knowles1 ’2 and Roderic GUigé1’2

1Centre de Regulacio Genbmica (ORG) and 2Universitat Pompeu Fabra (UPF), 08003 Barcelona, Spain and

3Moscow State University, 119992 Moscow, Russia
Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: Novel technologies brought in unprecedented amounts of
high-throughput sequencing data along with great challenges in their
analysis and interpretation. The percent-spliced-in (PSI, III) metric es-
timates the incidence of single-exon—skipping events and can be com-
puted directly by counting reads that align to known or predicted
splice junctions. However, the majority of human splicing events are
more complex than single-exon skipping.

Results: In this short report, we present a framework that generalizes
the \11 metric to arbitrary classes of splicing events. We change the
view from exon centric to intron centric and split the value of \11 into
two indices, (05 and (03, measuring the rate of splicing at the 5’ and 3’
end of the intron, respectively. The advantage of having two separate
indices is that they deconvolute two distinct elementary acts of the
splicing reaction. The completeness of splicing index is decomposed
in a similar way. This framework is implemented as bam2ssj, a
BAM-file—processing pipeline for strand-speciﬁc counting of reads
that align to splice junctions or overlap with splice sites. It can be
used as a consistent protocol for quantifying splice junctions from
RNA-seq data because no such standard procedure currently exists.
Availability: The C++ code of bam2ssj is open source and is avail-
able at https://github.com/pervouchine/bam2ssj

Contact: dp@crg.eu

Received on August 23, 2012; revised on October 29, 2012; accepted
on November 15, 2012

1 INTRODUCTION

One major challenge in the analysis of high-throughput RNA
sequencing data is to disentangle relative abundances of alterna-
tively spliced transcripts. Many existing quantiﬁcation methods
do so by using considerations of likelihood, parsimony and
optimality to obtain a consolidated View of cDNA fragments
that map to a given transcriptional unit (Katz et al., 2010;
Montgomery et al., 2010; Trapnell et al., 2012). The advantage
of such integrative approaches is that they provide robust esti-
mators for transcript abundance by reducing sampling errors, as
they effectively consider samples of larger size. In contrast, be-
cause all the reads from the same transcriptional unit are com-
bined into one master model, there is no guarantee that the
inclusion or exclusion of a speciﬁc exon is estimated independ-
ently of co-occurring splicing events (Katz et al., 2010; Pan et al.,
2008).

 

*To whom correspondence should be addressed.

The quantiﬁcation of alternatively spliced isoforms based on
the \11 metric captures more accurately the local information
related to splicing of each particular exon (Katz et al., 2010).
We follow Kakaradov et al. (2012) in considering only the
reads that align to splice junctions (Fig. 1) and ignoring the
reads that align to exon bodies (position-speciﬁc read counts
are not considered). \11 is deﬁned as

a + b

q] _ a + b + 2c (1)
where the factor of two in the denominator accounts for the fact
that there are twice as many mappable positions for reads sup-
porting exon inclusion as exon exclusion. Equation (1) deﬁnes an
unbiased estimator for the fraction of mRNAs that represent the
inclusion isoform under the assumption that splice-junction
reads are distributed evenly. \II can also be derived from the ex-
pression values of whole isoforms, for instance, as the abundance
of the inclusion isoform as the fraction of the total abundance.
However, the non-uniform read coverage not only between but
also within transcripts makes such estimates generally detrimen-
tal (Kakaradov et al., 2012).

The \11 metric can be generalized beyond the class of single-
exon—skipping events by counting inclusion and exclusion reads
regardless of exon adjacency (Fig. 1, dashed arcs). Although this
deﬁnition helps to reduce the undercoverage bias by taking into
account splice junctions that are not present in the reference an-
notation, it often assigns misleading values to \11 metric, for in-
stance, in the case of multiple-exon skipping, where the amount
of support for exon exclusion does not reﬂect the true splicing
rate of each individual intron.

2 APPROACH

In this work, we change the View from exon centric to intron
centric. Each intron is deﬁned uniquely by the combination of its
5’-splice site (D, donor) and 3’-splice site (A, acceptor). Denote
by n(D, A) the number of reads aligning to the splice junction
spanning from D to A (Fig. 2) and deﬁne

11(D,  11(D9 

§H(D,A,) and W3(Da a

WAD, A) = (2)

where D’ and A’ run over all donor and acceptor sites, respect-
ively, within the given genomic annotation set. Because A’ could
be A and D’ could be D, both w5(D, A) and w3(D, A) are real
numbers from 0 to 1. The value of (05 (D, A) can be regarded as

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/Iicenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /810's112umo[pJOJXO'sot1chOJutotw/2d11q wort papeolumoq

910K ‘09 lsnﬁnV no :2

D.D.Pervouchine et al.

 

/’ \ / \

/ \
_/ _/d\_ —/[_)\— ‘—

\\\\ V ””

Fig. 1. The percent-spliced-in (PSI, lI!) metric is deﬁned as the number of
reads supporting exon inclusion (a + b) as the fraction of the combined
number of reads supporting inclusion and exclusion (c). The exon of
interest is shown in gray. Only reads that span to the adjacent exons
(solid arcs) account for Equation (1)

an estimator for the conditional probability of splicing from D to
A, i.e. the fraction of transcripts in which the intron D to A is
spliced, relative to the number of transcripts in which D is used
as a splice site. Similarly, w3(D, A) is the relative frequency of
D-to-A splicing with respect to the splicing events in which
A is used.

In the particular case of single-exon skipping (Fig. 1),
the values of \II, (05 and (03 are related as follows. Denote
the upstream and downstream introns of the highlighted
exon by (D1,A1) and (D2,A2), respectively. Let

W5 = W5(D1,A1) and W3 = W3(D2,A2)- Then, W5 = #0,

(b3 2 bi“ and \II = a)st +w3tb3, where 005 = #1020 and
003 = %. Assuming uniform read coverage across the gene
(a 2 b), we get cos 2 003 2 % and, therefore,

That is, in the particular case of single-exon skipping, the value
of \II is equal to the average of (05 and $3 given that the read
coverage is reasonably uniform. If a and b differ signiﬁcantly, the
contribution of (05 and (03 to \II is given by the weight factors 005
and 003.

Similarly, the completeness of splicing index (Tilgner et al.,
2012) is split into two indices, 95 (D) and 93 (A), where

Z n(D, A’) Z n(D’, A)
95 = A’— , 93 = D— a 

Z n(D, A’) + n(D) Z n(D’, A) + n(A)

A’ D’
and n(X) denotes the number of genomic reads (reads mapped
uniquely to the genomic sequence) overlapping the splice site X.
Note that 95 depends only on D and 93 depends only on A. The
values of 95 and 93 are unbiased estimators for the absolute fre-
quency of splice site usage, i.e. the proportion of transcripts in
which D (or A) is used as a splice site, among all transcripts
containing the splice site D (or A).

3 METHODS

To compute (05, (03, 05 and 03 for a given donor—acceptor pair, one needs
to know ﬁve integers, n(D, A), Z n(D, A’), Z n(D’, A), n(D) and n(A), of
which only the ﬁrst one depends on both D and A, while the rest have a
single argument. We developed bamZSSj , a pipeline for counting these
ﬁve integers directly from BAM input. bamZSSj is implemented in C++
and depends on SAMtools (Li et al., 2009). The input consists of (i) a
sorted BAM ﬁle containing reads that align uniquely to the genome or to
splice junctions and (ii) a sorted GTF ﬁle containing the coordinates of
exon boundaries. Each time the CIGAR string (Li et al., 2009) contains

A \_ ‘~__” _/’ _/\_
|:l—|:|—|:| |:|—|:|—|:|
D A A’ D’ D A

Fig. 2. Left: the 5’ -splicing index, (05, is the number of reads supporting
the splicing event from D to A relative to the combined number of reads
supporting splicing from D to any acceptor site A’. Right: the 3’-splicing
index, (03, is the number of reads supporting the splicing event from D to
A relative to the combined number of reads supporting splicing from any
donor site D’ to A. The intron of interest is drawn thick

xMyNZM, x,z Z 1, the counter corresponding to the splice junction
deﬁned by yN is incremented. One mapped read may span several
splice junctions and increment several counters. If the CIGAR string
does not contain the xMyNzM pattern, the read is classiﬁed as genomic
and increments n(X) for every splice site X it overlaps. Position-speciﬁc
counts (Kakaradov et al., 2012) are implemented as a stand-alone utility
that is not included in the current distribution. Importantly, bamZSsj
counts reads that align to splice junctions in a strand-speciﬁc way,
i.e. n(D, A), Zn(D, A’), Zn(D’,A), n(D) and n(A) are reported for the
correct (annotated) and incorrect (opposite to annotated) strand. We
leave further processing of these counts by Equations (2)—(4) to the user.

4 RESULTS AND DISCUSSION

We validated bam2 ssj by counting reads aligning to splice junc-
tions in the whole-cell polyadenylated fraction of Cold Spring
Harbor Long RNA-seq data (http://genome.ucsc.edu/
ENCODE/). In total, 8 558 231 343 mapped reads were analyzed
in 404 min (2350 000 reads/sec). 1 184 553 724 reads align to
splice junctions, of which 21% align to the opposite strand.
1 699 718 327 reads overlap annotated splice junctions, of which
25% map to the opposite strand. The values of n(D, A) coincide
with those reported by ENCODE in 98.9% of cases
(1 163 251 008 reads); all discrepancies were due to the ambiguity
of CIGAR translation in the mapper’s output. Because RNA-seq
data are increasingly processed into the compact BAM form, we
propose that bam2 ss j be used as a standard operating proced-
ure for counting splice junction reads.

Funding: Grants BIO2011-26205 and CSD2007-00050
Consolider, Ministerio de Educacién y Ciencia (Spain).

Conﬂict of Interest: none declared.

REFERENCES

Kakaradov,B. et al. (2012) Challenges in estimating percent inclusion of alterna-
tively spliced junctions from RNA-seq data. BM C Bioinformatics, 13 (Suppl. 6),
S11.

Katz,Y. et al. (2010) Analysis and design of RNA sequencing experiments for iden-
tifying isoform regulation. Nat. Methods, 7, 1009—1015.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Montgomery,S. et al. (2010) Transcriptome genetics using second generation
sequencing in a Caucasian population. Nature, 464, 773—777.

Pan,Q. et al. (2008) Deep surveying of alternative splicing complexity in the human
transcriptome by high-throughput sequencing. Nat. Genet, 40, 1413—1415.
Tilgner,H. et al. (2012) Deep sequencing of subcellular RNA fractions shows spli-
cing to be predominantly co-transcriptional in the human genome but inefﬁcient

for lncRNAs. Genome Res., 22, 1616—1625.

Trapnell,C. et al. (2012) Differential gene and transcript expression analysis of

RNA-seq experiments with TopHat and Cufﬂinks. Nat. Protoc., 7, 562—578.

 

274

112 /810's112umo[pJOJXO'sottnmJOJutotw/zd11q moxj papeolumoq

910K ‘09 lsnﬁnV uo :2

