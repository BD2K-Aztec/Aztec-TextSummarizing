ORIGINAL PAPER

Vol. 26 no. 12 2010, pages 1535-1541
doi: 10. 1093/bioinformatics/btq 165

 

Systems biology

Advance Access publication on May 3, 2010

Deuteration distribution estimation with improved sequence

coverage for HX/MS experiments

Xinghua Lou‘, Marc Kirchner1’2’3’l, Bernhard Y. Renardm’l, Ullrich K the‘,
Sebastian Boppel‘, Christian Graf4, Chung-Tien Lee4, Judith A. J. Steen2’5,
Hanno Steen2’3, Matthias P. Mayer4 and Fred A. Hamprecht1’2’*

1Interdisciplinary Center for Scientific Computing, University of Heidelberg, Heidelberg, Germany, 2Proteomics Center
at Children’s Hospital Boston, 3Department of Pathology, Harvard Medical School, Boston, Massachusetts, USA,
4Zentrum f r Molekulare Biologie der Universit t Heidelberg (ZMBH), DKFZ—ZMBH Alliance, Heidelberg, Germany
and 5Department of Neurobiology, Harvard Medical School, Boston, Massachusetts, USA

Associate Editor: John Quackenbush

 

ABSTRACT

Motivation: Time-resolved hydrogen exchange (HX) followed by
mass spectrometry (MS) is a key technology for studying protein
structure, dynamics and interactions. HX experiments deliver a time-
dependent distribution of deuteration levels of peptide sequences
of the protein of interest. The robust and complete estimation of this
distribution for as many peptide fragments as possible is instrumental
to understanding dynamic protein-level HX behavior. Currently, this
data interpretation step still is a bottleneck in the overall HX/MS
workflow.

Results: We propose HeXicon, a novel algorithmic workflow for
automatic deuteration distribution estimation at increased sequence
coverage. Based on an Ll-regularized feature extraction routine,
HeXicon extracts the full deuteration distribution, which allows insight
into possible bimodal exchange behavior of proteins, rather than just
an average deuteration for each time point. Further, it is capable
of addressing ill-posed estimation problems, yielding sparse and
physically reasonable results. HeXicon makes use of existing peptide
sequence information, which is augmented by an inferred list of
peptide candidates derived from a known protein sequence. In
conjunction with a supervised classification procedure that balances
sensitivity and specificity, HeXicon can deliver results with increased
sequence coverage.

Availability: The entire HeXicon workflow has been implemented
in C++ and includes a graphical user interface. It is available at
http://hci.iwr.uni-heidelberg.de/software.php.

Contact: fred.hamprecht@iwr.uni-heidelberg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 25, 2009; revised on April 1, 2010; accepted
on April 9, 2010

1 INTRODUCTION

The determination of protein structure and dynamics is a key
issue for the understanding of living systems (Dobson, 2003).

 

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the second and third
authors should be regarded as joint First authors.

 

 

 

 

 

I?
7' = 30
I I I ALLA I‘M-AALA
556 557 558 559 560 561 562 563 564
7’ = 300

A.n A kak[\j\jxj\j\j\j\/V\/\ﬂd\ﬂd\AJ\AukA_Judk

556 557 558 559 560 561 562 563 564

7' = 3600

AAALAMW/NWAAAh. AM AMAAA

556 557 558 559 560 561 562 563 564
>m<1z

 

 

 

 

 

 

 

Fig. 1. Examples of HX/MS spectrum data from an incubation time series of
0, 30, 300 and 3600 s: the isotope envelope shifts to higher m/z values because
of deuterium incorporation. The deuteration content is encoded in a complex
mixture of isotope distributions. Due to the noise and overlapping isotope
clusters, the separation of individual peptides is non—trivial. The abundance
of the spectrum is labeled as y.

By combining the information of the protein dynamics and other
classical functional data, a more complete understanding of protein
function can be obtained. In many cases, protein dynamics are
directly related to speciﬁc protein functions such as conformational
changes during enzyme activation and protein movements during
binding (Wales and Engen, 2006). Hydrogen exchange (HX)
followed by mass spectrometry (MS) (HX/MS) has become a
standard approach for interpreting HX experiments: the location
and rate of deuteration are indicative of solvent accessibility
and in particular hydrogen bonding and hence of conformation
and dynamics (Englander, 2006). They can be estimated by
tracking the mass shift of peptide fragments in mass spectra over
samples with different incubation times (Fig. 1) (Engen, 2009). In
comparison to nuclear magnetic resonance (NMR) spectroscopy,
MS requires lower protein concentrations and amounts, provides
higher measurement speed and better scalability in terms of protein
size, and detects coexisting conformations (Hoofnagle et al., 2003).
Whereas manifold improvements in experimental methodology and
instrumentation have been implemented for HX/MS experiments,

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1535

112 /§.IO'SIBUJHOf'pJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; popeoprmoq

9IOZ ‘Ig lsnﬁnv (10::

X.Lou et aI.

 

data processing still remains a major difﬁculty in the overall
experimental workﬂow (Engen, 2009). First, the precise deuteration
distribution is represented by complex peak patterns that are difﬁcult
to separate and quantitate even in 2D liquid chromatography/MS
(LC/MS) representation. Second, the peptide sequences of interest
have to be pre—determined via MS/MS search report or selected
empirically, yielding suboptimal sequence coverage of the protein
of interest. Finally, manual analysis is time—consuming, error—prone
as well as inaccurate in case of overlapping isotope clusters (Fig. 1).

Several methods and tools have been developed to facilitate the
manual analysis. Palmblad et al., (2001) modeled the deuterium
incorporation as a binomial distribution and used X2 statistics to
extract the optimal parameter. Weis and Engen (Weis et al., 2006)
designed HX—Express as a semi—automatic data processing tool,
which measures the deuteration by the width of the given isotope
pattern. TOF2H (Nikamanon et al., 2008) is an integrated software
framework designed speciﬁcally for semi—automatic LC—matrix—
assisted laser desorption/ionization (MALDI) data analysis.

Note that while the approaches mentioned above facilitate the
analysis of HX/MS data, they do not yield the complete deuteration
distribution, but only the average deuteration. The true deuteration
distribution offers a more detailed characterization and more
insightful description of the exchange process. In particular, it is
suitable for discovering bimodal exchange behaviors of large protein
oligomers, which are not detectable by average deuteration levels.

The algorithms developed for extracting deuteration distribution
information mainly fall into two categories. The ﬁrst set of
methods ﬁt a hypothetical deuterated isotope pattern to the observed
spectrum by least—squares regression (Abzalimov and Kaltashov,
2006; Hotchko et al., 2006; Slysz et al., 2009). They exhibit
the advantage of speed but have difﬁculties in handling ill—posed
problems, which, as shown in the following, are common in
large—scale HX/MS data analysis. It is possible to make use of
padding methods to regularize the ill—posed regression problem.
Given the optimal degree of padding, this approach can address
data truncation problems and avoid over—ﬁtting to noise (Chik
et al., 2006). The second set of methods is based on maximum
entropy deconvolution (Abzalimov and Kaltashov, 2006; Zhang
et al., 1997). Those methods can handle ill—posed problems and yield
non—negative outputs; however, they are computationally much more
expensive (Zhang et al., 1997). One common limitation of these
two categories is that they are designed for well—tuned and small—
scale problems, i.e. the peptide sequence of interest is pre—selected
in a well—separated spectrum, thus making them less applicable in
practice, especially for large—scale HX/MS data processing. These
methods have been implemented by several software tools such
as Deuterator (Pascal et al., 2007, 2009) and Hydra (Slysz et al.,
2009). Both frameworks focus on incorporating existing algorithms
and providing user—friendly graphical user interface and powerful
visualization.

We propose a novel algorithmic approach named HeXicon to the
deuteration distribution estimation problem for large—scale HX/MS
experiments. HeXicon exploits information in the retention time
and m/z domains for optimized separation of large HX/MS data
and applies Non—greedy, Iterative Template—based peak PICKer
(NITPICK) (Renard et al., 2008) for LC/MS feature extraction,
resulting in a robust and regularized estimation of the deuteration
distribution. It integrates protein sequence and protein identiﬁcation
information in an attempt to increase the sequence coverage.

Section 2 of the manuscript elaborates the methodological
development of our approach. Sections 3 describes the experimental
setup and reports the results, focusing on the novelty of delivering a
robust estimate of the deuteration distribution and the comparison to
manual analysis. Discussion and conclusion are offered in Sections
4 and 5, respectively.

2 METHODS

As illustrated in Figure 2, our approach consists of two major modules
that jointly carry out our goals of robust deuteration distribution estimation
and sequence coverage improvement. Given a hypothetical set of peptide
sequences inferred in peptide sequence set determination (A), the deuteration
distribution estimation starts by constructing an over—complete set of basis
functions (B) and then feeds them into the NITPICK algorithm to yield peak
groups with features (C). Inter—experiment peak groups are then associated
via correspondence estimation (D) and the deuteration distribution is derived
for each association (E). The subsequent quality estimation of peptide
sequence set determination retains the high—quality results, and thus balances
the sensitivity and speciﬁcity (F, G). Our approach makes extensive use of
the NITPICK algorithm, a regularized, non—greedy, globally optimal linear
mixture modeling algorithm for feature extraction from multi—component
mass spectra.

2.1 Deuteration distribution estimation

DEFINITION. Let p be a peptide sequence of interest. The deuteration level k
is the number of deuterium exchanges at the back—bone hydrogens of p. The
deuteration distribution ,o(p, k, r) is the fraction of peptide with sequence p at
deuteration level k for incubation time I, where k €{0,1,...,K(p)} and K (p)
is the maximal possible deuteration level. The average deuteration n(p, r) is
the average deuteration level of all peptides with sequence p at incubation
tlme r.

2.1.] NIT PICK algorithm We formulate the deuteration distribution
estimation as a regression problem. That is, the observed spectrum s
is explained as a linear combination of constituent basis spectra, which
represent a particular peptide. Each feasible basis spectrum is speciﬁed by
one column of the regression matrix (I), and the regression coefﬁcients ,8
determine the abundance of those constituents in the mixture. If the matrix
(1) contains more basis functions than are actually present in any given
mixture s, the regression problem is ill—posed and has to be constrained.
Tibshirani, (1996) showed that the introduction of a Ll—constraint leads to
a sparse solution vector ,8, which assigns non—zero abundance only to those
basis functions that are contained in the mixture with high probability. The
resulting regression problem is

A

r3=argmin{||s—<I>ﬁ||§+i||ﬁ||1} subject to ,830, (1)
is

which can be solved with the same computational efﬁciency as an ordinary
least squares problem by the least angle regression algorithm (Efron et al.,
2004). The regularization parameter A controls the model complexity based
on the Bayesian information criterion (BIC; Schwarz,, 1978). The NITPICK
algorithm (Renard et al., 2008) determines its value automatically so that
the number of degrees of freedom in the model is matched to the observed
noise level of s.

2.1.2 Basis function construction Assuming that the peptide sequence
set of interest P is known (see Section 2.2), the solution to the regression
problem must lie in a space spanned by all deuteration levels of all peptide
sequences in the set (Fig. 2B). Thus, we build the basis function set (I) by
combining the theoretical isotope distribution for every deuteration level of
each peptide sequence in P

$09, k) (2)

= U
VpeP,Vk€[0,K(p)]

 

1 536

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; popeoIII/noq

9IOZ ‘Ig lsnﬁnv uo ::

HeXicon

 

— — — — — — _ _ _ — — — — - _ — — — — — — — — Deuteration Distribution Estimation — — — — — _ — — — — — - - — — — — — —

and H-"J' I55-

I
|
Inn In. I
_ __ - |
|
I

II _ II.D  ...Z“

 

 

SH'U'RAEZICIACIE

DDEHURADQACIEAKHDK l

 

. |

seam:th l THRALC'I'LHMDDIIEGALADCR
|
|

I

B I

I

'1IIIII1 I

I “MM-b“— —UJ“'—' o sees s 15:13 I :

 _UJ.._ ae area a 3521 _. :j I 1 _ I

mam I “I so nose 3 -I I I :

I“: b  I _ JAIL-H. L-I—_ Mum I

| l

° " . _ . . I

 : Basis Function Peak: Grouping and Correspondence Deuteratlon DIstrIbutIon I

Spear; : Construction Feature Extraction 0 Estimation Computing E :

Data ' - - - - - - - - - - - - - - - - - - - - - - - --‘ - - - - - - - - - - - - - --I--_ - - - - - - - - - - - - - - - - - - --'

- — — — — — — — — — — — — — — — — — — — — PeptIde Sequence Set Determinatlon — — — — — — — — — — -— — — — — — —l

I I

I

i  A Peptide Sequence Duality F I

I q.- . annexes-mom s "it" Mt” 1'“ "‘ :

magma 'Eﬁglnmgsﬁm : ClEAHHDKYh—IAEIM 3 :
Identification '  

:  I SPLTDEL'JLIPNLAII’I 2   I

mmlﬂm I  if GLIPNLAII-IKEVIDA 2 :

M31 M355 SHEET] H II'll-tl-I-‘t Ill-‘Htili‘fI‘IHI'EIIII- _ ' I

protein Sequence KkknwnsIFanIHoFsFI KIBFELMR I G pm“ We“ you.“ :

I

I

I

I

Peptide Candidate List Formulation

|.__.__..__.__._._.I.__.__._..__..___._.___.._

Final Result Ranking Quality |'Slassifier Training

_;___.__._.__4___._;;___;_;___..____u___.4__.;_____;___

Fig. 2. Workﬂow of HeXicon. (A) The list of peptide identiﬁcation from MS/MS searches is automatically extended by matching theoretical peptides
to observed masses to ﬁnd peptide sequence candidates for previously unidentiﬁed peptides; (B) a basis function set is created by modeling all possible
deuteration levels for each peptide sequence; (C) the spectra and basis function sets are inserted into the LC/MS segmentation and NITPICK routine and
groups of peaks with features are extracted; (D) the correspondence of inter—experiment peak groups are identiﬁed via a weighted Euclidean distance measure;
(E) the deuteration distribution is derived; (F) a random forest classiﬁer discriminates high—quality results from low—quality results; and (G) the ﬁnal results

are ranked by their quality score.

where ¢(p, k) is the transformation function that computes the basis function
for peptide sequence p at deuteration level k (i.e. its theoretical isotopic
spectrum) and K (p) the maximum number of exchangeable hydro gens (Wales
and Engen, 2006). To accommodate for the non—constant, m/z—dependent
resolution (Chemushevich et al., 2001; Guilhaus, 1995), we use a m/z—
dependent peak shape function and learn its parameterization from the data
(see Supplementary Material).

2.1.3 Quantitative LC/MS feature extraction This feature extraction
procedure provides two key steps for the workﬂow: ﬁrst, it selects a subset
of basis functions (I) g (I) that optimally explain the observed spectrum and
thus determines the peptide sequences of interest; and second, it extracts
features of selected basis functions for the following deuteration distribution
computation and correspondence estimation.

We ﬁrst apply segmentation techniques to achieve optimized separation of
the LC/MS data, which yields better signal—to—noise ratio (SNR) and groups
signals that belong to the same peptide. Manual analysis and some existing
methods normally use a heuristic window—based approach for separating the
LC/MS data. The integration of LC/MS peaks along the entire retention time
window yields suboptimal SNR and fails in case of overlapping peak clusters
(America and Cordewener, 2008). Therefore, we integrate over retention
time only within segments and are thus able to beneﬁt from better SNR.
The exact retention time position of the peptide is then determined via a
sparse elution proﬁle estimation on the LC/MS data segment (Boppel et al.,
2008). Thereafter, to determine the ratio of different deuteration levels of
the peptide sequence of interest, the abundance of their corresponding basis
function ¢(p,k) is estimated using the NITPICK algorithm (Fig. 2C). The
regression problem [Equation ( 1)] is normally ill—posed because the basis
function construction yields an over—complete set of explanatory variables.
Also, NITPICK provides sparse solutions that represent a subset of the over—
complete basis function set that is indeed necessary to explain the observed
spectrum.

Eventually, for each incubation time I, the feature extraction procedure
outputs a list of peak groups gr, where a group gt corresponds to a certain
segment and contains peaks with features

gt= {gt} ={(maﬁazat)gr}

where m is the monoisotopic m/z position, 6 the abundance of the
corresponding basis function, z the charge and t the estimated retention time.

2.1.4 Correspondence estimation

This step determines the correspondences between the peak groups over
incubation time points and the peptide sequences of interest (Fig. 2D).
Given a peptide sequence p of interest, its zero exchange peak group is
ﬁrst determined by matching a measured peak to its theoretical m/z value,

A0 .
g = argmlnlmgo _ftheoretical(pa Z7 0) l a (3)
g0690

where ftheoretica1(p,z,k) computes the theoretical m/z of p at charge z and
deuteration level k. The corresponding peak group at every other incubation
time is determined by minimal weighted Euclidean distance

 

g‘=argmin/(gr—g0VS—kgr—g0), (4)
gregr

where S is a diagonal matrix that normalizes and weights the contributions
of different features to the distance measure. The matrix S is designed
to express the characteristics of signals belonging to the same peptide
sequence over incubation time. To speedup the computation, we also applied
a ﬁltering procedure to eliminate unlikely candidates by charge consistency
and thresholding via retention time window and m/z accuracy cutoff (see
Supplementary Material).

 

1 537

112 /3.IO'SIBUJHOIpJOJXO'SOIlBIIIJOJUIOIQ/ﬂdnq 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

X.Lou et aI.

 

2.1.5 Deuteration distribution estimation After determining the inter—
experiment correspondence of peak groups with respect to a peptide sequence
of interest, its deuteration distribution can be derived as (Fig. 2E)

ﬁg 06)
,k, = 5
MP r) :13? ( )

 

where the ﬁg; (k) is the abundance of the basis function corresponding to
deuteration level k. The average deuteration is merely the average of the
deuteration distribution over all deuteration levels.

2.2 Peptide sequence set determination

To perform complete deuteration distribution estimation for the entire
protein, optimized protein sequence coverage is desirable. We achieve this
goal by extending the peptide sequence set via sequence search and later
using a supervised classiﬁcation approach to discard incorrect or ambiguous
peptide sequences.

2.2.1 Unsupervised peptide sequence inference We use a two—step
procedure to infer possible peptide sequences directly from the observed
spectrum and from prior knowledge (i.e. the protein sequence and the
MS/MS report). We ﬁrst perform peak picking on the observed spectrum
using the NITPICK algorithm. In a second step, the picked monoisotopic
masses, for which no MS/MS identiﬁcations are available, are matched to
theoretical peptide sequences extracted from the known protein sequence.
Eventually, a list of candidate peptide sequences is generated, which consists
of peptide sequences from two sources: peptides that are identiﬁed by MS/MS
data and peptides that are extracted by searching the protein sequence for
subsequences with a mass proximate to the picked peaks.

2.2.2 Supervised quality estimation The unsupervised peptide sequence
inference procedure exploits information without sufﬁcient concern for
multiple assignments of peptide sequences to the same peak or peptide
sequences hallucinated from noise peaks. Despite the fact that this apparently
improves the system’s sensitivity, the payoff is a reduced speciﬁcity, i.e.
false positives are mixed into the peptide sequence set. Therefore, HeXicon
implements a quality estimation procedure to recover reasonable speciﬁcity
while maintaining high sensitivity. We tackle this problem using a supervised
classiﬁcation approach: given training data {x, q} where x e X is the quality
feature vector and qe Q is the quality label, train a classiﬁer 11:26 —> Q
that maps x to its estimated quality q. In particular, we use the random
forest classiﬁer (Breiman, 2001), a supervised, decision—tree based ensemble
learning method with high prediction accuracy and little sensitivity to the
hyper—parameter settings (Fig. 2F).

A representative dataset was selected as training data and each reported
peptide sequence was labeled with a quality score q€{3,2, 1}, in which
3 represents highly conﬁdent results, 2 indicates ambiguous results, i.e.
unidentiﬁed peptide sequence resulting from multiple assignment to the same
peak and 1 contains all results containing no useful information. The quality
features x are designed to characterize the quality of a peptide sequence from
several different aspects. See Supplementary Material for a full list of quality
features. Retraining is necessary for different instruments.

3 RESULTS

HeXicon has been evaluated on two protein datasets of different
complexity (Table 1): C—terminus of Hsp70 interacting protein
(CHIP) and hi gh—temperature protein G (Hth). In each experiment,
protein samples were ﬁrst incubated in heavy water to induce
a certain amount of exchange before being subjected to pepsin
digestion. To identify peptic peptides from the investigated proteins,
we digested the undeuterated protein under the same conditions as
later used for the exchange experiments. We then analyzed the peptic
peptides by automated MS/MS using a 1h acetonitrile gradient

Table 1. Summary of the CHIP and Hth datasets

 

 

Measurements CHIP Hth
Protein length 303 636
Protein weight (kDa) 34.8 72.8

Data size (MB) ca. 121 ca. 671
Incubation time (min) 0, 0.5, 5, 60 0, 5, 10, 30
Manually selected peptide sequences 21 39

Manual analysis time ca. 2 days ca. 1 week

 

either on a nanoLC—QSTAR MS system (CHIP, Hth) and on a
nanoLC—Orbitrap MS system (Hth). Subsequently we determined,
which of the identiﬁed peptides could be found consistently on the
HPLC—QSTAR MS system using a 10 min acetonitrile gradient.
Both datasets have been processed manually, yielding average
deuterations for selected peptide sequences that we use as ground
truth. Segment retention time extensions are between 20 and 50 s.

3.1 Deuteration distribution estimation

For the CHIP spectra in Figure 3A, HeXicon provides a sparse
and condensed estimation of the deuteration distribution that
exhibits smoothness along the deuteration levels, as shown in
Figure 3B. For comparison, we created a well—posed regression
problem by constructing basis functions for the corresponding
peptide CIEAKHDKYMADM and applied the non—negative least—
squares regression based method described in Chik et al., (2006).
We optimized the degree of padding by manually estimating the
maximal deuteration level, yielding a solution very similar to
the HeXicon’s, see Figure 3C. Without optimizing the degree
of padding, i.e. padding to the theoretically maximal possible
deuteration level, Chik’s approach selects several spurious basis
functions due to overﬁtting Figure 3D. Figure 4A shows a
mixture of signals from two peptide sequences: AAERERELE
and IAKKKRWNSIEER. HeXicon yields condensed deuteration
distributions for both peptide sequences, as shown in Figure
4Ba. After padding optimization, Chik’s approach gives a
similar distribution for AAERERELE but the estimate for
IAKKKRWNSIEER is questionable, see Figure 4Bb.

3.2 Sequence coverage enhancement

Combining MS/MS identiﬁcations and inferred peptide sequences,
HeXicon yields an apparent improvement on the number of extracted
peptide sequences with concomitant increases in sequence coverage
when compared to the manual analysis (Table 2). For the manual
analysis, we only used those peptides identiﬁed that we could ﬁnd
consistently in the 10 min gradient runs on the QSTAR system.

3.3 Exchange rate inference

The deuteration distribution estimated by HeXicon can easily
be transformed into an average deuteration estimate 77H(p, t) by
computing the empirical mean. We validated HeXicon by comparing
its average deuteration estimate to the manually obtained average
deuteration estimate 77M(p, t). We applied two metrics to measure
the accuracy: (i) the average m/z difference Am is computed by

Am 2 ET ‘nM(p, t) — 77H(p, t)‘/Nr, where NT is the total number of
incubation time points; and (ii) the relative exchange rate difference

 

1 538

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

HeXicon

 

 

A Spectrum B HeXicon C Chik’s (optimized) DChik’s (non-optimized)
l 0 1 1 0
—»c=o —0 1:0 ’E=0 —. T=0
0 . 5 O . 5 0 . 5
It

 

 

 

O

0
518 520 522 0024681012 024681012 024681012

 

—r=30 —o 1:30 0-4 1:30

1 .liiill.  rili: '0 

518 520 522 O 2 4 6 81012 O 2 4 6 81012

O
N

014wa
—o
—.
________.
_____.
-o
(—

\

 

O

 

—’E=300 o

It- 33

518 520 522

—. T=3OO

Tiiiit

024681012 024681012

c=300 0_

OO

 

OI—INUJ

o
Ol—‘Nw
OO
034161.;
00(—-
.g
N—.
—.
O

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0.3
-t=3600 t=3600 0-3 T=36OO 0-3 1:3600
0-2 0.2 0.2
t 0-1 I 0.1 0.1 l I i
L I‘ 0 0 0 ‘T ‘ e
518 520 522 024681012 024681012 024681012
_—>m/Z :k

Fig. 3. Comparison of deuteration distribution estimation of
CIEAKHDKYMADM from a time series of 0, 30, 300 and 3600s
(A). HeXicon yields condensed solution and avoids overﬁtting (B). With
manually optimized degree of padding, Chik’s approach results in similar
estimates (C). Without padding optimization, Chik’s approach selects
several spurious peaks [(D), marked by ‘1’] due to overﬁtting.

 

 
    
  
 
   

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

l\ I I I I I I
¢(AAERERELE¢6) — 17:3 0 0
y \
¢(AAERERELE¢5)\ ¢(IAKKKRWNSIEER¢7)
¢(AAERERELE¢4)\ ¢(IAKKKRWNSIEER¢8)
__I_ h. | A—L
550 551 552 553 554 555 556
I > m/z
B a HeXicon b Chik’s (optimized) C Chik’s (non-optimized)
O_3 —o AAERERELE(HX) O 3 AAERERELE(LS) —o AAERERELE(LS)
- 0.3
0.25
0.2 0,2 0.2
0.15
0.1 0.1 0.1
0.05 I T T
p O O O O'TT T
0 2 4 6 8 0 2 4 6 8 0 2 4 6 8 10 12
—o IAKKKRWNSIEER(HX) O 4 IAKKKRWNSIEER(LS) o_4 —o IAKKKRWNS‘E’EER(LS)
0.3 '
0.3 0.3
0.2
0.2 0.2
0.1 I O_l 0.1
0 0 0 ‘ T
024681012 024681012 024681012
‘»k
I ’

 

Fig. 4. Comparison of deuteration distribution estimation for
overlapping patterns. Overlapping patterns consist of AAERERELE
and IAKKKRWNSIEER (A). HeXicon yields condensed and smooth
solutions for both peptide sequences (Ba). Even with padding optimization,
Chik’s approach overﬁts the spectrum and yields an unrealistic deuteration
distribution for IAKKKRWNSIEER (Bb). Without padding optimization,
Chik’s approach selects more spurious peaks (Bc). Here, ¢(p,k) indicates
the maximum peak position of the basis function of peptide p at deuteration
level k.

AK is computed by AKz‘KM—KH‘/max (KM,KH>, where K is
the exchange rate inferred by ﬁtting the average deuteration to
the HX kinetic model function (Konermann et al., 2008). Since
the ﬁtting is nonlinear and non—convex and since its ﬁrst— and
second—order derivatives could be derived analytically, we applied

Table 2. Comparison to manual analysis: sequence coverage and analysis

 

 

 

 

    

 

 

 

 

 

 

 

 

 

time
Dataset Measurements Manual analysis HeXicon
Number of extracted 21 31
peptide sequences
CHIP Sequence coverage 84.2% 90.4%
Analysis time 2 days 1 h
Number of extracted 39 90
peptide sequences
Hth Sequence coverage 78.5% 85.5%
Analysis time 1 week 3 h
5 2 1 CI EAKHDKYMAD 5 9 8 DGQSVKAHFFLGQCQL
B
«a
5 2 0 5 o‘
5 9 6 
52 o M"
.e‘ 
5 9 v ’
5 l 9 5
77
5 1 9 5 9 2
1‘ 10° 102 104 10° 102 104
6 0 0 LNPDHVLVKRAADTED 6 4 2 . 5LRELI SNASDAADKLRF'
C .6 0
a“ 6 4 2 
5 99.5 gar 9
,~ 64 1.5  ’EI
, j.
5 9 9 f  ’
x’! 6‘41. l | ‘ ‘ U ‘ , ’
5 9 8 . 5 6 4 O . 5
10° 102 104 10° 102 104
> log(r)

 

 

Fig. 5. Comparison of the exchange rate inference between manual analysis
(dash) and HeXicon (dot) for selected examples. While the estimate by
HeXicon coincides well with the manual analysis for the peptides displayed
on (A), (B) and (C), the estimate for LRELISNASDAADKLRF (D) is
incorrect due to under—segmentation of overlapping peptides in the LC/MS
spectrum.

a generalized Newton method to approximate the optimal solution
(see Supplementary Material).

For the CHIP dataset and 20 of 21 manually selected peptide
sequences, the estimates by HeXicon coincide well with the manual
analysis (see examples in Figure 5A and B), yielding an average
m/z difference of 0.0688 :l:0.0307 Da (mean:l: SD) and a relative
exchange rate difference of 0.0994:l:0.0847. For the Hth dataset,
HeXicon correctly estimates the average deuteration for 32 of 39
manually selected peptide sequences and yields an average m/z
difference of 0.0578:l:0.0339 Da and a relative exchange rate
difference of 0.1205 :l:0.0958 (e.g. Fig. 5C). For the remaining
seven manually selected peptides, the estimates are inaccurate
(e.g. Fig. 5D). The complete list of peptide sequences and their
average deuteration is given in the Supplementary Material.

3.4 Quality ﬁltering accuracy

The quality estimation step aims at identifying high—quality results
and discarding the remaining results. We measure the cross
validation performance of this step using common criteria from

 

1 539

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

X.Lou et aI.

 

Table 3. Cross validation performance: recall, precision and F —score (%) are
given for high—quality (Class 3), medium—quality (Class 2) and low—quality
(Class 1) results

 

 

Measurements Class 1 Class 2 Class 3
Recall 98.8 91.6 92.2
Precision 98.7 92.9 89.2
F—score 98.7 92.2 90.7

 

information theory: recall, precision and F —score. The results given
in Table 3 indicate that the quality estimation step is accurate and
generalizes well across datasets, providing an F —score over 90%.

3.5 Runtimes and implementation

HeXicon has been implemented in C++ and the compiled software
is available at http://hci.iwr.uni—heidelberg.de/software.php. As
indicated in Table 2, HeXicon strongly reduces the analysis time
compared to manual analysis. Since HeXicon is fully automated,
it does not require any real—time user—interaction. Experiments
were carried out without replicates. To perform replicate analysis,
HeXicon results need to be obtained separately for each replicate
and subsequently aggregated. The software package requires the
spectrum data as szML ﬁles and other information (i.e. the
protein sequence and the MS/MS search result) as plain text ﬁles.
Comma—separated values ﬁles are the output.

4 DISCUSSION

As shown in Section 3.1, to avoid overﬁtting Chik’s approach
requires padding optimization by user—input or pre—processing. The
reason is that the least—squares regression attempts to use each
predictor without any restriction, and thus overﬁts the data and
causes several spurious basis functions to be selected, as shown
in Figure 3D (marked by ‘1’). The proposed approach beneﬁts from
the sparsity of the Ll—regularization and discards those spurious
deuteration levels automatically, and thus requires no additional
processing such as thresholding or any further user interaction.
This overﬁtting problem becomes worse when overlapping patterns
occur. As shown in Figure 4Bb, Chik’s approach (with padding
optimization) gives a reasonable distribution for AAERERELE,
but yields an unrealistic estimate for IAKKKRWNSIEER, i.e.
the large gaps between neighboring deuteration levels. HeXicon,
on the other hand, keeps the intrinsic smoothness and sparsity
of the deuteration levels. Although the estimate for the low—
intensity IAKKKRWNSIEER is subject to low SNR, it is still
represented by a compact deuteration distribution at the most
relevant positions and appears to be physically reasonable. While
maximum entropy deconvolution based methods (Zhang et al.,
1997) might theoretically be appealing, they are not applicable to
the problem since they require a pre—deﬁned noise level (Abzalimov
and Kaltashov, 2006), which is usually not available to the users
and may vary among different m/z regions or experiments. Further,
these approaches are prone to overﬁtting and are computationally
expensive (Hotchko et al., 2006).

The improved sequence coverage provided by HeXicon is
particularly helpful to gain a more complete and detailed
understanding of a dataset. Due to under—segmentation of crowded

regions in the LC/MS data, HeXicon did not recover all manually
selected peptide sequences from the Hth dataset, but it still
managed to yield a higher sequence coverage because other peptide
sequences were selected to compensate for the missing ones.
Further, as shown in Table 2, HeXicon ﬁnds more than twice the
number of peptide sequences selected by human experts, which
allows exchange behavior prediction in ﬁner regions. For instance,
the estimation of exchange rate at positions 279—284 can be
inferred from both HLQRVGHFDPVTRSPLTQEQLIPNL (position
259—284) and HLQRVGHFDPVTRSPLTQE (position 259—278).
Since we only considered those HeXicon results with the highest
quality score for the computation of the sequence coverage, this
number can be regarded as a conservative estimate. Additional
lower quality results provided by HeXicon can guide users towards
further targeted experiments. For instance, ambiguous results, when
multiple peptide sequences could be assigned to the same spectrum,
might motivate additional MS/MS run on speciﬁc peptide sequences
of interest, and thereby allow further improvement on the sequence
coverage.

5 CONCLUSION

In this article, we introduced HeXicon, a novel algorithmic
workﬂow for the robust estimation of deuteration distributions with
increased sequence coverage for HX/MS experiments. Comparisons
to previous methods showed that the Ll—regularization adopted in
our method provides a sparse estimation of deuteration distributions
and avoids over—ﬁtting. The overall sequence coverage is increased
by inferring peptide sequences from prior knowledge, and the
tradeoff between sensitivity and speciﬁcity is balanced using a
supervised classiﬁcation procedure.

In comparison to manual analysis, we showed that HeXicon
succeeds in accurately extracting the deuteration content while
improving sequence coverage and reducing analysis time.

ACKNOWLEDGEMENT

The authors would like to thank Thorben Kréger, Anna Kreshuk
and Michael Hanselmann [Interdisciplinary Center for Scientiﬁc
Computing (IWR), University of Heidelberg, Germany] for
comments, suggestions and fruitful discussions.

Funding: Heinz Goetze Memorial Fellowship Program (to X.L.);
Helmholtz Alliance on Systems Biology (to XL. and F.A.H.); Karl—
Steinbuch—Fellowship (to B.Y.R.); DFG (SFB 638: to M.P.M., CG,
C.T.L.); DFG (HA4364/2—1: to B.Y.R., F.A.H.); Alexander von
Humboldt—Foundation (3.1—DEU/ 1134241: to M.K.).

Conﬂict of Interest: none declared.

REFERENCES

Abzalimov,R.R. and Kaltashov,I.A. (2006) Extraction of local hydrogen exchange data
from HDX CAD MS measurements by deconvolution of isotopic distributions of
fragment ions. J. Am. Soc. Mass Spectrom, 17, 1543—1551.

America,A.H.P. and Cordewener,].HG (2008) Comparative LC-MS: a landscape of
peaks and valleys. Proteomics, 8, 731—749.

Boppel,S. et al. (2008) Sparse proﬁle reconstruction for LC/MS feature extraction. In
American Society for Mass Spectrometry. Annual Conference.

Breiman,L. (2001) Random Forests. Mach. Learn, 45., 5—32.

Chernushevich,I.V. et al. (2001) An introduction to quadrupole-time-of—ﬂight mass
spectrometry. J. Mass Spectrom, 36, 849—865.

 

1 540

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

fk»ﬁbon

 

Chik,J.K. et al. (2006) Quantitating the statistical distribution of deuterium
incorporation to extend the utility of H/D exchange MS data. Anal. Chem, 78,
207—214.

Dobson,C.M. (2003) Protein folding and misfolding. Nature, 426, 884—890.

Efron,B. et al. (2004) Least angle regression. Ann. Stat., 32, 407—451.

Engen,].R. (2009) Analysis of protein conformation and dynamics by
hydrogen/deuterium exchange MS. Anal. Chem, 81, 7870—7875.

Englander,S.W. (2006) Hydrogen exchange and mass spectrometry: a historical
perspective. J. Am. Soc. Mass Spectrom., 17, 1481—1489.

Guilhaus,M. (1995) Special feature: tutorial. Principles and instrumentation in time-of-
ﬂight mass spectrometry. Physical and instrumental concepts. J. Mass Spectrom., 30,
1519—1532.

Hoofnagle,A.N. et al. (2003) Protein analysis by hydrogen exchange mass spectrometry.
Annu. Rev. Biophys. Biomol. Struct., 32, 1—25.

Hotchko,M. et al. (2006) Automated extraction of backbone deuteration levels from
amide H/2H mass spectrometry experiments. Protein Sci., 15, 583—601.

Konermann,L. et al. (2008) Protein structure and dynamics studied by mass
spectrometry: H/D exchange, hydroxyl radical labeling, and related approaches.
J. Mass Spectrom., 43, 1021—1036.

N ikamanon,P. et al. (2008) “TOF2H”: A precision toolbox for rapid, high density/high
coverage hydrogen-deuterium exchange mass spectrometry via an LC-MALDI
approach, covering the data pipeline from spectral acquisition to HDX rate analysis.
BMC Bioinformatics, 9, 387.

Palmblad,M. et al. (2001) Automatic analysis of hydrogen/deuterium exchange mass
spectra of peptides and proteins using calculations of isotopic distributions. J. Am.
Soc. Mass Spectrom., 12, 1153—1162.

Pascal,B.D. et al. (2007) The deuterator: software for the determination of backbone
amide deuterium levels from H/D exchange MS data. BMC Bioinformatics, 8, 156.

Pascal,B.D. et al. (2009) HD desktop: an integrated platform for the analysis and
visualization of H/D exchange data. J. Am. Soc. Mass Spectrom., 20, 601—610.

Renard,B.Y. et al. (2008) NITPICK: peak identiﬁcation for mass spectrometry data.
BMC Bioinformatics, 9, 355.

Schwarz,G. (1978) Estimating the dimension of a model. Ann. Stat., 6,461464.

Slysz,G.W. et al. (2009) Hydra: software for tailored processing of H/D exchange data
from MS or tandem MS analyses. BMC Bioinformatics, 10, 162.

Tibshirani,R. (1996) Regression shrinkage and selection via the Lasso. J. Roy. Stat. Soc.
B, 58, 267—288.

Wales,T.E. and Engen,].R. (2006) Hydrogen exchange mass spectrometry for the
analysis of protein dynamics. Mass Spectrom. Rev., 25, 158—170.

Weis,D.D. et al. (2006) Semi-automated data processing of hydrogen exchange mass
spectra using HX-Express. J. Am. Soc. Mass Spectrom., 17, 1700—1703.

Zhang,Z. et al. (1997) Enhancement of the effective resolution of mass spectra of
high-mass biomolecules by maximum entropy-based deconvolution to eliminate
the isotopic natural abundance distribution. J. Am. Soc. Mass Spectrom., 8,
659—670.

 

1541

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

