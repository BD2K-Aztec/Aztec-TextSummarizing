APPLICA TIONS NOTE W 33-38: liﬁé’ibiaiiiiﬁali‘iiitlgi‘i

 

Genetics and population analysis

Advance Access publication February 17, 2013

PleioGRiP: genetic risk prediction with pleiotropy

Stephen W. Hartley” and Paola Sebastiani2

1National Institutes of Health/National Human Genome Research Institute, 5625 Fishers Lane, Suite 5 N—01, Rockville,
MD 20850, USA and 2Department of Biostatistics, Boston University School of Public Health, 801 Massachusetts

Avenue, Boston MA 02118, USA

Associate Editor: Gunnar Batsch

 

ABSTRACT

Motivation: Although several studies have used Bayesian classiﬁers
for risk prediction using genome-wide single nucleotide polymorphism
(SNP) datasets, no software can efficiently perform these analyses on
massive genetic datasets and can accommodate multiple traits.
Results: We describe the program PleioGRiP that performs a
genome-wide Bayesian model search to identify SNPs associated
with a discrete phenotype and uses SNPs ranked by Bayes factor to
produce nested Bayesian classiﬁers. These classifiers can be used for
genetic risk prediction, either selecting the classifier with optimal
number of features or using an ensemble of classifiers. In addition,
PleioGRiP implements an extension to the Bayesian search and clas-
sification and can search for pleiotropic relationships in which SNPs
are simultaneost associated with two or more distinct phenotypes.
These relationships can be used to generate connected Bayesian
classifiers to predict the phenotype of interest either using genetic
data alone or in combination with the secondary phenotype(s).
Availability: PIeioG RIP is implemented in Java, and it is available from
http://hdl.handle.net/2144/4367.

Contact: stephen.hartley@nih.gov

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 16, 2012; revised on January 11, 2013;
accepted on February 11, 2013

1 INTRODUCTION

A Naive Bayesian classiﬁer (NBC) is a simple, efﬁcient and
robust tool that can be used to capture the complex genetic
basis of a multigenic trait and can predict a subject phenotype
based on the posterior probability of the trait given the individ-
uals genetic proﬁle (Okser et al., 2010; Sebastiani et al., 2012a).
Such classiﬁer can be built using a large number of genetic vari-
ants, each with a relatively small contribution to the total genetic
risk. However, the use of NBCs and similar Bayesian methods
are relatively uncommon in genetics, and although general-use
software does exist that is capable of performing Bayesian mod-
eling and prediction (Thomas et al., 1992), many of these soft-
ware utilities are not well-suited to the high-dimensionality
of genome-wide data (Scutari, 2010). We have developed a
stable, easy-to-use software package capable of performing
these analyses efﬁciently and accurately using exact Bayesian
computations.

 

*To whom correspondence should be addressed.

In addition, although methods are available to identify asso-
ciations between genetic loci and individual phenotypes, few
methods can detect pleiotropic associations in which loci are
simultaneously associated with multiple phenotypes and use
the pleiotropic associations to improve genetic risk prediction.
In Hartley et al. (2012), we showed that pleiotropic associations
can be modelled via the construction of simple Bayesian net-
works, and that these models can be applied to produce single
or ensembles of Bayesian classiﬁers that leverage pleiotropy to
improve genetic risk prediction. Testing with simulated and real
data has shown that these models may improve genetic risk
prediction under certain circumstances. Our software package,
PleioGRiP is capable of both ‘Pleiotropic Genetic Risk
Prediction’, as well as prediction using NBCs.

2 FUNCTIONALITY AND CAPABILITIES

PleioGRiP takes as input a genome wide association study
(GWAS) dataset with multiple phenotypes T1, T 2, . . . , identiﬁes
relationships between the single nucleotide polymorphisms (SNPs)
S1, S2, . . . and the phenotypes and uses these relationships to gen-
erate classiﬁers and ensembles of classiﬁers that can predict the
phenotypes, conditional on the genetic proﬁles, or one phenotype
conditional on the genetic proﬁle and the other phenotypes. The
details of the method are described in Hartley et al. (2012) and
include two main phases: (i) discovery of SNPS that could be
used for prediction using a Bayesian-model—based approach and
(ii) selection of a ﬁnal set of the most predictive SNPs using
cross-validation, or generation of ensemble of classiﬁers.

2.1 Model building

To build standard NBCs with a single phenotype, PleioGRiP ﬁrst
ranks the SNPs by the strength of evidence that each SNP is asso-
ciated with the phenotype. Bayes factors are calculated under four
different modes of inheritance—genotypic, allelic, dominant and
recessive—and the highest Bayes factor is used for the ranking.
Nested classiﬁers 21, . . . ,ER are then constructed such that 21
uses only the top ranked SNP, 22 uses the top two SNPS and so
forth. The predictive accuracy of the classiﬁers in the list is eval-
uated using cross-validation to select the optimal number of SNPs.

If two or more phenotypes are provided, then PleioGRiP can
search for pleiotropic relationships between SNPS and multiple
phenotypes. In this case, for each SNP, Bayes factors of the
association between each SNP and each phenotype are calculated
for each mode of inheritance, and the highest Bayes factor for
each SNP and phenotype is selected. All SNPs with highest

 

1086 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /810'S{12umo[pJOJXO'sopcuuogutotq/ﬁd11q wort popcolumoq

910K ‘09 lsnﬁnV no :2

PleioGRiP: genetic risk

 

Bayes factor that do not pass a user-assigned signiﬁcance thresh-
old (default threshold 2 e) are dropped. For each SNP that
passes this threshold and hence is associated with at least one
phenotype, the simultaneous association of the SNP with add-
itional phenotypes is scored by the Bayes factor and accepted if
the Bayes factor increases. SNPs are ranked by the Bayes factor
of the selected associations, and nested classiﬁers 21, . . . ,ER are
constructed such that 21 uses only the top ranked SNP, 22 uses
the top two SNPs and so forth.

2.2 Prediction

Once nested classiﬁers have been constructed, PleioGRiP can
carry out genetic risk prediction using a variety of different clas-
siﬁcation rules. If only one phenotype is being used, prediction is
carried out with either a single classiﬁer 2,, where the optimal
number r of SNPs is selected using cross-validation, or an en-
semble of the ﬁrst r classiﬁers. The single classiﬁer prediction
uses the posterior probability of the phenotype, given the genetic
proﬁle, that is computed using Bayes’ theorem as described for
example in Hartley et al., 2012; Sebastiani et al., 2012b. The
ensemble of classiﬁers predicts based on the average of posterior
probabilities of the phenotype computed from the classiﬁers
21, . . . ,E,. The ensembles of classiﬁers prediction method has
been shown to provide improved classiﬁcation in certain situ-
ations. In particular, it appears to be robust to inclusion of
false positive associations (Hartley et al., 2012).

If PleioGRiP is assigned to search for pleiotropic associations
between SNPs and two or more phenotypes, then additional
prediction methods are available. The joint prediction of all the
phenotypes uses the joint posterior probability of the pheno-
types, given the genotype data that are computed by Bayes’ the-
orem, using the formula:

P(T1&T2|S1, ---,Sr) 0<P(T1&T2)P(S1, ---,Sr|T1&T2) =
p(T1&T2)Hpoylrl)Enamel—[manure
J' k i

This formula leverages the conditional independences
embedded in NBCs to factorize the probability p(S1, . . . ,S,
| T1& T 2) [See Hartley et al. (2012) for details]. Conditional pre-
diction predicts the phenotype of interest for a given subject using
the conditional probability of the subject’s phenotype, given the
genotype and the other secondary phenotype(s). Marginal predic-
tion predicts an assigned phenotype of interest for a given subject
using the posterior probability of the phenotype, given only the
subject’s genotype data. Both conditional and marginal posterior
probabilities can be derived from the joint probability. Prediction
rules can be generated for these types of prediction based on
either single classiﬁers or ensembles of classiﬁers.

2.3 Cross-validation

Cross-validation can be used to: (i) determine the optimal number
of SNPs to use in the ﬁnal classiﬁer; (ii) estimate various accuracy
metrics of the classiﬁers; and/or (iii) select alternative classiﬁca-
tion thresholds. Cross-validation can be carried out using any
user-deﬁned number of folds, up to and including leave-one-out
cross-validation. For each subject in the discovery set, the
cross-validation risks are calculated using each applicable

prediction method. Using these data, the cross-validation speciﬁ-
city, sensitivity and area under the ROC curve (AUC) can be
calculated for each nested classiﬁer and each prediction rule.
The AUC can be used to estimate the number of SNPs to include
in the ﬁnal classiﬁer to maximize the efﬁcacy of prediction. In
addition, the cross-validation data can be used to determine the
prediction threshold that optimizes the Youdens J statistic for a
given classiﬁer and prediction method. In some cases, particularly
when the phenotypes are unbalanced, this can substantially im-
prove prediction. The utility is designed to be fast and can carry
out these cross-validation functions on 4000-subject, 500 000 SNP
datasets in minutes (for 10—fold cross-validation) on a PC with 64
bit Operating System, 8 GB RAM, Intel 5, 2 2.67GHz.

2.4 Input and output files

PleioGRiP requires as input ﬁles a ped ﬁle with genotype data, a
map ﬁle with SNP location and a phenotype file with the pheno-
typic data. Both binary and text-based PLINK ﬁles are accepted
as format. The output is a set of tab-delimited text ﬁles, including
a model summary ﬁle and various prediction summary ﬁles. The
model summary ﬁle lists the top SNPs in descending order of
signiﬁcance, along with the log-Bayes factor, the selected
single-SNP model and mode of inheritance and the full contin-
gency table for that model. The prediction summary ﬁles include,
for each nested classiﬁer and each type of prediction: accuracy,
speciﬁcity and sensitivity estimates along with Fisher exact tests
of differential prediction, both with and without prediction
threshold selection AUC’s estimates and 95% conﬁdence inter-
vals. The utility also exports the raw classiﬁcation statistics for
each classiﬁer. R scripts included in the software package can
then perform classiﬁcation using any of these classiﬁers, and
using any user-supplied prediction threshold.

3 EXAMPLE
The program is distributed with an example dataset of 2000 sub-
jects, 7500 SNPs and 75 causal SNPs. To run the program:
java -me8g -jar PleioGRipjar
-ped simData.bed -map simData.bim -fam simData.fam

-pheno simData.pheno -read plinkBed -model ﬁnd_add
SearchBC

-pleio_parentList ‘DISEASE_A—DISEASE_B’
-optimize run1 OF oldCrossValidationOptimization
-mdlSubjListFile list_disc.txt -repSubjListFile list_rep.txt

-twoColSubj Lists
Classiﬁcation _plio

-logDir./logs/—classify replication

where .bed, .bim, .fam, .pheno are input ﬁles with genotypes and
phenotype lists. The software release includes documentation
with descriptions of all the options.

4 CONCLUSION

PleioGRiP is stable, computationally efﬁcient and offers a ﬂex-
ible new tool to GWAS investigators interested in Bayesian gen-
etic risk prediction analyses, either with or without pleiotropy.

 

1087

112 /810'S{12umo[pJOJXO'sot1BmJOJutotw/2d11q IIIOJJ popcommoq

910K ‘09 lsnﬁnV no :2

S. W.Hartley and P.Sebastiani

 

Funding: NIH/NHLBI R21HL1 14237 and NIH/NIA
U19AGO23122.

Conﬂict of Interest: This article was prepared while Stephen
Hartley, Ph.D. was employed at Boston University. The opinions
expressed in this article are the author’s own and do not reﬂect
the views of the National Institutes of Health, or the United
States government.

REFERENCES

Hartley,S.W. et al. (2012) Bayesian methods for multivariate modeling of pleio-
tropic SNP associations and genetic risk prediction. Front. Genet, 3, 176.

Okser,S. et al. (2010) Genetic variants and their interactions in the prediction of
increased pre-clinical carotid atherosclerosis: the cardiovascular risk in young
ﬁnns study. PLoS Genet, 6, e1001146.

Scutari,M. (2010) Learning Bayesian networks with the bnleam R package. J. Stat.
Softw., 35, 1—22.

Sebastiani,P. et al. (2012a) Genetic signatures of exceptional longevity in humans.
PLoS One, 7, e29848.

Sebastiani,P. et al. (2012b) Nave Bayesian classiﬁer and genetic risk score for
genetic risk prediction of a categorical trait: Not so different after all! Front.
Genet, 3, 26.

Thomas,A. et al. (1992) Bugs: a program to perform Bayesian inference using Gibbs
Sampling. In: Bernardo,J. et al. (ed.) Bayesian Statistics 4. Oxford, UK, Oxford
University Press, pp. 837—842.

 

112 /810'S{12umo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeommoq

910K ‘09 lsnﬁnV no 22

