Bioinformatics Advance Access published August 6, 2016

Bioinformatics, 2016, 1—7

doi: 10.1093/bioinformatics/btw307

Advance Access Publication Date: 14 May 2016
Original Paper

 

Sequence analysis

Top-down analysis of protein samples by de
novo sequencing techniques

Kira Vyatkina1'2'*, Si Wu3, Lennard J. M. Dekker4, Martijn M. VanDuijn4,
Xiaowen Liu5'6, Nikola Tolié7, Theo M. Luider4, Ljiljana Pasa-Tolié7 and
Pavel A. Pevzner2'8'*

1Algorithmic Biology Laboratory, Saint Petersburg Academic University, St Petersburg, Russia, 2Center for
Algorithmic Biotechnology, Institute of Translational Biomedicine, Saint Petersburg State University, St
Petersburg, Russia, 3Department of Chemistry and Biochemistry, University of Oklahoma, Norman, OK, USA,
4Department of Neurology, Erasmus University Medical Center, Rotterdam, The Netherlands, 5Department of
BioHeaIth Informatics, Indiana University-Purdue University Indianapolis, Indianapolis, IN, USA, 6Center for
Computational Biology and Bioinformatics, Indiana University School of Medicine, Indianapolis, IN, USA,
7Environmental Molecular Sciences Laboratory, Pacific Northwest National Laboratory, Richland, WA, USA and
8Department of Computer Science and Engineering, University of California, San Diego, CA, USA

*To whom correspondence should be addressed.
Associate Editor: Burkhard Rost

Received on November 9, 2015; revised on March 31,2016; accepted on May 9,2016

Abstract

Motivation: Recent technological advances have made high—resolution mass spectrometers afford—
able to many laboratories, thus boosting rapid development of top—down mass spectrometry, and
implying a need in efficient methods for analyzing this kind of data.

Results: We describe a method for analysis of protein samples from top—down tandem mass spec—
trometry data, which capitalizes on de novo sequencing of fragments of the proteins present in the
sample. Our algorithm takes as input a set of de novo amino acid strings derived from the given
mass spectra using the recently proposed Twister approach, and combines them into aggregated
strings endowed with offsets. The former typically constitute accurate sequence fragments of suffi—
ciently well—represented proteins from the sample being analyzed, while the latter indicate their lo—
cation in the protein sequence, and also bear information on post—translational modifications and
fragmentation patterns.

Availability and Implementation: Freely available on the web at http://bioinf.spbau.ru/en/twister.
Contact: vyatkina@spbau.ru or ppevzner@ucsd.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Top—down mass spectrometry is a recently emerged technology
for analyzing intact proteins, which is particularly suitable for de—
tecting post—translational modifications (PTMs). Among its most im-
portant applications is characterization of therapeutic antibodies
(Bondarenko et 61]., 2009; Fornelli et 61]., 2012; Kellie et 61]., 2010),
as part of the process of drug development. Nowadays, modern
instruments allow to rapidly acquire vast amount of high—quality

top—down data, but efficient algorithms for its processing are still in
high demand.

One of the key tasks of mass spectrometry—based proteomics is
de novo sequencing of peptides and proteins from tandem (MS/MS)
mass spectrometry data. In the last two decades, several algorithms
have been proposed for de novo peptide sequencing from bottom—up
data, and a few powerful tools appeared, including PEAKS
(Ma et 61]., 2003), PepNovo (Frank and Pevzner, 2005), pNovo

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journalspermissions@oup.com l

91% ‘09 1sn3nv uo sepﬁuv s01 ‘BTUJOJTIBD JO Amie/qqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIUAAOG

K. Vyatkina et al.

 

(Chi et al., 2010), Lutefisk (Taylor and Johnson, 1997), Sherenga
(Dancik et al., 1999), Novor (Ma, 2015) and the program UVnovo
(Robotham et al., 2016) recently introduced for the case of 351 nm
ultraviolet photodissociation (UVPD) mass spectra. Other achieve—
ments comprise methods for complete protein sequencing using mul-
tiple enzyme digest and assembly by sequence overlap, possibly
referring to a homologous protein sequence (Bandeira et al., 2004,
2007, 2008; Castellana et al., 2010; Liu et al., 2009), and a number
of alternative approaches benefit from complementarity of mass
spectra acquired using different fragmentation techniques from ei-
ther peptides (Bertsch et al., 2009; Chi et al., 2013; Datta and Bern,
2008; Guthals et al., 2013; He and Ma, 2010; Savitski et al., 2005)
or intact proteins (Horn et al., 2000).

Yet to the best of our knowledge, only three published algo—
rithms make any use of top—down data to achieve the above—
mentioned goal, and namely, the one from (Horn et al., 2000),
which, however, did not result in a publicly available tool, TBNovo
(Liu et al., 2014) that processes combined MS/MS datasets and util—
izes top—down spectra as a scaffold for assembling bottom—up spec—
tra, and our recently developed approach called Twister (Vyatkina
et al., 2015). At the same time, primarily due to increasing accessi—
bility of hybrid Orbitrap Fourier transform mass spectrometers, the
top—down technology is nowadays rapidly gaining popularity, thus
enforcing the need in efficient approaches to de novo peptide and
protein sequencing from top—down spectra alone.

This work represents a continuation of our research summarized
in (Vyatkina et al., 2015), where we introduced a method that ex—
tracts from deconvoluted MS/MS spectra a number of accurate se—
quence fragments of the proteins contained in a sample. Here we
describe an algorithm that takes as input the fragments obtained this
way, and combines them to produce a set of so—called aggregated
strings, each endowed with direct and reversed offsets intended to
match the masses of the two terminal fragments preceding and fol-
lowing it in the underlying protein sequence. Thereby we obtain lon—
ger sequence fragments of sufficiently well—represented proteins,
among which should be the target ones (but can be also abundant
enough contaminants). The number of aggregated strings is substan—
tially smaller than that of the original fragments, thus allowing to
see at a glance distinct components of the sample. Moreover, their
associated offsets can provide extra insight into what was the com—
position of the sample at the level of proteoforms, which post—
translational modifications (PTMs) occurred in the sequence, or
which fragment ions were measured in the experiment. This immedi-
ately turns the suggested approach into a handy stand—alone method
for analyzing protein samples.

In what follows, we outline the procedure for computing aggre—
gated strings, illustrate the potential of the method by experimental
results obtained for top—down MS/MS datasets for the standard pro—
tein carbonic anhydrase 2 (CAH2) and the Fab region of alemtuzu—
mab, and indicate directions for further research.

The proposed approach is implemented in a software tool
Twister available at http://bioinf.spbau.ru/en/twister, which also in—
corporates the method introduced in (Vyatkina et al., 2015 ), and
thus, takes as input a set of deconvoluted MS/MS spectra.

2 Methods and algorithms

2.1 Datasets

We used the top—down datasets for CAH2 and the light chain of
alemtuzumab published in (Vyatkina et al., 2015) and available at
http://bioinf.spbau.ru/en/twister. In brief, intact CAH2, and

alemtuzumab digested with papain and reduced, were analyzed by a
reversed—phase liquid chromatography (RPLC) system coupled on—
line with a Thermo LTQ Orbitrap Elite and Velos, respectively. MS
and MS/MS spectra were collected at a resolution of 240k and
120k, respectively, in case of CAH2, and 100k and 60k, respect—
ively, in case of alemtuzumab. The CAH2 and alemtuzumab data—
sets comprised 3, 033 ETD, 3, 363 CID and 3, 437 HCD top—down
MS/MS spectra, and 4, 962 ETD and 4, 931 HCD top—down MS/
MS spectra, respectively.

2.2 Generation of aggregated strings

When describing our approach, we will refer to the notion of a pep-
tide sequence tag (Mann and Wilm, 1994), or simply tag, being a
short amino acid sequence with an associated offset. A tag of length
13, or k—tag, is defined by k —l— 1 peaks in, . . . ,pkH from a spectrum S,
such that each two consecutive ones are separated by the mass of an
amino acid. Thus, a k—tag t has an amino acid sequence s(t) : a1 . . .
ak and an offset o(t) equal to the mass Mass(p1) of the leftmost peak
p1. The score of a k—tag t is defined as Score(t) : 2:11 1(1),), where
1(1),) denotes the intensity of a peak p,, for 1 g i g k —l— 1. For an
amino acid a,- of s(t), we define its score as Scoret(a,-) :
1(1),) —l— I(p,—+1), where 1 g i g k. In what follows, the tag length [a
is assumed to be fixed.

Two k—tags t1 and t2 originating from two distinct spectra, and
having the same amino acids sequence and approximately (up to a
predefined tolerance) the same offset can be merged together.
Without loss of generality, assume that Score(t1) > Score(tz); then
for the ith underlying peak pf of the resulting tag t*, we have Mass(
 : Mass(p}) and 1(1)?) : 1(p1-1) —l— 1(p1-2), where p} and p,-2 denotes
the ith defining peak of t1 and t2, respectively, and 1 g i g k —l— 1.
This gluing procedure extends to the case of three or more such k—
tags in a straightforward way.

The input for our method constitutes a list N of amino acid strings
endowed with offsets, derived from the deisotoped and charge state
deconvoluted, often referred to simply as deconvoluted, MS/MS spec—
tra as explained in (Vyatkina et al., 2015 ). In brief, the input spectra
are first preprocessed, which comprises merging nearby peaks (i.e. the
ones with approximately the same masses deconvoluted from differ—
ent charge states), optional peak reﬂection followed by merging
nearby peaks (i.e. the ones due to pairs of complementary fragment
ions in the original spectra), and optional water—loss ion elimination.
Subsequently, the de novo strings are assembled from high-quality le-
tags extracted from the resulting spectra, consistent with each other in
terms of both amino acid sequences and offsets (Figs. 1a and 1b). This
task is accomplished through constructing for the obtained set of k—
tags a T—Bruijn graph (Vyatkina et al., 2015 ), which is a modification
for the case of tags of an A—Bruijn graph (Pevzner et al., 2004) widely
used in genomics, and extracting an optimal path from each its con—
nected component. Thus, the k—tags together giving rise to a single de
novo string often come from several distinct spectra. Formally, for a
string s : a1 . . .am from N, the set T(s) of its underlying k—tags repre—
sents a disjoint union of non—empty sets T1(s), 72(s), . . ., Tm_k+1(s)
of k—tags, such that

° all the tags composing the set Ti(s) have the same amino acid se—
quence aiai+1 . . .a,-+k_1 and approximately the same offset 0,-(s),
and all such tags derived from the input spectra are contained in
7,-(s), where 1 g i g m — k —l— 1, and

° 0,-(s) : 0,-_1(s) —l— Mass(ai_1), where 1 < j g m — k —l— 1.

The string s is assigned an offset o(s) : o1  The multiplicity of
o(s) is defined as ,u(o(s)) : ,u(s) : 

9mg ‘09 1sn3nv uo sepﬁuv soq ‘nruiomeg JO Amie/qqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pepnommoq

 

 

 

 

 

 

 

 

 

 

 

 

Top-down analysis of protein samples 3
(a) (b)
V 302 TVY (100) DST
I I I I (403) VYN (215) STV
100+Mass(D) 4
0 302 403 502 665 779 1000 (2 15) STV
215+Mass(S) —> (302) TVY
302+Mass('1') —> (403) VYN
D T V (100) DST
(2) s —>
I I I (2 15) STV I
0 100 215 302 403 502 800
(100:5) DSTVYN
T v 215—Mass(D)
(3) s —> (2 15) STV
| I 302—Mass(DS)
o 215 302 403 502 900 4°3-M088(DST>
direct main main
Offsets reversed direct reversed
( 1 0 0 : 5 ) DSTVYN ( 1 0 0 : 5 ) DSTVYN ( 1 0 0 5 ) offset offset offset

(203:2) VYNP —> (203:2) VYNP
(221:3) NYVTS STVYN (221:3)

DSTVYNP (124:3) —> (100) DSTVYNP (124)

I

221—Mass(P)

(-100:2)

I

203—Mass(DST)

Fig. 1. Overview of the entire method for aggregated strings generation. (a) Extraction of 3-tags from the input set of deconvoluted MS/MS spectra. (b) Assembly

of a de novo string from five 3-tags consistent with each other in terms of both amino acid sequences and offsets. The resulting de novo string ‘DSTVYN’ is as-
signed the mass offset of 100 with multiplicity 5. (c) Formation of an aggregated string from three de novo string endowed with offsets. The resulting aggregated
string ‘DSTVYN P' has the main direct and reversed offset of 100 and 124, respectively, which leads to the precursor mass estimate PM DSTWNP =

100 + Mass(DSTVYNP) + 124 = 1000

An interpretation of the procedure of generating s from T(s)
consistent with the method from (Vyatkina et al., 2015 ) is the fol—
lowing: first, the tags from each set Ti(s) are glued together, thus
giving rise to a tag tf, where 1 g i g m — k —l— 1, and next, the de
novo string s is traced out. Consequently, we define the score of
an amino acid a,- of s as the sum of its scores in the tags result—
ing from the gluing that cover it, normalized by the number of
those: Scores(a,-) = (Etierwi) Scoret.~(a,-)>/|T*(a,-)|, where T*(a,-) :
{tﬂai e s(tf), 1 g j g m — k + 1}.

For example, the score of the amino acid ‘S’ of the de novo string
‘DSTVYN’ shown in Figure 1b would be computed from the 3—tags
labeled with ‘DST’ and ‘STV’, and the 3—tag labeled with ‘STV’
derived from spectrum (2) and (3) on Figure 1a, respectively, as
{[0215 +Iioz)l + [(1215 +1502) + (1215 +Iioz)i}/2a Where Iiw de‘
notes the intensity of the peak with mass M from the jth spectrum,
and the first and second term in square brackets corresponds to the
tag string ‘DST’ and ‘STV’, respectively.

The score of s is defined as Score(s) :  Scores (a,). Note that
this scoring is different from the one used in (Vyatkina et al., 2015 )
to order the output de novo strings, which equals 2,67“) Score(t).
While such tag—based scoring is appropriate for working with the de
novo strings, it cannot be applied to the aggregated strings we are
going to construct, in particular, since during their formation, we
can encounter amino acid sequences not entirely covered with the le—
mers labeling the tags generated from the input spectra. Therefore,
for the aggregated strings, a scoring needs to be defined on the basis
of individual amino acids rather than tags, and for the purpose of
unification, at this stage we use an analogous scoring for the de
novo strings as well. (The score of an aggregated string is formally
introduced in Appendix.)

Observe that the sequence s(t) of a correct k—tag t may corres—
pond to a reversed k—mer of the underlying protein sequence (this
will be the case e.g. for a correct tag defined by y—ions from a CID or
HCD spectrum), and groups of such tags may produce reversed cop—
ies of longer fragments of the protein sequence. As a consequence,

along with the amino acid strings from N, we will have to consider
their reﬂected counterparts. For an amino acid sequence 2, its re—
versed copy will be further denoted by E.

Construction of the aggregated strings proceeds in two steps: at
the initialization stage, the amino acid sequences on their own are
iteratively formed, and subsequently, their associated offsets are
computed. An overview of the entire method and the initialization
stage is provided in Figures 1 and 2, respectively. Note that the toy
example shown in Figure 1c is intended solely to give a gen—
eral idea of how an aggregated string is formed, and therefore,
many details mentioned in the next section and Figure 2 are omit—
ted in it.

2.2.1 Initializing aggregated strings

Throughout the process, we maintain a set I of active strings.
Initially, I = N; at any further moment, I consists of all the aggre—
gated strings obtained so far and all the strings from N that have
not contributed to any of those. At each step, a number of strings
from I are selected to produce one or a few new aggregated strings,
and then the former get replaced in I by the latter.

In addition, we maintain the set K; of all k—mers of the strings
from I. The score of a k—mer p E K; is defined as the sum of values
contributed by the strings s from I that contain p as a substring: s
contributes 1 if it represents an aggregated string, and the number
n, of the de novo strings from N with the amino acid sequence s
otherwise. At each iteration, the top—scoring k—mer p0 from [CI is
selected. Subsequently, the Algorithm (1) forms the set J Q I of
all the active strings containing p0 or p—O, (2) builds the best align—
ment of those, thereby reversing the strings containing p—O but not
p0, and possibly reversing those containing both p0 and p_0, (3) if
needed, splits the aligned strings into two or more clusters, such
that within each cluster, any two strings match each other well and
(4) from each cluster, computes the consensus string with respect
to the amino acid scores, and possibly eliminates its unreliable ter—
minal amino acids, and corrects the inner amino acids of the

91% ‘09 1sn3nv uo sepﬁuv soq ‘121u10111123 10 Amie/(run 112 /§.IO'SIBLLIHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 11101; pep1201umoq

K. Vyatkina et al.

 

I Start I

"I

 

A set JV of de none strings

 

 

 

initialize the set A
of aggregated strings: A := Ii

 

 

 

Initialize the set I
of aetive strings: I := N

 

 

 

 

 

1
Form the set iCI of all is—nlers

 

(if the strings from I

 

 

 

 

 

Select the. top-searing iii-mer Inn E 1C1

 

 

 

 
 

Score(pg) 23- MinSoore

   

 

Form the set J I; I of strings

 

 

enntaining p“ or m

 

 

 

Align the strings from J

 

 

 

 

 

Cluster the aligned strings

 

 

 

 

1
From each cluster, Cﬂmpute 3.11

 

aggregated string and add it. to ,4

 

 

 

 

 

Replace in I the strings from J

 

 

with the new aggregatei'l strings

I
+

The set .A of aggregated strings

 

 

 

 

 

 

1
End

Fig. 2. Overview of the procedure generating the set of aggregated strings
from a set of de novo amino acid strings obtained using the Twister approach
(Vyatkina et al., 2015)

remaining string. As a result, a new aggregated string is obtained
from each cluster. These stages are illustrated in Figure 3, and de—
tailed description of the respective procedures is provided in
Supplementary Materials.

In case of ties at time of selecting an object (e.g. if two or more
k—mers have the highest score, while the top—scoring one is needed),
the first encountered is picked up.

The process terminates when the score of po drops below a cer—
tain threshold MinScore.

This general scheme is summarized in Supplementary Algorithm 1.

2.2.2 Assigning offsets
When the final set of aggregated strings has been obtained, each of
the latter gets endowed with a set of offsets (see Fig. 1c).

Consider an aggregated string a. Slightly abusing the notation,
we will also refer by a to its amino acid sequence. Let Ja Q N de—
note the set of strings, the alignment of which produced a. Let us
partition Ja into two subsets J2” and J?” of strings that became
part of the aligned string set in their original (direct) and reversed
form, respectively. Each string s E J :1” contributes to a a direct off—
dir
5

Suppose that b,- . . . b,-+k_1 is the first k—mer of s that matches a start—

set 0 obtained as follows. Let a = a1 . . .an, and let s : b1 . . . bm.
ing from position j, i.e. b,- . . . b,-+k_1 : a,- . . .aI-+k_1, where 1 g i g
m—k—l—l and lgjgn—k—l—l. Then of”=o(s)—l—
Mass(b1 . . . b,-_1) — Mass(a1 . . . aI-_1). The multiplicity Moi”) of of”
is calculated as the number of tags from T(s) that match a; note that
it may be smaller than ,u(s) : 

Similarly, each string s’ E J? imparts a a reversed offset associ—
ated with its end, which can be derived along with its multiplicity by
applying the above procedure to 3 and Q appropriately aligned
against each other.

In this way, an aggregated string a gets assigned two sets of off—
sets—those of direct and reversed ones; note that one of the two
may be empty.

Scaled and binned offsets. To be able to manage the offsets more
efficiently, we transform them into scaled offsets, which amounts to
multiplying each offset by a constant of the form 10,7 for a suffi—
ciently large 19 and rounding the obtained value to the nearest integer
(in our experiments, 19 = 4). A direct (resp., reversed) scaled offset oS
has multiplicity 11(05) that can be calculated as the sum of multiplic—
ities of the original direct (resp., reversed) offsets that got trans—
formed into 05. In addition, we maintain binned offsets representing
integers. For an offset 0, its corresponding binned offset ob is ob—
tained by rounding o to the nearest integer.

Consider a direct binned offset ob; let o1, . . . , og denote its re—
spective original direct offsets. We maintain for ob the list of direct
scaled offsets 051, . . . , 0:, corresponding to 01, . . . , 0g, respectively,
along with their multiplicities. The multiplicity Mob) of 019 is calcu—
lated as the sum 11(051) —l— - - - —l— “(02). Reversed binned offsets are
treated in a similar way.

Finally, we define the main direct and reversed offsets of a in the
following way. To obtain the main direct offset, or simply offset,
021” of an aggregated string a, we pick up the direct binned offset 019
of a of the highest multiplicity, then select its corresponding scaled
offset oS of the highest multiplicity, and let 0:1” : 05-10—17. The
main reversed offset, or simply reversed offset, of” is defined
analogously.

Protein mass estimation. For an aggregated string a that has
both direct and reversed offsets, we define the precursor mass esti-
mate (PME) induced by a as Ma : 03” —l— m(sa) —l— of”; the score of
dir

a

the latter is set to ,u(o ) - 140;”). A high score of Ma typically wit-
nesses correctness of a; in addition, repetitive PMEs likely corres-
pond to the intact masses of sufficiently well—represented proteins
from the sample being analyzed, possibly upon adjustment based on

expected PTMs.

9mg ‘09 1sn3nv uo sepﬁuv soq ‘BIUJOJIIBD aIo Amie/(run 112 /§.IO'S[BU.IT10[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pep1201umoq

Top-down analysis of protein samples

 

(a) PVGTQLNNTNYLLL (b)

GTQLS PVGTQLNNTNYLLL

SLQTG GTQLS

GTQLNN‘I‘NY GTQLNNTNY

YN‘I‘NNLQTG GTQLD

GTQLD —> GTQLNNT

GTQLNN‘I‘ GTQL

ZEEQTG VGTQLNEM'I‘QS
PVGTQLDLQ

VGTQLNEM'I‘QS

PVGTQLDLQ I

(d) VGTQLNNTNYLLL
PVGTQLN
PVGTQLNNTNY

VGTQL

VGTQLNNTNYL
PVGTQLNN

VGTQLN

VGTQ

VGTQ

VGTQL

VGTQ

VGTQL

 

I I

C
( ) PVGTQLNNTNYLLL
GTQLNNTNY

(1 ) GTQLNN‘I‘ (2 ) VGTQLNEM'I‘QS

GTQL
PVGTQLDLQ

VGTQ
VGTQ

l VGTQLNNTN

PVGTQLNNTNYLLL
GTQLS 1

u
GTQLD I
PVGTQLNNTNYLLL

Fig. 3. (a—c) Processing the alemtuzumab dataset: handling the 4—mer ‘GTOL' with the score 8. (a) The set of active strings containing ‘GTOL' or ‘LOTG'. (b) The
aligned strings (duplications due to string reversal are not shown). (c) Clusterization: the string ‘VGTQLNEMTOS' did not match well the main string
‘PVGTOLNNTNYLLL', and gave rise to the second cluster; each of the strings ‘GTOLS' and ‘GTOLD’ produced one mismatch when being aligned against
‘PVGTOLNNTNYLLL' or ‘VGTOLNEMTOS’, and thus, both were placed in the third cluster. (d) The aggregated string with the amino acid sequence
‘PVGTOLNNTNYLLL' (at the bottom) was obtained at time of processing the 4-mer ‘VGTO' with the score 25. The first four amino acids of its underlying consen-
sus string ‘SDLSPVGTOLNNTNYLLL’ were eliminated by the validation procedure. Incorrect candidate amino acids in the aligned strings are marked gray (the
amino acid scores are not shown). A 4-mer being processed and its reversed copy are highlighted

3 Results

We implemented our method in Java and benchmarked it on the
top—down datasets for the light chain of alemtuzumab and CAH2
published in (Vyatkina et al., 2015 ). In either case, the input spectra
were deconvoluted using MS—Deconv (Liu et al., 2010), and a list N
of de novo amino acid strings was generated with the Twister algo—
rithm from (Vyatkina et al., 2015 ) using the default parameters (tag
length: 4; mass tolerance: 4 mDa; peak reflection applied to individ—
ual deconvoluted spectra, and water loss ions eliminated prior to tag
generation). The resulting aggregated strings for the CAH2 and ale—
muzumab datasets are listed in the supplementary file Aggregated—
strings.xls.

3.1 Parameter selection

The proposed method depends on two parameters: the tag length [a
and the threshold MinScore on the score of a k—mer to be processed
(see Supplementary Algorithm 1). The former needs to be the same
as used for de novo strings generation following the approach from
(Vyatkina et al., 2015 ); a reasonable choice of [a should imply that
duplications are unlikely to occur among the tag strings and their re—
versed copies. The experimental results we report on were obtained
for the tag length [a = 4.

Observe that if MinScore is set to 1, each de novo string from N
will contribute to some aggregated string from A. In our experi-
ments, we let MinScore:2, so that the ‘least confirmed’ de novo
strings would be left out.

3.2 CAH2

From the CAH2 dataset, 70 aggregated strings were derived. The
ones that induce high—scoring PMEs represent or incorporate long
sequence fragments of either CAH2 or a contaminant protein. The
native—i.e. coming from bovine erythrocytes—contaminants com—
prise ubiquitin, phosphatidylethanolamine-binding protein, ﬂavin
reductase, cytochrome b5, hemoglobin alpha chain, ribonuclease
UK114-like, Cu/Zn superoxide dismutase, and thymosin beta 4—like,
and the extraneous ones—50S ribosomal protein L7/L12, 50S ribo—
somal protein L9, and cold—shock protein GroES from Shewanella,
alcohol dehydrogenase from S. cerevisiae, and a mouse cytochrome c
oxidase subunit 7B. All the identifications could be made by

searching long enough amino acid sequences of the obtained aggre—
gated strings against the non—redundant database using BLAST
(Altschul et al., 1990), except for Cu/Zn superoxide dismutase and
thymosin beta 4—like, identification of which was sustained by the
analysis of the initial de novo strings described in detail in (Vyatkina
et al., 2015 ). In particular, the extraneous contaminants could be
immediately attributed to the experiments previously carried out on
the same instrument. Subsequently, shorter amino acid sequences
were matched against the CAH2 and contaminant sequences to de—
cide on their originality.

The sequence coverage of CAH2 with the matching fragments
of the aggregated strings, as compared to that induced by the initial
de novo strings, decreased from 173 to 146 out of 260 amino acids
(i.e. from 66.54 to 56.15%); see Supplementary Figure 1a. The 50—
aa long gap in the coverage—from P—137 to N—186—hints that
most spectra coming from CAH2 were actually acquired from its
fragments rather than the entire protein. This is consistent with the
fact that each of the PMEs brought forth by the aggregated strings
originating from CAH2 is substantially smaller than the theoretical
mass of 29 095.717 Da of the latter, except for the one of 45
846.421 Da induced by the 3rd aggregated string. In particular, the
main offsets and PMEs induced by the 1st, 4th, 6th, 18th, 34th and
57th aggregated strings attributed to CAH2 immediately suggest
that several underlying spectra of those were due to its C—terminal
peptide ‘PNVLDYWTYPGSLTTPPLLESVTWIVLKEPISVSSQQM
LKFRTLNFNAEGEPELLMLANWRPAQPLKNRQVRGFPK,’ N—
terminal peptides ‘MSHHWGYGKHNGPEHWHKDFPIANGER
QSPVDIDTKAVVQDPALKPLALVYGEATSR’ and ‘MSHHW
GYGKHNGPEHWHKDFPIANGERQSPVDIDTKAVVQDPALKP
LAL’ (upon N-terminal methionine truncation and serine acetyl—
ation) and internal peptides ‘GEATSRRMVNNGHSFNVEYD
DSQDKAVLKDGPLTGTY,’ ‘RLVQFHFHWGSSDDQGSEHTV
DRKK,’ and ‘RLVQFHFHWGSSDDQGSEHTVDRKKYAAELHL
VHWNTK,’ respectively. However, this assumption should be
treated with caution, since the two main offsets of an aggregated
string may be defined by two distinct sets of spectra. This is illus—
trated by the 2nd aggregated string, the main direct and reversed
offset of which was derived from CID/HCD and ETD spectra, re—
spectively; as a consequence, the resulting PME exceeds by
approximately 17.023 Da the theoretical mass of the

91% ‘09 1sn3nv uo sepﬁuv soq ‘BIUJOJIIBD aIo Amie/(run 112 /§.IO'S[BU.IT10[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pep1201umoq

K. Vyatkina et al.

 

peptide ‘MSHHWGYGKHNGPEHWHKDFPIANGERQSPVDI
DTK’ matched by the main offsets (again assuming N—terminal me—
thionine truncation and serine acetylation, which caused the amino
acid ‘E’ with the mass equal to that of acetylated serine to show up
instead of the dimer ‘MS’ in the 2nd aggregated string). Thus, a
more accurate interpretation would be to say that peptides starting
and ending at the same locations in the CAH2 sequence as the
above—listed ones must have appeared in the sample as degraded
products.

Note that among the direct offsets with the second—highest multi—
plicity of the 3rd aggregated string, there is a one of 25 399.735 Da,
which together with the main reversed offset of 1735.007 Da would
lead to the PME of 29 005.646 Da differing by approximately 1Da
from the theoretical mass of 29 006.687 of CAH2 upon N—terminal
methionine truncation and serine acetylation (this discrepancy can
be attributed to i 1 Da errors that commonly occur during deconvo—
lution). Here, the confusion between the wrong and correct offset
value is partially due to low multiplicities of both candidates: 10
and 5, respectively. However, a more thorough analysis could allow
for selecting the correct one. First, the (incorrect) direct offset of 42
240.511 Da is due to a single spectrum (HCD, SCANS :2318), for
which the precursor charge was determined at time of deconvolution
as 57. This abnormally large charge state suggests there is an error
both in the precursor charge and precursor mass for this spectrum,
and the latter leads to incorrect offsets associated with the tags
determined by reﬂected counterparts of the original peaks, which
give rise to the direct offset being examined. Second, the correct off—
set of 25 399.735 Da is supported by 4—tags derived from two dis—
tinct spectra (HCD, SCANS : 2326 and 2329), while any other
candidate offset is sustained by tags from a single spectrum.

The precursor mass estimates of 14 174.47, 14 174.493 and
14 174.454 Da induced by the 16th, 32th and 40th aggregated
strings, respectively, closely match the theoretical mass of 14
174.491 Da of ribonuclease UK114—like, to which they are attrib—
uted, upon N—terminal methionine truncation and serine acetylation.
In particular, this validates identification of the latter two aggre—
gated strings, either being too short on its own to allow for a mean—
ingful analysis via BLAST search. On the other hand, these
observations together provide an evidence of the presence in the
sample of ribonuclease UK1 14—like modified as stated above.

Similarly, the 8th, 9th and 30th aggregated strings produce the
PMEs of 8575.626, 8575.61 and 8575.631 Da, respectively, which
accurately match the theoretical mass of 8575 .616 Da of bovine ubi—
quitin upon N-terminal methionine oxidation, and thus, indicate its
presence in the sample. At the same time, this certifies the origin of
the short, and not fully correct, 30th aggregated string. Moreover,
the 5th aggregated string gives the PME of 8559.618 Da, which
closely approximates the mass of 8559.621 Da of unmodified ubi—
quitin, implying this form is observed as well. Interestingly, its direct
offset with the second—highest multiplicity, equal to 5273.847 Da,
leads to the PME of 8289.466 Da, and points to yet another form of
ubiquitin—and namely, the one without the C—terminal ‘RGG’, the
theoretical mass of which is 8289.477 Da.

3.3 Fab region of alemtuzumab

From the alemtuzumab dataset, 92 aggregated strings were gener—
ated. Through a BLAST search of their amino acid sequences against
the non—redundant database, two contaminants could be identified,
and namely, 50S ribosomal protein L29 from Synechococcus sp.
PCC 7002, and 30S ribosomal protein S17 from Synechococcus.
Moreover, based on the analysis of the original de novo strings

presented in (Vyatkina et al., 2015 ), we attributed three aggregated
strings to a mouse Amy1 protein. As in the case of CAH2, the extra—
neous contaminants were due to the previous experiments.

The matching fragments of the de novo strings together covered
177 (82.71%) out of 214 amino acids of the light chain, and only 7
amino acids were lost when we switched to the aggregated strings,
which thus led to the coverage of 170 (79.44%) amino acids
(Supplementary Figure S1b). Not surprisingly, we could also obtain
an accurate PME for this protein: the PMEs of
23 554.87,23 553.861 and 23 553.876 Da induced by the 1st, 6th
and 9th aggregated string, respectively, closely match the theoretical
mass of 23 556.703 Da of the light chain of alemtuzumab, while the
discrepancies can be attributed to i1 Da errors at time of deconvo—
lution, and imperfect reduction (the contribution of one remaining
disulphide bond would be approximately —2.016 Da).

On the contrary, the coverage of the Fd region of the heavy chain
with the matching fragments of the de novo strings was modest,
comprising only 157 (68.86%) out of 228 amino acids, and upon
generation of the aggregated strings, it was reduced down to 112
(49.12%) amino acids (Supplementary Figure S1c). Similarly to the
case of CAH2, long gaps occur in the coverage, again meaning that
many spectra originated from sequence fragments rather than the in-
tact protein, and this is consistent with the PMEs reported by
Twister. For example, the 4th and 5th aggregated string attributed
to this protein induce the PME of 6645.354 and 6645.367 Da, re—
spectively, thus indicating that several underlying spectra were
acquired from its N—terminal peptide ‘QVQLQESGPGLVRPSQTL
SLTCTVSGFTFTDFYMNWVRQPPGRGLEWIGFIRDKAKGYT’
with a pyroglutamic acid instead of N—terminal glutamine.

Finally, the 11th and 47th aggregated string gives rise to the
PME of 7874.359 and 7874.351 Da, respectively, which accurately
approximate the theoretical mass of 7875.344 Da of 5 0S ribosomal
protein L29 from Synechococcus upon truncation of N—terminal me—
thionine and oxidation of the second methionine at position 57,
assuming errors of —1Da occurred during deconvolution.

4 Discussion

We have introduced a method for combining de novo sequence frag—
ments, retrieved from deconvoluted top—down MS/MS spectra using
our approach described in (Vyatkina et al., 2015), into the aggregated
strings endowed with direct and reversed offsets. This gives us longer
parts of sequences of proteins sufficiently well—represented in the sam-
ple, and helps to promptly focus our attention primarily on those.

The main offsets of the aggregated strings often appropriately re—
ﬂect their location in the sequence of the respective protein, and can
serve to obtain an accurate intact mass estimate of a target protein,
decide on which out of a few candidate proteoforms is contained in
the sample, or facilitate characterization of the PTMs present in the
protein being analyzed. We emphasize that the second and third
tasks can be accomplished even without explicit evidence in the in-
put spectra of the amino acids that differ between distinct proteo—
forms, or of the respective PTMs. Importantly, thereby an
aggregated string with a very short, and not informative on its own,
amino acid sequence can also be of true value.

On the other hand, the input MS/MS data may sometimes allow
to quickly and unambiguously locate a PTM detected in this way.
The proposed method can be further adjusted so as to solve this
problem as well.

A careful analysis of the entire sets of direct and reversed offsets
associated with the obtained aggregated strings can potentially

9mg ‘09 1sn3nv uo sejeﬁuv soq ‘BIUJOJIIBD aIo Amie/(run 112 /§.IO'S[BU.IT10[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pep1201umoq

Top-down analysis of protein samples

 

provide further insight into the composition of the sample; we con—
sider development of algorithms for this purpose as one of the subse—
quent tasks to be addressed. Alternatively, one can manually browse
through the input de novo strings—each with a single associated off—
set—that correlate well with the aggregated strings of interest, to
gain additional information about the respective proteins.

Our present work constitutes a next step towards complete de
novo sequencing of proteins from top—down spectra alone, for which
purpose, to the best of our knowledge, no methods exist so far.
While the current limitations of the top—down technology in general
would prevent the proposed approach from retrieving the entire pro—
tein sequence, since the latter is typically not fully covered even with
short tags, the aggregated strings can undoubtedly serve as an excel—
lent base for the full reconstruction. However, achieving this goal
will require more algorithmic developments, thus providing yet an—
other promising direction for future research.

Funding

This work was supported by Government of Russian Federation
[11.G34.31.0018 to K.V., P.A.P. until December 2014], Russian Science
Foundation [14-50-00069 to K.V., P.A.P., since February 2015] and the
Netherlands Organization for Scientific Research [93511034 to L.].M.D.,


Conﬂict of Interest: none declared.

References

Altschul,S.F. et al. (1990) Basic local alignment search tool. ]. Mol. Biol, 215,
403—410.

Bandeira,N. et al. (2004) Shotgun protein sequencing by tandem mass spectra
assembly. Anal. Cbem., 76, 7221—7233.

Bandeira,N. et al. (2007) Shotgun protein sequencing: assembly of peptide tan-
dem mass spectra from mixtures of modiﬁed proteins. Mol. Cell.
Proteomics, 6, 1123—1134.

Bandeira,N. et al. (2008) Automated de novo protein sequencing of monoclo-
nal antibodies. Nat. Biotecbnol., 26, 1336—1338.

Bertsch,A. et al. (2009) De novo peptide sequencing by tandem MS using com-
plementary CID and electron transfer dissociation. Electrophoresis, 30,
3736—3747.

Bondarenko,P.V. et al. (2009) Mass measurement and top-down HPLC/MS
analysis of intact monoclonal antibodies on a hybrid linear Quadrupole Ion
TrapOrbitrap Mass Spectrometer. ]. Am. Soc. Mass Spectrom., 20,
1415—1424.

Castellana,N.E. et al. (2010) Template proteogenomics: sequencing whole
proteins using an imperfect database. Mol. Cell. Proteomics, 9, 1260—1270.

Chi,H. et al. (2010) pNovo: De novo peptide sequencing and identiﬁcation
using HCD spectra. ]. Proteome Res., 9, 2713—2724.

Chi,H. et al. (2013) pNovo—l—z de novo peptide sequencing using complemen-
tary HCD and ETD tandem mass spectra. ]. Proteome Res., 12, 615—625.

Dancik,V. et al. (1999) De novo peptide sequencing Via tandem mass spec-
trometry.]. Comput. Biol., 6, 327—342.

Datta,R. and Bern,M. (2008) Spectrum fusion: using multiple mass spectra for
de novo peptide sequencing. In: Vingron,M. and Wong,L. (eds.) Research in
Computational Molecular Biology, Lect. Notes Comput. Sci., vol. 4955,
Springer, Berlin, Heidelberg, pp. 140—153.

Frank,A. and Pevzner,P. (2005 ) Pepnovo: de novo peptide sequencing Via
probabilistic network modeling. Anal. Cbem., 77, 964—973.

Fornelli,L. et al. (2012) Analysis of intact monoclonal antibody IgG1 by elec-
tron transfer dissociation Orbitrap FTMS. Mol. Cell. Proteomics, 11,
175 8—1 767.

Guthals,A. et al. (2013) Sequencing-grade de novo analysis of MS/MS triplets
(CID/HCD/ETD) from overlapping peptides. ]. Proteome Res., 12,
2846—285 7.

He,L. and Ma,B. (2010) Adepts: advanced peptide de novo sequencing with a
pair of tandem mass spectra.]. Bioinf. Comput. Biol., 8, 981—994.

Horn,D.M. et al. (2000) Automated de novo sequencing of proteins by tandem
high-resolution mass spectrometry. Proc. Natl. Acad. Sci. U. S. A., 97,
10313—10317.

Kellie,].F. et al. (2010) The emerging process of Top Down mass spectrometry
for protein analysis: biomarkers, protein-therapeutics, and achieving high
throughput. Mol. Biosyst., 6, 1532—1539.

Liu,X. et al. (2009) Automated protein (re)sequencing with MS/MS and a
homologous database yields almost full coverage and accuracy.
Bioinformatics, 25, 2174—2180.

Liu,X. et al. (2010) Deconvolution and database search of complex tandem
mass spectra of intact proteins: A combinatorial approach. Mol. Cell.
Proteomics, 9, 2772—2782.

Liu,X. et al. (2014) De novo protein sequencing by combining top-down and
bottom-up tandem mass spectra. ]. Proteome Res., 13, 3241—3248.

Ma,B. et al. (2003) Peaks: powerful software for peptide de novo sequencing
by tandem mass spectrometry. Rapid Commun. Mass Spectrom, 17,
2337—2342.

Ma,B. (2015 ) Novor: real-time peptide de novo sequencing software. ]. Am.
Soc. Mass Spectrom., 26, 1885—1894.

Mann,M. and Wilm,M. (1994) Error-tolerant identiﬁcation of peptides in
sequence databases by peptide sequence tags. Anal. Cbem., 66,
4390—4399.

Pevzner,P. et al. (2004) De novo repeat classiﬁcation and fragment assembly.
Genome Res., 14, 1786—1796.

Robotham,S.A. et al. (2016) UVnovo: a de novo sequencing algorithm using
single series of fragment ions Via chromophore tagging and 351 nm ultravio-
let photodissociation mass spectrometry. Anal. Chem, doi:10.1021/
acs.analchem.6b00261.

Savitski,M. et al. (2005) New data base-independent, sequence tag-based scor-
ing of peptide MS/MS data validates mowse scores, recovers below thresh-
old data, singles out modiﬁed peptides, and assesses the quality of MS/MS
techniques. Mol. Cell. Proteomics, 4, 1180—1 188.

Taylor,].A. and Johnson,R.S. (1997) Sequence database searches Via de novo
peptide sequencing by tandem mass spectrometry. Rapid Commun. Mass
Spectrom., 11, 1067—1075.

Vyatkina,K. et al. (2015 ) De novo sequencing of peptides from top-down tan-
dem mass spectra. ]. Proteome Res., 14, 4450—4462.

91% ‘09 1sn3nv uo sejeﬁuv soq ‘BIUJOJIIBD aIo Amie/(run 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pep1201umoq

