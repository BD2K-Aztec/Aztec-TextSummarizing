APPLICA TIONS NOTE V°" 33.5%.53923322532353113???

 

Genome analysis

Advance Access publication July 29, 2014

Trowel: a fast and accurate error correction module for Illumina

sequencing reads

Eun-Cheon Lim", Jonas MUller, Jorg Hagmann, Stefan R. Henz, Sang-Tae Kim and

Detlef Weigel*

Department of Molecular Biology, Max Planck Institute for Developmental Biology, 72076 Tiibingen, Germany

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: The ability to accurately read the order of nucleotides in
DNA and RNA is fundamental for modern biology. Errors in next-
generation sequencing can lead to many artifacts, from erroneous
genome assemblies to mistaken inferences about RNA editing.
Uneven coverage in datasets also contributes to false corrections.
Result: We introduce Trowel, a massively parallelized and highly
efficient error correction module for Illumina read data. Trowel both
corrects erroneous base calls and boosts base qualities based on the
k—mer spectrum. With high-quality k—mers and relevant base informa-
tion, Trowel achieves high accuracy for different short read sequen-
cing applications.The latency in the data path has been significantly
reduced because of efficient data access and data structures. In per-
formance evaluations, Trowel was highly competitive with other tools
regardless of coverage, genome size read length and fragment size.
Availability and implementation: Trowel is written in C++ and is
provided under the General Public License v3.0 (GPLv3). It is available
at http://trowe|—ec.sourceforge.net.

Contact: euncheon.lim@tue.mpg.de or weigel@tue.mpg.de
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 24, 2013; revised on July 8, 2014; accepted on
July 23, 2014

1 INTRODUCTION

Reads produced by current next-generation sequencing technol-
ogies typically suffer from relatively high base error rates. To
improve downstream analyses, it is desirable to correct sequen-
cing errors directly after base calling. The most widely applied
error correction methods rely on k-mer spectrum-based algo-
rithms, following the spectral alignment (SA) approach
(Pevzner et al., 2001). A k-mer occurring more often than a
given threshold is called solid (or ‘trusted’) and a less frequent
k-mer is named weak. The goal of the SA approach is to maxi-
mize the number of solid calls. Quake (Kelley et al., 2010), a
widely used error correction module, applies a mixed model of
the distributions of solid and weak calls incorporating quality
values. It identiﬁes the set of corrections that maximizes the
number of k-mers using a maximum likelihood approach.
Another k-mer—based method, Musket (Liu et al., 2013), uses

 

*To whom correspondence should be addressed.

two-stage corrections with similarity to Trowel’s two methods.
Musket corrects bases depending on frequencies of k-mers and
does not use base qualities. Coral (Salmela and Schroder, 2011)
collects similar reads into groups and performs multiple align-
ments on them. It can correct indels by using the Needleman—
Wunsch algorithm. Owing to the alignment complexity,
this method is not favorable for large datasets. Yet, another
approach is to build a sufﬁx array or trie. For example,
Hybrid SHREC (Salmela, 2010) can correct indels by detecting
and replacing low-weight nodes. The weight of a node indicates
the number of cohort edges in a sufﬁx trie. Here, we introduce a
new k-mer—based error correction module, Trowel, suitable for
Illumina datasets. The key difference to other tools is that
instead of relying on the uniformity of sequencing coverage,
which ﬂuctuates stochastically or inherently, Trowel trusts
in sequences with continuously high-quality values. We demon-
strate the accuracy and efﬁciency of Trowel with several
datasets and compare it with other available read correction
tools.

2 METHOD

Unlike other methods, Trowel solely relies on quality values to identify
solids. Trowel selects a quality threshold, q‘, such that all k-mer bases
with a quality of q‘ or higher represent at least 8% (empirical) of the
entire dataset. These solids are called bricks, i.e. consecutive stretches of
high-quality bases (Zq‘) and are stored in the brick index as keys. We
sequentially make use of two brick indices with different k—mer compos-
itions. To each key, the ﬁrst index associates high-quality bases enclosed
by two bricks. The Double Bricks & Gap (DBG) algorithm exploits an
asymmetric kI-gap-kz structure, where gap is a single base, k = k1+k2.
This k-mer structure has advantages over symmetrical or single k-mer
patterns at repeat element boundaries (Supplementary Fig. S7). The qual-
ity of a gap is boosted to the maximum quality value when the index
relevant to gap-enclosing bricks contains the gap with high quality. The
gap is corrected to another base when it is uniquely associated with a
different high-quality base (Supplementary Fig. S6). Initially, the
high-quality regions in the raw reads are usually fragmented
(Supplementary Fig. S4), and hence, only a limited number of trusted
k—mers can be used. Owing to the quality boosting (Supplementary Fig.
S5), the brick index is iteratively expanded, leading to better sensitivity.
Finally, because bases at read ends cannot be accessed by the described
brick index, the second algorithm, Single Brick & Edges (SBE), uses a new
edge-k—edge index to correct edges, where an edge is a single base, or
increase their quality values as in the DBG algorithm. Full details are
explained in Supplementary Data.

 

3264 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 [glO'SIBILInO[p.IOJXO'SODBIIIlOJIITOTQ/ﬂ(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Trowel

 

Table 1. Sum-of-rank of performance metrics

 

 

>3
>3 a.) FD ":1 0
§ § '3? we I??? E?» D a»
g w an Ea as as E O
B m 8 33 no 8g 8g : g
0 a.) as H N a.) > m o m o 5
H 04 CG H13 (38 < o < o M 2
Uncorrected — — — 6 6 4 — —
Trowel 1 1 2 1 1 2 1 2
Coral 2 4 1 2 4 1 3 6
Musket 3 5 3 4 4 2 2 1
SOAPec 4 3 4 4 3 4 4 4
Quake 5 2 5 2 2 4 5 3
Assembler — — — — — — — 5

 

Note. The best in each column is highlighted in bold (see Supplementary Table S1.
for datasets information).

3 RESULTS

We performed our evaluations on paired-end Arabidopsis thali-
ana reads (86x) generated in—house and on Illumina datasets
referenced in Wang et al., 2012) for Escherichia coli (163—
618x), Staphylococcus aureus (691x), Saccharomyces cerevisiae
(319x) and Drosophila melanogaster (6—26x) (Supplementary
Table S1). We assessed runtime and accuracy in several applica-
tions, and summarized all local ranks of each metric in a sum-of-
rank table (Table 1). Trowel was scored consistently as one of the
top two tools and was among the two most accurate tools for
high-coverage datasets (Supplementary Section S4.1). Trowel has
a better performance than the other tools with genome assem-
blies on high-coverage datasets, while on low-coverage datasets,
the alignment-based tool Coral outperformed all other
k-mer—based methods including Trowel. When the coverage is
highly variable, i.e. for transcriptomes, the dataset is particularly
hard to correct because low-coverage sequences cannot be equa-
ted with higher likelihood of errors. In transcriptome mapping
evaluation for a human dataset Wang et al., 2011), SEECER (Le
at al., 2013) achieved the best performance (Supplementary
Section S2.3). Aside from this specialized tool, Trowel obtained
the best read accuracy, but was slightly worse in base accuracy
than Coral. Only Trowel improved transcriptome quantiﬁcation;
for the other tools including SEECER, the performance was
worse than the uncorrected cases. For SNP calling evaluations,
Trowel showed the highest concordance with high-coverage
datasets in three of four cases (Supplementary Section S2.4).
Finally, Trowel was the only tool that consistently generated
expected results with simulated datasets for an erroneous-base-
next-to-repeats problem (Supplementary Section S2.5).
Concerning runtime, Trowel outperformed all other tools for
all datasets, being up to 100 times faster (Table 2). Detailed re-
sults are provided in Supplementary Data.

4 CONCLUSION AND DISCUSSION

We have developed a new error correction module for Illumina
short reads, Trowel, which draws its power to correct bases solely

Table 2. Runtime of error correction modules (min)

 

 

Data Quake Coral Musket SOAPec Trowel
D1 261.1 43.9 4.1 130.5 2.9
D2 377.9 228.9 18.0 194.1 9.9
D3 119.8 36.6 8.8 91.8 3.7
D4 696.3 255.2 21.9 335.6 14.1
D5 262.2 156.0 26.0 186.4 6.4
D6_1 490.6 256.1 33.0 275.7 18.4
D6_2 243.3 105.5 15.7 137.5 8.4
D6_3 460.2 72.8 10.6 141.0 4.2
D6_4 359.9 50.0 8.0 96.9 3.1
D7 1088.2 886.7 145.4 595.6 40.0

 

Note. The fastest in each row is highlighted in bold (see Supplementary Table S1.
for datasets information).

from high-base qualities rather than coverage estimates. High-
base qualities are a requirement for datasets in practice, whereas
equally distributed coverage cannot always be expected depend-
ing on sequencing performance or quantitative datasets, e.g.
transcriptome studies. We assessed different error correction
tools on numerous commonly used applications for read map-
ping, resequencing, genome assembly and gene expression ana-
lyses. Trowel consistently obtained best or second-best accuracy
on all applications, while achieving on average 25 times faster
runtimes than the other tools. Only on genome assemblies from
low-coverage datasets (510x), an alignment-based method was
superior. In practice, the low-coverage problem is inevitable, and
further improvements for k-mer—based methods are possible.

ACKNOWLEDGEMENTS

The authors thank Christa Lanz for sequencing and Xi Wang for
making the A. thaliana dataset available.

Funding: This work was supported by the Max Planck Society.

Conflict of interest: none declared.

REFERENCES

Kelley,D.R. et al. (2010) Quake: quality-aware detection and correction of sequen-
cing errors. Genome Biol., 11, R116.

Le,H.S. et al. (2013) Probabilistic error correction for RNA sequencing. Nucleic
Acids Res, 41, 6109.

Liu,Y. et al. (2013) Musket: a multistage k-mer spectrum based error corrector for
Illumina sequence data. Bioinformatics, 29, 308—315.

Pevzner,P.A. et al. (2001) An Eulerian path approach to DNA fragment assembly.
Proc. Natl Acad. Sci. USA, 98, 9748—9753.

Salmela,L. (2010) Correction of sequencing errors in a mixed set of reads.
Bioinformatics, 26, 1284—1290.

Salmela,L. and Schr6der,J. (2011) Correcting errors in short reads by multiple
alignments. Bioinformatics, 27, 1455—1461.

Yang,L. et al. (2011) Genomewide characterization of non-polyadenylated RNAs.
Genome Biol., 12, R16.

Yang,X. et al. (2012) A survey of error-correction methods for next-generation
sequencing. Brief. Bioinform, 14, 56—66.

 

3265

112 [3.1081120an[p.IOJXO'SODBIIIlOJIIIOIQ/ﬂ(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

