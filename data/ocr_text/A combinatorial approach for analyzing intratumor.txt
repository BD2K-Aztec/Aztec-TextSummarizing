Vol. 30 ISMB 2014, pages i78—i86
doi:10. 1093/bioinformatics/btu284

 

A combinatorial approach for analyzing intra-tumor heterogeneity
from high-throughput sequencing data

Iman Hajirasouliha1 ’2’l, Ahmad Mahmoody1 ’l and Benjamin J. Raphaell’2’*
1Department of Computer Science and 2Center for Computational Molecular Biology, Brown University, Providence, RI,

02906, USA

 

ABSTRACT

Motivation: High-throughput sequencing of tumor samples has
shown that most tumors exhibit extensive intra-tumor heterogeneity,
with multiple subpopulations of tumor cells containing different som-
atic mutations. Recent studies have quantified this intra-tumor hetero-
geneity by clustering mutations into subpopulations according to the
observed counts of DNA sequencing reads containing the variant
allele. However, these clustering approaches do not consider that
the population frequencies of different tumor subpopulations are
correlated by their shared ancestry in the same population of cells.
Results: We introduce the binary tree partition (BTP), a novel com-
binatorial formulation of the problem of constructing the subpopula-
tions of tumor cells from the variant allele frequencies of somatic
mutations. We show that finding a BTP is an NP-complete problem;
derive an approximation algorithm for an optimization version of the
problem; and present a recursive algorithm to find a BTP with errors in
the input. We show that the resulting algorithm outperforms existing
clustering approaches on simulated and real sequencing data.
Availability and implementation: Python and MATLAB implementa-
tions of our method are available at http://compbio.cs.brown.edu/
software/

Contact: braphael@cs.brown.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

Cancer is a disease driven by somatic mutations that accumu-
late in the genome during the lifetime of an individual.
High-throughput sequencing technologies now provide an un-
precedented ability to measure these somatic mutations in
tumor samples (Ding et al., 2013). Application of these technol-
ogies to cohorts of cancer patients has revealed a number of new
cancer-causing mutations and cancer genes (Kandoth et al.,
2013; Lawrence et al., 2013; Vogelstein et al., 2013). Cancer
sequencing studies have also demonstrated that most tumors ex-
hibit extensive intra-tumor heterogeneity characterized by individ-
ual cells in the same tumor harboring different complements of
somatic mutations (Ding et al., 2012; Gerlinger et al., 2012; Nik-
Zainal et al., 2012; Schuh et al., 2012; Shah et al., 2012). Such
heterogeneity is a consequence of the fact that cancer is an evo-
lutionary process in a population of cells. The clonal theory of
cancer evolution (Nowell, 1976) posits that the cells of a tumor
descended from a single founder cell. This founder cell contained
an advantageous mutation leading to a clonal expansion of

 

*To whom correspondence should be addressed.
TThe authors wish it to be known that in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

a large population of cells descended from the founder.
Subsequent clonal expansions occur as additional advantageous
mutations accumulate in descendent cells. A sequenced tumor
sample thus consists of multiple subpopulations of tumor cells
from the most recent clonal expansions (Fig. 1).

Nearly all cancer sequencing efforts thus far sequence DNA
from a single sample of a tumor at a single time. This is because
of technical limitations: the most cost-effective DNA sequencing
technologies (e.g. Illumina) require input DNA from many
tumor cells, and such samples are typically available only when
patients undergo surgery (Occasionally, paired samples from two
time points, such as a primary tumor and a metastasis, are also
sequenced). While sequencing of multiple samples from the same
tumor (Gerlinger et al., 2012; Newburger et al., 2013; Salari
et al., 2013) or single-cell sequencing (Hou et al., 2012; Navin
et al., 2011; Xu et al., 2012) might eventually provide even better
datasets to assess intra-tumor heterogeneity, technical consider-
ations have limited their applicability utility thus far. Thus, there
is tremendous interest in methods that infer the relative propor-
tion of different subpopulations of tumor cells in a single sample.

Several recent studies (Ding et al., 2012; Nik-Zainal et al.,
2012; Shah et al., 2012) have demonstrated that it is possible
to infer the subpopulations of tumor cells by counting the
number of DNA sequence reads that contain a somatic muta-
tion. For single-nucleotide mutations, or variants, the variant
allele frequency ( VAF) is deﬁned as the fraction of DNA
sequence reads covering the variant position that contains the
variant allele rather than the reference/ germ line allele. The VAF
provides an estimate of the fraction of tumor chromosomes con-
taining the mutation, but with error due to the stochastic nature
of the sequencing process (Fig. 1). In addition, technologies cur-
rently used in cancer sequencing studies produce short reads that
rarely contain more than one somatic mutation. Thus, for any
pair of somatic mutations, the only information available to
distinguish their subpopulation of origin is the VAF.

To overcome substantial variability in measured VAFs, a
common approach is to cluster VAFs and from these clusters
infer the number and proportion of various subpopulations of
tumor cells in the sample. A number of techniques have been
introduced to perform this clustering, with Dirichlet Process
Mixture models and related non-parametric models being par-
ticularly popular, as they do not fix the number of clusters in
advance (Miller et al., forthcoming; Nik-Zainal et al., 2012; Shah
et al., 2012). VAF clusters correspond to tumor subpopulations,
and the cellular fraction, or fraction of tumor cells containing
the cluster of somatic mutation, is derived from the VAF of
the clusters. In the simplest case, the VAF directly determines
the cellular fraction: e. g. a cluster with VAF = 0.5 corresponding
to homozygous mutations in 50% of tumor cells, or

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

1e /310's113u1no [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

A combinatorial approach for analyzing intra-tumor heterogeneity

 

 

 

 

l
I
 / . I g  ‘. 33.7570
/ \ 33.75% :35 /
. \
3 b 60% |§ . 60%
100% \. 26'25%  ‘- / \ ° 26 25°/
0 100% \ - 0
I E <:>
O
‘ 40% IE
7 \ 40%
Time (cell divisions) u
86 uenCI-n the sam 16 & estimating subpopulation
q 9 p :> frequencies

obtaining variant allele frequency data

 

       

Number of Mutations V

 

1o 20 ’30 ’ 40

l I | J l

Variant Allele Frequency (VAF)

50 60 70 80 90 1

Frequencies of Mutations

Fig. 1. (a) The cells in a tumor descend from a single founder cell via multiple waves of clonal expansion. Each circle represents a population, each dot
corresponds to a mutation and the shaded sections indicate the cells descended from each founder cell of the clonal expansion. (b) Under mild
assumptions, these clonal expansions give rise to a BTP, with nodes representing populations of tumor cells with speciﬁc subsets of somatic mutations.
(c) The variant allele frequencies (VAFs) of somatic mutations are determined from sequencing data and used to infer tumor subpopulations and/or the
BTP. Here the clusters correspond to clonal expansions, and center of each cluster estimates the frequency of the newly formed subpopulation (denoted
with colored marker). Note that the size of each cluster depends on the number of mutations that accumulate before its expansion

heterozygous mutations in 100% of tumor cells. However, in
practice, the inference of cellular fraction is complicated by
copy number aberrations and normal admixture (percentage of
the tumor sample that is normal cells), and these two factors are
themselves correlated (Carter et al., 2012; Oesper et al., 2013;
Strino et al., 2013). We will not consider such complications
here; rather we restrict attention to heterozygous somatic muta-
tions outside of copy number aberrations; assumptions that were
made in sequencing studies including Ding et al. (2012).

With two exceptions (Jiao et al., 2014; Strino et al., 2013),
current techniques for clustering VAFs treat each subpopulation
independently and do not consider that these frequencies are
correlated by the fact that they are partitions of the same cellular
population. Thus, these approaches do not explicitly construct
an evolutionary history of the accumulated somatic mutations in
the cells. Strino et al. (2013) performs a heuristic search over
possible trees, and we discuss Jiao et al. (2014) below.

Contributions. In this article, we formulate the problem of infer-
ring subpopulations of tumor cells from VAF data obtained from
a single tumor sample as the combinatorial problem of construct-
ing a Binary Tree Partition { BT P ). We show that the problem of
ﬁnding a BTP is NP-complete and present a % — o(1)-approxima—
tion algorithm for a related max -BTP problem. The approxima-
tion algorithm is based on Local Search and we use the
well-known packing bound of Hurkens and Schrijver (1989) for
the purpose of analysis. Next, we deﬁne e-BTP, a generalization of
the BTP problem that allows for the possibility that VAFs are
observed with errors and some VAFs are not observed. We pre-
sent a straightforward recursive algorithm to ﬁnd an c-BTP and

show that this algorithm outperforms existing VAF clustering
approaches on simulated and real data. This recursive algorithm
is fast in practice and runs in less than a minute, on a single CPU,
for each of our simulated or real samples.

2 TUMOR SUBPOPULATIONS AND THE BTP

In this section, we formulate the problem of determining tumor
subpopulations from VAF clusters. The clonal theory of cancer
evolution proposes that the cancerous cells in a tumor are the re-
sult of multiple waves of somatic mutation and clonal expansion.
Given the relationship between sequence coverage (1000—
10 000x for targeted studies) and number of tumor cells that
are sequenced in a tumor sample (millions), we ﬁrst assume
that any somatic mutation reported in the data must be present
in an appreciable fraction of tumor cells. This implies that the
observed somatic mutations were present in at least one clonal
expansion. Second, as in other recent studies (Jiao et al., 2014;
Salari et al., 2013), we assume that somatic mutations follow the
inﬁnite sites assumption such that at most one single mutation
occurs at a genomic locus (e. g. single position) during the evolu-
tion of the tumor. It follows from this assumption that if a mu-
tation ,6 occurs in a tumor cell subsequent to a mutation 05, then
the fraction of cells containing mutation or must be at least as
large as the fraction of cells containing ,8. This condition was also
recently noted in Jiao et al. (2014).

We assume that at any particular time in the cancer progres-
sion at most one cell in the tumor population acquires a new
mutation leading to a clonal expansion. We emphasize that

 

i79

1e /310's113u1no [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

I.Hajirasouliha et al.

 

this assumption restricts only the number of clonal expansions
that begin at a given time and not the number of clonal expan-
sions that are ongoing at one time. Under this assumption, each
clonal expansion splits the present tumor cell population into
exactly two subpopulations: the subpopulation P of cells con-
taining the newly acquired somatic mutation and the subpopula-
tion P’ of cells without the mutation (and possibly with a
different set of new mutations occurring later in time). Thus,
the ancestral history of the sequenced tumor cell population is
represented by a rooted binary tree with nodes corresponding to
populations of cells at each clonal expansion, and edges indicat-
ing the ancestral relationships between these populations.
Consequently, each node v in the tree has a set M, of somatic
mutations that accumulate along the unique edge p, that con-
nects v to its parent (As the root r does not have a parent, the set
M, represents the somatic mutations that accumulate before the
ﬁrst clonal expansion. Alternatively, we can let p, be a hidden
edge that connects the founder cell of the tumor (represented by
the root r) to the normal cell from which it is derived). Each
node v also has a frequency a, representing the proportion of
sequenced tumor cells with mutations M, (Fig. 1). Note that
most tumor samples contain admixture by normal cells with
no detectable somatic mutations, and thus in general a,<1.
A consequence of these assumptions is that every internal node
v in the tree satisﬁes the children sum to parents (CSP) condition:
Zuchﬂd of, au = a,. We make the following deﬁnition:

DEFINITION 1.. Given a multiset E = {a1, . . . , a,,} with 0 < a,- g l, a
BTP for E is a complete rooted weighted binary tree T = (V,E)
with nodes V= {v1, . . . , vn} such that v,- has weight a,- and every

internal node satisﬁes the CSP condition.

Figure 1 shows a simple example of a complete binary tree in
which the CSP conditions are satisﬁed for every internal node
(also see Supplementary Appendix D.6 for a more general ex-
ample). Recall that a complete rooted binary tree is a binary tree
wherein there is a unique node of degree 2 (the root), and every
node in the tree is either a leaf or has exactly two children. Our
goal is to construct such a tree from the measured VAF data. We
deﬁne the following.

DEFINITION 2 (BTP problem). Given a multiset E = {a1, . . . , an},
ﬁnd a BTP for E if one exists.

Note that in some cases, at the split deﬁned by a clonal
expansion, cells from P’ may survive to the present, without
undergoing additional clonal expansions (e.g. such cells may
cease dividing, or senesce). In this case, there are no mutations
that exclusively occur in P’. We discuss this case in Section 5
below.

3 COMPLEXITY OF THE BTP PROBLEM

In this section, we outline the proof of the following theorem.
THEOREM 3. The BT P problem is NP—complete.

The proof of this theorem relies on the idea of ﬁnding a set of
conflict-free triangles in the multiset E. This idea is also useful
below for deriving an approximation for a related problem of
ﬁnding a max -BTP, and so we now deﬁne the relevant concepts.

Suppose E= {a1, . . . , an} is a multiset of n elements. For any
distinct i, j and k such that a,- + a, = ak, we deﬁne the ordered
pair (k, {i,j}) as a triangle in the multiset. See Supplementary
Appendix Al for an example. We call k as the peak of the tri-
angle and i, j as the tails of the triangle.

We say that triangles t=(k, {i,j}) and t’=(k’, {i’,j’}) are in
conflict if k = k’ or {i,j} ﬂ {i’,j’} 75 0. In other words, two tri-
angles are in conﬂict if and only if they either share a common
peak or a common tail. A set Z of triangles is conflict-free if no
pair of triangles in Z are in conﬂict. If T is a BTP for E, for each
internal node ak and its children a,- and a], we have ak = a,- + a],
by CSP. Therefore, (k, {i,j}) is a triangle in E, and thus, T cor-
responds to a set of conﬂict-free triangles in E: each internal
node and its children form a triangle in E, and no two triangles
share a common peak or a common tail.

Because the number of nodes in a complete binary tree is
always odd, |E| being an odd number is a necessary condition
for the existence of a BTP for E. For a multiset E, with
|E| =2q — l, the size of a conﬂict-free set of triangles is at
most q — 1. This is because each triangle has exactly two tails,
and in a set of conﬂict-free triangles, all the tails must be distinct
elements.

We have the following theorem, whose proof is in
Supplementary Appendix A.2.

THEOREM 4. Suppose E= {a1, ...,a2q_1}. E has a BTP if and
only if there exists a set of q — I conﬂict-free triangles in E.

The proof of NP-completeness of the BTP problem (Theorem
3) is by a reduction from the Numerical Matching with Target
Sums (NMTS) problem, (Garey and Johnson, 1979). An instance
of NMTS is a triple z: (X, Y, B) where X, Y, B c 2+, and
X={X1, ...,Xm}, Y: {y1,  ,ym} and B={b1,  The
goal is to ﬁnd two permutations my and JTY on {1, . . . , m} such
that XﬂXU) +yﬂYU) = bi fOI' l = 1 . . . ,m.

THEOREM 5. Let I = (X, Y, B) be an instance of NM T S. Then, I
has a solution if and only if a particular multiset E1 has a BT P
(i.e. a set of 2m — I conﬂict-free triangles). Moreover, each solu-
tion of I can be obtained { in polynomial time ) from a BT P of E,
and vice versa.

PROOF. For a given instance I =(X, Y, B), let )2,=4(m+ 1)x,-
+1, y,=4(m+1)y,+3 and b,=4(m+1)b,-+4,1§i§m.
Moreover, let ﬂj=Zj€=1bAjﬂ 2 g j g m. Now we construct an
instance E1 of BTP (i.e. a multiset), with 4m—1 elements
as follows: EI={)21, ...,fcm} U {y1,  U {b1, . . . , bm}U
{52....,em}.

(=>) First assume that we have two permutations 71X, JTY on
{A1, . . . , m} such that xmm + yﬂyg) = b,. By deﬁnition of 32,, y, and
b,- we have also 32,043 + mm = b,-. Now we construct a set of con-
ﬂict-free triangles forAEI of size 2m — l: for each i e {1, .. . , m},
add the triangle (bi, {)Acmg), mag). In addition, forA each
i e {1, .. . ,m — 1}, we add all triangles (,8,+1,{b,,b,+1}).
Thus, by Theorem 4 we obtain a BTP from 71X and JTY in poly-
nomial time.

(<2) Suppose S is a set of 2m — 1 conﬂict-free triangles for E1.
We claim that for each )2, a triangle (b W), {3%, ya(,-)}) exists, where
or and y are two permutations on {1, . . . ,n}. Note that this

 

i80

1e /§IO's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq U101} popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

A combinatorial approach for analyzing intra-tumor heterogeneity

 

completes the proof, by taking 71X = y_1 and 7TY=()/_lo or) for
the instance I. Node x, cannot be the root, as the largest number
in E1 is ,Bm. Therefore, x, has a sibling s and a parent p. For all
ie {1, ...,m}, we have x,=l, y,=3, b,=4 and ,8,- = 4i, all in
mod 4(m + 1). Thus, if x,+s=p e E1, we have s=3
(mod 4(m + 1)) and p = 4(mod 4(m + 1)). This implies s = M)
and p = by(,) for some a(i) and y(i). Finally, because all the elem-
ents of E1 are presented uniquely in T, or and y are two permu-
tations on {1, . . . , m}. Note that we construct 71X and JTY from T
in polynomial time, and the proof is complete. D

We note that the proof above shows that the BTP problem
in NP-complete in the strong sense, i.e. the problem is still NP-
complete if the elements of the multiset are polynomially
bounded. In addition, the analogous partition problem for
non-binary trees is also NP-complete by reduction from the
subset sum problem. See Supplementary Appendix A6.

4 A g — o(1) APPROXIMATION FOR MAX-BTP

In the previous section, we showed that for a given multiset E of
2q — 1 elements, each BTP for E corresponds to a collection of
q—l conflict-free triangles. Because E can have at most q— 1
conﬂict-free triangles, we deﬁne the max -BTP problem to be the
problem of ﬁnding the maximum sized set of conflict-free tri-
angles. This is a closely related problem to the BTP problem:
in the context of VAF data, the maximum sized set of conﬂict-
free triangles denotes partial information about the ancestral re-
lationships among mutations. Moreover, for a multiset of m
elements if max -BTP has a solution of size A then a BTP with
k = m — 1 — 2A additional nodes can be found. See
Supplementary Appendix A.7.

We derive a %— o(1) approximation algorithm for the max -
BTP problem for E. The algorithm is based on Local Search. We
start with any collection of conﬂict-free triangles in E as a solu-
tion and iteratively add another triangle as follows. For a ﬁxed
constant t: l, we iteratively replace any subcollection of sgt
triangles in the solution with s + 1 triangles of E such that the
new collection still contains only conﬂict-free triangles.

It is easy to see that the above local search terminates in poly-
nomial time. Let OPT be the size of the optimal solution.
Because we cannot have more than q — 1 conﬂict-free triangles
in a solution, OPT f q — 1. After each iteration, the size of the
collection increases by l, and because t is a constant, the search
procedure at each iteration is polynomial time. Similar to the
technique that was used in Hajirasouliha et al. (2007), we use
the packing bound of Hurkens and Schrijver (1989) to prove the
following theorem (Proof in Supplementary Appendix A.7).

THEOREM 6. There exists a polynomial time algorithm that
gives an approximated solution to the problem of finding max-
imum set of conﬂict-free triangles within a factor of g— 6 for
any 6 >0.

5 THE e-BTP PROBLEM

Typically on real data, a BTP will not exist—either because the
frequencies a, are determined with some error or the VAF data
does not capture the frequency of a subpopulation that does not

have mutations that exclusively occur in that subpopulation
(VAFs provide information only about the proportion of cells
with a mutation, and do not provide information about propor-
tions of cells that have a speciﬁc mutation and lack another
mutation). In this section, we introduce the e-BTP to account
for these scenarios. Suppose we have the multiset E =
{511, ...,dm} of observed frequencies and a corresponding VAF
error vector 8 = (81, . . . ,em) for E, where 8, is the maximum pos-
sible error in observing d, for 1 g i g m. To account for subpo-
pulations without distinguishing mutations, we may need to add
auxiliary frequencies to E that correspond to the missing sub-
population frequencies. We make the following deﬁnitions.

DEFINITION 7 (s-BTP). Given a multiset E ={d1, . . . , am} with
associated VAF error vector 6=(61,...,6m), an e-BTP with
k: 0 auxiliary nodes is a BTP for a multiset E=
{a1, a2, . ..am+k} such that for all if m: la, — d,| g 6,. We call
the nodes am+1, . . . ,am+k the auxiliary nodes of the e-BTP.

DEFINITION 8 (The c-BTP problem). Given a multiset E and an
associated VAF error vector 8, ﬁnd an c-BTP of E with min-
imum number of auxiliary nodes such that two auxiliary nodes
are not siblings.

The constraint on auxiliary nodes in the deﬁnition of c-BTP
problem follows from the assumptions in our model of cancer
progression: each branching in the cancer progression happens
only when at least one clonal expansion starts. So, the VAF data
captures the frequency of the newly formed subpopulation (see
Section 2). Thus, at least one of the children of the current sub-
population node is not an auxiliary node.

It is straightforward to show that for any multiset E of size m,
it is always possible to obtain an e-BTP with k = m — 1 auxiliary
nodes (proof in Supplementary Appendix A.3). Also, when
8, = 0 for all lfifm, a BTP exists for E if and only if the
corresponding e-BTP has a solution with k = 0 auxiliary nodes.

To outline our algorithm, we need the following deﬁnitions.

DEFINITION 9 (s-CSP tree). Given a VAF error vector 8, an
8-CSP tree is a (weighted) binary tree, such that for each internal
node d, we have a, + dk e [d, :l: (6, + 6, + 6k)], where d, and dk are
the children of d,.

We say that an 8-CSP tree T for a multiset E is acceptable if we
can obtain a BTP, 05(T), by replacing each d, by a value a, where
la, — d,| g 6,. Note that 05(T) is an s-BTP for E. Also, note that
an 8-CSP tree is not necessarily acceptable (See Supplementary
Appendix D.8). However, one can easily check whether a given
8-CSP tree T is acceptable by ﬁnding a collection of e,’s, where
|e,| g 6,, satisfying the following constraints: (a, + e,) = (a, + e,) +
(dk +ek), for each internal nodes d, and its children d], dk. This
can be easily done via a linear program, which we denote by
LP(T).

Our Rec-BTP algorithm (Algorithm 1) uses a recursive
method that works as follows: at each recursion during the al-
gorithm, we have (i) a partially constructed 8-CSP tree T, (ii) a
multiset of remaining frequencies E and (iii) the number of re-
maining auxiliary nodes that we are allowed to use. We check if
T can be extended by attaching two elements of E, or one elem-
ent from E and an auxiliary node, to one of the leaves in T (we
assign the auxiliary node’s weight accordingly). If E is empty, it

 

i81

1e /§IO's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq U101} popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

I.Hajirasouliha et al.

 

means the al orithm has constructed an 8-CSP tree. So we
output 05(T) if LP(T) has a feasible solution. Finally, Rec-
BTP ou puts all the e-BTPs. Iterating over all values of k from
0 to m — l, the algorithm will ﬁnd the smallest k such that there
exists an s-BTP.

Later in Section 6, for the purpose of benchmarking our re-
sults, in case of multiple e-BTP outputs, we choose only the tree
whose list of node frequencies has the minimum root mean
square deviation (RMSD) from the original VAFs data (deﬁned
below in Section 6).

6 EXPERIMENTAL RESULTS
6.1 Simulated data

We generate simulated mutation data from all complete rooted
binary trees with 3, 5, 7 and 9 nodes (Supplementary Appendix
D.7). For each tree topology, we generate 1000 random BTPs by
assigning a weight a, to each node i, as follows. For the root r, we
set a, = 1, assuming that our tumor sample is pure, i.e. is not
contaminated with normal cells. Next, we proceed down the tree:
for each parent with weight a,, we select a pair of real numbers a,
and ak for the children uniformly at random such that the CSP
condition (a, = a, + ak) is satisﬁed. Finally, we generate a set M,
of somatic mutations for each node, with |M,| selected uniformly
from [50 400] independently for each node. We assume all som-
atic mutations in the set M, happened independently because the
parental cell was created. For each such BTP and set of muta-
tions, we generate a VAF data corresponding to each tumor
subpopulation. Ideally, the VAF of a tumor subpopulation
from node v equals a,. However, because the observed frequen-
cies are estimated from alignments of sequencing data, the
observed frequencies will deviate from the true values. We
assume that the observed VAFs for mutations of a subpopula-
tion v are normally distributed with mean a, and standard devi-
ation 0. Speciﬁcally, for each node v, let X, be a set of |M,|
samples from N(a,, 0). Here, we present the results when
a = 2, with results on o = 1, 4 in Supplementary Appendix B.
The VAF data for the tumor sample is thus X = U,X,. Note that
we simulate VAFs directly rather than the number of mapped
reads containing a mutation. Because we assume that our se-
quence coverage is high (>1000x), it follows that the correspond-
ing binomial (or negative binomial) distribution of read counts is
well approximated by the normal distribution. For lower cover-
ages, the asymptotic normal approximation may not model the
data as accurately; nevertheless, the simulations provide a com-
parison of the different methods on high-quality data.

For each simulated VAF dataset X, we estimate the number
and frequencies of tumor subpopulations using two non-
parametric clustering algorithms: (i) Accelerated variational
Dirichlet process Gaussian mixture model (AVDPM; Kurihara
et al., 2006), as implemented in https://sites.google.com/
site/kenichikurihara/academic-software/variational-dirichlet-
process-gaussian-mixture-model, which is a general clustering
method that we apply directly on VAF data, and (ii) SciClone
(Miller et al., forthcoming), which is a recent algorithm (with
available software but no published paper) that estimates
tumor composition from VAF data by clustering the data
using a mixture of Gaussian model. Parameter settings for

each method are given in Supplementary Appendix C. Also, be-
cause SciClone runtimes were extremely long, we down sampled
the mutation data by a factor of 20. For each of our synthetic
dataset, we implanted the fraction of the mutations (together
with their corresponding VAF) on a synthetic chromosome
with neutral copy number compatible with the SciClone input
format (See Supplementary Appendix C). We ran SciClone with
default parameters on each dataset and then extracted the means
of reported clusters from SciClone.

 

Algorithm 1: Rec-BTP(E, T, E, kmax)

 

Input : Partially constructed tree T, remaining
frequencies multiset E, 6, and an upper bound
kmax on the number of remaining auxiliary nodes.

Output: List of all 6;BTPs that can been obtained by
expanding T using a: most kmax auxiliary nodes
and the elements of E.

 

 

 

 

1 begin

2 if E = (D then

3 if LP(T) has a feasible solution then

4 L return {a(T)};

5 else

6 |_ return (Z);

7 O <— (l);

8 for each leaf a, in T do

9 for V51, 6 E do

10 for each Elj 6 AC (1 I€i+6j+6t (a, — 5L1) d0

11 T’ (— attach EL, and EL, to at;

12 E’ <—Z—{&,—,&,};

13 _ (9 <— 0 U Rec-BTP(L’, T’, 6, kmax)

14 if kmax > 0 then

15 T’ <— attach 6., and an auxiliary node
(with weight a, — 51,) to (it;

16 E’ <— E — {61,};

17 _ O <— O U Rec—BTP(E’, T’, 6, kmax — 1);

18 _ return (9;

 

From the output of each clustering algorithm, we obtain the
input for our Rec-BTP algorithm. We compute the sample mean
d, and standard deviation 0, for each cluster C,, and set the VAF
error 8, for the subpopulation frequency of cluster C, equal
to 1.96-c “a, where c is a constant set to 3. Note that
1.96 - o,/ |C,| is the radius of the empirical 95% conﬁdence
interval in estimating the true subpopulation frequency.

We set E={d1,...,dm} and 6=(61,...,6m) as the input
to Rec-BTP. We ﬁnd the minimum k for which there exists a
s-BTP for E with k auxiliary nodes. In many cases, there are
multiple BTPs for E with exactly k auxiliary nodes. In these
cases, we select a single BTP with the minimum cost
costX(T)=Z:=1:xeDi |x — a,|2, where s=n — k, X is the
VAF dataset and D,={x e X |arg minjla, — x| =i} is the subset
of elements of X that are closest to a,.

We compare the results of our Rec-BTP algorithm (applied to
clusters from both AVDPM and SciClone) to the original

 

 

i82

1e /§IO's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq U101} popeoIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

A combinatorial approach for analyzing intra-tumor heterogeneity

 

clusters output from these algorithms over the 1000 randomly
constructed BTPs for each of the seven tree topologies. We use
two measures to compare the estimated subpopulation frequen-
cies: (i) the number of subpopulations and (ii) the RMSD be-
tween the set of estimated subpopulation frequencies and the
true subpopulation frequencies.

Number of subpopulations. Figure 2 shows that Rec-BTP out-
puts the correct number of clusters more frequently than the
clustering methods. For trees with 3 and 5 nodes, Rec-BTP
does not improve the AVDPM clusters much. However, with
larger number of nodes the advantage of Rec-BTP grows. Rec-
BTP provides a large improvement over the SciClone clusters.

We further examined the scenarios where each algorithm
reported the correct and incorrect number of clusters. Figure 3
compares the fraction of cases where the clustering method and
the Rec-BTP assisted method report too few, the correct number
or too many clusters. We see that most of the cases where Rec-
BTP reports the correct number of cases (blue squares) are those
where the clustering algorithm reported too few clusters and the
Rec-BTP algorithm created additional clusters. Only in the case
of 3 and 5 nodes do AVDPM and SciClone determine the correct
number of clusters (green squares) in an appreciable fraction of
cases. Overall, we see that the clustering methods tend to under-
estimate the correct number of clusters (ﬁrst columns in each
table in Fig. 3). In a signiﬁcant fraction of these cases, Rec-
BTP adds auxiliary nodes to obtain the correct number of clus-
ters, although this becomes more difﬁcult with larger trees. We

l Rec-BTP {on AVDPM} AVDPM
l Ree-BTP {on SeiClon e: SciClone

an

:In

dlil

III

In I

‘" I I I
T3 T5 1'”: TJ'B TBA TEE T91:

Fig. 2. Percentage of trees where each algorithm ﬁnds the correct number
of subpopulations. Light blue/red bars are AVDPM and SciClone, re-
spectively. Dark blue/red bars are Rec-BTP results using AVDPM and
SciClone clusters, respectively, as input

also see that SciClone tends to underestimate the number of
subpopulations more frequently than AVDPM.

Accuracy of the subpopulation frequencies. We compare the
estimated population frequencies and true population frequen-
cies for each method using the RMSD. Suppose a, Z . . . Z a,, are
the true subpopulation frequencies, and d1 2  2 dm are the
estimated subpopulation frequencies. If m = n, the RMSD is

1&2; 1 (a, — d,)2. If m 75 n, we add zeros to the shorter se-

quence so the two sequences have equal length. The zeros reﬂect
the fact that we have not estimated the frequencies of some
subpopulations.

Table 1 gives RMSD for AVDPM, SciClone and Rec-BTP
built from these clusters. Speciﬁcally, we provide the RMSDs
when AVDPM or SciClone give (i) the same and (ii) less than
the correct number of subpopulations. For some tree topologies,
there is no sample in which both Rec-BTP and AVDPM/
SciClone give the same number of subpopulations equal to the
true number of subpopulations, which we denote by N/A.

In cases where both methods (Rec-BTP and a clustering algo-
rithm) return the same number of subpopulations, they have
similar performance in estimating the subpopulation frequencies.
Also, as mentioned earlier, these results are for the simulated
input data in which the variant allele frequencies deviate
from their true value with standard deviation 0 = 2. When
a = 1 Rec-BTP performs even better.

6.2 Comparison with Phylosub

As noted in the introduction, J iao et al. (2014) is a recent method
that clusters VAF frequencies using a tree constraint. In particu-
lar, Jiao et al. (2014) replace the Dirichlet process mixture for
clustering with a Bayesian non-parametric prior over trees sat-
isfying a weak form of the CSP constraint. We compared our
Rec-BTP algorithm with PhyloSub.

We generated VAF data from a collection of 400 random
complete binary trees with three, ﬁve, seven and nine nodes
with ﬁxed topologies. For each tree, we generated 100 random
instances. In contrast to the simulations in the previous section,
here we used only one of the two topologies for trees with seven
nodes and only one of the three possible topologies for trees with
nine nodes. We converted each random simulated VAF data to a

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

b) <true  =true  >true 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a AVDPM
m o 15.8 55‘ 5.2 31.412.7‘ 18.2 5.2 0.1‘ 18.3 4.9 0.4‘ 0.1 o i 7 0.1 o i 7.1 o o i
I"; 15.2 14.2 33 8.5 41.3 1.8 43.5 2 37.6 o 34.5 0.1 38 o _
a ( 
L T3A i TsxX ﬂ T7A/6XET7Bm _T9A/<<<\£T93AﬂTQC/<<>\  IIIIIIII 
(b) SciClone I E
n- o 9.8 4.1‘ 8 8.7 0.5‘ 4.2 0.1 o i 5.5 0.1 o o o i 0.8 o o i 0.8 o o
'53 33.8 52.4 58.910.6 40.9 o 43.1 o 10.8 o 9.9 o 11.2 o
g
£ T3 A 17'3 T5/<,\' ﬂ WAXO ﬁnem stA/éé ﬂ TQBA 3T9<y<<>X

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Fig. 3. Estimating the number of subpopulations using different algorithms. (a) Each entry in the table represents the fraction of random trees obtained
from AVDPM (columns) and Rec-BTP on AVDPM clusters (rows). (b) Results for SciClone versus Rec-BTP on SciClone clusters. (c) Interpretation of
each entry: the reported number of subpopulations by each method compared with the true number of subpopulations

 

i83

1e /§IO's113umo [p.IOJXO'SOllBUIJOJUIOIQ//Zdllq U101} popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

I.Hajirasouliha et al.

 

Table 1. Mean and standard deviation of RMSD over 1000 trees for each method

 

 

 

 

 

 

 

Tree Rec-BTP = AVDPM Rec-BTP > AVDPM Rec-BTP = SciClone Rec-BTP > SciClone
Rec-BTP AVDPM Rec-BTP AVDPM Rec-BTP SciClone Rec-BTP SciClone
T3 0.9:l:0.8 0.7:l:1.1 1.3:l:0.6 45.1:l: 11.3 1.2:l:0.4 1.5:l:0.4 2.6:l:1.1 43.7:l:11
T5 6.9:l:5.6 7.5:l: 5.2 9:l: 12.8 17.4:l: 14.1 1:l:0.5 1.2:l:0.4 4.2:l:6.4 15.7:l:9.2
77A 8.6:l:4.8 8.2:l:4.5 9.2:l:5.9 10.1 :l:6.5 N/A N/A 6.9:l:7.7 12.8:l:7.5
T73 8.4:l:2.8 8.1 :l:2.4 8.8:l:6.2 11.7:l:7.1 N/A N/A 6.2:l:6.9 13.2:l:6.8
V 9A N/A N/A 8.9:l:4.7 8:l:4.6 N/A N/A 6.4:l:5.4 10.8:l: 5.5
V 93 2:l:0 2.2:l:0 8.1:l:4.5 8.3:l:4.4 N/A N/A 5.6:l:4.9 11.4:l: 5.2
V 9C N/A N/A 7.5 :l: 4.5 9.9 :l: 4.4 N/A N/A 6.1 :l: 5.1 10.1:l: 4.5
Note: Bold face text indicates best performance.
PhyloSub input identical to the procedure performed for the 5D
simulations in the PhyloSub paper. In creating PhyloSub 4']

inputs, we assumed the total read counts for every single nucleo-
tide variants (SNV) position is 10000 (i.e. an ideal uniform
coverage of 10 000x for the PhyloSub input) and assumed
every SNV is heterozygous. On each dataset, we ran the
Markov chain Monte Carlo (MCMC) method of PhyloSub
100 times, each with 5000 MCMC iterations as per Jiao et al.
(2014), and used the reported top trees (i.e. those trees with best
log likelihood) in our comparison.

We found that PhyloSub produced trees with many more
nodes than the simulated value, and signiﬁcantly more than
Rec-BTP or SciClone (Fig. 4 and Supplementary Appendix D.
9]). Because PhyloSub usually tends to report trees with a higher
number of nodes, we also considered the size of the smallest tree
reported by PhyloSub in their provided list of top trees for each
input. While this value was smaller, it was still much larger than
the true value or the values from the other approaches.

The large number of clusters produced by PhyloSub might
result from the fact that the method does not assume that the
trees are binary. The output trees contain many different topol-
ogies. Nevertheless, it is surprising that PhyloSub does not ﬁnd
binary trees when the data are produced from this topology. As
PhyloSub reports a higher number of nodes than Rec-BTP, we
were unable to directly compare the provided frequencies of the
clusters of each method.

6.3 Acute myeloid leukemia sequencing data

We tested our algorithm on VAFs obtained from deep read
counts information for SNVs from an acute myeloid leukemia
sample (AMLl/UPN933124) using data from Ding et al. (2012).
We used the 386 SNVs reported in the primary AML sample,
obtaining the tumor VAF data directly from Supplementary
Table S5a in Ding et al. (2012). Note that Ding et al. (2012)
also report data from a relapse sample following chemotherapy.
As the relapse-speciﬁc mutations form only one cluster, we do
not analyze the BTP problem for this sample in our study.
Nevertheless, the generalization of the c-BTP problem for the
case where the input data contains two types of VAFs (e.g.
both tumor— and relapse-speciﬁc mutations) is an interesting
open problem. We ﬁrst ran SciClone on the VAF data, obtaining

Lil
'D

M
D

Number of Clusters

ll

I] I |.
BTP SciClone Phylosub Phylosub
(top) (min)

_I.
1:!

 

Fig. 4. A violin plot for the number of clusters output by Rec-BTP,
SciClone, PhyloSub where the top tree is considered, and PhyloSub
where the tree, among the top ones, with the minimum number of
nodes is considered. The y-axis shows the number of nodes in each
tree, while the histogram in each violin plot corresponds to tree sizes of
different experiments

four distinct VAF clusters with means of 47.17, 33.17, 22.42,
3.65%. We then ran Rec-BTP on these clusters, ﬁxing the root
of the BTP as an additional node with frequency 100%, reﬂect-
ing the fact that the tumor sample was pure and started from a
single founder clone (Ding et al., 2012).

Figure 5 shows the resulting e-BTP with corresponding multi-
set of population frequencies: E Rec_ BTP = {100, 53.75, 46.25,
42.86, 32.25, 21.5, 3.39}. Ding et al. (2012) present a history
of clonal expansions that implies an e-BTP for the multiset
{100, 53.12, 12.74, 29.04, 5.1} with two auxiliary nodes
(Fig. 4b). There are two such e-BTP, depending on the relative
order of two clonal expansions (Fig. 4), one with subpopulation
frequencies: E1 = {100, 53.12, 46.88, 12.74, 34.14, 29.04, 5.1} and
another with frequencies E2 = {100, 34.14, 65.86, 53.12, 12.74,
29.04, 5.10}. However, because the frequencies reported in Ding
et al. (2012) are scaled according to the estimated 93.72% purity
of their sample, it is necessary to multiply the frequencies in E1
and E2 by 0.9372 before comparing with the clusters obtained
from the VAF data.

We compare these different subpopulation frequencies esti-
mates by computing the average E, norm between the VAF for
each mutation and the closest subpopulation. Table 2 shows this
measure for each of the subpopulation multisets. We see that the

 

i84

1e /810's113u1no [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq U101} popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

A combinatorial approach for analyzing intra-tumor heterogeneity

 

 

A
n:
V

3.39

 

 

 

Number of mutations

 

an
'J
14
CI

31 4 1': 51': E11 T3
Frequencies of mutations

(b)

46.25

/ \

42.86 21.5 32.25 112.74 53.12 5.10 29.04 5.10 2904

Rec-BTP on SciClone

100  (c) 100 /100\
/ \ / \ 53_12 46.88
53.75 : 65.86 34.14 \12 74
I 34.14 -
/ \ ; / \ / \ / \

Possible BTPs for AML1 tumor

Fig. 5. (a) The VAF data for AML1 tumor sample. The VAFs are dense around ~47. G)) The 8-BTPS for AML1 from Ding et al. (2012) obtained from
Rec-BTP using SciClone clusters. (c) The two possible 8-BTPS derived from the clonal frequencies and ancestral reconstruction proposed in Ding et al.

(2012). Auxiliary nodes are shown in white circles

Table 2. Comparison of subpopulation frequencies obtained by Rec-BTP
with two possible subpopulation frequency multisets obtained from Ding
et al. (2012), based on the calculation of £1 and £2 norms to the original
VAF data

 

 

MCtI‘IC .CReC_BTp [,1 .62
Average 61 norm 1.6367 3.3309 1.8376
Average £2 norm 0.1161 0.2221 0.1331

 

Rec-BTP gives a better ﬁt to the VAF data than both estimates
E1 and E2 given in Ding et al. (2012). This shows that using the
tree constraint in the BTP provides additional information that is
useful for clustering real VAF data.

Note that calculation of £1 and £2 norms for the SciClone
cluster means would result in 2.4816 and 0.1823, respectively.
However, because the number of SciClone clusters is only 4,
these numbers cannot be reasonably compared with the ones
calculated for the trees in Figure 5.

7 DISCUSSION

In this article, we provide the ﬁrst rigorous combinatorial for-
mulation of the problem of inferring the composition of tumor
subpopulations constrained by a tree in a single tumor sample
from the variant allele frequencies (VAFs) of somatic mutations.
In our formulation, we introduced a novel deﬁnition of the BTP
and the e-BTP. We showed that the problem of ﬁnding a BTP
(and hence an s-BTP) is in general NP-complete; however, we
derived an approximation algorithm for a related problem, max -
BTP. We developed a recursive algorithm for the e-BTP that
works well in practice and showed the advantages on this algo-
rithm on simulated and real sequencing data.

These results show the utility of the BTP, but also suggest
additional areas of further investigation. In particular, it would
be interesting to combine the clustering of VAFs and the con-
struction of the BTP into a single model. While there has been
some work to combine these two steps using a machine learning
approach (J iao et al., 2014), the complexity of the corresponding
inference problem is unknown. In our tests, we were unable to
obtain satisfactory results using this model, suggesting there is
room for additional improvements. One possible direction is to
use MCMC or other sampling approaches over the space of
BTPs, perhaps combining this inference into a graphical model

that better models the features of real sequencing data [e.g. as
used in pyClone (Shah et al., 2012; Roth et al., 2014)]. Finally,
the extension of the BTP and related approaches to multiple
samples from the same tumor (taken at the same or different
times) will be increasingly useful as such data become available.

ACKNOWLEDGEMENT

The authors thank Li Ding and Michael McLellan for assistance
with the AML data.

Funding: This work was supported by National Science
Foundation CAREER Award (CCF—1053753 to B.J.R.) and
the National Institutes of Health (R01HG5690 to B.J.R.).
B.J.R. is also supported by a Career Award at the Scientiﬁc
Interface from the Burroughs Wellcome Fund, an Alfred P.
Sloan Research Fellowship. I.H. is also supported by a
Natural Sciences and Engineering Research Council of Canada
(NSERC) Postdoctoral Fellowship.

Conflict of Interest: none declared.

REFERENCES

Carter,S.L. et al. (2012) Absolute quantiﬁcation of somatic DNA alterations in
human cancer. Nat. Biotechnol, 30, 413—421.

Ding,L. et al. (2012) Clonal evolution in relapsed acute myeloid leukaemia revealed
by whole-genome sequencing. Nature, 481, 506—510.

Ding,L. et al. (2013) Advances for studying clonal evolution in cancer. Cancer Lett.,
340, 212—219.

Garey,M.R. and J ohnson,D.S. (1979) Computers and Intractability: A Guide to the
Theory of NP-Completeness. W.H. Freeman and Company, New York.

Gerlinger,M. et al. (2012) Intratumor heterogeneity and branched evolution
revealed by multiregion sequencing. N. Engl. J. Med, 366, 883—892.

Hajirasouliha,I. et al. (2007) On completing latin squares. In: ST ACS. pp. 524—535.

Hou,Y. et al. (2012) Single-cell exome sequencing and monoclonal evolution of a
JAK2-negative myeloproliferative neoplasm. Cell, 148, 873—885.

Hurkens,C.A.J. and Schrijver,A. (1989) On the size of systems of sets every t of
which have an SDR, with an application to the worst-case ratio of heuristics for
packing problems. SIAM J. Discret. Math, 2, 68—72.

Jiao,W. et al. (2014) Inferring clonal evolution of tumors from single nucleotide
somatic mutations. BM C Bioinformatics, 15, 35.

Kandoth,C. et al. (2013) Mutational landscape and signiﬁcance across 12 major
cancer types. Nature, 502, 333—339.

Kurihara,K. et al. (2006) Accelerated variational dirichlet process mixtures. In:
SchOlkopf,B. et al. (ed) NIPS. MIT Press, pp. 761—768.

Lawrence,M.S. et al. (2013) Mutational heterogeneity in cancer and the search for
new cancer-associated genes. Nature, 499, 214—218.

Miller,C.A. et al. (forthcoming) SciClone: Inferring clonal architecture and tracking
the spatial and temporal patterns of tumor evolution. PLoS Comput Biol.
Navin,N. et al. (2011) Tumour evolution inferred by single-cell sequencing. Nature,

472, 90—94.

 

i85

1e /810's113u1no [DJOJXO'SOIIBIIIJOJUIOIQ/ﬁdllq uIOII popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

I.Hajirasouliha et al.

 

Newburger,D.E. et al. (2013) Genome evolution during progression to breast
cancer. Genome Res., 23, 1097—1108.

Nik-Zainal,S. et al. (2012) The life history of 21 breast cancers. Cell, 149,
994—1007.

Nowell,P.C. (1976) The clonal evolution of tumor cell populations. Science, 194,
23—28.

Oesper,L. et al. (2013) Theta: inferring intra-tumor heterogeneity from high-
throughput dna sequencing data. Genome Biol, 14, R80.

Roth,A. et al. (2014) PyClone: statistical inference of clonal population structure in
cancer. Nature Methods, 11, 396—398.

Salari,R. et al. (2013) Inference of tumor phylogenies with improved somatic mu-
tation discovery. In: RECOMB. pp. 249—263.

Schuh,A. et al. (2012) Monitoring chronic lymphocytic leukemia progression by
whole genome sequencing reveals heterogeneous clonal evolution patterns.
Blood, 120, 4191—1496.

Shah,S.P. et al. (2012) The clonal and mutational evolution spectrum of primary
triple-negative breast cancers. Nature, 486, 395—399.

Strino,F. et al. (2013) TrAp: a tree approach for ﬁngerprinting subclonal tumor
composition. Nucleic Acids Res., 41, e165.

Vogelstein,B. et al. (2013) Cancer genome landscapes. Science, 339, 1546—1558.

Xu,X. et al. (2012) Single-cell exome sequencing reveals single-nucleotide mutation
characteristics of a kidney tumor. Cell, 148, 886—895.

 

i86

1e /8IO's113u1no [DJOJXO'SOIIBIIIJOJUIOIQ/ﬁdllq uIOII popeOIHAAOQ

9IOZ ‘09 lsnﬁnv uo ::

