APPLICATIONS NOTE V°" 353.5%.iggi‘iliaiﬁéiiiiféﬁigég

 

Genetics and population analysis

Advance Access publication April 28, 2014

Power analysis and sample size estimation for sequence-based

association studies

Gao T. Wang‘, Biao Lil, Regie P. Lyn Santos—Cortez‘, Bo Peng2 and Suzanne M. Lea

I1 1*

1Center for Statistical Genetics, Department of Molecular and Human Genetics, Baylor College of Medicine and
2Department of Bioinformatics and Computational Biology, The University of Texas, M D Anderson Cancer Center,

Houston, TX 77030, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Statistical methods have been developed to test for com-
plex trait rare variant (RV) associations, in which variants are aggre-
gated across a region, which is typically a gene. Power analysis and
sample size estimation for sequence-based RV association studies
are challenging because of the necessity to realistically model the
underlying allelic architecture of complex diseases within a suitable
analytical framework to assess the performance of a variety of RV
association methods in an unbiased manner.

Summary: We developed SEQPower, a software package to perform
statistical power analysis for sequence-based association data under
a variety of genetic variant and disease phenotype models. It aids
epidemiologists in determining the best study design, sample size
and statistical tests for sequence-based association studies. It also
provides biostatisticians with a platform to fairly compare RV associ-
ation methods and to validate and assess novel association tests.
Availability and implementation: The SEQPower program, source
code, multi—platform executables, documentation, list of association
tests, examples and tutorials are available at http://bioinformatics.org/
spower.

Contact: sleal@bcm.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 8, 2013; revised on March 31, 2014; accepted
on April 23, 2014

1 INTRODUCTION

Power analysis is one of the most crucial steps in designing com-
plex trait genetic association studies. The aim is to determine the
power to detect an association for a speciﬁed sample size or to
estimate the sample size for a given power for a variety of genetic
models and statistical methods. Over the past decade, genome-
wide association studies using single nucleotide polymorphism
markers have been highly successful in the study of complex
diseases, with power analysis aided by software packages such
as Genetic Power Calculator (Purcell et al., 2003) and CaTS
(Skol et al., 2006). Currently, there is growing interest in detect-
ing complex trait rare variant (RV) associations using
next-generation sequencing (NGS) data. Many sequence-based
RV association methods have been developed to jointly analyze
multiple SNVs by aggregating them across a region, e.g. a gene.

 

*To whom correspondence should be addressed.

Complexities arise, making power and sample size estimations
for these RV association methods challenging. The allelic archi-
tecture of RVs is dependent on population genetic parameters,
which are difﬁcult to realistically model. Additionally, within a
region, the genetic effect sizes of variants are not uniform and
non-causal variants as well as variants with bidirectional effects,
e. g. protective and detrimental, can be present. Also there can be
genotyping error and missing data. This genetic complexity
makes estimation of sample size and power for RV association
studies challenging. Owing to mathematical intractability, appli-
cation of theoretical power analysis is limited. Empirical power
studies are also hindered by a lack of consistent implementation
of many existing RV association methods.

To perform power analysis, SEQPower uses sequence data
generated via advanced genetic simulation technique as well as
data derived from real-world NGS studies. It generates qualita-
tive and quantitative trait (QT) data based on observed variants
in the simulated genetic region. Analytic and empirical power
analysis can be performed using a large variety of RV association
methods.

2 METHODS
2.1 Simulation of DNA sequence and disease phenotype
data

Owing to the uncertainty of RV architecture, many simulation
methods have been proposed to generate DNA sequence data using
Wright’s formula, empirical Bayesian estimates, coalescent, forward-time
and resampling from real-world data. SEQPower generates sequencing
data using forward-time simulation while incorporating demographic and
natural selection parameters (Peng and Liu, 2010) or extrapolated minor
allele frequency (MAF) spectra based on data from the The National
Heart, Lung, and Blood Institute Exome Sequencing Project (ESP)
(Tennessen et al., 2012). It is also possible to provide SEQPower with
other simulated or real-world NGS datasets. Variants with a potential
contribution to disease traits are annotated based on (i) frequencies, (ii)
selection coefﬁcients or (iii) functional annotations, such as scores from
variant effect prediction algorithms or measures of nucleotide conserva-
tion. The joint effects of a genomic region on phenotypes are reﬂected as
either disease status or QT value. The impact of each variant can be
modeled as the logit of odds, population-attributable risk or the differ-
ence in mean QT. Three study designs, case—control, extreme QTs and
randomly ascertained quantitative phenotypes, are available.
Additionally, variant data can be modiﬁed to mimic NGS platforms as
well as exome genotyping array data (6. g. ‘exome chip’). More details on

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2377

112 ﬂJO'smumo[pJOJXO'sot1chOJutotw/2d11q IIIOJJ popcommoq

910K ‘09 lsnﬁnV no :2

G.T.Wang et al.

 

data simulation methods can be found in Supplementary Table S2 and in
the online documentation.

2.2 Analytic power and sample size calculations

Analytic power analysis can be performed for several basic models and
statistical methods. The fundamental idea behind RV association meth-
ods is to compare the difference in cumulative MAF between cases and
controls, or the difference in mean QT values between wild-type individ-
uals and those with alternative alleles. For the case—control design, we
calculate case and control MAF under the Bayes’ law. Given the simu-
lated MAF spectrum and effect size at each variant site i, the case—control
status-speciﬁc genotype frequency is calculated as p(g,-|status) = $33“;
where p(g,-) is the population genotype frequency, f, is penetrance,
p(status) is disease prevalence (K) in cases and I-K in controls. To per-
form analytic power analysis for the Combined Multivariate and
Collapsing (CMC) method (Li and Leal, 2008), for a genetic region
with M variants, cumulative MAF for cases or controls can be calculated
as p=1 —  — pi) and power for detecting the difference between
pcase and pcomml can be calculated (Fleiss et al., 1980). To perform analytic
power analysis for the Burden of Rare Variants (BRV) (Auer et al., 2013)
method, a 2 X 2 contingency table of expected counts for minor (N 1) and
major (N2) alleles in cases as well as in controls (N ’1 and N ’2) is con-
structed, and a X2 test is applied. For QTs, the expected mean shift is the
joint effect of variants across the region. Denoting each set of causal
variants as V, and the corresponding VC as the set variant sites that
are homozygous for the wild-type allele, the probability to observe such
set of variants in the samples is Hid] Inna/C (1 — 12]) with effect .size
Zia/A,- where A, 1s the effect $126 of variant i. Then a llnear regress1on-
based goodness-of-ﬁt test can be constructed to perform power and
sample size estimates. Compared with empirical analysis, the
SEQPower analytic framework provides efﬁcient sample size estimates.
The analytic framework also allows for modeling using simulated data;
however, multiple replicates are necessary to compute the average sample
size or power to adjust for the randomness in generating variant sites and
their effect sizes.

 

2.3 Empirical power comparisons

SEQPower can also perform empirical power analysis, which is more
ﬂexible than analytic power analysis and sample size estimation.
Empirical power analysis is available for a large variety of study designs,
disease models and association tests. Power is estimated by the propor-
tion of successes (e.g. P S 0.05) of the total number of independent rep-
licates. Details of association tests in SEQPower can be found in
Supplementary Table S1, and several power analysis examples are pro-
vided in Supplementary Material. Although for empirical analysis it is not
feasible to directly calculate sample size, it is possible to create a grid
search using a small number of replicates to ﬁnd the approximate sample
size. Because of computational burden, sample size estimation is best
suited for RV association methods for which asymptotic P-values can
be obtained [CMC, Sequence Kernel Association Test Wu et al., 2011)].
Methods for which P-values must be obtained empirically through per-
mutation [Kernel—based Adaptive Clustering (Liu and Leal, 2010),
Variable Threshold (Price et al., 2010)], it can be computationally inten-
sive to calculate power and sample sizes for small signiﬁcant levels (e.g.
oz = 2.5 x 10‘6 for exome-wide NGS association studies), despite imple-
mentation of adaptive permutation (which reduces the number of permu-
tations used to estimate non-signiﬁcant P-values). SEQPower also has a
mechanism to incorporate user-provided R scripts for assessment of type
I error and power of novel association methods.

2.4 Performance

SEQPower is written in C ++ and Python. It compiles and runs on most
Unix/Linux systems and Mac workstations. We recently performed a
power analysis using variant frequencies for European—Americans ob-
tained from the NHLBI-ESP exome variant server (Tennessen et al.,
2012). For a sample size of 1000 cases and 1000 controls the power to
detect an association for oz = 2.5 x 10‘6 using the BRV method was eval-
uated for all genes within the exome with at least two variants sites, i.e.
19044 genes. Using logistic regression, it took 6.0 min for analytic and
14.6h for empirical power analyses on an Intel i7-3770 Quad Processor.

3 DISCUSSION

SEQPower is a practical tool for investigators to design ad-
equately powered RV association studies. Although the true
underlying genetic model is unknown, using a range of models,
gene sizes, allelic architectures, effect sizes, etc., an investigator
can determine whether a study has adequate power to at least
detect associations with some of the genes involved in disease
etiology. It is also an important tool to benchmark and compre-
hensively evaluate RV association tests, and also aid in the de-
velopment of new statistical methodologies.

ACKNOWLEDGEMENTS

The authors would like to thank Ulrike Peters, Benjamin Neale
and Dajiang Liu for their many useful comments and
suggestions.

Funding: This work was supported by National Institutes of
Health grants (HL102926, MD005964, HG006493 and
HG005859) and additional grant support was provided by the
MD Anderson Cancer Center (CA016672).

Conﬂict of Interest: none declared.

REFERENCES

Auer,P.L. et al. (2013) Testing for rare variant associations in the presence of
missing data. Genet. Epidemiol., 37, 529—538.

Fleiss,J.L. et al. (1980) A simple approximation for calculating sample sizes for
comparing independent proportions. Biometrics, 36, 343—346.

Li,B. and Leal,S.M. (2008) Methods for detecting associations with rare variants for
common diseases: application to analysis of sequence data. Am. J. Hum. Genet,
83, 311—321.

Liu,D.J. and Leal,S.M. (2010) A novel adaptive method for the analysis of
next-generation sequencing data to detect complex trait associations with rare
variants due to gene main effects and interactions. PLoS Genet, 6, 61001156.

Peng,B. and Liu,X. (2010) Simulating sequences of the human genome with rare
variants. Hum. Hered., 70, 287—291.

Price,A.L. et al. (2010) Pooled association tests for rare variants in exon-
resequencing studies. Am. J. Hum. Genet, 86, 832—838.

Purcell,S. et al. (2003) Genetic Power Calculator: design of linkage and association
genetic mapping studies of complex traits. Bioinformatics, 19, 149—150.

Skol,A.D. et al. (2006) Joint analysis is more efﬁcient than replication-based
analysis for two-stage genome-wide association studies. Nat Genet, 38,
209—213.

Tennessen,J.A. et al. (2012) Evolution and functional impact of rare coding vari-
ation from deep sequencing of human exomes. Science, 337, 64—69.

Wu,M.C. et al. (2011) Rare-variant association testing for sequencing data with the
sequence kernel association test. Am. J. Hum. Genet, 89, 82—93.

 

2378

112 /810's112umo[pJOJXO'sottchOJutotw/zdnq won popcommoq

910K ‘09 isnﬁnV no :2

