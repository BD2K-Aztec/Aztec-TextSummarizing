Bioinformatics, 31 (1 1), 2015, 1842—1844

doi: 10.1093/bioinformatics/btv021

Advance Access Publication Date: 20 January 2015
Applications Note

 

Gene expression

dslice: an R package for nonparametric testing
of associations with application in QTL and
gene set analysis

Chao Ye1, Bo Jiangz, Xuegong Zhang1'3'* and Jun S. Liu2'4'*

1MOE Key Laboratory of Bioinformatics, Bioinformatics Division and Center for Synthetic & Systems Biology,
TNLIST, Department of Automation, Tsinghua University, Beijing 100084, China, 2Department of Statistics, Harvard
University, Cambridge, MA 02138, USA, 3School of Life Sciences, Tsinghua University, Beijing 100084, China and
4Center of Statistics, Tsinghua University, Beijing 100084, China

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on July 3, 2014; revised on December 28, 2014; accepted on January 12, 2015

Abstract

Summary: Many statistical problems in bioinformatics and genetics can be formulated as the
testing of associations between a categorical variable and a continuous variable. A dynamic slicing
method was proposed for non-parametric dependence testing, which has been demonstrated to
have higher powers compared with traditional methods such as Kolmogorov—Smirnov test.
We introduce an R package dslice to facilitate the use of dynamic slicing method in bioinformatic

 

applications such as quantitative trait loci study and gene set enrichment analysis.
Availability and implementation: dslice is implemented in chp and available in the
Comprehensive R Archive Network. The package is distributed under the GNU General Public

License (version 2 or later).

Contact: zhangxg@tsinghua.edu.cn or jliu@stat.harvard.edu.

 

1 Introduction

Often in biological studies, we need to test whether the underlying
distributions of two or more populations are different from each
other on the basis of independent samples from these populations.
The K-sample test problem is equivalent to testing whether the value
of an observation is independent of its label indicator (i.e. which
sample it comes from). Traditional methods such as the t-test and
the rank-sum test can only test differences in means or medians.
On the other hand, classic omnibus testing methods such as
Kolmogorov—Smirnov test have limited power in detecting differ-
ences between distributions of different types. Jiang et al. (2014)
proposed an omnibus K-sample testing method based on regularized
likelihood-ratio test and dynamic slicing (here we refer to the test
statistic as ‘DS-statistic’) and demonstrated its statistical power com-
pared with some existing well-known methods through extensive
simulation studies. Here, we introduce an R package dslice that
implements this novel dynamic slicing (‘DS’) method for nonpara-
metric tests and makes it a versatile statistical tool for applications

in quantitative trait loci (QTL) study and gene set enrichment ana-
lysis (GSEA).

2 Implementation

Core functions for testing dependence in dslice are implemented in
the Cpp language and are integrated in R through the chp package
(Eddelbuettel and Francois, 2011). R package dslice contains func-
tions for omnibus K-sample hypothesis testing (ds_test), illustrations
of optimal slicing scheme (slice_show) and gene set analysis (ds_gsa)
on dataset downloaded from GSEA website (http://www.broadinsti-
tute.org/gsea/index.jsp).

3 Examples

3.1 OTL study
The QTLs analysis attempts to detect relationship between genetic
variation (single-nucleotide polymorphism) and continuous variable

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1842

112 /810'S{12umo[pJOJXO'sopeuuogurorq/ﬁdnq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

R package dslice

1843

 

Table 1. Identified OTLs associated with mouse femur and vertebra
length by the DS method

 

 

Phenotype QTL Location DS-statistic FDR‘“‘

Femur length rs3091203 Chr13z22 18.34 <1 X 10' 6
D2Mit285 Chr2:159 13.79 <1 x 10- 6
D9Mit104.1 Chr9z64 5.87 0.0055
1513482609 Chr15z64 3.47 0.0257
D5Mit25.1 Chr5:111 3.4 0.0278
rs3657845 Chr17:18 2.79 0.0393

Vertebra length rs4222738 Chr1:161 23.11 <1 X 10' 6
D1Mit105 Chr1:163 16.58 <1 x 10- 6
D2Mit58 Chr2:110 8.71 2.6 x 10‘ 4
rs3089785 Chr16z39 5.01 0.0044
D7Mit76 Chr7:17 4.99 0.0048
154231015 Chr15:100 4.2 0.0086
D5Mit48 Chr5:9 4.16 0.0086
rs13477864 Chr4z99 3.49 0.0153
1513480044 Chr8:129 3.07 0.0205
r813477990 Chr4:133 2.72 0.0256
153023444 Chr17z38 2.53 0.0282
154229231 Chr12:5 2.08 0.0385
153091203 Chr13z22 1.82 0.0438
D19Mit41 Chr19z20 1.72 0.0496
D14Mit170 Chr14:105 1.63 0.0494

 

Genomic location is in chromosome: Mb format.
FDR", FDR-adjusted P values.

of phenotypes (human height or gene expression levels). Traditional
analyzing methods are mainly based on the researcher’s foresight
about the agnostic mechanism of QTL, such as linear marginal ef-
fect or interaction effect (Aschard et al., 2013). Dynamic slicing
method views the QTL problem as dependence test between a cat-
egorical variable (genotype) and a continuous variable (phenotype).
It has the advantage of revealing nonlinear associations free of
assumptions on underlying mechanism.

In view of power study on DS method in detecting non-linear
effects (Jiang et al., 2014), we apply the ds_test function in dslice
package on a mouse QTL dataset by Burke et al. (2012) with 558
binary genetic markers and two phenotypes. We removed observa-
tions with missing phenotype values and set the penalty parameter
7» = 1.0 in ds_test. Then, we randomly shufﬂed the phenotypes of in-
dividuals to generate empirical P values of DS-statistic. By control-
ling a false discovery rate (FDR, Benjamini and Hochberg, 1995) of
0.05, we identified 6 QTLs and 15 QTLs associated with mouse
femur length and vertebra length, respectively (Table 1). Figure 1
illustrates the optimal slicing schemes generated by dslice for mouse
vertebra length QTLs 13422273 8 and r513477864. We can see that
non-linear associations like the example of QTL r513477864 can be
well detected by dslice.

3.2 Gene Set Analysis

Subramanian et al. (2005) introduced GSEA to the aggregate effect
of genes in unit of ‘gene set’. Specifically, GSEA attempts to deter-
mine whether the distribution of biological phenotypes are different
between genes in a gene set and the other genes, which can be for-
mulated as a non-parametric two-sample testing problem. However,
Goeman and Buhlmann (2007) discussed two different null hypothe-
ses in gene set analysis: competitive null, which is a two-sample test
comparing genes in the gene set and genes not in the set, and self-
contained null, which is a one-sample test of differential expression

rs4222738: genotype counts across slices

 

100%
90
75% 101
% Types
g 116
8 50% 96 II36
0
L
a, BALB
n- 25% 25 i
I I I I I I
B6 BALB B6 BALB B6 BALB
Slices

rs13477864: genotype counts across slices

 

100% 21
75%
OD T es
g 158 V”
E a 79 92 36
8 504’ 110
'5 BALB
“- 25%
1
0% —
I I I I I I
Be BALB Be BALB B6 BALB
Slices

Fig. 1. Illustration of optimal slicing schemes for mouse vertebra length OTLs
rs4222738 and rs 13477864. Each panel shows the relative proportion of geno-
types in the corresponding slice

Table 2. Significant gene sets detected by the DS method

 

 

Gene set Size DS-statistic FDR‘"‘
P53 pathway 16 10.42 <1 x 10-6
P53 hypoxia pathway 20 9.69 <1 x 10-6
P53_signalling 87 5.095 <1 x 10-6
Radiation_sensitivity 26 8.846 3.1 X 10'4
P53_UP 40 11.2 0.0022
hsp27 pathway 15 0.514 0.0456

 

FDR", FDR-adjusted P values.

on a set of genes. Here, we focus on the application of dynamic slic-
ing method on a well-studied dataset P53 NCI-60 (Ackermann and
Strimmer, 2009; Efron and Tibshirani, 2007; Subramanian et al.,
2005) in testing competitive null but note that our method can also
be used in one-sample test for self-contained null (see function ds_ 1
in dslice package for details).

This dataset assays 10 100 gene expression levels and consists of
17 normal samples and 33 samples with mutated p53. The C2 gene
set contains 308 predefined functional gene sets (with gene set size
between 15 and 500). The dataset is available on the GSEA website.
We set the penalty parameter 7» = 1.0 and obtained the empirical P
values by randomly assigning sample labels. Table 2 lists significant
gene sets reported by DS under a FDR cutoff of 0.05. In comparison,
the GSA method by Efron and Tibshirani (2007) missed the gene set
p53_signalling under the same cutoff, and all the significant gene
sets reported by GSA have FDR values larger than 0.01.

4 Discussion

Testing of associations between a categorical variable and a continu-
ous response is a frequently encountered statistical problem in bio-
informatics. R package dslz'ce implements a recently proposed
nonparametric dependency detection method. Although we use
QTL and gene set analysis as examples to demonstrate the use of
dslice, it can be applied to other biological problems such as protein

112 /810'S{12umo[pJOJXO'sopeuuogurorq/ﬁdnq wort pepeolumoq

910K ‘09 lsnSnV no :2

1844

C. Ye et al.

 

binding inference from nucleosome occupancy (Meyer et al., 2011)
and binding profile differences between protein mutants
(Gisselbrecht et al., 2013), and we anticipate it to be of great use in
future bioinformatic studies.

Funding

This work was supported, in part, by the National Basic Research Program of
China (2012CB316504), Shenzhen Special Fund for Strategic Emerging
Industry grant ZD201111080127A and the National Science Foundation
Grants DMS-1120368 and IIS-1017967.

Conﬂict of Interest: none declared.

References

Ackermann,M. and Strimmer,K. (2009) A general modular framework for
gene set enrichment analysis. BMC bioinformatics, 10, 47.

Aschard,H. et al. (2013) A nonparametric test to detect quantitative trait loci
where the phenotypic distribution differs by genotypes. Genet. Epidemiol.,
37, 323—333.

Benjamini,Y. and Hochberg,Y. ( 1995 ) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. Ser. B
(Methodol.), 85, 289—300.

Burke,D.T. et al. (2012) Dissection of complex adult traits in a mouse
synthetic population. Genome Res., 22, 1549—1 5 5 7.

Eddelbuettel,D. and Frangois,R. (2011) chp: seamless R and C++
Integration. ]. Stat. Softw., 40, 118.

Efron,B. and Tibshirani,R. (2007) On testing the signiﬁcance of sets of genes.
Ann. App]. Stat., 1, 107—129.

Gisselbrecht,S.S. et al. (2011) Highly parallel assays of tissue-speciﬁc enhan-
cers in whole Drosophila embryos. Nat. Methods, 10, 774—780.

Goeman,].]. and Buhlmann,P. (2007) Analyzing gene expression data in terms
of gene sets: methodological issues. Bioinformatics, 23, 980—987.

Jiang,B. et al. (2014) Non-parametric K-sample tests via dynamic slicing.
]. Am. Stat. Assoc., in press.

Meyer,C.A. et al. (2011) BINOCh: Binding inference from nucleosome
occupancy changes. Bioinformatics, 27, 1867—1868.

Subramanian,A. et al. (2005 ) Gene set enrichment analysis: a knowledge-
based approach for interpreting genome-wide expression proﬁles. Proc.
Natl Acad. Sci. USA., 102, 15545—15550.

1e /810'81eumo[pJOJXO'sopeuJJOJurorq/ﬁdnq wort pepeolumoq

910K ‘09 lsnSnV no 22

