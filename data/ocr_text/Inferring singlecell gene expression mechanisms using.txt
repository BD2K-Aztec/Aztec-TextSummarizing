Bioinformatics, 31(9), 2015, 1428—1435

doi: 10.1093/bioinformatics/btv007

Advance Access Publication Date: 7 January 2015
Original Paper

 

Gene expression

Inferring single-cell gene expression
mechanisms using stochastic simulation

Bernie J. Daigle, Jr.1, Mohammad Soltaniz, Linda R. Petzold3 and
Abhyudai Singh2'*

1Institute for Collaborative Biotechnologies, University of California, Santa Barbara, CA 93106, 2Department of
Electrical and Computer Engineering, University of Delaware, Newark, DE 19716 and 3Department of Computer
Science, University of California, Santa Barbara, CA 93106, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on June 11, 2014; revised on November 5, 2014; accepted on January 4, 2015

Abstract

Motivation: Stochastic promoter switching between transcriptionally active (ON) and inactive
(OFF) states is a major source of noise in gene expression. It is often implicitly assumed that transi—
tions between promoter states are memoryless, i.e. promoters spend an exponentially distributed
time interval in each of the two states. However, increasing evidence suggests that promoter
ON/OFF times can be non—exponential, hinting at more complex transcriptional regulatory architec—
tures. Given the essential role of gene expression in all cellular functions, efficient computational
techniques for characterizing promoter architectures are critically needed.

Results: We have developed a novel model reduction for promoters with arbitrary numbers of ON
and OFF states, allowing us to approximate complex promoter switching behavior with Weibull—
distributed ON/OFF times. Using this model reduction, we created bursty Monte Carlo expectation—
maximization with modified cross—entropy method (‘bursty MCEMZ’), an efficient parameter esti—
mation and model selection technique for inferring the number and configuration of promoter
states from single—cell gene expression data. Application of bursty MCEM2 to data from the en—
dogenous mouse glutaminase promoter reveals nearly deterministic promoter OFF times, consist—
ent with a multi—step activation mechanism consisting of 10 or more inactive states. Our novel ap—
proach to modeling promoter fluctuations together with bursty MCEM2 provides powerful tools for
characterizing transcriptional bursting across genes under different environmental conditions.
Availability and implementation: R source code implementing bursty MCEM2 is available upon
request.

Contact: absingh@udel.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

The process of gene expression—whereby the information contained
in a DNA sequence is converted into RNA and proteins—plays an
essential role in the execution of nearly all cellular functions. As a
result, the misregulation of this process underlies a large number
of human diseases including cancer, diabetes and neurological
disorders (Lee and Young, 2013). Despite its importance, the

mechanistic details of gene expression are still not well understood.
In particular, we lack a comprehensive molecular—level explanation
for expression ‘bursts’—periods of intense RNA and protein produc—
tion separated by periods of quiescence—observed in pro— and eu—
karyotes (Cai et 61]., 2006; Raj et 61]., 2006). Precise characterization
of the mechanisms underlying expression bursts is profoundly
important, as the properties of these bursts have been implicated in

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1428

112 /§JO'S{eu1no [p.IOJXO'SOUBIHJOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

Inferring gene expression mechanisms

1 429

 

disease—related processes such as bacterial phenotype switching
(Choi et al., 2008) and HIV activation (Singh et al., 2010).

Recent advances in single—cell monitoring and single-molecule
detection have made possible the experimental characterization
of gene expression bursts (Dar et al., 2012; Golding et al., 2005;
Singh, 2014; So at al., 2011; Suter et al., 2011; Yu et al., 2006).
Specifically, Suter et al. (2011) have quantified transcriptional bursts
from 11 endogenous mouse promoters, demonstrating that each
observed expression pattern can be approximated using a stochastic
two—state model of promoter architecture. This commonly used
‘random telegraph’ model assumes that each promoter can exist
in one of two states—‘ON’ or ‘OFF’—with synthesis of RNA only
possible in the ON state. Because of intrinsic noise exhibited by
the small numbers of molecules involved in transcription (e.g. 1—2
copies of DNA, few available copies of transcriptional regulators)
(Raser and O’Shea, 2005), the promoter produces expression bursts
by switching randomly between the transcriptionally active (ON)
and inactive (OFF) states according to kinetic parameters (rate
constants) that can be estimated from single—cell time series data
(Suter et al., 2011).

Although conceptually useful and amenable to analytical charac—
terization, the random telegraph model is an oversimplification of
the architecture of most promoters. Because of simultaneous regula—
tion by multiple transcription factors as well as chromatin modifica—
tions, the effective number of states for most promoters is thought
to be larger than two (Zhang et al., 2012). A recent study of the
human prolactin gene supports this assertion, where the distribution
of time its promoter spent in an inactive state was inferred to be
strongly non—exponential and thus indicative of multiple, sequential
OFF states (Harper et al., 2011). Classical examples of multi—state
promoters include that of PRM in phage lambda, whose complex
mechanism of regulation gives rise to 128 regulatory states (Sanchez
et al., 2013) and the End016 gene in sea urchin, whose cis—
regulatory domain contains >30 binding sites for 15 different
proteins that perform combinatorial regulation (Yuh et al., 1998).
In light of these observations and the increasing availability of sin—
gle—cell expression data, computational methods are needed for
characterizing complex promoter architectures and efficiently simu—
lating their behavior.

An ideal candidate for such a method would (i) leverage the in—
trinsic noise of the system to better identify underlying mechanisms
(Munsky et al., 2009), (ii) simultaneously infer both the configur-
ation of promoter states and the associated kinetic parameters
needed for predictive simulation and (iii) provide computationally
efficient performance for a wide range of architectures. Currently
existing methods satisfy only a subset of these requirements. Suter
et al. (2011) performed hidden Markov model parameter inference
for two— and three—state promoter architectures, but their models
assume constant (noise—free) promoter activity and RNA levels
between discretely observed time points and they do not provide an
efficient means to characterize architectures with larger numbers
of states. We previously developed Monte Carlo expectation—
maximization (MCEM) with modified cross—entropy method
(MCEMZ), which uses statistically exact stochastic simulations to
infer kinetic parameters from single—cell time series data (Daigle
et al., 2012). However, the original version of MCEM2 does not
enable characterization of promoter architecture. Toni et al. (2009)
developed an approximate Bayesian computation—based method for
inferring both parameters and model structure using stochastic
simulations. Unfortunately, when using this method to discriminate
between promoter models with increasing numbers of states, the
addition of each state increases the number of unknown kinetic

parameters (e.g. switching rates). In the presence of limited amounts
of experimental data, this quickly renders more complex (and thus
more realistic) models non—identifiable. We note that this drawback
applies to any inference method that represents transitions between
individual promoter states explicitly. Finally, stochastic simulation
of multi—state promoter architectures suffers from a linear increase
in computational cost with the addition of each promoter state,
making the study of more complex models difficult.

Because of the limitations described above, our goal in this
work was to develop a computationally efficient method for
characterizing gene expression bursts by inferring the number
and configuration of promoter states from single—cell time series
data.

2 Results

Our results are structured as follows: we first devise a novel model
reduction strategy that represents arbitrary numbers of promoter
states by a single state accompanied by a time—dependent switching
rate. As we demonstrate below, this strategy enables both efficient
simulation and parameter inference. Next, we incorporate this
model reduction into MCEM2 and augment the method to perform
model selection for configuration of promoter states. We demon—
strate the resulting approach—‘bursty MCEM2’—by inferring the
effective numbers of promoter states underlying simulated single—
cell expression data. In addition, we use bursty MCEM2 to
characterize the architecture of the endogenous mouse glutaminase
promoter given experimentally observed time series data (Suter
et al., 2011).

2.1 Model reduction for multi—state promoters
The random telegraph model of transcription can be represented by
the following four chemical reactions:

ken
DNAQFF —4 DNAQN

off

 

DNAONLDNAON + mRNA
mRNAi—KD,

where the promoter randomly switches between OFF and ON states
according to rates [eon and koff. RNA synthesis occurs at rate km
from the ON state and expressed mRNAs live for an exponentially
distributed time interval with mean lifetime 1/ym, where ym is the
mRNA degradation rate.

A simplified version of (1) that is often used to model transcrip—
tional bursting of mRNAs is:

DNAON LDNAON + [3 x mRNA
mRNAi—M (2)

ﬂ N Geometric(63),

where 61 and ﬂ denote the burst frequency and size, respectively.
In the stochastic formulation of (2) [see Gillespie (2007) for back—
ground information], mRNA bursts arrive at exponentially
distributed time intervals with rate 61. Each expression event gener—
ates a geometrically distributed number of transcripts ﬂ with mean
value (1 —C3)/C3 (Evans et al., 2000). Model (2) provides an
increasingly accurate approximation of (1) as koff —> 00, with
c1 : [eon and C3 : koff/(koff —1— km). A sample trajectory of mRNA

112 /§JO'S{eu1no [p.IOJXO'SOUBIHJOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

 

 

 

1430 B.J.Daigle, Jr. et al.
(a) a) —> 0 In this work, we consider transcription propensity functions
m _) m +ﬂ _ of the form c1Cz)(t)C2 , where 61 > 0 and 6220. The corresponding
M E simplified transcription reaction is represented as:
1— F ((0) :
clw(t)c2
m _) m_1 % DNAON —s DNAON + [3 x mRNA. (4)
For this class of propensity functions, the inter—burst arrival time
min distribution can be obtained as follows:
(b) ON 6120;” OFF dF(co) 1 C wag (5)
_— Z 1
m—>m+1 /am do) 1—F(w)
km( 61
w : F(w) = 1 — exp(—ﬁwcz+1>. (6)

s
l

m_1 C m—>m—1
 21

7mm mm

Fig. 1. Schematic of bursty gene expression models. (a) Transcriptional
bursting model where each expression event generates a geometrically dis-
tributed burst of mRNAs. Each mRNA degrades at a constant rate ym.
Bursting and decay reactions are represented by arrows with propensity
functions directly adjacent (e.g. ymm). The state changes at the end of the
arrows (e.g. m —> m— 1) denote the change in m(t) (mRNA level at time 1‘)
and/or m(t) (timer state) when the reactions occur. The timer is set to zero
when mRNA bursts are produced, and it increases as m(t) =1 between
bursts. An example of mRNA trajectory is displayed in the inset plot.
The desired CDF F(-) of the inter-burst arrival time (tk — tk_1 in the plot) is ob-
tained by setting the burst event propensity function to F’(w)/(1 — F(w)).
(b) Promoter-switching model where the promoter randomly toggles
between ON and OFF states. Choosing the ON—OFF transition propensity
functions as monomials in m(t) results in Weibull-distributed ON and OFF
times

copy numbers with transcriptional bursts followed by decay is illus—
trated in Figure 1.

Given the evidence discussed above that promoters exhibit
multiple, sequential OFF states, a more realistic representation of
the reversible reaction in (1) is the following:

DNAQFF1 L DNAOFF2

DNAOFFN_1 k DNAON

k
DNAON ifs DNAOFF, ,

where the promoter exhibits a multi—step OFF to ON transition
with N — 1 OFF states and a single ON state. In contrast to (1), the
distribution of time spent in OFF states between transcription events
is now non—exponential. Specifically, these time increments follow
the hypoexponential distribution, which approaches an Erlang
distribution (Evans et al., 2000) when the switching rates
([31, . . . , kN_1) are roughly equal.

The construction of a simplified transcriptional bursting model
of (3) that mirrors (2) requires the generation of inter—burst arrival
times from an arbitrary distribution. This can be realized by making
the burst frequency time dependent (Fig. 1a). Let m(t) denote the
state of a timer at time t measuring time elapsed since the last burst
event: m(t) is reset to zero whenever bursts occur and dw/dt : 1 in
between burst events. The desired inter—burst arrival time cumula-
tive distribution function (CDF)  is obtained by setting the pro—
pensity function of the transcription reaction to F’/(1 — 
a quantity also known as the hazard function or failure rate (Evans
et al., 2000). Thus, the probability that an mRNA burst event will
occur in the next time interval (t, t —1— dt) is F’(co)/(1 — F(co))dt.

Equation (6) is the CDF of the Weibull distribution with shape
parameter law and scale parameter 2w, where 61 : law/25X? and c2 :
kw — 1 (Evans et al., 2000). The mean (represented by  and
coefficient of variation squared (CV2 E variance/meanz) of this
distribution can be expressed as follows:

Ewe) =  +2) <7)

 

 

 

C1 62 -(— 1
62+3
CV2(CO(t/e)) :  _ 17 (8)

respectively, where tk denotes the lath mRNA burst time and  is
the gamma function. When 62 = 0 (time—independent burst fre—
quency), the Weibull distribution reduces to an exponential distribu—
tion and CV2 : 1. As 62 increases, CV2 monotonically decreases to
zero. Thus, for large values of c2, mRNA bursts arrive at deterministic
time intervals. The Weibull distribution is known to provide an accur—
ate approximation of the Erlang distribution (Malhotra and
Reibman, 1993). This property allows us to mimic the behavior of an
N—state promoter with roughly equal switching rates (3) using a sim—
plified model of transcription with the propensity function c1w(t)cz.
Specifically, by increasing the value of 62, we can simulate expression
from promoters with larger numbers of states. The relationship be—
tween 62 and N is given by the following expression, which is ob-
tained by equating the CV2 of the Weibull and Erlang distributions:
F(Zii) N

62-1—1

 

 

where N is one greater than the Erlang shape parameter (13E in the
Erlang CV2 formula: 1 / 13E).

In model (2) and its modification (4), we assume that mRNA
bursts are instantaneous. This assumption can be relaxed by general—
izing (2) to:

£11w(t)C21

 

DNAOFF DNAON

 

C1260(t)c22
DNAON LDNAON + mRNA
mRNA—Um (2)

where (611, C21) and (C12, C22) contribute to the first and second reac—
tion propensity, respectively, and the timer m(t) resets to zero each
time the promoter transitions between the OFF and ON states
(Fig. 1b). By choosing the transition rates to be monomials in m(t),
the promoter resides in each state for a Weibull—distributed time
interval. Setting C21 : C22 : 0 recovers the standard random tele—
graph model where promoter ON and OFF times are exponentially

112 /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

Inferring gene expression mechanisms

1431

 

distributed random variables. Note that when 622 = 0, in the limit
of large (:12 (i.e. promoter ON state is unstable), (10) reduces to the
instantaneous mRNA burst model [modification (4) of (2)]

2.2 Bursty MCEM2

Single—cell time course datasets are necessarily incomplete—at best,
they provide the numbers of molecules for a subset of the system
species at discrete time points. Because of the intractability of the in-
complete data likelihood for stochastic biochemical systems
(Wilkinson, 2006), the direct calculation of maximum likelihood
parameter estimates (MLEs) is only possible given complete data.
In light of this, we resort to an iterative, simulation—based approach
for computing MLEs using the MCEM algorithm. Previously, we
developed MCEM2 (MCEM with modified cross—entropy method),
a computationally efficient approach for estimating parameters of
stochastic biochemical systems given incomplete data (Daigle et al.,
2012). We describe this approach in more detail in Supplementary
Section S1, and below we present the modifications needed to ac—
commodate the models of transcriptional bursting discussed in the
previous section.

Given our time—dependent transcriptional model reduction, it is
relatively straightforward to construct closed—form update formulas
that enable MCEM2 to infer maximum likelihood estimates for 61
and the geometrically distributed burst size parameter c3 (51 and 53,
respectively). Because of the occurrence of c2 in an exponent, it is
not possible to derive closed—form update formulas for this param-
eter, so we fix its value in the following derivation and select most
probable values for c2 separately via model selection. Specifically,
we use MCEM2 to identify which value of 62 provides the lowest
Akaike information criterion (AIC), a model selection score that
quantifies both data likelihood and model complexity (see
Supplementary Section S3 for details).

We begin by representing each of the system’s M reaction pro—
pensity functions (where M is the total number of reactions in the
system) as an explicitly state— and time—dependent function 61,-(t) : a,-
(X (t), t) defined as follows:

di(X(t), t) E  X (1),-(wolf, 

where X(t) represents the state of the system at time t, I’Ji(X is the
system state—dependent portion of the propensity function and col-(t)
is a reaction—specific timer that resets to zero each time the jth reac—
tion fires. We note that 61,-, C2,- and (1),-(t) are designated with arbi—
trary subscripts only for the purposes of the below derivation; in
practice, each promoter is associated with only one timer m(t) and
at most two values each of 61 and 62. For system reactions with mass
action propensity functions (e.g. 61,-(t) : ai(X(t)) : Hibi(X(t))), the
representation of Equation (11) is achieved by relabeling 0,- as 61,-
and setting 62,- = 0. For the remaining system reactions that exhibit
time—dependent propensities as outlined in the above model formu—
lation, I’Ji(X : 1 and C2,- is nonzero.

With all reaction propensities in the form of Equation (11), we
can use the results of Anderson (2007) to express the distribution
function of the time interval 1' until the next reaction firing, given
the system at the current time t, as:

M t-l-‘C
F(‘E, t) = 1 — exp  clihi(X(t)) x wi(s)czids>, (12)

("=1 t

where X(t) is constant in the integral because no reactions take
place within the time interval [t,t—l— 1'). After differentiating
Equation (12) with respect to t, integrating and simplifying (given

(1),-(t —l— I) : (1),-(t) —l— 1'), we obtain the corresponding density
function:

M
re, a = (Zen-Iowa >< <th) + 
’21 (13)

 

col-(t) + 0527' — (1),-(052i)

52,"

M (
>< exp (Zc1ihi(X(t)) x
(:1

where E2,- = C2,- —1— 1. Given the time of the next reaction firing t —l— ‘L',
we can also express the probability mass function of the index of
the next fired reaction 1" as a simple categorical probability:

Cli’hi’(X(t)) X (mi/(t) + 062/” .
xiii Clihi(X(t)) >< (60,-(t) + 0527'

 

raver, t) = (14)

Taken together, Equations (12—14) allow us to represent the likeli-
hood of a fully observed stochastic trajectory as the following
product:

Tk—I

H (fﬁiati) X p(i;+17ri7ti)) X (1 _ F(Trkatrk»; (15)

i=0

where i indexes the events including the start of each simulation
(1' = 0), the total number of overall reaction firings rk and arrival at
the final time (i : rk —l— 1), t,- is the time interval between the 1th
and (i —l— 1)th events, t,- represents the time immediately after the ith
event and j:- is the index of the ith reaction to fire. By taking the loga-
rithm of Equation (15), differentiating with respect to 61,-, solving
for the unique root and averaging across K’ simulated trajectories,
we obtain a closed—form Monte Carlo update formula:

) )

A(1 _A(0
cl]. —cli

23/221717:
I .   Eli _ '  El]. 7
2k21(Zik0813)hi(xk(tik))><(wlk( “TI/e) COM k) >

52,"

X

 

 

(16)

A A 1 . . . .
where C(13) and C(11) represent the initial guess and first update, re—

spectively, for parameter 61,-, k indexes the K’ simulated trajectories
and rjk is the number of times the jth reaction fires. The equivalence
of Equation (16) and the update formula for parameters from mass
action reactions [Equation (1) in the Supplementary Ingprmgtion]

. For

can be seen by setting 62,- = 0 and relabeling 69,88) as 0/- ,0]-
those reactions with time—dependent propensities, Equation (16)
provides a closed—form expression for inferring the maximum likeli-
hood estimate of 61,- using MCEMZ.

For time—dependent models that incorporate a geometrically
distributed transcriptional burst reaction, inference of parameter C3,-

proceeds by first modifying Equation (15 ) as follows:

Tk—I

H (ﬂu, t1.) x p(j:.+1, ‘5), ti) X g(ﬂi+1=ji+1))
£20 (17)

X(1 _ F(Trkv trle))7

where g(ﬂ, 1") represents the geometric probability mass function
evaluated at a burst size of ﬂ ((1 — 537-01363)» if j’ is a transcriptional
burst reaction and 1 otherwise. Following the same procedure as for
61,-, we obtain a closed—form update formula for 63,-:

Kl
(0) k=1 Tile
3. x , _ , <18)
’ 21:1 (a. + 25:140.) >< (a)

 

112 /§JO'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdillq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

1432

B.J.Daigle, Jr. et al.

 

where 1] ,(j’ ) is an indicator function that takes a value of 1 if j’ = j (0
otherwise).

Taken together, the above derivations combined with MCEM2
enable the construction of ‘bursty MCEMZ’, a novel parameter esti—
mation and model selection framework for inferring the number and
configuration of promoter states from single—cell expression data.
Supplementary Section S2 provides additional details of the method.

2.3 Simulation study

To illustrate the accuracy of our model reduction along with bursty
MCEMZ’s ability to select a plausible multi—state transcriptional
model given observed data, we first performed a simulation study
using three models with different numbers of promoter states.
Model (A) represents a single—state promoter, which exhibits con—
stant (non—bursty) production of mRNA:

DNAON —25'0 DNAON + mRNA (A)
mRNAﬂ’L (2).

In the above system, the transcription reaction produces an average
of five mRNA molecules per unit of time, whereas mRNAs are
degraded at a much lower rate. Model (B) contains a promoter with
three states—two OFF states and a very short—lived ON state—
which exhibits bursty mRNA production. It modifies (A) by replac—
ing the first reaction with the following:

DNAOFF, % DNAOFF, % DNAON
DNAONﬂL DNAOFF, (B)
DNAONﬂL DNAQN + mRNA.

As before, the rates of (B) were chosen so that the promoter would
produce five mRNA molecules per time unit on average. However,
rather than exhibiting constant production, the promoter switches
from OFF to ON once per time unit on average and quickly outputs
a burst of mRNA molecules with mean burst size 5 00.0/ 100.0 : 5
before returning to OFF. Finally, model (G) contains a promoter
with six states that also exhibits bursty mRNA production. It modi—
fies (B) by replacing the first two reactions with the following:

5.0505 5 .05 05
IDNIAOFF1 ——> DNAOFFZ ——> DNAOFF3

DNAOFF3 LOSE DNAOFF4 LOSE DNAOFFS (C)

DNAOFFS 5—050i DNAON.
As in model (B), this promoter switches from OFF to ON once per
time unit on average, and it outputs bursts of mRNA with mean size
5 before returning to OFF. The mRNA degradation rates of all three
models are identical.

For each model, we first simulated a single trajectory over 100
time units and recorded the number of mRNA molecules at 400
equally spaced intervals. The starting conditions for each simulation
were 0 mRNA molecules and 1 promoter in states
DNAON,DNAOFF1 and DI\IA()1:1:1 for models (A), (B) and (C), re—
spectively. Supplementary Figure S1 (Supplementary Section S5) dis—
plays the three simulated trajectories.

Given each synthetic data trajectory, we used our time—depend—
ent transcriptional model reduction with bursty MCEM2 to infer the
unknown parameters (61, c2, 63) from models (D) and (E):

DNAON—Cla DNAON + mRNA

mRNA——>'0001 (2)

cl w(t)c2

DNAQN—H DNAON -(— ﬂ >< mRNA

mRNA——>‘0001 (2) (E)

ﬂ N Geometric(C3 ),

where the mRNA degradation rate is given. The general version of
model (E) is shown in Figure 1a. We used bursty MCEM2 to per—
form parameter inference and model selection on each data trajec—
tory using model (D) and three versions of model (E) with different
values of 62: (i) 62 = 0, (ii) 62 = 0.4 and (iii) 62 : 1.4. These four
model parameterizations correspond to promoters with one, two,
three and six states, respectively. We set the initial guesses for par—
ameters 61 and c3 to 1 and 0.5, respectively. Since the initial value of
the reaction clock (0(0) was unobserved, we set it to 0 for all bursty
MCEM2 model simulations. Table 1 lists the resulting MLEs
(E1, 53), log likelihoods, AIC values and relative likelihoods for each
data—model combination.

As this table shows, bursty MCEM2 selected the model with the
correct number of states as most probable for each synthetic data
trajectory. For data from the one— (A) and six—state (C) models, com—
peting models did not achieve a relative likelihood within an order
of magnitude of a 0.368 cutoff (relative likelihood difference of 2
AIC units from best fitting model); for data from the three—state
model (B), the two—state version of model (E) provided a second—best
fit that was still substantially worse (likelihood:0.052) than the
cutoff. When inferring parameters of the one—state model (D) using
data from model (A), 61 = 4.81 is close to the true value of 5 and
51’s 68% confidence interval (459—5 .03) includes the true value.
Similarly, the inferred mean burst sizes for the most probable models
fitting data from models (B) and (C) (5.37 and 4.20, respectively)
are close to the true value of 5 and the 68% and 95% confidence
intervals, respectively, of these two estimates ([4.73—6.09] and
[3.28—5 .32]) both include the true value. Finally, we note that results
for model (D) were unavailable when fitting data from models (B)
and (C), as the lack of transcriptional bursts in a one—state model
precluded the simulation of trajectories matching data with bursts.

2.4 Glutaminase data inference
Next, we applied bursty MCEM2 to actual time—lapse microscopy
data from a reporter gene driven by a mammalian promoter. Suter
et al. (2011) measured gene expression at eight endogenous mouse
promoters upstream of luciferase reporter genes. Using these data,
the authors estimated the values of transcriptional parameters by
modeling each promoter as occupying two or three states. Our goal
was to use our model reduction with bursty MCEM2 to infer
whether one of these promoters likely occupies more than three
states. To this end, we extracted a single trajectory of luminescence
data collected once every 5 min from the glutaminase promoter
(Fig. 1G in Suter et al., 2011) and performed data smoothing and
calibration to convert light intensity values to numbers of proteins
(see Supplementary Section S4 for details). Figure 2 displays the glu-
taminase trajectory before and after preprocessing.

We then used bursty MCEM2 to infer the unknown parameters
(61, c2, c3, kon,koff,km) from models (F), (G), (H) and (I) given the
data from Figure 2b:

DNAON—Cla DNAON + mRNA
mRNAﬁL (2)
mRNAi6—> mRNA —l— Protein

. 1.98
Prote1n——> 0

112 /§JO'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdillq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

 

 

 

 

 

 

Inferring gene expression mechanisms 1433
Table 1. Bursty MCEM2 parameter inference and model selection results for simulation study
No. states data No. states model C2 61 1:3 Log likelihood AIC Relative likelihood
1 (A) 1 (D) NA 4.81 NA —566.94 1135.87 1

2 (E) 0 41.43 0.12 —569.95 1145.91 0.0066

3 (E) 0.4 139.67 0.16 —570.50 1146.99 0.0038

6 (E) 1.4 1990.31 0.26 —572.42 1150.85 0.00056
3 (B) 1 (D) NA NA NA NA NA NA

2 (E) 0 0.97 5.04 —402.32 810.65 0.052

3 (E) 0.4 1.08 5.37 —399.37 804.74 1

6 (E) 1.4 1.48 5.18 —402.91 811.82 0.029
6 (C) 1 (D) NA NA NA NA NA NA

2 (E) 0 1.19 3.60 —421.53 849.05 1.14 x 10‘7

3 (E) 0.4 1.40 4.00 —412.58 831.16 0.00088

6 (E) 1.4 1.91 4.20 —405.54 817.08 1

 

Corresponding model letter is displayed next to the number of states in the ﬁrst and second columns. 51 and 53 represent MLEs for cl and C3, respectively. The

expression (1 — E3) /E3 represents mean burst size for models with transcriptional burst reactions. True values for cl and (1 — C3)/C3 are both equal to 5. Relative

likelihoods are computed separately for each data trajectory; results in bold represent most probable models. Values of ‘NA’ for C2 and (1 — E3) /E3 due to model

(D) lacking these parameters; remaining NA values from ﬁtting data of models (B) and (C) due to inability of one-state model to generate trajectories matching

data with bursts.

 

25—
20_ (a)
15—
10—

5-

 

 

 

Light intensity (AU)

0 T I I I I
o 10 20 3o 40
Time (hours)

 

3oo - (b)
250 -
zoo —
150 -
100 —

5o -

 

 

Nurrioer of proteins

 

0 1'0 2'0 3'0 4'0
Time (hours)

Fig. 2. Glutaminase promoter time-lapse microscopy data from Suter et al.
(2011). (a) before and (b) after data smoothing and calibration. Data consist of
539 measurements sampled approximately once every 5min for 43.5 h. AU,
arbitrary units
61w(t)c2
DNAON ——>DNAQN -(— ﬂ >< mRNA 
6 N Geometric(C3)

on

k
—? DNAON
clw(t) 2 

DNAONLDNAON + mRNA

DNAOFF

 

cl w(t)c2
—4 DNAON
koff (I)

DNAON LDNAON + mRNA,

DNAOFF

 

where the latter three models also include the mRNA degrad—
ation, protein translation and protein degradation reactions of
model (F) with given rate constants. Models (F) and (G) are

similar in structure to models (D) and (E), respectively, with pro—
tein translation and degradation reactions added. Models (H) and
(I) represent promoters with multi—step ON to OFF and OFF to
ON transitions, respectively. Figure 1b represents models (H) and
(I) by selecting appropriate values for 611, C21, 612 and 622. Like
models (B) and (C), these two models exhibit burst—like transcrip-
tion with the proper parameterization, and they do not assume
instantaneous production of bursts. All four models share fixed,
identical rates of mRNA degradation (derived from the 45-min
glutaminase reporter mRNA half life experimentally determined
by Suter et al., 2011), protein degradation (derived from the 21
minute luciferase protein half life experimentally determined by
Suter et al., 2011) and protein translation (reported in Molina
et al., 2013). We performed model selection over all models,
using fixed values of 62 (when present) ranging from 0 to 11.
Altogether, these models approximate the behavior of promoters
containing 1—101 states. We set the initial guesses for all other
unknown parameters to 1 (except for 63, which was set to .5).
As before, we set the initial value of the reaction clock (0(0) to 0
for all bursty MCEM2 model simulations. In addition, we set the
unobserved initial state of the promoter for models (H) and (I)
to DNAOFF. Finally, for the unobserved initial number of mRNA
molecules, we tried values from zero to 30 in increments of five.
However, as 20 molecules allowed the simulation of trajectories
with the largest observed data likelihood, we used this number
for all bursty MCEM2 model simulations. Supplementary Tables
S1 and S2 (Supplementary Section S5) and Table 2 lists the re—
sulting parameter estimates, log likelihoods, AIC values and rela—
tive likelihoods (calculated across all models) for versions of
models (F), (G), (H) and (I).

As Supplementary Tables S1 and S2 show, no versions of models
(F), (G) or (H) provide plausible fits to the data. From these results,
we predict that the glutaminase promoter (i) occupies at least one
OFF state, (ii) does not exhibit instantaneous bursting of mRNA
and (iii) does not undergo a multi—step ON to OFF transition with
a single OFF state. Instead, the results in Table 2 suggest that
model (I) exhibiting a multi—step OFF to ON transition with a single
ON state best fits the data, and we predict that the glutaminase pro—
moter occupies between 10 and 50 OFF states (model versions
with relative likelihood 2.368) in the process of transitioning to a
single ON state. Once in the ON state, our results predict a mean

112 /810'S{12u1no [p.IOJXO'SOTlBIHJOJUIOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

1434

B.J.Daigle, Jr. et al.

 

Table 2. Bursty MCEM2 parameter inference and model selection
results for model (I) using glutaminase data

 

NO. C2 Cl koff
states likelihood

77‘:
5

Log AIC Relative
likelihood

 

2 0 2.14 5.52 75.52 —1738.01 3484.02 0.000047
3 0.40 2.78 4.26 72.64 —1734.57 3477.15 0.0015
4 0.75 3.50 3.96 72.62 —1732.58 3473.16 0.011
5 1.10 4.33 3.67 71.15 —1731.10 3470.19 0.047
6 1.40 5.26 3.68 71.89 —1730.33 3468.67 0.10

7 1.65 6.30 3.60 70.85 —1729.75 3467.49 0.18

9 2.10 8.66 3.69 72.10 —1729.08 3466.17 0.35
11 2.50 11.44 3.62 71.12 —1728.60 3465.19 0.58
16 3.40 19.36 3.52 70.23 —1728.06 3464.13 0.98
21 4.10 28.40 3.35 68.14 —1728.06 3464.11 0.99
26 4.75 40.28 3.30 67.62 —1728.05 3464.09 1

51 7.40 161.84 2.84 61.65 —1728.77 3465.53 0.49
101 11.00 1019.21 2.49 56.74 —1729.18 3466.36 0.32

 

El, Eoff and [gm represent MLEs for cl, koff and lam, respectively. Relative
likelihoods are computed across all versions of models (F), (G), (H) and (I);
results in bold font represent models that best ﬁt the data (relative likelihood
20 .368).

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

U) U')

C C

E 300- (a)  300- (b)

e 250- 9 250-

3200- 3200-

3 150- g 150-

g 100- g 100-

g 50- g 50-

Z 0:) 1'0, 20 30 4o 2 03 1'0_ 20 30 40
Tune (hours) TIme (hours)

E 300- 3'0" c —2 14

“g 250- (c) 2-5‘ (d) c; '

9 3* 2 0 — c1 =2.78

3200 (7, - c2=0.4

O C 1.5 —C1 

L 150 a,

a, D 1 0_ c2=4.75

Q 100 .

g 50- 0.5-

2 0 3 1'0. 20 30 4'0 000:0 ' 0:4 ' 0:8 ' 1:2 '
TIme (hours) Time in OFF state (hours)

Fig. 3. Differences between versions of model (I) with varying numbers of
OFF states. Simulated trajectories using the MLEs from Table 2 for (a) two-
state, (b) three-state and (c) most probable 26-state model versions.
(d) Comparison of OFF state dwell time distributions between model versions
[obtained by differentiating the Weibull distribution function (6)]. Two- and
three-state promoter models exhibit more variable OFF times than 26-state
promoter model. Values of c1 and 02 used for each model version are shown

transcriptional burst size of ~20 (12m / 120,7) before returning to the
first OFF state.

These predictions are in stark contrast to the two— and three—state
promoter models used in Suter et al. (2011) to model the glutami—
nase promoter. To illustrate the differences between these models,
Figure 3 displays simulated trajectories and OFF state dwell time
distributions from versions of model (I) with 2, 3 and most probable
26 states (and the corresponding MLEs from Table 2). As Figure 3d
shows, the 26—state version of model (I) exhibits much less variable
OFF state dwell times than the two— or three—state versions. This is
reﬂected in the tendency of the trajectory in Figure 3c to stay
above a small number of proteins (~25), while the trajectories in
Figure 3a and b occasionally decrease to near zero. The glutaminase
data trajectory in Figure 2b also consistently remains above 25 pro—
teins, providing visual evidence for the superior fit of a 26—state
promoter model to the data.

3 Discussion

In this work, we present a novel model reduction for multi—state pro—
moters along with an efficient computational technique for inferring
the number and configuration of promoter states from single—
cell gene expression data. Specifically, we first developed a time—
dependent reaction propensity function for transcriptional bursting
that generates Weibull—distributed ON/OFF promoter state dwell
times. Using this function, we demonstrated an ability to closely
approximate the behavior of promoters undergoing multi—step tran—
sitions between OFF and ON states. Next, we created ‘bursty
MCEMZ’ which, when combined with our model reduction, allows
for computationally efficient parameter inference and model
selection across a wide range of promoter architectures.

As an example of the computational savings conferred, we note
that modeling a promoter transitioning between nine OFF states and
one ON state requires specification of 10 switching parameters and
simulation of 10 chemical reactions per transcriptional cycle. In con—
trast, use of our time—dependent propensity function introduces
only three parameters and requires the simulation of only two reac—
tions per cycle. These computational and parametric savings in-
crease linearly with the number of promoter states modeled,
enabling efficient analysis of arbitrarily complex promoter architec—
tures with bursty MCEMZ.

Through a simulation study, we demonstrated the ability of
bursty MCEM2 to correctly identify the number of promoter states
used to generate single—cell time—series trajectories. In addition, we
showed that our method accurately infers the values of kinetic par-
ameters within the chosen promoter model. We then applied bursty
MCEM2 to experimental time—lapse microscopy data from a re—
porter gene driven by the endogenous mouse glutaminase promoter
(Suter et al., 2011). Our results suggest that, rather than occupying
two or three states as previously described, the glutaminase pro—
moter likely traverses through 10 or more OFF states before tran—
scribing mRNA from an ON state. We hypothesize that a distinct
advantage of a promoter architecture with >10 states lies in its po—
tential noise buffering properties. As the number of states increases,
promoter OFF times become more deterministic, leading to more
consistent rates of mRNA production. As shown in Figure 3c, this
leads to less variable protein levels over time (particularly at lower
levels), which can confer more robust behavior in response to sto—
chastic perturbations. Because of the intrinsic noise present in the
transcriptional and translational machinery, we note that the confi—
dence interval accompanying our estimated number of glutaminase
promoter OFF states is somewhat large (10—50). The addition of
measurements at later time points would certainly help reduce this
uncertainty. However, if protein measurements were replaced with
direct quantification of mRNA, we would expect a much more pre—
cise estimate, since translational noise would no longer affect our
analysis. Results from the simulation study support this, where we
obtained more precise estimates of numbers of promoter states by
performing inference on mRNA data.

When discussing particular numbers of promoter states within
our model reduction, it is important to note that these values repre—
sent ‘effective’ numbers of states rather than distinct biochemical con—
figurations. In particular, since the correspondence between the
parameters of the Weibull distribution and the number of promoter
states (4) is most accurate when the switching rates are equal, the
effective number of states is likely an underestimation of the true
number. This follows from the observation that as the switching rates
depart from equality, the slowest promoter transitions become rate—
limiting and thus mask the presence of faster transitions. Given that

112 /810'spaumo [p.IOJXO'SOTlBIHJOJUIOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Inferring gene expression mechanisms

1435

 

one of our goals in this work was to demonstrate that mammalian
promoters occupy more than two or three states, this discrepancy
only strengthens the conclusions drawn from our results.

In conclusion, we anticipate that our novel approach to model—
ing promoter fluctuations together with bursty MCEM2 provides
powerful tools for characterizing transcriptional bursting across
genes under different environmental conditions. Future work will
focus on discovering general transcriptional regulatory principles by
applying these methods to single—cell expression data from a wide
range of promoters.

Funding

A.S. was supported by the National Science Foundation Grant [DMS-
1312926], University of Delaware Research Foundation (UDRF) and Oak
Ridge Associated Universities (ORAU). B.J.D. and L.R.P. were supported
by NIH ROI-EB014877, DOE DE-SC0008975 and the Institute for
Collaborative Biotechnologies through grant [W911NF-09-0001] from the
US. Army Research Office. The content of the information does not necessa-
rily reﬂect the position or the policy of the Government, and no official
endorsement should be inferred. We also acknowledge computing support
from the UCSB Center for Scientific Computing from the CNSI, MRL: an
NSF MRSEC (DMR-1121053) and NSF CNS-0960316.

Conﬂict of Interest: none declared.

References

Anderson,D.F. (2007) A modiﬁed next reaction method for simulating chem-
ical systems with time dependent propensities and delays. ]. Chem. Phys.,
127, 214107.

Cai,L. et al. (2006) Stochastic protein expression in individual cells at the
single molecule level. Nature, 440, 35 8—362.

Choi,P.]. et al. (2008) A stochastic single-molecule event triggers phenotype
switching of a bacterial cell. Science, 322, 442—446.

Daigle,B.]. Jr. et al. (2012) Accelerated maximum likelihood parameter esti-
mation for stochastic biochemical systems. BMC Bioinformatics, 13, 68.

Dar,R.D. et al. (2012) Transcriptional burst frequency and burst size are
equally modulated across the human genome. Proc. Natl Acad. Sci. USA,
109, 17454—17459.

Evans,M. et al. (2000) Statistical Distributions. 3rd edn. Wiley,
New York, NY.

Gillespie,D.T. (2007) Stochastic simulation of chemical kinetics. Annu. Rev.
Phys. Chem., 58, 35—55.

Golding,I. et al. (2005) Real-time kinetics of gene activity in individual
bacteria. Cell, 123, 1025—1036.

Harper,C.V. et al. (2011) Dynamic analysis of stochastic transcription cycles.
PLoS Biol., 9, e1000607.

Lee,T.I. and Young,R.A. (2013) Transcriptional regulation and its misregula-
tion in disease. Cell, 152, 1237—1251.

Malhotra,M. and Reibman,A. (1993) Selecting and implementing phase
approximations for semi-Markov models. Commnn. Statist.—Stochastic
Models, 9, 473—506.

Molina,N. et al. (2013) Stimulus-induced modulation of transcriptional burst-
ing in a single mammalian gene. Proc. Natl Acad. Sci. USA, 110,
20563—20568.

Munsky,B. et al. (2009) Listening to the noise: random ﬂuctuations reveal
gene network parameters. Mol. Syst. Biol., 5, 318.

Raj,A. et al. (2006) Stochastic mRNA synthesis in mammalian cells. PLoS
Biol., 4, e309.

Raser,].M. and O’Shea,E.K. (2005) Noise in gene expression: origins,
consequences, and control. Science, 309, 2010—2013.

Sanchez,A. et al. (2013) Stochastic models of transcription: From single mol-
ecules to single cells. Methods, 62, 13—25.

Singh,A. (2014) Transient changes in intercellular protein variability identify
sources of noise in gene expression. B iophys. ]., 107, 2214—2220.

Singh,A. et al. (2010) Transcriptional bursting from the HIV-1 promoter is a
signiﬁcant source of stochastic noise in HIV-1 gene expression. Biophys. ].,
98, L32—L34.

So,L.-H. et al. (2011) General properties of transcriptional time series in
Escherichia coli. Nat. Genet., 43, 554—60.

Suter,D.M. et al. (201 1) Mammalian genes are transcribed with widely differ-
ent bursting kinetics. Science, 332, 472—4.

Toni,T. et al. (2009) Approximate Bayesian computation scheme for param-
eter inference and model selection in dynamical systems. ]. R. Soc. Interface,
6, 187—202.

Wilkinson,D.]. (2006) Stochastic Modelling for Systems Biology. Chapman
and Hall/CRC Mathematical and Computational Biology Series. Taylor and
Francis Group, Boca Raton, FL.

Yu,]. et al. (2006) Probing gene expression in live cells, one protein molecule
at a time. Science, 311, 1600—1603.

Yuh,C.H. et al. (1998) Genomic cis-regulatory logic: experimental and
computational analysis of a sea urchin gene. Science, 279, 1896—902.

Zhang,]. et al. (2012) Analytical distribution and tunability of noise in
a model of promoter progress. B iophys. ]., 102, 1247—5 7.

112 /810'Spaumo [p.IOJXO'SOTlBIHJOJUIOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

