ORIGINAL PAPER

Vol. 30 no. 24 2014, pages 3443-3450
doi: 10. 1 093/bioinformatics/btu436

 

Genome analysis

Advance Access publication July 12, 2014

Multi-factor data normalization enables the detection of copy
number aberrations in amplicon sequencing data

Valentina Boeva1’2’3’*

, Tatiana Popova2’4, Maxime Lienard5, Sebastien Toffoli5,

Maud Kamal6, Christophe Le Tourneau1’7, David Gentien8, Nicolas Servant1’2’3,
Pierre Gestraud1’2’3, Thomas Rio Friog, Philippe Hupé1’2’3’10, Emmanuel Barillot1’2’3 and

Jean-Francois Laes11

1lnserm, U900, Bioinformatics, Biostatistics, Epidemiology and Computational Systems Biology of Cancer, 2lnstitut
Curie, Centre de Recherche, 26 rue d’Ulm, Paris 75248, 8Mines ParisTech, Fontainebleau 77300, 4lnserm, U830,
Genetics and Biology of Cancers, Paris 75248, France, 5Institut de Pathologie et de Génétique, Gosselies 6041,
Belgium, 6Clinical Research Department, 7Department of Medical Oncology, 8Plateforme de Génomique, Département
de recherche translationnelle, Centre de recherche, 9Next—generation sequencing platform, lnstitut Curie, 1OCNRS,
UMR144, Subcellular Structure and cellular Dynamics, Paris 75248, France and 11OncoDNA, Gosselies 6041, Belgium

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: Because of its low cost, amplicon sequencing, also
known as ultra-deep targeted sequencing, is now becoming widely
used in oncology for detection of actionable mutations, i.e. mutations
influencing cell sensitivity to targeted therapies. Amplicon sequencing
is based on the polymerase chain reaction amplification of the regions
of interest, a process that considerably distorts the information on
copy numbers initially present in the tumor DNA. Therefore, additional
experiments such as single nucleotide polymorphism (SNP) or com-
parative genomic hybridization (CGH) arrays often complement ampli-
con sequencing in clinics to identify copy number status of genes
whose amplification or deletion has direct consequences on the effi-
cacy of a particular cancer treatment. So far, there has been no proven
method to extract the information on gene copy number aberrations
based solely on amplicon sequencing.

Results: Here we present ONCOCNV, a method that includes a multi-
factor normalization and annotation technique enabling the detection of
large copy number changes from amplicon sequencing data. We vali-
dated our approach on high and low amplicon density datasets and
demonstrated that ONCOCNV can achieve a precision comparable
with that of array CGH techniques in detecting copy number aberrations.
Thus, ONCOCNV applied on amplicon sequencing data would make the
use of additional array CGH or SNP array experiments unnecessary.
Availability and implementation: http://oncocnv.curie.fr/

Contact: valentina.boeva@curie.fr

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 5, 2014; revised on June 17, 2014; accepted on
July 2, 2014

1 INTRODUCTION

The emergence of the amplicon sequencing technique, which fol-
lowed whole-exome sequencing (WES), promises a revolution in

 

*To whom correspondence should be addressed.

cancer diagnostics and treatment. Amplicon sequencing consists
of the polymerase chain reaction (PCR) ampliﬁcation of a lim-
ited number of the genomic regions of interest (amplicons) fol-
lowed by high-throughput sequencing (Supplementary Fig. SlA)
(Beadling et al., 2013). Each amplicon often coincides with an
exon; exons longer than the typical length of PCR reaction prod-
ucts may be covered by two or more amplicons (Supplementary
Fig. SlB).

Although relatively expensive exome sequencing consists of in-
depth sequencing of nearly all the coding exons, the amplicon
sequencing technique aims at sequencing a limited number of
genes (from several dozen to several thousand exons) at an eX-
tremely low cost. The genes included in a panel of amplicon
sequencing (actionable genes) are genes that are often altered in
different cancer types, and for whose alterations targeted thera-
pies have been established or are in clinical development. For in-
stance, the TargetRichTM CRX kit from Kailos Genetics assays
such cancer-related genes as BRAF, EGFR, FLT 3, JAK2, KIT,
KRAS, PIK3CA, PTEN, TP53 and VEGFA; the AmpliSeqTM
Cancer Panel from Life Technologies targets 190 regions of inter-
est in 46 well-characterized oncogenes and tumor suppressors.

Some actionable genes often undergo point mutation or exon
deletions (e.g. ALK, BRAP), whereas others undergo ampliﬁca-
tion in copy number (e. g. M YCN, ERBBZ) (Garraway and
Lander, 2013; Small et al., 1987). Because of the exceedingly
high read coverage of amplicon sequencing data, there is no meth-
odological issue in the identiﬁcation of point mutations and small
insertions or deletions (indels). However, how to reliably detect
copy number changes, in particular gene deletions and ampliﬁca-
tions, in amplicon sequencing data is still open to discussion.

Here, we focus on the identiﬁcation of copy number alter-
ations (CNAs) also known as large copy number changes
(CNVs) of the actionable genes targeted by amplicon sequencing.
Although there are several algorithms to detect CNAs in exome
sequencing data (Amarasinghe et al., 2013; Boeva et al., 2011; Li
et al., 2012), it is questionable as to whether the same approaches
can be efﬁcient when applied to amplicon sequencing data. First,

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§.IO'S[BU.IHO[p.IOJXO'SOTmIHJOJUTOTQﬂI(1111] U101} popeoIII/noq

9IOZ ‘091sn3nv uo ::

V.Boeva et al.

 

amplicon sequencing targets fewer regions and thus provides less
information than exome sequencing datasets (<10 000 exons
versus >200 000 exons); consequently, data normalization can
be less effective on amplicon sequencing data. Second, because
of the different protocols used for library preparation, amplicon
sequencing data can have various biases. Importantly, while for
exome sequencing experiments an effort has been made to uni-
form exon coverage, amplicon sequencing technology empha-
sizes extremely high depth of coverage with less regard to
coverage homogeneity.

Here we provide a solution to the challenging question of ex-
tracting CNAs from amplicon sequencing data by (i) deﬁning a
method to normalize read coverage with a small set of normal
control samples and (ii) assigning statistical signiﬁcance to puta-
tive CNAs resulting from the segmentation of normalized pro-
ﬁles. We validated the proposed method on (A) a high amplicon
density dataset of eight tumor samples for which array compara-
tive genomic hybridization (array CGH) proﬁles were available,
(B) a high amplicon density dataset of 30 ErbB2—positive ovarian
cancer samples and (C) a low amplicon density dataset of 30
tumors, coupled with single nucleotide polymorphism (SNP)
array data. We show that the results obtained from the
ONCOCNV method compare favorably with the results
obtained from ADTEx (Amarasinghe et al., 2013) and
NextGENe (http ://www.softgenetics.com/NextGENe_0 l 3.
html), which are respectively public-domain and commercial
software designed to detect CNVs in whole exome sequencing
data.

2 MATERIALS AND METHODS

In this article, we present a method for detecting copy number changes in
sequencing data generated for a relatively small panel of genes. We ﬁrst
apply several normalization steps: library-speciﬁc (normalization for li-
brary size, GC content and amplicon length) and technology-speciﬁc
normalization (normalization with a control baseline); the next steps
are segmentation and gene-aware correction of the predicted CNAs
(Fig. l). The only requirement for the selection of diploid control samples
is that they should be processed using the same target selection kit as the
tumor samples.

2.1 Datasets

To validate our method, we used three experimental amplicon sequencing
datasets: A, B and C. The high amplicon density tumor DNA for datasets
A and B was subjected to amplicon sequencing with target selection using
the Ion XpressTM Plus Fragment Library Kit by Life Technologies (panel
of 406 genes including >6500 exons covered by >15000 amplicons).
Dataset C is a part of the SHIVA clinical trial (Le Tourneau et al.,
2012). This dataset was generated using the Ion AmpliSeqTM Cancer
Panel V1 in combination with the Ion AmpliSeqTM Library Kit 2.0 by
Life Technologies; for our analysis, we used 11 genes covered by 96
amplicons. We used 15 diploid samples (high amplicon density, control
dataset X) and 6 diploid samples (low amplicon density, control dataset
Y) to create the baseline for the normalization of datasets A/B and C,
respectively.

In addition to amplicon sequencing, the tumor samples from dataset A
were analyzed using an array CGH technique. Tumor samples from
dataset C were processed with SNP arrays. The details of the processing
of array CGH and SNP array data are provided in the Supplementary
Materials.

Control 1 Control N

l l W

Library size, GC-content, amplicon length normalization

l I

First 3 PCA components = Baseline

Linear regression Linear regression
using the baseline using the baseline

Normalized control proﬁles NormaIIZEd tumor

proﬁle

 

Evaluation of standard deviation

as a function of Pa Segmentation and inferring

of zero level

1

Correction of standard
T-test and ﬁxed variance test <— deviation with the overall
standard deviation

Final predictions of
CNA regions

Fig. 1. Workﬂow of ONCOCNV. Control samples may be processed
separately from tumor samples. As ONCOCNV performs normalization
by GC content and amplicon length, it is not critical for the control
samples to be sequenced jointly

 

CNA regions

Readjustment of segmentation
with a gene-aware model

2.2 Read counting

In the analysis of high-throughput sequencing data, an appropriate def-
inition of read counts (RCs) is of high importance. In whole-genome
sequencing data, RC refers to the number of reads starting in a given
window (Boeva et al., 2011). In WES and RNA sequencing data analysis,
RC corresponds to the number of read mappings overlapping each exon
(Amarasinghe et al., 2013). When dealing with amplicon sequencing data,
one could apply a similar approach and reasoning in terms of exons.
However, this may lead to a loss of information. In amplicon sequencing,
one exon can be targeted using two or more closely located or overlap-
ping amplicons; averaging this information will decrease the sensitivity of
CNA detection. In ONCOCNV, we therefore implemented an intuitive
procedure to calculate RCs: each read is assigned to only one amplicon
region, the one with which the read alignment has the maximum overlap.
In the case of highly overlapping amplicons, it can be unclear which
amplicon generated the read. We therefore merge amplicons when two
of them overlap each other by >75% of their lengths.

Given that the amplicon sequencing reads are single ended and sequen-
cing depth is extremely high, we do not discard duplicate reads to avoid
distorting the RC disproportionately (Zhou et al., 2014).

2.3 Normalization of RCs per target

The RC processing method implemented in ONCOCNV includes nor-
malization for library size, GC content of each amplicon region and
amplicon length. We call these kinds of biases ‘library speciﬁc’. The
exact shape of the functional dependency of the RC on the GC content
and amplicon length may be different in each library (Supplementary Figs
S2A, B and S3A, B).

 

3444

112 /810'S[12umo IpJOJXO'SOIJBIIIJO}UIOIQ//ZCIllq U101} prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

Detection of copy number aberrations in amplicon sequencing data

 

 

 

>
2

log(NRCLib) , control 1

w
3

log(NRCGC) , control 10

 

 

 

 

 

            

 

 

-8 -6 —4 —2

l l
0.2 0.4 0.6 0.8 70 90 110
GC-content

| |
130
Amplicon length

 

 

O
U

0
|
E

II
.0
3

l
:.
3:55,:
 1'
CGHa logRatio
mean value per gene
0
l

-0.4 -0.2 0.0
l

R=0.83
ﬂit

CGHa logRatlo
mean value per gene
—0.4 —0.2 0.0
l

 

 

 

 

 

 

l | l l l | l l l l

—4 —3 —2 —1 0 1 —1.0 —0.5 0.0 0.5
log(RRC), log(NRC),

mean value per gene mean value per gene

Fig. 2. Normalization of RC data improves correlation with array CGH
measurements. (A) GC-content bias. The y-axis shows the RC normalized
with respect to library size (Sample Xl). (B) Amplicon length bias. The )2-
axis shows the RC normalized with respect to GC-content and library
size (Sample X10). (C) Correlation between RRCs and log-ratio values of
array CGH (Sample Al). (D) Correlation between NRCs and log-ratio
values of array CGH (Sample Al). In (C) and (D), mean value per gene is
shown

2.3.1 Normalization with respect to library size The average
number of reads from a library mapped to an amplicon is Avg = N/R,
where N is the total number of reads and R is the total number of
amplicons. We normalize the raw read count (RRC) by the library size:
NRCLil7 =RRC/Avg, where NRCLil7 stands for the RC normalized with
library size. Under the assumption of comparable efﬁciency of PCR amp-
liﬁcation for all regions targeted, the RRC values would be similar for
different amplicons, and thus, the normalized read count (NRC) values
would typically be close to 1 (Supplementary Fig. S4).

2.3.2 Normalization with respect to CG-content For target
sequencing data, as for whole-genome sequencing data (Boeva et al.,
2011), we observe a signiﬁcant GC-content bias (Fig. 2A and
Supplementary Fig. S2A). The shape of the GC-content dependency
may vary even between datasets generated within the same laboratory
(Supplementary Fig. S2B). We correct for the GC-content bias by using
local polynomial regression ﬁtting [LOESS (Cleveland et al., 1992), R
package stats, degree = 2]. The resulting values NRCGC do not
depend on the GC content of the amplicon sequences (Supplementary
Fig. S2C).

2.3.3 Normalization with respect to target length We observed
that smaller amplicons usually generate more RCs than larger ones, prob-
ably owing to more efﬁcient PCR ampliﬁcation for smaller DNA frag-
ments (Supplementary Fig. S2B and S3A). Similar to the GC content, this
bias can be more or less pronounced in different samples (Supplementary
Fig. S3B). We correct for the amplicon length bias by using the same
technique as for the GC-content correction, i.e. LOESS (Cleveland et al.,
1992). The resulting values NRCLen do not depend on the GC content
(Supplementary Fig. S3C) or on the length (Supplementary Fig. S3D) of
the amplicon sequence.

2.4 Establishment of baseline

In addition to the library-speciﬁc bias, there is a technology-speciﬁc bias.
This bias, even after normalization for the library-speciﬁc bias, is present
to a different extent in the RCs (Supplementary Fig. S5A and B).
Therefore, for each technological platform, we construct a baseline that
reﬂects the technological bias in the diploid control samples and use it for
the normalization of test samples.

To construct the baseline, we apply principal component analysis
(PCA) to the NRCs NRCLen from the diploid samples. The ﬁrst principal
component (PCl) captures the most variation in NRC Len and highly cor-
relates with the average value of NRC Len over the control samples
(Pearson correlation 0.99, Supplementary Fig. S6). We observed that it
was important to keep the second and third PCs, as they capture add-
itional biases (Supplementary Fig. S5C). In our example (datasets A and
B), the ﬁrst three components account for 90.5% of the total variance in
the NRCs of the diploid control samples, whereas the ﬁrst component
explains only 79% of the variance (Supplementary Fig. S6A). Thus, by
default, we keep the ﬁrst three PCs as baseline. This parameter may,
however, be changed by the user after examination of the explained vari-
ance in the output of ONCOCNV. Also, if the number of control samples
(n) is less than four, only (n— 1) PCs will be kept. At least two control
samples are necessary to run ONCOCNV. When several tumor/matched
normal datasets are present, the baseline should be created using all the
control samples available.

For the ﬁnal normalization of the sample RCs, we use a linear regres-
sion over the baseline. The resulting proﬁle, NRC Final, shows lower vari-
ance than NRCLen and no directional bias (Supplementary Fig. S5D).

It should be noted that independent component analysis (ICA) could
seem more appropriate than PCA to deal with the technology-speciﬁc
bias. Each independent component could represent an independent
source of noise in the experiment. The use of ICA instead of PCA will
not, however, lead to different results in normalization based on the re-
gression over the ﬁrst components, as the ﬁrst independent components
are linear combinations of the ﬁrst PCs (Hyvarinen and Oja, 2000).

2.5 Correction of control sample RCs for gender

A control dataset is often generated from a mixture of male and fe-
male samples. To correct the RCs in the control samples for gender,
we apply the following strategy. After the ﬁrst normalization step
(normalization with respect to library size), we calculate
M,=mean(NRCLen on cth)/mean(NRCL,b) for each control sample i.
Then we choose the optimal model with one or two components for
M,, according to the Bayesian information criterion for expectation—
maximization initialized by hierarchical clustering for parameterized
Gaussian mixture models (Fraley and Raftery, 2002). If the best model
includes two components, we can conclude that our dataset represents a
mixture of male and female samples: samples falling in a cluster with
smaller M ,- are male and samples falling in a cluster with higher M ,- are
female. If the best model contains only one cluster, we can conclude that
all samples have the same gender and we assign male gender to them if
the M value for all samples is <0.9. For all control samples annotated as
male, we multiply the RCs on cth by two to make them comparable
with female control samples.

2.6 Assessment of standard deviation for NRCs

Although we know how to normalize sample RCs, we do not know which
deviation from zero level should be called signiﬁcant to call a copy
number change. To solve this issue, we need to evaluate the standard
deviation of NRC/gm, for each amplicon region. We notice that different
amplicon regions tend to have different standard deviations
(Supplementary Fig. S7A). Generally, the higher the NRC (i.e. PCl),
the lower the variance (Supplementary Fig. S7B). Further, we assume
that NRCfma, follows a normal distribution, with the mean value

 

3445

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

V.Boeva et al.

 

depending on the copy number status (a = 0 in the case of copy number
neutral), and the standard deviation depending on the ﬁrst PC of our
baseline (0 = f(PC1)) (Li et al., 2012). To model o=f(PC1), we use all
control samples. However, the overall variance can be higher in some
samples than in others (Supplementary Fig. S7). Thus, before the evalu-
ation of o = f(PC 1), we rescale the control samples so that they have the
same overall variance of 1. We model function f(PC1) using LOESS
(degree = 2) (Supplementary Fig. S8) (Cleveland et al., 1992). At the
end of this step, each amplicon i is assigned standard deviation 0,,
which shows how the NRC for this amplicon varies in comparison
with NRCs of other amplicon regions.

2.7 Processing of tumor sample RCs

Logarithmic values of the tumor sample RCs are normalized by library
size, GC content and amplicon length. For further analysis, we keep
residuals of the linear regression of the tumor NRCs over the baseline
calculated for the control samples.

The resulting proﬁles are segmented using the circular binary segmen-
tation (CBS) method [R packages PSCBS and DNAcopy (Olshen et al.,
2004; Venkatraman and Olshen, 2007)]. To avoid breakpoints at outlier
values, for each amplicon i, we give the segmentation algorithm weight-
ings w, which are inversely proportional to the variances 0%. Generally, all
NRC values within a segment resulting from the CBS correspond to a
particular copy number status.

To annotate a segment as a gain, loss or neutral copy number, we
deﬁne a segmentation and clustering approach. This is based on the idea
that the mean values of NRCs of segments (segment mean values) should
roughly correspond to integer copy number changes (Supplementary Fig.
S9). In other words, the segment mean values corresponding to the same
number of copies should cluster together. A similar approach was used by
Gusnanto et al. (2012) to detect CNAs in whole-genome sequencing data.

Using R package mclust (Fraley et al., 2012), we cluster weighted
means of segment log ratio values. To prevent clustering errors, we add
Gaussian noise to the data (Supplementary Fig. S9B and C). For each
segment, the standard deviation of the added random variable is equal to
the standard error of the mean, and thus depends on the length of the
segment. Our approach is nearly identical to the classic non-parametric
density estimation using the Parzen window method (Parzen, 1962). Here,
to be able to apply the existing clustering tool mclust, we perform sam-
pling from normal distribution instead of kernel density smoothing.

We select the level with the maximum density to be the neutral copy
number level (zero level in Supplementary Fig. S9C). We center the ratio
values on the zero level. All segments with mean values clustered with
zero are further considered copy neutral. We evaluate the overall stand-
ard deviation osaml’le of the sample using the copy-neutral regions. We
rescale the standard deviation Ufamﬂe =osaml’le >1< 0,, where ofamﬂe is the
standard variation for amplicon i in a given tumor sample.

2.8 Statistical validation of candidate CNAs

For each segment annotated as a putative CNA at the previous step, we
perform two tests to ensure that the observed deviation from the normal
cannot be because of mere chance. We calculate the P—values of the ﬁxed
variance test and the t—test under the null hypothesis that log (NRCJ'LWZ)
are generated by a normal distribution with mean value zero and stand-
ard deviation ofamﬂe.

2.8.] Fixed variance test If, for a copy-neutral amplicon i values,

X, = log (NRngnaZ) /af‘”"1’le

follows a normal distribution N(0,1), then the arithmetic mean of a
sample X 1, X2, X 3, ...~N(0, 1) is also normally distributed:
X~N(0, 1/ To test the signiﬁcance of a deviation from neutrality for
a consecutive set of target regions k+1...,k+n, we use the following

statistics formula:

i=k+n . sum 6
MEWwW%Mﬂm
which should follow half-normal distribution with 6: JEE/

2.8.2 T—test Under the hypothesis that target regions
i =k+ 1 ...,k+n are copy-neutral random variables, X,- are normally
distributed with expectation 0. Thus, we can apply a t-test to test the
hypothesis about the mean value of {X ,},= k+1_l_,k+n. It should be noted
that, as the standard deviation is not ﬁxed but evaluated via the sample
standard deviation, the t-test usually produces higher P-values than the
ﬁxed variance test.

2.8.3 Filtering of candidate CNAs We keep only those candidate
CNAs for which the ﬁxed variance test and t—test P—values are <0.01. This
allows us to be extremely stringent in ﬁltering false-positive CNAs
(Supplementary Fig. S10).

Contamination by normal cells, tumor hyper-ploidy and presence of
subclones deteriorates the copy number ratios and impede the accuracy of
CNA detection. Unfortunately, it is impossible to get reliable information
about these factors from amplicon sequencing data. Thus, we imposed a
detection threshold on the number of cells with a given CNA. The ex-
pected NRC value in a region of a gain or loss of 1 copies can be calcu-
lated as ExpectedNRC=(1 — c) - 1+ c - (1 :l: l/P), where c is the fraction
of all cells in the sample containing the CNA and P is the tumor ploidy.
The higher the tumor ploidy and contamination by normal cells and the
lower the fraction of tumor cells containing each CNA, the closer the
expected NRC will be to 1, and the more difﬁcult it will be to discriminate
between true and false calls (Supplementary Fig. S11A). To avoid false-
positive predictions, ONCOCNV ﬁlters out all candidate CNAs whose
weighted geometric mean of NRCs varies within the range (0.875 to
1.125). This ﬁlter is likely to remove all CNAs present in fewer than
25, 33 and 50% of cells in diploid, triploid and tetraploid tumors, re-
spectively (Supplementary Fig. S11B).

2.9 Detection of one-point copy number changes

Our method does not focus on the identiﬁcation of one-point copy
number changes (gain or loss of one exon/amplicon region).
Nevertheless, we provide a functionality to output P—values and outlier
statuses for each target region i based on a normal distribution
N (wmseg, Ufa“) of ratio values, where wmseg is the weighted mean of
the large segment including i, and of?“ is the evaluated standard devi-
ation. Similar to CONTRA (Li et al., 2012), we adjust these P—values for
multiple testing using the Benjamini and Hochberg correction (Benjamini
and Hochberg, 1995).

2.10 Readjustment of segmentation with a gene-aware
model

The segmentation procedure described above is performed in a gene-un-
aware way. Although segmentation usually places a breakpoint between
two genes, in some cases, the breakpoint is positioned within a gene
(Supplementary Fig. S12). In this case, there are two possible scenarios:
(i) the chromosomal break occurs within the gene or (ii) because of noise,
the predicted breakpoint was mis-positioned several probes left or right of
the real breakpoint. We developed a readjustment strategy to account for
the second scenario. When a breakpoint falls within the gene and breaks
it into several (usually two) segments, we test whether the mean value of
one of the segments could explain all the observed log(N RC) values of the
gene (t-test). A gene with more amplicon regions is more likely to be
correctly annotated with respect to the copy number status than a gene
with fewer amplicon regions.

 

3446

112 /8JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘091sn8nv uo ::

Detection of copy number aberrations in amplicon sequencing data

 

3 RESULTS
3.1 Comparison with WES-speciﬁc methods: NextGENe
and ADTEx

We decided to compare our CNA calling method in ultra-deep
targeted sequencing data with two WES-speciﬁc tools: ADTEx
(Amarasinghe et al., 2013), a method based on hidden Markov
models (HMMs) for CNA calling in targeted (exome) sequencing
data, and NextGENe, commercial software designed by
SoftGenetics. Although both ADTEx and NextGENe were
tested on WES data only, conceptually there is no reason why
these methods should not be applied to a smaller panel of tar-
geted genes (~400 in our case). We applied ONCOCNV,
ADTEx and NextGENe to a high amplicon depth sequencing
dataset of eight tumor samples. The array CGHs performed for
these samples showed different CNA complexity levels
(Supplementary Fig. S13). Although we also compared our
method with CONTRA (Li et al., 2012)—a method to detect
one-exon copy number changes as well as large CNAs in targeted
sequencing data—we do not report the results of this comparison
in this article as, in our data, CONTRA identiﬁed <10% of the
true CNAs (Supplementary Fig. S14).

Until now, ADTEx has not allowed the creation of a baseline
using several control ﬁles. We therefore applied two possible
strategies: (i) we selected 1 of 15 control samples and used it as
a matched normal control and (ii) we merged the 13 control
samples in l.AM ﬁle and used it a matched control. In the
ADTEx manual, it is advised to discard duplicate reads before
running the analysis. In our case, duplicate reads constitute
~95% of all reads (because of the high depth of coverage of
our data). We therefore applied two independent strategies to
call CNAs with ADTEx: with and without duplicate ﬁltering.

For the four output ﬁles (single and merged controls; with and
without duplicates), we checked the correlation between the
NRCs and log ratio values calculated during CGH experiments.
The correlation values were similar for all four types of output
ﬁle (Supplementary Table S1). Following recommendations
from the authors of the ADTEx manual, we decided to use the
ADTEx analysis based on one control sample including dupli-
cate ﬁltering (single control, no duplicates) for further
comparison.

3.1.] Comparison of normalization results The values resulting
from the ONCOCNV normalization procedure correlate highly
with the log ratio values of the array CGH experiments per-
formed on the same samples (Figs 2C, D and 3A,
Supplementary Table S1). The correlation was higher for
ONCOCNV NRCs than for RCs normalized by ADTEx and
NextGENe. For example, for sample Al, the linear correlation
between CGH log ratio values and ONCOCNV NRCs was 0.83,
compared with 0.65 and 0.62 for ADTEx and NextGENe, re-
spectively (Supplementary Fig. S15). This demonstrates that the
normalization procedure used in ONCOCNV has clear advan-
tages over those used in CNA calling methods developed for
exome sequencing data analysis.

We conﬁrmed that correction for the GC content plays a key
role in amplicon data normalization (Supplementary Fig. S16).
Correction for the technology-speciﬁc bias using the ﬁrst PCs of
PCA is also important to decrease the variance and correct for

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A  B 
E o
co . _
a: h °°. _
8 g —A2 \ A4 § 0
C m l\
.9 c 0' — A2
“a 4 .9 A3
E 0' 7 A3 75> o
L -c . _
C  — 0' LO
8 A8 0' ‘ A7
§ 0. _ <r. _
O | | | O | | |
ONCOCNV ADTEx NextGENe ONCOCNV ADTEx NextGENe
o _ v
C v D o -
m
(D  — (D  _
E E 0 A3
2 8 - :2: N
7’ 7, . _
8 V. _ 8 0 A8
 ° 
'— “l — ”' 3 _ A7
0 /'A4
0. _ O. _ AZV
O I I I O l l I
ONCOCNV ADTEx NextGENe ONCOCNV ADTEx NextGENe

Fig. 3. Comparison of RC normalization and accuracy of CNV calls
achieved by ONCOCNV, ADTEx and NextGENe for samples from
dataset A. (A) Correlation between NRCs and log ratio values of array
CGH. (B) Prediction accuracy. Accuracy = (#True predictions)/(#All
predictions), where each prediction corresponds to a gene copy number
status (gain, neutral or loss). (C) True-positive rate. (D) False-positive
rate

outliers in NRCs (Supplementary Figs S5 and Sl6C, D, G
and H).

3.1.2 Comparison of prediction accuracies For all samples,
ONCOCNV achieved much higher prediction accuracy than
the other two tools (Figs 3B—D and 4 and Supplementary
Table S2). Here, accuracy measures the proportion of genes
with correctly annotated copy number status: neutral, gain or
loss. The overall prediction accuracy varied from 0.74 to 0.99
for ONCOCNV, while it was signiﬁcantly lower for the other
two tools: 0.56—0.92 for ADTEx and 0.44—0.85 for NextGENe
(Fig. 3B). For all methods, samples with a high number of gen-
omic rearrangements were more challenging to analyze correctly
than samples with less complex proﬁles (Supplementary Figs S17
and S18).

3.2 Validation on 30 ErbB2-positive tumor samples

To validate our method further, we applied ONCOCNV to ana-
lyze amplicon sequencing data generated for 30 ErbB2-positive
ovarian cancer samples. The copy number status of the ErbB2
gene was assessed via ﬂuorescence in situ hybridization using
FFPE tissue sections. The gene ErbB2 (also known as HER2)
encodes a receptor tyrosine kinase whose activation plays an
important role in cell survival and drives cell proliferation (Tai
et al., 2010). ErbB2 is frequently overexpressed in breast, gastric,
ovarian and prostate cancer. ErbB2 overexpression most often
occurs because of a gene ampliﬁcation (Pauletti et al., 1996).
Several drug compounds are used in clinics to block ErbB2 sig-
naling in the case of overexpression of ErbB2. Thus, a persona-
lized treatment is available for patients with ampliﬁcation of the

 

3447

112 /8JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 uIOJj pop1201umoq

9IOZ ‘091sn8nv uo ::

V.Boeva et al.

 

 

>

log(ratIo)
m: :11 III-
|
. 
In 
Tﬁw
l
l
I
II?“
IL
|
l

 

w
=-
q

log(NRC)
I'IS
#3155 .'

 

 

 

C CGHa loss neutral gain Accuracy
ONCOCNV | 0.8879
ADTEx 0.6018
NextGENe 0.5250

Fig. 4. Example of CNVs called by ONCOCNV, ADTEx and
NextGENe (Sample A1). (A) Array CGH proﬁle for sample A1, seg-
mented using cghseg: purple (loss), orange (gain). x-axis corresponds to
probe indexes. (B) Copy number proﬁle calculated by ONCOCNV. x-
axis corresponds to amplicon indexes. (C) Agreement between CNVs
predicted from array CGHs and amplicon sequencing. Each vertical
bar denotes a gene copy number status: white (neutral), purple (loss)
and orange (gain)

ErbB2 gene (approved in clinical practice for breast and gastric
cancer patients).

In 29 of the 30 ErbB2-positive samples, ONCOCNV predicted
a gain in the genomic region containing the ErbB2 gene (Fig. 5).
Twenty-eight samples carry more than one additional copy of
ErbB2 (orange points in Fig. 5). The high true-positive rate
(>96%) demonstrates the validity of our approach for the detec-
tion of ampliﬁcation of actionable genes.

Intriguingly, in 1 sample of the 30, ONCOCNV did not detect
any gain on chromosome 17 containing the ErbB2 gene
(Supplementary Fig. S19). The high quality of the corresponding
NRC proﬁle suggests to us that the duplication of ErbB2 may
have happened in a subclonal population of cells that, for some
reason, was not present in the tissue section subjected to ampli-
con sequencing. Unfortunately, no more of this sample was
available and no further investigation was possible.

3.3 Validation on the SHIVA clinical trial dataset

We applied ONCOCNV to a low amplicon density dataset of
tumors sequenced in the SHIVA clinical trial (Le Tourneau et al.,
2012). The data corresponded to a targeted sequencing of 190
amplicons covering the exons of 46 actionable genes. The
number of amplicons varied from 1 to 17 per gene. As our algo-
rithm was designed to deal with data containing multiple ampli-
con regions per gene, for our analysis, we kept 11 genes. Each of
them contained at least seven amplicon regions. The 11 genes
selected were located on 10 different chromosomes. In the
SHIVA trial, a dual approach is used: amplicon sequencing is
used to detect single nucleotide variants and indels, whereas SNP
arrays provide information about the copy number status of the
genes and contamination by normal cells. We wanted to test

 

3-1 copy gain

n 11313135,.r gain
3 N H normal
2 I058
E
In ‘- —
n:
E
E
:C D —

‘I— _

 

 

 

| | | | | I l
NF‘I CDK‘iE PIE-“APB ERBBE RARA EW4 I'TGBE

Fig. 5. Accuracy of the detection of the ErbB2 ampliﬁcation. Normalized
read count (NRC) and copy number prediction for the ErbB2 gene and
six adjacent genes in 30 Erbb2-positive ovarian cancer samples (dataset
B). The Y-axis shows the average log(NRC) per gene. The color corre-
sponds to the predicted copy number status: purple (loss), white (neutral),
orange (gain). The darker orange color shows a gain of two and more
copies of the gene

Sample contamination by normal cells

- 0.42 | 0.34 | 0.28 | 0.24 | 0.16 |0.08|

Fig. 6. CNA detection accuracy in 30 samples from the SHIVA clinical
trial (dataset C). The accuracy of CNA detection is negatively correlated
with the percentage of normal cell contamination (Pearson r = —0.64,
P—value = 1074)

 

1.0

 

Accuracy of CNV prediction
0.4

0.2

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0.0

30 SHIVA clinical trial samples

whether amplicon sequencing-based detection of CNAs could
replace currently used SNP arrays.

As when using only 11 genes, it is often impossible to assess
the correct zero level, we considered relative gains and losses in
the calculation of CNA prediction accuracy (see Discussion). For
example, if the SNP array technique detected a one copy loss of
the ﬁrst ﬁve genes whereas ONCOCNV predicted a one copy
gain of the last six genes, we considered that the latter prediction
was correct (the absolute prediction accuracy is shown in
Supplementary Fig. S20).

We observed a high accuracy of CNA detection for samples
with low contamination by normal cells: for all but one sample
with <18% contamination, the CNA detection accuracy was at
least 90% (Fig. 6). As we expected, our ability to detect CNAs
in low amplicon density datasets strongly depends on the
normal contamination (Pearson correlation coefﬁcient 0.64,
P—value 104).

 

3448

112 /8JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 uIOJj pop1201umoq

9IOZ ‘091sn8nv uo ::

Detection of copy number aberrations in amplicon sequencing data

 

3.4 Data and software availability

Amplicon sequencing and CGH data and the ONCOCNV
source code are available at http://oncocnv.curie.fr/

4 DISCUSSION

We proposed a method to analyze amplicon sequencing data to
be used to detect CNAs involving at least several exons. Our
method, ONCOCNV, demonstrated a high accuracy of CNA
predictions for the samples for which we had the results of
array CGH analysis as gold standard. ONCOCNV signiﬁcantly
outperformed methods developed for exome sequencing data
analysis. This is because of the extensive normalization strategy,
which includes normalization for the GC content, amplicon
length (via LOESS correction) and other technology-speciﬁc
biases (via PCA of the control samples).

An important advantage of ONCOCNV is the reﬁnement of
breakpoints falling initially within a gene (i.e. after the segmen-
tation of NRC proﬁles). ONCOCNV reanalyzes the NRCs up-
stream and downstream of the putative breakpoint and decides
whether intragenic breakpoint has indeed taken place and that it
is not the result of inaccurate segmentation (Supplementary Fig.
S12).

In our dataset, we observed samples (e.g. controls 3 and 9,
Supplementary Fig. S2A) where a large fraction of amplicons
(26% for both) have zero or extremely low RCs. We would
like to point out that ONCOCNV is able to detect such artifacts
and analyze CNAs correctly in the corresponding samples.

The prediction of gains and losses by ONCOCNV includes
information on average log (NRC). In addition, it estimates pos-
sible copy numbers. This estimate is based on the assumption
that the tumor sample genome is diploid and that the sample is
not contaminated by normal cells. We are aware that this as-
sumption might be far from being true. However, we prefer to
provide an estimate of the probable copy number to allow the
user to distinguish between gains and ampliﬁcations, and be-
tween one and two allele losses. The question of predicting the
exact copy number cannot be solved by using copy number pro-
ﬁles alone. The assessment of B allele frequencies provides a
possible solution (Popova et al., 2009). We did not use this so-
lution in ONCOCNV because of the high dispersion of B allele
frequencies in the amplicon sequencing data (data not shown).

CNAs detected by ONCOCNV (and by other software whose
algorithm is based only on the analysis of copy number proﬁle)
are relative to the evaluated zero level. For instance, if we meas-
ure the copy numbers of only a pair of genes, we will not be able
to see a gain or loss if this happens simultaneously in both genes.
Thus, to properly estimate the zero level, many genes should be
included in the targeted gene panel.

As we expected, we detected a fall in the CNA detection ac-
curacy for samples that were highly contaminated by normal
cells. In this situation, the noise in measurements is comparable
with the expected difference between measurements in the case of
one copy gain or loss. As our approach does not use information
about B allele frequencies, certain combinations of normal con-
tamination and tumor ploidy signiﬁcantly impair the efﬁciency
of the technique. This is especially true when there are a small
number of measurements (amplicons) per gene.

We would like to point out that ONCOCNV does not detect
one-amplicon ampliﬁcations/deletions. We believe the noise in
current amplicon-based technologies does not allow detection
of such CNVs with high certainty. However, there are methods,
such as CONTRA (Li et al., 2012), which predict the CNVs of
single amplicon regions.

We do not position ONCOCNV as a tool for exome sequen-
cing data analysis. Unlike many exome sequencing data analysis
tools, ONCOCNV does not take into account B allele frequen-
cies. Because of this limitation, ONCOCNV is not able to evalu-
ate the level of the contamination by normal cells or improve the
accuracy of CNA calling by simultaneously processing copy
number and B allele frequency proﬁles (Boeva et al., 2012;
Sathirapongsasuti et al., 2011).

Our analysis of biases intrinsic to amplicon sequencing re-
vealed two factors inﬂuencing the RCs: amplicon length and
GC content. As LOESS correction is possible only for the ampli-
con sizes frequently present in the dataset (from 70 to 140 bp in
our case), we advise using as narrow a range of amplicon lengths
as possible in the future design of amplicon regions. Similarly,
for the GC-content normalization, the CNA prediction may be
inaccurate for amplicons with extremely high or low GC content.
This is especially true in the case when all amplicon regions
within a gene (usually overlapping with exons) have an extremely
high or low GC content. For such genes, we advise designing
additional amplicons in the intronic regions with moderate GC
content if it is planned to completely bypass array CGH or a
similar technique to predict the copy number status of the tar-
geted regions.

5 CONCLUSIONS

We present ONCOCNV, a computational method and software
tool to detect CNAs in tumor amplicon sequencing data. Our
method includes normalization of RCs for library-speciﬁc biases
(library size, GC content and amplicon length) and for technol-
ogy-speciﬁc bias. To normalize for the latter, we use a set of
control samples. We demonstrate that ONCOCNV signiﬁcantly
outperforms methods such as ADTEx (Amarasinghe et al., 2013)
and NextGENe developed for the analysis of exome sequencing
data. To make ONCOCNV useful for both bioinformaticians
and clinicians, we output both detailed and summarized results,
as well as a visualization of the annotated copy number proﬁle
(Fig. 4B). We believe that the use of our method on large panels
of targeted genes could potentially replace CGH or SNP arrays
in the future.

Funding: The SHIVA trial is supported by the grant ANR-10-
EQPX-03 from the Agence Nationale de le Recherche
(Investissements d’avenir) and SiRIC (Site de Recherche
Intégré sur le Cancer). High-throughput sequencing was per-
formed by the NGS platform of the Institut Curie, supported
by grants ANR-lO-EQPX-03 and ANRlO-INBS-09-08 from the
Agence Nationale de la Recherche (Investissements d’avenir) and
by the Canceropéle Ile-de-France.

Conﬂict of Interest: none declared.

 

3449

112 /8JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 uIOJj pop1201umoq

9IOZ ‘091sn8nv uo ::

V.Boeva et al.

 

REFERENCES

Amarasinghe,K.C. et al. (2013) CoNVEX: copy number variation estimation in
exome sequencing data using HMM. BM C Bioinformatics, 14, S2.

Beadling,C. et al. (2013) Combining highly multiplexed PCR with semiconductor-
based sequencing for rapid cancer genotyping. J. Mol. Diagn., 15, 171—176.
Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. J. R. Stat. Soc. Ser. B

Methodol, 57, 289—300.

Boeva,V. et al. (2011) Control-free calling of copy number alterations in deep-
sequencing data using GC-content normalization. Bioinformatics, 27, 268—269.

Boeva,V. et al. (2012) Control-FREEC: a tool for assessing copy number and allelic
content using next-generation sequencing data. Bioinformatics, 28, 423—425.

Cleveland,W.S. et al. (1992) Local regression models. In: Chambers,S.J.M. and
Hastie,T.J. (eds) Statistical Models. Wadsworth & Brooks/Cole, Paciﬁc
Grove, CA, pp. 309—376.

Fraley,C. et al. (2012) MCLUST Version 4 for R: Normal Mixture Modeling for
Model-Based Clustering, Classiﬁcation, and Density Estimation. Department of
Statistics, University of Washington, Seattle, WA.

Fraley,C. and Raftery,A.E. (2002) Model-based clustering, discriminant analysis,
and density estimation. J. Am. Stat. Assoc, 97, 611—631.

Garraway,L.A. and Lander,E.S. (2013) Lessons from the cancer genome. Cell, 153,
17—37.

Gusnanto,A. et al. (2012) Correcting for cancer genome size and tumour cell con-
tent enables better estimation of copy number alterations from next-generation
sequence data. Bioinformatics, 28, 40—47.

Hyvarinen,A. and Oja,E. (2000) Independent component analysis: algorithms and
applications. Neural Netw. Off. J. Int. Neural Netw. Soc., 13, 411—430.

Li,J. et al. (2012) CONTRA: copy number analysis for targeted resequencing.
Bioinformatics, 28, 1307—1313.

Olshen,A.B. et al. (2004) Circular binary segmentation for the analysis of array-
based DNA copy number data. Biostatistics, 5, 557—572.

Parzen,E. (1962) On estimation of a probability density function and mode. Ann.
Math. Stat, 33, 1065—1076.

Pauletti,G. et al. (1996) Detection and quantitation of HER-2/neu gene ampliﬁca-
tion in human breast cancer archival material using ﬂuorescence in situ hybrid-
ization. Oncogene, 13, 63—72.

Popova,T. et al. (2009) Genome alteration print (GAP): a tool to visualize and mine
complex cancer genomic proﬁles obtained by SNP arrays. Genome Biol., 10,
R128.

Sathirapongsasuti,J.F. et al. (2011) Exome sequencing-based copy-number variation
and loss of heterozygosity detection: ExomeCNV. Bioinformatics, 27,
2648—2654.

Small,M.B. et al. (1987) Neoplastic transformation by the human gene N-myc. M ol.
Cell. Biol., 7, 1638—1645.

Tai,W. et al. (2010) The role of HER2 in cancer therapy and targeted drug delivery.
J. Control. Release, 146, 264—275.

Le Tourneau,C. et al. (2012) Designs and challenges for personalized
medicine studies in oncology: focus on the SHIVA trial. Target. 0ncol., 7,
253—265.

Venkatraman,E.S. and Olshen,A.B. (2007) A faster circular binary segmenta-
tion algorithm for the analysis of array CGH data. Bioinformatics, 23,
657—663.

Zhou,W. et al. (2014) Bias from removing read duplication in ultra-deep sequencing
experiments. Bioinformatics, 30, 1073—1080.

 

3450

112 /8JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 uIOJj pop1201umoq

9IOZ ‘091sn8nv uo ::

