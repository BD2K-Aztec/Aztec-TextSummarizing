APPLICA TIONS NOTE W 3333'. %§§/Zsﬁi§$aliilgtl§§§

 

Systems biology

Advance Access publication January 17, 2014

Morpheus: a user-friendly modeling environment for multiscale

and multicellular systems biology

.me StarruBl, Walter de Back“, Lutz Brusch and Andreas Deutsch
Center for Information Services and High Performance Computing, Technische Universitat Dresden,

01062 Dresden, Germany
Associate Editor: Martin Bishop

 

ABSTRACT

Summary: Morpheus is a modeling environment for the simulation
and integration of cell-based models with ordinary differential equa-
tions and reaction-diffusion systems. It allows rapid development of
multiscale models in biological terms and mathematical expressions
rather than programming code. Its graphical user interface supports
the entire workflow from model construction and simulation to visual-
ization, archiving and batch processing.

Availability and implementation: Binary packages are available at
http://imc.zih.tu-dresden.de/wiki/morpheus for Linux, Mac OSX and
MS Windows.

Contact: walter.deback@tu-dresden.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 2, 2013; revised on December 12, 2013;
accepted on December 28, 2013

1 INTRODUCTION

Systems biology is rapidly expanding its scope from the study of
intracellular networks to the analysis of tissue- and organ-scale
systems. This increases the need for computational methods
and software that support the simulation and integration
of cell-based models with models for intra- and extracellular
dynamics. Currently available modeling environments typically
require programming or scripting to account for dynamical
feedback between submodels at different scales (Andasari
et al., 2012; Mirams et al., 2013; Swat et al., 2012). Yet, as
models grow more complex, it becomes increasingly important
to separate modeling from implementation, to automate
multiscale model integration and to provide intuitive
user interfaces (Siitterlin et al., 2013).

Morpheus is a user-friendly application for the modeling,
simulation and integration of cell-based models, ordinary differ-
ential equations and reaction-diffusion systems. It supports the
construction of multiscale models using biological terminology
and mathematical constructs, based on a novel domain-speciﬁc
language. Its graphical user interface (GUI) supports the whole
workﬂow from model development and simulation to Visualiza-
tion and data output and features tools for archiving and batch
processing.

 

*To whom correspondence should be addressed.
7“The authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

Morpheus has hitherto been used in a variety of studies,
including collective motion (StarruB et al., 2007), morphogenesis
(Kohn-Luque et al., 2011, 2013) and cell fate decisions (de Back
et al., 2013a, b) (Fig. 1A).

2 SOFTWARE
2.1 Model formalisms

Modeling of multicellular systems requires methods that go
beyond the standard repertoire of model formalisms in systems
biology (Machado et al., 2011). Cells must typically be modeled
as discrete interacting entities, sometimes as motile objects, pos-
sibly even with articulated 3D cell shapes. Morpheus provides
methods to define cell-based models of interactions between dis-
crete cells, spatially represented as point-like objects or with ex-
plicit 2D/ 3D cell shapes. Cell motility, adhesion and biophysical

F" J
Jan-J "'1

 

 

5;:

n I.
II" I-I-qr -|---n

 

Fig. 1. (A) Morpheus supports the simulation and integration of diverse
modeling approaches including (1) cell-based, (2) multiscale and (3)
image-based modeling, see case studies in main text. (B) The user inter-
face provides workﬂow tools for (1) model editing, (2) Visualization, (3)
archiving, (4) data analysis and (5) batch processing

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/|icenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq U101} popeoIII/noq

9IOZ ‘09 lsnﬁnv uo ::

J.Starrul3 et al.

 

constraints can be added using the cellular Potts model (CPM)
framework (Graner et al., 1992).

Cells can be linked to models of intracellular biological path-
ways such as gene regulatory networks and signaling pathways.
These can be speciﬁed in the form of ordinary, stochastic and
delay differential equations or imported from SBML-based
models. Morpheus also supports the simulation of reaction-
diffusion systems. This can be used to couple cellular behavior
to morphogen concentrations in the extracellular environment.

Apart from these core formalisms, a range of auxiliary models
can be constructed including coupled lattice ODEs, ﬁnite state
machines, gradient-based models and cellular automata. All for-
malisms can be used as single-scale models or integrated into
multiscale models. Example use cases are described on the
Web site and are available in the GUI.

2.2 Model description

Morpheus separates modeling from numerical implementation
by using a declarative domain-speciﬁc markup language. The
model description language allows users to describe their
models in biological and mathematical terms. Mathematical
expressions such as functions, equations, events and systems of
differential equations can be speciﬁed in common inﬁx notation
to describe the interactions and dynamics of cell-bound variables
and molecular species in reaction-diffusion systems, based on
symbolic identiﬁers.

Multiscale interactions are described by linking symbolic iden-
tiﬁers associated with different spatiotemporal models.
Internally, Morpheus automatically integrates these models by
appropriately mapping data between spatial models and schedul-
ing numerical updates according to the dependencies between
symbols.

Model descriptions also specify aspects related to the simula-
tion of the model, such as time and spatial discretization, initial
and boundary conditions as well as data output and Visualiza-
tion. The full model speciﬁcation is stored in a single ﬁle in XML
format, aiding archiving and model exchange. The same format
is used to periodically store the simulation state during execution.

The model description language and model integration is
described in more detail in the Supplementary Information and
on the Web site.

2.3 Graphical user interface

GUI (Fig. 1B) assists the user in the workﬂow from model
development to data analysis. The model editor supports
model construction by, for example, copy/pasting between
models, disabling/enabling model components and providing
context-sensitive documentation. It provides a job scheduler
that supports multithreaded and parallel job execution. For
parameter exploration and sensitivity analysis, ranges of values
can be speciﬁed for batch processing of any set of model
parameters. Simulation results are archived with their associated
models in a folder structure that can be browsed from within the
GUI. Archived models can be restored and resumed for further
analysis.

Output data can be analyzed at runtime, written to plain text
ﬁles for post hoc analysis and Visualized using the flexible gnuplot

interface. For 3D data, the multichannel TIFF format is sup-
ported, providing an interface to image analysis software such as
Image].

3 CASE STUDIES

To date, the Morpheus modeling and simulation environment
has been used in a diverse range of studies including the study
of collective motion in M yxococcus xantus using an extension of
the CPM (StarruB et al., 2007), the investigation of transdiffer-
entiation and pattern formation in the pancreas using a coupled
ODE lattice model (de Back et al., 2013a, b) (Fig. 1A1) and
modeling of vascular morphogenesis using a coupled CPM/
reaction-diffusion model (Kohn-Luque et al., 2011, 2013;
Fig. 1A2). Currently, the software is also being used for image-
based modeling by integration of spatial information from mi-
croscopy images into simulation models (e.g. liver tissue,
Fig. 1A3). Morpheus has also proven to be useful in the class-
room, for students in mathematics and physics as well as in
biology.

ACKNOWLEDGEMENTS

The authors thank Fabian Rost, Robert Muller, Michael Seifert
and Anja VoB-Bohme for discussions and contributions, and
thank Marino Zerial and Yannis Kalaidzidis for providing the
image data of liver tissue.

Funding: German Ministry for Education and Research (BMBF)
(0315734, 0316169).

Conﬂict of Interest: none declared.

REFERENCES

Andasari,V. et al (2012) Integrating intracellular dynamics using CompuCell3D
and BionetSolver: applications to multiscale modelling of cancer cell growth
and invasion. PLoS One, 7, e33726.

de Back,W. et al (2013a) On the role of lateral stabilization during early patterning
in the pancreas. J. R. Soc. Interface, 10, 20120766.

de Back,W. et al (2013b) Transdifferentiation of pancreatic cells by loss of contact-
mediated signals. BM C Syst. Biol, 7, 77.

Graner,F. et al (1992) Simulation of biological cell sorting using a two-dimensional
extended Potts model. Phys. Rev. Lett., 69, 2013—2016.

K6hn—Luque,A. et al (2011) Early embryonic vascular patterning by matrix-
mediated paracrine signalling: a mathematical model study. PLoS One, 6,
e24175.

K6hn—Luque,A. et al (2013) Dynamics of VEGF matrix-retention in vascular net-
work patterning. Phys. Biol, 10, 066007.

Machad0,D. et al (2011) Modeling formalisms in systems biology. AMB Express, 1,
1—14.

Mirams,G. et al (2013) Chaste: an open source C++ library for computational
physiology and biology. PLoS Comput. Biol, 9, e1002970.

StarruB,J. et al (2007) A new mechanism for collective migration in M yxococcus
xanthus. J. Stat. Phys., 128, 269—286.

Siitterlin,T. et al (2013) Bridging the scales: semantic integration of quantitative
SBML in graphical multi-cellular models and simulations with EPISIM and
COPASI. Bioinformatics, 29, 223—229.

Swat,M.H. et al (2012) Multi-scale modeling of tissues using CompuCell3D.
Methods Cell Biol, 110, 325.

 

112 /310's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq U101} popeoIII/noq

9IOZ ‘09 lsnﬁnv uo ::

