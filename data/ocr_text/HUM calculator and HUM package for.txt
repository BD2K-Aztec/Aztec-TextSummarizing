APPLICA TIONS NOTE V°"312,713.l59%‘32735322133/221322

 

Data and text mining

Advance Access publication February 10, 2014

HUM calculator and HUM package for R: easy-to-use software
tools for multicategory receiver operating characteristic analysis

Natalia Novoselova1’2’*

Frank Klawonn2’5

, Cristina Della Beffa2, Junxi Wang2, Jialiang Li3, Frank Pessler4 and

1Laboratory of Bioinformatics, United Institute of Informatics Problems, National Academy of Sciences of Belarus,
Surganova 6, 220012 Minsk, Belarus, 2Bioinformatics and Statistics, Helmholtz Centre for Infection Research,
Braunschweig, Germany, 8Department of Statistics and Applied Probability, National University of Singapore, Singapore,
4TVVINCCRE Center for Experimental and Clinical Infection Research, Hannover and 5Department of Computer Science,
Ostfalia University of Applied Sciences, Wolfenbilttel, Germany

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: Receiver operating characteristic (ROC) analysis is usually
applied in bioinformatics to evaluate the abilities of biological markers
to differentiate between the presence or absence of a disease. It in-
cludes the derivation of the useful scalar performance measure area
under the ROC curve for binary classification tasks. As real applica-
tions often deal with more than two classes, multicategory ROC ana-
lysis and the corresponding hypervolume under the manifold (HUM)
measure have become a topic of growing interest. To support
researchers in carrying out multicategory ROC analysis, we have
developed two tools in different programming environments which
feature user-friendly, object-oriented and flexible interfaces and
enable the user to compute HUM values and plot 2D- and 3D-ROC
curves.

Availability: The software is freely available from our Web site
http://public.ostfalia.de/~klawonn/HUM.htm

Contact: nov0365@mail.ru

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 26, 2013; revised on January 23, 2014;
accepted on February 5, 2014

1 INTRODUCTION

Receiver operating characteristic (ROC) analysis as an alternative
to classiﬁcation accuracy has been used extensively to estimate the
discriminative power of classiﬁers in two-class classiﬁcation prob-
lems (Bradley, 1997; Fawcett, 2006; Sonego et al., 2008). During
the last decade several theoretical investigations in the ﬁeld of
multicategory ROC analysis have provided different approaches
to calculate the hypervolume under the manifold (HUM), the
equivalent to the area under the ROC curve (AUC) of binary
ROC analysis in a multidimensional setting. The special case of
3-class ROC analysis is described in (Sonego et al., 2008), where
for each class the two possible misclassiﬁcations are treated
equally (a so-called one-versus-rest scenario). In (Hand and Till,
2001) the average of all one-versus-rest AUCs is proposed as an
approximation of the AUC. We recently reported a new extension

 

*To whom correspondence should be addressed.

of ROC analysis which uses a simple scheme to compare two or
more classiﬁers in their abilities to differentiate among multiple
categories (Li and Fine, 2008; Li and Zhou, 2009). This approach
to multicategory ROC analysis expresses the discriminatory abil-
ity of the classiﬁer as a HUM measure, with perfect discrimin-
ation corresponding to a HUM of l and the HUM of the null
hypothesis to l/n!, where n corresponds to the number of cate-
gories to be separated. Several R packages for two-class ROC
analysis exist (Robin et al., 2011), but they do not allow to take
into account multiple categories. We here present two software
tools that should make multicategory ROC analysis available to a
broader scientiﬁc community.

2 HUM CALCULATOR PROGRAM

The HUM Calculator program is realized as a stand-alone
software tool in the Visual Studio 2010 environment using
the C# programming language. It uses the Microsoft.NET
Framework class library (http://msdn.microsoft.com/en—us/
library/zw4w595w.aspx) to provide the interface and functions
of the HUM Calculator. The software tool allows to perform
multicategory ROC analysis, including the possibilities to load
the datasets in text format, to select the classiﬁers (termed ‘vari-
ables’ in the application) and categories (‘diagnoses’ in the appli-
cation) and to calculate the corresponding AUC values for
two-class problems and HUM values for more than two cate-
gories. It is also possible to construct and visualize 2D- and 3D-
ROC curves. An advanced feature of the HUM Calculator is the
function “Exhaustive search along diagnoses’, that makes it pos-
sible to estimate AUC or HUM values for several predictors and
for all the combinations of the deﬁned number of categories. The
software tool requires a standard Windows operating system
Windows XP, Windows 7, etc.). It was developed and tested
on a PC Intel Pentium 4 CPU, 3.00GHz, 2.00 GB RAM. The
HUM Calculator includes an extensive help ﬁle, which is access-
ible from the main menu and describes how the program works.
See Supplementary Material for details of installation and use of
the HUM Calculator to analyze a simulated dataset. The test
datasets are included in the installation package.

As bioinformaticians and statisticians use the R programming
language extensively, we have also developed a HUM R package

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1635

112 /810's113u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁ(1111] 11101; pepBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

N.Novoselova et al.

 

Table 1. Description of the main functions of the HUM R package

 

Function Description

 

CalculateHUM_seq Calculate the maximal HUM value and the
corresponding permutation of categories

Calculate the HUM values with an exhaustive
search of a speciﬁed number of categories

CalculateHUM_ROC Construct and plot 2D- or 3D-ROC curves

Cachene Compute the HUM value for one feature

CalcROC Compute the coordinates to plot 2D- or
3D-ROC curve, optimal thresholds and the
classiﬁer accuracies for them

Plot the 2D-ROC curve

Plot the 3D-ROC curve

CalculateHUM_Ex

CalculateHUM_Plot
Calculate3D

 

Note: The basic unit of the HUM package is the ‘CalculateHUM_seq’ function. It
calculates the AUC in case of two class labels and the HUM if more than two class
labels are available for the selected predictors. The function ‘CalculateHUM_Ex’ is
an extension of the main function and enables calculating HUM values for all
combinations of a deﬁned number of categories from the whole set of categories.
The function ‘CalculateHUM_ROC’ calculates the coordinates in order to plot 2D-
and 3D-ROC curves. The functions ‘Cachene’ and ‘CalcROC’ are the auxiliary
functions to perform the calculation. The software package comes with extensive
documentation.

and the corresponding Shiny web application (http://CRAN.
R-project.org/package=shiny) to provide the possibility to
deploy multicategory ROC analysis functions over the web.

3 REALIZATION IN THE R ENVIRONMENT

The software tool in the R programming language includes the
HUM R package and the Shiny application, which provides a
web interface for accessing the main functions of the R package.

The HUM R package provides a consistent set of functions for
computing and visualizing HUM values, for building and plot-
ting 2D- or 3D-ROC curves, calculating optimal threshold points
and classiﬁer accuracies for the optimal thresholds (Table l).

The HUM R package was implemented in R, a free software
environment for statistical computing and graphics (http://www.
R-project.org/). The auxiliary functions ‘Cachene’ and
‘CalcROC’ of the HUM R package are written in the C—I——I—
language and are integrated in R through the chp package
(Eddelbuettel and Francois, 2011). These functions improve
computational efﬁciency and shorten the computational times
of the main functions.

The web application was developed using the Shiny R pack-
age, which facilitates building interactive web applications
(Fig. l). It provides the possibility to load the datasets for the
analysis and to access all functions of the HUM R package. The
Shiny application features a directory called ‘HUM’, containing
a user-interface deﬁnition in the ‘ui.R’ ﬁle and a server script in
the ‘server.R’ ﬁle. See Supplementary Material for details on
installation and use of HUM R package functions and the
main procedures to perform multicategory ROC analysis with
the Shiny application.

HUM Calculation

'_'|':~'.-'.e  . . I I-7

‘D:|Arbcll_klmnm_l than“...

   

r.1..l'.'r.:u.IF-.1:.1

:rl+'|l|l|'. 1:;

 

Lnal. :II.-: :cn'cl:

'.--L: | I_| I!

Fig. 1. 3D-ROC curve in Shiny application

We believe that the HUM Calculator program and the HUM
R package with the Shiny application will provide researchers,
especially in the bioinformatics and biostatistics communities,
the necessary tools to better interpret their results in clinical
and biomedical classiﬁcation studies.

The tools are offered free of charge to all users on the website
http://public.ostfalia.de/~klawonn/HUM.htm and at http://
cran.r-project.org/web/packages/HUM/ (R package only).

ACKNOWLEDGEMENTS

We thank the colleagues of the Bioinformatics and Statistics
Group of the Helmholtz Center for Infection Research for
their participation in testing the software tools.

Funding: Innovative Medicines Initiative Joint Undertaking
(grant agreement number 115523-2—COMBACTE); German
Academic Exchange Service (grant number A/ 13/00004 to
N.N.); Helmholtz Association’s Cross Programme Initiative in
Individualized Medicine (iMed).

Conﬂict of Interest: none declared.

REFERENCES

Bradley,A.P. (1997) The use of the area under the ROC curve in the evaluation of
machine learning algorithms. Pattern Recog., 30, 1145—1159.

Eddelbuettel,D. and Francois,R. (2011) chp: Seamless R and C++. Integr. J. Stat.
Soft, 40, 1—18.

Fawcett,T. (2006) An introduction to ROC analysis. Pattern Recog. Lett., 27,
861—874.
Hand,D.J. and Till,R.J. (2001) A simple generalisation of the area under the ROC
curve for multiple class classiﬁcation problems. Mach. Learn., 45, 171—186.
Li,J. and Fine,J.P. (2008) ROC analysis with multiple classes and multiple tests:
methodology and its application in microarray studies. Biostatistics, 9, 566—576.

Li,J. and Zhou,X.H. (2009) Nonparametric and semiparametric estimation of the
three way receiver operating characteristic surface. J. Stat. Planning Int., 139,
4133—4142.

Robin,X. et al. (2011) pROC: an open-source package for R and 8+ to analyze and
compare ROC curves. BM C Bioinform, 12, 77.

Sonego,P. et al. (2008) ROC analysis: applications to the classiﬁcation of biological
sequences and 3D structures. Brief Bioinform, 9, 198—209.

 

112 /810's113u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 11101; pepeommoq

9IOZ ‘09 lsnﬁnv uo ::

