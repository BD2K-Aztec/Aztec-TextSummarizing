ORIGINAL PAPER

Vol. 30 no. 10 2014, pages 1417—1423
doi: 10. 1 093/bioinformatics/btu044

 

Gene expression

Advance Access publication January 24, 2014

Modeling tissue contamination to improve molecular identification
of the primary tumor site of metastases
Martin Vincent1 M, Katharina Perell2’l, Finn Cilius Nielsens, Gedske Daugaard2 and

Niels Richard Hansen1

1Department of Mathematical Sciences, University of Copenhagen, 2Department of Oncology, and 3Center for Genomic
Medicine, Copenhagen University Hospital, Rigshospitalet, 2100 Copenhagen O, Denmark

Associate Editor: Ziv Bar-Joseph

 

ABSTRACT

Motivation: Contamination of a cancer tissue by the surrounding
benign (non-cancerous) tissue is a concern for molecular cancer diag-
nostics. This is because an observed molecular signature will be dis-
torted by the surrounding benign tissue, possibly leading to an
incorrect diagnosis. One example is molecular identiﬁcation of the
primary tumor site of metastases because biopsies of metastases
typically contain a significant amount of benign tissue.

Results: A model of tissue contamination is presented. This contam-
ination model works independently of the training of a molecular pre-
dictor, and it can be combined with any predictor model. The usability
of the model is illustrated on primary tumor site identification of liver
biopsies, specifically, on a human dataset consisting of microRNA
expression measurements of primary tumor samples, benign liver
samples and liver metastases. For a predictor trained on primary
tumor and benign liver samples, the contamination model decreased
the test error on biopsies from liver metastases from 77 to 45%. A
further reduction to 34% was obtained by including biopsies in the
training data.

Availability and implementation: http://www.math.ku.dk/~richard/
msgl/.

Contact: vincent@math.ku.dk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 22, 2013; revised on October 21,2013; accepted on
January 21, 2014

1 INTRODUCTION

Several studies have considered molecular predictors for primary
tumor site identiﬁcation (see Lu et al., 2005; Ramaswamy et al.
2001; Rosenfeld et al., 2008). All these studies report misclassi-
ﬁcation percentages of ~10% in predicting the primary tumor
site from primary tumor samples, which is consistent with our
ﬁndings (see Section 3). However, the performance of molecular
predictors on metastatic samples is less clear. Most studies assess
the performance of their predictor using a combination of pri-
mary tumor and metastatic samples, with an unbalanced meta-
static sample set. Metastases are often more difﬁcult to classify
by conventional diagnostics, compared with primary tumors.

 

*To whom correspondence should be addressed.
1‘The authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

Yet, samples of metastatic cancers are generally underrepre-
sented in the validation. To correctly validate the performance
of a predictor, the validation samples must be representative of
the samples that the predictor is intended to be used on. For the
majority of patients with metastatic cancer, identiﬁcation of the
primary tumor site relies on small formalin-ﬁxed parafﬁn-
embedded (FFPE) needle biopsies (core biopsies) from meta-
static lesions. Hence, we argue that a molecular predictor
designed to assist in the diagnostic work-up of patients with
metastatic cancer must be compatible with, and validated on,
F FPE core biopsies from metastatic lesions.

To develop such a predictor for primary tumor site identiﬁca-
tion of metastases, it would seem preferable to train it exclusively
on core biopsies constituting metastatic tissue. However, it may
be difﬁcult to obtain a sufﬁcient amount of metastatic biopsies of
known primary tumor origin. Furthermore, a larger technical
variation because of the smaller amount of processed material
and the varying tumor content make it difﬁcult to rely on core
biopsies only. Therefore, previous studies, as well as ours, have
relied on primary tumor samples as a predominant part of the
training set.

These considerations lead to the central problem that we ad-
dress in this article: when core biopsy samples are scarce or com-
pletely absent, how can we best adapt primary tumor samples to
build a molecular predictor able to identify the primary tumor site
of metastatic tumor samples?

Such an adaptation is generally referred to as a domain adap-
tation. The problem being that the distribution of the cases to be
predicted (the target domain) differs from the distribution of the
cases used for training (the source domain) (see e. g. Daumé et al.,
2006; Mansour et al., 2009). To overcome this problem, we ex-
plicitly model how the target domain is related to the source
domain, and use this model to train a predictor. A central dif-
ference between the source and target domains in our setting is
caused by the fact that a core biopsy is often contaminated by
tissue surrounding the tumor cells, that is, benign tissue from the
biopsy site unrelated to the tumor (see Fig. 1). Another difference
can arise if the molecular signature of the metastatic tumor de-
viates from the signature of the primary tumor; see, e.g.
Ramaswamy et al. (2002) or Albini et al. (2008) for a discussion
of the biology of metastases.

Recent ﬁndings by Elloumi et al. (2011) suggest that tissue
contamination may result in a decline of performance for mo-
lecular predictors. The results presented in the present article

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1417

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIITOTQ/ﬂ(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

M. Vincent et al.

 

 

 

Fig. 1. Micrograph of a liver core biopsy with cancer. Cancer as well as
normal (benign) tissue can clearly be seen

demonstrate that tissue contamination hampers primary tumor
site identiﬁcation of non-microdissected metastatic liver core
biopsies. We developed our contamination model to correct
this. However, our suggested methodology is not speciﬁc to pri-
mary tumor site identiﬁcation, the biomarkers used—in our case
microRNA (miRNA) expression—or the technological platform.
It is a general computational model, which is broadly applicable
whenever sample contamination constitutes a problem.

We found that a non-adapted primary tumor site predictor,
trained solely on miRNA expression measurements from pri-
mary tumors and benign liver samples, misclassiﬁed 60% of
the liver core biopsies in our sample set. Notably, the perform-
ance of the predictor was even worse for the subset of liver core
biopsies constituting metastases. By applying our contamination
model and suggested domain adaptation procedure, this per-
formance was improved. For a predictor based on 50
miRNAs, the contamination model decreased the misclassiﬁca-
tion percentage for metastatic liver core biopsies from 77 to 45%.
A further improvement was obtained by combining the contam-
ination model with a few biological metastatic liver core biopsies.
This combined approach reduced the misclassiﬁcation percent-
age for metastatic liver core biopsies down to 34%.

2 METHODS

2.1 Domain adaptation

To present our contamination model in an appropriate context, we brieﬂy
review the domain adaptation terminology. The goal is to predict samples
drawn from a distribution T called the target distribution or target
domain. However, none or only a small number of samples drawn from
T are available for training. The philosophy of domain adaptation is to
use a related distribution 8, called the source distribution or source
domain, to construct a target domain predictor. Typically, either the
source distribution or a predictor trained on samples from the source
distribution are adapted to the target domain, perhaps, using (the few)
available target samples.

In our setting, the source distribution is the distribution of molecular
signatures for primary tumor and benign liver samples (resections). The
target distribution is the distribution of molecular signatures from liver
core biopsies. The relation between the source distribution and the target
distribution is made explicit in Section 2.2 below. We suggest to apply the
following general domain adaptation strategy to our problem.

(1) Specify a domain adaptation model, that is, specify a map
F 3 fsouroe _> f target

where fsource and ftarget denote the sets of relevant source and
target distributions, respectively.

(2) With :9 the empirical distribution of source samples, use the plug-in
estimate F(S) as an estimate of the target distribution.

(3) Generate an approximate target distribution Tsim by simulation of
artiﬁcial target samples based on F(S).

(4) Use Tsim for training of a predictor.

The domain adaptation model F provides a special kind of relation
between source and target; for any given source, 8, there is only one
related target, the model target F(S). In practice, the model F will contain
unknown components that have to be speciﬁed or estimated from data as
well. The following sections describe how the steps of the general pro-
cedure above are carried out in the context of tissue contamination.
Supplementary Figure S1 shows a ﬂow chart of the entire
implementation.

2.2 Contamination models

A simple model of the molecular signature from a liver-contaminated
core biopsy is

a x primary tumor signature + (1 — a) x normal liver signature

where a e [0, 1] is the relative amount of tumor content. This is a plaus-
ible model on the molecular level, but the contamination is not necessarily
additive on the measured scale. Therefore, we need to transform the
measurements using a suitable scale function f : W —> W, which is a
function

f(X1, ...,Xp) = (€061), °°°ag(xp))

for a continuous strictly monotone function g : IR —> IR.

Letting (X, Y) 6 RP x {1, ...,K} denote a pair of random variables,
with X representing the molecular signature and Y the site label, the
distribution of (X, Y) is the source distribution. With Z 6 RP a random
variable representing the molecular signature of the contaminating tissue,
let

U(y)d=eff(af“1(X) + (1 — a)f“1(Z))I Y: y

for f a scale function and a e [0, 1] another random variable representing
the relative amount of tumor content. The variables X, Z and a are
assumed conditionally independent, given Y, as illustrated in Figure 2a.
With YT the marginal distribution of class labels in the target distribu-
tion, the distribution of (U( Y7), Y7) constitutes our model target. The
model is speciﬁed by choosing a scale function and conditional distribu-
tions of Z and a given Y.

We will consider domain adaptation models for two particular scale
functions. The linear scale function is given by simply taking f to be the
identity, thus assuming that the contamination is additive on the mea-
sured scale. The data used in this article consist of miRNA (a small non-
coding RNA molecule) expression measurements, obtained by quantita-
tive polymerase chain reaction (qPCR); see, e. g., Vaerman et al. (2004) or
VanGuilder et al. (2008) for an introduction to qPCR. For qPCR, a
logarithmic scale function that models the relation between the actual
miRNA concentration and the measured quantity is appropriate. The
log scale function is given by

g(6) d=cf —R log 6
for 6 >0 proportional to the molecular count and R> 0 a constant. The
log scale function can be derived based on theoretical considerations for
qPCR reactions. The constant ei — 1 is the ampliﬁcation efﬁciency, and
we use a standard value of 0.8 throughout the article.

 

1418

112 ﬂJO'smumo[pJOJXO'sor1emJOJurorw/2d11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Improving molecular identification of the primary tumor site of metastases

 

‘5” 0 ‘m G

Minimal Actual

Fig. 2. The random variables a, X, Y and Z represent the tumor propor-
tion, the molecular signature, the site label and the molecular signature of
the contaminating tissue, respectively. A minimal assumption (a) of our
domain adaptation model is that X, Z and a are conditionally independ-
ent, given Y. The actual assumption made 0)) is that Z is marginally
independent of the other variables, and that X and a are conditionally
independent, given Y

2.3 Simulation of artiﬁcial core biopsies

The approximate target distribution Tsim is generated as a weighted em-
pirical distribution of a total of M simulated samples. First, the class
labels y1, ..., yM are sampled or chosen. Based on the source dataset
(primary tumors, normal and cirrhotic liver), we sample x1, ..., xM in-
dependently, given y1, ..., yM, such that xilyi is sampled from the con-
ditional empirical distribution of the source data given y,-. That is, x,- is
drawn with replacement from the source data with class label y,. In add-
ition, we draw M samples with replacement 21, . . . , 2M, from the contam-
ination data and M samples a1, ...,a M independently given y1, ..., y M
such that only,- has the desired distribution. For a given scale function f,
we compute

ui =f(05if_1(xi) 1' (1 — City—1%))

and the empirical distribution of the samples (u1, y1), . . . , (uM, yM) with
weights col,  , coM form the approximate target distribution Tsim. The
weights can be chosen to achieve a desired distribution of class labels in
Tsim, for example, to match the distribution of class labels for the primary
tumor dataset. The simulation assumes the conditional independence
structure illustrated in Figure 2b. If the less restrictive conditional inde-
pendence structure illustrated in Figure 2a is assumed, we need to adjust
the simulation to draw 2, conditionally on y,, but this requires knowledge
of a class-dependent contamination distribution. Note that the biological
liver core biopsies do not need to completely fulﬁll the assumptions on
which the simulations are based. For our purpose, the usefulness of the
contamination model and the resulting artiﬁcial target data is judged by
its ability to improve the performance of the predictor.

2.4 Class prediction

For class prediction, we use multinomial logistic regression, which is the
multiclass extension of logistic regression. The predictor is trained using a
group-lasso penalized likelihood approach as described in detail in
Vincent et al. (2014).

We brieﬂy review the multinomial group-lasso regression method.
Consider a prediction problem with K classes, N samples and p features.
Assume, given a dataset (x1,y1), . . . , (xN,yN) where, for all i = 1, . . . , N,
x,- 6 IR” is the observed feature vector, and y,- e {1, . . . , K} is the categor-
ical class label. With h : {1, ...,K} x RK —> R deﬁned as

“Mfg KCXPOH)
2 671130112)
k=1

the (symmetric) multinomial model is given by

P(Y = llx) = h(l, 3(0) + 1336)

Table 1. Number of samples included in the study. For the metastatic
liver core biopsies from the non— liver-related cancers the numbers a and
b shown as (a/b) are the numbers of low and high tumor content samples,
respectively

 

 

Class description Resections Liver core
(primaries) biopsies
Breast cancer 17 7 (5/2)
Colorectal cancer 20 12 (8/4)
Gastric/cardia cancer 18 12 (8/4)
Pancreatic cancer 20 10 (5/5)
Squamous cell cancers (of different origins) 16 12 (6/6)
Hepatocellular carcinoma 17 3
Cholangiocarcinoma 20 4
Subtotal 128 60
Cirrhotic liver 17 8
Normal liver 20 7
Total 165 75

 

Here, the parameters are organized as the K-dimensional vector 13(0) of
intercept parameters and the K x p matrix

5211030) . . .50»)

with ,8”) e IRK the parameters associated with the jth feature. The group-
lasso maximum likelihood estimator of (13(0), ,8) is the minimizer of the
group-lasso penalized negative log-likelihood,

N p
— Ewing/vets") + text) + A Z “130)”, (1)

i=1 J=1
Where col, ...,wN are sample weights. Here, || - “2 is the 2—norm on

RK. The penalization results in feature selection, meaning that for some
features the corresponding parameter vector is estimated to be 0. The
regularization parameter A >0 is a tuning parameter, and the larger the
A, the fewer features are selected.

For comparison, we also apply the procedure used in Ferracin et al.
(2011) for class prediction. They used analysis of variance (ANOVA) for
selection of miRNAs, and then prediction analysis of microarrays (PAM)
for the actual prediction; see Ferracin et al. (2011) for the details.

2.5 Biological samples

A total of 240 samples were included in the study. These samples consist
of 128 resected primary tumors of different origin (representing seven
primary tumor classes), 60 liver core biopsies from metastatic or primary
liver tumors of known origin (representing the same predeﬁned seven
primary tumor classes), 37 liver resections and 15 liver core biopsies
from normal and cirrhotic liver (see Table 1). The ﬁve classes breast,
colorectal, gastric/cardia, pancreatic and squamous cell cancers are
referred to as the non—liver—related cancers, and the corresponding 53
liver core biopsies are referred to as the metastatic liver core biopsies.
Samples were obtained from The University Hospital of Copenhagen,
Denmark. The sample set is a subset of the training samples used in
Perell et al. (unpublished data) and available from the Gene Expression
Omnibus with accession number GSE51429. Samples were archived
FFPE tissues (dated 2000—2012). All primary tumor resections were cut
into one section of 10 um and microdissected before being processed to
remove the surrounding benign tissue. Core biopsies were cut into two
sections of 5 pm according to the standard pathological procedure—no
microdissection was performed. Malignant core biopsy samples were
required to have a minimum tumor content of 10%. Tumor content

 

1419

112 ﬂJO's112umo[pJOJXO'sor112u1101urorq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

M. Vincent et al.

 

was deﬁned as tumor and stromal cells. All samples were from independ-
ent patients; thus, no patient overlap between primary tumor samples and
liver core biopsy samples was accepted. All samples were reviewed by an
independent pathologist to conﬁrm the reference diagnosis and to esti-
mate the proportion of tumor (see Table 2). Based on these tumor per-
centage estimates, the core biopsy samples were divided into two groups
representing high (>50%) and low (<50%) tumor content. For each
sample, the expression levels of 377 miRNAs were measured using quan-
titative real-time PCR (TaqMan low-density array cards, human
MicroRNA array A, Applied Biosystems) according to the manufac-
turer’s instructions.

Before a predictor was trained, the artiﬁcial core biopsy data were
simulated and data were preprocessed. Simulation and preprocessing
were executed in the following order.

(1) Controls and miRNAs not expressed in the primary tumor samples
were removed.

(2) Linear and log scale artiﬁcial core biopsies were simulated (see
Section 2.3).

(3) All samples, such as primary tumor samples, core biopsy samples
and the artiﬁcial core biopsy samples, were normalized and then
standardized as described below.

The data were ﬁrst normalized by centering and scaling the individual
samples to mean 0 and variance 1. The purpose of normalization is to
remove technical (non-biological) variation. It was demonstrated in
Mestdagh et al. (2009) that for qPCR, mean centering outperforms al-
ternative normalization strategies. Supplementary Figure S2 shows the
effect of the normalization on the sample distribution. To ensure that
differences in scale do not inﬂuence the variable selection, data were
standardized by centering and scaling the expression measurements of
each miRNA across the samples.

The centers and scales were estimated using the primary tumor samples
and applied for standardization of the primary tumor samples as well as
the core biopsy and artiﬁcial core biopsy samples. That is, the standar-
dized sample 5c 6 IR” of a sample x 6 W is given by

~ Xi—Mi

xi: fori=1,...,p
0i

where 12,- and 8,- denote the empirical mean and standard deviation, re-
spectively, for the ith miRNA in the primary tumor dataset. Note that the
order in which normalization and standardization are applied matters.

3 RESULTS

In this section, we present results obtained by testing the sug-
gested domain adaptation method on the miRNA expression
dataset described in Section 2.5. The domain adaptation
method was used with a linear and a log scale contamination
model, as described in Section 2.2. Predictors were constructed
using multinomial group lasso, outlined in Section 2.4, and by
using the ANOVA+PAM method from Ferracin et al. (2011).

Table 2. Distribution of tumor percentages (visual estimates) in core
biopsies

 

Tumor content (%): 0—20 20—40 40—60 60—80 80—100

 

Number of samples: 4 21 8 9 11

 

Results obtained with and without using the domain adaptation
method were compared.

To assess the generalization ability of the predictor method, a
multinomial group-lasso predictor was trained and cross-
validated solely on the 165 resections. This predictor achieved
an overall 10-fold cross-validation error of 11% on the resected
primary tumors, normal liver and cirrhotic liver samples.
However, on liver core biopsies—our target domain—this pre-
dictor had an overall test error of ~60%.

Note that results are reported in terms of misclassiﬁcation
percentages of the predictors, which we also refer to as the
errors of the predictors. The errors are either estimated on test
data by cross-validation or by subsampling as described in detail
in the following sections. Furthermore, all errors reported hence-
forth—except Section 3.5—originate from validation on our
target domain, i.e., samples from one of the following categories:
liver core biopsies of metastatic tumors, liver core biopsies of
primary liver cancers and core biopsies of normal and cirrhotic
liver.

3.1 Predictors based on primary tumor samples

The results presented in this section were obtained using primary
tumor and benign liver resections for training, i.e. no core biopsy
samples were used for training. Errors were estimated solely on
liver core biopsy samples. We compared multinomial group-lasso
predictors obtained by training on one of the following three
datasets:

(a) Primary tumor and benign liver samples.

(b) Artiﬁcial core biopsies obtained using the linear scale con-
tamination model.

(0) Artiﬁcial core biopsies obtained using the log scale con-
tamination model.

For the simulation of artiﬁcial core biopsies, as described in
Section 2.3, we used the 20 normal liver resections as contamin-
ation data. The distribution of a was taken as a beta distribution
with shape parameters (2, 2) for the seven cancer classes, and
degenerate at one for the two benign liver classes. That is, for the
benign liver classes, no contamination was added. The two arti-
ﬁcial core biopsy datasets were generated using either the linear
or the log scale contamination model described in Section 2.2.
The simulation was carried out with 750 samples from each class,
and the weights were chosen as

_ 
a" T 750

where, Nprmy, is the number of primary samples of class y,-. For
the two benign liver classes, the simulation amounts to sampling
with replacement from their empirical distribution. In practice,
the simulation step for these two classes was therefore skipped,
and the 37 benign liver resections were just included, all with
weight 1.

Figure 3 shows the test error plotted against the number of
miRNAs included in the predictor. A larger number of miRNAs
correspond to a lower value of the tuning parameter A in (1). The
predictors trained directly on the primary tumor, normal liver
and cirrhotic liver samples performed poorly when applied to the

 

1 420

112 ﬂJO's112umo[pJOJXO'sor112u1101urorq//2d11q wort pepeolumoq

910K ‘09 lsnﬁnV no 22

Improving molecular identification of the primary tumor site of metastases

 

liver core biopsy samples. The best predictors achieved an overall
error of ~60%. Figure 4 further shows that the error was even
larger on the metastatic liver core biopsies. From Figure 3, we see
that the overall error dropped to ~50% for the predictors trained
on the artiﬁcial core biopsies using the linear scale contamination
model. Using the log scale contamination model, the overall
error could be further reduced to ~35%. Figure 4 shows that
the overall improvements embraced notable differences between
the sample subgroups. In particular, the log scale contamination
model performed best on core biopsies with low tumor content,
whereas it did not improve the error rate as much for the high
tumor content samples. In contrast, the linear scale

 

70—

60-

_ I \
50 ‘.l \_\ ,, __.

40 ‘- ‘\ I. - - x" ‘

, . . . .'

Misclassiﬁcation percentage

, _ _ _ _ _ _ _ _ _ _ _;

30-

 

 

 

I
50 100
miRNAs included in the model

Training samples — Primary tumors - - - Artiﬁcial (log scale) - - Artiﬁcial (linear scale)

Fig. 3. Test error for prediction of liver core biopsies. The error is shown
as a function of miRNAs included in the predictor. The predictors were
trained using primary tumor samples or artiﬁcial core biopsy samples
derived from primary tumor samples using either the log or the linear
scale contamination model

Primary tumors Artiﬁcial (log scale) Artiﬁcial (linear scale)

 

   

Misclassiﬁcation percentage

30-

 

 

 

 

 

 

 

I I
50 100 50 100 50 100
miRNAs included in the model

Test samples — Metastatic liver core biopsies ' ' ' Low tumor content - - High tumor content

Fig. 4. Test error for primary tumor site prediction of metastatic liver
core biopsies. Predictors were trained on the resections (primary tumor,
normal and cirrhotic liver samples) or artiﬁcial core biopsies. The artiﬁ-
cial core biopsies were obtained using either the log or the linear scale
contamination model. The error is shown as a function of miRNAs
included in the predictor model. The error of low tumor content and
high tumor content samples is shown in addition to the overall error of
metastatic liver core biopsies

contamination model resulted in marginally better predictors
for the high tumor content samples.

3.2 Comparison of distributions

The main purpose of introducing the contamination model was
to improve the performance of the predictor. In addition, we
validated the model itself by comparing the distributions of the
simulated artiﬁcial core biopsies, the biological core biopsies and
the primary tumor resections. Because the contamination model
does not alter the normal and cirrhotic liver signature, these
classes were kept out of the comparison. Hence, we compared
the distribution of the seven cancer classes. Figure 5 shows a
bivariate projection of the distributions. It shows that the distri-
bution of the primary tumor samples clearly differed from the
distribution of the biological core biopsies. The ﬁgure also shows
that the distribution of the artiﬁcial core biopsies matched the
distribution of the biological core biopsies better. The ﬁgure was
constructed as follows: for each of the nine classes, we computed
the class mean of the primary tumor samples and projected the
samples onto the two ﬁrst principal components of these nine
class means.

3.3 Predictor based on metastatic tumor samples

For comparison, we trained a predictor solely on the 75 available
liver core biopsies. The leave-one-out cross-validation error was
~55% for the best predictor, using ~100 miRNAs. It is likely
that the error could be further reduced if additional core biopsies
were available for training.

 

 

 

 

50 -
x
X<
x
O x xx
X )0 .
25 - >?‘ x x 0
E '0 O c 0
8 x x o c c X
o x. X 9< o
9-1 x O . .
o
2 x21; 3.89. x . o. O. x x
N o
9.. 0- x % *0 .
's 23‘ x Xx § 0. o 0 x
.g x x x >55 X 0.. O x
m X xX x x c . X x .
'0 xx X . x. X 
s: >9 ox x
O X x X
0 §( x x x . O
cg x x X o >$< x x
_ X x C
-25 x
xx
x
x
x
-50 -
I I I I
-25 0 25 50
First principal component
Samples 0 Liver core biopsies X Resections

Fig. 5. A bivariate projection of the liver core biopsies, primary tumor
resections and artiﬁcial core biopsies (the latter shown using hexagonal
binning). Only samples from the seven cancer classes are shown. The
projection is onto the ﬁrst two principal components of the class means
for the primary samples

 

1421

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pepeolumoq

910K ‘09 tsnﬁnV uo 22

M. Vincent et al.

 

3.4 Predictors based on primary and metastatic tumor
samples

To further improve the predictors, we investigated the effect of
training on either primary tumor samples or artiﬁcial core biop-
sies in combination with available biological core biopsies. Thus,
for training we included n = 1, 2, 3 or four core biopsies from
each of the non—liver-related classes. To assess the performance
of this procedure, we used the following subsampling scheme—
repeated 100 times.

(1) Randomly split the core biopsy samples into a training and
a test dataset, such that each contains approximately half
of the samples per class.

(2) Randomly sample n core biopsies from the training dataset
for each of the ﬁve non—liver-related classes.

(3) Train the predictor on the combined training dataset (arti-
ﬁcial core biopsies or resections + biological core biopsies
selected for training).

(4) Estimate the error using the core biopsy test data.

Figure 6 shows that the combination of primary tumors and
core biopsies resulted in predictors with a smallest achievable

Primary tumors Artiﬁcial (log scale) Artiﬁcial (linear scale)

 

 

sarsdorq 910:) 191111 opmsmaw

N
O
I

 

 

 

 

 

d.)

1%” —\—\\_I—\_J_

q80— ~\

U.) \

a . \ r

o x 3

9-1 “\V ’_

860' ’ . E

a: L-.- “ - . . .  9,

:6 x x. _, 0

LE) ““M:.%v‘-/~“ I g

"-1 /

£40‘  II”, E

0 ~.\ ,2

.52

220—
E.
"E-
9,
8
3*
E.

 

 

 

 

 

 

 

20'

 

I I
50 100 50 100 50 100
miRNAs included in the model

Metastatic samples included per class — None - - One ' ' ' Two ' - ' Three — ' Four

Fig. 6. The error of primary tumor site prediction of metastatic liver core
biopsies. The error is shown as a function of miRNAs included in the
predictor model. The plots show the error for predictors trained on re-
sections (primary tumor samples) or artiﬁcial core biopsies in combin-
ation with biological core biopsies. The line type represents the number of
biological core biopsies included per class during the estimation proced-
ure. Biological core biopsies were not included in the hepatocellular car-
cinoma, Cholangiocarcinoma, normal and cirrhotic liver classes

error ~40% for the metastatic liver core biopsies. Combining
the artiﬁcial core biopsies with the biological core biopsies, this
error was reduced to just above 30% using the log or the linear
scale contamination model. Table 3 shows that the 50 miRNA
predictor based on the artiﬁcial core biopsies and four biological
core biopsies per class and using the log scale, achieved an error
of 34%. Figure 6 further shows that the optimal predictors were
achieved with 40—60 miRNAs using the log scale and 60—80
miRNAs using the linear scale. For the log scale contamination
model, a minor improvement on low tumor content samples was
seen when including biological core biopsies. However, a consid-
erable improvement was seen for high tumor content samples. In
contrast, for the linear scale contamination model, a considerable
improvement was seen for low, as well as high tumor content
samples, when biological core biopsies were included.

3.5 Comparing predictors

We compared multinomial group-lasso predictors with pre-
dictors obtained using the ANOVA +PAM method applied in
Ferracin et al. (2011). For comparison, the test errors on the 53
metastatic liver core biopsies were used, and predictors using 50
or 100 miRNAs were considered. Table 3 shows the results.
We trained ANOVA+PAM predictors on our 165 resections
of primary tumors, normal and cirrhotic liver. The predictor
worked as expected on the primary tumor samples with cross-
validation errors on the non—liver-related classes being 23% (50
miRNA predictor) and 16% (100 miRNA predictor). However,
as seen in Table 3 the corresponding errors were 81 and 77%
when the predictor was applied to metastatic liver core biopsies.
Large errors were seen for all of the predictors trained solely
on primary tumor, normal and cirrhotic liver samples, as shown
in Table 3. These errors decreased, if we either included core
biopsies in the training, or if we trained on the artiﬁcial samples
from our log scale contamination model, instead of the primary

Table 3. Misclassiﬁcation percentages for predicting the primary site of
metastatic liver core biopsies using 50 or 100 miRNAs

 

 

 

 

Principal Number of ANOVA + PAM Multinomial
training core biopsies group lasso
data
Number of miRNAs
50 100 50 100
Primaries 0 (0) 81%“‘ 77%“‘ 77% 74%
2 (10) 74% 71% 59% 54%
4 (20) 64% 64% 48% 45%
Artiﬁcial 0 (0) 60% 57% 45% 43%
2 (10) —b —b 39% 41%
4 (20) —b —b 34% 39%

 

Note: The table summarizes the errors for two predictor models using various
training data setups. The number of core biopsies included for training is denoted
by a (b), where a is the number per class and b is the total number of included core
biopsies. Core biopsies were only included for training in non—liver-related classes.
aThis predictor is constructed similarly to the predictor presented in Ferracin et al.
(2011). bIndividual sample weighting is required—ANOVA+PAM does not dir-
ectly support this.

 

1 422

112 ﬂJO's112umo[pJOJXO'sor112u1101urorq//2d11q won pepeolumoq

910K ‘09 tsnﬁnV uo 22

Improving molecular identification of the primary tumor site of metastases

 

resections. The improvements of the multinomial group-lasso
predictors were larger than those obtained by the
ANOVA + PAM predictors.

4 DISCUSSION

Contamination of samples can affect the performance of molecu-
lar predictors. This has been reported in other studies (e.g.
Elloumi et al., 2011). In the present article, we have seen that
normal liver contamination hampers primary tumor site identi-
ﬁcation of liver biopsies. This was seen regardless, whether multi-
nomial group lasso or ANOVA + PAM was used.

Several molecular predictors for identiﬁcation of the primary
tumor site have been published, which include F erracin et al.
(2011), Meiri et al. (2012), Rosenfeld et al. (2008), Lu et al.
(2005) and Ramaswamy et al. (2001). Commonly, these pre-
dictors rely on microdissection to minimize tissue contamination,
and they generally require samples with high tumor content. In
Meiri et al. (2012), a tumor content >60% was required, whereas
33 of the 53 metastatic liver core biopsies in our dataset had a
tumor content <60%. Notably, microdissection may not always
be applied to core biopsies or may cause delay in the diagnostic
work-up.

Previously reported primary tumor site predictors commonly
result in misclassiﬁcation percentages of ~25—30%. The pre-
dictor reported in Meiri et al. (2012) was validated on the com-
bination of 334 primary and 146 metastatic tumor samples, with
the samples being a mixture of resections and biopsies. A correct
single prediction was reported for 74% of the samples, corres-
ponding to a misclassiﬁcation percentage of 26%. The
ANOVA + PAM predictor reported in F erracin et al. (2011) ob-
tained a misclassiﬁcation percentage of 27% when tested on 45
microdissected metastases. Furthermore, F erracin et al. (2011)
reported a misclassiﬁcation percentage of 31% when this pre-
dictor was applied to the data from Rosenfeld et al. (2008). In
the present article, we show, how an ANOVA + PAM predictor
exclusively trained on primary tumor, normal and cirrhotic liver
samples, results in a misclassiﬁcation percentage of 77% when
validated on the 53 metastatic liver core biopsies. Hence, the
ANOVA + PAM predictor is, like the multinomial group-lasso
predictor, not able to generalize well from the primary tumor
samples to non-microdissected metastatic liver core biopsies
with a heterogenous tumor content distribution. We did not
ﬁnd that any of the previous studies systematically addressed
the problem of identifying primary tumor site of non-microdis-
sected core biopsies. Addressing this problem, we found that
novel methodology was needed to explicitly incorporate tissue
contamination.

We have developed a computational approach that deals with
tissue contamination from surrounding tissue, and we have
shown that the method improves the performance of the molecu-
lar predictor. Notably, training of such predictors does not re-
quire metastatic samples from the speciﬁc biopsy site, e.g. liver.
Comparable improvements could be obtained by including liver
core biopsies in the training data for each of the non—liver-related
classes. Moreover, including liver core biopsies in combination
with the contamination model was shown to reduce the error
even further. With a sufﬁciently large number of metastatic
liver core biopsies, the improvement because of the

contamination model is likely to be small. However, an advan-
tage of the contamination model is that it reduces the number of
metastatic samples from the speciﬁc biopsy site needed for train-
ing. Combining the contamination model with 20 core biopsies,
the misclassiﬁcation percentage of the non-microdissected meta-
static liver core biopsies was reduced to 34%.

Although we only considered liver core biopsies in the present
article, it is natural to assume that our contamination model will
work for other biopsy sites as well. With a limited number of
benign tissue resections, representing the biopsy site of interest,
our contamination model could easily be used to develop a pre-
dictor adapted to core biopsies of other metastatic sites. In add-
ition, even though we only address tissue contamination, our
contamination model has the potential to be used to model back-
ground contamination in other types of samples.

ACKNOWLEDGEMENTS

The authors thank Prof Ben Vainer, DMSc, Bodil Laub
Pedersen, DMSc, and Birgitte Federspiel, DMSc, from the
Department of Pathology, University Hospital of Copenhagen,
for their substantial work reviewing and scoring the samples
included in the study.

Funding: M.V. was supported by the Ministry of Science,
Technology and Innovation (09-049337). M.V. and N.R.H.
were supported by the University of Copenhagen Program of
Excellence: Statistical Methods for Complex and High
Dimensional Models.

Conflict of interest: None declared.

REFERENCES

Albini,A. et al. (2008) Metastasis signatures: genes regulating tumor-
microenvironment interactions predict metastatic behavior. Cancer Metastasis
Rev., 27, 75—83.

Daumé,H. III and Marcu,D. (2006) Domain adaptation for statistical classiﬁers.
J. Artif. Intell. Res., 26, 101—126.

Elloumi,F. et al. (2011) Systematic bias in genomic classiﬁcation due to contaminat-
ing non-neoplastic tissue in breast tumor samples. BM C Med. Genomics, 99, 54.

Ferracin,M. et al. (2011) MicroRNA proﬁling for the identiﬁcation of cancers with
unknown primary tissue-of-origin. J. Pathol., 255, 43—53.

Lu,J. et al. (2005) MicroRNA expression proﬁles classify human cancers. Nature,
435, 834—838.

Mansour,Y. et al. (2009) Domain adaptation: learning bounds and algorithms. In
Proceedings of The 22nd Annual Conference on Learning Theory (COLT 2009 ),
Montréal, Canada, June 2009, Omnipress.

Meiri,E. et al. (2012) A second-generation microRNA-based assay for diagnosing
tumor tissue origin. Oncologist, 17, 801—812.

Mestdagh,P. et al. (2009) A novel and universal method for microRNA RT-qPCR
data normalization. Genome Biol, 10, R64.

Ramaswamy,S. et al. (2001) Multiclass cancer diagnosis using tumor gene expres-
sion signatures. Proc. Natl Acad. Sci. USA, 98, 15149—15154.

Ramaswamy,S. et al. (2002) A molecular signature of metastasis in primary solid
tumors. Nature Genet, 33, 49—54.

Rosenfeld,N. et al. (2008) MicroRNAs accurately identify cancer tissue origin. Nat.
Biotechnol, 26, 462—469.

Vaerman,J.L. et al. (2004) Evaluation of real-time PCR data. J. Biol. Regul.
Homeost. Agents, 18, 212—214.

VanGuilder,HD. et al. (2008) Twenty-ﬁve years of quantitative PCR for gene ex-
pression analysis. Biotechniques, 44, 619—626.

Vincent,M. and Hansen,N. (2014) Sparse group lasso and high dimensional multi-
nomial classiﬁcation. Comp. Stat. Data Anal, 71, 771—786.

 

1 423

112 ﬂJO's112umo[pJOJXO'sor112u1101urorq//2d11q wort pepeolumoq

910K ‘09 tsnﬁnV uo 22

