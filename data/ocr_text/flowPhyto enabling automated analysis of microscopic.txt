APPLICATIONS NOTE

Vol. 27 no. 5 2011, pages 732-733
doi: 1 0. 1 093/bioinformatics/btr003

 

Systems biology

Advance Access publication January 5, 2011

flowPhyto: enabling automated analysis of microscopic algae
from continuous flow cytometric data

Francois Ribaletl, David M. SchruthT, E. Virginia Armbrust*
School of Oceanography, University of Washington, Seattle, WA 98195, USA

Associate Editor: Olga Troyanskaya

 

ABSTRACT

Motivation: Flow cytometry is a widely used technique among
biologists to study the abundances of populations of microscopic
algae living in aquatic environments. A new generation of high-
frequency flow cytometers collects up to several hundred samples
per day and can run continuously for several weeks. Automated
computational methods are needed to analyze the different
phytoplankton populations present in each sample. Software
packages in the programming environment R provide powerful tools
for conducting such analyses.

Results: We introduce flowPhyto, an R package that performs
aggregate statistics on virtually unlimited collections of raw flow
cytometry files and provides a memory efficient, parallelized solution
for analyzing high-throughput flow cytometric data.

Availability: Freely accessible at http://www.bioconductor.org
Contact: armbrust@u.washington.edu

Received and revised on November 2, 2010; accepted on December
30, 2010

1 INTRODUCTION

Phytoplankton are microscopic algae that are at the foundation of the
marine food web and can inﬂuence Earth’s climate. Flow cytometry
has provided new insights into phytoplankton ecology in freshwater
and marine environments. It creates ‘ﬁngerprints’ of phytopkankton
cells based on their ability to scatter or re—emit speciﬁc wavelengths
of light. This light can be detected and used to estimate cell size
and the composition of photosynthetic pigments that are used to
distinguish different phytoplankton populations.

In the last decade, several high—frequency ﬂow cytometers have
been developed to study phytoplankton community structure at
very ﬁne spatial and temporal scales, collecting several hundreds
of samples per day for several weeks. One of the largest
ﬂow cytometry datasets publicly available to marine biologists
is produced by a new generation of ﬂow cytometer created
at the University of Washington, called SeaFlow, that continu—
ously measures phytoplankton composition and abundance. The
instrument generates the equivalent of 6700 samples, representing a
dataset of 35—135 GB, after a typical 2—week long oceanographic
cruise (Ribalet et al., 2010). Software tools for automated data
analysis and visualization of phytoplankton populations is therefore
essential. We describe the R package ﬂowPhyto, which provides a

 

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the ﬁrst two authors
should be regarded as joint First authors.

disk—based, parallelized solution to the analysis of high—throughput
ﬂow cytometric data.

2 DATA STRUCTURE

The ﬂowPhyto package is compatible with conventional Flow
Cytometry Standard (FCS) ﬁles (Spidlen et al., 2010), as well as
those from the SeaFlow repository. SeaFlow data are stored in a
custom binary ﬁle (EVT ﬁle) created every 3 min and consists of
eight 16—bit integer channels (see Ribalet et al., 2010 for more
details). The acquisition time and location (longitude and latitude) of
EVT ﬁles is written into a log ﬁle (SDS ﬁle). The SeaFlow repository
is composed of julian day labeled directories, each containing
chronologically—ordered EVT ﬁles and an SDS ﬁle. The partioning
of the data circumvents hardware memory constraints and enables
parallelization over a beowulf class computer cluster.

As an example, we use a subset of SeaFlow data available at
http://seaﬂow.ocean.washington.edu that represents 1 day (480 ﬁles)
of an oceanographic cruise that took place in Puget Sound, WA,
USA, in November 2009. The goal of the study was to identify
hotspots of phytoplankton diversity and abundance.

3 COMPUTATIONAL ANALYSIS

The ﬂowPhyto package consists of a collection of functions that
turn the high volume of ﬂow cytometry ﬁles into customizable
cytograms, georeferenced images and a summary data table. Figure 1
depicts the analysis pipeline from raw ﬂow cytometry ﬁles to end
statistics through four batch processing steps, namely f i lter,
c lass i fy, census and summari ze. Each step makes a separate
pass over the entire repository and processes the samples in a highly
parallel fashion using ﬁle—based wrapper functions.

Unlike a traditional ﬂow cytometer, SeaFlow directly analyzes
a raw stream of seawater using two detectors that determine the
position of a particle in the focal region of the instrument optical
system (Swalwell et al., 2009). The f i lter function selects
optimally positioned particles (OPP) in each EVT ﬁle and creates an
OPP ﬁle used to distinguish the different phytoplankton populations.

Because the characteristics of each phytoplankton population vary
according to environmental conditions and instrument settings, a
table of customizable parameters (pop.def.tab) is used to deﬁne the
pre— gating regions and statistical priors of phytoplankton population
clusters. The c las s i f y function uses these predeﬁned parameters
and inputs one or more OPP ﬁles (3 by default) to classify
individual phytoplankton cells into different populations using
statistical clustering methods (Lo et al., 2009). The function can also
input FCS ﬁles after conversion to OPP ﬁles. For each group of OPP

 

732 © The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUlOTQ/ﬁdnq mm; popnommoq

9IOZ ‘09 lsnﬁ'nv uo ::

ro wPhyto

 

 

 

 

 

 

 

 

 

 

 

 

 

.cless.iict
I F _ “EDD iiB
if: "300 It mil.
'EPMPB .CDHEEHSUSHEt
.E'Iii't non l: m h" 5131::
~19 ME _ __ _ _ .census.teb
“'1 M em: 4 1 HE
R 1 H “'1IJ table
ﬁlter .1 EIBSﬁifg
papdeﬂab .sds
.stat.tab
_. o: 1 KB

 

 

 

1 J: “'20 table

 

 

 

 

Fig. 1. Diagram of the ﬂowPhyto package analysis pipeline. The four
main functions filter, classify, census and summarize convert
raw ﬂow cytometry ﬁles into a summary table for post—analysis. Stacked
vertical gray bars represent the different ﬁles. The asteriX (*) indicates that
class i fy can input FCS ﬁles and OPP ﬁles from SeaFlow repository.

ﬁles, c las s i f y outputs corresponding vector ﬁles (consensusvct)
that contain the population identiﬁcation of the cells. c las s i fy is
run in single ﬁle increments to provide multiple passes over a single
cell and strengthen the clustering analysis.

During the census step, these multiple—pass vector ﬁles are
collapsed into one consensus vector, which represents the most
likely population classiﬁcation of the different phytoplankton cells.
In addition, census produces a one—row census tab ﬁle that contains
the number of cells per population for each ﬁle. The concatenation
of these census tab ﬁles is used to create a per—population resampling
scheme that calculates the number of OPP ﬁles necessary so a
sufﬁcient number of cells (500 by default) is present in the resampled
population.

The summari ze function performs per—population aggregate
statistics using the resampling scheme and associates the
corresponding acquisition time and location. It outputs a summary
table (stat.tab) of the entire dataset that can easily be exported by
the user.

4 VISUALIZATION

The filter step optionally outputs a quality control plot for
the position—sensitive detectors speciﬁc to SeaFlow technology.
plotCytogram outputs a series of customizable 2—D cytograms
to visualize the various phytoplankton populations present in the
sample for each OPP or FCS ﬁle.

Piceplenkten

53in echeeeecue

48.6
48.4 —
43.2

43.0

Latitude {deg N}

4?.3

Cell density i1ri1E5 cells L“)

—'*- M Li) L'- U1 U2- “'4 CC! 'LD
| |
J I

4TH

   

 

 

123 122.6 122.2 123 122.6 122.2
Longitude {deg W) Longitude {deg W}

Fig. 2. Distribution of two phytoplankton populations, namely picoplankton
and Synechococcus, in Puget Sound, WA, USA on 9 November 2009. Note
that the spatial resolution of the two populations improves as their relative
cell density increases.

The plotStatMap creates customizable plots of the geo—
referenced data created by summarize. A combination of the
different parameters per population or a single parameter over
different populations can be selected depending on the purpose of
the analysis. Hotspots of phytoplankton diversity and abundance are
shown in Figure 2.

5 CONCLUSION

ﬂowPhyto provides an efﬁcient approach for the analysis of high—
throughput ﬂow cytometry data. Although this approach provides
an unique solution for the analysis of SeaFlow data repository, it is
also compatible with standard ﬂow cytometry data.

ACKNOWLEDGMENTS

We thank V. Iverson for his comments on the manuscript.

Funding: Gordon and Betty Moore Foundation Marine
Microbiology Investigator Award (to E.V.A.).

Conﬂict of Interest: none declared.

REFERENCES

L0,K. et al. (2009) ﬂowclust: a bioconductor package for automated gating of ﬂow
cytometry data. BMC Bioinformatics, 10, 145.

Ribalet,F. et al. (2010) Unveiling a phytoplankton hotspot at a narrow boundary between
coastal and offshore waters. Proc. NatlAcad. Sci. USA, 107, 16571—16576.

Spidlen,J. et al. (2010) Data ﬁle standard for ﬂow cytometry, version fcs 3.1. Cytom.
PartA, 77, 97—100.

Swalwell,J. et al. (2009) Virtual-core ﬂow cytometry. Cytom. PartA, 75, 960—965.

 

733

112 /B.IO'SIBU.IHOIP.IOJXO'SOllBIHJOJUIOIQ/ﬁdnq 11101; popnommoq

9IOZ ‘09 lsnﬁnv uo ::

