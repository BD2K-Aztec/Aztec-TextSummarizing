ORIGINAL PAPER

Vol. 30 no. 12 2014, pages 1739—1746
doi: 10. 1 093/bioinformatics/btu 1 01

 

Databases and ontologies

Advance Access publication February 17, 2014

An APN model for Arrhythmic beat classification
Hsiu-Sen Chiangl, Dong-Her Shih2’*, Binshan Lin3 and Ming-Hung Shih4

1Department of Information Management, National Taichung University of Science and Technology, 129, Section 3,
Sanmin Road, Taichung City 404, Taiwan, 2Department of Information Management, National Yunlin University of
Science and Technology, 123, Section 3, University Road, Douliu City, Yunlin County, Taiwan, 8College of Business
Administration, BE321, Louisiana State University in Shreveport, Shreveport, LA 71115, USA and 4Department of
Electrical and Computer Engineering, Iowa State University, Ames, IA 50011, USA

Associate Editor: John Hancock

 

ABSTRACT

Motivation: Changes in the normal rhythm of a human heart may
result in different cardiac arrhythmias, which may be immediately
fatal or cause irreparable damage to the heart sustained over long
periods of time. Therefore, the ability to automatically identify arrhyth-
mias from ECG recordings is important for clinical diagnosis and treat-
ment. In this article, classification by using associative Petri net (APN)
for personalized ECG-arrhythmia—pattern identification is proposed for
the first time in literature.

Results: A rule-based classification model and reasoning algorithm of
APN are created for ECG arrhythmias classification. The performance
evaluation using MIT-BIH arrhythmia database shows that our ap-
proach compares well with other reported studies.

Contact: shihdh@yuntech.edu.tw

Received on October 8, 2013; revised on January 22, 2014; accepted
on February 6, 2014

1 INTRODUCTION

Heart disease is an umbrella term for a number of different
diseases which affect the heart such as arrhythmia, myocardial
ischemia and myocardial infarction (Miniﬁo et al., 2007). As of
2007, it is also one of the leading causes of death in the world,
and especially according to the American Heart Association,
One American is dying in every 34s because of this disease
(American Heart Association, 2008). Changes in the normal
rhythm of a human heart may result in different cardiac arrhyth-
mias, which may be immediately fatal or cause irreparable
damage to the heart when sustained over long periods of time.
Electrocardiogram (ECG) is an important routine clinical prac-
tice for continuous monitoring of cardiac activities. Since ECG
signals vary greatly for different individuals and within patient
groups (Hoekema et al., 2001), ECG-pattern recognition is a
difﬁcult problem even with the aid of a computer. While
normal sinus rhythm originates from the sinus node of heart,
arrhythmias have various origins and indicate a wide variety of
heart problems. Same symptoms of arrhythmia produce different
morphologies due to their origins such as premature ventricular
contraction (Minami et al., 1999). For effective diagnostics, the
study of ECG pattern and heart-rate-variability signal may have
to be carried out over several hours. Thus, computer-based

 

*To whom correspondence should be addressed.

analysis and classiﬁcation of diseases can be very helpful in diag-
nostics (Guler and Ubeyli, 2005; Saxena et al., 2002). A number
of methods have been proposed to classify ECG-heartbeat pat-
terns based on the features extracted from ECG signals. APNs
have knowledge representation ability and could be translated
into production rule systems. In addition, the APN formalism
also is a graphical and mathematical tool for design, speciﬁca-
tion, simulation and veriﬁcation of systems. Therefore, APN can
be widely used in computer, knowledge-based systems, process
control, decision making as well as other kinds of engineering
applications. In this article, classiﬁcation of ECG arrhythmias by
using associative Petri net (APN) is proposed for the ﬁrst time in
the literature and is compared with several pioneering studies for
arrhythmias detection.

2 RELATED WORK

An ECG is a graphic produced by an electrocardiograph. A
single normal cycle of the ECG represents the successive arterial
depolarization and ventricular repolarization, and can be ap-
proximately associated with the peaks and other ECG wave-
forms, which labeled P, Q, R, S and T (McSharry et al., 2003).
Recently, different characteristic, such as P, T, U waves and PQ,
QRS, ST segments, are also used for diagnostics (Singh and
Tiwari, 2006). Automated classiﬁcation of heartbeats has been
previously reported by other investigators using a variety of fea-
tures to represent the ECG and a number of classiﬁcation meth-
ods. Features include RR—Interval features, heartbeat-interval
features and ECG-morphology features (Philip et al., 2004),
ST-segment deviation, -segment slope (STS), -segment area
(STA), T-normal amplitude (Exarchos et al., 2006), STA, R—S
interval (RSI), STS, R—T interval (RTI), QRS area (QRSA), Q—
T interval (QTI), R-wave amplitude (RWA), heart-beat rate
(HBR), statistical features QRS energy (QRSE), mean of the
power spectral density (MPSD), auto-correlation coefﬁcient
(ACC), signal histogram (SH) (Gholam et al., 2006), discrete
Fourier transform coefﬁcients (DFT) (Dokur and Olmez,
2001), statistical features of the QRS complexes (Osowski and
Linh, 2001), Hermite coefﬁcients (Linh et al., 2003), shift-invari-
ant (Yeong et al., 2006), continuous wavelet transform coefﬁ-
cients (Andreao et al., 2006), QRS complex wave width
(Homaeinezhad et al., 2012; Martis et al., 2013; Yeha et al.,
2012; Zhou et al., 2005), amplitude value, DCT coefﬁcients,
DWT coefﬁcients (Acir, 2006) and DWT coefﬁcients (Abawajy

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1739

112 /310's113umo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

H.-S.Chiang et aI.

 

et al., 2013; Engin, 2004; Inan and Ubeyl, 2005). In addition, the
classiﬁcation of heartbeats employed include linear discriminants
(Philip et al., 2004), association rules (Exarchos et al., 2006),
neural network (1 Dokur and Olmez, 2001; Gholam et al.,
2006; Inan and Ubeyl, 2005), fuzzy neural network (Engin,
2004; Linh et al., 2003; Osowski and Linh, 2001; Yeong et al.,
2006), hidden Markov models (Andreao et al., 2006), mirrored
Gauss model (Zhou et al., 2005), artiﬁcial immune-recognition
system (Polat et al., 2006), support vector machine (Acir, 2006)
and dynamic time warping (Zhang et al., 2009), cluster analysis
(Yeha et al., 2012), Neuro—SVM—KNN fusion (Homaeinezhad
et al., 2012), LibLINEAR, LibSVM (Abawajy et al., 2013) and
Principal component analysis, Linear discriminant analysis,
Independent component analysis (Martis et al., 2013).

Recent studies developed new feature-extracted and classiﬁca-
tion methods to detect various heart-related diseases and other
complications by analyzing ECG characteristics. Ghaffari et a].
(2010) use two innovative modiﬁed Hilbert transform-based
algorithms to extracted QRS complexes and end-systolic end-
diastolic pulses for detecting acute hypotensive episodes and
mean arterial pressure dropping regimes. A new classiﬁcation
tree based on conditions combinations competition (T-3C) is
proposed for the accurate diagnosis of cardiac ischemia and
ﬁve measurements were considered in their study (Fayn, 2011).
Vullings et a]. (2011) use Bayesian framework to develop an
adaptive Kalman ﬁlter. The adaptive estimation of the process
and measurement noise covariance is performed by maximizing
the Bayesian evidence function of the sequential ECG estima-
tion. Suﬁ and Khalil (2011) use data mining techniques, to per-
form a real-time classiﬁcation of cardiovascular disease. Lin et a].
(2010) use Bayesian algorithm combined with a Markov chain
Monte Carlo method to detection and delineation of ECG
signals.

Recently, association rules have been utilized for the extrac-
tion of knowledge from medical history and for the analysis of
medical signals (Bourien et al., 2004; Konias and Maglaveras,
2004). An APN incorporated the concepts and operations of
association algorithm of Apriori [3] and can represent the asso-
ciative production rules of a rule-based system. Therefore, an
adoption of APNs (Shih et al., 2007) in reasoning and classiﬁ-
cation of ECG arrhythmias is straightforward in this article.

3 MATERIALS AND METHODS

This section is a brief description of methods used in this research such as
a statistical sampling method, membership function generation by
Minimize Entropy Principle Approach (MEPA) and reasoning process
of ECG signals by proposed APN.

3.1 Dataset

PhysioNet’s MIT-BIH Arrhythmia Database (PhysioBank, 2006) con-
tains 48 half-hour excerpts of two-channel ambulatory ECG recordings,
obtained from 47 subjects (records 201 and 202 are from the same sub-
ject) studied by the BIH Arrhythmia Laboratory between 1975 and 1979.
Of these, 23 recordings were chosen at random from a collection of >4000
Holter tapes, and the other 25 recordings were selected to include ex-
amples of uncommon but clinically important arrhythmias that would
not be well represented in a small random sample.

These groups comprise men and women between the ages of 23 and 89,
and are analyzed by two independent cardiologists who use nomenclature
to classify them by the types of beats and rhythms. Our selected heartbeat
clusters are classiﬁed into the eleven heartbeat types including one normal
and various abnormal types as shown in Table 1.

3.2 MEPA

In this section, an MEPA is adopted to provide the persuasiveness of
determining the length of intervals and membership functions in heart-
beat patterns. Assume that a threshold value is sought for a sample in the
range between x1 and x2. An entropy equation with each value of x is
written for the regions [x1, x1+x] and [x1+x, x2] which are deﬁned as
the ﬁrst region f and the second region g, respectively. Entropy with each
value of x in the region between x1 and x2 is expressed as (Christensen,
1980):

E(X) = f (JOE/(X) + g(X)Eg(X) (1)
Where
E/(X) = —[f1(x) + 111f 1 (X) +f 2 (X) + 1nf2(x)] (2)
Eg(x) = —[g1(x) + 1n g1(X) + g2(x) + 1n g2(x)] (3)
f (X) + g(x) = 1 (4)

and fk(x) and gk(x) are conditional probabilities that class k sample in the
region [361, x1+ x] and [x1+ x, x2], respectively. A value of x that gives the
minimum entropy is the optimum threshold value. The value estimates of
fk(x) and gk(x), f(x) and g(x), are calculated as follows:

_ nk(x) + 1
fk(x) — W (5)
_ Nk(x) + 1
81:06) — W (6)
f(x) = 9 <7)
g(x) = 1 —f(x) (8)

where

nk(x)=number of class k samples located in [xZ, xz+x], n(x)=the
total number of samples located in [362, 362+ x], Nk(x) = number of class
k samples located in [xz+x, x2], N(x)=the total number of samples
located in [x2 + x, x2], 11 = total number of samples in [x1, x2], 2: a general
length along the interval [x1, x2].

Table 1. Type of heartbeat

 

Cluster Description

 

Normal C1 Normal heartbeat

Abnormal C2 Left Bundle Branch Block Beat
Abnormal C3 Right Bundle Branch Block Beat
Abnormal C4 Atrial Premature Beat

Abnormal C5 Fusion of paced and normal beat
Abnormal C6 Ventricular escape beat
Abnormal C7 Aberrated atrial premature beat
Abnormal C8 Junctional escape beat

Abnormal C9 Ventricular fusion beat

Abnormal C10 Paced beat

Abnormal C11 Ventricular premature contraction

 

 

1 740

112 /810's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

An APN model for Arrhythmic beat classification

 

While moving x in the region [x1, x2], we can determine the values of
entropy for each position of x, as in Figure 1. The value in the region that
holds the minimum entropy is called the primary threshold (PR1) value. If
we denote a secondary threshold in one area such as SEC1 and the other
secondary threshold in another area will be SEC2. In order to develop
seven partitions, we need tertiary threshold values and denoted as TER1,
TER2, TER3 and TER4. The induction is performed by the entropy
minimization principle, which clusters most optimally the parameters
corresponding to the output classes (Ross, 2000). By minimizing the en-
tropy, we can ﬁnd intervals in which the distribution of samples of any
class is as relatively uniform as possible.

3.3 APN model

Classiﬁcation using APN was applied for the detection of arrhythmia
beats. APN is deﬁned as follows (Shih et al., 2007).

3 .3 .1 Deﬁnition of APN An APN is a directed graph, which contains
three types of nodes: places, squares and transitions. Where circles rep-
resent places, squares represent thresholds of association degree and bars
represent transitions. Each place may contain a token associated with a
truth-value between zero and one. Each transition is associated with a
certainty factor (CF) value between zero and one. Directed arcs represent
the relationships between places. A generalized APN structure can be
deﬁned as a 13-tuple and the APN can be mathematically and graphically
illustrated in Figures 2 and 3.

Let A be a set of directed arcs. If pje I(t,-), then there exists a directed
arc aﬁ, aﬁe A, from the place pj to the transition t,-. If pk e 0(t,-), then there
exists a directed arc aik, aikA, from the transition t,- to the place pk. If
W(sm) 2 Wm, Wm 6 [0,1], then the support sm is said to be associated with a
real value Wm. If G(t,-)=c,-, c,-,e [0,1], then the transition t,- is said to be
associated with a real value c,-. If ,B(pj) = d], dJ-e D, then the place pj is said
to be associated with the proposition  An APN with some places con-
taining tokens is called a marked APN. In a marked APN, the token in a
place pj is represented by a labeled dot The token value in a place 17],
17,6 P, is denoted by 01(1),), where a(pj)e [0,1]. If 05(1),): )2,- and ,B(pj) = d],
then it indicates that the proposition  is 12,-. According to the antecedent
portion or consequence portion of an APR contains ‘and’ or ‘or’ con-
nectors, the APRs has ﬁve rule types (Shih et al., 2007).

3.3.2 Associative transition function Let IT: {1], i2, . . . ,im} be a set
of items and DT be a set of database transactions. An association rule
is an implication of the form A—>B, where A C IT, B C IT and
AﬂB=¢. The association rule A—>B holds in the transaction set
DT with support s, where s is the percentage of transactions in DT
that contain A U B. This is taken to be the probability P(A U B). The
association rule A—>B has conﬁdence c in the transaction set DT if c is
the percentage of transactions in DT containing A that also contain B.

 

 

 

 

 

 

 

 

 

 

 

 

(a) 1 Threshold 1
0.5 —————————————————————— — —
o
-1.628
(b) 1 Threshold 2 Threshold 3
0.5 —————————————————— — — — — — —
o
-1.25 -1.628 -2.737
(C) I
0.5
o
-1.25 -1.628 -2.737

Fig. 1. Partitioning process of MEPA

This is taken to be the conditional probability P(BlA) (Agrawal et a].
1993). That is,

Support (A => B) = P(A U B) (9)

Conﬁdence (A => B) = P(B/A) (10)

Typically, association rules are considered interesting if they satisfy
both a minimum support threshold rm, rm 6 [0, 1], and a minimum con-
ﬁdence threshold )4, y,- e [0, 1]. If the values of support and conﬁdence
are higher than their threshold ‘I.’ and y, the transition is enabled and the
CF value of transition is corresponding to its conﬁdence value (CF 2 c,-)
else the relationship does not exist (CF 2 0). A generalized formulation of
the CF is shown in Equation (11):

c], if sm 2 rm and c, 2 y,-

GUi) : {0 Otherwise (11)

where c,- is the conﬁdence value, y,- is a threshold of conﬁdence, sm is the
support value and rm is a threshold of support.

3.3.3 Reasoning process An APN model can be expressed as a net-
work structure. Each place in the network is denoted by a triple (pk, 05(pk),

AquﬁrsmuzmeruLaoﬂn

where

P = {[91, p2, _____ "19"} is a ﬁnite set ofplaces,
: {tn t2, ____ __ It} is a ﬁnite set of transitions,

= {31, 32 , ____ H Sm} is a ﬁnite set of supports,

T
S
C = {01,029 ..... not} is a ﬁnite set of conﬁdences,
D = {dv d2, _____ udn} is a ﬁnite set of propositions,
A

= {71,72 3 ..... ﬁrm} is a ﬁnite set of thresholds of the supports,

I‘ = {7/1, yz ’ ..... N71,} is a ﬁnite set of thresholds of the conﬁdences,

PﬂTﬂD=ﬂH=p|

1 ; T _) P” is an input function, a mapping from transitions to
bags of places,

0 ; T _) F” is an output function, a mapping from transitions to
bags of places,

a ; p _) [0,1] is an association function, a mapping from places to
real values between zero and one,

,3 3 p _) D is an association ﬁmction, a bijective mapping from
places to propositions,

G :71 _) [0,1] is an association function which assigns a real value

between zero to one to each transition
W : S _) [0,1] is an association function which assigns a real value

between zero to one to each support.

Fig. 2. Deﬁnition of APN

11:5!L

Pi ti“ Pl:

APN=[ P,T,S*C,D,ﬁﬁr,l,ﬂ,ﬂ,ﬂ,ﬂ,w]
IMilli. pk}: T=itikIa S=isikii C=ICTLIa
"Eidh till}: 114116, 1'={'I'lll}
[ﬂthIPlL 0[tlk}=ipk}

G(tik}={cik} =Iual Ia wisthIﬂJ I
IIIIJLFIU'J I. ﬂipfuipiiiiﬁﬂil.)
FiPII=dI a ﬁiPkFﬂu

Fig. 3. A generalized APN structure

 

1741

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

H.-S.Chiang et aI.

 

IRS(pk)), where pk e P and IRS(pk) is the immediate reachability set of
pk. RS(pk) is the set of places which is reachable from place pk and Any
denote a set of antecedent places of py. Let sxy denote the support degree
and cxy denote the CF value associated with transition between place px
and py. The degree of truth of proposition dx is deﬁned as oz(px). The
threshold of degree of truth of each proposition is given as A. If
oz(px) Z Ax, then the proposition dx is existed. Assume that the thresholds
of support and conﬁdence degree are given with ‘I.’ and y. If sxy Z TX), and
cxy Z yxy, then the transition is ﬁred. A reasoning algorithm of APN can
generate reasoning paths from starting place 17,, to goal place pg as
described below.
Reasoning Algorithm of APN

DEFINITION. Let V be a set of successful reasoning paths and v is a suc-
cessful reasoning path, v e V. The proposition of goal place )0g is dg(v) and
a(pg(v)) is the degree of truth of pg(v) if and only if there exist a successful
reasoning paths from starting place to goal place.

INPUT. P = {191,122, ---,pn}, D ={d1,d2, ---,d,.}, S ={s1,s2, ---,Sm},
C={Cisczs"',cl}, T={tlst29"'sti}s A={TI,T2,"',Tm},
I‘ = {y1,y2, ---,y,-} where P, D, S, C, T, A and I‘ are a ﬁnite set of
places, propositions, transitions, supports, conﬁdences, thresholds of sup-
port and thresholds of conﬁdence.

OUTPUT. The proposition ,B(pg) = dg and the degree of truth of a(pg) in a
goal place.

//Step 1: From starting place ps
The starting place ([7,, 05(1),), IRS(ps)) is a non-terminal
place, where
(1) 730%) = ds
(2) 05(1),) 3 A, a transition be enabled to ﬁre.
(3) IRSQDS) 75 <1)
//Step 2: At descendant place p,- (from starting place 17,)
For each place pie IRS(ps),
IF ping, 05(1),) 2 A, CFsgzcsg, ssg Z ng and csg Z ysg THEN
An arc, labeled asg is directed from ([7,, 05(1),), IRS(ps)) to (pg,
a(pg), IRS(pg)), where a(pg) 2 05(1),) * csg. The path is called a
successful reasoning path.
Else IF 17,75 pg, 05(1),) 2 2, CF“: csi, ss, 2 rs,- and cs,- 2 ysi,
THEN
An arc, labeled as,- is directed from ([7,, 05(1),), IRS(ps)) to (p,,
“(Pl-)9 IRS(pi))9 wh€r€ “(171): “(17.1) * csi-
Else IF AP“: {pm pb, . . . , p2} and pg 6 RS(p,-) THEN
Let g=Min {05(pa) * cm, a(pb) * cbi, . . . and 01(pz) * czi}.
IF 8 2 A, CFsi= Csz', Ssz' 2 Tsz' and Csz' 2 I/si THEN
An arc, labeled as,, is directed from ([7,, 05(1),), IRS(ps)) to
(Pi, “(171): IRSQ’J)» Where “(171) =8 * csi-
End IF
Else
Mark place p,- as a terminal place.
End IF
End For
//Step 3: At descendant place pk
For each place pk e RS(ps) and pk e IRS(p,-)
IF pkng, 01(pk) Z A, CFigzcig, Sig Z rig and cig Z yig THEN
An arc, labeled (ll-g is directed from (p,, 01(1),), IRS(p,-)) to
(pg, a(pg), IRS(pg)), where a(pg)=a(p,) * cig. The path is
called a successful reasoning path.
E186 IF pk #pg, pg 6  and 050%) Z A, CFl-k = Cik, Sik Z ‘Cik,
Cik 2 I/iks THEN
An arc, labeled aik is directed from (p,, 01(1),), IRS(p,-)) to (pk,
“(1%), IRSQ’k»: wh€r€ 05W) =Ol(pz-) * cik-
Else IF APik= {pm pb, . . . , p2}, and pge RS(pk) THEN
Let g=Min {05(pa) * cak, a(pb) * cbk, . . . and 01(pz) * czk}.
IF 8 2 A, CFik= Cik, Sik 2 Tik and Cik 2 I/ik THEN

An arc, labeled aik, is directed from ([7,, 01(1),), IRS(p,-)) to

(Pk, “(1%), 111507sz Wh€f€ “(P/c) =g * 01-k-
End IF
Else
Mark place pk as a terminal place.
End IF
End For
//Step 4: Successful reasoning paths determination.
V= «pg, alga), dingo»), (pg, alga), adage)», . . ., (pg,
dg<v), wow)»
Let z 2 Max {oz(pg(1)), a(pg(2)), . . . , oz(pg(v))} be the degree of
truth of proposition in pg.
//Step 5: At goal place pg
The proposition is ,B(pg) = dg, and the degree of truth is a(pg) =2.

4 EXPERIMENT

The experimental procedure for arrhythmia-beat detection is
divided into ECG ﬁltering and sampling, feature extraction,
transfer function building and classiﬁcation.

4.1 ECG ﬁltering and sampling

First, we use a non-linear bilateral ﬁlter (Elad, 2002) to remove
noise. The sampling size of our dataset has been estimated by the
population ratio (Mendenhall and Beaver, 1994):

2
n : Zed/21)::  
where n is the sampling size, P is the estimator, e is the sampling
error, at is the conﬁdence coefﬁcient and z is the standard normal
probability distribution. Since there is no further study in the
estimation of an ECG heat will be the abnormal beat’s probabil-
ity. Therefore, we use non-constant number sampling to obtain
the abnormal beat’s proportion of population in ten time’s trial,
which is shown in Table 2. From Table 2, we can obtain an
abnormal beat’s estimator (population proportion expected
value) as follow:

10
i=1

Table 2. Ten times non-constant sampling

 

 

Beat number Abnormal Abnormal Weight (Ci)
number ratio (P,-)
6628 4936 0.7447 0.0428
13 588 10 615 0.5000 0.0508
14 321 10 860 0.7583 0.0777
8886 5429 0.6109 0.0817
11056 9417 0.3000 0.0578
9967 8584 0.8612 0.0668
15 476 12 867 0.8314 0.1605
10 392 8109 0.0900 0.0358
13 596 7680 0.5649 0.1425
9490 7537 0.7941 0.2831

 

 

1 742

112 /810's112umo [DJOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

An APN model for Arrhythmic beat classification

 

where C,- is heat weight that is the sample proportion of sampling
1' time, P,- is abnormal ratio of sampling 1' time. C,- and P,- are
shown in Table 2.

Substitute P—value, with 0.95 conﬁdence levels and 0.02 sam-
pling error in y sampling beat in different group, as shown in
Table 3, we obtained 553 beat (with 120 normal and 433 abnor-
mal) in our sampling data set. By randomly select, about two-
thirds (67.5%) of the data set are used to training our proposed
APN knowledge model and one-third (32.5%) of the data set are
used to evaluate the proposed APN model.

4.2 Feature extraction

Selected features are important in enhancing the performance of
ECG arrhythmia-beat detection. After detailed survey, we used
the features listed in Table 4 for our prototyping.

The steps of detecting peaks are (i) calculating the moving
average from original signal, and usually using the past ten re-
cords to calculate it; (ii) subtracting moving average from ori-
ginal signal, and getting a new signal; (iii) ﬁnding the peak of the
signal; and (iv) setting the threshold to decide the detected peaks.
As soon as the peak ‘R’ determined, we can obtain peaks P, Q, S
and T through their relative position. In order to prevent possible

Table 3. Sampling number in clusters

 

 

Cluster Beat number Ratio (%) Sample number
C1 75041 21 120
C2 8123 13 72
C3 7336 4 21
C4 2566 11 60
C5 151 4 23
C6 7171 16 88
C7 886 6 32
C8 259 3 18
C9 224 3 19
C10 7028 13 74
C11 982 5 26

 

Table 4. Features description

 

 

Variable Feature Description Authors

x1 RH R wave amplitude. Hosseini et a]. (2006)

x2 PH P wave amplitude. Acir (2006)

x3 QH Q wave amplitude. Acir (2006)

x4 SH S wave amplitude. Acir (2006)

365 TH T wave amplitude. Acir (2006), Exarchos
et a]. (2006)

x6 PR PR Interval. Singh and Tiwari (2006)

x7 QS QRS wave duration. Singh and Tiwari (2006),
Zhou et a]. (2005)

x8 ST ST Interval. Singh and Tiwari (2006),

Hosseini et a]. (2006)

 

error, peaks’ amplitude would be measured from k line as shown
in Figure 4 (Shih et al., 2010). The deﬁnition of k line is in
Equation (13).

k=Max(6,-,i=1,2,---,ll)+c (13)

where k is a baseline, 6 is the greatest amplitude of all peak, 1' is
type of heartbeat and c is a constant. Therefore, the amplitude of
peaks P, Q, R, S and T are all homogeneous negative.

4.3 Transfer function building

Membership functions and thresholds are determined by MEPA
(Christensen, 1980) in Section 3.2. Each of the features is parti-
tioned into three states which are high, median, and low. For
example, Figure 5 is the membership function of TH and the
membership functions of some other features are shown in
Appendix A.

4.4 APN model construction

The structure of our APN model for arrhythmia beat detection is
constructed by using the construction algorithm from Shih et a].
(2013) and is shown in Figure 6. Our APN model for the symp-
toms of heart-disease reasoning have eight variables, 11 middle
states (one normal heart beat and 10 symptoms of heart disease),
and one ﬁnal state. All the degree of truth and states of the input
places in the APN are gained by the membership functions cal-
culated by Equation (11).

4.5 An example of arrhythmia-beat classiﬁcation

An APN reasoning algorithm, in Section 3.3, is used to classify
heart-beat symptoms into the following category: normal/abnor-
mal heartbeat or 11 different types of arrhythmia beat. APN

Table 5. Confusion matrix of our APN reasoning

 

C1 C2 C3 C4 C5 C6 C7 C8 C9 C10 C11

 

C1 34 2 1 1 2

C2 24

C3 5 2

C4 20

C5 9

C6 6

C7 8

C8 6

C9 1 1

C10 25
C11 1 0 28

 

Fig. 4. A single ECG wave with k baseline

 

1 743

112 /810's112umo [DJOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

H.-S.Chiang et al.

 

0.5

 

 

 

 

 

-1.25 -1.628 -2.737
1
—1.6284 —x D425
—0.3784
x _(_125) —1.25 2 x > —1.439
—0.3784
TH 2 4.7365 _x —1.439 2 x > —1.628
—1.1081
x _ (_1'6284) —1.628 2 x > —2.1824
—1.1081
[1 —2.1824 2x>—2.737

x < —2.7365

Fig. 5. Membership function of TH

P9 Left Bundle Branch Block Besﬁt

   
   
     
    

P10 Right Bundle Branch Block Bea
ll

 

P11 Atrial Premature Beat

. I

P12 Aberrated Atrial Premature Bea 1
II

   

 

P13 Ventricular Premature Contractio
O—l: I

P14 Ventricular Fusion Beat
l

 

P20
O

1"'15 Junctional Escape Beat ital signal

  
    

 

1:

P16 Ventricular Escape Beat

 

1

P17 Paced Beat

1’

 

ll
‘§ Pm Fusion of paced and normal be

THP5 I ]

 

1

II
P19 Normal Heat rhythm

 

1:

Fig. 6. An APN model for arrhythmia beat detection

model in Figure 6 is used for reasoning of arrhythmia-beat clas-
siﬁcation and has ﬁve inputs, three middle states, 11 outputs and
one ﬁnal state. For example, assume that ﬁve inputs character-
istics [x1, x2, . . . , x5] of an ECG-extracted signal from ECG wave
are [—2.7l62, —2.3648, —l.2864, —0.5810, —0.2l3]. From
Appendix A, we can obtain the membership degree and the lin-
guistic values of this ECG-extracted signal are [M, L, M, M, H]
and [0.708, 1.0, 0.970, 0.791, 1.0]. Then oz(p1)=0.708,
a(p2) = 1.0, . . ., a(p5) = 1.0 are a mapping from places p1,
p2, . . . , p5 to its real values by using membership function. The
p1, p2,..., p5 are starting places, where A>0 shows that the
proposition exists and 2:0 shows that the proposition does
not exist. Let ,8(p1)=dl and ,B(p2)=d2, . . ., ,B(p8)=d8 and d1,
d2, d3, . . . , d8 are eight propositions of ECG signals is shown in
Table 4. The propositions d9, d10, . . . , dl9 denote 11 clusters of
heartbeat. Let place p20 be a goal place, d20(v) is the proposition
of goal place p20 and oz(p20(v)) is the degree of truth of d20(v).
Assume that all the threshold values of ‘Eij and yij are set to 0.05
and 0.02, respectively. The reasoning example of our APN for
the symptoms of heart-disease reasoning is as follow:

Step 1: From starting places p1, p2, . . .p5: places p1, p2, . . . , p5
are starting places and ,8(p1) =d1, ,8(p2) 2 d2, . . .,
,8(p5) =d5 are 5 propositions of starting places.

 : {p69 p79p8}

Step 2: In descendant place pi, p,€IRS(pS), s=l, 2,...,5;
i=6, 7,8.

AP“: {p1, p2, . . . , p5} and all transitions are enabled, places
p1, p2, . . . , p5 are exist since (05(1),) 2 A) and all the values of sup-
port and conﬁdence are greater than threshold ‘17 and y, except
058 (i.e. SsiZ rsi=0.05 and 05,-: yS, 20.02, s: 1,2, . . . , 5; i: 6, 7,
8). Tokens are moved from p1, p2, . . . , p5 to p6, p7, p8. Since the
antecedent portion or consequence portion of APRs between p1,
p2, . . . , p5 and p6, p7, p8 belongs to type 3, the reasoning function
is ‘Max’ operator (Shih et al., 2007). The degree of truth of
proposition of place p6, p7, p8 are

g=oz(p,-)=Max{oz(ps) * cs,- | s: l, 2,..., 5, i=6, 7, 8}, then,

05(26)=MaX{05(P1) * 016: 05(P2) * 026}
= Max{0.708*0.233l, l*0.3846} = 0.3486

“(P7)=MaX{Ol(P1) * 017, 05(P3) * C37, 05(P4) * C47}
=Max{0.708*0.l955, 0.970*0.0513, 0.792*0.2623}
= 0.2077

“(P8)=M3X{05(P4) * C48: 05(P5) * CS8}:
= Max{0.792*0.1492, 0} =0.1182
Therefore, oz(p,- | i=6, 7, 8): {0.3486, 0.2077, 0.1182}.

Step 3: At descendant place pj, pjeIRS(p,-), i=6, 7, 8; j =9,
10,..., 19.

AP,-J- 2 {[96, p7, p8} and all transitions are enabled, places p6, p7,
p8 are exist since (a(pj):).). Some paths are not discarded,
since the values of support and conﬁdence are less than thresh-
old ‘17 and y, such as p6—>p14, p7 —>p11, etc. (i.e. sy: ty=0.05
and 0,]sz =0.02, j=6, 7, 8; j=9, 10,..., 19). Tokens are
moved from p6, p7, p8. Since the antecedent portion or conse-
quence portion of APRs between p6, p7, p8 and p9, p10, . . . , p19
belongs to type 1, the reasoning function is ‘Min’ operator (Shih
et al., 2007). The degree of truth of proposition at place p9,
P10: - - - 9 P19 are

g=oz(pj)=Min{oz(p,-) * cU|i=6,7,8;j=9,10,...,19},

“(P9)=Min{05(P6) * C69: 05(P7) * C79, 05(P8) * C89}
=Min{0.3486*0.294l, 0.2077*0.0827, 0.1182*0.0889}
20.0105.

“(219)=Min{05(26) >k6‘6,19= “(27) * 07,19: - --05(P8) * 08,19}
=Min{0.3486*0.3529, 0.2075*0.2857, 0.1182*0.3278}
20.0387.

Therefore, oz(pj |j=9, 10,..., l9)={0.0105, 0.0112, 0.0319,
0.0105, 0.0047, 0.0085, 0.0085, 0.0066, 0.0063,
0.0072, 0.0387}.

Step 4: At descendant place pk, since pkngz pgzo, places p9,
p10, . . . , p19 are exist (05(pjk) Z A) and all the values of
support and conﬁdence are greater than threshold ‘17
and y, all transitions are enabled (i.e. sjk: tjk=0.05
and cjk: yjk =0.02, j=9,10, . . ., l9; k=20). Assume
that all the CFs linked to p20 are 0.9, and let 01-20 = 0.9,

 

1 744

112 /810's112umo [plOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

An APN model for Arrhythmic beat classification

 

j: 9,10, . . ., l9. Tokens are moved from p9, p10, . . .,
p19 to p20 and their degree of truth are

Ol(p20(V)) = {05(pj) * CJQO  9,10, . . .  V=1,2, . . . 11, CJQO: 
Ol(p20(1)) = Ol(p9)*C9,20 =  *  = 

Ot(p20(11))=Ot(p19)*C19,20=0.0387 * 

There are eleven successful reasoning paths, v: 1, 2, . . ., 11,
v e V.

Step 5: There are 11 successful reasoning paths into goal place
p20, V 75 (0. Since the APRs between p9, p10, . . . , p19 and
p20 belongs to type 3, the reasoning function is ‘Max’
operator, we can select proposition dzo (v) and the
degree of truth of dzo (v) at the place p20 as:

V = {(2209 0120(1): “(P200)” (P209 0120(2): 05(P20(2)))a - - - 9 (P20,
“120(11): 05(P20(11)))}

Z =MaX {05(P20(1))= 05(P20(2))= - - -05(P20(11))}
=Max{0.0095, 0.01, 0.0287, 0.0095, 0.042, 0.0077, 0.0077,
0.0059, 0.0056, 0.0065, 0.0348}

= 0.0348 (at p19—>p20)

Step 6: Obtain proposition dzo (v) and the degree of truth
05(P20(V)) at Place P20-

Finally, we can obtain the belonged cluster (Cluster ll:
Ventricular Premature Contraction) and degree of truth is
0.0348 in this example.

5 EXPERIMENTAL RESULTS AND DISCUSSION

The MIT-BIH arrhythmia database is used in our experiment.
We use 368 cases in training and 185 cases for testing from
sampled data in Table 3. After APN model construction, the
testing result in confusion matrix of our proposed APN model
is summarized in Table 5. Table 6 summarized the other re-
ported results of heart-beat recognition with Fuzzy Petri net
(Shih et al., 2010), support vector machine (Acir, 2006),
neuro-fuzzy network (Engin, 2004), fuzzy hybrid neural net-
work (Osowski and Linh, 2001) and mirrored gauss model
(Zhou et al., 2005). Our proposed APN model can successfully
recognize most of clusters since every cluster’s accuracy are all
greater than 90%.

In addition, our proposed APN model was further evaluated
by the following performance measure such as: true positive rate
(sensitivity) (TP-rate=TP/(TP + FN)), true negative rate (speci-
ﬁcity) (TN-rate=TN/(FP+TN)), false positive rate (FP-
rate=FP/(FP+TN)) and false negative rate (FN-rate=FN/
(TP+ FN)). Accuracy is deﬁned with equation (TP +TN)/
(T P+ FP+ FN+TN). F—measure combines precision TP/
(TP + FP) and recall TP/(TP + FN) on the prediction of positive
class (F-measure = 2 x precision >< recall/precision + recall). A
higher F—measure value indicates that the model performs
better on positive class balancing of FP and FN. G-mean is
the product of the prediction accuracies for both classes which
is \/TN/(TN+FP)><TP/(TP+FN). And, AUC is the area
under ROC (receiver operating characteristic curve) curve calcu-
lated with MedCalc (http://www.medcalc.org/index.php). Higher

 

Table 6. Comparison with other research

 

Heartbeat APN Shih Acir Engin Osowski Zhou

 

(%) (%) (%) (%) (%) (%)
C1 93.51 92.9 89.8 93 98.1 93.9
C2 98.92 90.8 85.8 - 97 -
C3 96.76 96.7 - 99 94 -
C4 99.46 92.4 - - 91.3 -
C5 100.00 97.8 - - - -
C6 100.00 97.3 - - 90 -
C7 100.00 95.6 - - - -
C8 98.92 94.5 - - - -
C9 98.92 95.1 - - - -
C10 100.00 95.6 - - - -
C11 100.00 93.5 90.3 100 96.5 93.9

 

-, Did not discriminate this heartbeat class.

Table 7. Performance measure of different approach

 

Methods Sensitivity Speciﬁcity AUC F-measure G-mean Accuracy

 

(%) (%)
NB 85.0 83.4 0.842 0.694 0.842 0.838
C4.5 87.5 94.5 0.910 0.843 0.909 0.930
SVM 92.5 87.6 0.900 0.779 0.900 0.886
Bayes Net 85.0 92.4 0.887 0.800 0.886 0.908
APN 85.0 95.9 0.908 0.850 0.903 0.935
FPN 92.5 83.4 0.880 0.733 0.879 0.854

 

AUC indicate a classiﬁer has a better classiﬁcation performance.
Other data mining methods such as Naive Bayes (NB), Decision
tree (C4.5), Bayes Net, Support vector machine (SVM) and
Fuzzy Petri net (FPN) running with Weka and MATLAB
2012 are shown in Table 7 for comparison. APNs and C45
have a higher TN—rate in detecting abnormal heartbeat. SVM
and FPN have a good TP—rate in detecting normal heartbeat
in our experiment. Generally, in Table 7, our APN have the
best performance than other data-mining methods in sensitivity,
F—measure and accuracy measurement. And, other measure-
ments are great too. Therefore, we can conclude that our pro-
posed APN model have a good result on classiﬁcation of ECG
arrhythmias.

6 CONCLUSION

We have proposed a methodology for the detection of ECG
arrhythmia using a generalized APN model in this article. The
performance evaluation using MIT-BIH arrhythmia database in
Table 7 shows that our approach compares well with other re-
ported studies. The experimental results strongly suggest that our
proposed APN model can help doctors in the diagnosis of ECG
Arrhythmia and may applied to other symptom decision ﬁeld. In
the future, an applicable decision system for the clinical diagnosis
of ECG arrhythmias can developed based on our provided APN
model. And, the health care practitioners can be aware of types

 

1 745

112 /810's112umo [plOJXO'SOIlBIIIJOJUIOIQ/ﬁ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

H.-S.Chiang et al.

 

of cardiac arrhythmias and give early treatment to reduce
deterioration.

APN is a powerful method for representing knowledge and
logic reasoning in the domain of decision support systems.
Unlike other Petri net model, APN model has a systematic pro-
cedure in model construction. The reasoning path of expert sys-
tems can be reduced to simple sprouting trees if APN-based
reasoning algorithms can be applied. However, there still draw-
backs exist in APN such as state explosion and no hierarchy
concepts. We shall overcome all these drawbacks in the near
future.

Funding: National Science Council of Taiwan (grants NSC 98-
2218-E—212-001 and NSC-97-2218-E—224-008).

Conﬂict of Interest: none declared.

REFERENCES

Abawajy,J.H. et al. (2013) Multistage approach for clustering and classiﬁcation of
ECG data. Comput. Meth. Prog. Bio., 112, 720—730.

Acir,N. (2006) A support vector machine classiﬁer algorithm based on a perturba-
tion method and its application to ECG beat recognition systems. Expert. Syst.
Appl., 31, 150—158.

Agrawal,R. et al. (1993) Database mining: a performance perspective. IEEE Trans.
Knowledge Data Eng, 5, 914—925.

Agrawal,R. and Srikant,R. (1994) Fast algorithms for mining association rules. In:
Proceedings of the International Conference on Very Large Databases ( VLDB
’94 ). Morgan Kaufmann Publishers Inc, Santiago de Chile, Chile, pp. 487—499.

American Heart Association. (2008) Heart disease and stroke statistics. [Online].
http://www.americanheart.org/presenter.jhtml?identiﬁer=3000090 (18 March
2014, date last accessed).

Andreao,R.V. et al. (2006) ECG signal analysis through hidden Markov models.
IEEE Trans. Biomed. Eng, 53, 1541—1549.

Bourien,J. et al. (2004) Mining reproducible activation patterns in epileptic intra-
cerebral EEG signals: application to interictal activity. IEEE Trans. Biomed.
Eng, 51, 304—315.

Christensen,R. (1980) Entropy M inimax Sourcebook. Vol. 1—4, Entropy Ltd.,
Lincoln, MA.

Dokur,Z. and Olmez,T. (2001) ECG beat classiﬁcation by a novel hybrid neural
network. Comput. Meth. Prog. Bio., 66, 167—181.

Elad,M. (2002) On the origin of the bilateral ﬁlter and ways to improve it. IEEE
Trans. Image Process, 11, 1141—1151.

Engin,M. (2004) ECG beat classiﬁcation using neuro-fuzzy network. Patt. Recog.
Lett., 25, 1715—1722.

Exarchos,T.P. et al. (2006) An association rule mining based methodology for
automated detection of ischemic ECG beats. IEEE Trans. Biomed Eng, 53,
1531—1540.

Fayn,J. (2011) A classiﬁcation tree approach for cardiac ischemia detection using
spatiotemporal information from three standard ECG leads. IEEE Transact.
Biomed. Eng, 58, 95—102.

Ghaffari,A. et al. (2010) Parallel processing of ECG and blood pressure waveforms
for detection of acute hypotensive episodes: a simulation study using a risk
scoring model. Computer Methods in Biomechanics and Biomedical
Engineering, 13, 197—213.

Gholam,H.H. et al. (2006) The comparison of different feed forward neural network
architectures for ECG signal diagnosis. Med. Eng. Phys, 28, 372—378.

Giiler,I. and Ubeyli,E.D. (2005) ECG beat classiﬁer designed by combined neural
network model. Patt. Recogn, 38, 199—208.

Hoekema,R. et al. (2001) Geometrical aspects of the interindividual variability of
multilead ECG recordings. IEEE Trans. Biomed. Eng, 48, 551—559.

Homaeinezhad,M.R. et al. (2012) ECG arrhythmia recognition via a neuro-SVM—
KNN hybrid classiﬁer with virtual QRS image-based geometrical features.
Expert. Syst. Appl., 39, 2047—2058.

Hosseini,H.G. et al. (2006) The comparison of different feed forward neural net-
work architectures for ECG signal diagnosis. Med. Eng. Phys, 28, 372—378.
Inan,G. and Ubeyl,E.D. (2005) ECG beat classiﬁer designed by combined neural

network model. Patt. Recog, 38, 199—208.

Konias,S. and Maglaveras,N. (2004) A rule discovery algorithm appropriate for
ECG signals. Comput. Cardiol, 31, 57—60.

Lin,C. et al. (2010) P- and T-wave delineation in ECG signals using a bayesian
approach and a partially collapsed gibbs sampler. IEEE Transact. Biomed. Eng,
17, 2840—2849.

Linh,T.H. et al. (2003) On-line heart beat recognition using hermite polynomials
and neuro-fuzzy network. IEEE Trans. Instrument. Measure, 52, 1224—1231.

Martis,R.J. et al. (2013) ECG beat classiﬁcation using PCA, LDA, ICA and
Discrete Wavelet Transform. Biomed. Signal Proc. Control, 8, 437—448.

McSharry,P.E. et al. (2003) A dynamical model for generating synthetic electrocar-
diogram signals. IEEE Trans. Biomed. Eng, 50, 289—294.

Mendenhall,W. and Beaver,R. (1994) Introduction to Probability and Statistics.
Duxbury Press, USA.

Minami,K. et al. (1999) Real-time discrimination of ventricular tachyarrhythmia
with Fourier-transform neural network. IEEE Trans. Biomed. Eng, 46, 79—185.

Miniﬁo,M. et al. (2007) Deaths: ﬁnal data for 2004. Natl Vital Stat. Rep., 55, 7.

Osowski,S. and Linh,T.H. (2001) ECG beat recognition using fuzzy hybrid neural
network. IEEE Trans. Biomed. Eng, 48, 1265—1271.

Philip de,C. et al. (2004) Automatic classiﬁcation of heartbeats using ECG mor-
phology and heartbeat interval features. IEEE Trans. Biomed. Eng, 51,
1 196—1206.

PhysioBank. (2006). [Online]. http://www.physionet.org/physiobank/database/
mitdb/ (18 March 2014, date last accessed).

Polat,K. et al. (2006) A new method to medical diagnosis: Artiﬁcial immune recog-
nition system (AIRS) with fuzzy weighted pre-processing and application to
ECG arrhythmia. Expert. Syst. Appl., 31, 264—269.

Ross,T.J. (2000) Fuzzy logic with engineering applications. McGraw-Hill, USA.

Saxena,S.C. et al. (2002) Feature extraction from ECG signals using wavelet trans-
forms for disease diagnostics. Int. J. Syst. Sci., 33, 1073—1085.

Shih,D.H. et al. (2007) A generalized associative petri net for reasoning. IEEE
Trans. Knowledge Data Eng, 19, 1241—1251.

Shih,D.H. et al. (2010) An embedded mobile ECG reasoning system for elderly
patients. IEEE Transact. Inform. Tech. Bio., 14, 854—865.

Shih,D.H. et al. (2013) Huang SC, an intelligent embedded system for malicious
email ﬁltering. Comput. Standards Interfaces, 35, 557—565.

Singh,B.N. and Tiwari,A.K. (2006) Optimal selection of wavelet basis function
applied to ECG signal denoising. Digital Signal Process, 16, 275—287.

Suﬁ,F. and Khalil,I. (2011) Diagnosis of cardiovascular abnormalities from com-
pressed ECG: a data mining-based approach. IEEE Transact. Inform. T echnol.
Biomed., 15, 33—39.

Vullings,R. et al. (2011) An adaptive Kalman ﬁlter for ECG signal enhancement.
IEEE Transact. Biomed. Engineer, 58, 1094—1103.

Yeong,P.M. et al. (2006) Intelligent classiﬁcation of electrocardiogram (ECG) signal
using extended Kalman Filter (EKF) based neuro fuzzy system. Computer
Meth. Progr. Biomed., 82, 157—168.

Yeha,Y.C. et al. (2012) Analyzing ECG for cardiac arrhythmia using cluster ana-
lysis. Expert Syst. Appl., 39, 1000—1010.

Zhang,G. et al. (2009) Electrocardiogram data mining based on frame classiﬁcation
by dynamic time warping matching. Comput. Meth. Biomech. Biomed. Engineer,
12, 701—707.

Zhou,Q. et al. (2005) ECG beat classiﬁcation using mirrored gauss model. In:
Proceedings of the IEEE Engineering in Medicine and Biology 27th Annual
Conference, China. pp. 5587—5590.

 

1 746

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬂ(1111] 1110131 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

