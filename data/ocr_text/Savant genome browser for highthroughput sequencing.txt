ORIGINAL PAPER

Vol. 26 no. 16 2010, pages 1938-1944
doi: 10. 1093/bioinformatics/btq332

 

Genome analysis

Advance Access publication June 20, 2010

Savant: genome browser for high-throughput sequencing data

Marc Flume“, Vanessa Williams‘, Andrew Brook1 and Michael Brudnol’2
1Department of Computer Science and 2Donnelly Centre and Banting and Best Department of Medical Research,

University of Toronto, Ontario, Canada
Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: The advent of high-throughput sequencing (HTS)
technologies has made it affordable to sequence many individuals’
genomes. Simultaneously the computational analysis of the large
volumes of data generated by the new sequencing machines remains
a challenge. While a plethora of tools are available to map the
resulting reads to a reference genome, and to conduct primary
analysis of the mappings, it is often necessary to visually examine the
results and underlying data to confirm predictions and understand
the functional effects, especially in the context of other datasets.
Results: We introduce Savant, the Sequence Annotation,
Visualization and ANalysis Tool, a desktop visualization and
analysis browser for genomic data. Savant was developed for
visualizing and analyzing HTS data, with special care taken
to enable dynamic visualization in the presence of gigabases
of genomic reads and references the size of the human genome.
Savant supports the visualization of genome-based sequence, point,
interval and continuous datasets, and multiple visualization modes
that enable easy identification of genomic variants (including single
nucleotide polymorphisms, structural and copy number variants),
and functional genomic information (e.g. peaks in ChlP-seq data) in
the context of genomic annotations.

Availability: Savant is freely available at http://compbio.cs.toronto
.edu/savant

Contact: savant@cs.toronto.edu

Received on March 2, 2010; revised on May 25, 2010; accepted on
June 15, 2010

1 INTRODUCTION

The emergence of high—throughput (a.k.a. next—generation)
sequencing technologies has made the acquisition of genomic
data quicker and more affordable than ever before. Continued
technological strides are being made to further improve throughput,
cost and accuracy of the sequencing platforms, enabling large—
scale studies of genomes, populations and diseases. Within the
ﬁeld of personalized genomics, ambitious sequencing projects
such as the 1000 Genomes Project, the International Cancer
Genome Consortium and the Autism Genome Project, are seeking
to identify genomic variants among human genomes and to use
this knowledge to determine the genetic underpinnings of human
diseases by associating variants with symptoms (Hu—Lince et al.,
2005; Via et al., 2010; http://www.icgc.org/). Many computational

 

*To whom correspondence should be addressed.

tools have been developed for single nucleotide polymorphism
(SNP), insertion/deletion (indel) and other types of genetic
variation discovery in individuals sequenced using high—throughput
sequencing (HTS) platforms (Chiang et al., 2009; Hormozdiari
et al., 2009; Li et al., 2008; also see Dalca and Brudno, 2010 and
Medvedev et al., 2009 for reviews). The results of these analyses are
being integrated into large—scale datasets, annotating each variant
with the allele frequency in various populations, and enabling
demographic and association studies.

Simultaneously, HTS has also revolutionized functional
genomics, where the ability to sequence RNA and DNA to
extremely high coverage has made possible RNA—seq and ChIP—seq
(Pepke et al., 2009), methodologies that help discover rare RNA
transcripts, identify the location of transcription factor binding sites
on the genome, as well as discover the locations of nucleosomes.
RNA—seq and ChIP—seq data also consist of many reads aligned to
a reference genome, which are then binned and analyzed for peaks
that indicate putative transcription factor binding sites and exons,
respectively. Additionally, anomalously mapped reads or pairs from
RNA—seq experiments can suggest alternative splicing or fusion
transcripts.

The capacity of new sequencing technologies to generate huge
volumes of raw sequence data has made its analysis a substantial
informatics challenge. Sequencing machines typically output ﬁles
containing a nucleotide sequence and quality values for each read,
which can be tens to hundreds of gigabytes in size due to the sheer
number of reads sequenced in a single run. These ﬁles can be easily
parsed line—by—line by downstream computer programs because of
their structured textual format, but are not intended for direct manual
or visual analysis. While downstream analysis programs, such as
read mappers, SNP callers and peak ﬁnders can identify regions of
interest to the bench scientist, a visual analysis of the supporting data,
as well as other, orthogonal, information is usually warranted before
costly wetlab experiments are performed to conﬁrm the biological
validity of the prediction.

Visualization of genomic data gives researchers the beneﬁt of
looking at information in a more natural and interpretable way
compared with a textual representation. There are many different
tasks that are facilitated by visualization including: (i) integration of
multiple related datasets into a single view, to gain insight into the
interaction between genomic features, (ii) algorithm development,
where visualization of many putative calls (e. g. genomic variants,
promoter sites, intron—exon boundaries, etc.) helps with debugging
and identiﬁcation of true and false positives; and (iii) exploration
of various genomic regions for speciﬁc signatures of functional
sites that may be difﬁcult to describe within a computer program,
e. g. two closely spaced peaks in ChIP—seq data indicating adjacent

 

1938 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /§.IO'S[BU.IHO[p.IOJXO'SOllBIHJOJUTOTQ/ﬁdnq 11101; popeoIII/vxoq

9IOZ ‘Ig lsnﬁnv uo ::

Savant genome browser

 

Table 1. Savant feature list

 

Feature categories Features

 

Data formats FASTA, BED, SAM/BAM, WIG, GFF and any
tab—delimited text ﬁle containing positional
annotations

Speed and efﬁciency Fast data access

Scalable to very large input ﬁles

Small memory footprint

Zooming, panning and seeking using range controls
or keyboard and mouse

Layout Dockable modules supporting show/hide,

rearrangement, maximize, ﬂoat and close

Navigation

Visualization Compact view of sequence, point, interval and
continuous tracks
Multiple display modes for speciﬁc track types
Language Implemented in Java

Works on Windows, Linux, Mac and any other
platform having support for Java Virtual Machine

Plugin framework allows access to data, tracks and
UI for extensive customization

Others Bookmarking favorite locations

Locking overview tracks

Novel representation of paired—end reads making
structural variations easy to identify

Operating systems

Extensibility

 

binding sites. Without the convenience of a visualization tool, in each
of these settings all regions of interest would have to be painstakingly
considered via manual analysis of the supporting data.

A number of tools have been developed for visualizing genome—
based annotations. The UCSC and Ensembl genome browsers,
for example, are popular online tools that have traditionally been
used to display various biological datasets, such as genomic
variants, expressed sequence tag (ESTs) and functional genomic
data, in the context of high—quality, manually curated annotations
(Hubbard et al., 2009; Kent at al., 2002). While both have been
recently updated to support display of HTS data, their use for
this purpose is onerous because: (i) a large amount of locally
stored data must be uploaded to servers across the internet,
(ii) once uploaded, the data being visualized cannot easily be
manipulated or computed with; and (iii) server—side browsers are
typically slow and non—interactive. Other visualization programs
such as the Integrative Genomics Viewer, Artemis and Tablet
(http://www.broadinstitute.org/igv; Milne et al., 2010; Rutherford
et al., 2000) are designed to run on conventional desktop computers
and thus make use of local storage capacity and computing resources
to overcome the shortcomings of web—based browsers. While these
popular browsers allow for interactive visualization of HTS data,
they have limited analytic capability, and are not extensible through
user—contributed modules. A substantial barrier for researchers who
use genomic visualization tools, for all types of data, is the
disconnect between the processes of visualization and computer—
intensive analyses (Nielsen et al., 2010), a void which is caused by
visualization tools being programmatically inaccessible.

Here, we introduce Savant, the Sequence Annotation
Visualization and ANalysis Tool, which combines visualization of
HTS and other genome—based data with powerful analytic tools.
The Savant feature set (summarized in Table 1) was guided by three
key design principles. (i) Ease of use: users can easily install the
application, obtain and load data, and navigate to speciﬁc regions

of interest. The general layout of data mirrors the standard genome
browsers to shorten the learning curve. (ii) Speed and efﬁciency: the
program quickly and dynamically sifts through very large datasets
while maintaining a reasonable memory footprint. (iii) Access and
extensibility: the underlying data is readily accessible from within
the tool itself, and users can extend the application by adding any
number of plug—ins for speciﬁc tasks.

2 INTERFACE

Savant has a simple and intuitive interface, which is customizable
through the use of a modular docking framework. Figure 1 shows
a screenshot of Savant, and illustrates its various components,
expanded upon in the following subsections.

2.1 Navigation

There are several ways a user can specify the genomic region to
be displayed by the viewer. Coarse navigation is made possible
through a range selection panel whose horizontal length represents
the length of the loaded genome, from which subranges can be
chosen using the mouse. Alternatively, ﬁne navigation is possible
by entering the desired genomic range into text ﬁelds. Neighboring
buttons enable zooming in and out and panning left and right. Each
of these functions can also be engaged through mouse and keyboard
shortcuts. Savant also uses a bookmarking framework to allow the
user to switch between many regions of interest, as described lower.

2.2 Modules and docking framework

Savant uses a modular docking framework, similar to those
used in most Integrated Development Environments (IDEs). Each
module within the application appears as a separate window that
can be shown, hidden, maximized, minimized, resized, closed or
rearranged in any conﬁguration the user desires. Modules can also be
detached from the main interface and moved to a separate location,
which is useful for maximizing screen usage on setups having
multiple displays. Savant includes a number of modules which are
described in subsections that follow. To demonstrate the power and
utility of Savant’s plug—in framework the Table View module was
implemented as a plug—in.

2.3 Tracks

A track is a visual representation of one dataset. Each track shows
data of a single type, such as a genome, read alignment, gene set
or generic annotation. A user can specify the region of the loaded
tracks to be displayed via the browser’s many navigation controls.
By default, multiple tracks are stacked on top of each other so that
positions along their horizontal axes correspond to the same location
of the genome, which is standard for genomic viewers (Gordon et al.,
1998, Staden et al., 2000). Simultaneously, Savant enables the user
to lock a certain track, while updating the others, as is described in
Section 3.1

2.4 Bookmarks

It is often useful to make note of interesting regions while using the
browser, or to load a set of such regions in order to quickly navigate
between them. The Bookmarks module helps keep track of such
locations. Users may add, remove or seek to a bookmarked region by

 

1 939

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; popeoIII/vxoq

9IOZ ‘Ig lsnﬁnv uo ::

M.Fiume et al.

 

5:13an 430 name 5 r0535 0:

File Edit 110353 “530-353 Help

 

_ I: .-""I1.'I"III:' 'r. Track “I

D Informal-i I. hallysli

o me: 50.025.222 Tu.- 50.025.231 LEI-19111: 500

D D D 2. NH 12320 .IhrmnlJLLLIHMhIIIJ-‘RP'EDUD 3 2.1303 1215104114

 

2- 2.3100041

3555:5311 __ _  ____
! Add | Delete |
5mm To Annotation
43303-630 33331530 u:031:ru.2_0:nn
49305-643 33105333 ur:001:ru.2_exnn

49213 31342 053' u:031:ru.2_0:nn

43434023 123 ur:331:ru.2_0110n

4333552] I536 ur:331:ru_2 0mm
3

   

500536 54 2?? ur:331:ru_2_E-5mn
5026202] 53262213 ur:331:ru_2_0110n
43322323 43325425 u:331:r3.1_0110r1
4332333] 43323233 ur:331|:r3.l._exur1
433 22251 43322363 u:331:r3.1_0x0r1
43333 535 43331? 13 ur;331:r3.1_0x0r1
4333 I413 43331533 00331102. l_0x0r1
43335443 43135433 u:331:r3.l_0110r1
4323 3342 43234353 u:331:r3.1_0x0r1
43366I26 33366332 00331101123110" "
433 2443? 33323211 ur;331:rr.2_erun ‘1
433333“ 33331333 003310123100
43332153 333325-13 00331012311110
43333 535 33333223 003310123100
43314364 33315 13-1 0133101231100
43366 I26 43366332 00331102223500
43324431" 43324211003311022231100.
4333331“ 43331333 00331100231100
4333? I 53 43332625 00331102223300
43333 535 43333223 00331102223500
433 I4364 43315134 00331102223300
511.112.5121. 502115441 IJI':I|||]1'"'..-"

5333 32 I 5 53333456 ur331m.2_0110r1
534 I 534:II 53415451003311r3.2_0110r1
53432323 53432122 ur331:ﬁ.2_010r1
534333 I3 30434045 010010224500
5343563? 53435226 003313325100
534 33 I33 53453631013314W.2_0wn
53 342 I63 53332253 013310223100
5333 32 I 5 53533456 0:331:12.2_020n
53415342 53415351003311r2.2_0200
534 32323 5333212? 00331112231100
53433313 50434045 0033112223200
5343563:II 53435226 0033111223100
534 33 I33 50433541 00331122231105
33344353 50344552 00331135235100
5333 32 I 5 53333456 00331152235105

1 00331135231105
2 00331153231100

 

I Tablem lankmark Intersections '

 

TracL' HAIZEFEII‘ImmlJIJMMINhhwaSRPﬂ.._ 5

 

mm“: x:  ill-Id Name Senna-5:0 Length Fir 5|! U'I Pair Phillrﬂl'l ‘ Strand '3
- 51111003022... WGTTAT.. 25 l5!| 50025121 E?!

5101003352... 1125401152.. 25 El 50025121 E

5011003025... 2013mm... 25 _ 50025150 E]
5111001115....545505520... 42 _ 50025151 E!

51111003053... 5.1000200... 25 __ 50025153 __

500001235... 20.40.121.10... 35 __ 50025155 __

5011001251.... NANMEA... 35  50025200 El

5110001225... 2510505252... 35 I?! 50025203 I?!
5133001501....MEMIATAT... 42 ' 50025203 571

 

I.
5 00331152.: 3:100 ',

£3010 Update Ewart  L003  5030 

HIPP'ITI! Qua... EIEIILR Mate Fusirlnn Strand + lnlerred Inst... I,- w: W
51] TEM 5DD253'CI5 [a —5II-I'L._ 
322051 50026121 '_ 0
I50 TEM 50025254  -502
25 42M --1 '_ 0
I50 TEM 50020502 ',,_ 335
50 3051 5002630.? '_ lIIS
121535311 -1 '.__ I}
355351 50023055  -lI5|I '
32 42M —1 ' 0_"

Number 0f records: 511 1511002109 00315031

 

Fig. 1. Screenshot of Savant. (A) Range controls. Selection, zoom and pan controls for coarse navigation; text ﬁelds for ﬁne navigation. Zooming and
panning are also possible via keyboard and mouse commands. (B) Tracks. These represent the data in current range. Top: read alignments, with colored pixels
representing differences between the reads and the reference. Bottom: color representation of the genome sequence. (C) Table View module, detached from
the main interface. The table view module is displaying the mapped reads with SAM format ﬁelds. (D) Bookmarks module.

using buttons within the module or keyboard shortcuts. Furthermore,
bookmarks may be tagged with a description and exported for future
use or for sharing among colleagues.

2.5 Table View

Finally, while Savant aims to provide the user with the ability
to compute on the underlying data directly, through the plug—in
framework described in Section 5, in many cases the user may wish
to identify the underlying data elements for export to an external
program, e.g. identifying the genomic sequence within a window to
align against another genome, or downloading all of the supporting
reads for a SNP to make sure they do not align elsewhere in the
genome. In Savant, the user can display the underlying textual data
from any loaded track within the Table View. This module displays
records as rows and ﬁelds as columns in a spreadsheet. For each

read mapping, for example, the Table View displays the read name,
mapped position, CIGAR string and other SAM ﬁelds. The data can
be sorted in either ascending or descending order with respect to any
ﬁeld. The spreadsheet can also be exported for further analyses.

3 VISUALIZATION

Savant retrieves and renders data every time a range change is
requested by the user. Together, these processes happen quickly so
as to confer seamless navigation around the genome. The renderer
for each track is adaptive to both the display mode and the length
of the viewed region chosen by the user.

3.1 Dynamic resolution changes

Savant dynamically adjusts its resolution—the amount of
information it displays—to optimize both nucleotide— and

 

1 940

112 /3.IO'SIBUJHOIpJOJXO‘SOIlBUIJOJUIOIq/ﬂdnq 111011 papeoIHAAoq

9IOZ ‘IE lsnﬁnv uo ::

Savant genome browser

 

 

a e
e ' n
:1:—
_  In:
a? . 

Fig. 2. Read alignments, visualized at various resolutions and using two
modes. (A) Chromosome—wide view of read mappings, showing the overall
coverage (with no coverage in the centromere). (B) Regional view, still
visualized as a coverage map, showing higher coverage in certain regions
of the genome. (C) Local view, the reads are shown separately and
differences between the reads and the reference genome are colored. Reads
on the forward and reverse strand are shown with different shades of blue.
(D) Matepair (arc) mode, showing the relative distance between the two
reads of a pair. Taller arcs indicate larger distances between the pairs.

genome—scale Visualization of tracks. For example, read alignments
can be Visualized as a coverage track when the number of base
pairs within a region is too large to enable the Visualization of
individual reads. Once the region is small enough, Savant seamlessly
switches to a read—alignment View, as shown in Figure 2. In addition
to presenting a more intuitive Visualization, this feature also reduces
the program’s memory footprint and improves overall speed.
Individual tracks can also be locked to a particular range so that
they are not updated until they are unlocked. Locked tracks can be
used as overview proﬁles from which subregions can be selected to
specify range changes for other tracks. Track locking also enables
simultaneous Viewing of high— and low—resolution proﬁles.

3.2 Display modes

Particular data types can be displayed in different modes. For
example, interval annotations can be squished together on a single
line or packed neatly so that none overlap (mimicking the squish
and pack modes of the UCSC browser). The representation can be
dynamically toggled within the browser, with each representation
option emphasizing different aspects of the data. The variant and
strand modes for read alignments, for instance, use colors to
emphasize mismatches in reads and the strands to which reads
are mapped, respectively. A novel mode for representing matepairs
shows arcs between the mapped locations of paired reads, where the
height of each arc is proportional to the inferred insert size. Arcs for
anomalously mapped pairs, such as those suggestive of inversions
or duplications, are colored differently. The various modes for read
alignments are illustrated in Figure 2.

4 FILE FORMATTING AND PERFORMANCE

Savant supports a number of common text—based formats, which
are described in Table 2. However, because text—ﬁles do not enable
fast random access, Savant formats and saves each ﬁle so as to
provide very efﬁcient search operations at runtime. The speed with
which Savant can sift through large datasets is enabled by the way in

Table 2. Supported ﬁle formats

 

File Format Description

 

FASTA Standard format for nucleotide sequences
BED Format for describing coordinates of localized
features on genomes, such as genes
Relatively standard format for large sets of
nucleotide sequence alignments
WIG Standard format for continuous—valued data.
Useful for GC percent, probability scores and
transcriptome data
GFF General feature format for annotations of ranges
Tab delimited Any tab—delimited ﬁle containing point, interval
or continuous genome annotations

SAM/BAM

 

which it formats and indexes data. In particular, formatting involves
converting text records into an indexed binary data structure speciﬁc
to each data type. Sequence and continuous tracks are stored as
ﬁxed—width records, enabling direct lookup of records of interest.
Annotation ranges (such as genes) are stored using a binning scheme
similar to the one used in the UCSC Browser (Kent et al., 2002) and
in BAM ﬁles (Li et al., 2009), so retrieving all ranges corresponding
to some region usually requires only one, and at most 0(logn) disk
seeks. File formatting can be done directly through the application
itself. Savant keeps its memory usage low by adjusting its sampling
rate depending on the size of the Visualized range.

The time and space requirements for the processes of data
formatting and Visualization were measured for a collection of
human chromosome 1 datasets, including a genetic sequence,
genes, SNPs, mammalian conservation and alignments of sequenced
reads from an individual from the 1000 Genomes Project (~40X
coverage). The tests were performed on a Lenovo T6lp laptop
computer with an Intel Core 2 Duo CPU at 2.40GHz and 3.0 GB
of RAM. The results are summarized in Table 3. Formatting of
the gene, SNP, sequence and conservation tracks took less than
10min total, while the computation of a coverage track from a
large set of read alignments took about an additional 40 min. The
latter conversion is optional, and allows for dynamic switching
between an alignment View and a coverage View as illustrated in
Figure 2. Runtime performance was assessed by measuring the time
taken to navigate to ranges of various sizes. Each measurement
was performed on a newly started instance of Savant and the start
location of the range was randomized. For seeking arbitrary ranges
of sizes 10 million to 10K bp, Savant took less than a second to fetch
and render data. The performance was worst for ranges just slightly
shorter than 10K long, where the large number of BAM records that
are displayed require 2 s to be fetched from disk. Savant renders
Virtually instantaneously for regions having sizes on the order of
hundreds of base pairs, where most ﬁne—scale Visualization is done.

5 PLUG-IN FRAMEWORK

Savant is able to integrate user—deﬁned plug—ins, allowing one to
accomplish very speciﬁc tasks. Each plug—in can be one of two
general types. Interactive plug—ins are allocated dockable modules
on which graphical user interface (GUI) elements such as buttons or
text ﬁelds can be placed to respond to user input and retrieve data.
Non—interactive plug—ins are not designated a GUI component but

 

1941

112 /B.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv uo ::

M.Fiume et al.

 

Table 3. Time and space requirements for ﬁle formatting and visualization

 

 

 

 

Data ﬁles Formatting Retrieval and visualization
10M 100K 1K 100
File name Size Records Out size Time #Recs. Time (s) #Recs. Time (s) #Recs. Time (s) #Recs. Time (s)
chrl .genes.bed 1.1 MB 7.5K genes 970 KB 2 s 423 0.18 10 0.05 7 0.03 5 0.00
chr1.snps.point 26 MB 1.5M SNPs 26 MB 4 s — — 559 0.01 12 0.00 6 0.00
chr1.sequence.fasta 242 MB 249M nucs 237 MB 11 s — — — — 1000 0.00 100 0.00
chrl .conservation.wig 1.2 GB 249M vals 1.2 GB 6 m 10Ma 0.32 100Ka 0.18 1000 0.02 100 0.01
NA12878.chr1...bam 25 GB 262M reads No formatting req. Coverage shown at these ranges 1101 0.05 150 0.04

NA12878.chr1...cov Computed from BAM ﬁle 1.2 GB 42 m 10Ma

TOTAL 53 m

0.32 100Ka 0.18
0.82 s 0.40 s 0.10 s 0.05 s

Read alignments shown at these ranges

 

The Data Files section describes input ﬁles. The Formatting section shows time required to format each input ﬁle and the resulting formatted
ﬁle size. The Retrieval and Visualization section shows the time taken to retrieve data from ranges of various sizes and the number of records

retrieved and drawn. All operations require <50 MB of memory.

aTracks with continuous values are smoothed before rendering at large ranges. Sequence and point tracks are not rendered beyond certain
ranges, denoted with a hyphen (—). Read alignments (BAM ﬁle) are replaced by coverage (precomputed from the BAM ﬁle) when visualizing

longer regions.

Table 4. Helper functions provided to plug—ins

 

 

Category Function descriptions
Range Change range
Tracks Add, remove, retrieve data, change display

modes and resolutions

Bookmarks Add, remove and seek
UI Rearrange modules
Other Take screenshot, export data, etc.

 

still have extensive access to the innards of the browser. A number of
helper functions are provided to plug—ins which are summarized in
Table 4. Plug—ins can be used, for example, to prototype a SNP ﬁnder
by identifying variable columns currently in View, or for computing
genome—wide statistics, such as the fraction of SNPs in exons.

Plug—in development is straight—forward and requires
implementation of one Java interface. The Bookmark Intersection
Plug—in, shown in Figure 3, is an example of an interactive plug—in.
The plug—in allows the user to select two tracks, intersect them and
load the intersecting regions into the list of bookmarks, enabling
easy navigation to all of the regions of interest. Once developed,
plug—ins can be shared among users through the Plugin section of
the Savant web site.

6 EXAMPLE USES

In this section, we demonstrate example usages of Savant to identify
and Visualize various polymorphisms between the reference human
genome and a Yoruban genome (HapMap individual NA18507)
sequenced with the Illumina platform (Bentley et al., 2008). The
raw reads and MAQ mappings (in BAM format) were downloaded
from the 1000 Genomes web site, while the conservation track (in
WIG format), gene annotations and dbSNP data were obtained from
the UCSC database. Figure 4A shows two likely SNP variants in

public class BookmarkIntersecticnPlugin
implements InteractivePlugin {

If set by UI
GenericIntervalTrack sourceTrack, targetTrack;

EangeController rc;
Eeekmarktontroller be;

If constructor
public BookmarkIntersecticnPlugin{JPanel p,
SavantPluginAdapter pluginﬁdapterl {
f* UI Setup Cede:
* Create a UI in JPanel to select a are and a
*ftarget track. Details skipped for simplicity
*

rc
hc
}

I* called on button press *I
public static void hookﬂarkTrackIntersections{} {

pluginﬁdapter . ge tRange Controller 1 :l ;
pluginadapter . geth—o kmarkﬁontroller I: } ;

List sourceIntervals =
sourceTrack.getRecords(rc.getHaxRange{}};

for {GenericIntervalReccrd r : sourceIntervalsJ {
Range scurceRange = r.getInterval[i.getEangeE]:

List targetIntervals =
targetTrack.getRecords(sourceRangel;

if [targetIntervals.sizet} } U} {
bc.addBcckmark{new BcckmarkIscurceRange,
targetIntervals.getDescriptionIll];

Fig. 3. Code used to make Bookmark Intersection Plug—in. The details of the
UI that allows the user to select two tracks have been omitted. Once the two
tracks are selected, the bookMarkTrackIntersections() method is run, which,
for each interval of one track, ﬁnds overlapping intervals of the other, and
saves intervals with overlap to the bookmark panel.

the NA18507 genome. SNPs are typically supported by consistent
mismatches in aligned reads with respect to the reference at the
variant positions. The reads support the existence of a transition

 

1 942

112 /B.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv uo ::

Savant genome browser

 

m- er m

 

Inn
File Edil We“. “inden- Help

 Trunk . Fun: 3.9?5 Te 11']: Hugh WI |' u" H” II- III II 
|
E
:7- :3- y:- 4 mop-m mum-n- la

—
con --—~

'2' 0 c 5. Miasuou—msmuna hymn-an.

H~ _—___.:i

a.

 

 

 

 

 

 

 

 

 

C" C“ r.“ l.1i'lfl.1l.ll|nl'|l

J. gin-1 "F1 in.“

 

[ m.m.

 

Pom: I. llll 'F: l Dmﬂng: 'I'nhilluliib'i'i'l' Hm 'ﬂ' _'u -.| : .1.I
I
II 1“ I“ MES-“l1! Irony!
6 File Idil 'Iﬁaw Window Help
- -- - :-- :' Irlcic '. From: 35911an To- sauern Lem- m l‘ "a “n. W * " '1
|"." I? uni-rum
_._E‘_ ﬂgﬁ
.. hum In Ann-all”an-
"" "'hﬂﬂm' ' mun-5:. rurluas- 1 lel :l'rr]. mﬂel '
5‘ D If‘ 3 run. Inn-hidden“ J HIE-HE zussus a tall rJ'rrJ. mile-l
nuns? zusrnu]:an.m1.muel
21-15:on 21-91211-1ch rJI'u'1.|.I1|:le|
III-15551! nun-u 1 Call :ru'lJnﬂ-I-l
Hanan: 232s“ is 1 Call on Lnﬂl-l

l! LT-EEIE'I 11131.34"! E. Call [H1 H1ﬂ-l-I

Er;

 

 

 

 

$953149} 39531314 iii-3|” EFIL H'II‘H'I
43204-24 43329645 ll {all [Hi Ind-H
i-i'li'ﬁil'lﬁ 53062-1“? ] [all EFF]. rad-El

52 WES-ll} 621036-31 I [all lli'Fl indel
“HMS-+5 Hill-133 ‘.i [all are]. ndel
i'ii'JEIS-H HHS} .i'-'l 4| {all I:I"H'l muel
955‘1151 55511.1'II1LJII. rJ'rrJ..n1:Ie|
llldllgﬂi lllZi-‘Illll IL'JII. rJ-rrJ..H1:IeI
113W! lﬂ! ILIUUJJEU I Call' l'J'H'lJﬂﬂtl
lJDEIEEQL 12112-5551! 1 Call l'J'H'l.H1ﬂ-l-| .
JJDFSEDE E IZDIH-E-lli‘ II- Clll :P'H'lJnﬂ-l-I .

Lcld Slut
|""l I“! linrnullunﬁhnlh-In

 

' ’Ilhll “m hallmark mm ]

 

_ left-sill ka'l _
SIDUIEE 'l'rutil.

:h' l . l11l:l:ili.f|! LUIEE. Lﬂ'ﬂlF-E
(iv 1 esuru
thrermanalanunr

 

Tm“ THEE
(hr 1.1'ncdll.re suits. saw-art

thr] rrmnpalrssiun:

 

mount lurinetrleni;

mum-I. I: 35mm: 1': I

cum-lg: Tannin“? I Hungry: [I '-2.Po'ln!i|-:-.i'-'_k

Fig. 4. (A) Visualization of two SNP variants. The displayed tracks are, top to bottom, Conservation, Gene Models, Read Alignments, the Genome sequence
and known SNPs from dbSNP. Two potential SNP variants are indicated by consistent mismatching colors within a column, with the downstream SNP
previously known, while the upstream one, a heterozygous variant, not in dbSNP. (B) Identiﬁcation and visualization of MoDIL indel variants that overlap
exons via the plug—in framework. The visualized tracks are Gene Models, read mappings (visualized in the matepair mode) and MoDIL predictions. The panel
on top right is the Bookmark module, while on the bottom right is the BookMarkIntersection plug—in described in Figure 3. To identify variants of interest,
the user selects the two tracks in the BookMarkIntersection window, and those variants that overlap exons are added to the list of bookmarks. The user can
then easily go through this list. In this particular case the indel likely occurs in the intron between the exons, but because of MoDIL’s inability to accurately
identify borders of variants, the variant is shown as overlapping.

 

1 943

12 /810's[numo[p10jx0'sor1nu110jurorq//:d11q 11101; popnommoq

9IOZ ‘IE lsnﬁnv uo ::

M.Fiume et al.

 

mutation (C to T) at a known SNP site, indicating a likely common
variant in the human population. There is also considerable evidence
(3/ 12 reads) for another transition (G to A) slightly upstream,
indicating a putatively novel SNP Both of these SNPs fall in an
exon of a gene, as shown by the annotation, while the conservation
appears to drop—off in the immediate Vicinity of the SNPs, indicating
weakened evolutionary constraint.

We also demonstrate the use of the plug—in framework to identify
and investigate biologically interesting indel predictions made using
an external tool. We used the dataset of predicted insertion and
deletion (indel) polymorphisms predicted by MoDIL (Lee et al.,
2009), which identiﬁes these variants by analysis of matepair data. In
particular, MoDIL identiﬁes regions of the genome with a signiﬁcant
number of discordant matepairs (those with a distance between the
mappings of the reads signiﬁcantly different from the expected
insert size of the library). We built a plug—in to identify those
indels that overlap exons, the code of which is shown in Figure 3.
Figure 4B displays the result of running this plug—in, together with
one such region of interest. In this case, the deletion lies directly
between two exons, and likely creates a genomic variant with a
much shorter intron, or with the intron completely spliced out of
the gene sequence. Taller arcs in the read Visualization mode are
indicative of ‘stretched’ matepairs that conﬁrm the deletion, while
the lack of read mappings within the deleted region indicates that
the deletion is homozygous.

7 DISCUSSION AND FUTURE WORK

In this article, we introduce Savant, a genome browser customized
for Visualization of HTS data. In addition to dynamic Visualization
and support for multiple data types, Savant supports multiple
novel features meant to simplify the analysis of genomic data,
including a Bookmarks module to keep track of regions of interest,
a Table View module to allow researchers access to the raw
data underlying the Visualizations and a plug—in framework that
allows developers extensive access to the browser, enabling them to
program novel analysis methods and extend the browser to support
new Visualization and data types.

In the near future, we plan to expand Savant by supporting
additional ﬁle formats, while also allowing users to automatically
download annotation tracks from various public resources, such
as the UCSC Genome Browser and the 1000 Genomes Project.
Additional functionality, for example, to save/restore user sessions,
enabling novel Visualization modes, such as superimposition of
tracks, and combining the matepair and regular read alignment
views in a single panel will also be added in subsequent
releases. Savant is an open source tool, freely available at
http://compbio.cs.toronto.edu/savant/. We are also working to build

a user community, accessible through the same web site. The
community can be used to share Savant plug—ins with other
researchers, as well as to communicate with the development team,
to report bugs and to suggest new functionality and improvements.

ACKNOWLEDGEMENTS

We would like to thank Misko Dzamba, Seunghak Lee and Paul
Medvedev for assistance with this manuscript. We are also indebted
to the scientists at The Centre for Applied Genomics (Toronto,
Canada) for feature and design suggestions. MB is an Alfred P.
Sloan Research Fellow.

Funding: CIHR Catalyst Grant (to M.B.); an NSERC Undergraduate
Student Research Award for (ME).

Conﬂict of Interest: none declared.

REFERENCES

Bentley,D.R. et al. (2008) Accurate whole human genome sequencing using reversible
terminator chemistry. Nature, 456, 53—59.

Chiang,D.Y. et al. (2009) High-resolution mapping of copy-number alterations with
massively parallel sequencing. Nat. Methods, 6, 99—103.

Dalca,A.V. and Brudno,M. (2010) Genome variation discovery with high-throughput
sequencing data. Brief. Bioinform., 11, 3—14.

Gordon, D. et al. (1998) Consed: a graphical tool for sequence ﬁnishing. Genome Res.,
8, 195—202.

Hormozdiari,F. et al. (2009) Combinatorial algorithms for structural variation detection
in high-throughput sequenced genomes. Genome Res., 19, 1270—1278.

Hu-Lince,D. et al. (2005) The autism genome project: goals and strategies. Am. J.
Pharmacogenomics, 5, 233—246.

Hubbard,T.J.P. et al. (2009) Ensembl 2009. Nucleic Acids Res., 37 (Suppl. 1),
D690—D697.

Kent,W.J. et al. (2002) The human genome browser at UCSC. Genome Res., 12,
996—1006.

Lee,S. et al. (2009) Modil: detecting small indels from clone-end sequencing with
mixtures of distributions. Nat. Methods, 6, 473—474.

Li,H. et al. (2008) Mapping short dna sequencing reads and calling variants using
mapping quality scores. Genome Res., 18, 1851—1858.

Li,H. et al. (2009) The sequence alignment/map format and samtools. Bioinformatics,
25, 2078—2079.

Medvedev,P. et al. (2009) Computational methods for discovering structural variation
with next- generation sequencing. Nat. Methods, 6, S l3—S20.

Milne,I. et al. (2010) Tablet—next generation sequence assembly visualization.
Bioinformatics, 26, 401—402.

Nielsen,C.B. et al. (2010) Visualizing genomes: techniques and challenges. Nat.
Methods, 7 (Suppl. 3), S5—S15.

Pepke,S. et al. (2009) Computation for chip-seq and RNA-seq studies. Nat. Methods,
6 (Suppl. 11), S22—S32.

Rutherford,K. et al. (2000) Artemis: sequence visualization and annotation.
Bioinformatics, 16, 944—945.

Staden,R. et al. (2000) The staden package, 1998. Methods Mol. Biol., 132, 115—130.

Via,M. et al. (2010) The 1000 genomes project: new opportunities for research and
social challenges. Genome Med, 2, 3.

 

1944

112 /§.IO'SIBUJHOprOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 1110131 pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

