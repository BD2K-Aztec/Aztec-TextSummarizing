ORIGINAL PAPER

Vol. 31 no. 1 2015, pages 69-75
doi: 10. 1 093/bioinformatics/btu592

 

Gene expression

Advance Access publication September 3, 2014

Estimation of GFP-tagged RNA numbers from temporal

fluorescence intensity data
Antti Hakkinen and Andre S. Ribeiro*

Laboratory of Biosystem Dynamics, Computational Systems Biology Research Group, Department of Signal Processing,
Tampere University of Technology, PO. box 553, 33101 Tampere, Finland

Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: MSZ-GFP-tagging of RNA is currently the only method to
measure intervals between consecutive transcription events in live
cells. For this, new transcripts must be accurately detected from in-
tensity time traces.

Results: We present a novel method for automatically estimating RNA
numbers and production intervals from temporal data of cell fluores-
cence intensities that reduces uncertainty by exploiting temporal in-
formation. We also derive a robust variant, more resistant to outliers
caused e.g. by RNAs moving out of focus. Using Monte Carlo simu-
lations, we show that the quantification of RNA numbers and produc-
tion intervals is generally improved compared with previous methods.
Finally, we analyze data from live Escherichia coli and show statistic-
ally significant differences to previous methods. The new methods can
be used to quantify numbers and production intervals of any fluores-
cent probes, which are present in low copy numbers, are brighter than
the cell background and degrade slowly.

Availability: Source code is available under Mozilla Public License at
http://www.cs.tut.fi/%7ehakkin22/jumpdet/.

Contact: andre.ribeiro@tut.fi

Received on June 3, 2014; revised on July 14, 2014; accepted on
August 27, 2014

1 INTRODUCTION

Transcription, translation and degradation of RNA and proteins
are stochastic processes (Elowitz etal., 2002; Kaern etal., 2005;
Ozbudak etal., 2002; Taniguchi etal., 2010; Yu (2161]., 2006).
Their stochasticity results in phenotypic variability in monoclo-
nal cell populations (Elowitz etal., 2002; Pedraza and van
Oudenaarden, 2005) and temporal phenotypic changes in cells
(Golding etal., 2005; Yu (2161]., 2006). As such, to better under-
stand phenotypic diversity, the mechanisms regulating RNA and
protein numbers must be understood.

Presently, the only technique for quantifying RNA numbers
and transcription dynamics in live Escherichia coli cells over time
consists of tagging target RNA molecules with an array of ﬁuor—
escent MS2-GFP proteins (Golding and Cox, 2004). Using this
technique, the target RNA can be visualized as a bright spot (see
e.g. Fig. 6) shortly after production (Golding and Cox, 2004;
Golding etal., 2005). This method allows studying transcription

 

*To whom correspondence should be addressed.

in the absence of several sources of stochasticity (Kandhavelu
(2161]., 2012a), such as RNA degradation (Taniguchi etal., 2010)
or dilution by cell division (Huh and Paulsson, 2011).

The quantiﬁcation of transcription dynamics from ﬂuores-
cence microscopy images requires estimation of the RNA num-
bers or the RNA production times using statistics extracted from
microscopy images, such as temporal intensity signals. Some
methods have been proposed for determining RNA numbers
using cell and/or ﬂuorescence spot intensities, either using manu-
ally assisted (Golding etal., 2005) or automatic (Hakkinen etal.,
2014) techniques. However, these methods were designed to ex-
tract stationary RNA distributions from cell populations, and as
such, they neglect any temporal information in the data.
Recently, we introduced a method (Kandhavelu (2161]., 2012b)
to use such information to extract time intervals between con-
secutive RNA productions in individual cells. This method uses a
piecewise-constant monotonic least-squares (LSQ) ﬁt with an
F—test to select the model order, after which a jump in the
model curve is taken to correspond to the production of a
target RNA. Unfortunately, this method does not extract the
absolute RNA numbers.

Here, we propose a new method for automatic quantiﬁcation
of RNA numbers and RNA production intervals from intensity
time series extracted from cells. Speciﬁcally, we consider two
variants: one that uses LSQ costs, which can be derived using
the central limit theorem, and one that uses least-deviations (LD)
costs, which is a robust variant of the former. In particular, the
latter was designed to counter outliers commonly observed in the
intensity data, caused by e. g. RNA molecules moving out of the
focal plane, at the cost of reduced accuracy. The new method
was designed to exploit the temporal information in the data for
improved accuracy, to not require post— and/or pre-processing
for time interval extraction and to be free of any regularization in
temporal domain to allow more accurate quantiﬁcation of time
intervals.

First, we present Monte Carlo simulations to demonstrate that
the accuracy of the method is, in general, superior to the existing
methods, in estimating both RNA numbers and RNA produc-
tion intervals. Second, we apply our method and the previous
methods on novel data extracted from time-lapse microscopy
measurements of live E.coli cells expressing MS2—GFP and
RNA target to show that, for large number of cells, statistically
signiﬁcant differences in the results can be detected between the
new and previous methods, in both RNA numbers and RNA
production time intervals.

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 69

112 /310's113umo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

A.Hakkinen and A.S.Ribeiro

 

2 METHODS

2.1 Cells and plasmids

Escherichia coli strain DH50t-PRO was generously provided by I. Golding
(University of Illinois) and contains two constructs: a PROTET-Kl33
medium-copy vector carrying a MS2—GFP reporter, controlled by
PLteto-1, and the pIG-BAC single-copy vector coding for mRFPl-MS2-
96bs RNA, whose expression is controlled by Plac /ara-1 (Golding and Cox,
2004).

2.2 Microscopy

Cells were grown in Miller lysogeny broth (LB) medium supplemented
with antibiotics according to the speciﬁc plasmids. Cells were grown
overnight at 37°C with aeration, diluted into fresh medium and allowed
to grow at 37°C until an optical density OD600 of 0.3—0.5 was reached.
To attain full induction of the MS2—GFP reporter, cells were incubated
with 100 ng/ml of anhydrotetracycline (aTc, from IBA GmbH). In all,
0.1% of L-arabinose (Sigma-Aldrich) and lmM of Isopropyl-B-D-
thiogalactopyranoside (IPTG, Ferrnentas) were used to induce the
target RNA. Cells were pre-incubated with arabinose at the same time
as aTc. IPTG was added 1 h after aTc, and cells were incubated for 5 min.

Microscopy was performed using a Nikon Eclipse (TE-2000—U, Nikon,
Tokyo, Japan) inverted confocal laser scanning microscope. Cells were
imaged in a thermal chamber set to 37°C. Images were taken 5 min after
induction by IPTG, for a duration of 2 h, once per minute. For imaging, a
few microliter of culture were placed between a coverslip and a slab of
1% agarose containing LB along with the appropriate concentrations of
inducers. When both the reporter and the target RNA are present in the
cells, MS2—GFP proteins bind to the target RNA, forming a bright ﬂuor-
escent spot (Golding etal., 2005). The RNA becomes visible during, or
shortly after, elongation (Golding and Cox, 2004).

2.3 Image processing

Cells were detected from the microscope images using a semi-automatic
method described in Kandhavelu etal. (2012b). First, a mask is manually
painted over the area that a cell occupied during the time series. Principal
component analysis is then used to obtain the dimensions and orientation
of the cells from the ﬂuorescence distribution within each mask. Next,
target RNA spots were automatically segmented using kernel density es-
timation with a Gaussian kernel. Cell background-subtracted spot inten-
sities were then calculated and summed for each cell to produce the total
spot intensity within each cell, which was used to quantify RNA numbers.

3 ALGORITHM

3.1 Overview of the method

As each RNA is tagged by a large number (up to 96) of MS2-
GFP molecules (Golding etal., 2005), the intensities detected
from a single RNA are expected to be well approximated by a
normal distribution (central limit theorem). Consequently, sums
of intensities of k RNA spots (e. g. in a cell) can be assumed to be
normally distributed, with mean and variance k times that of the
individual RNA, provided that the components are sufﬁciently
independent (Hakkinen etal., 2014).

Another assumption exploited by our method is that the MS2-
GFP-tagged RNA molecules are virtually immortal during a cell
lifetime [veriﬁed in Muthukrishnan et al. (2012)]. Because of this,
one can assume that the RNA numbers form a non-decreasing
series over time. For that, for example, the data before and after
cell division must be treated as separate series.

We propose two variants of our method that use the same
strategy but different intensity models. The LSQ variant uses

normally distributed errors, as discussed above, but with constant
(as opposed to linear) variance. We experimented with the linear
variance model, but in the zero-noise limit, it approaches to the
constant variance one, and the results were similar. Also, if add-
itional noise sources affecting all the spots in an equal manner
(regardless of their RNA numbers) are present, the model should
be afﬁne, i.e. somewhere between constant and linear.

The LSQ variant is similar to the method introduced in
Kandhavelu etal. (2012b), which uses a piecewise-constant
monotonic LSQ ﬁt with an F—test to select the model order,
after which a jump in the ﬁt curve is taken to correspond to a
production of an RNA. However, there the jump sizes are regu-
lated by the means of the F—test (and the monotonicity con-
straint). Moreover, the F—test also causes regularization in the
temporal direction. In our method, regularization is performed
via constant jump size and the monotonicity constraint, to avoid
regularization in the temporal domain.

Meanwhile, the LD variant was conceived to mitigate the
problem that the RNA intensity time series sometimes contain
‘holes’, caused by, for example, RNA spots moving out of the
focal plane (see e.g. the lower panel of Fig. 6). This variant uses
the median as the location estimator, making it more robust than
LSQ. If no such outliers are present, the LSQ should be pre-
ferred, as it is expected to be more accurate.

Regardless of the variant, the method operates as follows:

(1) A curve (without quantization) is ﬁt to the intensity time
series. This groups the related samples to reduce uncer-
tainty, extracting the temporal information from the
data. If the data are not temporal, this step is effectively
a no-operation.

(2) Jump size (and other parameters such as uncertainty) is
estimated from the ﬁt pieces. We provide a new set of
estimators for this step, but the one proposed in
Hakkinen etal. (2014) could be used instead.

(3) A quantized curve is ﬁt to the time series, given the par-
ameters, enforcing the quantization to the ﬁt. This is used
to provide the RNA numbers.

3.2 Curve ﬁtting

Piecewise-constant curve ﬁtting can be done in polynomial time
using a dynamic programming technique. Let a’(x, y) be some
metric and (x0221 be some sequence of length n, x,- denoting its
ith element. Let D2,) be the distance between a substring (Xi)?=a
of the input and a k-piece model:

P1 1)
DZFZ 6106;» M1)+  + Z 6106;» Mr.) (1)
i=a i=pk_1+l

which is to be minimized for a = l, b = n and some k g h:

min le n = min min D131 + min D; H n (2)
P1,---,Pk—1, ’ Pk—i P1,---,pk—2, ’ le Mk k_1 ’
M1,...,Mk M1,...,Mk_1

which can be computed by memoizing the minima of each D’ib
and D6111). Given that D1131 have already been minimized, it takes
(9(n2) time to minimize D’ib for all b. If the minima of D6111) are

computed for all a, b in time T (n), D’fﬂ can be minimized in

 

70

1e /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; popeoplmoq

9IOZ ‘09 lsnﬁnv uo ::

Estimation of RNA numbers from temporal data

 

T (n) + (9(k n2) time and C(11) space. In the process, the solutions
for all h and for all orders up to k are obtained. To ﬁt the data
with a monotonic function, the solutions violating the monoton-
icity constraint can be ignored in the minimization process.

In particular cases, a link between the choice of the metric
a’(x, y) and maximum likelihood estimation can be established.
If one assumes some piecewise-constant curve, corrupted by
additive independent zero-mean normal distributed errors, a
curve ﬁt by the above procedure using squared error metric
a’(x, y) =(x — y)2 corresponds to the maximum likelihood esti-
mate of the signal. Similarly, there is a link between using abso-
lute error metric a’(x, y) = Ix — yl and Laplace distributed errors.

We implemented LSQ and LD metrics. The LSQ problem can
be trivially implemented in T (n) = (9(n2) time, by computing run-
ning averages of the data. Similarly, the LD problem can be
solved by computing running median, and can be implemented
in T (n)=(’)(n210g n) time using priority queues with O(log n)
update times. In practice, we have been using these methods
for up to 10000 samples on a standard personal computer.

3.3 Jump size estimation

We estimate the jump size using a maximization of approximate
likelihood in the low-noise limit. This method is expected to
work when the noise-to-signal ratio of the data is reasonably
small (see results for examples).

The probability density function of an equiprobable mixture
of normal distributions with means at k ,u. for k e Z and variance
of 02 is as follows:

_ 00 C
f(x) — k; —T a, Mexp (

where x is the intensity and w is used to scale the uncertainty of
x. The constant C is selected such that the density integrates to
unity. Constructing the inﬁnite summation as a limit suggests
that scaling of C cc ,u. is appropriate. In the limit 02 —> 0, the
density f(x) can be approximated (disregarding the scale) by the
following:

2
_(x—ku)) (3)

202/w

= M
goo ./27102/w exp(

For n independent and identically distributed samples, the ap-
proximate likelihood H?=1g(x,) will be maximized when the
squared coefﬁcient of variation 02/112 is minimized. This can
be found by ﬁnding the roots of the partial derivatives of the
function and verifying that they are maxima, yielding the follow-

ing estimators:
Z”
M —

_(x—K(x) 102) (4)

202/w

= 2:21 Wi K00) Xi (5)
62=%Zw.(x1—K(xim>2 (6)
i=1

The K(x) that minimizes the approximation error is
K(x) = Lx/u], where [-1 denotes rounding to the nearest integer.
As K(x,)s depend on ,u., the problem is not yet solved. However,
for each choice of K(x) there is a range of associated ,u.s involved.

The problem can be solved by ﬁnding the ,u. and the likelihood
for each set of K(x), which is feasible if the values of K(x) are
small. Speciﬁcally, the solution can be computed incrementally in
(9(kn log n) time and C(11) space using a priority queue with (9(
log n) update times, where k is a bound for K(x).

For large ,u., K(x) —> 0 and the squared coefﬁcient of vari-
ation, 82/112 is around %Z?:1w,-x§/,a2. On the other hand,
for ,u. —> 0, x, — K(x,-) ,u. becomes a uniform random variable in
—%,%) and 82/112 —> %Z?=1ﬁwi. Equating the two, an upper
bound for the search can be obtained, to avoid the trivial solu-
tion of the large ,u. model. We have not yet devised any better
stopping condition than to stop the search when K(x) become
sufﬁciently large [e. g. 100 if one considers typical RNA numbers
in E.coli (Taniguchi etal., 2010)].

A similar procedure can be applied for Laplace distributed
rather than normal distributed data. The estimator for the abso-
lute deviation b is as follows:

11
b = £sz- Ixi — mom (7)
i=1
where l - | denotes the absolute value. The estimator for the lo-
cation parameter ,a is the multiplicative inverse of the wix,
weighted median of K(x,-)/x,-, which is the minimizer of the co-
efﬁcient of mean deviation b/u.

As the Laplace distribution also has a density that is symmet-
ric about the mode and decreases away from it, the K(x)
that minimizes the approximation error is as in the LSQ case.
The asymptotic behavior for ,u. —>A0 is that b/p. —> %Z?Z1 ﬁwi,
and for large ,u., the statistic b/u approaches a value of
£ZL1 w, Ixil/u, which can again be used to obtain an upper
bound for the search.

3.4 Quantization

The procedure of obtaining a ﬁt curve with quantization, which
is the third step in our method, depends on the choice of the error
metric. In the case of squared error metric, a ﬁt signal with
quantization can be obtained from the ﬁt performed without
quantization. This is possible, as for a’(x, y)=(x— y)2 and
some Q(,u.):

b b
26106;»Q(M))=Zd(Xi,M)+d(M,Q(M)) (8)

i=a i=a

if ,u. is a minimizer of Ziga a’(x,-, ,a). The minimizer of a’(,u., Q(,u.))
is Q(,u.) = Lit/q] q, where q is the chosen quantization level, i.e. in
the LSQ case, quantization can be performed by rounding the ﬁt
signal to the nearest multiple of the estimated jump size.

The same does not hold for the absolute error metric. For
ﬁnding the quantized result, we use the curve ﬁtting procedure
again with an additional constraint, which imposes the
quantization.

4 RESULTS

4.1 Monte Carlo simulations

We performed Monte Carlo simulations with various parameters
of a general simple model of appearance of molecules inside cells.

 

71

1e /310's113umo [p.IOJXO'SOilBIIHOJUIOIQ/ﬁdllq 11101; popeoplmoq

9IOZ ‘09 lsnﬁnv uo ::

A.Hakkinen and A.S.Ribeiro

 

In this model, molecules are generated with some intervals,
whose durations are exponentially distributed. For reasons
described in the methods, no degradation is modeled. Finally,
the molecule numbers are corrupted by adding zero-mean inde-
pendent and identically normal distributed noise.

First, we generated the true curves using exponentially distrib-
uted production intervals with a rate of (15min)_1 and then
corrupted them by adding normally distributed noise with a co-
efﬁcient of variation of 011—1 of 0.5, l or 2. A total of 100 series
were used for analysis in each case, which was performed using
the LSQ estimator. Figure 1 shows example time series that were
generated by sampling every 10s for 2h. For quantifying the
performance of the method, we estimated its accuracy, i.e. the
proportion of correct RNA estimates in all estimates. The mea-
sured accuracies from each simulation were 0.992, 0.965 and
0.880 for 011—1 of 0.5, l and 2, respectively. In this setting, the
accuracy remains good even for moderate noise levels, such as
for 011—1 =2, despite the fact that the jump size estimator was
derived in the zero-noise limit assumption.

Next, in Figure 2, we show the results of testing for sampling
frequency of (1min)_1 with noise level of oa_1=l and using
both the LSQ and LD estimators. In addition, samples were
zeroed independently with a 25% probability to corrupt the
data further (bottom case in Fig. 2), so as to test the resistance
of the LD estimator to ‘holes’ (for reference, the LSQ estimator
breaks around 1% of zeros in this case). Other parameters were
as speciﬁed in the previous paragraph. The measured accuracies
were 0.834, 0.808 and 0.621, for LSQ and LD without zeroing,
and LD with zeroing, respectively. In these cases, the perform-
ance is worse, as less data are provided to the method, but the
results remain likely useful.

Next we quantiﬁed the accuracies for the LSQ method using
1000 independent simulations. We used two sampling settings
(10s and lmin intervals for a duration of 2h) and exponential
production intervals with a rate of (15min )_1. For the tests,
various noise levels 011—1 and number of series were used. In
addition to the LSQ method, we computed an upper bound for
the accuracy of any method that uses only the intensity values and
no temporal information—this represents a comparison with a

35-

 

noisy series
ﬁt series with quantization

    
   

(A)
O
I

 

N
01
I

N
O

_\
O

 

intensity (quanta)
a

LSQ, 6:1
LSQ, 0:0.5

0 20 40 6O 80 100 120
time (min)

01
I

 

 

-5

Fig. 1. Example results of the LSQ method with 100 series (ﬁrst of which
is shown) with a duration of 2 h and sampled every 10 s, for various noise
levels. The series were generated using a jump size of p. = 1 and expo-
nential intervals with a rate of (15 min)—1

previous method proposed in Hakkinen etal. (2014). The results
for the 10 s sampling intervals are shown in Figure 3 and for l min
sampling interval are shown in Figure 4.

For 10 s sampling interval, the accuracy remains high (>0.8)
for noise levels up to Git—122.5 for large number of series
(> 100), or up to 011—1 =2 for smaller numbers (10). Using
>1000 series provides no signiﬁcant improvement in accuracy.
For lower noise levels, the accuracy is generally high, regardless
of the number of series. In this setting, the performance of a non-
time series (non-ts) method is not comparable, as the noise levels
are high and the vast amount of temporal information available
is neglected.

The results for 1min sampling interval exhibit less differences
between the two methods in our setting. The accuracy remains
high (>0.8) for noise levels up to 011—1 for large number of series
(>100) and up to 011—1 = 0.75 for small numbers (10). The ﬁgure
also shows that around 100 samples are sufﬁcient, and even
smaller sample sizes can be used for lower noise levels, in this
setting. For high noise levels, both methods are likely to perform
poorly, whereas for small noise levels, both methods work well.
Importantly, the new method is advantageous for moderate
noise levels.

We also varied other parameters, such as the shape of the
production interval distribution. Changing the production inter-
val to a more noisy distribution (e.g. gamma distribution with
shape parameter <l) results in reduced accuracy, whereas chan-
ging it to a lesser noisy distribution results in improved accuracy.
Similarly, using the LD classiﬁer for data generated using a
model with normal errors results in slightly reduced accuracy
when compared with the LSQ method.

Finally, we tested the performance of using our method in
estimating the production interval distribution from the results
of the ﬁt. For comparison, we also present results using a previ-
ous method (Kandhavelu etal., 2012b). The goodness was as-
sessed by computing the Kullback—Leibler divergence of the true
distribution from that of the intervals extracted after applying
one of the methods—this is the criterion minimized by a

35-

 

- - - true series LSQ, no zeros l
noisy series

fit series with quantization I

(A)
O

 

 

 

 

N
01
I
I

 

,

    
  

N
O
I

I

LD 25% zeros

 
   

intensity (quanta)

,___I

 

 

o 20 4'0 60 so 150 150

time (min)
Fig. 2. Different methods tested on 100 series (ﬁrst of which is shown),
each with a duration of 2h, sampled every 1min. The series were gener-
ated using a jump size of p. = 1, noise level of o = 1 and exponential
intervals with a rate of (15min)_1. In the bottom series, a sample is
independently zeroed with a probability of 0.25. Most of the time, the
true series is covered by the equal ﬁt one

 

72

112 /810's113u1no [p.IOJXO'SOilBIIHOJUIOIQ/ﬁdllq 11101; popeoplmoq

9IOZ ‘09 lsnﬁnv uo ::

Estimation of RNA numbers from temporal data

 

1000

 

01

O

O
I

0.9

0.8

N
O
O

0.7

_l

O

O
I

0.6

O1
0
I

0.5

N
0

number of series

0.4

_\
O
I

0.3

 

5C.
4 0.2

0.1

2:32) non—ts upper bound

 

 

noise a u_1

Fig. 3. Mean accuracy of the LSQ method applied to each of 1000 Monte
Carlo simulations and the corresponding upper bound for a non-time
series type method as a function of the noise 011—1 and the number of
series. The plot was obtained with exponentially distributed production
intervals with a rate of (1 5 min)‘1 for a duration of 2 h sampled every 10 s

1000

 

 

 

    

 

I
I
500 - I 0.9
I
l 0.8
200 - I
' 0.7
100 - i
V)
.g I 0.6
3 50 - i
"5 ' 0.5
g  I
' I
g I 0.4
C
10 - -
I : 0.3
5 ' a; 
 2?") 0.2
I I
2 O LSQ 0.1
$133} non—ts upper bound
1 - - - - o
0.25 0.5 0.75 1 1.25 1.5
noise 6 11—1

Fig. 4. Mean accuracy of the LSQ method applied to each of 1000 Monte
Carlo simulations and the corresponding upper bound for a non-time
series type method as a function of the noise 011—1 and the number of
series. The plot was obtained with exponentially distributed production
intervals with a rate of (15min)_1 for a duration of 2h sampled every
1 min

maximum likelihood estimator. The divergence was computed
using a parametric method.

For this, we ﬁrst varied the shape and mean of the production
interval distribution. This was done by using gamma distributed
production intervals, with shape or e {0.5, 1,2}, where or = 1
yields an exponential distribution, and or<l and or>l yield
less and more noisy distributions, respectively. The mean dur-
ation of the production interval was varied in the range 5‘1 e
[1, 100] min. For each simulation, 100 series were generated for
the duration of 2h with sampling intervals of 1min and noise
level of GILL—120.5, and the results were averaged from 1000
simulations. The results for this case are shown in the upper
panel of Figure 5. Next, we varied the noise 011—1 e [0.1, l] of
the intensities along with the shape of the production interval
distribution with a constant mean production rate of

 

 

 

 

 

 

 

 

 

 

 

 

 

:3

E

g LSQ

E 10° old method -

.é

CD

0

C

8 -2

5 1O -

.2

'U

_l I

Q 10° 101 1o2
expected production interval [3‘1 (min)

é 10° — LSQ I I I

a old method @495

E —1 cud

Q 10 w WWW

8 A

8 _2 WU

E)  '

U 10'3

_l I I I I I I I I

g 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

noise 6 [1

Fig. 5. Kullback—Leibler divergence estimated from 1000 Monte Carlo
simulations for estimating the parameters of the interval distribution, as a
function of mean production rate ,8‘1 (upper panel) and as a function of
intensity noise 011—1 (lower panel). The results were obtained with gamma
distributed production intervals with shapes of or e {0.5, 1, 2}, for a dur-
ation of 2h sampled every 1min. Unless otherwise speciﬁed, the mean
production rate is ,8‘1 = 15 min and the noise is 011—1 =0.5

5‘1 = 15 min. All other parameters were as speciﬁed in the previ-
ous case. These results are shown in the lower panel of Figure 5.

The results in Figure 5 suggest that, generally, the new method
outperforms the previous method. The previous method was
found to perform better with speciﬁc parameter ranges, particu-
larly for more deterministic (or = 2) production intervals, likely
owing to tighter regularization. As expected, higher variance in
the production interval results in reduced performance in all
cases. Similarly, short or long production intervals result in
reduced performance, as in the former case, both methods
suffer from poor time resolution and in the latter from lack of
observed intervals. In the case of low noise 011—1 in the intensi-
ties, both methods have similar performance; however, the per-
formance of the new method is superior for moderate to high
noise levels.

4.2 Statistics of tagged RNA numbers and intervals

Finally, we used our method to estimate statistics related to the
production of MS2-GFP—tagged RNA molecules in live E.coli
cells from time-lapse images obtained by confocal microscopy
(see Section 2). Each cell contains one lac/ara—l promoter ex-
pressing the target RNA, which consists of 96 binding sites for
the MS2-GFP for visualization, preceded by a sequence coding
for mRFP (see upper panel of Fig. 6). Target and reporter genes
were induced as described in the methods, and images were taken
60 min after induction, sampled every 1 min for a duration of 2 h.
The image analysis procedure (see Section 2.3) of three independ-
ent experiments performed in the same conditions produced 503
cells with a total of 24 466 intensity samples.

For comparison, we also used the two previous methods used
in the previous section. The ﬁrst, proposed in Hakkinen etal.
(2014), does not use the temporal information as our method
does. Consequently, we expected it to yield less accurate results,
as suggested by results on the Monte Carlo simulations shown in
the previous section. The other previous method was proposed

 

73

112 /810's112u1no [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

A.Hakkinen and A.S.Ribeiro

 

     

 

 

 

 

 

 

 

 

3 intensity _
A LD 5 as a_t_ :  .
2 I u I I n I u non—ts m.  El;  :i': In
E 2 old method I: i' if" I. I“ = :3'_:
g I_ ' I :I I: :55 '5 '
.s :5

'-I:
O I 1: I I I I I
20 40 60 80 100 120
time (min)

Fig. 6. Upper panel: Regions of confocal microscope images at 1, 34 and
61 min after starting the imaging. Lower panel: example intensity series
and ﬁt curves using the LD method and the two previous methods. The
curves are shown in the space of RNA numbers estimated by the LD
method; corresponding RNA numbers using the old method are shown
on the right. The centermost cell of the images in the upper panel cor-
responds to that shown in the lower

and ﬁrst used in Kandhavelu etal. (2012b). Again, based on the
results from the previous section, we expect our method to be
slightly more accurate than this method.

An example of a time series of cell ﬂuorescence intensities ex-
tracted from the microscopy data is shown in the lower panel of
Figure 6. The RNA curves ﬁt using each of the three methods for
the example series are also shown. Visibly, the intensity time
series contains moderate amount of noise and occasional samples
with small values (cf. the bottom curve in Fig. 2). Because of the
latter observation, we opted to use the LD variant for the
analysis.

The ﬁt curves in the lower panel of Figure 6 exemplify how the
three methods operate using different strategies. Without any
pre- or post-processing, the non-ts method seems ill-suited.
Also, the example shows how the LD method is regularized in
intensity space and the previous method in temporal space.
Nevertheless, the results from the two methods tend to generally
agree with each other—both insert RNA productions when large
increases in the intensity series occur.

We compared the values of RNA numbers extracted using the
three methods from the data of the experiments. For the pur-
poses of comparison, we extracted the RNA numbers averaged
over each cell and each point in time. As these numbers appeared
to be similar, we performed a Kolmogorov—Smirnov (K-S) test
to assess whether the RNA numbers extracted using either of the
previous methods differ from that of our LD method, in a stat-
istical sense. In this test, the null hypothesis is that the two sets of
data are generated from an equal distribution, and the alternative
hypothesis is that the distributions are unequal. As the data are
discrete and possibly correlated over time, the test was performed
by permuting the series (rather than individual samples) for a
total of 106 times. The results are summarized in Table 1.

For the obtained time series of intensities, we also extracted
the RNA production intervals using both our LD method and
the previous method designed for production interval extraction
(Kandhavelu et al., 2012b). The mean and the squared coefﬁcient
of variation of the extracted intervals are shown in Table 2.

Table 1. Statistics of RNA numbers

 

 

Method Cells Samples Mean K-S P—value
LD 503 24466 1.43 N/A

Non-ts method -”- -”- 1.49 2.0 x 10—5
Old method   1.44 2.8 x 10—4

 

Notes: The table lists the number of cells, number of RNA samples, mean RNA
numbers and P-value of the K-S test when comparing with the LD method.

Table 2. Statistics of time intervals between RNA productions

 

 

Method Intervals Mean (min) Squared-CV K-S P—value
LD 373 15.42 0.82 N/A
Old method 344 16.09 0.52 2.1 X 10-4

 

Notes: The table lists the number, mean, and squared coefﬁcient of variation
(squared-CV) of the extracted intervals, and the P-value of the K-S test when
comparing to the LD method.

Also, a K-S test was performed to assess the statistical signiﬁ-
cance of the differences between the interval distributions.

In summary, the three methods extracted similar but statistic-
ally distinct RNA numbers and durations between the produc-
tions of consecutive RNA molecules from the data. Also, in all
cases, the results agree with those reported in Kandhavelu etal.
(2012a). In particular, while the mean numbers these quantities
appear similar, the K—S tests were able to detect signiﬁcant dif-
ferences at the level of resolution of the measurements. This,
along with the evidence presented in the previous section, sug-
gests that our method offers signiﬁcant improvements over the
methods previously used for such studies. Interestingly, the re-
sults using the LD method suggest slightly noisier shape of the
distribution than previously reported (Kandhavelu et al., 2012a).
This is likely to be of relevance to studies of the mechanisms
underlying transcription in live cells. Further, might suggest
that our new method produces more accurate results by avoiding
the regularization in the temporal domain.

5 DISCUSSION

We have presented two variants of a novel, more accurate
method for the automatic quantiﬁcation of RNA numbers and
RNA production intervals from intensity time series extracted
from images of live cells expressing ﬂuorescently tagged RNA
molecules. The new method exploits the temporal information in
the data for improved accuracy, does not require post- and/or
pre-processing for time interval extraction and has no regular-
ization in the temporal domain.

One of the proposed variants uses LSQ costs, which can be
derived using the central limit theorem. The other uses LD costs,
which is a robust variant of the former, and is to be used when
there is potential for outliers (e.g. spots transiently leaving the
focal plane of the microscope). Meanwhile, the former is pre-
ferred when no such corruption is present (e. g. if using multiple
slices along the z—axis at each time point).

 

74

112 /810's112u1no IpJOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Estimation of RNA numbers from temporal data

 

We used Monte Carlo simulations to demonstrate that the
accuracy of the new methods is, in general, superior to that of
our two previously proposed methods (Hakkinen etal., 2014;
Kandhavelu etal., 2012b), both in estimating the RNA numbers
and the RNA production intervals. We also applied the new and
the previous methods on novel data from time-lapse images of
live E.coli cells expressing RNA target for MS2-GFP to show
that, if the data contains large number of cells, statistically sig-
niﬁcant differences in the results can be detected, in both the
RNA numbers and RNA production time intervals. In this
regard, it should be noted that such ‘large’ numbers of cells are
required to, e. g. compare changes in the dynamics of RNA pro-
duction by a promoter when under different temperatures or
levels of induction (Kandhavelu etal., 2012a; Makela etal.,
2013).

Currently, MS2-GFP-tagging of RNA molecules is the only
existing method for detecting RNA molecules, as they are pro-
duced in live cells. An accurate quantiﬁcation of the copy num-
bers of these tagged RNA molecules and determination of the
moments when they ﬁrst appear are essential, particularly in
studies of the dynamics of transcription in live cells [see e.g.
Muthukrishnan etal. (2012)]. Such measurements are currently
being used to assess, for example, the role of induction and re-
pression mechanisms in regulating gene expression dynamics or
the effects of environmental factors such as temperature on this
dynamics. However, detection and quantiﬁcation of individual,
tagged RNA molecules, and thus our method, are valuable to
other endeavors as well. For example, recent uses of the counting
of such molecules as they appear in cells include a study of the
dynamics of small genetic circuits (Chandraseelan etal., 2013)
and a study of errors in the partitioning of RNA molecules in
cell division (Lloyd-Price etal., 2012).

The two variants of the method proposed here should prove
valuable in increasing the accuracy of these, as well as of other
studies making use of ﬂuorescent molecules, provided that the
ﬂuorescent molecules exist in small numbers in each cell, that
their ﬂuorescence is signiﬁcantly above the background ﬂuores-
cence and that they have a slow degradation rate when compared
with dilution caused by cell division.

Funding: Work supported by Jenny and Antti Wihuri
Foundation [to A.H.]; Academy of Finland [257603 to A.S.R.];
Tekes [40226/12 to A.S.R.]; and Fundacao para a Ciencia e
Tecnologia [PTDC/BBB-MET/ 1084/2012 to A.S.R.].

Conﬂict of interest: none declared.

REFERENCES

Chandraseelan,J.G. et al. (2013) Temperature dependence of the LacI-TetR-CI
repressilator. Mal. Biosyst, 9, 3117—3123.

Elowitz,M.B. et al. (2002) Stochastic gene expression in a single cell. Science, 297,
1 183—1186.

Golding,I. and Cox,E.C. (2004) RNA dynamics in live Escherichia coli cells. Proc.
Natl Acad. Sci. USA, 101, 11310—11315.

Golding,I. et al. (2005) Real-time kinetics of gene activity in individual bacteria.
Cell, 123, 1025—1036.

Hakkinen,A. et al. (2014) Estimation of ﬂuorescence-tagged RNA numbers from
spot intensities. Bioinformatics, 30, 1146—1153.

Huh,D. and Paulsson,J. (2011) Random partitioning of molecules at cell division.
Proc. Natl Acad. Sci. USA, 108, 15004—15009.

Kaem,M. et al. (2005) Stochasticity in gene expression: From theories to pheno-
types. Nat. Rev. Genet, 6, 451—464.

Kandhavelu,M. et al. (2012a) Regulation of mean and noise of the in vivo kinetics
of transcription under the control of the lac/ara-l promoter. FEBS Lett., 586,
3870—3875.

Kandhavelu,M. et al. (2012b) Single-molecule dynamics of transcription of the lar
promoter. Phys. Biol, 9, 026004.

Lloyd-Price,J. et al. (2012) Probabilistic RNA partitioning generates transient in-
creases in the normalized variance of RNA numbers in synchronized popula-
tions of Escherichia coli. Mal. BioSyst., 8, 565—571.

Makela,J. et al. (2013) In vivo single-molecule kinetics of activation and subsequent
activity of the arabinose promoter. Nucleic Acids Res., 41, 6544—6552.

Muthukrishnan,A.-B. et al. (2012) Dynamics of transcription driven by the tetA
promoter, one event at a time, in live Escherichia coli cells. Nucleic Acids Res.,
40, 8472—8483.

Ozbudak,E.M. et al. (2002) Regulation of noise in the expression of a single gene.
Nat. Genet, 31, 69—73.

Pedraza,J.M. and van Oudenaarden,A. (2005) Noise propagation in gene networks.
Science, 307, 1965—1969.

Taniguchi,Y. et al. (2010) Quantifying E. coli proteome and transcriptome with
single-molecule sensitivity in single cells. Science, 329, 533—538.

Yu,J. et al. (2006) Probing gene expression in live cells, one protein molecule at a
time. Science, 311, 1600—1603.

 

75

112 /810's112u1no IpJOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

