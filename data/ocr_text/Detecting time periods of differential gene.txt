Bioinformatics, 31 (5), 2015, 728—735

doi: 10.1093/bioinformatics/btu699

Advance Access Publication Date: 28 October 2014
Original Paper

 

Systems biology

Detecting time periods of differential gene
expression using Gaussian processes: an
application to endothelial cells exposed to
radiotherapy dose fraction

Markus Heinonen1'2'*, Olivier Guipaud3, Fabien Milliat3, Valérie Buard3,
Béatrice Micheau3, Georges Tarlet3, Marc Benderitter3, Farida Zehraoui1
and Florence d’Alché-Buc1'2*

1IBISC, Universite d'ery Val d'Essonne, 23 Boulevard de France, 91025 ery, France, 2AMIB, lNRlA-Saclay, LRI
UMR CNRS 8623, Université Paris Sud, Orsay, France, and 3Institut de Radioprotection et de SOreté Nucléaire,
LRTE, 92262 Fontenay-aux-roses, France

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on March 20, 2014; revised on September 29, 2014; accepted on October 17, 2014

Abstract

Motivation: Identifying the set of genes differentially expressed along time is an important task in
two—sample time course experiments. Furthermore, estimating at which time periods the differen—
tial expression is present can provide additional insight into temporal gene functions. The current
differential detection methods are designed to detect difference along observation time intervals or
on single measurement points, warranting dense measurements along time to characterize the full
temporal differential expression patterns.

Results: We propose a novel Bayesian likelihood ratio test to estimate the differential expression
time periods. Applying the ratio test to systems of genes provides the temporal response timings
and durations of gene expression to a biological condition. We introduce a novel non—stationary
Gaussian process as the underlying expression model, with major improvements on model fitness
on perturbation and stress experiments. The method is robust to uneven or sparse measurements
along time. We assess the performance of the method on realistically simulated dataset and com—
pare against state—of—the—art methods. We additionally apply the method to the analysis of primary
human endothelial cells under an ionizing radiation stress to study the transcriptional perturbations
over 283 measured genes in an attempt to better understand the role of endothelium in both nor—
mal and cancer tissues during radiotherapy. As a result, using the cascade of differential expres—
sion periods, domain literature and gene enrichment analysis, we gain insights into the dynamic
response of endothelial cells to irradiation.

Availability and implementation: R package ‘nsgp’ is available at \MNW.ibisc.fr/en/logiciels_arobas
Contact: markus.heinonen@ibisc.fr or florence.dalche@ibisc.fr

Supplementary information: Supplementary data are available at Bioinformatics online.

 

©The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

 

112 /§JO'S{eumo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting time periods of differential gene expression

729

 

1 Introduction

With the advent of high—throughput measurement technologies,
large—scale systems biology experiments are now routinely
performed. The first step towards understanding the system—level
responses is determining the genes that are differentially expressed
across samples obtained from two (Kerr et 61]., 2000; Dudoit
et 61]., 2002) or multiple biological conditions (Kendziorski et 61].,
2003), which is usually performed over static microarray
measurements.

However, time—series measurements of the transcriptomic state
of the cells are necessary to reveal additional information of the in-
herently dynamic regulation and function of the cells. Several differ—
ential expression methods have been designed for time series data,
with majority of them testing whether the two—sample time—series
are differential throughout the whole time course (Bar—Josephs
et 61]., 2003; Conesa et 61]., 2006; Kalaitzis and Lawrence, 2011;
Storey et 61]., 2005; Tai et 61]., 2006). In this article, we focus on the
currently overlooked task of determining when genes are differen-
tially expressed from time series experiments under two—sample set—
ting (e.g. control and case).

Both Bayesian and frequentist statistical tests have been pro—
posed for time series data (Stegle et 61]., 2010; Storey et 61]., 2005;
Tai et 61]., 2006). In the Bayesian approach, a Bayes factor between a
null hypothesis—assuming no differential expression—and a differ—
ential hypothesis is often approximated by computing the likelihood
ratios of the observed data against the competing hypotheses
(Angelini et al., 2007). In the differential hypothesis, separate time—
series models are learned for both biological conditions, while in the
null hypothesis a single model explains both samples. A difference is
declared if the two time—series can be explained more confidently
using separate differential models compared to a single null model.
These approaches have been applied to testing whole time series to
determine if a gene is differentially expressed or not.

Stegle et al. (2010) introduced the first test for estimating differ-
ential expression separately for individual observation times to pro—
duce time intervals of differential expression. A time period between
two neighboring and differential measured time—points is assumed
to be differential as well. This allows characterizing the starting and
ending times of the differential expression, providing for a temporal
characterisation of the underlying biological processes. The time
periods are restricted to start and end at an observed time point.
However, in the case of sparse or uneven observation times, it is
highly desirable to be able to estimate differential expression accur—
ately between measured timepoints, producing a continuous esti—
mate of the differential expression time periods. In this article, we
extend the approach of Stegle et al. (2010) by introducing a method
for unconstrained detection of differentially expressed time periods,
which need not to contain measured timepoints. We propose two
likelihood ratio tests that measure the expected data likelihood in—
stead of the observed data likelihood. These can be evaluated natur—
ally over probabilistic underlying expression models.

We consider the Gaussian process regression (GPR) models,
which have been commonly applied to model time course gene ex—
pression (Schliep et 61]., 2005; Lawrence et 61]., 2007), and are an apt
model for likelihood ratio estimation (Stegle et 61]., 2010). GPR
models are a flexible class of non—parametric Bayesian models,
which quantify the uncertainty of the underlying process estimates
using Gaussian distributions (Rasmussen and Williams, 2006). GPR
models of temporal gene expression have been extended with
outlier detection (Cooke et 61]., 2011), hierarchical replicate models
and clustering (Hensman et 61]., 2013), bootstrapping (Kirk and

Stumpf, 2009) and with ordinary differential equation (ODE) model
integrations (Aijo and Lahdesmaki, 2009; Gao et 61]., 2008). GPR
models naturally support replicate measurements (Stegle et 61].,
2010), missing values and sparse observation times.

An important particularity of many gene expression measure—
ments is that they are generally obtained from a perturbation of the
basal system under study. As other non—parametric models, GPRs
based on time—invariant parameters are not appropriate to model
kinetics in response to a perturbation. To improve the accuracy of
the modeling, we consider non—stationary Gaussian processes
(Paciorek and Schervish, 2004), that is, GPR models that do not as—
sume time—invariance. Hence, ideal to perturbation experiments,
they can model the early and late perturbation responses by varying
the model smoothness. We introduce a non—stationary Gaussian ker—
nel, where the kernel variance is restricted to a logarithmic function
of time, which is directly learned from the data.

We consider a human endothelial cell irradiation response ex-
periment to elucidate gene expression inhibitions and activations in
the irradiated cells. Irradiation is an important class of stress to
endothelial cells for both normal tissues and tumors during radio—
therapy. Perturbation of the endothelial system by ionizing radi-
ation, which remains mostly unknown, has important consequences
on the radiosensitivity of both normal and cancer tissues. It is, there—
fore, of major importance to better understanding the biological
consequences of exposure to ionizing radiation, and particularly to
decipher the network perturbations that lead to a pathological
phenotype of the cells. We assess the method against a realistical
simulated gene expression time—series, and apply the novel ratios to
the analysis of human umbilical vein endothelial cells (HUVEC)
under a realistic radiotherapy dose fraction (2 Gy) against a control
cell population. As a direct result of the method over this large—scale
gene system, an insightful cascade of differential expression time
periods of the observed genes emerges.

Below, we present a non—stationary Gaussian process model in
Section 2, and introduce a non—stationary Gaussian kernel and two
novel likelihood ratios in its subsections. In Section 3, we evaluate
the method against a simulated dataset and apply it to study the
large—scale dynamic genetic response to irradiation. We conclude in
section 4.

2 Methods

We present a two—phase method for detection of differential time
periods of two—sample time—series observations. We fit Gaussian
process models on the biological conditions of each gene, and then
proceed to compare the likelihood ratios of these GP—models along
time domain. The method is demonstrated on gene expression time—
series dataset with replicates and uneven observation times, but is
readily applicable to any kind of quantitative biological time—series
data, e.g. RNA or protein concentrations at even or uneven observa—
tion times, assuming Gaussian noise.

2.1 Overview of Gaussian process model

First, we construct smooth probabilistic models of the measured
gene expression trajectories over time from point measurements
using Gaussian processes. We model each gene expression time—
series using an independent model. Let y: (yt1,...,ytN) E [RN
be the vector of N noisy gene expression measurements 3/, E R at
input time points TobS : (t1,...,tN) E [Rf of a single gene. We
assume R replicate measurements and denote the r’th replicate

112 /§.IO'S[BU.IT10[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

730

M. Heinonen et al.

 

measurement as y’. We assume that a true model f(t) explains the
observations through

Yt=f(t)+8t

under some Gaussian isotropic and time—dependent noise model
81: NN(0,co%). We collect the time—dependent noise variances
(oi, . . . ,cogN into a diagonal covariance matrix Q.

GPR is a Bayesian non—parametric and non-linear method for
regression. A Gaussian process is a generalization of distributions
to functions, where any subset of function evaluations is jointly
Gaussian (Rasmussen and Williams, 2006). A Gaussian process
f, N Q’P(,u*,2*) represents a distribution over function samples
f, : (f(t1), . . . ,f(tN*)) at time points T : (t1, . . .,tN*) E [REM
through the mean vector u, E [REM and the covariance matrix
2 E RN*XN*.

According to the GPR modeling, we determine the function class
by placing a Gaussian prior

f~ N(0,KTT)

over the true model f(t), where KTT is a covariance, or more gener—
ally, a positive semi—definite kernel matrix between time points
T01,S >< Tobs. We are interested in learning the Gaussian process given
the data y and the function prior, which results in a ‘posterior’ distri-
bution f*|y N N (11*, 2*) defined by

m = *T(KTT + Q)_1Y
2* Z ** — *T(KTT ‘l‘ Q)—1KT*7

where Kg" : Kg, is the kernel K over T1 >< Tobs.

The posterior of the true model can be visualized by the mean
model it, along with 95% confidence intervals :1.96(/diag2*.
However, if we are interested in sampling from the
estimated model with observational noise Q, we use the distribu—
tion y, E y*|f* NN(,u*,Z* +9) as the complete noisy kinetic
model of the gene expression (Kirk and Stumpf, 2009) (Fig. 1).

2.2 Non—stationary Gaussian kernel

The kernel choice K (t, t’) plays an important role in determining the
function space learned by the Gaussian process. The Gaussian kernel
K(t, t’) = exp (—||t — t’||2/2€2) is often used as a ‘default’ kernel due
to its universality. It naturally gives high covariance for close time
points, resulting in smooth regression models. However, the
Gaussian kernel is a function of t — t’, and hence ‘stationary’. In

GPR model of gene ADHEH

 

Value
—a.5 —3.0 —2.5

—4.|3|

 

—4.5

 

 

 

GI
[.11
.4
I:
_I.
U'l
M
D

Time

Fig. 1. Gaussian process posterior f, over the gene ADRB1 measurements
(dots). The shaded region indicates the 95% confidence interval )2, of the
underlying function, while the dashed line includes also the observational
noise model with 2,+Q. The black line indicates the learned length scale
function [(t) on the right y-axis

perturbation experiments, the cell’s response is time—variant: the per—
turbation often subjects the cell’s state to rapid changes, while the
cells are reaching a more stable state. Perturbation experiments war—
rant ‘non—stationary’ covariance models. Non—stationary kernels for
GPR were introduced by Gibbs (1997), while Paciorek and
Schervish (2004) give a generalized construction for non—stationary
version of kernels, where input values are associated with individual
variances 0%, with the drawback of high computational costs and
non—analytical derivatives of model learning.

We introduce a non—stationary Gaussian kernel. Adding non—sta—
tionarity allows varying smoothness along time, while retaining the
favorable properties of the Gaussian kernel. A standard Gaussian
kernel K(t, t’) = (@(t), @(t’ admits an feature expansion, which
implies a feature map over tuples ¢(t, E):

00

2 2 k
—:—,> %He 2 am).

me) = exp( ,3,

An inner product between the feature maps ¢(t, €(t)) and ¢(t’ , €(t’
results in a non—stationary Gaussian kernel

, t t’ 2
Kg(t,t) : 0%exp <  >, (1)

where the 0'2 is the kernel variance, and we, further, restrict the ker—
nel by defining a length scale function following a logarithmic
function

€(t) = a = e — (e — an... )e—Ct,

controlled by three hyperparameters: maximum lengthscale E, min-
imum lengthscale Emin (at time t: 0), and the curvature 6 controls
how fast the function €(t) approaches its maximum value. We as—
sume that the data is normalized such that perturbation occurs at
time 0. The kernel of Equation 1 remains analytically differentiable.

We note a simple alternative approach of achieving non-
stationarity by applying a log transformation over the time domain.
We compare the performance of the log—transformation to the non-
stationary kernel in Section 3.2.

2.3 Model inference

The GPR framework provides a natural way to learn the hyperpara—
meters 0 = (of, E, Emin ,c) of the kernel Kg. In a Bayesian model infer-
ence, we would marginalize over the hyperparameters and the models
implied by them. Due to computational tractability, we instead learn
hyperparameters against the marginal log likelihood (MLL)

log pelt, 0) = log (Mylf, T)P(f|0)df <2)

which follows y N N(0, KTT —l— Q) giving a log likelihood
— %yT(KTT —l— Q)_1y — %log|KTT —1— 9| — ¥log2m We optimize the
parameters 0 by gradient descent over Equation 2 with L—BFGS. The
noise model can be learned against the MLL (Rasmussen and
Williams, 2006), which, however, leads to intractable inference if a
varying noise model is considered. To avoid intractability, we prede—
fine the time—dependent noise model Q : diag(co%1, . . . ,cogm) for
each gene separately by interpolating the empirical replicate vari-
ances Var((y;) :1) using standard spline interpolant.

2.4 Framework for detection of differential time periods

Next, we are concerned with determining at which time periods two
gene profiles yA and yB are exhibiting significant differential expres-
sion under different biological conditions (e.g. case and control).

112 /§.IO'S[BU.IT10[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting time periods of differential gene expression

731

 

The standard statistical test is to compare the two independent prob—
abilistic models HA and HB fitted to time series y"‘ and yB independ—
ently, against a joint probabilistic model HS fitted to pooled data
yS : (yA;yB) (Storey et al., 2005; Stegle et al., 2010). These two
cases correspond to a differential expression hypotheses (I) and to a
null hypothesis (S), respectively.

In a Bayesian approach the Bayes factor score between the
hypotheses is thresholded (Stegle et al., 2010; Yuan, 2006; Angelini
et al., 2007). It can be approximated by evaluating the MLL ratio

Aneé" Base”
SMLL(TobS|yA,yB) :  l b  b )
p(ySlTobsae )

where the three models are learned independently for the datasets

 

(3)

21:, y]; and 3:5 respectively, resulting in optimal hyper parameters
0 , 0 and 0 . The evaluation of the MLL ratio of Equation 3 is
done against the observed data y or its subsets over the correspond—
ing time points. In particular, the MLL ratio can provide a single
likelihood ratio for differential expression of the whole time course
or ratios for each observed individual time point (Fig. 2a).

Given sparse observations, we would like to be able to evaluate
the likelihood at arbitrary time points {t1}. We propose two novel
likelihood ratio tests that can be evaluated at any time points: (i) the
expected MLL ratio and (ii) the noisy posterior concentration (NPC)
ratio. By evaluating them along time, we construct a smooth ratio
curve indicating the precise time periods of differential expression
according to a predefined threshold (Fig. 2).

2.4.1 Expected likelihood ratio test
A simple extension to the likelihood ratio is to evaluate the MLL
against a sample  drawn from the noisy posterior distribution y,
(Kirk and Stumpf, 2009). The sample values y,- are invariant of the
measurement points and can be estimated to arbitrary temporal
precision. The sample MLL converges into an ‘expected’ marginal
likelihood [Eewy*p(y|T*, 0), which follows a Gaussian N (11*, 2,—1— K1,
+29) (See Supplementary data, Fig. 2b).

We propose the ratio of expected marginal log likelihood
(EMLL)

 

A AA A AB
drywwa napalm >
>

A AS
[Ey*p(Y|T*7 0 )

 

SEMLL(T*IYA7 YB) = 10g (4)

analogously to Equation 3. The EMLL approach can be interpreted
as replacing the measured data with the expected data )1, generated
from our estimated noisy posterior model y*. The model uncertain—
ties include the covariance term KH —I— Q from the prior, as well as,
the noisy posterior covariance 2* —1— Q.

Gene ARM with HILL ratio

 

nge AZH with NPC ratio

2.4.2 NPC test
An alternative for the likelihood ratio of Equation 3 is to quantify
the difference of concentrations of the noisy posterior distributions
(yf, yf) and y: under the independent (I) and shared (S) hypotheses.
A concentration is proportional to the inverse of the variance and
measures the certainty of the GPR model of the underlying gene ex-
pression. We expect that for differential genes, the two independent
models attain smaller variances, than the joint model learned on
shared data.

A natural measure of distribution concentration is the expected
likelihood of its own distribution (Jebara et al., 2004)

[ErmPWle fr, fl) = (NWIMH 2* + @2613",

which follows a Gaussian N(0, 2* —1— Q) and gives a log likelihood of
—%log|2* —1— 9| and a constant term. The log odds between the ex—

pected likelihoods of independent and shared hypotheses results in
NPC score

 

A AA A AB
1 (Emulate )lEy.P(y|T*,f*,0 >
0g S

[EyyWITefeé )

 

SNPC(T*IYA7YB) = 7 (5)

where each term is — %log|2: —l— QC|, for c E {A, B, S}.

As a measure of concentration, the NPC is invariant to the distri—
bution means. The test takes into account both our confidences in
the posterior variances 0% of the function f(t) and its estimated noise
variances (of (Fig. 2b). To only compare the non—noisy posteriors,
we drop the noise terms from the ratio test of Equation 5. In biolo—
gical experiments, the measurement noise is a compound variance
between biological variance and observation error (Kirk and
Stumpf, 2009), and thus an inherent part of the model. We argue
that the noisy test is necessary to capture the underlying process
accurately.

3 Results

We evaluate the performance of the non—stationary Gaussian models
and likelihood ratios against a realistically generated simulated data—
set and conduct exploratory experiments on HUVEC under irradi-
ation. We model the gene expression using the GPR models and
estimate the time periods of differential gene expression under
irradiation.

3.1 Materials and methods
We measured transcriptional profiles of 283 genes with real time

qPCR under control and under a single irradiation dose of 2Gy
(case) at 0 h with measurements T01,S at 12h, 1, 2, 3, 4, 7, 14 and 21

(C)

Gene AIM with EMLL retie

 

 

 

 

 

 

 

 

2
ea. —r - I ——e_ fer-er L —- ref—~44.
— e” r .I II , ll , || A q . .rr _ a..___z- ——:.1 ,r I a__2- I 7..“
'I ' .
LI 3&3 _ a“ _
ﬂ *1 ‘1
w _1 n. L J  a _- {TU- a E
2 2 i
m ' - _
:3" JF—hl—l—EE— ﬂ‘l —\—_"-I-___|_|_ :1 _l  p
_3 1 // iii—'— _1   n. Ha _
e . 5 w \L ff” 9  H/ G .
r. , l l
13' 5 10 15 21] D 5 1U 15 2'3 {I 5 ll] 15 2|}
Time Time Time

Fig. 2. The three differential expression tests for (a) MLL ratio, (b) noisy posterior concentration ratio and (c) for expected MLL ratio for the gene A2M (alpha-2-

macroglobulin) under irradiation (teal) and control (red) with gray intervals indicating difference according to a log likelihood threshold of 1.0

112 /§JO'S{12umo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

732

M. Heinonen et al.

 

days. Three biological replicate cell populations were separated
from a single population just prior to experiments. GPR models are
learned for each gene under both condition over prediction time
points T1 that cover smoothly days 0 to 24. Learning a single GPR
model takes approximately 1 min on a single core of a 2013
MacBook Pro with our R implementation.

Human umbilical vascular endothelial cells from Lonza
(Verviers) were cultured in EGM—2—MV medium at 37°C with 5%
C02. Conﬂuent cells were irradiated at 2Gy at passage 3 with a
13’7Cesium source (IBL 637, CisBio; dose rate 1 Gy/min). For long
term experiments (7—21 days post—irradiation), culture medium was
changed every week.

Total RNA was prepared with the total RNA isolation kit
(Rneasy Mini Kit, Qiagen). Total RNA integrity was analysed using
Agilent 2100 and after quantification on a NanoDrop ND—1000 ap—
paratus (NanoDrop Technologies). Reverse transcription was per—
formed using the High Capacity Reverse Transcription Kit (Applied
Biosystems) according to the manufacturers instructions. Gene ex—
pression assays were performed using a panel of premade TaqMan
low density array gene Signature array (angiogenesis, inflammation,
apoptosis, immune response and protein kinase) (Applied
Biosystems). cDNA (400 ng) per sample was loaded onto the port of
each gene signature array cards and PCR was performed with the
ABI PRISM 7900 Sequence detection system (Applied Biosystems).
Analyses were performed using RQ Manager and Data Assist soft—
ware and relative mRNA quantification was performed using the
comparative AACT. Normalization was performed using a global
normalization method (Mestdagh et al., 2009), i.e. the software first
finds the common assays among all samples and the median CT of
those assays is used as the normalizer, on a per sample basis
(Mestdagh et al., 2009). Experiments were performed in triplicates
for each time points of the kinetic.

3.2 Model and ratio evaluations

We performed simulation studies with 600 simulated gene expres—
sions under two biological conditions. We reused the learned qPCR
control time—course Gaussian processes by sampling new time—
courses from them as realistic control time—series. Then, the case
perturbation is modeled as a sample from another Gaussian process,
which is only non—zero between a randomly chosen differential time
period. A sample from the perturbation model was added to the con—
trol GP mean to obtain a case GP, from which the case time—series
are replicated (See Supplementary data and Supplementary Figs. S2
and S3). We performed differential time period detection with the
EMLL-ratio using the novel non—stationary kernel, as well as with a
stationary kernel with a log—transform over the time domain to
simulate the perturbation dynamics. Finally, we compared these two
approaches to the method of Stegle et al. (2010) (GPTwoSample),
which predicts the differential expression for observed time points
only.

The method of Stegle et al. (2010) is the state—of—the—art Bayesian
method for estimating differential expression for observed time—
points. It uses the likelihood ratio test of Equation 3, instead of the
expected likelihood ratios of Equations (4) and (5). They utilize a
binary latent variable modeling the difference along observed time
points with stationary Gaussian processes as the base model, which
they learn using MCMC inference. Our method thresholds the likeli-
hood ratios directly, and learns the non—stationary models by gradi—
ent descent.

Figure 3 indicates the AUROC curves (See Supplementary Fig.
S4 for ROC curves) of the three methods on both continuous time

Time period prediction

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0. _
0°. _
O
(O
o: o' T
D.
'- V‘. _
O
N — ns—EMLLAUC 0.887
0' _  Iog—EMLLAUC 0.894
O ------ -- GPTwoSampleAUCO.771
O. _
I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0
FPR
Observed point prediction
0 _
00
O. _
(O
o: o' T
D.
'- V‘. _
O
N — ns—EMLLAUC 0.889
0' _  Iog—EMLLAUC 0.885
o ----- ~ GPTwoSampleAUCO.831
O. _
I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0
FPR

Fig. 3. True positive rate versus false positive rate over the likelihood thresh-
old on simulated dataset. Top: prediction of time-periods with EMLL test
using either non-stationary kernels or log-transform compared against the
method of Stegle et al. (2010). Bottom: prediction of observed points only (13)

period detection (121 dense points) and when estimating over
observed points (13 points). We extrapolated the results of the
GPTwoSample method by declaring a time period between two ob—
servations as differential if the observations themselves were esti—
mated to be differential. The EMLL achieves an AUC score of 0.89
against 0.77 of GPTwoSample on smooth prediction, and 0.89
against 0.83 when predicting observed points only. We note that the
method of Stegle et al. (2010) was not designed for the former task.

We evaluated the performance of the GPR model with non—sta-
tionary Gaussian kernels against a standard Gaussian on the
HUVEC dataset. A Supplementary Table 81 shows that utilising a
non—stationary Gaussian kernel improves the model MLL (Equation
2) fits by—on average—7.3 on irradiated cells and 2.3 on control
cells, on logarithmic scale. Furthermore, Supplementary Figure 81
indicates that non—stationary Gaussian kernel based model never de—
creases the model fit.

Additionally, we evaluate the EMLL ratio (Equation 4) and the
concentration ratio (Equation 5), against the MLL ratio test
(Equation 3) over the dataset. All of the tests use a comparable like—
lihood ratio, whose threshold acts as a precision—recall tradeoff,
with a higher threshold giving more confident estimates.

Figure 4 shows a global view of irradiation by counting genes
with a log ratio above a threshold 1.0 along time under the tests.
The MLL ratio is the greediest and declares between 47 and 154
genes at any of the observed time point to have differential expres—
sion, a result which likely contains numerous false positives. The
posterior concentration ratio fails due to not taking the noise model
into account, while the noisy ratio fares noticeably better. Gene
counts drop quickly around the measurement time points, implying
weak generalizability. However, learning the GPR model using an
expected MLL optimisation criteria (See Supplementary data) pro—
duces more informative models between observations, and shows
little bias toward observed points (dashed green line). We did not

112 /810'S{12umo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting time periods of differential gene expression

733

 

Differential expression by time

 

150
|

 

Expected MLL ratio
- MLL ratio
- - - - - Noisy posterior concentration ratio
---- -- Noisy posterior concentration ratio (expected model)
- - Posterior concentration ratio

125
|

 

 

50 75 100
I I I

Genes w/ log ratio > 1

25
I

 

 

 

 

 

Time (h)

Fig. 4. The distribution of gene counts with a threshold 21.0 along time. The
MLL ratio evaluations are constrained to observed time points

record similar improvements on the other ratios, which implies that
pairing a more complex optimization criteria with a simple likeli-
hood ratio test provides a good separability. Finally, the expected
MLL ratio achieves the highest separability between the case and
control, and shows little bias around observed time points. In con—
trast, the EMLL ratio differentiates more genes at non—observed
time points between days 7 and 14, than at days 7 and 14. However,
this might also indicate a slight bias toward intervals between
observations.

3.3 Differentially expressed genes in endothelial cells
To get a broad picture of the behavior of differentially expressed
genes in response to irradiation, we displayed their fold change
ratios throughout the 3 weeks of study post—irradiation. Figure 5
highlights the temporal cascade of the 80 gene probes corresponding
to 77 genes with significant gene expression difference with thresh-
old 1.5 (See Supplementary Fig. S7 for threshold 1.0 with 174
genes). The maximum of differentially expressed genes occurs be—
tween 8 and 12 days post—irradiation. Interestingly, this response is
transitory since at 3 weeks post—irradiation, almost no gene displays
differential expression anymore. Conversely, the immediate re—
sponse to irradiation is fast as there is 10 genes with differential ex-
pression starting during the first day, and four of them are only
active for less than 12 h, immediately after irradiation. These are
TEK (TIE2) and PDE4D, both involved in signal transduction
through MAP kinase signaling, and BCL2 and FAS, both involved in
apoptosis. The TEK receptor tyrosine kinase is expressed almost ex—
clusively in endothelial cells. This angiopoietin 1 and 2 receptor has
been involved in increasing survival in presence of angiopoietin-1
after irradiation of endothelial cells (Kwak et al., 2000). PDE4D de—
grades cAMP, which acts as a signal transduction molecule in mul-
tiple cell types, including vascular cells stimulated by the
proinﬂammatory cytokine TNF (Miro et al., 2000). Interestingly,
PDE4D has never been described to play a role in the response to
irradiation.

Apoptosis has been extensively studied under irradiation. In par-
ticular, endothelial apoptosis could be the primary lesion initiating
intestinal radiation damage (Paris et al., 2001). Supporting this re—
sult, 30 other genes related to regulation of apoptosis were also dif—
ferential during the 3 weeks. However, the main regulators of

Fold change ratios of differentially expressed genes with log ratio > 1.5

PP|L5
NRP2
TGFA 1 1.1 1.5
ITGBZ
BIRC6

 

_
—
—
SELP T
FN1
DDR1 F
CD34 —
TNFRSF10A
TNFSF10 _

BCL2L2
PLA2G4C
R U1

 

 

 

| I I | | | |
0 1 2 3 4 7 10.5 14 17.5 21
Time (days)

Fig. 5. The cascade of 77 differentially expressed genes over irradiation at
threshold 1.5. Asterisks indicate a measurement of a secondary gene probe

apoptosis (ANGPTL4, BAX, BBC3, BCL2, BIRC5, CD44, FAS,
LRDD, TNFRSF10B) return to the level of the control cells within 6
days, suggesting that apoptosis occurs primarily within few days
after exposure and then returns to normal in most cells. This is re-
markably illustrated by the expression profile of BIRC5 (survivin),
the inhibitor of apoptosis protein (Tamm et al., 1998), which is first
repressed around day 2 and then highly overexpressed from day 5.5
until around 2 weeks after irradiation before returning to control
cell levels. Interestingly, many genes involved in positive or negative
regulation of apoptosis remain differentially expressed throughout
the experiment, suggesting that irradiated cells may still express
apoptotic signals, but to a lesser extent than in early times.

3.4 Gene Ontology analysis

To further analyse the set of differential genes, we performed GO
enrichment analysis corrected for non—genome—wide analysis of the
77 differential genes with the tool DAVID (Huang et al., 2009),
using the observed gene set as a background set (See Supplementary
Table S2). We found out GO enrichments related to kidney develop—
ment, cell adhesion and migration, morphogenesis, and steroid
stimulus. These results suggest that endothelial cells subjected to ir—
radiation could initiate a transcriptional program related to the re—
newal of vasculature (development, morphogenesis and response to
a stimulus), and are in accordance with previous studies showing
they acquire a pro—inﬂammatory phenotype associated with an

112 /810'S{12umo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

 

734 M.Heinonen et al.
Differentially “pruned pathways.

 E
L! _- -
“m :4 “WEI? 3:
1611] I “9”” mm llml 1”“ IIW'IIII - - f  "I"
um “51‘” F—g  mu teem teem _ 15”” I'EI'IJ_ I‘m” lean l'El'I-i llzetl llinn .' -'
 ' i u
‘25,,“ 1951th ’ %
lee-In [5.3%] _.  _4
are ,H .  I
1, 151111 “Wt-l I: i 13ml (15%;. Iroompoom .h (50%| 11911:} [er-Iii iii-HI .1; If "7* I:

“9 J - ﬂit-wee “w”- ‘m u ' "’5' * Iii—II ' $51.11”; “2*” “m” w W“ ‘ '
“Wetter”:- -'   9L 5'
P“ I "" 1132415] may“ 41:" .. 11“ f
[571“ 1m“ PM“; new 133%:- 1291” from one I.  "F 7'

-._1' - -'——-Il.”-"- " ' ' '

(Is-Isl

111191 “53;; [T1511
lml (1511] one 1541141
I — _ £151. ﬂ-  -. ITFL 125"“

1151M

. 110-14] [511111
15?“) - iii-ti lei-o lawn III-lei 1.11111.

M" EWWWWWWWNW of; MI.
W W gﬁﬁﬂﬂ sewer“?
new ﬁfﬂfﬂ‘gri’i‘ “ire W
4- "' «Er-1F Dﬂﬁﬂxﬁ mgr. MW e *Mﬁptﬂ

r wwwweﬂe

.re 4:1“ e remorse i

ﬂow ﬁﬁﬁﬁtﬂﬂ ﬂ
ent"

We”
M

ed"

 
  

53w 

k
_ " F": .I
._,..  ;. .-'-'- "
I: --

‘I 11 13.1 no ﬁre.
W“ so“ see”: So

[WWI 1111111 laurel llml lie-Iii lie-Ill “am (25511 “W leoel "arm
"" " _— _L'FETL' _-—-—.-

r—zuﬂo

'3, .~
team lent m“! Iligﬁj flint-I 123:1  
I 1951' I resell “’5 I,

it

 

Functional pathways

Fig.6. Division of the 174 differentially expressed genes (threshold 1.0) into PANTHER pathway classification over five time periods. The solid color bars indicate
the number of differential genes found per pathway, with background bars and numbers below indicating the total number of genes measured per pathway. The
ratio between them is denoted as percentage. The pie charts represent proportions of genes belonging to various pathways during the time period. Parentheses
indicate the PANTHER pathway identifiers. See Supplementary Figure S6 for a smooth visualisation of differential pathways along time

increase of cell adhesion and leukocyte migration (Panes et al.,
1995 ; Vereycken—Holler et al., 2002).

3.5 Functional pathway analysis
We studied the pathways of the differential genes also using
PANTHER (Mi et al., 2013), which is a classification system combin—
ing gene functions, ontologies and pathways (Fig. 6 and
Supplementary Fig. S6). This allowed us to highlight pathways of
genes related to p53, FAS, integrin, interleukin signaling and others.
For example, it has been established that alteration of the plasma
membrane can generate apoptosis through the FAS signaling path-
way (Corre et al., 2010). Also, it is well—known that ionizing radi-
ation induces DNA damage that triggers the stabilization of p53 and
the phosphorylation at different amino acid sites, leading to the tran—
scription of many genes controlled by this factor (Fei and El-Deiry,
2003). We found most differential genes related to p53 pathway
were found between 0.5 and 6 days post—irradiation, whereas no or
at most 1 gene was differentially expressed between 7 and 21 days
post—irradiation (See Supplementary Fig. S6). In the same way, p53
pathway takes a greater proportion of all differential genes in early
times (0—2 and 2—4 time intervals) than in late times, as emphasized
by Figure 6 (pie charts). We verified the p5 3 expression patterns with
additional bead—based experiments (Supplementary Fig. SS). These
protein expression patterns are in accordance with results of the
pathway analyses since irradiation of primary endothelial cells in-
duces early, but not late, changes in total and phosphorylated p5 3.
The Figure 6 shows the amount of genes related to the 25 main
pathways (with at least 2 differential genes in one of the intervals) of
a total 63 pathways identified with PANTHER for the 174

differential genes (threshold 1.0). Although apoptosis pathway genes
were over—represented in our experimental design (background
bars), it is noticeable that apoptosis related genes take an even
greater part considering all differential genes within the early time
intervals 0—2 and 2—4 days (pie charts). Similarly, inflammation,
angiogenesis, integrin, p53 and FAS pathways are all over—repre—
sented comparatively to the measured genes composition.

3.6 Biological perspectives

Finally, we are able to build a dynamic picture of gene expression
changes after irradiation. In the early times, apoptosis, interleukin
and p53 signaling pathways are over—represented. Then, they de—
crease progressively post—irradiation. In contrast, integrin and in-
ﬂammation pathways become increasingly more differentiated over
time. This may reflect that cells exposed to a relatively small dose of
ionizing radiation express genes related to death by apoptosis first,
and then for those who survived, modify the expression of genes
related to long—lasting activation of pathways. Interestingly, inflam-
mation mediated by chemokine and cytokine signaling pathways are
early and continuously activated after irradiation at this dose, sug—
gesting that endothelial cells may present an inﬂamed phenotype all
along a radiotherapy course, with possible consequences on the vas—
culature of both normal tissues and tumors.

These results are highly consistent with domain literature.
Moreover, the temporal cascade allows us to propose for the first
time a temporal view on the response to irradiation primary endo—
thelial cells exposed at a radiotherapy dose fraction of 2Gy. We
were able to determine the apoptotic signal triggers timings and
shed light on the continuous activation of inﬂammation pathways,

112 /810'sp2umo [p.IOJXO'SOTl‘BIHJOJIITOTQ/ﬂClllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Detecting time periods of differential gene expression

735

 

suggesting that endothelial cells may present an inﬂamed phenotype
all along a radiotherapy course, with possible consequences on the
vasculature of irradiated tissues, in accordance with clinical observa—
tion in patients treated by radiotherapy for head and neck cancers
where a sustained inflammation due to NF-KB activation occurred
in human arteries and veins (Halle et al., 2010). These results have
implications for a better understanding of the molecular networks
involved in the dynamic response of endothelial cells to irradiation.
High dose fractionated radiotherapy is commonly used for the treat—
ment of solid tumors but the optimization of the response of cancer
and normal tissues to radiation remains an important challenge
(Moding et al., 2013).

4 Conclusion

In this article, we have proposed a novel Bayesian likelihood ratio
test for detecting time—periods of differential gene expression in time
course data. We record major improvements on the perturbation
model learning using non—stationary GPR models as the underlying
model class. For systems of genes, the method estimates a temporal
cascade of differentially expressed genes providing a large—scale
view on the genetic progression of the irradiation response. The next
step entails combining the GPR modeling with the inference of mo-
lecular networks. Recent works have explored how to exploit GPR
to facilitate parameter estimation in ODEs (Calderhead et al., 2009;
Dondelinger et al., 2013), which is undoubtedly a promising re—
search direction.

Funding

This work was supported by Electricité de France (Groupe Gestion Projet-
Radioprotection) and Institut de Radioprotec-tion et de Sﬁreté nucléaire (pro-
gramme ROSIRIS).

Conﬂict of Interest: none declared.

References

Aijo,T. and Lahdesmaki,H. (2009) Learning gene regulatory networks from
gene expression measurements using non-parametric molecular kinetics.
Bioinformatics, 25, 293 7—2944.

Angelini,C. et al. (2007) A bayesian approach to estimation and testing in time-
course microarray experiments. Statist. Appl. Genet. Mol. Biol., 6, 1—13.

Bar-Josephs,Z. et al. (2003) Continuous representations of time-series gene ex-
pression data. ]. Comp. Biol., 10, 341—356.

Calderhead,B., Girolami,M. and Lawrence,N. (2009) Accelerating bayesian
inference over nonlinear differential equations with gaussian processes.
NIPS, 21, 217—224.

Conesa,A. et al. (2006) masigpro: a method to identify signiﬁcantly differential
expression proﬁles in time-course microarray experiments. Bioinformatics,
22, 1096—1 102.

Cooke,E.]. et al. (201 1) Bayesian hierarchical clustering for microarray time series
data with replicates and outlier measurements. BMC B ioinformatics, 12, 399.
Corre,I. et al. (2010) Plasma membrane signaling induced by ionizing radi-

ation. Mutat. Res., 704, 61—67.

Dondelinger,F. et al. (2013) Ode parameter inference using adaptive gradient
matching with gaussian processes. ]MLR, 31, 216—228.

Dudoit,S. et al. (2002) Statistical methods for identifying differentially ex-
pressed genes in replicated cdna microarray experiments. Statistica sinica,
12, 111—140.

Fei,P. and El-Deiry,W. (2003) P53 and radiation responses. Oncogene, 22,
5 774—5783.

Gao,P. et al. (2008) Gaussian process modelling of latent chemical species: ap-
plications to inferring transcription factor activities. Bioinformatics, 24,
i70—i75.

Gibbs,M.N. (1997) Bayesian Gaussian Processes for Regression and
Classiﬁcation. Ph.D. thesis, Department of Physics, University of Cambridge.
Halle,M. et al. (2010) Endothelial activation with prothrombotic response in
irradiated microvascular recipient veins. ]. Plastic Reconstr. Aesthetic Surg.,

63, 1910—1916.

Hensman,]. et al. (2013) Hierchical bayesian modelling of gene expression
time series across irregularly sampled replicates and clusters. BMC
Bioinformatics, 14, 252.

Huang,D. et al. (2009) Systematic and integrative analysis of large gene lists
using David bioinformatics resources. Nat. Protocols, 4, 44—5 7.

Jebara,T. et al. (2004) Probability product kernels. ]. Mac/7. Learn. Res., 5,
819—844.

Kalaitzis,A. and Lawrence,N. (2011) A simple approach to ranking differen-
tially expressed gene expression time courses through Gaussian process re-
gression. BMC Bioinformatics, 12, 180.

Kendziorski,C. et al. (2003) On parametric empirical Bayes methods for com-
paring multiple groups using replicated gene expression proﬁles. Stat. Med.,
22, 3899—3914.

Kerr,M.K. et al. (2000) Analysis of variance for gene expression microarray
data.]. Comput. Biol., 7, 819—837.

Kirk,P.D.W. and Stumpf,M.P.H. (2009) Gaussian process regression boot-
strapping: exploring the effects of uncertainty in time course data.
Bioinformatics, 25, 1300—1306.

Kwak,H. et al. (2000) Angiopoietin-l inhibits irradiation- and mannitol-
induced apoptosis in endothelial cells. Circulation, 101, 2317—2324.

Lawrence,N. et al. (2007) Modelling transcriptional regulation using gaussian
processes. In: Scholkopf,B., Platt,].C. and Hofmann,T. (eds). Advances in
Neural Information Processing Systems, vol. 19. MIT Press Cambridge, MA,
pp.785—792.

Mestdagh,P. et al. (2009) A novel and universal method for microrna rt-qpcr
data normalization. Genome Biol., 10, R64.

Mi,H. et al. (2013) Panther in 2013: modeling the evolution of gene function,
and other gene attributes, in the context of phylogenetic trees. Nucleic Acids
Res., 41, D377—386.

Miro,X. et al. (2000) Phosphodiesterases 4d and 7a splice variants in the re-
sponse of huvec cells to tnf-alpha(1). Biochem. Biophys. Res. Commun.,
274, 415—421.

Moding,E. et al. (2013) Strategies for optimizing the response of cancer and
normal tissues to radiation. Nat. Reu, 12, 526—542.

Paciorek,C. and Schervish,M.]. (2004) Nonstationary covariance functions
for gaussian process regression. In: Saul,L.K., Weiss,Y. and Bottou,L. (eds),
Advances in Neural Information Processing Systems, vol. 16. MIT Press,
Cambridge MA, USA.

Panes,]. et al. (1995) Role of leukocyteendothelial cell adhesion in radiation-
induced microvascular dysfunction in rats. Gastroenterology, 108,
17261—1769.

Paris,F. et al. (2001) Endothelial apoptosis as the primary lesion initiating in-
testinal radiation damage in mice. Science, 293, 293—297.

Rasmussen,C. and Williams,K. (2006) Gaussian processes for machine learn—
ing. MIT Press, Cambridge MA, USA.

Schliep,A. et al. (2005) Analyzing gene expression time-courses. IEEE/ACM
Trans. Comput. Biol. Bioinﬁ, 2, 179—193.

Stegle,O. et al. (2010) A robust bayesian two-sample test for detecting inter-
vals of differential gene expression in microarray time series. ]. Comput.
Biol., 17, 355—367.

Storey,].D. et al. (2005) Signiﬁcance analysis of time course microarray experi-
ments. PNAS, 102, 12837—12842.

Tai,Y.C. et al. (2006) A multivariate empirical bayes statistic for replicated
microarray time course data. Ann. Stat., 34, 2387—2412.

Tamm,I. et al. (1998) lap-family protein surViVin inhibits caspase activity and
apoptosis induced by fas (cd95), bax, caspases, and anticancer drugs.
Cancer Res., 58, 5315—5320.

Vereycken-Holler,V. et al. (2002) Radiation effects on circulating and endo-
thelial cell interactions studied by quantitative real-time Videomicroscopy.
Int. ]. Radiat. Biol., 78, 923—930.

Yuan,M. (2006 ) Flexible temporal expression proﬁle modelling using the
gaussian process. Comput. Stat. Data Anal., 51, 1754—1764.

112 /810'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

