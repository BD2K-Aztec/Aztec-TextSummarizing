APPLICA TIONS NOTE V°" $5.339233Lii52ﬂiffﬁ333

 

Gene expression

Advance Access publication July 30, 2012

easyRNASeq: a bioconductor package for processing RNA-Seq

data

Nicolas Delhomme1 ’*, Ismael Padioleau‘, Eileen E. Furlong“2 and Lars M. Steinmetz

1,2

1Genome Biology Computational Support and 2Genome Biology Unit, European Molecular Biology Laboratory,

Meyerhofstrasse 1, 69117 Heidelberg, Germany

Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: RNA sequencing is becoming a standard for expression
profiling experiments and many tools have been developed in the past
few years to analyze RNA-Seq data. Numerous ‘Bioconductor’ pack-
ages are available for next-generation sequencing data loading in R,
e.g. ShortRead and Rsamtools as well as to perform differential gene
expression analyses, e.g. DESeq and edgeR. However, the process-
ing tasks lying in between these require the precise interplay of many
Bioconductor packages, e.g. Biostrings, lRanges or external solutions
are to be sought.

Results: We developed ‘easyRNASeq’, an R package that simplifies
the processing of RNA sequencing data, hiding the complex interplay
of the required packages behind a single functionality.

Availability: The package is implemented in R (as of version 2.15) and
is available from Bioconductor (as of version 2.10) at the URL: http://
bioconductor.org/packages/release/bioc/html/easyRNASeq.html,
where installation and usage instructions can be found.

Contact: delhomme@embl.de

Received on December 22, 2011; revised on June 18, 2012; accepted
on July 24, 2012

1 INTRODUCTION

Since the extensive utilization of RNA sequencing for expression
proﬁling (RNA-Seq, MortazaVi et al., 2008), numerous tools
have been developed, as part of the R/Bioconductor
(Gentleman et al., 2004) project, to load RNA-Seq data in R.
The ﬁrst: ‘ShortRead’ (Morgan et al., 2009) parses
manufacturer-speciﬁc formats. It gave way to the ‘Rsamtools’
package, as the ‘SAM/BAM’ format (Li et al., 2009) became a
de facto standard for reporting next-generation sequencing
(NGS) alignment data. In parallel, analysis packages were
adapted (‘edgeR’, Robinson et al., 2010) or newly developed
(‘DESeq’, Anders and Huber, 2010) to accommodate for NGS
speciﬁcities. Recently, the ‘Bioconductor’ Core Team released
several packages to connect these parts of the process: e.g.
GenomicRanges, GenomicFeatures; however, combining them
appropriately requires a good understanding of their functional-
ities, and depending on the data, different combinations of these
packages have to be used, implying a long learning curve for
RNA-Seq neophytes. In parallel to these aspects, the sequencers’
yield increase resulted in the generalization of protocols that
allow several samples to be run in a single lane, a process

 

*To whom correspondence should be addressed.

called ‘multiplexing’ (Lefrancois et al., 2009). De-multiplexing
the obtained data is a processing step that no R package cur-
rently addresses. Here, we describe ‘easyRNASeq’, an R package
that eases RNA-Seq processing by combining the necessary
packages in a single wrapper that ensures the pertinence of the
provided data and information and helps users circumnavigate
RNA-Seq processing pitfalls. In addition, it introduces function-
alities to handle data produced by recent NGS protocols.

2 easyRNASeq

The easyRNASeq package combines the following steps: reading
in sequenced reads, retrieving annotations, summarizing read
counts by the feature of interest, e.g. exon, gene and ﬁnally re-
porting results, normalized or not, in formats suitable for down-
stream analyses. This is achieved by using and extending many
Bioconductor packages functionalities (Fig. l) and provided to
end users as a single function that wraps the entire process.

2.1 Reading data

Depending on the alignment format, manufacturer-speciﬁc (e. g.
Illumina export) or the de facto BAM (Binary Alignment/Map)
standard, the data are parsed by either ShortRead or Rsamtools,
respectively. The coverage is extracted per base pair and divided
by the read length—i.e. reads’ coverage proportion are reported
per base pair—and stored in an ‘IRanges running length encod-
ing’ (RLE) vector. This approach yields identical results to the
common counting reads per se approach, when applied to
non-spliced regions as shown in the ‘RNASeuntorial’ Vignette.
However, it more accurately assigns reads spanning exon—exon
junctions (EEJ), i.e. unlike common methods that arbitrarily
select an EEJ side, reads coverage proportion is, here, distributed
across the EEJ.

2.2 Loading annotations

Genic annotations are retrieved using ‘biomaRt’ (Durinck et al.,
2005) or read from ‘General Feature Format 3’ (GF F 3) or ‘Gene
Transfer Format’ (GTF) ﬁles using ‘genomeIntervals’. The an-
notation set is stored in a ‘RangedData’ object (IRanges). To
reduce loading times, ‘RangedData’ or ‘GRangesList’ objects
from the R environment or RData (rda) ﬁles can be used, pro-
vided they describe exons, features, transcripts or genes (a ‘fea-
ture’ is the representation of a genomic locus, not necessarily
genic, e.g. an enhancer).

 

© The Author 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /810'S{12umo[pJOJXO'sot1nmJOJutotw/2d11q IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

Bioconductor package for processing RNA-Seq data

 

annotation source reads ﬁle
(e.g. gff, mart DB) (e.g. export, BAM)

genomelntervals, ShortRead,
biomaRt Rsamtools

l l

annotation set aligned read chromosome
(e-g- exon, gene) information sizes

genic annotation read coverage
lRanges, lRanges,
GenomicRanges GenomicRanges

l /

read count
summarization
lRanges,
GenomicRanges

 

 

BSgenome

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

count table (default)
or an easyRNASeq,
DESeq or edgeR object

 

 

 

Fig. 1. Packages wrapped by easyRNASeq. At every step of the process,
easyRNASeq encapsulates and extends lower level package functional-
ities, ﬁnally merging them into a single high-level function: easyRNASeq

2.3 Counting reads

The reads’ coverage is summarized according to the chosen fea-
tures: exons, features, transcripts or gene models. Here, a gene
model is deﬁned as the set of non-overlapping loci (i.e. synthetic
exons) that represent all the possible exons and untranslated re-
gions of a gene. easyRNASeq is not limited to genic summariza-
tion only, e. g. promoter ‘features’ can be used to look for eRNAs
(Kim et al., 2010).

2.4 Output

Four formats are offered: count table (the default),
‘CountDataSet’ (DESeq object), ‘DGEList’ (edgeR object) and
‘RNAseq’ (easyRNASeq object). The count table reports raw
counts or ‘reads per kb of feature per million reads’ (RPKM,
MortazaVi et al., 2008), if preferred. For DESeq and edgeR, an
object of their respective class is returned. If desired, these would
have been subjected to their respective normalization, in which
case quality assessment (QA) plots are drawn to evaluate it.
Finally, RNAseq objects allow different count summarizations
to be performed (e. g. by exon, by gene) on the same data without
re—processing, a useful feature when ﬁrst assessing a dataset.

2.5 Performance

Fetching annotation using ‘biomaRt’ takes about 10 min from an
average network. Generating the gene models takes up to 15 min
for large genomes—e.g. Homo sapiens. If these annotations are
readily available, processing a 36-bp single-end ‘Illumina’ lane
with 100 M reads—a BAM ﬁle of 3.2 GB—requires 3 GB RAM
and 3 min on an Intel 2.4GHz CPU.

3 DE-MULTIPLEXING

The current data yield allows several samples to be sequenced as
a single library, where small nucleotide ‘barcodes’ (4—6 bp)
uniquely identify the samples. Resulting sequences must be
‘de-multiplexed’, a functionality introduced by easyRNASeq
that splits the result ﬁle into sample-speciﬁc ﬁles. To account
for sequencing errors, ﬂexibility in identifying the barcode is ne-
cessary and achieved using thresholds based on the Hamming
distance (Hamming, 1950). QA plots help validating the chosen
thresholds as well as assessing the multiplexing efﬁcacy.

4 CONCLUSIONS

This note presents the Bioconductor easyRNASeq package.
It introduces a method that effectively hides the complex inter-
play of numerous Bioconductor packages to the end user. Its
output can be formatted for further processing by analysis pack-
ages such as DESeq or edgeR. Finally, it contains additional
features such as de-multiplexing or support for gapped align-
ments. Future developments will integrate recent trends such as
strand-speciﬁc sequencing or differential exon usage detection
methods.

ACKNOWLEDGEMENTS

Many thanks to P. Aboyoun, S. Bonn, W. Huber and
M. Morgan for suggestions and feedback on the package imple-
mentation. Thanks to J. Gagneur, C. Girardot, L.-A. Schmitt
and Wu Wei for comments on the article. This note was tech-
nically supported by EMBL’s IT Service Unit and EMBL’s
Genomics Core Facility.

Funding: European Molecular Biology Laboratory, an
ERASysBio grant ModHeart awarded to EEF and a NIH
grant (NIH: R01 GM0687l7) to LMS.

Conﬂict of Interest: none declared.

REFERENCES

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol., 11 (10), R106.

Durinck,S. et a]. (2005) Biomart and bioconductor: a powerful link between biolo-
gical databases and microarray data analysis. Bioinformatics, 21, 3439—3440.

Gentleman,R.C. et a]. (2004) Bioconductor: open software development for com-
putational biology and bioinformatics. Genome Biol., 5, R80.

Hamming,R. (1950) Error detecting and error correcting codes. Bell Syst. Tech. J .,
29, 147—160.

Kim,T.-K. et a]. (2010) Widespread transcription at neuronal activity-regulated
enhancers. Nature, 465, 182—187.

Lefrancois,P. et a]. (2009) Efﬁcient yeast chip-seq using multiplex short-read dna
sequencing. BM C Genom. 10, 37.

Li,H. et a]. (2009) The sequence alignment/map format and samtools.
Bioinformatics, 25, 2078—2079.

Morgan,M. et a]. (2009) Shortread: a bioconductor package for input, quality as-
sessment and exploration of high-throughput sequence data. Bioinformatics, 25,
2607—2608.

Mortazavi,A. et a]. (2008) Mapping and quantifying mammalian transcriptomes by
RNA-seq. Nat. Methods, 5, 621—628.

Robinson,M.D. et a]. (2010) edger: a bioconductor package for differential expres-
sion analysis of digital gene expression data. Bioinformatics, 26, 139—140.

 

2533

112 /810'S{12umo[pJOJXO'sot1nmJOJutotw/2dnq IIIOJJ papeolumoq

910K ‘09 lsnﬁnV uo :2

