Advance Access Publication Date: 26 February 2016

Bioinformatics, 32(13), 2016, 2056—2058
doi: 10.1093/bioinformatics/btw105

Applications Note

 

 

Phylogenetics

ecceTERA: comprehensive gene tree-species
tree reconciliation using parsimony

Edwin Jacox‘, Cedric Chauvez, Gergely J. Szollési3, Yann Ponty4 and

Celine Scornavacca1'5'*

1lSE-M, Université Montpellier, CNRS, IRD, EPHE, Montpellier, France, 2Department of Mathematics, Simon
Fraser University, Burnaby, BC, Canada, 3ELTE-MTA "Lendiilet" Biophysics Research Group, Budapest, Hungary,
4LIX, CNRS/lnria AMIB, Ecole Polytechnique, Palaiseau, France and 5Institut de Biologie Computationnelle (IBC),

Montpellier, France

*To whom correspondence should be addressed.
Associate Editor: Janet Kelso.

Received on July 24, 2015; revised on February 17, 2016; accepted on February 19, 2016

Abstract

Summary: A gene tree-species tree reconciliation explains the evolution of a gene tree within the
species tree given a model of gene-family evolution. We describe ecceTERA, a program that imple-
ments a generic parsimony reconciliation algorithm, which accounts for gene duplication, loss and
transfer (DTL) as well as speciation, involving sampled and unsampled lineages, within undated,
fully dated or partially dated species trees. The ecceTERA reconciliation model and algorithm gen-
eralize or improve upon most published DTL parsimony algorithms for binary species trees and
binary gene trees. Moreover, ecceTERA can estimate accurate species-tree aware gene trees using

amalgamation.

Availability and implementation: ecceTERA is freely available under http://mbb.univ-montp2.fr/
MBB/download_sources/16_ecceTERA and can be run online at http://mbb.univ-montp2.fr/MBB/

subsection/softExec.php?soft=eccetera.
Contact: celine.scornavacca@umontpellier.fr

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Reconciling gene trees with a species tree (Goodman et al., 1979;
Page, 1994) is a crucial step in many phylogenomics problems
(Rusin et al., 2014), from the reconstruction of gene trees (Bansal
et al., 2015; David and Alm, 2010; Nguyen et al., 2012;
Scornavacca et al., 2015; Széllési and Daubin, 2012) to the recon-
struction of ancestral genomes (Chauve et al., 2013; Széllési et al.,
2015). Internal gene tree nodes, representing ancestral genes, are as-
signed to species (extant or extinct) and evolutionary events such as
gene duplications or horizontal transfers. This results in evolution-
ary histories (or reconciliations) for gene families explaining appar-
ent discordances with the speciation history.

There exist several reconciliation software packages—such as
Notung (Durand et al., 2006; Stolzer et al., 2012), RANGER—DTL

(Bansal et al., 2012), Mowgli (Doyon et al., 2010), Eucalypt
(Donati et al., 2015), AngST (David and Alm, 2010) and Jane
(Conow et al., 2010)—whose algorithms and models, differ, some-
times in subtle ways, in terms of the evolutionary events they con-
sider (Doyon et al., 201 1). Furthermore, an important difference lies
in the nature of the species tree. First, some software packages as-
sume that the considered species tree is fully dated (i.e. speciation
dates are provided) and ensure that horizontal transfers are time-
consistent (i.e. that no transfer can occur between species that did
not exist at the same time, see Doyon et al., 2010), while others en-
sure only local time-consistency (Bansal et al., 2012). But other soft-
ware packages do consider undated species trees (i.e. the timing of
speciation events is not known), and, as ensuring time-consistency
with undated trees is an NP-hard problem (Hallett et al., 2004;

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2056

9mg ‘09 isnﬁnV uo seleﬁuV sorl ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq mm; pepeolumoq

ecceTERA 2057

 

Ovadia et al., 2011; Tofigh et al., 2011), these programs sometimes consistency of the computed parsimonious reconciliations and indi-
fail to find a consistent, parsimonious scenario and either output an cates the inconsistent ones.

inconsistent one or produce no output. This disparate body of parsi- Finally, the ecceTERA software is based on a unified dynamic
mony models and algorithms makes it difficult to assess if discrepan- programming algorithm (described in the Supplementary Material)
cies between the results provided by different software is due to that builds upon the model of the Mowgli algorithm (Doyon et al.,

differences in the model, the algorithm or the implementation. 2010). The time and space complexity of the ecceTERA reconcili-
ation algorithm is O((k + 1)|S||G|) to construct one parsimonious

reconciliation, where S is the species tree, G the gene tree and k the

2 Methods

We introduce ecceTERA, a program whose aim is to compute parsi-

number of dated nodes of S. The use of a single algorithm ensures
that, when comparing the results obtained on the same data with
monious reconciliations between species trees and gene trees under a dlffereht mOdels (for example to evaluate the ImpaCt Of a Speaatmh

comprehensive evolutionary model. The program ecceTERA im_ time), the observed differences can be attributed to differences in the

proves upon existing parsimony reconciliation software in several mOdels and not to medel'speahc algorlthmlc or Implementatmh

aspects. In Table 1 we show how ecceTERA compares to the most Issues'

commonly used parsimony algorithms/software that compute recom ecceTERA also includes several features of interest for the ana-

Cﬂiations using the Duplication_Transfer_Loss (DTL) model. ly51s of reconc1led gene trees. For example, ecceTERA can compute

MOst notably, its evolutionary model is comprehensive as it in_ a compact graph structure that represents the set of all parsimonious

cludes the following evolutionary events: speciation, speciation-loss reconcmauons for the Chosen CVOIunonary mOdel’ as descrlbed m

(speciation followed by a loss of one gene copy), gene duplication, Scornavacca et al. (2013). It is also possible to associate support val-

gene loss, gene transfer and transfer-loss (gene transfer with loss of ues With recondhation events Obtained by comiderihg nearly—Opti—
mal or Pareto-optimal reconciliations, as described in Nguyen et al.
(2013) and To et al. (2015).

Finally, an important feature of ecceTERA is its ability to recon-

the original gene) between two sampled species, and gene transfer
and transfer-loss from/to an unsampled species (i.e. a species that is

not represented in the dataset) to/from a sampled one. To the best of _ _ _ _ _
struct spec1es-aware gene trees usmg the 101nt amalgamation method

described in Scornavacca et al. (2015, the TERA algorithm)—note
that AngST (David and Alm, 2010) also amalgamates gene trees,

our knowledge, ecceTERA is the first parsimony software to imple-
ment this last event, called ‘transfer from/to the dead’ in Szollosi

et al. (2013b), where it was shown on a dataset of 36 cyanobacteria
though using a different algorithm, and that MowgliNNI (Nguyen

et al., 2012), Notung (Stolzer et al., 2012) and TreeFix-DTL (Bansal
et al., 2015) can modify gene trees using local rearrangements im-

species that a significant number of gene transfers that occurred in
the past could reasonably be transfers from/to unsampled species. A
more detailed description of the evolutionary model of ecceTERA is
provided in the Supplementary Material. prOVihg the reconcmadOh Score'

ecceTERA is a command line software written in C ++, using
the Bio ++ (Guéguen et al., 2013) and BOOST C ++libraries, and

is available as source code. It has been tested on the Mac and Linux

Also, ecceTERA, can take as input a species tree that is either
undated, fully dated (speciations are totally ordered), or partially

dated (the dating of a selected set of speciations is known), and com-

putes parsimonious reconciliations that are consistent with the pro_ platforms, for which executables are provided. It requires input trees

Vided time information, if any. Thus, for fully dated Species trees, in New1ck format and outputs reconc1liat10ns in a custom format,

ecceTERA provides consistent parsimonious reconciliations, while descrlbed 1n the manual prOVIded Wlth the SOftWare' ecceTERA can

with partially dated 01. undated Species tree, ecceTERA Checks the also output reconciliations in a format readable by Syle (Chevenet

Table 1. Comparison of selected features of the most commonly used parsimony reconciliation programs in the DTL model; all considered
programs compute a parsimonious DTL reconciliation

 

 

Program A B C D E F G H I J K L M
Handles Handles (Un) Performs Rearranges Computes Handles (Un)dated Only Only All GUI Source
TIL 'I[‘ from rooted Amalga- gene trees event ILS species feasible feasible (feasible) code
events the dead gene mation supports trees? solutions solutions co-optimal
trees? (dated) (undated) solutions
RANGER—DTL 1.0 o o R,U o o o o F,U o o o o o C +—l—
Notung 2 . 8 o o FLU o o o 0 U o ./o . . 0 Java
Mowgli a 0/0 R o o o o F . o o o . C +—|—
EUCALYPT o o R o o o 0 U o ./o o o 0 Java
AngST o 0 U . o o o F,U o o o o . Python
Jane 4 o o R o o . o F,U,P o o o . 0 Java
ecceTERA Jo Jo R,U o o o o F,U,P 0 0/0 0 o o C +—|—

 

The symbols - and 0 indicate whether or not a method implements a given feature. The symbol ./0 is used for features that can be turned on/off. Column A. in-
dicates support for the transfer-loss atomic operation. Col. B. indicates whether transfers from/to an unsampled species are considered by the model. Col. C. speci-
ﬁes which algorithms support Rooted (R) or Unrooted (U) gene trees. Col. D. and E. specify which algorithms can perform gene tree reconstruction, either
through almagamation of clades (D.) or local rearrangements (E.). Col. F. indicates whether the program provides support values for the events of the computed
reconciliations. Col. G. indicates which programs account for Incomplete Lineage Sorting (ILS). Col. H. speciﬁes whether Fully dated (F), Undated (U), or
Partially dated (P) species trees are supported by the program. Columns I. and]. indicate whether the program only reports optimal solutions that are feasible (i.e.
consistent with both the topology of the species tree and the speciation dates if available). For Col. J., a -/0 value means that no feasible solution is provided when
all optimal solutions are infeasible. Col. K. shows whether the program can enumerate all optimal (feasible) solutions. Col. L. indicates the availability of a
Graphical User Interface (all programs have a command-line mode). Note that ecceTERA can be run online at http://mbb.univ-montp2.fr/MBB/subsection/
softExec.phpPsoft=eccetera. Col. M. indicates the availability of the source code and the associated programming language that is used. Programs without a
source code distribution can nevertheless be executed on all major operating systems.

9mg ‘09 isnﬁnV uo seleﬁuV sorl ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq won pepeolumoq

2058

E.Jacox et al.

 

et al., 2016), a software for visualizing and manipulating reconcili-
ations (an example of visualization of an ecceTERA reconciliation
is provided in Fig. S4 of the Supplementary Material).

3 Case study

We applied ecceTERA to the reconstruction of species-tree aware
gene trees using the joint amalgamation method presented in
Scornavacca et al. (2015), under several evolutionary models. The
tests were performed on a dataset composed of a dated species tree
of 36 cyanobacteria and a set of 1099 gene trees obtained from
simulated alignments generated as described in Szollosi et al.
(2013a, Supplementary Material). We found that using a dated spe-
cies tree and a full evolutionary model, including transfer-loss and
transfer from/to extinct or unsampled species, achieves the highest
accuracy, with a mean Robinson—Foulds (RF) distance of 9.42 to
the true trees; this corresponds to the model described in
Scornavacca et al. (2015). Excluding transfer from/to extinct or
unsampled species led to a larger mean RF distance of 9.78, while
considering the species as undated provided the worst results, with
mean RF distances slightly above 10. These experiments are
described in more detail in the Supplementary Material.

To assess its computational efficiency, we compared ecceTERA
to RANGER—DTL (Bansal et al., 2012), the most efficient parsimony
software available to date, using three large datasets—COG,
CYANO and HOGENOM—described in detail in the
Supplementary Material. The default parameters were used for both
programs. For the COG and CYANO datasets the running times
and memory requirements of the two programs were comparable
while, on the HOGENOM dataset (see Supplementary Fig. S3),
ecceTERA was faster, by a mean factor of 3.29><, for 73% of the
gene families, and RANGER—DTL-U performed better, by a mean fac-
tor of 1.28><, on very large gene families (indeed, most of the re-
maining 27% of the gene families where RANGER—DTL-U was faster
contained more than 800 genes). We refer the reader to the
Supplementary Material for a precise comparison.

4 Conclusion

ecceTERA supports a comprehensive set of reconciliation models, for
which parsimonious reconciliations are computed using an efficient
implementation of a unified dynamic programming algorithm.
Moreover, it offers additional features that were not available in a sin-
gle software, such as species-tree aware gene tree reconstruction and
the computation of all parsimonious reconciliations. Future exten-
sions will include the reconciliation of rooted non-binary gene trees
(manuscript in preparation, partial support for this feature is provided
in the current release), the sampling of optimal and suboptimal recon-
ciliation scenarios, and provide a model of incomplete lineage sorting
(ILS) (Chan et al., in preparation), in the spirit of Stolzer et al. (2012).

Funding

Natural Sciences and Engineering Research Council (NSERC) (Discovery
Grant RGPIN-249834 to GO), Agence Nationale de la Recherche (ANR)
(grant ANR-lO-BINF-01-02 to CS and E.J.), G.J.Sz. was supported by the
FP7-PEOPLE-CIG grant ‘GENESTORY’, awarded by the European
Commission. We thank Jean-Francois Dufayard for providing the species tree
for the HOG dataset. CS and E]. benefited from the Montpellier
Bioinformatics Biodiversity cluster computing platform.

Conﬂict of Interest: none declared.

References

Bansal,M.S. et al. (2012) Efﬁcient algorithms for the reconciliation problem
with gene duplication, horizontal transfer and loss. Bioinformatics, 28,
i283—i291.

Bansal,M.S. et al. (2015 ) Improved gene tree error correction in the presence
of horizontal gene transfer. Bioinformatics, 31, 1211—1218.

Chauve,C. et al. (2013). Duplication, rearrangement and reconciliation: a fol-
low-up 13 years later. In: Chauve, C. et al (eds) Models and Algorithms for
Genome Evolution. Springer, London, pp. 47—62.

Chevenet,F. et al. (2016) Sylvx: a viewer for phylogenetic tree reconciliations.
Bioinformatics, 32, 608—610.

Conow,C. et al. (2010) Jane: a new tool for the cophylogeny reconstruction
problem. Algorithms Mol. Biol., 5, 16.

David,L.A. and Alm,E.J. (2010) Rapid evolutionary innovation during an
Archaean genetic expansion. Nature, 469, 93—96.

Donati,B. et al. (2015) EUCALYPT: efﬁcient tree reconciliation enumerator.
Algorithms Mol. Biol., 10, 3.

Doyon,J. et al. (2010) An efﬁcient algorithm for gene/species trees parsimoni-
ous reconciliation with losses, duplications and transfers. In: Comparative
Genomics — International Workshop, RECOMB-CG 2010, Ottawa,
Canada, October 9—1 1, 2010. Proceedings, volume 6398 of Lecture Notes
in Computer Science, pp. 93—108. Springer.

Doyon,J. et al. (201 1) Models, algorithms and programs for phylogeny recon-
ciliation. Brief. Bioinf., 12, 392—400.

Durand,D. et al. (2006) A hybrid micro-macroevolutionary approach to gene
tree reconstruction. ]. Comput. Biol., 13, 320—335.

Goodman,M. et al. (1979) Fitting the gene lineage into its species lineage, a
parsimony strategy illustrated by cladograms constructed from globin se-
quences. Syst. Zool., 28, 132—163.

Guéguen,L. et al. (2013) Bio ++: efﬁcient extensible libraries and tools for
computational molecular evolution. Mol. Biol. Evol., 30, 1745—1750.

Hallett,M. et al. (2004) Simultaneous identiﬁcation of duplications and lateral
transfers. In: Proceedings of the Eight International Conference on
Research in Computational Molecular Biology (RECOMB). ACM Press,
pp. 347—356.

Nguyen,T. et al. (2012) Accounting for gene tree uncertainties improves gene
trees and reconciliation inference. In: Raphael,B. and Tang,J. (eds)
Algorithms in Bioinformatics, volume 7534 of Lecture Notes in Computer
Science. Berlin, Heidelberg: Springer, pp. 123—134.

Nguyen,T.H. et al. (2013) Support measures to estimate the reliability of evo-
lutionary events predicted by reconciliation methods. PloS ONE, 8,
e73667.

Ovadia,Y. et al. (2011) The cophylogeny reconstruction problem is np-com-
plete.]. Comput. Biol., 18, 59—65.

Page,R.D. (1994) Maps between trees and cladistic analysis of historical asso-
ciations among genes, organisms, and areas. Syst. Biol., 43, 5 8—77.

Rusin,L.Y. et al. (2014) Reconciliation of gene and species trees. BioMed Res.
Int., 2014, 642089.

Scornavacca,C. et al. (2013) Representing a set of reconciliations in a compact
way. ]. Bioinf. Comput. Biol., 11, 1250025.

Scornavacca,C. et al. (2015) Joint amalgamation of most parsimonious recon-
ciled gene trees. Bioinformatics, 31, 841—848.

Stolzer,M. et al. (2012) Inferring duplications, losses, transfers and
incomplete lineage sorting with nonbinary species trees. Bioinformatics, 28,
i409—i415.

Szollési,G.J. and Daubin,V. (2012) Modeling gene family evolution and rec-
onciling phylogenetic discord. Methods Mol. Biol., 856, 29—51.

Szollési,G.J. et al. (2013a) Efﬁcient exploration of the space of reconciled gene
trees. Syst. Biol., 62, 901—912.

Szollési,G.J. et al. (2013b) Lateral gene transfer from the dead. Syst. Biol., 62,
386—397.

Szollési,G. et al. (2015) The inference of gene trees with species trees. Syst.
Biol., 64, e42—e62.

To,T.H. et al. (2015 ) A fast method for calculating reliable event supports in
tree reconciliations via Pareto optimality. BMC Bioinf., 16, 384.

Toﬁgh,A. et al. (2011) Simultaneous identiﬁcation of duplications and lateral
gene transfers. IEEE/ACM Trans. Comput. Biol. Bioinf., 8, 517—535.

9mg ‘09 1sn8nV uo seleﬁuV sorl ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q 111011 pepeolumoq

