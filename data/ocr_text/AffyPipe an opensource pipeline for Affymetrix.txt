APPLICA TIONS NOTE V°" 333233.iégi‘ilisiﬁéﬁilJ/iﬂég

 

Genome analysis

Advance Access publication July 15, 2014

AffyPipe: an open-source pipeline for Affymetrix Axiom

genotyping workflow

Ezequiel L. Nicolazzi*, Daniela lamartino and John L. Williams
Fondazione Parco Tecnologico Padano, Lodi (LO), 26900, Italy

Associate Editor: John Hancock

 

ABSTRACT

The Affymetrix Axiom genotyping standard and ‘best practice’ work-
flow for Linux and Mac users consists of three stand-alone executable
programs (Affymetrix Power Tools) and an R package (SNPolisher).
Currently, SNP analysis has to be performed in a step-by—step pro-
cedure. Manual intervention and/or programming skills by the user is
required at each intermediate point, as Affymetrix Power Tools pro-
grams do not produce input files for the program next-in-line. An add-
itional problem is that the output format of genotypes is not
compatible with most analysis software currently available. AffyPipe
solves all the above problems, by automating both standard and ‘best
practice’ workflows for any species genotyped with the Axiom tech-
nology. AffyPipe does not require programming skills and performs all
the steps necessary to obtain a final genotype file. Furthermore, users
can directly edit SNP probes and export genotypes in PLINK format.
Availability and implementation: https://github.com/nicolazzie/
AffyPipe.git.

Contact: ezequiel.nicolazzi@tecnoparco.org

Received on May 21, 2014; revised on June 25, 2014; accepted on
July 10, 2014

1 INTRODUCTION

There are two widely used high-throughput SNP genotyping
platforms: Illumina and Affymetrix. These producers differ not
only in their genotyping technologies but also in the downstream
software available to obtain genotype calls. Illumina has de-
veloped an integrated software, GenomeStudio®, with a graphi-
cal user interface (GUI) for visualization of the genotyping data
from the assay platform. GenomeStudio® only runs on the
Windows operating system (OS). Affymetrix provides a GUI
software, Genotyping ConsoleTM, for Windows OS
(http:// www.affymetrix.com / estore / browse / level_seven_soft-
ware_products_only.jsp?productId=131535). However, for
Linux/Unix and Mac OS users, the Affymetrix genotyping
workﬂow consists of a step-by-step procedure for which no
GUI or automation is available. There are two types of
workﬂow: the standard (http://www.affymetrix.com/support/
downloads/manuals/axiom_genotyping_solution_analysis_
guide.pdf) and the ‘best practice’ (http://www.affymetrix.com/
support/downloads/manuals/axiom_best_practice_supplement_
user _guide.pdf) workﬂow. The standard workﬂow consists of

 

*To whom correspondence should be addressed.

a four-step procedure, and is the basic workﬂow. The ‘best
practice’ workﬂow includes an extra step for platewise quality
control (QC).

In both workﬂows, the ﬁrst three steps use a set of stand-alone
executable programs, which were originally written in C ++
(Affymetrix Power Tools; APTools), whereas the fourth step re-
quires the use of the R programming language (http://www.R-
project.org/) and a speciﬁc R package (SNPolisher). In addition,
if the ‘best practice’ workﬂow is run, users must manually cal-
culate two platewise statistics, excluding individuals in speciﬁc
low-quality plates. A schematic overview of the process is shown
in Figure 1. To carry out the analysis, executable programs, the
SNPolisher R package and many input ﬁles for each of the steps
have to be downloaded from the Affymetrix Web site, in add-
ition to writing long command line instructions for each step.

The ﬁrst phase of the analysis is sample QC, which creates
a statistic (Dish-QC) to measure the signal across non-
polymorphic loci. Affymetrix suggests retaining samples with a
default Dish-QC >82%. Both, the evaluation of the output ﬁle
and the creation of the new input ﬁle for the next program in the
workﬂow (i.e. excluding samples that do not pass the threshold),
have to be executed manually. In the second phase, genotyped
samples with call rate (CR) lower than a default value of 97% are
identiﬁed. Users then need to manually evaluate the output ﬁle
and create a new input ﬁle, selecting the CR cutoff and excluding
samples failing the CR criteria.

The ‘best practice’ workﬂow has an extra step for platewise
QC. This step, however, is not automated and requires the
manual calculation of two statistics, ‘Plate Pass Rate’ and
‘Average Plate Call Rate’, with default values 95 and 99%, re-
spectively. Users then have to assess the quality of each plate and
create a new input ﬁle for the next program.

The next phase requires the genotyping step to be rerun for the
samples passing the quality criteria. In the last phase, the SNPolisher
R package is used to evaluate the quality of the signal and to clas-
sify each SNP probe into six classes: ‘PolyHighResolution’,
‘MonoHighResolution’, ‘NoMinorHomozygote’, ‘OﬁTargetVariant’,
‘CallRateBelowThreshold’ and ‘Other’. The Affymetrix work-
ﬂow provides genotypes, irrespective of their SNP probe qual-
ity, in SNP-probe by row format, with a 0/ l /2/—l coding, for
homozygotes ‘B’ and ‘A’ (O and 2, respectively), heterozygotes
(l) and missing genotypes (—l).

Although the use of the APTools does not require any C++
programming skills, just basic command line use, the use of
SNPolisher requires at least a basic knowledge of R.
Therefore, the lay user cannot easily run the full analysis.
Currently, a Linux or Linux-based environment is commonly

 

3118 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 [3.10811211an[p.IOJXO'SODBIIHOJIIIOIQ/ﬂ(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Afﬂ/Pipe

 

 

CEL list ﬁle

 

 

 

 

  
  
  
   
    
 
   
 

apt-gen o-qo
Output evaluation

["9‘“ ﬁl'ii Edited CEL file

apt-probeset-gen otype

Statistics calculation! .— "' t

H

Output evaluation
Edited CEL ﬁle

 

Output evaluatioﬁ ‘- .,
Edited CEL file "" -. _

AffyPipe

apt-probeset-genotype

 

 

R scripting

 

 

Quality-edited SNP
PLINK format

Raw genotype
SNP probe qualityr

 

 

 

 

 

 

Fig. 1. Schematic View of Affymetrix genotyping protocol for standard
and ‘best practice’ (extra step in dashed line) workﬂows

used to handle large datasets, therefore a pipeline that integrates
the analyses steps into a single application would be of general
use. AffyPipe is a Python-based pipeline that addresses the need
to automate the whole workﬂow and hence reduce the time,
effort and programming skills needed to obtain genotype calls.
AffyPipe allows both standard and ‘best practice’ workﬂows to
be run, and produces edited ﬁnal ﬁles in PLINK format (Purcell
et al., 2007), a standard and widely used format for genetic
analyses.

Although this pipeline was built originally for the Water
Buffalo Axiom 90K assay (Iamartino et al., 2013), it is able to
handle any species genotyped with the Affymetrix Axiom
technology.

2 METHODS

AffyPipe pipeline links APTools, intermediate steps and SNPolisher soft-
ware into a single integrated application by automatically evaluating
output ﬁles from each step and creating the input ﬁle(s) for the program
next-in-line. AffyPipe was pro grammed entirely in python, using python
default libraries. Although the use of more advanced python libraries
could have increased the efﬁciency of this pipeline, default libraries

were used to ensure portability and ease of installation and use, even
for inexperienced users. Running the pipeline is achieved using simple
command line execution, and does not require knowledge of any of the
programming languages used (python, C++ or R). The pipeline is ﬂex-
ible and includes a large range of options. The input ﬁle used contains the
list of CEL ﬁles, which are the standard Affymetrix raw intensity ﬁles,
to be analyzed, and a simpliﬁed parameter ﬁle. This parameter ﬁle is
the key to extend the capabilities of the AffyPipe tool to any of the
species genotyped with the Axiom technology, by specifying three
array- and species-speciﬁc variables: the preﬁx of the array type library
ﬁles, their release number and the name of the annotation ﬁle for the
desired species.

AffyPipe provides a script (createcelﬁle.sh) to help users to auto-
matically create the list of CEL ﬁles. AffyPipe can directly edit and
export genotypes and map information into PLINK format (Purcell
et al., 2007), by selecting the desired probe classes (default classes are
‘PolyI-IighResolution’, ‘MonoHighResolution’ and ‘NoMinorHomozygote’),
and the ‘best’ probe for each SNP. Best probes are directly identiﬁed by
SNPolisher R package scripts, and are coded as ‘1’ in the ‘BestProbeset’
ﬁeld of ‘Ps.performance.txt’ output ﬁle.

Source code, full documentation of the process and requirements, in
terms of proprietary software to be obtained from Affymetrix Web site,
are provided in the readme ﬁle at https://github.com/nicolazzie/AffyPipe.
git.

AffyPipe can be used for any species genotyped with the Axiom tech-
nology and has been successfully tested on Buffalo, Human Exome 319
and EUR arrays (NCBI GEO, http://www.ncbi.nlm.nih.gov/geo/query/
acc.cgi?acc = GPL18760; http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?
acc = GSE52691).

ACKNOWLEDGEMENTS

The authors acknowledge the BuffaloSNP international cooper-
ation project Italy—Brazil (ID 16978 and Ref N. AGRO-09) and
The International Water Buffalo Genome Consortium for test
datasets. Authors wish also to acknowledge the two anonymous
reviewers that provided good suggestions to improve this tool
further.

Funding: Italian Ministry of Education, University and Research,
project GenHome (D.M. 505/Ric); and the European Union’s
Seventh Framework Programme, project Gene2F arm (GA.
289592).

Conﬂicts of interest: none declared.

REFERENCES

Iamartino,D. et a]. (2013) The Buffalo Genome and the Application of Genomics
in Animal Management and Improvement. Buﬂalo Bull., 32, 151—158.

Purcell,S. et a]. (2007) PLINK: a toolset for whole-genome association and popu-
lation-based linkage analysis. Am. J. Hum. Genet, 81, 559—575.

 

3119

112 /810's112umoprOJXO'sot1chOJutotw/2d11q IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no :2

