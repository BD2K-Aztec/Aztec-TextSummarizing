ORIGINAL PAPER

Vol. 29 no. 6 2013, pages 772-7 79
doi:10. 1093/bioinformatics/btt027

 

Bioimage informatics

Advance Access publication January 21, 2013

Extracting 3D cell parameters from dense tissue environments:
application to the development of the mouse heart

Sorin Pop1’2’l, Alexandre C. Dufour1’2’l’*, Jean-Francois Le Garrec3’4, Chiara V. Ragni3’4,
Clemire Cimper5, Sigolene M. Meilhac3’4 and Jean-Christophe Olivo-Marin1’2’*

1Quantitative Image Analysis Unit, Institut Pasteur, 2CNRS URA 2582, 8Molecular Genetics of Development Unit,
Institut Pasteur, 4CNRS URA 2578 and 5Department of Developmental and Stem Cell Biology, Institut Pasteur,

75015 Paris, France

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: In developmental biology, quantitative tools to extract
features from fluorescence microscopy images are becoming essen-
tial to characterize organ morphogenesis at the cellular level. However,
automated image analysis in this context is a challenging task, owing
to perturbations induced by the acquisition process, especially in
organisms where the tissue is dense and opaque.

Results: We propose an automated framework for the segmentation
of 3D microscopy images of highly cluttered environments such as
developing tissues. The approach is based on a partial differential
equation framework that jointly takes advantage of the nuclear and
cellular membrane information to enable accurate extraction of nuclei
and cells in dense tissues. This framework has been used to study
the developing mouse heart, allowing the extraction of quantitative
information such as the cell cycle duration; the method also provides
qualitative information on cell division and cell polarity through the
creation of 3D orientation maps that provide novel insight into tissue
organization during organogenesis.

Availability: The proposed framework is free, open-source and avail-
able on the Icy platform (http://www.icy.bioimageanalysis.org/).
Contact: adufour@pasteur.fr or jcolivo@pasteur.fr

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 9, 2012; revised on December 17, 2012;
accepted on January 10, 2013

1 INTRODUCTION

The advent of modern 3D optical imaging techniques has
impacted numerous areas of life sciences, giving novel insight
into various aspects of cell behavior, notably during tissue devel-
opment (Mavrakis et al., 2010, Sharpe, 2011). Typical images are
obtained by labeling the cell membrane and nuclear DNA with
fluorescent dyes, yielding two-channel image volumes where cells
appear as a dense matrix of contiguous surfaces, while nuclei
appear as pseudo-elliptic blobs in close vicinity (cf. Fig. 5A).
However, in the context of dense tissues, 3D microscopy
images of developing tissues still suffer from rather poor spatial
resolution in the axial direction. Analysis is therefore still

 

*To whom correspondence should be addressed.
tThe authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as joint First Authors.

restricted to the upper section (typically 50 microns) of the spe-
cimen, beyond which substantial light scattering occurs in
non-transparent tissues, thus hindering precise segmentation at
the nuclear and cellular level. This is especially true in models
such as the mouse (Meilhac and Buckingham, 2010), where the
tissue is much less transparent than that of zebrafish or
Drosophila (Huisken et al., 2004; Megason, 2010; Zanella et al.,
2010). Alternative solutions have been proposed to improve the
imaging process by combining complementary enhancements in
the biology and the optics fields. For example, in Sato et a]
(2010), transgenic quail lines were generated, where only endo-
thelial cells express a fluorescent marker, thus simplifying the
quantification of multi-cellular movements in an embryo that
is amenable to live imaging, but without real improvement of
the resolution. A promising solution certainly lies in recent
advanced imaging setups such as single plane illumination -mi-
croscopy or SPIM (Huisken et al., 2004). There, only a thin
sample plane is illuminated, while the light emitted by the
entire plane is collected at once in the normal direction, thereby
reducing exposure time, bleaching and toxicity. Such systems are,
however, not or only recently commercially available, although
open-access prototypes are currently being developed (Pitrone
et al., 2012). It is also not clear whether SPIM images suffer
from distortion/resolution problems, due in particular to the
registration and stitching of multi-view images (Preibisch et al.,
2010). In this context, and with the exponential increase in ima-
ging datasets produced, digital image processing and analysis
tools have become indispensible to make the most of 3D imaging
techniques and data for biological applications.

To quantify and then understand the mechanisms governing
morphogenesis and organogenesis, quantitative measures such as
cell cycle durations or cell orientations must be revisited if one
wants to make full use of 3D stacks of the sample. Until recent
years, extraction of cell parameters for the characterization of
tissue growth has been limited to 2D (Baena-Lopez et al., 2005)
or multi-2D (Boehm et al., 2010) analysis, or limited by the sub-
jectivity and time-constraints of manual intervention for 3D ana-
lysis (Gong et al., 2004; Saburi et al., 2008). Because 3D cell
behavior is not stereotyped, analyses over a large number of
3D samples are required to extract relevant statistics. Hence,
systematic analysis of developing tissues composed of several
thousands of cells calls for robust and automated tools to

 

772 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 /310's113umo [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq U101} pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

Extracting 30 cell parameters from dense tissue environments

 

segment cells, nuclei and other subcellular structures from 3D
ﬂuorescence images.

A substantial amount of research in the image processing ﬁeld
is dedicated to the problem of multi-cellular segmentation in 3D.
In particular, recent attempts have been reported to tackle the
problem of dense tissue analysis in 3D. These contributions can
be declined in two families: (1) image filtering approaches,
aiming to remove the imaging artifacts by reducing the noise,
smoothing heterogeneous structures and enhancing the contrast
(Drblikova et a], 2009; Kriva et al., 2010; Mosaliganti et al.,
2010); (2) segmentation techniques, aiming to extract nuclei or
cells individually, either by means of the watershed transform
(Fernandez et al., 2010; Mosaliganti et al., 2012) or via
energy-minimizing deformable models (Dufour et al., 2011;
Zanella et al., 2010). While watershed-based approaches usually
suffer from noise and over-segmentation issues, deformable
models offer a more ﬂexible approach by allowing the incorpor-
ation of image- and geometry-based information into a robust
mathematical framework based on Partial Differential
Equations (PDE). For -instance in (Zanella et al., 2010), the
cell membrane signal is first denoised using a geodesic curvature
ﬁlter (Kriva et al., 2010), then a generalized 3D Hough trans-
form approach is used on the nuclear channel to estimate the
location of the nuclei (Ballard, 1981), ﬁnally a subjective
surface-based technique is used to segment the cell membranes
(Sarti et al., 2000). Such an approach yields promising results;
however, it is restricted to the upper section of the specimen,
illustrating the difﬁculty of processing deeper slices of the
tissue, despite the transparency of the zebrafish as compared
with the mouse. Also, the cellular and nuclear ﬂuorescence sig-
nals are processed separately, which may impair the extraction
performance.

The present work introduces a new and alternative PDE-based
framework to automatically denoise and jointly segment nuclei
and cells from 3D images of dense and opaque tissues, and to
extract quantitative measures including proliferation rates and
cell orientations. We propose that combining the nuclear and
cellular ﬂuorescence information can significantly improve seg-
mentation of both signals, even in highly non-transparent tissue
such as that of mouse. We first use a filtering technique specif-
ically designed to enhance the cellular membrane signal, and then
subtract this signal from the nuclear signal to separate touching
nuclei, thus improving their detection. Finally, we develop a
two-step deformable-model approach to (i) segment the nuclei
starting from their initial detection using local region homogen-
eity, and (ii) segment the cells starting from the extracted nuclei
using dual region-edge information from the filtered membrane
signal.

We use the proposed approach to study the development of
the mouse heart and provide new quantitative parameters char-
acterizing the morphogenetic process (e.g. number of cells and
divisions, duration of the cell cycle), as well as 3D orientation
maps to facilitate visual inspection and enable further statistical
and geometrical analysis of the observed tissue. Quantitative and
qualitative evaluations are provided, indicating a substantial gain
in performance and analysis time compared with current
approaches.

2 APPROACH

A general overview of the proposed approach is illustrated in
Figure 1, while detailed steps of the analysis are given in the
following subsections. In the ‘Anisotropic filtering’ step, a
novel PDE-based filtering technique is used to denoise the mem-
brane signal (cf. Section 2.1). In the ‘Nucleus initialization’
block, the filtered membrane signal is subtracted from the nu-
clear signal to improve their detection (cf. Section 2.3). The de-
tection results are then used to initialize our deformable model
approach to achieve accurate ‘nuclear segmentation’ (cf. Section
2.4). Once all nuclei are segmented, the resulting boundaries are
used to initialize the subsequent ‘Cell segmentation’ block, con-
ducted on the filtered membrane data. Once nuclei and cells are
segmented, additional subcellular structures are used to deter-
mine quantitative measures and orientations to characterize the
observed tissue.

2.1 Anisotropic ﬁltering for membrane enhancement

The cellular membrane can be represented by a structure of
co-dimension 2, i.e. a continuous two-dimensional surface in
3D space. However, due to the imaging and staining conditions,
the observed surfaces appear discontinuous and exhibit a highly
variable contrast, thus impairing precise extraction (Fig. 3A). To
recover continuity and contrast, image filtering approaches
based on anisotropic diffusion are particularly well suited, as
they propagate spatial information from the local neighborhood
to recover both signal intensity and structure orientation, e.g.
through the use of diffusion tensors (Weickert, 1999). Recently,
we introduced a model for cell membrane denoising and en-
hancement that takes explicitly into account the directions of
diffusion thanks to structure tensors (Pop et al., 2011). The gen-
eral equation reads as follows:

8U
— = div(DVI) (1)
at
where I is the 3D data and D is the diffusivity matrix given as
follows:

D = (171172173) diagIA1A2A3](17n72173)T (2)

21,2213 represent the amount of diffusivity along 171,172,173,
which are the eigenvectors of the structure tensor defined as
follows:

J,(v1,) = G, * (v1, (59 v1,) (3)

where each component of the resulting matrix of the tensor prod-
uct is convolved with a Gaussian G of standard deviation ,0. The
structure tensor captures the contrast and orientation of
the structures (in a radius deﬁned by the integration scale ,0)

 

Membrane Anisotropic Cell Cell
signal Filtering segmentation mfihﬁ \ _ _ _ _ _ _ _
|
I .

Feature I
M “Elem. Nuclei I Mud nus | N ucIEHS //

I extraction I
L _ _ _ _ _ _ I
signal Initialization segmentation “54195

 

 

Fig. 1. Overview of the proposed workﬂow for nucleus and cell extrac-
tion from 3D ﬂuorescence images of dense tissues (cf. Supplementary
Fig. S1 for a detailed view and associated parameter values)

 

773

112 /310's113umo [p.IOJXO'SOllBIIIJOJUIOIQ/ﬁdllq uIOJj prBOIUAAOG

9IOZ ‘091sn3nv uo ::

S.Pop et aI.

 

in the input signal smoothed with a Gaussian of standard devi-
ation 0. High values of ,0 increases structure enhancement, but
may lead to the creation of false structures. High values of 0
improve smoothness of the background, but may also smooth
the signal of interest. In all our experiments, we set ,0:2 and
0 = l. The eigenvectors 171 and 173 express the average orientation
of the gradient and the orientation of the most homogeneous
structure, respectively. The eigenvalues of the tensor
(,ul 3 ,u2 z ,u3) are positive and capture the average contrast
in the eigenvector directions. The model contains a system of
equations that deﬁne the amount of diffusion along each
eigendirection.

To build a system of eigenvalues 21, 22, 23 that is adapted to
membrane structures, we compute a plane-conﬁdence measure
deﬁned in van Kempen et a]. (1999) as follows:

M (4)

C; =
pane Mi-l-Mz

and integrate this measure into the following eigenvalue system:

21 = [M1.gK(M1)]’
A2 = maX()“19  _ [maXO‘da  _ A3Iht(Cplane) 
23 = l

where gK is an edge detector function, e. g. rational function from
the Perona-Malik model (Perona and Malik, 1990) (see
Supplementary Data for more details). Here K indicates a thresh-
old between background and edge structures and should take
higher values as the noise level increases (in our experiments,
we chose K = 5). Here h,(-) is a fuzzy threshold function between
0 and 1 that allows a better control of the transition between
co-2D structures and other regions (Terebes et al., 2005). The
eigenvalue 22 depends continuously on the conﬁdence measure
and takes values between 21 and 23. The max function prevents
22 from taking negative values and thus avoids oscillations.
Table 1 summarizes the behavior of the proposed model with
respect to the possible eigenvalue combinations. In the average
gradient direction (171), contrast enhancement is achieved along-
side the diffusion process, by letting 21 take negative values. To
ensure that the model remains well posed, the enhancement is
similar to the Perona—Malik model. It can be shown that in the
gradient direction, the diffusivity in the Perona-Malik model is
implicitly modulated by the ﬂux derivative function [x - g(x)]’
(Perona and Malik, 1990). When u1>K, this function takes
negative values, inducing an enhancing behavior along 171
(Fig. 2).

In membrane regions, the fuzzy function h,(Cplane) —> 1
implies 22 —> 23 = 1; thus, diffusion is applied along the mem-
brane tangential plane, i.e. orthogonally to 171. The regions where
h,(Cplane) —> 0 are either isotropic or exhibit 1D homogeneous

.-

{LB
1
no 1

11.4 \

I1
K1224:-
a

Fig. 2. Flux derivative function graph or variation of 21 as a function
0f Ml/K

structures, and are therefore processed differently. In regions
with 1D structures, 22 tends toward 21 because h,(Cpla,,e) —> 0
and both are close to zero. Hence, diffusion will take place along
the smallest variation of contrast 173 with an intensity equal to
one. In the orthogonal directions, two possible events can occur:
if 21 and 22 are both positive, a weak diffusion is applied, and
hence our model comes down to the classical model proposed in
Weickert (1999), which considers all structures as 1D structures;
if 21 is negative and 22 is positive, the signal is enhanced along 171
and smoothed along 172. It is interesting to note that at membrane
extremities or at junctions, the model is able to enhance the
membrane continuity even if the diffusion acts predominantly
in the most homogeneous direction (173). Membrane continuity
can be further enhanced by increasing the size of the neighbor-
hood where the structure tensor is computed, or by computing
an anisotropic structure tensor (Brox et al., 2006). Finally in
homogeneous regions, 21 tends toward 1. Hence, our model
diffuses in an isotropic manner to denoise the background
(cf. Fig. 3B), whereas classical tensor-based approaches create
false anisotropic structures in such regions (Weickert, 1999).
Comparisons with the classical model as well as with other
models dedicated to membrane ﬁltering on synthetic and real
data are given in Supplementary Data.

To summarize, the proposed model is able to (a) smooth the
signal along planar structures while enhancing their contrast; (b)
enhance the continuity of the structures, enabling the recovery of
incomplete signal; (0) provide a strong isotropic diffusion in

 

Fig. 3. Result of the proposed ﬁlter (3D raycast rendering). (A) Original
data (total variation: 126.5). (B) Denoised result (total variation: 53.7)

 

774

112 /3.IO'SIBUJHO[pJOJXO'SOIlBUHOJUIOIQ/ﬂdllq 11101; pep1201umoq

9IOZ ‘OE lsnﬁnv uo ::

Extracting 30 cell parameters from dense tissue environments

 

Table 1. Diffusion quantities in the proposed anisotropic ﬁltering model

 

Tensor structure eigenvalue combinations (11.1 2 11.2 2 11.3)

 

M1>>M2%M3

Target structures Plane-like (corners, junctions)

M1 % M2 % M3
Homogeneous (background)

M1 % M2 > > M3
Line-like (membranes)

 

23 :1

22 —>23

21 E0_lfﬂ1>K
21 E0+lfﬂ1<K

Diffusion quantities

23 =1 23 =1
22—>21,22>0 22—>23
21 E [1.1 >K 21 —> 22
21 E0+lfﬂ1<K

 

Note: 2,- —> 1: strong diffusion along 17,; 2,- —> 0+: weak diffusion along 17,; 2,- —> 0’
Diffusion quantities respect 0’ g 21 g 22 g 23 = 1.

homogeneous regions. This behavior is illustrated on real
membrane data in Figure 3 and Supplementary Figure S3.

2.2 Data fusion for nuclei detection

The high tissue density implies that nuclei are close to each other,
and are sometimes difﬁcult to distinguish by eye. We ensure that
nuclei are well separated by subtracting the cell membrane signal
from the nucleus data. In this step, all the voxels belonging to the
cell membrane [determined using an Otsu threshold (Otsu, 1979)]
are replaced in the nucleus data by the background value.

To initialize the segmentation model described below, a fast
detection method is used to detect automatically the approximate
shape and location of the nuclei in the tissue. The original images
are ﬁrst denoised using classical ﬁltering (see Supplementary
Data). However owing to the important intensity variations
across the tissue, the ﬁltered data still exhibit nuclei with different
intensities. We thus apply a multi-level threshold approach based
on Hierarchical K-Means (HK-Means), which has been
developed to separate clusters of conﬂuent cells with varying
intensities (cf. Supplementary Data). An illustration of this de-
tection step is given in Figure 4: on the raw data (A,D), the
proposed algorithm yields over segmentation; on the ﬁltered
data (B,E), some nuclei are recovered, while others are missing
or merged. Finally, after membrane subtraction (C,F), almost all
nuclei are recovered, although their size and boundary may be
inaccurate. The next section presents a solution to the latter
problem.

2.3 Segmentation

A drawback of the previous detection step is that nuclear bound-
ary localization may have been impaired during the membrane
subtraction process. A speciﬁc segmentation step is thus required
to accurately recover the boundary of each nucleus. Likewise,
each individual cell has to be extracted from the enhanced mem-
brane signal. The former problem is known as a region-based
segmentation problem (nuclei have similar homogenous intensity
as compared with the background), while the latter is known as
an edge-based segmentation problem (the interior of each cell is
unknown and bounded by its membrane). Deformable models
are well suited for these tasks, as they allow integration of both
region-based and edge-based information into a single formal-
ism, and allow the incorporation of geometrical constraints that

: enhancement along 17,; K: threshold of the Perona—Malik edge function (Fig. 2).

 

Fig. 4. Nucleus detection results via HK-Means. (A—C): 2D slice of raw
3D data (A); after ﬁltering (B); after membrane subtraction (C). (D—F)
Detection obtained on A—C

permit the distinction of objects in contact. In particular, the 3D
Active Mesh framework (Dufour et 01., 2011) provides such a
ﬂexible formalism and provides a polygonal description of the
extracted objects, thus facilitating geometrical measurements and
allowing real-time 3D visualization of the deformation process.
This technique relies on an energy minimizing framework, where
the simultaneous evolution of n surfaces 51",, within an image I is

expressed as follows:
2
d9 + 1/1 ff]
Ri

E(R0..n:SI..n) =  
1: R6

+Mﬂﬂg1+(l—n)ds+yz 
j=i+1lﬂRj

S,- R-

A . A o 2
l l
I— com I— cm 0'9

 

 

 

 

(6)

where I is a contrast-enhanced version of I that reduces the light-
scattering effect along the depth axis (cf. Supplementary Data),
cg“, is the average background intensity of I around 5; (noted R6),
0;, is the average intensity of I inside the segmented region R,
bounded by 5,, d9 is the elementary 3D space, g is a positive
non-increasing edge detector function, ds is the elementary surface
and 2, ,u, 27, y are empirical weights. The ﬁrst two terms (weighted

by 2) express region homogeneity, dramatically improving

 

775

112 /§JO's112umo [p.IOJXO'SOIlBIIlJOJUIOIQ/ﬁ(11111 u1011 pop1201umoq

9IOZ ‘091sn3nv uo ::

S.Pop et al.

 

the Chan—Vese—Mumford—Shah model (Chan and Vese, 2001) in
three aspects: ﬁrstly, the multi-phase implementation is robust to
heterogeneity of the ﬂuorescent signal; secondly, following
(Lankton and Tannenbaum, 2008) background intensity compu-
tation is restricted to a local neighborhood of each contour to
cope for uneven sample illumination; ﬁnally, we propose a novel
scheme that automatically adjusts the parameter 2 for each con-
tour according to local image statistics by setting 2,- =  This
setting automatically increases detection sensitivity for dim ob-
jects, while reverting to the original model for bright objects.
The third term (weighted by ,u. and 27) regularizes this ill-posed
problem by minimizing either the euclidean surface length (when
27 —> 0) or the geodesic surface length (when 27 —> 1), depending
on whether edge information is available (see below). The ﬁnal
term (weighted by y) couples the evolution of all surfaces and
prevents them from overlapping during their deformation, thus
handling objects in contact. Because this is a hard (topological)
constraint, the weight is set arbitrarily very large (y —> +00) to
ensure its predominance over the other energy terms. To summar-
ize, the only free parameter is ,u, which is adjusted on a
trial-and-error basis (in our experiments, we chose 0.05 for
nuclei and 0.1 for cells). This value should typically increase
with the level of noise data.

To initialize the segmentation of the nuclei, triangular meshes
are created from the pre-detected nuclei with the Marching
Tetrahedra algorithm (Treece et al., 1998). Meshes are then de-
formed on the nuclear signal. Because no edge information is
available, we set 27 = 0. Figure 5 illustrates the results obtained
on typical 3D stacks.

Cell segmentation is achieved using the same approach,
although here the input meshes are given by the segmented
nuclei, and the input image is the ﬁltered membrane signal.
Here, we set 27 = 1 such that the meshes are attracted by intensity
gradients. A well-known limitation of edge-based models is their
local spatial support, requiring that the contours must be initi-
alized close to the target boundaries to perform efﬁciently. In our
model, however, we formulate the cell extraction problem as a
dual segmentation task, based on the fact that the membrane
signal can also be interpreted as piecewise constant (cell mem-
branes versus cell interior or background). As a result, the loca-
lized region-based term allows segmentation of the interior of

 

each cell regardless of the distance from the mesh to the mem-
brane, while the edge-based term takes over when intensity gra-
dients are locally available, thus improving the localization
accuracy of the membranes (Fig. 6). While the cell membranes
are accurately recovered in most cases, the remaining errors are
due to two main factors: (i) no initialization owing to nuclei that
have not been correctly segmented; (ii) cells in anaphase, where
two nuclei are detected and initialized within the same cell, thus
disturbing the segmentation process. Another illustration of the
cell segmentation result on a full scan of an embryonic mouse
heart is presented in Supplementary Data along with the corres-
ponding nucleus segmentation (Supplementary Fig. S4).

3 IMPLEMENTATION

The presented framework is developed in Java and is available
on the free open-source Icy platform (de Chaumont et al., 2012;
http://icy.bioimageanalysis.org/). Computations are conducted
on a 1.7 GHz quad core processor with 8 GigaBytes of RAM.
The total processing time per scan is ~40 min, depending on the
total number of nuclei/cells in the scan. All PDE-based
approaches are implemented using an explicit time-stepping
scheme with forward and backward ﬁnite difference approxima-
tions. It is worth noting that the current implementation is
software-based (although it exploits multiple cores), while gra-
phics hardware is used for real-time viewing of the 3D scene
during its evolution. Hardware implementation of the workﬂow
could further decrease the computation time, although iterative
processes such as energy-minimization techniques beneﬁt less
from hardware implementation than single-pass processes.

4 RESULTS

Our approach was validated for efﬁciency and robustness on
both generated and real imaging data (cf. Supplementary
Data). We report here three applications of the proposed frame-
work dedicated to the quantitative analysis of the developing
mouse heart. We ﬁrst present results on measuring the duration
of the cell cycle using differential ﬂuorescence labeling. We then
focus on the extraction of two descriptors of tissue anisotropy,
namely the orientation of the centrosome—nucleus axes and the

 

Fig. 5. Nuclei segmentation result in 2D axial and orthogonal views. (A) Raw data (red: membranes; blue: nuclei). (B) Segmented nuclei shown

in false colors

 

776

112 /§JO's112umo [p.IOJXO'SOIlBIIlJOJUIOIQ/ﬁ(11111 u1011 pop1201umoq

9IOZ ‘091sn8nv uo ::

Extracting 30 cell parameters from dense tissue environments

 

 

Fig. 6. Cell segmentation of an embryonic heart scan. (A) 2D section of the result (red: enhanced membrane signal; green: extracted cells). (B) 3D
rendering (green: enhanced membrane signal; segmented cells are pseudo-colored from red to blue in order of descending depth)

cell division axes, to build 3D orientation maps of the tissue that
can be used for further statistical analyses (Le Garrec et al.,
2013).

4.1 Computation of the cell cycle duration

An important quantitative descriptor of tissue growth is the
duration of the cell cycle in different regions. To compute this
duration, we perform two additional scans of the specimen with
overlapping subpopulation of cells stained with IddU + BrdU or
BrdU markers (cf. Supplementary Fig. S7). The goal is to quan-
tify the proportion of cells in each subpopulation.

Segmentation is ﬁrst carried out on the entire population of
nuclei (Hoechst channel) and is followed by computing an
intensity-related measure for each nucleus within the two other
scans. Owing to the inhomogeneous ﬂuorescence labeling for
each subpopulation and the variability between experiments,
automatic distinction using a simple intensity threshold fails.
Instead, we compute a threshold on the total variation of the
signal. Finally, the cell cycle duration is given by the ratio of
stained nuclei:

N total

Tc 1 —— Al—
yce
4 l IddU+Brdu  l Brdu

(7)
where AI is the time interval between IddU and BrdU injections,
Ntotal is the total number of nuclei (on the Hoechst channel),
N1ddU+Brdu is the number of nuclei in the ﬁrst population and
N Brdu is the number of nuclei in the second population. With
this setup, we obtain a consistent mean cycle time of 22.7 h.
(standard deviation: 2.7 h.) over four different samples at the
looped heart tube stage.

This type of application can be adapted for more advanced
studies to quantify cell proliferation. By measuring such ratio in
various regions of the tissue, cell proliferation maps can be com-
puted, thus providing a deeper insight into tissue growth under-
lying shape changes.

4.2 Extraction of centrosome—nucleus axes

Cell polarity is an important feature characterizing organ
morphogenesis. Oriented deformation is the outcome of oriented
cell behavior, which in turn reﬂects intrinsic cell polarity

(Bosveld et al., 2012). One typical polarity marker is the position
of the centrosome with respect to the nucleus of the cell
(Bornens, 2012). To study this orientation, we acquired an add-
itional scan of the specimen (cf. Supplementary Data—
Biological and imaging protocol), in which the centrosomes are
ﬂuorescently stained and appear in the images as small bright
isotropic spots (cf. Supplementary Fig. S8).

Identiﬁcation of the centrosomes is performed using a
wavelet-based approach (Olivo-Marin, 2002) that consists in a
multi-scale decomposition of the input signal using un-decimated
wavelets, followed by an adaptive extraction of spot-like
structures.

After the extraction, each centrosome is paired with the near-
est neighboring nucleus, and the resulting axis of cell polarity is
considered valid if it is located within a cell. We validated this
procedure by randomly selecting 90 pairs from three different
experiments. Our algorithm obtains a correct rate of 28 of 30
pairs for the ﬁrst scan, 25 of 30 pairs for the second and 28 of 30
for the third, yielding a global accuracy of 90%. The remaining
errors are due to the inexact segmentation of nuclei and cells
mostly present in deeper Z sections, and were removed for sub-
sequent analyses. Figure 7A illustrates such a map computed on
a real dataset.

4.3 Extraction of cell division axes

The orientation of cell division is also of interest to characterize
tissue growth. In any given scan of a heart specimen, the number
of cells in mitosis is limited (e.g. <l% are in anaphase). To in-
crease this number, we perform an additional scan of the speci-
men in which cytoplasmic bridges are ﬂuorescently stained. The
cytoplasmic bridge links recently divided sister cells, totalizing
between 12 and 17% of the total cell population. The division
orientation of interest is deﬁned by the axis linking the centroids
of sister cells (see Supplementary Data for the detailed identiﬁ-
cation algorithm).

We evaluate the performance of the proposed algorithm by
manually counting the number of correctly associated sister cells
over three different scans. Out of 160 cells considered in division
by an expert, 139 were correctly identiﬁed as sister cells, i.e. 87%
accuracy. The remaining errors are due to cells that were missed
during the segmentation process and to poorly stained bridges

 

777

112 /310's112u1no [pJOJXO'SOIlBIHJOJUIOIQ/ﬂdllq 111011 pep1201um0q

9IOZ ‘OE lsnﬁnv uo ::

S.Pop et al.

 

 

Fig. 7. 3D maps of orientation axes (in red) superimposed on the nuclear signal (in blue). (A) nucleus-centrosome axes centered on the centrosome
(pale yellow). (B) cell division axes centered on the cytoplasmic bridge (pale yellow). Nuclei appearing in orange have saturated intensity. Yellow circles

show Clo se-up views

that are not well segmented. We stress that this automated an-
notation process dramatically decreases the analysis time com-
pared with manual analysis (from several hours to a few
minutes).

An illustrative map of extracted cell division axes is shown in
Figure 7B, where each axis indicates the direction joining the
newly divided sister cells.

5 DISCUSSION

While this work has been tailored for imaging data produced via
standard confocal microscopy techniques, we believe the pro-
posed approach is directly amenable to larger samples with
future imaging systems, and will be of great value when studying
tissues with complex geometry (Matsuyama et al., 2009).

In the described workﬂow, the major source of segmentation
error is the low intensity in deep tissue sections. One of the direct
consequences is that the nucleus pre—detection step is not always
able to capture the nucleus as a whole (notably due to the het-
erogeneous labeling), therefore yielding more than one object per
nucleus, and hence over-segmentation. This problem is also
described for watershed-based processes, and solutions to
reduce such artifacts using prior knowledge are currently in
development (Lin et al., 2007; Xinghua et al., 2012). On a similar
note, we stress that the proposed workﬂow enforces a strong
semantic relation between the segmentation of the nuclei and
that of the cells, based on the assumption that cells are
mono-nucleated. While this assumption holds for the current
development stage of the observed tissue, analysis at later
stages of development with the appearance of multi-nucleated
cells would require similar care to ensure that a single cell can
be extracted from a subset of detected nuclei.

6 CONCLUSION

We have presented a comprehensive framework for automatic
extraction of nuclei and cells from dense and highly cluttered
environments in 3D microscopy of biological tissue. The

proposed framework combines a number of robust PDE-derived
approaches that jointly exploit nucleus and cell ﬂuorescence
information, and provides an efﬁcient toolset for robust quanti-
ﬁcation of complex features. The approach was applied to study
the developing mouse heart and was validated on three different
applications, illustrating how developmental biology can beneﬁt
from computational approaches to facilitate the understanding
of tissue development and morphogenesis.

ACKNOWLEDGEMENTS

J.F.L.G., CR. and SM. are in the laboratory led by M.
Buckingham and D. Montarras, and we are grateful for their
support. We also thank M. Buckingham for comments on the
manuscript, and E. Zlotek-Zlotkiewicz for the calculation of the
cell cycle duration.

Funding: This work was funded by the Institut Pasteur (grant
PTR335), Lefoulon—Delalande foundation (J.F.L.G.), French
Ministry of Research (CR) and INSERM (S.M.).

REFERENCES

Ballard,D. (1981) Generalizing the Hough transform to detect arbitrary shapes.
Pattern Recognit, 13, 111—122.

Baena—Lopez,L.A. et al. (2005) The orientation of cell divisions determines the
shape of Drosophila organs. Curr. Biol., 15, 1640—1644.

Boehm,B. et al. (2010) The role of spatially controlled cell proliferation in limb bud
morphogenesis. PLoS Biol., 8, 61000420.

Bornens,M. (2012) The centrosome in cells and organisms. Science, 335, 422—426.

Bosveld,F. et al. (2012) Mechanical control of morphogenesis by fat/dachsous/
four-jointed planar cell polarity pathway. Science, 336, 724—727.

Brox,T. et al. (2006) Adaptive structure tensors and their applications. In:
Weickert,J. and Hagen,H. (eds) Visualization and Processing of Tensor Fields.
Springer, Berlin, Germany, pp. 17—47.

Chan,T. and Vese,L.A. (2001) Active contours without edges. IEEE Trans. Image
Process., 10, 266—277.

de Chaumont,F. et al. (2012) Icy: an open bioimage informatics platform for
extended reproducible research. Nat. Methods, 9, 690—696.

 

778

112 /310's112u1no proJIxo'sor112u1101urorq//:d11q 111011 pep1201um0q

9IOZ ‘OE lsnﬁnv uo ::

Extracting 30 cell parameters from dense tissue environments

 

Drblikova,O. et al. (2009) The nonlinear tensor diffusion in segmentation of mean-
ingful biological structures from image sequences of zebraﬁsh embryogenesis.
Lect. Notes Compat. Sci., LNCS 5567, 63—74.

Dufour,A. et al. (2005) Segmenting and tracking ﬂuorescent cells in dynamic 3d
microscopy with coupled active surfaces. IEEE Trans. Image Process, 14,
1396—1410.

Dufour,A. et al. (2011) 3-D Active meshes: fast discrete deformable models for cell
tracking in 3-D time-lapse microscopy. IEEE Trans. Image Process, 20,
1925—1937.

Fernandez,R. et al. (2010) Imaging plant growth in 4D: robust tissue reconstruction
and lineaging at cell resolution. Nat. Methods, 7, 547—553.

Gong,Y. et al. (2004) Planar cell polarity signaling controls cell division orientation
during zebraﬁsh gastrulation. PLoS Biol., 430, 689—693.

Huisken,J. et al. (2004) Optical sectioning deep inside live embryos by selective plane
illumination microscopy. Science, 305, 1007—1009.

Kriva,Z. et al. (2010) 3D early embryogenesis image ﬁltering by nonlinear partial
differential equations. Med. Image Anal., 14, 510—526.

Lankton,S. and Tannenbaum,A. (2008) Localizing region-based active contours.
IEEE Trans. Image Process, 17, 2029—2039.

Le Garrec,J.F. et al. (2013) Quantitative analysis of polarity in 3D reveals local cell
coordination in the embryonic mouse heart. Development, 140, 395—404.

Lin,G. et al. (2007) A multi-model approach to simultaneous segmentation and
classiﬁcation of heterogeneous populations of cell nuclei in 3d confocal micro-
scope images. Cytometry A, 71, 724—736.

Matsuyama,M. et al. (2009) Sfrp controls apicobasal polarity and oriented cell
division in developing gut epithelium. PLoS Genet., 5, 61000427.

Mavrakis,M. et al. (2010) Lighting up developmental mechanisms: how ﬂuorescence
imaging heralded a new era. Development, 137, 373—387.

Megason,S. (2010) In toto imaging of embryogenesis with confocal time-lapse mi-
croscopy. Methods Mol. Biol., 546, 317—332.

Meilhac,S. and Buckingham,M. (2010) The behaviour of cells that form the myo-
cardial compartments of the vertebrate heart. In: Rosenthal,N. and Harvey,R.
(eds) Heart Development and Regeneration. Academic Press, Boston, USA.

Mosaliganti,K. et al. (2010) Anisotropic plate diffusion ﬁltering for detection of cell
membranes in 3D microscopy images. In: Proceedings of ISBI ’2010. pp. 588—591.

Mosaliganti,K. et al. (2012) ACME: automated cell morphology extractor for com-
prehensive reconstruction of cell membranes. PLoS Compat. Biol., 8, 61002780.

Olivo-Marin,J.C. (2002) Extraction of spots in biological images using multiscale
products. Pattern Recognit., 35, 1989—1996.

Otsu,N. (1979) A threshold selection method from gray-level histograms. IEEE
Trans. Sys. Man Cybern, 9, 62—66.

Perona,P. and Malik,J. (1990) Scale space and edge detection using anisotropic
diffusion. IEEE Trans. PAMI, 12, 629—639.

Pitron6,P. et al. (2012) OpenSPIM: An open access Selective Plane Illumination
Microscope for the observation of developing fruitﬂy and zebraﬁsh embryos.
In: Proceedings of the European Microscopy Congress.

Pop,S. et al. (2011) Image ﬁltering using anisotropic structure tensor for cell mem-
brane enhancement in 3D microscopy. IEEE International Conference on Image
Processing, pp. 2085—2088.

Preibisch,S. et al. (2010) Software for bead-based registration of selective plane
illumination microscopy data. Nat. Methods, 7, 418—419.

Saburi,S. et al. (2008) Loss of Fat4 disrupts PCP signaling and oriented cell division
and leads to cystic kidney. Nat. Genet., 40, 1010—1015.

Sarti,A. et al. (2000) Subjective surfaces: a method for completing missing bound-
aries. PNAS, 97, pp. 6258—6263.

Sato,Y. et al. (2010) Dynamic analysis of vascular morphogenesis using transgenic
quail embryos. PLoS One, 5, 612674.

Sharp6,J. (2011) Two ways to use imaging: focusing directly on mechanism, or
indirectly via behaviour? Curr. Opin. Genet. Dev., 21, 523—539.

T6r6bes,R. et al. (2005) Flow coherence diffusion. Linear and nonlinear case. Lect.
Notes Compat. Sci., LNCS 3708, 316—322.

Tr6666,G.M. et al. (1998) Regularised marching tetrahedra: improved iso-surface-
extraction. Compat. Graph., 23, 583—598.

van Kempen,G.M.P. et al. (1999) The application of a local dimensionality estima-
tor to the analysis of 3d microscopic network structures. In: Proceedings of the
Scandinavian Conference on Image Analysis. Kangerlussuaq, Greenland,
pp. 447—455.

Weickert,J. (1999) Coherence enhancing diffusion. Int. J. Compat. Vis., 31, 111—127.

Xinghua,L. et al. (2012) Learning to segment dense cell nuclei with shape prior. In:
Proceedings of the International Conference on Pattern Recognition.
pp. 1012—1018.

Zanella,C. et al. (2010) Cells segmentation from 3-D confocal images of early
zebraﬁsh embryogenesis. IEEE Trans. Image Process, 19, 770—781.

 

779

112 /310's112u1no[progxo'sor112u1101urorq//:d11q U101} pop1201umoq

9IOZ ‘091sn3nv uo ::

