APPLICA TIONS NOTE V‘Zlafl’ol’l’agiiiéi;fé’ii’jiciiféiii

 

Systems biology

Advance Access publication October 30, 2013

MetaboNetworks, an interactive Matlab-based toolbox for
creating, customizing and exploring sub-networks from KEGG

Joram M. Posma*, Steven L. Robinette, Elaine Holmes and Jeremy K. Nicholson*
Computational and Systems Medicine, Department of Surgery and Cancer, Faculty of Medicine, Imperial College

London, SW7 2AZ London, UK
Associate Editor: Mario Albrecht

 

ABSTRACT

Summary: MetaboNetworks is a tool to create custom sub-networks
in Matlab using main reaction pairs as defined by the Kyoto
Encyclopaedia of Genes and Genomes and can be used to explore
transgenomic interactions, for example mammalian and bacterial as-
sociations. It calculates the shortest path between a set of metabolites
(e.g. biomarkers from a metabonomic study) and plots the connectivity
between metabolites as links in a network graph. The resulting graph
can be edited and explored interactively. Furthermore, nodes and
edges in the graph are linked to the Kyoto Encyclopaedia of Genes
and Genomes compound and reaction pair web pages.

Availability and implementation: MetaboNetworks is available from
http://www.mathworks.com/matlabcentral/fileexchange/42684.
Contact: jmp111@ic.ac.uk or j.nicholson@imperial.ac.uk
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 18, 2013; revised on October 17, 2013; accepted on
October 21, 2013

1 INTRODUCTION

Investigating the dynamic metabolic responses in living systems
because of external perturbations gives complementary informa-
tion to genomic and/or proteomic approaches. This ﬁeld is
known as metabonomics (Nicholson et al., 1999) and provides
a ‘top-down’ view of the living system to show global changes
instead of cell-speciﬁc interactions between genes, proteins and/
or metabolites. Metabolic pathway information can aid the in-
terpretation of biological changes indicated by signiﬁcant differ-
ences in metabolite concentration identiﬁed in metabonomic
studies. The effective transformation of metabolic spectroscopy
data to biological knowledge presents a signiﬁcant bioinfor-
matics challenge. In particular, the increased interest in clinical
applications of metabolic phenotyping makes practical data
visualization in a biological/medical framework of great
importance.

The Kyoto Encyclopaedia of Genes and Genomes (KEGG)
(Kanehisa and Goto, 2000) is an online resource where the inter-
action information of genes, proteins and metabolites is inte-
grated and it can be used to investigate molecular networks in
speciﬁc organisms or for all (Kanehisa et al., 2012). KEGG pro-
vides many static pathways and metabolic reaction networks as
well as a global metabolic map. The standalone application

 

*To whom correspondence should be addressed.

NeAT (Faust et al., 2010) can be used to draw custom metabolic
reaction sub-networks for a speciﬁc organism. However, it is
useful to have the ability to edit graphs, as can be done for
pathways e.g. using KEGGParser (Arakelyan and Nersisyan,
2013) in Matlab. MetaboNetworks aims to ﬁll this gap for meta-
bolic reaction networks and combine the ability to draw custom
maps and being able to edit them.

Rarely do metabolic networks and programs consider that the
typical mammal is not a single organism, but a system compris-
ing of a combination of mammalian, bacterial and potential
parasitic organisms. Speciﬁcally, there is symbiosis between a
host organism and its gut microbiota, and that gut microbes
have functions and enzymes that are not found in mammalian
organisms (Gill et al., 2006; Nicholson et al., 2012). Therefore, it
is important to be able to combine metabolic reaction networks
for different organisms. MetaboNetworks has the option to in-
clude data from multiple organisms and investigates if reactions
can occur in any of the selected organisms. In the present study,
we have illustrated the new approach using an NMR—based toxi-
cological biomarker input dataset. This is an area of particular
importance as metabolic phenotyping has shown to be particu-
larly useful for studying toxicological processes as models for
human disease (Nicholson and Wilson, 2003; Nicholson et al.,
2002).

MetaboNetworks only requires the basic version of Matlab
(The Mathworks, Natick, MA, USA) and does not require any
additional toolbox. Although the MatlabBGL toolbox (Gleich,
2006) has a number of graph layout algorithms in mex/c—l——l— code
that can be used to speed up the calculation of large graphs in
MetaboNetworks, all MetaboNetworks’ functionalities are im-
plemented using a simple graphical user interface and Matlab
code.

2 METHODS AND FEATURES

First, the appropriate data from KEGG has to be imported to Matlab. In
MetaboNetworks this is done using a function that uses the KEGG
REST-API to calculate a metabolite adjacency matrix that can later be
used to draw the graphs. The user can select one or multiple organisms
for which complete genomes are available in KEGG; for these organisms
a list of enzymes (with EC. numbers) that are associated with a gene from
any of the organisms is determined. Using this enzyme list, all reactions
are queried and enzymes involved in the reactions are matched against the
enzyme list. Only reactions that require an enzyme from the list or that
are listed as “non-enzymatic” or “spontaneous” are used to ﬁnd their main

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/|icenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's113umo [p.IOJXO'SOllBIHJOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

J.M.Posma et al.

 

 

 

 

 

   

 

 

 

 

 

 

 

 

 

 

 

 

 

I ruerahnmemgrksﬁm .=. l i a:
m I “FE “I” luk- I'II'I M LEI. ' -' '~ 'x, H ._I I I\. l '_.'l '1 I? III I l H IEI III _ II... I—III — mt "H.
.1. E..." CHI FIII 'mlsnn "3" m: "'5'- IILH 1;." ."   II“ b. ._‘l. .L. .r_. I. a: .1. ..'. z a. T" ran L‘ .t.’ "I [III II “I
A” m “a. [Hm-Im- r'I-Rﬂﬂﬁ‘In-Mtllﬂﬂﬂl I‘El.39,".3Me.gm"I’mM|—||n}1_3.nupgr*wlﬂnrl
I
Elf-rinse mp |.|rl FF
Ea-illllr “F I'lll-Id'thu-Elll-hlllarlmlue til-iﬂe-I-wumunwhe
mHnu- ADPghcm Hnmndﬂcnplm
hub" ﬁlm” 5P 5am-hullncnllI-dhwm-Lﬂ
- til-2M -h rum-cur.
mm” nnlmnm'rn HIM autumn Izaa- “imam '10-‘- I " m..:-:m.w:n-m
m m In ._._ _ sum-w.- 10H Drum-I TI'F‘F
.l D ﬁlm:th I u Pmpmuﬂ'tﬂ
ﬂank"... mu: JMulw-ﬂ- JﬂHElfﬂ'FP im-dih-pdm-Liui
Gin-Intuition: “m T
n - ﬂan“ . 5.2“ m u: u E
«mm, ---D<1lutuse cur Dmhh SMITH” H "E awmml EM “WWI I c pionmrll M- u n
"'“m H" Ham-1 I-E‘ﬂﬂlmﬂ e Hnmmﬂ P“?
mm [mgr [Miln- -.n.nuum a! l “'1 “HM-EN- S-Buur'fﬂhper-l-pl Madrid-[pf
5,, D ll m unml PM“ E“ :lH-I-llﬂH-prnml-TFF
. 1,. I _
." HA: DquH-LIMMEF “1"” “I” I mu m:
H' "WM l-E MP hm lem -' WW:- ” m-LE-DﬂH-mmhnw
- I
u “I El Huh 3P Mlbnﬂ-ﬂn JP: ‘-
D-FruLIuw 1P "'3" “I” 5“ mm tS-l-i-k-eball-rlale Mum-H...
mammmp i-ElluI-d‘pltf Pin-dull.- m" "ME “A as“:le cod.
ﬁiulnuIdm'l-I'Mn E-IUIIHU-nbupe 5-? m III-“Lav m“ -=- Mam-m in H-
‘- |. I I
D murmur-m: EF “WM P “in”: “fun “HUI-EH4“-
HHD—ﬂ-dm-W—dmwlq “Wm [.mbrh. Hum Lﬂ
- Lam JP SHE—HIP!”
{'"m"' m um: __ -§u1:I:II'n-I'\-m11n-5-er i-rm.mum.
Iii-u: III ﬁllﬂlﬂﬂl‘l’lﬁlﬂ‘ l-IIIIImrIubIe IF mle “PW”
-— _' 5-mhrﬂm-l-J-n11'l-ﬂ-ﬂur-lll
NH“! “Purim
0-5 am no 242m.
"W m“ Mall-mu hummmm """""'"'""" lummmmmr Human...”
Gml SHINE”
L-Luuldehggc I-KHﬁ-B-ﬂlﬂly-u‘iﬂﬁﬂﬂi H.FW|.L.B§F mm
_ u : n _ may __ _ Lith Faun-ma “we
Fm I“! lmnﬂl“ H 1"“ -I.-".n- I-i-Ir Inn-J-hhupmul-I- ' Madam
'1'
I5ng r d III-run! SaIIJJ-l-MelﬂuI-Ilhln-ne 2-“-|3~|3|"-II-IIIIIwi-I-"m'r-Ilvr Llﬁln
“mm I
“Lon-m r,‘,.ll Gum Ill U-uhmmc
LIZ-.5 "
mun-mac thnﬂrlhlnnhmw laﬁwllme “'h "a; Imp ' H'SﬂttlﬂlI'L-Glu mum!
[lIIlI'nIlIIinI : E "kin-Alp L5" ﬁlmmth
nuwruuidplsm L P [H n Panto-meme
I ' - m1. multnm _
12-h“ calm“..- . - I-ﬂup “h r “ LEI-Wranglnllnnlh-
f I"
Imil—glmmnﬂphnlphllmnuuhd! mmwenrn‘ u: L It: uni-I l l I!
thphﬂdrlnmlbd ' I'L’I'I- l-GIuE-mn-‘Ilh-fd-
Mal-Eat I" i _ I If“ UHF D-Lh f'ui'l'm- thismli'il-l

  
  

 

 

ﬁﬂdlﬂnﬁﬁlmlnﬂn
mm
TauludL-mwhnum chm”

TumhnDd-rmmhdﬂl

I “datum-5 mum-1011::

u: - -
mm»...   .....
WP'H-I'C'ﬂ'lluwﬁ'I-dl'l Gwlm l-DInIIIIInI
m ﬂmnlnhnllh Ibmm-nrnaunr I'M." _—H—

Cilllﬁhni

lﬂP-m-munﬂiJh-D—lln

IJInI-ull

Fig. 1. Shows the graphical user-interface of MetaboNetworks with a custom network drawn for signiﬁcant metabolites from a hydrazine toxicity study
in rats (Nicholls et al., 2001). Metabolites higher in hydrazine-dosed rats compared with controls are shown in red, and metabolites lower in hydrazine-
dosed rats are shown in blue. The white nodes are part of shortest paths between the coloured nodes. The edges shown in orange are part of the shortest
path (four reactions) between taurine and glycine. Aside from the rat, all bacteroidetes and ﬁrmicutes species were included in the database

reaction pairs. The compounds from these reaction pairs are considered
adjacent. Each row/column in the adjacency matrix indicates a speciﬁc
compound (with a KEGG compound ID) and a list of all names for these
compounds are found from the KEGG compound database. A reaction
database has previously been collected using a similar approach (Ma and
Zeng, 2003) to MetaboNetworks, however, that database includes reac-
tions from all species, whereas MetaboNetworks focusses on organisms
of interest as not all reactions can occur in all organisms.

Second, when the data collection is complete, MetaboNetworks can be
used to create and explore custom networks. A list of metabolites, e.g.
biomarkers arising from a metabonomic experiment, can be passed to
MetaboNetworks and it searches for the shortest path between each of
these metabolites using the breadth-ﬁrst search algorithm. All com-
pounds that are a part of a shortest path between any of the metabolites
are included in the network. By default, MetaboNetworks plots the net-
work as a circular graph. Other graph layouts include a spring-embedded
layout, high-dimensional embedding and two types of uniform edge-
length layouts, the last aim to place nodes with as little overlap as pos-
sible. If the Matlab statistical toolbox is installed, multidimensional scal-
ing can also be used.

Last, when the initial network layout is satisfactory the graph layout
can be manually adjusted. Supported adjustments include node position,
node/edge removal, highlighting nodes (see green edges of nodes in Fig.
l), and shortest paths (orange edges in Fig. 1), node text and nodes/edge/
text properties (font, width, size, etc.). If additional data is supplied, the
association of the metabolites with a response variable can be shown as
node colour (see Fig. 1). Furthermore, the network can be exported as a
tif, png, pdf, eps or other image formats, the network can always be reset
to the original graph (all changes are lost). Another option is to click on a

node to open a web browser showing the compound entry in KEGG or
show reactions pairs in KEGG of selected nodes. The Supplementary
Information includes a full walkthrough of the software and all the
capabilities.

3 DISCUSSION

MetaboNetworks can be used to investigate and modify complex
metabolic reaction networks. It improves the visual interpret-
ation of metabonomic experiments with coverage across dispar-
ate metabolic pathways. The network should ideally be viewed as
a connected network of probabilistic events (reactions) (\Nilson
and Nicholson, 2003) that lie on the shortest path between two
metabolites. The database can be tailored to the study by includ-
ing speciﬁc organisms, as we have done for the hydrazine toxicity
network by including all bacteroidetes and ﬁrmicutes species, as
it has been shown that germ-free rats react differently to hydra-
zine (Swann et al., 2009). MetaboNetworks can possibly also be
used for identifying unknown metabolites by generating a net-
work of metabolites correlated to the unknown metabolite. The
unknown can be part of the shortest path between the known
metabolites as the correlation can be due to a similarity in
structure.

Note that use of the KEGG-API is free for academic use;
however, non-academic users should ask for permission (see
http://www.pathway.jp/).

 

894

112 /810'S[12umo prijo'sor1nu110jurorq//:dnq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

MetaboNetworks

 

Funding: Medical Research Council - Public Health England
(MRC-PHE) Centre for Environment & Health PhD-student-
ship (to J .M.P.). We thank the Medical Research Council -
National Institute for Health Research (MRC-NIHR) National
Phenome Centre for funding this and related work.

Conﬂict of interest: none declared.

REFERENCES

Arakelyan,A. and Nersisyan,L. (2013) KEGGParser: parsing and editing KEGG
pathway maps in Matlab. Bioinformatics, 29, 518—519.

Faust,K. et al. (2010) Pathway discovery in metabolic networks by subgraph
extraction. Bioinformatics, 26, 1211—1218.

Gill,S.R. et al. (2006) Metagenomic analysis of the human distal gut microbiome.
Science, 312, 1355—1359.

Gleich,D. (2006) MatlabBGL library. http://www.mathworks.co.uk/matlabcentral/
ﬁleexchange/10922 (15 March 2013, date last accessed).

Kanehisa,M. and Goto,S. (2000) KEGG: Kyoto Encyclopedia of Genes and
Genomes. Nucleic Acids Res., 28, 27—30.

Kanehisa,M. et al. (2012) KEGG for integration and interpretation of large-scale
molecular data sets. Nucleic Acids Res., 40, D109—D114.

Ma,H. and Zeng,A.P. (2003) Reconstruction of metabolic networks from genome
data and analysis of their global structure for various organisms. Bioinformatics,
19, 270—277.

Nicholson,J.K. and Wilson,I.D. (2003) Opinion: understanding ‘global’ systems
biology: metabonomics and the continuum of metabolism. Nat. Rev. Drug
Discov., 2, 668—676.

Nicholls,A.W. et al. (2001) Metabonomic investigations into hydrazine toxicity in
the rat. Chem. Res. T 0xic0l., 14, 975—987.

Nicholson,J.K. et al. (2002) Metabonomics: a platform for studying drug toxicity
and gene function. Nat. Rev. Drug Discov., 1, 153—161.

Nicholson,J.K. et al. (1999) ‘Metabonomics’: understanding the metabolic responses
of living systems to pathophysiological stimuli via multivariate statistical ana-
lysis of biological NMR spectroscopic data. Xenobiotica, 29, 1181—1189.

Nicholson,J.K. et al. (2012) Host-gut microbiota metabolic interactions. Science,
336, 1262—1267.

Swann,J. et al. (2009) Gut microbiome modulates the toxicity of hydrazine: a meta-
bonomic study. Mol. Biosyst., 5, 351—355.

Wilson,I.D. and Nicholson,J.K. (2003) Topics in xenobiochemistry: do metabolic
pathways exist for xenobiotics? The micro-metabolism hypothesis. X enobiotica,
33, 887—901.

 

895

112 /310's112umo [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

