Bioinformatics Advance Access published July 19, 2016

Bioinformatics, 2016, 1—3

doi: l0.1093/bioinformatics/btw408

Advance Access Publication Date: 4 July 2016
Applications Note

 

Genome analysis

w4CSeq: software and web application to
analyze 4C-seq data

Mingyang Cai1'2'3, Fan Gaoz'“, Wange Lu2'4'* and Kai Wang3'5'*

1Department of Preventive Medicine, 2Eli and Edythe Broad Center for Regenerative Medicine and Stem Cell
Research, 3Zilkha Neurogenetic Institute, 4Department of Stem Cell Biology and Regenerative Medicine and
5Department of Psychiatry, Keck School of Medicine, University of Southern California, Los Angeles, CA 90033, USA

*To whom correspondence should be addressed.

TPresent address: The Picower Institute for Learning and Memory, Massachusetts Institute of Technology, Boston, MA
02139, USA

Associate Editor: John Hancock

Received on April 28,2016; revised on June 5,2016; accepted on June 20,2016

Abstract

Summary: Circularized Chromosome Conformation Capture followed by deep sequencing (4C—Seq)
is a powerful technique to identify genome—wide partners interacting with a pre—specified genomic
locus. Here, we present a computational and statistical approach to analyze 4C—Seq data generated
from both enzyme digestion and sonication fragmentation—based methods. We implemented a com—
mand line software tool and a web interface called w4CSeq, which takes in the raw 4C sequencing
data (FASTQ files) as input, performs automated statistical analysis and presents results in a user—
friendly manner. Besides providing users with the list of candidate interacting sites/regions, w4CSeq
generates figures showing genome—wide distribution of interacting regions, and sketches the enrich—
ment of key features such as TSSs, TTSs, CpG sites and DNA replication timing around 4C sites.

Availability and Implementation: Users can establish their own web server by downloading source
codes at https://github.comNVGLab/w4CSeq. Additionally, a demo web server is available at http://

 

w4cseq.wglab.org.
Contact: kaiwang@usc.edu or wangelu@usc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

With the development of microscopy and genomic technologies, it
has been shown that three—dimensional genome architecture within
nucleus tremendously affects gene function and cell property
(Pombo and Dillon, 2015). The underlying component of genome
architecture is chromatin interactions that occur at the genome—
wide scale. The specific long—range genomic segments contacts are
achieved by chromatin looping and usually mediated by transcrip—
tion factors. Most of the interactions are between enhancer and
promoter, leading to well—regulated gene expression patterns
(Dekker, 2008). Originated from 3C (chromosome conformation
capture) (Dekker et 61]., 2002), 4C—Seq (van de Werken et 61].,
2012) is specifically developed to assess the long—range DNA—DNA
interactions where one of the DNA segments is the locus of

interest, usually called ‘bait’ or ‘viewpoint’. Classical 4C—Seq tech—
nique uses enzyme digestion to fragment chromatin. To minimize
the bias caused by enzyme efficiency and uneven distribution of en-
zyme sites across genome, an alternative 4C—Seq approach is de—
veloped where sonication is used as the fragmentation method
(Gao et 61]., 2013).

It is noted that the analysis of 4C—Seq data requires extensive
data manipulation and computation, thus posing a daunting chal—
lenge for most researchers. On the other hand, most of the existing
analytical tools are either difficult to use or mainly focus on near—cis
intra—chromosomal interactions. Besides, there is no tool available
currently that can analyze 4C—Seq data generated by sonication
method. That motivates us to develop a new tool to facilitate the
analysis of 4C—Seq data. Here, we summarize the analysis pipelines,

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

91% ‘09 1sn3nv uo sepﬁuv s01 ‘BIUJOJIIBD aIo Amie/gun 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

M. Cai et al.

 

present a web application named w4CSeq, and show the results gen—
erated with w4CSeq by analyzing real biological datasets.

2 Methods and results

2.1 Implementation

The core w4CSeq software is implemented in Perl and R. Required
external tools include BWA, SAMtools and BEDTools. Detailed de—
scriptions of statistical models in analytical pipelines are included in

 

 

 

 

 

 

 

 

A ,
1- Ill—TIE. ILL—1d. #I.Hm.d_b «inﬂict: — III
2 - Mini—w d—n'li'ﬂ'n — 15
5 - _H—-':r-"II+--'n'b “HHS
4 - _--—U"n-'I'rr1w Hunt'd':
..
E 5 - ut'I—D-l-EEur'b M
E
E
c - ﬁll—m u-‘EI—Ii—u—d'm
5
E _
II
no —
x _
B
.3 E
E.
i '9 J N K 1'
D mar-nu aluminum in Reference cm Damn-u Diaan m
g H
v' 51
_- 3 S
r a * E
3
2
a". I?
g —|—|—l—l—l—l—.l' g
-.‘III.I.|W :uomu u m mm: -MI|I.I|IJ anion II Wm ml
DIJH1M blmnIn-ﬂump Dnlnncllllllllilml THE
Elma-w Dlllﬂwﬂon w m: claw-w nlntrlwﬂonm cw Islands
.11 _
: -=:""": E — : .=:::r.'.":..-.
.-. _ _
g _|
L g I
n. ‘1 .n. a d
E5 -'
' g I
3 a -.
El 5' |
.. .
a 31
g I I I I I I I g —I—l—l—l—l—l—
$011210] «2000011 [I WNW W .mm «21360611 [I 3mm 5mm
Bum-u Ian-chum 1'1'5 Bun-um.- mammal-um
F Scale
chr17: 1o.ooo.ooo| 20.ooo.ooo| ao.ooo.ooo| 4o.ooo.ooo|
10000
4c:raw reads
0,
100-
4C: smoothened sum
of captured sites
0,
10
Hi-c
324:
CTCF
o 11 1.4L m l I . midrib hi. i

  
  
  
  
  

 

 

 

 

 

Supplementary Information. w4CSeq can be installed as a local web
application. The server backend is implemented in Perl CGI.

2.2 Input and output

Once the server is running, users need to upload a single—end
FASTQ file for enzyme digestion—based 4C—Seq analysis and paired—
end FASTQ files for sonication—based 4C—Seq analysis. A genome
build needs to be specified against which the sequencing reads are
mapped. Users also need to provide information on the bait region.

B * '

ﬁ‘éxiﬁ‘1113LItinﬁltrﬂ1Q W
x _ if Q I.
. $2
#2.
9* .
F.
H

I:

n'

a
3
II.

 

 

 

DNA replication timing of Interacting regions
:0 _ =m::=;‘-:':zruluu1
If
I ' . _ , _ .~. _ _
I O I g i g i T - ; : - ‘_'
n, N - = : '. - a : 5 ' 5 '. E = a = = = =
E  I' I' I  I '5  I: 
E : : . E 5 E E :
-I: : - . E - . : : E
E : E i i i 1 : : I
m _ : : E : ; i : .. : E
' ° ° : 5 n g o i ' ° ; .. E 5 a;
‘r _ i I 3 — D
- u a a a
J
u.) _
I I I I | .
El 3:. r. E e e. ﬁ. E en en
a b it a a h a u w
w u- e F: m

mmS
50.ooo.ooo| so.ooo,ooo| 7o.ooo.ooo| ao.ooo,ooo| 90.ooo.ooo|

 

Viewpoint

Fig.1. w4CSeq generated output for an enzyme digestion-based 4C-Seq dataset. (A) Genome wide-distribution of 4C regions as indicated by red rectangles on
top of chromosome ideogram. (B) Circos plot of genome-wide distribution of 4C interactions as indicated by curves extended from the ‘bait' region. lntra-chromo-
somal (cis) and inter-chromosomal (trans) interactions are shown in red and blue, respectively. (C) Spider plot (top) depicting contacts centered on the ‘bait' re-
gion and domainogram (bottom) depicting interaction intensities across window size ranging from 2 to 200 restriction sites. (D) Density curve showing relative
distance of 4C sites from key genomic features including reference genes, TSSs, 'l'l'Ss and CpG islands compared to random. (E) Box plot showing the distribu-
tion of DNA replication timing values of 4C regions compared to the whole genome in 10 pluripotent cell lines. Early replication domains have the logarithm of
replication timing ratio > 0. (F) 4C signals distributed in cis with the viewpoint. Upper black track shows the raw reads distribution with counts ranging from 0 to
10 000; Middle red track shows the running sum of captured sites in window (window size: 100 enzyme sites); Middle black track shows virtual-4C profile ex-

tracted from Hi-C result; Lower grey track shows CTCF binding profile.

91% ‘09 1sn3nv uo sepﬁuv s01 ‘BIUJOJIIBD aIo Amie/gun 112 /3.IO'S[BIIJHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬂClllq 11101; prBOIUAAOG

w4CSeq

 

In addition, users can specify window sizes and FDR (False
Discovery Rate) threshold for statistical analysis. For enzyme—diges—
tion—based 4C—Seq portal, users need to choose the primary restric—
tion enzyme and provide primer sequence used in library
construction. For sonication—based 4C—Seq, users need to specify the
length for extension LE to define the ‘bait’ neighborhood for align—
ment purpose. Optionally, we provide a module where users can up—
load their own BED formatted annotation files containing the
regions of interest, such as ChIP—Seq peaks.

After the analysis is done, w4CSeq outputs a link navigating to
the result page that has five modules: (i) summary of parameters
that users have specified; (ii) summary of metrics throughout ana—
lysis; (iii) figures illustrating: (a) the genome—wide distribution of 4C
regions, (b) distance distribution to reference genes, TSSs, TTSs and
CpG islands of 4C sites compared to random, (c) the comparison of
DNA replication timing of 4C regions versus the whole genome, and
(d) the enrichment of user provided feature around 4C regions com—
pared to random; (iv) files which users can download to perform
their downstream analysis and (v) a link to the UCSC genome
browser where users can visualize the contact map.

Figure 1 shows the analysis of a 4C—Seq dataset (Wei et al., 2013)
aimed to investigate interaction landscape centered on a distal enhan—
cer of Oct4 gene in mouse pluripotent stem cells. Extensive inter—
actions are observed both in cis and in trans. Regions interacting with
the Oct4 distal enhancer are mostly gene—rich regions. In addition, 4C
sites are closer to annotated genes, TSSs, TTSs and CpG islands, and
show an earlier DNA replication timing. This suggests the Oct4 distal
enhancer interacting regions tend to be actively engaged in gene func—
tion and transcription activity. Of note, after processed by w4CSeq,
the interaction landscape is smoother with clear demarcations. We

also find strong correlations between the profile of 4C—Seq and that of
CTCF with virtual—4C derived from Hi—C.

3 Conclusion

We describe w4CSeq, a web application for analyzing 4C—Seq data in
an automated manner, with rich visualization functionalities. w4CSeq
will be a valuable tool to unveil the functional genome organization.

Funding

This work was supported by the National Institutes of Health [HG006465 to
K.W., 2R01CA13692406A1 to W.L.].

Conﬂict of Interest: K.W. is a board member and shareholder of Tute
Genomics, Inc. The study did not involve and did not use any product from
Tute Genomics.

References

Dekker,]. (2008) Gene regulation in the third dimension. Science, 319,
1793—1794.

Dekker,]. et al. (2002) Capturing chromosome conformation. Science, 295,
1 306—13 1 1.

Gao,F. et al. (2013) Comparative analysis of 4C-Seq data generated from
enzyme-based and sonication-based methods. BMC Genomics, 14, 345.

Pombo,A. and Dillon,N. (2015) Three-dimensional genome architecture: play-
ers and mechanisms. Nat. Rev. Mol. Cell Biol., 16, 245—257.

van de Werken,H.]. et al. (2012) 4C technology: protocols and data analysis.
Methods Enzymol., 513, 89—1 12.

Wei,Z. et al. (2013) Klf4 organizes long-range chromosomal interactions with
the oct4 locus in reprogramming and pluripotency. Cell Stem Cell, 13, 36—47.

91% ‘09 1sn3nv uo sepﬁuv s01 ‘121u10111123 aIo AliSJQAIUn 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

