ORIGINAL PAPER

Vol. 30 no. 23 2014, pages 3302—3309
doi:10. 1093/bioinformatics/btu537

 

Sequence analysis

Advance Access publication August 14, 2014

HapMuC: somatic mutation calling using heterozygous germ line
variants near candidate mutations

Naoto Usuyama‘, Yuichi Shiraishil, Yusuke Sat02’3, Haruki Kumez, Yukio Hommaz,
Seishi Ogawas, Satoru Miyano1 and Seiya lmoto1 ’*

1Human Genome Center, Institute of Medical Science, The University of Tokyo, Tokyo 108—8639, 2Department of
Urology, Graduate School of Medicine, The University of Tokyo, Tokyo 113—8655 and 3Department of Pathology and
Tumor Biology, Graduate School of Medicine, Kyoto University, Kyoto 606—8501, Japan

Associate Editor: Michael Brudno

 

ABSTRACT

Motivation: Identifying somatic changes from tumor and matched
normal sequences has become a standard approach in cancer re-
search. More specifically, this requires accurate detection of somatic
point mutations with low allele frequencies in impure and heteroge-
neous cancer samples. Although haplotype phasing information
derived by using heterozygous germ line variants near candidate mu-
tations would improve accuracy, no somatic mutation caller that uses
such information is currently available.

Results: We propose a Bayesian hierarchical method, termed
HapMuC, in which power is increased by using available information
on heterozygous germ line variants located near candidate mutations.
We first constructed two generative models (the mutation model and
the error model). In the generative models, we prepared candidate
haplotypes, considering a heterozygous germ line variant if available,
and the observed reads were realigned to the haplotypes. We then
inferred the haplotype frequencies and computed the marginal likeli-
hoods using a variational Bayesian algorithm. Finally, we derived a
Bayes factor for evaluating the possibility of the existence of somatic
mutations. We also demonstrated that our algorithm has superior spe-
cificity and sensitivity compared with existing methods, as determined
based on a simulation, the TCGA Mutation Calling Benchmark 4 data-
sets and data from the COLD-829 cell line.

Availability and implementation: The HapMuC source code is avail-
able from http://github.com/usuyama/hapmuc.

Contact: imoto@ims.u-tokyo.ac.jp

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 12, 2013; revised on July 28, 2014; accepted
on August 4, 2014

1 INTRODUCTION

Cancer is caused by genomic alterations. In particular, somatic
point mutations play a clear role in cancer development (Forbes
et al., 2011; Pleasance et al., 2010). Driven by the recent advance-
ment of high-throughput DNA sequencing technologies, muta-
tion calling from tumor and matched normal sequences is
becoming a standard approach in cancer research (Meyerson
et al., 2010). The simple goal of this approach is to detect genetic

 

*To whom correspondence should be addressed

alterations that are unique to the tumor sample. For this pur-
pose, statistical approaches that allow distinction of true somatic
mutations from relatively numerous germ line variants, sequen-
cing errors and alignment errors are required. Moreover, muta-
tion calling methods need to be sufﬁciently sensitive to detect
targets with low allele frequencies in cancer because of low
tumor contents, copy number variations and tumor heterogen-
eity. In particular, it is important to capture subclones demon-
strating tumor heterogeneity because this is thought to be one of
the main causes of therapeutic resistance and cancer recurrence
(Ding et al., 2012; Nik—Zainal et al., 2012; Shah et al., 2009).
There are mainly two approaches to detect somatic mutations
using sequence data of a tumor—normal pair. The ﬁrst approach
is to use Fisher’s exact test on read counts for evaluating the
differences in allele frequencies between tumor and matched
normal tissue; VarScan 2 (Koboldt et al., 2012) and Genomon
Woshida et al., 2011) are categorized in this group. By ignoring
complex biological structures, this approach achieves a reason-
able computational speed and robustness. The second approach
is based on Bayesian modeling, which calculates the posterior
probability that tumor and normal samples would have different
genotypes. SomaticSniper (Larson et al., 2012), jointSNVMix
(Roth et al., 2012), Strelka (Saunders et al., 2012) and MuTect
(Cibulskis et al., 2013) are representatives of this second group.
Comparative concurrent analysis of a pair of tumor and normal
sequences achieved a performance superior to the previous inde-
pendent type of analysis (Goya et al., 2010; Ley et al., 2008;
Pleasance et al., 2010) in which tumor and normal samples
were genotyped independently and results were subtracted.
Here, we focused on heterozygous germ line variants located
near candidate somatic mutations. In real data, we observed that
somatic mutations occurred mostly on one of two normal haplo-
types; however, sequencing errors occurred randomly on normal
haplotypes. The data are shown in Section 3.1. Based on this
observation, we propose a novel statistical method, HapMuC,
which can use the information of heterozygous germ line variants
near candidate mutations. First, we constructed two generative
models under a Bayesian statistical framework: one represents
true somatic mutations and the other regards candidate somatic
mutations as errors. In our generative models, we prepared four
candidate haplotypes by combining a candidate mutation and a
heterozygous germ line variant, if available. The alignment prob-
abilities of the observed reads given each candidate haplotype

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0I), which permits

non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact joumals.permissions@oup.com

112 ﬁJO'smumo[pJOJXO'sonchOJurorq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

HapMuC

 

were then computed by using proﬁle hidden Markov models
(proﬁle HMM; Albers et al., 2011; Eddy, 1998). Next, we
inferred the haplotype frequencies and calculated the marginal
likelihoods by using a variational Bayesian algorithm (Beal,
2003; Blei et al., 2003). Finally, we derived a Bayes factor
(BF), which is the ratio of the marginal likelihoods of these
two models, to evaluate the possibility of the presence of somatic
mutations.

We ﬁrst demonstrated the effectiveness of HapMuC in a simula-
tion study. Second, we also conﬁrmed its efﬁciency based on a real
sequence dataset obtained from breast cancer cell line samples,
which forms part of the The Cancer Genome Atlas (TCGA) Muta-
tion Calling Benchmark 4 datasets. Third, we tested HapMuC in
the context of a whole genome using the TCGA datasets, and the
analysis suggested that our algorithm performed better than the
existing methods, including VarScan 2, SomaticSniper, Strelka
and MuTect. In addition, we conﬁrmed that the sensitivity of our
algorithm was superior or comparable with the existing methods
using the COLD-829 dataset with its list of validated somatic mu-
tations (Pleasance et al., 2010). Finally, we discuss limitations and
propose future research directions for accurate mutation calling.

2 METHODS

2.1 Bayesian latent Dirichlet models

We constructed a generative model of observed reads. Suppose that x
is an observed read and generated from one of four haplotypes. Let 2,]- be
an indicator variable that is equal to 1 if the ith read x,- was generated
from the jth haplotype or, alternatively, is equal to 0 if x, was generated
from other haplotypes. We also deﬁne zi as the ith row of Z. A likeli-
hood of the vector of reads x is formulated by a conditional dens-
ity p(x|Z), where Z is a haplotype matrix whose (i, j)th element is zij.
Fixing the haplotype matrix Z, we can compute the value of the like-
lihood by a proﬁle HMM (Albers et al., 2011). The proﬁle HMM
formulates alignment probabilities of a read given a reference haplo-
type, considering mapping qualities, base qualities and homopolymer
length:

19(Xi, Xi, IiIHj, 0),

 

A

O heterozygous SNP
haplotype 1

Y candidate mutation

 

 

 

haplotype 2 —O—

B C

haplotype 1 haplotype 1

haplotype 2 —O— haplotype 2 —O—
haplotype 3 —'— haplotype 3 —O—'—
haplotype 4 —O—'— haplotype 4 —'—

Fig. 1. Possible types of haplotypes around a candidate mutation.
(A) Normal haplotypes around a heterozygous germ line variant.
Under the assumption that a somatic mutation occurs within one of
two normal haplotypes, haplotype 3 was generated by mutating
the ﬁrst or second haplotype. (B) Haplotype 1 was mutated, yielding
haplotype 3. (C) Mutated haplotype 2 yields haplotype 3. In both
cases, haplotype 4 was generated only by sequencing errors

where X,- is a hidden variable for alignment states, I,- is a hidden variable
for insertion states and 0 represents the proﬁle HMM model parameters.
Albers et al. also provided a Viterbi algorithm to infer the maximum-
likelihood alignment efﬁciently:

(Xi, ii) = argngaxﬂxi, Xi, IiIHj, 0)-

We used their modeling and algorithm to infer the probability of
observing a short read given a reference haplotype, that is,

p(x,-|z,- : 2,-1- = 1) =p(x,-|Hj) =p(Xi, Xi, iiIHj, 0)

In addition, when read-pair information is available, we approximate
the likelihood by multiplying the likelihoods of the ﬁrst read and the
second read, as a paired-read is considered to arise from the same
haplotype.

The haplotype matrix is, however, usually unknown, and we regard the
elements in Z as latent variables that follow a multinomial distribution

with density:
112'") = H UNI”,
1' j

where 77 is a vector of haplotype frequencies.

In this article, we also aimed to use information of a heterozygous
germ line variant located near a candidate somatic mutation. Here,
we focus on a candidate somatic mutation, which is located near a
heterozygous germ line mutation. Therefore, around the targeted
candidate mutation, there are two normal haplotypes, as shown in
Figure 1. We should note that because we assume that a somatic muta-
tion occurs independently on one of two normal haplotypes, the fourth
haplotype is not observed in the ideal case, 1.6. n4 = 0 and
77=(7r1, 7T2, Ng)’. However, in practice, the observed reads contain
sequencing errors; thus, to achieve robust statistical inference, we added
a variable 8 for representing haplotype error, which achieves an extension
of p(Z | 77) to p(Z|77, 8). Because tumor and normal samples have different
haplotypes, it is necessary to construct statistical models of p(Z|77, 8) in
tumor and normal samples, separately. The concrete modelings are
shown in later sections.

Because the haplotype frequencies, 77, are also parameters, we built a
Bayesian hierarchical structure as p(77|a), using Dirichlet distribution
with a parameter vector a. We also assumed that the haplotype error,
8, follows the beta distribution, p(8|’}/), with parameter 7.

Using the probabilistic distributions described above, we deﬁne the
decomposition of the joint distribution of the form:

p(x, Z, 77. ela, 7) =p(xIZ)p(ZIw, 8)p(wla)p(8ly)- (1)

In our case, there are two types of sequencing data: one is from a tumor
sample, denoted by xT, and the other is from a matched normal sample,
xN. Therefore, the haplotype matrix Z and the vector of haplotype fre-
quencies 77 should be considered for each of tumor (T) and normal (N)
tissue. Hence, the joint distribution is extended to

17(X, ZIaN’ aT’  =I7(xN, ZN9 “N3 SIaN’ 7)P(xT, ZT’ ﬂT’ 8|“T9 

where X=(xN, xT) and Z=(ZN, ZT, 771V, 777", 8). We can decompose
p(xN, ZN, 771V, 8|aN, 'y) and p(xT, ZT, arT, 8|aT, 'y) by the same way as
Equation (1). A key concept in our method involves the model-
ings of p(Z|77, 8) in tumor and normal tissues and is described in
the following sections.

2.2 Modeling of sequencing data from a normal sample

First, we consider modeling of sequencing data of a normal sample.
Because a normal sample contains two haplotypes, the frequencies of
these haplotypes can be represented by one parameter rm, and the
third and fourth haplotypes can be regarded as the noise generated

 

3303

112 ﬁJO'smumo[pJOJXO'sonchOJurorq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo ::

N.Usuyama et al.

 

from the ﬁrst and second haplotypes, respectively. Therefore, for haplo-
type matrix ZN, p(ZN|7rN, 8) is modeled by

NN
p(ZN|7TN, 8) = “{n'Na _ 8)}ZNi1
'—l

l_

-{(1 — ma — 8W rm)”: -{(1 — mew.

where N N is the number of normal reads. Because the haplotype fre-
quency of a normal sample can be represented by a scalar parameter
JrN, p(7rN|aN) yields the density of beta distribution.

2.3 Modeling of sequencing data from a tumor sample

As mentioned above, as we assumed that one of two haplotypes
is mutated in the tumor sample, the fourth haplotype does not exist
in the ideal situation. Let the ﬁrst haplotype be the mutated haplotype.
The fourth haplotype is then produced by the second haplotype
with error rate 8; the haplotype frequencies of the second and
fourth haplotypes are an - (1 — 8) and an -8, respectively. Therefore,
we obtain

NT
p(ZT|77T9 8):  '  — 8)}ZT'2 - ﬁzz? . (ﬂn8)ZTi4’
i=1

where NT is the number of tumor reads and 77T=(7rT1, an, n13)’ with
JTTl + an + 71713 = 1. The haplotype frequencies 717 = (an, an, an) then
follows multinomial distribution p(77T|aT), with parameter
aT=(OtT1,Otr2, 0613),-

2.4 BF for ﬁnding somatic mutations

Although we can ﬁt the Bayesian latent Dirichlet model to the sequencing
data of tumor and matched normal samples using some statistical meth-
ods, for evaluating the possibility of a variant being a true somatic mu-
tation, we need to deﬁne a model that can be considered as a control
against the model constructed under the premise of the existence of the
mutation. In a Bayesian framework, we can compare the likelihoods of
these two models by the BF given by

= PMC’CN, xTIaN, “T, 1’)

BF ,
PE(xN, xTIaN, “T, 1’)

where p M and pE represent the models constructed under the premise of
the existence of a mutation and without a mutation, respectively, and p M
(xN, xTIaN, aT, 'y) is the marginal likelihood deﬁned by

pM(xN, xTIaN, ar, 'y) =

Z  ZIaN9 aT, 

ZNsZT

If the value of the BF is signiﬁcantly large, we regard the candi-
date mutation as likely to be a true somatic mutation, with high
probability.

As for the two models, 1) M and 1715, p M is the model already described
in the previous sections, which we designate a mutation model. The
latter model, pE, can be constructed by replacing the haplotype
frequencies in p(ZT|77T, 8) with those in p(ZT|7rN, 8), i.e. only two
haplotypes ideally exist, and the third and fourth haplotypes are sim-
ply errors. We designate pE as an error model. It is not an easy task
to compute the marginal likelihood pM(xN, xTIaN,aT, 7) because it
contains high-dimensional integrals and sums. To achieve efﬁcient
computation of the marginal likelihood, we derived a variational Bayes
procedure for our proposed model.

2.5 Variational Bayes method for computing marginal
likelihood

Suppose that q(Z) is the variational distribution that yields the decom-

position

q(Z) = q(ZN)q(ZT)q(7rN)q(wT)q(8)- (2)

Although the variational distribution should be prepared for each of
the mutation and error models, we omit the index M or E for simplifying
the representation. Using the variational distribution, we obtain a lower
bound of the marginal likelihood

p(X’ ZIaN’ aT’  

q(Z)

where E] represents the expectation under the distribution q, as
deﬁned in Equation (2). In the variational Bayes framework,
a functional of q in the right side of Equation (3) is called free
energy and an iterative update of q, which maximizes the free
energy achieved to an estimated posterior density of ZN, ZT, JrN, HT
and 8. The update formula of q in the right side of Equation (2) can
be represented by

10gP(X|aN, “T, 7’) 2 Eq [log

NN4

q*(ZN) = H H (rm-W.

i=1j=1
NT 4

q*(ZT) = H H (aw,

i=1j= 1
q*(7rN) =pbeta(7rN|a*N),
61*(77T) =PDir(7TT|a*T),

q*(8) =Pbeta(8|7*)’

where pbeta and ijr are the densities of beta and Dirichlet distribu-
tions, respectively, and the updated parameters can be obtained by

*
pNij

* _
rNij— 4
*
2 :j/=1 

*
pTij

* _
rTij— 4 ’
*
2 :j/Zl pTij’

9

NN NN
* = ( .+ .)+ * = ( .+ .)+
05m ZNzl ZNz3 (Wham 2sz ZNz4 “N2,
i=1 i=1

NT NT

* _ >I< _
an— E Zm+om,0tn— E (ZTi2+ZTi4)+aT2,
i=1 i=1

NT

* _
0613—2 ZTB‘I'Om,
i=1

NT NN

VT = Z ZTi4 1' Z(ZNi’3 1' ZNi’4) + Vi,

i=1 1’=1

NT NN

V; = Z ZTi2 1' Z(ZNi’1 1' ZNi’2) + 1’2,

i=1 1’=1

 

3304

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂ(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

HapMuC

 

with

 

of V*
10g p*Ni1 =log m +108 Vi. +26 +logP(xNilH1),

*

a *
—N2 + 10 yz

 

log )o*Ni2 = log * 1‘ IOgP(XNi|H2),

 

 

a*Nl + “*Nz Vi + 1’2
a*Nl Vi
108 P*N,-3 =log m +108 Vi. + y; +108P(XNi|H3),
aivz Vi
log p*Ni4 =108 m +108 Vi. + y; +10gP(XNi|H4),

a*
log p’kTil =10g 3—Tl* +108P(XT1'|H1)’
k=1a77€

a*
log pi},2 = log 3—72 + log
k=1a>§7€

V*Nz
—. .. +10gp(xr-IH2),
VN1 + N2 1

* 06%
108 Pm 2108 —3 * +108P(XTi|H3),
k=1 “T76
* a*
log )oTi4 =log 3—n* + log
k=1 aTk

 

.71 . +Iogp(xT.-IH4).
1+ 2

Here, 71,- is the jth haplotype, and xN, and xT, are the ith read of
normal and tumor samples, respectively.

We describe the derivation of the variational procedure in
Supplementary Method S1.

2.6 Inferring local normal haplotypes when there exist
multiple heterozygous germ line variants

When multiple heterozygous germ line variants are located nearby, the
number of candidate haplotypes in the normal sample is two to the power
of the number of the germ line variants. We use a haplotype assembly
algorithm (He et al., 2010) to infer the two normal local haplotypes from
the set of possible haplotypes. The method constitutes a dynamic pro-
gramming algorithm, which will ﬁnd an optimal solution with respect to
the minimum error correction (MEC) score. The MEC score is the number
of conﬂicts between the reads and the two constructed haplotypes. The
problem of minimizing the MEC score is Non-deterministic Polynomial-
time hard (Cilibrasi et al., 2005; Genovese et al., 2008); however, the op-
timal algorithm is computationally practical for up to reads of length 15,
where the length is the number of heterozygous germ line variants.

3 RESULTS

3.1 Sequence errors occur randomly on normal haplotypes
in real data

We investigated the relationships between somatic mutations and
heterozygous germ line variants nearby, using exome tumor and
matched normal sequences of 10 ccRCC patients (Sato et al.,
2013; Shiraishi et al., 2013). First, we focused on orthogonally
validated somatic mutations with a heterozygous germ line single
nucleotide polymorphism (SNP) nearby. The somatic mutations
were detected based on tumor and matched normal exome se-
quences, and then validated by using RNAseq and whole
genome sequence data. For each true somatic mutation, we

classiﬁed the reads, which overlap both the somatic mutation pos-
ition and the heterozygous SNP position, into four types: (i) RR,
reads that do not support either the somatic mutation or the het-
erozygous SNP; (ii) VR, reads that support the somatic mutation
without the heterozygous SNP; (iii) RV, reads that support the
heterozygous SNP without the somatic mutation; and (iv) VV,
reads that support both the somatic mutation and the heterozygous
SNP. As a heterozygous germ line SNP was located nearby, we
observed both RR and RV reads for each somatic mutation.
However, we mostly observed either VR or W reads (Fig. 2B).
This experiment indicated that somatic mutations occur on one of
normal haplotypes. Second, we investigated the behaviors of se-
quence errors. We collected mismatches in error loci (Shiraishi
et al., 2013) using the same exome data as above, and excluded
potential mapping errors by using human chained self-alignments
(Chiaromonte et al., 2002; Kent et al., 2003; Schwartz et al., 2003),
simple tandem repeats (Benson, 1999), dbSNP 138 (Sherry et al.,
2001), BLAT aligner (Kent, 2002) with human decoy sequences
(37d5) (Genovese et al., 2013) and indels located nearby (see
Supplementary Method S2). For each probable sequence error pos-
ition, we classiﬁed the reads, which overlap the sequence error pos-
ition and the heterozygous SNP position, into four types (RR, VR,
RV and VW. We observed both VR and VV reads simultaneously
in most cases (Fig. 2B), in contrast to the observations made for the
somatic mutations. This observation indicates that sequence errors
occur randomly on normal haplotypes.

3.2 Simulation Study

We tested HapMuC using synthetic data. In this simulation, we
used several read lengths (100, 150, 300 and 1000 bp) and com-
pared the results between these as well as single-end reads versus
paired-end reads.

We generated positive and negative examples as follows:

(1) Generate a random reference DNA sequence

(2) Generate a heterozygous germ line variant in a random
location, as well as two haplotypes (h1 and h2)

(3) Generate a somatic mutation randomly, according to an
empirical distribution (Supplementary Fig. S1), as well as
two haplotypes (h3 and h4)

(4) Setting parameters were as follows: tumor purity was set at
20% for positive examples and 0% for negative examples.
Note that a tumor purity of 20% leads to an average allele
frequency of 10%.

(5) For 50 repetitions:

0 Select a source haplotype randomly, according to the
multinomial distribution (haplotype frequencies),
given the parameters

0 Select a start point of a read randomly such that the
read overlaps the candidate position

0 Select a strand direction randomly, and generate
a paired-read with 1% sequence errors and an in-
sertion size given by a normal distribution
(,u.=3 x l, a=l/2), where l is the read length, by
referring to an empirical distribution (Supplementary
Fig. S2).

 

3305

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂ(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

N.Usuyama et al.

 

Note that we used only those examples that passed the
minimum criteria for allele frequencies, read coverage,
the number of variant-supporting reads and strand
bias (Supplementary Method S3). Note also that the read
depth is 50x. As a counterpart method, we prepared a simple
Fisher’s exact test-based method, which uses a 2 x 2 base counts
table.

We calculated the area under curve (AUC) values (Bradley,
1997) for each setting. We summarize these results in Table 1.
The AUC values of the Fisher method and BF s without SNPs
are comparable; however, BF s that used heterozygous germ line
variants outperformed these. In addition, the number of pos-
itions, for which heterozygous germ line variants could be
used, increases as the read length increases.

A Validated somatic mutations B Sequence errors

 

 

300

 

 

 

 

' o 8 _ +
‘—
o
w R ' w 8 —
s s F +
‘D a) +
h o h
_ +
g 8 g 8 T o
0
"5 o “5 °
h 2 T h 8 — 00 +
8 - 8 o o
E 8 - - E o t°°
C ‘_ ’ C <- 0 +
a, a, o O O 0
.C 0 .C 3+ 0 +
I— g - I— a — «5+ 3+ 0° 3 + +
O Validated somatic mutations + 4+ $2; 0 Normal samples
L gut $+ + + Tumor samples
0 - I. C I I O O -
I I
0 0

 

 

| |
20 4o 60 so 100
The number of VR reads

2'0 4'0 6'0 8'0 1 00 1 20
The number of VR reads

Fig. 2. Relationships between candidate mutations and nearby heterozy-
gous germ line variants from 10 ccRCC patients’ sequence data. For each
candidate mutation, we counted the reads that cover the candidate mu-
tation and the heterozygous germ line variant (W), and the reads that
cover the candidate mutation without the heterozygous variant (VR).
(A) For the orthogonally validated somatic mutations, we mostly
observed the reads of a single haplotype WV or VR). (B) However, for
sequence errors, we observed the reads of both haplotypes NV and VR)
randomly

Table 1. Results from the simulation study

3.3 Real data

We evaluated our new algorithm, HapMuC, using the whole-
genome sequence data of breast cancer cell lines (HCC1954
and HCC1143), which are publicly available as a part of the
TCGA Mutation Calling Benchmark 4 datasets (https://cghub.
ucsc.edu/datasets/benchmark_download.html). We used the
tumor samples (computationally mixed with normal) and the
matched pure normal samples as evaluation datasets, whose
average read coverage was ~30x (Supplementary Table S1).
We ﬁrst detected the candidate positions that passed minimum
criteria in the evaluation dataset. Then, we assumed that candi-
date positions were true positives if, and only if, the positions
were also called on the corresponding pure dataset with an aver-
age coverage of 60x. The criteria are shown in later sections. The
workﬁow of HapMuC is given in Supplementary Figure S3.

3.3.1 Superior performance using nearby heterozygous germ line
SNPS We used the 60% tumor dataset of HCC1954 for eval-
uating the effect of using heterozygous germ line variants located
near candidate mutations. The criteria are shown in
Supplementary Method S4 and S5 for the evaluation dataset
and the pure dataset, respectively. We ﬁrst restricted the candi-
date positions so that heterozygous SNPs were located within a
100 bp distance. Second, we excluded potential mapping errors
using human chained self-alignments, simple tandem repeats,
dbSNP 138, BLAT aligner with human decoy sequences
(37d5), and indels located nearby, in a manner similar to that
described in Section 3.1 (Supplementary Method S6). We then
conﬁrmed the advantage of using the information of heterozy-
gous germ line variants by comparing the results of HapMuC
and a version of HapMuC that does not use the information of
heterozygous germ line variants (Fig. 3A). By drawing ROC
curves (Fawcett, 2006; Robin et al., 2011), the AUC value of
HapMuC was 0.937, and that of the counterpart was 0.898
(Fig. 3B). The difference in AUCs was statistically signiﬁcant
(P-value = 0.00124). Furthermore, the version of HapMuC

 

 

Read Distance Number of Number of HapMuC HapMuC HapMuC Fisher
length candidate candidate (Paired) (Single) without SNP
SNVs (Paired) SNVs (Single)

100 0—100 635 635 0.8077 0.8032 0.5892 0.578
100— 542 0 0.7614 0.6706 0.6706 0.6177
None 5920 6462 0.6255 0.6246 0.6246 0.6262

150 0—150 939 939 0.8254 0.8147 0.5985 0.587
150— 693 0 0.6976 0.6082 0.6082 0.6151
None 5407 6100 0.6402 0.6393 0.6393 0.6052

300 0—300 1714 1714 0.8501 0.8457 0.6414 0.6222
300— 778 0 0.6779 0.6046 0.6046 0.5846
None 4916 5964 0.6285 0.6275 0.6275 0.6246

1000 0—1000 3461 3461 0.8628 0.8609 0.6302 0.6106
1000— 762 0 0.6881 0.6092 0.6092 0.6048
None 3280 4042 0.6432 0.6423 0.6423 0.6198

 

Notes: The AUC values of HapMuC of paired-end reads and single-reads, HapMuC, which does not use heterozygous germ line variants, and the Fisher method, were
compared. We also tested the methods on several read lengths (100, 150, 300 and 1000 bp). In each read length, we grouped the candidate positions by the distances between
candidate mutations and closest heterozygous germ line variants, which HapMuC used (‘Distance’ column). ‘None’ means that HapMuC could not use any heterozygous

germ line variants.

 

3306

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂ(11111 moi; popcorumoq

910K ‘09 tsnﬁnV uo 22

HapMuC

 

that does not use heterozygous variants demonstrated superior
performance compared with the simple Fisher method, suggest-
ing that HapMuC can use information other than neighboring
heterozygous germ line variants.

3.3.2 Alternative methods To compare the performance of our
approach in terms of mutation detection, we also ran VarScan 2,
SomaticSniper, Strelka and MuTect on the same datasets.
VarScan 2 is a Fisher’s exact test-based method with an indel
ﬁlter and a triallelic site ﬁlter, and SomaticSniper, Strelka and
MuTect are Bayesian modeling-based methods. We summarized
the parameters that we used for these alternative methods in
Supplementary Method S7.

3.3.3 Performance with whole-genome data We used the 60%
tumor datasets and the 40% tumor datasets of HCC1954 and
HCC1143 to benchmark the performance of mutation detection
in whole genome. For this analysis, we used the criteria in
Supplementary Method S8 and S9 for the evaluation datasets
and the pure datasets, respectively. We summarize the results
in Table 2. Overall, the AUC values of our HapMuC algorithm

 

 

   

 

 

 

 

 

 

A Scatter plot B ROC curves
. o. _
o _
8")
D. °Q _
z O
a) 8 _ o '
3 V‘ a ‘0. _
E, e — ' IE °
0 r:
a 
a, o _ st. _
a "’ °
to
m
2
. : ggmfgfcpsutztlrzqz g — o HapMuC with SNP
o q 9 o HapMuC without SNP
All _ I I I I 0 Fisher
-10 0 10 20 30  _

 

 

 

 

Bayes factor without SNP 1:0 0:8 0:6 0:4 0:2 0:0
Specificity
Fig. 3. Results obtained with the HCC1954/n40t60 dataset (TCGA
Mutation Calling Benchmark 4) in cases where heterozygous germ line
SNPs are present near candidate mutations. In (A), a scatter plot and (B)
ROC curves, the result obtained with HapMuC is compared with that of
a version of HapMuC, which does not use the information of neighboring

heterozygous germ line SNPs

were the highest under all conditions, reﬂecting superior sensi-
tivity and speciﬁcity. The AUC values of the original HapMuC
were slightly higher than that of a version of HapMuC that does
not use the information of heterozygous germ line variants. In
this analysis, HapMuC detected heterozygous germ line variants
nearby in ~15 % of all the candidate positions. In addition, we
show the ROC curves on HCC1954/n40t60 (Fig. 4). The runtime
of HapMuC for HCC1954/n40t60 was <4 h, using 48 computing
nodes. The maximum memory usage of HapMuC was 0.3 GB.
We report the runtime and memory usage of the other mutation-
calling programs and HapMuC in Supplementary Table S2.

3.3.4 Most mutations called only by the Fisher method were false
positives We focused on single nucleotide variants (SNVs) of
the HCC1954/n60t40 dataset to investigate the reasons behind
HapMuC’s superiority other than using heterozygous germ line
variants. We excluded positions that were within a 10000 bp
distance from gap locations, in addition to the criteria in
Supplementary Method S4 and S5. When we set the P—value
threshold of 0.05 for the Fisher method, the speciﬁcity was
0.744 and the sensitivity was 0.719. The BF threshold of 5 for
HapMuC resulted in a similar speciﬁcity (0.746) and a high sen-
sitivity (0.974). Based on these thresholds, most of the positions
called only by the simple Fisher method were found to be false
positives (Table 3).

3.3.5 Sequence errors caused by homopolymers We ﬁrst focused
on homopolymers near candidate mutations. We measured the
length of homopolymers that cover candidate mutations;
the stacked histograms (Supplementary Fig. S4) showed that
the false positives generated by the Fisher method involved
longer homopolymers when compared with HapMuC. The aver-
age homopolymer length of the positions that were called only by
Fisher was 8.41 and that only by HapMuC was 4.79. This dif-
ference was statistically signiﬁcant (t-test P<2.2e-16). This is
because the proﬁle HMM realignment algorithm in HapMuC
takes into account the fact that NGS mechanisms tend to in-
crease error rates in homopolymers (Albers et al., 2011). Thus,
mismatches in homopolymers have smaller weights in our haplo-
type inference and BF. In Supplementary Fig. S5, we show an

Table 2. Results obtained with whole-genome data of the TCGA Mutation Calling Benchmark 4 datasets

 

 

Type Sample Number of Number of with HapMuC HapMuC VarScan2 Strelka MuTect SomaticSniper
candidates heterozygous germ without
line variants SNP

SNVs HCC1954/n40t60 6153 936 0.8145 0.8088 0.7192 0.7878 0.7638 0.713
HCC1954/n60t40 4442 693 0.9333 0.9327 0.8286 0.9236 0.9203 0.7291
HCC1143/n40t60 7080 995 0.864 0.8578 0.7764 0.8397 0.8444 0.7108
HCC1143/n60t40 4451 735 0.9601 0.9594 0.8566 0.9406 0.946 0.7013

Indels HCC1954/n40t60 762 100 0.7433 0.7412 0.6145 0.7261 — —
HCC1954/n60t40 437 67 0.729 0.7303 0.6184 0.72 — —
HCC1143/n40t60 349 45 0.72 0.7135 0.6181 0.7132 — —
HCC1143/n60t40 243 39 0.7524 0.7457 0.6833 0.7381 — —

 

Notes: The number of candidate positions (Number of candidates), the number of candidate positions where HapMuC used heterozygous germ line variants (Number of
candidates with heterozygous germ line variants) and the AUC values of HapMuC, HapMuC that does not use heterozygous germ line variants, VarScan 2, Strelka, MuTect

and SomaticSniper. The candidate positions are positions that passed the minimum criteria (Supplementary Method S8).

 

3307

112 ﬂJO'SIBHJHO[plOJXO'SODBIILIOJHIOIQ/[I(11111 moi; popcorumoq

910K ‘09 tsnﬁnV uo 22

N.Usuyama et al.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A SNVs B Indels
o O _
°° °°. _
O 0
a:- a3-
.“ .6
e s
a) g- — m g —
0 HapMuC with SNP
O HapMuC without SNP O HapMuC with SNP
c‘I _ 0 VarScan2 A! _ O HapMuC without SNP
o O Strelka o 0 VarScan2
0 MuTect O Strelka
o O SomaticSniper o
o' ' o' '
I I I I I I I I I I I I
1.0 0.8 0.6 0.4 0.2 0.0 1.0 0.8 0.6 0.4 0.2 0.0
Specificity Speciﬁcity

Fig. 4. Benchmarking mutation-detection methods for the whole genome
using the HCC1954/n60t40 dataset (TCGA Mutation Calling Benchmark
4). The ROC curves of HapMuC (red), HapMuC, which does not use
heterozygous germ line variants (blue), VarScan 2 (black), Strelka
(orange), MuTect (Purple) and SomaticSniper (green) in (A) SNVs and
(B) Indels

Table 3. The number of somatic SNVs called by HapMuC and the
simple Fisher method in the whole genome from the HCC1954/n40t60
dataset (TCGA Mutation Calling Benchmark 4)

 

 

Type Both Only by Only by
HapMuC Fisher

True positive 2461 897 15

False positive 760 945 959

 

Notes: The threshold for HapMuC BF was 5, and that for the simple Fisher method
was 0.05. Note that we excluded positions within a 10000 bp distance from gap
locations.

example of false positive calls of the Fisher method in a long
homopolymer.

3.3.6 Dealing with reads with several mismatches We also inves-
tigated the number of mismatches within a 100 bp distance from
candidate mutations. The stacked histograms (Supplementary
Fig. S6) showed a trend that candidate mutations accompanying
several mismatches might be false positives. The average number
of mismatches near the candidate mutations that were called
only by the Fisher method was 4.82, and that only by
HapMuC was 1.85 (t-test P<2.2e-16). This is because the
reads, which contain several mismatches with relatively high
base qualities, are judged not to be mapped to any of the pre-
pared haplotypes, but are mapped to different locations in the
genome during the calculation of alignment probabilities. Thus,
those reads are ignored in our haplotype inference and have no
impact on the BF. In Supplementary Figure S7, we show a rep-
resentative false positive call by the Fisher method.

3.4 Estimation of sensitivity using real data

We used the COLO-829, malignant melanoma cell line, and
COLO-829BL, a lymphoblastoid line, to evaluate the sensitivity
of our method. The data were downloaded from the European
Genome-Phenome Archive (accession number EGAS00000
000052), and we used the list of validated somatic SNVs

(n = 497) and validated somatic indels (n = 66) (Pleasance
et al., 2010). These variants were converted to hg19 from their
positions on the hg18 reference using the University of California
Santa Cruz (UCSC) Genome Browser liftover utility. We called
494 SNVs, with a sensitivity of 99.4%, and 32 indels, with a
sensitivity of 48.5%. In both cases, the sensitivity was compar-
able with or higher than that of the counterpart methods
(Supplementary Method S10).

4 DISCUSSION

In this article, we addressed the problem of accurately detecting
somatic mutations in cancer by using tumor and matched normal
NGS sequences. Based on 10 ccRCC patients’ data, we observed
that true somatic mutations mostly occurred on one of two
normal haplotypes; however, sequencing errors occurred ran-
domly on normal haplotypes. Based on this observation, we de-
veloped a novel Bayesian statistical method, HapMuC, which
can use the information of heterozygous germ line variants
located near candidate mutations.

In our simulation study, we demonstrated that our algorithm
has superior performance compared with a simple Fisher method
when a candidate mutation occurs near a heterozygous germ line
variant. We also tested our algorithm on several read lengths
(100, 150, 300 and 1000 bp) as well as single-end reads and
paired-end reads; HapMuC achieved higher AUC values with
longer reads and paired reads by using additional information.
For calculating the likelihood of read pairs, we approximated it
by multiplying the alignment likelihoods of the ﬁrst and second
read, which assumes that read pairs are generated independently
given the haplotype. However, we should modify our modeling
for read pairs, considering their insertion size distribution, as a
read-pair usually comes from a fragment.

We also conﬁrmed the advantages of using heterozygous germ
line variants based on breast cancer cell line samples, which are
publicly available as a part of the TCGA Mutation Calling
Benchmark 4 datasets. In this experiment, we excluded potential
alignment artifacts by using some genomic annotations, a BLAT
ﬁlter with human decoy sequence (37d5) and an indel ﬁlter be-
cause mapping errors can confuse the haplotype inference of our
algorithm. However, detecting and eliminating alignment errors
appropriately remains a problem.

Additionally, we evaluated our algorithm in the context of a
whole genome using the TCGA Mutation Calling Benchmark 4
datasets. We compared the results of HapMuC with those of the
simple Fisher method, Bayesian methods, which includes Strelka,
MuTect and SomaticSniper, and VarScan 2, which is based on
Fisher’s exact test but which uses some ﬁlters. For both SNVs
and indels, our method shows higher AUC values than the al-
ternative methods. During subsequent manual inspection using
Integrative Genomics Viewer (IGV) (Thorvaldsdéttir et al.,
2013), we conﬁrmed that HapMuC succeeded in using contextual
information, such as mismatches and homopolymers, near can-
didate mutations. Although several ﬁltering approaches have
been proposed, to date, no somatic mutation caller that inte-
grates the contextual information into its score has been avail-
able. Furthermore, the analysis using the COLO-829 dataset with
the list of validated somatic mutations (Pleasance et al., 2010)

 

3308

112 ﬁlm'srcumoprOJXO'sor112u1101utorq//2d11q wort popcorumoq

910K ‘09 tsnﬁnV uo 22

HapMuC

 

showed that our algorithm has sensitivity better than or compar-
able with that of the existing methods.

For future studies, we intend to incorporate further informa-
tion into our algorithm. First, sequence strand bias, which is
suggested as a false-positive ﬁlter by SomaticSniper, VarScan
2, MuTect and so on, could be considered. We can integrate
the information of strand bias into HapMuC’s score by extend-
ing our generative model. Second, we may consider the distance
to the effective 3’ end, which is suggested as an additional ﬁlter by
SomaticSniper. We can achieve this by modifying the proﬁle
HMM alignment algorithm to consider the distances from the
edges of reads. In addition, when sequencing data of other sam-
ples are available, we can infer background error rates and use
these as prior information. A recent statistical approach, called
EBCall (Shiraishi et al., 2013), has succeeded in achieving out-
standing performance using pooled normal samples. MuTect
also uses a simple false-positive ﬁlter, which checks whether can-
didate mutations exist in other normal samples. In terms of stat-
istical modeling, if we could modify the mutation model and the
error model as a nested model-pair, we can use a variable selec-
tion approach, such as lasso, for detecting somatic mutations.

ACKNOWLEDGEMENTS

The super-computing resource was provided by Human Genome
Center, the Institute of Medical Science, the University of
Tokyo.

Funding: This work was partly supported by Grant-in-Aid for
Scientiﬁc Research on Innovative Areas (22134004).

Conflict of interest: none declared.

REFERENCES

Albers,C.A. et al. (2011) Dindel: accurate indel calls from short-read data. Genome
Res., 21, 961—973.

Beal,M.J . (2003) Variational Algorithms for Approximate Bayesian Inference. PhD
thesis, The Gatsby Computational Neuroscience Unit, University College
London, London, UK.

Benson,G. (1999) Tandem repeats ﬁnder: a program to analyze DNA sequences.
Nucleic Acids Res., 27, 573.

Blei,D.M. et al. (2003) Latent dirichlet allocation. J. Mach. Learn. Res., 3,
993—1022.

Bradley,A.P. (1997) The use of the area under the ROC curve in the evaluation of
machine learning algorithms. Pattern Recognit., 30, 1145—1159.

Chiaromonte,F. et al. (2002) Scoring pairwise genomic sequence alignments. In:
Pacific Symposium on Biocomputing. Vol. 7, pp. 115—126.

Cibulskis,K. et al. (2013) Sensitive detection of somatic point mutations in impure
and heterogeneous cancer samples. Nat Biotechnol., 31, 213—219.

Cilibrasi,R. et al. (2005) On the complexity of several haplotyping problems. In:
Algorithms in Bioinformatics. Springer, pp. 128—139.

Ding,L. et al. (2012) Clonal evolution in relapsed acute myeloid leukaemia revealed
by whole-genome sequencing. Nature, 481, 506—510.

Eddy,S.R. (1998) Proﬁle hidden Markov models. Bioinformatics, 14, 755—763.

Fawcett,T. (2006) An introduction to ROC analysis. Pattern Recognit. Lett., 27,
861—874.

Forbes,S.A. et al. (2011) COSMIC: mining complete cancer genomes in the
Catalogue of Somatic Mutations in Cancer. Nucleic Acids Res., 39, D945—D950.

Genovese,G. et al. (2013) Mapping the human reference genomes missing sequence
by three-way admixture in latino genomes. Am. J. Hum. Genet, 93, 411—421.

Genovese,L.M. et al. (2008) Speedhap: an accurate heuristic for the single individual
SNP haplotyping problem with many gaps, high reading error rate and low
coverage. IEEE/ACM Trans. Comput. Biol. Bioinform, 5, 492—502.

Goya,R. et al. (2010) SNVMix: predicting single nucleotide variants from next-
generation sequencing of tumors. Bioinformatics, 26, 730—736.

He,D. et al. (2010) Optimal algorithms for haplotype assembly from whole-genome
sequence data. Bioinformatics, 26, i183—i190.

Kent,W.J. (2002) BLAT-the BLAST-like alignment tool. Genome Res., 12, 656—664.

Kent,W.J. et al. (2003) Evolution’s cauldron: duplication, deletion, and rearrange-
ment in the mouse and human genomes. Proc. Natl Acad. Sci. USA, 100,
1 1484—1 1489.

Koboldt,D.C. et al. (2012) VarScan 2: somatic mutation and copy number alter-
ation discovery in cancer by exome sequencing. Genome Res., 22, 568—576.
Larson,D.E. et al. (2012) SomaticSniper: identiﬁcation of somatic point mutations

in whole genome sequencing data. Bioinformatics, 28, 311—317.

Ley,T.J. et al. (2008) DNA sequencing of a cytogenetically normal acute myeloid
leukaemia genome. Nature, 456, 66—72.

Meyerson,M. et al. (2010) Advances in understanding cancer genomes through
second-generation sequencing. Nat Rev. Genet, 11, 685—696.

Nik-Zainal,S. et al. (2012) The life history of 21 breast cancers. Cell, 149, 994—1007.

Pleasance,E.D. et al. (2010) A comprehensive catalogue of somatic mutations from
a human cancer genome. Nature, 463, 191—196.

Robin,X. et al. (2011) pROC: an open-source package for R and S + to analyze and
compare ROC curves. BM C Bioinformatics, 12, 77.

Roth,A. et al. (2012) J ointSNVMix: a probabilistic model for accurate detection of
somatic mutations in normal/tumour paired next-generation sequencing data.
Bioinformatics, 28, 907—913.

Sato,Y. et al. (2013) Integrated molecular analysis of clear-cell renal cell carcinoma.
Nat Genet, 45, 860—867.

Saunders,C.T. et al. (2012) Strelka: accurate somatic small-variant calling from
sequenced tumor-normal sample pairs. Bioinformatics, 28, 1811—1817.

Schwartz,S. et al. (2003) Human-mouse alignments with BLASTZ. Genome Res.,
13, 103—107.

Shah,S.P. et al. (2009) Mutational evolution in a lobular breast tumour proﬁled at
single nucleotide resolution. Nature, 461, 809—813.

Sherry,S.T. et al. (2001) dbSNP: the NCBI database of genetic variation. Nucleic
Acids Res., 29, 308—311.

Shiraishi,Y. et al. (2013) An empirical Bayesian framework for somatic mutation
detection from cancer genome sequencing data. Nucleic Acids Res., 41, e89—e89.

Thorvaldsdéttir,H. et al. (2013) Integrative Genomics Viewer (IGV): high-perform-
ance genomics data visualization and exploration. Brief. Bioinform, 14,
178—192.

Yoshida,K. et al. (2011) Frequent pathway mutations of splicing machinery in
myelodysplasia. Nature, 478, 64—69.

 

3309

112 /810's112umoprOJXO'sor112u1101utorq//2d11q wort popcorumoq

910K ‘09 tsnﬁnV uo 22

