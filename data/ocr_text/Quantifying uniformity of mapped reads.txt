APPLICA TIONS NOTE V°" ibﬁ‘éﬁa‘iliaiﬁzﬂiffﬁiﬁ

 

Sequence analysis

Advance Access publication July 18, 2012

Quantifying uniformity of mapped reads

Valerie Hower‘, Richard Starfield2, Adam Roberts3 and Lior Pachter3’4’5’*

1Department of Mathematics, University of Miami, Coral Gables, FL 33146, 2Department of Environmental Science,
3Department of Electrical Engineering and Computer Science, 4Department of Mathematics and
5Department of Molecular and Cell Biology, University of California, Berkeley, California 94720, USA

Associate Editor: Martin Bishop

 

ABSTRACT

Summary: We describe a tool for quantifying the uniformity of
mapped reads in high-throughput sequencing experiments. Our stat-
istic directly measures the uniformity of both read position and frag-
ment length, and we explain how to compute a P—value that can be
used to quantify biases arising from experimental protocols and map-
ping procedures. Our method is useful for comparing different proto-
cols in experiments such as RNA-Seq.

Availability and implementation: We provide a freely available and
open source python script that can be used to analyze raw read data
or reads mapped to transcripts in BAM format at http://www.math
.miami.edu/~vhower/ReadSpy.html

Contact: lpachter@math.berkeley.edu

Supplementary Information: Supplementary data are available at
Bioinformatics online.

Received on September 20, 2012; revised on July 4, 2012; accepted
on July 5, 2012

1 INTRODUCTION

In biological experiments, controlling the quality of data is fun-
damental to the reliability and reproducibility of the results.
Quality control is especially important in modern sequencing
experiments, where small biases in the preparation of DNA
libraries can be ampliﬁed in the subsequent sequencing steps
which typically yield millions of reads. Sequenced reads ideally
represent fragments sampled uniformly at random from a li-
brary, and expected coverage statistics can be obtained from
the classic Lander—Waterman model Lander and Waterman
(1988). However, a key aspect of current experiments is variable
fragment length, requiring the extension of the Lander—
Waterman model to account for random fragment position
as well as length. Such a generalization was described in
Evans et al. (2010) where it was shown that the data from a
sequencing experiment can be modeled by a two-dimensional
spatial Poisson process. We present a statistical test for uniform-
ity in the reads of a sequencing experiment based on this idea
and show how it can be used to compare multiple sets of reads
in order to assess different protocols. Our test requires the align-
ment of paired-end reads to a reference transcriptome so that
fragment positions and lengths can be determined. Fortunately,
such alignments are routinely produced after sequencing experi-
ments, so that our test can easily be incorporated into sequencing
analysis pipelines.

 

*To whom correspondence should be addressed.

2 METHODS

An aligned read can be represented as an integer point in R2 as follows:
The ‘t-coordinate’ corresponding to the read is its left-end point while
the ‘l—coordinate’ is the length of the fragment. In Evans et a]. (2010),
it is shown that for any choice of fragment length distribution, the col-
lection of points {(t, 1)} from a sequencing experiment forms
a two-dimensional Poisson process. This principle guides our further
analysis of these points {(t, 1)}, as we test for uniformity in both the t
and l coordinates. The output of ReadSpy is a list of test statistics and
P—values for each transcript. A statistically signiﬁcant (low) P-value
means we reject the fact that the dataset is uniform on that transcript.
Thus, a higher P—value corresponds to a set of reads sampled uniformly,
which is desired. In the next two sections, we describe the statistical test
applied a each transcript. The test is formulated in terms of the genomic
segment [a, b].

We handle ambiguous reads in ReadSpy by ﬁrst reporting all possible
alignments, using eXpress Roberts and Pachter (Submitted for publica-
tion) (http://bio.math.berkeley.edu/eXpress/) to assign a probability to
each alignment and then selecting one t-value per fragment according
to the observed probabilities.

2.1 Hypothesis test for dataset

First, we describe the statistical test for a set of aligned reads from one
sequencing experiment. The (t, l) coordinates corresponding to reads
aligned to [a, b] satisfy

tau and t+l§b.

We deﬁne shifted coordinates in the (x, y)-plane as follows:

t — a
x = — and = l.
b — l — a y

The new point set S of transformed datapoints satisﬁes
x E [0, 1], y e [0, co) and is still homogeneous along the x-axis.

We use a simple x2 statistic to test this partial homogeneity assumption
using test constants C and D. First, we partition the points into horizontal
strips

Hk = {(XiJi) E Slbk—1<yi S bk},

where —oo = bo<b1<b2< . . .<bm 2 co and the boundaries bk are chosen
such that each |Hk| 2 C. Next, we ignore the y-coordinates within each
strip and test the uniformity of the x coordinates. We divide the interval
[0, 1] into D subintervals and deﬁne

ij = NOW”) 6 HklU-1)/D<X Sj/DH-

If the original point set forms a spatial Poisson process, then

d
T1. = 2m]..- — Elf/E1. ~ xiH,
j=1

 

© The Author 2012. Published by Oxford University Press on behalf of The Society for Financial Studies. All rights reserved. For Permissions, please e—mail:

journals.permissions.com.

112 ﬂJO'slcumo[pJOJXO'sonchogurorq/ﬁd11q moi; popcolumoq

910K ‘09 lsnﬁnV no :2

Quantifying mapped reads

 

‘I'JL1411W

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

+
g— f
i .'
I .1
E I
§_ " h I: III " 1%.
I I“. I‘ll: :'l. min;' “*1;
-II '- .I;:+l .' I. tﬂ-I ." 'F I: :2: I
§_ 1- : I... 5::igH‘|-.*I.1 ‘1 h 'n.
' "' “r. ='-~..-. '= *+ 5* *:‘:
It'll I. ﬂ ‘ I ‘l‘ ~‘II '1‘ I. l I III-I 
1.3—-
I I I I I I
I} 1m 2m 311' 40a EDD

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

+
g-
h -
I
g— I- ‘ " l " I.
i 4 I I‘
l..- IF' I. I I'll Ii. I 1.51" I I.
_ ' ‘ .-: 'I. I II ﬂ‘ + i
— I _'_ .4. 'h. +1 r... if." i I... ii
‘1. I I .‘l- *Iﬁl‘I‘I- liq. lull. .p't
_ 1 ‘,
g _ .
CLD {1.2 0.4 0.5 {1.8 LU

It

Fig. 1. An illustration of the method. Fragments aligning to the Yeast genes YJL140W (A) and YKL041W (B) using dUTP protocol for RNA-Seq
are depicted before (t, l—coordinates) and after (x, y-coordinates) our transformation. The horizontal boundaries in the (x, y)-plane are selected by
requiring at least C: 200 points fall in each subdivision while the D = 20 vertical subdivisions are equally spaced. When comparing the these dUTP
data sets to those from other RNA-Seq protocols, the point set in A is highly biased with a p-value of 1.2e—19 while B appears to be a random collection

of points (p = 0.27)

where Ek 2 ED“. Since all T ks come from mutually independent strips, we
have

m

E Tk N sznD—m'
k=1

This allows us to calculate a P-value for the collection of aligned reads.
This value may vary depending on the choice of constants C and D—a
reasonable choice seems to be C: 200 and D = 20. Figure 1 shows the
aligned reads for two yeast genes both in the (t, l)-plane and the (x, y)-
plane. We also depict the vertical and horizontal grids for C: 200 and
D220. The raw reads come from an RNA-Seq experiment using the
dUTP protocol Levin et al. (2010) and were aligned to the yeast
genome using Bowtie Langrnead et a]. (2009) using the ‘-X 600 -aS -n 3
-e 100’ option.

2.2 Comparing multiple datasets

Assume we want to compare multiple sets of reads aligned to the same
genomic interval [a, b]. Since the P—value of the above test depends on
how the plane is divided into strips, the boundaries bk are chosen to be
the same across all the transformed point sets Si, i = 1, . . . , n. We impose
the requirement that for each point set Si, the horizontal strip Hk(i)
contains at least C points. The resulting Hk(i)s are then subsampled to
produce H20) such that for all i, we have

|H3.(i)l = .min lHkO‘)I-
j:1,...,l’l
We then apply our statistical test to each point set S,- using the hori-

zontal strips H}€(i) with vertical subdivisions given by the constant D as
above.

3 RESULTS

We applied our statistical test to examine a variety of popular
RNA-Seq protocols. Using data analyzed in Levin et al. (2010),
we compare seven paired-end methods on 1464 transcripts in the
yeast genome. Supplementary Table S1 gives transcript-
by-transcript summary statistics for the log probabilities.
There are multiple criteria for selecting an RNA-Seq protocal,
but using ReadSpy we ﬁnd that the dUTP protocol is statistically
most random—meaning least biased—which agrees with Levin
et al. (2010). Additionally, we make pairwise comparisons between
the methods, which can be found in Supplementary Table S2. For
each pair, the binomial test addresses statistically whether or not
one method ‘wins’ on more often than the other. The P—values for
this test are also listed in Supplementary Table S2. Our ﬁndings
mostly agree with the results of Levin et al. (2010); however, our
method illustrates the variability in sequence uniformity among
genes. For instance, Figure 1 gives the point sets for dUTP proto-
col and two yeast genes: YDR007W (in A) and YJL078C (in B).
When comparing all seven methods, dUTP achieved
p = 1.2e — 19 for YJL140W and p: .27 for YKL041W. A low
P—value indicates that the reads aligning to the transcript are not
uniform, which is undesirable. One can visually see the difference
in Figure 1 between non-random (in A) and random (in B).

Funding: V.H. was funded in part by NSF fellowship
DMS-0902723. AR and LP. were funded in part by NIH R01
HG006129. AR. was also funded in part by an NSF graduate
research fellowship.

 

2681

112 ﬂJO'spaumo[pJOJXO'sonchOJquIq/ﬁd11q moi; popcolumoq

910K ‘09 lsnﬁnV no :2

V.Hower et aI.

 

Conﬂict of Interest: none declared.

REFERENCES

Evans,S. et a]. (2010) Coverage statistics for sequence census methods. BMC
Bioinformatics, 11, 430.

Lander,E. and Waterman,M. (1988) Genomic mapping by ﬁngerprinting random
clones: a mathematical analysis. Genomics, 2, 231—239.

Langmead,B. et a]. (2009) Ultrafast and memory-efﬁcient alignment of short DNA
sequences to the human genome. Genome Biol., 10, R25.

Levin,J.Z. et a]. (2010) Comprehensive comparative analysis of strand-speciﬁc RNA
sequencing methods. Nat. Meth., 7, 709—715.

 

2682

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq wort pepeolumoq

910K ‘09 lsnﬁnV uo 22

