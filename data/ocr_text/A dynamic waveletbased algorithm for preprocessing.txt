ORIGINAL PAPER

Vol. 26 no. 18 2010, pages 2242-2249
doi: 10. 1093/bioinformatics/btq403

 

Sequence analysis

Advance Access publication July 13, 2010

A dynamic wavelet-based algorithm for pre-processing tandem

mass spectrometry data

Penghao Wang”, Pengyi Yang2’3, Jonathan Arthur4 and Jean Yee Hwa Yang1

1School of Mathematics and Statistics, 2School of Information Technologies, University of Sydney, 3National ICT
Australia, Australian Technology Park and 4Discipline of Medicine, Sydney Medical School, University of Sydney,

Australia
Associate Editor: John Quackenbush

 

ABSTRACT

Motivation: Mass spectrometry (MS)-based proteomics is one of
the most commonly used research techniques for identifying and
characterizing proteins in biological and medical research. The
identification of a protein is the critical first step in elucidating
its biological function. Successful protein identification depends
on various interrelated factors, including effective analysis of MS
data generated in a proteomic experiment. This analysis comprises
several stages, often combined in a pipeline or workflow. The first
component of the analysis is known as spectra pre-processing. In
this component, the raw data generated by the mass spectrometer
is processed to eliminate noise and identify the mass-to-charge ratio
(m/z) and intensity for the peaks in the spectrum corresponding
to the presence of certain peptides or peptide fragments. Since
all downstream analyses depend on the pre-processed data,
effective pre-processing is critical to protein identification and
characterization. There is a critical need for more robust pre-
processing algorithms that perform well on tandem mass spectra
under a variety of different conditions and can be easily integrated
into sophisticated data analysis pipelines for practical wet-lab
applications.

Result: We have developed a new pre-processing algorithm. Based
on wavelet theory, our method uses a dynamic peak model to
identify peaks. It is designed to be easily integrated into a complete
proteomic analysis workflow. We compared the method with other
available algorithms using a reference library of raw MS and tandem
MS spectra with known protein composition information. Our pre-
processing algorithm results in the identification of significantly more
peptides and proteins in the downstream analysis for a given false
discovery rate.

Availability: Software available at: http://www.maths.usyd.edu.au/
u/penghao/index.html

Contact: penghao.wang@sydney.edu.au

Received on March 16, 2010; revised on June 24, 2010; accepted
on July 04,2010

1 INTRODUCTION

Mass spectrometry (MS)—based proteomics enables studies of
the complexity and dynamics of proteins in biological systems
(Anderson and Anderson 1998, Blackstock and Weir, 1999).
It involves the identiﬁcation and characterization of the entire set

 

*To whom correspondence should be addressed.

ITH‘ﬁD

Flaw Peal: Flaw-urn":
Spectra Liata
- 111‘” I. "a
I  .I .'. 11?
._|_. + _ '1' : .-
i l l “MAIN-Ida! ' I1 __ __._J_J_,J_.__.__u
 .' tlF'ﬂT-Eluﬂl + +
4 mum-Luv.” - l'
Guam!”
4... .  . Pam-Gem Pm'ldnlD Pmlni-‘m

Fre-pmoeﬂsing F'rutein Identiﬁcation Proteln Quantiaatlon

Fig. 1. A typical proteomic data analysis workﬂow and its major
components. This includes pre—processing for peak determination, peptide
and protein identiﬁcation and quantization.

of proteins expressed by the genome as well as understanding
changes in protein expression levels and how proteins interact with
each other (Wilkins et al., 1997). Increasingly, many scientiﬁc
investigators are using tandem MS (MS/MS) for high—throughput
protein identiﬁcation and quantiﬁcation. In recent years, there has
been rapid development in MS technology. The development of
methods, such as isobaric tag for relative and absolute quantitation
(iTRAQ) (Unwin et al., 2005), provides researchers with powerful
techniques to determine the relative expression levels of thousands
of proteins simultaneously. The precise identiﬁcation of proteins is
crucial in developing new diagnostic, prognostic and therapeutic
products for the treatment of human diseases such as cancer, asthma
and diabetes (Anderson and Anderson 2002). Furthermore, accurate
quantitative protein expression information enables scientists to
reliably determine the proteins critical to speciﬁc biological
functions and provides a powerful mechanism to identify disease
biomarkers and to design more effective medicines (Hanash, 2003).
However, accurate statistical analysis of raw tandem spectrum data
remains a challenging task.

Current statistical and computational analysis of MS data involves
several challenges. After acquiring raw spectra from a mass
spectrometer, it is necessary to pass through all components of
a complete data analysis workﬂow in order to obtain the ﬁnal
results. The complete data analysis workﬂow, as illustrated in
Figure 1, can be sub—divided into several analysis components:
spectra pre—processing, peptide and protein identiﬁcation and protein
quantiﬁcation.

The ﬁrst step in pre—processing involves identifying and locating
peaks within raw MS and MS/MS spectra. These peaks (where
by ‘peaks’ we refer to any peak—shaped signals) may correspond
to the presence of peptides or peptide fragments in the sample.

 

2242 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /§JO'SIBUJHO[p.IOJXO'SOllBIHJOJUTOTQ/ﬁdnq U101} pepBOIUAAOG

9IOZ ‘Ig1sn8nv uo ::

Wavelet-based algorithm for pre-processing tandem MS data

 

As the spectrum is usually tempered with a variety of other
features, such as electrical and chemical noise, machine artifacts
and contamination, the correct identiﬁcation of peaks is difﬁcult.
Pre—processing must address each of these problems: this often
involves several different procedures including: noise removal,
baseline removal, peak detection, peak centroiding and intensity
estimation. Depending on the MS ionization technology, peptides
may also carry more than one charge. As this information is also
critical to downstream protein identiﬁcation algorithms, another
important task for pre—processing algorithms is to correctly estimate
the peptide charge state.

Pre—processing has great impact on the downstream protein
identiﬁcation and quantization analyses (Ong et al., 2003; Yu et al.,
2005; Zhang et al., 2002). All protein database search engines and
de novo sequencing algorithms (Cagney and Emili, 2002) depend
on the quality of peak information used as input to their algorithms.
Although there are a number of methods for pre—processing MS—level
spectra, there is a lack of available algorithms speciﬁcally designed
for MS/MS protein analysis workﬂow. Most available and widely
used methods are based on signal intensity. These methods may
produce unsatisfactory results and increase the false positive rate in
real applications (Renard et al., 2009). Pre—processing should thus
be properly addressed in order to obtain more reliable downstream
protein identiﬁcation and quantization analysis.

There are a number of available precursor—level MS pre—
processing algorithms, and they may be broadly classiﬁed into three
categories: (i) intensity—based approaches; (ii) peak modeling—based
approaches; and (iii) wavelet—based methods.

Intensity—based approaches use certain thresholds to ﬁlter weak
signals, leaving the most intense peaks. Such methods include
sziff (Pedrioli et al., 2004) provided by the Trans—Proteomic
Pipeline (TPP) (Pedrioli, 2010), wiff2dta (Boehm et al., 2004) and
InsPecT (Tanner et al., 2005). Many protein identiﬁcation engines,
for example OMSSA (Geer et al., 2004) and XlTandem (Craig
and Beavis, 2004), apply a simple intensity—based method before
initiating the protein identiﬁcation search algorithm. Intensity—based
methods can be improved by using predeﬁned mass—to—charge ratio
(m /z) intervals as in MaxQuant (Cox and Mann, 2008). These are
the most commonly used methods and their main advantage is their
simplicity. However, real peptide fragment signals can be weaker
than spectrum noise. Thus, the limitation of these approaches is that
they sometimes fail to detect peaks leading to a signiﬁcant decrease
in the performance of downstream analyses. Some methods apply
signal ﬁlters before applying the intensity—based peak selection to
improve accuracy. For example, MEND (Andreev et al., 2003) uses a
matched ﬁlter as the starting point (it also applies other techniques),
PROcess (Li et al., 2005) uses a moving average ﬁlter, MZmine
(Katajamaa et al., 2006) uses a Savitzky—Golay ﬁlter, and LIMPIC
(Mantini et al., 2007) uses a Kaiser Window Filter. However, these
ﬁlters may cause distortion of the spectra and it is often hard to
tell whether all the noise has been successfully ﬁltered or whether a
signiﬁcant proportion remains in the signal.

Peak modeling—based approaches (Gentzel, 2003; Gras et al.,
1999; Lange et al., 2006; Qu et al. 2003; Randolph and Yasui
2005) are pre—processing algorithms that try to take advantage of
additional information other than signal intensity. As MS peaks
have characteristic shapes and patterns based on the particular
instruments used, the unique peptide signal shape provides a
powerful means to identify real peaks from white and colored

Tradiuunal Approach

 

||.:I.~.Ir||r'n: '—'I:.:Jll. II II I".

I-‘.r_'-rr:u:u'.'::|| I.'_‘.r_':r:lr::.q-:jlr'|.r:;.

 

 

 

 

R 1*
aw .
Intanslly
Spectra I _ —1~ Est-manor:
Den-:IIEIng
- if
BEBE-IMF: CIT-3'13? 5‘3“?
RENE-gal 
Fcalr. JD 5. It
{Hier‘lrrrt-II‘HI'IE; m.l.m$[r&arr
Analyse

Continuous- Wavelel Approach

Fig. 2. Simpliﬁed procedure of CWT—based proteomic pre—processing.

noise. These methods normally use peak width as the matching
criterion to reduce false positives in peak identiﬁcation. In real—
life applications, this approach may become difﬁcult because peaks
have complex patterns, and various interferences such as noise can
make the peak width estimation difﬁcult. The peak shape and width
depend on a number of factors. In addition, the width and height of
real peaks can vary signiﬁcantly across different spectra. Even in
the same spectrum, peaks with high m/z values are usually wider
and lower in amplitude compared to ones with low m/z values.
Thus, simple and static peak models tend to produce highly variable
and unreliable results in real applications (Du et al., 2006). Some
methods are based on models even involving more information. Gras
et al. (1999) introduces an averaging model studying MALDI MS
spectra; Gay et al. (1999) described a method using a theoretically
peptide model. These approaches involve sophisticated algorithms
and strong theoretical merits, and remain good options for pre—
processing the MS—level spectra for which they were designed.
Nevertheless, the fragmentation and peak patterns of MS/MS spectra
are more complex than MS spectra and a more general approach is
also desirable.

Wavelet—based methods can be categorized into discrete wavelet
(DWT) methods and continuous wavelet (CWT) methods. DWT
methods are generally utilized as noise ﬁlters, e.g. Cromwell method
(Coombes et al., 2005). CWT methods can be utilized for several
procedures of the pre—processing. First, it is possible to identify
peaks without explicitly removing disturbing artifacts by using
CWT analysis. With CWT methods, baseline, noise and the real
signal can be separated by their different frequency ranges. A well—
designed CWT method, which respects the speciﬁc characteristics of
peptide signals, renders additional noise ﬁlters unnecessary, as noise—
ﬁltering is spontaneously achieved by wavelets. This is demonstrated
in Figure 2. As shown, the procedure for a traditional pre—processing
algorithm requires ﬁve separate steps. With CWT methods, the
procedure can be simpliﬁed to three steps as given in Figure 2.
Therefore, the peak shape and characteristics are easier to identify
by wavelet coefﬁcients. Another advantage of CWT methods is peak
modeling. Du et al. (2006) described a method (MassSpecWavelet)
which directly utilizes the CWT coefﬁcients matrix of the spectrum
to identify peaks. By using a range of scaled wavelets, the method
can detect peaks with a lower false positive rate and better signal to
noise ratio (SNR). The disadvantage of this method is the arbitrary
selection of a large range of scales and the inability to select the
most relevant scales. Such a static model may perform well in a
speciﬁc situation; however, it may become difﬁcult when wavelets
are incorrectly selected and this may signiﬁcantly increase false

 

2243

112 /§JO'SIBUJHOIPJOJXO'SOllBIHJOJUIOIQ/ﬁdnq 11101; popaommoq

9IOZ ‘lg lsnﬁnv uo ::

R Wang et aI.

 

positives. Thus it is desirable to have a good algorithm to correctly
determine the best matching wavelets as the peak model.

Even though as mentioned there are a number of pre—processing
methods available for MS—level data, many algorithms are designed
for a speciﬁc type of instrument and do not support MS/MS
spectra pre—processing. In addition, many methods were developed
on different platforms, and are difﬁcult to integrate into analysis
pipelines. sziff is one of the few methods able to read the
standard open format and support downstream proteomic analysis,
although it is not unique in this regard. This lack of available
downstream ‘pipeline ready’ MS/MS pre—processing algorithms
seriously undermines the reliability of the protein identiﬁcation and
quantization.

We have developed a new wavelet—based MS and MS/MS
pre—processing algorithm, called the Dynamic Wavelet Approach
(DyWave), to address the shortcomings found in existing methods.
It supports a wide array of instruments and it dynamically adjusts the
peak model to achieve better performance. The algorithm is designed
as an integrated component of the complete data analysis workﬂow
(Wang et al., 2009). Finally, our method does not detect the peaks
using only intensity, but takes additional information regarding peak
shape into account. In addition, it is one of the few algorithms that
incorporate an effective method to estimate peptide charge.

In this article, we set out the statistical details of our model and
its implementation. We then demonstrate the performance of our
algorithm by comparing to other available methods using large—
scale datasets obtained from different instruments. Our algorithm
performs signiﬁcantly better in the compared criteria including the
number of correct identiﬁcation at the peptide and protein level, the
false discovery rates (FDRs) at both levels, and the ﬁnal SNR. At
the same FDR, up to 30% and 15% more proteins can be identiﬁed
compared to methods provided in TPP and commercial software
from Applied Biosystems.

2 MATERIALS AND METHODS

We introduce the dynamic peak model in our proposed method, followed
by a brief step—by—step description of our method, and ﬁnally the evaluation
study used to assess the performance of our method.

2.1 The dynamic wavelet peak model

Based on CWT, we propose a novel method that applies a dynamic model
to achieve better accuracy. The CWT transform can be formulated as:

Cl

1 —b
C(aab)=fs(f)lﬁa,b (0,10%!) (f)=—10(t—),
J5
R (1)

aeRT—{O},beR,

where 50‘) is the signal, a is the scaling factor, b is the translation factor,
that) is the scaled and translated mother wavelet and C is the wavelet
coefﬁcient. Coefﬁcients reﬂect the pattern matching between the signal s
and the mother wavelet 100,1,0). The wavelet technique has an analytical
advantage because it provides freedom in the choice of mother wavelets.
By using different parameters, the daughter wavelets 100, b(t) can therefore
provide a dynamic peak model without invoking more complicated non—
linear curve ﬁtting. For peak detection, the daughter wavelets should locally
resemble the real signal. Gaussian family wavelets are very effective unless
the peaks are strongly asymmetric. The real part of the Gaussian wavelet is

 

SCI

 

 

 

 

Fig. 3. The Marr wavelet under two different scaling factor on and a2.

calculated by taking the p—th derivative of the function:

dp (CpeTt2>

wt): dip ,

(2)
where Cp is a constant factor which depends on the derivative order p of
the function Clue—t2 and is computed to normalize the Gaussian wavelet
function. The Marr wavelet is proportional to the second derivative of the
Gaussian wavelet function. It has been demonstrated (Lange et al., 2006)
that Gaussian wavelets are well suited for detecting individual peaks. If the
scale is chosen correctly, the transform of a given peak is largely independent
of neighboring peaks, even if they heavily overlap. The Marr wavelet can be
formulated as: 2

it

1 2‘2 e2“
W=m(1‘a—2) ’ (3)

Figure 3 presents an example of Marr wavelets of scale on and a2, where the
wavelet of a2 has a smaller peak width, which is a better match for narrow
peaks. Similarly, the wavelet of a1, provides a better match for wider peaks.
Our algorithm applies a linear function to describe the relationship between
peak width and m/z value to achieve more reliable peak identiﬁcation since
the resolution of a mass spectrometer only depends on the instrument:

pw=Ax+B, (4)

where pw is the peak width, x is the m/z, A and B are predeﬁned constants
based on the type of mass spectrometer used. Depending on the peak width
and the spectrum m/z coverage, the peak model used is dynamically adjusted.

When the scaled wavelet resembles the peak, the coefﬁcients will
demonstrate a local maximum around the position of the peak centroid.
The coefﬁcient becomes stronger when the scaled wavelet more closely
resembles the peak. Figure 4A demonstrates a single MS/MS peak with the
centroid marked by a red cross. Figure 4B is the distribution of the amplitude
of the coefﬁcient maxima across different scales. It shows the strongest
coefﬁcient maximum happens at the scale the daughter wavelet best matches
the peak. When the scale becomes smaller or larger, the coefﬁcient gradually
reduces in amplitude. The coefﬁcient maximum approximately follows a
Gaussian process in the continuous space as shown. To increase reliability,
our algorithm transforms the spectra on the wavelets that best ﬁt the peaks. If
the peak width at the smallest m/z is estimated to be M while for the largest
m/z it is estimated to be wz, then the best wavelet scales will be within
the interval [0.5 x w, 2 x wz]. Based on the predeﬁned number of allowed
scales N, the scaling interval can be calculated by N (2 x wz —0.5 x w). In
order to further increase accuracy, our algorithm incorporates a Gaussian
weighting model to select the best matched daughter wavelets, because the
performance of the wavelet—based peak modeling largely depends on the
correct selection of the daughter wavelets. For a speciﬁc peak at a certain
m/z, the method selects the wavelets of the scales from half to double the

 

2244

112 /§JO'smumofpmjxosor1au110jurorq//zd11q 11101; popaommoq

9IOZ ‘lg lsnﬁnv uo ::

Wavelet-based algorithm for pre-processing tandem MS data

 

 

I1I'J-II
I

I:
IIIIII

 

 

 

Fig. 4. (A) A single MS/MS peak with the centroid marked by a red cross.
(B) The distribution of the amplitude of corresponding wavelet coefﬁcient
maximum.

peak width [0.5 x pw, 2 x pw]. The Gaussian weight can be calculated by:

*s-is 2
1 (mm—1)) 

Wi= 

 

where w,- is the weight for a speciﬁc coefﬁcient maximum at scale i, and s,-
and s1 are the scale value of i and the smallest considered scale respectively.
N is the total number of considered scales and SI is the scale interval. P
is a penalty factor: if there is no relevant coefﬁcient maximum present at
that scale, P is 1; if the maximum is present, P is 0. When the accumulated
weight of all the coefﬁcient maxima of all the chosen scales is larger than a
threshold, then a peak candidate is detected.

2.2 DyWave peak identiﬁcation procedure

Our dynamic wavelet—based pre—processing algorithm (DyWave) involves
ﬁve steps and Box 1 provides an outline.

Step 1: Extract the raw MS/MS and precursor MS spectra from standard
szML ﬁles. Estimate the smallest interval of the spectra and thus obtain
the best matching wavelet using the linear function as Equations (3) and (4).

Step 2: Identify the local maxima of the coefﬁcients using a sliding
window on the regions of interest. The size of the sliding window is linearly
determined by the wavelet scale. Then calculate the Gaussian weights of all
identiﬁed coefﬁcient maxima using Equation (5). If the ﬁnal weight is larger
than a deﬁned threshold, it is considered a candidate peak.

Step 3: Estimate the peak centroids in the coefﬁcient domain instead of
intensity, because the baseline and noise have been suppressed or removed.
Two options are provided. One way is to use the averaged position as the
peak centroid. The other is to apply the same Gaussian weighting scheme:

_ (01w1+czw2+...+cnwn)
T N

where c,- is the coefﬁcient maximum position at scale i, w,- is the associated
weight, and N is the total number of considered scales. This may provide a
better approximation of the peak centroid.

Step 4: Reﬁne the peak list using two criteria: (i) the selected peaks should
have an estimated SNR larger than a predeﬁned threshold, default is 3, and/or
(ii) the distance between two adjacent peak positions should also exceed a
threshold. Then estimate the peak SNR by using the wavelet coefﬁcients. For
a speciﬁc peak, the signal is deﬁned as the coefﬁcient maximum amplitude
at the best matching scale. The coefﬁcients at the scale where the smallest
calculated wavelet, and the 95% quantile of the coefﬁcient intensity around
the considered peak is calculated as noise (Du et al., 2006).

Step 5: Estimate peak intensity using two possible ways. First, the intensity
at the determined peak centroid is used. The second approach is to use the
area under the curve (AUC) as the intensity instead of the value of one data
point. To calculate the AUC, DyWave applies a moving average method
to ﬁnd the two approximate end positions of the peak and then calculates
the AUC for that speciﬁc peak using the signal intensity. Our method

C

 

, (6)

incorporates the additional (optional) feature of estimating the peptide charge
state by analyzing the MS and MS/MS spectra. This feature can facilitate
the downstream analysis especially on ESI datasets.

Box 1. The dynamic wavelet—based pre—processing algorithm
Input: standard szML spectra ﬁles
Output: peak lists in identiﬁcation softwares compatible formats
for each MS/MS spectrum (10
obtain optimal peak width range by Equation (4)
obtain optimal wavelet scales from scalemin to scalemax, total of N scales
calculate wavelet coefﬁcients Coefl on scalemin do
for each sliding window on spectrum of scalemin
ﬁnd local coefﬁcient maxima and initilize as peak list
endfor
for each scale i from scalemin +1 to scalemaxdo
calculate wavelet coefﬁcients Coefl-aj
ﬁnd local coefﬁcient maxima LocalMaxl-J-
append maxima LocalMaxl-J- to peak list Peak“-
calculate Gaussian weights WeightiJ- by Equation (5)
end for
calculate the total weight for candidate peaks totalWeightl- = :1- Weight”-
if totalWeightl- < threshold (10
remove element from peak list
end if
estimate SNR for each peak
if SNR < threshold (10
remove this element from peaks
end if
if peak is too close to neighbor peak (10
merge this peak
end if
estimate peak centroids by average or Equation (6)
for each reﬁned peak in Peak,- (10
ﬁnd two ends of the peak
calculate the AUC as peak intensity
end for
end for

 

 

2.3 Evaluation

To evaluate the performance of different pre—processing algorithms, we
examine the effect of the different algorithms on downstream protein
identiﬁcation results. We use the raw spectra from two large—scale datasets
as a benchmark: (i) the Aurum dataset (Falkner et 01., 2007), and (ii) human
protein mixture study datasets from the Clinical Proteomic Technologies
Assessment for Cancer (CPTAC) (http://cptac.tranche.proteomecommons
.org). The Aurum dataset is a public, open library of MS and MS/MS
spectra generated on an ABI 4700 MALDI TOF/TOF from known puriﬁed
and trypsin digested protein samples. The acquisition procedure utilizes
a workﬂow used for gel—puriﬁed proteins. To our knowledge, the Aurum
dataset is one of few large, publicly available MS and MS/MS reference
datasets where the raw spectra are provided and the actual identity of the
proteins is known in advance of the analysis. The CPTAC dataset comes
from a large—scale study of the reproducibility and repeatability of National
Cancer Institute (NCI) and Universal Proteomics Standard set 1 (UPSl)
human proteins. The UPSl comprises of 48 known human proteins and
NCI dataset comprises of 20 known human proteins. These proteins were
analyzed in ﬁve different concentrations and in mixture. We also evaluate the
performance of our method on these datasets which were obtained using a
LTQ—Orbitrap from ThermoFinnigan. The MS and MS/MS spectra of NCI—20
samples and UPSl samples were combined for pre—processing and protein
identiﬁcation. The details of CPTAC datasets can be found in Tabb et al.
(2010).

 

2245

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘lg lsnﬁnv uo ::

R Wang et aI.

 

Parameter
NW...

2 -
\) XlTandem —> Pmte'”
p R FixScale 7) ID
.3

Fig. 5. The design of the evaluation experiment: all parameters are controlled
in order to evaluate pre—processing algorithms.

We compare DyWave with three other widely used algorithms:

(1) The intensity—based approach sziff from the TPP. This algorithm
was chosen because, to our knowledge, it is the only open source
MS/MS pre—processing algorithm. In addition, it is possibly the most
widely used method for spectrum pre—processing.

(2) The commercial software MSExtractor from Applied Biosystems
for the ABI4700 MALDI TOF/TOF mass spectrometer (Falkner
et al., 2007). Proprietary software normally involves sophisticated
algorithm design optimized for the supporting instrument. Thus it
should produce very reliable results. MSExtractor can be only used
on the Aurum dataset because it is speciﬁc to datasets from this
manufacturer.

(3

V

Our own implementation (FixScale) of a CWT approach similar to
the method of Du et al. (2006) using a static wavelet scale from 1
to 64 and detecting peaks by linking the maxima across the scale
coefﬁcients which are then ﬁltered by the condition: SNR>3.

Once peak lists are obtained using these algorithms, XlTandem (Craig
and Beavis, 2004) is used to perform protein identiﬁcation. The default
search parameters are used and searches are conducted against the SWISS—
PROT human database. The experimental design is presented in Figure 5.
The performance of the pre—proces sing algorithms is evaluated by comparing
the peptide and protein identiﬁcation results.

There are three potential beneﬁts to be derived from improved pre—
processing: (i) more peptides and thus more proteins could be identiﬁed;
(ii) the FDR in protein identiﬁcation could be reduced; and (iii) spectra SNR
could be increased and noise reduced. Therefore, these three criteria are used
to evaluate the various methods.

A key aim of proteomic analysis is to identify the maximum possible
number of peptides and proteins while controlling the FDR. The FDR can be
estimated in two ways. First, as the proteins in the Aurum dataset and CPTAC
datasets are known in advance, the FDR can be calculated directly. However,
this approach is only feasible with reference datasets of known composition.
Thus, we also use a second target—decoy approach to estimate the FDR.
Brieﬂy, the method constructs a decoy database by reversing all protein
sequences in the original database and concatenating this set of reversed
sequences to the original database. This combined database is used in the
protein identiﬁcation search. An estimate of the FDR is then obtained by
doubling the number of decoy hits and dividing by the number of total hits:
FDR: 2x DecoyHits/TotalHits (Elias and Gygi, 2007).

3 RESULT

The effectiveness of the various pre—processing algorithms is
demonstrated by examining the peptide—level results, the protein—
level results and the SNR results in turn.

3.1 Peptide-level results

Peptide identiﬁcation is directly associated with spectra quality.
Thus, the results at the peptide level are a more direct indication
of the pre—processing performance with less bias. At the peptide
level, DyWave performs signiﬁcantly better compared to the other
methods. This is shown in Figure 6. Using the Aurum dataset,

.. _I::
if...
,2— ,..-*
("If
. I I  ; .x"
. f f if? J
J.» .
a”;
(“XI-I .- Iii-"'2.
_.r" ' .E"
.——--"'"'f .—-— 13""; —
"r. I '.:n.' "' .3. . ,.
«am- a. Lam-.3;
'.L
.- pk”;
. . x/
-4 E _/
_.-
E x = . 
pl"; ,1”
Ext-J I2
/ _I
in, (_g' _.. ..
f. _ ._ _.

lithium-h- WWI

Fig. 6. The peptide identiﬁcation results. (A) FDR estimated by the target—
decoy approach on the Aurum dataset. (B) Real FDR directly calculated on
the Aurum dataset. (C) FDR estimated by the target—decoy approach on the
Orbitrap dataset. (D) Real FDR directly calculated on the Orbitrap dataset.

DyWave identiﬁes approximately 15% more unique peptides for
a given false positive rate compared to the proprietary software and
up to 30% more peptides compared to the commonly used intensity—
based approach. The performance of DyWave is consistently
better than other compared methods on the CPTAC datasets and
accordingly identiﬁes signiﬁcantly more peptides. This indicates
that the processed spectra obtained by DyWave are of much
higher quality, greatly facilitating the successful identiﬁcation of
the peptides from the tandem MS spectra. As shown in Figure 6,
DyWave has the highest sensitivity, and it is able to achieve better
accuracy than the static algorithm based on a ﬁxed scale wavelet
transform.

Using the target—decoy approach, the estimated peptide FDR
of sziff is much higher than that of the other two methods,
especially on Aurum dataset. As shown in Figure 6A, the commercial
algorithm, ﬁxed scale method and DyWave can achieve almost 100%
speciﬁcity when identifying 1400 or less peptides. On the other
hand, the intensity—based method can never reach such accuracy
even when identifying 100 peptides. This is consistent with the
results using the Aurum dataset that show the other three methods
perform much better than sziff as shown in Figure 6B. On
the LTQ—Orbitrap datasets, DyWave consistently performs better
than the other methods, including the ﬁxed scale wavelet method
and sziff. Comparing Figure 6C to A shows the intensity—
based approach performs better on the LTQ—Orbitrap data though
still incurring higher FDR than DyWave. These results clearly
demonstrate pre—processing has a great impact on the downstream
peptide identiﬁcation analysis. It also indicates using signal intensity
alone may not always provide satisfactory results and is prone to
incur a higher false positive rate.

Comparing the target—decoy FDR results in Figure 6A and C to
the directly calculated FDR results in Figure 6B and D, it clearly
demonstrates that the target—decoy strategy tends to underestimate
the actual false positive rates. This phenomenon is consistent on both

 

2246

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 111011 pop1201umoq

9IOZ ‘lg lsnﬁnv uo ::

Wavelet-based algorithm for pre-processing tandem MS data

 

A B
.r 15.
    
I. #3,!" {a} jar-"F'-
.d'" {I}.
i  3 fr;
I! 
- If _ r... f
_ 5/ __
I n' _ / —
a I"
a l- u: :1:- -.-
nnnnn uII-n PHI-nanny
c_ D

 

mwlzhl n-ulr'. nnnnn c.

Fig. 7. The protein level results. (A) FDR estimated by target—decoy
approach on the Aurum dataset. (B) Real FDR directly calculated on the
Aurum dataset. (C) FDR estimated by the target—decoy approach on the
Orbitrap dataset. (D) Real FDR directly calculated on the Orbitrap dataset.

MALDI TOF/T OF and LTQ—Orbitrap instruments. This indicates
there is unequal likelihood of selecting an incorrect peptide match
from the target database compared to the reversed decoy database.
In other words, false positive target hits are more likely than decoy
hits. On the other hand, the distribution of the real FDR and target—
decoy FDR is consistent as shown in Figure 6. This indicates that
the target—decoy strategy is able to capture the random matched hits
contribution of the false positive identiﬁcation.

3.2 Protein-level results

The protein—level results are consistent with the peptide level results.
DyWave performs signiﬁcantly better than the three compared
methods. In general, DyWave is able to identify ~10% more true
unique proteins without incurring a higher false positive rate. For
each identiﬁcation at the protein level, DyWave achieves higher
conﬁdence compared to the other methods. As DyWave identiﬁes a
larger number of proteins for the same FDR at the peptide level, each
identiﬁcation at the protein level receives, on average, more peptide
identiﬁcation support. As Figure 7 demonstrates, on the Aurum
dataset the intensity—based sziff again identiﬁes the smallest
number of proteins at a given FDR, while DyWave identiﬁes the
largest number of proteins at the same FDR and the proprietary
software and ﬁxed—scale wavelet method sit in between. On the
CPTAC datasets, DyWave consistently identiﬁed the most proteins
while the ﬁxed—scale wavelet method identiﬁed the smallest number
and sziff is in the middle.

Based on the peptide— and protein—level results, DyWave performs
consistently better than the sziff method offered by TPP. It is
interesting to note that, while the proprietary algorithm identiﬁes
more peptides than sziff on the Aurum dataset, this fails to
translate to more protein identiﬁcations. The difference between the
intensity approach, ﬁxed scale wavelet method and the commercial
software is marginal at the protein level and the performance of
these three methods becomes even closer as the FDR increases

A Pﬂkljst Siactmparisnn B PHILIJIISiIE Empirisun
51' H:
n: I: m
‘J'. E'-
IT
:: I-ﬁ I I -J.'.-'
1,: I: V:L-"l-=' In..."
"4:" .': I.'l-1.. u
.- -:.J.J.II
I'I': lr“.-Ilr-I-- 4.2-... 3....
LL =
._ - - , I I
I..' ' "III' M'— 'IIII'I :..'.'I.- '3‘" ' 'I-Il :'-"-'|Il

Fig. 8. The processed spectra ﬁle size comparison, where DyWave is
shown to achieve the best SNR. (A) Comparison on the Aurum dataset.
(B) Comparison on the LTQ—Orbitrap dataset.

as shown in Figure 7A and B. On the CPTAC datasets, sziff
produces better results compared to its results on the Aurum dataset
as Figure 7C and D show. On the other hand, DyWave presents the
best performance on all datasets. This may be due to many peaks
corresponding to real y— or b— ions having relatively weak amplitude
and thus being difﬁcult to identify. It is interesting to see that our
dynamic wavelet method performs better than the static algorithm
using a ﬁxed wavelet scale. This demonstrates that the dynamic
model with a more realistic weighting scheme can better capture and
recognize the characteristics of the peaks. This is a strong indication
that DyWave not only improves the quality of the processed spectra,
it also can increase the number of actual peaks in the spectrum
correctly identiﬁed, known as spectra identiﬁcation coverage. In
addition to increasing the number of proteins identiﬁed from a
sample, this feature may also improve quantitative analysis, since
quantitative technologies such as iTRAQ are entirely dependent on
the correct identiﬁcation of reporter ions.

Using the target—decoy approach, DyWave is able to identify up
to 20% more unique proteins compared to sziff and 10% more
proteins than MSExtractor and the ﬁxed scale wavelet method at the
same protein FDR.

Protein—level results demonstrate the target—decoy method
provides a better estimate of the FDR than it does at peptide
level. Comparing the estimated protein FDR and the actual FDR
in Figure 7, we can see that the target—decoy estimated FDR
matches the actual distribution of the FDR fairly well. However,
it again demonstrates that the target—decoy approach is prone to
underestimate the FDR even though the estimate seems to be more
realistic at the protein level. When we examine the difference of the
FDR at peptide and protein level, it is obvious that although peptide
identiﬁcation determines the quality of the downstream protein level
analysis, the sensitivity of protein identiﬁcation displays a different
distribution. It is worth noting that while the FDR at peptide level
remains constantly low and starts to grow exponentially after a
certain stage, the protein—level FDR seems to follow a logarithmic
distribution.

3.3 SNR and noise reduction

The SNR of pre—processed spectra can be estimated by comparing
the ﬁle size of the peak lists giving rise to similar numbers
of identiﬁed proteins. sziff can reduce the information in the
raw spectrum by 60—90%. As Figure 8 demonstrates, this can be
reduced by up to another 90% by the commercial software and
the two wavelet—based methods. This signiﬁcant reduction of ﬁle
size is achieved without compromising the useful information. This
indicates that the proprietary algorithm and wavelet methods achieve

 

2247

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 111011 pep1201umoq

9IOZ ‘lg lsnﬁnv uo ::

R Wang et aI.

 

much better SNR compared to the intensity—based sziff. The two
wavelet methods can reduce the peak list by a further 10% compared
to the commercial software while achieving even better downstream
peptide and protein identiﬁcation results. Even though the ﬁxed—
scale wavelet method is able to achieve the best results in reducing
the ﬁle size, it also reduces the number of identiﬁed peptides and
proteins. This indicates that real peptide fragment signals may
be aggressively removed in the ﬁxed—scale wavelet method. This
demonstrates that DyWave achieves better SNR than the ﬁxed—scale
wavelet method without sacriﬁcing more useful information. This
may greatly improve the reliability of downstream analysis.

A better SNR has two additional beneﬁts. First, because MS
experiments generate huge volumes of spectra data, peak lists with
higher SNRs require less storage space and make spectra transfer
more convenient. Second, higher SNRs and smaller ﬁle sizes result
in a signiﬁcant increase in the computational speed of downstream
analysis. This will greatly facilitate the high—throughput proteomic
analysis applications and automatic analysis pipelines.

4 DISCUSSION

In this article, we examined the overall proteomic data analysis
workﬂow and demonstrated that our newly proposed dynamic
wavelet—based pre—processing algorithm is able to signiﬁcantly
outperform currently available MS/MS pre—processing algorithms
by producing more accurate peptide and protein identiﬁcations and
increasing the spectra SNR. These are the key functionalities for a
pre—processing algorithm. Our experiments demonstrate that mass
spectra pre—processing is an important component of the overall
MS—based proteomic analysis, greatly affecting the downstream
results. Considerably more peptides and proteins can be identiﬁed
with more sophisticated pre—processing algorithms. With powerful
spectra pre—processing methods, the accuracy and reliability of
MS—based quantitative proteomic analysis, such as isotope—coded
afﬁnity tag (ICAT), stable isotope labeling with amino acids in
cell culture (SILIAC) and iTRAQ can also be greatly improved.
Despite this, pre—processing has attracted less attention than the other
aspects of tandem MS data analysis and there is a lack of available,
reliable pre—processing algorithms for tandem MS data. Therefore,
we have developed our new pre—processing algorithm to address this
issue.

Spectrum signal intensity has been the major criterion used in
pre—processing (peak picking) tandem MS spectra. Consequently,
peptide and protein identiﬁcation has been critically dependent
on the spectrum signal intensity. The superior performance of
DyWave demonstrates that such an approach has its limitations.
We have shown that using additional information about signal
shape can lead to much more accurate identiﬁcation and increase
identiﬁcation coverage. This is especially true with low precision
mass spectrometers where excessive noise and spurious peaks are
expected. Even with high precision instruments, it is common for
many peaks corresponding to real y— or b— peptide fragment ions to
have relatively weak intensity, thus making them difﬁcult to identify.
This may be why our method is able to identify more peptides and
proteins by taking account of additional signal shape characteristics.
Assessment results also demonstrate that accurate selection of the
wavelet transform scale is crucial. With more accurately selected
wavelet transform scales; a dynamic wavelet model can have better
performance than a static wavelet method which applies wavelet

transform on ﬁxed scales. Therefore, the applicability of intensity—
based pre—processing becomes difﬁcult in many real applications,
and methods having stronger analytical basis, such as wavelet—based
approaches, are more reliable.

High—throughput tandem MS proteomic analysis is peptide—
centric: the identiﬁcation and quantiﬁcation of proteins are inferred
from the identiﬁed peptides giving rise to the observed spectra. In
most cases, peptide—level analysis is an intermediate step because
the ultimate goal of most experiments is to identify the proteins.
However, the ease of protein identiﬁcation often depends on the
number and quality of the identiﬁed peptides. In comparing protein—
level identiﬁcation and peptide—level identiﬁcation, the commercial
software cannot consistently translate an improvement in peptide
identiﬁcation to an improvement in protein identiﬁcation although
it can identify more peptides than the predominant intensity—based
approach from the TPP. Our method shows a clear advantage from
this perspective. This may be due to larger number of weak peptide
fragment signals being identiﬁed by our method. This is hard to attain
using the static wavelet method. Furthermore, these weak peptide
signals enable the protein database search engine to successfully
assign more protein identiﬁcations. Thus, we hypothesize that the
successful identiﬁcation of proteins is dependent on ‘two’ distinct
aspects: the identiﬁcation of peptides from spectra and the peptide
to protein assignment. One potential reason for the independence
of these two aspects is ambiguities in determining the identities of
proteins that share multiple peptides. Thus identifying more peptides
is not the only beneﬁt we can gain from a dynamic pre—processing
algorithm. By successfully recovering the weak peptide fragments
from the spectra, we can greatly improve the peptide to protein
assignment.

As protein identiﬁcation can be an error—prone exercise, the
estimation of the frequency of false identiﬁcation is important
(Keller et al., 2002). The target—decoy evaluation strategy has
become the most widely used means of estimating the FDR in
proteomic research. This approach involves introducing answers that
are known a priori to be incorrect, called ‘decoys’, to the search
space. By making the assumption that incorrect identiﬁcations are
uniformly distributed in the search space, one can estimate the FDR
from the number of decoy hits. Existing study has indicated that
the target—decoy strategy is prone to underestimate the actual FDR,
especially at peptide level (K'all et al., 2008). The underestimated
FDR suggests the distribution of decoy identiﬁcations does not
accurately represent the target ‘null’ distribution. In other words,
there is unequal likelihood of selecting an incorrect peptide match
from the target database as compared to selecting a match from
the reversed decoy database, even if the search algorithm is
presented with an equal number of target and decoy peptides. In
our comparison studies, we have demonstrated the estimated FDRs
in a comparative setting are biased toward underestimating the real
FDRs in the identiﬁcation, even though a reversed sequence database
seemingly is the logical choice for a decoy. False positive target hits
have been demonstrated to be more likely than decoy hits. Therefore,
we should keep in mind that the real FDR is likely to be higher than
the target—decoy estimated FDR.

One difﬁculty in proteomic research is most software is
proprietary and there is a lack of open alternatives. This
problem signiﬁcantly hinders the advance of proteomic research as
proprietary software often makes collaborative research difﬁcult.
Many modern bioinformatics research projects require the joint

 

2248

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁ(11111 111011 pep1201umoq

9IOZ ‘lg lsnﬁnv uo ::

Wavelet-based algorithm for pre-processing tandem MS data

 

effort of many individual laboratories, e.g. the human genome
project. To this end, it is necessary to have open source analysis
applications that can be shared and improved by all participants.
Furthermore, although proprietary software is typically reliable, it
is developed based on the knowledge and expertise of one team or
one company. The inability to examine the speciﬁc details of the
underlying algorithm means the software is not able to be improved
or developed using ideas from the hundreds of outside experts.

In conclusion, pre—processing is an important component of the
proteomic analysis workﬂow. It has a great inﬂuence on the success
of downstream analysis components. More advanced pre—processing
algorithms are desirable since they result in considerably more
peptide and protein identiﬁcation and a higher SNR. Dynamic
models using wavelet theory provides a powerful means for pre—
processing raw spectra. The DyWave method will be freely available
for academic purposes.

ACKNOWLEDGEMENTS

Our method is implemented in C++. The implementation adopts
source code from TPP for processing szML data format. We thank
Dr Ben Crossett, Philippa Kohnke and Prof. Richard Christopherson
from University of Sydney for providing discussion and initial data
during the course of the work. We thank Mark Gj ukich and Dr Phillip
Andrews from University of Michigan for providing Aurum dataset
and raw spectra.

Funding: ARC Discovery Grant (DP0984267); NICTA scholarship
(to P.Y.).

Conﬂict of Interest: none declared.

REFERENCES

Anderson,N.L. and Anderson,N.G. ( 1998) Proteome and proteomics: new technologies,
new concepts, and new words. Electrophoresis, 19, 1853—1861.

Anderson,N.L. and Anderson,N.G. (2002) The human plasma proteome: history,
character, and diagnostic prospects. Mol. Cell. Proteom, 1, 845—867.

Andreev,V. et al. (2003) A new algorithm for minimizing chemical noise in LC-MS:
matched ﬁltration with experimental noise determination (MEN D). In Proceedings
of the 51st ASMS Conference on Mass Spectrometry and Applied Topics. Montreal,
Quebec, Canada.

Blackstock,W.P. and Weir,M.P. (1999) Proteomics: quantitative and physical mapping
of cellular proteins. Trends Biotechnol, 17, 121—127.

B0ehm,A.M. et al. (2004) Extractor for ESI quadrupole TOF tandem MS data enabled
for high throughput batch processing. BMC Bioinformatics, 5, 162.

Cagney,G. and Emili,A. (2002) De novo peptide sequencing and quantitative proﬁling of
complex protein mixtures using mass-coded abundance tagging. Nat. Biotechnol,
20, 163—170.

C00mbes,K.R. et al. (2005) Improved peak detection and quantiﬁcation of mass
spectrometry data acquired from surface-enhanced laser desorption and ionization
by denoising spectra with the undecimated discrete wavelet transform. Proteomics,
5, 4107—41 17.

C0x,J. and Mann,M. (2008) MaxQuant enables high peptide identiﬁcation
rates, individualized p.p.b.-range mass accuracies and proteome-wide protein
quantiﬁcation. Nat. Biotechnol, 26, 1367—1372.

Craig,R. and Beavis,R. (2004) TANDEM: matching proteins with mass spectra.
Bioinformatics, 20, 1466—1467.

Du,P. et al. (2006) Improved peak detection in mass spectrum by incorporating
continuous wavelet transform-based pattern matching. Bioinformatics, 22,
2059—2065.

Elias,J. and Gygi,S. (2007) Target-decoy search strategy for increased conﬁdence in
large-scale protein identiﬁcations by mass spectrometry. Nat. Methods, 4, 207—214.

Falkner,J.A. et al. (2007) Validated MALDITOF/T OF mass spectra for protein
standards. J. Am. Soc. Mass Spectr, 18, 850—855.

Gay,S. et al. ( 1999) Modeling peptide mass ﬁngerprinting data using the atomic
composition of peptides. Electrophoresis, 20, 3527—3534.

Geer,L.Y. et al. (2004) Open mass spectrometry search algorithm. J. Proteome Res., 3,
958—964.

Gentzel,M. et al. (2003) Preprocessing of tandem mass spectrometric data to support
automatic protein identiﬁcation. Proteomics, 3, 1597—1610.

Gras,R. et al. (1999) Improving protein identiﬁcation from peptide mass ﬁngerprinting
through a parameterized multi-level scoring algorithm and an optimised peak
detection. Electrophoresis, 20, 3535—3550.

Hanash,S. (2003) Disease proteomics. Nature, 422, 226—232.

Katajamaa,M. et al. (2006) MZmine: Toolbox for processing and visualization of mass
spectrometry based molecular proﬁle data. Bioinformatics, 22, 634—636.

Keller,A. et al. (2002) Empirical statistical model to estimate the accuracy of peptide
identiﬁcations made by MS/MS and database search. Anal. Chem., 74, 5383—5392.

K'all,L. et al. (2008) Assigning signiﬁcance to peptides identiﬁed by tandem mass
spectrometry using decoy databases. J. Proteome Res., 7, 29—34.

Lange,E. et al. (2006) High-accuracy peak picking of proteomics data using wavelet
techniques. In Proceedings of Paciﬁc Symposium on Biocomputing, Maui, Hawaii,
USA, pp. 243—254.

Li,X. et al. (2005) SELDI—TOF mass spectrometry protein data. In Gentleman,R.
et al. (eds) Bioinformatics and Computational Biology Solutions Using R and
Bioconductor. Springer, New York, USA, pp. 91—109.

Mantini,D. et al. (2007) LIMPIC: a computational method for the separation of protein
MALDITOF-MS signals from noise. BMC Bioinformatics, 8, 101.

Ong,S.E. et al. (2003) Mass spectrometric-based approaches in quantitative proteomics.
Methods, 2, 124—130.

Pedrioli,P. et al. (2004) A common open representation of mass spectrometry data and
its application to proteomics research. Nat. Biotechnol, 22, 1459—1466.

Pedrioli,P. (2010) Trans-proteomic pipeline: a pipeline for proteomic analysis. Methods
Mol. Biol, 604, 213—238.

Qu,Y. et al. (2003) Data reduction using a discrete wavelet transform in discriminant
analysis of very high dimensionality data. Biometrics, 59, 143—151.

Randolph,T.W. and Yasui,Y. (2006) Multiscale processing of mass spectrometry data.
Biometrics, 62, 589—597.

Renard, B.Y. et al. (2009) When less can yield more - Computational preprocessing of
MS/MS spectra for peptide identiﬁcation. Proteomics, 9, 497 8—4984.

Tabb,D.L. et al. (2010) Repeatability and reproducibility in proteomic identiﬁcations by
liquid chromatography-tandem mass spectrometry. J. Proteome Res., 9, 761—776.

Tanner,S. et al. (2005) InsPecT: identiﬁcation of posttransiationally modiﬁed peptides
from tandem mass spectra. Anal. Chem., 77, 4626—4639.

Unwin,R.D. et al. (2005) Quantitative proteomic analysis using isobaric protein tags
enables rapid comparison of changes in transcript and protein levels in transformed
cells. Mol. Cell. Proteom., 4, 924—935.

Wang,P. et al. (2009) An integrative approach to iTRAQ analysis. In Proceedings of
Bioinformatics. Australia, Melbourne.

Wilkins,M. et al. (1997) Proteome Research: New Frontiers in Functional Genomics.
1st edn. Springer, Berlin, Germany.

Yu,W. et al. (2005) Statistical methods in proteomics. In Pham,H. ed. Springer
Handbook of Engineering Statistics. Springer, London, UK, pp. 623—638.

Zhang,N. et al. (2002) Prole: a probabilistic algorithm to identify peptides through
sequence database searching using tandem mass spectral data. Proteomics, 2,
1406—1412.

 

2249

112 /B.IO'SIBUJHOIPJOJXO'SOllBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘lg lsnﬁnv uo ::

