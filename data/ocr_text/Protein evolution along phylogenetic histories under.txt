ORIGINAL PAPER

Vol. 29 no. 23 2013, pages 3020—3028
doi:10. 1093/bioinformatics/btt530

 

Phylogenetics

Advance Access publication September 12, 2013

Protein evolution along phylogenetic histories under structurally

constrained substitution models

Miguel Arenas1 ’*, Helena G. Dos Santos‘, David Posada2 and Ugo Bastolla1

1Centre for Molecular Biology ‘Severo Ochoa’, Consejo Superior de lnvestigaciones Cienti'ficas (CSIC), Madrid, Spain
and 2Department of Biochemistry, Genetics and Immunology, University of Vigo, Vigo, Spain

Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: Models of molecular evolution aim at describing the evo-
lutionary processes at the molecular level. However, current models
rarely incorporate information from protein structure. Conversely,
structure-based models of protein evolution have not been commonly
applied to simulate sequence evolution in a phylogenetic framework,
and they often ignore relevant evolutionary processes such as recom-
bination. A simulation evolutionary framework that integrates substitu-
tion models that account for protein structure stability should be able
to generate more realistic in silico evolved proteins for a variety of
purposes.

Results: We developed a method to simulate protein evolution that
combines models of protein folding stability, such that the fitness de-
pends on the stability of the native state both with respect to unfolding
and misfolding, with phylogenetic histories that can be either specified
by the user or simulated with the coalescent under complex evolution-
ary scenarios, including recombination, demographics and migration.
We have implemented this framework in a computer program called
ProteinEvo/ver. Remarkably, comparing these models with empirical
amino acid replacement models, we found that the former produce
amino acid distributions closer to distributions observed in real protein
families, and proteins that are predicted to be more stable. Therefore,
we conclude that evolutionary models that consider protein stability
and realistic evolutionary histories constitute a better approximation of
the real evolutionary process.

Availability: ProteinEvo/ver is written in C, can run in parallel and is
freely available from http://code.google.com/p/proteinevolver/.
Contact: marenas@cbm.uam.es

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 15, 2013; revised on July 9, 2013; accepted on
September 9, 2013

1 INTRODUCTION

The simulation of molecular evolution is commonly used to
mimic real world processes, allowing the study of complex sys-
tems that are analytically intractable or to understand the mech-
anisms by which an evolutionary process is modiﬁed (Arenas,
2012, 2013; Hoban et al., 2012). A key mechanism in the simu-
lation of molecular sequences is the substitution or replacement
process. Markov substitution/replacement models are commonly
used in population genetics and molecular evolution to mimic

 

*To whom correspondence should be addressed.

evolutionary processes at the molecular level (see Lip and
Goldman, 1998). Nevertheless, most substitution models
assume that sites evolve independently, and they cannot incorp-
orate information on the structural and functional role of amino
acids within proteins, which is determined by the interactions of
different sites. It is known that these interactions may lead to
non-independent evolution, as the evolutionary rate at a site is
inﬂuenced by substitutions at neighboring sites (e.g. Berard and
Gueguen, 2012, and references therein). Moreover, the conform-
ational diversity of proteins may also inﬂuence their molecular
evolution (Javier Zea et al., 2013; Juritz et al., 2013). Models of
evolution that incorporate structure are therefore of increasing
importance (Anisimova and Liberles, 2007; Wilke, 2012).
Recently, structurally constrained models of protein evolution
have been introduced to represent folding stability of a target
structure as a proxy for ﬁtness (reviewed in Liberles et al., 2012).
These models have been studied assuming a neutral ﬁtness land-
scape (e.g. Bastolla et al., 1999, 2003, 2006; Parisi and Echave,
2001; Rastogi et al., 2006; Taverna and Goldstein, 2002a,b) and
as a function of population size (e. g. Goldstein, 2011b; Grahnen
et al., 2011; Mendez et al., 2010). However, these models have
been seldom used to obtain evolutionary insights from real data,
probably because of the lack of widely available and easy-to-use
software.

Furthermore, proteins simulated under a given substitution
process might be unrealistic if common evolutionary processes
are ignored. For example, recombination constitutes a funda-
mental evolutionary force at the molecular level (Posada et al.,
2002) that can affect the estimation of different evolutionary
parameters, like molecular adaptation (by increasing the
number of false positively selected sites) (Anisimova et al.,
2003; Arenas and Posada, 2010a; Kosakovsky Pond et al.,
2008), substitution rate (lack of molecular clock) (Schierup and
Hein, 2000) or ancestral states (Arenas and Posada, 2010b).
Similarly, population genetics processes such as demographic
changes, population structure and migration may inﬂuence evo-
lutionary histories. For example, branches are short when the
population size undergoes a bottleneck (e.g. Slatkin, 1996), and
deme sizes in structured populations may inﬂuence the topology
of genealogical trees, as lineages are assumed to be in the same
deme to coalesce (e.g. Neuhauser and Tavaré, 2001). These as-
pects could inﬂuence the number of substitutions and evolution-
ary trajectories generated in the simulations, which consequently
inﬂuence the simulated data (Posada, 2001). In our view, it is
important that a simulation framework allows reproducing and

 

3020 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 /810's112umo[pJOJXO'sopquJOJutotq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

Protein evolution along phylogenetic histories

 

testing these evolutionary features to be able to address wider
biological questions.

In this study, we have implemented structurally constrained
substitution models (hereafter, SCS models) that allow for site-
dependent substitutions, under neutral and non-neutral ﬁtness
landscapes that depend on protein stability, in the freely avail-
able computer program ProteinEvolver, which is able to simulate
the evolution of proteins and protein-coding genes along evolu-
tionary histories such as phylogenetic trees or ancestral recom-
binant graphs (ARGs). These phylogenetic histories can be
speciﬁed by the user or simulated through the coalescent with
recombination, demographics and migration (see the reviews,
Nordborg, 2007; Wakeley, 2008). Recently, Grahnen and
Liberles introduced the computer program CASS that simulates
protein sequence evolution under selection to fold into a speciﬁc
conformation (Grahnen and Liberles, 2012). Our program differs
from CASS in two main aspects: the representation of the pro-
tein structure, which inﬂuences the way in which we treat mis-
folding stability, and the possibility to represent a broad variety
of demographic and evolutionary scenarios (for instance, varying
recombination rates and mutation). Grahnen and Liberles adopt
explicit side chain representation, and we also adopt contact
matrices, which are less precise but allow a statistical mechanical
treatment of the ensemble of misfolded conformations that is
computationally affordable (and actually very fast with our ap-
proximation) (e. g. Bastolla et al., 2005a,b). Misfolding stability is
important because, if only the unfolded state is considered, se-
lection tends to artiﬁcially favor very hydrophobic sequences.
Therefore, the structural approach taken by the two programs
is complementary, and each of them may be suited to address
different kinds of biological questions.

Through extensive simulations, we compared the SCS models
with commonly used empirical amino acid substitution models
using as a benchmark 10 well-known protein families. We found
that sequences simulated under our SCS models produce amino
acid distributions closer to the observed ones. Furthermore, the
folding stability of the native state, assessed by building struc-
tural models by homology and predicting their stability with a
method different from the one adopted in the simulations, is
signiﬁcantly larger for proteins simulated under the SCS
model. We conclude that substitution models that incorporate
protein structure information are better approximations to the
real evolutionary process and may provide more meaningful evo-
lutionary inferences than site-independent substitution models.

2 METHODS AND ALGORITHMS

We simulate protein evolution in two main steps. First, the ge-
nealogy is either speciﬁed by the user or it is simulated using the
coalescent optionally modiﬁed with recombination, migration
and demographics. Second, protein-coding genes and protein
sequences are evolved along this genealogy under a given substi-
tution or replacement model.

2.1 Simulation of genealogies

Genealogies are simulated according to the standard coales-
cent process (Kingman, 1982) modiﬁed with recombination
(Hudson, 1983), demographics and migration (Hudson, 1998).

Recombination can be either homogeneous or heterogeneous
(recombination hotspots and coldspots) across the sequence fol-
lowing the algorithm developed by Wiuf and Posada (2003).
Note that the simulation of recombination events leads to reticu-
late nodes and, consequently, to an ARG (Grifﬁths and
Marjoram, 1997). Demographics include growth rate and demo-
graphic periods by following the algorithms implemented in
Arenas and Posada (2007, 2010a). Gene ﬂow among subpopula—
tions can be speciﬁed under island, stepping-stone or continent—
island migration models (e.g. Hudson, 1998). In addition,
longitudinal samples or population/species trees, among
other capabilities, can also be speciﬁed (see Supplementary
Table S1).

2.2 Evolution of proteins along phylogenies

After the phylogenetic history has been speciﬁed, a protein struc-
ture and a sequence are assigned to the root (the most recent
common ancestor or grand most recent common ancestor in case
of recombination). Then, the protein is evolved along the phyl-
ogeny going forward in time from the root to the tips (see Yang,
2006) according to the SCS model, generating a protein for all
internal and terminal nodes in the phylogeny.

Overall, for a given branch, the SCS models perform ﬁve steps.

(i) The number of mutations or substitutions is computed
considering the branch length (number of expected substi-
tutions without considering structural constraints) and the
length of the protein (number of amino acids).

(ii) A mutation is introduced according to the instantaneous
rate matrix (the relative rates of change can be used to
determine mutational sites).

(iii) The folding free energy of the mutated protein structure is
computed.

(iv) The selective effect of the mutation is evaluated; it will
be accepted or rejected depending on the ﬁxation prob-
ability associated with the change of ﬁtness (see next
section).

(v) If the mutation is rejected, the process goes to step (ii)
and a new mutation is introduced. If the mutation is
accepted, then the mutation is ﬁxed and it becomes a
substitution.

The ﬁve-step process is repeated until the number of mutations
or substitutions (i) is completed. In this way, ﬁxed mutations
(substitutions) result in differences among proteins from different
evolutionary lineages.

2.2.1 Substitution models based on the stability of the protein
structure

2.2.1.1 Evaluation of the structural stability of mutated
proteins. We evaluate the folding stability of a given mutated
protein taking into account the stability against unfolding and
against misfolding. Initially, we estimate the stability of the
mutated sequence folded into the target structure at the simula-
tion temperature using a contact-based free energy function. The
contact matrix Ci]- takes the value 1 if residues i and j are ‘close’
(<4.5 A) in space and 0 otherwise. This matrix has been shown
sufﬁcient to accurately reconstruct the 3D structure of the

 

3021

112 /810's112umo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

M.Arenas et al.

 

protein Wendruscolo et al., 1997). We assume that the free
energy of a protein with sequence A folded into the contact
matrix C is given by the sum of its pairwise contact interactions:

E(A, C) = Z C,U(A,-, A1) (1)
ij

where U ( a,b ) is the contact interaction matrix that expresses the
free energy gained when amino acids a and b are brought into
contact determined by Bastolla et al. (1999). For proteins that
fold with two-state thermodynamics, i.e. for which only the
native structure and the unfolded structure are thermodynamic-
ally important, stability against unfolding is deﬁned as the free
energy difference between the folded and the unfolded states,
estimated as AG~E(A,Cnat) +sL. Here Cnat is the native struc-
ture, L is the protein length, sis an entropic parameter and sL is
the free energy of the unfolded state for proteins with two-state
thermodynamics. We use s = 0.074, a value that was determined
ﬁtting the above equation to a set of 20 experimentally measured
unfolding free energies, yielding a correlation coefﬁcient r = 0.92.
The correlation coefﬁcient between the predicted and
the observed stability effect of mutations is larger than 0.8
using only two ﬁt parameters, which is comparable with the
state-of-the-art atomistic methods such as F old-X (Guerois
et al., 2002).

Stability against unfolding is, however, not sufﬁcient to char-
acterize protein stability. We also have to check the stability
against compact, incorrectly folded conformations of low
energy that can act as kinetic traps in the folding process and,
in many cases, result in pathological aggregations. Stability
against misfolding is achieved by natural proteins by increasing
the energy of key contacts that are frequently found in alterna-
tive structures, which is termed negative design (Berezovsky
et al., 2007; Minning et al., 2013; Noivirt—Brik et al., 2009) to
distinguish it from the positive design that favors protein stability
by strengthening native interactions. Therefore, stability against
misfolding may be inﬂuenced by mutations at positions that are
distant in the native structure. Stability against misfolded struc-
tures is difﬁcult to estimate, and most models of protein evolu-
tion do not consider it despite its importance being increasingly
recognized (Krishna et al., 2004; Mendez et al., 2010; Zheng
et al., 2013). Here we do consider the set of alternative compact
matrices of L residues that can be obtained from non-redundant
structures in the Protein Data Bank (PDB). This procedure,
called threading, guarantees that the contact matrices fulﬁll phys-
ical constraints on chain connectivity, atomic repulsion and
hydrogen bonding (secondary structure), which are not enforced
in the contact energy function. The free energy of this misfolded
ensemble is often estimated with the Random Energy Model
[REM, (Derrida, 1981)]:

2
Gmisfold m   _ 227-, _ kBTScL 
where <E(A,C)> is the mean and 02 is the variance of the energy
of alternative compact structures (Goldstein, 2011a). This
formula holds for temperatures above the freezing temperature
at which the entropy of the misfolding ensemble vanishes. At
lower temperatures, the free energy maintains the same frozen

value (Derrida, 1981). A recent study showed that the third

moment of the energy cannot be neglected (Minning et al.,
2013), so that the free energy of the misfolded ensemble can be
computed as,

Gmisfold W — kBTscL +  (C1).) U1].
1
2kBT

1
t m  «Cy- - <Cv>><Ckz - <CH>>

(Cmn _  UijUklUmn

 

2W (Cy-Ck; — (Cl-j) (Cm) Uzi-UH (3)

where we denote with Uijz U(A,-,Aj) the contact free energy be-
tween residues i and j, and with <C,-j> the contact-speciﬁc mean
value of the contact between the pair of residues i and j in a large
set of compact protein structures of the same length L as the
target structure.

In the present work, we have reduced considerably the com-
putation time approximating the above free energy (Minning
et al., 2013) with one that only depends on pairs of residues,

A(2)(U)2 + Z..B(..1)U2.
Gmisfold “AUWUl — ZkBTU U U

A<3><U>3 + (U) 2,-3.3ng + Zny-f’WS}
+ 2 — kBTScL
6(kBT)

(4)

The quantities A“), A”, A“), BEJD, 32.2) and 35.1.3) only depend on
the set of alternative contact matrices and on protein length L,
and they are pre-computed before the simulation starts. In this
way, we can evaluate how the misfolded free energy changes on
mutation performing only order L operations for computing
U(A,- = b, Aj) — U(A,- = a, Aj) when the residue at the mutated
site i changes from amino acid a to b. Thus, the stability of the
native state is ﬁnally evaluated as the difference in free energy
between the native, the unfolded and the misfolded states,
AG 2 E(A, Cm”) — Gmisfold — kBTSuL.

The statistical properties of alternative contact matrices are
computed from a large set of protein structures, distributed
with the ProteinEvolver package, that can be modiﬁed by the
user. Supplementary Figure S5 shows the histogram of the
lengths of the alternative structures.

Note that, even if the two conﬁgurational entropies per residue
Su (unfolded ensemble) and Sc (misfolded ensemble) act addi-
tively, the free energy may not simply depend on their sum, as
it is only Sc that determines the freezing temperature of the
misfolded ensemble.

 

 

2.2.2 Relationship between protein stability and fitness Once we
have deﬁned protein stability, for modeling protein evolution we
still have to deﬁne how protein stability inﬂuences ﬁtness. Our
program provides two alternatives. The simplest possibility is a
neutral ﬁtness landscape where the ﬁtness is a binary variable
and all proteins with stability above a given threshold, i.e.
AG< AGthr are considered viable and equally ﬁt, whereas all
proteins below threshold are considered lethal and therefore dis-
carded. We choose as threshold the folding free energy of the
protein sequence A0 in the PDB AGth, = AG(A0,C,W). This
choice implies that the neutral SCS model is not sensitive to

 

3022

112 /810's112umo[pJOJXO'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Protein evolution along phylogenetic histories

 

variations of the entropy parameters and it is little sensitive to
variations in temperature.

Alternatively, we can consider a non-neutral scenario in which
the probability of mutations being ﬁxed depends on population
size. In this case, there will be segregating variation in a popula-
tion. Here, the ﬁtness landscape is modeled in such a way that
ﬁtness is an increasing function of stability, and in particular, it is
proportional to the fraction of protein that is in the native state
(Goldstein, 2011),

1
4A) 2  (5)

Note that the ﬁtness landscape can be reduced to the neutral
landscape in the low temperature limit, as in this limit, the ﬁtness
tends to 1 if AG<0 and to zero if AG>0. This is a neutral
landscape with AGthr = 0.

We then assume that the mutation rate is small, and we model
selection through the Moran’s birth—death process (Ewens,
1979), which yields the ﬁxation probability,

Haj) =i‘wﬂ, (6)
1 — (ft/29)

where f,- is the ﬁtness of the wild type,  is the ﬁtness of the
mutant, N is the effective population size and a=2 or 1 for a
haploid or diploid population, respectively. Given the probabil-
ity of ﬁxation, the succession of mutant ﬁxations can be depicted
as a Markov process, in which the genotype of the evolving lin-
eage moves from one sequence to another one according to the
mutation and ﬁxation probabilities. Both the neutral and non-
neutral scenarios are formally equivalent to a Monte Carlo pro-
cess in statistical mechanics, as discussed by Sella and Hirsch
(2005). The main difference between them is that in the neutral
case, evolved proteins attain the minimum stability compatible
with viability (which in this case is a parameter of the model), as
discussed by Taverna and Goldstein (2002a), whereas in the non-
neutral scenario stability increases with population size, and it
also depends, in a non-trivial way, on the statistical properties of
the mutation process (Mendez et al., 2010). Therefore, neutral
simulations depend on fewer parameters and they are more
robust, whereas non-neutral ones allow exploration of more
biological questions.

2.2.3 Simulation of the SCS model along an ancestral recombina-
tion graph SCS models are site-dependent, so the simulation
across an ARG is not straightforward, as recombination events
put together in the same sequence sites that have been evolving
independently along different lineages. To evolve the protein as a
whole across the ARG, we adapted the algorithm developed by
Arenas and Posada (2010a) to evolve codons ‘broken’ by recom-
bination (see Fig. 1). The protein evolution occurs from the an-
cestral to the descendant nodes (see Yang, 2006). However, if the
evolutionary process reaches a recombinant node (Fig. 1, nodes
in gray), a protein is assigned to such a node (Fig. 1, step 3), but
at this point the evolutionary process continues along another
path (Fig. 1, step 4) because its parental recombinant node re-
mains empty (without an assigned protein). This is forced to
occur because in the parental recombinant node, there is no in-
formation about the protein, as the evolutionary process did not

“a.

Present

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

M:Y
” FGKM
4
(HIT 1*
(ill
L-bG|
____ FLKMH ____I
Past

GM RCA

Fig. 1. An example of protein evolution along the ARG. White and gray
circles correspond to coalescence and recombination parental nodes, re-
spectively. (1) Starting from the grand most recent common ancestor, the
protein is evolved along branches according to the SCS substitution
model and the branch lengths. (3) The process encounters a recombinant
node, and because its parental node has not been assigned to a protein
yet, the evolutionary process continues toward other direction (4). (5)
Later, the process encounters the parental recombinant node, and be-
cause the other parental has already been assigned to a protein, (6) it
combines the two proteins according to the recombination breakpoint.

reach it yet. Later, the evolutionary process reaches the parental
recombinant node (Fig. 1, step 5) and, at this point, there are
entire proteins assigned to both recombinant nodes. Therefore,
now there is a combination of the material according to the
recombination breakpoint. This combination results in a new
protein (Fig. 1, step 6) that continues the evolutionary process
along its descendant branch.

3 FIT OF THE SCS MODELS TO REAL PROTEIN
FAMILIES

We studied 10 protein families to compare the performances of
the integrated SCS models versus the empirical amino acid sub-
stitution models. Also, we estimated the temperature and
entropic parameters that best reproduce the observed data.

We randomly selected 10 different protein families (Table 1)
from the Pfam database (http://pfam.sanger.ac.uk/) subject to
two requirements: the Pfam seed alignment must possess at
least 10 proteins and at least one representative structure
included in the PDB (http://www.rcsb.org/pdb/). For each pro-
tein family, we downloaded the seed alignment and its phylogen-
etic tree from the Pfam database, and chose a representative
structure from the PDB. Amino acid positions not included in
the protein structure were trimmed from the alignment. The em-
pirical amino acid replacement model that best ﬁt each alignment
was estimated with ProtT est (Abascal et al., 2005) (see Table 1).

For each protein family, we simulated 200 realizations of the
evolutionary process under the best-ﬁtted empirical amino acid
substitution model along the Pfam tree. We also performed 200

 

3023

112 /810's112umo[pJOJXO'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

M.Arenas et al.

 

Table 1. Protein families collected from the Pfam database

 

Entry Protein family Pfam code Sample

Uniprot entry PDB code Protein Best-ﬁt amino

 

size length acid model
1 Photoactive yellow proteins PF00989 49 PYP_HALHA 2PHY 125 WAG +G +F
2 Triosephosphate isomerases PF00121 56 TPIS_TRYBB lTTI 243 RtREV +I +G +F
3 Rubredoxins PF00301 43 RUBR2_PSEOL 1ROF 54 WAG +I +G
4 Kinesins PF00225 87 KAR3_YEAST 3KAR 346 LG +I +G +F
5 Phage lysozymes PF00959 18 LYS_BPT4 10V5 164 Blosum62 +G +F
6 Ferredoxins PF05996 62 PCYA_SYNY3 3NB8 248 WAG +I +G
7 DNA ligases PF13298 136 B1L4V6_KORCO 3P4H 118 WAG +G
8 Heat shock proteins PF00012 33 DNAK_ECOLI 2KHO 605 RtREV +G +F
9 Oxysterol—binding proteins PF01237 153 KES1_YEAST 1ZHT 438 LG +I +G +F
10 Retroviral aspartil proteases PF00077 50 POL_FIV PE 3OGQ 116 RtREV +I +G

 

Note: For each family, the table indicates the Pfam code, sample size, UniProt entry for a protein sequence with a PDB structure, the PDB code, number of amino acids and
the empirical amino acid substitution model that better ﬁts the dataset [+G indicates variable substitution rate across sites according to a gamma distribution, +I indicates a

proportion of invariable sites and +F indicates amino acid frequencies].

realizations under the neutral SCS model and the ﬁtness SCS
model using the representative PDB structure. For both neutral
and ﬁtness SCS models, we explored 27 combinations of the
thermodynamic parameters temperature (T: 1.75, 1.50 and
1.30), conﬁgurational entropy per unfolded residue (su= 0.025,
0.05 and 0.075) and conﬁgurational entropy per misfolded resi-
due (sc=0.025, 0.05 and 0.075), performing 11000 simulations.
For the ﬁtness SCS model, we assumed an effective population
size N: 100 (Cruzan, 2001; Oostermeijer et al., 1994). Note that
all substitution models simulated an overall similar number of
substitution events (Supplementary Table S2) because they were
applied along the same branch lengths.

3.1 Analysis of amino acid distributions and inferences of
optimal thermodynamic conditions

We compared the simulated amino acid distributions with those
observed in the original datasets measuring their Kullback—
Leibler divergence at each site i:

20
dw- = ZPi’bs(a)(log(P?bs<a)) — log(P€i'"<a))) (7)

a=1
where a is any of the 20 amino acids. We compute the weighted

L
sum D KL 2 Z widKL’i with weights wi proportional to the
1:
number of aligned residues (excluding gaps) in column i of the
alignment and summing up to 1. The smaller the quantity D KL,
the closer the observed and simulated distributions are.
Remarkably, we found that sequences simulated under the
neutral SCS model are always closer to the observed distribution
than sequences simulated under the empirical substitution model
(see Fig. 2 and Supplementary Fig. S1). Varying the temperature
or the conﬁgurational entropy parameters did not affect the di-
vergence of the neutral SCS simulations, as it could be expected
because the difference between the estimated AG and the neutral
threshold AG,;,, is independent of the entropic parameter and it
depends only weakly on temperature.

On the other hand, the divergence of the ﬁtness SCS model
clearly depended on the particular thermodynamic parameters
(see Fig. 2 and Supplementary Fig. S2). The average agreement
between predicted and observed site-speciﬁc amino acid distri-
butions in the ﬁtness SCS model reached a minimum for the
combination of entropic and temperature parameters (see
Supplementary Fig. S3, minimum in the left plot), where its
value was similar to the one produced by the neutral model
that used as threshold the free energy of the sequence in the
PDB (Supplementary Fig. S3, right). These optimal thermo-
dynamic parameters were achieved for T ( su+sC ) = 0.16.
Interestingly, for some protein families, the ﬁtness SCS model
with optimal parameters was signiﬁcantly less divergent from the
observed distribution than the neutral SCS model (see Fig. 2).
However, for some protein families the ﬁtness SCS model with
the ‘worst’ parameter values had a similar divergence from the
observed sequences as the empirical substitution models. These
ﬁndings indicate that the neutral SCS model is more robust, and
suggest that it should be used by default, whereas the ﬁtness SCS
model may be used for reﬁnement with well-calibrated thermo-
dynamic parameters, as shown in Supplementary Figure S3
(left). Comparisons between real sequence families, SCS simula-
tions and simulations based on empirical amino acid substitution
models are shown as sequence logos in Supplementary Figure S6.

3.2 Structural assessment of the simulated proteins with
respect to the real proteins

We also assessed how much a simulated protein sequence ﬁts a
representative protein structure of its family by using homology
modeling techniques (Marti-Renom et al., 2000). For each protein
family, 200 sequences simulated under the neutral SCS model and
under the best-ﬁt empirical site-independent substitution model
were modeled using the Modeller software (Eswar et al., 2006; Sali
and Blundell, 1993). For each simulated sequence, 20 structural
models were generated, and they were assessed through their dis-
crete optimized protein energy (DOPE) score (Shen and Sali,
2006), an effective energy function designed for selecting the
best model built by Modeller. Note that this energetic score is

 

3024

112 /810's112umo[pJOJXO'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

Protein evolution along phylogenetic histories

 

 

| l Neutral 512:5 model

Fitn e55 SCS model {worst}

Fitness scs model {best} I

 

 

0.03 I I
I
an: . . .
I.
0.01 ' '
n _ _

Photoactive Triceeph osphate
yellow proteins Iso merases

 

 

Improved distance respect to the empirical model

 - LIII.

Rubredoxins Kin esins Phage
lysozymes

 

 

Ferredoxins DNA ligases Heat shock Iliberaterol- Retroviral
proteins binding proteins aspartil
proteases

Protein Famin

Fig. 2. Improvement of the Kullback—Leibler distance to the real protein alignments of the simulated alignments by the neutral and ﬁtness SCS models
with respect to the empirical amino acid substitution model. The ‘y’ axis indicates decline of the distance of the neutral and ﬁtness (best and worst
conditions) SCS models with respect to the distance of the empirical model. Note that the neutral SCS model was overall more robust than the ﬁtness
SCS model under different thermodynamic conditions (see Supplementary Fig. SlA and B). On the other hand, the ﬁtness SCS model under the best
conditions (see Supplementary Figs S2A, B and S3, left) could improve the neutral model in half of protein families; however, the worst conditions may

lead to results without any improvement respect to the empirical model

independent from the one used in the SCS models. Then, we
selected the sequence-structure pair with the lowest DOPE
energy, whose sequence identity with the template is reported in
Supplementary Table S3. We computed the DOPE energies for
the experimentally known sequence-structure pair and for the best
structural models of proteins simulated with the neutral SCS
model and the best-ﬁt empirical substitution model. Clearly, pro-
teins simulated with the SCS model resulted in better sequence-
structure pairs than proteins simulated with the empirical amino
acid substitution model (see Fig. 3 and Supplementary Fig. S4).
This result is not surprising, as we observed that the DOPE score
was correlated with the contact energy of the native structure for
proteins simulated under the SCS model. However, the two em-
pirical energy functions were derived under different assumptions;
therefore, the DOPE score may be regarded as another conﬁrm-
ation of the quality of our models. Of course it is expected that
models based on substitution matrices, which do not take into
account the structure, produce proteins that are less stable than
proteins simulated under SCS conditions. Nevertheless, the expli-
cit proof of this expectation is a necessary test to assess the
necessity of SCS approaches.

4 SOFTWARE IMPLEMENTATION

We implemented the algorithms described above in the program
ProteinEvolver. The full list of capabilities of ProteinEvolver is
shown in Supplementary Table S1. ProteinEvolver is written in C;
it can be run in parallel using MP1 and it is freely available under
the GNU GPL license from http://code.google.com/p/proteine
volver/. The package includes executables, source code, a de-
tailed documentation and several practical examples (including

v11000 -

-11500 '

-12000 -

42500

 

 

-13000

DOPE energy

-13500

 

 

-14000

 

 

 

 

-14500
Empirical Neutral SCS Real
model model

Dataset

Fig. 3. Dope energy computed in the simulated proteins under the em-
pirical and the neutral SCS substitution models and in the native protein,
for the protein family ‘phototactive yellow proteins’. Note that the dope
energy is unnormalized with respect to the protein size, and therefore
scores from different proteins cannot be compared directly

the ﬁles and settings to mimic the evolution of the real proteins
described and analyzed in the previous section).

5 DISCUSSION

During protein evolution, interactions within the protein struc-
ture lead to correlated evolution, as the rate at which a site

 

3025

112 /810's112umo[pJOJXO'soi112u1101uioiq/pd11q 111011 pepeolumoq

910K ‘09 isnﬁnV uo 22

M.Arenas et al.

 

experiences change is inﬂuenced by replacements at neighboring
sites. To adequately model these correlations, we developed the
simulation framework ProteinEvolver that integrates structure-
based models of protein evolution and evolutionary histories
that can be simulated under diverse evolutionary scenarios
such as recombination (including hotspots and coldspots), mi-
gration and demographics. Importantly, our SCS models con-
sider both the stability against unfolding and the stability against
misfolding, which is difﬁcult to estimate, as it requires the use of
a set of alternative conformations, and it is frequently neglected
in simulations of protein evolution despite the importance of
negative design. Moreover, our approximation of the free
energy of the misfolded state (Minning et al., 2013) allows us
to estimate the effect of each mutation on both unfolding and
misfolding performing a number of computations that grow only
linearly with the number of amino acids. As a consequence, these
models can be applied along long phylogenetic histories.

The recently developed CASS tool (Grahnen and Liberles,
2012) can simulate protein sequence evolution accounting for se-
lection to fold into a speciﬁc conformation. CASS is based on an
explicit side chain representation of the protein, which can make
it more accurate than our contact matrix-based method (although
it is known that contact matrices allow reconstruction of all atom
coordinates with precision), and with treatment of the misfolded
ensemble, which is important to avoid bias toward hydrophobic
sequences that are often unrealistically favored by energy func-
tions. However, additional considerations in the latter might
avoid this effect. An important characteristic of CASS, not
included in our program, is that it allows selecting for structures
that bind a target molecule, therefore allowing investigation of an
important aspect of protein function [which is, nevertheless, in-
timately related with structural stability (e. g. Lukatsky et al.,
2007)].

Another important feature of our framework, which is not
present in the CASS approach, is that it allows modeling evolu-
tionary mechanisms other than point mutations, such as recom-
bination, which has been shown to be a key element in protein
engineering (Carbone and Arnold, 2007) and could affect struc-
tural constraints (Archer et al., 2008; Simon-Loriere et al., 2009).
For example, Xu et al. (2005) have shown that recombination
may inﬂuence structural divergence. In addition, we can simulate
molecular evolution in population genetics scenarios, including
demographics, population structure and migration, which allows
us to address a wide range of biological problems by investigat-
ing how these evolutionary scenarios inﬂuence the properties of
the evolved sequences by altering the underlying genealogies and
the properties of the substitution process, which in non-neutral
ﬁtness landscapes strongly depend on population size. On the
other hand, including or ignoring structural considerations can
affect population genetic inferences (i.e. inferences on recombin-
ation, demographics or migration).

We assessed the performance of the SCS models versus more
traditional empirical replacement matrices. For all 10 protein
families studied and tested combinations of temperature and
conﬁgurational entropy parameters, the neutral SCS model
always simulated sequences with amino acid frequencies closer
to the observed ones than the best-ﬁt empirical amino acid re-
placement model. On the other hand, the ﬁtness SCS model may
outperform the neutral model under optimal thermodynamic

parameters, but it is very sensitive to the correct choice of par-
ameters. Consequently, we recommend the use of the neutral
SCS substitution model by default because it is more robust,
whereas the ﬁtness SCS model should be only used with the
default thermodynamic parameters, in which case it may simu-
late more realistic proteins for some protein families. This differ-
ence stems from the fact that the non-neutral model optimizes
protein stability when the population size is large, and it may
bias the evolutionary process if the thermodynamic model is not
reliable. On the other hand, we think that this dependence on
parameters is reassuring, as it shows that the agreement between
observed and simulated distributions that ProteinEvolver
achieves is not a trivial result.

The beneﬁts of using the SCS substitution models instead of
the empirical substitution models were also observed by evaluat-
ing the adequacy between the simulated sequence and its best
homology model with the DOPE energy. In particular, we found
that the DOPE energy from proteins simulated by the SCS neu-
tral model was always more negative (more stable 3D proteins)
than proteins simulated under the empirical substitution model,
although, not surprisingly, less negative than the energy of the
experimentally observed sequence-structure pair. These ﬁndings
were expected because the empirical models consider independ-
ent sites, and therefore they are unable to account for physical
interactions that promote stability (e.g. Pollock et al., 2012;
Rodrigue et al., 2005). Nevertheless, they constitute a minimal
test that indicates the consistency of SCS models and conﬁrms
the limitation of empirical substitution matrices.

The consideration of structural information should result in
more sensitive and more accurate representations of molecular
evolution than those based on sequence data alone (Wilke,
2012). Our structure-based models could help for a more realistic
benchmarking of methods trying to take into account site depend-
ency induced by protein structure (e. g. Grahnen et al., 2011;
Nasrallah et al., 2011) and the important inﬂuences of the un-
folded and misfolded conﬁgurations on the protein stability
(Bastolla and Demetrius, 2005; Mendez et al., 2010; Zheng
et al., 2013). At the population level, the framework may help,
e. g. (i) to evaluate the range of proteins that one may expect to
observe in different populations (where these populations can
change their sizes with time and can exchange migration), (ii) to
validate analytical frameworks (e. g. methods for the inference of
ARGs, ancestral protein reconstruction, recombination break-
points and recombination rates, from proteins or protein-coding
genes while accounting for structural constrains) or even (iii) to
infer evolutionary parameters of interest and carry out model
choice in an approximate Bayesian computation (ABC) approach
(Beaumont et al., 2002); e.g. estimate recombination rates or
select among different demographic and migration models from
protein data while accounting for structural information. At the
molecular level, the framework may help, for example, to study
the inﬂuence of recombination events on the structure-based
stability of the resulting proteins or to perform structurally
constrained substitution model choice by using ABC.

ACKNOWLEDGEMENTS

The authors thank David Abia for constructive comments and
useful suggestions made during this study.

 

3026

112 /810's112umo[pJOJXO'soi112u1101uioiq/pd11q 111011 pepeolumoq

910K ‘09 isnﬁnV uo 22

Protein evolution along phylogenetic histories

 

Funding: This work was supported by the Spanish Ministery of
Economy, ‘Juan de la Cierva’ fellowship JCI-2011-10452 to
M.A. Spanish Ministery of Economy, grants BFU2011-24595
and BFU2012-40020 to U.B. European Research Council
(ERC-2007-Stg—203161-PHYGENOM to D.P.). Research at
the CMBSO is facilitated by the “Fundacién Ramén Areces”.

Conflict of Interest: none declared.

REFERENCES

Abascal,F. et al. (2005) ProtTest: selection of best-ﬁt models of protein evolution.
Bioinformatics, 21, 2104—2105.

Anisimova,M. and Liberles,D.A. (2007) The quest for natural selection in the age of
comparative genomics. Heredity, 99, 567—579.

Anisimova,M. et al. (2003) Effect of recombination on the accuracy of the likeli-
hood method for detecting positive selection at amino acid sites. Genetics, 164,
1229—1236.

Archer,J. et al. (2008) Identifying the important HIV-1 recombination breakpoints.
PLoS Comput. Biol, 4, e1000178.

Arenas,M. (2012) Simulation of molecular data under diverse evolutionary scen-
arios. PLoS Comput. Biol, 8, 61002495.

Arenas,M. (2013) Computer programs and methodologies for the simulation of
DNA sequence data with recombination. Front Genet, 4, 9.

Arenas,M. and Posada,D. (2007) Recodon: coalescent simulation of coding DNA
sequences with recombination, migration and demography. BM C
Bioinformatics, 8, 458.

Arenas,M. and Posada,D. (2010a) Coalescent simulation of intracodon recombin-
ation. Genetics, 184, 429—437.

Arenas,M. and Posada,D. (2010b) The effect of recombination on the reconstruc-
tion of ancestral sequences. Genetics, 184, 1133—1139.

Bastolla,U. and Demetrius,L. (2005) Stability constraints and protein evolution: the
role of chain length, composition and disulﬁde bonds. Protein Eng. Des. Sel, 18,
405—415.

Bastolla,U. et al. (1999) Neutral evolution of model proteins: diffusion in sequence
space and overdispersion. J. Theor. Biol, 200, 49—64.

Bastolla,U. et al. (2003) Statistical properties of neutral evolution. J. Mol Evol, 57
(Suppl 1), $103—$119.

Bastolla,U. et al. (2005a) Looking at structure, stability, and evolution of proteins
through the principal eigenvector of contact matrices and hydrophobicity pro-
ﬁles. Gene, 347, 219—230.

Bastolla,U. et al. (2005b) Principal eigenvector of contact matrices and hydropho-
bicity proﬁles in proteins. Proteins, 58, 22—30.

Bastolla,U. et al. (2006) A protein evolution model with independent sites that
reproduces site-speciﬁc amino acid distributions from the Protein Data Bank.
BMC Evol. Biol, 6, 43.

Beaumont,M.A. et al. (2002) Approximate Bayesian computation in population
genetics. Genetics, 162, 2025—2035.

Berard,J. and Gueguen,L. (2012) Accurate estimation of substitution rates with
neighbor-dependent models in a phylogenetic context. Syst. Biol, 61, 510—521.

Berezovsky,I.N. et al. (2007) Positive and negative design in stability and thermal
adaptation of natural proteins. PLoS Comput. Biol, 3, e52.

Carbone,M.N. and Amold,F.H. (2007) Engineering by homologous recombination:
exploring sequence and function within a conserved fold. Curr. Opin. Struct.
Biol, 17, 454—459.

Cruzan,M.B. (2001) Population size and fragmentation thresholds for the mainten-
ance of genetic diversity in the herbaceous endemic Scutellaria montana
(Lamiaceae). Evolution, 55, 1569—1580.

Derrida,B. (1981) Random energy model: an exactly solvable model of disordered
systems. Phys. Rev. B, 24, 2613—2626.

Eswar,N. et al. (2006) Comparative protein structure modeling using Modeller.
Curr. Protoc. Bioinformatics, Chapter 5, Unit 5.6.

Ewens,W.J. (1979) Mathematical Population Genetics. Springer-Verlag, Berlin.

Goldstein,R.A. (2011) The evolution and evolutionary consequences of marginal
thermostability in proteins. Proteins, 79, 1396—1407.

Grahnen,J.A. and Liberles,D.A. (2012) CASS: protein sequence simulation with
explicit genotype-phenotype mapping. Trends Evolutionary Biol, 4, 1.

Grahnen,J.A. et al. (2011) Biophysical and structural considerations for protein
sequence evolution. BM C Evol. Biol, 11, 361.

Grifﬁths,R.C. and Marjoram,P. (1997) An ancestral recombination graph. In:
Donelly,P. and Tavaré,S. (eds) Progress in population genetics and human evo-
lution. Springer-Verlag, Berlin, pp. 257—270.

Guerois,R. et al. (2002) Predicting changes in the stability of proteins and protein
complexes: a study of more than 1000 mutations. J. Mol Biol, 320, 369—387.

Hoban,S. et al. (2012) Computer simulations: tools for population and evolutionary
genetics. Nat Rev. Genet, 13, 110—122.

Hudson,R.R. (1983) Properties of a neutral allele model with intragenic recombin-
ation. T heor. Popul Biol, 23, 183—201.

Hudson,R.R. (1998) Island models and the coalescent process. Mol Ecol, 7,
413—418.

Javier Zea,D. et al. (2013) Protein conformational diversity correlates with evolu-
tionary rate. Mol Biol. Evol, 30, 1500—1503.

Juritz,E. et al. (2013) Protein conformational diversity modulates sequence diver-
gence. Mol Biol. Evol, 30, 79—87.

Kingman,J .F. (1982) The coalescent. Stochastic Processes and their Applications, 13,
235—248.

Kosakovsky Pond,S.L. et al. (2008) Estimating selection pressures on HIV-1 using
phylogenetic likelihood models. Stat. Med, 27, 4779—4789.

Krishna,M.M. et al. (2004) Protein misfolding: optional barriers, misfolded inter-
mediates, and pathway heterogeneity. J. Mol Biol, 343, 1095—1109.

Liberles,D.A. et al. (2012) The interface of protein structure, protein biophysics, and
molecular evolution. Protein Sci, 21, 769—785.

Lio,P. and Goldman,N. (1998) Models of molecular evolution and phylogeny.
Genome Res., 8, 1233—1244.

Lukatsky,D.B. et al. (2007) Structural similarity enhances interaction propensity of
proteins. J. Mol Biol, 365, 1596—1606.

Marti-Renom,M.A. et al. (2000) Comparative protein structure modeling of genes
and genomes. Annu. Rev. Biophys. Biomol. Struct., 29, 291—325.

Mendez,R. et al. (2010) Mutation bias favors protein folding stability in the evolu-
tion of small populations. PLoS Comput. Biol, 6, 61000767.

Minning,J. et al. (2013) Detecting selection for negative design in proteins through
an improved model of the misfolded state. Proteins, 81, 1102—1112.

Nasrallah,C.A. et al. (2011) Quantifying the impact of dependent evolution among
sites in phylogenetic inference. Syst. Biol, 60, 60—73.

Neuhauser,C. and Tavaré,S. (2001) The coalescent. Encyclopedia of Genetics, vol. 1,
Academic Press, New York, 392—397.

Noivirt-Brik,0. et al. (2009) Trade-off between positive and negative design of
protein stability: from lattice models to real proteins. PLoS Comput. Biol, 5,
e1000592.

Nordborg,M. (2007) Coalescent Theory. In: Balding,D.J., Bishop,M. and
Cannings,C. (eds) Handbook of Statistical Genetics. 3rd edn. John Wiley &
Sons, Ltd, Chichester, UK, pp. 843—877.

Oostermeijer,J.G. et al. (1994) Offspring ﬁtness in relation to population size and
genetic variation in the rare perennial plant species Gentiana pneumonanthe
(Gentianaceae). 0ecologia, 97, 289—296.

Parisi,G. and Echave,J. (2001) Structural constraints and emergence of sequence
patterns in protein evolution. Mol Biol. Evol, 18, 750—756.

Pollock,D.D. et al. (2012) Amino acid coevolution induces an evolutionary Stokes
shift. Proc. Natl Acad. Sci. USA, 109, E1352—E1359.

Posada,D. (2001) The effect of branch length variation on the selection of models of
molecular evolution. J. Mol Evol, 52, 434—444.

Posada,D. et al. (2002) Recombination in evolutionary genomics. Annu. Rev. Genet,
36, 75—97.

Rastogi,S. et al. (2006) Evaluation of models for the evolution of protein sequences
and functions under structural constraint. Biophys. Chem, 124, 134—144.

Rodrigue,N. et al. (2005) Site interdependence attributed to tertiary structure in
amino acid sequence evolution. Gene, 347, 207—217.

Sali,A. and Blundell,T.L. (1993) Comparative protein modelling by satisfaction of
spatial restraints. J. Mol Biol, 234, 779—815.

Schierup,M.H. and Hein,J. (2000) Recombination and the molecular clock. Mol
Biol. Evol, 17, 1578—1579.

Sella,G. and Hirsh,A.E. (2005) The application of statistical physics to evolutionary
biology. Proc. Natl Acad. Sci. USA, 102, 9541—9546.

Shen,M.Y. and Sali,A. (2006) Statistical potential for assessment and prediction of
protein structures. Protein Sci, 15, 2507—2524.

Simon-Loriere,E. et al. (2009) Molecular mechanisms of recombination restriction
in the envelope gene of the human immunodeﬁciency virus. PLoS Pathog., 5,
e1000418.

Slatkin,M. (1996) Gene genealogies within mutant allelic classes. Genetics, 143,
579—587.

 

3027

112 /810's112umo[pJOJXO'soi112u1101uioiq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

M.Arenas et al.

 

Taverna,D.M. and Goldstein,R.A. (2002a) Why are proteins marginally stable?
Proteins, 46, 105—109.

Taverna,D.M. and Goldstein,R.A. (2002b) Why are proteins so robust to site mu-
tations? J. Mol Biol, 315, 479—484.

Vendruscolo,M. et al. (1997) Recovery of protein structure from contact maps. Fold
Des, 2, 295—306.

Wakeley,J. (2008) Coalescent theory: an introduction. Roberts and Company
Publishers, Greenwood Village, Colorado.

Wilke,C.O. (2012) Bringing molecules back into molecular evolution. PLoS
Comput. Biol, 8, 61002572.

Wiuf,C. and Posada,D. (2003) A coalescent model of recombination hotspots.
Genetics, 407—417.

Xu,Y.O. et al. (2005) Divergence, recombination and retention of functionality
during protein evolution. Hum. Genomics, 2, 158—167.

Yang,Z. (2006) Computational Molecular Evolution. Oxford University Press,
Oxford, England.

Zheng,W. et al. (2013) Frustration in the energy landscapes of multidomain protein
misfolding. Proc. Natl Acad. Sci. USA, 110, 1680—1685.

 

3028

112 /810's112umo[pJOJXO'soi112u1101uioiq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

