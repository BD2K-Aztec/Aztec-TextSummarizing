APPLICATIONS NOTE V°" 33.5%.53923‘3275533;3332:3322

 

Sequence analysis

Advance Access publication August 20, 2014

Poretools: a toolkit for analyzing nanopore sequence data

Nicholas J. Loman” and Aaron R. Quinlan”

1Institute of Microbiology and Infection, University of Birmingham, Birmingham B15 2'IT, UK and 2Department of Public
Health Sciences, University of Virginia, Charlottesville 22932, VA, USA

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: Nanopore sequencing may be the next disruptive tech-
nology in genomics, owing to its ability to detect single DNA molecules
without prior amplification, lack of reliance on expensive optical com-
ponents, and the ability to sequence long fragments. The MinIONTM
from Oxford Nanopore Technologies (ONT) is the first nanopore se-
quencer to be commercialized and is now available to early-access
users. The MinIONTM is a USB-connected, portable nanopore sequen-
cer that permits real-time analysis of streaming event data. Currently,
the research community lacks a standardized toolkit for the analysis of
nanopore datasets.

Results: We introduce poretools, a flexible toolkit for exploring data-
sets generated by nanopore sequencing devices from MinIONTM for
the purposes of quality control and downstream analysis. Poretools
operates directly on the native FAST5 (an application of the HDF5
standard) file format produced by ONT and provides a wealth of
format conversion utilities and data exploration and visualization tools.
Availability and implementation: Poretools is an open-source soft-
ware and is written in Python as both a suite of command line utilities
and a Python application programming interface. Source code is freely
available in Github at https://www.github.com/arq5x/poretools
Contact: n.j.loman@bham.ac.uk and aaronquinlan@gmail.com
Supplementary information: An lethon notebook demonstrating the
functionality of poretools is in Github. Complete documentation is
available at http://poretools.readthedocs.org.

Received and revised on July 29, 2014; accepted on August 11, 2014

1 INTRODUCTION

DNA sequencing with biological nanopores was proposed
almost 20 years ago (Church et al., 1995). This approach relies
on the direct electrical detection of single DNA strands in con-
tact with an individual pore. Single molecule detection and the
absence of a prior ampliﬁcation step means that extremely long
fragments can be sequenced without any loss in quality. In May
2014, Oxford Nanopore Technologies released MinIONTM, the
ﬁrst commercially available nanopore DNA sequencing device.
MinIONTM is noteworthy for its portability, size (around the
same length as an iPhoneTM) and USB 3.0 connectivity, meaning
it can be run on a standard Internet-connected laptop. Research
groups throughout the world are actively evaluating this device
for a broad range of applications. Sequencing with the MinION
yields raw signals reﬂecting modulation of the ionic current at
each pore by a DNA molecule. The resulting time-series of nano-
pore translocation, ‘events’, are base-called by proprietary

 

*To whom correspondence should be addressed.

software running as a cloud service. The resulting ﬁles for each
sequenced read are stored in ‘FASTS’ format, an application of
the HDF5 format. However, at present, no speciﬁc software is
available to facilitate downstream analyses starting with this ﬁle
format.

2 FEATURES AND METHODS

We have developed poretools, an open-source software tool-
kit that addresses the pressing need for methods to manipulate
the FAST5 format and permit explorations of the raw nanopore
event data and the resulting DNA sequences. Poretools pro-
vides an extensive set of data analysis methods that operate dir-
ectly on either a single FAST5 ﬁle or a set of ﬁles from one or
more sequencing runs. A Python programming library is pro-
vided to facilitate access to the FAST5 ﬁle structure and
enable other researchers to extend the tools and create new ana-
lytical methods. In the following sections, we summarize the
functionality currently available in poretools.

2.1 Format conversion

The most fundamental functionality provided by poretools is
the ability to convert the output data resulting from a MinION
run from HDF5/FAST5 format to either FASTA or FASTQ
format to facilitate analyses with sequence alignment and/ or as-
sembly software. This is accomplished with the f as ta and
fastq commands in the poretools suite.

poretools fasta /path/ to/ fast5/example . fast5
poretools fastq /path/ to/ fast5/example . fast5

At the time of writing, each MinION run generates individual
HDF5/FAST5 ﬁles for each sequenced read. Consequently, there
are often tens of thousands of individual ﬁles that must be stored
for a single experiment. Poretools provides two different stra-
tegies for facilitating the analysis of such datasets. The ﬁrst ap-
proach allows one to execute a poretools command on an
entire directory of FAST5 ﬁles.

poretools fastq /path/to/fast5/directory/

Alternatively, we provide a utility to combine a set of HDF 5/
FAST5 ﬁles into a single TAR ﬁle. This allows an entire run to
be archived into one ﬁle and once combined, all other pore—
tools commands are able to operate on each HDF5/FAST5
ﬁle therein. For example:

poretools combine —0 run.tar /path/to/fast5/
directory/poretools fastq run. tar

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬂJO'slcumo[pJOJXO'sopchogutorq/ﬁd11q wort pepcolumoq

910K ‘09 lsnﬁnV no :2

N.J.Loman and A.R.Quinlan

 

 

A

4000 -

3000 -

2000 -

Read count

1000 -

 

 

 

 

0 10000 20000 30000 40000
Read length

Total reads

 

Yield: 53914 reads and 296997439 base pairs.

40000 '

20000 -

 

 

 

0 10 éo
Time (hours)

 

 

90-

85-

80-

75 -

70 -

65-

 

 

 

Mean signal (picoamps)

 

 

 

Time (seconds)

Fig. 1. Example poretools visualizations from a set of FAST5 ﬁles generated by a single MinIONTM run. Panel A shows a histogram of read lengths.
Panel B shows a collector’s curve of reads over time. Panel C shows an example squiggle plot of detected event transitions originating from MinIONTM

Table 1. Summary of currently supported operations in poretools

 

 

Command Description

combine Combine a set of FAST5 ﬁles in a TAR archive.
events Extract each nanopore event for each read.

f as ta Extract FASTA sequences from a set of FAST5 ﬁles.
f as tq Extract FASTQ sequences from a set of FAST5 ﬁles.
hist Plot read size histogram for a set of FAST5 ﬁles.
nucdist Measure the nucleotide composition.

qualdist Measure the quality score composition.

reads tats Extract signal information for each read over time.
squiggle Plot the observed signals for FAST5 reads.

stats Get read size stats for a set of FAST5 ﬁles.
tabular Extract sequence information in TAB delimited format
times Return the start times from a set of FAST5 ﬁles.
winner Extract the longest read from a set of FAST5 ﬁles.
yield _plot Plot the sequencing yield over time.

 

2.2 Data exploration and visualization

There is a need to visualize MinIONTM run performance to
assess its quality and troubleshoot different fragmentation and
library preparation strategies. Poretools provides two utilties,
hist and yield _plot, that characterize the fragment size dis-
tribution and display a collector’s curve of the overall sequencing
yield, respectively. Example commands are provided here, with
corresponding ﬁgures shown (Fig. 1A and B).

poretools hist /path/to/ fast5/directory/
poretools yie1d_plot /path/ to/ fast5/directory/

As summarized in Table l, poretools also provides several
utilities for extracting the low-level details that led to each base
called sequence (see Table l for details). In particular, the
events utility reports the mean current observed for each nano-
pore translocation event, as well as the time (in milliseconds) of
each event and the k—mer that was predicted to have occupied the

 

3400

112 [glO'SIBILInO[plOJXO'SODBIIIJOJHIOIQ/[ldllq won pepcolumoq

910K ‘09 lsnﬁnV no :2

Poretools

 

nanopore during the event. The squiggle utility permits visu-
alization of this information (Fig. 1C). The Oxford Nanopore
base-calling software uses a Hidden Markov Model to predict a
fragment’s sequence based on this event data. We anticipate that
the events utility (and others) will help developers explore im-
proved base-calling strategies.

2.3 Python library for data analysis

The utilities provided in the poretools suite will inevitably
prove to be insufﬁcient for every analysis that a researcher
wishes to conduct. Recognizing this, we have developed a
Python programming interface that researchers can use to dir-
ectly access the sequence data, the raw nanopore event data and
other metadata (e.g. the ﬁowcell and run identiﬁers) contained in
one or more FAST5 ﬁles. To demonstrate of the Python inter-
face, the following code reports the start time, the speciﬁc
nanopore and the based-called sequence for each FAST5 ﬁle in
a sequencing run.

from poretools import Fast5FileSet
fast5s = Fast5FileSet(’/path/to/fast5/ﬁles/’)
for fast5 in fast5s:
start = fast5.get_start_time()
porenum = fast5.get_channel_number()
fq = fast5.get_fastq()
print porenum, start, fq.seq, fq.qual
fast5.close()

3 DISCUSSION

The poretools software helps solve pressing requirements for
analysis of nanopore sequencing data. By focusing on the Python

development environment and adopting expected interface con-
ventions as popularized by other popular bioinformatics tools
such as samtools (Li et al., 2010) and bedtools (Quinlan
et al., 2009), we expect that users will be able to rapidly exploit
the functionality offered by this software. We anticipate that
other toolkits will become available written in other program-
ming languages. Further efforts are required for downstream
analysis for common tasks including alignment and de novo as-
sembly of both event and base-called sequence data from this
platform.

ACKNOWLEDGEMENTS

The authors would like to express their gratitude to the em-
ployees of ONT for assistance during the MinION Access
ProgrammeTM, with particular thanks to Zoe McDougall,
Clive Brown, Daniel Turner, Stephanie Brooking, Roger
Pettett and Stuart Reid. We would like to thank members of
the MinION user community who have tested poretools
and continue to provide feedback and bug reports.

Funding: N.J.L. is funded by a Medical Research Council Special
Training Fellowship in Biomedical Informatics. A.R.Q. was sup-
ported by the NIH (NGHRI; lROlHGOO6693-Ol).

Conﬂict of interest: none declared.

REFERENCES

Church,G.M. et a]. (1998) Characterization of individual polymer molecules based
on monomer-interface interaction. US patent no. 5,795,782 (ﬁled March 1995)
http://www.google.com/patents/US20120160687.

Li,H. et a]. (2009) The Sequence alignment/map (SAM) format and SAMtools.
Bioinformatics, 25, 2078—2049.

Quinlan,A.R. and Hall,I.M. (2010) BEDTools: a ﬂexible suite of utilities for com-
paring genomic features. Bioinformatics, 26, 841—842.

 

3401

112 /810's112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

