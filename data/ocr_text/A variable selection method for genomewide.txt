ORIGINAL PAPER

Vol. 27 no. 1 2011, pages 1—8
doi: 1 0. 1 093/bioinformatics/btq600

 

Genome analysis

Advance Access publication October 29, 2010

A variable selection method for genome-wide association studies

Qianchuan He and Dan-Yu Lin*

Department of Biostatistics, University of North Carolina, Chapel Hill, NC 27599, USA

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: Genome-wide association studies (GWAS) involving half
a million or more single nucleotide polymorphisms (SNPs) allow
genetic dissection of complex diseases in a holistic manner. The
common practice of analyzing one SNP at a time does not fully
realize the potential of GWAS to identify multiple causal variants and
to predict risk of disease. Existing methods forjoint analysis of GWAS
data tend to miss causal SNPs that are marginally uncorrelated with
disease and have high false discovery rates (FDRs).

Results: We introduce GWASeIect, a statistically powerful and
computationally efficient variable selection method designed to
tackle the unique challenges of GWAS data. This method searches
iteratively over the potential SNPs conditional on previously selected
SNPs and is thus capable of capturing causal SNPs that are
marginally correlated with disease as well as those that are marginally
uncorrelated with disease. A special resampling mechanism is built
into the method to reduce false positive findings. Simulation studies
demonstrate that the GWASeIect performs well under a wide
spectrum of linkage disequilibrium patterns and can be substantially
more powerful than existing methods in capturing causal variants
while having a lower FDR. In addition, the regression models based
on the GWASeIect tend to yield more accurate prediction of disease
risk than existing methods. The advantages of the GWASeIect
are illustrated with the Wellcome Trust Case-Control Consortium
(WT CCC) data.

Availability: The software implementing GWASeIect is available at
http://www.bios.unc.edu/~lin.

Access to WTCCC data: http://www.wtccc.org.uk/

Contact: lin@bios.unc.edu

Supplementary information: Supplementary data are available at
Bioinformatics Online.

Received on May 25, 2010; revised on September 22, 2010;
accepted on October 20, 2010

1 INTRODUCTION

Genome-wide association studies (GWAS) have become
increasingly popular for studying complex human diseases.
Within the last several years, the number of single nucleotide
polymorphisms (SNPs) per DNA array has grown from 10000 to
1 million (Altshuler et al., 2008). Despite the very large number
of SNPs that are genotyped in a study, GWAS data are commonly
analyzed one SNP at a time. Indeed, the Armitage trend test (ATT)
is used almost exclusively.

 

*To whom correspondence should be addressed.

There are at least two strong reasons for considering all the SNPs
or at least a large subset of them simultaneously. First, the marginal
effects of SNPs (i.e. the effect of each SNP on disease when it is
considered alone) may be quite different from their joint effects:
(i) a SNP that is not related to disease but is correlated with a causal
SNP will be marginally associated with disease; (ii) some SNPs may
have weak marginal effects but strong joint effects. Conditional on
causal SNPs that are already in the model, false positive signals tend
to be weakened while marginally uncorrelated causal SNPs have a
better chance of being selected. Second, the predictive power of a
single SNP tends to be very low. The accuracy of prediction can
be improved substantially by utilizing a large number of relevant
SNPs.

It is extremely challenging to decide which set of SNPs should
be included in the joint analysis because the number of SNPs in
a GWAS is much larger than the sample size. This is commonly
referred to as the ‘small 11, large p’ problem. A major difﬁculty in
this problem is that the number and extent of spurious associations
between predictors and response increase rapidly with increasing p.
Weak effects of causal variants and strong linkage disequilibrium
(LD) among SNPs present additional challenges.

There is a large body of literature on variable selection methods,
including bridge regression (Frank and Friedman, 1993), least
absolute shrinkage and selection operator (LASSO; Tibshirani,
1996), smoothly clipped absolute deviation (SCAD; Fan and Li,
2001), elastic net (Zou and Hastie, 2005) and adaptive lasso (Zou,
2006). However, these methods were designed for a moderate
number of predictors (i.e. tens or hundreds). For ultra—high p,
these methods may be computationally infeasible and statistically
inaccurate.

Recently, Fan and LV (2008) developed the so-called sure
independence screening (SIS) strategy for high—dimensional
statistical modeling. The idea is to ﬁrst reduce the dimension
from a very large scale to a moderate scale that is below sample
size by univariate correlation learning, and then select important
predictors by a moderate-scale variable selection method, such as
the LASSO or SCAD. In a similar spirit, Wu et al. (2009) reduced
the dimension of SNPs in a GWAS to several hundreds using a
simple score criterion and applied the LASSO to the reduced set
of SNPs. A drawback of this approach is that important features
that are marginally uncorrelated with response are bound to be
missed because the univariate screening step is based entirely on
marginal correlations. Fan and LV (2008) suggested the iterative
sure independence screening (ISIS) procedure, which iterates the
SIS procedure conditional on the previously selected features so as
to capture important features that are marginally uncorrelated with
response. Fan and LV’s work is conﬁned to linear regression of a

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1

112 Bio'SIBulnoprOJxo'soi112u110juioiq//:d11q IIIOJJ pepeommoq

9IOZ ‘ISlsnﬁnV uo ::

Q.He and D.-KLin

 

continuous response, and the number of features they considered is
merely thousands.

In this article, we extend Fan and LV’s ISIS idea to logistic
regression of case—control GWAS data. This extension is challenging
for several reasons. First, the ISIS performs linear regression
analysis of residuals, but residuals cannot be used as response
variables in logistic regression. Second, prediction errors tend to be
much higher for binary outcomes than continuous outcomes. Third,
the number of SNPs can be extremely large, typically more than half
a million. Fourth, the effects of causal SNPs on complex diseases
tend to be small to modest, so the signal-to-noise ratio in GWAS data
is low. Fifth, the LD among SNPs is extensive and can be extremely
high in certain regions.

A separate challenge is that the false discovery rate (FDR)
associated with the ISIS, and indeed with any existing variable
selection method, tends to be high. Recently, Meinshausen and
Biihlmann (2010) proposed the stability selection strategy to reduce
the FDR. The idea is to repeatedly subsample the original data and
perform variable selection on each subsample. The features selected
frequently among the subsamples tend to be truly associated with
outcome and thus should be included in the ﬁnal model. In this
article, we integrate stability selection into our ISIS procedure to
develop a new approach, GWASelect, for genome-wide variable
selection.

We describe our approach in the next section. In Section 3,
we demonstrate through simulation studies that GWASelect has
robust performance under a variety of LD structures and can
substantially increase the power and reduce the FDR compared with
existing methods. In addition, the regression models generated by
GWASelect signiﬁcantly improve prediction accuracy. In Section 4,
we apply GWASelect to the GWAS data from the Wellcome Trust
Case-Control Consortium (WTCCC, 2007) and show that it yields
several novel discoveries and improves prediction accuracy.

2 METHODS

Our ISIS method consists of one marginal SIS and two rounds of conditional
SIS. We ﬁrst describe the marginal SIS procedure. The data contain n subjects
and p SNPs. The genotypes of each SNP are standardized by its sample SD.
The SIS theory suggests to reduce the original set of features to a small subset
whose dimension is in the order of n / logn. Since binary outcomes generally
contain less information than continuous outcomes, we shrink the dimension
of SNPs from p to n/(4logn). The SIS theory also suggests to use a large
proportion of the subset for the marginal SIS; therefore, we choose to use
1 SNPs, where t is the integer part of 0.9n/(4logn). That is, we perform the
ATT (under the additive model) on each SNP and select the 1 most signiﬁcant
SNPs to form a set 81. Then we apply the LASSO to 81 as follows.

For i: 1, . . . ,n, let Y,- denote the disease status (1 = case, 0 = control), and
X,- denote the (t+1)-vector consisting of 1 and the genotypes of the t SNPs
in 81. The genotype of each SNP is represented by the number of minor
alleles. It is natural to assume the logistic regression model

CXPCBTXi)

Pr(Yi :  : 1+exp(ﬂTXi) 9

where ,8=(,80,,81,...,,8t)T denotes the vector of unknown regression
coefﬁcients. The penalized log-likelihood function takes the form

n

t
7(ﬂ)=Z[YiﬂTXi-10g{1+6Xp(ﬂTXi)}]-AZ|ﬂjl,
i=1

i=1

where A is the tuning parameter.

We adopt the cyclic coordinate decent (CCD) algorithm (Friedman et al.,
2010; Genkin et al., 2007), which is tantamount to maximizing 7(8) in
a component-wise manner. Cross-validation can be used to determine the
tuning parameter (and consequently the model size), but for now, we set
the model size to a user-speciﬁed number, say d. (We will show later how
to determine the model size adaptively.) That is, we run the LASSO on a
dense grid of A until it generates a model containing d predictors. If the exact
number of d cannot be achieved, we choose the model whose size is right
below d. This model is labeled M1.

To reduce potential collinearity, we prune M1 using pairwise correlations.
Our analysis revealed that 99.9% of the pairwise correlations among the
Illumina300K SNPs have absolute values less than 0.8 (corresponding to r2
of 0.64). Thus, we set the pruning threshold for r2 to 0.64 so as to minimize
the loss of information due to pruning. The pruned model is labeled 
This marks the end of the marginal SIS.

Assuming that M’f contains 11 SNPs, we label the set of the remaining
(p — tl) SNPs as  We use the conditional SIS described below to capture
important SNPs in M? that are marginally uncorrelated with disease. The
ﬁrst step is to screen all the SNPs in M? to identify a small set of
candidate SNPs that are correlated with Y conditional on  This step
is computationally challenging because the cardinality of MT is close to p,
which can be 1 million. We develop the following conditional score test to
accomplish this task in a very efﬁcient manner.

For the i-th subject, let W,- be the (t1+1)-Vector consisting of 1 and the
genotypes of the tl SNPs in  Let ZJ- be the j-th SNP in WT, and Zﬁ
be the value of ZJ- on the i-th subject, where j = 1, ...,p— 11. We assume the
logistic regression model:

T

Pf(Yi=1|Zji,Wi)= w,

+6XP(VZji+TI Wt)
where y and n are unknown regression coefﬁcients. We are interested in
testing the null hypothesis H0 : y=0. It is computationally intensive to ﬁt
the above model for each of the (p— 11) SNPs. To bypass this difﬁculty, we
perform the conditional score test. Speciﬁcally, we calculate S: U / Vl/ 2,
where

n T
eXpGi W-)
 ﬂ,
i=1 1+exp(’rj W,)
V =1W —I,,,,I,;711;7,

I  2
W i=1{1+exprTW.-)}2 1"

I 2X": exmeW—i) 'iWiT,
V" i=1{1+exp(’n‘TWz-)}2 ’
n T
CXPGT W1) T
= —W-W-,
’7” z:{1+exprTW.-)}2 ’ ’

i=1
and’ﬁis the maximum likelihood estimator of 1} under H0. Note that? and In,7

do not involve any data in M? and thus need to be calculated only once at the
outset of the conditional SIS. Given ’17 and 1,;71, we calculate the test statistic

S for each of the (p — 11) SNPs in  In vein with the SIS theory, we choose
the most signiﬁcant q SNPs, where q is the integer part of 0.05n/(4logn),
and call this set of SNPs 82. (We use 0.05 since 0.9 +0.05 +0.05 2 1, where
0.9 pertains to the marginal SIS, and (0.05+0.05) to the two rounds of
conditional SIS.)

The ﬁrst step of the conditional SIS is aimed at identifying important
SNPs that are marginally uncorrelated (but conditionally correlated) with
disease while weakening the priority of those unimportant SNPs that are
highly associated with disease through their correlations with the SNPs in
 In the second step, we combine 82 with M’f and run the LASSO to
select a model M2 with d SNPs. During this process, new SNPs may be
selected, and previously selected SNPs have a chance to be removed from

 

112 /810'SIBulnoprOJxo'soi112u110juioiq//:d11q IIIOJJ pepeommoq

9IOZ ‘ISlsnﬁnV uo ::

GWAS variable selection

 

Original data

/ /

Subsample 1 Subsample 2

Q
I

\

Subsample 50

Conditional SIS Conditional SIS

HiO
)llio

Conditional SIS Conditional SIS

\

GWASeIect model

/

 

r—
M)

Fig. 1. Flowchart of the proposed GWASeIect method.

the model. We prune M2 to form a new model  This completes the
conditional SIS.

To increase the opportunities of capturing important SNPs, we repeat the
conditional SIS once and call the ﬁnal model  We refer to M; as the
ISIS model.

To reduce the FDR, we combine the extended ISIS procedure with the
stability selection strategy (Meinshausen and Biihlmann, 2010) to create the
GWASeIect method, as illustrated in Figure 1. Speciﬁcally, we randomly
obtain half of the cases and half of the controls from the GWAS data to form
a subsample and then run the ISIS on this subsample. The resulting model is
named 71. Repeating this subsampling concatenated with the ISIS 50 times,
we obtain T1,...,T50. Let T: U217}, and denote T: {v1,...,vL}. We then
calculate the selection probabilities for the L SNPs in T

L11
0

m=ZI(v,e7;-)/50, l=1,...,L,

i=1

where I (-) is the indicator function. We choose the d SNPs with the highest
selection probabilities from T to form the GWASeIect model.

It is sometimes desirable to determine the model size adaptively from the
data. To this end, we develop dynamic-GWASeIect (d-GWASelect), which
contains two modiﬁcations to the GWASeIect. The ﬁrst modiﬁcation is that
cross-validation is used to determine the tuning parameter for the LASSO
embedded in the ISIS. Speciﬁcally, we divide the data randomly into ﬁve
equal parts, with the k-th (k=1,...,5) part being the testing data and the
remaining four parts being the training data. For a given tuning parameter
A, we apply the LASSO to the training data and select the SNPs that have
non-zero regression coefﬁcients. We calculate the liability score (i.e. the
linear predictor) for each testing subject. Let .71 denote the set of subjects
with the highest 6 x 100% liability scores, and .72 the set with the lowest
6 x 100%, where 6 is a user-speciﬁed number between 0 and 0.5. We then
calculate the 6-error rate, deﬁned as (El-€51 |Y,- — 1|+ 2,572 |Y,- —0|)/(26’ﬁ),
where 71' is the number of subjects in the testing data. We choose the value of
A that minimizes the 6-error rate averaged over the ﬁve testing datasets for
6 = 0.1.

The second modiﬁcation is that, instead of ﬁxing the model size at d, we
specify a selection threshold 5 and select all SNPs with selection probabilities

Z 5. As shown in the next section, the inﬂuence of S on the ﬁnal model is
typically small.

3 SIMULATION STUDIES

Each simulated dataset contained 2000 cases and 2000 controls. For
each subject, we simulated 20 chromosomes, each containing 3000
SNPs. The disease status was generated from the logistic regression
model containing 10 causal variants, G1, ...,G10, with the vector of
log odds ratios ,6*.

We considered three simulation schemes for the causal
SNPs. In the ﬁrst scheme, we simulated 10 independent
causal SNPs that are located on 10 different chromosomes,
with minor allele frequencies (MAFs) of 0.3. We set ,6* =
(—0.35, —0.35,0.35,0.35,0.35,0.35,0.35, —0.35, —0.35, —0.35)T.

In the second scheme, we let {G1, ...,G10} reside on one
chromosome and have a special correlation structure such that the
correlation between any two causal variants is nearly 0.6. We set
,B*=(0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3)T.

In the third scheme, multiple causal SNPs were generated to
be marginally uncorrelated with Y. We let the ﬁrst causal SNP be
independent of the other nine causal SNPs. The latter were simulated
to form three clusters, {G2, G3, G4}, {G5, G6, G7} and {G8, G9, G10},
each cluster residing on one chromosome. The three clusters are
independent of each other, but within each cluster, SNPs have
a compound symmetry correlation structure with correlation 0.5 .
We set ,B*=(0.5, —0.5, —0.5,0.5,0.5, —0.5,0.5, —0.5,0.5, —0.5)T.
Under this scheme, corr(Y,G4), corr(Y,G6) and corr(Y,Gg) are
equal to 0.

For all three schemes, the positions of the causal variants on the
chromosomes were randomly chosen. Thus, our simulation results
would not be affected by any local LD patterns.

It is not trivial to simulate non-causal SNPs as they are desired
to mimic the actual LD structure of human population. There
exist several genome simulators based on the coalescent approach
(Hudson, 2002), for which the users have to arbitrarily specify
a number of parameters. As an alternative, the GWAsimulator
of Li and Li (2008) employs a moving-window mechanism and
can simulate genotypes based on the Illumina HumanHap300 chip
data. We adopted the latter approach. Because the average distance
between two SNPs for the Illumina HumanHap300 chip data is
roughly 10kb, the total length we simulated is approximately
600 Mb, which accounts for 1 / 5 of the whole genome. The LD was
well preserved and no trimming was done for the simulated data.

Hoggart et al. (2008) explored variable selection from a Bayesian
point of View by imposing the Laplace prior or the normal
exponential gamma prior on each SNP. The former prior yields
the LASSO procedure, while the latter generates a more sparse
model and is called hyper-LASSO (HLASSO). We included the
HLASSO in our simulation studies. Thus, we analyzed the simulated
data by ﬁve methods: (i) the ATT method, for which the threshold
for declaring signiﬁcance was set to 0.05/60000 (i.e. Bonferroni
correction); (ii) the method by Wu et al. (2009); (iii) the (extended)
ISIS method; (iV) the HLASSO; and (V) the GWASelect method. We
set the model sizes to 15 for all methods (except the ATT) because
most biology labs are likely to restrict their resources to a small
number of top SNPs.

There are different criteria to evaluate a variable selection method.
We chose to use the true discovery rate (TDR) and false discovery

 

112 /810'SIBulnoprOJxo'soi112u110juioiq//:d11q IIIOJJ pepeommoq

9IOZ ‘ISISnﬁnV uo ::

Q.He and D.-KLin

 

Table 1. True and false discoveries of variable selection methods when the
model sizes are ﬁxed at 15 (except for the ATT method)

Table 2. Prediction accuracy of variable selection methods when the model
sizes are ﬁxed at 15 (except for the ATT method)

 

ATT Wu et al. ISIS HLASSO GWASeIect

ATT Wu et al. ISIS HLASSO GWASeIect

 

Scheme 1

Model size 26 15 15 15 15
Tpca 9.59 9.92 9.98 9.99 9.93
FPCb 0.06 2.02 4.04 3.84 1.52
TDR (%) 95.9 99.2 99.8 99.9 99.3
FDR (%) 0.6 15.8 28.5 26.4 12.4
Scheme 2

Model size 103 15 15 15 15
Tpca 9.90 9.68 7.99 9.27 9.07
chb 4.8 1.05 3.88 4.89 0.03
TDR (%) 99.0 96.8 79.9 92.7 90.7
FDR (%) 31.5 8.6 31.0 32.8 0.3
Scheme 3

Model size 41 15 15 15 15
Tpca 7.07 6.97 8.80 9.99 9.29
FPCb 0.08 4.97 4.88 4.47 1.92
TDR (%) 70.7 69.7 88.0 99.9 92.9
FDR (%) 1.0 40.3 35.3 29.4 16.0
G40 (%) 0 1 89 100 96

 

aNumber of true positive clusters.

bNumber of false positive clusters.

0The rate of capturing the fourth causal SNP, which is marginally uncorrelated with
disease under scheme 3.

rate (FDR; Benjamini and Hochberg, 1995) because the main goal
of GWAS is to identify causal variants. For genetic studies, how to
deﬁne the true discovery and false discovery is a delicate issue. This
is because once a SNP is declared to be signiﬁcant, all SNPs that are
close to and in LD with that SNP will be followed up. We deﬁned the
true positive and false positive as follows. If a captured SNP was no
more than 50 SNPs away from a true causal SNP and had r2 > 0.05
with that same causal SNP, then we classiﬁed it as a true positive.
[Our experiments revealed that replacing 50 with 20 yielded similar
results; Hoggart et al. (2008) provided a rationale for choosing 0.05
for r2.] If more than one SNP satisﬁed these conditions, we counted
them only as one true positive cluster. The remaining captured SNPs
were classiﬁed as false positives. If two false positive SNPs were no
more than 10 SNPs apart (i.e. within 100 kb in distance), we counted
them as only one false positive cluster. The calculations of the TDR
and FDR were based on clusters, rather than on individual SNPs.
For each simulation scheme, the number of replications was set to
200. The results are shown in Table 1.

Scheme 1 was designed to compare the ﬁve methods under
a scenario where all causal variants are independent and their
effects are moderate. Under this scheme, all ﬁve methods yield high
TDRs (>95%), but the FDRs are highly variable. Despite a large
model size, the ATT method has the lowest FDR. This seemingly
paradoxical phenomenon is explained by the fact that most of the
SNPs in the ATT model are highly clustered due to strong LD. The
GWASelect model has an elevated FDR, but far lower than the ISIS
and the HLASSO, and slightly lower than the Wu et al. model. This
demonstrates that, by repeated subsampling and variable selection,
GWASelect is able to remove many noise features from the model.
The ATT method appears to be a good option when causal variants

Scheme 1

p-diffa 0.023 0.023 0.028 0.028 0.021
liab-correlb 0.931 0.943 0.919 0.920 0.948
log-likelihood —760.0 —759.3 —763.4 —763.1 —758.6
Scheme 2

p-diffa 0.067 0.028 0.073 0.048 0.053
liab-correlb 0.912 0.986 0.912 0.961 0.955
log-likelihood —976.0 —938.9 —983.8 —955.7 —957.7
Scheme 3

p-diffa 0.045 0.050 0.037 0.028 0.027
liab-correlb 0.801 0.771 0.874 0.937 0.926
log-likelihood —720.0 —725.9 —710.9 —701.9 —701.8

 

aThe absolute difference between the model-predicted and true disease probabilities.
bLiability correlation.

are independent with moderate effects, but if one wishes to achieve
higher power without too many false discoveries, the GWASelect
method would be a reasonable choice.

In scheme 2, all 10 causal variants are correlated with each other,
which makes variable selection more challenging. It can be shown
that under this scheme, the marginal effects of the causal SNPs
are much higher than their joint effects. For variable selection, this
has the undesired effect of selecting unimportant SNPs that are in
proximity of the causal SNPs. Reﬂecting this fact, the ATT, the ISIS,
and the HLASSO all have FDRs above 30%. The GWASelect is
able to keep the FDR at a low level and preserve most of the power
because of stability selection. The Wu et al. method has high power
and a relatively low FDR, suggesting that this method is particularly
capable of distinguishing causal SNPs from unimportant SNPs that
are in LD with them.

Scheme 3 represents a more complex correlation structure in
which the three causal SNPs (i.e. the fourth, sixth and ninth SNPs)
are marginally uncorrelated with Y. As expected, the methods that
are strongly driven by marginal correlations, such as the ATT and
the Wu et al. method, almost completely missed G4, which drives
down their power to 70%. Both the ISIS and the HLASSO methods
achieved higher power, but at the price of high FDRs (around 30%).
The GWASelect model offers a more balanced solution in terms of
the TDR and FDR.

In summary, only the HLASSO and the GWASelect were able to
keep their power above 90% under all three schemes, and the latter
appears to have a much lower FDR. The other three methods either
lack power under some schemes or entail high FDRs in others.

Next, we investigated the prediction accuracy of the ﬁve methods.
For each scheme, we further simulated 2000 testing subjects
under the prospective sampling. To avoid numerical instabilities,
we pruned the obtained models and used the pruned models for
prediction. We calculated the true liability score and the estimated
liability score for each subject and used the correlation between the
two scores as a measure of prediction accuracy. We also calculated
the absolute difference between the model-predicted and true disease
probabilities, termed as p-diff, to measure the prediction error. The
results are shown in Table 2.

 

112 [3.10'SIBIIJHO[plOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ pepeommoq

9IOZ ‘ISISnﬁnV uo ::

GWAS variable selection

 

Table 3. True and false discoveries of variable selection methods with cross-
Validation incorporated (except for the ATT method)

Table 4. Prediction accuracy of variable selection methods with cross-
Validation incorporated (except for the ATT method)

 

 

 

 

 

ATT Wu et al. ISIS HLASSO d-GWASelect ATT Wu et al. ISIS HLASSO d-GWASelect
Scheme 1 Scheme 1
Model size 32 102 75 42 20 p-diff'“I 0.018 0.076 0.073 0.046 0.016
TPCa 9.95 10.00 10.00 10.00 10.00 liab-correlb 0.951 0.671 0.702 0.849 0.968
FPCb 0.04 63.61 47.24 30.77 0.85 log-likelihood —661.4 —745.9 —739.3 —719.6 —659.7
TDR (%) 99.5 100.0 100.0 100.0 100.0 Scheme 2
FDR (%) 0-4 86-1 82-0 40-8 7-2 p-diff“ 0.033 0.046 0.063 0.027 0.027
Scheme 2 liab-correlb 0.912 0.873 0.802 0.942 0.946
Model size 77 49 50 14 20 log-likelihood —754.3 —771.4 —795.4 —756.8 —749.4

a
1:8 :1: :8. 3.42. 1:: 33: 
' ' ' ' ' p-diff'“I 0.039 0.082 0.061 0.062 0.017

TDR (%) 97-3 98-8 94-0 79-6 90-9 liab-correlb 0.786 0.519 0.751 0.787 0.964
FDR (%) 10-8 54-8 67-7 17-1 2'0 log-likelihood —645.1 —725.5 —681.7 —713.7 —624.8
Scheme 3
Model Size 39 101 68 59 22 3T he absolute difference between the model-predicted and true disease probabilities.
TPCa 7.01 7.13 9.99 9.87 9.85 bLiability correlation.
FPCb 0.04 62.82 39.20 47.41 0.65
TDR (%) 70.1 71.3 99.9 98.7 98.5 . , , ,
FDR (%) 0_ 4 896 7&8 573 57 (instead of the 10% error rate) as the evaluatlon cr1ter10n for cross-
G4c (%) 0 1 100 39 37 validation, and the d-GWASelect remains more favorable than the

 

aNumber of true positive clusters.

bNumber of false positive clusters.

0The rate of captun'ng the fourth causal SNP, which is marginally uncorrelated with the
disease outcome under scheme 3.

The Wu et al. method excels under scheme 2, consistent with its
high TDR and low FDR under this scheme. However, both the Wu
et al. and the ATT are less accurate than the other methods under
scheme 3 because they missed those marginally uncorrelated SNPs.
The HLASSO performs well under schemes 2 and 3, suggesting that
high prediction power can be achieved even if some noise features
are included in the model. Only the HLASSO and the GWASelect
have prediction accuracy above 0.9 under all three schemes.

To assess data-adaptive choice of model size, we repeated the
above simulation studies but now incorporated a 5-fold cross-
Validation into all the methods (except the ATT) by using the
10% error rate as the evaluation criterion (see Section 2). For
d-GWASelect, we set the selection threshold 5 to 0.3. All effect
sizes were set to be moderate. For both schemes 1 and 3, ,B* =
(0.4, —0.4,—0.4,0.4,0.5,—0.5,0.5,—0.6,0.6,—0.6)T. For scheme
2, ,B* =(0.2,0.2,0.2,0.2, 0.2,0.2,0.2,0.2,0.2,0.2)T. The results are
shown in Tables 3 and 4.

The d-GWASelect remains a robust variable selection method
under all three schemes and indeed appears to have a better
performance than its counterpart with a ﬁxed model size. The
Wu et al., the ISIS and the HLASSO now entail extremely high
FDRs and poor prediction accuracy. The reason is that cross-
Validation often favors a large model size for logistic regression,
especially when the signal—noise ratio is low. The d-GWASelect
method, however, has a well-controlled model size because stability
selection sifts away many noise features. Overall, the d-GWASelect
enjoys low FDR, high TDR and excellent prediction performance.
Replacing the selection threshold with 0.4 yielded highly similar
results (data not shown). We also explored the use of deviance

other methods (Supplementary Tables S1 and S2).

4 ANALYSIS OF WTCCC DATA

The WTCCC study examined approximately 2000 subjects for
each of seven common diseases and a shared set of approximately
3000 controls. Each subject was genotyped on the Affymetrix
GeneChip 500K Mapping Array Set. We provide in this section
a detailed analysis of the data on Type II diabetes [T2D (MIM
125853, http://www.ncbi.nlm.nih.g0V/0mim)] and Type I diabetes
[T1D (MIM 222100)]; the analysis for the other ﬁve diseases is
presented in Supplementary Tables S3—S7.

We excluded a small number of subjects according to the sample
exclusion lists provided by the WTCCC. In addition, we excluded
a SNP if (i) it is on the SNP exclusion list provided by the
WTCCC; (ii) it has a poor cluster plot as deﬁned by the WTCCC;
(iii) its MAF <0.01 in both cases and controls; or (iV) it has
extreme departure from Hardy—Weinberg equilibrium (P<10‘4).
Approximately 390 000 SNPs were used in the analysis, and there
were 2938 controls, 1924 T2D cases and 1963 T1D cases.

Figure 2 indicates the SNPs selected by the ATT, Wu et al.,
HLASSO and GWASelect for T2D; the details are shown in Table 5
and Supplementary Table S9. Under the ATT method, 15 SNPs reach
the genome-wide signiﬁcance of P < 10‘7. The most signiﬁcant
one is rs4506565 (P-Value = 7.5 X 10‘”), which is located in gene
T CF 7L2. The other 14 SNPs are clustered within either T CF 7L2 or
F T 0. These results are consistent with the WTCCC’s ﬁndings. The
HLASSO model is essentially identical to the ATT model, albeit
with a smaller model size.

For the Wu et al. and GWASelect methods, we set the model
sizes to 20. Both methods successfully detected T CF 7L2 and F T 0.
They also identiﬁed a locus that spans T SPANSEGRS, which was
one of the most signiﬁcant loci reported in a recent meta-analysis
of 10 128 subjects (Zeggini et al., 2008). This ﬁnding demonstrates
empirically that regression-based variable selection methods can be
more powerful than the ATT method.

 

112 /810's112umofp101xo'sot112u1101utotq/ﬁd11q 111011 pepcolumoq

9IOZ ‘ISlsnﬁnV uo ::

Q.He and D.-KLin

 

 

 

 

 

 

chr1 chr2 .
A | ’ | | | M | IA

60 70 50 200

chr position
chr4 chr5 chr7

I_LI IJ_I

1 70 1 80 1 20 1 3O 1 5 30

chr6
I 1 I I A | | ’ I

1 5 25 1 00 1 1 0 1 60 1 70

chr1 0 m
’ chr1 2 n

40 56 """" "T111 120 65 75

chr1 5 chr1 6’ 0r
I | I |
| 1 A l
70 80 5 1 5 50 60
.d-GWASelect
chr1 8 chr21 - HLASSO
5 1 5 35 45 A Wu et al
0 ATT

 

 

 

 

 

 

Fig. 2. The T2D models selected by four different methods.

It is interesting to compare the GWASelect and Wu et 611.
models. Five SNPs, rs11688935, rs6846031, rs6872465, rs2389591
and rs10435018, show up only in the GWASelect model. Among
these SNPs, rs6846031 was selected partly due to its conditional
correlation with T2D, underscoring the importance of conditional
screening in variable selection. This ﬁnding also indicates that
genetic factors underlying T2D are not simply in parallel with each
other, but rather form a complex structure that needs to be carefully
dissected.

Several SNPs in our GWASelect model have not been reported in
the literature on T2D. Some of them are plausibly related to T2D.
For example, GULPl is an adaptor protein that binds and directs the
trafﬁcking of LRP1 (Su et al., 2002), a protein that has been shown
to play a critical role in adipocyte energy homeostasis and insulin
sensitivity (Hofmann et al., 2007). Thus, genetic variants in GULPI
may potentially inﬂuence the amount of LRP1 in adipocyte cells
and thereby modulate a person’s risk to T2D. As another example,
the CREB5 was recently found to be downregulated along with
other members of the insulin signaling cascade when stimulated
by a ligand of PPARy, which is known to be associated with T2D
(Herrmann et al., 2009). This suggests that CREB5 is closely related
to PPARy and the insulin pathway. The other SNPs do not have
known connections with T2D, but further investigation of those loci
may reveal novel mechanisms or pathways related to T2D.

For prediction of T2D, the 6-err0r rates (with 6 = 0.1) of all four
models are over 40%, suggesting that T2D is greatly inﬂuenced by
other types of genetic variations and environmental factors. Since
it is not very meaningful to compare prediction errors at such a
high level, we turned our attention to the T1D data because it is
well-known that T1D is genetically more homogeneous than T2D.

For the T1D data, we used cross-validation to choose the tuning
parameter for the d-GWASelect method and set the selection
threshold 5 to 0.20. For the Wu et al. method, we set the model size
to 15. The results are shown in Figure 3, Table 6 and Supplementary
Table S8. The d-GWASelect model contains 14 SNPs, among which

Table 5. List of SNPs selected by the GWASeIect for T2D in the WTCCC
study

 

 

SNPa Chromosome Geneb

rs11688935 2 GULPI

rs903228 2 ASB3/LOC129656
rs6846031 4 VEGFCﬂVEIL3
rs6872465 5 PRDM6
rs10806665 6 THBS2/SMOC2
rs9465 871 6 CDKALI

rs23 89591 7 TMEM195/LOC729920
rs10435018 7 CREBS
rs7917983 10 TCF7L2
rs7901695 10 TCF7L2

rs45 06565 10 TCF7L2
rs4132670 10 TCF7L2
rs7077039 10 TCF7L2
rs9326506 10 ZNF 239
rs1495377 12 TSPAN8/LGR5
rs79615 81 12 TSPAN8/LGR5
rs2930291 15 CCDC33
rs8050136 16 FTO

rs2099106 16 C16orf72/GRIN2A
rs6517434 21 KCNJ6

 

ars number identiﬁed from dbSNP (http://www.ncbi.nhn.nih.gov/projects/SNP/).
bGene symbol from Entrez Gene (http://www.ncbi.nlm.nih.gov/gene/).

chr1 ! chr2
I A I 1 I I I I I
60

' 120 200 210
chr position

 

 

 

chr4 . chr5
| t | | | A
1 20 1 70 30 40
chr6 K . chr1 0
I I I A _I
32 ' 34 30 4o

chr12l T I ” . §

| |
60 110.2 '111.0

 

 

 

 

50
chr1 6
“"14 Oct-GWASeIect
I_A_I
4o 50 1 0 20 l HLASSO
A Wu et al
chr1 7 chr1 8 o ATT
30 40 1 0 20

 

 

 

Fig. 3. The T1D models selected by four different methods.

ADAM29, SYNGAPI, CUX2 and ALDHZ do not appear in any
of the other three models. The gene SYNGAPI was observed to
have strong conditional correlation with T1D, demonstrating again
that selection solely based on marginal correlation is insufﬁcient.
Searching the TlDBase (http://www.t1dbase.0rg) revealed that all
four genes have expressions in pancreas, although none has been
previously considered as strong candidates for T1D. Interestingly,
the CUXZ has been shown to directly regulate the expression of

 

112 /810's112umofp101xo'sot112u1101utotq/ﬁd11q 111011 pepcolumoq

9IOZ ‘ISlsnﬁnV uo ::

GWAS variable selection

 

Table 6. List of SNPs selected by the d-GWASelect method for T1D in the
WTCCC study

 

 

SNPa Chromosome Geneb
rs6679677 1 RSBNI/PTPNZZ
rs41515647 1 ST6GALNAC5
rs17388568 4 ADADI
rs330483 4 ADAM29
rs9273363 6 HLA-DQBI
rs9272346 6 HLA-DQAI
rs411136 6 SYNGAPI
rs1265566 12 CUX2
rs7398833 12 CUX2
rs10744777 12 ALDH2
rs17696736 12 C1207f30
rs11171739 12 ERBB3
rs12708716 16 CLEC16A
rs12924729 16 CLEC16A

 

ars number identiﬁed from dbSNP.
bGene symbol from Entrez Gene.

Table 7. Prediction errors of four variable selection methods for the WTCCC
T1D data

 

 

 

Model Effective size 6-error rate Log-
likelihood
0.1 0.15 0.25

ATT 5 0.110 0.139 0.181 —2116.9

Wu et al. 14 0.119 0.139 0.179 —2075.1
21 0.135 0.157 0.196 —2059.8

HLASSO 4 0.116 0.141 0.176 —2113.6
21 0.126 0.151 0.191 —2073.5

d-GWASelect 21 0.107 0.131 0.178 —2058.6

 

NeuroD (Lulianella et al., 2008), a gene that can cause T1D if
mutated.

Finally, we compared the prediction accuracy of the four methods.
We randomly divided the data into three parts, two as the training
data and one as the testing data. Since the training dataset contains
only 2/ 3 of the original data, we reduced 5 from 0.20 to 0.10 to ensure
that a similar number of loci are included in the d-GWASelect model.
Since the true liability scores and disease probabilities are unknown
in real data, we measured the prediction errors by the 6-err0r rates
for 6 = 0.1, 0.15 and 0.25 (see Section 2 for detail). Considering that
pruning was done before each model was used for prediction, we
report the actual (i.e. effective) number of SNPs used by each model
for prediction. Under default settings, the effective model sizes of
the Wu et al., the HLASSO and the d-GWASelect are 14, 4 and
21, respectively. Since the former two models are much smaller,
we also evaluated their prediction accuracy with 21 effective SNPs.
(We were not able to evaluate the ATT with 21 effective SNPs due to
numerical instabilities.) The results are reported in Table 7. Clearly,
the d-GWASelect performs the best or nearly the best for all three
6-err0r rates. We have also calculated the area under the ROC curve

for the four methods, and GWASelect achieves the highest value
(Supplementary Table S11).

5 DISCUSSION

We have developed a new tool, GWASelect, for variable selection at
the genome-wide level. This regression-based method has the ability
to capture both marginally correlated and marginally uncorrelated
causal SNPs and has low FDR. The advantages over the existing
methods have been demonstrated through simulated and real data.
Our method has two versions. The ﬁrst version requires the
speciﬁcation of the model size d, for which we suggest to choose
a number that is consistent with the current biological knowledge
of the studied disease. The second version (d-GWASelect) does not
require the speciﬁcation of the model size, and this is the version
we recommend for general use.

The correlation structures for causal variants used in our
simulation studies have biological relevance. Scheme 2 mimics
a scenario in which the causal variants form a gene cluster that
contributes synergistically to the disease outcome, while scheme
3 reﬂects a scenario in which several biological pathways (or
networks) affect the disease development.

We did not include least angle regression (LARS) in our studies
because it has been shown to have highly similar performance to
LASSO (Hastie et al., 2009). Indeed, LASSO can be implemented
by LARS with a small modiﬁcation. Wu and Lange (2008)
demonstrated that CCD is ‘considerably faster and more robust than
LARS’ and is ‘more successful than LARS in model selection’.

The HLASSO adopts a concave penalty function, but the CCD
algorithm may not converge for non-convex penalty functions
(Friedman et al., 2010; Wu et al., 2009). A valid algorithm to
implement concave penalty functions is local linear approximation
(Zou and Li, 2008), which amounts to multiple rounds of CCD and
would make the HLASSO computation prohibitively expensive. For
the WTCCC T1D data, running the CCD version of the HLASSO
with 10 iterations on an Intel Quadcore Nehalem processor (2.4 GHz,
16 GB memory) requires 67.5 to 175 h, depending on the value of the
tuning parameter. In contrast, we have been running the GWASelect
in a parallel computing environment, and the same analysis can be
completed within several hours on 16 processors.

In an independent effort, Fan et al. (2009) developed an ISIS
method for generalized linear models in the context of microarray
data analysis. In their method, the conditional screening procedure
requires ﬁtting a separate regression model for each feature, which
would create heavy computational burden for GWAS data. In
addition, their method tends to have high FDR. They observed that
cross-validation tends to yield large models for logistic regression,
resonating our ﬁndings.

We can extend our methods to select interactions. Instead of
considering all possible interaction terms, we may incorporate
known biological network information (Franke et al., 2006) into our
selection procedure. Another approach is to ﬁrst extend the existing
genetic network identiﬁcation tools, such as the liquid association
(Li, 2002) and bounded mode stochastic search (Dobra, 2007), to
infer SNP interactions and then incorporate such information into
our GWASelect procedure. Recently, Han et al. (2010) proposed a
Markov blanket-based method to evaluate epistatic interactions for
GWAS data. It will be interesting to compare to that method when
we extend our work to interaction effects.

 

112 /810's112umofp101xo'sot112u1101utotq/ﬁd11q 111011 pepcolumoq

9IOZ ‘ISlsnﬁnV uo ::

Q.He and D.-KLin

 

How to obtain P-Values for high-dimensional variable selection
is an active research area. The stochastic error introduced by the
selection process makes it very difﬁcult to assign P-Values to the
selected features. Meinshausen et al. (2009) offered one possible
solution by ‘aggregating’ P-Values from stability selection, but our
experiments indicated that this procedure is too conservative for
SNP data, likely due to the ultra-high dimension and strong LD.

The prediction of genetic risk using GWAS data has drawn
considerable attention in recent years. Wray et al. (2007) pioneered
this area of research. Their approach selected genetic predictors
by a univariate screening method. As shown in this article, our
GWASelect method tends to provide more accurate prediction than
univariate screening when the SNPs are in strong LD. Wei et al.
(2009) explored genetic risk prediction through a Support Vector
Machine algorithm. It is difﬁcult to compare our results directly with
theirs because (i) their analysis involved two other datasets besides
the WTCCC T1D data; (ii) our testing samples are far smaller than
theirs; and (iii) interaction effects are not considered in our current
work.

Funding: National Cancer Institute grant (1-P01-CA142538—01).

Conﬂict of Interest: none declared.

REFERENCES

Altshuler,D. et al. (2008) Genetic mapping in human disease. Science, 322, 881—888.
Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a practical
and powerful approach to multiple testing. J. R. Stat. Soc. Ser. B, 57, 289—300.
Dobra,A. (2007) Va1iable selection and dependency networks for genomewide data.

Biostatistics, 8, 1—18.

Fan,J. and Li,R. (2001) VaIiable selection Via nonconcave penalized likelihood and its
oracle properties. J. Am. Stat. Ass., 96, 1348—1360.

Fan,J and LV,J. (2008) Sure independence screening for ultrahigh dimensional feature
space. J. R. Stat. Soc. Ser. B, 70, 849—911.

Fan,J. et al. (2009) Ultrahigh dimensional feature selection: beyond the linear model.
J. Mach. Learn. Res., 10, 2013—2038.

Frank,I.E. and F1iedman,J.H. (1993) A statistical View of some chemometrics regression
tools. Technometrics, 35, 109—135.

Franke,L. et al. (2006) Reconstruction of a functional human gene network, with an
application for prioritizing positional candidate genes. Am. J. Hum. Genet, 78,
1011—1025.

F1iedman,J. et al. (2010) Regularization paths for generalized linear models Via
coordinate descent. J. Stat. S0ftw., 33, 1—22.

Genkin,A. et al. (2007) Large-scale Bayesian logistic regression for text categorization.
Technometrics, 49, 291—304.

Han,B. et al. (2010) A Markov blanket-based method for detecting causal SNPs in
GWAS. BMC Bioinform, 11 (Suppl. 3), SS.

Hastie,T. et al. (2009) The Elements of Statistical Learning: Data Mining, Inference,
and Prediction. 2nd edn. Springer, New York, pp. 75—76.

Henmann,J. et al. (2009) Isomer—speciﬁc effects of CLA on gene expression in
human adipose tissue depending on PPARy P12A polymorphism: a double blind,
randomized, controlled cross-over study. Lipids Health Dis., 8, 35.

Hoggart,C.J. et al. (2008) Simultaneous analysis of all SNPs in genome-wide and re-
sequencing association studies. PLoS Genet, 4, e1000130.

Hofmann,S.M. et al. (2007) Adipocyte LDL receptor-related proteinl expression
modulates postprandial lipid transport and glucose homeostasis in mice. J. Clin.
Invest, 117, 3271—3282.

Hudson,R.R. (2002) Generating samples under a Wright-Fisher neutral model.
Bioinformatics, 18, 337—378.

Li,C. and Li,M. (2008) GWAsimulator: a rapid whole-genome simulation program.
Bioinformatics, 24, 140—142.

Li,K.-C. (2002) Genome-wide coexpression dynamics: theory and application. Proc.
Natl Acad. Sci. USA, 99, 16875—16880.

Lulianella,A. et al. (2008) Cux2 (Cutl2) integrates neural progenitor development with
cell-cycle progression duIing spinal cord neurogenesis. Development, 135, 729—741.

Meinshausen,N. et al. (2009) P-Values for high-dimensional regression. J. Am. Stat.
Assoc., 104, 1671—1681.

Meinshausen,N. and Biihlmann,P. (2010) Stability selection. J. R. Stat. Soc. Ser B, 72,
417—448.

Su,H.P. et al. (2002) Interaction of CED-6/GULP, an adapter protein involved in
engulfment of apoptotic cells with CED-1 and CD91/low density lipoprotein
receptor-related protein (LRP). J. Biol. Chem., 281, 12081—12092.

Tibshirani,R. (1996) Regression shrinkage and selection Via the lasso. J. R. Stat. Soc.
Ser. B, 58, 267—288.

Wei,R. et al. (2009) From disease association to risk assessment: an optimistic View
from genome-wide association studies on type 1 diabetes. PLos Genet, 5, e1000678.

Wellcome Trust Case Control Consortium (2007) Genome-wide association study of
14 000 cases of seven common diseases and 3000 shared controls. Nature, 447,
661—678.

Wray,N.R. et al. (2007) Prediction of individual risk to disease from genome-wide
association studies. Genome Res., 17, 1520—1528.

Wu,T.T. and Lange,K. (2008) Coordinate descent algorithms for lasso penalized
regression. Ann. Appl. Stat, 2, 224—244.

Wu,T.T. et al. (2009) Genome-wide association analysis by lasso penalized logistic
regression. Bioinformatics, 25, 714—721.

Zeggini,E. et al. (2008) Meta-analysis of genome-wide association data and large-scale
replication identiﬁes additional susceptibility loci for type 2 diabetes. Nature Genet,
40, 638—645.

Zou,H. and Hastie,R. (2005) Regularization and vaIiable selection Via the elastic net.
J. R. Stat. Soc. Ser. B, 67, 301—320.

Zou,H. (2006) The adaptive Lasso and its oracle properties. J. Am. Stat. Assoc., 101,
1418—1429.

Zou,H. and Li,R. (2008) One-step sparse estimates in nonconcave penalized likelihood
models. Ann. Stat, 36, 1509—1533.

 

112 /810's112umofp101xo'soi112u1101uioiq/ﬁd11q 111011 pepeolumoq

9IOZ ‘ISlsnﬁnV uo ::

