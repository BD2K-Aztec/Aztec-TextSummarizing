APPLICATIONS NOTE V°" 33.5%.ligiiéi‘aiﬁéi’iilﬁﬁlggg

 

Sequence analysis

Advance Access publication February 14, 2014

SBARS: fast creation of dotplots for DNA sequences on different

scales using GA-,GC-content
Maxim l. Pyatkov" and Anton N. Pankratov

Institute of Mathematical Problems of Biology, Russian Academy of Sciences, Pushchino, Moscow region 142290,

Russia
Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: Structural analysis of long DNA fragments, including
chromosomes and whole genomes, is one of the main challenges in
modern bioinformatics. Here, we propose an original approach based
on spectral methods and its implementation called SBARS (Spectral-
Eased Approach for Repeats Search. The main idea of our approach
is that repeated DNA structures are recognized not within the nucleo-
tide sequence directly but within the function derived from this se-
quence. This allows us to investigate nucleotide sequences on
different scales and decrease time complexity for dotplot creation
down to @(n).

Availability and implementation: Pre-compiled versions for Windows
and Linux and documentation are available at http://mpyatkov.github.
com/sbarsl.

Contact: mpyatkov@gmail.com

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 8, 2013; revised on January 26, 2014;
accepted on February 8, 2014

1 INTRODUCTION

The vast majority of approaches used to analyze nucleotide and
amino acid sequences are based on algorithms working with text
strings. Until recently, such methods were justiﬁed because the
length of processed genetic text was relatively short. The evolu-
tion of sequencing techniques, however, has resulted in dramat-
ically increased datasets, providing nucleotide sequences that are
comparable with whole genome in size. Algorithmic ‘correction’
of point mutations is computationally intensive and time-
consuming. At the same time it is reasonable to assume that a
number of mutations are unintentionally incorporated into com-
parisons of large fragments of DNA (>10 000 bp), resulting in
signiﬁcant decrease in efﬁciency of the text-based algorithms.

To bypass the problems of the text-based algorithms, a
number of effective spectral algorithms based on Fourier trans-
form were developed, which are used to search for minisatellites
[Spectral Repeat Finder (SRF) (Sharma et al., 2004) and
OWMSA (Du et al., 2007)], multiple alignments [MAFFT
(Katoh et al., 2002)], etc. Despite a high performance, these
tools are focused on ﬁnding short repeats and have a number
of limitations for the analysis of long sequences and searching for
extended homologous fragments.

 

*To whom correspondence should be addressed.

In the present article, we propose an original method for ﬁnd-
ing different types of long repeats in genome-scale DNA se-
quences. We also offer a possible solution for the problem of
dotplot creation whose time complexity can be reduced to @(n).

2 METHODS

Spectral-Eased Approach for gepeats Search (SBARS) is based on the
analysis of a function obtained from the nucleotide sequence. In our
method, we used GC—content curve as a higher-order representation of
the nucleotide sequence. The main parameters of GC-content are sliding
window WV 1) and its step (d1). The resulting GC-content curve is divided
into overlapping frames with width WV 2), wherein each frame is displaced
relative to the other by a step d2. After that we perform pairwise com-
parison of frames by integral estimation of distance between them:

1 W2 2
:_ ._ . 1
p W$W2;(ﬂ g1), ()

where fi,g,- are two fragments of GC—content. Note that 0 5 p 5 1, as
f,- 5 W1 and the number of terms in the sum is equal to W2. Therefore,
the distance does not depend on the sizes of the windows. For recognition
of repeats, the following decision rule is used: if p< 8 where 8 is a thresh-
old, then the fragments are considered to be similar; if p Z 8, the frag-
ments are not similar (Fig. 1a).

In addition to the GC—content, we used the GA-content curve with the
same parameters W1 and d1, which allow us to unambiguously recover a
DNA sequence from this curves (Supplementary Material). Simultaneous
recognition by two curves provides more stable results and allows us to
deﬁne the various types of repetitions with minimal computational cost.
For example, consider a fragment of GA-content with length W2,
which in the function values by deﬁnition is limited by window W1
size. ‘Figure lb’ shows three types of transformation under GA-content,
and each of them is related to the corresponding transformation under
DNA sequence if this sequence is decoded from GC—,GA-content curves.
For reversed DNA sequence, we made reverse GA-content curve. To
obtain the fragment of the DNA sequence corresponding to complemen-
tary sequence, the GA-content should be transformed to CT-content
using the following expression: CT-content 2 W1 — GA-content. For
reverse complement transform, one needs to make both transforms,
which are described earlier, in an arbitrary order.

The main feature of the method is that all of the fragments of GC-,
GA-content are approximated using orthogonal polynomials (Legendre,
Chebyshev, Fourier) and are presented in the form of the expansion co-
efﬁcients. Thus, all the transformations and estimations of expression (1)
are performed using the vectors of expansion coefﬁcients, and this allows
us to identify similarity between the GC-,GA-content fragments by com-
paring the ﬁrst few coefﬁcients (usually ~10) (Pankratov et al., 2012).

The other feature of the method is scalability. The dotplot size depends
not only on the size of nucleotide sequence but also on the parameters. In

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1765

112 [glO'SIBILInO[plOJXO'SODBIILIOJHIOIQ/[ldllq moi; popcorn/hog

910K ‘09 lsnﬁnV no :2

M.l.Pyatkov and A.N.Pankratov

 

............. . .
{a} inn—55:51]; ﬁﬁl’ATTMTGAETET GGCTA'I'FA AT GT'GG nun-rum TGEETAWMTG. . .

wt

DNA sequence is ten-rerted tn «GE-cunth {um-Hun

       

Mpmimatien
win-dew step

Approximation ._

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

     
 

slidﬂg windaw III] in M] '- L'ﬂ M will:- Jliril m It
—I- W: h
melmasresult -— ..... “N I, ..... ...‘:-.,,__ I _ H A I d . , , _ . , , d . t a . . _ . . . , _ __,_I r .......... .,_.-
of fragments :f' 15:“ "ti.-
temwrisen
fl f2 f"
D
LI'
3
E 3i p 2'» e  a... . ..
i;
u-
E
LII
E g; . . . p :3: E:
E
I:
i‘-E
lb} ;
GA 5 en.
I reverse
W1 I
_, W2 __ 
GA GA reverse
complement complement

Fig. 1. (21) Frame comparisons scheme. (b) Basic operations on GA-
content related to the appropriate nucleotide sequence transforms

common case, the complexity of our algorithm can be represented as
three components. The ﬁrst component is making GC-,GA—content
whose time complexity is linear. The second component is evaluating
vectors of expansion coefﬁcients whose complexity is also linear because
of the number of frames to be converted into vectors is 0,12. The last
component is pairwise comparison of vectors and constructing dotplot.
The complexity of the last component is @(fzy). If the size of a sequence is
increasing but parameters are ﬁxed, the coniplexity of this component is
quadratic, and consequently whole complexity will also be quadratic. But
if we increase the parameters proportionally to the length of the sequence,
then the last component will be constant and complexity of whole algo-
rithm will be @(n). In the last case, the dotplot size does not depend on
the sequence length. This facilitates construction of low resolution matrix
even for large nucleotide sequences.

3 IMPLEMENTATION

SBARS is a complete implementation of the algorithm given
earlier with graphical user interface. The main objective of the
program is to construct a dotplot and obtain the coordinates of
repeated fragments in the sequences. The program is an advanced

Table 1. Benchmark results for SBARS and Gepard

 

 

Sequence length Gepard SBARS
70 000 <1 s <1 s
5 000 000 45 s 1.6 s
Human chromosome Y 4 min 45 s 27 s

Mouse chromosome 6 versus Rat chromosome 4 45 min 45 s

 

Note: Selfplots of sequences with different lengths have been calculated on a
2.2GHz AMD Phenom 9550 Quad-Core machine using Gepard and SBARS.
The resulting dotplots and the corresponding parameters are presented in the
Supplementary Material.

real-time viewer for DNA sequences at different scales.
The program is written in C with OpenMP directives, and graph-
ical user interface is based on the QT library. A detailed guide
with examples is located at http://github.com/mpyatkov/sbars/
raw/master/SBARS.pdf

We compared our program with Gepard (Krumsiek et al.,
2007), which is the closest equivalent to our program by perform-
ance. The time complexity of Gepard is @(n log n). The output of
the programs is ﬁxed size dotplot for sequences in different
scales. For similar quality dotplots (Supplementary Material),
especially for long sequences, our method demonstrates less com-
putation time (Table 1).

4 DISCUSSION

SBARS is a fast and efﬁcient tool for identifying dispersed
(direct, inverted) and tandem DNA repeats. The program is
not aimed at the comparison of individual nucleotides. The
main idea of this approach is to quickly identify the similarity
of individual fragments within the query sequences, disregarding
single nucleotide insertions or deletions. The current version of
the program efﬁciently identiﬁes repeated sequences and can be
developed for the analysis of long insertions or deletions because
of chromosome rearrangements in similar sequences. The under-
lying spectral algorithm demonstrated good scalability on multi-
core processors (Pankratov et al., 2010).

Funding: Russian Foundation for Basic Research, (grants 14—07-
31306, 14—07-00924) and by Intel Company, T-Platforms
Company.

Conflict of Interest: none declared.

REFERENCES

Du,L. et al. (2007) OMWSA: detection of DNA repeats using moving window
spectral analysis. Bioinformatics, 23, 631—633.

Katoh,K. et al. (2002) MAFFT: a novel method for rapid multiple sequence align-
ment based on fast Fourier transform. Nucleic Acids Res., 30, 3059—3066.

Krumsiek,J. et al. (2007) Gepard: a rapid and sensitive tool for creating dotplots on
genome scale. Bioinformatics, 23, 1026—1028.

Pankratov,A. et al. (2012) Search for extended repeats in genomes based on the
spectral-analytical method. Math. Biol. Bioinform, 7, 476—492.

Pankratov,A.N. et al. (2010) Fast Spectral Estimation of Genetic Homology. http://
software.intel.com/en-us/articles/fast-spectral-estimation-of-genetic-homology
(7 November 2013, date last accessed).

Sharma,D. et al. (2004) Spectral repeat ﬁnder (SRF): identiﬁcation of repetitive
sequences using Fourier transformation. Bioinformatics, 20, 1405—1412.

 

1 766

112 ﬁlm‘spaumo[pJOJXO'sot1emJOJutotw/2d11q wort pepeorumoq

910K ‘09 lsnﬁnV uo ::

