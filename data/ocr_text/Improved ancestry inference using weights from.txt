ORIGINAL PAPER

Vol. 29 no. 11 2013, pages 1399-1406
doi:10. 1093/bioinformatics/btt144

 

Genetics and population analysis

Advance Access publication March 28, 2013

Improved ancestry inference using weights from external

reference panels

Chia-Yen Chen”, Samuela Pollack1’2’3, David J. Hunter1’3’4, Joel N. Hirschhorn3’5’6,

Peter l<raft1’2’3’4 and Alkes L. Price1’2’3’*

1Department of Epidemiology, 2Department of Biostatistics, Harvard School of Public Health, Boston, MA 02115,
8Broad Institute of Harvard and MIT, Cambridge, MA 02142, 4Channing Division of Network Medicine, Department of
Medicine, Brigham and Women’s Hospital, 5Divisions of Genetics and Endocrinology, Children’s Hospital and
6Department of Genetics, Harvard Medical School, Boston, MA 02115, USA

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Inference of ancestry using genetic data is motivated by
applications in genetic association studies, population genetics and
personal genomics. Here, we provide methods and software for im-
proved ancestry inference using genome-wide single nucleotide poly-
morphism (SNP) weights from external reference panels. This
approach makes it possible to leverage the rich ancestry information
that is available from large external reference panels, without the ad-
ministrative and computational complexities of re-analyzing the raw
genotype data from the reference panel in subsequent studies.
Results: We extensively validate our approach in multiple African
American, Latino American and European American datasets,
making use of genome-wide SNP weights derived from large refer-
ence panels, including HapMap 3 populations and 6546 European
Americans from the Framingham Heart Study. We show empirically
that our approach provides much greater accuracy than either the
prevailing ancestry-informative marker (AIM) approach or the analysis
of genome-wide target genotypes without a reference panel. For
example, in an independent set of 1636 European American
genome-wide association study samples, we attained prediction ac-
curacy (FI2) of 1.000 and 0.994 for the first two principal components
using our method, compared with 0.418 and 0.407 using 150
published AlMs or 0.955 and 0.003 by applying principal component
analysis directly to the target samples. We finally show that the higher
accuracy in inferring ancestry using our method leads to more effect-
ive correction for population stratification in association studies.
Availability: The SNPweights software is available online at http://
www.hsph.harvard.edu/faculty/alkes-price/software/.

Contact: aprice@hsph.harvard.edu or cychen@mail.harvard.edu.
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 8, 2012; revised on March 15, 2013; accepted
on March 25, 2013

1 INTRODUCTION

Applications in genetic association studies, population genetics
and personal genomics motivate inference of genetic ancestry
using single nucleotide polymorphism (SNP) genotypes.

 

*To whom correspondence should be addressed.

In genetic association studies, ancestry inference can be applied
to control population stratification, which can lead to spurious
association between the genetic variant and the phenotype under
study (Price et al., 2010). In personal genomics, many private
companies provide genetic testing on ancestry, which involves
inference of ancestry based on information of genetic data
from a single individual (Royal et al., 2010).

In genome-wide association studies (GWAS), several methods
have been proposed to adjust for population stratification (Price
et al., 2010). Methods that explicitly infer genetic ancestry in-
clude structured association (Pritchard et al., 2000), principal
component analysis (PCA) (Novembre and Stephens, 2008;
Novembre et al., 2008; Price et al., 2006) and multidimensional
scaling (Purcell et al., 2007). To infer genetic ancestry, these
methods can be either applied to the target samples only or
applied to the target samples combined with an external refer-
ence panel to improve accuracy; when inferring ancestry for a
single target individual in a personal genomics setting, it is ne-
cessary to include an external reference panel. As an alternative
to applying these methods to genome-wide data, they can be
applied to a subset of ancestry-informative markers (AIMS).
For example, AIM panels have been developed for European
Americans (Paschou et al., 2008; Price et al., 2008; Seldin and
Price, 2008; Tian et al., 2008) and Latino Americans (Galanter
et al., 2012).

The use of raw genotypes from a large reference panel to im-
prove accuracy poses several complexities, including the logistics
of obtaining and managing additional raw genotype data, con-
cerns about sharing raw genotype data owing to privacy or other
reasons and increased computational cost. Although the AIM
approach can ameliorate some of these complexities, restricting
to AIMs when genome-wide data are available reduces accuracy
(Price et al., 2010). Given that data on genome-wide markers
now can be generated through low-coverage sequencing at very
low cost, an approach that can fully use the ancestry information
of genome-wide markers is needed (Pasaniuc et al., 2012).

Here, we propose methods and software for ancestry inference
based on genome-wide SNP weights. This approach requires just
the raw genotypes from the target samples and a set of genome-
wide SNP weights pre-computed using external reference panels.
Notably, the reference panels of genotypes do not need to be
shared. Inferring ancestry using the genome-wide SNP weights

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1399

112 /810's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepBOIU/IAOG

9IOZ ‘091sn8nv uo ::

C.-Y.Chen et al.

 

does not depend on the sample size or diversity of the study
samples, and can infer ancestry for related samples, for which
direct PCA is often confounded by family structure (Price et al.,
2010).

To demonstrate our method, we ﬁrst built an ancestry infer-
ence model for African Americans using genome-wide SNPs and
validated our model using independent HapMap 3 samples
(Altshuler et al., 2010). This model predicts the ﬁrst principal
component (PC1) for African Americans and can also transform
predicted PC1 into % European ancestry. We determined that
predicted ancestry using genome-wide SNP weights is more
accurate than predicted ancestry using a limited number of
AIMs. We extended the model to infer % ancestry from East
Asian, European and West African populations using PC1 and
PC2 from these populations. Once again, predicted ancestry
using genome-wide SNP weights was extremely accurate.
Finally, we built an ancestry inference model for European
Americans using Northwest European (NW), Southeast
European (SE) and Ashkenazi Jewish (AJ) ancestral populations
(Price et al., 2008). We used European American reference sam-
ples from the Framingham Heart Study (FHS) SHARe data to
build the model and validated the model with independent sam-
ples from a bipolar disorder (BD) GWAS and a breast cancer
(BCa) GWAS (Hunter et al., 2007; Lango Allen et al., 2010;
Price et al., 2008; Splansky et al., 2007). For both BD and
BCa datasets, the predicted PC1 and PC2 attained higher accur-
acy than direct application of PCA. In addition, simulations
showed that our method outperforms the AIM approach in cor-
recting population stratiﬁcation in GWAS. Ancestry inference
software incorporating SNP weights for all of the populations
considered here can be downloaded from http://www.hsph.har
vard.edu/faculty/alkes-price/software/.

2 METHODS

2.1 Ancestry inference using genome-wide SNP weights

Our ancestry inference model is based on a set of genome-wide SNP
weights. To compute the SNP weights, we ﬁrst normalize the genotypes
of ancestral samples and perform PCA on normalized genotypes. Then,
we compute SNP weights using PCs, corresponding eigenvalues and nor-
malized genotypes from ancestral samples. The SNP weights, once
obtained, can be applied to target samples to predict PCs and % ancestry.
Below, T denotes the transposition of a matrix, and tr(o) denotes the sum
of the diagonal elements of a matrix.

Let gij be a matrix of SNP genotypes for SNP i and individual j, where
i=1,...,M and j=1,...,N. The N individuals are samples from the
ancestral populations for a given admixed population. We ﬁrst normalize
gij by SNP to improve the result of PCA (Patterson 61 al., 2006). For each
entry in row i, we subtract the mean of each row from it and divide it by
[pi(1-pi)]0‘5, where the mean of each row is pt, 2 (Zj gij)/N and pi = ui/Z.
The normalized gij matrix is denoted as X. Then, we perform PCA using
EIGENSOFT software on the N X N matrix XTX. From PCA, we can
obtain an N X N matrix V with the kth column as the kth PC of XTX with
the kth largest eigenvalue, and an N X N diagonal matrix S with the kth
largest eigenvalue Ak at the kth diagonal element. The SNP weights are
computed as W: C X S_1(XV)T. C is a standardizing constant (N — 1)/
tr(XTX). The standardizing constant is to account for the standardization
imposed by EIGENSOFT software on the input genotypes (Patterson
61 al., 2006). The resulting SNP weights W form an N X M matrix with
the SNP weights for predicting the kth PC in the kth row.

Once the SNP weights are obtained, we can predict PCs for target
samples by applying the SNP weights to their genotypes. Let gijmw be
an MX P matrix for SNP i and individual j, where i=1,...,M and
j = 1,. . .,P. The P individuals are our target samples from an admixed
population with the ancestral populations corresponding to the SNP
weights. We ﬁrst normalize gijmew using the same method described
above to obtain the normalized genotype matrix Xnew. Note that we
use the row means pi calculated with the ancestral population samples
to normalize the target samples. We can predict the PCs of XnewTXnew by
computing Vnew = (WXnew)T, where Vnew is a P X N matrix with the kth
column as the kth predicted PCs for the P target samples.

2.2 Application to admixed samples using continental
ancestral populations

In general, we can use the predicted PC1 as a continuous axis of ancestry
for an admixed population with two ancestral populations, such as
African Americans. To build an ancestry inference model for African
Americans, we computed genome-wide SNP weights using a pooled
sample of 112 individuals with ancestry of Northern and Western
Europe (CEU) and 113 individuals with ancestry of Western Africa
(YRI) from HapMap 3 (Altshuler et al., 2010). For this model, we aim
at predicting PC1 (anew), which is the ﬁrst column of Vnew, for the target
admixed samples. To test the model with independent samples, we used
genotype data collected from 49 African American individuals in the
southwestern USA (ASW) from HapMap 3. The HapMap3 samples
were genotyped on Affymetrix 6.0 and Illumina 1M arrays. We excluded
SNPs on chromosome X, A/T and C/G SNPs (to avoid strand ambiguity
issues), and SNPs with any missing genotype in the pooled sample of
CEU, YRI and ASW samples. The genotype data used to calculate SNP
weights contain 813 976 SNPs.

To assess the prediction ability of the ancestry inference model, we
compared the predicted PC1 with the gold standard, which is PC1 ob-
tained by performing PCA on the combined sample of the target samples
(ASW) and the ancestral samples (CEU and YRI). We used two metrics:
(i) R2 between predicted and true PCs and (ii) shrinkage of predicted PCs
compared with true PCs, deﬁned as the regression coefﬁcient [3 from the
linear regression model Vkmew: ka,t,ue+8, where Vkmew is the kth pre-
dicted PC of the target samples and VIM,“e is the kth PC of the target
samples obtained by performing PCA on the combined sample of target
samples and ancestral samples. We also calculate the asymptotic shrink-
age for each PC with corresponding eigenvalues, number of SNPs and
number of ancestral samples used to compute SNP weights (Lee et al.,
2010).

We can further perform a linear transformation on the predicted PC1
to obtain the % European ancestry for the target samples. We ﬁrst per-
form PCA on a pooled sample of Europeans and West Africans and
calculate the average PC1 for the European samples (él) and the West
African samples ((3.2) separately. Then we transform the predicted PC1
into % European ancestry by calculating a1,new=(v1,new — é2)/(é1 — éz).
The resulting percent European ancestry is a proportion indicating the
inferred European ancestry component for the African American individ-
uals. For any value in anew that is greater than él or smaller than éz, the
corresponding percent European ancestry will be set to 1 or 0,
respectively.

The model we described above can be readily extended to infer ances-
try for admixed samples with three ancestral populations. In this case, we
aim at predicting both PC1 (vlmew) and PC2 (vzmew), which are the ﬁrst
and second columns of Vnew, respectively. We built the model with geno-
types from 112 CEU samples, 113 YRI samples, 84 samples of Han
Chinese in Beijing, China, and 85 samples of Chinese in Metropolitan
Denver, Colorado, from HapMap 3, which represent three continental
populations. We excluded SNPs on chromosome X, A/T and C/G SNPs,
and SNPs with any missing genotype in the pooled sample and used
661708 SNPs in this analysis. We examined this model by predicting

 

1400

112 /810's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepBOIU/IAOG

9IOZ ‘091sn8nv uo ::

Improved ancestry inference using weights

 

PC1 and PC2 for all HapMap 3 samples that were not used to build the
model, including 49 independent ASW samples, 50 independent samples
of Mexicans in Los Angeles, California (MXL), and 88 samples of
Gujarati Indians in Houston, Texas (GIH). The predicted PCS were
compared with the corresponding gold standards, which are the true
PC1 and PC2 obtained by performing PCA on the target samples plus
the ancestral samples.

To infer the ancestry components, we can perform a linear transform-
ation of the predicted PC1 and PC2 and obtain % ancestry of each
continental population. For target samples with three ancestral popula-
tions, we ﬁrst calculate the average of PC1 and PC2 for each of the three
ancestral populations separately and denote the average PCS as éij, where
i: 1, 2, denotes PCS, and j = 1, 2, 3, denotes three ancestral populations.
By assuming that an average sample from ancestral population 1 has
100% ancestry component from population 1, we can formulate a
system of equations for linear transformation between PC1 and PC2
and % ancestry of ancestral population 1 (Equation 1). A system of
equations for ancestral population 2 transformation can be formulated
similarly (Equation 2). We can solve both systems of equations:

1 = Oil 511+Bl é21+'v1
0 = Oil 512+Bl é22+71 (1)
0 = Oil 513+Bl é23+‘Ii1

and

0 = (12 511+Bz é21+'v2
1 = (12 512+Bz é22+72 (2)
0 = (12 513+B2 é23+'Ii2

for coefﬁcients 011, 012, ,81, ,82, yl and y2. With the condition that all %
ancestry for a given individual sum to 1, we can infer the ancestry com-
ponent with

31, new 2 a1 XVI, new +61 XVZ, new +71
a2, new 2 “2 X V1, new +62 X V2, new +72

a3, new: 1 _ 31, new _aZ,new

where almew, alum and a3,new are inferred % ancestry with respect to
ancestral population 1, 2 and 3. We set the inferred % ancestry to 0 or 1 if
the calculated values exceed the range of 0—1 and rescale the inferred
percentages of ancestry to make the sum of percentages equal to 1 if
needed.

Previously, we implicitly assume that the genotype data of target sam-
pleS gijmew contain the same set of SNPS as the SNP weights. In practice,
we may encounter the situation where the genotype data of target samples
contain fewer SNPS than the SNP weights. In this case, we can still
predict PCS with the genotypes available. Assuming that the SNP
genotypes are missing at random, we replace the missing genotype
data of target samples by 0 and calculate the predicted PCS as
Vnewz (WXnew)T X (M/M’), where M’ is the number of SNP genotypes
used to predict PCS.

To assess our methods performance under different conditions, we
predicted PCS by using different numbers of random SNPS selected
across the genome, different numbers of AIMS selected by the largest
absolute value of SNP weight and genome-wide SNPS as well as using
different numbers of ancestral samples. In addition, we obtained PCS
from PCA performed on only the target samples. R2 and sample Shrink-
age were used as accuracy measures.

2.3 Application to European Americans

Ancestry inference poses a greater challenge with more closely related
ancestral populations. Thus, we used genome-wide SNP genotypes
from FHS SHARe data to build an ancestry inference model for
European Americans using NW, SE and AJ ancestral populations. The
original SHARe project included 9215 individuals with 549 782 SNPS

genotyped with the Affymetrix 500K array and 49214 SNPS from the
Affymetrix 50K array. We selected a subset of 6546 unrelated European
American samples to build the model. We examined the model with two
sets of independent European American samples, a BD GWAS and a
BCa GWAS (Hunter 61 al., 2007; Price et al., 2008). We analyzed 1636
European American controls from the BD data genotyped on Affymetrix
500K arrays. We analyzed 343 070 SNPS after excluding SNPS on
chromosome X and A/T and C/G SNPS. We analyzed 2287 samples
from the BCa data genotyped on Illumina HumanHap5 50 chip, including
1145 BCa cases and 1142 matched controls, retaining 542 944 SNPS. For
BCa GWAS samples, we also extracted self-reported ancestry informa-
tion from questionnaires, which classiﬁed samples into Scandinavian,
South European, AShkenazi Jew or European without sub-population
ancestry information. We excluded BCa samples without sub-population
ancestry information in our analysis.

For BD samples, we ﬁrst compared predicted PC1 and PC2 using
genome-wide SNP weights with the gold standards, which are the PCS
obtained by performing PCA on the combined sample of the target sam-
ples (BD) and the ancestral samples (FHS). We also compared PC1 and
PC2 from direct PCA on BD samples with the gold standard. R2 and
shrinkage were used as accuracy measures. In addition, we compared the
PCA plots of the predicted PCS, PCS from direct PCA and the gold
standard for BD samples. The PCA plots are color coded according to
the assigned groups as described below. We also compared PCA plots for
BCa samples, which are color coded by self-reported ancestry.

To assign BD samples to distinct ancestry categories, we calculated the
distance between each BD samples and three centroids of the three
European sub-populations based on the predicted PC1 and PC2
(Fig. 2c). We then assigned BD samples to one of the three groups
based on the shortest distance to the centroids. We also assigned BD
samples to distinct ancestry categories based on the gold standard and
compared the category assignment using predicted PCS versus gold stand-
ard. For estimating % ancestry components, we assigned the FHS sam-
ples to NW, SE and AJ groups based on the distance to the same
centroids mentioned above and calculated average of PC1 and PC2 for
each of the three populations separately. We used these average PC1 and
PC2 from the three groups in FHS to perform a linear transformation
from predicted PC1 and PC2 to % ancestry.

In addition to genome-wide SNP weights, we also used a panel of 300
AIMS speciﬁc to European American population to predict the ﬁrst two
PCS for the BD samples and compared predicted PCS with gold standard
(Price et al., 2008). A subset of 150 AIMS, which are the intersection
between the AIM panel and our SNP genotype panel, was used in our
analysis. We also compared R2 and sample shrinkage of predicted PCS
obtained by using different numbers of random SNPS and AIMS for the
BD samples. We selected 100, 200, 500, 1000, 2000, 5000 and 10000
random SNPS and 10, 20, 50 and 100 AIMS based on SNP weights,
and predict the ﬁrst PC for the BD samples based on selected SNPS.

2.4 Population stratiﬁcation simulations

We conducted a Simulation study to compare the performance of our
predicted PCS versus PCS inferred directly from target samples in adjust-
ing for population stratiﬁcation in GWAS. The Simulation framework iS
Similar to that in our previous work (Price et al., 2006). We used BD
samples and Simulated a phenotype using SNP rS2322659 at the LCT
locus on chromosome 2. This SNP has an R2 of 0.638 with SNP
rS4988235, which iS perfectly associated with the lactase persistence
phenotype (Enattah et al., 2002). This phenotype iS known to be corre-
lated with within-Europe ancestry. We Simulated a binary phenotype for
the GWAS samples by assigning 1 to individuals carrying one or two
reference alleles and 0 to individuals carrying zero reference alleles of
rS2322659. We performed association tests on all available genome-
wide SNPS except SNPS on chromosome 2. We computed unadjusted

x2 statistics and P—valueS and selected SNPS with genome-wide

 

1401

112 /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepBOIU/IAOG

9IOZ ‘091sn3nv uo ::

C.-Y.Chen et al.

 

Signiﬁcance for adjusted analyses. We assume that these SNPS are asso-
ciated with Simulated phenotype owing to population stratiﬁcation. We
computed adjusted association statistics using genomic control (Devlin
and Roeder, 1999), predicted PCS based on genome-wide SNPS, PCS
obtained by direct PCA and predicted PCS based on AIMS and compared
the x2 statistics and P-valueS from these adjusted analyses.

3 RESULTS

3.1 Application to admixed samples using continental
ancestral populations

We ﬁrst applied the method to African Americans, as a proof of
concept. We computed genome-wide SNP weights using 112
CEU and 113 YRI samples and predicted the ﬁrst PC for 49
ASW samples. We compared predicted PC1 with the gold stand-
ard for ASW samples and found that predicted PC1 is accurate,
with an R2 of 1.000 [95% conﬁdence interval (CI): 1.0001000]
and a sample shrinkage of 0.978 (SD = 0.0001) (Supplementary
Table S1).

We compared the prediction accuracy by using random SNPS,
AIMS and genome-wide SNPS (Fig. l). The results showed that
the R2 increased with the number of SNPs included in the model
for both random SNPs and AIMS. Notably, AIMS are ~10-fold
more informative than random SNPS for ancestry inference. The
R2 of the genome-wide SNP model is much higher than that of
all models built with a subset of random SNPS or AIMS. This
result highlights the advantage of using genome-wide SNPs over
using AIMS in ancestry inference. We repeated the analysis by
building the model with half of the CEU and YRI samples and
testing the model with the other half of the CEU and YRI sam-
ples. The results showed a similar trend as the previous analysis
but with much higher R2 (Supplementary Fig. S2), as expected
because ancestry inference for a sample with discrete structure is
easier than ancestry inference for admixed samples. We showed
that the sample shrinkage did not change substantially with the
number of SNPS used for predicting PCs (Supplementary Table
S1). In addition, we also built models with different numbers of
ancestral samples (Supplementary Table S1) and found that R2
remained at 1.000, regardless of the number of ancestral samples
used. However, the shrinkage decreased from 0.978 when using
225 ancestral samples to 0.777 (SD=0.001) when using 20 an-
cestral samples. In addition to comparisons between predicted
PCs, we also evaluated PC1 from directly applying PCA on the
ASW samples, as compared with the gold standard. We observed
an R2 of 0.101 (95% CI: 0—0.201). The poor performance ofPCl
from direct PCA is due to family relatedness between some of the
ASW samples, which prevents PCA from accurately estimating
the population structure for these ASW samples (Supplementary
Fig. S3).

Finally, we considered a model with three continental popu-
lations as ancestral populations and tested the model by predict-
ing PC1 and PC2 for HapMap 3 samples. R2 and shrinkage were
used to examine the accuracy of the predicted ﬁrst and second
PCs. For ASW and MXL samples, the predicted PC1 and PC2
both had R2 of 1.000 (95% c1: 1.000—1.000). The sample shrink-
age was 0.992 and 0.968 for predicted PC1 and PC2 in ASW
samples, and 0.982 and 0.974 for predicted PC1 and PC2 in
MXL samples (Supplementary Table S2), respectively. We also

 

 

AIME
1.0 'l—l '
0.0 —
0.8 -
0.? —
0.0 —
0.5 —
N _
m 0.4
0.3 A
0.2 —
0.1 —
DD _ Random SNPS
CI CI CI D D D I: III
17 N in {:1 {:1 {:1 {:1 :g
r N L” E 3
III.)
E
Number of SNPS 5
C)

Fig. 1. Comparison between R2 for ancestry inference using AIMS,
random SNPS and genome-wide SNPS. Models were built with 112
CEU samples and 113 YRI samples and tested with 49 ASW samples.
R2 was calculated with the predicted ﬁrst PC and the gold standard,
which iS the ﬁrst PC obtained by applying PCA to combined samples
of CEU, YRI and ASW with 813 976 SNPS. The vertical bars represent
95% CIS

estimated % ancestry for ASW and MXL samples
(Supplementary Table S4 and Supplementary Fig. S1).

To investigate the results of applying our model to admixed
samples with no good match in the ancestral populations
included in the model, we predicted PC1 and PC2 for all
HapMap 3 samples and compared these predictions with the
top PCs obtained by directly applying PCA to all HapMap 3
samples. We obtain very similar results for predicted PCs and
PCs from direct PCA (Supplementary Fig. S4). In particular,
results are very similar for GIH samples, which have no good
match in the ancestral populations used (Supplementary Table
S2). Thus, predicted PCs and top PCs from direct PCA attain
similar results, even when the ancestral samples are not a good
match for the admixed samples.

3.2 Application to European Americans

Using genotypes from FHS SHARe data, we built a model that
predicts the PC1 and PC2 for European Americans. In most
European American datasets, PC1 distinguishes NW from SE
ancestry, and PC2 distinguishes SE from A] ancestry (Price
et al., 2008). To validate the model, we used samples from a
BD GWAS and a BCa GWAS as independent testing datasets
(Hunter et al., 2007; Price et al., 2008). We predicted PC1 and
PC2 for the BD samples using the model built with SHARe data
and compared predicted PCs with the gold standard created by
performing PCA on the BD samples and the SHARe samples
combined. Using genome-wide SNP weights, the R2 for predicted
PC1 was 1.000 (95% CI: 1.000—1.000) and the R2 for predicted
PC2 was 0.994 (95% CI: 0.992—0.994) (Supplementary Table S3).
The sample shrinkage was 1.013 (SD = 0.002) for predicted PC1

 

1402

112 /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepBOIU/IAOG

9IOZ ‘091sn3nv uo ::

Improved ancestry inference using weights

 

and 0.844 (SD 20.002) for predicted PC2. In addition, we per-
formed direct PCA on BD samples and compared PC1 and PC2
from direct PCA with gold standard. The R2 for PC1 from direct
PCA was 0.994 (95% CI: 095141960), and the R2 for PC2 from
direct PCA was 0.003 (95% CI: —0.007—0.006), which suggests
that direct PCA cannot distinguish samples with Ashkenazi
Jewish ancestry from others. In addition to comparing PCs dir-
ectly, we also assigned BD samples to one of the three European
sub-populations based on predicted PC1 and PC2. We compared
the assigned ancestry category with the assigned ancestry cat-
egory based on the gold standard. The assigned category based
on predicted PCs had only 5 out of 1636 samples misclassiﬁed
(Supplementary Table S5). We also estimated % ancestry from
NW, SE and AJ ancestral populations for BD samples
(Supplementary Table S4).

We created three PCA plots and color coded all BD samples
into three European sub-populations (Fig. 2). Comparing the
PCA plots, the predicted PC1 and PC2 had a very similar pattern
to the gold standard. We can visually distinguish the BD samples
with Ashkenazi Jewish ancestry from the BD samples with other
European ancestry with the predicted PCs. We can also see a
gradient of samples with Northwest and Southeast European
ancestry. In contrast, the PCs from direct PCA on BD samples
alone failed to distinguish the samples with Ashkenazi Jewish
ancestry from other samples. We also compared our PCA
plots with the PCA plots from Price et al. (2008). The
PCA plot we created here with predicted PCs is comparable
with Figure 2 from Price et al. (2008) using direct PCA on the
same BD samples plus three other additional datasets. This sug-
gests that the predicted PCs by using our model are not only
comparable with the gold standard here but also comparable
with PCs obtained by using other datasets. The analysis of
BCa samples produced similar results, as PCA based on pre-
dicted PCs showed better clustering of samples according to
self-reported ancestry than direct PCA on BCa samples
(Fig. 3). In summary, the results from both BD and BCa samples
showed that our method outperformed direct PCA on target
samples.

We also used 150 AIMS from a European American AIM
panel to predict PC1 and PC2 for BD samples (Price et al.,
2008). Using 150 AIMS, the R2 was 0.418 (95% CI: 0.354—
0.488) for predicted PC1 and 0.407 for PC2 (95% CI: 0.322—
0.505). These numbers are limited by the inclusion of only 150
of the 300 AIMS from Price et al. (2008) based on the intersection
of SNPs with our data, but it is nonetheless clear that ancestry
inference from a limited number of published AIMS substantially
underperforms the proposed use of genome-wide SNP weights.
In addition to using the AIM panel, we also used different num-
bers of random SNPS and AIMS that are selected by SNP
weights to predict PC1 and PC2 for BD samples. The R2 for
predicted PC1 using different numbers of random genotypes,
AIMS and genome-wide SNPs for BD samples are shown in
Figure 4. As expected, the R2 increased with the number of
random SNPS or AIMS used to predict PCs. However, the R2
obtained by using a subset of random SNPS or AIMS were much
lower than using the full set of genome-wide SNPS. Results for
predicted PC2 were similar to results for predicted PC1
(Supplementary Table S3).

 1E ‘ I  IZI IIII'I ' _' _

013* . - -_i.’
I.':1|'|"
0.0.7- -
r304-
.3[.1- .', .1- ' +."_-+" '
-00.- +- .-

I

.|'_E :I'J -I

390310 |:|"|I'|2‘I|:|-.‘I E-ZIF'IIIIIII'IE'I'I

 

 

 

 

I.'I:'.|?|-

-01I- ' -001-

 

 

-|ZI1E {II} {IDS {ID-"I IIIIIIIII DJI- -EI|I|-I- 4332 [Hill] 001 003

I'II'SI D'II'IZ‘IDEI GEI'I'DIZI'IE'I'I LIIEIEI'II'IIZII‘SI III: I'I1DCII'IEI'II

(III

I'II'II'I"

 

I WWII-west Emir-sans In Ell:I sa-Tplss

II Smmeast Eurotesrls In ELI samples

‘5 Asthma:- Jaws Il'l BI: samples
NIIIII'II-LI-I EUUPIMIIS III F's“:- LuaIIIIIIes
Stun-least Eurosesns ll'l FHS sanulas
Bull-innit: -.|I‘:w. Ill Fl IE- 5.10100";

II Cert—Ms for Inree Eureaeer' sm-grmps

[IDE-

 

 

I-ns - _-'-r,;

l'.| U:- ' - 

-|II LIE -

 

9901'”; WWII-INI CEIH'IDCI'IPI'II

 

-00=I-

 

I'.| IL": '3 I33 3' D1 I."I I'll

FIr-'.'.|.III|1:|F1:-l umrﬁturmll'.

Fig. 2. Comparison between (a) the ﬁrst and second PCS by performing
PCA on BD data alone, 0)) predicted ﬁrst and second PCS of BD data by
using model built with SHARe data and (c) the ﬁrst and second PCS
obtained by performing PCA on combined BD and SHARe data. The
BD samples are color coded into three groups based on distance to cen-
troids in panel (c) (see Section 2)

 

 

{3101:- [b]. 0.045-

. I I.
E IIIII E 0.0:.5- 
3 000- . E 
g  ._-_ E 0025- ' r
3 000- _ It". -. 3
I; My ,4? ;_ g 00:5-
5 I ".7" -E
3 002- .I- . -.1“..’,‘ -r 1'}. - 3 0.005- . -- -

'. =5- - ' ' - ' r " "

I”  I sift-Es . "' “I”  

 

 

.I:I.III~I.- 41015 -
I I I I I I I I |. I

 

 

I I I I I I
41.12 41.06 AID-i 0.110 0.11-1- -IZI.I]~cl- 43.03 4h]? -I:I.|11 II].IZI|:I [HI-1 ELEI!

Firsl prrupal :nn‘punenl first prhcipll camp-urban!

Fig. 3. Comparison between (a) the ﬁrst and second PCS by performing
PCA on BCa samples directly and (b) the predicted ﬁrst and second PCS
of BCa samples by using ancestry inference model built with SHARe
data. These European American samples are color coded according to
their self-reported ancestry

3.3 Population stratiﬁcation simulations

We conducted a simulation study of population stratiﬁcation
using BD genotypes and phenotypes simulated from genotypes
of an SNP at the LCT locus, similar to the simulation study
described in our previous article (Price et al., 2006). We found
that ﬁve SNPS had spurious association with the simulated
phenotype, with genome-wide signiﬁcant P—values (Table 1).
We compared several strategies for correcting for population
stratiﬁcation: genomic control, PC correction using predicted
PC1 and PC2 based on genome-wide SNP weights, PC correc-
tion using PC1 and PC2 from direct PCA on BD samples only
and PC correction using predicted PC1 and PC2 based on 150
AIMS.

 

112 /310's113umo [p.IOJXO'SOIlBIIIJOJUIOICI/ﬁdllq 11101; pep1201umoq

9IOZ ‘091sn3nv uo ::

C.-Y.Chen et al.

 

The adjusted X2 statistics and P—values showed that the gen-
omic control failed to correct for the spurious associations, and
all ﬁve SNPs were still genome-wide signiﬁcant. In contrast, ad-
justment by the predicted PC1 and PC2 based on genome-wide
SNPS successfully removed the spurious association, yielding
non-signiﬁcant genome-wide P—values. The adjustment by PC1
and PC2 from direct PCA also successfully removed the spurious
association and attained similar adjusted P—values as adjustment
by predicted PC1 and PC2. This can be explained by the fact that
stratiﬁcation at the LCT locus is predominantly an NW versus
SE Europe (i.e. PC1) effect. The P—values after adjustment by
predicted PCs based on 150 AIMS were still more signiﬁcant
than those adjusted by two predicted PCs based on genome-
wide SNPs or the ﬁrst two PCs from direct PCA. This result
suggests that there is residual confounding after adjustment by
predicted PCs based on 150 AIMS and highlights the advantage
of using genome-wide SNP weights for PC prediction.

1.0 - II
0.9 - l
0.3 - i

0,? ~ AIME.

Dﬁ - E E

0.5 -

0.4- I I
0.3 - E E

0.2 -§
0.1 — E

R2

 

Fill

 

 

RandomSNPs

0.0 — '
I | I | I | I I I I |

C: D C: D- C: D- D 1:: 1:1 1::

1— N In D D D CI ID D C:

II- N In I: 1:: III III

II— IN Ln 1::

1_

Number of SNPS

Gamma-wide

Fig. 4. Comparison between R2 for ancestry inference using AIMS,
random SNPS and genome-wide SNPS. Models were built with 6546
FHS SHARe samples and tested with 1636 BD samples. R2 was calcu-
lated with the predicted ﬁrst PC and the gold standard, which iS the ﬁrst
PC obtained by applying PCA to combined samples of FHS SHARe
samples and BD samples with 346 070 SNPS. The vertical bars represent
95 % CIS

Table 1. SNPS have Spurious association with Simulated phenotype

4 DISCUSSION

In this study, we presented methods and software for ancestry
inference using genome-wide SNP weights derived from large
reference panels. We showed empirically that this approach
can accurately predict PCs and % ancestry in populations of
admixed continental ancestry and in European Americans,
which have more subtle population structure. Our results high-
light the advantage of inferring ancestry using genome-wide
SNPs obtained from a large external reference panel.

We further compared predicted PCs obtained by using
genome-wide SNPs with those obtained by using subsets of
random SNPS or AIMS, and showed that predicted PCs using
genome-wide SNPS have the highest accuracy. AIM panels have
been proposed for ancestry inference in African Americans
(Ruiz-Narvaez et al., 2011), Latino Americans (Galanter et al.,
2012) and European Americans (Paschou et al., 2008; Price et al.,
2008; Tian et al., 2008). For African Americans, it had been
suggested that accurate ancestry inference requires only 30
AIMS (Ruiz-Narvaez et al., 2011). However, we observed that
genome-wide SNPS provide more accurate ancestry estimates
than even 100 AIMS in African Americans. Thus, our approach
based on genome-wide SNP weights outperforms the use of AIM
panels. Our simulation study of population stratiﬁcation further
conﬁrmed this point by showing that adjustment using our
method outperforms adjustment using 150 AIMS. In applications
in real data analysis, the AIM approach has the advantage that it
requires less genotyping work if genome-wide SNP genotypes are
not available. However, as the genome-wide marker data can
now be generated at very low cost, genotyping costs are less
likely to be a limitation going forward (Pasaniuc et al., 2012).
We also stress that our method can be used even when the input
genotypes contain an incomplete set of SNPS compared with the
genome-wide SNP weights, for example, if they were typed on a
different genotyping platform. Our simulations show that 1000
random SNPs or 10000 random SNPS are sufﬁcient to predict
ancestry with high accuracy in African Americans or European
Americans, respectively. However, a smaller number of random
SNPs genotyped in candidate gene or targeted replication studies
would not be sufﬁcient to infer ancestry in these populations.

By constructing SNP weights with a carefully selected unre-
lated reference panel, our approach can accurately infer ancestry
for related target samples, while direct PCA on related target
samples may provide inaccurate estimates of population

 

 

SNP Chr Unadjusted x2 Genomic Predicted PC1 and PC1 and PC2 Predicted PC1 and
control PC2 by genome-wide SNPS by direct PCA PC2 by 150 AIMS
rS2339390 1 46.90 (7.5 x 10‘”) 40.72 (1.8 x 10‘”) 7.47 (6.5 x 10‘3) 6.37 (1.2 x 10”) 10.55 (1.2 x 10‘3)
rS2339392 1 58.49 (2.0 x 10‘”) 50.78 (1.0 x 10‘”) 7.81 (4.9 x 10‘3) 6.90 (8.6 x 10‘3) 11.75 (6.1 x 10‘4)
rS9290629 3 54.76 (1.4 x 10‘”) 47.54 (5.4 x 10‘”) 7.95 (6.1 x 10‘3) 8.61 (3.3 x 10‘3) 9.67 (1.9 x 10‘3)
rS10437421 10 71.46 (2.8 x 10‘”) 62.04 (3.3 x 10‘”) 8.23 (4.2 x 10‘3) 9.35 (2.2 x 10‘3) 11.73 (6.1 x 10‘4)
rS7091038 10 67.15 (2.5 x 10‘”) 58.30 (2.2 x 10‘”) 13.23 (7.2 x 10‘4) 13.51 (2.4 x 10‘4) 16.80 (4.1 x 10‘5)

 

The unadjusted X2 statistics were obtained by Armitage trend test. The x2 statistics adjusted by predicted and observed PCS were obtained by logistic regression models.

Chr, chromosome.

 

112 /810's18umo [pJOJXO'SOIlBIIIJOJUIOIQ/ﬂdllq 1110131 pep801umoq

9IOZ ‘091snﬁnv uo ::

Improved ancestry inference using weights

 

structure. Zhu et al. (2008) proposed a method to correct for
population stratiﬁcation in the presence of family relatedness
in the target samples, which uses a subset of unrelated samples
to predict PCs for all target samples. Their method can also
avoid biased estimation of ancestry due to relatedness, but the
ancestry inference is limited to the unrelated target samples,
which may have insufﬁcient sample size and diversity. By using
a large external reference panel to compute the SNP weights, our
method is not limited to the target samples and can attain accur-
ate ancestry inference for related target samples.

Another advantage of our method is that it is based on pre-
computed SNP weights. The pre-computed SNP weights can be
readily shared with our software release. On the contrary, the
existing methods for accurate ancestry estimation usually require
raw genotypes from a large external reference sample. Access to
raw genotypes entails substantial administrative complexities,
which can be time-consuming. The sharing of SNP weights is
also more privacy preserving than the sharing of raw genotypes.
We note that it may be plausible to detect whether a given indi-
vidual is in the set of samples used to calculate the SNP weights,
analogous to detecting whether a given individual is in the set of
samples used to calculate summary statistics (Homer et al., 2008;
Sankararaman et al., 2009; Visscher and Hill, 2009). However,
because the samples that we used to calculate SNP weights in
were ascertained without regard to any phenotype, inferring
whether a given individual is in that set of samples reveals less
information than inferring whether a given individual is in a set
of samples ascertained for a particular phenotype.

Our method also has the advantage of reduced running time.
Existing software requires time O(MNZ) to compute PCs, where
M is the number of SNPs and N is the number of samples
(Patterson et al., 2006; Price et al., 2006). In theory, randomized
eigenvector approximations can reduce the running time to
O(MN) (Rokhlin et al., 2009). However, a colleague of ours re-
ports that efforts to apply this approach to genetic data have not
yet been successful, as in large datasets, eigenvalues may be
highly signiﬁcant (reﬂecting real population structure in the
data) but only slightly larger than background noise eigenvalues,
and thus sometimes missed by randomized methods (N.
Patterson, personal communication). Thus, our simple O(MN)
approach offers real practical advantages.

Our method relies on including samples from the appropriate
ancestral populations to build the model, to correctly infer %
ancestry component for given admixed samples. However, the
predicted PCs reﬂect the PCs obtained by performing PCA on
the combined raw genotypes from the admixed population and
the ancestral samples, irrespective of which ancestral samples
were included in the analysis. In the analyses presented here,
we built ancestry inference models using samples from three con-
tinental populations or NW, SE and AJ European populations.
When applying our method to samples with no good match in
the ancestral populations used, we still accurately predicted the
top PCs from PCA, although caution is warranted in interpreting
the results of either of these analyses with respect to the ancestral
populations used.

We can readily extend our method to build models with sam-
ples from other ancestral populations. For example, similar
models can be built for Indian and Native American populations
using appropriate reference panels (Reich et al., 2009, 2012).

Extension to more than three ancestral populations is straight-
forward, but accuracy is contingent on the sample size and di-
versity of the ancestral samples, as lower PCs may represent
more subtle population structure.

In summary, we have developed a method for ancestry infer-
ence using genome-wide SNP weights. Our method only requires
genotypes from the target samples and publicly available SNP
weights, and is highly computationally efﬁcient. The method can
be readily applied in genetic association studies for population
stratiﬁcation adjustment and in personal genomics for predicting
the ancestry component of an individual. For diseases or health
outcomes associated with ancestry, the predicted ancestry values
can be used for risk stratiﬁcation and risk prediction (Alonso-
Perez et al., 2011; Hughes et al., 2008; Kumar et al., 2010; Yang
et al., 2011).

ACKNOWLEDGEMENTS

The Framingham Heart Study is conducted and supported by
the National Heart, Lung, and Blood Institute (NHLBI) in col-
laboration with Boston University (Contract No. N01-HC-
25195). This manuscript was not prepared in collaboration
with investigators of the Framingham Heart Study and does
not necessarily reﬂect the opinions or views of the
Framingham Heart Study, Boston University or NHLBI.
Funding for SHARe Affymetrix genotyping was provided by
NHLBI Contract N02-HL-64278. We are grateful to
N. Patterson and S. Lee for helpful discussions, to C. Palmer
for assistance with FHS data and to the Molecular Genetics of
Schizophrenia II (MGS-2) collaboration and to P. Sklar and
S. Purcell for the BD dataset.

Funding: NIH grant R01 HG006399 (SP. and A.L.P.). CC. is
supported by a Taiwanese Physicians Scholarship from the
Harvard School of Public Health.

Conﬂict of Interest: none declared.

REFERENCES

Alonso-Perez,E. et al. (2011) Association of systemic lupus erythematosus clinical
features with European population genetic substructure. PLoS One, 6, 629033.

Altshuler,D.M. et al. (2010) Integrating common and rare genetic variation in di-
verse human populations. Nature, 467, 52—58.

Devlin,B. and Roeder,K. (1999) Genomic control for association studies.
Biometrics, 55, 997—1004.

Enattah,N.S. et al. (2002) Identiﬁcation of a variant associated with adult-type
hypolactasia. Nat Genet, 30, 233—237.

Galanter,J.M. et al. (2012) Development of a panel of genome-wide ancestry in-
formative markers to study admixture throughout the Americas. PLoS Genet,
8, e1002554.

Homer,N. et al. (2008) Resolving individuals contributing trace amounts of DNA to
highly complex mixtures using high-density SNP genotyping microarrays. PLoS
Genet, 4, e1000167.

HugheS,L.B. et al. (2008) The HLA-DRBl Shared epitope is associated with sus-
ceptibility to rheumatoid arthritis in African Americans through European gen-
etic admixture. Arthritis Rheum, 58, 349—358.

Hunter,D.J. et al. (2007) A genome-wide association study identiﬁes alleles in
FGFR2 associated with risk of Sporadic postmenopausal breast cancer. Nat
Genet, 39, 870—874.

Kumar,R. et al. (2010) Genetic ancestry in lung-function predictions. N. Engl. J.
Meat, 363, 321—330.

 

1e /810'S{eumo IpJOJXO'SOIlBIIIJOJUIOIQ/ﬂdllq 11101; pep1201umoq

9IOZ ‘091snﬁnv uo ::

C.-Y.Chen et al.

 

Lango Allen,H. et al. (2010) Hundreds of variants clustered in genomic loci and
biological pathways affect human height. Nature, 467, 832—838.

L66,S. et al. (2010) Convergence and prediction of principal component scores in
high-dimensional settings. Ann. Stat, 38, 3605—3629.

Novembre,J. et al. (2008) Genes mirror geography within Europe. Nature, 456,
98—101.

Novembre,J. and St6ph6nS,M. (2008) Interpreting principal component analyses of
Spatial population genetic variation. Nat Genet, 40, 646—649.

Pasaniuc,B. et al. (2012) Extremely low-coverage sequencing and imputation in-
creases power for genome-wide association studies. Nat Genet, 44, 631—635.

Paschou,P. et al. (2008) Tracing sub-structure in the European American population
with PCA-informative markers. PLoS Genet, 4, 61000114.

Patterson,N. et al. (2006) Population structure and eigenanalysis. PLoS Genet, 2,
6190.

Price,A.L. et al. (2006) Principal components analysis corrects for stratiﬁcation in
genome-wide association studies. Nat Genet, 38, 904—909.

Price,A.L. et al. (2008) Discerning the ancestry of European Americans in genetic
association studies. PLoS Genet, 4, 6236.

Price,A.L. et al. (2010) New approaches to population stratiﬁcation in genome-wide
association studies. Nat Rev. Genet, 11, 459—463.

Pritchard,J.K. et al. (2000) Association mapping in structured populations. Am. J.
Hum. Genet, 67, 170—181.

Purcell,S. et al. (2007) PLINK: a tool set for whole-genome association and popu-
lation-based linkage analyses. Am. J. Hum. Genet, 81, 559—575.

Reich,D. et al. (2009) Reconstructing Indian population history. Nature, 461,
489—494.

Reich,D. et al. (2012) Reconstructing native American population history. Nature,
488, 370—374.

Rokhlin,V. et al. (2009) A randomized algorithm for principal component analysis.
SIAM. J. Matrix Anal. Appl., 31, 1100—1124.

Royal,C.D. et al. (2010) Inferring genetic ancestry: opportunities, challenges, and
implications. Am. J. Hum. Genet, 86, 661—673.

Ruiz-Narvaez,E.A. et al. (2011) Validation of a small set of ancestral informative
markers for control of population admixture in African Americans. Am. J.
Epidemiol., 173, 587—592.

Sankararaman,S. et al. (2009) Genomic privacy and limits of individual detection in
a pool. Nat Genet, 41, 965—967.

Seldin,M.F. and Price,A.L. (2008) Application of ancestry informative markers to
association studies in European Americans. PLoS Genet, 4, 65.

Splansky,G.L. et al. (2007) The third generation cohort of the national heart, lung,
and blood institute’s framingham heart study: design, recruitment, and initial
examination. Am. J. Epidemiol., 165, 1328—1335.

Tian,C. et al. (2008) Analysis and application of European genetic substructure
using 300 K SNP information. PLoS Genet, 4, 64.

Visscher,P.M. and Hill,W.G. (2009) The limits of individual identiﬁcation from
sample allele frequencies: theory and statistical analysis. PLoS Genet, 5,
61000628.

Yang,J.J. et al. (2011) Ancestry and pharmacogenomics of relapse in acute lympho-
blastic leukemia. Nat Genet, 43, 237—241.

Zhu,X. et al. (2008) A uniﬁed association analysis approach for family
and unrelated samples correcting for stratiﬁcation. Am. J. Hum. Genet, 82,
352—365.

 

1e /B.IO'S[BU.IIIO[p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁ(111111 11101; pepeommoq

9IOZ ‘091snﬁnv uo ::

