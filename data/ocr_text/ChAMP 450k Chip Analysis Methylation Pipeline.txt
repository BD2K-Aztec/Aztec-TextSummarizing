APPLICA TIONS NOTE V35? 3 071° bgiiilfgfgfﬂiicgfﬁ

 

Genome analysis

Advance Access publication December 12, 2013

ChAMP: 450k Chip Analysis Methylation Pipeline

Tiffany J. Morris1 ’*, Lee M. Butcherl, Andrew Feber‘, Andrew E. Teschendorff2’3,
Ankur R. Chakravarthyl, Tomasz K. Wojdacz4 and Stephan Beck1

1Medical Genomics, and 2Statistical Genomics, UCL Cancer Institute, University College London, London WC1 E BBT,
UK, 3CAS—MPG Partner Institute for Computational Biology, Shanghai Institute for Biological Sciences, Shanghai
200031, China and 4Institute of Environmental Medicine, Karolinska Instytutet, 17177 Stockholm, Sweden

Associate Editor: John Hancock

 

ABSTRACT

The Illumina Infinium HumanMethylation450 BeadChip is a new plat-
form for high-throughput DNA methylation analysis. Several methods
for normalization and processing of these data have been published
recently. Here we present an integrated analysis pipeline offering a
choice of the most popular normalization methods while also introdu-
cing new methods for calling differentially methylated regions and
detecting copy number aberrations.

Availability and implementation: ChAMP is implemented as a
Bioconductor package in R. The package and the vignette
can be downloaded at bioconductor.org

Contact: tiffany.morris@ucl.ac.uk

Received on May 30, 2013; revised on November 3, 2013; accepted
on November 19, 2013

1 INTRODUCTION

DNA methylation is the most studied epigenetic modiﬁcation.
Changes in DNA methylation patterns have been implicated
in the development of a number of diseases and have been
deﬁned as a major hallmark of cancer (Feinberg, 2007).
Technological developments for the genome-wide detection of
DNA methylation have grown rapidly in recent years, and
several options exist (Bock, 2012). Although bisulphite conver-
sion combined with next-generation sequencing is the most
comprehensive approach, it is currently feasible for only small
sample sizes, and application to large-scale studies remains
challenging. The Inﬁnium HumanMethylation450 BeadChip
(www.illumina.com) offers this rapidly moving ﬁeld an
attractive balance with respect to throughput, coverage and
cost. It extends the previous 27k array, providing an assessment
for >480 000 CpG loci, covering key features of the human
genome, including CpG islands, shores and shelves as well as
promoters, gene bodies, intergenic and imprinted regions
(Bibikova et al., 2011). Based on Pubmed and GEO submissions,
the 450k array has established itself as the platform of choice for
epigenome-wide association studies (Rakyan et al., 2011).

The challenge with this new technology is in the analysis.
There are several important steps a 450k analysis pipeline
should include: normalization, batch effect analysis, single
nucleotide polymorphism (SNP) ﬂagging, detection of copy
number aberrations (CNAs) and segmentation of methylation

 

*To whom correspondence should be addressed.

variable positions (MVPs) into biologically relevant DMRs.
Normalization is especially important, as the 450k platform com-
bines two different assays, Inﬁnium I and Inﬁnium II (Bibikova
et al., 2011; Sandoval et al., 2011). A number of normalization
methods are now available that deal with this issue in slightly
different ways (Marabita et al., 2013). In chronological order
of development, they are Peak Based Correction (PBC)
(Dedeurwaerder et al., 2011), SQN (Touleimat and Tost,
2012), Subset-quantile within array normalisation (SWAN)
(Maksimovic et al., 2012) and Beta-mixture quantile normaliza-
tion (BMIQ) (Teschendorff et al., 2013).

2 DESCRIPTION

The Chip Analysis Methylation Pipeline (ChAMP) package is
a pipeline that integrates currently available 450k analysis
methods and also offers its own novel functionality. It is im-
plemented in R and can be run on any platform with an
existing R (version >30) and Bioconductor installation.
ChAMP takes the raw IDAT ﬁles as input, using the data
import, quality control and normalization options offered by
minﬁ (Hansen and Ayree, 2011). By default, raw data are ﬁl-
tered for probes with a detection P> 0.01 in at least one
sample. If raw data are not available, users are able to
upload a matrix of M—, beta— or raw intensity values. The
user can decide to ﬁlter out individual probes or probe sets
such as the X and Y chromosomes. An option to ﬁlter SNPs
based on a user-speciﬁed minor allele frequency in one of four
populations as deﬁned by the 1000 genomes project (The 1000
Genomes Project Consortium, 2012) is also available. This pre-
vents biases due to genetic variation in downstream statistical
analyses aimed at identifying differentially methylated Cst.
The batch effect analysis is performed on raw data and can be
more thorough if the user provides additional covariate infor-
mation available for the particular study (i.e. age, gender, etc).
Following preprocessing, subsequent steps include normaliza-
tion, DMR calling and CNA detection, which are illustrated in
Figure 1 and described in more detail later.

2.1 Adjustment for type2 bias

After running basic quality control metrics, it is recommended
to perform intra-array normalization to adjust the data for bias
introduced by the Inﬁnium type 2 probe design. ChAMP offers a
choice of four methods that have recently been developed spe-
ciﬁcally for 450k data. As default, ChAMP implements BMIQ

 

428 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 ﬁhO'smumo[pJOJXO'soi1BmJOJutoiw/2d11q IIIOJJ pepnolumoq

910K ‘09 lsnﬁnV no :2

450k Chip Analysis

 

 

 Raw data ﬁles


Lead and provide QC images

Memylatien values ﬁltered for detection p-vslue
. i L .

 

Neutralization — Adjustment for type-2 bias:

__ ,i j, _ __ _
I. ___SVD (batch effects) 
Batch effeEchrrection I I   HHEIISIS 
' .i L ' ' '
MVPs
_1_r#

SNP filtering " j
' 'itjli' "

 DMRs ':

Fig. 1. ChAMP includes pre-processing and published methods for
adjustment of type 2 bias (squares) and novel methods (circles) for
batch effect assessment, DMR correction and CNA analysis

(Teschendorff et al., 2013), which was identiﬁed by Marabita
et al. (2013), as an effective method. The user can also select
SWAN (Maksimovic et al., 2012), PBC (Dedeurwaerder et al.,
2011) or no normalization.

2.2 Batch effects

To assess the magnitude of batch effects in relation to biological
variation, singular value decomposition is applied to the data
matrix to obtain the most signiﬁcant components of variation
(Teschendorff et al., 2011). A heatmap rendering the strength
of association between the principal components and technical/
biological factors allows the user to easily visualize whether
batch effects are present. If present, there is an option within
ChAMP to use ComBat to correct for these effects (Johnson
et al., 2007).

2.3 MVP and DMR calling

For MVP calling, ChAMP uses the Bioconductor package
Limma (Smyth, 2005) to compare two groups. The MVP calling
can be performed on M- or beta— values. Zhuang et al. (2012)
recommend that M-values be used for small sample size studies
(<10 samples per phenotype). As DNA methylation is highly
correlated for up to 1000 bases (Li et al., 2010), unidirectional
MVPs can be grouped into biologically more relevant DMRs as
implemented by (J affe et al., 2012). ChAMP incorporates a novel
DMR hunting algorithm ‘probe lasso’ that considers annotated
genomic features and their corresponding local probe densities
and methylation according to (Li et al., 2010). Probe lasso
(Butcher unpublished) varies the requirements for nearest neigh-
bour probe spacing in a given region based on the genomic fea-
ture to which the probe is mapped. The appropriate-sized lasso is
then centred on each signiﬁcant CpG probe and retained if the
lasso captures an additional minimum user-speciﬁed number of
signiﬁcant probes.

2.4 CNA analysis

Finally, ChAMP integrates a method for analyzing 450k inten-
sity values to identify CNAs in a given dataset (Feber et al.,
2013). This has the advantage of getting ‘two for one’ analyses
of the same sample, which is particularly important in the
context of cancer where tumour heterogeneity is a major
confounding factor unless the exact same sample is used. The
resulting CNA analysis has been compared with SNP data and
been shown to yield comparable results (F eber et al., 2013).

3 DISCUSSION

The bottleneck for researchers using the 450k platform as
part of systems and disease-oriented projects is the need
for an integrated analysis pipeline. We have addressed this
need by developing ChAMP and making it publicly available.
ChAMP incorporates already published and novel tools
and complements existing 450k analysis pipelines such as
Illumina Methylation Analyzer Wang et al., 2012), RnBeads
(Assenov et al., 2013) and wateRmelon (Pidsley et al., 2013),
providing users a choice for their analyses. The advantage of
ChAMP is that it offers three additional methods for the
analysis of batch effects, DMR calling and CNA detection
over and above the standard functionalities. ChAMP has
been tested on studies containing up to 200 samples on a
personal machine with 8 GB of memory. For larger epigen-
ome-wide association studies, the pipeline requires more
memory, and running it in steps as described in the vignette
can break up the time requirements.

ACKNOWLEDGEMENT

The authors acknowledge Anna Karpathakis, Charles Breeze
and Dirk Paul for their contributions.

Funding: A.E.T. was supported by a Heller Research Fellowship.
The Beck laboratory was supported by the Wellcome Trust
(084071), Royal Society Wolfson Research Merit Award
WVM100023), IMI-JU OncoTrack (115234) and EU-FP7
projects IDEAL (259679), EPIGENESYS (257082) and
BLUEPRINT (282510).

Conﬂict of Interest: none declared.

REFERENCES

Assenov,Y. et a]. (2013) Comprehension Analysis of DNA Methylation Data with
RnBeads, http://rnbeads.mpi-inf.mpg.de.

Bibikova,M. et a]. (2011) High density DNA methylation array with single CpG site
resolution. Genomics, 98, 288—295.

Bock,C. (2012) Analysing and interpreting DNA methylation data. Nat. Rev.
Genet, 13, 705—719.

Dedeurwaerder,S. et a]. (2011) Evaluation of the inﬁnium methylation 450k
technology. Epigenomics, 3, 771—784.

Feber,A. et a]. (2013) CNA proﬁling using high density DNA methylation arrays.
Genome Biol., in process.

Feinberg,A. (2007) Phenotypic plasticity and the epigenetics of human disease.
Nature, 447, 433—440.

Hansen,K. and Ayree,M. (2011) minﬁ: Analyze Illumina’s 450k methylation arrays.
R package version 1.8.3.

Jaffe,A. et a]. (2012) Bump hunting to identify differentially methylated regions
in epigenetic epidemiology studies. Int. J. Epidemiol., 41, 200—209.

 

429

112 ﬁhO'smumo[pJOJXO'sot1chOJutotw/2d11q IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no :2

T.J.Morris et al.

 

J ohnson,W. et al. (2007) Adjusting batch effects in microarray expression data using
empirical bayes methods. Biostatistics, 8, 118—127.

Li,Y. et al. (2010) The DNA methylome of human peripheral blood mononuclear
cells. PLoS Biol, 8, e1000533.

Maksimovic,J. et al. (2012) Swan: subset-quantile within array normalization for
illumina inﬁnium humanmethylation450 beadchips. Genome Biol, 13, R44.

Marabita,F. et al. (2013) An evaluation of analysis pipelines for DNA methylation
proﬁling using the illumina humanmethylation450 beadchip platform.
Epigenetics, 8, 333—346.

Pidsley,R. et al. (2013) A data-driven approach to preprocessing illumina 450k
methylation array data. BM C Genomics, 14, 293.

Rakyan,V. et al. (2011) Epigenome—wide association studies for common human
diseases. Nat. Rev. Genet, 12, 529—541.

Sandoval,J. et al. (2011) Validation of a DNA methylation microarray for 450,000
CPG sites in the human genome. Epigenetics, 6, 692—702.

Smyth,G.K. (2005) Limma: linear models for microarray data. In: Bioinformatics
and Computational Biology Solutions Using R and Bioconductor. Springer, NY,
pp. 397—420.

Teschendorff,A. et al. (2011) Independent surrogate variable analysis to deconvolve
confounding factors in large-scale microarray proﬁling studies. Bioinformatics,
27, 1496—1505.

Teschendorff,A. et al. (2013) A beta-mixture quantile normalization method for
correcting probe design bias in illumina inﬁnium 450k DNA methylation
data. Bioinformatics, 29, 189—196.

The 1000 Genomes Project Consortium. (2012) An integrated map of genetic
variation from 1,092 human genomes. Nature, 491, 56—65.

Touleimat,N. and Tost,J. (2012) Complete pipeline for inﬁnium((r)) human methy-
lation 450k beadchip data processing using subset quantile normalization for
accurate DNA methylation estimation. Epigenomics, 4, 325—341.

Wang,D. et al. (2012) IMA: an R package for high-throughput analysis of
illumina’s 450k inﬁnium methylation data. Bioinformatics, 28, 729—730.

Zhuang,J. et al. (2012) A comparison of feature selection and classiﬁcation
methods in DNA methylation studies using the illumina inﬁnium platform.
BMC Bioinformatics, 13, 59.

 

430

112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOIQ/[i(11111 IIIOJJ pepsolumoq

910K ‘09 lsnﬁnV no 22

