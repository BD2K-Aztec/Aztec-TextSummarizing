Bioinformatics, 32(7), 2016, 993—1000

doi: 10.1093/bioinformatics/btv395

Advance Access Publication Date: 30 June 2015
Original Paper

 

Sequence analysis

Inference of Markovian properties of molecular
sequences from NGS data and applications
to comparative genomics

Jie Ren1. Kai Songz, Minghua Dengz, Gesine Reinert3,
Charles H. Cannon‘“5 and Fengzhu Sun1'6'*

1Molecular and Computational Biology Program, University of Southern California, Los Angeles, CA, USA, 2School
of Mathematical Sciences, Peking University, Beijing, China, 3Department of Statistics, University of Oxford,
1 South Parks Road, Oxford OX1 3TG, UK, 4Department of Biological Sciences, Texas Tech University, TX 79409-
3131, USA, 5Xishuangbanna Tropical Botanic Garden, Chinese Academy of Sciences, Yunnan, China and 6Centre
for Computational Systems Biology, School of Mathematical Sciences, Fudan University, Shanghai, China

*To whom correspondence should be addressed.
Associate Editor: Benjamin Raphael

Received and revised on March 11, 2015; accepted on June 25, 2015

Abstract

Motivation: Next-generation sequencing (NGS) technologies generate large amounts of short read
data for many different organisms. The fact that NGS reads are generally short makes it challeng-
ing to assemble the reads and reconstruct the original genome sequence. For clustering genomes
using such NGS data, word-count based alignment-free sequence comparison is a promising
approach, but for this approach, the underlying expected word counts are essential.

A plausible model for this underlying distribution of word counts is given through modeling the
DNA sequence as a Markov chain (MC). For single long sequences, efficient statistics are available
to estimate the order of MCs and the transition probability matrix for the sequences. As NGS data
do not provide a single long sequence, inference methods on Markovian properties of sequences
based on single long sequences cannot be directly used for NGS short read data.

Results: Here we derive a normal approximation for such word counts. We also show that the trad-
itional Chi-square statistic has an approximate gamma distribution, using the Lander-Waterman
model for physical mapping. We propose several methods to estimate the order of the MC based
on NGS reads and evaluate those using simulations. We illustrate the applications of our results by
clustering genomic sequences of several vertebrate and tree species based on NGS reads using
alignment-free sequence dissimilarity measures. We find that the estimated order of the MC has a
considerable effect on the clustering results, and that the clustering results that use an MC of the
estimated order give a plausible clustering of the species.

Availability and implementation: Our implementation of the statistics developed here is available
as R package 'NGS.MC' at http://www—rcf.usc.edu/~fsun/Programs/NGS-MC/NGS-MC.html.
Contact: fsun@usc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

OXFORD

 

993

9mg ‘09 1sn8nV uo seleﬁuV soq ‘etulomeg JO KHSJQATII [1 1e ﬂJO'sleumo[pJOJXO'sopeuuogutotq/ﬁd11q mm; pepeolumoq

994

J.Ren et al.

 

1 Introduction

Next generation sequencing (NGS) technologies generate large
amounts of overlapping short read data for many different organ-
isms; for example a read is a subsequence of <400 bps for Illumina
and 700 bps for 454 sequencing technologies, and can sometimes be
much shorter. The fact that NGS reads are generally short makes it
challenging to reconstruct the original genome sequence.

Recently several word-count based alignment-free sequence com-
parison methods have been applied to infer the relationship among
different species (Song et al., 2013; Yi and Jin, 2013) and metage-
nomic samples (Behnam and Smith, 2014; Hurwitz et al., 2014;
Jiang et al., 2012; Wang et al., 2014) based on NGS reads without
assembly. Our alignment-free sequence dissimilarity measures, d;
and d3 (Song et al., 2013, 2014), and their variants (Behnam et al.,
2013; Liu et al., 2011; Ren et al., 2013) have shown promise. These
methods require the knowledge about the approximate distribution
of word counts in the underlying sequences. Although a model
which assumes that all letters in the sequence are equally likely is
relatively straightforward to analyze, see Reinert et al. (2009), a
Markov model for the underlying sequences is more realistic.

Markov chains (MCs) have been widely used to model molecular
sequences (Almagor, 1983) with many applications including the
study of dependencies between the bases (Blaisdell, 1985), the en-
richment and depletion of certain word patterns (Pevzner et al.,
1989), prediction of occurrences of long word patterns from short
patterns (Arnold et al., 1988; Hong, 1990), and the detection of sig-
nals in introns (Avery, 1987). Narlikar et al. (2013) studied the
effect of the order of MCs on several biological problems including
phylogenetic analysis, assignment of sequence fragments to different
genomes in metagnomic studies, motif discovery and functional clas-
sification of promoters. These applications showed the importance
of accurate specification of the order of MCs. Reliable estimators
for the order of the MC and the transition probability matrix based
on the sequence data are crucial.

Suppose a relatively long molecular sequence can be modelled
as a general finite state MC sequence of letters from a finite alphabet
A: {1,2,---,L} of size L. Consider testing the null hypothesis
that the long sequence follows a (k — 2)th order MC. With some
mild assumptions, Hoel (1954) showed that, under this null
hypothesis, twice the log-likelihood ratio of the probability of the
sequence under a (k — 1)th order MC versus that under the
(k — 2)th order MC model follows approximately a XZ-distribution
with dfk = (L — 1)2Lk_2 degrees of freedom. He also approximated
the log-likelihood ratio by the Pearson-type statistic

_ 2
St = Z —(NWE Ew) . <1)

WEAk

which is also approximately XZ-distributed with the same degrees
of freedom. Here, w = w1wz ---wk denotes a k-word formed of
letters w,- E A,
‘w‘ = wz - - -wk_1; NW denotes the count of the word w in the

‘wzwz---wk,w_=w1wz---wk_1, and

sequence, and EW 2 N—WNW— /N—w— is the estimated expected count
of w if the sequence is generated by an MC of order k — 2. Here [823;
see also Avery and Henderson (1999) for a detailed study, Billingsley
(1961a,b) for an excellent exposition of statistical issues related to
MCs, as well as Waterman (1995); Reinert et al. (2000, 2005); Ewens
and Grant (2005) for applications to sequence analysis.

The Chi-square statistic (1) and the log-likelihood ratio statistics
can be used to test the order of an MC, using all k-words W E Ak.
When a particular order of MC is rejected, we can identify

particular word patterns that are exceptional, through the approxi-
mate distribution of NW. The approximate distributions of NW in
long sequences is well understood, see for example Waterman
(1995 ); Reinert et al. (2005, 2000). In particular, suppose that the
sequence follows a stationary (k — 2)th order MC and let

63V=Ew (1—  (1— .
_W_ _W_

 

 

For
Zw = 4, (2)

Theorem 6.4.2 in Reinert et al. (2005 ) gives that, as sequence length
goes to infinity, for all real values x, Il"(ZW 3x) —> (I)(x), where (1)
denotes the cumulative distribution function of a standard normal
variable. We also say that ZW converges to the standard normal dis-
tribution N (0, 1) in distribution. This asymptotic result can then be
used to find exceptional words in long sequences.

Given an NGS short read sample, it is tempting to use the test
statistic Sk defined in (1) to test the order of an MC by simply count-
ing the number of the occurrences of words in short read data.
However, as the short reads from NGS data are sampled randomly
from the genome, some parts of the genome are possibly not
sampled and some parts are possibly sampled extensively. The sam-
pling process introduces additional randomness to the statistic, and
makes Sk deviate from its traditional X2 -distribution. Similarly, the
approximate distribution of ZW given in (2) will be different from
the standard normal distribution.

In this article, we study these approximate distributions, both
theoretically and by simulations. First we extend the statistics Sk and
ZW for an MC sequence to SE and Z5, for the NGS read data. Our
underlying model for the distribution of reads along the genome is
the potentially inhomogeneous Lander-Waterman model for phys-
ical mapping (Lander and Waterman, 1988). We discover that for a
set of short reads sampled from a (k — 2)th order MC sequence, the
statistic SE follows approximately a gamma distribution with shape
parameter dfk / 2 and scale parameter 2d, where d is a factor related
to the distribution of the reads along the genome. We also show
that, with the same factor d, the distribution of the single word stat-
istic ZE/x/g tends to the standard normal distribution. Based on the
theoretical results, we introduce an estimator for the order of the
MC using NGS data. For practical purposes, we also give an estima-
tor for the factor d when the underlying reads sampling distribution
is unknown. To the best of our knowledge, this is the first study of
the Markovian properties of molecular sequences based on NGS
read data.

To illustrate our theoretical results and our estimators, we first
carry out a simulation study based on transition probability matrices
which are estimated from cis-regulatory module (CRM) DNA sequen-
ces, and insert repeats. We simulate different read lengths, numbers
of reads, inhomogeneous sampling, as well as sequencing errors,
and we include a regime where the sampling rate depends on the GC
content. If the GC bias is not very strong or the sequencing depth is
not very low, then the simulation results agree with our theoretical
predictions despite the theoretical assumptions being slightly violated.

Next we apply our methods to cluster 28 vertebrate species using
our alignment-free dissimilarity measures d; and d3 under different
MC models which are estimated from NGS read samples. The esti-
mated orders based on NGS data without assembly are found to be
consistent with those inferred directly from the long genome se-
quences. The clustering performs best when using MCs around the

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq IIIOJJ pepeolumoq

Inference of Markovian properties of molecular sequences

995

 

estimated order. Applying the same analysis to 13 tropical tree spe-
cies whose genomes are unknown, based on their NGS read samples,
the most plausible clustering is achieved when using an MC model
of order close to the one estimated from the NGS reads.

The article is organized as follows. The ‘Methods’ section contains
the probabilistic models of generating the MC sequence and sampling
the short reads, as well as the theorem for the approximate distribu-
tions of SE and Z5, for NGS data. This theorem is used to derive our
estimators for the order of the MC and for the factor d. In the
‘Results’ section, we first provide extensive simulation studies includ-
ing the comparison of the theoretical approximate distributions and
the simulated results for SE and Z5,, the effect of inhomogeneous sam-
pling and sequencing errors, the efficiency of the estimator of the fac-
tor d, and the evaluations of the methods for estimating the MC
order. Second, we estimate the orders of the MCs for 28 vertebrate
species based on the simulated whole genome NGS samples. We then
use our dissimilarity measures d; and d; to cluster the NGS samples
of the 28 species under different MC orders to see the effect on the
performance of the clustering. The applications show that our new
methods are effective for the inference of relationships among se-
quences based on NGS reads. Finally, we use our methods to study
the relationships among 13 tree species whose complete genomic se-
quences as well as their phylogenetic relationships are unknown. Our
clustering results are consistent with the physical characteristics of the
tree species. The article concludes with some discussion of the study.

2 Methods

2.1 Probabilistic modeling of an MC sequence and
random sampling of the reads using NGS

In NGS, a large number of reads are randomly sampled from the
genome. Hence two random processes are involved in the generation
of the short read data: the generation of the underlying genome
sequence and the random sampling of the reads.

We use an rth order homogeneous ergodic MC to model the
underlying genome sequence with each letter taking values in a finite
alphabet set A of size L. Because our study is based on genomic
sequences, L = 4. As in Lander and Waterman (1988), Zhang et al.
(2008), Zhai et al. (2012), Daley and Smith (2013), Simpson (2014),
we assume that the genome is continuous and that the distribution
of reads along the genome follows a potentially inhomogeneous
Poisson process with rate c(x) at position x. If c(x) = c for all x, we
refer to the sampling of the reads as homogeneous. We assume that
all sampled reads have the same length of [f bps. A total of M reads
are independently sampled from the genome of length G bps.

We extend the statistics Sk and ZW in (1) and (2) to NGS short
read data accordingly. Let N5, be the number of occurrences of the
k-word w in the short read data, where the superscript R refers to
the ‘read’ data, and define

(N5 - ER)2

 

SR = Ewell—ER W ’ <3)
W
R _ R
Z)? = NWA—REW, <4)
0'
where
N? NR_ N5 NR_
ER=#and(6R)2=ER (1——W) (1— W
W Nl‘w_ W W N_R,,_ N11,,

We have the following theorem on the approximate distributions
of SE and Z5,; the proof is given in the Supplementary Materials.

Note that for each read we discard the last la — 1 positions as they
would lead to words of length less than la; the error made with this
approximation is asymptotically negligible when la is small relative

to If.

Theorem 1: Assume that the underlying genome follows a (la—2)th
order MC which assigns non-zero probability to every k-word w Let
SE and Z5, be defined as in (3) and (4), respectively. Suppose that the
genome of length G can be divided into (not necessarily contiguous)
regions with constant coverage r,- for the ith region, so that every
base is covered exactly r,- times, based on the first [i — la + 1 positions
of the reads. Let G,- be the length of the ith region that changes with
G in a way such that limG_>00 G,- / G =  > 0 for the ith region,
i: 1,2,---. Let

 

Zinf‘.

Then, as G —> 00,

i. For each k-word w, in distribution, Z5, / \/d —> N (0, 1).

ii. The statistic SE/d has an approximate XZ-distribution with dfk
= (L — 1)2Lk_2 degrees of freedom; equivalently, the statistic SE
has an approximate gamma distribution with shape par-
ameter dfk / 2 and scale parameter 2d.

If the M reads are sampled homogeneously along the genome
with coverage c based on the first [i — la + 1 positions of the reads
along the genome, i.e. c = M( [f — la + 1)/(G — la + 1), the Lander-
Waterman formula (Lander and Waterman, 1988) shows that the
fraction of genome covered ri=i times is  = exp(—c)ci/i!. Under
this assumption, we obtain

Ziizfi : c2 + c
Em- C

The results in Theorem 1 continue to hold when taking d = c + 1.

=c+1.

 

In the Lander-Waterman model for physical mapping (Lander
and Waterman, 1988), the factor c = Mﬁ / G is the coverage of the
genome. Hence we refer to d from (5) as the effective coverage of
the reads along the genome based on the first [i — la + 1 positions of
each read.

2.2 Estimating the order of the MC based on NGS reads
Based on Theorem 1, we can estimate the order r of an MC sequence
using NGS reads. First, we test the null hypothesis that the sequence
follows an independent identically distributed (i.i.d; MC order 2 0)
model. For a test at significance level or, if S2R / d is higher than the
1 — a quantile of the XZ-distribution with df = (L — 1)2 degrees of
freedom, the i.i.d hypothesis is rejected. If this null hypothesis is re-
jected, then here we propose an estimator for the order of an MC; it
is an analog of a corresponding established estimator of MC orders
based on long sequences that has been shown to be effective. In the
Supplementary Materials we present four related estimators as well
as estimators based on the AIC and BIC information criteria; the
one presented here has the best performance in simulation studies.
We assume that the word length la 2 2 and that the assumptions
of Theorem 1 are satisfied. Then, for la 2 r + 2, SE / d has approxi-
mately a XZ-distribution with (L — 1)2Lk_2 degrees of freedom. If
la < r+ 2, then SE /d will typically be larger than expected from
this XZ-distribution. For la 2r+ 2, the law of large numbers gives

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'soueuuogurorq/ﬁdnq wort pepeolumoq

996

J.Ren et al.

 

R
that SET? —> 1 for G —> 00; if la < r + 2 then the ratio will be much
k

larger than 1 in the limit. Therefore we can estimate r as follows:

SR
25, = argmink{%} — 1. (6)
k

In general, we want the value of mink  to be very small, e.g.
< 0.01 .

Using the law of large numbers it can be shown that under our
assumptions this estimator is consistent, in the sense that 25, tends

to r in probability as G tends to infinity.

2.3 Estimating the effective coverage d

Often the effective coverage d is not known and we would like to
estimate the effective coverage d using NGS short read data. From
Theorem 1, we can see that, under the general conditions stated in
the theorem, (Z5,)2 / d follows a XZ-distribution with one degree of
freedom. Because the median of the XZ-distribution with one degree
of freedom is about 0.456, we can use the scaled median as a robust
estimator for d;

a = median{(Z5,)2, w e Ak}/0.456. (7)

When we assume that the underlying long sequence follows an MC
of order at most m, we use (m + 2)-words to estimate d using (7).
Note that for an i.i.d. model sequence, the set of two-words
would not yield meaningful results as there are only 16 different
two-words and the median based on 16 numbers is generally not
reliable. As an underlying genome sequence following an rth order
MC can also be seen as an (r + 1)th, (r + 2)th, . . . , and higher-order
MC sequence, we can use k-words with relatively large la (2r + 2) to
estimate the factor d, if the maximum order of an MC is unknown

beforehand.

2.4 Simulation study

For the simulation study, we first generate MCs of different orders.
For realistic parameter values, the transition probability matrices of
the MCs are based on real CRM DNA sequences in mouse forebrain
from Blow et al. (2010). We use CRM sequences here because CRM
sequences are often used to study the effectiveness of alignment-free
sequence dissimilarity measures (Goke et al., 2012; Ren et al., 2013;
Song et al., 2014). To take into consideration that in real genomic
sequences, many repeat regions are present, we insert repeats into
the generated MCs. We simulate NGS data by sampling a varying
number of reads of different lengths from the MC, varying genome
length as well as coverage.

We include homogeneous and inhomogeneous sampling of the
reads as well as sequencing errors. We also let the sampling rate of
the reads depend on the GC content of the fragments based on data
from the current sequencing technologies (Benjamini and Speed,
2012). We set the sequencing error rate at 10%, which is relatively
high compared with the true sequencing error rate in real sequencing
in order to clearly distinguish among the estimators with regards to
their robustness to sequencing errors. When a sequencing error
occurs at a position, the nucleotide base is changed to one of the
other three nucleotides with equal probability.

Once the NGS reads are generated, we calculate the statistics SE
and Z5, for each word w, the order estimator as, and the estimator
for effective coverage d based on (7); each procedure is repeated
1000 times. In each repeat experiment, we let the order estimator
choose the model from first-, second-, . . . , fifth-order MCs; we

estimate the effective coverage d by (7), using three-tuples for a
first-order MC, and four-tuples for a second-order MC. The details
are given in the Supplementary Materials.

2.5 Applications to the study of relationships among
organisms

We test our methods on real and simulated NGS data from 28 verte-
brate species whose complete genomic sequences are available and
that are comprehensively studied in (Miller et al., 2007; Karolchik
et al., 2008). We download the genomes of the 28 vertebrate species
from UCSC Genome Browser, and then use MetaSim (Richter et al.,
2008) to simulate reads from each of the 28 vertebrate species. In
simulations the accuracy of the order estimation increases with read
coverage. To reﬂect a worst-case scenario, we set the read coverage
to be 1 as a lower bound for the performance although the current
sequencing technology can generate data with very high read cover-
age. We set MetaSim to generate reads of length 62 bp under the
error rate which is estimated by Illumina in our simulations.

To estimate the order of MC based on the NGS sample for each
of the 28 species, we apply the order estimator 25k in (6 ); there is no
sharp ratio transition found over la 2 2, - - - , 14. Given that real gen-
omes consist of multiple types of regions (coding, non-coding and
regulatory regions) and each type may fit to different MC models,
the result indicates that no suitable MC model can adequately fit all
the patterns in the genome. Instead, we fit the data with a MC
model that can explain the majority (say 80%) of the word patterns
in the genome. Motivated by the normal approximation of a par-
ticular word statistic in Theorem 1, we study the fraction of k-words
whose occurrences can be explained using the statistic (Z5,)2 / d by
comparison to a XZ-distribution with one degree of freedom with
type I error 0.01. We estimate the order of MC to be the smallest
la — 2 under which more than 80% of k-words can be explained by
the (la — 2)th order MC.

To cluster the organisms, we use the inferred MC models to esti-
mate the expected number of occurrences of word patterns and then
study the relationships among the organisms using our dissimilarity
measures d; and d3. We briefly present their definitions below,
please see Song et al. (2013, 2014) for details. Then we apply a simi-
lar approach to study the relationships among 13 tree species with
NGS reads, for which neither the complete genome sequences nor
their relationships are known. To estimate the unknown effective
coverage d using k-words by (7), we let la to be relatively large and
use d as the value at which the estimated d stabilizes as la increases.

2.6 Alignment-free sequence comparison

dissimilarity measures

Consider two sets of NGS reads from two genomes. We use super-
scripts (1) and (2) to denote the first and the second read set, respect-
ively. Suppose that M“) reads of length If“) are in the ith dataset.
Because the reads can come from either the forward strand or the
reverse strand of the genome in NGS, we supplement the observed
reads by their complements and refer to the joint set of the reads and
the complements as the read set.

Let N3? be the count of the word w in the ith dataset.
We define ENg) to be the expected number of occurrences
of word w based on either the i.i.d model or a Markov model,
ENS) = MUM/20> — k + 1)(p£? + pig), where MUM/20> — k + 1) is
the total number of k-word in the ith sample, W is the comple-
ment of word w, and p3) is the probability of word w in the ith
genome under a specific model. Then we define D; and D3 as
follows,

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 10 A11819Aru [1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q IIIOJJ pepeolumoq

Inference of Markovian properties of molecular sequences

997

 

~(1) ~(2)
N N
D; = Z A, #, and
we (lENvg)ENv(V2)
~(1) ~(2)
N N
DS = Z k W W ’
W64 ~(1) 2 ~(2) 2
( w) +(Nw)
where N0) = N9 — ENg), i = 1, 2. Further, the dissimilarity meas-

W
ures d; and d3, ranging from 0 to 1, are defined as,

D3

 

 

 

 

d§=— 1— (1) 2 (2) 2 ,and
N N
\ ZWEA"  ZWEA"%
S
213—; 1— D2
2 .. W 2 J. on
we unmet we (comet

For comparison, we also use a simplistic dissimilarity measure based
on the non-centered correlation of the word frequencies defined as

Z Ak N(1)N(2)
We W W

 1‘l2....<Nss>>v:...<Nsa>r

d2

3 Results

3.1 Summary of simulation results

Due to page limitations, we summarize the simulation results here;
details are given in the Supplementary Materials. Our extensive
simulations show that the simulated mean, standard deviation and
distributions of SE and Z5, are very close to their corresponding the-
oretical approximations given by Theorem 1. Both the effective
coverage and the MC order can be estimated accurately under the
parameter settings of the current sequencing technologies.

3.2 The relationship among 28 vertebrate species
Supplementary Table S4 shows the estimated orders of MCs for a
group of 28 vertebrate species that are studied in (Karolchik et al.,
2008; Miller et al., 2007) based on simulated NGS short reads. For
each of the 28 species, we compute the fraction of the k-words that
have (Z5,)2 / d within the 99% of a XZ-distribution with one degree
of freedom, for k = 8, 9, . . . , 14. Using 80% as a threshold, we esti-
mate the order of MC for each species to be the smallest la — 2 under
which the fraction of words that can be explained by the (la — 2)th
order MC is greater than the threshold.

Comparing our results with the results in Narlikar et al. (2013),
where the order of MCs for a selection of vertebrate genomes was
estimated by AIC and BIC criteria using whole genome sequences,
we find that the estimated order based on NGS read data are almost
the same as that estimated based on the whole genome sequences in
Narlikar et al. (2013). Our proposed methods of estimating the
order of MC based on short reads of NGS data achieve the same ac-
curacy as that based on whole genome sequences.

For a given value of la, we compute d; and d3 using an rth order
MC, r = 0 (i.i.d model), . . . , (la — 2) for each pair of species,

yielding a 28 x 28 pairwise dissimilarity matrix under each MC
model. To evaluate the dissimilarity measures, we use the pairwise
distance matrix obtained from Supplementary Figure S1 in Miller
et al. (2007) as the gold standard for the dissimilarity between each
pair of the 28 species; the matrix is given as Supplementary Table S5
in the Supplementary Materials. Note that the estimated orders of
the 28 species range from 7 to 11, and the average order is 10. To
study the performance of the dissimilarity measures under different
orders of MC, we choose la 2 14 such that we can study the results
under the MC model with orders up to 12.

Table 1 shows Spearman’s rank correlation coefficient (SPCC) be-
tween the standard distance and the dissimilarity estimated by the d;-
type measures under MC models of various orders; higher SPCC indi-
cates better performance. Both measures, d; and d3, achieve their best
results of SPCC=0.92 when using an MC of order 12. Note that
using a simplistic dissimilarity measure d2 only gives SPCC = 0.08.

In general both d; and d3 obtain higher SPCC with the standard
matrix as the order of MC increases, except for d; at order 9. In par-
ticular, the measure d; has negative correlation coefficient with the
standard distance under the i.i.d model. The SPCC becomes stable
when the order of the MC used for the analysis is close to 11, the
maximum estimated MC orders over the 28 species. Here d; is less
affected by the order of the MC than d;. When the appropriate order
of MC is used, d; and d3 perform similarly and much better than d2.

3.3 The relationship among 13 tropical tree
species with unknown reference genomes
We also apply our method to the 13 tree species based on the NGS
shotgun read datasets in Cannon et al. (2010). The reference genome
sequences for the 13 tree species are unknown. Our objective is to
cluster these tree species using d; and d; with MCs for the sequences.

The estimated order of the MC for all the 13 tree species is 8. We
use the dissimilarity measures d; and d3 under various orders of MC
as the background model to cluster the 13 tree species from their
NGS reads. We choose la 2 1 1 so that we explore the MC with order
up to 9. We use the Unweighted Pair Group Method with
Arithmetic Mean to cluster the tree species.

The 13 trees species can be generally classified into two groups:
5 tree species from Moraceae and 8 tree species from Fagaceae. The
two Moraceaes, Ficus altissima and Ficus microcarpa, should cluster
together because they are known to be closely related and are both
large hemiepiphytic trees while the other three Moraceae species are
small dioecious shrubs. Within the Fagaceae group, the two
Castanopsis species should cluster together, and the five
Lithocarpus species should also form a subgroup. Trigonobalanus
doichangensis (Fagaceae) is an ancestral genus that is very divergent
from the rest of the family and has undergone considerable sequence
evolution. It should not group within the class of Castanopsis and
Lithocarpus in Fagaceae.

Figure 1 shows the clustering results of the 13 tree species using
d; under MCs of order 0 (i.i.d), 4, 8 and 9. The trees are built
based on all the reads. From the results we can see, under the i.i.d
model, Lithocarpus mixes up with Castanopsis; T.doichangensis

Table 1. The SPCC between the true distance matrix and the dis-
similarity matrix by d2-type dissimilarity measures under MC mod-
els with order 0 (i.i.d), 5, 9, 10, 11 and 12. The length of the k—tuple
word is 14

 

dz-type order = 0 order = 5 order = 9 order = 10 order = 1 1 order = 12

 

d; —0.21 —0.16 0.85 0.89 0.90 0.92
d3 0.86 0.87 0.85 0.88 0.90 0.92

 

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 10 A11819Aru [1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q u1011 pepeolumoq

998

J.Ren et al.

 

 

LI: ” , 'luluprl:

I

I +- ---- --F_Llﬂnnu-pln_hn1m

I -I--!.I-I

Imam. II-l l +--- ----F_lerdmﬂlfnllm

l +--3I. I- l
l l +-- - ----F_£a|tmll_lniﬂcn
l P-ﬂ..‘ | +--ﬂ.I-I
l I +-------F_EmlmlLII-dllnnnnrpn
+--H.I-: l

+-----------------------F_Tﬂwubn1m1mii

FJI‘EW

FJ‘WIHW
+———————H_Fim_ﬁuhﬂm

+——3a.e—I

+———————u.rtun_1uwmu

ﬁ-------H_Fiﬂl_ﬂm

-I--3l.. I—I
t—------ﬂ_l'll:l.n_lﬂtl:lalln

+--3e.a-
I

 

a -----

 

1——.—..—.—.—.—.—-

|
3:.l—l
|

 

 

’_________T
I
I-
I
I
I-
I-

HIDE-Hm“
(a) kl l. orderﬂ. d;
+— ------------- --—~F_LIMMW

da-IJ-I
............ . -F_I_Imw_rnllfﬂiﬂ

l l 4-

| +- Jami-l
I +-------F_J.‘I.'Ilumwlnl.qﬂl.
v—ﬂj—I

Irv-an-I

I l

I | +——--—F.L‘i.ﬂIIII:II-pa.bulnlnl
ﬂj-I l

hle-

"""'T

 

 

 

 

{h} kl I , order4, all;

4" "" "Him—minute
h-ﬂ-lI-E
h-H.LI yu- .... I-F41Wrﬂim

I I

r_ﬂ'.'l '— """"""" "'4in

I I
“Pal,” '— ------------- -—-F_Lim1m I
I I

+--i.ll-I I- ---------------------------- "Utmwl
I I

I
I-r-ﬂJ-I :- ---------------------- nag-11.);
I I

 

1—-Bl .i—I . Ulnﬁmlm

I

l l +---u--H_FI:UI_-£:m
4.. .... ...'| 3:_|I.r
I hr-n-Mmiﬁﬂi-l
.. wmiuﬂcﬂmﬂ‘u
EJle

 

 

 

[1:] kl 1, urderB, d;

I I +- ---- - -F_L|wmtnluti
_l'-__| 4.. ....... -.23 I,u-|
I 1. ————— “Emmi-In“-

| +—-———F_Cﬂtﬂ'miLl.ndilﬂ

+—— —————————— ——3I.I-I
1—-——-—F_Cmil_lﬂﬂm

I

Tall-I ' 'LFimﬂitm-un
I

I I In n-r- ﬁHmJLcriom-pn

2.3-I
| 1—----—H_FI.M_¢H:'I‘II1.H

 

 

 

:‘Jlumil
'Lﬂmtincwk

 

(d) kl 1, 121111319, :15

Fig. 1. The clustering of the 13 tropical tree species using d; under MC with
order 0 (i.i.d), 4, 8 and 9. The number on the branch refers to the frequency of
the branch occurring among the 30 clusterings based on random sampled
10% reads. The letter 'F’ at the beginning of the names represents Fagaceae;
similarly the letter 'M’ represents Maraceae

cannot be separated from the rest of Fagaceae, while under the
MC of order greater than 4, T.doichangensis is successfully sepa-
rated from the rest of the Fagaceae. Moreover, within the Moraceae
group, Ficus fistulas and Ficus langkokensis form a subgroup
under the i.i.d model, and they are separated under the MC with
order greater than 4. Although Elangkokensis is the closest
Maraceae to the Fagaceae under fourth-order MC, F.fistulosa be-
comes the closest species to the Fagaceaes under eighth and ninth
order MCs.

In order to see whether the clustering of the tree species can be
correctly inferred using only a portion of the shotgun read data, we
randomly sample 10% of the total read data for each tree species to
cluster them. To study the variation of the clusters due to random
sampling of the reads, we repeat the sampling process 30 times and
calculate the frequencies of each internal branch of the clustering
using all the reads occurring among the 30 clusterings. The number
on the branch refers to the frequency of the branch occurring among
the 30 clusterings based on random sampled 10% reads. Three
branches of the tree under MC of order 9 have frequencies of occur-
rence <30. When using the MC of a very high order, the clustering
becomes unstable.

For the clustering results using d3, see Supplementary Figure S7.
Under MC with all four orders, the two Castanopsis and the five
Lithocarpus species are grouped separately, and F.altissima
(Moraceae) and F.microcarpa (Moraceae) are clustered together.
Under the i.i.d model, T.doichangenesis (Fagaceae) is successfully
separated from Lithocarpus, but it is not the most outside species in
the Fagaceae group. When the MC order is >4, T.doichangenesis
(Fagaceae) gets separated from the rest of the Fagaceaes. It can also
be seen that when using the i.i.d model, or an MC with order 8 or
greater, some of the branches becomes unstable.

In general, the results show that the clustering becomes more
accurate as the order of MC increases using both d; and d3. Under
the i.i.d model, the clustering based on d; does not correctly separ-
ate Castanopsis from Lithocarpus, while the clustering based on d;
groups the two types separately. With higher-order MCs, d; success-
fully separates Castanopsis from Lithocarpus. The general clustering
structure among Lithocarpus, Castanopsis, Trigonobalanus and
Ficus stays correct when order is >4 for both measures. When using
the MC with order higher than the estimated order, the clustering is
unstable and indeed the branch for L.Hancei (Fagaceae) is not sup-
ported on the last tree when using only 10% of the data. With a
large number of parameters to estimate, 10% of the data does not
suffice to capture the information in the data. The best clustering is
achieved under an MC of order 8 and 9.

4 Discussion

NGS technologies provide large amount of data in the form of short
reads. Assembly of the millions of short reads to recover the long
sequence is challenging, because the relative short length of the reads
makes it difficult to resolve the repeat regions, not all regions may
be covered, and assembly is time consuming. Although multiple
sequence alignment may be prohibitive, we can use word-count
based dissimilarity measures to cluster the underlying species. These
measures require an underlying probability model for the sequences;
MCs are a reasonable model for such sequences. Although transition
probabilities can be estimated directly from count data, estimating
the order of an MC here is not straightforward.

Methods for estimating the order of an MC of a long sequence
have been developed since the 195 Os, but estimating the order of an
MC directly from a set of short reads without assembly has not been
studied yet. In this article, we develop two statistics SE and Z5, and
show that both SE and Z5, have surprisingly simple approximate dis-
tributions with only two parameters, one of them depending on the
order of the original long MC sequence, and the other one depend-
ing on the distribution of the reads along the sequence. Intriguingly,
one of these parameters is d = c + 1 under homogeneous sampling,
where c is the coverage of the reads along the genome based on the
first [i —k + 1 positions of each read.

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 10 A11819Aru [1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q u1011 pepeolumoq

Inference of Markovian properties of molecular sequences

999

 

On the basis of the property of SE and Z5,, we develop an estima-
tor for the order of an MC as well as an estimator for the parameter
d based on NGS data. Extensive simulation studies are carried out
to verify the theorem and evaluate the estimator.

Finally, we apply the estimation methods to two NGS datasets.
Because the real genome sequences consist of coding, non-coding and
various regulatory regions, single standard MC models do not fit the
data well. Moreover, some enriched patterns, such as the motif se-
quences, are widespread throughout the genomes and violate the sim-
ple MC model for the whole genome sequence. Hence studying the
fraction of k-words whose occurrences can be explained using the
statistic (Z5,)2 / d by comparison to a ﬁ distribution is a more realistic
way to determine the order of the MC for a real genome sequence.
The estimated orders are consistent with the orders estimated directly
from the full genome sequences using BIC methods.

Our primary motivation for this study is alignment-free genome
comparison using NGS data. Further, we cluster the 28 species based
on the NGS data using MC models with various orders. The results
show that the clustering performs best and gives stable results when
using an MC model with order on and above the estimated order. In
addition, we apply the same analysis to 13 tropical tree species whose
reference genomes are unknown; again the best clustering is achieved
under an MC with the order within the estimated range.

When the sequence length is short or the sequencing depth is
low, the numbers of occurrences of some k-words become small or
even zero. Then the assumption of non-zero variance for all word
counts which underlies the gamma approximation for SE no longer
holds and the gamma approximation may not work well. In such a
situation an exact test for the order of MCs in the spirit of Besag
and Mondal (2013) could be very helpful. In this article, we have
only made a start on the MC modeling of NGS data. An exhaustive
study of errors in the data, in the form of power studies, could help
to further understand the application range of our results. Finally, in
this work we take the estimation of the transition probabilities for
granted, once the order of the MC is determined. Although the esti-
mation of the transition probabilities of the MC model of a long
sequence has been studied by Anderson and Goodman (1957) and
Baum and Petrie (1966), it would be interesting to extend these
methods to NGS data.

Acknowledgements

The authors thank anonymous referees for helpful comments on this work
and on previous related work. We thank Dr Xiaohui Xie from UCI for ex-
planation of the 28 vertebrate species.

Funding

The research is supported by the National Natural Science Foundation of
China (Nos. 31171262, 31428012, 31471246), and the National Key Basic
Research Project of China (No. 2015CB910303). F.S. is partially supported
by US National Institutes of Health (P50 HG 002790) and NSF (DMS
1518001) and (OCE-1136818). G.R. acknowledges support from EPSRC
grant EP/K032402/1.

Conﬂict of Interest: none declared.

References

Almagor,H. (1983) A Markov analysis of DNA sequences. ]. Theor. Biol.,
104, 633—645.

Anderson,T.W. and Goodman,L.A. (195 7) Statistical inference about Markov
chains. Ann. Math. Stat., 28, 89—110.

Arnold,]. et al. (1988) Mono-through hexanucleotide composition of the sense
strand of yeast DNA: a Markov chain analysis. Nucleic Acids Res., 16,
7145—7158.

Avery,P.]. (1987) The analysis of intron data and their use in the detection of
short signals. ]. Mol. Evol., 26, 335—340.

Avery,P.]. and Henderson,D.A. (1999) Fitting Markov chain models to dis-
crete state series such as DNA sequences. ]. R. Stat. Soc. Ser. C Appl. Stat.,
48, 5 3—6 1.

Baum,L.E. and Petrie,T. (1966) Statistical inference for probabilistic functions
of ﬁnite state Markov chains. Ann. Math. Stat., 37, 1554—1563.

Behnam,E. and Smith,A.D. (2014) The amordad database engine for metage-
nomics. Bioinformatics, 30, 2949—295 5 .

Behnam,E., et al. (2013) A geometric interpretation for local alignment-free
sequence comparison. ]. Comput. Biol., 20, 471—485.

Benjamini,Y. and Speed,T. (2012) Summarizing and correcting the gc content
bias in high-throughput sequencing. Nucleic Acids Res., 40, e72.

Besag,]. and Mondal,D. (2013) Exact goodness-of—ﬁt tests for Markov chains.
Biometrics, 69, 488—496.

Billingsley,P. (1961a) Statistical Inference for Markov Processes. Vol. 2.
University of Chicago Press, Chicago.

Billingsley,P. (1961b) Statistical methods in Markov chains. Ann. Math. Stat.,
32,12—40.

Blaisdell,B.E. (1985) Markov chain analysis ﬁnds a signiﬁcant inﬂuence of
neighboring bases on the occurrence of a base in eucaryotic nuclear DNA
sequences both protein-coding and noncoding. ]. Mol. Evol., 21, 278—28 8.

Blow,M.J. et al. (2010) Chip-seq identiﬁcation of weakly conserved heart
enhancers. Nat. Genet., 42, 806—810.

Cannon,C.H. et al. (2010) Assembly free comparative genomics of short-
read sequence data discovers the needles in the haystack. Mol. Ecol.,
19(Suppl. 1), 146—160.

Daley,T. and Smith,A.D. (2013) Predicting the molecular complexity of
sequencing libraries. Nat. Methods, 10, 325—327.

Ewens,W.]. and Grant,G.R. (2005 ) Statistical Methods in Bioinformatics: An
Introduction, 2nd edn. Springer, New York.

G6ke,]. et al. (2012) Estimation of pairwise sequence similarity of mam-
malian enhancers with word neighbourhood counts. Bioinformatics,
28, 65 6—663.

Hoel,P.G. (1954) A test for Markov chains. Biometrika, 41, 430—433.

Hong,]. (1990) Prediction of oligonucleotide frequencies based upon dinucleo-
tide frequencies obtained from the nearest neighbor analysis. Nucleic Acids
Res., 18, 1625—1628.

Hurwitz,B.L. et al. (2014) Modeling ecological drivers in marine viral com-
munities using comparative metagenomics and network analyses. Proc.
Natl Acad. Sci. USA, 111, 10714—10719.

Jiang,B. et al. (2012) Comparison of metagenomic samples using sequence sig-
natures. BMC Genomics, 13, 730.

Karolchik,D. et al. (2008) The UCSC genome browser database: 2008 update.
Nucleic Acids Res., 36(Suppl. 1), D773—D779.

Lander,E.S. and Waterman,M.S. (1988) Genomic mapping by ﬁngerprinting
random clones: a mathematical analysis. Genomics, 2, 231—239.

Liu,X. et al. (2011) New powerful statistics for alignment-free sequence com-
parison under a pattern transfer model. ]. Theor. Biol., 284, 106—116.

Miller,W. et al. (2007) 28-way vertebrate alignment and conservation track in
the UCSC genome browser. Genome Res., 17, 1797—1808.

Narlikar,L. et al. (2013) One size does not ﬁt all: On how Markov model order
dictates performance of genomic sequence analyses. Nucleic Acids Res., 41,
1416—1424.

Pevzner,P.A. et al. (1989) Linguistics of nucleotide sequences 1: the sig-
niﬁcance of deviations from mean statistical characteristics and prediction
of the frequencies of occurrence of words. ]. Biomol. Struct. Dynam., 6,
1013—1026.

Reinert,G. et al. (2000) Probabilistic and statistical properties of words: an
overview. ]. Comput. Biol., 7, 1—46.

Reinert,G. et al. (2005 ) Statistics on words with applications to biological
sequences. In: Berstel,]. and Perrin,D. (eds), Lothaire: Applied Combinatorics
on Words. Vol. 105, Cambridge University Press, UK, pp. 268—352.

Reinert,G. et al. (2009) Alignment-free sequence comparison (1): Statistics and
power. ]. Comput. Biol., 16, 1615—1634.

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 10 A11819Atur1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q u1011 pepeolumoq

1000

J.Ren et al.

 

Ren,]. et al. (2013) Multiple alignment-free sequence comparison.
Bioinformatics, 29, 2690—2698.

Richter,D. et al. (2008) MetaSim: a sequencing simulator for genomics and
metagenomics. PLoS One, 3, e3373.

Simpson,].T. (2014) Exploring genome characteristics and sequence quality
without a reference. Bioinformatics, 30, 1228—1235.

Song,K. et al. (2013) Alignment-free sequence comparison based on next-
generation sequencing reads. ]. Comput. Biol., 20, 64—79.

Song,K. et al. (2014) New developments of alignment-free sequence compari-
son: measures, statistics and next-generation sequencing. Brief.
Bioinformatics, 15, 343—35 3.

Wang,Y. et al. (2014) Comparison of metatranscriptomic samples based on
k-tuple frequencies. PLoS One, 9, e84348.

Waterman,M.S. (1995) Introduction to Computational Biology: Maps,
Sequences and Genomes. Chapman 6’ Hall/CRC Interdisciplinary
Statistics. Taylor SC Francis, Boca Raton.

Yi,H. and Jin,L. (2013) Co-phylog: an assembly-free phylogenomic approach
for closely related organisms. Nucleic Acids Res., 41, e75.

Zhai,Z. et al. (2012) Normal and compound poisson approximations for pat-
tern occurrences in ngs reads. ]. Comput. Biol., 19, 839—854.

Zhang,Z.D. et al. (2008) Modeling chip sequencing in silico with applications.
PLoS Comput. Biol., 4, e1000158.

9mg ‘09 1sn8nV uo sejeﬁuV socl ‘121u10111123 10 A11819Atur1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q u1011 pepeolumoq

