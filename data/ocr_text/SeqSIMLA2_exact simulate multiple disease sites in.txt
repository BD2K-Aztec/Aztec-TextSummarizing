Bioinformatics, 32(4), 2016, 557—562

doi: 10.1093/bioinformatics/btv626

Advance Access Publication Date: 29 October 2015
Original Paper

 

 

Genetics and population analysis

SeqSlMLA2_exact: simulate multiple disease
sites in large pedigrees with given disease
status for diseases with low prevalence

Po-Ju Yao and Ren-Hua Chung*

Division of Biostatistics and Bioinformatics, Institute of Population Health Sciences, National Health Research

Institutes, Zhunan, Miaoli County, Taiwan

*To whom correspondence should be addressed.
Associate Editor: Janet Kelso

Received on April 17, 2015; revised on September 8, 2015; accepted on October 22, 2015

Abstract

Summary: It is difficult for current simulation tools to simulate sequence data in a pre-specified
pedigree structure and pre-specified affection status. Previously, we developed a flexible tool,
SeqSIMLA2, for simulating sequence data in either unrelated case-control or family samples with
different disease and quantitative trait models. Here we extended the tool to efficiently simulate
sequences with multiple disease sites in large pedigrees with a given disease status for each
pedigree member, assuming that the disease prevalence is low.

Availability and implementation: SeqSlMLA2_exact is implemented with C++ and is available at

http://seqsimla.sourceforge.net.
Contact: rchung@nhri.org.tw

 

1 Introduction

Family studies based on next-generation sequencing (NGS) have
become important in complex disease studies because a sufficient
number of rare alleles that co-segregate with the disease can be
observed in pedigrees (Wijsman, 2012). To evaluate the statistical
power for family-based disease studies using NGS, it is necessary to
simulate sequencing data in a given family structure with disease
status. Moreover, as multiple variants can contribute to the disease,
it is crucial to simulate the joint effects of multiple variants on the
disease.

We searched the Genetic Simulation Resources website (Peng
et al., 2013), which provides a comprehensive catalog of simulation
tools for genetics studies, and identified four tools, ForSIM
(Lambert et al., 2008), Nemo (Guillaume and Rougemont, 2006),
simuPOP (Peng and Amos, 2008) and SeqSIMLA2 (Chung et al.,
2015), that can simulate sequence data in families with affection
status. ForSIM, Nemo and simuPOP use forward-time algorithms,
which dynamically determine pedigree structures during the simula-
tion. Therefore, it may not be easy to obtain pre-specified pedigree
structures from the simulation results. SeqSIMLA2 uses a gene-
dropping algorithm to easily simulate pedigrees with pre-specified

structures. However, it is very time consuming for the gene-
dropping algorithm to simulate exactly the same affection status as
the pre-specified status for every family member, particularly in
large pedigrees and diseases with low prevalence. Another simula-
tion tool, SimRare (Li et al., 2012), which shares some properties
with SeqSIMLA2, can simulate multiple disease loci in sequence
data; however, SimRare only simulates unrelated case-control data.
In order to efficiently simulate genotypes conditional on the fam-
ily structure and disease status, a retrospective likelihood, which is
the probability of observing genotypes in each family member given
the disease status, needs to be calculated. However, calculating the
retrospective likelihood is typically based on computationally inten-
sive algorithms such as Elston—Stewart (Elston and Stewart, 1971)
and Markov Chain Monte Carlo (MCMC) algorithms. For example,
tools such as FastSLINK (Ott, 1989), SUP (Lemire, 2006),
SimWalk2 (Sobel and Lange, 1996) and MORGAN (Thompson,
2005) have implemented or extended one of the aforementioned
algorithms for simulating genotypes given the trait data. Due to the
computational complexity, these tools can simulate only one disease
locus. Moreover, although multiple markers not associated with the
disease locus can be simulated, SimWalk2 and MORGAN assume

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 557

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq wort pepeolumoq

558

P.-J.Yao and R.-H.Chung

 

that the markers are in linkage equilibrium, while FastSLINK and
SUP can simulate few markers that are in linkage disequilibrium
(LD). These tools may not be suitable to evaluate the joint effects
of multiple disease loci. Moreover, these tools are not suitable to
simulate NGS data, which involve millions of variants with complex
LD structures.

Here we extended SeqSIMLA2 to SeqSIMLA2_exact for simulat-
ing sequence data given the pedigree structures and disease status
for all family members. When the disease prevalence is low, we
show that the retrospective probability can be efficiently approxi-
mated without using computationally intensive algorithms.

2 Methods

For a pedigree with 11 members, assume x = (x1, ..., x”) is a vector of
disease phenotypes and h = (h1,...,hn)is a vector of haplotype pairs
at the disease loci for the 11 individuals. Assume c = (c1, ..., CS) is a
vector of recombination rates at s recombination hotspots within
the haplotype region. Family members without parents are referred
to as founders, while family members with parents in the pedigree
structure are referred to as non-founders. Assume hf is a subset of h
that contains haplotype pairs of founders and hnf is the complement
of hf containing haplotype pairs of non-founders. The probability of
h can be calculated as

P(hlx7 c) : P(hf7hnflx7 c) : P(hflx7 c)P(hnf|hf7x7 c) 

First we calculate P(hf|X, c). Assume (h1, . . 17,-4) is a subset of haplo-
types in hf that have been simulated. As shown in the Appendix A,
assuming no inbreeding and random mating, the probability for h,-
at founder i is calculated as

P(h- x- c)P(x- 1  x |c h1  (7- x1  

 h,_ = 1717 1+7 7717 7 717 7 71

( ll 17 7 z 17X,C) P(x,-,c)P(x,-+1,...,xn|c,h1,...,hi_1,x1,...,x,)
(2)

 

The denominator is the sum of the numerators over all possible
haplotypes of individual i. The probability P(h,—,x,~,c) is further
derived as P(x,- | In, c)P(h,-, c), which can be easily calculated based
on the penetrance functions and disease haplotype frequencies.
Calculating the probability P(x,~+1, ...,xn|c,h1, ...,h,,x1, ...,x,) in Eq.
(2) requires the consideration of affection status for family members
who have not been simulated, given the haplotypes and affection
status for family members who have been simulated. This process
can be time consuming for a large pedigree. To efficiently calculate
the probability, we only consider the affection status for family
members in the same nuclear family as individual i. It is also com-
monly assumed that given a person’s haplotypes, the person’s affec-
tion status is independent of any other person’s haplotypes (Laird
and Lange, 2011). Moreover, conditional on parental haplotypes,
siblings’ haplotypes are independent. Based on these assumptions,
the probability is written as

P(x,~+1, ...,xn|c,h1, ...,]7;,x1, ...,xi) = P(x,~+1, ...,xk|c,h1, ...,hi,x1, ...,xi)

k k
= 2 H p(x,|h,, c) H marlin, "-7171‘)

1'69 r=i+1 r=i+1

(3)

where individuals 2' + 1 through k are in the same nuclear family as
individual i, and Q is a set of all possible haplotypes of individuals
2' + 1 through k given the haplotypes for family members that have
been simulated. Note that we assume that the haplotypes and

affection status for the family members who have been simulated
(i.e. individuals 1 to i) are independent of the affection status of
other family members who are not in the same nuclear families as in-
dividuals 1 to 2'. Our simulation results in the Results section suggest
that this assumption holds for diseases with low prevalence.

Next we calculate P(hnf|hf,X, c)in Eq. (1). If h,- is the haplotype
pair at non-founder j and (hm, . . 17,-.1) is a subset of haplotypes in hnf
that have been simulated, the probability of haplotype pair I),- at
non-founder i can be calculated as

PUJilhf, hm, ..., hi_1,X, C)

i
= P(h,-|hp,hq, c)P(x,-+1, ...xn|hf,hm, ..., hi,x1, ...,xi, c)HP(x,|h,, c)/D
r=1
(4)

where (hp,hq) E hf are the parental haplotypes of h,- and D is the
sum of the numerators over all possible haplotype pairs of a child
whose parental haplotypes are(hp, hq). Detailed derivation of Eq. (4)
can be found in the Appendix A.

Based on Eqs. (2) and (4), we developed an efficient algorithm to
simulate disease haplotypes for large pedigrees:

1. Simulate hf based on Eq. (2).

2. Identify one of the top founders m and set one of m’s children
as k.

3. Simulate bk for k using Eq. (3).

4. 4.1. If k has a spouse, set k’s spouse as k and go to step 3.
4.2. If k has at least one sibling, set one of k’s siblings as k and
go to step 3. Repeat Step 4.2 until all siblings of k have been
simulated.
4.3. If k has at least one child, set one of k’s children as k and go
to step 3. Repeat Step 4.3 until all children of k have been
simulated.

After the disease haplotypes have been simulated for all members,
the sequences for the members can also be efficiently simulated using
the original SeqSIMLA algorithm (Chung and Shih, 2013). To be
more specific, SeqSIMLA requires a population of sequences (i.e.
haplotypes) in an external file. As previously described in (Chung and
Shih, 2013), these sequences can be generated by several simulation
tools such as HAPGEN2 (Su et al., 2011) and COSI (Schaffner et al.,
2005). In general, a population of 10000 sequences is required for
SeqSIMLA. Each sequence then has an index, which ranges from 1 to
10000. After reading the external sequences, SeqSIMLA extracts
the haplotypes at the disease sites selected by the user. The haplotype
frequencies and haplotype pair frequencies are calculated based on
the external sequences. When a haplotype pair I),- in founder i is deter-
mined based on Eq. (2), two haplotypes in the external haplotypes
which are consistent with h,- are randomly selected. The indices for
the two randomly selected haplotypes are assigned to individual
2'. When a haplotype pair I),- in non-founder j is determined based on
Eq. (4), the inheritance vectors, including the crossover events, are
assigned to individual 7'. Finally, after all members in a pedigree have
been simulated, their sequences can subsequently be simulated rapidly
based on the founders’ sequence indices, non-founders’ inheritance
vectors and the external sequences.

We used simulation studies to evaluate the performance of the
algorithm. Different simulation scenarios with parameters of minor
allele frequencies (MAFs) and odds ratios for the disease sites,
disease prevalence and family structures were used. We selected
three common variants with MAFs of 0.03, 0.05 and 0.13 as the
disease sites. We also selected three rare variants with MAFs of

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq wort pepeolumoq

Simulating exact disease status in large pedigrees

559

 

$0,154

 %de¢ﬂ_ggiiéigbbo¥ééfgﬁﬂ

Fig. 1. Three types of pedigree structures, representing small, medium and

 

 

large pedigrees, used in the simulations

0.005, 0.007 and 0.009 as another set of disease sites. A penetrance
model was used based on the following logistic penetrance function
in SeqSIMLA2:

logit(P(affected)) = [$0 + 1 ﬁx), where [70 is determined by
the disease prevalence, and [7,- and x,- are the log odds ratio and geno-
type coding, respectively, for disease site i in the u disease sites. We
specified the odds ratios of 1, 2 and 3 for the three common variants
and higher odds ratios of 1, 5 and 8 for the three rare variants with
different disease prevalences (i.e. 0.5%, 1%, 3%, 5% and 10%).
Three types of family structures, shown in Figure 1, representing
small, medium and large pedigrees were used.

We evaluated the performance of SeqSIMLA2_exact based on
whether the 95% confidence intervals for the estimated odds ratios
for the disease sites in a simulated replicate contained the true par-
ameters specified. UNPHASED (Dudbridge, 2008) was used to esti-
mate the odds ratios and their 95% confidence intervals for each of
the simulated replicates. For each replicate, 10000 families were
simulated unless otherwise specified. Fewer pedigrees were simu-
lated for some scenarios when analyzing 10 000 pedigrees in
UNPHASED was prohibitively time-consuming. A retrospective
likelihood, which was the probability of observing the genotypes in
parents and their children given the affection status for the children
in each nuclear family, was derived in UNPHASED. The effect sizes
for the disease sites were obtained from the maximum likelihood es-
timates based on the likelihood function. A large pedigree is split
into independent nuclear families for the inference of likelihood in
UNPHASED. When multiple disease sites were simulated in our
simulation studies, UNPHASED was used to estimate the odds
ratios of haplotypes at the disease sites. The odds ratio for a disease
site was obtained from the odds ratio for the haplotype with the dis-
ease allele at the disease site, while alleles at other disease sites were
the non-disease alleles in the haplotype.

3 Results

Table 1 shows the estimates of odds ratios for the three common
variants with different prevalences for the medium pedigree struc-
ture. The 95% confidence intervals generally included the true odds
ratios when the disease prevalence was less than 5% or when the
specified odds ratio was 1, but the estimates of odds ratios can be
smaller than the true values when the disease prevalence was above
5% and the true values were not 1 (i.e. values marked in bold in
Table 1). This reﬂects the fact that the approximation of Eq. (3)
within nuclear families may not be correct when the disease preva-
lence is high. Table 2 shows the estimates of odds ratios for the three
common variants with different pedigree structures when the preva-
lence is 1%. All the 95% confidence intervals included the true odds

Table 1. Estimated odds ratios for the three common variants with
different prevalences

 

 

 

Prevalence
Odds ratio 0.5% 1% 3% 5% 10%
MAF=0.13
1a 0.99b 1.00 1.01 1.02 1.00
(0.97,1.01)C (0.98,1.03) (0.98,1.03) (0.99,1.04) (0.96,1.03)
2 2.04 2.00 1.98 1.92 1.82
(1.98,2.09) (1.95,2.05) (1.92,2.03) (1.88,1.97) (1.76,1.89)
3 3.05 3.03 2.84 2.79 2.51

(2.94,3.16) (2.93,3.14) (2.75,2.94) (2.70,2.88) (2.40,2.62)
MAF = 0.05

1 1.00 0.98 0.99 0.97 1.01
(0.97,1.04) (0.95,1.02) (0.96,1.03) (0.94,1.01) (0.96,1.05)
2 2.00 2.01 1.98 1.92 1.82
(1.92,2.07) (1.94,2.09) (1.91,2.05) (1.85,1.99) (1.76,1.89)
3 3.01 3.04 2.93 2.75 2.51

(2.87,3.15) (291,319) (280,306) (2.63,2.88) (2.40,2.62)
MAF=0.03

1 1.00 1.00 1.03 1.01 1.01
(0.96,1.05) (0.95,1.04) (0.98,1.07) (0.96,1.06) (0.96,1.05)
2 1.97 1.95 1.94 1.97 1.82
(1.88, 2.07) (1.85,2.04) (1.85,2.04) (1.88,2.08) (1.73,1.91)
3 3.20 3.08 3.00 2.94 2.49

(2.99,3.42) (289,328) (282,319) (2.76,3.13) (2.35,2.63)

 

aThe speciﬁed odds ratio.
bThe estimated odds ratio.
CThe 95% conﬁdence interval.

Table 2. Estimated odds ratios for the three common variants
based on the prevalence of 0.01 for different pedigree structures

 

Pedigree size

 

 

Odds ratio Small Medium Large
MAF = 0.13
1a 0.98b 0.99 0.9801
(0.92,1.04)C (097,100) (092,105)
2 1.93 1.98 1.90
(182,206) (192,204) (1.77,2.05)
3 2.97 3.00 3.06
(277,318) (288,314) (279,334)
MAF = 0.05
1 0.97 1.02 0.96
(088,106) (098,105) (088,105)
2 1.87 2.05 2.14
(1.70,2.05) (195,214) (191,234)
3 3.12 3.05 3.01
(281,346) (286,325) (262,346)
MAF = 0.03
1 0.99 0.96 1.06
(088,111) (091,100) (093,120)
2 2.15 1.96 2.11
(189,244) (185,208) (181,247)
3 3.15 2.99 3.34
(274,361) (275,324) (277,403)

 

alThe speciﬁed odds ratio.
bThe estimated odds ratio.
CThe 95% conﬁdence interval.
dThe estimates for large pedigrees were based on 500 pedigrees.

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘etulomeg JO KitSJeAtu [1 112 /810'S{12umo[pJOJXO'sopeuuogutotq/ﬁdnq wort pepeolumoq

560

P.-J.Yao and R.-H.Chung

 

ratios with different pedigree structures, suggesting that pedigree
size does not bias the estimates. Table 3 shows the estimates of odds
ratios for the three rare variants with the medium pedigree structure
at the disease prevalence of 1%. Again, the 95 % confidence inter-
vals all included the true values. We also selected a mixture of five
rare and common variants with disease prevalence of 1 %, and found
that with the exception of one case (values marked in bold), the
95 % confidence intervals included the true values (Table 4).

Table 5 shows the run time of SeqSIMLA2_exact when simulat-
ing different numbers of disease sites in 2223 variants in 100 pedi-
grees with different structures, where s (i.e. the number of
recombination hotspots within the haplotype region for disease
sites) was fixed at 2. The run time was evaluated on a Linux server
with Xeon 2.0 GHz CPUs and 96 GB of memory. The results
showed that simulating 5 disease sites in 100 small or medium pedi-
grees can be completed in 15 8. Moreover, simulating a challenging
scenario of 6900 individuals in 100 large pedigrees with exactly the
same disease status for each individual as specified can be completed
in 14 minutes. However, increasing the number of disease sites sig-
nificantly increased the run time. Figure 2 shows the run time of
SeqSIMLA2_exact when simulating 10 disease sites in 2223 variants
in 100 medium pedigrees with different values of 5. Similar to the
number of disease sites, increasing 5 also significantly increased the
run time.

4 Discussion

An efficient algorithm to simulate sequence data given the family
structure and affection status for every family member was
developed and implemented. Our simulation results suggested that
the tool properly simulated multiple disease variants with the
desired odds ratios when the disease prevalence was less than
5%, which is the case for many complex diseases, such as
schizophrenia, autism and age-related macular degeneration that
have prevalences of 1.1 %, 1.4% and 1.5% in Caucasians,
respectively.

As shown in Table 5 and Figure 2, the run time for SeqSIMLA2_
exact increased exponentially with either the number of disease loci
or the number of recombination hotspots. This can be attributed to
calculating the probabilities in Eqs. (3) and (4), which requires enu-
meration of all possible haplotypes for individuals who have not
been simulated under all possible recombination patterns, and the
number of possible haplotypes and the number of recombination
patterns increase exponentially with the number of disease sites and
recombination hotspots, respectively. However, these calculations
are only required in the first batch of the simulations. The results
can subsequently be saved in memory and used in the following
batches of simulations.

In our simulations, a logistic penetrance function was used to
simulate multiple independent disease loci with additive effects on
the disease. However, different disease models can also be simulated
using SeqSIMLA2_exact. A penetrance table with penetrance func-
tions for all possible combinations of genotypes at the disease sites
can be provided to SeqSIMLA2_exact. These penetrance functions
can be specified based on any type of disease model, including the
incorporation of interacting loci. Moreover, different directions of
effects of the disease loci can be simulated using the logistic pene-
trance function or the penetrance table. For example, specifying
positive and negative values for the log odds ratios in the logistic
penetrance function can simulate the risk and protective effects of
the disease loci, respectively.

Table 3. Estimated odds ratios for the three rare variants based on
the prevalence of 0.01

 

 

 

MAF
Odds ratio 0.005 0.007 0.01
1a 1.02b 1.03 1.00
(0.94,1.12)C (094,112) (094,107)
5 4.75 4.88 5.01
(440,513) (453,526) (469,534)
8 8.07 8.07 7.96
(729,894) (732,890) (728,871)

 

alThe speciﬁed odds ratio.
bThe estimated odds ratio.
CThe 95% conﬁdence interval.

Table 4. Estimated odds ratios for a mixture of common and rare
variants based on the prevalence of 0.01 using 1000 medium
pedigrees

 

 

 

MAF
Odds 0.374 0.286 0.056 0.020 0.011
ratio
1a 0.98b 1.03 1.01 0.77 1.23
(0.91,1.05)C (0.95,1.10) (0.85,1.19) (0.55,1.07) (093,163)
3 3.19 3.31 4.64 3.26 2.66
(2.57,3.97) (2.66,4.11) (3.28,6.55) (2.15,4.95) (1.46,4.84)
5 4.08 4.14 4.38 5.83 3.05

(3.01,5.52) (3.09,5.56) (3.11,6.17) (2.74,12.4) (1.37,6.82)

 

alThe speciﬁed odds ratio.
bThe estimated odds ratio.
CThe 95% conﬁdence interval.

Table 5. Run time for simulating different numbers of disease sites
in 100 pedigrees with different structures

 

 

 

 

 

Run time
Number of disease sites Small Medium Large
1 10 s 9 s 32 s
5 12 s 15 s 13 m 38 s
10 26s 1m57s 6h57m308
20 5m22s 21m8s 58h54m17s
5, second; m, minute; h, hour.
Run time IIiiIlL'II diff-nut I'ILI'I'IIIII‘I- aim
5m
4m
41m
15m
am
E 15m
2m
1m
nun
am
ma
1 3 4 5 a 7 a s

mumwm

Fig. 2. Run time for simulating 100 medium pedigrees and 10 disease sites
with different recombination hotspots

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘etulomeg JO KitSJeAtu [1 112 /810'S{12umo[pJOJXO'sopeuuogutotq/ﬁdnq wort pepeolumoq

Simulating exact disease status in large pedigrees

561

 

At present, SeqSIMLA2_exact assumes that the affection statuses
for all family members are given. To account for missing pheno-
types, the probability in Eq. (1) can be extended to P(h,xu|x,c),
where xu is a vector of the affection statuses of individuals whose af-
fection statuses were not given. We hope to implement this function
in SeqSIMLA2_exact in the near future.

In conclusion, SeqSIMLA2_exact will be useful to simulate se-
quence data with multiple disease sites in large pedigrees when the
disease prevalence is low. SeqSIMLA2_exact is implemented in
SeqSIMLA2 with the -exact option, which is available from http://
seqsimla.sourceforge.net.

Funding

This study was supported by grants from the National Health Research
Institutes (PH-104-PP-10) and National Science Council (NSC 102-2221-E-
400-001-MY2) in Taiwan.

Conﬂict of Interest: none declared.

References

Chung,R.H. and Shih,C.C. (2013) SeqSIMLA: a sequence and phenotype simu-
lation tool for complex disease studies. BMC Bioinformatics, 14, 199.

Chung,R.H., et al. (2015 ) SeqSIMLA2: simulating correlated quantitative
traits accounting for shared environmental effects in user-speciﬁed pedigree
structure. Genet. Epidemiol, 39, 20—24.

Dudbridge,F. (2008) Likelihood-based association analysis for nuclear
families and unrelated subjects with missing genotype data. Hum. Hered., 66,
87—98.

Elston,R.C. and Stewart,]. (1971) A general model for the genetic analysis of
pedigree data. Hum. Hered., 21, 523—542.

Appendix A

A1. For simulating haplotypes in founders
We calculate the probability of a haplotype pair I),- at founder i given
the known information:
12091, ...,/9,51, c)
P091, ..., lai_1,x, C)

_ P(hi7xi7c)P(h17"vhf—179617"'7xi—llhi7xi7c)P(xi-I-17"'7xnlc7h17"'7hi7x17"-7xi)
P(x,-,c)P(la1,...,/914,271,...,x,_1|xi,c)P(xi+1,...,xn|c,la1,...,hi_1,x1,...,x,)

POM/717 "vhf—17x70) =

 

(A1)

Assume no inbreeding and random mating so that all founder haplo-
types are independent. Therefore, I),- is independent with h1,ll_,h,~_1.
Also assume that given a person n’s haplotypes I)“, the person’s
affection status x“ is independent with any other persons’ haplotypes
such as h,- (Laird and Lange, 2011). Then the second term of the

numerator in Eq. (A1) can be written as
13071, ...,h,-_1,x1,...,x,_1|hi,xi,c)
= 130717 ---7hi—1|hi7xi7 C)P(x17 ---7xi—1|h17 ---7hi—17hi7xi7c) (A2)
= 13071, ...,h,-_1|x,-, c)P(x1, ...,x,-_1|l71, ...,h,-_1,x,-, C)
= 13071, ...,h,-_1,x1, ...,x,-_1|x,-, C)

Given (A1) and (A2):

 

P(l7,- x,- c)P(x,—+1  xn|c l71  l7,- x1  xi)

P  h ...  = 7 7 7 7 7 7 7 7 7 7
(1| 1’ ’ z l’x’c) P(x,-,c)P(x,-+1,...,xn|c,h1,...,h,_1,x1,...,x,)
(A3)

Equation (A3) is Eq. (2) in the manuscript.

Guillaume,F. and Rougemont,]. (2006) Nemo: an evolutionary and
population genetics programming framework. Bioinformatics, 22,
2556—2557.

Laird,N.M. and Lange,C. (2011) The Fundamentals of Modern Statistical
Genetics. New York: Springer.

Lambert,B.W. et al. (2008) ForSim: a tool for exploring the genetic
architecture of complex traits with controlled truth. Bioinformatics, 24,
1821—1822.

Lemire,M. (2006) SUP: an extension to SLINK to allow a larger number of
marker loci to be simulated in pedigrees conditional on trait values. BMC
Genet., 7, 40.

Li,B. et al. (2012) SimRare: a program to generate and analyze sequence-based
data for association studies of quantitative and qualitative traits.
Bioinformatics, 28, 2703—2704.

Ott,]. (1989) Computer-simulation methods in human linkage analysis. Proc.
Natl. Acad. Sci. USA, 86, 4175—4178.

Peng,B. and Amos,C.I. (2008) Forward-time simulations of non-random
mating populations using simuPOP. Bioinformatics, 24, 1408—1409.

Peng,B. et al. (2013) Genetic Simulation Resources: a website for the
registration and discovery of genetic data simulators. Bioinformatics, 29,
1101—1102.

Schaffner,S.F. et al. (2005) Calibrating a coalescent simulation of human
genome sequence variation. Genome Res., 15, 15 76—1583.

Sobel,E. and Lange,K. (1996) Descent graphs in pedigree analysis: applica-
tions to haplotyping, location scores, and marker-sharing statistics. Am. ].
Hum. Genet., 58, 1323—1337.

Su,Z. et al. (2011) HAPGEN2: simulation of multiple disease SNPs.
Bioinformatics, 27, 2304—2305.

Thompson,E.A. (2005 ) MCMC in the analysis of genetic data on pedigrees.
Singapore: World Scientiﬁc Co Pte Ltd.

Wijsman,E.M. (2012) The role of large pedigrees in an era of high-throughput
sequencing. Hum. Genet., 131, 1555—1563.

A2. For simulating haplotypes in non-founders

 

P h 7hm7'"7h"x’c
p(h,-Ihf,hm,...,hi—1,X1°>= misfit.  (2)—[1 X1)

 

_ 1201,77,”, ...,hi,c)P(x|hf,hm, ...,h,,c) (A4)
_ ZP<hf,hm, ...,hl-_1,l7k,x, C)
1291’

where ‘I’ is a set of all possible haplotype pairs of a
child whose parental haplotypes are the same as hj’s parental
haplotypes.

For the ﬁrst part of the numerator in Eq. (A4), conditional
on individual [’8 parental haplotypes (i.e. hp and hq),
individual i’s haplotypes are independent from other members’
haplotypes. Because (hp,hq) E hf, the part of equation can be
written as

P(hf, hm, ..., h), C) = P(bi|hf, hm, ..., hi_1, C)P(hf, hm, ..., hi_1, C)
= P(l7,-|l7p,l7q,c)P(hf,l7m, ...,b,_1,c)
(A5)

For the second part of the numerator in Eq. (A4):

P(X|hf, hm, ..., hi, c)
= P(x1 (hf, hm, ..., hi, c)P(x2|hf, hm, ..., £7,361, 
P(x,-|hf, hm, ..., hi,x1, ...,xl-_1, c)P(x,-+1, ...xn|hf, hm, ..., hi, x1, ..., xi, c)

(A6)

Again using the assumption that given a person n’s haplotypes h“,
the person’s affection status x“ is independent with any other

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'801112u1101u101q/ﬁd11q 111011 pepeolumoq

562

P.-J.Yao and R.-H.Chung

 

persons’ haplotypes such as h,- (Laird and Lange, 2011), each term in
Eq. (A6) except the last term can be written as

P(x]-|hf, hm, ..., 1?), x1, ..., xj_1, C)
i
P(x,|h,,c)
= P(x1, ...,xj|h1, ...,hj,c)P(h1, ...,hj,c) ,21

P(x1, ...,xj_1|h1, ...,]?j, C)P(h1, ...,]?j, C) = i—1 = P(xl|hl? 0)
HP(x,|h,,c)
r=1

 

Then Eq. (A6) can be written as
P(x|hf,hm, ...,hi, c)

l (A7)

= HP(x,|h,,c)P(x,—+1,...xn|hf,hm,...,hi,x1,...,xi,c)

r=1

Based on Eqs. (A5) and (A7), Eq. (A4) can be written as
P(hjlhf, hm, ..., hj_1, X, C)

i
P(h,~|hp, hq, c)P(x,-+1, ...xn|hf, hm, ..., hi,x1, ...,xi, c)HP(xr|h,, c)
r=1

 

k
E (Pal/elk!” hq, c)P(x,-+1, ...xn|hf, hm, ..., hj_1,hk, x1, ...,xj, c)HP(x,|h,, C))
r=1

ke‘I’

which is Eq. (4) in the manuscript. The probabilities
P(x,-+1,...xn|hf,hm,...,hi,x1,...,xi,c)can be efﬁciently calculated in
the same manner as the calculation in Eq. (3).

91m ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'801112u1101u101q/ﬁd11q 111011 pepeolumoq

