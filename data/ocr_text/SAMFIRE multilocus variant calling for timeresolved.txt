Bioinformatics, 32(14), 2016, 2208—2209

doi: 10.1093/bioinformatics/btw205

Advance Access Publication Date: 22 April 2016
Applications Note

 

 

Sequence analysis

SAMFIRE: multi-locus variant calling for

time-resolved sequence data

C. J. R. lllingworth

Department of Genetics, University of Cambridge, Cambridge CBZ 3AS, UK

Associate Editor: Alfonso Valencia

Received on December 14, 2015; revised on March 25, 2016; accepted on April 10, 2016

Abstract

Summary: An increasingly common method for studying evolution is the collection of time-
resolved short-read sequence data. Such datasets allow for the direct observation of rapid
evolutionary processes, as might occur in natural microbial populations and in evolutionary experi-
ments. In many circumstances, evolutionary pressure acting upon single variants can cause gen-
omic changes at multiple nearby loci. SAMFIRE is an open-access software package for processing
and analyzing sequence reads from time-resolved data, calling important single- and multi-Iocus
variants over time, identifying alleles potentially affected by selection, calculating linkage disequi-
librium statistics, performing haplotype reconstruction and exploiting time-resolved information to

estimate the extent of uncertainty in reported genomic data.

Availability and Implementation: C ++ code may be found at https://github.com/cjri/samfire/.

Contact: chris.ilIingworth@gen.cam.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

Introduction

Time-resolved genome sequence data provides direct information
about evolutionary processes. At low recombination rates, popula-
tions evolve via clonal competition, whereby linkage effects span-
ning multiple loci determine the outcome of adaptation (Neher and
Shraiman, 2009). The Samfire software extracts and processes
multi-locus information from time-resolved genomic data, so as to
shed light on underlying patterns of evolution.

Samfire includes a sequence processing pipeline filter that per-
forms quality control on short read data in aligned SAM format.
Similar to a previous approach to variant calling (Watson et al.,
2013), individual reads are filtered by median base quality, trim-
ming sequence in order to achieve this, subject to a minimum read
length. Individual nucleotides that fall below a given quality thresh-
old are then removed, being replaced by blank ‘-’ alleles, to indicate
a lack of available information. Duplicate reads may be removed,
before paired-end reads are joined, any interval between paired
reads being spanned by blank alleles. The pipeline sl_traj then calls
single-locus polymorphisms, filtering by the minimum number of re-
ported variant alleles, minimum observed allele frequency and a
statistical measure, assessing the probability of a polymorphism aris-
ing through sequencing error. Noting that across time, variants can

arise or die out in a population through mutation and selection,
observed allele counts are reported for polymorphic loci across all
time-points, even if a polymorphism is found only in a single sample;
we refer to these collected observations as the trajectory of an allele.
Alternatively, observation in multiple samples may be specified as a
condition for calling a polymorphism.

Having identified polymorphisms, the pipeline sl_noise utilizes
the temporal resolution of the data to estimate the extent of noise in-
herent in the variant frequencies. Excluding trajectories in which an
exceptional amount of allele frequency change is observed, changes
in allele frequencies in other trajectories are assumed, conserva-
tively, to arise from noise alone. Under this assumption, a Dirichlet
multinomial distribution is characterized, obtaining the optimal ex-
tent of variance required to account for the observed deviations of
each trajectory from constancy. While approximate Bayesian meth-
ods may be used to characterize evolutionary behaviour without
such fitting (Foll et al., 2014), estimation of a likelihood function
allows for techniques such as model selection to be used in discrimi-
nating between potential evolutionary scenarios.

In an optional step within the code, the pipeline sl_neutrality
allows the identification of trajectories exhibiting potentially non-
neutral evolutionary behaviour, using a simple model of allele fre-
quency change to identify trajectories potentially under constant or

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2208

9mg ‘09 isnﬁnv uo sejeﬁuV soq ‘eiulomeg JO AHSJQAHI [1 112 [3.10811211an[plOJXO'SODBIILIOJIIlOIQ/ﬂ(11111 wort pepeolumoq

SAMFIRE

2209

 

I Day 0 I Day 175
I Day 49 I Day 266
D Day 84 I Day 357
I Day 119 I Day 420

tom-mos

38 29
O C
I I
I I
I I
I I
I I
I I
I I
6 6
42 30
17 41

 
 

Multi-locus haplotypes

1. AAAATACATTGAAG 10. AAAATACATTGGAA 19. AGAATACACCGAAG 28. AGAATGCAAAGAAG 37. AGCCTACAAAGGAA
2. GAAATACATTGAAG 11, GAAATACACCGAAG 20. AAAATACGTTAAAG 29. AGAATAAATTGGAG 38. AGCCTAAATTGGAG
3. AAAATACATTAAAG 12, GAAATACATTGGAA 21. AGAACACGTTGAAG 30. AGAATAAATTGGAA 39. AGCCTACAAAGGAG
4 . AAAATACATTGAAA 13 , AGAATACGTTAAAG 22 . GAAATAAATTGGAA 3 1 . AGAATGCATTAAAG 4 0 . AGGGTACAAAGGAA
5. AAAATACATTGGAG 14, AGAATACGTTGAAG 23. AGAATGCATTGGAG 32. AGAATACGTTAAAA 41. AGAATACAAAGGAA
6 . GAAATACATTGGAG 15 , AAAATACGTTGAAG 24 . AGAATACG‘I‘TGGAG 33 . GAAATAAATTGGAG 42 . AGCCTAAATTGGAA
7 . GAAATACATTAAAG 1 6 , AAAATACAAAAAAG 25 . AGAACACGTTAAAG 34 . AGGGTACGTTAAAA 4 3 . AGGGTACAAAGGAG
8. AGAATACATTGAAG 17. AGAATACAAAGGAG 26. GAAATACGTTAAAG 35. AGGGTACGTTAAAG 44. AGCCTACGTTAAAA
9. AAAATACACCGAAG 18. AGAATACAAAAAAG 27. AGAATACGTTGGAA 36. AGCCTACGTTAAAG 45. AGGGTACGTTGGAG

Fig. 1. Increasing genetic diversity of the V3 loop of HIV envelope protein observed via calling of time-resolved multi-Iocus haplotypes. Numbered pie charts
show the proportion of each haplotype observed from viral data collected from a single patient. The area of a segment in a single chart is proportional to the frac-
tion of sequences observed to have the given multi-Iocus haplotype at each time. Dotted lines connect multi-Iocus haplotypes that differ by a single mutation

(Color version of this figure is available at Bioinformatics online.)

time-dependent selection. Where multi-locus models of selection are
evaluated, the reduction of the model space to a smaller number of
loci can improve computational efficiency (Illingworth et al., 2014).

Having identified single-locus polymorphisms, the pipeline call_ml
identifies multi-allele variants spanning these loci. Sets of loci that
could be spanned by paired-end reads are efficiently found. Multi-
locus variants are filtered by the minimum number of observations of
a variant and variant frequency, then reported across all time-points.
Optionally within this pipeline, full haplotypes may be reconstructed
from the multi-locus reads via a rule-based procedure (see Supporting
Information). While other approaches to haplotype reconstruction
have used model selection to infer a minimum number of haplotypes
required to explain a dataset (Fischer et al., 2014; Topfer et al., 2013),
we here adopt a maximal approach, constructing a set of haplotypes
that are guaranteed to explain all of the filtered multi-locus sequence
observations without further error. The pipeline ml_noise infers the
extent of noise in the observed multi-locus sequence data, again opti-
mizing a Dirichlet multinomial likelihood function. Time-resolved
data has elsewhere been used to infer haplotype frequencies under a
dynamic model of adaptation (Illingworth, 2015). Given variants
spanning both multiple, and single loci, the pipeline ld_calc calculates
estimates of linkage disequilibrium between loci.

Figure 1 shows an example of data generated by applying
SAMFIRE to within-host data from time-resolved sampling of HIV in
a single patient (Gall et al., 2013), here showing the expansion of viral
diversity over time as expressed in one set of 14-locus partial haplo-
types. The code is highly flexible, allowing for multiple user choices in
evaluating data. With the increase in the collection of genomic data,

we hope that Samfire will be of value to researchers aiming to build a
greater understanding of rapid evolutionary processes.

Funding

CI was supported by a Sir Henry Dale Fellowship, jointly funded by the
Wellcome Trust and the Royal Society (Grant Number 101239/Z/13/Z).

Conﬂict of Interest: none declared.

References

Fischer,A. et al. (2014) High-deﬁnition reconstruction of clonal composition
in cancer. Cell Rep., 7, 1740—1752.

Foll,M. et al. (2014) Inﬂuenza virus drug resistance: a time-sampled popula-
tion genetics perspective. PLoS Genet., 10, e1004185.

Gall,A. et al. (2013) Restriction of V3 region sequence divergence in the HIV-
1 envelope gene during antiretroviral treatment in a cohort of recent sero-
converters. Retrovirology, 10, 8.

Illingworth,C.J.R. et al. (2014) identifying selection in the within-host evolution
of inﬂuenza using viral sequence data. PLoS Comp. Biol., 10, e100375 5.

Illingworth,C.].R. (2015) Fitness inference from short-read data: within-host evo-
lution of a reassortant H5N1 inﬂuenza virus. Mol. Biol. Evol, 11, 3012—3026.

Neher,R.A. and Shraiman,B.I. (2009) Competition between recombination
and epistasis can cause a transition from allele to genotype selection. Proc.
Natl. Acad. Sci. USA, 10, e1003755.

T6pfer,A. et al. (2013) Probabilistic inference of viral quasispecies subject to
recombination. ]. Comp. Biol., 20, 113—123.

Watson,S.J. et al. (2013) Viral population analysis and minority-variant detec-
tion using short read next-generation sequencing. Phil. Trans. Roy. Soc. B,
368, 20120205.

9mg ‘09 isnﬁnv uo sejeﬁuV soq ‘erulomeg JO AiISJQAIu [1 112 [3.10811211an[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 wort pepeolumoq

