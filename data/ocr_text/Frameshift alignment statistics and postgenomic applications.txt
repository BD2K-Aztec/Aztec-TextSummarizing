ORIGINAL PAPER

Vol. 30 no. 24 2014, pages 3575-3582
doi: 1 0. 1 093/bioinformatics/btu5 76

 

Sequence analysis

Advance Access publication August 28, 2014

Frameshift alignment: statistics and post-genomic applications

Sergey L. Sheetlin1’1,Yonil Park‘ ’1‘, Martin c. Frith2’*’1 and John L. Spouge”

1National Center for Biotechnology Information, National Library of Medicine, Bethesda, MD 20894, USA and
2Computational Biology Research Center, National Institute of Advanced Industrial Science and Technology, Tokyo 135—

0064,Japan

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: The alignment of DNA sequences to proteins, allowing for
frameshifts, is a classic method in sequence analysis. It can help iden-
tify pseudogenes (which accumulate mutations), analyze raw DNA and
RNA sequence data (which may have frameshift sequencing errors),
investigate ribosomal frameshifts, etc. Often, however, only ad hoc
approximations or simulations are available to provide the statistical
significance of a frameshift alignment score.

Results: We describe a method to estimate statistical significance of
frameshift alignments, similar to classic BLAST statistics. (BLAST pres-
ently does not permit its alignments to include frameshifts.) We also
illustrate the continuing usefulness of frameshift alignment with two
‘post-genomic’ applications: (i) when finding pseudogenes within the
human genome, frameshift alignments show that most anciently con-
served non-coding human elements are recent pseudogenes with con-
served ancestral genes; and (ii) when analyzing metagenomic DNA
reads from polluted soil, frameshift alignments show that most alignable
metagenomic reads contain frameshifts, suggesting that metagenomic
analysis needs to use frameshift alignment to derive accurate results.
Availability and implementation: The statistical calculation is avail-
able in FALP (http://www.ncbi.nIm.nih.gov/CBBresearch/Spouge/
htm|_ncbi/htmI/index/software.htm|), and giga-scale frameshift align-
ment is available in LAST (http://Iast.cbrc.jp/falp).

Contact: spouge@ncbi.n|m.nih.gov or martin@cbrc.jp
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 12, 2014; revised on July 24, 2014; accepted on
August 20, 2014

1 INTRODUCTION

Although the pairwise alignment of DNA and protein is a clas-
sical problem in bioinformatics (Guan and Uberbacher, 1996;
Pearson et al., 1997; Zhang et al., 1997), it presents new chal-
lenges as next-generation sequencing (NGS) of DNA supplants
Sanger sequencing. The per-base error of Sanger sequencing is as
low as 0.001% (Shendure and Ji, 2008), but NGS can produce
per-base errors of ~1—2% Wang et al., 2012). NGS can also
make frequent insertion and deletion errors, e. g. 454 sequencing
in HIV-1 produced occasional per-base insertion and deletion
error rates of almost 50% (Shao et al., 2013). More recent
sequencing methods such as PacBio also have high indel rates

 

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the ﬁrst three
authors should be regarded as Joint First Authors

(Carneiro et al., 2012). The insertion and deletion errors cause
frequent frameshifts when DNA is annotated by electronic trans-
lation and alignment to proteins. This article studies the statistics
of “frameshift alignment’, a pairwise alignment of translated
DNA and a protein, with particular attention to frameshift
errors. Frameshift alignment has been used for protein domain
classiﬁcation (Zhang and Sun, 2011), determining exact gene
start position (Baytaluk et al., 2002), discovering distant protein
homologies (Girdea et al., 2010), predicting exon—intron struc-
ture (Mironov et al., 2001) and so on.

Large post-genomic datasets require fast sequence comparison
tools. There are several tools that can compare DNA sequences
with proteins, including NCBI BLAST (Altschul et al., 1990),
USEARCH (Edgar, 2010), RapSearch (Zhao et al., 2012),
PAUDA (Huson and Xie, 2013) and GHOSTM (Suzuki et al.,
2012), but none of these consider frameshifts. The FASTA pack-
age has excellent support for frameshifts, but is not designed for
large searches such as whole (meta)genomes versus all known
proteins (Pearson et al., 1997; Zhang et al., 1997). LAST has
supported frameshift alignment since 2009, and is designed for
large searches (Kielbasa et al., 2011). We should also mention
HAXAT, which accurately aligns Roche 454 DNA sequences to
proteins allowing for frameshifts, but is not designed for large-
scale searches (Lysholm, 2012).

Some studies have focused on developing frameshift alignment
algorithms; few have focused on the accurate estimation of
E-values for frameshift alignment scores. In alignments without
frameshifts, errors in approximate E—values can usually be con-
trolled (Altschul et al., 2001; Bundschuh, 2002; Park et al., 2009);
with frameshifts, errors are rarely controlled. On one hand,
FASTX/Y calculates alignment P—values with z—scores (Pearson
et al., 1997). On the other hand, BLAST tools comparing trans-
lated DNA to protein do not consider frameshifts. Rather, they
consider six alignment reading frames, calculating their E-values
as though only one reading frame was explored (Gertz et al., 2006;
Gish and States, 1993). With NGS supplanting Sanger sequen-
cing, the need for accurate frameshift alignment P—values has
increased because users require an E-value accounting for fre-
quent frameshifts to decide which sequences are true homologs.

The Ascending Ladder Program (ALP) was developed for
real-time computation of the statistical parameters in BLAST
(Park et al., 2009, 2012; Sheetlin et al., 2005). It is based on an
importance sampling method using a global alignment of two
simulated sequences generated by a Markov chain (Bundschuh,
2002; Park et al., 2009). Heuristic modeling of the ascending
alignment scores of the global alignment as a Markov additive

 

Published by Oxford University Press 2014. This work is written by US Government employees and is in the public domain in the US. 3575

112 /§JO'S{Bumo [p.IOJXO'SOllBIIIJOJUTOTQ/ﬁdllq 11101; popeoIII/noq

910Z ‘091sn3nv uo ::

S.L.Sheetlin et aI.

 

process yielded analytical formulas for estimating the parameters
of a modiﬁed Gumbel distribution.

This article has two aims: (i) it presents the Frameshift
Ascending Ladder Program (FALP), which extends ALP by
handling frameshift errors from NGS; (ii) it exempliﬁes the use
of FALP by ﬁnding pseudogenes in the human genome and
analyzing metagenomic DNA from polluted soil. FALP uses
the same probabilistic framework as ALP, but the importance
sampling for generating random sequence pairs requires seven
Markov chain states in FALP, instead of three states in ALP.

The organization of this article is as follows. The Methods
section describes the mathematics of frameshift alignment and
our development and implementation of the FALP algorithm. It
also describes heuristic frameshift alignment with LAST for gen-
omic sequence data applications and provides the dataset we
used for pseudogene and metagenome analyses. The Results sec-
tion compares the approximate P—values from FALP to frame-
shift alignment P—values from simulation. It then shows how
frameshift alignment helps to detect pseudogenes in the human
genome and to analyze metagenomic DNA reads. Finally, the
Discussion section reﬂects on our results. The Supplementary
Data details the importance sampling used in FALP.

2 METHODS

2.1 Frameshift alignment and its notations

Let A=a1a2... be a DNA sequence and B=B1B2. .. be an amino
acid sequence, where a,- is drawn from the nucleotide alphabet
8A = {a, c, g, t}, and Bj is from the amino acid alphabet
BB = {A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y}. Let
T (a,_2a,-_1a,) =A, e 8} = BB U {*} be an amino acid translated from the
codon a,_2a,-_1a, or a stop codon denoted by *. Let S : 8} X BBHR
denote a ‘scoring matrix’. In database applications, S(A, B) quantiﬁes
the similarity between A and B, e.g. the so-called ‘PAM’ (point accepted
mutation) or ‘BLOSUM’ (block sum) scoring matrices can quantify evo-
lutionary similarity between two amino acids (Dayhoff et a1., 1978;
Henikoff and Henikoff, 1992).

Let wg =A0 + A1.g (A0, A1 2 0) denote the afﬁne gap penalty, where
A0 is called the gap opening penalty, A1 is called the gap extension penalty
and g is the gap length in amino acids. Let y be the ‘frameshift penalty’,
imposed when sequencing errors necessitate a frameshift in the alignment
of DNA and amino acid sequences. The scoring matrix S(A, B), the gap
penalty wg and the frameshift penalty 7/ constitute the ‘frameshift align-
ment scoring system’.

The frameshift alignment graph FAB of the sequence-pair (A, B) is a
directed weighted lattice graph in two dimensions, as follows. The vertices
v of FAB are non-negative integer points (i, j) (Throughout the article, i, j,
k, m, n and g are integers.) Seven sets of directed edges 6 come out of
each vertex V: (i, j): one northward, three in slightly varying directions
northeastward and three eastward. The ﬁrst northeastward edge goes into
v= (i+ 3, j + 1) with weight S[e]=s(A,-+3,Bj+1), corresponding to a
match between a codon and an amino acid. The second northeastward
edge goes into v=(i+4,j+ 1) with weight s[e]=s(A,-+4, Bj+1) — y, cor-
responding to a nucleotide insertion between two consecutive DNA
codons. The third northeastward edge goes into v=(i + 2, j + 1) with
weight S[e]=S(A,-+2,Bj+1) — y, corresponding to a nucleotide deletion,
so that the last position of a codon overlaps with the ﬁrst position of the
next DNA codon. For each g>0, one eastward edge goes into
v = (i + 3g, j) and one northward edge goes into v = (i, j + g), both assigned
the same weight, s[e] = — wg <0. The remaining eastward edges go into
v=(i+3g+1,j) and v=(i+ 3g — 1,j) with weight S[e]= — wg — y<0.

 

c... g. H
w E 
5 0'

C : 

D 2 

R '- _‘ﬂ '7..." _

A_  .. i_:
gcttaagtggattgt
—————————+>
sequence A get taag —— tgg at tgt
translated A H w c
SEQUENCEB A R DC W - C

Fig. 1. Frameshift alignment graph for two sequences
A= gcttaagtggattgt and B =ARDCWC. Open circles indicate vertices
v, and the origin v0 = (0, 0) is at the southwest corner of the Figure. The
optimal frameshift alignment path consists of six edges, in order: 2 north-
east, 1 north of length 2, 1 northeast, 1 east of length 1 and 1 northeast. It
corresponds to the alignment word-pairs (gct, A), (taag, R), (A, D),
(A, C),6(tgg, W), (at,A) and (tgt, C). The frameshift alignment score
is 21,21 S[e,-], where S[€1]=S(A, A), S[€2] =S(K, R) — y, S[€3] = — W2,
s[e4] = S(W, W), s[es] = — W1 — y and s[e6] = S(C, C). Note that frameshift
occurs twice in the alignment by a nucleotide t insertion between got
and aag and a nucleotide deletion between tgg and tgt. Double line
edges show that alignment is in reading frame 1 and dotted line edges
show that alignment is in reading frame 2

A (directed) path 71=(v0, 61, v1, 62, ..., ek, vk) in PM; is a ﬁnite alter-
nating sequence of vertices and edges that starts and ends with a vertex.
For each 1': 1, 2, . . ., k, the directed edge 6,- comes out of vertex v,-_1 and
goes into vertex v,. We say that the path 71 starts at v0 and ends at V], and
the alignment’s score is the ‘path weight’ S” :=  1 s[e,]. See Figure 1
for an example.

Let Mm," denote the local maximum scores for a given DNA sequence
A: mag. . .am and amino acid sequence B =B1B2. . B". In the appropri-
ate limit, if the frameshift alignment scoring system is in the so-called
‘logarithmic phase’ (Arratia and Waterman, 1994; Dembo et a1., 1994)
(i.e. if the optimal global alignment score of long random sequences has a
negative score), the random score Mm," follows an approximate Gumbel
extreme value distribution with ‘scale parameter’ A and ‘pre-factor’ K:

 3 y) R 1 — exp [—Kmnexp (—)ty)]. (1)

The search space size mn in Eq (1) is sharpened by edge effect (Altschul
and Gish, 1996; Park et a1., 2012).

2.2 Algorithm for frameshift alignment score
We assume that a nucleotide insertion or deletion error occurs only be-
tween two consecutive codons. Then, for gap penalty wg = A0 + Ag and
frameshift penalty y, the global frameshift alignment score SM- is calcu-
lated with the recursion

max {Si—3,j—1, Di—3,j—1, Ii—3,j—1 
S ,3 j = max

max {Si—2,j—1,Di—2,j—1,L—2,j—1, Si—4,j—1,Di—4,j—1,Ii—4,j—1} — 1’

‘1‘ S (Ai, 
(2)

 

3576

112 /§JO'S{Bumo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoIII/noq

910Z ‘091sn3nv uo ::

Frameshift alignment

 

Ii,j=maX {Si,j—1 — A0, Ii,j—1} — A1, (3)

DU =max {max {Si_3,j — A0, Di_3,j},
max {Si—2,j — A0, Di—2,ja 51—4,) — A0, Di—4,j} — V} — A1, (4)

with boundary conditions S0,0 = 0, D3550 =10,g = — A0 — A1.g,
D3g—1,0 = D3g+ 1,0 = — A0 — Ai-g — 1/9 5—1.0 = S—1,g = SO,g = Si,g = S2,g =
Sg,0 = — 00, D—1,0 = D—1,g = D0,0 = D0,g = D1,0 = D1,g = D2,g = — 00,
I_1,0 =I_1,g 210,0 21550 = — 00 for g>0.

The three array names S, I and D are mnemonics for ‘substitution’,
‘insertion’ and ‘deletion’. If ‘A’ denotes a gap character, the alignment
word-pairs of the forms (aa, B), (aaa, B), (aaaa, B), (A, B), (cm, A),
(mm, A) and (aaaa, A) correspond to the operations for editing se-
quence A into sequence B (Waterman et a1., 1976). Note that (act, B)
and (cm, A) represent a nucleotide deletion while (aaaa, B) and
(aaaa, A) represent a nucleotide insertion into the boundary of a
codon.

The preceding calculation disallows adjacent insertions and deletions.
If desired, they can be allowed by replacing the recursion for IiJ- in Eq (3)
with I,,j=max {S,-,J-_1 — A0, Ii,j_1,Dj,j_1 — A0} — A1. As usual, the global
alignment algorithm and its boundary conditions can be converted into a
local alignment algorithm for comparing DNA and amino acid
sequences.

2.3 Trial distribution for importance sampling

To estimate the Gumbel parameters, FALP uses importance sampling
together with Eqs (2—4). Like all Monte Carlo methods, importance sam-
pling estimates the integral of some function over some target distribu-
tion. It improves its estimate’s accuracy by generating samples from a
biased trial distribution that focuses its probability in a region where the
function is large. It then corrects for sampling bias by multiplying the
function values it samples by the ratio of target to trial probabilities
before averaging. In the present context, our importance sampling gen-
erates frameshift alignments with high scores, so the Gumbel approxima-
tion is relatively accurate, to improve the accuracy of the corresponding
estimated statistical parameters (Hammersley and Handscomb, 1964).

Let the letters in sequences A and B be independent and identically
distributed with background (target) probabilities {pa : a 6 8A} and
{qB : B 6 83}, respectively. In FALP, importance sampling generates
high-scoring random sequence pairs with a trial distribution using a
Hidden Markov model whose underlying Markov chain has seven
states {S1, S2, S3,D1,D2,D3,I}, where S1 2=8ABABA X 83,
Sz 228/1814 X 83, S3 IZBABABABA X 83, D12=BABABA X
D2 2=8ABA X {A}, D3 2=8ABABABA X {A} and I:={A} X 83. Let
1N1 represent a transition probability from state r to state r], where
r, r, 6 {S1, S2, S3, D1,D2,D3,I}. The transition probabilities {1N1} are
determined using the scores S(A,B), the gap penalty wg=A0+A1.g
and the frameshift penalty y. The emission probabilities on D1,D2,
D3 and I states have the forms papapa, papa, papapapa and q3, re-
spectively. The emission probabilities on S1 and S2 states have the
forms eaan; and 6mg, respectively. The emission probabilities for the
S3 state have the form paeaaaﬁ. The Supplementary Data has further
details on the transition and emission probabilities. Under the as-
sumption of independent letters in A and B, our methods then pro-
duce accurate statistical parameters applying to the output of the
frameshift alignment algorithm in Section 2.2. As we generate se-
quence pairs by the hidden Markov model, we compute importance
sampling weights as the ratio of the target probability over the cor-
responding trial probability. The importance sampling weights can be
computed efﬁciently by a dynamic programming algorithm, similar to
ALP (Park et a1., 2009), but with some technical complications, as
described in the Supplementary Data.

2.4 Implementation

FALP can be run in three modes. ‘Gumbel Mode’ estimates the
modiﬁed Gumbel parameters for a given frameshift alignment scoring
system. The modiﬁed Gumbel parameters include the two parameters
A and K of the Gumbel distribution in Eq (1), together with param-
eters for a ‘ﬁnite—size correction’ to the Gumbel approximation.
The ﬁnite-size correction accounts for edge effects caused by ﬁnite
sequence lengths (Park et a1., 2012). ‘P-values Mode’ calculates
P-values and E-values using the modiﬁed Gumbel parameters.
‘Align Mode’ computes the optimal frameshift alignment score for
a given pair of nucleotide and amino acid sequences. The default
frameshift alignment scoring system in FALP is BLOSUM80 with
wg=11+2g and y=15. The default letter frequencies are uniform
frequencies for the 4nuc1eotides (all 0.25) and the Robinson and
Robinson (1991) frequencies for the amino acids. Users can assign
their own frameshift alignment scoring system and letter frequencies,
and translation table.

FALP automatically allocates computation resources to compute all
statistical parameters to the accuracy a user requires. The default accur-
acy for K is 0.5%. (Typically, K takes more time to estimate than A.)
FALP computes standard errors for its estimates of the modiﬁed Gumbel
parameters by partitioning the random sequence-pairs from importance
sampling into subsets. The user can specify the number of partition sub-
sets, with default 10.

2.5 Fast heuristic frameshift alignment with LAST

For genomic-scale sequence data like genomes and metagenomes, we use
LAST to ﬁnd alignments quickly but heuristically. LAST follows the
same three steps as BLAST: ﬁnd ‘seeds’ (short initial matches); extend
a gapless alignment from each seed; and if there is a sufﬁciently high-
scoring gapless alignment, then extend a gapped alignment with frame-
shifts. LAST achieves adequate speed for genome-scale data by using
adaptive seeds in the ﬁrst step (Kielbasa et a1., 2011). In the third step,
the frameshift recursion is calculated in a limited region of the dynamic
programming matrix, deﬁned by an x-drop algorithm (Altschul et a1.,
1997). It uses this variant of the recursion, which aims to be as fast as
possible (and assumes that y 2 A1):

XZmaX {Si—3,j—12Si—2,j—1 — % Si—4,j—1 — V}
y: Yi,j—l — A1
z=Z,-_3,j — A1
b=max {X, y, 2}
SM :17 +S(A,-, Bj)
Y,,j=max {b — A0,y}
Z,-,j=max {b — A0, 2}

This variant does consider adjacent insertions and deletions.

2.6 Pseudogene analysis

We identiﬁed human pseudogenes by comparing the genome (hg19) to a
database of known proteins [UniRef90 version 2012_07, (Suzek et a1.,
2007)]. The comparison was done with LAST V362 (Kielbasa et a1., 2011),
after masking tandem repeats with tantan v13 (Frith, 2011). First, the
proteins were masked and indexed:

tantan —p —rO .02 | lastdb —p —c
Then, the genome was masked and aligned:

tantan —c | lastal —pBLOSUM8O —F15 —el3l —mlOO —fO

 

3577

112 /§JO'S{12umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

S.L.Sheetlin et aI.

 

As a control, we also aligned the genome after reversing (but not com-
plementing) it:

tantanl reverse | lastal —pBLOSUM8O —F15 —e93 —mlOO —fO
—u3

The results were compared with the following annotation ﬁles from the
UCSC database (Meyer et a1., 2013): knownGene.txt, pseudoYa1e60.txt
(Zhang et a1., 2003), vegaPseudoGene.txt (Harrow et a1., 2012). They
were also compared with human-versus-lamprey alignments
(hg19.petMar2.net.axt).

We also attempted a BLAST search, using NCBI BLAST+ 2.2.28.
First, the proteins were masked and prepared:

tantan —p —rO . 02 | makeblastdb —dbtype prot
Then, the genome was masked and aligned:

tantan —c |
blastX —matriX BLOSUM80 —outfmt 7 —lcase_masking

2.7 Metagenome analysis
We also analyzed a set of metagenomic DNA reads (SRR629686) by

comparing it with UniRef90. The reads were ﬁrst converted to fasta
format, then masked and aligned as follows:

tantan | lastal —pBLOSUM8O —F15 —e129 —f0

3 RESULTS
3.1 FALP P—value evaluation

Table 1 gives FALP’s estimates for scale parameter A and pre-
factor K for the BLOSUM62 and wg = 11 + g, the default scoring
system in BLASTP for proteins. We used uniform nucleotide
frequencies (all 0.25) and Robinson and Robinson (1991) fre-
quencies for amino acids. As the frameshift penalty y increases,
estimates of A converge to 0.330:I:0.001. Figure 2 displays
P—value accuracies for FALP, if the frameshift alignment scoring
systems are BLOSUM62, wg = 11 +g and y=9, and
BLOSUM80, wg= 11+2g and y= 15. The ‘gold standard’
P—values were calculated using importance sampling in 2 X 108
simulation runs. Other scoring schemes also gave qualitatively
similar results.

Table 1. Estimates for Gumbel parameters for BLOSUM62 and

 

 

wg = 11+g
y A K

5 0.091 :I: 0.004 0.00008 :1: 0.00004
10 0.302:I:0.002 0.120:|:0.011
15 0.318:|:0.003 0.132:I:0.013
20 0.331 :I:0.002 0.186:|:0.026
40 0.332 :I: 0.002 0.099 :I: 0.010

 

3.2 Finding pseudogenes in the human genome

Pseudogenes are gene fossils that no longer produce functional
proteins, so they accumulate arbitrary mutations including
frameshifts. One useful application of frameshift alignment is
to identify pseudogenes by ﬁnding alignments (indicating hom-
ology) between a genome and all known proteins (from a protein
database such as UniRef). The results will include exons of real
genes as well as pseudogenes, but overlap with gene annotations
identiﬁes the real exons, which can then be removed. Gene an-
notations are often incomplete, so some real exons might remain,
but for some applications this does not matter (see below).

Accordingly, we used frameshift alignment to ﬁnd human
pseudogenes. In fact, any frameshift aligner reasonably approx-
imating LAST’s algorithm above could have been used to pro-
duce the input scores for FALP. As usual, the alignment score
threshold should be as low as possible, to ﬁnd subtle pseudo-
genes, but not so low that it encourages ‘too many’ spurious
alignments. FALP estimates that, if we compared a shufﬂed
human genome to a shufﬂed UniRef90, with the default frame-
shift alignment scoring scheme, about 700 random alignments
are expected with score S 2 100, about 20 alignments with
score S 2 110, etc. (Table 2). We conservatively chose a score
threshold of S= 131, with corresponding E-value E g 0.01, so
almost no spurious alignments are expected.

Thus, FALP permits control of the number of spurious align-
ments in random sequences, but the implications of this control

BLDSUMEE, Hug
Frameshift Penefty=9

BLDSUMBQ 11+29
Fla rneehin Penalty=15

 

I
U

“Maﬁa
“'“u‘i‘ﬂnuueneenoeeo':

1|
1

[lulu III:r [III] [IE Ell
a: er no u: in
Dhlhlengtmﬁﬂ
Protein lengthztﬂf}

L

 

f T 1 1 I T
19.411 12-02 Iva—E3 1&0! 'Ie.[I1 19412 11.03 1|!-

I:
p.

 

=12E|
E100

“he
WOUqu a ‘1'

DNA length
Protein length

4h 41:: en U? {u

[III 132 III] El? But
I

 

I I
11:41 Ire-ll! 1:45- I:-

.-
‘3'
D
_.
u
u
"I'
1.1-
u‘l
_.
11
D
-u|

leg 1 Cite sumated [H'EI uefp-H alue]

 

5h Ethnoltmnlq l1
WW2:

I!

 

e4 .11: an In :14
DNA |ength=3|JEI
Pretem lengthzf 0E1

.134 .El? IIIEI El? III-l-

 

 

 

 

 

I | | | I |
It-EII 'll-lill III-l]? 'II-1|] 'll-IH 1E-[ll- 1110? IE-llil

p-velues

Fig. 2. Accuracy of FALP’s P-value estimates. It plots log 10([3 / p)
against p, where 13 is the FALP P-value and p is the simulation
P-value. X-axis is in logarithmic scale. The ﬁrst column plots are obtained
from BLOSUM62 with wg = 11 + g and y=9. The second column plots
are from BLOSUM80 with wg = 11+2g and y: 15. The ﬁrst row plots
are obtained from a DNA sequence length 60 and protein sequence
length 100; the second row DNA length 120 and protein length 100;
the third row DNA length 300 and protein length 100. Perfect P-value
estimation lies in y = 0

 

3578

112 /§JO'S{12umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

Frameshift alignment

 

Table 2. Expected numbers of random alignments between
the human genome and UniRef90

 

Minimum alignment score Expected number of

random alignments

 

90 26 538

100 714
110 19
120 0.52
130 0.014

 

 

 

 

 

 

— observed
--- expected
8
+_ _
(D
E 1—
C
“e’
C 8 |,
e +_. _
(U a) |
u— 1-
o l
I. I
g I
I
O
E? :
z m I
'— I
l
I
I
8 I
l—I —
a; .
- | I I I I

O

1000 2000 3000 4000

Minimum alignment score

H9I5P9 HHHHYHHHHHHHHHHH—HHHHHHHQNHHHYHYY
rev chr21 HHHHYHHHHHHHH*HY/HHHYYHHHHHHHYHHH

 

 

 

 

 

<I'
e _ _
cu “ — observed
I observed (sensitive)
‘, - - - expected
I
‘3 a '1
a) + — ‘ —
E OJ ‘
C 1—
.9
Tu I
I..— I
O I
L I
 8 I
+ — I —
3 03 I
Z ‘— I
I
I
I
I
N I
O I
I. - I -
~— I I I I
100 150 200 250

Minimum alignment score

Fig. 3. LAST alignments between the reversed (but not complemented)
human genome and known proteins in UniRef90. (A) Without repeat-
masking. (B) An example of an alignment found without repeat-masking.
(C) With repeat-masking (by tantan). The ‘sensitive’ line shows align-
ments found by running LAST in a more slow and sensitive mode

for spurious alignments in real DNA is unclear. To investigate,
we aligned the reversed (but not complemented) human genome
against UniRef90. DNA never evolves by reversal (due to its
chemical 5’ to 3’ directionality), and so any alignments found
are spurious (non-homologous). Figure 3A shows that FALP
predicts far fewer spurious alignments than actually occur.
Figure 3B suggests that matches between simple repeats account
for most of the spurious alignments.

Figure 3C shows the results after masking simple repeats with
tantan. FALP (dashed line) predicts the observed number of
spurious alignments (black line) after repeat-masking with
tantan, except for a dozen or so spurious alignments with unex-
pectedly large scores. All of the spurious alignments we investi-
gated seem to arise from database artifacts, UniRef proteins that
were computationally translated from reversed (but not comple-
mented) RNA sequences. For example, UniRef proteins Q13540
and Q61506 are translations from human mRNA M14624 and
mouse mRNA X00951, respectively, and the corresponding
mRNAs match the reference genome when reversed (but not
complemented).

Once the database artifacts in Figure 3C are discounted, the
observed number of spurious alignments was slightly less than
the expected number, simply because our heuristic alignment
tool (LAST) misses some alignments. Indeed, when we reran
LAST more slowly and sensitively (-m1000 instead of -m100),
the observed number of spurious alignments increased (but did
not exceed the expected number). In summary, after repeat-
masking with tantan, FALP permits reliable control of the
number of non-homologous alignments. [Note: this is not the
case for repeat-masking programs other than tantan because
they miss some cryptic simple repeats (Frith, 2011).]

Our pseudogene search (which took 13 CPU hours) identiﬁed
65 005 putative pseudogene parts, segments of the human
genome aligning to known proteins but not overlapping with
annotated protein-coding sequences. (We say ‘parts’ because
one pseudogene may have several separate fragments.) As
noted above, some of the putative pseudogene parts are probably
real exons lacking annotations, but 36 376 of 65005 had frame-
shifts, which real exons should lack.

We compared our putative pseudogene parts with two pseudo-
gene catalogs: Yale pseudogenes (Zhang et a1., 2003) and Vega
pseudogenes (Harrow et a1., 2012). (In these catalogs, one
pseudogene may have multiple ‘exons’, i.e. genomic segments.)
Of our 65005 putative pseudogene parts, 43 554 (including
19 679 with frameshifts) have no overlap with any pseudogene
in Yale and Vega, whereas our search missed only 4792 Yale and
Vega exons. The detailed breakdown in Table 3 shows that our

Table 3. Comparison of our pseudogene parts with those in the Yale and
Vega pseudogene catalogs

 

 

Pseudogenes Exons/parts Missed by Yale Missed Missed
by Vega by LAST
Yale 23 321 0 9960 1768
Vega 20 588 7318 0 3276
LAST 65 005 46 739 50 222 0

 

 

3579

112 /§JO'S{12umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

S.L.Sheetlin et aI.

 

A 35.51 eeeul aeweeel essential aemeeeel aeeeeeuel

aeeereuel aeeeeenel aeeeaeuel aeeeaeuel 115.525.0001

Your Sequeme from Blat Search

UCSC Genes [ReI'Seq GenElanir. CCDS. Rfem. IRNAE E‘- Cnmparatwe Genomes)
Vertebrate EaE-BWIEE' Consewatlnn by Phylul‘“

 

“WW-WWW

'-.":".5:::;=.‘;_— :_Ir_I"5r—"-..'_Il=._1" |.'.-; |’“.'II§.II_L-;;-I1~:.

l -__....... -_1......_ LL LMAIIHILIU ..I- ..I.I.1-..II.I.I.11_.._J_.-

GERP scores for mammalian alignmente

 

-| IIJHH‘IAuqulh-Hmu

In,“,I_1_:I1L.._...III=.II_.~ILIIJ11111.111..I1,1111'1".ILLIIFIIILJIJEIFIIILLIIIHJIIIIIIIII’IUVIIJII)IIIIIIIII'II,1

ChIlD HSSKHEQDTLYEV?QEIALHGDECKCPKFLET-IELQISLHNTDLQG-HCFSGTIRLKSTPRSKF-HvaLEKQQHCHEAKAvDIPHHDIEvLKKPHQﬂkklvekLAKK*DALLaeeel

||I||| ||||||| III I ||||I I|||lll||| ||||I|||||||I| |||I |||| ||||I||||ll||l|| | Hill |||l||I||||||

RPLl 0P1 MEEKVSR DTL'I'EAVRE—IFLHGNQ REERKE‘LE'I'V —ELQISLKNTD PGKDI‘LR FSGWRLKSTPRPKPS —VCVLGDQQHCDEAI{AVDI Pi-IHEI IEALKKLNRNKKL‘Jkkl Ell-{KT DP. FLHSEEL

Fig. 4. Example of a conserved non-coding element that is a pseudogene. (A) Genomic context. The element itself is labeled ‘your sequence from Blat
search’. There are no annotated genes in this region. Three measures of conservation are shown: PhyloP, PhastCons and GERP. (B) Alignment of this
DNA element (top, translated in three frames) to 60S ribosomal protein L10a

Table 4. Expected numbers of random alignments between
a set of DNA reads (SRR629686) and a protein database
(UniRef90)

 

Expected number of
random alignments

Minimum alignment score

 

90 5996

100 195

110 6

120 0.21
130 0.0067

 

search missed a greater proportion of exons from Vega than
from Yale, possibly because Vega includes transcribed pseudo-
genes, including exons not derived from protein-coding sequence.

To check whether our alignment methods have real beneﬁt, we
also attempted a BLAST search of the human genome against
UniRef90. Using just chromosome 1, BLAST ran for 48 h with
no output before it was killed by our queuing system. Thus, the
mere ability to handle this scale of data is a non-trivial beneﬁt.

3.3 Most anciently conserved non-coding elements are
pseudogenes

Genomes contain conserved non-protein—coding elements, which
often coincide with enhancers that appear to control fundamen-
tal aspects of embryonic development, including development of
brain regions (Matsunami and Saitou, 2013; McEwen et a1.,
2009). Therefore, studying these elements is a promising ap-
proach to understanding development. On the other hand,
some non-coding elements are conserved for more prosaic rea-
sons: recent pseudogenes can appear conserved simply because
their parent genes were highly conserved.

Thus, to ﬁnd the ‘interesting’ (regulatory) elements, we need to
ﬁlter out the ‘uninteresting’ ones. To explore this issue, we exam-
ined alignments between the human and lamprey genomes, ob-
tained from the UCSC database. Lamprey is a jawless vertebrate
that is very distantly related to human, so these alignments reﬂect
very ancient conserved elements. They include 25 383 putative
non-coding elements, i.e. segments of the human genome that
align to lamprey but have zero overlap with protein-coding se-
quence of known genes. Most of these non-coding elements
(13 755: 54%) overlap pseudogene parts from our earlier
search. This provides a straightforward (non-regulatory) explan-
ation for these elements: presumably they became pseudogenes
(via duplication or simply inactivation) much more recently than
the common ancestor of human and lamprey, and their parent
genes encoded conserved proteins.

One example is shown in Figure 4. This element appears strik-
ingly conserved, and it lies in a gene desert (where conserved
regulatory elements often lie). Without further information, we
might suspect that it performs some fundamental, perhaps regu-
latory, function. Our alignments show, however, that it is actu-
ally a ribosomal protein pseudogene.

This is a case where it does not matter that our pseudogenes
may include unannotated real exons. We wish to ﬁlter out con-
served elements that have a straightforward explanation (that
they either used to or still do encode proteins), to get the inter-
esting unexplained ones.

3.4 Application to analyzing metagenomic DNA reads

By comparing metagenomic DNA reads to a protein database,
we may gain clues as to what kinds of proteins and enzymes are
encoded in the DNA (Darling et a1., 2014). As an example, we
examined a set of DNA reads from industrially polluted soil in
India (Shah et a1., 2013). This has 409 782 reads (133 529 997
bases) sequenced with the FLX titanium system. This sequencing
system is often used in metagenomics because it produces fairly

 

3580

112 /§JO'S{12umo [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 pop1201umoq

9IOZ ‘091sn3nv uo ::

Frameshift alignment

 

V S A P L R Q A L P E
V S E P V R A A L P E

S S L V F I I H A T E P
S S L V F I I N A T E P

GGTT GTT TCG GAA CCT GTG CGC GCA GCC CTG CCC GAA GGC AGC TCC CTG GTT TTT C ATC AAT GCC ACG GAG CCT

F F T Y I K LIS A M A G L
F F T Y L K L1G A L A G F

L S L P V I F W Q L W
V S L P V I L W Q I W

TTT TTC ACC TAT CTC AAA CTGGG GCC TTG GCC GGC TTT CTC GTT TCC CTG CCC GTC ATC CTC TGG CAA ATC TGG G

Fig. 5. Example of a metagenomic DNA read aligned to a protein. The lower sequence is DNA read SRR629686.75083 (reverse strand). The upper
sequence is part of a previously known protein: tatC, a sec-independent protein translocase, from Pelobacter carbinolicus (Q3A8D5). The middle

sequence shows the translation of each codon, and frameshifts are indicated with

long reads, which is especially beneﬁcial for characterizing DNA
from unknown or novel organisms. On the other hand, it has a
signiﬁcant rate of insertion and deletion errors (in particular,
homopolymer length errors), which are likely to introduce
frameshifts.

As usual we need to choose an alignment score threshold, so as
to ﬁnd as many signiﬁcant alignments as possible, but not too
many random alignments. Table 4 shows expected numbers of
random alignments if we compare all the DNA reads to the
protein database. (Note these are different from BLAST E-
values, which are for comparing one query sequence to the data-
base.) We conservatively used a minimum alignment score of
129, for an E-value of 0.01. (So the single-query E-value is
~0.01/409 782).

Our conservative alignment procedure found alignments for
254 768 (62%) of the reads. It took 142 CPU minutes [~15 real
minutes, since we used multiple CPUs (Tange, 2011)].
Surprisingly, 145181 reads (more than half of the aligned
reads) have a top-scoring alignment that contains a frameshift.
One example is shown in Figure 5. There are several possible
explanations for seeing so many frameshifts:

o Frameshift errors in the DNA reads.

0 Database errors (e. g. the database protein was deduced from
a nucleotide sequence with frameshift errors).

0 Non-erroneous DNA reads from pseudogenes.

0 Evolution of proteins by frameshift.

This environment is polluted with chemical waste (from manu-
facture of dyes, paints, solvents, pharmaceuticals, etc.), likely
including mutagens, which might conceivably cause some of
the frameshifts. Although it is hard to distinguish sequence
errors from real frameshifts, we can at least say that, since frame-
shifts are so frequent, it is important to take them into account to
correctly understand relationships between metagenomic se-
quences and known proteins. For example, Figure 5 has two
compensatory frameshifts, which means that non-frameshift
alignment is likely to align the middle part wrongly, obscuring
its evolutionary history.

4 DISCUSSION

We presented a new program FALP that assesses the statistical
signiﬁcance of a frameshift alignment score. In the algorithm
section, we assumed that a nucleotide insertion or deletion
occurs only between two consecutive codons. However, FALP
can easily handle general error models because FALP is based on
a Markov chain. Simply we deﬁne insertion or deletion error

6!,

events as Markov states and add the corresponding Markov
states to the current seven states in the Markov state-space.

We suggested a simple way of roughly annotating pseudogenes
in a genome by frameshift alignment search of a protein data-
base. These annotations are highly informative, even without
tackling the hard question of distinguishing pseudogenes from
real genes. In particular, these annotations overlap, and explain,
most apparently conserved non-coding elements. This enables us
to focus on the remaining unexplained conserved elements,
which are likely to have important biological roles, such as regu-
lation. On the other hand, ‘ultraconserved elements’ (Bejerano
et a1., 2004; Lomonaco et a1., 2014) are not pseudogenes—see the
Supplement.

We also analyzed one metagenomic DNA dataset by align-
ment to known proteins, and surprisingly found that most align-
able reads exhibit frameshifts. This fact testiﬁes to the
importance of analyzing such data with frameshift alignments.
Some frameshifts might not be sequencing errors, but could in-
dicate interesting evolutionary events. Since frameshift alignment
is rarely used, we suspect that there is a lot to discover with it.

Frameshift alignment may improve taxonomic identiﬁcation
of metagenomic sequences that lack close relatives in the data-
base. This is because protein is typically more conserved than
DNA, and so frameshift alignment should be able to ﬁnd more
distant relationships than the usual DNA-level alignment. It is
also likely to improve gene prediction, where it is critical to get
the correct reading frame. This study demonstrates that statistic-
ally rigorous large-scale frameshift alignment can be done easily,
and we hope it will encourage renewed interest in this powerful
technique.

Funding: This research was supported by the Intramural
Research Program of the NIH, National Library of Medicine.

Conﬂict of interest: none declared.

REFERENCES

A1tschu1,S.F. and Gish,W. (1996) Local alignment statistics. Methods Enzymol.,
266, 460—480.

A1tschu1,S.F. et al. (1990) Basic local alignment search tool. J. Mol. Biol, 215,
403—410.

A1tschu1,S.F. et al. (1997) Gapped blast and psi-blast: a new generation of protein
database search programs. Nucleic Acids Res., 25, 3389—3402.

A1tschu1,S.F. et al. (2001) The estimation of statistical parameters for local align-
ment score distributions. Nucleic Acids Res., 29, 351—361.

Arratia,R. and Waterman,M.S. (1994) A phase transition for the score in matching
random sequences allowing deletions. Ann. App]. Probab., 4, 200—225.

Baytaluk,M.V. et al. (2002) Exact mapping of prokaryotic gene starts. Brief
Bioinformatics, 3, 181—194.

Bejerano,G. et al. (2004) Ultraconserved elements in the human genome. Science,
304, 1321—1325.

 

3581

112 /8JO'S{12umo [progxo'sor1eu1101urorq//:d11q 111011 pop1201umoq

9IOZ ‘091sn8nv uo ::

S.L.Sheetlin et aI.

 

Bundschuh,R. (2002) Rapid signiﬁcance estimation in local sequence alignment
with gaps. J. Comput. Biol, 9, 243—260.

Carneiro,M.O. et al. (2012) Paciﬁc biosciences sequencing technology for genotyp-
ing and variation discovery in human data. BM C Genomics, 13, 375.

Darling,A.E. et al. (2014) Phylosift: Phylogenetic analysis of genomes and metagen-
omes. Peer J., 2, e243.

Dayhoff,M.O. et al. (1978) A model of evolutionary change in proteins. In: Atlas of
protein sequence and structure. Vol. Supp 3, pp. 345—352. National Biomedical
Research Foundation, Silver Spring, MD.

Dembo,A. et al. (1994) Limit distributions of maximal non-aligned two-sequence
segmental score. Ann. Probab, 22, 2022—2039.

Edgar,R.C. (2010) Search and clustering orders of magnitude faster than blast.
Bioinformatics, 26, 2460—2461.

Frith,M.C. (2011) A new repeat-masking method enables speciﬁc detection of hom-
ologous sequences. Nucleic Acids Res., 39, e23.

Gertz,E.M. et al. (2006) Composition-based statistics and translated nucleotide
searches: improving the tblastn module of blast. BM C Biol, 4, 41—41.

Girdea,M. et al. (2010) Back-translation for discovering distant protein homologies
in the presence of frameshift mutations. Algorithms Mol Biol, 5, 6.

Gish,W. and States,D.J. (1993) Identiﬁcation of protein coding regions by database
similarity search. Nat. Genet, 3, 266—272.

Guan,X.J. and Uberbacher,E.C. (1996) Alignments of DNA and protein sequences
containing frameshift errors. Comput. Appl. Biosci., 12, 31—40.

Hammersley,J.M. and Handscomb,D.C. (1964) Monte Carlo methods. In:
Bartlett,M.S. (ed) Monographs on Applied Probability & Statistics. Methuen & Co.

Harrow,J. et al. (2012) Gencode: The reference human genome annotation for the
encode project. Genome Res., 22, 1760—1774.

Henikoff,S. and Henikoff,J.G. (1992) Amino acid substitution matrices from pro-
tein blocks. Proc. Natl Acad. Sci. USA, 89, 10915—10919.

Huson,D.H. and Xie,C. (2013) A poor man’s blastxihigh-throughput metage-
nomic protein database search using pauda. Bioinformatics, 30, 38—39.

Kielbasa,S.M. et al. (2011) Adaptive seeds tame genomic sequence comparison.
Genome Res., 21, 487—493.

Lomonaco,V. et al. (2014) UCbase 2.0: ultraconserved sequences database (2014
update). Database, 2014, pii: bau062.

Lysholm,F. (2012) Highly improved homopolymer aware nucleotide-protein align-
ments with 454 data. BM C Bioinformatics, 13, 230.

Matsunami,M. and Saitou,N. (2013) Vertebrate paralogous conserved noncoding
sequences may be related to gene expressions in brain. Genome Biol. Evol, 5,
140—150.

Mcewen,G.K. et al. (2009) Early evolution of conserved regulatory sequences asso-
ciated with development in vertebrates. PLoS Genet, 5, e1000762.

Meyer,L.R. et al. (2013) The ucsc genome browser database: extensions and updates
2013. Nucleic Acids Res., 41, D64—D69.

Mironov,A.A. et al. (2001) Pro-Frame: similarity-based gene recognition in eukary-
otic DNA sequences with errors. Bioinformatics, 17, 13—15.

Park,Y. et al. (2012) New ﬁnite-size correction for local alignment score distribu-
tions. BM C Res. Notes, 5, 286—286.

Park,Y. et al. (2009) Estimating the gumbel scale parameter for local alignment of
random sequences by importance sampling with stopping times. Ann. Stat., 37,
3697—3714.

Pearson,W.R. et al. (1997) Comparison of DNA sequences with protein sequences.
Genomics, 46, 24—36.

Robinson,A.B. and Robinson,L.R. (1991) Distribution of glutamine and asparagine
residues and their near neighbors in peptides and proteins. Proc. Natl Acad. Sci.
USA, 88, 8880—8884.

Shah,V. et al. (2013) Taxonomic proﬁling and metagenome analysis of a microbial
community from a habitat contaminated with industrial discharges. Microb.
Ecol, 66, 533—550.

Shao,W. et al. (2013) Analysis of 454 sequencing error rate, error sources, and
artifact recombination for detection of low-frequency drug resistance mutations
in hiv-l DNA. Retrovirology, 10, 18.

Sheetlin,S. et al. (2005) The gumbel pre-factor k for gapped local alignment can be
estimated from simulations of global alignment. Nucleic Acids Res., 33,
4987—4994.

Shendure,J. and J i,H.L. (2008) Next-generation DNA sequencing. Nat. Biotechnol,
26, 1135—1145.

Suzek,B.E. et al. (2007) Uniref: Comprehensive and non-redundant uniprot refer-
ence clusters. Bioinformatics, 23, 1282—1288.

Suzuki,S. et al. (2012) Ghostm: a gpu-accelerated homology search tool for meta-
genomics. Plos One, 7, e36060.

Tange,O. (2011) GNU Parallel: The Command-Line Power T 00l.;l0gin.' The
USENIX Magazine. pp. 42—47.

Wang,X.V. et al. (2012) Estimation of sequencing error rates in short reads. BM C
Bioinformatics, 13, 185.

Waterman,M.S. et al. (1976) Some biological sequence metrics. Adv. Math., 20,
367—387.

Zhang,Y. and Sun,Y. (2011) Hmm-frame: accurate protein domain classiﬁcation
for metagenomic sequences containing frameshift errors. BM C Bioinformatics,
12, 198.

Zhang,Z. et al. (1997) Aligning a DNA sequence with a protein sequence.
J. Comput. Biol, 4, 339—349.

Zhang,Z.L. et al. (2003) Millions of years of evolution preserved: a comprehensive
catalog of the processed pseudogenes in the human genome. Genome Res., 13,
2541—2558.

Zhao,Y.A. et al. (2012) Rapsearch2: a fast and memory-efﬁcient protein simi-
larity search tool for next-generation sequencing data. Bioinformatics, 28,
125—126.

 

3582

112 /8JO'S{12umo [progxo'sor1em101urorq//:d11q 111011 pop1201umoq

9IOZ ‘091sn8nv uo ::

