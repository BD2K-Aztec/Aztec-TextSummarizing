Advance Access Publication Date: 30 January 2015

Bioinformatics, 31(11), 2015, 1863—1865
doi: 10.1093/bioinformatics/btv062

Applications Note

 

 

Systems biology

Dizzy-Beats: a Bayesian evidence analysis tool

for systems biology

Stuart Aitken1'* Alastair M. Kilpatrickz'3 and Ozgur E. Akman4

1MRC Human Genetics Unit, IGMM, University of Edinburgh, Edinburgh EH4 2XU, UK, 2School of Informatics,
University of Edinburgh, Edinburgh EH8 9AB, UK, 3Department of Pediatrics, University of California San Diego, La
Jolla, CA 92093, USA, 4Centre for Systems, Dynamics and Control, College of Engineering, Mathematics & Physical

Sciences, University of Exeter, Exeter EX4 40F, UK

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on December 4, 2014; revised on January 13, 2015; accepted on January 26, 2015

Abstract

Motivation: Model selection and parameter inference are complex problems of long—standing
interest in systems biology. Selecting between competing models arises commonly as underlying
biochemical mechanisms are often not fully known, hence alternative models must be considered.
Parameter inference yields important information on the extent to which the data and the model

constrain parameter values.

Results: We report Dizzy—Beats, a graphical Java Bayesian evidence analysis tool implementing
nested sampling — an algorithm yielding an estimate of the log of the Bayesian evidence Zand the
moments of model parameters, thus addressing two outstanding challenges in systems modelling.
A likelihood function based on the L1—norm is adopted as it is generically applicable to replicated

time series data.

Availability and implementation: http://sourceforge.net/p/bayesevidence/home/Home/

Contact: s.aitken@ed.ac.uk

 

1 Introduction

Bayesian methods provide a sound basis for ranking alternative
systems biology models and for characterizing the eXtent to which
parameters are constrained by models and data (Kirk et 61]., 2013).
Markov Chain Monte Carlo methods have been applied to model
selection (Schmidl et 61]., 2012) and to parameter inference in sys—
tems biology (Hug et 61]., 2013; Kanodia et 61]., 2014), but often re—
quire considerable algorithmic and conceptual development. Nested
sampling promises to ease these complex computational tasks:
Recent biological applications include (Aitken and Akman, 2013;
Kirk et 61]., 2013; Pullen and Morris, 2014).

General purpose code for nested sampling is available in R
(Skilling, 2006; Aitken and Akman, 2013), and biological applica—
tions of the MultiNest tool (Feroz et 61]., 2013) have been reported
(Kirk et al., 2013; Pullen and Morris, 2014). A C—based command—
line application implementing nested sampling and providing a

©The Author 2015. Published by Oxford University Press.

Systems Biology Markup Language (SBML) interface has recently
been released (Johnson et 61]., 2014), but no graphical tool is currently
available. Thus we sought to add nested sampling to the widely used
Dizzy chemical kinetics simulation tool (Ramsey et 61]., 2005) (over
200 citations as of November 2014). In addition, we have added an
optimization function and SBML 3.1 compatibility. However, as
Dizzy’s command language has operators that cannot be captured in
SBML 3.1, and SBML 3.1 has features not supported by Dizzy, this
feature is restricted to the intersection of the modelling languages.

2 Methods

Nested sampling calculates two of the central results of Bayesian in-
ference: the posterior distribution P(0|D,H,-) of the parameters 0,
and the evidence P(D|H,-), that is, the support for the data D
under hypothesis H,- (Skilling, 2006), through a sampling strategy.

1 863

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /310'spaumo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

1864

S.Aitken et al.

 

A selection between two alternative models H0 and H1 can be made
by calculating the ratio of their posterior probabilities (1), a calcula—
tion that can be decomposed into the Bayesian evidence (Z0 and Z1)
and the prior probability of the respective hypotheses.

P(H1|D) P(D|H1)P(H1) : Z1P(H1)

P(H0|D) P(D|H0)P(H0) ZOP(H0) (1)

z = J L(ewe) d0 (2)

The evidence (2) is a scalar quantity that can be viewed as an inte—
gral of the likelihood (L) over the elements of mass (dX : 7t(0)d0)
associated with the prior density 7t(0). The prior mass can be accu—
mulated from its elements (dX) in any order. The enclosed prior of
likelihood > 2 can be defined (3), and this allows the evidence to be
written as a one—dimensional integral of the (inverse) likelihood
L(X) over the unit range (taking the enclosed prior mass X to be the
primary variable) (4) (Skilling, 2006).

xu) : J “(9) d6 (3)
L(0)>/t
1
z = J L(X) dX (4)
0
L(X(/1)) E 1

Given a sequence of decreasing values 0 < Xm <  X2 < X1 < 1
where the likelihood L,- : L(X)) can be evaluated, the evidence can
be approximated numerically as a weighted sum. Inferences about
the posterior can be obtained from the sequence of m discarded
points generated by sampling, P. Each point is assigned the weight
[9,- : L(8,)w,- / Z, from which the first and second moments of each
parameter in 0 can be estimated—for more details see Skilling
(2006) and Aitken and Akman (2013). The size of the population of
active points (points 0,- within the evolving constraint L(H) > 2) used
to sample the parameter space is the only parameter of the algorithm
that the user must specify. For complex likelihood functions with
multiple modes, this number may be as high as 10 000, and for a sin—
gle mode as low as 200.

Dizzy—Beats updates the user interface of the original Dizzy
program (Ramsey et al., 2005) retaining the text of the model in the
left editing panel (see Fig. 1) and placing the original simulator choices
in the simulation tab on the right. A histogram plot for visualizing the
results of stochastic simulations is added to the simulation viewing
formats. Two new tabs add optimization and inference capabilities,
and both require a data file to be specified (a simple comma separated
format is used, with column headers matching the names of species in
the model). Using the simulation tab, the user can select parameters,
modify their values and see the simulation results plotted over the
data. This allows a manual tuning and exploration of the model’s fit
to the data. Computational optimization using simulated annealing
can be run to explore a larger parameter space. Similarly, the inference
tab requires users to select parameters to be included in inference by
nested sampling and to input their prior range. A uniform prior is
assumed as is typical in nested sampling. A graph of log likelihood or
of the samples of the selected parameters can be viewed as nested
sampling progresses to monitor progress. The stopping heuristics of
Aitken and Akman (2013) are implemented but the user can in add—
ition specify the maximum number of iterations, and must specify the
number of active points. The outputs are a file summarizing the re-
sults, and a second listing the posterior samples for further analysis.

mtg.

Fig. 1. Dizzy-Beats: an application for parameter inference and model
selection

A likelihood function based on the L1—norm is used for opti—
mization and inference—this is defined by Equations (5) and (6)
(Sivia and Skilling, 2006).

e. = <Ixt — ml) = ( lxt — Mtlp(x)de <5)

m 1 ~t _ t
P(x|{ut, ea) = ngxp (— M) (6)
t=1 t

62:

Equation (5) defines the normalizing constant 6t as the expected
value of the moduli of the differences between the replicate observa—
tions at time t and the values predicted by the kinetic model (,ut).
The product of the probabilities of the median observation at time
t (92,) defines the likelihood function for a time series x of m samples
[Equation (6)]. Maximization of this likelihood minimizes the sum
of the moduli of the residuals (rather than their squares) on the basis
that the testable information is restricted to the expected value of
the modulus of the difference between theory and experiment.
Should we know both the mean and variance, maximum entropy
considerations would lead instead to the Gaussian distribution
(Sivia and Skilling, 2006). Time points where the replicates are most
dissimilar contribute least to the likelihood as 6t is larger—as is
desirable.

3 Discussion

Dizzy-Beats is a graphical application for simulating and optimizing
systems models based on an established simulator (Ramsey et al.,
2005) and its simple textual model syntax, to which we have
added SBML 3.1 import/export functionality. Uniquely, Dizzy-Beats
provides model comparison and parameter inference functions
through the nested sampling algorithm in a graphical application.
Comparable functions are implemented in BioBayes (Vyshemirsky
and Girolami, 2008); however, users must edit the XML representa—
tion of the model should they wish to make modifications.
SYSBIONS (Johnson et al., 2014) implements nested sampling
but all interaction is via the command—line. The use of a likelihood
based on the L1—norm derived from biological replicate data
makes fewer assumptions than a Gaussian error model (Johnson
et al., 2014; Vyshemirsky and Girolami, 2008), and is less computa—
tionally complex than a transitional likelihood function derived
from reaction propensities (Aitken and Akman, 2013; Heron et al.,
2007)

112 /310'spaumo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Bayesian evidence analysis tool for systems biology

1865

 

Funding

This work was funded by BBSRC grant [BB/1023461/ 1] (Bayesian evidence
analysis tools for systems biology; SA. and O.E.A.).

Conﬂict of Interest: none declared.

References

Aitken,S. and Akman,O.E. (2013) Nested sampling for parameter inference in
systems biology: application to an exemplar circadian model. BMC Syst.
Biol., 7, 72.

Feroz,F. et al. (2013) Importance Nested Sampling and the MultiNest
Algorithm. ArXiv e—prints: 1306.2144. http://arXiV.org/abs/1306.2144.

Heron,E.A. et al. (2007) Bayesian inference for dynamic transcriptional
regulation; the Hes1 system as a case study. Bioinformatics, 23,
2596—2603.

Hug,S. et al. (2013) High-dimensional Bayesian parameter estimation: Case
study for a model of JAK2/STAT5 signaling. Mat/7. B iosci., 246, 293—304.

Johnson,R. et al. (2014) SYSBIONS: nested sampling for systems biology.
Bioinformatics, 31, 604—605.

Kanodia,J. et al. (2014) Deciphering the mechanism behind Fibroblast
Growth Factor (FGF) induced biphasic signal-response proﬁles. Cell
Commun. Signal, 12, 34.

Kirk,P. et al. (2013) Model selection in systems and synthetic biology. Curr.
Opin. Biotechnol, 24, 767—774.

Pullen,N. and Morris,R.J. (2014) Bayesian model comparison and parameter
inference in systems biology using nested sampling. PLOS One, 9, e8 8419.
Ramsey,S. et al. (2005) Dizzy: stochastic simulation of large-scale genetic

regulatory networks. ]. Bioinform. Comput. Biol., 3, 415—436.

Schmidl,D. et al. (2012) Bayesian model selection validates a biokinetic model
for zirconium processing in humans. BMC Syst. Biol., 6, 95.

Sivia,D. and Skilling,J. (2006) Data Analysis: A Bayesian Tutorial. OUP,
Oxford.

Skilling,J. (2006) Nested sampling for general Bayesian computations.
Bayesian Anal., 1, 833—860.

Vyshemirsky,V. and Girolami,M. (2008). BioBayes: a software package for
Bayesian inference in systems biology. Bioinformatics, 24, 1933—1934.

112 /810's112umo [p.IOJXO'SODBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

