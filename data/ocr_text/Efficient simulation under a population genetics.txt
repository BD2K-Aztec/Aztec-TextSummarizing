ORIGINAL PAPER

Vol. 27 no. 6 2011, pages 837-843
doi: 1 0. 1 093/bioinforma tics/btr025

 

Genetics and population analysis

Advance Access publication January 18, 2011

Efficient simulation under a population genetics model of

carcinogenesis

Tianqi Zhu‘, Yucheng Hul, Zhi—Ming Ma2, De-Xing Zhang3, Tiejun Li1

and Ziheng Yang3’4’5’*

1School of Mathematical Sciences, Peking University, Beijing 100871, 2Academy of Mathematics and Systems
Science, Chinese Academy of Sciences, Beijing 100190, 3Institute of Zoology, Chinese Academy of Sciences, Beijing
100101, 4College of Life Sciences, Peking University, Beijing 100871, China and 5Department of Biology, University

College London, London W01 E 6BT, UK

Associate Editor: Jeffrey Barrett

 

ABSTRACT

Motivation: Cancer is well known to be the end result of somatic
mutations that disrupt normal cell division. The number of such
mutations that have to be accumulated in a cell before cancer
develops depends on the type of cancer. The waiting time Tm
until the appearance of m mutations in a cell is thus an important
quantity in population genetics models of carcinogenesis. Such
models are often difficult to analyze theoretically because of the
complex interactions of mutation, drift and selection. They are also
computationally expensive to simulate because of the large number
of cells and the low mutation rate.

Results: We develop an efficient algorithm for simulating the waiting
time Tm until m mutations under a population genetics model of
cancer development. We use an exact algorithm to simulate evolution
of small cell populations and coarse-grained r-leaping approximation
to handle large populations. We compared our hybrid simulation
algorithm with the exact algorithm in small populations and with
available asymptotic results for large populations. The comparison
suggested that our algorithm is accurate and computationally
efficient. We used the algorithm to study the waiting time for up
to 20 mutations under a Moran model with variable population
sizes. Our new algorithm may be useful for studying realistic models
of carcinogenesis, which incorporates variable mutation rates and
fitness effects.

Contact: z.yang@ucl.ac.uk

Received on October 6, 2010; revised on December 20, 2010;
accepted on January 12, 2011

1 INTRODUCTION

Cancer is a genetic disease caused by mutations in cancer
susceptibility genes, including oncogenes, tumor suppressor genes
and genetic instability genes (see e.g. Michor et al., 2004 for a
review). Mutations that activate oncogenes can confer a selective
advantage to the cell when one of the two alleles is mutated, but
typically involve speciﬁc amino acid changes at speciﬁc residues
of the protein. Mutations that inactivate both alleles of a tumor
suppressor gene also lead to ﬁtness beneﬁts to the cell, and such
mutations do not have to be speciﬁc as many mutations in a gene can

 

*To whom correspondence should be addressed.

disrupt its normal function (Forbes et al., 2010). Genetic instability
refers to a diversity of changes in the genome on the nucleotide or
chromosomal levels. The former is caused by mutations in the DNA
repair pathways and involves substitutions, insertions or deletions
of one or a few nucleotides. The latter includes gains or losses of
whole chromosomes as well as inversions, deletions, duplications
and translocations of large chromosomal segments. Mutations in
genetic instability genes may cause increased mutation rates in the
cell, leading to the so—called ‘mutator phenotype’ (Lengauer et al.,
1998). For example, p53 mutations may impair the detection of and
response to DNA damage. Many cancers have a mutator phenotype
that results from mutations in genes involved in DNA mismatch
repair.

It is now generally accepted that the rate—limiting step in
the process of carcinogenesis is the accumulation of new
mutations. Both ﬁtness advantages and increased mutation rates can
signiﬁcantly shorten the waiting time until the required number of
mutations. The relative importance of selection followed by clonal
expansion versus raised mutation rates is somewhat controversial.
Tomlinson et al. (1996) argue based on a computer simulation
that advantageous mutations and clonal expansion were sufﬁcient
to initiate tumor without increased mutation rates. However, if
more than two mutations in tumor suppressor genes are needed for
carcinogenesis, increased mutation rates appear to be an important
factor.

The number of mutations required for tumorigenesis depends
on the type of cancer. Armitage and Doll (1954) used age—speciﬁc
cancer incidence data to estimate the number of mutations necessary
to develop colon cancer to be about 6. Knudson (1971) inferred from
an analysis of the incidence of retinoblastoma in children that the
cancer is caused by mutations to the two alleles of a gene (which was
later identiﬁed to be RBl, the ﬁrst tumor suppressor gene), one of
which may be in the germline and inherited. Calabrese et al. (2005)
analyzed data from 1022 colorectal cancers from nine hospitals in
Finland and estimated that about ﬁve to six oncogenic mutations
are required for hereditary cancers or seven or eight mutations for
sporadic cancers. In contrast to those early studies which suggested
that a handful of mutations were sufﬁcient to cause cancer, recent
efforts using next—generation sequencing technologies to identify
mutations in protein—coding genes in common tumor types have in
general identiﬁed far more genes (Sj dblom et al., 2006, Wood et al.,
2007, Jones et al., 2008, Parsons et al., 2008). For example, Sj dblom

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 837

112 /§.IO'SIBU.IT10[p.IO}XO'SOTlBIHJOJUTOTQ/ﬁdnq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

IZhu et aI.

 

et al. (2006) analyzed > 13000 protein—coding genes in breast and
colorectal tumors, and found that individual tumors accumulate an
average of ~90 mutations. Only a small subset of those mutations
may be ‘drivers’, which offer the cell a selective advantage and are
responsible for carcinogenesis, while the others are ‘passengers’,
which provide no ﬁtness beneﬁts to the cell but hitchhike to ﬁxation
by chance. Sj6blom et al. (2006) estimated that as many as 14
mutations may be required to initiate colon cancer and as many
as 20 may be involved in breast cancer (see Wood et al., 2007 for
an updated analysis).

The early work of Armitage and Doll (1954) and Knudson
(1971) has prompted a large body of theoretical work, which uses
population genetics models to describe mutation, drift and selection
and to study the waiting time until the accumulation of m mutations.
Iwasa et al. (2004) studied a two—stage model for a population of
cells evolving according to the Moran model. By assuming that
the ﬁrst mutation is either neutral or deleterious while the second
mutation is advantageous, they studied an interesting scenario called
stochastic tunneling, in which a population ﬁxed for cells of no
mutation can reach ﬁxation for the second mutation without ever
reaching ﬁxation for the ﬁrst mutation. Schweinsberg (2008) and
Durrett et al. (2009) derived the asymptotic distributions of the
waiting time until m mutations. Due to the complexity of the
problem, they assumed selective neutrality and a constant mutation
rate. Numerical simulations were conducted to conﬁrm analytical
results, but only for small populations (103 ~104). Beerenwinkel
et al. (2007) studied the waiting time until m mutations under
the Wright—Fisher model with large population sizes (106 ~109).
With numerical simulation, they were able to show how varying
population size, mutation rate and selection affect the waiting time.

As pointed out by Beerenwinkel et al. (2007), the Moran model
is more natural than the Wright—Fisher model for describing the
evolution of somatic cells. However, simulation under the Moran
model is expensive, even more expensive than under the Wright—
Fisher model. The large population sizes and small mutation rates
mean that one has to simulate many transitions, which change the
compositions of the population only slightly. In this article, we
develop an approximate algorithm to simulate the waiting time until
m mutations under the Moran model. We explore the similarity of the
model of cancer initiation to a chemical reaction system and develop
simulation algorithms that have been studied in that context.

The evolutionary process of mutation, drift and selection under
the Moran model is described by a variable rate Markov chain,
as is a chemical reaction system. The process can be simulated
using standard algorithms by generating exponential waiting times
until the next event and then deciding what event has happened.
This is the so—called Gillespie algorithm (Gillespie, 1977, 2007).
However, with a large population size, simulation using this exact
algorithm is prohibitively slow. The t—leaping algorithm (Gillespie,
2001; Li, 2007) was proposed to speed up the simulation by leaping
over a time interval 1: in which changes to the state and rates of
the chain are expected to be small. However, this coarse—grained
approximation does not work well for our problem, because of the
existence of cell types whose population sizes may be small.

Here we develop a hybrid algorithm that can efﬁciently simulate
the evolutionary processes of large populations. We use the exact
algorithm to simulate transitions involving small populations,
which may introduce substantial changes to the rates, and coarse—
grained t—leaping algorithm to simulate transitions within each

large population, where transitions are unlikely to cause large
changes to the state and the event rates. We test our new hybrid
algorithm against the exact simulation in small populations and
against asymptotic results in large populations. The results suggest
that the hybrid algorithm is reliable and computationally efﬁcient.
The fast simulation algorithm may be useful for studying realistic
carcinogenesis models that allow different cell types to have
different ﬁnesses and different mutation rates.

2 METHODS

We consider a population of N cells, evolving according to the Moran
model (Moran, 1958). Each cell’s life span is an independent exponentially
distributed random variable with parameter 1. When a cell dies, it is replaced
by a new cell whose parent is chosen at random from the N cells in the
population (including the one being replaced). We distinguish cells by the
number of mutations that have accumulated, so that a type j cell has j
mutations, and a new mutation in a type j cell changes the cell to type j+ 1.
Initially all cells are of the wild type, i.e. type 0. The mutation rate depends on
the cell type, and is W for cells of type j . Thus models of mutator phenotypes
can be accommodated using the model by assuming large ujs for large j.
Genes are clonally inherited, so that the daughter cell inherits the mutations
of the mother cell. This process continues until a cell has accumulated m
mutations, when cancer develops. We are interested in the waiting time T m
until the appearance of the ﬁrst type m cell.

Note that cells of different types may have different ﬁtness. In particular,
new mutations may increase the ﬁtness, so that a type j cell may be ﬁtter
than a type (j — 1) cell. Each type j cell is characterized by its mutation rate
W and ﬁtness 1+sj.

The evolutionary process of the cells is described by a Markov chain. The
state of the chain at time t is X(t)= (x0(t),x1(t), ...,xm(t)), where 990) is the
number of type j cells at time I. There are in total m +1 cell types. The initial
state is X(0) = (N,0, ...,0), and the process stops when xm(t) > 0.

Suppose there are K possible events that can change the state of the chain.
Note that some events do not change the system state (such as a type j cell
being replaced by another type j cell), so we do not need to simulate them. Let
the rates of the events be aj(X(t)) for j = 1,2, ...,K , and they cause the state
of the chain to change by v j. In the language of chemical reaction (Gillespie,
2001), Clj is the reaction rate and v j the state—change vector corresponding to
reaction j. With this characterization, the Markov chain is described by the
Kolmogorov forward equation (or master equation),

a K K
EPOLIIXOJO):2650(—vj)P(X—vjatIXOat0)—Zaj(X)P(Xat|XOat0),
j=1 j=1
where the transition probability p(x, tlxo, to) is the probability that X (t) =x

given that X (to) = x0.

Under the Moran model, two kinds of events are possible in each
generation:

(1) Atypej cell is replaced by a typej’ cell, withj,j’ =0, ...,m— 1,j #j’.
This event occurs with rate a],=xj(1+sj/)xj//Z’;;31(1+s,)x,. Here
xj cells of type j die at rate xj, and the new born cell will be of type j’
with probability (1 +sj/)xj//Z';:01(1+sl)xj. The state—change vector
is: vjj/ =§j/ —§j, where g]. is a vector with the j—th element being one
and others zero.

(2

V

A type j cell mutates into type (j + 1), with j = 0, ...,m — 1. This occurs
at rate aj = ujxj, and the state—change vector is vj =£ j +1 —§j.

We would like to simulate the trajectories of X (t) until appearance of the
ﬁrst cell of type m. There are a total of m(m—1)+m=m2 possible events,
and we index them as k=1,2,...,m2. Below we review two algorithms
developed for simulating such a system: the exact simulation algorithm
(Gillespie, 1977, 2007) and the approximate r—leaping algorithm (Gillespie,
2001), before describing our new hybrid algorithm.

 

838

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUlOTCI/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Efficient simulation of carcinogenesis

 

2.1 Exact simulation algorithm

One can generate the exponential waiting time 1 until the next event using
the total event rate, and then sample the event among all possible events in
proportion to their rates.

ALGORITHM 1. Exact algorithm
Initialization: set i=0 and initial value X (0): (N ,0, ...,0). Store the state—

change vector vk,k= 1, ...,m2.

(1) Compute the rates ak =ak(X(t)), k: 1, 

(2) Generate the waiting time 1 until the next event, which is an
exponentially distributed random variable with parameter atom:

2
221:1 ak~

(3) Generate a random number it ~ U (0, 1). Find j such that

7—1 j
Zak S Iiatotal < Zak-

(4) Update time as t’=t+r and state as X(t/)=X(t)+vj. If xm(t/) >0,
set Tm =t’ and stop. Otherwise go back to step 1 with tzt’.

This algorithm is called the ‘direct method’ by Gillespie (1976). Some
variations are possible, and furthermore, smart bookkeeping can lead to
considerable improvement in its computational efﬁciency (Gibson and
Bruck, 2000). However, all those exact algorithms are prohibitively slow
when the cell population sizes are large (in the order of 106—109, say),
because atotal is of order N and the expectation of the waiting time between
two successive events is of order 1/N.

2.2 The t-leaping algorithm

To illustrate the idea of r—leaping, consider the Moran model with only two
cell types. The state vector is X (t) = (x0,x1), with N 2x0 +x1 >> 1. Suppose
there are no mutations (uj =0) and no selection (Sj =0), so that the model is
a pure drift model. Two kinds of events drive the evolution of the population.
(i) A type 0 cell is replaced by a type 1 cell with rate on =x0x1/N; (ii) A type
1 cell is replaced by a type 0 cell with rate a2 =x1x0/N. If x0 2x1 =N / 2 >> 1,
then a1+a2 =N / 2 >> 1, so that the average step size in the exact algorithm
(the average waiting time until the next event) is 2/N << 1. However, note
that each event changes X, and hence on and a2, only by a tiny proportion.
The r—leaping approximation is to consider the rates on (X (to)) and a2 (X (to))
to be constant in a time interval t e [to, to + r), so the numbers of occurrences
of the two kinds of events over the time interval are approximately Poisson
distributed with parameters a1(X(t0))r and a2(X(t0))r . The leaping time I
can be chosen reasonably large so that many events can be updated in one
step, and yet small enough so that the changes to the rates over the time
interval are small to achieve good accuracy.
A widely used leaping condition (Cao et al., 2006) is

E[|Xi(t+T)—Xi(t)l jacket-(0] : em), (1)

for all i and a small 6, say, in the range 0.01 ~0.1.

The r—leaping algorithm may not be reliable if any x,- is small. In our
model of cancer development, it is common to have some x,- ~ (9(1) (e. g. the
occurrence of mutation creating a new cell type), and thus the r—leaping
approximation cannot be applied directly.

2.3 A novel hybrid algorithm

The exact method is very inefﬁcient as the step size is of 0(1/N). However,
the r—leaping algorithm is not directly usable as there may exist cell types with
very small population sizes. Naive use of the r—leaping algorithm may even
lead to negative population sizes. We thus implement a hybrid algorithm.
We partition the cell types into two subgroups depending on the population
size. We then use the exact algorithm to simulate events that involve any
small population, and r—leaping approximation to simulate events within each

large population. Similar ideas have been used to speed up the simulation of
multiscale chemical reaction systems (Haseltine and Rawlings, 2002).

Acell type i belongs to the major set E if xi(t) > NC, where NC is a threshold
value, or to the minor set 0 otherwise. We set NC = 10 in our implementation.
We further partition the possible events into the non—critical set 52, which
changes only the major cell types, and the critical set A, which changes at
least one minor cell type.

The algorithm is as follows:

ALGORITHM 2. The hybrid algorithm
Initialization: Set i=0 and initial state X (0)=(N ,0, ...,0). Store the state—

change vector vk,k= 1, ...,m2.

(1) Compute rates ak =ak(X(t)),k=1,...,m2.

(2) Partition the cells into the major and minor sets 2 and o.

(3) Determine the r—leaping step length t. See below for details.

(4) Determine the waiting time for the next critical event: e~exp(aA),
where aA = ZkeA ak.

(5) If e< r, simulate a critical event. Generate a random number u~
U(0, 1) and ﬁndj e A such that

j-1 j
2 61k SuaA < 2 61k.
k=1,keA k=1,keA
Let X * =X + vj.
Otherwise (if e Z I) no critical event occurs, and X * =X.
(6) Let h = min(r, e). Simulate non—critical events in 52 by r—leaping over
time h:

(a) Generate Poisson random variables rk ~ 79(akh), k e 52.

(b) Let X/=X*+Zrkvk.
keSZ
(7) Update time t’ =t+h. If xm(t’)>0, set Tmzt’ and stop. Otherwise
go back to step 1 with t=t/.

We determine the r—leaping step length r by applying the r—leaping
condition [Equation ( 1)] to the non—critical events. The rate at which x,-
decreases by one is xi(1—x,-/N)+x,-u,-. [xi cells of type i are dying with rate
xi, and the probability that the new born cell is of the same type is xi/N.
Meanwhile x,- cells of type i mutate to type (i+ 1) cells at rate xiui.] The
rate that x,- increases by one is xi(1—x,-/N)+x,-_1u,-_1. [N —x,- cells whose
types are not i are dying with rate N —x,-, and the probability that the dying
cell is replaced by a type i cell is xi/N. Meanwhile xi_1 cells of type (i — 1)
mutate to type i cells at rate xi_1u,-_1.] Because mutation events usually
occur slowly (u,- << 1), we ignore them here. For a similar reason, we ignore
selection here. Then x,- increases or decreases by one with rate (N —x,-)x,- /N.
This rate may be assumed to be approximately constant in the time interval
[t,t+r] when r is small. Let

X,+(r) :=tl{s 6 [t,t+r) :Xt(s)—Xt(s—)= 1}
and
X,_(r):= ti{s e [tat+T)1Xi(S)—Xi(S—)= —1}
be the numbers of events that increase and decrease type i cells in the time
period [t, t+ 1), respectively. Then we have

E[|Xi(I+T)—Xi(t)l‘Xi(t)=xi(t)]
= 1E[IX,-+(r)—X;(r)l in(t)=x.-(t)]
: 1E[X,+(r)th(t)=xl-(t)]+1E[X;(r)th(r)=xt(t)]
= 1E[7D(t(N—x,-)x,-/N)]+1E[7D(t(N—x,)x,/N)]

S 25%.

Thus, Equation (1) is satisﬁed as long as TEE/2. In all of our numerical
examples, we choose €20.04 so that the leaping step length is $20.02.

 

839

112 /§.IO'SIBUJHOprOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

'IZZhu et al.

 

Table 1. Parameters used in Figure 1

 

 

(a) (b) (0)
Population size (N) 103 104 106
Mutations to wait (m) 20 3 3
Mutation rate (it) u,-=10-3 u,-=10-4 ,.t,-=10-6
Fitness (1+s) 1+s,-=(1+0.01)i 1 1

 

3 RESULTS AND DISCUSSION
3.1 The performance of the hybrid algorithm

3.1 .1 Accuracy In the ﬁrst experiment, we examine the accuracy
of our new hybrid method by comparison with the exact method for
small N, and with an asymptotic result for large N. The parameters
are shown in Table 1. For cases (a) and (b) of Table 1 with N: 103
or 104, the estimated probability density functions using the hybrid
method are indistinguishable from those produced using the exact
method (Fig. 1a and b). For case (0) with N = 106, the exact method
is too slow to produce many samples, so we compare the hybrid
method with an asymptotic result given in Schweinsberg (2008),
which states that for a constant mutation rate and neutral evolution,
if lim ,usN =A, then
N —> 00

3/4 t1_e—25
 T3>I)—>6Xp  mds

(Schweinsberg, 2008: Theorem 3 or case u~AN ‘1 on p. 1451).
Figure lc shows that the hybrid method and the asymptotic
approximation produced nearly identical results. N: 104 is
apparently too small for the asymptotic approximation to be reliable,
as the approximation produced quite different (much shorter)
waiting time compared with the exact and hybrid algorithms in
Figure 1b.

3.1.2 Computational eﬁiciency We compared the computational
efﬁciency of the hybrid and exact methods, by simulating 100
samples using both methods and measuring their computational
time and average step sizes. The range of population size N is from
103 to 106. Other parameters are ﬁxed at ,ui = u: 1 /N, m=4 and
1+si = (1 +001)" . The results are shown in Table 2. As N increases,
the time taken by the exact method increases much faster than by
the hybrid method . For the exact method, the average step size is
of order O(NT1), while for the hybrid method it remained nearly
constant.

3.2 A variable population size Moran model

To model the growth of a benign tumor (adenoma), we develop
a Moran model of variable population size, with the total
population size growing deterministically. The evolutionary process
is described by a birth—death process. Three kinds of events are
possible in the system:

(1) A type i cell mutates into a type (i —l— 1) cell, with rate a?” 2 Mix,-
and state—change vector v ,- =£ ,- +1 —£,-.

glzxi and state—change vector

(2) A type i cell dies with rate a
vi = 43 i-

<a) 

 

— exact
A --- hybrid
\

probability density
4e 04 6e-04
I

2e-04

 

 

 

0e+00

I I I I I
2000 3000 4000 5000 6000

time

(b)

 

0.0020

— exact
 --- hybrid
1‘ ---- -- asymptotic

 

probability density
0 0010 0.0015
I I

0.0005
I

 

 

 

 

 

0.0000

0 5000 10000 15000

time

(c )
- — — hybrid
---- -- asymptotic
I, ’
I
I

 

1.5e-05
I

1 .0e-05
I

probability density

5.08-06
I

 

 

 

 

0.0e+00

| I I
0 50000 100000 150000 200000

time

Fig. 1. Estimated probability density function of the waiting time T m
generated by the hybrid method in comparison with the exact simulation
(3 and b) and asymptotic result (b and c). The density functions are estimated
using kernel density smoothing in R, with 2 x 105, 2 x 105 and 105 samples
for (a), (b) and (c), respectively. The parameters used are listed in Table 1.

Table 2. Time (in seconds) taken and average step sizes of the exact and the
hybrid methods for simulating 100 trajectories

 

N=103 N=104 N=105 N=106

 

Time Exact o 111 1595 19414
Hybrid 5 19 4o 83
Step size Exact 3.13e—003 3.67e—004 4.46e—005 5.45e—006

Hybrid 0.0108 0.0104 0.0102 0.0101
Average Tm 412.9 827.6 1326.9 2056.7

 

The mutation rate ul- = u is chosen to satisfy uN = 1. The number of mutations to cause
cancer is m=4 and the ﬁtness is 1+s,- = (1 +0.01)’.

 

840

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJO}UIOIQ//Zd11q 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Efficient simulation of carcinogenesis

 

0.0030

 

— original Moran + exact
-- VP-Moran + exact
---- -- VP-Moran + hybrid

 

probability density
0.0010 0 0015 0.0020 0.0025
I I I I

0.0005
I

 

 

 

0.0000

| | I
0 500 1000 1500

time

Fig. 2. Probability density function of waiting time T3 under the original
Moran model sampled by the exact method and under the variable population
size Moran model sampled using both the exact and hybrid methods. The
population size is N (t)=N = 1000. The mutation rate 11,210—3 and there
is no selection (51-20). The densities are estimated using kernel smoothing
with 105 samples.

(3) A type i cell is born with rate a? =N(t)(1—l—
si)xi/Zk(1+sk)xk and state—change vector v,- 28,-.

Here N (t) is not the real population size but the real population
size N (t) ﬂuctuates closely around N (t). To see this, note that when
N (t) <N (t), the total birth rate [which equals N (t)] will be larger
than the total death rate [which equals N (t)], so that N (t) will
increase. Otherwise, N (t) will decrease. Note that even if N (t) =N
is a constant, the new model still differs from the original Moran
model. In the latter, the real population size is strictly constant, where
in the new model it ﬂuctuates around N (t). There are 3m event types
in the new model compared with m2 in the original model. When m
is large, the new model is faster to simulate than the original Moran
model as determining the type of event requires fewer comparisons.

We note that a slightly different variable population size Moran
model was described by Durrett and Mayberry (2009), in which new
individuals are added into the population at a certain rate.

Two numerical examples are presented, to show (i) that the
variable population size Moran model approximates the original
model well when N (t) =N and (ii) the real population size can be
controlled effectively by N (t).

In the ﬁrst example, we let N (t) =N and use the exact algorithm
to simulate under the original Moran model, and both the exact and
the hybrid methods to simulate under the variable population size
Moran model. The estimated densities for the waiting time T3 are
indistinguishable among the three methods (Fig. 2). The variable
population size Moran model approximates the original model very
well.

In the second example, we demonstrate that N (t) can effectively
control the population size. We let N (t) grow logistically from 104
to 106 with N(t)=KNOe"/(K—l—(Noe" — 1)) with N0 = 104, K: 107
and r = 0.001. Figure 3a gives one sampled trajectory, sampled every
100 days. We can see that N (t) and the real population size N (t) are
indistinguishable. Figure 3b plots the step sizes for the exact and
hybrid algorithm. For the exact method, the step size is of order 1 /N,
so that the step size gets smaller as the population size increases.
For the hybrid method, the step size remains at the leaping step size
‘L' = 0.02.

 

 

 

 

 

 

 

 

 

 

 

C
.9
13 4,.
5 10 ‘-
D.
O
D.
103-
102-
—N(t)
1 —N(t)
1o 0
i
o % 3| I I l I I I \I/
10 ’l‘
0 2000 4000 6000 8000 10000 12000 14000 16000
time
(b) 10°
-2 1..
10 In” D u E I:
10‘4
‘1)
.u
U)
D.
(D
175

exact
_10 U hybrid

O 2000 4000 6000 8000 10000 12000 14000 16000
time

 

 

 

Fig. 3. (a) A trajectory simulated under the variable population size Moran
model with N (t) changing according to a Logistic growth curve. Samples
are taken once every 100 days. N (t) and the real population size N (t) are
indistinguishable on the plot. (b) The step lengths for the exact and hybrid
methods for the simulation of (a).

3.3 Traveling waves of genetic adaptation

Beerenwinkel et al. (2007) conducted computer simulations to study
the waiting time to m = 20 mutations in a Wright—Fisher model
of growing population size. The model mimics a colonic adenoma
composed of 106 cells (~1 mm3) initially that grows exponentially
to reach a size of 109 cells (~1 cm3) in about 12 years. Based on the
data of Sjéblom et al. (2006), it is assumed that cancer will develop
as soon as a cell accumulates m=20 mutations in any of the 100
susceptible genes. Mutations occur in unmutated genes at the rate of
,ug = 10‘7 per gene, with no back mutation. If any i of the 100 genes
experience mutations, the cell will be of type i. The ﬁtness of a type
i cell is l—l—si = (1 —l— y)’, where y = 0.01. Beerenwinkel et al. (2007)
used the Wright—Fisher model as it allowed fast simulation even for
large populations although the Moran model seemed more natural
for cancer progression. Here, we use the new hybrid algorithm to
simulate a similar process under the variable population Moran
model.

We use N (t) =N0exp(0tc7)t), where at = 0.0015 controls the growth
rate and c7): Zi(1+si)xi/Zixi is the average ﬁtness of the
population. A simulated trajectory is shown in Figure 4, which shows
a pattern of traveling waves of clonal expansion. This is because a
type i cell created by a new mutation in a population of type (i — 1)
cells has greater ﬁtness and is thus driven to ﬁxation by natural

 

841

112 /§.IO'SIBUJHOIpJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

'IZZhu et al.

 

 

 

O

otal

OmﬂmmAwN—‘O

Population size

00000
.1
‘1

 

 

 

 

 

Fig. 4. A sampled trajectory of the evolutionary process of cancer initiation.
The total population size is growing exponentially from 106 to 109 in about
12 years. Cell types with many mutations and thus high ﬁtness are taking over
the population successively in a pattern of traveling waves. The mutation rate
is Mg :10-7 per gene and there are 100 susceptible genes, so that a type i
cell mutates into a type (i+ 1) cell at rate it,- =(100—i)ug. The ﬁtness for
type i cells is 1+s,- =(1+y)i, with y=0.01. The parameters used here are
from Beerenwinkel et al. (2007).

 

 

 

 

 

 

§ _ N=107
o- y= 0.01
(O
O
Q _
O
a
17:
C
(D
'0
E v N =105
_Q 0
g 0. - y=0.01
o O
a
N =107
y = 0.001
N
O
o _
o"
O
0
g I I I I I
0 1000 2000 3000 4000 5000

time

Fig. 5. Probability density function of T 20 for different population sizes (N)
and selection coefﬁcients (si), estimated using kernel smoothing from 105
samples. The parameters used are as follows: u,=(100—i)ug with Mg:
10-5 and 1+s,-=(1+y)i with y=0.01.

selection, until the next mutation creates an even ﬁtter type (H— 1)
cell. This interesting phenomena is described earlier by Rouzine
et al. (2003) in a model of asexual evolution and has recently been
investigated analytically by Durrett and Mayberry (2009).

Figure 5 shows the probability density functions of T20, the
waiting time for 20 mutations. The model used is similar to that
in Figure 4, but here we ﬁx N in the variable population size Moran
model at 105 or 107. The selective beneﬁt of each new mutation
is y=0.01 or 0.001, and the mutation rate for each of the 100
susceptible genes is 1158:10—5 . While the waiting time is much
shorter for larger N, selection has much greater impact on the waiting
time.

4 CONCLUSIONS AND PERSPECTIVES

We have developed a new hybrid algorithm for simulating the Moran
model of carcinogenesis through accumulation of mutations. We
use the algorithm to study the waiting time until m mutations for a
range of population sizes. For small population sizes, our algorithm
produces results nearly identical to those from the exact algorithm.
For large populations, the exact method is too slow but the hybrid
method still works accurately and efﬁciently. We implement a new
Moran model of variable population size, which can effectively
control deterministically changing population sizes. Our simulation
model is general, allowing for arbitrary mutation rates and selective
coefﬁcients for different cell types. Those features of the algorithm
indicate that it may be useful for studying complex and realistic
evolutionary models of cancer initiation, which may be analytically
intractable.

Our new hybrid simulation algorithm may be extended to
accommodate more complex models of carcinogenesis. In particular,
the evolutionary model we have implemented assumes a well—
mixed tissue compartment without any spatial structure, in which
all cells are in direct reproductive competition with each other.
For certain types of cancer, it may be more realistic to model
cellular differentiation and spatial structure explicitly, with stem
cells generating somatic cells that undergo apoptosis in different
compartments.

ACKNOWLEDGEMENT

We thank for anonymous referees for many constructive comments.

Funding: National Science Foundation of China (Grant
No. 10871010); National Basic Research Program (Grant
No. 2005CB321704) to Y.H. and TL; MOST (Grant No.
2006CB805901 to D.Z.) in part K.C. Wong Education Foundation,
Hong Kong (to Z.Y.).

Conﬂict of Interest: none declared.

REFERENCES

Armitage,P. and Doll,R. (1954) The age distribution of cancer and a multi-stage theory
of carcinogenesis. Br. J. Cancer, 11, 161—169.

Beerenwinkel,N. et al. (2007) Genetic progression and the waiting time to cancer. PLoS
Comput. Biol, 3, 2239—2246.

Cao,Y. et al. (2006) Efﬁcient step size selection for the tau-leaping simulation method.
J. Chem. Phys., 124, 44109—44119.

Calabrese,P. et al. (2005) Numbers of mutations to different types of colorectal cancer.
BMC Cancer, 5, 126—132.

Durrett,R. and Mayberry,J. (2009) Traveling waves of selective sweeps. Arxiv preprint
arXiv:0910.5730.

Durrett,R. et al. (2009) A waiting time problem arising from the study of multi-stage
carcinogenesis. Ann. Appl. Probab, 19, 676—718.

Forbes,S.A. et al. (2010) COSMIC (the Catalogue of Somatic Mutations in Cancer):
a resource to investigate acquired mutations in human cancer. Nucleic Acids Res.,
38, D652—D657.

Gibson,M.A. and Bruck,]. (2000) Efﬁcient exact stochastic simulation of chemical
systems with many species and many channels. J. Phys. Chem. A, 104, 1876—1889.

Gillespie,D.T. (1976) A general method for numerically simulating the stochastic time
evolution of coupled chemical reactions. J. Comput. Phys., 22, 4034134.

Gillespie,D.T. (1977) Exact stochastic simulation of coupled chemical reactions.
J. Phys. Chem, 81, 2340—2361.

Gillespie,D.T. (2001) Approximate accelerated stochastic simulation of chemically
reacting systems. J. Chem. Phys., 115, 1716—1733.

Gillespie,D.T. (2007) Stochastic simulation of chemical kinetics. Annu. Rev. Phys.
Chem, 58, 35—55.

 

842

112 /§.IO'SIBUJHOIpJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Efficient simulation of carcinogenesis

 

Haseltine,E.L. and Rawlings,].B. (2002) Approximate simulation of coupled fast
and slow reactions for stochastic chemical kinetics. J. Chem. Phys., 117,
6959—6969.

Iwasa,Y. et al. (2004) Stochastic tunnels in evolutionary dynamics. Genetics, 166,
1571—1579.

Iwasa,Y. et al. (2005) Population genetics of tumor suppressor genes. J. Theor. Biol,
233, 15—23.

Jones,S. et al. (2008) Core signaling pathways in human pancreatic cancers revealed
by global genomic analyses. Science, 321, 1801—1806.

Knudson,A.G. (1971) Genetic instabilities in human cancers. Proc. Natl Acad. Sci. USA,
68, 820—823.

Lengauer,C. et al. ( 1998) Genetic instabilities in human cancers. Nature, 396, 643—649.

Li,T. (2007) Analysis of explicit tau-leaping schemes for simulating chemically reacting
systems. Multiscale Model. Simul., 6, 417—436.

Michor,F. et al. (2004) Dynamics of cancer progression. Nat. Rev. Cancer, 4,197—205.

Moran,P. (1958) Random processes in genetics. Math. Proc. Camb. Phi. Soc, 54, 60—7 1.

Parsons,D.W. et al. (2008) An integrated genomic analysis of human glioblastoma
multiforme. Science, 321, 1807—1812.

Rouzine,I.M. et al. (2003) The solitary wave of asexual evolution. Proc. Natl Acad. Sci.
USA, 100, 587—592.

Schweinsberg]. (2008) The waiting time for m mutations. Electron. J. Probab, 13,
1442—1478.

deblom,T. et al (2006) The consensus coding sequences of human breast and colorectal
cancers. Science, 314, 268—274.

Tomlinson,I. et al. ( 1996) The mutation rate and cancer. Proc. Natl Acad. Sci. USA, 93,
14800—14803.

Wood,L.D. et al. (2007) The Genomic landscapes of human breast and colorectal
cancers. Science, 318, 1108—1113.

 

843

112 /§.IO'SIBUJHOIpJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

