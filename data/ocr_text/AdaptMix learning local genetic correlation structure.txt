Bioinformatics, 31, 2015, i181—i189
doi: 10.1093/bioinformatics/btv230
ISMB/ECCB 2015

 

Adapt-Mix: learning local genetic correlation
structure improves summary statistics-based
analyses

Danny S. Park‘, Brielin Brownz, Celeste Eng3, Scott Huntsman3,
Donglei Hu3, Dara G. Torgerson3, Esteban G. Burchard1'3 and
Noah Zaitlen1'3'*

1Department of Bioengineering and Therapeutic Sciences, University of California San Francisco, San Francisco,
2Department of Computer Science, University of California Berkeley, Berkeley and 3Department of Medicine,
University of California San Francisco, San Francisco, CA, USA

*To whom correspondence should be addressed.

Abstract

Motivation: Approaches to identifying new risk loci, training risk prediction models, imputing
untyped variants and fine—mapping causal variants from summary statistics of genome—wide asso—
ciation studies are playing an increasingly important role in the human genetics community.
Current summary statistics—based methods rely on global ‘best guess’ reference panels to model
the genetic correlation structure of the dataset being studied. This approach, especially in admixed
populations, has the potential to produce misleading results, ignores variation in local structure
and is not feasible when appropriate reference panels are missing or small. Here, we develop a
method, Adapt—Mix, that combines information across all available reference panels to produce
estimates of local genetic correlation structure for summary statistics—based methods in arbitrary
populations.

Results: We applied Adapt—Mix to estimate the genetic correlation structure of both admixed and
non—admixed individuals using simulated and real data. We evaluated our method by measuring
the performance of two summary statistics—based methods: imputation and joint—testing. When
using our method as opposed to the current standard of ‘best guess’ reference panels, we
observed a 28% decrease in mean—squared error for imputation and a 73.7% decrease in mean—
squared error for joint—testing.

Availability and implementation: Our method is publicly available in a software package called
ADAPT—Mix available at https://github.com/dpark27/adapt_mix.

Contact: noah.zaitlen@ucsf.edu

 

1 Introduction

 

Summary statistics of association tests, such as effect size estimates
and their standard errors, are becoming the datatype of choice in
many genetic analyses due to two significant advantages. First, sum—
mary statistics—based methods are generally orders of magnitude
faster than their genotype—based counterparts. The rapidly increas—
ing size of existing and planned cohorts is causing computational
bottlenecks for some standard analyses. Second, analyses of sum—
mary statistics are often a necessity since access to individual—level
data is complicated by privacy and other issues (Gymrek et 61].,
2013). Publication of summary statistics is now required for all
Nature Genetics genome wide association study (GWAS) papers,

©The Author 2015. Published by Oxford University Press.

and these statistics have already been released for a large number of
traits. For these reasons, a growing number of summary statistics—
based methods, including imputation of z—scores, joint—testing, fine
mapping of causal variants, quality control of GWAS results and
gene—based tests, have recently been published (Bulik—Sullivan et 61].,
2014; Han et al., 2011; Hormozdiari et 61]., 2014; Kichaev et 61].,
2014; Liu et 61]., 2010; Pasaniuc et 61]., 2014; Yang et 61]., 2012).
Moving forward, the integration of summary statistics will be vital
for increasing our knowledge of various complex diseases and
phenotypes (Schork et 61]., 2013).

Summary statistics—based methods typically require estimates of
linkage-disequilibrium (LD) between markers as input. Existing

i181

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

1e /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeorumoq

9IOZ ‘09 lsnﬁnv uo ::

i182

D.S.Park et al.

 

tools use ‘best guess’ reference panels to estimate LD (Han et al.,
2011; Kichaev et al., 2014; Pasaniuc et al., 2014; Yang et al., 2012).
For example, Yang et al. (2012) used European ancestry individuals
from the Queensland Institute of Medical Research reference panel
to estimate LD for an analysis of statistics produced from the
European ancestry GIANT consortium (Speliotes et al., 2010). This
approach is not optimal and has the potential to produce misleading
results in the case of admixed populations. Admixed individuals’
genomes can be viewed as mosaics, where different segments of the
genome are derived from various ancestral groups. Previous work
has shown that the proportions of ancestry for individuals from
admixed populations are highly variable (Bryc et al., 2010; Silva—
Zolezzi et al., 2009; Wang et al., 2008). Given this high variability
in admixed populations, ‘best guess’ panels are more likely to have
LD estimates that are not in concordance with original datasets and
which vary in their local structure. This will be especially true if the
population of interest has no reference panel available.
Furthermore, several genotype—based methods have shown that
learning local structure from multi—population reference panels im—
proves performance even in the case of homogenous study popula—
tions (Howie et al., 2009; Pasaniuc et al., 2013).

In this work, we develop a method, Adapt—Mix, to accurately es—
timate the local single—nucleotide polymorphism (SNP) correlation
matrix for each region of the genome from summary statistics of an
arbitrary population study. We compute the correlation matrix
using a mixture of existing reference panels, such as the 1000
Genomes Project Consortium (2012), where the mixture proportion
for each reference population is learned from summary statistics.
Unlike previous approaches, our method incorporates data from
multiple reference panels when computing the correlation matrix
and allows for adaptation to local structure. We first provide a
closed form solution for the expected correlation structure from a
mixture of populations in a genomic locus. Then, using this deriv—
ation, we efficiently search for the mixture of populations in each
genomic locus that maximizes/minimizes an objective function most
relevant to the problem in question. For example, in this work, we
consider the problems of imputation and joint—testing from sum-
mary statistics, using imputation error and j oint—test accuracy as the
objective function, respectively. In practice, arbitrary objective func—
tions can be used provided they can be computed efficiently.

We apply our method to summary statistics from simulated
phenotypes over real genotypes from the Genes—environments 8C
Admixture in Latino Americans (GALA II, Borrell et al., 2013) co—
hort that is composed of Mexican and Puerto Rican individuals. We
also apply our method to real coronary artery disease summary stat—
istics from the CARDIoGRAMplusC4D consortium (Coronary
Artery Disease (C4D) Genetics Consortium, 2011; Schunkert et al.,
2011). In the simulated datasets, we show significant improvements
in the mean—squared error (MSE) of our mixture correlation coeffi—
cients compared with the most relevant reference panels. We also
demonstrate the direct impact of the improved correlation estimates
for imputation and joint—testing methods, which take correlation
matrices as input. For both the simulated summary statistics over
the GALA II study as well as the meta—analysis results, we show sig—
nificant improvement in both summary statistics—based imputation
and joint—testing (Pasaniuc et al., 2014; Yang et al., 2012).

2 Methods

First, we describe the situation where Adapt—Mix may be applied.
We then derive a formula for the genotype correlation matrix as a

mixture of several reference populations and describe our procedure
for optimizing the mixture frequencies for various objective func—
tions. We end the section by discussing the simulation framework in
which we evaluate our method.

GWAS summary statistics typically consist of an effect size [3,-
and standard error 6,- for each SNP i examined in a study. For sim-
plicity, [3,- and G,- can be converted to a Wald test statistic (Z—score)

- - Inf-p:

z,. When dealing w1th case—control phenotypes z,- 2 Wm,
where N is the sample size, pf (pf) is the frequency of the reference
allele in cases (controls), and p,- is the overall frequency. For quanti—
tative phenotypes z,- : x/Ncorgij), where  are the genotypes of
the individuals and 67 are the phenotypes. Here,  : {g,1...g,-N} for
gid E {0, 1, 2}, gid being the count of the reference allele for individ-
ual d.

As input, most summary statistics—based methods take Z—scores
and a correlation matrix 2 (Bulik—Sullivan et al., 2014; Han et al.,
2011; Hormozdiari et al., 2014; Kichaev et al., 2014; Liu et al.,
2010; Pasaniuc et al., 2014; Yang et al., 2012). For each pair of
SNPs i, j, the correlation matrix has the value 21,-,- = 17,-, where 19-,- is
the Pearson correlation coefficient between the SNPs in the study. If
individual level genotypes are available, the correlation can be com—
puted by r),- : cor(§,-,  When individual level genotypes are un—
available, r,,- is typically estimated using a reference panel of
genotypes from a population similar to the source population of the
data being analyzed. In this work, we develop a method to provide a
better estimate of 13-,- using a combination of reference panels from
different populations. Given a set of K reference populations, we
generate a correlation matrix for each genomic locus using a new
mixture population, where the frequency of population [a E K in the
mixture population is fk. The objective of our work is to select the
frequencies, fk, that optimizes the performance of the summary stat—
istics method of interest.

2.1 Estimating the mixture correlation matrix
Given a set of mixture frequencies, I? : {f1, . . . , fK}, where fk E I? is
the frequency for population [a E K. We wish to compute the ex—
pected correlation between each pair of SNPs in the mixture popula-
tion. For simplicity, we begin by deriving the mixture variance of
the allele frequencies (61-2) at SNP i, in a mixture population com—
posed of two reference populations. At SNP i, the two reference
populations will have separate variances (6%,, 6%,), sample sizes (n1,
112) and allele frequencies (p1,, p2,).

Additionally, assume that each reference population has a mix—
ture frequency equal to their proportion of sample size, i.e. f1

 

_ 7’11 _ n2 . .
— 111+,” and f2 — —m +112. We can then express the mixture variance as

1

M:

(glz — 21ml + z <ng — 22202
2 z 1 q=1

’ ("1 + "2)

 

where gkd is the genotype of individual d in population 13, and
2p,- : [(12191) —1— [(22192) is the genotype frequency in the mixture popu—
lation. Let us now consider only 22:1(g1z — 21),)2. This term is
equal to

:Kgu — 21911) + (2190 — ZPiHZ
z=1

= 2(g1z — 219102 + 711(21111' — 21902 = 7110i- + 711(21111' — 21102

z=1

1e /§JO'Sjeu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Adapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i183

 

Applying the same logic to 23:1 (gzq — 2p2i)2, we arrive at the
formula for the variance for the mixture population.

 

2 : mo'j, + mai- + 711(21111' — 21902 + 712(21921' — 21102
1 111 -l— n2 111 -l— 712

=f10iz+f1(2191z— 21191)2 +1302,- +f2(2P2i — 2191)2

We now extend from 2 to K populations. Suppose we have a set of
reference panels representing K populations and their corresponding
mixture frequencies, 1?. Then for SNP i in population [a E K, let 6%,.
be the variance and 2m,- be the frequency. The frequency in the mix-
ture population is then 2}),- : 25:1 fk2pki and the combined vari—
ance at SNP i is

7’11

0'12 : f1:(g1z — 21902 + ‘ ‘ ' + fKZ(gKl — 21902
1:1

z=1

= [(10%) + f1 (2121,- — 212,-)2 + - - - +fKU%<i +f1<(2p1<,- — 21102 (1)

K
= kalaiz + 4(sz — 1902]
k=1

Next, we derive the covariance between SNPs i and j in the mix-
ture population. If x and y are random variables, 0%”, : coz/(x —l— y,
x —l— y) : cov(x,x) —l— coz/(y, y) —l— cov(y,x) —l— cor/(x, y) : 6% —1— 65—1— 2

2 _ 2_ 2
cal/(x, 3’) and thus cot/(x, 3’) 2 GM 26" 6y

Let cor/k0, j) be the covariance of SNPs i and j in population la.
Then the covariance in the mixture population is:

2 2 2
i+i_0i ‘0']

260v(i7j)i7£j 2 l0" ,

K
= 21% { [0%,- + 0i,- + 260104131) + 4(Pk(i+i) — P(z+i))2l
k=1
— [0%,- + 4(pki — 12021 — [0%,- + 4m,- — 12021}
K 2
= ka{[0ii + 0i,- + 260104131) + 4((Pki — 190+ (Pk) — Pi» l
k=1

— [0%,- + 4(sz — 1902] — [0%,- + 4(ij — 1902]}
K
=> 601/070272; = 21% [GOV/{(131) — 4(sz — EXP/e) — Pill
k=1

By definition, the mixture correlation matrix is

2.,- =  (2)
01-2072

Algorithm 1 details our procedure for computing the mixture
correlation matrix over a set of SNPs. Given K populations and M
SNPs, it takes as input the mixture frequencies (1?), a matrix of SNP
variances (VKXM : {oki}), a matrix of the pairwise SNP covariances
(CKXMXM : {covk(i,j)}) and a matrix of the genotype frequencies

(PKXM : {2pk,}) and outputs the mixture correlation matrix.

 

Algorithm 1 Create Z

NegWeightedGT : P  — 1)T]
D : empty K x M matrix
for all la in  do
Dk : NegWeightedGTk —l— sum(WeightedGT1), VI 7E 13

# Compute mixture variances

MixVar : (D2 —l— V)

# Compute mixture covariances
MixCov 2 empty K x M x M matrix
for all la in  do
WP = fk * (Ck + [Die ® Dkl)
MixCoz/ : C —l— tmp

# Compute mixture correlations
denominators : (/ (MixVar ® MixVar), DSquare—root applied
element—wise

Z : MixCov/ denominators D Element—wise division

 

2.2 Optimization of mixture frequencies

Given this algorithm for computing the correlation matrix 2 of the
mixture population over a set of SNPs, we turn to the problem of se—
lecting the mixture frequencies 1?. We formulate this as a constrained
optimization problem: minimizing (or maximizing) the value of a
given objective function subject to the constraint that 2 f = 1 using
the L-BFGS algorithm (Byrd et al., 2006). In this context, the ‘best
guess’ approach corresponds to setting fk : 1 for the guessed popula—
tion and  = 0 Vi 7E la. In this work, we consider the problems of im-
putation and joint—testing from summary statistics and therefore
selected the MSE of imputed z—scores at observed SNPs and MSE of
computed joint—test statistics as our objective functions, respectively
(see Sections 2.3 and 2.4). However, other objective functions may
be more appropriate depending on the purpose of the summary stat—
istics—based method. For example, one could chose to maximize the
likelihood of the observed z—scores 2 under a multivariate normal
distribution.

To allow for variation in local correlation structure, the genome
is separated into W equally sized non—overlapping windows. For
each window, w E {1...W}, we compute the correlation matrix
using only SNPs in w, 2W). Using Ea”), z—scores are imputed for all
SNPs in w and the imputed values are used to compute the MSE
from the true z—scores. We exclude SNPs from 2W) with a minor al-
lele frequency (MAF) less than 0.01 in any of the [3 populations,
missing z—scores, r2 g 0.003, or an undefined r with the SNP we are
imputing. These SNPs are excluded because they only add noise to
the imputation process. To ensure that Z is invertible, 2» is added to
the diagonal of the matrix. The final correlation matrix is then
2 : Zunadj +21. Zunadj is the original correlation matrix prior to
adding 2». The exact algorithm to compute the imputation MSE for a
set of SNPs in a window is described in Algorithm 2.

 

Algorithm 2 MSE objective function

 

 

Input: ,7, v, C, P
Output: 2
# Normalize mixture freqs. so they sum to 1

—§ —§ —§

f=f/sum(f)

# Compute adjustment factors for mixture variances
WeightedGT : P (fT),

Input: ,7, v, C, P, windowSize, 2, 2
Output: meanSquaredError
# Normalize mixture freqs. so they sum to 1

f = fume”)

# Compute number of windows
windows : [my/9(2) /windowSize

1e /§JO'Sjeu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

i184

D.S.Park et al.

 

# Initialize numerator and denominator of MSE
numerator : 0
denominator : 0

for all q E  do
# Compute Sigma using SNPS in window q
2”) : Create 20?, W”, C(q),P(q)), see Algorithm 1
2(61) 2 2(61) + M

# Impute SNPs in the window
for all s E {1...windowSize} do
z, = 2&1) [z§;1)]—1Z§q), Vt 7A 5
numerator : numerator —1— (z, — qu )2
denominator : denominator —l— 1
meanSquaredError : numerator/ denominator

 

The procedure we have described is easily extendable from a
window to any region, be it a whole—genome, chromosome or single
locus. In this case, I? is optimized by minimizing/maximizing the ob-
jective function over the sum of the non—overlapping windows. If
there are a large number of SNPs in the region of interest, the con—
vergence time of the algorithm will increase. To minimize the com-
putation time when optimizing over the entire genome, we selected
regions of the genome that have the largest absolute z-scores.
Specifically, for every set of five adjacent windows, we optimized
using the two windows with the largest number of z-scores
with >1.5.

2.3 Imputation

The z—score at a SNP i can be imputed from summary statistics and
the correlation matrix, 2, using the ImpG approach (Pasaniuc et al.,
2014). Pasaniuc et al. used a Gaussian approximation combined
with a windowing approach to impute the z—score at i. The window—
ing aims to decrease runtime and reduce statistical noise that might
be caused by distant SNPs with random non—zero correlation but no
true LD. Define it as the set of observed z—scores within a given
window size around i. The imputed z—score is then z,- = 2,2512, for
all SNPs t in the window.

2.4 Joint—testing

At genomic loci where two SNPs are negatively correlated, using a
marginal test often underestimates effect sizes (Galarneau et al.,
2010; Sanna et al., 2011; Yang et al., 2012). A joint analysis is more
powerful than a marginal test when analyzing such SNPs. Given two
z—scores computed at SNPs i and j using a marginal test, a X2 test—
statistic with 2 degrees of freedom, ],~,~ can be calculated as shown in
Equation (3).

1 2 2
iii = —2 (Z.- + Z,- — zziizizi) (3)
1 — 2,,
In our tests, the calculation of ],~,- is restricted to SNPs that have a
pairwise correlation |r| < 0.8 because small changes in r can cause
large fluctuations in ],~,- as |r| approaches 1.

2.5 Simulation framework

We simulated data using individuals from the Genes—environments
8C Admixture in Latino Americans (GALA II) cohort (Borrell et al.,
2013), which is composed of 1245 Mexican and 1785 Puerto Rican
individuals. The Mexican individuals have predominantly European
and Native American ancestry, whereas their Puerto Rican counter—
parts tend to have mostly European and African ancestry.

We conducted separate simulations for each group due to the differ—
ences in ancestry. We generated quantitative phenotypes and
z—scores for every non-overlapping window of 1000 SNPs. For each
window, a binomial trial (P = 0.01) was used to determine whether
the phenotype should be drawn from the null or alternate. Under the
null, individuals’ phenotypes were drawn from a N(0, 1). Under the
alternate, we assumed an effect size of 0.2 and drew individuals’
phenotypes from N(0.2g,-d, 1), where gid is the genotype of individ—
ual d at SNP i. The phenotypes were generated using the SNP in the
middle of each window, and z—scores were computed at all SNPs as
described in the introduction of Section 2.

2.6. Reference panels

Reference panels were generated using the 1000 Genomes (1KG)
Phase 3 data from the following 11 populations: CEU, IBS, FIN,
GBR, TSI, YRI, MXL, PUR, CHB, JPT and GIH. For each dataset
we analyzed (i.e. GALA II, CARDIoGRAMplusC4D), we removed
any A/T and G/C SNPs to avoid strand issues. We then took an
intersection of rsids between our data and the 1KG data to deter—
mine which SNPs to include in our reference panels. All SNPs for
the reference panels were coded as the number of reference alleles an
individual had (i.e. 0, 1 and 2).

3 Results

We applied Adapt—Mix to summary statistics from simulated and
real data to estimate the pairwise SNP correlation matrix (2). In this
work, we use z—score imputation and joint—testing. For both data—
sets, we used several approaches to estimate 2 and impute z-scores.
All imputation was done using a window size of 200 SNPs and
it : 0.1. The values for window size and it were chosen based on the
recommended settings used in Pasaniuc et al. (2014). We measured
the impact of using different methods to estimate 2 on z—score im-
putation by computing the MSE and Pearson correlation coefficient
(r) between the imputed z—scores and true z—scores. In addition to
imputation, we also performed joint—testing in the simulated data
because we had access to the individual genotypes and thus they
could compute the true SNP correlation matrix. Again, we measured
the effect of several 2 estimation methods on joint—testing by com—
puting the MSE and r between the true joint statistics and the esti—
mated joint statistics.

3.1 Simulated data

Simulated z—scores from the GALA II genotypes (see Section 2.5 ) were
used to determine whether our method gave more accurate results for
(i) imputing z—scores and (ii) computing joint—test statistics. Since there
are multiple ways to optimize mixture frequencies using Adapt—Mix,
we compared the use of several optimization strategies against the
‘best guess’ approach. Using Adapt—Mix, we estimated 2 using 1KG
reference panels by optimizing over each chromosome (1KG-Chrom),
over the whole genome (1KG—Genome) and per window (1KG—
Window). We note that any SNP used to measure imputation quality
was excluded during optimization. Additionally, to evaluate how our
method affects imputation and joint—testing when a ‘best guess’ panel
is unavailable, we removed both MXL and PUR panels and optimized
frequencies over the chromosomes (1KG—No—PUR—MXL).

3 . 1 . 1 Population Frequencies

We applied our method to simulated data over Mexican and Puerto
Rican individuals from the GALA II cohort (Borrell et al., 2013).
Figure 1 shows the average frequency assigned to each population

112 /§JO'Sjeu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Adapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i185

 

0.0?4 0.000 0.050 0.0T3 0.005 0.033

0.002 0.103 0.054 0 001 0.005 0.100

0.110 0.144 0.101 0.10? 0.124 0044 NA

0.135 HATE 0.002 0.132 0.140 0.131 NA

0.154 0.139 0.000 0.13? 0.133 0.001 0.032

:1 w z n: t r —I
m g a m e e x
i.) {5 E

 

0.0?0 0 000 U 03? GALA MK

0 02? r: are 0 020 GALA PR

NA 0.102 0.135 0.00? GALA MK ND MXUF’UR

NA 0.005 0.001 0.00 GALA PR ND MXUPUR

0.041 0.041 [1041 0.154 040

III 1—
I CL
D _.II

PUR
GIH

Fig. 1. This heatmap shows the average mixture frequency assigned to each reference population when optimizing over independent chromosomes for various

datasets

when frequencies were optimized per chromosome. When matching
reference populations are included in the optimization (MXL for the
Mexicans and PUR for the Puerto Ricans), nearly one—third of the
mixture is assigned to the matching reference panel. The rest of
the frequencies are distributed to populations in a similar manner to
the admixture proportions of each group (Baran et al., 2012).
Having predominantly Native American and European ancestry,
Mexicans have frequencies distributed among European and East
Asian panels in addition to MXL. However, when MXL and PUR
are not included, we see an increase in frequency assigned to the
East Asian panels. Puerto Ricans have more African ancestry than
Native American ancestry, and we observe a correspondingly larger
frequency of the YRI (African) panel and lower frequencies of East
Asian panels.

3.1.2 Imputation
We next evaluated the imputation performance of the different
approaches to estimating Z. We measured each method’s impact on
imputation by computing the MSE and Pearson correlation coeffi—
cient (r) between the imputed z—scores and true z-scores. We
imputed the z—score of the 100th SNP in every window. We re—
stricted our analysis to SNPs with an MAF Z 0.01 in the reference
panel since imputation quality tends to be poor for rare SNPs. We
also removed from 21 SNPs that had a r2 g 0.003 with the SNP we
were imputing. When using a mixture reference panel, we filtered
SNPs using a mixture MAF. The mixture MAF for SNP i is
21:21 koAFki, where fk is the mixture frequency assigned to popu—
lation k and MAF/2,- is the MAF of SNP i in la.

As the gold standard, the original GALA II genotypes were used
to estimate 2. It is clear from Tables 1 and 2 that using the original

Table 1. Performance of each reference panel when imputing z-
scores for GALA || Mexicans

 

 

Panel n MSE r

GALA II 2966 0.214 0.916
YRI 2572 1.11 0.499
MXL 2923 0.615 0.737
1KG—Genome 2836 0.484 0.807
1KG—Chrom 2898 0.451 0.818
1KG—Window 2836 0.438 0.824
1KG—No—MXL—PUR 2904 0.507 0.795

 

Table 2. Performance of each reference panel when imputing z-
scores for GALA 11 Puerto Ricans

 

 

Panel n MSE r

GALA II 3231 0.234 0.903
JPT 2572 0.884 0.626
PUR 3103 0.554 0.757
1KG—Genome 2759 0.587 0.760
1KG—Chrom 2906 0.473 0.800
1KG—Window 2839 0.467 0.804
1KG—No—MXL—PUR 2912 0.520 0.795

 

genotypes results in very high imputation quality. To demonstrate
that using the wrong reference panel can cause a huge decrease in
performance, we imputed z—scores using YRI and JPT as reference
panels for the Mexicans and Puerto Ricans, respectively. Using the

112 /§JO'Sjeu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

i186

D.S.Park et al.

 

wrong reference panel resulted in MSE increasing over 400% in the
Mexicans and over 250% in the Puerto Ricans.

Next, z—scores were imputed using Adapt—Mix to estimate LD.
We found that for imputation in admixed individuals, locally opti-
mizing mixture frequencies over each window performs the best.
For z—scores imputed over the whole genome, there is a 28.8% de—
crease in MSE for the Mexicans and a decrease of 15.7% for the
Puerto Ricans (Tables 1 and 2). Similar decreases in MSE are seen
when optimizing frequencies over the chromosome and the entire
genome. Even when MXL and PUR were removed, we see that our
method approach to estimating Z outperforms the ‘best guess’ panel.
We also see increases in the r of imputed and true z—scores in the
Mexicans and the Puerto Ricans when using Adapt-Mix. The in-
crease in r is equivalent to an increase of 25.0% and 12.8% in effect—
ive sample size for the Mexicans and Puerto Ricans, respectively.
Interestingly, the local optimization approach does not necessarily
find mixture frequencies that are closest to the study’s overall mix—
ture of ancestry. The results here indicate that using such a mixture
may not be the best for imputation accuracy and highlights the bene—
fits of using the correct objective function when optimizing mixture
frequencies for the selected summary statistics—based method.

3.1.3 Joint-test

Joint—testing of pairs of SNPs from summary statistics also relies on
estimates of the pairwise correlation between SNPs (Yang et al.,
2012). Using SNPs on chromosome 22, we computed true joint stat—
istics using 2 computed from the genotypes of the GALA II individ-
uals. The estimated joint statistics were computed using 2 estimated
using Adapt-Mix. The mixture frequency optimization strategies
were the same as those used in z—score imputation. We computed
Joint statistics for SNPS that had a MAF or mixture MAF 2 0.05 in
all of the Z estimation approaches. Tables 3 and 4 show that using a
Z estimated from a mixture reference panel results in increased per—
formance over using a ‘best guess’ reference panel.

In both populations, the frequencies optimized per chromosome
(1KG-Chrom) performed the best. Compared with using a ‘best
guess’ panel, we observed a 73.7% decrease in MSE for the
Mexicans and a 70.2% decrease in MSE for the Puerto Ricans. We
plotted the estimated joint statistics versus the true joint statistics for
Mexicans and Puerto Ricans for different choices of 2 (Fig. 2). The
results show that joint statistics computed using the combined refer—
ence panel are in higher concordance with the truth than the ‘best
guess’ panel. Remarkably, even when MXL and PUR are removed
from the mixture, estimates of Z improvements can be clearly seen
(Fig. 2c and d).

To show that the joint statistics produced by using our method
for estimating correlations are unbiased (i.e. EUij — fii] : 0), we
looked at the mean difference between the true statistics and esti—
mated statistics. Tables 3 and 4 show that the mean difference is
closer to 0 when our approach is used in both the Mexicans and

Table 3. Performance of each panel for the joint statistics on
chromosome 22 of the GALA || Mexicans (n:41 758)

Puerto Ricans. The 1KG—Chrom—based correlation estimates gener—
ated differences in true versus estimated that were the closest to zero
amongst all approaches. We can see from Tables 3 and 4 that 1KG—
Chrom has the smallest variance for the differences in true versus
estimated joint statistics. The ‘best guess’ panels had the highest
variance of all approaches except for 1KG—Genome in the Puerto
Ricans. Additionally, we examined all estimated joint statistics that
were more than 2 chi—squared units from the truth. In Mexicans, we
saw 122 such statistics for the MXL and 22 for 1KG-Chrom
(Fig. 3a). A similar trend is seen in Puerto Ricans as well, with 53
large deviations for the PUR and 3 for 1KG—Chrom (Fig. 3b). The
decrease in frequency and magnitude of large differences demon—
strates that using Adapt—Mix can help reduce the number of false
positives in a joint analysis using reference panels. However, high
deviations seen in both methods indicate that regardless of approach
there is potential to misestimate the pairwise correlation coefficients
of SNPs.

3.2 Real data

3.2.1 Population Frequencies

We applied our method to the C4D coronary artery disease dataset
from the CARDIoGRAMplusC4D consortium (CARDIoGRAM
plusC4D, Coronary Artery Disease (C4D) Genetics Consortium,
2011; Schunkert et al., 2011). In the C4D study, the discovery co—
hort consisted of 14 790 South Asians and 15 692 Europeans.
South Asians are known to have undergone admixture between two
ancestral populations, with one of the ancestral populations being
genetically similar to Europeans (Moorjani et al., 2013; Reich et al.,
2009). Consistent with the admixture seen in South Asians, we see
mixture frequencies for C4D that are assigned primarily to the
European and the South Asian panels (Fig. 1).

3.2.2 Imputation
The C4D data provided us with an opportunity to assess how our
method affects the performance of z—score imputation in the context
of a dataset with different population structure than that used in the
simulations. Unlike our simulations, where everybody was admixed,
the summary statistics in C4D were generated using a mixture of in-
dividuals with homogenous ancestries (Europeans) and heteroge—
neous ancestries (South Asians). As we did for the simulated data,
we used MSE and r of the imputed z—scores as our performance met—
rics. Here, we estimated 2 using a ‘best guess’ reference panel, 1KG—
Chrom and 1KG—Window. We chose to optimize frequencies for the
1KG reference panels over each chromosome and each window be—
cause these two approaches performed the best in our simulations.
We imputed the 100th SNP in each window and we restricted our
analyses here to SNPs that had (mixture) MAF Z 0.01.

As the ‘best guess’ reference panel for C4D, we used GIH and
CEU because the C4D discovery cohort was composed of roughly
an equal number of individuals with a European or South Asian

Table 4. Performance of each panel for the joint statistics on
chromosome 22 of the GALA 11 Puerto Ricans (n: 43715)

 

 

 

 

Panel MSE r Mean diff. Var. of diff. Panel MSE r Mean diff. Var. of diff.
MXL 0.116 0.988 0.042 0.114 PUR 0.057 0.994 0.023 0.057
1KG—Chrorn 0.031 0.997 0.004 0.031 1KG—Chrorn 0.017 0.998 0.004 0.017
1KG—Genome 0.048 0.995 0.008 0.048 1KG—Genome 0.070 0.993 0.018 0.069
1KG—Window 0.05 0.994 0.006 0.049 1KG—Window 0.042 0.995 0.012 0.042
1KG—No—MXL—PUR 0.057 0.994 0.005 0.057 1KG—No—MXL—PUR 0.032 0.997 0.008 0.032

 

 

1e /8JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Adapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i187

 

 

 

 

 

 

 

 

 

(a) GALA II “I
U _ .
N ' -
u .“ +r:‘- I“ +
L” _ ‘I 'II l.'|l- I +
F I‘ I I I. "
.2 1 it ' III-2"" +
E "‘n‘ 1'I II II: n.
4—- i' ' + " in I I v!
“a; . .. vii-I - - +
-I—- III: '1... "I'- l" -
0 3 e .' :" 5.: ‘
E 1'. 'i $101.-
I_ '- I‘Eii-l
t- '1".
1+ 1%.;- +
Ln —' I III!" I
-' Jr.
r ,: 
a _
l l l l l
0‘ 5 10 15- 20
Estimated Joint Staljsljc
GALA II M!
(C)
J' I ' I! _
In -* f' ._
1— — ‘l-' '._‘_I I. -
.9 '+ ' «Ii-M * '
E .‘u i' _ i '- -
i-I . - ' J
.E .3 '  . and ‘ -
‘E T' - ivy-il Spin-2:; I. 1'
{L1 .- +1 i . f2!” '.“
3 » Jhlll- _. ‘II- .. _ ,I
1. I '11“. ‘__$*r i,.'
F  3' r:
. Il"- -‘ ﬁtﬂ'.
If, _ r  I"? I.
I. -
_ ‘ 2-1.1:: -
$94.:-
I.
4:41:
." I
a _ .r
l l l l 1
0 5 10 15 20'
Estimated Joint Statistic

 

 

 

 

 GALAIIPR
D—
N
:2— . 
.2 .I'J.
m 'r- .:1
E ‘.
I- t .
Lr'.-— -*
D—
I I I I I
0 5 10 15 20

Estimated Jﬂir‘It Statistic

 

 

 

 

GALA || FR
(d)
a _
In _
.2
.15
.0
m
E
'5 I: _
ﬂ '1—
131
E
2|—
“: _
a _
I I I I I
0 E 10 15 20
Estimated Juint Statistic:

Fig. 2. Estimated joint statistic (X axis) versus the true joint statistic (y axis) in the GALA 11 individuals using 2 estimated from a ‘best guess‘ reference panel and
Adapt-Mix. (a) Joint statistics for the GALA || Mexicans using MXL (red) and 1KG-Chrom (blue). (b) Joint statistics for the GALA 11 Puerto Ricans using PUR (or-
ange) and 1KG-Chrom (blue). (c) Joint statistics for the GALA || Mexicans using MXL (red) and 1KG-No-MXL-PUR (gray). (d) Joint statistics for the GALA 11 Puerto

Ricans using PUR (orange) and 1KG-No-MXL-PUR (gray)

ancestry. When imputing we saw similar results to our simulations.
Compared to using CEU or GIH, there was a decrease of 30.1% or
36% in MSE, respectively (Table 5). In terms of r, we saw increases
of about 7% over CEU and about 9% over GIH for both 1KG-
Window and 1KG—Chrom. The increase in correlation is equivalent
to an increase of 15% in effective sample size compared to CEU.

4 Discussion

Summary statistics—based methods requiring an estimate of the gen—
etic correlation matrix are becoming increasingly popular; however,
very few GWAS include LD information in their released data. In
prior work, this information has been approximated by using LD in-
formation from ‘best guess’ reference panels, but here we show that

this can lead to high error rates even when a population closely
matching the study population is available (Zaitlen et al., 2009).
Our method can be used to improve the accuracy of any summary
statistics—based method that requires LD information by more accur-
ately estimating the local genetic correlation structure using infor-
mation available across several reference populations.

Our simulations have demonstrated the importance of accurately
estimating the genetic correlation matrix. Using Adapt—Mix to esti—
mate LD for summary statistics methods can increase their power
and decrease their false positive rates. For example, for z—score im-
putation, Pasaniuc et al. (2014) showed that as long as there is a
best guess reference panel available, there is no increase in false posi-
tive rate when imputing summary statistics. However, in the case
that there is no best guess panel available, we have shown that there

12 /8JO'S[eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬂdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

i188

D.S.Park et al.

 

(a)

:1-
no
G'—
to
r:
In
:.I
0'
'33]-
{In
D—
IN
D—

 

   

 

r10 "5 0 5 10

True joint statistic minus estimated joint statistic

 

 

 

 

 

(b)
D _
N
E _
s
E
3
El'
III
a E _
m _
D _ Fl
1 | | | |
'10 n5 0 5 10

Tme joint statistic minus estimated joint statistic

Fig. 3. Histogram of the deviations from the true joint statistic when using a ‘best guess‘ panel and Adapt-Mix to estimate 2 for joint-testing. (a) Joint testing for
GALA ll Mexicans. MXL deviations are shown in red and 1KG-Chrom is shown in blue. (b) Joint testing for GALA ll Puerto Ricans. PUR deviations are shown in or-

ange and 1KG-Chrom is shown in blue

Table 5. The performance of each reference panel when imputing
z—scores for the C4D dataset

 

 

Panel n MSE r

CEU 2637 0.379 0.813
GIH 2627 0.414 0.796
1KG—Chrom 2651 0.272 0.870
1KG—Window 2628 0.265 0.872

 

is a potential for increased false positives by using the wrong refer—
ence panel.

One of the biggest benefits of our method is allowing the analysis
of arbitrary populations when a matching reference panel is not
available. We were able impute z—scores and compute joint statistics
with better precision ‘best guess’ panels alone even after leaving out
the relevant ‘best guess’ panels from our computation of 2. For data—
sets with admixed individuals, the high variability of ancestry pro-
portions may make it harder to consistently model LD in an
accurate manner with a single reference panel. For example, in the
Native American component Latinos, there is a high level of popula—
tion substructure (Wang et al., 2008). In the 1000 Genomes refer—
ence panels, there are currently no Native American reference panels
available. Although proxy populations such as CHB and JPT are
often used, they are unlikely to capture the full resolution of each
underlying sub—population. Accounting for all the fine scale differ-
ences seen in admixed individuals will improve with the collection
of additional reference panels.

In this work, we aimed to minimize the MSE of imputed sum—
mary statistics in our objective function because imputation was one
of our main focuses. For other purposes, it may be more appropriate
to use a different objective depending on how the pairwise correl-
ation estimates will ultimately be used. For example, Hormozdiari
et al. (2014) use summary statistics to fine map causal variants by
finding the set of variants that maximize the likelihood of a multi-
variate normal distribution. In this case, optimizing frequencies for

reference panels by using the multivariate normal likelihood may
improve performance.

Improvements to Adapt—Mix may be made by using an out—of—
sample approach to learning the mixture frequencies due to the
potential of overfitting. Typically, overfitting will cause high
prediction error variances. We have shown though, with the ex—
ample of j oint—testing, that overfitting should not be a major concern
as the error variances are smaller when using Adapt—Mix compared
with a ‘best guess’ panel. Another enhancement could be made to
Adapt—Mix by using partial correlations. Often covariates such as
principal components are included in GWAS, which alter the genetic
correlation structure of the individuals being studied. Partial correl—
ations which account for these covariates may provide even more
accurate estimates of the Z for use in summary statistics methods.

Acknowledgement

We thank Anne Biton, Joel Mefford and Eric Gamazon for helpful manuscript

comments.

Funding

B.B. was supported by the NSF GRFP. NZ. and D.S.P. was supported by
NIH grant K25HL121295. E.G.B., C.E., S.H., D.H. and D.G.T. were
supported by National Institutes of Health R01-E8015794, U19-AIO77439,
R01-HL088133, R01-HL078885, R25-CA113710, T32-GM007546,
R01-HL004464, R01-HL104608 and the National Institute on Minority
Health And Health Disparities under Award Number P60MD006902.

Conﬂict of Interest: none declared.

References

1000 Genomes Project Consortium et al. (2012) An integrated map of genetic
variation from 1 092 human genomes. Nature, 491, 5 6—65 .

Baran,Y. et al. (2012) Fast and accurate inference of local ancestry in Latino
populations. Bioinformatics, 28, 1359—1367.

112 /8JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Adapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i189

 

Borrell,L.N. et al. (2013) Childhood Obesity and Asthma Control in
the GALA II and SAGE II Studies. Am ] Respir Crit Care Med., 187,
697—702.

Bryc,K. et al. (2010) Genome-Wide patterns of population structure and ad-
mixture in West Africans and African Americans. Proc. Natl. Acad. Sci.
USA., 107, 786—791.

Bulik-Sullivan,B. et al. (2014) LD score regression distinguishes confounding
from polygenicity in genome-Wide association studies. Technical report,
Program in Medical and Population Genetics, Broad Institute of MIT and
Harvard, Cambridge, MA.

Byrd,R.H. et al. (2006) A limited memory algorithm for bound constrained
optimization. SIAM journal on Scientiﬁc Computing, 16, 1190—1208.

Coronary Artery Disease (C4D) Genetics Consortium. (2011) A genome-Wide
association study in Europeans and South Asians identiﬁes ﬁve new loci for
coronary artery disease. Nat. Genet., 43, 339—344.

Galarneau,G. et al. (2010) Fine-mapping at three loci known to affect fetal
hemoglobin levels explains additional genetic variation. Nat. Genet., 42,
1 049—105 1 .

Gymrek,M. et al. (2013) Identifying personal genomes by surname inference.
Science, 339, 321—324.

Han,B. et al. (2011) Postassociation cleaning using linkage disequilibrium in-
formation. Genet. Epidemiol., 35, 1—10.

Hormozdiari,F. et al. (2014) Identifying causal variants at loci with multiple
signals of association. Genetics, 198, 497—508.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method
for the next generation of genome-Wide association studies. PLoS Genet., 5,
e1000529.

KichaeV,G. et al. (2014) Integrating functional data to prioritize causal vari-
ants in statistical ﬁne-mapping studies. PLoS Genet., 10, e1004722.

Liu,].Z. et al. (2010) A versatile gene-based test for genome-Wide association
studies. Am. ]. Hum. Genet., 87, 139—145.

Moorjani,P. et al. (2013) Genetic evidence for recent population mixture in
India. Am. ]. Hum. Genet. 93, 422—438.

Pasaniuc,B. et al. (2013) Analysis of Latino populations from GALA and
MEC studies reveals genomic loci with biased local ancestry estimation.
Bioinformatics, 29, 1407—1415.

Pasaniuc,B. et al. (2014) Fast and accurate imputation of summary statistics
enhances evidence of functional enrichment. Bioinformatics, 30, 2906—
2914.

Reich,D. et al. (2009) Reconstructing Indian population history. Nature, 461,
489—494.

Sanna,S. et al. (2011) Fine mapping of ﬁve loci associated with low-density
lipoprotein cholesterol detects variants that double the explained heritabil-
ity. PLoS Genet., 7, e1002198.

Schork,A.]. et al. (2013) All SNPS are not created equal: genome-Wide associ-
ation studies reveal a consistent pattern of enrichment among functionally
annotated SNPS. PLoS Genet., 9, e1003449.

Schunkert,H. et al. (2011) Large-scale association analysis identiﬁes 13 new
susceptibility loci for coronary artery disease. Nat. Genet., 43, 333—338.

Silva-Zolezzi,I. et al. (2009) Analysis of genomic diversity in Mexican Mestizo
populations to develop genomic medicine in Mexico. Proc. Natl. Acad. Sci.
USA., 106, 8611—8616.

Speliotes,E.K. et al. (2010) Association analyses of 249 796 individuals
reveal 18 new loci associated with body mass index. Nat. Genet., 42,
937—948.

Wang,S. et al. (2008) Geographic patterns of genome admixture in Latin
American Mestizos. PLoS Genet., 4, e1000037.

Yang,]. et al. (2012) Conditional and joint multiple-SNP analysis of GWAS
summary statistics identiﬁes additional variants inﬂuencing complex traits.
Nat. Genet., 44, 369—375.

Zaitlen,N. et al. (2009) Linkage effects and analysis of ﬁnite sample errors in
the HapMap. Hum. Hered., 68, 73—86.

112 /8JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

