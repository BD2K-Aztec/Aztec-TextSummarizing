Bioinformatics Advance Access published July 13, 2016

Bioinformatics, 2016, 1—3

doi: 10.1093/bioinformatics/btw384

Advance Access Publication Date: 22 June 2016
Applications Note

 

Genetics and population analysis

SERAPHIM: studying environmental rasters and
phylogenetically informed movements

Simon Dellicour1'*, Rebecca Rosez, Nuno R. Faria3, Philippe Lemey‘,
and Oliver G. Pybus3'*

1Department of Microbiology and Immunology, Rega Institute for Medical Research, Clinical and Epidemiological
Virology, KU Leuven—University of Leuven, Minderbroedersstaat 10, Leuven 3000, Belgium, 2BiolnfoExperts LLC,
Norfolk, Virginia, USA, 23518 and 3Department of Zoology, University of Oxford, Oxford OX1 3PS, UK

*To whom correspondence should be addressed
Associate Editor: Oliver Stegle

Received on April 7, 2016; revised on June 2, 2016; accepted on June 14, 2016

Abstract

Summary: SERAPHIM ("Studying Environmental Rasters and PHylogenetically Informed
Movements”) is a suite of computational methods developed to study phylogenetic reconstruc-
tions of spatial movement in an environmental context. SERAPHIM extracts the spatio-temporal in-
formation contained in estimated phylogenetic trees and uses this information to calculate sum-
mary statistics of spatial spread and to visualize dispersal history. Most importantly, SERAPHIM
enables users to study the impact of customized environmental variables on the spread of the
study organism. Specifically, given an environmental raster, SERAPHIM computes environmental
“weights” for each phylogeny branch, which represent the degree to which the environmental vari-
able impedes (or facilitates) lineage movement. Correlations between movement duration and
these environmental weights are then assessed, and the statistical significances of these correl-
ations are evaluated using null distributions generated by a randomization procedure. SERAPHIM
can be applied to any phylogeny whose nodes are annotated with spatial and temporal informa-
tion. At present, such phylogenies are most often found in the field of emerging infectious dis-
eases, but will become increasingly common in other biological disciplines as population genomic
data grows.

Availability and Implementation: SERAPHIM 1.0 is freely available from http://evolve.zoo.ox.ac.uk/.
R package, source code, example files, tutorials and a manual are also available from this website.
Contact: simon.dellicour@kuIeuven.be or oliver.pybus@zoo.ox.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Phylogenetic techniques are now a standard tool in the study of the
spatial and demographic history of organisms (e.g. Lemey et al.,
2009, 2010; Lemmon and Lemmon, 2008; Sanmarti’n et al., 2008).
In the context of infectious diseases, for example, phylogenetic infer-
ence can be used to reconstruct epidemic history (e.g. Carroll et al.,
2015). Of most relevance here, phylogeographic methods, such as
that implemented in the software program BEAST (Drummond
et al., 2012), enable the reconstruction of the dispersal history of a
phylogeny of a given set of genomes sampled through time in

continuous space (Lemey et al., 2010). The current version of this
approach uses a relaxed random walk model (Pybus et al., 2012) to
reconstruct historical dispersal. Phylogeographic methods model the
geographic locations of nodes in a phylogeny, and can therefore be
considered a type of phylogenetic character mapping approach.
Trees inferred using this method, or related methods such as the
structured coalescent model (De Maio et al., 2015) can be visualized
in a geographical context, such that each branch is interpreted as a
vector that characterizes a distinct path through time and space.
Thus, the tree represents a collection of phylogenetically informed

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1

9mg ‘09 isnﬁnV uo salaﬁuV soq ‘eiuiomeg JO AiiSJQAiu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuoguioiq/ﬁdnq wort papeolumoq

S.Dellicour et al.

 

movement events and contains useful information about the past dy-
namics of spatial spread.

Here we present SERAPHIM (“Studying Environmental Rasters
and PHylogenetically Informed Movements”), a new suite of com-
putational and statistical methods developed to study the environ-
mental context of spatio-temporal phylogenies. SERAPHIM is
available as a R package (R Core Team, 2016, http://www.R-pro
ject.org) that (i) extracts spatio-temporal information from a set of
phylogenetic trees, (ii) estimates and plots dispersion statistics, and
(iii) statistically test hypotheses regarding the relationship between
dispersal velocity and environmental variables, such as altitude,
population density and land cover.

2 Features

SERAPHIM first extracts the spatio-temporal information con-
tained in a set of suitable phylogenetic trees from a Nexus file con-
taining trees in a Newick format. Phylogenetic uncertainty will be
incorporated into the analysis if a set of trees is used, for example a
posterior distribution of trees obtained using a Bayesian phylogen-
etic approach such as that implemented in BEAST. The user can
then compute a set of spatial statistics that summarise dispersal.
These include the mean branch velocity, the diffusion coefficient as
defined in Pybus et al. (2012), the weighted diffusion coefficient as
defined in Trovao et al. (2015 ), and plots of the maximal distance of
an invasion wavefront from the spatial origin against time.
Wavefront plots are generated using two distance metrics: (i) the dir-
ect distance, which corresponds to the straight-line distance between
the origin and the wavefront, and (ii) the patristic spatial distance,
which is the sum of the spatial distances along all phylogeny
branches between the tree root and the corresponding tree tip. These
summary statistics can be useful to compare the mode and rate of
spatial spread of different populations. Supplementary Figure S1 il-
lustrates the plots obtained when SERAPHIM is applied to phyloge-
nies that represent dispersal history of the West Nile virus (WNV) in
North America. The phylogenies used were those reported in Pybus
et al. (2012). SERAPHIM also allows users to generate graphs of
spatial dispersal history. These plots are similar to those produced
by the software package SPREAD (Bielejec et al., 2011).
Supplementary Figure S2 shows the reconstructed dispersal history
of WNV in North America, again obtained by applying SERAPHIM
to the data from Pybus et al. (2012). A detailed tutorial on how to
undertake these analyses is available with the SERAPHIM package.
The main functionality of SERAPHIM is to statistically test the
impact of environmental factors on dispersal velocity. SERAPHIM
does this in three steps. First, it computes an environmental
“weight” for each branch using a pre-specified environmental raster
in an ASCII format. Second, it estimates the correlation between
branch duration and branch weight. Third, it tests the statistical sig-
nificance of these correlations using null distributions generated by a
randomization procedure (see manual for details). SERAPHIM im-
plements three different movement models for computing the envir-
onmental weight of each dispersal vector (i.e. each phylogeny
branch): the (i) straight-line, (ii) least-cost (Dijkstra, 1959) and (iii)
random walk models (McRae, 2006). The random walk dispersal
model is based on circuit theory (McRae, 2006) and for this model,
SERAPHIM calls CIRCUITSCAPE, an external Python package
(McRae, 2006). These three models allow the user to explore and
test different modes of dispersal when there is no prior information
about which movement model might be most appropriate. Once the
environmental weights are computed for each branch and

environmental raster, the correlation between vector durations and
environmental variables are calculated using either a univariate or
multivariate regression analysis within a generalized linear model
(GLM) framework. Following the GLM approach of Faria et al.
(2013) and Lemey et al. (2014), all variables are log-transformed
and standardized. SERAPHIM implements randomization proced-
ures to create null distributions to test for statistical significance, for
example by randomizing phylogeny node positions but maintaining
branch lengths, tree topology and the location of the root node. An
application of the present workﬂow is illustrated in Dellicour et al.
(2016)

3 Perspectives

Although the framework presented here has been developed for the
analysis of movement events extracted from spatiotemporal phylog-
enies (e.g. trees generated by BEAST), it can also be applied more
generally to dispersal events that have been observed using non-
phylogenetic methods, such as GPS collars or through capture-
mark-recapture. Any method that produces a collection of move-
ment vectors, each defined by a start and end location and a start
and end time, will be compatible with the SERAPHIM framework.

Acknowledgement

We thank three anonymous reviewers for their useful comments.

Funding

This work was funded by the Wiener-Anspach Foundation. S.D. is a post-
doctoral research fellow funded by the Fonds Wetenschappelijk Onderzoek
(FWO, Flanders, Belgium). R.R. received funding from the Medical Research
Council under a Methodology Research Fellowship grant agreement no.
99204, and from the European Union’s Horizon 2020 research and innov-
ation programme under grant agreement 634650-VIROGENESIS. P.L. ac-
knowledges funding from the European Research Council under the
European Community’s Seventh Framework Programme (FP7/2007-2013)
under Grant Agreement no. 278433-PREDEMICS and ERC Grant agreement
no. 260864-ViralPhylogeography. OGP received funding from the European
Research Council under the European Union’s Seventh Framework
Programme (FP7/2007—2013)/ERC grant agreement no. 614725-
PATHPHYLODYN.

Conﬂict of Interest: none declared.

References

Bielejec,F. et al. (201 1) SPREAD: Spatial phylogenetic reconstruction of evolu-
tionary dynamics. Bioinformatics, 27, 2910—2912.

Carroll,M.W. et al. (2015) Temporal and spatial analysis of the 2014-2015
Ebola virus outbreak in West Africa. Nature, 524, 97—101.

De Maio,N. et al. (2015 ) New routes to phylogeography: a Bayesian struc-
tured coalescent approximation. PLoS Genet., 11, e1005421.

Dellicour,S. et al. (2016) Explaining the geographic spread of emerging epi-
demics: a framework for comparing viral phylogenies and environmental
landscape data. BMC Bioinform., 17, 1—12.

Dijkstra,E.W. (1959) A note on two problems in connexion with graphs.
Numerische Mathematik, 1, 269—271.

Drummond,A.]. et al. (2012) Bayesian phylogenetics with BEAUti and the
BEAST 1.7. Mol. Biol. Evol., 29, 1969—1973.

Faria,N.R. et al. (2013) Simultaneously reconstructing viral crossspecies trans-
mission history and identifying the underlying constraints. Phil. Trans. R.
Soc. B, 368, 20120196.

Lemey,P. et al. (2009) Bayesian phylogeography ﬁnds its roots. PLoS Comput.
Biol., 5, e1000520.

9mg ‘09 isnﬁnV uo salaﬁuV soq ‘eiuiomeg JO AiiSJQAiu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuoguioiq/ﬁdnq moi; papeolumoq

SERAPHIM

 

Lemey,P. et al. (2010) Phylogeography takes a relaxed random walk in con-
tinuous space and time. Mol. Biol. Evol., 27, 1877—1885.

Lemey,P. et al. (2014) Unifying Viral Genetics and Human Transportation
Data to Predict the Global Transmission Dynamics of Human Inﬂuenza
H3N2. PLoS Pathogens, 10, e1003932.

Lemmon,A.R., and Lemmon,E.M. (2008) A likelihood framework for esti-
mating phylogeographic history on a continuous landscape. Syst. Biol., 57,
544—561.

McRae,B.H. (2006) Isolation by resistance. Evolution, 60, 1551—1561.

Pybus,O.G. et al. (2012) Unifying the spatial epidemiology and molecular evolu-
tion of emerging epidemics. Proc. Natl. Acad. Sci. USA, 109, 15 066—1 5071.
R Core Team (2016): R: A Language and Environment for Statistical

Computing. R Foundation for Statistical Computing, Vienna, Austria.
Sanmartin,l. et al. (2008) Inferring dispersal: a Bayesian approach to
phylogeny-based island biogeography, with special reference to the Canary
Islands. ]. Biogeogr., 35, 428—449.
Trovéo,N.S. et al. (2015 ) Bayesian inference reveals host-speciﬁc contributions to
the epidemic expansion of Inﬂuenza A H5N1. Mol. Biol. Evol, 32, 3264—3275.

9mg ‘09 1sn8nV uo salaﬁuV soq ‘121u101n123 10 AllSleAlu [1 112 [BJO'SIBIIJHO[plOJXO'SODBIIHOJIIlOlQ/ﬂ(11111 111011 papeolumoq

