APPLICA TIONS NOTE V3335;.l‘égéiiﬂiiﬁii‘ifclﬁ;2?

 

Sequence analysis

Advance Access publication October 8, 2012

MGAviewer: a desktop visualization tool for analysis of

metagenomics alignment data

Zhengwei Zhu, Beifang Niu, Jing Chen, Sitao Wu, Shulei Sun and Weizhong Li*
Center for Research in Biological Systems, University of California San Diego, La Jolla, CA 92093, USA

Associate Editor: Alex Bateman

 

ABSTRACT

Summary: Numerous metagenomics projects have produced tremen-
dous amounts of sequencing data. Aligning these sequences to ref-
erence genomes is an essential analysis in metagenomics studies.
Large-scale alignment data call for intuitive and efficient visualization
tool. However, current tools such as various genome browsers are
highly specialized to handle intraspecies mapping results. They are
not suitable for alignment data in metagenomics, which are often
interspecies alignments. We have developed a web browser-based
desktop application for interactively visualizing alignment data of
metagenomic sequences. This viewer is easy to use on all computer
systems with modern web browsers and requires no software
installation.

Availability: http://weizhong|i-|ab.org/mgaviewer

Contact: |iwz@sdsc.edu

Received on March 9, 2012; revised on August 29, 2012; accepted on
September 17, 2012

1 INTRODUCTION

The advances of Next Generation Sequencing technologies
(Mardis, 2011) have promoted big waves of metagenomic
projects in study of microbiomes under different environments
such as ocean (Rusch et al., 2007) and human body (Qin et al.,
2010). An essential step in metagenomic data analysis is to align
the sequencing reads against the available microbial genomes.

Visualization is an intuitive way to analyze large-scale align-
ment data in genomic studies. There are many visualization tools
available. Some are web browser-based such as UCSC genome
browser (Dreszer et al., 2012), LookSeq (Manske and
Kwiatkowski, 2009) and JBrowse (Skinner at al., 2009). Some
are standalone programs such as Tablet (Milne et al., 2010),
GenomeView (Abeel et al., 2012), MapView (Bao et al., 2009),
1GB (Nicol et al., 2009), IGV (Robinson et al., 2011), SamScope
(Popendorf and Sakakibara, 2012) and so on.

However, these sophisticated visualization tools are specialized
in handling intraspecies alignment results (i.e. query and refer-
ence are same species). They are not suitable for interspecies
alignments from metagenomic datasets, where query and
reference can be from different species. There are fundamental
differences between intraspecies and interspecies alignments. The
former only involves one reference genome and represent
features like single nucleotide polymorphism and alternative
splicing. But the latter involves multiple (often 103) reference

 

*To whom correspondence should be addressed.

microbial genomes. To visualize interspecies alignments, a tool
needs to show the wide range of alignment similarities (100% to
as low as 50% for DNAs and 30% for proteins) and to handle
thousands of reference genomes.

The Global Ocean Sampling study (Rusch et al., 2007) first
introduced fragment recruitment plots to illustrate the metage-
nomic alignment data. However, its underlying software is not
available to the public.

Here, we present MetaGenomic Alignment Viewer (MGA-
viewer), a platform-independent web browser-based tool for
visualizing alignment data. It does not rely on web server and
relational database for image generation and data retrieval. It
can be simply used as a standalone desktop program to analyze
local data. It can also be included in a web server like other
web-based genome browsers.

2 METHODS

The key component of this tool is a graphic interface with a 2D map that
displays large amounts of alignments between metagenomic sequences
from one or more samples and a reference genome (Fig. 1). Users can
explore alignment data by interactively operating the 2D map in a similar
way as in Google Maps.

MGAviewer is an HTMLS web application. It works in all major
modern browsers, including Chrome, Firefox, Safari and Internet
Explorer 9, without the need of installing any extra software or plugin.
It uses jQuery (http://jquery.com/) as the base J avaScript library, and on
top of which, a customized version of jQuery plotting plugin, Flot (http://
code.google.com/p/ﬂot/). We extended Flot to make it support drawing
of fragments and annotation features. Above these, a site-speciﬁc
JavaScript file (‘site.js’) is responsible for setting up plot parameters,
placing and responding to additional controls and fetching data.

MGAviewer fetches alignment data from a user’s local computer or
from a web server on demand via AJAX. It then draws the plot in an
HTMLS Canvas element. Every time a user interaction event is triggered,
e.g. zooming in/out, panning and resizing of the plot, the plot image is
simply redrawn using data already loaded, unless additional data are
required. This is in contrast to many other web-based genome browsers
where plot images are generated on the server side and then retrieved by
browser on demand; in MGAviewer a plot is drawn locally in browser.
This results in no network trafﬁc for most user operations and therefore
dramatically improves the responsiveness of user interactions, especially
on slow network.

Alignment data are stored in J SON (a lightweight data-interchange
format used by J avaScript) formatted files, which contain alignment
details including coordinate, sequence identity, name, e—value, etc. We
provide scripts to generate JSON ﬁles from raw alignment results by
BLAST (Altschul et al., 1997) and FR-HIT (Niu et al., 2011) and also
from alignments in SAM format. These scripts need installation of

 

© The Author(s) 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /310's113u1no [p.IOJXO'SSUBUHOJUTOTQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

A desktop visualization tool

 

 

 

 

 

  

 

  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

'1'  Sewerage plat '
I_|I_| —
'jll I . .
I II 1 I I' I J - 'I'l ' II ' I'I'lhhl.‘ -|"|-'II I
H i_
l ' - I . -'|- - -'E'.Ii=..:-
I. I HA
I. 5; I mammazmi ' .' ;+- zwmdﬂzmﬂ 3 g, . " ' 3‘ '5'
. I} . :_ - .- E I a I _ '1 I ' - .-|. 5.3,“...
t._— l 2:. - I ,1 .1 .. . '_ I; _ .e I I
' j-_- ' I. I . - : ' IL II. i .- |-. - 'I‘JDHJ
 I' i I "I 'l“. " 'I' "ﬁat
.i.-- r . . . . I‘ . ..- I I .. |
LI 1 -I_II.£_ -I -;I_'~ .. . .. x .IH ,._E IIII._ “In” .:
 I. I I T I _ ﬁr,  :MIlI'II'I'IEI'IISﬁlE _ {‘I'-ii, ' '
I':| '5. 5 I _ “KANE. . .II'_1_I. .'|-_ .‘E-Jﬂ-Fﬂ.|
II- . - _ . um. I; :nluredhjrsampies III... :I*   _I .
.-  r. L -.: I.- ' '- .  '- ""- "M'
II  III- -IP I  I I I... .-_' I -|I II F “El  :'~ .-
II". '.'.' ' -I ' II III. .'. -. 4. I11 I' --
- .  - I-. : '.- -  ' 
I I:- .'1_  “Ill-m“- '1  I.  .. I: II I III -I| I‘?. I FII  " r; [I ll.-
F: II.II.II—'—'—'—II‘I I II_I.I_I_II_I;__I_ II.:- I a._ II:  I|l: 1‘ '.I 'IJ F a-
-.a.. ..-*., .i -" - -'--.:-'-..I _  -,I_ -, _ ff- ' . "   .-I
:.I_- 11,-}- J __eJ_' -' '_.Li. III':~. .. - -_r - LI“ .:-. _-.rIr_.I| .I _ - -_1 I ' -  —-4—-M—MJ-M =_ t. .-.;.-I.r:§'; .' ;
E._I'_-:_IMaPmntlﬂlknns IiII --Iei_:-II:-..Ir"_. '_'_ I'I.:-‘ 'I-III.I _IIII :'__I umcanlmmorpan 5 I :II
__ I;  my“   1n. "I 'II -    I_--I ‘ ;I'I r'  I  = i. themapusdngmnme - I  q "
.:'_ . I_ :.I I III I III I. ._  I‘II .II II I_ 1 I. I- .L , I I. . I I,IIII : _  II . tIII .II I .
.II,  I I I Sampla Am. - I .L.. I. _.1- .  I I I I I Map mmmlimns  
. I I" ' Lenth 245 ' 'L “Mali” !' 
' t 1 I -- -- - I Mignmen‘l descrlpﬁnnis shown In '
, :pupupwinduwwhan mauﬂiﬁmr
1' "' 1
.' ."'I.'I' I' H . . . .. . I'3-II.| III."I.I FlI'II" l.'l'l 1 II-_!II Ill-ll' ' __"I"I' I'I : ' .11'.‘ ‘.E ' 1 -'1-_:-_! I_II'II'I
Helena-nae Benn-mu: [EI:TEITTEIBBEIJ Prnchlurncuccus mannus str. MIT 9312, :umplule genome [If]
nI-IIIIIJIILII- m m IGenasare mlureciillﬂjﬂla

Fig. 1. Screenshots of the MGAviewer visualization interface

BioPython package. Converters for other programs like BLAT
(Kent, 2002) can be easily implemented.

MGAviewer can be used as standalone software by simply opening the
directory that contains these I SON files, MGAviewer scripts and a
master HTML ﬁle (see user’s guide for details). It can also be hosted
on a web server. The plot itself can be embedded in any webpage.

3 RESULTS

MGAviewer has an interface for users to select one or more
metagenomic samples and a reference from a list of reference
genomes to generate the plot. The screenshots of MGAviewer
are shown in Figure 1. The plot shows alignments from eight
metagenomic samples to a reference genome. The x-axis is the
genome coordinate, and y-axis is alignment identity (%).
Alignments are coloured by sample and are represented as
points or lines depending on zoom level. The bottom of the
plot shows genes of the reference genome, and the top shows
the genome coverage for each sample. Icons at left and right
bottom corners are for zoom, resize and reset. Users can also
zoom or pan the map by mouse. The inside circular images are
zoomed views of the plot.

We tested MGAviewer on 1.5 million alignment datasets
between >600 metagenomic samples from CAMERA (Sun
et al., 2011) and >2500 genomes from NCBI. MGAviewer
provides real-time visualization for almost all these datasets
except a few hundred very large datasets, which need extra
several seconds for data loading and plotting. MGAviewer is
already adopted by CAMERA project in its alignment re-
sources, which will be described in a separate publication.
MGAviewer can be used to analyze alignment data not only
for prokaryotic species but also for viruses and small eukary-
otic organisms.

Funding: This study was supported by Award R01HG005978
from the National Human Genome Research Institute and the
Gordon and Betty Moore Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Abeel,T. et al. (2012) GenomeView: a next-generation genome browser. Nucleic
Acids Res., 40, e12.

Altschul,S.F. et al. (1997) Gapped BLAST and PSI-BLAST: a new generation of
protein database search programs. Nucleic Acids Res., 25, 3389—3402.

Bao,H. et al. (2009) MapView: visualization of short reads alignment on a desktop
computer. Bioinformatics, 25, 1554—1555.

Dreszer,T.R. et al. (2012) The UCSC genome browser database: extensions and
updates 2011. Nucleic Acids Res., 40, D918—D923.

Kent,W.J. (2002) BLAT—the BLAST-like alignment tool. Genome Res., 12,
656—664.

Manske,H.M. and Kwiatkowski,D.P. (2009) LookSeq: a browser-based viewer for
deep sequencing data. Genome Res., 19, 2125—2132.

Mardis,E.R. (2011) A decade’s perspective on DNA sequencing technology. Nature,
470, 198—203.

Milne,I. et al. (2010) Tablet—next generation sequence assembly visualization.
Bioinformatics, 26, 401—402.

Nicol,J.W. et al. (2009) The integrated genome browser: free software for distribu-
tion and exploration of genome-scale datasets. Bioinformatics, 25, 2730—2731.

Niu,B. et al. (2011) FR-HIT, a very fast program to recruit metagenomic reads to
homologous reference genomes. Bioinformatics, 27, 1704—1705.

Popendorf,K. and Sakakibara,Y. (2012) SAMSCOPE: an openGL—based real-time
interactive scale-free SAM viewer. Bioinformatics, 28, 1276—1277.

Qin,J. et al. (2010) A human gut microbial gene catalogue established by metage-
nomic sequencing. Nature, 464, 59—65.

Robinson,J.T. et al. (2011) Integrative genomics viewer. Nat. Biotechnol, 29, 24—26.

Rusch,D.B. et al. (2007) The sorcerer II Global Ocean Sampling expedition: north-
west Atlantic through eastern tropical Paciﬁc. PLoS Biol, 5, e77.

Skinner,M.E. et al. (2009) JBrowse: a next-generation genome browser. Genome
Res., 19, 1630—1638.

Sun,S. et al. (2011) Community cyberinfrastructure for advanced microbial ecology
research and analysis: the CAMERA resource. Nucleic Acids Res., 39, D546—D55 l.

 

123

112 /310's113u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

9IOZ ‘091sn3nv uo ::

