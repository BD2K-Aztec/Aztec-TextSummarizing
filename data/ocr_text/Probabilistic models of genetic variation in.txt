Bioinformatics, 32(5), 2016, 713—721

doi: 10.1093/bioinformatics/btv641

Advance Access Publication Date: 6 November 2015
Original Paper

 

Genetics and population analysis

Probabilistic models of genetic variation in
structured populations applied to global
human studies

Wei Hao”, Minsun Songhut and John D. Storey1.2,*

1Lewis-Sigler Institute for Integrative Genomics and 2Center for Statistics and Machine Learning, Princeton
University, Princeton, NJ 08544, USA

*To whom correspondence should be addressed.

TThe authors wish it be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
1Present address: Department of Mathematics and Statistics, University of Nevada Reno, Reno, NV 89557, USA.
Associate Editor: Janet Kelso

Received on January 5, 2015; revised on October 19, 2015; accepted on October 27, 2015

Abstract

Motivation: Modern population genetics studies typically involve genome-wide genotyping of
individuals from a diverse network of ancestries. An important problem is how to formulate and
estimate probabilistic models of observed genotypes that account for complex population struc-
ture. The most prominent work on this problem has focused on estimating a model of admixture
proportions of ancestral populations for each individual. Here, we instead focus on modeling vari-
ation of the genotypes without requiring a higher-level admixture interpretation.

Results: We formulate two general probabilistic models, and we propose computationally efficient
algorithms to estimate them. First, we show how principal component analysis can be utilized to
estimate a general model that includes the well-known Pritchard—Stephens—Donnelly admixture
model as a special case. Noting some drawbacks of this approach, we introduce a new ’Iogistic fac-
tor analysis’ framework that seeks to directly model the logit transformation of probabilities under-
lying observed genotypes in terms of latent variables that capture population structure. We demon-
strate these advances on data from the Human Genome Diversity Panel and 1000 Genomes
Project, where we are able to identify SNPs that are highly differentiated with respect to structure
while making minimal modeling assumptions.

Availability and Implementation: A Bioconductor R package called Ifa is available at http://www.bio
conductor.org/packages/release/bioc/htmI/Ifa.html.

Contact: jstorey@princeton.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

One of the most important goals of modern human genetics is to ac-
curately model genome-wide genetic variation among individuals, as
it plays a fundamental role in disease gene mapping and characteriz-
ing the evolutionary history of human populations. In this article,
we develop latent variable probabilistic models and estimation
methods of genetic variation that provide allele frequency estimates
of each individual/SNP combination in the presence of arbitrarily

©The Author 2015. Published by Oxford University Press.

complex population structure. Accurate estimates of allele frequen-
cies in this setting allow for improved tests of genetic associations
with complex traits and other population genetic analyses which do
not rely on overly restricted models of population structure. For ex-
ample, the models and methods developed here provide the key esti-
mation step in the implementation of a new framework for
association testing in the presence of arbitrarily complex structure
(Song et al., 2015). Other applications we explore here are to

713

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [3.10811211an[plOJXO'SODBIILIOJIIlOIQ/ﬂ(11111 wort pepeolumoq

910K ‘09 lsnﬁnV no :2

714

W.Hao et al.

 

identify loci differentiated with respect to structure, test for random
mating in the presence of structure, generalize the estimation of EST,
and characterize the global distribution of allele frequencies of dis-
ease SNPs—all making minimal assumptions about the complexity
and form of structure.

A longstanding problem has been to provide well-estimated
probabilistic models of observed genotypes in the presence of com-
plex population structure (see Raj et al., 2014 and references
therein). A series of inﬂuential publications have proposed methods
to estimate a model of admixture, where the primary focus is on the
admixture proportions themselves (Alexander et al., 2009; Pritchard
et al., 2000; Tang et al., 2005), which in turn may produce estimates
of the allele frequencies of every genetic marker for each individual.
Here, we significantly relax the assumptions made about the mani-
festation of structure to yield more general latent variable models of
structure. Rather than targeting admixture proportions, we instead
focus on the estimation of the individual-speciﬁc allele frequencies,
and we show that we make significant gains over existing methods
in the accuracy and computational efficiency in estimating these
quantities. The individual-specific allele frequencies, rather than ad-
mixture proportions, are ultimately the key quantities that need to
be estimated in the applications we discuss as well as in the associ-
ation testing method of Song et al. (2015).

We propose two flexible genome-wide models of individual-
specific allele frequencies as well as methods to estimate them. First,
we develop a model that includes as special cases the aforemen-
tioned models; specifically, the Balding—Nichols (BN) model
(Balding and Nichols, 1995) and its extension to the Pritchard—
Stephens—Donnelly (PSD) model (Pritchard et al., 2000). However,
we identify some limitations of our method to estimate this model.
We therefore propose a second model based on the log-likelihood of
the data that allows for rapid estimation of allele frequencies while
maintaining a valid probabilistic model of genotypes.

The estimate of the first model is based on principal component
analysis (PCA), which is a tool often applied to genome-wide data
of genetic variation in order to uncover structure. One of the earliest
applications of PCA to population genetic data was carried out by
Menozzi et al. (1978). Exploratory analysis of complex population
structure with PCA has been thoroughly studied (Manni, 2010;
Menozzi et al., 1978; Novembre and Stephens, 2008; Rendine et al.,
1999; Sokal et al., 1999). We show that a particular application of
PCA can also be used to estimate allele frequencies in highly struc-
tured populations, although we have to deal with the fact that PCA
is a real-valued operation and is not guaranteed to produce allele
frequency estimates that lie in the unit interval [0,1].

The estimate of the second model is based on generalized factor
analysis approaches that directly model latent structure in observed
data, including categorical data (Bartholomew et al., 2011) in
which genotypes are included. We utilize a factor model of popula-
tion structure (Engelhardt and Stephens, 2010) in terms of non-
parametric latent variables, and we propose a method called ‘logis-
tic factor analysis’ (LFA) that extends the PCA perspective toward
likelihood-based probabilistic models and statistical inference
(Collins et al., 2002). LEA is shown to provide accurate and inter-
pretable estimates of individual-specific allele frequencies for a wide
range of population structures. At the same time, this proposed ap-
proach provides visualizations and numerical summaries of struc-
ture similar to that of PCA, building a convenient bridge from
exploratory data analysis to probabilistic modeling. LFA plays a
key role in the aforementioned new test of genome-wide associ-
ation of Song et al. (2015), called the genotype-conditional associ-
ation test.

We compare our proposed methods with existing algorithms,
ADMIXTURE (Alexander et al., 2009) and fastSTRUCTURE (Raj
et al., 2014), and show that when the goal is to estimate all
individual-specific allele frequencies, our proposed approaches are
conclusively superior in both accuracy and computational speed.
We apply the proposed methods to the Human Genome Diversity
Project (HGDP) (Cann et al., 2002; Rosenberg et al., 2002, 2005)
and 1000 Genomes Project (TGP) (1000 Genomes Project
Consortium, 2010) datasets, which allows us to estimate allele fre-
quencies of every SNP in an individual-specific manner. Using LFA,
we are also able to rank SNPs for differentiation according to popu-
lation structure based on the likelihoods of the fitted models. In
both datasets, the most differentiated SNP is proximal to SLC24A5,
and the second most differentiated SNP is proximal to EDAR.
Variation in both of these genes has been hypothesized to be under
positive selection in humans. In the TGP dataset, the second most
different SNP is rs3827760, which confers a missense mutation in
EDAR and has been recently experimentally validated as having a
functional role in determining a phenotype (Kamberov et al., 2013).
We also identify several SNPs that are highly differentiated in these
global human studies that have recently been associated with dis-
eases such as cancer, obesity and asthma.

2 Methods

2.1 Models of Allele Frequencies
It is often the case that human and other outbred populations are
‘structured’ in the sense that the genotype frequencies at a particular
locus are not homogeneous throughout the population (Astle and
Balding, 2009). Geographic characterizations of ancestry often ex-
plain differing genotype frequencies among subpopulations. For ex-
ample, an individual of European ancestry may receive a particular
genotype according to a probability different than an individual of
Asian ancestry. This phenomenon has been observed not only across
continents, but on very fine scales of geographic characterizations of
ancestry. Recent studies have shown that population structure in
human populations is quite complex, occurring more on a continu-
ous rather than a discrete basis (Rosenberg et al., 2002). We can
illustrate the spectrum of structural complexity with Figure 1, which
shows dendrograms of hierarchically clustered individuals from the
HapMap (phase II), HGDP and TGP datasets. The HapMap sam-
ples strongly indicate explicit membership of each individual to one
of three discrete subpopulations (due to the intended sampling
scheme). On the other hand, the clusterings of the HGDP and TGP
individuals show a very complex configuration, more representative
of random sampling of global human populations.

Let us introduce Z as an unobserved variable capturing an indi-
vidual’s structure, which we will estimate with dimension d. Let

x be the observed genotype for SNP i and individual i

z;
(z' = 1,. . . ,m, j = 1, . . . ,n), and assume that x,,- is coded to take the
values 0, 1, 2. We call the observed m X n genotype matrix X. For
SNP i, the allele frequency can be viewed as a function of Z, i.e.
TC,‘(Z). For a sampled individual i from an overall population, we
have ‘individual-specific allele frequencies’ (Thornton et al., 2012)
defined as 71,-,- E TC,‘(Z/') at SNP 2'. Each value of m,- informs us as to the
expectation of that particular SNP/individual pair under the scen-
ario we observed a new individual at that locus with the same struc-
ture, specifically as E[x,-,-] / 2 2 mi. If an observed SNP genotype x,,- is
treated as a random variable, then we assume that 7g,- serves to
model x,,- as a Binomial parameter: x,,-|Z = z,- N Binomial(2, TC,‘(Z,')).
(We will drop the conditioning on Z in the subsequent text for

112 [BJO'SIBILIHO[plOJXO'SODBIILIOJHIOIQ/[Zdllq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

Genetic variation in structured populations

715

 

HapMap

 

 

0 YRI
0 CEU
O JPT+CHB

 

Human Genome Diversity Project (HGDP)

 

 

 

AFRICA
o AMERICA
0 CENTRAL_SOUTH_ASIA
o EAST_AS|A
O EUROPE
0 MIDDLE_EAST
O OCEANIA



 

   
  
 
   

 

 

 

  

1000 Genomes Project (TGP)

 

 

AFRICA_|N_AFR|CA
o AFRICA_|N_AM
o EAST_AS|A_|N_AM/AS|A
o EUROPE_IN_AM/EU
o MEXICO_IN_AM
0 SOUTH_AMERICA
0 SOUTH_ASIA_IN_AM/ASIA

 

 

 

 

 

 

Fig. 1. A hierarchical clustering of individuals from the HapMap, HGDP and
TGP datasets. A dendrogram was drawn from a hierarchical clustering using
Ward distance based on SNP genotypes (MAF > 5%). Whereas the HapMap
project shows a definitive discrete population structure (by sampling design),
the HGDP and TGP data show the complex structure of human populations

convenience.) This Binomial distribution assumption is also made in
the PSD model (Alexander et al., 2009; Pritchard et al., 2000). The
focus of this article is on the simultaneous estimation of the m,- val-
ues(i= 1,...,m,j= 1,...,n).

The flexible, accurate and computationally efficient estimation
of individual-specific allele frequencies is important for population
genetic analyses, illustrated by the following examples.

Example 1: Corona et al. (2013) recently showed that considering
the worldwide distribution of allele frequencies of SNPs known to
be associated with human diseases may be a fundamental compo-
nent to understanding the relationship between ancestry and disease.

Example 2: We may use individual-specific allele frequency esti-
mates to determine whether genotype data follow a probability distri-
bution indicative of random mating, conditional on population
structure. This involves verifying that x,-,-|Z = z,- N Binomial(2, nii(z,-)).
Verifying this model can be viewed as testing for a version of Hardy—
Weinberg equilibrium conditional on structure; it is also the probabilis-
tic assumption underlying the STRUCTURE (Pritchard et al., 2000),
ADMIXTURE and fastSTRUCTURE software packages that all fit the
PSD model. Verifying this model assumption can be accomplished by
assessing the goodness-of—fit of the model by testing whether the geno-
type frequencies for SNP i follow probabilities 7:12], 276,7"(1 — mi), and
(1 — nil-)2 for all individualsj = 1,... ,n.

Example 3: It can be shown that an PST-related measure can be
characterized for SNP i using values of xi], 7' = 1, 2, . . . ,n
(Supplementary materials, Section S5).

Example 4: We have recently developed a test of association that cor-

 

rects for population structure and involves the estimation of log
(Song et al., 2015).

These examples demonstrate that ﬂexible and well-behaved esti-
mates of the individual-specific allele frequencies m,- are needed for
downstream population genetic analyses.

It is straightforward to write other models of population struc-
ture in terms of Z. For the BN model, each individual is assigned to
a population, thus zl- indicates individual [’5 population assignment.
For the PSD model, each individual is considered to be an admixture
of a finite set of ancestral populations. Following the notation of
Pritchard et al. (2000), we can write 2,- as a vector with elements qkj,
where la indexes the ancestral populations, and we constrain qki to
be between 0 and 1 subject to quki = 1. Assuming the PSD model
allows us to write each 7:),- 2 kaiqul- and leads to a matrix form:
F = PQ, where F is the m x 11 matrix of allele frequencies with (i, 7')
entry xii, P is the m X d matrix of ancestral population allele frequen-
cies pik and Q is the d X 11 matrix of admixture proportions. The
elements of P and Q are explicitly restricted to the range [0, 1].

The PSD model is primarily focused on the matrix Q and second-
arily on the matrix P, which have standalone interpretations. We
aim instead to estimate all m,- quantities with a high level of accuracy
and computational efficiency. Writing the structure of the allele fre-
quency matrix F as a linear basis, we have:

Modell: F 2 PS, (1)

where F is m X d and S is d X n with d S n, and the entries of both
matrices are unrestricted real numbers. The d X 11 matrix S encapsu-
lates the genetic population structure for these individuals since S is
not SNP-specific. The m X d matrix F maps how the structure S is
manifested in the allele frequencies. Operationally, each SNP’s allele
frequencies are a linear combination of the rows of S, where the lin-
ear weights for SNP i are contained in row i of F. We define the di-
mension d so that d: 1 corresponds to the case of no structure:
when d = 1, S = (1, 1, . . . , 1) and l" is the column vector of marginal
allele frequencies.

This model is not necessarily the most effective way to estimate
xi,- when working in the context of a probabilistic model or with the
likelihood function given the data. Model 1 resembles linear regres-
sion, where the allele frequencies are treated as a real-valued re-
sponse variable that is linearly dependent on the structure. A version
of regression for the case of categorical response variables (e.g. geno-
types) with underlying probability parameters is logistic regression.
We developed an approach called logistic factor analysis (LFA),

112 ﬁrosleumo[pJOJXO'sopeuJJOJutotq/pdnq wort pepeolumoq

910K ‘09 lsnﬁnV no 22

716

W.Hao et al.

 

which is essentially an extension of non-parametric factor analysis
to {0, 1, 2}-valued genotype data. The justification for LFA derives
from that of generalized linear models (McCullagh and Nelder,
1989), where in our case observed covariates are instead replaced
with unobserved latent variables that must also be estimated.

The log-likelihood is the preferred mathematical framework for
representing the information the data contain about unknown par-
ameters (Lehmann and Casella, 1998). Suppose that the model as-
sumption holds such that x,-,- N Binomial(2, mi). We can write the
log-likelihood of the data for SNP i and individual i as:

“ml-Inn 2108(Pr(xiil“ii))

oc log (a? (1 — Riff—xii) = xiilog(1 mi

 

_ 7til.) -]-  — 715,7).

The log-likelihood of SNP i for all unrelated individuals is the sum:
27:1 £(7tii|x,-,-). The term log (13:17) is the logit function and is written
as logit(7t,-,-). logit(7t,-,-) is called the ‘natural parameter’ or ‘canonical

 

parameter’ of the Binomial distribution and is the key component of
logistic regression (McCullagh and Nelder, 1989). An immediate
benefit of working with logit(7t,-,-) is that it is real valued, which
allows us to directly model logit(7t,-,-) with a linear basis.

Let L be the m x 11 matrix with (i, 7') entry equal to logit(7t,-,-). We
form the following parameterization of L:

Mode12 : L 2 AH, (2)

where A is m x d and H is d X n with d S n. In this case we can write
d
logit(7'5ii) = Zurich/2]"
k=1

where all parameters are free to span the real numbers. We choose
the value of d by identifying the one that provides the best goodness-
of-fit (Supplementary materials, Section 52).

We call the rows of H ‘logistic latent factors’ or just ‘logistic fac-
tors’ as they represent unobserved variables that explain the inter-
individual differences in allele frequencies. In other words, the logit
of the vector of individual-specific allele frequencies for SNP i can
be written as a linear combination of the rows of H:

d
[108it(7ti1), - - - ,108it(7rm)l = logit(1€i) = Zambia,
k=1

where hk is the lath row of H. Similarly, we can write:

eXP [2:1 aikhk]

1 + eXP [2:1 aikhk] .

The relationship between our proposed LFA approach and existing

 

(ﬂi1,...,ﬂin) = 7'61":

approaches of estimating latent variables in categorical data is de-
tailed in Supplementary materials, Section S6. Specifically, it should
be noted that even though we propose calling the approach LFA, we
do not make any assumptions about the distribution of the factors
(which are often assumed to be normal). A technically more detailed
name of the method is a ‘logistic nonparametric linear latent vari-
able model for Binomial data.’

2.2 Estimation algorithms

The two models presented earlier make minimal assumptions as to
the nature of the structure. For example, in Model 1, both P and S are
permitted to be real valued. This allows us to apply a PCA-based

algorithm directly to the genotype matrix X, obtaining estimates
of F, F and S. In essence, F is estimated by forming the projection of
X / 2 onto the top d principal components of X with an explicit inter-
cept for the d = 1 case. One drawback of this approach is that because
PCA is designed for continuous data, we have to take additional steps
to constrain F to be in the range [0, 1]. However, we show in Results
that F is still an extremely accurate estimate of the allele frequencies F
for all formulations of F considered here, including the PSD model.

Algorithm 1: Estimating F from PCA:

1. Let [1,- be the sample mean of row i of X. Set  = x,-,- — [1,- and let
X* be the m x 11 matrix with (i, 7') entry 

2. Perform singular value decomposition (SVD) on X* which de-
composes X* = UAVT. Note that the rows of AVT are the n
row-wise principal components of X* and U are the principal
component loadings.

3. Let X24 be the projection of X* on the top d — 1 eigen-vectors
Of this SVQ,*X;_1 = U1:(d_1)A1:(d_1)V£(g_1).

4. Construct F by adding [1,- to row i of Xal_1 (for i = 1,. . . ,n) and
multiplying the resulting matrix by 1/2. In mathematical terms,
F)k 2 FS where

1 ~
2 H1
1: _ 1
— §U1:(d—1)A1:(d—1)
1 ~
2 “m
1 1 1 ~
§u1151 "' §u1,d—15d—1 EH1
1 1 1 ~
: §u2151 "' Eliza—15114 EH2 ’
1 1 1 ~
5117,1151 ' ' ' Eumﬂ—lad—l EH»;
T
g = V1:(d—1)
11 . . . 1
1111 1121 1’nl
U12 112 Vnz
Ul,d—1 Uz,d—1 Una—1
1 1 1

and 6,- is the ith diagonal entry of A. Let  to be the (i, 7') entry
of F*.

5. Since it may be the case that some  are such that  < 0 or
 > 1, we truncate these. The ﬁnal PCA based estimate of F is
formed as F where the (i, 7') entry in,- is deﬁned to be

C ifﬁfigC
1—C ifﬁfl-Z1—C

for some C 2 0. An estimate of L can be formed as L = logit(F).

i
211’

given 211 alleles are observed. In summary, F is a projection of X

Here we used C = which is the minimum resolution of the data
into its top principal components, scaled by 1/2, and truncated so
that all values lie in the interval (0, 1).

For Model 2, we propose a method for estimating the latent vari-
able H. Starting from the output of Algorithm 1, we apply the logit
transformation to the subset of rows that had no truncation, i.e. no

112 /810'SI12umo[p101x0'831112u1101utotqﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Genetic variation in structured populations

717

 

values where  S C or  2 1 — C. We then extract the right singu-
lar vectors of this transformed subset. As long as the subset is large
enough to span the same space as the row space of L, this approach
accurately estimates the basis of H. Next, we calculate the max-
imum likelihood estimation of A parameterized by H to yield A,
and then set L =  This involves performing a logistic regression
of each SNP’s data on H. In order to estimate the individual-specific
allele frequency matrix F, we calculate F = logit_1  An important
property to note is that all 72,-,- 6 [0,1] due to the fact that we are
modeling the natural parameter.

Algorithm 2: Estimating Logistic Factors:

1. Apply steps 1—4 of Algorithm 1 to obtain the estimate F)k from
Step 4.

2. Recalling that  is the (i, 7') entry of F*, we choose some C 2 0
and form

S={i:C<7”r;;-<1—C,Vj=1,...,n}.

8 identiﬁes the rows of F)k where the logit function can be
applied stably. Here we use C = 

3. Deﬁne F5 to be the corresponding subset of rows of F*, and cal-
culate L5 = logit(F5). Let L5, be the row-wise mean centered
and standard deviation scaled matrix L5.

4. Perform SVD on 1:5I resulting in L5, = TAWT. Set H to be the
d X 11 matrix composed of the top d — 1 right singular vectors of

the SVD of L5I stacked on the row n-vector (1, 1, - - - , 1):
T
131 : W1:(d—1)

1 1 - - - 1 1

W11 W21 ' ' ' wnl

W12 W22 ' ' ' wnZ

W1,d—1 W2,d—1 ' ' ' wn,d—1

1 1 1

Algorithm 3: Estimating F and L from LFA:

1. Apply Algorithm 2 to X to obtain H.

2. For each SNP i, perform a logistic regression of the SNP geno-
types x,- = (x11,x,-2,...,x,-n) on the rows of H, speciﬁcally by
maximizing the log-likelihood

76,7"
1 — TCiI'

 

‘(nilxi’ﬁl = Zx’llog( ) + 2103“ — 71,7)
i=1

under the constraint that logit(nii) 2 23:1 aikﬁki. It should be
noted that an intercept is included because hdl- = 1 W by

construction.
3. Set 2,,- (i = 1,. . . ,n) to be equal to the maximum likelihood esti-
mates from the above model ﬁt, for each of i: 1,... ,m. Let

L 2 AH, F =10 it_1 L , and ft," be the (i, ') entr ofF:
g I I Y

d
CXp{Z&ikhk/'}
A k=1
—d A .
1 + eXP Zaikbki
k=1
PCA-based estimation of Model 1 requires one application of
SVD and LFA requires two applications of SVD. We leverage the
fact that 11 > d to utilize Lanczos bidiagonalization which is an it-
erative method for computing the SVD of a matrix (Baglama and
Reichel, 2006). Lanczos bidiagonalization excels at computing a

few of the largest singular values and corresponding singular vectors
of a sparse matrix. While the sparsity of genotype matrices is fairly
low, we find that in practice using this method to perform the above
estimation algorithms is more effective than using methods that re-
quire the calculation of all the singular values and vectors. This re-
sults in a substantial reduction of the computational time needed for
the implementation of our methods.

3 Results

We applied our methods to a comprehensive set of simulation stud-
ies and to the HGDP and TGP datasets.

3.1 Simulation studies

To directly evaluate the performance of the estimation methods (see
Section 2.2), we devised a simulation study where we generated syn-
thetic genotype data with varying levels of complexity in population
structure. Genotypes were simulated based on allele frequencies sub-
ject to structure from the BN model, the PSD model, spatially struc-
ture populations and real datasets. For the first three types of
simulations, the allele frequencies were parameterized by Model 1,
while for the real-data simulations, the allele frequencies were taken
from model fits on the data themselves.

A key property to assess is how well the estimation methods cap-
ture the overall structure. One way to evaluate this is to determine
how well S from the PCA-based method (Algorithm 1) estimates the
true underlying S, and similarly how well H from LFA estimates the
true H. Note that even though the genotype data were generated from
the F of Model 1, we can evaluate H by converting with L = logit(F).
To evaluate PCA, we regressed each row of F on S and calculated the
average R2; similarly, for LFA we regressed each row of L on H and
calculated the average R2 value. The results are presented in Table 1.
Both methods estimate the true latent structure well.

Table 1. Accuracy in estimating linear bases for S

 

 

 

Scenario Mean R2
F N S logit(F) N H

TGP ﬁt by PCA 0.9998 0.9722
TGP ﬁt by LFA‘“‘ 0.9912 0.9990
HGDP ﬁt by PCA 0.9996 0.9614
HGDP ﬁt by LFA‘“‘ 0.9835 0.9983
BN 0.9999 0.9999
PSD or = 0.01 0.9998 0.9974
PSD or = 0.1 0.9998 0.9879
PSD or = 0.5 0.9996 0.9827
PSD or = 1 0.9993 0.9844
Spatial a = 0.1 0.9999 0.9964
Spatial a = 0.25 0.9999 0.9962
Spatial a = 0.5 0.9999 0.9964
Spatial a = 1 0.9998 0.9970

 

Column 1 shows the scenario from which the data were simulated.
Columns 2 and 3 display the estimation accuracy of the PCA-based method
(Column 2) and LFA (Column 3). Column 2 shows the mean R2 value when
regressing the true (m1, m2, . . . , m") on S from PCA, averaging across all
SNPs. Column 3 shows the mean R2 value when regressing the true (logit(nz-l),
logit(mz), . . . , logit(mn)) on H from LFA, averaging across all SNPs. All esti-
mated standard errors fell between 10_6 and 10‘8 so these are not shown. Note
for each scenario, R2 values are higher for the method from which the true F
matrix was generated. All but the two scenarios marked with an asterisk ( ") are
from Model 1, while the two marked scenarios are from Model 2, where we
took F = logit—1L

112 /810'SI12umo[p101x0'831112u1101utotqﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

718

W.Hao et al.

 

 

 

 

HGDP
c. 0
3‘, ..  g 
N (‘0 0')
a j; a e
‘1‘? f “‘s ’1
8" 1 i
PC1 PC1 PC2
O. F ‘f
v 3‘. _..  ‘23-... .
N C") CO
L L L
_l on f _l I, _l '-
: .l . 3in. ‘4: . at
‘1 5:2; . a” f a 3o
13" 2 .2
LF1 LF1 LF2

 

 

 

 

 

 

 

AFRICA OAMERICA ICENTRAL_SOUTH_ASIA IEAST_ASIA OEUROPE OMIDDLE_EAST OOCEANIA

 

 

 

 

 

 

 

 

 

 

,ﬁ. 7 3:
“I.  as: ’55.
°. , 1 , " :1.
$43.? 3: . . “2‘3.
,t ' s 1.0 . o
N ‘5' . . . a) .13: ‘ to Q.
o q: ' - . o a o 3..
'1 re: - « m 13.. . . m . 
I. - .
. .13.  . I . 51;?
u...- 5 ‘ .::_ c
'K. m . 'ﬂe
y. “a” “My. “
I ‘- S.  v”
PC1 PC1 P02
A. \ 1'
2f;- 8 '2.
.' ‘I . c ~33.
 ‘73” vi '1 1‘.
N "‘0" " .I ' . or) it or) ' 
LL . - ~ - j u.  u. '.
_| _| _|
I w.  _ , _ 4133‘,
:- ' 1,: °. .1
i  . .. . . .. #595.“
-.~  «Q 115‘"   - a» 3‘
LF1 LF1 LF2
AFRICA_|N_AFR|CA 0 EAST_ASIA_IN_AM/ASIA 0 MEXICO_IN_AM 0 SOUTH_ASIA_IN_AM/ASIA
O AFRICA_|N_AM 0 EUROPE_IN_AM/EU 0 SOUTH_AMERICA

Fig. 2. Principal component and logistic factor biplots for the HGDP and TGP
datasets. The top three principal components from each dataset are plotted in
a pairwise fashion in the top panel. The top three logistic factors are plotted
analogously in the bottom panel. It can be seen that both approaches yield
similar visualizations of structure

We specifically note that when the PSD model was utilized to
simulate structure, we were able to recover the structure S very well
(Supplementary Fig. 52) without needing to employ the computa-
tionally intensive and assumption-heavy Bayesian model fitting
techniques from Pritchard et al. (2000). In addition, it seems that the
5 largely captures the geometry of S where it may be the case that S
can be recovered with a high degree of accuracy by transforming 5
back into the simplex. By comparing the results on the real data
(Fig. 2) with the simulated data (Supplementary Fig. 52), one is able
to visually assess how closely the assumptions of the PSD model re-
semble real datasets. When structure was simulated that differed
substantially from the assumptions of the PSD model, our estima-
tion methods were able to capture that structure just as well
(Supplementary Fig. 53). This demonstrates the ﬂexibility of the pro-
posed approaches.

We also compared PCA and LFA to two methods of fitting the
PSD model, ADMIXTURE (Alexander et al., 2009) and
fastSTRUCTURE (Raj et al., 2014), by determining how well the
methods estimated the individual-specific allele frequencies xii. A
subset of results is shown in Table 2, and the full set of results is
shown in Supplementary Table 51. For the real data scenarios, we
simulated genotypes based on estimates of F from the four different

Table 2. A comparison of accuracy in estimating 7t,-j parameters
where data were simulated from the PSD model for varying (X

 

 

PCA LFA ADX FS

or = 0.01 7.2 x 10—3 7.6 x 10—3 1.7 x 10—1 1.7 x 10—1
or = 0.1 7.2 x 1073 9.3 x 1073 2.4 x 1071 2.4 x 10—1
or = 0.5 7.3 x 1073 9.0 x 10—3 1.8 x 10—1 1.8 x 10—1
or = 1.0 7.4 x 10—3 8.4 x 10—3 2.2 x 10—1 2.2 x 10—1

 

Methods used are the proposed PCA-based method (Algorithm 1) and LFA
method (Algorithms 2 and 3), and two competing methods, ADMIXTURE
(ADX) and fastSTRUCTURE (F5), that directly ﬁt the PSD model. The values
reported are root mean squared error in the 7t,-,- parameter. See Supplementary
Table 51 for more extensive comparisons

methods, thus giving each method an opportunity to fit its own
simulation. The methods were compared by computing three differ-
ent error metrics with respect to the oracle F: Kullback—Leibler di-
vergence, absolute error and root mean squared error
(Supplementary materials, Section 54). PCA and LFA significantly
outperformed ADMIXTURE and fastSTRUCTURE, which confirms
the intuitive understanding of the differences between the models:
the goal of Models 1 and 2 is to estimate the allele frequencies 71,7,
while the PSD model provides a probabilistic interpretation of the
structure by modeling them as admixture proportions.

The computational time required to perform the proposed meth-
ods was also significantly better than ADMIXTURE and
fastSTRUCTURE. Both proposed methods completed calculations on
average over 10 times faster than ADMIXTURE and
fastSTRUCTURE, with some scenarios as high as 150 times faster.
This is notable in that both ADMIXTURE and fastSTRUCTURE are
described as computationally efficient implementations of methods to
estimate the PSD model (Alexander et al., 2009; Raj et al., 2014).

3.2 Analysis of the HGDP and TGP data

We analyzed the HGDP and TGP data using the proposed methods.
The HGDP data consisted of n = 940 individuals and m 2431 345
SNPs, and the TGP data consisted of n = 1500 and m = 339 100 (see
Supplementary materials, Section 51 for details). We first applied
PCA and LFA to these datasets and made bi-plots of the top three
PCs and top three LFs (Fig. 2). It can be seen that PCA and LFA pro-
vide similar visualizations of the structure present in these data. In
addition, the structures estimated by these methods are related, but
not identical, to the population labels provided in the original stud-
ies. We next chose a dimension d for the LFA model (Model 2) for
each dataset. This was done by identifying the value of d that pro-
vides the best overall goodness of fit (Supplementary materials,
Section 52). We identified d =15 for HGDP and d =7 for TGP
based on this criterion.

One drawback of utilizing a PCA-based approach (Algorithm 1)
for estimating the individual-specific allele frequencies F is that we
are not guaranteed that all values of the estimates lie in [0,1], so
some form of truncation is necessary. We found that 65.4% of the
SNPs in the HGDP dataset and 26.5% in the TGP dataset resulted
in at least one estimated individual-specific allele frequency <0 or
>1 before the truncation was applied. Therefore, the truncation in
forming the estimate F is necessary when employing Algorithm 1 to
estimate F from Model 1. On the other hand, due to the formulation
of Model 2, all estimated allele frequencies fall in the valid range
when applying LFA (Algorithms 2 and 3).

The LFA framework provides a natural computational method
for ranking SNPs according to how differentiated they are with

112 /810'S{12umo[p101x0'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Genetic variation in structured populations

719

 

rs1834640 - SL024A5

 

1.00-

0.75- /

o
01
o

\_

 

O
N
01
I
“x

- — AMERICA

CENTRAL_SOUTH_ASIA
r5260690 - EDAR EAST_ASIA
EUROPE

.0
o
o

 

MIDDLE_EAST
OCEANIA

_x
O
O

Estimateg Individual
g,
01

Estimateg Individual-Speciﬁc Allele Frequencies
.‘l . . .
U1

.0
01
o
.
‘_

 

 ‘I

 

 

0.00-

 

250 560 750
Individuals Ordered by Allele Frequency

rs1426654 - SLCZ4A5

 

1.00 -— —-

0.75- /

 

.0

01

o
.

equenCIes
.0
N
01
‘\

 

L -
LL

9

9

‘5 — AFRICA_|N_AFR|CA
Eooo- — AFRICA_|N_AM

8 EAST_AS|A_|N_AM/ASIA
Q rs3827760 - EDAR EUROPE_IN_AM/EU

w MEXICO_IN_AM

I 1-00- SOUTH AMERICA

SOUTH:ASIA_IN_AM/AS|A

.0

01

o
.

 

0.25- /

0.00 '—l I “Inf—J

560 1600
Individuals Ordered by Allele Frequency

 

 

 

Fig. 3. SNPs with highly differentiated allele frequencies with respect to structure. Two of the most highly different SNPs according to LFA are shown for the
HGDP and TGP datasets. For each SNP, the 71,-,- values are ordered and they are colored according reported ancestry. The horizontal bars on the sides of the plots

denote the usual allele frequency estimates formed within each ancestral group

respect to structure. Accurately ranking SNPs according to this dif-
ferentiation is a technique often used to identify genetic polymorph-
isms that are strong candidates for instances of positive selection
(Coop et al., 2009). Note that existing methods typically require one
to first assign each individual to one of K discrete subpopulations
(as done in Coop et al., 2009) which may make unnecessary assump-
tions on modern datasets such as HGDP and TGP. In order to rank
SNPs for differentiation, we calculate the deviance statistic when
performing a logistic regression of the SNPs genotypes on the logis-
tic factors. Specifically, we calculated the deviance by comparing the
models logit(7t,-) = aidhd versus logit(ni) = ZZ=1aikhk, where the
former model is intercept only (i.e. d = 1, no structure).

Our application of LFA to identify SNPs with allele frequencies
differentiated according to structure can be developed further. First,
the recently proposed ‘jackstraw’ approach (Chung and Storey,
2015) provides a manner in which statistical significance can be as-
signed to these SNPs. Assigning statistical significance to the popula-
tion differentiation of SNPs has traditionally been a difficult
problem (Akey et al., 2002). Second, we found the deviance measure
tends to have more extreme values for SNPs with larger minor allele
frequencies (MAFs). Therefore, the ranking of SNPs may be made
more informative if MAF is taken into account. Third, although this
ranking is identifying differentiation and not specifically selection, it
may provide a useful starting point in understanding methods that
attempt to detect selection.

The most differentiated SNPs (Supplementary Tables 52 and 53)
reveal some noteworthy results, especially considering the flexible
approach to forming the ranking. SNPs located within or very close
to SLC24A5 were the top ranked in both HGDP and TGP. This
gene is well known to be involved in determining skin pigmentation
in humans (Lamason et al., 2005 ) and is hypothesized to have been

subject to positive selection (Sabeti et al., 2007). The next most
highly ranked SNPs in both studies are located in EDAR, which
plays a major role in distinguishing phenotypes (e.g. hair follicles)
among Asians. SNP rs3827760 is the second most differentiated
SNP in the TGP data, which has also been hypothesized to be under
positive selection in humans and whose causal role in the hair fol-
licle phenotype has been verified in a mouse model (Kamberov
et al., 2013). SNPs corresponding to these two genes for both studies
are plotted in increasing order of 72,-,- values, revealing subtle vari-
ation within each major ancestral group in addition to coarser dif-
ferences in allele frequency (Fig. 3). Other noteworthy genes with
highly differentiated proximal SNPs include:

° FOXPI, which is a candidate gene for involvement in tumor pro-
gression and plays an important regulatory role with FOXPZ
(Banham et al., 2001; Shigekawa et al., 2011);

° TBC1D1 in which genetic variation has been shown to confer
risk for severe obesity in females (Stone et al., 2006);

° KIF3 C, a novel kinesin-like protein, which has been hypothe-
sized to be involved in microtubule-based transport in neuronal
cells (Sardella et al., 1998);

° KCNMAI, a recently identiﬁed susceptibility locus for obesity
(Jiao et al., 201 1);

° CTNNA3 in which genetic variation has been shown to be asso-
ciated with diisocyanate-induced occupational asthma (Bernstein
et al., 2013);

° PTK6, breast tumor kinase (Brk), which is known to function in
cell-type and context-dependent processes governing normal dif-
ferentiation (Ostrander et al., 2010).

We have provided information on the 5000 most differentiated
SNPs for both TGP and HGDP as Supplementary material files.

22 112 /810'S{12umo[p101x0'sot112u1101utotq/pd11q 111011 pepeolumoq

9m ‘09 lsnﬁnv I10

720

W.Hao et al.

 

4 Discussion

We have investigated two latent variable models of population
structure to simultaneously estimate all individual-specific allele fre-
quencies from genome-wide genotyping data. Model 1, a direct
model of allele frequencies, can be estimated by using a modified
PCA and Model 2, a model of the logit transformation of allele fre-
quencies, is estimated through a new approach we called LFA. For
both models, the latent variables are estimated in a non-parametric
fashion, meaning we do not make any assumptions about the under-
lying structure captured by the latent variables. These models are
general in that they allow for each individual’s genotype to be gener-
ated from an allele frequency specific to that individual, which in-
cludes discretely structured populations, admixed populations and
spatially structured populations. In LFA, we construct a model of
the logit of these allele frequencies in terms of underlying factors
that capture the population structure. We have proposed a computa-
tionally efficient method to estimate this model that requires only
two applications of SVD. This approach builds on the success of
PCA in that we are able to capture population structure in terms of
a low-dimensional basis. It improves on PCA in that the latent vari-
ables we estimate can be straightforwardly incorporated into down-
stream statistical inference procedures that require well-behaved
estimates of allele frequencies. In particular, statistical inferences of
Hardy—Weinberg equilibrium, PST, and marker-trait associations are
amenable to complex population structures within our framework.

We demonstrated our proposed approach on the HGDP and
TGP datasets and several simulated datasets motivated by the
HapMap, HGDP and TGP datasets as well as the PSD model and
spatially distributed structures. It was shown that our method esti-
mates the underlying logistic factors with a high degree of accuracy.
We also showed that applying PCA to genotype data estimates a
row basis of population structure on the original allele frequency
scale to a high degree of accuracy. However, problems occur when
trying to recover estimates of individual-specific allele frequencies
because PCA is a real-valued model that does not always result in al-
lele frequency estimates lying between 0 and 1.

Although PCA has become very popular for genome-wide genotype
data, it should be stressed that PCA is fundamentally a method for
characterizing variance and special care should be taken when applying
it to estimate latent variables. The authoritative treatment of PCA
(Jolliffe, 2010) eloquently makes this point throughout the text and
considers cases where factor analysis is more appropriate than PCA
through examples reminiscent of the population structure problem.
Here, we have shown that modeling and estimating population struc-
ture can be understood from the factor analysis perspective, leading to
estimates of individual-specific allele frequencies through their natural
parameter on the logit scale. At the same time, we have avoided some
of the difficulties of traditional parametric factor analysis by maintain-
ing the relevant non-parametric properties of PCA, specifically in mak-
ing no assumptions about the underlying probability distributions of
the logistic factors that capture population structure.

Funding
This research was supported in part by NIH grant R01 HG006448.

Conﬂict of Interest: none declared.

References

1000 Genomes Project Consortium (2010) A map of human genome variation
from population-scale sequencing. Nature, 467, 1061—1073.

Akey,].M. et al. (2002) Interrogating a high-density SNP map for signatures of
natural selection. Genome Res., 12, 1805—1814.

Alexander,D.H. et al. (2009) Fast model-based estimation of ancestry in unre-
lated individuals. Genome Res., 19, 1655—1664.

Astle,W. and Balding,D.]. (2009) Population structure and cryptic relatedness
in genetic association studies. Stat. Sci., 24, 451—471.

Baglama,]. and Reichel,L. (2006) Restarted block Lanczos Bidiagonalization
methods. Numer. Algorithms, 43, 251—272.

Balding,D.]. and Nichols,R.A. (1995 ) A method for quantifying differenti-
ation between populations at multi-allelic loci and its implications for inves-
tigating identity and paternity. Genetica, 96, 3—12.

Banham,A.H. et al. (2001) The foxp1 winged helix transcription factor is a
novel candidate tumor suppressor gene on chromosome 3p. Cancer Res.,
61, 8820—8829.

Bartholomew,D.]. et al. (201 1) Latent Variable Models and Factor Analysis: A
Uniﬁed Approach. Wiley Series in Probability and Statistics.

Bernstein,D.I. et al. (2013) Ctnna3 (oc-catenin) gene variants are associated
with diisocyanate asthma: a replication study in a Caucasian worker popu-
lation. Toxicol. Sci., 131, 242—246.

Cann,H.M. et al. (2002) A human genome diversity cell line panel. Science,
296, 261—262.

Chung,N.C. and Storey,J.D. (2015) Statistical signiﬁcance of variables driving
systematic variation. Bioinformatics, 31, 545—5 54.

Collins,M. et al. (2002) A generalization of principal component analysis to
the exponential family. In: Dietterich,T.G. et al. (eds), Proceedings of
Advances in Neural Information Processing Systems (NIPS), MIT Press,
vol. 14, pp. 617—624.

Coop,G. et al. (2009) The role of geography in human adaptation. PLoS
Genet., 5, e1000500.

Corona,E. et al. (2013) Analysis of the genetic basis of disease in the con-
text of worldwide human relationships and migration. PLoS Genet., 9,
e1003447.

Engelhardt,B.E. and Stephens,M. (2010) Analysis of population structure: a
unifying framework and novel methods based on sparse factor analysis.
PLoS Genet., 6, e1001117.

Jiao,H. et al. (2011) Genome wide association study identiﬁes kcnmal contri-
buting to human obesity. BMC Med. Genom., 4, 51.

Jolliffe,I.T. (2010) Principal Component Analysis, 2nd edn. Springer, New York.

Kamberov,Y. et al. (2013) Modeling recent human evolution in mice by ex-
pression of a selected EDAR variant. Cell, 152, 691—702.

Lamason,R.L. et al. (2005 ) Slc24a5, a putative cation exchanger, affects pig-
mentation in zebraﬁsh and humans. Science, 310, 1782—1786.

Lehmann,E.L. and Casella,G. (1998) Theory of Point Estimation, 2nd edn.
Springer, New York.,

Manni,F. (2010). Interview with Luigi Luca Cavalli-Sforza: past research and
directions for future investigations in human population genetics. Hum.
Biol., 82, 245—266.

McCullagh,P. and Nelder,].A. (1989) Generalized Linear Models. Chapman
and Hall, London.

Menozzi,P. et al. (1978) Synthetic maps of human gene frequencies in
Europeans. Science, 201, 786—792.

Novembre,]. and Stephens,M. (2008) Interpreting principal com-
ponent analyses of spatial population genetic variation. Nat. Genet., 40,
646—649.

Ostrander,].H. et al. (2010) Brk/ptk6 signaling in normal and cancer cell mod-
els. Curr. Opin. Pharmacol, 10, 662—669.

Pritchard,].K. et al. (2000) Inference of population structure using multilocus
genotype data. Genetics, 155, 945—95 9.

Raj,A. et al. (2014) fastSTRUCTURE: Variational inference of population
structure in large SNP datasets. Genetics, 197, 5 73—5 89.

Rendine,5. et al. (1999) A problem with synthetic maps: Reply to Sokal et al.
Hum. Biol., 71, 15—25.

Rosenberg,N.A. et al. (2002) Genetic structure of human populations.
Science, 298, 2381—2385.

Rosenberg,N.A. et al. (2005 ) Clines, clusters, and the effect of study design on
the inference of human population structure. PLoS Genet., 1, e70.

Sabeti,P.C. et al. (2007) Genome-wide detection and characterization of posi-
tive selection in human populations. Nature, 449, 913—918.

112 /810'S{12umo[p101x0'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Genetic variation in structured populations

721

 

Sardella,M. et al. ( 1998) Kif3c, a novel member of the kinesin superfamily:
sequence, expression, and mapping to human chromosome 2 at 2p23.
Genomics, 47, 405—408.

Shigekawa,T. et al. (2011) Foxp1, an estrogen-inducible transcription factor,
modulates cell proliferation in breast cancer cells and 5 -year recurrence-free
survival of patients with tamoxifen-treated breast cancer. Hormon. Cancer,
2, 286—297.

Sokal,R.R. et al. (1999). A problem with synthetic maps. Hum. Biol.,
71, 1—13.

Song,M. et al. (2015) Testing for genetic associations in arbitrarily structured
populations. Nat. Genet., 47, 550—554.

Stone,5. et al. (2006 ) Tbc1d1 is a candidate for a severe obesity gene and evi-
dence for a gene/gene interaction in obesity predisposition. Hum. Mol.
Genet., 15, 2709—2720.

Tang,H. et al. (2005 ) Estimation of individual admixture: analytical and study
design considerations. Genet. Epidemiol, 28, 289—301.

Thornton,T. et al. (2012) Estimating kinship in admixed populations. Am. ].
Hum. Genet., 91, 122—138.

112 /810'S{12umo[p101x0'sot112u1101utotq/pd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

