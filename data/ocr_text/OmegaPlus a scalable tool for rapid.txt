Vol. 28 no. 17 2012, pages 2274—2275
APP S N O  doi: 10. 1093/bioinformatics/bts419

 

Genetics and population analysis

Advance Access publicaion July 3, 2012

OmegaPlus: a scalable tool for rapid detection of selective
sweeps in whole-genome datasets

N. Alachiotis*, A. Stamatakis and P. Pavlidis*

The Exelixis Lab, Scientific Computing Group, Heidelberg Institute for Theoretical Studies, 69118 Heidelberg,

Germany
Associate Editor: Jeffrey Barrett

 

ABSTRACT
Summary: Recent advances in sequencing technologies have led
to the rapid accumulation of molecular sequence data. Analyzing
whole-genome data (as obtained from next-generation sequencers)
from intra-species samples allows to detect signatures of positive
selection along the genome and therefore identify potentially
advantageous genes in the course of the evolution of a population.
We introduce OmegaPlus, an open-source tool for rapid detection
of selective sweeps in whole-genome data based on linkage
disequilibrium. The tool is up to two orders of magnitude faster than
existing programs for this purpose and also exhibits up to two orders
of magnitude smaller memory requirements.
Availability: OmegaPlus is available under GNU GPL at http://www.
exelixis-lab.org/software.html.
Contact: n.alachiotis@gmail.com, pavlidisp@gmail.com
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 15, 2012; revised on June 27, 2012; accepted
on June 28, 2012

1 INTRODUCTION

Statistical tests that rely on selective sweep theory (Maynard Smith
and Haigh, 1974) can localize targets of recent and strong
positive selection by analyzing single-nucleotide polymorphism
(SNP) patterns in intra-species multiple sequence alignments. Next-
generation sequencing technologies allow for the rapid and cheap
extraction of data to assess whole- genome variation in single- species
populations. However, applying such statistical tests to whole-
genome data is challenging because of increased execution times
and memory requirements.

Several studies in the last decade have focused on detecting
positive selection in genomes from natural populations of
individuals. Kim and Stephan (2002) developed a composite
maximum likelihood (ML) framework to detect selective sweeps
using the empirical mutation frequencies of polymorphic sites (site
frequency spectrum). This approach was later adapted by Nielsen
et al. (2005) for populations that have experienced past demographic
changes. Kim and Nielsen (2004) proposed the a) statistic to
accurately localize selective sweeps and developed a ML framework
that uses linkage-disequilibrium (LD) information.

In this work, we introduce OmegaPlus, a high-perforrnance
implementation of the a) statistic. To the best of our knowledge,

 

*To whom correspondence should be addressed.

OmegaPlus represents the ﬁrst scalable a) statistic implementation
that can be applied to whole- genome data. Previous implementations
were not suitable for whole-genome analyses: the implementation
by Jensen et al. (2007) is only suitable for analyses of sub-genomic
regions, whereas the implementation by PaVlidis et al. (2010) has
excessive memory requirements even for moderate datasets.

2 THE LD PATTERN OF SELECTIVE SWEEPS

The LD is used to capture the non-random association of alleles
or states at different alignment positions. Selective sweep theory
predicts a pattern of excessive LD in each of the two alignment
regions that ﬂank a recently ﬁxed beneﬁcial mutation. This genomic
pattern can be detected by using the a) statistic.

Assume a genomic region with S SNPs that is split into a left sub-
region L and a right sub-region R with l and S —l SNPs, respectively.
The a) statistic is computed as follows:

a): «9+($51))_1(Zueﬂ§+ZiJeRr3) (1)
(1(S_l))_1 ZieLJERrizj ,

is one common measure of LD that represents the

 

2
l
correlatidn coefﬁcient between sites i and j. Candidate regions for
positive selection are characterized by high a) statistic values since
the average LD is high within the L and R sub-regions but not
across the beneﬁcial mutation (see Section 1 in the Supplementary
Material).

where r

3 FEATURES

OmegaPlus is an open-source C code for Windows and Linux
platforms. We provide a sequential version (OmegaPlus) for
Windows and Linux, as well as two parallel versions for Linux that
exploit ﬁne—grain (OmegaPlus-F) and coarse-grain (OmegaPlus-C)
parallelism (see Sections 2—6 in the Supplementary Material).

3.1 Computational workﬂow

OmegaPlus calculates the a) statistic at N distinct positions in the
alignment. For each position P, 1 fPfN, let kL and kR be the
number of SNPs to the left and to the right of P, respectively,
which are contained within a user-deﬁned genomic region G. Thus,
a number of kL and kR regions are located to the left and right side
of P, each containing a different number of SNPs. The a) statistic is
computed for all kL X kR pairs of sub-regions and the pair for which
a) statistic has the highest value is reported.

 

© The Author(s) 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [3.10'8112(1an[plOJXO'SODBIIIJOJIIlOlQ/[Z(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV uo ::

OmegaPlus

 

To accelerate a) statistic calculations, a 2D matrix M, Ml’mz
Zl<i<j<mri2j, is calculated for each region G. Thereafter, all sums
in Equation (1) are retrieved from M. This avoids redundant

calculations and keeps the memory requirements proportional to
k2, where k is the total number of SNPs in G.

3.2 Input/output

OmegaPlus is a command line tool that only requires ﬁve input
arguments for a typical run: an alignment ﬁle (— input), the number
P of positions at which the a) statistic will be calculated (—grid), a
minimum (—minwin) and maximum (—maxwi r1) size for the L and
R sub-regions, and a name for the speciﬁc run (—r1ame). Additional
command line ﬂags, such as the number of threads (—threads)
for the parallel versions, are described in the manual. Binary data
(derived/ancestral states) in ms (Hudson, 2002) or MaCS (Chen
et al. , 2009) format and DNA data in FASTA format can be analyzed.
For ms and MaCS ﬁles, the length of the alignment (— length) also
needs to be provided by the user.

The program generates three text ﬁles: an information ﬁle, a
warning ﬁle and a report ﬁle. The information ﬁle contains details
about program execution, such as the command line and the run time.
The warning ﬁle reports conﬂicting SNP positions (SNPs which refer
to the same alignment positions) when binary data are analyzed.
Finally, the report ﬁle provides the highest a) statistic value for each
position P. A detailed description of the input and output options is
provided in the manual.

4 USAGE EXAMPLE

To demonstrate the ability to efﬁciently process genome datasets,
we used an off-the-shelf laptop with an Intel Core i5 CPU @
2.53 GHz with 4 GBs main memory running Ubuntu 1004.3.
The X chromosome of 37 Drosophila melanogaster genomes
sampled in Raleigh, North Carolina was analyzed. The sequences
(available from the Drosophila Population Genomics Project at
www. dpgp . org) were converted from fastq to fasta using a
provided script (available at www . dpgp . org) and Solexa quality
score threshold of 30. OmegaPlus was called as follows:

./OmegaP1us—F —maxwin 100000
—minwin 1000
—name DPGP —input DPGP.fa —grid 10000 —threads 4.

We calculated the a) statistic at 10 000 equidistant positions,
assuming that the maximum length of the L and R sub-regions to the
left and right of a beneﬁcial mutation is 100 000 bp. Thus, a selective
sweep may affect at most 200 000 bp in total. The minimum length
of L and R is set to 1000 bp. A few entries of the report ﬁle are shown
below. Each row denotes an alignment position P and the OmegaPlus
score. In this example, there is a peak at position 1079 493.

1077252 1.640796
1079493 48.282642
1081734 2.086421

The alignment comprised 37 sequences and 22 422 827 sites
(339710 SNPs). To analyze such an alignment, OmegaPlus used
less than 2% of the available 4 GBs of main memory. Note
that a peak memory requirement of 20.8% was recorded for
some seconds to temporarily store the alignment in memory,

discard non-polymorphic sites, and compress the remaining SNPs.
Using both physical cores on the laptop and hyper-threading (two
more Virtual cores), the ﬁne-grain version of OmegaPlus required
15 min. Assuming that a selective sweep only affects at most
60 000 bp (—maxwin 3 0 0 0 0) instead of 100 000, the analysis only
takes 5 min.

5 PERFORMANCE

An accuracy evaluation of the a) statistic and comparison to
SweepFinder (Nielsen et al., 2005) has been presented in Pavlidis
et al. (2010). To provide a performance comparison, we generated
a simulated dataset with 500 sequences and 70 000 SNPs using
Hudson’s ms (see Section 5 in the Supplementary Material), and
employed a 12-core AMD Opteron CPU running at 2.2 GHz.
OmegaPlus analyzed this dataset in 71.8 s occupying 75.8 MBs of
main memory, whereas SweepFinder required 783.2 s and 2.7 MBs
of main memory. Note, however, that SweepFinder employs the
site frequency spectrum and not the a) statistic. The a) statistic
implementation by Pavlidis et al. (2010), which attempts to process
the entire alignment at once, required more than 2 days and allocated
~30 GBs of main memory.

To evaluate the parallel implementations, we generated a dataset
with 1000 sequences and 500 000 alignment sites. For this dataset
size, ﬁne—grain parallelism scales better on DNA data. Coarse-grain
parallelism exhibits similar behavior on both data types and scales
better on binary data (see Section 6 in the Supplementary Material).

6 CONCLUSION

We presented OmegaPlus to accurately identify selective sweeps
in whole-genome data using the a) statistic. We intend to further
improve the memory requirements as well as to support additional
ﬁle formats and methods to calculate LD. We also plan to set up
a web-server. User support is provided Via the OmegaPlus Google
group http:// groups. google.com/ group/omegaplus.

Funding: Deutsche Forschungsgemeinschaft grant STA 860/2 (in
part).

Conﬂict of Interest: none declared.

REFERENCES

Chen,GK. et al. (2009) Fast and ﬂexible simulation of DNA sequence data. Genome
Res., 19, 136—142.

Hudson,R.R. (2002) Generating samples under a wright-ﬁsher neutral model of genetic
vanaﬁon.lﬁ0hybnnaﬁcs,18,337—338.

Jensen,J.D. et al. (2007) On the utility of linkage disequilibrium as a statistic for
identifying targets of positive selection in nonequilibrium populations. Genetics,
176,2371—2379.

Kim,Y. and Nielsen,R. (2004) Linkage disequilibrium as a signature of selective sweeps.
Genetics, 167, 1513—1524.

Kim,Y. and Stephan,W. (2002) Detecting a local signature of genetic hitchhiking along
a recombining chromosome. Genetics, 160, 765—777.

Maynard Smith,J. and Haigh,]. (1974) The hitch-hiking effect of a favourable gene.
Genet. Res., 23, 23—35.

Nielsen,R. et al. (2005) Genomic scans for selective sweeps using SNP data. Genome
Res,15,1566—1575.

Pavlidis,P. et al. (2010) Searching for footprints of positive selection in whole-genome
SNP data from nonequilibrium populations. Genetics, 185, 907—922.

 

2275

112 [3.10'SIBIIJHO[plOJXO'SODBIIIJOJIIIOIQ/[Z(11111 moi; pepeolumoq

9IOZ ‘09 lsnﬁnV uo ::

