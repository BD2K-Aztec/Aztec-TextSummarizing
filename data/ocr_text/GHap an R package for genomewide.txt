Bioinformatics Advance Access published June 26, 2016

Bioinformatics, 2016, 1—2

doi: 10.1093/bioinformatics/btw356

Advance Access Publication Date: 9 June 2016
Applications Note

 

 

Genetics and population analysis

GHap: an R package for genome-wide
haplotyping

Yuri T. Utsunomiya1'2'*, Marco Milanesi2'3, Adam T. H. Utsunomiya2'3,
Paolo Ajmone-Marsan4 and José F. Garcia1'2'3

1Departamento de Medicina Veterinéria Preventiva e Reproduqao Animal, UNESP — Univ. Estadual Paulista,
Faculdade de Ciéncias Agrérias e Veterinérias, 14884-900 Jaboticabal, Séo Paulo, Brazil, 2International Atomic
Energy Agency (IAEA) Collaborating Centre on Animal Genomics and Bioinformatics, 16050-680 Araqatuba, Séo
Paulo, Brazil, 3Departamento de Apoio, Produqao e Salide Animal, UNESP — Univ. Estadual Paulista, Faculdade de
Medicina Veterinéria de Araqatuba, 16050-680 Araqatuba, Séo Paulo, Brazil and 4Istituto di Zootecnica, Universita
Cattolica del Sacro Cuore, 29122 Piacenza, Italy

*To whom correspondence should be addressed
Associate Editor: Oliver Stegle

Received on February 12,2016; revised on May 3,2016; accepted on May 31,2016

Abstract

The GHap R package was designed to call haplotypes from phased marker data. Given user—
defined haplotype blocks (HapBIock), the package identifies the different haplotype alleles
(HapAIIeIe) present in the data and scores sample haplotype allele genotypes (HapGenotype)
based on HapAIIeIe dose (i.e. 0, 1 or 2 copies). The output is not only useful for analyses that can
handle muIti—aIIeIic markers, but is also conveniently formatted for existing pipelines intended for

bi—aIIeIic markers.

Availability and implementation: https://cra n. r—project.org/package=G Hap

Contact: ytutsunomiya@gmai|.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The use of high-density marker panels in genomics relies on the con—
cept of linkage disequilibrium (LD) and tagging, such that informa-
tion from unobserved variants can be indirectly captured by
correlation with nearby markers (Bush and Moore, 2012). Methods
for genomic analysis are usually based on single markers, ignoring
that unobserved variants may be better modeled by the use of phase
information (Browning and Browning, 2008). Moreover, the need
for tools to perform haplotype calls from phased data has been
underserved in spite of the growing interest in haplotype—based ana—
lyses in the last years. Here we describe GHap, an R package de—
signed to call haplotypes from phased data. The goal of GHap is to
compute summary statistics for haplotype blocks (HapBlock)
and haplotype alleles (HapAllele), as well as to construct a matrix of
haplotype genotypes (HapGenotype). As a general framework,
each HapAllele can be treated as a pseudo—marker in down—
stream analyses, facilitating the incorporation of phase information

in existing pipelines. This approach differs from competing
methods as it uses HapAllele as markers, instead of hidden haplo-
type states generated by expectation maximization or hidden
Markov models.

2 Implementation

2.1 Loading and manipulating data

The GHap input format is described in the online supplementary in
formation and can be derived from popular phasing programs such
as SHAPEITZ (O’Connell et al., 2014). GHap assumes that family
information, if applicable, has been taken into account during phas—
ing. As GHap assumes known phase, low quality phasing will dir-
ectly impact the reliability of haplotype calls. The phased data is
loaded using ghap.loadpbase(). The ghap.maf() function can be used
to identify markers with low polymorphic information content. The
ghap.subsetpbase() function subsets the data by inactivating

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journalspermissions@oup.com l

91% ‘09 1sn3nv uo sepﬁuv s01 ‘arulomag aIo Amie/gun 112 /§.IO'S[BU.IT10[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIUAAOq

 

 

 

 

 

 

 

 

 

 

 

2 Y. T. Utsunomlya et al.
A a.- -- B a C a.
It name-ed I Asian ._'
Jillian ~ Eurppﬁln <1-
3 J -
mi 3 "  - I.-
w I ' :.-‘;' -:: en-
a. Ei — u'.” g a
D H
E g 9 “‘
II- 8 _ — 1|: _' _
E d w E a I "
El . NI . _
:57! H a N _. -.~-._v:u,|._.-.-.
3' T 34m" Ci _ a
I? I I I l l I I I I I I I I I I I
-I:I.I:ul 41:12 uni: p.02 M4 0 50 1:16 150 2m 2511 IZI so 10th 150 2100 25B
EIgr-nuem 1 Chmnme 2 [I11- Mh] Emma 2 median (In My)

Fig. 1. Examples of applications of the GHap package with Human HapMap Project Phase 3 data. Analyses were based on HapBIocks of 10 markers with overlaps
of 5 markers between consecutive blocks. (A) Clustering of subjects based on a PCA of the HapAIIeIe relationship matrix. (B) Haplotype-based FST for Chinese x
European. (C) Mixed model association analysis using simulated phenotypes. The vertical grey line marks the position of the simulated causal nucleotide, and

the horizontal dashed line marks the Bonferroni significance threshold (P< 2.73 x 10’

specified samples and markers, while ghap.mergepbase() combines
different phased data. The data can be exported using gimp.
outp/oaseO.

2.2 Genome—wide haplotyping procedure

Let a HapBlock be a user—defined set of adjacent markers and the
haplotype library (HapLibrary) be the collection of observed
HapAlleles for that HapBlock. The haplotyping procedure imple—
mented in the gbap.haplotyping() function is straightforward: each
HapAllele in the HapLibrary is treated as a marker, and
HapGenotypes are scored as 0, 1 or 2 allele copies (for more informa-
tion see online supplementary information). HapGenotypes can then
be loaded into R using gloapJoad/oaploo and manipulated with gimp.-
subset/oaploO and gloap.merge/oaplo(), or exported to text file and the
transposed format from PLINK (Purcell et al., 2007) with ghap.ou-
thaploO and gloapJoapthedO, respectively. Typically, the user may
want to target a specific HapBlock based on prior information (e.g.
pre—computed LD blocks). We also provide an alternative approach
through the gloap.blockgen() function, which allows the user to spe—
cify arbitrary windows and step size based on markers or segments.

2.3 Haplotype statistics and auxiliary functions

The gloap.bapstats() function computes a series of summary statistics
for HapAlleles, which includes: number of observations, frequency,
observed number of homozygotes and heterozygotes, expected num—
ber of homozygotes and three different measures of deviations from
Hardy—Weinberg equilibrium. We also implemented a series of auxil—
iary functions, namely ghap.blockstats(), gloapfstO, gloap.ancestml(),
gloapJez'ns/oipo, gloap.pca(), gloap.blmm(), gloapnssoco, gloap.blup()
and gloap.simploeno, to estimate block expected heterozygosity and
number of HapAlleles, haplotype—based FST, HapAllele origin, rela-
tionship matrices, principal components, linear mixed models, associ—
ation analyses, Best Linear Unbiased Predictor (BLUP) and simulate
phenotypes, respectively. Additionally, given a vector of arbitrary
scores for HapAlleles, the gloap.proﬂle() function allows for comput—
ing individual profiles as sum(HapGenotypes "' scores).

3 Examples

We tested GHap using reference phased data available at the
IMPUTE2 (Howie et al., 2009) software website (https://mathgen.
stats.ox.ac.uk/impute/impute_v2.html#reference). These data derive
from the HapMap Project Phase 3 (Altshuler et al., 2010), and com—
prise 1011 subjects from 11 human populations and 20 000 random
SNPs mapping to chromosome 2. This dataset is available through
the ghap.makefile() function. Benchmarking of the main tasks
showed that elapse time scaled linearly with increasing number of

6)

samples and markers in a trial up to 100 000 SNPs and 50 000 sub—
jects (online supplementary information). We performed three ana—
lyses: (i) Principal Components Analysis (PCA); (ii) detection of
divergent loci between Chinese and Europeans and (iii) mixed model
association analysis with phenotypes simulated based on the real
genotypes. Similar analyses can be done following the package docu—
mentation. Although based on a small example set of markers in a
single chromosome, the haplotype calls generated by GHap resolved
the known genetic structure in the HapMap dataset (Fig. 1A) . The
haplotype—based FST analysis (Fig. 1B) identified a previously re-
ported signature of selection in Chinese encompassing EDAR
(Sabeti et al., 2007), with the top scoring HapBlock mapping to its
intragenic region. Finally, the association analysis (Fig. 1C) effi-
ciently pinpointed the HapAllele segregating with the simulated
causal variant.

4 Conclusion

The GHap package provides means for haplotype calling, facilitat—
ing the incorporation of phase information in genome—wide ana—
lyses. The package is available at: https://cran.r—project.org/
packagezGHap.

Funding

This research received financial support from: 8510 Paulo Research
Foundation (FAPESP — http://www.fapesp.br/) (process 2014/01095-8); The
National Council for Scientific and Technological Development (CNPq —
http://www.cnpq.br/) (process 407502/2013-0).

Conﬂict of Interest: none declared.

References

Altshuler,D.M. et al. (2010) Integrating common and rare genetic variation in
diverse human populations. Nature, 467, 52—58.

Browning,B.L. and Browning,S.R. (2008) Haplotypic analysis of Wellcome
Trust Case Control Consortium data. Hum. Genet., 123, 273—280.

Bush,W.S. and Moore,].H. (2012) Chapter 1 1: Genome-wide association
studies. PLOS Comput. Biol., 8, e1002822.

Howie,B.N. et al. (2009) A ﬂexible and accurate genotype imputation method
for the next generation of genome-wide association studies. PLOS Genet., 5,
e1000529.

O’Connell,]. et al. (2014) A general approach for haplotype phasing across the
full spectrum of relatedness. PLOS Genet, 10, e1004234.

Purcell,S. et al. (2007) PLINK: a tool set for whole-genome association and
population-based linkage analyses. Am. ]. Hum. Genet., 81, 559—5 75 .

Sabeti,P.C. et al. (2007) Genome-wide detection and characterization of posi-
tive selection in human populations. Nature, 449, 913—918.

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘BTUJOJTIBD aIo Amie/trqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; pepeommoq

