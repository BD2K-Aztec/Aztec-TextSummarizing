APPLICATIONS NOTE V°" 33.5%.ISgiiéiaiﬁéi’iilff/Zﬁig

 

Gene expression

Advance Access publication March 17, 2014

An R package to analyse LC/MS metabolomic data: MAIT
(Metabolite Automatic Identification Toolkit)

Francesc Fernandez-Albert1’2’*, Rafael Llorao

Alexandre Perera1

h2,3,*

, Cristina Andrés—LacuevaZ’3 and

1B2SLab., Department d’Enginyeria de Sistemes, Automatica i Informatica Industrial, Universitat Politecnica de
Catalunya, ClBER—BBN, Pau Gargallo, 5, 08028 Barcelona, 2Biomarkers & Nutrimetabolomic Lab., Department of
Nutrition and Food Science—XaRTA, INSA, Faculty of Pharmacy, Food and Nutrition Torribera Campus, University
of Barcelona, Av. Prat de la Riba 171, 08921, Sta Coloma de Gramenet, and 3lNGENlO—CONSOLIDER Program,
FUN—C—Food CSD2007—063, Av Joan XXIII s/n 08028, Barcelona, Spain

Associate Editor: Janet Kelso

 

ABSTRACT

Summary: Current tools for liquid chromatography and mass spec-
trometry for metabolomic data cover a limited number of processing
steps, whereas online tools are hard to use in a programmable fashion.
This article introduces the Metabolite Automatic Identification Toolkit
(MAIT) package, which makes it possible for users to perform meta-
bolomic end-to—end liquid chromatography and mass spectrometry
data analysis. MAIT is focused on improving the peak annotation
stage and provides essential tools to validate statistical analysis
results. MAIT generates output files with the statistical results, peak
annotation and metabolite identification.

Availability and implementation: http://b2slab.upc.edu/software—
and-downloads/metabolite—automatic-identification-toolkit/.

Contact: francesc.fernandez.albert@upc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online

Received on September 20, 2013; revised on February 28, 2014;
accepted on March 4, 2014

1 INTRODUCTION

Liquid chromatography and mass spectrometry (LC/MS) is an
analytical technique used widely in metabolomics to detect mol-
ecules in biological samples (Theodoridis et al., 2012). A wide
array of software tools is available for LC/MS proﬁling data
analysis, including commercial, programmatic and online tools.
A commercial example is Analyst®, whereas some open-source
packages permit programmatic processing, such as the R pack-
age XCMS (Smith et al., 2006) to detect peaks or CAMERA
(Kuhl et al., 2012) and AStream (Alonso et al., 2011) for peak
annotations. There have been efforts on just peak annotation
using JAVA (Brown et al., 2011). MZmine and szatch are
modularized tools coded in JAVA that are focused on LC/MS
data preprocessing and visualization (Katajamaa et al., 2006;
Pluskal et al., 2010; Scheltema et al., 2011). Online tools permit
sample processing through a web Graphical User Interface,
such as XCMSOnline (http://xcmsonline.scripps.edu) or
MetaboAnalyst OCia et al., 2009). Refer to Supplementary

 

*To whom correspondence should be addressed.

Table S1 for a comparative between the capabilities for some
of the main available tools. In this context, we introduce a new
R package called Metabolite Automatic Identiﬁcation Toolkit
(MAIT) for automatic LC/MS analysis. The goal of the MAIT
package is to provide an array of tools that makes program-
mable metabolomic end-to-end statistical analysis possible (see
Section 3 of the Supplementary Material for details about the
MAIT modularity). MAIT includes functions to improve peak
annotation through the process called biotransformations and to
assess the predictive power of statistically signiﬁcant metabolites
that quantify class separability.

2 METHODS

MAIT includes the stages peak detection, peak annotation, statistical
analysis and table and plots creation (Fig. 1). The peak detection stage
detects the peaks in the LC/MS sample ﬁles. The peak annotation stage
improves the identiﬁcation of the metabolites in the metabolomic samples
by increasing the chemical and biological information in the dataset. A
statistical analysis reveals the signiﬁcant sample features and measures
their predictive power. MAIT uses the R package XCMS to detect and
align peaks. For the peak annotation step, MAIT uses three steps:

0 First, MAIT uses the CAMERA package to perform the ﬁrst anno-
tation step (Kuhl et al., 2012). In this stage, MAIT uses a peak
correlation distance and a retention time window to ﬁnd which
peaks came from the same source metabolite based. The peaks
within each peak group are annotated following a reference
adduct/fragment table and a mass allowance window.

Biotransformations could be related to speciﬁc in-source mass losses.
Therefore, in the second annotation step, they are detected using a
mass allowance window inside the peak groups (Breitling et al.,
2006). For this search, MAIT already includes a biotransformations
table (here Human biotransformations). User-deﬁned biotransform-
ation tables can be set as input, following the procedure deﬁned in
Supplementary Text (Section 6.6).

0 Finally, a predeﬁned metabolite database is mined for signiﬁcant
masses. This identiﬁes metabolites with the help of the Human
Metabolome Database (Wishart et al., 2009), 2009/07 version.

The objective of analysing the metabolomic proﬁling data is to obtain
the statistically signiﬁcant features (SSF) that contain the highest amount
of class-related information. To gather these features, MAIT can apply
statistical tests such as ANOVA or Student’s t-test to every feature,

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re-use, please contact journals.permissions@oup.com

112 ﬂJO'slcumo[pJOJXO'sopchoguioiq/ﬁdnq IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

F.Fernéndez-Albert et al.

 

   
       
   

 

  
    

 

   
 
 
   
 

 

 

Output Files MAIT Functions Functionality
spectra.csv peakAnnotation ---:
ilé§§E€éeEé§EEéﬁi 2:321:22?“
significa ntFeatu res.csv spectra|5ig Features - -:
metaboliteTable.csv
Validation folder

Fig. 1. Correspondence between MAIT functions (centre column), gen-
erated output ﬁles (left column) and their functionality (right column)

selecting the signiﬁcant set of features given a threshold P-value.
A validation test is included to quantify SSF class separability by a re-
peated random subsampling cross-validation using three methods: partial
least squares and discriminant analysis, support vector machines and K-
nearest neighbours (Hastie et al., 2009). MAIT computes overall and
class-related classiﬁcation ratios to evaluate the SSF class-related
information.

3 RESULTS

The example data ﬁles are a subset of the data used in the ref-
erence (Saghatelian et al., 2004), which are distributed freely
through the faahKO package (Smith, 2012). MAIT was used
to read and analyse these samples using the functions depicted
in Figure 1 (see the tutorial in the Supplementary Information).
The signiﬁcant features for each class are found using statistical
tests and analysed through the different plots that MAIT pro-
duces. Using the following function call, 2640 peaks were
detected:

R> MAIT <— sampleProcessing (dataDir
= ‘ ‘Dataxcms’ ’ , project 2 ‘ ‘MAIT_Demo’ ’ ,
snThres = 2 , rtStep = O . 03)

At this point, the ﬁrst annotation stage is launched:

R> MAIT <— peakAnnotation (MAIT . object
2 MAIT)

Next, we gather the signiﬁcant features from the peaks de-
tected. After the Welch’s tests, 106 of these features were
found to be signiﬁcant through the spectralSigFeatures function.
Statistical plots such as heat maps, boxplots and principal com-
ponent analysis score plots can be generated (Supplementary
Figs S3 and S4). Signiﬁcant features are annotated after checking
for certain neutral losses (biotransformations).

R> MAIT <— spectralSigFeatures (MAIT,
P = 0 . 05)

R> MAIT <— Biotransformations (MAIT,
peakPrecision = O . 005)

By using only the SSF, a validation stage is launched, obtain-
ing a classiﬁcation ratio of 100% with three training samples for
all classiﬁers. These results suggest that the signiﬁcant variables
separate both classes completely.

R> MAIT <— Validation(MAIT, Iterations = 20,
trainSamples = 3)

Finally, the database is mined to identify the signiﬁcant
features.

R> MAIT <— identifyMetabolites (MAIT,
peakTolerance = O . 005)

4 CONCLUSIONS

MAIT provides a set of tools and functions to perform an auto-
matic end-to-end analysis of LC/MS metabolomic data, putting
special emphasis on peak annotation and metabolite identiﬁca-
tion. In addition, MAIT validation functions make it possible to
estimate predictive power for signiﬁcant variables.

Funding: Spanish national (grants AGL2009—13906—C02—01/ALI
and AGL2010—10084—E), the CONSOLIDER INGENIO 2010
Programme, FUN-C-FOOD (CSD2007—063) from the
MICINN and Merck Serono 2010 Research Grants
(Fundacién Salud 2000). Spanish Ministerio de Ciencia y
Tecnologia through TEC2010-20886—C02—02 and TEC2010-
20886—C02—01 (in part) AP. is part of the 2009SGR—1395 con-
solidated research group of the Generalitat de Catalunya, Spain.
CIBER—BBN is an initiative of the Spanish ISCIII. R.L. thanks
the MICINN and the European Social Funds for their ﬁnancial
contribution to the R. L. Ramon y Cajal contract (Ramon y
Cajal Programme, MICINN-RYC). F .F .-A. thanks
EVALXARTA—UB and Agencia de Gestic') d’Ajuts
Universitaris I de Recerca, AGAUR (Generalitat de
Catalunya), for their ﬁnancial support.

Conflict of Interest: none declared.

REFERENCES

Alonso,A. et al. (2011) AStream: an R package for annotating LC/MS metabolomic
data. Bioinformatics, 27, 1339—1340.

Breitling,R. et al. (2006) Ab initio prediction of metabolic networks using Fourier
transform mass spectrometry data. Metabolomics, 2, 155—164.

Brown,M. et al. (2011) Automated workﬂows for accurate mass-based putative
metabolite identiﬁcation in lc/ms-derived metabolomic datasets.
Bioinformatics, 27, 1108—1112.

Hastie,T. et al. (2009) The Elements of Statistical Learning. 2 edn. Springer,
New York.

Katajamaa,M. et al. (2006) MZmine: toolbox for processing and visualization of
mass spectrometry based molecular proﬁle data. Bioinformatics, 22, 634—636.

Kuhl,C. et al. (2012) CAMERA: An Integrated Strategy for Compound Spectra
Extraction and Annotation of Liquid Chromatography/Mass Spectrometry
Data Sets. Analytical Chemistry, 84, 283—289.

Pluskal,T. et al. (2010) MZmine 2: modular framework for processing, visualizing,
and analyzing mass spectrometry-based molecular proﬁle data. BM C
Bioinformatics, 11, 395.

 

1 938

112 ﬂJO'slcumo[pJOJXO'sopchogutotq/ﬁdnq IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

MAIT

 

Saghatelian,A. et al. (2004) Assignment of endogenous substrates to enzymes by
global metabolite proﬁling. Biochemistry, 43, 14332—14339.

Scheltema,R.A. et al. (2011) PeakML/szatch: a ﬁle format, Java library, R li-
brary, and tool-chain for mass spectrometry data analysis. Anal. Chem., 83,
2786—2793.

Smith,C.A. (2012)faahK0.' Saghatelian et al. ( 2004 ) FAAH knockout LC/MS data.
R package version 1.2.15. http://dx.doi.org/ 10.102l/bi0480335.

Smith,C.A. et al. (2006) XCMS: processing mass spectrometry data for metabolite
proﬁling using nonlinear peak alignment, matching, and identiﬁcation. Anal.
Chem., 78, 779—787.

Theodoridis,G.A. et al. (2012) Liquid chromatography-mass spec-
trometry based global metabolite proﬁling: a review. Anal. Chim. Acta, 711,
7—16.

Wishart,D.S. et al. (2009) Hmdb: a knowledgebase for the human metabolome.
Nucleic Acids Res., 37, D603—D610.

Xia,J. et al. (2009) Metaboanalyst: a web server for metabolomic data analysis and
interpretation. Nucleic Acids Res., 37 (Suppl. 2), W652—W660.

 

1 939

112 /810'S{12umo[pJOJXO'sot112u1101utotq//2d11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

