Advance Access Publication Date: 10 December 2015

Bioinformatics, 32(8), 2016, 1278—1280
doi: 10.1093/bioinformatics/btv728

Applications Note

 

 

Bioimage informatics

SpotCaliper: fast wavelet-based spot detection

with accurate size estimation

Zsuzsanna Pﬁspoki, Daniel Sage, John Paul Ward* and

Michael Unser

Biomedical Imaging Group, Ecole polytechnique fédérale de Lausanne (EPFL), Lausanne CH-1015, Switzerland

TPresent address: Department of mathematics, University of Central Florida, Orlando, FL 32816, USA

Associate Editor: Alfonso Valencia

Received on 17 August 2015; revised on 12 November 2015; accepted on 4 December 2015

Abstract

Motivation: SpotCaliper is a novel wavelet—based image—analysis software providing a fast auto—
matic detection scheme for circular patterns (spots), combined with the precise estimation of their
size. It is implemented as an lmageJ plugin with a friendly user interface. The user is allowed to
edit the results by modifying the measurements (in a semi—automated way), extract data for further
analysis. The fine tuning of the detections includes the possibility of adjusting or removing the ori—

ginal detections, as well as adding further spots.

Results: The main advantage of the software is its ability to capture the size of spots in a fast and

accurate way.

Availability and implementation: http://bigme.epfl.ch/algorithms/spotcaliper/

Contact: zsuzsanna.puspoki@epfl.ch

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The focus of our article is the analysis of circular objects (spots),
since their detection and size estimation is fundamental in the image
processing of micrographs. Our method/software can be applied to
a broad class of images; it is not linked to one specific biological
problem. However, we note two particular applications, where the
precise detection of the spots and their radius estimation is of high
interest. First, in antimicrobial susceptibility testing of significant
bacterial isolates, the size of the zones of the inhibition areas are
measured and used as an indicator of antibiotics resistance (suscep—
tible, intermediate or resistant) (Jorgensen, 2009). Second, detection
and size measurements are also important for understanding
ELISpot images (Lehmann, 2005).

2 Features and methods

There are several existing methods for the detection of circular ob—
jects and measuring their radii. Some typical examples cover mor—
phological operators, the Circle Hough Transform, the Laplacian of

Gaussian (LOG) and its multiscale extension (Lindeberg, 1998), the
determinant of Hessian (DoH) and wavelet—based techniques
(Olivo-Marin, 2002). Dyadic wavelet schemes are considered a
powerful tool and they are widely used for feature extraction. They
provide a multiscale decomposition scheme and allow a high level
abstraction from the data. However, the dyadic hierarchy of the typ—
ical wavelet schemes introduces difficulties in the precise estimation
of the size of the objects, since the between—scale details are diffused
among the wavelet coefficients.

In the presented software, we use a novel wavelet scheme that
we have developed. Our wavelets approximate intermediate scales
by using several patterns (channels) that can be linearly combined
with adjustable coefficients, to create disk patterns with continu—
ously varying sizes in between two sequential (discrete) wavelet
scales.

The starting point for our algorithm is a dyadic tight wavelet
frame that provides a redundant multi—scale decomposition of an
image (in particular, we use a Meyer—type tight wavelet frame
(Daubechies, 1992). We generate our scalable wavelet frame using
scalable filters. A filter is scalable if it and all of its scaled versions

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1278

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘ETUJOJHBQ aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

SpotCaliper: fast wavelet-based spot detection

1279

 

can be expressed in a finite basis. We apply a particular basis of scal—
able filters to our dyadic tight wavelet frame to create wavelet chan—
nels, and the resulting wavelet frame is arbitrarily scalable.

The wavelet coefficients of an image f at location x and dyadic
scale a are computed as g(x) = , ‘I’a(- — x)), where

‘Pat —x) = an(a)%(- —x), (1)

with ‘I’ denoting the scalable wavelet, n the channel, and 6],, the

C 7

wavelet coefficients with respect to the channels. The symbol

represents the implicit (hidden) variable. Thus, we obtain
g(x) : an(a)<fa _  : an(a)gn- (2)

Since our wavelets, generated by such a method, are scaled con—
tinuously, we estimate the scale of objects much more precisely than
what is afforded by traditional dyadic wavelet schemes. It is enough
to perform the filtering operations once, the response for any spe—
cific scale being retrieved by the linear combination of a few pre—
computed components. Due to the scaling property of the detector
wavelet, the detections are obtained in a fast and computationally
effective way. The in—between—scale details are not lost, thanks to
the scalable design. We note that our algorithm is able to handle
overlapping spots as well.

For a thorough description on the mathematical background of
our algorithm, we refer to (Piispoki et al. 2015).

3 The spot detection and size estimation
algorithm

The detection algorithm comprises the following steps:

1. Wavelet analysis with the proposed wavelet scheme: We com-
pute the wavelet coefﬁcients for each pixel.

2. Local maxima detection: We apply a local non-maximum sup-
pression on the magnitude of the wavelet coefﬁcients in order to
prevent multiple detections of the same spot.

3. Fine estimation of the radius: Based on the set of candidate
points selected in step (2.), we provide an estimation of scale at
those locations. Since our wavelets are scaled on a quasi—con—
tinuum, we obtain precise results; the local scale is chosen to
maximize the detector response of the proposed wavelet.

4. Selection: We choose the best N results based on an image—
adapted measure (e.g. highest detector response).

5. Visualization of the detections: The user is able to edit the results
and their visualization in several ways. For further information,
we refer to the supplementary material.

4 Results and validation

To evaluate the performance of the algorithm, we tested it on a var—
iety of synthetic images in the presence of background signal, and fi-
nally on real microscope images. We generated a series of test
images of size (512 X 512). The location of the spots and their radii
was chosen in a way that the ground truth data contained 50 disks,
with radii varying between 8 and 40 pixels. Overlap was allowed be—
tween neighboring objects, by at most 10 pixels. The results are
summarized in Figure 1. For a thorough description of the evalu—
ation and the corresponding experiments we refer to our supplemen
tary material called Experiments.

Based on the graphs (Fig. 1A and B) we can confirm that our
method performs better than other competing methods with respect

)5, 11111813

 

'1'- SpotCaliper {nuts}
'1.- Cirele Hough transform
Multiseale LoG

'- Threshold and
Connected Components

w

  

 

 

 

Limo. [ms]

l
DIDDDIMGSDMJDDGSMJBODUFMGEMJMIM

 

Fig. 1. (A) RMS error of radius estimation as a function of running time; noise
free case. (B) Rate of detections estimated by the Jaccard index J under iso-
tropic background signal, as a function of the standard deviation 0' of the
background fluorescence. (C) Detections using our wavelet-based method on
an image with isotropic Brownian motion (mean 0, SD 4). (D) Semi-auto-
mated detection of spots on an ELISpot image. (E) Automatic detection and
scale estimation of fluorescence cells on a microscopy image

to computational time, accuracy, and robustness against back—
ground with varying intensity. The quality of the detections are
illustrated on synthetic data (Fig. 1C) and biological micrographs
(Fig. 1D and E). The original test images and the corresponding par—
ameter settings are presented in the Experiments supplementary
material.

9mg ‘Og 1snﬁnv uo sojoﬁuv s01 ‘BTUJOJTIED JO Amie/nun 112 /3.IO'S[BIIJHOprOJXO'SOTlﬂulJOJUTOTQ/ﬂClllq 11101; popeommoq

1280

Z.PL'ispo'ki et al.

 

Funding

The research leading to these results has received funding from the European
Research Council under the European Union’s Seventh Framework
Programme (FP7/2007—2013)/ERC grant agreement nO 267439. The work
was also supported by the Hasler Foundation.

Conﬂict of Interest: none declared.

References

Daubechies,I. (1992). Ten Lectures on Wavelets. Society for Industrial and
Applied Mathematics.

Jorgensen,].H. and Ferraro,M.]. (2009) Antimicrobial susceptibility testing: A
review of general principles and contemporary practices. Clin. Infect. Dis.,
49, 1749—1755.

Lehmann,P.V. (2005). Image analysis and data management of elispot assay
results. In: Kalyuzhny,A. (ed.) Handbook of ELISPOT, Volume 302 of
Methods in Molecular Biology. Humana Press, pp. 1 17—131.

Lindeberg,T. (1998) Feature detection with automatic scale selection. Int. ].
Comput. Vision, 30, 79—116.

Olivo-Marin,].C. (2002) Extraction of spots in biological images using multi-
scale products. Pattern Recogn., 35, 1989—1996.

Pﬁspoki,Z. et al. (2015) On the continuous steering of the scale of tight wave-
let frames. ArXiv e—Prints, arXiv:1512.02072, 2015.

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

