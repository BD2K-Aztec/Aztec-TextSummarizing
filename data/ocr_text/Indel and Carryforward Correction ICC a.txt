ORIGINAL PAPER

Vol. 29 no. 19 2013, pages 2402—2409
doi:10. 1093/bioinformatics/btt434

 

Sequence analysis

Advance Access publication July 29, 2013

Indel and Carryforward Correction (ICC): a new analysis approach
for processing 454 pyrosequencing data

Wenjie Deng, Brandon S. Maust, Dylan H. Westfall, Lennie Chen, Hong Zhao,
Brendan B. Larsen, Shyamala lyer, Yi Liu and James |. Mullins*
Department of Microbiology, University of Washington School of Medicine, Seattle, WA 98195, USA

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: Pyrosequencing technology provides an important new
approach to more extensively characterize diverse sequence popula-
tions and detect low frequency variants. However, the promise of this
technology has been difficult to realize, as careful correction of
sequencing errors is crucial to distinguish rare variants (~1%) in an
infected host with high sensitivity and specificity.

Results: We developed a new approach, referred to as Indel and
Carryforward Correction (ICC), to cluster sequences without substitu-
tions and locally correct only indel and carryforward sequencing errors
within clusters to ensure that no rare variants are lost. ICC performs
sequence clustering in the order of (i) homopolymer indel patterns
only, (ii) indel patterns only and (iii) carryforward errors only, without
the requirement of a distance cutoff value. Overall, ICC removed
93—95% of sequencing errors found in control datasets. On pyrose-
quencing data from a PCR fragment derived from 15 HIV-1 plasmid
clones mixed at various frequencies as low as 0.1%, ICC achieved the
highest sensitivity and similar specificity compared with other com-
monly used error correction and variant calling algorithms.
Availability and implementation: Source code is freely available for
download at http:/ﬁndra.mullins.microbio|.washington.edu/ICC. It is
implemented in Perl and supported on Linux, Mac OS X and MS
Windows.

Contact: jmullins@uw.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 1, 2013; revised on July 2, 2013; accepted on
July 25, 2013

1 INTRODUCTION

Massively parallel sequencing (MPS) technologies, such as 454
pyrosequencing (Margulies et al., 2005), are becoming common
to rapidly and cost-effectively detect and quantitate rare
sequence variants. Pyrosequencing generates up to millions of
reads that can include rare variants to detect low frequency
drug resistance and immune escape variants in viral (Human
immunodeﬁciency virus [HIV] and Simian immunodeﬁciency
virus [SIV]) populations (Bimber et al., 2009, 2010; Burwitz
et al., 2011; Fischer et al., 2010; Hedskog et al., 2010; Henn
et al., 2012; Love et al., 2010; O’Connor et al., 2012; Poon
et al., 2010; Simen et al., 2009; Tsibris et al., 2009; Wang et al.,

 

*To whom correspondence should be addressed.

2007). However, the PCR required before pyrosequencing of
HIV/SIV populations introduces misincorporation errors, and
the pyrosequencing process introduces a signiﬁcant number of
indels and carryforward errors (Margulies et al., 2005). To ac-
curately estimate population diversity by MPS, it is crucial to
distinguish biological variants from process errors with high sen-
sitivity and speciﬁcity. Previous studies of 454 pyrosequencing
data have managed to reduce sequence-processing errors by im-
proving PCR and sequencing platforms (Gilles et al., 2011; Huse
et al., 2007; Shao et al., 2013; Vandenbroucke et al., 2011; Wang
et al., 2007). Also, several error correction and variant calling
algorithms have been published (Archer et al., 2010; Bragg et al.,
2012; Eriksson et al., 2008; Huse et al., 2010; Macalalad et al.,
2012; Prosperi and Salemi, 2012; Quince et al., 2009, 2011;
Ramirez-Gonzalez et al., 2013; Reeder and Knight, 2010;
Salmela and Schréder, 2011; Wang et al., 2007; Zagordi et al.,
2010a, b, 2011). Salmela and Schréder (Salmela and Schréder,
2011) used multiple alignments of reads as well as quality scores
to distinguish correct base calls from erroneous ones, and their
method is easily adjustable to reads derived from different MPS
platforms. Prosperi and Salemi (Prosperi and Salemi, 2012) de-
veloped a program for viral population reconstruction with a
built-in Poisson error correction method and post-reconstruction
probabilistic clustering. Macalalad et al. (2012) introduced V-
Phaser, a single nucleotide variant calling tool that uses phase
and quality ﬁltering with a probability model that incorporates
and recalibrates individual base quality scores to increase both
sensitivity and speciﬁcity. Sequence clustering is also a common
way to reduce sequencing errors. One approach is to cluster se-
quences using genetic distances (Bragg et al., 2012; Huse et al.,
2010). Another approach is based on ﬁowgrams rather than se-
quences, which allows pyrosequencing errors to be modeled nat-
urally, as performed by Quince et al. (2009, 2011) and Reeder &
Knight (2010). Both approaches require a distance cutoff value
that combines substitutions, insertions and deletions in a single
distance measure. The cluster centers are haplotypes, and the
cluster sizes are interpreted as the haplotype frequency in the
population. Error correction in a cluster is performed by collap-
sing variation within the cluster. Therefore, there is a risk for loss
of real variants in a population if an inappropriate cutoff value is
set, especially in a population of low genetic diversity.

To address the challenge of detecting genetic variants, espe-
cially those occurring at low frequencies, we developed a new
approach that clusters sequences without substitutions and lo-
cally corrects only indel and carryforward errors within clusters

 

2402 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 ﬁle'srcumo[pJOJXO'sopchogurorq/ﬁd11q IIIOJJ popcorn/hog

910K ‘09 lsnﬁnV no :2

Indel and Carryforward Correction

 

to ensure that no rare variants are lost. Indel and Carryforward
Correction (ICC) provides a complete suite for users to analyze
pyrosequencing data, including read quality ﬁltering and align-
ment, indel and carryforward error correction, variant calling
and calculation of single nucleotide variant and haplotype fre-
quencies. To determine the efﬁciency of ICC in correcting errors,
we calculated and compared error rates before and after ICC
correction on datasets derived from previously sequenced plas-
mid DNAs. Using pyrosequencing data of PCR fragments
derived from a mixture of 15 HIV-1 plasmid clones at various
frequencies, we used ICC to estimate sensitivity and speciﬁcity
and compared these results with several other commonly used
error correction and variant calling algorithms.

2 SAMPLE PREPARATION AND
PYROSEQUENCING

2.1 Control datasets

pNL4-3, a plasmid containing a full-length HIV-1 genome, served
as a control for pyrosequencing error calculations and compari-
sons. Two sets of ﬁrst round PCR products were generated with
primers that targeted portions of the gag-pol genes to produce a
2.6 kb amplicon and the env gp120 coding sequence for a 2.1kb
amplicon. Nested second round PCR reactions were multiplex
PCRs that generated four amplicons (gag3, poll, env3 and env5)
from the mixture of two ﬁrst round products that ranged from 391
to 597 bp in size with primers containing the 454 sequencing adap-
ter and Multiplex Identiﬁer (MID) adapter (Supplementary
Table S1). PCR reactions are described in supplementary data.

2.2 HIV-1 plasmid mixture

Fifteen HIV-1 plasmid clones (Rousseau et al., 2006) were mixed
to reach the ﬁnal proportions (Supplementary Table S2), with
individual DNA concentrations determined using a Nanodrop
instrument (Thermo Scientiﬁc, USA). The plasmid mixture was
further quantiﬁed by limiting dilution endpoint PCR (Rodrigo
et al., 1997) with the program Quality (http://indra.mullins.
microbiol.washington.edu/quality/). An estimated maximum of
1000 (691 :l: 310) plasmid molecules were used as templates for
PCR ampliﬁcation and subsequent pyrosequencing. Primers and
nested PCR conditions were the same as for pNL4-3 mentioned
previously (and see Supplementary Data).

2.3 HIV-1 clinical sample

RNA was extracted from ﬁve plasma specimens from one HIV-1
infected individual from the Seattle Primary Infection Cohort
(Schacker et al., 1996; Stekler et al., 2012) using the QIAamp
Viral RNA Mini Kit (Qiagen, Valencia, CA) according to the
manufacturer’s protocol. A total of 560 pl of plasma was ex-
tracted in each case and eluted in 80 ul of elution buffer.
cDNA was synthesized using Takara BluePrint First
Strand Synthesis Kit (Clontech 6115A) according to the manu-
facturer’s protocol. cDNA was synthesized with gene speciﬁc
primers, R3337—1 (5’-TTTCCYACTAAYTTYTGTATRTCAT
TGAC—3’) for gag-pol and R9048 (5’-AGCTSCCTTGTAA
GTCATTGGTCTTARA-3’) for gp120, at ﬁnal concentrations
of 400 nM. Fragments of gag-pol (2.6 kb) and em (2.1kb) were

ampliﬁed in ﬁrst round reactions separately, then mixed together
and used as template for multiplex second round ampliﬁcation of
a 505 bp gag and a 597 bp env fragment (gag3 and env5)
(Supplementary Table S1). PCR ampliﬁcations are described in
supplementary data.

PCR products were visualized using a Qiaxcel (Qiagen, USA),
puriﬁed using Agencourt AMPure beads (Beckman Coulter,
USA) and then pyrosequenced on the 454 Life Sciences GS-
F LX Titanium platform according to the manufacturer’s
protocols.

3 ALGORITHM
3.1 Multiple sequence alignment

Sequences in a user-deﬁned window were aligned using the
Needleman—Wunsch algorithm (Needleman and Wunsch, 1970).
First, sequences were collapsed so that only unique sequences
were presented, and unique sequences were ranked by their abun-
dance. The two most abundant unique sequences S1 and S2 were
pairwise aligned using dynamic programming (Gusﬁeld, 1997):

Z S(—,Sz(k)) (i = 0)

lsksj

Z.S(S1(k),—) (1': 0)
V(i,j) = 19‘5‘ (1)

V(i — 1,j — l) + S(S1(l'), 52(1))
max V(z' — l, ') + $0310.)» —)
V(z',j — 1) + s(—, $20))

V(i,j) is deﬁned as the value of the optimal alignment of preﬁxes
S1[1..z] and S2[1..]]. s(x,y) denotes the score obtained by aligning
character x against character y. Second, the proﬁle of the align-
ment was computed, taking into account the abundances of the
aligned unique sequences. The third most abundant unique
sequence was then aligned to the proﬁle, which produced a
new multiple sequence alignment including the ﬁrst three most
abundant unique sequences:

SJ
I _ ;_s(sl<k>,—> (j: 0)
W1): V(i—_1,j— 1) +S(S1(z'),j) (2)
max V(l' — 1,j) + S(S1 (i), —)

V(l'-J' - 1) + S(-,J')

V(i,j) denotes the value of the optimal alignment of preﬁx
S1[1..z] with the ﬁrst j columns of the proﬁle. For a character y
and column j, let p(y,j) be the frequency that character y appears
in column j of the proﬁle; S(x,j) denotes Z}, [s(x, y) x p(y,j)], the
score for aligning x with column j. The process of calculating the
proﬁle of the newly produced multiple sequence alignment and
aligning the next most abundant unique sequence to the updated
proﬁle was repeated until the last unique sequence was aligned.
The default scoring parameters for alignment were as follows:
match, 10; mismatch, -9; gap penalty, -15.

3.2 Computing sequence similarity and edit transcript

The similarity of two sequences, and associated optimal align-
ment and edit transcript, can be computed by dynamic program-
ming (Gusﬁeld, 1997). An edit transcript is a string over the

 

2403

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ popcorn/hog

910K ‘09 lsnﬁnV no :2

W.Deng et al.

 

alphabet I (insertion), D (deletion), R (replacement or substitu-
tion), M (match) that describes a transformation of one string to
another. To compute the similarity of two sequences, a pairwise
scoring matrix can be calculated by Equation (1). Therefore, the
optimal edit transcript can be computed to describe the trans-
formation between two sequences and distinguish sequence dif-
ferences by insertion, deletion and substitution. Figure 1 shows
an example of a pairwise alignment of two sequences S1 and S2,
as well as the edit transcript. The differences between two se-
quences can be readily identiﬁed from their edit transcript.
Moreover, the transcripts can be used along with the aligned
sequences to distinguish indels in homopolymer and non-homo-
polymer regions, where a homopolymer is deﬁned as two or
more adjacent nucleotides with the same state, and to identify
the pattern of carryforward errors.

4 IMPLEMENTATION
4.1 Error correction by ICC

ICC was written in the Perl scripting language and has been
tested on Linux, Mac OS X and MS Windows systems.
Starting with raw pyrosequencing reads and their quality
scores, the software pipeline performs the following steps. The
workﬂow of the implementation is shown in Figure 2.

(i) Read quality ﬁltering: Raw pyrosequencing reads are ﬁl-
tered based on ambiguous bases, length and average qual-
ity. The default parameters remove reads that are shorter
than 100 bp, contain ambiguous bases or have average
quality scores <25.

(ii) BLAST and retrieval by sequence window: Reads passing
(i) are mapped to a reference sequence using the BLASTN
algorithm (Altschul et al., 1990) with parameters for align-
ment as follows—match reward, 1; mismatch penalty, -1;
gap existence, 1; gap extension, 2. User-deﬁned window
and stride size parameters retrieve windows of sequences
across the reference sequence from the BLASTN output.

(iii) Non-substitution clustering and error correction: In each
window of sequences, the similarity between each pair of
sequences is computed using dynamic programming, along
with an optimal edit transcript, which is then used for se-
quence clustering. Sequence errors are corrected through
three sequential steps of non-substitution sequence cluster-
ing speciﬁcally designed for correction of homopolymer
indels, indels and carryforward errors. A greedy scheme
is used to cluster reads from the most to the least abun-
dant. First, homopolymer indel errors are corrected by
clustering sequences only differing by homopolymer
indels. All sequences are condensed into unique sequences.
Unique sequences with their abundance are used to

SJ, ACGTTTGGT-ATCTCWTGCA

32 HCGTT—GGTCATGTCEHARRTAGCH

Edit transcript WUWIWWWWHW
T l 3‘

Fig. 1. Pairwise alignment and edit transcript showing sequencing error
patterns. ‘1’ homopolymer indel, ‘2’ non-homopolymer indel, ‘3’ carry-
forward error

perform sequence clustering. The most abundant sequence
is used to cluster other sequences. Pairwise alignments of
the most abundant sequence to all other sequences are
computed along with the edit transcripts. The sequences
with edit transcripts not containing substitutions and only
showing the pattern of homopolymer indels relative to the
most abundant sequence are clustered together with the
most abundant sequence. For the next round, the most
abundant sequence among the remaining sequences is
chosen as a cluster seed, and the whole procedure iterates
until the cluster seed reaches the ﬁrst single sequence.
Errors are corrected by collapsing variation within a clus-
ter using the most abundant/consensus sequence for each
cluster. The cluster size is now the abundance of the cor-
rected sequence. Next, the sequences after homopolymer
indel correction are further corrected for indel errors using
the same strategy as homopolymer indel correction, except
that it clusters sequences only differing in indels, i.e. se-
quences with edit transcripts not containing substitutions
and only showing the pattern of indels to the most

 

Remove reads with ambiguities or length < lﬂﬂbp or
average quality score c 25

 

 

BLAST reads against reference sequence

it!

Parse output with user deﬁned window and stride size
to get serial windows of reads that cover the window

if

Com pute optimal edit transcripts between reads in a
window by dynamic programming

 

 

 

 

 

H

 

 

From the most abundant read, cluster reads with only
homopolymer indel differences

 

 

Correct homopolymer indel errors within clusters

‘5'

From the most abundant read, cluster reads with only
indel differences

 

 

 

 

Correct indel errors within clusters

Viv

From the most abundant read, cluster reads with
carryforward errors

Ir

Correct carryforward errors within clusters

Ir

Call nucleotide variants using Poisson distribution

4

Calculate nucleotide frequency at each site and
frequencies of haplotypes in the window

 

 

 

 

 

 

 

 

 

 

 

    

No

 

 

Done all windows

 

Output frequencies of nucleotide across reference
and hapiotypes for each window

 

 

 

Fig. 2. Schematic of ICC workﬂow

 

2404

112 ﬁle'srcumo[pJOJXO'sot1chOJutotw/2d11q wort popcorn/hog

910K ‘09 lsnﬁnV no 22

Indel and Carryforward Correction

 

abundant sequence are clustered together with the most
abundant sequence. Finally, after correcting homopolymer
and non-homopolymer indels, carryforward errors are cor-
rected by clustering sequences only showing carryforward
patterns.

(iv) Variant calling and proﬁling: A Poisson probability model
approximates the expected distribution of mismatch error
rates to distinguish sequencing errors from authentic
minor variants WVang et al., 2007). The nucleotide variant
frequencies at each site across the reference sequence are
calculated. Local haplotypes in each window are con-
structed by the most abundant/consensus sequence in
each cluster. The cluster size is interpreted as the haplotype
frequency in the population.

4.2 Error rate calculation

Pyrosequencing reads that served as the control for error rate
calculations were processed by read quality ﬁltering [step (i) men-
tioned previously]. The remaining qualiﬁed reads were aligned to
the pNL4-3 reference sequence using BLASTN with the align-
ment parameters as follows—match reward, 1; mismatch pen-
alty, -1; gap existence, 1; gap extension, 2. Each type of error rate
(number of errors/total number of mapped reference bases) was
calculated by parsing the BLASTN output ﬁle, categorized by
insertion, deletion and mismatch.

5 RESULTS AND DISCUSSION

5.1 Efﬁciency of sequencing error correction

To characterize the frequency of pyrosequencing errors and de-
termine the efﬁciency of the ICC method in correcting errors, we
sequenced a control dataset of six PCR-derived amplicons from
the HIV-1 gag, pol and em genes within the pNL4-3 plasmid. We
compared these reads with the Sanger-derived sequence of the
clone. Table 1 shows the comparison of sequencing error fre-
quencies of the six amplicons before and after error correction
by ICC. These errors include both those introduced by PCR and
those introduced during pyrosequencing. Overall error frequen-
cies were reduced by 93—95%, whereas the frequencies of inser-
tion and deletion errors were reduced by 98—99%, and mismatch
errors were reduced by 48—71%, the latter due to correction of

Table 1. Comparison of error rates before and after ICC

carryforward errors because no substitution mutations were cor-
rected (see Section 5.2 later in the text).

We also applied ICC to data from an individual (PIC64236)
with HIV-1 infection. We pyrosequenced PCR-derived ampli-
cons from the viral gag and em genes found in the patient at
ﬁve different time points, and we analyzed variants by their fre-
quency. Table 2 shows the analysis of one of the amplicons
(gag3, 383 bp with primers trimmed). ICC reduced the number
of variable sites by an average of 84%, and the overall trend was
as expected for early HIV infection, with a slightly higher level of
diversity early and then increasing diversity through time
(Herbeck et al., 2011).

5.2 Correction of carryforward errors

The 454 pyrosequencing is known to be particularly prone to
errors in homopolymeric regions due to carryforward and in-
complete extension errors (Margulies et al., 2005). Incomplete
extension refers to a homopolymer that is not completed due
to insufﬁcient local nucleotide concentrations within a ﬂow.
Carryforward errors occur when reagent ﬂushing between the
ﬂows is insufﬁcient, and leftover nucleotides are introduced
near but not adjacent to homopolymers. With commonly used
parameters for alignment, including the settings we used, one
carryforward error was usually interpreted as two mismatches
when aligned to the reference sequence. Because most carryfor-
ward errors were found immediately 3’ to homopolymers, we
investigated carryforward errors as a function of homopolymer
length using the same control dataset of six amplicons.
Carryforward errors increase as the length of the homopolymer
increases, with a large increase noted with homopolymers of 6 nt
in length (mean rate increased from 0.03 to 1.3% as homopoly-
mer length increased from 3 to 6) (Fig. 3). According to these
results, we conservatively corrected carryforward errors when
found in up to 5% of reads. However, users can set different
cutoff values. Because ICC does not correct mismatches, the re-
duction in mismatch errors noted above is attributable solely to
the correction of carryforward errors.

5.3 Comparison with other error correction and variant
calling algorithms

We used several other error correction and variant calling pro-
grams to process our control datasets: V-Phaser (Macalalad

 

Before correction

After correction

 

 

 

Amplicon Size Reads passing Insertion Deletion Mismatch Overall Insertion Deletion Mismatch Overall
(bp) quality ﬁlter (%) (%) (%) (%) (%) (%) (%) (%)
Run3 gag3 383 16 987 0.2017 0.1242 0.0412 0.3671 0.0041 0.0011 0.0146 0.0198
Run3 poll 317 22 456 0.29 0.0358 0.0305 0.3563 0.0027 0.0005 0.0097 0.0129
Run3 env3 269 21271 0.2131 0.0299 0.0297 0.2727 0.0011 0.0001 0.0135 0.0147
Run3 env5 443 20 593 0.1915 0.1585 0.0432 0.3932 0.0032 0.003 0.0125 0.0187
Run4 gag3 383 8247 0.1602 0.055 0.0282 0.2434 0.0017 0.0008 0.0144 0.0169
Run4 poll 317 12 001 0.1348 0.0729 0.0254 0.2331 0.0024 0.0009 0.0131 0.0164

 

 

2405

112 ﬁle'srcumo[pJOJXO'sot1chOJutotw/2d11q wort popcorn/hog

910K ‘09 lsnﬁnV no 22

W.Deng et al.

 

Table 2. Called variants in HIV -1 clinical data by ICC

 

Days post Reads Variable sites Reduction in

 

 

infection variable sites (%)
Raw data After ICC

29 5508 197 31 84.26

49 8281 223 12 94.62

146 9959 258 27 89.53

257 11 028 282 68 75.89

428 9863 282 74 73.76

 

Note: Pyrosequencing data were derived from a PCR amplicon from the HIV-1 gag
gene from one infected individual at ﬁve time points over the ﬁrst 14 months of
infection. Variable sites correspond to aligned nucleotide positions with at least two
different nucleotides.

 

1
13 0.1 -
s E
*- o.o1 -
g 8
cool 0
D
E U
8 {1.0001 --
o
o.oooo1 . .
2 3 4 s a T

Homopolymer length

Fig. 3. Carryforward error rates as a function of different homopolymer
lengths. Data were generated from six PCR-derived amplicons from the
pNL4-3 plasmid clone in two separate pyrosequencing runs.
Carryforward error rates were calculated by dividing the number of
reads that contained carryforward errors by the total number of reads
covering the homopolymer region

et al., 2012), QuRe (Prosperi and Salemi, 2012), Coral (Salmela
and Schréder, 2011), Acacia (Bragg et al., 2012) and the
PyroNoise component of AmpliconNoise v1.25 (Quince et al.,
2011). All compared algorithms were run using their default par-
ameters. To compare sensitivity and speciﬁcity across the various
algorithms, we mixed 15 HIV-1 plasmid clones of known se-
quence at frequencies ranging from 0.1 to 80% (Table 1). A
534 bp amplicon in gag was PCR ampliﬁed and subjected to
pyrosequencing. After pyrosequencing, we detected 12 of the
mixture of 15 plasmid clones with one at 80% frequency and
the remaining 20% divided among the other 11 minor variants.
Three minor variants mixed in at 0.1% frequencies were not
detected, as expected, as we sequenced only 691 :l: 310 templates.
Because the Coral, Acacia and PyroNoise algorithms do not
have methods to call variants, to fairly compare sensitivity and
speciﬁcity among different programs, we set a frequency cutoff at
0.1% according to our experimental setup of ~1000 input tem-
plates, i.e. only variants at frequencies 20.1% were considered
when calculating sensitivity and speciﬁcity (Table 3). The speci-
ﬁcity of each method was similar. However, ICC outperformed

Table 3. Sensitivity and speciﬁcity for variant detection from different
algorithms

 

 

Program Minor variants Sensitivity Speciﬁcity
detected
PyroNoise 5 0.4545 0.9957
Acacia 8 0.7273 0.9808
Coral 9 0.8182 0.9893
QuRe 8 0.7273 0.9976
V-Phaser 9 0.8182 0.9872
ICC 1 1 1 0.9827

 

Note: Sensitivity is reported as the fraction of the known variants found in the raw
data by each correction algorithm. Speciﬁcity is reported as the fraction of sites not
containing the known variants observed in the raw data. Variant calling required a
frequency of 20.001 with total input copy number of 691 :l: 310.

the other programs in sensitivity with each of the 11 minor vari-
ants detected.

We also calculated the raw and corrected nucleotide frequen-
cies from pyrosequencing data using PyroNoise, Acacia, Coral,
QuRe, V-Phaser and ICC. Except for PyroNoise, we found good
correlations between raw and corrected nucleotide frequencies of
the expected variants (Fig. 4). PyroNoise and QuRe showed a
relatively high speciﬁcity, indicating that they performed well in
reducing sequencing noise, but PyroNoise had the lowest sensi-
tivity among the six methods (Table 3). Furthermore, some vari-
ants detected by PyroNoise had much lower frequencies
compared with raw and expected frequencies (Fig. 4A). Using
QuRe on the same dataset, we obtained results over only a por-
tion of the amplicon (423 bp of the full length of 479 bp), as this
program trimmed the amplicon at both ends, where high-
sequencing noise is usually detected. QuRe also used more
relaxed settings by default in calling variants by Poisson distri-
bution than ICC did. Thus, QuRe reached the highest speciﬁcity
by removing more errors; on the other hand, it also eliminated
more real rare variants, resulting in a lower sensitivity (Table 3).
These results show that ICC is able to reduce sequencing noise to
a large extent while retaining the correct frequencies of real
variants.

PyroNoise uses distances deﬁned by ﬁowgrams to assist in
removing pyrosequencing errors. In our studies, PyroNoise
eliminated some high-frequency variants, whereas some muta-
tions were retained no matter how low their frequency. We
found that mutations resulting in a ﬂow cycle change were
never corrected, whereas others that maintained ﬂow cycles
were subject to correction. Figure 5 shows an example of these
two different types of mutations. When we compared the dis-
tance between (I) and (II) with the distance between (I) and (III)
at the sequence level, there was no difference, with both having
one mismatch. But at the ﬁowgram level, the distance between (I)
and (II) was different from that between (I) and (III). With a
mutation from (I) to (II), the ﬂows were maintained and still
aligned. But when a mutation from (I) to (III) occurs, the
ﬂows were changed by an insertion of one ﬂow cycle (highlighted
in bold type); therefore, the ﬁowgrams were no longer aligned.
We therefore deﬁned an In-Flow-Cycle (IF C) mutation as one

 

2406

112 ﬁle'srcumo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 popcorn/110g

910K ‘09 lsnﬁnV no 22

Indel and Carryforward Correction

 

 

         
                 

A1115 B p.15 c 11.15
a y = 11.1351 vases a. r =ﬁ-9593s- 19011 11 = 0 139451: - 0.00011
I: 11* - 1:. 13313 5 R‘ a 0389?? E a! - 11.519903
3 o..1 :- Ill E 11.1
n '1' E
E g a
s 0 t s
3 1:11:15 E 0.05 2 I105
s E E

1:1 - U ‘3' El o

o ELEIS o.1 I115 '3 MG ll! 015 1:1 dos 121.: :11:
Run- frequency nil-1' lﬂﬂlﬂlﬁﬁr ﬁiw frequency
Dims E o.1 F1115
v - 0.95351: 43.0001 y =1_no111su - ELEIDD] y = 121.992.: moo-:12
E R‘ $399?! E R' = 13.99911 5 R” = 1199391
3 111 121.1 111
E E E
a 1 t
,_ ans 2 nos - t ans
5 a a
U U
121 - - 1:1 - - - 1:1 - - -
a DDS o.1 121.15 o dos 1:1..1 o.15 :1 cos 111 ms
Raw frequency law Frequency law Frequency

Fig. 4. Correlation between raw and corrected frequencies of real vari-
ants by different algorithms. (A) PyroNoise, a3) Acacia, (C) Coral, (D)
QuRe, (E) V-Phaser and G‘) ICC. Pyrosequencing data were derived from
a 479 bp PCR-derived amplicon of a mixture of different copies of 15
HIV -1 clones of known sequence with total input copy number of
691 :l: 310

secereacre s—r ﬂ,1,0,1:G,0,1,1:1,D,D,1:D,1,l,u:1,D,D,1 {I}
AGECTGACTG «It—1r ﬂ,1,{i,120,ﬂ,2,ﬂ:1,0,D,1:0,1,1,D:1,D,D,1 {11}
AGCATGACTG {—1 1:1,1,121.1:o,t1,:1,1:1:1:1,1,c,c:1,1:1,t1,1:c,1,1.r1:1.o,o,1 {111}

Fig. 5. The effect of different mutations on flowgrams. Flowgram data
corresponding to the sequences on the left, with nucleotides ﬂowed in the
order of TACG. The ‘2’ indicates a new ﬂow cycle series of the four
nucleotides. Mutated nucleotides are highlighted in bold type. Inserted
ﬂow cycle is also highlighted in bold type

that does not change the number of ﬂows, and an Out-Flow-
Cycle (OF C) mutation as one that changes the number of ﬂows.
Although there is no difference in distance between IFC and
OF C mutations at the sequence level, there is a difference at
the ﬁowgram level. Because of their misalignment, each cycle
after an OF C mutation increases the distance between ﬂow-
grams. To verify this ﬁnding, we simulated ﬁowgrams having
different frequencies of minor variants with various numbers of
IFC or OFC mutations. The results of PyroNoise correction
using the program’s default parameter settings are shown in
Table 4. Variants with frequency up to 19% were eliminated if
there was one IF C mutation between major and minor variants.
The frequency threshold of minor variants to be eliminated
decreased as the number of IFC mutations increased.
However, minor variants were not eliminated if there was a
single OFC mutation distinguishing major and minor variants
(Table 4). The results from sequencing the mixture of 15 HIV-1
plasmid clones also conﬁrmed these ﬁndings (Fig. 4A). Thus, it is
crucial to choose proper parameters to not eliminate rare and
sometimes abundant variants when using PyroNoise to correct
sequencing errors.

5.4 Determination of minor variants

ICC does not correct mismatches, and as a result, it maximizes
the number of real rare variants retained. To distinguish mis-
match errors from authentic minor variants, we applied a

Table 4. Simulation of maximum frequency of minor variant to be elimi-
nated by PyroNoise

 

 

IFC mutations OFC
mutations

1 2 3 4 5 1

19% 2% 0.30% 0.04% 0

 

Note: Flowgrams were simulated based on an amplicon of 339 bp. IFC mutations
represent mutations that do not change the number of ﬂow cycles. OFC mutations
will change the number of ﬂow cycles.

statistical analysis that assumes a Poisson distribution in the fre-
quency of these errors WVang et al., 2007). Variants whose fre-
quency of occurrence yielded a P<0.001 according to the
Poisson model were considered highly unlikely to be sequencing
errors. Pyrosequencing error rate is largely dependent on the
sequencing platform, PCR ampliﬁcation and sequence context
(Gilles et al., 2011; Huse et al., 2007; Shao et al., 2013;
Vandenbroucke et al., 2011; Wang et al., 2007). Wang et al.
(2007) measured mismatch error rates using a Roche 454 GS20
sequencing platform and found that mismatches were six times
more frequent in homopolymeric regions (0.0044) than in non-
homopolymeric regions (0.0007). Therefore, they used two
Poisson distributions of errors to distinguish sequence errors
from authentic minor variants in homopolymeric and non-
homopolymeric regions, respectively. Considering that carryfor-
ward error is a major source of 454 pyrosequencing errors and
one carryforward error is usually interpreted as two mismatches
when aligned to reference sequence, we asked whether the differ-
ence in mismatch rate between the two contexts could be caused
by carryforward errors in homopolymeric regions. To test this,
we examined six amplicons on two separate pyrosequencing runs
using the 454 GS-FLX Titanium platform. We calculated differ-
ent types of errors and categorized them according to their se-
quence context (inside or outside of homopolymer regions) by
distinguishing carryforward errors from substitutions in align-
ments (Table 5). The average mismatch error rate of the six
amplicons, excluding carryforward errors, was 0.00013. The
rates of mismatch errors were equivalent in non-homopolymeric
regions (0.00013) and homopolymeric regions (0.00012) when
carryforward errors were correctly aligned to the reference.
After ICC correction of indels and carryforward errors, we there-
fore required only one distribution of mismatch error rates,
which approximated a Poisson distribution with 1120.00013.
We then used this empirically observed distribution to distin-
guish sequence errors from authentic minor variants. Within
ICC, users can provide speciﬁc values according to different
sequencing platforms and PCR conditions.

In conclusion, ICC provides a complete software pipeline for
users to analyze pyrosequencing data for both library and ampli-
con applications. It is speciﬁcally designed to correct indel and
carryforward and incomplete extension errors in 454 pyrose-
quencing data and avoid the elimination of real variants
during error correction by a novel approach of non-substitution
clustering without need of a distance cutoff value. ICC can be

 

2407

112 ﬁle'srcumo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 popcorn/110g

910K ‘09 lsnﬁnV no 22

W.Deng et al.

 

Table 5. Error frequency by type and sequence context

 

Amplicon Type

Context

 

Insertion (%) Deletion (%)

Mismatch (%)

 

Overall (%) Homopolymeric

mismatch (%)

Non-homopolymeric
mismatch (%)

 

Run3 gag3 0.2861 0.1535 0.0121
Run3 poll 0.3496 0.0678 0.0114
Run3 env3 0.261 0.04 0.0125
Run3 env5 0.3254 0.19 0.014

Run 4 gag3 0.2134 0.082 0.0141
Run4 poll 0.1729 0.1042 0.0127
Average 0.2681 0.1063 0.0128

0.4517 0.0097 0.02
0.4288 0.0115 0.011
0.3135 0.0138 0.0039
0.5294 0.0134 0.0171
0.3095 0.0151 0.011
0.2898 0.0135 0.0097
0.3871 0.0128 0.0121

 

applied in other next-generation sequencing platforms such as
Ion Torrent and Illumina. Ion Torrent has similar technology
and the same source of errors as 454 pyrosequencing. ICC is able
to analyze Ion Torrent data with the same efﬁciency as 454
pyrosequencing data. It can also be run on Illumina data, al-
though there is low indel error in Illumina platform. By applying
a Poisson probability model, ICC is able to distinguish sequen-
cing errors from authentic minor variants and remove sequen-
cing noise to a large extent. With the high sensitivity and
speciﬁcity achieved by ICC, it should expedite analysis of vari-
able sequence populations.

Funding: This work was supported by the National Institute of
Allergy and Infectious Diseases of the National Institutes of
Health [POlA1057005, UM1A1068618 and R37AI47734 to
J .I.M.], including the University of Washington Centers for
AIDS Research Computational Biology Core [P30AIO27757].

Conflict of Interest: none declared.

REFERENCES

Altschul,S.F. et al. (1990) Basic local alignment search tool J. Mol. Biol, 215,
403—410.

Archer,J. et al. (2010) The evolutionary analysis of emerging low frequency HIV-1
CXCR4 using variants through time—an ultra-deep approach. PLoS Comput.
Biol, 6, e1001022.

Bimber,B.N. et al. (2009) Ultradeep pyrosequencing detects complex patterns of
CD8+ T-lymphocyte escape in simian immunodeﬁciency virus-infected ma-
caques. J. Virol., 83, 8247—8253.

Bimber,B.N. et al. (2010) Whole-genome characterization of human and simian
immunodeﬁciency virus intrahost diversity by ultradeep pyrosequencing.
J. Virol., 84, 12087—12092.

Bragg,L. et al. (2012) Fast, accurate error-correction of amplicon pyrosequences
using Acacia. Nat. Methods, 9, 425—426.

Burwitz,B.J. et al. (2011) Pyrosequencing reveals restricted patterns of CD8+ T cell
escape-associated compensatory mutations in simian immunodeﬁciency virus.
J. Virol., 85, 13088—13096.

Eriksson,N. et al. (2008) Viral population estimation using pyrosequencing. PLoS
Comput. Biol, 4, e1000074.

Fischer,W. et al. (2010) Transmission of single HIV-1 genomes and dynamics of
early immune escape revealed by ultra-deep sequencing. PLoS One, 5, e12303.

Gilles,A. et al. (2011) Accuracy and quality assessment of 454 GS-FLX Titanium
pyrosequencing. BM C genomics, 12, 245.

Gusﬁeld,D. (1997) Algorithms on Strings, Trees, and Sequences: Computer Science
and Computational Biology. Cambridge University Press, Cambridge CB2 lRP.

Hedskog,C. et al. (2010) Dynamics of HIV-1 quasispecies during antiviral treatment
dissected using ultra-deep pyrosequencing. PLoS One, 5, e11345.

Henn,M.R. et al. (2012) Whole genome deep sequencing of HIV-1 reveals the
impact of early minor variants upon immune recognition during acute infection.
PLoS Pathog, 8, e1002529.

Herbeck,J.T. et al. (201 1) Demographic processes affect HIV-1 evolution in primary
infection before the onset of selective processes. J. Virol., 85, 7523—7534.

Huse,S.M. et al. (2007) Accuracy and quality of massively parallel DNA pyrose-
quencing. Genome Biol, 8, R143.

Huse,S.M. et al. (2010) Ironing out the wrinkles in the rare biosphere through
improved OTU clustering. Environ. Microbiol, 12, 1889—1898.

Love,T.M. et al. (2010) Mathematical modeling of ultradeep sequencing data re-
veals that acute CD8+ T-lymphocyte responses exert strong selective pressure in
simian immunodeﬁciency virus-infected macaques but still fail to clear founder
epitope sequences. J. Virol., 84, 5802—5814.

Macalalad,A.R. et al. (2012) Highly sensitive and speciﬁc detection of rare variants
in mixed viral populations from massively parallel sequence data. PLoS
Comput. Biol, 8, e1002417.

Margulies,M. et al. (2005) Genome sequencing in microfabricated high-density
picolitre reactors. Nature, 437, 376—380.

Needleman,S.B. and Wunsch,C.D. (1970) A general method applicable to the
search for similarities in the amino acid sequence of two proteins. J. Mol.
Biol, 48, 443—453.

O’Connor,S.L. et al. (2012) Conditional CD8+ T cell escape during acute simian
immunodeﬁciency virus infection. J. Virol., 86, 605—609.

Poon,A.F. et al. (2010) Phylogenetic analysis of population-based and deep sequen-
cing data to identify coevolving sites in the nef gene of HIV-1. Mol Biol. Evol,
27, 819—832.

Prosperi,M.C. and Salemi,M. (2012) QuRe: software for viral quasispecies recon-
struction from next-generation sequencing data. Bioinformatics, 28, 132—133.

Quince,C. et al. (2009) Accurate determination of microbial diversity from 454
pyrosequencing data. Nat. Methods, 6, 639—641.

Quince,C. et al. (2011) Removing noise from pyrosequenced amplicons. BMC
Bioinformatics, 12, 38.

Ramirez-Gonzalez,R. et al. (2013) PyroClean: denoising pyrosequences from pro-
tein-coding amplicons for the recovery of interspeciﬁc and intraspeciﬁc genetic
variation. PLoS One, 8, e57615.

Reeder,J. and Knight,R. (2010) Rapidly denoising pyrosequencing amplicon reads
by exploiting rank-abundance distributions. Nat. Methods, 7, 668—669.

Rodrigo,A.G. et al. (1997) Quantitation of target molecules from polymerase chain
reaction-based limiting dilution assays. AIDS Res. Hum. Retroviruses, 13,
737—742.

Rousseau,C. et al. (2006) Large-scale ampliﬁcation, cloning and sequencing of near
full-length HIV-1 subtype C genomes. J. Virol Methods, 136, 118—125.

Salmela,L. and Schréder,J. (2011) Correcting errors in short reads by multiple
alignments. Bioinformatics, 27, 1455—1461.

Schacker,T. et al. (1996) Clinical and epidemiologic features of primary HIV infec-
tion. Ann. Intern. Med, 125, 257—264.

Shao,W. et al. (2013) Analysis of 454 sequencing error rate, error sources, and
artifact recombination for detection of Low-frequency drug resistance muta-
tions in HIV-1 DNA. Retrovirology, 10, 18.

 

2408

112 /810'S112umo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 popcorn/110g

910K ‘09 lsnﬁnV no 22

Indel and Carryforward Correction

 

Sirnen,B.B. et al. (2009) Low-abundance drug-resistant viral variants in chronically
HIV-infected, antiretroviral treatment-naive patients signiﬁcantly impact treat-
ment outcomes. J. Infect. Dis., 199, 693—701.

Stekler,J.D. et al. (2012) Are there beneﬁts to starting antiretroviral therapy during
primary HIV infection? Conclusions from the Seattle Primary Infection Cohort
vary by control group. Int. J. STD AIDS, 23, 201—206.

Tsibris,A.M. et al. (2009) Quantitative deep sequencing reveals dynamic HIV-1
escape and large population shifts during CCR5 antagonist therapy in vivo.
PLoS One, 4, e5683.

Vandenbroucke,I. et al. (2011) Minor variant detection in amplicons using 454
massive parallel pyrosequencing: experiences and considerations for successful
applications. Biotechniques, 51, 167—177.

Wang,C. et al. (2007) Characterization of mutation spectra with ultra-deep
pyrosequencing: application to HIV-1 drug resistance. Genome Res., 17,
1195—1201.

Zagordi,0. et al. (2011) ShoRAH: estimating the genetic diversity of a mixed sample
from next-generation sequencing data. BM C Bioinformatics, 12, 119.

Zagordi,0. et al. (2010a) Deep sequencing of a genetically heterogeneous sample:
local haplotype reconstruction and read error correction. J. Comput. Biol, 17,
417—428.

Zagordi,0. et al. (2010b) Error correction of next-generation sequencing
data and reliable estimation of HIV quasispecies. Nucleic Acids Res., 38,
7400—7409.

 

2409

112 /810'S112umo[pJOJXO'sot112u1101utotq/ﬁd11q 111011 popcorn/110g

910K ‘09 lsnﬁnV no 22

