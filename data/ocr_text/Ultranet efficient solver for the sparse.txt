APPLICATIONS NOTE V31;iiiiﬁ‘Sgé/iféitﬁi‘ifci/LZ?l?

 

Systems biology

Advance Access publication December 24, 2012

Ultranet: efficient solver for the sparse inverse covariance
selection problem in gene network modeling

Linnea Jarvstratl, Mikael Johanssonz, Urban Giullberg1 and Bjorn Nilsson

1,3,*

1Department of Hematology and Transfusion Medicine, Lund University Hospital, SE—221 85 Lund, Sweden,
2Department of Automatic Control, Royal Institute of Technology, SE—100 44 Stockholm, Sweden and
3Broad Institute, 7 Cambridge Center, Cambridge, MA 02142, USA

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: Graphical Gaussian models (GGMs) are a promising ap-
proach to identify gene regulatory networks. Such models can be ro-
bustly inferred by solving the sparse inverse covariance selection
(SICS) problem. With the high dimensionality of genomics data, fast
methods capable of solving large instances of SICS are needed.

We developed a novel network modeling tool, Ultranet, that solves the
SICS problem with significantly improved efficiency. Ultranet com-
bines a range of mathematical and programmatical techniques, ex-
ploits the structure of the SICS problem and enables computation of
genome-scale GGMs without compromising analytic accuracy.
Availability and implementation: Ultranet is implemented in C++
and available at www.broadinstitute.org/ultranet.

Contact: bnilsson@broadinstitute.org or bjorn.nilsson@med.lu.se
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on October 3, 2012; revised on November 26, 2012;
accepted on December 18, 2012

1 INTRODUCTION

Graphical Gaussian models (GGMs) are rapidly gaining traction
as a promising approach to identify gene regulatory networks
from genomics data (Markowetz and Spang, 2007; Schéifer and
Strimmer, 2005b). GGMs are created by estimating the inverse (9*
of the sample covariance matrix S, and then computing the partial
correlation matrix P;- = (93/ (93(93. Assuming that the observa-
tions (typically gene expression values) have a multivariate
Gaussian distribution, P; = 0 indicates that variables (genes) 1'
and j are conditionally independent, given the other variables
(i.e. all correlation between them can be explained by
co-correlation with other variables); P;- 75 0 indicates that they
are conditionally dependent (i.e., the correlation between them
cannot be explained in full by co-correlation with other observed
variables). The advantage of GGMs is that edges (non-zero P;- s)
are more likely to reﬂect direct dependencies between genes than
edges in correlation networks (Markowetz and Spang, 2007;
Schéifer and Strimmer, 2005a).

Alongside computing a relevant input matrix, the difﬁculty
with GGM networks is to estimate (9*. A robust way to achieve
this is to solve the penalized log-likelihood maximization

 

*To whom correspondence should be addressed.

problem
(9* = argn®1a(x log det(9 — tr(S(9) — A||(9||1 (l)

where A > 0 controls the impact of the L1 regularization term, and
hence the sparsity of the network. This is called the sparse inverse
covariance selection (SICS) problem. Solving SICS for high-
dimensional genomics data is challenging because current standard
methods, originally developed for lower-dimensional data, are asso-
ciated with computational requirements that grow steeply with the
number of genes. This leads to long wait times, increases the need
for extraordinary computing resources and complicates analysis.

To address this issue, we developed an efﬁcient network mod-
eling tool, Ultranet, that solves the SICS problem signiﬁcantly
faster. As shown, Ultranet readily computes genome-scale
GGMs with ~20 000 genes without compromising the analytic
accuracy.

2 METHOD

As described in detail in Supplementary Information, Ultranet uses sev-
eral different techniques to accelerate the computations.

First, as a preprocessing step, Ultranet identiﬁes the connected
components of the network by block-partitioning the adjacency matrix
obtained by soft-thresholding S at A. This decomposes the original prob-
lem into a set of smaller independent SICS problems. Because the time
needed to solve SICS grows superlinearly with dimension, solving mul-
tiple small subproblems instead of one big problem is faster.

Second, to solve subproblems, Ultranet uses a ﬁrst-order dual method
based on accelerated projected-gradient descent (PGD). This method im-
proves on earlier PGD approaches (Duchi et al., 2008) by using simpler,
yet effective, step-length selection rules and a heavy-ball momentum term
to avoid zig-zagging. This eliminates most computations needed for
step-length selection, and promotes smoother descent paths. The descent
step is given by

Wk+1 = 11ka + 05W]:1 + ,3(Wk — Wk—l)]A (2)

where Wk 2 (91:1, k = 1, . . . denotes the regularized covariance matrix at
each iteration, and l'I[ - ]A denotes projection onto the A-box centered at
S. The parameters or and ,8 control the step length and impact of the
momentum term, respectively.

Third, to initialize the solver, Ultranet uses a continuation approach
where the problem is solved to low accuracy for decreasing A values. This
helps ﬁnding initial solutions near the optimum.

3 RESULTS AND DISCUSSION

We tested Ultranet on gene expression microarray data from
various sources and of varying dimensionality. We made the

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 511

112 [3.10811211an[plOJXO'SODBIILIOJIITOTQ/ﬂ(11111 IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

L.J5rvstra°t et al.

 

 

. (b)

A
9!
V

 

  

 

 

 

 

2x 10 ’27
iii-“Ultranet, basic PGD % 2.5
A ---Ultranet, PGD w. P :11
{0,15 —Ultranet, PGD w. P+C g
g —Ultranet, PGD w. P+C+M *5
-.= a
c r: 1.
e1 5
cu _ .
*5 “3’ 
E- 5 '0“ '~ 2'
o a - I: , ~ , a With momentum term
E 3i '-i ’ - Without momentum term

 

 

 

 

  

 

500 10
Iteration

 

1500 a ® @

 

 

     

 

 

 

 

 

 

 

 

 

 

1o 10
--------------------------- 
3102 E 2 * ‘ I‘7"~'I':~1' ,,,,,, ' ‘ “
a, - V y y l ‘ ‘ vi
g .2 1° ......................... -
é 10° " .5
g E
Q a X:
g _, .  - in:
010 ' w-wDuchI et al (2008) o  Duchi et al (2008) ‘
-- Yuan (2009) - - Yuan (2009)
- - - Ultranet. C+M - - - Ultranet, C+M
10 I —U|tranet, P+C+M _2 —Ultranet, P+C+M , _
500 _ 1.000 1500 2000 10 o 2 o 4 o 6 o 8
DimenSIonaIIty (number of genes) ' Reg'ujarizaﬁon benany (A) -

Fig. 1. Representative results for the Haferlach et al. (2010) dataset (2096 Affymetrix U133 Plus 2 arrays x20 958 genes; Pearson correlations as S).
(a) Computation time for basic PGD and PGD accelerated by block partitioning (P), continuation (C) and momentum term (M) (5000 random genes).
0)) Angles between iterates (A = 0.2; same genes). (c) Computation times for Ultranet versus control methods for varying A (2000 random genes; average
of 10 replicates). ((1) Corresponding plot for varying S sizes (A = 0.5). (e) Neighbors of GA T A1 for A = 0.8 (computation time, 1.4s with 20 958 genes).
Normalized dual gap < 10'3 used as stop criterion. Experiments performed on a dual Intel Xeon 5680 CPU w. 36 GB RAM. File access time not included

following recurrent observations (Fig. 1): ﬁrst, adding block-par-
titioning to basic PGD (implemented in the same coding style)
yielded substantial speed-ups for large A; second, adding conti-
nuation yielded marginal speed-ups for intermediate A in some
datasets but did not yield signiﬁcant speed-ups in general; third,
in contrast, adding the momentum term accelerated convergence
several fold for small A because of dampened zig-zagging. Thus,
we observed signiﬁcant improvements over basic PGD across the
full range of A values.

We compared Ultranet with previous methods (Duchi et al.,
2008; Friedman et al., 2008; Lu, 2009; Scheinberg et al., 2010;
Yuan, 2009). In our tests, the two fastest competitors were the
methods by Duchi et al. (2008) (a PGD variant) and Yuan (2009)
(an augmented Lagrangian method). Ultranet was 1—2 orders of
magnitude faster than these methods without block partitioning,
and 1—4 orders of magnitude faster with block partitioning
(Fig. lo and d).

We ﬁnally applied Ultranet to a large set of genome-wide gene
expression proﬁles of bone marrow samples from a wide range of
conditions (Haferlach et al., 2010, NCBI Gene Expression
Omnibus GSE13159) to estimate a draft regulatory network
for human blood cell development. Examining the results, we
focused on the neighborhood of GATA1, a transcription factor
that drives the formation of red blood cells, a well-studied
process. For all A tested, the inferred GATAI neighborhood
was clearly enriched for known red cell genes, including genes
for transcription factors (KLFI, GFIIB, T ALI), blood groups
(RHD, RHAG, KEL, GYPB, XK), heme synthesis enzymes
(UROD, HMBS), and the erythropoietin receptor (EPOR)
(Fig. 1e). Most neighbor genes contained GA T A1 ChIPseq
(Chromatin Immuno-Precipitation followed by next-generation
sequencing) peaks, supporting that they are true GATA-l targets
(Supplementary Table S1). The results illustrate the ability of
GGMs to ﬁnd biologically relevant networks, and the use
of GGMs as a complement to motif searches and ChIP—seq to

identify relevant transcription factor target genes. The results
also illustrate Ultranet’s ability to compute GGMs at a
genome-wide scale.

In summary, Ultranet is a fast tool to infer gene networks based
on GGMs. Ultranet is available for Microsoft Windows and
Linux operating systems, exploits the multicore capacity of Intel
x64 processors, and accepts data in tab-delimited text format.

Funding: This work was supported by the Swedish Foundation
for Strategic Research (grant no. ICA08-0057), Marianne and
Marcus Wallenberg’s Foundation (grant no. 2010.0112) and
the Swedish Children’s Cancer Fund (grant no. 10/125).

Conflicts of Interest: none declared.

REFERENCES

Duchi,J.C. et al. (2008) Projected subgradient methods for learning sparse
Gaussians. In: Proceedings of the Conference Uncertainty in Artiﬁcial
Intelligence. Helsinki.

Friedman,J. et al. (2008) Sparse inverse covariance estimation with the graphical
lasso. Biostatistics, 9, 432—441.

Haferlach,T. et al. (2010) Clinical utility of microarray-based gene expression
proﬁling in the diagnosis and classiﬁcation of leukemia. J. Clin. Oncol., 28,
2529—2537.

Lu,Z. (2009) Smooth optimization approach for sparse covariance selection. SIAM
J. 0ptim., 19, 1807—1827.

Markowetz,F. and Spang,R. (2007) Inferring cellular networks—a review. BM C
Bioinformatics, 8 (Suppl. 6), SS.

Scheinberg,K. et al. (2010) Sparse inverse covariance selection Via alternating
linearization methods. In: Proceedings of Neural Information Processing
Systems. Vancouver.

Schafer,J. and Strimmer,K. (2005a) An empirical bayes approach to inferring large-
scale gene association networks. Bioinformatics, 21, 754—64.

Schafer,J. and Strimmer,K. (2005b) A shrinkage approach to large-scale covariance
matrix estimation and implications for genomics. Stat. Appl. Genet. Mol. Biol.,
4, Article 32.

Yuan,X. (2009) Alternating direction methods for sparse covariance selection.
Optimization Online, http://www.optimization-online.org/DB_FILE/2009/09/
2390.pdf (17 January 2013, date last accessed).

 

512

112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOIQ/[i(11111 IIIOJJ papeolumoq

910K ‘09 lsnﬁnV no :2

