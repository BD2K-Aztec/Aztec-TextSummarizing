APPLICA TIONS NOTE V0" 2305-1?blﬁéé’iigiiiiialiiﬁl?3?

 

Bioimage informatics

Advance Access publication April 16, 2013

CellH5: a format for data exchange in high-content screening
Christoph Sommer1’2’*, Michael Held2, Bernd Fischer3, Wolfgang Huber3 and

Daniel W. Gerlich1’2’*

1Institute of Molecular Biotechnology of the Austrian Academy of Sciences (IMBA), 1030 Vienna, Austria, 2Institute of
Biochemistry, Department of Biology Swiss Federal Institute of Technology (ETH Zurich), 8093 Zurich, Switzerland and
8Genome Biology Unit, European Molecular Biology Laboratory (EMBL), 69117 Heidelberg, Germany

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: High-throughput microscopy data require a diversity of
analytical approaches. However, the construction of workflows that
use algorithms from different software packages is difficult owing to
a lack of interoperability. To overcome this limitation, we present
CellH5, an HDF5 data format for cell-based assays in high-throughput
microscopy, which stores high-dimensional image data along with
inter-object relations in graphs. CellH5Browser, an interactive gallery
image browser, demonstrates the versatility and performance of the
file format on live imaging data of dividing human cells. CellH5 pro-
vides new opportunities for integrated data analysis by multiple soft-
ware platforms.

Availability: Source code is freely available at www.github.com/cellh5
under the GPL license and at www.bioconductor.org/packages/
release/bioc/html/rhdf5.html under the Artistic-2.0 license. Demo data-
sets and the CellH5Browser are available at www.cellh5.org. A Fiji
importer for cellh5 will be released soon.

Contact: daniel.gerlich@imba.oeaw.ac.at or christoph.sommer@
imba.oeaw.ac.at

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on January 16, 2013; revised on March 21, 2013; accepted
on April 10, 2013

1 INTRODUCTION

Recent advancements in microscope automation enable high-
content screening at unprecedented throughput and spatio-tem—
poral resolution. Cell-based assays typically involve segmenta-
tion of individual objects (cells) within the imaging ﬁeld,
followed by quantiﬁcation of cell morphologies (Conrad and
Gerlich, 2010). Powerful algorithms have been developed for
learning-based segmentation (Sommer et al., 2011) and quantiﬁ-
cation and classiﬁcation of cell morphologies (Boland and
Murphy, 2001; Carpenter et al., 2006; Eliceiri et al., 2012; Held
at al., 2010; Walter et al., 2010). Application of any of these
methods to large-scale biological data requires sophisticated
workﬂow management and efﬁcient batch processing, for
which different software platforms have been developed
(Carpenter et al., 2006; Eliceiri et al., 2012; Held at al., 2010;
Jones et al., 2008). In practice, the analysis often asks for the
combination of methods that are available in distinct software

 

*To whom correspondence should be addressed.

platforms. Integration by re-implementation into a single plat-
form is inefﬁcient and error prone. A preferable approach is
integration by interoperability of tools. Here, we propose a ver-
satile data format for serialization, disk-based storage and ex-
change of high-content screening data and processing results.
This provides a ﬂexible and sustainable solution for the develop-
ment of integrated analysis pipelines based on multiple software
platforms.

To facilitate the exchange of microscopy image data, the Open
Microscopy Environment project (OME) has developed a stan-
dardized ﬁle format, OME-TIFF (Linkert et al., 2010), which
can store raw microscopy images along with experimental
meta-information (Supplementary Table 81). Semantically
typed data hypercubes (Millard et al., 2011) have been proposed
to store multi-dimensional high-content screening data in a hier-
archical fashion based on Extensible Markup Language and the
HDF5 data model, which is optimized for efﬁcient storage and
rapid access of large-scale multi-dimensional data. However,
complex object relationships, as, for example, lineage trees of
dividing cell populations that can comprise millions of cell ob-
jects, cannot be efﬁciently processed when stored in textual data
formats such as Extensible Markup Language used in OME-
TIFF and semantically typed data hypercubes.

Object relations are represented by network graphs, following
standard formats such as GraphML (Brandes et al., 2001) and
GraphViz (Ellson et al., 2002). These text-based formats, how-
ever, are designed mainly for visualization of graphs and cannot
be efﬁciently enriched with high-dimensional binary data. An
integrated data format representing both machine-readable
graph structures and multivariate object features has not been
reported in the ﬁeld of bioimaging. With CellH5, we introduce
an efﬁcient mechanism, representing both object relations in
graphs along with high-dimensional object data.

2 FORMAT SPECIFICATIONS

CellH5 contains four major components: images, objects, object
relations and features (Fig. 1, Supplementary Figs 81—83).
Objects of different categories, e.g. cells or cell organelles like
nuclei or vesicles, are initially derived by segmentation within
the original images. Relations between these objects then deﬁne
higher-level objects, e.g. cell organelles, which can be related to
deﬁne cells, or cell objects can be related across time frames to
deﬁne lineage trees. The resulting object graphs are stored by
adjacency list in HDF5 datasets for fast index access

 

© The Author 2013. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re—use, please contact journals.permissions@oup.com

112 /§JO'S{Bu1no [p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; pepBOIU/IAOG

910Z ‘091sn3nv uo ::

CellH5

 

Object relations over time

 

Raw images

 

Objects

 

(I)
‘2
3
<6
.52
.2 a?
L U)
5 E:
g E; Interphase
g Prophase
g I Prometapha
Metaphase
I Anaphase
' Telophase

 

Fig. 1. Example for data storage in CellH5. Images of human cells (red:
chromatin; green: microtubules), segrnentations (object outlines), classiﬁ-
cation (colour of object contours or spots indicates different mitotic
stages), object relations (tracking trees) and morphometric features
(spots represent cell objects). Dashed lines indicate relations of represen-
tative objects. Scale bar: 20 um

(Supplementary Fig. S4). High-level objects can be related to
each other again by the same mechanism, e.g. by grouping mul-
tiple trajectories that share similar temporal dynamics. Each
object can be linked at any hierarchy level with high-dimensional
data such as quantitative features, segmentation contours or
morphology classes. The resulting ﬁles are generated independ-
ently for each sample and can be linked together into one single
ﬁle containing the data of an entire screening experiment. Such
an interlinked ﬁle structure is essential for rapid access in inter-
active browsing and for high-throughput batch processing.
CellH5 is platform independent and can be natively accessed
by multiple programming languages (Python, C/C—l—-l—, Java,
Matlab and R), which eases the interoperability of software
tools for image analysis and data post-processing. In general,
CellH5 is divided into a definition and a sample part. The deﬁn-
itions contain information about what is stored (i.e. objects,
object features and object relations) and optionally carry meta-
information (e.g. imaging conditions and classiﬁcation param-
eters). The actual data reside in samples. Different types of
object relations supported by CellH5 are depicted in
Supplementary Figure S1. A formal speciﬁcation of the CellH5
layout and a detailed illustration of how object graphs are rep-
resented and retrieved are provided in Supplementary Figures S2
and S3.

3 IMPLEMENTATIONS

We provide a reference implementation of CellH5 in Python
within the open-source frameworks CellCognition (Held et al.,
2010) and CellH5. The Application Programming Interface is
implemented in the cellh5 module of CellH5, which provides
convenient high-level access to object graphs and associated
object features (Supplementary Table S2) and comprises

common use and test cases (Python unit tests). The cellh5
module runs with a standard Python distribution and does not
depend on the installation of other image analysis tools, e.g.
CellCognition. The interoperability of software tools, achieved
by CellH5, is supported by an R-interface to the Bioconductor
project. It is bundled in the rsrc package of CellH5 and includes
example use cases written in R (Supplementary File Sl; source
code in Supplementary File S2). It requires the rhdf library for
HDF5 access released in the Bioconductor project (Gentleman
et al., 2004).

To test the performance and ﬂexibility of CellH5, we de-
veloped an interactive gallery image browser, CellH5Browser
(Supplementary Software 1). As example data we used a live-
cell microscopy dataset of human HeLa cells expressing a red
ﬂuorescent marker for chromatin (H2B-mCherry) and a green
ﬂuorescent marker for microtubules (mEGFP—oc-tubulin) (Held
et al., 2010; Zhong et al., 2012). The dataset comprises 3914
images (2.88 GByte) and 332 732 cell objects. Cell trajectories
were derived by image segmentation and tracking using
CellCognition (Held et al., 2010) and visualized as series of
single cell images with overlaid segmentation contours and
class annotations (Supplementary Fig. S4). We further exploited
the versatility of CellH5 to investigate the fate of dividing cells on
perturbation of mitotic regulators (Supplementary Fig. S5). Cell
trajectory plots indicated that RNA interference (RNAi)-
mediated depletion of the mitotic motor protein KIFll fre-
quently induced prolonged prometaphase followed by mitotic
cell death, whereas depletion of the mitotic checkpoint protein
Mad2 led to a short mitosis, often followed by cell death in the
subsequent interphase. These observations are consistent with
the known phenotypes, indicating the feasibility of accurate cell
fate proﬁling based on CellH5.

ACKNOWLEDGEMENTS

We thank the members of the Gerlich Laboratory for their data
and for testing the software, and Thomas Walter and Gregoire
Pau for helpful discussions on the format design.

Funding: The research leading to these results has received fund-
ing from the European Union’s Seventh Framework Programme
(FP7/2007-2013) under grant agreement nr. 241548 (Large-scale
Integrating Project MitoSys), and under grant agreement nr.
258068 (EU-FP7-Systems Microscopy NOE).

Conﬂict of Interest: none declared.

REFERENCES

Boland,M.V. and Murphy,R.F. (2001) A neural network classiﬁer capable of recog-
nizing the patterns of all major subcellular structures in ﬂuorescence microscope
images of HeLa cells. Bioinformatics, 17, 1213—1223.

Brandes,U. et al. (2001) Graphml progress report: structural layer proposal. In:
Proceedings of 9th International Symposium on Graph Drawing. pp. 501—512.
Carpenter,A.E. et al. (2006) CellProﬁler: image analysis software for identifying and

quantifying cell phenotypes. Genome Biol, 7, R100.

Conrad,C. and Gerlich,D.W. (2010) Automated microscopy for high-content RNAi
screening. J. Cell Biol, 188, 453—461.

Eliceiri,K.W. et al. (2012) Biological imaging software tools. Nat. Methods, 9,
697—710.

 

112 /310's113u1no [pJOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; pepeoIII/noq

9IOZ ‘091sn3nv uo ::

C.Sommer et al.

 

Ellson,J. et al. (2002) Graphviz - open source graph drawing tools. In: Proceedings
of 9th International Symposium on Graph Drawing. Springer, pp. 483—484.
Gentleman,R.C. et al. (2004) Bioconductor: open software development for com-
putational biology and bioinformatics. Genome Biol, 5, R80.

Held,M. et al. (2010) CellCognition: time-resolved phenotype annotation in high-
throughput live cell imaging. Nat. Methods, 7, 747—754.

J ones,T.R. et al. (2008) CellProﬁler Analyst: data exploration and analysis software
for complex image-based screens. BM C Bioinformatics, 9, 482.

Linkert,M. et al. (2010) Metadata matters: access to image data in the real world.
J. Cell Biol, 189, 777—782.

Millard,B.L. et al. (2011) Adaptive informatics for multifactorial and high-content
biological data. Nat. Methods, 8, 487—493.

Sommer,C. et al. (2011) ilastik: interactive learning and segmentation toolkit. In: 8th
IEEE International Symposium on Biomedical Imaging: From Nano to Macro
(ISBI 2011). Chicago, Illinois, USA.

Walter,T. et al. (2010) Automatic identiﬁcation and clustering of chromosome
phenotypes in a genome wide RNAi screen by time-lapse imaging. J. Struct.
Biol, 170, 1—9.

Zhong,Q. et al. (2012) Unsupervised modeling of cell morphology dynamics for
time-lapse microscopy. Nat. Methods, 9, 711—713.

 

112 /810's112u1no [progxo'sor1eu1101urorq//:d11q 1110131 pep1201umoq

9IOZ ‘091sn3nv uo ::

