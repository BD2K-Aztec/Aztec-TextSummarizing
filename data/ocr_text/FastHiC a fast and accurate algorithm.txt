Bioinformatics Advance Access published June 1, 2016

Bioinformatics, 2016, 1—4

doi: 10.1093/bioinformatics/btw240

Advance Access Publication Date: 3 May 2016
Applications Note

 

 

Genome analysis

FastHiC: a fast and accurate algorithm
to detect long-range chromosomal
interactions from Hi-C data

Zheng Xu1'2'3, Guosheng Zhang2'4, Cong Wu5, Yun Li1'2'3'* and
Ming Hu6'*

1Department of Biostatistics, 2Department of Genetics, 3Department of Computer Science, 4Curriculum in
Bioinformatics and Computational Biology, University of North Carolina, Chapel Hill, NC 27599, USA, 5College of
Veterinary Medicine, Nanjing Agricultural University, Nanjing, Jiangsu 210095, China and 6Division of Biostatistics,
Department of Population Health, New York University School of Medicine, New York, NY 10016, USA

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on January 20,2016; revised on April 4, 2016; accepted on April 25, 2016

Abstract

Motivation: How chromatin folds in three—dimensional (3D) space is closely related to transcription
regulation. As powerful tools to study such 3D chromatin conformation, the recently developed
Hi—C technologies enable a genome—wide measurement of pair—wise chromatin interaction.
However, methods for the detection of biologically meaningful chromatin interactions, i.e. peak
calling, from Hi—C data, are still under development. In our previous work, we have developed a
novel hidden Markov random field (HMRF) based Bayesian method, which through explicitly mod—
eling the non—negligible spatial dependency among adjacent pairs of loci manifesting in high reso—
lution Hi—C data, achieves substantially improved robustness and enhanced statistical power in
peak calling. Superior to peak callers that ignore spatial dependency both methodologically and in
performance, our previous Bayesian framework suffers from heavy computational costs due to in—
tensive computation incurred by modeling the correlated peak status of neighboring loci pairs and
the inference of hidden dependency structure.

Results: In this work, we have developed FastHiC, a novel approach based on simulated field ap—
proximation, which approximates the joint distribution of the hidden peak status by a set of inde—
pendent random variables, leading to more tractable computation. Performance comparisons in
real data analysis showed that FastHiC not only speeds up our original Bayesian method by more
than five times, bus also achieves higher peak calling accuracy.

Availability and Implementation: FastHiC is freely accessible at:http://WVWN.unc.edu/~yunmli/
FastHiC/

Contacts: yunli@med.unc.edu or ming.hu@nyumc.org

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 IntrOducuon forming long-range DNA looping. Understanding such 3D chroma—

The spatial organizations of chromosomes play a critical role in tin conformation provides novel insights into the regulation mechan—
transcription regulation. In particular, regulatory elements such as isms of gene expression (Gorkin et 61]., 2014). The recently
enhancers, often contact With the promoters of targeted genes by developed Hi—C technologies enable a genome—Wide measurement of

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘BIUJOJIIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

Z.Xu et al.

 

chromatin interaction (Lieberman—Aiden et al., 2009). In the Hi—C
data, the contact frequency between any two chromatin loci is meas—
ured by the number of paired—end reads spanning across them.
Higher read count indicates more frequent chromatin interaction
and closer spatial proximity.

The rapid accumulation of Hi—C data with high sequencing
depth enables the study of chromatin interaction at the unprece—
dented resolution (Jin et al., 2013; Rao et al., 2014). However, the
detection of biologically meaningful long-range chromatin inter-
actions poses great challenges. Most existing methods (Ay et al.,
2014; Jin et al., 2013; Rao et al., 2014) assume that the chromatin
interaction frequencies for different loci pairs are independent,
which is clearly invalid. If two loci show high interaction frequency,
their adjacent loci will be more likely to interact with each other. To
fill in this gap, we have recently developed a novel hidden Markov
random field based Bayesian (HMRFBayes) method to explicitly
model the spatial dependency among adjacent loci (Xu et al., 2016).
By borrowing information across neighborhood loci, HMRF
achieves substantially improved robustness and enhanced statistical
power.

While extremely promising, HMRFBayes is based on a Bayesian
framework which requires intensive computation. The key challenge
is to efficiently and effectively infer the dependency structure under—
lying the hidden peak status. To address this challenge, we de—
veloped a novel algorithm named FastHiC, which approximates the
joint distribution of the hidden peak status by a set of independent
random variables. Under such approximation, we adopted an EM
algorithm for statistical inference. Compared with HMRFBayes,
FastHiC not only speeds up by more than five times, but also
achieves higher peak calling accuracy.

2 Statistical model

We use the same HMRF model as in our previous work (Xu et al.,
2016). Our goal is to detect biologically meaningful chromatin inter-
actions among N loci. Let xii and 617' represent the observed and ex—
pected chromatin contact frequency between loci i and 1',
respectively (1 g i < j g N Here, 6,7 is known based on the pre—
specified background model (Ay et al., 2014; Jin et al., 2013). Let z),-
be the hidden peak status: zil- : 1 indicates a biologically meaningful
interaction, while zii : —1 indicates a random collision. We further
assume that xi,- follows a negative binomial distribution with mean
617' exp{9(z,-,- —l— 1) / 2} and over—dispersion d). Here, exp{0} is the
signal—noise—ratio of the peak over the background. In the HMRF
model, we assume that xii’s are conditionally independent given the
hidden peak status zii, where zii follows an Ising distribution (Besag,
1974»

 

p({zi,}|w)=Wj,)exp w 2 am

li—i’|+li—i’|=1

Here, (0 is the parameter accounting for spatial dependency. Larger
(0 indicates higher spatial dependency. WW) is the normalization
constant without explicit expression form.

The key challenge is the efficient and effective inference of
the spatial dependency parameter 1,0. In our previous work (Xu
et al., 2016), we used the pseudo—likelihood (PL) to approximate the
Ising distribution, and devised a Gibbs sampler for statistical
inference.

PL({zzi}|¢)= H p(z,-,-Iz.v,v,|z'—z"l+Ii—i’l=1,w)-

igi<jgN

However, in the PL approximation, the neighborhood of each
loci pair can still fluctuate, resulting in intractable computation of
1,0. To solve this problem, we developed a novel algorithm named
FastHiC, which uses the simulated field 141,-,- = E(z,~,-|z,-/,-/, li —z'/|—l—
|j — jl| : 1) to approximate the joint distribution of the peak status
implicated by the Ising distribution (Celeux et al., 2003), leading to
a modified pseudo—likelihood (MPL):

MPL({z.-,-}|w)= H p(z.-,-|m.v,v,|z'—z"l+Ii—i’l=1,w)-

igi<jgN

This MPL approximates the Ising distribution by a set of inde—
pendent random variables, enabling tractable computation of 1,0.
FastHiC then adopts an EM algorithm for inference. Details of the
simulated field approximation and EM algorithm can be found in
Supplementary Material Section 51.

3 Results

We first conducted simulation study to compare the performance of
FastHiC with HMRFBayes (Supplementary Material Section 52).
These two methods achieved comparable statistical efficiency in par-
ameter estimations (Supplementary Table S1) and peak calling ac—
curacy (Supplementary Fig. S1 and Table S2). Noticeably, FastHiC
ran more than five times faster than HMRFBayes (Supplementary
Table S3), due to the novel implementation of simulated field
approximation.

Next, we re—analyzed the Hi—C data in human IMR90 cells (Jin
et al., 2013) where 2262 topological associated domains (TADs) were
identified (Dixon et al., 2012). We analyzed each TAD separately to
detect intra—TAD chromatin interactions at 4Kb resolution. We
didnot analyze inter—TAD chromatin interactions because low
sequencing depth for inter—TAD reads (the average number of intra—
TAD and inter-TAD reads are 58.91 and 1.57, respectively). Since we
have shown that HMRFBayes (Xu et al., 2016) outperforms AFC (Jin
et al., 2013) and Fit-Hi—C (Ay et al., 2014), in this work, we only
compared the performance of FastHiC and HMRFBayes
(Supplementary Table S4). We did not compare with HiCCUPS (Rao
et al., 2014) since its software is not publicly available. Overall,
FastHiC and HMRFBayes obtained highly similar peak calling re-
sults. The Spearman correlation coefficient of peak probabilities be—
tween FastHiC and HMRFBayes within each TAD has median 0.934
and standard deviation 0.121. In addition, we compared the peak
calling results from FastHiC and HMRFBayes with the chromatin
loops identified from the in situ Hi—C data (Rao et al., 2014). Figure
1A shows that peaks identified by FastHiC have slightly higher over-
lap with chromatin loops than peaks identified by HMRFBayes.
Overall, FastHiC and HMRFBayes achieved highly similar peak call-
ing accuracy in real Hi—C data in human IMR90 cells.

Next, we compared the computational time of four different
peak callers with different TAD sizes (Fig. 1B). In general, the run-
ning time increases quadratically with the TAD size. For all 2262
TADs, the average running time for FastHiC, HMRFBayes, AFC
and Fit-Hi-C are 428, 4134, 2605 and 19s, respectively. FastHiC
runs much faster than HMRFBayes and AFC. Although Fit-Hi-C
runs faster than FastHiC, we have showed that the HMRF—based ap—
proach outperformed Fit—Hi—C in peak calling accuracy (Xu et al.,
2016). Compared with Fit—Hi—C, we believe that FastHiC achieves a
reasonable balance between speed and accuracy.

To further compare the performance of FastHiC and
HMRFBayes, we analyzed two additional Hi—C datasets in human
H1 embryonic stem cells (Dixon et al., 2015) and human GM12878

9mg ‘09 1sn3nv uo sejeﬁuv s01 ‘BIUJOJIIBD aIo AllSJQAIUn 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pepaommoq

FastHiC

 

A

 

Ii' of Captured ln—Situ Loop-3
40 80 100 120
l 1

20

 

 

— HMRFBayes
I: —I — FastHiC

 

 

 

I I I I I I

0.00 0.01 [1.02 [1.03 0.04 0.05

Proportion

 

2000 o

if of Captrued Loops
1000 1500
I

500

 

— HMRFBayes
c: — — FaStHiC
I I I I I I
0.00 0.01 0.02 0.03 0.04 0.05

 

 

 

 

Pro portion

if of Captured Loops

Log10 computer time in unit of a second

 

 

      

 

 

 

 

 

 

 

 

 

 

m _
v _
m _
N _
Hli'lFlFElaye-S
— FEISIHIC
— AFC
'3 — — Fit—Hi—C
I I I I I I I
0 l 2 3 <1 5 0
TAD size (HE)
D
D
t: —-I
E
'3'
D
a _.
CD
D
D _.
:2!
ED
E3
3 ..
VI"
C:
D _.
ID
N
— HMRFBayes
D —- — FastHiC
I I I I I I
0.00 0.01 0.02 0.03 0.04 0.05
Proportion

Fig. 1. (A) The overlap between in-situ Hi-C loops (Rao et al., 2014) and peaks identified by FastHiC and HMRFBayes. (B) Computational time of four peak callers.
(C) The overlap between ChlA-PET loops (Ji et al., 2015) and peaks identified by FastHiC and HMRFBayes in primed H1 cells. (D) The overlap between ChlA-PET
loops (Tang et al., 2015) and peaks identified by FastHiC and HMRFBayes in GM12878 cells

lymphoblastic cells (Selvaraj et al., 2013). We detected intra—TAD
chromatin interactions at 40 kb resolution. To evaluate peak calling
accuracy, we compared the peak calling results from FastHiC and
HMRFBayes with the recently published ChIA-PET data on H1 (Ji
et al., 2015) and GM12878 cells (Tang et al., 2015). We found that
peaks identified from FastHiC show much higher overlap with chro-
matin loops detected from ChIA—PET data than those identified
from HMRFBayes, in both H1 (Fig. 1C and Supplementary Fig. S2)
and GM12878 cells (Fig. 1D). These results demonstrate that
FastHiC achieves higher peak calling accuracy than HMRFBayes.

In addition, we explored modeling the dependency structure
with broader neighborhood, but neither simulation studies nor real
data analysis showed performance improvement (Supplementary
Material Section S4).

4 Conclusion

In summary, we have developed FastHiC, a fast and accurate algorithm
to detect long—range chromatin interactions from Hi—C data. FastHiC
utilized the same hidden Markov random field model as in our previous
work (Xu et al., 2016), but with a novel implementation of the simu—
lated field approximation, leading to more than five times speed—up and
higher peak calling accuracy. We believe that FastHiC has potential to
become a useful tool in studying chromatin spatial organization.

Funding

This research was supported by the National Institute of Health grants R01-
HG006292 and R01-HG006703 (awarded to YL), and 1U54DK107977—01
(awarded to MH).

9mg ‘09 isnﬁnv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo AllSJQATUn 112 /3.IO'S[BUJHOIpJOJXO'SOTlBIHJOJUTOTQ/ﬂdllq 11101; prBOIUAAOG

Z.Xu et al.

 

Conﬂict of Interest: none declared.

References

Ay,F. et al. (2014) Statistical conﬁdence estimation for Hi-C data reveals regu-
latory chromatin contacts. Genome Res., 24, 999—101 1.

Besag,]. (1974) Spatial interaction and the statistical analysis of lattice systems
(with Discussion). ]. R. Stat. Soc. Ser. B, 36, 192—236.

CeleuX,G. et al. (2003) EM procedures using mean ﬁeld-like approximations
for Markov model-based image segmentation. Pattern Recognit., 36,
131—144.

Dixon,].R. et al. (2012) Topological domains in mammalian genomes identi-
ﬁed by analysis of chromatin interactions. Nature, 485, 376—380.

Dixon,].R. et al. (2015 ) Chromatin architecture reorganization during stem
cell differentiation. Nature, 518, 331—336.

Gorkin,D.U. et al. (2014) The 3D genome in transcriptional regulation and
pluripotency. Cell Stem Cell, 14, 771—775.

Ji,X. et al. (2015) 3D chromosome regulatory landscape of human pluripotent
cells. Cell Stem Cell, 18, 262—275.

Jin,F. et al. (2013) A high-resolution map of the three-dimensional chromatin
interactome in human cells. Nature, 503, 290—294.

Lieberman-Aiden,E. et al. (2009) Comprehensive mapping of long-range inter-
actions reveals folding principles of the human genome. Science, 326,
289—293.

Rao,S.S.P. et al. (2014) A 3D map of the human genome at kilobase resolution
reveals principles of chromatin looping. Cell, 159, 1665—1680.

Selvaraj,S. et al. (2013) Whole-genome haplotype reconstruction using
proximity-ligation and shotgun sequencing. Nat. B iotecknol., 31,
1 1 1 1—1 1 1 8.

Tang,Z. et al. (2015 ) CTCF-mediated human 3D genome architecture reveals
chromatin topology for transcription. Cell, 163, 161 1—1627.

Xu,Z. et al. (2016) A hidden Markov random ﬁeld based Bayesian method for
the detection of long-range chromosomal interactions in Hi-C Data.
Bioinformatics, 32, 650—65 6.

91% ‘09 isnﬁnv uo sogoﬁuv s01 ‘aguioggpag go AliSJQATUn 112 /310's112u1no[pJogxosopeuuogutotq/ﬁding uIOJg popaogumoq

