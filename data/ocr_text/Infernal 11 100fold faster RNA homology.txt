APPLICATIONS NOTE V°" 23073bﬁégﬁsﬁiﬁ’ﬁﬁiiiﬁiiﬁ

 

Sequence analysis

Advance Access publication September 4, 2013

Infernal 1.1: 100-fold faster RNA homology searches

Eric P. Nawrocki* and Sean R. Eddy

HHMI Janelia Farm Research Campus, Ashburn, VA 20147, USA

Associate Editor: lvo Hofacker

 

ABSTRACT

Summary: Infernal builds probabilistic profiles of the sequence and
secondary structure of an RNA family called covariance models (CMs)
from structurally annotated multiple sequence alignments given as
input. Infernal uses CMs to search for new family members in
sequence databases and to create potentially large multiple sequence
alignments. Version 1.1 of Infernal introduces a new filter pipeline for
RNA homology search based on accelerated profile hidden Markov
model (HMM) methods and HMM-banded CM alignment methods.
This enables ~100-fold acceleration over the previous version and
~10000-fold acceleration over exhaustive non-filtered CM searches.
Availability: Source code, documentation and the benchmark
are downloadable from http:/ﬁnfernal.janelia.org. Infernal is freely
licensed under the GNU GPLv3 and should be portable to any
POSIX—compliant operating system, including Linux and Mac OS/X.
Documentation includes a user’s guide with a tutorial, a discussion
of file formats and user options and additional details on methods
implemented in the software.

Contact: nawrockie@janelia.hhmi.org

Received on July 2, 2013; revised on August 16, 2013; accepted on
August 27, 2013

1 INTRODUCTION

Many structural RNAs conserve their sequence and secondary
structure, and the most effective RNA homology search and
alignment tools incorporate both types of conservation into
their scoring systems. Covariance models (CMs) are proﬁle sto-
chastic context-free grammars (Durbin et al., 1998), probabilistic
models of the conserved sequence and secondary structure of an
RNA family, analogous to sequence-based proﬁle hidden
Markov models (HMMs) commonly used for protein sequence
analysis, with added complexity necessary for modeling RNA
secondary structure. Infernal implements methods for construct-
ing CMs from input structurally annotated RNA alignments or
single sequences and for using those models to search for and
align homologous RNAs.

Compared with the previous version 1.0.2, Infernal 1.1 accel-
erates typical RNA homology searches ~100-fold using a ﬁlter
pipeline based on accelerated proﬁle HMM methods [the
HMMER3 project (Eddy, 2008, 2011)] and constrained CM
alignment algorithms (Brown, 2000; Nawrocki, 2009). The
increased speed comes at a negligible cost to sensitivity
(Fig. 1). Additionally, version 1.1 implements specialized algo-
rithms for structural alignment of truncated RNA sequences

 

*To whom correspondence should be addressed.

(Kolbe and Eddy, 2009) commonly found in sequencing reads,
which were prone to misalignment in previous versions.

2 APPROACH

Exhaustive dynamic programming (DP) CM algorithms are
impractically slow (Fig. 1). Several types of sequence-based ﬁlters
have been developed for acceleration, including a BLAST-based
ﬁltering scheme used by Rfam since its inception (Grifﬁths-J ones
et al., 2003) and several proﬁle HMM-based methods Weinberg
and Ruzzo, 2004, 2006). Infernal version 1.0.2 and version 1.1
both use proﬁle HMM ﬁlters: version 1.0.2’s ﬁlters are derived
from the HMMER2 package (Eddy, 2003), whereas version 1.1
co-opts HMMER3’s dramatically accelerated search algorithms,
which take advantage of single-instruction multiple-data vector
instructions to parallelize the core steps of the HMM DP algo-
rithms (Eddy, 2011). Version 1.1 uses four separate proﬁle
HMM-based ﬁlter stages, each one successively slower and
stricter than the previous stage. The new ﬁlter stages are sufﬁ-
ciently fast that the post-HMM-ﬁltering CM DP algorithms as
implemented in the previous version (1.0.2) became the clear
computational bottleneck. To accelerate these, constraints, or
bands, derived from an HMM alignment of the sequence are
imposed on the DP matrices to signiﬁcantly reduce the number
of required calculations (Brown, 2000; Nawrocki, 2009). Both
the new ﬁlters and the banded CM methods are Vital for the
improved search speed. In the benchmark described later in the
text, for default Infernal searches, the proﬁle HMM stages take
about one-third of the total running time and the remaining time
is spent on the subsequent CM DP calculations.

3 USAGE

There are two major applications of Infernal: to search for struc-
tural RNAs in a sequence dataset (e.g. to perform genome
annotation of RNAs) and to create multiple sequence— and struc-
ture-based alignments of RNA homologs [e. g. 165 small subunit
ribosomal RNA alignment for environmental survey studies
(Cole et al., 2009)]. Both applications begin with a CM ﬁle,
which can either be downloaded from the Rfam database of
>2000 RNA families (Burge et al., 2013) or created by the user
with Infernal’s cmbuz'ld program from a structurally annotated
single sequence or multiple sequence alignment. Before a CM can
be used to search a sequence database, it must ﬁrst be calibrated
by the cmcalibrate program, which performs a simulated search
against random sequence to determine model-speciﬁc parameters
for assigning E—Values to database hits. (Rfam CM ﬁles come
pre-calibrated.) The cmsearch program takes a calibrated CM
ﬁle, searches it against a sequence database and outputs a

 

© The Author 2013. Published by Oxford University Press. All rights reserved.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [glO'SIBILInO[plOJXO'SODBIILIOJHTOTQ/[ldllq wort pepcolumoq

910K ‘09 lsnﬁnV no :2

E.P.Nawrocki and S.R.Eddy

 

 

_L
o
I
I

Infernal v1.1 (ncl) filters) 4359 hours W
AW

vvvvvvvvv

l“ '
Mum (default 49.31 hours
Infernal v1.1 (default) 0.44 hours
nhmmer (sequence profiles) 0.02 hours -
BLASTN (FPW) 0.01 hours

I l l l I
0.001 0.005 0.010 0.050 0.100
false positives per Mb searched per query

.0
00
I

.0
O)
I

_0
.Is
I

.0
l\)
I

 

 

Sensitivity (fraction of true positives)

.0
o
I
I

 

I I
0.500 1.000

Fig. 1. ROC-like curves for the benchmark. Plots are shown for the new
Infernal 1.1 with and without ﬁlters, for the old Infernal 1.0.2, for proﬁle
HMM searches with nhmmer (from the HMMER package included in
Infernal 1.1, default parameters) and for fannly-pairwise-searches with
BLASTN (ncbi-blast-2.2.28+, default parameters). The maximum sensi-
tivity (not shown) for default Infernal 1.1 is 0.81 (629 of 820 true positives
found), which is achieved at a false-positive rate of 0.19/Mb/query. For
non-ﬁltered Infernal, maximum sensitivity is 0.87 at 2.9 false positives per
Mb per query. This indicates that at high false-positive rates the ﬁlters
prevent some true positives from being found, but prevent many more
false positives from being found. CPU times are total times for all 106
family searches measured for single execution threads on 3.0GHz Intel
Xeon processors. The Infernal times do not include time required for
model calibration.

ranked list of top scoring hits and hit alignments. The cmalign
program takes a CM ﬁle (calibrated or not), aligns all sequences
to the model and outputs a structurally annotated MSA in
Stockholm format. Version 1.1 introduces the cmscan program
for determining whether a given sequence contains homologies to
any known RNA families in a CM library like Rfam. Before
running cmscan, the CM database must be converted to a special
format using cmpress, which enables faster scanning.

4 PERFORMANCE

An independent benchmark of RNA homology search (F reyhult
et al., 2007) found covariance model-based programs, including a
previous version of Infernal, to be the most speciﬁc and sensitive
of the tools tested. We present here results from an updated
version of our previously published internal RMARK bench-
mark (Nawrocki et al., 2009), mainly to indicate the relative
performance of Infernal 1.1 and the previous version 1.0.2.

The RMARK3 benchmark was constructed from the seed
alignments of the Rfam 10.0 database as previously described
(Nawrocki et al., 2009). It is composed of a set of 106 families,
each represented by a training alignment of 25 aligned sequences
and a test set of 31 sequences. No two test sequences are >70%
identical, and no train/test sequence pair is >60% identical. The
780 test sequences were embedded into ten 1 Mb genome-like
sequences, to create a benchmark ‘pseudo-genome’ of 10.16 Mb.
For each included family, a model was built from the training set
using the Rfam alignment, calibrated and used to search the
pseudo-genome. The resulting hits from all searches were then
sorted by E—value and a sensitivity versus false-positive rate
ROC—like curve was generated from the results (Fig. 1).

Figure 1 shows that default Infernal 1.1 performs the bench-
mark searches in 0.44h and is ~100 times faster than the

previous version 1.0.2 (49.31h) and ~10 000 times faster than
exhaustive non-ﬁltered 1.1 search (4359 h); yet all three search
methods have similar sensitivity at the low false-positive rates ne-
cessary for large database searches. We also tested two sequence-
only methods: proﬁle HMMs implemented in HMMER3 (Eddy,
2008, 2011) and family-pairwise (Grundy, 1998) single-sequence
BLASTN queries (Altschul et al., 1997), which were faster (0.02
and 0.01 h, respectively), but signiﬁcantly less sensitive than
CMs, indicating the beneﬁt of secondary structure modeling.

The relatively fast speed of default version 1.1 on the bench-
mark is maintained on real genomic sequences. The average
speed is 1.5 s/Mb/query on the benchmark and 0.6 s/Mb/query
on a several gigabase database that includes a sampling of 15
genomes (ﬁve each of archaea, bacteria and eukarya) using the
same query models from the benchmark. As database size
increases, Infernal increases ﬁlter stringency resulting in faster
search rates without sacriﬁcing appreciable sensitivity at low
false-positive rates based on further RMARK benchmarking
(results not shown).

Infernal is now a more practical tool for RNA homology
search. The increased speed should enable its incorporation
into automated sequence annotation pipelines and obviate the
need for additional ﬁltering schemes for large-scale CM searches,
such as the BLAST-based ﬁlter paradigm used by Rfam
(Grifﬁths-J ones et al., 2003). Rfam-based annotation of one typ-
ical bacterial or archaeal genome (i.e. searching all 2208 Rfam
11.0 models against a 2—5 Mb target) now takes ~1 h on a single
quad-core desktop computer. Analysis of larger datasets, how-
ever, such as vertebrate genomes or all reads from a high-
throughput sequencing run, still requires a compute cluster. As
an example, a search of all Rfam models against the le
chicken genome would require ~3 h on a 100-CPU compute
cluster. The most expensive programs (cmalign, cmcalibrate,
cmscan and cmsearch) are implemented for use with multiple
threads on multi-core machines and in coarse-grained MPI ver-
sions for clusters.

ACKNOWLEDGEMENTS

Travis Wheeler adapted HMMER3’s ﬁlters for chromosome-
length sequences, and his code is integral to Infernal’s pipeline.
We thank Goran Ceric and his team for managing J anelia
F arm’s high-performance computing resources.

Funding: Infernal development is supported by Howard Hughes
Medical Institute.

Conflict of Interest: none declared.

REFERENCES

Altschul,S.F. et al. (1997) Gapped BLAST and PSI-BLAST: a new generation of
protein database search programs. Nucleic Acids Res, 25, 3389—3402.

Brown,M.P. (2000) Small subunit ribosomal RNA modeling using stochastic
context-free grammars. Proc. Int. Conf. Intell. Syst. Mol. Biol., 8, 57—66.

Burge,S.W. et al. (2013) Rfam 11.0: 10 years of RNA families. Nucleic Acids Res,
41, D226—D232.

Cole,J.R. et al. (2009) The Ribosomal Database Project: improved alignments and
new tools for rRNA analysis. Nucleic Acids Res, 37, D141—D145.

Durbin,R. et al. (1998) Biological Sequence Analysis: Probabilistic Models of
Proteins and Nucleic Acids. Cambridge University Press, Cambridge, UK.

 

2934

112 ﬁlm'spaumo[pJOJXO'sottchOJutotw/zdnq uroxj popcolumoq

910K ‘09 lsnﬁnV no :2

lnfemal 1. 1

 

Eddy,S.R. (2003) The HMMER2 user’s guide. http://hmmer.janelia.org/ (1 July
2013, date last accessed).

Eddy,S.R. (2008) A probabilistic model of local sequence alignment that simpliﬁes
statistical signiﬁcance estimation. PLoS Comput. Biol., 4, e1000069.

Eddy,S.R. (2011) Accelerated proﬁle HMM searches. PLoS Comp. Biol., 7,
e1002195.

Freyhult,E.K. et al. (2007) Exploring genomic dark matter: a critical assessment of
the performance of homology search methods on noncoding RNA. Genome
Res, 17, 117—125.

Grifﬁths-Jones,S. et al. (2003) Rfam: an RNA family database. Nucleic Acids Res,
31, 439—441.

Grundy,W.N. (1998) Homology detection via family pairwise search. J. Comput.
Biol., 5, 479—491.

Kolbe,D.L. and Eddy,S.R. (2009) Local RNA structure alignment with incomplete
sequence. Bioinformatics, 25, 1236—1243.

Nawrocki,E.P. (2009) Structural RNA Homology Search and Alignment Using
Covariance Models. PhD Thesis, Washington University School of Medicine,
USA.

Nawrocki,E.P. et al. (2009) Infernal 1.0: inference of RNA alignments.
Bioinformatics, 25, 1335—1337.

Weinberg,Z. and Ruzzo,W.L. (2004) Exploiting conserved structure for faster
annotation of non-coding RNAs without loss of accuracy. Bioinformatics, 20
(Suppl. 1), 1334—1341.

Weinberg,Z. and Ruzzo,W.L. (2006) Sequence-based heuristics for faster annota-
tion of non-coding RNA families. Bioinformatics, 22, 35—39.

 

2935

112 ﬁlm'spaumo[pJOJXO'sottchOJutotw/2dnq uroxj popcolumoq

910K ‘09 lsnﬁnV no 22

