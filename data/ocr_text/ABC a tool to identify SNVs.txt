Bioinformatics, 31 (18), 2015, 3057—3059

doi: 10.1093/bioinformatics/btv321

Advance Access Publication Date: 20 May 2015
Applications Note

 

Gene expression

ABC: a tool to identify SNVs causing
allele-specific transcription factor binding
from ChlP-Seq experiments

Swneke D. Bailey1'2, Carl Virtanen1, Benjamin Haibe-Kains1'2 and
Mathieu Lupien1'2'3'*

1Princess Margaret Cancer Centre, University Health Network, Toronto, ON, Canada, 2Department of Medical
Biophysics, University of Toronto, Toronto, ON, Canada and 3Ontario Institute for Cancer Research, Toronto, ON,
Canada

*To whom correspondence should be addressed.
Associate Editor: Ziv Bar-Joseph

Received on February 13, 2015; revised on April 23, 2015; accepted on May 18, 2015

Abstract

Motivation: Detection of allelic imbalances in ChlP—Seq reads is a powerful approach to identify
functional non—coding single nucleotide variants (SNVs), either polymorphisms or mutations,
which modulate the affinity of transcription factors for chromatin. We present ABC, a computa—
tional tool that identifies allele—specific binding of transcription factors from aligned ChlP—Seq reads
at heterozygous SNVs. ABC controls for potential false positives resulting from biases introduced
by the use of short sequencing reads in ChlP—Seq and can efficiently process a large number of het—
erozygous SNVs.

Results: ABC successfully identifies previously characterized functional SNVs, such as the
rs4784227 breast cancer risk associated SNP that modulates the affinity of FOXA1 for the
chromatin.

Availability and implementation: The code is open—source under an Artistic—2.0 license and ver—
sioned on GitHub (https://github.com/mlupien/ABC/). ABC is written in PERL and can be run on any
platform with both PERL (2518.1) and R (23.1.1) installed. The script requires the PERL
Statistics::R module.

Contact: mlupien@uhnres.utoronto.ca

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Genome—wide association studies (GWAS) have identified thousands
of single nucleotide variants (SNV) representing genomic loci associ—
ated with human traits and disease (Hindorff et 61]., 2009). The
causal variant(s) underlying each association are hard to identify be—
cause most of the associated loci fall outside of annotated genes
(Schaub et 61]., 2012). ChIP—Seq allows for the identification of tran-
scription factor (TF) binding sites across the genome (Furey, 2012).
Functional studies have shown that many trait/disease—associated
loci modulate the affinity of TFs for chromatin (Zhang et al., 2014).
Noncoding somatic mutations found in tumors can also modulate

TF binding to promote tumor growth and progression (Horn et 61].,
2013; Huang et 61]., 2013). The generation of ChIP—seq data for TFs
in normal cells and tumors (Dunham et 61]., 2012; Ross—Innes et 61].,
2012) provides an opportunity to directly assess the functional effect
of risk—variants and somatic mutations on TF binding. This creates a
need for a computational tool to systematically identify SNVs im—
parting an allelic imbalance in TF binding to the chromatin.

To eliminate alignment biases existing tools (Reddy et 61]., 2012;
Rozowsky et 61]., 2011; Younesy et 61]., 2014) incorporate the align-
ment of the ChIP—Seq reads to two separate genomes. The use of
two representative parental genomes assumes a diploid set of
chromosomes. Therefore, the applicability of these tools to cancer

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3057

9mg ‘09 1sn3nv uo sopﬁuv s01 ‘etulomeg aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

3058

S.D.Bailey et al.

 

samples may be limited. Tumor samples harbor numerous chromo—
somal abnormalities and exhibit clonal heterogeneity, which implies
that some inherited SNVs and somatic mutations, in particular, are
unlikely to be present at an equal ratio within tumors. In addition,
assigning the alleles of multiple somatic SNVs to the correct haplo—
type in tumor samples may prove to be challenging. We addressed
this issue by designing the allele—specific binding from ChIP-Seq
(ABC) tool. Our approach does not require phased haploid genomes
and can readily serve to call allele—specific TF binding to the chroma-
tin from normal or cancer samples where genotype information is
available.

2 Methods

The number of ChIP—Seq reads is proportional to the binding inten-
sity of the profiled TF. Each ChIP—Seq read spanning a SNV will
contain the allele that was sequenced. A deviation from the expected
proportion of reads mapping to each allele of heterozygous SNVs in—
dicates an allelic imbalance in TF binding. The null expectation
within ChIP—Seq reads should be equal to the genomic allele ratio
(gAR) or the number of reads mapping to each allele in the genomic
DNA. Accounting for the gAR adequately controls for biases caused
by differences in copy number (CNVs and aneuploidy), clonal het—
erogeneity or mapping to a reference genome (Degner et al., 2009),
assuming similar read lengths, since these biases should affect both
the genomic and ChIP—Seq reads equally. ABC applies a binomial
probability test to call an allele—specific bias in the ChIP—Seq reads
using the observed gAR as the expected occurrence of the two al—
leles. ABC requires aligned reads from a ChIP-Seq experiment in
Sequence Alignment/Map (SAM) format (Li et al., 2009) and a file
containing the position, strand, observed alleles and the gAR of het—
erozygous SNVs. Ideally the gAR is calculated from genomic
sequencing reads of similar length aligned to the same reference
genome.

Unprocessed ChIP—Seq reads result in two strand—specific read
pile—ups (peaks) surrounding the location of a TF-binding site (Fig.
1A). Binding site(s) can be inferred by extending the mapped reads
in a strand—specific manner by an estimated fragment size (Park,
2009). Thus, the detection of an allelic imbalance using only aligned
reads has the most power on the edges of a binding site and not
within the centre. The available read information for a SNV is also
limited to twice the read length used (Fig. 1B).

However, a SNV’s position can be inferred by assessing the strand
distribution of the reads containing each allele. Reads containing a SNV
that map in both orientations identify SNVs closer to the centre of a
binding site. ABC performs a Fisher’s exact test to determine that the
strand distribution is similar for both alleles. Unlike genomic DNA
sequencing the expectation of equal coverage of a SNV by reads in both
orientations is not held for reads derived from ChIP—Seq assays (Fig.
1A). A position bias where the alleles of a SNV are not equally distrib—
uted along the length of the reads spanning it can be used to identify po—
tential false—positive allelic imbalances. ABC applies a Mann—Whitney U
test to assess a potential read position bias observed between the alleles.
Confidence in the allele—specific binding called can also be gained by ac—
counting for the maximum signal intensity found within the window
surrounding the SNV. Instructions and a tutorial on how to run ABC
can be found in the Supplementary Information.

3 Results

The rs4784227 SNP imposes allele-specific binding of FOXA1 in
MCF7 cells based on ChIP—qPCR (Cowper—Sal lari et al., 2012).

 

    

 

 

 

 

 

Reference
DNA 
. . . . . . . . . . .i
_ .
“and: Iv'eriarlt
SNV
ln'ﬁ'mc‘ 21 read length
Blndlng Site E
A
P.
p.
p.
A
El.
IEl.
G
e
a.
1:
e
r$4TBd-22? and Fﬂn1
3 Reference Allele  _ j: 15‘}—
g 31" (1:11.511 11-3 Max:123
E 2"“ -
.E .5.
II
E I: " - 333;.-
E 1|}-
: ire-
m
E se-
a db - ﬂ __ a _ _
e w I
E Variant Allele
e w-
: $ I.) 3.5
Peslfien Relative to 51W

Fig. 1. The ABCs of ChlP-Seq. (A) DNA fragments (black) are sequenced from
both ends in ChlP-Seq assays. The reads (grey) are short and less than the
DNA fragment size selected for sequencing. Reads map to the positive (solid
grey) and negative (dashed grey) strands. The TF binding site (black) is
inferred by extending the reads in a strand-specific manner. (B) The SNV's lo-
cation within the TF binding site can be inferred from the aligned reads. The
distribution of total, positive and negative strand reads should be equal be-
tween alleles. The coverage window of a SNV is limited to twice the read
length used (dashed green lines). (C) Allele-specific binding of FOXA1 caused
by the rs4784227 SNV. The reads containing the reference (red) and variant
(blue) alleles, as well as the distribution of the positive (solid grey) and nega-
tive (dashed grey) reads are shown (left). The interpretation of the results is
illustrated (middle) indicating the preference of the TF (green) for the variant
allele. The processed signal, peak, is shown (right)

Using ABC against FOXA1 ChIP—Seq data from MCF7 cells
(Hurtado et al., 2011) reports increased binding intensity of FOXA1
to the variant versus reference allele of the rs4784227 SNP.
Specifically, 53 aligned reads from the FOXA1 ChIP—Seq data map
to the variant allele while 26 map to the reference allele
(P: 3.18 X 10—3) (Fig. 1C). No strand or position biases are
observed (P > 0.05) and a high processed signal is reported at this
site (normalized read depth=128). In addition, we applied ABC
genome—wide to identify SNVs modulating binding affinity of the
PU.1 (or SPIl) (Supplementary Information) and ZNF143(Bailey
et al., 2015) in GM12878 cells.

ABC provides the ability to identify allelic imbalance in TF bind-
ing, similar to a traditional allele—specific ChIP—qPCR assay and to
what is reported by Ni and colleagues (Ni et al., 2012). However,
we do not attempt to call SNVs from the ChIP—Seq data and we con—
trol for potential biases in the alignment across alleles. ABC can be
used to help understand the role of SNVs associated with traits or
disease by directly assessing their capacity to modulate TF binding
to the chromatin.

9mg ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

ABC

3059

 

Funding

The NCI/NIH (R01CA155004 to M.L.), the PMCF (ML) and the Gattuso-
Slaight Personalized Cancer Medicine Fund/PMCF (B.H-K.) supported this
research. M.L. holds a young investigator award from the OICR, a new inves-

tigator salary award from the CIHR and a Movember Rising Star award from
PCC (R82014-04). S.D.B. is a CIHR Postdoctoral Fellowship recipient.

Conﬂict of Interest: none declared.

References

Bailey,S.D. et al. (2015) ZNF143 provides sequence speciﬁcity to secure chro-
matin interactions at gene promoters. Nat. Comman., 2, 6186.

Cowper-Sal lari,R. et al. (2012) Breast cancer risk-associated SNPs modulate
the afﬁnity of chromatin for FOXA1 and alter gene expression. Nat. Genet.,
44, 1191—1198.

Degner,].F. et al. (2009) Effect of read-mapping biases on detecting allele-speciﬁc
expression from RNA-sequencing data. Bioinformatics, 25, 3207—3212.

Dunham,I. et al. (2012) An integrated encyclopedia of DNA elements in the
human genome. Nature, 489, 5 7—74.

Furey,T.S. (2012) ChIP-seq and beyond: new and improved methodologies to de-
tect and characterize protein—DNA interactions. Nat. Rev. Genet., 13, 840—852.

Hindorff,L.A. et al. (2009) Potential etiologic and functional implications of
genome-wide association loci for human diseases and traits. Proc. Natl
Acad. Sci. USA, 106, 9362—9367.

Horn,S. et al. (2013) TERT promoter mutations in familial and sporadic mel-
anoma. Science, 339, 959—96 1.

Huang,F.W. et al. (2013) Highly recurrent TERT promoter mutations in
human melanoma. Science, 339, 95 7—95 9.

Hurtado,A. et al. (2011) FOXA1 is a key determinant of estrogen receptor
function and endocrine response. Nat. Genet., 43, 27—33.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25 , 2078—2079.

Ni,Y. et al. (2012) Simultaneous SNP identiﬁcation and assessment of allele-
speciﬁc bias from ChIP-seq data. BMC Genet., 13, 46.

Park,P.]. (2009) ChIP-seq: advantages and challenges of a maturing technol-
ogy. Nat. Rev. Genet., 10, 669—680.

Reddy,T.E. et al. (2012) Effects of sequence variation on differential al-
lelic transcription factor occupancy and gene expression. Genome Res., 22,
860—869.

Ross-Innes,C.S. et al. (2012) Differential oestrogen receptor binding is
associated with clinical outcome in breast cancer. Nature, 481, 389—393.

Rozowsky,]. et al. (2011) AlleleSeq: analysis of allele-speciﬁc expression and
binding in a network framework. Mol. Syst. B iol., 7, 522.

Schaub,M.A. et al. (2012) Linking disease associations with regulatory infor-
mation in the human genome. Genome Res., 22, 1748—1 75 9.

Younesy,H. et al. (2014) ALEA: a toolbox for allele-speciﬁc epigenomics ana-
lysis. Bioinformatics, 30, 1 172—1 174.

Zhang,X. et al. (2014) Laying a solid foundation for Manhattan—‘setting
the functional basis for the post-GWAS era’. Trends Genet., 30, 140—
149.

mm ‘09 1sn8nv uo sopﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeorumoq

