ORIGINAL PAPER

Vol. 29 no. 24 2013, pages 3113-3120
doi:10. 1093/bioinformatics/btt546

 

Genome analysis

Advance Access publication September 23, 2013

Methods and challenges in timing chromosomal abnormalities

within cancer samples

Elizabeth Purdom”, Christine H01, Catherine S. Gras302, Michael J. Ouist2,

Raymond J. Cho3 and Paul Spellman2

1Department of Statistics, University of California, Berkeley, 367 Evans Hall Berkeley, CA 94720—3860, USA,
2Department of Molecular and Medical Genetics, Oregon Health & Science University, Portland, OR 97239, USA and
3Department of Dermatology, University of California, San Francisco, CA 94115, USA

Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: Tumors acquire many chromosomal amplifications, and
those acquired early in the lifespan of the tumor may be not only
important for tumor growth but also can be used for diagnostic
purposes. Many methods infer the order of the accumulation of
abnormalities based on their occurrence in a large cohort of patients.
Recently, Durinck et al. (2011) and Greenman et al. (2012) developed
methods to order a single tumor’s chromosomal amplifications based
on the patterns of mutations accumulated within those regions. This
method offers an unprecedented opportunity to assess the etiology of
a single tumor sample, but has not been widely evaluated.

Results: We show that the model for timing chromosomal amplifica-
tions is limited in scope, particularly for regions with high levels of
amplification. We also show that the estimation of the order of
events can be sensitive for events that occur early in the progression
of the tumor and that the partial maximum likelihood method
of Greenman et al. (2012) can give biased estimates, particularly for
moderate read coverage or normal contamination. We propose a
maximum-likelihood estimation procedure that fully accounts for
sequencing variability and show that it outperforms the partial max-
imum-likelihood estimation method. We also propose a Bayesian
estimation procedure that stabilizes the estimates in certain settings.
We implement these methods on a small number of ovarian tumors,
and the results suggest possible differences in how the tumors
acquired amplifications.

Availability and implementation: We provide implementation of
these methods in an R package cancerTiming, which is available
from the Comprehensive R Archive Network (CRAN) at http://CRAN.R-
project.org/.

Contact: epurdom@stat.Berkeley.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 29, 2012; revised on April 26, 2013; accepted on
September 18, 2013

1 INTRODUCTION

Tumors accumulate large numbers of mutations and other
chromosomal abnormalities due to defects in the genomic
repair mechanisms of tumor cells. Not all of these abnormalities

 

*To whom correspondence should be addressed.

are believed to be crucial for tumor growth and progression, and
a question of great importance is to try to identify the critical
abnormalities. One possible indicator of the importance of an
abnormality is when it occurred, relative to other abnormalities.
The most straightforward approach for determining the progres-
sion of these abnormalities is to evaluate multiple samples from
the same individual, such as primary and metastatic samples
(Frumkin et al., 2008; Gerlinger et al., 2012; Nishizaki et al.,
1997; Sasatomi et al., 2002), sub-clonal populations (Campbell
et al., 2008), or different portions of the same tumor (Navin and
Hicks, 2010; Siegmund et al., 2009).

It is usually difficult to have data on multiple time points in the
progression of an individual tumor; rather it is more common to
have cross-sectional data with a single time point from multiple
individuals. In this case, we cannot directly observe the accumu-
lation of genomic abnormalities and must infer it. There has been
a great deal of interest in identifying driver mutations and events
based on the frequency of their occurrence across patients
(e.g. Beroukhim et al., 2007; Cancer Genome Atlas Research
Network, 2008, 2011; Taylor et al., 2008). Many statistical meth-
odologies rigorously analyze frequencies of aberrations to deter-
mine those that are signiﬁcantly represented in the population,
with speciﬁc statistical methods developed for mutations, copy-
number abnormalities and others types of genomic profiles
(Beroukhim et al., 2007; Brodeur et al., 1982; Huang et al.,
2007; Newton and Lee, 2000; Newton et al., 1994, 1998;
Taylor et al., 2008). Yet, these techniques do not explicitly
attempt to estimate the order of occurrence.

Many methods do explicitly estimate a common temporal
ordering among samples based on the co-occurrence across
patients. Fearon and Vogelstein (1990) first proposed a temporal
ordering of mutations based on the mutations in colorectal
tumors from different stages. Since then, a great deal of meth-
odological work has formalized this work. For example, onco-
genetic tree models (Desper et al., 2000) cast this notion in a
probabilistic setting, which later work extended and generalized
(Beerenwinkel et al., 2005a, b, 2006; Gerstung et al., 2009; Hjelm
et al., 2006; Liu et al., 2009; Newton, 2002; Rahnenfiihrer et al.,
2005; Simon et al., 2000). Bilke (2005) modeled the critical elem-
ents of tumor progression in neuroblastoma by analyzing the sets
of shared mutations between the stages of a tumor and ﬁnding
the most likely model of progression between stages of aberra-
tions. Other approaches rely on stochastic models of cellular

 

© The Author 2013. Published by Oxford University Press. All rights reserved.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/by—nc/S.0/), which permits

non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re—use, please contact journals.permissions@oup.com

112 /310's113u1no [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq 11101; pepBOIUAAOG

910Z ‘09 lsnﬁnv uo ::

E.Purdom et al.

 

growth, such as the algorithm RESIC (Attolini et al., 2010),
which models the overall accumulation of abnormalities in a
population of tumors based on a probabilistic model of cell div-
ision and ﬁtness of mutations. This is not an exhaustive review,
as many other approaches to this problem exist, but a common
feature is estimating a common temporal ordering by comparing
across many samples.

The simulation study of Sprouffske et al. (2011) compares
estimates of tumor progression that use multiple samples from
a single tumor/patient with those obtained from cross-sectional
samples from many independent tumors and ﬁnds that the cross-
sectional estimates can be quite misleading due to the heterogen-
eity of paths to tumorigenesis seen in tumors. In Durinck et al.
(2011), we introduced a novel approach for temporal ordering
of genomic abnormalities that instead focused on assessing from
a single sample of a single individual the internal ordering of
chromosomal abnormalities. In that work, we dealt with the
narrow case of ordering regions of copy-neutral loss-of—hetero-
zygosity (CNLOH), when one copy of the chromosome is deleted
and replaced by the other copy. Greenman et al. (2012) gave a
generalization to general chromosomal ampliﬁcations, and in
Nik-Zainal et al. (2012) applied the technique to 21 breast
cancer samples.

The model proposed by Durinck et al. (2011) and Greenman
et al. (2012) is general in principle and offers a remarkable ability
to analyze the history of a single tumor. However, there has been
little examination of the performance of the estimates of the
temporal orderings. We show that with higher levels of ampliﬁ-
cation, most events result in non-identiﬁable models, meaning
that most regions with high levels of ampliﬁcations cannot be
timed in this way. Furthermore, differences in estimation pro-
cedures can have important effects on the quality of the estimate,
particularly for events that occur early in tumorigenesis, and
therefore are of particular biological interest. The method of
Greenman et al. (2012) uses a partial maximum-likelihood esti-
mation (MLE) technique, which can perform badly for early
(and late) events. We introduce a full MLE procedure that ac-
counts for sequencing variation, which we show performs better
for estimating early events, particularly for samples with moder-
ate read coverage. We also introduce a Bayesian estimation pro-
cedure, which can, in some situations, stabilize estimates for early
events when there are low numbers of mutations in a region.

The implementation of these methods on ovarian tumors,
which contain a large number of ampliﬁcations, allows for the
examination of the general pattern of ampliﬁcation in ovarian
tumors and suggests that there might be two distinct patterns of
ampliﬁcation present: steady accumulation of ampliﬁcations
over time versus whole-genome ampliﬁcation.

Traditional copy-number analysis examines regions of the
normal genome as to whether they are ampliﬁed in the tumor,
and as such is largely our focus; indeed, this is the only alterna-
tive in the case of exon sequencing. If limited to this approach,
only regions with one of three types of allelic copy number are
viable candidates for the temporal analysis. However, an ampli-
ﬁcation and insertion of one region of the genome into another
creates a different genome with connections between regions that
do not exist in the normal genome. In the case of whole-genome
sequencing, reads that span such breakpoints will be sequenced
and algorithms have been proposed to use these breakpoints to

estimate the relationships between these separate regions
(Greenman et al., 2012). The additional information regarding
the connections between regions, when available, has the poten-
tial to make speciﬁc estimates of timing more feasible.

2 METHODS

We consider regions that have chromosomal copy-number changes, in
other words a region in the genome that has been ampliﬁed or deleted a
known number of times resulting in S copies of the region. What we
observe as a single region with abnormal copy number is generally the
culmination of a series of K events resulting in the ﬁnal observed copy
number. This results in K +1 stages in the life of the tumor where the
region’s copy number is stable, and the goal is to estimate the proportion
of the lifetime of the tumor spent in each stage. As we make clear later, we
are generally only able to consider regions that have a history of only
ampliﬁcations, but for now we will keep the terminology general.

At each stage, individual point mutations could have been introduced
into one of the existing copies. The amount of time for which the tumor
rested in a particular stage will determine the probability of a mutation
accumulating in that region during that time, as will the mutation rate of
the tumor at that time. More precisely, let the vector 71 = (no, ...,JTK)
consist of the probabilities that a mutation originated in the correspond-
ing stage of the tumor progression. Comparing vectors 7E calculated for
different regions allows for precise comparison of the temporal order of
aberrations in different regions. Of particular interest might be no, the
proportion of time before any chromosomal change.

2.1 Model

We now describe a basic probablistic model for linking the vector 71 to the
observed set of N mutations, as proposed by Durinck et al. (2011) for
CNLOH events and generalized by Greenman et al. (2012).

Assume there are N total mutations in the region. Let P,- be the allele
frequency for a mutated location i, deﬁned as the proportion of the
sequenced copies that are mutated in that location. We can only consider
locations that have been mutated and have P,>0; locations that have
been mutated in the past but have P,- = 0 at the time of observing the
tumor cannot be distinguished from locations that were never mutated.
We do not assume that we know which of the S copies hold the mutation
or from which of the original copies (maternal or paternal) the mutation
is descended. The set of possible values for of P,- are given by
{l/ S, ..., S/ S} for a pure tumor sample. For generality, we will denote
the set of them as {611, ..., as} to handle possible contamination in our
sample (see Supplementary Appendix 3). Depending on the types of
copy-number changes that have occurred, only a subset of the set
{(11, ...,a5} may actually be possible. For example, if only histories
with ampliﬁcations events are considered, then 5/5 is not possible.

Then P,- is a multinomial random variable deﬁned by a probability
vector q = (q(a1), ..., q(aS))T that gives the probability of a randomly
acquired mutation having allele frequency for each a}, q(aj) =
P(P,- = a,~|P,->0). The values of the vector q depends on the random
process of mutagenesis over the life of the tumor. Speciﬁcally, P,- is com-
pletely determined by two random events: (i) the stage in which mutation
i occurred and (ii) which copy in existence during that stage was mutated.
We can formulate a probability model that links q with the parameter of
interest, 71, by making the following assumptions:

(1) Each location was mutated once in the history of the tumor

(2) If a mutation occurred in stage k, it is equally likely to be on any of
the copies in existence during stage k

(3) The probability of a mutation occurring in a stage k is assumed
proportional to 71k and the number of copies of the region in ex-
istence during the stage k. As we are concerned only with locations

 

3114

112 /310's113u1no [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepeoIII/noq

9IOZ ‘09 lsnﬁnv uo ::

Timing chromosomal abnormalities

 

i with P,>0, we can use Bayes rule and assumption 2, previously
mentioned, to obtain

P(mutation at i originated in stage klP, > 0) = Skim/c”

where Sk is the number of copies at stage k that survive to the end point at
which the tumor is observed, and C” is a normalizing constant equal to

K
2 $ka
k=0

Let ij be the set of copies in existence in stage k that lead to an allele
frequency 61,- in the observed tumor. All mutations originating from stage
k on the same copy s will have the same allele frequency. We notate that
allele frequency as p(k,s); p(k, s) will be the proportion of the existing
S copies that trace their descent from the parental copy s that existed in
stage k. Conditioning we can write that

K
q(aj) = Z Z P(mutation on copy slmutated in kth stage, P,- > 0)
[(20 SEij

>< P(mutated in kth stagelP, > 0)

K
ism. 1 K h
:2 ES— 6 26—2 Ajknk,w ere
k=0seekj k ’7 7Tk=o

 

A jk 2 {#copies in stage is that result in allele frequency aj}

We can collect the elements Ajk into an S X (K + 1) matrix A and write
the model simply as q = ATE/C71. As noted earlier, only a subset of the
set {1 / S, ..., S/ S} may actually be possible. When this is the case, the
corresponding row of A will be all zeros, and can be removed.

2.2 Identifiability

To formulate the model, we must assume that we can determine the
number of copies in stage k that could have resulted in allele frequency
61,- to construct the matrix A. This requires precise knowledge of the
history of ampliﬁcations. If we have three copies of the maternal copy
(M) and two of the paternal copy (P), these could have been acquired in a
variety of ways. For example, the M copy could be duplicated, then the P
copy and then one of the existing copies of M. This will result in a dif-
ferent matrix A than if the P copy were duplicated, and then the M copy
was duplicated two times (see Supplementary Table S2).

If there is only one event (K = 1), then the only possible event histories
are a deletion, a gain, or a CNLOH event where one of the copies deletes
and replaces the other copy simultaneously (a deletion would not result in
an identiﬁable model, see later in text). These events can generally be dis-
tinguished from each other based on estimating the total copy number S as
well as the allelic copy number (the number of copies of the maternal and
paternal alleles). Similarly, for case S = 4, if we assume K—2—i.e. two events
where at each event a single copy of the region was ampliﬁed—the allelic
copy number is sufﬁcient to distinguish the two possible history matrices A
corresponding to (1,3) and (2,2) allelic copy numbers. When there is >2
events in the history of the region (S > 4), even if they are simple ampliﬁca-
tions, then there are multiple event histories that can lead to the same allelic
copy number but different histories A, and thus different resulting prob-
abilities, q, of observed allele frequencies. If only allelic copy number is
available, as with exome sequencing, this means that only these ﬁve cases
where K equals 1 or 2 can we know the matrix A.

With whole-genome sequencing, algorithms have been proposed to use
reads spanning the breakpoints to reconstruct the event history A
(Greenman et al., 2012), though not all ampliﬁed regions will have a
unique construction. With exome sequencing, however, the event histories
of large ampliﬁcation regions will not be distinguishable.

Even if the event history matrix A is completely known, the question
remains as to whether 71 is identiﬁable, i.e. does complete knowledge of
the probability distribution of the data, q, allow for reconstruction of the
parameter It? It is clear that 71 is only identiﬁable if the matrix A has rank

K + 1. For this reason, we can only estimate 71 in cases where there have
been no deletions (Greenman et al., 2012), so only regions with a history
of pure ampliﬁcation can be considered. An exception is the setting of
CNLOH, where the assumption is that one of the copies deletes and
replaces the other copy simultaneously so the time for the “stage” corre-
sponding to a deletion is zero.

We show that in the case of sequential ampliﬁcation (where each event
is the addition of only one copy of the region) the sequence of events for
which this will be true is limited: for a total number of copies equal to S,
there is always exactly one history such that A is invertible and it is a
history where all of the gains are on a single line of descent. This neces-
sitates that the minor copy must have copy number 1, but this is not a
sufﬁcient condition if S > 4. When S > 4, even if the minor copy number is
equal to 1, there can still be multiple histories associated with it and only
one of these histories will be identiﬁable (see Fig. 1). This implies that of
the ﬁve cases where the A matrix can be identiﬁed based solely on allelic
copy number, only three of them are identiﬁable: CNLOH (2,0), single
gain (1,2), and unbalanced two gains (1,3). For the two tumor types we
analyzed—ovarian and skin—this was around 40% of the ampliﬁed
regions, see Supplementary Table S3.

In the sequential ampliﬁcation setting, the only identiﬁable matrix A
has a simple form and its inverse has the same simple form,

0 0  0 1
0 0  l 0
f ' +ke1xT, (l)
0 l  0 0
1 0  0 0
where e1 is the unit vector. For A, k = l and x = (1,2, - - -, S — 1)T, and

for A“, k = l/S and x = (S — l, ---,2,1)T. See Supplementary
Appendix 2 for the proof.

Not all ampliﬁcations are the result of a single copy gain at each event.
For example, if two copies are adjacent to one another, a further dupli-
cation event can replicate both copies simultaneously. We can consider
that at each event a random set of the existing copies are chosen to be
duplicated. In this setting, we have explored the possible histories via
simulation (see Supplementary Appendix 6 for details). Generally, the
histories that result in identiﬁable models are a small proportion of all
models simulated, though the histories generated by our simulations may
not be representative of likely biological scenarios. There is no obvious
condition that appears to guarantee identiﬁability, but the simulations
continue to suggest that identiﬁability is loosely a property of having a
concentration of duplications along a small number of lineages.

2.3 Modeling sequencing variability

With sequencing data, we will not observe the true allele frequencies P,-,
but rather the m,- sequenced fragments that overlap the location i, of

 

 

 

 

 

 

 

 

 

 

 

 

 

M P M P M P
l “01 .
V Tc T r(=1
1
1 k=2
 I— 3
l “—
1t3
1
(a) (b) (C)

Fig. 1. Example of three histories of ampliﬁcation that can lead to copy
number S = 5: starting at the top with normal copy-number state of one
allele from the maternal (M) and one from the paternal (P), at each time
point k there is an ampliﬁcation of an existing copy resulting in ﬁve
copies at the bottom, which represents the point at which the tumor
sample was removed. Only (a) is identiﬁable because all ampliﬁcation
occurs on one lineage

 

3115

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

E.Purdom et al.

 

which X ,- of them are mutated. Greenman et al. (2012) estimate P,- by ﬁrst
classifying each mutated location as one of the possible {aj} based on
which aj results in the largest likelihood, and then by ﬁnding the MLE of
the model given in Section 2.1 using the estimated 13,- as the true P,-. This
will ignore variability in the estimates of P,-, which can have an important
impact if m,- is moderate. For example, normal contamination will result
in a set of alleles that encompass a smaller range, making it harder to
infer the true P,- from the X ,- without greater sequencing depth.

We propose directly taking into account the variability in the X ,- by
modeling the distribution of X,. These adjustments allow us to reliably
include mutations with lower values of mi, increasing the total number of
mutations and thus the power. This distribution allows us to account for
sequencing error, as well as the fact that we only consider locations where
X ,-> 0. However, in practice this will also make little difference in most
settings unless the coverage is very low.

We model X ,- as Binomial(m,~, 13,-), where 13,- is the expected allele fre-
quency after accounting for normal contamination and sequencing error
(see Supplementary Appendix 3). In general the sequencing error will be
fairly small (l—2%), and will only affect small values of P,- (<0.2), for
example, if there is a large amount of normal contamination or large copy
number. A larger concern are sub-clonal populations, where some of the
mutations, or even the entire region, are not variant in all tumor cells.
Mild levels of sub-clonal populations that do not contain the region will
not necessarily affect the results badly if there is a large read depth and
the number of events K is small, but in more difﬁcult cases can severely
bias the results, see Supplementary Appendix 3.

2.4 Estimating n from tumors

We can then estimate 7% using maximum-likelihood techniques; unlike
Greenman et al. (2012), we expand our likelihood to include the sequen-
cing variability and sequencing error described earlier in text. For large
amount of sequencing depth, there is likely to be little difference in the
two methods, but for lower levels of sequencing, explicitly accounting for
the sequencing variability brings improved stability.

We assume in what follows that A deﬁnes an identiﬁable model. As
q oc A71, and both q and 71 must sum to l, q lies in a constrained set S2.
HA is square, we can write this as S2 = {q : A‘lq:l: 0,1Tq = 1.}. Then by
the invariance property of the MLE it is sufﬁcient to ﬁnd the MLE of q,
with the constraint that q 6 S2 and then solve for 7%. We use an EM algo-
rithm to estimate q from the data X1, . . . , X N, where the M-step involves a
constrained maximization (see Supplementary Appendix 4 for details).

The most important factor in the ability to estimate the timing of
events is the true value of the 71 vector. The allele frequencies of mutated
locations follow a multinomial distribution with the number of categories
equal to the number of alleles. When one of the alleles has a low prob-
ability of occurrence, as given by the parameter q, then the estimates of TE
become more unstable. Mutations acquired in every mutational stage
contribute to the allele frequency l/S (or its corresponding allele fre-
quency after adjusting for normal contamination and sequencing error).
The corresponding element of q, notated as q1, absorbs much of the prob-
ability; indeed, when the history is sequential ampliﬁcation, it is easy to
show that q1 is guaranteed to be largest element of the vector q, meaning
that the most likely allele frequency must always be l/S. As probabilities in
q are far from balanced regardless of the value of 71, then when 71 has
small values the probabilities in q are even smaller; this will lead to in-
stability in the estimates. Furthermore, as the total copy number of a
region grows, the number of possible alleles does as well, making the
estimation problem even more difﬁcult. To observe all the possible alleles
with a high probability requires a large number of mutations N as the copy
number grows or a value of 71 that is small (see Supplementary Fig. S1).

Some of the most important events to time accurately are those that
are early (with small 710), and therefore to counteract this instability, we
introduce a Bayesian model for estimating 71. Speciﬁcally, we assume that
It follows a Dirichlet distribution that puts uniform probability on the

K-simplex where It lies. This is commonly done in the case of simple
multinomial estimation, where a Dirichlet prior is equivalent to adding
pseudo-counts to the data to stabilize the estimates. The Dirichlet distri-
bution is not a conjugate prior for our distribution, and therefore we
sample from the posterior distribution of 71 using sampling importance
resampling to calculate the posterior mean and credible intervals (see
Supplementary Appendix 5 for details).

3 RESULTS

3.1 Simulation data

We simulated mutation data for different histories using the
model described earlier in text: calculating the q vector of multi-
nomial probabilities for a given 71' and A, generating P,- from a
Multinomial(N, q), and then generating mutation counts using a
Binomial(m,1~’,). We varied the parameter 71', the read depth,
numbers of mutations N and the normal contamination to evalu-
ate the performance of our estimation procedures; no sequencing
error was comprehensively simulated because the effect was so
small. In all situations, estimation of 710 when no <0.1 is highly
variable with few mutations, and furthermore the MLE is a
biased estimate, underestimating 710, until N becomes large.
Even in the simplest example of K: 1 (CNLOH or single
gain), if 710 = 0.01 values of N as high as 200 or 300 are
needed to remove this bias (Supplementary Fig. S2). For
710 = 0.01, the MLE estimate 7% equals zero for almost all simu-
lations, reﬂecting the low probability of observing an allele iden-
tiﬁed with the earliest stage.

For larger values of 710, the estimates are unbiased starting
around N: 50, with continually greater precision for larger N
(Supplementary Fig. S4). The read depth has much less effect on
the estimation, particularly if the read depth is >30; even for read
depth as low as 10, the loss of precision due to low read depth is
not nearly as striking as that due to reducing the number of
mutations (assuming that the mutations are correctly identiﬁed
as mutated, which is problematic with only 10x coverage). This
implies that including more mutations with lower read depth will
increase N and lead to greater precision in the estimate of 71'
despite the lower precision of each individual location. We also
note that the 95% bootstrap conﬁdence intervals are slightly
biased, with coverage probability somewhat <95% even with
large N (Supplementary Fig. S6).

Therefore, in evaluating our proposed procedures, we concen-
trate on two different contexts, 710 g 0.1 and :10 >01, and
assume that we have at least 50 mutations in a region. We
focus on the estimation of 710 as being of the greatest biological
interest.

Full Maximum Likelihood We expect that the difference
between the partial MLE method of Greenman et al. (2012)
and our full MLE method will be the largest when the question
of classifying mutated locations to a particular allele frequency
has the greatest uncertainty: lower read coverage and/or higher
levels of normal contamination. Simulation results show that
with no normal contamination, the partial MLE method can
be biased even in the relatively simple case of the single-gain
case with read coverage as high as 30x (Fig. 2). By 75X coverage
the two methods are indistinguishable for low numbers of events,
but for larger K, the partial MLE still remains biased even with
75X coverage, see Supplementary Figure S8. In particular, the

 

3116

112 /310's112u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Timing chromosomal abnormalities

 

 

 

 

 

E

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a) 1:! Full MLE  El Full MLE g. _ —,— 8
:1 Partial MLE h. _ ° ' g :1 Partial MLE 5 ‘—
O —-— n . - .
1 l I O : 1
o . : : : . _ :
° 1 g ‘ i ' 8. - : 5 O i
a E : E| o g g I
T ' m a =
g _ E o- _ E a g _ i g _ E
- : o ; : V. — <1: _ i
1 5 5 O : O E
°' ‘ E 1 «a. _ _L . m l a g __
: o g Q — l l l o
: 5 O E i <2 _ 4—
a _=_ ° ' ' o g o
O. _ _i_ g ‘ o 8 _ _:_ _:_ 2 °
0 o'
0.1 0.5 0.1 0.5
Read depth 30x Read depth 75x
pN : 0 pN = 0.3

Fig. 2. Boxplots of no based on simulated data for values of no 2 0.1, 0.5
in the single-gain case. (a) Read depth of 30X and no normal contamin-
ation. 0)) Read depth of 75 X and 30% normal contamination. The
number of mutations, N, was ﬁxed at 125

partial MLE method overestimates no for small no, and con-
versely for large no. Even where the full MLE tends to be
biased and underestimates no, the partial MLE goes the other
direction and overestimates no by a larger margin (and conversely
for large no), resulting in worse average error, Figure 3. When
normal contamination increases, the partial MLE does worse, so
that even for 75X coverage and K: 1, estimation of moderately
low values of no (e.g. no 2 0.1) is noticeably still biased (Figs 2
and 3). For large K, where the allele frequencies are closer to-
gether and harder to distinguish, the problems are magniﬁed
across a wide spectrum of no and larger coverage is required
before the bias disappears, see Supplementary Figures S6.

We note that the difference between the partial and full esti-
mation methods also depends on the complexity of the problem.
For CNLOH, where there is a direct identiﬁcation between allele
frequency and the stage in which the mutation occurred, there is
less difference in the methods—only when normal contamination
reaches ~0.3 is there a difference if the read depth is 30x. This is
likely due to the fact that with CNLOH there is no constraint on
the space in which the vector q lies. With more complex models
(i.e. larger K), small variations in the estimation of q result in
larger perturbations of the vector n (see Supplementary Fig. S9).

Bayesian Estimation From a frequentist perspective, Bayesian
estimates will be on average biased, but can offer less variability
and thus less overall error. Simulations deﬁnitely reﬂect this bias,
with Bayesian estimates on average underestimating no across
the board for CNLOH regions and generally for single-gains
shrinking the estimates toward no 2 0.5.

The Bayesian estimates for gains generally are similar to that
of the MLE, with the overall error similar for most values of no.
For extreme no (no 2 0.01 or 0.99), the Bayesian estimates have
worse overall error than the MLE, so that they do not improve
those estimates as was hoped (Supplementary Fig. S10).
However, the Bayesian interval estimates have a better coverage
probability, particularly in extreme values of no, than the boot-
strap CI. For CNLOH, however, the Bayesian estimates have a
different behavior than the MLE. For small no (3 0.1), the
Bayesian estimates have a better error rate as well as better
coverage probability; indeed for extreme no, the MLE bootstrap
conﬁdence intervals are bad, often giving extremely small or
zero-width intervals. The Bayesian estimates have a much

 

 

 

E

 

0.025

 

0.08
I
0 15

0.10
|

1to

 

(1,10 -1To)2/(Tfo(1 4‘0»
0.005 0.010 0.015 0.020

b
POSSIbIe no covered by Cl
0.05
|

 

 

 

 

 

 

 

 co
‘2 O. —
' . o \
 A v
“ 1 O. -
 o
A “x‘ '
.n“
 N
\~E~ O. _
“~~‘ O
“m .IS
‘\
25
| | | | | I O
0.
. . . . . O

1120 “0:0.01 1T0=0.05
Relative MSE

o
o
o
N
9
A
o
a)
O
00
_\
o
0.00
|

 

 

Coverage of CI

Fig. 3. Comparison of Bayesian and MLE estimates for CNLOH, see
Supplementary Figures S10 and S11 for the single-gain case. (a) Plots of
relative mean squared error on simulated data of CNLOH for three dif-
ferent estimates. Relative MSE is the MSE scaled by the value of
no(1 — no) to reﬂect the size of the MSE relative to the size of no. 0))
Comparison of CI coverage for MLE and Bayesian on simulated data.
For each possible no, CI coverage was calculated as the percentage of CIs
from simulated data that covered no; a color scale indicates the CI cover-
age, with red indicated 2 95 % coverage and magenta indicated 90—95%
coverage. The solid points indicate the true value (circle for MLE and
triangle for Bayesian). Shown are the results for when the true no is small
(0.01, 0.05) and the Bayesian estimates are not extremely biased; see
Supplementary Figure S12 for all values of no

worse error for no > 0.1 because they are extremely biased down-
ward (Fig. 3).

3.2 Cancer data

We use the exome sequencing data from six of the eight tumors
that we previously analyzed in Durinck et al. (2011). In that
work, we analyzed only CNLOH events and found that the
CNLOH event on chromosome 17 covering the tumor suppres-
sor gene TP53 to be an early event. Here we analyze both
CNLOH and single copy gains, and compare the performance
of estimates of n (no events with S :4 were observed). We note
that for these tumors, there is a high mutation rate, and many
CNLOH and single-gain abnormalities, with few higher level
ampliﬁcations. We also evaluated the timing of regions for ﬁve
ovarian tumors with WGS available through the TCGA project
(Cancer Genome Atlas Research Network, 2011). The ovarian
tumors have many more rearrangements than the skin cancers
and a much lower mutation rate. See Supplementary Appendix 1
and Supplementary Table S3 for more details regarding the
datasets.

We ﬁrst observe that the estimate of no for the two skin
tumors containing a CNLOH event on chromosome 17 con-
tinues to imply 17p CNLOH is an early event (Fig. 4a), even
after the addition of the single-gain regions, with estimates of no
on the order of 0.05 [additional CNLOH events were found by
Durinck et al. (2011) in samples that we did not analyze, see
Supplementary Appendix 1]. CNLOH events involving the
region containing TP53 are present in four of the ﬁve ovarian
samples, and TP53 mutations are found in all four of these re-
gions. Three of these TP53 mutations clearly occurred before the
CNLOH event (i.e. homozygous) with the remaining mutation

 

3117

112 /310's112u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

E.Purdom et al.

 

Ga)

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

M01 5 M31 5 i E
N= 39 61 56 38 104 42 11 I 27 10 41 47 56 I100 68 44 22 18 I 13 I 56 68 35 18 41 I 61 47
O I I I I I
.—' — o CNLOH ‘AA ‘A '°I I I  H l I 005 I
. 0 I I I I 11 I
A Gm” III lJul I l I s a -°l 1°ls 5 ill 15
°° — ”° I l l l ‘° ‘ 5 ll 5 ll
0 I I I I
E a °° 5 ~01 11 oo
5 '° 5 o a lie f° 0:
no. _ : o : : I ' °
° : : :
a :  l 00 :
I: oo : : l :
I I o I
V: _ o I I I
o : oo . I
5 "’0 o 1 | a
a _ 1°, i i
O I I I
I I  I MLE
00° 1'00 El Partial MLE
g-   ElBayes
| | | I I I I I I I I I : I I I I I E I I I I I : I I
o. o- o. o- o- c- o. Q. or c- o- o- :o- o- o- o. a- :Q. or o. c- o- :o- o. :
I: N S 3 I9 ‘I2 °° ‘— ‘r 3 ‘— °° ' 8' °° 92 ‘— N ' I: “" S 2 S ' L” ‘° '
Chromosome
Skin Tumors
( = 50 101 28 36 30 132 57 49 79 143 50 85 93 71 20 90 25 81 93 35 231 108 86
O
.—' - o CNLOH A AA
A Gain i  I
.. _ I) l I l
0
g — I 0
I: I 1 .
O O
O A
I o l O I (I) 0 AA I AI
3 ‘ l ‘ I I l I
olIII lllll l-l-o 
° 0 0 III Partial MLE
g- 1191]. I l? 11 I? II    II I I ElBayes
I I I I I I I I I I I I I I I I I I I I I I I
0' 0' 0' 0' 0' 0' 0' D. 0' D. 0' 0' 0' D. D. 0' 0' 0' 0' D. 0' D. 0'
9 9 8' 8 N 8' I9 8 8' N °’ ‘° 9 " °° 3 K ‘— 3' °’ T ‘— N

Chromosome

Single Ovarian Tumor

Fig. 4. Estimates of no with bootstrap conﬁdence intervals for the (a) skin tumors and 0)) a single ovarian tumor (13—1411). The full MLE (black
symbol), partial MLE (gray symbol) and Bayesian estimates (white symbol) with their corresponding conﬁdence intervals are shown side by side for each
region. Regions of CNLOH are marked with a circle, and those from a single gain are marked with a triangle. Regions from different samples are
separated by dashed lines. Each region is labeled by the chromosome and the arm that contain the region. Above each region, the number of mutations

(N) identiﬁed in the region is indicated. The CNLOH of 17p is shown in red

ambiguous (see Supplementary Table 4 and Supplementary
Fig. S15). However, only one sample (13—1411) has an estimate
of no for the region containing TP53 that is as early in the life of
the tumor as seen in the skin cancers.

The large number of aberrations present in ovarian tumors
allows us to observe the general trajectory of chromosomal amp-
liﬁcations (Supplemental Fig. S15). The ﬁve tumors present dif-
ferent general proﬁles. Two tumors (13-0890 and 13-1411) have
events that are clearly separated through time and span the range
of (relative) time, whereas events from other three tumors are
estimated to have occurred over a small range of time, suggesting
a short duration of rapid copy-number change. This suggests the
possibility of two different biological mechanisms in use, with
some tumors starting with a whole-genome duplication whereas
other tumors steadily accumulate copy-number changes.

Comparison with the partial MLE We have seen in simulations
that the partial MLE implemented in Greenman et al. (2012)
tends to overestimate no, particularly for small values of no.
For the skin data, the estimates of no for the two early events

on chromosome 17p given by the partial MLE method are much
larger (Fig. 4a). For sample M01, the 95% conﬁdence intervals
based on the partial MLE for the CNLOH of chromosome 17p
overlaps that of chromosome 2, making it ambiguous whether
17p is the ﬁrst event. The early events in the ovarian tumors
show an even larger difference between the two estimates. For
these early events of interest, the difference in estimation can be
important and accounting for sequencing variability identiﬁes
early events more conclusively.

Aside from the early events, we see that the estimates for the
full and partial MLE methods are generally equivalent for the
skin tumors. For the ovarian tumors, however, the differences
are more striking even for events that have only moderate esti-
mates of no, see Figure 4b. This is due to the fact that the ovarian
samples are sequenced at ~35>< coverage compared with 100x
coverage for the skin tumors (Supplementary Table S3); further-
more, gains are more heavily represented for the ovarian tumors,
and the gains show much greater differences between the
estimates.

 

3118

112 /810's112u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Timing chromosomal abnormalities

 

Bayesian Estimation For regions where the MLEs are ap-
proaching the boundary of the parameter space (estimates that
are essentially 0 or 1) the Bayesian estimates, as expected, shrink
the estimates away from the boundary and toward the prior mean.
Particularly for CNLOH regions, the bootstrap conﬁdence inter-
vals for the MLE estimates often do not sufﬁciently capture the
variation in the estimates. One example is the CNLOH event in
8pq in the skin tumor M01, where only 1 1 mutations are observed,
but all of them are heterozygous. Bootstrap conﬁdence intervals
give great conﬁdence to the parameter estimate of no 2 1 even
though N = 11; the Bayesian analysis, as hoped, modulates these
estimates, both decreasing the estimate in accordance with the
prior distribution and giving greater levels of uncertainty corres-
ponding to the small sample size.

The Bayesian estimates, as seen in simulation, also generally
give lower estimates of all no for CNLOH and estimates closer
to 0.5 for extreme values of no for single gains, which is also
reﬂected in both cancer datasets. However, the difference in
estimates is not large relative to the conﬁdence intervals of the
estimates, and is probably offset by the advantage of increased
accuracy of the conﬁdence intervals, particularly for early events.

4 CONCLUSION

Precise timing of chromosomal abnormalities provides a won-
derfully detailed glimpse of the etiology of a single tumor.
However, we have demonstrated that there are limitations to
this technique. In particular, we have shown that for high-level
ampliﬁcations, most of the possible combinations of events that
result in large amounts of ampliﬁcation will not retain enough
information in the allele frequencies to be able to estimate the
ordering. Only regions where the ampliﬁcation follows one single
lineage can be timed using this model. This may result in a biased
impression of the etiology, as this type of ampliﬁcation may be
predominant for the promotion of certain types of abnormalities
and may miss many other types of oncogenes.

As we note in the introduction, our focus has been the trad-
itional one of copy-number analysis, where each region in the
normal genome is analyzed separately as to its behavior in the
tumor. With exome sequencing, this traditional viewpoint is still
the only one available. With whole-genome sequencing, as we
noted, one can analyze the relationships between the regions and
order the events using the information from other regions. In this
case, a single region A can share an event with another region B
if the ampliﬁcation brought the two into proximity to each other
through an insertion. Then there are additional constraints on
estimating nA and n3 jointly, as that event must occur at the
same moment for both. This implies that with reasonably deep
whole-genome sequencing such that these relationships are reli-
ably determined, there will be a larger percentage of histories that
are identiﬁable.

In addition, early events, which are of particular biological
signiﬁcance, are sensitive to estimation procedures and large
numbers of mutations are necessary to be able have stable esti-
mates of the time of occurrence. Of even greater difﬁculty is the
ordering of a collection of early events. Even with whole-genome
sequencing, some regions will not have the hundred or more
mutations that our simulations show are necessary to distinguish
early events, particularly in tumors with low mutation rates.

However, we have also shown that differences in estimation
techniques can help provide better estimates and conﬁdence
intervals for temporal estimates. We have introduced a full
MLE to handle sequencing variability due to lower read cover-
age, as well as a Bayesian estimation technique. We have shown
the full MLE can provide improvement with read depths as large
as 30x, and even up to 75X or higher if there is normal contam-
ination or early events. The Bayesian estimates have a varying
performance for different values of the parameter space, but
can provide increased stability, particularly in their estimates of
conﬁdence intervals for the estimates.

Ultimately, the ability to successfully estimate n also relies on
intrinsic properties of the cancer. In the skin tumors, only half of
the samples had CNLOH over the tumor suppressor gene TP53
(not all of which were examined in this work); in the other
samples, both copies of TP53 were also inactivated but through
multiple mutations, not a chromosomal abnormality. Other im-
portant regions may be too small in a particular sample to have
sufﬁcient mutations—the regions we ordered were large, some-
times entire chromosomal arms. Some tumors, such as the ovar-
ian, have low mutation rates so that even with whole-genome
sequencing many regions will have few mutations or not enough
to conﬁdently distinguish between events. While 30—60% of the
abnormal regions could theoretically be timed in our sample, the
percentage that had enough mutations was generally 20—30%.
Therefore, timing of the chromosomal abnormalities of a single
sample remains extremely fragmentary, and an insight into
tumor etiology will still ultimately be gained by comparing the
temporal ordering of many tumors.

ACKNOWLEDGEMENTS

The authors thank the anonymous reviews for their helpful sug-
gestions. The results published here are in whole or part based on
data generated by The Cancer Genome Atlas pilot project estab-
lished by the NCI and NHGRI. Information about TCGA and
the investigators and institutions that constitute the TCGA
research network can be found at http://cancergenome.nih.gov/.

Funding: National Institute of Health TCGA grant (U24
CA143799); the Anna Fuller fund; the Dermatology
Foundation; the American Skin Association; and National
Science Foundation grants (DMS-0636667, DMS-1026441).

Conﬂict of Interest: none declared.

REFERENCES

Attolini,C. et al. (2010) A mathematical framework to determine the temporal
sequence of somatic genetic events in cancer. Proc. Natl Acad. Sci. USA, 107,
17604—17609.

Beerenwinkel,N. et al. (2005a) Learning multiple evolutionary pathways from cross-
sectional data. J. Comput. Biol, 12, 584—598.

Beerenwinkel,N. et al. (2005b) Mtreemix: a software package for learning and using
mixture models of mutagenetic trees. Bioinformatics, 21, 2106—2107.

Beerenwinkel,N. et al. (2006) Evolution on distributive lattices. J. T heor. Biol, 242,
409—420.

Beroukhim,R. et al. (2007) Assessing the signiﬁcance of chromosomal aberrations in
cancer: methodology and application to glioma. Proc. Natl Acad. Sci. USA, 104,
20007—20012.

Bilke,S. (2005) Inferring a tumor progression model for neuroblastoma from
genomic data. J. Clin. Oncol, 23, 7322—7331.

 

3119

112 /810's112u1no [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

E.Purdom et al.

 

Brodeur,G. et al. (1982) Statistical analysis of cytogenetic abnormalities in human
cancer cells. Cancer Genet. Cytogenet., 7, 137—152.

Campbell,P.J. et al. (2008) Subclonal phylogenetic structures in cancer revealed by
ultra-deep sequencing. Proc. Natl Acad. Sci. USA, 105, 13081—13086.

Cancer Genome Atlas Research Network. (2008) Comprehensive genomic charac-
terization deﬁnes human glioblastoma genes and core pathways. Nature, 455,
1061—1068.

Cancer Genome Atlas Research Network. (2011) Integrated genomic analyses of
ovarian carcinoma. Nature, 474, 609—615.

Desper,R. et al. (2000) Distance-based reconstruction of tree models for oncogen-
esis. J. Comput. Biol, 7, 789—803.

Durinck,S. et al. (2011) Temporal dissection of tumorigenesis in primary cancers.
Cancer Discov., 1, 137—143.

Fearon,E. and Vogelstein,B. (1990) A genetic model for colorectal tumorigenesis.
Cell, 61, 759—767.

Frumkin,D. et al. (2008) Cell lineage analysis of a mouse tumor. Cancer Res., 68,
5924—5931.

Gerlinger,M. et al. (2012) Intratumor heterogeneity and branched evolution
revealed by multiregion sequencing. N. Eng. J. Med, 366, 883—892.

Gerstung,M. et al. (2009) Quantifying cancer progression with conjunctive Bayesian
networks. Bioinformatics, 25, 2809—2815.

Greenman,C.D. et al. (2012) Estimation of rearrangement phylogeny for cancer
genomes. Genome Res., 22, 346—361.

Hjelm,M. et al. (2006) New probabilistic network models and algorithms for onco-
genesis. J. Comput. Biol, 13, 853—865.

Huang,H. et al. (2007) Bayesian analysis of frequency of allelic loss data. J. Am.
Stat. Assoc, 102, 1245—1253.

Liu,J. et al. (2009) Inferring progression models for CGH data. Bioinformatics, 25,
2208—2215.

Navin,N.E. and Hicks,J. (2010) Tracing the tumor lineage. Mol Oncol, 4,
267—283.

Newton,M.A. (2002) Discovering combinations of genomic aberrations associated
with cancer. J. Am. Stat. Assoc, 97, 931—942.

Newton,M.A. and Lee,Y. (2000) Inferring the location and effect of tumor suppres-
sor genes by instability-selection modeling of allelic-loss data. Biometrics, 56,
1088—1097.

Newton,M.A. et al. (1994) Assessing the significance of chromosome-loss data:
where are suppressor genes for bladder cancer? Stat. Med, 13, 839—858.

Newton,M. et al. (1998) On the statistical analysis of allelic-loss data. Stat. Med, 17,
1425—1445.

Nik-Zainal,S. et al. (2012) The life history of 21 breast cancers. Cell, 149, 994—1007.

Nishizaki,T. et al. (1997) Genetic alterations in primary breast cancers and their
metastases: direct comparison using modiﬁed comparative genomic hybridiza-
tion. Genes Chromosomes Cancer, 19, 267—272.

RahnenfiihrerJ. et al. (2005) Estimating cancer survival and clinical outcome based
on genetic tumor progression scores. Bioinformatics, 21, 2438—2446.

Sasatomi,E. et al. (2002) Comparison of accumulated allele loss between primary
tumor and lymph node metastasis in stage II non-small cell lung carcinoma:
implications for the timing of lymph node metastasis and prognostic value.
Cancer Res., 62, 2681—2689.

Siegmund,K.D. et al. (2009) Inferring clonal expansion and cancer stem cell
dynamics from DNA methylation patterns in colorectal cancers. Proc. Natl
Acad. Sci. USA, 106, 4828—4833.

Simon,R. et al. (2000) Chromosome abnormalities in ovarian adenocarcinoma: III.
Using breakpoint data to infer and test mathematical models for oncogenesis.
GGenes Chromosomes Cancer, 28, 106—120.

Sprouffske,K. et al. (2011) Accurate reconstruction of the temporal order of muta-
tions in neoplastic progression. Cancer Prev. Res., 4, 1135—1144.

Taylor,B.S. et al. (2008) Functional copy-number alterations in cancer. PLoS One,
3, e3179.

 

3120

112 /810's112u1no [progxo'sor1eu1101urorq//:d11q 111011 pep1201umoq

9IOZ ‘09 lsnﬁnv uo ::

