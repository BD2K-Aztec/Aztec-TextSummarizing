Bioinformatics Advance Access published July 10, 2016

Bioinformatics, 2016, 1—8

doi: 10.1093/bioinformatics/btw364

Advance Access Publication Date: 17 June 2016
Original Paper

 

Gene expression

Statistical modeling of isoform splicing
dynamics from RNA-seq time series data

Yuanhua Huang1 and Guido Sanguinetti1'2'*
1School of Informatics, University of Edinburgh, Edinburgh EH8 9AB, UK and 2Centre for Synthetic and Systems
Biology (SynthSys), University of Edinburgh, Edinburgh EH9 3BF, UK

*To whom correspondence should be addressed.
Associate Editor: Inanc Birol

Received on February 19,2016; revised on May 16, 2016; accepted on June 5,2016

Abstract

Motivation: lsoform quantification is an important goal of RNA—seq experiments, yet it remains
problematic for genes with low expression or several isoforms. These difficulties may in principle
be ameliorated by exploiting correlated experimental designs, such as time series or dosage re—
sponse experiments. Time series RNA—seq experiments, in particular, are becoming increasingly
popular, yet there are no methods that explicitly leverage the experimental design to improve iso—
form quantification.

Results: Here, we present DICEseq, the first isoform quantification method tailored to correlated
RNA—seq experiments. DICEseq explicitly models the correlations between different RNA—seq ex—
periments to aid the quantification of isoforms across experiments. Numerical experiments on
simulated datasets show that DICEseq yields more accurate results than state—of—the—art methods,
an advantage that can become considerable at low coverage levels. On real datasets, our results
show that DICEseq provides substantially more reproducible and robust quantifications, increasing
the correlation of estimates from replicate datasets by up to 10% on genes with low or moderate
expression levels (bottom third of all genes). Furthermore, DICEseq permits to quantify the trade—
off between temporal sampling of RNA and depth of sequencing, frequently an important choice
when planning experiments. Our results have strong implications for the design of RNA—seq experi—
ments, and offer a novel tool for improved analysis of such datasets.

Availability and Implementation: Python code is freely available at http://diceseq.sf.net.

Contact: G.Sanguinetti@ed.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

In most eukaryotes, alternative splicing is an important post—
transcriptional mechanism of regulation of gene expression, and
largely increases the diversity of the proteome (Graveley, 2001). For
example, over 90% of human genes have multiple isoforms (Wang
et 61]., 2008). Several lines of evidence indicate that alternative splic—
ing plays a vital role in regulating biological processes (Blencowe,
2006), and its failure often causes serious diseases (Scotti and
Swanson, 2016). The study of splicing has been revolutionized by
the advent of high—throughput transcriptome sequencing (RNA—seq)
techniques which enable unbiased sampling of the transcriptome

and have greatly contributed to uncover novel biological functions
for alternative splicing (Wang et 61]., 2009). More recently, RNA—seq
technologies have been combined With biotin labelling treatment to
provide kinetic measurements of RNA transcription and splicing
with high temporal resolution (Barrass et 61]., 2015; Eser et 61].,
2016; Windhager et 61]., 2012), providing invaluable mechanistic in-
sights in the dynamics of splicing.

At the current stage of the technology, sequenced reads in
RNA—seq experiments are much shorter than almost all eukaryotic
transcripts. Thus, most reads from an RNA—seq experiment cannot
be unambiguously aligned to a specific isoform. While in some cases

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com l

91% ‘09 1sn3nv uo sepﬁuv s01 ‘BIUJOJIIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; prBOIUAAOG

Y.Huang and G.Sanguinetti

 

a high level of coverage may obviate the problems, in many cases
the number of reads that map to a single isoform is too low; when
many isoforms are present, there may be no unambiguously assigned
reads. To address this problem, several probabilistic methods were
proposed to quantify the isoform proportion, for example IsoEM
(Nicolae et 61]., 2011), Cufﬂinks (Trapnell et 61]., 2010), MISO (Katz
et 61]., 2010) and BitSeq (Glaus et 61]., 2012). All of these methods
introduce latent variables to model the identity of a read, i.e. which
isoform it came from, and then reconstruct isoform proportions by
maximum likelihood or by computing a posterior distribution from
the observed read distribution.

Most of these computational methods can quantify the isoform
proportions accurately in many cases (Kanitz et 61]., 2015), however
for all methods isoform quantification at low coverages remains
challenging. A natural approach in these cases is to exploit add—
itional information, for example exploiting correlations across dif—
ferent experiments arising out of structured experimental designs
such as time series or dosage response experiments. Time series
RNA—seq designs, in particular, are becoming increasingly popular
as an effective tool to investigate the dynamics of gene expression in
a range of systems (Bar—Joseph et 61]., 2012; Honkela et 61]., 2015;
Tuomela et 61]., 2012; Zhang et 61]., 2014). To our knowledge, no
methods have been proposed that can exploit structured experimen—
tal designs in order to improve isoform estimation. This methodo—
logical gap also negatively affects the ability to design effectively
experiments: for example, it is difficult to understand whether re—
sources should be invested in gathering more time points, or in
sequencing at a deeper level on a more limited number of samples.

In this article, we present a new methodology, DICEseq (Dynamic
Isoform spliCing Estimator via sequencing data) to jointly estimate
the dynamics of isoform proportions from RNA-seq experiments with
structured experimental designs. DICEseq is a Bayesian method based
on a mixture model whose mixing proportions represent isoform
ratios, as in (Glaus et 61]., 2012; Katz et 61]., 2010); however, DICEseq
incorporates the correlations induced by the structured design by cou—
pling the isoform proportions in different samples through a latent
Gaussian process (GP). By doing so, DICEseq effectively transfers in-
formation between samples, borrowing strength which can aid to
identify the isoform proportions. Our results show that DICEseq con—
sistently improves in accuracy and reproducibility over the state of the
art. This improvement can be very significant for a large fraction of
genes: on one real dataset, the correlation between estimates from rep—
licate datasets increased by over 10% across one third of the genes as
a result of taking temporal information into account. Furthermore,
simulation studies indicate that DICEseq can be an important tool in
experimental design, enabling an effective trade—off of resources be—
tween sequencing depth and sample numbers. DICEseq therefore
offers an effective way to maximize information extraction from com-

plex high-throughput datasets.

2 Methods
2.1 Mixture modelling of RNA—seq data

We brieﬂy review here the mixture modelling framework for iso-
form identification (MISO), as described in (Katz et 61]., 2010). We
will describe the model on a per gene basis; the output of an RNA—
seq experiment is therefore N reads RLN aligned to a gene with C
isoforms. Each read Rn has its identity In E {1, . . . , C}, i.e. which
specific isoform it originated from, but, unless the read is aligned to
isoform specific region, e.g. a junction, we will not know its identity.
The proportion of each specific isoform within the pool of total

mRNA is defined by the vector ‘1’, whose entries must be positive
and sum to 1. We can then define the likelihood of isoform propor-
tions ‘1’ as mixture model as follows

N C
P(R1.NILP) = H 2 P(RnIIn)P(In|‘i’)- (1)

11:1 ["21

The conditional distribution of In|‘I’ is assumed to be Multino—
mial,  N Multinomial(‘I’ >l< w) where w is a weight vector
adjusting the isoform proportion by the effective length of each iso—
form. The term P(R,,|I,,) encodes the probability of observing a cer—
tain read coming from a specific isoform In. This term automatically
adjusts for the different informativeness of different reads: for ex—
ample, junction reads will generally have a reduced number of pos—
sible isoforms (in extreme cases, only one), and as such will carry
considerably more information through a reduced—entropy term
P(R,,|I,,). In this way, while the approach uses all sequenced reads
for inference, the architectural information of the various transcript
is still retained and automatically used. The model is completed by
specifying a prior distribution over the isoform proportion vector ‘1’,
which in (Katz et 61]., 2010) was chosen to be a Dirichlet on
‘I’. Extending the MISO model to time series RNA—seq experiments
involves a choice on how to model temporal correlations between
the values of ‘I’ at different time points; we will use a ﬂexible non-
parametric prior in the form of a Gaussian process for this.

2.2 Gaussian processes

Gaussian processes (GPs) are a generalization of the multivariate
normal distribution to infinite-dimensional random functions. The
key property of a GP is that all of its finite dimensional marginals
are multivariate normals; in other words, evaluating a random func—
tion drawn from a GP at a finite set of points yields a normally dis—
tributed random vector. A GP over a suitable input space T is
uniquely specified by a mean function m : T —> R and a covariance
function [a : T x T —> R, which models how correlations between
function outputs depend on the inputs. In this paper, we will identify
the input space T with the time axis, and use as a covariance func—
tion the squared exponential (or RBF) covariance

k(t1,t2) = 916Xp(— (t1 — t2)2). (2)

1
2—82

The covariance function depends on two hyper—parameters, the
prior variance 01 and the (squared) correlation lengthscale 02.

The fundamental property of GPs relates the abstract function
space view of GPs reported above with the explicit parametric form
of their finite dimensional marginals. Let f denote a random function
sampled from a GP, (t1, . . . , tN) denote a set of input (time) points
and f : (f(t1), . . .,

tion f over the input points. Then, we have that

f~ game) H f ~N<m,K> <3)

f (MD the vector obtained by evaluating the func—

where m and K are obtained by evaluating the mean and covariance
,tN) (and pairs thereof). The
fundamental property (Equation 3) is key to the success of GPs as a

functions over the set of points (t1, . . .

practical tool for Bayesian inference: given observations of the func—
tion values y, it is in principle straightforward to obtain posterior
predictions of the function values everywhere by applying Bayes’
theorem

P(f(tnew|y)) o< jdfmfronewnpolo <4)

If the observation noise model p(y|f) is Gaussian, then the inte—
gral in Equation (4) is analytically computable. Notice that

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘BIUJOJIIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pepeommoq

Statistical modeling of isoform splicing dynamics

 

Equation (4) provides a way of predicting the latent function at all
time points, not just the observation points. In the following, we de—
scribe an algorithm to approximate the computation of Equation (4)
for multinomial observations. For a thorough review of GPs and
their use in modern machine learning, we refer the reader to the ex—
cellent book (Rasmussen and Williams, 2006).

2.3 Posterior of splicing dynamics with GP prior

Given a set of RNA—seq reads R : [RRIN . . . ,  for T time points
that are aligned to a gene with C isoforms, the posterior of the splicing
dynamics for the isoform proportions ‘1’ :  . . . ,  is as
follows,

P(‘I’|®,R) o< P(@)P(‘I’|®) >< ﬁP(R§E)1\It|‘I’(t))

t=1
T N, C
0< P(@)P(‘1’l@) ><  ENRPIISUPU? l‘i’m) (5)
t=1n=11[(1t):1

where ‘I’ is assumed as a Softmax function of latent variable Y, i.e.
(DC : eye / e”, and 32C: 0 to make the correspondence. Also
YC : [329), . . . , yngj follows a Gaussian process with its isoform spe—
cific hyperparameters 0C and mean me. By introducing the GP prior
here, the joint analysis of time series RNA—seq data becomes pos—
sible, as shown in a cartoon in Figure 1.

We assume in the following that the prior GP has zero mean, but
this can be adjusted in a straightforward way to a more informative
prior. Hyperparameters can also be sampled, however this leads to a
much more complex inference problem since latent function values
and hyperparameters are strongly correlated. We therefore fix
0571 = 3.0, so that the 95% prior confidence intervals of (D at an in-
dependent time point goes from 0.03 to 0.97, and set the second
hyperparameter 02 empirically to account for approximately 20—
40% of the duration of the experiment. A sensitivity analysis to 02 is
provided in Supplementary Table S1 and Supplementary Figure S3.
Inference of 02 can also be achieved by a straightforward extension

- |..w|| l ham 1 |'.1I1:I .‘

RNA-seq experiment
0 b i; l; 0
Separate analysis Joint analysis

it; c
I

<—i

Fig. 1. A cartoon comparison between separate and joint analysis of time-ser-
ies RNA-seq experiments. In the example gene, there are two isoforms with
one alternative exon (the white one), and many paired-end reads are aligned
to the genome for isoform quantification. The’ ‘separate analysis’ estimates
the isoform proportions for three time points independently, but the ‘joint
analysis' estimate them together with a joint Gaussian process prior

of Algorithm 1 (see Supplementary Algorithm S1). However, this
comes with a large additional computational cost, and in our experi—
ments does not lead to improvements in accuracy; this is probably
due to the fact that the typical RNA—seq time series is too short to
carry enough information about the value of hyperparameters.

Having defined the posterior of the splicing dynamics, we intro—
duce a Metropolis—Hasting sampler in Algorithm 1, which is a
Markov chain Monte Carlo (MCMC) method, to infer the posterior
of the splicing dynamics.

 

Algorithm 1 Metropolis-Hastings sampler for posterior of la—
tent Y

 

Require: T,R, 9,2
Initialize: Y(O)
Calculate: ‘I’ml = Softmax(Y(0)); K = GPcov(®, T)
for i: 0 to H do
Sample: a N U(0, 1)
Sample: Y* N Q,(Y* |Y<i>, iK)
Calculate: ‘I’* = Softmax(Y*)
if ,u < min{—If($ijlj§):%(§f|§:fi% , 1} then
Y(i+1) (_ Y*; \P(i+1) (_ ‘1”
else
Y(i+1) (_ Ya); \P(i+1) <_ \P(i)
end if
end for

 

Here, the proposal distribution Qy for YC is a multivariate
Gaussian distribution, whose mean is the last accepted Y9, and the
covariance matrix is defined by the fixed hyper—parameters 0C and
the times T, but adjusted to the data itself, including the empirical
variance of y, the number of isoforms and number of time points, to
ensure the 30—5 0% acceptance ratio. Namely, I55 : TKO; 2 :
(50§)/(CT0571), and the proposal distribution is N(Yc(i),I/<\C). Notice
that, in contrast to the MISO algorithm Katz et al. (2010), our sam—
pler directly collapses the read identity variables, leading to consid—
erable speedups when the number of isoforms is not too high.

For each gene, the initial MCMC chain contains 1000 iterations.
Then the Geweke diagnostic Z score (Geweke, 1991) is applied to
check the convergence of Y, using the first 10% and the last 50% it—
eration of the sampled chain. If |Z| > 2, then 100 more iterations
will be added until the criterion is passed.

2.4 Reads probability and bias correction

DICEseq supports both single—end and paired—end reads. Here we
describe the situation of paired—end reads; for single—end reads, just
change the fragment length into read length. Given a read (pair) Rn
mapping to an isoform 6, the reads probability P(R,,|I,, : 6) could
be defined by taking information of the fragment length If, the align-
ment quality mapq and the reads position p, as follow,

P(Rni1n) = P(lfi1n)P(piIm 1f)P(Rn|man) (6)

Here, we apply a Gaussian distribution to model the distribution
of fragment length. The parameters (mean and variance) could be
either set by user or learnt from the data itself. In some species, most
reads can be very well mapped to a single position of the genome,
and we could simply use uniquely mapped reads. However, in some

91% ‘09 1sn3nv uo sejeﬁuv s01 ‘BTUJOJTIBD aIo AllSJQATUn 112 /§.IO'S[BLLIHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; pepeommoq

Y.Huang and G.Sanguinetti

 

other species, such as yeast, which contains many paralogs, there are
higher chances to align a read to multiple positions. In the latter case
for keeping multiply aligned reads, the mapq score will be taken
into account, as P(R,,|mapq) : 1 — 10_MAPQ/10, and we take the
score of the better aligned mate for reads pair.

The reads position could be assumed to come from a uniform
distribution, or could explicitly model sequence and position biases.
In both cases, we could describe the probability as follows,

195(1))

 = C, = W 

where 195(1)) is relative weight of a position [9. For uniform distribu-
tion, 195(1)) E 1, so that P(p|I,,, lf) : 1/(lk — lf —l— 1). For the bias dis—
tribution, we employed the bias correction model that was proposed
by Roberts et al. (201 1) to correct the position and sequence bias.

Brieﬂy, Roberts et al.’s model of position bias tries to estimate
which fractional position is preferred for sequencing. Thus, 20 bins
from the beginning to the end of the isoform were used to count
aligned reads, and isoforms are also divided into five groups based
on their length. The sequence bias correction model tries to estimate
the occurrence of a read with a surrounding sequence of each end
from —8 to +12 nucleotides. A variable length Markov models were
used to reduce the combinations of the 21 nucleotides, resulting in
774 parameters, as in (Roberts et al., 2011). In DICEseq, we esti—
mate these parameters empirically from the genes with only one
isoform.

Empirically, we observed that correcting for biases did not
significantly alter the results of our analyses, see Supplementary
Table S2.

2.5 Gene annotation, input datasets and processing
Simulated reads in fastq format were generated from Spanki v0.5.0
(Sturgill et al., 2013). It is based on the human gene annotation and
genome sequences which were downloaded from GENCODE with
release 22. In addition to exclusively keeping protein coding genes,
we further removed those genes that only have one isoform (for
these the problem is trivial) or overlap with others. Note that over—
lapping genes can also be accommodated by considering an ex—
tended isoform identification problem, whereby the identity of the
read also includes the gene it belongs; this however requires a modi—
fication of the annotation file and was not considered for the pur—
poses of illustrating our algorithm. Consequently, 90 759 isoforms
from 11 426 genes were included for simulation. We randomly gen—
erated isoform ratios for each gene at 8 time points, with an assump—
tion of either Gaussian process or first—order dynamics. Then the
randomly generated isoform ratios were multiplied with the fixed li-
brary reads—per—kilobase (RPK, ranging from 50 to 1600), to further
define the number of isoform specific reads for the Spanki
simulator.

4tU—seq datasets are available from the Gene Expression
Omnibus (GEO; accession number GSE70378). The yeast gene an—
notation and genome sequences were downloaded from Ensembl
with version R64-1-1, and all 309 intron—containing genes were
included for analysis.

Circadian RNA—seq and microarray datasets on mouse liver
were downloaded from GEO: GSE54652. The gene annotation and
genome sequences were downloaded from GENCODE with release
M6. Based on the annotation, we included 55 440 isoforms from 10
553 multiple—isoform, non—overlap, protein—coding genes. Processed
microarray data (Zhang et al., 2014), which are based on

Affymetrix MoGene 1.0 ST, were employed for validation of the iso—
form estimate from RNA—seq. The microarray probe ids were
mapped to GENCODE ids by Ensembl BioMart, leaving 30 534 iso—
forms from 9755 genes for study.

All above RNA—seq datasets were downloaded in fastq format,
and first aligned to corresponding Genome sequences above via
HISAT 0.1.6—beta (Kim et al., 2015), in paired—end mode with de—
fault setting.

3 Results

3.1 Methods comparison using simulated reads

In order to assess the performance of DICEseq, we compared it with
three commonly used methods in their latest version: IsoEM v1.1.4
(Nicolae et al., 2011), MISO v0.5.3 (Katz et al., 2010) and
Cufﬂinks v2.2.1 (Trapnell et al., 2010). We also report results for a
variant of DICEseq which ignores temporal correlations (DICE-
sepa). Notice that DICE—sepa is essentially the same as MISO as a
model, only differing in the estimation procedure and prior (col—
lapsed M—H sampler and softmax of a Gaussian). Simulated reads
for 11 426 human protein coding genes, accounting for a total of 90
75 9 distinct isoforms, were generated by Spanki v0.5.0 (Sturgill
et al., 2013) with coverage from RPK of 50 to 1600 for 8 time
points. We initially induced a temporal correlation between isoform
proportions at different time points by enforcing the assumption of
Gaussian process dynamics. All methods used paired—end reads,
with the exception of MISO, which provided better performance in
these experiments using single—end reads (see Supplementary Fig. S2
and Table S3). We focus here on comparing the accuracy of the vari—
ous methods; for a comparison of computational performance see
Supplementary Figure S1.

We first studied the accuracy of each method at different cover—
age levels. We report average accuracy by computing the mean abso—
lute error (MAE) between inferred isoform ratios and the truth from
all the 90 759 isoforms of the 11 426 genes and 8 time points.
Figure 2A shows that all methods return accurate estimates, and
that the errors generally decrease with the increase of coverages. As
expected, DICEseq is able to exploit effectively the temporal infor-
mation, providing a significantly lower mean absolute error than the
other methods, an advantage which is particularly marked at lower
coverage. In a real RNA—seq time series experiment, many genes are
likely to have relatively low coverage in at least one time point (see
Sections 3.3 and 3.4 for our real data experiments), therefore the im-
proved performance of DICEseq is likely to be important in quan-
tifying isoforms for a substantial fraction of genes.

A second, often very important, metric is the confidence intervals
associated with the predictions. These can be useful when deciding
e.g. which genes to include in downstream analyses as in (Barrass
et al., 2015). We examined the average size of the confidence inter-
vals for the three Bayesian methods DICEseq, MISO and Cufﬂinks
as we vary the simulated coverage levels. As expected, confidence
intervals shrink as we increase coverage for all three methods, how—
ever DICEseq clearly is able to provide more confident predictions
at all coverage levels (Fig. 2B). DICEseq is particularly strong at
lower coverage; this is important, as often the confidence of an esti—
mate is used to select genes which are further analyzed (Barrass
et al., 2015).

Third, we investigate the inﬂuence of isoform number on the
quality of the estimate at a specified coverage level. By selecting the
genes with a specific number of isoform, Figure 2C (RPK : 200) and
2D (RPK: 800) both show that the rank correlation (Spearman’s

9mg ‘09 1sn8nv uo sejeﬁuv s01 ‘121u10g11123 go [(1319111qu 112 /810's112u1no[pJogxosopeuuogutotq/ﬁd11q uIOJg pepsogumoq

Statistical modeling of isoform splicing dynamics

 

 

 

 

 

 

 

 

 

 

 

 

A D m GP dynamics: BEES iseioms an m GF' dynamics: WEE! isoforms
[\‘I
025- \
\
9.2EIIL‘ it,
C‘- 
s: 0.15; ""‘A a
m 3'": 
 o 10 ' 
 T"- 1 I. 
_ "O-___ _ I “a;
 _ a. MS . “‘1
I -- __ I
‘1
5o Loo zoo 4pc Boo moo so too zoo 4m: and 1am:
RPK RPK
C an: IGF dlynarlltics:IRPK-ZUIEI D Lee lep- dynamics-RPK-mp
I
crack  ' , I/O-nt.__1
“mtg: a ' . 0.55 fir“ -~. :__ a -
CI as a mi .1“! - - twat  ‘ o a,
a: --. __ n:  ' .._
m .. 'Q- in ""it:-- "-
1 — e.go— at. ‘—
3 o 15  - E
E  E 0.35 i
o to  '-.,'-:_~_
 oao 
0.55 ' .
4
ELFFI 4 I |. a. |. r a DJ: . J. a. L .. J I
2311-56.?89103-1'0£311nﬁfri'391ll‘J-ID

 

 

numbL-I Of IEDTQII’IIS numbcl 0r ISU‘IOII'I'IS-

[a : IsoEM H Cufflinks H MISC) H DICE-sepia l i DICEsqu

 

 

 

 

E on first-order dynamics: QDTSE! isoforms F M ﬁrst-orderdynamics: 90159 isoforms
0 2 I DICEseq I”. I DICEseq
'1 l DICE—sepa' ' ' - DICE-sepa—
D.'ICI - 9.5- -

ahoslute error
95% El

0.E|4

 

J L. ZziiJ J J:

RPK- 5D RPK-100 RPK-BUG RPK-5111' RPK-100 RPK-BUD

 

 

 

 

 

 

Fig. 2. Comparison of accuracy between methods using simulated reads.
(a) Mean absolute error between estimated isoform proportion and the truth.
(b) 95% confidence interval of the estimates. (c) Influence of the number of
isoforms on the estimates when RPK: 200. (d) Influence of the number of iso-
forms on the estimates when RPK=800. The simulation is based on GP dy-
namics assumption for (a—d). (e) Boxplot of absolute error between estimated
isoform proportion and the truth. (f) Boxplot of 95% confidence interval of the
estimates. The round dot is the mean. The simulation is based on first-order
dynamics assumption for (e, f)

correlation) coefficient between the estimated isoform proportions
and the truth generally decreases as the number of isoform increases.
This is expected, because the presence of more isoforms reduces the
number of uniquely assignable reads. Once again, we see that
including temporal information can yield signficantly improved esti—
mates, with DICEseq yielding an improvement in rank correlation
of more than five percentage points for genes with many isoforms
(>8).

Finally, we investigate the robustness of DICEseq to model mis—
match. To do so, we generated time series data where the isoform
proportions vary according to a first—order dynamical system (rather
than a Gaussian process), a commonly used modelling hypothesis
(Eser et al., 2016). Figure 2E, F clearly shows that incorporating
temporal information yields a considerable improvement, even
under model mismatch. This improvement is particularly marked at
low coverages. Notice that the mean accuracy (represented by a dot
in the box plots) is very similar to the one obtained under the GP as—
sumption (Fig. 2A). Additional simulations varying hyperparameters
were also performed (see Supplementary file), and Supplementary
Table S1 again shows robustness to mis—specification of the
hyperparameters.

In summary, the results of these simulation studies show that
DICEseq can provide accurate reconstruction of isoform propor—
tions, and can successfully leverage temporal information to provide
more accurate and confident predictions at low coverage and for
higher numbers of isoforms.

 

 

 

 

 

 

 

 

 

 

 

A ELM I jolnt #5 separate B 02‘ joint vs separate
1.
n as EIJEI x.
It, 
‘.__ -. I:
o 04 e 15 T‘s-H
IE I - I \"‘~. -.. I:
q -.  L-
E l-.._ "'o.'.'
no: me ark 1 C
“t- —- '  l
_‘  _-
ooz- ops. '1-—— 'f-‘l
'1
am - - - - 11"“ - - -
50 1M 200 4130 EDI] 1601) SI] lDCI 200 400 Him 16:00
am: RPK
[0 l j:dpaint5 II 0 j:8point5 I It 1:13nei51I I I 5:8 points II -- 5:3 noisy
C experiment examples D experiment examples
'3-12 I DiCEseq - 9-5- I DICEseq
DICE-SE a DICE-5|! a
Ellﬂ I p 0.5.- . p
E one 9.4-
1' 5
EU
5 o as _ g :13
m m
3
I1: 1104. . .. . n.2— -
I ' '
no: . 01-4 l J" a
one 011- .

 

 

 

 

 

 

T=4 [RPK=2GIDII T=B IFlF‘IC=1CHJI I=E [I‘IIIIISYF T=1'I- [R PK: 20m T=ﬂ |FIPK=1DDI 'I'=E tnuisyl

Fig. 3. Comparison between experiment design on time points and cover-
ages. (a) Mean absolute error between estimated isoform proportion and the
truth for different experiments. ‘8' and ‘J' means DICEseq separate and joint
mode, respectively, and the ‘noisy' means the RPK: 25 at the 5th point for all
(a-d). All simulation here is based on GP dynamics assumption. (b) 95% con-
fidence interval of the estimates. (c) Boxplot of absolute error between esti-
mated isoform proportion and the truth for three example experiments. The
round dot is the mean. ‘T=4' and ‘T=8’ means the 4 and 8 number of time
points. The ‘noisy' example was also conducted at RPK: 100. (d) Boxplot of
95% confidence interval of the estimates

3.2 Design of time—series RNA—seq experiments
Incorporating temporal information in the analysis of time series ex—
periments is desirable in principle, because it provides experimental—
ists with a further direction for experimental design. Intuitively,
resources can be invested in either improving the accuracy of each
time point (by sequencing deeper), or by collecting more time points.
This is an important trade—off, and it can only be achieved if the
data is analyzed jointly. To address these questions, we compared
DICEseq versus DICE—sepa as we vary coverage levels and number
of time points, by simulating reads as in the previous section (under
GP assumption). In Figure 3A, we clearly see again that with the
coverage increasing, all MAE decrease. In the joint model, the MAE
largely decreases when more time points (i.e. 8) are used, especially
for the case with low coverage.

These results highlight the importance of the analysis method for
experimental design: while with the non—temporal model DICE—sepa
increasing coverage is the only way to improve accuracy, methods
that incorporate temporal information can benefit both from an in-
crease in coverage and an increase in sampling frequency. Broadly
speaking, we see that a doubling of the sampling frequency is
roughly equivalent to a doubling of the sequencing depth, with the
obvious advantage that a finer temporal information is provided.
Figure 3C and D shows an example of this trade—off: 4 time points
and higher coverage of RPK : 200 give indistinguishable results for
the joint model to 8 time points and lower coverage of RPK : 100
(first two pairs in Fig. 3C/D).

Another potential advantage of incorporating temporal informa-
tion is to improve robustness of the estimation against noise/low
coverage at some time points. This aspect is particularly important
as of course coverage level for a particular gene is largely determined
by the gene’s expression level, therefore genes with a large dynamic
range of expressions during the time series will necessarily have
some time points with low coverage. To simulate this situation, we
generated time series with very low coverage (RPK=25, termed

9mg ‘09 1sn8nv uo sejeﬁuv s01 ‘121u10g11123 go [(1319111qu 112 /810'sp2u1no[pJogxosQueumogutotq/ﬁd11q uIOJg pep1201umoq

Y.Huang and G.Sanguinetti

 

‘noisy’) in the 5th time point. From the ‘noisy’ case in Figure 3, we
could see that the joint model dramatically reduces the variation
compared to the separated model. Thus, incorporating time infor-
mation in the joint model leads to a more robust estimation, facili—
tating isoform estimation for genes with dynamic expression levels
and providing a possibility to combine low coverage with high

coverage time points for time series libraries.

3.3 RNA splicing dynamics with 4tU—seq data

Recently, biotin labelling combined with RNA—seq has become an
important tool to study the kinetics of RNA transcription and splic—
ing with high temporal resolution (Fuchs et al., 2014; Veloso et al.,
2014; Windhager et al., 2012). These experiments naturally produce
RNA—seq datasets with high temporal resolution; furthermore, at
very early time points, labelled RNA may be of low abundance, re—
sulting in high uncertainty estimates. Here we use a recent dataset
with high temporal resolution to probe the suitability of DICEseq as
an analysis tool for biotin labelled RNA—seq; the data was produced
by our collaborators in the Beggs and Granneman labs at the
Wellcome Trust Centre for Cell Biology in Edinburgh (Barrass et al.,
2015). The dataset consists of approximately 50M mapped reads;
roughly 5 0% of genes have a coverage of RPK < 120 in at least one
time point.

To assess accuracy of our method, we compare the correlation
between two replicates for 309 intron—containing genes at 1.5, 2.5
and 5 .0 min. Figure 4A shows that IsoEM, Cufﬂinks and MISO all
result in a good correlation between replicates, with Pearson’s cor—
relation coefficient varying between 0.83 and 0.85 ; DICEseq further
improves with a Pearson’s correlation coefficient of 0.896, outper—
forming by between 4 and 6 percentage points existing methods (all
P-values <1e—5 under the Fisher r-to—z transform test (Diedenhofen
and Musch, 2015)). The improvement is particularly marked if we
consider the lowest expressed genes (see Table 1): on the lower third
of the expression range, DICEseq still obtains a Pearson correlation
of 0.860, while the other methods achieve much lower correlations,
ranging from 0.657 (Cufﬂinks) to 0.775 (IsoEM). This is remarkable

 

 

 

 

 

 

A IEOEM: R=ﬂ.351 CUfﬂII‘IkS: R=U.33D
Lou—I ' I'  . . 11:: .' L “.1... .' ' _- '—
00-  '- I' " :Li'ﬂ' 0.0 :' ‘ ‘ 1‘    .
N '.  : ' ..
3 05-  -- 0.0
a I'," ~ : . .
9304-; " 0.4 : I. 
13.2- I -II- :5: l. 02‘ IF I
0.0—ﬂ I .  I I”   IIHIII” I I_
0.0 0.2 0.4 0.5 0.0 1.0 0.0 0.2 0.4 0.0 0.0 1.0
MISC}: R=UL343 DICEEEE‘I: F1=Uﬁgﬁ

10. m - I. _
I‘.‘ "I w '1’ - r n I ’{g
0.0— - _  i- 2‘" ~- I 0.0 . I._.. " I. - _ _

 

 

 

 

 

 

N
u 05 n. 0.0 I.
a ' -' -
g t '. .I I., I
304— I“ '1_ 0.4 II- 
- I _ I _ ..
02-  .-_.,:- ,_  - . 0.2 R; u . .
_ f_ . . . I . I
0.0- I 0.0 ‘ I I I
0.0 0.2 0.4 0.0 0.0 10 00 02 04 00 0.0 1.0
repllcate I repln: are 1
B Cufflinks M ISO DICEseq
1.5 min 2.5 min 1.5 min 2.5 min 1.5 min 2.5 min

1. 1 10 3 an- I,
a Jl- 4

5.0.1 mln 5.0 min 5.0 mln

 

Fig. 4. Analysis of time series 4tU-seq data. (a) The Pearson's correlation be-
tween two replicates. (b) The number of genes whose 95% confidence
interval < 0.3

since, as there are only three time points, the improvement obtained
by taking temporal information into account could be expected to
be limited. Notice in particular that, while IsoEM and particularly
Cufﬂinks sometimes give deterministic estimates in one replicate but
not on the other (red points on the boundaries of the square in
Fig. 4A), this problem does not occur with DICEseq, presumably
due to the stronger regularization enforced by the temporal
correlations.

To further explore the usefulness of DICEseq, we consider the
confidence intervals reported by the various methods. Isoform quan—
tification methods are often used as an initial step in kinetic analyses
of individual transcripts; in order to reduce false positives, genes
with unreliable isoform estimates (as determined by thresholding on
the confidence intervals) are discarded. When quantifying isoforms
in isolation, some genes are then discarded just because one of the
time points have lower expression level. Therefore, we computed
the number of transcripts that pass a frequently used threshold
(95% CI < 0.3) for further analysis (Barrass et al., 2015). Figure 4B
illustrates the results, showing that at all time points around 20%
more genes are retained using a joint analysis, compared to methods
that analyze data points in isolation.

To summarize, our results on a real yeast kinetic dataset confirm
that DICEseq yields significantly more reproducible and confident
results than existing state—of—the—art methods, highlighting the value
of incorporating temporal information in the analysis of time series

real data.

3.4 Circadian dynamics of alternative splicing

As a second real—data example, we turned to a recent dataset investi—
gating circadian control of gene expression in mouse. Due to the
day—night oscillations, many biological processes, including gene ex—
pression, show circadian rhythms. Recently, Zhang et al. (2014) sys—
tematically studied circadian gene expression on 12 mouse tissues
using high-temporal resolution microarrays and RNA—seq, and
found that 43% protein coding genes oscillate in at least on one of
the 12 tissues; here we focus on data from liver. The RNA—seq here
has a comparably low time resolution, as eight time points were col—
lected over a period of 48 h; we expect therefore that the advantages
of incorporating time information may be less pronounced in this
scenario. In total, there are between 67M and 105M uniquely
mapped reads in each experiment; on average of 8 time points, 5 0%
of genes have all isoforms with RPK<70; 75% of genes have all
isoform with RPK <400.

To assess the performance of the various methods, we used the
microarray dataset to validate the isoform estimates from RNA—seq.
Unfortunately, only about one hundred microarray probes map to a
unique annotated isoform (out of 30 5 34 annotated isoforms which

Table 1. Robust performance of DICEseq in lower or medium
coverage

 

IsoEM Cufﬂinks MISO DICEseq

 

4tU—seq, all 0.851 0.830 0.848 0.896
4tU—seq, 1/3 low 0.775 0.657 0.757 0.860
circadian, all 0.712 0.700 0.757 0.791
circadian, 1/3 mid 0.336 0.296 0.408 0.513

 

‘All’ means all annotated genes; ‘1/3 low’ and ‘1/3 mid’, respectively, mean
lowest and medium 1/3 genes in coverage. The scores are Pearson’s correl-
ation coefﬁcients between two replicates (4tU-seq) or two techniques
(circadian).

9mg ‘09 1sn8nv uo sejeﬁuv s01 ‘121u10g11123 go [(1319111qu 112 /810's112u1noIpJogxosopeuuogutotq/ﬁd11q uIOJg pep1201umoq

Statistical modeling of isoform splicing dynamics

 

:5.
rl

 

 

lac-EM: R=U.?12 Currants: 5:11.100

M 4.1 Lu h.
U1 I: m Ci
w .44

In I:

'I

micro-array. leg 1 III

Iu
CI
r

   

 

 

:3 -2 -'I [I 1 2 3 4 -3 -2 -1 U 1 2 3 4

 

 

   

 

 

 

 

 

 

II I MISD: H-UJsr II 5 DICEseq: Fla-0.?91
40 "v." 40
c. -*. - -
EII as I 35 
:2 3.0 i : 3.0 :-
e - . .
g 2.5 - :1 2.5 ‘I
I 4 i 1.1"
 2.0 : 2.0 -
15 1.5 "
lI'I. I I I I  I I I I I I
—3 —2 —1 0 1 z 3 4 —3 —2 —1 0 1 2 3 4
arm-sen. Ingretrrmi RNA-sea. luulﬂiFPKMI
B Cufflinlcs MISC: DICEseq

 

Fig. 5. Analysis of circadian time series data. (a) The Pearson's correlation be-
tween the measurement of RNA-seq and microarray. (b) The proportion of
genes whose 95% confidence interval <0.3 in a certain number of time points
(index on the external side of the circle)

map to at least one microarray probe); in other words, most micro—
array probes map to multiple isoforms within a gene. Thus, we used
the estimated isoform proportions, together with the total numbers
of reads mapped to each gene, to quantify the gene expression level
(as FPKM), and then compared the resulting estimate from RNA-
seq with the microarray measurement with Pearson’s correlation co—
efficient. In Figure 5A, we see that the estimates obtained from
RNA—seq using all methods have a high correlation with the direct
measurements from the microarrays. Still, DICEseq shows a signifi-
cantly improved correlation from 0.757 to 0.791 (P—value<1e—5,
Fisher r-to-z transform test); in particular, very low expressed iso—
forms (outliers in the left end of the plot) show a much better quanti—
fication with DICEseq than with the other methods, probably due to
the sharing of the temporal information, which is also evidenced by
the medium third genes in Table 1.

We further measured 95 % confidence intervals (CI) of all the 55
440 isoforms at the 8 time points, and quantified the fraction of iso—
form quantifications that pass the threshold 95 % CI < 0.3. In
Figure 5B we see that all Bayesian methods (Cufflinks, MISO and
DICEseq) give confident estimates for between 50 and 60% of iso—
forms at all time points. Once again, DICEseq estimates are more con—
fident, thanks to the value of temporal information sharing at low
coverages, even though the advantage is more modest in this dataset.

To summarize, our results in this low—frequency RNA—seq time
series dataset show that even in this case DICEseq produces quanti—
tatively better estimates of isoform ratios, even though the value of
sharing temporal information is more limited here due to the weaker
correlations between time points.

4 Discussion

The advent of RNA—seq technologies has revolutionized the study of
mRNA splicing, and provided a powerful stimulus for the develop—
ment of computational biology methods (Glaus et al., 2012; Katz
et al., 2010; Nicolae et al., 2011; Trapnell et al., 2010). Recent years

have seen a more wide—spread use of RNA—seq technology for the
analysis of dynamical biological processes, resulting in a marked in-
crease of biological studies adopting RNA—seq within a time series
experimental design. In this article, we presented DICEseq, the first
method to jointly estimate the dynamics of the splicing isoform pro-
portions from time series RNA—seq data. A comparison of DICEseq
to a selection of popular state—of—the—art methods shows that
DICEseq has excellent accuracy and good computational perform—
ance; in particular, DICEseq can effectively pool information across
time points to improve isoform quantification at low coverages, giv—
ing more accurate and confident predictions. Our analysis also
points to the importance of coverage versus temporal sampling
trade—offs in designing dynamic RNA—seq experiments; while our
analysis focussed on time series experiments, we expect similar con—
siderations to hold for other structured designs, such as dose re—
sponse experiments. In this light, the use of methods which can
capture structural information, such as DICEseq, may lead to a re—
think of biological experimental designs for a broad class of experi—
ments. Our application to two diverse biological datasets shows that
DICEseq can be an effective tool on real biological investigations,
leading to improved performance and more reproducible results.

Methodologically, DICEseq builds on a fertile line of research
using GPs to model transcriptional dynamics. GPs have been used to
study the dynamical behaviour of gene expression in various con—
texts, from transcriptional regulation (Lawrence et al., 2006) to
identifying the time intervals of differential expression with time ser—
ies microarray data (Stegle et al., 2010). More recently, Aijo et al
used a latent GP with negative binomial observation noise to study
the profiles of gene expression during Th17 cell differentiation with
time course RNA—seq (Aijo et al., 2014). To our knowledge, this is
the first time GPs have been proposed within the context of isoform
estimation.

While we believe DICEseq offers a valuable new tool for the ana—
lysis of dynamic RNA—seq data, it also opens several novel lines of
investigation. First, the Gaussian process prior, which is based on a
general regression, could be extended to more general dynamic splic—
ing modeling, e.g. a first-order linear dynamic system for RNA splic—
ing kinetics, and an oscillatory system for circadian or cell—cycle
studies. All of these could be incorporated in a straightforward way
as parametric mean functions in a GP framework, however it would
also be of interest to explicitly model the noise correlations they in-
duce. DICEseq could be useful in elucidating RNA processing from
biotin labelled RNA—seq, as attempted e.g. in de Pretis et al (de
Pretis et al., 2015 ). More generally, DICEseq could provide a flex—
ible Bayesian framework for explaining RNA—seq data from other
observations, and aid studies attempting to link splicing with other
genetic and epigenetic factors.

Acknowledgements

We would like to thank Prof. Jean D Beggs, Dr. Sander Granneman, Dr. Jane
E A Reid, Dr. J David Barrass, Dr. Edward Wallace and Dr. Yichuan Zhang
for fruitful discussions. G.S. acknowledges support from the European
Research Council under grant MLCS306999. Y.H. is supported by the
University of Edinburgh through a Principal Career Development scholarship.

Conﬂict of Interest: none declared.

References

Aijo,T. et al. (2014) Methods for time series analysis of RNA-seq data with ap-
plication to human Th17 cell differentiation. Bioinformatics, 30, i1 13—i120.

9mg ‘09 1sn8nv uo sejeﬁuv s01 ‘eguioggjeg go [(1319111qu 112 /810's112u1noIpJogxosoneuuogutoIq/ﬁd11q uIOJg pep1201umoq

Y.Huang and G.Sanguinetti

 

Bar-Joseph,Z. et al. (2012) Studying and modelling dynamic biological proc-
esses using time-series gene expression data. Nat. Rev. Genet., 13, 5 52—5 64.

Barrass,].D. et al. (2015) Transcriptome-wide RNA processing kinetics re-
vealed using extremely short 4tU labeling. Genome Biol., 16, 17.

Blencowe,B.J. (2006) Alternative splicing: new insights from global analyses.
Cell, 126, 37—47.

de Pretis,S. et al. (2015) INSPECT: a Computational Tool to Infer mRNA
Synthesis, Processing and Degradation Dynamics from RNA-and 4sU-seq
Time Course Experiments. Bioinformatics, 31, 2829—2935

Diedenhofen,B. and Musch,]. (2015 ) Cocor: a comprehensive solution for the
statistical comparison of correlations. PloS One, 10, e0121945.

Eser,P. et al. (2016) Determinants of RNA metabolism in the
Schizosaccharomyces pomhe genome. Mol. Syst. Biol., 12, 857.

Fuchs,G. et al. (2014) 4sUDRB-seq: measuring genomewide transcriptional
elongation rates and initiation frequencies within cells. Genome Biol., 15,
R69.

Geweke,]. (1991) Evaluating the Accuracy of sampling—Based Approaches to
the Calculation of Posterior Moments, vol. 196. Federal Reserve Bank of
Minneapolis, Research Department Minneapolis, MN, USA.

Glaus,P. et al. (2012) Identifying differentially expressed transcripts
from RNA-seq data with biological variation. Bioinformatics, 28,
1721—1728.

Graveley,B.R. (2001) Alternative splicing: increasing diversity in the prote-
omic world. Trends Genet., 17, 100—107.

Honkela,A. et al. (2015) Genome-wide modeling of transcription kinetics re-
veals patterns of RNA production delays. Proc. Natl. Acad. Sci. U. S. A.,
112, 13115—13120.

Kanitz,A. et al. (2015 ) Comparative assessment of methods for the computa-
tional inference of transcript isoform abundance from RNA-seq data.
Genome Biol., 16, 1—26.

Katz,Y. et al. (2010) Analysis and design of RNA sequencing experiments for
identifying isoform regulation. Nat. Methods, 7, 1009—1015.

Kim,D. et al. (2015 ) HISAT: a fast spliced aligner with low memory require-
ments. Nat. Methods, 12, 357—360.

Lawrence,N.D. et al. (2006 ). Modelling transcriptional regulation using
Gaussian processes. In: Advances in Neural Information Processing
Systems, pp. 785—792.

Nicolae,M. et al. (2011) Estimation of alternative splicing isoform frequencies
from RNA-Seq data. Algorithms Mol. Biol., 6, 9.

Rasmussen,C.E. and Williams,C.K.I. (2006). Gaussian Processes for Machine
Learning. MIT Press, Cambridge, MA, USA.

Roberts,A. et al. (2011) Improving RNA-Seq expression estimates by correct-
ing for fragment bias. Genome Biol., 12, R22.

Scotti,M.M. and Swanson,M.S. (2016) RNA mis-splicing in disease. Nat. Rev.
Genet., 17, 19—32.

Stegle,O. et al. (2010) A robust Bayesian two-sample test for detecting inter-
vals of differential gene expression in microarray time series. ]. Comput.
Biol., 17, 355—367.

Sturgill,D. et al. (2013) Design of RNA splicing analysis null models for post
hoc ﬁltering of Drosophila head RNA-Seq data with the splicing analysis kit
(Spanki). BMC Bioinformatics, 14, 320.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti-
ation. Nat. Biotechnol., 28, 511—515.

Tuomela,S. et al. (2012) Identiﬁcation of early gene expression changes during
human Th17 cell differentiation. Blood, 119, e151—e160.

Veloso,A. et al. (2014) Rate of elongation by RNA polymerase II is associated with
speciﬁc gene features and epigenetic modiﬁcations. Genome Res., 24, 896—905.

Wang,E.T. et al. (2008) Alternative isoform regulation in human tissue tran-
scriptomes. Nature, 456, 470—476.

Wang,Z. et al. (2009) RNA-Seq: a revolutionary tool for transcriptomics. Nat.
Rev. Genet., 10, 57—63.

Windhager,L. et al. (2012) Ultrashort and progressive 4sU-tagging reveals key
characteristics of RNA processing at nucleotide resolution. Genome Res.,
22, 203 1—2042.

Zhang,R. et al. (2014) A circadian gene expression atlas in mammals: implica-
tions for biology and medicine. Proc. Natl. Acad. Sci. U. S. A., 111,
16219—16224.

91% ‘09 1sn8nv uo sejeﬁuv s01 ‘eguioggjeg go [(1319111qu 112 /810's112u1noIpJogxosopeuuogutoIq/ﬁd11q uIOJg pep1201umoq

