ORIGINAL PAPER

Vol. 28 no. 4 2012, pages 523—530
doi: 10. 1093/bioinformatics/btr715

 

Structural bioinformatics

Advance Access publication December 30, 2011

Approximating the set of local minima in partial RNA

folding landscapes
S. Sahoo and AA Albrecht*

Centre for Cancer Research and Cell Biology, Queen’s University Belfast, Belfast BT9 7BL, UK

Associate Editor: Anna Tramontano

 

ABSTRACT

Motivation: We study a stochastic method for approximating the
set of local minima in partial RNA folding landscapes associated
with a bounded-distance neighbourhood of folding conformations.
The conformations are limited to RNA secondary structures
without pseudoknots. The method aims at exploring partial energy
landscapes pL induced by folding simulations and their underlying
neighbourhood relations. It combines an approximation of the
number of local optima devised by Garnier and Kallel (2002) with
a run-time estimation for identifying sets of local optima established
by Reeves and Eremeev (2004).

Results: The method is tested on nine sequences of length between
50nt and 400nt, which allows us to compare the results with data
generated by RNAsubopt and subsequent barrier tree calculations.
On the nine sequences, the method captures on average 92% of
local minima with settings designed for a target of 95%. The run-
time of the heuristic can be estimated by 0(n2Dvlnv), where n is
the sequence length, 1) is the number of local minima in the partial
landscape pL under consideration and D is the maximum number of
steepest descent steps in attraction basins associated with pL.
Contact: a.albrecht@qub.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 11, 2011; revised on November 17, 2011; accepted
on December 23, 2011

1 INTRODUCTION

The method presented in the article targets sampling algorithms
designed for RNA secondary structure prediction and pathway
analysis that employs in one way or another features of the
underlying free energy landscape. For this type of algorithms,
knowledge of metastable states (local minima) in the Vicinity of
intermediate conformations can be of advantage in speeding up
the folding simulation. Here, the term sampling algorithm covers
any type of random walks, Markov processes and kinetic or
co-transcriptional folding simulations applied to RNA secondary
structure prediction. Simulations of kinetic folding based upon the
master equation dpu (t) / dt = 231:1 (kvupv(t) — kuvpu (t)) are feasible
only for short sequences due to the large number m of folding
conformations (Chen, 2008), even when executed on parallel
computing systems (pu (t) is the probability that the folding process
is in conformational state u at time t and the km, are the transition
rates from state u to state v). A standard setting for values km, is

 

*To whom correspondence should be addressed.

given by km, =exp(—(Gv — Gu)/RT) for G, > G” and km, :1 for
G, 5 G“, where Gw is the free energy of conformation w. The results
from numerical simulations of short sequences provide valuable
information about transition rates at different folding stages and the
stability of helices, hairpins, various types of loops and pseudoknots.
The data can then be incorporated into coarse-grain models of
folding.

In an attempt of reducing the ensemble of conformations, Zhao
et al. (2010) combine the master equation and the analysis of
free-energy landscapes where kinetic moves are based on the
addition and deletion of entire helix stems. The method further
develops the analysis of kinetic moves based upon the exchange of
entire helices as presented by Xayaphoummine et al. (2003, 2005).
Xayaphoummine et al. (2003) pay particular attention to structures
with pseudoknots and how to overcome the problem of kinetic traps
consisting of rapidly exchanging states. Zhao et al. (2010), instead
of completely unwinding two overlapping helices, devise a strategy
(arm-by-arm exchange) that requires only a partial melting of the
initial helix during the transition to the new metastable state. Prior
knowledge of metastable states (local minima) in the Vicinity of the
current structure could be helpful in executing such transitions and
in identifying pathways between such states. The exchange of entire
helices is also the basic neighbourhood move analysed by Danilova
et al. (2006). For structure prediction with pseudoknots, Bellaousov
and Mathews (2010) recently devised a fast algorithm that runs in
0(n2) time and utilizes base pairing probabilities instead of changes
in free energy values.

Lorenz and Clote (2011) comprehensively study the computation
of the partition function over the set of local minima in energy
landscapes induced by addition and deletion of single base pairs.
The authors devise an algorithm that runs in 0(n3) time and
requires 0(n2) space. The underlying energy model is the Turner
nearest neighbour model (Xia et al., 1998) without dangles, and
the algorithm is an extension of McCaskill’s algorithm (McCaskill,
1990) that accounts for locally optimal structures by additional terms
in the recursion scheme. Based upon computational experiments
over randomly generated RNA sequences, the number of locally
optimal structures is estimated to be roughly the square root of the
total number of feasible structure of a given length.

A new method for approximating the partition function over all
secondary structures has been recently presented by Lou and Clote
(2010). The method employs the Wang—Landau algorithm (Wang
and Landau, 2010a, b) for approximations of the density of energy
states and is less restrictive in regard to local interactions than
dynamic programming applied to secondary structure prediction.

An overview of methods for simulations of kinetic folding is given
by Flamm and Hofacker (2008) and is also part of the detailed

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 523

112 [3.10'811211an[p.IOJXO'SODBIIIJOJIIlOTCI/[I(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV uo ::

S.Sahoo and A.A.Albrecht

 

summary on progress in RNA secondary structure prediction by
Schuster (2006). A variety of methods has been proposed for
simulations of kinetic folding based upon the addition, deletion and
shift of single base pairs. Flamm et al. (2000) introduced the shift
move, which is a combination of a base pair removal and a base
pair addition where one position remains invariant. The shift move
aims at the simulation of ‘defect diffusion’ reported by Porschke
(1974), which denotes a process where, for instance, the position
of a bulge in a helix may move along a helix as the result of
rapid base pair formation and dissociation. The transition rates kin,
between neighbouring conformations are calculated according to the
symmetric rule kin, =exp(—(Gv — Gu)/2RT

Geis et al. (2008) present details of the Kinwalker tool
along with simulation results on 12 RNA sequences with a
length ranging from 115nt t0 1492nt. The underlying method
generates secondary structures by combining building blocks
that correspond to thermodynamically optimal substructures.
The optimal substructures are calculated by standard dynamic
programming. An important step in the execution of Kinwalker
is to identify the energy barrier between two locally optimal
conformations. The tool utilizes a modiﬁcation of the Morgan—Hig gs
heuristic (Morgan and Higgs, 1998), which is designed to ﬁnd a
direct folding pathway of minimum height between two secondary
structures. Most of the total run-time of Kinwalker is spent on
this particular task. The authors report a good agreement of folding
simulations with experimentally veriﬁed folding pathways, and the
same applies to calculated folding times and corresponding values
predicted in the literature.

Hofacker et al. (2010) propose a new framework for the analysis
of time-variable landscapes. The underlying idea is to model the
impact of external triggers (ligand binding, nucleolytic cleavage,
RNA elongation) and environmental changes (temperature) at
folding dynamics as small but discrete changes in energy landscapes.
The authors associate macrostates with attraction basins of local
minima in energy landscapes, see also Wolﬁnger et al. (2004).
For any two local minima, a ‘transition state energy’ is deﬁned
that equals the energy level at which their associated macrostates
(attraction basins) merge in the barrier tree of the landscape
induced by individual conformations (microstates). The transition
rate between macrostates is then determined similar to the above-
mentioned kW, where the energy values involved are the transition
state energy (which is the saddle height between u and v) and
the free energy of the locally optimal structure v. The time-
Variable landscapes are represented by sequences of barrier trees and
associated sets of macrostates. The transitions (changes) between
successive barrier trees and sets of macrostates are calculated by
solving a master equation for population densities of macrostates.
The master equation is determined by the aforementioned transition
rates between macrostates. Since the transition rates between
macrostates are time independent for a given barrier tree,
the complexity of solving the master equation is signiﬁcantly
reduced within this speciﬁc framework. Applications to an RNA
thermometer, to co-transcriptional folding and a speciﬁc type of
refolding are brieﬂy discussed. The concept of macrostates in the
context of RNA folding is also studied in a recent paper by Mann
and Klemm (2011) where new sampling techniques for macrostates
are proposed.

Tang et al. (2005, 2008) utilize methods from motion planning
developed for robotics for computing folding pathways. The

conformational space is approximated by a graph (roadmap) that
connects conformations according to a distance metric deﬁned by the
difference in base pairs. The analysis of the roadmap and subsequent
computation of folding pathways invokes the master equation.

Dotu et al. (2010) present a tabu search algorithm for ﬁnding
folding pathways of minimum height between two secondary
structures. The algorithm employs a weighted ﬁtness function that
tries to balance between low free energy and the distance to the
target structure. At each step, a base pair that minimizes the ﬁtness
function in the 1-distance neighbourhood is added or removed,
and this base pair is kept in a tabu list for a certain number of
steps. The weight attached to the distance measure is decreased,
if the current step leads to a decrease in the distance to the target
structure. The distance weight is increased, if the distance to the
target has not been improved for a number of iterations, and with the
increased weight the procedure is restarted from the structure found
so far to be closest to the target. The evaluation on 18 structures
(riboswitches) demonstrates the competitiveness of the approach in
ﬁnding near—optimum pathways.

We study a procedure for approximating sets of locally optimal
structures that can be integrated into simulations of kinetic folding
or computations of folding pathways between secondary structures.
A major motivation is the analysis of metastable RNA secondary
structures in the context of microRNA target predictions. Recent
prediction tools incorporate information about the strength of
secondary structures and subsequent duplex bindings, see Ragan
et al. (2011) and the literature therein. The likelihood of bindings
is usually related to minimum free energy secondary structures.
Knowledge about metastable states (local minima) could provide
a more comprehensive analysis of potential duplex bindings,
in particular, if co-transcriptional folding and the differences in
concentrations of mRNA and microRNA are taken into account
(Ragan et al., 2011).

Our procedure is designed for the analysis of partial landscapes
pL that cover only a small subset of the entire conformation space.
Such pL can be deﬁned, for example, by neighbourhood relations
where the number of neighbourhood transitions (addition or deletion
of base pairs) is bounded by a constant. The proposed method
consists of two major steps: ﬁrst, the number 1) of locally optimal
structures within pL is approximated by using a stochastic procedure
devised by Garnier and Kallel (2002). Secondly, the value of vappr
is taken as an input into an approximation formula established
by Reeves and Eremeev (2004) for the number W(pL, vappr) of
repeated runs of steepest descent within pL out of randomly
selected conformations, where W(pL, vappr) ensures with a certain
high probability that all locally optimal structures are covered.
The procedure is tested on sequences of length up to 400nt by
using data generated by RNAsubopt (Wuchty et al., 1999) and
barriers implementations (Gruber et al., 2008) taken from the
Vienna package (Hofacker, 2003).

2 APPROACH

We consider combinatorial landscapes L=[C,N, f] deﬁned by
the set of conformations C, the neighbourhood relation N and
the ﬁtness function f: C—> R. The conformation space C is
attached to an individual RNA sequence (usually identiﬁed by an
accession number) and consists of secondary structures produced
by RNAsubopt with standard settings, i.e. no isolated base

 

524

112 [3.10'$11211an[p.IOJXO'SODBIIIJOJIIlOTCI/[I(11111 IIIOJJ popcolumoq

910K ‘09 lsnﬁnV uo ::

Approximation of local minima in partial RNA folding landscapes

 

pairs and at least three nucleotides in loops. The neighbourhood
relation N is deﬁned by three operations for single-step transitions
S —> S I 6 N5:

(i) Addition of one or two base pairs: a single base pair is added,
if an existing helix is extended; two base pairs are added, if
an unpaired position admits such and extension and does not
lead to an extension of a helix by two base pairs; the addition
must ensure that the condition for the minimum loop size is
not violated.

(ii) Deletion of one or two base pairs: a single base pair is deleted
as part of a helix, if at least two adjoined base pairs remain;
otherwise, two base pairs are deleted.

(iii) Shift of base pair: for positions u < v < w, an existing base pair
[u, v] is substituted by [u, w], if the resulting structure belongs

to C.

The neighbourhood N 5 covers all conformations that can be
generated by a single application of Op-I, Op—II or Op—III from S.
We note that by deﬁnition the secondary structure S itself belongs to
N S. For a graphical presentation of the three operations, we refer the
reader to Flamm et al. (2000), Fig. 2(A—E) and Fig. 3 on p. 327/328.
Finally, the ﬁtness function f : C—> R is deﬁned as the free energy
E :C—>R calculated by the program RNAeval (Hofacker et al.,
1994).

Within a given L, the distance d(S,S’) between two secondary
structures (conformations) S and S’ is deﬁned by the Hamming—
distance, i.e. if #(bp-S ﬂbp-S’) is the number of base pairs common
to S and S’, then d(S,S’)=#(bp—S)+#(bp—S’)—2#(bp—Sﬂbp—S’).
The method proposed in the present paper aims at small subsets
of C, or partial landscapes pL, deﬁned by an intermediate S EC and
all S’ EC with d (S , S’ ) 5 k that are generated from S by subsequent
executions of single-step transitions without Violating the distance
bound, where k is a constant such that the number of conformations
in this Vicinity of S is of ‘manageable’ size.

A simple but key procedure in our approach is the steepest descent
algorithm. For S EC, the following steps are executed within L:

(i) Initialize S0 =S;
(ii) For u 3 0, set Su+1 =argminS€Nsuf(S);

(iii) If E (Su+1) < E (Su), then u :2 u+1 and return to (ii), otherwise
terminate.

We follow Garnier and Kallel (2002) and Reeves and Eremeev
(2004) by assuming that only a single S = Su+1 from N5“ minimizes
the ﬁtness function f (S)=E (S). In general, there is no guarantee
that this holds for energy landscapes induced by RNA secondary
structures.

If the partial function f : N S—>R always produces a single
minimum, then the steepest descent procedure is deterministic and
leads to a partition of L into attraction basins Au of local/global
minima, u: 1, ...,v, where Au ﬂszﬂ, U;:1Au=L, and v is the
total number of local minima, including the global minima. The
steepest descent procedure terminates at the local minimum that
deﬁnes the attractions basin, i.e. in terms of C, Au consists of
all S for which (ii) and (iii) terminate at the local minimum
mu, u: 1, ...,v.

2.1 Garnier—Kallel method

We brieﬂy describe the approach devised by Garnier and Kallel for
the problem setting called ‘inverse problem’ (Garnier and Kallel,
2002). Let or” :2 |Au| / |C| denote the normalized size of attraction
basin Au. Garnier and Kallel (2002) assume a parameterized random
distribution of the normalized sizes z :05” of attraction basins with
the density function py deﬁned by

yr zr-l
1‘00 el’z ’

 

Py(Z) = (1)
where y>0 and F(s):= fooo e‘t ts_1dt is the Euler function. The
density function py, i.e. the parameter y, is approximated by a
sampling method over attraction basins.

Let M :={S1,S2, ...,SM}CC denote a set of randomly selected
secondary structures. For each of the S”, the steepest descent
procedure is executed, which leads to S“ —> mv, if S” belongs to the
attraction basin Av spawned by mv. By SD(mv) = M ﬂAv we denote
the set of conformations from M where steepest descent terminates
at mv, v = 1, ..., v. The set M together with steepest descent identiﬁes
a set of local minima denoted by

LM(M) :2 {ml size of SD(m) > 0}, (2)

and we set lm(M):=|LM(M)|. Furthermore, let Bj:=
{SD(m)| size of SD(m) = j} denote the set of sets SD(m) that
have the same size j. As in Garnier and Kallel (2002) we set

ﬁj I= lleJZO- (3)

By this deﬁnition, ,Bj is the number of local minima ‘Visited’ by
exactly j out of M = |M| conformations after steepest descent. By
deﬁnition of lm(M) we then have

M
lm(M) = Zﬁj. (4)
j=1

On the other hand, the number M of initial conformations can be
expressed by

M = 2,13,. (5)

Supplementary Figure S1 illustrates the particular values for the case
of v=4 and M27.

Let ,8“, denote the expected value of ,Bj under the assumption
that the normalized sizes or of attraction basins A are distributed
according to py deﬁned in (1). Garnier and Kallel (2002) established
the relation

ﬂ =v(M) F<y+j) PM)
N j 1‘(y)1‘((v—1)y)

for j = 1, ...,M. In Equation (6), the value of v is unknown, but we
note that for v=M / r, r>0, a ﬁxed value of M, and appropriate
approximations of the F-function, the ,8“, can be approximated
according to Equation (6) as functions of (M , j , y, r). Such a
parameterized representation enables us to connect the computed
values ,8“, = ,Bj,y(M, r) to the observed values ,Bj.

Given the sequence of pairs (,BJW; ,Bj), j: 1, .....,M, the task is
to identify a value for y that provides a best ﬁt of the ,8“, to the

1‘((v—1)y+M-j)
F(Vl/+M)

 

(6)

 

525

112 Bio's112umofp101xo'sot112u1101u101q”:d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo ::

S.Sahoo and A.A.Albrecht

 

observed values ,Bj. Garnier and Kallel (2002) propose the xz-test
for approximating y, which leads to minimizing

M ._ . 2

Ty=Z—"” ft” (7)
1'21 Jay
with respect to y. Since in our approach we have chosen a
parameterized representation for the ,Bj, y from Equation (6), we have
T y =Ty(r) and for minimizing T y(r) we execute a simple search
procedure min( T y) with an outer-loop running for r E [rmin; rmX with
stepsize (Sr and an inner-loop running for y E [ymir1 ymax with stepsize
8),. The output is denoted by out = [T y(r); y; r], with out[1] being
the minimum T y(r) found within the given range (assuming the
output is unique, otherwise for the maximum y for the same T y (r)
and maximum r, respectively).

The procedure min(Ty) searches for a global minimum
within a grid of size [(rmaX—rmin)/8r] X [(ymaX—ymin)/8y]. It is
important to note that the ,Bj,y(M, r) involved are independent
of the particular problem. Therefore, for given M, ﬁxed j and
[rHﬁn,rmaX,8r; ymin, ymax,8y], all values can be pre-calculated and
stored in a matrix of size [(rmaX—rmin)/8r] X [(ymaX—yminVSy].
Typically, the selection of r-Values will be such that rmin < 1
and rmX > 1. To make the calculation (approximation) of the
,Bj,y(M, r)—Values numerically stable, the minimum value of y will
be chosen as ymin=0.1. For example, for rmin=0.25, rmaX=2.5,
8r=0.1, ymin=0.1, ymaX=2.5 and 83,2001, the size of the grid
is only 5400, i.e. ~5.3 kb memory locations are required. (For
a comparison to MATHWORKS’ ga—optimizer, see Section 2 in
Supplementary Material.)

We denote the value of r = out[3] returned by out = [T y (r); y; r]
at the end of procedure min(Ty) by rappr. For the set of randomly
selected conformations M :={S1,S2, ...,SM}, the approximation of
the number of local minima provided by the Garnier—Kallel method
can then be chosen by setting

M

 

(8)

vappr rappr.
Thus, yappr = out[2] from out = [T y(r); y; r] that minimizes T y (r)
is not directly involved in calculating vappr. Minimizing T y (r) with
respect to y aims at ﬁnding the best stochastic model that ﬁts
the observed data ,Bj, and as a ‘byproduct’ we gain the information
about rappr.

For the calculation of ,8“, according to (6), we ﬁrst calculate
F s :2 lnF(zs) for each of the six F(zs) involved, and additionally we
use In (134)223‘12Mﬂ-H Ins—211.21 lnt. Finally, we set ,Bj,y(M, r):
(M/r)eZ, where Z:=ln(‘;{1)+ZS’=1Fs—Zt6=4Ft.

For ﬁxed M, j and [rmn,rmax,8r;ynﬁn,ymax,8y], the values of
,Bj,y(M, r) are pre-calculated and require only a small memory space
mem—sp[rmin,rmax,8r; ymimymaxﬁy]. Theoretically, mem—sp has
to be multiplied by M, since j=1,...,M. However, the xz-test
usually takes into account only a fraction of the values computed
for the stochastic model, which in our case are the [3]”, see
also Section 6 in Garnier and Kallel (2002). This is due to the
fact that small values in the denominator in Equation (7) can
distort the quality of approximations obtained by the ﬁrst major
terms. There are different rules for adapting the xz-test to the
individual problem under consideration. Based on preliminary
computational experiments, we have decided to include into the

actual minimization of Ty (r) only summands with ,6“, 2 1.0, which
is at the lower end of recommended values. Consequently, only
a relatively small number of ,8“, has to be taken into account,
which is denoted by J(M) (for the sequences considered in the
present paper, J(M) is in the range of small double-digit numbers).
(For a detailed analysis of ,6j and basin sizes, see Section 3 in
Supplementary Material.)

2.2 Reeves—Eremeev estimation

Reeves and Eremeev (2004) study the problem of how many trials
of steepest descent are required for detecting with high probability
all local minima in a given landscape. In other terms, the authors
provide a lower bound for the size of M that ensures (with a certain
conﬁdence) the detection of all local minima. The Reeves—Eremeev
estimation involves the number of local minima. That is why we ﬁrst
try to estimate the number of local minima by the Granier—Kallel
method, and then we apply the lower bound provided by Reeves and
Eremeev (2004).

The Reeves—Eremeev estimation is derived from a step-by-step
analysis of the increase of the number of detected local minima.
We assume that already k local minima have been detected. Let
Wk denote the expected number of randomly chosen structures
with subsequent execution of steepest that need to be processed for
an increase to (k+1) detected local minima. Reeves and Eremeev
(2004) propose the following geometric distribution for Wk:

min = :fo—l. (9)

The overall number W of trials can then be estimated by

 

v—l
W = 1+ZWk, (10)
k=1
which implies for the expected value and the variance
E(W) W v1n(v+g), (11)
2
V(W) m (mg) +1—vln(v+g), (12)

where g m 0.58 is the Euler—Mascheroni constant. Both
approximations provide the lower bound

 

(1)702

 

W > v(lnv+g)+cp\/ +1—v(lnv+g). (13)
The factor cp is a coefﬁcient associated with the assumption that
Equation (13) is valid with conﬁdence ,0E[0, 1] (or in terms of
percentages). Based on numerical simulations, Reeves and Eremeev
(2004) suggest cp = 1.83 for ,0:95%.

3 RESULTS

We applied the methods described in the preceding section to ten
3’UTRs of human RNAs and to the riboswitch AL93 5260 of length
79nt reported by Bengert and Dandekar (2004). We analysed one
3’UTR of length 50nt (for a partial landscape deﬁned by a bounded-
depth neighbourhood relation) and nine examples of 3’UTRs with
a length ranging from 66nt up to 401nt. The upper bound on
the length of 3’UTR (and £(3’UTR) =50nt for the bounded-depth
neighbourhood) is caused by the chosen evaluation strategy: the

 

526

112 Bio's112umofp101xo'sot112u1101u101q”:d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo ::

Approximation of local minima in partial RNA folding landscapes

 

approximation of the number of local minima is veriﬁed against the
values calculated by the barriers implementation (Gruber et al.,
2008), which requires to invoke the RNAsubopt program (Wuchty
et al., 1999) with an exponentially increasing number of structures
for an increasing distance to the global minimum.

The sequences were chosen rather randomly, with some of them
being highly ranked (but not yet validated) in microRNA target
predictions by MicroCosm (miRanda) (Grifﬁths-Jones et al., 2008).
However, we tried to design a test set that contains sequences with
varying ratios of the size of the subspace versus the number of
local minima within this subspace, including one sequence with a
very ‘rugged’ partial landscape close to the minimum free energy
conformation.

3.1 Approximating the number of local minima

For a given 3’UTR S (= linear sequence without base pairs), we
generated the RNAsubopt output with a certain energy difference
5E above the minimum free energy conformation. The offset SE was
chosen in such a way that the subsequent barriers application
produced a number of local minima roughly in the region of 1000.
The set of conformations produced by RNAsubopt with SE is
denoted by 85E. The selection of M :={S1,S2, ...,SM} C 85E is then
executed in the following way:

(0) Initialize M =M0 >> 0. The selection of M0 is a crucial task.
A potential guideline for selecting M0 is presented in more
detail in Section 3.3.

(1) 85E(S) is partitioned into S’ and S” with |S’| N|85E(S)|/3
(and therefore |S”| %2|S,3E(S)|/3) and E(S’) > E(S”) for S’E
S’ and S”ES”.

(2) Out of S’, M secondary structures are randomly selected.

The Steps (1) and (2) are speciﬁc to our evaluation procedure.
In general, during a search-based landscape analysis, M % 3M
independent runs are executed for a ﬁxed number K of
neighbourhood transitions with a subsequent selection of M terminal
conformations with higher energy values. The K transitions per run
can be performed, for example, within a neighbourhood (Hamming—
distance sphere) d(S0,S) 5 k of the starting conformation S0.

Furthermore, in order to support a relatively fast run-time, for a
given M only one set M is selected. To counter-balance deviations
caused by random selections, the number of local minima is
calculated in two ways, which is further explained in Steps (7)
and (9).

The next steps relate to the application of the Garnier—Kallel
method and are independent of our particular evaluation method:

(3) For each S” E M steepest descent is executed according to (i),
(ii) and (iii), where for each intermediate S the neighbourhood
N3: is computed by applying Op-I, Op—II and Op—III.

(4) The set LM(M) from Equation (2) is identiﬁed.

(5) The values ,Bj from Equation (3) are calculated for j:
1, ...,J(M).

(6) If R:=,61/,62>3, then M:=M+M0 and go to Step (2).
Alternatively, if the initial M0 is small and ,61 /,62 >> 3, the
increase of M can be chosen as M :=2M.

Step (6) indicates (in the general case of unknown 1)) whether M is
too small for exploring the (partial) landscape under consideration.
Moreover, the step contributes to the numeric stability by avoiding
small y in out[2] of min(Ty). Finally, vappr is calculated:

(7) We set M ’ := 
conformations Su actually involved in the xz-test;
cf. Equation (7).

jﬁj. M’ is the number of initial

(8) min(Ty) is executed on M and Equation (8) is applied to M
and M ’ (both with rap},r = out[3]).

(9) The ﬁnal output vappr is determined in the following way:
Case B: If M’ 5M /2, then vapp, = 2(M/rappr)/(M/M’+ 1).

The two cases A and B are the result of a large number of test-
runs for different £(3’UTR) and different settings of M . If M ’ > M / 2,
there are fewer local minima that attract many elements of M (and
are represented by ,Bj,y(M, r) < 1.0), i.e. the random selection M is a
‘good choice’ within pL. If M ’ 5M / 2, only a relatively small part of
M actually participates in min(Ty). Since we want to avoid repeated
runs on different random selections M, we establish a relation
between M’ and M by setting vapprz (w’vM/+va)/(w’+w). A
straightforward setting of weights is w’ =M/M’ and w: 1, which
leads to the expression in Case B.

The results are summarized in Table 1. We emphasize that the
data were generated by arbitrary runs for each of the sequences.
The setting corresponds to the case that the heuristic is used as a
subroutine in search-based folding simulations. In such simulations,
it is not desirable to optimize approximations of v by a statistical
analysis over a larger number of runs for the same value of M.

On the other hand, we noticed that repeated runs for the same
M with R < 3 can produce improved approximations, especially if a
particular run results in R < 2, which then corresponds to relatively
small values of T y and out[2] >>0.1. However, none of the runs
presented in Table 1 resulted in R <2 and all M ’ >M / 2 (Case A)
with all out[2] close or equal to 0.1. In this sense, the data from
Table 1 seem to represent an ordinary scenario and do not display
speciﬁc positive features. (Large values of M are analysed in Section
5 Supplementary Material.)

If R = ,61 /,62 5 3 for the smaller M, the second run was executed
in order to demonstrate the observation that a further increase of
M not necessarily improves the quality of the approximation. The
observation complies with the data reported by Garnier and Kallel
(2002). The analysis of this effect, which could be attributed, for
example, to increased ,Bj with ,8“, 3 1.0 and j > 2, will be a subject
of further research. The same applies to the selection of M from the
upper energy level, where a combination of two runs for the same
M, one for a ‘horizontal’ selection and the second for a ‘Vertical’
selection, could potentially improve the approximation.

The value of A from Table 1 is deﬁned by A :=(|vappr—v|/v)x
100%. When taking the ﬁrst run with R 5 3 for each of the sequences
from Table 1, the average value of A is equal to 38.5%. The average
value of A for M -runs with lowest value of T y is 36.2%. As expected,
the ratio |85E | / v has an impact on the quality of approximations: for
the two sequences with £(3’UTR)=98 and the sequence of length
79, the ratio is particularly large, and the corresponding M -runs
with R5 3 all produce A < 10%. The sequence NM_024482 with
the smallest value of |85E | /v produced the worst A value.

 

527

112 Bio's112umofp101xo'sot112u1101u101q”:d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo ::

S.Sahoo and A.A.Albrecht

 

Table 1. Approximation of the number 1) of local minima

 

 

Ref. No. 3’UTR Isa}; | 6E v M hn(M) M ’ Ty r R 5 3 vappr A
mRNA length =sz %
NM_000363 66 4888 6.50 553 750 182 451 16.1 0.72 + 626 13.2
1500 320 1022 22.1 0.91 + 1123 103.1
NM_172109 66 5589 6.50 491 750 185 412 31.9 0.63 — 654 33.2
1500 270 775 61.8 0.98 + 791 61.1
NM_018217 78 5514 5.50 455 750 179 428 25.6 0.68 — 629 38.2
1000 251 830 25.8 1.21 + 686 50.8
NM_000915 98 24 744 9.50 906 1500 326 840 39.5 0.85 + 988 9.1
3000 439 1596 58.9 1.37 + 1165 28.6
NM_002584 98 37 521 8.50 998 1500 306 814 49.6 0.85 + 958 4.0
3000 433 1549 65.5 1.37 + 1131 13.3
NM_024482 100 10 214 5.00 1301 1500 485 1170 23.7 0.50 + 2340 79.9
3000 687 2140 76.7 0.74 + 2892 122.3
NM_170726 400 20428 1.85 1100 1500 396 1052 30.6 0.60 — 1753 59.4
3000 532 1821 55.2 1.12 + 1626 47.8
NM_001043229 400 22 482 2.75 1185 1500 451 1133 35.2 0.52 + 2179 83.9
3000 647 2089 42.9 0.88 + 2374 100.3
NM_031420 401 15 596 2.75 1017 1500 349 915 54.1 0.70 + 1307 28.5
3000 515 1742 91.8 1.12 + 1555 52.9
AL935260 79 19 139 8.50 782 750 186 408 30.3 0.60 — 680 13.0
1500 285 801 42.8 0.96 + 834 6.6
Average A for ﬁrst M -runs with R 5 3 38.5
Average A for M -runs with lowest value of Ty 36.2

 

3.2 Approximating sets of local minima

The value of vappr is used for the approximation of W from
Equation (13). The preceding procedure on M already identiﬁed
a subset of local minima LM(M), and lm(M) is the size of the
subset of local minima, cf. Equations (2) and (4). Therefore,
we select only Wsub :=W—M pairwise different conformations
Sv from the corresponding set 85E, where SvyéSu for each
SuEM is required. The resulting set of Wsub conformations is
denoted by \LV, and as before, after executing steepest descent,
we set LM(W):={m| size of SD(m)>0} and lm(W):= |LM(W)|.
Although WﬂMzﬂ, LM(M) and LM(W) are not necessarily
disjoint. Hence, we set lm/Q :=|LM(W)ﬂLM(M)|, and the total
size/\lmﬁn of LMﬁn=LM(W)ULM(M) is then given by lmﬁn=
lm(W) +lm( M) — 1mm.

The corresponding results are shown in Table 2. The value
of the approximation rate Aﬁn is deﬁned by Aﬁn :=(vappr/v)x
100%. The sequences NM_000363 and NM_172109 are left out
due to the large value of Wsub. The ratio Wsub/ |85E| is quite
large for four sequences (between 0.85 and 0.998) and 50.34
for three sequences (between 0.21 and 0.34). As mentioned at
the beginning of the current section, the test set was designed
to contain sequences with a ‘rugged’ energy landscape within the
selected subspace. For example, for NM_024482 we have for both
ratios the maximum values |SgE|/v=7.85 and Wsub/|85E| 20.998.
However, the three sequences with 0.215Wsub/|85E|50.34 (as
well as the sequence considered in Section 3.3 with a much
smaller ratio) produce only slightly worse results with an average
of 89%.

The maximum deviation below the targeted 95% approximation
rate is for NM_0025 84 with 7.8%, and the average deviation below
95% is 4.2%, with one sequence above 95%.

3.3 Approximations within a partial landscape pL

For the 3’UTR of NM_002410 with £(3’UTR)=50, we executed
both heuristics for a bounded-depth neighbourhood induced by
the secondary structure S = ....... ..(((..(( .... ..(( ........ ..)) .... ..)))))... with
seven base pairs and E (S): —0.7kcal/mol. The minimum energy is
Emin(3’UTR) = — 17.6 kcal/mol. The bounded-depth neighbourhood
is deﬁned by

N? := {S’|(d(S,S’):k)&(E(S’)s10%)}0840. (14)

We selected k=5, and the setting 5E :40 is the default value for

RNAsubopt. The size of N3 is 296331, and the number of local
minima within this set is 1000. The total number of local minima
within {S’ |S’ ES40&E(S’) 5 10.00kcal/mol} is 1247.

The maximum energy of a local minimum that belongs to N3 is
+7.10kcal/mol, whereas the minimum energy is —12.9kcal/mol.
The operations OP-I, OP-II and OP-III were executed only within

Ng and the number M ’ of conformations relates only to minima
within this Hamming-sphere.

The results for M = 1500 and M = 3000 are displayed in
Table 3. In both cases, we have R53. For M 21500, the value
of v is overestimated by 10.8%. For the subsequent run with
Wsub 29494 initial conformations, the approximation rate is equal
to Aﬁn = 96.2%.

Adding the results for NM_002410 to the results from Tables 1
and 2, we obtain an average value of A for R 5 3 of 36%, and with
respect to minimum values of T y the average value of 33.9%. The
average approximation rate is then slightly > 92%, which deviates
from the target by 3%.

 

528

112 Bio's112umofp101xo'sot112u1101u101q”:d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo ::

Approximation of local minima in partial RNA folding landscapes

 

Table 2. Approximation of the set of local minima

 

 

Ref No 1: v M lm(M) vappr W Wsub lm(W) lmn hnﬁn Aﬁn
NM_018217 78 455 1500 251 685 6473 4973 392 230 413 90.8
NM_000915 98 906 1500 326 988 9700 8200 681 197 810 89.4
NM_002584 98 998 1500 306 958 9375 7875 739 175 870 87.2
NM_024482 100 1301 1500 461 2340 11 696 10 196 1196 461 1196 91.9
NM_170726 400 1100 3000 532 1626 16 776 13 776 987 454 1065 96.8
NM_001043229 400 1185 1500 451 2179 23 121 21621 1091 439 1103 93.1
NM_031420 401 1017 1500 349 1307 13 198 11698 912 318 943 92.7
AL935260 79 782 1500 285 834 8046 6546 629 208 706 90.3

Average approximation rate Aﬁn 91.5

 

Table 3. Approximations within pL for NM_002410 with £(3’UTR)=50 and v=1000

 

 

M M’ r Ty vappr A lm(M) W Wsub lm(W) lmn hnﬁn Aﬁn
1500 720 0.65 76.4 1108 10.8 442 10 994 9494 901 381 962 96.2
3000 1069 0.88 137.3 1215 21.5 525 12180 9180 891 486 930 93.0

 

As already mentioned, selecting the initial M =M0 is an important
step in the general case of partial landscapes deﬁned by d(S0,S) 5 k.
A potential way of specifying M0 could be based on the observation
made by Lorenz and Clote (2011) that the number of local optima
relates to the square root of the size of the entire conformation
space. Adopting this relation to partial landscapes could then be used
for identifying the order of magnitude of an initial M0. However,
this would require adequate estimations of the number of canonical
structures (Clote et al., 2009) in Hamming—spheres deﬁned by
d(S0,S) 5k, and further research is needed for establishing secure
rules of selecting initial M0.

For example, if p with 2k52p5n—2k is the number of base
pairs within S0 of length n, then a coarse estimation of the
number of conformations that obey d(S0,S) 5 k with no isolated
base pairs (canonical structures) can be easily established based
upon the sum of products of binomial coefﬁcients. Assuming
k<<n and using (Z)~(ea/b)b, the estimation has the order of

magnitude of (emax{2(n—2p); p} / k)k. For the square root, we set
k 2 .

(am_1, ...,a0)10 :2 L(emax{2(n—2p);p}/k) / J w1th 0<am_159,

and the suggested initial M0 would then be deﬁned by M0 = 10m_1.

For the sequence from Table 3, we have 2(n—2p) :72 > p=7, and

|_(ex72/5)2'5J =9601 then deﬁnes M0 =1000.

3.4 Complexity analysis

We analyse the complexity of the proposed heuristic for a partial
landscape pL deﬁned by a ﬁxed secondary structure S and the
bounded-depth neighbourhood Nk :2 {S’ |d(S, S’) 5 k}.

The most time consuming part of ﬁnding vappr consists of the
execution of steepest descent according to (i), (ii) and (iii), in
particular, step (ii). The second step is based on Op-I, Op-II and
Op—III, where the time complexity of each of the operations can be
upper bounded by 0(n2), which includes the update of the energy
value assigned to each element of the neighbourhood. The update
can be carried out in a similar way as described by Lorenz and

Clote (2011) for the nearest neighbour model by local changes to
the energy value. The operations OP—I, OP—II and OP—III perform
a complete search for feasible conformations, and therefore the
information about the affected loop (as well as neighbouring loops)
in the loop representation of free energy (Lorenz and Clote, 2011)
can be maintained and locally updated.

If D=D(M) denotes the maximum length of a steepest descent
pathway from an SEM to the corresponding element of LM(M),
the total number of steps can be estimated by 0(MDn2). For
the sequences and partial landscapes we analysed, the value of
D is relatively small, typically in the region of low double digit
numbers. In the second part, namely the approximation of sets of
local minima, the same operations are executed over M 5 0(vln v)
randomly selected initial conformations, cf. Equation (13). If D is
the maximum pathway length (depth of attraction basins) for both
parts of the procedure, we have 0(Dn2vlnv) basic steps for the
second part. Making sure that the initial conformations are pairwise
different requires 0(M2) and 0((vln v)2) steps, respectively. Based
on our computational experiments, assuming M = 0(vln v) and
vlnv5 0(Dn2) seems to be justiﬁed. Therefore, taking both parts
together leads to a time complexity of 0(Dn2vln 1)).

In the present paper, the sets M are randomly drawn from
an RNAsubopt output. RNAsubopt produces an exponentially
increasing output with increasing 8E. Therefore, in the general case,
the sets M are sampled from random trajectories of length K within
pL. The aim is to reach out to different areas of the partial landscape.
Consequently, the transitions are not governed by constants km, as
mentioned in Section 1, but changes to conformations are executed
randomly, where processing each transition requires 0(n) steps. The
worst case bound 0(n) results from checking the validity of the
randomly generated neighbour: the minimum loop size is 3nt, and
the condition of at least two consecutive bonds must be maintained.
Overall, for given K and M, 3KM random transitions are executed.
Out of the 3M ﬁnal conformations, M conformations with the highest
energy values are then selected. If we assume K % 0(Dn), the total
complexity 0(3KMn) does not exceed 0(Dn2vln v).

 

529

112 Bio's112umofp101xo's01112u1101u101q”:d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo ::

S.Sahoo and A.A.Albrecht

 

4 DISCUSSION

For the 11 sequences we analysed in the present paper, the Garnier—
Kallel method not only produced estimations within the same order
of magnitude of the true number of local minima (calculated by
RNAsubopt and barriers), but also with an average deviation
of 36% (in most cases overestimation); the estimations of the
number of local minima seem to be a useful input to the subsequent
approximation of the entire set of local minima. On the nine
sequences with a sufﬁciently large size of the partial landscape, the
estimations and parameter settings provided by Reeves and Eremeev
(2004) have led to an average approximation rate of 92% for a target
rate of 95%, which we see as a conﬁrmation of the Reeves— Eremeev
method and a justiﬁcation for the entire approach. The results were
achieved for sequences with varying ratios of the size of the partial
landscape versus the number of local minima within the subspaces.

An open question is the secure selection of the initial sample
size M0. A potential way for solving this problem could be based
on good approximations of the number of secondary structures that
constitute the Hamming-sphere around a particular structure under
consideration. The increase of the sample size in case of ,61 /,62 >> 3
can be organized in different ways. For example, when starting with a
relatively small M0, a sample size of 2tM0 in step t provides a rapid
increase that could lead within a few steps to at least ,61 /,62 53
(additionally, one could then search backwards between 2tT1M0
and 2tM0 additive steps for better values of T y where the current
M —run still complies with ,61 /,62 5 3). On the other hand, for a given
sequence length n and a ﬁxed radius it might be possible to devise
standard rules for initial settings of M0, which could result in a very
small number of M -runs.

Another line of further improvements could be the combination
of the data from two runs for the same value of M, with one run
for a ‘horizontal’ selection of samples (high free energy within the
partial landscape) and the second run for a random selection over all
conformations obtained by M random walks of length K within the
partial landscape. Here, one would need to establish rules of how to
determine the approximation from two different sets of values for
M ’ and out[3] taken together with the current value of M.

ACKNOWLEDGEMENTS

The authors are grateful to the anonymous referees for their careful
reading of the manuscript and valuable suggestions that resulted in
an improved and more detailed presentation of our results.

Funding: Department for Employment and Learning through its
‘Strengthening the all-Island Research Base’ initiative (in part).

Conﬂict of Interest: none declared.

REFERENCES

Bellaousov,S. and Mathews,D.H. (2010) ProbKnot: fast prediction of RNA secondary
structure including pseudoknots. RNA, 16, 1870—1880.

Bengert,P. and Dandekar,T. (2004) Riboswitch ﬁnder—a tool for identiﬁcation of
Iiboswitch RNAs. Nucleic Acids Res., 32, W154—W159.

Chen,S.J. (2008) RNA folding: Conformational statistics, folding kinetics, and ion
electrostatics. Annu. Rev. Biophys., 37, 197—214.

Clote,P. et al. (2009) Asymptotics of canonical and saturated RNA secondary structures.
J. Bioinform Comput. Biol., 7, 869—893.

Danilova,L.V. et al. (2006) RNAKinetics: a web server that models secondary stmcture
kinetics of an elongating RNA. J. Bioinform Comput. Biol., 4, 589—596.

Dotu,I. et al. (2010) Computing folding pathways between RNA secondary structures.
Nucleic Acids Res., 38, 1711—1722.

Flamm,C. and Hofacker,I.L. (2008) Beyond energy minimization: approaches to the
kinetic folding of RNA. Monatshefte f. Chemie, 139, 447—457.

Flamm,C. et al. (2000) RNA folding at elementary step resolution. RNA, 6, 325—338.

Flamm,C. et al. (2002) Barrier trees of degenerate landscapes. Z. Phys. Chem, 216,
155—173.

Garnier,J. and Kallel,L. (2002) Efﬁciency of local search with multiple local optima.
SIAM J. Discr: Math, 15, 122—141.

Geis,M. et al. (2008) Folding kinetics of large RNAs. J. Mol. Biol., 379, 160—173.

Grifﬁths-Jones,S. (2008) miRBase: tools for microRNA genomics. Nucleic Acids Res.,
36, D154—D158.

Gruber,A.R. et al. (2008) The Vienna RNA Web suite. Nucleic Acids Res., 36,
W70—W74.

Hofacker,I.L. (2003) Vienna RNA secondary structure server. Nucleic Acids Res., 31,
3429—3431.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary structures.
Monatshefte f. Chemie, 125, 167—188.

Hofacker,I.L. et al. (2010) BarMap: RNA folding on dynamic energy landscapes. RNA,
16, 1308—1316.

Lorenz,W.A. and Clote,P. (2011) Computing the partition function for kinetically
trapped RNA secondary structures. PL0S One, 6, e16178.

Lou,F. and Clote,P. (2010) Thermodynamics of RNA structures by Wang—Landau
sampling. Bioinformatics, 26, 1278—1286.

Mann,M. and Klemm,K. (2011) Efﬁcient exploration of discrete energy landscapes.
Phys. Rev. E, 83, 011113.

McCaskill,J. (1990) The equilibrium partition function and base pair binding
probabilities for RNA secondary structure. Biopolymers, 29, 1105—1119.

Morgan,S.R. and Higgs,P.G. (1998) Barrier heights between ground states in a model
of RNA secondary structure. J. Phys. A: Math. Gen., 31, 3153—3170.

P6rschke,D. (1974) Model calculations on the kinetics of oligonucleotide double helix
coil transitions. Evidence for a fast chain sliding reaction. Biophys. Chem, 2, 83—96.

Ragan,C. et al. (2011) Quantitative prediction of miRNA—mRNA interaction based on
equilibrium concentrations. PLoS Comput. Biol., 7, e1001090.

Reeves,C.R. and Eremeev,A.V. (2004) Statistical analysis of local search landscapes.
J. Oper: Res. Soc, 55 687—693.

Schuster,P. (2006) Prediction of RNA secondary structures: from theory to models and
real molecules. Rep. Prog. Phys., 69, 1419—1477.

Tang,X. et al. (2005) Using motion planning to study RNA folding kinetics. J. Comput.
Biol., 12, 862—881.

Tang,X. et al. (2008) Simulating RNA folding kinetics on approximated energy
landscapes. J. Mol. Biol., 381, 1055—1067.

Wang,F. and Landau,D.P. (2001a) Determining the density of states for classical
statistical models: a random walk algon'thm to produce a ﬂat histogram. Phys. Rev.
E, 64, 056101(1)—056101(16).

Wang,F. and Landau,D.P. (2001b) Efﬁcient, multiple-range random walk algorithm to
calculate the density of states. Phys. Rev. Lett., 86, 2050—2053.

Wolﬁnger,M.T. et al.(2004) Efﬁcient computation of RNA folding dynamics. J. Phys.
A Math. Gen., 37, 4731—4741.

Wuchty,S. et al. (1999) Complete suboptimal folding of RNA and the stability of
secondary structures. Biopolymers, 49, 145—164.

Xayaphoummine,A. et al. (2003) Prediction and statistics of pseudoknots in RNA
structures using exactly clustered stochastic simulations. Proc. Natl Acad. Sci.
USA, 100, 15310—15315.

Xayaphoummine,A. et al. (2005) Kinefold web server for RNA/DNA folding path
and structure prediction including pseudoknots and knots. Nucleic Acids Res., 33,
605—610.

Xia,T.B. et al. (1998) Thermodynamic parameters for an expanded nearest-neighbor
model for formation of RNA duplexes with Watson-Crick base pairs. Biochemistry,
37, 14719—14735.

Zhao,P. et al. (2010) Predicting secondary structural folding kinetics for nucleic acids.
Biophys. J., 98, 1617—1625.

 

530

112 Bio's112umofp101xo's01112u1101u101q”:d11q 111011 pepeolumoq

910K ‘09 isnﬁnV uo ::

