Vol. 27 ISMB 2011, pages i69—i76
doi: 10. 1093/bioinformatics/btr207

 

Template-free detection of macromolecular complexes in

cryo electron tomograms
Mih Xu‘, Martin Beck2 and Frank Alber1’*

1Program in Molecular and Computational Biology, University of Southern California, Los Angeles, CA 90089, USA
and 2European Molecular Biology Laboratory, Computational and Structural Biology Unit, Meyerhofstrasse 1, 69117

Heidelberg, Germany

 

ABSTRACT

Motivation: Cryo electron tomography (CryoET) produces 3D
density maps of biological specimen in its near native states.
Applied to small cells, cryoET produces 3D snapshots of the cellular
distributions of large complexes. However, retrieving this information
is non-trivial due to the low resolution and low signal-to-noise ratio in
tomograms. Current pattern recognition methods identify complexes
by matching known structures to the cryo electron tomogram.
However, so far only a small fraction of all protein complexes
have been structurally resolved. It is, therefore, of great importance
to develop template-free methods for the discovery of previously
unknown protein complexes in cryo electron tomograms.

Results: Here, we have developed an inference method for the
template-free discovery of frequently occurring protein complexes
in cryo electron tomograms. We provide a first proof-of-principle of
the approach and assess its applicability using realistically simulated
tomograms, allowing for the inclusion of noise and distortions due
to missing wedge and electron optical factors. Our method is a
step toward the template-free discovery of the shapes, abundance
and spatial distributions of previously unknown macromolecular
complexes in whole cell tomograms.

Contact: alber@usc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

Cryo electron tomography (cryoET) enables the 3D visualization
of a cell’s interior under close to live conditions (Best et al., 2007;
Frank, 2006; Luéic et al., 2005; Medalia et al., 2002; Murphy and
Jensen, 2007). Such tomograms are essentially 3D representations
of the entire proteome providing a snapshot of the distributions
of protein complexes and their interaction networks (Alber et al.,
2008; Beck et al., 2011). However, retrieving shape information
and distributions of macromolecular assemblies is not trivial due
to the low signal—to—noise ratio (SNR), missing data and non—
isotropic resolution, and the fact that individual macromolecules
are difﬁcult to recognize in a highly crowded environment (Best
et al., 2007; B6hm et al., 2000; Frangakis et al., 2002; Medalia
et al., 2002). So far, the identiﬁcation of macromolecular complexes
is accomplished mostly by template matching methods (Best et al.,
2007; B6hm et al., 2000; Frangakis et al., 2002; Medalia et al., 2002)
where the signals representing the density map of a known protein
complex structure are correlated to the signals in the cryoET map.

 

*To whom correspondence should be addressed.

The cross—correlation between the template and tomogram is
calculated for each position and every possible orientation. Peaks in
the resulting cross—correlation function across the whole tomogram
may indicate positions occupied by the particular complex. A major
drawback, however, is that template matching cannot discover yet
structurally unknown complexes. So far only a relatively small
fraction of large protein complexes have been structurally resolved.
Furthermore, recent work has shown that the quaternary structure
of large protein complexes varies considerably across different
organisms (Han et al., 2009) and available reference structures
might therefore not be applicable to the desired organism. Even if a
template structure is available, the template—based methods may fail
if the template structure is in a different conformation or is bound
to additional proteins than the target complexes in the tomogram.
As a consequence, template—based methods may fail in detecting
an unbiased atlas of the spatial arrangement of all complexes in
a cell (i.e. a cellular proteome ‘atlas’). It is, therefore, of great
importance to develop template—free methods for the detection
of macromolecular complexes in cryo electron tomograms. Such
methods will allow not only the discovery of the shapes of unknown
macromolecular complexes but also allow detecting their positions
and orientations in the cryo electron tomograms.

The key problem in a template—free approach is to identify
frequently occurring density patterns in cryo electron tomograms. A
pattern is deﬁned by voxel regions with similar intensity structures,
which appear multiple times at different position in the tomogram.
Such frequently occurring patterns represent objects of biological
interest. In this article, we focus on patterns that correspond to
protein complexes. Once identical complexes are discovered, their
subtomograms can be locally aligned and their density distribution
averaged producing a density map of the complex with improved
SNR.

Identifying recurrent patterns in cryo electron tomograms is
challenging because neither the composition nor the total number
of the patterns is known. Moreover, cryo electron tomograms are of
very low resolution (:4 nm), low SNR and are subject to distortions
due to electron optical effects. Therefore, traditional methods in
computer vision derived for high resolution and high SNR 3D
object recognition usually cannot be directly applied to cryo electron
tomograms (Tangelder and Veltkamp, 2008).

Here, we propose a step—wise approach for classifying cryo
electron tomograms into recurrent density patterns (Fig. 1). First, an
initial classiﬁcation is generated based on rotation—invariant features
of the tomogram. In the second step, this initial classiﬁcation is
reﬁned using a Gaussian Hidden Markov Random Field (GHMRF)
model. As an inference method, GHMRF models have shown

 

© The Author(s) 2011. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§.IO'SIBUJHOprOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 11101; pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

M.Xu et aI.

 

2. EI-L'IJEE'I. illhilkrll'r' 3. GENESIEI‘I Hldﬂﬁl‘l

1. Segmentation bl.- rotatinn Markov Random
invariant IEiLtllﬂlb Field Appruitch
Tc:n'||:|gr.Lm -—1-l—h Dnlim-d Iliad-1...”... it. I'Ht'al lﬂ‘nc‘ﬂlam I T ' REI‘rIEd tun-rowan:

(Insﬁiﬁratinn :Iaaaiﬁcalinn

Fig. 1. Flowchart of our protocol.

robustness in 2D image segmentations at relatively high noise levels
(Zhang et al., 2001). Here, we extend the GHMRF framework to
the classiﬁcation of recurrent patterns in 3D cryoET maps, which
contain high levels of noise and distortions.

In this article, we provide the ﬁrst proof of principle of the method,
and demonstrate its applicability for the detection of frequently
occurring protein complexes in noisy density maps with relatively
high accuracy. We test our approach on realistically simulated cryo
electron tomograms including low resolution, high levels of noise
and distortions due to missing wedge effects and electron optical
factors.

2 METHODS

Our method consists of three steps (Fig. 1): ﬁrst, we identify candidate
patterns (i.e. objects) by segmenting the tomogram into high intensity
regions. This step reduces the search space to the most promising density
regions. Second, the similarity between all the objects is compared. To
calculate similarities between all the objects efﬁciently, each tomogram voxel
(i.e. the 3D equivalent of an image pixel) is represented by a feature vector
that describes the local intensity distribution in the proximity of the voxel
in a rotationally invariant manner. The similarity between objects is then
determined efﬁciently by comparing the distances between the corresponding
feature vectors. Then the segmented objects are clustered based on their
feature vector similarity. All voxels in objects of the same cluster are assigned
to the same pattern class. Third, the resulting initial voxel classiﬁcation is
reﬁned by an GHMRF approach. The GHMRF approach reclassiﬁes the
voxels into recurrent patterns by maximizing the probability to observe the
classiﬁcation for the given tomogram.

2.1 Problem formulation and deﬁnitions

A tomogram is described by a 3D grid of voxels that are associated with
values of electron optical density. Let T: {1, 2, ...,N} be the set of indices
of all voxels in the density map, and let x,- e R3 be the location of voxel ie T
in the map.

Intensity vector: then, a tomogram is represented by a N —dimensional
vector of the ordered list of intensity values for all voxels.

f=061,~--af1v) (1)

where N is the total number of voxels and f,- is the intensity value of voxel i.

Class label vector: a pattern in a density map is deﬁned as a collection
of voxels that may have different intensities but are assigned to the same
pattern class. Let us deﬁne the set of all pattern classes in a tomogram as
C ={1,2, ..., C}, with C as the total number of classes. Each voxel in the
density map can be assigned to one of the classes in C. Similar to an intensity
vector, we therefore deﬁne a class label vector

l=(l1,l2,...,lN) (2)

where l,- GC is the class label of voxel i. Whereas the intensity vector f is
known, the class label vector 1 is unknown and to be inferred. The task
of identifying recurrent patterns in a density map is therefore equivalent to
determining the class label vector leﬁ. To achieve this goal, we apply a
two—step procedure, combining a heuristic approach generating an initial

u I I u I u r 1 u r 1 I I u u I u r 1 u r 1 I I

 

Fig. 2. Neighborhood volumes deﬁned as a series of concentric shells around
voxel location x,- for voxel i e T. Schematic view of a 2D grid with individual
voxels shown as dark grey dots. Concentric shells are constructed that are
centered at xi. The largest radius is deﬁned as R. All radii are deﬁned as
rj =jR/M, with M as the maximal number of shells. A neighborhood volume
Vj(x,-)={ke’7':rj_1 < ||xk —x,-|| grj} is deﬁned as all voxels that fall into
a concentric shell deﬁned by two radii, rj_1 and rj with rj_1 <rj. As an
example, the neighborhood shell V10(x,-) is shown in light grey, deﬁned as
the set of voxels located between radii r9 and r10.

tomogram classiﬁcation with a subsequent reﬁnement using a statistical
inference method that maximizes the joint probability of the class assignment
1 and the intensity f.

2.2 Initial tomogram classiﬁcation

The goal of the following section is to deﬁne an initial class label vector
1, which serves in a later step as an input in the GHMRF—based reﬁnement
process.

2.2.] Identiﬁcation of segmented objects. First, Gaussian ﬁltering is
applied to generate a blurred density map fblur reducing the inﬂuence of
noise in the segmentation. Then a seed growth approach is adapted from the
watershed segmentation (Dougherty, 1993) as follows. All local intensity
maxima in the ﬁltered map are identiﬁed. Local maxima with low intensity
values are likely a result of noise and are discarded. The remaining local
maxima with high intensity voxels are used as seeds for an extended
watershed segmentation procedure. During the seed growth segmentation,
a voxel rank r is introduced that captures the order at which voxels are
included to a region. A segmented region SS is deﬁned, where the watershed
algorithm is terminated at a given voxel rank rim". Let vw be a speciﬁc
voxel index, of segment s and voxel rank r, then the set of voxels in a region
of segmented object SS is deﬁned as

Ss={Vs,rlr=17- rmax} 

.., S

such that f3}? 3 . .. 3 fbh“ for all s. Note that the ﬁltered tomogram is only

V§,r§11ax
used to identify the indices of voxels in the segmented objects. Classiﬁcations
are performed using the unﬁltered intensity values of these voxels.

2.2.2 Rotation-invariant feature vectors. To introduce an efﬁcient way
to compare the similarities between all the distinct objects, we introduce
rotation—invariant feature vectors (Kazhdan et al., 2003; Saha et al., 2010;
Xu et al., 2009).

Rotation—invariant feature vectors p(x,-) describe the intensity distribution
of the tomogram in the neighborhood of a voxel located at xi. To construct
a feature vector at the voxel location xi, we divide the neighborhood of the
voxel x,- into M concentric shells (Fig. 2)

{l/j(x,-):j=1,2,...,M}. (4)

where Vj(x,-) is deﬁned as the set of voxels that fall into the concentric
shell centered at x,- and is deﬁned by the two radii rj_1 and rj, where with
rj =jR/M and R is the largest chosen radius. If a concentric shell Vj(x,-) is thin

 

i7O

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Template-free complex detection in tomograms

 

(i.e. rj+1 — rj % voxel length), then the voxel intensities f (xk) with k e Vj(x,-)
can be approximated by a spherical function g that is deﬁned on the surface
of a sphere in spherical coordinates.

f(Xk)lVJ-(x,-) % f(rcos¢ sin6, rsingb sin6, rcos6)

= g(9a <15) (5)
where r: W, and 6, q) are the colatitude and longitude angles,
respectively. g can then be approximated by a sum of its spherical harmonics
(Hobson, 1931):

L l
gwa 2 at... war» (6)
[=0 m=—l
where L is a given bandwidth, and am is a coefﬁcient associated with the
complex spherical harmonics function Y m, which is independent to g.
Based on such a decomposition, the intensity distribution of all the voxels
in shell Vj(x,-) can then be described by a set of L rotation—invariant features
{sjlllz 1,...,L}(Kazhdan et al., 2003) as follows:

I
Z alez’“

m=—l

(7)

Sjl =

 

 

 

 

2

Such features are calculated for all the M shells. The rotation—invariant
description of the density distribution around the location of a voxel x,- is
then deﬁned by the following feature vector:

p(x,-)=(sjl,lj=l,...,M;l=l,...,L) (8)

whose elements consist of the ordered sequence of Sjl for all consecutive
shells {l/j(x,-)| :j=1,...,M}. These feature vectors are rotation invariant,
which means that they are independent of the relative orientation of the local
density distribution. Therefore, feature vector—based similarities between
density regions can be calculated even if these regions are at different relative
orientations to each other. Previously, we have shown that such rotational
invariant features are also robust against noise in maps (Xu et al., 2009).

2.2.3 Comparing the similarity of segmented objects. The goal is to
cluster segmented objects based on their feature vector dissimilarity. The
dissimilarity 00, b between objects a and b is deﬁned as one minus the fraction
of voxels with similar feature vectors in both objects 5,, and Sb.

sim
NSa , 

Nggt+zvggt (9)

oaab = 1 —
where Ngimsb is the number of similar feature vectors that appear both in
objects 5,, and Sb.

Ngjffgb = |{i:i€ TﬂSa, Elj esthFaH
+|{i:ie’rhsb,3jes,,m\ffea}| (10)

M” is the set of feature vectors that are most similar to feature vector i,
l
but are located s atiall a art from i in the tomo ram. N m and N W are the
P Y P g S, Sb

total number of feature vectors in 50 and Sb, respectively. N $1le is the sum
of the total number of feature vectors in object a for which a similar feature
vector exists in object b and the number of feature vectors in b with a similar
feature vector in a.

To determine Mfea, the voxels in the tomogram are clustered based
on the Euclidian distance between their feature vectors. Cryo electron
tomograms are generally so large that not all feature vectors can be
stored in computer memory at the same time. We, therefore, employ a
large—scale clustering technique, (BIRCH) (Harrington and Salibian—Barrera,
2008; Zhang et al., 1997). The clustering cutoff is chosen heuristically by
sampling the similarities between randomly selected feature vectors. Good
performances have been achieved when the cutoff comprises the top 5% of
sampled feature vector similarities. Then all voxels are detected that are in the
same cluster but are apart in grid space so that they are not direct neighbors

in the tomogram. For each voxel i in each cluster A a voxel set is deﬁned as
U,- = {k: ||xk —x,-|| > rd,k EA}, where rd is a predeﬁned grid distance.

It is computationally beneﬁcial to restrict Mfea to only a ﬁxed number of
the closest voxel neighbors. Here, Mfea is deﬁned as the subset of U ,- with the
20 voxels whose feature vectors are most similar to the feature vector of i.
Slight variations of this number do not affect the outcome of our calculations.

2.2.4 Clustering of segmented objects. Next, all segmented objects are
clustered using hierarchical clustering with the dissimilarity measure 001,.
The clustering cutoff is determined as the global minimum in a penalty
function that seeks to simultaneously minimize the number of clusters and
the variation within each cluster according to Kelley et al. ( 1996). All objects
in the same cluster deﬁne the same frequently occurring density pattern.
Because we are only interested in frequently occurring patterns clusters with
less than three objects are discarded. The number of all density pattern classes
C is then deﬁned as the number of all clusters n and a ‘background’ class,
which comprises all the voxels in the tomogram that are not part of any
segmented object. All the voxels in objects that are part of the same cluster
are assigned to the same class label l e C, with C = {1,2, ...,n}. All remaining
voxels in the tomogram are assigned to the background class.

The assignment of all the voxels to the pattern classes deﬁnes the class
label vector l=(l1, ...,lN), which is the initial classiﬁcation of the tomogram
and serves as input information for a reﬁned reclassiﬁcation described in the
following section.

2.3 Classiﬁcation reﬁnement by Gaussian Hidden
Markov Random Field Model

In this section, the initial classiﬁcation is reﬁned using an GHMRF
model. In the GHMRF framework, class labels are not directly observable
variables and are modeled as a hidden random ﬁeld. The class labels are
determined by maximizing the joint probability P(l,f) of class labels 1
and the intensity vector f. GHMRF has been used for image analysis
and segmentation (Li et al., 2009; Zhang et al., 2001). Here, we apply and
extend the method to 3D density maps for the classiﬁcation of frequently
occurring macromolecular complexes in cryo electron tomograms.

2.3.1 Gaussian Hidden Markov Random Field Model. In the GHMRF
framework, the voxel labels are modeled as a hidden random ﬁeld. Their
conditional independence follows the Markov property and can be described
by an undirected graph where each node corresponds to a voxel.

P(ltll)=P(ltllN,-) (11)
where ZN, = {ljl‘v’j 61%} are the labels of neighbor voxels of i.

In standard GHMRF models, the voxel neighborhood is deﬁned by
an undirected graph with voxels as vertices and edges as the cubic grid
connecting the vertices (Fig. 3). In our method, this graph is augmented by
additional edges between those voxels that share similar feature vectors but
are at far distance in the tomogram grid. In other words, for a given voxel i, its
neighborhood list JV,- includes all direct grid neighbors in the tomogram and
all voxels that have a similar density environment even if they are located
at far distance (Fig. 3). By augmenting the list of grid neighbors, we are
able to connect those voxels in the graph that have the same class label,
even if these voxels are part of different copies of the same complex located
at different regions of the tomogram. The neighborhood JV,- of voxel i is,
therefore, deﬁned as

M :Mea UMmaP 
where Mmap is the set of all voxels that are adjacent to i in the tomogram
grid and Mfea is the set of voxels that have similar feature vectors.

Voxel intensities f,- form an observable random ﬁeld. Given the class label
l,- =l, the voxel intensity fl- is assumed to follow a conditional probability
distribution

P03|li=l)=q>03;ﬂl,01) (13)
where (130“; mpg) denotes Gaussian distribution with mean u; and SD 0;
that are speciﬁc to class label Z. In addition, given one instance of l, the

 

i71

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

M.Xu et al.

 

Dbsewabie random ﬁeld f—--.fﬁ-__,r_'~_..._r'~.,r
O O O
O O O

 

Hidden random ﬁeld r-,*l.-.r:,_._rt-,r

Fig. 3. Gaussian Hidden Markov Random Field. GHMRF with observable
intensity random ﬁeld (above in red) and hidden class random ﬁeld (below in
blue). In the hidden ﬁeld, the Markov property graph is deﬁned by the direct
neighbors of voxels in the grid (grey connections, for simplicity only a 2D
grid is shown) and also by voxels with similar feature vectors (green dotted
connections) (i.e. a green connection is formed if two voxels are deﬁned as
neighbors in the feature space).

intensities f are assumed to be conditionally independent.

p(fll)= Hpmilt) (14)
ieT

2.3.2 Iterative optimization method for voxel classiﬁcation. The voxel
re—classiﬁcation is formulated as a maximization problem:

I=argmax{P(f,l; (9)} (15)
L0

I is the best estimation for the true class label vector. P(f,l) is the joint
probability of the intensities f and class labels 1, where 6={ul,ol} is
the collection of mean and SD parameters for the intensity values of
the voxels in each of the pattern classes. To perform the maximization,
we use an iterative approach (Zhang et al., 2001) that consists of two
steps. First, for a given estimation of the parameter set 0“) at iteration
t, a classiﬁcation is performed to obtain updated class labels I0“). Then
expectation maximization determines the optimal parameter set 9“ +1) given
I0“) obtained from the ﬁrst step.

Step I: classiﬁcation.

Given 9“), we want to obtain

IO“) = argmax{P(f, 1)}
leﬁ
=argmin{—logP(f,l)} (16)
leﬁ

According to Zhang et al. (2001), the minimization problem can be
formulated as

l(t+1)=argmin{U(f|l)+ U(l)} (17)
l
with the energy functions
(0 2
0“- — u . )
U(fil>=Z # +Iog(a§f)) (18)

(I)
1.7 2w. >2

and

U(l)=ZVC (19)

CEK

where K is the set of all cliques on the graph. Following Zhang et al.
(2001), we choose V =—8;ilj, where 8 is the Kronecker delta function.
Calculating the global minimum of Equation (17) is computationally
infeasible. However, because both U (f ll) and U (1) can be expanded into sums
over all voxels i ET, the optimal solution can be approximated using the
iterated conditional modes (ICM) algorithm (Besag, 1986), which is popular
in solving such optimization problems. This method optimizes U(l,- |lT\{i} , f)
for each ie T, while keeping all other labels 17W} ﬁxed.

Step 2: Expectation maximization for model ﬁtting.
The expectation maximization method updates parameters 6 by maximizing
the conditional expectation

90+” 2 argmaxE[logP(f, l|6) | f; 60)] (20)
6

Following Zhang et al. (2001), new parameters are estimated as

“0+0: ZieTP(li:llf;6(t))ﬁ

 

 

 

l z,€TP(z,-=z|f;e<t>) (21)
and
COM): ZteTP(z.-=zif;e<t>)oe—tt§”)2 (22)
l z,€TP(z,-=z|f;e<t>)
where
P(li=l|f;9(t))= q) “Mia’U’Ub'PUizlllW (23)

p(ft)
Following Li (2009) and given the class labels ZN, obtained from the
classiﬁcation step, the probability for a voxel i to be assigned to class label
l is calculated as

[1+Zi/6Ni 51.11)]

P(li=l|lM)= [1+Zi/6Ni81/Ji/]

(24)
Vng
The iterations between expectation and maximization step are repeated until
convergence is reached, leading to the newly reﬁned class label vector 1.
Finally, a class label can be deﬁned for each object as the label that
is assigned to the majority of voxels in the object. The classiﬁcation
performance is increased, if all the voxels with labels different to the
corresponding object label are reassigned to the background class.

2.4 Generating simulated cryo electron tomograms

For a reliable assessment of the method, tomograms must be generated by
simulating the actual tomographic image reconstruction process, allowing
the inclusion of noise, tomographic distortions due to missing wedge
and electron optical factors such as contrast transfer function (CTF) and
Modulation Transfer Function (MTF) (Fig. 4).

We follow a previously applied methodology for simulating the
tomographic image formation mechanism as realistically as possible (Beck
et al., 2009; F6rster et al., 2008; Nickell et al., 2005).The electron optical
density of a macromolecule is proportional to its electrostatic potential and
the density map can be calculated from the atomic structure by applying
a low pass ﬁlter at a given resolution. Here, density maps are generated
at 4nm resolution using the PDB2VOL program of the Situs 2.0 package
(Wriggers et al., 1999) with voxel length of lnm. These initial density
maps are then used as samples for simulating electron micrograph images
at different tilt angles. In cryoET, the sample is tilted in small increments
around a single—axis. At each tilt angle, a simulated micrograph is generated
from the sample. We set the tilt angle rotating from —70 to 700 with steps
of 2°, which is a typical procedure for experimental tomograms. As a result,
our data contains a wedge—shaped region in Fourier space for which no
data have been measured (missing wedge effects), similar to experimental
measurements. The missing wedge effect leads to distortions of the density
maps along the tilt—axis. To generate realistic micrographs, noise is added to
the images and the resulting image map is convoluted with a CTF, which
describes the imaging in the transmission electron microscope in a linear
approximation. Any negative contrast values beyond the 1st zero of the CTF
are eliminated. We also consider the MTF of a typical detector used in whole
cell tomography, and convolute the density map with the corresponding MTF.
The CTF and MTF describe distortions from interactions between electrons
and the specimen and distortions due to the image detector (Frank, 2006;
Nickell et al., 2005). Typical acquisition parameters that were also used
during actual experimental measurements of whole cell tomograms (Beck
et al., 2009) were used: voxel grid length =1 nm, the spherical aberration:
2 x 10—3 m, the defocus value = —4 x 10—6m, the voltage 2 200 kV, the MTF

 

i72

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Template-free complex detection in tomograms

 

A no noise and
distortion

    

SNR = inﬁnity

Fig. 4. Simulated electron tomograms including missing wedge effects, CTF
and MTF for a tomogram at different SNR levels. (A) Contour volume
representation of the tomogram and (B) a slice through x—y plane of the
tomogram (top panel) and a slice through the x—z plane of the tomogram
(bottom panel).

corresponded to a realistic electron detector (McMullan et al., 2009), deﬁned
as sinc(7w) / 2) where a) is the fraction of the Nyquist frequency.

Finally, we use a backprojection algorithm to generate a tomogram from
the individual 2D micrographs that were generated at the various tilt angles
(Beck et al., 2009). To test the inﬂuence of increasing noise, we add different
amount of noise to the images, so that the SNR levels range between 5 and
0.5, respectively (Fig. 4).

2.5 Benchmark set

The classiﬁcation is tested on simulated tomograms containing 40 complexes
of four different classes (Fig. 4). To assess bias arising from speciﬁc
combinations of complexes, a set of 24 types of complexes of variable sizes
were selected from the PDB databank (Fig. 5). From this pool, 52 benchmark
sets were generated that each contained four randomly chosen types of
complexes. To generate a tomogram for each of these combinations, 10
instances of each complex were randomly oriented and placed into a grid of
size 150 nm>< 150 nm>< 100 nm (Fig. 4). For two of the 52 benchmark sets (set
1 and set 2), 50 independent density maps were generated each with randomly
placed complexes. For each density map, a tomogram was simulated at four
different signal—to—noise ratios (SNR=0.5, 0.1, 5, 00) (Fig. 4) leading to a
total of 200 simulated tomograms per set. Set 1 contains GroEL [1KP8],
heat—shock protein ACRl [2BYU], carboxipeptidase [2BO9] and propionyl—
CoA carboxylase [lVRG] (PDB ID in squared brackets). Set 2 contains
ornithine carbamoyltransferase [IAIS], octomeric enolase[1W6T], RNA
polymerase [2GHO] and ClpP [1YG6]). For the remaining 50 benchmark
sets of complexes, tomograms were generated at SNR: 0.5.

2.6 Analysis

For the simulated tomograms, l is compared to the known ground truth 1th.
A true positive match is deﬁned when a voxel’s predicted class label l,- is
identical to the true class label lit-me. To assess the performance, the precision
and recall of the classiﬁcation is calculated. The precision is a measure of
exactness deﬁned as the fraction of the correctly predicted voxels,

, , #TP
prec1s1on = — (25)
#TP+#FP
where #TP is the number of true positives and #TP+#FP is the total number
of voxels with the same class labels. The recall is a measure of completeness
deﬁned as the number of true positives divided by the total number of voxels
of that class in the ground truth.

#TP
recall: — (26)
#TP+#FN

where #FN is the number of false negatives, i.e. the number of voxels that
were not identiﬁed as class members. In addition, the precision and recall
for classifying segmented objects is calculated. Here, class labels are deﬁned
for complexes (i.e., segmented objects) instead of individual voxels.

3 RESULTS

First, we analyze the effectiveness of the rotation-invariant feature
vectors in detecting pattern similarities in a tomogram. Then we
describe the performances of the initial pattern classiﬁcation and
the reﬁned pattern classiﬁcation based on the GHMRF approach.

3.1 Analysis of feature vectors

We now determine the locations of the most unique feature vectors
in a complex. For each of the 24 benchmark complexes, a simulated
density map is generated at 4 nm resolution (Wriggers et al., 1999)
and its rotation-invariant feature vectors are calculated. For each
voxel in a complex, the distance is calculated between its feature
vector and all the feature vectors in the other complexes. For
each of the 24 complexes, the minimum distance is determined.
For the given voxel, the average of all minimum distances is a
measure of the feature vector’s uniqueness with respect to the
feature vectors in all the other complexes. The average minimum
distance correlates strongly with the position of the voxel from
the mass center of the complex (average Pearson’s correlation
—0.68:l:0.05). Voxels at the complex center have feature vectors
that are most different from those in other complexes and are
therefore most discriminative for classiﬁcation purposes (Fig. 5).
Moreover, larger complexes have generally a greater number of
unique feature vectors (Fig. 5). These ﬁndings provide an important
guide for increasing accuracy and computational efﬁciency of the
method. Instead of processing all feature vectors in a tomogram,
one should focus only on those vectors that are located at the
central regions of a complex. Considering only the most informative
feature vectors will not only increase the accuracy of the method
but also greatly increase the computational efﬁciency and reduce
the necessary computational memory consumption. Noise and
distortions in a map will reduce the number of unique feature vectors,
however, also then the central regions are most discriminative for
classiﬁcation. Accordingly, the similarity between the segmented
objects in a tomogram is calculated by using only its central core
regions.

3.2 Parameter deﬁnition

The classiﬁcation accuracy is increased, if the similarity between
segmented objects is calculated from their core regions. Here, the
core region is set to be 500 nm3 and is deﬁned by the termination
of the adapted watershed algorithm after 500 voxels are selected:
Sgore 2 {vs, r | r = l, ..., r?“ = 500}. The good performance for using
a ﬁxed rather than a relative sized core region is presumably a result
of the limited size range of soluble complexes in a cell, which ranges
typically up to N 2700 nm3 (ribosome) with a mean of N 656 nm3 in
our sample. A slight variation of the core region size does not change
the outcome of our analysis. However, using more extended regions
will not improve but often decrease the classiﬁcation accuracy while
reducing computational efﬁciency signiﬁcantly.

 

i73

112 /310's112u1nofp101x0'sor112u1101urorq//:d11q 11101; pap1201umoq

9IOZ ‘OE lsnﬁnv uo ::

M.Xu et al.

 

ZREC WEE

lADl‘tl

Fig. 5. Average minimum feature vector distance maps. Contour level plot
of the average minumum feature vector distance maps for 24 complexes. The
value assigned to each grid voxel in a map is the average minimum distance
between its feature vector and the feature vectors in the density maps of all
the other complexes. The contour plane contains the maximal value. Colors
are based on a rainbow scheme with red as the maximum and blue as the
minimum values. The PDB ID of each complex structure is also shown.

 

Table 1. Voxel—and object—based classiﬁcations of benchmark set 1 for
tomograms at four different SNR levels

 

Initial GHMRF

 

SNR Precision Recall Precision Recall

 

Voxel—based classiﬁcation

 

oo 0.44 (0.07) 0.54 (0.07) 0.54 (0.10) 0.60 (0.10)
5 0.43 (0.07) 0.53 (0.08) 0.58 (0.10) 0.63 (0.11)
1 0.42 (0.08) 0.52 (0.09) 0.55 (0.09) 0.60 (0.10)
0.5 0.39 (0.08) 0.50 (0.08) 0.44 (0.10) 0.50 (0.10)
Object—based classiﬁcation
00 0.68 (0.09) 0.68 (0.09) 0.76 (0.10) 0.76 (0.10)
5 0.67 (0.12) 0.67 (0.12) 0.76 (0.13) 0.76 (0.13)
1 0.68 (0.13) 0.68 (0.13) 0.77 (0.13) 0.77 (0.13)
0.5 0.65 (0.11) 0.65 (0.11) 0.71 (0.10) 0.71 (0.10)

 

For each SNR level, 50 tomograms are generated. Each tomogram consists of 40
complexes of four different types. Values are the mean precision and recall for the
set of 50 classiﬁcations with standard deviations (SDs) shown in brackets.

While the object similarities are determined from the core regions
(Score), the determined class labels are assigned to all voxels in an
extended region S?“ = {vwlr = 1, . . . , r§nax = 2000}.

3.3 Classiﬁcation performance

We now analyze the performance of the method and distinguish
between the assessment of individual voxels and segmented objects.
In addition, the performance is analyzed with respect to different
combinations of complex types and their relative placements in the
tomograms.

3.3.] Voxel-based classiﬁcation. To compare the inﬂuence of
noise, we have generated 50 tomograms for four different SNR
levels (Tables 1 and 2). For benchmark set 1, the average precision
of the initial classiﬁcation is 0.44 with an average recall of
0.54 for tomograms without noise. With increasing noise levels,

Table 2. Voxel—and object—based classiﬁcations of benchmark set 2 for
tomograms at four different SNR levels

 

Initial GHMRF

 

SNR Precision Recall Precision Recall

 

Voxel—based classiﬁcation

 

oo 0.50 (0.16) 0.72 (0.17) 0.72 (0.14) 0.84 (0.16)
5 0.45 (0.18) 0.68 (0.19) 0.72 (0.18) 0.79 (0.20)
1 0.30 (0.18) 0.53 (0.18) 0.52 (0.21) 0.57 (0.22)
0.5 0.31 (0.15) 0.54 (0.16) 0.51 (0.19) 0.56 (0.20)
Object—based classiﬁcation
00 0.85 (0.19) 0.85 (0.19) 0.91 (0.12) 0.91 (0.12)
5 0.79 (0.22) 0.80 (0.22) 0.87 (0.15) 0.87 (0.15)
1 0.61 (0.23) 0.61 (0.23) 0.70 (0.17) 0.71 (0.17)
0.5 0.58 (0.20) 0.59 (0.20) 0.64 (0.16) 0.65 (0.16)

 

For each SNR level, 50 tomograms are generated. Each tomogram consists of 40
complexes of four different types. Values are the mean precision and recall for the
set of 50 classiﬁcations with SDs shown in brackets.

the performance reduces to 0.39 and 0.5 for the precision and
recall, respectively. As expected, the GHMRF model improves
signiﬁcantly the precision and recall. For tomograms with the
highest noise level, the average precision is improved from 0.39
to 0.44 in comparison to the initial classiﬁcation (Table 1 and
Fig. 6). These observations indicate that about 40% of all voxels
can be predicted as members of the correct pattern class, even when
signiﬁcant noise and distortions are present in the tomogram. This
excellent performance is in a similar range as classiﬁcations based
on template matching.

For benchmark set 2, precision and recall for the initial
classiﬁcation is substantially higher for tomograms with low noise
levels in comparison to set 1. However, the initial classiﬁcation
is more affected by noise in the tomogram in comparison to
benchmark set 1. The differences in performance presumably reﬂect
the variable number of unique feature vectors in different complexes.
The average precision decreases from 0.5 for tomograms without
noise to 0.31 for tomograms with an SNR level of 0.5 (Table 2).
Again, the GHMRF model improves the performance dramatically,
in particular for tomograms with high noise levels. For tomograms
with the highest noise level, the precision is improved from 0.31 to
0.51 in comparison to the initial classiﬁcation (Tables 1 and 2). As a
statistical inference method the GHMRF—based reﬁnement appears
more robust against the distortions in the tomogram due to missing
wedge, electron optical factors and increasing noise levels.

To further test different combinations of complexes, 50 additional
sets of randomly chosen complexes were tested. For all of these sets,
tomo grams were generated with SNR of 0.5. The average precisions,
recall and their SDs are very similar to those of sets 1 and 2 [voxel—
based GHMRF classiﬁcation, averaged over all sets: precision
0.45 (0.12), recall 0.51 (0.12); object—based GHMRF classiﬁcation:
precision 0.62 (0.14), recall 0.62 (0.14)] (Supplementary Table S1).

3.3.2 Object-based classiﬁcation Assessment of the classiﬁ—
cation can also be performed based on segmented objects rather
than individual voxels. A true positive match is then deﬁned
if a segmented object is classiﬁed correctly even if not all of

 

i74

112 /3.IO'S[BU.IHO[p.IOJXO'SOIZIBIIIJOJUIOIQ/ﬁdllq 111011 pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

Template-free complex detection in tomograms

 

A Initial GHRMF Drlginal
Classiﬁcation Classification Sample

 a u

B Uriginal Sample GHRMF Based Prediction

Tomograrn

I-I

 

. k -1. I
1" I- 'd .- ..L' J] H
'II' _ _ u d I
(J t--' A" Jr} ' #-
‘J Rn.“ .. .4, ._ a
H ‘4' s- s
1" Ia: -
5 “Class 1 Class 2 Class 3-3 Class 3 - lo Class 4
i j '"I a .I I1.-
- E I"
w J
:‘E E Jr ,4.- "" _._'-rr "
E E T - .1
a"? e.
— |__ u"
u " -- - . '-
g Floss 1 q Class 2 Class 3-a Class 3 - b Class at
= .I‘ . ..
LI. '5 .J k.
u
E E r -"' '— T In" I.
I In "" 1.
in J E.
E _. ._ .
U ~' _ .
mass 1 d Glass 2 Class 3. Class 4
T: E - -- ' " e I
E n f "I v + H
m E I _ “fun.
I: '5 ..
D W “I O u-
s H a ‘I

Fig. 6. (A) (Left panel) Initial classiﬁcation for a density region that contains
a proteasome complex (blue color). It is evident that the proximity of the
complex contains voxels that are false classiﬁed as being part of another
complex class (grey color). (Middle panel) After GHMRF—based reﬁnement,
most of the voxels assigned to the second complex class have been removed.
(Right panel) Original density map of the proteasome complex at 4nm
resolution, shown without noise, missing wedge, CTF and MTF distortions.
(B) Classiﬁcation for a tomogram of set 1: left panel shows the initial density
map of the sample collection of four different types of complexes, each with
10 copies. (middle panel) Based on this sample a tomogram is simulated
with an SNR of 0.5. (Right panel) The GHMRF—based classiﬁcation
discovers several sets of recurrent density patterns that represent the
different complexes in the sample. (C) (Top panel) The initial classiﬁcation
discovers ﬁve different classes of patterns, each containing several instances.
(Middle panel) The GHMRF—based reclassiﬁcation improves the predictions
considerably. (Lower panel) The four different classes of complexes in the
initial dataset. It is evident that complexes in class 3 have been divided into
two classes in the GHMRF—based classiﬁcation. However, all complexes
classiﬁed to the same class are identical. (The selected example shows an
average classiﬁcation performance.)

its voxels are detected. The object—based classiﬁcation further
improves precision and recall of the classiﬁcations (Tables 1 and 2).
The average object—based precision for GHMRF classiﬁcations
of tomograms without noise is 0.76 and 0.91 for sets 1 and 2,
respectively. The corresponding average recall is 0.76 and 0.91. For
set 2, the average precision at the highest noise level is 0.64 with
a recall of 0.65, showing that >60% of all segmented objects were
detected correctly.

3.3.3 Inﬂuence of the object placement. To assess the inﬂuence
of the object placement, 50 different tomograms were generated for
sets 1 and 2. The classiﬁcation results are robust with the SDs for

Table 3. The number of classes (excluding the background class) detected
in 50 tomogram classiﬁcations of set 1 (Table 1)

 

 

Classes 2 3 4 5 6 7 8 9
SNR oo 0 0 3 15 19 11 2 0
5 1 2 7 11 16 10 3 0
1 0 3 4 18 12 9 3 1
0.5 0 1 9 17 14 9 0 0

 

Each of the 50 tomograms contains 40 randomly placed and oriented protein complexes
of four different classes.

the average precisions of about 0.1—0.2 for the initial and GHMRF—
based classiﬁcations at all noise levels (Tables 1 and 2). SDs for the
average object—based precisions are in a similar range.

3.3.4 Class member similarity. There are generally two main
reasons why some voxels are not correctly classiﬁed. First, voxels
are unclassiﬁed and part of the background class (see class 4 in
Fig. 6C). Second, identical complexes are sometimes grouped in
two or more classes instead of a single class (Table 3, Fig. 6C). For
instance, for the majority of tomograms in set 1, ﬁve instead of four
recurrent classes have been identiﬁed (Table 3). In one example, the
identical complexes of the class 3 were divided into two different
groups after classiﬁcation (see classes 3a and b in Fig. 6C). Although
the complexes in the additional class are counted as false positives,
all the members in the class are indeed identical complexes in this
example. In general, for low noise levels N 96% and for high noise
levels ~91% of the complexes in the same class are of the same
type. It is, therefore, possible to align the subtomograms of these
complexes in each class and generate an average density map of the
complex with improved SNR. It may then be possible to identify
sufﬁcient similarities among the class—averaged density maps to
redeﬁne them to the same class.

4 CONCLUSIONS

We have introduced an inference—based template—free method for
the detection and classiﬁcation of frequently occurring protein
complexes in tomograms. We have assessed our method on
realistically simulated cryo electron tomograms at 4 nm resolution,
which contain noise and distortions due to missing wedge and
electron optical factors. Our method relies on an initial classiﬁcation,
which uses rotation—invariant feature vectors to provide an efﬁcient
way to calculate the similarity between segmented objects. This
initial classiﬁcation is further reﬁned using an GHMRF model,
which is less prone to noise and distortions and therefore improves
the initial classiﬁcation signiﬁcantly. Indeed, for tomograms with
an SNR of 0.5, between 44% and 51% of all voxels and
between 64% and 71% of all segmented objects are classiﬁed
correctly. Misclassiﬁcation is mainly due to the grouping of identical
complexes into separate classes. Importantly, more than 91% of
complexes assigned to the same class are identical even at high
noise levels. These results are encouraging and demonstrate that in
principle it is possible to discover new complexes in cryo electron
tomograms in an efﬁcient manner.

The current work represents a ﬁrst proof—of—principle of the
method. Future improvements will focus on optimizing the method
toward higher concentrations of complexes to levels observed in the

 

i75

112 /810's112u1nofp101x0'sor112u1101urorq//zd11q 111011 pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

M.Xu et al.

 

crowded cell cytoplasm. Moreover, a number of limitations to visual
proteomics might be overcome by further technical developments.
In future, it may be possible to improve the moderate SNR level
in cryoET, for instance, by improving the contrast in tomograms
through phase plates (Murata et al., 2010). Furthermore, specimen
thinning techniques through focused ion beams (Murata et al.,
2010) will be crucial for improving SNR and imaging larger cell
types, such as eukaryotic cells. Finally, direct electron detection
systems promise to largely improve SNR of cameras (Murata et al.,
2010), which will be highly beneﬁcial for cryoET. In summary, our
results demonstrate the detection of frequently occurring complexes
in tomographic maps, even at low SNR levels and without the
need of available template structures. Our method can facilitate the
discovery of new complexes in cryo electron tomograms. This task
provides a step toward unbiased visual proteomics of cells, which
aims to discover the shapes, abundance and spatial distributions of
all large protein complexes in a cell.

ACKNOWLEDGEMENTS

The authors thank Dr. Shihua Zhang for his valuable suggestions
and discussions.

Funding: Human Frontier Science Program (RGY0079/2009—C to
F.A.); National Institute of Health (NIH) (1R01GM096089 and
2U54RR022220—06 to RA), Alfred P. Sloan Research foundation
(to RA); EA. is a Pew Scholar in Biomedical Sciences, supported
by the Pew Charitable Trusts.

Conﬂict of Interest: none declared.

REFERENCES

Alber,F. et al. (2008) Integrating diverse data for structure determination of
macromolecular assemblies. Ann. Rev. Biochem, 77, 443.

Beck,M. et al. (2009) Visual proteomics of the human pathogen Leptospira interrogans.
Nat. Methods, 6, 817—823.

Beck,M. et al. (2011) Exploring the spatial and temporal organization of a cell’s
proteome. J. Struct. Biol, 173, 483496.

Besag,J. (1986) On the statistical analysis of dirty pictures. J. R. Stat. Soc. Ser. B, 48,
259—302.

Best,C. et al. (2007) Localization of protein complexes by pattern recognition. Methods
Cell Biol, 79, 615—638.

Bohm,J. et al. (2000) Toward detecting and identifying macromolecules in a cellular
context: template matching applied to electron tomograms. Proc. Natl Acad. Sci
USA, 97, 14245.

D0ugherty,E. (1993) Mathematical Morphology in Image Processing. CRC Press, Inc.,
Boca Raton, FL. USA.

Forster,F. et al. (2008) Classiﬁcation of cryo-electron sub-tomograms using constrained
correlation. J. Struct. Biol, 161, 276—286.

Frangakis,A. et al. (2002) Identiﬁcation of macromolecular complexes in cryoelectron
tomograms of phantom cells. Proc. Natl Acad. Sci. USA, 99, 14153.

Frank,J. (2006) Three-dimensional Electron Microscopy of Macromolecular
Assemblies: Visualization of Biological Molecules in Their Native State. Oxford
University Press, USA.

Han,B. et al. (2009) Survey of large protein complexes in D. vulgaris reveals great
structural diversity. Proc. Natl Acad. Sci. USA, 106, 16580.

Harrington,J. and Salibian-Barrera,M. (2008) Finding approximate solutions to
combinatorial problems with very large data sets using BIRCH. Comput. Stat.
Data Anal.

Hobson,E. (1931) The Theory of Spherical and Ellipsoidal Harmonics. Cambridge,
England.

Kazhdan,M. et al. (2003) Rotation invariant spherical harmonic representation of 3D
shape descriptors. In Proceedings of the 2003 Eurographics/ACM SIGGRAPH
symposium on Geometry processing, Eurographics Association Aire-la—Ville,
Switzerland, Switzerland, pp. 156—164.

Kelley,L. et al. (1996) An automated approach for clustering an ensemble of nmR-
derived protein structures into conformationally related subfamilies. Protein Eng.
Des. Sel, 9, 1063.

Li,G. et al. (2009) Automatic cortical sulcal parcellation based on surface principal
direction ﬂow ﬁeld tracking. NeuroImage, 46, 923—937.

Li,S. (2009) Markov Random Field Modeling in Image Analysis. Springer, New York,
USA.

Lucic,V. et al. (2005) Structural studies by electron tomography: from cells to molecules.
Biochemistry, 74, 833.

McMullan,G. et al. (2009) Detective quantum efﬁciency of electron area detectors in
electron microscopy. Ultramicroscopy, 109, 1126—1143.

Medalia,O. et al. (2002) Macromolecular architecture in eukaryotic cells visualized by
cryoelectron tomography. Science, 298, 1209.

Murata,K. et al. (2010) Zernike phase contrast cryo-electron microscopy and
tomography for structure determination at nanometer and subnanometer resolutions.
Structure, 18, 903—912.

Murphy,G. and Jensen,G. (2007) Electron cryotomography. BioTechniques, 43,
413—415.

Nickell,S. et al. (2005) TOM software toolbox: acquisition and analysis for electron
tomography. J. Struct. Biol, 149, 227—234.

Saha,M. et al. (2010) MOTIF-EM: an automated computational tool for identifying
conserved regions in CryoEM structures. Bioinformatics, 26, i301.

Tangelder,J. and Veltkamp,R. (2008) A survey of content based 3D shape retrieval
methods. Multimedia Tools Appl, 39, 441—471.

Wriggers,W. et al. (1999) Situs: a package for docking crystal structures into low-
resolution maps from electron microscopy. J. Struct. Biol, 125, 185—195.

Xu,M. et al. (2009) 3D rotation invariant features for the characterization of
molecular density maps. In Bioinformatics and Biomedicine, 2009. BIBM ’09. IEEE
International Conference on, IEEE, Los Alamitos, CA, USA, pp. 74—78.

Zhang,T. et al. (1997) BIRCH: a new data clustering algorithm and its applications.
Data Min. Know. Discov., 1, 141—182.

Zhang,Y. et al. (2001) Segmentation of brain MR images through a hidden Markov
random ﬁeld model and the expectation-maximization algorithm. IEEE Trans. Med.
Imag., 20, 45—57.

 

i76

112 /B.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

