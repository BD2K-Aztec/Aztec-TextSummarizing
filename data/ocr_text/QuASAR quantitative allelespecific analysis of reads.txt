Bioinformatics, 31 (8), 2015, 1235—1242

doi: 10.1093/bioinformatics/btu802

Advance Access Publication Date: 4 December 2014
Original Paper

 

Genetics and population analysis

QuASAR: quantitative allele-specific analysis of
reads

Chris T. Harvey1, Gregory A. Moyerbrailean1, Gordon 0. Davis‘,
Xiaoquan Wenz, Francesca Luca1'* and Roger Pique-Regi1'*

1Center for Molecular Medicine and Genetics, Department of Obstetrics and Gynecology, Wayne State University,
540E Canfield, Scott Hall, Detroit, MI 48201, USA and 2Department of Biostatistics, University of Michigan, Ann
Arbor, MI 48109, USA

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received on August 2, 2014; revised on November 15, 2014; accepted on November 26, 2014

Abstract

Motivation: Expression quantitative trait loci (eQTL) studies have discovered thousands of genetic
variants that regulate gene expression, enabling a better understanding of the functional role of
non-coding sequences. However, eQTL studies are costly, requiring large sample sizes and
genome-wide genotyping of each sample. In contrast, analysis of allele-specific expression (ASE)
is becoming a popular approach to detect the effect of genetic variation on gene expression, even
within a single individual. This is typically achieved by counting the number of RNA-seq reads
matching each allele at heterozygous sites and testing the null hypothesis of a 1:1 allelic ratio. In
principle, when genotype information is not readily available, it could be inferred from the RNA-
seq reads directly. However, there are currently no existing methods that jointly infer genotypes
and conduct ASE inference, while considering uncertainty in the genotype calls.

Results: We present OuASAR, quantitative allele-specific analysis of reads, a novel statistical
learning method for jointly detecting heterozygous genotypes and inferring ASE. The proposed
ASE inference step takes into consideration the uncertainty in the genotype calls, while including
parameters that model base-call errors in sequencing and allelic over-dispersion. We validated our
method with experimental data for which high-quality genotypes are available. Results for an add-
itional dataset with multiple replicates at different sequencing depths demonstrate that OuASAR is
a powerful tool for ASE analysis when genotypes are not available.

Availability and implementation: http://github.com/piquelab/OuASAR.

Contact: fluca@wayne.edu or rpique@wayne.edu

Supplementary information: Supplementary Material is available at Bioinformatics online.

 

1 Introduction

 

Quantitative trait loci (QTLs) for molecular cellular phenotypes (as
defined by Dermitzakis, 2012), such as gene expression [expression
QTL (eQTL)] (e.g. Stranger et al., 2007), transcription factor bind-
ing (Kasowski et al., 2010) and DNase I sensitivity (Degner et al.,
2012) have begun to provide a better understanding of how genetic
variants in regulatory sequences can affect gene expression levels
(see also Gibbs et al., 2010; Gieger et al., 2008; Melzer et al., 2008;

Stranger et al., 2007). eQTL studies in particular have been success-
ful at identifying genomic regions associated with gene expression in
various tissues and conditions (e.g. Barreiro et al., 2012; Dimas et
al., 2009; Ding et al., 2010; Fairfax et al., 2014; Grundberg et al.,
2011; Lee et al., 2014; Maranville et al., 2011; Nica et al., 2011;
Smirnov et al., 2009). Although previous studies have shown an en-
richment for GWAS hits among regulatory variants in lymphoblas-
toid cell lines (LCLs) (Nica et al., 2010; Nicolae et al., 2010), a full

©The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1235

112 [3.10811211an[plOJXO'SODBIILIOJIIlOlQ/ﬂ(11111 wort pepeolumoq

910K ‘09 lsnﬁnV no :2

1236

C.T.Harvey et al.

 

understanding of the molecular mechanisms underlying GWAS hits
requires functional characterization of each variant in the tissue and
environmental conditions relevant for the trait under study (e.g. es-
trogen level for genetic risk to breast cancer, Cowper-Sal-lari et al.,
2012)

The ongoing GTEx project will significantly increase the number
of surveyed tissues for which eQTL data are available and will repre-
sent a useful resource to functionally annotate genetic variants.
However, the number of cell types and environments explored are a
small subset of the presumably larger number of regulatory variants
that mediate specific GxE interactions. eQTL studies are expensive,
requiring large sample sizes (11 > 70), which may be difficult to achieve
for tissues that are obtained by surgical procedures or are difficult to
culture in vitro. Even if biospecimens are readily available at no cost,
eQTL studies require large amounts of experimental work to measure
genotypes and gene expression levels. As the measurement of gene ex-
pression using high-throughput sequencing (RNA-seq) is becoming
more popular than microarrays, RNA-seq library preparation is also
becoming less expensive ($46/sample), whereas costs of sequencing
are also very rapidly decreasing (e.g. 16M reads per sample would
cost $49 using a multiplexing strategy). Additionally, the sequence in-
formation provided by RNA-seq can be used to call genotypes
(Duitama et al., 2012; Piskol et al., 2013; Shah et al., 2009), detect
and quantify isoforms (Katz et al., 2010; Trapnell et al., 2010) and to
measure allele-specific expression (ASE), if enough sequencing depth
is available (Degner et al., 2009; Pastinen, 2010).

ASE approaches currently represent the most effective way to
assay the effect of a cis-regulatory variant within a defined cellular
environment, while controlling for any trans-acting modifiers of
gene expression, such as the genotype at other loci (Cowper-Sal-lari
et al., 2012; Hasin-Brumshtein et al., 2014; Kasowski et al., 2010;
Kukurba et al., 2014; McDaniell et al., 2010; McVicker et al., 2013;
Pastinen, 2010; Reddy et al., 2012; Skelly et al., 2011). As such,
ASE studies have greater statistical power to detect genetic effects in
cis than a traditional eQTL mapping approach when using a small
sample size. Additionally, ASE may also be useful to detect epigen-
etic imprinting of gene expression if ASE is present but no eQTL is
detected (Degner et al., 2009; Seoighe et al., 2006).

In the absence of ASE, the two alleles for a heterozygous geno-
type at a single-nucleotide polymorphism (SNP) in a gene transcript
are represented in a 1:1 ratio of RNA-seq reads. To reject the null
hypothesis and infer ASE, it is necessary to first identify heterozy-
gous SNPs with high confidence and then conduct inference to de-
tect a departure from a 50% allelic ratio. Although genotyping and
ASE are usually considered two separate problems, miscalling a
homozygous SNP as heterozygous is likely to induce an error in re-
jecting the ASE null hypothesis; thus, we argue that the two prob-
lems should addressed together.

Although it is possible to obtain genotype information from
RNA-seq (Duitama et al., 2012; Piskol et al., 2013; Shah et al.,
2009), to the best of our knowledge, all existing methods for detect-
ing ASE consider the genotypes known and error probabilities asso-
ciated with genotyping are not taken into account for the ASE step.
Although overall genotyping quality can also be modeled within the
ASE model (McVicker et al., 2013), there is currently no method
that for each SNP can jointly genotype and detect allelic imbalances
in high-throughput sequencing data. An approach that takes into ac-
count base-calling errors was previously proposed for detecting ASE
in ESTs data (Seoighe et al., 2006), but for RNA-seq data, it is essen-
tial to also include overdispersion. Here, we propose a novel frame-
work for quantitative allele-specific analysis of reads (QuASAR)
that starts from a single or multiple RNA-seq experiments from the

same individual and can directly identify heterozygous SNPs and as-
sess ASE accurately by taking into account base-calling errors and
overdispersion in the ASE ratio. QuASAR is evaluated with two dif-
ferent datasets that demonstrate genotyping accuracy and the im-
portance of incorporating the genotype uncertainty when
performing ASE inference.

2 Materials and methods

2.1 QuASAR approach

QuASAR starts with experimental high-throughput sequencing
data. Here, we focus on RNA-seq, but the same or similar pipeline
can be applied to DNase-seq, ChIP-seq, ATAC—seq or other types of
functional genomics library preparations. Figure 1 illustrates the
underlying problem: detecting SNPs covered by a number of tran-
scripts with high allelic imbalance and for which homozygosity (in
the presence of base-calling errors) can also be rejected.

We focus our attention on sites that are known to be variable in
human populations, specifically we consider all SNPs from the 1000
Genomes project (1KG) with a minor allele frequency (MAF) > 0.02.
We index each SNP with l E {1,. . ., L} and each sample by
s E {1,. . ., S}. All samples are from the same individual and may rep-
resent different experimental conditions or replicates. We only con-
sider SNPs represented in at least 15 reads across all the samples. At
each site 1, three genotypes are possible g, 6 {0,1,2} being homozy-
gous reference (RR), heterozygous (RA) or homozygous alternate
(AA), respectively. For each sample 5 and site I, NSJ represents the
total number of reads and r5] = {rslk H511 take the value 1 if read k
matches the reference allele and 0 if it matches the alternate allele.
We can then model the data D = {{rsl};1 }IL=1 as a mixture model

S L
PI“ (D) =  2 PI“ (Tszlgl)P1‘ (gt) (1)

5=1 [=1 8130,12}

where Pr (g1) represents the prior probability associated with each
genotype. The probability of the observed reads, Pr (r51| g1), depends
on the genotype. For G1: 0:

N51
Pr (r,,,|g, = o; 6,) = H (1 — es)’slke;-’szk (2)
k=1

where we will only observe reads matching the alternate allele if
those are base-calling errors, here modeled by the parameter 6,.
Conversely, for G1: 2, we have the following:

Nsl
Pr (r5,l|gl = 2; 55) = H (1 _ 6.9)1—rdkégs”z 
k=1

If the genotype is heterozygous G1: 1, we observe reads from
the reference allele with probability pl or the alternate allele with
probability (1 — pl), resulting in the following model:

Nsl

1_rslk
Pr<rsJ|gz=he)=H(<1—pz><1—e.>+ples) -
k=1 (4)

751]:
(me — es) + <1 — pass)
Considering that R5] = 1 rslk and A51: N51 — R51 are, respect-
ively, the number of reads from sample 5 observed at site 1 matching

the reference allele and the alternate allele, the previous equations
can be simplified as follows:

1:1-(wig; = o; e.) = w (1.6595111 — ¢(1,65)IA5’ <5)

112 ﬁrosleumo[pJOJXO'sopeuuogutoiq/ﬁdnq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

QuASAR

1237

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0. _

0°- _ .

O

f. u
3- II I III-I I I I II' I. I ll. IIII _II I 1'-
LL _-  I- I I_ -.'  _ ,.  . ' .' - I-.:_-. _ .': - - "n. u.
a 8 -   a  ::.-'a'.':'..=. -:   '-'-t-.-.-.' - :' 
i ' " -' 3-?" I ' """'.-'.:u-"."""-.'.' "5"!- ."i . '55": I"I-'. ' “::':"-.'£--.- '..-"‘."" "' "in" '.'." '-"'..-"':'-.' """ '
8 1...] -_:Il 1:1-1. ' '.'-I|l -:.|‘- I'- 'Ill'ﬁf' l' I f ."|.- 1 Lil-u, ' 'u'."': .m- l. -:-I: n- " .l. ': -.lIl'l" \- ‘ 'u' If
C 9'1 Il Jul-l: 5::- IIIr'IIII :I‘ In! I - #- .Ill I‘.'..' I: I III: I:- I¥ F’IEIII;..“:II:—~ '-I
9 .-l : ~' - “Eu .'-'—'-i'- -- ' - - : :.---.-. -."' .
a) '-'f '. ‘I "-Z"""'-" "- "-'-:" "-)f' ' ‘.- --. .- '. '."'--":"I-."-I- ' .
"5 “I- 'I'|. '4 - ‘-.-"- .- '-' --.r -. 2' ' -: -_'I'."'-.'-"-"
35 o a: “III-I ‘- . ,I'_-'---_ I I; '_:--'-. . ‘_
8 II. '- I: I I I
_ " d-
N
OI _ I
l
'-
°. _ _._
O
I I I I I I I
N b. 4 o x w e: '\ ‘2: 9 x 1 5 10 50 500
5“ es“ a“) a“ 6‘8, 8‘5 63“ 88° 89 ad‘s“ a“ é‘é‘é‘ a“ as“ a“ f a“? a“ a“?
SNPs ordered by position on the chromosome Freq.

Fig. 1. Reference allele frequency from reads overlapping SNPs. (Left) Each dot represents an SNP covered by at least 15 RNA-seq reads. The y-axis represents
the fraction of RNA-seq reads that match the reference allele (observed ,6,). The x—axis represents the order of the SNP position in a chromosome. (Right)
Histogram showing the distribution of i), values across the genome. The three modes (p 6 {1,05, 0}) correspond, respectively, to the three possible genotypes:
homozygous reference (RR), heterozygous under no ASE (RA), and homozygous alternate (AA)

Pr (rsllgz = 2; es) = v (0, 659511 — v (0, ear” (6)

Pr (rug) = 1; esp.» = I (p2), 65511 — I (areal/*2 <7)

where I) (p,6) 2 [p(1 — 6) + (1 — p)6] and makes explicit that
homozygotes, gl=2 (or gl=0), are indistinguishable from p15 2 0
(or p15 2 1) when g]: 1. In QuASAR, we resolve this identifi-
ably problem by assuming that those cases with extreme ASE across
all replicates are more likely to be homozygous genotypes.

To fit the mixture model, we use an expectation maximization
(EM) algorithm (see Section 2 for more details) in which we estimate
sample-specific base-calling error rates E, (p is fixed to 0.5) and
posterior probabilities for the genotypes. For the ASE inference step,
we wish to test the null hypothesis p5, = 0.5. We additionally con-
sider that I) in (5—7) is a random variable ‘I’sl sampled from an
~Beta (as), [$51) distribution with:

as] : lPSIMS ﬁsl :  _ lpsl)MS lp51 : lP<psl765) 

where the hyper parameter MS controls for over-dispersion
and results in a better calibrated test as shown in Section 3.
Combining (7) and (8) results in a beta-binomial distribution (13),
which we use to model the number of reads coming from the
reference allele. Formalized as a likelihood ratio test (LRT), the in-
ference step takes into account over-dispersion and genotype
uncertainty:

A

AS] : suP p51€{0,0.5,1}{Pr (I‘SIIPSI) §S)Ms)} (9)

Sup p5, {Pr (rsllpsl’ ES) M5)}

 

where the set of parameters {EM Ms}f=1 are maximum likelihood es-
timates under the null hypothesis p15 2 0.5 (see Section 2). To calcu-
late a P value, we use the property that —210g (A51) is asymptotically
distributed as ﬁ.

2.2 Model fitting and parameter estimation
To use the EM procedure (McLachlan and Krishnan, 2007), we first
convert (1) to a ‘complete’ likelihood, as if we knew the underlying

genotypes g = {G1}1L=1=
L(®) = Pr (D,g|o) = Pr (D|g; ®)Pr (g|o) =

L 2 S
= H{Pr (G1 = g)HPr (rsllgz = g; 65,1050}
0 5:1

l=1g=

9?
(10)

where G‘lg E 1(G1 = g) are binary indicator variables and (9 repre-
sents the set of all parameters of the model. In log likelihood form

we have:
L 2 S L
[(9) = logL (o) = ZZG§In(P1-(G, = g» + 22
1:1 g=0 5:1 1:1
{09111.1 In ((1.65) +A.)1n (1 — ((1.65 )l <11)

 [Rs] 1n lP(psl) 65) + Asl 1n  _ lP(psl7 65))l
+ 92111,) 1mm, 6:) + As) 1n (1 — ((0. am}

During the genotyping step, to maintain identifiability of the
model, we fix p5] = 0.5 for all loci. Although MS could also be esti-
mated within the EM procedure, we only consider overdispersion on
the ASE step. These two choices lead to a much simpler EM proced-
ure and a slightly conservative estimate of 65.

2.2.1 E step

From the complete likelihood function (11), we derive the expected
values for the unknown genotype indicator variables E(G‘lg|D, (9) 2
(0?) given the observed data and the current estimates for the model
parameters. These quantities are also of interest for genotyping be-

cause they represent the posterior probabilities of each genotype
given the data, (Q?) = Pr (G‘lg = g|D, 

C= ((G?>+(G?>+<G?>)_1

S
<G?) = CH (G) = 0) exp (ZIRun (1 — e.) +Aun (2)1)
s=1 S
<G)) = CH (G) = 1) exp (1n (05):]st + Au) “2’
S 5:1
(0}) = CPr (G, = 2) exp (2111,5111 (as) + Alsln (1 — 29])
5:1

112 /810'S{12umo[p101x0'831112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

1238

C.T.Harvey et al.

 

The prior genotype probabilities Pr(G1 = g) are obtained from
the 1KG allele frequencies assuming Hardy—Weinberg equilibrium,
but the user can change this.

2.2.2 M step
Using the expected values from the E step, the complete likelihood is
now a function of 6, that is easily maximized

 

1 anf=1<<G )A.) + <G )R.»
L «G )R.) + <G )A.))

E, = logitI
[:1

After we run QuASAR to infer genotypes across samples from
the same individual, for each site we have a posterior probability of
each genotype (0?), and a base-calling error E, estimated for each
sample. From these posteriors, discrete genotypes are called by using
the genotype with the highest posterior probability; the maximum a
posteriori (MAP) estimate.

2.2.3 ASE inference

To detect ASE, we only consider sites with an heterozygous MAP
higher than a given threshold (e.g.  > 0.99). We then test the
possibility that p51 deviates from 0.5 while also taking into
account overdispersion using a beta-binomial model [combining (7)

and (8)]:

Pr (Rsllelalp Ms) =

51’

(N51) r (M) RR.) + 11.1%) r (A.) + (1 — MOMS) (13)
r (N.) + Ms)r<1).)Ms)r(<1 — 11.)) Ms)

 

Rsl

where MS controls the effective number of samples sup-
porting the prior belief that p = 0.5 and is estimated using grid
search:

A

L
M, = arg max Ms (HPr (R51|N51,E5,psl = 0.5,M5)) (14)
[:1

We estimate [35, using (13) with M5 = MS from (14) and a stand-
ard gradient method (L-BFGS-B) to maximize the log-likelihood
function

[(psl;MS7E5) = log Pr (Rsllelalpsl = lP<psl7gs)71\zs) 

Finally, all parameters are used to calculate the LRT statistic in
(9) and its P value.

Additionally, we can provide an estimate of the standard error
associated with the parameter p5, using the second derivative of the
log-likelihood function (1 5):

32 A 7
62 = —l ;M ,E (16)
Psi apszl (p51 5 5) 1051:1651
Alternatively, we can also recover a standard error from (9) (as
is asymptotically distributed as xﬁfﬂ), by using the P value to back
solve for the standard error:

ﬁls
90%)
where Q() is the quantile function for a standard normal distribu-

tion and p15 is the P value from (9). We use the first form (16)
when f) N 0.5 and (17) otherwise, as each provides a better

 

 

(17)

0:651 :

approximation at those ranges. Alternatively, if we do not need 6 ,351 ,

we can use (15) to obtain a profile likelihood confidence interval
for p51.

2.3 Experimental data

LCLs (GM18507 and GM18508) were purchased from Coriell Cell
Repository and human umbilical vein endothelial cells (HUVECs)
from Lonza. LCLs were cultured and starved according to
Maranville et al. (2011). Cryopreserved HUVECs were thawed and
cultured according to the manufacturer protocol (Lonza), with the
exception that 48 h prior to collection, the medium was changed to
a starvation medium, composed of phenol-red free EGM-2, without
hydrocortisone and supplemented with 2% charcoal stripped-FBS.
Cells were washed 2X using ice cold phosphate-buffered saline,
lysed on the plate, using Lysis/Binding Buffer (Ambion) and frozen
at —80°C. mRNA was isolated using the Ambion Dynabeads
mRNA Direct kit (Life Technologies). We then prepared libraries
for Illumina sequencing using a modified version of the NEBNext
Ultra Directional RNA-seq Library preparation kit (New England
Biolabs). Brieﬂy, each mRNA sample was fragmented (300 nt) and
converted to double-stranded cDNA, onto which we ligated bar-
coded DNA adapters (NEXTﬂex—96 RNA-seq Barcodes, BIOO
Scientific). Double-sided SPRI size selection (SPRISelect Beads,
Beckman Coulter) was performed to select 35 0—5 00 bp fragments.
The libraries were then amplified by polymerase chain reaction and
pooled for sequencing on the Illumina HiSeq 2500 at the University
of Chicago Genomics Core. For each LCL sample, libraries from
nine replicates were pooled for a total of 42.3M and 34.9M 50-bp
PE reads, respectively. We subsequently resequenced this libraries
for a total of 81.0M and 78.6M 150-bp PE reads. For the HUVEC
samples (267M reads total), we collected data for 18 replicates
across six time points to capture a wide range of basal physiologic
conditions.

2.4 Pre-processing

To create a core set of SNPs for ASE analysis, we first removed rare
(MAF < 5%) variants from all 1KG SNPs (see Supplementary
Material for an analysis without this step). We also removed SNPs
within 25 bases upstream or downstream of another SNP or short
InDels as well as SNPs in regions of annotated copy numbers or
other blacklisted regions (Degner et al., 2012). Reads were aligned
to the reference human genome hg19 using bwa mem (Li and
Durbin, 2009, http://bio-bwa.sourceforge.net). Reads with quality
<10 and duplicate reads were removed using samtools rmdup
(http://github.com/samtools/). Using a mappability filter (Degner et
al., 2012), we removed reads that do not map uniquely to the refer-
ence genome and to alternate genome sequences built considering all
1KG variants. Aligned reads were then piled up on the core set of
SNPs using samtools mpileup command. Reads with an SNP at
the beginning or at the end of the read, or with indels were also
removed to avoid any potential experimental bias. Finally, the pile-
ups were re-formatted, so that each SNP has a count for reads con-
taining the reference allele and a count for those containing the
alternate allele.

2.5 Comparison with other methods

To assess QuASAR genotyping quality, we focused on the LCL data
and compared genotype calls to those of 1KG project. We also com-
pared QuASAR genotyping accuracy to samtools + bcftools
(Li and Durbin, 2009) and GATK (DePristo et al., 2011). To assess
QuASAR ASE inference, we used QQ plots and eQTL derived from
the GEUVADIS dataset (Lappalainen et al., 2013; Wen et al., 2014).

112 /810'S{12umo[p101x0'831112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

QuASAR

1239

 

When we compared QuASAR ASE inference to other methods, we
used our implementation of the binomial and beta-binomial test by
forcing QuASAR to ignore the genotyping uncertainty in the ASE in-
ference step; i.e. in (9) numerator we only consider p5, = 0.5. For the
binomial test, we further force M5 = 00. In the Supplementary
Material, we also compared QuASAR performance to the method
used in (Kukurba et al., 2014). To make the results comparable, we
used QuASAR genotype information and the same pre-processing
steps described above up to samtools mpileup.

3 Results

We implemented the QuASAR approach as detailed in Section 2 in an
R package available at http://github.com/piquelab/QuASAR. First, to
evaluate QuASAR genotyping accuracy, we collected RNA-seq data
for two LCLs that already have high-quality genotype calls from the
1KG project (GM18507 and GM18508). As illustrated in Table 1, we
are able to accurately genotype thousands of loci with lower error
rates than other methods commonly used for genotyping DNA-seq
data. By design, QuASAR is more conservative in making heterozy-
gous calls than homozygous calls, yet still retains a large number of
heterozygous loci compared with GATK (DePristo et al., 2011) and
samtools (Li and Durbin, 2009). In QuASAR, if there is contention
between (i) an heterozygous genotype call with extreme allelic imbal-
ance or (ii) an homozygous genotype call with base call errors, our
model will favor the latter (ii). This is a crucial feature for accurate in-
ference of ASE, which will be discussed later in more detail. As we in-
crease the threshold on the QuASAR posterior probability of
heterozygosity, we consistently reduce the genotype error rate,
Supplementary Table S1.The error rates increase slightly if we include
rare variants with MAF < 0.05 (Table 52) and are minimally affected
when 1KG allele frequencies are not used as priors (Table S3). An im-
portant feature of QuASAR is that the genotyping information is also
used for the next inference step.

We next sought to characterize QuASAR performance in geno-
typing and ASE inference from RNA-seq experiments sequenced at
different depths. In total, we analyzed 18 samples (three replicates
across six different time points) for an individual for which geno-
types were not previously available. We combined the 18 fastq files
in different ways as input for QuASAR to obtain an empirical power
curve (Fig. 2). As expected, we observed that our ability to detect
heterozygotes (MAP > 0.99) increases with the sequencing depth. At
a more modest sequencing depth of 16 million, we can still detect
more than 1,000 heterozygous sites.

After obtaining the genotypes, we assessed whether there is evi-
dence of ASE at any of the SNPs determined to be heterozygous. To
conduct ASE inference, we used the LRT (9) statistic in QuASAR
and obtained P values. We controlled the FDR using the q-value
procedure (Storey, 2002). As shown in Figure 3, our ability to detect
ASE greatly increased with the number of SNPs we were able to
genotype, which in turn is a function of coverage (Fig. 2). Using 100
million reads, we detected roughly 9,000 heterozygous SNPs of
which 50 have ASE at 10%FDR.

To assess the calibration of the ASE test in QuASAR and to
compare it to other ASE inference approaches, we used QQ plots,
Figure 4. A QQ plot compares the quantiles observed from a test
statistic to those that are expected under a null distribution (e.g.
P values are uniformly distributed between 0 and 1). The shape of
the QQ-plot curve is useful to judge how well the P values are cali-
brated when we expect that a large number of the tests conducted
are sampled from the null distribution. In this latter scenario, we

Table 1. QuASAR accuracy in genotyping heterozygous loci com-
pared with GATK and samtools. Four samples with different
sequencing depths and read lengths are compared. Each row re-
ports the number of heterozygous SNPs identified by each method
and the percentage of false discoveries when compared with 1KG
genotypes. For GATK and samtools, we used the default parameter
settings, and for QuASAR, we considered SNPs with a posterior
probability of heterozygosity > 0.99

 

Sample Genotyping method

 

(no. of reads, read length)
Samtools GATK QuASAR

 

NA18507 Number of hets 3158 4568 3310
(4.23 x 107, 50 bp)

FDR 1.20% 1.31% 0.91%

 

 

 

 

 

NA18508 Number of hets 2718 3933 2844
(3.49 x 107, 50 bp)
FDR 0.63% 0.97% 0.56%
NA18507 Number of hets 19 515 24 522 17 434
(8.10 x 107,150bp)
FDR 1.29% 2.09% 1.14%
NA18508 Number of hets 16 998 21 587 15 526
(7.86 x 107,150bp)
FDR 1.08% 1.75% 1.08%
21000- A
18000-
15000-
12000- A
A
9000- A
A
.5 A
a 6000-
3 A
2 A
E
.3 : Samples pooled
I across:
I": 3000- A
Timepoints
.0 o 1
. 0 O 2
o 3
4' . 6
'0
Replicates
O 1
1000- . A 2
10 50 100 150 200 250 300

Millions of reads

Fig. 2. Empirical power in detecting heterozygous SNPs as a function of
sequencing depth. Each point represents a single input dataset to QuASAR:
either as a single experiment replicate and time point (red dot), combining
multiple time points (2=green, 3=blue, 6=purple) or combining replicates
(1=dot, 2=triangle). The x—axis represents the total number of RNA-seq
reads in the fastq input files. The y-axis represents the log 10 of the total num-
ber of SNPs that are determined to be heterozygous

expect that the QQ-plot curve would follow the 1:1line for the
range of P values with higher value. For small P values, we expect
that the curve starts to depart from the 1:1line representing the
small proportion of tests that are not sampled from the null distribu-
tion. Many existing approaches for ASE use either a binomial test
(Degner et al., 2012; Kukurba et al., 2014; McDaniell et al., 2010;
Reddy et al., 2012) or a beta-binomial test (Pickrell et al., 2010;
Sun, 2012) that does not account for genotyping or base-calling
error. To compare QuASAR ASE inference to these alternative

112 /810'S{12umo[p101x0'831112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

C.T.Harvey et al.

 

 

 

 

 

1240
100- A
75-
50-
A A‘
A
25-
A
o:
D A
LL
o\°
O
I A
(6
.g o A
(Ll—5 A A Samples pooled
< 0 across:
=11:
Timepoints
o o 1
2
o o o .
o 3
o e
O O A
Replicates
o 1
A
1 - o o o 2
1000 4000 0000 12000 16000 20000

# Heterozygous loci

Fig. 3. Empirical power in detecting ASE as a function of the number of
heterozygous SNPs detected. Each point represents a single input dataset to
QuASAR as in Figure 2. The x—axis represents the total number of SNPs that
are determined to be heterozygous. The y-axis represents the log 10 of the
number of SNPs that have a significant Pvalue for ASE at 10% FDR

 

 

     
 

1 5 — . '
I
o.
’0? I
E I
“5 1'
T 1 0 - I
Q Binomial M O . .
v
52
o:
2 . . .
I «a
8 Beta—Binomial \ ,9
E 5-
a)
.o
O QuASAR
0 _

 

 

 

Expected —log1o(p — value)

Fig. 4. OOpIot comparing the Pvalue distribution of three alternative methods
for determining ASE. The x—axis shows the log 10 quantiles of the Pvalues ex-
pected from the null distribution. The y-axis shows the log 10 quantiles of the
Pvalues computed from the real data using three different methods: (i) bino-
mial (black) assumes M = 00 no overdispersion; (ii) beta-binomial (green)
considers overdispersion but does not consider uncertainty in the genotype
and (iii) QuASAR (blue) uses the beta-binomial distribution and uncertainty in
the genotype calls. In all three cases, the same set of SNPs is considered. The
shaded area in gray indicates a 95% confidence band for the null distribution

approaches, we used the RNA-seq data collected on the LCL sam-
ples and the genotype calls from QuASAR. Figure 4 clearly shows
that the binomial test is too optimistic and will likely lead to many
false discoveries. Another binomial test (Supplementary Fig. S1) in-
dependently implemented (Kukurba et al., 2014) show a similar

behavior to our own implementation. In contrast to the binomial
test, the beta-binomial model seems better calibrated but uncertainty
on the genotype being a true heterozygote can lead to very small P
values and false positives. QuASAR combines the beta-binomial
model with uncertainty on the genotype, resulting in the most con-
servative approach, likely avoiding a common cause of false posi-
tives in ASE analysis.

To further evaluate the differences between QuASAR and other
methods, we focused on the high-coverage LCL samples. This cell
type has been part of large sample eQTL studies such as GEUVADIS
(Lappalainen et al., 2013) including RNA-seq data for more
than 600 individuals. From a recent reanalysis of the GEUVADIS
dataset (Wen et al., 2014), we selected genes with eQTLs (5% FDR)
and a leading SNP with a high posterior inclusion probability
(PIP > 0.9), as those are the nucleotides more likely to be causal (i.e.
the eQTN). We hypothesized that in our data, genes for which
the eQTN was heterozygote would be more likely to show evidence
for ASE than those for which the eQTN was homozygote.
However, transcripts with homozygous eQTNs could still
show ASE, if they have additional personal/rare associations or due
to an imprinting mechanism. In any of the methods we tested
(Supplementary Fig. S2), there was a significant difference between
ASE P values in the expected direction (Mann—Whitney U—test
P<0.02). The distribution of P values (Supplementary Fig. S2D)
for ASE signals in transcripts with homozygous eQTNs are much
closer to the uniform distribution in QuASAR when compared with
other methods, especially those that do not account for
overdispersion.

In general, the P values obtained across all methods tested are
very much correlated to each other, as shown in Supplementary
Figure S3, but there are key differences. The methods that use a bi-
nomial test tend to have lower P values than QuASAR, which uses a
beta-binomial model. Supplementary Figure 54A and B show that
we may observe more shrinkage for SNPs with deeper coverage.
Compared with a test using the beta-binomial distribution but
ignoring genotype uncertainty, our QuASAR test leads to similar P
values, but SNPs with more uncertainty on being heterozygous are
corrected in a higher degree toward a less significant P value
(Supplementary Figs. 53C and 54C).

In terms of computational complexity, QuASAR is very fast.
QuASAR runtime for genotyping with the EM procedure takes less
than 205 on any of our datasets (using a computer with a 6-core
2.93-GHz Intel processor and 8-GB RAM). Each EM iteration in
the genotyping step is O(LS) linear with the number of SNPs and
samples, and convergence is achieved in less than 20 iterations.
GATK with the default options takes a longer amount of time
(about 2h) compared with samtools and QuASAR, as the latter
methods focus directly on 1KG SNPs only. Comparatively, for both
our pipeline and Kukurba et al. (2014), more time is spent in data
pre-processing (roughly 10min per sample depending on the
sequencing depth and assuming reads are already aligned) than in
genotyping or ASE inference.

4 Discussion

QuASAR is the first approach that detects genotypes and infers ASE
from the same sequencing data. In this work, we focused on RNA-
seq, but QuASAR can be applied to other data types (ChIP-seq,
DNase-seq, ATAC-seq and others). Indeed, the more experimental
data available from the same individual across many experimental

112 /810'S{12umo[p101x0'801112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

QuASAR

1241

 

samples (data types, conditions, cell types or technical replicates),
the more certainty we can gather about the genotype.

A key aspect of the QuASAR ASE inference step is that it takes
into account over-dispersion and genotype uncertainty resulting in a
test that we have shown to be well calibrated. In many cases, the P
values obtained from biased statistics can be recalibrated to the true
null distribution using a permutation procedure. Unfortunately, this
is not possible for ASE inference, as randomly permuting the reads
assigned to each allele would inadvertently assume that the reads are
distributed according to a binomial distribution. More complicated
and computationally costly resampling procedures can be proposed,
but it is not clear what additional assumptions may be introduced
and if such methods can correctly take into account genotyping
uncertainty.

If prior genotype information is available, it can also be provided
as input to the algorithm. The prior uncertainty of the genotypes
should be reflected in the form of prior probabilities for each geno-
type. In this article, we have shown that we can obtain reliable geno-
type information from RNA-seq reads, thus making additional
genotyping unnecessary if the endpoint is to detect ASE.
Instead, sequencing the RNA-seq libraries at a higher depth is
probably a better strategy as it greatly improves the power to detect
ASE.

Furthermore, as sequencing costs decrease rapidly, ASE methods
are becoming very attractive in applications where eQTL studies
have been previously used. This is of increased importance in
scenarios where collecting a large number of samples is expensive or
infeasible. Large-scale eQTL studies are still very much necessary
for fine mapping, but analysis of ASE can provide unique
insights into mechanisms that are uncovered only under specific
experimental conditions, e.g. as a result of gene x environment
interactions.

Acknowledgements

We thank Wayne State University HPC Grid for computational resources, the
University of Chicago Genomics Core for sequencing services and Jacob Degner
and members of the Luca/Pique group for helpful comments and discussions.

Funding

This work was supported by the National Institute of Health
[1R01GM109215-01 to R.P.-R. and EL] and the American Heart
Association [14SDG20450118 to FL].

Conﬂict of Interest: none declared.

References

Barreiro,L.B. et al. (2012) Deciphering the genetic architecture of variation in
the immune response to Mycobacterium tuberculosis infection. Proc. Natl
Acad. Sci. USA, 109, 1204—1209.

Cowper-Sal lari,R. et al. (2012) Breast cancer risk-associated SNPs modulate
the afﬁnity of chromatin for FOXA1 and alter gene expression. Nat. Genet.,
44, 1191—1198.

Degner,].F. et al. (2009) Effect of read-mapping biases on detecting allele-
speciﬁc expression from RNA-sequencing data. Bioinformatics, 25,
3207—3212.

Degner,].F. et al. (2012) DNaseI sensitivity QTLs are a major determinant of
human expression variation. Nature, 482, 390—394.

DePristo,M.A. et al. (2011) A framework for variation discovery and genotyp-
ing using next-generation DNA sequencing data. Nat. Genet., 43, 491—498.

Dermitzakis,E.T. (2012) Cellular genomics for complex traits.

Dimas,A.S. et al. (2009) Common regulatory variation impacts gene expres-
sion in a cell type-dependent manner. Science, 325, 1246—1250.

Ding,]. et al. (2010) Gene expression in skin and lymphoblastoid cells: reﬁned
statistical method reveals extensive overlap in cis-eQTL signals. Am. ].
Hum. Genet., 87, 779—789.

Duitama,]. et al. (2012) Towards accurate detection and genotyping of ex-
pressed variants from whole transcriptome sequencing data. BMC
Genomics, 13(Suppl. 2), S6.

Fairfax,B.P. et al. (2014) Innate immune activity conditions the effect of
regulatory variants upon monocyte gene expression. Science, 343, 1246949.

Gibbs,J.R. et al. (2010) Abundant quantitative trait loci exist for DNA methy-
lation and gene expression in human brain. PLoS Genet., 6, e1000952.

Gieger,C. et al. (2008) Genetics meets metabolomics: a genome-wide associ-
ation study of metabolite proﬁles in human serum. PLoS Genet., 4,
e1000282.

Grundberg,E. et al. (201 1) Global analysis of the impact of environmental per-
turbation on cis-regulation of gene expression. PLoS Genet., 7, e1001279.
Hasin-Brumshtein,Y. et al. (2014) Allele-speciﬁc expression and eQTL ana-

lysis in mouse adipose tissue. BMC Genomics, 15 , 471.

Kasowski,M. et al. (2010) Variation in transcription factor binding among
humans. Science, 328, 232—235.

Katz,Y. et al. (2010) Analysis and design of RNA sequencing experiments for
identifying isoform regulation. Nat. Methods, 7, 1009—1015.

Kukurba,K.R. et al. (2014) Allelic expression of deleterious protein-coding
variants across human tissues. PLoS Genet., 10, e1004304.

Lappalainen,T. et al. (2013) Transcriptome and genome sequencing uncovers
functional variation in humans. Nature, 501, 5 06—511.

Lee,M.N. et al. (2014) Common genetic variants modulate pathogen-sensing
responses in human dendritic cells. Science, 343, 1246980.

Li,H. and Durbin,R. (2009) Fast and accurate short read alignment with
Burrows-Wheeler transform. Bioinformatics, 25 , 1754—1760.

Maranville,].C. et al. (2011) Interactions between glucocorticoid treatment
and cis-regulatory polymorphisms contribute to cellular response pheno-
types. PLoS Genet., 7, e1002162.

McDaniell,R. et al. (2010) Heritable individual-speciﬁc and allele-speciﬁc
chromatin signatures in humans. Science, 328, 235—239.

McLachlan,G. and Krishnan,T. (2007) The EM Algorithm and Extensions,
Vol. 382. John Wiley SC Sons. New York, N.Y.

McVicker,G. et al. (2013) Identiﬁcation of genetic variants that affect histone
modiﬁcations in human cells. Science, 342, 747—749.

Melzer,D. et al. (2008) A genome-wide association study identiﬁes protein
quantitative trait loci (pQTLs). PLoS Genet., 4, e1000072.

Nica,A.C. et al. (2010) Candidate causal regulatory effects by integration of
expression QTLs with complex trait genetic associations. PLoS Genet., 6,
e1000895.

Nica,A.C. et al. (2011) The architecture of gene regulatory variation across
multiple human tissues: the MuTHER study. PLoS Genet., 7, e1002003.

Nicolae,D.L. et al. (2010) Trait-associated SNPs are more likely to be eQTLs:
annotation to enhance discovery from GWAS. PLoS Genet., 6, e1000888.

Pastinen,T. (2010) Genome-wide allele-speciﬁc analysis: insights into regula-
tory variation. Nat. Rev. Genet., 11, 5 33—5 38.

Pickrell,].K. et al. (2010) Understanding mechanisms underlying human gene ex-
pression variation with RNA sequencing. Nature, 464, 76 8—772.

Piskol,R. et al. (2013) Reliable identiﬁcation of genomic variants from RNA-
seq data. Am. ]. Hum. Genet., 93, 641—651.

Reddy,T.E. et al. (2012) Effects of sequence variation on differential allelic
transcription factor occupancy and gene expression. Genome Res., 22,
860—869.

Seoighe,C. et al. (2006) Maximum likelihood inference of imprinting
and allele-speciﬁc expression from EST data. Bioinformatics, 22,
3032—3039.

Shah,S.P. et al. (2009) Mutational evolution in a lobular breast tumour pro-
ﬁled at single nucleotide resolution. Nature, 461, 809—813.

Skelly,D.A. et al. (201 1) A powerful and ﬂexible statistical framework for test-
ing hypotheses of allele-speciﬁc gene expression from RNA-seq data.
Genome Res., 21, 1728—1737.

Smirnov,D.A. et al. (2009) Genetic analysis of radiation-induced changes in
human gene expression. Nature, 459, 587—5 91.

112 /810'S{12umo[p101x0'801112u1101urotqﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

1242

C.T.Harvey et al.

 

Storey,J.D. (2002) A direct approach to false discovery rates. ]. R. Stat. Soc.
Ser. B Stat. Methodol., 64, 479—498.

Stranger,B.E. et al. (2007) Population genomics of human gene expression.
Nat. Genet., 39, 1217—1224.

Sun,W. (2012) A statistical framework for eQTL mapping using RNA-seq
data. Biometrics, 68, 1—11.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq
reveals unannotated transcripts and isoform switching during cell differenti-
ation. Nat. Biotechnol., 28, 51 1—5 15.

Wen,X. et al. (2014) Cross-population meta-analysis of eQTLs: ﬁne mapping
and functional study. hioinU. doi 10.1101/008797.

112 /810'S{12umo[p101x0'801112u1101urotqﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

