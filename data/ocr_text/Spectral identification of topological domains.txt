Bioinformatics, 32(14), 2016, 2151—2158

doi: 10.1093/bioinformatics/btw221

Advance Access Publication Date: 5 May 2016
Original Paper

 

Systems biology

Spectral identification of topological domains
Jie Chen1'2'3, Alfred o. Herolll 2'45 and lndika Rajapakse3'6'*

1CIAIC, School of Marine Science and Technology, Northwestern Polytechnical University, China, 2Department of
Electrical Engineering and Computer Science, 3Department of Computational Medicine & Bioinformatics, Medical
School, 4Department of Biomedical Engineering, 5Department of Statistics and 6Department of Mathematics,
College of Literature, Science and the Arts, University of Michigan, Ann Arbor, MI, USA

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on September 5, 2015; revised on March 26, 2016; accepted on April 14, 2016

Abstract

Motivation: Topological domains have been proposed as the backbone of interphase chromosome
structure. They are regions of high local contact frequency separated by sharp boundaries. Genes
within a domain often have correlated transcription. In this paper, we present a computational effi—
cient spectral algorithm to identify topological domains from chromosome conformation data
(Hi—C data). We consider the genome as a weighted graph with vertices defined by loci on a
chromosome and the edge weights given by interaction frequency between two loci. Laplacian—
based graph segmentation is then applied iteratively to obtain the domains at the given compact—
ness level. Comparison with algorithms in the literature shows the advantage of the proposed

 

strategy.

Results: An efficient algorithm is presented to identify topological domains from the Hi—C matrix.
Availability and Implementation: The Matlab source code and illustrative examples are available

at http://bionetworks.ccmb.med.umich.edu/
Contact: indikar@med.umich.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Chromosome conformation capture techniques (3C, 4C, Hi—C) have
yielded an unprecedented level of information about genome organ—
ization, and many studies are now exploring the relationship be—
tween genome structure and transcription (Cavalli and Misteli,
2013; Chen et 61]., 2015b; Gorkin et 61]., 2014). Chromosome con—
formation capture studies suggest that eukaryotic genomes are
organized into structures called topological domains (or topologic—
ally associating domains, TADs). Topological domains can be
defined as linear units of chromatin that fold as discrete three—di—
mensional (3D) structures tending to favor internal chromatin inter-
actions (Dixon et 61]., 2012; Nora et 61]., 2012). A majority of
regulatory protein binding sites localize within topological domains.
This suggests that sites associated with domain borders represent
a functionally different subclass of alleles that delimit regions con—
taining housekeeping genes and insulator sites (Van Bortle et 61].,
2014). Detecting the topological domains is thus helpful for

studying the relationship between chromosome organization and
gene transcription. For additional works on delineating structural
domains (see Le Dily et 61]., 2014; Lévy—Leduc et 61]., 2014; Liu et 61].,
2012; Pope et 61]., 2014; Sexton et 61]., 2012).

Topological domains can be detected using data from Hi—C,
which allows genome—wide identification of chromatin contacts.
The Hi—C method probes the 3D architecture of the whole genome
by coupling proximity—based ligation with massively parallel
sequencing. The Hi—C data matrix records the contact frequency be—
tween pairs of loci. Topological domains, as regions that have high
intra—contacts, are characterized by diagonal blocks in the Hi-C
matrix. To identify topological domains, in (Dixon et 61]., 2012) the
authors employed a Hidden Markov Model (HMM) on the direc—
tionally index from a Hi-C matrix to determine regions initiated by
significant downstream chromatin interactions and terminated by a
sequence of significant upstream interactions. Filippova et al. (2014)
formulated the identification problem by maximizing the domain

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2151

9mg ‘09 1sn3nv uo sopﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

2152

J. Chen et al.

 

total reads and introduced a dynamic programming algorithm to
solve the problem with a given scale parameter.

These methods perform analysis on a 1D read index or on a 2D
image segmentation subblock, and they suffer from sensitivity to
initialization (e.g. HMM model parameter adjustment), and high
computational complexity (e.g. dynamic programming for combina-
torial optimization). However, these methods do account for the
fact that Hi—C matrices depend on interactions of loci on the gen—
ome. Specifically, the largest entries in a Hi-C matrix define a graph
whose vertices are loci in the genome and whose edge weights are
the contact frequencies between loci. Loci with high contact fre—
quency are associated with small Euclidean distance in 3D space.
Identifying fine domain resolution structures such as TADs can
directly be translated to the problem of segmenting the graph into
components with weak interconnections. Such graph partitioning
approaches have been well developed in spectral graph theory
(Chung, 1997). Representation of HiC data as a graph and the usage
of graph theoretic approaches have also been investigated by Botta
et al. (2010) and Boulos et al. (2013). While the former uses net—
works to present its experiment results and the later use graph the—
ory to discover hubs in chromatin interaction data, neither of them
discusses from the point of view of the graph segmentation for
chromatin data. Based on a graph theoretic interpretation of Hi—C
matrices, we propose a simple and mathematically sound algorithm
for topological domain discovery based on spectral graph
cuts. Domains at different scales are identified by running the spec-
tral graph cuts algorithm recursively, until the connectivity of the
graph associated with the domain reaches the level of desired
compactness.

Compared with previous algorithms in Dixon et al. (2012) and
Filippova et al. (2014), the proposed spectral method has several
advantages: First, the method leads to topological domains that
are highly correlated with gene transcription. Second, the pro—
posed method admits a unique solution, and does not suffer from
the severe initialization sensitivity of the HMM method, which is
due to the fact that HMM involves an iterative expectation—maxi-
mization (EM) algorithm. Note that stability with respect to ini—
tialization affects the robustness of a method. Third, using the
proposed graph connectivity stopping criterion leads to domains
with sizes more closely related to the inherent structure of the re—
gion. Finally, the proposed method relates the Hi—C matrix to the
spatial coincidence of loci via a graph and has moderate computa—
tional complexity. In the results section, the advantages of the al—
gorithm are confirmed on Hi—C data collected from human

fibroblast.

(a) (b)

 

2 Preliminaries
2.1 Introduction to Hi—C data

Hi—C evaluates long—range interactions between pairs of segments
delimited by specific cutting sites by using spatially constrained liga—
tion, and provides ligation information (segment coordinates, seg—
ment directions, etc) for the pairs (Lieberman—Aiden et al., 2009).
These measurements are formatted into a square symmetric matrix
H, where il- stands for the total number of read pairs sequenced
between loci i and j, where locus refers to a sequence of non—overlap—
ping windows of equal sizes. This window size is also referred to as
the resolution of the Hi—C matrix where 1 Mb and 100 kb are com—
mon resolutions. A Hi—C matrix is non—negative and diagonally
dominant and tapered because a segment has higher probability of
ligation with proximal regions as compared with distal regions.
Furthermore, segments from chromosome centrometric regions can-
not be uniquely mapped due to the presence of repeated sequences
along the chromosomal strand. Thus there are zero—valued bands in
the Hi—C matrix. These zero—valued bands are usually removed since
they are non-informative. Finally, the entries are always nonnegative
since they record the contact counts between pairs of loci. A Hi—C
matrix therefore naturally associates a graph to the genome, where
vertices are defined by binned loci in the genome, and the edge
weight between a pair of loci is proportional to their contact fre—
quency. Consequently, a TAD is a compact region that can often be
visually distinguished as a diagonal block in the Hi-C matrix. TADs
are strongly connected graph components having strong intra-
connections and weak inter—connections (see the Fig. 1(a)—(c) for
illustration).

2.2 Spectral graph theory

Modeling the spatial organization of chromosomes in a nucleus as a
graph allows us to use recently introduced spectral methods to
quantitively study their properties. Our strategy for identifying topo—
logical domains is based on spectral graph theory applied to the
Hi-C matrix. Relevant concepts are reviewed below.

We define a undirected graph as the ordered pairs of sets
g: (V, E) where V: {121,122,...,z/N} is a finite set of vertices
with cardinality N, and E is an edge set consisting of elements of
the form {11), 12,-}, 1' 7S 1'. The adjacency matrix A(g) (or A for short)
is the symmetric N x N matrix encoding the adjacency relation—
ships in the graph g, such that [A(g)],, : 1 only if {1114);} E E,
otherwise [A(g)],, : 0, with [-L-l- denoting the ijth entry of its ma—
trix argument. The degree of a given vertex, denoted by d(z/,-), is

TAD (level 2)
PM
+ +
TAD (level 1) T Iterative splitting
A
+ + + + + + + +
(c) (d)

Fig. 1. Illustration of topological domains represented in different senses: (a) physical structures of topological domains (locally compact regions). (b)
Topological domains are characterized by diagonal blocks in a Hi-C map. (c) Graph model of the contact architectures. Identifying topological domains is
then cast as the problem to segment a graph at weak connections. (d) Nodal domains of Fiedler vector of the graph forms the basis of the proposed

algorithm

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

Spectral identification of topological domains

2153

 

the cardinality of the neighborhood set in g of 12,-, equivalently ex—
pressed as

d<w> = Z IA(Q)L-,-. (1)

16-00

with N,- denoting the neighboring vertices of 12,-. The degree matrix,
D(g), is defined as a diagonal matrix with the ith diagonal entry
given by d(12,-), namely,
610/1) 1 =i
lD(glij : . . (2)
0 1 7E /.
The Laplacian of graph g is defined by
5(9) = 13(9) — 151(9): (3)

and the normalized Laplacian is given by

£N(g) = 13(9)‘: (13(9) — A(g)) D(g)7 (4)

For a graph, let the ordered eigenvalues of 5(9) (or £N(g)) be
denoted by 21, 22, . . . , 2N, where the following relation holds

02413423“‘34N- (5)

The second smallest eigenvalue 22 is known as the Fiedler number,
or algebraic connectivity, which characterizes the connectivity and
stability of the graph (Mesbahi and Egerstedt, 2010). When the
graph is connected the Fiedler number is strictly positive. Intuitively,
a more highly connected graph possesses a larger Fiedler number.
For example, a complete graph is a graph for which every vertex has
degree N — 1 and it has maximum Fiedler number among all graphs
over N vertices. Therefore, the Fiedler number is an appropriate
measure for associating the Hi—C data with the connectivity proper—
ties of the chromatin structures. The eigenvector associated with 22
is called the Fiedler 12ector. For a graph having several connected
components the Fiedler number is zero and the adjacency matrix is
permutation—equivalent to a block diagonal adjacency matrix A. In
this case the components can be uniquely identified from the signs of
the corresponding entries of the Fiedler vector (Shi and Malik,
2000). The positive and negative pattern defined by the Fiedler vec—
tor is called the nodal domain (Fig. 1(d)).

More generally, instead of considering binary connections be—
tween pairs, weights can be assigned to each edge such that [A(g)],,
: 112,-,- only if {12,-,12,-} E E (otherwise [A(g)],, : 0) to characterize the
connection strengths. The associated degree matrix, D(g), and
Laplacian, 5(9) (or £N(g)), are defined in the same way as in (2)—
(4). See (Chung, 1997; Mesbahi and Egerstedt, 2010) for more de—
tails on spectral matrix theory for weighted matrices.

2.3 Characterizing the TAD graph with the normalized
La placian

The Hi-C matrix can be interpreted as a weighted adjacency ma—
trix for TAD graph. The normalized Laplacian (4) has several ad—
vantages over the unnormalized Laplacian (3). The spectrum of the
unnormalized Laplacian is influenced by the nodes having the
highest vertex degree. This can lead to the high degree nodes mask—
ing the nodes with lower vertex degrees, and consequently leads to
loss of sensitivity to complex structure. An extreme example of
this is the case where there is one very highly connected component
and other smaller connected components in the graph. In this case,
the connectivity structure of the highly connected component will
have dominating influence on the graph spectrum, masking the
spectral imprint of the of the other components. The normalized

Laplacian levels the playing field for both highly connected compo—
nents with nodes of high average vertex degree and components
with nodes of lower average vertex degree. This reduces the mask—
ing effect and leads to higher sensitivity to hidden structure. Using
the Fiedler number from the normalized Laplacian leads to captur—
ing the local structure patterns without being affected by
other regions on the same chromosome with high vertex degree,
which is consistent with our biological objective of finding the lo—
cally organized regions having co—regulated genes. Furthermore,
unlike the unnormalized Laplacian (3), the normalized Laplacian
(4) has a Fiedler number that is upper bounded, specifically
22 g % g 2.

3 Topological domain identification with graph
segmentation

As presented, the Fiedler vector of the Hi—C matrix can thus be used
to segment the chromosome into domains, and the Fielder value of
each domain indicates whether the obtained domain is sufficiently
compact, or needs to be further divided. We firstly present some
relevant notation and pre—processing, then the proposed strategy.

3.1 Notation and pre—processing

3.1.1 Dynamic range reduction

Let H be the observed Hi—C matrix of a given chromosome of length
L (with unmappable regions and diagonal entries removed), and let
H be a transformed Hi—C matrix with reduced dynamic range

[1:1] { 0 fori=j (6)
17—  for 17$ i:

where the function f is introduced to alleviate the large dispersion
of the raw Hi—C matrix data. Functions such as the power transform
f = x“, with a typically in E, %], or the logarithmic transform f
: log(x) can be used. Besides reducing data variability, since the Hi—C
matrix is a matrix of counts that can be modeled as Poisson, power
transform can be designed with an exponent that depends on the pos—
ition of the entry in the matrix (Chen et al., 2015a; Hu et al., 2012).
The power transform with a = % (Anscombe, 1948, 1953) normalizes
the variance of the Poisson entries. Alternatively, the logarithmic
transform make entries approximately normal. The function f can
also be selected as a canonical link between Poisson variables and ex—
planatory variables for Hi—C matrices in a generalized linear model
(GLM) framework (Hu et al., 2012).

3. 1.2 Toeplitz normalization

If two loci lie on the same chromosome of DNA, maximal separ-
ation between two loci is the length of DNA lying between them. As
a result closely spaced loci are likely to have large Hi—C read counts,
regardless of their specific conformation. To remove the distance ef—
fect, we employ a Toeplitz normalization. The Toeplitz normaliza-
tion divides the (i, j)th entry in the Hi—C matrix by the mean of all
matrix entries at the same distance |i — j| from the diagonal.
Mathematically, this step is described by:

HN = H®E, (7)

where ® corresponds to elementwise division of entries of H and E,
and the entries of E are given by

[BMW 2 [Him (8)

171,116.?“

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘121u103111123 310 [(1319111qu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pop1201umoq

2154

J. Chen et al.

 

with the set 1kg : {m,n|m — n : k —€,0 < kl < L}, card(I) de—
notes the cardinality of the finite set I. The Toeplitz matrix E repre-
sents the expected contact frequency as a function of the genome
distance. Note that read depth normalization (the read depth nor-
malization is defined as HD : cDT1HDT1 where D is a diagonal
matrix with [D],-,- : Zl-Lzl ii, and the scalar c is the total number of
reads) can be performed beforehand, but we found this does not
lead to significant difference in the results (see Supplemental
Material (SM)).

3.1.3 Fiedler number and vector calculation operator
For an adjacency matrix A, we use the operator notation

22,12 <— Fv(A) (9)

to denote the extraction of the Fiedler number 22 and the Fiedler
vector 12, by computing the eigen—decomposition of the normalized
Laplacian of A defined in (4). When we want to emphasize the ex—
traction of the Fiedler vector, we abuse notation by omitting 22 from
the notation (9), i.e. we write 12 <— Fv(A).

3.2 Topological domain extraction via recursive
partitioning

In this subsection, a topological domain extraction strategy is pro—
posed based on the normalized graph Laplacian. The algorithm con-
siders both local interactions and long—range interactions embedded
in the Hi-C matrix. The algorithm first extracts initial domains via
the sign of the Fiedler vector, then it splits each domain recursively
until the Fiedler number of a newly obtained domain is higher than
some threshold and the size of the domain is sufficiently small. As
the Fielder number is proportional to the algebraic connectivity, this
threshold ensures discovery of sufficiently disconnected domains.

At the first step, we consider the weighted graph with edge
weights defined by the Toeplitz normalized matrix HN. The Fiedler
vector, denoted by 12(1), of this graph is computed and the graph is
segmented into two clusters that are differentiated by the signs of
the Fiedler vector entries. A number of locally compact structures
are then given by the sets of vertices with the same sign on the larg—
est range of continuous indices from i to i. This results in the region
DH- defined by 121(1),12§,1r)1, . . . , 121(1) having the same sign.
Experimentally we have observed that the sizes of these domains
vary from 100 kb to several megabases. They can naturally be
defined as the initial topological domains. We can identify over
3000 TADs determined by the Fiedler vector derived from HN. We
will see that compared with the gene expression represented by
RNA—seq counts, regions within each domain approximately behave
in a binary manner, all active, or all inactive. Further, all domains
with the same sign behave binary manner, active or inactive. From
spectral graph theory, we known that domains with the same sign
are in the same cluster, and have fewer connections to other clusters
than connections within their own cluster. This result obtained from
HN considers the overall contact organization of the chromatin.
This step results in segmentations that are similar to the compart—
ments A and B obtained from (Lieberman—Aiden et al., 2009). A
further comparison can be found in supplementary materials
(Section 4).

Topological domains are likely to exhibit hierarchical structures
(Filippova et al., 2014). After determining the initial domains via the
Fiedler vector of HN, we therefore further divide these domains to
sub—domains having smaller sizes. For an obtained domain DH, we
calculate the Fiedler vector of the graph whose adjacency matrix is
given by the sub—matrix of H indexed by DH, followed by splitting

 

Algorithm 1. Identiﬁcation of TADs via graph Laplacian

 

Parameters: Fiedler number threshold 21th,, and user-supplied
lower bound L on domain size.
Pre-processing: For a given chromosome, compute the matrix
H using (6) and the normalized matrix HN
using (7).
Algorithm:
Step 1: Calculate the Fiedler vector of the matrix HN:

12(1) <— FV(HN) (10)

Initial TADs are given by the contiguous regions in 12(1) with
the same sign.

Step 2: For each obtained domain, compute its Fiedler number
and vector for each associated sub—matrix in H:

22,12 <— Fv(HDi_i) (11)

If the Fiedler number is smaller than the threshold 22 < 2th,,
segment the current domain again via 12.

Recursion: Repeat step 2 until the obtained sub-domain has a
Fiedler number larger than the threshold, or its size reaches
the lower bound L.

 

DH into sub—domains based on the signs of its Fiedler vector entries.
In this step matrix H is used, since the determining these smaller
sub—domains relies on diagonal block structures in H, instead of the
long-range interactions exhibited in HN. The Fiedler number of the
obtained domains are calculated and compared with a predefined
threshold 2th, to determine whether they are sufficiently compact, or
can further be split. The full algorithm is summarized in Algorithm
1. An example of the algorithm processing is illustrated in supple—
mental data file (Supplementary Fig. S1). A discussion of this two—
step strategy and alternative strategies is included in the SM.

3.3 Computational complexity

The complexity of the proposed algorithm is dominated by the
eigen—decomposition of the normalized Laplacian matrices. Step 1
requires the eigen—decomposition on a moderate size matrix (e.g.
@2300 X 2300 for chromosome 1 at 100 kb resolution, @350 X 350
for Chromosome 22 at 100 kb resolution). The resultant recursions
will process matrices of much smaller sizes, and the computational
time for eigen—decomposition is reduced significantly. In the next
section, we will provide more details on computational require—
ments. For higher resolutions with larger matrices, this computation
can be performed more efficiently by only computing a few of the
first smallest eigenvalues and the associated eigenvectors, using, for
example, power iterations (Saad, 1992), or by distributed means
(Kang et al., 2011). These particular strategies will be investigated
in future work.

4 Results

In this section, we illustrate the proposed algorithm and compare it
with previously proposed algorithms. The algorithms were first
applied to Hi—C data obtained from human foreskin fibroblasts
from a normal karyotyped male individual. Fragment contacts were
binned to generate Hi—C matrices at 100 kb resolution. The Hi-C li-
brary, RNA—seq library, data collection, and raw data processing

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘121u103111123 310 [(1319111qu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pop1201umoq

Spectral identification of topological domains

2155

 

were all performed by our laboratory, see SM and Chen et al.
(2015b) for the protocols, the detailed cell culture and data collec—
tion methods. The algorithm was then applied to Hi—C data from
IMR90 cells at a higher 5 kb resolution. Details of the toolbox can
be found in Section 1 of SM.

For comparison, we considered the topological domains extrac—
tion methods presented in Dixon et al. (2012) and Filippova
et al.(2014). In Dixon et al. (2012), the authors defined the direc—
tionality index (DI) at each bin by

Ndown _ Nup (Nup _ I\[av)2 + (Ndown _ I\[av)2

IDI = 7
lNdown _ Nupl Nav Nav

 

(12)

where Nup denotes the reads from the current bin to 2 Mb upstream,
Ndown denotes the reads from the current bin to 2 Mb downstream,
and NaV : %(Nup —I— Ndown). Then the directionality index was mod—
eled as the observation of a hidden Markov model (HMM) under a
Gaussian mixture model, endowed with three hidden states associ—
ated with the start, end and middle of a domain. In Filippova et al.
(2014), the authors formulated the topological domain identifica—
tion problem via the following optimization:

max a), bi, . 13
 lggﬂa i) < >

The function q is defined by q(k,l,y) : s(k,l,y) — 115(12 — l),
where 5(12, 1, y) : (Ii—’33) with y a scale parameter and N k; is total reads
between loci k and l, and 115(k — l) is mean value of 5(12, 1, y) over all
sub—matrices of length l — k. The optimization (13) was solved via
dynamic programming (DP).

For brevity, in this paper we illustrate the identified topological
domains for one of the smaller chromosomes of the fibroblasts: chr—
22. Results on all the other chromosomes can be found in Figure
52—823 in the supplemental file. The logarithmic transform f was

 

used in (6 ) to reduce the dynamic range of data and for variance nor-
malization. The proposed algorithm and the two comparative algo—
rithms were then applied to the transformed Hi-C matrix of
Chromosome 22. For the HMM method, we took reads from cur—
rent bin to 1 Mb upstream and downstream for Nup and Ndown in-
stead of the 2 Mb in the original presentation upstream/downstream
distance in order to investigate its effect on the domain size distribu—
tion in the HMM segmentation. However, the upstream/down—
stream distance did not appear to have an effect on the size
distribution. For the DP algorithm, the parameter 12 was set to y
= 0.2 and 0.25, respectively. For the proposed algorithm, Algorithm
1 was implemented with 2th, : 0.8 and 0.9, respectively.

The identified topological domains are illustrated in Figure 2
with diagonal blocks marked by blue squares. It can be observed
that the proposed algorithm provides results that are most consistent
with the observations, and finer domains can be obtained hierarchic—
ally by increasing the threshold ithr. Compared with the proposed
algorithm, the HMM methods have difficulty controlling the do—
main resolution to user specifications. Furthermore, the HMM algo—
rithm suffers from the problem of convergence to local maxima of
the likelihood function and is over—sensitive to the initialization. The
DP method has very high computational complexity, especially for
large chromosomes. A comparison among these algorithms and
quantitive computational time are reported in Table 1 and 2 respect—
ively. The advantage of the proposed algorithm in computational ef—
ficiency for Hi—C data at 100 kb resolution is obvious. Detailed
information on the boundary coordinates identified by the three al—
gorithms are provided in the SM.

We use Chromosome 22 to illustrate the capability of the pro—
posed algorithm to identify meaningful domains. The size distribu—
tion of identified TADs using the proposed algorithm with
2th, : 0.8 and 2th, : 0.9 are shown in Figure 3(a).Their boundary
coordinates are reported in Table S3. While varying the Fiedler

 

 

 

 

 

 

 

 

 

 

(a) HMM method

 

 

 

 

(d) Proposed method with Athr = 0.8

(b) DP method with 'y = 0.2

 

(0) DP method with 'y = 0.25

 

 

 

 

(e) Proposed method with Athr = 0.9

Fig.2. Illustration of estimated topological domains on Chromosome 22 obtained by previous algorithms and the proposed algorithm

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘121u103111123 310 [(1319111qu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pop1201umoq

2156

J. Chen et al.

 

Table 1. Comparison of the three algorithms

 

 

HMM DP Laplacian
Measure Directionality index Reads (normalized) Fiedler number (normalized)
Key methods State estimation with Hidden Optimization with dynamic Spectral clustering with graph
Markov chain programming Laplacian
Characteristics Method in original paper Optimal in region total reads Good physical interpretation
Resolution Partially related with the length for D1 Related with 12 Related with 21th,
Hierarchical No Multiscale Yes
identiﬁcation
Robustness Sensitive to initial conditions Unique solution Unique solution
Complexity Moderate High Low

 

Table 2. Computation time comparison of the three algorithms (in
s on iMac with 2.6GHz intel Core i7 and 4GB RAM)

 

 

Chr 1 Chr 4 Chr 9 Chr 14 Chr 22
HMM 124.5 102.9 67.3 45.5 21.1
DP >1 h >1 h 2399.8 609.1 10.2
Laplacian 2.8 1.8 0.8 0.5 0.1

 

 

Number
4s
0
0
Number

 

 

5 30 35 40 45 5O 5 10 25 30 35

5 10 15 20 2
TAD size (Am : 0.8)

15 20
TAD size (Am, = 0.8)

 

Number
07
O
c
Number

 

 

   

5 30 35 40 45 50 5 1 0 25 30 35

5 20 2 15 20
TAD size (Ann = 0.9) TAD size (Am = 0.9)

(a) (b)

 

 

Number
0 —\ M
01 —\ U1 N 01
Number
- N w
o o o
O O O (3

 

 

 

 

 

 

 

 

 

 

 

Mean size
3 N b 0) on 3 3
. . . .
2’
-. _ _ E‘C _

(C) (d)

Fig. 3. (a,b) Domain size distribution of the identified TADs on all chromo-
somes (a) and Chr-22 (b) with it)" = 0.8 (top) and 21m = 0.9 (bottom) respect-
ively. (c,d) The number of identified TADs (top) and mean TAD size (bottom)
on all chromosomes (c) and on Chr-22 (d) versus the Fiedler number
threshold

number threshold 21th,, we then count the number of domains identi—
fied by the proposed algorithm and compute the mean size of the do—
mains. In the top part of Figure 3(b), as expected the number of
domains found in Chromosome 22 increases with increasing 2th,.
Not shown are the results of decreasing the threshold below 0.8,
where there is little change in segmentation. This is due to the fact
that the segmentation on HN in Step 1 results in small size domains.
Finally, when the threshold reaches 2th, : 2, the domains are com—
posed of single bins and the number of domains equals the size of
the Hi—C matrix. We compare the identified TADs with those identi—
fied by the HMM method. First, the proposed methods identified
more TADs than the HMM method (Supplementary Table S2 and
Table S3). Second, note that the proposed method and HMM give
very different TAD segmentations. Even the first splitting step

Fiedler vector

 

 

 

4000

RNAseq count

 

50 100 150 200 250 300
Bins

(a) Fiedler vector and transcription activity

0.7

Correlation
P .O o .o
o.) A 01 o:

1 2 3 4 5 6 7 8 910111213141516171819202122

Chromosomes

(b) Correlation on all chromosomes

Fig. 4. Comparison between Fiedler vector obtained in Step 1 of Algorithm 1
and transcription described by RNA-seq counts

results in a larger number of domains than that identified by the
HMM method. We show below that the TADs produced by the pro—
posed spectral method with have significantly higher correlation to
the transcriptional gene expression as determined by RNAseq (see
Fig. 4). Therefore we conclude that the proposed method captures
more meaningful structures. Furthermore the domain boundaries
captured from these two methods often do not line up (See
Supplementary Table S3) making further comparisons between the
proposed spectral methods and the HMM method difficult.
Figure3(b) shows the total number of domains identified for
Chromosome 22. Correspondingly, the bottom part of Figure 3(b)
shows the mean TAD size, which is expected to decrease with in—
creases in the Fiedler number threshold. The results for the rest of
the chromosomes are reported in the supplementary materials. Our
proposed method also reveals that although they have the same alge—
braic connectivity (Fielder number), the topological domains of Chr
17 and 19 are larger than those of Chr 18. This may be related to
the fact that Chr 17 and 19 are rich in protein coding genes while
Chr 18 has fewer such genes.

We next illustrate the relationship between the chromosome
structure and gene expression via the identified topological domains.

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘121u103111123 310 [(1319111qu 112 /3JO'S[BUJHO[p.IOJXO'SOIJBIIIJOJUIOIQ/ﬂClllq 11101; pop1201umoq

Spectral identification of topological domains

2157

 

800
600
400
200
O I I I I I I I
50 100 150 200 250 300 350
Proposed method with Athr = 0.8

 

 

800
600
400
200

0 I

 

CTCF enrichment

50 100 150 200 250 300 350
HMM method

800
600 

33§llllllllll . . . .

100 150 200 250 300 350
DP method with y = 0.2

Fig. 5. CTCF enrichment on Chromosome 22 (blue) with the locations of iden-
tified TAD boundaries (red vertical lines)

Gene expression is represented by RNA—seq counts. RNA—seq was
performed simultaneously with Hi—C in our laboratory. In order to
be consistent with Hi—C matrix resolution, we summarized the gene
RNA—seq counts into bins of 100 kb resolution, according to their
locations. In Figure 4(a), we show the Fiedler vector of
Chromosome 22 obtained in Step 1 of Algorithm 1 and its RNA-seq
counts. It can be observed that the sign pattern of the Fiedler vector
has high correlation with the expression levels of the RNA—seq data.
Note that each locally consistent sign region is a topological domain
obtained at Step 1 of Algorithm 1. To show this in a quantitive man-
ner, we took the sign of the Fiedler vector and thresholded the
RNA—seq count vector (where the threshold was selected for each
chromosome to maximize the correlation), and then computed the
correlation coefficient between these two vectors for all chromo—
somes. The correlation values are shown in Figure 4(b). Significant
correlation is observed according to this result (with p < 10_6 by
permutation test. This shows that initial TADs are generally consist—
ent with the two chromosome compartments in the genome, hetero—
chromatin or euchromatin. We also show the decreasing trend of
the relation between the averaged variance of log—scaled RNA—Seq
reads within TADs versus the Fiedler number threshold
(Supplementary Fig. S33). These results confirm the relationship be—
tween the identified topological domains and the functional expres—
sion (Dixon et al., 2012; Lieberman—Aiden et al., 2009), and also
reveals the quality of the identified topological domain.

As compared to DP and HMM methods, the proposed method
identifies TAD boundaries that are more consistent with the loca—
tions of known CTCF enrichment peaks. We plot the CTCF ChIP—
seq enrichment at bins of 100 kb resolution with the locations of
identified TAD boundaries for the three compared algorithms in
Figure 5, with CTCF enrichment extracted from (Ziebarth et al.,
2013). It has been proposed that TAD boundaries coincide with in-
sulators such as CTCF binding sites. However, 85% of CTCF bind—
ing sites localize within TADs rather than at their borders,
suggesting that most CTCF sites are unlikely to aide in identifying
the borders that separate TADs. Meanwhile, multiple studies sug—
gest that some insulator elements are not capable of enhancer—block—
ing or chromatin barrier activity (Schuettengruber and Cavalli,
2013; Schwartz et al., 2012; Van Bortle et al., 2012). Compared
with the other two algorithms, the boundaries identified by the

 

 

 

 

 

 

 

 

 

 

(a) ’y = 0.4 (b) ’y = 0.6

Fig. 6. Identified topological domains on Chromosome 22 (at last 2000 bins)
at resolution of 5 kb

proposed algorithm are more consistent with CTCF enrichment
peaks. A particularly visible example can be found for the large
TAD between 300 and 350 bins.

Finally, we illustrate the scalability of the proposed spectral algo—
rithm to Hi—C data at higher resolution (5 kb) by applying it to the
Hi—C IMR90 cell data of Rao et al. (2014). Results of the last 2000
bins with 2th, : 0.4 and 2th, : 0.6 are shown in Figure 6 for
Chromosome 22.

5 Conclusion

In this paper, we presented a method for identifying topological do—
mains based on the spectral decomposition of the graph Laplacian
of the Hi-C matrix. The proposed algorithm has clear mathematical
interpretation and is more computationally efficient than previous
methods, allowing it to be applied to higher resolution Hi—C data.
Its favorable comparison with other algorithms and its higher correl-
ation with gene transcription dataillustrate the advantages of the
proposed spectral method. Future work may include investigating
fast iterative algorithms or parallel computation algorithms for im-
proving the efficiency at higher resolutions.

Funding

This work is supported in part by the DARPA Biochronicity Program and
NIH grant K25DK082791-01A109.

Conﬂict of Interest: none declared.

References

Anscombe,F.]. (1948) The transformation of Poisson, binomial and negative-
binomial data. Biometri/ea, 35, 246—254.

Anscombe,F.]. (1953) Contribution of discussion paper by H. Hotelling. New
light on the correlation coefﬁcient and its transforms. ]. R. Stat. Soc. B, 15,
229—230.

Botta,M. et al. (2010) Intra- and inter-chromosomal interactions correlate
with CTCF binding genome wide. Mol. Syst. Biol, 6, 1—6.

Boulos,R.E. et al. (2013) Revealing long-range interconnected hubs in human
chromatin interaction data using graph theory. Plays. Rev. Lett., 111, 118102.

Cavalli,G. and Misteli,T. (2013) Functional implications of genome topology.
Nat. Struct. Mol. Biol., 20, 290—299.

Chen,H. et al. (2015a) Chromosome conformation of human ﬁbroblasts
grown in 3-dimensional spheroids. Nucleus, 6, 55—65.

Chen,H. et al. (2015b) Functional organization of the human 4D nucleome.
Proc. Natl. Acad. Sci. (PNAS), 112, 8002—8007.

Chung,F.R. (1997) Spectral Graph Theory, vol. 91. American Mathematical
Society.

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘BIUJOJIIBD 310 [(1319111qu 112 /3JO'S[BUJHO[p.IOJXO'SOIJBIIIJOJUIOIQ/ﬂClllq 11101; pop1201umoq

2158

J. Chen et al.

 

Dixon,].R. et al. (2012) Topological domains in mammalian genomes identi-
ﬁed by analysis of chromatin interactions. Nature, 485, 376—380.

Filippova,D. et al. (2014) Identiﬁcation of alternative topological domains in
chromatin. Algorithms Mol. Biol., 9, 1—1 1.

Gorkin,D.U. et al. (2014) The 3D genome in transcriptional regulation and
pluripotency. Cell Stem Cell, 14, 762—775.

Hu,M. et al. (2012) HiCNorm: removing biases in Hi-C data Via Poisson re-
gression. Bioinformatics, 28, 3131—3133.

Kang,U. et al. (201 1) Spectral analysis for billion-scale graphs: discoveries and
implementation. In: Advances in Knowledge Discovery and Data Mining.
Springer-Verlag Berlin Heidelberg, pp. 13—25.

Le Dily,F. et al. (2014) Distinct structural transitions of chromatin topological
domains correlate with coordinated hormone-induced gene regulation.
Genes Development, 28, 2151—2161.

Lévy-Leduc,C. et al. (2014) Two-dimensional segmentation for analyzing Hi-
C data. Bioinformatics, 30, i386—i392.

Lieberman-Aiden,E. et al. (2009) Comprehensive mapping of long-range
interactions reveals folding principles of the human genome. Science, 326,
289—293.

Liu,L. et al. (2012) GeSICA: Genome segmentation from intra-chromosomal
association. BMC Genomics, 13, 1—10.

Mesbahi,M. and Egerstedt,M. (2010) Graph Theoretic Methods in Multiagent
Networks. Princeton University Press, Princeton, NJ.

Nora,E.P. et al. (2012) Spatial partitioning of the regulatory landscape of the
x-inactivation centre. Nature, 485 , 381—3 85.

Pope,B.D. et al. (2014) Topologically-associating domains are stable units of
replication-timing regulation. Nature, 515, 402—405.

Rao,S.S.P. et al. (2014) A 3D map of the human genome at kilobase resolution
reveals principles of chromatin looping. Cell, 159, 1665—1680.

Saad,Y. (1992) Numerical Methods for Large Eigenvalue Problems.
Manchester University Press, Manchester.

Schuettengruber,B. and Cavalli,G. (2013) Polycomb domain formation de-
pends on short and long distance regulatory cues. PLoS One, 8, e5 65 31.

Schwartz,Y.B. et al. (2012) Nature and function of insulator protein binding
sites in the drosophila genome. Genome Res., 22, 2188—2198.

Sexton, T. et al. (2012) Three-dimensional folding and functional organization
principles of the drosophila genome. Cell, 148, 45 8—472.

Shi,]. and Malik,]. (2000) Normalized cuts and image segmentation. IEEE
Trans. Pattern Anal. Machine Intell., 22, 888—905.

Van Bortle,K. et al. (2012) Drosophila CTCF tandemly aligns with other insu-
lator proteins at the borders of H3K27me3 domains. Genome Res., 22,
2 1 76—21 8 7.

Van Bortle,K. et al. (2014) Insulator function and topological domain border
strength scale with architectural protein occupancy. Genome B iol., 15 , R82.

Ziebarth,].D. et al. (2013) CTCFBSDB 2.0: a database for CTCF-binding sites
and genome organization. Nucleic Acids Res., 41, D188—D194.

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BIUJOJIIBD 310 [(1319111qu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pop1201umoq

