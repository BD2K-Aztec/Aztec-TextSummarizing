APPLICATIONS NOTE

Vol. 31 no. 1 2015, pages 137-139
doi: 10. 1 093/bioinformatics/btu607

 

Data and text mining

Advance Access publication September 10, 2014

UNDO: a Bioconductor R package for unsupervised deconvolution
of mixed gene expressions in tumor samples

Niya Wang”, Ting Gong”, Robert Clarke3, Lqu Chen‘, le-Ming Shih4, Zhen Zhang4,
Douglas A. Levine5, Jianhua Xuan1 and Yue Wang”

1Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University, Arlington, VA
22203, 2Department of Molecular Carcinogenesis, The University of Texas MD Anderson Cancer Center, Smithville, TX

78957, 8Lombardi Comprehensive Cancer Center, Georgetown University, Washington, DC 20057, 4 Departments
of Pathology and Oncology, Johns Hopkins University, Baltimore, MD 21231 and 5Department of Surgery, Memorial

Sloan—Kettering Cancer Center, New York, NY 10021, USA

Associate Editor: Jonathan Wren

 

ABSTRACT

Summary: We develop a novel unsupervised deconvolution method,
within a well-grounded mathematical framework, to dissect mixed
gene expressions in heterogeneous tumor samples. We implement
an R package, UNsupervised DecOnvolution (UNDO), that can be
used to automatically detect cell-specific marker genes (MGs) located
on the scatter radii of mixed gene expressions, estimate cellular pro-
portions in each sample and deconvolute mixed expressions into cell-
specific expression profiles. We demonstrate the performance of
UNDO over a wide range of tumor—stroma mixing proportions, validate
UNDO on various biologically mixed benchmark gene expression
datasets and further estimate tumor purity in TCGA/CPTAC datasets.
The highly accurate deconvolution results obtained suggest not only
the existence of cell-specific MGs but also UNDO’s ability to detect
them blindly and correctly. Although the principal application here in-
volves microarray gene expressions, our methodology can be readily
applied to other types of quantitative molecular profiling data.
Availability and implementation: UNDO is available at http://biocon-
ductor.org/packages.

Contact: yuewang@vt.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 6, 2014; revised on August 8, 2014; accepted on
September 7, 2014

1 INTRODUCTION

Tumor—stroma interactions serve as both a major confounding
factor and an underexploited information source in studying
tumor and microenvironment (Junttila and de Sauvage, 2013).
Although analyzing tumor cells in their microenvironment pro-
vides the most relevant context, mixed expressions cannot be
resolved directly by global profiling (Clarke et al., 2008).
Experimental solutions to isolate pure cells are inconvenient
and have many limitations (Hoffman et al., 2004). Current com-
putational alternatives perform basically a supervised

 

*To whom correspondence should be addressed.
IThe authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors.

deconvolution (Ahn et al., 2013; Clarke et al., 2010; Gosink
et al., 2007; Yoshihara et al., 2013), where the required a priori
information is often inaccurate or context dependent, thus
greatly limits supervised approaches.

Supported by a well-grounded mathematical framework, we
argue that both cell-speciﬁc expression profiles and mixing pro-
portions can be estimated in a completely unsupervised mode
from two or more heterogeneous samples using raw measured
gene expression values. Fundamental to the success of our ap-
proach is the geometric identifiability of cell-speciﬁc marker
genes (MGs) warranted by (i) non-negativity of gene expression
values and (ii) co-definition of distinct phenotypes and cell-
specific MGs.

The UNsupervised DecOnvolution (UNDO) R package
adapts and extends recent unsupervised deconvolution frame-
work in the literature (Chen et al., 2011). Using UNDO to dissect
tumor—stroma mixed gene expressions, we show that (Fig. l)
(i) the scatterplot of mixed cell expression profiles is a com-
pressed version of the scatterplot of pure cell expression proﬁles;
(ii) resident genes on the two radii of scatter sector are cell-
specific MGs, and furthermore, the two radius vectors defined
by the MGs coincide with mixing proportions. Accordingly,
UNDO first detects MGs on the two radii of the scatter sector
in tumor samples, then estimates cell proportions using standar-
dized average expression values of MGs and finally uncovers
pure cell expression profiles by matrix inversion. We demonstrate
the performance of UNDO on both synthetic and benchmark
real gene expression datasets with highly accurate deconvolution
results. We further apply UNDO to estimate tumor purity in
three datasets from TCGA (The Cancer Genome Atlas)/
CPTAC (Clinical Proteomic Tumor Analysis Consortium) and
obtain highly comparable results with the estimates by BACOM
2.0 and ABSOLUTE based on somatic copy number data
(Carter et al., 2012; Yu et al., 2011).

2 DESCRIPTION
2.1 Methods and software

We adopt the linear latent variable model of raw measured
expression data, given by (bold font indicates column vectors),

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 137

112 /§JO'S{Bumo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

N. Wang et aI.

 

(a) 35' "J4 . . . . . . In)
Allyn-nun

3 marksman“

II: I21113-11:turn: I=a:ﬁ.

J 5 " 753.135} 543.] .1113];—
q; ' arm.- Irn mimic-In prelim-
. I :I _ I _ _
E (A) —a|5mm[fj+a;5ﬂma[i]
H 1 5 Preprotesgmg

QC. arr".- IIIIIHIHL HI:

 

_ Start of UNDCI I

 

I
1 ' - .
Hilﬁw ]I=I..r2'J

L‘IS _ u. - ___¢. Sample numbﬂh 1" Dlmcnslunrcductlun
4'". - #- (Eigenvalue
larger 1han twu .
U . . . . , , ' - decampnrsrtlon]
05 I 1 '5- 2 J. 5 El '55 H '

 

 

 

 

 

 

 

 

 

 

 

 

 

 

In:an ' I”
b ,c 1n“ Mark-E! gene selenium
( l 3 E‘ ' ' ' ' {gent-a. il1lllJl'l|.I IIh.‘ 11w lmI1I ul'
All ﬂint: ri-IJHIII'F rattler formed by all genes]
1* Illlﬂclr mint:
2. 5 iMuing matrix calculallun
[scallnﬁ marl-car gene
a” I
I 5‘ ' Cc-‘l Time specific cnprcwon
— estimation and minlng mun-onions
I- [I1 l1]=[D'JEIJ [Lima calculationfatallthesample
. - Luau: 04553-
11 5f '
I [and of UNDO;
a Itlﬁ 1 ta 1 *5 3 is '
E

Fig. 1. (a) The scatterplot of mixing gene expression proﬁles (MCF7 and
HS27 cell lines), which forms a scatter sector (a sector-shaped distribu-
tion). (b) The scatterplot of recovered pure cell gene expression proﬁles
(MCF7 and HS27 cell lines). (c) The ﬂowchart of UNDO algorithm

for genes i = l,...,n,
xsamplel  all 5112 Stumor 
= —> x(i) 1
xsample2(i) Q21 5122 Sstroma(i) ( )

= alstumorﬁ) + 325stroma(i),

where stum0r(i) and sstroma(i) are the gene expression values in
pure cells, xsamplel(i) and xsamplezﬁ) are the gene expression
values in heterogeneous samples and aJ-k are the mixing propor-
tions with all + an = a21 + an (after signal normalization). Our
method is built on a linear mixture of normalized raw measured
data without log transformation (Ahn et al., 2013). We further
adopt the concept of cell-speciﬁc MGs (Yoshihara et al., 2013),
i.e. genes whose expressions are exclusively enriched in a particu-
lar cell population, or mathematically s(iMG_mm0r) m [04,- 0]T and
s(iMG_Stroma) % [0 ,Bi]T. As raw measured gene expression values
are non-negative, when cell-speciﬁc MGs exist for each cell type,
the linear latent variable model (1) is identiﬁable using two or
more mixed expression proﬁles, supported by the following
newly proved theorems:

THEOREM 1 (scatter compression). Suppose that pure cell expres-
sions are non-negative and x(i) = alsmmor(i) + azsstromaﬁ) where a1
and a2 are linearly independent, then, the scatterplot of mixed
expressions is compressed into a scatter sector { Fig. la, the set
of light blue cross ) whose two radii coincide with al and a2.

THEOREM 2 (unsupervised identiﬁability). Suppose that pure cell
expressions are non-negative and cell-specific M Gs exist for each
constituting cell type, and x(i) = alsmmor(i) + azsstromaﬁ) where a1
and a2 are linearly independent, then, the two scatter sector radii a1
and a2 of mixed expressions can be readily estimated from marker
gene expression values.

(See Supplementary Information for the formal proofs.)

Supported by the newly proved theorems, the UNDO algo-
rithm performs the following major steps (Fig. lo):

(1) preprocessing: quality control and removal of the minim-
ally expressed genes whose norm is less than a pre—ﬁxed
positive small real number and outlier genes whose norm
is bigger than a pre—ﬁxed positive large real number on
normalized raw data;

(2) dimension reduction when the sample number is larger
than two;

(3) marker gene detection: identify the indices of cell-speciﬁc
MGs located around the two radii of scatter sector that
correspond to the genes with minimum/maximum ratio
between the two mixed samples (Fig. la—lb, the set of
orange diamond);

(4) estimate tumor—stroma proportions using marker gene

 

expressions;
{11 = ; &,
meant). ,EMG_,umO, “x(i) ll 2)
a2 = l x(i) (

nMG—stroma iEMG_Stroma 

where MG—tumor and MG—stroma are the index sets of
MGs, and nMG_tumor and nMG_stroma are the numbers of
MGs, for tumor and stroma, respectively; and M.“ denotes
the vector norm;

(5) estimate cell-speciﬁc expression proﬁles using matrix
inversion.

More details on UNDO method, algorithm, parameter
settings and alternative schemes are given in Supplementary
Information.

2.2 Experimental validation and case study

We use ﬁve complementary evaluation criteria and the ground
truth to assess the performance of UNDO method and algo-
rithm. To assess the accuracy of cell proportion estimates, we
use both Pearson correlation coefﬁcients and E 1 index (Moreau,
2001). To evaluate the accuracy of the estimated cell-speciﬁc
expression proﬁles, we calculate the Pearson and concordance
correlation coefﬁcient (rp and re) between the estimated expres-
sion proﬁle and ground truth over both ‘marker genes’ (correct
and rigorous way) and ‘all genes’ (can be misleading due to sig-
niﬁcant number of housekeeping genes). To assess the match/
mismatch of membership/rank between the MGs detected from
pure versus mixed expressions, we use Venn diagrams and
Spearman’s rank correlation coefﬁcient.

To validate UNDO method and algorithm, we reconstituted
tumor—stroma mixed expressions by multiplying pure expres-
sions by pre—designed proportions. Solely using mixed
expressions, UNDO accurately estimated the MGs, mixing pro-
portions with rp = 0.99, cell-speciﬁc expression proﬁles with
rp = 0.99 and rc = 0.99 (see Supplementary Information).

We then tested UNDO algorithm on biologically mixed
expressions from two breast cancer cell lines (MCF7-tumor

 

138

112 /§JO'S{eumo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

UNDO

 

(3)1“? MCFI’ (bJHIm: H52?

All gums- All gens:
3 Marker gens: ‘ I Marker gene:

 

 

n.-
nJ. uh
I

E stim atsd expression

Estimated expression

F133 Elm-'9? I'D 39.11.93

5
."

 

 

 

 

,r‘“...... 
I: [F | I! 3 IF 3 35 '.- :IE 1 1'.” E if 3 3-!-

Measursd ssprssslsn A I; Massuned expression 1 1:4
Fig. 2. (a) The scatterplot of the estimated versus true gene expression
proﬁle of MCF7 cell line. (b) The scatterplot of the estimated versus true
gene expression proﬁle of HS27 cell line

and HS27-stroma). The mRNA extracted from the individual
cell lines are mixed with pre—speciﬁed proportions. Such mixtures
mimic the actual biological samples with varying abundances
of the constituent subsets from one another. UNDO method
again accurately estimated the cell mixing proportions with
E1 = 0.0778 (rp = 0.99) and cell-speciﬁc expression proﬁles
with average rp = 0.99 and rc = 0.98 between the deconvoluted
expression proﬁle and the measured expression proﬁle in the
pure cell lines (Fig. 2). The highly accurate deconvolution results
obtained suggest not only the existence of cell-speciﬁc MGs but
also UNDO’s ability to detect them blindly and correctly.

We further assess UNDO’s ability to detect differentially
expressed genes (DEGs) without deconvolution. We compared
the ranked DEGs indices detected by UNDO directly from
mixed expressions, with the ‘gold standard’ reference DEGs
identiﬁed from pure cell expressions, using Venn diagram,
Spearman’s rank correlation coefﬁcient (rrank = 0.92) and
receiver-operating characteristic curve (AUC = 0.85). See
Supplementary Information for more results on testing UNDO
against ground truth and the estimates by BACOM 2.0 and
ABSOLUTE on benchmark and TCGA/CPTAC datasets.

3 DISCUSSION

The UNDO software delivers a completely unsupervised
deconvolution method for dissecting tumor—stroma mixed gene

expressions (Supplementary Table S4). Tested on many bench-
mark datasets, UNDO is effective at detecting cell-speciﬁc MGs
and DEGs and estimating cell proportions and cell-speciﬁc
expression proﬁles. We expect UNDO method, with a
Bioconductor R package, to be a useful tool for extracting cell-
speciﬁc molecular signals in studying tumor—stroma interactions
in many biological contexts. Though the UNDO method cur-
rently works for two-source mixtures only, it is principally
applicable to the situation where tumor or non-tumor tissue is
assumed to have a common composition of cellular subtypes
across the tumor samples.

Funding: This work was supported by National Institutes of
Health [Grant numbers NS29525, CAl49l47, CAl60036,
HL111362], in part.

Conflict of interest: none declared.

REFERENCES

Ahn,J. et al. (2013) DeMix: deconvolution for mixed cancer transcriptomes using
raw measured data. Bioinformatics, 29, 1865—1871.

Carter,S.L. et al. (2012) Absolute quantiﬁcation of somatic DNA alterations in
human cancer. Nat. Biotechnol, 30, 413—421.

Chen,L. et al. (2011) Tissue-speciﬁc compartmental analysis for dynamic contrast-
enhanced MR imaging of complex tumors. IEEE Trans. Med. Imaging, 30,
2044—2058.

Clarke,J. et al. (2010) Statistical expression deconvolution from mixed tissue sam-
ples. Bioinformatics, 26, 1043—1049.

Clarke,R. et al. (2008) The properties of high-dimensional data spaces: implications
for exploring gene and protein expression data. Nat. Rev. Cancer, 8, 37—49.
Gosink,M.M. et al. (2007) Electronically subtracting expression patterns from a

mixed cell population. Bioinformatics, 23, 3328—3334.

Hoffman,E.P. et al. (2004) Expression proﬁling-best practices for data generation
and interpretation in clinical trials. Nat. Rev. Genet., 5, 229—237.

Junttila,M.R. and de Sauvage,F.J. (2013) Inﬂuence of tumour micro-environment
heterogeneity on therapeutic response. Nature, 501, 346—354.

Moreau,E. (2001) A generalization of joint-diagonalization criteria for source
separation. IEEE Trans. Signal Process, 49, 530—541.

Yoshihara,K. et al. (2013) Inferring tumour purity and stromal and immune cell
admixture from expression data. Nat. Commun., 4, 2612.

Yu,G. et al. (2011) BACOM: in silico detection of genomic deletion types and
correction of normal cell contamination in copy number data. Bioinformatics,
27, 1473—1480.

 

139

112 /§JO'S{eumo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

