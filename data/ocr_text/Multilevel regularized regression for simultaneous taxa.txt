Bioinformatics, 31 (7), 2015, 1067—1074

doi: 10.1093/bioinformatics/btu778

Advance Access Publication Date: 20 November 2014
Original Paper

 

Systems biology

Multilevel regularized regression for
simultaneous taxa selection and network
construction with metagenomic count data

Zhenqiu Liu1'*, Fengzhu Sunz, Jonathan Braun3,
Dermot P.B. McGovern4 and Steven Piantadosi1

1Samuel Oschin Comprehensive Cancer Institute, Cedars-Sinai Medical Center, Los Angeles, CA 90048, USA,
2Molecular and Computational Biology Program, Department of Biological Sciences, USC, Los Angeles, CA 90089,
USA, 3Department of Pathology and Laboratory Medicine, David Geffen School of Medicine at UCLA, Los Angeles,
CA 90095, USA and 4F. Widjaja Foundation - Inflammatory Bowel and lmmunobiology Research Institute, Cedars-
Sinai Medical Center, Los Angeles, CA 90048, USA

*To whom correspondence should be addressed.
Associate Editor: Igor Jurisica

Received on July 21, 2014; revised on 0ctober30, 2014; accepted on November 17, 2014

Abstract

Motivation: Identifying disease associated taxa and constructing networks for bacteria interactions
are two important tasks usually studied separately. In reality, differentiation of disease associated
taxa and correlation among taxa may affect each other. One genus can be differentiated because it
is highly correlated with another highly differentiated one. In addition, network structures may vary
under different clinical conditions. Permutation tests are commonly used to detect differences be—
tween networks in distinct phenotypes, and they are time—consuming.

Results: In this manuscript, we propose a multilevel regularized regression method to simultan—
eously identify taxa and construct networks. We also extend the framework to allow construction
of a common network and differentiated network together. An efficient algorithm with dual formu—
lation is developed to deal with the large—scale n<< m problem with a large number of taxa (m) and
a small number of samples (n) efficiently. The proposed method is regularized with a general Lp
(p 6 [0,2]) penalty and models the effects of taxa abundance differentiation and correlation jointly.
We demonstrate that it can identify both true and biologically significant genera and network
structures.

Availability and implementation: Software MLRR in MATLAB is available at http://biostatistics.
csmc.edu/mlrr/.

Contact: Iiuzx@cshs.org

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

Massive 16S rRNA and Whole—metagenomic shortgun sequencing
data have been generated due to advances in next—generation
sequencing technologies. The goals of metagenomic research are to
investigate the host—microbiota associations and bacteria inter—
actions, and examine how changes in microbiota may affect

metabolic functions and human disease. Two crucial research prob—
lems, disease associated taxa (genera, operational taxonomic units
[OTUs]) selection and correlation network constructions, are usu—
ally studied separately. Both filter and model—based approaches have
been proposed to detect differences in bacteria composition and rela—
tive abundance. Filter—based statistical tests select disease—associated

©The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1067

112 /810'spaumo [p.IOJXO'SODBIHJOJUIOICWZdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

1068

Z.Liu et al.

 

bacteria features one at a time (Alekseyenko et al., 2013; White
et al., 2009) and suffer from multiple comparisons problem. Model—
based approaches, on the other hand, identify disease—associated
taxa through building a sparse prediction model (Liu et al., 2011;
Tanaseichuk et al., 2013), and are efficient for explicitly evaluating
the predictive power of multiple taxa. However, these methods
mainly focus on differences in abundance without considering the
interactions among taxa.

Biological and taxa association networks have been constructed
with various methods (Horvath and Dong, 2008; Kramer et al.,
2009; Ruan et al., 2006; Xia et al., 2013). Such networks investigate
the interactions and causality among group of genes systematically.
Metabolic networks have also been proven to be powerful tools for
studying the physiological and biochemical characteristics of various
functional and evolutionary properties of a cell (Guimera and Nunes
Amaral, 2005; Kreimer et al., 2008). A local Poisson graphical (log—
linear) model and a Bayesian generalized graphical model have been
proposed recently for constructing association networks based on
RNA—seq data (Allen and Liu, 2013; Zhang and Mallick, 2013).
Among all the methods, various graphical models with L1 regular—
ization are perhaps the most common approach for graphical struc—
ture estimation (Banerjee et al., 2008; Liu and Ihler, 2011;
Meinshausen and Buhlmann, 2006; Peng et al., 2009; Yuan and Lin,
2007). L1 regularized approaches are based on neighborhood selec—
tion for each variable (gene) 1'. They build a L1—based sparse regres—
sion model for each X), with the remaining variables
X_,- : {Xilj 7E i}, and determine the sparse graphical model with the
collected regression coefficients. They have also been extended to
dependency network construction with sparse Bayesian network
structure learning (Xiang and Kim, 2013). L1—based approaches
automatically identify a number of dependent genes and are compu—
tationally efficient for large—scale network construction, but these
approaches construct the network without considering differenti-
ation of the genes across different clinical conditions. In addition,
parameters estimated from L1 penalized regression are asymptotic—
ally biased and L1 does not always identify the true model consist—
ently (Zou, 2006). Therefore, elastic net with ocL1 —l— (1 — oc)L2
(03x31), which is equivalent to Lp (1 g p g 2), was proposed
for choosing highly correlated genes (Zou and Hastie, 2005),
and Lp (0 < p < 1) penalized regression was proposed for
reducing the biases of estimates (Liu et al., 2010b; Mazumder et al.,
2011)

In this article, we develop sparse multilevel models for simultan—
eous gene selection and network construction, and simultaneous
common and differentiated network construction under different
clinical conditions. An efficient algorithm with duality and a general
Lp (p E [0,2]) penalty is also developed to deal with the 11 << m prob-
lem efficiently. We also propose a novel criteria entitled mean par—
ameter difference (MPD) for 2 and p selection. Our methods will be
evaluated with simulated and real metagenomic count data. Since
the variance of metagenomic counts depends on the mean count, the
data are first transformed to a normal distribution using the arcsin
and log—ratio variance—stability methods (Friedman and Alm, 2012;
Liu et al., 2011). We demonstrate that the proposed approaches suc—
cessfully identify true and biological important taxa and network
structures associated with the disease.

2 Methods

Given 11 samples with phenotype y = [y1, . . .,yn]T, our goal is to
identify phenotype associated taxa and simultaneously detect the

network structure of those species. We are also interested in
detecting network differences associated with distinct clinical
conditions. For each sample, we have multiple metagenomic count
features including the number of 16S rRNA clones assigned to a spe—
cific taxon, or the number of shotgun reads mapped to a specific
biological pathway or subsystem. The data structure can be
represented as:

X : , and y = ,
xn1 xnz . . . xnm y”

where X is the metegenomic count matrix with 11 samples and m fea—
tures, xkl- denotes the total number of reads of feature j in sample 13,
and y is a binary vector that indicates clinical conditions. A multi-
class y will be encoded with the one—versus—rest or one—versus—one
scheme. There are two standard approaches to model metagenomic
count data. One is to model the sequencing counts directly with
zero—inflated Poisson or negative binomial regression (Greene, 1994;
Lambert, 1992; Mullahy, 1986). However, this approach is compu—
tationally intensive especially for high—dimensional data. Building a
network of decent size requires hours or even days. In addition, the
joint likelihood is hard to estimate, so many likelihood—based vari—
able selection criteria such as cross—validation and AIC cannot be
applied. We, therefore, will adapt the computationally more effi-
cient approach by first normalizing data through transformation,
and then applying the machine learning or statistical tools. Data
transformation has also been proposed for analyzing similar RNA-
seq count data (Zwiener et al., 2014). To adjust for the read—depth
differences in sequencing, the metagenomic count matrix X is first
transformed into a proportion matrix P : [pki], where pkl- : xki/
Zixkl- and Z]- pkl- : 1. To overcome variance heterogeneity
with compositional data, the proportion matrix P is then converted
into a normally distributed matrix Z : [zki] with the arcsine or log—
ratio transformation. zkl- : 2arcsin  (Liu et al., 2011;
Sherbecoe and Studebaker, 2004). For the log—ratio transformation,
there may be zeros in the proportion matrix. Therefore, we first
replace

5k,"  I 0

pki : . 7

(1 — Zilpki205k1)pki lfpki > 0
where 5,25 is a small imputed value for pk]; Then the log—ratio trans—
formation yields

Z : lzkilnxnw zki 210377

where pk", is the value in the last column of the P matrix (Neocleous
et al., 2011). Usually, the values in the last column are the number
of sequences that were not assigned to any known taxon with the
RDP classifier (rdp.cme.msu.edu), or the sum of sequencing counts
in OTU clusters where the total number of counts is below a given

threshold.

2.1 Multilevel regularized methods

Given normalized Z : [me/(mm and binary clinical output y, the task
is to identify taxa that are different between clinical conditions, and
identify correlation structures among taxa. We propose multilevel
neighborhood selection methods that incorporate both Z and y.

112 /810'spaumo [p.IOJXO'SOleIHJOJUIOICI/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

Taxa selection and network construction

1069

 

Three different levels of distributions under different conditions are
proposed:

(1) =P(Zi|Qi) = P(Zi|YaZ—i) =
P(z,-|y,z1,zz...z,-_1,z,-+1...zm),
(H) I P(Zi|Qz) = P(Zi|Z—iaYZ—i) =
P(z,-|z1...z,_1,z,+1...zm,z1y...z,_1y,z,+1y...zmy),
(1H) =P(Zi|Qi) = P(Zi|YaZ—iaYZ—i) =
P(z,-|y,z1...z,_1,z,+1...zm,z1y...z,_1y,z,+1y...zmy),
for i : 1, . . . ,m and yzl- : y (9 z,- is an element-wise multiplication. For
each taxon i, P(z,-|Q,-) is the conditional probabilities given a different
set of variables. Assuming P(X,-| Qi) is a Gaussian distribution, the con—

ditional probabilities in Models (I)—(III) can be inferred by different lin-
ear regression models, where each z,- is a linear combination of Q,.

2,- : aiy + biTZ_,- + 61' = my + Z (91ij + 617 for (I): (1)

1': 1
T 1751
Z,‘ = 131- Z_,' + CITYZﬂ' + 61' =
= Z bil-zl- -)— Z ciiyzl- -)— 61', for 
j: 1 : 1
i751 (731'

Z,‘ I cry -(— bITZ_,' -(— CITYZﬁ' + 61' =

= my + Z biizi + Z ciiyzl- -)— 61' for 
i = 1 i = 1
i 74 i i 74 1

Equation (3) is the most general model conditional on the rest of
the taxa X_,-, phenotype y and their interactions. Equation (3) reduces
to Equation (2) and Equation (1), and Model (III) becomes Models
(II) and (I), respectively, when setting 61,-: 0 or c,- = 0. In the rest of
this article, we will explore algorithms only for Equation (3). The
same computational approach can be used for Equations (2) and (1).
In Model (3), the parameter 61,- represents the associations between X,-
and y, a,- 74 0, indicates that taxon z,- is differentiated under different
clinical conditions (y). The value of b,- measures the direct dependency
between taxon z,- and the remaining taxa, and bi,- 74 0 shows there is a
correlation between 2,- and z,- given all other variables. In addition, c,-
determines correlation changes across different clinical conditions,
and 617' 74 0 suggests that there is a differentiation in correlation be-
tween case and control. Therefore, depending on the problem under
study, we can simultaneously identify the differentiated taxa and con—
struct a common and a differentiated network using 61,-, b,,- and 6,7, re—
spectively. Because it is common that 11 << m in genomic and
metagenomic data, learning the local graphical structure is usually
based on L1. More generally Lp (p g 2)—based regularized regression

for each 2,- to minimize the following error function:

2

_[_
2

aiy+ Z libii-I- Z yzl-cil- —Z,')
i=1 7:1
i751 i751

1
E(ai7bi7 Ci) : E

 

 

 

 

l m m
-+§ Idz|p+ Z “917)er Z lCi/‘lp -

i=1 i=1

(751 (751'

This will yield a sparse solution with a small number of nonzero
parameters when p E [0, 2). With the ordinary lasso (p = 1), the error
function E will be convex. An unique solution can be found for a
given 2, but the estimation is biased toward zero. On the other hand,
the solution will have the attractive oracle property with p < 1. Lp re-
gression selects the correct models by producing nearly unbiased esti—
mates for the non—zero parameters while forcing the other parameters
to zero. However, the error function E is not convex when p < 1.
Even though there are efficient algorithms with L1 for high-dimen-
sional data, efficient algorithms with general Lp penalized regression
are less well developed. Based on our previous work for survival ana—
lysis (Liu et al., 2010b), we propose an expectation maximization
(EM)-like algorithm to deal with the high-dimensional problem.

2.2 Efficient EM—Iike algorithm for Lp penalized
regression
Let

91 2 [Y7 Z—ia yZ—ilnx2m—1

V i = 1, . . . , m. We drop the sub—index i in z,- and Q,- for simplicity.
T
C11

An EM-like algorithm for a generic Q 2: and 2 can be de—

T
(In
veloped as follows. Given the parameters 0 = [01,. . .02m_1]T, where

T T
01 = a), [02, . . . , 0m] = by, and [0m+1, . . . , 02m_1] = C1, the error
function to minimize is

EU?) =-||Z—Qf?||§+-Z|9i|p =- (Zk—q£0)2+_ Zleilp
2 2 ._ 2 _ 2 ._
1—1 [3—1 1—1
1 11 [12171—1 
= is}. — qzer +2 2 —' 
k=1 i=1 lei)

(5)

where 2 > 0 is the penalty term and 71 << m. By introducing an auxil-

 

iary vector u = [141,142, . . . , u2m_1]T, we may rewrite Equation (4) as
E(0) — 1:1] T0)2 +421”—1 l ('2 d — a (6)
_ 2 k=1 Zk qk 2 i=1 Will—p, an H _ .

With Equation (5), we can estimate the M step by first minimiz-
ing E(8) (maximizing —E(0)) by taking the first order derivative and
setting it to zero.

8E 0 _ n
J = we lull P — Zak — anqk = o,
80 kzl
where ® indicates element—wise division. So
1 n _
9 2 12m — (139m 6 lul2 p-
[3:1

Instead of finding the high-dimensional (2m — 1) primal param-
eters 0 directly, we introduce n—dimensional dual variables
a = [611,612, . . . , an]T, so we have

1 n _ n _
9 = 12% — qf9)qk G lul2 ” = :61qu o M2 P 2 93a, (7)
k=1 k=1

where

Q; : lql G lull—1)an G lull—p7 ' ' ' 7 qn CDlull—pl(2111—1)><m 

112 /810'spaumo [p.IOJXO'SOleIHJOJUIOICI/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

1070

Z.Liu et al.

 

and

(z). — q)? )- (9)

>114

61k:

By substituting the primal variables 0 : QZa into Equation (9),
we have

1 1
a). 21m —q,ZQZa) 21W —k,fa), (10)
where

k?

lefqu f, andlet K,=QQZ= kg
kT

KM is a much smaller n x n symmetric matrix and is predeter—
mined as long as u is given. The dual variables a can be calculated in
matrix form as follows:

a = (K, +2042. (11)

The primal variables 0 can then be updated explicitly with a sim—
ple matrix computation.

6: 93a (12)

The expectation step is simply u = 0. Therefore, we have the EM
algorithm for each X,- and Q,- with the local graphical model:

 

EM-like Algorithm

 

Given a 2», p E [0,2], small numbers 6 and e, and training
data {z, 0},
Initializing 0 = rand(2m — 1,1),
While |0 — u| > e,

E-step: u = 0

lV|_Step:  : [(11 G IHIZ—pa' ' '7 qn CDIUIZ—pl(2m—1)><n7

K,, 2 00,7, and a = (K, +2042, and e 2 03a.

END
0(|0| < e) = 0.

 

 

 

The EM algorithm is highly efficient when n<< m, because it
uses the inverse of (KM +21)
(QTQ)(2m_1)X(2m_1), as in ordinary regression. Compared with one

mm matrix instead of the inverse of
with dimension of ten—thousands, inverting a matrix with hundreds
of dimensions is very fast. As discussed earlier, this algorithm will
converge to a global optimum with a p = 1, because the error func—
tion is convex. A local minimum is guaranteed with p < 1.
Computational experiences with Lp suggest that it converges to a
unique solution for p206, when the error function is nearly convex.
To construct a local graphical network, we run the EM-like algo-
rithm m times for each {2), Q,}, i = 1, . . . , m. The non-zero Bil-s indi-
cate a dependency between taxa i and 1'. Models for each node can
be estimated independently and in parallel using appropriate
computational power.

Negative correlations between genes are difficult to confirm and
seemingly less ‘biologically relevant’ (Lee et al., 2004). Negative cor—
relation can be introduced when count data are transformed into
proportions. For example, transforming two random samples with
zero correlation into proportions will lead to a perfect 72—1

negative correlation, which does not seem biologically sensible. Our
approach can be adapted to study positive dependency only by set—
ting 0(0 < 0) = 0 in the M—step of EM algorithm.

2.2.1 Determination of 1. and 12

Both 2 and p determine the sparsity of the model. 2 E [10_4, imax
: max (|Q,-z,-|)] is partitioned into 100 equal intervals in a log scale,
and p is chosen from 0 : 0.1 :2 in this article for simplicity. The
regularization parameter 2 and p are determined through cross—val—
idation. We build regression models with 100 different is and 20
different ps, the optimal 2 and p are then selected with either the
minimal mean squared error (MSE) of the test data or the most sta—
ble parameter (edge) estimation with 12—fold cross—validation. Other
criteria such as AIC and BIC can also be used to find the optimal 2
and [9. Although cross—validation with MSE is straightforward, sta—
bility selection chooses an optimal 2 with the minimal mean differ-
ence of the estimated parameters. Mathematically, we first estimate
12 sets of parameters {0i}, i = 1,. ..,/e with 12—fold cross—validation,
and the MPD for given 2 and p is defined as

MPD — —Zf=1|6i _ El
_ k

, where P is the average of Hi .

MPD is similar to the stability selection (StARS) approach which
identifies the most stable set of parameters with cross—validation
(Liu et al., 2010a). Because MSE is known as a loose criteria for L1,
and MPD is a more conservative measure tending to select less vari—
ables, the optimal p chosen with MPD is usually larger than 1,
whereas the optimal p with MSE is less than 1. In addition, a node
(taxon) will be dropped out when the test MSE is larger than a pre—
determined threshold.

3 Results

3.1 Simulation data

Count data for simulation are generated with Poisson distributions
and known correlation structure (Zhang and Mallick, 2013). The
count x),- has a Poisson distribution Pois(t,-,-) with mean 1,7, and log
t),- has normal distribution N (u, 2) with mean ,u and covariance Z.
An adjacency matrix can be measured by A : 2‘1. We simulated
data with two groups, with the number of nodes (variables) of
m : 200, and sample size n = 20, 40 and 60 for each group, respect—
ively. The mean u,- (i = 0, 1) for each group is 110 :
[2,2,2,2,2,2. . .2]T and p1 = [4,4,4,4,4,2, . . .,2]T, respectively, so
the generated data only have the first five features differentiated.
Therefore, we have a binary class problem with y : [321, . . . ,yan,
where yk : 0 if sample [a E group 0 and yk : 1 for sample [a E group
1. Three different network structures were incorporated in the data:
(i) a common network structure A, where A is a band matrix with
bandwidth 1 and each node only connects to its neighborhood
nodes, (ii) a common network structure A, where A is a band matrix
with bandwidth 2 and (iii) different network structures with A0
being an adjacency matrix of bandwidth 1 for class 0, and A1 being
an adjacency matrix of bandwidth 2 for class 1. After we generated
the count matrix X with known network structure A and class infor—
mation y, Equation (1) was used to detect differentiated features and
the common network structure simultaneously with the first two
datasets. We simulated these data 100 times. The generated count
data were then transformed with proportion and arcsin transform-
ations. The log—ratio transformation yields similar performance, so
only results with proportion and arcsin transformations are reported
in this article. Five—fold cross—validation was used to determine the

112 /810's112u1no [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Taxa selection and network construction

1071

 

Table 1. Predicted AUCs with different network structures and
parameters

 

Sample Band 1 network Band 2 network

size

 

n MSE:[5=0.8MDP:[5=1.1MSE:[5=0.9MPD:[5=1.2

 

20 083(i0016) 089(i0013) 070(:oo10) 076(i0012)
4o 094(:0007) 097(:0007) 074(:oo12) 083(i0010)
60 097(:0007) 099(i0006) 079(:oo13) 087(i0010)

 

Notes: Data were simulated with m=200, and 11:20, 40 and 60,
respectively.

Table 2. Frequencies of correctly identified features and average
false-discovery rate over 100 simulations

 

Feature Band 1 network (71) Band 2 network (71)

 

MSE:[5=0.8 MDP:[5=1.1 MSE:[3=0.9 MPD:[5=1.2

 

20 40 60 20 40 60 20 40 60 20 40 60

 

51 81 90 83 93 100 53 79 100 100 100 100
42 60 73 80 93 94 49 67 85 90 100 98
40 46 70 84 91 92 35 48 93 82 91 96
59 62 75 70 93 97 30 56 78 94 96 96
80 94 99 93 95 99 40 58 91 89 96 95
AFPR 2.7 1.7 1.4 0.36 0.03 0 3.5 2.7 2.1 3.8 3.5 2.8
(%)

S/‘I-PUJNH

 

Notes: Only the ﬁrst ﬁve features are truly differentiated.

optimal parameters 2 and p. The area under ROC curves (AUC) was
used to evaluate the performance of detecting proposed network
structures, where the sensitivity for a network is the proportion of
edges that are correctly identified, whereas the specificity for a net—
work measures the proportion of no—edges that are correctly de—
tected. The ROC curve and AUC were then calculated accordingly.
Moreover, the performance of feature selection is defined as the
number of times that the first five features are correctly identified.
AUC for validating the network structures and the number of times
that the first five true features are selected are reported in Tables 1
and 2, respectively.

Our methods identified the true differentiated features and net—
work structures as shown in Tables 1 and 2. Overall, the predicted
AUCs become larger when the sample size increases. In addition,
minimizing MPD performs better than minimizing test MSE.
Compared with the average AUCs of 0.83, 0.94 and 0.97 with MSE
for band 1 network, the corresponding AUCs with MPD are 0.89,
0.97 and 0.99 for 11:20, 40 and 60, respectively. Similar results
were achieved for band 2 network with different sample sizes and
optimal parameters. With 11:20, 40 and 60, respectively, out of
100 simulations for band 1 network, more than 40, 46 and 70 times
of five differentiated features were appropriately identified with
MSE, whereas more than 70, 91 and 92 times of the five features
were correctly selected with MPD. MSE identified at least 30, 48
and 78 times of five differentiated features correctly for band 2 net—
work, whereas MPD accurately selected the five features at least 82,
91 and 95 times, indicating that MPD is more accurate. The accur—
acy of feature identification increases with sample size. Five features
were identified correctly over 92 and 95 times with MPD and the
sample size of 60 for band 1 and 2 networks, respectively, whereas
the average false—positive rates (AFPR) were all under 5%.

The comparison between our approach and Student’s t—test with the
same data is reported in Supplementary Appendix 81. Student’s t—
test leads to high FPRs and fails to identify the true features even
with the conservative Bonferroni correction. Feature selection with
network correction is important, and the proposed approach pro—
vides an efficient way to accomplish it.

Differentiated features, and common and differentiated network
structures can also be identified simultaneously with Equation (3).
Simulated data were generated with the Poisson distribution with
known means and network structures. Data for class 0 is again gen—
erated with mean no and a band 1 network and for class 1 is gener-
ated with M1 and a band 2 network, respectively. So the class output
y is defined similarly as the previous simulations, and the common
network to detect is the band 1 network the differentiated network
to identify is the differential structure between band 1 and 2 net—
works. Equation (3) is used to evaluate the performance. Predictive
performance of proposed method is shown in Figure 1:
Differentiated features, and the structures of common and differenti—
ated networks were detected with high accuracy. Because MSE usu—
ally has the best performance when p < 1, and MPD has the best
performance when p > 1, we define a new integrated performance
measure that chooses the optimal 2 = (2M5E —l— 2MpD)/2 in roman>
for variable selection. AUC for differentiated features (bottom panel
Fig. 1) can be identified perfectly (AUC: 1) with a larger sample
size (11:40) for each group. The common network structure (top
panel of Fig. 1) can be detected with over 0.91 AUC, while distin—
guishing the differentiated structure is more difficult with the test
AUC of over 0.74. In addition, AUCs increase as the sample size be—
comes larger. Finally, the performances with L1 and Lp(p : 11)
penalties are quite similar with the integrated measure, indicating
that it is possible to achieve a good performance with L1 regularized
regression with an appropriate measure.

3.2 Benchmark metagenomic data

A metagenomic dataset was generated from research findings in our
own group (Tong et al., 2013). A recent analysis of microbial co—oc—
currence in the HMP cohort revealed significant relationships across
many body compartments, including 3005 edges and 67 edges
among microbiota of all body sites and the gut (fecal compartment),
respectively. The differences (if any) may be due to healthy only sub—
jects, different cohorts and fecal (versus mucosal wash compart—
ments). There are in total 299 samples with 76 inﬂammatory bowel
disease (IBD) subjects including Crohn’s disease (CD) and ulcerative
colitis (UC), and 223 non—IBD subjects. Out of 299 samples, 285
(72 IBDs and 213 controls) have metagenomic count data available.
There were a total of 5648 OTUs available. We merged OTUs at the
genus level. Then genera with high abundances were selected for fur—
ther study after discarding those genera with less than five reads on
average. Data were then normalized with the proportion and arcsin
transformation. The class y is a binary vector with yk : 0 for non—
IBD, and yk: 1 for IBD samples or vice versa. The input Z is the
normalized taxa matrix. To identify differentiated genera and posi—
tive correlations in whole, IBD and non—IBD populations, we run
the program for Equation (3) two times with 0/1 values flipped.
Five—fold cross—validation and MPD were used to find optimal
(2*, p*). Our program (mlrr) identified the optimal parameter pair
(2*, p*) and determined the best model automatically. Genes with
higher abundance in IBD and non-IBD are reported in Table 3.
Eight identified genera have higher abundance in IBD, whereas 20
have higher abundance in non—IBD, indicating less bacterial diversity
in IBD patients. Common and differentiated networks are shown in

112 /810's112u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

1072

Z.Liu et al.

 

 

0.8-
0.6-
0.4- : AUC=O.93
: AUC=O.94
0.2-
: AUC=O.96

 

 

 

 

0.6 0.8 1

 

 

 

 

 

 

 

 

 

1.-
d.) 0.8-
.2
'6 0.6-
o
0.
O 0.4“ n=20: AUC=O.74
:5
L ‘ ---n=40: AUC=O.76
'— 0.2
--'-'n=60: AUC=O.78
0 I , . .
0 0.2 0.4 0.6 0.8 1
1r___,l_l__h_,_,_|__——i—._
!
08]
06I
' I
0.4: n=20zAUC=O.88
i - - -n=40:AUC=l.O
0-2 -----n=60: AUC=1.0
0

 

 

 

o 0.2 0.4 0.6 0.8 1
False positive

 

1.- ._._- . _ . _ ._\_|—|!l—I

0.8- ‘

0.6-'-

 

   

n=20: AUC=O. 91
- - -n=40: AUC=O. 97
'-'-'n=40: AUC =O.97

0.4-

0.2-

 

 

 

0 0.2 0.4 0.6 0.8 1

Diff Network

 

1.-
0.8:

0.6-5

 

 

 

 

 

0.4-- n=20: AUC=O.76

- ---n=40: AUC=O.77

02' u-I-'n=60: AUC=O.8O
0

0 0.2 0.4 0.6 0.8 1

 

 

n=20: AUC=O.98
---n=40: AUC=1.0
'-'-'n=60: AUC=1.0

 

 

 

0.2 0.4 0.6 0.8 1
False positive

Fig. 1. Performance base on AUC for common and differentiated networks and differentiated features with P21 and 1.1, respectively. Top panel: AUC for com-
mon network detection, middle panel: AUC for differentiated networks and bottom panel: AUC for feature selection

Table 3. Identified Genera that are differentiated in relative abun-
dances across different clinical conditions

 

 

 

IBD non—IBD
Genera Parameters Genera Parameters
Acidaminococcus 0.0078 Bilop/az'la 0.0020
Bacteroides 0.0091 Blautia 0.001 1
Escherichia 0.0022 Clostridium 0.0014
Fusobacterium 0.0105 Collinsella 0.0010
Klebsiella 0.0626 Coprococcus 0.0057
Lactobacillus 0.0051 Desulfoz/z'brio 0.0034
Mycoplasma 0.0022 Dorea 0.0013
Veillonella 0.008 1 Eubacterium 0.0013
Faecalibacterium 0.03 19
Haemop/az'lus 0.0029
Holdemcmz'a 0.0012
Lacbnobacterium 0.0013
Lac/mospz'm 0.0040
Oscillospira 0.0028
Pbascolarctobacterium 0.0021
Prevotella 0.01 13
Pseudomonas 0.0013
Roseburia 0.0033
Ruminococcus 0.0042
Sutterella 0.0058

 

Notes: The estimated parameters are reported in columns 2 and 4, respect-
ively. The larger the parameter value, the more differentiated the genera.

Figures 2 and 3, respectively. Several important findings are demon—
strated with Table 3, Figures 2 and 3 together. Genera Klebsiella has
higher abundance in IBD with the largest estimated parameter
(0.0626). It also has the highest degrees of 13 and 7 in common and
control network, respectively. Klebsiella is probably harmful, be—
cause it loses its connections (co—occurrences) with other genera and
has higher abundance in IBD. Disease status is determined by both
the relative abundance of Klebsiella and its co—occurrence patterns
with other genera. In fact, Klebsiella is a well—studied IBD—associated
bacteria. It is a likely triggering factor associated with the initiation
and development of IBD (Rashid et al., 2013; Sanchez et al., 2013).
On the other hand, genera Faecalibacterium has higher abundance
in non-IBD (lower abundance in IBD) with the largest parameter
0.0319. It also has the largest degree of 13 in the common network,
and is connected to Ruminococcus in the IBD network. This may
indicate that Faecalibacterium is a protective genera and its lack
may contribute to IBD. The fact that Ruminococcus and
Faecalibacterium link to each other and both have lower abundance
in IBD suggests that the co—abundance of Ruminococcus and
Faecalibacterium may be useful for IBD diagnosis. The association
between Faecalibacterium and IBD has been an active topic of re—
search recently in the literature (Lopez—Siles et al. 2014; Machiels
et al., 2013). Investigators have shown that Faecalibacterium is rele—
vant to the etiology and pathogenesis of IBD both in clinical and la-
boratory investigations. However, the role of Ruminococcus and
its co—abundance with Faecalibacterium in IBD has not been

112 /810's112u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Taxa selection and network construction 1073

 

3,.

Akk ermancla
H

..--"".COE'I'CI DECIIfUS
{’7’- 

r

 

 

 

   
 

  

If Iii-_h-- l_.-" MILK!
,Anaem 31(5) 93’ foxﬁfparaiiacte rcicl_e 5   a. - .B IaquEI
.K ___-1"- _- .-"' ll. 1 Ix __T'--—1_ ___ HH'H._ 32'
I, _____.- I 'II -—.,_ ___
g” £;—-*;__ I R ___ ,Bactefcldesf
.21 ’Gdcrlb char 7 1.. If “a ———~—"'_".ButyrIvItIrIc
_L J" I" Jr"  g".
«Lachnccplra I k, . 2% __e_' f“— x-. :’
II.h __'._ _ . ~. r. ff". 1 _ I.
21 H“ 1., . Hcldemanla 1. 1‘, if»! If: Dﬁtr'd'um f/e Egger‘lhella
H 1 f "-, x  "a. ,
r '- __.5e_,r_«-' .-
 / . x” USCIIIOEPIFaF..---" t» —1‘F.—.e-‘———.
.Lachnobactenum Ii' // fr“ MIETIFIE'E-h———__ ,6 _/ If. -1Prevctell§
 " "fr" {Pier-'7- ____.-"-- - _h— ' _ "-1 __7'
. “main ll if 1119*” e" ‘1‘ f Anaerctruncue RUT'WWWHS “I ‘Dlallster
Deeulfcwhrimﬁf _”:__ ——— ___ T‘— Dcrea 1. Thai" “ah ,I' I
F____c——---“_fjﬁaecallhactenum  "4.x  
Pcrphyrorncnae I 'x M 'T'“-~—.____ SHOP h" a if  7% Catembacfenum
_ .. .u . “- . —#—ﬁ ' F, I up...
.F’IF .-"' I'll-'l \I‘ H.   K J "Hf-___? 
Mlcrcre-LJIEIa -_ __ " .x'"! " "T":-
. RDBEDUI’IE _.___ _______h “X. ~  My .Dolllnﬁeua
DrIbgﬂcrIum .ACldaminﬂmm—UE "-"Fff'F- .Elﬁdcqqcienum  ‘-
.Fuecbacferium—  _— —-"" "___— ! 'EIH‘E'EEIIE' \1 ,Lacfcbaclllus .Burkhclderla
__d_c——--':i- - Haemophilue THE ‘1 f
 ,1» (e.  a...  I 1-.
." r x e  '._L "a x. I; “___—I Escherlchla
Campylcbactcr f \ “a.” btrepfcccccuee—_ ___ _ "as, i ___-xr .
 -: “I. "a. “___—7* I-t—"
./' If ll'l \\ “~- ____ _—— ——— _:_T—~-*' FJebeIella..__ EI‘WIr‘IIEI
f I __'___I—I—"__F If 2'" “"x mm“—
Actincbaclllua I. ‘~ Seme'iffe-e-E ,r 1 Ram Parifcea
 I “‘ e!”  1 “:0
. I FIcthIa If Cnrcbacfer
Actincmycee b I!
Raouh‘ella
Granullca‘lella Serral'a
Myccplaema
Fig.2. Common network constructed across clinical conditions
{a}  .Akl-tcrrnanma ,Ge—mclla
 I
11.1.- 
1_~ I'll;
.C‘.I<:I STIIGIIur‘rI __ “g  .(IA'ZIEIEI'I'III'IC-DIEGUS
. _ ___i ll
 H th -
 acmcp I J5 .l #lx..DlahsTer
EH” .Parat-actercIde-3 'III 
.VEIllonEIIl-a \1  " ‘
- 1 I «x  Prechella _____. .-
Anacrcshpcs .Faaﬂajlbamﬂnum .  as”, :uftc-rclla
(chicr'lhclla a. ,- r___.-
1.! ' '  III-{___a-"r
. 1“. '-__-'7-l— .BlfldI-Jtlaﬂé'nlJFI-‘l- I 
Streptococcus  If” "R "an.
Parabactnmidas Rum'mmm“   alw- "an.
.—'———  _ __Klebmplla "n._ BECTE'I'CIIdE'S
. Emma   . - 1.
Akkannansla (If ,I  1..
 I'll.) "ELI-L 
Myccplasma 1" 2‘1.‘
Haciercides f b
Pcrphyromonas Aquat-aclcrlum
Achncbamllui
Fig. 3. Differentiated networks: a) network solely for IBD and b) network solely for non-IBD control
well studied. Another genera Haemophilus may also be important IBD network. The variation in co—occurrence networks may have
for IBD. It has the degree of 9 and 4 in common and non—IBD net— biological and clinical implications. Finally, less bacteria diversity
work, respectively, and has higher abundance in non—IBD. It loses its and interactions in IBD have been observed as shown in the genera
co—abundance with several other genera in IBD. The other genera list and IBD network. Therefore, it is important to study variations
such as Fusohacterium, Bacteroides, Veillonella, Lactohacillus and of relative abundance, and common (background) and differentiated
Escherichia with high abundance in IBD may be potential gut patho— networks systematically. Our approach can identify IBD associated
gens and associated with IBD. On the other hand, the 20 identified bacteria and provide potential targets for further investigations.
genera with higher abundance in non—IBD may be protective bac—
teria that are negatively associated with IBD. Moreover, genera such
as Bifidohacterium could be an important target for IBD, even if its 4 c I _
relative abundance does not vary between case and control. one us'ons
Bifidohacterium has interactions with other genera in both common We proposed a multilevel penalized regression method for simultan—

and non—IBD networks, but does not have any connections in the eous genera selection and network construction. We also developed

112 /810'S[12u1no prOJXO'SOTl‘BIHJOJUTOTQ/ﬂClllq 11101; pep1201umoq

9IOZ ‘OE lsnﬁnv uo ::

1074

Z.Liu et al.

 

an efficient EM-like algorithm with dual-formulation for solving a
general LP, p E [0,2] regularized problem. The proposed algorithm
includes L1 and elastic net 2L1 —l— (1 — 2)L2 penalties as special
cases, and efficiently deals with high-dimensional n<<m problem.
The elastic net penalty is equivalent to a Lp with p E [1,2]. We com—
pared the performance of the proposed method with different p val—
ues. Different optimal ps can be selected from different performance
measures. A p < 1 usually has the best performance with a loose
MSE measure, while a p > 1 will lead to the best performance with a
more conservative MPD criteria. LASSO achieves the best perform—
ance with the average of optimal 2s from test MSE and MPD. We
tested our method with simulated and real rRNA 16S sequencing
data. Comparing with available methods for network construction
and feature selection in the literature, the proposed approach identi—
fies true features and biologically important genera, and constructs
common and differentiated networks jointly with high accuracy. It
provides a novel tool for studying correlation and differentiation
together, and is computational efficient for high-dimensional meta-
genomic data. Recent work has greatly expanded the cohort size co—
analyzed for microbial community structure in new—onset IBD
(PMID: 24629344). The present methodology offers a new perspec—
tive on disease association and community structure that would be
particularly valuable in tackling such extensive datasets. The pro—
posed approach can also be applied to most RNA—seq data directly
provided they are normalized.

Funding

This work was partially supported by grants from National Science
Foundation [DMACz ADT-1220747 to Z.L.], Crohn’s and Colitis
Foundation of America [to ].B.], National Institutes of Health [DK46763 to
].B. and D.P.B.M.], National Institutes of Health NCRR and NCATS
[UL1TR000124 t0 

Conﬂict of Interest: none declared.

References

Alekseyenko,A.V. et al. (2013) Community differentiation of the cutaneous
microbiota in psoriasis. Microbiome,1, 31.

Allen,G.I. and Liu,Z. (2013) A local Poisson graphical model for inferring net-
works from sequencing data. IEEE Trans. Nanohiosci., 12, 189—198.

Banerjee,O. et al. (2008) Model selection through sparse maximum likelihood
estimation for multivariate Gaussian or binary data. ]MLR, 9, 485—5 16.

Greene,W.H. (1994) Some accounting for excess zeros and sample selection in
Poisson and negative binomial regression models. Working Paper EC—94-
10, Department of Economics, New York University.

Guimera,R. and Nunes Amaral,L.A. (2005) Functional cartography of com-
plex metabolic networks. Nature, 433, 895—900.

Friedman,]. and Alm,E.]. (2012) Inferring correlation networks from genomic
survey data. PLoS Comput. Biol., 8, e1002687.

Horvath,S. and Dong,]. (2008) Geometric interpretation of gene coexpression
network analysis. PLoS Comput. Biol., 4, e1000117.
Kramer,N. et al. (2009) Regularized estimation of large-scale gene association
networks using graphical Gaussian models. BMC B ioinformatics, 10, 384.
Kreimer,A. et al. (2008) The evolution of modularity in bacterial metabolic
networks. Proc. Natl Acad. Sci. U. S. A., 105, 6976—6981.

Lambert,D. (1992) Zero-inﬂated Poisson regression, with an application to
defects in manufacturing. Technometrics, 34, 1—14.

Lee,H.K. et al. (2004) Coexpression analysis of human genes across many
microarray data sets. Genome Res, 14, 1085—1094.

Liu,H. et al. (2010a) Stability approach to regularization selection for high di-
mensional graphical models. Adv. Neural Inform. Process. Syst., 24,
1432—1440.

Liu,Q. and Ihler,A. (2011) Learning Scale Free Networks by Reweighted L1
Regularization. AISTATS. JMLR Workshop and Conference Proceedings
Volume 15.

Liu,Z. et al. (2010b) Kernel based methods for accelerated failure time model
with ultra-high dimensional data. BMC Bioinformatics, 11, 606.

Liu,Z. et al. (201 1) Sparse distance-based learning for simultaneous multiclass
classiﬁcation and feature selection of metagenomic data. Bioinformatics,
27, 3242—3249.

Lopez-Siles,M. et al. (2014) Mucosa-associated Faecalihacterium prausnitzii
and Escherichia coli co-abundance can distinguish Irritable Bowel
Syndrome and Inﬂammatory Bowel Disease phenotypes. Int. ]. Med.
Microbiol, 304, 464—475.

Machiels,K. et al. (2013) A decrease of the butyrate-producing species
Rosehuria hominis and Faecalihacterium prausnitzii deﬁnes dysbiosis in pa-
tients with ulcerative colitis. Gut, 63, 1275—1283.

Mullahy,]. (1986) Speciﬁcation and testing of some modiﬁed count data mod-
els. ]. Econometrics, 33, 341—365.

Mazumder,R. et al. (2011) SparseNet: Coordinate descent with non-convex
penalties.]ASA, 106, 1125—1138.

Meinshausen,N. and Biihlmann,P., (2006) High-dimensional graphs and vari-
able selection with the lasso. Ann. Statist., 34, 1436—1462.

Neocleous,T. et al. (201 1) Transformations for compositional data with zeros
with an application to forensic evidence evaluation. Chemom. Intell. Lab.
Syst., 109, 77—85.

Peng,]. et al. (2009) Partial correlation estimation by joint sparse regression
models.]ASA, 104, 735—746.

Rashid,T. et al. (2013) The role of Klehsiella in Crohn’s disease with a
potential for the use of antimicrobial measures. Int. ]. Rheumatol., 2013,
610393.

Ruan,Q. et al. (2006) Local similarity analysis reveals unique associations
among marine bacterioplankton species and environmental factors.
Bioinformatics, 22, 2532—2538.

Sanchez,E. et al. (2013) Duodenal-mucosal bacteria associated with celiac dis-
ease in children. Appl. Environ. Microbiol, 79, 5472—5479.

Sherbecoe,R.L. and Studebaker,G.A. (2004) Supplementary formulas and
tables for calculating and interconverting speech recognition scores in trans-
formed arcsine units. Int. ]. Audiol., 43, 442—448.

Tanaseichuk,O. et al. (2013) Phylogeny-based classiﬁcation of microbial com-
munities. Bioinformatics, 30, 449—45 6.

Tong,M. et al. (2013) A modular organization of the human intestinal muco-
sal microbiota and its association with inﬂammatory bowel disease. PLoS
One, 8, e80702.

White,]. et al. (2009) Statistical methods for detecting differentially
abundant features in clinical metagenomic samples. PLoS Comput. Biol., 5,
1000352.

Xia,L.C. et al. (2013) Efﬁcient statistical signiﬁcance approximation for local
similarity analysis of high-throughput time series data. Bioinformatics, 29,
230—237.

Xiang,]. and Kim,S. (2013) A"‘ Lasso for learning a sparse Bayesian network
structure for continuous variables. Adv. Neural Inform. Process. Syst., 26,
(NIPS 2013) pp. 2418—2426.

Yuan,M. and Lin,Y. (2007) Model selection and estimation in the Gaussian
graphical model. Biometrilea, 94, 19—35.

Zhang,L. and Mallick,B.K. (2013) Inferring gene networks from discrete ex-
pression data. Biostatistics, 14, 708—722.

Zou,H. (2006) The adaptive lasso and its oracle properties. ]. Am. Stat.
Assoc., 101, 1418—1429.

Zou,H. and Hastie,T. (2005) Regularization and variable selection Via the
elastic net. ]. R. Stat. Soc. B, 67, 301—320.

Zwiener,I. et al. (2014) Transforming RNA-Seq data to improve the perform-
ance of prognostic gene signatures. PLoS One, 9, e85150.

112 /810's112u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

