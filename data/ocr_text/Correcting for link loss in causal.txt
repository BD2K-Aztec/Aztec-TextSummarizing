ORIGINAL PAPER

Vol. 30 no. 19 2014, pages 2779—2786
doi: 10. 1 093/bioinformatics/btu388

 

Systems biology

Advance Access publication June 19, 2014

Correcting for link loss in causal network inference caused by

regulator interference

Ying Wang‘, Christopher A. Penfold‘, David A. Hodgsonz, Miriam L. Clifford2 and

Nigel J. Burroughs1 ’*

1Warwick Systems Biology Centre and 2School of Life Sciences, University of Warwick, Coventry CV4 7AL, UK

Associate Editor: Igor Jurisica

 

ABSTRACT

Motivation: There are a number of algorithms to infer causal regula-
tory networks from time series (gene expression) data. Here we ana-
lyse the phenomena of regulator interference, where regulators with
similar dynamics mutually suppress both the probability of regulating a
target and the associated link strength; for instance, interference
between two identical strong regulators reduces link probabilities
by ~50%.

Results: We construct a robust method to define an interference-
corrected causal network based on an analysis of the conditional
link probabilities that recovers links lost through interference. On a
large real network (Streptomyces coelicolor, phosphate depletion),
we demonstrate that significant interference can occur between regu-
lators with a correlation as low as 0.865, losing an estimated 34% of
links by interference. However, levels of interference cannot be pre-
dicted from the correlation between regulators alone and are data
speciﬁc. Validating against known networks, we show that high num-
bers of functional links are lost by regulator interference. Performance
against other methods on DREAM4 data is excellent.

Availability and implementation: The method is implemented in
R and is publicly available as the NIACS package at http://www2.
wanNick.ac.uk/fac/sci/systemsbiology/research/software.

Contact: N.J.Burroughs@wan~ick.ac.uk

Supplementary information: Supplementary materials are available
at Bioinformatics online.

Received on August 23, 2013; revised on March 25, 2014; accepted
on June 11, 2014

1 INTRODUCTION

The falling costs of global gene expression (transcriptome) meas-
urement by microarrays, and more recently next-generation
sequencing, has spurred the development of network inference
techniques (Bansal et al., 2007; De Smet and Marchal, 2010;
Emmert-Streib et al., 2012; Hache et al., 2009; Maetschke
et al., 2013; Margolin and Califano et al., 2007; Markowetz
and Spang, 2007; Olsen et al., 2009; Penfold and Wild, 2011;
Werhli et al., 2006). Of particular interest, given their direct
bearing on mechanisms of regulation and information ﬂow
through the cell, is the identiﬁcation of causal regulatory signals,
the associated directed (causal) networks and regulatory path-
ways. Time series experiments potentially capture these signals,

 

*To whom correspondence should be addressed.

but because of low temporal resolution of transcriptome data,
only simple models can be used for analysis. The most basic is a
linear auto-regression model (Lebre, 2009; Morrissey et al., 2010;
Opgen-Rhein and Strimmer, 2007),

G
X§+1=Mi+ZBinj+s§, (1)
j=1

where  is the (log) expression level of gene 1' (i=1, . . . , G) at
time t (t= 1, . . . , T), 3,,- is the connectivity strength, ,ul- the addi-
tive constant and sf. Gaussian noise N(0, A171), (precision Al).

Despite the simplicity of these models, inference is computa-
tionally intensive given the high number of regressors; expression
data on 1000—10 000s of genes is typical depending on the experi-
mental conditions and organism, and potentially greater if gene
models (RNA splicing/transcripts) are distinguished. A factor
that considerably aids identiﬁcation of regulatory links in these
systems is the fact that biological networks are sparse, i.e. the
connectivity matrix B = (Bij) is sparse with the average number of
regulators per gene being much smaller than the number of
genes. Part of this sparsity results from the fact that only a
subset of genes (more speciﬁcally, their associated proteins) can
be regulators; the set of potential regulators can thus be restricted
a priori to those identiﬁed from bioinformatic/literature consid-
erations as potential regulators, thereby reducing computation
considerably.

Sparse network models (Morrissey et al., 2010, 2011) use
Gibbs variable selection methods to determine which elements
of the matrix B are present in the regression; speciﬁcally, the
prior on By- allows it to be zero with ﬁnite probability. The in-
dicator yij e {0, 1} of a link j —> 1' determines if Bi]- is non-zero
(when yij = 1), while 3,,- = 0 if yij = 0. The indicator y is modelled
as a Bernoulli distribution with a prior probability p of being
non-zero, ITO/i]- | ,0)~Ber(yij | ,0), while ,0 has a Beta prior 7t(,o)~B
e(,o| 0.5, 0.5) (Morrissey et al., 2010). Let D denote the time series
gene expression data {X11} and 9 the model parameters
{(,u,-), (Al), (yij), (Bl-1)}. The likelihood is then given by

G 7L1 G
L(9; D) = n n N<X§+1|m+ Z yiJ-BiJ-le., A171). (2)
1 j=1

i=1t=

The associated posterior can then be sampled using the biocon-
ductor package GRENITS (http://www.bioconductor.org/
packages /2. 12 /bioc/html /GRENITS .html).

In network models, interference has a direct bearing on the
posterior probability of links being present. Speciﬁcally in these

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬂJO'smumo[pJOJXO'sopchogurorq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Y.Wang et al.

 

sparse network models, 7t(y,-J-=1 | D) is reduced if there is an-
other regulator k with similar dynamics to j. In the case of an
exact identity between the dynamics of j and k, there are three
identical regression models: yij = 1, yik = 0; yij = 0, yik = 1 and
yij = 1, yik = 1, and thus the probability of any one, and therefore
of 7r(y,-J- = 1 |D) is reduced. The relative weighting of these three
states is determined by the prior link probability ,0, which is low
in sparse networks, thereby downweighting the double link case;
therefore, only the two states yij= 0, yik = 1 and yij = 1, yik = 0
need to be considered, effectively halving 7t(y,-J-=1|D) relative
to the case when k is excluded from the network (proof in
Section 2.1.1). A key problem is gauging when regulators
might interfere, speciﬁcally how interference decreases with a
diminishing correlation between these regulators and thus decid-
ing how to select which regulators to use in the regression.
Failing to deal with this appropriately means that key regulators
might be missed because they are part of a correlated set of
regulators, and their link probabilities fall below threshold
through mutual interference. We developed a framework for
solving this problem based on the analysis of conditional poster-
ior link probabilities that identiﬁes the interfering sets of regula-
tors. This allowed us to deﬁne an interference-corrected causal
network and, further, the relative weights of the interfering regu-
lators reﬂecting their likely contribution to the control of a given
gene.

The article is organized as follows. In Section 2, we analyse the
impact of identical regulators on network links, demonstrating
that the link probabilities of identical strong regulators are es-
sentially additive. We give a numerical demonstration of the
theory on an augmented experimental dataset, doubling up a
key regulator. In Section 3, we develop a framework to correct
for interference in network construction, a post-processing step
that clusters regulators and calculates regulator interference
within clusters for each target. In Section 4, we illustrate our
method on three experimental datasets that give rise to networks
with distinct architectures and demonstrate that interference is
data speciﬁc, there being no simple relationship between inter-
ference and regulator correlation. Further, we provide evidence
that the recovered links are functional. In Section 5, we discuss
the impact of these issues and the generality to other inference/
ﬁtting methods.

2 THE REGULATOR INTERFERENCE PROBLEM

Causal network determination relies on causal signals leaving a
signature in the gene expression dynamics, essentially a correl-
ation between X“r1 and X’ . However, if two (or more) regulators
have similar dynamics,  W X;{ for all t, then the identity of the
regulator is unclear, the true regulator being either j, k or both.
This correlation in the data gives rise to an approximate sym-
metry for the likelihood, L(9; X’) m L(9; (DJ-,kX’), where (DJ-,k is
the exchange transformation j <—> k. Lifting the symmetry to the
space of model parameters gives rise to an approximate exchange
symmetry on the parameters 9, L(9; X’) % L(<I>;.,k9; X). In par-
ticular, identical data X]- = X k means that the likelihood has an
invariance symmetry, and Bi]- and Bik are unidentiﬁable in the
linear network model (1). The lifted symmetry in this case reads
<I>£kBj =B.k, (1);,kBj. =Bk., etc. In this section, we develop a
framework to analyse and detect interference between regulators

and demonstrate the impact of an exact symmetry (two identical
regulators) on real data.

2.1 Two identical regulators

2.1.1 Theoretical analysis of regulator interference Consider an
exact data symmetry (DJ-,kX’ = X’ , i.e. X], X k are identical. The like-
lihood is then invariant under the lifted symmetry (1);,k. The prior is
also likely to satisfy this symmetry, i.e. the prior on Bi]- is likely
identical to that of Bik. Thus, the posterior link probabilities satisfy
this symmetry, 7r(y,-J-|D) =7t(y,-k |D) and similarly all joint condi-
tionals. However, the aspect of the symmetry we are interested in is
whether the following two models predict different networks.

M1 Only regulator j is considered in the set of regulators, i.e.
regulator k is removed from the network.
M2 Both regulators j, k are present in the network.

These are nested networks because M1 is M2 under the con-
straint yik = 0, i.e. the conditional posterior probability 7r(y,-J- = 1
|D, yik = 0) is the link probability on M1, whereas that of M2 is
the posterior probability 7t(y,-J-=1 |D), (no constraints), both of
which can be computed from the joint distribution Ito/i], yik |D).

We proceed to determine an expression relating 7T()/ij= 1 |D,
yik = 0) and 7r(y,-J- = 1 |D). Throughout we consider ,0 as ﬁxed; in
practice, it has low posterior variance in the full network analysis
and so ﬁxing ,0 equal to the posterior mean in the following is a
good approximation. Firstly, we have

2

,0
m,- =1, y... =1lD)= @ / dBideikmBimeik)

/ d07t(0)L(0, 3,, 3,7,, y, = 1, y, = 1; D)

using Bayes formula and assuming independent priors. Here ,0 is
the (ﬁxed) link prior probability and 0: 9\{B,-j, Bik, yij, yik}.

The data symmetry (DJ-k between j, k implies that L(9, Bi]:
a, Bik=b, yij= 1, yik= 1; D)=L(9, Bij=a+b, yij= 1, yik=0; D).
With a Gaussian prior on Bij~N(O, 02) (variance 02), we note
that for an arbitrary function f,

_M 1 _M
fdudve 2a2 f(u+v) E fidwdze 4a2 f(w)

= JTO/ dwfﬁﬂw)

and thus deduce that,

p
7t(yij=1’yik=1|D’02)= ITIOW(l/ij=1,l/ik=0lD,202)

where we make explicit note of the prior variance 02 on By, Bik
because the dimension reduction above has doubled the prior
variance. This implies that the symmetry (DJ-k results in a direct
relationship between the regulator link probability j —> i when
one (Model M1) or both links (M2) are present up to changing
the Gaussian prior variance of 3,,- between Models M1 and M2;
the other strength coefﬁcients Bis, s 75 j retain the original prior.
Assuming a sufﬁciently weak prior, we thus obtain an approxi-
mate equality ITO/i]- : 1, yik =1 |D) % ﬁrm/i]- =1, yik = 0 | D).

 

2780

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Regulator interference

 

Therefore, we deduce that
(1 - p)7r(r.-j=1lD) W vary-=1, VikZOID)a
which gives

(1 - ,0)7T(i/i,-=1|D)

 

..=1 D -= ~—
zt(1/,J | al/zk 0) 1_7t(yij=1|D) , (3)
Of
7,0,1; 1 |D, Vik =0)
..=1 D m J ' 4
7T(l/y I ) 1_p+7r(yij=llD,l/ik=0) ()

Hence, including an identical regulator in a network reconstruc-
tion reduces the link probability j —>i by a factor of
1—,0+7r(y,-J-=1|D,y,-k=0), which can be close to 2 for a
strong link (7r(yl-J-=1|D,yik=0)% 1) in a sparse network
(,0 low). For weaker connections, the reduction factor is smaller
but the relative change proportionally greater, growing as

1+ [(1 — p)/7T(yij=1|Dal/ik =0)]-

2.1.2 Demonstration of regulator interference on experimental
data We use time series data for Streptomyces coelicolor
under phosphate depletion (Nieselt et al., 2010), expression
data consisting of 19 time points with 1h sampling (see
Section 1.1 of Supplementary Material). In bacteria, the
PhoP two-component system (PhoURP, SCO4228-30 in
S.c0elic0l0r) is the primary response pathway during phos-
phate depletion (Rodriguez-Garcia et al., 2007); transcription
of phoP (SCO4230) dramatically increasing within 1h of de-
pletion (Nieselt et al., 2010), a signalling cascade that gives rise
to antibiotic synthesis within 20h WVentzel et al., 2012)
through activation of the red (undecylprodigiosin, RED) and
act (actinorhodin, ACT) gene clusters. For demonstration pur-
poses, we selected a set of 120 differentially expressed (DE)
genes comprising 65 predeﬁned DE regulators (removing
pho U /R that have a high correlation with phoP; the interfer-
ence of these three regulators is analysed in Section 4.1) to-
gether with a selection of phoP—dependent genes and phoP—
independent genes. We denote this dataset Dlxphop to reﬂect
that it has one copy of the phoP gene. We constructed an
augmented dataset by including one additional artiﬁcial regu-
lator, which we called SC00000, with expression data that is
an exact copy of phoP. We called this dataset DZXPhOP because
it has two regulators (SCO4230, SC00000) with identical gene
expression.

The bioconductor package GRENITS was used for inference
of the gene regulatory network on Dlxphop, and DZXPhOP (see
Section 2 of Supplementary Material). GRENITS uses a
Markov chain Monte Carlo (MCMC) algorithm to implement
Bayesian inference on the sparse network model (1), giving sam-
ples of the network from which link probabilities can be calcu-
lated. For the duplicated dataset DZXPhOP, we calculated the
conditional link probabilities for SCO4230 and SC00000 from
the MCMC samples, i.e. the probability of SCO4230 being on
while SC00000 is off, and vice versa. As is shown in Figure 1, the
link probabilities for SCO4230 decreased dramatically when its
duplicate SC00000 was included relative to the conditional prob-
ability when the duplicate was switched off. This demonstrates
the presence of regulator interference in causal networks under

 

 

 

 

 

 

 

 

@( I I _F-
o: +
.12
#-
2 ++
08- 11:
g +:
> +
 :3 ++
11': )9 11+
45 0.6- [I
Q. lg +
E f0 +
E 1'
C I
.g 0.4- ,'
E  >< SCOOOOO/szphop
8  0 SCO4230/D2XphoP
,’ 1xphoP
0_2_ 8H + SCO4230/D
{if} - - -Equatlon (3)
0 0.2 0.4 0.6 0.8 1

link probability

Fig. 1. Link probability suppression in the presence of an identical regu-
lator. For each target, the conditional link probabilities of SCO4230 (O)
and SCOOOOO (x) (conditioned on the other regulator being off) are
plotted against their posterior link probabilities for the network inferred
on the dataset DZXPhOP comprising 121 genes, including the regulator
SCO4230 and its artiﬁcial copy SCOOOOO. The conditional link probabil-
ity is computed from the MCMC samples (18 000 samples) by condition-
ing on the respective duplicate being off. The theoretical relationship,
Equation (3) with p=0.026 (posterior mean), is shown (dashed line).
The conditional link probability of SCO4230 on szl’hOP is also plotted
against the link probability of SCO4230 inferred on DIXPhOP (+), the
corresponding dataset that lacks the artiﬁcial regulator SCOOOOO

an exact data symmetry. Our analysis also demonstrates that the
conditional probability allows the link probability to be accur-
ately reconstructed compared with network inference on a
reduced set of regulators, i.e. removal of the artiﬁcial (dupli-
cated) gene SC00000 in this case. Speciﬁcally, the conditional
71’(l/iSC04230IDZXPhOP’l/iSCOOOOOZO) is identical to 7T(l/z'sco4230 l
DIXPhOP) for each target i, lying down the diagonal of Figure 1.
Therefore, up to the proviso of sufﬁcient samples to compute the
conditional, all analysis can be performed from one run of the
MCMC sampler through a post-processing step. Further, as the
conditional probabilities of SCO4230 and SC00000 agree (con-
ditioned on each other), both lying on the theoretical curve (3)
(Fig. 1) the GRENITS sampler mixes well under this data du-
plication, i.e. an identiﬁability symmetry between regulators does
not affect mixing.

2.2 Multiple identical regulators

For n identical regulators Si, |S,-| = n, of the target i, the regulator
interference analysis of Section 2.1.1 generalizes to give the
approximate relationship (see Section 4.1 of Supplementary
Material)

Ito/i,- =1 ID, Vik = 0, Vk e Si\{j})

 

2781

112 /810's112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Y.Wang et al.

 

(1 — p)”—1n(y.-,-= 1 ID)

N _ _ n—l '
1——1‘1,”) 7r(r.-,-=1lD)

 

For strong links in a sparse network (,0 small), we get the
approximate relation
n(y.,-=1|D, Vik =0, Vk e Si\{j})

7t(l/zj=1ID)~ n

 

Thus, interference by identical regulators in sparse networks
reduces link probabilities by the number of identical genes, the
network topology running randomly over the single regulator
networks because states with multiple links are severely down
weighted by ,0. The regulators thus share equally the causal
signal, and the true link probability of the causal dependence is
(approximately) given by the sum over the link probabilities of
these interfering regulators.

3 DETECTING NETWORK LINK INTERFERENCE

A continuity argument to the identical regulator case above, Section
2.1.1, suggests that we should expect interference to occur between
highly correlated regulators. However, the dependence of interference
(link suppression) on the degree of correlation between the regulators,
the expression levels of the regulators and their targets, is unknown. What
is clear is that correlated genes can interfere with each other, potentially
causing a signiﬁcant reduction in the posterior link probabilities of dy-
namically similar regulators by as much as a factor of n for n highly
correlated regulators. Therefore, causal networks deﬁned by application
of a simple threshold criterion, 7r(y,-j = 1 ID) > ([5, are potentially erroneous
because interfering regulators may be lost since their posterior link prob-
abilities fall below the threshold (15. Here we establish a method to con-
struct a network corrected for interference.

Our method is as follows. Given expression (time series) data D (re-
stricted to DE genes), and a subset R of potential regulators based on, for
example, functional annotation, deﬁne the interference-corrected network
(ICN) N(a), ()5) with correlation and link thresholds a), ([5 respectively, by

(l) Cluster the regulators R into correlated sets |Cjk| Z 0), using the
correlation coefﬁcient (or other similarity index)  , deﬁning clus-
ters CRS(a)), s = 1, 2..., possibly singletons. We determine levels of
interference between regulators within each cluster, ignoring inter-
ference between regulators outside these sets. Singleton clusters are
regulators where interference from all other regulators is ignored.

(2) Infer the network posterior distribution and the conditional pos-
terior link distributions for regulators in the clusters (here we use
MCMC samples from GRENITS). Speciﬁcally, compute for each
j e CRS(a)) the conditionals 7r(y,-j = 1 |D, yik =0, Vk E CRS(a))\{j})
for each target i.

(3) For a regulator j e CRS(a)) and a target i, a link j —> i in the net-
work N(a), ()5) exists if either of the following two conditions holds

a—link : 7r(yiJ-=1|D, R) Z ()5.
,B—Iink : 7r(y,-j = 1 |D, R) < 115 and
neg-=1 111R, yik=0v1< e CRS(w)\{i}) 2 (15-
For singletons, only the a-link condition is relevant. A further numerical
restriction is also applied to ,B-Iinks; the sample size for calculating the

conditional probability should be 2100 in order that a 90% conﬁdence
interval can be computed; on smaller sample sizes, accuracy of this

estimate is poor. Small sample sizes can occur if there is a very strong
link in the cluster, then conditioning on that link to be off gives a small
number of samples. Acquiring a larger number of posterior samples
(running the sampler for longer) relaxes this limitation.

The a-links in N(a), ()5) are the original links in N(1, <15) (uncorrected
network), i.e. the ICN comprises the original network augmented with
recovered ,B-Iinks. We deﬁne the link probability for each link in the ICN
as the maximum of its posterior link probability and the links’ conditional
probability based on the regulator’s cluster at threshold 0) (if applicable).

The number of ,B-Iinks in the ICN increases on average as the correl-
ation threshold 0) decreases for a ﬁxed link probability threshold (15.
However, as the correlation threshold decreases, interference amongst
clustered regulators becomes weaker as regulators with decreased levels
of mutual interference are clustered together. Therefore, to ﬁnd a correl-
ation threshold where the partitioning of regulators into mutually inter-
fering sets is optimized, we use a scoring method that quantiﬁes levels of
interference. We propose a score where a ,B-Iink has a weight inversely
proportional to the number of regulators in its cluster CRS(a)), giving the
,B-Iink network score

10’ —> i)

5(a), <15)   I CR,(w) I (5)
where I(]' —> i) is 1 if the ,B-Iink is present, otherwise 0. Then strong
interference among highly correlated regulators increase the score,
while weaker regulators (where only a proportion of the regulators in
the cluster have a conditional probability above threshold to a given
target) decrease the score. For instance, forming a new cluster ((0 decreas-
ing) comprising two ,B-Iinks adds 1 to the score. But adding a third regu-
lator to the cluster that does not regulate that target (conditional below
threshold) reduces the contribution to the score to 2/ 3. Typically ,B-Iinks
are stable in that those present at a) are a subset of ,B-Iinks for all a)’ < a).
We maximize the network score S(a), ([5) with respect to a), deﬁning the
optimal correlation threshold (0* ((15) and associated optimal ICN. In cases
where there is a tie, we use the highest correlation that maximizes the
,B-Iink network score because further clustering gives no evidence of an
increase in interference.

The link probability threshold (15 is chosen based on the conﬁdence
required for assigning links (Morrissey et al., 2010, 2011); in practice, it
is lower than desirable because posterior link probabilities are typically
low (see Supplementary Fig. S4). We note that the value ¢=1/(2 — 0)
has a special signiﬁcance as regards interference analysis (the prior link
probability parameter p is ﬁxed at its posterior mean), as it is the highest
value of the conditional link probability for two identical regulators, see
Equation (4) with 7r(y,-j = 1 |D, yik = 0) = 1. Thus, when ¢<1/(2 — 0),
some of the a-links are interfering with each other, as shown in
Figure 1. Hence, to correctly assess interference, the link threshold
should be greater than 1 / (2 — p). In Section 4, we consider the effect of
()5 on interference and its impact on a)*(¢) on real datasets.

Finally, we note that different clustering methods are likely to give
slightly different results for the ICN, but identiﬁcation of interfering
regulators is likely similar.

4 DEMONSTRATIONS ON REAL DATA
NETWORKS

In this section, we analyse interference on three experimental
examples. Firstly, the full expression dataset for S.c0elic0l0r
under phosphate depletion (Nieselt et al., 2010), a second experi-
mental dataset for S.c0elic0l0r under glutamate depletion
WValdvogel et al., 2011) and expression data for the
Arabidopsis circadian clock WVindram et al., 2012) (see Section
1 of Supplementary Material). In each case, we do not subselect
regulators based on their (dynamic) similarity but construct the

 

2782

112 /810's112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Regulator interference

 

 

 

 

 

 

 

 

 

 

 

 

(a) Network size (b) Score beta links
0
o-m N - a”
1— 9
o / \
a ' 0%0—000. oo—ooo M
‘— \ O °‘mo %
O - 0%
s “1., T i
e In C To—Ooo’au‘o!‘
o-m w ' P;
g 8 _ Eat.-.” ° °'°°“3:::::7’“m
= w 13-0 .0. 0 mo
"5 \°"B ‘% g oi m
o—ooo . ._ °"" o—ooo’
=5 o °'m\ milk“; 0 8 ' 0-0‘ I 50‘
a o _ °-°°"Io—ooom we, a a
E (O \ ‘lh‘ ‘ 0
g “lie—coo m. “if” c g
8 _ u-‘iqpm o 3 - a
<- 00 o
O Link_0.4 o
8 _ O Link_0.55 a —
N O Link_0.6
o Link_0.65
o _ O Link_0.7 o _ o
0.75 0.85 0.95 0.75 0.85 0.95

absolute correlation absolute correlation

Fig. 2. Analysis of the ,B-Iink composition of the S.c0elicolor phosphate
depletion ICN with respect to link <0 and correlation a) thresholds. The
total number of links (a) and the ,B-Iink network score (b) for networks
N(a), <0) are plotted against the absolute correlation threshold 0) between
regulators for link thresholds <0=0.4, 0.55, 0.6, 0.65, 0.7, see legend. At
the correlation threshold 0) = 1, the network comprises a-links only deter-
mined from the posterior link probabilities

causal network with all potential regulators present. We demon-
strate in two of the networks that a high proportion of the re-
covered links are functional and quantify network accuracy.

4.1 Example 1: phosphate depletion causal network

The phosphate depletion data consists of 988 DE genes, of which
67 are predeﬁned regulators comprising DNA binding proteins
and proteins capable of regulating gene expression indirectly
such as kinases (see Section 1 of Supplementary Material). The
regulators show a wide spread of correlation (Supplementary
Fig. S6a); we expect interference to be only important among
the highest correlating regulators and thus only examine the cor-
relation threshold in the interval (0.7, 1). We grouped the 67
regulators into highly correlated sets by a hierarchical clustering
method (Supplementary Fig. S6b). The merge points in the tree
are the values of a) at which the network N(a), <0) is determined.
We used GRENITS to infer the casual network on all 988 genes
(see Section 2 of Supplementary Material). Interference was
then analysed on the merge points in 0.7<a)<1 across the link
probabilities <0=0.4, 0.55, 0.6, 0.65, 0.7 following the method
in Section 3. All these <0 are in the tail of the posterior
link probability distribution (Supplementary Fig. S4a) and
signiﬁcantly larger than the posterior estimate for random
links, ,0=0.0266 :l: 0.0010 (distribution standard deviation).
Therefore, links on all these thresholds demonstrate evidence
of causal regulation at varying levels of signiﬁcance.

An analysis of the ICN is shown in Figure 2. Because the
number of a-links remains constant and, typically, ,B-links are
added to the network, the total number of links in the network
increases on average with respect to increasing clustering strin-
gency (decreasing 0)) for all <0 (Fig. 2a). The ,B-link network score
indicates that levels of interference are initially strong but

     

1. 



l
m.

» I 1
2%"
ﬂ

., ~
5 \x
‘1 .t.\
!v I

\ 2v ,

i .4:
5'.
g

9*

     
  
 

1,


       

   

A‘

' I

 

Fig. 3. Cytoscape visualization of the S.c0elicolor phosphate depletion
optimal ICN, N(0.865, 0.55). Nodes are regulators (pink) and (non-regu-
lator) target genes (blue). There are 498 a-links (cyan) and 259 ,B-links
(magenta). The T-arrow at the end of a link denotes inhibition, and an
arrow denotes activation. Link length has no meaning. The network has a
large hub around SCO3217 (ca'aR), targets making up the large diameter,
interferring with the close proximity hub SC05881 (redZ), to the left, and
with another small hub SCO4425, positioned far left; these three regula-
tors are clustered together at <0= 0.865. The second interfering cluster is
the Pho regulon hub complex around SCO4228, SCO4229, SCO4230,
merged hubs on top right; again these three regulators are clustered at
a)=0.865. There are ﬁve smaller hubs, SCO4261, SCO4908, SC05877,
SCO7516 and SCO7463, lower right. Zoom into ﬁgure for detail or see
cytoscape ﬁle (Supplementary Material)

decrease as the cluster threshold falls <0.85. Thus, the score
has a maximum around 086—090 for all the link probability
thresholds (Fig. 2b), and therefore, the optimum a)*(<0) is fairly
robust to changes in the link threshold <0. Interference is fairly
uniform across link strength with 30—40% of links being re-
covered at the optimum correlation threshold a)*(<0) for each
given <0.

As discussed in Section 3, the link threshold should be greater
than 1/(2 — ,0)=0.507 for a full interference assessment. To
examine ICN structure and the potential biological importance
of the inferred links, we choose <0=0.55 for illustration, much
larger than 0 (the probability of random links) and close to the
minimum threshold for interference detection. The ,B-link net-
work score is maximized (for <0= 0.55) at a): 0.865 (the highest
absolute correlation with the maximum score) (Fig. 2b). The
network N(0.865, 0.55) has a main hub centred on SCO3217,
the calcium-dependent antibiotic regulator ca’aR and a smaller
Pho regulon hub around PhoURP (Fig. 3). There are 259

 

2783

112 /810's112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Y.Wang et al.

 

recovered ,B-links of 757 links in the ICN, i.e. regulator interfer-
ence caused a loss of 34% of links, 103 in the ca’aR hub, inter-
fering primarily with redZ (SC05881), the principal regulator of
the undecylprodigiosin antibiotic gene cluster (with a correlation
of 0.95), and 125 in the phoURP hub, a result of cross-interfer-
ence between phoU, phoR and phoP (correlation coefﬁ-
cients>0.93) with 69, 32 and 24 ,B-links, respectively.

Interference to a common target is highly heterogeneous
across regulators within a cluster. For illustration, classify targets
for clustered regulators according to the type of links in the ICN,
ranging from sole a targets (one regulator is an a-link, other
regulators lack a link), mixed a/ ,6 targets (at least one a- and
,B-link), partial ,6 targets (at least one ,B-link but not all ,6, and no
a) and complete ,6 targets; these respective classiﬁcations have
increasing levels of mutual interference. The joint targets between
SCO3217 and SC05881 in ICN N(0.95,0.55) then show a diver-
sity of classes, with the absolute target-regulator (time shifted)
correlation predicting the target classiﬁcation (Supplementary
Fig. S9). Speciﬁcally, the sole a targets of SCO3217 have a
higher absolute correlation with SCO3217 than with SC05881,
and vice versa, while complete ,6 targets have closer correl-
ation coefﬁcients. The degree of mutual interference also shows
variation (Supplementary Fig. S10); the complete ,6 targets are
evenly weighted with similar conditional link probabilities,
whereas the partial ,B-links have greater differences in their con-
ditional link probabilities. Results are similar for the optimal
ICN but more complex because of the three-way interfer-
ence between SCO3217, SC05881 and SCO4425. Interference
is thus heterogeneous within the target base of clustered
regulators.

To assess levels of accuracy of our recovered ,B-links, we exam-
ined the 24 targets predicted for PhoP [seven are in the same
operon as deﬁned by (Charaniya et al., 2007)]; in the uncorrected
network, phoP had no targets, whereas phoU and phoR had 19
and 69, respectively at <0=0.55. It is highly likely that most of
these targets are actually regulated by PhoP, the principle regu-
lator of the phosphate response (Martin et al., 2012; Rodriguez-
Garcia et al., 2007). We examined two criteria, ﬁrstly, whether
these targets had distinctly different proﬁles under phoP knock
out (Thomas et al., 2012; Supplementary Figs S11 and S12), and
whether there was evidence of a PHO box upstream of the gene,
the binding site for PhoP (motif GTTCA). The ﬁrst criteria
showed that ﬁve predicted targets were signiﬁcantly altered at
the 0.5% level (SCOll96, SCO3899, SCO4726, SC05390,
SCO6753), and three others at 5% (Supplementary Table S3).
The second criteria indicated that ﬁve targets (SCO3899,
SCO4545, SCO4653, SCO4726, SCO6753) and the operon
(seven genes) have strong evidence of a PHO box or a dyad,
(Multiple EM (Expectation Maximization) for Motif
Elicitation (MEME) score >10, resp. 6); ﬁve genes were in
both categories (Supplementary Table S3). Close examination
of the transcriptional proﬁles shows that many have a discernible
difference in the dynamics across phosphate depletion; typically,
AphoP shows slower changes in gene expression. All those with a
PHO box show this behaviour. Thus, >50% of predicted targets
have supporting evidence of a PhoP binding site (Supplementary
Table S3). The two genes SCOl 196 and SC05390 underwent a
dramatic change in expression, but there was little evidence of the
presence of a PHO box. They may therefore be indirect targets or

possess functional but altered PHO boxes. Together, this pro-
vides strong evidence that correcting for interference is essential
because otherwise important targets may be missed. All of the
PhoP targets were lost in absence of an interference correction in
this case.

4.2 Example 2: glutamate depletion causal network

We examined the ICN for a second S. coelicolor dataset under glu-
tamate depletion (W aldvogel et al., 2011), a treatment that also
gives rise to the synthesis of RED and ACT antibiotics. The data
comprises 945 DE genes including 59 predeﬁned DE regulators (see
Section 1 of Supplementary Material). The absolute correlation
between these regulators and the corresponding clustering tree
(Supplementary Fig. S7) are similar to those in the phosphate de-
pletion experiment (Supplementary Fig. S6). Under the same ana-
lysis as above, the optimal ICN occurred at a similar clustering
threshold, (<0=0.55, a)*(0.55)=0.859; Supplementary Figs S13
and S14) and comprises 283 links of which 35 are ,B-links, i.e.
there is a substantially lower level of regulator interference in this
dataset with an estimated loss of 12% by regulator interference.
Thus, despite similar correlations among the regulators and a simi-
lar posterior link probability distribution (Supplementary Fig. S4b)
to that in the phosphate depletion experiment, regulator interfer-
ence, although signiﬁcant at 35 ,B-links, was reduced. This may be
because of the different network structure; under phosphate deple-
tion the network comprises distinct separated large hubs, Fig. 3,
whereas under glutamate depletion the network is more dispersed
among a number of smaller hubs, Supplementary Fig. S14.

4.3 Example 3: Arabidopsis circadian clock network

The Arabidopsis circadian clock is one of the most well-
established biological networks containing both transcriptional
and translational regulation. We used transcriptome data com-
prising 10 regulators WVindram et al., 2012), every 2h up to 48 h,
24 time points in total. There are four biological replicates at each
time point allowing the replicate causal linear model with Student
noise in GRENITS to be used for network inference (Morrissey
et al., 2010). The absolute correlation between these regulators
and the corresponding clustering tree are shown in
Supplementary Fig. S8. The ICN N (0), <0) was constructed follow-
ing the method in Section 3 (Fig. 4) and displayed similar trends
to the two previous larger networks (Fig. 2; Supplementary
Fig. S13). We constructed the optimal ICN for <0= 0.55
(Fig. 5); the lowest link threshold for a full interference assessment
is 1 / (2 — ,0) = 0.543 in this case (Supplementary Fig. S5).

To validate our method, we compared our reconstructed net-
work with the Arabidopsis circadian clock model in (Pokhilko
et al., 2013), deﬁning the ground truth network (Supplementary
Table S4). We inferred 12 links, which consist of 6 a-links and 6
,B-links (Fig. 5). In particular, all the ,B-links are correct, whereas
only three of the a-links are correct. The precision of our ICN
prediction is thus 75%, subject to the degree to which the net-
work is actually known. Furthermore, an analysis of the ICNs
across link threshold <0 shows that the optimal ICN always has
maximal precision for link thresholds <0= 0.55 and above
(Supplementary Fig. S15). Finally, a comparison between
NIACS and Murphy’s Bayes Net Toolbox (Murphy and Mian,

 

2784

112 /810's112umo[pJOJXO'sopeIIHOJHtotq/ﬁd11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

Regulator interference

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

(a) Network size (b) Score beta links
0 O\ O\°
Ln _ °\ /
1— U)- _ o o
m o 0-0 0 o
E S - o o/  \o a /
"—5 o o 8  _ ° 0
Fa \ °\ 8
_Q o oo-o—o a)
g 00 0 o o
C Ln — \0-0—0 0 \o
OIO-O—O O L‘? _ °_°—°
o Link_0.4 °
0 Link_0.55
o _ o Link_0.6 °
0 Link_0.65
O Link_0.7 Q _ ooo-o—o o
O
0.0 0.4 0.8 0.0 0.4 0.8

absolute correlation absolute correlation

Fig. 4. Analysis of the ICN ,B-link composition with respect to link <0 and
correlation a) thresholds for the Arabidopsis circadian clock data.
The total number of links (a) and the score of ,B-Iinks 0)) for networks
N(a), <0) are plotted against the absolute correlation threshold 0) between
regulators for link thresholds <0=0.4, 0.55, 0.6, 0.65, 0.7, see legend

1999) shows that our method has much higher precision
(Supplementary Table S5).

5 DISCUSSION

In this article, we have proposed a method for dealing with the
problem of regulators with similar dynamics suppressing causal
link signals in the auto-regression model Equation (1). By
analysis of the level of interference between highly correlated
regulators (computed from the posterior conditional link prob-
abilities), we are able to correct for link suppression by near
identical regulators, and thus recover regulator links that
would otherwise be lost because their posterior link probabilities
are reduced below threshold. We deﬁned an ICN N(a)*, <0) that
includes as a subnetwork the original network N(1,<0), i.e. our
method only adds links lost by interference. The ICN is deﬁned
at the value of the correlation threshold 00* where interfering
regulators are judged to be optimally clustered as measured
by a score that sums over weighted ,B-links; our score punished
clustering of inconsistent regulators through a lack of mutual
interference or no interference.

Our approach avoids a subjective subselection of the set of
predeﬁned regulators, i.e. all regulators should be included in
the inference in absence of prior information, and, by a post-
processing step, interference is corrected. In effect, we are assum-
ing that there are potentially multiple regulators for a target, but
network inference is hampered by insufﬁcient dynamic data to
separate signals from (individual) regulators with similar dy-
namics. Determining whether there are two true regulators as
opposed to one is not possible without additional experimental
data, e.g. experiments under conditions where the regulators
have distinct dynamics or conducting experiments with strains
where either regulator is expressed under an inducible promotor.
Our method crucially prevents loss of both regulators from the

 

Fig. 5. Inferred Arabidopsis circadian clock ICN showing a-links (cyan)
and ,B-Iinks (magenta). Solid lines indicate predictions consistent with the
latest experimental data and model (Pokhilko et al., 2013), while the
dashed lines indicate predictions that are not thus far supported by cur-
rent literature. Arrows indicate activation and the T-arrows inhibition

inferred network. We demonstrated that the recovered ,B-links
for PhoP and the Arabidopsis circadian clock are functional,
with precision at least as good as that for the predicted a-links.
In a comparison against other network inference methods on
simulated data (DREAM4), GRENITS is already highly com-
petitive, while performance is further improved when coupled
with NIACS to correct for regulator interference, the area
under precision recall curve increasing on average by 10%
(Supplementary Table S2). Most of the improvement is in the
crucial high conﬁdence predictions (Supplementary Fig. S3).
NIACS outperformed the other methods in 10 of 14 cases.

For the ICN N(a)*, <0), we assign the link probability as the
maximum of the posterior link probability and the conditional
probability (if applicable). However, we do not expect the con-
ditional probability 7r(yij = 1 |D, yik = 0, Vk e CRS(a)*)\{j}) to
truly reﬂect the probability of regulator j regulating i, as this is
dependent on the clustering set CRS(a)*). In essence, if there are
multiple regulators, they all affect the dynamics (if on), and a
true measure of their regulatory effects is in the presence of the
other regulators. Therefore, we recommend that ,B-links arising
from interference remain distinguished because their probabil-
ities are corrected and thus a direct comparison with a-links
may be misleading. However, the relative weighting within a
cluster of regulators according to their conditional posterior
probabilities is a reﬂection of the evidence in the data as to the
identity of the true regulator. The identity of this true regulator
may also be discerned by using additional experiments or gene
annotations. These data can also be used as prior information in
GRENITS restricting allowable links, thereby removing some of
the regulator ambiguity.

Our analysis on three real datasets demonstrated that interfer-
ence is not simply a function of regulator correlation. In the phos-
phate depletion causal network (Example 1), for two highly
correlated regulators, we found a spread of interference among
their targets comprising a set of targets on which interference is
mutual, whereas other targets have only a sole regulator despite

 

2785

112 /810's112umo[pJOJXO'sopeIIHOJHtotq/ﬁd11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

Y.Wang et al.

 

their high correlation; interference is thus heterogeneous on the
set of targets. These observations mean that interference must be
analysed on a per experiment, per target basis and the optimal
correlation threshold determined in each case.

In addition to regulator interference, we also observed another
phenomenon in our networks, whereby two (or more) regulators
enhance the causal signals of each other; speciﬁcally, the regula-
tors have elevated posterior link probabilities in the presence
of each other. We deﬁne pairwise synergistic regulators j, k on
target i as regulators with 7r(y,-J- = 1 |D), 7t(y,-k = 1 |D) ><0, 7r(y,-J- =
1 |D, yik = 0), 7t(y,-k = 1 |D, yij = 0) < <0 (this deﬁnition can be
easily generalized to the case of multiple regulators). Causal
signal synergy between regulators was rare, with 3, 3 and 1 syn-
ergistic regulators in Examples 1, 2 and 3, respectively
(Supplementary Table S6). We emphasize that neither interfer-
ence nor synergy between the causal signals implies that a
mechanistic interference/ synergy exists. Link suppression/
enhancement from interference/ synergy in our context arises
because of similarity (correlation) in the regulator dynamics.

Interference between dynamically similar regulators in causal net-
work inference is a general problem. It will occur in any statistical
hypothesis testing methodology for the model in Equation 1. For
instance, as the weights Bi]- in Equation 1 are suppressed under inter-
ference, and their variance increases under a lack of (a posteriori)
identiﬁability, any test for a non-zero coefﬁcient will be subject to
loss of highly correlated regulator links (see Section 4.2 of
Supplementary Material). In this article, we have provided a meth-
odology to recover missing (suppressed) links within a Bayesian
context through a post-processing of the network posterior samples.

ACKNOWLEDGEMENT

The authors thank Jonathan Moore for composing the perl code
in NIACS together with the ﬁrst author. The authors are grateful
to the anonymous referees for their helpful comments.

Funding: Biotechnology and Biological Sciences Research
Council (BBSRC) (New Investigator) (BB/H109502/1 to
M.L.G.). C.A.P. was funded by Engineering and Physical
Sciences Research Council (EPSRC), (EP/IO36575/1).

Conflict of Interest: none declared.

REFERENCES

Bansal,M. et al. (2007) How to infer gene networks from expression proﬁles. Mol.
Syst. Biol., 3, 78.

Charaniya,S. et al. (2007) Transcriptome dynamics-based operon prediction and
veriﬁcation in Streptomyces coelicolor. Nucleic Acids Res, 35, 7222—7236.

De Smet,R. and Marchal,K. (2010) Advantages and limitations of current network
inference methods. Nat. Rev. Microbiol, 8, 717—729.

Emmert-Streib,F. et al. (2012) Statistical inference and reverse engineering of
gene regulatory networks from observational expression data. Front
Genet., 3, 8.

Hache,H. et al. (2009) Reverse engineering of gene regulatory networks: a compara-
tive study. EURASIP J. Bioinform. Syst. Biol., 2009, 617281.

Lebre,S. (2009) Inferring dynamic genetic networks with low order independencies.
Stat. Appl. Genet. Mol. Biol., 8, 9.

Maetschke,S.R. et al. (2014) Supervised, semi-supervised and unsupervised inference
of gene regulatory networks. Brief. Bioinform., 15, 195—211.

Margolin,A.A. and Califano,A. (2007) Theory and limitations of genetic network
inference from microarray data. Ann. N. Y. Acad. Sci, 1115, 51—72.

Markowetz,F. and Spang,R. (2007) Inferring cellular networks—a review. BMC
Bioinformatics, 8, S5.

Martin,J.F. et al. (2012) Transcriptomic studies of phosphate control of primary
and secondary metabolism in Streptomyces coelicolor. Appl. M icrobiol.
Biotechnol, 95, 61—75.

Morrissey,E.R. et al. (2010) On reverse engineering of gene interaction networks
using time course data with repeated measurements. Bioinformatics, 26,
2305—2312.

Morrissey,E.R. et al. (2011) Inferring the time-invariant topology of a nonlinear
sparse gene regulatory network using fully Bayesian spline autoregression.
Biostatistics, 12, 682—694.

Murphy,K. and Mian,S. (1999) Modeling gene expression data using dynamic
Bayesian networks. In: Technical Report. Computer Science Division,
University of California, Berkeley, CA.

Nieselt,K. et al. (2010) The dynamic architecture of the metabolic switch in
Streptomyces coelicolor. BM C Genomics, 11, 10.

Olsen,C. et al. (2009) On the impact of entropy estimation on transcriptional regu-
latory network inference based on mutual information. E URASIP J. Bioinform.
Syst. Biol., 2009, 308959.

Opgen-Rhein,R. and Strimmer,K. (2007) Learning causal networks from systems
biology time course data: an effective model selection procedure for the vector
autoregressive process. BM C Bioinformatics, 8, S3.

Penfold,C.A. and Wild,D.L. (2011) How to infer gene networks from expression
proﬁles, revisited. Interface Focus, 1, 857—870.

Pokhilko,A. et al. (2013) Modelling the widespread effects of TOCl signalling on
the plant circadian clock and its outputs. BM C Syst. Biol., 7, 23.

Rodriguez-Garcia,A. et al. (2007) Genome-wide transcriptomic and proteomic ana-
lysis of the primary response to phosphate limitation in Streptomyces coelicolor
M145 and in a DeltaphoP mutant. Proteomics, 7, 2410—2429.

Thomas,L. et al. (2012) Metabolic switches and adaptations deduced from the
proteomes of Streptomyces coelicolor wild type and phoP mutant grown in
batch culture. Mol. Cell Proteomics, 11, M111.013797.

Waldvogel,E. et al. (2011) The PI protein Gan is a pleiotropic regulator for mor-
phological differentiation and secondary metabolism in Streptomyces coelicolor.
Appl. Microbiol. Biotechnol, 92, 1219—1236.

Wentzel,A. et al. (2012) Optimized submerged batch fermentation strategy for sys-
tems scale studies of metabolic switching in Streptomyces coelicolor A3(2). BM C
Syst. Biol., 6, 59.

Werhli,A.V. et al. (2006) Comparative evaluation of reverse engineering gene regu-
latory networks with relevance networks, graphical gaussian models and baye-
sian networks. Bioinformatics, 22, 2523—2531.

Windram,0. et al. (2012) Arabidopsis defence against Botrytis cinerea: chronology
and regulation deciphered by high-resolution temporal transcriptomic analysis.
Plant Cell, 24, 3530—3557.

 

2786

112 /810's112umo[pJOJXO'sopeIIHOJHtotq/ﬁd11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

