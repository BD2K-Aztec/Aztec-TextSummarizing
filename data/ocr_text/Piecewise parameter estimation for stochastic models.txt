Bioinformatics, 32(10), 2016, 1586—1588

doi: 10.1093/bioinformatics/btv759

Advance Access Publication Date: 18 January 2016
Applications Note

 

Systems biology

Piecewise parameter estimation for stochastic
models in COPASI

Frank T. Bergmann1'*, Sven Sahle1 and Christoph Zimmer2

1COS Heidelberg/BioOuant, Heidelberg 69120, Germany and 2BIOMS, University of Heidelberg, Heidelberg, Germany

*To whom correspondence should be addressed.
Associate Editor: Jonathan Wren

Received on 11 August 2015; revised on 4 December 2015; accepted on 21 December 2015

Abstract

Motivation: Computational modeling is widely used for deepening the understanding of biological
processes. Parameterizing models to experimental data needs computationally efficient techniques
for parameter estimation. Challenges for parameter estimation include in general the high dimen—
sionality of the parameter space with local minima and in specific for stochastic modeling the in—
trinsic stochasticity.

Results: We implemented the recently suggested multiple shooting for stochastic systems (MSS)
objective function for parameter estimation in stochastic models into COPASI. This MSS objective
function can be used for parameter estimation in stochastic models but also shows beneficial prop—
erties when used for ordinary differential equation models. The method can be applied with all of
COPASl’s optimization algorithms, and can be used for SBML models as well.

Availability and implementation: The methodology is available in COPASI as of version 4.15.95

 

and can be downloaded from http://wwcopasiorg.

Contact: frank.bergmann@bioquant.uni—heidelberg.de or fbergman@caltech.edu
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Experimental data from time series experiments has been widely
modeled with ordinary differential equations (ODE). Due to pro—
gress in experimental techniques, e.g. the possibility to measure
small numbers of molecules in single cells (Raj and van
Oudenaarden, 2009), the importance of stochastic modeling is
increasing. Both types of models (i.e. ODE and stochastic) need to
be parameterized to experimental data. This parameter estimation
can be challenging due to local minima in the parameter search
space. In case of stochastic modeling, the treatment of the intrinsic
stochasticity poses an additional challenge.

We recently developed an objective function (multiple shooting
for stochastic systems—MSS) for parameter estimation (Zimmer
and Sahle, 2012) that treats the intervals between measurements
separately and uses a state updating mechanism for calculating ini-
tial values for the intervals. In contrast to a least squares functional,
where the states are solely determined by the initial value and the
ODE system, this objective function allows a more ﬂexible state esti—
mation. This objective function has shown to be successfully

applicable to the estimation of kinetic parameters in intrinsic sto-
chastic models (Zimmer and Sahle, 2012). Furthermore, the flexibil-
ity in the state estimation also shows beneficial properties when
dealing with ODE systems.

2 Approach: the objective function

bs :( 8bs

Assume that data 1/0 1/ , . . . , 1/2135) are observed at time points
t0, t1, . . . , tn. The state of the system at time t,- comprises observed
and unobserved species: 1/,- : (1/0135, Vhid).

The MSS objective function decomposes the whole time series
into intervals and fits to the intervals individually. The initial value
for the ODE for each interval is obtained by a state updating:

A b b _Ah'd A hid -
1/2.) S : 1/2.) 5,1/il ZX(A1',0,V1'_1) , forallz

The objective function for parameter estimation is then defined as

n

FMSS(V7 9, V0) = 2040— ti—1;97191—1) — 1/02
i=1

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1586

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

Piecewise parameter estimation for stochastic models

1 587

 

 

 

L "11 “KW-15H HS-IHII'II IUDIHJUTHOFHIEIIIITIHI'. .‘lluIIEI-‘IEII .‘lﬂ . — . B'-'
'1- ' I I- I '
H 'I'-
I. I-unuluI.|-.-u...--.i--.
'  "--- --' Elllﬁlﬂlﬂu :r"r-'— rIr 'In-c
1' I” I u "k :m'nr'JZ-I: men-21'2"
r.-----..| .--..-.-r . m._. -.- -.,_ ..._.___.. _. f I”?
II I, "r-
1..." 1r- - 'Ir rut-I

. _ _. cons ‘Irr [drum-Inn 'qum-ee m ﬁuwm-al'sm -_'.='-
.. .-. -

.._.....-. .-,.. -...,... .
Cnn-Dunh':bn-n:,1fn-1le-:,and Global quantity 11':qu

 

 

 

 

5 6 7 7.5 7.75 8 8.25 8.5 8.75 9 5.4 5.5 5.75 6 6.5 7 7.5 8 8.5 9 9.5

Fig. 1. Left: COPASI, and a plot of a time series with discrete events describing the measured data; Middle, Right: Plot of the logarithm of the objective function
landscape for a Lotka-Volterra model. Darker color stands for lower objective function value. Middle side shows landscape for the conventional least squares.
Right side for the new MSS functional. Optimization is easier as there are no local minima

with an ODE solution x at time t,- — ti_1 for a parameter 0 and an
initial value 19,-_1 at t,-_1.

3 Implementation and discussion

COPASI (Hoops et al., 2006) is a platform independent, user
friendly software tool for setting up, simulating and analyzing kin-
etic models of biochemical reaction networks. It is freely available,
open source software and is developed in a well—established interna—
tional cooperation. It aims at making advanced, state—of—the—art
modeling techniques available to researchers who are not necessarily
experts in software development or numerical methods. COPASI
provides a wide range of tools, including metabolic control analysis,
sensitivity analysis, time scale analysis, exact and approximate sto—
chastic simulation (including hybrid approaches), optimization and
parameter estimation. It offers strong support for using established
community standards, most importantly the SBML (Hucka et al.,
2003) file format for exchange of models.

We integrated the new objective function in COPASI as an ex-
tension to the parameter estimation task. First, a user would set up
their observed time course data in the experimental setup, where the
data are read in and mapped to the individual—dependent elements
in the model. Once that is done, the entry Create Events for
Timeseries Experiment can be chosen from the Tools menu. This
will analyze the time series experiment and create discrete events for
each of the observed time points. Each event will assign all observed
values of the specified time point to the mapped model elements.

Once the events have been created, they will force the model at
each measured timepoint to the observed state. This will apply to all
of the simulation tasks in COPASI, including time course simula—
tions, scans, parameter estimation runs and optimization runs. Since
the objective function described above is completely deterministic,
the optimization can be performed with gradient—based methods or
global optimization techniques.

Since the feature is implemented as events, they can be edited by
users, allowing them to remove some data points, or add new elem—
ents to adjust non—observed components The method can be used
for SBML and COPASI models alike, and once set up, the model
including the events can be exported back to SBML for analysis in
other software tools.

The new feature in COPASI can be used for parameter estimation
in stochastic models: Results from Zimmer and Sahle (2012) could be
reproduced for Immigration—Death and Lotka—Volterra (full observa—
tion) and for Lotka—Volterra (partial observation) even better conver—
gence could be achieved. This especially means that the feature can

exploit the information that intrinsic noise contains for parameter iden—
tification (Zimmer et al., 2015a). Furthermore, the new feature can be
applied to parameter estimation in ODE models. Here, it has the effect
that it smooths the landscape and allows for a more efficient optimiza-
tion. Figure 1 shows a plot of the objective function landscape with the
least squares objective function (middle panel) containing local minima
and with our objective function on the right side (without local min-
ima). These results are discussed in detail in Zimmer et al. (2015b). For
more examples please see also the Supplementary Material provided.

3.1 Discussion

We implemented the MSS objective function for parameter estimation
in COPASI. It splits the time horizon into intervals between the meas—
urement points and uses state updating mechanism to create initial val—
ues for the intervals. This allows more ﬂexible treatment of states as
conventional least squares functional where states only depend on the
initial value and the parameterized system. This allows us to success—
fully treat models containing intrinsic stochasticity. In addition, our
functional can be applied to parameter estimation in ODE systems. It
leads to a reduction of local minima in parameter space. Local minima
are a highly discussed topic (Moles et al., 2003) but only few methods
focus on the inﬂuence of the choice of the objective function such as
Bock et a1. (2007), Leander et a1. (2014), see Zimmer et al. (2015b) for
a more detailed discussion. Our implementation in COPASI allows for
combining this powerful objective function with all the feature of
COPASI such as a variety of optimization algorithms, a SBML import/
export and a graphical user interface. Thus, by integrating the newly de—
veloped method into a widely used and user friendly software package,
it is made accessible for a wider community for evaluation and practical
application.

Acknowledgements

The authors wish to thank Felix Winter for his help in debugging the feature,
Felix Jost for performing tests on the implementation and all COPASI developers.

Funding

F.T.B. is supported by Virtual Liver 85 National Institutes of Health [R01
GM070923], 8.8. by the Klaus Tschira Stiftung and CZ. by BIOMS. The fun-
ders had no role in study design, data collection and analysis, decision to pub-
lish or preparation of the manuscript.

Conﬂict of Interest: none declared.

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /3JO'S[‘8UJHO[p.IOJXO'SOTJBIIIJOJUTOTQ/ﬂClllq 11101; popeommoq

1588

F. T.Bergmann et al.

 

References

Bock,H. et al. (2007) Numerical methods for parameter estimation in nonlin-
ear differential algebraic equations. GAMM Mitteilungen, 30, 376—408.

Hoops,S. et al. (2006 ) Copasi—a complex pathway simulator. Bioinformatics,
22, 3067—3074.

Hucka,M. et al. (2003) The Systems Biology Markup Language (SBML): a me-
dium for representation and exchange of biochemical network models.
Bioinformatics, 19, 524—531.

Leander,]. et al. (2014) Stochastic differential equations as a tool to regularize
the parameter estimation problem for continuous time dynamical systems

given discrete time measurements. Mat/7. Biosci., 251, 54—62.

Moles,C. et al. (2003) Parameter estimation in biochemical pathways:
a comparison of global optimization methods. Genome Res., 13,
2467—2474.

Raj,A. and van Oudenaarden,A. (2009) Single-molecule approaches to sto-
chastic gene expression. Annu. Rev. Biophys, 38, 25 5—270.

Zimmer,C. and Sahle,S. (2012) Parameter estimation for stochastic models of
biochemical reactions. ]. Comput. Sci. Syst. Biol., 6, 011—021.

Zimmer,C. et al. (2015a) Exploiting intrinsic ﬂuctuations to identify model
parameters. IETSyst. Biol., 9, 64—73.

Zimmer,C. et al (2015b) Reducing local minima in ﬁtness landscapes of
parameter estimation by using piecewise evaluation and states estimation,
http://arXiv.org/abs/1 60 1 .0445 8 .

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BIUJOJIIBD aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUTOTQ/ﬁdllq 11101; pop1201umoq

